import {
  $B,
  $e,
  $t,
  $u,
  $v,
  A3,
  Ae,
  Al,
  An,
  Bc as Bc2,
  Be2 as Be,
  Bn as Bn2,
  Bs,
  Bu,
  C3,
  Cd,
  Cr2 as Cr,
  Cv,
  D,
  D8,
  Dc,
  Dr,
  EB,
  Eh,
  Eo,
  Es,
  Eu,
  Fc,
  Fe2 as Fe,
  Fn as Fn2,
  Fs,
  Ft,
  Ft2,
  Fu,
  G,
  G6,
  Gc2 as Gc,
  Gh,
  Gn as Gn2,
  Hc as Hc2,
  Hc2 as Hc3,
  Hs,
  Ht2 as Ht,
  I1 as I12,
  IB,
  IE,
  Ih2 as Ih,
  In,
  It,
  J as J2,
  J4,
  Jc,
  Je2,
  Ju as Ju2,
  K3 as K,
  Kc,
  Kh,
  Kl,
  Ku,
  Kv,
  Le as Le2,
  Lh,
  Ln2 as Ln,
  Ls2,
  Lt,
  M2,
  M3,
  M4 as M,
  ME,
  Me,
  Mr,
  Mt2 as Mt,
  NB,
  Nr as Nr2,
  Nt,
  Nu,
  O3,
  OB,
  Oc,
  P,
  PB,
  Pe,
  Pt as Pt2,
  Pu as Pu2,
  Q2,
  Qr,
  Qs2 as Qs,
  Qt as Qt2,
  Qt2 as Qt3,
  Qu2 as Qu,
  Rc,
  Rr,
  Ru,
  Sn2 as Sn,
  St2 as St,
  T3,
  Te,
  Tn as Tn2,
  Tt,
  Tu,
  U,
  Ue,
  Uh,
  V,
  Ve as Ve2,
  Vh,
  Wc,
  We as We2,
  Wh2 as Wh,
  Ws2 as Ws,
  Wt,
  X1,
  X3 as X,
  Xe2 as Xe,
  Xo,
  Xr,
  Xs2 as Xs,
  Xu,
  Y2 as Y,
  YB,
  Yc as Yc2,
  Ye,
  Yh,
  Yr,
  Yu,
  Yy,
  Z as Z2,
  Z5,
  Zt as Zt2,
  _,
  _8,
  _e2 as _e,
  _n,
  a0,
  aB,
  ac,
  ai,
  an2 as an,
  bE,
  be3 as be,
  bs2 as bs,
  bt as bt2,
  c1,
  c3,
  cB,
  ce,
  cs,
  d0,
  d3,
  de,
  ds,
  dz,
  e2,
  eA,
  ed,
  ee2 as ee,
  eg as eg2,
  ei,
  en,
  eo,
  fc,
  fh,
  fn as fn2,
  fo2,
  fr,
  ga2 as ga,
  gc,
  gd,
  gh,
  h2,
  hc,
  hn,
  hs,
  ht,
  hx,
  ie as ie3,
  il,
  ir,
  j8,
  jB,
  jc,
  jh,
  jn,
  k,
  k2,
  kB,
  kc2 as kc,
  ke as ke2,
  kh,
  kn,
  ku,
  ld2 as ld,
  ln,
  ls,
  lt,
  m3 as m,
  mB,
  md,
  me,
  mh,
  mn,
  mr,
  mt,
  ne,
  ng as ng2,
  nl,
  nt,
  o7,
  on2 as on,
  or2,
  ot,
  p2,
  pB,
  pc,
  pd,
  ph,
  pn2,
  qe as qe2,
  qh,
  qn,
  qr as qr2,
  qs,
  r0,
  ri,
  rl,
  rn,
  rr2 as rr,
  rt as rt2,
  s7,
  sd,
  se,
  se2,
  sl,
  sr as sr2,
  ss,
  st,
  t,
  tA,
  te,
  tg,
  ti,
  tl2 as tl,
  ub,
  ud,
  ui2 as ui,
  un,
  un2,
  uo2 as uo,
  us,
  v,
  v1,
  vB,
  ve,
  vh2 as vh,
  vr2 as vr3,
  vt,
  w8,
  wB,
  we as we2,
  wh,
  wr,
  wt,
  x1,
  x2 as x,
  x3,
  xc,
  xt,
  y0,
  ye2,
  yr,
  z,
  zc as zc2,
  zh,
  zn,
  zr,
  zs2 as zs
} from "./chunk-I7I3GTAS.js";
import {
  $C,
  BE,
  CE,
  DE as DE2,
  EE,
  FE,
  GE,
  JS,
  KE,
  LE,
  ME as ME2,
  NE,
  OE,
  PE,
  QS,
  RE,
  Rp,
  SE,
  TE,
  Tn,
  Ts,
  UE,
  Vx,
  WE,
  Xa,
  YS,
  ZS,
  Zh,
  _E as _E2,
  bE as bE2,
  eE,
  em,
  ep,
  gE as gE2,
  ie as ie2,
  kE,
  kd,
  kt as kt2,
  mE as mE2,
  nE,
  oE,
  pr,
  rE,
  require_jsx_runtime,
  require_react,
  require_react_dom,
  sE,
  tE,
  uE,
  vf as vf2,
  vr as vr2,
  wE,
  xE as xE2,
  zE
} from "./chunk-YFGUMDM2.js";
import {
  $m,
  $s,
  B1,
  Bc,
  BehaviorSubject,
  Bg,
  Bn,
  Cm,
  DE,
  DR,
  Dl,
  E1,
  EMPTY,
  Em,
  En,
  Fm,
  Fn,
  GC,
  Gg,
  Gi,
  Gn,
  HC,
  HE,
  Hc,
  Hm,
  I1,
  IR,
  Inject,
  Injector,
  J,
  Je,
  Ju,
  K1,
  Km,
  LR,
  Le,
  Ls,
  MR,
  Mm,
  Ms,
  N0,
  Ne,
  Nr,
  Ns,
  Observable,
  Ol,
  Optional,
  Or,
  Os,
  PR,
  Pt,
  Pu,
  Qo,
  Qt,
  Quantity,
  RediError,
  ReplaySubject,
  Rg,
  Rs,
  SR,
  Si,
  Subject,
  Subscription,
  TR,
  Ua,
  Ul,
  Ut,
  V1,
  VC,
  Ve,
  Vm,
  W1,
  We,
  Wm,
  Wn,
  XC,
  XE,
  XR,
  Xm,
  YR,
  Yc,
  Z,
  Z1,
  ZC,
  ZR,
  Zt,
  _1,
  _C,
  _E,
  a1,
  animationFrameScheduler,
  ao,
  bt,
  bufferTime,
  cR,
  combineLatest,
  combineLatestWith,
  createIdentifier,
  ct,
  dE,
  debounceTime,
  distinctUntilChanged,
  eC,
  eR,
  eg,
  et,
  fC,
  filter,
  first,
  fn,
  fo,
  fromEvent,
  g1,
  gC,
  gE,
  ge,
  gr,
  gs,
  h1,
  ic,
  ie,
  isObservable,
  j1,
  jg,
  jm,
  ke,
  kt,
  lc,
  mC,
  mE,
  mR,
  map,
  merge,
  mu,
  n1,
  nC,
  ng,
  oc,
  of,
  oo,
  or,
  pe,
  pn,
  pt,
  qC,
  qR,
  qe,
  qo,
  qr,
  rI,
  rt,
  s1,
  shareReplay,
  sr,
  startWith,
  switchMap,
  tR,
  take,
  takeUntil,
  throttleTime,
  tn,
  uR,
  uu,
  vE,
  vR,
  vf,
  vr,
  we,
  wi,
  withLatestFrom,
  ws,
  xE,
  xR,
  xn,
  xr,
  ye,
  yt,
  z1,
  zc,
  zg,
  zm,
  zt
} from "./chunk-RGZYGL3P.js";
import {
  __toESM
} from "./chunk-DC5AMYBS.js";

// node_modules/@wendellhu/redi/dist/esm/react-bindings/index.js
var import_react = __toESM(require_react());
var import_jsx_runtime = __toESM(require_jsx_runtime());
var RediContext = (0, import_react.createContext)({ injector: null });
RediContext.displayName = "RediContext";
var RediProvider = RediContext.Provider;
var RediConsumer = RediContext.Consumer;
function RediInjector(props) {
  const { children, dependencies } = props;
  const childInjectorRef = (0, import_react.useRef)(null);
  (0, import_react.useEffect)(() => () => {
    var _a3;
    return (_a3 = childInjectorRef.current) == null ? void 0 : _a3.dispose();
  }, []);
  return (0, import_jsx_runtime.jsx)(RediConsumer, { children: (context) => {
    let childInjector;
    if (childInjectorRef.current) childInjector = childInjectorRef.current;
    else {
      childInjector = context.injector ? context.injector.createChild(dependencies) : new Injector(dependencies);
      childInjectorRef.current = childInjector;
    }
    return (0, import_jsx_runtime.jsx)(RediProvider, {
      value: { injector: childInjector },
      children
    });
  } });
}
function connectInjector(Comp, injector) {
  return function ComponentWithInjector(props) {
    return (0, import_jsx_runtime.jsx)(RediProvider, {
      value: { injector },
      children: (0, import_jsx_runtime.jsx)(Comp, { ...props })
    });
  };
}
function connectDependencies(Comp, dependencies) {
  return function ComponentWithInjector(props) {
    return (0, import_jsx_runtime.jsx)(RediInjector, {
      dependencies,
      children: (0, import_jsx_runtime.jsx)(Comp, { ...props })
    });
  };
}
var ClassComponentNotInRediContextError = class extends RediError {
  constructor(component) {
    super(`You should make "RediContext" as ${component.constructor.name}'s default context type. If you want to use multiple context, please check this on React doc site. https://reactjs.org/docs/context.html#classcontexttype`);
  }
};
function WithDependency(id3, quantity, lookUp) {
  return function() {
    return { get() {
      const thisComponent = this;
      const context = thisComponent.context;
      if (!context || !context.injector) throw new ClassComponentNotInRediContextError(thisComponent);
      const injector = context.injector;
      const thing = injector.get(id3, quantity || Quantity.REQUIRED, lookUp);
      return thing;
    } };
  };
}
var HooksNotInRediContextError = class extends RediError {
  constructor() {
    super("Using dependency injection outside of a RediContext.");
  }
};
function useInjector() {
  const injectionContext = (0, import_react.useContext)(RediContext);
  if (!injectionContext.injector) throw new HooksNotInRediContextError();
  return injectionContext.injector;
}
function useDependency(id3, quantityOrLookUp, lookUp) {
  const injector = useInjector();
  return (0, import_react.useMemo)(() => injector.get(id3, quantityOrLookUp, lookUp), [
    id3,
    quantityOrLookUp,
    lookUp
  ]);
}
function unwrap(o) {
  if (typeof o === "function") return o();
  return o;
}
function useObservable(observable, defaultValue, shouldHaveSyncValue, deps) {
  if (typeof observable === "function" && !deps) throw new RediError("Expected deps to be provided when observable is a function!");
  const observableRef = (0, import_react.useRef)(null);
  const receivedSyncValueRef = (0, import_react.useRef)(false);
  const subscribedRef = (0, import_react.useRef)(false);
  const destObservable = (0, import_react.useMemo)(() => observable, [...typeof deps !== "undefined" ? deps : [observable]]);
  const [_3, setRenderCounter] = (0, import_react.useState)(0);
  const valueRef = (0, import_react.useRef)((() => {
    let innerDefaultValue;
    if (destObservable) {
      const sub = unwrap(destObservable).subscribe((value) => {
        receivedSyncValueRef.current = true;
        innerDefaultValue = value;
      });
      sub.unsubscribe();
    }
    return innerDefaultValue ?? defaultValue;
  })());
  (0, import_react.useLayoutEffect)(() => {
    subscribedRef.current = false;
    let subscription = null;
    if (destObservable) {
      observableRef.current = unwrap(destObservable);
      subscription = observableRef.current.subscribe((value) => {
        if (receivedSyncValueRef.current && !subscribedRef.current && value === valueRef.current) {
          subscribedRef.current = true;
          return;
        }
        subscribedRef.current = true;
        valueRef.current = value;
        setRenderCounter((prev) => prev + 1);
      });
    }
    return () => subscription == null ? void 0 : subscription.unsubscribe();
  }, [destObservable]);
  if (shouldHaveSyncValue && !receivedSyncValueRef.current) throw new Error("[redi]: Expect `shouldHaveSyncValue` but not getting a sync value!");
  return valueRef.current;
}
function useUpdateBinder(update$) {
  const [, dumpSet] = (0, import_react.useState)(0);
  (0, import_react.useEffect)(() => {
    const subscription = update$.subscribe(() => dumpSet((prev) => prev + 1));
    return () => subscription.unsubscribe();
  }, []);
}
var __REDI_CONTEXT_LOCK__ = "REDI_CONTEXT_LOCK";
var isNode = typeof process !== "undefined" && process.versions != null && process.versions.node != null;
var globalObject = typeof globalThis !== "undefined" && globalThis || typeof window !== "undefined" && window || typeof global !== "undefined" && global;
if (!globalObject[__REDI_CONTEXT_LOCK__]) globalObject[__REDI_CONTEXT_LOCK__] = true;
else if (!isNode) console.error(`[redi]: "RediContext" is already created. You may import "RediContext" from different paths. Use "import { RediContext } from '@wendellhu/redi/react-bindings'; instead."`);

// node_modules/@univerjs/ui/lib/es/index.js
var import_react2 = __toESM(require_react());
var import_jsx_runtime2 = __toESM(require_jsx_runtime());
var import_react_dom = __toESM(require_react_dom());
var r2 = Object.defineProperty;
var o2 = (e) => {
  throw TypeError(e);
};
var i2 = (e, t8, n) => t8 in e ? r2(e, t8, { enumerable: true, configurable: true, writable: true, value: n }) : e[t8] = n;
var F = (e, t8, n) => i2(e, typeof t8 != "symbol" ? t8 + "" : t8, n);
var L3 = (e, t8, n) => t8.has(e) ? o2("Cannot add the same private member more than once") : t8 instanceof WeakSet ? t8.add(e) : t8.set(e, n);
var G3 = class extends Ve {
  constructor() {
    super(...arguments);
    F(this, "_open$", new BehaviorSubject(false));
    F(this, "open$", this._open$.pipe(distinctUntilChanged()));
  }
  get isOpen() {
    return this._open$.getValue();
  }
  dispose() {
    super.dispose(), this._open$.next(false), this._open$.complete();
  }
  open() {
    this._open$.next(true);
  }
  close() {
    this._open$.next(false);
  }
};
var Ai = createIdentifier("ui.left-sidebar.service");
var we3 = createIdentifier("ui.sidebar.service");
var E9 = "ShortcutPanel";
var s3 = {
  id: "base-ui.operation.toggle-shortcut-panel",
  type: Ms.OPERATION,
  handler: (e) => {
    const t8 = e.get(G3), n = e.get(we3);
    return t8.isOpen ? (t8.close(), n.close()) : (t8.open(), n.open({
      header: { title: "shortcut-panel.title" },
      children: { label: E9 }
    })), true;
  }
};
function H({ ref: e, ...t8 }) {
  const { icon: n, id: r, className: o, extend: l, ...i } = t8, u = `univerjs-icon univerjs-icon-${r} ${o || ""}`.trim(), d = (0, import_react2.useRef)(`_${K2()}`);
  return N9(n, `${r}`, {
    defIds: n.defIds,
    idSuffix: d.current
  }, {
    ref: e,
    className: u,
    ...i
  }, l);
}
function N9(e, t8, n, r, o) {
  return (0, import_react2.createElement)(e.tag, {
    key: t8,
    ...J22(e, n, o),
    ...r
  }, (Q22(e, n).children || []).map((l, i) => N9(l, `${t8}-${e.tag}-${i}`, n, void 0, o)));
}
function J22(e, t8, n) {
  const r = { ...e.attrs };
  n != null && n.colorChannel1 && r.fill === "colorChannel1" && (r.fill = n.colorChannel1), e.tag === "mask" && r.id && (r.id = r.id + t8.idSuffix), Object.entries(r).forEach(([l, i]) => {
    l === "mask" && typeof i == "string" && (r[l] = i.replace(/url\(#(.*)\)/, `url(#$1${t8.idSuffix})`));
  });
  const { defIds: o } = t8;
  return !o || o.length === 0 || (e.tag === "use" && r["xlink:href"] && (r["xlink:href"] = r["xlink:href"] + t8.idSuffix), Object.entries(r).forEach(([l, i]) => {
    typeof i == "string" && (r[l] = i.replace(/url\(#(.*)\)/, `url(#$1${t8.idSuffix})`));
  })), r;
}
function Q22(e, t8) {
  var r;
  const { defIds: n } = t8;
  return !n || n.length === 0 ? e : e.tag === "defs" && ((r = e.children) != null && r.length) ? {
    ...e,
    children: e.children.map((o) => typeof o.attrs.id == "string" && n && n.includes(o.attrs.id) ? {
      ...o,
      attrs: {
        ...o.attrs,
        id: o.attrs.id + t8.idSuffix
      }
    } : o)
  } : e;
}
function K2() {
  return Math.random().toString(36).substring(2, 8);
}
H.displayName = "UniverIcon";
var e4 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M4.06641 3.49366C4.06641 2.27555 5.14145 1.3916 6.33307 1.3916C7.52469 1.3916 8.59974 2.27555 8.59974 3.49366V6.49777C8.59974 7.71586 7.52469 8.59982 6.33307 8.59982C5.14145 8.59982 4.06641 7.71586 4.06641 6.49777V3.49366ZM6.33307 2.5916C5.68376 2.5916 5.26641 3.05264 5.26641 3.49366V6.49777C5.26641 6.93878 5.68376 7.39982 6.33307 7.39982C6.98239 7.39982 7.39974 6.93878 7.39974 6.49777V3.49366C7.39974 3.05264 6.98239 2.5916 6.33307 2.5916Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M10.0664 3.49366C10.0664 2.27555 11.1415 1.3916 12.3331 1.3916C13.5247 1.3916 14.5997 2.27555 14.5997 3.49366V6.49777C14.5997 7.71586 13.5247 8.59982 12.3331 8.59982C11.1415 8.59982 10.0664 7.71586 10.0664 6.49777V3.49366ZM12.3331 2.5916C11.6838 2.5916 11.2664 3.05264 11.2664 3.49366V6.49777C11.2664 6.93878 11.6838 7.39982 12.3331 7.39982C12.9824 7.39982 13.3997 6.93878 13.3997 6.49777V3.49366C13.3997 3.05264 12.9824 2.5916 12.3331 2.5916Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M12.4242 9.5417C12.1899 9.30739 11.81 9.30739 11.5756 9.5417C11.3413 9.77602 11.3413 10.1559 11.5756 10.3902L12.5514 11.366H6.3334C6.00203 11.366 5.7334 11.6346 5.7334 11.966C5.7334 12.2973 6.00203 12.566 6.3334 12.566H12.5514L11.5756 13.5417C11.3413 13.776 11.3413 14.1559 11.5756 14.3902C11.81 14.6245 12.1899 14.6245 12.4242 14.3902L14.4159 12.3985C14.5294 12.2893 14.6001 12.1359 14.6001 11.966C14.6001 11.796 14.5294 11.6426 14.4159 11.5334L12.4242 9.5417Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M1.3999 8.3002C1.3999 7.96882 1.66853 7.7002 1.9999 7.7002H2.33324C2.66461 7.7002 2.93324 7.96882 2.93324 8.3002C2.93324 8.63157 2.66461 8.9002 2.33324 8.9002H1.9999C1.66853 8.9002 1.3999 8.63157 1.3999 8.3002Z"
      }
    }
  ]
};
var D9 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "add-digits-icon",
    ref: n,
    icon: e4
  }));
});
D9.displayName = "AddDigitsIcon";
var t4 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M2.2498 3.65005C2.2498 2.87685 2.87661 2.25005 3.64981 2.25005H7.9998C8.33118 2.25005 8.5998 1.98142 8.5998 1.65005C8.5998 1.31868 8.33118 1.05005 7.9998 1.05005H3.64981C2.21387 1.05005 1.0498 2.21411 1.0498 3.65005V12.35C1.0498 13.786 2.21386 14.95 3.6498 14.95H12.3498C13.7857 14.95 14.9498 13.786 14.9498 12.3501V8.00005C14.9498 7.66868 14.6812 7.40005 14.3498 7.40005C14.0184 7.40005 13.7498 7.66868 13.7498 8.00005V9.23974L12.2385 8.1063C11.7252 7.72129 11.0068 7.7723 10.5531 8.22605L9.00869 9.77041L6.73916 7.8251C6.24387 7.40055 5.5095 7.41278 5.02864 7.85359L2.2498 10.4009V3.65005ZM2.2498 12.0287V12.35C2.2498 13.1232 2.87661 13.75 3.6498 13.75H12.3498C13.123 13.75 13.7498 13.1232 13.7498 12.3501V10.7397L11.5186 9.06631C11.4829 9.03956 11.433 9.04314 11.4016 9.07458L9.92249 10.5537L11.1015 11.5642C11.3531 11.7799 11.3822 12.1587 11.1666 12.4103C10.9509 12.6619 10.5721 12.691 10.3205 12.4753L5.9582 8.7362C5.92384 8.70674 5.87288 8.70758 5.83952 8.73816L2.2498 12.0287Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M11.8097 1.14783C12.1411 1.14783 12.4097 1.41646 12.4097 1.74783V3.297H14.1541C14.4855 3.297 14.7541 3.56563 14.7541 3.897C14.7541 4.22837 14.4855 4.497 14.1541 4.497H12.4097V6.24167C12.4097 6.57304 12.1411 6.84167 11.8097 6.84167C11.4783 6.84167 11.2097 6.57304 11.2097 6.24167V4.497H9.6603C9.32893 4.497 9.0603 4.22837 9.0603 3.897C9.0603 3.56563 9.32893 3.297 9.6603 3.297H11.2097V1.74783C11.2097 1.41646 11.4783 1.14783 11.8097 1.14783Z"
    }
  }]
};
var T9 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "add-image-icon",
    ref: n,
    icon: t4
  }));
});
T9.displayName = "AddImageIcon";
var n4 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M11.3606 3.74168C11.6086 3.49373 12.0106 3.49373 12.2585 3.74168C12.5065 3.98963 12.5065 4.39164 12.2585 4.6396L4.63947 12.2586C4.39152 12.5066 3.98951 12.5066 3.74156 12.2586C3.49361 12.0107 3.49361 11.6087 3.74156 11.3607L11.3606 3.74168Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M4.82544 4.82556H4.19052C3.83986 4.82556 3.5556 5.10982 3.5556 5.46048C3.5556 5.81114 3.83986 6.0954 4.19052 6.0954H4.82544V6.73032C4.82544 7.08098 5.1097 7.36524 5.46036 7.36524C5.81102 7.36524 6.09528 7.08098 6.09528 6.73032V6.0954H6.7302C7.08086 6.0954 7.36512 5.81114 7.36512 5.46048C7.36512 5.10982 7.08086 4.82556 6.7302 4.82556H6.09528V4.19064C6.09528 3.83998 5.81102 3.55572 5.46036 3.55572C5.1097 3.55572 4.82544 3.83998 4.82544 4.19064V4.82556Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M8.3175 10.8573C8.3175 10.5066 8.60176 10.2224 8.95242 10.2224H11.4921C11.8428 10.2224 12.127 10.5066 12.127 10.8573C12.127 11.208 11.8428 11.4922 11.4921 11.4922H8.95242C8.60176 11.4922 8.3175 11.208 8.3175 10.8573Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M1.33337 2.9208C1.33337 2.04416 2.04403 1.3335 2.92068 1.3335H13.0794C13.9561 1.3335 14.6667 2.04416 14.6667 2.9208V13.0795C14.6667 13.9562 13.9561 14.6668 13.0794 14.6668H2.92068C2.04404 14.6668 1.33337 13.9562 1.33337 13.0795V2.9208ZM2.92068 2.60334C2.74535 2.60334 2.60322 2.74547 2.60322 2.9208V13.0795C2.60322 13.2549 2.74534 13.397 2.92068 13.397H13.0794C13.2547 13.397 13.3969 13.2549 13.3969 13.0795V2.9208C13.3969 2.74546 13.2547 2.60334 13.0794 2.60334H2.92068Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    }
  ]
};
var Z9 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "addition-and-subtraction-icon",
    ref: n,
    icon: n4
  }));
});
Z9.displayName = "AdditionAndSubtractionIcon";
var r4 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M1.3999 13.6999C1.3999 13.3685 1.66853 13.0999 1.9999 13.0999H13.9999C14.3313 13.0999 14.5999 13.3685 14.5999 13.6999C14.5999 14.0312 14.3313 14.2999 13.9999 14.2999H1.9999C1.66853 14.2999 1.3999 14.0312 1.3999 13.6999Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M7.57564 10.3914C7.80995 10.6257 8.18985 10.6257 8.42417 10.3914L10.4242 8.3914C10.6585 8.15709 10.6585 7.77719 10.4242 7.54287C10.1899 7.30856 9.80995 7.30856 9.57564 7.54287L7.9999 9.11861L6.42417 7.54287C6.18985 7.30856 5.80995 7.30856 5.57564 7.54287C5.34132 7.77719 5.34132 8.15709 5.57564 8.3914L7.57564 10.3914Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M7.9999 10.5671C8.33127 10.5671 8.5999 10.2985 8.5999 9.96714V2.30047C8.5999 1.9691 8.33127 1.70047 7.9999 1.70047C7.66853 1.70047 7.3999 1.9691 7.3999 2.30047V9.96714C7.3999 10.2985 7.66853 10.5671 7.9999 10.5671Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    }
  ]
};
var A9 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "align-bottom-icon",
    ref: n,
    icon: r4
  }));
});
A9.displayName = "AlignBottomIcon";
var o4 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941C1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941C14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M1.9999 5.56641C1.66853 5.56641 1.3999 5.83504 1.3999 6.16641C1.3999 6.49778 1.66853 6.76641 1.9999 6.76641H13.9999C14.3313 6.76641 14.5999 6.49778 14.5999 6.16641C14.5999 5.83504 14.3313 5.56641 13.9999 5.56641H1.9999Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334C14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M1.9999 12.9004C1.66853 12.9004 1.3999 13.169 1.3999 13.5004C1.3999 13.8318 1.66853 14.1004 1.9999 14.1004H13.9999C14.3313 14.1004 14.5999 13.8318 14.5999 13.5004C14.5999 13.169 14.3313 12.9004 13.9999 12.9004H1.9999Z"
      }
    }
  ]
};
var B9 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "align-text-both-icon",
    ref: n,
    icon: o4
  }));
});
B9.displayName = "AlignTextBothIcon";
var i4 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M1.3999 2.3002C1.3999 2.63157 1.66853 2.9002 1.9999 2.9002H13.9999C14.3313 2.9002 14.5999 2.63157 14.5999 2.3002C14.5999 1.96882 14.3313 1.7002 13.9999 1.7002H1.9999C1.66853 1.7002 1.3999 1.96882 1.3999 2.3002Z"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M8.22957 5.47839C8.30034 5.50767 8.36664 5.55107 8.42417 5.6086L10.4242 7.6086C10.6585 7.84291 10.6585 8.22281 10.4242 8.45713C10.1899 8.69144 9.80995 8.69144 9.57564 8.45713L8.5999 7.48139V13.6995C8.5999 14.0309 8.33127 14.2995 7.9999 14.2995C7.66853 14.2995 7.3999 14.0309 7.3999 13.6995V7.48139L6.42417 8.45713C6.18985 8.69144 5.80995 8.69144 5.57564 8.45713C5.34132 8.22281 5.34132 7.84291 5.57564 7.6086L7.57541 5.60882C7.7522 5.43203 8.01209 5.38841 8.22957 5.47839Z"
    }
  }]
};
var P9 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "align-top-icon",
    ref: n,
    icon: i4
  }));
});
P9.displayName = "AlignTopIcon";
var l4 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M7.9999 1.12915C8.03875 1.12915 8.07673 1.13284 8.11352 1.13989H12.2599C13.6958 1.13989 14.8599 2.30395 14.8599 3.73989V7.88619C14.867 7.92301 14.8707 7.96102 14.8707 7.9999C14.8707 8.03878 14.867 8.0768 14.8599 8.11362V12.2599C14.8599 13.6958 13.6958 14.8599 12.2599 14.8599H8.11362C8.0768 14.867 8.03878 14.8707 7.9999 14.8707C7.96102 14.8707 7.92301 14.867 7.88619 14.8599H3.73989C2.30396 14.8599 1.13989 13.6958 1.13989 12.2599V8.11352C1.13284 8.07673 1.12915 8.03875 1.12915 7.9999C1.12915 7.96106 1.13284 7.92308 1.13989 7.88629V3.73989C1.13989 2.30396 2.30395 1.13989 3.73989 1.13989H7.88629C7.92308 1.13284 7.96106 1.12915 7.9999 1.12915ZM2.33989 8.5999V12.2599C2.33989 13.0331 2.9667 13.6599 3.73989 13.6599H7.3999V8.5999H2.33989ZM7.3999 7.3999H2.33989V3.73989C2.33989 2.9667 2.96669 2.33989 3.73989 2.33989H7.3999V7.3999ZM8.5999 8.5999V13.6599H12.2599C13.0331 13.6599 13.6599 13.0331 13.6599 12.2599V8.5999H8.5999ZM13.6599 7.3999H8.5999V2.33989H12.2599C13.0331 2.33989 13.6599 2.96669 13.6599 3.73989V7.3999Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var F9 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "all-border-icon",
    ref: n,
    icon: l4
  }));
});
F9.displayName = "AllBorderIcon";
var s4 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M8.5999 5.9999C8.5999 5.66853 8.33127 5.3999 7.9999 5.3999C7.66853 5.3999 7.3999 5.66853 7.3999 5.9999V7.40329L6.004 7.4051C5.67263 7.40553 5.40435 7.67451 5.40479 8.00588C5.40522 8.33725 5.6742 8.60553 6.00557 8.6051L7.3999 8.60329V9.9999C7.3999 10.3313 7.66853 10.5999 7.9999 10.5999C8.33127 10.5999 8.5999 10.3313 8.5999 9.9999V8.60172L10.0004 8.5999C10.3317 8.59947 10.6 8.33049 10.5996 7.99912C10.5992 7.66775 10.3302 7.39947 9.9988 7.3999L8.5999 7.40172V5.9999Z"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M7.99958 1.73315C4.53861 1.73315 1.73291 4.53885 1.73291 7.99982C1.73291 11.4608 4.53861 14.2665 7.99958 14.2665C9.51395 14.2665 10.9029 13.7293 11.9862 12.8351L13.2422 14.0908C13.4765 14.3251 13.8564 14.3251 14.0907 14.0907C14.325 13.8564 14.325 13.4765 14.0906 13.2422L12.8347 11.9866C13.729 10.9033 14.2662 9.51428 14.2662 7.99982C14.2662 4.53885 11.4605 1.73315 7.99958 1.73315ZM2.93291 7.99982C2.93291 5.20159 5.20135 2.93315 7.99958 2.93315C10.7978 2.93315 13.0662 5.20159 13.0662 7.99982C13.0662 10.7981 10.7978 13.0665 7.99958 13.0665C5.20135 13.0665 2.93291 10.7981 2.93291 7.99982Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var k9 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "amplify-icon",
    ref: n,
    icon: s4
  }));
});
k9.displayName = "AmplifyIcon";
var a4 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M2.5999 2.2001C2.5999 1.86873 2.33127 1.6001 1.9999 1.6001C1.66853 1.6001 1.3999 1.86873 1.3999 2.2001V13.8001C1.3999 14.1315 1.66853 14.4001 1.9999 14.4001C2.33127 14.4001 2.5999 14.1315 2.5999 13.8001V2.2001Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M14.5999 2.2001C14.5999 1.86873 14.3313 1.6001 13.9999 1.6001C13.6685 1.6001 13.3999 1.86873 13.3999 2.2001V13.8001C13.3999 14.1315 13.6685 14.4001 13.9999 14.4001C14.3313 14.4001 14.5999 14.1315 14.5999 13.8001V2.2001Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M6.424 8.24239C6.65832 8.4767 6.65832 8.8566 6.424 9.09091L6.11502 9.3999H9.33307C10.1063 9.3999 10.7331 8.7731 10.7331 7.9999C10.7331 7.22671 10.1063 6.5999 9.33307 6.5999H4.6666L4.66645 5.3999H9.33307C10.769 5.3999 11.9331 6.56396 11.9331 7.9999C11.9331 9.43584 10.769 10.5999 9.33307 10.5999H6.11485L6.424 10.9091C6.65832 11.1434 6.65832 11.5233 6.424 11.7576C6.18969 11.9919 5.80979 11.9919 5.57548 11.7576L4.24214 10.4242C4.00783 10.1899 4.00783 9.81003 4.24214 9.57572L5.57548 8.24239C5.80979 8.00807 6.18969 8.00807 6.424 8.24239Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M4.6666 6.5999C4.33523 6.5999 4.06641 6.33127 4.06641 5.9999C4.06641 5.66853 4.33508 5.3999 4.66645 5.3999L4.6666 6.5999Z"
      }
    }
  ]
};
var j9 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "autowrap-icon",
    ref: n,
    icon: a4
  }));
});
j9.displayName = "AutowrapIcon";
var c4 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M2.36977 4.66364C2.67525 3.75535 3.95995 3.75535 4.26543 4.66364L6.0261 9.89866C6.13173 10.2127 5.96275 10.553 5.64867 10.6586C5.33459 10.7643 4.99434 10.5953 4.8887 10.2812L3.3176 5.60982L1.7465 10.2812C1.64086 10.5953 1.30062 10.7643 0.986532 10.6586C0.672449 10.553 0.503468 10.2127 0.609102 9.89866L2.36977 4.66364Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M1.6333 7.87051C1.6333 7.53914 1.90193 7.27051 2.2333 7.27051H4.52594C4.85732 7.27051 5.12594 7.53914 5.12594 7.87051C5.12594 8.20188 4.85732 8.47051 4.52594 8.47051H2.2333C1.90193 8.47051 1.6333 8.20188 1.6333 7.87051Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M9.26385 10.0162C8.9281 10.853 7.74343 10.853 7.40768 10.0162L6.02978 6.58181C5.90639 6.27427 6.05568 5.92493 6.36322 5.80154C6.67076 5.67815 7.0201 5.82744 7.14349 6.13498L8.33577 9.10668L9.52805 6.13498C9.65143 5.82744 10.0008 5.67815 10.3083 5.80154C10.6159 5.92493 10.7651 6.27427 10.6418 6.58181L9.26385 10.0162Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M14.8178 5.68628C15.1491 5.68628 15.4178 5.95491 15.4178 6.28628L15.4178 10.845C15.4178 11.9648 14.51 12.8726 13.3901 12.8726H12.8888C11.8122 12.8726 10.9395 11.9999 10.9395 10.9233C10.9395 10.5919 11.2081 10.3233 11.5395 10.3233C11.8708 10.3233 12.1395 10.5919 12.1395 10.9233C12.1395 11.3371 12.4749 11.6726 12.8888 11.6726H13.3901C13.8472 11.6726 14.2178 11.3021 14.2178 10.845L14.2178 6.28628C14.2178 5.95491 14.4864 5.68628 14.8178 5.68628Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M10.9395 7.82632C10.9395 6.58966 11.942 5.58716 13.1786 5.58716C14.4153 5.58716 15.4178 6.58966 15.4178 7.82632C15.4178 9.06297 14.4153 10.0655 13.1786 10.0655C11.942 10.0655 10.9395 9.06297 10.9395 7.82632ZM13.1786 6.78716C12.6047 6.78716 12.1395 7.2524 12.1395 7.82632C12.1395 8.40023 12.6047 8.86547 13.1786 8.86547C13.7525 8.86547 14.2178 8.40023 14.2178 7.82632C14.2178 7.2524 13.7525 6.78716 13.1786 6.78716Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    }
  ]
};
var U9 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "avg-icon",
    ref: n,
    icon: c4
  }));
});
U9.displayName = "AvgIcon";
var u4 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M4.65791 1.30005C3.77355 1.30005 3.05664 2.01696 3.05664 2.90132V12.8588C3.05664 13.8755 3.88086 14.6998 4.89759 14.6998H9.1016C11.2233 14.6998 12.9433 12.9798 12.9433 10.8581C12.9433 9.13925 11.8145 7.68407 10.2578 7.1934C10.8806 6.56856 11.2655 5.70659 11.2655 4.75472C11.2655 2.84676 9.71883 1.30005 7.81087 1.30005H4.65791ZM4.25664 2.90132C4.25664 2.6797 4.4363 2.50005 4.65791 2.50005H7.81087C9.05609 2.50005 10.0655 3.5095 10.0655 4.75472C10.0655 5.99993 9.05609 7.00938 7.81087 7.00938H4.25664V2.90132ZM4.25664 12.8588V8.21636H9.1016C10.5606 8.21636 11.7433 9.39909 11.7433 10.8581C11.7433 12.317 10.5606 13.4998 9.1016 13.4998H4.89759C4.5436 13.4998 4.25664 13.2128 4.25664 12.8588Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var z9 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "bold-icon",
    ref: n,
    icon: u4
  }));
});
z9.displayName = "BoldIcon";
var d4 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M2.59219 1.3667C1.70853 1.3667 0.992188 2.08304 0.992188 2.9667V4.9667C0.992188 5.85036 1.70853 6.5667 2.59219 6.5667H11.2694C12.1531 6.5667 12.8694 5.85036 12.8694 4.9667V4.79985H13.8075V8.18642C13.8075 8.38777 13.6579 8.55773 13.4581 8.58321L7.10511 9.39341C6.30618 9.4953 5.70752 10.1752 5.70752 10.9806V14.0332C5.70752 14.3646 5.97615 14.6332 6.30752 14.6332C6.63889 14.6332 6.90752 14.3646 6.90752 14.0332V10.9806C6.90752 10.7792 7.05718 10.6092 7.25692 10.5838L13.6099 9.77356C14.4089 9.67168 15.0075 8.99182 15.0075 8.18642V4.19985C15.0075 3.86848 14.7389 3.59985 14.4075 3.59985H12.8694V2.9667C12.8694 2.08304 12.1531 1.3667 11.2694 1.3667H2.59219ZM2.19219 2.9667C2.19219 2.74579 2.37127 2.5667 2.59219 2.5667H11.2694C11.4903 2.5667 11.6694 2.74579 11.6694 2.9667V4.9667C11.6694 5.18761 11.4903 5.3667 11.2694 5.3667H2.59219C2.37127 5.3667 2.19219 5.18761 2.19219 4.9667V2.9667Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var W9 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "brush-icon",
    ref: n,
    icon: d4
  }));
});
W9.displayName = "BrushIcon";
var h4 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M1.14014 3.73989C1.14014 2.30396 2.3042 1.13989 3.74014 1.13989H12.2601C13.6961 1.13989 14.8601 2.30395 14.8601 3.73989V4.86989C14.8601 5.20126 14.5915 5.46989 14.2601 5.46989C13.9288 5.46989 13.6601 5.20126 13.6601 4.86989V3.73989C13.6601 2.96669 13.0333 2.33989 12.2601 2.33989H8.34014V3.20284C8.34014 3.20446 8.34014 3.20608 8.34014 3.2077V6.73989C8.34014 7.62355 7.62379 8.33989 6.74014 8.33989H2.70277C2.70112 8.3399 2.69947 8.3399 2.69781 8.33989H2.34014V12.2599C2.34014 13.0331 2.96694 13.6599 3.74014 13.6599H12.2601C13.0333 13.6599 13.6601 13.0331 13.6601 12.2599V11.7299C13.6601 11.3985 13.9288 11.1299 14.2601 11.1299C14.5915 11.1299 14.8601 11.3985 14.8601 11.7299V12.2599C14.8601 13.6958 13.6961 14.8599 12.2601 14.8599H3.74014C2.3042 14.8599 1.14014 13.6958 1.14014 12.2599V3.73989ZM4.26409 7.13989H6.74014C6.96105 7.13989 7.14014 6.96081 7.14014 6.73989V4.55237L4.26409 7.13989ZM7.14014 2.93819V2.33989H6.28159L2.34044 5.614L2.34056 7.13989H2.46992L7.14014 2.93819ZM2.34032 4.05403L4.40368 2.33989H3.74029C2.96705 2.33989 2.34023 2.96676 2.34029 3.74L2.34032 4.05403Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M8.73877 9.00298C8.73877 9.55526 9.18649 10.003 9.73877 10.003H11.7792C12.1106 10.003 12.3792 9.73435 12.3792 9.40298C12.3792 9.07161 12.1106 8.80298 11.7792 8.80298H10.7874L12.2304 7.36157C12.7051 6.88734 13.4743 6.88754 13.9488 7.36202C14.4234 7.83667 14.4234 8.60624 13.9488 9.0809L13.2095 9.82016C12.9752 10.0545 12.9752 10.4344 13.2095 10.6687C13.4439 10.903 13.8238 10.903 14.0581 10.6687L14.7973 9.92943C15.7406 8.98614 15.7406 7.45678 14.7973 6.51349C13.8544 5.57056 12.3257 5.57015 11.3823 6.51259L9.93877 7.95459V6.96255C9.93877 6.63118 9.67014 6.36255 9.33877 6.36255C9.0074 6.36255 8.73877 6.63118 8.73877 6.96255V9.00298Z"
    }
  }]
};
var Y9 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "cancel-freeze-icon",
    ref: n,
    icon: h4
  }));
});
Y9.displayName = "CancelFreezeIcon";
var f4 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M12.5939 1.13916L10.6607 1.1392C9.55628 1.13922 8.66093 2.03448 8.66077 3.13893L8.66063 4.19191C8.66059 4.52328 8.92918 4.79194 9.26055 4.79199C9.59192 4.79204 9.86059 4.52344 9.86063 4.19207L9.86077 3.13909C9.86084 2.69731 10.219 2.33921 10.6608 2.3392L12.594 2.33916C13.0358 2.33915 13.394 2.69732 13.394 3.13916L13.394 12.8612C13.394 13.303 13.0358 13.6612 12.594 13.6612H10.6606C10.2188 13.6612 9.86063 13.303 9.86063 12.8612V11.8084C9.86063 11.4771 9.592 11.2084 9.26063 11.2084C8.92926 11.2084 8.66063 11.4771 8.66063 11.8084V12.8612C8.66063 13.9658 9.55606 14.8612 10.6606 14.8612H12.594C13.6986 14.8612 14.594 13.9658 14.594 12.8612L14.594 3.13915C14.594 2.03457 13.6985 1.13914 12.5939 1.13916Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M5.33888 1.13919L3.40568 1.13926C2.30114 1.13931 1.40575 2.03474 1.40576 3.13928L1.40586 12.8612C1.40587 13.9658 2.3013 14.8612 3.40586 14.8612H5.33896C6.44353 14.8612 7.33896 13.9658 7.33896 12.8612V11.8084C7.33896 11.4771 7.07033 11.2084 6.73896 11.2084C6.40759 11.2084 6.13896 11.4771 6.13896 11.8084V12.8612C6.13896 13.303 5.78079 13.6612 5.33896 13.6612H3.40586C2.96403 13.6612 2.60586 13.303 2.60586 12.8612L2.60576 3.13927C2.60576 2.69745 2.96391 2.33928 3.40573 2.33926L5.33893 2.33919C5.78077 2.33917 6.13896 2.69735 6.13896 3.13919V4.192C6.13896 4.52337 6.40759 4.792 6.73896 4.792C7.07033 4.792 7.33896 4.52337 7.33896 4.192V3.13919C7.33896 2.03459 6.44348 1.13914 5.33888 1.13919Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M9.20731 5.99993C8.973 6.23424 8.973 6.61414 9.20731 6.84845L10.0912 7.73235C10.2474 7.88856 10.2474 8.14182 10.0912 8.29803L9.20731 9.18192C8.973 9.41624 8.973 9.79614 9.20731 10.0305C9.44163 10.2648 9.82153 10.2648 10.0558 10.0305L10.9397 9.14654C11.5646 8.52171 11.5646 7.50867 10.9397 6.88384L10.0558 5.99993C9.82153 5.76561 9.44163 5.76561 9.20731 5.99993Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M5.94379 5.99993C6.1781 5.76561 6.558 5.76561 6.79232 5.99993C7.02663 6.23424 7.02663 6.61414 6.79232 6.84845L5.90842 7.73235C5.75221 7.88856 5.75221 8.14182 5.90842 8.29803L6.79232 9.18193C7.02663 9.41624 7.02663 9.79614 6.79232 10.0305C6.558 10.2648 6.1781 10.2648 5.94379 10.0305L5.0599 9.14656C4.43506 8.52172 4.43506 7.50866 5.0599 6.88382L5.94379 5.99993Z"
      }
    }
  ]
};
var G9 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "cancel-merge-icon",
    ref: n,
    icon: f4
  }));
});
G9.displayName = "CancelMergeIcon";
var C4 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M14.1544 3.75557C14.3887 3.98988 14.3887 4.36978 14.1544 4.6041L6.51409 12.2444C6.40157 12.3569 6.24896 12.4201 6.08983 12.4201C5.9307 12.4201 5.77808 12.3569 5.66556 12.2444L1.84541 8.42425C1.6111 8.18993 1.6111 7.81003 1.84541 7.57572C2.07973 7.34141 2.45963 7.34141 2.69394 7.57572L6.08983 10.9716L13.3059 3.75557C13.5402 3.52126 13.9201 3.52126 14.1544 3.75557Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var X3 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "check-mark-icon",
    ref: n,
    icon: C4
  }));
});
X3.displayName = "CheckMarkIcon";
var v4 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M3.71274 2.86421C3.47843 2.6299 3.09853 2.6299 2.86421 2.86421C2.6299 3.09853 2.6299 3.47843 2.86421 3.71274L7.15154 8.00007L2.86421 12.2874C2.6299 12.5217 2.6299 12.9016 2.86421 13.1359C3.09853 13.3702 3.47843 13.3702 3.71274 13.1359L8.00007 8.84859L12.2874 13.1359C12.5217 13.3702 12.9016 13.3702 13.1359 13.1359C13.3702 12.9016 13.3702 12.5217 13.1359 12.2874L8.84859 8.00007L13.1359 3.71274C13.3702 3.47843 13.3702 3.09853 13.1359 2.86421C12.9016 2.6299 12.5217 2.6299 12.2874 2.86421L8.00007 7.15154L3.71274 2.86421Z"
    }
  }]
};
var q3 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "close-icon",
    ref: n,
    icon: v4
  }));
});
q3.displayName = "CloseIcon";
var g4 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M0.361328 7.79626C0.361328 6.0459 1.78028 4.62695 3.53064 4.62695C4.18424 4.62695 4.80612 4.90867 5.23714 5.40001L5.30149 5.47337C5.52001 5.72247 5.49522 6.10156 5.24612 6.32009C4.99701 6.53861 4.61792 6.51382 4.3994 6.26471L4.33504 6.19135C4.13187 5.95975 3.83873 5.82695 3.53064 5.82695C2.44302 5.82695 1.56133 6.70864 1.56133 7.79626V8.21416C1.56133 9.29594 2.43828 10.1729 3.52006 10.1729C3.83123 10.1729 4.12678 10.0366 4.32877 9.79988L4.39405 9.72339C4.60916 9.47133 4.98788 9.44138 5.23994 9.65649C5.492 9.8716 5.52195 10.2503 5.30684 10.5024L5.24156 10.5789C4.81157 11.0827 4.18244 11.3729 3.52006 11.3729C1.77554 11.3729 0.361328 9.95868 0.361328 8.21416V7.79626Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M13.2084 4.92822C13.5398 4.92822 13.8084 5.19685 13.8084 5.52822V9.97297C13.8084 10.0834 13.8979 10.173 14.0084 10.173H15.0384C15.3698 10.173 15.6384 10.4416 15.6384 10.773C15.6384 11.1043 15.3698 11.373 15.0384 11.373H14.0084C13.2352 11.373 12.6084 10.7462 12.6084 9.97297V5.52822C12.6084 5.19685 12.877 4.92822 13.2084 4.92822Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M10.9893 7.42715C10.9893 7.09578 11.2579 6.82715 11.5893 6.82715H14.9428C15.2742 6.82715 15.5428 7.09578 15.5428 7.42715C15.5428 7.75852 15.2742 8.02715 14.9428 8.02715H11.5893C11.2579 8.02715 10.9893 7.75852 10.9893 7.42715Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M9.46366 8.71622C9.46366 8.18879 8.9622 7.80569 8.45332 7.94436L8.12019 8.03514C7.68503 8.15373 7.38311 8.54894 7.38311 8.99996V10.7731C7.38311 11.1044 7.11448 11.3731 6.78311 11.3731C6.45173 11.3731 6.18311 11.1044 6.18311 10.7731V8.99996C6.18311 8.0077 6.84733 7.13825 7.80469 6.87736L8.13782 6.78658C9.41001 6.43991 10.6637 7.39764 10.6637 8.71622V10.7731C10.6637 11.1044 10.395 11.3731 10.0637 11.3731C9.73229 11.3731 9.46366 11.1044 9.46366 10.7731V8.71622Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M6.79079 6.75531C7.12216 6.75528 7.39081 7.02389 7.39084 7.35526L7.39109 10.773C7.39112 11.1043 7.12251 11.373 6.79114 11.373C6.45977 11.373 6.19112 11.1044 6.19109 10.7731L6.19084 7.35535C6.19081 7.02398 6.45942 6.75533 6.79079 6.75531Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    }
  ]
};
var X9 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "cnt-icon",
    ref: n,
    icon: g4
  }));
});
X9.displayName = "CntIcon";
var p4 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M9.92206 2.45064C9.98634 2.12556 9.77492 1.80992 9.44984 1.74564C9.12477 1.68136 8.80913 1.89278 8.74485 2.21785L6.41152 14.0179C6.34724 14.3429 6.55865 14.6586 6.88373 14.7228C7.20881 14.7871 7.52444 14.5757 7.58872 14.2506L9.92206 2.45064Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M5.14972 3.90157C5.38815 4.1317 5.39487 4.51154 5.16473 4.74996L2.55461 7.45409C2.01739 8.01066 2.03336 8.89745 2.59029 9.43431L5.14944 11.9013C5.38802 12.1313 5.39498 12.5111 5.165 12.7497C4.93502 12.9883 4.55519 12.9952 4.31662 12.7652L1.75746 10.2983C0.723174 9.30122 0.693506 7.65434 1.69121 6.6207L4.30133 3.91657C4.53146 3.67815 4.9113 3.67143 5.14972 3.90157Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M10.8505 3.90157C11.0889 3.67143 11.4688 3.67815 11.6989 3.91657L14.309 6.6207C15.3067 7.65434 15.2771 9.30122 14.2428 10.2983L11.6836 12.7652C11.4451 12.9952 11.0652 12.9883 10.8352 12.7497C10.6053 12.5111 10.6122 12.1313 10.8508 11.9013L13.41 9.43431C13.9669 8.89745 13.9829 8.01066 13.4456 7.45409L10.8355 4.74996C10.6054 4.51154 10.6121 4.1317 10.8505 3.90157Z"
      }
    }
  ]
};
var q9 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "code-icon",
    ref: n,
    icon: p4
  }));
});
q9.displayName = "CodeIcon";
var m4 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M8 0.866961C5.018 0.866961 2 1.78296 2 3.53363V12.3675C2 14.1182 5.018 15.0342 8 15.0342C10.982 15.0342 14 14.1182 14 12.3675V3.53363C14 1.78296 10.982 0.866961 8 0.866961ZM12.6667 12.3675C12.6667 12.7542 11.0313 13.7008 8 13.7008C4.96867 13.7008 3.33333 12.7542 3.33333 12.3675V9.86434C4.49067 10.4797 6.24933 10.7977 8 10.7977C9.75067 10.7977 11.5093 10.4797 12.6667 9.86434V12.3675ZM12.6667 8.131C12.6667 8.51767 11.0313 9.46434 8 9.46434C4.96867 9.46434 3.33333 8.51767 3.33333 8.131L3.33333 5.26696C4.49067 5.88229 6.24933 6.20029 8 6.20029C9.75067 6.20029 11.5093 5.88229 12.6667 5.26696V8.131ZM8 4.86696C4.96867 4.86696 3.33333 3.92029 3.33333 3.53363C3.33333 3.14696 4.96867 2.20029 8 2.20029C11.0313 2.20029 12.6667 3.14696 12.6667 3.53363C12.6667 3.92029 11.0313 4.86696 8 4.86696Z"
    }
  }]
};
var J9 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "database-icon",
    ref: n,
    icon: m4
  }));
});
J9.displayName = "DatabaseIcon";
var b4 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M3.00004 1.3335C2.07957 1.3335 1.33337 2.07969 1.33337 3.00016V13.0002C1.33337 13.9143 2.06935 14.6566 2.98108 14.6667C2.99252 14.6671 3.00399 14.6671 3.01547 14.6668H13C13.9205 14.6668 14.6667 13.9207 14.6667 13.0002V11.8335C14.6667 11.4653 14.3682 11.1668 14 11.1668C13.6319 11.1668 13.3334 11.4653 13.3334 11.8335V13.0002C13.3334 13.1843 13.1842 13.3335 13 13.3335H5.25636C5.61522 13.016 5.95119 12.6637 6.25105 12.2868C7.06748 11.2609 7.66671 9.98799 7.66671 8.66683V2.66683H13C13.1841 2.66683 13.3334 2.81606 13.3334 3.00016V4.66683C13.3334 5.03502 13.6319 5.3335 14 5.3335C14.3682 5.3335 14.6667 5.03502 14.6667 4.66683V3.00016C14.6667 2.0797 13.9205 1.3335 13 1.3335H3.00004ZM6.33337 2.66683H3.00004C2.81595 2.66683 2.66671 2.81607 2.66671 3.00016V13.0002C2.66671 13.1484 2.76345 13.274 2.89725 13.3173C3.70845 12.9437 4.55406 12.2781 5.20773 11.4566C5.90507 10.5803 6.33337 9.59203 6.33337 8.66683V2.66683Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M12.4714 5.86209C12.2111 5.60174 11.789 5.60174 11.5286 5.86209C11.2683 6.12244 11.2683 6.54455 11.5286 6.8049L12.3906 7.66683H10C9.63185 7.66683 9.33337 7.96531 9.33337 8.3335C9.33337 8.70169 9.63185 9.00016 10 9.00016H12.3906L11.5286 9.86209C11.2683 10.1224 11.2683 10.5446 11.5286 10.8049C11.789 11.0653 12.2111 11.0653 12.4714 10.8049L14.4714 8.8049C14.5935 8.68286 14.6583 8.52528 14.6659 8.36548C14.6665 8.35482 14.6667 8.34416 14.6667 8.3335L12.4714 5.86209Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M12.4714 5.86209L14.4714 7.86209C14.6001 7.9907 14.6651 8.15878 14.6667 8.32734L12.4714 5.86209Z"
      }
    }
  ]
};
var Q9 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "direct-export-icon",
    ref: n,
    icon: b4
  }));
});
Q9.displayName = "DirectExportIcon";
var L4 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M7.3999 2.8999V1.6C7.3999 1.26863 7.66853 1 7.9999 1C8.33127 1 8.5999 1.26863 8.5999 1.6V2.8999H10.2044C11.6655 2.8999 12.8499 4.08431 12.8499 5.54536C12.8499 5.87673 12.5813 6.14536 12.2499 6.14536C11.9185 6.14536 11.6499 5.87673 11.6499 5.54536C11.6499 4.74705 11.0028 4.0999 10.2044 4.0999H5.7384C4.97155 4.0999 4.3499 4.72155 4.3499 5.4884C4.3499 6.14439 4.80899 6.71087 5.45074 6.84677L10.7977 7.97906C11.994 8.23242 12.8499 9.28849 12.8499 10.5114C12.8499 11.941 11.691 13.0999 10.2614 13.0999H8.5999V14.4C8.5999 14.7314 8.33127 15 7.9999 15C7.66853 15 7.3999 14.7314 7.3999 14.4V13.0999H5.79536C4.33431 13.0999 3.1499 11.9155 3.1499 10.4544C3.1499 10.1231 3.41853 9.85445 3.7499 9.85445C4.08127 9.85445 4.3499 10.1231 4.3499 10.4544C4.3499 11.2527 4.99705 11.8999 5.79536 11.8999H10.2614C11.0283 11.8999 11.6499 11.2782 11.6499 10.5114C11.6499 9.85542 11.1908 9.28893 10.5491 9.15303L5.20214 8.02074C4.00575 7.76739 3.1499 6.71132 3.1499 5.4884C3.1499 4.05881 4.30881 2.8999 5.7384 2.8999H7.3999Z"
    }
  }]
};
var K9 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "dollar-icon",
    ref: n,
    icon: L4
  }));
});
K9.displayName = "DollarIcon";
var w4 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M5.84964 5.80918C6.71946 3.63548 8.84516 2.2 11.3295 2.2C11.8324 2.2 12.3198 2.26279 12.7846 2.38065C13.1058 2.46209 13.4322 2.26773 13.5137 1.94652C13.5951 1.62532 13.4008 1.2989 13.0795 1.21746C12.5191 1.07535 11.9327 1 11.3295 1C8.17278 1 5.49724 2.96009 4.57394 5.80918H3.06582C2.73445 5.80918 2.46582 6.07781 2.46582 6.40918C2.46582 6.74055 2.73445 7.00918 3.06582 7.00918H4.29808C4.25287 7.33297 4.22949 7.66376 4.22949 8C4.22949 8.33608 4.25284 8.6667 4.29801 8.99033H3.06582C2.73445 8.99033 2.46582 9.25896 2.46582 9.59033C2.46582 9.9217 2.73445 10.1903 3.06582 10.1903H4.57378C5.49693 13.0397 8.1726 15 11.3295 15C11.9336 15 12.5209 14.9244 13.0821 14.7819C13.4033 14.7003 13.5975 14.3738 13.5159 14.0527C13.4344 13.7315 13.1079 13.5373 12.7867 13.6188C12.3213 13.737 11.8332 13.8 11.3295 13.8C8.84497 13.8 6.71914 12.3643 5.84944 10.1903H11.4291C11.7605 10.1903 12.0291 9.9217 12.0291 9.59033C12.0291 9.25896 11.7605 8.99033 11.4291 8.99033H5.51225C5.45783 8.66834 5.42949 8.33748 5.42949 8C5.42949 7.66235 5.45786 7.33133 5.51233 7.00918H11.4291C11.7605 7.00918 12.0291 6.74055 12.0291 6.40918C12.0291 6.07781 11.7605 5.80918 11.4291 5.80918H5.84964Z"
    }
  }]
};
var e6 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "euro-icon",
    ref: n,
    icon: w4
  }));
});
e6.displayName = "EuroIcon";
var _4 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M3.65005 1.05005C2.21411 1.05005 1.05005 2.21411 1.05005 3.65005V12.35C1.05005 13.7859 2.21411 14.95 3.65005 14.95H14.35C14.6813 14.95 14.95 14.6813 14.95 14.35C14.95 14.0186 14.6813 13.75 14.35 13.75H3.65005C2.87685 13.75 2.25005 13.1232 2.25005 12.35V3.65005C2.25005 2.87685 2.87685 2.25005 3.65005 2.25005H14.35C14.6813 2.25005 14.95 1.98142 14.95 1.65005C14.95 1.31868 14.6813 1.05005 14.35 1.05005H3.65005Z"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M11.6167 5.26668C11.851 5.03236 12.2309 5.03236 12.4652 5.26668L14.7743 7.57575C15.0086 7.81007 15.0086 8.18997 14.7743 8.42428L12.4652 10.7334C12.2309 10.9677 11.851 10.9677 11.6167 10.7334C11.3823 10.499 11.3823 10.1191 11.6167 9.88483L12.9015 8.60002H6.63784C6.30647 8.60002 6.03784 8.3314 6.03784 8.00002C6.03784 7.66865 6.30647 7.40002 6.63784 7.40002H12.9015L11.6167 6.11521C11.3823 5.88089 11.3823 5.50099 11.6167 5.26668Z"
    }
  }]
};
var t6 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "export-icon",
    ref: n,
    icon: _4
  }));
});
t6.displayName = "ExportIcon";
var y4 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M7.46613 5.2614C7.99641 5.15377 8.54607 5.209 9.04566 5.42016C9.54527 5.63133 9.9725 5.98902 10.2732 6.44821C10.5739 6.90741 10.7345 7.44742 10.7345 7.99994C10.7345 8.74088 10.446 9.45122 9.93293 9.97475C9.41991 10.4982 8.72439 10.7921 7.99945 10.7921C7.45882 10.7921 6.93021 10.6285 6.48047 10.3219C6.03072 10.0152 5.67998 9.57922 5.47282 9.06887C5.26565 8.55852 5.21142 7.99686 5.31705 7.45498C5.42268 6.9131 5.68338 6.41554 6.06598 6.02513C6.44856 5.63474 6.93584 5.36903 7.46613 5.2614ZM7.99945 6.50637C7.70941 6.50637 7.42599 6.59414 7.18504 6.75842C6.94411 6.92269 6.75652 7.15604 6.64579 7.4288C6.53508 7.70156 6.50613 8.00161 6.56255 8.29108C6.61898 8.58055 6.7583 8.84663 6.96308 9.05559C7.16788 9.26456 7.42896 9.40703 7.7134 9.46476C7.99784 9.5225 8.29266 9.49286 8.56052 9.37964C8.82836 9.26643 9.05707 9.07481 9.21789 8.82922C9.3787 8.58364 9.46445 8.29505 9.46445 7.99994C9.46445 7.60424 9.31042 7.22449 9.03583 6.94429C8.76119 6.66405 8.38842 6.50637 7.99945 6.50637Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M1.06445 7.99994C1.06445 7.86432 1.111 7.68433 1.20506 7.46997C1.29865 7.25669 1.43723 7.01393 1.61634 6.75416C1.97451 6.23466 2.49209 5.65088 3.12753 5.10347C4.3995 4.00771 6.13495 3.06494 7.99945 3.06494C9.86395 3.06494 11.5994 4.00771 12.8714 5.10347C13.5068 5.65088 14.0244 6.23466 14.3826 6.75416C14.5617 7.01393 14.7003 7.25669 14.7938 7.46997C14.8879 7.68433 14.9345 7.86432 14.9345 7.99994C14.9345 8.29406 14.7859 8.75016 14.4847 9.27371C14.1847 9.79497 13.7374 10.3759 13.1495 10.9188C11.974 12.0042 10.2392 12.9349 7.99945 12.9349C5.75972 12.9349 4.02489 12.0042 2.84937 10.9188C2.26147 10.3759 1.81418 9.79497 1.51423 9.27371C1.21296 8.75016 1.06445 8.29406 1.06445 7.99994ZM7.99945 4.36351C6.48933 4.36351 5.14092 5.09788 4.14125 5.91406C3.64087 6.32258 3.22616 6.75295 2.92026 7.12521C2.61595 7.49554 2.415 7.81359 2.34753 7.99756L2.33827 8.0228L2.34954 8.0472C2.85275 9.13669 3.65354 10.055 4.65594 10.6918C5.65805 11.3283 6.81899 11.6563 7.99945 11.6364C9.17991 11.6563 10.3409 11.3283 11.343 10.6918C12.3454 10.055 13.1462 9.13669 13.6494 8.0472L13.6606 8.0228L13.6514 7.99756C13.5839 7.81359 13.383 7.49554 13.0786 7.12521C12.7727 6.75295 12.358 6.32258 11.8577 5.91406C10.858 5.09788 9.50957 4.36351 7.99945 4.36351Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var n6 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "eye-icon",
    ref: n,
    icon: y4
  }));
});
n6.displayName = "EyeIcon";
var M42 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M7.99967 10.6663C7.47226 10.6663 6.95669 10.5099 6.51815 10.2169C6.07962 9.92391 5.73783 9.50743 5.536 9.02016C5.33416 8.53289 5.28135 7.99672 5.38425 7.47943C5.48714 6.96215 5.74112 6.487 6.11406 6.11406C6.487 5.74112 6.96215 5.48714 7.47943 5.38425C7.99672 5.28135 8.53289 5.33416 9.02016 5.536C9.50743 5.73783 9.92391 6.07962 10.2169 6.51815C10.5099 6.95669 10.6663 7.47226 10.6663 7.99967C10.6663 8.70692 10.3854 9.3852 9.88529 9.88529C9.3852 10.3854 8.70692 10.6663 7.99967 10.6663ZM7.99967 6.66634C7.73597 6.66634 7.47818 6.74454 7.25891 6.89105C7.03965 7.03756 6.86875 7.2458 6.76784 7.48943C6.66692 7.73306 6.64051 8.00115 6.69196 8.25979C6.74341 8.51844 6.8704 8.75601 7.05687 8.94248C7.24334 9.12895 7.48091 9.25594 7.73955 9.30739C7.9982 9.35883 8.26628 9.33243 8.50992 9.23151C8.75355 9.1306 8.96179 8.9597 9.1083 8.74043C9.25481 8.52117 9.33301 8.26338 9.33301 7.99967C9.33301 7.64605 9.19253 7.30691 8.94248 7.05687C8.69243 6.80682 8.3533 6.66634 7.99967 6.66634Z"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M7.99967 12.6663C3.69701 12.6663 1.33301 9.16101 1.33301 7.99967C1.33301 6.89034 4.40767 3.33301 7.99967 3.33301C11.5917 3.33301 14.6663 6.89034 14.6663 7.99967C14.6663 9.16101 12.3023 12.6663 7.99967 12.6663ZM2.67501 8.01834C3.14932 9.02475 3.90405 9.87286 4.84857 10.4608C5.79309 11.0488 6.88725 11.3517 7.99967 11.333C9.1121 11.3517 10.2063 11.0488 11.1508 10.4608C12.0953 9.87286 12.85 9.02475 13.3243 8.01834C13.0823 7.37167 10.8363 4.66634 7.99967 4.66634C5.16301 4.66634 2.91701 7.37167 2.67501 8.01834Z"
    }
  }]
};
var r6 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "eye-outline-icon",
    ref: n,
    icon: M42
  }));
});
r6.displayName = "EyeOutlineIcon";
var I4 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M0.571533 12.0016V4.69797C0.571533 3.37249 1.64605 2.29797 2.97153 2.29797H5.00397C5.90947 2.29797 6.77882 2.65328 7.42511 3.2875C7.84704 3.70155 8.4146 3.93351 9.00576 3.93351H11.6938C12.8536 3.93351 13.7938 4.87372 13.7938 6.03351V6.83533H13.8982C15.064 6.83533 15.8384 8.04207 15.3527 9.10188L13.6724 12.7686C13.4118 13.3374 12.8435 13.702 12.2179 13.702H2.17045C1.20587 13.702 0.515561 12.8793 0.571533 12.0016ZM1.77153 4.69797C1.77153 4.03523 2.30879 3.49797 2.97153 3.49797H5.00397C5.59513 3.49797 6.16269 3.72993 6.58462 4.14399C7.23091 4.77821 8.10026 5.13351 9.00576 5.13351H11.6938C12.1909 5.13351 12.5938 5.53646 12.5938 6.03351V6.83533H4.64069C3.6604 6.83533 2.76344 7.38669 2.32081 8.26136L1.77153 9.34679V4.69797ZM1.77153 12.1373V12.0664C1.77594 12.0179 1.78952 11.9689 1.81355 11.9214L3.39152 8.80319C3.62986 8.33222 4.11284 8.03533 4.64069 8.03533H13.8982C14.1896 8.03533 14.3832 8.33701 14.2618 8.60197L12.5815 12.2687C12.5164 12.4109 12.3743 12.502 12.2179 12.502H2.17045C1.95161 12.502 1.78924 12.3326 1.77153 12.1373Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var o6 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "folder-icon",
    ref: n,
    icon: I4
  }));
});
o6.displayName = "FolderIcon";
var H4 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M4.92494 2.4224C5.37364 1.19807 7.10523 1.19807 7.55394 2.4224L11.7284 13.8128C11.8425 14.124 11.6827 14.4686 11.3716 14.5827C11.0604 14.6967 10.7158 14.5369 10.6017 14.2258L9.02773 9.93099C9.02555 9.93101 9.02338 9.93102 9.0212 9.93102H3.74372C3.6469 9.93102 3.55544 9.90809 3.47447 9.86736L1.87714 14.2258C1.76312 14.5369 1.41845 14.6967 1.10732 14.5827C0.796186 14.4686 0.636401 14.124 0.750429 13.8128L4.92494 2.4224ZM3.89093 8.73102H8.58795L6.42722 2.83533C6.36312 2.66043 6.11576 2.66042 6.05165 2.83533L3.89093 8.73102Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M13.0504 2.47954C13.0504 2.14817 12.7818 1.87954 12.4504 1.87954C12.1191 1.87954 11.8504 2.14817 11.8504 2.47954V4.11554H10.2144C9.88305 4.11554 9.61442 4.38417 9.61442 4.71554C9.61442 5.04691 9.88305 5.31554 10.2144 5.31554H11.8504V6.95155C11.8504 7.28292 12.1191 7.55155 12.4504 7.55155C12.7818 7.55155 13.0504 7.28292 13.0504 6.95155V5.31554H14.6864C15.0178 5.31554 15.2864 5.04691 15.2864 4.71554C15.2864 4.38417 15.0178 4.11554 14.6864 4.11554H13.0504V2.47954Z"
    }
  }]
};
var i6 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "font-size-increase-icon",
    ref: n,
    icon: H4
  }));
});
i6.displayName = "FontSizeIncreaseIcon";
var x4 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M4.92469 2.4224C5.3734 1.19807 7.10499 1.19807 7.5537 2.4224L11.7282 13.8128C11.8422 14.124 11.6824 14.4686 11.3713 14.5827C11.0602 14.6967 10.7155 14.5369 10.6015 14.2258L9.02748 9.93099C9.02539 9.93101 9.0233 9.93102 9.0212 9.93102H3.74372C3.64682 9.93102 3.55528 9.90805 3.47426 9.86726L1.8769 14.2258C1.76287 14.5369 1.41821 14.6967 1.10708 14.5827C0.795942 14.4686 0.636156 14.124 0.750185 13.8128L4.92469 2.4224ZM3.89068 8.73102H8.58771L6.42698 2.83533C6.36288 2.66043 6.11551 2.66042 6.05141 2.83533L3.89068 8.73102Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M9.61442 4.71554C9.61442 4.38417 9.88305 4.11554 10.2144 4.11554H14.6864C15.0178 4.11554 15.2864 4.38417 15.2864 4.71554C15.2864 5.04691 15.0178 5.31554 14.6864 5.31554H10.2144C9.88305 5.31554 9.61442 5.04691 9.61442 4.71554Z"
    }
  }]
};
var l6 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "font-size-reduce-icon",
    ref: n,
    icon: x4
  }));
});
l6.displayName = "FontSizeReduceIcon";
var S4 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M1.14014 12.2599C1.14014 13.6958 2.3042 14.8599 3.74014 14.8599H12.2601C13.6961 14.8599 14.8601 13.6958 14.8601 12.2599V3.73989C14.8601 2.30395 13.6961 1.13989 12.2601 1.13989H3.74014C2.3042 1.13989 1.14014 2.30396 1.14014 3.73989V12.2599ZM2.68766 13.1831C2.47131 12.9367 2.34014 12.6136 2.34014 12.2599V11.9756L5.68213 8.21656V9.69237L2.68766 13.1831ZM3.85969 13.6599H5.68213V11.5354L3.85969 13.6599ZM6.88213 13.6599H12.2601C13.0333 13.6599 13.6601 13.0331 13.6601 12.2599V3.73989C13.6601 2.96669 13.0333 2.33989 12.2601 2.33989H6.88213V13.6599ZM5.68213 2.33989H5.10563L2.34014 5.5448V6.99379L5.68213 3.23472V2.33989ZM2.34014 8.79985V10.1696L5.68213 6.4105V5.04078L2.34014 8.79985ZM2.3405 3.70754L3.50344 2.35982C2.85328 2.47053 2.35588 3.02952 2.3405 3.70754Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var s6 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "freeze-column-icon",
    ref: n,
    icon: S4
  }));
});
s6.displayName = "FreezeColumnIcon";
var R4 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M3.74015 1.13989C2.30421 1.13989 1.14015 2.30396 1.14015 3.73989V5.32866C1.14013 5.33155 1.14013 5.33444 1.14015 5.33732V12.2599C1.14015 13.6958 2.30421 14.8599 3.74015 14.8599H12.2602C13.6961 14.8599 14.8602 13.6958 14.8602 12.2599V3.73989C14.8602 2.46491 13.9424 1.40427 12.7315 1.18251C12.6397 1.14703 12.5407 1.13477 12.4436 1.14626C12.383 1.14204 12.3218 1.13989 12.2602 1.13989H3.74015ZM10.9392 2.33989H9.5695L5.81042 5.68188H7.18015L10.9392 2.33989ZM7.76344 2.33989H6.2816L2.34015 5.61425V5.68188H4.00437L7.76344 2.33989ZM2.34015 6.88188V12.2599C2.34015 13.0331 2.96695 13.6599 3.74015 13.6599H12.2602C13.0334 13.6599 13.6602 13.0331 13.6602 12.2599V6.88188H2.34015ZM13.6602 5.68188V4.48357L12.2714 5.68188H13.6602ZM13.4806 3.05349C13.3067 2.745 13.0193 2.50905 12.675 2.40238L8.98621 5.68188H10.4346L13.4806 3.05349ZM2.34015 4.05418L4.4037 2.33989H3.74015C2.96695 2.33989 2.34015 2.9667 2.34015 3.73989V4.05418Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var a6 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "freeze-row-icon",
    ref: n,
    icon: R4
  }));
});
a6.displayName = "FreezeRowIcon";
var V4 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M1.14014 3.73989C1.14014 2.30396 2.3042 1.13989 3.74014 1.13989H12.2601C12.3218 1.13989 12.383 1.14204 12.4436 1.14627C12.5406 1.13479 12.6397 1.14699 12.7315 1.18252C13.9424 1.4043 14.8601 2.46492 14.8601 3.73989V12.2599C14.8601 13.6905 13.7047 14.8513 12.2761 14.8598L12.2572 14.8599L3.74014 14.8599C2.3042 14.8599 1.14014 13.6958 1.14014 12.2599V3.73989ZM12.2677 13.6599L12.2601 13.6599H7.99297L7.99256 8.10687C7.99254 7.88594 8.17163 7.70684 8.39256 7.70684H13.6572V12.2599C13.6572 13.0296 13.0361 13.6542 12.2677 13.6599ZM8.39256 6.50684H9.82177L13.4929 3.07581C13.3217 2.75868 13.0317 2.51513 12.6826 2.40475L8.25499 6.51267C8.30033 6.50881 8.34621 6.50684 8.39256 6.50684ZM13.6601 4.56202L11.5792 6.50684H13.6601V4.56202ZM6.81297 7.85057C6.79953 7.93405 6.79255 8.01969 6.79256 8.10696L6.79265 9.36615L2.72441 13.2234C2.48625 12.9724 2.34014 12.6332 2.34014 12.2599V12.0005L6.81297 7.85057ZM4.00811 13.6599H6.79297L6.79277 11.0197L4.00811 13.6599ZM9.57168 2.33989H10.9882L2.34014 10.3635V8.8534L9.57168 2.33989ZM7.77864 2.33989L2.34014 7.2384V5.61425L6.28159 2.33989H7.77864ZM4.40368 2.33989L2.34014 4.05418V3.73989C2.34014 2.9667 2.96694 2.33989 3.74014 2.33989H4.40368Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var c6 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "freeze-to-selected-icon",
    ref: n,
    icon: V4
  }));
});
c6.displayName = "FreezeToSelectedIcon";
var O4 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M3.09318 3.78608C2.21639 2.9026 2.84219 1.3999 4.08689 1.3999H11.2079C11.7676 1.3999 12.3041 1.62335 12.6984 2.02063L13.2584 2.58488C13.4918 2.82009 13.4904 3.19998 13.2552 3.4334C13.02 3.66683 12.6401 3.66538 12.4066 3.43018L11.8467 2.86593C11.6777 2.69566 11.4477 2.5999 11.2079 2.5999H4.08689C3.90907 2.5999 3.81967 2.81458 3.94493 2.94079L8.24218 7.27082C8.66782 7.69971 8.66782 8.39164 8.24218 8.82053L3.94493 13.1506C3.81967 13.2768 3.90907 13.4915 4.08689 13.4915H11.2079C11.4477 13.4915 11.6777 13.3957 11.8467 13.2254L12.4066 12.6612C12.6401 12.426 13.02 12.4245 13.2552 12.658C13.4904 12.8914 13.4918 13.2713 13.2584 13.5065L12.6984 14.0707C12.3041 14.468 11.7676 14.6915 11.2079 14.6915H4.08689C2.84218 14.6915 2.2164 13.1888 3.09318 12.3053L7.32053 8.04568L3.09318 3.78608Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var J3 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "function-icon",
    ref: n,
    icon: O4
  }));
});
J3.displayName = "FunctionIcon";
var $4 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M1.33325 2.60309C1.33325 1.90178 1.90178 1.33325 2.60309 1.33325H13.3967C14.0981 1.33325 14.6666 1.90178 14.6666 2.60309V13.3967C14.6666 14.0981 14.0981 14.6666 13.3967 14.6666H2.60309C1.90178 14.6666 1.33325 14.0981 1.33325 13.3967V2.60309ZM10.5396 13.3967H13.3967V10.5396H10.5396V13.3967ZM9.26976 10.5396V13.3967H6.41262V10.5396H9.26976ZM10.5396 9.26976H13.3967V6.73008H10.5396V9.26976ZM9.26976 6.73008V9.26976H6.41262V6.73008H9.26976ZM10.5396 5.46024H13.3967V2.60309H10.5396V5.46024ZM9.26976 2.60309V5.46024H6.41262V2.60309H9.26976ZM2.60309 2.60309H5.14278V5.46024H2.60309V2.60309ZM2.60309 6.73008H5.14278V9.26976H2.60309V6.73008ZM2.60309 10.5396H5.14278V13.3967H2.60309V10.5396Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var u6 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "grid-icon",
    ref: n,
    icon: $4
  }));
});
u6.displayName = "GridIcon";
var E4 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M4.9999 3.90137C4.66853 3.90137 4.3999 4.17 4.3999 4.50137C4.3999 4.83274 4.66853 5.10137 4.9999 5.10137H10.9999C11.3313 5.10137 11.5999 4.83274 11.5999 4.50137C11.5999 4.17 11.3313 3.90137 10.9999 3.90137H4.9999Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M4.9999 10.8987C4.66853 10.8987 4.3999 11.1673 4.3999 11.4987C4.3999 11.8301 4.66853 12.0987 4.9999 12.0987H10.9999C11.3313 12.0987 11.5999 11.8301 11.5999 11.4987C11.5999 11.1673 11.3313 10.8987 10.9999 10.8987H4.9999Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M12.7 2.0999H3.30005C2.85822 2.0999 2.50005 2.45807 2.50005 2.8999V13.0999C2.50005 13.5417 2.85822 13.8999 3.30005 13.8999H12.7C13.1419 13.8999 13.5 13.5417 13.5 13.0999V2.8999C13.5 2.45808 13.1419 2.0999 12.7 2.0999ZM3.30005 0.899902C2.19548 0.899902 1.30005 1.79533 1.30005 2.8999V13.0999C1.30005 14.2045 2.19548 15.0999 3.30005 15.0999H12.7C13.8046 15.0999 14.7 14.2045 14.7 13.0999V2.8999C14.7 1.79533 13.8046 0.899902 12.7 0.899902H3.30005Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    }
  ]
};
var d6 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "header-footer-icon",
    ref: n,
    icon: E4
  }));
});
d6.displayName = "HeaderFooterIcon";
var N4 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M0.811013 7.27739C0.533711 7.51821 0.50413 7.93822 0.744942 8.21552C0.985753 8.49283 1.40577 8.52241 1.68307 8.28159L1.89249 8.09973V13.0201C1.89249 13.9397 2.63793 14.6851 3.55749 14.6851H5.32136C6.24091 14.6851 6.98636 13.9397 6.98636 13.0201V9.84218C6.98636 9.65717 7.13634 9.50718 7.32136 9.50718H8.67823C8.86325 9.50718 9.01323 9.65716 9.01323 9.84218V13.0201C9.01323 13.9397 9.75868 14.6851 10.6782 14.6851H12.4421C13.3617 14.6851 14.1071 13.9397 14.1071 13.0201V8.09963L14.3165 8.28148C14.5938 8.52229 15.0138 8.49271 15.2546 8.21541C15.4954 7.93811 15.4659 7.51809 15.1886 7.27728L8.567 1.52707C8.24167 1.24456 7.75801 1.24455 7.43267 1.52708L0.811013 7.27739ZM12.7771 6.94465L7.99984 2.79605L3.22249 6.94475V13.0201C3.22249 13.2051 3.37247 13.3551 3.55749 13.3551H5.32136C5.50637 13.3551 5.65636 13.2051 5.65636 13.0201V9.84218C5.65636 8.92263 6.4018 8.17718 7.32136 8.17718H8.67823C9.59779 8.17718 10.3432 8.92263 10.3432 9.84218V13.0201C10.3432 13.2051 10.4932 13.3551 10.6782 13.3551H12.4421C12.6271 13.3551 12.7771 13.2051 12.7771 13.0201V6.94465Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var h6 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "home-icon",
    ref: n,
    icon: N4
  }));
});
h6.displayName = "HomeIcon";
var D4 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M5.91296 6.82256L5.89774 6.82237L2.83868 6.8223C1.89982 6.82228 1.13874 6.06119 1.13872 5.12234L1.13867 3.32265C1.13865 2.38375 1.89977 1.62261 2.83866 1.62261L5.90639 1.62259L5.91296 1.62256L5.91953 1.62259L10.0821 1.62258L10.0868 1.62256L10.0914 1.62258L13.1607 1.62256C14.0996 1.62256 14.8607 2.38368 14.8607 3.32256V5.12253C14.8607 6.06143 14.0996 6.82256 13.1607 6.82253L10.0975 6.82246L10.0868 6.82256L10.076 6.82246L5.92815 6.82237L5.91296 6.82256ZM10.6868 5.62248L13.1607 5.62253C13.4368 5.62254 13.6607 5.39868 13.6607 5.12253V3.32256C13.6607 3.04642 13.4368 2.82256 13.1607 2.82256L10.6868 2.82257V5.62248ZM9.48679 2.82258V5.62245L6.51296 5.62238V2.82259L9.48679 2.82258ZM5.31296 2.8226V5.62236L2.8387 5.6223C2.56257 5.62229 2.33872 5.39845 2.33872 5.12231L2.33867 3.32262C2.33867 3.04647 2.56252 2.82261 2.83867 2.82261L5.31296 2.8226Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M1.1387 10.8773L1.13878 12.6773C1.13883 13.6162 1.89994 14.3772 2.8388 14.3772L5.90638 14.3772L5.91296 14.3772L5.91955 14.3772L10.0775 14.3772C10.0806 14.3772 10.0837 14.3772 10.0868 14.3772C10.0899 14.3772 10.093 14.3772 10.0961 14.3772L13.1607 14.3772C14.0996 14.3771 14.8607 13.616 14.8607 12.6772V10.8772C14.8607 9.93836 14.0996 9.17725 13.1607 9.17725H2.8387C1.89978 9.17725 1.13865 9.93841 1.1387 10.8773ZM9.48679 10.3772H6.51296V13.1772L9.48679 13.1772V10.3772ZM10.6868 13.1772V10.3772H13.1607C13.4369 10.3772 13.6607 10.6011 13.6607 10.8772V12.6772C13.6607 12.9533 13.4369 13.1771 13.1607 13.1772L10.6868 13.1772ZM5.31296 13.1772V10.3772H2.8387C2.56254 10.3772 2.33868 10.6011 2.3387 10.8773L2.33878 12.6773C2.33879 12.9534 2.56265 13.1772 2.83879 13.1772L5.31296 13.1772Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var f6 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "horizontal-merge-icon",
    ref: n,
    icon: D4
  }));
});
f6.displayName = "HorizontalMergeIcon";
var T4 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941C1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941C14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M3.33315 5.56641C3.00178 5.56641 2.73315 5.83504 2.73315 6.16641C2.73315 6.49778 3.00178 6.76641 3.33315 6.76641H12.6665C12.9979 6.76641 13.2665 6.49778 13.2665 6.16641C13.2665 5.83504 12.9979 5.56641 12.6665 5.56641H3.33315Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334C14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M3.33315 12.9004C3.00178 12.9004 2.73315 13.169 2.73315 13.5004C2.73315 13.8318 3.00178 14.1004 3.33315 14.1004H12.6665C12.9979 14.1004 13.2665 13.8318 13.2665 13.5004C13.2665 13.169 12.9979 12.9004 12.6665 12.9004H3.33315Z"
      }
    }
  ]
};
var C6 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "horizontally-icon",
    ref: n,
    icon: T4
  }));
});
C6.displayName = "HorizontallyIcon";
var Z4 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M8.6 1.99991C8.60001 1.66854 8.33138 1.39991 8.00001 1.3999C7.66864 1.3999 7.40001 1.66853 7.4 1.9999L7.39996 7.3999H1.9999C1.66853 7.3999 1.3999 7.66853 1.3999 7.9999C1.3999 8.33127 1.66853 8.5999 1.9999 8.5999H7.39995L7.3999 13.9999C7.3999 14.3313 7.66853 14.5999 7.9999 14.5999C8.33127 14.5999 8.5999 14.3313 8.5999 13.9999L8.59995 8.5999H13.9999C14.3313 8.5999 14.5999 8.33127 14.5999 7.9999C14.5999 7.66853 14.3313 7.3999 13.9999 7.3999H8.59996L8.6 1.99991Z"
    }
  }]
};
var v6 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "increase-icon",
    ref: n,
    icon: Z4
  }));
});
v6.displayName = "IncreaseIcon";
var A4 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M1.9999 1.3667C1.66853 1.3667 1.3999 1.63533 1.3999 1.9667C1.3999 2.29807 1.66853 2.5667 1.9999 2.5667H13.9999C14.3313 2.5667 14.5999 2.29807 14.5999 1.9667C14.5999 1.63533 14.3313 1.3667 13.9999 1.3667H1.9999Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M1.9999 13.4334C1.66853 13.4334 1.3999 13.7021 1.3999 14.0334C1.3999 14.3648 1.66853 14.6334 1.9999 14.6334H13.9999C14.3313 14.6334 14.5999 14.3648 14.5999 14.0334C14.5999 13.7021 14.3313 13.4334 13.9999 13.4334H1.9999Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M9.49336 10.4244C9.25905 10.19 9.25905 9.81015 9.49336 9.57583L10.4691 8.6001L4.08291 8.6001C3.75154 8.6001 3.48291 8.33147 3.48291 8.0001C3.48291 7.66873 3.75154 7.4001 4.08291 7.4001L10.4691 7.4001L9.49336 6.42436C9.25905 6.19005 9.25905 5.81015 9.49336 5.57583C9.72767 5.34152 10.1076 5.34152 10.3419 5.57583L12.3419 7.57583C12.5762 7.81015 12.5762 8.19005 12.3419 8.42436L10.3419 10.4244C10.1076 10.6587 9.72767 10.6587 9.49336 10.4244Z"
      }
    }
  ]
};
var g6 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "insert-icon",
    ref: n,
    icon: A4
  }));
});
g6.displayName = "InsertIcon";
var B4 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M9.80385 1.40005H11.9997C12.3311 1.40005 12.5997 1.66868 12.5997 2.00005C12.5997 2.33143 12.3311 2.60005 11.9997 2.60005H10.1185L7.12251 13.4001H9.33324C9.66461 13.4001 9.93324 13.6687 9.93324 14.0001C9.93324 14.3314 9.66461 14.6001 9.33324 14.6001H6.34785C6.33847 14.6003 6.32905 14.6003 6.31962 14.6001H3.9999C3.66853 14.6001 3.3999 14.3314 3.3999 14.0001C3.3999 13.6687 3.66853 13.4001 3.9999 13.4001H5.87719L8.87322 2.60005H6.66641C6.33504 2.60005 6.06641 2.33143 6.06641 2.00005C6.06641 1.66868 6.33504 1.40005 6.66641 1.40005H9.52916C9.61698 1.37929 9.71064 1.3781 9.80385 1.40005Z"
    }
  }]
};
var p6 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "italic-icon",
    ref: n,
    icon: B4
  }));
});
p6.displayName = "ItalicIcon";
var P4 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M3.39986 6.33339C3.39986 6.00202 3.66849 5.73339 3.99986 5.73339H4.66652C4.99789 5.73339 5.26652 6.00202 5.26652 6.33339C5.26652 6.66476 4.99789 6.93339 4.66652 6.93339H3.99986C3.66849 6.93339 3.39986 6.66476 3.39986 6.33339Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M6.99986 5.73339C6.66849 5.73339 6.39986 6.00202 6.39986 6.33339C6.39986 6.66476 6.66849 6.93339 6.99986 6.93339H7.66652C7.99789 6.93339 8.26652 6.66476 8.26652 6.33339C8.26652 6.00202 7.99789 5.73339 7.66652 5.73339H6.99986Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M9.06636 6.33339C9.06636 6.00202 9.33499 5.73339 9.66636 5.73339H11.9997C12.3311 5.73339 12.5997 6.00202 12.5997 6.33339C12.5997 6.66476 12.3311 6.93339 11.9997 6.93339H9.66636C9.33499 6.93339 9.06636 6.66476 9.06636 6.33339Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M3.99986 8.73339C3.66849 8.73339 3.39986 9.00202 3.39986 9.33339C3.39986 9.66476 3.66849 9.93339 3.99986 9.93339H11.9999C12.3312 9.93339 12.5999 9.66476 12.5999 9.33339C12.5999 9.00202 12.3312 8.73339 11.9999 8.73339H3.99986Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M3.33338 1.73345L12.6667 1.7334C14.1026 1.73339 15.2667 2.89745 15.2667 4.3334V11C15.2667 12.4359 14.1027 13.6 12.6667 13.6H3.33355C1.89763 13.6 0.733583 12.4359 0.73355 11L0.733398 4.33351C0.733366 2.89755 1.89742 1.73346 3.33338 1.73345ZM12.6667 2.9334L3.33339 2.93345C2.56018 2.93346 1.93338 3.56028 1.9334 4.33348L1.93355 11C1.93357 11.7732 2.56036 12.4 3.33355 12.4H12.6667C13.4399 12.4 14.0667 11.7732 14.0667 11V4.3334C14.0667 3.5602 13.4399 2.93339 12.6667 2.9334Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    }
  ]
};
var m6 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "keyboard-icon",
    ref: n,
    icon: P4
  }));
});
m6.displayName = "KeyboardIcon";
var F4 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941C1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941C14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M1.9999 5.56641C1.66853 5.56641 1.3999 5.83504 1.3999 6.16641C1.3999 6.49778 1.66853 6.76641 1.9999 6.76641H11.3332C11.6646 6.76641 11.9332 6.49778 11.9332 6.16641C11.9332 5.83504 11.6646 5.56641 11.3332 5.56641H1.9999Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334C14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M1.9999 12.9004C1.66853 12.9004 1.3999 13.169 1.3999 13.5004C1.3999 13.8318 1.66853 14.1004 1.9999 14.1004H11.3332C11.6646 14.1004 11.9332 13.8318 11.9332 13.5004C11.9332 13.169 11.6646 12.9004 11.3332 12.9004H1.9999Z"
      }
    }
  ]
};
var b6 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "left-justifying-icon",
    ref: n,
    icon: F4
  }));
});
b6.displayName = "LeftJustifyingIcon";
var k4 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M1.3732 3.94019C0.82475 2.75718 2.04917 1.53276 3.23218 2.0812L10.0657 5.24921C10.3663 5.38859 10.497 5.74529 10.3576 6.04592C10.2183 6.34656 9.86157 6.47728 9.56094 6.33791L6.86664 5.08883L4.42613 7.52934C4.41111 7.54436 4.3955 7.55841 4.37936 7.5715L5.6299 10.2689C5.76928 10.5696 5.63855 10.9263 5.33791 11.0656C5.03728 11.205 4.68058 11.0743 4.54121 10.7737L1.3732 3.94019ZM2.72746 3.1699L5.70713 4.55128L3.84327 6.41514L2.46189 3.43547C2.38354 3.26647 2.55846 3.09155 2.72746 3.1699Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M4.56311 13.7359C4.32879 13.9702 4.32879 14.3501 4.56311 14.5844C4.79742 14.8188 5.17732 14.8188 5.41163 14.5844L13.3083 6.68776L13.3842 8.21165C13.4006 8.54261 13.6823 8.79755 14.0133 8.78108C14.3442 8.76461 14.5992 8.48295 14.5827 8.15199L14.4844 6.17786C14.4413 5.3118 13.3917 4.90732 12.7786 5.52046L4.56311 13.7359Z"
    }
  }]
};
var L6 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "left-rotation-forty-five-degrees-icon",
    ref: n,
    icon: k4
  }));
});
L6.displayName = "LeftRotationFortyFiveDegreesIcon";
var j4 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M11.4046 13.9395C11.4046 14.2708 11.6732 14.5395 12.0046 14.5395C12.336 14.5395 12.6046 14.2708 12.6046 13.9395V2.77186L13.7358 3.79578C13.9815 4.01815 14.3609 3.99927 14.5833 3.75359C14.8057 3.50792 14.7868 3.12849 14.5411 2.90612L13.0757 1.57967C12.4328 0.997761 11.4046 1.45394 11.4046 2.32106V13.9395Z"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M2.22244 9.26836C0.998116 8.81966 0.998119 7.08807 2.22245 6.63936L9.29456 4.04749C9.60569 3.93346 9.95036 4.09325 10.0644 4.40438C10.1784 4.71551 10.0186 5.06018 9.70749 5.1742L6.91911 6.19613V9.64753C6.91911 9.66877 6.918 9.68974 6.91585 9.71041L9.70749 10.7335C10.0186 10.8476 10.1784 11.1922 10.0644 11.5033C9.95036 11.8145 9.60569 11.9743 9.29456 11.8602L2.22244 9.26836ZM2.63538 7.76608L5.71911 6.63592V9.27181L2.63538 8.14165C2.46047 8.07755 2.46047 7.83018 2.63538 7.76608Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var w6 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "left-rotation-ninety-degrees-icon",
    ref: n,
    icon: j4
  }));
});
w6.displayName = "LeftRotationNinetyDegreesIcon";
var U4 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M4.96708 8.23432V11.6842C4.96708 12.0156 5.2357 12.2842 5.56708 12.2842C5.89845 12.2842 6.16708 12.0156 6.16708 11.6842V5.62199C6.16708 4.70621 4.87775 4.5088 4.60373 5.38261L3.2564 9.67905L1.90905 5.3826C1.64268 4.53318 0.345703 4.6789 0.345703 5.62021V11.6842C0.345703 12.0156 0.614332 12.2842 0.945703 12.2842C1.27707 12.2842 1.5457 12.0156 1.5457 11.6842V8.23428L2.49305 11.2552C2.72747 12.0027 3.78534 12.0027 4.01975 11.2552L4.96708 8.23432Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M9.59409 8.3393C9.59409 7.86618 9.18572 7.49641 8.71492 7.54323L7.64429 7.64971C7.31454 7.6825 7.02065 7.44178 6.98785 7.11203C6.95506 6.78229 7.19578 6.48839 7.52553 6.4556L8.59616 6.34912C9.77317 6.23206 10.7941 7.15649 10.7941 8.3393V11.684C10.7941 12.0154 10.5255 12.284 10.1941 12.284C9.86272 12.284 9.59409 12.0154 9.59409 11.684V8.3393Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M6.79541 10.2064C6.79541 9.10233 7.69047 8.20728 8.79458 8.20728C9.89869 8.20728 10.7938 9.10233 10.7938 10.2064C10.7938 11.3106 9.89869 12.2056 8.79458 12.2056C7.69047 12.2056 6.79541 11.3106 6.79541 10.2064ZM8.79458 9.40728C8.35321 9.40728 7.99541 9.76508 7.99541 10.2064C7.99541 10.6478 8.35321 11.0056 8.79458 11.0056C9.23595 11.0056 9.59375 10.6478 9.59375 10.2064C9.59375 9.76508 9.23595 9.40728 8.79458 9.40728Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M15.386 6.62139C15.6666 6.79764 15.7454 7.16426 15.562 7.44024L12.5296 12.0032C12.3462 12.2791 11.9701 12.36 11.6894 12.1837C11.4088 12.0075 11.33 11.6409 11.5135 11.3649L14.5458 6.80196C14.7292 6.52598 15.1054 6.44513 15.386 6.62139Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M11.6892 6.62139C11.4086 6.79764 11.3298 7.16426 11.5132 7.44024L14.5456 12.0032C14.729 12.2791 15.1051 12.36 15.3857 12.1837C15.6664 12.0075 15.7451 11.6409 15.5617 11.3649L12.5294 6.80196C12.3459 6.52598 11.9698 6.44513 11.6892 6.62139Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    }
  ]
};
var _6 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "max-icon",
    ref: n,
    icon: U4
  }));
});
_6.displayName = "MaxIcon";
var z4 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M1.66504 2.8666C1.66504 2.53523 1.93367 2.2666 2.26504 2.2666H13.735C14.0664 2.2666 14.335 2.53523 14.335 2.8666C14.335 3.19797 14.0664 3.4666 13.735 3.4666H2.26504C1.93367 3.4666 1.66504 3.19797 1.66504 2.8666Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M1.66504 8.00002C1.66504 7.66865 1.93367 7.40002 2.26504 7.40002H13.735C14.0664 7.40002 14.335 7.66865 14.335 8.00002C14.335 8.3314 14.0664 8.60002 13.735 8.60002H2.26504C1.93367 8.60002 1.66504 8.3314 1.66504 8.00002Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M2.26504 12.5334C1.93367 12.5334 1.66504 12.8021 1.66504 13.1334C1.66504 13.4648 1.93367 13.7334 2.26504 13.7334H13.735C14.0664 13.7334 14.335 13.4648 14.335 13.1334C14.335 12.8021 14.0664 12.5334 13.735 12.5334H2.26504Z"
      }
    }
  ]
};
var y6 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "menu-icon",
    ref: n,
    icon: z4
  }));
});
y6.displayName = "MenuIcon";
var W4 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M12.5939 1.13916L10.6607 1.1392C9.5563 1.13922 8.66094 2.03448 8.66079 3.13893L8.66064 4.19191C8.6606 4.52328 8.92919 4.79194 9.26056 4.79199C9.59193 4.79204 9.8606 4.52344 9.86064 4.19207L9.86079 3.13909C9.86085 2.69731 10.219 2.33921 10.6608 2.3392L12.594 2.33916C13.0358 2.33915 13.394 2.69732 13.394 3.13916L13.394 7.40012H10.4947L11.0464 6.84845C11.2807 6.61414 11.2807 6.23424 11.0464 5.99993C10.8121 5.76561 10.4322 5.76561 10.1979 5.99993L9.31395 6.88384C8.68914 7.50867 8.68914 8.52171 9.31396 9.14654L10.1979 10.0305C10.4322 10.2648 10.8121 10.2648 11.0464 10.0305C11.2807 9.79614 11.2807 9.41624 11.0464 9.18192L10.4646 8.60012H13.394L13.394 12.8612C13.394 13.303 13.0359 13.6612 12.594 13.6612H10.6606C10.2188 13.6612 9.86064 13.303 9.86064 12.8612V11.8084C9.86064 11.4771 9.59202 11.2084 9.26064 11.2084C8.92927 11.2084 8.66064 11.4771 8.66064 11.8084V12.8612C8.66064 13.9658 9.55607 14.8612 10.6606 14.8612H12.594C13.6986 14.8612 14.594 13.9658 14.594 12.8612L14.594 8.0066L14.594 8.00012L14.594 7.99363L14.594 3.13915C14.594 2.03457 13.6985 1.13914 12.5939 1.13916Z"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M5.33889 1.13919L3.4057 1.13926C2.30115 1.13931 1.40576 2.03474 1.40578 3.13928L1.40582 7.99139L1.40576 8.00012L1.40582 8.00886L1.40587 12.8612C1.40588 13.9658 2.30131 14.8612 3.40587 14.8612H5.33897C6.44354 14.8612 7.33897 13.9658 7.33897 12.8612V11.8084C7.33897 11.4771 7.07034 11.2084 6.73897 11.2084C6.4076 11.2084 6.13897 11.4771 6.13897 11.8084V12.8612C6.13897 13.303 5.7808 13.6612 5.33897 13.6612H3.40587C2.96405 13.6612 2.60588 13.303 2.60587 12.8612L2.60583 8.60012H5.53538L4.95357 9.18193C4.71925 9.41624 4.71925 9.79614 4.95357 10.0305C5.18788 10.2648 5.56778 10.2648 5.8021 10.0305L6.68599 9.14656C7.31083 8.52172 7.31083 7.50866 6.68599 6.88382L5.8021 5.99993C5.56778 5.76561 5.18788 5.76561 4.95357 5.99993C4.71925 6.23424 4.71925 6.61414 4.95357 6.84845L5.50523 7.40012H2.60582L2.60578 3.13927C2.60577 2.69745 2.96393 2.33928 3.40574 2.33926L5.33894 2.33919C5.78078 2.33917 6.13897 2.69735 6.13897 3.13919V4.192C6.13897 4.52337 6.4076 4.792 6.73897 4.792C7.07034 4.792 7.33897 4.52337 7.33897 4.192V3.13919C7.33897 2.03459 6.44349 1.13914 5.33889 1.13919Z"
    }
  }]
};
var M6 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "merge-all-icon",
    ref: n,
    icon: W4
  }));
});
M6.displayName = "MergeAllIcon";
var Y4 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M8.6707 7.03525C9.0573 7.03525 9.3707 6.72185 9.3707 6.33525C9.3707 5.94866 9.0573 5.63525 8.6707 5.63525C8.28411 5.63525 7.9707 5.94866 7.9707 6.33525C7.9707 6.72185 8.28411 7.03525 8.6707 7.03525Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M8.671 12.2842C8.33963 12.2842 8.071 12.0156 8.071 11.6842L8.071 8.20615C8.071 7.87478 8.33962 7.60615 8.671 7.60615C9.00237 7.60615 9.271 7.87478 9.271 8.20615L9.271 11.6842C9.271 12.0156 9.00237 12.2842 8.671 12.2842Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M13.5105 9.62735C13.5105 9.09992 13.0091 8.71683 12.5002 8.8555L12.1671 8.94628C11.7319 9.06486 11.43 9.46007 11.43 9.9111V11.6842C11.43 12.0156 11.1614 12.2842 10.83 12.2842C10.4986 12.2842 10.23 12.0156 10.23 11.6842V9.9111C10.23 8.91884 10.8942 8.04938 11.8516 7.7885L12.1847 7.69771C13.4569 7.35104 14.7105 8.30878 14.7105 9.62735V11.6842C14.7105 12.0156 14.4419 12.2842 14.1105 12.2842C13.7792 12.2842 13.5105 12.0156 13.5105 11.6842V9.62735Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M10.8377 7.66644C11.169 7.66642 11.4377 7.93503 11.4377 8.2664L11.438 11.6841C11.438 12.0155 11.1694 12.2841 10.838 12.2842C10.5066 12.2842 10.238 12.0156 10.238 11.6842L10.2377 8.26649C10.2377 7.93512 10.5063 7.66647 10.8377 7.66644Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M5.91043 8.23408V11.684C5.91043 12.0154 6.17906 12.284 6.51043 12.284C6.84181 12.284 7.11043 12.0154 7.11043 11.684V5.62174C7.11043 4.70597 5.82111 4.50856 5.54709 5.38237L4.19976 9.67881L2.85241 5.38235C2.58604 4.53293 1.28906 4.67865 1.28906 5.61997V11.684C1.28906 12.0154 1.55769 12.284 1.88906 12.284C2.22043 12.284 2.48906 12.0154 2.48906 11.684V8.23404L3.43641 11.255C3.67082 12.0025 4.7287 12.0025 4.9631 11.255L5.91043 8.23408Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    }
  ]
};
var I6 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "min-icon",
    ref: n,
    icon: Y4
  }));
});
I6.displayName = "MinIcon";
var G4 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M11.3536 6.14645C11.5488 6.34171 11.5488 6.65829 11.3536 6.85355L8.35355 9.85355C8.15829 10.0488 7.84171 10.0488 7.64645 9.85355L4.64645 6.85355C4.45118 6.65829 4.45118 6.34171 4.64645 6.14645C4.84171 5.95118 5.15829 5.95118 5.35355 6.14645L8 8.79289L10.6464 6.14645C10.8417 5.95118 11.1583 5.95118 11.3536 6.14645Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var me2 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "more-down-icon",
    ref: n,
    icon: G4
  }));
});
me2.displayName = "MoreDownIcon";
var X4 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M8 3.30078C8.55228 3.30078 9 2.85307 9 2.30078C9 1.7485 8.55228 1.30078 8 1.30078C7.44772 1.30078 7 1.7485 7 2.30078C7 2.85307 7.44772 3.30078 8 3.30078Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M8 9.00012C8.55228 9.00012 9 8.55241 9 8.00012C9 7.44784 8.55228 7.00012 8 7.00012C7.44772 7.00012 7 7.44784 7 8.00012C7 8.55241 7.44772 9.00012 8 9.00012Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M9 13.6995C9 14.2517 8.55228 14.6995 8 14.6995C7.44772 14.6995 7 14.2517 7 13.6995C7 13.1472 7.44772 12.6995 8 12.6995C8.55228 12.6995 9 13.1472 9 13.6995Z"
      }
    }
  ]
};
var Q3 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "more-function-icon",
    ref: n,
    icon: X4
  }));
});
Q3.displayName = "MoreFunctionIcon";
var q4 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M5.90913 3.57564C6.14345 3.34132 6.52335 3.34132 6.75766 3.57564L10.7577 7.57564C10.992 7.80995 10.992 8.18985 10.7577 8.42417L6.75766 12.4242C6.52335 12.6585 6.14345 12.6585 5.90913 12.4242C5.67482 12.1899 5.67482 11.81 5.90913 11.5756L9.48487 7.9999L5.90913 4.42417C5.67482 4.18985 5.67482 3.80995 5.90913 3.57564Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var Z3 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "more-icon",
    ref: n,
    icon: q4
  }));
});
Z3.displayName = "MoreIcon";
var J42 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M7.1349 1.3999C6.80353 1.3999 6.5349 1.66853 6.5349 1.9999C6.5349 2.33127 6.80353 2.5999 7.1349 2.5999H7.67993V4.55065C7.67993 4.88203 7.94856 5.15065 8.27993 5.15065C8.6113 5.15065 8.87993 4.88203 8.87993 4.55065V2.5999H9.4049C9.73627 2.5999 10.0049 2.33127 10.0049 1.9999C10.0049 1.66853 9.73627 1.3999 9.4049 1.3999H7.1349Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M2.5999 7.1349C2.5999 6.80353 2.33127 6.5349 1.9999 6.5349C1.66853 6.5349 1.3999 6.80353 1.3999 7.1349V9.4049C1.3999 9.73627 1.66853 10.0049 1.9999 10.0049C2.33127 10.0049 2.5999 9.73627 2.5999 9.4049V8.86968H4.54992C4.88129 8.86968 5.14992 8.60105 5.14992 8.26968C5.14992 7.93831 4.88129 7.66968 4.54992 7.66968H2.5999V7.1349Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M15.1399 7.1349C15.1399 6.80353 14.8713 6.5349 14.5399 6.5349C14.2085 6.5349 13.9399 6.80353 13.9399 7.1349V7.66968H12.0099C11.6786 7.66968 11.4099 7.93831 11.4099 8.26968C11.4099 8.60105 11.6786 8.86968 12.0099 8.86968H13.9399V9.4049C13.9399 9.73627 14.2085 10.0049 14.5399 10.0049C14.8713 10.0049 15.1399 9.73627 15.1399 9.4049V8.27463L15.1399 8.26968L15.1399 8.26472V7.1349Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M7.1349 13.9399C6.80353 13.9399 6.5349 14.2085 6.5349 14.5399C6.5349 14.8713 6.80353 15.1399 7.1349 15.1399H8.24962C8.25966 15.1404 8.26977 15.1407 8.27993 15.1407C8.2901 15.1407 8.3002 15.1404 8.31024 15.1399H9.4049C9.73627 15.1399 10.0049 14.8713 10.0049 14.5399C10.0049 14.2085 9.73627 13.9399 9.4049 13.9399H8.87993V12.0107C8.87993 11.6793 8.6113 11.4107 8.27993 11.4107C7.94856 11.4107 7.67993 11.6793 7.67993 12.0107V13.9399H7.1349Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M2.60991 4.00967C2.60991 3.23647 3.23671 2.60967 4.00991 2.60967H4.33991C4.67128 2.60967 4.93991 2.34104 4.93991 2.00967C4.93991 1.6783 4.67128 1.40967 4.33991 1.40967H4.00991C2.57397 1.40967 1.40991 2.57373 1.40991 4.00967V4.33967C1.40991 4.67104 1.67854 4.93967 2.00991 4.93967C2.34128 4.93967 2.60991 4.67104 2.60991 4.33967V4.00967Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M12.1999 1.40967C11.8685 1.40967 11.5999 1.6783 11.5999 2.00967C11.5999 2.34104 11.8685 2.60967 12.1999 2.60967H12.5299C13.3031 2.60967 13.9299 3.23647 13.9299 4.00967V4.33967C13.9299 4.67104 14.1985 4.93967 14.5299 4.93967C14.8613 4.93967 15.1299 4.67104 15.1299 4.33967V4.00967C15.1299 2.57373 13.9659 1.40967 12.5299 1.40967H12.1999Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M2.60991 12.1997C2.60991 11.8683 2.34128 11.5997 2.00991 11.5997C1.67854 11.5997 1.40991 11.8683 1.40991 12.1997V12.5297C1.40991 13.9656 2.57397 15.1297 4.00991 15.1297H4.33991C4.67128 15.1297 4.93991 14.861 4.93991 14.5297C4.93991 14.1983 4.67128 13.9297 4.33991 13.9297H4.00991C3.23671 13.9297 2.60991 13.3029 2.60991 12.5297V12.1997Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M15.1299 12.1997C15.1299 11.8683 14.8613 11.5997 14.5299 11.5997C14.1985 11.5997 13.9299 11.8683 13.9299 12.1997V12.5297C13.9299 13.3029 13.3031 13.9297 12.5299 13.9297H12.1999C11.8685 13.9297 11.5999 14.1983 11.5999 14.5297C11.5999 14.861 11.8685 15.1297 12.1999 15.1297H12.5299C13.9659 15.1297 15.1299 13.9656 15.1299 12.5297V12.1997Z"
      }
    }
  ]
};
var H6 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "no-border-icon",
    ref: n,
    icon: J42
  }));
});
H6.displayName = "NoBorderIcon";
var Q4 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M6.671 2.24246C7.1197 1.01814 8.85129 1.01814 9.3 2.24246L11.8919 9.31458C12.0059 9.62571 11.8461 9.97038 11.535 10.0844C11.2238 10.1984 10.8792 10.0386 10.7652 9.72751L9.74324 6.93913H6.29183C6.2706 6.93913 6.24962 6.93802 6.22895 6.93587L5.20584 9.72751C5.09181 10.0386 4.74715 10.1984 4.43601 10.0844C4.12488 9.97038 3.96509 9.62571 4.07912 9.31458L6.671 2.24246ZM8.17328 2.6554L9.30345 5.73913H6.66755L7.79771 2.6554C7.86181 2.48049 8.10918 2.48049 8.17328 2.6554Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M1.9999 11.4246C1.66853 11.4246 1.3999 11.6933 1.3999 12.0246C1.3999 12.356 1.66853 12.6246 1.9999 12.6246H13.1675L12.1436 13.7558C11.9212 14.0015 11.9401 14.3809 12.1858 14.6033C12.4314 14.8257 12.8109 14.8068 13.0332 14.5611L14.3597 13.0957C14.9416 12.4528 14.4854 11.4246 13.6183 11.4246H1.9999Z"
    }
  }]
};
var x6 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "no-rotation-icon",
    ref: n,
    icon: Q4
  }));
});
x6.displayName = "NoRotationIcon";
var K4 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 17 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M1.65465 3.96697V2.9942C1.65465 2.9188 1.64353 2.86563 1.62465 2.83387C1.61052 2.81011 1.58943 2.79243 1.53852 2.79243H1.44483C1.23836 2.79243 1.07099 2.62506 1.07099 2.41859C1.07099 2.23956 1.19714 2.09152 1.36369 2.04728C1.4425 2.02634 1.51336 2.00423 1.57642 1.98104C1.65529 1.94986 1.73286 1.91381 1.80913 1.87285C1.8974 1.82544 1.99768 1.79517 2.10303 1.79517C2.41692 1.79517 2.67137 2.04962 2.67137 2.36351V4.02047C2.67137 4.12385 2.75517 4.20765 2.85855 4.20765C3.0614 4.20765 3.22585 4.3721 3.22585 4.57495V4.63332C3.22585 4.86842 3.03527 5.059 2.80018 5.059H1.41884C1.1829 5.059 0.993164 4.86511 0.993164 4.63087C0.993164 4.39932 1.18072 4.20765 1.41398 4.20765C1.5469 4.20765 1.65465 4.09989 1.65465 3.96697Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M0.949709 9.2145C1.14957 9.02907 1.33226 8.85497 1.49677 8.69321C1.6914 8.50496 1.84244 8.33306 1.95136 8.17747C2.05826 8.02476 2.10492 7.89219 2.10492 7.77781C2.10492 7.65255 2.07293 7.57986 2.02759 7.53865L2.0245 7.5357C1.97641 7.48761 1.9103 7.46013 1.81635 7.46013C1.71986 7.46013 1.6383 7.47348 1.5822 7.51611L1.58034 7.51749C1.42279 7.63092 1.19425 7.67086 1.03149 7.50811L1.02187 7.49849C0.868433 7.34505 0.852261 7.07998 1.03819 6.93364C1.12802 6.86293 1.21897 6.8051 1.31109 6.76081C1.48788 6.67257 1.69616 6.63037 1.93278 6.63037C2.15191 6.63037 2.34929 6.67491 2.52246 6.76665C2.69563 6.85514 2.83257 6.98323 2.93172 7.14966C3.03175 7.31758 3.08022 7.51184 3.08022 7.72929C3.08022 7.91104 3.03028 8.09333 2.93429 8.27521C2.84374 8.45283 2.72797 8.62691 2.58859 8.79616C2.51109 8.88842 2.43304 8.97759 2.35442 9.06369C2.34919 9.06941 2.34388 9.07573 2.33892 9.08228C2.34542 9.08201 2.35268 9.08151 2.36075 9.08073C2.46266 9.07087 2.54985 9.06576 2.62168 9.06576H2.78662C3.02915 9.06576 3.22576 9.26237 3.22576 9.5049C3.22576 9.74742 3.02915 9.94403 2.78662 9.94403H1.23472C1.00261 9.94403 0.814453 9.75587 0.814453 9.52376C0.814453 9.40615 0.86379 9.29421 0.949709 9.2145Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M1.2579 14.674C1.45109 14.7553 1.67487 14.7946 1.92711 14.7946C2.1451 14.7946 2.34841 14.7599 2.53619 14.6895L2.53746 14.689C2.7264 14.6148 2.88145 14.5071 2.99952 14.3647L3.00018 14.3639C3.12167 14.2138 3.18089 14.0326 3.18089 13.8252C3.18089 13.6181 3.12169 13.4411 2.99737 13.3022C2.91596 13.2112 2.81864 13.1388 2.70642 13.0846C2.80611 13.023 2.88805 12.9505 2.95017 12.8661C3.04138 12.7422 3.08609 12.5977 3.08609 12.4365C3.08609 12.1403 2.97594 11.9041 2.7521 11.7404C2.53645 11.5772 2.25212 11.5002 1.90815 11.5002C1.7136 11.5002 1.52963 11.5372 1.35712 11.6115C1.28512 11.6418 1.21426 11.6776 1.14456 11.7188C0.938688 11.8404 0.928034 12.1099 1.06649 12.2774C1.21291 12.4544 1.46028 12.4561 1.63989 12.363C1.70891 12.3286 1.78521 12.3109 1.87023 12.3109C1.96356 12.3109 2.01717 12.3317 2.04691 12.3578C2.07449 12.3821 2.09529 12.4231 2.09529 12.4981C2.09529 12.5709 2.0658 12.6284 1.99667 12.6764C1.96042 12.6999 1.8978 12.7216 1.80025 12.7355C1.61051 12.7625 1.44118 12.9145 1.44118 13.1237C1.44118 13.3319 1.60937 13.4885 1.80489 13.5068C1.87785 13.5136 1.93575 13.5234 1.97985 13.5355C2.07997 13.562 2.12905 13.596 2.14927 13.6246C2.17519 13.6614 2.19008 13.7078 2.19008 13.7684C2.19008 13.8334 2.16583 13.8754 2.1142 13.9064C2.05357 13.9428 1.96521 13.965 1.84179 13.965C1.749 13.965 1.6547 13.9433 1.55817 13.8981C1.363 13.7983 1.08846 13.8083 0.942801 14.01L0.936366 14.0189C0.827321 14.1699 0.821861 14.401 0.994678 14.5262C1.07406 14.5836 1.16225 14.633 1.2579 14.674Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M5.13037 2.827C4.799 2.827 4.53037 3.09563 4.53037 3.427C4.53037 3.75837 4.799 4.027 5.13037 4.027H15.1489C15.4803 4.027 15.7489 3.75837 15.7489 3.427C15.7489 3.09563 15.4803 2.827 15.1489 2.827H5.13037Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M4.53037 8.28711C4.53037 7.95574 4.799 7.68711 5.13037 7.68711H15.1489C15.4803 7.68711 15.7489 7.95574 15.7489 8.28711C15.7489 8.61848 15.4803 8.88711 15.1489 8.88711H5.13037C4.799 8.88711 4.53037 8.61848 4.53037 8.28711Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M5.13037 12.5475C4.799 12.5475 4.53037 12.8161 4.53037 13.1475C4.53037 13.4788 4.799 13.7475 5.13037 13.7475H15.1489C15.4803 13.7475 15.7489 13.4788 15.7489 13.1475C15.7489 12.8161 15.4803 12.5475 15.1489 12.5475H5.13037Z"
      }
    }
  ]
};
var S6 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "order-icon",
    ref: n,
    icon: K4
  }));
});
S6.displayName = "OrderIcon";
var e0 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M7.9999 0.733154C8.33127 0.733154 8.5999 1.00178 8.5999 1.33315V5.33315C8.5999 5.66453 8.33127 5.93315 7.9999 5.93315C7.66853 5.93315 7.3999 5.66453 7.3999 5.33315V1.33315C7.3999 1.00178 7.66853 0.733154 7.9999 0.733154Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M2.46621 2.73315C2.79758 2.73315 3.06621 3.00178 3.06621 3.33315V12.6665C3.06621 12.9979 2.79758 13.2665 2.46621 13.2665C2.13484 13.2665 1.86621 12.9979 1.86621 12.6665V3.33315C1.86621 3.00178 2.13484 2.73315 2.46621 2.73315Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M5.3334 7.3999C5.00203 7.3999 4.7334 7.66853 4.7334 7.9999C4.7334 8.33127 5.00203 8.5999 5.3334 8.5999H12.603L11.9252 9.28591C11.6922 9.52163 11.6945 9.90152 11.9302 10.1344C12.166 10.3673 12.5458 10.3651 12.7788 10.1293L14.4577 8.43018C14.69 8.19509 14.6884 7.81641 14.4542 7.58324L12.7753 5.91184C12.5404 5.67806 12.1605 5.67891 11.9267 5.91375C11.6929 6.14859 11.6938 6.52849 11.9286 6.76228L12.5691 7.3999H5.3334Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M8.5999 10.6667C8.5999 10.3353 8.33127 10.0667 7.9999 10.0667C7.66853 10.0667 7.3999 10.3353 7.3999 10.6667V14.6667C7.3999 14.998 7.66853 15.2667 7.9999 15.2667C8.33127 15.2667 8.5999 14.998 8.5999 14.6667V10.6667Z"
      }
    }
  ]
};
var R6 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "overflow-icon",
    ref: n,
    icon: e0
  }));
});
R6.displayName = "OverflowIcon";
var t0 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M1.85059 4.06725C1.85059 2.84302 2.84302 1.85059 4.06725 1.85059C5.29148 1.85059 6.28392 2.84302 6.28392 4.06725C6.28392 5.29148 5.29148 6.28392 4.06725 6.28392C2.84302 6.28392 1.85059 5.29148 1.85059 4.06725ZM4.06725 2.95059C3.45053 2.95059 2.95059 3.45053 2.95059 4.06725C2.95059 4.68397 3.45053 5.18392 4.06725 5.18392C4.68397 5.18392 5.18392 4.68397 5.18392 4.06725C5.18392 3.45053 4.68397 2.95059 4.06725 2.95059Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M9.7168 11.933C9.7168 10.7087 10.7092 9.71631 11.9335 9.71631C13.1577 9.71631 14.1501 10.7087 14.1501 11.933C14.1501 13.1572 13.1577 14.1496 11.9335 14.1496C10.7092 14.1496 9.7168 13.1572 9.7168 11.933ZM11.9335 10.8163C11.3167 10.8163 10.8168 11.3163 10.8168 11.933C10.8168 12.5497 11.3167 13.0496 11.9335 13.0496C12.5502 13.0496 13.0501 12.5497 13.0501 11.933C13.0501 11.3163 12.5502 10.8163 11.9335 10.8163Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M13.5241 3.32407C13.7584 3.08975 13.7584 2.70986 13.5241 2.47554C13.2898 2.24123 12.9099 2.24123 12.6755 2.47554L2.47554 12.6755C2.24123 12.9099 2.24123 13.2898 2.47554 13.5241C2.70986 13.7584 3.08975 13.7584 3.32407 13.5241L13.5241 3.32407Z"
      }
    }
  ]
};
var V6 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "percent-icon",
    ref: n,
    icon: t0
  }));
});
V6.displayName = "PercentIcon";
var n0 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M3.35928 2.57764C3.61338 1.77872 4.36128 1.19995 5.24437 1.19995C6.12746 1.19995 6.87537 1.77872 7.12947 2.57764H11.7885C13.4928 2.57764 14.7999 3.8461 14.7997 5.5888C14.7995 7.33129 13.4929 8.59984 11.7885 8.59984H6.63121L6.6224 8.5999H4.21143C3.16019 8.5999 2.4001 9.34071 2.4002 10.4109C2.40029 11.4814 3.16029 12.2221 4.21143 12.2221H8.87045C9.12449 11.4231 9.87245 10.8442 10.7556 10.8442C11.6388 10.8442 12.3868 11.4231 12.6408 12.2222H14.1999C14.5312 12.2222 14.7999 12.4908 14.7999 12.8222C14.7999 13.1535 14.5312 13.4222 14.1999 13.4222H12.6407C12.3866 14.221 11.6387 14.7998 10.7556 14.7998C9.87252 14.7998 9.12461 14.221 8.87051 13.4221H4.21143C2.50701 13.4221 1.20035 12.1536 1.2002 10.4111C1.20004 8.66836 2.50712 7.3999 4.21143 7.3999H6.61326L6.62208 7.39984H11.7885C12.8396 7.39984 13.5996 6.65912 13.5997 5.58868C13.5998 4.51844 12.8397 3.77764 11.7885 3.77764H7.12952C6.87548 4.57664 6.12753 5.1555 5.24437 5.1555C4.36122 5.1555 3.61327 4.57664 3.35922 3.77764H1.8002C1.46882 3.77764 1.2002 3.50901 1.2002 3.17764C1.2002 2.84627 1.46882 2.57764 1.8002 2.57764H3.35928ZM4.46671 3.16449C4.47377 2.74105 4.81924 2.39995 5.24437 2.39995C5.67026 2.39995 6.0162 2.74226 6.02207 3.16675L6.02197 3.17764L6.02207 3.1886C6.01625 3.61314 5.67029 3.95549 5.24437 3.95549C4.81921 3.95549 4.47372 3.61435 4.46671 3.19085L4.46685 3.17764L4.46671 3.16449ZM9.97788 12.8307C9.98254 13.2562 10.329 13.5998 10.7556 13.5998C11.1815 13.5998 11.5274 13.2575 11.5333 12.8331C11.5332 12.8294 11.5332 12.8258 11.5332 12.8222C11.5332 12.8185 11.5332 12.8148 11.5333 12.8111C11.5275 12.3866 11.1815 12.0442 10.7556 12.0442C10.3289 12.0442 9.98248 12.3878 9.97788 12.8134C9.97792 12.8163 9.97794 12.8192 9.97794 12.8221C9.97794 12.825 9.97792 12.8278 9.97788 12.8307Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var O6 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "piping-icon",
    ref: n,
    icon: n0
  }));
});
O6.displayName = "PipingIcon";
var r02 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M11.273 2.72206C11.0214 2.50641 10.9922 2.12763 11.2079 1.87603C11.4235 1.62444 11.8023 1.59531 12.0539 1.81097L14.3833 3.80761C14.5134 3.91733 14.5962 4.08137 14.5967 4.26477L14.5967 4.2665C14.5967 4.41745 14.541 4.55538 14.4489 4.66083C14.44 4.67109 14.4307 4.68108 14.421 4.69077L12.0877 7.02411C11.8534 7.25842 11.4735 7.25843 11.2392 7.02412C11.0049 6.78981 11.0049 6.40991 11.2392 6.17559L12.5482 4.8665H6.63324C4.40569 4.8665 2.5999 6.67229 2.5999 8.89984C2.5999 11.1274 4.40569 12.9332 6.63324 12.9332H11.9972C12.3286 12.9332 12.5972 13.2018 12.5972 13.5332C12.5972 13.8645 12.3286 14.1332 11.9972 14.1332H6.63324C3.74295 14.1332 1.3999 11.7901 1.3999 8.89984C1.3999 6.00955 3.74295 3.6665 6.63324 3.6665H12.3748L11.273 2.72206Z"
    }
  }]
};
var $6 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "redo-icon",
    ref: n,
    icon: r02
  }));
});
$6.displayName = "RedoIcon";
var o0 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M6.33307 1.3916C5.14145 1.3916 4.06641 2.27555 4.06641 3.49366V6.49777C4.06641 7.71586 5.14145 8.59982 6.33307 8.59982C7.52469 8.59982 8.59974 7.71586 8.59974 6.49777V3.49366C8.59974 2.27555 7.52469 1.3916 6.33307 1.3916ZM5.26641 3.49366C5.26641 3.05264 5.68376 2.5916 6.33307 2.5916C6.98239 2.5916 7.39974 3.05264 7.39974 3.49366V6.49777C7.39974 6.93878 6.98239 7.39982 6.33307 7.39982C5.68376 7.39982 5.26641 6.93878 5.26641 6.49777V3.49366Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M7.90913 9.5417C8.14345 9.30739 8.52335 9.30739 8.75766 9.5417C8.99198 9.77602 8.99198 10.1559 8.75766 10.3902L7.78193 11.366H13.9999C14.3313 11.366 14.5999 11.6346 14.5999 11.966C14.5999 12.2973 14.3313 12.566 13.9999 12.566H7.78193L8.75766 13.5417C8.99198 13.776 8.99198 14.1559 8.75766 14.3902C8.52335 14.6245 8.14345 14.6245 7.90913 14.3902L5.91739 12.3985C5.80388 12.2893 5.73324 12.1359 5.73324 11.966C5.73324 11.796 5.80388 11.6426 5.91739 11.5334L7.90913 9.5417Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M1.3999 8.3002C1.3999 7.96882 1.66853 7.7002 1.9999 7.7002H2.33324C2.66461 7.7002 2.93324 7.96882 2.93324 8.3002C2.93324 8.63157 2.66461 8.9002 2.33324 8.9002H1.9999C1.66853 8.9002 1.3999 8.63157 1.3999 8.3002Z"
      }
    }
  ]
};
var E6 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "reduce-digits-icon",
    ref: n,
    icon: o0
  }));
});
E6.displayName = "ReduceDigitsIcon";
var i0 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M1.3999 7.9999C1.3999 7.66853 1.66853 7.3999 1.9999 7.3999H13.9999C14.3313 7.3999 14.5999 7.66853 14.5999 7.9999C14.5999 8.33127 14.3313 8.5999 13.9999 8.5999H1.9999C1.66853 8.5999 1.3999 8.33127 1.3999 7.9999Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var K3 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "reduce-icon",
    ref: n,
    icon: i0
  }));
});
K3.displayName = "ReduceIcon";
var l0 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941C1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941C14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M4.66665 5.56641C4.33528 5.56641 4.06665 5.83504 4.06665 6.16641C4.06665 6.49778 4.33528 6.76641 4.66665 6.76641H14C14.3314 6.76641 14.6 6.49778 14.6 6.16641C14.6 5.83504 14.3314 5.56641 14 5.56641H4.66665Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334C14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M4.66665 12.9004C4.33528 12.9004 4.06665 13.169 4.06665 13.5004C4.06665 13.8318 4.33528 14.1004 4.66665 14.1004H14C14.3314 14.1004 14.6 13.8318 14.6 13.5004C14.6 13.169 14.3314 12.9004 14 12.9004H4.66665Z"
      }
    }
  ]
};
var N6 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "right-justifying-icon",
    ref: n,
    icon: l0
  }));
});
N6.displayName = "RightJustifyingIcon";
var s0 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M12.1994 1.49307C13.3824 0.944623 14.6068 2.16904 14.0584 3.35206L10.8904 10.1855C10.751 10.4862 10.3943 10.6169 10.0937 10.4775C9.79302 10.3381 9.66229 9.98144 9.80166 9.68081L11.0507 6.98651L8.61023 4.546C8.59522 4.53098 8.58116 4.51537 8.56807 4.49924L5.87063 5.74977C5.57 5.88915 5.2133 5.75842 5.07392 5.45779C4.93455 5.15715 5.06528 4.80045 5.36591 4.66108L12.1994 1.49307ZM12.9697 2.84734L11.5883 5.82701L9.72443 3.96315L12.7041 2.58177C12.8731 2.50342 13.048 2.67833 12.9697 2.84734Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M2.40366 4.68273C2.16934 4.44842 1.78945 4.44842 1.55513 4.68273C1.32082 4.91705 1.32082 5.29695 1.55513 5.53126L9.45182 13.4279L7.92792 13.5038C7.59696 13.5203 7.34202 13.8019 7.35849 14.1329C7.37497 14.4639 7.65662 14.7188 7.98758 14.7023L9.96172 14.6041C10.8278 14.5609 11.2323 13.5113 10.6191 12.8982L2.40366 4.68273Z"
    }
  }]
};
var D6 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "right-rotation-forty-five-degrees-icon",
    ref: n,
    icon: s0
  }));
});
D6.displayName = "RightRotationFortyFiveDegreesIcon";
var a02 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "g",
    attrs: {
      fill: "currentColor",
      clipPath: "url(#right-rotation-ninety-degrees-icon_clip0_927_166)"
    },
    children: [{
      tag: "path",
      attrs: { d: "M3.11339 1.41934C3.11339 1.08797 2.84476 0.819336 2.51339 0.819336C2.18201 0.819336 1.91338 1.08797 1.91338 1.41934V12.5869L0.782193 11.563C0.53652 11.3406 0.157091 11.3595 -0.0652855 11.6052C-0.287662 11.8509 -0.268776 12.2303 -0.0231021 12.4527L1.44231 13.7791C2.08518 14.361 3.11338 13.9049 3.11338 13.0377L3.11339 1.41934Z" }
    }, {
      tag: "path",
      attrs: {
        d: "M12.2955 9.26826C13.5199 8.81955 13.5199 7.08797 12.2955 6.63926L5.22343 4.04738C4.9123 3.93336 4.56763 4.09314 4.45361 4.40428C4.33958 4.71541 4.49936 5.06007 4.8105 5.1741L7.59888 6.19602V9.64743C7.59888 9.66866 7.59999 9.68964 7.60214 9.71031L4.8105 10.7334C4.49936 10.8474 4.33958 11.1921 4.45361 11.5032C4.56763 11.8144 4.9123 11.9742 5.22343 11.8601L12.2955 9.26826ZM11.8826 7.76597L8.79888 6.63581V9.27171L11.8826 8.14155C12.0575 8.07745 12.0575 7.83008 11.8826 7.76597Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    }]
  }, {
    tag: "defs",
    attrs: {},
    children: [{
      tag: "clipPath",
      attrs: { id: "right-rotation-ninety-degrees-icon_clip0_927_166" },
      children: [{
        tag: "path",
        attrs: {
          fill: "white",
          d: "M0 0H16V16H0z"
        }
      }]
    }]
  }],
  defIds: ["right-rotation-ninety-degrees-icon_clip0_927_166"]
};
var T6 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "right-rotation-ninety-degrees-icon",
    ref: n,
    icon: a02
  }));
});
T6.displayName = "RightRotationNinetyDegreesIcon";
var c0 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M11.9445 1.55649C12.2184 1.744 12.2895 2.11755 12.1033 2.39085L9.24342 6.58659H12.8001C13.1315 6.58659 13.4001 6.85522 13.4001 7.18659C13.4001 7.51796 13.1315 7.78659 12.8001 7.78659H8.5999V9.91276H13.2221C13.5534 9.91276 13.8221 10.1814 13.8221 10.5128C13.8221 10.8441 13.5534 11.1128 13.2221 11.1128H8.5999V14.0877C8.5999 14.4191 8.33127 14.6877 7.9999 14.6877C7.66853 14.6877 7.3999 14.4191 7.3999 14.0877V11.1128H2.77773C2.44636 11.1128 2.17773 10.8441 2.17773 10.5128C2.17773 10.1814 2.44636 9.91276 2.77773 9.91276H7.3999V7.78659H3.2001C2.86873 7.78659 2.6001 7.51796 2.6001 7.18659C2.6001 6.85522 2.86873 6.58659 3.2001 6.58659H6.75736L3.89753 2.39085C3.71125 2.11755 3.78234 1.744 4.05631 1.55649C4.33029 1.36899 4.7034 1.43854 4.88968 1.71184L7.94595 6.19577C7.96752 6.22741 7.98564 6.2604 8.00039 6.29429C8.01514 6.2604 8.03326 6.22741 8.05483 6.19577L11.1111 1.71184C11.2974 1.43854 11.6705 1.36899 11.9445 1.55649Z"
    }
  }]
};
var Z6 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "rmb-icon",
    ref: n,
    icon: c0
  }));
});
Z6.displayName = "RmbIcon";
var u0 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M9.72502 1.02051H6.07803C4.97346 1.02051 4.07803 1.91594 4.07803 3.02051V7.57046H3.00039C2.66902 7.57046 2.40039 7.83909 2.40039 8.17046C2.40039 8.50183 2.66902 8.77046 3.00039 8.77046H4.07803V10.4854H3.00039C2.66902 10.4854 2.40039 10.754 2.40039 11.0854C2.40039 11.4167 2.66902 11.6854 3.00039 11.6854H4.07803V14.3795C4.07803 14.7108 4.34666 14.9795 4.67803 14.9795C5.0094 14.9795 5.27803 14.7108 5.27803 14.3795V11.6854H10.3637C10.695 11.6854 10.9637 11.4167 10.9637 11.0854C10.9637 10.754 10.695 10.4854 10.3637 10.4854H5.27803V8.77046H9.72503C11.8651 8.77046 13.6 7.03557 13.6 4.89548C13.6 2.75539 11.8651 1.02051 9.72502 1.02051ZM9.72503 7.57046H5.27803V3.12051C5.27803 2.62345 5.68097 2.22051 6.17803 2.22051H9.72502C11.2024 2.22051 12.4 3.41814 12.4 4.89548C12.4 6.37283 11.2024 7.57046 9.72503 7.57046Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var A6 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "rouble-icon",
    ref: n,
    icon: u0
  }));
});
A6.displayName = "RoubleIcon";
var d02 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M4.66628 8.66683C5.03447 8.66683 5.33294 8.36835 5.33294 8.00016C5.33294 7.63197 5.03447 7.3335 4.66628 7.3335C4.29809 7.3335 3.99961 7.63197 3.99961 8.00016C3.99961 8.36835 4.29809 8.66683 4.66628 8.66683Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M5.99935 10.0002C5.99935 10.3684 5.70087 10.6668 5.33268 10.6668C4.96449 10.6668 4.66602 10.3684 4.66602 10.0002C4.66602 9.63197 4.96449 9.3335 5.33268 9.3335C5.70087 9.3335 5.99935 9.63197 5.99935 10.0002Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M3.33268 10.6668C3.70087 10.6668 3.99935 10.3684 3.99935 10.0002C3.99935 9.63197 3.70087 9.3335 3.33268 9.3335C2.96449 9.3335 2.66602 9.63197 2.66602 10.0002C2.66602 10.3684 2.96449 10.6668 3.33268 10.6668Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M7.33294 8.00016C7.33294 8.36835 7.03447 8.66683 6.66628 8.66683C6.29809 8.66683 5.99961 8.36835 5.99961 8.00016C5.99961 7.63197 6.29809 7.3335 6.66628 7.3335C7.03447 7.3335 7.33294 7.63197 7.33294 8.00016Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M7.33268 10.6668C7.70087 10.6668 7.99935 10.3684 7.99935 10.0002C7.99935 9.63197 7.70087 9.3335 7.33268 9.3335C6.96449 9.3335 6.66602 9.63197 6.66602 10.0002C6.66602 10.3684 6.96449 10.6668 7.33268 10.6668Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M9.33294 8.00016C9.33294 8.36835 9.03447 8.66683 8.66628 8.66683C8.29809 8.66683 7.99961 8.36835 7.99961 8.00016C7.99961 7.63197 8.29809 7.3335 8.66628 7.3335C9.03447 7.3335 9.33294 7.63197 9.33294 8.00016Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M9.33268 10.6668C9.70087 10.6668 9.99935 10.3684 9.99935 10.0002C9.99935 9.63197 9.70087 9.3335 9.33268 9.3335C8.96449 9.3335 8.66602 9.63197 8.66602 10.0002C8.66602 10.3684 8.96449 10.6668 9.33268 10.6668Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M11.3329 8.00016C11.3329 8.36835 11.0345 8.66683 10.6663 8.66683C10.2981 8.66683 9.99961 8.36835 9.99961 8.00016C9.99961 7.63197 10.2981 7.3335 10.6663 7.3335C11.0345 7.3335 11.3329 7.63197 11.3329 8.00016Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M11.3327 10.6668C11.7009 10.6668 11.9993 10.3684 11.9993 10.0002C11.9993 9.63197 11.7009 9.3335 11.3327 9.3335C10.9645 9.3335 10.666 9.63197 10.666 10.0002C10.666 10.3684 10.9645 10.6668 11.3327 10.6668Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M13.3329 8.00016C13.3329 8.36835 13.0345 8.66683 12.6663 8.66683C12.2981 8.66683 11.9996 8.36835 11.9996 8.00016C11.9996 7.63197 12.2981 7.3335 12.6663 7.3335C13.0345 7.3335 13.3329 7.63197 13.3329 8.00016Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M4.99961 12.0002C4.99961 11.632 5.29809 11.3335 5.66628 11.3335H10.3329C10.7011 11.3335 10.9996 11.632 10.9996 12.0002C10.9996 12.3684 10.7011 12.6668 10.3329 12.6668H5.66628C5.29809 12.6668 4.99961 12.3684 4.99961 12.0002Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M13.9999 2.00016C13.9999 1.63197 13.7014 1.3335 13.3332 1.3335C12.965 1.3335 12.6665 1.63197 12.6665 2.00016V3.37516H11.3332C10.7809 3.37516 10.3332 3.82287 10.3332 4.37516V5.3335H1.99935C1.26297 5.3335 0.666016 5.93045 0.666016 6.66683V13.3335C0.666016 14.0699 1.26297 14.6668 1.99935 14.6668H13.9993C14.7357 14.6668 15.3327 14.0699 15.3327 13.3335V6.66683C15.3327 5.93045 14.7357 5.3335 13.9993 5.3335H11.6665V4.7085H12.9999C13.5522 4.7085 13.9999 4.26079 13.9999 3.7085V2.00016ZM1.99935 6.66683V13.3335H13.9993V6.66683H1.99935Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    }
  ]
};
var B6 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "shortcut-icon",
    ref: n,
    icon: d02
  }));
});
B6.displayName = "ShortcutIcon";
var h0 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M8.00033 1.20996C6.43345 1.20996 5.23596 1.88077 4.64804 2.94304C4.06338 3.99943 4.15123 5.32084 4.90099 6.47062C5.08199 6.7482 5.45374 6.82648 5.73131 6.64548C6.00888 6.46448 6.08716 6.09273 5.90616 5.81516C5.36418 4.98402 5.35768 4.13897 5.69797 3.52412C6.035 2.91515 6.78176 2.40996 8.00033 2.40996C9.19423 2.40996 10.0017 2.93409 10.5236 3.46755C10.7871 3.73682 10.9756 4.00712 11.0974 4.20903C11.158 4.30951 11.2013 4.39164 11.2284 4.44625C11.2419 4.47351 11.2514 4.49377 11.2568 4.50588L11.2621 4.51771C11.3901 4.82216 11.7407 4.96686 12.046 4.83992C12.3519 4.71267 12.4968 4.36149 12.3695 4.05552L11.8231 4.28278C12.3695 4.05552 12.3697 4.0558 12.3695 4.05552L12.3691 4.05437L12.3685 4.05298L12.367 4.04953L12.3629 4.03993L12.3498 4.01036C12.3388 3.98619 12.3234 3.95326 12.3033 3.91282C12.2632 3.83203 12.2043 3.72072 12.1249 3.58908C11.9666 3.32674 11.7235 2.97805 11.3814 2.62834C10.6921 1.92381 9.59192 1.20996 8.00033 1.20996Z"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M2.11953 8.5999H7.88935C10.1109 9.46549 10.5895 10.7649 10.4268 11.6869C10.2475 12.703 9.26939 13.5898 8.00009 13.5898C6.63323 13.5898 5.77631 13.0502 5.25534 12.528C4.99021 12.2623 4.80823 11.9965 4.69365 11.7993C4.63659 11.7011 4.59698 11.6211 4.5727 11.5686C4.56059 11.5424 4.55236 11.5231 4.54774 11.512L4.54352 11.5016C4.4267 11.193 4.0823 11.0363 3.77279 11.1516C3.46228 11.2673 3.30438 11.6129 3.4201 11.9234L3.9649 11.7203C3.4201 11.9234 3.41998 11.9231 3.4201 11.9234L3.4206 11.9247L3.42118 11.9263L3.42262 11.9301L3.42661 11.9403C3.42977 11.9484 3.43394 11.9588 3.43914 11.9713C3.44956 11.9965 3.46418 12.0304 3.48334 12.0719C3.52161 12.1547 3.57828 12.2682 3.65608 12.4021C3.81124 12.6692 4.0534 13.0223 4.40584 13.3756C5.12 14.0914 6.27196 14.7898 8.00009 14.7898C9.82574 14.7898 11.3236 13.5101 11.6085 11.8955C11.812 10.7422 11.3901 9.55402 10.2665 8.5999H13.8804C14.2117 8.5999 14.4803 8.33127 14.4803 7.9999C14.4803 7.66853 14.2117 7.3999 13.8804 7.3999H8.01411C8.0048 7.39968 7.99551 7.39969 7.98625 7.3999H2.11953C1.78816 7.3999 1.51953 7.66853 1.51953 7.9999C1.51953 8.33127 1.78816 8.5999 2.11953 8.5999Z"
    }
  }]
};
var P6 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "strikethrough-icon",
    ref: n,
    icon: h0
  }));
});
P6.displayName = "StrikethroughIcon";
var f0 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 17 17",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        stroke: "currentColor",
        d: "M2.08596 14.1387L10.3379 2.66873",
        strokeLinecap: "round",
        strokeWidth: 1.2
      }
    },
    {
      tag: "path",
      attrs: {
        stroke: "currentColor",
        d: "M10.3379 14.1387L2.08596 2.66873",
        strokeLinecap: "round",
        strokeWidth: 1.2
      }
    },
    {
      tag: "path",
      attrs: {
        stroke: "currentColor",
        d: "M12.8098 10.0174C13.4565 9.45285 14.781 9.44507 15.0272 10.5759C15.2798 11.736 13.8101 13.2515 12.7376 14.1033C12.7227 14.1151 12.7315 14.1389 12.7505 14.1388L15.2251 14.1388",
        strokeLinecap: "round",
        strokeWidth: 1.2
      }
    }
  ]
};
var F6 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "subscript-icon",
    ref: n,
    icon: f0
  }));
});
F6.displayName = "SubscriptIcon";
var C0 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M0.394135 6.52121C0.394135 5.4474 1.26463 4.5769 2.33844 4.5769H3.90929C4.24066 4.5769 4.50929 4.84553 4.50929 5.1769C4.50929 5.50828 4.24066 5.7769 3.90929 5.7769H2.33844C1.92737 5.7769 1.59414 6.11014 1.59414 6.52121C1.59414 6.93228 1.92737 7.26552 2.33844 7.26552H2.45171C3.59368 7.26552 4.50929 8.20288 4.50929 9.33362C4.50929 10.4761 3.58419 11.4231 2.43051 11.4231H0.893457C0.562086 11.4231 0.293457 11.1544 0.293457 10.8231C0.293457 10.4917 0.562086 10.2231 0.893457 10.2231H2.43051C2.91024 10.2231 3.30929 9.82458 3.30929 9.33362C3.30929 8.85437 2.91974 8.46552 2.45171 8.46552H2.33844C1.26463 8.46552 0.394135 7.59502 0.394135 6.52121Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M15.1061 11.4231C14.7747 11.4231 14.5061 11.1545 14.5061 10.8231L14.5061 8.31006C14.5061 7.97762 14.2366 7.70812 13.9041 7.70812C13.5717 7.70812 13.3022 7.97762 13.3022 8.31006L13.3022 10.8231C13.3022 11.1545 13.0335 11.4231 12.7022 11.4231C12.3708 11.4231 12.1022 11.1545 12.1022 10.8231L12.1022 8.31006C12.1022 7.31488 12.9089 6.50812 13.9041 6.50812C14.8993 6.50812 15.7061 7.31488 15.7061 8.31006L15.7061 10.8231C15.7061 11.1545 15.4374 11.4231 15.1061 11.4231Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M12.7022 11.4231C12.3709 11.4231 12.1022 11.1545 12.1022 10.8231L12.1022 8.31006C12.1022 7.97762 11.8327 7.70812 11.5003 7.70812C11.1679 7.70812 10.8984 7.97762 10.8984 8.31006L10.8984 10.8231C10.8984 11.1545 10.6297 11.4231 10.2984 11.4231C9.967 11.4231 9.69837 11.1545 9.69837 10.8231L9.69837 8.31006C9.69837 7.31488 10.5051 6.50812 11.5003 6.50812C12.4955 6.50812 13.3022 7.31488 13.3022 8.31006L13.3022 10.8231C13.3022 11.1545 13.0336 11.4231 12.7022 11.4231Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M5.58193 6.69556C5.9133 6.69556 6.18193 6.96419 6.18193 7.29556L6.18193 9.43683C6.18193 9.87101 6.53391 10.223 6.96809 10.223C7.40228 10.223 7.75425 9.87101 7.75425 9.43683L7.75425 7.29556C7.75425 6.96419 8.02288 6.69556 8.35425 6.69556C8.68563 6.69556 8.95425 6.96419 8.95425 7.29556L8.95425 9.43683C8.95425 10.5338 8.06502 11.423 6.96809 11.423C5.87117 11.423 4.98193 10.5338 4.98193 9.43683L4.98193 7.29556C4.98193 6.96419 5.25056 6.69556 5.58193 6.69556Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    }
  ]
};
var k6 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "sum-icon",
    ref: n,
    icon: C0
  }));
});
k6.displayName = "SumIcon";
var v0 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 17 17",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        stroke: "currentColor",
        d: "M2.10904 14.4537L10.299 3.06987",
        strokeLinecap: "round",
        strokeWidth: 1.2
      }
    },
    {
      tag: "path",
      attrs: {
        stroke: "currentColor",
        d: "M10.2989 14.4537L2.10899 3.06987",
        strokeLinecap: "round",
        strokeWidth: 1.2
      }
    },
    {
      tag: "path",
      attrs: {
        stroke: "currentColor",
        d: "M12.7525 3.35933C13.3943 2.79901 14.7089 2.79129 14.9533 3.91363C15.204 5.06487 13.7456 6.56876 12.6812 7.41429C12.6663 7.4261 12.6751 7.44982 12.6941 7.44982L15.1497 7.44977",
        strokeLinecap: "round",
        strokeWidth: 1.2
      }
    }
  ]
};
var j6 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "superscript-icon",
    ref: n,
    icon: v0
  }));
});
j6.displayName = "SuperscriptIcon";
var g0 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M2.21572 1.80029C2.54709 1.80029 2.81572 2.06892 2.81572 2.40029V14.0003C2.81572 14.3317 2.54709 14.6003 2.21572 14.6003C1.88435 14.6003 1.61572 14.3317 1.61572 14.0003V2.40029C1.61572 2.06892 1.88435 1.80029 2.21572 1.80029Z"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M13.7841 1.80029C14.1155 1.80029 14.3841 2.06892 14.3841 2.40029V14.0003C14.3841 14.3317 14.1155 14.6003 13.7841 14.6003C13.4527 14.6003 13.1841 14.3317 13.1841 14.0003V8.60259H7.13467C6.8033 8.60259 6.53467 8.33396 6.53467 8.00259C6.53467 7.67122 6.8033 7.40259 7.13467 7.40259H13.1841V2.40029C13.1841 2.06892 13.4527 1.80029 13.7841 1.80029Z"
    }
  }]
};
var U6 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "truncation-icon",
    ref: n,
    icon: g0
  }));
});
U6.displayName = "TruncationIcon";
var p0 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M4.46416 2.03237C4.46416 1.701 4.19553 1.43237 3.86416 1.43237C3.53279 1.43237 3.26416 1.701 3.26416 2.03237V7.33338C3.26416 10.0313 5.35834 12.2667 7.9999 12.2667C10.6415 12.2667 12.7356 10.0313 12.7356 7.33338V2.03237C12.7356 1.701 12.467 1.43237 12.1356 1.43237C11.8043 1.43237 11.5356 1.701 11.5356 2.03237V7.33338C11.5356 9.42194 9.92656 11.0667 7.9999 11.0667C6.07325 11.0667 4.46416 9.42194 4.46416 7.33338V2.03237Z"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M2.66641 13.4663C2.33504 13.4663 2.06641 13.7349 2.06641 14.0663C2.06641 14.3977 2.33504 14.6663 2.66641 14.6663H13.3331C13.6644 14.6663 13.9331 14.3977 13.9331 14.0663C13.9331 13.7349 13.6644 13.4663 13.3331 13.4663H2.66641Z"
    }
  }]
};
var z6 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "underline-icon",
    ref: n,
    icon: p0
  }));
});
z6.displayName = "UnderlineIcon";
var m0 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M4.72365 2.72206C4.97524 2.50641 5.00437 2.12763 4.78872 1.87603C4.57306 1.62444 4.19428 1.59531 3.94269 1.81097L1.61333 3.80761C1.48281 3.91768 1.3999 4.08241 1.3999 4.2665C1.3999 4.41745 1.45564 4.55538 1.54766 4.66083C1.55661 4.67109 1.56594 4.68108 1.57563 4.69077L3.9089 7.02411C4.14321 7.25842 4.52311 7.25843 4.75743 7.02412C4.99175 6.78981 4.99175 6.40991 4.75744 6.17559L3.44839 4.8665H9.36337C11.5909 4.8665 13.3967 6.67229 13.3967 8.89984C13.3967 11.1274 11.5909 12.9332 9.36337 12.9332H3.99937C3.668 12.9332 3.39937 13.2018 3.39937 13.5332C3.39937 13.8645 3.668 14.1332 3.99937 14.1332H9.36337C12.2537 14.1332 14.5967 11.7901 14.5967 8.89984C14.5967 6.00955 12.2537 3.6665 9.36337 3.6665H3.62183L4.72365 2.72206Z"
    }
  }]
};
var W6 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "undo-icon",
    ref: n,
    icon: m0
  }));
});
W6.displayName = "UndoIcon";
var b0 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 17 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M3.03012 3.14006C3.03012 3.59845 2.65851 3.97006 2.20012 3.97006C1.74172 3.97006 1.37012 3.59845 1.37012 3.14006C1.37012 2.68166 1.74172 2.31006 2.20012 2.31006C2.65851 2.31006 3.03012 2.68166 3.03012 3.14006Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M4.53027 2.54014C4.1989 2.54014 3.93027 2.80877 3.93027 3.14014C3.93027 3.47151 4.1989 3.74014 4.53027 3.74014H14.5488C14.8802 3.74014 15.1488 3.47151 15.1488 3.14014C15.1488 2.80877 14.8802 2.54014 14.5488 2.54014H4.53027Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M2.20012 8.82992C2.65851 8.82992 3.03012 8.45832 3.03012 7.99992C3.03012 7.54153 2.65851 7.16992 2.20012 7.16992C1.74172 7.16992 1.37012 7.54153 1.37012 7.99992C1.37012 8.45832 1.74172 8.82992 2.20012 8.82992Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M4.53027 7.4C4.1989 7.4 3.93027 7.66863 3.93027 8C3.93027 8.33137 4.1989 8.6 4.53027 8.6H14.5488C14.8802 8.6 15.1488 8.33137 15.1488 8C15.1488 7.66863 14.8802 7.4 14.5488 7.4H4.53027Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M2.20012 13.6905C2.65851 13.6905 3.03012 13.3189 3.03012 12.8605C3.03012 12.4021 2.65851 12.0305 2.20012 12.0305C1.74172 12.0305 1.37012 12.4021 1.37012 12.8605C1.37012 13.3189 1.74172 13.6905 2.20012 13.6905Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M4.53027 12.2604C4.1989 12.2604 3.93027 12.529 3.93027 12.8604C3.93027 13.1917 4.1989 13.4604 4.53027 13.4604H14.5488C14.8802 13.4604 15.1488 13.1917 15.1488 12.8604C15.1488 12.529 14.8802 12.2604 14.5488 12.2604H4.53027Z"
      }
    }
  ]
};
var Y6 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "unorder-icon",
    ref: n,
    icon: b0
  }));
});
Y6.displayName = "UnorderIcon";
var L0 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M7.9999 0.733398C8.33127 0.733398 8.5999 1.00203 8.5999 1.3334V4.55137L9.57564 3.57564C9.80995 3.34132 10.1899 3.34132 10.4242 3.57564C10.6585 3.80995 10.6585 4.18985 10.4242 4.42417L8.42417 6.42417C8.18985 6.65848 7.80995 6.65848 7.57564 6.42417L5.57564 4.42417C5.34132 4.18985 5.34132 3.80995 5.57564 3.57564C5.80995 3.34132 6.18985 3.34132 6.42417 3.57564L7.3999 4.55137V1.3334C7.3999 1.00203 7.66853 0.733398 7.9999 0.733398Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M5.57564 11.5756L7.57564 9.57564C7.80995 9.34132 8.18985 9.34132 8.42417 9.57564L10.4242 11.5756C10.6585 11.81 10.6585 12.1899 10.4242 12.4242C10.1899 12.6585 9.80995 12.6585 9.57564 12.4242L8.5999 11.4484V14.6665C8.5999 14.9979 8.33127 15.2665 7.9999 15.2665C7.66853 15.2665 7.3999 14.9979 7.3999 14.6665V11.4484L6.42417 12.4242C6.18985 12.6585 5.80995 12.6585 5.57564 12.4242C5.34132 12.1899 5.34132 11.81 5.57564 11.5756Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M1.9999 7.40015C1.66853 7.40015 1.3999 7.66878 1.3999 8.00015C1.3999 8.33152 1.66853 8.60015 1.9999 8.60015H13.9999C14.3313 8.60015 14.5999 8.33152 14.5999 8.00015C14.5999 7.66878 14.3313 7.40015 13.9999 7.40015H1.9999Z"
      }
    }
  ]
};
var G62 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "vertical-center-icon",
    ref: n,
    icon: L0
  }));
});
G62.displayName = "VerticalCenterIcon";
var w0 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 17 17",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M2.2157 2.90265C2.2157 2.16628 2.81264 1.56934 3.54901 1.56934H6.21565C6.95202 1.56934 7.54896 2.16628 7.54896 2.90265V13.5692C7.54896 14.3056 6.95202 14.9025 6.21565 14.9025H3.54901C2.81264 14.9025 2.2157 14.3056 2.2157 13.5692V2.90265ZM3.54901 2.90265H6.21565V5.5622H3.54901V2.90265ZM3.54901 6.89552V9.57631H6.21565V6.89552H3.54901ZM3.54901 13.5692V10.9096H6.21565V13.5692H3.54901Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M10.2156 2.90265C10.2156 2.16628 10.8125 1.56934 11.5489 1.56934H14.2155C14.9519 1.56934 15.5489 2.16628 15.5489 2.90265V13.5692C15.5489 14.3056 14.9519 14.9025 14.2155 14.9025H11.5489C10.8125 14.9025 10.2156 14.3056 10.2156 13.5692V2.90265ZM11.5489 2.90265H14.2155V5.5622H11.5489V2.90265ZM11.5489 6.89552V9.57631H14.2155V6.89552H11.5489ZM11.5489 13.5692V10.9096H14.2155V13.5692H11.5489Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var X6 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "vertical-integration-icon",
    ref: n,
    icon: w0
  }));
});
X6.displayName = "VerticalIntegrationIcon";
var _0 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M4.55504 2.73208C4.55504 2.40071 4.28641 2.13208 3.95504 2.13208C3.62367 2.13208 3.35504 2.40071 3.35504 2.73208V12.5172L2.21439 11.5276C1.96409 11.3104 1.58515 11.3373 1.36799 11.5876C1.15084 11.8379 1.17771 12.2169 1.42801 12.434L2.89972 13.7108C3.54718 14.2726 4.55504 13.8127 4.55504 12.9555L4.55504 2.73208Z"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M9.00725 4.01095C9.45595 2.78663 11.1875 2.78662 11.6362 4.01095L14.743 12.488C14.8571 12.7992 14.6973 13.1438 14.3861 13.2578C14.075 13.3719 13.7303 13.2121 13.6163 12.9009L12.4148 9.62242H8.36729C8.32154 9.62242 8.27699 9.6173 8.23417 9.6076L7.02719 12.9009C6.91316 13.2121 6.5685 13.3719 6.25736 13.2578C5.94623 13.1438 5.78644 12.7992 5.90047 12.488L9.00725 4.01095ZM10.5095 4.42388L11.975 8.42242H8.66853L10.134 4.42389C10.1981 4.24898 10.4454 4.24898 10.5095 4.42388Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var q6 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "vertical-text-icon",
    ref: n,
    icon: _0
  }));
});
q6.displayName = "VerticalTextIcon";
var y02 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M8.60231 5.77597L9.38125 6.55432C9.61658 6.78947 9.99797 6.78932 10.2331 6.554C10.4683 6.31867 10.4681 5.93728 10.2328 5.70214L8.44939 3.92009C8.33908 3.79657 8.1786 3.7188 7.99995 3.7188C7.84562 3.71861 7.6906 3.77736 7.57281 3.89506L5.76712 5.69933C5.5318 5.93447 5.53165 6.31587 5.76679 6.55119C6.00193 6.78652 6.38332 6.78667 6.61865 6.55153L7.3976 5.77319L7.3976 10.2246L6.61865 9.44621C6.38333 9.21107 6.00194 9.21121 5.76679 9.44654C5.53165 9.68186 5.53179 10.0633 5.76712 10.2984L7.55051 12.0804C7.66082 12.204 7.82131 12.2817 7.99995 12.2817L8.00089 12.2817C8.15512 12.2819 8.30939 12.2231 8.4271 12.1055L10.2328 10.3012C10.4681 10.0661 10.4683 9.68467 10.2331 9.44934C9.99798 9.21402 9.61659 9.21387 9.38126 9.44901L8.60231 10.2274L8.60231 5.77597Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M13.7039 3.24701C14.0539 3.24701 14.3377 2.96327 14.3377 2.61325C14.3377 2.26324 14.0539 1.97949 13.7039 1.97949L2.29627 1.97949C1.94625 1.97949 1.66251 2.26324 1.66251 2.61325C1.66251 2.96327 1.94625 3.24701 2.29627 3.24701L13.7039 3.24701Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M13.7039 14.0209C14.0539 14.0209 14.3377 13.7372 14.3377 13.3872C14.3377 13.0371 14.0539 12.7534 13.7039 12.7534L2.29627 12.7534C1.94625 12.7534 1.66251 13.0371 1.66251 13.3872C1.66251 13.7372 1.94625 14.0209 2.29627 14.0209L13.7039 14.0209Z"
      }
    }
  ]
};
var J6 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "adjust-height-double-icon",
    ref: n,
    icon: y02
  }));
});
J6.displayName = "AdjustHeightDoubleIcon";
var M0 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M5.77574 7.3974L6.5541 6.61846C6.78924 6.38313 6.78909 6.00174 6.55377 5.7666C6.31844 5.53145 5.93705 5.5316 5.70191 5.76692L3.91987 7.55032C3.79634 7.66063 3.71857 7.82111 3.71857 7.99976C3.71838 8.15409 3.77713 8.30912 3.89483 8.42691L5.6991 10.2326C5.93425 10.4679 6.31564 10.4681 6.55096 10.2329C6.78629 9.99778 6.78644 9.61639 6.5513 9.38106L5.77296 8.60211L10.2243 8.60211L9.44598 9.38106C9.21084 9.61638 9.21099 9.99777 9.44631 10.2329C9.68164 10.4681 10.063 10.4679 10.2982 10.2326L12.0802 8.4492C12.2037 8.33889 12.2815 8.1784 12.2815 7.99976L12.2815 7.99882C12.2816 7.84459 12.2229 7.69032 12.1052 7.57261L10.301 5.76693C10.0658 5.5316 9.68444 5.53145 9.44911 5.76659C9.21379 6.00173 9.21364 6.38312 9.44878 6.61845L10.2271 7.3974L5.77574 7.3974Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M3.24683 2.29598C3.24683 1.94596 2.96308 1.66222 2.61307 1.66222C2.26305 1.66222 1.97931 1.94596 1.97931 2.29598L1.97931 13.7036C1.97931 14.0537 2.26305 14.3374 2.61307 14.3374C2.96308 14.3374 3.24683 14.0537 3.24683 13.7036L3.24683 2.29598Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M14.0207 2.29598C14.0207 1.94596 13.737 1.66222 13.387 1.66222C13.037 1.66222 12.7532 1.94596 12.7532 2.29598L12.7532 13.7036C12.7532 14.0537 13.037 14.3374 13.387 14.3374C13.737 14.3374 14.0207 14.0537 14.0207 13.7036L14.0207 2.29598Z"
      }
    }
  ]
};
var Q6 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "adjust-width-double-icon",
    ref: n,
    icon: M0
  }));
});
Q6.displayName = "AdjustWidthDoubleIcon";
var I0 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M2.29713 1.98047C1.94717 1.98047 1.66348 2.26416 1.66348 2.61412C1.66348 2.96408 1.94717 3.24777 2.29713 3.24777H13.7028C14.0528 3.24777 14.3365 2.96408 14.3365 2.61412C14.3365 2.26416 14.0528 1.98047 13.7028 1.98047H2.29713Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M2.29713 12.7525C1.94717 12.7525 1.66348 13.0362 1.66348 13.3862C1.66348 13.7361 1.94717 14.0198 2.29713 14.0198H13.7028C14.0528 14.0198 14.3365 13.7361 14.3365 13.3862C14.3365 13.0362 14.0528 12.7525 13.7028 12.7525H2.29713Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M7.42163 4.25588L4.25471 11.2231C4.10989 11.5417 4.25077 11.9174 4.56935 12.0622C4.88794 12.207 5.2636 12.0661 5.40841 11.7475L6.24766 9.90119H9.75197L10.5912 11.7475C10.736 12.0661 11.1117 12.207 11.4303 12.0622C11.7489 11.9174 11.8897 11.5417 11.7449 11.2231L8.578 4.25589C8.5675 4.23244 8.55557 4.20961 8.54227 4.18755C8.49012 4.10102 8.41688 4.0262 8.32579 3.97171C8.301 3.95688 8.27527 3.94377 8.24878 3.93246C8.16764 3.89775 8.08309 3.8813 7.99981 3.88135C7.88457 3.88142 7.77177 3.91309 7.67384 3.97171C7.58714 4.02361 7.5121 4.09664 7.45735 4.18755C7.44406 4.20961 7.43213 4.23244 7.42163 4.25588ZM9.17592 8.63388L7.99981 6.04644L6.8237 8.63388H9.17592Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    }
  ]
};
var K6 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "auto-height-double-icon",
    ref: n,
    icon: I0
  }));
});
K6.displayName = "AutoHeightDoubleIcon";
var H0 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M1.98032 13.7028C1.98032 14.0527 2.26401 14.3364 2.61397 14.3364C2.96392 14.3364 3.24762 14.0527 3.24762 13.7028L3.24762 2.29706C3.24762 1.9471 2.96392 1.66341 2.61397 1.66341C2.26401 1.66341 1.98032 1.9471 1.98032 2.29706L1.98032 13.7028Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M12.7524 13.7028C12.7524 14.0527 13.0361 14.3364 13.386 14.3364C13.736 14.3364 14.0197 14.0527 14.0197 13.7028L14.0197 2.29706C14.0197 1.9471 13.736 1.66341 13.386 1.66341C13.0361 1.66341 12.7524 1.9471 12.7524 2.29706L12.7524 13.7028Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M7.42187 4.25588L4.25495 11.2231C4.11014 11.5417 4.25101 11.9174 4.5696 12.0622C4.88819 12.207 5.26385 12.0661 5.40866 11.7475L6.2479 9.90119H9.75222L10.5915 11.7475C10.7363 12.0661 11.1119 12.207 11.4305 12.0622C11.7491 11.9174 11.89 11.5417 11.7452 11.2231L8.57825 4.25589C8.56775 4.23244 8.55582 4.20961 8.54252 4.18755C8.49037 4.10102 8.41713 4.0262 8.32603 3.97171C8.30125 3.95688 8.27551 3.94377 8.24902 3.93246C8.16788 3.89775 8.08333 3.8813 8.00006 3.88135C7.88481 3.88142 7.77201 3.91309 7.67409 3.97171C7.58739 4.02361 7.51235 4.09664 7.4576 4.18755C7.4443 4.20961 7.43237 4.23244 7.42187 4.25588ZM9.17617 8.63388L8.00006 6.04644L6.82395 8.63388H9.17617Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    }
  ]
};
var en2 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "auto-width-double-icon",
    ref: n,
    icon: H0
  }));
});
en2.displayName = "AutoWidthDoubleIcon";
var x0 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 17 17",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M13.5853 14.7987L2.27159 3.485L3.12012 2.63647L14.4338 13.9502L13.5853 14.7987Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "colorChannel1",
      d: "M1.69629 12.8102L1.69629 14.1743C1.69629 14.8371 2.23355 15.3743 2.89629 15.3743L4.26042 15.3743L4.26042 14.0443L3.02629 14.0443L3.02629 12.8102L1.69629 12.8102ZM4.26042 2.06128L2.89629 2.06128C2.23355 2.06128 1.69629 2.59854 1.69629 3.26128L1.69629 4.62541L3.02629 4.62541L3.02629 3.39128L4.26042 3.39128L4.26042 2.06128ZM1.69629 10.0819L3.02629 10.0819L3.02629 7.35367L1.69629 7.35367L1.69629 10.0819ZM6.98868 2.06128L6.98868 3.39128L9.71693 3.39128L9.71693 2.06128L6.98868 2.06128ZM12.4452 2.06128L12.4452 3.39128L13.6793 3.39128L13.6793 4.62541L15.0093 4.62541L15.0093 3.26128C15.0093 2.59854 14.4721 2.06128 13.8093 2.06128L12.4452 2.06128ZM15.0093 7.35367L13.6793 7.35367L13.6793 10.0819L15.0093 10.0819L15.0093 7.35367ZM15.0093 12.8102L13.6793 12.8102L13.6793 14.0443L12.4452 14.0443L12.4452 15.3743L13.8093 15.3743C14.4721 15.3743 15.0093 14.8371 15.0093 14.1743L15.0093 12.8102ZM9.71693 15.3743L9.71693 14.0443L6.98868 14.0443L6.98868 15.3743L9.71693 15.3743Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var tn2 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "back-slash-double-icon",
    ref: n,
    icon: x0
  }));
});
tn2.displayName = "BackSlashDoubleIcon";
var S0 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "colorChannel1",
      d: "M5.36831 3.22148C5.36831 1.94497 6.40313 0.910156 7.67964 0.910156C8.95615 0.910156 9.99097 1.94497 9.99097 3.22149V6.74754H8.72649V3.22149C8.72649 2.64333 8.2578 2.17464 7.67964 2.17464C7.10148 2.17464 6.63279 2.64333 6.63279 3.22148V6.74754H5.36831V3.22148Z"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M5.00091 5.47314C3.33644 5.47314 1.9499 6.74914 1.81192 8.40788L1.54428 11.6254C1.38911 13.4909 2.86133 15.0906 4.73327 15.0906H13.6667C14.175 15.0906 14.5544 14.6228 14.4495 14.1255L13.0262 7.37781C12.792 6.26766 11.8125 5.47314 10.6779 5.47314H5.00091ZM10.6779 6.75314H5.00091C4.00223 6.75314 3.1703 7.51874 3.08751 8.51399L2.81988 11.7315C2.72677 12.8508 3.61011 13.8106 4.73327 13.8106H5.7695C5.26362 13.0554 5.05585 12.0527 5.31224 11.047C5.40861 10.6689 5.76242 10.4493 6.10249 10.5564C6.44256 10.6636 6.64012 11.0569 6.54374 11.4349C6.27517 12.4885 6.92898 13.6738 7.87916 13.8106H9.01412C8.50824 13.0554 8.30047 12.0527 8.55686 11.047C8.65324 10.6689 9.00704 10.4493 9.34711 10.5564C9.68719 10.6636 9.88474 11.0569 9.78837 11.4349C9.51979 12.4885 10.1736 13.6738 11.1238 13.8106H13.0749L11.7738 7.64199C11.6645 7.12392 11.2073 6.75314 10.6779 6.75314Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var nn = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "clear-format-double-icon",
    ref: n,
    icon: S0
  }));
});
nn.displayName = "ClearFormatDoubleIcon";
var R0 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 17 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "colorChannel1",
      d: "M5.59 1.51H10.46V14.46H5.59z"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M1.34863 2.53325C1.34863 1.87051 1.88589 1.33325 2.54863 1.33325H13.482C14.1447 1.33325 14.682 1.87051 14.682 2.53325V13.4666C14.682 14.1294 14.1447 14.6666 13.482 14.6666H2.54863C1.88589 14.6666 1.34863 14.1294 1.34863 13.4666V2.53325ZM13.082 2.63325C13.2477 2.63325 13.382 2.76757 13.382 2.93325V5.09946C13.382 5.26515 13.2477 5.39946 13.082 5.39946H10.9708C10.8052 5.39946 10.6708 5.26515 10.6708 5.09946V2.93325C10.6708 2.76757 10.8052 2.63325 10.9708 2.63325H13.082ZM9.37085 2.93325C9.37085 2.76757 9.23653 2.63325 9.07085 2.63325H6.95974C6.79406 2.63325 6.65974 2.76757 6.65974 2.93325V5.09946C6.65974 5.26515 6.79406 5.39946 6.95974 5.39946L9.07085 5.39946C9.23654 5.39946 9.37085 5.26515 9.37085 5.09946V2.93325ZM5.35974 2.93325C5.35974 2.76757 5.22543 2.63325 5.05974 2.63325H2.94863C2.78295 2.63325 2.64863 2.76757 2.64863 2.93325V5.09946C2.64863 5.26515 2.78295 5.39946 2.94863 5.39946H5.05974C5.22543 5.39946 5.35974 5.26515 5.35974 5.09946V2.93325ZM2.94863 6.69946C2.78295 6.69946 2.64863 6.83378 2.64863 6.99946V9.11045C2.64863 9.27613 2.78295 9.41045 2.94863 9.41045H5.05974C5.22543 9.41045 5.35974 9.27613 5.35974 9.11045V6.99946C5.35974 6.83378 5.22543 6.69946 5.05974 6.69946H2.94863ZM2.94863 10.7104C2.78295 10.7104 2.64863 10.8448 2.64863 11.0104V13.0666C2.64863 13.2323 2.78295 13.3666 2.94863 13.3666H5.05974C5.22543 13.3666 5.35974 13.2323 5.35974 13.0666V11.0104C5.35974 10.8448 5.22543 10.7104 5.05974 10.7104H2.94863ZM6.65974 13.0666C6.65974 13.2323 6.79406 13.3666 6.95974 13.3666H9.07085C9.23653 13.3666 9.37085 13.2323 9.37085 13.0666V11.0104C9.37085 10.8448 9.23653 10.7104 9.07085 10.7104L6.95974 10.7104C6.79406 10.7104 6.65974 10.8448 6.65974 11.0104V13.0666ZM10.6708 13.0666C10.6708 13.2323 10.8052 13.3666 10.9708 13.3666H13.082C13.2477 13.3666 13.382 13.2323 13.382 13.0666V11.0104C13.382 10.8448 13.2477 10.7104 13.082 10.7104H10.9708C10.8052 10.7104 10.6708 10.8448 10.6708 11.0104V13.0666ZM13.082 9.41045C13.2477 9.41045 13.382 9.27613 13.382 9.11045V6.99946C13.382 6.83378 13.2477 6.69946 13.082 6.69946H10.9708C10.8052 6.69946 10.6708 6.83378 10.6708 6.99946V9.11045C10.6708 9.27613 10.8052 9.41045 10.9708 9.41045H13.082ZM6.95974 9.41045C6.79406 9.41045 6.65974 9.27613 6.65974 9.11045V6.99946C6.65974 6.83378 6.79406 6.69946 6.95974 6.69946L9.07085 6.69946C9.23653 6.69946 9.37085 6.83378 9.37085 6.99946V9.11045C9.37085 9.27613 9.23653 9.41045 9.07085 9.41045H6.95974Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var rn2 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "conditions-double-icon",
    ref: n,
    icon: R0
  }));
});
rn2.displayName = "ConditionsDoubleIcon";
var V0 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "colorChannel1",
      d: "M5.4004 2.60213C5.25792 2.60213 5.14241 2.71763 5.14241 2.86011V4.32679C5.14241 4.67752 4.85809 4.96184 4.50736 4.96184C4.15663 4.96184 3.87231 4.67752 3.87231 4.32679V2.86011C3.87231 2.01618 4.55646 1.33203 5.4004 1.33203H13.14C13.984 1.33203 14.6681 2.01618 14.6681 2.86011V10.5998C14.6681 11.4437 13.984 12.1278 13.14 12.1278H11.6568C11.3061 12.1278 11.0218 11.8435 11.0218 11.4928C11.0218 11.1421 11.3061 10.8577 11.6568 10.8577H13.14C13.2825 10.8577 13.398 10.7422 13.398 10.5998V2.86011C13.398 2.71763 13.2825 2.60213 13.14 2.60213H5.4004Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M1.33203 5.40015C1.33203 4.55622 2.01618 3.87207 2.86011 3.87207H10.5998C11.4437 3.87207 12.1278 4.55622 12.1278 5.40015V13.1398C12.1278 13.9837 11.4437 14.6679 10.5998 14.6679H2.86011C2.01618 14.6679 1.33203 13.9837 1.33203 13.1398V5.40015ZM2.86011 5.14217C2.71763 5.14217 2.60213 5.25767 2.60213 5.40015V13.1398C2.60213 13.2823 2.71763 13.3978 2.86011 13.3978H10.5998C10.7422 13.3978 10.8577 13.2823 10.8577 13.1398V5.40015C10.8577 5.25767 10.7422 5.14217 10.5998 5.14217H2.86011Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var on2 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "copy-double-icon",
    ref: n,
    icon: V0
  }));
});
on2.displayName = "CopyDoubleIcon";
var O0 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M7.69148 5.44796C7.69148 5.07977 7.393 4.7813 7.02481 4.7813H3.25445C2.88626 4.7813 2.58779 5.07977 2.58779 5.44796V10.5516C2.58779 10.9198 2.88626 11.2183 3.25445 11.2183H7.02481C7.393 11.2183 7.69148 10.9198 7.69148 10.5516V5.44796ZM2.58779 3.50537C1.88311 3.50537 1.31186 4.07662 1.31186 4.7813V11.2183C1.31186 11.923 1.88311 12.4942 2.58779 12.4942H7.69148C8.39613 12.4942 8.96739 11.923 8.96739 11.2183V4.7813C8.96739 4.07662 8.39613 3.50537 7.69148 3.50537H2.58779Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "colorChannel1",
      d: "M11.8919 10.4557C11.9671 10.4869 12.0496 10.5041 12.1361 10.5041C12.2226 10.5041 12.3051 10.4869 12.3803 10.4557C12.4555 10.4246 12.526 10.3784 12.5872 10.3172L14.5011 8.40335C14.7502 8.15421 14.7502 7.75028 14.5011 7.50114C14.2519 7.252 13.848 7.252 13.5989 7.50114L12.774 8.32595V6.13406C12.774 5.78172 12.4884 5.49609 12.1361 5.49609C11.7837 5.49609 11.4981 5.78172 11.4981 6.13406V8.32595L10.6733 7.50114C10.4241 7.252 10.0202 7.252 9.77106 7.50114C9.52192 7.75028 9.52192 8.15421 9.77106 8.40335L11.6847 10.3169M6.97288 9.84189C6.69858 10.1235 6.25386 10.1235 5.97956 9.84189L5.17866 9.01974L4.37769 9.84195C4.1034 10.1235 3.65867 10.1235 3.38437 9.84195C3.11008 9.56038 3.11008 9.10385 3.38437 8.82228L4.18534 8.00007L3.38439 7.17787C3.11009 6.8963 3.11009 6.43977 3.38439 6.1582C3.65869 5.87663 4.10341 5.87663 4.37771 6.1582L5.17866 6.9804L5.97954 6.15826C6.25384 5.87669 6.69857 5.87669 6.97287 6.15826C7.24716 6.43984 7.24716 6.89636 6.97286 7.17793L6.17198 8.00007L6.97288 8.82222C7.24718 9.10379 7.24718 9.56031 6.97288 9.84189Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var ln2 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "delete-cell-move-down-double-icon",
    ref: n,
    icon: O0
  }));
});
ln2.displayName = "DeleteCellMoveDownDoubleIcon";
var $0 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M8.29012 10.552C8.29012 10.9202 8.5886 11.2187 8.95679 11.2187L12.7271 11.2187C13.0953 11.2187 13.3938 10.9202 13.3938 10.552L13.3938 5.44836C13.3938 5.08016 13.0953 4.7817 12.7271 4.7817L8.95678 4.7817C8.5886 4.7817 8.29012 5.08016 8.29012 5.44836L8.29012 10.552ZM13.3938 12.4946C14.0985 12.4946 14.6697 11.9234 14.6697 11.2187L14.6697 4.7817C14.6697 4.07703 14.0985 3.50576 13.3938 3.50576L8.29012 3.50576C7.58547 3.50576 7.0142 4.07703 7.0142 4.7817L7.0142 11.2187C7.0142 11.9234 7.58547 12.4946 8.29012 12.4946L13.3938 12.4946Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "colorChannel1",
      d: "M1.37899 7.7562C1.34779 7.83142 1.33053 7.9139 1.33053 8.0004C1.33053 8.0869 1.34779 8.16938 1.37899 8.2446C1.41013 8.31985 1.45626 8.39034 1.51739 8.45151L3.43133 10.3654C3.68046 10.6145 4.08439 10.6145 4.33353 10.3654C4.58266 10.1163 4.58266 9.71232 4.33353 9.46318L3.50873 8.63836L5.70059 8.63836C6.05293 8.63836 6.33855 8.35273 6.33855 8.0004C6.33855 7.64806 6.05293 7.36244 5.70059 7.36244L3.50873 7.36244L4.33353 6.53762C4.58266 6.28848 4.58266 5.88455 4.33353 5.63541C4.08439 5.38627 3.68046 5.38627 3.43133 5.63541L1.51773 7.54899M9.00896 6.15858C9.28326 5.87701 9.72798 5.87701 10.0023 6.15858L10.8032 6.98073L11.6042 6.15852C11.8784 5.87695 12.3232 5.87695 12.5975 6.15852C12.8718 6.44009 12.8718 6.89661 12.5975 7.17819L11.7965 8.00041L12.5975 8.8226C12.8718 9.10417 12.8718 9.56069 12.5975 9.84227C12.3232 10.1238 11.8784 10.1238 11.6041 9.84227L10.8032 9.02007L10.0023 9.84221C9.728 10.1238 9.28327 10.1238 9.00897 9.84221C8.73468 9.56063 8.73468 9.10411 9.00898 8.82254L9.80987 8.00041L9.00896 7.17825C8.73466 6.89668 8.73466 6.44016 9.00896 6.15858Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var sn = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "delete-cell-shift-left-double-icon",
    ref: n,
    icon: $0
  }));
});
sn.displayName = "DeleteCellShiftLeftDoubleIcon";
var E0 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M7.70985 5.44796C7.70985 5.07977 7.41137 4.7813 7.04318 4.7813H3.27282C2.90463 4.7813 2.60616 5.07977 2.60616 5.44796V10.5516C2.60616 10.9198 2.90463 11.2183 3.27282 11.2183H7.04318C7.41137 11.2183 7.70985 10.9198 7.70985 10.5516V5.44796ZM2.60616 3.50537C1.90148 3.50537 1.33023 4.07662 1.33023 4.7813V11.2183C1.33023 11.923 1.90148 12.4942 2.60616 12.4942H7.70985C8.4145 12.4942 8.98576 11.923 8.98576 11.2183V4.7813C8.98576 4.07662 8.4145 3.50537 7.70985 3.50537H2.60616Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "colorChannel1",
      d: "M14.621 8.2438C14.6522 8.16858 14.6695 8.0861 14.6695 7.9996C14.6695 7.9131 14.6522 7.83062 14.621 7.7554C14.5899 7.68015 14.5438 7.60966 14.4826 7.54849L12.5687 5.63461C12.3196 5.38547 11.9156 5.38547 11.6665 5.63461C11.4174 5.88375 11.4174 6.28768 11.6665 6.53682L12.4913 7.36164H10.2994C9.94711 7.36164 9.66148 7.64727 9.66148 7.9996C9.66148 8.35194 9.94711 8.63756 10.2994 8.63756H12.4913L11.6665 9.46238C11.4174 9.71152 11.4174 10.1155 11.6665 10.3646C11.9156 10.6137 12.3196 10.6137 12.5687 10.3646L14.4823 8.45101M6.99107 9.84142C6.71677 10.123 6.27205 10.123 5.99775 9.84142L5.19685 9.01927L4.39588 9.84148C4.12159 10.1231 3.67686 10.1231 3.40256 9.84148C3.12826 9.55991 3.12826 9.10339 3.40256 8.82181L4.20353 7.99959L3.40258 7.1774C3.12828 6.89583 3.12828 6.43931 3.40258 6.15773C3.67688 5.87616 4.1216 5.87616 4.3959 6.15773L5.19685 6.97993L5.99773 6.15779C6.27203 5.87622 6.71676 5.87622 6.99106 6.15779C7.26535 6.43937 7.26535 6.89589 6.99105 7.17746L6.19017 7.99959L6.99107 8.82175C7.26537 9.10332 7.26537 9.55984 6.99107 9.84142Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var an2 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "delete-cell-shift-right-double-icon",
    ref: n,
    icon: E0
  }));
});
an2.displayName = "DeleteCellShiftRightDoubleIcon";
var N02 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M7.69172 10.552C7.69172 10.9202 7.39324 11.2187 7.02506 11.2187H3.2547C2.8865 11.2187 2.58803 10.9202 2.58803 10.552V5.44836C2.58803 5.08016 2.8865 4.7817 3.2547 4.7817H7.02506C7.39324 4.7817 7.69172 5.08016 7.69172 5.44836V10.552ZM2.58803 12.4946C1.88335 12.4946 1.3121 11.9234 1.3121 11.2187V4.7817C1.3121 4.07703 1.88335 3.50576 2.58803 3.50576H7.69172C8.39637 3.50576 8.96764 4.07703 8.96764 4.7817V11.2187C8.96764 11.9234 8.39637 12.4946 7.69172 12.4946H2.58803Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "colorChannel1",
      d: "M11.892 5.54431C11.9672 5.51312 12.0497 5.49591 12.1362 5.49591C12.2227 5.49591 12.3052 5.51312 12.3804 5.54431C12.4557 5.57545 12.5261 5.62159 12.5873 5.68276L14.5012 7.59665C14.7503 7.84579 14.7503 8.24972 14.5012 8.49886C14.2521 8.748 13.8481 8.748 13.599 8.49886L12.7741 7.67405V9.86594C12.7741 10.2183 12.4885 10.5039 12.1362 10.5039C11.7839 10.5039 11.4983 10.2183 11.4983 9.86594V7.67405L10.6734 8.49886C10.4243 8.748 10.0203 8.748 9.77121 8.49886C9.52207 8.24972 9.52207 7.84579 9.77121 7.59665L11.6848 5.68305M6.97304 6.15811C6.69874 5.87653 6.25401 5.87654 5.97972 6.15811L5.17881 6.98026L4.37784 6.15805C4.10355 5.87647 3.65882 5.87647 3.38453 6.15805C3.11023 6.43962 3.11023 6.89615 3.38453 7.17772L4.18549 7.99993L3.38454 8.82213C3.11024 9.1037 3.11024 9.56023 3.38454 9.8418C3.65884 10.1234 4.10356 10.1234 4.37786 9.8418L5.17881 9.0196L5.9797 9.84174C6.254 10.1233 6.69872 10.1233 6.97302 9.84174C7.24732 9.56016 7.24732 9.10364 6.97302 8.82207L6.17213 7.99993L6.97304 7.17778C7.24734 6.89621 7.24734 6.43969 6.97304 6.15811Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var cn = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "delete-cell-shift-up-double-icon",
    ref: n,
    icon: N02
  }));
});
cn.displayName = "DeleteCellShiftUpDoubleIcon";
var D0 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M11.9503 1.33317C12.6866 1.33317 13.2836 1.9301 13.2836 2.6665V13.3332C13.2836 14.0695 12.6866 14.6665 11.9503 14.6665H9.28359C8.54721 14.6665 7.95026 14.0696 7.95026 13.3332L7.95026 2.6665C7.95026 1.9301 8.54721 1.33317 9.28359 1.33317H11.9503ZM11.9503 2.6665V13.3332H9.28359V2.6665H11.9503Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "colorChannel1",
      d: "M3.8542 6.29716C3.59385 6.03681 3.17174 6.03681 2.91139 6.29716C2.65104 6.55751 2.65104 6.97962 2.91139 7.23997L3.67157 8.00014L2.9114 8.76031C2.65105 9.02066 2.65105 9.44277 2.9114 9.70312C3.17175 9.96347 3.59387 9.96347 3.85421 9.70312L4.61437 8.94296L5.37459 9.70318C5.63494 9.96352 6.05705 9.96353 6.31741 9.70318C6.57775 9.44283 6.57775 9.02072 6.31741 8.76036L5.55718 8.00014L6.31742 7.23991C6.57777 6.97956 6.57777 6.55745 6.31742 6.2971C6.05707 6.03675 5.63496 6.03675 5.37461 6.2971L4.61437 7.05734L3.8542 6.29716Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var un3 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "delete-column-double-icon",
    ref: n,
    icon: D0
  }));
});
un3.displayName = "DeleteColumnDoubleIcon";
var T0 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M14.6666 11.9502C14.6666 12.6866 14.0697 13.2835 13.3333 13.2835H2.66665C1.93027 13.2835 1.33331 12.6866 1.33331 11.9502V9.28353C1.33331 8.54715 1.93027 7.9502 2.66665 7.9502L13.3333 7.9502C14.0697 7.9502 14.6666 8.54715 14.6666 9.28353V11.9502ZM13.3333 11.9502H2.66665V9.28353H13.3333V11.9502Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "colorChannel1",
      d: "M9.60134 3.85438C9.86169 3.59403 9.86169 3.17192 9.60134 2.91157C9.34099 2.65122 8.91888 2.65122 8.65853 2.91157L7.89835 3.67175L7.13819 2.91159C6.87784 2.65124 6.45573 2.65124 6.19538 2.91159C5.93503 3.17194 5.93503 3.59405 6.19538 3.8544L6.95554 4.61456L6.19532 5.37478C5.93497 5.63513 5.93497 6.05724 6.19532 6.31759C6.45567 6.57794 6.87778 6.57794 7.13813 6.31759L7.89835 5.55737L8.65859 6.3176C8.91893 6.57796 9.34105 6.57796 9.60139 6.3176C9.86175 6.05726 9.86175 5.63514 9.60139 5.3748L8.84116 4.61456L9.60134 3.85438Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var dn = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "delete-row-double-icon",
    ref: n,
    icon: T0
  }));
});
dn.displayName = "DeleteRowDoubleIcon";
var Z0 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M3.99992 1.33301H2.66659C1.93021 1.33301 1.33325 1.92996 1.33325 2.66634V3.99967H2.66659V2.66634L3.99992 2.66634V1.33301Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M1.33325 9.33301H2.66659V6.66634H1.33325V9.33301Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M6.66659 1.33301V2.66634H7.33325V5.33301H8.66659V2.66634H9.33325V1.33301H6.66659Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M11.9999 1.33301V2.66634H13.3333V3.99967H14.6666V2.66634C14.6666 1.92996 14.0696 1.33301 13.3333 1.33301H11.9999Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M14.6666 6.66634H13.3333V7.33301H10.6666V8.66634H13.3333V9.33301H14.6666V6.66634Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M7.33325 13.333V10.6663H8.66659V13.333H7.33325Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M5.33325 7.33301H2.66659V8.66634H5.33325V7.33301Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M1.33325 13.3333V12H2.66659L2.66659 13.3333H13.3333V12H14.6666V13.3333C14.6666 14.0697 14.0696 14.6667 13.3333 14.6667H2.66659C1.93021 14.6667 1.33325 14.0697 1.33325 13.3333Z"
      }
    }
  ]
};
var hn2 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "down-border-double-icon",
    ref: n,
    icon: Z0
  }));
});
hn2.displayName = "DownBorderDoubleIcon";
var A0 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 17 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "colorChannel1",
      d: "M1.98682 13.4992C1.98682 12.5603 2.74793 11.7992 3.68682 11.7992H14.2868C15.2257 11.7992 15.9868 12.5603 15.9868 13.4992V13.4992C15.9868 14.4381 15.2257 15.1992 14.2868 15.1992H3.68682C2.74793 15.1992 1.98682 14.4381 1.98682 13.4992V13.4992Z"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M10.3014 1.70389C9.85268 0.479568 8.12109 0.479557 7.67238 1.70389L4.72235 9.75326C4.60832 10.0644 4.76811 10.4091 5.07924 10.5231C5.39038 10.6371 5.73504 10.4773 5.84907 10.1662L6.99975 7.02646C7.03588 7.03324 7.07314 7.03679 7.11123 7.03679H10.9778L12.1247 10.1662C12.2387 10.4773 12.5834 10.6371 12.8945 10.5231C13.2057 10.4091 13.3654 10.0644 13.2514 9.75326L10.3014 1.70389ZM10.538 5.83679L9.17467 2.11682C9.11057 1.94192 8.8632 1.94192 8.7991 2.11682L7.43576 5.83679H10.538Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var fn3 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "font-color-double-icon",
    ref: n,
    icon: A0
  }));
});
fn3.displayName = "FontColorDoubleIcon";
var B0 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M8.01519 4.9156C7.65059 4.9156 7.29055 4.96431 6.93757 5.05194C6.6062 5.1342 6.2709 4.93226 6.18864 4.60089C6.10638 4.26953 6.30831 3.93422 6.63968 3.85196C7.0796 3.74275 7.53991 3.6792 8.01519 3.6792C9.93752 3.6792 11.6225 4.71575 12.781 5.67605C13.3691 6.16346 13.8434 6.64946 14.171 7.01358C14.3351 7.19604 14.4633 7.34895 14.5515 7.45755C14.5956 7.51187 14.6298 7.5552 14.6535 7.58568C14.6653 7.60092 14.6745 7.61296 14.6811 7.62157L14.6889 7.63188L14.6913 7.63506L14.6921 7.63614C14.6921 7.63614 14.6927 7.63689 14.1972 8.0066C14.6927 8.37631 14.6925 8.37646 14.6925 8.37646L14.6921 8.37705L14.6913 8.37814L14.6889 8.38131L14.6811 8.39163C14.6745 8.40023 14.6653 8.41227 14.6535 8.42752C14.6298 8.458 14.5956 8.50132 14.5515 8.55565C14.4633 8.66425 14.3351 8.81715 14.171 8.99961C13.8434 9.36373 13.3691 9.84973 12.781 10.3371C12.5182 10.555 12.1284 10.5186 11.9106 10.2557C11.6927 9.99285 11.7291 9.60313 11.992 9.38524C12.5227 8.94536 12.9537 8.50406 13.2518 8.1727C13.3051 8.11347 13.354 8.05788 13.3984 8.0066C13.354 7.95531 13.3051 7.89972 13.2518 7.84049C12.9537 7.50913 12.5227 7.06783 11.992 6.62795C10.9131 5.73365 9.50709 4.9156 8.01519 4.9156ZM14.1972 8.0066L14.6925 8.37646C14.8562 8.15715 14.8563 7.8562 14.6927 7.63689L14.1972 8.0066ZM4.11981 5.75748C4.3377 6.02035 4.30123 6.41007 4.03837 6.62795C3.50769 7.06783 3.07669 7.50913 2.7786 7.84049C2.72531 7.89972 2.67639 7.95531 2.63203 8.0066C2.67639 8.05788 2.72531 8.11347 2.7786 8.17271C3.07669 8.50406 3.50769 8.94536 4.03837 9.38524C5.11729 10.2795 6.5233 11.0976 8.01519 11.0976C8.38283 11.0976 8.74582 11.0481 9.10157 10.9591C9.43279 10.8762 9.76846 11.0776 9.85131 11.4088C9.93417 11.74 9.73283 12.0757 9.40162 12.1585C8.95841 12.2694 8.49443 12.334 8.01519 12.334C6.09287 12.334 4.40788 11.2974 3.24935 10.3371C2.66132 9.84973 2.18698 9.36373 1.85941 8.99961C1.69527 8.81715 1.56704 8.66425 1.47887 8.55565C1.43476 8.50132 1.4006 8.458 1.37692 8.42752C1.36508 8.41227 1.35585 8.40023 1.3493 8.39162L1.34149 8.38131L1.3391 8.37813L1.33829 8.37705C1.33829 8.37705 1.33773 8.37631 1.8332 8.0066C1.33773 7.63689 1.33785 7.63673 1.33785 7.63673L1.3391 7.63506L1.34149 7.63188L1.3493 7.62157C1.35585 7.61296 1.36508 7.60092 1.37692 7.58568C1.4006 7.5552 1.43476 7.51187 1.47887 7.45755C1.56704 7.34895 1.69527 7.19604 1.85941 7.01358C2.18698 6.64946 2.66132 6.16346 3.24935 5.67605C3.51221 5.45816 3.90193 5.49462 4.11981 5.75748ZM1.8332 8.0066L1.33785 7.63673C1.1742 7.85604 1.17464 8.15774 1.33829 8.37705L1.8332 8.0066Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "colorChannel1",
      d: "M3.8775 2.99454C3.63608 2.75312 3.24466 2.75312 3.00323 2.99454C2.76181 3.23596 2.76181 3.62739 3.00323 3.86881L6.11167 6.97725C5.94588 7.28339 5.85153 7.63423 5.85153 8.00647C5.85153 9.20144 6.82025 10.1702 8.01523 10.1702C8.38756 10.1702 8.73834 10.0758 9.04444 9.91001L12.1095 12.9751C12.3509 13.2165 12.7424 13.2165 12.9838 12.9751C13.2252 12.7337 13.2252 12.3422 12.9838 12.1008L3.8775 2.99454ZM8.0668 8.93237L7.08932 7.9549C7.0884 7.97197 7.08793 7.98916 7.08793 8.00647C7.08793 8.5186 7.5031 8.93377 8.01523 8.93377C8.03254 8.93377 8.04973 8.9333 8.0668 8.93237Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var Cn = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "hide-double-icon",
    ref: n,
    icon: B0
  }));
});
Cn.displayName = "HideDoubleIcon";
var P0 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M1.33325 13.333V11.9997H2.66659L2.66659 13.333H3.99992V14.6663H2.66659C1.93021 14.6663 1.33325 14.0694 1.33325 13.333Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M2.66659 1.33301H3.99992V2.66634L2.66659 2.66634V3.99967H1.33325V2.66634C1.33325 1.92996 1.93021 1.33301 2.66659 1.33301Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M2.66659 9.33301H1.33325V6.66634H2.66659V9.33301Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M6.66659 2.66634V1.33301H9.33325V2.66634H8.66496V3.9855H7.33496V2.66634H6.66659Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M11.9999 2.66634V1.33301H13.3333C14.0696 1.33301 14.6666 1.92996 14.6666 2.66634V3.99967H13.3333V2.66634H11.9999Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M13.3333 6.66634H14.6666V9.33301H13.3333V6.66634Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M13.3333 11.9997H14.6666V13.333C14.6666 14.0694 14.0696 14.6663 13.3333 14.6663H11.9999V13.333H13.3333V11.9997Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M9.33325 13.333V14.6663H6.66659V13.333H7.33496V12.0138H8.66496V13.333H9.33325Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M7.33496 6.66159L7.33496 9.33768H8.66496V6.66159H7.33496Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M8.66687 7.33423H7.33354L2.66687 7.33431V8.66764H7.33354L8.66687 8.66756L13.3335 8.66764V7.33431L8.66687 7.33423Z"
      }
    }
  ]
};
var vn = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "horizontal-border-double-icon",
    ref: n,
    icon: P0
  }));
});
vn.displayName = "HorizontalBorderDoubleIcon";
var F0 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "colorChannel1",
      d: "M1.33325 11.9997V13.333C1.33325 14.0694 1.93021 14.6663 2.66659 14.6663H3.99992V13.333H2.66659L2.66659 11.9997H1.33325ZM3.99992 1.33301H2.66659C1.93021 1.33301 1.33325 1.92996 1.33325 2.66634V3.99967H2.66659V2.66634L3.99992 2.66634V1.33301ZM1.33325 9.33301H2.66659V6.66634H1.33325V9.33301ZM6.66659 1.33301V2.66634H9.33325V1.33301H6.66659ZM11.9999 1.33301V2.66634H13.3333V3.99967H14.6666V2.66634C14.6666 1.92996 14.0696 1.33301 13.3333 1.33301H11.9999ZM14.6666 6.66634H13.3333V9.33301H14.6666V6.66634ZM14.6666 11.9997H13.3333V13.333H11.9999V14.6663H13.3333C14.0696 14.6663 14.6666 14.0694 14.6666 13.333V11.9997ZM9.33325 14.6663V13.333H6.66659V14.6663H9.33325Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M8.66693 7.33415V2.66748H7.3336V7.33415H2.66693V8.66748H7.3336V13.3341H8.66693V8.66748H13.3336V7.33415H8.66693Z"
    }
  }]
};
var gn = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "inner-border-double-icon",
    ref: n,
    icon: F0
  }));
});
gn.displayName = "InnerBorderDoubleIcon";
var k0 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M7.66105 5.44796C7.66105 5.07977 7.36257 4.7813 6.99439 4.7813H3.22403C2.85583 4.7813 2.55736 5.07977 2.55736 5.44796V10.5516C2.55736 10.9198 2.85583 11.2183 3.22403 11.2183H6.99439C7.36257 11.2183 7.66105 10.9198 7.66105 10.5516V5.44796ZM2.55736 3.50537C1.85268 3.50537 1.28143 4.07662 1.28143 4.7813V11.2183C1.28143 11.923 1.85268 12.4942 2.55736 12.4942H7.66105C8.3657 12.4942 8.93697 11.923 8.93697 11.2183V4.7813C8.93697 4.07662 8.3657 3.50537 7.66105 3.50537H2.55736Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "colorChannel1",
      d: "M11.9225 10.465C11.9977 10.4962 12.0802 10.5134 12.1667 10.5134C12.2532 10.5134 12.3357 10.4962 12.4109 10.465C12.4862 10.4338 12.5567 10.3877 12.6178 10.3265L14.5317 8.41263C14.7808 8.16349 14.7808 7.75956 14.5317 7.51042C14.2826 7.26128 13.8786 7.26128 13.6295 7.51042L12.8047 8.33523V6.14333C12.8047 5.791 12.5191 5.50537 12.1667 5.50537C11.8144 5.50537 11.5288 5.791 11.5288 6.14333V8.33523L10.7039 7.51042C10.4548 7.26128 10.0509 7.26128 9.80172 7.51042C9.55258 7.75956 9.55258 8.16349 9.80172 8.41263L11.7153 10.3262",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var pn3 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "insert-cell-down-double-icon",
    ref: n,
    icon: k0
  }));
});
pn3.displayName = "InsertCellDownDoubleIcon";
var j0 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M7.56614 5.44796C7.56614 5.07977 7.26766 4.7813 6.89948 4.7813H3.12912C2.76092 4.7813 2.46245 5.07977 2.46245 5.44796V10.5516C2.46245 10.9198 2.76092 11.2183 3.12912 11.2183H6.89948C7.26766 11.2183 7.56614 10.9198 7.56614 10.5516V5.44796ZM2.46245 3.50537C1.75777 3.50537 1.18652 4.07662 1.18652 4.7813V11.2183C1.18652 11.923 1.75777 12.4942 2.46245 12.4942H7.56614C8.27079 12.4942 8.84206 11.923 8.84206 11.2183V4.7813C8.84206 4.07662 8.27079 3.50537 7.56614 3.50537H2.46245Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "colorChannel1",
      d: "M14.7651 8.2438C14.7963 8.16858 14.8135 8.0861 14.8135 7.9996C14.8135 7.9131 14.7963 7.83062 14.7651 7.7554C14.7339 7.68015 14.6878 7.60966 14.6266 7.54849L12.7127 5.63461C12.4636 5.38547 12.0597 5.38547 11.8105 5.63461C11.5614 5.88375 11.5614 6.28768 11.8105 6.53682L12.6353 7.36164H10.4434C10.0911 7.36164 9.80548 7.64727 9.80548 7.9996C9.80548 8.35194 10.0911 8.63756 10.4434 8.63756H12.6353L11.8105 9.46238C11.5614 9.71152 11.5614 10.1155 11.8105 10.3646C12.0597 10.6137 12.4636 10.6137 12.7127 10.3646L14.6263 8.45101",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var mn2 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "insert-cell-shift-right-double-icon",
    ref: n,
    icon: j0
  }));
});
mn2.displayName = "InsertCellShiftRightDoubleIcon";
var U0 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M2.53337 14C2.35658 14 2.18704 13.9297 2.06203 13.8047C1.93703 13.6797 1.86681 13.5101 1.86681 13.3333C1.86681 13.1565 1.93703 12.987 2.06203 12.862C2.18704 12.7369 2.35658 12.6667 2.53337 12.6667L13.4667 12.6667C13.6435 12.6667 13.813 12.7369 13.938 12.862C14.063 12.987 14.1333 13.1565 14.1333 13.3333C14.1333 13.5101 14.063 13.6797 13.938 13.8047C13.813 13.9297 13.6435 14 13.4667 14L2.53337 14ZM2.53337 3.33333C2.35658 3.33331 2.18703 3.26306 2.06203 3.13804C1.93703 3.01301 1.86681 2.84346 1.86681 2.66667C1.86681 2.48987 1.93703 2.32032 2.06203 2.1953C2.18703 2.07028 2.35658 2.00003 2.53337 2L13.4667 2C13.6435 2.00003 13.813 2.07028 13.938 2.1953C14.063 2.32032 14.1333 2.48987 14.1333 2.66667C14.1333 2.84346 14.063 3.01301 13.938 3.13803C13.813 3.26306 13.6435 3.33331 13.4667 3.33333L2.53337 3.33333Z"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "colorChannel1",
      d: "M11.0573 7.33327L10.1953 6.47127C10.0703 6.34627 10.0001 6.17672 10.0001 5.99994C10.0001 5.82315 10.0703 5.65361 10.1953 5.52861C10.3203 5.4036 10.4899 5.33337 10.6667 5.33337C10.8434 5.33337 11.013 5.4036 11.138 5.52861L13.138 7.5286C13.2 7.59046 13.2491 7.66393 13.2827 7.74481C13.3162 7.82569 13.3335 7.91238 13.3335 7.99994C13.3335 8.08749 13.3162 8.17419 13.2827 8.25507C13.2491 8.33594 13.2 8.40941 13.138 8.47127L11.138 10.4713C11.0761 10.5332 11.0026 10.5823 10.9217 10.6158C10.8409 10.6493 10.7542 10.6665 10.6667 10.6665C10.5791 10.6665 10.4925 10.6493 10.4116 10.6158C10.3307 10.5823 10.2572 10.5332 10.1953 10.4713C10.1334 10.4094 10.0843 10.3359 10.0508 10.255C10.0173 10.1742 10.0001 10.0875 10.0001 9.99994C10.0001 9.9124 10.0173 9.82573 10.0508 9.74486C10.0843 9.66398 10.1334 9.5905 10.1953 9.52861L11.0573 8.6666L3.33333 8.66661C3.15652 8.66661 2.98695 8.59637 2.86193 8.47134C2.7369 8.34632 2.66666 8.17675 2.66666 7.99994C2.66666 7.82313 2.7369 7.65356 2.86193 7.52853C2.98695 7.40351 3.15652 7.33327 3.33333 7.33327L11.0573 7.33327Z"
    }
  }]
};
var bn = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "insert-double-icon",
    ref: n,
    icon: U0
  }));
});
bn.displayName = "InsertDoubleIcon";
var z0 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M13.3333 13.4087C14.0697 13.4087 14.6666 12.8117 14.6666 12.0754L14.6666 9.40869C14.6666 8.67231 14.0697 8.07536 13.3333 8.07536L2.66663 8.07536C1.93023 8.07536 1.33329 8.67231 1.33329 9.40869L1.33329 12.0754C1.33329 12.8117 1.93023 13.4087 2.66663 13.4087L13.3333 13.4087ZM2.66663 12.0754L13.3333 12.0754L13.3333 9.40869L2.66663 9.40869L2.66663 12.0754Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "colorChannel1",
      d: "M7.74168 2.59137C8.10987 2.59137 8.40835 2.88984 8.40835 3.25804L8.40835 4.33309L9.48348 4.33309C9.85167 4.33309 10.1501 4.63156 10.1501 4.99976C10.1501 5.36794 9.85167 5.66642 9.48348 5.66642L8.40835 5.66642L8.40835 6.74154C8.40835 7.10973 8.10987 7.4082 7.74168 7.4082C7.37349 7.4082 7.07501 7.10973 7.07501 6.74154L7.07501 5.66642L5.99998 5.66642C5.63179 5.66642 5.33331 5.36794 5.33331 4.99976C5.33331 4.63156 5.63179 4.33309 5.99998 4.33309L7.07501 4.33309L7.07501 3.25804C7.07501 2.88984 7.37349 2.59137 7.74168 2.59137Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var Ln2 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "insert-row-above-double-icon",
    ref: n,
    icon: z0
  }));
});
Ln2.displayName = "InsertRowAboveDoubleIcon";
var W0 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M2.66671 2.59131C1.93033 2.59131 1.33337 3.18826 1.33337 3.92464L1.33337 6.59131C1.33337 7.32769 1.93033 7.92464 2.66671 7.92464L13.3334 7.92464C14.0698 7.92464 14.6667 7.32769 14.6667 6.59131L14.6667 3.92464C14.6667 3.18826 14.0698 2.59131 13.3334 2.59131L2.66671 2.59131ZM13.3334 3.92464L2.66671 3.92464L2.66671 6.59131L13.3334 6.59131L13.3334 3.92464Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "colorChannel1",
      d: "M8.25838 13.4086C7.8902 13.4086 7.59172 13.1102 7.59172 12.742L7.59172 11.6669L6.51658 11.6669C6.14839 11.6669 5.84992 11.3684 5.84991 11.0002C5.84991 10.6321 6.14839 10.3336 6.51658 10.3336L7.59172 10.3336L7.59171 9.25846C7.59171 8.89027 7.89019 8.5918 8.25838 8.5918C8.62657 8.5918 8.92505 8.89027 8.92505 9.25846L8.92505 10.3336L10.0001 10.3336C10.3683 10.3336 10.6667 10.6321 10.6667 11.0002C10.6667 11.3684 10.3683 11.6669 10.0001 11.6669L8.92505 11.6669L8.92505 12.742C8.92505 13.1102 8.62658 13.4086 8.25838 13.4086Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var wn = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "insert-row-below-double-icon",
    ref: n,
    icon: W0
  }));
});
wn.displayName = "InsertRowBelowDoubleIcon";
var Y0 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M14.6664 3.99967L14.6664 2.66634C14.6664 1.92996 14.0694 1.33301 13.333 1.33301L11.9997 1.33301L11.9997 2.66634L13.333 2.66634L13.333 3.99967L14.6664 3.99967Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M6.66638 1.33301L6.66638 2.66634L9.33305 2.66634L9.33305 1.33301L6.66638 1.33301Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M14.6664 6.66634L13.333 6.66634L13.333 7.33301L10.6664 7.33301L10.6664 8.66634L13.333 8.66634L13.333 9.33301L14.6664 9.33301L14.6664 6.66634Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M14.6664 11.9997L13.333 11.9997L13.333 13.333L11.9997 13.333L11.9997 14.6663L13.333 14.6663C14.0694 14.6663 14.6664 14.0694 14.6664 13.333L14.6664 11.9997Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M9.33305 14.6663L9.33305 13.333L8.66638 13.333L8.66638 10.6663L7.33305 10.6663L7.33305 13.333L6.66638 13.333L6.66638 14.6663L9.33305 14.6663Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M2.66638 7.33301L5.33305 7.33301L5.33305 8.66634L2.66638 8.66634L2.66638 7.33301Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M8.66638 5.33301L8.66638 2.66634L7.33305 2.66634L7.33305 5.33301L8.66638 5.33301Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M2.66667 1.33301L4 1.33301L4 2.66634L2.66667 2.66634L2.66667 13.333L4 13.333L4 14.6663L2.66667 14.6663C1.93029 14.6663 1.33333 14.0694 1.33333 13.333L1.33333 2.66634C1.33333 1.92996 1.93029 1.33301 2.66667 1.33301Z"
      }
    }
  ]
};
var _n2 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "left-border-double-icon",
    ref: n,
    icon: Y0
  }));
});
_n2.displayName = "LeftBorderDoubleIcon";
var G0 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M3.2987 2.39556L14.424 7.49259L13.9241 8.58354L4.06409 4.06617L8.58147 13.9262L7.49051 14.426L2.39348 3.30078L2.08524 3.15956L2.20701 2.89377L2.06653 2.58713L2.42214 2.42421L2.58506 2.0686L2.89169 2.20909L3.15748 2.08732L3.2987 2.39556Z"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "colorChannel1",
      d: "M1.34351 12.0924L1.34351 13.4565C1.34351 14.1193 1.88077 14.6565 2.54351 14.6565L3.90764 14.6565L3.90764 13.3265L2.67351 13.3265L2.67351 12.0924L1.34351 12.0924ZM3.90763 1.34351L2.54351 1.34351C1.88076 1.34351 1.34351 1.88076 1.34351 2.54351L1.34351 3.90764L2.67351 3.90764L2.67351 2.67351L3.90763 2.67351L3.90763 1.34351ZM1.34351 9.36415L2.67351 9.36415L2.67351 6.63589L1.34351 6.63589L1.34351 9.36415ZM6.63589 1.34351L6.63589 2.67351L9.36415 2.67351L9.36415 1.34351L6.63589 1.34351ZM12.0924 1.34351L12.0924 2.67351L13.3265 2.67351L13.3265 3.90763L14.6565 3.90763L14.6565 2.54351C14.6565 1.88076 14.1193 1.34351 13.4565 1.34351L12.0924 1.34351ZM14.6565 6.63589L13.3265 6.63589L13.3265 9.36415L14.6565 9.36415L14.6565 6.63589ZM14.6565 12.0924L13.3265 12.0924L13.3265 13.3265L12.0924 13.3265L12.0924 14.6565L13.4565 14.6565C14.1193 14.6565 14.6565 14.1193 14.6565 13.4565L14.6565 12.0924ZM9.36415 14.6565L9.36415 13.3265L6.63589 13.3265L6.63589 14.6565L9.36415 14.6565Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var yn = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "left-double-diagonal-double-icon",
    ref: n,
    icon: G0
  }));
});
yn.displayName = "LeftDoubleDiagonalDoubleIcon";
var X0 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M13.4322 2.66683C13.4322 1.93045 12.8352 1.3335 12.0989 1.3335H9.43219C8.69581 1.3335 8.09886 1.93045 8.09886 2.66683V13.3335C8.09886 14.0699 8.69581 14.6668 9.43219 14.6668H12.0989C12.8352 14.6668 13.4322 14.0699 13.4322 13.3335V2.66683ZM12.0989 13.3335V2.66683H9.43219V13.3335H12.0989Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "colorChannel1",
      d: "M2.56769 7.99978C2.56769 7.63159 2.86616 7.33311 3.23435 7.33311H4.30941V6.25798C4.30941 5.88979 4.60788 5.59131 4.97607 5.59131C5.34426 5.59131 5.64274 5.88979 5.64274 6.25798V7.33311H6.71785C7.08604 7.33311 7.38452 7.63159 7.38452 7.99978C7.38452 8.36797 7.08604 8.66644 6.71785 8.66644H5.64274V9.74148C5.64274 10.1097 5.34426 10.4081 4.97607 10.4081C4.60788 10.4081 4.30941 10.1097 4.30941 9.74148V8.66644H3.23435C2.86616 8.66644 2.56769 8.36797 2.56769 7.99978Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var Mn = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "left-insert-column-double-icon",
    ref: n,
    icon: X0
  }));
});
Mn.displayName = "LeftInsertColumnDoubleIcon";
var q0 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 17 17",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M2.33875 3.57255L2.23657 3.79614L2.72883 4.0211L7.58275 14.6428L8.67419 14.144L5.10931 6.34311L13.5649 14.7987L14.4134 13.9502L5.96172 5.49847L13.7573 9.0609L14.2561 7.96947L3.63438 3.11555L3.40942 2.62329L3.18782 2.72456L3.09973 2.63647L2.93861 2.7976L2.73534 2.70471L2.60444 2.99116L2.31799 3.12206L2.41088 3.32533L2.2512 3.485L2.33875 3.57255Z"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "colorChannel1",
      d: "M1.6759 12.8102L1.6759 14.1743C1.6759 14.8371 2.21316 15.3743 2.8759 15.3743L4.24003 15.3743L4.24003 14.0443L3.0059 14.0443L3.0059 12.8102L1.6759 12.8102ZM4.24003 2.06128L2.8759 2.06128C2.21316 2.06128 1.6759 2.59854 1.6759 3.26128L1.6759 4.62541L3.0059 4.62541L3.0059 3.39128L4.24003 3.39128L4.24003 2.06128ZM1.6759 10.0819L3.0059 10.0819L3.0059 7.35367L1.6759 7.35367L1.6759 10.0819ZM6.96829 2.06128L6.96829 3.39128L9.69655 3.39128L9.69655 2.06128L6.96829 2.06128ZM12.4248 2.06128L12.4248 3.39128L13.6589 3.39128L13.6589 4.62541L14.9889 4.62541L14.9889 3.26128C14.9889 2.59854 14.4517 2.06128 13.7889 2.06128L12.4248 2.06128ZM14.9889 7.35367L13.6589 7.35367L13.6589 10.0819L14.9889 10.0819L14.9889 7.35367ZM14.9889 12.8102L13.6589 12.8102L13.6589 14.0443L12.4248 14.0443L12.4248 15.3743L13.7889 15.3743C14.4517 15.3743 14.9889 14.8371 14.9889 14.1743L14.9889 12.8102ZM9.69655 15.3743L9.69655 14.0443L6.96829 14.0443L6.96829 15.3743L9.69655 15.3743Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var In2 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "left-tridiagonal-double-icon",
    ref: n,
    icon: q0
  }));
});
In2.displayName = "LeftTridiagonalDoubleIcon";
var J0 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M12.665 2.66496H3.33496C2.96493 2.66496 2.66496 2.96493 2.66496 3.33496V12.665C2.66496 13.035 2.96493 13.335 3.33496 13.335H12.665C13.035 13.335 13.335 13.035 13.335 12.665V3.33496C13.335 2.96493 13.035 2.66496 12.665 2.66496ZM3.33496 1.33496C2.23039 1.33496 1.33496 2.23039 1.33496 3.33496V12.665C1.33496 13.7695 2.23039 14.665 3.33496 14.665H12.665C13.7695 14.665 14.665 13.7695 14.665 12.665V3.33496C14.665 2.23039 13.7695 1.33496 12.665 1.33496H3.33496Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "colorChannel1",
      d: "M13.2559 14.1963L1.64941 2.58984L2.58987 1.64939L14.1963 13.2558L13.2559 14.1963Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var Hn = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "no-color-double-icon",
    ref: n,
    icon: J0
  }));
});
Hn.displayName = "NoColorDoubleIcon";
var Q0 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M13.3333 2.66634H2.66659V13.333H13.3333V2.66634ZM2.66659 1.33301C1.93021 1.33301 1.33325 1.92996 1.33325 2.66634V13.333C1.33325 14.0694 1.93021 14.6663 2.66659 14.6663H13.3333C14.0696 14.6663 14.6666 14.0694 14.6666 13.333V2.66634C14.6666 1.92996 14.0696 1.33301 13.3333 1.33301H2.66659Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M7.33311 2.66748V5.33415H8.66644V2.66748H7.33311Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M7.33311 10.6675V13.3341H8.66644V10.6675H7.33311Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M13.3331 7.33415H10.6664V8.66748H13.3331V7.33415Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M5.33311 7.33415H2.66644V8.66748H5.33311V7.33415Z"
      }
    }
  ]
};
var xn2 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "outer-border-double-icon",
    ref: n,
    icon: Q0
  }));
});
xn2.displayName = "OuterBorderDoubleIcon";
var K0 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 17 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M8.01281 1.36643C8.79386 0.585377 10.0602 0.585378 10.8412 1.36643L12.9223 3.44752C13.7034 4.22857 13.7034 5.4949 12.9223 6.27595L9.36445 9.83383C8.5834 10.6149 7.31707 10.6149 6.53602 9.83383L4.45493 7.75273C3.67388 6.97168 3.67388 5.70535 4.45493 4.9243L8.01281 1.36643ZM9.9927 2.21495C9.68028 1.90253 9.17375 1.90253 8.86133 2.21495L5.30346 5.77283L5.29671 5.77966L10.839 6.66224L12.0738 5.42742C12.3862 5.115 12.3862 4.60847 12.0738 4.29605L9.9927 2.21495Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M14.5179 9.48875C14.5179 9.99175 14.1101 10.3995 13.607 10.3995C13.1041 10.3995 12.6963 9.99175 12.6963 9.48875C12.6963 9.1773 13.0455 8.59966 13.3114 8.20487C13.4549 7.99177 13.7591 7.99177 13.9027 8.20486C14.1687 8.59965 14.5179 9.1773 14.5179 9.48875Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M1.98682 13.4992C1.98682 12.5603 2.74793 11.7992 3.68682 11.7992H14.2868C15.2257 11.7992 15.9868 12.5603 15.9868 13.4992V13.4992C15.9868 14.4381 15.2257 15.1992 14.2868 15.1992H3.68682C2.74793 15.1992 1.98682 14.4381 1.98682 13.4992V13.4992Z"
      }
    }
  ]
};
var Sn2 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "paint-bucket-double-icon",
    ref: n,
    icon: K0
  }));
});
Sn2.displayName = "PaintBucketDoubleIcon";
var e5 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M7.74692 9.12463C7.74692 9.46018 8.01893 9.73219 8.35448 9.73219H11.4933C11.8288 9.73219 12.1009 9.46018 12.1009 9.12463C12.1009 8.78909 11.8288 8.51707 11.4933 8.51707H8.35448C8.01893 8.51707 7.74692 8.78909 7.74692 9.12463Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M10.8636 10.8523C10.8636 11.1879 10.5915 11.4599 10.256 11.4599H8.35448C8.01893 11.4599 7.74692 11.1879 7.74692 10.8523C7.74692 10.5168 8.01893 10.2447 8.35448 10.2447H10.256C10.5915 10.2447 10.8636 10.5168 10.8636 10.8523Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M5.4791 1.98268C5.47913 1.71529 5.87912 1.49854 6.37252 1.49854C6.86593 1.49854 7.26592 1.71529 7.26595 1.98268H7.62187C8.22277 1.98268 8.72459 2.39534 8.84412 2.9452H9.39563C10.0856 2.9452 10.6449 3.48923 10.6449 4.16032V6.00569H12.1261C13.161 6.00569 14 6.82174 14 7.82838V11.334C14 11.8174 13.8025 12.281 13.4511 12.6228L12.0693 13.9647C11.7179 14.3065 11.2412 14.4985 10.7442 14.4985H7.91116C7.05024 14.4985 6.32492 14.0431 6.10535 13.2737H3.34925C2.6593 13.2737 2.09998 12.7297 2.09998 12.0586V4.16032C2.09998 3.48923 2.6593 2.9452 3.34925 2.9452H3.90107C4.0206 2.39534 4.52241 1.98268 5.12332 1.98268H5.4791ZM3.97249 4.16032H3.24925L3.24925 12.0586H6.03725V7.82838C6.03725 6.82174 6.87623 6.00569 7.91116 6.00569H9.49563V4.16032H8.7727C8.58289 4.59611 8.13909 4.90183 7.62187 4.90183H5.12332C4.6061 4.90183 4.1623 4.59611 3.97249 4.16032ZM5.12332 2.89403H7.62187C7.79436 2.89403 7.93419 3.03003 7.93419 3.19781V3.68671C7.93419 3.85448 7.79436 3.99049 7.62187 3.99049H5.12332C4.95083 3.99049 4.811 3.85448 4.811 3.68671V3.19781C4.811 3.03003 4.95083 2.89403 5.12332 2.89403ZM7.91116 7.11157C7.56618 7.11157 7.28652 7.38359 7.28652 7.71913V12.7851C7.28652 13.1206 7.56618 13.3927 7.91116 13.3927H10.7442C10.8401 13.3927 10.9337 13.3712 11.0182 13.3311C11.1373 13.2746 11.1859 13.1423 11.1859 13.0134V12.0066C11.1859 11.8724 11.2978 11.7636 11.4358 11.7636H12.4709C12.6034 11.7636 12.7394 11.7163 12.7975 11.6004C12.8388 11.5182 12.8608 11.4272 12.8608 11.334V7.71913C12.8608 7.38359 12.5811 7.11157 12.2362 7.11157H7.91116Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    }
  ]
};
var Rn = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "paste-special-double-icon",
    ref: n,
    icon: e5
  }));
});
Rn.displayName = "PasteSpecialDoubleIcon";
var t5 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M2.53331 14C2.35652 14 2.18697 13.9297 2.06197 13.8047C1.93697 13.6797 1.86675 13.5101 1.86675 13.3333C1.86675 13.1565 1.93697 12.987 2.06197 12.862C2.18697 12.7369 2.35652 12.6667 2.53331 12.6667L13.4666 12.6667C13.6434 12.6667 13.813 12.7369 13.938 12.862C14.063 12.987 14.1332 13.1565 14.1332 13.3333C14.1332 13.5101 14.063 13.6797 13.938 13.8047C13.813 13.9297 13.6434 14 13.4666 14L2.53331 14ZM2.53331 3.33333C2.35652 3.33331 2.18697 3.26306 2.06197 3.13804C1.93697 3.01301 1.86675 2.84346 1.86675 2.66667C1.86675 2.48987 1.93697 2.32032 2.06197 2.1953C2.18697 2.07028 2.35652 2.00003 2.53331 2L13.4666 2C13.6434 2.00003 13.813 2.07028 13.938 2.1953C14.063 2.32032 14.1332 2.48987 14.1332 2.66667C14.1332 2.84346 14.063 3.01301 13.938 3.13803C13.813 3.26306 13.6434 3.33331 13.4666 3.33333L2.53331 3.33333Z"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "colorChannel1",
      d: "M10.8142 10.8141C10.5588 11.0695 10.1447 11.0695 9.88929 10.8141L7.97868 8.90354L6.14021 10.742C5.89652 10.9857 5.50142 10.9857 5.25774 10.742C5.01405 10.4983 5.01405 10.1032 5.25774 9.85955L7.09621 8.02107L5.18561 6.11047C4.93021 5.85507 4.93021 5.44098 5.18561 5.18557C5.44101 4.93017 5.8551 4.93017 6.11051 5.18557L8.02111 7.09618L9.85959 5.2577C10.1033 5.01401 10.4984 5.01401 10.7421 5.2577C10.9857 5.50139 10.9857 5.89648 10.7421 6.14017L8.90358 7.97865L10.8142 9.88925C11.0696 10.1447 11.0696 10.5587 10.8142 10.8141Z"
    }
  }]
};
var Vn = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "reduce-double-icon",
    ref: n,
    icon: t5
  }));
});
Vn.displayName = "ReduceDoubleIcon";
var n5 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M1.33325 3.99992L1.33325 2.66659C1.33325 1.93021 1.93021 1.33325 2.66659 1.33325L3.99992 1.33325L3.99992 2.66659L2.66659 2.66659L2.66659 3.99992L1.33325 3.99992Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M9.33325 1.33325L9.33325 2.66658L6.66659 2.66659L6.66659 1.33325L9.33325 1.33325Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M1.33325 6.66659L2.66659 6.66659L2.66659 7.33325L5.33325 7.33325L5.33325 8.66659L2.66659 8.66659L2.66659 9.33325L1.33325 9.33325L1.33325 6.66659Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M1.33325 11.9999L2.66659 11.9999L2.66659 13.3333L3.99992 13.3333L3.99992 14.6666L2.66659 14.6666C1.93021 14.6666 1.33325 14.0696 1.33325 13.3333L1.33325 11.9999Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M6.66659 14.6666L6.66659 13.3333L7.33325 13.3333L7.33325 10.6666L8.66659 10.6666L8.66659 13.3333L9.33325 13.3333L9.33325 14.6666L6.66659 14.6666Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M13.3333 7.33325L10.6666 7.33325L10.6666 8.66659L13.3333 8.66658L13.3333 7.33325Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M7.33325 5.33325L7.33325 2.66659L8.66659 2.66659L8.66659 5.33325L7.33325 5.33325Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M13.3333 1.33325L12 1.33325L12 2.66659L13.3333 2.66659L13.3333 13.3333L12 13.3333L12 14.6666L13.3333 14.6666C14.0697 14.6666 14.6667 14.0696 14.6667 13.3333L14.6667 2.66659C14.6667 1.93021 14.0697 1.33325 13.3333 1.33325Z"
      }
    }
  ]
};
var On = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "right-border-double-icon",
    ref: n,
    icon: n5
  }));
});
On.displayName = "RightBorderDoubleIcon";
var r5 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 17 17",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M13.2368 2.87507L2.11162 7.97208L2.61144 9.06304L12.4714 4.54568L7.95409 14.4057L9.04505 14.9055L14.1421 3.78029L14.4503 3.63905L14.3286 3.37322L14.469 3.0666L14.1134 2.90369L13.9505 2.5481L13.6439 2.68857L13.3781 2.56678L13.2368 2.87507Z"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "colorChannel1",
      d: "M4.44524 1.82495L3.08111 1.82495C2.41837 1.82495 1.88111 2.36221 1.88111 3.02495L1.88111 4.38908L3.21111 4.38908L3.21111 3.15495L4.44524 3.15495L4.44524 1.82495ZM15.1941 4.38908L15.1941 3.02495C15.1941 2.36221 14.6569 1.82495 13.9941 1.82495L12.63 1.82495L12.63 3.15495L13.8641 3.15495L13.8641 4.38908L15.1941 4.38908ZM7.17349 1.82495L7.17349 3.15495L9.90175 3.15495L9.90175 1.82495L7.17349 1.82495ZM15.1941 7.11734L13.8641 7.11734L13.8641 9.84559L15.1941 9.84559L15.1941 7.11734ZM15.1941 12.5739L13.8641 12.5739L13.8641 13.808L12.63 13.808L12.63 15.138L13.9941 15.138C14.6569 15.138 15.1941 14.6007 15.1941 13.938L15.1941 12.5739ZM9.90175 15.138L9.90175 13.808L7.17349 13.808L7.17349 15.138L9.90175 15.138ZM4.44524 15.138L4.44524 13.808L3.21111 13.808L3.21111 12.5739L1.88111 12.5739L1.88111 13.938C1.88111 14.6007 2.41837 15.138 3.08111 15.138L4.44524 15.138ZM1.88111 9.8456L3.21111 9.8456L3.21111 7.11734L1.88111 7.11734L1.88111 9.8456Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var $n = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "right-double-diagonal-double-icon",
    ref: n,
    icon: r5
  }));
});
$n.displayName = "RightDoubleDiagonalDoubleIcon";
var o5 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M2.56781 13.3332C2.56781 14.0695 3.16476 14.6665 3.90114 14.6665L6.56781 14.6665C7.30419 14.6665 7.90114 14.0695 7.90114 13.3332L7.90114 2.6665C7.90114 1.9301 7.30419 1.33317 6.56781 1.33317L3.90114 1.33317C3.16476 1.33317 2.56781 1.9301 2.56781 2.6665L2.56781 13.3332ZM3.90114 2.6665L3.90114 13.3332L6.56781 13.3332L6.56781 2.6665L3.90114 2.6665Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "colorChannel1",
      d: "M13.4323 8.00022C13.4323 8.36841 13.1338 8.66689 12.7656 8.66689L11.6906 8.66689L11.6906 9.74202C11.6906 10.1102 11.3921 10.4087 11.0239 10.4087C10.6557 10.4087 10.3573 10.1102 10.3573 9.74202L10.3573 8.66689L9.28215 8.66689C8.91396 8.66689 8.61548 8.36841 8.61548 8.00022C8.61548 7.63203 8.91396 7.33356 9.28214 7.33356L10.3573 7.33356L10.3573 6.25852C10.3573 5.89033 10.6557 5.59186 11.0239 5.59186C11.3921 5.59186 11.6906 5.89033 11.6906 6.25852L11.6906 7.33356L12.7656 7.33356C13.1338 7.33356 13.4323 7.63203 13.4323 8.00022Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var En2 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "right-insert-column-double-icon",
    ref: n,
    icon: o5
  }));
});
En2.displayName = "RightInsertColumnDoubleIcon";
var i5 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 17 17",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M2.27177 13.714L13.5855 2.40025L14.434 3.24878L3.1203 14.5625L2.27177 13.714Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "colorChannel1",
      d: "M4.2603 1.82495L2.89617 1.82495C2.23343 1.82495 1.69617 2.36221 1.69617 3.02495L1.69617 4.38908L3.02617 4.38908L3.02617 3.15495L4.2603 3.15495L4.2603 1.82495ZM15.0092 4.38908L15.0092 3.02495C15.0092 2.36221 14.4719 1.82495 13.8092 1.82495L12.4451 1.82495L12.4451 3.15495L13.6792 3.15495L13.6792 4.38908L15.0092 4.38908ZM6.98856 1.82495L6.98856 3.15495L9.71681 3.15495L9.71681 1.82495L6.98856 1.82495ZM15.0092 7.11734L13.6792 7.11734L13.6792 9.84559L15.0092 9.84559L15.0092 7.11734ZM15.0092 12.5739L13.6792 12.5739L13.6792 13.808L12.4451 13.808L12.4451 15.138L13.8092 15.138C14.4719 15.138 15.0092 14.6007 15.0092 13.938L15.0092 12.5739ZM9.71681 15.138L9.71681 13.808L6.98856 13.808L6.98856 15.138L9.71681 15.138ZM4.2603 15.138L4.2603 13.808L3.02617 13.808L3.02617 12.5739L1.69617 12.5739L1.69617 13.938C1.69617 14.6007 2.23343 15.138 2.89617 15.138L4.2603 15.138ZM1.69617 9.8456L3.02617 9.8456L3.02617 7.11734L1.69617 7.11734L1.69617 9.8456Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var Nn = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "slash-double-icon",
    ref: n,
    icon: i5
  }));
});
Nn.displayName = "SlashDoubleIcon";
var l5 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M4.0001 14.667H2.66677C1.93039 14.667 1.33344 14.07 1.33344 13.3337V12.0003H2.66677V13.3337L4.0001 13.3337V14.667Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M1.33344 6.66699H2.66677V9.33366H1.33344V6.66699Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M6.66677 14.667V13.3337H7.33344V10.667H8.66677V13.3337H9.33344V14.667H6.66677Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M12.0001 14.667V13.3337H13.3334V12.0003H14.6668V13.3337C14.6668 14.07 14.0698 14.667 13.3334 14.667H12.0001Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M14.6668 9.33366H13.3334V8.66699H10.6668V7.33366H13.3334V6.66699H14.6668V9.33366Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M7.33344 2.66699V5.33366H8.66677V2.66699H7.33344Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M5.33344 8.66699H2.66677V7.33366H5.33344V8.66699Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M1.33344 2.66789V4.00122H2.66677L2.66677 2.66789H13.3334V4.00122H14.6668V2.66789C14.6668 1.93151 14.0698 1.33455 13.3334 1.33455H2.66677C1.93039 1.33455 1.33344 1.93151 1.33344 2.66789Z"
      }
    }
  ]
};
var Dn = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "up-border-double-icon",
    ref: n,
    icon: l5
  }));
});
Dn.displayName = "UpBorderDoubleIcon";
var s5 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M2.66699 1.33325L4.00033 1.33325L4.00033 2.66658L2.66699 2.66659L2.66699 3.99992L1.33366 3.99992L1.33366 2.66659C1.33366 1.93021 1.93061 1.33325 2.66699 1.33325Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M14.667 2.66659L14.667 3.99992L13.3337 3.99992L13.3337 2.66659L12.0003 2.66659L12.0003 1.33325L13.3337 1.33325C14.07 1.33325 14.667 1.93021 14.667 2.66659Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M6.66699 2.66658L6.66699 1.33325L9.33366 1.33325L9.33366 2.66659L6.66699 2.66658Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M13.3337 6.66659L14.667 6.66659L14.667 9.33325L13.3337 9.33325L13.3337 8.66496L12.0145 8.66496L12.0145 7.33496L13.3337 7.33496L13.3337 6.66659Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M13.3337 11.9999L14.667 11.9999L14.667 13.3333C14.667 14.0696 14.07 14.6666 13.3337 14.6666L12.0003 14.6666L12.0003 13.3333L13.3337 13.3333L13.3337 11.9999Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M9.33366 13.3333L9.33366 14.6666L6.66699 14.6666L6.66699 13.3333L9.33366 13.3333Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M4.00032 13.3333L4.00032 14.6666L2.66699 14.6666C1.93061 14.6666 1.33366 14.0696 1.33366 13.3333L1.33366 11.9999L2.66699 11.9999L2.66699 13.3333L4.00032 13.3333Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M2.66699 9.33325L1.33366 9.33325L1.33366 6.66658L2.66699 6.66658L2.66699 7.33496L3.98624 7.33496L3.98624 8.66496L2.66699 8.66496L2.66699 9.33325Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M9.33841 7.33496L6.66232 7.33496L6.66232 8.66496L9.33841 8.66496L9.33841 7.33496Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M8.66577 8.66675L8.66577 7.33342L8.66569 2.66675L7.33236 2.66675L7.33236 7.33341L7.33244 8.66675L7.33236 13.3334L8.66569 13.3334L8.66577 8.66675Z"
      }
    }
  ]
};
var Tn3 = (0, import_react2.forwardRef)(function(t8, n) {
  return (0, import_react2.createElement)(H, Object.assign({}, t8, {
    id: "vertical-border-double-icon",
    ref: n,
    icon: s5
  }));
});
Tn3.displayName = "VerticalBorderDoubleIcon";
var xe = {
  AddDigitsIcon: D9,
  AddImageIcon: T9,
  AdditionAndSubtractionIcon: Z9,
  AdjustHeightDoubleIcon: J6,
  AdjustWidthDoubleIcon: Q6,
  AlignBottomIcon: A9,
  AlignTextBothIcon: B9,
  AlignTopIcon: P9,
  AllBorderIcon: F9,
  AmplifyIcon: k9,
  AutoHeightDoubleIcon: K6,
  AutoWidthDoubleIcon: en2,
  AutowrapIcon: j9,
  AvgIcon: U9,
  BackSlashDoubleIcon: tn2,
  BoldIcon: z9,
  BrushIcon: W9,
  CancelFreezeIcon: Y9,
  CancelMergeIcon: G9,
  ClearFormatDoubleIcon: nn,
  CntIcon: X9,
  CodeIcon: q9,
  ConditionsDoubleIcon: rn2,
  CopyDoubleIcon: on2,
  DeleteCellMoveDownDoubleIcon: ln2,
  DeleteCellShiftLeftDoubleIcon: sn,
  DeleteCellShiftRightDoubleIcon: an2,
  DeleteCellShiftUpDoubleIcon: cn,
  DeleteColumnDoubleIcon: un3,
  DeleteRowDoubleIcon: dn,
  DirectExportIcon: Q9,
  DollarIcon: K9,
  DownBorderDoubleIcon: hn2,
  EuroIcon: e6,
  ExportIcon: t6,
  EyeOutlineIcon: r6,
  FolderIcon: o6,
  FontColorDoubleIcon: fn3,
  FontSizeIncreaseIcon: i6,
  FontSizeReduceIcon: l6,
  FreezeColumnIcon: s6,
  FreezeRowIcon: a6,
  FreezeToSelectedIcon: c6,
  FunctionIcon: J3,
  GridIcon: u6,
  HeaderFooterIcon: d6,
  HideDoubleIcon: Cn,
  HorizontalBorderDoubleIcon: vn,
  HorizontallyIcon: C6,
  HorizontalMergeIcon: f6,
  InnerBorderDoubleIcon: gn,
  InsertCellDownDoubleIcon: pn3,
  InsertCellShiftRightDoubleIcon: mn2,
  InsertDoubleIcon: bn,
  InsertRowAboveDoubleIcon: Ln2,
  InsertRowBelowDoubleIcon: wn,
  ItalicIcon: p6,
  KeyboardIcon: m6,
  LeftBorderDoubleIcon: _n2,
  LeftDoubleDiagonalDoubleIcon: yn,
  LeftInsertColumnDoubleIcon: Mn,
  LeftJustifyingIcon: b6,
  LeftRotationFortyFiveDegreesIcon: L6,
  LeftRotationNinetyDegreesIcon: w6,
  LeftTridiagonalDoubleIcon: In2,
  MaxIcon: _6,
  MenuIcon: y6,
  MergeAllIcon: M6,
  MinIcon: I6,
  MoreDownIcon: me2,
  NoBorderIcon: H6,
  NoColorDoubleIcon: Hn,
  NoRotationIcon: x6,
  OrderIcon: S6,
  OuterBorderDoubleIcon: xn2,
  OverflowIcon: R6,
  PaintBucketDoubleIcon: Sn2,
  PasteSpecialDoubleIcon: Rn,
  PercentIcon: V6,
  PipingIcon: O6,
  RedoIcon: $6,
  ReduceDigitsIcon: E6,
  ReduceDoubleIcon: Vn,
  ReduceIcon: K3,
  RightBorderDoubleIcon: On,
  RightDoubleDiagonalDoubleIcon: $n,
  RightInsertColumnDoubleIcon: En2,
  RightJustifyingIcon: N6,
  RightRotationFortyFiveDegreesIcon: D6,
  RightRotationNinetyDegreesIcon: T6,
  RmbIcon: Z6,
  RoubleIcon: A6,
  ShortcutIcon: B6,
  SlashDoubleIcon: Nn,
  StrikethroughIcon: P6,
  SubscriptIcon: F6,
  SumIcon: k6,
  SuperscriptIcon: j6,
  TruncationIcon: U6,
  UnderlineIcon: z6,
  UndoIcon: W6,
  UnorderIcon: Y6,
  UpBorderDoubleIcon: Dn,
  VerticalBorderDoubleIcon: Tn3,
  VerticalCenterIcon: G62,
  VerticalIntegrationIcon: X6,
  VerticalTextIcon: q6
};
var S1 = class extends Ve {
  constructor() {
    super();
    F(this, "_components", /* @__PURE__ */ new Map());
    F(this, "_componentsReverse", /* @__PURE__ */ new Map());
    F(this, "reactUtils", {
      createElement: import_react2.createElement,
      useEffect: import_react2.useEffect,
      useRef: import_react2.useRef
    });
    F(this, "_handler", {
      react: (n) => n
    });
    for (const n in xe)
      this.register(n, xe[n]);
    this.disposeWithMe(We(() => {
      for (const n in xe)
        this._components.delete(n), this._componentsReverse.delete(xe[n]);
    }));
  }
  register(n, r, o) {
    const { framework: l = "react" } = o || {};
    if (l === "vue3" && !this._handler.vue3)
      throw new Error("[ComponentManager] Vue3 support is no longer built-in since v0.9.0, please install @univerjs/ui-adapter-vue3 plugin.");
    return this._components.has(n) && console.warn(`Component ${n} already exists.`), this._components.set(n, {
      framework: l,
      component: r
    }), this._componentsReverse.set(r, n), We(() => {
      this._components.delete(n), this._componentsReverse.delete(r);
    });
  }
  getKey(n) {
    return this._componentsReverse.get(n);
  }
  setHandler(n, r) {
    this._handler[n] = r;
  }
  get(n) {
    if (!n) return;
    const r = this._components.get(n);
    if (!r) return;
    const o = this._handler[r.framework];
    if (!o)
      throw new Error(`[ComponentManager] No handler found for framework: ${r.framework}`);
    return o(r.component, n);
  }
  delete(n) {
    this._components.delete(n);
  }
};
var j3;
var U3;
var Pe2 = class {
  constructor() {
    F(this, "_list", /* @__PURE__ */ new Map());
  }
  setIndex(t8, n) {
    this._list.set(t8, n);
  }
  getIndex(t8) {
    return this._list.get(t8);
  }
  removeIndex(t8) {
    this._list.delete(t8);
  }
  getMaxIndex() {
    let t8 = -9999999;
    return this._list.forEach((n) => {
      +n > t8 && (t8 = +n);
    }), t8;
  }
};
j3 = /* @__PURE__ */ new WeakMap(), U3 = /* @__PURE__ */ new WeakMap(), L3(Pe2, j3, 2147483647), L3(Pe2, U3, -2147483647);
function Bi(e, t8, n, r) {
  const o = e.get(vr);
  return new Observable((l) => {
    const i = o.focused$.subscribe((v2) => {
      if (v2 == null || n && n !== v2 || r && (Array.isArray(r) ? r.includes(v2) : r === v2))
        return l.next(true);
      const g = o.getUnitType(v2);
      l.next(g !== t8);
    }), u = o.getFocusedUnit();
    if (u == null)
      return l.next(true);
    const d = o.getUnitType(u.getUnitId());
    return l.next(d !== t8), () => i.unsubscribe();
  });
}
function Pi(e) {
  const t8 = e.get(vr);
  return new Observable((n) => {
    const r = t8.focused$.subscribe((i) => {
      if (i == null)
        return n.next(true);
      const u = t8.getUniverDocInstance(i), d = u == null ? void 0 : u.getSnapshot().documentStyle.documentFlavor;
      n.next(d !== uu.TRADITIONAL);
    }), o = t8.getCurrentUniverDocInstance();
    if (o == null)
      return n.next(true);
    const l = o == null ? void 0 : o.getSnapshot().documentStyle.documentFlavor;
    return n.next(l !== uu.TRADITIONAL), () => r.unsubscribe();
  });
}
function a5(e, t8) {
  return !t8 || !e || (["type", "icon", "title", "tooltip"].forEach((o) => {
    t8[o] !== void 0 && (e[o] = t8[o]);
  }), ["hidden", "disabled", "activated"].forEach((o) => {
    c5(e, `${o}$`, t8[o]);
  })), e;
}
function c5(e, t8, n) {
  if (n !== void 0)
    if (e[t8]) {
      const r = e[t8].pipe(
        switchMap(() => new BehaviorSubject(n))
      );
      e[t8] = r;
    } else
      e[t8] = new Observable((r) => {
        r.next(n);
      });
}
function u5(e) {
  return typeof e == "function" ? e() : e;
}
function d5(e, t8) {
  const n = (0, import_react2.useRef)(t8);
  return (0, import_react2.useEffect)(() => {
    if (e) {
      const r = u5(e).subscribe((o) => {
        n.current = o;
      });
      return () => r.unsubscribe();
    }
  }, [e]), n;
}
var h5 = (e) => {
  const { value: t8, selections: n } = e, r = useDependency(Fn), o = (0, import_react2.useMemo)(() => {
    var l, i;
    return t8 == null ? "" : r.t((i = (l = n.find((u) => u.value === t8)) == null ? void 0 : l.label) != null ? i : "");
  }, [t8, n]);
  return (0, import_jsx_runtime2.jsx)(
    "div",
    {
      className: "univer-truncate univer-text-sm",
      children: o
    }
  );
};
var f5 = "UI_PLUGIN_COMMON_LABEL_COMPONENT";
function _12(e) {
  const { className: t8, title: n, icon: r, label: o, value: l, value$: i } = e, u = useDependency(Fn), d = useDependency(S1), [v2, g] = (0, import_react2.useState)(l), [c, m2] = (0, import_react2.useState)(""), L = [];
  let y = 0;
  (0, import_react2.useEffect)(() => {
    if (i) {
      const _3 = i.subscribe(($) => {
        g($);
      });
      return () => {
        _3.unsubscribe();
      };
    }
  }, [i]);
  const O2 = (0, import_react2.useMemo)(() => l != null ? l : v2, [v2, l]);
  (0, import_react2.useEffect)(() => {
    let _3 = null;
    return isObservable(r) ? _3 = r.subscribe(($) => {
      m2($);
    }) : m2(r != null ? r : ""), () => {
      _3 == null || _3.unsubscribe();
    };
  }, [r]);
  const S = (0, import_react2.useMemo)(() => O2 && typeof O2 == "string" ? new bt(O2).isValid : false, [O2]);
  if (r) {
    const _3 = d.get(c != null ? c : "");
    _3 && L.push(
      (0, import_jsx_runtime2.jsx)(
        _3,
        {
          className: "univer-text-base",
          extend: { colorChannel1: S ? O2 : "var(--univer-primary-600)" }
        },
        y++
      )
    );
  }
  if (o) {
    const _3 = typeof o == "string", $ = _3 ? { ...e } : { ...o == null ? void 0 : o.props, ...e }, R = _3 ? o : o == null ? void 0 : o.name, B = d.get(R);
    B ? L.push(
      (0, import_jsx_runtime2.jsx)(
        B,
        {
          ...$,
          className: t8,
          value: O2
        },
        y++
      )
    ) : L.push(
      (0, import_jsx_runtime2.jsx)(
        "span",
        {
          className: t8,
          children: u.t(R)
        },
        y++
      )
    );
  }
  return n && L.push(
    (0, import_jsx_runtime2.jsx)("span", { className: t8, children: typeof n == "string" ? u.t(n) : n }, y++)
  ), (0, import_jsx_runtime2.jsx)(import_jsx_runtime2.Fragment, { children: L });
}
var C5 = (e) => {
  var l, i;
  const { value: t8, text: n } = e, r = cR[t8], o = useDependency(Fn);
  return (0, import_jsx_runtime2.jsx)(
    "span",
    {
      className: ie2("univer-text-sm", {
        "univer-font-bold": r == null ? void 0 : r.bl
      }),
      style: {
        fontSize: r == null ? void 0 : r.fs,
        color: (i = (l = r == null ? void 0 : r.cl) == null ? void 0 : l.rgb) != null ? i : void 0
      },
      children: o.t(n)
    }
  );
};
var v5 = "UI_COMPONENT_HEADING_ITEM";
function re(e) {
  const t8 = (0, import_react2.useRef)(e);
  return t8.current = e, (0, import_react2.useCallback)(
    (...n) => {
      var r;
      return (r = t8.current) == null ? void 0 : r.call(t8, ...n);
    },
    []
  );
}
function g5(e, t8) {
  const n = re(() => {
    if (!e || !t8)
      return;
    const r = e.style, o = e.getBoundingClientRect(), { y: l, height: i } = o, u = t8.getBoundingClientRect(), d = e.scrollHeight > i, v2 = l < 0 || l + i > u.height;
    if (!v2 && !d) {
      r.overflowY = "", r.maxHeight = "";
      return;
    }
    v2 && (r.overflowY = "auto", r.maxHeight = l < 0 ? `${e.scrollHeight + l}px` : `${u.height - l}px`);
  });
  (0, import_react2.useEffect)(() => {
    if (!Ts() || !e || !t8) return;
    n();
    const r = KE(n);
    return r.observe(e), () => {
      r.unobserve(e);
    };
  }, [e, t8]);
}
function p5(e) {
  const t8 = useDependency(ic);
  return useObservable(
    (0, import_react2.useMemo)(() => t8.subscribeConfigValue$(e), [t8]),
    t8.getConfig(e)
  );
}
var Se = 116;
function Fi(e) {
  useDependency(Fn);
  const { value: t8, min: n = 0, max: r = 400, disabled: o = false, resetPoint: l = 100, shortcuts: i, onChange: u } = e, d = (0, import_react2.useRef)(null), [v2, g] = (0, import_react2.useState)(false);
  function c() {
    o || u && u(l);
  }
  function m2(_3) {
    if (o) return;
    let $ = t8 + _3;
    t8 + _3 <= n ? $ = n : t8 + _3 >= r && ($ = r), u && u($);
  }
  const L = (0, import_react2.useMemo)(() => {
    if (t8 <= l) {
      const _3 = 50 / (l - n);
      return (t8 - n) * _3;
    }
    if (t8 <= r)
      return l * 0.5 + (t8 - l) / (r - l) * 50;
  }, [n, r, l, t8]);
  function y(_3) {
    if (o) return;
    _3.preventDefault();
    const $ = d.current;
    let R = true;
    function B(T) {
      if (R) {
        let A = T.clientX - $.getBoundingClientRect().x;
        A <= 0 ? A = 0 : A >= Se && (A = Se);
        const U2 = A / Se;
        let Y2 = 0;
        U2 <= 0.5 ? Y2 = n + U2 * (l - n) * 2 : Y2 = l + (U2 - 0.5) * (r - l) * 2, u && u(Math.ceil(Y2));
      }
    }
    function w() {
      R = false, document.removeEventListener("pointermove", B), window.removeEventListener("pointerup", w);
    }
    function E(T) {
      T.relatedTarget === null && w();
    }
    window.addEventListener("pointermove", B), window.addEventListener("pointerup", w), window.addEventListener("pointerout", E);
  }
  function O2(_3) {
    o || (g(false), u && u(_3));
  }
  const S = [{
    type: "radio",
    value: t8.toString(),
    options: i.map((_3) => ({ value: _3.toString(), label: `${_3}%` })),
    onSelect: (_3) => O2(+_3)
  }];
  return (0, import_jsx_runtime2.jsxs)(
    "div",
    {
      className: ie2("univer-flex univer-select-none univer-items-center univer-gap-1", {
        "univer-cursor-not-allowed": o
      }),
      children: [
        (0, import_jsx_runtime2.jsx)(
          vr2,
          {
            className: "univer-size-6 univer-p-0",
            size: "small",
            variant: "text",
            disabled: t8 <= n || o,
            onClick: () => m2(-10),
            children: (0, import_jsx_runtime2.jsx)(K3, {})
          }
        ),
        (0, import_jsx_runtime2.jsx)(
          "div",
          {
            className: "univer-relative univer-hidden univer-h-0.5 univer-rounded-2xl univer-bg-gray-400 univer-px-1.5 sm:!univer-block",
            style: {
              width: `${Se}px`
            },
            children: (0, import_jsx_runtime2.jsxs)("div", { ref: d, role: "track", className: "univer-relative univer-h-0.5", children: [
              (0, import_jsx_runtime2.jsx)(
                "a",
                {
                  className: "univer-absolute univer-left-1/2 univer-top-1/2 univer-box-border univer-block univer-h-0.5 univer-w-0.5 -univer-translate-x-1/2 -univer-translate-y-1/2 univer-cursor-pointer univer-rounded-full univer-bg-white",
                  role: "button",
                  onClick: c
                },
                "reset-button"
              ),
              (0, import_jsx_runtime2.jsx)(
                "button",
                {
                  className: ie2("univer-absolute univer-top-[calc(50%-6px)] univer-size-3 -univer-translate-x-1/2 univer-rounded-full univer-border-none univer-bg-white univer-shadow univer-transition-colors", {
                    "hover:univer-gray-200 univer-cursor-pointer": !o,
                    "univer-cursor-not-allowed": o
                  }),
                  role: "handle",
                  type: "button",
                  style: {
                    left: `${L}%`
                  },
                  onPointerDown: y
                }
              )
            ] })
          }
        ),
        (0, import_jsx_runtime2.jsx)(
          vr2,
          {
            className: "univer-size-6 univer-p-0",
            size: "small",
            variant: "text",
            disabled: t8 >= r || o,
            onClick: () => m2(10),
            children: (0, import_jsx_runtime2.jsx)(v6, {})
          }
        ),
        (0, import_jsx_runtime2.jsx)(
          ep,
          {
            align: "end",
            items: S,
            open: v2,
            onOpenChange: g,
            children: (0, import_jsx_runtime2.jsxs)(
              vr2,
              {
                size: "small",
                variant: "text",
                children: [
                  t8,
                  "%"
                ]
              }
            )
          }
        )
      ]
    }
  );
}
var m5 = "UI_COLOR_PICKER_COMPONENT";
var b5 = (e) => {
  const { value: t8 } = e, n = useDependency(Fn), r = (0, import_react2.useMemo)(() => {
    if (t8 == null) return "";
    let o = n.t(`fontFamily.${`${t8 != null ? t8 : ""}`.replace(/\s/g, "")}`);
    return o.startsWith("fontFamily.") && typeof t8 == "string" && (o = t8.split(",")[0]), o;
  }, [t8]);
  return (0, import_jsx_runtime2.jsx)(
    "div",
    {
      className: "univer-w-32 univer-truncate univer-text-sm",
      style: { fontFamily: t8 },
      children: r
    }
  );
};
var L5 = (e) => {
  const { value: t8 } = e, n = useDependency(Fn);
  return (0, import_jsx_runtime2.jsx)("span", { className: "univer-text-sm", style: { fontFamily: t8 }, children: n.t(`fontFamily.${`${t8 != null ? t8 : ""}`.replace(/\s/g, "")}`) });
};
var w5 = "UI_FONT_FAMILY_COMPONENT";
var _5 = "UI_FONT_FAMILY_ITEM_COMPONENT";
var ki = [
  {
    value: "Arial"
  },
  {
    value: "Times New Roman"
  },
  {
    value: "Tahoma"
  },
  {
    value: "Verdana"
  },
  {
    value: "Microsoft YaHei"
  },
  {
    value: "SimSun"
  },
  {
    value: "SimHei"
  },
  {
    value: "Kaiti"
  },
  {
    value: "FangSong"
  },
  {
    value: "NSimSun"
  },
  {
    value: "STXinwei"
  },
  {
    value: "STXingkai"
  },
  {
    value: "STLiti"
  }
  // The following 3 fonts do not work, temporarily delete
  // {
  //     label: 'fontFamily.HanaleiFill',
  //     style: { 'font-family': 'HanaleiFill' },
  //     value: 'HanaleiFill',
  // },
  // {
  //     label: 'fontFamily.Anton',
  //     style: { 'font-family': 'Anton' },
  //     value: 'Anton',
  // },
  // {
  //     label: 'fontFamily.Pacifico',
  //     style: { 'font-family': 'Pacifico' },
  //     value: 'Pacifico',
  // },
];
var y5 = (e) => {
  const { value: t8, min: n, max: r, onChange: o, disabled$: l } = e, i = useObservable(l), [u, d] = (0, import_react2.useState)(Number(t8 != null ? t8 : 0)), v2 = (0, import_react2.useMemo)(() => Number(t8 != null ? t8 : u), [t8]);
  function g(m2) {
    m2 !== null && d(m2);
  }
  function c(m2) {
    m2.stopPropagation(), m2.code === "Enter" && o(u.toString());
  }
  return (0, import_jsx_runtime2.jsx)("div", { className: "univer-h-6 univer-w-7 univer-text-sm", children: (0, import_jsx_runtime2.jsx)(
    xE2,
    {
      className: "univer-block univer-h-6 univer-border-none univer-bg-transparent univer-leading-6 [&_input:focus]:!univer-ring-0 [&_input]:univer-h-6 [&_input]:univer-w-7 [&_input]:univer-border-none [&_input]:!univer-bg-transparent [&_input]:univer-p-0 [&_input]:univer-text-sm",
      value: v2,
      controls: false,
      min: n,
      max: r,
      onKeyDown: c,
      onChange: g,
      disabled: i
    }
  ) });
};
var ji = [
  {
    label: "9",
    value: 9
  },
  {
    label: "10",
    value: 10
  },
  {
    label: "11",
    value: 11
  },
  {
    label: "12",
    value: 12
  },
  {
    label: "14",
    value: 14
  },
  {
    label: "16",
    value: 16
  },
  {
    label: "18",
    value: 18
  },
  {
    label: "20",
    value: 20
  },
  {
    label: "22",
    value: 22
  },
  {
    label: "24",
    value: 24
  },
  {
    label: "26",
    value: 26
  },
  {
    label: "28",
    value: 28
  },
  {
    label: "36",
    value: 36
  },
  {
    label: "48",
    value: 48
  },
  {
    label: "72",
    value: 72
  }
];
var Ui = [
  {
    label: "toolbar.heading.normal",
    value: qe.NORMAL_TEXT
  },
  {
    label: "toolbar.heading.title",
    value: qe.TITLE
  },
  {
    label: "toolbar.heading.subTitle",
    value: qe.SUBTITLE
  },
  {
    label: "toolbar.heading.1",
    value: qe.HEADING_1
  },
  {
    label: "toolbar.heading.2",
    value: qe.HEADING_2
  },
  {
    label: "toolbar.heading.3",
    value: qe.HEADING_3
  },
  {
    label: "toolbar.heading.4",
    value: qe.HEADING_4
  },
  {
    label: "toolbar.heading.5",
    value: qe.HEADING_5
  }
];
var M5 = "UI_FONT_SIZE_COMPONENT";
var zi = (e, t8) => {
  const n = (0, import_react2.useRef)(false);
  (0, import_react2.useEffect)(() => {
    if (n.current)
      return e();
    n.current = true;
  }, t8);
};
function Wi(e, t8) {
  const n = re(t8.handler);
  (0, import_react2.useEffect)(() => {
    const r = (o) => {
      e.current && o.target && !e.current.contains(o.target) && n();
    };
    return document.addEventListener("mousedown", r), () => {
      document.removeEventListener("mousedown", r);
    };
  }, [n, e]);
}
function Yi(e, t8 = 300) {
  const n = (0, import_react2.useRef)(null);
  return (0, import_react2.useCallback)((...r) => {
    n.current && clearTimeout(n.current), n.current = setTimeout(() => {
      e(...r);
    }, t8);
  }, [e, t8]);
}
var At = (e) => typeof e == "number";
function I5(e) {
  const t8 = (0, import_react2.useRef)(e);
  return t8.current = e, t8;
}
var Gi2 = (e, t8) => {
  const { containerTarget: n, itemHeight: r, overscan: o = 5 } = t8, l = I5(r), [i, u] = (0, import_react2.useState)(null), d = (0, import_react2.useRef)(false), [v2, g] = (0, import_react2.useState)([]), [c, m2] = (0, import_react2.useState)({ height: void 0, marginTop: void 0 }), L = (R, B) => {
    if (typeof l.current == "number")
      return Math.ceil(R / l.current);
    let w = 0, E = 0;
    for (let T = B; T < e.length; T++) {
      const W = l.current(T, e[T]);
      if (w += W, E = T, w >= R)
        break;
    }
    return E - B;
  }, y = (R) => {
    if (At(l.current))
      return Math.floor(R / l.current);
    let B = 0, w = 0;
    for (let E = 0; E < e.length; E++) {
      const T = l.current(E, e[E]);
      if (B += T, B >= R) {
        w = E;
        break;
      }
    }
    return w + 1;
  }, O2 = (R) => typeof l.current == "number" ? R * l.current : e.slice(0, R).reduce((w, E, T) => w + l.current(T, e[T]), 0), S = (0, import_react2.useMemo)(() => At(l.current) ? e.length * l.current : e.reduce(
    (R, B, w) => R + l.current(w, e[w]),
    0
  ), [e]), _3 = () => {
    const R = n.current;
    if (R) {
      const { scrollTop: B, clientHeight: w } = R, E = y(B), T = L(w, E), W = Math.max(0, E - o), A = Math.min(e.length, E + T + o), U2 = O2(W);
      m2({
        height: `${S - U2}px`,
        marginTop: `${U2}px`
      }), g(
        e.slice(W, A).map((Y2, X2) => ({
          data: Y2,
          index: X2 + W
        }))
      );
    }
  };
  return (0, import_react2.useEffect)(() => {
    if (n.current) {
      const R = () => {
        const w = n.current.clientWidth, E = n.current.clientHeight;
        (w !== (i == null ? void 0 : i.width) || E !== (i == null ? void 0 : i.height)) && u({ width: w, height: E });
      };
      R();
      const B = new ResizeObserver(R);
      return B.observe(n.current), () => {
        B.disconnect();
      };
    }
  }, []), (0, import_react2.useEffect)(() => {
    !(i != null && i.width) || !(i != null && i.height) || _3();
  }, [i == null ? void 0 : i.width, i == null ? void 0 : i.height, e]), [
    v2,
    {
      wrapperStyle: c,
      scrollTo: re((R) => {
        const B = n.current;
        B && (d.current = true, B.scrollTop = O2(R), _3());
      }),
      containerProps: {
        onScroll: (R) => {
          if (d.current) {
            d.current = false;
            return;
          }
          R.preventDefault(), _3();
        }
      }
    }
  ];
};
function Xi(e, t8, ...n) {
  return e.t(t8);
}
var H5 = Object.getOwnPropertyDescriptor;
var x5 = (e, t8, n, r) => {
  for (var o = r > 1 ? void 0 : r ? H5(t8, n) : t8, l = e.length - 1, i; l >= 0; l--)
    (i = e[l]) && (o = i(o) || o);
  return o;
};
var Bt = (e, t8) => (n, r) => t8(n, r, e);
var S5 = "FOCUSING_UNIVER";
var R5 = [
  "app-layout",
  // 'univer-toolbar-btn',
  // 'univer-menu-item',
  "button",
  "sheet-bar-append-button",
  "render-canvas",
  "workbench-layout"
];
var U1 = createIdentifier("ui.layout-service");
var Fe2 = class extends Ve {
  constructor(t8, n) {
    super();
    F(this, "_rootContainerElement", null);
    F(this, "_isFocused", false);
    F(this, "_focusHandlers", /* @__PURE__ */ new Map());
    F(this, "_contentElements", []);
    F(this, "_allContainers", []);
    this._contextService = t8, this._univerInstanceService = n, this._initUniverFocusListener(), this._initEditorStatus();
  }
  get isFocused() {
    return this._isFocused;
  }
  get rootContainerElement() {
    return this._rootContainerElement;
  }
  focus() {
    const t8 = this._univerInstanceService.getFocusedUnit();
    if (!t8)
      return;
    let n;
    t8 instanceof ws ? n = this._focusHandlers.get(we.UNIVER_SHEET) : t8 instanceof Pt ? n = this._focusHandlers.get(we.UNIVER_DOC) : t8 instanceof lc && (n = this._focusHandlers.get(we.UNIVER_SLIDE)), n && n(t8.getUnitId());
  }
  registerFocusHandler(t8, n) {
    if (this._focusHandlers.has(t8))
      throw new Error(`[DesktopLayoutService]: handler of type ${t8} bas been registered!`);
    return this._focusHandlers.set(t8, n), We(() => this._focusHandlers.delete(t8));
  }
  registerContentElement(t8) {
    if (this._contentElements.indexOf(t8) === -1)
      return this._contentElements.push(t8), We(() => Os(this._contentElements, t8));
    throw new Error("[DesktopLayoutService]: content container already registered!");
  }
  getContentElement() {
    return this._contentElements[0];
  }
  registerRootContainerElement(t8) {
    if (this._rootContainerElement)
      throw new Error("[DesktopLayoutService]: root container already registered!");
    this._rootContainerElement = t8;
    const n = this.registerContainerElement(t8);
    return We(() => {
      this._rootContainerElement = null, n.dispose();
    });
  }
  registerContainerElement(t8) {
    if (this._allContainers.indexOf(t8) === -1)
      return this._allContainers.push(t8), We(() => Os(this._allContainers, t8));
    throw new Error("[LayoutService]: container already registered!");
  }
  checkElementInCurrentContainers(t8) {
    return this._allContainers.some((n) => n.contains(t8));
  }
  checkContentIsFocused() {
    return this._contentElements.some((t8) => t8 === document.activeElement || t8.contains(document.activeElement));
  }
  _initUniverFocusListener() {
    this.disposeWithMe(
      fromEvent(window, "focusin").subscribe((t8) => {
        var r;
        const n = t8.target;
        if ((r = this._rootContainerElement) != null && r.contains(n) && R5.some((o) => n.dataset.uComp === o)) {
          queueMicrotask(() => this.focus());
          return;
        }
        n && this.checkElementInCurrentContainers(n) ? this._isFocused = true : this._isFocused = false, this._contextService.setContextValue(S5, this._isFocused), this._contextService.setContextValue(xR, Pt3());
      })
    );
  }
  _initEditorStatus() {
    this._contextService.setContextValue(xR, Pt3());
  }
};
Fe2 = x5([
  Bt(0, Nr),
  Bt(1, vr)
], Fe2);
function Pt3() {
  var e;
  return ((e = document.activeElement) == null ? void 0 : e.dataset.uComp) === "editor";
}
var H1 = ((e) => (e[e.BUTTON = 0] = "BUTTON", e[e.SELECTOR = 1] = "SELECTOR", e[e.BUTTON_SELECTOR = 2] = "BUTTON_SELECTOR", e[e.SUBITEMS = 3] = "SUBITEMS", e))(H1 || {});
var ke3 = ((e) => (e.RIBBON = "ribbon", e.CONTEXT_MENU = "contextMenu", e))(ke3 || {});
var w1 = ((e) => (e.START = "ribbon.start", e.INSERT = "ribbon.insert", e.FORMULAS = "ribbon.formulas", e.DATA = "ribbon.data", e.VIEW = "ribbon.view", e.OTHERS = "ribbon.others", e))(w1 || {});
var G1 = ((e) => (e.HISTORY = "ribbon.start.history", e.FORMAT = "ribbon.start.format", e.LAYOUT = "ribbon.start.layout", e.OTHERS = "ribbon.start.others", e))(G1 || {});
var De = ((e) => (e.EDIT = "ribbon.insert.edit", e.MEDIA = "ribbon.insert.media", e.OTHERS = "ribbon.insert.others", e))(De || {});
var A32 = ((e) => (e.BASIC = "ribbon.formulas.basic", e.OTHERS = "ribbon.formulas.others", e))(A32 || {});
var fe = ((e) => (e.FORMULAS = "ribbon.data.formulas", e.RULES = "ribbon.data.rules", e.ORGANIZATION = "ribbon.data.organization", e.OTHERS = "ribbon.data.others", e))(fe || {});
var Te2 = ((e) => (e.DISPLAY = "ribbon.view.display", e.VISIBILITY = "ribbon.view.Visibility", e.OTHERS = "ribbon.view.others", e))(Te2 || {});
var Zn = ((e) => (e.OTHERS = "ribbon.others.others", e))(Zn || {});
var Y1 = ((e) => (e.MAIN_AREA = "contextMenu.mainArea", e.COL_HEADER = "contextMenu.colHeader", e.ROW_HEADER = "contextMenu.rowHeader", e.FOOTER_TABS = "contextMenu.footerTabs", e.FOOTER_MENU = "contextMenu.footerMenu", e.PARAGRAPH = "contextMenu.paragraph", e))(Y1 || {});
var a12 = ((e) => (e.QUICK = "contextMenu.quick", e.FORMAT = "contextMenu.format", e.LAYOUT = "contextMenu.layout", e.DATA = "contextMenu.data", e.OTHERS = "contextMenu.others", e))(a12 || {});
var V5 = Object.getOwnPropertyDescriptor;
var O5 = (e, t8, n, r) => {
  for (var o = r > 1 ? void 0 : r ? V5(t8, n) : t8, l = e.length - 1, i; l >= 0; l--)
    (i = e[l]) && (o = i(o) || o);
  return o;
};
var Ft3 = (e, t8) => (n, r) => t8(n, r, e);
var B12 = createIdentifier("univer.menu-manager-service");
var je = class extends Ve {
  constructor(t8, n) {
    super();
    F(this, "menuChanged$", new Subject());
    F(this, "_menu", {
      [ke3.RIBBON]: {
        [w1.START]: {
          order: 0,
          [G1.HISTORY]: {
            order: 0
          },
          [G1.FORMAT]: {
            order: 1
          },
          [G1.LAYOUT]: {
            order: 2
          },
          [G1.OTHERS]: {
            order: 3
          }
        },
        [w1.INSERT]: {
          order: 1,
          [De.EDIT]: {
            order: 0
          },
          [De.MEDIA]: {
            order: 1
          },
          [De.OTHERS]: {
            order: 2
          }
        },
        [w1.FORMULAS]: {
          order: 2,
          [A32.BASIC]: {
            order: 0
          },
          [A32.OTHERS]: {
            order: 1
          }
        },
        [w1.DATA]: {
          order: 3,
          [fe.FORMULAS]: {
            order: 0
          },
          [fe.RULES]: {
            order: 1
          },
          [fe.ORGANIZATION]: {
            order: 2
          },
          [fe.OTHERS]: {
            order: 3
          }
        },
        [w1.VIEW]: {
          order: 4,
          [Te2.DISPLAY]: {
            order: 0
          },
          [Te2.VISIBILITY]: {
            order: 0
          },
          [Te2.OTHERS]: {
            order: 0
          }
        },
        [w1.OTHERS]: {
          order: 5,
          [Zn.OTHERS]: {
            order: 0
          }
        }
      },
      [ke3.CONTEXT_MENU]: {
        [Y1.MAIN_AREA]: {
          order: 0,
          [a12.QUICK]: {
            order: -1
          },
          [a12.FORMAT]: {
            order: 0
          },
          [a12.LAYOUT]: {
            order: 1
          },
          [a12.DATA]: {
            order: 2
          },
          [a12.OTHERS]: {
            order: 3
          }
        },
        [Y1.PARAGRAPH]: {
          order: 0,
          [a12.QUICK]: {
            order: -1
          },
          [a12.FORMAT]: {
            order: 0
          },
          [a12.LAYOUT]: {
            order: 1
          },
          [a12.DATA]: {
            order: 2
          },
          [a12.OTHERS]: {
            order: 3
          }
        },
        [Y1.COL_HEADER]: {
          order: 1,
          [a12.FORMAT]: {
            order: 0
          },
          [a12.LAYOUT]: {
            order: 1
          },
          [a12.DATA]: {
            order: 2
          },
          [a12.OTHERS]: {
            order: 3
          }
        },
        [Y1.ROW_HEADER]: {
          order: 2,
          [a12.FORMAT]: {
            order: 0
          },
          [a12.LAYOUT]: {
            order: 1
          },
          [a12.DATA]: {
            order: 2
          },
          [a12.OTHERS]: {
            order: 3
          }
        },
        [Y1.FOOTER_TABS]: {
          order: 3,
          [a12.FORMAT]: {
            order: 0
          },
          [a12.LAYOUT]: {
            order: 1
          },
          [a12.DATA]: {
            order: 2
          },
          [a12.OTHERS]: {
            order: 3
          }
        },
        [Y1.FOOTER_MENU]: {
          order: 4,
          [a12.OTHERS]: {
            order: 3
          }
        }
      }
    });
    this._injector = t8, this._configService = n;
  }
  dispose() {
    this.menuChanged$.complete();
  }
  /**
   * Merge source menu to target menu recursively
   * @param source
   * @param target default is root menu
   */
  mergeMenu(t8, n) {
    const r = n != null ? n : this._menu;
    for (const [o, l] of Object.entries(r))
      if (o in t8) {
        const i = o;
        r[i] = oo({}, r[i], t8[i]), this.menuChanged$.next();
      } else typeof l == "object" && this.mergeMenu(t8, l);
  }
  appendRootMenu(t8) {
    this._menu = oo({}, this._menu, t8), this.menuChanged$.next();
  }
  _buildMenuSchema(t8) {
    const n = [];
    for (const [r, o] of Object.entries(t8)) {
      const l = {
        key: r,
        order: o.order,
        title: o.title
      };
      if (o.menuItemFactory) {
        const i = this._injector.invoke(o.menuItemFactory);
        if (i) {
          const u = this._configService.getConfig("menu");
          if (u && i.id in u) {
            const d = i.id;
            l.item = a5(i, u[d]);
          } else
            l.item = i;
        }
      }
      if (typeof o == "object") {
        const i = this._buildMenuSchema(o);
        i.length > 0 && (l.children = i.sort((u, d) => u.order - d.order)), (l.item || l.children) && n.push(l);
      }
    }
    return n;
  }
  /**
   * Get menu schema by position key
   * @param key
   * @returns Menu schema array or empty array if not found
   */
  getMenuByPositionKey(t8) {
    const n = (r) => {
      if (t8 in r)
        return this._buildMenuSchema(r[t8]);
      for (const o in r) {
        if (o === t8)
          return this._buildMenuSchema(r[o]);
        if (typeof r[o] == "object") {
          const l = n(r[o]);
          if (l)
            return l;
        }
      }
    };
    return n(this._menu);
  }
  /**
   * Get flat menu schema by position key
   * @param key
   * @returns Flat menu schema array or empty array if not found
   */
  getFlatMenuByPositionKey(t8) {
    const n = this.getMenuByPositionKey(t8);
    function r(o) {
      return o.reduce((l, i) => i.children ? [...l, i, ...r(i.children)] : [...l, i], []);
    }
    return r(n);
  }
};
je = O5([
  Ft3(0, Inject(Injector)),
  Ft3(1, ic)
], je);
function $5(e) {
  const { item: t8, onOptionSelect: n } = e, [r, o] = (0, import_react2.useState)([]), l = useDependency(S1), i = useDependency(Fn);
  return (0, import_react2.useEffect)(() => {
    if (!t8.children) return;
    const u = t8.children.map((v2) => {
      var g, c;
      return I1((c = (g = v2.item) == null ? void 0 : g.activated$) != null ? c : of(false), false);
    }), d = combineLatest(u).subscribe((v2) => {
      const g = v2.map((c, m2) => ({ actived: c, item: t8.children[m2].item.id })).filter((c) => c.actived);
      g.length === 0 ? o([]) : o(g.map((c) => c.item));
    });
    return () => {
      d.unsubscribe(), u.forEach((v2) => {
        v2.complete();
      });
    };
  }, [t8]), t8.children ? (0, import_jsx_runtime2.jsx)(
    PE,
    {
      items: t8.children.map((u) => {
        var d, v2;
        return {
          key: u.key,
          onClick: () => {
            var g, c, m2, L;
            n == null || n({
              value: "",
              label: u.key,
              commandId: (g = u.item) == null ? void 0 : g.commandId,
              id: (c = u.item) == null ? void 0 : c.id,
              tooltip: ((m2 = u.item) == null ? void 0 : m2.tooltip) && i.t((L = u.item) == null ? void 0 : L.tooltip)
            });
          },
          className: "",
          Icon: l.get(u.item.icon),
          active: r.includes((v2 = (d = u.item) == null ? void 0 : d.id) != null ? v2 : "")
        };
      })
    }
  ) : null;
}
var Ce = "univer-inline-flex univer-gap-2 univer-items-center";
var kt3 = "univer-size-3.5 univer-text-gray-900 dark:!univer-text-white";
function An2(e) {
  const { menuType: t8, onOptionSelect: n } = e, r = useDependency(Fn), o = useDependency(B12), l = (0, import_react2.useMemo)(() => t8 ? o.getMenuByPositionKey(t8) : [], [t8, o]), [i, u] = (0, import_react2.useState)({}), d = (0, import_react2.useMemo)(() => l.filter((v2) => {
    var c;
    if (!v2.children) return v2;
    const g = ((c = v2.key) == null ? void 0 : c.toString()) || "";
    return !i[g];
  }), [l, i]);
  return (0, import_react2.useEffect)(() => {
    const v2 = l.map((g) => {
      if (!g.children) return null;
      const c = g.children.map((m2) => {
        var L, y;
        return (y = (L = m2.item) == null ? void 0 : L.hidden$) != null ? y : of(false);
      });
      return combineLatest(c).subscribe((m2) => {
        const L = m2.every((y) => y === true);
        u((y) => ({
          ...y,
          [g.key]: L
        }));
      });
    });
    return () => {
      v2.forEach((g) => g == null ? void 0 : g.unsubscribe()), u({});
    };
  }, [l]), t8 ? d && d.map((v2) => {
    var g;
    return v2.item ? (0, import_jsx_runtime2.jsx)(
      jt,
      {
        menuItem: v2.item,
        onClick: (c) => {
          n == null || n({ value: "", label: v2.key, ...c });
        }
      },
      v2.key
    ) : (g = v2.children) != null && g.length ? v2.key === a12.QUICK ? (0, import_jsx_runtime2.jsx)($5, { item: v2, onOptionSelect: n }, v2.key) : (0, import_jsx_runtime2.jsx)(ME2, { eventKey: v2.key, title: v2.title ? r.t(v2.title) : void 0, children: v2.children.map((c) => c.item && (0, import_jsx_runtime2.jsx)(
      jt,
      {
        menuItem: c.item,
        onClick: (m2) => {
          n == null || n({ value: "", label: c.key, ...m2 });
        }
      },
      c.key
    )) }, v2.key) : null;
  }) : null;
}
function Bn3(e) {
  var l;
  const { options: t8, value: n, onOptionSelect: r, parentKey: o } = e;
  return (l = t8 == null ? void 0 : t8.map((i, u) => {
    var m2, L, y;
    const d = `${o}-${(m2 = i.label) != null ? m2 : i.id}-${u}`, v2 = (O2) => {
      r == null || r({ value: O2, label: i == null ? void 0 : i.label, commandId: i == null ? void 0 : i.commandId });
    }, g = () => {
      typeof i.value > "u" || r == null || r({
        ...i
      });
    }, c = ie2({
      "univer-bg-none": typeof i.label != "string" && !((L = i.label) != null && L.hoverable)
    });
    return (0, import_jsx_runtime2.jsx)(EE, { disabled: i.disabled, eventKey: d, className: c, onClick: g, children: (0, import_jsx_runtime2.jsxs)(
      "span",
      {
        className: ie2(Ce, {
          "univer-relative univer-pl-5": !(typeof i.label != "string" && !((y = i.label) != null && y.hoverable))
        }),
        children: [
          typeof n < "u" && String(n) === String(i.value) && (0, import_jsx_runtime2.jsx)("span", { className: "univer-absolute univer-left-0 univer-inline-flex univer-items-center", children: (0, import_jsx_runtime2.jsx)(X3, { className: "univer-text-primary-600" }) }),
          (0, import_jsx_runtime2.jsx)(
            _12,
            {
              value$: i.value$,
              value: i.value,
              label: i.label,
              icon: i.icon,
              onChange: v2
            }
          )
        ]
      }
    ) }, d);
  })) != null ? l : null;
}
var E5 = (e) => {
  const { overViewport: t8, style: n, ...r } = e, [o, l] = (0, import_react2.useState)(), i = useDependency(U1);
  g5(t8 === "scroll" ? o : null, i.rootContainerElement);
  function u(d) {
    d && l(d.list);
  }
  return (0, import_jsx_runtime2.jsxs)(
    SE,
    {
      style: n,
      ref: u,
      selectable: false,
      children: [
        (0, import_jsx_runtime2.jsx)(Bn3, { ...r }),
        (0, import_jsx_runtime2.jsx)(An2, { ...r })
      ]
    }
  );
};
function jt({ menuItem: e, onClick: t8 }) {
  const n = useDependency(B12), r = useObservable(e.disabled$, false), o = useObservable(e.activated$, false), l = useObservable(e.hidden$, false), i = useObservable(e.value$), u = e, d = useObservable(isObservable(u.selections) ? u.selections : void 0), [v2, g] = (0, import_react2.useState)(i);
  if ((0, import_react2.useEffect)(() => {
    g(i);
  }, [i]), l)
    return null;
  const c = (S) => {
    const _3 = Z1(S) && typeof S == "string" ? Number.parseInt(S) : S;
    g(_3);
  }, m2 = () => {
    const S = e, { title: _3, label: $ } = S;
    return (0, import_jsx_runtime2.jsx)(
      EE,
      {
        eventKey: S.id,
        disabled: r,
        className: ie2({
          "univer-bg-gray-200": o
        }),
        onClick: () => {
          t8({ commandId: S.commandId, value: v2, id: S.id });
        },
        children: (0, import_jsx_runtime2.jsx)("span", { className: Ce, children: (0, import_jsx_runtime2.jsx)(
          _12,
          {
            value: i,
            title: _3,
            label: $,
            icon: S.icon,
            onChange: c
          }
        ) })
      },
      S.id
    );
  }, L = () => {
    var _3;
    const S = (_3 = d != null ? d : u.selections) != null ? _3 : [];
    return S.length > 0 ? (0, import_jsx_runtime2.jsx)(
      RE,
      {
        eventKey: u.id,
        popupOffset: [18, 0],
        title: (0, import_jsx_runtime2.jsxs)("span", { className: Ce, children: [
          (0, import_jsx_runtime2.jsx)(
            _12,
            {
              title: u.title,
              value: v2,
              onChange: c,
              icon: u.icon,
              label: u.label
            }
          ),
          u.shortcut && ` (${u.shortcut})`
        ] }),
        expandIcon: (0, import_jsx_runtime2.jsx)(Z3, { className: kt3 }),
        children: (0, import_jsx_runtime2.jsx)(ME2, { children: S.length > 0 && (0, import_jsx_runtime2.jsx)(
          Bn3,
          {
            parentKey: u.id,
            menuType: u.id,
            options: S,
            onOptionSelect: ($) => {
              t8({ value: $.value, id: u.id, commandId: $.commandId });
            }
          }
        ) })
      },
      u.id
    ) : (0, import_jsx_runtime2.jsx)(EE, { eventKey: u.id, children: (0, import_jsx_runtime2.jsxs)("span", { className: Ce, children: [
      (0, import_jsx_runtime2.jsx)(
        _12,
        {
          title: u.title,
          value: v2,
          icon: u.icon,
          label: u.label,
          onChange: c
        }
      ),
      u.shortcut && ` (${u.shortcut})`
    ] }) }, u.id);
  }, y = e.id ? n.getMenuByPositionKey(e.id) : [], O2 = () => {
    const S = e;
    return (0, import_jsx_runtime2.jsx)(
      RE,
      {
        eventKey: S.id,
        popupOffset: [18, 0],
        title: (0, import_jsx_runtime2.jsx)("span", { className: Ce, children: (0, import_jsx_runtime2.jsx)(_12, { title: S.title, icon: S.icon, label: S.label, onChange: c }) }),
        expandIcon: (0, import_jsx_runtime2.jsx)(Z3, { className: kt3 }),
        children: (0, import_jsx_runtime2.jsx)(ME2, { children: y.length && (0, import_jsx_runtime2.jsx)(An2, { menuType: S.id, parentKey: S.id, onOptionSelect: t8 }) })
      },
      S.id
    );
  };
  return (0, import_jsx_runtime2.jsxs)(import_jsx_runtime2.Fragment, { children: [
    e.type === H1.SELECTOR && L(),
    e.type === H1.SUBITEMS && O2(),
    e.type === H1.BUTTON && m2()
  ] });
}
function qi(e) {
  const { barColor: t8, progress: n, onTerminate: r, onClearProgress: o } = e, { count: l, done: i, label: u = "" } = n, d = (0, import_react2.useRef)(null), [v2, g] = (0, import_react2.useState)(false);
  return (0, import_react2.useEffect)(() => {
    const c = d.current;
    if (l === 0 && i === 0) {
      g(false), c.style.width = "0%";
      return;
    } else if (l > 0) {
      g(true);
      const L = Math.floor(i / l * 100);
      i === l ? requestAnimationFrame(() => {
        c.style.width = `${L - 1}%`, requestAnimationFrame(() => {
          c.style.width = `${L}%`;
        });
      }) : c.style.width = `${L}%`;
    }
    const m2 = () => {
      i === l && (g(false), o && o());
    };
    return c.addEventListener("transitionend", m2), () => {
      c.removeEventListener("transitionend", m2);
    };
  }, [l, i]), (0, import_jsx_runtime2.jsxs)(
    "div",
    {
      className: ie2("univer-mx-2 univer-flex univer-items-center univer-gap-2", {
        "univer-flex": v2,
        "univer-hidden univer-w-0": !v2
      }),
      children: [
        (0, import_jsx_runtime2.jsx)(Rp, { showIfEllipsis: true, title: u, children: (0, import_jsx_runtime2.jsx)("span", { className: "univer-w-24 univer-truncate univer-text-right univer-text-xs", children: u }) }),
        (0, import_jsx_runtime2.jsx)("div", { className: "univer-h-1 univer-w-40 univer-overflow-hidden univer-rounded-lg univer-bg-gray-200", children: (0, import_jsx_runtime2.jsx)(
          "div",
          {
            ref: d,
            className: "univer-h-full univer-bg-primary-600 univer-transition-[width]",
            style: {
              backgroundColor: t8
            }
          }
        ) }),
        (0, import_jsx_runtime2.jsx)(
          "button",
          {
            className: "univer-flex univer-size-4 univer-cursor-pointer univer-items-center univer-justify-center univer-border-none univer-bg-transparent univer-p-0 hover:univer-opacity-50",
            type: "button",
            onClick: r,
            children: (0, import_jsx_runtime2.jsx)(
              q3,
              {
                className: "univer-size-3.5 dark:!univer-text-white"
              }
            )
          }
        )
      ]
    }
  );
}
var Ji = "UNI_DISABLE_CHANGING_FOCUS";
var _e2 = "ui.config";
var Ue2 = {};
var et2 = createIdentifier("ui.message.service");
var N5 = Object.getOwnPropertyDescriptor;
var D5 = (e, t8, n, r) => {
  for (var o = r > 1 ? void 0 : r ? N5(t8, n) : t8, l = e.length - 1, i; l >= 0; l--)
    (i = e[l]) && (o = i(o) || o);
  return o;
};
var Ut2 = (e, t8) => (n, r) => t8(n, r, e);
var oe = class extends Ve {
  constructor(e, t8) {
    super(), this._errorService = e, this._messageService = t8, this.disposeWithMe(this._errorService.error$.subscribe((n) => {
      this._messageService.show({
        content: n.errorKey,
        type: $C.Error
      });
    }));
  }
};
oe = D5([
  Ut2(0, Inject(_E)),
  Ut2(1, et2)
], oe);
function T5() {
  return {
    id: s3.id,
    title: "toggle-shortcut-panel",
    tooltip: "toggle-shortcut-panel",
    icon: "ShortcutIcon",
    type: H1.BUTTON
  };
}
var Pn = (e, t8) => {
  const n = e.get(Qo), r = e.get(Nr);
  return combineLatest([
    n.undoRedoStatus$.pipe(map((o) => t8 ? o.undos <= 0 : o.redos <= 0)),
    merge([of({}), r.contextChanged$])
  ]).pipe(map(([o]) => o || r.getContextValue(mE) || r.getContextValue(gE)));
};
function Z52(e) {
  return {
    id: gC.id,
    type: H1.BUTTON,
    icon: "UndoIcon",
    title: "Undo",
    tooltip: "toolbar.undo",
    disabled$: Pn(e, true)
  };
}
function A5(e) {
  return {
    id: _C.id,
    type: H1.BUTTON,
    icon: "RedoIcon",
    title: "Redo",
    tooltip: "toolbar.redo",
    disabled$: Pn(e, false)
  };
}
var B5 = {
  [G1.HISTORY]: {
    [gC.id]: {
      order: 0,
      menuItemFactory: Z52
    },
    [_C.id]: {
      order: 1,
      menuItemFactory: A5
    }
  },
  [G1.OTHERS]: {
    [s3.id]: {
      order: 1,
      menuItemFactory: T5
    }
  }
};
var zt2 = "univer.command.copy";
var Fn3 = {
  id: zt2,
  name: zt2,
  multi: true,
  priority: 0,
  type: Ms.COMMAND,
  preconditions: () => false,
  handler: () => true
};
var Wt2 = "univer.command.cut";
var kn2 = {
  id: Wt2,
  name: Wt2,
  multi: true,
  priority: 0,
  type: Ms.COMMAND,
  preconditions: () => false,
  handler: async () => true
};
var Yt = "univer.command.paste";
var jn2 = {
  id: Yt,
  name: Yt,
  multi: true,
  priority: 0,
  type: Ms.COMMAND,
  preconditions: () => false,
  handler: () => true
};
var Qi = "sheet.command.paste-by-short-key";
var q1 = ((e) => (e[e.UNKNOWN = 0] = "UNKNOWN", e[e.BACKSPACE = 8] = "BACKSPACE", e[e.TAB = 9] = "TAB", e[e.ENTER = 13] = "ENTER", e[e.SHIFT = 16] = "SHIFT", e[e.CTRL = 17] = "CTRL", e[e.ESC = 27] = "ESC", e[e.SPACE = 32] = "SPACE", e[e.ARROW_LEFT = 37] = "ARROW_LEFT", e[e.ARROW_UP = 38] = "ARROW_UP", e[e.ARROW_RIGHT = 39] = "ARROW_RIGHT", e[e.ARROW_DOWN = 40] = "ARROW_DOWN", e[e.INSERT = 45] = "INSERT", e[e.DELETE = 46] = "DELETE", e[e.Digit0 = 48] = "Digit0", e[e.Digit1 = 49] = "Digit1", e[e.Digit2 = 50] = "Digit2", e[e.Digit3 = 51] = "Digit3", e[e.Digit4 = 52] = "Digit4", e[e.Digit5 = 53] = "Digit5", e[e.Digit6 = 54] = "Digit6", e[e.Digit7 = 55] = "Digit7", e[e.Digit8 = 56] = "Digit8", e[e.Digit9 = 57] = "Digit9", e[e.A = 65] = "A", e[e.B = 66] = "B", e[e.C = 67] = "C", e[e.D = 68] = "D", e[e.E = 69] = "E", e[e.F = 70] = "F", e[e.G = 71] = "G", e[e.H = 72] = "H", e[e.I = 73] = "I", e[e.J = 74] = "J", e[e.K = 75] = "K", e[e.L = 76] = "L", e[e.M = 77] = "M", e[e.N = 78] = "N", e[e.O = 79] = "O", e[e.P = 80] = "P", e[e.Q = 81] = "Q", e[e.R = 82] = "R", e[e.S = 83] = "S", e[e.T = 84] = "T", e[e.U = 85] = "U", e[e.V = 86] = "V", e[e.W = 87] = "W", e[e.X = 88] = "X", e[e.Y = 89] = "Y", e[e.Z = 90] = "Z", e[e.F1 = 112] = "F1", e[e.F2 = 113] = "F2", e[e.F3 = 114] = "F3", e[e.F4 = 115] = "F4", e[e.F5 = 116] = "F5", e[e.F6 = 117] = "F6", e[e.F7 = 118] = "F7", e[e.F8 = 119] = "F8", e[e.F9 = 120] = "F9", e[e.F10 = 121] = "F10", e[e.F11 = 122] = "F11", e[e.F12 = 123] = "F12", e[e.NUM_LOCK = 144] = "NUM_LOCK", e[e.SCROLL_LOCK = 145] = "SCROLL_LOCK", e[e.EQUAL = 187] = "EQUAL", e[e.COMMA = 188] = "COMMA", e[e.MINUS = 189] = "MINUS", e[e.PERIOD = 190] = "PERIOD", e[e.BACK_SLASH = 220] = "BACK_SLASH", e))(q1 || {});
var P5 = {
  8: "Backspace",
  9: "Tab",
  13: "Enter",
  46: "Del",
  27: "Esc",
  32: "Space",
  37: "",
  39: "",
  38: "",
  40: "",
  48: "0",
  49: "1",
  50: "2",
  51: "3",
  52: "4",
  53: "5",
  54: "6",
  55: "7",
  56: "8",
  57: "9",
  65: "A",
  66: "B",
  67: "C",
  68: "D",
  69: "E",
  70: "F",
  71: "G",
  72: "H",
  73: "I",
  74: "J",
  75: "K",
  76: "L",
  77: "M",
  78: "N",
  79: "O",
  80: "P",
  81: "Q",
  82: "R",
  83: "S",
  84: "T",
  85: "U",
  86: "V",
  87: "W",
  88: "X",
  89: "Y",
  90: "Z",
  112: "F1",
  113: "F2",
  114: "F3",
  115: "F4",
  116: "F5",
  117: "F6",
  118: "F7",
  119: "F8",
  120: "F9",
  121: "F10",
  122: "F11",
  123: "F12",
  189: "-",
  187: "=",
  190: ".",
  188: ",",
  220: "\\"
};
var L1 = ((e) => (e[e.SHIFT = 1024] = "SHIFT", e[e.ALT = 2048] = "ALT", e[e.CTRL_COMMAND = 4096] = "CTRL_COMMAND", e[e.MAC_CTRL = 8192] = "MAC_CTRL", e))(L1 || {});
function F5(e, t8, n) {
  return window.addEventListener(e, t8, n), We(() => window.removeEventListener(e, t8, n));
}
var tt = createIdentifier("ui.platform.service");
var Un = class {
  get isMac() {
    return /Mac/.test(navigator.appVersion);
  }
  get isWindows() {
    return /Windows/.test(navigator.appVersion);
  }
  get isLinux() {
    return /Linux/.test(navigator.appVersion);
  }
};
var k5 = Object.getOwnPropertyDescriptor;
var j5 = (e, t8, n, r) => {
  for (var o = r > 1 ? void 0 : r ? k5(t8, n) : t8, l = e.length - 1, i; l >= 0; l--)
    (i = e[l]) && (o = i(o) || o);
  return o;
};
var Re = (e, t8) => (n, r) => t8(n, r, e);
var ye3 = createIdentifier("ui.shortcut.service");
var ze = class extends Ve {
  constructor(t8, n, r, o) {
    super();
    F(this, "_shortCutMapping", /* @__PURE__ */ new Map());
    F(this, "_commandIDMapping", /* @__PURE__ */ new Map());
    F(this, "_shortcutChanged$", new Subject());
    F(this, "shortcutChanged$", this._shortcutChanged$.asObservable());
    F(this, "_forceEscaped", false);
    F(this, "_forceDisabled", false);
    this._commandService = t8, this._platformService = n, this._contextService = r, this._layoutService = o, this.disposeWithMe(
      F5("keydown", (l) => {
        this._resolveKeyboardEvent(l);
      }, {
        capture: true
      })
    );
  }
  getAllShortcuts() {
    return Array.from(this._shortCutMapping.values()).map((t8) => Array.from(t8.values())).flat();
  }
  registerShortcut(t8) {
    const n = this._getBindingFromItem(t8);
    if (!n) return We(() => {
    });
    const r = this._shortCutMapping.get(n);
    r ? r.add(t8) : this._shortCutMapping.set(n, /* @__PURE__ */ new Set([t8]));
    const o = t8.id, l = this._commandIDMapping.get(o);
    return l ? l.add(t8) : this._commandIDMapping.set(o, /* @__PURE__ */ new Set([t8])), this._emitShortcutChanged(), We(() => {
      var i, u, d, v2;
      (i = this._shortCutMapping.get(n)) == null || i.delete(t8), ((u = this._shortCutMapping.get(n)) == null ? void 0 : u.size) === 0 && this._shortCutMapping.delete(n), (d = this._commandIDMapping.get(o)) == null || d.delete(t8), ((v2 = this._commandIDMapping.get(o)) == null ? void 0 : v2.size) === 0 && this._commandIDMapping.delete(o), this._emitShortcutChanged();
    });
  }
  getShortcutDisplayOfCommand(t8) {
    const n = this._commandIDMapping.get(t8);
    if (!n)
      return null;
    const r = n.values().next().value;
    return r ? this.getShortcutDisplay(r) : null;
  }
  getShortcutDisplay(t8) {
    var d;
    const n = this._getBindingFromItem(t8);
    if (!n) return null;
    const r = n & L1.CTRL_COMMAND, o = n & L1.SHIFT, l = n & L1.ALT, i = n & L1.MAC_CTRL, u = (d = P5[n & 255]) != null ? d : "<->";
    return this._platformService.isMac ? `${r ? "+" : ""}${o ? "+" : ""}${l ? "+" : ""}${i ? "+" : ""}${u}` : `${r ? "Ctrl+" : ""}${o ? "Shift+" : ""}${l ? "Alt+" : ""}${u}`;
  }
  _emitShortcutChanged() {
    this._shortcutChanged$.next();
  }
  forceEscape() {
    return this._forceEscaped = true, We(() => this._forceEscaped = false);
  }
  forceDisable() {
    return this._forceDisabled = true, We(() => {
      this._forceDisabled = false;
    });
  }
  _resolveKeyboardEvent(t8) {
    const n = this.dispatch(t8);
    n && (this._commandService.executeCommand(n.id, n.staticParameters), t8.preventDefault());
  }
  dispatch(t8) {
    if (this._forceEscaped || this._forceDisabled || this._layoutService && !this._layoutService.checkElementInCurrentContainers(t8.target))
      return;
    const n = this._deriveBindingFromEvent(t8);
    if (n === null)
      return;
    const r = this._shortCutMapping.get(n);
    return r === void 0 ? void 0 : Array.from(r).sort((l, i) => {
      var u, d;
      return ((u = i.priority) != null ? u : 0) - ((d = l.priority) != null ? d : 0);
    }).find((l) => {
      var i, u;
      return (u = (i = l.preconditions) == null ? void 0 : i.call(l, this._contextService)) != null ? u : true;
    });
  }
  _getBindingFromItem(t8) {
    return this._platformService.isMac && t8.mac ? t8.mac : this._platformService.isWindows && t8.win ? t8.win : this._platformService.isLinux && t8.linux ? t8.linux : t8.binding;
  }
  _deriveBindingFromEvent(t8) {
    const { shiftKey: n, metaKey: r, altKey: o, keyCode: l } = t8;
    let i = l;
    return n && (i |= L1.SHIFT), o && (i |= L1.ALT), (this._platformService.isMac ? r : t8.ctrlKey) && (i |= L1.CTRL_COMMAND), this._platformService.isMac && t8.ctrlKey && (i |= L1.MAC_CTRL), i;
  }
};
ze = j5([
  Re(0, Ls),
  Re(1, tt),
  Re(2, Nr),
  Re(3, Optional(U1))
], ze);
var U5 = Object.getOwnPropertyDescriptor;
var z5 = (e, t8, n, r) => {
  for (var o = r > 1 ? void 0 : r ? U5(t8, n) : t8, l = e.length - 1, i; l >= 0; l--)
    (i = e[l]) && (o = i(o) || o);
  return o;
};
var Gt = (e, t8) => (n, r) => t8(n, r, e);
function zn2(e) {
  return e.getContextValue(xR);
}
function Wn2(e) {
  return e.getContextValue(xR) && !(e.getContextValue(mE) || e.getContextValue(gE));
}
var W5 = {
  id: Fn3.id,
  description: "shortcut.copy",
  group: "1_common-edit",
  binding: q1.C | L1.CTRL_COMMAND,
  preconditions: zn2
};
var Y5 = {
  id: kn2.id,
  description: "shortcut.cut",
  group: "1_common-edit",
  binding: q1.X | L1.CTRL_COMMAND,
  preconditions: zn2
};
var G5 = {
  id: jn2.id,
  description: "shortcut.paste",
  group: "1_common-edit",
  binding: q1.V | L1.CTRL_COMMAND,
  preconditions: () => false
};
var X5 = {
  id: gC.id,
  description: "shortcut.undo",
  group: "1_common-edit",
  binding: q1.Z | L1.CTRL_COMMAND,
  preconditions: Wn2
};
var q5 = {
  id: _C.id,
  description: "shortcut.redo",
  group: "1_common-edit",
  binding: q1.Y | L1.CTRL_COMMAND,
  preconditions: Wn2
};
var ie4 = class extends Ve {
  constructor(e, t8) {
    super(), this._shortcutService = e, this._commandService = t8, this.initialize();
  }
  initialize() {
    this._registerCommands(), this._registerShortcuts();
  }
  _registerCommands() {
    [kn2, Fn3, jn2].forEach(
      (e) => this.disposeWithMe(this._commandService.registerMultipleCommand(e))
    );
  }
  _registerShortcuts() {
    const e = [X5, q5];
    e.push(Y5, W5, G5), e.forEach((t8) => this.disposeWithMe(this._shortcutService.registerShortcut(t8)));
  }
};
ie4 = z5([
  Gt(0, ye3),
  Gt(1, Ls)
], ie4);
function J5() {
  const e = useDependency(ye3), t8 = useDependency(Fn), n = useObservable(t8.currentLocale$), [r, o] = (0, import_react2.useState)([]), l = (0, import_react2.useCallback)(() => {
    var v2;
    const i = /* @__PURE__ */ new Map(), u = e.getAllShortcuts().filter((g) => !!g.group);
    for (const g of u) {
      const c = g.group, m2 = {
        title: t8.t((v2 = g.description) != null ? v2 : g.id),
        shortcut: e.getShortcutDisplay(g)
      };
      if (!/\d+_[a-zA-Z0-9]/.test(c))
        throw new Error(`[ShortcutPanel]: Invalid shortcut group: ${c}!`);
      i.has(c) || i.set(c, []), i.get(c).push(m2);
    }
    const d = Array.from(i.entries()).map(([g, c]) => {
      const m2 = g.split("_")[0], L = g.slice(m2.length + 1);
      return {
        sequence: +m2,
        name: t8.t(L),
        items: HC(c, (y) => y.title + y.shortcut)
      };
    }).sort((g, c) => g.sequence - c.sequence);
    o(d);
  }, [e, t8, n]);
  return (0, import_react2.useEffect)(() => {
    l();
    const i = e.shortcutChanged$.subscribe(() => l());
    return () => i.unsubscribe();
  }, [e, l]), (0, import_jsx_runtime2.jsx)(
    "ul",
    {
      className: "univer-m-0 univer-list-none univer-p-0 univer-text-gray-900 dark:!univer-text-white",
      children: r.map((i) => (0, import_jsx_runtime2.jsxs)("li", { children: [
        (0, import_jsx_runtime2.jsx)("div", { className: "univer-flex univer-h-10 univer-items-center univer-text-sm univer-font-semibold", children: i.name }),
        (0, import_jsx_runtime2.jsx)(
          "ul",
          {
            className: ie2("univer-list-none univer-p-0", nE),
            children: i.items.map((u) => (0, import_jsx_runtime2.jsxs)(
              "li",
              {
                className: "univer-flex univer-h-10 univer-items-center univer-justify-between univer-py-0.5 univer-text-sm last:univer-border-b-0",
                children: [
                  (0, import_jsx_runtime2.jsx)("span", { className: "univer-line-clamp-2", children: u.title }),
                  u.shortcut && (0, import_jsx_runtime2.jsx)(CE, { keyboard: u.shortcut })
                ]
              },
              `${u.title}-${u.shortcut}`
            ))
          }
        )
      ] }, i.name))
    }
  );
}
var Q5 = Object.getOwnPropertyDescriptor;
var K5 = (e, t8, n, r) => {
  for (var o = r > 1 ? void 0 : r ? Q5(t8, n) : t8, l = e.length - 1, i; l >= 0; l--)
    (i = e[l]) && (o = i(o) || o);
  return o;
};
var he = (e, t8) => (n, r) => t8(n, r, e);
var eo2 = {
  id: s3.id,
  binding: L1.CTRL_COMMAND | q1.BACK_SLASH,
  description: "shortcut.shortcut-panel",
  group: "10_global-shortcut"
};
var le = class extends Ve {
  constructor(e, t8, n, r, o) {
    super(), this._menuManagerService = r, this.disposeWithMe(t8.register(E9, J5)), this.disposeWithMe(o.registerCommand(s3)), this.disposeWithMe(n.registerShortcut(eo2));
  }
};
le = K5([
  he(0, Inject(Injector)),
  he(1, Inject(S1)),
  he(2, ye3),
  he(3, B12),
  he(4, Ls)
], le);
var c12 = ((e) => (e.GLOBAL = "global", e.HEADER = "header", e.HEADER_MENU = "header-menu", e.CONTENT = "content", e.FOOTER = "footer", e.LEFT_SIDEBAR = "left-sidebar", e.FLOATING = "floating", e.UNIT = "unit", e.CUSTOM_HEADER = "custom-header", e.CUSTOM_LEFT = "custom-left", e.CUSTOM_RIGHT = "custom-right", e.CUSTOM_FOOTER = "custom-footer", e.TOOLBAR = "toolbar", e))(c12 || {});
var D1 = createIdentifier("ui.parts.service");
var Yn = class extends Ve {
  constructor() {
    super(...arguments);
    F(this, "_componentsByPart", /* @__PURE__ */ new Map());
    F(this, "_componentRegistered$", new Subject());
    F(this, "componentRegistered$", this._componentRegistered$.asObservable());
    F(this, "_uiVisible", /* @__PURE__ */ new Map());
    F(this, "_uiVisibleChange$", new Subject());
    F(this, "uiVisibleChange$", this._uiVisibleChange$.asObservable());
  }
  dispose() {
    super.dispose(), this._componentsByPart.clear(), this._uiVisible.clear(), this._componentRegistered$.complete(), this._uiVisibleChange$.complete();
  }
  setUIVisible(n, r) {
    this._uiVisible.set(n, r), this._uiVisibleChange$.next({ ui: n, visible: r });
  }
  isUIVisible(n) {
    var r;
    return (r = this._uiVisible.get(n)) != null ? r : true;
  }
  registerComponent(n, r) {
    const o = r(), l = (this._componentsByPart.get(n) || this._componentsByPart.set(n, /* @__PURE__ */ new Set()).get(n)).add(o);
    return this._componentRegistered$.next(n), We(() => {
      l.delete(o), l.size === 0 && this._componentsByPart.delete(n), this._componentRegistered$.next(n);
    });
  }
  getComponents(n) {
    return /* @__PURE__ */ new Set([...this._componentsByPart.get(n) || /* @__PURE__ */ new Set()]);
  }
};
var nt2 = class {
  constructor() {
    F(this, "_domLayerMap", /* @__PURE__ */ new Map());
    F(this, "_domLayers$", new BehaviorSubject([]));
    F(this, "domLayers$", this._domLayers$.asObservable());
  }
  get domLayers() {
    return Array.from(this._domLayerMap.entries());
  }
  _notice() {
    this._domLayers$.next(Array.from(this._domLayerMap.entries()));
  }
  updateFloatDom(t8, n) {
    const r = this._domLayerMap.get(t8);
    r && (this._domLayerMap.set(t8, {
      ...r,
      ...n
    }), this._notice());
  }
  addFloatDom(t8) {
    this._domLayerMap.set(t8.id, t8), this._notice();
  }
  removeFloatDom(t8) {
    this._domLayerMap.delete(t8) && this._notice();
  }
  removeAll() {
    this._domLayerMap.clear(), this._notice();
  }
};
var to = (0, import_react2.memo)((e) => {
  var _3, $;
  const { layer: t8, id: n } = e, r = (0, import_react2.useMemo)(() => t8.position$.pipe(
    distinctUntilChanged(
      (R, B) => R.absolute.left === B.absolute.left && R.absolute.top === B.absolute.top && R.endX - R.startX === B.endX - B.startX && R.endY - R.startY === B.endY - B.startY
    )
  ), [t8.position$]), o = useDependency(vr), l = useObservable((0, import_react2.useMemo)(() => t8.position$.pipe(first()), [t8.position$])), i = (0, import_react2.useRef)(null), u = (0, import_react2.useRef)(null), d = (0, import_react2.useRef)(`transform: rotate(${l == null ? void 0 : l.rotate}deg) translate(${l == null ? void 0 : l.startX}px, ${l == null ? void 0 : l.startY}px)`), v2 = (0, import_react2.useRef)((_3 = l == null ? void 0 : l.startY) != null ? _3 : 0), g = (0, import_react2.useRef)(($ = l == null ? void 0 : l.startX) != null ? $ : 0), c = (0, import_react2.useRef)({}), m2 = typeof t8.componentKey == "string" ? useDependency(S1).get(t8.componentKey) : t8.componentKey, L = (0, import_react2.useMemo)(() => ({
    data: t8.data,
    ...t8.props
  }), [t8.data, t8.props]);
  (0, import_react2.useEffect)(() => {
    const R = t8.position$.subscribe((w) => {
      var E;
      d.current = `rotate(${w.rotate}deg)`, v2.current = w.startY, g.current = w.startX, i.current && (i.current.style.transform = d.current, i.current.style.top = `${v2.current}px`, i.current.style.left = `${g.current}px`, i.current.style.opacity = `${(E = w.opacity) != null ? E : 1}`);
    }), B = r.subscribe((w) => {
      if (i.current && (i.current.style.width = `${Math.max(w.endX - w.startX - 2, 0)}px`, i.current.style.height = `${Math.max(w.endY - w.startY - 2, 0)}px`), u.current) {
        const E = {
          width: `${w.width - 4}px`,
          height: `${w.height - 4}px`,
          left: `${w.absolute.left ? 0 : "auto"}`,
          top: `${w.absolute.top ? 0 : "auto"}`,
          right: `${w.absolute.left ? "auto" : 0}`,
          bottom: `${w.absolute.top ? "auto" : 0}`
        };
        u.current.style.width = E.width, u.current.style.height = E.height, u.current.style.left = E.left, u.current.style.top = E.top, u.current.style.right = E.right, u.current.style.bottom = E.bottom, c.current = E;
      }
    });
    return () => {
      R.unsubscribe(), B.unsubscribe();
    };
  }, [t8.position$, r]);
  const y = o.getUnit(t8.unitId), O2 = y instanceof Pt ? y.getDisabled() : void 0, S = (0, import_react2.useMemo)(() => m2 ? (0, import_jsx_runtime2.jsx)(
    m2,
    {
      ...L,
      unitId: t8.unitId,
      unit: y,
      floatDomId: t8.id,
      context: {
        docDisabled: O2,
        root: u
      }
    }
  ) : null, [m2, L]);
  return l ? (0, import_jsx_runtime2.jsx)(
    "div",
    {
      ref: i,
      className: "univer-z-10",
      style: {
        position: "absolute",
        top: v2.current,
        left: g.current,
        width: Math.max(l.endX - l.startX - 2, 0),
        height: Math.max(l.endY - l.startY - 2, 0),
        transform: d.current,
        overflow: "hidden",
        transformOrigin: "center center"
      },
      onPointerMove: (R) => {
        t8.onPointerMove(R.nativeEvent);
      },
      onPointerDown: (R) => {
        t8.onPointerDown(R.nativeEvent);
      },
      onPointerUp: (R) => {
        t8.onPointerUp(R.nativeEvent);
      },
      onWheel: (R) => {
        t8.onWheel(R.nativeEvent);
      },
      children: (0, import_jsx_runtime2.jsx)(
        "div",
        {
          id: n,
          ref: u,
          className: "univer-absolute univer-overflow-hidden",
          style: { ...c.current },
          children: S
        }
      )
    }
  ) : null;
});
var Gn3 = ({ unitId: e }) => {
  var i;
  const t8 = useDependency(vr), n = useDependency(nt2), r = useObservable(n.domLayers$), o = useObservable(t8.focused$), l = e || o;
  return (i = r == null ? void 0 : r.filter((u) => u[1].unitId === l)) == null ? void 0 : i.map((u) => (0, import_jsx_runtime2.jsx)(
    to,
    {
      id: u[0],
      layer: u[1]
    },
    u[0]
  ));
};
var rt3 = createIdentifier("ui.popup.service");
var Xn = class extends Ve {
  constructor() {
    super(...arguments);
    F(this, "_popupMap", /* @__PURE__ */ new Map());
    F(this, "_popups$", new BehaviorSubject([]));
    F(this, "popups$", this._popups$.asObservable());
    F(this, "_activePopupId", null);
  }
  get popups() {
    return Array.from(this._popupMap.entries());
  }
  get activePopupId() {
    return this._activePopupId;
  }
  _update() {
    this._popups$.next(Array.from(this._popupMap.entries()));
  }
  dispose() {
    super.dispose(), this._popups$.next([]), this._popups$.complete(), this._popupMap.clear();
  }
  addPopup(n) {
    const r = et();
    return this._popupMap.set(r, {
      ...n,
      onActiveChange: (o) => {
        o ? this._activePopupId = r : this._activePopupId === r && (this._activePopupId = null);
      }
    }), this._update(), r;
  }
  removePopup(n) {
    this._popupMap.delete(n) && this._update();
  }
  removeAll() {
    this._popupMap.clear(), this._update();
  }
};
var qn2 = (0, import_react2.createContext)({ current: void 0 });
var ee2 = 8;
function Jn(e) {
  const { position: t8, width: n, height: r, containerHeight: o, containerWidth: l, direction: i = "vertical", noPushMinimumGap: u = false } = e, d = u ? -1 / 0 : ee2, v2 = u ? 1 / 0 : o - r - ee2, g = u ? -1 / 0 : ee2, c = u ? 1 / 0 : l - n - ee2;
  if (i === "vertical" || i.indexOf("top") === 0 || i.indexOf("bottom") === 0) {
    const { left: $, top: R, right: B, bottom: w } = t8, E = i === "vertical" && w > v2 || i.indexOf("top") > -1 ? { top: Math.max(R - r, d) } : { top: Math.min(w, v2) };
    let T;
    if (i.includes("center")) {
      const A = (B - $ - n) / 2;
      T = Math.max($ + A, g) + n > l ? { left: Math.max(Math.min(c, B - n - A), g) } : { left: Math.max(g, Math.min($ + A, c)) };
    } else i.includes("right") ? T = { left: Math.max(B - n, g) } : i.includes("left") ? T = { left: Math.min($, c) } : T = $ + n > l ? Math.max(B - n, g) < ee2 ? { left: Math.min($, c) } : { left: Math.max(B - n, g) } : { left: Math.min($, c) };
    return { ...E, ...T };
  }
  const { left: m2, top: L, right: y, bottom: O2 } = t8, S = i.includes("left") ? { left: Math.max(m2 - n, g) } : { left: Math.min(y, c) };
  let _3;
  if (i.includes("center")) {
    const R = (O2 - L - r) / 2;
    _3 = Math.max(L + R, d) + r > o ? { top: Math.max(Math.min(v2, O2 - r - R), d) } : { top: Math.max(d, Math.min(L + R, v2)) };
  } else i.includes("top") ? _3 = {
    top: Math.min(L, v2)
  } : i.includes("bottom") ? _3 = {
    top: Math.max(O2 - r, d)
  } : _3 = L + r > o ? Math.max(O2 - r, d) < ee2 ? { top: Math.min(L, v2) } : { top: Math.max(O2 - r, d) } : { top: Math.min(L, v2) };
  return { ..._3, ...S };
}
function ot2(e) {
  var j;
  const {
    mask: t8,
    portal: n,
    children: r,
    anchorRect$: o,
    direction: l = "vertical",
    onClickOutside: i,
    excludeOutside: u,
    excludeRects: d,
    onPointerEnter: v2,
    onPointerLeave: g,
    onClick: c,
    hidden: m2,
    onContextMenu: L,
    zIndex: y = 1020,
    maskZIndex: O2 = 100,
    onMaskClick: S,
    noPushMinimumGap: _3,
    autoRelayout: $ = true
  } = e, R = (0, import_react2.useRef)(null), B = re(i != null ? i : () => {
  }), w = re(L != null ? L : () => {
  }), E = (0, import_react2.useRef)({
    top: -9999,
    left: -9999
  }), T = d, W = useDependency(ic), A = (0, import_react2.useRef)(void 0), U2 = W.getConfig(_e2), Y2 = (j = U2 == null ? void 0 : U2.popupRootId) != null ? j : "univer-popup-portal", X2 = re((z2) => {
    requestAnimationFrame(() => {
      if (!R.current) return;
      const { clientWidth: e12, clientHeight: u12 } = R.current, b12 = window.innerWidth, y12 = window.innerHeight;
      E.current = Jn(
        {
          position: z2,
          width: e12,
          height: u12,
          containerWidth: b12,
          containerHeight: y12,
          direction: l,
          noPushMinimumGap: _3
        }
      ), R.current.style.top = `${E.current.top}px`, R.current.style.left = `${E.current.left}px`;
    });
  });
  (0, import_react2.useEffect)(() => {
    let z2;
    return R.current && (z2 = new ResizeObserver(() => {
      $ && A.current && X2(A.current);
    }), z2.observe(R.current)), () => {
      z2 == null || z2.disconnect();
    };
  }, [R.current, $]), (0, import_react2.useEffect)(() => {
    const z2 = o.subscribe((e12) => {
      A.current = e12, X2(e12);
    });
    return () => z2.unsubscribe();
  }, [o, l]), (0, import_react2.useEffect)(() => {
    const z2 = (e12) => {
      var O12;
      if (u && (u.indexOf(e12.target) > -1 || u.some(
        (s13) => s13.contains(e12.target)
      )))
        return;
      const u12 = e12.clientX, b12 = e12.clientY, y12 = [...(O12 = T == null ? void 0 : T.current) != null ? O12 : []];
      A.current && y12.push(A.current);
      for (const s13 of y12)
        if (u12 <= s13.right && u12 >= s13.left && b12 <= s13.bottom && b12 >= s13.top)
          return;
      B(e12);
    };
    return window.addEventListener("pointerdown", z2), () => {
      window.removeEventListener("pointerdown", z2);
    };
  }, [B, u, T]), (0, import_react2.useEffect)(() => {
    const z2 = (e12) => {
      e12.ctrlKey && e12.button === 0 || w();
    };
    return window.addEventListener("contextmenu", z2), () => {
      window.removeEventListener("contextmenu", z2);
    };
  }, [w]);
  const K7 = (0, import_jsx_runtime2.jsxs)(import_jsx_runtime2.Fragment, { children: [
    t8 && (0, import_jsx_runtime2.jsx)(
      "div",
      {
        "data-u-comp": "rect-popup-mask",
        className: "univer-fixed univer-bottom-0 univer-left-0 univer-right-0 univer-top-0 univer-z-[100]",
        style: { zIndex: O2 },
        onClick: S
      }
    ),
    (0, import_jsx_runtime2.jsx)(
      "section",
      {
        "data-u-comp": "rect-popup",
        ref: R,
        className: ie2("univer-pointer-events-auto univer-fixed univer-left-[-9999px] univer-top-[-9999px] univer-z-[1020]", {
          "univer-hidden": m2,
          "univer-animate-in univer-fade-in-70": !m2
        }),
        style: { ...E.current, zIndex: y },
        onPointerDown: (z2) => z2.stopPropagation(),
        onClick: c,
        onPointerEnter: v2,
        onPointerLeave: g,
        children: (0, import_jsx_runtime2.jsx)(qn2.Provider, { value: A, children: r })
      }
    )
  ] });
  return n ? document.getElementById(Y2) ? (0, import_react_dom.createPortal)(K7, document.getElementById(Y2)) : null : K7;
}
ot2.calcPopupPosition = Jn;
ot2.useContext = () => (0, import_react2.useContext)(qn2);
var no = ({ popup: e, children: t8 }) => {
  const [n, r] = (0, import_react2.useState)(false), o = (0, import_react2.useMemo)(() => e.anchorRect$.pipe(
    throttleTime(0, animationFrameScheduler),
    map((c) => {
      var $;
      const { bottom: m2, left: L, right: y, top: O2 } = c, [S = 0, _3 = 0] = ($ = e.offset) != null ? $ : [];
      return {
        left: L - S,
        right: y + S,
        top: O2 - _3,
        bottom: m2 + _3
      };
    })
  ), [e.anchorRect$, e.offset]), l = (0, import_react2.useMemo)(() => {
    var c, m2;
    return (m2 = (c = e.hiddenRects$) == null ? void 0 : c.pipe(throttleTime(0, animationFrameScheduler))) != null ? m2 : of([]);
  }, [e.hiddenRects$]), i = (0, import_react2.useMemo)(() => {
    var c;
    return (c = e.excludeRects$) == null ? void 0 : c.pipe(throttleTime(0, animationFrameScheduler));
  }, [e.excludeRects$]), u = d5(i, e.excludeRects), { canvasElement: d, hideOnInvisible: v2 = true, hiddenType: g = "destroy" } = e;
  return (0, import_react2.useEffect)(() => {
    if (!v2)
      return;
    const c = combineLatest([o, l]).subscribe(([m2, L]) => {
      const y = d.getBoundingClientRect(), { top: O2, left: S, bottom: _3, right: $ } = y, R = m2.bottom - m2.top, B = m2.right - m2.left, w = L.some((E) => m2.top >= E.top - 0.5 * R && m2.bottom <= E.bottom + 0.5 * R && m2.left >= E.left - 0.5 * B && m2.right <= E.right + 0.5 * B);
      m2.bottom < O2 || m2.top > _3 || m2.right < S || m2.left > $ || w ? r(true) : r(false);
    });
    return () => c.unsubscribe();
  }, [d, v2, o, l]), n && g === "destroy" ? null : (0, import_jsx_runtime2.jsx)(
    ot2,
    {
      ...e,
      hidden: n,
      anchorRect$: o,
      direction: e.direction,
      onClickOutside: e.onClickOutside,
      excludeOutside: e.excludeOutside,
      excludeRects: u,
      ...e.customActive ? null : {
        onPointerEnter: () => {
          var c;
          return (c = e.onActiveChange) == null ? void 0 : c.call(e, true);
        },
        onPointerLeave: () => {
          var c;
          return (c = e.onActiveChange) == null ? void 0 : c.call(e, false);
        }
      },
      onClick: e.onClick,
      onContextMenu: e.onContextMenu,
      children: t8
    }
  );
};
function Qn() {
  const e = useDependency(rt3), t8 = useDependency(S1);
  return useObservable(e.popups$, void 0, true).map((r) => {
    const [o, l] = r, i = t8.get(l.componentKey);
    return (0, import_jsx_runtime2.jsx)(
      no,
      {
        popup: l,
        children: i ? (0, import_jsx_runtime2.jsx)(i, { popup: l }) : null
      },
      o
    );
  });
}
function I13(e) {
  const { components: t8, fallback: n, sharedProps: r } = e;
  return !t8 || t8.size === 0 ? n != null ? n : null : Array.from(t8.values()).map((o, l) => {
    var i;
    return (0, import_react2.createElement)(o, { key: `${(i = o.displayName) != null ? i : l}`, ...r });
  });
}
function M1(e, t8) {
  var u;
  const n = (u = t8 == null ? void 0 : t8.get(D1)) != null ? u : useDependency(D1), r = (0, import_react2.useMemo)(() => n.uiVisibleChange$.pipe(filter((d) => d.ui === e)), [e, n]), o = useObservable(r), l = (0, import_react2.useRef)(0), i = useObservable(
    () => n.componentRegistered$.pipe(
      filter((d) => d === e),
      debounceTime(200),
      map(() => l.current += 1),
      startWith(l.current += 1)
      // trigger update when subscribe
    ),
    void 0,
    void 0,
    [n, e, o]
  );
  return (0, import_react2.useMemo)(() => n.isUIVisible(e) ? n.getComponents(e) : /* @__PURE__ */ new Set(), [i]);
}
var Kn = `
univer-box-border univer-flex univer-h-6 univer-min-w-6 univer-cursor-pointer univer-items-center
univer-justify-center univer-rounded univer-border-none univer-bg-transparent univer-p-0
univer-text-gray-900 univer-outline-none univer-transition-colors univer-animate-in univer-fade-in
dark:!univer-text-white dark:hover:!univer-bg-gray-700 dark:disabled:!univer-text-gray-600
disabled:univer-cursor-not-allowed disabled:univer-text-gray-300 disabled:hover:univer-bg-transparent
hover:univer-bg-gray-100 whitespace-nowrap univer-w-max
`;
function ro(e) {
  const {
    children: t8,
    className: n,
    style: r,
    disabled: o = false,
    active: l = false,
    noIcon: i,
    onClick: u,
    onDoubleClick: d,
    ...v2
  } = e, g = (m2) => {
    if (o) {
      m2.preventDefault();
      return;
    }
    u && u(m2);
  }, c = (m2) => {
    if (o) {
      m2.preventDefault();
      return;
    }
    d && d(m2);
  };
  return (0, import_jsx_runtime2.jsx)(
    "button",
    {
      type: "button",
      className: ie2(Kn, {
        "univer-px-2": i,
        "!univer-bg-gray-200 dark:!univer-bg-gray-500": l
      }),
      style: r,
      disabled: o,
      onClick: g,
      onDoubleClick: c,
      ...v2,
      children: t8
    }
  );
}
function oo2(e) {
  const { disabled$: t8, hidden$: n, activated$: r, value$: o } = e, [l, i] = (0, import_react2.useState)(), [u, d] = (0, import_react2.useState)(false), [v2, g] = (0, import_react2.useState)(false), [c, m2] = (0, import_react2.useState)(false);
  return (0, import_react2.useEffect)(() => {
    const L = [];
    return t8 && L.push(t8.subscribe((y) => d(y))), n && L.push(n.subscribe((y) => m2(y))), r && L.push(r.subscribe((y) => g(y))), o && L.push(o.subscribe((y) => i(y))), () => L.forEach((y) => y.unsubscribe());
  }, [r, t8, n, o]), { disabled: u, value: l, activated: v2, hidden: c };
}
var it = (0, import_react2.createContext)({
  dropdownVisible: false,
  setDropdownVisible: (e) => {
  }
});
var io = (0, import_react2.forwardRef)((e, t8) => {
  const { children: n, ...r } = e, o = (0, import_react2.useRef)(null), [l, i] = (0, import_react2.useState)(false), [u, d] = (0, import_react2.useState)(false);
  function v2(m2) {
    i(u ? false : m2);
  }
  function g(m2) {
    d(m2), i(false);
  }
  const c = (0, import_react2.useMemo)(() => ({
    dropdownVisible: u,
    setDropdownVisible: g
  }), [u]);
  return (0, import_react2.useImperativeHandle)(t8, () => ({
    el: o.current
  })), r.title ? (0, import_jsx_runtime2.jsx)(
    Rp,
    {
      visible: l,
      onVisibleChange: v2,
      ...r,
      children: (0, import_jsx_runtime2.jsx)("span", { ref: o, children: (0, import_jsx_runtime2.jsx)(it.Provider, { value: c, children: n }) })
    }
  ) : (0, import_jsx_runtime2.jsx)("span", { ref: o, children: n });
});
function lo(e) {
  const { children: t8, overlay: n, disabled: r, align: o = "start" } = e, { dropdownVisible: l, setDropdownVisible: i } = (0, import_react2.useContext)(it);
  function u(d) {
    i(d);
  }
  return (0, import_jsx_runtime2.jsx)(
    vf2,
    {
      align: o,
      overlay: (0, import_jsx_runtime2.jsx)("div", { className: "univer-grid univer-gap-2", children: n }),
      disabled: r,
      open: l,
      onOpenChange: u,
      children: (0, import_jsx_runtime2.jsx)("div", { className: "univer-h-full", onClick: (d) => d.stopPropagation(), children: t8 })
    }
  );
}
function Ve3({ icon: e, value: t8, option: n, onOptionSelect: r }) {
  var i;
  const o = (u) => {
    r == null || r({ value: u, label: n == null ? void 0 : n.label, commandId: n == null ? void 0 : n.commandId });
  }, l = typeof n.label == "string" || typeof n.label == "object" && ((i = n.label) == null ? void 0 : i.selectable) !== false;
  return (0, import_jsx_runtime2.jsxs)(
    "div",
    {
      className: ie2("univer-relative univer-flex univer-items-center univer-gap-2", {
        "univer-pl-6": l
      }),
      children: [
        l && String(t8) === String(n.value) && (0, import_jsx_runtime2.jsx)(
          X3,
          {
            className: "univer-absolute univer-left-1 univer-top-0.5 univer-text-primary-600"
          }
        ),
        (0, import_jsx_runtime2.jsx)(
          _12,
          {
            className: "univer-text-sm",
            icon: e,
            value$: n.value$,
            value: n.value,
            label: n.label,
            onChange: o
          }
        )
      ]
    }
  );
}
function Xt({
  menuId: e,
  slot: t8,
  value: n,
  options: r,
  children: o,
  disabled: l,
  onOptionSelect: i
}) {
  var O2;
  const { dropdownVisible: u, setDropdownVisible: d } = (0, import_react2.useContext)(it), v2 = useDependency(B12), [g, c] = (0, import_react2.useState)({}), m2 = (0, import_react2.useMemo)(() => e ? v2.getMenuByPositionKey(e) : [], [e]), L = (0, import_react2.useMemo)(() => m2.filter((S) => {
    var $;
    if (!S.children)
      return !g[S.key];
    const _3 = (($ = S.key) == null ? void 0 : $.toString()) || "";
    return !g[_3];
  }), [m2, g]);
  function y(S) {
    d(S);
  }
  if ((0, import_react2.useEffect)(() => {
    const S = [];
    return m2.forEach((_3) => {
      var $;
      if (_3.children) {
        const R = _3.children.map((w) => {
          var E, T;
          return (T = (E = w.item) == null ? void 0 : E.hidden$) != null ? T : of(false);
        }), B = combineLatest(R).subscribe((w) => {
          const E = w.every((T) => T === true);
          c((T) => ({
            ...T,
            [_3.key]: E
          }));
        });
        S.push(B);
      } else if (($ = _3.item) != null && $.hidden$) {
        const R = _3.item.hidden$.subscribe((B) => {
          c((w) => ({
            ...w,
            [_3.key]: B
          }));
        });
        S.push(R);
      }
    }), () => {
      S.forEach((_3) => _3 == null ? void 0 : _3.unsubscribe()), c({});
    };
  }, [m2]), t8)
    return (0, import_jsx_runtime2.jsx)(
      lo,
      {
        disabled: l,
        overlay: r.map((S, _3) => (0, import_jsx_runtime2.jsx)(
          Ve3,
          {
            value: n,
            option: S,
            onOptionSelect: i
          },
          _3
        )),
        children: o
      }
    );
  if (r != null && r.length) {
    const S = r.map((_3) => {
      var $;
      return {
        type: "item",
        className: ie2({
          "focus:univer-bg-white": typeof _3.label != "string" && (($ = _3.label) == null ? void 0 : $.hoverable) === false
        }),
        children: (0, import_jsx_runtime2.jsx)(
          Ve3,
          {
            icon: _3.icon,
            value: n,
            option: _3,
            onOptionSelect: i
          }
        ),
        disabled: _3.disabled,
        onSelect: () => {
          typeof _3.value > "u" || i == null || i({
            ..._3
          });
        }
      };
    });
    for (const _3 of L) {
      if (!_3.item) continue;
      const { title: $, id: R, commandId: B, icon: w } = _3.item;
      if (!$)
        throw new Error("Menu item title is required");
      S.push({
        type: "item",
        children: (0, import_jsx_runtime2.jsx)(
          Ve3,
          {
            icon: w,
            value: n,
            option: {
              label: {
                name: $,
                selectable: false
              }
            }
          }
        ),
        onSelect: () => {
          i == null || i({
            commandId: B,
            id: R
          });
        }
      });
    }
    return (0, import_jsx_runtime2.jsx)(
      ep,
      {
        align: "start",
        items: S,
        disabled: l,
        open: u,
        onOpenChange: y,
        children: o
      }
    );
  } else {
    const S = [];
    for (const _3 of L)
      if (_3.item) {
        const { title: $, id: R, commandId: B, icon: w } = _3.item;
        if (!$)
          throw new Error("Menu item title is required");
        S.push({
          type: "item",
          children: (0, import_jsx_runtime2.jsx)(
            Ve3,
            {
              icon: w,
              value: n,
              option: {
                label: {
                  name: $,
                  selectable: false
                }
              }
            }
          ),
          onSelect: () => {
            i == null || i({
              commandId: B,
              id: R
            });
          }
        });
      } else (O2 = _3.children) != null && O2.length;
    return (0, import_jsx_runtime2.jsx)(
      ep,
      {
        align: "start",
        items: S,
        disabled: l,
        open: u,
        onOpenChange: y,
        children: o
      }
    );
  }
}
var Oe = (0, import_react2.forwardRef)((e, t8) => {
  const n = useDependency(Fn), r = useDependency(Ls), o = useDependency(U1), l = useDependency(S1), { value: i, hidden: u, disabled: d, activated: v2 } = oo2(e), g = (j, z2) => {
    o.focus(), r.executeCommand(j, z2);
  }, { tooltip: c, shortcut: m2, icon: L, title: y, label: O2, id: S, commandId: _3, type: $, slot: R, params: B } = e, w = n.t(c != null ? c : "") + (m2 ? ` (${m2})` : ""), { selections: E } = e, T = (0, import_react2.useMemo)(() => isObservable(E) ? E : new Observable((j) => {
    j.next(E);
  }), [E]), W = useObservable(T), A = (0, import_react2.useMemo)(() => isObservable(L) ? L : new Observable((j) => {
    var e12, u12;
    const z2 = (u12 = (e12 = W == null ? void 0 : W.find((b12) => b12.value === i)) == null ? void 0 : e12.icon) != null ? u12 : L;
    j.next(z2);
  }), [L, W, i]), U2 = useObservable(A, void 0, true);
  function Y2(j) {
    var s13;
    const z2 = e.selectionsCommandId, e12 = _3 != null ? _3 : S, u12 = (s13 = z2 != null ? z2 : _3) != null ? s13 : S;
    function b12(l12) {
      if (d) return;
      let p12 = u12;
      l12.id && (p12 = l12.id), g(p12, { value: l12.value });
    }
    function y12(l12) {
      d || g(u12, { value: l12 });
    }
    function O12() {
      d || j === H1.BUTTON_SELECTOR && g(e12, { value: i });
    }
    return j === H1.BUTTON_SELECTOR ? (0, import_jsx_runtime2.jsxs)(
      "div",
      {
        "data-u-command": S,
        "data-disabled": d,
        className: ie2("univer-animate-in univer-fade-in univer-group univer-relative univer-flex univer-h-6 univer-cursor-pointer univer-items-center univer-rounded univer-pr-5 univer-text-sm univer-transition-colors hover:univer-bg-gray-100 dark:hover:!univer-bg-gray-700", {
          "univer-text-gray-900 dark:!univer-text-white": !d,
          "univer-pointer-events-none univer-cursor-not-allowed univer-text-gray-300 dark:!univer-text-gray-600": d
        }),
        children: [
          (0, import_jsx_runtime2.jsx)(
            "div",
            {
              className: ie2("univer-relative univer-z-[1] univer-flex univer-h-full univer-items-center univer-rounded-l univer-px-1 univer-transition-colors hover:univer-bg-gray-200 dark:hover:!univer-bg-gray-600", {
                "univer-bg-gray-200 dark:!univer-bg-gray-500": v2,
                "univer-bg-gray-100": v2 && d
              }),
              onClick: O12,
              children: (0, import_jsx_runtime2.jsx)(
                _12,
                {
                  icon: U2,
                  title: y,
                  value: i,
                  label: O2,
                  onChange: y12
                }
              )
            }
          ),
          (0, import_jsx_runtime2.jsx)(
            Xt,
            {
              menuId: S,
              slot: R,
              value: i,
              options: W,
              disabled: d,
              onOptionSelect: b12,
              children: (0, import_jsx_runtime2.jsx)(
                "div",
                {
                  className: ie2("univer-absolute univer-right-0 univer-top-0 univer-box-border univer-flex univer-h-6 univer-w-5 univer-items-center univer-justify-center univer-rounded-r univer-transition-colors hover:univer-bg-gray-200 dark:hover:!univer-bg-gray-600", {
                    "univer-pointer-events-none univer-cursor-not-allowed univer-text-gray-300 dark:!univer-text-gray-600": d,
                    "univer-bg-gray-200 dark:!univer-bg-gray-500": v2,
                    "univer-bg-gray-100": v2 && d
                  }),
                  "data-disabled": d,
                  children: (0, import_jsx_runtime2.jsx)(me2, {})
                }
              )
            }
          )
        ]
      }
    ) : (0, import_jsx_runtime2.jsx)(
      Xt,
      {
        menuId: S,
        slot: R,
        value: i,
        options: W,
        disabled: d,
        onOptionSelect: b12,
        children: (0, import_jsx_runtime2.jsxs)(
          "div",
          {
            "data-u-command": S,
            className: ie2("univer-animate-in univer-fade-in univer-relative univer-flex univer-h-6 univer-cursor-pointer univer-items-center univer-gap-2 univer-whitespace-nowrap univer-rounded univer-px-1 univer-transition-colors hover:univer-bg-gray-100 dark:hover:!univer-bg-gray-700", {
              "univer-text-gray-900 dark:!univer-text-white": !d,
              "univer-pointer-events-none univer-cursor-not-allowed univer-text-gray-300 dark:!univer-text-gray-600": d,
              "univer-bg-gray-200": v2,
              "univer-bg-gray-100": v2 && d
            }),
            children: [
              (0, import_jsx_runtime2.jsx)(
                _12,
                {
                  icon: U2,
                  title: y,
                  value: i,
                  label: O2,
                  onChange: y12
                }
              ),
              (0, import_jsx_runtime2.jsx)(
                "div",
                {
                  className: ie2("univer-flex univer-h-full univer-items-center", {
                    "univer-pointer-events-none univer-cursor-not-allowed univer-text-gray-300 dark:!univer-text-gray-600": d
                  }),
                  children: (0, import_jsx_runtime2.jsx)(me2, {})
                }
              )
            ]
          }
        )
      }
    );
  }
  function X2() {
    var z2;
    const j = l.get(typeof O2 == "string" ? O2 : (z2 = O2 == null ? void 0 : O2.name) != null ? z2 : "");
    return (0, import_jsx_runtime2.jsx)(
      ro,
      {
        "data-u-command": S,
        className: "univer-text-sm",
        noIcon: !L,
        active: v2,
        disabled: d,
        onClick: () => {
          var e12;
          return g((e12 = e.commandId) != null ? e12 : e.id, i != null ? i : B);
        },
        onDoubleClick: () => e.subId && g(e.subId),
        children: j ? (0, import_jsx_runtime2.jsx)(_12, { title: y, value: i, label: O2 }) : L ? (0, import_jsx_runtime2.jsx)(_12, { icon: L }) : (0, import_jsx_runtime2.jsx)(_12, { title: y })
      }
    );
  }
  function K7() {
    switch ($) {
      case H1.BUTTON_SELECTOR:
      case H1.SELECTOR:
      case H1.SUBITEMS:
        return Y2($);
      case H1.BUTTON:
      default:
        return X2();
    }
  }
  return !u && (0, import_jsx_runtime2.jsx)(
    io,
    {
      ref: t8,
      title: w,
      placement: "bottom",
      children: K7()
    }
  );
});
var so = {
  [w1.START]: h6,
  [w1.INSERT]: g6,
  [w1.FORMULAS]: J3,
  [w1.DATA]: J9,
  [w1.VIEW]: n6,
  [w1.OTHERS]: Q3
};
function ao2(e) {
  const { ribbonType: t8, headerMenuComponents: n, headerMenu: r = true } = e, o = useDependency(B12), l = useDependency(vr), i = useDependency(Fn), [u, d] = (0, import_react2.useState)(0), v2 = useObservable(l.focused$);
  (0, import_react2.useEffect)(() => {
    const A = o.menuChanged$.subscribe(() => {
      d((U2) => U2 + 1);
    });
    return () => {
      A.unsubscribe();
    };
  }, []);
  const g = (0, import_react2.useRef)(null), c = (0, import_react2.useRef)({}), [m2, L] = (0, import_react2.useState)([]), [y, O2] = (0, import_react2.useState)(w1.START), [S, _3] = (0, import_react2.useState)(false), [$, R] = (0, import_react2.useState)([]), [B, w] = (0, import_react2.useState)(false), E = (0, import_react2.useCallback)((A) => {
    c.current = {}, O2(A.key), _3(false);
  }, []);
  (0, import_react2.useEffect)(() => {
    var X2;
    const A = o.getMenuByPositionKey(ke3.RIBBON), U2 = [], Y2 = [];
    for (const K7 of A)
      if (K7.children) {
        for (const j of K7.children)
          if (j.children)
            for (const z2 of j.children)
              (X2 = z2.item) != null && X2.hidden$ && (U2.push(z2.item.hidden$), Y2.push(`${K7.key}/${j.key}/${z2.key}`));
      }
    combineLatest(U2).subscribe((K7) => {
      var e12, u12, b12, y12, O12, s13;
      const j = [], z2 = K7.map((l12, p12) => l12 ? Y2[p12] : null).filter((l12) => !!l12);
      for (const l12 of A) {
        const p12 = { ...l12, children: [] };
        if ((e12 = l12.children) != null && e12.length)
          for (const R12 of l12.children) {
            const T12 = { ...R12, children: [] };
            let z13 = true;
            if ((u12 = R12.children) != null && u12.length) {
              for (const J12 of R12.children) {
                const Q12 = `${l12.key}/${R12.key}/${J12.key}`;
                z2.includes(Q12) || (b12 = T12.children) == null || b12.push(J12);
              }
              (y12 = T12.children) != null && y12.every((J12) => {
                var Q12;
                return ((Q12 = J12.children) == null ? void 0 : Q12.length) === 0;
              }) && (z13 = false);
            }
            z13 && ((O12 = p12.children) == null || O12.push(T12));
          }
        (s13 = p12.children) != null && s13.length && p12.children.every((R12) => {
          var T12;
          return (T12 = R12.children) == null ? void 0 : T12.length;
        }) && j.push(p12);
      }
      if (t8 === "simple") {
        const l12 = [{ key: w1.START, children: [], order: 0 }];
        j.forEach((p12) => {
          var R12;
          (R12 = p12.children) == null || R12.forEach((T12) => {
            var z13;
            (z13 = l12[0].children) == null || z13.push(T12);
          });
        }), L(l12);
      } else
        L(j);
    }).unsubscribe();
  }, [u, v2]);
  const T = (0, import_react2.useMemo)(() => {
    var X2, K7;
    const A = (K7 = (X2 = m2.find((j) => j.key === y)) == null ? void 0 : X2.children) != null ? K7 : [], U2 = [], Y2 = [];
    for (const j of A)
      if (j.children) {
        const z2 = j.children.filter((e12) => !$.includes(e12.key));
        z2.length > 0 && U2.push({
          ...j,
          children: z2
        }), z2.length < j.children.length && Y2.push({
          ...j,
          children: j.children.filter((e12) => $.includes(e12.key))
        });
      }
    return {
      allGroups: A,
      visibleGroups: U2,
      hiddenGroups: Y2
    };
  }, [$, m2, y]);
  (0, import_react2.useEffect)(() => {
    let A = null;
    const U2 = new ResizeObserver(XC((Y2) => {
      for (const X2 of Y2)
        w(true), A = requestAnimationFrame(() => {
          var O12, s13;
          const { width: K7 } = X2.contentRect, z2 = Object.values(c.current).sort((l12, p12) => l12.order - p12.order || l12.groupOrder - p12.groupOrder || l12.itemOrder - p12.itemOrder), e12 = [];
          let u12 = 32;
          const y12 = (((s13 = (O12 = m2.find((l12) => l12.key === y)) == null ? void 0 : O12.children) != null ? s13 : []).length - 1) * 8;
          u12 += y12;
          for (const { el: l12, key: p12 } of z2) {
            const { width: R12 } = l12.getBoundingClientRect();
            u12 += R12 + 8, u12 > K7 && e12.push(p12);
          }
          R(e12), w(false);
        });
    }, 100));
    return U2.observe(g.current), () => {
      A && cancelAnimationFrame(A), U2.disconnect();
    };
  }, [m2, y]);
  const W = (0, import_react2.useMemo)(() => (0, import_jsx_runtime2.jsx)(
    "div",
    {
      "aria-hidden": "true",
      className: ie2("univer-invisible univer-absolute -univer-left-[99999] -univer-top-[99999] univer-box-border univer-flex univer-h-10 univer-min-w-min univer-items-center univer-px-3 univer-opacity-0", {
        "univer-hidden": !B
      }, rE, eE),
      children: T.allGroups.map((A, U2) => {
        var Y2, X2;
        return (((Y2 = A.children) == null ? void 0 : Y2.length) || A.item) && (0, import_jsx_runtime2.jsx)(import_react2.Fragment, { children: (0, import_jsx_runtime2.jsx)("div", { className: "univer-grid univer-shrink-0 univer-grid-flow-col univer-gap-2 univer-px-2", children: A.children && ((X2 = A.children) == null ? void 0 : X2.map((K7) => K7.item && (0, import_jsx_runtime2.jsx)(
          Oe,
          {
            ...K7.item,
            ref: (j) => {
              j != null && j.el && (c.current[K7.key] = {
                el: j.el,
                key: K7.key,
                order: U2,
                groupOrder: A.order,
                itemOrder: K7.order
              });
            }
          },
          K7.key
        ))) }) }, A.key);
      })
    }
  ), [T.allGroups, B]);
  return (0, import_jsx_runtime2.jsxs)(import_jsx_runtime2.Fragment, { children: [
    r && n && n.size > 0 && (0, import_jsx_runtime2.jsx)("header", { className: ie2("univer-relative univer-h-11 univer-select-none", eE), children: (0, import_jsx_runtime2.jsx)(
      "div",
      {
        className: "univer-absolute univer-right-2 univer-top-0 univer-flex univer-h-full univer-items-center univer-gap-2 [&>*]:univer-inline-flex [&>*]:univer-h-6 [&>*]:univer-items-center [&>*]:univer-rounded [&>*]:univer-px-1 [&>*]:univer-transition-colors hover:[&>*]:univer-bg-gray-100",
        children: (0, import_jsx_runtime2.jsx)(I13, { components: n })
      }
    ) }),
    (0, import_jsx_runtime2.jsxs)(
      "div",
      {
        className: ie2("univer-box-border univer-grid univer-h-10 univer-grid-flow-col univer-items-center univer-px-3", {
          "univer-grid-cols-[auto,1fr]": m2.length > 1,
          "univer-grid-cols-none": m2.length === 1
        }, eE),
        children: [
          m2.length > 1 && (0, import_jsx_runtime2.jsx)(
            wE,
            {
              className: "univer-max-w-96 !univer-rounded-xl",
              align: "start",
              open: S,
              overlay: (0, import_jsx_runtime2.jsx)("div", { className: "univer-grid univer-gap-1 univer-px-2 univer-py-1", children: m2.map((A) => {
                const U2 = so[A.key];
                return (0, import_jsx_runtime2.jsxs)(
                  "a",
                  {
                    "data-u-comp": "ribbon-group-btn",
                    className: "univer-box-border univer-flex univer-cursor-pointer univer-items-center univer-gap-2.5 univer-rounded-lg univer-px-2 univer-py-1.5 hover:univer-bg-gray-100 dark:hover:!univer-bg-gray-700",
                    onClick: () => E(A),
                    children: [
                      (0, import_jsx_runtime2.jsx)(
                        "span",
                        {
                          className: ie2("univer-box-border univer-flex univer-size-9 univer-flex-shrink-0 univer-items-center univer-justify-center univer-rounded-lg", kt2),
                          children: (0, import_jsx_runtime2.jsx)(
                            U2,
                            {
                              className: "univer-text-gray-500 dark:!univer-text-gray-300"
                            }
                          )
                        }
                      ),
                      (0, import_jsx_runtime2.jsxs)("span", { className: "univer-flex univer-flex-col", children: [
                        (0, import_jsx_runtime2.jsx)(
                          "strong",
                          {
                            className: "univer-text-sm univer-font-semibold univer-text-gray-800 dark:!univer-text-gray-200",
                            children: i.t(A.key)
                          }
                        ),
                        (0, import_jsx_runtime2.jsx)("span", { className: "univer-text-xs univer-text-gray-400", children: i.t(`${A.key}Desc`) })
                      ] })
                    ]
                  },
                  A.key
                );
              }) }),
              onOpenChange: _3,
              children: (0, import_jsx_runtime2.jsxs)(
                "a",
                {
                  className: "univer-mr-2 univer-flex univer-h-7 univer-cursor-pointer univer-items-center univer-gap-1.5 univer-whitespace-nowrap !univer-rounded-full univer-bg-gray-700 univer-pl-3 univer-pr-2 univer-text-sm univer-text-white dark:!univer-bg-gray-200 dark:!univer-text-gray-800",
                  onClick: () => _3(true),
                  children: [
                    i.t(y),
                    (0, import_jsx_runtime2.jsx)(
                      me2,
                      {
                        className: "univer-text-gray-200 dark:!univer-text-gray-500"
                      }
                    )
                  ]
                }
              )
            }
          ),
          (0, import_jsx_runtime2.jsxs)(
            "div",
            {
              "data-u-comp": "ribbon-toolbar",
              ref: g,
              className: ie2("univer-flex univer-overflow-hidden", rE),
              children: [
                T.visibleGroups.map((A) => {
                  var U2, Y2;
                  return (((U2 = A.children) == null ? void 0 : U2.length) || A.item) && (0, import_jsx_runtime2.jsx)(import_react2.Fragment, { children: (0, import_jsx_runtime2.jsx)("div", { className: "univer-grid univer-shrink-0 univer-grid-flow-col univer-gap-2 univer-px-2", children: A.children && ((Y2 = A.children) == null ? void 0 : Y2.map((X2) => X2.item && (0, import_jsx_runtime2.jsx)(Oe, { ...X2.item }, X2.key))) }) }, A.key);
                }),
                $.length > 0 && (0, import_jsx_runtime2.jsx)(
                  "div",
                  {
                    "data-u-comp": "ribbon-toolbar-more",
                    className: "univer-pl-2 rtl:univer-pr-2",
                    children: (0, import_jsx_runtime2.jsx)(
                      vf2,
                      {
                        collisionPadding: { right: 12, left: 12 },
                        overlay: (0, import_jsx_runtime2.jsx)(
                          "div",
                          {
                            className: "univer-box-border univer-grid univer-max-w-[var(--radix-popper-available-width)] univer-gap-2 univer-p-2",
                            children: T.hiddenGroups.map((A) => {
                              var U2;
                              return (0, import_jsx_runtime2.jsx)(
                                "div",
                                {
                                  className: "univer-flex univer-items-center univer-gap-2",
                                  children: (0, import_jsx_runtime2.jsx)("div", { className: "univer-flex univer-flex-wrap univer-gap-2", children: A.children ? (U2 = A.children) == null ? void 0 : U2.map((Y2) => Y2.item && (0, import_jsx_runtime2.jsx)(Oe, { ...Y2.item }, Y2.key)) : A.item && (0, import_jsx_runtime2.jsx)(Oe, { ...A.item }, A.key) })
                                },
                                A.key
                              );
                            })
                          }
                        ),
                        children: (0, import_jsx_runtime2.jsx)("a", { className: Kn, type: "button", children: (0, import_jsx_runtime2.jsx)(Q3, {}) })
                      }
                    )
                  }
                )
              ]
            }
          )
        ]
      }
    ),
    W
  ] });
}
var a3 = class extends Ve {
  constructor() {
    super(...arguments);
    F(this, "_styleSheetId", "univer-theme-css-variables");
  }
  injectThemeToHead(n) {
    function r(u, d = "--univer") {
      const v2 = [];
      function g(c, m2 = "") {
        for (const L in c) {
          const y = c[L], O2 = m2 ? `${m2}-${L}` : L;
          typeof y == "object" && y !== null ? g(y, O2) : v2.push(`${d}-${O2}: ${y};`);
        }
      }
      return g(u), v2.join(`
`);
    }
    const o = r(n), l = document.getElementById(this._styleSheetId);
    l && l.remove();
    const i = document.createElement("style");
    i.setAttribute("id", this._styleSheetId), i.innerHTML = `:root {
${o}
}`, document.head.appendChild(i);
  }
  dispose() {
    super.dispose();
  }
};
var c32 = createIdentifier("ui.contextmenu.service");
var er = class extends Ve {
  constructor() {
    super(...arguments);
    F(this, "_currentHandler", null);
    F(this, "disabled", false);
  }
  get visible() {
    var n, r;
    return (r = (n = this._currentHandler) == null ? void 0 : n.visible) != null ? r : false;
  }
  disable() {
    this.disabled = true;
  }
  enable() {
    this.disabled = false;
  }
  triggerContextMenu(n, r) {
    var o;
    n.stopPropagation(), !this.disabled && ((o = this._currentHandler) == null || o.handleContextMenu(n, r));
  }
  hideContextMenu() {
    var n;
    (n = this._currentHandler) == null || n.hideContextMenu();
  }
  registerContextMenuHandler(n) {
    if (this._currentHandler)
      throw new Error("There is already a context menu handler!");
    return this._currentHandler = n, We(() => this._currentHandler = null);
  }
};
function co() {
  const e = (0, import_react2.useRef)(null), [t8, n] = (0, import_react2.useState)(false), [r, o] = (0, import_react2.useState)(""), [l, i] = (0, import_react2.useState)([0, 0]), u = (0, import_react2.useRef)(t8), d = useDependency(c32), v2 = useDependency(Ls), g = useInjector();
  u.current = t8, (0, import_react2.useEffect)(() => {
    const L = d.registerContextMenuHandler({
      handleContextMenu: c,
      hideContextMenu() {
        n(false);
      },
      get visible() {
        return u.current;
      }
    });
    function y(O2) {
      e.current && !e.current.contains(O2.target) && m2();
    }
    return document.addEventListener("pointerdown", y), document.addEventListener("wheel", m2), () => {
      document.removeEventListener("pointerdown", y), document.removeEventListener("wheel", m2), L.dispose();
    };
  }, [d]);
  function c(L, y) {
    n(false), requestAnimationFrame(() => {
      o(y), i([L.clientX, L.clientY]), n(true);
    });
  }
  function m2() {
    n(false);
  }
  return (0, import_jsx_runtime2.jsx)(OE, { visible: t8, offset: l, children: (0, import_jsx_runtime2.jsx)("section", { ref: e, children: r && (0, import_jsx_runtime2.jsx)(
    E5,
    {
      menuType: r,
      onOptionSelect: (L) => {
        const { label: y, commandId: O2, value: S } = L;
        v2 && v2.executeCommand(O2 != null ? O2 : y, { value: S }), g.get(U1).focus(), n(false);
      }
    }
  ) }) });
}
var lt2 = createIdentifier("univer.global-zone-service");
function tr() {
  const e = useDependency(lt2), [t8, n] = (0, import_react2.useState)(false), r = useObservable(e.componentKey$, e.componentKey), o = useDependency(S1), l = (0, import_react2.useMemo)(() => {
    const i = o.get(r != null ? r : "");
    if (i)
      return i;
  }, [r, o]);
  return (0, import_react2.useEffect)(() => {
    const i = e.visible$.subscribe((u) => {
      n(u);
    });
    return () => {
      i.unsubscribe();
    };
  }, [e.visible$]), t8 ? (0, import_jsx_runtime2.jsx)(
    "section",
    {
      className: ie2(
        "univer-absolute univer-bg-gray-100",
        {
          "univer-hidden": !t8,
          "univer-inset-0 univer-z-[100] univer-block univer-size-full": t8
        }
      ),
      children: l && (0, import_jsx_runtime2.jsx)(l, {})
    }
  ) : null;
}
function nr() {
  const e = useDependency(we3), t8 = useObservable(e.sidebarOptions$), n = (0, import_react2.useRef)(null), r = (0, import_react2.useMemo)(() => {
    if (!t8)
      return null;
    const i = { ...t8 };
    for (const u of ["children", "header", "footer"]) {
      const d = u;
      if (t8[d]) {
        const { key: v2, ...g } = t8[d];
        g && (i[d] = (0, import_jsx_runtime2.jsx)(_12, { ...g }, v2));
      }
    }
    return i;
  }, [t8]);
  (0, import_react2.useEffect)(() => (n.current && e.setContainer(n.current), () => {
    e.setContainer(void 0);
  }), [e]), (0, import_react2.useEffect)(() => {
    const i = (d) => {
      e.scrollEvent$.next(d);
    }, u = n.current;
    return u && u.addEventListener("scroll", i), () => {
      u == null || u.removeEventListener("scroll", i);
    };
  }, [e]);
  const o = (0, import_react2.useMemo)(() => r != null && r.visible ? typeof r.width == "number" ? `${r.width}px` : r.width : 0, [r]);
  function l() {
    var u;
    const i = {
      ...t8,
      visible: false
    };
    e.options.visible = false, e.sidebarOptions$.next(i), (u = i == null ? void 0 : i.onClose) == null || u.call(i);
  }
  return (0, import_jsx_runtime2.jsx)(
    "section",
    {
      "data-u-comp": "sidebar",
      className: ie2("univer-relative univer-h-full univer-bg-white univer-text-gray-900 dark:!univer-bg-gray-900 dark:!univer-text-white", {
        "univer-w-96 univer-translate-x-0": r == null ? void 0 : r.visible,
        "univer-w-0 univer-translate-x-full": !(r != null && r.visible)
      }),
      style: { width: o },
      children: (0, import_jsx_runtime2.jsxs)(
        "section",
        {
          ref: n,
          className: ie2("univer-box-border univer-grid univer-h-0 univer-min-h-full univer-grid-rows-[auto_1fr_auto] univer-overflow-y-auto", QS, pr),
          children: [
            (0, import_jsx_runtime2.jsxs)(
              "header",
              {
                className: "univer-sticky univer-top-0 univer-z-10 univer-box-border univer-flex univer-items-center univer-justify-between univer-bg-white univer-p-4 univer-pb-2 univer-text-base univer-font-medium univer-text-gray-800 dark:!univer-bg-gray-900 dark:!univer-text-white",
                children: [
                  r == null ? void 0 : r.header,
                  (0, import_jsx_runtime2.jsx)(
                    "a",
                    {
                      className: "univer-cursor-pointer univer-text-gray-500 dark:!univer-text-gray-300",
                      onClick: l,
                      children: (0, import_jsx_runtime2.jsx)(q3, {})
                    }
                  )
                ]
              }
            ),
            (0, import_jsx_runtime2.jsx)("section", { className: "univer-box-border univer-px-4", style: r == null ? void 0 : r.bodyStyle, children: r == null ? void 0 : r.children }),
            (r == null ? void 0 : r.footer) && (0, import_jsx_runtime2.jsx)(
              "footer",
              {
                className: "univer-sticky univer-bottom-0 univer-box-border univer-bg-white univer-p-4 dark:!univer-bg-gray-900",
                children: r.footer
              }
            )
          ]
        }
      )
    }
  );
}
var st2 = createIdentifier("univer.zen-zone-service");
function rr2() {
  const e = useDependency(st2), [t8, n] = (0, import_react2.useState)(false), [r, o] = (0, import_react2.useState)(), l = useObservable(e.temporaryHidden$), i = useDependency(S1);
  (0, import_react2.useEffect)(() => {
    const d = [
      e.visible$.subscribe((v2) => {
        n(v2);
      }),
      e.componentKey$.subscribe((v2) => {
        o(v2);
      })
    ];
    return () => {
      d.forEach((v2) => {
        v2.unsubscribe();
      });
    };
  }, []);
  const u = (0, import_react2.useMemo)(() => {
    const d = i.get(r != null ? r : "");
    if (d)
      return d;
  }, [r]);
  return (0, import_jsx_runtime2.jsx)(
    "section",
    {
      className: ie2("univer-absolute univer-z-[-1] univer-flex", {
        "univer-animate-in univer-fade-in univer-inset-0 univer-z-[100] univer-bg-gray-100": t8,
        "univer-hidden": l
      }),
      children: (0, import_jsx_runtime2.jsx)("div", { className: "univer-relative univer-flex-1", children: u && (0, import_jsx_runtime2.jsx)(u, {}) })
    }
  );
}
function uo2(e) {
  const t8 = p5(_e2);
  return (0, import_jsx_runtime2.jsx)(ho, { ...e, ...t8 });
}
function ho(e) {
  var K7;
  const {
    header: t8 = true,
    toolbar: n = true,
    footer: r = true,
    headerMenu: o = true,
    contextMenu: l = true,
    ribbonType: i = "default",
    mountContainer: u,
    onRendered: d
  } = e, v2 = useDependency(Fn), g = useDependency(Gi), c = useDependency(a3), m2 = (0, import_react2.useRef)(null), y = useDependency(ic).getConfig(_e2), O2 = M1(c12.CUSTOM_HEADER), S = M1(c12.FOOTER), _3 = M1(c12.HEADER), $ = M1(c12.HEADER_MENU), R = M1(c12.CONTENT), B = M1(c12.LEFT_SIDEBAR), w = M1(c12.GLOBAL), E = M1(c12.TOOLBAR), T = (K7 = y == null ? void 0 : y.popupRootId) != null ? K7 : "univer-popup-portal";
  (0, import_react2.useLayoutEffect)(() => {
    const j = g.currentTheme$.subscribe((z2) => {
      c.injectThemeToHead(z2);
    });
    return () => {
      j.unsubscribe();
    };
  }, []);
  const [W, A] = (0, import_react2.useState)(false);
  (0, import_react2.useLayoutEffect)(() => {
    const j = g.darkMode$.subscribe((z2) => {
      A(z2), z2 ? document.documentElement.classList.add("univer-dark") : document.documentElement.classList.remove("univer-dark");
    });
    return () => {
      j.unsubscribe();
    };
  }, []), (0, import_react2.useEffect)(() => {
    m2.current && (d == null || d(m2.current));
  }, [d]);
  const [U2, Y2] = (0, import_react2.useState)(v2.getLocales()), X2 = (0, import_react2.useMemo)(() => document.createElement("div"), []);
  return (0, import_react2.useEffect)(() => {
    document.body.appendChild(X2);
    const j = [
      v2.localeChanged$.subscribe(() => {
        Y2(v2.getLocales());
      })
    ];
    return () => {
      j.forEach((z2) => z2.unsubscribe()), document.body.removeChild(X2);
    };
  }, [v2, u, X2]), (0, import_jsx_runtime2.jsxs)(ZS, { locale: U2 == null ? void 0 : U2.design, mountContainer: X2, children: [
    (0, import_jsx_runtime2.jsxs)(
      "div",
      {
        "data-u-comp": "workbench-layout",
        className: ie2("univer-flex univer-h-full univer-min-h-0 univer-flex-col univer-bg-white dark:!univer-bg-gray-800", {
          "univer-dark": W
        }),
        tabIndex: -1,
        onBlur: (j) => j.stopPropagation(),
        onContextMenu: (j) => j.preventDefault(),
        children: [
          (0, import_jsx_runtime2.jsx)(
            "div",
            {
              className: "univer-relative univer-flex univer-min-h-0 univer-flex-col univer-bg-white dark:!univer-bg-gray-800",
              children: (0, import_jsx_runtime2.jsx)(I13, { components: O2 }, "custom-header")
            }
          ),
          t8 && n && (0, import_jsx_runtime2.jsx)(
            "header",
            {
              "data-u-comp": "headerbar",
              className: "univer-relative univer-z-10 univer-w-full univer-overflow-hidden",
              children: (0, import_jsx_runtime2.jsx)(
                I13,
                {
                  components: E,
                  sharedProps: {
                    ribbonType: i,
                    headerMenuComponents: $,
                    headerMenu: o
                  }
                },
                "toolbar"
              )
            }
          ),
          (0, import_jsx_runtime2.jsxs)("section", { className: "univer-relative univer-flex univer-min-h-0 univer-flex-1 univer-flex-col", children: [
            (0, import_jsx_runtime2.jsxs)(
              "div",
              {
                className: "univer-grid univer-h-full univer-grid-cols-[auto_1fr_auto] univer-grid-rows-[100%] univer-overflow-hidden",
                children: [
                  (0, import_jsx_runtime2.jsx)("aside", { "data-u-comp": "left-sidebar", className: "univer-h-full", children: (0, import_jsx_runtime2.jsx)(I13, { components: B }, "left-sidebar") }),
                  (0, import_jsx_runtime2.jsxs)(
                    "section",
                    {
                      className: ie2("univer-relative univer-grid univer-flex-1 univer-grid-rows-[auto_1fr] univer-overflow-hidden univer-bg-white dark:!univer-bg-gray-800", eE),
                      children: [
                        (0, import_jsx_runtime2.jsx)("header", { children: t8 && (0, import_jsx_runtime2.jsx)(I13, { components: _3 }, "header") }),
                        (0, import_jsx_runtime2.jsx)(
                          "section",
                          {
                            className: "univer-relative univer-overflow-hidden dark:!univer-bg-gray-900",
                            ref: m2,
                            "data-range-selector": true,
                            onContextMenu: (j) => j.preventDefault(),
                            children: (0, import_jsx_runtime2.jsx)(I13, { components: R }, "content")
                          }
                        )
                      ]
                    }
                  ),
                  (0, import_jsx_runtime2.jsx)("aside", { "data-u-comp": "right-sidebar", className: "univer-h-full", children: (0, import_jsx_runtime2.jsx)(nr, {}) })
                ]
              }
            ),
            r && (0, import_jsx_runtime2.jsx)("footer", { children: (0, import_jsx_runtime2.jsx)(I13, { components: S, sharedProps: { contextMenu: l } }, "footer") }),
            (0, import_jsx_runtime2.jsx)(rr2, {})
          ] })
        ]
      }
    ),
    (0, import_jsx_runtime2.jsx)(I13, { components: w }, "global"),
    (0, import_jsx_runtime2.jsx)(tr, {}),
    l && (0, import_jsx_runtime2.jsx)(co, {}),
    (0, import_jsx_runtime2.jsx)(fo3, {}),
    (0, import_jsx_runtime2.jsx)("div", { id: T })
  ] });
}
function fo3() {
  const { mountContainer: e } = (0, import_react2.useContext)(Tn), t8 = M1(c12.FLOATING);
  return (0, import_react_dom.createPortal)((0, import_jsx_runtime2.jsx)(I13, { components: t8 }, "floating"), e);
}
var Co = 3e3;
var or3 = class extends Ve {
  constructor(n, r, o, l, i) {
    super();
    F(this, "_steadyTimeout");
    F(this, "_renderTimeout");
    F(this, "_currentRenderId", null);
    this._injector = n, this._instanceService = r, this._layoutService = o, this._lifecycleService = l, this._renderManagerService = i;
  }
  dispose() {
    super.dispose(), clearTimeout(this._steadyTimeout), clearTimeout(this._renderTimeout), delete this._instanceService, delete this._layoutService, delete this._lifecycleService, delete this._renderManagerService;
  }
  _bootstrapWorkbench() {
    this.disposeWithMe(this.bootstrap(async (n, r) => {
      this._layoutService && (this.disposeWithMe(this._layoutService.registerRootContainerElement(r)), this.disposeWithMe(this._layoutService.registerContentElement(n)));
      try {
        await this._lifecycleService.onStage(ke.Ready), this._renderTimeout = window.setTimeout(() => {
          const o = this._renderManagerService.getRenderAll();
          for (const [l] of o)
            if (this._changeRenderUnit(l, n)) break;
          this.disposeWithMe(this._instanceService.focused$.subscribe((l) => {
            l && this._changeRenderUnit(l, n);
          })), this.disposeWithMe(this._renderManagerService.created$.subscribe((l) => {
            var i;
            l.unitId === ((i = this._instanceService.getFocusedUnit()) == null ? void 0 : i.getUnitId()) && this._changeRenderUnit(l.unitId, n);
          })), this.disposeWithMe(this._renderManagerService.disposed$.subscribe((l) => {
            this._currentRenderId === l && (this._currentRenderId = null);
          })), this._lifecycleService.stage = ke.Rendered, this._steadyTimeout = window.setTimeout(() => {
            this._lifecycleService.stage = ke.Steady;
          }, Co);
        }, 300);
      } catch (o) {
        if (o instanceof XE)
          return;
        throw o;
      }
    }));
  }
  _changeRenderUnit(n, r) {
    if (this._currentRenderId === n) return false;
    const o = this._renderManagerService.getRenderById(n);
    if (!o || !o.unitId || Yc(o.unitId)) return false;
    const l = this._currentRenderId ? this._renderManagerService.getRenderById(this._currentRenderId) : null;
    return l == null || l.deactivate(), l == null || l.engine.unmount(), o.engine.mount(r), o.activate(), this._currentRenderId = n, true;
  }
};
var vo = Object.getOwnPropertyDescriptor;
var go = (e, t8, n, r) => {
  for (var o = r > 1 ? void 0 : r ? vo(t8, n) : t8, l = e.length - 1, i; l >= 0; l--)
    (i = e[l]) && (o = i(o) || o);
  return o;
};
var j12 = (e, t8) => (n, r) => t8(n, r, e);
var B3 = class extends or3 {
  constructor(e, t8, n, r, o, l, i, u, d) {
    super(t8, l, o, n, r), this._config = e, this._componentManager = d, i.mergeMenu(B5), this._initBuiltinComponents(u), this._registerComponents(), this._bootstrapWorkbench();
  }
  _registerComponents() {
    [
      [f5, h5],
      [v5, C5],
      [w5, b5],
      [_5, L5],
      [M5, y5],
      [m5, sE]
    ].forEach(([e, t8]) => {
      this.disposeWithMe(
        this._componentManager.register(e, t8)
      );
    });
  }
  dispose() {
    super.dispose(), this._componentManager.dispose();
  }
  bootstrap(e) {
    return po(this._injector, this._config, e);
  }
  _initBuiltinComponents(e) {
    this.disposeWithMe(e.registerComponent(c12.FLOATING, () => connectInjector(Qn, this._injector))), this.disposeWithMe(e.registerComponent(c12.CONTENT, () => connectInjector(Gn3, this._injector))), this.disposeWithMe(e.registerComponent(c12.TOOLBAR, () => connectInjector(ao2, this._injector)));
  }
};
B3 = go([
  j12(1, Inject(Injector)),
  j12(2, Inject(Wn)),
  j12(3, ME),
  j12(4, U1),
  j12(5, vr),
  j12(6, B12),
  j12(7, D1),
  j12(8, Inject(S1))
], B3);
function po(e, t8, n) {
  let r;
  const o = t8.container;
  if (typeof o == "string") {
    const d = document.getElementById(o);
    d ? r = d : r = qt(o);
  } else o instanceof HTMLElement ? r = o : r = qt("univer");
  const l = connectInjector(uo2, e), i = (d) => n(d, r);
  function u() {
    UE(
      (0, import_jsx_runtime2.jsx)(
        l,
        {
          ...t8,
          mountContainer: r,
          onRendered: i
        }
      ),
      r
    );
  }
  return u(), We(() => {
    UE((0, import_jsx_runtime2.jsx)("div", {}), r), setTimeout(() => UE((0, import_jsx_runtime2.jsx)("div", {}), r), 200), setTimeout(() => GE(r), 500);
  });
}
function qt(e) {
  const t8 = document.createElement("div");
  return t8.id = e, t8;
}
var We3 = createIdentifier("univer.ui.ui-controller");
function mo(e) {
  const { menuType: t8, onOptionSelect: n } = e, r = useDependency(B12);
  if (!t8)
    return null;
  const o = (0, import_react2.useMemo)(() => {
    const l = r.getMenuByPositionKey(t8);
    function i(u) {
      return u.reduce((d, v2) => v2.children ? [...d, ...i(v2.children)] : [...d, v2], []);
    }
    return i(l);
  }, [t8]);
  return (0, import_jsx_runtime2.jsx)(
    "div",
    {
      className: "univer-box-border univer-grid univer-min-w-8 univer-max-w-52 univer-gap-1 univer-rounded univer-bg-gray-900 univer-px-2 univer-py-1",
      style: {
        gridTemplateColumns: `repeat(${Math.min(2, o.length)},  72px)`
      },
      children: o.map((l) => l.item && (0, import_jsx_runtime2.jsx)(
        bo,
        {
          menuItem: l.item,
          onClick: (i) => n == null ? void 0 : n({ value: "", label: l.key, ...i })
        },
        l.key
      ))
    }
  );
}
function bo(e) {
  const { menuItem: t8, onClick: n } = e, { id: r, type: o, title: l, label: i, icon: u } = t8;
  if (o !== H1.BUTTON)
    throw new Error(`[MobileMenuItem]: on mobile devices only "BUTTON" type menu items are supported. Please check "${r}".`);
  const d = useObservable(t8.disabled$, false), v2 = useObservable(t8.value$);
  return (0, import_jsx_runtime2.jsx)(
    "button",
    {
      type: "button",
      className: ie2("univer-w-18 univer-flex univer-flex-col univer-items-center univer-justify-center univer-border-none univer-bg-transparent univer-text-white [&>span]:univer-mt-0.5 [&>span]:univer-w-full [&>span]:univer-truncate [&>span]:univer-text-sm [&>svg]:univer-size-[18px] [&>svg]:univer-text-lg"),
      disabled: d,
      onClick: () => n({ id: r }),
      children: (0, import_jsx_runtime2.jsx)(_12, { value: v2, title: l, label: i, icon: u })
    },
    r
  );
}
function Lo() {
  const [e, t8] = (0, import_react2.useState)(false), [n, r] = (0, import_react2.useState)(""), [o, l] = (0, import_react2.useState)([0, 0]), i = (0, import_react2.useRef)(e), u = useDependency(c32), d = useDependency(Ls);
  i.current = e, (0, import_react2.useEffect)(() => {
    const c = u.registerContextMenuHandler({
      handleContextMenu: v2,
      hideContextMenu() {
        t8(false);
      },
      get visible() {
        return i.current;
      }
    });
    return document.addEventListener("pointerdown", g), document.addEventListener("wheel", g), () => {
      document.removeEventListener("pointerdown", g), document.removeEventListener("wheel", g), c.dispose();
    };
  }, [u]);
  function v2(c, m2) {
    r(m2), l([c.clientX, c.clientY]), t8(true);
  }
  function g() {
    t8(false);
  }
  return (0, import_jsx_runtime2.jsx)(OE, { visible: e, offset: o, children: (0, import_jsx_runtime2.jsx)("section", { onPointerDown: (c) => c.stopPropagation(), children: n && // TODO@wzhudev: change to mobile menu
  (0, import_jsx_runtime2.jsx)(
    mo,
    {
      menuType: n,
      onOptionSelect: (c) => {
        const { label: m2, value: L, commandId: y } = c;
        d && d.executeCommand(y != null ? y : m2, { value: L }), t8(false);
      }
    }
  ) }) });
}
function wo(e) {
  const {
    header: t8 = true,
    footer: n = true,
    contextMenu: r = true,
    mountContainer: o,
    onRendered: l
  } = e, i = useDependency(Fn), u = useDependency(Gi), d = useDependency(a3), v2 = (0, import_react2.useRef)(null), g = M1(c12.FOOTER), c = M1(c12.HEADER), m2 = M1(c12.CONTENT), L = M1(c12.LEFT_SIDEBAR), y = M1(c12.GLOBAL), [O2, S] = (0, import_react2.useState)(false);
  (0, import_react2.useEffect)(() => {
    const B = u.darkMode$.subscribe((w) => {
      S(w);
    });
    return () => {
      B.unsubscribe();
    };
  }, []), (0, import_react2.useEffect)(() => {
    v2.current && (l == null || l(v2.current));
  }, [l]);
  const [_3, $] = (0, import_react2.useState)(i.getLocales()), R = (0, import_react2.useMemo)(() => document.createElement("div"), []);
  return (0, import_react2.useLayoutEffect)(() => {
    const B = u.currentTheme$.subscribe((w) => {
      d.injectThemeToHead(w);
    });
    return () => {
      B.unsubscribe();
    };
  }, []), (0, import_react2.useEffect)(() => {
    document.body.appendChild(R);
    const B = [
      i.localeChanged$.subscribe(() => {
        $(i.getLocales());
      })
    ];
    return () => {
      B.forEach((w) => w.unsubscribe()), document.body.removeChild(R);
    };
  }, [i, o, R]), (0, import_jsx_runtime2.jsxs)(ZS, { locale: _3 == null ? void 0 : _3.design, mountContainer: R, children: [
    (0, import_jsx_runtime2.jsxs)(
      "div",
      {
        "data-u-comp": "app-layout",
        className: ie2("univer-relative univer-flex univer-h-full univer-min-h-0 univer-flex-col univer-bg-white dark:!univer-bg-gray-800", {
          "univer-dark": O2
        }),
        tabIndex: -1,
        onBlur: (B) => B.stopPropagation(),
        children: [
          t8 && (0, import_jsx_runtime2.jsx)("header", { className: "univer-relative univer-z-10 univer-w-full" }),
          (0, import_jsx_runtime2.jsxs)("section", { className: "univer-relative univer-flex univer-min-h-0 univer-flex-1 univer-flex-col", children: [
            (0, import_jsx_runtime2.jsxs)(
              "div",
              {
                className: "univer-grid univer-h-full univer-grid-cols-[auto_1fr_auto] univer-grid-rows-[100%] univer-overflow-hidden",
                children: [
                  (0, import_jsx_runtime2.jsx)("aside", { className: "univer-h-full", children: (0, import_jsx_runtime2.jsx)(I13, { components: L }, "left-sidebar") }),
                  (0, import_jsx_runtime2.jsxs)(
                    "section",
                    {
                      className: ie2("univer-relative univer-grid univer-flex-1 univer-grid-rows-[auto_1fr] univer-overflow-hidden univer-bg-white dark:!univer-bg-gray-800", eE),
                      children: [
                        (0, import_jsx_runtime2.jsx)("header", { className: "univer-w-screen", children: t8 && (0, import_jsx_runtime2.jsx)(I13, { components: c }, "header") }),
                        (0, import_jsx_runtime2.jsx)(
                          "section",
                          {
                            ref: v2,
                            className: "univer-relative univer-overflow-hidden",
                            "data-range-selector": true,
                            onContextMenu: (B) => B.preventDefault(),
                            children: (0, import_jsx_runtime2.jsx)(I13, { components: m2 }, "content")
                          }
                        )
                      ]
                    }
                  ),
                  (0, import_jsx_runtime2.jsx)("aside", { className: "univer-h-full", children: (0, import_jsx_runtime2.jsx)(nr, {}) })
                ]
              }
            ),
            n && (0, import_jsx_runtime2.jsx)("footer", { children: (0, import_jsx_runtime2.jsx)(I13, { components: g }, "footer") }),
            (0, import_jsx_runtime2.jsx)(tr, {}),
            (0, import_jsx_runtime2.jsx)(rr2, {})
          ] })
        ]
      }
    ),
    (0, import_jsx_runtime2.jsx)(I13, { components: y }, "global"),
    r && (0, import_jsx_runtime2.jsx)(Lo, {})
  ] });
}
var _o = Object.getOwnPropertyDescriptor;
var yo = (e, t8, n, r) => {
  for (var o = r > 1 ? void 0 : r ? _o(t8, n) : t8, l = e.length - 1, i; l >= 0; l--)
    (i = e[l]) && (o = i(o) || o);
  return o;
};
var te2 = (e, t8) => (n, r) => t8(n, r, e);
var P3 = class extends or3 {
  constructor(e, t8, n, r, o, l, i) {
    super(t8, l, o, n, r), this._config = e, this._initBuiltinComponents(i), this._bootstrapWorkbench();
  }
  bootstrap(e) {
    return Mo(this._injector, this._config, e);
  }
  _initBuiltinComponents(e) {
    this.disposeWithMe(e.registerComponent(c12.CONTENT, () => connectInjector(Qn, this._injector))), this.disposeWithMe(e.registerComponent(c12.CONTENT, () => connectInjector(Gn3, this._injector)));
  }
};
P3 = yo([
  te2(1, Inject(Injector)),
  te2(2, Inject(Wn)),
  te2(3, ME),
  te2(4, U1),
  te2(5, vr),
  te2(6, D1)
], P3);
function Mo(e, t8, n) {
  let r;
  const o = t8.container;
  if (typeof o == "string") {
    const d = document.getElementById(o);
    d ? r = d : r = Jt(o);
  } else o instanceof HTMLElement ? r = o : r = Jt("univer");
  const l = connectInjector(wo, e), i = (d) => n(d, r);
  function u() {
    UE(
      (0, import_jsx_runtime2.jsx)(
        l,
        {
          ...t8,
          mountContainer: r,
          onRendered: i
        }
      ),
      r
    );
  }
  return u(), We(() => {
    GE(r);
  });
}
function Jt(e) {
  const t8 = document.createElement("div");
  return t8.id = e, t8;
}
var u3 = createIdentifier("ui.notification.service");
var Io = Object.getOwnPropertyDescriptor;
var Ho = (e, t8, n, r) => {
  for (var o = r > 1 ? void 0 : r ? Io(t8, n) : t8, l = e.length - 1, i; l >= 0; l--)
    (i = e[l]) && (o = i(o) || o);
  return o;
};
var xo = (e, t8) => (n, r) => t8(n, r, e);
var ir2 = createIdentifier("univer.ui.before-close-service");
var Ye2 = class {
  constructor(e) {
    F(this, "_beforeUnloadCallbacks", []);
    F(this, "_onCloseCallbacks", []);
    this._notificationService = e, this._init();
  }
  registerBeforeClose(e) {
    return this._beforeUnloadCallbacks.push(e), {
      dispose: () => {
        this._beforeUnloadCallbacks = this._beforeUnloadCallbacks.filter((t8) => t8 !== e);
      }
    };
  }
  registerOnClose(e) {
    return this._onCloseCallbacks.push(e), {
      dispose: () => {
        this._onCloseCallbacks = this._onCloseCallbacks.filter((t8) => t8 !== e);
      }
    };
  }
  _init() {
    window.addEventListener("beforeunload", (e) => {
      let t8 = e;
      const n = this._beforeUnloadCallbacks.map((r) => r()).filter((r) => !!r).join(`
`);
      if (n)
        return this._notificationService.show({
          type: "error",
          title: "Some changes are not saved",
          content: n
        }), typeof t8 > "u" && (t8 = window.event), t8.returnValue = n, n;
    }), window.addEventListener("unload", () => {
      this._onCloseCallbacks.forEach((e) => e());
    });
  }
};
Ye2 = Ho([
  xo(0, u3)
], Ye2);
function So() {
  return typeof navigator.clipboard < "u" && typeof navigator.clipboard.readText < "u";
}
var Ro = Object.getOwnPropertyDescriptor;
var Vo = (e, t8, n, r) => {
  for (var o = r > 1 ? void 0 : r ? Ro(t8, n) : t8, l = e.length - 1, i; l >= 0; l--)
    (i = e[l]) && (o = i(o) || o);
  return o;
};
var x32 = (e, t8) => (n, r) => t8(n, r, e);
var Qt4 = "text/plain";
var Kt = "text/html";
var Oo = "image/png";
var $o = "image/jpeg";
var Eo2 = "image/bmp";
var No = "image/webp";
var Ki = "image/svg+xml";
var e7 = /* @__PURE__ */ new Set([
  Eo2,
  $o,
  No,
  Oo
]);
var lr = createIdentifier(
  "univer.clipboard-interface-service"
);
var Ge = class extends Ve {
  constructor(e, t8, n) {
    super(), this._localeService = e, this._logService = t8, this._notificationService = n;
  }
  get supportClipboard() {
    return So();
  }
  async write(e, t8) {
    if (!this.supportClipboard)
      return this._legacyCopyHtml(t8);
    try {
      return await navigator.clipboard.write([
        new ClipboardItem({
          [Qt4]: new Blob([e], { type: Qt4 }),
          [Kt]: new Blob([t8], { type: Kt })
        })
      ]);
    } catch (n) {
      this._logService.error("[BrowserClipboardService]", n), this._showClipboardAuthenticationNotification();
    }
  }
  async writeText(e) {
    if (!this.supportClipboard)
      return this._legacyCopyText(e);
    try {
      return await navigator.clipboard.writeText(e);
    } catch (t8) {
      this._logService.error("[BrowserClipboardService]", t8), this._showClipboardAuthenticationNotification();
    }
  }
  async read() {
    if (!this.supportClipboard)
      throw new Error("[BrowserClipboardService] read() is not supported on this platform.");
    try {
      return navigator.clipboard.read();
    } catch (e) {
      return this._logService.error("[BrowserClipboardService]", e), this._showClipboardAuthenticationNotification(), [];
    }
  }
  async readText() {
    if (!this.supportClipboard)
      throw new Error("[BrowserClipboardService] read() is not supported on this platform.");
    try {
      return await navigator.clipboard.readText();
    } catch (e) {
      return this._logService.error("[BrowserClipboardService]", e), this._showClipboardAuthenticationNotification(), "";
    }
  }
  _legacyCopyHtml(e) {
    const t8 = document.activeElement, n = To();
    document.body.appendChild(n), n.innerHTML = e;
    try {
      e9(n), document.execCommand("copy");
    } finally {
      t8 instanceof HTMLElement && t8.focus(), document.body.removeChild(n);
    }
  }
  _legacyCopyText(e) {
    const t8 = document.activeElement, n = Do();
    document.body.appendChild(n), n.value = e;
    try {
      e9(n), document.execCommand("copy");
    } finally {
      t8 instanceof HTMLElement && t8.focus(), document.body.removeChild(n);
    }
  }
  _showClipboardAuthenticationNotification() {
    var e;
    (e = this._notificationService) == null || e.show({
      type: "warning",
      title: this._localeService.t("clipboard.authentication.title"),
      content: this._localeService.t("clipboard.authentication.content")
    });
  }
};
Ge = Vo([
  x32(0, Inject(Fn)),
  x32(1, yt),
  x32(2, Optional(u3))
], Ge);
function Do() {
  const e = document.createElement("textarea");
  return e.style.position = "absolute", e.style.height = "1px", e.style.width = "1px", e.style.opacity = "0", e.readOnly = true, e;
}
function To() {
  const e = document.createElement("div");
  return e.contentEditable = "true", e.style.position = "absolute", e.style.opacity = "0", e.style.height = "1px", e.style.width = "1px", e;
}
function e9(e) {
  if (e instanceof HTMLTextAreaElement) {
    const r = e.hasAttribute("readonly");
    return r || e.setAttribute("readonly", ""), e.select(), e.setSelectionRange(0, e.value.length), r || e.removeAttribute("readonly"), e.value;
  }
  e.hasAttribute("contenteditable") && e.focus();
  const t8 = document.createRange();
  t8.selectNodeContents(e);
  const n = window.getSelection();
  if (!n)
    throw new Error();
  return n.removeAllRanges(), n.addRange(t8), n.toString();
}
var at = createIdentifier("univer.confirm-service");
var t7 = class {
  constructor() {
    F(this, "confirmOptions$", new Subject());
  }
  dispose() {
    this.confirmOptions$.complete();
  }
  open(t8) {
    throw new Error("This is not implemented in the test service!");
  }
  confirm(t8) {
    return Promise.resolve(true);
  }
  close(t8) {
    throw new Error("This is not implemented in the test service!");
  }
};
var Zo = (e) => {
  const { children: t8, onClose: n, onConfirm: r } = e, [o] = (0, import_react2.useState)({}), l = t8 ? (0, import_react2.cloneElement)(t8, { hooks: o }) : null;
  return (0, import_jsx_runtime2.jsx)(
    uE,
    {
      ...e,
      children: l,
      onClose: () => {
        const i = o.beforeClose;
        if (i) {
          const u = i();
          if (u.cancel)
            return;
          n == null || n(u);
          return;
        }
        n == null || n();
      },
      onConfirm: () => {
        const i = o.beforeConfirm;
        if (i) {
          const u = i();
          if (u.cancel)
            return;
          r == null || r(u);
          return;
        }
        r == null || r();
      }
    }
  );
};
function Ao() {
  const e = useDependency(at), [t8, n] = (0, import_react2.useState)([]);
  (0, import_react2.useEffect)(() => {
    const o = e.confirmOptions$.subscribe((l) => {
      n(l);
    });
    return () => {
      o.unsubscribe();
    };
  }, []);
  const r = t8.map((o) => {
    const { children: l, title: i, ...u } = o, d = u;
    for (const v2 of ["children", "title"]) {
      const g = v2, c = o[g];
      c && (d[g] = (0, import_jsx_runtime2.jsx)(_12, { ...c }));
    }
    return d;
  });
  return r == null ? void 0 : r.map((o, l) => (0, import_jsx_runtime2.jsx)(Zo, { ...o, children: o.children }, l));
}
var Bo = Object.getOwnPropertyDescriptor;
var Po = (e, t8, n, r) => {
  for (var o = r > 1 ? void 0 : r ? Bo(t8, n) : t8, l = e.length - 1, i; l >= 0; l--)
    (i = e[l]) && (o = i(o) || o);
  return o;
};
var t9 = (e, t8) => (n, r) => t8(n, r, e);
var Xe2 = class extends Ve {
  constructor(t8, n) {
    super();
    F(this, "_confirmOptions", []);
    F(this, "confirmOptions$", new BehaviorSubject([]));
    this._injector = t8, this._uiPartsService = n, this._initUIPart();
  }
  open(t8) {
    return this._confirmOptions.find((n) => n.id === t8.id) ? this._confirmOptions = this._confirmOptions.map((n) => ({
      ...n.id === t8.id ? t8 : n,
      visible: n.id === t8.id ? true : n.visible
    })) : this._confirmOptions.push({
      ...t8,
      visible: true
    }), this.confirmOptions$.next(this._confirmOptions), We(() => {
      this._confirmOptions = [], this.confirmOptions$.next([]);
    });
  }
  confirm(t8) {
    return new Promise((n) => {
      const r = this.open({
        ...t8,
        onConfirm: () => {
          r.dispose(), n(true);
        },
        onClose: () => {
          r.dispose(), n(false);
        }
      });
    });
  }
  close(t8) {
    this._confirmOptions = this._confirmOptions.map((n) => ({
      ...n,
      visible: n.id === t8 ? false : n.visible
    })), this.confirmOptions$.next([...this._confirmOptions]);
  }
  _initUIPart() {
    this.disposeWithMe(
      this._uiPartsService.registerComponent(c12.GLOBAL, () => connectInjector(Ao, this._injector))
    );
  }
};
Xe2 = Po([
  t9(0, Inject(Injector)),
  t9(1, D1)
], Xe2);
var ct2 = createIdentifier("univer.ui.dialog-service");
function Fo() {
  const e = useDependency(ct2), [t8, n] = (0, import_react2.useState)([]);
  (0, import_react2.useEffect)(() => {
    const l = e.getDialogs$().subscribe((i) => {
      n(i);
    });
    return () => l.unsubscribe();
  }, []);
  const r = (0, import_react2.useMemo)(() => t8.map((o) => {
    const { children: l, title: i, footer: u, ...d } = o, v2 = d;
    for (const g of ["children", "title", "footer"]) {
      const c = g, m2 = o[c];
      m2 && (v2[c] = (0, import_jsx_runtime2.jsx)(_12, { ...m2 }));
    }
    return v2;
  }), [t8]);
  return r == null ? void 0 : r.map((o) => (0, import_jsx_runtime2.jsx)(kd, { ...o }, o.id));
}
var ko = Object.getOwnPropertyDescriptor;
var jo = (e, t8, n, r) => {
  for (var o = r > 1 ? void 0 : r ? ko(t8, n) : t8, l = e.length - 1, i; l >= 0; l--)
    (i = e[l]) && (o = i(o) || o);
  return o;
};
var n9 = (e, t8) => (n, r) => t8(n, r, e);
var qe3 = class extends Ve {
  constructor(t8, n) {
    super();
    F(this, "_dialogOptions", []);
    F(this, "_dialogOptions$", new Subject());
    this._injector = t8, this._uiPartsService = n, this._initUIPart();
  }
  dispose() {
    super.dispose(), this._dialogOptions = [], this._dialogOptions$.complete();
  }
  open(t8) {
    return this._dialogOptions.find((n) => n.id === t8.id) ? this._dialogOptions = this._dialogOptions.map((n) => ({
      ...n.id === t8.id ? t8 : n,
      open: n.id === t8.id ? true : n.open
    })) : this._dialogOptions.push({
      ...t8,
      open: true
    }), this._dialogOptions$.next(this._dialogOptions), We(() => {
      this._dialogOptions = [], this._dialogOptions$.next([]);
    });
  }
  close(t8) {
    this._dialogOptions = this._dialogOptions.map((n) => ({
      ...n,
      open: n.id === t8 ? false : n.open
    })), this._dialogOptions$.next([...this._dialogOptions]);
  }
  closeAll(t8) {
    const n = new Set(t8);
    this._dialogOptions = this._dialogOptions.map((r) => ({
      ...r,
      open: n.has(r.id) ? r.open : false
    })), this._dialogOptions$.next([...this._dialogOptions]);
  }
  getDialogs$() {
    return this._dialogOptions$.asObservable();
  }
  _initUIPart() {
    this.disposeWithMe(
      this._uiPartsService.registerComponent(c12.GLOBAL, () => connectInjector(Fo, this._injector))
    );
  }
};
qe3 = jo([
  n9(0, Inject(Injector)),
  n9(1, D1)
], qe3);
var ut = createIdentifier("univer.ui.gallery-service");
function Uo() {
  const e = useDependency(ut), t8 = useObservable(e.gallery$);
  return t8 ? (0, import_jsx_runtime2.jsx)(bE2, { ...t8 }) : null;
}
var zo = Object.getOwnPropertyDescriptor;
var Wo = (e, t8, n, r) => {
  for (var o = r > 1 ? void 0 : r ? zo(t8, n) : t8, l = e.length - 1, i; l >= 0; l--)
    (i = e[l]) && (o = i(o) || o);
  return o;
};
var r9 = (e, t8) => (n, r) => t8(n, r, e);
var Je3 = class extends Ve {
  constructor(t8, n) {
    super();
    F(this, "gallery$", new Subject());
    this._injector = t8, this._uiPartsService = n, this._initUIPart();
  }
  dispose() {
    super.dispose();
  }
  open(t8) {
    return this.gallery$.next({
      open: true,
      ...t8
    }), We(() => {
      this.gallery$.complete();
    });
  }
  close() {
    this.gallery$.next({
      open: false,
      images: []
    });
  }
  _initUIPart() {
    this.disposeWithMe(
      this._uiPartsService.registerComponent(c12.GLOBAL, () => connectInjector(Uo, this._injector))
    );
  }
};
Je3 = Wo([
  r9(0, Inject(Injector)),
  r9(1, D1)
], Je3);
var Yo = Object.getOwnPropertyDescriptor;
var Go = (e, t8, n, r) => {
  for (var o = r > 1 ? void 0 : r ? Yo(t8, n) : t8, l = e.length - 1, i; l >= 0; l--)
    (i = e[l]) && (o = i(o) || o);
  return o;
};
var Xo2 = (e, t8) => (n, r) => t8(n, r, e);
var Qe = class {
  constructor(e) {
    F(this, "visible$", new Subject());
    F(this, "componentKey$", new Subject());
    F(this, "_componentKey", "");
    this._componentManager = e;
  }
  get componentKey() {
    return this._componentKey;
  }
  set(e, t8) {
    return this._componentManager.register(e, t8), this.componentKey$.next(e), this._componentKey = e, We(() => {
      this._componentManager.delete(e), this.visible$.complete(), this.componentKey$.complete();
    });
  }
  open() {
    this.visible$.next(true);
  }
  close() {
    this.visible$.next(false);
  }
};
Qe = Go([
  Xo2(0, Inject(S1))
], Qe);
var sr3 = class extends Ve {
  openFile(t8) {
    return new Promise((n) => {
      var o, l;
      const r = document.createElement("input");
      r.type = "file", r.accept = (o = t8 == null ? void 0 : t8.accept) != null ? o : "", r.multiple = (l = t8 == null ? void 0 : t8.multiple) != null ? l : false, r.onchange = (i) => {
        const u = i.target.files;
        u && n(Array.from(u));
      }, r.click();
    });
  }
  downloadFile(t8, n) {
    const r = document.createElement("a");
    r.download = n, r.href = window.URL.createObjectURL(t8), r.click();
  }
};
var ar = createIdentifier("univer-ui.local-file.service");
var $e2 = typeof globalThis < "u" ? globalThis : typeof window < "u" ? window : typeof global < "u" ? global : typeof self < "u" ? self : {};
function qo2(e) {
  return e && e.__esModule && Object.prototype.hasOwnProperty.call(e, "default") ? e.default : e;
}
function Ee(e) {
  throw new Error('Could not dynamically require "' + e + '". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.');
}
var S3 = { exports: {} };
var o9;
function Jo() {
  return o9 || (o9 = 1, function(e, t8) {
    (function(n) {
      e.exports = n();
    })(function() {
      return function n(r, o, l) {
        function i(v2, g) {
          if (!o[v2]) {
            if (!r[v2]) {
              var c = typeof Ee == "function" && Ee;
              if (!g && c) return c(v2, true);
              if (u) return u(v2, true);
              var m2 = new Error("Cannot find module '" + v2 + "'");
              throw m2.code = "MODULE_NOT_FOUND", m2;
            }
            var L = o[v2] = { exports: {} };
            r[v2][0].call(L.exports, function(y) {
              var O2 = r[v2][1][y];
              return i(O2 || y);
            }, L, L.exports, n, r, o, l);
          }
          return o[v2].exports;
        }
        for (var u = typeof Ee == "function" && Ee, d = 0; d < l.length; d++) i(l[d]);
        return i;
      }({ 1: [function(n, r, o) {
        (function(l) {
          var i = l.MutationObserver || l.WebKitMutationObserver, u;
          if (i) {
            var d = 0, v2 = new i(y), g = l.document.createTextNode("");
            v2.observe(g, {
              characterData: true
            }), u = function() {
              g.data = d = ++d % 2;
            };
          } else if (!l.setImmediate && typeof l.MessageChannel < "u") {
            var c = new l.MessageChannel();
            c.port1.onmessage = y, u = function() {
              c.port2.postMessage(0);
            };
          } else "document" in l && "onreadystatechange" in l.document.createElement("script") ? u = function() {
            var S = l.document.createElement("script");
            S.onreadystatechange = function() {
              y(), S.onreadystatechange = null, S.parentNode.removeChild(S), S = null;
            }, l.document.documentElement.appendChild(S);
          } : u = function() {
            setTimeout(y, 0);
          };
          var m2, L = [];
          function y() {
            m2 = true;
            for (var S, _3, $ = L.length; $; ) {
              for (_3 = L, L = [], S = -1; ++S < $; )
                _3[S]();
              $ = L.length;
            }
            m2 = false;
          }
          r.exports = O2;
          function O2(S) {
            L.push(S) === 1 && !m2 && u();
          }
        }).call(this, typeof $e2 < "u" ? $e2 : typeof self < "u" ? self : typeof window < "u" ? window : {});
      }, {}], 2: [function(n, r, o) {
        var l = n(1);
        function i() {
        }
        var u = {}, d = ["REJECTED"], v2 = ["FULFILLED"], g = ["PENDING"];
        r.exports = c;
        function c(w) {
          if (typeof w != "function")
            throw new TypeError("resolver must be a function");
          this.state = g, this.queue = [], this.outcome = void 0, w !== i && O2(this, w);
        }
        c.prototype.catch = function(w) {
          return this.then(null, w);
        }, c.prototype.then = function(w, E) {
          if (typeof w != "function" && this.state === v2 || typeof E != "function" && this.state === d)
            return this;
          var T = new this.constructor(i);
          if (this.state !== g) {
            var W = this.state === v2 ? w : E;
            L(T, W, this.outcome);
          } else
            this.queue.push(new m2(T, w, E));
          return T;
        };
        function m2(w, E, T) {
          this.promise = w, typeof E == "function" && (this.onFulfilled = E, this.callFulfilled = this.otherCallFulfilled), typeof T == "function" && (this.onRejected = T, this.callRejected = this.otherCallRejected);
        }
        m2.prototype.callFulfilled = function(w) {
          u.resolve(this.promise, w);
        }, m2.prototype.otherCallFulfilled = function(w) {
          L(this.promise, this.onFulfilled, w);
        }, m2.prototype.callRejected = function(w) {
          u.reject(this.promise, w);
        }, m2.prototype.otherCallRejected = function(w) {
          L(this.promise, this.onRejected, w);
        };
        function L(w, E, T) {
          l(function() {
            var W;
            try {
              W = E(T);
            } catch (A) {
              return u.reject(w, A);
            }
            W === w ? u.reject(w, new TypeError("Cannot resolve promise with itself")) : u.resolve(w, W);
          });
        }
        u.resolve = function(w, E) {
          var T = S(y, E);
          if (T.status === "error")
            return u.reject(w, T.value);
          var W = T.value;
          if (W)
            O2(w, W);
          else {
            w.state = v2, w.outcome = E;
            for (var A = -1, U2 = w.queue.length; ++A < U2; )
              w.queue[A].callFulfilled(E);
          }
          return w;
        }, u.reject = function(w, E) {
          w.state = d, w.outcome = E;
          for (var T = -1, W = w.queue.length; ++T < W; )
            w.queue[T].callRejected(E);
          return w;
        };
        function y(w) {
          var E = w && w.then;
          if (w && (typeof w == "object" || typeof w == "function") && typeof E == "function")
            return function() {
              E.apply(w, arguments);
            };
        }
        function O2(w, E) {
          var T = false;
          function W(X2) {
            T || (T = true, u.reject(w, X2));
          }
          function A(X2) {
            T || (T = true, u.resolve(w, X2));
          }
          function U2() {
            E(A, W);
          }
          var Y2 = S(U2);
          Y2.status === "error" && W(Y2.value);
        }
        function S(w, E) {
          var T = {};
          try {
            T.value = w(E), T.status = "success";
          } catch (W) {
            T.status = "error", T.value = W;
          }
          return T;
        }
        c.resolve = _3;
        function _3(w) {
          return w instanceof this ? w : u.resolve(new this(i), w);
        }
        c.reject = $;
        function $(w) {
          var E = new this(i);
          return u.reject(E, w);
        }
        c.all = R;
        function R(w) {
          var E = this;
          if (Object.prototype.toString.call(w) !== "[object Array]")
            return this.reject(new TypeError("must be an array"));
          var T = w.length, W = false;
          if (!T)
            return this.resolve([]);
          for (var A = new Array(T), U2 = 0, Y2 = -1, X2 = new this(i); ++Y2 < T; )
            K7(w[Y2], Y2);
          return X2;
          function K7(j, z2) {
            E.resolve(j).then(e12, function(u12) {
              W || (W = true, u.reject(X2, u12));
            });
            function e12(u12) {
              A[z2] = u12, ++U2 === T && !W && (W = true, u.resolve(X2, A));
            }
          }
        }
        c.race = B;
        function B(w) {
          var E = this;
          if (Object.prototype.toString.call(w) !== "[object Array]")
            return this.reject(new TypeError("must be an array"));
          var T = w.length, W = false;
          if (!T)
            return this.resolve([]);
          for (var A = -1, U2 = new this(i); ++A < T; )
            Y2(w[A]);
          return U2;
          function Y2(X2) {
            E.resolve(X2).then(function(K7) {
              W || (W = true, u.resolve(U2, K7));
            }, function(K7) {
              W || (W = true, u.reject(U2, K7));
            });
          }
        }
      }, { 1: 1 }], 3: [function(n, r, o) {
        (function(l) {
          typeof l.Promise != "function" && (l.Promise = n(2));
        }).call(this, typeof $e2 < "u" ? $e2 : typeof self < "u" ? self : typeof window < "u" ? window : {});
      }, { 2: 2 }], 4: [function(n, r, o) {
        var l = typeof Symbol == "function" && typeof Symbol.iterator == "symbol" ? function(s) {
          return typeof s;
        } : function(s) {
          return s && typeof Symbol == "function" && s.constructor === Symbol && s !== Symbol.prototype ? "symbol" : typeof s;
        };
        function i(s, h) {
          if (!(s instanceof h))
            throw new TypeError("Cannot call a class as a function");
        }
        function u() {
          try {
            if (typeof indexedDB < "u")
              return indexedDB;
            if (typeof webkitIndexedDB < "u")
              return webkitIndexedDB;
            if (typeof mozIndexedDB < "u")
              return mozIndexedDB;
            if (typeof OIndexedDB < "u")
              return OIndexedDB;
            if (typeof msIndexedDB < "u")
              return msIndexedDB;
          } catch {
            return;
          }
        }
        var d = u();
        function v2() {
          try {
            if (!d || !d.open)
              return false;
            var s = typeof openDatabase < "u" && /(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent) && !/Chrome/.test(navigator.userAgent) && !/BlackBerry/.test(navigator.platform), h = typeof fetch == "function" && fetch.toString().indexOf("[native code") !== -1;
            return (!s || h) && typeof indexedDB < "u" && // some outdated implementations of IDB that appear on Samsung
            // and HTC Android devices <4.4 are missing IDBKeyRange
            // See: https://github.com/mozilla/localForage/issues/128
            // See: https://github.com/mozilla/localForage/issues/272
            typeof IDBKeyRange < "u";
          } catch {
            return false;
          }
        }
        function g(s, h) {
          s = s || [], h = h || {};
          try {
            return new Blob(s, h);
          } catch (C) {
            if (C.name !== "TypeError")
              throw C;
            for (var a = typeof BlobBuilder < "u" ? BlobBuilder : typeof MSBlobBuilder < "u" ? MSBlobBuilder : typeof MozBlobBuilder < "u" ? MozBlobBuilder : WebKitBlobBuilder, p = new a(), b2 = 0; b2 < s.length; b2 += 1)
              p.append(s[b2]);
            return p.getBlob(h.type);
          }
        }
        typeof Promise > "u" && n(3);
        var c = Promise;
        function m2(s, h) {
          h && s.then(function(a) {
            h(null, a);
          }, function(a) {
            h(a);
          });
        }
        function L(s, h, a) {
          typeof h == "function" && s.then(h), typeof a == "function" && s.catch(a);
        }
        function y(s) {
          return typeof s != "string" && (console.warn(s + " used as a key, but it is not a string."), s = String(s)), s;
        }
        function O2() {
          if (arguments.length && typeof arguments[arguments.length - 1] == "function")
            return arguments[arguments.length - 1];
        }
        var S = "local-forage-detect-blob-support", _3 = void 0, $ = {}, R = Object.prototype.toString, B = "readonly", w = "readwrite";
        function E(s) {
          for (var h = s.length, a = new ArrayBuffer(h), p = new Uint8Array(a), b2 = 0; b2 < h; b2++)
            p[b2] = s.charCodeAt(b2);
          return a;
        }
        function T(s) {
          return new c(function(h) {
            var a = s.transaction(S, w), p = g([""]);
            a.objectStore(S).put(p, "key"), a.onabort = function(b2) {
              b2.preventDefault(), b2.stopPropagation(), h(false);
            }, a.oncomplete = function() {
              var b2 = navigator.userAgent.match(/Chrome\/(\d+)/), C = navigator.userAgent.match(/Edge\//);
              h(C || !b2 || parseInt(b2[1], 10) >= 43);
            };
          }).catch(function() {
            return false;
          });
        }
        function W(s) {
          return typeof _3 == "boolean" ? c.resolve(_3) : T(s).then(function(h) {
            return _3 = h, _3;
          });
        }
        function A(s) {
          var h = $[s.name], a = {};
          a.promise = new c(function(p, b2) {
            a.resolve = p, a.reject = b2;
          }), h.deferredOperations.push(a), h.dbReady ? h.dbReady = h.dbReady.then(function() {
            return a.promise;
          }) : h.dbReady = a.promise;
        }
        function U2(s) {
          var h = $[s.name], a = h.deferredOperations.pop();
          if (a)
            return a.resolve(), a.promise;
        }
        function Y2(s, h) {
          var a = $[s.name], p = a.deferredOperations.pop();
          if (p)
            return p.reject(h), p.promise;
        }
        function X2(s, h) {
          return new c(function(a, p) {
            if ($[s.name] = $[s.name] || l12(), s.db)
              if (h)
                A(s), s.db.close();
              else
                return a(s.db);
            var b2 = [s.name];
            h && b2.push(s.version);
            var C = d.open.apply(d, b2);
            h && (C.onupgradeneeded = function(x7) {
              var V2 = C.result;
              try {
                V2.createObjectStore(s.storeName), x7.oldVersion <= 1 && V2.createObjectStore(S);
              } catch (N) {
                if (N.name === "ConstraintError")
                  console.warn('The database "' + s.name + '" has been upgraded from version ' + x7.oldVersion + " to version " + x7.newVersion + ', but the storage "' + s.storeName + '" already exists.');
                else
                  throw N;
              }
            }), C.onerror = function(x7) {
              x7.preventDefault(), p(C.error);
            }, C.onsuccess = function() {
              var x7 = C.result;
              x7.onversionchange = function(V2) {
                V2.target.close();
              }, a(x7), U2(s);
            };
          });
        }
        function K7(s) {
          return X2(s, false);
        }
        function j(s) {
          return X2(s, true);
        }
        function z2(s, h) {
          if (!s.db)
            return true;
          var a = !s.db.objectStoreNames.contains(s.storeName), p = s.version < s.db.version, b2 = s.version > s.db.version;
          if (p && (s.version !== h && console.warn('The database "' + s.name + `" can't be downgraded from version ` + s.db.version + " to version " + s.version + "."), s.version = s.db.version), b2 || a) {
            if (a) {
              var C = s.db.version + 1;
              C > s.version && (s.version = C);
            }
            return true;
          }
          return false;
        }
        function e12(s) {
          return new c(function(h, a) {
            var p = new FileReader();
            p.onerror = a, p.onloadend = function(b2) {
              var C = btoa(b2.target.result || "");
              h({
                __local_forage_encoded_blob: true,
                data: C,
                type: s.type
              });
            }, p.readAsBinaryString(s);
          });
        }
        function u12(s) {
          var h = E(atob(s.data));
          return g([h], { type: s.type });
        }
        function b12(s) {
          return s && s.__local_forage_encoded_blob;
        }
        function y12(s) {
          var h = this, a = h._initReady().then(function() {
            var p = $[h._dbInfo.name];
            if (p && p.dbReady)
              return p.dbReady;
          });
          return L(a, s, s), a;
        }
        function O12(s) {
          A(s);
          for (var h = $[s.name], a = h.forages, p = 0; p < a.length; p++) {
            var b2 = a[p];
            b2._dbInfo.db && (b2._dbInfo.db.close(), b2._dbInfo.db = null);
          }
          return s.db = null, K7(s).then(function(C) {
            return s.db = C, z2(s) ? j(s) : C;
          }).then(function(C) {
            s.db = h.db = C;
            for (var x7 = 0; x7 < a.length; x7++)
              a[x7]._dbInfo.db = C;
          }).catch(function(C) {
            throw Y2(s, C), C;
          });
        }
        function s13(s, h, a, p) {
          p === void 0 && (p = 1);
          try {
            var b2 = s.db.transaction(s.storeName, h);
            a(null, b2);
          } catch (C) {
            if (p > 0 && (!s.db || C.name === "InvalidStateError" || C.name === "NotFoundError"))
              return c.resolve().then(function() {
                if (!s.db || C.name === "NotFoundError" && !s.db.objectStoreNames.contains(s.storeName) && s.version <= s.db.version)
                  return s.db && (s.version = s.db.version + 1), j(s);
              }).then(function() {
                return O12(s).then(function() {
                  s13(s, h, a, p - 1);
                });
              }).catch(a);
            a(C);
          }
        }
        function l12() {
          return {
            // Running localForages sharing a database.
            forages: [],
            // Shared database.
            db: null,
            // Database readiness (promise).
            dbReady: null,
            // Deferred operations on the database.
            deferredOperations: []
          };
        }
        function p12(s) {
          var h = this, a = {
            db: null
          };
          if (s)
            for (var p in s)
              a[p] = s[p];
          var b2 = $[a.name];
          b2 || (b2 = l12(), $[a.name] = b2), b2.forages.push(h), h._initReady || (h._initReady = h.ready, h.ready = y12);
          var C = [];
          function x7() {
            return c.resolve();
          }
          for (var V2 = 0; V2 < b2.forages.length; V2++) {
            var N = b2.forages[V2];
            N !== h && C.push(N._initReady().catch(x7));
          }
          var D2 = b2.forages.slice(0);
          return c.all(C).then(function() {
            return a.db = b2.db, K7(a);
          }).then(function(Z7) {
            return a.db = Z7, z2(a, h._defaultConfig.version) ? j(a) : Z7;
          }).then(function(Z7) {
            a.db = b2.db = Z7, h._dbInfo = a;
            for (var P2 = 0; P2 < D2.length; P2++) {
              var J7 = D2[P2];
              J7 !== h && (J7._dbInfo.db = a.db, J7._dbInfo.version = a.version);
            }
          });
        }
        function R12(s, h) {
          var a = this;
          s = y(s);
          var p = new c(function(b2, C) {
            a.ready().then(function() {
              s13(a._dbInfo, B, function(x7, V2) {
                if (x7)
                  return C(x7);
                try {
                  var N = V2.objectStore(a._dbInfo.storeName), D2 = N.get(s);
                  D2.onsuccess = function() {
                    var Z7 = D2.result;
                    Z7 === void 0 && (Z7 = null), b12(Z7) && (Z7 = u12(Z7)), b2(Z7);
                  }, D2.onerror = function() {
                    C(D2.error);
                  };
                } catch (Z7) {
                  C(Z7);
                }
              });
            }).catch(C);
          });
          return m2(p, h), p;
        }
        function T12(s, h) {
          var a = this, p = new c(function(b2, C) {
            a.ready().then(function() {
              s13(a._dbInfo, B, function(x7, V2) {
                if (x7)
                  return C(x7);
                try {
                  var N = V2.objectStore(a._dbInfo.storeName), D2 = N.openCursor(), Z7 = 1;
                  D2.onsuccess = function() {
                    var P2 = D2.result;
                    if (P2) {
                      var J7 = P2.value;
                      b12(J7) && (J7 = u12(J7));
                      var o12 = s(J7, P2.key, Z7++);
                      o12 !== void 0 ? b2(o12) : P2.continue();
                    } else
                      b2();
                  }, D2.onerror = function() {
                    C(D2.error);
                  };
                } catch (P2) {
                  C(P2);
                }
              });
            }).catch(C);
          });
          return m2(p, h), p;
        }
        function z13(s, h, a) {
          var p = this;
          s = y(s);
          var b2 = new c(function(C, x7) {
            var V2;
            p.ready().then(function() {
              return V2 = p._dbInfo, R.call(h) === "[object Blob]" ? W(V2.db).then(function(N) {
                return N ? h : e12(h);
              }) : h;
            }).then(function(N) {
              s13(p._dbInfo, w, function(D2, Z7) {
                if (D2)
                  return x7(D2);
                try {
                  var P2 = Z7.objectStore(p._dbInfo.storeName);
                  N === null && (N = void 0);
                  var J7 = P2.put(N, s);
                  Z7.oncomplete = function() {
                    N === void 0 && (N = null), C(N);
                  }, Z7.onabort = Z7.onerror = function() {
                    var o12 = J7.error ? J7.error : J7.transaction.error;
                    x7(o12);
                  };
                } catch (o12) {
                  x7(o12);
                }
              });
            }).catch(x7);
          });
          return m2(b2, a), b2;
        }
        function J12(s, h) {
          var a = this;
          s = y(s);
          var p = new c(function(b2, C) {
            a.ready().then(function() {
              s13(a._dbInfo, w, function(x7, V2) {
                if (x7)
                  return C(x7);
                try {
                  var N = V2.objectStore(a._dbInfo.storeName), D2 = N.delete(s);
                  V2.oncomplete = function() {
                    b2();
                  }, V2.onerror = function() {
                    C(D2.error);
                  }, V2.onabort = function() {
                    var Z7 = D2.error ? D2.error : D2.transaction.error;
                    C(Z7);
                  };
                } catch (Z7) {
                  C(Z7);
                }
              });
            }).catch(C);
          });
          return m2(p, h), p;
        }
        function Q12(s) {
          var h = this, a = new c(function(p, b2) {
            h.ready().then(function() {
              s13(h._dbInfo, w, function(C, x7) {
                if (C)
                  return b2(C);
                try {
                  var V2 = x7.objectStore(h._dbInfo.storeName), N = V2.clear();
                  x7.oncomplete = function() {
                    p();
                  }, x7.onabort = x7.onerror = function() {
                    var D2 = N.error ? N.error : N.transaction.error;
                    b2(D2);
                  };
                } catch (D2) {
                  b2(D2);
                }
              });
            }).catch(b2);
          });
          return m2(a, s), a;
        }
        function hr3(s) {
          var h = this, a = new c(function(p, b2) {
            h.ready().then(function() {
              s13(h._dbInfo, B, function(C, x7) {
                if (C)
                  return b2(C);
                try {
                  var V2 = x7.objectStore(h._dbInfo.storeName), N = V2.count();
                  N.onsuccess = function() {
                    p(N.result);
                  }, N.onerror = function() {
                    b2(N.error);
                  };
                } catch (D2) {
                  b2(D2);
                }
              });
            }).catch(b2);
          });
          return m2(a, s), a;
        }
        function fr3(s, h) {
          var a = this, p = new c(function(b2, C) {
            if (s < 0) {
              b2(null);
              return;
            }
            a.ready().then(function() {
              s13(a._dbInfo, B, function(x7, V2) {
                if (x7)
                  return C(x7);
                try {
                  var N = V2.objectStore(a._dbInfo.storeName), D2 = false, Z7 = N.openKeyCursor();
                  Z7.onsuccess = function() {
                    var P2 = Z7.result;
                    if (!P2) {
                      b2(null);
                      return;
                    }
                    s === 0 || D2 ? b2(P2.key) : (D2 = true, P2.advance(s));
                  }, Z7.onerror = function() {
                    C(Z7.error);
                  };
                } catch (P2) {
                  C(P2);
                }
              });
            }).catch(C);
          });
          return m2(p, h), p;
        }
        function Cr4(s) {
          var h = this, a = new c(function(p, b2) {
            h.ready().then(function() {
              s13(h._dbInfo, B, function(C, x7) {
                if (C)
                  return b2(C);
                try {
                  var V2 = x7.objectStore(h._dbInfo.storeName), N = V2.openKeyCursor(), D2 = [];
                  N.onsuccess = function() {
                    var Z7 = N.result;
                    if (!Z7) {
                      p(D2);
                      return;
                    }
                    D2.push(Z7.key), Z7.continue();
                  }, N.onerror = function() {
                    b2(N.error);
                  };
                } catch (Z7) {
                  b2(Z7);
                }
              });
            }).catch(b2);
          });
          return m2(a, s), a;
        }
        function vr6(s, h) {
          h = O2.apply(this, arguments);
          var a = this.config();
          s = typeof s != "function" && s || {}, s.name || (s.name = s.name || a.name, s.storeName = s.storeName || a.storeName);
          var p = this, b2;
          if (!s.name)
            b2 = c.reject("Invalid arguments");
          else {
            var C = s.name === a.name && p._dbInfo.db, x7 = C ? c.resolve(p._dbInfo.db) : K7(s).then(function(V2) {
              var N = $[s.name], D2 = N.forages;
              N.db = V2;
              for (var Z7 = 0; Z7 < D2.length; Z7++)
                D2[Z7]._dbInfo.db = V2;
              return V2;
            });
            s.storeName ? b2 = x7.then(function(V2) {
              if (V2.objectStoreNames.contains(s.storeName)) {
                var N = V2.version + 1;
                A(s);
                var D2 = $[s.name], Z7 = D2.forages;
                V2.close();
                for (var P2 = 0; P2 < Z7.length; P2++) {
                  var J7 = Z7[P2];
                  J7._dbInfo.db = null, J7._dbInfo.version = N;
                }
                var o12 = new c(function(i12, C12) {
                  var f12 = d.open(s.name, N);
                  f12.onerror = function($12) {
                    var de2 = f12.result;
                    de2.close(), C12($12);
                  }, f12.onupgradeneeded = function() {
                    var $12 = f12.result;
                    $12.deleteObjectStore(s.storeName);
                  }, f12.onsuccess = function() {
                    var $12 = f12.result;
                    $12.close(), i12($12);
                  };
                });
                return o12.then(function(i12) {
                  D2.db = i12;
                  for (var C12 = 0; C12 < Z7.length; C12++) {
                    var f12 = Z7[C12];
                    f12._dbInfo.db = i12, U2(f12._dbInfo);
                  }
                }).catch(function(i12) {
                  throw (Y2(s, i12) || c.resolve()).catch(function() {
                  }), i12;
                });
              }
            }) : b2 = x7.then(function(V2) {
              A(s);
              var N = $[s.name], D2 = N.forages;
              V2.close();
              for (var Z7 = 0; Z7 < D2.length; Z7++) {
                var P2 = D2[Z7];
                P2._dbInfo.db = null;
              }
              var J7 = new c(function(o12, i12) {
                var C12 = d.deleteDatabase(s.name);
                C12.onerror = function() {
                  var f12 = C12.result;
                  f12 && f12.close(), i12(C12.error);
                }, C12.onblocked = function() {
                  console.warn('dropInstance blocked for database "' + s.name + '" until all open connections are closed');
                }, C12.onsuccess = function() {
                  var f12 = C12.result;
                  f12 && f12.close(), o12(f12);
                };
              });
              return J7.then(function(o12) {
                N.db = o12;
                for (var i12 = 0; i12 < D2.length; i12++) {
                  var C12 = D2[i12];
                  U2(C12._dbInfo);
                }
              }).catch(function(o12) {
                throw (Y2(s, o12) || c.resolve()).catch(function() {
                }), o12;
              });
            });
          }
          return m2(b2, h), b2;
        }
        var gr4 = {
          _driver: "asyncStorage",
          _initStorage: p12,
          _support: v2(),
          iterate: T12,
          getItem: R12,
          setItem: z13,
          removeItem: J12,
          clear: Q12,
          length: hr3,
          key: fr3,
          keys: Cr4,
          dropInstance: vr6
        };
        function pr3() {
          return typeof openDatabase == "function";
        }
        var P12 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/", mr3 = "~~local_forage_type~", ht3 = /^~~local_forage_type~([^~]+)~/, Me3 = "__lfsc__:", d32 = Me3.length, h3 = "arbf", f3 = "blob", ft = "si08", Ct2 = "ui08", vt3 = "uic8", gt2 = "si16", pt4 = "si32", mt4 = "ur16", bt4 = "ui32", Lt4 = "fl32", wt3 = "fl64", _t = d32 + h3.length, yt3 = Object.prototype.toString;
        function Mt3(s) {
          var h = s.length * 0.75, a = s.length, p, b2 = 0, C, x7, V2, N;
          s[s.length - 1] === "=" && (h--, s[s.length - 2] === "=" && h--);
          var D2 = new ArrayBuffer(h), Z7 = new Uint8Array(D2);
          for (p = 0; p < a; p += 4)
            C = P12.indexOf(s[p]), x7 = P12.indexOf(s[p + 1]), V2 = P12.indexOf(s[p + 2]), N = P12.indexOf(s[p + 3]), Z7[b2++] = C << 2 | x7 >> 4, Z7[b2++] = (x7 & 15) << 4 | V2 >> 2, Z7[b2++] = (V2 & 3) << 6 | N & 63;
          return D2;
        }
        function C32(s) {
          var h = new Uint8Array(s), a = "", p;
          for (p = 0; p < h.length; p += 3)
            a += P12[h[p] >> 2], a += P12[(h[p] & 3) << 4 | h[p + 1] >> 4], a += P12[(h[p + 1] & 15) << 2 | h[p + 2] >> 6], a += P12[h[p + 2] & 63];
          return h.length % 3 === 2 ? a = a.substring(0, a.length - 1) + "=" : h.length % 3 === 1 && (a = a.substring(0, a.length - 2) + "=="), a;
        }
        function br3(s, h) {
          var a = "";
          if (s && (a = yt3.call(s)), s && (a === "[object ArrayBuffer]" || s.buffer && yt3.call(s.buffer) === "[object ArrayBuffer]")) {
            var p, b2 = Me3;
            s instanceof ArrayBuffer ? (p = s, b2 += h3) : (p = s.buffer, a === "[object Int8Array]" ? b2 += ft : a === "[object Uint8Array]" ? b2 += Ct2 : a === "[object Uint8ClampedArray]" ? b2 += vt3 : a === "[object Int16Array]" ? b2 += gt2 : a === "[object Uint16Array]" ? b2 += mt4 : a === "[object Int32Array]" ? b2 += pt4 : a === "[object Uint32Array]" ? b2 += bt4 : a === "[object Float32Array]" ? b2 += Lt4 : a === "[object Float64Array]" ? b2 += wt3 : h(new Error("Failed to get type for BinaryArray"))), h(b2 + C32(p));
          } else if (a === "[object Blob]") {
            var C = new FileReader();
            C.onload = function() {
              var x7 = mr3 + s.type + "~" + C32(this.result);
              h(Me3 + f3 + x7);
            }, C.readAsArrayBuffer(s);
          } else
            try {
              h(JSON.stringify(s));
            } catch (x7) {
              console.error("Couldn't convert value into a JSON string: ", s), h(null, x7);
            }
        }
        function Lr(s) {
          if (s.substring(0, d32) !== Me3)
            return JSON.parse(s);
          var h = s.substring(_t), a = s.substring(d32, _t), p;
          if (a === f3 && ht3.test(h)) {
            var b2 = h.match(ht3);
            p = b2[1], h = h.substring(b2[0].length);
          }
          var C = Mt3(h);
          switch (a) {
            case h3:
              return C;
            case f3:
              return g([C], { type: p });
            case ft:
              return new Int8Array(C);
            case Ct2:
              return new Uint8Array(C);
            case vt3:
              return new Uint8ClampedArray(C);
            case gt2:
              return new Int16Array(C);
            case mt4:
              return new Uint16Array(C);
            case pt4:
              return new Int32Array(C);
            case bt4:
              return new Uint32Array(C);
            case Lt4:
              return new Float32Array(C);
            case wt3:
              return new Float64Array(C);
            default:
              throw new Error("Unkown type: " + a);
          }
        }
        var v3 = {
          serialize: br3,
          deserialize: Lr,
          stringToBuffer: Mt3,
          bufferToString: C32
        };
        function It3(s, h, a, p) {
          s.executeSql("CREATE TABLE IF NOT EXISTS " + h.storeName + " (id INTEGER PRIMARY KEY, key unique, value)", [], a, p);
        }
        function wr4(s) {
          var h = this, a = {
            db: null
          };
          if (s)
            for (var p in s)
              a[p] = typeof s[p] != "string" ? s[p].toString() : s[p];
          var b2 = new c(function(C, x7) {
            try {
              a.db = openDatabase(a.name, String(a.version), a.description, a.size);
            } catch (V2) {
              return x7(V2);
            }
            a.db.transaction(function(V2) {
              It3(V2, a, function() {
                h._dbInfo = a, C();
              }, function(N, D2) {
                x7(D2);
              });
            }, x7);
          });
          return a.serializer = v3, b2;
        }
        function F12(s, h, a, p, b2, C) {
          s.executeSql(a, p, b2, function(x7, V2) {
            V2.code === V2.SYNTAX_ERR ? x7.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?", [h.storeName], function(N, D2) {
              D2.rows.length ? C(N, V2) : It3(N, h, function() {
                N.executeSql(a, p, b2, C);
              }, C);
            }, C) : C(x7, V2);
          }, C);
        }
        function _r3(s, h) {
          var a = this;
          s = y(s);
          var p = new c(function(b2, C) {
            a.ready().then(function() {
              var x7 = a._dbInfo;
              x7.db.transaction(function(V2) {
                F12(V2, x7, "SELECT * FROM " + x7.storeName + " WHERE key = ? LIMIT 1", [s], function(N, D2) {
                  var Z7 = D2.rows.length ? D2.rows.item(0).value : null;
                  Z7 && (Z7 = x7.serializer.deserialize(Z7)), b2(Z7);
                }, function(N, D2) {
                  C(D2);
                });
              });
            }).catch(C);
          });
          return m2(p, h), p;
        }
        function yr4(s, h) {
          var a = this, p = new c(function(b2, C) {
            a.ready().then(function() {
              var x7 = a._dbInfo;
              x7.db.transaction(function(V2) {
                F12(V2, x7, "SELECT * FROM " + x7.storeName, [], function(N, D2) {
                  for (var Z7 = D2.rows, P2 = Z7.length, J7 = 0; J7 < P2; J7++) {
                    var o12 = Z7.item(J7), i12 = o12.value;
                    if (i12 && (i12 = x7.serializer.deserialize(i12)), i12 = s(i12, o12.key, J7 + 1), i12 !== void 0) {
                      b2(i12);
                      return;
                    }
                  }
                  b2();
                }, function(N, D2) {
                  C(D2);
                });
              });
            }).catch(C);
          });
          return m2(p, h), p;
        }
        function Ht3(s, h, a, p) {
          var b2 = this;
          s = y(s);
          var C = new c(function(x7, V2) {
            b2.ready().then(function() {
              h === void 0 && (h = null);
              var N = h, D2 = b2._dbInfo;
              D2.serializer.serialize(h, function(Z7, P2) {
                P2 ? V2(P2) : D2.db.transaction(function(J7) {
                  F12(J7, D2, "INSERT OR REPLACE INTO " + D2.storeName + " (key, value) VALUES (?, ?)", [s, Z7], function() {
                    x7(N);
                  }, function(o12, i12) {
                    V2(i12);
                  });
                }, function(J7) {
                  if (J7.code === J7.QUOTA_ERR) {
                    if (p > 0) {
                      x7(Ht3.apply(b2, [s, N, a, p - 1]));
                      return;
                    }
                    V2(J7);
                  }
                });
              });
            }).catch(V2);
          });
          return m2(C, a), C;
        }
        function Mr4(s, h, a) {
          return Ht3.apply(this, [s, h, a, 1]);
        }
        function Ir3(s, h) {
          var a = this;
          s = y(s);
          var p = new c(function(b2, C) {
            a.ready().then(function() {
              var x7 = a._dbInfo;
              x7.db.transaction(function(V2) {
                F12(V2, x7, "DELETE FROM " + x7.storeName + " WHERE key = ?", [s], function() {
                  b2();
                }, function(N, D2) {
                  C(D2);
                });
              });
            }).catch(C);
          });
          return m2(p, h), p;
        }
        function Hr2(s) {
          var h = this, a = new c(function(p, b2) {
            h.ready().then(function() {
              var C = h._dbInfo;
              C.db.transaction(function(x7) {
                F12(x7, C, "DELETE FROM " + C.storeName, [], function() {
                  p();
                }, function(V2, N) {
                  b2(N);
                });
              });
            }).catch(b2);
          });
          return m2(a, s), a;
        }
        function xr3(s) {
          var h = this, a = new c(function(p, b2) {
            h.ready().then(function() {
              var C = h._dbInfo;
              C.db.transaction(function(x7) {
                F12(x7, C, "SELECT COUNT(key) as c FROM " + C.storeName, [], function(V2, N) {
                  var D2 = N.rows.item(0).c;
                  p(D2);
                }, function(V2, N) {
                  b2(N);
                });
              });
            }).catch(b2);
          });
          return m2(a, s), a;
        }
        function Sr3(s, h) {
          var a = this, p = new c(function(b2, C) {
            a.ready().then(function() {
              var x7 = a._dbInfo;
              x7.db.transaction(function(V2) {
                F12(V2, x7, "SELECT key FROM " + x7.storeName + " WHERE id = ? LIMIT 1", [s + 1], function(N, D2) {
                  var Z7 = D2.rows.length ? D2.rows.item(0).key : null;
                  b2(Z7);
                }, function(N, D2) {
                  C(D2);
                });
              });
            }).catch(C);
          });
          return m2(p, h), p;
        }
        function Rr4(s) {
          var h = this, a = new c(function(p, b2) {
            h.ready().then(function() {
              var C = h._dbInfo;
              C.db.transaction(function(x7) {
                F12(x7, C, "SELECT key FROM " + C.storeName, [], function(V2, N) {
                  for (var D2 = [], Z7 = 0; Z7 < N.rows.length; Z7++)
                    D2.push(N.rows.item(Z7).key);
                  p(D2);
                }, function(V2, N) {
                  b2(N);
                });
              });
            }).catch(b2);
          });
          return m2(a, s), a;
        }
        function Vr2(s) {
          return new c(function(h, a) {
            s.transaction(function(p) {
              p.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'", [], function(b2, C) {
                for (var x7 = [], V2 = 0; V2 < C.rows.length; V2++)
                  x7.push(C.rows.item(V2).name);
                h({
                  db: s,
                  storeNames: x7
                });
              }, function(b2, C) {
                a(C);
              });
            }, function(p) {
              a(p);
            });
          });
        }
        function Or3(s, h) {
          h = O2.apply(this, arguments);
          var a = this.config();
          s = typeof s != "function" && s || {}, s.name || (s.name = s.name || a.name, s.storeName = s.storeName || a.storeName);
          var p = this, b2;
          return s.name ? b2 = new c(function(C) {
            var x7;
            s.name === a.name ? x7 = p._dbInfo.db : x7 = openDatabase(s.name, "", "", 0), s.storeName ? C({
              db: x7,
              storeNames: [s.storeName]
            }) : C(Vr2(x7));
          }).then(function(C) {
            return new c(function(x7, V2) {
              C.db.transaction(function(N) {
                function D2(o12) {
                  return new c(function(i12, C12) {
                    N.executeSql("DROP TABLE IF EXISTS " + o12, [], function() {
                      i12();
                    }, function(f12, $12) {
                      C12($12);
                    });
                  });
                }
                for (var Z7 = [], P2 = 0, J7 = C.storeNames.length; P2 < J7; P2++)
                  Z7.push(D2(C.storeNames[P2]));
                c.all(Z7).then(function() {
                  x7();
                }).catch(function(o12) {
                  V2(o12);
                });
              }, function(N) {
                V2(N);
              });
            });
          }) : b2 = c.reject("Invalid arguments"), m2(b2, h), b2;
        }
        var $r2 = {
          _driver: "webSQLStorage",
          _initStorage: wr4,
          _support: pr3(),
          iterate: yr4,
          getItem: _r3,
          setItem: Mr4,
          removeItem: Ir3,
          clear: Hr2,
          length: xr3,
          key: Sr3,
          keys: Rr4,
          dropInstance: Or3
        };
        function Er3() {
          try {
            return typeof localStorage < "u" && "setItem" in localStorage && // in IE8 typeof localStorage.setItem === 'object'
            !!localStorage.setItem;
          } catch {
            return false;
          }
        }
        function xt3(s, h) {
          var a = s.name + "/";
          return s.storeName !== h.storeName && (a += s.storeName + "/"), a;
        }
        function Nr4() {
          var s = "_localforage_support_test";
          try {
            return localStorage.setItem(s, true), localStorage.removeItem(s), false;
          } catch {
            return true;
          }
        }
        function Dr4() {
          return !Nr4() || localStorage.length > 0;
        }
        function Tr3(s) {
          var h = this, a = {};
          if (s)
            for (var p in s)
              a[p] = s[p];
          return a.keyPrefix = xt3(s, h._defaultConfig), Dr4() ? (h._dbInfo = a, a.serializer = v3, c.resolve()) : c.reject();
        }
        function Zr2(s) {
          var h = this, a = h.ready().then(function() {
            for (var p = h._dbInfo.keyPrefix, b2 = localStorage.length - 1; b2 >= 0; b2--) {
              var C = localStorage.key(b2);
              C.indexOf(p) === 0 && localStorage.removeItem(C);
            }
          });
          return m2(a, s), a;
        }
        function Ar2(s, h) {
          var a = this;
          s = y(s);
          var p = a.ready().then(function() {
            var b2 = a._dbInfo, C = localStorage.getItem(b2.keyPrefix + s);
            return C && (C = b2.serializer.deserialize(C)), C;
          });
          return m2(p, h), p;
        }
        function Br3(s, h) {
          var a = this, p = a.ready().then(function() {
            for (var b2 = a._dbInfo, C = b2.keyPrefix, x7 = C.length, V2 = localStorage.length, N = 1, D2 = 0; D2 < V2; D2++) {
              var Z7 = localStorage.key(D2);
              if (Z7.indexOf(C) === 0) {
                var P2 = localStorage.getItem(Z7);
                if (P2 && (P2 = b2.serializer.deserialize(P2)), P2 = s(P2, Z7.substring(x7), N++), P2 !== void 0)
                  return P2;
              }
            }
          });
          return m2(p, h), p;
        }
        function Pr(s, h) {
          var a = this, p = a.ready().then(function() {
            var b2 = a._dbInfo, C;
            try {
              C = localStorage.key(s);
            } catch {
              C = null;
            }
            return C && (C = C.substring(b2.keyPrefix.length)), C;
          });
          return m2(p, h), p;
        }
        function Fr2(s) {
          var h = this, a = h.ready().then(function() {
            for (var p = h._dbInfo, b2 = localStorage.length, C = [], x7 = 0; x7 < b2; x7++) {
              var V2 = localStorage.key(x7);
              V2.indexOf(p.keyPrefix) === 0 && C.push(V2.substring(p.keyPrefix.length));
            }
            return C;
          });
          return m2(a, s), a;
        }
        function kr2(s) {
          var h = this, a = h.keys().then(function(p) {
            return p.length;
          });
          return m2(a, s), a;
        }
        function jr3(s, h) {
          var a = this;
          s = y(s);
          var p = a.ready().then(function() {
            var b2 = a._dbInfo;
            localStorage.removeItem(b2.keyPrefix + s);
          });
          return m2(p, h), p;
        }
        function Ur2(s, h, a) {
          var p = this;
          s = y(s);
          var b2 = p.ready().then(function() {
            h === void 0 && (h = null);
            var C = h;
            return new c(function(x7, V2) {
              var N = p._dbInfo;
              N.serializer.serialize(h, function(D2, Z7) {
                if (Z7)
                  V2(Z7);
                else
                  try {
                    localStorage.setItem(N.keyPrefix + s, D2), x7(C);
                  } catch (P2) {
                    (P2.name === "QuotaExceededError" || P2.name === "NS_ERROR_DOM_QUOTA_REACHED") && V2(P2), V2(P2);
                  }
              });
            });
          });
          return m2(b2, a), b2;
        }
        function zr4(s, h) {
          if (h = O2.apply(this, arguments), s = typeof s != "function" && s || {}, !s.name) {
            var a = this.config();
            s.name = s.name || a.name, s.storeName = s.storeName || a.storeName;
          }
          var p = this, b2;
          return s.name ? b2 = new c(function(C) {
            s.storeName ? C(xt3(s, p._defaultConfig)) : C(s.name + "/");
          }).then(function(C) {
            for (var x7 = localStorage.length - 1; x7 >= 0; x7--) {
              var V2 = localStorage.key(x7);
              V2.indexOf(C) === 0 && localStorage.removeItem(V2);
            }
          }) : b2 = c.reject("Invalid arguments"), m2(b2, h), b2;
        }
        var Wr2 = {
          _driver: "localStorageWrapper",
          _initStorage: Tr3,
          _support: Er3(),
          iterate: Br3,
          getItem: Ar2,
          setItem: Ur2,
          removeItem: jr3,
          clear: Zr2,
          length: kr2,
          key: Pr,
          keys: Fr2,
          dropInstance: zr4
        }, Yr3 = function(h, a) {
          return h === a || typeof h == "number" && typeof a == "number" && isNaN(h) && isNaN(a);
        }, Gr2 = function(h, a) {
          for (var p = h.length, b2 = 0; b2 < p; ) {
            if (Yr3(h[b2], a))
              return true;
            b2++;
          }
          return false;
        }, St3 = Array.isArray || function(s) {
          return Object.prototype.toString.call(s) === "[object Array]";
        }, ue2 = {}, Rt = {}, K13 = {
          INDEXEDDB: gr4,
          WEBSQL: $r2,
          LOCALSTORAGE: Wr2
        }, Xr4 = [K13.INDEXEDDB._driver, K13.WEBSQL._driver, K13.LOCALSTORAGE._driver], Ie = ["dropInstance"], g3 = ["clear", "getItem", "iterate", "key", "keys", "length", "removeItem", "setItem"].concat(Ie), qr4 = {
          description: "",
          driver: Xr4.slice(),
          name: "localforage",
          // Default DB size is _JUST UNDER_ 5MB, as it's the highest size
          // we can use without a prompt.
          size: 4980736,
          storeName: "keyvaluepairs",
          version: 1
        };
        function Jr4(s, h) {
          s[h] = function() {
            var a = arguments;
            return s.ready().then(function() {
              return s[h].apply(s, a);
            });
          };
        }
        function p3() {
          for (var s = 1; s < arguments.length; s++) {
            var h = arguments[s];
            if (h)
              for (var a in h)
                h.hasOwnProperty(a) && (St3(h[a]) ? arguments[0][a] = h[a].slice() : arguments[0][a] = h[a]);
          }
          return arguments[0];
        }
        var Qr2 = function() {
          function s(h) {
            i(this, s);
            for (var a in K13)
              if (K13.hasOwnProperty(a)) {
                var p = K13[a], b2 = p._driver;
                this[a] = b2, ue2[b2] || this.defineDriver(p);
              }
            this._defaultConfig = p3({}, qr4), this._config = p3({}, this._defaultConfig, h), this._driverSet = null, this._initDriver = null, this._ready = false, this._dbInfo = null, this._wrapLibraryMethodsWithReady(), this.setDriver(this._config.driver).catch(function() {
            });
          }
          return s.prototype.config = function(a) {
            if ((typeof a > "u" ? "undefined" : l(a)) === "object") {
              if (this._ready)
                return new Error("Can't call config() after localforage has been used.");
              for (var p in a) {
                if (p === "storeName" && (a[p] = a[p].replace(/\W/g, "_")), p === "version" && typeof a[p] != "number")
                  return new Error("Database version must be a number.");
                this._config[p] = a[p];
              }
              return "driver" in a && a.driver ? this.setDriver(this._config.driver) : true;
            } else return typeof a == "string" ? this._config[a] : this._config;
          }, s.prototype.defineDriver = function(a, p, b2) {
            var C = new c(function(x7, V2) {
              try {
                var N = a._driver, D2 = new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");
                if (!a._driver) {
                  V2(D2);
                  return;
                }
                for (var Z7 = g3.concat("_initStorage"), P2 = 0, J7 = Z7.length; P2 < J7; P2++) {
                  var o12 = Z7[P2], i12 = !Gr2(Ie, o12);
                  if ((i12 || a[o12]) && typeof a[o12] != "function") {
                    V2(D2);
                    return;
                  }
                }
                var C12 = function() {
                  for (var de2 = function(t22) {
                    return function() {
                      var n2 = new Error("Method " + t22 + " is not implemented by the current driver"), Vt = c.reject(n2);
                      return m2(Vt, arguments[arguments.length - 1]), Vt;
                    };
                  }, m3 = 0, e23 = Ie.length; m3 < e23; m3++) {
                    var b3 = Ie[m3];
                    a[b3] || (a[b3] = de2(b3));
                  }
                };
                C12();
                var f12 = function(de2) {
                  ue2[N] && console.info("Redefining LocalForage driver: " + N), ue2[N] = a, Rt[N] = de2, x7();
                };
                "_support" in a ? a._support && typeof a._support == "function" ? a._support().then(f12, V2) : f12(!!a._support) : f12(true);
              } catch ($12) {
                V2($12);
              }
            });
            return L(C, p, b2), C;
          }, s.prototype.driver = function() {
            return this._driver || null;
          }, s.prototype.getDriver = function(a, p, b2) {
            var C = ue2[a] ? c.resolve(ue2[a]) : c.reject(new Error("Driver not found."));
            return L(C, p, b2), C;
          }, s.prototype.getSerializer = function(a) {
            var p = c.resolve(v3);
            return L(p, a), p;
          }, s.prototype.ready = function(a) {
            var p = this, b2 = p._driverSet.then(function() {
              return p._ready === null && (p._ready = p._initDriver()), p._ready;
            });
            return L(b2, a, a), b2;
          }, s.prototype.setDriver = function(a, p, b2) {
            var C = this;
            St3(a) || (a = [a]);
            var x7 = this._getSupportedDrivers(a);
            function V2() {
              C._config.driver = C.driver();
            }
            function N(P2) {
              return C._extend(P2), V2(), C._ready = C._initStorage(C._config), C._ready;
            }
            function D2(P2) {
              return function() {
                var J7 = 0;
                function o12() {
                  for (; J7 < P2.length; ) {
                    var i12 = P2[J7];
                    return J7++, C._dbInfo = null, C._ready = null, C.getDriver(i12).then(N).catch(o12);
                  }
                  V2();
                  var C12 = new Error("No available storage method found.");
                  return C._driverSet = c.reject(C12), C._driverSet;
                }
                return o12();
              };
            }
            var Z7 = this._driverSet !== null ? this._driverSet.catch(function() {
              return c.resolve();
            }) : c.resolve();
            return this._driverSet = Z7.then(function() {
              var P2 = x7[0];
              return C._dbInfo = null, C._ready = null, C.getDriver(P2).then(function(J7) {
                C._driver = J7._driver, V2(), C._wrapLibraryMethodsWithReady(), C._initDriver = D2(x7);
              });
            }).catch(function() {
              V2();
              var P2 = new Error("No available storage method found.");
              return C._driverSet = c.reject(P2), C._driverSet;
            }), L(this._driverSet, p, b2), this._driverSet;
          }, s.prototype.supports = function(a) {
            return !!Rt[a];
          }, s.prototype._extend = function(a) {
            p3(this, a);
          }, s.prototype._getSupportedDrivers = function(a) {
            for (var p = [], b2 = 0, C = a.length; b2 < C; b2++) {
              var x7 = a[b2];
              this.supports(x7) && p.push(x7);
            }
            return p;
          }, s.prototype._wrapLibraryMethodsWithReady = function() {
            for (var a = 0, p = g3.length; a < p; a++)
              Jr4(this, g3[a]);
          }, s.prototype.createInstance = function(a) {
            return new s(a);
          }, s;
        }(), Kr3 = new Qr2();
        r.exports = Kr3;
      }, { 3: 3 }] }, {}, [4])(4);
    });
  }(S3)), S3.exports;
}
var Qo2 = Jo();
var W12 = qo2(Qo2);
var cr = class {
  getItem(t8) {
    return W12.getItem(t8);
  }
  setItem(t8, n) {
    return W12.setItem(t8, n);
  }
  removeItem(t8) {
    return W12.removeItem(t8);
  }
  clear() {
    return W12.clear();
  }
  key(t8) {
    return W12.key(t8);
  }
  keys() {
    return W12.keys();
  }
  iterate(t8) {
    return W12.iterate(t8);
  }
};
var Ko = Object.getOwnPropertyDescriptor;
var ei2 = (e, t8, n, r) => {
  for (var o = r > 1 ? void 0 : r ? Ko(t8, n) : t8, l = e.length - 1, i; l >= 0; l--)
    (i = e[l]) && (o = i(o) || o);
  return o;
};
var i9 = (e, t8) => (n, r) => t8(n, r, e);
var Ke = class extends Ve {
  constructor(e, t8) {
    super(), this._injector = e, this._uiPartsService = t8, this._initUIPart();
  }
  _initUIPart() {
    this.disposeWithMe(
      this._uiPartsService.registerComponent(c12.GLOBAL, () => connectInjector(NE, this._injector))
    );
  }
  dispose() {
    _E2();
  }
  show(e) {
    let t8 = e;
    return typeof e.id > "u" && (t8 = Object.assign({}, e, { id: `message-${Date.now()}` })), DE2(t8), We(() => _E2(t8.id));
  }
  remove(e) {
    _E2(e);
  }
  removeAll() {
    _E2();
  }
};
Ke = ei2([
  i9(0, Inject(Injector)),
  i9(1, D1)
], Ke);
function ti2() {
  const e = useDependency(Gi), t8 = useObservable(e.darkMode$);
  return (0, import_jsx_runtime2.jsx)(BE, { theme: t8 ? "dark" : "light" });
}
var ni = {
  show: (e) => {
    const {
      type: t8 = "message",
      title: n,
      content: r,
      duration: o,
      closable: l = true,
      position: i = "top-right"
    } = e;
    WE[t8](n, {
      position: i,
      description: r,
      duration: o,
      closeButton: l
    });
  }
};
var ri2 = Object.getOwnPropertyDescriptor;
var oi = (e, t8, n, r) => {
  for (var o = r > 1 ? void 0 : r ? ri2(t8, n) : t8, l = e.length - 1, i; l >= 0; l--)
    (i = e[l]) && (o = i(o) || o);
  return o;
};
var l9 = (e, t8) => (n, r) => t8(n, r, e);
var e3 = class extends Ve {
  constructor(e, t8) {
    super(), this._injector = e, this._uiPartsService = t8, this._initUIPart();
  }
  show(e) {
    return ni.show(e), We(() => {
    });
  }
  _initUIPart() {
    this.disposeWithMe(
      this._uiPartsService.registerComponent(c12.GLOBAL, () => connectInjector(ti2, this._injector))
    );
  }
};
e3 = oi([
  l9(0, Inject(Injector)),
  l9(1, D1)
], e3);
var ur = class {
  constructor() {
    F(this, "_sidebarOptions", {});
    F(this, "sidebarOptions$", new Subject());
    F(this, "scrollEvent$", new Subject());
    F(this, "_container");
  }
  get visible() {
    return this._sidebarOptions.visible || false;
  }
  get options() {
    return this._sidebarOptions;
  }
  open(t8) {
    return this._sidebarOptions = {
      ...t8,
      id: t8.id,
      visible: true
    }, this.sidebarOptions$.next(this._sidebarOptions), We(() => {
      this.close();
    });
  }
  close(t8) {
    t8 && this._sidebarOptions.id !== t8 || (this._sidebarOptions = {
      ...this._sidebarOptions,
      visible: false
    }, this.sidebarOptions$.next(this._sidebarOptions), this._sidebarOptions.onClose && this._sidebarOptions.onClose());
  }
  getContainer() {
    return this._container;
  }
  setContainer(t8) {
    this._container = t8;
  }
};
var ii = Object.getOwnPropertyDescriptor;
var li = (e, t8, n, r) => {
  for (var o = r > 1 ? void 0 : r ? ii(t8, n) : t8, l = e.length - 1, i; l >= 0; l--)
    (i = e[l]) && (o = i(o) || o);
  return o;
};
var si = (e, t8) => (n, r) => t8(n, r, e);
var t3 = class {
  constructor(e) {
    F(this, "visible$", new BehaviorSubject(false));
    F(this, "componentKey$", new ReplaySubject());
    F(this, "_temporaryHidden$", new BehaviorSubject(false));
    F(this, "temporaryHidden$", this._temporaryHidden$.asObservable());
    F(this, "_visible", false);
    this._componentManager = e;
  }
  get visible() {
    return this._visible;
  }
  get temporaryHidden() {
    return this._temporaryHidden$.getValue();
  }
  dispose() {
    this.visible$.next(false), this.visible$.complete(), this.componentKey$.complete();
  }
  hide() {
    this._temporaryHidden$.next(true);
  }
  show() {
    this._temporaryHidden$.next(false);
  }
  set(e, t8) {
    return this._componentManager.register(e, t8), this.componentKey$.next(e), We(() => {
      this._componentManager.delete(e), this.visible$.complete(), this.componentKey$.complete();
    });
  }
  open() {
    this._visible = true, this.visible$.next(true);
  }
  close() {
    this._visible = false, this.visible$.next(false);
  }
};
t3 = li([
  si(0, Inject(S1))
], t3);
var ai2 = Object.defineProperty;
var ci = Object.getOwnPropertyDescriptor;
var ui2 = (e, t8, n) => t8 in e ? ai2(e, t8, { enumerable: true, configurable: true, writable: true, value: n }) : e[t8] = n;
var di = (e, t8, n, r) => {
  for (var o = r > 1 ? void 0 : r ? ci(t8, n) : t8, l = e.length - 1, i; l >= 0; l--)
    (i = e[l]) && (o = i(o) || o);
  return o;
};
var R3 = (e, t8) => (n, r) => t8(n, r, e);
var hi = (e, t8, n) => ui2(e, t8 + "", n);
var fi = "UNIVER_MOBILE_UI_PLUGIN";
var Ci = "DISABLE_AUTO_FOCUS";
var F3 = class extends Ol {
  constructor(e = Ue2, t8, n, r) {
    super(), this._config = e, this._contextService = t8, this._injector = n, this._configService = r;
    const { menu: o, ...l } = oo(
      {
        popupRootId: `univer-popup-portal-${et(6)}`
      },
      Ue2,
      this._config
    );
    l.disableAutoFocus && this._contextService.setContextValue(Ci, true), o && this._configService.setConfig("menu", o, { merge: true }), this._configService.setConfig(_e2, l);
  }
  onStarting() {
    GC(this._injector, nC([
      [S1],
      [a3],
      [Pe2],
      [G3],
      [D1, { useClass: Yn }],
      [U1, { useClass: Fe2 }],
      [ye3, { useClass: ze }],
      [tt, { useClass: Un }],
      [B12, { useClass: je }],
      [c32, { useClass: er }],
      [lr, { useClass: Ge, lazy: true }],
      [u3, { useClass: e3, lazy: true }],
      [ut, { useClass: Je3, lazy: true }],
      [ct2, { useClass: qe3, lazy: true }],
      [at, { useClass: Xe2, lazy: true }],
      [we3, { useClass: ur, lazy: true }],
      [st2, { useClass: t3, lazy: true }],
      [lt2, { useClass: Qe, lazy: true }],
      [et2, { useClass: Ke, lazy: true }],
      [XR, { useClass: cr, lazy: true }],
      [ir2, { useClass: Ye2 }],
      [ar, { useClass: sr3 }],
      [rt3, { useClass: Xn }],
      [nt2],
      [
        We3,
        {
          useFactory: (e) => e.createInstance(P3, this._config),
          deps: [Injector]
        }
      ],
      [ie4],
      [oe],
      [le]
    ], this._config.override)), zc(this._injector, [
      [We3],
      [oe]
    ]);
  }
  onReady() {
    zc(this._injector, [
      [ie4]
    ]);
  }
  onSteady() {
    zc(this._injector, [
      [le]
    ]);
  }
};
hi(F3, "pluginName", fi);
F3 = di([
  qR(o7),
  R3(1, Nr),
  R3(2, Inject(Injector)),
  R3(3, ic)
], F3);
var vi = Object.defineProperty;
var gi = Object.getOwnPropertyDescriptor;
var pi = (e, t8, n) => t8 in e ? vi(e, t8, { enumerable: true, configurable: true, writable: true, value: n }) : e[t8] = n;
var mi = (e, t8, n, r) => {
  for (var o = r > 1 ? void 0 : r ? gi(t8, n) : t8, l = e.length - 1, i; l >= 0; l--)
    (i = e[l]) && (o = i(o) || o);
  return o;
};
var V3 = (e, t8) => (n, r) => t8(n, r, e);
var bi = (e, t8, n) => pi(e, t8 + "", n);
var Li = "UNIVER_UI_PLUGIN";
var wi2 = "DISABLE_AUTO_FOCUS";
var k3 = class extends Ol {
  constructor(e = Ue2, t8, n, r) {
    super(), this._config = e, this._contextService = t8, this._injector = n, this._configService = r;
    const { menu: o, ...l } = oo(
      {
        popupRootId: `univer-popup-portal-${et(6)}`
      },
      Ue2,
      this._config
    );
    l.disableAutoFocus && this._contextService.setContextValue(wi2, true), o && this._configService.setConfig("menu", o, { merge: true }), this._configService.setConfig(_e2, l);
  }
  onStarting() {
    GC(this._injector, nC([
      [S1],
      [a3],
      [Pe2],
      [G3],
      [D1, { useClass: Yn }],
      [U1, { useClass: Fe2 }],
      [ye3, { useClass: ze }],
      [tt, { useClass: Un }],
      [B12, { useClass: je }],
      [c32, { useClass: er }],
      [lr, { useClass: Ge, lazy: true }],
      [u3, { useClass: e3, lazy: true }],
      [ut, { useClass: Je3, lazy: true }],
      [ct2, { useClass: qe3, lazy: true }],
      [at, { useClass: Xe2, lazy: true }],
      [we3, { useClass: ur, lazy: true }],
      [st2, { useClass: t3, lazy: true }],
      [lt2, { useClass: Qe, lazy: true }],
      [et2, { useClass: Ke, lazy: true }],
      [XR, { useClass: cr, lazy: true }],
      [ir2, { useClass: Ye2 }],
      [ar, { useClass: sr3 }],
      [rt3, { useClass: Xn }],
      [nt2],
      [We3, {
        useFactory: (e) => e.createInstance(B3, this._config),
        deps: [Injector]
      }],
      [ie4],
      [oe],
      [le]
    ], this._config.override)), zc(this._injector, [
      [We3],
      [oe]
    ]);
  }
  onReady() {
    zc(this._injector, [
      [ie4]
    ]);
  }
  onSteady() {
    zc(this._injector, [
      [le]
    ]);
  }
};
bi(k3, "pluginName", Li);
k3 = mi([
  qR(o7),
  V3(1, Nr),
  V3(2, Inject(Injector)),
  V3(3, ic)
], k3);
var n7 = class {
  show(t8) {
    return We(() => {
    });
  }
  remove(t8) {
  }
  removeAll() {
  }
  setContainer() {
  }
  getContainer() {
  }
};
var r7 = (e) => {
  const n = useDependency(we3).getContainer();
  (0, import_react2.useEffect)(() => {
    if (n)
      return n.addEventListener("mousedown", e), () => {
        n.removeEventListener("mousedown", e);
      };
  }, [e, n]);
};
function O32(e) {
  return e.length === 0 ? e : e.replace(/^\s+|\s+$/gm, "");
}
var _i = 0.75;
var s9 = 78;
var a9 = 9;
function dr(e) {
  var u;
  let t8 = e.childNodes;
  if (t8.length === 0)
    return e.textContent;
  if (t8[0].nodeName === "DIV" && (t8 = t8[0].childNodes), t8.length === 1 && t8[0].nodeName === "#text")
    return t8[0].textContent;
  const n = [];
  let r = 0, o = 0, l = e.textContent || "";
  l += `\r
`;
  for (let d = 0; d < t8.length; d++) {
    let v2 = t8[`${d}`], g;
    v2.nodeName === "#text" ? (g = (u = v2.textContent) != null ? u : "", v2 = v2.parentElement) : g = v2.innerText;
    const c = dt(v2);
    yi(g).forEach((L) => {
      const y = L.length;
      o += y, r = o - y;
      const O2 = et(6);
      n.push({
        sId: O2,
        st: r,
        ed: o - 1,
        ts: c
      });
    });
  }
  return {
    id: et(6),
    body: {
      dataStream: l,
      textRuns: n
    },
    documentStyle: {}
  };
}
function dt(e, t8 = "") {
  var i, u;
  let n = (u = (i = e == null ? void 0 : e.style) == null ? void 0 : i.cssText) != null ? u : "";
  if (n += t8, n = n.replace(/[\r\n]+/g, ""), n.length === 0)
    return {};
  const r = n.split(";"), o = {}, l = {
    t: "",
    r: "",
    b: "",
    l: ""
  };
  return r.forEach((d) => {
    var m2;
    const v2 = d.toLowerCase(), g = O32(v2.substr(0, v2.indexOf(":"))), c = O32(v2.substr(v2.indexOf(":") + 1));
    if (g === "font-weight")
      c === "bold" || c === "700" ? o.bl = 1 : o.bl = 0;
    else if (g === "font-style")
      c === "italic" ? o.it = 1 : o.it = 0;
    else if (g === "font-family") {
      const L = O32(d), y = Hi(L);
      o.ff = y;
    } else if (g === "font-size") {
      let L = Number.parseInt(c);
      n.indexOf("vertical-align") > -1 && (n.indexOf("sub") > -1 || n.indexOf("sup") > -1) && (L *= 2), c.indexOf("px") !== -1 && (L = Ii(Number.parseInt(c, 10))), o.fs = L;
    } else if (g === "color") {
      const L = new bt(c);
      o.cl = {
        rgb: L.isValid ? L.toRgbString() : "rgb(0,0,0)"
      };
    } else if (g === "background" || g === "background-color") {
      const L = new bt(c);
      L.isValid && (o.bg = {
        rgb: L.toRgbString()
      });
    } else if (g === "text-decoration-line")
      c === "underline" ? (o.ul || (o.ul = { s: 1 }), o.ul.s = 1) : c === "line-through" ? (o.st || (o.st = { s: 1 }), o.st.s = 1) : c === "overline" && (o.ol || (o.ol = { s: 1 }), o.ol.s = 1);
    else if (g === "text-decoration-color")
      o.hasOwnProperty("ul") && (o.ul || (o.ul = { s: 1, cl: { rgb: c } }), o.ul.cl = {
        rgb: c
      }), o.hasOwnProperty("st") && (o.st || (o.st = { s: 1, cl: { rgb: c } }), o.st.cl = {
        rgb: c
      }), o.hasOwnProperty("ol") && (o.ol || (o.ol = { s: 1, cl: { rgb: c } }), o.ol.cl = {
        rgb: c
      });
    else if (g === "text-decoration-style")
      o.hasOwnProperty("ul") && (o.ul || (o.ul = { s: 1, t: Number(c) }), o.ul.t = Number(c)), o.hasOwnProperty("st") && (o.st || (o.st = { s: 1, t: Number(c) }), o.st.t = Number(c)), o.hasOwnProperty("ol") && (o.ol || (o.ol = { s: 1, t: Number(c) }), o.ol.t = Number(c));
    else if (g === "text-decoration" || g === "univer-strike") {
      const L = (m2 = c.split(" ")) == null ? void 0 : m2[0];
      L === "underline" ? (o.ul || (o.ul = { s: 1 }), o.ul.s = 1) : L === "line-through" ? (o.st || (o.st = { s: 1 }), o.st.s = 1) : L === "overline" && (o.ol || (o.ol = { s: 1 }), o.ol.s = 1);
    }
    if (g === "univer-underline" && (o.ul = {
      s: 1
    }), g === "vertical-align" && (c === "sub" ? o.va = Zt.SUBSCRIPT : c === "super" ? o.va = Zt.SUPERSCRIPT : c === "top" ? o.vt = 1 : c === "middle" ? o.vt = 2 : c === "bottom" ? o.vt = 3 : o.va = Zt.NORMAL), g === "transform") {
      const L = c.split(")"), y = L.findIndex((O2) => O2.includes("rotate"));
      if (y > -1) {
        const O2 = L[y].match(/\d+/g);
        let S = 0, _3 = 0;
        O2 != null && O2.length && (S = +O2[0]), e != null && e.dataset.vertical && (_3 = +e.dataset.vertical), o.tr = {
          a: S,
          v: _3
        };
      }
    }
    if (g === "text-align" && (c === "left" ? o.ht = 1 : c === "center" ? o.ht = 2 : c === "right" ? o.ht = 3 : c === "justify" ? o.ht = 4 : o.ht = 0), o.tb !== 1 && (g === "overflow-wrap" || g === "word-wrap" ? c === "break-word" && (o.tb = 3) : g === "text-overflow" ? c === "clip" && (o.tb = 2) : g === "text-break" && c === "overflow" && (o.tb = 1)), g === "white-space" && (c === "nowrap" ? o.tb = 1 : c === "normal" ? o.tb = 3 : c === "clip" && (o.tb = 2)), g === "border-color") {
      const L = c9(c, ")");
      if (o.bd)
        for (const y in L)
          o.bd[y].cl.rgb = L[y];
      else {
        o.bd = {
          b: {
            cl: {
              rgb: "#000"
            },
            s: 0
          },
          t: {
            cl: {
              rgb: "#000"
            },
            s: 0
          },
          l: {
            cl: {
              rgb: "#000"
            },
            s: 0
          },
          r: {
            cl: {
              rgb: "#000"
            },
            s: 0
          }
        };
        for (const y in L)
          o.bd[y].cl.rgb = L[y];
      }
    }
    if (g === "border-width" || g === "border-style") {
      const L = c9(c, " ");
      for (const y in L)
        l[y] += ` ${L[y]}`;
      o.bd ? (o.bd.b.s = W1(l.b), o.bd.t.s = W1(l.t), o.bd.l.s = W1(l.l), o.bd.r.s = W1(l.r)) : o.bd = {
        b: {
          cl: {
            rgb: "#000"
          },
          s: W1(l.b)
        },
        t: {
          cl: {
            rgb: "#000"
          },
          s: W1(l.t)
        },
        l: {
          cl: {
            rgb: "#000"
          },
          s: W1(l.l)
        },
        r: {
          cl: {
            rgb: "#000"
          },
          s: W1(l.r)
        }
      };
    }
    if (g === "border-bottom" || g === "border-top" || g === "border-left" || g === "border-right" || g === "border") {
      o.bd || (o.bd = {});
      const L = c.split(" "), y = `${L[0]} ${L[1]}`;
      L.splice(0, 2);
      const O2 = L.join("");
      if (W1(y) !== Le.NONE && O2) {
        const _3 = {
          cl: {
            rgb: O2
          },
          s: W1(y)
        };
        g === "border-bottom" ? o.bd.b = c === "none" ? null : _3 : g === "border-top" ? o.bd.t = c === "none" ? null : _3 : g === "border-left" ? o.bd.l = c === "none" ? null : _3 : g === "border-right" ? o.bd.r = c === "none" ? null : _3 : g === "border" && (o.bd = {
          r: c === "none" ? null : _3,
          t: c === "none" ? null : _3,
          b: c === "none" ? null : _3,
          l: c === "none" ? null : _3
        });
      }
    } else if (g === "--data-rotate") {
      const L = /[+-]?\d+/, y = c.match(L);
      c === "(0deg ,1)" ? o.tr = { a: 0, v: 1 } : y && (o.tr = { a: Number(y[0]) });
    }
  }), Object.keys(o).forEach((d) => {
    typeof o[d] == "object" && !Object.keys(o[d]).length && delete o[d];
  }), o;
}
function c9(e, t8) {
  let n;
  t8 === " " ? n = e.trim().split(t8) : n = e.trim().split(t8).slice(0, -1), n.forEach((o) => `${o.trim()})`);
  let r = {};
  return n.length === 1 ? r = {
    t: n[0],
    r: n[0],
    b: n[0],
    l: n[0]
  } : n.length === 2 ? r = {
    t: n[0],
    r: n[1],
    b: n[0],
    l: n[1]
  } : n.length === 3 ? r = {
    t: n[0],
    r: n[1],
    b: n[2],
    l: n[1]
  } : n.length === 4 && (r = {
    t: n[0],
    r: n[1],
    b: n[2],
    l: n[3]
  }), r;
}
function yi(e) {
  if (e === "") return [e];
  const t8 = /(?:(\n+.+)|(.+))/g;
  return e.match(t8).map((o) => o.replace(/\n/g, `\r
`));
}
function o72(e) {
  const t8 = document.createElement("DIV"), n = [];
  t8.innerHTML = e;
  const r = t8.querySelectorAll("table col");
  if (!r.length) return [];
  for (let o = 0; o < r.length; o++) {
    const l = r[o], i = l.getAttribute("span");
    if (i && +i > 1)
      for (let u = 0; u < +i; u++) {
        const d = n3(l.getAttribute("width"), 72);
        n.push(d);
      }
    else {
      const u = n3(l.getAttribute("width"), 72);
      n.push(u);
    }
  }
  return n;
}
function n3(e, t8) {
  if (!e) return t8;
  let n;
  return e.includes("pt") ? n = aB(Number.parseFloat(e)) : e.includes("px") ? n = Number.parseFloat(e) : n = Number.parseFloat(e) * 72 / 96, n;
}
function i7(e) {
  const t8 = document.createElement("DIV"), n = [];
  t8.innerHTML = e;
  const r = t8.querySelectorAll("table tr");
  if (!r.length) return [];
  for (let o = 0; o < r.length; o++) {
    const i = r[o].querySelectorAll("td");
    let u = n3(i[0].style.height, 19);
    for (let d = 0; d < i.length; d++) {
      const v2 = i[d].getAttribute("rowSpan");
      if (!(v2 && +v2 > 1)) {
        u = n3(i[d].style.height, 19);
        break;
      }
    }
    n.push(u);
  }
  return n;
}
function l7(e) {
  let t8 = [];
  const n = document.createElement("DIV");
  if (n.innerHTML = e, t8 = new Array(n.querySelectorAll("table tr").length), !t8.length) return [];
  let r = 0;
  const o = n.querySelectorAll("table tr");
  o[0].querySelectorAll("td").forEach((u) => {
    let d = 0;
    const v2 = u.getAttribute("colSpan");
    v2 !== null ? d = +v2 : d = 1, r += d;
  });
  for (let u = 0; u < t8.length; u++)
    t8[u] = new Array(r);
  let i = 0;
  return o.forEach((u) => {
    let d = 0;
    u.querySelectorAll("td").forEach((v2) => {
      var L, y;
      const g = {};
      if (v2.querySelectorAll("span").length || v2.querySelectorAll("font").length) {
        const O2 = dr(v2);
        typeof O2 != "string" && (g.p = O2);
      }
      const c = v2.innerText;
      c.trim().length === 0 ? g.v = "" : g.v = c;
      const m2 = dt(v2);
      for (J.isPlainObject(m2) && (g.s = m2); d < r && t8[i][d] != null; )
        d++;
      if (d !== r) {
        if (t8[i][d] == null) {
          t8[i][d] = g;
          const O2 = (L = Number(v2.getAttribute("rowSpan"))) != null ? L : 1, S = (y = Number(v2.getAttribute("colSpan"))) != null ? y : 1;
          if (O2 > 1 || S > 1) {
            const _3 = { rs: +O2 - 1, cs: +S - 1, r: i, c: d };
            t8[i][d].mc = _3;
            for (let $ = 0; $ < O2; $++)
              for (let R = 0; R < S; R++)
                $ === 0 && R === 0 || (t8[i + $][d + R] = { mc: null });
          }
        }
        d++;
      }
    }), i++;
  }), t8;
}
function s72(e) {
  const t8 = [], n = document.createElement("DIV");
  n.innerHTML = e;
  const o = e.replace(/\r/g, "").split(`
`), l = o[0].split("	").length;
  for (let i = 0; i < o.length; i++)
    o[i].split("	").length < l || t8.push(o[i].split("	"));
  for (let i = 0; i < t8.length; i++)
    for (let u = 0; u < t8[i].length; u++)
      t8[i][u].length ? t8[i][u] = {
        v: t8[i][u] || "",
        m: t8[i][u] || ""
      } : t8[i][u] = null;
  return t8;
}
function a7(e, t8) {
  e.length, e[0].length;
  let n = 0, r = 0;
  t8 && (n = t8.startRow, r = t8.startColumn);
  const o = [];
  for (let l = 0; l < e.length; l++)
    for (let i = 0; i < e[l].length; i++)
      if (e[l][i] && typeof e[l][i] == "object" && "mc" in e[l][i])
        if (e[l][i].mc) {
          const u = e[l][i].mc, d = u.r + n, v2 = d + u.rs, g = u.c + r, c = g + u.cs;
          o.push({ startRow: d, endRow: v2, startColumn: g, endColumn: c }), delete e[l][i].mc;
        } else
          e[l][i] = null;
  return {
    data: e,
    mergeData: o
  };
}
function c7(e) {
  var v2;
  let t8 = [];
  const n = document.createElement("html");
  n.innerHTML = e;
  const r = (v2 = n.querySelector("style")) == null ? void 0 : v2.innerText;
  if (!r) return;
  const o = Mi(r);
  if (t8 = new Array(n.querySelectorAll("table tr").length), !t8.length) return [];
  let l = 0;
  const i = n.querySelectorAll("table tr");
  i[0].querySelectorAll("td").forEach((g) => {
    let c = 0;
    const m2 = g.getAttribute("colSpan");
    m2 !== null ? c = +m2 : c = 1, l += c;
  });
  for (let g = 0; g < t8.length; g++)
    t8[g] = new Array(l);
  let d = 0;
  return i.forEach((g) => {
    let c = 0;
    g.querySelectorAll("td").forEach((m2) => {
      var _3, $;
      const L = {};
      if (m2.querySelectorAll("span").length || m2.querySelectorAll("font").length) {
        const R = dr(m2);
        typeof R != "string" && (L.p = R);
      }
      const y = m2.innerText;
      y.trim().length === 0 ? L.v = "" : L.v = y;
      let O2 = "";
      for (const R in o)
        m2.classList.contains(R) && (O2 += o[R]);
      const S = dt(m2, O2);
      for (J.isPlainObject(S) && (L.s = S); c < l && t8[d][c] != null; )
        c++;
      if (c !== l) {
        if (t8[d][c] == null) {
          t8[d][c] = L;
          const R = (_3 = Number(m2.getAttribute("rowSpan"))) != null ? _3 : 1, B = ($ = Number(m2.getAttribute("colSpan"))) != null ? $ : 1;
          if (R > 1 || B > 1) {
            const w = { rs: +R - 1, cs: +B - 1, r: d, c };
            t8[d][c].mc = w;
            for (let E = 0; E < R; E++)
              for (let T = 0; T < B; T++)
                E === 0 && T === 0 || (t8[d + E][c + T] = { mc: null });
          }
        }
        c++;
      }
    }), d++;
  }), t8;
}
function Mi(e) {
  const t8 = {}, n = e.replaceAll("<!--", "").replaceAll("-->", "").trim(), r = n == null ? void 0 : n.replaceAll("	", "").replaceAll(`
`, "").split("}");
  for (let o = 0; o < r.length; o++) {
    if (!r[o]) continue;
    let l = r[o].split("{")[0].trim();
    l.includes(".") && (l = l.slice(1));
    const i = r[o].split("{")[1].trim();
    t8[l] = i;
  }
  return t8;
}
function Ii(e) {
  const t8 = Math.round(e * _i);
  return t8 < a9 ? a9 : t8 > s9 ? s9 : t8;
}
function Hi(e) {
  const t8 = /font-family:\s*(?:"([^"]+)"|'([^']+)'|([^;]+))/i, n = e.match(t8);
  return n ? (n[1] || n[2] || n[3]).trim() : null;
}
var u7 = (0, import_react2.memo)((e) => {
  var O2, S;
  const { layer: t8, id: n, position: r } = e, o = useDependency(vr), l = (0, import_react2.useRef)(null), i = (0, import_react2.useRef)(null), u = (0, import_react2.useRef)(`transform: rotate(${r == null ? void 0 : r.rotate}deg) translate(${r == null ? void 0 : r.startX}px, ${r == null ? void 0 : r.startY}px)`), d = (0, import_react2.useRef)((O2 = r == null ? void 0 : r.startY) != null ? O2 : 0), v2 = (0, import_react2.useRef)((S = r == null ? void 0 : r.startX) != null ? S : 0), g = typeof t8.componentKey == "string" ? useDependency(S1).get(t8.componentKey) : t8.componentKey, c = (0, import_react2.useMemo)(() => ({
    data: t8.data,
    ...t8.props
  }), [t8.data, t8.props]), m2 = {
    width: `${r.width - 4}px`,
    height: `${r.height - 4}px`,
    left: `${r.absolute.left ? 0 : "auto"}`,
    top: `${r.absolute.top ? 0 : "auto"}`,
    right: `${r.absolute.left ? "auto" : 0}`,
    bottom: `${r.absolute.top ? "auto" : 0}`
  };
  u.current = `rotate(${r.rotate}deg)`, d.current = r.startY, v2.current = r.startX;
  const L = o.getUnit(t8.unitId), y = (0, import_react2.useMemo)(() => g ? (0, import_jsx_runtime2.jsx)(
    g,
    {
      ...c,
      unitId: t8.unitId,
      unit: L,
      floatDomId: t8.id,
      context: {
        root: i
      }
    }
  ) : null, [g, c]);
  return r ? (0, import_jsx_runtime2.jsx)(
    "div",
    {
      ref: l,
      className: "univer-absolute univer-z-10 univer-origin-center univer-overflow-hidden",
      style: {
        top: d.current,
        left: v2.current,
        width: Math.max(r.endX - r.startX - 2, 0),
        height: Math.max(r.endY - r.startY - 2, 0),
        transform: u.current
      },
      onPointerMove: (_3) => {
        t8.onPointerMove(_3.nativeEvent);
      },
      onPointerDown: (_3) => {
        t8.onPointerDown(_3.nativeEvent);
      },
      onPointerUp: (_3) => {
        t8.onPointerUp(_3.nativeEvent);
      },
      onWheel: (_3) => {
        t8.onWheel(_3.nativeEvent);
      },
      children: (0, import_jsx_runtime2.jsx)(
        "div",
        {
          ref: i,
          id: n,
          className: "univer-absolute univer-overflow-hidden",
          style: { ...m2 },
          children: y
        }
      )
    }
  ) : null;
});

// node_modules/@univerjs/docs-ui/lib/es/index.js
var import_react3 = __toESM(require_react());
var import_jsx_runtime3 = __toESM(require_jsx_runtime());
var Bc3 = Object.defineProperty;
var Mc = (n, e, t8) => e in n ? Bc3(n, e, { enumerable: true, configurable: true, writable: true, value: t8 }) : n[e] = t8;
var O = (n, e, t8) => Mc(n, typeof e != "symbol" ? e + "" : e, t8);
var td = Object.getOwnPropertyDescriptor;
var nd = (n, e, t8, o) => {
  for (var r = o > 1 ? void 0 : o ? td(e, t8) : e, s = n.length - 1, i; s >= 0; s--)
    (i = n[s]) && (r = i(r) || r);
  return r;
};
var Zs = (n, e) => (t8, o) => e(t8, o, n);
var Dt = class extends Ve {
  constructor(e, t8) {
    super();
    O(this, "_matches", /* @__PURE__ */ new Map());
    this._univerInstanceService = e, this._textSelectionManagerService = t8;
  }
  registerAutoFormat(e) {
    const t8 = this._matches.get(e.id);
    return t8 ? (t8.push(e), t8.sort((o, r) => {
      var s, i;
      return ((s = r.priority) != null ? s : 0) - ((i = o.priority) != null ? i : 0);
    })) : this._matches.set(e.id, [e]), We(() => {
      const o = this._matches.get(e.id);
      if (o) {
        const r = o.findIndex((s) => s === e);
        r >= 0 && o.splice(r, 1);
      }
    });
  }
  onAutoFormat(e, t8) {
    var a, c, d, l, A, h, u, g, f2;
    const o = (a = this._matches.get(e)) != null ? a : [], r = this._univerInstanceService.getCurrentUnitForType(we.UNIVER_DOC), s = this._textSelectionManagerService.getDocRanges(), i = (c = s.find((p) => p.isActive)) != null ? c : s[0];
    if (r && i) {
      const p = r.getSelfOrHeaderFooterModel(i.segmentId), m2 = {
        unit: p,
        selection: i,
        isBody: !i.segmentId,
        paragraphs: Je.range.getParagraphsInRange(i, (l = (d = p.getBody()) == null ? void 0 : d.paragraphs) != null ? l : [], (h = (A = p.getBody()) == null ? void 0 : A.dataStream) != null ? h : ""),
        customRanges: Je.customRange.getCustomRangesInterestsWithSelection(i, (g = (u = p.getBody()) == null ? void 0 : u.customRanges) != null ? g : []),
        commandId: e,
        commandParams: t8
      }, I2 = o.find((S) => S.match(m2));
      return (f2 = I2 == null ? void 0 : I2.getMutations(m2)) != null ? f2 : [];
    }
    return [];
  }
};
Dt = nd([
  Zs(0, vr),
  Zs(1, Inject(m))
], Dt);
var od = {
  undo: true,
  redo: true,
  // Undo redo
  font: true,
  // 'font'
  fontSize: true,
  // 'Font size'
  bold: true,
  // 'Bold (Ctrl+B)'
  italic: true,
  // 'Italic (Ctrl+I)'
  strikethrough: true,
  // 'Strikethrough (Alt+Shift+5)'
  underline: true,
  // 'Underline (Alt+Shift+6)'
  textColor: true,
  // 'Text color'
  fillColor: true,
  // 'Cell color'
  horizontalAlignMode: true,
  // 'Horizontal alignment'
  verticalAlignMode: true,
  // 'Vertical alignment'
  textWrapMode: true,
  // 'Wrap mode'
  textRotateMode: true
  // 'Text Rotation Mode'
};
var rd = {
  outerLeft: false,
  outerRight: false,
  header: true,
  footer: true,
  innerLeft: false,
  innerRight: false,
  frozenHeaderLT: false,
  frozenHeaderRT: false,
  frozenHeaderLM: false,
  frozenContent: false,
  infoBar: true,
  toolbar: true
};
var sd2 = "DOC_UI_PLUGIN";
var $e3 = ((n) => (n.MAIN = "__Document_Render_Main__", n.BACKGROUND = "__Document_Render_Background__", n))($e3 || {});
var We4 = ((n) => (n.VIEW_MAIN = "viewMain", n.VIEW_TOP = "viewTop", n.VIEW_LEFT = "viewLeft", n.VIEW_LEFT_TOP = "viewLeftTop", n))(We4 || {});
var id = 0;
var zo2 = 2;
var ad = 4;
var Js = 10;
var zf = "normalTextSelectionPluginName";
function pt2(n) {
  const { mainComponent: e, scene: t8, engine: o, components: r } = n, s = e, i = r.get($e3.BACKGROUND);
  return {
    document: s,
    docBackground: i,
    scene: t8,
    engine: o
  };
}
function cd(n, e) {
  const t8 = n.getCurrentUnitOfType(we.UNIVER_DOC);
  if (!t8)
    return null;
  const o = t8.getUnitId(), r = e.getRenderById(o);
  if (r == null)
    return;
  const { mainComponent: s, scene: i, engine: a, components: c } = r, d = s, l = c.get($e3.BACKGROUND);
  return {
    document: d,
    docBackground: l,
    scene: i,
    engine: a
  };
}
function Gf(n, e) {
  const t8 = e.getRenderById(n);
  if (t8 == null)
    return;
  const { mainComponent: o, scene: r, engine: s, components: i } = t8, a = o, c = i.get($e3.BACKGROUND);
  return {
    document: a,
    docBackground: c,
    scene: r,
    engine: s
  };
}
function ld2(n) {
  const { unitId: e, ranges: t8, id: o, type: r, segmentId: s } = n, i = {
    id: M.id,
    params: {
      unitId: e,
      actions: [],
      textRanges: void 0,
      // noHistory: true,
      segmentId: s
    }
  }, a = Qt.getInstance(), c = Je.customDecoration.add({ ranges: t8, id: o, type: r });
  return i.params.actions = a.editOp(c.serialize()), i;
}
function Yf(n, e) {
  const { segmentId: t8, id: o, type: r, unitId: s } = e, i = n.get(m), a = n.get(vr), c = s ? a.getUnit(s, we.UNIVER_DOC) : a.getCurrentUnitForType(we.UNIVER_DOC);
  if (!c)
    return false;
  const d = c.getUnitId(), l = i.getTextRanges({ unitId: d, subUnitId: d });
  return !l || !c.getBody() ? false : ld2(
    {
      unitId: d,
      ranges: l,
      id: o,
      type: r,
      segmentId: t8
    }
  );
}
function Kf(n, e) {
  const { unitId: t8, id: o, segmentId: r } = e, i = n.get(vr).getUnit(t8);
  if (!i)
    return false;
  const a = {
    id: M.id,
    params: {
      unitId: t8,
      actions: [],
      textRanges: void 0,
      // noHistory: true,
      segmentId: r
    }
  }, c = Je.customDecoration.delete({ id: o, segmentId: r, documentDataModel: i });
  if (!c)
    return false;
  const d = Qt.getInstance();
  return a.params.actions = d.editOp(c.serialize()), a;
}
function qf(n, e) {
  return e.some((t8) => n.startIndex > t8.startIndex && n.startIndex < t8.endIndex);
}
function Bo2(n, e, t8, o, r) {
  const { textRuns: s = [], dataStream: i } = n, a = r && i.startsWith("="), c = {
    st: 0,
    ed: 0,
    ts: {}
  };
  if (a)
    return c;
  for (let d = s.length - 1; d >= 0; d--) {
    const l = s[d], { st: A, ed: h } = l;
    e > A && e <= h && (c.st = A, c.ed = h, c.ts = {
      ...c.ts,
      ...l.ts
    });
  }
  if (e === 0) {
    const d = s == null ? void 0 : s[0];
    d && d.st === 0 && (c.ts = {
      ...c.ts,
      ...d.ts
    });
  }
  return o && (c.ts = {
    ...c.ts,
    ...o
  }), c;
}
function jr(n, e, t8) {
  if (t8) {
    const r = n.find((s) => e >= s.startIndex && e <= s.endIndex + 1);
    return r != null && r.wholeEntity ? null : r;
  }
  const o = n.find((r) => e > r.startIndex && e <= r.endIndex);
  return o != null && o.wholeEntity ? null : o;
}
function zr2(n, e) {
  return n.filter((t8) => e > t8.startIndex && e <= t8.endIndex);
}
function Xf(n) {
  return {
    left: n.positionH.posOffset,
    top: n.positionV.posOffset,
    width: n.size.width,
    height: n.size.height
  };
}
function Zf(n, e = 0, t8 = 0) {
  return {
    size: {
      width: n.width,
      height: n.height
    },
    positionH: {
      relativeFrom: Km.MARGIN,
      posOffset: (n.left || 0) - e
    },
    positionV: {
      relativeFrom: Xm.PAGE,
      posOffset: (n.top || 0) - t8
    },
    angle: n.angle || 0
  };
}
var dd = "doc.command.tab";
var Zt3 = {
  id: dd,
  type: Ms.COMMAND,
  async handler(n, e) {
    const o = n.get(Dt).onAutoFormat(Zt3.id, e);
    return (await E1(o, n.get(Ls))).result;
  }
};
var Ad = "doc.command.after-space";
var Mo2 = {
  id: Ad,
  type: Ms.COMMAND,
  async handler(n) {
    const t8 = n.get(Dt).onAutoFormat(Mo2.id);
    return (await E1(t8, n.get(Ls))).result;
  }
};
var bn2 = {
  id: "doc.command.enter",
  type: Ms.COMMAND,
  async handler(n) {
    const t8 = n.get(Dt).onAutoFormat(bn2.id);
    return (await E1(t8, n.get(Ls))).result;
  }
};
var ud2 = Object.getOwnPropertyDescriptor;
var hd = (n, e, t8, o) => {
  for (var r = o > 1 ? void 0 : o ? ud2(e, t8) : e, s = n.length - 1, i; s >= 0; s--)
    (i = n[s]) && (r = i(r) || r);
  return r;
};
var Go2 = (n, e) => (t8, o) => e(t8, o, n);
var gd2 = 11;
var fd = 9;
var kn3 = {
  /**
   * fontFamily
   */
  ff: "Arial",
  /**
   * fontSize
   */
  fs: gd2
};
var at2 = class extends Ve {
  constructor(e, t8, o) {
    super();
    O(this, "_cacheStyle", null);
    this._textSelectionManagerService = e, this._univerInstanceService = t8, this._renderManagerService = o, this._init();
  }
  _init() {
    this._listenDocRangeChange();
  }
  _listenDocRangeChange() {
    this.disposeWithMe(
      this._textSelectionManagerService.textSelection$.subscribe(() => {
        this._clearStyleCache();
      })
    );
  }
  getStyleCache() {
    return this._cacheStyle;
  }
  getDefaultStyle() {
    var i;
    const e = this._univerInstanceService.getCurrentUnitForType(we.UNIVER_DOC);
    if (e == null)
      return {
        ...kn3
      };
    const t8 = e == null ? void 0 : e.getUnitId(), o = (i = this._renderManagerService.getRenderById(t8)) == null ? void 0 : i.with(D), r = o == null ? void 0 : o.getViewModel();
    return r == null ? {
      ...kn3
    } : r.getEditArea() === d3.BODY ? {
      ...kn3
    } : {
      ...kn3,
      fs: fd
    };
  }
  setStyleCache(e) {
    this._cacheStyle = {
      ...this._cacheStyle,
      ...e
    };
  }
  _clearStyleCache() {
    this._cacheStyle = null;
  }
};
at2 = hd([
  Go2(0, Inject(m)),
  Go2(1, vr),
  Go2(2, ME)
], at2);
function Ke2(n, e) {
  var o;
  return (o = n.get(ME).getRenderById(e)) == null ? void 0 : o.with(D);
}
function Ae2(n, e = "") {
  if (!e)
    return ["body"];
  const { headers: t8, footers: o } = n.getSnapshot();
  if (t8 == null && o == null)
    throw new Error("Document data model must have headers or footers when update by segment id");
  if ((t8 == null ? void 0 : t8[e]) != null)
    return ["headers", e, "body"];
  if ((o == null ? void 0 : o[e]) != null)
    return ["footers", e, "body"];
  throw new Error("Segment id not found in headers or footers");
}
function pa(n, e, t8) {
  const o = [];
  for (let r = 0, s = n.length; r < s; r++)
    n[r] === ct.PARAGRAPH && o.push({
      startIndex: r
    });
  if (e)
    for (const r of o)
      e.bullet && (r.bullet = J.deepClone(e.bullet)), e.paragraphStyle && (r.paragraphStyle = J.deepClone(e.paragraphStyle), delete r.paragraphStyle.borderBottom, e.paragraphStyle.headingId && (r.paragraphStyle.headingId = et(6)));
  if (t8)
    for (const r of o)
      r.paragraphStyle || (r.paragraphStyle = {}), r.paragraphStyle.borderBottom = t8;
  return o;
}
var Gr = {
  id: "doc.command.break-line",
  type: Ms.COMMAND,
  // eslint-disable-next-line max-lines-per-function, complexity
  handler: (n, e) => {
    var N, ee3, $, U2, H3;
    const t8 = n.get(m), o = n.get(vr), r = n.get(Ls), s = n.get(at2), i = (N = e == null ? void 0 : e.textRange) != null ? N : t8.getActiveTextRange(), a = t8.getRectRanges();
    if (i == null)
      return false;
    if (a && a.length) {
      const { startOffset: k7 } = i;
      return t8.replaceDocRanges([{
        startOffset: k7,
        endOffset: k7
      }]), true;
    }
    const { horizontalLine: c } = e != null ? e : {}, { segmentId: d } = i, l = o.getCurrentUnitForType(we.UNIVER_DOC), A = l == null ? void 0 : l.getSelfOrHeaderFooterModel(d != null ? d : "").getBody();
    if (l == null || A == null)
      return false;
    const h = l.getUnitId(), { startOffset: u, endOffset: g } = i, p = ((ee3 = A.paragraphs) != null ? ee3 : []).find((k7) => k7.startIndex >= u);
    if (!p)
      return false;
    const m2 = u === p.startIndex, I2 = p.startIndex, S = s.getDefaultStyle(), v2 = s.getStyleCache(), R = Bo2(A, g, S, v2), E = {
      dataStream: ct.PARAGRAPH,
      paragraphs: pa(
        ct.PARAGRAPH,
        p,
        c
      ),
      textRuns: [{
        st: 0,
        ed: 1,
        ts: {
          ...R.ts
        }
      }]
    };
    if (l == null)
      return false;
    const b2 = t8.getActiveTextRange();
    if (A == null)
      return false;
    const { collapsed: y } = i, C = E.dataStream.length, B = [
      {
        startOffset: u + C,
        endOffset: u + C,
        style: b2 == null ? void 0 : b2.style,
        collapsed: y
      }
    ], x7 = {
      id: M.id,
      params: {
        unitId: h,
        actions: [],
        textRanges: B,
        debounce: true
      }
    }, M7 = new Ne(), w = Qt.getInstance();
    if (y)
      u > 0 && M7.push({
        t: Z.RETAIN,
        len: u
      }), M7.push({
        t: Z.INSERT,
        body: E,
        len: E.dataStream.length
      });
    else {
      const k7 = Je.selection.delete([i], A, 0, E);
      M7.push(...k7);
    }
    ((($ = p.bullet) == null ? void 0 : $.listType) === zt.CHECK_LIST_CHECKED || (U2 = p.paragraphStyle) != null && U2.headingId) && (i.endOffset < I2 && M7.push({
      t: Z.RETAIN,
      len: I2 - i.endOffset
    }), M7.push({
      t: Z.RETAIN,
      len: 1,
      body: {
        dataStream: "",
        paragraphs: [
          {
            ...p,
            paragraphStyle: {
              ...p.paragraphStyle,
              ...m2 ? {
                headingId: void 0,
                namedStyleType: void 0
              } : null
            },
            startIndex: 0,
            bullet: (H3 = p.paragraphStyle) != null && H3.headingId ? void 0 : {
              ...p.bullet,
              listType: zt.CHECK_LIST
            }
          }
        ]
      },
      coverType: pe.REPLACE
    })), x7.params.textRanges = [{
      startOffset: u + C,
      endOffset: u + C,
      collapsed: y
    }];
    const F2 = Ae2(l, d);
    return x7.params.actions = w.editOp(M7.serialize(), F2), !!r.syncExecuteCommand(x7.id, x7.params);
  }
};
var _o2 = ((n) => (n[n.ABOVE = 0] = "ABOVE", n[n.BELLOW = 1] = "BELLOW", n))(_o2 || {});
var Yr2 = ((n) => (n[n.LEFT = 0] = "LEFT", n[n.RIGHT = 1] = "RIGHT", n))(Yr2 || {});
function pd2(n, e) {
  let t8 = ct.TABLE_START;
  const o = [], r = [];
  for (let s = 0; s < n; s++) {
    t8 += ct.TABLE_ROW_START;
    for (let i = 0; i < e; i++)
      t8 += `${ct.TABLE_CELL_START}\r
${ct.TABLE_CELL_END}`, o.push({
        startIndex: t8.length - 3,
        paragraphStyle: {
          spaceAbove: { v: 3 },
          lineSpacing: 2,
          spaceBelow: { v: 0 }
        }
      }), r.push({
        startIndex: t8.length - 2
      });
    t8 += ct.TABLE_ROW_END;
  }
  return t8 += ct.TABLE_END, {
    dataStream: t8,
    paragraphs: o,
    sectionBreaks: r
  };
}
function Kr() {
  return {
    margin: {
      start: {
        v: 10
      },
      end: {
        v: 10
      },
      top: {
        v: 5
      },
      bottom: {
        v: 5
      }
    }
  };
}
function qr3(n) {
  const e = Kr();
  return {
    tableCells: [...new Array(n).fill(null).map(() => J.deepClone(e))],
    trHeight: {
      val: { v: 30 },
      hRule: Vm.AUTO
    }
  };
}
function Xr2(n) {
  return {
    size: {
      type: jm.SPECIFIED,
      width: {
        v: n
      }
    }
  };
}
function ma(n, e, t8) {
  const o = Xr2(t8 / e), r = qr3(e), s = [...new Array(n).fill(null).map(() => J.deepClone(r))], i = [...new Array(e).fill(null).map(() => J.deepClone(o))], a = et(6);
  return {
    tableRows: s,
    tableColumns: i,
    tableId: a,
    align: Wm.START,
    indent: {
      v: 0
    },
    textWrap: zm.NONE,
    position: {
      positionH: {
        relativeFrom: Km.PAGE,
        posOffset: 0
      },
      positionV: {
        relativeFrom: Xm.PAGE,
        posOffset: 0
      }
    },
    dist: {
      distB: 0,
      distL: 0,
      distR: 0,
      distT: 0
    },
    cellMargin: {
      start: {
        v: 10
      },
      end: {
        v: 10
      },
      top: {
        v: 5
      },
      bottom: {
        v: 5
      }
    },
    size: {
      type: jm.UNSPECIFIED,
      width: {
        v: t8
      }
    }
  };
}
function Ln3(n, e) {
  if (!n && !e)
    return null;
  if (e && e.length > 0) {
    let t8 = Number.POSITIVE_INFINITY, o = Number.NEGATIVE_INFINITY;
    const r = "";
    for (const s of e) {
      const { startOffset: i, endOffset: a, segmentId: c } = s;
      i == null || a == null || c == null || (t8 = Math.min(t8, i), o = Math.max(o, a));
    }
    if (Number.isFinite(t8) && Number.isFinite(o))
      return {
        startOffset: t8,
        endOffset: o,
        segmentId: r
      };
  } else if (n) {
    const { startOffset: t8, endOffset: o, segmentId: r } = n;
    return t8 == null || o == null || r == null ? null : {
      startOffset: t8,
      endOffset: o,
      segmentId: r
    };
  }
}
function md2(n) {
  let e = ct.TABLE_ROW_START;
  const t8 = [], o = [];
  for (let r = 0; r < n; r++)
    e += `${ct.TABLE_CELL_START}\r
${ct.TABLE_CELL_END}`, t8.push({
      startIndex: e.length - 3,
      paragraphStyle: {
        spaceAbove: { v: 3 },
        lineSpacing: 2,
        spaceBelow: { v: 0 }
      }
    }), o.push({
      startIndex: e.length - 2
    });
  return e += ct.TABLE_ROW_END, {
    dataStream: e,
    paragraphs: t8,
    sectionBreaks: o
  };
}
function Ed() {
  const n = `${ct.TABLE_CELL_START}\r
${ct.TABLE_CELL_END}`, e = [], t8 = [];
  return e.push({
    startIndex: 1,
    paragraphStyle: {
      spaceAbove: { v: 3 },
      lineSpacing: 2,
      spaceBelow: { v: 0 }
    }
  }), t8.push({
    startIndex: 2
  }), {
    dataStream: n,
    paragraphs: e,
    sectionBreaks: t8
  };
}
function Id(n, e, t8) {
  var A, h, u;
  const { startOffset: o, endOffset: r, segmentId: s } = n, i = t8.getSelfOrHeaderFooterViewModel(s), a = e === 0 ? o : r;
  let c = null;
  const d = (u = (h = (A = t8.getBody()) == null ? void 0 : A.tables) == null ? void 0 : h.find((g) => a >= g.startIndex && a <= g.endIndex)) == null ? void 0 : u.tableId;
  let l = 0;
  for (const g of i.getChildren()) {
    for (const f2 of g.children) {
      const { children: p } = f2, m2 = p[0];
      if (m2) {
        for (const I2 of m2.children)
          if (I2.startIndex <= a && a <= I2.endIndex) {
            l = m2.children.indexOf(I2), c = I2;
            break;
          }
      }
      if (c)
        break;
    }
    if (c)
      break;
  }
  return c == null || d == null ? null : {
    offset: e === 0 ? c.startIndex : c.endIndex + 1,
    colCount: c.children.length,
    tableId: d,
    insertRowIndex: e === 0 ? l : l + 1
  };
}
function Sd(n, e, t8) {
  var u, g, f2;
  const { startOffset: o, endOffset: r, segmentId: s } = n, i = t8.getSelfOrHeaderFooterViewModel(s), a = e === 0 ? o : r, c = (f2 = (g = (u = t8.getBody()) == null ? void 0 : u.tables) == null ? void 0 : g.find((p) => a >= p.startIndex && a <= p.endIndex)) == null ? void 0 : f2.tableId, d = [];
  let l = null, A = -1;
  for (const p of i.getChildren()) {
    for (const m2 of p.children) {
      const { children: I2 } = m2, S = I2[0];
      if (S) {
        if (a < S.startIndex || a > S.endIndex)
          continue;
        l = S;
        for (const v2 of S.children) {
          for (const R of v2.children) {
            const E = v2.children.indexOf(R);
            if (a >= R.startIndex && a <= R.endIndex) {
              A = E;
              break;
            }
          }
          if (A !== -1)
            break;
        }
      }
      if (l)
        break;
    }
    if (l)
      break;
  }
  if (l == null || c == null || A === -1)
    return null;
  let h = 0;
  for (const p of l.children) {
    const m2 = p.children[A], I2 = e === 0 ? m2.startIndex : m2.endIndex + 1;
    d.push(I2 - h), h = I2;
  }
  return {
    offsets: d,
    tableId: c,
    columnIndex: A,
    rowCount: l.children.length
  };
}
function vd(n, e, t8) {
  const o = [];
  let r = e[t8].size.width.v, s = 0;
  for (let i = 0; i < e.length; i++)
    s += e[i].size.width.v;
  s += r;
  for (let i = 0; i < e.length; i++)
    o.push(e[i].size.width.v / s * n);
  return r = r / s * n, {
    widths: o,
    newColWidth: r
  };
}
function Ea(n, e) {
  var h, u, g;
  const { startOffset: t8, endOffset: o, segmentId: r } = n, s = e.getSelfOrHeaderFooterViewModel(r), i = (g = (u = (h = e.getBody()) == null ? void 0 : h.tables) == null ? void 0 : u.find((f2) => t8 >= f2.startIndex && o <= f2.endIndex)) == null ? void 0 : g.tableId, a = [];
  let c = -1, d = 0, l = -1, A = false;
  for (const f2 of s.getChildren()) {
    for (const p of f2.children) {
      const { children: m2 } = p, I2 = m2[0];
      if (I2) {
        if (t8 < I2.startIndex || o > I2.endIndex)
          continue;
        l = I2.startIndex + 3;
        for (const S of I2.children) {
          const v2 = I2.children.indexOf(S), { startIndex: R, endIndex: E } = S;
          t8 >= R && t8 <= E ? (c = R, a.push(v2), d += E - R + 1) : (R > t8 && E < o || o >= R && o <= E) && (a.push(v2), d += E - R + 1), a.length === I2.children.length && (A = true);
        }
      }
      if (a.length)
        break;
    }
    if (a.length)
      break;
  }
  return i == null || a.length === 0 ? null : {
    tableId: i,
    rowIndexes: a,
    offset: c,
    len: d,
    cursor: l,
    selectWholeTable: A
  };
}
function Cd2(n, e) {
  var g, f2, p;
  const { startOffset: t8, endOffset: o, segmentId: r } = n, s = e.getSelfOrHeaderFooterViewModel(r), i = (p = (f2 = (g = e.getBody()) == null ? void 0 : g.tables) == null ? void 0 : f2.find((m2) => t8 >= m2.startIndex && o <= m2.endIndex)) == null ? void 0 : p.tableId, a = [];
  let c = null;
  const d = [];
  let l = -1, A = -1, h = -1;
  for (const m2 of s.getChildren()) {
    for (const I2 of m2.children) {
      const { children: S } = I2, v2 = S[0];
      if (v2) {
        if (t8 < v2.startIndex || o > v2.endIndex)
          continue;
        c = v2;
        for (const R of v2.children)
          for (const E of R.children) {
            const b2 = R.children.indexOf(E);
            t8 >= E.startIndex && t8 <= E.endIndex && (A = b2), o >= E.startIndex && o <= E.endIndex && (h = b2);
          }
      }
      if (c)
        break;
    }
    if (c)
      break;
  }
  if (c == null || i == null)
    return null;
  for (let m2 = A; m2 <= h; m2++)
    d.push(m2);
  let u = 0;
  for (const m2 of c.children) {
    const I2 = m2.children[A], S = m2.children[h];
    a.push({
      retain: I2.startIndex - u,
      delete: S.endIndex - I2.startIndex + 1
    }), u = S.endIndex + 1;
  }
  return l = c.startIndex + 3, {
    offsets: a,
    tableId: i,
    columnIndexes: d,
    cursor: l,
    selectWholeTable: d.length === c.children[0].children.length,
    rowCount: c.children.length
  };
}
function Ia(n, e) {
  var l, A, h;
  const { startOffset: t8, endOffset: o, segmentId: r } = n, s = e.getSelfOrHeaderFooterViewModel(r), i = (h = (A = (l = e.getBody()) == null ? void 0 : l.tables) == null ? void 0 : A.find((u) => t8 >= u.startIndex && o <= u.endIndex)) == null ? void 0 : h.tableId;
  let a = -1, c = 0, d = -1;
  for (const u of s.getChildren()) {
    for (const g of u.children) {
      const { children: f2 } = g, p = f2[0];
      if (p) {
        if (t8 < p.startIndex || o > p.endIndex)
          continue;
        a = p.startIndex, c = p.endIndex - p.startIndex + 1, d = p.startIndex;
      }
      if (p)
        break;
    }
    if (c > 0)
      break;
  }
  return i == null ? null : {
    tableId: i,
    offset: a,
    len: c,
    cursor: d
  };
}
function Rd(n, e) {
  var g, f2, p;
  const { startOffset: t8, endOffset: o, segmentId: r } = n, s = e.getSelfOrHeaderFooterViewModel(r), i = (p = (f2 = (g = e.getBody()) == null ? void 0 : g.tables) == null ? void 0 : f2.find((m2) => t8 >= m2.startIndex && o <= m2.endIndex)) == null ? void 0 : p.tableId, a = [];
  let c = null, d = -1, l = -1, A = -1, h = -1;
  for (const m2 of s.getChildren()) {
    for (const I2 of m2.children) {
      const { children: S } = I2, v2 = S[0];
      if (v2) {
        if (t8 < v2.startIndex || o > v2.endIndex)
          continue;
        c = v2;
        for (const R of v2.children) {
          const E = v2.children.indexOf(R);
          for (const b2 of R.children) {
            const y = R.children.indexOf(b2);
            t8 >= b2.startIndex && t8 <= b2.endIndex && (l = E, A = y), o >= b2.startIndex && o <= b2.endIndex && (h = y);
          }
        }
      }
      if (c)
        break;
    }
    if (c)
      break;
  }
  if (c == null || i == null || l === -1)
    return null;
  const u = c.children[l];
  for (let m2 = A; m2 <= h; m2++) {
    const I2 = u.children[m2];
    a.push({
      retain: I2.startIndex + 1,
      delete: I2.endIndex - I2.startIndex - 3
    });
  }
  return d = c.startIndex + 3, {
    offsets: a,
    tableId: i,
    cursor: d,
    rowCount: c.children.length
  };
}
var Ar = ((n) => (n[n.NEXT = 0] = "NEXT", n[n.PREV = 1] = "PREV", n))(Ar || {});
function $s2(n, e, t8) {
  const { startOffset: o } = e;
  let r = null;
  for (const d of n.getChildren()) {
    for (const l of d.children) {
      const A = l.children[0];
      if (A && o > A.startIndex && o < A.endIndex) {
        r = A;
        break;
      }
    }
    if (r)
      break;
  }
  if (r == null)
    return null;
  let s = -1, i = -1, a = null;
  for (const d of r.children) {
    for (const l of d.children)
      if (o > l.startIndex && o < l.endIndex) {
        s = d.children.indexOf(l), i = r.children.indexOf(d), a = d;
        break;
      }
    if (s > -1)
      break;
  }
  if (s === -1 || i === -1 || a == null)
    return null;
  let c = null;
  if (t8 === 0) {
    if (c = a.children[s + 1], !c) {
      const d = r.children[i + 1];
      d && (c = d.children[0]);
    }
  } else if (c = a.children[s - 1], !c) {
    const d = r.children[i - 1];
    d && (c = d.children[d.children.length - 1]);
  }
  if (c) {
    const { startIndex: d, endIndex: l } = c;
    return {
      startOffset: d + 1,
      endOffset: l - 2
    };
  }
}
function bd(n, e) {
  const t8 = [], { customBlocks: o = [] } = n;
  for (const r of e) {
    const { startOffset: s, endOffset: i } = r;
    if (!(s == null || i == null))
      for (const a of o) {
        const { startIndex: c } = a;
        c >= s && c < i && t8.push(a.blockId);
      }
  }
  return t8;
}
function yd(n) {
  return n.some((e) => {
    const { startNodePosition: t8 } = e;
    return t8 ? (t8 == null ? void 0 : t8.path.indexOf("cells")) > -1 : false;
  });
}
var xd = uR;
var Sa = {
  id: "doc.command.inner-paste",
  type: Ms.COMMAND,
  // eslint-disable-next-line max-lines-per-function, complexity
  handler: async (n, e) => {
    var C, B, x7, M7, w, F2;
    const { segmentId: t8, textRanges: o, doc: r } = e, s = n.get(Ls), i = n.get(m), a = n.get(vr), c = i.getTextRanges(), d = i.getRectRanges(), { body: l, tableSource: A, drawings: h } = r;
    if (!Array.isArray(c) || c.length === 0 || l == null)
      return false;
    const u = a.getCurrentUniverDocInstance(), g = u == null ? void 0 : u.getSelfOrHeaderFooterModel(t8).getBody();
    if (u == null || g == null)
      return false;
    const f2 = u.getUnitId(), p = {
      id: M.id,
      params: {
        unitId: f2,
        actions: [],
        textRanges: o,
        segmentId: t8
      }
    }, m2 = new Gn();
    m2.reset();
    const I2 = new Ne(), S = Qt.getInstance(), v2 = [], R = !!((C = l.tables) != null && C.length), E = !!((B = l.customBlocks) != null && B.length);
    if (R && t8 || R && yd(c) || c.length && (d != null && d.length))
      return false;
    for (let P2 = 0; P2 < c.length; P2++) {
      const N = c[P2], { startOffset: ee3, endOffset: $, collapsed: U2 } = N, H3 = ee3 - m2.cursor, k7 = J.deepClone(l);
      if (R)
        for (const ae2 of k7.tables) {
          const { tableId: oe2 } = ae2, he3 = et(6);
          ae2.tableId = he3;
          const we4 = J.deepClone(A[oe2]);
          we4.tableId = he3;
          const Ze = S.insertOp(["tableSource", he3], we4);
          v2.push(Ze);
        }
      if (E && h) {
        const ae2 = (M7 = (x7 = u.getSnapshot().drawingsOrder) == null ? void 0 : x7.length) != null ? M7 : 0;
        for (const oe2 of k7.customBlocks) {
          const { blockId: he3 } = oe2, we4 = et(6);
          oe2.blockId = we4;
          const Ze = J.deepClone(h[he3]);
          Ze.drawingId = we4;
          const At2 = S.insertOp(["drawings", we4], Ze), Je4 = S.insertOp(["drawingsOrder", ae2], we4);
          v2.push(At2), v2.push(Je4);
        }
      }
      const ne2 = jr((w = g.customRanges) != null ? w : [], $, xd.includes(f2)), ie5 = zr2((F2 = g.customDecorations) != null ? F2 : [], $);
      if (ne2 && (k7.customRanges = [{
        ...ne2,
        startIndex: 0,
        endIndex: l.dataStream.length - 1
      }]), ie5.length && (k7.customDecorations = ie5.map((ae2) => ({
        ...ae2,
        startIndex: 0,
        endIndex: l.dataStream.length - 1
      }))), U2)
        I2.push({
          t: Z.RETAIN,
          len: H3
        }), I2.push({
          t: Z.INSERT,
          body: k7,
          len: l.dataStream.length
        });
      else {
        const ae2 = Je.selection.delete([N], l, m2.cursor, k7, c.length === 1);
        I2.push(...ae2);
      }
      m2.reset(), m2.moveCursor($);
    }
    const b2 = Ae2(u, t8);
    return v2.push(S.editOp(I2.serialize(), b2)), p.params.actions = v2.reduce((P2, N) => Qt.compose(P2, N), null), !!s.syncExecuteCommand(p.id, p.params);
  }
};
function Od(n, e) {
  const { startOffset: t8, endOffset: o } = n, r = e.some((i) => i.startIndex === o), s = Math.max(t8, r ? o - 1 : o);
  return {
    ...n,
    endOffset: s,
    collapsed: t8 === s
  };
}
function Td(n, e, t8) {
  var g, f2;
  const o = e.getSelfOrHeaderFooterModel(t8).getBody(), r = new Ne(), s = Qt.getInstance(), i = [];
  if (o == null)
    return i;
  const { tables: a = [] } = o, c = new Gn();
  c.reset();
  for (let p = 0; p < n.length; p++) {
    const m2 = Od(n[p], a), { startOffset: I2, endOffset: S, collapsed: v2 } = m2, R = I2 - c.cursor;
    v2 ? r.push({
      t: Z.RETAIN,
      len: R
    }) : r.push(...Je.selection.delete([m2], o, c.cursor, null, false)), c.reset(), c.moveCursor(S);
  }
  const d = Ae2(e, t8);
  i.push(s.editOp(r.serialize(), d));
  const l = bd(o, n), A = (g = e.getDrawings()) != null ? g : {}, h = (f2 = e.getDrawingsOrder()) != null ? f2 : [], u = l.sort((p, m2) => h.indexOf(p) > h.indexOf(m2) ? -1 : h.indexOf(p) < h.indexOf(m2) ? 1 : 0);
  if (u.length > 0)
    for (const p of u) {
      const m2 = A[p], I2 = h.indexOf(p);
      if (m2 == null || I2 < 0)
        continue;
      const S = s.removeOp(["drawings", p], m2), v2 = s.removeOp(["drawingsOrder", I2], p);
      i.push(S), i.push(v2);
    }
  return i.reduce((p, m2) => Qt.compose(p, m2), null);
}
function Bd(n, e, t8, o) {
  const r = [];
  if (e.getSelfOrHeaderFooterModel(o).getBody() == null)
    return r;
  const i = new Ne(), a = Qt.getInstance(), c = new Gn();
  c.reset();
  for (const l of n) {
    const { startOffset: A, endOffset: h, spanEntireRow: u, spanEntireTable: g } = l;
    if (!(A == null || h == null))
      if (g) {
        const f2 = Ia({ startOffset: A, endOffset: h, segmentId: o }, t8);
        if (f2 == null)
          continue;
        const { offset: p, len: m2, tableId: I2 } = f2;
        p - c.cursor > 0 && i.push({
          t: Z.RETAIN,
          len: p - c.cursor
        }), i.push({
          t: Z.DELETE,
          len: m2
        });
        const S = a.removeOp(["tableSource", I2]);
        r.push(S), c.moveCursorTo(p + m2);
      } else if (u) {
        const f2 = Ea({ startOffset: A, endOffset: h, segmentId: o }, t8);
        if (f2 == null)
          continue;
        const { offset: p, rowIndexes: m2, len: I2, tableId: S } = f2;
        p - c.cursor > 0 && i.push({
          t: Z.RETAIN,
          len: p - c.cursor
        }), i.push({
          t: Z.DELETE,
          len: I2
        });
        for (const v2 of m2.reverse()) {
          const R = a.removeOp(["tableSource", S, "tableRows", v2]);
          r.push(R);
        }
        c.moveCursorTo(p + I2);
      } else {
        const f2 = Rd({ startOffset: A, endOffset: h, segmentId: o }, t8);
        if (f2 == null)
          continue;
        const { offsets: p } = f2;
        for (const m2 of p) {
          const { retain: I2, delete: S } = m2;
          I2 - c.cursor > 0 && i.push({
            t: Z.RETAIN,
            len: I2 - c.cursor
          }), i.push({
            t: Z.DELETE,
            len: S
          }), c.moveCursorTo(I2 + S);
        }
      }
  }
  const d = Ae2(e, o);
  return r.push(a.editOp(i.serialize(), d)), r.reduce((l, A) => Qt.compose(l, A), null);
}
function Md(n, e, t8, o, r) {
  let s = [];
  if (Array.isArray(n) && (n == null ? void 0 : n.length) !== 0 && (s = Td(n, t8, r)), Array.isArray(e) && (e == null ? void 0 : e.length) !== 0) {
    const i = Bd(e, t8, o, r);
    s == null || s.length === 0 ? s = i : s = Qt.compose(
      s,
      Qt.transform(i, s, "right")
    );
  }
  return s;
}
var Jt2 = {
  id: "doc.command.inner-cut",
  type: Ms.COMMAND,
  handler: (n, e) => {
    var f2;
    const t8 = n.get(m), o = n.get(Ls), r = n.get(vr), { segmentId: s, textRanges: i, selections: a = t8.getTextRanges(), rectRanges: c = t8.getRectRanges() } = e;
    if ((!Array.isArray(a) || a.length === 0) && (!Array.isArray(c) || c.length === 0))
      return false;
    const d = (f2 = r.getCurrentUniverDocInstance()) == null ? void 0 : f2.getUnitId();
    if (!d)
      return false;
    const l = r.getUniverDocInstance(d);
    if (l == null)
      return false;
    const A = Ke2(n, d);
    if (A == null)
      return false;
    const h = A.getViewModel(), u = {
      id: M.id,
      params: {
        unitId: d,
        actions: [],
        textRanges: i
      }
    };
    return u.params.actions = Md(a, c, l, h, s), !!o.syncExecuteCommand(u.id, u.params);
  }
};
var Ne2 = ((n) => (n[n.LEFT = 0] = "LEFT", n[n.RIGHT = 1] = "RIGHT", n))(Ne2 || {});
var _d = "doc.command.insert-text";
var va = {
  id: _d,
  type: Ms.COMMAND,
  handler: async (n, e) => {
    var E;
    const t8 = n.get(Ls), { range: o, segmentId: r, body: s, unitId: i, cursorOffset: a } = e, c = n.get(m), l = n.get(vr).getUnit(i, we.UNIVER_DOC);
    if (l == null)
      return false;
    const A = c.getActiveTextRange(), h = l.getSelfOrHeaderFooterModel((E = A == null ? void 0 : A.segmentId) != null ? E : "").getBody();
    if (h == null)
      return false;
    const { startOffset: u, collapsed: g } = o, f2 = a != null ? a : s.dataStream.length, p = [
      {
        startOffset: u + f2,
        endOffset: u + f2,
        style: A == null ? void 0 : A.style,
        collapsed: g
      }
    ], m2 = {
      id: M.id,
      params: {
        unitId: i,
        actions: [],
        textRanges: p,
        debounce: true
      }
    }, I2 = new Ne(), S = Qt.getInstance();
    if (g)
      u > 0 && I2.push({
        t: Z.RETAIN,
        len: u
      }), I2.push({
        t: Z.INSERT,
        body: s,
        len: s.dataStream.length
      });
    else {
      const b2 = Je.selection.delete([o], h, 0, s);
      I2.push(...b2);
    }
    m2.params.textRanges = [{
      startOffset: u + f2,
      endOffset: u + f2,
      collapsed: g
    }];
    const v2 = Ae2(l, r);
    return m2.params.actions = S.editOp(I2.serialize(), v2), !!t8.syncExecuteCommand(m2.id, m2.params);
  }
};
var yn2 = {
  id: "doc.command.delete-text",
  type: Ms.COMMAND,
  handler: async (n, e) => {
    var R;
    const t8 = n.get(Ls), o = n.get(vr), { range: r, segmentId: s, unitId: i, direction: a, len: c = 1 } = e, d = o.getUnit(i, we.UNIVER_DOC), l = d == null ? void 0 : d.getSelfOrHeaderFooterModel(s).getBody();
    if (d == null || l == null)
      return false;
    const { startOffset: A } = r;
    let h = a === Ne2.LEFT ? A - c : A, u = a === Ne2.LEFT ? A - 1 : A + c - 1;
    const g = (R = l.customRanges) == null ? void 0 : R.find((E) => E.startIndex <= h && E.endIndex >= u);
    g != null && g.wholeEntity && (h = g.startIndex, u = Math.max(u, g.endIndex));
    const f2 = {
      id: M.id,
      params: {
        unitId: i,
        actions: [],
        textRanges: [{
          startOffset: h,
          endOffset: h,
          collapsed: true
        }],
        debounce: true
      }
    }, p = new Ne(), m2 = Qt.getInstance();
    p.push({
      t: Z.RETAIN,
      len: h - 0
    }), p.push({
      t: Z.DELETE,
      len: u - h + 1
    });
    const S = Ae2(d, s);
    return f2.params.actions = m2.editOp(p.serialize(), S), !!t8.syncExecuteCommand(f2.id, f2.params);
  }
};
var Ca = {
  id: "doc.command.update-text",
  type: Ms.COMMAND,
  handler: async (n, e) => {
    const { range: t8, segmentId: o, updateBody: r, coverType: s, unitId: i, textRanges: a } = e, c = n.get(Ls), l = n.get(vr).getCurrentUniverDocInstance();
    if (l == null)
      return false;
    const A = {
      id: M.id,
      params: {
        unitId: i,
        actions: [],
        textRanges: a
      }
    }, h = new Ne(), u = Qt.getInstance(), { startOffset: g, endOffset: f2 } = t8;
    h.push({
      t: Z.RETAIN,
      len: g
    }), h.push({
      t: Z.RETAIN,
      body: r,
      len: f2 - g,
      coverType: s
    });
    const p = Ae2(l, o);
    return A.params.actions = u.editOp(h.serialize(), p), !!c.syncExecuteCommand(A.id, A.params);
  }
};
function Qn2(n) {
  var i, a, c, d;
  const e = n.get(vr), o = n.get(m).getActiveTextRange(), r = e.getCurrentUnitOfType(we.UNIVER_DOC);
  return !o || !o.collapsed || !r || o.segmentId ? false : Je.range.getParagraphsInRange(o, (a = (i = r.getBody()) == null ? void 0 : i.paragraphs) != null ? a : [], (d = (c = r.getBody()) == null ? void 0 : c.dataStream) != null ? d : "")[0];
}
var Zr = {
  id: "doc.command.delete-custom-block",
  type: Ms.COMMAND,
  handler: async (n, e) => {
    var x7;
    const t8 = n.get(m), o = n.get(vr), r = n.get(Ls), s = t8.getActiveTextRange(), i = o.getCurrentUniverDocInstance();
    if (s == null || i == null)
      return false;
    const { direction: a, range: c, unitId: d, drawingId: l } = e, { startOffset: A, segmentId: h, style: u } = s, g = a === Ne2.LEFT ? A - 1 : A, f2 = [
      {
        startOffset: g,
        endOffset: g,
        style: u
      }
    ], p = {
      id: M.id,
      params: {
        unitId: d,
        actions: [],
        textRanges: f2,
        prevTextRanges: [c]
      }
    }, m2 = new Ne(), I2 = Qt.getInstance(), S = [];
    A > 0 && m2.push({
      t: Z.RETAIN,
      len: a === Ne2.LEFT ? A - 1 : A
    }), m2.push({
      t: Z.DELETE,
      len: 1
    });
    const v2 = Ae2(i, h);
    S.push(I2.editOp(m2.serialize(), v2));
    const R = ((x7 = i.getDrawings()) != null ? x7 : {})[l], b2 = i.getDrawingsOrder().indexOf(l), y = I2.removeOp(["drawings", l], R), C = I2.removeOp(["drawingsOrder", b2], l);
    return S.push(y), S.push(C), p.params.actions = S.reduce((M7, w) => Qt.compose(M7, w), null), !!r.syncExecuteCommand(p.id, p.params);
  }
};
var Jr = {
  id: "doc.command.merge-two-paragraph",
  type: Ms.COMMAND,
  // eslint-disable-next-line max-lines-per-function
  handler: async (n, e) => {
    const t8 = n.get(m), o = n.get(vr), r = n.get(Ls), { direction: s, range: i } = e, a = t8.getActiveTextRange(), c = t8.getTextRanges();
    if (a == null || c == null)
      return false;
    const { segmentId: d, style: l } = a, A = o.getCurrentUnitForType(we.UNIVER_DOC), h = A == null ? void 0 : A.getSelfOrHeaderFooterModel(d).getBody();
    if (A == null || h == null)
      return false;
    const u = h.dataStream, g = a, f2 = A.getUnitId(), { startOffset: p, collapsed: m2 } = g;
    if (!m2)
      return false;
    const I2 = s === Ne2.LEFT ? p : p + 1;
    let S, v2;
    for (const F2 of h.paragraphs) {
      if (F2.startIndex >= I2) {
        v2 = F2;
        break;
      }
      S = F2;
    }
    if (S == null || v2 == null)
      return false;
    const R = s === Ne2.LEFT ? p - 1 : p, E = [
      {
        startOffset: R,
        endOffset: R,
        style: l
      }
    ], b2 = {
      id: M.id,
      params: {
        unitId: f2,
        actions: [],
        textRanges: E,
        prevTextRanges: [i]
      }
    }, y = new Ne(), C = Qt.getInstance();
    S.startIndex > 0 && y.push({
      t: Z.RETAIN,
      len: S.startIndex
    }), y.push({
      t: Z.DELETE,
      len: 1
    }), v2.startIndex > S.startIndex + 1 && y.push({
      t: Z.RETAIN,
      len: v2.startIndex - S.startIndex - 1
    });
    const B = Object.values(ct), x7 = u[S.startIndex - 1];
    (x7 && !B.includes(x7) || x7 === " ") && y.push({
      t: Z.RETAIN,
      len: 1,
      coverType: pe.REPLACE,
      body: {
        dataStream: "",
        paragraphs: [
          {
            ...J.deepClone(S),
            startIndex: 0
          }
        ]
      }
    });
    const M7 = Ae2(A, d);
    return b2.params.actions = C.editOp(y.serialize(), M7), !!r.syncExecuteCommand(b2.id, b2.params);
  }
};
var Ra = {
  id: "doc.command.remove-horizontal-line",
  type: Ms.COMMAND,
  // eslint-disable-next-line max-lines-per-function
  handler: async (n) => {
    var R;
    const e = n.get(m), t8 = n.get(vr), o = n.get(Ls), r = e.getActiveTextRange(), s = e.getTextRanges();
    if (r == null || s == null)
      return false;
    const { segmentId: i, style: a } = r, c = t8.getCurrentUnitForType(we.UNIVER_DOC), d = c == null ? void 0 : c.getSelfOrHeaderFooterModel(i).getBody();
    if (c == null || d == null)
      return false;
    const l = r, A = c.getUnitId(), { startOffset: h, collapsed: u } = l;
    if (!u)
      return false;
    const g = (R = d.paragraphs) == null ? void 0 : R.find((E) => E.startIndex === h - 1);
    if (g == null)
      return false;
    const f2 = [
      {
        startOffset: h,
        endOffset: h,
        style: a
      }
    ], p = {
      id: M.id,
      params: {
        unitId: A,
        actions: [],
        textRanges: f2
      }
    }, m2 = new Ne(), I2 = Qt.getInstance();
    g.startIndex > 0 && m2.push({
      t: Z.RETAIN,
      len: g.startIndex
    }), m2.push({
      t: Z.RETAIN,
      len: 1,
      coverType: pe.REPLACE,
      body: {
        dataStream: "",
        paragraphs: [
          {
            ...J.deepClone({
              ...g,
              paragraphStyle: {
                ...g.paragraphStyle,
                borderBottom: void 0
              }
            }),
            startIndex: 0
          }
        ]
      }
    });
    const S = Ae2(c, i);
    return p.params.actions = I2.editOp(m2.serialize(), S), !!o.syncExecuteCommand(p.id, p.params);
  }
};
function $r(n, e) {
  let t8 = 0;
  if (n == null || n.length === 0) {
    if (typeof e[0].startOffset == "number") {
      const o = e[0], { spanEntireRow: r, spanEntireTable: s } = o;
      s ? t8 = o.startOffset - 3 : r ? o.startRow > 0 ? t8 = o.startOffset - 6 : t8 = o.startOffset : t8 = e[0].startOffset;
    }
  } else if (n.length > 0 && e.length > 0) {
    const o = n[0], r = e[0];
    if (o.startOffset != null && r.startOffset != null) {
      if (o.startOffset < r.startOffset)
        t8 = o.startOffset;
      else if (o.startOffset >= r.startOffset) {
        const { spanEntireRow: s, spanEntireTable: i } = r;
        i ? t8 = r.startOffset - 3 : s && (t8 = r.startOffset - 6);
      }
    }
  }
  return t8;
}
var Do2 = {
  id: "doc.command.delete-left",
  type: Ms.COMMAND,
  // eslint-disable-next-line max-lines-per-function, complexity
  handler: async (n) => {
    var C, B, x7, M7, w, F2;
    const e = n.get(m), t8 = n.get(vr), o = n.get(Ls);
    let r = true;
    const s = t8.getCurrentUniverDocInstance();
    if (s == null)
      return false;
    const i = s.getUnitId(), a = Ke2(n, i), c = e.getActiveTextRange(), d = e.getRectRanges(), l = e.getTextRanges(), A = a == null ? void 0 : a.getSkeleton();
    if (A == null)
      return false;
    if (d != null && d.length) {
      const P2 = $r(l, d), N = d[0].segmentId, ee3 = [
        {
          startOffset: P2,
          endOffset: P2
        }
      ];
      return o.executeCommand(Jt2.id, {
        segmentId: N,
        textRanges: ee3
      });
    }
    if (c == null || l == null)
      return false;
    const { segmentId: h, style: u, segmentPage: g } = c, f2 = s.getSelfOrHeaderFooterModel(h).getBody();
    if (f2 == null)
      return false;
    const p = c, { startOffset: m2, collapsed: I2 } = p, S = A.findNodeByCharIndex(m2, h, g), v2 = mB(S), R = pB(S, f2);
    let E = m2;
    const b2 = A.findNodeByCharIndex(m2 - 1, h, g);
    if (vB(S) && b2 !== S && (v2 === true || R === true) && I2) {
      const P2 = $v(S, f2);
      if (P2 == null)
        return false;
      const N = P2 == null ? void 0 : P2.startIndex, ee3 = { startIndex: 0 }, $ = P2.paragraphStyle;
      if (v2 === true) {
        const H3 = P2.paragraphStyle;
        if (H3) {
          ee3.paragraphStyle = H3;
          const { hanging: k7 } = H3;
          k7 && (ee3.paragraphStyle.indentStart = k7, ee3.paragraphStyle.hanging = void 0);
        }
      } else if (R === true) {
        const H3 = P2.bullet;
        H3 && (ee3.bullet = H3), $ != null && (ee3.paragraphStyle = { ...$ }, delete ee3.paragraphStyle.hanging, delete ee3.paragraphStyle.indentStart);
      }
      const U2 = [
        {
          startOffset: E,
          endOffset: E,
          style: u
        }
      ];
      r = await o.executeCommand(Ca.id, {
        unitId: s.getUnitId(),
        updateBody: {
          dataStream: "",
          paragraphs: [{ ...ee3 }]
        },
        range: {
          startOffset: N,
          endOffset: N + 1
        },
        textRanges: U2,
        coverType: pe.REPLACE,
        segmentId: h
      });
    } else if (I2 === true) {
      if (b2 == null)
        return true;
      if (b2.content === "\r") {
        const P2 = (C = f2.paragraphs) == null ? void 0 : C.find((N) => N.startIndex === m2 - 1);
        (B = P2 == null ? void 0 : P2.paragraphStyle) != null && B.borderBottom ? r = await o.executeCommand(Ra.id) : r = await o.executeCommand(Jr.id, {
          direction: Ne2.LEFT,
          range: p
        });
      } else if (b2.streamType === "\b") {
        const P2 = (M7 = s.getSnapshot().drawings) == null ? void 0 : M7[(x7 = b2.drawingId) != null ? x7 : ""];
        if (P2 == null)
          return true;
        const N = (F2 = (w = s.getBody()) == null ? void 0 : w.customBlocks) == null ? void 0 : F2.find(($) => $.blockId === b2.drawingId);
        if (P2.layoutType === Fm.INLINE || (N == null ? void 0 : N.blockType) === Mm.CUSTOM) {
          const $ = s.getUnitId();
          r = await o.executeCommand(Zr.id, {
            direction: Ne2.LEFT,
            range: c,
            unitId: $,
            drawingId: b2.drawingId
          });
        } else {
          const $ = A.findNodeByCharIndex(m2 - 2);
          if ($ == null)
            return true;
          E -= b2.count, E -= $.count;
          const U2 = [
            {
              startOffset: E,
              endOffset: E,
              style: u
            }
          ];
          r = await o.executeCommand(yn2.id, {
            unitId: s.getUnitId(),
            range: {
              ...c,
              startOffset: c.startOffset - 1,
              endOffset: c.endOffset - 1
            },
            segmentId: h,
            direction: Ne2.LEFT,
            len: $.count,
            textRanges: U2
          });
        }
      } else
        E -= b2.count, r = await o.executeCommand(yn2.id, {
          unitId: s.getUnitId(),
          range: p,
          segmentId: h,
          direction: Ne2.LEFT,
          len: b2.count
        });
    } else {
      const P2 = ya(p, [p]);
      r = await o.executeCommand(Jt2.id, {
        segmentId: h,
        textRanges: P2,
        selections: [p]
      });
    }
    return r;
  }
};
var ba = {
  id: "doc.command.delete-right",
  type: Ms.COMMAND,
  // eslint-disable-next-line max-lines-per-function, complexity
  handler: async (n) => {
    var S, v2;
    const e = n.get(m), o = n.get(vr).getCurrentUniverDocInstance();
    if (!o)
      return false;
    const r = Ke2(n, o.getUnitId()), s = n.get(Ls), i = e.getActiveTextRange(), a = e.getRectRanges(), c = e.getTextRanges(), d = r == null ? void 0 : r.getSkeleton();
    if (a != null && a.length) {
      const R = $r(c, a), E = a[0].segmentId, b2 = [
        {
          startOffset: R,
          endOffset: R
        }
      ];
      return s.executeCommand(Jt2.id, {
        segmentId: E,
        textRanges: b2
      });
    }
    if (i == null || d == null || c == null)
      return false;
    const { segmentId: l, style: A, segmentPage: h } = i, u = o == null ? void 0 : o.getSelfOrHeaderFooterModel(l).getBody();
    if (!o || !u)
      return false;
    const g = i, { startOffset: f2, endOffset: p, collapsed: m2 } = g;
    if (f2 === u.dataStream.length - 2 && m2)
      return true;
    let I2 = false;
    if (m2 === true) {
      const R = d.findNodeByCharIndex(f2, l, h), E = d.findNodeByCharIndex(f2 + 1);
      if (R.streamType === ct.PARAGRAPH && (E == null ? void 0 : E.streamType) === ct.SECTION_BREAK)
        return false;
      if (R.content === "\r")
        I2 = await s.executeCommand(Jr.id, {
          direction: Ne2.RIGHT,
          range: i
        });
      else if (R.streamType === "\b") {
        const b2 = (v2 = o.getSnapshot().drawings) == null ? void 0 : v2[(S = R.drawingId) != null ? S : ""];
        if (b2 == null)
          return true;
        if (b2.layoutType === Fm.INLINE) {
          const C = o.getUnitId();
          I2 = await s.executeCommand(Zr.id, {
            direction: Ne2.RIGHT,
            range: i,
            unitId: C,
            drawingId: R.drawingId
          });
        } else {
          if (E == null)
            return true;
          const C = [
            {
              startOffset: f2 + 1,
              endOffset: f2 + 1,
              style: A
            }
          ];
          I2 = await s.executeCommand(yn2.id, {
            unitId: o.getUnitId(),
            range: {
              ...i,
              startOffset: f2 + 1,
              endOffset: p + 1
            },
            segmentId: l,
            direction: Ne2.RIGHT,
            textRanges: C,
            len: E.count
          });
        }
      } else {
        const b2 = [
          {
            startOffset: f2,
            endOffset: f2,
            style: A
          }
        ];
        I2 = await s.executeCommand(yn2.id, {
          unitId: o.getUnitId(),
          range: g,
          segmentId: l,
          direction: Ne2.RIGHT,
          textRanges: b2,
          len: R.count
        });
      }
    } else {
      const R = ya(g, [g]);
      I2 = await s.executeCommand(Jt2.id, {
        segmentId: l,
        textRanges: R,
        selections: [g]
      });
    }
    return I2;
  }
};
function ya(n, e) {
  let t8 = n.endOffset;
  for (const r of e) {
    const { startOffset: s, endOffset: i } = r;
    s == null || i == null || i <= n.endOffset && (t8 -= i - s);
  }
  return [
    {
      startOffset: t8,
      endOffset: t8,
      style: n.style
    }
  ];
}
var es = {
  id: "doc.command.delete-current-paragraph",
  type: Ms.COMMAND,
  handler: async (n) => {
    var d, l;
    const e = n.get(vr), t8 = n.get(Ls), o = e.getCurrentUnitOfType(we.UNIVER_DOC);
    if (!o)
      return false;
    const r = (l = (d = o.getBody()) == null ? void 0 : d.dataStream) != null ? l : "", s = Qn2(n);
    if (!s)
      return false;
    const i = Je.selection.delete(
      [{
        startOffset: s.paragraphStart,
        endOffset: r[s.paragraphEnd + 1] === `
` ? s.paragraphEnd : s.paragraphEnd + 1,
        collapsed: false
      }],
      o.getBody(),
      0,
      void 0,
      true
    ), a = Ae2(o), c = {
      unitId: o.getUnitId(),
      actions: Qt.getInstance().editOp(i, a),
      textRanges: [{
        startOffset: s.paragraphStart,
        endOffset: s.paragraphStart,
        collapsed: true
      }]
    };
    return t8.syncExecuteCommand(M.id, c);
  }
};
var Dd = 10;
var wd = 6;
function Pd() {
  return et(wd);
}
function Nd(n) {
  const e = n.match(/data-copy-id="([^\s]+)"/);
  return e && e[1] ? e[1] : null;
}
var Ld = class {
  constructor() {
    O(this, "_cache", new gs(Dd));
  }
  set(e, t8) {
    this._cache.set(e, t8);
  }
  get(e) {
    return this._cache.get(e);
  }
  clear() {
    this._cache.clear();
  }
};
var Yo2 = new Ld();
function ts(n) {
  const e = n.style, t8 = {}, o = n.tagName.toLowerCase();
  switch (o) {
    case "b":
    case "em":
    case "strong": {
      t8.bl = ie.TRUE;
      break;
    }
    case "s": {
      t8.st = {
        s: ie.TRUE
      };
      break;
    }
    case "u": {
      t8.ul = {
        s: ie.TRUE
      };
      break;
    }
    case "i": {
      t8.it = ie.TRUE;
      break;
    }
    case "sub":
    case "sup": {
      t8.va = o === "sup" ? Zt.SUPERSCRIPT : Zt.SUBSCRIPT;
      break;
    }
  }
  for (let r = 0; r < e.length; r++) {
    const s = e[r], i = e.getPropertyValue(s);
    switch (s) {
      case "font-family": {
        t8.ff = i.replace(/^"/g, "").replace(/"$/g, "");
        break;
      }
      case "font-size": {
        const a = Number.parseInt(i);
        Number.isNaN(a) || (i.endsWith("pt") ? t8.fs = a : i.endsWith("px") && (t8.fs = cB(a)));
        break;
      }
      case "font-style": {
        i === "italic" && (t8.it = ie.TRUE);
        break;
      }
      case "font-weight": {
        (Number(i) > 400 || String(i) === "bold") && (t8.bl = ie.TRUE);
        break;
      }
      case "text-decoration": {
        /underline/.test(i) ? t8.ul = {
          s: ie.TRUE
        } : /overline/.test(i) ? t8.ol = {
          s: ie.TRUE
        } : /line-through/.test(i) && (t8.st = {
          s: ie.TRUE
        });
        break;
      }
      case "color": {
        try {
          const a = new bt(i);
          a.isValid && (t8.cl = {
            rgb: a.toRgbString()
          });
        } catch {
        }
        break;
      }
      case "background-color": {
        const a = new bt(i);
        a.isValid && (t8.bg = {
          rgb: a.toRgbString()
        });
        break;
      }
    }
  }
  return t8;
}
function Qd(n) {
  const e = new DOMParser(), t8 = `<x-univer id="univer-root">${n}</x-univer>`;
  return e.parseFromString(t8, "text/html").querySelector("#univer-root");
}
function ei3(n, e) {
  const t8 = n.tagName.toLowerCase();
  return typeof e == "string" ? t8 === e : Array.isArray(e) ? e.some((o) => o === t8) : e(n);
}
var ti3 = 660;
var vo2 = class vo3 {
  constructor() {
    O(this, "_tableCache", []);
    O(this, "_styleCache", /* @__PURE__ */ new Map());
    O(this, "_styleRules", []);
    O(this, "_afterProcessRules", []);
  }
  static use(e) {
    if (this._pluginList.includes(e))
      throw new Error(`Univer paste plugin ${e.name} already added`);
    this._pluginList.push(e);
  }
  convert(e, t8 = {}) {
    var a;
    const o = vo3._pluginList.find((c) => c.checkPasteType(e)), r = Qd(e), i = {
      body: {
        dataStream: "",
        paragraphs: [],
        sectionBreaks: [],
        tables: [],
        textRuns: [],
        customBlocks: []
      },
      tableSource: {},
      id: (a = t8 == null ? void 0 : t8.unitId) != null ? a : ""
    };
    return o && (this._styleRules = [...o.stylesRules], this._afterProcessRules = [...o.afterProcessRules]), this._tableCache = [], this._styleCache.clear(), this._process(null, r.childNodes, i), this._styleCache.clear(), this._styleRules = [], this._afterProcessRules = [], i;
  }
  // eslint-disable-next-line max-lines-per-function, complexity
  _process(e, t8, o) {
    var s, i, a, c;
    const r = o.body;
    for (const d of t8)
      if (d.nodeType === Node.TEXT_NODE) {
        if (((s = d.nodeValue) == null ? void 0 : s.trim()) === "")
          continue;
        const l = (i = d.nodeValue) == null ? void 0 : i.replace(/[\r\n]/g, "");
        let A;
        e && this._styleCache.has(e) && (A = this._styleCache.get(e)), r.dataStream += l, A && Object.getOwnPropertyNames(A).length && r.textRuns.push({
          st: r.dataStream.length - l.length,
          ed: r.dataStream.length,
          ts: A
        });
      } else if (d.nodeName === "IMG") {
        const l = d, A = l.dataset.imageSourceType, h = A === oc.UUID ? l.dataset.source : l.src;
        if (h && A) {
          const u = Number(l.dataset.width || 100), g = Number(l.dataset.height || 100), f2 = Number(l.dataset.docTransformWidth || u), p = Number(l.dataset.docTransformHeight || g), m2 = et(6);
          (c = (a = o.body) == null ? void 0 : a.customBlocks) == null || c.push({ startIndex: r.dataStream.length, blockId: m2 }), r.dataStream += "\b", o.drawings || (o.drawings = {}), o.drawings[m2] = {
            drawingId: m2,
            title: "",
            description: "",
            imageSourceType: A,
            source: h,
            transform: { width: u, height: g, left: 0 },
            docTransform: {
              size: { width: f2, height: p },
              angle: 0,
              positionH: {
                relativeFrom: Km.PAGE,
                posOffset: 0
              },
              positionV: {
                relativeFrom: Xm.PARAGRAPH,
                posOffset: 0
              }
            },
            layoutType: Fm.INLINE,
            drawingType: ng.DRAWING_IMAGE,
            unitId: o.id || "",
            subUnitId: o.id || ""
          };
        }
      } else {
        if (rI.includes(d.nodeName.toLowerCase()))
          continue;
        if (d.nodeType === Node.ELEMENT_NODE) {
          const l = d, A = this._processBeforeLink(l, o), h = e ? this._styleCache.get(e) : {}, u = this._styleRules.find(({ filter: m2 }) => ei3(d, m2)), g = u ? u.getStyle(d) : ts(d);
          this._styleCache.set(d, { ...h, ...g });
          const { childNodes: f2 } = d;
          this._processBeforeTable(d, o), this._process(d, f2, o), this._processAfterTable(d, o);
          const p = this._afterProcessRules.find(
            ({ filter: m2 }) => ei3(d, m2)
          );
          p && p.handler(o, d), this._processAfterLink(l, o, A);
        }
      }
  }
  _processBeforeTable(e, t8) {
    var s;
    const o = e.tagName.toUpperCase(), r = t8.body;
    switch (o) {
      case "TABLE": {
        r.dataStream[r.dataStream.length - 1] !== "\r" && (r.dataStream += "\r", r.paragraphs == null && (r.paragraphs = []), (s = r.paragraphs) == null || s.push({
          startIndex: r.dataStream.length - 1
        }));
        const i = ma(0, 0, ti3);
        this._tableCache.push({
          table: i,
          startIndex: r.dataStream.length
        }), r.dataStream += ct.TABLE_START;
        break;
      }
      case "TR": {
        const i = qr3(0);
        this._tableCache[this._tableCache.length - 1].table.tableRows.push(i), r.dataStream += ct.TABLE_ROW_START;
        break;
      }
      case "TD": {
        const i = Kr(), a = this._tableCache[this._tableCache.length - 1].table;
        a.tableRows[a.tableRows.length - 1].tableCells.push(i), r.dataStream += ct.TABLE_CELL_START;
        break;
      }
    }
  }
  _processAfterTable(e, t8) {
    var i, a;
    const o = e.tagName.toUpperCase(), r = t8.body;
    t8.tableSource == null && (t8.tableSource = {}), r.tables == null && (r.tables = []), r.sectionBreaks == null && (r.sectionBreaks = []);
    const { tableSource: s } = t8;
    switch (o) {
      case "TABLE": {
        const c = this._tableCache.pop(), { startIndex: d, table: l } = c, A = l.tableRows[0].tableCells.length, h = Xr2(ti3 / A), u = [...new Array(A).fill(null).map(() => J.deepClone(h))];
        l.tableColumns = u, s[l.tableId] = l, r.dataStream += ct.TABLE_END, r.tables.push({
          startIndex: d,
          endIndex: r.dataStream.length,
          tableId: l.tableId
        });
        break;
      }
      case "TR": {
        r.dataStream += ct.TABLE_ROW_END;
        break;
      }
      case "TD": {
        r.dataStream[r.dataStream.length - 1] !== "\r" && ((i = r.paragraphs) == null || i.push({
          startIndex: r.dataStream.length
        }), r.dataStream += "\r"), (a = r.sectionBreaks) == null || a.push({
          startIndex: r.dataStream.length
        }), r.dataStream += `
${ct.TABLE_CELL_END}`;
        break;
      }
    }
  }
  _processBeforeLink(e, t8) {
    return t8.body.dataStream.length;
  }
  _processAfterLink(e, t8, o) {
    var i, a;
    const r = t8.body, s = e;
    s.tagName.toUpperCase() === "A" && (r.customRanges = (i = r.customRanges) != null ? i : [], r.customRanges.push({
      startIndex: o,
      endIndex: r.dataStream.length - 1,
      rangeId: (a = s.dataset.rangeid) != null ? a : et(),
      rangeType: pn.HYPERLINK,
      properties: { url: s.href }
    }));
  }
};
O(vo2, "_pluginList", []);
var $t2 = vo2;
var Ud = {
  name: "univer-doc-paste-plugin-lark",
  checkPasteType(n) {
    return /lark-record-clipboard/i.test(n);
  },
  // TODO: @JOCS, support inline code copy from lark.
  stylesRules: [
    {
      filter: ["s"],
      getStyle(n) {
        const e = ts(n);
        return {
          st: {
            s: ie.TRUE
          },
          ...e
        };
      }
    }
  ],
  afterProcessRules: [
    {
      filter(n) {
        return n.tagName === "DIV" && /ace-line/i.test(n.className);
      },
      handler(n) {
        const e = n.body;
        e.paragraphs == null && (e.paragraphs = []), e.paragraphs.push({
          startIndex: e.dataStream.length
        }), e.dataStream += "\r";
      }
    }
  ]
};
function xa(n) {
  const e = n.style, t8 = {};
  for (let o = 0; o < e.length; o++) {
    const r = e[o], s = e.getPropertyValue(r);
    switch (r) {
      case "margin-top": {
        const i = Number.parseInt(s);
        t8.spaceAbove = { v: /pt/.test(s) ? c3(i) : i };
        break;
      }
      case "margin-bottom": {
        const i = Number.parseInt(s);
        t8.spaceBelow = { v: /pt/.test(s) ? c3(i) : i };
        break;
      }
      case "line-height": {
        let i = Number.parseFloat(s);
        s.endsWith("%") && (i /= 100), t8.lineSpacing = i;
        break;
      }
    }
  }
  return Object.getOwnPropertyNames(t8).length ? t8 : null;
}
var Fd = {
  name: "univer-doc-paste-plugin-univer",
  checkPasteType(n) {
    return /UniverNormal/i.test(n);
  },
  stylesRules: [],
  afterProcessRules: [
    {
      filter(n) {
        return n.tagName === "P" && /UniverNormal/i.test(n.className);
      },
      handler(n, e) {
        const t8 = n.body;
        t8.paragraphs == null && (t8.paragraphs = []);
        const o = {
          startIndex: t8.dataStream.length
        }, r = xa(e);
        r && (o.paragraphStyle = r), t8.paragraphs.push(o), t8.dataStream += "\r";
      }
    }
  ]
};
var Hd = {
  name: "univer-doc-paste-plugin-word",
  checkPasteType(n) {
    return /word|mso/i.test(n);
  },
  stylesRules: [
    {
      filter: ["b"],
      getStyle(n) {
        const e = ts(n);
        return { bl: ie.TRUE, ...e };
      }
    }
  ],
  afterProcessRules: [
    {
      filter(n) {
        return n.tagName === "P";
      },
      handler(n, e) {
        const t8 = n.body;
        t8.paragraphs == null && (t8.paragraphs = []);
        const o = {
          startIndex: t8.dataStream.length
        }, r = xa(e);
        r && (o.paragraphStyle = r), t8.paragraphs.push(o), t8.dataStream += "\r";
      }
    }
  ]
};
function kd2(n) {
  var o, r;
  const e = (s) => {
    let i = "";
    return Object.keys(s).forEach((a) => {
      s[a] !== void 0 && (i += ` ${a}=${s[a]}`);
    }), i;
  }, t8 = {
    "data-doc-transform-height": n.docTransform.size.height,
    "data-doc-transform-width": n.docTransform.size.width,
    "data-width": (o = n.transform) == null ? void 0 : o.width,
    "data-height": (r = n.transform) == null ? void 0 : r.height,
    "data-image-source-type": n.imageSourceType,
    "data-source": n.imageSourceType === oc.UUID ? n.source : void 0,
    src: n.source
  };
  return `<img  ${e(t8)}></img>`;
}
function ni2(n, e) {
  const { st: t8, ed: o, ts: r = {} } = e, { ff: s, fs: i, it: a, bl: c, ul: d, st: l, ol: A, bg: h, cl: u, va: g } = r;
  let f2 = n.slice(t8, o);
  const p = [];
  return a === ie.TRUE && (f2 = `<i>${f2}</i>`), g === Zt.SUPERSCRIPT ? f2 = `<sup>${f2}</sup>` : g === Zt.SUBSCRIPT && (f2 = `<sub>${f2}</sub>`), (d == null ? void 0 : d.s) === ie.TRUE && (f2 = `<u>${f2}</u>`), (l == null ? void 0 : l.s) === ie.TRUE && (f2 = `<s>${f2}</s>`), c === ie.TRUE && (f2 = `<strong>${f2}</strong>`), s && p.push(`font-family: ${s}`), u && p.push(`color: ${u.rgb}`), i && p.push(`font-size: ${i}pt`), A && p.push("text-decoration: overline"), h && p.push(`background: ${h.rgb}`), p.length ? `<span style="${p.join("; ")};">${f2}</span>` : f2;
}
function Ko2(n, e, t8) {
  const { dataStream: o, textRuns: r = [] } = n;
  if (e === t8)
    return "";
  let s = e;
  const i = [];
  for (const a of r) {
    const { st: c, ed: d } = a;
    J.hasIntersectionBetweenTwoRanges(e, t8, c, d) && (c > s ? (i.push(o.slice(s, c)), i.push(ni2(o, {
      ...a,
      ed: Math.min(d, t8)
    }))) : i.push(ni2(o, {
      ...a,
      st: s,
      ed: Math.min(d, t8)
    }))), s = Math.max(e, Math.min(d, t8));
  }
  return s !== t8 && i.push(o.slice(s, t8)), i.join("");
}
function Vd(n, e, t8) {
  const o = n.body, r = n.drawings || {}, { customRanges: s = [], customBlocks: i = [] } = o || {}, a = [...i], c = s.filter((u) => u.startIndex >= e && u.endIndex <= t8);
  let d = e, l = "";
  const A = (u, g) => {
    let f2 = "", p = 0, m2 = u, I2 = a.findIndex((S) => u <= S.startIndex && g >= S.startIndex);
    if (I2 === -1)
      return f2 = Ko2(o, u, g), { sliceHtml: f2, customBlockLength: p };
    for (; I2 !== -1; ) {
      const S = a[I2];
      a.splice(I2, 1), f2 += Ko2(o, m2, S.startIndex);
      const v2 = r[S.blockId];
      if (v2)
        switch (v2.drawingType) {
          case ng.DRAWING_IMAGE: {
            f2 += kd2(v2), p++;
            break;
          }
        }
      m2 = S.startIndex + 1, I2 = a.findIndex((R) => m2 <= R.startIndex && g >= R.startIndex);
    }
    return f2 = f2 + Ko2(o, m2, g + 1), { sliceHtml: f2, customBlockLength: p };
  };
  c.forEach((u) => {
    var v2, R;
    const { startIndex: g, endIndex: f2, rangeType: p, rangeId: m2 } = u, I2 = A(d, g);
    l += I2.sliceHtml;
    const S = A(g, f2 + 1);
    switch (p) {
      case pn.HYPERLINK: {
        l += `<a data-rangeid="${m2}" href="${(R = (v2 = u.properties) == null ? void 0 : v2.url) != null ? R : ""}">${S.sliceHtml}</a>`;
        break;
      }
      default: {
        l += S.sliceHtml;
        break;
      }
    }
    d = f2 + 1 + (I2.customBlockLength + S.customBlockLength);
  });
  const h = A(d, t8);
  return l += h.sliceHtml, l;
}
function Wd(n) {
  const e = n.body || {}, { paragraphs: t8 = [], sectionBreaks: o = [] } = e;
  let { dataStream: r = "" } = e;
  r.endsWith(`\r
`) || (r += `\r
`, t8.push({
    startIndex: r.length - 2
  }), o.push({
    startIndex: r.length - 1
  }), e.dataStream = r, e.paragraphs = t8, e.sectionBreaks = o);
  const s = { html: "" }, i = G6(r).sectionList;
  for (const a of i)
    Yt2(a, n, s);
  return s.html;
}
function Yt2(n, e, t8) {
  var o, r;
  switch (n.nodeType) {
    case N0.SECTION_BREAK: {
      for (const s of n.children)
        Yt2(s, e, t8);
      break;
    }
    case N0.PARAGRAPH: {
      const { children: s, startIndex: i, endIndex: a } = n, c = (r = (o = e.body) == null ? void 0 : o.paragraphs.find((g) => g.startIndex === a)) != null ? r : {}, { paragraphStyle: d = {} } = c, { spaceAbove: l, spaceBelow: A, lineSpacing: h } = d, u = [];
      if (l != null && (typeof l == "number" ? u.push(`margin-top: ${l}px`) : u.push(`margin-top: ${l.v}px`)), A != null && (typeof A == "number" ? u.push(`margin-bottom: ${A}px`) : u.push(`margin-bottom: ${A.v}px`)), h != null && u.push(`line-height: ${h}`), t8.html += `<p class="UniverNormal" ${u.length ? `style="${u.join("; ")};"` : ""}>`, s.length)
        for (const g of s)
          Yt2(g, e, t8);
      t8.html += `${Vd(e, i, a)}</p>`;
      break;
    }
    case N0.TABLE: {
      const { children: s } = n;
      t8.html += '<table class="UniverTable" style="width: 100%; border-collapse: collapse;"><tbody>';
      for (const i of s)
        Yt2(i, e, t8);
      t8.html += "</tbody></table>";
      break;
    }
    case N0.TABLE_ROW: {
      const { children: s } = n;
      t8.html += '<tr class="UniverTableRow">';
      for (const i of s)
        Yt2(i, e, t8);
      t8.html += "</tr>";
      break;
    }
    case N0.TABLE_CELL: {
      const { children: s } = n;
      t8.html += '<td class="UniverTableCell">';
      for (const i of s)
        Yt2(i, e, t8);
      t8.html += "</td>";
      break;
    }
    default:
      throw new Error(`Unknown node type: ${n.nodeType}`);
  }
}
var jd = class {
  convert(e) {
    if (e.length === 0)
      throw new Error("The bodyList length at least to be 1");
    let t8 = "";
    for (const o of J.deepClone(e))
      t8 += Wd(o);
    return t8;
  }
};
var zd = Object.getOwnPropertyDescriptor;
var Gd = (n, e, t8, o) => {
  for (var r = o > 1 ? void 0 : o ? zd(e, t8) : e, s = n.length - 1, i; s >= 0; s--)
    (i = n[s]) && (r = i(r) || r);
  return r;
};
var cn2 = (n, e) => (t8, o) => e(t8, o, n);
$t2.use(Hd);
$t2.use(Ud);
$t2.use(Fd);
function oi2(n, e, t8) {
  var s, i, a;
  const o = kt(n, e, t8 + 2), r = ct.TABLE_START + ct.TABLE_ROW_START + ct.TABLE_CELL_START + o.dataStream + ct.TABLE_CELL_END + ct.TABLE_ROW_END + ct.TABLE_END;
  return o.dataStream = r, (s = o.textRuns) == null || s.forEach((c) => {
    const { st: d, ed: l } = c;
    c.st = d + 3, c.ed = l + 3;
  }), (i = o.tables) == null || i.forEach((c) => {
    const { startIndex: d, endIndex: l } = c;
    c.startIndex = d + 3, c.endIndex = l + 3;
  }), (a = o.paragraphs) == null || a.forEach((c) => {
    const { startIndex: d } = c;
    c.startIndex = d + 3;
  }), o;
}
var Nt3 = createIdentifier("doc.clipboard-service");
var ur2 = class extends Ve {
  constructor(e, t8, o, r, s) {
    super();
    O(this, "_clipboardHooks", []);
    O(this, "_htmlToUDM", new $t2());
    O(this, "_umdToHtml", new jd());
    this._univerInstanceService = e, this._logService = t8, this._commandService = o, this._clipboardInterfaceService = r, this._docSelectionManagerService = s;
  }
  async copy(e = Ju.copy, t8) {
    var a, c;
    const { newSnapshotList: o = [], needCache: r = false, snapshot: s, ranges: i } = (a = this._getDocumentBodyInRanges(e, t8)) != null ? a : {};
    if (o.length === 0 || s == null)
      return false;
    try {
      const d = !!((c = i == null ? void 0 : i[0]) != null && c.segmentId);
      this._setClipboardData(o, !d && r);
    } catch (d) {
      return this._logService.error("[DocClipboardService] copy failed", d), false;
    }
    return true;
  }
  async cut(e) {
    return this._cut(e);
  }
  async paste(e) {
    const t8 = await this._genDocDataFromClipboardItems(e);
    return this._paste(t8);
  }
  async legacyPaste(e) {
    let { html: t8, text: o, files: r } = e;
    const s = this._univerInstanceService.getCurrentUnitForType(we.UNIVER_DOC), i = (s == null ? void 0 : s.getUnitId()) || "";
    if (!t8 && !o && r.length && (t8 = await this._createImagePasteHtml(r)), !t8 && !o)
      return this._logService.warn("[DocClipboardController] html and text cannot be both empty!"), false;
    const a = this._genDocDataFromHtmlAndText(t8, o, i);
    if (i === Dl)
      if (o) {
        const c = Je.transform.fromPlainText(o);
        return this._paste({ body: c });
      } else
        a.body.textRuns = [];
    return this._paste(a);
  }
  async _cut(e) {
    var a, c, d, l, A;
    const t8 = (c = (a = e == null ? void 0 : e.filter((h) => h.rangeType === jg.TEXT)) != null ? a : this._docSelectionManagerService.getTextRanges()) != null ? c : [], o = (l = (d = e == null ? void 0 : e.filter((h) => h.rangeType === jg.RECT)) != null ? d : this._docSelectionManagerService.getRectRanges()) != null ? l : [], {
      segmentId: r,
      endOffset: s,
      style: i
    } = (A = t8[0]) != null ? A : {};
    if (r == null && this._logService.error("[DocClipboardController] segmentId is not existed"), t8.length === 0 && o.length === 0)
      return false;
    this.copy(Ju.cut, e);
    try {
      let h = 0;
      if (o.length > 0)
        h = $r(t8, o);
      else if (s != null) {
        h = s;
        for (const g of t8) {
          const { startOffset: f2, endOffset: p } = g;
          f2 == null || p == null || p <= s && (h -= p - f2);
        }
      }
      const u = [
        {
          startOffset: h,
          endOffset: h,
          style: i
        }
      ];
      return this._commandService.executeCommand(Jt2.id, {
        segmentId: r,
        textRanges: u,
        rectRanges: o,
        selections: t8
      });
    } catch {
      return this._logService.error("[DocClipboardController] cut content failed"), false;
    }
  }
  async _paste(e) {
    var l, A, h;
    const { body: t8 } = e;
    if (t8 == null)
      return false;
    let o = vR(t8);
    if (!((l = this._univerInstanceService.getCurrentUnitForType(we.UNIVER_DOC)) == null ? void 0 : l.getUnitId()))
      return false;
    this._clipboardHooks.forEach((u) => {
      u.onBeforePaste && (o = u.onBeforePaste(o));
    }), o.customRanges = (A = o.customRanges) == null ? void 0 : A.map(Je.customRange.copyCustomRange), (h = o.paragraphs) == null || h.forEach((u) => {
      var g;
      (g = u.paragraphStyle) != null && g.headingId && (u.paragraphStyle.headingId = et(6));
    });
    const s = this._docSelectionManagerService.getActiveTextRange(), { segmentId: i, endOffset: a, style: c } = s || {}, d = this._docSelectionManagerService.getTextRanges();
    if (i == null && this._logService.error("[DocClipboardController] segmentId does not exist!"), a == null || d == null)
      return false;
    try {
      let u = a;
      for (const f2 of d) {
        const { startOffset: p, endOffset: m2 } = f2;
        p == null || m2 == null || m2 <= a && (u += o.dataStream.length - (m2 - p));
      }
      const g = [
        {
          startOffset: u,
          endOffset: u,
          style: c
        }
      ];
      return this._commandService.executeCommand(Sa.id, {
        doc: {
          ...e,
          body: o
        },
        segmentId: i,
        textRanges: g
      });
    } catch {
      return this._logService.error("[DocClipboardController]", "clipboard is empty."), false;
    }
  }
  async _setClipboardData(e, t8 = true) {
    var i, a, c, d;
    const o = Pd(), r = (e.length > 1 ? e.map((l) => {
      var A;
      return ((A = l.body) == null ? void 0 : A.dataStream) || "";
    }).join(`
`) : ((i = e[0].body) == null ? void 0 : i.dataStream) || "").replaceAll(ct.TABLE_START, "").replaceAll(ct.TABLE_END, "").replaceAll(ct.TABLE_ROW_START, "").replaceAll(ct.TABLE_ROW_END, "").replaceAll(ct.TABLE_CELL_START, "").replaceAll(ct.TABLE_CELL_END, "").replaceAll(`\r
`, " ");
    let s = this._umdToHtml.convert(e);
    if (e.length === 1 && t8) {
      s = s.replace(/(<[a-z]+)/, (h, u) => `${u} data-copy-id="${o}"`);
      const l = e[0], A = { body: l.body };
      if ((c = (a = l.body) == null ? void 0 : a.customBlocks) != null && c.length) {
        A.drawings = {};
        for (const h of l.body.customBlocks) {
          const { blockId: u } = h, g = (d = l.drawings) == null ? void 0 : d[u];
          if (g) {
            const f2 = et(6);
            h.blockId = f2, A.drawings[f2] = {
              ...J.deepClone(g),
              drawingId: f2
            };
          }
        }
      }
      Yo2.set(o, A);
    }
    return this._clipboardInterfaceService.write(r, s);
  }
  addClipboardHook(e) {
    return this._clipboardHooks.push(e), We(() => {
      const t8 = this._clipboardHooks.indexOf(e);
      t8 > -1 && this._clipboardHooks.splice(t8, 1);
    });
  }
  _getDocumentBodyInRanges(e, t8) {
    var l;
    const o = this._univerInstanceService.getCurrentUniverDocInstance(), r = t8 != null ? t8 : this._docSelectionManagerService.getDocRanges(), s = [];
    let i = true;
    if (o == null || r.length === 0)
      return;
    const a = r[0].segmentId, c = (l = o == null ? void 0 : o.getSelfOrHeaderFooterModel(a)) == null ? void 0 : l.getBody(), d = o.getSnapshot();
    if (c != null) {
      for (const A of r) {
        const { startOffset: h, endOffset: u, collapsed: g, rangeType: f2 } = A;
        if (g || h == null || u == null)
          continue;
        if (f2 === jg.RECT) {
          i = false;
          const { spanEntireRow: I2 } = A;
          let S;
          S = oi2(c, h, u), s.push(S);
          continue;
        }
        const p = { startOffset: h, endOffset: u }, m2 = o.getSelfOrHeaderFooterModel(a).sliceBody(p.startOffset, p.endOffset, e);
        m2 != null && s.push(m2);
      }
      return {
        newSnapshotList: s.map((A) => ({ ...d, body: A })),
        needCache: i,
        snapshot: d,
        ranges: r
      };
    }
  }
  async _genDocDataFromClipboardItems(e) {
    try {
      let t8 = "", o = "";
      const r = [];
      for (const s of e)
        for (const i of s.types)
          switch (i) {
            case Qt4: {
              o = await s.getType(i).then((a) => a && a.text());
              break;
            }
            case Kt: {
              t8 = await s.getType(i).then((a) => a && a.text());
              break;
            }
            case Eo2:
            case $o:
            case No:
            case Oo: {
              const a = await s.getType(i), c = new File([a], `pasted_image.${i.split("/")[1]}`, { type: i });
              r.push(c);
              break;
            }
          }
      return !t8 && !o && r.length && (t8 = await this._createImagePasteHtml(r)), this._genDocDataFromHtmlAndText(t8, o);
    } catch (t8) {
      return Promise.reject(t8);
    }
  }
  _genDocDataFromHtmlAndText(e, t8, o) {
    if (!e) {
      if (t8)
        return { body: Je.transform.fromPlainText(t8) };
      throw new Error("[DocClipboardService] html and text cannot be both empty!");
    }
    const r = Nd(e);
    if (r) {
      const i = Yo2.get(r);
      if (i)
        return i;
    }
    if (!o) {
      const i = this._univerInstanceService.getCurrentUnitForType(we.UNIVER_DOC);
      o = (i == null ? void 0 : i.getUnitId()) || "";
    }
    const s = this._htmlToUDM.convert(e, { unitId: o });
    return r && Yo2.set(r, s), s;
  }
  async _createImagePasteHtml(e) {
    var a, c;
    const t8 = {
      id: "",
      documentStyle: {},
      body: {
        dataStream: "",
        customBlocks: []
      },
      drawings: {}
    }, o = async (d) => {
      const l = new FileReader();
      return new Promise((A) => {
        l.onloadend = function() {
          A({
            source: l.result,
            imageSourceType: oc.BASE64
          });
        }, l.readAsDataURL(d);
      });
    }, r = (d) => {
      const l = new Image(), A = 500;
      return new Promise((h) => {
        l.src = typeof d == "string" ? d : URL.createObjectURL(d), l.onload = () => {
          const u = Math.min(A, l.naturalWidth), g = l.naturalHeight / l.naturalWidth;
          h({ width: u, height: u * g });
        };
      });
    }, s = (c = (a = this._clipboardHooks.find((d) => d.onBeforePasteImage)) == null ? void 0 : a.onBeforePasteImage) != null ? c : o;
    return await Promise.all(e.map(async (d, l) => {
      var m2;
      const A = await s(d);
      if (!A)
        return Promise.resolve();
      const { width: h = 100, height: u = 100 } = await r(d), g = `paste_image_id_${l}`, f2 = t8.body, p = t8.drawings;
      f2.dataStream += "\b", (m2 = f2.customBlocks) == null || m2.push({ startIndex: l, blockId: g }), p[g] = {
        drawingId: g,
        unitId: "",
        subUnitId: "",
        imageSourceType: A.imageSourceType,
        title: "",
        source: A.source,
        description: "",
        layoutType: Fm.INLINE,
        drawingType: ng.DRAWING_IMAGE,
        transform: {
          width: h,
          height: u,
          angle: 0
        },
        docTransform: {
          angle: 0,
          size: { width: h, height: u },
          positionH: { relativeFrom: Km.CHARACTER, posOffset: 0 },
          positionV: { relativeFrom: Xm.LINE, posOffset: 0 }
        }
      };
    })), this._umdToHtml.convert([t8]);
  }
};
ur2 = Gd([
  cn2(0, vr),
  cn2(1, yt),
  cn2(2, Ls),
  cn2(3, lr),
  cn2(4, Inject(m))
], ur2);
function wo2(n) {
  return n.getContextValue(qr) || n.getContextValue(mE);
}
var ns = 999;
var ro2 = {
  id: Fn3.id,
  name: "doc.command.copy",
  type: Ms.COMMAND,
  multi: true,
  priority: ns,
  preconditions: wo2,
  handler: async (n) => n.get(Nt3).copy()
};
var os = {
  id: "doc.command.copy-current-paragraph",
  type: Ms.COMMAND,
  handler: async (n) => {
    const e = n.get(Nt3), t8 = Qn2(n);
    return t8 ? e.copy(
      Ju.copy,
      [{
        startOffset: t8.paragraphStart,
        endOffset: t8.paragraphEnd + 1,
        collapsed: false
      }]
    ) : false;
  }
};
var rs = {
  id: kn2.id,
  name: "doc.command.cut",
  type: Ms.COMMAND,
  multi: true,
  priority: ns,
  preconditions: wo2,
  handler: async (n) => n.get(Nt3).cut()
};
var ss2 = {
  id: "doc.command.cut-current-paragraph",
  type: Ms.COMMAND,
  handler: async (n) => {
    const e = n.get(Nt3), t8 = Qn2(n);
    return t8 ? e.cut(
      [{
        startOffset: t8.paragraphStart,
        endOffset: t8.paragraphEnd + 1,
        collapsed: false,
        rangeType: jg.TEXT
      }]
    ) : false;
  }
};
var is = {
  id: jn2.id,
  name: "doc.command.paste",
  type: Ms.COMMAND,
  multi: true,
  priority: ns,
  preconditions: wo2,
  handler: async (n) => {
    const e = n.get(Nt3), o = await n.get(lr).read();
    return o.length === 0 ? false : e.paste(o);
  }
};
var Po2 = {
  id: "doc.command.horizontal-line",
  type: Ms.COMMAND,
  handler: (n, e) => n.get(Ls).syncExecuteCommand(Gr.id, {
    horizontalLine: {
      padding: 5,
      color: {
        rgb: "#CDD0D8"
      },
      width: 1,
      dashStyle: Hm.SOLID
    },
    textRange: e == null ? void 0 : e.insertRange
  })
};
var as = {
  id: "doc.command.insert-horizontal-line-bellow",
  type: Ms.COMMAND,
  handler: (n) => {
    const e = n.get(Ls), t8 = Qn2(n);
    return t8 ? e.syncExecuteCommand(Po2.id, {
      insertRange: {
        startOffset: t8.startIndex + 1,
        endOffset: t8.startIndex + 1
      }
    }) : false;
  }
};
var Oa = {
  id: "doc.command.select-all",
  type: Ms.COMMAND,
  handler: async (n) => {
    var u;
    const e = n.get(vr), t8 = n.get(m), o = e.getCurrentUnitForType(we.UNIVER_DOC), r = t8.getDocRanges(), s = (u = r.find((g) => g.isActive)) != null ? u : r[0];
    if (o == null || s == null)
      return false;
    const { segmentId: i } = s, a = o.getUnitId(), c = o.getSelfOrHeaderFooterModel(i).getSnapshot().body;
    if (c == null)
      return false;
    const { tables: d = [], dataStream: l } = c;
    if (l === `\r
`)
      return true;
    const A = [];
    let h = 0;
    for (const g of d) {
      const { startIndex: f2, endIndex: p } = g;
      h !== f2 && A.push({
        startOffset: h,
        endOffset: f2 - 1,
        rangeType: jg.TEXT
      }), A.push({
        startOffset: f2 + 3,
        // 3 is TABLE_START, ROW_START, CELL_START.
        endOffset: p - 5,
        // 4 is CELL_END, ROW_END, TABLE_END AND \n.
        rangeType: jg.RECT
      }), h = p;
    }
    return h !== c.dataStream.length - 2 && A.push({
      startOffset: h,
      endOffset: c.dataStream.length - 2,
      rangeType: jg.TEXT
    }), t8.replaceDocRanges(A, {
      unitId: a,
      subUnitId: a
    }, false), true;
  }
};
var No2 = class extends h1 {
  constructor(t8) {
    super();
    O(this, "_previousActiveRange", null);
    O(this, "_undoMutationParamsCache", []);
    O(this, "_redoMutationParamsCache", []);
    this._context = t8;
  }
  clearUndoRedoMutationParamsCache() {
    this._undoMutationParamsCache = [], this._redoMutationParamsCache = [];
  }
  getUndoRedoMutationParamsCache() {
    return {
      undoCache: this._undoMutationParamsCache,
      redoCache: this._redoMutationParamsCache
    };
  }
  setUndoRedoMutationParamsCache({ undoCache: t8 = [], redoCache: o = [] }) {
    this._undoMutationParamsCache = t8, this._redoMutationParamsCache = o;
  }
  getActiveRange() {
    return this._previousActiveRange;
  }
  setActiveRange(t8) {
    this._previousActiveRange = t8;
  }
  pushUndoRedoMutationParams(t8, o) {
    this._undoMutationParamsCache.push(t8), this._redoMutationParamsCache.push(o);
  }
  fetchComposedUndoRedoMutationParams() {
    if (this._undoMutationParamsCache.length === 0 || this._previousActiveRange == null || this._redoMutationParamsCache.length === 0)
      return null;
    const { unitId: t8 } = this._undoMutationParamsCache[0], o = {
      unitId: t8,
      actions: this._undoMutationParamsCache.reverse().reduce((s, i) => Qt.compose(s, i.actions), null),
      textRanges: []
      // Add empty array, will never use, just fix type error
    };
    return { redoMutationParams: {
      unitId: t8,
      actions: this._redoMutationParamsCache.reduce((s, i) => Qt.compose(s, i.actions), null),
      textRanges: []
      // Add empty array, will never use, just fix type error
    }, undoMutationParams: o, previousActiveRange: this._previousActiveRange };
  }
  dispose() {
    this._undoMutationParamsCache = [], this._redoMutationParamsCache = [], this._previousActiveRange = null;
  }
};
var Ta = {
  id: "doc.command.ime-input",
  type: Ms.COMMAND,
  // eslint-disable-next-line max-lines-per-function
  handler: async (n, e) => {
    var N, ee3, $;
    const { unitId: t8, newText: o, oldTextLen: r, isCompositionEnd: s, isCompositionStart: i } = e, a = n.get(Ls), c = n.get(ME), d = n.get(vr), l = n.get(at2), A = (N = c.getRenderById(t8)) == null ? void 0 : N.with(No2), h = d.getUnit(t8, we.UNIVER_DOC);
    if (h == null || A == null)
      return false;
    const u = A.getActiveRange();
    if (u == null)
      return false;
    const { style: g, segmentId: f2 } = u, p = h.getSelfOrHeaderFooterModel(f2).getBody();
    if (p == null)
      return false;
    Object.assign(u, u);
    const { startOffset: I2, endOffset: S } = u, v2 = o.length, R = [
      {
        startOffset: I2 + v2,
        endOffset: I2 + v2,
        collapsed: true,
        style: g
      }
    ], E = {
      id: M.id,
      params: {
        unitId: t8,
        actions: [],
        textRanges: R
      }
    }, b2 = l.getDefaultStyle(), y = l.getStyleCache(), C = jr((ee3 = p.customRanges) != null ? ee3 : [], I2 + r, uR.includes(t8)), B = Bo2(
      p,
      i ? S : I2 + r,
      b2,
      y,
      uR.includes(t8)
    ), x7 = zr2(($ = p.customDecorations) != null ? $ : [], I2 + r), M7 = new Ne(), w = Qt.getInstance();
    if (!u.collapsed && i) {
      const U2 = Je.selection.delete([u], p, 0, null, false);
      M7.push(...U2), E.params.textRanges = [{
        startOffset: I2 + v2,
        endOffset: I2 + v2,
        collapsed: true
      }];
    } else
      M7.push({
        t: Z.RETAIN,
        len: I2
      });
    r > 0 && M7.push({
      t: Z.DELETE,
      len: r
    }), M7.push({
      t: Z.INSERT,
      body: {
        dataStream: o,
        textRuns: B ? [{
          ...B,
          st: 0,
          ed: o.length
        }] : [],
        customRanges: C ? [{
          ...C,
          startIndex: 0,
          endIndex: o.length - 1
        }] : [],
        customDecorations: x7.map((U2) => ({
          ...U2,
          startIndex: 0,
          endIndex: o.length - 1
        }))
      },
      len: o.length
    });
    const F2 = Ae2(h, f2);
    E.params.actions = w.editOp(M7.serialize(), F2), E.params.noHistory = !s, E.params.isCompositionEnd = s;
    const P2 = a.syncExecuteCommand(E.id, E.params);
    return A.pushUndoRedoMutationParams(P2, E.params), !!P2;
  }
};
function qe4(n, e, t8) {
  return t8.executeCommand(yt2.id, {
    preCommandId: n,
    ...e != null ? e : {}
  });
}
var ri3 = "doc.command.set-inline-format-bold";
var Lt2 = {
  id: ri3,
  type: Ms.COMMAND,
  handler: async (n, e) => {
    const t8 = n.get(Ls);
    return qe4(
      ri3,
      e,
      t8
    );
  }
};
var si2 = "doc.command.set-inline-format-italic";
var Qt5 = {
  id: si2,
  type: Ms.COMMAND,
  handler: async (n, e) => {
    const t8 = n.get(Ls);
    return qe4(
      si2,
      e,
      t8
    );
  }
};
var ii2 = "doc.command.set-inline-format-underline";
var Ut3 = {
  id: ii2,
  type: Ms.COMMAND,
  handler: async (n, e) => {
    const t8 = n.get(Ls);
    return qe4(
      ii2,
      e,
      t8
    );
  }
};
var ai3 = "doc.command.set-inline-format-strikethrough";
var Ft4 = {
  id: ai3,
  type: Ms.COMMAND,
  handler: async (n, e) => {
    const t8 = n.get(Ls);
    return qe4(
      ai3,
      e,
      t8
    );
  }
};
var ci2 = "doc.command.set-inline-format-subscript";
var bt3 = {
  id: ci2,
  type: Ms.COMMAND,
  handler: async (n, e) => {
    const t8 = n.get(Ls);
    return qe4(
      ci2,
      e,
      t8
    );
  }
};
var li2 = "doc.command.set-inline-format-superscript";
var Ht2 = {
  id: li2,
  type: Ms.COMMAND,
  handler: async (n, e) => {
    const t8 = n.get(Ls);
    return qe4(
      li2,
      e,
      t8
    );
  }
};
var di2 = "doc.command.set-inline-format-fontsize";
var ct3 = {
  id: di2,
  type: Ms.COMMAND,
  handler: async (n, e) => {
    const t8 = n.get(Ls);
    return qe4(
      di2,
      e,
      t8
    );
  }
};
var Ai2 = "doc.command.set-inline-format-font-family";
var en3 = {
  id: Ai2,
  type: Ms.COMMAND,
  handler: async (n, e) => {
    const t8 = n.get(Ls);
    return qe4(
      Ai2,
      e,
      t8
    );
  }
};
var ui3 = "doc.command.set-inline-format-text-color";
var mt2 = {
  id: ui3,
  type: Ms.COMMAND,
  handler: async (n, e) => {
    const t8 = n.get(Ls);
    return qe4(
      ui3,
      e,
      t8
    );
  }
};
var hi2 = "doc.command.set-inline-format-text-background-color";
var Et = {
  id: hi2,
  type: Ms.COMMAND,
  handler: async (n, e) => {
    const t8 = n.get(Ls);
    return qe4(
      hi2,
      e,
      t8
    );
  }
};
var gi2 = "doc.command.reset-inline-format-text-background-color";
var Un2 = {
  id: gi2,
  type: Ms.COMMAND,
  handler: async (n, e) => {
    const t8 = n.get(Ls);
    return qe4(
      gi2,
      e,
      t8
    );
  }
};
var hr = {
  [Lt2.id]: "bl",
  [Qt5.id]: "it",
  [Ut3.id]: "ul",
  [Ft4.id]: "st",
  [ct3.id]: "fs",
  [en3.id]: "ff",
  [mt2.id]: "cl",
  [Et.id]: "bg",
  [Un2.id]: "bg",
  [bt3.id]: "va",
  [Ht2.id]: "va"
};
var yt2 = {
  id: "doc.command.set-inline-format",
  type: Ms.COMMAND,
  // eslint-disable-next-line max-lines-per-function, complexity
  handler: async (n, e) => {
    var R;
    const { value: t8, preCommandId: o } = e, r = n.get(Ls), s = n.get(m), i = n.get(vr), a = n.get(at2), c = s.getDocRanges(), d = (R = c.find((E) => E.isActive)) != null ? R : c[0];
    if (c.length === 0)
      return false;
    const { segmentId: l } = c[0], A = i.getCurrentUnitForType(we.UNIVER_DOC);
    if (A == null)
      return false;
    const h = A.getSelfOrHeaderFooterModel(l).getBody();
    if (h == null)
      return false;
    const u = A.getUnitId();
    let g;
    switch (o) {
      case Lt2.id:
      case Qt5.id:
      case Ut3.id:
      case Ft4.id:
      case bt3.id:
      case Ht2.id: {
        const E = a.getDefaultStyle(), b2 = Ma(
          h,
          d,
          E
        );
        g = Kd(
          b2,
          o
        );
        break;
      }
      case ct3.id:
      case en3.id: {
        g = t8;
        break;
      }
      case mt2.id:
      case Et.id: {
        g = {
          rgb: t8
        };
        break;
      }
      case Un2.id: {
        g = {
          rgb: null
        };
        break;
      }
      default:
        throw new Error(`Unknown command: ${o} in handleInlineFormat`);
    }
    const f2 = {
      id: M.id,
      params: {
        unitId: u,
        actions: [],
        textRanges: c
      }
    }, p = new Ne(), m2 = Qt.getInstance(), I2 = new Gn();
    I2.reset();
    for (const E of c) {
      let { startOffset: b2, endOffset: y, rangeType: C } = E;
      if (b2 == null || y == null)
        continue;
      if (C === jg.RECT && (b2 = b2 - 1), b2 === y) {
        const M7 = a.getStyleCache(), w = hr[o];
        a.setStyleCache(
          {
            [w]: (M7 == null ? void 0 : M7[w]) !== void 0 ? Ba(
              M7,
              w,
              o
            ) : g
          }
        );
        continue;
      }
      const B = {
        dataStream: "",
        textRuns: [
          {
            st: 0,
            ed: y - b2,
            ts: {
              [hr[o]]: g
            }
          }
        ]
      }, x7 = b2 - I2.cursor;
      x7 !== 0 && p.push({
        t: Z.RETAIN,
        len: x7
      }), p.push({
        t: Z.RETAIN,
        body: B,
        len: y - b2
      }), I2.reset(), I2.moveCursor(y);
    }
    const S = Ae2(A, l);
    return f2.params.actions = m2.editOp(p.serialize(), S), !!r.syncExecuteCommand(f2.id, f2.params);
  }
};
function Yd(n) {
  return n !== null && typeof n == "object";
}
function Ba(n, e, t8) {
  if (/bl|it/.test(e))
    return (n == null ? void 0 : n[e]) === ie.TRUE ? ie.FALSE : ie.TRUE;
  if (/ul|st/.test(e))
    return Yd(n == null ? void 0 : n[e]) && (n == null ? void 0 : n[e]).s === ie.TRUE ? {
      s: ie.FALSE
    } : {
      s: ie.TRUE
    };
  if (/va/.test(e))
    return t8 === bt3.id ? (n == null ? void 0 : n[e]) === Zt.SUBSCRIPT ? Zt.NORMAL : Zt.SUBSCRIPT : (n == null ? void 0 : n[e]) === Zt.SUPERSCRIPT ? Zt.NORMAL : Zt.SUPERSCRIPT;
}
function Ma(n, e, t8) {
  var l, A, h, u, g, f2, p, m2, I2, S, v2, R, E, b2;
  const { startOffset: o, endOffset: r, collapsed: s } = e;
  if (s) {
    const y = (l = n.textRuns) != null ? l : [];
    let C = null;
    for (let B = y.length - 1; B >= 0; B--) {
      const x7 = y[B];
      if (x7.st < o && o <= x7.ed) {
        C = x7;
        break;
      }
    }
    return C != null && C.ts ? { ...t8, ...C.ts } : t8;
  }
  const { textRuns: i = [] } = kt(n, o, r), a = J.deepClone(t8), c = i.map((y) => {
    var C;
    return (C = y == null ? void 0 : y.ts) == null ? void 0 : C.fs;
  }).filter(Boolean);
  a.fs = a.fs ? Math.max(a.fs, ...c) : c.length ? Math.max(...c) : void 0, a.fs = !a.fs || Number.isNaN(a.fs) ? void 0 : a.fs, a.ff = (u = (h = (A = i.find((y) => {
    var C;
    return ((C = y.ts) == null ? void 0 : C.ff) != null;
  })) == null ? void 0 : A.ts) == null ? void 0 : h.ff) != null ? u : a.ff, a.it = i.length && i.every((y) => {
    var C;
    return ((C = y.ts) == null ? void 0 : C.it) === ie.TRUE;
  }) ? ie.TRUE : ie.FALSE, a.bl = i.length && i.every((y) => {
    var C;
    return ((C = y.ts) == null ? void 0 : C.bl) === ie.TRUE;
  }) ? ie.TRUE : ie.FALSE, a.ul = i.length && i.every((y) => {
    var C, B;
    return ((B = (C = y.ts) == null ? void 0 : C.ul) == null ? void 0 : B.s) === ie.TRUE;
  }) ? (g = i[0].ts) == null ? void 0 : g.ul : a.ul, a.st = i.length && i.every((y) => {
    var C, B;
    return ((B = (C = y.ts) == null ? void 0 : C.st) == null ? void 0 : B.s) === ie.TRUE;
  }) ? (f2 = i[0].ts) == null ? void 0 : f2.st : a.st, a.bg = (I2 = (m2 = (p = i.find((y) => {
    var C;
    return ((C = y.ts) == null ? void 0 : C.bg) != null;
  })) == null ? void 0 : p.ts) == null ? void 0 : m2.bg) != null ? I2 : a.bg, a.cl = (R = (v2 = (S = i.find((y) => {
    var C;
    return ((C = y.ts) == null ? void 0 : C.cl) != null;
  })) == null ? void 0 : S.ts) == null ? void 0 : v2.cl) != null ? R : a.cl;
  const d = i.filter((y) => {
    var C;
    return ((C = y == null ? void 0 : y.ts) == null ? void 0 : C.va) != null;
  });
  if (d.length > 0 && d.length === i.length) {
    const y = (E = d[0].ts) == null ? void 0 : E.va;
    let C = true;
    for (let B = 1; B < d.length; B++)
      if (((b2 = d[B].ts) == null ? void 0 : b2.va) !== y) {
        C = false;
        break;
      }
    C && (a.va = y);
  }
  return a;
}
function Kd(n, e) {
  const t8 = hr[e];
  return Ba(n, t8, e);
}
var _a = {
  id: "doc.command-replace-snapshot",
  type: Ms.COMMAND,
  // eslint-disable-next-line max-lines-per-function, complexity
  handler: (n, e) => {
    const { unitId: t8, snapshot: o, textRanges: r, segmentId: s = "", options: i } = e, a = n.get(vr), c = n.get(Ls), d = n.get(m), l = a.getUnit(t8, we.UNIVER_DOC), A = l == null ? void 0 : l.getSelfOrHeaderFooterModel(s).getSnapshot();
    if (l == null || A == null)
      return false;
    const { body: h, tableSource: u, footers: g, headers: f2, lists: p, drawings: m2, drawingsOrder: I2, documentStyle: S } = J.deepClone(o), {
      body: v2,
      tableSource: R,
      footers: E,
      headers: b2,
      lists: y,
      drawings: C,
      drawingsOrder: B,
      documentStyle: x7
    } = A;
    if (h == null || v2 == null)
      return false;
    if (J.diffValue(h, v2) && r)
      return d.replaceDocRanges(r, {
        unitId: t8,
        subUnitId: t8
      }, false), true;
    const M7 = {
      id: M.id,
      params: {
        unitId: t8,
        actions: [],
        textRanges: r
      }
    };
    i && (M7.params.options = i);
    const w = [], F2 = Qt.getInstance();
    if (!J.diffValue(x7, S)) {
      const N = F2.replaceOp(["documentStyle"], x7, S);
      N != null && w.push(N);
    }
    if (!J.diffValue(h, v2)) {
      const N = F2.replaceOp(["body"], v2, h);
      N != null && w.push(N);
    }
    if (!J.diffValue(u, R)) {
      const N = F2.replaceOp(["tableSource"], R, u);
      N != null && w.push(N);
    }
    if (!J.diffValue(g, E)) {
      const N = F2.replaceOp(["footers"], E, g);
      N != null && w.push(N);
    }
    if (!J.diffValue(f2, b2)) {
      const N = F2.replaceOp(["headers"], b2, f2);
      N != null && w.push(N);
    }
    if (!J.diffValue(p, y)) {
      const N = F2.replaceOp(["lists"], y, p);
      N != null && w.push(N);
    }
    if (!J.diffValue(m2, C)) {
      const N = F2.replaceOp(["drawings"], C, m2);
      N != null && w.push(N);
    }
    if (!J.diffValue(I2, B)) {
      const N = F2.replaceOp(["drawingsOrder"], B, I2);
      N != null && w.push(N);
    }
    return M7.params.actions = w.reduce((N, ee3) => Qt.compose(N, ee3), null), !!c.syncExecuteCommand(M7.id, M7.params);
  }
};
var qd = {
  id: "doc.command-replace-content",
  type: Ms.COMMAND,
  handler: async (n, e) => {
    const { unitId: t8, body: o, textRanges: r, segmentId: s = "", options: i } = e, a = n.get(vr), c = n.get(Ls), d = n.get(m), l = a.getUnit(t8, we.UNIVER_DOC), A = l == null ? void 0 : l.getSelfOrHeaderFooterModel(s).getSnapshot().body;
    if (l == null || A == null)
      return false;
    const h = Da(t8, s, l, A, o);
    return h.params.textRanges = r, i && (h.params.options = i), h.params.actions == null && r ? (d.replaceDocRanges(r, {
      unitId: t8,
      subUnitId: t8
    }, false), true) : !!c.syncExecuteCommand(h.id, h.params);
  }
};
var Xd = {
  id: "doc.command-cover-content",
  type: Ms.COMMAND,
  handler: (n, e) => {
    const { unitId: t8, body: o, segmentId: r = "", textRanges: s } = e, i = n.get(vr), a = n.get(Ls), c = n.get(Qo), d = i.getUniverDocInstance(t8), l = d == null ? void 0 : d.getSnapshot().body;
    if (d == null || l == null)
      return false;
    const A = Da(t8, r, d, l, o);
    return A.params.noNeedSetTextRange = true, A.params.noHistory = true, A.params.textRanges = s, a.syncExecuteCommand(
      A.id,
      A.params
    ), c.clearUndoRedo(t8), true;
  }
};
function Zd(n, e, t8, o) {
  const r = new Ne(), s = Qt.getInstance(), i = (t8 == null ? void 0 : t8.dataStream.length) - 2;
  i > 0 && r.push({
    t: Z.DELETE,
    len: i
  }), o.dataStream.length > 0 && r.push({
    t: Z.INSERT,
    body: o,
    len: o.dataStream.length
  });
  const a = Ae2(e, n);
  return s.editOp(r.serialize(), a);
}
function Da(n, e, t8, o, r) {
  const s = {
    id: M.id,
    params: {
      unitId: n,
      actions: [],
      textRanges: []
    }
  }, i = Zd(e, t8, o, r);
  return s.params.actions = i, s;
}
var wa = {
  id: "doc.command.replace-selection",
  type: Ms.COMMAND,
  handler(n, e) {
    var g;
    if (!e)
      return false;
    const t8 = n.get(Ls), { unitId: o, body: r, textRanges: s } = e, a = n.get(vr).getUnit(o), c = n.get(m);
    if (!a)
      return false;
    const d = a.getBody(), l = (g = e.selection) != null ? g : c.getActiveTextRange();
    if (!l || !d)
      return false;
    const A = {
      id: M.id,
      params: {
        unitId: o,
        actions: [],
        textRanges: s,
        debounce: true
      }
    }, h = new Ne(), u = Qt.getInstance();
    return h.push(...Je.selection.delete([l], d, 0, r)), A.params.actions = u.editOp(h.serialize()), t8.syncExecuteCommand(A.id, A.params);
  }
};
var Jd = {
  id: "doc.command.replace-text-runs",
  type: Ms.COMMAND,
  handler: (n, e) => {
    const { unitId: t8, body: o, textRanges: r, segmentId: s = "", options: i } = e, a = n.get(vr), c = n.get(Ls), d = n.get(Gi), l = a.getUnit(t8, we.UNIVER_DOC), A = l == null ? void 0 : l.getSelfOrHeaderFooterModel(s).getSnapshot().body;
    if (l == null || A == null)
      return false;
    const h = Je.selection.replaceTextRuns({
      doc: l,
      body: o,
      selection: {
        startOffset: 0,
        endOffset: A.dataStream.length - 2,
        collapsed: false
      },
      themeService: d
    });
    if (!h)
      return false;
    const u = {
      id: M.id,
      params: {
        unitId: t8,
        actions: [],
        textRanges: r,
        noHistory: true
      }
    }, g = Qt.getInstance(), f2 = Ae2(l, s);
    return u.params.actions = g.editOp(h.serialize(), f2), u.params.textRanges = r, i && (u.params.options = i), !!c.syncExecuteCommand(u.id, u.params);
  }
};
var $d = {
  id: "doc.command.insert-custom-range",
  type: Ms.COMMAND,
  handler: (n, e) => {
    if (!e) return false;
    const t8 = n.get(Ls), { unitId: o, rangeId: r = et(), textRanges: s, properties: i, text: a, wholeEntity: c } = e, d = {
      unitId: o,
      textRanges: s,
      body: {
        dataStream: a,
        customRanges: [{
          startIndex: 0,
          endIndex: a.length - 1,
          rangeId: r,
          rangeType: pn.CUSTOM,
          properties: i,
          wholeEntity: c
        }]
      }
    };
    return t8.syncExecuteCommand(wa.id, d);
  }
};
var Fn4 = {
  id: "doc.command.list-operation",
  type: Ms.COMMAND,
  handler: (n, e) => {
    var v2, R, E, b2, y, C;
    const t8 = n.get(m), o = n.get(vr), r = n.get(Ls), s = e.listType, i = o.getCurrentUnitForType(we.UNIVER_DOC), a = (R = (v2 = e.docRange) != null ? v2 : t8.getDocRanges()) != null ? R : [];
    if (i == null || a.length === 0)
      return false;
    const c = a[0].segmentId, d = i.getSelfOrHeaderFooterModel(c), l = (b2 = (E = d.getBody()) == null ? void 0 : E.paragraphs) != null ? b2 : [], A = (C = (y = d.getBody()) == null ? void 0 : y.dataStream) != null ? C : "";
    if (!l.length)
      return false;
    const h = Je.range.getParagraphsInRanges(a, l, A), u = i.getUnitId(), g = {
      id: M.id,
      params: {
        unitId: u,
        actions: [],
        textRanges: a,
        isEditing: false
      }
    };
    new Gn().reset();
    const p = Je.paragraph.bullet.switch({
      paragraphs: h,
      listType: s,
      document: i,
      segmentId: c
    }), m2 = Qt.getInstance(), I2 = Ae2(i, c);
    return g.params.actions = m2.editOp(p.serialize(), I2), !!r.syncExecuteCommand(g.id, g.params);
  }
};
var Lo2 = {
  id: "doc.command.change-list-type",
  type: Ms.COMMAND,
  handler: (n, e) => {
    var S, v2, R, E, b2;
    const t8 = n.get(m), o = n.get(vr), r = n.get(Ls), { listType: s } = e, i = o.getCurrentUnitForType(we.UNIVER_DOC), a = (S = e.docRange) != null ? S : t8.getDocRanges();
    if (i == null || a == null || !a.length)
      return false;
    const { segmentId: c } = a[0], d = i.getSelfOrHeaderFooterModel(c), l = (R = (v2 = d.getBody()) == null ? void 0 : v2.paragraphs) != null ? R : [], A = (b2 = (E = d.getBody()) == null ? void 0 : E.dataStream) != null ? b2 : "";
    if (!l.length)
      return false;
    const h = Je.range.getParagraphsInRanges(a, l, A), u = i.getUnitId(), g = Je.paragraph.bullet.set({
      paragraphs: h,
      listType: s,
      segmentId: c,
      document: i
    });
    if (!g)
      return false;
    const f2 = Qt.getInstance(), p = {
      id: M.id,
      params: {
        unitId: u,
        actions: [],
        textRanges: a,
        isEditing: false
      }
    }, m2 = Ae2(i, c);
    return p.params.actions = f2.editOp(g.serialize(), m2), !!r.syncExecuteCommand(p.id, p.params);
  }
};
var qn3 = ((n) => (n[n.increase = 1] = "increase", n[n.decrease = -1] = "decrease", n))(qn3 || {});
var gr2 = {
  id: "doc.command.change-list-nesting-level",
  type: Ms.COMMAND,
  handler: (n, e) => {
    var v2, R, E, b2, y;
    if (!e)
      return false;
    const { type: t8 } = e, o = n.get(m), r = n.get(vr), s = n.get(Ls), i = r.getCurrentUnitForType(we.UNIVER_DOC), a = o.getActiveTextRange();
    if (i == null || a == null)
      return false;
    const { segmentId: c } = a, d = (v2 = o.getDocRanges()) != null ? v2 : [], l = i.getSelfOrHeaderFooterModel(c), A = (E = (R = l.getBody()) == null ? void 0 : R.paragraphs) != null ? E : [], h = (y = (b2 = l.getBody()) == null ? void 0 : b2.dataStream) != null ? y : "";
    if (!A.length)
      return false;
    const u = Je.range.getParagraphsInRange(a, A, h), g = i.getUnitId(), f2 = Qt.getInstance(), p = Je.paragraph.bullet.changeNestLevel({
      paragraphs: u,
      type: t8,
      segmentId: c,
      document: i
    }), m2 = {
      id: M.id,
      params: {
        unitId: g,
        actions: [],
        textRanges: d,
        isEditing: false
      }
    }, I2 = Ae2(i, c);
    return m2.params.actions = f2.editOp(p.serialize(), I2), !!s.syncExecuteCommand(m2.id, m2.params);
  }
};
var xn3 = {
  id: "doc.command.bullet-list",
  type: Ms.COMMAND,
  handler: (n, e) => {
    const t8 = n.get(Ls);
    return e != null && e.value ? t8.syncExecuteCommand(Lo2.id, {
      listType: e.value,
      docRange: e.docRange
    }) : t8.syncExecuteCommand(Fn4.id, {
      listType: zt.BULLET_LIST,
      docRange: e == null ? void 0 : e.docRange
    });
  }
};
var so2 = {
  id: "doc.command.check-list",
  type: Ms.COMMAND,
  handler: (n, e) => {
    const t8 = n.get(Ls);
    return e != null && e.value ? t8.syncExecuteCommand(Lo2.id, {
      listType: e.value,
      docRange: e.docRange
    }) : t8.syncExecuteCommand(Fn4.id, {
      listType: zt.CHECK_LIST,
      docRange: e == null ? void 0 : e.docRange
    });
  }
};
var Pa = {
  id: "doc.command.toggle-check-list",
  type: Ms.COMMAND,
  handler: (n, e) => {
    var f2;
    if (!e)
      return false;
    const t8 = n.get(vr), o = n.get(Ls), { index: r, segmentId: s, textRanges: i } = e, a = t8.getCurrentUnitForType(we.UNIVER_DOC);
    if (a == null || ((f2 = a.getSelfOrHeaderFooterModel(s).getBody()) == null ? void 0 : f2.paragraphs) == null)
      return false;
    const d = a.getUnitId(), l = {
      id: M.id,
      params: {
        unitId: d,
        actions: [],
        textRanges: i != null ? i : [],
        segmentId: s,
        isEditing: false
      }
    }, A = Je.paragraph.bullet.toggleChecklist({
      document: a,
      paragraphIndex: r,
      segmentId: s
    });
    if (!A)
      return false;
    const h = Qt.getInstance(), u = Ae2(a, s);
    return l.params.actions = h.editOp(A.serialize(), u), !!o.syncExecuteCommand(l.id, l.params);
  }
};
var On2 = {
  id: "doc.command.order-list",
  type: Ms.COMMAND,
  handler: (n, e) => {
    const t8 = n.get(Ls);
    return e != null && e.value ? t8.syncExecuteCommand(Lo2.id, {
      listType: e.value
    }) : t8.syncExecuteCommand(Fn4.id, {
      listType: zt.ORDER_LIST
    });
  }
};
var Na = {
  id: "doc.command.quick-list",
  type: Ms.COMMAND,
  // eslint-disable-next-line max-lines-per-function
  handler(n, e) {
    var x7, M7, w;
    if (!e)
      return false;
    const t8 = n.get(m), o = n.get(vr), r = n.get(Ls), s = o.getCurrentUnitForType(we.UNIVER_DOC), i = t8.getActiveTextRange();
    if (s == null || i == null)
      return false;
    const { segmentId: a, startOffset: c } = i, { listType: d, paragraph: l } = e, { paragraphStart: A, paragraphEnd: h } = l, u = new Ne(), g = Qt.getInstance(), { paragraphStyle: f2 = {} } = l, m2 = ($s[d].nestingLevel[0].paragraphProperties || {}).textStyle;
    let S = et(6);
    const v2 = (M7 = (x7 = s.getBody()) == null ? void 0 : x7.paragraphs) != null ? M7 : [], R = v2.findIndex((F2) => F2.startIndex === l.startIndex), E = v2[R - 1], b2 = v2[R + 1];
    E && E.bullet && E.bullet.listType.indexOf(d) === 0 ? S = E.bullet.listId : b2 && b2.bullet && b2.bullet.listType.indexOf(d) === 0 && (S = b2.bullet.listId);
    const y = {
      id: M.id,
      params: {
        unitId: s.getUnitId(),
        actions: [],
        textRanges: [{
          startOffset: A,
          endOffset: A,
          collapsed: true
        }],
        isEditing: false
      }
    };
    u.push({
      t: Z.RETAIN,
      len: A
    }), u.push({
      t: Z.DELETE,
      len: c - A
    }), h > c && u.push({
      t: Z.RETAIN,
      len: h - c
    }), u.push({
      t: Z.RETAIN,
      len: 1,
      body: {
        dataStream: "",
        paragraphs: [
          {
            startIndex: 0,
            paragraphStyle: {
              ...f2,
              textStyle: {
                ...f2.textStyle,
                ...m2
              },
              indentFirstLine: void 0
            },
            bullet: {
              ...(w = l.bullet) != null ? w : {
                nestingLevel: 0,
                textStyle: {
                  fs: 20
                }
              },
              listType: d,
              listId: S
            }
          }
        ]
      }
    });
    const C = Ae2(s, a);
    return y.params.actions = g.editOp(u.serialize(), C), !!r.syncExecuteCommand(y.id, y.params);
  }
};
function cs2(n, e) {
  var l, A;
  const t8 = n.get(Ls), o = Qn2(n);
  if (!o)
    return false;
  const r = n.get(vr).getCurrentUnitOfType(we.UNIVER_DOC);
  if (!r)
    return false;
  const s = Je.selection.replace({
    doc: r,
    selection: {
      startOffset: o.startIndex + 1,
      endOffset: o.startIndex + 1,
      collapsed: true
    },
    body: {
      dataStream: "\r",
      paragraphs: [
        {
          startIndex: 0,
          paragraphStyle: {
            ...o.paragraphStyle
          },
          bullet: {
            listType: e,
            listId: ((l = o.bullet) == null ? void 0 : l.listType) === e ? o.bullet.listId : et(6),
            nestingLevel: ((A = o.bullet) == null ? void 0 : A.listType) === e ? o.bullet.nestingLevel : 0
          }
        }
      ]
    }
  });
  if (!s)
    return false;
  const i = {
    id: M.id,
    params: {
      unitId: r.getUnitId(),
      actions: [],
      textRanges: [{
        startOffset: o.startIndex + 1,
        endOffset: o.startIndex + 1,
        collapsed: true
      }],
      isEditing: false
    }
  }, a = Qt.getInstance(), c = Ae2(r);
  return i.params.actions = a.editOp(s.serialize(), c), !!t8.syncExecuteCommand(i.id, i.params);
}
var ls2 = {
  id: "doc.command.insert-bullet-list-bellow",
  type: Ms.COMMAND,
  handler: (n) => cs2(n, zt.BULLET_LIST)
};
var ds2 = {
  id: "doc.command.insert-order-list-bellow",
  type: Ms.COMMAND,
  handler: (n) => cs2(n, zt.ORDER_LIST)
};
var As = {
  id: "doc.command.insert-check-list-bellow",
  type: Ms.COMMAND,
  handler: (n) => cs2(n, zt.CHECK_LIST)
};
var lt3 = {
  id: "doc.command.align-action",
  type: Ms.COMMAND,
  // eslint-disable-next-line max-lines-per-function
  handler: (n, e) => {
    var R, E, b2, y;
    const t8 = n.get(m), o = n.get(vr), r = n.get(Ls), { alignType: s } = e, i = o.getCurrentUniverDocInstance();
    if (i == null)
      return false;
    const a = t8.getDocRanges();
    if (a.length === 0)
      return false;
    const c = a[0].segmentId, d = i.getSelfOrHeaderFooterModel(c), l = (E = (R = d.getBody()) == null ? void 0 : R.paragraphs) != null ? E : [], A = (y = (b2 = d.getBody()) == null ? void 0 : b2.dataStream) != null ? y : "";
    if (l == null)
      return false;
    const h = Je.range.getParagraphsInRanges(a, l, A), u = i.getUnitId(), g = h.every((C) => {
      var B;
      return ((B = C.paragraphStyle) == null ? void 0 : B.horizontalAlign) === s;
    }), f2 = {
      id: M.id,
      params: {
        unitId: u,
        actions: [],
        textRanges: a
      }
    }, p = new Gn();
    p.reset();
    const m2 = new Ne(), I2 = Qt.getInstance();
    for (const C of h) {
      const { startIndex: B } = C;
      m2.push({
        t: Z.RETAIN,
        len: B - p.cursor
      });
      const x7 = {
        ...C.paragraphStyle,
        horizontalAlign: g ? Ut.UNSPECIFIED : s
      };
      m2.push({
        t: Z.RETAIN,
        len: 1,
        body: {
          dataStream: "",
          paragraphs: [
            {
              ...C,
              paragraphStyle: x7,
              startIndex: 0
            }
          ]
        },
        coverType: pe.REPLACE
      }), p.moveCursorTo(B + 1);
    }
    const S = Ae2(i, c);
    return f2.params.actions = I2.editOp(m2.serialize(), S), !!r.syncExecuteCommand(f2.id, f2.params);
  }
};
var Qo3 = {
  id: "doc.command.align-left",
  type: Ms.COMMAND,
  handler: (n) => n.get(Ls).syncExecuteCommand(lt3.id, {
    alignType: Ut.LEFT
  })
};
var Uo2 = {
  id: "doc.command.align-center",
  type: Ms.COMMAND,
  handler: (n) => n.get(Ls).syncExecuteCommand(lt3.id, {
    alignType: Ut.CENTER
  })
};
var Fo2 = {
  id: "doc.command.align-right",
  type: Ms.COMMAND,
  handler: (n) => n.get(Ls).syncExecuteCommand(lt3.id, {
    alignType: Ut.RIGHT
  })
};
var Ho2 = {
  id: "doc.command.align-justify",
  type: Ms.COMMAND,
  handler: (n) => n.get(Ls).syncExecuteCommand(lt3.id, {
    alignType: Ut.JUSTIFIED
  })
};
var eA2 = (n, e) => {
  const o = n.get(vr).getUnit(e.unitId, we.UNIVER_DOC);
  return o == null || o.setZoomRatio(e.zoomRatio), { ...e };
};
var tt2 = {
  id: "doc.operation.set-zoom-ratio",
  type: Ms.OPERATION,
  handler: (n, e) => {
    const o = n.get(vr).getUnit(e.unitId, we.UNIVER_DOC);
    return o ? (o.setZoomRatio(e.zoomRatio), true) : false;
  }
};
var Xn2 = {
  type: Ms.COMMAND,
  id: "doc.command.set-zoom-ratio",
  handler: async (n, e) => {
    var A, h, u;
    const t8 = n.get(Ls), o = n.get(Qo), r = n.get(vr);
    let s = (A = r.getCurrentUniverDocInstance()) == null ? void 0 : A.getUnitId();
    if (!s) return false;
    let i = 1;
    if (e && (s = (h = e.documentId) != null ? h : s, i = (u = e.zoomRatio) != null ? u : i), !r.getUniverDocInstance(s)) return false;
    const c = {
      zoomRatio: i,
      unitId: s
    }, d = eA2(n, c);
    return t8.syncExecuteCommand(tt2.id, c) ? (o.pushUndoRedo({
      unitID: s,
      undoMutations: [{ id: tt2.id, params: d }],
      redoMutations: [{ id: tt2.id, params: c }]
    }), true) : false;
  }
};
var Xe3 = {
  id: "doc.command.set-paragraph-named-style",
  type: Ms.COMMAND,
  handler(n, e) {
    var g;
    if (!e)
      return false;
    const o = n.get(vr).getCurrentUnitOfType(we.UNIVER_DOC);
    if (!o)
      return false;
    const r = o.getUnitId(), s = n.get(m), i = (g = e.textRanges) != null ? g : s.getTextRanges({ unitId: r, subUnitId: r });
    if (!(i != null && i.length))
      return false;
    const a = i[0].segmentId, c = Je.paragraph.style.set({
      document: o.getSelfOrHeaderFooterModel(a),
      textRanges: i,
      style: {
        namedStyleType: e.value,
        headingId: !e.value || e.value === qe.NORMAL_TEXT ? void 0 : et(6),
        spaceAbove: void 0,
        spaceBelow: void 0,
        lineSpacing: void 0
      },
      paragraphTextRun: {}
    }), d = {
      id: M.id,
      params: {
        actions: [],
        textRanges: i,
        unitId: r,
        segmentId: a
      }
    }, l = Qt.getInstance(), A = Ae2(o, a);
    return d.params.actions = l.editOp(c.serialize(), A), !!n.get(Ls).syncExecuteCommand(d.id, d.params);
  }
};
var La = {
  id: "doc.command.quick-heading",
  type: Ms.COMMAND,
  handler(n, e) {
    var R, E, b2, y;
    if (!e)
      return false;
    const { value: t8 } = e, o = n.get(m), r = n.get(vr), s = n.get(Ls), i = r.getCurrentUnitForType(we.UNIVER_DOC), a = o.getActiveTextRange();
    if (i == null || a == null || !a.collapsed)
      return false;
    const { segmentId: c, startOffset: d } = a, l = i.getSelfOrHeaderFooterModel(c), A = (E = (R = l.getBody()) == null ? void 0 : R.paragraphs) != null ? E : [], h = (y = (b2 = l.getBody()) == null ? void 0 : b2.dataStream) != null ? y : "", u = Je.paragraph.util.getParagraphsInRange(a, A, h)[0];
    if (!u)
      return false;
    const { paragraphStart: g } = u, f2 = new Ne(), p = Qt.getInstance(), { paragraphStyle: m2 = {} } = u, I2 = {
      id: M.id,
      params: {
        unitId: i.getUnitId(),
        actions: [],
        textRanges: [{
          startOffset: g,
          endOffset: g,
          collapsed: true
        }],
        isEditing: false
      }
    };
    f2.push({
      t: Z.RETAIN,
      len: g
    }), Je.paragraph.style.set({
      textRanges: [a],
      document: i,
      style: {
        ...m2,
        headingId: et(6),
        namedStyleType: t8
      },
      cursor: d,
      deleteLen: d - g,
      textX: f2,
      paragraphTextRun: {}
    });
    const S = Ae2(i, c);
    return I2.params.actions = p.editOp(f2.serialize(), S), !!s.syncExecuteCommand(I2.id, I2.params);
  }
};
var qo3 = {
  "#": qe.HEADING_1,
  "##": qe.HEADING_2,
  "###": qe.HEADING_3,
  "####": qe.HEADING_4,
  "#####": qe.HEADING_5
};
var us2 = {
  id: "doc.command.h1-heading",
  type: Ms.COMMAND,
  handler: (n) => n.get(Ls).syncExecuteCommand(Xe3.id, {
    value: qe.HEADING_1
  })
};
var hs2 = {
  id: "doc.command.h2-heading",
  type: Ms.COMMAND,
  handler: (n) => n.get(Ls).syncExecuteCommand(Xe3.id, {
    value: qe.HEADING_2
  })
};
var gs2 = {
  id: "doc.command.h3-heading",
  type: Ms.COMMAND,
  handler: (n) => n.get(Ls).syncExecuteCommand(Xe3.id, {
    value: qe.HEADING_3
  })
};
var fs = {
  id: "doc.command.h4-heading",
  type: Ms.COMMAND,
  handler: (n) => n.get(Ls).syncExecuteCommand(Xe3.id, {
    value: qe.HEADING_4
  })
};
var ps = {
  id: "doc.command.h5-heading",
  type: Ms.COMMAND,
  handler: (n) => n.get(Ls).syncExecuteCommand(Xe3.id, {
    value: qe.HEADING_5
  })
};
var io2 = {
  id: "doc.command.normal-text-heading",
  type: Ms.COMMAND,
  handler: (n) => n.get(Ls).syncExecuteCommand(Xe3.id, {
    value: qe.NORMAL_TEXT
  })
};
var Qa = {
  id: "doc.command.title",
  type: Ms.COMMAND,
  handler: (n) => n.get(Ls).syncExecuteCommand(Xe3.id, {
    value: qe.TITLE
  })
};
var Ua2 = {
  id: "doc.command.subtitle-heading",
  type: Ms.COMMAND,
  handler: (n) => n.get(Ls).syncExecuteCommand(Xe3.id, {
    value: qe.SUBTITLE
  })
};
var Zn2 = ((n) => (n[n.page = 0] = "page", n[n.section = 1] = "section", n[n.column = 2] = "column", n[n.line = 3] = "line", n[n.divide = 4] = "divide", n[n.glyph = 5] = "glyph", n))(Zn2 || {});
var Kt2 = {
  page: 0,
  section: 1,
  column: 2,
  line: 3,
  divide: 4,
  glyph: 5
};
function ms(n, e) {
  return n.page > e.page ? false : n.page < e.page ? true : n.section > e.section ? false : n.section < e.section ? true : n.column > e.column ? false : n.column < e.column ? true : n.line > e.line ? false : n.line < e.line ? true : n.divide > e.divide ? false : n.divide < e.divide ? true : n.glyph > e.glyph ? false : (n.glyph < e.glyph, true);
}
function fr2(n, e) {
  return ms(n, e) ? {
    start: n,
    end: e
  } : {
    start: e,
    end: n
  };
}
function fi2(n) {
  const e = n.length;
  if (e === 0)
    return;
  const t8 = n[0], o = n[e - 1], r = n.length === 1 && t8.collapsed;
  return {
    startOffset: t8.startOffset,
    endOffset: o.endOffset,
    collapsed: r
  };
}
function tA2(n, e, t8, o) {
  let r = o, s = o;
  for (let i = 0; i < n.length; i++) {
    const c = n[i].count;
    i < e && (r += c), i < t8 && (s += c);
  }
  return {
    startOffset: r,
    endOffset: s
  };
}
function pr2(n) {
  const { startX: e, startY: t8, endX: o, endY: r } = n, s = [];
  return s.push({
    x: e,
    y: t8
  }), s.push({
    x: o,
    y: t8
  }), s.push({
    x: o,
    y: r
  }), s.push({
    x: e,
    y: r
  }), s.push({
    x: e,
    y: t8
  }), s;
}
var It2 = class {
  constructor(e, t8) {
    O(this, "_liquid", new J4());
    O(this, "_currentStartState", {
      page: 0,
      section: 0,
      column: 0,
      line: 0,
      divide: 0,
      glyph: 0
      /* NORMAL */
    });
    O(this, "_currentEndState", {
      page: 0,
      section: 0,
      column: 0,
      line: 0,
      divide: 0,
      glyph: 0
      /* NORMAL */
    });
    this._documentOffsetConfig = e, this._docSkeleton = t8;
  }
  // eslint-disable-next-line max-lines-per-function
  getRangePointData(e, t8) {
    const o = [], r = [], s = [];
    if (e == null || t8 == null)
      return {
        borderBoxPointGroup: o,
        contentBoxPointGroup: r,
        cursorList: s
      };
    if (!this._isValidPosition(e, t8))
      throw new Error(
        `
                Invalid positions in NodePositionConvertToCursor,
                they are not in the same segment page when in header or footer.`
      );
    const { start: a, end: c } = fr2(e, t8);
    return this._selectionIterator(a, c, (d, l, A, h, u, g) => {
      const { lineHeight: f2, asc: p, paddingTop: m2, marginTop: I2, marginBottom: S } = g, { glyphGroup: v2, st: R } = u;
      if (v2.length === 0)
        return;
      const { x: E, y: b2 } = this._liquid;
      let y, C;
      const B = v2[d], x7 = v2[l], M7 = v2[d - 1], w = (B == null ? void 0 : B.left) || 0, F2 = (B == null ? void 0 : B.width) || 0, P2 = (x7 == null ? void 0 : x7.left) || 0, N = (x7 == null ? void 0 : x7.width) || 0, ee3 = (B == null ? void 0 : B.glyphType) === e2.LIST, { startOffset: $, endOffset: U2 } = tA2(v2, d, l, R), H3 = a.glyph === d && A ? a.isBack : true, k7 = c.glyph === l && h ? c.isBack : false, ne2 = a === c, ie5 = H3 && M7 != null ? M7 : B;
      if (d === 0 && l === v2.length - 1)
        y = {
          startX: E + w + (ee3 ? F2 : 0),
          startY: b2,
          endX: E + P2 + (k7 ? 0 : N),
          endY: b2 + f2 - I2 - S
        }, C = {
          startX: E + w + (ee3 ? F2 : 0),
          startY: b2 + m2 + p - ie5.bBox.ba,
          endX: E + P2 + (k7 ? 0 : N),
          endY: b2 + m2 + p + ie5.bBox.bd
        };
      else {
        const ae2 = H3 && !ee3;
        y = {
          startX: E + w + (ae2 ? 0 : F2),
          startY: b2,
          endX: E + P2 + (k7 ? 0 : N),
          endY: b2 + f2 - I2 - S
        }, C = {
          startX: E + w + (ae2 ? 0 : F2),
          startY: b2 + m2 + p - ie5.bBox.ba,
          endX: E + P2 + (k7 ? 0 : N),
          endY: b2 + m2 + p + ie5.bBox.bd
        };
      }
      o.push(pr2(y)), r.push(pr2(C)), s.push({
        startOffset: H3 ? $ : $ + B.count,
        endOffset: k7 ? U2 : U2 + x7.count,
        collapsed: ne2
      });
    }), {
      borderBoxPointGroup: o,
      contentBoxPointGroup: r,
      cursorList: s
    };
  }
  _isValidPosition(e, t8) {
    const { segmentPage: o, pageType: r } = e, { segmentPage: s, pageType: i } = t8;
    return r !== i ? false : r === c1.HEADER || r === c1.FOOTER ? o === s : true;
  }
  _resetCurrentNodePositionState() {
    this._currentStartState = {
      page: 0,
      section: 0,
      column: 0,
      line: 0,
      divide: 0,
      glyph: 0
      /* NORMAL */
    }, this._currentEndState = {
      page: 0,
      section: 0,
      column: 0,
      line: 0,
      divide: 0,
      glyph: 0
      /* NORMAL */
    };
  }
  _setNodePositionState(e = 0, t8, o, r) {
    r === t8 ? this._currentStartState[e] = 1 : this._currentStartState[e] = 0, r === o ? this._currentEndState[e] = 2 : this._currentEndState[e] = 0;
  }
  _checkPreviousNodePositionState(e, t8 = true) {
    let o = e, r;
    for (; o >= 0; ) {
      const s = Zn2[o];
      let i;
      if (t8 ? i = this._currentStartState[s] : i = this._currentEndState[s], i === void 0)
        return;
      if (r === void 0 && (r = i), i !== r)
        return 0;
      o--;
    }
    return r;
  }
  _getSelectionRuler(e, t8, o, r, s) {
    let i = 0, a = r;
    const c = Zn2[e], d = Zn2[e + 1];
    if (d === null || c === null)
      return {
        start_next: i,
        end_next: a
      };
    const l = t8[c], A = o[c];
    this._setNodePositionState(c, l, A, s);
    const h = this._checkPreviousNodePositionState(e), u = this._checkPreviousNodePositionState(e, false);
    return h === 1 && (i = t8[d]), u === 2 && (a = o[d]), {
      start_next: i,
      end_next: a
    };
  }
  // eslint-disable-next-line max-lines-per-function, complexity
  _selectionIterator(e, t8, o) {
    var v2, R;
    const r = this._docSkeleton;
    if (!r)
      return [];
    const { pageType: s, path: i } = e;
    this._liquid.reset();
    const a = r.getSkeletonData();
    if (a == null)
      return [];
    const { pages: c, skeHeaders: d, skeFooters: l } = a, { page: A, segmentPage: h } = e, { page: u, segmentPage: g } = t8;
    if (this._resetCurrentNodePositionState(), this._documentOffsetConfig == null)
      return [];
    const { pageLayoutType: f2, pageMarginLeft: p, pageMarginTop: m2 } = this._documentOffsetConfig, I2 = s === c1.BODY || s === c1.CELL ? A : h;
    for (let E = 0; E < I2; E++) {
      const b2 = c[E];
      this._liquid.translatePage(b2, f2, p, m2);
    }
    const S = s === c1.BODY || s === c1.CELL ? u : g;
    for (let E = I2; E <= S; E++) {
      const b2 = c[E], { headerId: y, footerId: C, pageWidth: B } = b2;
      let x7 = b2;
      if (s === c1.HEADER ? x7 = (v2 = d.get(y)) == null ? void 0 : v2.get(B) : s === c1.FOOTER ? x7 = (R = l.get(C)) == null ? void 0 : R.get(B) : s === c1.CELL && (x7 = dz(a, i)), x7 == null) {
        this._liquid.translatePage(b2, f2, p, m2);
        continue;
      }
      const M7 = x7.sections, { start_next: w, end_next: F2 } = this._getSelectionRuler(
        Kt2.page,
        e,
        t8,
        M7.length - 1,
        s === c1.BODY || s === c1.CELL ? E : 0
      );
      switch (this._liquid.translateSave(), s) {
        case c1.HEADER:
          this._liquid.translatePagePadding({
            ...x7,
            marginLeft: b2.marginLeft
            // Because header or footer margin Left is 0.
          });
          break;
        case c1.FOOTER: {
          const P2 = b2.pageHeight - x7.height - x7.marginBottom;
          this._liquid.translate(b2.marginLeft, P2);
          break;
        }
        case c1.CELL: {
          this._liquid.translatePagePadding(b2);
          const P2 = x7.parent, N = P2.parent, { left: ee3 } = x7, { top: $, left: U2 } = N, { top: H3 } = P2;
          this._liquid.translate(U2 + ee3, $ + H3), this._liquid.translatePagePadding(x7);
          break;
        }
        default:
          this._liquid.translatePagePadding(b2);
          break;
      }
      for (let P2 = w; P2 <= F2; P2++) {
        const N = M7[P2], ee3 = N.columns, { start_next: $, end_next: U2 } = this._getSelectionRuler(
          Kt2.section,
          e,
          t8,
          ee3.length - 1,
          P2
        );
        this._liquid.translateSection(N);
        for (let H3 = $; H3 <= U2; H3++) {
          const k7 = ee3[H3], ne2 = k7.lines, { start_next: ie5, end_next: ae2 } = this._getSelectionRuler(
            Kt2.column,
            e,
            t8,
            ne2.length - 1,
            H3
          );
          this._liquid.translateColumn(k7);
          for (let oe2 = ie5; oe2 <= ae2; oe2++) {
            const he3 = ne2[oe2], { divides: we4 } = he3, { start_next: Ze, end_next: At2 } = this._getSelectionRuler(
              Kt2.line,
              e,
              t8,
              we4.length - 1,
              oe2
            );
            this._liquid.translateSave(), this._liquid.translateLine(he3, true, false);
            for (let Je4 = Ze; Je4 <= At2; Je4++) {
              const Wo2 = we4[Je4];
              this._liquid.translateSave(), this._liquid.translateDivide(Wo2);
              const { glyphGroup: xc2 } = Wo2, { start_next: Oc2, end_next: Tc } = this._getSelectionRuler(
                Kt2.divide,
                e,
                t8,
                xc2.length - 1,
                Je4
              );
              let Ns3 = false, Ls3 = false;
              E === I2 && P2 === w && H3 === $ && oe2 === ie5 && Je4 === Ze && (Ns3 = true), E === S && P2 === F2 && H3 === U2 && oe2 === ae2 && Je4 === At2 && (Ls3 = true), o && o(Oc2, Tc, Ns3, Ls3, Wo2, he3, k7, N, x7), this._liquid.translateRestore();
            }
            this._liquid.translateRestore();
          }
        }
      }
      this._liquid.translateRestore(), this._liquid.translatePage(b2, f2, p, m2);
    }
  }
};
function nA(n, e) {
  const { path: t8 } = n, { path: o } = e;
  if (t8.length !== o.length || t8.indexOf("cells") === -1)
    return false;
  const r = t8.indexOf("skeTables") + 1, s = t8.indexOf("rows") + 1, i = t8.indexOf("cells") + 1, { tableId: a, sliceIndex: c } = OB(t8[r]), { tableId: d, sliceIndex: l } = OB(o[r]);
  if (a !== d)
    return false;
  const A = t8[s], h = o[s], u = t8[i], g = o[i];
  return !(A === h && u === g && c === l);
}
function Fa(n, e) {
  const { path: t8 } = n, { path: o } = e;
  return t8.indexOf("cells") === -1 || o.indexOf("cells") === -1 || t8.length !== o.length ? false : J.diffValue(t8, o);
}
function Ha(n, e, t8) {
  var u, g, f2, p, m2, I2, S, v2;
  const { path: o } = e, { path: r } = t8;
  if (o.indexOf("cells") === -1 || r.indexOf("cells") === -1)
    return false;
  const s = n.findGlyphByPosition(e), i = n.findGlyphByPosition(t8), a = (p = (f2 = (g = (u = s == null ? void 0 : s.parent) == null ? void 0 : u.parent) == null ? void 0 : g.parent) == null ? void 0 : f2.parent) == null ? void 0 : p.parent, c = (v2 = (S = (I2 = (m2 = i == null ? void 0 : i.parent) == null ? void 0 : m2.parent) == null ? void 0 : I2.parent) == null ? void 0 : S.parent) == null ? void 0 : v2.parent;
  if (a == null || c == null)
    return false;
  const d = a.parent, l = c.parent, A = d.cells.indexOf(a), h = l.cells.indexOf(c);
  return A === h && d.index === l.index;
}
function Xo3(n, e) {
  if (Fa(n, e))
    return ms(n, e);
  const { path: t8 } = n, { path: o } = e, r = t8[t8.length - 5], s = o[o.length - 5];
  if (r !== s && typeof r == "string" && typeof s == "string") {
    const l = r.split("#-#")[1], A = s.split("#-#")[1];
    return +l < +A;
  }
  const i = t8[t8.length - 3], a = o[o.length - 3], c = t8[t8.length - 1], d = o[o.length - 1];
  return i < a ? true : i > a ? false : c <= d;
}
function Wt3(n) {
  return n.sections[0].columns[0].lines.length === 0;
}
function oA(n, e, t8) {
  let o = e, r = t8, s = n[o], i = n[r];
  for (; o < r && (Wt3(s) || Wt3(i)); )
    Wt3(s) ? (o++, s = n[o]) : Wt3(i) && (r--, i = n[r]);
  if (!Wt3(s) && !Wt3(i))
    return [s, i];
}
var ka = class {
  constructor(e, t8) {
    O(this, "_liquid", new J4());
    this._documentOffsetConfig = e, this._docSkeleton = t8;
  }
  // eslint-disable-next-line max-lines-per-function
  getRangePointData(e, t8) {
    const o = [], s = this._docSkeleton.getSkeletonData();
    if (s == null)
      return;
    const { pages: i } = s, { segmentPage: a, page: c, pageType: d } = e, l = this._getTableRectRangeInfo(e, t8);
    if (l == null)
      return;
    const {
      tableId: A,
      startRowIndex: h,
      startColumnIndex: u,
      endRowIndex: g,
      endColumnIndex: f2
    } = l;
    this._liquid.reset();
    const { pageLayoutType: p, pageMarginLeft: m2, pageMarginTop: I2 } = this._documentOffsetConfig, S = d === c1.BODY || d === c1.CELL ? c : a;
    for (let v2 = 0; v2 < S; v2++) {
      const R = i[v2];
      this._liquid.translatePage(R, p, m2, I2);
    }
    for (let v2 = S; v2 < i.length; v2++) {
      const R = i[v2];
      this._liquid.translatePagePadding(R);
      const { skeTables: E } = R;
      let b2 = null;
      for (const [x7, M7] of E.entries())
        x7.startsWith(A) && (b2 = M7);
      if (b2 == null) {
        this._liquid.restorePagePadding(R), this._liquid.translatePage(R, p, m2, I2);
        continue;
      }
      this._liquid.translateSave(), this._liquid.translate(0, b2.top);
      const { x: y, y: C } = this._liquid, { left: B } = b2;
      for (const x7 of b2.rows)
        if (x7.index >= h && x7.index <= g) {
          const M7 = oA(x7.cells, u, f2);
          if (M7 == null)
            continue;
          const [w, F2] = M7, P2 = {
            startX: y + w.left + B,
            startY: C + x7.top,
            endX: y + F2.left + F2.pageWidth + B,
            endY: C + x7.top + x7.height
          };
          o.push(pr2(P2));
        }
      this._liquid.translateRestore(), this._liquid.restorePagePadding(R), this._liquid.translatePage(R, p, m2, I2);
    }
    return {
      pointGroup: o,
      startRow: h,
      startColumn: u,
      endRow: g,
      endColumn: f2,
      tableId: A
    };
  }
  getNodePositionGroup(e, t8) {
    const o = [], r = this._docSkeleton.findCharIndexByPosition(e), s = this._docSkeleton.findCharIndexByPosition(t8);
    if (r == null || s == null)
      return;
    const i = r < s, a = this._getTableRectRangeInfo(e, t8);
    if (a == null)
      return;
    const { tableId: c, startRowIndex: d, startColumnIndex: l, endRowIndex: A, endColumnIndex: h } = a, u = this._docSkeleton.getViewModel().findTableNodeById(c);
    if (u == null)
      return;
    const g = u.children[0].children.length;
    if (l === 0 && h === g - 1) {
      const p = u.children[d].children[l], m2 = this._docSkeleton.findNodePositionByCharIndex(p.startIndex + 1), I2 = u.children[A].children[h], S = this._docSkeleton.findNodePositionByCharIndex(I2.endIndex - 2);
      if (m2 == null || S == null)
        return;
      o.push({
        anchor: i ? m2 : S,
        focus: i ? S : m2
      });
    } else
      for (let p = d; p <= A; p++) {
        const m2 = u.children[p], I2 = m2.children[l], S = m2.children[h], v2 = this._docSkeleton.findNodePositionByCharIndex(I2.startIndex + 1), R = this._docSkeleton.findNodePositionByCharIndex(S.endIndex - 2);
        if (v2 == null || R == null)
          return;
        o.push({
          anchor: i ? v2 : R,
          focus: i ? R : v2
        });
      }
    return o;
  }
  _getTableRectRangeInfo(e, t8) {
    const r = this._docSkeleton.getSkeletonData();
    if (r == null)
      return;
    const { pages: s } = r, { path: i } = e, { path: a } = t8, c = dz(r, i), d = dz(r, a);
    if (c == null || d == null)
      return;
    const l = c.segmentId, A = c.parent.index, h = c.parent.cells.indexOf(c), u = (d == null ? void 0 : d.parent).index, g = (d == null ? void 0 : d.parent).cells.indexOf(d), f2 = Math.min(A, u), p = Math.max(A, u), m2 = Math.min(h, g), I2 = Math.max(h, g);
    return {
      pages: s,
      tableId: l,
      startRowIndex: f2,
      startColumnIndex: m2,
      endRowIndex: p,
      endColumnIndex: I2
    };
  }
};
var rA = "__TestSelectionRange__";
var sA = "__TestSelectionAnchor__";
var pi2 = 6;
var Zo2 = 500;
var iA = 500;
var mr2 = 3;
function Jn2(n) {
  const e = n[0], t8 = e[0], o = e[2], { x: r, y: s } = t8, { x: i, y: a } = o;
  return {
    left: r,
    top: s,
    width: i - r,
    height: a - s
  };
}
function Es2(n) {
  return n.map((e) => {
    let t8 = 1 / 0, o = -1 / 0, r = 1 / 0, s = -1 / 0;
    return e.forEach((i) => {
      t8 = Math.min(i.x, t8), o = Math.max(i.x, o), s = Math.max(i.y, s), r = Math.min(i.y, r);
    }), {
      left: t8,
      right: o,
      top: r,
      bottom: s
    };
  });
}
var Xt2 = class {
  constructor(e, t8, o, r, s, i = jB, a = "", c = -1) {
    O(this, "rangeType", jg.TEXT);
    O(this, "_current", false);
    O(this, "_rangeShape");
    O(this, "_anchorShape");
    O(this, "_cursorList", []);
    O(this, "_anchorBlinkTimer", null);
    this._scene = e, this._document = t8, this._docSkeleton = o, this.anchorNodePosition = r, this.focusNodePosition = s, this.style = i, this._segmentId = a, this._segmentPage = c, this._anchorBlink(), this.refresh();
  }
  _anchorBlink() {
    setTimeout(() => {
      this._anchorShape && this._anchorShape.visible && this.deactivateStatic();
    }, Zo2), this._anchorBlinkTimer = setInterval(() => {
      this._anchorShape && this._anchorShape.visible && (this.activeStatic(), setTimeout(() => {
        this.deactivateStatic();
      }, Zo2));
    }, iA + Zo2);
  }
  // The start position of the range
  get startOffset() {
    var r;
    const { startOffset: e } = (r = fi2(this._cursorList)) != null ? r : {}, t8 = this._docSkeleton.getViewModel().getDataModel().getSelfOrHeaderFooterModel(this._segmentId).getBody();
    if (e == null || t8 == null)
      return e;
    const o = t8.dataStream.length - 2;
    return Math.min(o, e);
  }
  // The end position of the range
  get endOffset() {
    var r;
    const { endOffset: e } = (r = fi2(this._cursorList)) != null ? r : {}, t8 = this._docSkeleton.getViewModel().getDataModel().getSelfOrHeaderFooterModel(this._segmentId).getBody();
    if (e == null || t8 == null)
      return e;
    const o = t8.dataStream.length - 2;
    return Math.min(e, o);
  }
  get collapsed() {
    const { startOffset: e, endOffset: t8 } = this;
    return e != null && e === t8;
  }
  get startNodePosition() {
    if (this.anchorNodePosition == null)
      return null;
    if (this.focusNodePosition == null)
      return this.anchorNodePosition;
    const { start: e } = fr2(this.anchorNodePosition, this.focusNodePosition);
    return e;
  }
  get endNodePosition() {
    if (this.anchorNodePosition == null)
      return this.focusNodePosition;
    if (this.focusNodePosition == null)
      return null;
    const { end: e } = fr2(this.anchorNodePosition, this.focusNodePosition);
    return e;
  }
  get direction() {
    const { collapsed: e, anchorNodePosition: t8, focusNodePosition: o } = this;
    return e || t8 == null || o == null ? Bg.NONE : ms(t8, o) ? Bg.FORWARD : Bg.BACKWARD;
  }
  get segmentId() {
    return this._segmentId;
  }
  get segmentPage() {
    return this._segmentPage;
  }
  getAbsolutePosition() {
    const e = this.anchorNodePosition, t8 = this.focusNodePosition;
    if (this._isEmpty())
      return;
    const o = this._document.getOffsetConfig(), { docsLeft: r, docsTop: s } = o, i = new It2(o, this._docSkeleton);
    if (this._isCollapsed()) {
      const { contentBoxPointGroup: l, cursorList: A } = i.getRangePointData(e, e);
      if (this._setCursorList(A), l.length === 0)
        return;
      const h = Jn2(l);
      return {
        ...h,
        left: h.left + r,
        top: h.top + s
      };
    }
    const { borderBoxPointGroup: a, cursorList: c } = i.getRangePointData(e, t8);
    if (this._setCursorList(c), a.length === 0)
      return;
    const d = Jn2(a);
    return {
      ...d,
      left: d.left + r,
      top: d.top + s
    };
  }
  getAnchor() {
    return this._anchorShape;
  }
  activeStatic() {
    var e, t8;
    (t8 = this._anchorShape) == null || t8.setProps({
      stroke: ((e = this.style) == null ? void 0 : e.strokeActive) || M2(Ua.black, 1)
    });
  }
  deactivateStatic() {
    var e, t8;
    (t8 = this._anchorShape) == null || t8.setProps({
      stroke: ((e = this.style) == null ? void 0 : e.stroke) || M2(Ua.black, 0)
    });
  }
  isActive() {
    return this._current === true;
  }
  activate() {
    this._current = true;
  }
  deactivate() {
    this._current = false;
  }
  dispose() {
    var e, t8;
    (e = this._rangeShape) == null || e.dispose(), this._rangeShape = null, (t8 = this._anchorShape) == null || t8.dispose(), this._anchorShape = null, this._anchorBlinkTimer && (clearInterval(this._anchorBlinkTimer), this._anchorBlinkTimer = null);
  }
  isIntersection(e) {
    const { startOffset: t8, endOffset: o } = this, { startOffset: r, endOffset: s } = e;
    return t8 == null || o == null || r == null || s == null ? false : t8 <= s && o >= r;
  }
  // render cursor and selection.
  refresh() {
    var A, h;
    const { _document: e, _docSkeleton: t8 } = this, o = this.anchorNodePosition, r = this.focusNodePosition;
    if ((A = this._anchorShape) == null || A.hide(), (h = this._rangeShape) == null || h.hide(), this._isEmpty())
      return;
    const s = e.getOffsetConfig(), { docsLeft: i, docsTop: a } = s, c = new It2(s, t8);
    if (this._isCollapsed()) {
      const { contentBoxPointGroup: u, cursorList: g } = c.getRangePointData(o, o);
      if (this._setCursorList(g), u.length > 0) {
        const f2 = t8.findGlyphByPosition(o);
        this._createOrUpdateAnchor(u, i, a, f2);
      }
      return;
    }
    const { borderBoxPointGroup: d, cursorList: l } = c.getRangePointData(o, r);
    this._setCursorList(l), d.length > 0 && this._createOrUpdateRange(d, i, a);
  }
  _isEmpty() {
    return this.anchorNodePosition == null && this.focusNodePosition == null;
  }
  _isCollapsed() {
    const e = this.anchorNodePosition, t8 = this.focusNodePosition;
    if (e != null && t8 == null)
      return true;
    if (e == null || t8 == null)
      return false;
    const o = Object.keys(Kt2);
    for (const r of o) {
      const s = e[r], i = t8[r];
      if (s !== i)
        return false;
    }
    return e.isBack === t8.isBack;
  }
  _createOrUpdateRange(e, t8, o) {
    var i;
    if (this._rangeShape) {
      this._rangeShape.translate(t8, o), this._rangeShape.updatePointGroup(e), this._rangeShape.show();
      return;
    }
    const r = 0.3, s = new O3(rA + et(pi2), {
      pointsGroup: e,
      fill: ((i = this.style) == null ? void 0 : i.fill) || M2(Ua.black, r),
      left: t8,
      top: o,
      evented: false,
      debounceParentDirty: false
    });
    this._rangeShape = s, this._scene.addObject(s, mr2);
  }
  _createOrUpdateAnchor(e, t8, o, r) {
    var f2, p, m2;
    const s = Jn2(e), { left: i } = s;
    let { top: a, height: c } = s;
    const d = 14;
    c < d && (a -= d - c, c = d);
    const l = 12;
    let A = i + t8;
    const h = a + o, u = ((f2 = r == null ? void 0 : r.ts) == null ? void 0 : f2.it) === ie.TRUE;
    if (u && (A += c * Math.tan(l * Math.PI / 180) / 2), this._anchorShape) {
      this._anchorShape.transformByState({ left: A, top: h, height: c }), this._anchorShape.show(), u ? this._anchorShape.skew(-l, 0) : this._anchorShape.skew(0, 0);
      return;
    }
    const g = new I12(sA + et(pi2), {
      left: A,
      top: h,
      height: c,
      strokeWidth: ((p = this.style) == null ? void 0 : p.strokeWidth) || 1,
      stroke: ((m2 = this.style) == null ? void 0 : m2.strokeActive) || M2(Ua.black, 1),
      evented: false
    });
    u && g.skew(-l, 0), this._anchorShape = g, this._scene.addObject(g, mr2), this.activeStatic();
  }
  _setCursorList(e) {
    e.length !== 0 && (this._cursorList = e);
  }
};
var aA = "__DocTableRectRange__";
var cA = 6;
function Jo2(n, e, t8, o, r, s = jB, i = "", a = -1) {
  const c = e.getOffsetConfig(), l = new ka(c, t8).getNodePositionGroup(o, r);
  return (l != null ? l : []).map((A) => new Va(
    n,
    e,
    t8,
    A.anchor,
    A.focus,
    s,
    i,
    a
  ));
}
var Va = class {
  constructor(e, t8, o, r, s, i = jB, a = "", c = -1) {
    O(this, "rangeType", jg.RECT);
    O(this, "_rangeShape");
    O(this, "_current", false);
    O(this, "_startRow");
    O(this, "_startCol");
    O(this, "_endRow");
    O(this, "_endCol");
    O(this, "_tableId");
    this._scene = e, this._document = t8, this._docSkeleton = o, this.anchorNodePosition = r, this.focusNodePosition = s, this.style = i, this._segmentId = a, this._segmentPage = c, this.refresh();
  }
  get startOffset() {
    const { startNodePosition: e } = this;
    return this._docSkeleton.findCharIndexByPosition(e);
  }
  get endOffset() {
    const { endNodePosition: e } = this;
    return this._docSkeleton.findCharIndexByPosition(e);
  }
  get collapsed() {
    return false;
  }
  get startRow() {
    return this._startRow;
  }
  get startColumn() {
    return this._startCol;
  }
  get endRow() {
    return this._endRow;
  }
  get endColumn() {
    return this._endCol;
  }
  get tableId() {
    return this._tableId;
  }
  get segmentId() {
    return this._segmentId;
  }
  get segmentPage() {
    return this._segmentPage;
  }
  get spanEntireRow() {
    var i;
    const t8 = (i = this._docSkeleton.getViewModel().getSnapshot().tableSource) == null ? void 0 : i[this._tableId], { _startCol: o, _endCol: r } = this;
    if (t8 == null)
      throw new Error("Table is not found.");
    const { tableColumns: s } = t8;
    return o === 0 && r === s.length - 1;
  }
  get spanEntireColumn() {
    var i;
    const t8 = (i = this._docSkeleton.getViewModel().getSnapshot().tableSource) == null ? void 0 : i[this._tableId], { _startRow: o, _endRow: r } = this;
    if (t8 == null)
      throw new Error("Table is not found.");
    const { tableRows: s } = t8;
    return o === 0 && r === s.length - 1;
  }
  get spanEntireTable() {
    return this.spanEntireRow && this.spanEntireColumn;
  }
  get startNodePosition() {
    const { anchorNodePosition: e, focusNodePosition: t8 } = this;
    return Xo3(e, t8) ? e : t8;
  }
  get endNodePosition() {
    const { anchorNodePosition: e, focusNodePosition: t8 } = this;
    return Xo3(e, t8) ? t8 : e;
  }
  get direction() {
    const { anchorNodePosition: e, focusNodePosition: t8 } = this;
    return Xo3(e, t8) ? Bg.FORWARD : Bg.BACKWARD;
  }
  isActive() {
    return this._current === true;
  }
  activate() {
    this._current = true;
  }
  deactivate() {
    this._current = false;
  }
  dispose() {
    var e;
    (e = this._rangeShape) == null || e.dispose(), this._rangeShape = null;
  }
  isIntersection(e) {
    const { startRow: t8, startColumn: o, endRow: r, endColumn: s } = this, { startRow: i, startColumn: a, endRow: c, endColumn: d } = e, l = {
      left: o,
      top: t8,
      right: s,
      bottom: r
    }, A = {
      left: a,
      top: i,
      right: d,
      bottom: c
    };
    return En.hasIntersectionBetweenTwoRect(l, A);
  }
  refresh() {
    var p;
    (p = this._rangeShape) == null || p.hide();
    const { startNodePosition: e, endNodePosition: t8, _document: o, _docSkeleton: r } = this, s = o.getOffsetConfig(), { docsLeft: i, docsTop: a } = s, d = new ka(s, r).getRangePointData(e, t8);
    if (d == null)
      return;
    const { pointGroup: l = [], startRow: A, endRow: h, startColumn: u, endColumn: g, tableId: f2 } = d;
    (l == null ? void 0 : l.length) > 0 && this._createOrUpdateRange(l, i, a), this._updateTableInfo(A, h, u, g, f2);
  }
  _updateTableInfo(e, t8, o, r, s) {
    this._startRow = e, this._endRow = t8, this._startCol = o, this._endCol = r, this._tableId = s;
  }
  _createOrUpdateRange(e, t8, o) {
    var i;
    if (this._rangeShape) {
      this._rangeShape.translate(t8, o), this._rangeShape.updatePointGroup(e), this._rangeShape.show();
      return;
    }
    const r = 0.3, s = new O3(aA + et(cA), {
      pointsGroup: e,
      fill: ((i = this.style) == null ? void 0 : i.fill) || M2(Ua.black, r),
      left: t8,
      top: o,
      evented: false,
      debounceParentDirty: false
    });
    this._rangeShape = s, this._scene.addObject(s, mr2);
  }
};
function mi2(n, e, t8, o, r, s, i, a, c = true, d = true) {
  const l = r.findNodePositionByCharIndex(n, c, i, a), A = r.findNodePositionByCharIndex(e, d, i, a);
  if (!(l == null || A == null))
    return new Xt2(t8, o, r, l, A, s, i, a);
}
function lA(n, e, t8, o, r, s, i, a) {
  const c = r.findNodePositionByCharIndex(n, true, i, a), d = r.findNodePositionByCharIndex(e, true, i, a);
  if (!(c == null || d == null))
    return new Va(t8, o, r, c, d, s, i, a);
}
function dA(n, e, t8, o, r, s, i, a) {
  const c = r.findNodePositionByCharIndex(n, true, i, a), d = r.findNodePositionByCharIndex(e, true, i, a);
  if (!(c == null || d == null))
    return Er(
      c,
      d,
      t8,
      o,
      r,
      s,
      i,
      a
    );
}
function Er(n, e, t8, o, r, s, i, a) {
  const c = [], d = [], l = [t8, o, r, n, e, s, i, a];
  if (Ha(r, n, e)) {
    if (Fa(n, e))
      return c.push(new Xt2(...l)), {
        textRanges: c,
        rectRanges: d
      };
    {
      const S = Jo2(
        ...l
      );
      return d.push(...S), {
        textRanges: c,
        rectRanges: d
      };
    }
  }
  if (nA(n, e)) {
    const S = Jo2(
      ...l
    );
    return d.push(...S), {
      textRanges: c,
      rectRanges: d
    };
  }
  const A = r.getViewModel().getSelfOrHeaderFooterViewModel(i), h = r.findCharIndexByPosition(n), u = r.findCharIndexByPosition(e);
  if (h == null || u == null)
    return;
  const g = h <= u ? Bg.FORWARD : Bg.BACKWARD, f2 = Math.min(h, u), p = Math.max(h, u);
  let m2 = f2, I2 = p;
  for (const S of A.getChildren())
    for (const v2 of S.children) {
      const { startIndex: R, endIndex: E, children: b2 } = v2, y = S.children.indexOf(v2), C = S.children[y + 1], B = b2[0];
      let x7 = false;
      if (B) {
        const { startIndex: M7, endIndex: w, children: F2 } = B;
        let P2 = null, N = null;
        const ee3 = F2.find((U2) => U2.startIndex <= f2 && U2.endIndex >= f2), $ = F2.find((U2) => U2.startIndex <= p && U2.endIndex >= p);
        if (f2 > M7 && f2 < w)
          P2 = r.findNodePositionByCharIndex(ee3.startIndex + 2, true, i, a), N = r.findNodePositionByCharIndex(w - 4, true, i, a), m2 = w + 1;
        else if (p > M7 && p < w)
          P2 = r.findNodePositionByCharIndex(M7 + 3, true, i, a), N = r.findNodePositionByCharIndex($.endIndex - 3, true, i, a), I2 = M7 - 1, x7 = true;
        else if (M7 > f2 && w < p) {
          if (P2 = r.findNodePositionByCharIndex(M7 + 3, true, i, a), N = r.findNodePositionByCharIndex(w - 4, true, i, a), m2 <= M7 - 1) {
            const U2 = r.findNodePositionByCharIndex(m2, true, i, a), H3 = r.findNodePositionByCharIndex(M7 - 1, false, i, a), k7 = g === Bg.FORWARD ? U2 : H3, ne2 = g === Bg.FORWARD ? H3 : U2;
            c.push(new Xt2(t8, o, r, k7, ne2, s, i, a));
          }
          m2 = w + 1;
        }
        if (P2 && N) {
          const U2 = g === Bg.FORWARD ? P2 : N, H3 = g === Bg.FORWARD ? N : P2;
          d.push(...Jo2(
            t8,
            o,
            r,
            U2,
            H3,
            s,
            i,
            a
          ));
        }
      }
      if (I2 === E + 1 && !x7 && C && C.children.length && (I2 = E, x7 = true), I2 >= R && I2 <= E || x7) {
        const M7 = r.findNodePositionByCharIndex(m2, true, i, a), w = r.findNodePositionByCharIndex(I2, !x7, i, a), F2 = g === Bg.FORWARD ? M7 : w, P2 = g === Bg.FORWARD ? w : M7;
        if (d.length && J.diffValue(F2, P2))
          continue;
        c.push(new Xt2(t8, o, r, F2, P2, s, i, a));
      }
    }
  return {
    textRanges: c,
    rectRanges: d
  };
}
function AA(n) {
  const e = n == null ? void 0 : n.getCanvasElement();
  if (!e)
    return {
      left: 0,
      top: 0
    };
  const { top: t8, left: o } = wB(e);
  return {
    left: o,
    top: t8
  };
}
function Ei(n) {
  var c;
  const e = (c = n.parent) == null ? void 0 : c.parent, t8 = e == null ? void 0 : e.parent;
  if (e == null || t8 == null)
    return;
  const { paragraphIndex: o } = e, r = t8.lines.filter((d) => d.paragraphIndex === o);
  let s = -1, i = "", a = false;
  for (const d of r)
    for (const l of d.divides)
      for (const A of l.glyphGroup)
        a || (s += A.count), A === n && (a = true), i += A.count > 0 ? A.content : "";
  return {
    st: r[0].st,
    ed: o,
    content: i,
    nodeIndex: s
  };
}
function Ir(n) {
  const { startOffset: e, endOffset: t8, collapsed: o, rangeType: r, startNodePosition: s, endNodePosition: i, direction: a, segmentId: c, segmentPage: d } = n;
  return {
    startOffset: e,
    endOffset: t8,
    collapsed: o,
    rangeType: r,
    startNodePosition: s,
    endNodePosition: i,
    direction: a,
    segmentId: c,
    segmentPage: d,
    isActive: n.isActive()
  };
}
function uA(n) {
  const e = Ir(n), {
    startRow: t8,
    startColumn: o,
    endRow: r,
    endColumn: s,
    tableId: i,
    spanEntireRow: a,
    spanEntireColumn: c,
    spanEntireTable: d
  } = n;
  return {
    ...e,
    startRow: t8,
    startColumn: o,
    endRow: r,
    endColumn: s,
    tableId: i,
    spanEntireRow: a,
    spanEntireColumn: c,
    spanEntireTable: d
  };
}
var hA = Object.getOwnPropertyDescriptor;
var gA = (n, e, t8, o) => {
  for (var r = o > 1 ? void 0 : o ? hA(e, t8) : e, s = n.length - 1, i; s >= 0; s--)
    (i = n[s]) && (r = i(r) || r);
  return r;
};
var Vn2 = (n, e) => (t8, o) => e(t8, o, n);
var Re2 = class extends h1 {
  constructor(e, t8, o, r, s) {
    super();
    O(this, "_onInputBefore$", new Subject());
    O(this, "onInputBefore$", this._onInputBefore$.asObservable());
    O(this, "_onKeydown$", new Subject());
    O(this, "onKeydown$", this._onKeydown$.asObservable());
    O(this, "_onInput$", new Subject());
    O(this, "onInput$", this._onInput$.asObservable());
    O(this, "_onCompositionstart$", new BehaviorSubject(null));
    O(this, "onCompositionstart$", this._onCompositionstart$.asObservable());
    O(this, "_onCompositionupdate$", new BehaviorSubject(null));
    O(this, "onCompositionupdate$", this._onCompositionupdate$.asObservable());
    O(this, "_onCompositionend$", new BehaviorSubject(null));
    O(this, "onCompositionend$", this._onCompositionend$.asObservable());
    O(this, "_onSelectionStart$", new BehaviorSubject(null));
    O(this, "onSelectionStart$", this._onSelectionStart$.asObservable());
    O(this, "onChangeByEvent$", merge(
      this._onInput$,
      this._onKeydown$.pipe(filter((e8) => e8.event.keyCode === q1.BACKSPACE)),
      this._onCompositionend$
    ));
    O(this, "_onPaste$", new Subject());
    O(this, "onPaste$", this._onPaste$.asObservable());
    O(this, "_textSelectionInner$", new BehaviorSubject(null));
    O(this, "textSelectionInner$", this._textSelectionInner$.asObservable());
    O(this, "_onFocus$", new Subject());
    O(this, "onFocus$", this._onFocus$.asObservable());
    O(this, "_onBlur$", new Subject());
    O(this, "onBlur$", this._onBlur$.asObservable());
    O(this, "_onPointerDown$", new Subject());
    O(this, "onPointerDown$", this._onPointerDown$.asObservable());
    O(this, "_container");
    O(this, "_inputParent");
    O(this, "_input");
    O(this, "_scrollTimers", []);
    O(this, "_rangeList", []);
    O(this, "_rangeListCache", []);
    O(this, "_rectRangeList", []);
    O(this, "_rectRangeListCache", []);
    O(this, "_anchorNodePosition", null);
    O(this, "_focusNodePosition", null);
    O(this, "_currentSegmentId", "");
    O(this, "_currentSegmentPage", -1);
    O(this, "_selectionStyle", jB);
    O(this, "_onPointerEvent", false);
    O(this, "_viewPortObserverMap", /* @__PURE__ */ new Map());
    O(this, "_isIMEInputApply", false);
    O(this, "_scenePointerMoveSubs", []);
    O(this, "_scenePointerUpSubs", []);
    O(this, "_reserveRanges", false);
    this._context = e, this._layoutService = t8, this._logService = o, this._univerInstanceService = r, this._docSkeletonManagerService = s, this._initDOM(), this._registerContainer(), this._setSystemHighlightColorToStyle(), this._listenCurrentUnitChange();
  }
  get isOnPointerEvent() {
    return this._onPointerEvent;
  }
  get isFocusing() {
    return this._input === document.activeElement;
  }
  get canFocusing() {
    return this.isFocusing || document.activeElement === document.body || document.activeElement === null;
  }
  _listenCurrentUnitChange() {
    this._univerInstanceService.getCurrentTypeOfUnit$(we.UNIVER_DOC).pipe(takeUntil(this.dispose$)).subscribe((e) => {
      if (e == null)
        return;
      e.getUnitId() !== this._context.unitId && !this._reserveRanges && this.removeAllRanges();
    });
  }
  get activeViewPort() {
    return this._context.scene.getViewports()[0];
  }
  setSegment(e) {
    this._currentSegmentId = e;
  }
  getSegment() {
    return this._currentSegmentId;
  }
  setSegmentPage(e) {
    this._currentSegmentPage = e;
  }
  getSegmentPage() {
    return this._currentSegmentPage;
  }
  setReserveRangesStatus(e) {
    this._reserveRanges = e;
  }
  _setRangeStyle(e = jB) {
    this._selectionStyle = e;
  }
  // eslint-disable-next-line max-lines-per-function
  addDocRanges(e, t8 = true, o) {
    const {
      _currentSegmentId: r,
      _currentSegmentPage: s,
      _selectionStyle: i
    } = this, { scene: a, mainComponent: c } = this._context, d = c, l = this._docSkeletonManagerService.getSkeleton(), A = (h, u) => {
      const g = dA(
        h,
        u,
        a,
        d,
        l,
        i,
        r,
        s
      );
      if (g == null)
        return;
      const { textRanges: f2, rectRanges: p } = g;
      for (const m2 of f2)
        this._addTextRange(m2);
      this._addRectRanges(p);
    };
    for (const h of e) {
      const { startOffset: u, endOffset: g, rangeType: f2, startNodePosition: p, endNodePosition: m2 } = h;
      if (f2 === jg.RECT) {
        const I2 = lA(
          u,
          g,
          a,
          d,
          l,
          i,
          r,
          s
        );
        I2 && this._addRectRanges([I2]);
      } else if (f2 === jg.TEXT)
        try {
          let I2 = null;
          p && m2 ? I2 = mi2(
            p.isBack ? u : u - 1,
            m2.isBack ? g : g - 1,
            a,
            d,
            l,
            i,
            r,
            s,
            p.isBack,
            m2.isBack
          ) : I2 = mi2(
            u,
            g,
            a,
            d,
            l,
            i,
            r,
            s
          ), I2 && this._addTextRange(I2);
        } catch {
          A(u, g);
        }
      else
        A(u, g);
    }
    this._textSelectionInner$.next({
      textRanges: this._getAllTextRanges(),
      rectRanges: this._getAllRectRanges(),
      segmentId: r,
      segmentPage: s,
      style: i,
      isEditing: t8,
      options: o
    }), !(!e.length || (o == null ? void 0 : o.shouldFocus) === false) && this._updateInputPosition(o == null ? void 0 : o.forceFocus);
  }
  setCursorManually(e, t8) {
    const o = this._findNodeByCoord(e, t8, {
      strict: true,
      segmentId: this._currentSegmentId,
      segmentPage: this._currentSegmentPage
    }), r = this._getNodePosition(o);
    if (r == null) {
      this._removeAllRanges();
      return;
    }
    (o == null ? void 0 : o.node.streamType) === ct.PARAGRAPH && (r.isBack = true), this._createTextRangeByAnchorPosition(r), this._textSelectionInner$.next({
      textRanges: this._getAllTextRanges(),
      rectRanges: this._getAllRectRanges(),
      segmentId: this._currentSegmentId,
      segmentPage: this._currentSegmentPage,
      style: this._selectionStyle,
      isEditing: false
    });
  }
  // Sync canvas selection to dom selection.
  sync() {
    this._updateInputPosition();
  }
  /**
   * @deprecated
   */
  activate(e, t8, o = false) {
    this._container.style.left = `${e}px`, this._container.style.top = `${t8}px`, this._container.style.zIndex = "1000", (this.canFocusing || o) && this.focus();
  }
  hasFocus() {
    return document.activeElement === this._input;
  }
  focus() {
    this._input.focus();
  }
  blur() {
    this._input.blur();
  }
  // FIXME: for editor cell editor we don't need to blur the input element
  /**
   * @deprecated
   */
  deactivate() {
    this._container.style.left = "0px", this._container.style.top = "0px";
  }
  // Handler double click.
  __handleDblClick(e) {
    const { offsetX: t8, offsetY: o } = e, r = this._findNodeByCoord(t8, o, {
      strict: false,
      segmentId: this._currentSegmentId,
      segmentPage: this._currentSegmentPage
    });
    if (r == null || r.node == null)
      return;
    const s = Ei(r.node);
    if (s == null)
      return;
    const { content: i, st: a, nodeIndex: c } = s;
    if (c === -1 || Intl.Segmenter == null)
      return;
    const l = new Intl.Segmenter(void 0, { granularity: "word" }).segment(i);
    let A = Number.NEGATIVE_INFINITY, h = Number.NEGATIVE_INFINITY;
    for (const { segment: u, index: g, isWordLike: f2 } of l)
      if (g <= c && c < g + u.length && f2) {
        A = g + a, h = g + a + u.length;
        break;
      }
    if (Number.isFinite(A) && Number.isFinite(h)) {
      this.removeAllRanges();
      const u = [
        {
          startOffset: A,
          endOffset: h
        }
      ];
      this.addDocRanges(u, false, { forceFocus: true });
    }
  }
  __handleTripleClick(e) {
    const { offsetX: t8, offsetY: o } = e, r = this._findNodeByCoord(t8, o, {
      strict: false,
      segmentId: this._currentSegmentId,
      segmentPage: this._currentSegmentPage
    });
    if (r == null || r.node == null)
      return;
    const s = Ei(r.node);
    if (s == null)
      return;
    this.removeAllRanges();
    const { st: i, ed: a } = s, c = [
      {
        startOffset: i,
        endOffset: a
      }
    ];
    this.addDocRanges(c, false, { forceFocus: true });
  }
  // Handle pointer down.
  // eslint-disable-next-line max-lines-per-function, complexity
  __onPointDown(e) {
    var f2, p;
    const { scene: t8, mainComponent: o } = this._context, r = this._docSkeletonManagerService.getSkeleton(), { offsetX: s, offsetY: i } = e, a = this._findNodeByCoord(s, i, {
      strict: false,
      segmentId: this._currentSegmentId,
      segmentPage: this._currentSegmentPage
    }), c = this._getNodePosition(a);
    if (c == null || a == null) {
      this._removeAllRanges();
      return;
    }
    (a == null ? void 0 : a.node.streamType) === ct.PARAGRAPH && (c.isBack = true);
    const d = this._textSelectionInner$.value;
    if (a && e.button === 2 && d) {
      const m2 = r.findCharIndexByPosition(c);
      if (typeof m2 == "number" && d.textRanges.some((I2) => I2.startOffset <= m2 && I2.endOffset > m2) || typeof m2 == "number" && d.rectRanges.some((I2) => I2.startOffset <= m2 && I2.endOffset >= m2))
        return;
    }
    const { segmentId: l, segmentPage: A } = a;
    l && this._currentSegmentId && l !== this._currentSegmentId && this.setSegment(l), l && A !== this._currentSegmentPage && this.setSegmentPage(A), this._anchorNodePosition = c, e.shiftKey && this._getActiveRangeInstance() ? this._updateActiveRangePosition(c) : e.ctrlKey ? this._removeAllCollapsedTextRanges() : this._isEmpty() || this._removeAllRanges(), t8.disableObjectsEvent();
    const h = y0.create(t8);
    this._scrollTimers.push(h), h.startScroll(s, i), this._onSelectionStart$.next((f2 = this._getActiveRangeInstance()) == null ? void 0 : f2.startNodePosition), (p = t8.getTransformer()) == null || p.clearSelectedObjects();
    let u = s, g = i;
    this._onPointerEvent = true, this._scenePointerMoveSubs.push(t8.onPointerMove$.subscribeEvent((m2) => {
      const { offsetX: I2, offsetY: S } = m2;
      t8.setCursor(v1.TEXT), !(Math.sqrt((I2 - u) ** 2 + (S - g) ** 2) < 3) && (this._moving(I2, S), h.scrolling(I2, S, () => {
        this._moving(I2, S);
      }), u = I2, g = S);
    })), this._scenePointerUpSubs.push(t8.onPointerUp$.subscribeEvent(() => {
      if ([...this._scenePointerMoveSubs, ...this._scenePointerUpSubs].forEach((I2) => {
        I2.unsubscribe();
      }), this._onPointerEvent = false, t8.enableObjectsEvent(), this._anchorNodePosition && !this._focusNodePosition) {
        if (e.ctrlKey) {
          this._disposeScrollTimers();
          return;
        }
        const I2 = new Xt2(t8, o, r, this._anchorNodePosition, void 0, this._selectionStyle, this._currentSegmentId, this._currentSegmentPage);
        this._addTextRange(I2);
      } else if (this._anchorNodePosition && this._focusNodePosition) {
        for (const I2 of this._rangeListCache)
          e.ctrlKey ? I2.collapsed ? I2.dispose() : this._addTextRange(I2) : this._addTextRange(I2);
        this._addRectRanges(this._rectRangeListCache), this._rangeListCache = [], this._rectRangeListCache = [];
      }
      this._anchorNodePosition = null, this._focusNodePosition = null;
      const m2 = {
        textRanges: this._getAllTextRanges(),
        rectRanges: this._getAllRectRanges(),
        segmentId: this._currentSegmentId,
        segmentPage: this._currentSegmentPage,
        style: this._selectionStyle,
        isEditing: false
      };
      this._textSelectionInner$.next(m2), this._disposeScrollTimers(), this._updateInputPosition(true);
    }));
  }
  removeAllRanges() {
    this._removeAllRanges(), this.deactivate();
  }
  getActiveTextRange() {
    return this._getActiveRangeInstance();
  }
  _disposeScrollTimers() {
    this._scrollTimers.forEach((e) => {
      e == null || e.dispose();
    }), this._scrollTimers = [];
  }
  _setSystemHighlightColorToStyle() {
    const { r: e, g: t8, b: o, a: r } = kB(), s = {
      strokeWidth: 1,
      stroke: "rgba(0, 0, 0, 0)",
      strokeActive: "rgba(0, 0, 0, 1)",
      fill: `rgba(${e}, ${t8}, ${o}, ${r != null ? r : 0.3})`
    };
    this._setRangeStyle(s);
  }
  _getAllTextRanges() {
    return this._rangeList.map(Ir);
  }
  _getAllRectRanges() {
    return this._rectRangeList.map(uA);
  }
  getAllTextRanges() {
    return this._getAllTextRanges();
  }
  getAllRectRanges() {
    return this._getAllRectRanges();
  }
  _getActiveRange() {
    const e = this._rangeList.find((r) => r.isActive());
    if (e == null)
      return null;
    const { startOffset: t8, endOffset: o } = e;
    return t8 == null || o == null ? null : Ir(e);
  }
  _getActiveRangeInstance() {
    return this._rangeList.find((e) => e.isActive());
  }
  dispose() {
    super.dispose(), this._detachEvent(), this._removeAllRanges(), this._container.remove();
  }
  _initDOM() {
    const { unitId: e } = this._context, t8 = document.createElement("div");
    t8.style.position = "fixed", t8.style.left = "0px", t8.style.top = "0px", t8.id = `univer-doc-selection-container-${e}`;
    const o = document.createElement("div"), r = document.createElement("div");
    o.appendChild(r), t8.appendChild(o), this._container = t8, this._inputParent = o, this._input = r, this._initInput(), this._initInputEvents(), document.body.appendChild(t8);
  }
  _registerContainer() {
    this.disposeWithMe(
      // the content editable div should be regarded as part of the applications container
      this._layoutService.registerContainerElement(this._container)
    );
  }
  _initInput() {
    this._inputParent.style.cssText = `
            position:absolute;
            height:1px;
            width:1px;
            overflow: hidden;
        `, this._input.contentEditable = "true", this._input.dataset.uComp = "editor", this._input.id = `__editor_${this._context.unitId}`, this._input.style.cssText = `
            position: absolute;
            overflow: hidden;
            opacity: 1;
            background: #000;
            color: transparent;
            outline: none;
            z-index: -2;
            caret-color: transparent;
            white-space: pre-wrap;
            user-select: text;
        `;
  }
  _getNodePosition(e) {
    if (e == null)
      return;
    const { node: t8, ratioX: o, segmentPage: r } = e, i = this._docSkeletonManagerService.getSkeleton().findPositionByGlyph(t8, r);
    if (i == null)
      return;
    let c = o < 0.5;
    return t8.glyphType === e2.LIST && (c = true), {
      ...i,
      isBack: c
    };
  }
  _interactTextRanges(e) {
    const t8 = [];
    for (const o of this._rangeList) {
      if (e.some((r) => r.isIntersection(o))) {
        o.dispose();
        continue;
      }
      t8.push(o);
    }
    this._rangeList = t8;
  }
  _interactRectRanges(e) {
    const t8 = [];
    for (const o of this._rectRangeList) {
      if (e.some((r) => r.isIntersection(o))) {
        o.dispose();
        continue;
      }
      t8.push(o);
    }
    this._rectRangeList = t8;
  }
  _removeAllRanges() {
    this._removeAllTextRanges(), this._removeAllRectRanges();
  }
  _removeAllCacheRanges() {
    this._rangeListCache.forEach((e) => {
      e.dispose();
    }), this._rectRangeListCache.forEach((e) => {
      e.dispose();
    }), this._rangeListCache = [], this._rectRangeListCache = [];
  }
  _removeAllTextRanges() {
    this._rangeList.forEach((e) => {
      e.dispose();
    }), this._rangeList = [];
  }
  _removeAllRectRanges() {
    this._rectRangeList.forEach((e) => {
      e.dispose();
    }), this._rectRangeList = [];
  }
  _removeAllCollapsedTextRanges() {
    for (const e of this._rangeList)
      e.collapsed && e.dispose();
  }
  _deactivateAllTextRanges() {
    this._rangeList.forEach((e) => {
      e.deactivate();
    });
  }
  _deactivateAllRectRanges() {
    this._rectRangeList.forEach((e) => {
      e.deactivate();
    });
  }
  _addTextRangesToCache(e) {
    this._rangeListCache.push(...e);
  }
  _addTextRange(e) {
    this._deactivateAllTextRanges(), e.activate(), this._rangeList.push(e);
  }
  _addRectRangesToCache(e) {
    this._rectRangeListCache.push(...e);
  }
  _addRectRanges(e) {
    e.length !== 0 && (this._deactivateAllRectRanges(), e[e.length - 1].activate(), this._rectRangeList.push(...e));
  }
  _createTextRangeByAnchorPosition(e) {
    this._removeAllRanges();
    const { scene: t8, mainComponent: o } = this._context, r = this._docSkeletonManagerService.getSkeleton(), s = new Xt2(t8, o, r, e, void 0, this._selectionStyle, this._currentSegmentId, this._currentSegmentPage);
    this._addTextRange(s);
  }
  _updateActiveRangePosition(e) {
    const t8 = this._getActiveRangeInstance();
    if (t8 == null || t8.anchorNodePosition == null) {
      this._logService.error(
        "[DocSelectionRenderService] _updateActiveRangeFocusPosition: active range has no anchor"
      );
      return;
    }
    this._removeAllRanges(), this._anchorNodePosition = t8.anchorNodePosition, this._focusNodePosition = e;
    const { scene: o, mainComponent: r } = this._context, s = this._docSkeletonManagerService.getSkeleton(), { _anchorNodePosition: i, _focusNodePosition: a, _selectionStyle: c, _currentSegmentId: d, _currentSegmentPage: l } = this;
    if (i == null || a == null || r == null)
      return;
    const A = Er(
      i,
      a,
      o,
      r,
      s,
      c,
      d,
      l
    );
    if (A == null)
      return;
    const { textRanges: h, rectRanges: u } = A;
    this._addTextRangesToCache(h), this._addRectRangesToCache(u), this.deactivate();
  }
  _isEmpty() {
    return this._rangeList.length === 0 && this._rectRangeList.length === 0;
  }
  _getCanvasOffset() {
    var t8;
    const e = (t8 = this._context.scene) == null ? void 0 : t8.getEngine();
    return AA(e);
  }
  _updateInputPosition(e = false) {
    const t8 = this._getActiveRangeInstance(), o = t8 == null ? void 0 : t8.getAnchor();
    if (!o || o && !o.visible || this.activeViewPort == null) {
      this.focus();
      return;
    }
    const { left: r, top: s } = o, i = this.activeViewPort.getAbsoluteVector(U.FromArray([r, s])), { x: a, y: c } = i;
    let { left: d, top: l } = this._getCanvasOffset();
    d += a, l += c, this.activate(d, l, e);
  }
  _moving(e, t8) {
    var m2, I2;
    const { _currentSegmentId: o, _currentSegmentPage: r } = this, s = this._findNodeByCoord(e, t8, {
      strict: true,
      segmentId: o,
      segmentPage: r
    }), i = this._getNodePosition(s);
    if (i == null || s == null)
      return;
    const a = s == null ? void 0 : s.node.parent, c = a == null ? void 0 : a.glyphGroup[a.glyphGroup.indexOf(s.node) + 1];
    (s == null ? void 0 : s.node.streamType) === ct.PARAGRAPH && (c == null ? void 0 : c.streamType) === ct.SECTION_BREAK && (i.isBack = true), this._focusNodePosition = i, this._removeAllCacheRanges();
    const { _anchorNodePosition: d, _selectionStyle: l } = this, { scene: A, mainComponent: h } = this._context, u = this._docSkeletonManagerService.getSkeleton();
    if (d == null || h == null)
      return;
    const g = Er(
      d,
      i,
      A,
      h,
      u,
      l,
      o,
      r
    );
    if (g == null)
      return;
    const { textRanges: f2, rectRanges: p } = g;
    this._rangeList.length > 0 && f2.length > 0 && this._interactTextRanges(f2), this._rectRangeList.length > 0 && p.length > 0 && this._interactRectRanges(p), this._addTextRangesToCache(f2), this._addRectRangesToCache(p), this.deactivate(), (I2 = (m2 = this._context.scene) == null ? void 0 : m2.getEngine()) == null || I2.setCapture();
  }
  __attachScrollEvent() {
    const e = this.activeViewPort;
    if (!e)
      return;
    const { unitId: t8 } = this._context;
    if (this._viewPortObserverMap.has(t8))
      return;
    const o = e.onScrollAfter$.subscribeEvent((s) => {
      if (!s.viewport)
        return;
      const a = this._getActiveRangeInstance();
      a == null || a.activeStatic();
    }), r = e.onScrollEnd$.subscribeEvent((s) => {
      const i = s.viewport;
      if (!i)
        return;
      const a = i.getBounding(), c = this._getActiveRangeInstance(), d = c == null ? void 0 : c.getAnchor();
      if (!(!d || d && !d.visible)) {
        if (a) {
          const { left: l, top: A, right: h, bottom: u } = a.viewBound;
          if (d.left < l || d.left > h || d.top < A || d.top > u) {
            c == null || c.deactivateStatic();
            return;
          }
        }
        this._updateInputPosition();
      }
    });
    this._viewPortObserverMap.set(t8, {
      scrollBefore: o,
      scrollStop: r
    });
  }
  // FIXME: listeners here are not correctly disposed
  // eslint-disable-next-line max-lines-per-function
  _initInputEvents() {
    this.disposeWithMe(
      fromEvent(this._input, "keydown").subscribe((e) => {
        this._isIMEInputApply || this._eventHandle(e, (t8) => {
          this._onKeydown$.next(t8);
        });
      })
    ), this.disposeWithMe(
      fromEvent(this._input, "input").subscribe((e) => {
        if (!(e.inputType === "historyUndo" || e.inputType === "historyRedo")) {
          if (this._rectRangeList.length > 0)
            return e.stopPropagation(), e.preventDefault();
          this._isIMEInputApply || this._eventHandle(e, (t8) => {
            this._onInputBefore$.next(t8), this._onInput$.next(t8);
          });
        }
      })
    ), this.disposeWithMe(
      fromEvent(this._input, "compositionstart").subscribe((e) => {
        if (this._rectRangeList.length > 0)
          return e.stopPropagation(), e.preventDefault();
        this._isIMEInputApply = true, this._eventHandle(e, (t8) => {
          this._onCompositionstart$.next(t8);
        });
      })
    ), this.disposeWithMe(
      fromEvent(this._input, "compositionend").subscribe((e) => {
        this._isIMEInputApply = false, this._eventHandle(e, (t8) => {
          this._onCompositionend$.next(t8);
        });
      })
    ), this.disposeWithMe(
      fromEvent(this._input, "compositionupdate").subscribe((e) => {
        this._eventHandle(e, (t8) => {
          this._onInputBefore$.next(t8), this._onCompositionupdate$.next(t8);
        });
      })
    ), this.disposeWithMe(
      fromEvent(this._input, "paste").subscribe((e) => {
        this._eventHandle(e, (t8) => {
          this._onPaste$.next(t8);
        });
      })
    ), this.disposeWithMe(
      fromEvent(this._input, "focus").subscribe((e) => {
        this._eventHandle(e, (t8) => {
          this._onFocus$.next(t8);
        });
      })
    ), this.disposeWithMe(
      fromEvent(this._input, "blur").subscribe((e) => {
        this._eventHandle(e, (t8) => {
          this._onBlur$.next(t8);
        });
      })
    );
  }
  _eventHandle(e, t8) {
    const o = this._input.textContent || "";
    this._input.innerHTML = "";
    const r = this._getActiveRange(), s = this._getAllTextRanges();
    t8({
      event: e,
      content: o,
      activeRange: r,
      rangeList: s
    });
  }
  _getTransformCoordForDocumentOffset(e, t8) {
    const o = this._context.mainComponent, { documentTransform: r } = o.getOffsetConfig();
    if (this.activeViewPort == null || r == null)
      return;
    const s = this.activeViewPort.transformVector2SceneCoord(U.FromArray([e, t8]));
    if (s)
      return r.clone().invert().applyPoint(s);
  }
  _findNodeByCoord(e, t8, o) {
    const r = this._getTransformCoordForDocumentOffset(e, t8);
    if (r == null)
      return;
    const s = this._context.mainComponent, i = this._docSkeletonManagerService.getSkeleton(), {
      pageLayoutType: a = Q2.VERTICAL,
      pageMarginLeft: c,
      pageMarginTop: d
    } = s.getOffsetConfig();
    return i.findNodeByCoord(
      r,
      a,
      c,
      d,
      o
    );
  }
  _detachEvent() {
    this._onInputBefore$.complete(), this._onKeydown$.complete(), this._onInput$.complete(), this._onCompositionstart$.complete(), this._onCompositionupdate$.complete(), this._onCompositionend$.complete(), this._onSelectionStart$.complete(), this._textSelectionInner$.complete(), this._onPaste$.complete(), this._onFocus$.complete(), this._onBlur$.complete(), this._onPointerDown$.complete();
  }
};
Re2 = gA([
  Vn2(1, U1),
  Vn2(2, yt),
  Vn2(3, vr),
  Vn2(4, Inject(D))
], Re2);
var ko2 = {
  id: "doc.command.switch-mode",
  type: Ms.COMMAND,
  // eslint-disable-next-line max-lines-per-function, complexity
  handler: (n) => {
    var I2, S, v2, R, E;
    const e = n.get(Ls), t8 = n.get(ME), o = n.get(m), s = n.get(vr).getCurrentUniverDocInstance();
    if (s == null)
      return false;
    const i = s.getUnitId(), a = (I2 = t8.getRenderById(i)) == null ? void 0 : I2.with(D).getSkeleton(), c = (S = t8.getRenderById(i)) == null ? void 0 : S.with(Re2);
    if (a == null || c == null)
      return false;
    const d = c == null ? void 0 : c.getSegment(), l = c == null ? void 0 : c.getSegmentPage(), A = s.getSnapshot().documentStyle.documentFlavor, h = o.getDocRanges(), u = {
      id: M.id,
      params: {
        unitId: i,
        actions: [],
        textRanges: A === uu.TRADITIONAL && d ? [] : h
      }
    }, g = Qt.getInstance(), f2 = [];
    let p;
    if (A === void 0 ? p = g.insertOp(["documentStyle", "documentFlavor"], uu.MODERN) : A === uu.MODERN ? p = g.replaceOp(["documentStyle", "documentFlavor"], A, uu.TRADITIONAL) : p = g.replaceOp(["documentStyle", "documentFlavor"], A, uu.MODERN), p)
      f2.push(p);
    else
      return false;
    if (A !== uu.MODERN) {
      const b2 = s.getSnapshot(), { drawings: y = {}, body: C } = b2, B = (v2 = C == null ? void 0 : C.customBlocks) != null ? v2 : [];
      for (const x7 in y) {
        const M7 = y[x7], w = B.find((he3) => he3.blockId === x7);
        if (w == null)
          continue;
        const F2 = M7.docTransform.positionV, { relativeFrom: P2, posOffset: N } = F2;
        if (P2 === Xm.PARAGRAPH)
          continue;
        const { startIndex: ee3 } = w, $ = a.findNodeByCharIndex(ee3, d, l), U2 = (R = $ == null ? void 0 : $.parent) == null ? void 0 : R.parent, H3 = U2 == null ? void 0 : U2.parent, k7 = H3 == null ? void 0 : H3.lines.find((he3) => he3.paragraphIndex === (U2 == null ? void 0 : U2.paragraphIndex) && he3.paragraphStart), ne2 = (E = H3 == null ? void 0 : H3.parent) == null ? void 0 : E.parent;
        if ($ == null || U2 == null || k7 == null || H3 == null || ne2 == null)
          continue;
        let ie5 = 0;
        P2 === Xm.LINE ? ie5 -= U2.top : P2 === Xm.PAGE && (ie5 += ne2.marginTop), ie5 += k7.top;
        const ae2 = {
          ...F2,
          relativeFrom: Xm.PARAGRAPH,
          posOffset: (N != null ? N : 0) - ie5
        }, oe2 = g.replaceOp(["drawings", x7, "docTransform", "positionV"], F2, ae2);
        oe2 && f2.push(oe2);
      }
    }
    return u.params.actions = f2.reduce((b2, y) => Qt.compose(b2, y), null), !!e.syncExecuteCommand(u.id, u.params);
  }
};
var fA = "doc.command.create-table";
var Wa = {
  id: fA,
  type: Ms.COMMAND,
  // eslint-disable-next-line max-lines-per-function
  handler: async (n, e) => {
    var ae2, oe2, he3, we4, Ze;
    const { rowCount: t8, colCount: o } = e, r = n.get(m), s = n.get(vr), i = n.get(Ls), a = n.get(at2), c = r.getActiveTextRange();
    if (c == null)
      return false;
    const { segmentId: d, segmentPage: l } = c, A = s.getCurrentUniverDocInstance(), h = A == null ? void 0 : A.getSelfOrHeaderFooterModel(d).getBody();
    if (A == null || h == null)
      return false;
    const u = A.getUnitId(), g = Ke2(n, u), f2 = g == null ? void 0 : g.getSkeleton();
    if (f2 == null)
      return false;
    const { startOffset: p } = c, I2 = ((ae2 = h.paragraphs) != null ? ae2 : []).find((At2) => At2.startIndex >= p), S = f2.findNodeByCharIndex(p, d, l);
    if (S == null)
      return false;
    const v2 = new Ne(), R = Qt.getInstance(), E = [], b2 = p + 4, y = [{
      startOffset: b2,
      endOffset: b2,
      collapsed: true
    }], C = {
      id: M.id,
      params: {
        unitId: u,
        actions: [],
        textRanges: y
      }
    };
    p > 0 && v2.push({
      t: Z.RETAIN,
      len: p
    }), v2.push({
      t: Z.INSERT,
      body: {
        dataStream: ct.PARAGRAPH,
        paragraphs: pa(ct.PARAGRAPH, I2)
      },
      len: 1
    });
    const B = a.getDefaultStyle(), x7 = a.getStyleCache(), M7 = Bo2(
      h,
      p,
      B,
      x7
    ), { dataStream: w, paragraphs: F2, sectionBreaks: P2 } = pd2(t8, o), N = (Ze = (we4 = (he3 = (oe2 = S.parent) == null ? void 0 : oe2.parent) == null ? void 0 : he3.parent) == null ? void 0 : we4.parent) == null ? void 0 : Ze.parent;
    if (N == null)
      return false;
    const { pageWidth: ee3, marginLeft: $, marginRight: U2 } = N, H3 = ma(t8, o, ee3 - $ - U2);
    v2.push({
      t: Z.INSERT,
      body: {
        dataStream: w,
        paragraphs: F2,
        sectionBreaks: P2,
        textRuns: [{
          ...M7,
          st: 0,
          ed: w.length
        }],
        tables: [
          {
            startIndex: 0,
            endIndex: w.length,
            tableId: H3.tableId
          }
        ]
      },
      len: w.length
    });
    const k7 = Ae2(A, d);
    E.push(R.editOp(v2.serialize(), k7));
    const ne2 = R.insertOp(["tableSource", H3.tableId], H3);
    return E.push(ne2), C.params.actions = E.reduce((At2, Je4) => Qt.compose(At2, Je4), null), !!i.syncExecuteCommand(C.id, C.params);
  }
};
var Is = {
  id: "doc.table.delete-rows",
  type: Ms.COMMAND,
  // eslint-disable-next-line max-lines-per-function
  handler: async (n) => {
    const e = n.get(m), t8 = n.get(vr), o = n.get(Ls), r = e.getRectRanges(), s = e.getActiveTextRange(), i = Ln3(s, r);
    if (i == null)
      return false;
    const { segmentId: a } = i, c = t8.getCurrentUniverDocInstance(), d = c == null ? void 0 : c.getSelfOrHeaderFooterModel(a).getBody();
    if (c == null || d == null)
      return false;
    const l = Ke2(n, c.getUnitId());
    if (l == null)
      return false;
    const A = l.getViewModel(), h = c == null ? void 0 : c.getUnitId(), u = new Ne(), g = Qt.getInstance(), f2 = Ea(i, A);
    if (f2 == null)
      return false;
    const { offset: p, rowIndexes: m2, len: I2, tableId: S, cursor: v2, selectWholeTable: R } = f2;
    if (R)
      return o.executeCommand(Hn2.id);
    const E = [], b2 = [{
      startOffset: v2,
      endOffset: v2,
      collapsed: true
    }], y = {
      id: M.id,
      params: {
        unitId: h,
        actions: [],
        textRanges: b2
      }
    };
    p > 0 && u.push({
      t: Z.RETAIN,
      len: p
    }), u.push({
      t: Z.DELETE,
      len: I2
    });
    const C = Ae2(c, a);
    E.push(g.editOp(u.serialize(), C));
    for (const x7 of m2.reverse()) {
      const M7 = g.removeOp(["tableSource", S, "tableRows", x7]);
      E.push(M7);
    }
    return y.params.actions = E.reduce((x7, M7) => Qt.compose(x7, M7), null), !!o.syncExecuteCommand(y.id, y.params);
  }
};
var Ss = {
  id: "doc.table.delete-columns",
  type: Ms.COMMAND,
  // eslint-disable-next-line max-lines-per-function
  handler: async (n) => {
    const e = n.get(m), t8 = n.get(vr), o = n.get(Ls), r = e.getRectRanges(), s = e.getActiveTextRange(), i = Ln3(s, r);
    if (i == null)
      return false;
    const { segmentId: a } = i, c = t8.getCurrentUniverDocInstance(), d = c == null ? void 0 : c.getSelfOrHeaderFooterModel(a).getBody();
    if (c == null || d == null)
      return false;
    const l = Ke2(n, c.getUnitId());
    if (l == null)
      return false;
    const A = l.getViewModel(), h = c == null ? void 0 : c.getUnitId(), u = new Ne(), g = Qt.getInstance(), f2 = Cd2(i, A);
    if (f2 == null)
      return false;
    const { offsets: p, columnIndexes: m2, tableId: I2, cursor: S, rowCount: v2, selectWholeTable: R } = f2;
    if (R)
      return o.executeCommand(Hn2.id);
    const E = [], b2 = [{
      startOffset: S,
      endOffset: S,
      collapsed: true
    }], y = {
      id: M.id,
      params: {
        unitId: h,
        actions: [],
        textRanges: b2
      }
    };
    for (const x7 of p) {
      const { retain: M7, delete: w } = x7;
      M7 > 0 && u.push({
        t: Z.RETAIN,
        len: M7
      }), u.push({
        t: Z.DELETE,
        len: w
      });
    }
    const C = Ae2(c, a);
    E.push(g.editOp(u.serialize(), C)), m2.reverse();
    for (let x7 = 0; x7 < v2; x7++)
      for (const M7 of m2) {
        const w = g.removeOp(["tableSource", I2, "tableRows", x7, "tableCells", M7]);
        E.push(w);
      }
    for (const x7 of m2) {
      const M7 = g.removeOp(["tableSource", I2, "tableColumns", x7]);
      E.push(M7);
    }
    return y.params.actions = E.reduce((x7, M7) => Qt.compose(x7, M7), null), !!o.syncExecuteCommand(y.id, y.params);
  }
};
var Hn2 = {
  id: "doc.table.delete-table",
  type: Ms.COMMAND,
  // eslint-disable-next-line max-lines-per-function
  handler: async (n) => {
    const e = n.get(m), t8 = n.get(vr), o = n.get(Ls), r = e.getRectRanges(), s = e.getActiveTextRange(), i = Ln3(s, r);
    if (i == null)
      return false;
    const { segmentId: a } = i, c = t8.getCurrentUniverDocInstance(), d = c == null ? void 0 : c.getSelfOrHeaderFooterModel(a).getBody();
    if (c == null || d == null)
      return false;
    const l = Ke2(n, c.getUnitId());
    if (l == null)
      return false;
    const A = l.getViewModel(), h = c == null ? void 0 : c.getUnitId(), u = new Ne(), g = Qt.getInstance(), f2 = Ia(i, A);
    if (f2 == null)
      return false;
    const { offset: p, len: m2, tableId: I2, cursor: S } = f2, v2 = [], R = [{
      startOffset: S,
      endOffset: S,
      collapsed: true
    }], E = {
      id: M.id,
      params: {
        unitId: h,
        actions: [],
        textRanges: R
      }
    };
    p > 0 && u.push({
      t: Z.RETAIN,
      len: p
    }), u.push({
      t: Z.DELETE,
      len: m2
    });
    const b2 = Ae2(c, a);
    v2.push(g.editOp(u.serialize(), b2));
    const y = g.removeOp(["tableSource", I2]);
    return v2.push(y), E.params.actions = v2.reduce((B, x7) => Qt.compose(B, x7), null), !!o.syncExecuteCommand(E.id, E.params);
  }
};
var vs = "doc.command.table-insert-row";
var Cs = "doc.command.table-insert-column";
var pA = "doc.command.table-insert-row-above";
var mA = "doc.command.table-insert-row-bellow";
var EA = "doc.command.table-insert-column-left";
var IA = "doc.command.table-insert-column-right";
var Rs2 = {
  id: pA,
  type: Ms.COMMAND,
  handler: async (n) => n.get(Ls).executeCommand(vs, { position: _o2.ABOVE })
};
var bs2 = {
  id: mA,
  type: Ms.COMMAND,
  handler: async (n) => n.get(Ls).executeCommand(vs, { position: _o2.BELLOW })
};
var ys = {
  id: EA,
  type: Ms.COMMAND,
  handler: async (n) => n.get(Ls).executeCommand(Cs, { position: Yr2.LEFT })
};
var xs = {
  id: IA,
  type: Ms.COMMAND,
  handler: async (n) => n.get(Ls).executeCommand(Cs, { position: Yr2.RIGHT })
};
var ja = {
  id: vs,
  type: Ms.COMMAND,
  // eslint-disable-next-line max-lines-per-function
  handler: async (n, e) => {
    const { position: t8 } = e, o = n.get(m), r = n.get(vr), s = n.get(Ls), i = o.getRectRanges(), a = o.getActiveTextRange(), c = Ln3(a, i);
    if (c == null)
      return false;
    const { segmentId: d } = c, l = r.getCurrentUnitForType(we.UNIVER_DOC), A = l == null ? void 0 : l.getSelfOrHeaderFooterModel(d).getBody();
    if (l == null || A == null)
      return false;
    const h = Ke2(n, l.getUnitId());
    if (h == null)
      return false;
    const u = h.getViewModel(), g = l == null ? void 0 : l.getUnitId(), f2 = new Ne(), p = Qt.getInstance(), m2 = Id(c, t8, u);
    if (m2 == null)
      return false;
    const { offset: I2, colCount: S, tableId: v2, insertRowIndex: R } = m2, E = [], b2 = I2 + 2, y = [{
      startOffset: b2,
      endOffset: b2,
      collapsed: true
    }], C = {
      id: M.id,
      params: {
        unitId: g,
        actions: [],
        textRanges: y
      }
    };
    I2 > 0 && f2.push({
      t: Z.RETAIN,
      len: I2
    });
    const B = md2(S);
    f2.push({
      t: Z.INSERT,
      body: B,
      len: B.dataStream.length
    });
    const x7 = Ae2(l, d);
    E.push(p.editOp(f2.serialize(), x7));
    const M7 = qr3(S), w = p.insertOp(["tableSource", v2, "tableRows", R], M7);
    return E.push(w), C.params.actions = E.reduce((P2, N) => Qt.compose(P2, N), null), !!s.syncExecuteCommand(C.id, C.params);
  }
};
var SA = {
  id: Cs,
  type: Ms.COMMAND,
  // eslint-disable-next-line max-lines-per-function
  handler: async (n, e) => {
    var ne2, ie5, ae2;
    const { position: t8 } = e, o = n.get(m), r = n.get(vr), s = n.get(Ls), i = o.getRectRanges(), a = o.getActiveTextRange(), c = Ln3(a, i);
    if (c == null)
      return false;
    const { segmentId: d } = c, l = r.getCurrentUniverDocInstance(), A = l == null ? void 0 : l.getSelfOrHeaderFooterModel(d).getBody();
    if (l == null || A == null)
      return false;
    const h = Ke2(n, l.getUnitId());
    if (h == null)
      return false;
    const u = h.getViewModel(), g = l == null ? void 0 : l.getUnitId(), f2 = new Ne(), p = Qt.getInstance(), m2 = Sd(c, t8, u);
    if (m2 == null)
      return false;
    const { offsets: I2, columnIndex: S, tableId: v2, rowCount: R } = m2, E = [], b2 = I2[0] + 1, y = [{
      startOffset: b2,
      endOffset: b2,
      collapsed: true
    }], C = {
      id: M.id,
      params: {
        unitId: g,
        actions: [],
        textRanges: y
      }
    };
    for (const oe2 of I2) {
      f2.push({
        t: Z.RETAIN,
        len: oe2
      });
      const he3 = Ed();
      f2.push({
        t: Z.INSERT,
        body: he3,
        len: he3.dataStream.length
      });
    }
    const B = Ae2(l, d);
    E.push(p.editOp(f2.serialize(), B));
    for (let oe2 = 0; oe2 < R; oe2++) {
      const he3 = Kr(), we4 = p.insertOp(["tableSource", v2, "tableRows", oe2, "tableCells", S], he3);
      E.push(we4);
    }
    const x7 = l.getSnapshot(), M7 = x7.documentStyle, { marginLeft: w = 0, marginRight: F2 = 0 } = M7, P2 = ((ie5 = (ne2 = M7.pageSize) == null ? void 0 : ne2.width) != null ? ie5 : 800) - w - F2, N = (ae2 = x7 == null ? void 0 : x7.tableSource) == null ? void 0 : ae2[v2].tableColumns, { newColWidth: ee3, widths: $ } = vd(P2, N, S);
    for (let oe2 = 0; oe2 < $.length; oe2++) {
      const he3 = p.replaceOp(["tableSource", v2, "tableColumns", oe2, "size", "width", "v"], N[oe2].size.width.v, $[oe2]);
      E.push(he3);
    }
    const U2 = Xr2(ee3), H3 = p.insertOp(["tableSource", v2, "tableColumns", S], U2);
    return E.push(H3), C.params.actions = E.reduce((oe2, he3) => Qt.compose(oe2, he3), null), !!s.syncExecuteCommand(C.id, C.params);
  }
};
var za = {
  id: "doc.table.tab-in-table",
  type: Ms.COMMAND,
  handler: async (n, e) => {
    var g;
    const { shift: t8 } = e, o = n.get(m), r = o.getDocRanges(), s = n.get(Ls), a = n.get(vr).getCurrentUniverDocInstance();
    if (!a)
      return false;
    const c = (g = r.find((f2) => f2.isActive)) != null ? g : r[0], d = a.getUnitId(), l = Ke2(n, d), A = l == null ? void 0 : l.getSkeleton(), h = A == null ? void 0 : A.getViewModel().getSelfOrHeaderFooterViewModel(c == null ? void 0 : c.segmentId);
    if (h == null || c == null)
      return false;
    let u = null;
    if (t8 ? u = $s2(h, c, Ar.PREV) : u = $s2(h, c, Ar.NEXT), u) {
      const { startOffset: f2, endOffset: p } = u, m2 = [{
        startOffset: f2,
        endOffset: p
      }];
      return o.replaceDocRanges(m2), true;
    }
    return t8 === false ? await s.executeCommand(ja.id, {
      position: _o2.BELLOW
    }) : true;
  }
};
var Ga = "COMPONENT_DOC_CREATE_TABLE_CONFIRM";
var $o2 = "doc.component.create-table-confirm";
var Os2 = {
  id: "doc.operation.create-table",
  type: Ms.COMMAND,
  handler: async (n) => {
    const e = n.get(Fn), t8 = n.get(at), o = n.get(Ls), r = {
      rowCount: 3,
      colCount: 5
    }, s = (i, a) => {
      r.rowCount = i, r.colCount = a;
    };
    return await t8.open({
      id: $o2,
      children: {
        label: {
          name: Ga,
          props: {
            handleRowColChange: s,
            tableCreateParams: r
          }
        }
      },
      width: "auto",
      title: { title: e.t("toolbar.table.insert") },
      onConfirm: () => {
        o.executeCommand(Wa.id, r), t8.close($o2);
      },
      onClose: () => {
        t8.close($o2);
      }
    }), true;
  }
};
var St2 = {
  id: "doc.operation.move-cursor",
  type: Ms.OPERATION,
  handler: (n, e) => !!e
};
var vt2 = {
  id: "doc.operation.move-selection",
  type: Ms.OPERATION,
  handler: (n, e) => !!e
};
function Me2({ ref: n, ...e }) {
  const { icon: t8, id: o, className: r, extend: s, ...i } = e, a = `univerjs-icon univerjs-icon-${o} ${r || ""}`.trim(), c = (0, import_react3.useRef)(`_${RA()}`);
  return Ya(t8, `${o}`, {
    defIds: t8.defIds,
    idSuffix: c.current
  }, {
    ref: n,
    className: a,
    ...i
  }, s);
}
function Ya(n, e, t8, o, r) {
  return (0, import_react3.createElement)(n.tag, {
    key: e,
    ...vA(n, t8, r),
    ...o
  }, (CA(n, t8).children || []).map((s, i) => Ya(s, `${e}-${n.tag}-${i}`, t8, void 0, r)));
}
function vA(n, e, t8) {
  const o = { ...n.attrs };
  t8 != null && t8.colorChannel1 && o.fill === "colorChannel1" && (o.fill = t8.colorChannel1), n.tag === "mask" && o.id && (o.id = o.id + e.idSuffix), Object.entries(o).forEach(([s, i]) => {
    s === "mask" && typeof i == "string" && (o[s] = i.replace(/url\(#(.*)\)/, `url(#$1${e.idSuffix})`));
  });
  const { defIds: r } = e;
  return !r || r.length === 0 || (n.tag === "use" && o["xlink:href"] && (o["xlink:href"] = o["xlink:href"] + e.idSuffix), Object.entries(o).forEach(([s, i]) => {
    typeof i == "string" && (o[s] = i.replace(/url\(#(.*)\)/, `url(#$1${e.idSuffix})`));
  })), o;
}
function CA(n, e) {
  var o;
  const { defIds: t8 } = e;
  return !t8 || t8.length === 0 ? n : n.tag === "defs" && ((o = n.children) != null && o.length) ? {
    ...n,
    children: n.children.map((r) => typeof r.attrs.id == "string" && t8 && t8.includes(r.attrs.id) ? {
      ...r,
      attrs: {
        ...r.attrs,
        id: r.attrs.id + e.idSuffix
      }
    } : r)
  } : n;
}
function RA() {
  return Math.random().toString(36).substring(2, 8);
}
Me2.displayName = "UniverIcon";
var bA = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941C1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941C14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M1.9999 5.56641C1.66853 5.56641 1.3999 5.83504 1.3999 6.16641C1.3999 6.49778 1.66853 6.76641 1.9999 6.76641H13.9999C14.3313 6.76641 14.5999 6.49778 14.5999 6.16641C14.5999 5.83504 14.3313 5.56641 13.9999 5.56641H1.9999Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334C14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M1.9999 12.9004C1.66853 12.9004 1.3999 13.169 1.3999 13.5004C1.3999 13.8318 1.66853 14.1004 1.9999 14.1004H13.9999C14.3313 14.1004 14.5999 13.8318 14.5999 13.5004C14.5999 13.169 14.3313 12.9004 13.9999 12.9004H1.9999Z"
      }
    }
  ]
};
var Ka = (0, import_react3.forwardRef)(function(e, t8) {
  return (0, import_react3.createElement)(Me2, Object.assign({}, e, {
    id: "align-text-both-icon",
    ref: t8,
    icon: bA
  }));
});
Ka.displayName = "AlignTextBothIcon";
var yA = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M1.9834 3.98332C1.9834 3.61513 2.28188 3.31665 2.65007 3.31665H13.3167C13.6849 3.31665 13.9834 3.61513 13.9834 3.98332C13.9834 4.35151 13.6849 4.64998 13.3167 4.64998H2.65007C2.28188 4.64998 1.9834 4.35151 1.9834 3.98332Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M1.9834 7.98267C1.9834 7.61448 2.28188 7.316 2.65007 7.316H10.6501C11.0183 7.316 11.3167 7.61448 11.3167 7.98267C11.3167 8.35086 11.0183 8.64933 10.6501 8.64933H2.65007C2.28188 8.64933 1.9834 8.35086 1.9834 7.98267Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M2.65007 11.316C2.28188 11.316 1.9834 11.6145 1.9834 11.9827C1.9834 12.3509 2.28188 12.6493 2.65007 12.6493H7.9834C8.35159 12.6493 8.65006 12.3509 8.65006 11.9827C8.65006 11.6145 8.35159 11.316 7.9834 11.316H2.65007Z"
      }
    }
  ]
};
var qa = (0, import_react3.forwardRef)(function(e, t8) {
  return (0, import_react3.createElement)(Me2, Object.assign({}, e, {
    id: "catalogue-icon",
    ref: t8,
    icon: yA
  }));
});
qa.displayName = "CatalogueIcon";
var xA = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M2.50095 1.84399C2.73322 1.60765 3.11311 1.60435 3.34945 1.83662L8.00012 6.40726L12.6508 1.83662C12.8871 1.60435 13.267 1.60765 13.4993 1.84399C13.7316 2.08032 13.7283 2.46021 13.4919 2.69248L8.85611 7.24852L10.8941 9.25146C11.1382 9.17563 11.3976 9.13477 11.6667 9.13477C13.1026 9.13477 14.2667 10.2988 14.2667 11.7348C14.2667 13.1707 13.1026 14.3348 11.6667 14.3348C10.2307 14.3348 9.06665 13.1707 9.06665 11.7348C9.06665 11.0143 9.35973 10.3622 9.83319 9.89129L8.00012 8.08978L6.16708 9.89127C6.64055 10.3622 6.93364 11.0142 6.93364 11.7348C6.93364 13.1707 5.76958 14.3348 4.33364 14.3348C2.8977 14.3348 1.73364 13.1707 1.73364 11.7348C1.73364 10.2988 2.8977 9.13477 4.33364 9.13477C4.60263 9.13477 4.86208 9.17562 5.10612 9.25145L7.14413 7.24852L2.50831 2.69248C2.27197 2.46021 2.26868 2.08032 2.50095 1.84399ZM2.93364 11.7348C2.93364 10.9616 3.56044 10.3348 4.33364 10.3348C5.10684 10.3348 5.73364 10.9616 5.73364 11.7348C5.73364 12.508 5.10684 13.1348 4.33364 13.1348C3.56044 13.1348 2.93364 12.508 2.93364 11.7348ZM10.2667 11.7348C10.2667 10.9616 10.8935 10.3348 11.6667 10.3348C12.4398 10.3348 13.0667 10.9616 13.0667 11.7348C13.0667 12.508 12.4398 13.1348 11.6667 13.1348C10.8935 13.1348 10.2667 12.508 10.2667 11.7348Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var Xa2 = (0, import_react3.forwardRef)(function(e, t8) {
  return (0, import_react3.createElement)(Me2, Object.assign({}, e, {
    id: "cut-icon",
    ref: t8,
    icon: xA
  }));
});
Xa2.displayName = "CutIcon";
var OA = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M5.3313 1.4667C5.3313 1.13533 5.59993 0.866699 5.9313 0.866699H10.069C10.4004 0.866699 10.669 1.13533 10.669 1.4667C10.669 1.79807 10.4004 2.0667 10.069 2.0667H5.9313C5.59993 2.0667 5.3313 1.79807 5.3313 1.4667Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M1.09985 3.64443C1.09985 3.31306 1.36848 3.04443 1.69985 3.04443H14.2999C14.6312 3.04443 14.8999 3.31306 14.8999 3.64443C14.8999 3.9758 14.6312 4.24443 14.2999 4.24443H1.69985C1.36848 4.24443 1.09985 3.9758 1.09985 3.64443Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M6.12398 8.30171C6.35829 8.0674 6.73819 8.0674 6.97251 8.30171L8.00007 9.32928L9.02764 8.30171C9.26195 8.0674 9.64185 8.0674 9.87617 8.30171C10.1105 8.53603 10.1105 8.91593 9.87617 9.15024L8.8486 10.1778L9.87617 11.2054C10.1105 11.4397 10.1105 11.8196 9.87617 12.0539C9.64185 12.2882 9.26195 12.2882 9.02764 12.0539L8.00007 11.0263L6.97251 12.0539C6.73819 12.2882 6.35829 12.2882 6.12398 12.0539C5.88966 11.8196 5.88966 11.4397 6.12398 11.2054L7.15154 10.1778L6.12398 9.15024C5.88966 8.91593 5.88966 8.53603 6.12398 8.30171Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M4.75332 5.22217C3.86966 5.22217 3.15332 5.93851 3.15332 6.82217V12.5331C3.15332 13.9691 4.31738 15.1332 5.75332 15.1332H10.2465C11.6825 15.1332 12.8465 13.9691 12.8465 12.5331V6.82217C12.8465 5.93851 12.1302 5.22217 11.2465 5.22217H4.75332ZM4.35332 6.82217C4.35332 6.60125 4.53241 6.42217 4.75332 6.42217H11.2465C11.4674 6.42217 11.6465 6.60125 11.6465 6.82217V12.5331C11.6465 13.3063 11.0197 13.9332 10.2465 13.9332H5.75332C4.98012 13.9332 4.35332 13.3063 4.35332 12.5331V6.82217Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    }
  ]
};
var Za = (0, import_react3.forwardRef)(function(e, t8) {
  return (0, import_react3.createElement)(Me2, Object.assign({}, e, {
    id: "delete-icon",
    ref: t8,
    icon: OA
  }));
});
Za.displayName = "DeleteIcon";
var TA = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M10.9913 10.8779C11.4971 10.8779 11.9073 11.2882 11.9073 11.7939C11.9073 12.2997 11.4971 12.71 10.9913 12.71C10.4857 12.7099 10.0754 12.2996 10.0753 11.7939C10.0753 11.2882 10.4857 10.878 10.9913 10.8779Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M11.9572 8.51465C12.5471 8.51471 13.0936 8.82742 13.3927 9.33594L14.3419 10.9502C14.6291 11.4386 14.6479 12.037 14.3966 12.5391L14.3419 12.6377L13.3927 14.252C13.0936 14.7605 12.5471 15.0732 11.9572 15.0732H10.0255C9.50941 15.0731 9.02688 14.8339 8.71399 14.4336L8.59094 14.252L7.64075 12.6377C7.33466 12.1169 7.33466 11.471 7.64075 10.9502L8.59094 9.33594L8.71399 9.1543C9.02688 8.75387 9.50935 8.51477 10.0255 8.51465H11.9572ZM10.0255 9.84473C9.93678 9.84483 9.85287 9.87988 9.79114 9.94043L9.73743 10.0098L8.78723 11.624C8.72565 11.7288 8.72564 11.8591 8.78723 11.9639L9.73743 13.5781L9.79114 13.6475C9.85286 13.7079 9.93684 13.7431 10.0255 13.7432H11.9572C12.0757 13.7431 12.186 13.6803 12.2462 13.5781L13.1954 11.9639L13.2306 11.8809C13.2536 11.7953 13.2415 11.7025 13.1954 11.624L12.2462 10.0098C12.186 9.90756 12.0758 9.84479 11.9572 9.84473H10.0255Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M10.5031 0.926758C11.9748 0.926758 13.1679 2.12013 13.1681 3.5918V6.41602C13.1679 6.78314 12.8702 7.08105 12.5031 7.08105C12.1361 7.08084 11.8382 6.783 11.838 6.41602V3.5918C11.8378 2.85467 11.2402 2.25684 10.5031 2.25684H4.0929C3.35572 2.25684 2.75813 2.85467 2.75793 3.5918V12.085C2.75818 12.8221 3.35574 13.4199 4.0929 13.4199H6.18958L6.32434 13.4326C6.62712 13.4947 6.85444 13.7639 6.85461 14.085C6.8544 14.406 6.62705 14.6742 6.32434 14.7363L6.18958 14.75H4.0929C2.62121 14.75 1.4281 13.5566 1.42786 12.085V3.5918C1.42806 2.12013 2.62118 0.926758 4.0929 0.926758H10.5031Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M8.04993 6.42969C8.35293 6.49172 8.58118 6.75971 8.58118 7.08105C8.581 7.40229 8.35289 7.67047 8.04993 7.73242L7.91614 7.74609H4.73547C4.36833 7.74609 4.07063 7.44816 4.07043 7.08105C4.07043 6.71379 4.3682 6.41602 4.73547 6.41602H7.91614L8.04993 6.42969Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M10.1007 3.92188C10.4034 3.98418 10.631 4.25215 10.631 4.57324C10.6309 4.8943 10.4033 5.16233 10.1007 5.22461L9.96594 5.23828H4.73547C4.36824 5.23828 4.0705 4.94046 4.07043 4.57324C4.07043 4.20597 4.3682 3.9082 4.73547 3.9082H9.96594L10.1007 3.92188Z"
      }
    }
  ]
};
var Ja = (0, import_react3.forwardRef)(function(e, t8) {
  return (0, import_react3.createElement)(Me2, Object.assign({}, e, {
    id: "doc-setting-icon",
    ref: t8,
    icon: TA
  }));
});
Ja.displayName = "DocSettingIcon";
var BA = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 20 20",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M10.5547 14.1884C10.2599 14.5214 9.74019 14.5214 9.4454 14.1884L3.71321 7.71335C3.29002 7.23532 3.6294 6.48161 4.26784 6.48161L15.7322 6.48161C16.3707 6.48161 16.7101 7.23532 16.2869 7.71335L10.5547 14.1884Z"
    }
  }]
};
var $a = (0, import_react3.forwardRef)(function(e, t8) {
  return (0, import_react3.createElement)(Me2, Object.assign({}, e, {
    id: "down-icon",
    ref: t8,
    icon: BA
  }));
});
$a.displayName = "DownIcon";
var MA = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M3.0999 2.66689C3.0999 2.33552 2.83127 2.06689 2.4999 2.06689C2.16853 2.06689 1.8999 2.33552 1.8999 2.66689V13.3336C1.8999 13.6649 2.16853 13.9336 2.4999 13.9336C2.83127 13.9336 3.0999 13.6649 3.0999 13.3336V8.5999H8.2334V13.3336C8.2334 13.6649 8.50203 13.9336 8.8334 13.9336C9.16477 13.9336 9.4334 13.6649 9.4334 13.3336V2.66689C9.4334 2.33552 9.16477 2.06689 8.8334 2.06689C8.50203 2.06689 8.2334 2.33552 8.2334 2.66689V7.3999H3.0999V2.66689Z"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M14.0999 6.33879C14.0999 6.09377 13.9509 5.87336 13.7236 5.78203C13.4962 5.6907 13.2362 5.74679 13.0667 5.92373L11.4753 7.58486C11.2461 7.82415 11.2542 8.20396 11.4935 8.43319C11.7328 8.66243 12.1126 8.65427 12.3419 8.41499L12.8999 7.83245V13.3333C12.8999 13.6646 13.1686 13.9333 13.4999 13.9333C13.8313 13.9333 14.0999 13.6646 14.0999 13.3333V6.33879Z"
    }
  }]
};
var ec = (0, import_react3.forwardRef)(function(e, t8) {
  return (0, import_react3.createElement)(Me2, Object.assign({}, e, {
    id: "h1-icon",
    ref: t8,
    icon: MA
  }));
});
ec.displayName = "H1Icon";
var _A = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M2.5999 2.66689C2.5999 2.33552 2.33127 2.06689 1.9999 2.06689C1.66853 2.06689 1.3999 2.33552 1.3999 2.66689V13.3336C1.3999 13.6649 1.66853 13.9336 1.9999 13.9336C2.33127 13.9336 2.5999 13.6649 2.5999 13.3336V8.5999H7.3999V13.3336C7.3999 13.6649 7.66853 13.9336 7.9999 13.9336C8.33127 13.9336 8.5999 13.6649 8.5999 13.3336V2.66689C8.5999 2.33552 8.33127 2.06689 7.9999 2.06689C7.66853 2.06689 7.3999 2.33552 7.3999 2.66689V7.3999H2.5999V2.66689Z"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M11.2667 8.33356C11.2667 7.67245 11.8201 7.26689 12.3333 7.26689C12.8465 7.26689 13.4 7.67244 13.4 8.33356C13.4 8.62807 13.2712 8.94814 12.9954 9.32391C12.7183 9.70153 12.3394 10.0744 11.9174 10.4803L11.8355 10.559C11.4524 10.9268 11.0365 11.3263 10.7149 11.7373C10.3718 12.1759 10.0667 12.7122 10.0667 13.3336C10.0667 13.6649 10.3353 13.9336 10.6667 13.9336H14C14.3314 13.9336 14.6 13.6649 14.6 13.3336C14.6 13.0022 14.3314 12.7336 14 12.7336H11.4782C11.5286 12.6531 11.5889 12.5676 11.6601 12.4767C11.9269 12.1355 12.2843 11.792 12.6877 11.4043L12.7492 11.3452C13.1606 10.9496 13.615 10.5079 13.9629 10.0338C14.3122 9.55787 14.6 8.98906 14.6 8.33356C14.6 6.88362 13.3757 6.06689 12.3333 6.06689C11.291 6.06689 10.0667 6.88361 10.0667 8.33356C10.0667 8.66493 10.3353 8.93356 10.6667 8.93356C10.998 8.93356 11.2667 8.66493 11.2667 8.33356Z"
    }
  }]
};
var tc = (0, import_react3.forwardRef)(function(e, t8) {
  return (0, import_react3.createElement)(Me2, Object.assign({}, e, {
    id: "h2-icon",
    ref: t8,
    icon: _A
  }));
});
tc.displayName = "H2Icon";
var DA = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M2.5999 2.66689C2.5999 2.33552 2.33127 2.06689 1.9999 2.06689C1.66853 2.06689 1.3999 2.33552 1.3999 2.66689V13.3336C1.3999 13.6649 1.66853 13.9336 1.9999 13.9336C2.33127 13.9336 2.5999 13.6649 2.5999 13.3336V8.5999H7.3999V13.3336C7.3999 13.6649 7.66853 13.9336 7.9999 13.9336C8.33127 13.9336 8.5999 13.6649 8.5999 13.3336V2.66689C8.5999 2.33552 8.33127 2.06689 7.9999 2.06689C7.66853 2.06689 7.3999 2.33552 7.3999 2.66689V7.3999H2.5999V2.66689Z"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M10.6667 6.06689C10.3353 6.06689 10.0667 6.33552 10.0667 6.66689C10.0667 6.99827 10.3353 7.26689 10.6667 7.26689H12.7732L11.193 9.29853C11.0524 9.47942 11.027 9.72465 11.1277 9.93051C11.2283 10.1364 11.4375 10.2669 11.6667 10.2669C12.2418 10.2669 12.6786 10.4115 12.9585 10.6354C13.2204 10.845 13.4 11.166 13.4 11.6669C13.4 12.1622 13.2254 12.3937 13.0567 12.5202C12.8588 12.6686 12.5829 12.7336 12.3333 12.7336C11.7271 12.7336 11.3432 12.4858 11.1106 12.23C10.8877 11.9848 10.5082 11.9667 10.2631 12.1896C10.0179 12.4125 9.99979 12.792 10.2227 13.0372C10.6568 13.5147 11.3522 13.9336 12.3333 13.9336C12.7504 13.9336 13.3078 13.8319 13.7767 13.4802C14.2746 13.1068 14.6 12.5049 14.6 11.6669C14.6 10.8345 14.2796 10.1555 13.7081 9.69837C13.4342 9.47923 13.117 9.32231 12.7746 9.21971L14.4736 7.03526C14.6143 6.85437 14.6397 6.60914 14.539 6.40328C14.4383 6.19743 14.2291 6.06689 14 6.06689H10.6667Z"
    }
  }]
};
var nc = (0, import_react3.forwardRef)(function(e, t8) {
  return (0, import_react3.createElement)(Me2, Object.assign({}, e, {
    id: "h3-icon",
    ref: t8,
    icon: DA
  }));
});
nc.displayName = "H3Icon";
var wA = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M2.4334 2.66689C2.4334 2.33552 2.16477 2.06689 1.8334 2.06689C1.50203 2.06689 1.2334 2.33552 1.2334 2.66689V13.3336C1.2334 13.6649 1.50203 13.9336 1.8334 13.9336C2.16477 13.9336 2.4334 13.6649 2.4334 13.3336V8.5999H7.2334V13.3336C7.2334 13.6649 7.50203 13.9336 7.8334 13.9336C8.16477 13.9336 8.4334 13.6649 8.4334 13.3336V2.66689C8.4334 2.33552 8.16477 2.06689 7.8334 2.06689C7.50203 2.06689 7.2334 2.33552 7.2334 2.66689V7.3999H2.4334V2.66689Z"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M13.7591 6.66645C13.7591 6.40387 13.5884 6.1718 13.3377 6.09364C13.087 6.01549 12.8147 6.10941 12.6654 6.32546L9.67321 10.6577C9.60398 10.7579 9.56689 10.8769 9.56689 10.9987V11.6731C9.56689 12.0045 9.83552 12.2731 10.1669 12.2731H12.5591V13.3331C12.5591 13.6645 12.8278 13.9331 13.1591 13.9331C13.4905 13.9331 13.7591 13.6645 13.7591 13.3331V12.2731H14.1669C14.4983 12.2731 14.7669 12.0045 14.7669 11.6731C14.7669 11.3417 14.4983 11.0731 14.1669 11.0731H13.7591V6.66645ZM12.5591 8.59091V11.0731H10.8447L12.5591 8.59091Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var oc2 = (0, import_react3.forwardRef)(function(e, t8) {
  return (0, import_react3.createElement)(Me2, Object.assign({}, e, {
    id: "h4-icon",
    ref: t8,
    icon: wA
  }));
});
oc2.displayName = "H4Icon";
var PA = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M2.5999 2.66689C2.5999 2.33552 2.33127 2.06689 1.9999 2.06689C1.66853 2.06689 1.3999 2.33552 1.3999 2.66689V13.3336C1.3999 13.6649 1.66853 13.9336 1.9999 13.9336C2.33127 13.9336 2.5999 13.6649 2.5999 13.3336V8.5999H7.3999V13.3336C7.3999 13.6649 7.66853 13.9336 7.9999 13.9336C8.33127 13.9336 8.5999 13.6649 8.5999 13.3336V2.66689C8.5999 2.33552 8.33127 2.06689 7.9999 2.06689C7.66853 2.06689 7.3999 2.33552 7.3999 2.66689V7.3999H2.5999V2.66689Z"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M10.6669 6.40332C10.3355 6.40332 10.0669 6.67195 10.0669 7.00332V9.34492C10.0669 9.67629 10.3355 9.94492 10.6669 9.94492C10.7822 9.94492 10.8899 9.91238 10.9814 9.85599C10.9901 9.85195 11.0027 9.84632 11.0192 9.83936C11.0764 9.81533 11.1692 9.78033 11.2927 9.74447C11.5397 9.67268 11.8996 9.60022 12.3336 9.60022C12.4975 9.60022 12.5978 9.63412 12.6624 9.67167C12.7263 9.70877 12.79 9.76953 12.8503 9.87834C12.983 10.1181 13.0669 10.5337 13.0669 11.1669C13.0669 11.8061 12.9802 12.1936 12.8338 12.414C12.7252 12.5775 12.5275 12.7336 12.0002 12.7336C11.6445 12.7336 11.4936 12.622 11.4192 12.5328C11.3289 12.4245 11.2669 12.2453 11.2669 12.0028C11.2669 11.6714 10.9983 11.4028 10.6669 11.4028C10.3355 11.4028 10.0669 11.6714 10.0669 12.0028C10.0669 12.4244 10.1716 12.9106 10.4979 13.3016C10.8401 13.7118 11.356 13.9336 12.0002 13.9336C12.8063 13.9336 13.4419 13.6673 13.8334 13.0779C14.1869 12.5456 14.2669 11.8497 14.2669 11.1669C14.2669 10.4781 14.1841 9.81027 13.9002 9.29724C13.7521 9.02964 13.545 8.79662 13.2651 8.63403C12.986 8.4719 12.6697 8.40022 12.3336 8.40022C11.9239 8.40022 11.5627 8.44957 11.2669 8.51389V7.60332H13.3336C13.6649 7.60332 13.9336 7.33469 13.9336 7.00332C13.9336 6.67195 13.6649 6.40332 13.3336 6.40332H10.6669Z"
    }
  }]
};
var rc = (0, import_react3.forwardRef)(function(e, t8) {
  return (0, import_react3.createElement)(Me2, Object.assign({}, e, {
    id: "h5-icon",
    ref: t8,
    icon: PA
  }));
});
rc.displayName = "H5Icon";
var NA = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941C1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941C14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M3.33315 5.56641C3.00178 5.56641 2.73315 5.83504 2.73315 6.16641C2.73315 6.49778 3.00178 6.76641 3.33315 6.76641H12.6665C12.9979 6.76641 13.2665 6.49778 13.2665 6.16641C13.2665 5.83504 12.9979 5.56641 12.6665 5.56641H3.33315Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334C14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M3.33315 12.9004C3.00178 12.9004 2.73315 13.169 2.73315 13.5004C2.73315 13.8318 3.00178 14.1004 3.33315 14.1004H12.6665C12.9979 14.1004 13.2665 13.8318 13.2665 13.5004C13.2665 13.169 12.9979 12.9004 12.6665 12.9004H3.33315Z"
      }
    }
  ]
};
var sc = (0, import_react3.forwardRef)(function(e, t8) {
  return (0, import_react3.createElement)(Me2, Object.assign({}, e, {
    id: "horizontally-icon",
    ref: t8,
    icon: NA
  }));
});
sc.displayName = "HorizontallyIcon";
var LA = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M10.4713 3.52876C10.7317 3.78911 10.7317 4.21122 10.4713 4.47157L6.94273 8.00016L10.4713 11.5288C10.7317 11.7891 10.7317 12.2112 10.4713 12.4716C10.211 12.7319 9.78886 12.7319 9.52851 12.4716L5.52851 8.47157C5.26816 8.21122 5.26816 7.78911 5.52851 7.52876L9.52851 3.52876C9.78886 3.26841 10.211 3.26841 10.4713 3.52876Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var ic2 = (0, import_react3.forwardRef)(function(e, t8) {
  return (0, import_react3.createElement)(Me2, Object.assign({}, e, {
    id: "left-icon",
    ref: t8,
    icon: LA
  }));
});
ic2.displayName = "LeftIcon";
var QA = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941C1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941C14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M1.9999 5.56641C1.66853 5.56641 1.3999 5.83504 1.3999 6.16641C1.3999 6.49778 1.66853 6.76641 1.9999 6.76641H11.3332C11.6646 6.76641 11.9332 6.49778 11.9332 6.16641C11.9332 5.83504 11.6646 5.56641 11.3332 5.56641H1.9999Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334C14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M1.9999 12.9004C1.66853 12.9004 1.3999 13.169 1.3999 13.5004C1.3999 13.8318 1.66853 14.1004 1.9999 14.1004H11.3332C11.6646 14.1004 11.9332 13.8318 11.9332 13.5004C11.9332 13.169 11.6646 12.9004 11.3332 12.9004H1.9999Z"
      }
    }
  ]
};
var ac2 = (0, import_react3.forwardRef)(function(e, t8) {
  return (0, import_react3.createElement)(Me2, Object.assign({}, e, {
    id: "left-justifying-icon",
    ref: t8,
    icon: QA
  }));
});
ac2.displayName = "LeftJustifyingIcon";
var UA = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941C1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941C14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M4.66665 5.56641C4.33528 5.56641 4.06665 5.83504 4.06665 6.16641C4.06665 6.49778 4.33528 6.76641 4.66665 6.76641H14C14.3314 6.76641 14.6 6.49778 14.6 6.16641C14.6 5.83504 14.3314 5.56641 14 5.56641H4.66665Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334C14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M4.66665 12.9004C4.33528 12.9004 4.06665 13.169 4.06665 13.5004C4.06665 13.8318 4.33528 14.1004 4.66665 14.1004H14C14.3314 14.1004 14.6 13.8318 14.6 13.5004C14.6 13.169 14.3314 12.9004 14 12.9004H4.66665Z"
      }
    }
  ]
};
var cc = (0, import_react3.forwardRef)(function(e, t8) {
  return (0, import_react3.createElement)(Me2, Object.assign({}, e, {
    id: "right-justifying-icon",
    ref: t8,
    icon: UA
  }));
});
cc.displayName = "RightJustifyingIcon";
var FA = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M2.06641 1.9999C2.06641 1.66853 2.33504 1.3999 2.66641 1.3999H13.3331C13.6644 1.3999 13.9331 1.66853 13.9331 1.9999V3.64434C13.9331 3.97571 13.6644 4.24434 13.3331 4.24434C13.0017 4.24434 12.7331 3.97571 12.7331 3.64434V2.5999H8.59966V13.3999H10.6665C10.9979 13.3999 11.2665 13.6685 11.2665 13.9999C11.2665 14.3313 10.9979 14.5999 10.6665 14.5999L7.99966 14.5999L5.33315 14.5999C5.00178 14.5999 4.73315 14.3313 4.73315 13.9999C4.73315 13.6685 5.00178 13.3999 5.33315 13.3999H7.39966V2.5999H3.26641V3.64434C3.26641 3.97571 2.99778 4.24434 2.66641 4.24434C2.33504 4.24434 2.06641 3.97571 2.06641 3.64434V1.9999Z"
    }
  }]
};
var pn4 = (0, import_react3.forwardRef)(function(e, t8) {
  return (0, import_react3.createElement)(Me2, Object.assign({}, e, {
    id: "text-type-icon",
    ref: t8,
    icon: FA
  }));
});
pn4.displayName = "TextTypeIcon";
var HA = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M4.96372 2.59116C5.19803 2.35684 5.19803 1.97695 4.96372 1.74263C4.7294 1.50832 4.3495 1.50832 4.11519 1.74263L2.53945 3.31837L1.96372 2.74263C1.7294 2.50832 1.3495 2.50832 1.11519 2.74263C0.880874 2.97695 0.880874 3.35684 1.11519 3.59116L2.11519 4.59116C2.3495 4.82547 2.7294 4.82547 2.96372 4.59116L4.96372 2.59116Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M14.4605 2.56689H6.8981C6.56672 2.56689 6.2981 2.83552 6.2981 3.16689C6.2981 3.49827 6.56672 3.76689 6.8981 3.76689H14.4605C14.7918 3.76689 15.0605 3.49827 15.0605 3.16689C15.0605 2.83552 14.7918 2.56689 14.4605 2.56689Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M6.8981 7.2334C6.56672 7.2334 6.2981 7.50203 6.2981 7.8334C6.2981 8.16477 6.56672 8.4334 6.8981 8.4334H14.4605C14.7918 8.4334 15.0605 8.16477 15.0605 7.8334C15.0605 7.50203 14.7918 7.2334 14.4605 7.2334H6.8981Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M6.2981 12.4999C6.2981 12.1685 6.56672 11.8999 6.8981 11.8999H14.4605C14.7918 11.8999 15.0605 12.1685 15.0605 12.4999C15.0605 12.8313 14.7918 13.0999 14.4605 13.0999H6.8981C6.56672 13.0999 6.2981 12.8313 6.2981 12.4999Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M2.87279 5.8999C1.80504 5.8999 0.939453 6.76549 0.939453 7.83324C0.939453 8.90099 1.80504 9.76657 2.87279 9.76657C3.94054 9.76657 4.80612 8.90099 4.80612 7.83324C4.80612 6.76549 3.94054 5.8999 2.87279 5.8999ZM2.13945 7.83324C2.13945 7.42823 2.46778 7.0999 2.87279 7.0999C3.2778 7.0999 3.60612 7.42823 3.60612 7.83324C3.60612 8.23824 3.2778 8.56657 2.87279 8.56657C2.46778 8.56657 2.13945 8.23824 2.13945 7.83324Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M0.939453 12.5002C0.939453 11.4325 1.80504 10.5669 2.87279 10.5669C3.94054 10.5669 4.80612 11.4325 4.80612 12.5002C4.80612 13.568 3.94054 14.4336 2.87279 14.4336C1.80504 14.4336 0.939453 13.568 0.939453 12.5002ZM2.87279 11.7669C2.46778 11.7669 2.13945 12.0952 2.13945 12.5002C2.13945 12.9052 2.46778 13.2336 2.87279 13.2336C3.2778 13.2336 3.60612 12.9052 3.60612 12.5002C3.60612 12.0952 3.2778 11.7669 2.87279 11.7669Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    }
  ]
};
var lc2 = (0, import_react3.forwardRef)(function(e, t8) {
  return (0, import_react3.createElement)(Me2, Object.assign({}, e, {
    id: "todo-list-double-icon",
    ref: t8,
    icon: HA
  }));
});
lc2.displayName = "TodoListDoubleIcon";
function dc(n) {
  var o;
  const { dataStream: e } = (o = n.body) != null ? o : {}, t8 = [
    ct.TABLE_START,
    ct.TABLE_CELL_END,
    ct.TABLE_CELL_START,
    ct.TABLE_END,
    ct.TABLE_ROW_END,
    ct.TABLE_ROW_START,
    ct.COLUMN_BREAK,
    ct.PAGE_BREAK,
    ct.TAB,
    ct.DOCS_END,
    ct.CUSTOM_BLOCK
  ];
  if (typeof e == "string")
    for (let r = 0; r < e.length; r++) {
      const s = e[r];
      if (!t8.includes(s))
        return r;
    }
  return 0;
}
var kA = class extends Ve {
  constructor(t8, o, r, s, i, a) {
    super();
    O(this, "_change$", new Subject());
    O(this, "change$", this._change$.asObservable());
    O(this, "_input$", new Subject());
    O(this, "input$", this._input$.asObservable());
    O(this, "_paste$", new Subject());
    O(this, "paste$", this._paste$.asObservable());
    O(this, "_focus$", new Subject());
    O(this, "focus$", this._focus$.asObservable());
    O(this, "_blur$", new Subject());
    O(this, "blur$", this._blur$.asObservable());
    O(this, "_selectionChange$", new Subject());
    O(this, "selectionChange$", this._selectionChange$.asObservable());
    this._param = t8, this._univerInstanceService = o, this._docSelectionManagerService = r, this._commandService = s, this._undoRedoService = i, this._injector = a, this._listenSelection();
  }
  get docSelectionRenderService() {
    return this._param.render.with(Re2);
  }
  _listenSelection() {
    const t8 = this._param.render.with(Re2);
    this.disposeWithMe(
      t8.onBlur$.subscribe((o) => {
        this._blur$.next(o);
        const r = this.getDocumentData();
        this._change$.next({
          target: this,
          data: r
        });
      })
    ), this.disposeWithMe(
      t8.onFocus$.subscribe((o) => {
        this._focus$.next(o);
      })
    ), this.disposeWithMe(
      t8.onPaste$.subscribe((o) => {
        this._paste$.next(o);
      })
    ), this.disposeWithMe(
      merge(
        t8.onInput$,
        t8.onKeydown$.pipe(filter((o) => {
          const r = o.event;
          return r.ctrlKey || r.metaKey ? [q1.X, q1.V].includes(r.keyCode) : [q1.BACKSPACE].includes(r.keyCode);
        })),
        t8.onCompositionupdate$,
        t8.onCompositionend$,
        t8.onPaste$
      ).subscribe((o) => {
        if (o == null)
          return;
        const { content: r = "" } = o, s = this.getDocumentData();
        this._input$.next({
          target: this,
          content: r,
          data: s,
          isComposing: o.event.type === "compositionupdate"
        });
      })
    ), this.disposeWithMe(
      this._docSelectionManagerService.textSelection$.subscribe((o) => {
        if (o == null)
          return;
        const { unitId: r, subUnitId: s, ...i } = o, a = this.getEditorId();
        r === a && this._selectionChange$.next(i);
      })
    );
  }
  isFocus() {
    const t8 = this._param.render.with(Re2);
    return t8.isFocusing && !!t8.getActiveTextRange();
  }
  /**
   * @deprecated use `IEditorService.focus` as instead. this is for internal usage.
   */
  focus() {
    const t8 = this._univerInstanceService.getCurrentUnitForType(we.UNIVER_DOC), o = this.getEditorId();
    (t8 == null || t8.getUnitId() !== o) && this._univerInstanceService.setCurrentUnitForType(o), this._param.render.with(Re2).focus();
  }
  /**
   * @deprecated use `IEditorService.blur` as instead. this is for internal usage.
   */
  blur() {
    this._param.render.with(Re2).blur();
  }
  // Selects the entire content of the editor.
  // Calling editor.select() will not necessarily focus the editor, so it is often used with Editor.focus
  select() {
    const t8 = this.getDocumentData();
    return this.setSelectionRanges([{
      startOffset: 0,
      endOffset: t8.body ? t8.body.dataStream.length - 2 : 0
    }]);
  }
  // Selects the specified range of characters within editor.
  setSelectionRanges(t8, o = true) {
    const r = this.getEditorId(), s = {
      unitId: r,
      subUnitId: r
    };
    return this._docSelectionManagerService.replaceDocRanges(t8, s, false, { shouldFocus: o });
  }
  // Get current doc ranges. include text range and rect range.
  getSelectionRanges() {
    const t8 = this.getEditorId(), o = {
      unitId: t8,
      subUnitId: t8
    };
    return this._docSelectionManagerService.getDocRanges(o);
  }
  getCursorPosition() {
    var o, r;
    return (r = (o = this.getSelectionRanges().find((s) => s.collapsed)) == null ? void 0 : o.startOffset) != null ? r : -1;
  }
  // get editor id.
  getEditorId() {
    return this._getEditorId();
  }
  // get document data.
  getDocumentData() {
    return this._getDocDataModel().getSnapshot();
  }
  getDocumentDataModel() {
    return this._getDocDataModel();
  }
  // Set the new document data.
  setDocumentData(t8, o) {
    this._commandService.syncExecuteCommand(_a.id, {
      unitId: this.getEditorId(),
      snapshot: t8,
      textRanges: o
    });
  }
  replaceText(t8, o = true) {
    const r = this.getDocumentData();
    this.setDocumentData(
      {
        ...r,
        body: {
          dataStream: `${t8}\r
`,
          paragraphs: [{
            startIndex: 0
          }],
          customRanges: [],
          sectionBreaks: [],
          tables: [],
          textRuns: []
        }
      },
      typeof o == "object" ? o : o ? [{
        startOffset: t8.length,
        endOffset: t8.length,
        collapsed: true
      }] : null
    );
  }
  // Clear the undo redo history of this editor.
  clearUndoRedoHistory() {
    const t8 = this.getEditorId();
    return this._undoRedoService.clearUndoRedo(t8);
  }
  dispose() {
    this._getDocDataModel().dispose();
  }
  /**
   * @deprecated use getEditorId.
   */
  get editorUnitId() {
    return this._param.editorUnitId;
  }
  /**
   * @deprecated @TODO: @JOCS remove this in the future.
   */
  get params() {
    return this._param;
  }
  get cancelDefaultResizeListener() {
    return this._param.cancelDefaultResizeListener;
  }
  get render() {
    return this._param.render;
  }
  isReadOnly() {
    return this._param.readonly === true;
  }
  getBoundingClientRect() {
    return this._param.editorDom.getBoundingClientRect();
  }
  get editorDOM() {
    return this._param.editorDom;
  }
  isVisible() {
    return this._param.visible;
  }
  getSkeleton() {
    var o;
    return (o = this._injector.get(ME).getRenderById(this._getEditorId())) == null ? void 0 : o.with(D).getSkeleton();
  }
  isSheetEditor() {
    return Yc(this._getEditorId());
  }
  /**
   * @deprecated use getDocumentData.
   */
  getValue() {
    var r;
    return (((r = this._getDocDataModel().getBody()) == null ? void 0 : r.dataStream) || "").replace(/\r\n/g, "").replace(/\n/g, "").replace(/\n/g, "");
  }
  /**
   * @deprecated use getDocumentData.
   */
  getBody() {
    return this._getDocDataModel().getBody();
  }
  /**
   * @deprecated.
   */
  update(t8) {
    this._param = {
      ...this._param,
      ...t8
    };
  }
  /**
   * @deprecated.
   */
  updateCanvasStyle() {
    var r;
    const t8 = this._getDocDataModel();
    if (t8 == null)
      return;
    const o = {};
    (r = this._param.canvasStyle) != null && r.fontSize && (o.textStyle == null && (o.textStyle = {}), o.textStyle.fs = this._param.canvasStyle.fontSize), t8.updateDocumentStyle(o);
  }
  _getDocDataModel() {
    const t8 = this._getEditorId();
    return this._univerInstanceService.getUnit(t8, we.UNIVER_DOC);
  }
  _getEditorId() {
    var t8;
    return ((t8 = this._param.initialSnapshot) == null ? void 0 : t8.id) || this._param.editorUnitId || "";
  }
};
var VA = Object.getOwnPropertyDescriptor;
var WA = (n, e, t8, o) => {
  for (var r = o > 1 ? void 0 : o ? VA(e, t8) : e, s = n.length - 1, i; s >= 0; s--)
    (i = n[s]) && (r = i(r) || r);
  return r;
};
var Ot = (n, e) => (t8, o) => e(t8, o, n);
var jA = [
  "editor",
  "render-canvas"
  // 'univer-range-selector',
  // 'univer-range-selector-editor',
  // 'univer-text-editor-container-placeholder',
];
var Sr = class extends Ve {
  constructor(e, t8, o, r, s, i, a) {
    super();
    O(this, "_editors", /* @__PURE__ */ new Map());
    O(this, "_focusEditorUnitId");
    O(this, "_blur$", new Subject());
    O(this, "blur$", this._blur$.asObservable());
    O(this, "_focus$", new Subject());
    O(this, "focus$", this._focus$.asObservable());
    this._univerInstanceService = e, this._renderManagerService = t8, this._docSelectionManagerService = o, this._contextService = r, this._commandService = s, this._undoRedoService = i, this._injector = a, this._initUniverFocusListener();
  }
  // REFACTOR: @Gggpound The specific business processing should not be placed here,
  // I moved from the layout service. https://github.com/dream-num/univer-pro/issues/1708
  _initUniverFocusListener() {
    this.disposeWithMe(
      fromEvent(window, "focusin").subscribe((e) => {
        const t8 = e.target;
        this._blurSheetEditor(t8);
      })
    );
  }
  _blurSheetEditor(e) {
    if (jA.some((o) => e.dataset.uComp === o))
      return;
    const t8 = this.getFocusEditor();
    t8 && t8.isSheetEditor() !== true && this.blur();
  }
  _setFocusId(e) {
    this._focusEditorUnitId = e;
  }
  getFocusId() {
    return this._focusEditorUnitId;
  }
  getFocusEditor() {
    if (this._focusEditorUnitId)
      return this.getEditor(this._focusEditorUnitId);
  }
  isEditor(e) {
    return this._editors.has(e);
  }
  isSheetEditor(e) {
    const t8 = this._editors.get(e);
    return !!(t8 && t8.isSheetEditor());
  }
  blur(e) {
    const t8 = this.getFocusEditor();
    e && (t8 == null || t8.setSelectionRanges([])), t8 == null || t8.blur(), this._contextService.setContextValue(mE, false), this._contextService.setContextValue(DR, false), this._setFocusId(null), this._blur$.next(null);
  }
  focus(e) {
    if (e === this._focusEditorUnitId || (this._focusEditorUnitId && this.blur(), e == null))
      return;
    const t8 = this.getEditor(e);
    if (t8 == null)
      return;
    this._univerInstanceService.setCurrentUnitForType(e);
    const o = t8.getValue().length;
    this._contextService.setContextValue(mE, true), Yc(e) || this._contextService.setContextValue(DR, true), t8.focus(), this._setFocusId(e), this._focus$.next({
      startOffset: o,
      endOffset: o
    });
  }
  dispose() {
    this._editors.clear(), super.dispose();
  }
  getEditor(e = this._getCurrentEditorUnitId()) {
    return this._editors.get(e);
  }
  getAllEditor() {
    return this._editors;
  }
  register(e, t8) {
    var c, d, l, A;
    const { initialSnapshot: o, canvasStyle: r = {} } = e, s = o.id;
    this._univerInstanceService.getUnit(s, we.UNIVER_DOC) == null && this._univerInstanceService.createUnit(
      we.UNIVER_DOC,
      o || this._getBlank(s),
      { makeCurrent: false }
    );
    let a = this._renderManagerService.getRenderById(s);
    if (a == null && (this._renderManagerService.create(s), a = this._renderManagerService.getRenderById(s)), a) {
      a.engine.setContainer(t8);
      const h = new kA(
        { ...e, render: a, editorDom: t8, canvasStyle: r },
        this._univerInstanceService,
        this._docSelectionManagerService,
        this._commandService,
        this._undoRedoService,
        this._injector
      );
      this._editors.set(s, h), e.scrollBar || (A = (l = (d = (c = a.mainComponent) == null ? void 0 : c.getScene()) == null ? void 0 : d.getViewports()) == null ? void 0 : l[0].getScrollBar()) == null || A.dispose();
    }
    return We(() => {
      this._unRegister(s);
    });
  }
  _unRegister(e) {
    const t8 = this._editors.get(e);
    t8 != null && (this._renderManagerService.removeRender(e), t8.dispose(), this._editors.delete(e), this._univerInstanceService.disposeUnit(e));
  }
  _getCurrentEditorUnitId() {
    return this._univerInstanceService.getCurrentUniverDocInstance().getUnitId();
  }
  _getBlank(e) {
    return {
      id: e,
      body: {
        dataStream: `${Bc}`,
        textRuns: [],
        paragraphs: [
          {
            startIndex: 0
          }
        ]
      },
      documentStyle: {
        renderConfig: {
          verticalAlign: xn.TOP,
          horizontalAlign: Ut.LEFT
        },
        marginLeft: 3,
        marginTop: 0,
        marginRight: 3
      }
    };
  }
};
Sr = WA([
  Ot(0, vr),
  Ot(1, ME),
  Ot(2, Inject(m)),
  Ot(3, Nr),
  Ot(4, Ls),
  Ot(5, Qo),
  Ot(6, Inject(Injector))
], Sr);
var Ge2 = createIdentifier("univer.editor.service");
var vr4 = "COMPONENT_DOC_HEADER_FOOTER_PANEL";
function zA(n, e, t8) {
  const {
    useFirstPageHeaderFooter: o,
    evenAndOddHeaders: r,
    defaultHeaderId: s,
    defaultFooterId: i,
    firstPageHeaderId: a,
    firstPageFooterId: c,
    evenPageHeaderId: d,
    evenPageFooterId: l
  } = n;
  return e === d3.HEADER ? o === ie.TRUE ? t8 === 0 ? a : r === ie.TRUE && t8 % 2 === 1 ? d : s : r === ie.TRUE && t8 % 2 === 1 ? d : s : o === ie.TRUE ? t8 === 0 ? c : r === ie.TRUE && t8 % 2 === 1 ? l : i : r === ie.TRUE && t8 % 2 === 1 ? l : i;
}
var GA = (n) => {
  const e = useDependency(Fn), t8 = useDependency(vr), o = useDependency(ME), r = useDependency(Ls), s = useDependency(U1), { unitId: i } = n, a = o.getRenderById(i).with(Re2), [c, d] = (0, import_react3.useState)({}), l = (u, g) => {
    var b2;
    d((y) => ({
      ...y,
      [g]: u ? ie.TRUE : ie.FALSE
    }));
    const f2 = t8.getUniverDocInstance(i), p = f2 == null ? void 0 : f2.getSnapshot().documentStyle, m2 = (b2 = o.getRenderById(i)) == null ? void 0 : b2.with(D), I2 = m2 == null ? void 0 : m2.getViewModel();
    if (p == null || I2 == null)
      return;
    const S = I2.getEditArea();
    let v2 = false;
    const R = a.getSegmentPage();
    let E = false;
    if (g === "useFirstPageHeaderFooter" && u === true && ((S === d3.HEADER && !p.firstPageHeaderId || S === d3.FOOTER && !p.firstPageFooterId) && (v2 = true), v2 && R === 0 && (E = true)), g === "evenAndOddHeaders" && u === true && ((S === d3.HEADER && !p.evenPageHeaderId || S === d3.FOOTER && !p.evenPageFooterId) && (v2 = true), v2 && R % 2 === 1 && (E = true)), v2) {
      const C = et(6);
      E && a.setSegment(C), r.executeCommand($n2, {
        unitId: i,
        segmentId: C,
        headerFooterProps: {
          [g]: u ? ie.TRUE : ie.FALSE
        }
      });
    } else {
      const y = a.getSegmentPage(), C = a.getSegment(), B = zA(
        {
          ...p,
          [g]: u ? ie.TRUE : ie.FALSE
        },
        S,
        y
      );
      B && B !== C && a.setSegment(B), r.executeCommand($n2, {
        unitId: i,
        headerFooterProps: {
          [g]: u ? ie.TRUE : ie.FALSE
        }
      });
    }
    s.focus();
  }, A = async (u, g) => {
    d((f2) => ({
      ...f2,
      [g]: u
    })), await r.executeCommand($n2, {
      unitId: i,
      headerFooterProps: {
        [g]: u
      }
    }), a.removeAllRanges(), a.blur();
  }, h = () => {
    r.executeCommand(Ms2.id, {
      unitId: i
    });
  };
  return (0, import_react3.useEffect)(() => {
    const u = t8.getUniverDocInstance(i), g = u == null ? void 0 : u.getSnapshot().documentStyle;
    if (g) {
      const {
        marginHeader: f2 = 0,
        marginFooter: p = 0,
        useFirstPageHeaderFooter: m2 = ie.FALSE,
        evenAndOddHeaders: I2 = ie.FALSE
      } = g;
      d({
        marginHeader: f2,
        marginFooter: p,
        useFirstPageHeaderFooter: m2,
        evenAndOddHeaders: I2
      });
    }
  }, [i]), (0, import_jsx_runtime3.jsxs)("div", { className: "univer-grid univer-gap-4", children: [
    (0, import_jsx_runtime3.jsxs)("div", { className: "univer-grid univer-gap-2", children: [
      (0, import_jsx_runtime3.jsx)("div", { children: (0, import_jsx_runtime3.jsx)(
        em,
        {
          checked: c.useFirstPageHeaderFooter === ie.TRUE,
          onChange: (u) => {
            l(u, "useFirstPageHeaderFooter");
          },
          children: e.t("headerFooter.firstPageCheckBox")
        }
      ) }),
      (0, import_jsx_runtime3.jsx)("div", { children: (0, import_jsx_runtime3.jsx)(
        em,
        {
          checked: c.evenAndOddHeaders === ie.TRUE,
          onChange: (u) => {
            l(u, "evenAndOddHeaders");
          },
          children: e.t("headerFooter.oddEvenCheckBox")
        }
      ) })
    ] }),
    (0, import_jsx_runtime3.jsxs)("div", { className: "univer-mb-1 univer-flex", children: [
      (0, import_jsx_runtime3.jsxs)("div", { children: [
        (0, import_jsx_runtime3.jsx)("span", { children: e.t("headerFooter.headerTopMargin") }),
        (0, import_jsx_runtime3.jsx)(
          xE2,
          {
            className: "univer-mt-1.5 univer-w-4/5",
            min: 0,
            max: 200,
            precision: 1,
            value: c.marginHeader,
            onChange: (u) => {
              A(u, "marginHeader");
            }
          }
        )
      ] }),
      (0, import_jsx_runtime3.jsxs)("div", { children: [
        (0, import_jsx_runtime3.jsx)("span", { children: e.t("headerFooter.footerBottomMargin") }),
        (0, import_jsx_runtime3.jsx)(
          xE2,
          {
            className: "univer-mt-1.5 univer-w-4/5",
            min: 0,
            max: 200,
            precision: 1,
            value: c.marginFooter,
            onChange: (u) => {
              A(u, "marginFooter");
            }
          }
        )
      ] })
    ] }),
    (0, import_jsx_runtime3.jsx)("div", { className: "univer-flex univer-justify-end", children: (0, import_jsx_runtime3.jsx)(vr2, { onClick: h, children: e.t("headerFooter.closeHeaderFooter") }) })
  ] });
};
var YA = () => {
  var d;
  const n = useDependency(Fn), e = useDependency(ME), r = useDependency(vr).getCurrentUniverDocInstance().getUnitId(), i = ((d = e.getRenderById(r)) == null ? void 0 : d.with(D)).getViewModel(), [a, c] = (0, import_react3.useState)(true);
  return (0, import_react3.useEffect)(() => {
    const l = i.getEditArea();
    c(l !== d3.BODY);
    const A = i.editAreaChange$.subscribe((h) => {
      h != null && c(h !== d3.BODY);
    });
    return () => {
      A.unsubscribe();
    };
  }, []), (0, import_jsx_runtime3.jsx)("div", { className: "univer-text-sm", children: a ? (0, import_jsx_runtime3.jsx)(GA, { unitId: r }) : (0, import_jsx_runtime3.jsx)("div", { className: "univer-text-gray-400", children: n.t("headerFooter.disableText") }) });
};
var Ii2 = 18;
var Si2 = 200;
var er2 = 6;
var KA = 4;
function qA(n, e) {
  let { radius: t8, width: o, height: r } = e;
  t8 = t8 != null ? t8 : 0, o = o != null ? o : 30, r = r != null ? r : 30;
  let s = 0;
  s = Math.min(t8, o / 2, r / 2), n.beginPath(), n.moveTo(0, 0), n.lineTo(o, 0), n.lineTo(o, r - s), n.arc(o - s, r - s, s, 0, Math.PI / 2, false), n.lineTo(0, r), n.lineTo(0, 0), n.closePath(), e.fill && (n.save(), n.fillStyle = e.fill, e.fillRule === "evenodd" ? n.fill("evenodd") : n.fill(), n.restore());
}
var ao3 = class _ao extends x3 {
  constructor(t8, o) {
    super(t8, o);
    O(this, "color");
    O(this, "text");
    this.color = o == null ? void 0 : o.color, this.text = o == null ? void 0 : o.text;
  }
  static drawWith(t8, o) {
    const { text: r, color: s } = o;
    t8.save(), t8.font = "13px Source Han Sans CN";
    const i = t8.measureText(r).width, a = Math.min(
      i + 2 * er2,
      Si2
    );
    qA(t8, {
      height: Ii2,
      width: a,
      radius: 4,
      fill: s
    }), t8.fillStyle = "rgba(58, 96, 247, 1)";
    const c = er2, d = Ii2 - KA, l = Si2 - 2 * er2;
    if (i > l) {
      let A = "", h = 0;
      for (const u of r) {
        const g = t8.measureText(u).width;
        if (h + g <= l - t8.measureText("...").width)
          A += u, h += g;
        else {
          A += "...";
          break;
        }
      }
      t8.fillText(A, c, d);
    } else
      t8.fillText(r, c, d);
    t8.restore();
  }
  _draw(t8) {
    _ao.drawWith(t8, this);
  }
};
var XA = Object.getOwnPropertyDescriptor;
var ZA = (n, e, t8, o) => {
  for (var r = o > 1 ? void 0 : o ? XA(e, t8) : e, s = n.length - 1, i; s >= 0; s--)
    (i = n[s]) && (r = i(r) || r);
  return r;
};
var ut2 = (n, e) => (t8, o) => e(t8, o, n);
var vi2 = "rgba(58, 96, 247, 1)";
var Ci2 = "rgba(58, 96, 247, 0.08)";
var Qe2 = ((n) => (n[n.FIRST_PAGE_HEADER = 0] = "FIRST_PAGE_HEADER", n[n.FIRST_PAGE_FOOTER = 1] = "FIRST_PAGE_FOOTER", n[n.DEFAULT_HEADER = 2] = "DEFAULT_HEADER", n[n.DEFAULT_FOOTER = 3] = "DEFAULT_FOOTER", n[n.EVEN_PAGE_HEADER = 4] = "EVEN_PAGE_HEADER", n[n.EVEN_PAGE_FOOTER = 5] = "EVEN_PAGE_FOOTER", n))(Qe2 || {});
function JA(n, e, t8) {
  const { documentStyle: o } = n.getDataModel().getSnapshot(), {
    defaultHeaderId: r,
    defaultFooterId: s,
    evenPageHeaderId: i,
    evenPageFooterId: a,
    firstPageHeaderId: c,
    firstPageFooterId: d,
    evenAndOddHeaders: l,
    useFirstPageHeaderFooter: A
  } = o;
  switch (e) {
    case d3.BODY:
      return {
        createType: null,
        headerFooterId: null
      };
    case d3.HEADER:
      return A === ie.TRUE && !c ? {
        createType: 0,
        headerFooterId: null
      } : l === ie.TRUE && t8 % 2 === 0 && !i ? {
        createType: 4,
        headerFooterId: null
      } : r ? {
        createType: null,
        headerFooterId: r
      } : {
        createType: 2,
        headerFooterId: null
      };
    case d3.FOOTER:
      return A === ie.TRUE && !d ? {
        createType: 1,
        headerFooterId: null
      } : l === ie.TRUE && t8 % 2 === 0 && !a ? {
        createType: 5,
        headerFooterId: null
      } : s ? {
        createType: null,
        headerFooterId: s
      } : {
        createType: 3,
        headerFooterId: null
      };
    default:
      throw new Error(`Invalid editArea: ${e}`);
  }
}
var Cr2 = class extends Ve {
  constructor(e, t8, o, r, s, i, a, c, d) {
    super();
    O(this, "_loadedMap", /* @__PURE__ */ new WeakSet());
    this._context = e, this._commandService = t8, this._editorService = o, this._instanceSrv = r, this._renderManagerService = s, this._docSkeletonManagerService = i, this._docSelectionRenderService = a, this._localeService = c, this._componentManager = d, this._initialize();
  }
  _initialize() {
    this._init(), this._drawHeaderFooterLabel(), this._initCustomComponents(), this._listenSwitchMode();
  }
  dispose() {
    super.dispose();
  }
  // Close header footer panel when switch mode.
  _listenSwitchMode() {
    this.disposeWithMe(
      this._commandService.onCommandExecuted((e) => {
        if (M.id === e.id) {
          const t8 = this._context.unit, r = this._docSkeletonManagerService.getViewModel().getEditArea(), s = t8.getSnapshot().documentStyle.documentFlavor;
          r !== d3.BODY && s === uu.MODERN && this._commandService.executeCommand(Ms2.id, {
            unitId: this._context.unitId
          });
        }
      })
    );
  }
  _initCustomComponents() {
    this._componentManager.get(vr4) || this.disposeWithMe(this._componentManager.register(vr4, YA));
  }
  _init() {
    const { unitId: e } = this._context, t8 = pt2(this._context);
    t8 == null || t8.document == null || this._loadedMap.has(t8.document) || (this._initialMain(e), this._loadedMap.add(t8.document));
  }
  _initialMain(e) {
    const t8 = pt2(this._context), { document: o } = t8;
    this.disposeWithMe(o.onDblclick$.subscribeEvent(async (r) => {
      if (this._isEditorReadOnly(e) || !this._isTraditionalMode())
        return;
      const { offsetX: s, offsetY: i } = r, {
        pageLayoutType: a = Q2.VERTICAL,
        pageMarginLeft: c,
        pageMarginTop: d
      } = o.getOffsetConfig(), l = this._getTransformCoordForDocumentOffset(s, i);
      if (l == null)
        return;
      const A = this._docSkeletonManagerService.getViewModel(), h = this._docSkeletonManagerService.getSkeleton(), u = A.getEditArea(), { editArea: g, pageNumber: f2 } = h.findEditAreaByCoord(
        l,
        a,
        c,
        d
      );
      if (u === g)
        return;
      A.setEditArea(g);
      const { createType: p, headerFooterId: m2 } = JA(A, g, f2);
      if (g === d3.BODY)
        this._docSelectionRenderService.setSegment(""), this._docSelectionRenderService.setSegmentPage(-1), this._docSelectionRenderService.setCursorManually(s, i);
      else if (p != null) {
        const S = et(6);
        this._docSelectionRenderService.setSegment(S), this._docSelectionRenderService.setSegmentPage(f2), await this._commandService.executeCommand(Ac.id, {
          unitId: e,
          createType: p,
          segmentId: S
        });
      } else m2 != null && (this._docSelectionRenderService.setSegment(m2), this._docSelectionRenderService.setSegmentPage(f2), this._docSelectionRenderService.setCursorManually(s, i));
    }));
  }
  _getTransformCoordForDocumentOffset(e, t8) {
    const o = pt2(this._context), { document: r, scene: s } = o, { documentTransform: i } = r.getOffsetConfig(), a = s.getViewports()[0];
    if (a == null)
      return;
    const c = a.transformVector2SceneCoord(U.FromArray([e, t8]));
    return i.clone().invert().applyPoint(c);
  }
  // eslint-disable-next-line max-lines-per-function
  _drawHeaderFooterLabel() {
    const e = this._localeService;
    this.disposeWithMe(
      this._instanceSrv.getCurrentTypeOfUnit$(we.UNIVER_DOC).subscribe((t8) => {
        if (t8 == null)
          return;
        const o = t8.getUnitId(), r = this._renderManagerService.getRenderById(o);
        if (this._editorService.isEditor(o) || this._instanceSrv.getUniverDocInstance(o) == null || r == null)
          return;
        const { mainComponent: s } = r, i = s;
        this.disposeWithMe(
          We(
            // eslint-disable-next-line max-lines-per-function
            i.pageRender$.subscribe((a) => {
              if (this._editorService.isEditor(o) || !this._isTraditionalMode())
                return;
              const l = this._docSkeletonManagerService.getViewModel().getEditArea() === d3.BODY, { page: A, pageLeft: h, pageTop: u, ctx: g } = a, { pageWidth: f2, pageHeight: p, marginTop: m2, marginBottom: I2 } = A;
              if (g.save(), g.translate(h - 0.5, u - 0.5), l ? (I12.drawWith(g, {
                left: 0,
                top: 0,
                width: f2,
                height: m2,
                fill: "rgba(255, 255, 255, 0.5)"
              }), g.save(), g.translate(0, p - I2), I12.drawWith(g, {
                left: 0,
                top: 0,
                width: f2,
                height: I2,
                fill: "rgba(255, 255, 255, 0.5)"
              }), g.restore()) : (g.save(), g.translate(0, m2), I12.drawWith(g, {
                left: 0,
                top: m2,
                width: f2,
                height: p - m2 - I2,
                fill: "rgba(255, 255, 255, 0.5)"
              }), g.restore()), !l) {
                const S = {
                  dataArray: [{
                    command: "M",
                    points: [0, m2]
                  }, {
                    command: "L",
                    points: [f2, m2]
                  }],
                  strokeWidth: 1,
                  stroke: vi2
                }, v2 = {
                  dataArray: [{
                    command: "M",
                    points: [0, p - I2]
                  }, {
                    command: "L",
                    points: [f2, p - I2]
                  }],
                  strokeWidth: 1,
                  stroke: vi2
                };
                X1.drawWith(g, S), X1.drawWith(g, v2), g.translate(0, m2 + 1), ao3.drawWith(g, {
                  text: e.t("headerFooter.header"),
                  color: Ci2
                }), g.translate(0, p - m2 - I2), ao3.drawWith(g, {
                  text: e.t("headerFooter.footer"),
                  color: Ci2
                });
              }
              g.restore();
            })
          )
        );
      })
    );
  }
  _isEditorReadOnly(e) {
    const t8 = this._editorService.getEditor(e);
    return t8 ? t8.isReadOnly() : false;
  }
  _isTraditionalMode() {
    return this._context.unit.getSnapshot().documentStyle.documentFlavor === uu.TRADITIONAL;
  }
};
Cr2 = ZA([
  ut2(1, Ls),
  ut2(2, Ge2),
  ut2(3, vr),
  ut2(4, ME),
  ut2(5, Inject(D)),
  ut2(6, Inject(Re2)),
  ut2(7, Inject(Fn)),
  ut2(8, Inject(S1))
], Cr2);
var Ts2 = {
  id: "sidebar.operation.doc-header-footer-panel",
  type: Ms.OPERATION,
  handler: async (n, e) => {
    const t8 = n.get(we3), o = n.get(Fn);
    switch (e.value) {
      case "open":
        t8.open({
          header: { title: o.t("headerFooter.panel") },
          children: { label: vr4 },
          onClose: () => {
          },
          width: 400
        });
        break;
      case "close":
      default:
        t8.close();
        break;
    }
    return true;
  }
};
function Ri() {
  return {
    dataStream: `\r
`,
    textRuns: [{
      st: 0,
      ed: 0,
      ts: {
        fs: 9
        // The default header footer text size.
      }
    }],
    customBlocks: [],
    paragraphs: [
      {
        startIndex: 0,
        paragraphStyle: {
          spaceAbove: { v: 0 },
          lineSpacing: 1.5,
          spaceBelow: { v: 0 }
        }
      }
    ],
    sectionBreaks: [
      {
        startIndex: 1
      }
    ]
  };
}
function tr2(n, e, t8, o) {
  const r = Qt.getInstance(), s = 6, i = n != null ? n : et(s), a = e === Qe2.DEFAULT_HEADER || e === Qe2.FIRST_PAGE_HEADER || e === Qe2.EVEN_PAGE_HEADER, c = r.insertOp([a ? "headers" : "footers", i], {
    [a ? "headerId" : "footerId"]: i,
    body: Ri()
  });
  o.push(c);
  const d = et(s), l = r.insertOp([a ? "footers" : "headers", d], {
    [a ? "footerId" : "headerId"]: d,
    body: Ri()
  });
  o.push(l);
  let A = "defaultHeaderId", h = "defaultFooterId";
  switch (e) {
    case Qe2.DEFAULT_HEADER:
      A = "defaultHeaderId", h = "defaultFooterId";
      break;
    case Qe2.DEFAULT_FOOTER:
      A = "defaultFooterId", h = "defaultHeaderId";
      break;
    case Qe2.FIRST_PAGE_HEADER:
      A = "firstPageHeaderId", h = "firstPageFooterId";
      break;
    case Qe2.FIRST_PAGE_FOOTER:
      A = "firstPageFooterId", h = "firstPageHeaderId";
      break;
    case Qe2.EVEN_PAGE_HEADER:
      A = "evenPageHeaderId", h = "evenPageFooterId";
      break;
    case Qe2.EVEN_PAGE_FOOTER:
      A = "evenPageFooterId", h = "evenPageHeaderId";
      break;
    default:
      throw new Error(`Unknown header footer type: ${e}`);
  }
  for (const [u, g] of [[A, i], [h, d]])
    if (t8[u] != null) {
      const f2 = r.replaceOp(["documentStyle", u], t8[u], g);
      o.push(f2);
    } else {
      const f2 = r.insertOp(["documentStyle", u], g);
      o.push(f2);
    }
  return o;
}
var $n2 = "doc.command.core-header-footer";
var Ac = {
  id: $n2,
  type: Ms.COMMAND,
  // eslint-disable-next-line max-lines-per-function
  handler: async (n, e) => {
    var v2;
    const t8 = n.get(Ls), o = n.get(vr), r = n.get(ME), { unitId: s, segmentId: i, createType: a, headerFooterProps: c } = e, d = (v2 = r.getRenderById(s)) == null ? void 0 : v2.with(D), l = o.getUniverDocInstance(s), A = d == null ? void 0 : d.getViewModel();
    if (l == null || A == null)
      return false;
    const h = A.getEditArea(), { documentStyle: u } = l.getSnapshot(), g = (c == null ? void 0 : c.marginFooter) != null || (c == null ? void 0 : c.marginHeader) != null, f2 = [{
      startOffset: 0,
      endOffset: 0,
      collapsed: true
    }], p = {
      id: M.id,
      params: {
        unitId: s,
        actions: [],
        textRanges: f2,
        debounce: true
      }
    };
    g && (p.params.noNeedSetTextRange = true);
    const m2 = Qt.getInstance(), I2 = [];
    return a != null && tr2(i, a, u, I2), c != null && Object.keys(c).forEach((R) => {
      const E = c[R], b2 = u[R];
      if (E === b2)
        return;
      let y;
      if (b2 === void 0 ? y = m2.insertOp(["documentStyle", R], E) : y = m2.replaceOp(["documentStyle", R], b2, E), I2.push(y), R === "useFirstPageHeaderFooter" && E === ie.TRUE && !u.firstPageHeaderId) {
        const C = h === d3.HEADER ? Qe2.FIRST_PAGE_HEADER : Qe2.FIRST_PAGE_FOOTER;
        tr2(i, C, u, I2);
      } else if (R === "evenAndOddHeaders" && E === ie.TRUE && !u.evenPageHeaderId) {
        const C = h === d3.HEADER ? Qe2.EVEN_PAGE_HEADER : Qe2.EVEN_PAGE_FOOTER;
        tr2(i, C, u, I2);
      }
    }), I2.length === 0 ? false : (p.params.actions = I2.reduce((R, E) => Qt.compose(R, E), null), !!t8.syncExecuteCommand(p.id, p.params));
  }
};
var Bs2 = {
  id: "doc.command.open-header-footer-panel",
  type: Ms.COMMAND,
  handler: async (n, e) => n.get(Ls).executeCommand(Ts2.id, { value: "open" })
};
var Ms2 = {
  id: "doc.command.close-header-footer",
  type: Ms.COMMAND,
  handler: async (n, e) => {
    var g;
    const t8 = n.get(Ls), o = n.get(ME), r = n.get(m), s = n.get(vr), { unitId: i } = e, a = o.getRenderById(i);
    if (a == null)
      return false;
    const { scene: c } = a, d = c.getTransformerByCreate(), l = a.with(D), A = a.with(Re2), h = l == null ? void 0 : l.getSkeleton(), u = l == null ? void 0 : l.getViewModel();
    return u == null || h == null ? false : (r.replaceDocRanges([]), d.clearSelectedObjects(), A.setSegment(""), A.setSegmentPage(-1), u.setEditArea(d3.BODY), h.calculate(), (g = a.mainComponent) == null || g.makeDirty(true), queueMicrotask(() => {
      const f2 = s.getUnit(i), p = f2 == null ? void 0 : f2.getSnapshot();
      if (p == null)
        return;
      const m2 = dc(p);
      r.replaceDocRanges([
        {
          startOffset: m2,
          endOffset: m2
        }
      ]);
    }), t8.executeCommand(Ts2.id, { value: "close" }), true);
  }
};
var uc = "UI_PLUGIN_DOCS";
var hc2 = (n) => {
  const { value: e, onChange: t8, options: o } = n;
  return (0, import_jsx_runtime3.jsx)("div", { className: "univer-grid univer-grid-cols-3 univer-gap-2 univer-p-1.5", children: o.map((r) => (0, import_jsx_runtime3.jsx)(
    "a",
    {
      className: ie2("univer-block univer-h-20 univer-w-[72px] univer-cursor-pointer univer-overflow-hidden univer-rounded univer-transition-all hover:univer-border-primary-500", kt2, {
        "univer-border-primary-500": e === r.value
      }),
      onClick: () => {
        t8(r.value);
      },
      children: (0, import_jsx_runtime3.jsx)(
        "img",
        {
          className: "univer-size-full",
          src: r.img,
          draggable: false
        }
      )
    },
    r.value
  )) });
};
var $A = [
  {
    value: zt.ORDER_LIST,
    img: "data:image/jpeg;base64,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"
  },
  {
    value: zt.ORDER_LIST_1,
    img: "data:image/jpeg;base64,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"
  },
  {
    value: zt.ORDER_LIST_2,
    img: "data:image/jpeg;base64,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"
  },
  {
    value: zt.ORDER_LIST_3,
    img: "data:image/jpeg;base64,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"
  },
  {
    value: zt.ORDER_LIST_4,
    img: "data:image/jpeg;base64,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"
  },
  {
    value: zt.ORDER_LIST_5,
    img: "data:image/jpeg;base64,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"
  }
];
var eu = (n) => (0, import_jsx_runtime3.jsx)(
  hc2,
  {
    ...n,
    options: $A
  }
);
var tu = [
  {
    value: zt.BULLET_LIST,
    img: "data:image/jpeg;base64,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"
  },
  {
    value: zt.BULLET_LIST_1,
    img: "data:image/jpeg;base64,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"
  },
  {
    value: zt.BULLET_LIST_2,
    img: "data:image/jpeg;base64,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"
  },
  {
    value: zt.BULLET_LIST_3,
    img: "data:image/jpeg;base64,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"
  },
  {
    value: zt.BULLET_LIST_4,
    img: "data:image/jpeg;base64,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"
  },
  {
    value: zt.BULLET_LIST_5,
    img: "data:image/jpeg;base64,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"
  }
];
var nu = (n) => (0, import_jsx_runtime3.jsx)(
  hc2,
  {
    ...n,
    options: tu
  }
);
var gc2 = `${uc}_ORDER_LIST_TYPE_COMPONENT`;
var fc2 = `${uc}_BULLET_LIST_TYPE_COMPONENT`;
var ou = (n) => {
  const t8 = Object.keys(mR).find((o) => {
    const { width: r, height: s } = mR[o];
    return n.width === r && n.height === s;
  });
  return t8 != null ? t8 : "A4";
};
function ru(n) {
  const { hooks: e } = n, r = useDependency(vr).getCurrentUnitOfType(we.UNIVER_DOC).getDocumentStyle(), s = useDependency(Fn), [i, a] = (0, import_react3.useState)(() => {
    var l, A, h, u, g;
    return {
      paperSize: ou(r.pageSize),
      orientation: (l = r.pageOrient) != null ? l : eg.PORTRAIT,
      margins: {
        top: (A = r.marginTop) != null ? A : 0,
        bottom: (h = r.marginBottom) != null ? h : 0,
        left: (u = r.marginLeft) != null ? u : 0,
        right: (g = r.marginRight) != null ? g : 0
      }
    };
  });
  (0, import_react3.useEffect)(() => {
    e.beforeClose = () => i, e.beforeConfirm = () => i;
  }, [i]);
  const c = (l) => {
    a((A) => ({ ...A, paperSize: l }));
  }, d = (l, A) => {
    a((h) => ({
      ...h,
      margins: {
        ...h.margins,
        [l]: A || 0
      }
    }));
  };
  return (0, import_jsx_runtime3.jsxs)("div", { className: "univer-flex univer-flex-col univer-gap-4", children: [
    (0, import_jsx_runtime3.jsxs)("div", { className: "univer-flex univer-flex-col univer-gap-2", children: [
      (0, import_jsx_runtime3.jsx)(
        "label",
        {
          className: "univer-text-sm univer-font-medium univer-text-gray-900 dark:!univer-text-white",
          children: s.t("page-settings.paper-size")
        }
      ),
      (0, import_jsx_runtime3.jsx)(
        LE,
        {
          value: i.paperSize,
          onChange: c,
          options: _1.map((l) => ({
            label: s.t(`page-settings.page-size.${l.toLocaleLowerCase()}`),
            value: l
          }))
        }
      )
    ] }),
    (0, import_jsx_runtime3.jsxs)("div", { className: "univer-flex univer-flex-col univer-gap-2", children: [
      (0, import_jsx_runtime3.jsx)(
        "label",
        {
          className: "univer-text-sm univer-font-medium univer-text-gray-900 dark:!univer-text-white",
          children: s.t("page-settings.custom-paper-size")
        }
      ),
      (0, import_jsx_runtime3.jsxs)("div", { className: "univer-flex univer-flex-col univer-gap-2.5", children: [
        (0, import_jsx_runtime3.jsxs)("div", { className: "univer-flex univer-gap-2.5", children: [
          (0, import_jsx_runtime3.jsxs)("div", { className: "univer-flex univer-flex-1 univer-flex-col univer-gap-2", children: [
            (0, import_jsx_runtime3.jsx)("label", { className: "univer-text-sm univer-font-medium univer-text-gray-500", children: s.t("page-settings.top") }),
            (0, import_jsx_runtime3.jsx)(
              xE2,
              {
                value: i.margins.top,
                onChange: (l) => d("top", l)
              }
            )
          ] }),
          (0, import_jsx_runtime3.jsxs)("div", { className: "univer-flex univer-flex-1 univer-flex-col univer-gap-2", children: [
            (0, import_jsx_runtime3.jsx)("label", { className: "univer-text-sm univer-font-medium univer-text-gray-500", children: s.t("page-settings.bottom") }),
            (0, import_jsx_runtime3.jsx)(
              xE2,
              {
                value: i.margins.bottom,
                onChange: (l) => d("bottom", l)
              }
            )
          ] })
        ] }),
        (0, import_jsx_runtime3.jsxs)("div", { className: "univer-flex univer-gap-2.5", children: [
          (0, import_jsx_runtime3.jsxs)("div", { className: "univer-flex univer-flex-1 univer-flex-col univer-gap-2", children: [
            (0, import_jsx_runtime3.jsx)("label", { className: "univer-text-sm univer-font-medium univer-text-gray-500", children: s.t("page-settings.left") }),
            (0, import_jsx_runtime3.jsx)(
              xE2,
              {
                value: i.margins.left,
                onChange: (l) => d("left", l)
              }
            )
          ] }),
          (0, import_jsx_runtime3.jsxs)("div", { className: "univer-flex univer-flex-1 univer-flex-col univer-gap-2", children: [
            (0, import_jsx_runtime3.jsx)("label", { className: "univer-text-sm univer-font-medium univer-text-gray-500", children: s.t("page-settings.right") }),
            (0, import_jsx_runtime3.jsx)(
              xE2,
              {
                value: i.margins.right,
                onChange: (l) => d("right", l)
              }
            )
          ] })
        ] })
      ] })
    ] })
  ] });
}
var Rr2 = "docs.component.page-setting";
var pc2 = {
  id: "docs.command.page-setup",
  type: Ms.COMMAND,
  // eslint-disable-next-line complexity, max-lines-per-function
  handler: (n, e) => {
    if (!e) return false;
    const t8 = n.get(vr), o = n.get(Ls), r = t8.getCurrentUnitOfType(we.UNIVER_DOC);
    if (!r) return false;
    const { marginLeft: s, marginRight: i, marginBottom: a, marginTop: c, pageOrient: d, pageSize: l } = e, A = Qt.getInstance(), h = r.getDocumentStyle(), {
      marginBottom: u,
      marginLeft: g,
      marginRight: f2,
      marginTop: p,
      pageOrient: m2,
      pageSize: I2
    } = h, S = [];
    if (u === void 0) {
      const E = A.insertOp(["documentStyle", "marginBottom"], a);
      E && S.push(E);
    } else {
      const E = A.replaceOp(["documentStyle", "marginBottom"], u, a);
      E && S.push(E);
    }
    if (g === void 0) {
      const E = A.insertOp(["documentStyle", "marginLeft"], s);
      E && S.push(E);
    } else {
      const E = A.replaceOp(["documentStyle", "marginLeft"], g, s);
      E && S.push(E);
    }
    if (f2 === void 0) {
      const E = A.insertOp(["documentStyle", "marginRight"], i);
      E && S.push(E);
    } else {
      const E = A.replaceOp(["documentStyle", "marginRight"], f2, i);
      E && S.push(E);
    }
    if (p === void 0) {
      const E = A.insertOp(["documentStyle", "marginTop"], c);
      E && S.push(E);
    } else {
      const E = A.replaceOp(["documentStyle", "marginTop"], p, c);
      E && S.push(E);
    }
    if (I2 === void 0) {
      const E = A.insertOp(["documentStyle", "pageSize"], l);
      E && S.push(E);
    } else {
      const E = A.replaceOp(["documentStyle", "pageSize"], I2, l);
      E && S.push(E);
    }
    if (m2 === void 0) {
      const E = A.insertOp(["documentStyle", "pageOrient"], d);
      E && S.push(E);
    } else {
      const E = A.replaceOp(["documentStyle", "pageOrient"], m2, d);
      E && S.push(E);
    }
    const v2 = {
      id: M.id,
      params: {
        unitId: r.getUnitId(),
        actions: [],
        textRanges: void 0
      }
    };
    return v2.params.actions = S.reduce((E, b2) => Qt.compose(E, b2), null), !!o.syncExecuteCommand(v2.id, v2.params);
  }
};
var _s = {
  id: "docs.operation.open-page-setting",
  type: Ms.OPERATION,
  handler: (n) => {
    const e = n.get(at), t8 = n.get(Ls), o = n.get(Fn), r = e.open({
      id: Rr2,
      title: {
        label: o.t("page-settings.document-setting")
      },
      children: {
        label: Rr2
      },
      width: 528,
      onClose: () => {
        r.dispose();
      },
      onConfirm: (s) => {
        if (r.dispose(), !s) return;
        const i = mR[s.paperSize];
        t8.executeCommand(pc2.id, {
          pageOrient: s.orientation,
          marginTop: s.margins.top,
          marginBottom: s.margins.bottom,
          marginLeft: s.margins.left,
          marginRight: s.margins.right,
          pageSize: i
        });
      },
      confirmText: o.t("page-settings.confirm"),
      cancelText: o.t("page-settings.cancel")
    });
    return true;
  }
};
function su(n) {
  const e = n.get(vr), t8 = n.get(ME);
  return new Observable((o) => {
    const r = e.focused$.subscribe((s) => {
      if (s == null || e.getUnitType(s) !== we.UNIVER_DOC)
        return o.next(true);
      const a = t8.getRenderById(s);
      if (a == null)
        return o.next(true);
      a.with(D).getViewModel().editAreaChange$.subscribe((d) => {
        o.next(d === d3.HEADER || d === d3.FOOTER);
      });
    });
    return () => r.unsubscribe();
  });
}
function iu(n) {
  const e = n.get(vr), t8 = n.get(Ls);
  return new Observable((o) => {
    const r = t8.onCommandExecuted((c) => {
      if (c.id === M.id) {
        const { unitId: d } = c.params, l = e.getUnit(d);
        if (l == null) {
          o.next(true);
          return;
        }
        const { documentStyle: A } = l.getSnapshot();
        o.next((A == null ? void 0 : A.documentFlavor) !== uu.TRADITIONAL);
      }
    }), s = e.focused$.subscribe((c) => {
      if (c == null)
        return o.next(true);
      const d = e.getUniverDocInstance(c), l = d == null ? void 0 : d.getSnapshot().documentStyle.documentFlavor;
      o.next(l !== uu.TRADITIONAL);
    }), i = e.getCurrentUniverDocInstance();
    if (i == null)
      return o.next(true);
    const a = i == null ? void 0 : i.getSnapshot().documentStyle.documentFlavor;
    return o.next(a !== uu.TRADITIONAL), () => {
      r.dispose(), s.unsubscribe();
    };
  });
}
function au(n) {
  const e = n.get(m), t8 = n.get(vr);
  return new Observable((o) => {
    const r = e.textSelection$.subscribe((s) => {
      if (s == null) {
        o.next(true);
        return;
      }
      const { textRanges: i } = s;
      if (i.length !== 1) {
        o.next(true);
        return;
      }
      const a = i[0], { collapsed: c, startNodePosition: d, startOffset: l } = a;
      if (!c || l == null) {
        o.next(true);
        return;
      }
      const A = t8.getCurrentUniverDocInstance();
      if (A == null) {
        o.next(true);
        return;
      }
      const h = Ke2(n, A.getUnitId());
      if (h == null) {
        o.next(true);
        return;
      }
      if (h.getViewModel().getCustomRangeRaw(l)) {
        o.next(true);
        return;
      }
      if (d != null) {
        const { path: f2 } = d;
        if (f2.indexOf("cells") !== -1) {
          o.next(true);
          return;
        }
      }
      o.next(false);
    });
    return () => r.unsubscribe();
  });
}
function xe2(n) {
  const e = n.get(m);
  return new Observable((t8) => {
    const o = e.textSelection$.subscribe((r) => {
      if (r == null) {
        t8.next(true);
        return;
      }
      const { textRanges: s, rectRanges: i } = r;
      if (s.length === 0 && i.length === 0) {
        t8.next(true);
        return;
      }
      t8.next(false);
    });
    return () => o.unsubscribe();
  });
}
function cu(n) {
  const e = n.get(Ls);
  return {
    id: Lt2.id,
    type: H1.BUTTON,
    icon: "BoldIcon",
    title: "Set bold",
    tooltip: "toolbar.bold",
    activated$: new Observable((t8) => {
      const o = () => {
        var a;
        const s = ot3(n);
        if (s == null) {
          t8.next(false);
          return;
        }
        const i = (a = s.ts) == null ? void 0 : a.bl;
        t8.next(i === ie.TRUE);
      }, r = e.onCommandExecuted((s) => {
        const i = s.id;
        (i === k.id || i === yt2.id) && o();
      });
      return o(), r.dispose;
    }),
    disabled$: xe2(n),
    hidden$: Bi(n, we.UNIVER_DOC)
  };
}
function lu(n) {
  const e = n.get(Ls);
  return {
    id: Qt5.id,
    type: H1.BUTTON,
    icon: "ItalicIcon",
    title: "Set italic",
    tooltip: "toolbar.italic",
    activated$: new Observable((t8) => {
      const o = () => {
        var a;
        const s = ot3(n);
        if (s == null) {
          t8.next(false);
          return;
        }
        const i = (a = s.ts) == null ? void 0 : a.it;
        t8.next(i === ie.TRUE);
      }, r = e.onCommandExecuted((s) => {
        const i = s.id;
        (i === k.id || i === yt2.id) && o();
      });
      return o(), r.dispose;
    }),
    disabled$: xe2(n),
    hidden$: Bi(n, we.UNIVER_DOC)
  };
}
function du(n) {
  const e = n.get(Ls);
  return {
    id: Ut3.id,
    type: H1.BUTTON,
    icon: "UnderlineIcon",
    title: "Set underline",
    tooltip: "toolbar.underline",
    activated$: new Observable((t8) => {
      const o = () => {
        var a;
        const s = ot3(n);
        if (s == null) {
          t8.next(false);
          return;
        }
        const i = (a = s.ts) == null ? void 0 : a.ul;
        t8.next((i == null ? void 0 : i.s) === ie.TRUE);
      }, r = e.onCommandExecuted((s) => {
        const i = s.id;
        (i === k.id || i === yt2.id) && o();
      });
      return o(), r.dispose;
    }),
    disabled$: xe2(n),
    hidden$: Bi(n, we.UNIVER_DOC)
  };
}
function Au(n) {
  const e = n.get(Ls);
  return {
    id: Ft4.id,
    type: H1.BUTTON,
    icon: "StrikethroughIcon",
    title: "Set strike through",
    tooltip: "toolbar.strikethrough",
    activated$: new Observable((t8) => {
      const o = () => {
        var a;
        const s = ot3(n);
        if (s == null) {
          t8.next(false);
          return;
        }
        const i = (a = s.ts) == null ? void 0 : a.st;
        t8.next((i == null ? void 0 : i.s) === ie.TRUE);
      }, r = e.onCommandExecuted((s) => {
        const i = s.id;
        (i === k.id || i === yt2.id) && o();
      });
      return o(), r.dispose;
    }),
    disabled$: xe2(n),
    hidden$: Bi(n, we.UNIVER_DOC)
  };
}
function uu2(n) {
  const e = n.get(Ls);
  return {
    id: bt3.id,
    type: H1.BUTTON,
    icon: "SubscriptIcon",
    tooltip: "toolbar.subscript",
    activated$: new Observable((t8) => {
      const o = () => {
        var a;
        const s = ot3(n);
        if (s == null) {
          t8.next(false);
          return;
        }
        const i = (a = s.ts) == null ? void 0 : a.va;
        t8.next(i === Zt.SUBSCRIPT);
      }, r = e.onCommandExecuted((s) => {
        const i = s.id;
        (i === k.id || i === yt2.id) && o();
      });
      return o(), r.dispose;
    }),
    disabled$: xe2(n),
    hidden$: Bi(n, we.UNIVER_DOC)
  };
}
function hu(n) {
  const e = n.get(Ls);
  return {
    id: Ht2.id,
    type: H1.BUTTON,
    icon: "SuperscriptIcon",
    tooltip: "toolbar.superscript",
    activated$: new Observable((t8) => {
      const o = () => {
        var a;
        const s = ot3(n);
        if (s == null) {
          t8.next(false);
          return;
        }
        const i = (a = s.ts) == null ? void 0 : a.va;
        t8.next(i === Zt.SUPERSCRIPT);
      }, r = e.onCommandExecuted((s) => {
        const i = s.id;
        (i === k.id || i === yt2.id) && o();
      });
      return o(), r.dispose;
    }),
    disabled$: xe2(n),
    hidden$: Bi(n, we.UNIVER_DOC)
  };
}
function gu(n) {
  const e = n.get(Ls);
  return {
    id: en3.id,
    tooltip: "toolbar.font",
    type: H1.SELECTOR,
    label: w5,
    selections: ki.map((t8) => ({
      label: {
        name: _5
      },
      value: t8.value
    })),
    // disabled$: getCurrentSheetDisabled$(accessor),
    value$: new Observable((t8) => {
      const o = rt.ff, r = () => {
        var c;
        const i = ot3(n);
        if (i == null) {
          t8.next(o);
          return;
        }
        const a = (c = i.ts) == null ? void 0 : c.ff;
        t8.next(a != null ? a : o);
      }, s = e.onCommandExecuted((i) => {
        const a = i.id;
        (a === k.id || a === en3.id) && r();
      });
      return r(), s.dispose;
    }),
    disabled$: xe2(n),
    hidden$: Bi(n, we.UNIVER_DOC)
  };
}
function fu(n) {
  const e = n.get(Ls);
  return {
    id: ct3.id,
    type: H1.SELECTOR,
    tooltip: "toolbar.fontSize",
    label: {
      name: M5,
      props: {
        min: 1,
        max: 400
        // disabled$,
      }
    },
    selections: ji,
    // disabled$,
    value$: new Observable((t8) => {
      const o = rt.fs, r = () => {
        var c;
        const i = ot3(n);
        if (i == null) {
          t8.next(o);
          return;
        }
        const a = (c = i.ts) == null ? void 0 : c.fs;
        t8.next(a != null ? a : o);
      }, s = e.onCommandExecuted((i) => {
        const a = i.id;
        (a === k.id || a === ct3.id) && r();
      });
      return r(), s.dispose;
    }),
    disabled$: xe2(n),
    hidden$: Bi(n, we.UNIVER_DOC)
  };
}
function pu(n) {
  const e = n.get(Ls);
  return {
    id: Xe3.id,
    type: H1.SELECTOR,
    tooltip: "toolbar.heading.tooltip",
    label: {
      name: f5,
      props: {
        selections: Ui
      }
    },
    selections: Ui.map((t8) => ({
      label: {
        name: v5,
        props: {
          value: t8.value,
          text: t8.label
        }
      },
      value: t8.value
    })),
    value$: new Observable((t8) => {
      const o = qe.NORMAL_TEXT, r = () => {
        var c, d;
        const i = kt4(n);
        if (i == null) {
          t8.next(o);
          return;
        }
        const a = (d = (c = i.paragraphStyle) == null ? void 0 : c.namedStyleType) != null ? d : o;
        t8.next(a);
      }, s = e.onCommandExecuted((i) => {
        const a = i.id;
        (a === k.id || a === ct3.id) && r();
      });
      return r(), s.dispose;
    }),
    disabled$: xe2(n),
    hidden$: Bi(n, we.UNIVER_DOC)
  };
}
function mu2(n) {
  const e = n.get(Ls), t8 = n.get(Gi);
  return {
    id: mt2.id,
    icon: "FontColorDoubleIcon",
    tooltip: "toolbar.textColor.main",
    type: H1.BUTTON_SELECTOR,
    selections: [
      {
        label: {
          name: m5,
          hoverable: false,
          selectable: false
        },
        value$: new Observable((o) => {
          const r = rt.cl.rgb, s = () => {
            var d, l;
            const a = ot3(n);
            if (!a) {
              o.next(r);
              return;
            }
            const c = (l = (d = a.ts) == null ? void 0 : d.cl) == null ? void 0 : l.rgb;
            o.next(c != null ? c : r);
          }, i = e.onCommandExecuted((a) => {
            a.id === mt2.id && s();
          });
          return s(), i.dispose;
        })
      }
    ],
    value$: new Observable((o) => {
      const r = t8.getColorFromTheme("gray.900"), s = e.onCommandExecuted((i) => {
        if (i.id === mt2.id) {
          const a = i.params.value;
          o.next(a != null ? a : r);
        }
      });
      return o.next(r), s.dispose;
    }),
    disabled$: xe2(n),
    hidden$: Bi(n, we.UNIVER_DOC)
    // disabled$: getCurrentSheetDisabled$(accessor),
  };
}
function Eu2(n) {
  return {
    id: Bs2.id,
    type: H1.BUTTON,
    icon: "HeaderFooterIcon",
    tooltip: "toolbar.headerFooter",
    hidden$: combineLatest(Bi(n, we.UNIVER_DOC, void 0, Hc), iu(n), (e, t8) => e || t8)
  };
}
var Iu = "GridIcon";
var mc = "doc.menu.table";
function Su(n) {
  return {
    id: mc,
    type: H1.SUBITEMS,
    icon: Iu,
    tooltip: "toolbar.table.main",
    disabled$: au(n),
    // Do not show header footer menu and insert table at zen mode.
    hidden$: combineLatest(Bi(n, we.UNIVER_DOC, void 0, Hc), su(n), (e, t8) => e || t8)
  };
}
function vu(n) {
  return {
    id: Os2.id,
    title: "toolbar.table.insert",
    type: H1.BUTTON,
    hidden$: Bi(n, we.UNIVER_DOC)
  };
}
function Cu(n) {
  const e = n.get(Ls);
  return {
    id: Qo3.id,
    type: H1.BUTTON,
    icon: "LeftJustifyingIcon",
    tooltip: "toolbar.alignLeft",
    disabled$: xe2(n),
    activated$: new Observable((t8) => {
      const o = e.onCommandExecuted((r) => {
        var i;
        const s = r.id;
        if (s === k.id || s === lt3.id) {
          const a = kt4(n);
          if (a == null)
            return;
          const c = (i = a.paragraphStyle) == null ? void 0 : i.horizontalAlign;
          t8.next(c === Ut.LEFT);
        }
      });
      return t8.next(false), o.dispose;
    }),
    hidden$: Bi(n, we.UNIVER_DOC, void 0, Hc)
  };
}
function Ru2(n) {
  const e = n.get(Ls);
  return {
    id: Uo2.id,
    type: H1.BUTTON,
    icon: "HorizontallyIcon",
    tooltip: "toolbar.alignCenter",
    activated$: new Observable((t8) => {
      const o = e.onCommandExecuted((r) => {
        var i;
        const s = r.id;
        if (s === k.id || s === lt3.id) {
          const a = kt4(n);
          if (a == null)
            return;
          const c = (i = a.paragraphStyle) == null ? void 0 : i.horizontalAlign;
          t8.next(c === Ut.CENTER);
        }
      });
      return t8.next(false), o.dispose;
    }),
    disabled$: xe2(n),
    hidden$: Bi(n, we.UNIVER_DOC, void 0, Hc)
  };
}
function bu(n) {
  const e = n.get(Ls);
  return {
    id: Fo2.id,
    type: H1.BUTTON,
    icon: "RightJustifyingIcon",
    tooltip: "toolbar.alignRight",
    activated$: new Observable((t8) => {
      const o = e.onCommandExecuted((r) => {
        var i;
        const s = r.id;
        if (s === k.id || s === lt3.id) {
          const a = kt4(n);
          if (a == null)
            return;
          const c = (i = a.paragraphStyle) == null ? void 0 : i.horizontalAlign;
          t8.next(c === Ut.RIGHT);
        }
      });
      return t8.next(false), o.dispose;
    }),
    disabled$: xe2(n),
    hidden$: Bi(n, we.UNIVER_DOC, void 0, Hc)
  };
}
function yu(n) {
  const e = n.get(Ls);
  return {
    id: Ho2.id,
    type: H1.BUTTON,
    icon: "AlignTextBothIcon",
    tooltip: "toolbar.alignJustify",
    activated$: new Observable((t8) => {
      const o = e.onCommandExecuted((r) => {
        var i;
        const s = r.id;
        if (s === k.id || s === lt3.id) {
          const a = kt4(n);
          if (a == null)
            return;
          const c = (i = a.paragraphStyle) == null ? void 0 : i.horizontalAlign;
          t8.next(c === Ut.JUSTIFIED);
        }
      });
      return t8.next(false), o.dispose;
    }),
    disabled$: xe2(n),
    hidden$: Bi(n, we.UNIVER_DOC, void 0, Hc)
  };
}
function xu(n) {
  return {
    id: Po2.id,
    type: H1.BUTTON,
    icon: "ReduceIcon",
    tooltip: "toolbar.horizontalLine",
    disabled$: xe2(n),
    hidden$: Bi(n, we.UNIVER_DOC, void 0, Hc)
  };
}
var Tn4 = (n) => new Observable((e) => {
  const t8 = n.get(vr), o = n.get(m);
  let r;
  const s = t8.focused$.subscribe((i) => {
    if (r == null || r.unsubscribe(), i == null)
      return;
    const a = t8.getUniverDocInstance(i);
    a != null && (r = o.textSelection$.subscribe(() => {
      var l, A, h, u, g;
      const c = o.getDocRanges(), d = (l = c.find((f2) => f2.isActive)) != null ? l : c[0];
      if (d) {
        const f2 = a.getSelfOrHeaderFooterModel(d == null ? void 0 : d.segmentId), p = Je.range.getParagraphsInRange(d, (h = (A = f2.getBody()) == null ? void 0 : A.paragraphs) != null ? h : [], (g = (u = f2.getBody()) == null ? void 0 : u.dataStream) != null ? g : "");
        let m2;
        if (p.every((I2) => {
          var S;
          return m2 || (m2 = (S = I2.bullet) == null ? void 0 : S.listType), I2.bullet && I2.bullet.listType === m2;
        })) {
          e.next(m2);
          return;
        }
      }
      e.next(void 0);
    }));
  });
  return () => {
    s.unsubscribe(), r == null || r.unsubscribe();
  };
});
function bi2(n) {
  return {
    id: On2.id,
    type: H1.BUTTON_SELECTOR,
    slot: true,
    selections: [
      {
        label: {
          name: gc2,
          hoverable: false,
          selectable: false
        },
        value$: Tn4(n)
      }
    ],
    icon: "OrderIcon",
    tooltip: "toolbar.order",
    hidden$: Bi(n, we.UNIVER_DOC),
    disabled$: xe2(n),
    activated$: Tn4(n).pipe(map((e) => !!(e && e.indexOf("ORDER_LIST") === 0)))
  };
}
function yi2(n) {
  return {
    id: xn3.id,
    type: H1.BUTTON_SELECTOR,
    slot: true,
    selections: [
      {
        label: {
          name: fc2,
          hoverable: false,
          selectable: false
        },
        value$: Tn4(n)
      }
    ],
    icon: "UnorderIcon",
    tooltip: "toolbar.unorder",
    disabled$: xe2(n),
    hidden$: Bi(n, we.UNIVER_DOC),
    activated$: Tn4(n).pipe(map((e) => !!(e && e.indexOf("BULLET_LIST") === 0)))
  };
}
function xi(n) {
  return {
    id: so2.id,
    type: H1.BUTTON,
    icon: "TodoListDoubleIcon",
    tooltip: "toolbar.checklist",
    disabled$: xe2(n),
    hidden$: Bi(n, we.UNIVER_DOC),
    activated$: Tn4(n).pipe(map((e) => !!(e && e.indexOf("CHECK_LIST") === 0)))
  };
}
function Ou(n) {
  const e = n.get(Ls), t8 = n.get(vr);
  return {
    id: ko2.id,
    type: H1.BUTTON,
    icon: "KeyboardIcon",
    tooltip: "toolbar.documentFlavor",
    hidden$: Bi(n, we.UNIVER_DOC, void 0, Hc),
    activated$: new Observable((o) => {
      var i;
      const r = e.onCommandExecuted((a) => {
        var c;
        if (a.id === M.id) {
          const d = t8.getCurrentUnitForType(we.UNIVER_DOC);
          o.next(((c = d == null ? void 0 : d.getSnapshot()) == null ? void 0 : c.documentStyle.documentFlavor) === uu.MODERN);
        }
      }), s = t8.getCurrentUnitForType(we.UNIVER_DOC);
      return o.next(((i = s == null ? void 0 : s.getSnapshot()) == null ? void 0 : i.documentStyle.documentFlavor) === uu.MODERN), () => r.dispose();
    })
  };
}
function Tu2(n) {
  return {
    id: Un2.id,
    type: H1.BUTTON,
    title: "toolbar.resetColor",
    icon: "NoColorDoubleIcon"
  };
}
function Bu2(n) {
  const e = n.get(Ls), t8 = n.get(Gi);
  return {
    id: Et.id,
    tooltip: "toolbar.fillColor.main",
    type: H1.BUTTON_SELECTOR,
    icon: "PaintBucketDoubleIcon",
    selections: [
      {
        label: {
          name: m5,
          hoverable: false,
          selectable: false
        },
        value$: new Observable((o) => {
          const r = rt.bg.rgb, s = () => {
            var d, l;
            const a = ot3(n);
            if (!a) {
              o.next(r);
              return;
            }
            const c = (l = (d = a.ts) == null ? void 0 : d.bg) == null ? void 0 : l.rgb;
            o.next(c != null ? c : r);
          }, i = e.onCommandExecuted((a) => {
            a.id === Et.id && s();
          });
          return s(), i.dispose;
        })
      }
    ],
    value$: new Observable((o) => {
      const r = t8.getColorFromTheme("primary.600"), s = e.onCommandExecuted((i) => {
        if (i.id === Et.id) {
          const a = i.params.value;
          o.next(a != null ? a : r);
        }
      });
      return o.next(r), s.dispose;
    }),
    disabled$: xe2(n),
    hidden$: Bi(n, we.UNIVER_DOC)
  };
}
function ot3(n) {
  var g, f2, p, m2;
  const e = n.get(vr), t8 = n.get(m), o = n.get(at2), r = e.getCurrentUnitForType(we.UNIVER_DOC), s = t8.getDocRanges(), i = (g = s.find((I2) => I2.isActive)) != null ? g : s[0], a = o.getDefaultStyle(), c = (f2 = o.getStyleCache()) != null ? f2 : {}, d = kt4(n), l = (p = d == null ? void 0 : d.paragraphStyle) != null && p.namedStyleType ? cR[(m2 = d == null ? void 0 : d.paragraphStyle) == null ? void 0 : m2.namedStyleType] : null;
  if (r == null || i == null)
    return {
      ts: {
        ...a,
        ...l,
        ...c
      }
    };
  const { segmentId: A } = i, h = r.getSelfOrHeaderFooterModel(A).getBody();
  if (h == null)
    return {
      ts: {
        ...a,
        ...l,
        ...c
      }
    };
  const u = Ma(h, i, {});
  return J.deleteNull(u), {
    ts: {
      ...a,
      ...l,
      ...u,
      ...c
    }
  };
}
function kt4(n) {
  var l, A;
  const e = n.get(vr), t8 = n.get(m), o = e.getCurrentUniverDocInstance(), r = t8.getDocRanges(), s = (l = r.find((h) => h.isActive)) != null ? l : r[0];
  if (o == null || s == null)
    return;
  const { startOffset: i, segmentId: a } = s, c = (A = o.getSelfOrHeaderFooterModel(a).getBody()) == null ? void 0 : A.paragraphs;
  if (c == null)
    return;
  let d = -1;
  for (const h of c) {
    const { startIndex: u } = h;
    if (i > d && i <= u)
      return h;
    d = u;
  }
  return null;
}
function Mu(n) {
  return {
    id: _s.id,
    type: H1.BUTTON,
    icon: "DocumentSettingIcon",
    tooltip: "toolbar.pageSetup",
    hidden$: Bi(n, we.UNIVER_DOC)
  };
}
var _u = {
  [qe.HEADING_1]: us2,
  [qe.HEADING_2]: hs2,
  [qe.HEADING_3]: gs2,
  [qe.HEADING_4]: fs,
  [qe.HEADING_5]: ps,
  [qe.NORMAL_TEXT]: io2,
  [qe.TITLE]: Qa,
  [qe.SUBTITLE]: Ua2,
  [qe.NAMED_STYLE_TYPE_UNSPECIFIED]: io2
};
var Ec = {
  [qe.HEADING_1]: { key: "H1Icon", component: ec },
  [qe.HEADING_2]: { key: "H2Icon", component: tc },
  [qe.HEADING_3]: { key: "H3Icon", component: nc },
  [qe.HEADING_4]: { key: "H4Icon", component: oc2 },
  [qe.HEADING_5]: { key: "H5Icon", component: rc },
  [qe.NORMAL_TEXT]: { key: "TextTypeIcon", component: pn4 },
  [qe.TITLE]: { key: "TextTypeIcon", component: pn4 },
  [qe.SUBTITLE]: { key: "TextTypeIcon", component: pn4 },
  [qe.NAMED_STYLE_TYPE_UNSPECIFIED]: { key: "TextTypeIcon", component: pn4 }
};
var xt2 = (n) => (e) => {
  const t8 = e.get(Ls), o = e.get(S1), r = Ec[n];
  return o.get(r.key) || o.register(r.key, r.component), {
    id: _u[n].id,
    type: H1.BUTTON,
    icon: r.key,
    tooltip: "toolbar.heading.tooltip",
    disabled$: xe2(e),
    hidden$: Bi(e, we.UNIVER_DOC),
    activated$: new Observable((s) => {
      const i = qe.NORMAL_TEXT, a = () => {
        var A, h;
        const d = kt4(e);
        if (d == null) {
          s.next(i === n);
          return;
        }
        const l = (h = (A = d.paragraphStyle) == null ? void 0 : A.namedStyleType) != null ? h : i;
        s.next(l === n);
      }, c = t8.onCommandExecuted((d) => {
        const l = d.id;
        (l === k.id || l === ct3.id) && a();
      });
      return a(), c.dispose;
    })
  };
};
var Du = xt2(qe.HEADING_1);
var wu = xt2(qe.HEADING_2);
var Pu3 = xt2(qe.HEADING_3);
var Nu2 = xt2(qe.HEADING_4);
var Lu = xt2(qe.HEADING_5);
var Qu2 = xt2(qe.NORMAL_TEXT);
xt2(qe.TITLE);
xt2(qe.SUBTITLE);
var Uu = (n) => ({
  id: os.id,
  type: H1.BUTTON,
  icon: "CopyDoubleIcon",
  title: "rightClick.copy"
});
var Fu2 = (n) => ({
  id: ss2.id,
  type: H1.BUTTON,
  icon: "CutIcon",
  title: "rightClick.cut"
});
var Hu = (n) => ({
  id: es.id,
  type: H1.BUTTON,
  icon: "DeleteIcon",
  title: "rightClick.delete"
});
var ku2 = (n) => ({
  id: ls2.id,
  type: H1.BUTTON,
  icon: "UnorderIcon",
  title: "rightClick.bulletList"
});
var Vu = (n) => ({
  id: ds2.id,
  type: H1.BUTTON,
  icon: "OrderIcon",
  title: "rightClick.orderList"
});
var Wu = (n) => ({
  id: As.id,
  type: H1.BUTTON,
  icon: "TodoListDoubleIcon",
  title: "rightClick.checkList"
});
var ju = (n) => ({
  id: as.id,
  type: H1.BUTTON,
  icon: "ReduceIcon",
  title: "toolbar.horizontalLine"
});
var Ic = "doc.menu.insert-bellow";
function zu(n) {
  return {
    id: Ic,
    type: H1.SUBITEMS,
    title: "rightClick.insertBellow"
  };
}
var Oi = 4;
var Gu = Object.getOwnPropertyDescriptor;
var Yu2 = (n, e, t8, o) => {
  for (var r = o > 1 ? void 0 : o ? Gu(e, t8) : e, s = n.length - 1, i; s >= 0; s--)
    (i = n[s]) && (r = i(r) || r);
  return r;
};
var Wn3 = (n, e) => (t8, o) => e(t8, o, n);
function Sc(n, e) {
  const t8 = Ti(n.left, n.top, e), o = Ti(n.right, n.bottom, e);
  return {
    left: t8.x,
    top: t8.y,
    right: o.x,
    bottom: o.y
  };
}
function Ti(n, e, t8) {
  const { scaleX: o, scaleY: r } = t8.getAncestorScale(), s = t8.getViewport(We4.VIEW_MAIN);
  if (!s)
    return {
      x: n,
      y: e
    };
  const { viewportScrollX: i, viewportScrollY: a } = s, c = (n - i) * o, d = (e - a) * r;
  return {
    x: c,
    y: d
  };
}
function Bi2(n, e, t8) {
  const { scaleX: o, scaleY: r } = t8.getAncestorScale(), s = t8.getViewport(We4.VIEW_MAIN);
  if (!s)
    return {
      x: n,
      y: e
    };
  const { viewportScrollX: i, viewportScrollY: a } = s, c = n / o + i, d = e / r + a;
  return {
    x: c,
    y: d
  };
}
var nr2 = (n, e) => {
  const { scene: t8, mainComponent: o, engine: r } = e, s = e.with(D).getSkeleton(), i = s.findNodePositionByCharIndex(n.startOffset, true, n.segmentId, n.segmentPage), a = n.collapsed ? n.startOffset : n.endOffset - 1, c = s.findNodePositionByCharIndex(a, true, n.segmentId, n.segmentPage), d = o;
  if (!c || !i)
    return;
  const l = d.getOffsetConfig(), { docsLeft: A, docsTop: h } = l, u = r.getCanvasElement(), g = u.getBoundingClientRect(), f2 = T3(u.style.width), { top: p, left: m2, width: I2 } = g, S = I2 / f2, { scaleX: v2, scaleY: R } = t8.getAncestorScale(), E = new It2(l, s), { borderBoxPointGroup: b2 } = E.getRangePointData(i, c);
  return Es2(b2).map((B) => Sc(B, t8)).map((B) => ({
    left: (B.left + A * v2) * S + m2,
    right: (B.right + A * v2) * S + m2,
    top: (B.top + h * R) * S + p,
    bottom: (B.bottom + h * R) * S + p
  }));
};
var Bn4 = class extends Ve {
  constructor(n, e, t8, o) {
    super(), this._globalPopupManagerService = n, this._renderManagerService = e, this._univerInstanceService = t8, this._commandService = o;
  }
  _createRectPositionObserver(n, e) {
    const t8 = () => {
      const { scene: a, engine: c } = e, d = typeof n == "function" ? n() : n, l = c.getCanvasElement(), A = l.getBoundingClientRect(), h = T3(l.style.width), u = Sc(d, a), { top: g, left: f2, width: p } = A, m2 = p / h;
      return {
        left: u.left * m2 + f2,
        right: u.right * m2 + f2,
        top: u.top * m2 + g,
        bottom: u.bottom * m2 + g
      };
    }, o = t8(), r = new BehaviorSubject(o), s = new ao();
    s.add(this._commandService.onCommandExecuted((a) => {
      if (a.id === tt2.id || a.id === M.id) {
        const c = t8();
        c && r.next(c);
      }
    }));
    const i = e.scene.getViewport(We4.VIEW_MAIN);
    return i && s.add(i.onScrollAfter$.subscribeEvent(() => {
      r.next(t8());
    })), {
      position: o,
      position$: r,
      disposable: s
    };
  }
  _createObjectPositionObserver(n, e) {
    const t8 = () => {
      const { left: o, top: r, width: s, height: i } = n;
      return {
        left: o,
        right: o + s,
        top: r,
        bottom: r + i
      };
    };
    return this._createRectPositionObserver(t8, e);
  }
  _createRangePositionObserver(n, e) {
    var i;
    const t8 = (i = nr2(n, e)) != null ? i : [], o = new BehaviorSubject(t8), r = new ao();
    r.add(this._commandService.onCommandExecuted((a) => {
      if ((a.id === tt2.id || a.id === M.id) && a.params.unitId === e.unitId) {
        const d = nr2(n, e);
        d && o.next(d);
      }
    }));
    const s = e.scene.getViewport(We4.VIEW_MAIN);
    return s && r.add(s.onScrollAfter$.subscribeEvent(() => {
      const a = nr2(n, e);
      a && o.next(a);
    })), {
      positions: t8,
      positions$: o,
      disposable: r
    };
  }
  attachPopupToRect(n, e, t8) {
    const o = this._renderManagerService.getRenderById(t8);
    if (!o)
      throw new Error(`Current render not found, unitId: ${t8}`);
    const { position: r, position$: s, disposable: i } = this._createRectPositionObserver(n, o), a = this._globalPopupManagerService.addPopup({
      ...e,
      unitId: t8,
      subUnitId: "default",
      anchorRect: r,
      anchorRect$: s,
      canvasElement: o.engine.getCanvasElement()
    });
    return {
      dispose: () => {
        this._globalPopupManagerService.removePopup(a), s.complete(), i.dispose();
      },
      canDispose: () => this._globalPopupManagerService.activePopupId !== a
    };
  }
  // #region attach to object
  /**
   * attach a popup to canvas object
   * @param targetObject target canvas object
   * @param popup popup item
   * @returns disposable
   */
  attachPopupToObject(n, e, t8) {
    const o = this._renderManagerService.getRenderById(t8);
    if (!o)
      throw new Error(`Current render not found, unitId: ${t8}`);
    const { position: r, position$: s, disposable: i } = this._createObjectPositionObserver(n, o), a = this._globalPopupManagerService.addPopup({
      ...e,
      unitId: t8,
      subUnitId: "default",
      anchorRect: r,
      anchorRect$: s,
      canvasElement: o.engine.getCanvasElement()
    });
    return {
      dispose: () => {
        this._globalPopupManagerService.removePopup(a), s.complete(), i.dispose();
      },
      canDispose: () => this._globalPopupManagerService.activePopupId !== a
    };
  }
  // #endregion
  // #region attach to range
  /**
   * attach a popup to doc range
   * @param range doc range
   * @param popup popup item
   * @param unitId unit id
   * @returns disposable
   */
  attachPopupToRange(n, e, t8) {
    if (!this._univerInstanceService.getUnit(t8))
      throw new Error(`Document not found, unitId: ${t8}`);
    const { direction: r = "top", multipleDirection: s } = e, i = this._renderManagerService.getRenderById(t8);
    if (!i)
      throw new Error(`Current render not found, unitId: ${t8}`);
    const { positions: a, positions$: c, disposable: d } = this._createRangePositionObserver(n, i), l = c.pipe(map((h) => r.includes("top") ? h[0] : h[h.length - 1])), A = this._globalPopupManagerService.addPopup({
      ...e,
      unitId: t8,
      subUnitId: "default",
      anchorRect: r.includes("top") ? a[0] : a[a.length - 1],
      anchorRect$: l,
      excludeRects: a,
      excludeRects$: c,
      direction: ["top", "bottom", "horizontal"].some((h) => r.includes(h)) && a.length > 1 && s != null ? s : r,
      canvasElement: i.engine.getCanvasElement()
    });
    return {
      dispose: () => {
        this._globalPopupManagerService.removePopup(A), c.complete(), d.dispose();
      },
      canDispose: () => this._globalPopupManagerService.activePopupId !== A
    };
  }
  // #endregion
};
Bn4 = Yu2([
  Wn3(0, Inject(rt3)),
  Wn3(1, ME),
  Wn3(2, vr),
  Wn3(3, Ls)
], Bn4);
var Ku2 = Object.getOwnPropertyDescriptor;
var qu = (n, e, t8, o) => {
  for (var r = o > 1 ? void 0 : o ? Ku2(e, t8) : e, s = n.length - 1, i; s >= 0; s--)
    (i = n[s]) && (r = i(r) || r);
  return r;
};
var Xu2 = (n, e) => (t8, o) => e(t8, o, n);
var Zu = (n, e, t8, o) => {
  var h, u, g, f2, p;
  const r = t8.findNodePositionByCharIndex(n.startOffset, true, n.segmentId, o), s = t8.getSkeletonData();
  let i = n.endOffset - 1;
  if (n.segmentId) {
    const m2 = (p = Array.from((u = (h = s == null ? void 0 : s.skeFooters.get(n.segmentId)) == null ? void 0 : h.values()) != null ? u : [])[0]) != null ? p : Array.from((f2 = (g = s == null ? void 0 : s.skeHeaders.get(n.segmentId)) == null ? void 0 : g.values()) != null ? f2 : [])[0];
    m2 && (i = Math.min(m2.ed, i));
  }
  const a = t8.findNodePositionByCharIndex(i, true, n.segmentId, o);
  if (!a || !r)
    return;
  const c = e.getOffsetConfig(), d = new It2(c, t8), { borderBoxPointGroup: l } = d.getRangePointData(r, a);
  return Es2(l).map((m2) => ({
    top: m2.top + c.docsTop - Oi,
    bottom: m2.bottom + c.docsTop + Oi,
    left: m2.left + c.docsLeft,
    right: m2.right + c.docsLeft
  }));
};
var Mi2 = (n, e, t8, o) => {
  const r = [];
  for (const s of n) {
    const i = s.top;
    for (const a of s.columns) {
      const c = a.left, d = s.colCount === 1 ? o : a.width;
      let l = null;
      for (const A of a.lines) {
        const h = A.paragraphIndex;
        if (A.paragraphStart) {
          l && (r.push(l), l = null);
          const u = {
            top: e + i + A.top,
            left: t8 + c,
            right: t8 + c + d,
            bottom: e + i + A.top + A.lineHeight
          };
          l = {
            paragraphStart: A.st,
            paragraphEnd: h,
            startIndex: h,
            rect: u,
            fisrtLine: {
              top: e + i + A.top + A.marginTop + A.paddingTop,
              left: t8 + c,
              right: t8 + c + d,
              bottom: e + i + A.top + A.marginTop + A.paddingTop + A.contentHeight
            }
          };
        } else
          l && l.startIndex === h && (l.rect.bottom = e + i + A.top + A.lineHeight);
      }
      l && r.push(l);
    }
  }
  return r;
};
var Ju3 = (n, e, t8, o = -1) => {
  const r = t8.findPositionByGlyph(n, o);
  if (!r)
    return;
  const s = e.getOffsetConfig(), i = { ...r, isBack: true }, a = new It2(s, t8), { borderBoxPointGroup: c } = a.getRangePointData(i, i), l = Es2(c)[0];
  return {
    top: l.top + s.docsTop,
    bottom: l.bottom + s.docsTop,
    left: l.left + s.docsLeft,
    right: l.left + s.docsLeft + n.width
  };
};
function Tt2(n, e, t8) {
  const { left: o, right: r, top: s, bottom: i } = t8;
  return n >= o && n <= r && e >= s && e <= i;
}
var wt2 = class extends Ve {
  constructor(e, t8) {
    super();
    O(this, "_hoverCustomRanges$", new BehaviorSubject([]));
    O(this, "hoverCustomRanges$", this._hoverCustomRanges$.pipe(distinctUntilChanged((e8, t10) => e8.length === t10.length && e8.every((o, r) => t10[r].range.rangeId === o.range.rangeId && t10[r].segmentId === o.segmentId && t10[r].segmentPageIndex === o.segmentPageIndex && t10[r].range.startIndex === o.range.startIndex))));
    O(this, "_clickCustomRanges$", new Subject());
    O(this, "clickCustomRanges$", this._clickCustomRanges$.asObservable());
    O(this, "_hoverBullet$", new Subject());
    O(this, "hoverBullet$", this._hoverBullet$.pipe(distinctUntilChanged((e8, t10) => (e8 == null ? void 0 : e8.paragraph.startIndex) === (t10 == null ? void 0 : t10.paragraph.startIndex) && (e8 == null ? void 0 : e8.segmentId) === (t10 == null ? void 0 : t10.segmentId) && (e8 == null ? void 0 : e8.segmentPageIndex) === (t10 == null ? void 0 : t10.segmentPageIndex))));
    O(this, "_clickBullet$", new Subject());
    O(this, "clickBullets$", this._clickBullet$.asObservable());
    O(this, "_hoverParagraph$", new BehaviorSubject(null));
    O(this, "hoverParagraph$", this._hoverParagraph$.pipe(distinctUntilChanged((e8, t10) => (e8 == null ? void 0 : e8.startIndex) === (t10 == null ? void 0 : t10.startIndex) && (e8 == null ? void 0 : e8.segmentId) === (t10 == null ? void 0 : t10.segmentId) && (e8 == null ? void 0 : e8.pageIndex) === (t10 == null ? void 0 : t10.pageIndex))));
    O(this, "hoverParagraphRealTime$", this._hoverParagraph$.asObservable());
    O(this, "_hoverParagraphLeft$", new BehaviorSubject(null));
    O(this, "hoverParagraphLeft$", this._hoverParagraphLeft$.pipe(distinctUntilChanged((e8, t10) => (e8 == null ? void 0 : e8.startIndex) === (t10 == null ? void 0 : t10.startIndex) && (e8 == null ? void 0 : e8.segmentId) === (t10 == null ? void 0 : t10.segmentId) && (e8 == null ? void 0 : e8.pageIndex) === (t10 == null ? void 0 : t10.pageIndex))));
    O(this, "hoverParagraphLeftRealTime$", this._hoverParagraphLeft$.asObservable());
    O(this, "_hoverTableCell$", new Subject());
    O(this, "hoverTableCell$", this._hoverTableCell$.pipe(distinctUntilChanged((e8, t10) => (e8 == null ? void 0 : e8.rowIndex) === (t10 == null ? void 0 : t10.rowIndex) && (e8 == null ? void 0 : e8.colIndex) === (t10 == null ? void 0 : t10.colIndex) && (e8 == null ? void 0 : e8.tableId) === (t10 == null ? void 0 : t10.tableId) && (e8 == null ? void 0 : e8.pageIndex) === (t10 == null ? void 0 : t10.pageIndex))));
    O(this, "hoverTableCellRealTime$", this._hoverTableCell$.asObservable());
    O(this, "_hoverTable$", new Subject());
    O(this, "hoverTable$", this._hoverTable$.pipe(distinctUntilChanged((e8, t10) => (e8 == null ? void 0 : e8.tableId) === (t10 == null ? void 0 : t10.tableId) && (e8 == null ? void 0 : e8.pageIndex) === (t10 == null ? void 0 : t10.pageIndex))));
    O(this, "hoverTableRealTime$", this._hoverTable$.asObservable());
    O(this, "_customRangeDirty", true);
    O(this, "_bulletDirty", true);
    O(this, "_paragraphDirty", true);
    O(this, "_customRangeBounds", []);
    O(this, "_bulletBounds", []);
    O(this, "_paragraphBounds", /* @__PURE__ */ new Map());
    O(this, "_paragraphLeftBounds", []);
    O(this, "_tableParagraphBounds", /* @__PURE__ */ new Map());
    O(this, "_segmentParagraphBounds", /* @__PURE__ */ new Map());
    O(this, "_tableCellBounds", /* @__PURE__ */ new Map());
    O(this, "_tableBounds", /* @__PURE__ */ new Map());
    this._context = e, this._docSkeletonManagerService = t8, this._initResetDirty(), this._initEvents(), this._initPointer();
  }
  get hoverParagraph() {
    return this._hoverParagraph$.value;
  }
  get hoverParagraphLeft() {
    return this._hoverParagraphLeft$.value;
  }
  get _skeleton() {
    return this._docSkeletonManagerService.getSkeleton();
  }
  get _documents() {
    return this._context.mainComponent;
  }
  dispose() {
    this._hoverCustomRanges$.complete(), this._clickCustomRanges$.complete(), super.dispose();
  }
  _initPointer() {
    let e = v1.TEXT;
    this.disposeWithMe(this.hoverCustomRanges$.subscribe((t8) => {
      t8.length ? (e = this._context.scene.getCursor(), this._context.scene.setCursor(v1.POINTER)) : this._context.scene.setCursor(e);
    }));
  }
  _initResetDirty() {
    this.disposeWithMe(this._skeleton.dirty$.subscribe(() => {
      this._customRangeDirty = true, this._bulletDirty = true, this._paragraphDirty = true;
    })), this.disposeWithMe(
      TR(this._context.engine.onTransformChange$).pipe(
        filter((e) => e.type === x1.resize)
      ).subscribe(() => {
        this._customRangeDirty = true, this._bulletDirty = true, this._paragraphDirty = true;
      })
    );
  }
  _initEvents() {
    this.disposeWithMe(TR(this._context.scene.onPointerMove$).pipe(throttleTime(30)).subscribe((o) => {
      if (o.buttons > 0) {
        this._hoverBullet$.next(null), this._hoverCustomRanges$.next([]), this._hoverParagraph$.next(null), this._hoverParagraphLeft$.next(null), this._hoverTableCell$.next(null), this._hoverTable$.next(null);
        return;
      }
      const { x: r, y: s } = Bi2(o.offsetX, o.offsetY, this._context.scene);
      this._hoverCustomRanges$.next(
        this._calcActiveRanges({ x: r, y: s })
      ), this._hoverParagraph$.next(
        this._calcActiveParagraph({ x: r, y: s })
      ), this._hoverParagraphLeft$.next(
        this._calcActiveParagraphLeft({ x: r, y: s })
      ), this._hoverBullet$.next(
        this._calcActiveBullet({ x: r, y: s })
      );
    })), this.disposeWithMe(this._context.scene.onPointerEnter$.subscribeEvent(() => {
      this._hoverBullet$.next(null), this._hoverCustomRanges$.next([]);
    }));
    const e = TR(this._context.mainComponent.onPointerDown$), t8 = TR(this._context.scene.onPointerUp$);
    this.disposeWithMe(e.pipe(
      switchMap((o) => t8.pipe(take(1), map((r) => ({ down: o, up: r })))),
      filter(({ down: o, up: r }) => o.target === r.target && r.timeStamp - o.timeStamp < 300)
    ).subscribe(({ down: o }) => {
      if (o.button === 2)
        return;
      const r = Bi2(o.offsetX, o.offsetY, this._context.scene), s = this._calcActiveRanges(r);
      s.length && this._clickCustomRanges$.next(s.pop());
      const i = this._calcActiveBullet(r);
      i && this._clickBullet$.next(i);
    }));
  }
  _buildCustomRangeBoundsBySegment(e, t8 = -1) {
    var s, i, a;
    const o = (a = (i = (s = this._context.unit.getSelfOrHeaderFooterModel(e)) == null ? void 0 : s.getBody()) == null ? void 0 : i.customRanges) != null ? a : [], r = [];
    return o.forEach((c) => {
      const d = {
        startOffset: c.startIndex,
        endOffset: c.endIndex + 1,
        segmentId: e
      }, l = Zu(d, this._documents, this._skeleton, t8);
      if (!l)
        return null;
      r.push({
        customRange: c,
        rects: l,
        segmentId: e,
        segmentPageIndex: t8
      });
    }), r;
  }
  _buildCustomRangeBounds() {
    var t8;
    if (!this._customRangeDirty)
      return;
    this._customRangeDirty = false;
    const e = [];
    e.push(...this._buildCustomRangeBoundsBySegment()), (t8 = this._skeleton.getSkeletonData()) == null || t8.pages.forEach((o, r) => {
      o.headerId && e.push(...this._buildCustomRangeBoundsBySegment(o.headerId, r)), o.footerId && e.push(...this._buildCustomRangeBoundsBySegment(o.footerId, r));
    }), this._customRangeBounds = e;
  }
  _calcActiveRanges(e) {
    this._buildCustomRangeBounds();
    const { x: t8, y: o } = e;
    return this._customRangeBounds.filter((s) => s.rects.some((i) => Tt2(t8, o, i))).map(
      (s) => ({
        segmentId: s.segmentId,
        range: s.customRange,
        segmentPageIndex: s.segmentPageIndex,
        rects: s.rects
      })
    );
  }
  _buildBulletBoundsBySegment(e, t8 = -1) {
    var c, d, l, A, h;
    const o = (c = this._context.unit.getSelfOrHeaderFooterModel(e)) == null ? void 0 : c.getBody(), r = ((d = o == null ? void 0 : o.paragraphs) != null ? d : []).filter((u) => u.bullet && u.bullet.listType.indexOf("CHECK_LIST") === 0), s = [], i = this._skeleton.getSkeletonData();
    if (!i)
      return s;
    const a = (u) => {
      var g, f2, p;
      for (const m2 of u) {
        const I2 = [...m2.sections];
        if (m2.skeTables) {
          const S = Array.from(m2.skeTables.values());
          I2.push(...S.map((v2) => v2.rows.map((R) => R.cells.map((E) => E.sections))).flat(4));
        }
        for (const S of I2)
          for (const v2 of S.columns)
            for (const R of v2.lines)
              if (R.paragraphStart) {
                const E = r.find((b2) => b2.startIndex === R.paragraphIndex);
                if (E) {
                  const b2 = R, y = (p = (f2 = (g = b2 == null ? void 0 : b2.divides) == null ? void 0 : g[0]) == null ? void 0 : f2.glyphGroup) == null ? void 0 : p[0];
                  if (!y)
                    continue;
                  const C = Ju3(y, this._documents, this._skeleton, t8);
                  if (!C)
                    continue;
                  s.push({
                    rect: C,
                    segmentId: e,
                    segmentPageIndex: t8,
                    paragraph: E
                  });
                }
              }
      }
      return s;
    };
    if (e) {
      const u = (h = (l = i.skeFooters.get(e)) == null ? void 0 : l.values()) != null ? h : (A = i.skeHeaders.get(e)) == null ? void 0 : A.values();
      return u ? a(Array.from(u)) : s;
    }
    return a(i.pages);
  }
  _buildBulletBounds() {
    var e;
    this._bulletDirty && (this._bulletDirty = false, this._bulletBounds = [], this._bulletBounds.push(...this._buildBulletBoundsBySegment()), (e = this._skeleton.getSkeletonData()) == null || e.pages.forEach((t8, o) => {
      t8.headerId && this._bulletBounds.push(...this._buildBulletBoundsBySegment(t8.headerId, o)), t8.footerId && this._bulletBounds.push(...this._buildBulletBoundsBySegment(t8.footerId, o));
    }));
  }
  _calcActiveBullet(e) {
    this._buildBulletBounds();
    const { x: t8, y: o } = e;
    return this._bulletBounds.find((s) => Tt2(t8, o, s.rect));
  }
  // eslint-disable-next-line max-lines-per-function
  _buildParagraphBoundsBySegment(e) {
    var i, a, c;
    const t8 = this._skeleton.getSkeletonData(), r = this._documents.getOffsetConfig();
    if (!t8)
      return null;
    const s = (d) => {
      const l = /* @__PURE__ */ new Map(), A = (h, u, g, f2) => {
        Mi2(h.sections, g, f2, h.pageWidth - h.marginLeft - h.marginRight).forEach((m2) => {
          if (!l.has(m2.startIndex))
            l.set(m2.startIndex, {
              rect: m2.rect,
              paragraphStart: m2.paragraphStart,
              paragraphEnd: m2.paragraphEnd,
              startIndex: m2.startIndex,
              rects: [m2.rect],
              pageIndex: u,
              segmentId: e,
              firstLine: m2.fisrtLine
            });
          else {
            const I2 = l.get(m2.startIndex);
            I2 && (I2.rect.bottom = m2.rect.bottom, I2.rects.push(m2.rect));
          }
        });
      };
      for (let h = 0; h < d.length; h++) {
        const u = d[h], g = ((u.pageHeight === 1 / 0 ? 0 : u.pageHeight) + r.pageMarginTop) * h + u.marginTop + r.docsTop, f2 = u.marginLeft + r.docsLeft;
        u.skeTables && Array.from(u.skeTables.values()).forEach((p) => {
          const m2 = p.left + f2, I2 = p.top + g, S = m2 + p.width, v2 = I2 + p.height, R = p.tableId;
          this._tableBounds.set(R, {
            rect: {
              left: m2,
              top: I2,
              right: S,
              bottom: v2
            },
            pageIndex: h,
            tableId: R
          }), p.rows.forEach((E, b2) => {
            E.cells.forEach((y, C) => {
              const B = ((u.pageHeight === 1 / 0 ? 0 : u.pageHeight) + r.pageMarginTop) * h + p.top + r.docsTop + u.marginTop + E.top + y.marginTop, x7 = p.left + r.docsLeft + u.marginLeft + y.left + y.marginLeft, M7 = Mi2(y.sections, B, x7, y.pageWidth - y.marginLeft - y.marginRight);
              let w = this._tableParagraphBounds.get(R);
              w || (w = [], this._tableParagraphBounds.set(R, w)), w.push(
                ...M7.map((P2) => ({
                  rect: P2.rect,
                  paragraphStart: P2.paragraphStart,
                  paragraphEnd: P2.paragraphEnd,
                  startIndex: P2.startIndex,
                  pageIndex: h,
                  segmentId: e,
                  rowIndex: b2,
                  colIndex: C,
                  firstLine: P2.fisrtLine,
                  tableId: R
                }))
              );
              let F2 = this._tableCellBounds.get(R);
              F2 || (F2 = [], this._tableCellBounds.set(R, F2)), F2.push({
                rect: {
                  top: B,
                  left: x7,
                  right: x7 + y.pageWidth - y.marginLeft - y.marginRight,
                  bottom: B + y.pageHeight - y.marginBottom - y.marginTop
                },
                pageIndex: h,
                rowIndex: b2,
                colIndex: C,
                tableId: R
              });
            });
          });
        }), A(u, h, g, f2);
      }
      return l;
    };
    if (e) {
      const d = (c = (i = t8.skeFooters.get(e)) == null ? void 0 : i.values()) != null ? c : (a = t8.skeHeaders.get(e)) == null ? void 0 : a.values();
      return d ? s(Array.from(d)) : null;
    }
    return s(t8.pages);
  }
  _buildParagraphBounds() {
    var t8, o;
    if (!this._paragraphDirty)
      return;
    this._paragraphDirty = false, this._tableParagraphBounds = /* @__PURE__ */ new Map(), this._tableCellBounds = /* @__PURE__ */ new Map(), this._tableBounds = /* @__PURE__ */ new Map(), this._paragraphBounds = (t8 = this._buildParagraphBoundsBySegment()) != null ? t8 : /* @__PURE__ */ new Map(), this._paragraphLeftBounds = Array.from(this._paragraphBounds.values()).map((r) => ({
      ...r,
      rect: {
        left: r.rect.left - 60,
        right: r.rect.left,
        top: r.rect.top,
        bottom: r.rect.bottom
      }
    }));
    const e = (r) => {
      var s;
      this._segmentParagraphBounds.set(r, (s = this._buildParagraphBoundsBySegment(r)) != null ? s : /* @__PURE__ */ new Map());
    };
    (o = this._skeleton.getSkeletonData()) == null || o.pages.forEach((r) => {
      r.headerId && e(r.headerId), r.footerId && e(r.footerId);
    });
  }
  _calcActiveParagraph(e) {
    var i, a;
    this._buildParagraphBounds();
    const { x: t8, y: o } = e, r = Array.from(this._tableBounds.values()).find((c) => Tt2(t8, o, c.rect));
    if (this._hoverTable$.next(r), r) {
      const c = (i = this._tableCellBounds.get(r.tableId)) == null ? void 0 : i.find((A) => Tt2(t8, o, A.rect));
      if (this._hoverTableCell$.next(c), !c)
        return null;
      const d = (a = this._tableParagraphBounds.get(c.tableId)) == null ? void 0 : a.filter((A) => A.colIndex === c.colIndex && A.rowIndex === c.rowIndex), l = d == null ? void 0 : d.find((A) => Tt2(t8, o, A.rect));
      return l && {
        ...l,
        rects: [l.rect]
      };
    }
    let s;
    for (const c of this._paragraphBounds) {
      const d = c[1];
      if (d.rects.some((l) => Tt2(t8, o, l))) {
        s = d;
        break;
      }
    }
    return s;
  }
  _calcActiveParagraphLeft(e) {
    this._buildParagraphBounds();
    const { x: t8, y: o } = e;
    return this._paragraphLeftBounds.find((s) => Tt2(t8, o, s.rect));
  }
  get paragraphBounds() {
    return this._buildParagraphBounds(), this._paragraphBounds;
  }
  findParagraphBoundByIndex(e) {
    this._buildParagraphBounds();
    const t8 = this._paragraphBounds.get(e);
    return t8 || Array.from(this._tableParagraphBounds.values()).flat().find((r) => r.startIndex === e);
  }
};
wt2 = qu([
  Xu2(1, Inject(D))
], wt2);
var $u2 = [
  ct3.id,
  Lt2.id,
  Qt5.id,
  Ut3.id,
  Ft4.id,
  bt3.id,
  Ht2.id,
  mt2.id,
  Et.id
];
function eh(n) {
  const { avaliableMenus: e = $u2 } = n, t8 = useDependency(B12), [o, r] = (0, import_react3.useState)([]);
  return (0, import_react3.useEffect)(() => {
    function s() {
      const a = t8.getFlatMenuByPositionKey(ke3.RIBBON), c = [];
      for (const d of e) {
        const l = a.find((A) => A.key === d);
        l && c.push(l);
      }
      r(c);
    }
    s();
    const i = t8.menuChanged$.subscribe(s);
    return () => {
      i.unsubscribe();
    };
  }, [t8]), (0, import_jsx_runtime3.jsx)(
    "div",
    {
      className: ie2("univer-box-border univer-flex univer-rounded univer-bg-white univer-py-1.5 univer-shadow-sm dark:!univer-border-gray-700 dark:!univer-bg-gray-900", kt2),
      children: o.map((s) => s.item && (0, import_jsx_runtime3.jsx)("div", { className: "univer-flex univer-flex-nowrap univer-gap-2 univer-px-2", children: (0, import_jsx_runtime3.jsx)(Oe, { ...s.item }, s.key) }, s.key))
    }
  );
}
var th = Object.getOwnPropertyDescriptor;
var nh = (n, e, t8, o) => {
  for (var r = o > 1 ? void 0 : o ? th(e, t8) : e, s = n.length - 1, i; s >= 0; s--)
    (i = n[s]) && (r = i(r) || r);
  return r;
};
var ln3 = (n, e) => (t8, o) => e(t8, o, n);
var _i2 = "univer.doc.float-menu";
function oh(n, e) {
  if (n == null || e == null)
    return false;
  const { glyph: t8, ...o } = n, { glyph: r, ...s } = e;
  return mu(o, s);
}
var rh = [
  ct.CUSTOM_BLOCK,
  ct.PARAGRAPH
];
var co2 = class extends Ve {
  constructor(e, t8, o, r, s, i) {
    super();
    O(this, "_floatMenu", null);
    this._context = e, this._docSelectionManagerService = t8, this._docCanvasPopManagerService = o, this._componentManager = r, this._univerInstanceService = s, this._docSelectionRenderService = i, !Yc(this._context.unitId) && (this._registerFloatMenu(), this._initSelectionChange(), this.disposeWithMe(() => {
      this._hideFloatMenu();
    }));
  }
  get floatMenu() {
    return this._floatMenu;
  }
  _registerFloatMenu() {
    this.disposeWithMe(this._componentManager.register(_i2, eh));
  }
  _initSelectionChange() {
    this.disposeWithMe(this._docSelectionRenderService.onSelectionStart$.subscribe(() => {
      this._hideFloatMenu();
    })), this.disposeWithMe(this._docSelectionManagerService.textSelection$.subscribe((e) => {
      var s, i;
      const { unitId: t8, textRanges: o } = e;
      if (t8 !== this._context.unitId)
        return;
      const r = o.length > 0 && o.find((a) => !a.collapsed);
      if (r) {
        if (r.startOffset === ((s = this._floatMenu) == null ? void 0 : s.start) && r.endOffset === ((i = this._floatMenu) == null ? void 0 : i.end))
          return;
        this._hideFloatMenu(), this._showFloatMenu(t8, r);
        return;
      }
      this._hideFloatMenu();
    }));
  }
  _hideFloatMenu() {
    var e;
    (e = this._floatMenu) == null || e.disposable.dispose(), this._floatMenu = null;
  }
  _showFloatMenu(e, t8) {
    var i, a, c;
    const o = this._univerInstanceService.getUnit(e, we.UNIVER_DOC);
    if (!o || o.getDisabled())
      return;
    const r = (i = o.getBody()) == null ? void 0 : i.dataStream[t8.startOffset];
    if (t8.endOffset - t8.startOffset === 1 && r && rh.includes(r))
      return;
    const s = (c = (a = o.getBody()) == null ? void 0 : a.customRanges) == null ? void 0 : c.filter((d) => d.wholeEntity);
    if (!(s != null && s.some((d) => d.startIndex === t8.startOffset && d.endIndex === t8.endOffset - 1)))
      return this._floatMenu = {
        disposable: this._docCanvasPopManagerService.attachPopupToRange(
          t8,
          {
            componentKey: _i2,
            direction: t8.direction === "backward" || oh(t8.startNodePosition, t8.endNodePosition) ? "top-center" : "bottom-center",
            offset: [0, 4]
          },
          e
        ),
        start: t8.startOffset,
        end: t8.endOffset
      }, We(() => this._hideFloatMenu());
  }
};
co2 = nh([
  ln3(1, Inject(m)),
  ln3(2, Inject(Bn4)),
  ln3(3, Inject(S1)),
  ln3(4, Inject(vr)),
  ln3(5, Inject(Re2))
], co2);
var sh = Object.getOwnPropertyDescriptor;
var ih = (n, e, t8, o) => {
  for (var r = o > 1 ? void 0 : o ? sh(e, t8) : e, s = n.length - 1, i; s >= 0; s--)
    (i = n[s]) && (r = i(r) || r);
  return r;
};
var dn2 = (n, e) => (t8, o) => e(t8, o, n);
var lo2 = class extends Ve {
  constructor(e, t8, o, r, s, i) {
    super();
    O(this, "_paragrahMenu", null);
    this._context = e, this._docSelectionManagerService = t8, this._docEventManagerService = o, this._docPopupManagerService = r, this._docSkeletonManagerService = s, this._floatMenuService = i, !Yc(this._context.unitId) && this._init();
  }
  get activeParagraph() {
    var e;
    return (e = this._paragrahMenu) == null ? void 0 : e.paragraph;
  }
  _isCursorInActiveParagraph() {
    if (!this._paragrahMenu)
      return false;
    const e = this._docSelectionManagerService.getActiveTextRange();
    return !(!(e != null && e.collapsed) || !(e != null && e.collapsed) || e.startOffset < this._paragrahMenu.paragraph.paragraphStart || e.startOffset > this._paragrahMenu.paragraph.paragraphEnd);
  }
  setParagraphMenuActive(e) {
    this._paragrahMenu && (this._paragrahMenu.active = e, this._isCursorInActiveParagraph() || this._docSelectionManagerService.replaceDocRanges([{
      startOffset: this._paragrahMenu.paragraph.paragraphStart,
      endOffset: this._paragrahMenu.paragraph.paragraphStart
    }]));
  }
  _init() {
    const e = (o) => {
      var s;
      if (this._docSkeletonManagerService.getViewModel().getEditArea() === d3.BODY && !this._floatMenuService.floatMenu && !this._context.unit.getDisabled()) {
        if ((s = this._paragrahMenu) != null && s.active)
          return;
        if (o) {
          this.showParagraphMenu(o);
          return;
        }
      }
      this.hideParagraphMenu(true);
    };
    this.disposeWithMe(
      combineLatest([this._docEventManagerService.hoverParagraphRealTime$, this._docEventManagerService.hoverParagraphLeft$]).pipe(throttleTime(16)).subscribe(([o, r]) => {
        const s = o != null ? o : r;
        e(s);
      })
    );
    let t8 = 0;
    this.disposeWithMe(this._context.scene.getViewport(We4.VIEW_MAIN).onScrollAfter$.subscribeEvent((o) => {
      t8 !== o.scrollY && (t8 = o.scrollY, this.hideParagraphMenu(true));
    })), this.disposeWithMe(this._docEventManagerService.clickCustomRanges$.subscribe(() => {
      this.hideParagraphMenu(true);
    }));
  }
  showParagraphMenu(e) {
    var c, d, l;
    if (((c = this._paragrahMenu) == null ? void 0 : c.paragraph.startIndex) === e.startIndex)
      return;
    this.hideParagraphMenu(true);
    const t8 = (l = (d = this._context.unit.getBody()) == null ? void 0 : d.dataStream) != null ? l : "", o = e ? t8.slice(e.paragraphStart, e.paragraphEnd) : "";
    if (o === "\b" || o === "")
      return;
    const a = this._docPopupManagerService.attachPopupToRect(
      e.firstLine,
      {
        componentKey: "doc.paragraph.menu",
        direction: "left-center",
        onClickOutside: () => {
          this._docSelectionManagerService.textSelection$.pipe(first()).subscribe(() => {
            this._isCursorInActiveParagraph() || this.hideParagraphMenu(true);
          });
        },
        zIndex: 101
      },
      this._context.unitId
    );
    this._paragrahMenu = {
      paragraph: e,
      disposable: a,
      active: false
    };
  }
  hideParagraphMenu(e = false) {
    this._paragrahMenu && (this._paragrahMenu.disposable.canDispose() || e) && (this._paragrahMenu.disposable.dispose(), this._paragrahMenu = null);
  }
};
lo2 = ih([
  dn2(1, Inject(m)),
  dn2(2, Inject(wt2)),
  dn2(3, Inject(Bn4)),
  dn2(4, Inject(D)),
  dn2(5, Inject(co2))
], lo2);
var ah = ({ popup: n }) => {
  var E, b2;
  const [e, t8] = (0, import_react3.useState)(false), o = (0, import_react3.useRef)(null), r = useDependency(Ls), s = useDependency(U1), i = (0, import_react3.useRef)(null), a = (0, import_react3.useRef)(false), c = useDependency(ME), d = useDependency(vr), l = c.getRenderById(n.unitId), A = d.getUnit(n.unitId, we.UNIVER_DOC), h = l == null ? void 0 : l.with(lo2), u = l == null ? void 0 : l.with(wt2), g = useObservable(u == null ? void 0 : u.hoverParagraph$), f2 = useObservable(u == null ? void 0 : u.hoverParagraphLeft$), p = (E = g != null ? g : f2) == null ? void 0 : E.startIndex, m2 = (0, import_react3.useMemo)(() => {
    var y, C;
    return (C = (y = A == null ? void 0 : A.getBody()) == null ? void 0 : y.paragraphs) == null ? void 0 : C.find((B) => B.startIndex === p);
  }, [A, g]), I2 = (b2 = m2 == null ? void 0 : m2.paragraphStyle) == null ? void 0 : b2.namedStyleType, S = Ec[I2 != null ? I2 : qe.NORMAL_TEXT], v2 = (0, import_react3.useMemo)(() => new BehaviorSubject({
    left: 0,
    right: 0,
    top: 0,
    bottom: 0
  }), []), R = () => {
    t8(false), h == null || h.hideParagraphMenu(true);
  };
  return (0, import_jsx_runtime3.jsxs)(import_jsx_runtime3.Fragment, { children: [
    (0, import_jsx_runtime3.jsxs)(
      "div",
      {
        "data-u-comp": "paragraph-menu",
        ref: i,
        className: ie2("univer-mr-1 univer-inline-flex univer-h-7 univer-cursor-pointer univer-items-center univer-gap-1 univer-rounded-full univer-px-2.5 univer-py-0 hover:univer-bg-gray-100 dark:hover:!univer-bg-gray-600", kt2, {
          "univer-bg-gray-100 dark:!univer-bg-gray-700": e,
          "univer-bg-white dark:!univer-bg-gray-700": !e
        }),
        onMouseEnter: (y) => {
          var B, x7, M7, w, F2, P2;
          (B = n.onPointerEnter) == null || B.call(n, y), a.current = true;
          const C = (x7 = i.current) == null ? void 0 : x7.getBoundingClientRect();
          v2.next({
            left: ((M7 = C == null ? void 0 : C.left) != null ? M7 : 0) - 4,
            right: (w = C == null ? void 0 : C.right) != null ? w : 0,
            top: (F2 = C == null ? void 0 : C.top) != null ? F2 : 0,
            bottom: (P2 = C == null ? void 0 : C.bottom) != null ? P2 : 0
          });
        },
        onMouseLeave: () => {
          a.current = false;
        },
        onClick: () => {
          t8(true), h == null || h.setParagraphMenuActive(true);
        },
        children: [
          (0, import_jsx_runtime3.jsx)(
            S.component,
            {
              className: "univer-size-4 univer-text-gray-900 dark:!univer-text-white"
            }
          ),
          (0, import_jsx_runtime3.jsx)(
            $a,
            {
              className: "univer-size-3 univer-text-gray-600 dark:!univer-text-gray-200"
            }
          )
        ]
      }
    ),
    e && (0, import_jsx_runtime3.jsx)(
      ot2,
      {
        portal: true,
        mask: true,
        maskZIndex: 100,
        anchorRect$: v2,
        direction: "left",
        onMaskClick: R,
        children: (0, import_jsx_runtime3.jsx)(
          "section",
          {
            ref: o,
            onMouseEnter: (y) => {
              var C;
              (C = n.onPointerEnter) == null || C.call(n, y), a.current = true;
            },
            onMouseLeave: () => {
              a.current = false;
            },
            children: (0, import_jsx_runtime3.jsx)(
              E5,
              {
                style: { width: 212 },
                menuType: Y1.PARAGRAPH,
                onOptionSelect: (y) => {
                  const { label: C, commandId: B, value: x7 } = y;
                  r && r.executeCommand(B != null ? B : C, { value: x7 }), s.focus(), R();
                }
              }
            )
          }
        )
      }
    )
  ] });
};
function Se2(n) {
  return n.getContextValue(qr) && n.getContextValue(xR) && !n.getContextValue(PR);
}
function ch(n) {
  return n.getContextValue(qr) && n.getContextValue(xR) && !n.getContextValue(PR);
}
var lh = {
  id: Zt3.id,
  binding: q1.TAB,
  preconditions: Se2
};
var dh = {
  id: Zt3.id,
  binding: q1.TAB | L1.SHIFT,
  preconditions: Se2,
  staticParameters: {
    shift: true
  }
};
var Ah = {
  id: Lt2.id,
  binding: q1.B | L1.CTRL_COMMAND,
  preconditions: Se2
};
var uh = {
  id: Qt5.id,
  binding: q1.I | L1.CTRL_COMMAND,
  preconditions: Se2
};
var hh = {
  id: Ut3.id,
  binding: q1.U | L1.CTRL_COMMAND,
  preconditions: Se2
};
var gh2 = {
  id: Ft4.id,
  binding: q1.X | L1.SHIFT | L1.CTRL_COMMAND,
  preconditions: Se2
};
var fh2 = {
  id: bt3.id,
  binding: q1.COMMA | L1.CTRL_COMMAND,
  preconditions: Se2
};
var ph2 = {
  id: Ht2.id,
  binding: q1.PERIOD | L1.CTRL_COMMAND,
  preconditions: Se2
};
var mh2 = {
  id: Qo3.id,
  binding: q1.L | L1.CTRL_COMMAND | L1.SHIFT,
  preconditions: Se2
};
var Eh2 = {
  id: Fo2.id,
  binding: q1.R | L1.CTRL_COMMAND | L1.SHIFT,
  preconditions: Se2
};
var Ih2 = {
  id: Uo2.id,
  binding: q1.E | L1.CTRL_COMMAND | L1.SHIFT,
  preconditions: Se2
};
var Sh = {
  id: Ho2.id,
  binding: q1.J | L1.CTRL_COMMAND | L1.SHIFT,
  preconditions: Se2
};
var vh2 = {
  id: On2.id,
  binding: q1.Digit7 | L1.CTRL_COMMAND | L1.SHIFT,
  preconditions: Se2
};
var Ch = {
  id: xn3.id,
  binding: q1.Digit8 | L1.CTRL_COMMAND | L1.SHIFT,
  preconditions: Se2
};
var Vo2 = "docs-ui.config";
var Di = {
  layout: {
    docContainerConfig: rd,
    toolbarConfig: od
  }
};
var Rh = [50, 80, 100, 130, 150, 170, 200, 400];
var bh = [10, 400];
function yh() {
  const n = useDependency(Ls), e = useDependency(vr), t8 = (0, import_react3.useMemo)(() => e.getCurrentTypeOfUnit$(we.UNIVER_DOC), []), o = useObservable(t8), r = (0, import_react3.useCallback)(() => {
    var d, l;
    if (!o) return 100;
    const c = ((l = (d = o.getSettings()) == null ? void 0 : d.zoomRatio) != null ? l : 1) * 100;
    return Math.round(c);
  }, [o]), [s, i] = (0, import_react3.useState)(() => r());
  (0, import_react3.useEffect)(() => (i(r()), n.onCommandExecuted((d) => {
    if (d.id === tt2.id) {
      const l = r();
      i(l);
    }
  }).dispose), [n, r]);
  function a(c) {
    if (i(c), o == null)
      return;
    const d = c / 100;
    n.executeCommand(tt2.id, {
      unitId: o.getUnitId(),
      zoomRatio: d
    });
  }
  return (0, import_jsx_runtime3.jsx)(
    Fi,
    {
      min: bh[0],
      value: s,
      shortcuts: Rh,
      onChange: a
    }
  );
}
function xh(n) {
  return (0, import_jsx_runtime3.jsx)("section", { className: "univer-flex univer-flex-shrink-0 univer-justify-end", children: (0, import_jsx_runtime3.jsx)(yh, {}) });
}
function Oh() {
  var r, s, i;
  const n = useDependency(vr), e = p5(Vo2), t8 = useObservable(() => n.getCurrentTypeOfUnit$(we.UNIVER_SHEET), void 0, void 0, []), o = (i = (s = (r = e == null ? void 0 : e.layout) == null ? void 0 : r.docContainerConfig) == null ? void 0 : s.footer) != null ? i : true;
  return t8 ? null : o && (0, import_jsx_runtime3.jsxs)(
    "div",
    {
      className: "univer-box-border univer-flex univer-items-center univer-justify-between univer-px-5 univer-py-1.5",
      children: [
        (0, import_jsx_runtime3.jsx)("div", {}),
        (0, import_jsx_runtime3.jsx)(xh, {})
      ]
    }
  );
}
var Th = "univer-font-[500] univer-truncate univer-h-[24px] univer-mb-2 univer-leading-[24px] univer-cursor-pointer univer-pr-1 ";
var Bh = "univer-text-base univer-font-semibold";
var Mh = "univer-text-sm univer-font-semibold";
var _h = "univer-text-sm";
var Dh = (0, import_react3.forwardRef)((n, e) => {
  const { menus: t8, onClick: o, className: r, style: s, mode: i, maxHeight: a, activeId: c, open: d, onOpenChange: l, maxWidth: A, wrapperClass: h, wrapperStyle: u, iconClass: g, iconStyle: f2 } = n, p = i === "side-bar", m2 = (0, import_react3.useRef)(null), I2 = (0, import_react3.useRef)(t8);
  I2.current = t8;
  const S = (0, import_react3.useMemo)(() => ({
    scrollTo: (v2) => {
      var x7;
      if (!I2.current || I2.current.findIndex((M7) => M7.id === v2) === -1 || !m2.current) return;
      const E = document.getElementById(`univer-side-menu-${v2}`);
      if (!E) return;
      const b2 = E.offsetTop, y = m2.current.clientHeight, C = m2.current.scrollHeight - y, B = Math.max(0, Math.min(b2 - y / 2 + E.clientHeight / 2, C));
      (x7 = m2.current) == null || x7.scrollTo({
        behavior: "smooth",
        top: B
      });
    }
  }), []);
  return (0, import_react3.useImperativeHandle)(e, () => S), (0, import_react3.useEffect)(() => {
    c && S.scrollTo(c);
  }, [c, S]), (0, import_jsx_runtime3.jsxs)("div", { className: ie2("univer-relative", h), style: u, children: [
    (0, import_jsx_runtime3.jsx)(
      "div",
      {
        onClick: () => l == null ? void 0 : l(!d),
        className: ie2("univer-absolute univer-left-5 univer-top-4 univer-z-[100] univer-flex univer-h-8 univer-w-8 univer-cursor-pointer univer-items-center univer-justify-center univer-rounded-full univer-bg-white univer-text-gray-800 univer-shadow-sm dark:!univer-bg-gray-600 dark:!univer-text-gray-200", g),
        style: f2,
        children: d ? (0, import_jsx_runtime3.jsx)(ic2, {}) : (0, import_jsx_runtime3.jsx)(qa, {})
      }
    ),
    (0, import_jsx_runtime3.jsx)(
      "div",
      {
        className: ie2(
          r,
          `
                      univer-absolute univer-left-0 univer-top-0 univer-box-border univer-flex univer-min-w-[180px]
                      univer-flex-col univer-px-4 univer-pb-4 univer-pt-14 univer-transition-all univer-duration-300
                    `,
          {
            "univer-rounded-r-2xl univer-bg-white univer-shadow univer-backdrop-blur-[10px] dark:!univer-bg-gray-900": p
          }
        ),
        style: {
          ...s,
          transform: d ? "translateX(0)" : "translateX(-100%)",
          maxHeight: a,
          opacity: d ? 1 : 0,
          maxWidth: A != null ? A : i === "side-bar" ? 320 : 180,
          paddingRight: i === "float" ? void 0 : 0
        },
        children: (0, import_jsx_runtime3.jsx)(
          "div",
          {
            ref: m2,
            className: ie2("univer-flex-1 univer-overflow-y-auto univer-overflow-x-hidden", pr),
            children: t8 == null ? void 0 : t8.map((v2) => (0, import_jsx_runtime3.jsx)(
              "div",
              {
                id: `univer-side-menu-${v2.id}`,
                className: ie2(
                  Th,
                  {
                    [Bh]: v2.isTitle,
                    [Mh]: v2.level === 1,
                    [_h]: v2.level > 1,
                    "univer-text-gray-500 dark:!univer-text-gray-400": v2.id !== c,
                    "univer-text-gray-800 dark:!univer-text-gray-200": v2.id === c
                  }
                ),
                style: {
                  paddingLeft: (v2.level - 1) * 12
                },
                onClick: () => {
                  o == null || o(v2);
                },
                children: v2.text
              },
              v2.id
            ))
          }
        )
      }
    )
  ] });
});
var wh2 = (n) => {
  switch (n) {
    case qe.HEADING_1:
      return 1;
    case qe.HEADING_2:
      return 2;
    case qe.HEADING_3:
      return 3;
    case qe.HEADING_4:
      return 4;
    case qe.HEADING_5:
      return 5;
    case qe.TITLE:
      return 1;
    default:
      return 1;
  }
};
function Ph(n, e, t8, o) {
  var a, c;
  if (!n)
    return;
  const r = Array.from(n.values()), s = r.findIndex((d) => d.paragraphStart !== d.paragraphEnd && d.rect.top < o && d.rect.bottom > t8);
  if (s === -1) return;
  const i = r == null ? void 0 : r.findLastIndex((d) => d.paragraphStart !== d.paragraphEnd && d.rect.top < o && d.rect.bottom > t8);
  for (let d = s; d <= i; d++) {
    const l = r[d], A = e.get(l.startIndex);
    if ((a = A == null ? void 0 : A.paragraphStyle) != null && a.headingId)
      return A.paragraphStyle.headingId;
  }
  for (let d = s; d >= 0; d--) {
    const l = r[d], A = e.get(l.startIndex);
    if ((c = A == null ? void 0 : A.paragraphStyle) != null && c.headingId)
      return A.paragraphStyle.headingId;
  }
}
var wi3 = "__title";
function Nh() {
  var e, t8, o;
  const n = p5(Vo2);
  return (o = (t8 = (e = n == null ? void 0 : n.layout) == null ? void 0 : e.docContainerConfig) == null ? void 0 : t8.sideMenu) == null || o ? (0, import_jsx_runtime3.jsx)(Lh2, {}) : null;
}
function Lh2() {
  var B, x7, M7, w, F2, P2, N, ee3, $;
  const n = useDependency(Ls), e = useDependency(vr), t8 = useObservable((0, import_react3.useMemo)(() => e.getCurrentTypeOfUnit$(we.UNIVER_DOC), [])), o = useDependency(ME), r = (x7 = (B = t8 == null ? void 0 : t8.getBody()) == null ? void 0 : B.dataStream) != null ? x7 : "", [s, i] = (0, import_react3.useState)(0), [a, c] = (0, import_react3.useState)(void 0), d = (M7 = t8 == null ? void 0 : t8.getUnitId()) != null ? M7 : "", l = o.getRenderById(d), A = t8 == null ? void 0 : t8.getTitle(), h = l == null ? void 0 : l.with(wt2), u = h == null ? void 0 : h.paragraphBounds, g = (F2 = (w = l == null ? void 0 : l.mainComponent) == null ? void 0 : w.left) != null ? F2 : 0, f2 = (P2 = l == null ? void 0 : l.engine.height) != null ? P2 : 0, p = (N = l == null ? void 0 : l.scene.scaleY) != null ? N : 1, m2 = ($ = (ee3 = t8 == null ? void 0 : t8.getBody()) == null ? void 0 : ee3.paragraphs) != null ? $ : [], I2 = (0, import_react3.useMemo)(() => {
    const U2 = /* @__PURE__ */ new Map();
    return m2.forEach((H3) => {
      U2.set(H3.startIndex, H3);
    }), U2;
  }, [m2]);
  useObservable((0, import_react3.useMemo)(() => l != null && l.engine.onTransformChange$ ? TR(l == null ? void 0 : l.engine.onTransformChange$).pipe(throttleTime(33)) : of(null), [l == null ? void 0 : l.engine.onTransformChange$]));
  const S = g < 180 ? "float" : "side-bar", v2 = m2 == null ? void 0 : m2.filter(
    (U2) => {
      var H3;
      return ((H3 = U2.paragraphStyle) == null ? void 0 : H3.namedStyleType) !== void 0 && U2.paragraphStyle.namedStyleType !== qe.SUBTITLE && U2.paragraphStyle.namedStyleType !== qe.NORMAL_TEXT;
    }
  ).map((U2) => {
    var ae2;
    const H3 = wh2(U2.paragraphStyle.namedStyleType), k7 = u == null ? void 0 : u.get(U2.startIndex);
    if (!k7) return null;
    const { paragraphStart: ne2, paragraphEnd: ie5 } = k7;
    return {
      id: U2.paragraphStyle.headingId,
      text: qo(r.slice(ne2, ie5)),
      level: H3,
      isTitle: ((ae2 = U2.paragraphStyle) == null ? void 0 : ae2.namedStyleType) === qe.TITLE
    };
  }).filter((U2) => U2 == null ? void 0 : U2.text), R = re((U2) => {
    const H3 = U2.viewportScrollY, k7 = H3 + f2 / p, ne2 = Ph(u, I2, H3, k7);
    ne2 && c(ne2);
  }), E = v2 != null && v2.find((U2) => U2.isTitle) ? v2 : [
    ...A ? [{
      id: wi3,
      text: A,
      level: 1,
      isTitle: true
    }] : [],
    ...v2 != null ? v2 : []
  ].filter(Boolean), [b2, y] = (0, import_react3.useState)(true);
  (0, import_react3.useEffect)(() => {
    const U2 = n1(i, 100), H3 = n.onCommandExecuted((k7) => {
      k7.id === M.id && k7.params.unitId === (t8 == null ? void 0 : t8.getUnitId()) && U2((ie5) => ie5 + 1);
    });
    return () => {
      H3.dispose();
    };
  }, [n, t8]), (0, import_react3.useEffect)(() => {
    const U2 = l == null ? void 0 : l.scene.getViewport(We4.VIEW_MAIN);
    if (!U2)
      return;
    const H3 = TR(U2.onScrollAfter$).pipe(throttleTime(33)).subscribe(R);
    return () => {
      H3.unsubscribe();
    };
  }, [l]);
  const C = re((U2) => {
    const H3 = l == null ? void 0 : l.scene.getViewport(We4.VIEW_MAIN);
    if (!H3)
      return;
    if (U2.id === wi3) {
      H3.scrollToViewportPos({ viewportScrollY: 0 });
      return;
    }
    const k7 = m2.find((ie5) => {
      var ae2;
      return ((ae2 = ie5.paragraphStyle) == null ? void 0 : ae2.headingId) === U2.id;
    });
    if (!k7)
      return;
    const ne2 = u == null ? void 0 : u.get(k7.startIndex);
    ne2 && (H3.scrollToViewportPos({ viewportScrollY: ne2.rect.top }), c(U2.id));
  });
  return !t8 || Yc(d) || !(E != null && E.length) ? null : (0, import_jsx_runtime3.jsx)(
    "div",
    {
      className: "univer-absolute univer-bottom-0 univer-left-0 univer-top-0 univer-z-[100] univer-w-[0px]",
      children: (0, import_jsx_runtime3.jsx)(
        Dh,
        {
          menus: E,
          open: b2,
          onOpenChange: y,
          mode: S,
          maxWidth: S === "float" ? void 0 : Math.floor(g) - 10,
          wrapperClass: "univer-mt-12",
          activeId: a,
          onClick: C,
          maxHeight: f2 - 48
        }
      )
    }
  );
}
var rt4 = {
  id: "doc-paragraph-setting.command",
  type: Ms.COMMAND,
  handler: async (n, e) => {
    var S, v2, R, E, b2;
    const t8 = n.get(m), o = n.get(vr), r = n.get(Ls), s = o.getCurrentUnitForType(we.UNIVER_DOC), i = t8.getDocRanges();
    if (!s || i.length === 0 || !e)
      return false;
    const a = i[0].segmentId, c = s.getUnitId(), d = s.getSelfOrHeaderFooterModel(a), l = (v2 = (S = d.getBody()) == null ? void 0 : S.paragraphs) != null ? v2 : [], A = (E = (R = d.getBody()) == null ? void 0 : R.dataStream) != null ? E : "", h = (b2 = Je.range.getParagraphsInRanges(i, l, A)) != null ? b2 : [], u = {
      id: M.id,
      params: {
        unitId: c,
        actions: [],
        textRanges: i
      }
    }, g = new Gn();
    g.reset();
    const f2 = new Ne(), p = Qt.getInstance();
    for (const y of h) {
      const { startIndex: C } = y;
      f2.push({
        t: Z.RETAIN,
        len: C - g.cursor
      });
      const B = {
        ...y.paragraphStyle,
        ...e.paragraph
      };
      f2.push({
        t: Z.RETAIN,
        len: 1,
        body: {
          dataStream: "",
          paragraphs: [
            {
              ...y,
              paragraphStyle: B,
              startIndex: 0
            }
          ]
        },
        coverType: pe.REPLACE
      }), g.moveCursorTo(C + 1);
    }
    const m2 = Ae2(s, a);
    return u.params.actions = p.editOp(f2.serialize(), m2), !!r.syncExecuteCommand(u.id, u.params);
  }
};
var Qh = () => {
  const n = useDependency(m), e = useDependency(tn3), t8 = (0, import_react3.useMemo)(() => n.getDocRanges(), []);
  return (0, import_react3.useEffect)(() => {
    t8.length || e.closePanel();
  }, [t8]), t8;
};
var Uh2 = () => {
  var c, d, l, A, h;
  const e = useDependency(vr).getCurrentUnitForType(we.UNIVER_DOC), t8 = Qh();
  if (!e || t8.length === 0)
    return [];
  const o = t8[0].segmentId, r = e.getSelfOrHeaderFooterModel(o), s = (d = (c = r.getBody()) == null ? void 0 : c.paragraphs) != null ? d : [], i = (A = (l = r.getBody()) == null ? void 0 : l.dataStream) != null ? A : "";
  return (h = Je.range.getParagraphsInRanges(t8, s, i)) != null ? h : [];
};
var Fh = (n, e) => {
  const t8 = useDependency(Ls), [o, r] = (0, import_react3.useState)(() => {
    var a, c;
    const i = n[0];
    return i ? String((c = (a = i.paragraphStyle) == null ? void 0 : a.horizontalAlign) != null ? c : e) : e;
  });
  return [o, (i) => (r(i), t8.executeCommand(rt4.id, {
    paragraph: { horizontalAlign: Number(i) }
  }))];
};
var Hh = (n) => {
  const e = useDependency(Ls), [t8, o] = (0, import_react3.useState)(() => {
    var i;
    const s = n[0];
    return s ? M3((i = s.paragraphStyle) == null ? void 0 : i.indentStart, 0) : 0;
  });
  return [t8, (s) => (o(s), e.executeCommand(rt4.id, {
    paragraph: { indentStart: { v: s } }
  }))];
};
var kh2 = (n) => {
  const e = useDependency(Ls), [t8, o] = (0, import_react3.useState)(() => {
    var i;
    const s = n[0];
    return s ? M3((i = s.paragraphStyle) == null ? void 0 : i.indentEnd, 0) : 0;
  });
  return [t8, (s) => (o(s), e.executeCommand(rt4.id, {
    paragraph: { indentEnd: { v: s } }
  }))];
};
var Vh2 = (n) => {
  const e = useDependency(Ls), [t8, o] = (0, import_react3.useState)(() => {
    var i;
    const s = n[0];
    return s ? M3((i = s.paragraphStyle) == null ? void 0 : i.indentFirstLine, 0) : 0;
  });
  return [t8, (s) => (o(s), e.executeCommand(rt4.id, {
    paragraph: { indentFirstLine: { v: s } }
  }))];
};
var Wh2 = (n) => {
  const e = useDependency(Ls), [t8, o] = (0, import_react3.useState)(() => {
    var i;
    const s = n[0];
    return s ? M3((i = s.paragraphStyle) == null ? void 0 : i.hanging, 0) : 0;
  });
  return [t8, (s) => (o(s), e.executeCommand(rt4.id, {
    paragraph: { hanging: { v: s } }
  }))];
};
var jh2 = (n) => {
  const e = useDependency(Ls), [t8, o] = (0, import_react3.useState)(() => {
    var i;
    const s = n[0];
    return s ? M3((i = s.paragraphStyle) == null ? void 0 : i.spaceAbove, 0) : 0;
  });
  return [t8, (s) => (o(s), e.executeCommand(rt4.id, {
    paragraph: { spaceAbove: { v: s } }
  }))];
};
var zh2 = (n) => {
  const e = useDependency(Ls), [t8, o] = (0, import_react3.useState)(() => {
    var i;
    const s = n[0];
    return s ? M3((i = s.paragraphStyle) == null ? void 0 : i.spaceBelow, 0) : 0;
  });
  return [t8, (s) => (o(s), e.executeCommand(rt4.id, {
    paragraph: { spaceBelow: { v: s } }
  }))];
};
var Gh2 = (n) => {
  const e = useDependency(Ls), t8 = useDependency(ME), o = useDependency(vr), r = (0, import_react3.useMemo)(() => {
    var g;
    const u = o.getCurrentUnitForType(we.UNIVER_DOC);
    if (u)
      return (g = t8.getRenderById(u == null ? void 0 : u.getUnitId())) == null ? void 0 : g.with(D).getSkeleton();
  }, []), s = (0, import_react3.useMemo)(() => new BehaviorSubject({}), []), [i, a] = (0, import_react3.useState)(() => {
    var g, f2;
    const u = n[0];
    return u && (f2 = (g = u.paragraphStyle) == null ? void 0 : g.lineSpacing) != null ? f2 : 1;
  }), c = (0, import_react3.useRef)(i), [d, l] = (0, import_react3.useState)(() => {
    var g, f2;
    const u = n[0];
    return u ? (f2 = (g = u.paragraphStyle) == null ? void 0 : g.spacingRule) != null ? f2 : $m.AUTO : $m.AUTO;
  }), A = async (u) => {
    a(u), s.next({ lineSpacing: u, spacingRule: d });
  }, h = async (u) => {
    if (u !== d) {
      let g = c.current;
      if (u === $m.AT_LEAST) {
        const f2 = r == null ? void 0 : r.findNodeByCharIndex(n[0].startIndex), p = f2 == null ? void 0 : f2.parent, m2 = p == null ? void 0 : p.parent;
        (m2 == null ? void 0 : m2.contentHeight) !== void 0 && (g = Math.max(m2.contentHeight, g));
      } else
        g > 5 && (g = 2);
      c.current = i, A(g), l(u), s.next({ spacingRule: u });
    }
  };
  return (0, import_react3.useEffect)(() => {
    const u = s.pipe(
      filter((g) => !!Object.keys(g).length),
      bufferTime(16),
      filter((g) => !!g.length),
      map((g) => g.reduce((f2, p) => (Object.keys(p).forEach((m2) => {
        f2[m2] = p[m2];
      }), f2), {}))
    ).subscribe((g) => e.executeCommand(rt4.id, {
      paragraph: { ...g }
    }));
    return () => u.unsubscribe();
  }, []), {
    lineSpacing: [i, A],
    spacingRule: [d, h]
  };
};
var Bt2 = (n) => {
  const { value: e, onChange: t8, className: o = "", min: r = 0, max: s = 100, step: i = 1 } = n, a = (0, import_react3.useRef)(null);
  return (0, import_jsx_runtime3.jsx)(
    xE2,
    {
      step: i,
      ref: a,
      min: r,
      max: s,
      value: e,
      onChange: (c) => {
        t8(c != null ? c : 0).finally(() => {
          setTimeout(() => {
            var d;
            (d = a.current) == null || d.focus();
          }, 30);
        });
      },
      className: o
    }
  );
};
function Yh2() {
  const n = useDependency(Fn), e = (0, import_react3.useMemo)(() => [
    { label: n.t("toolbar.alignLeft"), value: String(Ut.LEFT), icon: (0, import_jsx_runtime3.jsx)(ac2, {}) },
    { label: n.t("toolbar.alignCenter"), value: String(Ut.CENTER), icon: (0, import_jsx_runtime3.jsx)(sc, {}) },
    { label: n.t("toolbar.alignRight"), value: String(Ut.RIGHT), icon: (0, import_jsx_runtime3.jsx)(cc, {}) },
    { label: n.t("toolbar.alignJustify"), value: String(Ut.JUSTIFIED), icon: (0, import_jsx_runtime3.jsx)(Ka, {}) }
  ], []), t8 = Uh2(), [o, r] = Fh(t8, e[0].value), [s, i] = Hh(t8), [a, c] = kh2(t8), [d, l] = Vh2(t8), [A, h] = Wh2(t8), [u, g] = jh2(t8), [f2, p] = zh2(t8), { lineSpacing: [m2, I2], spacingRule: [S, v2] } = Gh2(t8), R = (0, import_react3.useMemo)(() => S === $m.AUTO ? { min: 1, max: 5, step: m2 < 2 ? 0.5 : 1 } : { min: 1, max: 100 }, [S, m2]);
  return (0, import_jsx_runtime3.jsxs)("div", { children: [
    (0, import_jsx_runtime3.jsx)("div", { className: "univer-t-4 univer-text-sm univer-font-medium", children: n.t("doc.paragraphSetting.alignment") }),
    (0, import_jsx_runtime3.jsx)(
      "div",
      {
        className: ie2("univer-mt-4 univer-box-border univer-flex univer-w-full univer-items-center univer-justify-between univer-gap-1 univer-rounded-md univer-p-1", kt2),
        children: e.map((E) => (0, import_jsx_runtime3.jsx)(Rp, { title: E.label, placement: "bottom", children: (0, import_jsx_runtime3.jsx)(
          "span",
          {
            className: ie2("hover:univer-bg-black/60 univer-flex univer-cursor-pointer univer-items-center univer-justify-center univer-rounded univer-bg-none univer-px-3 univer-py-1", {
              "univer-bg-blend-color-dodge/90": o === E.value
            }),
            onClick: () => r(E.value),
            children: E.icon
          }
        ) }, E.value))
      }
    ),
    (0, import_jsx_runtime3.jsx)("div", { className: "univer-t-4 univer-text-sm univer-font-medium", children: n.t("doc.paragraphSetting.indentation") }),
    (0, import_jsx_runtime3.jsxs)("div", { children: [
      (0, import_jsx_runtime3.jsxs)("div", { className: "univer-item-center univer-flex univer-justify-between", children: [
        (0, import_jsx_runtime3.jsxs)("div", { className: "univer-mt-3 univer-text-xs", children: [
          n.t("doc.paragraphSetting.left"),
          "(px)"
        ] }),
        (0, import_jsx_runtime3.jsx)(Bt2, { className: "univer-mt-4", value: s, onChange: (E) => i(E != null ? E : 0) })
      ] }),
      (0, import_jsx_runtime3.jsxs)("div", { className: "univer-item-center univer-flex univer-justify-between", children: [
        (0, import_jsx_runtime3.jsxs)("div", { className: "univer-mt-3 univer-text-xs", children: [
          n.t("doc.paragraphSetting.right"),
          "(px)"
        ] }),
        (0, import_jsx_runtime3.jsx)(Bt2, { className: "univer-mt-4", value: a, onChange: (E) => c(E != null ? E : 0) })
      ] }),
      (0, import_jsx_runtime3.jsxs)("div", { className: "univer-item-center univer-flex univer-justify-between", children: [
        (0, import_jsx_runtime3.jsxs)("div", { className: "univer-mt-3 univer-text-xs", children: [
          n.t("doc.paragraphSetting.firstLine"),
          "(px)"
        ] }),
        (0, import_jsx_runtime3.jsx)(Bt2, { className: "univer-mt-4", value: d, onChange: (E) => l(E != null ? E : 0) })
      ] }),
      (0, import_jsx_runtime3.jsxs)("div", { className: "univer-item-center univer-flex univer-justify-between", children: [
        (0, import_jsx_runtime3.jsxs)("div", { className: "univer-mt-3 univer-text-xs", children: [
          n.t("doc.paragraphSetting.hanging"),
          "(px)"
        ] }),
        (0, import_jsx_runtime3.jsx)(Bt2, { className: "univer-mt-4", value: A, onChange: (E) => h(E != null ? E : 0) })
      ] })
    ] }),
    (0, import_jsx_runtime3.jsx)("div", { className: "univer-t-4 univer-text-sm univer-font-medium", children: n.t("doc.paragraphSetting.spacing") }),
    (0, import_jsx_runtime3.jsxs)("div", { children: [
      (0, import_jsx_runtime3.jsxs)("div", { className: "univer-justify-betweenuniver-item-center univer-flex", children: [
        (0, import_jsx_runtime3.jsxs)("div", { className: "univer-mt-3 univer-text-xs", children: [
          n.t("doc.paragraphSetting.before"),
          "(px)"
        ] }),
        (0, import_jsx_runtime3.jsx)(Bt2, { className: "univer-mt-4", value: u, onChange: (E) => g(E != null ? E : 0) })
      ] }),
      (0, import_jsx_runtime3.jsxs)("div", { className: "univer-item-center univer-flex univer-justify-between", children: [
        (0, import_jsx_runtime3.jsxs)("div", { className: "univer-mt-3 univer-text-xs", children: [
          n.t("doc.paragraphSetting.after"),
          "(px)"
        ] }),
        (0, import_jsx_runtime3.jsx)(Bt2, { className: "univer-mt-4", value: f2, onChange: (E) => p(E != null ? E : 0) })
      ] }),
      (0, import_jsx_runtime3.jsxs)("div", { className: "item-center univer-flex univer-justify-between", children: [
        (0, import_jsx_runtime3.jsx)("div", { className: "univer-mt-3 univer-text-xs", children: n.t("doc.paragraphSetting.lineSpace") }),
        (0, import_jsx_runtime3.jsxs)(
          "div",
          {
            className: "univer-mt-4 univer-flex univer-w-[162px] univer-flex-col univer-gap-1.5",
            children: [
              (0, import_jsx_runtime3.jsx)(
                LE,
                {
                  value: `${S}`,
                  options: [
                    { label: n.t("doc.paragraphSetting.multiSpace"), value: `${$m.AUTO}` },
                    { label: n.t("doc.paragraphSetting.fixedValue"), value: `${$m.AT_LEAST}` }
                  ],
                  onChange: (E) => v2(Number(E))
                }
              ),
              (0, import_jsx_runtime3.jsx)(
                Bt2,
                {
                  ...R,
                  value: m2,
                  onChange: (E) => I2(E != null ? E : 0)
                }
              )
            ]
          }
        )
      ] })
    ] })
  ] });
}
var Kh2 = (n, e) => e.length === n.length && n.some((t8) => e.some((o) => o.startOffset === t8.startOffset && o.endOffset === t8.endOffset));
function qh2() {
  const n = useDependency(Ls), e = useDependency(Fn), t8 = useObservable(e.currentLocale$), [o, r] = (0, import_react3.useState)(""), s = (0, import_react3.useMemo)(() => n1(() => r(et(4)), 300), []), i = (0, import_react3.useRef)([]);
  return (0, import_react3.useEffect)(() => {
    const a = n.onCommandExecuted((c) => {
      if (k.id === c.id) {
        const d = c.params.ranges;
        Kh2(d, i.current) || r(et(4)), i.current = d;
      }
      M.id === c.id && c.params.trigger !== rt4.id && s();
    });
    return () => a.dispose();
  }, [s]), (0, import_react3.useEffect)(() => {
    r(et(4));
  }, [t8]), (0, import_react3.useEffect)(() => () => s.cancel(), [s]), (0, import_jsx_runtime3.jsx)(Yh2, {}, o);
}
var Xh = Object.getOwnPropertyDescriptor;
var Zh2 = (n, e, t8, o) => {
  for (var r = o > 1 ? void 0 : o ? Xh(e, t8) : e, s = n.length - 1, i; s >= 0; s--)
    (i = n[s]) && (r = i(r) || r);
  return r;
};
var or4 = (n, e) => (t8, o) => e(t8, o, n);
var Pi2 = "doc_ui_paragraph-setting-panel";
var tn3 = class extends Ve {
  constructor(e, t8, o) {
    super();
    O(this, "_id");
    this._commandService = e, this._componentManager = t8, this._sidebarService = o, this._init();
  }
  _init() {
    this.disposeWithMe(this._componentManager.register(Pi2, qh2));
  }
  openPanel() {
    const e = {
      header: { title: "doc.slider.paragraphSetting" },
      id: this._id,
      children: {
        label: Pi2
      },
      width: 300
    };
    this._sidebarService.open(e);
  }
  closePanel() {
    this._sidebarService.close(this._id);
  }
};
tn3 = Zh2([
  or4(0, Ls),
  or4(1, Inject(S1)),
  or4(2, Inject(we3))
], tn3);
var Ds = {
  id: "sidebar.operation.doc-paragraph-setting-panel",
  type: Ms.OPERATION,
  handler: (n) => (n.get(tn3).openPanel(), true)
};
var ws2 = (n) => {
  const e = n.get(m);
  return new Observable((t8) => {
    const o = e.textSelection$.subscribe(() => {
      e.getDocRanges().some((i) => i.collapsed === false || i.rangeType === jg.RECT) ? t8.next(false) : t8.next(true);
    });
    return () => o.unsubscribe();
  });
};
function Jh(n) {
  if (n.length < 2)
    return true;
  const e = n.map((t8) => t8.tableId);
  return e.every((t8) => t8 === e[0]);
}
function Ni(n, e, t8) {
  var s;
  const o = e.getRectRanges(), r = e.getActiveTextRange();
  if (o && o.length && Jh(o) && r == null) {
    n.next(false);
    return;
  }
  if (r && (o == null || o.length === 0)) {
    const { segmentId: i, startOffset: a, endOffset: c } = r, d = t8.getCurrentUniverDocInstance(), l = (s = d == null ? void 0 : d.getSelfOrHeaderFooterModel(i).getBody()) == null ? void 0 : s.tables;
    if (l && l.length && l.some((A) => {
      const { startIndex: h, endIndex: u } = A;
      return a > h && a < u || c > h && c < u;
    })) {
      n.next(false);
      return;
    }
  }
  n.next(true);
}
var dt2 = (n) => {
  const e = n.get(m), t8 = n.get(vr);
  return new Observable((o) => {
    const r = e.textSelection$.subscribe(() => {
      Ni(o, e, t8);
    });
    return Ni(o, e, t8), () => r.unsubscribe();
  });
};
var $h = (n) => ({
  id: ro2.name,
  commandId: ro2.id,
  type: H1.BUTTON,
  icon: "CopyDoubleIcon",
  title: "rightClick.copy",
  disabled$: ws2(n),
  hidden$: Bi(n, we.UNIVER_DOC)
});
var eg3 = (n) => ({
  id: Ds.id,
  type: H1.BUTTON,
  icon: "MenuIcon",
  title: "doc.menu.paragraphSetting",
  hidden$: Bi(n, we.UNIVER_DOC)
});
var tg2 = (n) => ({
  id: rs.id,
  type: H1.BUTTON,
  icon: "CopyDoubleIcon",
  title: "rightClick.cut",
  disabled$: ws2(n),
  hidden$: Bi(n, we.UNIVER_DOC)
});
var ng3 = (n) => ({
  id: is.id,
  type: H1.BUTTON,
  icon: "PasteSpecialDoubleIcon",
  title: "rightClick.paste",
  hidden$: Bi(n, we.UNIVER_DOC)
});
var og = (n) => ({
  id: Do2.id,
  type: H1.BUTTON,
  icon: "PasteSpecialDoubleIcon",
  title: "rightClick.delete",
  disabled$: ws2(n),
  hidden$: Bi(n, we.UNIVER_DOC)
});
var vc = "doc.menu.table-insert";
function rg(n) {
  return {
    id: vc,
    type: H1.SUBITEMS,
    title: "table.insert",
    icon: "InsertDoubleIcon",
    hidden$: combineLatest(Bi(n, we.UNIVER_DOC), dt2(n), (e, t8) => e || t8)
  };
}
function sg(n) {
  return {
    id: Rs2.id,
    type: H1.BUTTON,
    title: "table.insertRowAbove",
    icon: "InsertRowAboveDoubleIcon",
    disabled$: dt2(n),
    hidden$: Bi(n, we.UNIVER_DOC)
  };
}
function ig(n) {
  return {
    id: bs2.id,
    type: H1.BUTTON,
    title: "table.insertRowBelow",
    icon: "InsertRowBelowDoubleIcon",
    disabled$: dt2(n),
    hidden$: Bi(n, we.UNIVER_DOC)
  };
}
function ag(n) {
  return {
    id: ys.id,
    type: H1.BUTTON,
    title: "table.insertColumnLeft",
    icon: "LeftInsertColumnDoubleIcon",
    disabled$: dt2(n),
    hidden$: Bi(n, we.UNIVER_DOC)
  };
}
function cg(n) {
  return {
    id: xs.id,
    type: H1.BUTTON,
    title: "table.insertColumnRight",
    icon: "RightInsertColumnDoubleIcon",
    disabled$: dt2(n),
    hidden$: Bi(n, we.UNIVER_DOC)
  };
}
var Cc = "doc.menu.table-delete";
function lg(n) {
  return {
    id: Cc,
    type: H1.SUBITEMS,
    title: "table.delete",
    icon: "ReduceDoubleIcon",
    hidden$: combineLatest(Bi(n, we.UNIVER_DOC), dt2(n), (e, t8) => e || t8)
  };
}
function dg(n) {
  return {
    id: Is.id,
    type: H1.BUTTON,
    title: "table.deleteRows",
    icon: "DeleteRowDoubleIcon",
    disabled$: dt2(n),
    hidden$: Bi(n, we.UNIVER_DOC)
  };
}
function Ag(n) {
  return {
    id: Ss.id,
    type: H1.BUTTON,
    title: "table.deleteColumns",
    icon: "DeleteColumnDoubleIcon",
    disabled$: dt2(n),
    hidden$: Bi(n, we.UNIVER_DOC)
  };
}
function ug(n) {
  return {
    id: Hn2.id,
    type: H1.BUTTON,
    title: "table.deleteTable",
    icon: "GridIcon",
    disabled$: dt2(n),
    hidden$: Bi(n, we.UNIVER_DOC)
  };
}
var hg = {
  [G1.FORMAT]: {
    [Lt2.id]: {
      order: 0,
      menuItemFactory: cu
    },
    [Qt5.id]: {
      order: 1,
      menuItemFactory: lu
    },
    [Ut3.id]: {
      order: 2,
      menuItemFactory: du
    },
    [Ft4.id]: {
      order: 3,
      menuItemFactory: Au
    },
    [bt3.id]: {
      order: 4,
      menuItemFactory: uu2
    },
    [Ht2.id]: {
      order: 5,
      menuItemFactory: hu
    },
    [Xe3.id]: {
      order: 5.5,
      menuItemFactory: pu
    },
    [ct3.id]: {
      order: 6,
      menuItemFactory: fu
    },
    [en3.id]: {
      order: 7,
      menuItemFactory: gu
    },
    [mt2.id]: {
      order: 8,
      menuItemFactory: mu2
    },
    [Et.id]: {
      order: 9,
      menuItemFactory: Bu2,
      [Un2.id]: {
        order: 0,
        menuItemFactory: Tu2
      }
    }
  },
  [G1.LAYOUT]: {
    [Qo3.id]: {
      order: 2,
      menuItemFactory: Cu
    },
    [Uo2.id]: {
      order: 3,
      menuItemFactory: Ru2
    },
    [Fo2.id]: {
      order: 4,
      menuItemFactory: bu
    },
    [Ho2.id]: {
      order: 5,
      menuItemFactory: yu
    },
    [Po2.id]: {
      order: 6,
      menuItemFactory: xu
    },
    [On2.id]: {
      order: 7,
      menuItemFactory: bi2
    },
    [xn3.id]: {
      order: 8,
      menuItemFactory: yi2
    },
    [so2.id]: {
      order: 9,
      menuItemFactory: xi
    },
    [Bs2.id]: {
      order: 10,
      menuItemFactory: Eu2
    },
    [ko2.id]: {
      order: 11,
      menuItemFactory: Ou
    },
    [_s.id]: {
      order: 12,
      menuItemFactory: Mu
    }
  },
  [De.MEDIA]: {
    [mc]: {
      order: 2,
      menuItemFactory: Su,
      [Os2.id]: {
        order: 0,
        menuItemFactory: vu
      }
    }
  },
  [Y1.MAIN_AREA]: {
    [a12.FORMAT]: {
      [ro2.name]: {
        order: 0,
        menuItemFactory: $h
      },
      [rs.id]: {
        order: 1,
        menuItemFactory: tg2
      },
      [is.id]: {
        order: 2,
        menuItemFactory: ng3
      },
      [Do2.id]: {
        order: 3,
        menuItemFactory: og
      }
    },
    [a12.LAYOUT]: {
      [Ds.id]: {
        order: 0,
        menuItemFactory: eg3
      },
      [vc]: {
        order: 1,
        menuItemFactory: rg,
        [Rs2.id]: {
          order: 1,
          menuItemFactory: sg
        },
        [bs2.id]: {
          order: 2,
          menuItemFactory: ig
        },
        [ys.id]: {
          order: 3,
          menuItemFactory: ag
        },
        [xs.id]: {
          order: 4,
          menuItemFactory: cg
        }
      },
      [Cc]: {
        order: 2,
        menuItemFactory: lg,
        [Is.id]: {
          order: 1,
          menuItemFactory: dg
        },
        [Ss.id]: {
          order: 2,
          menuItemFactory: Ag
        },
        [Hn2.id]: {
          order: 3,
          menuItemFactory: ug
        }
      }
    }
  },
  [Y1.PARAGRAPH]: {
    [a12.QUICK]: {
      [us2.id]: {
        order: 0,
        menuItemFactory: Du
      },
      [hs2.id]: {
        order: 1,
        menuItemFactory: wu
      },
      [gs2.id]: {
        order: 2,
        menuItemFactory: Pu3
      },
      [fs.id]: {
        order: 3,
        menuItemFactory: Nu2
      },
      [ps.id]: {
        order: 4,
        menuItemFactory: Lu
      },
      [io2.id]: {
        order: 5,
        menuItemFactory: Qu2
      },
      [On2.id]: {
        order: 6,
        menuItemFactory: bi2
      },
      [xn3.id]: {
        order: 7,
        menuItemFactory: yi2
      },
      [so2.id]: {
        order: 8,
        menuItemFactory: xi
      }
    },
    [a12.FORMAT]: {
      [os.id]: {
        order: 0,
        menuItemFactory: Uu
      },
      [ss2.id]: {
        order: 1,
        menuItemFactory: Fu2
      },
      [es.id]: {
        order: 2,
        menuItemFactory: Hu
      }
    },
    [a12.LAYOUT]: {
      // title: 'rightClick.insertBellow',
      [Ic]: {
        menuItemFactory: zu,
        [ls2.id]: {
          order: 0,
          menuItemFactory: ku2
        },
        [ds2.id]: {
          order: 1,
          menuItemFactory: Vu
        },
        [As.id]: {
          order: 2,
          menuItemFactory: Wu
        },
        [as.id]: {
          order: 3,
          menuItemFactory: ju
        }
      }
    }
  }
};
var gg = Object.getOwnPropertyDescriptor;
var fg = (n, e, t8, o) => {
  for (var r = o > 1 ? void 0 : o ? gg(e, t8) : e, s = n.length - 1, i; s >= 0; s--)
    (i = n[s]) && (r = i(r) || r);
  return r;
};
var st3 = (n, e) => (t8, o) => e(t8, o, n);
var Ao2 = class extends Ve {
  constructor(n, e, t8, o, r, s, i, a, c) {
    super(), this._injector = n, this._componentManager = e, this._commandService = t8, this._layoutService = o, this._menuManagerService = r, this._uiPartsService = s, this._univerInstanceService = i, this._shortcutService = a, this._configService = c, this._init();
  }
  _initCustomComponents() {
    [
      [fc2, nu],
      [gc2, eu],
      ["TodoListDoubleIcon", lc2],
      ["doc.paragraph.menu", ah],
      ["CutIcon", Xa2],
      ["DeleteIcon", Za],
      [Rr2, ru],
      ["DocumentSettingIcon", Ja]
    ].forEach(([n, e]) => {
      this.disposeWithMe(
        this._componentManager.register(n, e)
      );
    });
  }
  _initUiParts() {
    this.disposeWithMe(this._uiPartsService.registerComponent(c12.FOOTER, () => connectInjector(Oh, this._injector))), this.disposeWithMe(this._uiPartsService.registerComponent(c12.CONTENT, () => connectInjector(Nh, this._injector)));
  }
  _initMenus() {
    this._menuManagerService.mergeMenu(hg);
  }
  _initShortCut() {
    [
      Ah,
      uh,
      hh,
      gh2,
      fh2,
      ph2,
      Ih2,
      Sh,
      Eh2,
      mh2,
      vh2,
      Ch,
      lh
    ].forEach((n) => {
      this.disposeWithMe(this._shortcutService.registerShortcut(n));
    });
  }
  _init() {
    this._initCustomComponents(), this._initMenus(), this._initFocusHandler(), this._initCommands(), this._initUiParts(), this._initShortCut();
  }
  _initCommands() {
    [
      Ac,
      Bs2,
      Ts2
    ].forEach((n) => this.disposeWithMe(this._commandService.registerCommand(n)));
  }
  _initFocusHandler() {
    this.disposeWithMe(
      this._layoutService.registerFocusHandler(we.UNIVER_DOC, (n) => {
        this._injector.get(ME).getRenderById(n).with(Re2).focus();
      })
    );
  }
};
Ao2 = fg([
  st3(0, Inject(Injector)),
  st3(1, Inject(S1)),
  st3(2, Ls),
  st3(3, U1),
  st3(4, B12),
  st3(5, D1),
  st3(6, vr),
  st3(7, ye3),
  st3(8, ic)
], Ao2);
var pg = Object.getOwnPropertyDescriptor;
var mg = (n, e, t8, o) => {
  for (var r = o > 1 ? void 0 : o ? pg(e, t8) : e, s = n.length - 1, i; s >= 0; s--)
    (i = n[s]) && (r = i(r) || r);
  return r;
};
var rr3 = (n, e) => (t8, o) => e(t8, o, n);
var Li2 = 1.5;
var uo3 = class extends h1 {
  constructor(n, e, t8, o) {
    super(), this._context = n, this._textSelectionManagerService = e, this._editorService = t8, this._docSkeletonManagerService = o, this._init();
  }
  _init() {
    this._textSelectionManagerService.textSelection$.pipe(takeUntil(this.dispose$)).subscribe((n) => {
      if (n == null)
        return;
      const { isEditing: e, unitId: t8 } = n;
      t8 !== this._context.unitId || !e || this._context.unitId !== Dl && this._scrollToSelection();
    });
  }
  scrollToRange(n) {
    const e = this._docSkeletonManagerService.getSkeleton();
    if (!e)
      return;
    const { startOffset: t8 } = n, o = e.findNodePositionByCharIndex(t8);
    o && this.scrollToNode(o);
  }
  scrollToNode(n) {
    var C;
    const { unitId: e, scene: t8, mainComponent: o } = this._context, r = this._docSkeletonManagerService.getSkeleton();
    if (o == null || r == null)
      return;
    const s = o.getOffsetConfig(), { docsLeft: i, docsTop: a } = s, c = new It2(s, r), { contentBoxPointGroup: d } = c.getRangePointData(n, n), { left: l, top: A, height: h } = Jn2(d), u = l + i, g = A + a, f2 = t8.getViewport(We4.VIEW_MAIN), p = this._editorService.getEditor(e);
    if (f2 == null)
      return;
    const {
      left: m2,
      top: I2,
      right: S,
      bottom: v2
    } = f2.getBounding().viewBound;
    let R = 0, E = 0;
    const b2 = p ? (C = p.params.backScrollOffset) != null ? C : 0 : 100;
    g < I2 ? R = g - I2 - b2 : g > v2 - h && (R = g - v2 + h + b2), u < m2 ? E = u - m2 : u > S - Li2 && (E = u - S + Li2);
    const y = f2.transViewportScroll2ScrollValue(E, R);
    f2.scrollByBarDeltaValue(y);
  }
  // Let the selection show on the current screen.
  _scrollToSelection() {
    const n = this._textSelectionManagerService.getActiveTextRange();
    if (n == null)
      return;
    const { collapsed: e, startNodePosition: t8 } = n;
    e && this.scrollToNode(t8);
  }
};
uo3 = mg([
  rr3(1, Inject(m)),
  rr3(2, Ge2),
  rr3(3, Inject(D))
], uo3);
var Eg = Object.getOwnPropertyDescriptor;
var Ig = (n, e, t8, o) => {
  for (var r = o > 1 ? void 0 : o ? Eg(e, t8) : e, s = n.length - 1, i; s >= 0; s--)
    (i = n[s]) && (r = i(r) || r);
  return r;
};
var jt2 = (n, e) => (t8, o) => e(t8, o, n);
var br = class extends h1 {
  constructor(n, e, t8, o, r, s, i) {
    super(), this._context = n, this._commandService = e, this._docSelectionRenderService = t8, this._docSkeletonManagerService = o, this._editorService = r, this._renderManagerService = s, this._univerInstanceService = i, this._addNewRender(), this._initRenderRefresh(), this._initCommandListener();
  }
  reRender(n) {
    var s, i;
    const e = (s = this._renderManagerService.getRenderById(n)) == null ? void 0 : s.with(D), t8 = e == null ? void 0 : e.getSkeleton();
    if (!t8 || !!t8.getViewModel().getDataModel().getSnapshot().disabled)
      return;
    t8.calculate();
    const r = this._editorService.getEditor(n);
    if (this._editorService.isEditor(n) && !(r != null && r.params.scrollBar)) {
      (i = this._context.mainComponent) == null || i.makeDirty();
      return;
    }
    this._recalculateSizeBySkeleton(t8);
  }
  _addNewRender() {
    const { scene: n, engine: e } = this._context, t8 = new tA(We4.VIEW_MAIN, n, {
      left: 0,
      top: 0,
      bottom: 0,
      right: 0,
      isWheelPreventDefaultX: true
    });
    n.attachControl(), n.onMouseWheel$.subscribeEvent((r, s) => {
      const i = this._univerInstanceService.getCurrentUnitForType(we.UNIVER_DOC);
      if ((i == null ? void 0 : i.getUnitId()) !== this._context.unitId)
        return;
      const a = r;
      if (a.ctrlKey) {
        const c = Math.abs(a.deltaX);
        let d = c < 40 ? 0.2 : c < 80 ? 0.4 : 0.2;
        d *= a.deltaY > 0 ? -1 : 1, n.scaleX < 1 && (d /= 2), n.scaleX + d > 4 ? n.scale(4, 4) : n.scaleX + d < 0.1 ? n.scale(0.1, 0.1) : a.preventDefault();
      } else
        t8.onMouseWheel(a, s);
    }), new D8(t8), n.addLayer(
      new j8(n, [], zo2),
      new j8(n, [], ad)
    ), this._addComponent();
    const o = () => n.render();
    this.disposeWithMe(this._context.activated$.subscribe((r) => {
      r ? e.runRenderLoop(o) : e.stopRenderLoop(o);
    })), this._docSelectionRenderService.__attachScrollEvent();
  }
  _addComponent() {
    const { scene: n, unit: e, components: t8 } = this._context, s = {
      pageMarginLeft: 20,
      pageMarginTop: 20
    }, i = new ve($e3.MAIN, void 0, s);
    i.zIndex = Js;
    const a = new w8($e3.BACKGROUND, void 0, s);
    a.zIndex = Js, this._context.mainComponent = i, t8.set($e3.MAIN, i), t8.set($e3.BACKGROUND, a), n.addObjects([i], zo2), n.addObjects([a], id), this._editorService.getEditor(e.getUnitId()) == null && n.enableLayerCache(zo2);
  }
  _initRenderRefresh() {
    this._docSkeletonManagerService.currentSkeletonBefore$.pipe(takeUntil(this.dispose$)).subscribe((n) => {
      this._create(n);
    });
  }
  _create(n) {
    var a;
    if (!n)
      return;
    const { mainComponent: e, components: t8 } = this._context, o = e, r = t8.get($e3.BACKGROUND);
    o.changeSkeleton(n), r.changeSkeleton(n);
    const { unitId: s } = this._context, i = this._editorService.getEditor(s);
    if (this._editorService.isEditor(s) && !(i != null && i.params.scrollBar)) {
      (a = this._context.mainComponent) == null || a.makeDirty();
      return;
    }
    this._recalculateSizeBySkeleton(n);
  }
  _initCommandListener() {
    const n = [M.id];
    this.disposeWithMe(this._commandService.onCommandExecuted((e) => {
      if (n.includes(e.id)) {
        const t8 = e.params, { unitId: o } = t8;
        this.reRender(o);
      }
    }));
  }
  _recalculateSizeBySkeleton(n) {
    var u;
    const { mainComponent: e, scene: t8, unitId: o, components: r } = this._context, s = e, i = r.get($e3.BACKGROUND), a = (u = n.getSkeletonData()) == null ? void 0 : u.pages;
    if (a == null)
      return;
    let c = 0, d = 0;
    const A = this._context.unit.getSnapshot().documentStyle.documentFlavor;
    for (let g = 0, f2 = a.length; g < f2; g++) {
      const p = a[g];
      let { pageWidth: m2, pageHeight: I2 } = p;
      if (A === uu.MODERN) {
        const S = Sg(p);
        m2 = S.pageWidth, I2 = S.pageHeight;
      }
      s.pageLayoutType === Q2.VERTICAL ? (d += I2, d += s.pageMarginTop, g === f2 - 1 && (d += s.pageMarginTop), c = Math.max(c, m2)) : s.pageLayoutType === Q2.HORIZONTAL && (c += m2, g !== f2 - 1 && (c += s.pageMarginLeft), d = Math.max(d, I2));
    }
    s.resize(c, d), i.resize(c, d);
    const h = this._editorService.getEditor(o);
    (!this._editorService.isEditor(o) || h != null && h.params.scrollBar) && t8.resize(c, d);
  }
};
br = Ig([
  jt2(1, Ls),
  jt2(2, Inject(Re2)),
  jt2(3, Inject(D)),
  jt2(4, Ge2),
  jt2(5, ME),
  jt2(6, vr)
], br);
function Sg(n) {
  let { pageWidth: e, pageHeight: t8 } = n;
  const { marginLeft: o, marginRight: r, marginTop: s, marginBottom: i, skeDrawings: a, skeTables: c } = n;
  e === Number.POSITIVE_INFINITY && (e = n.width + o + r), t8 === Number.POSITIVE_INFINITY && (t8 = n.height + s + i);
  for (const d of a.values())
    e = Math.max(e, d.aLeft + d.width + o + r), t8 = Math.max(t8, d.aTop + d.height + s + i);
  for (const d of c.values())
    e = Math.max(e, d.left + d.width + o + r), t8 = Math.max(t8, d.top + d.height + s + i);
  return { pageWidth: e, pageHeight: t8 };
}
var vg = Object.getOwnPropertyDescriptor;
var Cg = (n, e, t8, o) => {
  for (var r = o > 1 ? void 0 : o ? vg(e, t8) : e, s = n.length - 1, i; s >= 0; s--)
    (i = n[s]) && (r = i(r) || r);
  return r;
};
var sr4 = (n, e) => (t8, o) => e(t8, o, n);
var yr2 = class {
  constructor(n, e, t8) {
    O(this, "_docContainer");
    O(this, "getComponent", (n2) => {
      if (this._docContainer = n2, !n2.getContentRef().current)
        throw new Error("container is not ready");
    });
    O(this, "changeLocale", (n2) => {
      this._localeService.setLocale(n2);
    });
    this._localeService = n, this._injector = e, this._configService = t8;
  }
  getUIConfig() {
    return {
      injector: this._injector,
      config: this._configService.getConfig(Vo2),
      changeLocale: this.changeLocale,
      getComponent: this.getComponent
    };
  }
  getContentRef() {
    return this._docContainer.getContentRef();
  }
  UIDidMount(n) {
    if (this._docContainer)
      return n(this._docContainer);
  }
  getDocContainer() {
    return this._docContainer;
  }
};
yr2 = Cg([
  sr4(0, Inject(Fn)),
  sr4(1, Inject(Injector)),
  sr4(2, ic)
], yr2);
var Rg2 = Object.getOwnPropertyDescriptor;
var bg = (n, e, t8, o) => {
  for (var r = o > 1 ? void 0 : o ? Rg2(e, t8) : e, s = n.length - 1, i; s >= 0; s--)
    (i = n[s]) && (r = i(r) || r);
  return r;
};
var yg = (n, e) => (t8, o) => e(t8, o, n);
var ho2 = class extends h1 {
  constructor(e) {
    super();
    O(this, "_docContainerController");
    this._injector = e, this._docContainerController = this._injector.createInstance(yr2);
  }
};
ho2 = bg([
  yg(0, Inject(Injector))
], ho2);
var xg = Object.getOwnPropertyDescriptor;
var Og = (n, e, t8, o) => {
  for (var r = o > 1 ? void 0 : o ? xg(e, t8) : e, s = n.length - 1, i; s >= 0; s--)
    (i = n[s]) && (r = i(r) || r);
  return r;
};
var Qi2 = (n, e) => (t8, o) => e(t8, o, n);
var go2 = class extends Ve {
  constructor(n, e) {
    super(), this._docAutoFormatService = n, this._renderManagerService = e, this._initListTabAutoFormat(), this._initSpaceAutoFormat(), this._initDefaultEnterFormat(), this._initExitListAutoFormat();
  }
  _initListTabAutoFormat() {
    this.disposeWithMe(
      this._docAutoFormatService.registerAutoFormat({
        id: Zt3.id,
        match: (n) => {
          var r;
          const { selection: e, paragraphs: t8, unit: o } = n;
          if (t8.length === 1 && e.startOffset === t8[0].paragraphStart && t8[0].bullet) {
            const s = (r = o.getBody()) == null ? void 0 : r.paragraphs, i = s == null ? void 0 : s.filter((a) => {
              var c;
              return ((c = a.bullet) == null ? void 0 : c.listId) === t8[0].bullet.listId;
            });
            return (i == null ? void 0 : i.findIndex((a) => a.startIndex === t8[0].startIndex)) !== 0;
          } else if (t8.length > 1 && t8.some((s) => s.bullet))
            return true;
          return false;
        },
        // traverse all paragraphs, set paragraph
        getMutations(n) {
          const e = n.commandParams;
          return [{
            id: gr2.id,
            params: {
              type: e != null && e.shift ? qn3.decrease : qn3.increase
            }
          }];
        },
        priority: 100
      })
    ), this.disposeWithMe(
      this._docAutoFormatService.registerAutoFormat({
        id: Zt3.id,
        match: (n) => {
          const { selection: e, unit: t8 } = n, { startNodePosition: o, endNodePosition: r } = e, s = this._renderManagerService.getRenderById(t8.getUnitId()), i = s == null ? void 0 : s.with(D).getSkeleton();
          return i == null ? false : !!(o && r && Ha(i, o, r) || o && !r && o.path.indexOf("cells") > -1);
        },
        getMutations(n) {
          const e = n.commandParams;
          return [{
            id: za.id,
            params: {
              shift: !!(e != null && e.shift)
            }
          }];
        },
        priority: 99
      })
    );
  }
  _initSpaceAutoFormat() {
    this.disposeWithMe(
      this._docAutoFormatService.registerAutoFormat({
        id: Mo2.id,
        match: (n) => {
          var s;
          const { selection: e, paragraphs: t8, unit: o } = n;
          if (!e.collapsed || t8.length !== 1 || !e.collapsed)
            return false;
          const r = (s = o.getBody()) == null ? void 0 : s.dataStream.slice(t8[0].paragraphStart, e.startOffset - 1);
          return !!(r && (Object.keys(SR).includes(r) || Object.keys(qo3).includes(r)));
        },
        getMutations(n) {
          var s;
          const { paragraphs: e, unit: t8, selection: o } = n, r = (s = t8.getBody()) == null ? void 0 : s.dataStream.slice(e[0].paragraphStart, o.startOffset - 1);
          if (r && Object.keys(SR).includes(r)) {
            const i = SR[r];
            return [{
              id: Na.id,
              params: {
                listType: i,
                paragraph: e[0]
              }
            }];
          }
          if (r && Object.keys(qo3).includes(r)) {
            const i = qo3[r];
            return [{
              id: La.id,
              params: {
                value: i
              }
            }];
          }
          return [];
        }
      })
    );
  }
  _initExitListAutoFormat() {
    this.disposeWithMe(
      this._docAutoFormatService.registerAutoFormat({
        id: bn2.id,
        match: (n) => {
          const { paragraphs: e } = n;
          return !!(e.length === 1 && e[0].bullet && e[0].paragraphStart === e[0].paragraphEnd);
        },
        getMutations: (n) => {
          const e = n.paragraphs[0].bullet;
          return e ? e.nestingLevel > 0 ? [{
            id: gr2.id,
            params: {
              type: qn3.decrease
            }
          }] : [{
            id: Fn4.id,
            params: {
              listType: n.paragraphs[0].bullet.listType
            }
          }] : [];
        }
      })
    );
  }
  _initDefaultEnterFormat() {
    this.disposeWithMe(
      this._docAutoFormatService.registerAutoFormat({
        id: bn2.id,
        match: () => true,
        getMutations() {
          return [{
            id: Gr.id
          }];
        },
        priority: -9999
      })
    );
  }
};
go2 = Og([
  Qi2(0, Inject(Dt)),
  Qi2(1, ME)
], go2);
function Tg(n) {
  return n.rows[0].cells[0].sections[0].columns[0].lines[0];
}
function Bg2(n) {
  const e = n.rows[n.rows.length - 1], t8 = e.cells[e.cells.length - 1];
  return Yy(t8);
}
function Mg(n, e) {
  const { ed: t8 } = n, { skeTables: o } = e;
  let r = null;
  for (const s of o.values())
    if (s.st === t8 + 1) {
      r = s;
      break;
    }
  return r;
}
function Ui2(n) {
  const e = n == null ? void 0 : n.parent;
  let t8 = null, o = null;
  if (n == null || e == null)
    return {
      lineBeforeTable: t8,
      lineAfterTable: o
    };
  const { st: r, ed: s } = n, i = e.type === c1.CELL ? [e] : e.parent.pages;
  return d0(i, (a) => {
    a.st === s + 1 ? o = a : a.ed === r - 1 && (t8 = a);
  }), {
    lineBeforeTable: t8,
    lineAfterTable: o
  };
}
function Rc2(n) {
  return n.sections[0].columns[0].lines.length === 0;
}
function bc(n) {
  var i, a;
  const e = n.parent, t8 = e == null ? void 0 : e.parent, o = t8 == null ? void 0 : t8.tableId;
  if (e == null || t8 == null)
    return;
  const r = e.cells.indexOf(n);
  let s = t8.rows[t8.rows.indexOf(e) + 1];
  if (s == null && o.indexOf("#-#")) {
    const [c, d] = o.split("#-#"), l = (a = (i = t8.parent) == null ? void 0 : i.parent) == null ? void 0 : a.pages, A = `${c}#-#${Number.parseInt(d) + 1}`;
    if (l)
      for (const h of l) {
        const { skeTables: u } = h;
        if (u.has(A)) {
          const g = u.get(A);
          if (g != null && g.rows.length) {
            s = g.rows.find((f2) => !f2.isRepeatRow);
            break;
          }
        }
      }
  }
  if (s != null) {
    const c = s.cells[r];
    return Rc2(c) ? bc(c) : c;
  }
}
function yc(n) {
  var s, i;
  const e = n.parent, t8 = e == null ? void 0 : e.parent;
  if (e == null || t8 == null)
    return;
  let o = t8.rows[t8.rows.indexOf(e) - 1];
  const r = e.cells.indexOf(n);
  if ((o == null || o.isRepeatRow) && t8.tableId.indexOf("#-#")) {
    const [a, c] = t8.tableId.split("#-#"), d = (i = (s = t8.parent) == null ? void 0 : s.parent) == null ? void 0 : i.pages, l = `${a}#-#${Number.parseInt(c) - 1}`;
    if (d)
      for (const A of d) {
        const { skeTables: h } = A;
        if (h.has(l)) {
          const u = h.get(l);
          if (u != null && u.rows.length) {
            o = u.rows[u.rows.length - 1];
            break;
          }
        }
      }
  }
  if (o != null) {
    const a = o.cells[r];
    return Rc2(a) ? yc(a) : a;
  }
}
function _g(n, e) {
  const { st: t8 } = n, { skeTables: o } = e;
  let r = null;
  for (const s of o.values())
    if (s.ed === t8 - 1) {
      r = s;
      break;
    }
  return r;
}
function Dg(n) {
  return n.sections[0].columns[0].lines[0];
}
function wg(n) {
  const e = IB(n);
  return e.lines[e.lines.length - 1];
}
var Pg = Object.getOwnPropertyDescriptor;
var Ng = (n, e, t8, o) => {
  for (var r = o > 1 ? void 0 : o ? Pg(e, t8) : e, s = n.length - 1, i; s >= 0; s--)
    (i = n[s]) && (r = i(r) || r);
  return r;
};
var jn3 = (n, e) => (t8, o) => e(t8, o, n);
var fo4 = class extends Ve {
  constructor(e, t8, o, r) {
    super();
    O(this, "_onInputSubscription");
    this._univerInstanceService = e, this._renderManagerService = t8, this._textSelectionManagerService = o, this._commandService = r, this._commandExecutedListener();
  }
  dispose() {
    var e;
    super.dispose(), (e = this._onInputSubscription) == null || e.unsubscribe();
  }
  _commandExecutedListener() {
    const e = [St2.id, vt2.id];
    this.disposeWithMe(
      this._commandService.onCommandExecuted((t8) => {
        if (!e.includes(t8.id))
          return;
        const o = t8.params;
        switch (t8.id) {
          case St2.id:
            return this._handleMoveCursor(o.direction);
          case vt2.id:
            return this._handleShiftMoveSelection(o.direction);
          default:
            throw new Error("Unknown command");
        }
      })
    );
  }
  // eslint-disable-next-line max-lines-per-function, complexity
  _handleShiftMoveSelection(e) {
    var S, v2, R;
    const t8 = this._textSelectionManagerService.getActiveTextRange(), o = this._textSelectionManagerService.getTextRanges(), r = this._univerInstanceService.getCurrentUniverDocInstance();
    if (r == null)
      return;
    const s = (S = this._renderManagerService.getRenderById(r.getUnitId())) == null ? void 0 : S.with(D).getSkeleton(), i = this._getDocObject();
    if (t8 == null || s == null || i == null)
      return;
    const {
      startOffset: a,
      endOffset: c,
      style: d,
      collapsed: l,
      direction: A,
      segmentId: h,
      startNodePosition: u,
      endNodePosition: g,
      segmentPage: f2
    } = t8;
    if (o.length > 1) {
      let E = Number.POSITIVE_INFINITY, b2 = Number.NEGATIVE_INFINITY;
      for (const y of o)
        E = Math.min(E, y.startOffset), b2 = Math.max(b2, y.endOffset);
      this._textSelectionManagerService.replaceTextRanges([
        {
          startOffset: e === Cm.LEFT || e === Cm.UP ? b2 : E,
          endOffset: e === Cm.LEFT || e === Cm.UP ? E : b2,
          style: d
        }
      ], false);
      return;
    }
    const p = l || A === Bg.FORWARD ? a : c;
    let m2 = l || A === Bg.FORWARD ? c : a;
    const I2 = (v2 = r.getSelfOrHeaderFooterModel(h).getBody().dataStream.length) != null ? v2 : Number.POSITIVE_INFINITY;
    if (e === Cm.LEFT || e === Cm.RIGHT) {
      const E = s.findNodeByCharIndex(m2 - 1, h, f2), b2 = s.findNodeByCharIndex(m2, h, f2);
      m2 = e === Cm.RIGHT ? m2 + b2.count : m2 - ((R = E == null ? void 0 : E.count) != null ? R : 0), m2 = Math.min(I2 - 2, Math.max(0, m2)), this._textSelectionManagerService.replaceTextRanges([
        {
          startOffset: p,
          endOffset: m2,
          style: d
        }
      ], false), this._scrollToFocusNodePosition(r.getUnitId(), m2);
    } else {
      const E = s.findNodeByCharIndex(m2, h, f2), b2 = i.document.getOffsetConfig(), y = l ? u : A === Bg.FORWARD ? g : u, C = this._getTopOrBottomPosition(s, E, y, e === Cm.DOWN, true);
      if (C == null) {
        const x7 = e === Cm.UP ? 0 : I2 - 2;
        if (x7 === m2)
          return;
        this._textSelectionManagerService.replaceTextRanges([
          {
            startOffset: p,
            endOffset: x7,
            style: d
          }
        ], false);
        return;
      }
      const B = new It2(b2, s).getRangePointData(
        C,
        C
      ).cursorList[0];
      this._textSelectionManagerService.replaceTextRanges([
        {
          startOffset: p,
          endOffset: B.endOffset,
          style: d
        }
      ], false), this._scrollToFocusNodePosition(r.getUnitId(), B.endOffset);
    }
  }
  // eslint-disable-next-line max-lines-per-function, complexity
  _handleMoveCursor(e) {
    var I2, S, v2, R;
    const t8 = this._textSelectionManagerService.getActiveTextRange(), o = this._textSelectionManagerService.getTextRanges(), r = this._univerInstanceService.getCurrentUniverDocInstance();
    if (r == null)
      return false;
    const s = (I2 = this._renderManagerService.getRenderById(r.getUnitId())) == null ? void 0 : I2.with(D).getSkeleton(), i = this._getDocObject();
    if (t8 == null || s == null || i == null || o == null)
      return;
    const { startOffset: a, endOffset: c, style: d, collapsed: l, segmentId: A, startNodePosition: h, endNodePosition: u, segmentPage: g } = t8, f2 = r.getSelfOrHeaderFooterModel(A).getBody();
    if (f2 == null)
      return;
    const p = (S = f2.dataStream.length) != null ? S : Number.POSITIVE_INFINITY, m2 = (v2 = r.getCustomRanges()) != null ? v2 : [];
    if (e === Cm.LEFT || e === Cm.RIGHT) {
      let E;
      if (!t8.collapsed || o.length > 1) {
        let C = Number.POSITIVE_INFINITY, B = Number.NEGATIVE_INFINITY;
        for (const x7 of o)
          C = Math.min(C, x7.startOffset), B = Math.max(B, x7.endOffset);
        E = e === Cm.LEFT ? C : B;
      } else {
        const C = s.findNodeByCharIndex(a - 1, A, g), B = s.findNodeByCharIndex(a, A, g), x7 = s.findNodeByCharIndex(a + 1, A, g);
        e === Cm.LEFT ? E = Math.max(0, a - ((R = C == null ? void 0 : C.count) != null ? R : 1)) : E = Math.min(p - 2, c + B.count + ((x7 == null ? void 0 : x7.streamType) === ct.SECTION_BREAK ? 1 : 0));
      }
      const b2 = [
        ct.TABLE_START,
        ct.TABLE_END,
        ct.TABLE_ROW_START,
        ct.TABLE_ROW_END,
        ct.TABLE_CELL_START,
        ct.TABLE_CELL_END,
        ct.SECTION_BREAK
      ];
      if (e === Cm.LEFT)
        for (; b2.includes(f2.dataStream[E]); )
          E--;
      else
        for (; b2.includes(f2.dataStream[E]); )
          E++;
      m2.filter((C) => C.wholeEntity && C.startIndex < E && C.endIndex >= E).forEach((C) => {
        e === Cm.LEFT ? E = Math.min(C.startIndex, E) : E = Math.max(C.endIndex + 1, E);
      }), this._textSelectionManagerService.replaceTextRanges([
        {
          startOffset: Math.max(0, E),
          endOffset: Math.max(0, E),
          style: d
        }
      ], false), this._scrollToFocusNodePosition(r.getUnitId(), E);
    } else {
      const E = s.findNodeByCharIndex(a, A, g), b2 = s.findNodeByCharIndex(c, A, g), y = i.document.getOffsetConfig(), C = this._getTopOrBottomPosition(
        s,
        e === Cm.UP || l ? E : b2,
        e === Cm.UP || l ? h : u,
        e === Cm.DOWN
      );
      if (C == null) {
        let x7;
        l ? x7 = e === Cm.UP ? 0 : p - 2 : x7 = e === Cm.UP ? a : c, this._textSelectionManagerService.replaceTextRanges([
          {
            startOffset: Math.max(0, x7),
            endOffset: Math.max(0, x7),
            style: d
          }
        ], false);
        return;
      }
      const B = new It2(y, s).getRangePointData(
        C,
        C
      ).cursorList[0];
      this._textSelectionManagerService.replaceTextRanges([
        {
          ...B,
          style: d
        }
      ], false), this._scrollToFocusNodePosition(r.getUnitId(), B.endOffset);
    }
  }
  _getTopOrBottomPosition(e, t8, o, r, s = false) {
    if (t8 == null || o == null)
      return;
    const i = this._getGlyphLeftOffsetInLine(t8), a = this._getNextOrPrevLine(t8, r, s);
    if (a == null)
      return;
    const c = this._matchPositionByLeftOffset(e, a, i, o);
    if (c != null)
      return { ...c, isBack: true };
  }
  _getGlyphLeftOffsetInLine(e) {
    const t8 = e.parent;
    if (t8 == null)
      return Number.NEGATIVE_INFINITY;
    const o = t8.left, { left: r } = e;
    return o + r;
  }
  _matchPositionByLeftOffset(e, t8, o, r) {
    const s = {
      distance: Number.POSITIVE_INFINITY
    };
    for (const a of t8.divides) {
      const c = a.left;
      for (const d of a.glyphGroup) {
        if (d.streamType === ct.SECTION_BREAK)
          continue;
        const { left: l } = d, A = c + l, h = Math.abs(o - A);
        h < s.distance && (s.glyph = d, s.distance = h);
      }
    }
    if (s.glyph == null)
      return;
    const { segmentPage: i } = r;
    return e.findPositionByGlyph(s.glyph, i);
  }
  // eslint-disable-next-line max-lines-per-function, complexity
  _getNextOrPrevLine(e, t8, o = false) {
    var f2, p, m2, I2, S, v2, R, E, b2, y, C, B;
    const r = e.parent, s = r == null ? void 0 : r.parent, i = s == null ? void 0 : s.parent, a = i == null ? void 0 : i.parent, c = a == null ? void 0 : a.parent;
    if (r == null || s == null || i == null || a == null || c == null)
      return;
    const d = i.lines.indexOf(s);
    if (d === -1)
      return;
    let l;
    if (c.type === c1.CELL && o) {
      const x7 = Fi2(c, t8);
      if (x7)
        return x7;
    }
    if (t8 === true) {
      l = i.lines[d + 1];
      const x7 = Mg(s, c);
      if (x7) {
        const M7 = Tg(x7);
        M7 && (l = M7);
      }
    } else {
      l = i.lines[d - 1];
      const x7 = _g(s, c);
      if (x7) {
        const M7 = Bg2(x7);
        M7 && (l = M7);
      }
    }
    if (l != null)
      return l;
    const A = a.columns.indexOf(i);
    if (A === -1)
      return;
    if (t8 === true)
      l = (f2 = a.columns[A + 1]) == null ? void 0 : f2.lines[0];
    else {
      const x7 = (m2 = (p = a.columns) == null ? void 0 : p[A - 1]) == null ? void 0 : m2.lines;
      l = x7 == null ? void 0 : x7[x7.length - 1];
    }
    if (l != null)
      return l;
    const h = c.sections.indexOf(a);
    if (h === -1)
      return;
    if (t8 === true)
      l = (S = (I2 = c.sections[h - 1]) == null ? void 0 : I2.columns[0]) == null ? void 0 : S.lines[0];
    else {
      const x7 = (R = (v2 = c.sections) == null ? void 0 : v2[h - 1]) == null ? void 0 : R.columns, M7 = x7 == null ? void 0 : x7[x7.length - 1], w = M7 == null ? void 0 : M7.lines;
      l = w == null ? void 0 : w[w.length - 1];
    }
    if (l != null)
      return l;
    if (c.type === c1.CELL)
      return Fi2(c, t8);
    const u = c.parent;
    if (u == null)
      return;
    const g = u.pages.indexOf(c);
    if (g !== -1) {
      if (t8 === true)
        l = (y = (b2 = (E = u.pages[g + 1]) == null ? void 0 : E.sections[0]) == null ? void 0 : b2.columns[0]) == null ? void 0 : y.lines[0];
      else {
        const x7 = (C = u.pages[g - 1]) == null ? void 0 : C.sections;
        if (x7 == null)
          return;
        const M7 = (B = x7[x7.length - 1]) == null ? void 0 : B.columns, w = M7[M7.length - 1], F2 = w == null ? void 0 : w.lines;
        l = F2[F2.length - 1];
      }
      if (l != null)
        return l;
    }
  }
  _scrollToFocusNodePosition(e, t8) {
    var r;
    const o = (r = this._renderManagerService.getRenderById(e)) == null ? void 0 : r.with(uo3);
    o != null && o.scrollToRange({
      startOffset: t8,
      endOffset: t8,
      collapsed: true
    });
  }
  _getDocObject() {
    return cd(this._univerInstanceService, this._renderManagerService);
  }
};
fo4 = Ng([
  jn3(0, vr),
  jn3(1, ME),
  jn3(2, Inject(m)),
  jn3(3, Ls)
], fo4);
function Fi2(n, e) {
  var o, r;
  let t8 = null;
  if (e === true) {
    const s = bc(n);
    if (s)
      t8 = Dg(s);
    else {
      const i = (o = n.parent) == null ? void 0 : o.parent, { lineAfterTable: a } = Ui2(i);
      a && (t8 = a);
    }
  } else {
    const s = yc(n);
    if (s)
      t8 = wg(s);
    else {
      const i = (r = n.parent) == null ? void 0 : r.parent, { lineBeforeTable: a } = Ui2(i);
      a && (t8 = a);
    }
  }
  return t8;
}
var Lg = ({
  handleRowColChange: n,
  tableCreateParams: e
}) => {
  const t8 = useDependency(Fn), [o, r] = (0, import_react3.useState)(3), [s, i] = (0, import_react3.useState)(5);
  function a(c, d) {
    r(c), i(d), n(c, d);
  }
  return (0, import_react3.useEffect)(() => {
    r(e.rowCount), i(e.colCount);
  }, [e]), (0, import_jsx_runtime3.jsxs)("div", { className: "univer-flex univer-items-center univer-justify-between univer-gap-2", children: [
    (0, import_jsx_runtime3.jsxs)("div", { className: "univer-flex univer-items-center univer-gap-2", children: [
      (0, import_jsx_runtime3.jsx)("span", { children: t8.t("toolbar.table.rowCount") }),
      (0, import_jsx_runtime3.jsx)(
        xE2,
        {
          className: "univer-w-28",
          min: 1,
          max: 20,
          precision: 0,
          value: o,
          onChange: (c) => {
            a(c, s);
          }
        }
      )
    ] }),
    (0, import_jsx_runtime3.jsxs)("div", { className: "univer-flex univer-items-center univer-gap-2", children: [
      (0, import_jsx_runtime3.jsx)("span", { children: t8.t("toolbar.table.colCount") }),
      (0, import_jsx_runtime3.jsx)(
        xE2,
        {
          className: "univer-w-28",
          min: 1,
          max: 20,
          precision: 0,
          value: s,
          onChange: (c) => {
            a(o, c);
          }
        }
      )
    ] })
  ] });
};
var Qg = Object.getOwnPropertyDescriptor;
var Ug = (n, e, t8, o) => {
  for (var r = o > 1 ? void 0 : o ? Qg(e, t8) : e, s = n.length - 1, i; s >= 0; s--)
    (i = n[s]) && (r = i(r) || r);
  return r;
};
var Hi2 = (n, e) => (t8, o) => e(t8, o, n);
var po2 = class extends Ve {
  constructor(n, e) {
    super(), this._commandService = n, this._componentManager = e, this._initialize();
  }
  _initialize() {
    this._init(), this._registerCommands(), this._initCustomComponents();
  }
  _registerCommands() {
    [
      Os2
    ].forEach((n) => this.disposeWithMe(this._commandService.registerCommand(n)));
  }
  _initCustomComponents() {
    const n = this._componentManager;
    this.disposeWithMe(n.register(Ga, Lg));
  }
  _init() {
  }
};
po2 = Ug([
  Hi2(0, Ls),
  Hi2(1, Inject(S1))
], po2);
var Fg = Object.getOwnPropertyDescriptor;
var Hg = (n, e, t8, o) => {
  for (var r = o > 1 ? void 0 : o ? Fg(e, t8) : e, s = n.length - 1, i; s >= 0; s--)
    (i = n[s]) && (r = i(r) || r);
  return r;
};
var zn3 = (n, e) => (t8, o) => e(t8, o, n);
var xr2 = class extends Ve {
  constructor(n, e, t8, o, r) {
    super(), this._context = n, this._docSkeletonManagerService = e, this._commandService = t8, this._docEventManagerService = o, this._textSelectionManagerService = r, this._initPointerDownObserver(), this._initHoverCursor();
  }
  _initPointerDownObserver() {
    this._docEventManagerService.clickBullets$.subscribe((n) => {
      const e = this._textSelectionManagerService.getTextRanges();
      this._commandService.executeCommand(Pa.id, {
        index: n.paragraph.startIndex,
        segmentId: n.segmentId,
        textRanges: e
      });
    });
  }
  _initHoverCursor() {
    this.disposeWithMe(
      this._docEventManagerService.hoverBullet$.subscribe((n) => {
        n ? this._context.mainComponent.setCursor(v1.POINTER) : this._context.mainComponent.setCursor(v1.TEXT);
      })
    );
  }
  _getTransformCoordForDocumentOffset(n, e, t8, o) {
    const { documentTransform: r } = n.getOffsetConfig(), s = e.transformVector2SceneCoord(U.FromArray([t8, o]));
    if (s)
      return r.clone().invert().applyPoint(s);
  }
};
xr2 = Hg([
  zn3(1, Inject(D)),
  zn3(2, Ls),
  zn3(3, Inject(wt2)),
  zn3(4, Inject(m))
], xr2);
var kg = Object.getOwnPropertyDescriptor;
var Vg = (n, e, t8, o) => {
  for (var r = o > 1 ? void 0 : o ? kg(e, t8) : e, s = n.length - 1, i; s >= 0; s--)
    (i = n[s]) && (r = i(r) || r);
  return r;
};
var An3 = (n, e) => (t8, o) => e(t8, o, n);
var mo2 = class extends h1 {
  constructor(n, e, t8, o, r, s) {
    super(), this._context = n, this._commandService = e, this._docClipboardService = t8, this._docSelectionRenderService = o, this._contextService = r, this._editorService = s, this._init();
  }
  _init() {
    this._initLegacyPasteCommand();
  }
  _initLegacyPasteCommand() {
    var n;
    (n = this._docSelectionRenderService) == null || n.onPaste$.pipe(takeUntil(this.dispose$)).subscribe((e) => {
      var a, c, d;
      if (!wo2(this._contextService))
        return;
      e.event.preventDefault();
      const t8 = e.event;
      let o = (a = t8.clipboardData) == null ? void 0 : a.getData(Kt);
      const r = (c = t8.clipboardData) == null ? void 0 : c.getData(Qt4), s = [...((d = t8.clipboardData) == null ? void 0 : d.items) || []].filter((l) => e7.has(l.type)).map((l) => l.getAsFile()).filter((l) => !!l);
      this._editorService.getEditor(this._context.unitId) && (o != null ? o : "").indexOf("</table>") > -1 && (o = ""), this._docClipboardService.legacyPaste({ html: o, text: r, files: s });
    });
  }
};
mo2 = Vg([
  An3(1, Ls),
  An3(2, Nt3),
  An3(3, Inject(Re2)),
  An3(4, Nr),
  An3(5, Ge2)
], mo2);
var Wg = Object.getOwnPropertyDescriptor;
var jg2 = (n, e, t8, o) => {
  for (var r = o > 1 ? void 0 : o ? Wg(e, t8) : e, s = n.length - 1, i; s >= 0; s--)
    (i = n[s]) && (r = i(r) || r);
  return r;
};
var ki2 = (n, e) => (t8, o) => e(t8, o, n);
var zg2 = [
  Bc,
  Ul,
  Dl,
  Hc
];
var Or2 = class extends Ve {
  constructor(n, e, t8) {
    super(), this._context = n, this._contextMenuService = e, this._commandService = t8, zg2.includes(this._context.unitId) || (this._initPointerDown(), this._initEditChange());
  }
  _initPointerDown() {
    var t8, o;
    const e = ((o = (t8 = this._context) == null ? void 0 : t8.mainComponent) == null ? void 0 : o.onPointerDown$).subscribeEvent((r) => {
      r.button === 2 && this._contextMenuService.triggerContextMenu(r, Y1.MAIN_AREA);
    });
    this.disposeWithMe(e);
  }
  _initEditChange() {
    this.disposeWithMe(
      this._commandService.onCommandExecuted((n) => {
        n.id === M.id && this._contextMenuService.visible && this._contextMenuService.hideContextMenu();
      })
    );
  }
};
Or2 = jg2([
  ki2(1, c32),
  ki2(2, Ls)
], Or2);
var Gg2 = Object.getOwnPropertyDescriptor;
var Yg = (n, e, t8, o) => {
  for (var r = o > 1 ? void 0 : o ? Gg2(e, t8) : e, s = n.length - 1, i; s >= 0; s--)
    (i = n[s]) && (r = i(r) || r);
  return r;
};
var zt3 = (n, e) => (t8, o) => e(t8, o, n);
var Eo3 = class extends Ve {
  constructor(e, t8, o, r, s, i, a) {
    super();
    O(this, "_initialEditors", /* @__PURE__ */ new Set());
    this._context = e, this._univerInstanceService = t8, this._editorService = o, this._commandService = r, this._docSelectionRenderService = s, this._docSkeletonManagerService = i, this._renderManagerService = a, this._initialize();
  }
  _initialize() {
    this._editorService.getAllEditor().forEach((e) => {
      const t8 = e.getEditorId();
      t8 === this._context.unitId && (this._initialEditors.has(t8) || (this._initialEditors.add(t8), this._resize(t8)));
    }), this._commandExecutedListener(), this._initialBlur(), this._initialFocus();
  }
  _resize(e) {
    if (e == null)
      return;
    const t8 = this._editorService.getEditor(e);
    if ((t8 == null ? void 0 : t8.cancelDefaultResizeListener) === true)
      return;
    const o = this._univerInstanceService.getUniverDocInstance(e);
    if (!o)
      return;
    const r = this._docSkeletonManagerService.getSkeleton();
    if (t8 == null || t8.render == null || r == null || o == null)
      return;
    r.calculate();
    const { marginTop: s = 0, marginBottom: i = 0, marginLeft: a = 0, marginRight: c = 0 } = o.getSnapshot().documentStyle, { scene: d, mainComponent: l } = t8.render;
    let { actualHeight: A, actualWidth: h } = r.getActualSize();
    A += s + i, h += a + c;
    const { width: u, height: g } = t8.getBoundingClientRect(), f2 = Math.max(h, u), p = Math.max(A, g);
    d.transformByState({
      width: f2,
      height: p
    }), l == null || l.resize(f2, p);
  }
  _initialBlur() {
    this.disposeWithMe(
      this._editorService.blur$.subscribe(() => {
        this._docSelectionRenderService.blur();
      })
    ), this.disposeWithMe(
      this._docSelectionRenderService.onBlur$.subscribe(() => {
        const { unitId: e } = this._context, t8 = this._editorService.getEditor(e), o = this._editorService.getFocusEditor();
        t8 == null || t8.isSheetEditor() || o && o.getEditorId() === e || e.includes("range_selector") || e.includes("embedding_formula_editor") || this._editorService.blur();
      })
    );
  }
  _initialFocus() {
    const e = [
      "univer-formula-search",
      "univer-formula-help",
      "formula-help-decorator",
      "univer-formula-help-param"
    ];
    this.disposeWithMe(
      fromEvent(window, "mousedown").subscribe((o) => {
        const s = o.target.classList[0] || "";
        K1(s, e) && o.stopPropagation();
      })
    );
    const t8 = new ao();
    this.disposeWithMe(
      this._univerInstanceService.getCurrentTypeOfUnit$(we.UNIVER_SHEET).subscribe((o) => {
        if (t8.dispose(), !o)
          return;
        const r = o.getUnitId(), s = this._renderManagerService.getRenderById(r), i = s == null ? void 0 : s.engine.getCanvas().getCanvasEle();
        if (i == null)
          return;
        const a = fromEvent(i, "mousedown").subscribe((c) => {
          c.stopPropagation();
        });
        t8.add(a);
      })
    ), this.disposeWithMe(() => t8.dispose());
  }
  /**
   * Listen to document edits to refresh the size of the formula editor.
   */
  _commandExecutedListener() {
    const e = [M.id];
    this.disposeWithMe(
      this._commandService.onCommandExecuted((t8) => {
        if (e.includes(t8.id)) {
          const o = t8.params, { unitId: r } = o;
          if (this._editorService.isSheetEditor(r) || r !== this._context.unitId)
            return;
          const s = this._editorService.getEditor(r);
          s && !s.params.scrollBar && this._resize(r);
        }
      })
    );
  }
};
Eo3 = Yg([
  zt3(1, vr),
  zt3(2, Ge2),
  zt3(3, Ls),
  zt3(4, Inject(Re2)),
  zt3(5, Inject(D)),
  zt3(6, ME)
], Eo3);
var Kg = Object.getOwnPropertyDescriptor;
var qg = (n, e, t8, o) => {
  for (var r = o > 1 ? void 0 : o ? Kg(e, t8) : e, s = n.length - 1, i; s >= 0; s--)
    (i = n[s]) && (r = i(r) || r);
  return r;
};
var Gn4 = (n, e) => (t8, o) => e(t8, o, n);
var Tr = class extends Ve {
  constructor(e, t8, o, r, s) {
    super();
    O(this, "_previousIMEContent", "");
    O(this, "_isCompositionStart", true);
    O(this, "_onStartSubscription");
    O(this, "_onUpdateSubscription");
    O(this, "_onEndSubscription");
    this._context = e, this._docSelectionRenderService = t8, this._docImeInputManagerService = o, this._docSkeletonManagerService = r, this._commandService = s, this._initialize();
  }
  dispose() {
    var e, t8, o;
    (e = this._onStartSubscription) == null || e.unsubscribe(), (t8 = this._onUpdateSubscription) == null || t8.unsubscribe(), (o = this._onEndSubscription) == null || o.unsubscribe();
  }
  _initialize() {
    this._initialOnCompositionstart(), this._initialOnCompositionUpdate(), this._initialOnCompositionend();
  }
  _initialOnCompositionstart() {
    this._onStartSubscription = this._docSelectionRenderService.onCompositionstart$.subscribe((e) => {
      if (e == null)
        return;
      this._resetIME();
      const { activeRange: t8 } = e;
      t8 != null && this._docImeInputManagerService.setActiveRange(J.deepClone(t8));
    });
  }
  _initialOnCompositionUpdate() {
    this._onUpdateSubscription = this._docSelectionRenderService.onCompositionupdate$.subscribe((e) => {
      this._updateContent(e, true);
    });
  }
  _initialOnCompositionend() {
    this._onEndSubscription = this._docSelectionRenderService.onCompositionend$.subscribe((e) => {
      this._updateContent(e, false);
    });
  }
  async _updateContent(e, t8) {
    if (e == null)
      return;
    const o = this._context.unitId, r = this._docSkeletonManagerService.getSkeleton(), { event: s, activeRange: i } = e;
    if (r == null || i == null)
      return;
    const c = s.data;
    c === this._previousIMEContent && t8 || (await this._commandService.executeCommand(Ta.id, {
      unitId: o,
      newText: c,
      oldTextLen: this._previousIMEContent.length,
      isCompositionStart: this._isCompositionStart,
      isCompositionEnd: !t8
    }), t8 ? (this._isCompositionStart && (this._isCompositionStart = false), this._previousIMEContent = c) : this._resetIME());
  }
  _resetIME() {
    this._previousIMEContent = "", this._isCompositionStart = true, this._docImeInputManagerService.clearUndoRedoMutationParamsCache(), this._docImeInputManagerService.setActiveRange(null);
  }
};
Tr = qg([
  Gn4(1, Inject(Re2)),
  Gn4(2, Inject(No2)),
  Gn4(3, Inject(D)),
  Gn4(4, Ls)
], Tr);
var Xg = Object.getOwnPropertyDescriptor;
var Zg = (n, e, t8, o) => {
  for (var r = o > 1 ? void 0 : o ? Xg(e, t8) : e, s = n.length - 1, i; s >= 0; s--)
    (i = n[s]) && (r = i(r) || r);
  return r;
};
var Yn2 = (n, e) => (t8, o) => e(t8, o, n);
var Br = class extends Ve {
  constructor(e, t8, o, r, s) {
    super();
    O(this, "_onInputSubscription");
    this._context = e, this._docSelectionRenderService = t8, this._docSkeletonManagerService = o, this._commandService = r, this._docMenuStyleService = s, this._init();
  }
  dispose() {
    var e;
    super.dispose(), (e = this._onInputSubscription) == null || e.unsubscribe();
  }
  _init() {
    this._initialNormalInput();
  }
  _initialNormalInput() {
    this._onInputSubscription = this._docSelectionRenderService.onInput$.subscribe(async (e) => {
      var p, m2;
      if (e == null)
        return;
      const { unitId: t8 } = this._context, { event: o, content: r = "", activeRange: s } = e, i = o, a = this._docSkeletonManagerService.getSkeleton();
      if (i.data == null || a == null || s == null)
        return;
      const { segmentId: c } = s, l = this._context.unit.getSelfOrHeaderFooterModel(c).getBody(), A = this._docMenuStyleService.getDefaultStyle(), h = this._docMenuStyleService.getStyleCache(), u = jr((p = l == null ? void 0 : l.customRanges) != null ? p : [], s.endOffset, uR.includes(t8)), g = Bo2(l, s.endOffset, A, h, uR.includes(t8)), f2 = zr2((m2 = l == null ? void 0 : l.customDecorations) != null ? m2 : [], s.endOffset);
      await this._commandService.executeCommand(va.id, {
        unitId: t8,
        body: {
          dataStream: r,
          textRuns: g ? [
            {
              ...g,
              st: 0,
              ed: r.length
            }
          ] : [],
          customRanges: u ? [{
            ...u,
            startIndex: 0,
            endIndex: r.length - 1
          }] : [],
          customDecorations: f2.map((I2) => ({
            ...I2,
            startIndex: 0,
            endIndex: r.length - 1
          }))
        },
        range: s,
        segmentId: c
      }), r === " " && await this._commandService.executeCommand(Mo2.id);
    });
  }
};
Br = Zg([
  Yn2(1, Inject(Re2)),
  Yn2(2, Inject(D)),
  Yn2(3, Ls),
  Yn2(4, Inject(at2))
], Br);
var Ps = class extends Ve {
  constructor(e) {
    super(), this._context = e;
  }
  calculatePagePosition() {
    var v2, R;
    const e = pt2(this._context), o = (R = (v2 = this._context.unit.getSettings()) == null ? void 0 : v2.zoomRatio) != null ? R : 1, { document: r, scene: s, docBackground: i } = e, a = s == null ? void 0 : s.getParent(), { width: c, height: d, pageMarginLeft: l, pageMarginTop: A } = r;
    if (a == null || c === Number.POSITIVE_INFINITY || d === Number.POSITIVE_INFINITY)
      return;
    const { width: h, height: u } = a;
    let g = 0, f2 = A, p = 0, m2 = 0, I2 = Number.POSITIVE_INFINITY;
    h > (c + l * 2) * o ? (g = h / 2 - c * o / 2, g /= o, p = (h - l * 2) / o, I2 = 0) : (g = l, p = c + l * 2, I2 = (p - h / o) / 2), u > d ? m2 = (u - A * 2) / o : m2 = d + A * 2, s.resize(p, m2), h <= 1 && (g = -1e4, f2 = -1e4), r.translate(g, f2), i.translate(g, f2);
    const S = s.getViewport(We4.VIEW_MAIN);
    return I2 !== Number.POSITIVE_INFINITY && S != null && S.scrollToViewportPos({
      viewportScrollX: I2
    }), this;
  }
};
var Jg = Object.getOwnPropertyDescriptor;
var $g = (n, e, t8, o) => {
  for (var r = o > 1 ? void 0 : o ? Jg(e, t8) : e, s = n.length - 1, i; s >= 0; s--)
    (i = n[s]) && (r = i(r) || r);
  return r;
};
var Vi = (n, e) => (t8, o) => e(t8, o, n);
var Mr2 = class extends Ve {
  constructor(n, e, t8) {
    super(), this._context = n, this._docPageLayoutService = e, this._textSelectionManagerService = t8;
    const o = this._context.unitId;
    if (Yc(o) && o !== Hc) return this;
    this._initResize();
  }
  _initResize() {
    this.disposeWithMe(
      TR(this._context.engine.onTransformChange$).pipe(
        filter((n) => n.type === x1.resize),
        throttleTime(0, animationFrameScheduler)
      ).subscribe(() => {
        this._docPageLayoutService.calculatePagePosition(), this._textSelectionManagerService.refreshSelection();
      })
    );
  }
};
Mr2 = $g([
  Vi(1, Inject(Ps)),
  Vi(2, Inject(m))
], Mr2);
var ef = Object.getOwnPropertyDescriptor;
var tf = (n, e, t8, o) => {
  for (var r = o > 1 ? void 0 : o ? ef(e, t8) : e, s = n.length - 1, i; s >= 0; s--)
    (i = n[s]) && (r = i(r) || r);
  return r;
};
var Gt2 = (n, e) => (t8, o) => e(t8, o, n);
var _r = class extends Ve {
  constructor(e, t8, o, r, s, i, a) {
    super();
    O(this, "_loadedMap", /* @__PURE__ */ new WeakSet());
    this._context = e, this._commandService = t8, this._editorService = o, this._instanceSrv = r, this._docSelectionRenderService = s, this._docSkeletonManagerService = i, this._docSelectionManagerService = a, this._initialize();
  }
  _initialize() {
    this._init(), this._skeletonListener(), this._commandExecutedListener(), this._refreshListener(), this._syncSelection();
  }
  _init() {
    const { unitId: e } = this._context, t8 = pt2(this._context);
    t8 == null || t8.document == null || this._loadedMap.has(t8.document) || (this._initialMain(e), this._loadedMap.add(t8.document));
  }
  _refreshListener() {
    this.disposeWithMe(
      this._docSelectionManagerService.refreshSelection$.subscribe((e) => {
        if (e == null)
          return;
        const { unitId: t8, docRanges: o, isEditing: r, options: s } = e;
        t8 === this._context.unitId && (this._docSelectionRenderService.removeAllRanges(), this._docSelectionRenderService.addDocRanges(o, r, s));
      })
    );
  }
  _syncSelection() {
    this.disposeWithMe(
      this._docSelectionRenderService.textSelectionInner$.subscribe((e) => {
        e != null && this._docSelectionManagerService.__replaceTextRangesWithNoRefresh(e, {
          unitId: this._context.unitId,
          subUnitId: this._context.unitId
        });
      })
    );
  }
  // eslint-disable-next-line max-lines-per-function
  _initialMain(e) {
    const t8 = pt2(this._context), { document: o, scene: r } = t8;
    this.disposeWithMe(o.onPointerEnter$.subscribeEvent(() => {
      this._isEditorReadOnly(e) || (o.cursor = v1.TEXT);
    })), this.disposeWithMe(o.onPointerLeave$.subscribeEvent(() => {
      o.cursor = v1.DEFAULT, r.resetCursor();
    })), this.disposeWithMe(o.onPointerDown$.subscribeEvent((s, i) => {
      if (this._isEditorReadOnly(e))
        return;
      const a = this._instanceSrv.getCurrentUnitForType(we.UNIVER_DOC);
      (a == null ? void 0 : a.getUnitId()) !== e && this._instanceSrv.setCurrentUnitForType(e);
      const c = this._docSkeletonManagerService.getSkeleton(), { offsetX: d, offsetY: l } = s, A = this._getTransformCoordForDocumentOffset(d, l);
      if (A != null) {
        const {
          pageLayoutType: h = Q2.VERTICAL,
          pageMarginLeft: u,
          pageMarginTop: g
        } = o.getOffsetConfig(), { editArea: f2 } = c.findEditAreaByCoord(
          A,
          h,
          u,
          g
        ), p = this._docSkeletonManagerService.getViewModel(), m2 = p.getEditArea();
        m2 !== d3.BODY && f2 !== d3.BODY && f2 !== m2 && p.setEditArea(f2);
      }
      if (this._docSelectionRenderService.__onPointDown(s), this._editorService.getEditor(e)) {
        this._setEditorFocus(e);
        const { offsetX: h, offsetY: u } = s;
        setTimeout(() => {
          e === this._editorService.getFocusId() || this._docSelectionRenderService.isOnPointerEvent || (this._setEditorFocus(e), this._docSelectionRenderService.setCursorManually(h, u));
        }, 0);
      }
      s.button !== 2 && i.stopPropagation();
    })), this.disposeWithMe(o.onDblclick$.subscribeEvent((s) => {
      this._isEditorReadOnly(e) || this._docSelectionRenderService.__handleDblClick(s);
    })), this.disposeWithMe(o.onTripleClick$.subscribeEvent((s) => {
      this._isEditorReadOnly(e) || this._docSelectionRenderService.__handleTripleClick(s);
    }));
  }
  _getTransformCoordForDocumentOffset(e, t8) {
    const o = pt2(this._context), { document: r, scene: s } = o, { documentTransform: i } = r.getOffsetConfig(), a = s.getViewports()[0];
    if (a == null)
      return;
    const c = a.transformVector2SceneCoord(U.FromArray([e, t8]));
    return i.clone().invert().applyPoint(c);
  }
  _isEditorReadOnly(e) {
    const t8 = this._editorService.getEditor(e);
    return t8 ? t8.isReadOnly() : false;
  }
  _setEditorFocus(e) {
    this._editorService.focus(e);
  }
  _commandExecutedListener() {
    const e = [tt2.id];
    this.disposeWithMe(
      this._commandService.onCommandExecuted((t8) => {
        var o;
        if (e.includes(t8.id)) {
          const r = t8.params, { unitId: s } = r, i = (o = this._docSelectionManagerService.__getCurrentSelection()) == null ? void 0 : o.unitId;
          if (s !== i)
            return;
          this._docSelectionManagerService.refreshSelection();
        }
      })
    );
  }
  _skeletonListener() {
    this.disposeWithMe(this._docSkeletonManagerService.currentSkeleton$.subscribe((e) => {
      if (!e) return;
      const { unitId: t8 } = this._context;
      if (!Yc(t8)) {
        this._docSelectionRenderService.focus();
        const s = this._context.unit.getSnapshot(), i = dc(s);
        this._docSelectionManagerService.replaceDocRanges([
          {
            startOffset: i,
            endOffset: i
          }
        ], {
          unitId: t8,
          subUnitId: t8
        }, false);
      }
    }));
  }
};
_r = tf([
  Gt2(1, Ls),
  Gt2(2, Ge2),
  Gt2(3, vr),
  Gt2(4, Inject(Re2)),
  Gt2(5, Inject(D)),
  Gt2(6, Inject(m))
], _r);
var nf = Object.getOwnPropertyDescriptor;
var of2 = (n, e, t8, o) => {
  for (var r = o > 1 ? void 0 : o ? nf(e, t8) : e, s = n.length - 1, i; s >= 0; s--)
    (i = n[s]) && (r = i(r) || r);
  return r;
};
var ht2 = (n, e) => (t8, o) => e(t8, o, n);
var Dr2 = class extends Ve {
  constructor(e, t8, o, r, s, i, a, c, d) {
    super();
    O(this, "_isSheetEditor", false);
    this._context = e, this._contextService = t8, this._docSkeletonManagerService = o, this._univerInstanceService = r, this._commandService = s, this._textSelectionManagerService = i, this._editorService = a, this._docPageLayoutService = c, this._renderManagerService = d, this._initSkeletonListener(), this._initCommandExecutedListener(), this._initRenderRefresher(), this._isSheetEditor = this._context.unitId === Dl;
    const l = this._univerInstanceService.getCurrentUnitOfType(we.UNIVER_SHEET), A = l && this._renderManagerService.getRenderById(l.getUnitId());
    setTimeout(() => this.updateViewZoom(A && this._isSheetEditor ? A.scene.scaleX : 1, true), 20), Yc(this._context.unitId) || this._initZoomEventListener();
  }
  _initRenderRefresher() {
    this._docSkeletonManagerService.currentSkeleton$.subscribe((e) => {
      if (e == null)
        return;
      const { unitId: t8, scene: o } = this._context;
      this._editorService.isEditor(t8) || this.disposeWithMe(o.onMouseWheel$.subscribeEvent((r) => {
        if (!r.ctrlKey || !this._contextService.getContextValue(qr))
          return;
        const s = this._univerInstanceService.getCurrentUniverDocInstance();
        if (!s)
          return;
        const { documentFlavor: i } = s.getSnapshot().documentStyle;
        if (i === uu.MODERN)
          return;
        const a = Math.abs(r.deltaX);
        let c = a < 40 ? 0.2 : a < 80 ? 0.4 : 0.2;
        c *= r.deltaY > 0 ? -1 : 1, o.scaleX < 1 && (c /= 2);
        const d = s.zoomRatio;
        let l = +Number.parseFloat(`${d + c}`).toFixed(1);
        l = l >= 4 ? 4 : l <= 0.1 ? 0.1 : l, this._commandService.executeCommand(Xn2.id, {
          zoomRatio: l,
          unitId: s.getUnitId()
        }), r.preventDefault();
      }));
    });
  }
  _initSkeletonListener() {
    this.disposeWithMe(this._docSkeletonManagerService.currentSkeleton$.subscribe((e) => {
      if (e == null)
        return;
      const t8 = this._univerInstanceService.getCurrentUniverDocInstance();
      t8 && setTimeout(() => {
        const o = this._univerInstanceService.getCurrentUnitOfType(we.UNIVER_SHEET), r = o && this._renderManagerService.getRenderById(o.getUnitId()), s = this._isSheetEditor ? (r == null ? void 0 : r.scene.scaleX) || 1 : t8.zoomRatio;
        this.updateViewZoom(s, false);
      });
    }));
  }
  _initCommandExecutedListener() {
    const e = [tt2.id];
    this.disposeWithMe(this._commandService.onCommandExecuted((t8) => {
      if (e.includes(t8.id) && t8.params.unitId === this._context.unitId) {
        const r = this._context.unit.zoomRatio || 1;
        this.updateViewZoom(r);
      }
    })), this.disposeWithMe(
      this._commandService.beforeCommandExecuted((t8) => {
        t8.id === ko2.id && this._commandService.executeCommand(Xn2.id, {
          zoomRatio: 1,
          unitId: this._context.unitId
        });
      })
    );
  }
  updateViewZoom(e, t8 = true) {
    var r;
    const o = pt2(this._context);
    o.scene.scale(e, e), this._editorService.isEditor(this._context.unitId) || this._docPageLayoutService.calculatePagePosition(), t8 && !this._editorService.isEditor(this._context.unitId) && this._textSelectionManagerService.refreshSelection(), (r = o.scene.getTransformer()) == null || r.clearSelectedObjects();
  }
  _initZoomEventListener() {
    const e = this._context.scene;
    this.disposeWithMe(
      // hold ctrl & mousewheel ---> zoom
      e.onMouseWheel$.subscribeEvent((t8) => {
        if (!t8.ctrlKey)
          return;
        const o = Math.abs(t8.deltaX);
        let r = o < 40 ? 0.2 : o < 80 ? 0.4 : 0.2;
        r *= t8.deltaY > 0 ? -1 : 1, e.scaleX < 1 && (r /= 2);
        const s = this._context.unit.zoomRatio;
        let i = +Number.parseFloat(`${s + r}`).toFixed(1);
        i = i >= 4 ? 4 : i <= 0.1 ? 0.1 : i, this._commandService.executeCommand(Xn2.id, {
          zoomRatio: Math.round(i * 10) / 10,
          documentId: this._context.unitId
        }), t8.preventDefault();
      })
    );
  }
};
Dr2 = of2([
  ht2(1, Nr),
  ht2(2, Inject(D)),
  ht2(3, vr),
  ht2(4, Ls),
  ht2(5, Inject(m)),
  ht2(6, Ge2),
  ht2(7, Inject(Ps)),
  ht2(8, ME)
], Dr2);
var rf = qC("PRINTING_COMPONENT_COLLECT");
var sf = qC("PRINTING_DOM_COLLECT");
var af = class extends Ve {
  constructor() {
    super();
    O(this, "_printComponentMap", /* @__PURE__ */ new Map());
    O(this, "interceptor", new ZC({
      PRINTING_COMPONENT_COLLECT: rf,
      PRINTING_DOM_COLLECT: sf
    }));
    this.disposeWithMe(this.interceptor.intercept(this.interceptor.getInterceptPoints().PRINTING_COMPONENT_COLLECT, {
      priority: -1,
      handler: (t8) => t8
    })), this.disposeWithMe(this.interceptor.intercept(this.interceptor.getInterceptPoints().PRINTING_DOM_COLLECT, {
      priority: -1,
      handler: (t8) => t8
    }));
  }
  registerPrintComponent(t8, o) {
    this._printComponentMap.set(t8, o);
  }
  getPrintComponent(t8) {
    return this._printComponentMap.get(t8);
  }
};
var cf = Object.getOwnPropertyDescriptor;
var lf = (n, e, t8, o) => {
  for (var r = o > 1 ? void 0 : o ? cf(e, t8) : e, s = n.length - 1, i; s >= 0; s--)
    (i = n[s]) && (r = i(r) || r);
  return r;
};
var un4 = (n, e) => (t8, o) => e(t8, o, n);
var Wi2 = 300;
var Io2 = class extends h1 {
  constructor(e, t8, o, r, s) {
    super();
    O(this, "_docStateChange$", new BehaviorSubject(null));
    O(this, "docStateChange$", this._docStateChange$.asObservable());
    O(this, "_historyStateCache", /* @__PURE__ */ new Map());
    O(this, "_changeStateCache", /* @__PURE__ */ new Map());
    O(this, "_historyTimer", null);
    O(this, "_changeStateCacheTimer", null);
    this._undoRedoService = e, this._commandService = t8, this._univerInstanceService = o, this._docStateEmitService = r, this._renderManagerService = s, this._initialize(), this._listenDocStateChange();
  }
  getStateCache(e) {
    var t8, o;
    return {
      history: (t8 = this._historyStateCache.get(e)) != null ? t8 : [],
      collaboration: (o = this._changeStateCache.get(e)) != null ? o : []
    };
  }
  setStateCache(e, t8) {
    this._historyStateCache.set(e, t8.history), this._changeStateCache.set(e, t8.collaboration);
  }
  _setChangeState(e) {
    this._cacheChangeState(e, "history"), this._cacheChangeState(e, "collaboration");
  }
  _initialize() {
    this.disposeWithMe(
      this._commandService.beforeCommandExecuted((e) => {
        if (e.id === mC || e.id === fC) {
          const t8 = this._univerInstanceService.getCurrentUniverDocInstance();
          if (t8 == null)
            return;
          const o = t8.getUnitId();
          this._pushHistory(o), this._emitChangeState(o);
        }
      })
    );
  }
  _listenDocStateChange() {
    this._docStateEmitService.docStateChangeParams$.pipe(takeUntil(this.dispose$)).subscribe((e) => {
      var a;
      if (e == null)
        return;
      const { isCompositionEnd: t8, isSync: o, syncer: r, ...s } = e, i = (a = this._renderManagerService.getRenderById(o ? r : e.unitId)) == null ? void 0 : a.with(No2);
      if (i != null) {
        if (t8) {
          const c = i.fetchComposedUndoRedoMutationParams();
          if (c == null)
            throw new Error("historyParams is null in RichTextEditingMutation");
          const { undoMutationParams: d, redoMutationParams: l, previousActiveRange: A } = c;
          s.redoState.actions = l.actions, s.undoState.actions = d.actions, s.undoState.textRanges = [A];
        }
        this._setChangeState(s);
      }
    });
  }
  _cacheChangeState(e, t8 = "history") {
    const { trigger: o, unitId: r, noHistory: s, debounce: i = false } = e;
    if (s || o == null || t8 === "history" && (o === fC || o === mC))
      return;
    const a = t8 === "history" ? this._historyStateCache : this._changeStateCache, c = t8 === "history" ? this._pushHistory.bind(this) : this._emitChangeState.bind(this);
    if (a.has(r)) {
      const d = a.get(r);
      d == null || d.push(e);
    } else
      a.set(r, [e]);
    i ? t8 === "history" ? (this._historyTimer && clearTimeout(this._historyTimer), this._historyTimer = setTimeout(() => {
      c(r);
    }, Wi2)) : (this._changeStateCacheTimer && clearTimeout(this._changeStateCacheTimer), this._changeStateCacheTimer = setTimeout(() => {
      c(r);
    }, Wi2)) : c(r);
  }
  _pushHistory(e) {
    const t8 = this._undoRedoService, o = this._historyStateCache.get(e);
    if (!Array.isArray(o) || o.length === 0)
      return;
    const r = o.length, s = o[0].commandId, i = o[0], a = o[r - 1], c = {
      unitId: e,
      actions: o.reduce((l, A) => Qt.compose(l, A.redoState.actions), null),
      textRanges: a.redoState.textRanges
    }, d = {
      unitId: e,
      // Always need to put undoParams after redoParams, because `reverse` will change the `cacheStates` order.
      actions: o.reverse().reduce((l, A) => Qt.compose(l, A.undoState.actions), null),
      textRanges: i.undoState.textRanges
    };
    t8.pushUndoRedo({
      unitID: e,
      undoMutations: [{ id: s, params: d }],
      redoMutations: [{ id: s, params: c }]
    }), o.length = 0;
  }
  _emitChangeState(e) {
    const t8 = this._changeStateCache.get(e);
    if (!Array.isArray(t8) || t8.length === 0)
      return;
    const o = t8.length, { commandId: r, trigger: s, segmentId: i, noHistory: a, debounce: c } = t8[0], d = t8[0], l = t8[o - 1], A = {
      unitId: e,
      actions: t8.reduce((g, f2) => Qt.compose(g, f2.redoState.actions), null),
      textRanges: l.redoState.textRanges
    }, h = {
      unitId: e,
      // Always need to put undoParams after redoParams, because `reverse` will change the `cacheStates` order.
      actions: t8.reverse().reduce((g, f2) => Qt.compose(g, f2.undoState.actions), null),
      textRanges: d.undoState.textRanges
    }, u = {
      commandId: r,
      unitId: e,
      trigger: s,
      redoState: A,
      undoState: h,
      segmentId: i,
      noHistory: a,
      debounce: c
    };
    t8.length = 0, this._docStateChange$.next(u);
  }
};
Io2 = lf([
  un4(0, Inject(Qo)),
  un4(1, Ls),
  un4(2, vr),
  un4(3, Inject(te)),
  un4(4, ME)
], Io2);
var df = Object.getOwnPropertyDescriptor;
var Af = (n, e, t8, o) => {
  for (var r = o > 1 ? void 0 : o ? df(e, t8) : e, s = n.length - 1, i; s >= 0; s--)
    (i = n[s]) && (r = i(r) || r);
  return r;
};
var ji2 = (n, e) => (t8, o) => e(t8, o, n);
var zi2 = "univer-doc-main-canvas";
var So2 = class extends h1 {
  constructor(n, e) {
    super(), this._instanceSrv = n, this._renderManagerService = e, this._init();
  }
  _init() {
    this._renderManagerService.createRender$.pipe(takeUntil(this.dispose$)).subscribe((n) => this._createRenderWithId(n)), this._instanceSrv.getAllUnitsForType(we.UNIVER_DOC).forEach((n) => this._createRenderer(n)), this._instanceSrv.getTypeOfUnitAdded$(we.UNIVER_DOC).pipe(takeUntil(this.dispose$)).subscribe((n) => this._createRenderer(n)), this._instanceSrv.getTypeOfUnitDisposed$(we.UNIVER_DOC).pipe(takeUntil(this.dispose$)).subscribe((n) => this._disposeRenderer(n));
  }
  _createRenderer(n) {
    var o;
    const e = n.getUnitId(), t8 = (o = this._instanceSrv.getCurrentUnitForType(we.UNIVER_DOC)) == null ? void 0 : o.getUnitId();
    this._renderManagerService.created$.subscribe((r) => {
      r.unitId === t8 && (r.engine.getCanvas().setId(zi2), r.engine.getCanvas().getContext().setId(zi2));
    }), this._renderManagerService.has(e) || this._createRenderWithId(e);
  }
  _createRenderWithId(n) {
    this._renderManagerService.createRender(n);
  }
  _disposeRenderer(n) {
    const e = n.getUnitId();
    this._renderManagerService.removeRender(e);
  }
};
So2 = Af([
  ji2(0, vr),
  ji2(1, ME)
], So2);
var uf = {
  id: bn2.id,
  preconditions: ch,
  binding: q1.ENTER
};
var hf = {
  id: Do2.id,
  preconditions: Se2,
  binding: q1.BACKSPACE
};
var gf = {
  id: ba.id,
  preconditions: Se2,
  binding: q1.DELETE
};
var ff = {
  id: St2.id,
  binding: q1.ARROW_UP,
  preconditions: Se2,
  staticParameters: {
    direction: Cm.UP
  }
};
var pf = {
  id: St2.id,
  binding: q1.ARROW_DOWN,
  preconditions: Se2,
  staticParameters: {
    direction: Cm.DOWN
  }
};
var mf = {
  id: St2.id,
  binding: q1.ARROW_LEFT,
  preconditions: Se2,
  staticParameters: {
    direction: Cm.LEFT
  }
};
var Ef = {
  id: St2.id,
  binding: q1.ARROW_RIGHT,
  preconditions: Se2,
  staticParameters: {
    direction: Cm.RIGHT
  }
};
var If = {
  id: vt2.id,
  binding: q1.ARROW_UP | L1.SHIFT,
  preconditions: Se2,
  staticParameters: {
    direction: Cm.UP
  }
};
var Sf = {
  id: vt2.id,
  binding: q1.ARROW_DOWN | L1.SHIFT,
  preconditions: Se2,
  staticParameters: {
    direction: Cm.DOWN
  }
};
var vf3 = {
  id: vt2.id,
  binding: q1.ARROW_LEFT | L1.SHIFT,
  preconditions: Se2,
  staticParameters: {
    direction: Cm.LEFT
  }
};
var Cf = {
  id: vt2.id,
  binding: q1.ARROW_RIGHT | L1.SHIFT,
  preconditions: Se2,
  staticParameters: {
    direction: Cm.RIGHT
  }
};
var Rf = {
  id: Oa.id,
  binding: q1.A | L1.CTRL_COMMAND,
  preconditions: (n) => n.getContextValue(xR) && (n.getContextValue(qr) || n.getContextValue(mE))
};
var bf = Object.defineProperty;
var yf = Object.getOwnPropertyDescriptor;
var xf = (n, e, t8) => e in n ? bf(n, e, { enumerable: true, configurable: true, writable: true, value: t8 }) : n[e] = t8;
var Of = (n, e, t8, o) => {
  for (var r = o > 1 ? void 0 : o ? yf(e, t8) : e, s = n.length - 1, i; s >= 0; s--)
    (i = n[s]) && (r = i(r) || r);
  return r;
};
var hn3 = (n, e) => (t8, o) => e(t8, o, n);
var Tf = (n, e, t8) => xf(n, e + "", t8);
var wr2 = class extends Ol {
  // static override type = UniverInstanceType.UNIVER_DOC;
  constructor(n = Di, e, t8, o, r, s) {
    super(), this._config = n, this._injector = e, this._renderManagerSrv = t8, this._commandService = o, this._logService = r, this._configService = s;
    const { menu: i, ...a } = oo(
      {},
      Di,
      this._config
    );
    i && this._configService.setConfig("menu", i, { merge: true }), this._configService.setConfig(Vo2, a), this._initDependencies(e), this._initializeShortcut(), this._initCommand();
  }
  onReady() {
    this._initRenderBasics(), this._markDocAsFocused(), zc(this._injector, [
      [Io2],
      [So2]
    ]);
  }
  onRendered() {
    this._initUI(), this._initRenderModules(), zc(this._injector, [
      [go2],
      [fo4],
      [tn3],
      [po2],
      // FIXME: LifecycleStages.Rendered must be used, otherwise the menu cannot be added to the DOM, but the sheet ui
      // plugin can be added in LifecycleStages.Ready
      [Ao2]
    ]);
  }
  // eslint-disable-next-line max-lines-per-function
  _initCommand() {
    [
      Do2,
      ba,
      Lt2,
      Qt5,
      Ut3,
      Ft4,
      bt3,
      Ht2,
      ct3,
      en3,
      mt2,
      Un2,
      Et,
      yt2,
      Gr,
      va,
      yn2,
      Zr,
      Ca,
      Jr,
      Ra,
      tt2,
      On2,
      xn3,
      Fn4,
      Qo3,
      Uo2,
      Fo2,
      lt3,
      Ho2,
      Po2,
      Wa,
      ja,
      Rs2,
      bs2,
      SA,
      ys,
      xs,
      Is,
      Ss,
      Hn2,
      Ms2,
      za,
      Zt3,
      Mo2,
      bn2,
      gr2,
      Lo2,
      so2,
      Pa,
      Na,
      Ta,
      ko2,
      rt4,
      Sa,
      Jt2,
      qd,
      _a,
      Xd,
      Xn2,
      Oa,
      Ds,
      St2,
      vt2,
      Jd,
      wa,
      $d,
      Xe3,
      La,
      es,
      os,
      ss2,
      us2,
      hs2,
      gs2,
      fs,
      ps,
      io2,
      Qa,
      Ua2,
      ls2,
      ds2,
      As,
      as,
      pc2,
      _s
    ].forEach((n) => {
      this.disposeWithMe(this._commandService.registerCommand(n));
    }), [ro2, rs, is].forEach((n) => this.disposeWithMe(this._commandService.registerMultipleCommand(n)));
  }
  _initializeShortcut() {
    [
      ff,
      pf,
      Ef,
      mf,
      If,
      Sf,
      vf3,
      Cf,
      Rf,
      hf,
      gf,
      uf,
      dh
    ].forEach((n) => {
      this._injector.get(ye3).registerShortcut(n);
    });
  }
  _initDependencies(n) {
    nC([
      [af],
      [mo2],
      [Eo3],
      [Ao2],
      [go2],
      [po2],
      [fo4],
      [ho2],
      [tn3],
      [Ge2, { useClass: Sr }],
      [Nt3, { useClass: ur2 }],
      [Bn4],
      [So2],
      [Io2],
      [Dt],
      [at2]
    ], this._config.override).forEach((t8) => n.add(t8));
  }
  _markDocAsFocused() {
    const n = this._injector.get(vr), e = this._injector.get(Ge2);
    try {
      const t8 = n.getCurrentUnitForType(we.UNIVER_DOC);
      if (!t8) return;
      const o = t8.getUnitId();
      e.isEditor(o) || n.focusUnit(t8.getUnitId());
    } catch (t8) {
      this._logService.warn(t8);
    }
  }
  _initUI() {
    this._injector.get(ho2);
  }
  _initRenderBasics() {
    [
      [D],
      [Re2],
      [J2],
      [Ps],
      [No2],
      [br],
      [Dr2]
    ].forEach((n) => {
      this._renderManagerSrv.registerRenderModule(we.UNIVER_DOC, n);
    });
  }
  _initRenderModules() {
    [
      [wt2],
      [co2],
      [lo2],
      [uo3],
      [_r],
      [Cr2],
      [Mr2],
      [Or2],
      [xr2],
      [mo2],
      [Br],
      [Tr],
      [Eo3]
    ].forEach((n) => {
      this._renderManagerSrv.registerRenderModule(we.UNIVER_DOC, n);
    });
  }
};
Tf(wr2, "pluginName", sd2);
wr2 = Of([
  qR(o7),
  hn3(1, Inject(Injector)),
  hn3(2, ME),
  hn3(3, Ls),
  hn3(4, yt),
  hn3(5, ic)
], wr2);
function Bf(n, e, t8) {
  const o = useDependency(Ls), r = useDependency(ye3), s = (0, import_react3.useMemo)(() => et(4), []);
  (0, import_react3.useEffect)(() => {
    if (!t8 || !n || !e)
      return;
    const a = `sheet.operation.editor-${t8.getEditorId()}-keyboard-${s}`, c = new ao();
    return c.add(o.registerCommand({
      id: a,
      type: Ms.OPERATION,
      handler(d, l) {
        const { keyCode: A, metaKey: h } = l;
        e.handler(A, h);
      }
    })), e.keyCodes.map((d) => ({
      id: a,
      binding: d.metaKey ? d.keyCode | d.metaKey : d.keyCode,
      preconditions: () => true,
      priority: 901,
      staticParameters: {
        eventType: Kv.Keyboard,
        keyCode: d.keyCode,
        metaKey: d.metaKey
      }
    })).forEach((d) => {
      c.add(r.registerShortcut(d));
    }), () => {
      c.dispose();
    };
  }, [o, e, t8, n, s, r]);
}
var Mf = (n, e = true, t8, o) => {
  const r = (0, import_react3.useCallback)(() => {
    if (n) {
      const { scene: i, mainComponent: a } = n.render, c = n.render.with(D), { width: d, height: l } = n.getBoundingClientRect();
      c.getViewModel().getDataModel().updateDocumentDataPageSize(e ? 1 / 0 : d, 1 / 0), i.transformByState({
        width: d,
        height: l
      }), a == null || a.resize(d, l);
    }
  }, [n, e]), s = (0, import_react3.useMemo)(() => n1(() => {
    var I2, S;
    if (!t8 || !n || !t8)
      return;
    const a = n.render.with(D).getSkeleton(), { scene: c, mainComponent: d } = n.render, l = c.getViewport(We4.VIEW_MAIN), { actualWidth: A, actualHeight: h } = a.getActualSize(), { width: u, height: g } = n.getBoundingClientRect();
    let f2 = l == null ? void 0 : l.getScrollBar();
    const p = Math.max(A, u), m2 = Math.max(h, g);
    c.transformByState({
      width: p,
      height: m2
    }), d == null || d.resize(p, m2), e ? A > u ? (f2 == null ? l && new D8(l, {
      barSize: 8,
      enableVertical: false,
      enableHorizontal: true,
      minThumbSizeV: 8
    }) : l == null || l.resetCanvasSizeAndUpdateScroll(), o && (l == null || l.scrollToBarPos({ x: 1 / 0, y: 0 }))) : (f2 = null, l == null || l.scrollToBarPos({ x: 0, y: 0 }), (S = l == null ? void 0 : l.getScrollBar()) == null || S.dispose()) : h > g ? (f2 == null ? l && (f2 = new D8(l, {
      enableHorizontal: false,
      enableVertical: true,
      barSize: 8,
      minThumbSizeV: 8
    })) : l == null || l.resetCanvasSizeAndUpdateScroll(), o && (l == null || l.scrollToBarPos({ x: 0, y: 1 / 0 }))) : (f2 = null, l == null || l.scrollToBarPos({ x: 0, y: 0 }), (I2 = l == null ? void 0 : l.getScrollBar()) == null || I2.dispose());
  }, 30), [n, t8, e, o]);
  return (0, import_react3.useEffect)(() => {
    if (t8 && n) {
      const i = setTimeout(() => {
        r(), s();
      }, 500);
      return () => {
        clearTimeout(i);
      };
    }
  }, [n, t8, r, s]), (0, import_react3.useEffect)(() => {
    if (t8 && n) {
      const i = n.input$.subscribe(() => {
        s();
      });
      return () => {
        i.unsubscribe();
      };
    }
  }, [n, t8, s]), { resize: r, checkScrollBar: s };
};
function _f(n) {
  const { editorId: e, initialValue: t8, container: o, autoFocus: r, isSingle: s } = n, i = (0, import_react3.useMemo)(() => r != null ? r : false, []), [a, c] = (0, import_react3.useState)(), d = useDependency(Ge2);
  return (0, import_react3.useLayoutEffect)(() => {
    var l, A;
    if (o.current) {
      const h = typeof t8 == "string" ? void 0 : J.deepClone(t8), u = {
        body: {
          dataStream: typeof t8 == "string" ? `${t8}\r
` : `\r
`,
          textRuns: [],
          customBlocks: [],
          customDecorations: [],
          customRanges: [],
          paragraphs: [{
            startIndex: 0
          }]
        },
        ...h,
        documentStyle: {
          ...h == null ? void 0 : h.documentStyle,
          pageSize: {
            width: s ? 1 / 0 : o.current.clientWidth,
            height: 1 / 0
          }
        },
        id: e
      }, g = d.register(
        {
          autofocus: true,
          editorUnitId: e,
          initialSnapshot: u
        },
        o.current
      ), f2 = d.getEditor(e);
      if (c(f2), i) {
        f2.focus();
        const p = ((A = (l = u.body) == null ? void 0 : l.dataStream.length) != null ? A : 2) - 2;
        f2.setSelectionRanges([{ startOffset: p, endOffset: p }]);
      }
      return () => {
        g == null || g.dispose();
      };
    }
  }, []), a;
}
var Df = (n, e, t8, o) => {
  const r = useDependency(Ls), s = useDependency(ye3), i = (0, import_react3.useRef)(e);
  i.current = e;
  const a = (0, import_react3.useRef)(o);
  a.current = o, (0, import_react3.useEffect)(() => {
    if (!t8 || !n)
      return;
    const d = `sheet.formula-embedding-editor.${t8.getEditorId()}`, l = new ao(), A = (u, g) => {
      if (a.current) {
        a.current(u, g);
        return;
      }
      let f2 = Cm.LEFT;
      u === q1.ARROW_DOWN ? f2 = Cm.DOWN : u === q1.ARROW_UP ? f2 = Cm.UP : u === q1.ARROW_RIGHT && (f2 = Cm.RIGHT), g === L1.SHIFT ? r.executeCommand(vt2.id, {
        direction: f2
      }) : r.executeCommand(St2.id, {
        direction: f2
      });
    };
    return l.add(r.registerCommand({
      id: d,
      type: Ms.OPERATION,
      handler(u, g) {
        const { keyCode: f2 } = g;
        A(f2);
      }
    })), [
      { keyCode: q1.ARROW_DOWN },
      { keyCode: q1.ARROW_LEFT },
      { keyCode: q1.ARROW_RIGHT },
      { keyCode: q1.ARROW_UP },
      { keyCode: q1.ARROW_DOWN, metaKey: L1.SHIFT },
      { keyCode: q1.ARROW_LEFT, metaKey: L1.SHIFT },
      { keyCode: q1.ARROW_RIGHT, metaKey: L1.SHIFT },
      { keyCode: q1.ARROW_UP, metaKey: L1.SHIFT },
      { keyCode: q1.ARROW_DOWN, metaKey: L1.CTRL_COMMAND },
      { keyCode: q1.ARROW_LEFT, metaKey: L1.CTRL_COMMAND },
      { keyCode: q1.ARROW_RIGHT, metaKey: L1.CTRL_COMMAND },
      { keyCode: q1.ARROW_UP, metaKey: L1.CTRL_COMMAND },
      { keyCode: q1.ARROW_DOWN, metaKey: L1.CTRL_COMMAND | L1.SHIFT },
      { keyCode: q1.ARROW_LEFT, metaKey: L1.CTRL_COMMAND | L1.SHIFT },
      { keyCode: q1.ARROW_RIGHT, metaKey: L1.CTRL_COMMAND | L1.SHIFT },
      { keyCode: q1.ARROW_UP, metaKey: L1.CTRL_COMMAND | L1.SHIFT }
    ].map(({ keyCode: u, metaKey: g }) => ({
      id: d,
      binding: g ? u | g : u,
      preconditions: () => true,
      priority: 900,
      staticParameters: {
        eventType: Kv.Keyboard,
        keyCode: u
      }
    })).forEach((u) => {
      l.add(s.registerShortcut(u));
    }), () => {
      l.dispose();
    };
  }, [r, t8, n, s]);
};
function wf(n, e) {
  const t8 = useDependency(Ls);
  (0, import_react3.useEffect)(() => {
    if (!n) return;
    const o = t8.onCommandExecuted((r) => {
      var s, i;
      if (r.id === M.id) {
        if (r.params.unitId !== n.getEditorId()) return;
        const c = n.getDocumentData();
        e(c, qo((i = (s = c.body) == null ? void 0 : s.dataStream) != null ? i : ""));
      }
    });
    return () => {
      o.dispose();
    };
  }, [n, e, t8]);
}
var Jf = (n) => {
  var H3;
  const {
    className: e,
    autoFocus: t8,
    onFocusChange: o,
    initialValue: r,
    onClickOutside: s,
    keyboardEventConfig: i,
    moveCursor: a = true,
    style: c,
    isSingle: d,
    editorId: l,
    onHeightChange: A,
    onChange: h,
    defaultHeight: u = 32,
    maxHeight: g = 32,
    icon: f2,
    editorRef: p,
    placeholder: m2
  } = n, I2 = useDependency(Ge2), S = re(o), v2 = re(s), [R, E] = (0, import_react3.useState)(u), b2 = (0, import_react3.useRef)(null), y = (0, import_react3.useMemo)(() => l != null ? l : VC(`RICH_TEXT_EDITOR-${et(4)}`), [l]), C = _f({
    editorId: y,
    initialValue: r,
    container: b2,
    autoFocus: t8,
    isSingle: d
  }), x7 = useDependency(ME).getRenderById(y), M7 = x7 == null ? void 0 : x7.with(Re2), w = useObservable(M7 == null ? void 0 : M7.textSelectionInner$), F2 = !!((H3 = M7 == null ? void 0 : M7.isFocusing) != null && H3 && (w != null && w.textRanges.some((k7) => k7.collapsed))), P2 = (0, import_react3.useRef)(null), [N, ee3] = (0, import_react3.useState)(() => {
    var k7, ne2;
    return !Je.transform.getPlainText((ne2 = (k7 = C == null ? void 0 : C.getDocumentData().body) == null ? void 0 : k7.dataStream) != null ? ne2 : "");
  }), { checkScrollBar: $ } = Mf(C, d, true, true);
  (0, import_react3.useLayoutEffect)(() => {
    if (!(!p || !C)) {
      if (typeof p == "function") {
        p(C);
        return;
      }
      p.current = C;
    }
  }, [C]);
  const U2 = re((k7) => {
    var ae2, oe2;
    const ne2 = x7 == null ? void 0 : x7.with(D), ie5 = ne2 == null ? void 0 : ne2.getSkeleton().getActualSize();
    ie5 && (A == null || A(ie5.actualHeight), E(Math.max(u, Math.min(ie5.actualHeight + 10, g)))), h == null || h(k7, qo((oe2 = (ae2 = k7.body) == null ? void 0 : ae2.dataStream) != null ? oe2 : "")), $();
  });
  return (0, import_react3.useEffect)(() => {
    var ne2, ie5;
    ee3(!Je.transform.getPlainText((ie5 = (ne2 = C == null ? void 0 : C.getDocumentData().body) == null ? void 0 : ne2.dataStream) != null ? ie5 : ""));
    const k7 = C == null ? void 0 : C.selectionChange$.subscribe(() => {
      var ae2, oe2;
      ee3(!Je.transform.getPlainText((oe2 = (ae2 = C == null ? void 0 : C.getDocumentData().body) == null ? void 0 : ae2.dataStream) != null ? oe2 : ""));
    });
    return () => k7 == null ? void 0 : k7.unsubscribe();
  }, [C]), useObservable(C == null ? void 0 : C.blur$), useObservable(C == null ? void 0 : C.focus$), (0, import_react3.useEffect)(() => {
    var ne2, ie5;
    const k7 = C == null ? void 0 : C.getDocumentData();
    S == null || S(F2, qo((ie5 = (ne2 = k7 == null ? void 0 : k7.body) == null ? void 0 : ne2.dataStream) != null ? ie5 : ""));
  }, [F2, S]), (0, import_react3.useEffect)(() => {
    const k7 = (ie5) => {
      var oe2, he3;
      I2.getFocusId() !== y || ((he3 = (oe2 = ie5.target) == null ? void 0 : oe2.dataset) == null ? void 0 : he3.editorid) === y || P2.current && !P2.current.contains(ie5.target) && (v2 == null || v2());
    }, ne2 = setTimeout(() => {
      document.addEventListener("click", k7);
    }, 100);
    return () => {
      document.removeEventListener("click", k7), clearTimeout(ne2);
    };
  }, [C, y, I2, v2]), Df(F2 && a, false, C), Bf(F2, i, C), wf(C, U2), (0, import_jsx_runtime3.jsx)("div", { className: e, style: c, children: (0, import_jsx_runtime3.jsxs)(
    "div",
    {
      className: ie2("univer-relative univer-box-border univer-flex univer-h-8 univer-w-full univer-items-center univer-justify-around univer-gap-2 univer-rounded-md univer-pb-0.5 univer-pl-1.5 univer-pr-2 univer-pt-1.5", kt2, {
        "univer-border-primary-500": F2
      }),
      style: { height: R },
      ref: P2,
      children: [
        (0, import_jsx_runtime3.jsx)(
          "div",
          {
            ref: b2,
            className: "univer-relative univer-size-full",
            onMouseUp: () => C == null ? void 0 : C.focus()
          }
        ),
        f2,
        N ? (0, import_jsx_runtime3.jsx)(
          "div",
          {
            className: "univer-absolute univer-left-[5px] univer-top-[5px] univer-text-sm univer-text-gray-500",
            children: m2
          }
        ) : null
      ]
    }
  ) });
};

// node_modules/@univerjs/sheets-ui/lib/es/index.js
var import_react4 = __toESM(require_react());
var import_jsx_runtime4 = __toESM(require_jsx_runtime());
var Bp = Object.defineProperty;
var Fp = (r, e, t8) => e in r ? Bp(r, e, { enumerable: true, configurable: true, writable: true, value: t8 }) : r[e] = t8;
var _2 = (r, e, t8) => Fp(r, typeof e != "symbol" ? e + "" : e, t8);
function Dd2(r, e) {
  if (r == null)
    return;
  const t8 = e.getRenderById(r);
  if (t8 == null)
    return;
  const { mainComponent: n, scene: i, engine: o, components: s } = t8, l = n, a = s.get($e3.BACKGROUND);
  return {
    document: l,
    docBackground: a,
    scene: i,
    engine: o
  };
}
var Lc = [10, 400];
var hm = "RANGE_SELECTOR_COMPONENT_KEY";
var Ld2 = "EMBEDDING_FORMULA_EDITOR_COMPONENT_KEY";
var Ye3 = ((r) => (r.MAIN = "__SpreadsheetRender__", r.ROW = "__SpreadsheetRowHeader__", r.COLUMN = "__SpreadsheetColumnHeader__", r.LEFT_TOP = "__SpreadsheetLeftTopPlaceholder__", r))(Ye3 || {});
var Wu2 = 0;
var Qs2 = 1;
var rr4 = 10;
var EC = 11;
var Bu3 = 12;
var oa = {
  id: "sheet.command.set-row-header-width",
  type: Ms.COMMAND,
  handler: async (r, e) => {
    if (!e)
      return false;
    const t8 = r.get(ME);
    if (!t8)
      return false;
    const { unitId: n, subUnitId: i, size: o } = e, s = t8.getRenderById(n);
    if (s) {
      t8.getRenderById(n).with(ue).setRowHeaderSize(s, i, o);
      const { components: a } = s, c = a.get(Ye3.ROW);
      c && c.setCustomHeader({ headerStyle: { size: o } }, i);
    }
    return true;
  }
};
var sa = {
  id: "sheet.command.set-col-header-height",
  type: Ms.COMMAND,
  handler: async (r, e) => {
    if (!e)
      return false;
    const t8 = r.get(ME);
    if (!t8)
      return false;
    const { unitId: n, subUnitId: i, size: o } = e, s = t8.getRenderById(n);
    if (s) {
      t8.getRenderById(n).with(ue).setColumnHeaderSize(s, i, o);
      const { components: a } = s, c = a.get(Ye3.COLUMN);
      c && c.setCustomHeader({ headerStyle: { size: o } }, i);
    }
    return true;
  }
};
var Wc2 = qC("rangeMovePermissionCheck");
var Bc4 = qC("rangeFillPermissionCheck");
var gm = ((r) => (r[r.FORMULA_EDITOR_SHOW = 100] = "FORMULA_EDITOR_SHOW", r[r.MARK_SELECTION = 1e4] = "MARK_SELECTION", r))(gm || {});
function Sr2(r) {
  const e = r.getColorFromTheme("primary.600"), t8 = r.getColorFromTheme("white"), n = new bt(e).setAlpha(0.07).toRgbString();
  return {
    strokeWidth: 1,
    stroke: e,
    fill: n,
    // widgets: { tl: true, tc: true, tr: true, ml: true, mr: true, bl: true, bc: true, br: true },
    widgets: {},
    widgetSize: 6,
    widgetStrokeWidth: 1,
    widgetStroke: t8,
    autofillSize: 6,
    autofillStrokeWidth: 1,
    autofillStroke: t8,
    rowHeaderFill: n,
    rowHeaderStroke: e,
    rowHeaderStrokeWidth: 1,
    columnHeaderFill: n,
    columnHeaderStroke: e,
    columnHeaderStrokeWidth: 1,
    expandCornerSize: 40
  };
}
var TC = class {
  constructor() {
    _2(this, "_startColumn", -1);
    _2(this, "_startRow", -1);
    _2(this, "_endColumn", -1);
    _2(this, "_endRow", -1);
    _2(this, "_startX", 0);
    _2(this, "_startY", 0);
    _2(this, "_endX", 0);
    _2(this, "_endY", 0);
    _2(this, "_primary");
    _2(this, "_rangeType", ge.NORMAL);
  }
  get startColumn() {
    return this._startColumn;
  }
  get startRow() {
    return this._startRow;
  }
  get endColumn() {
    return this._endColumn;
  }
  get endRow() {
    return this._endRow;
  }
  get startX() {
    return this._startX;
  }
  get startY() {
    return this._startY;
  }
  get endX() {
    return this._endX;
  }
  get endY() {
    return this._endY;
  }
  get currentCell() {
    return this._primary;
  }
  get rangeType() {
    return this._rangeType;
  }
  /**
   * @deprecated, Duplicate with `Rectangle`
   */
  isEqual(e) {
    const { startColumn: t8, startRow: n, endColumn: i, endRow: o } = this, {
      startColumn: s,
      startRow: l,
      endColumn: a,
      endRow: c
    } = e;
    return t8 === s && n === l && i === a && o === c;
  }
  highlightToSelection() {
    if (this._primary)
      return zg(this._primary);
  }
  getRange() {
    return {
      startColumn: this._startColumn,
      startRow: this._startRow,
      endColumn: this._endColumn,
      endRow: this._endRow,
      startX: this._startX,
      startY: this._startY,
      endX: this._endX,
      endY: this._endY,
      rangeType: this.rangeType
    };
  }
  getCell() {
    return this._primary;
  }
  getRangeType() {
    return this._rangeType;
  }
  setRangeType(e) {
    this._rangeType = e;
  }
  getValue() {
    return {
      rangeWithCoord: this.getRange(),
      primaryWithCoord: this._primary
    };
  }
  setValue(e, t8) {
    const {
      startColumn: n,
      startRow: i,
      endColumn: o,
      endRow: s,
      startX: l,
      startY: a,
      endX: c,
      endY: d,
      rangeType: u
    } = e;
    this._startColumn = n, this._startRow = i, this._endColumn = o, this._endRow = s, this._startX = l, this._startY = a, this._endX = c, this._endY = d, u !== void 0 && (this._rangeType = u), t8 !== void 0 && this.setCurrentCell(t8);
  }
  /**
   * Set primary cell.
   * @TODO lumixraku there are 3 concepts for same thing, primary and current and highlight
   * highlight is best. primary sometimes means the actual cell(actual means ignore merge)
   * @param currentCell
   */
  setCurrentCell(e) {
    this._primary = e;
  }
  clearCurrentCell() {
    this._primary = null;
  }
};
function bo2(r, e) {
  const { startRow: t8, startColumn: n, endRow: i, endColumn: o, rangeType: s } = e, l = i < t8 ? i : t8, a = i < t8 ? t8 : i, c = o < n ? o : n, d = o < n ? n : o, u = r.getNoMergeCellWithCoordByIndex(l, c), h = r.getNoMergeCellWithCoordByIndex(a, d);
  return {
    startRow: t8,
    startColumn: n,
    endRow: i,
    endColumn: o,
    rangeType: s,
    startY: (u == null ? void 0 : u.startY) || 0,
    endY: (h == null ? void 0 : h.endY) || 0,
    startX: (u == null ? void 0 : u.startX) || 0,
    endX: (h == null ? void 0 : h.endX) || 0
  };
}
function Wt4(r, e) {
  const { range: t8, primary: n, style: i } = r, o = bo2(e, t8), s = n && Ks(e, n);
  return {
    rangeWithCoord: o,
    primaryWithCoord: s,
    style: i
  };
}
function Ks(r, e) {
  const { actualRow: t8, actualColumn: n, isMerged: i, isMergedMainCell: o, startRow: s, startColumn: l, endRow: a, endColumn: c } = e, d = r.getNoMergeCellWithCoordByIndex(t8, n), u = r.getNoMergeCellWithCoordByIndex(s, l), h = r.getNoMergeCellWithCoordByIndex(a, c);
  return {
    actualRow: t8,
    actualColumn: n,
    isMerged: i,
    isMergedMainCell: o,
    startX: d.startX,
    startY: d.startY,
    endX: d.endX,
    endY: d.endY,
    mergeInfo: {
      startRow: s,
      startColumn: l,
      endRow: a,
      endColumn: c,
      startY: (u == null ? void 0 : u.startY) || 0,
      endY: (h == null ? void 0 : h.endY) || 0,
      startX: (u == null ? void 0 : u.startX) || 0,
      endX: (h == null ? void 0 : h.endX) || 0
    }
  };
}
var Fu3 = "__SpreadsheetHelperSelectionTempRect";
var PC = 35;
var xC = class {
  constructor(e, t8) {
    _2(this, "_startOffsetX", 0);
    _2(this, "_startOffsetY", 0);
    _2(this, "_relativeSelectionPositionRow", 0);
    _2(this, "_relativeSelectionPositionColumn", 0);
    _2(this, "_relativeSelectionRowLength", 0);
    _2(this, "_relativeSelectionColumnLength", 0);
    _2(this, "_scenePointerMoveSub");
    _2(this, "_scenePointerUpSub");
    _2(this, "_disabled", false);
    _2(this, "_helperSelection");
    _2(this, "_scrollTimer");
    _2(this, "_activeViewport");
    _2(this, "_targetSelection", {
      startY: 0,
      endY: 0,
      startX: 0,
      endX: 0,
      startRow: -1,
      endRow: -1,
      startColumn: -1,
      endColumn: -1
    });
    _2(this, "_isInMergeState", false);
    _2(this, "_fillControlColors", []);
    _2(this, "_skeleton");
    _2(this, "_scene");
    _2(this, "_themeService");
    _2(this, "_injector");
    _2(this, "_selectionHooks");
    this._control = e, this._skeleton = t8.skeleton, this._scene = t8.scene, this._themeService = t8.themeService, this._injector = t8.injector, this._selectionHooks = t8.selectionHooks, this._initialControl(), this._initialWidget(), this._initialAutoFill(), this._control.dispose$.subscribe(() => {
      this.dispose();
    });
  }
  get isHelperSelection() {
    return this._control.isHelperSelection;
  }
  dispose() {
    var e, t8;
    (e = this._scrollTimer) == null || e.dispose(), this._fillControlColors = [], this._clearObserverEvent(), (t8 = this._helperSelection) == null || t8.dispose();
  }
  setDisabled(e) {
    this._disabled = e;
  }
  _getFreeze() {
    var t8, n;
    return (n = (t8 = eA(
      we.UNIVER_SHEET,
      ue,
      this._injector.get(vr),
      this._injector.get(ME)
    )) == null ? void 0 : t8.getCurrentParam()) == null ? void 0 : n.skeleton.getWorksheetConfig().freeze;
  }
  _isSelectionInViewport(e, t8) {
    const n = this._getFreeze() || {
      startRow: -1,
      startColumn: -1
    };
    switch (t8.viewportKey) {
      case k2.VIEW_MAIN:
        return e.endRow >= n.startRow && e.endColumn >= n.startColumn;
      case k2.VIEW_MAIN_TOP:
      case k2.VIEW_COLUMN_RIGHT:
        return e.endColumn >= n.startColumn && e.startRow < n.startRow;
      case k2.VIEW_MAIN_LEFT:
      case k2.VIEW_ROW_BOTTOM:
        return e.endRow >= n.startRow && e.startColumn < n.startColumn;
      case k2.VIEW_MAIN_LEFT_TOP:
      case k2.VIEW_COLUMN_LEFT:
      case k2.VIEW_ROW_TOP:
      case k2.VIEW_LEFT_TOP:
        return e.startRow < n.startRow && e.startColumn < n.startColumn;
    }
  }
  _clearObserverEvent() {
    var e, t8;
    (e = this._scenePointerMoveSub) == null || e.unsubscribe(), (t8 = this._scenePointerUpSub) == null || t8.unsubscribe(), this._scenePointerMoveSub = null, this._scenePointerUpSub = null;
  }
  _initialControl() {
    const { leftControl: e, rightControl: t8, topControl: n, bottomControl: i } = this._control;
    [e, t8, n, i].forEach((o) => {
      o.onPointerEnter$.subscribeEvent(() => {
        var l;
        ((l = this._injector.get(gt, Quantity.OPTIONAL)) == null ? void 0 : l.interceptor.fetchThroughInterceptors(Wc2)(false, null)) !== false && o.setCursor(v1.MOVE);
      }), o.onPointerLeave$.subscribeEvent(() => {
        o.resetCursor();
      }), o.onPointerDown$.subscribeEvent(this._controlPointerDownHandler.bind(this));
    });
  }
  /**
   * Move the whole selection control after cursor turn into move state.
   * NOT same as widgetMoving, that's for 8 control points.
   * @param moveOffsetX
   * @param moveOffsetY
   */
  _controlMoving(e, t8) {
    var E;
    const n = this._scene, i = n.getScrollXYInfoByViewport(U.FromArray([e, t8])), { scaleX: o, scaleY: s } = n.getAncestorScale(), l = this._skeleton.getCellIndexByOffset(
      e,
      t8,
      o,
      s,
      i
    ), { row: a, column: c } = l, d = this._skeleton.getRowCount() - 1, u = this._skeleton.getColumnCount() - 1;
    let h = Math.max(0, a + this._relativeSelectionPositionRow), g = h + this._relativeSelectionRowLength;
    g > d && (g = d, g - h < this._relativeSelectionRowLength && (h = g - this._relativeSelectionRowLength));
    let m2 = Math.max(0, c + this._relativeSelectionPositionColumn), f2 = m2 + this._relativeSelectionColumnLength;
    f2 > u && (f2 = u, f2 - m2 < this._relativeSelectionColumnLength && (m2 = f2 - this._relativeSelectionColumnLength));
    const v2 = this._skeleton.worksheet.getCellInfoInMergeData(h, m2), S = Wt4({
      range: { startRow: h, endRow: g, startColumn: m2, endColumn: f2 },
      primary: v2,
      style: null
    }, this._skeleton), w = this._skeleton.getNoMergeCellWithCoordByIndex(h, m2), C = this._skeleton.getNoMergeCellWithCoordByIndex(g, f2), I2 = (w == null ? void 0 : w.startY) || 0, R = (C == null ? void 0 : C.endY) || 0, y = (w == null ? void 0 : w.startX) || 0, M7 = (C == null ? void 0 : C.endX) || 0;
    (E = this._helperSelection) == null || E.transformByState({
      left: y,
      top: I2,
      width: M7 - y,
      height: R - I2
    }), this._targetSelection = { ...S.rangeWithCoord }, this._control.selectionMoving$.next(S.rangeWithCoord);
  }
  /**
   * Drag move whole selectionControl when cursor turns to crosshair. Not for dragging 8 control points.
   * @param evt
   */
  _controlPointerDownHandler(e) {
    const { offsetX: t8, offsetY: n } = e, i = this._scene, o = i.getCoordRelativeToViewport(U.FromArray([t8, n])), { x: s, y: l } = o, a = i.getScrollXYInfoByViewport(o), { scaleX: c, scaleY: d } = i.getAncestorScale(), u = this._skeleton.getCellIndexByOffset(
      s,
      l,
      c,
      d,
      a
    );
    this._startOffsetX = s, this._startOffsetY = l;
    const { row: h, column: g } = u, {
      startRow: m2,
      startColumn: f2,
      endRow: v2,
      endColumn: p
    } = this._control.model;
    let S = 0, w = 0;
    h < m2 ? S -= 1 : h > v2 && (S += 1), g < f2 ? w -= 1 : g > p && (w += 1), this._relativeSelectionPositionRow = m2 - h + S, this._relativeSelectionPositionColumn = f2 - g + w, this._relativeSelectionRowLength = v2 - m2, this._relativeSelectionColumnLength = p - f2;
    const C = this._control.currentStyle, I2 = this._getScale();
    this.isHelperSelection && (this._helperSelection = new I12(Fu3, {
      stroke: C.stroke,
      strokeWidth: C.strokeWidth / I2
    }), i.addObject(this._helperSelection));
    const R = i.getViewport(k2.VIEW_MAIN), y = y0.create(i);
    this._scrollTimer = y, y.startScroll(s, l, R), i.disableObjectsEvent(), this._scenePointerMoveSub = i.onPointerMove$.subscribeEvent((M7) => {
      var x7;
      if (this._disabled)
        return;
      const { offsetX: E, offsetY: T } = M7;
      if (((x7 = this._injector.get(gt, Quantity.OPTIONAL)) == null ? void 0 : x7.interceptor.fetchThroughInterceptors(Wc2)(false, null)) === false)
        return;
      const { x: H3, y: A } = i.getCoordRelativeToViewport(
        U.FromArray([E, T])
      );
      this._controlMoving(H3, A), i.setCursor(v1.MOVE), y.scrolling(H3, A, () => {
        this._controlMoving(H3, A);
      });
    }), this._scenePointerUpSub = i.onPointerUp$.subscribeEvent(() => {
      var E, T, P2, H3;
      (E = this._helperSelection) == null || E.dispose();
      const M7 = this._scene;
      M7.resetCursor(), this._clearObserverEvent(), M7.enableObjectsEvent(), (T = this._scrollTimer) == null || T.dispose(), this._control.selectionMoveEnd$.next(this._targetSelection), (H3 = (P2 = this._selectionHooks).selectionMoveEnd) == null || H3.call(P2);
    });
  }
  _initialWidget() {
    const {
      topLeftWidget: e,
      topCenterWidget: t8,
      topRightWidget: n,
      middleLeftWidget: i,
      middleRightWidget: o,
      bottomLeftWidget: s,
      bottomCenterWidget: l,
      bottomRightWidget: a
    } = this._control, c = [
      v1.NORTH_WEST_RESIZE,
      v1.NORTH_RESIZE,
      v1.NORTH_EAST_RESIZE,
      v1.WEST_RESIZE,
      v1.EAST_RESIZE,
      v1.SOUTH_WEST_RESIZE,
      v1.SOUTH_RESIZE,
      v1.SOUTH_EAST_RESIZE
    ];
    [
      e,
      t8,
      n,
      i,
      o,
      s,
      l,
      a
    ].forEach((d, u) => {
      d.onPointerEnter$.subscribeEvent(() => {
        d.setCursor(c[u]);
      }), d.onPointerLeave$.subscribeEvent(() => {
        d.resetCursor();
      }), d.onPointerDown$.subscribeEvent((h) => {
        this._widgetPointerDownEvent(h, c[u]);
      });
    });
  }
  /**
   * Pointer down Events for 8 control point.
   * @param evt
   * @param cursor
   */
  _widgetPointerDownEvent(e, t8) {
    const n = this._scene, { offsetX: i, offsetY: o } = e, s = n.getCoordRelativeToViewport(U.FromArray([i, o])), { x: l, y: a } = s;
    this._startOffsetX = i, this._startOffsetY = o;
    const {
      startRow: c,
      startColumn: d,
      endRow: u,
      endColumn: h
    } = this._control.model, g = Math.min(c, u), m2 = Math.min(d, h), f2 = Math.max(c, u), v2 = Math.max(d, h);
    this._relativeSelectionPositionRow = g, this._relativeSelectionPositionColumn = m2, this._relativeSelectionRowLength = f2 - g, this._relativeSelectionColumnLength = v2 - m2, t8 === v1.NORTH_WEST_RESIZE ? (this._relativeSelectionPositionRow = f2, this._relativeSelectionPositionColumn = v2) : t8 === v1.NORTH_RESIZE ? this._relativeSelectionPositionRow = f2 : t8 === v1.NORTH_EAST_RESIZE ? this._relativeSelectionPositionRow = f2 : t8 === v1.WEST_RESIZE ? this._relativeSelectionPositionColumn = v2 : t8 === v1.SOUTH_WEST_RESIZE ? this._relativeSelectionPositionColumn = v2 : t8 === v1.SOUTH_RESIZE && (this._relativeSelectionPositionRow = g);
    const p = y0.create(n), S = n.getViewport(k2.VIEW_MAIN);
    p.startScroll(l, a, S), this._scrollTimer = p, n.disableObjectsEvent(), this._scenePointerMoveSub = n.onPointerMove$.subscribeEvent((w) => {
      const { offsetX: C, offsetY: I2 } = w, { x: R, y } = n.getCoordRelativeToViewport(
        U.FromArray([C, I2])
      );
      this._widgetMoving(R, y, t8), n.setCursor(t8), p.scrolling(R, y, () => {
        this._widgetMoving(R, y, t8);
      });
    }), this._scenePointerUpSub = n.onPointerUp$.subscribeEvent(() => {
      var C, I2, R;
      const w = this._scene;
      w.resetCursor(), this._clearObserverEvent(), w.enableObjectsEvent(), (C = this._scrollTimer) == null || C.dispose(), this._control.selectionScaled$.next(this._targetSelection), (R = (I2 = this._selectionHooks).selectionMoveEnd) == null || R.call(I2);
    });
  }
  /**
   * Pointer move Events for 8 control point.
   * @param moveOffsetX
   * @param moveOffsetY
   * @param cursor
   */
  _widgetMoving(e, t8, n) {
    const i = this._scene, o = i.getScrollXYInfoByViewport(U.FromArray([this._startOffsetX, this._startOffsetY])), { scaleX: s, scaleY: l } = i.getAncestorScale(), a = this._skeleton.getCellIndexByOffset(
      e,
      t8,
      s,
      l,
      o
    ), { row: c, column: d } = a;
    let u = this._relativeSelectionPositionRow, h = this._relativeSelectionPositionColumn, g = c, m2 = d;
    n === v1.NORTH_WEST_RESIZE ? (u = c, h = d, g = this._relativeSelectionPositionRow, m2 = this._relativeSelectionPositionColumn) : n === v1.NORTH_RESIZE ? (u = c, h = this._relativeSelectionPositionColumn, g = this._relativeSelectionPositionRow, m2 = this._relativeSelectionPositionColumn + this._relativeSelectionColumnLength) : n === v1.NORTH_EAST_RESIZE ? (u = c, h = this._relativeSelectionPositionColumn, g = this._relativeSelectionPositionRow, m2 = d) : n === v1.WEST_RESIZE ? (u = this._relativeSelectionPositionRow, h = d, g = this._relativeSelectionPositionRow + this._relativeSelectionRowLength, m2 = this._relativeSelectionPositionColumn) : n === v1.EAST_RESIZE ? g = this._relativeSelectionPositionRow + this._relativeSelectionRowLength : n === v1.SOUTH_WEST_RESIZE ? (u = this._relativeSelectionPositionRow, h = d, g = c, m2 = this._relativeSelectionPositionColumn) : n === v1.SOUTH_RESIZE && (u = this._relativeSelectionPositionRow, h = this._relativeSelectionPositionColumn, g = c, m2 = this._relativeSelectionPositionColumn + this._relativeSelectionColumnLength);
    const f2 = this._swapPositions(u, h, g, m2), v2 = this._skeleton.getCellWithMergeInfoByIndex(u, h), S = Wt4({ range: f2, primary: v2, style: null }, this._skeleton);
    this._targetSelection = { ...S.rangeWithCoord }, this._control.updateRangeBySelectionWithCoord(S), this._control.selectionScaling$.next(this._targetSelection);
  }
  _initialAutoFill() {
    const { fillControl: e } = this._control;
    e.onPointerEnter$.subscribeEvent((t8) => {
      this._injector.get(gt).interceptor.fetchThroughInterceptors(Bc4)(false, { x: t8.offsetX, y: t8.offsetY, skeleton: this._skeleton, scene: this._scene }) && e.setCursor(v1.CROSSHAIR);
    }), e.onPointerLeave$.subscribeEvent(() => {
      e.resetCursor();
    }), e.onPointerDown$.subscribeEvent(this._autoFillForPointerdown.bind(this));
  }
  // eslint-disable-next-line complexity
  _autoFillMoving(e, t8) {
    var T, P2, H3;
    const n = this._scene, i = n.getViewportScrollXY(this._activeViewport), { scaleX: o, scaleY: s } = n.getAncestorScale(), l = this._skeleton.getCellIndexByOffset(
      e,
      t8,
      o,
      s,
      i
    ), { row: a, column: c } = l, d = n.getCoordRelativeToViewport(U.FromArray([e, t8])), u = this._skeleton.getRowCount() - 1, h = this._skeleton.getColumnCount() - 1;
    let g = this._relativeSelectionPositionRow, m2 = this._relativeSelectionPositionColumn, f2 = this._relativeSelectionPositionRow + this._relativeSelectionRowLength, v2 = this._relativeSelectionPositionColumn + this._relativeSelectionColumnLength, p = false, S = true;
    if ((c < m2 || c > v2) && a >= g && a <= f2) {
      const A = this._fillRuler(
        c,
        m2,
        v2,
        this._relativeSelectionColumnLength,
        h
      );
      m2 = A.startRowOrColumn, v2 = A.endRowOrColumn, p = A.isLighten, S = false;
    } else if ((a < g || a > f2) && c >= m2 && c <= v2) {
      const A = this._fillRuler(a, g, f2, this._relativeSelectionRowLength, u);
      g = A.startRowOrColumn, f2 = A.endRowOrColumn, p = A.isLighten;
    } else if (Math.abs(this._startOffsetX - d.x - i.x) / 2 > Math.abs(this._startOffsetY - d.y - i.y)) {
      const A = this._fillRuler(
        c,
        m2,
        v2,
        this._relativeSelectionColumnLength,
        h
      );
      m2 = A.startRowOrColumn, v2 = A.endRowOrColumn, p = A.isLighten, S = false;
    } else {
      const A = this._fillRuler(a, g, f2, this._relativeSelectionRowLength, u);
      g = A.startRowOrColumn, f2 = A.endRowOrColumn, p = A.isLighten;
    }
    const w = this._skeleton.getNoMergeCellWithCoordByIndex(g, m2), C = this._skeleton.getNoMergeCellWithCoordByIndex(f2, v2), I2 = (w == null ? void 0 : w.startY) || 0, R = (C == null ? void 0 : C.endY) || 0, y = (w == null ? void 0 : w.startX) || 0, M7 = (C == null ? void 0 : C.endX) || 0;
    p ? this._controlHandler((A, x7) => {
      const V2 = new bt(this._fillControlColors[x7]).lighten(PC).toRgbString();
      A.setProps({
        fill: V2
      });
    }) : this._controlHandler((A, x7) => {
      A.setProps({
        fill: this._fillControlColors[x7]
      });
    });
    const E = wh / this._getScale();
    g === f2 && S === true || m2 === v2 && S === false ? (T = this._helperSelection) == null || T.hide() : ((P2 = this._helperSelection) == null || P2.transformByState({
      left: y - E / 2,
      top: I2 - E / 2,
      width: M7 - y,
      height: R - I2
    }), (H3 = this._helperSelection) == null || H3.show()), this._targetSelection = {
      startY: I2,
      endY: R,
      startX: y,
      endX: M7,
      startRow: g,
      endRow: f2,
      startColumn: m2,
      endColumn: v2
    }, this._control.selectionFilling$.next(this._targetSelection);
  }
  // eslint-disable-next-line max-lines-per-function
  _autoFillForPointerdown(e) {
    const { offsetX: t8, offsetY: n } = e, i = this._scene, o = i.getCoordRelativeToViewport(U.FromArray([t8, n])), { x: s, y: l } = o;
    this._startOffsetX = s, this._startOffsetY = l;
    const {
      startRow: a,
      startColumn: c,
      endRow: d,
      endColumn: u
    } = this._control.model;
    this._isInMergeState = this._hasMergeInRange(a, c, d, u), this._relativeSelectionPositionRow = a, this._relativeSelectionPositionColumn = c, this._relativeSelectionRowLength = d - a, this._relativeSelectionColumnLength = u - c;
    const h = this._control.currentStyle;
    let g = h == null ? void 0 : h.stroke, m2 = h == null ? void 0 : h.strokeWidth;
    const f2 = Sr2(this._themeService);
    g == null && (g = f2.stroke), m2 == null && (m2 = f2.strokeWidth);
    const v2 = this._getScale();
    m2 /= v2;
    const p = wh / v2, S = new bt(g).darken(2).toRgbString();
    this.isHelperSelection && (this._helperSelection = new I12(Fu3, {
      stroke: S,
      strokeWidth: m2 + p / 2
    }), i.addObject(this._helperSelection)), this._activeViewport = i.getActiveViewportByCoord(U.FromArray([t8, n]));
    const w = i.getViewport(k2.VIEW_MAIN), C = y0.create(
      i,
      this._activeViewport.viewportKey === k2.VIEW_MAIN ? bE.ALL : bE.NONE
    );
    C.startScroll(s, l, w), this._scrollTimer = C, i.disableObjectsEvent(), this._controlHandler((I2) => {
      this._fillControlColors.push(I2.fill);
    }), this._scenePointerMoveSub = i.onPointerMove$.subscribeEvent((I2) => {
      var A;
      const { offsetX: R, offsetY: y } = I2, M7 = i.getActiveViewportByCoord(U.FromArray([R, y]));
      if (!this._injector.get(gt).interceptor.fetchThroughInterceptors(Bc4)(false, { x: e.offsetX, y: e.offsetY, skeleton: this._skeleton, scene: this._scene }))
        return;
      const { x: T, y: P2 } = i.getCoordRelativeToViewport(
        U.FromArray([R, y])
      );
      this._autoFillMoving(T, P2), i.setCursor(v1.CROSSHAIR);
      const H3 = this._targetSelection;
      if (w && M7 && ((A = this._activeViewport) == null ? void 0 : A.viewportKey) !== (M7 == null ? void 0 : M7.viewportKey)) {
        let x7;
        H3.startRow !== a ? (C.scrollTimerType = bE.Y, x7 = {
          ...H3,
          endRow: H3.startRow
        }) : H3.endRow !== d ? (C.scrollTimerType = bE.Y, x7 = {
          ...H3,
          startRow: H3.endRow
        }) : H3.startColumn !== c ? (C.scrollTimerType = bE.X, x7 = {
          ...H3,
          endColumn: H3.startColumn
        }) : (C.scrollTimerType = bE.X, x7 = {
          ...H3,
          startColumn: H3.endColumn
        }), this._isSelectionInViewport(x7, M7) && (this._viewportMainScrollBarNeedResetPosition(C.scrollTimerType, this._activeViewport.viewportKey, M7.viewportKey) && w.scrollToBarPos({
          x: C.scrollTimerType === bE.X ? 0 : void 0,
          y: C.scrollTimerType === bE.Y ? 0 : void 0
        }), this._activeViewport = M7);
      }
      C.scrolling(T, P2, () => {
        this._autoFillMoving(T, P2);
      });
    }), this._scenePointerUpSub = i.onPointerUp$.subscribeEvent(() => {
      var R, y;
      (R = this._helperSelection) == null || R.dispose();
      const I2 = this._scene;
      I2.resetCursor(), this._clearObserverEvent(), I2.enableObjectsEvent(), (y = this._scrollTimer) == null || y.dispose(), this._control.refreshSelectionFilled(this._targetSelection), this._isInMergeState = false, this._controlHandler((M7, E) => {
        M7.setProps({
          fill: this._fillControlColors[E]
        });
      }), this._fillControlColors = [];
    });
  }
  _viewportMainScrollBarNeedResetPosition(e, t8, n) {
    return e === bE.X && (t8 === k2.VIEW_MAIN_LEFT || t8 === k2.VIEW_MAIN_LEFT_TOP) && (n === k2.VIEW_MAIN || n === k2.VIEW_MAIN_TOP) || e === bE.Y && (t8 === k2.VIEW_MAIN_TOP || t8 === k2.VIEW_MAIN_LEFT_TOP) && (n === k2.VIEW_MAIN || n === k2.VIEW_MAIN_LEFT);
  }
  _hasMergeInRange(e, t8, n, i) {
    return this._skeleton.worksheet.getMergedCellRange(e, t8, n, i).length > 0;
  }
  /**
   * Make sure startRow < endRow and startColumn < endColumn
   *
   * @param startRow
   * @param startColumn
   * @param endRow
   * @param endColumn
   * @returns {IRange} range
   */
  _swapPositions(e, t8, n, i) {
    const o = Math.min(e, n), s = Math.min(t8, i), l = Math.max(e, n), a = Math.max(t8, i);
    return {
      startRow: o,
      startColumn: s,
      endRow: l,
      endColumn: a
    };
  }
  _controlHandler(e) {
    const {
      leftControl: t8,
      rightControl: n,
      topControl: i,
      bottomControl: o,
      backgroundControlTop: s,
      backgroundControlMiddleLeft: l,
      backgroundControlMiddleRight: a,
      backgroundControlBottom: c,
      fillControl: d
    } = this._control, u = [
      t8,
      n,
      i,
      o,
      s,
      l,
      a,
      c,
      d
    ];
    for (let h = 0, g = u.length; h < g; h++) {
      const m2 = u[h];
      e(m2, h);
    }
  }
  _fillRuler(e, t8, n, i, o) {
    let s = false;
    if (e < t8)
      if (this._isInMergeState && e < t8) {
        const l = t8 - e, a = i + 1, c = Math.ceil(l / a);
        let d = t8 - c * a;
        d < 0 && (d = t8 - (c - 1) * a), t8 = d;
      } else
        t8 = e;
    else if (e >= t8 && e <= n)
      s = true, this._isInMergeState || (n = e);
    else if (this._isInMergeState && e > n) {
      const l = e - n, a = i + 1, c = Math.ceil(l / a);
      let d = n + c * a;
      d > o && (d = n + (c - 1) * a), n = d;
    } else
      n = e;
    return {
      rowOrColumn: e,
      startRowOrColumn: t8,
      endRowOrColumn: n,
      isLighten: s
    };
  }
  _getScale() {
    const { scaleX: e, scaleY: t8 } = this._scene.getAncestorScale();
    return Math.max(e, t8);
  }
};
var Fc2 = ((r) => (r.Selection = "__SpreadsheetSelectionShape__", r.top = "__SpreadsheetSelectionTopControl__", r.bottom = "__SpreadsheetSelectionBottomControl__", r.left = "__SpreadsheetSelectionShapeLeftControl__", r.right = "__SpreadsheetSelectionShapeRightControl__", r.backgroundTop = "__SpreadsheetSelectionBackgroundControlTop__", r.backgroundMiddleLeft = "__SpreadsheetSelectionBackgroundControlMiddleLeft__", r.backgroundMiddleRight = "__SpreadsheetSelectionBackgroundControlMiddleRight__", r.backgroundBottom = "__SpreadsheetSelectionBackgroundControlBottom__", r.fill = "__SpreadsheetSelectionFillControl__", r.fillTopLeft = "__SpreadsheetSelectionFillControlTopLeft__", r.fillBottomRight = "__SpreadsheetSelectionFillControlBottomRight__", r.fillTopLeftInner = "__SpreadsheetSelectionFillControlTopLeftInner__", r.fillBottomRightInner = "__SpreadsheetSelectionFillControlBottomRightInner__", r.lineMain = "__SpreadsheetDragLineMainControl__", r.lineContent = "__SpreadsheetDragLineContentControl__", r.line = "__SpreadsheetDragLineControl__", r.dash = "__SpreadsheetDragDashControl__", r.rowHeaderBackground = "__SpreadSheetSelectionRowHeaderBackground__", r.rowHeaderBorder = "__SpreadSheetSelectionRowHeaderBorder__", r.rowHeaderGroup = "__SpreadSheetSelectionRowHeaderGroup__", r.columnHeaderBackground = "__SpreadSheetSelectionColumnHeaderBackground__", r.columnHeaderBorder = "__SpreadSheetSelectionColumnHeaderBorder__", r.columnHeaderGroup = "__SpreadSheetSelectionColumnHeaderGroup__", r.topLeftWidget = "__SpreadSheetSelectionTopLeftWidget__", r.topCenterWidget = "__SpreadSheetSelectionTopCenterWidget__", r.topRightWidget = "__SpreadSheetSelectionTopRightWidget__", r.middleLeftWidget = "__SpreadSheetSelectionMiddleLeftWidget__", r.middleRightWidget = "__SpreadSheetSelectionMiddleRightWidget__", r.bottomLeftWidget = "__SpreadSheetSelectionBottomLeftWidget__", r.bottomCenterWidget = "__SpreadSheetSelectionBottomCenterWidget__", r.bottomRightWidget = "__SpreadSheetSelectionBottomRightWidget__", r))(Fc2 || {});
var Uu2 = 0.3;
var Wd2 = class extends Ve {
  constructor(t8, n, i, o) {
    var s, l, a, c;
    super();
    _2(this, "_isHelperSelection", true);
    _2(this, "_enableAutoFill", true);
    _2(this, "_showAutoFill", false);
    _2(this, "_highlightHeader", true);
    _2(this, "_selectionRenderModel");
    _2(this, "_leftBorder");
    _2(this, "_rightBorder");
    _2(this, "_topBorder");
    _2(this, "_bottomBorder");
    _2(this, "_backgroundControlTop");
    _2(this, "_backgroundControlBottom");
    _2(this, "_backgroundControlMiddleLeft");
    _2(this, "_backgroundControlMiddleRight");
    _2(this, "_autoFillControl");
    _2(this, "_selectionShapeGroup");
    _2(this, "_rowHeaderBackground");
    _2(this, "_rowHeaderBorder");
    _2(this, "_rowHeaderGroup");
    _2(this, "_columnHeaderBackground");
    _2(this, "_columnHeaderBorder");
    _2(this, "_columnHeaderGroup");
    _2(this, "_dashedRect");
    _2(this, "_topLeftWidget");
    _2(this, "_topCenterWidget");
    _2(this, "_topRightWidget");
    _2(this, "_middleLeftWidget");
    _2(this, "_middleRightWidget");
    _2(this, "_bottomLeftWidget");
    _2(this, "_bottomCenterWidget");
    _2(this, "_bottomRightWidget");
    _2(this, "_defaultStyle");
    _2(this, "_currentStyle");
    _2(this, "_rowHeaderWidth", 0);
    _2(this, "_columnHeaderHeight", 0);
    _2(this, "_widgetRects", []);
    _2(this, "_controlExtension");
    _2(this, "_dispose$", new BehaviorSubject(this));
    _2(this, "dispose$", this._dispose$.asObservable());
    _2(this, "selectionMoving$", new Subject());
    _2(this, "selectionMoveEnd$", new Subject());
    _2(this, "selectionScaling$", new Subject());
    _2(this, "selectionScaled$", new Subject());
    _2(this, "selectionFilling$", new Subject());
    _2(this, "_selectionFilled$", new Subject());
    _2(this, "selectionFilled$", this._selectionFilled$.asObservable());
    _2(this, "_antLineOffset", 0);
    _2(this, "_antRequestNewFrame", -1);
    this._scene = t8, this._zIndex = n, this._themeService = i, this._enableAutoFill = (s = o == null ? void 0 : o.enableAutoFill) != null ? s : true, this._highlightHeader = (l = o == null ? void 0 : o.highlightHeader) != null ? l : true, this._rowHeaderWidth = (a = o == null ? void 0 : o.rowHeaderWidth) != null ? a : 0, this._columnHeaderHeight = (c = o == null ? void 0 : o.columnHeaderHeight) != null ? c : 0, this._initializeSheetBody(), this._initialHeader();
  }
  _initializeSheetBody() {
    this._defaultStyle = Sr2(this._themeService), this._currentStyle = Sr2(this._themeService), this._selectionRenderModel = new TC();
    const t8 = this._zIndex;
    this._leftBorder = new I12("__SpreadsheetSelectionShapeLeftControl__" + t8, {
      zIndex: t8
    }), this._rightBorder = new I12("__SpreadsheetSelectionShapeRightControl__" + t8, {
      zIndex: t8
    }), this._topBorder = new I12("__SpreadsheetSelectionTopControl__" + t8, {
      zIndex: t8
    }), this._bottomBorder = new I12("__SpreadsheetSelectionBottomControl__" + t8, {
      zIndex: t8
    }), this._backgroundControlTop = new I12("__SpreadsheetSelectionBackgroundControlTop__" + t8, {
      zIndex: t8 - 1,
      evented: false
    }), this._backgroundControlBottom = new I12("__SpreadsheetSelectionBackgroundControlBottom__" + t8, {
      zIndex: t8 - 1,
      evented: false
    }), this._backgroundControlMiddleLeft = new I12("__SpreadsheetSelectionBackgroundControlMiddleLeft__" + t8, {
      zIndex: t8 - 1,
      evented: false
    }), this._backgroundControlMiddleRight = new I12("__SpreadsheetSelectionBackgroundControlMiddleRight__" + t8, {
      zIndex: t8 - 1,
      evented: false
    }), this._autoFillControl = new I12("__SpreadsheetSelectionFillControl__" + t8, {
      zIndex: t8 + 1
    }), this._autoFillControl.hide(), this._dashedRect = new _8("__SpreadsheetDragDashControl__" + t8, {
      zIndex: t8 + 2,
      evented: false,
      stroke: "#fff"
    });
    const n = [
      this._autoFillControl,
      this._leftBorder,
      this._rightBorder,
      this._topBorder,
      this._bottomBorder,
      this._backgroundControlTop,
      this._backgroundControlMiddleLeft,
      this._backgroundControlMiddleRight,
      this._backgroundControlBottom,
      this._dashedRect
    ];
    this._widgetRects = this._initialWidget(), this._selectionShapeGroup = new s7("__SpreadsheetSelectionShape__" + t8, ...n, ...this._widgetRects), this._selectionShapeGroup.hide(), this._selectionShapeGroup.evented = false, this._selectionShapeGroup.zIndex = t8;
    const i = this.getScene();
    i.addObject(this._selectionShapeGroup, Qs2), this.disposeWithMe(
      We(
        i.onTransformChange$.subscribeEvent((o) => {
          o.type === x1.scale && (this._updateLayoutOfSelectionControl(this._currentStyle), this._updateControlCoord());
        })
      )
    );
  }
  _initialHeader() {
    const t8 = this._zIndex;
    this._rowHeaderBackground = new I12("__SpreadSheetSelectionRowHeaderBackground__" + t8, {
      zIndex: t8 - 1,
      evented: false
    }), this._rowHeaderBorder = new I12("__SpreadSheetSelectionRowHeaderBorder__" + t8, {
      zIndex: t8 - 1,
      evented: false
    }), this._rowHeaderGroup = new s7(
      "__SpreadSheetSelectionRowHeaderGroup__" + t8,
      this._rowHeaderBackground,
      this._rowHeaderBorder
    ), this._rowHeaderGroup.hide(), this._rowHeaderGroup.evented = false, this._rowHeaderGroup.zIndex = t8, this._columnHeaderBackground = new I12("__SpreadSheetSelectionColumnHeaderBackground__" + t8, {
      zIndex: t8 - 1,
      evented: false
    }), this._columnHeaderBorder = new I12("__SpreadSheetSelectionColumnHeaderBorder__" + t8, {
      zIndex: t8 - 1,
      evented: false
    }), this._columnHeaderGroup = new s7(
      "__SpreadSheetSelectionColumnHeaderGroup__" + t8,
      this._columnHeaderBackground,
      this._columnHeaderBorder
    ), this._columnHeaderGroup.hide(), this._columnHeaderGroup.evented = false, this._columnHeaderGroup.zIndex = t8, this.getScene().addObjects([this._rowHeaderGroup, this._columnHeaderGroup], EC);
  }
  _initialWidget() {
    const t8 = this._zIndex;
    return this._topLeftWidget = new I12("__SpreadSheetSelectionTopLeftWidget__" + t8, {
      zIndex: t8 + 1
    }), this._topCenterWidget = new I12("__SpreadSheetSelectionTopCenterWidget__" + t8, {
      zIndex: t8 + 1
    }), this._topRightWidget = new I12("__SpreadSheetSelectionTopRightWidget__" + t8, {
      zIndex: t8 + 1
    }), this._middleLeftWidget = new I12("__SpreadSheetSelectionMiddleLeftWidget__" + t8, {
      zIndex: t8 + 1
    }), this._middleRightWidget = new I12("__SpreadSheetSelectionMiddleRightWidget__" + t8, {
      zIndex: t8 + 1
    }), this._bottomLeftWidget = new I12("__SpreadSheetSelectionBottomLeftWidget__" + t8, {
      zIndex: t8 + 1
    }), this._bottomCenterWidget = new I12("__SpreadSheetSelectionBottomCenterWidget__" + t8, {
      zIndex: t8 + 1
    }), this._bottomRightWidget = new I12("__SpreadSheetSelectionBottomRightWidget__" + t8, {
      zIndex: t8 + 1
    }), [
      this._topLeftWidget,
      this._topCenterWidget,
      this._topRightWidget,
      this._middleLeftWidget,
      this._middleRightWidget,
      this._bottomLeftWidget,
      this._bottomCenterWidget,
      this._bottomRightWidget
    ];
  }
  get zIndex() {
    return this._zIndex;
  }
  get leftControl() {
    return this._leftBorder;
  }
  get rightControl() {
    return this._rightBorder;
  }
  get topControl() {
    return this._topBorder;
  }
  get bottomControl() {
    return this._bottomBorder;
  }
  get fillControl() {
    return this._autoFillControl;
  }
  get backgroundControlTop() {
    return this._backgroundControlTop;
  }
  get backgroundControlBottom() {
    return this._backgroundControlBottom;
  }
  get backgroundControlMiddleLeft() {
    return this._backgroundControlMiddleLeft;
  }
  get backgroundControlMiddleRight() {
    return this._backgroundControlMiddleRight;
  }
  get selectionShape() {
    return this._selectionShapeGroup;
  }
  get columnHeaderGroup() {
    return this._columnHeaderGroup;
  }
  get rowHeaderGroup() {
    return this._rowHeaderGroup;
  }
  get selectionShapeGroup() {
    return this._selectionShapeGroup;
  }
  // That's so bad! _selectionModel is protected! But I don't want to expose it to the outside world
  get model() {
    return this._selectionRenderModel;
  }
  get topLeftWidget() {
    return this._topLeftWidget;
  }
  get topCenterWidget() {
    return this._topCenterWidget;
  }
  get topRightWidget() {
    return this._topRightWidget;
  }
  get middleLeftWidget() {
    return this._middleLeftWidget;
  }
  get middleRightWidget() {
    return this._middleRightWidget;
  }
  get bottomLeftWidget() {
    return this._bottomLeftWidget;
  }
  get bottomCenterWidget() {
    return this._bottomCenterWidget;
  }
  get bottomRightWidget() {
    return this._bottomRightWidget;
  }
  get themeService() {
    return this._themeService;
  }
  get selectionModel() {
    return this._selectionRenderModel;
  }
  set selectionModel(t8) {
    this._selectionRenderModel = t8;
  }
  // get defaultStyle(): ISelectionStyle {
  //     return this._defaultStyle;
  // }
  // set defaultStyle(style: ISelectionStyle) {
  //     this._defaultStyle = style;
  // }
  get currentStyle() {
    return this._currentStyle;
  }
  set currentStyle(t8) {
    this._currentStyle = t8;
  }
  get dashedRect() {
    return this._dashedRect;
  }
  get isHelperSelection() {
    return this._isHelperSelection;
  }
  get rowHeaderWidth() {
    return this._rowHeaderWidth;
  }
  set rowHeaderWidth(t8) {
    this._rowHeaderWidth = t8;
  }
  get columnHeaderHeight() {
    return this._columnHeaderHeight;
  }
  set columnHeaderHeight(t8) {
    this._columnHeaderHeight = t8;
  }
  setControlExtension(t8) {
    this._controlExtension = new xC(this, t8);
  }
  setControlExtensionDisable(t8) {
    this._controlExtension && this._controlExtension.setDisabled(t8);
  }
  setEvent(t8) {
    this.leftControl.evented = t8, this.rightControl.evented = t8, this.topControl.evented = t8, this.bottomControl.evented = t8;
  }
  refreshSelectionFilled(t8) {
    this._selectionFilled$.next(t8);
  }
  /**
   * Update Control Style And Position of SelectionControl
   * @param selectionStyle
   */
  _updateLayoutOfSelectionControl(t8) {
    t8 && (this.currentStyle = Object.assign({}, this._defaultStyle, t8));
    const n = this.currentStyle, {
      stroke: i,
      widgets: o,
      autofillStroke: s,
      strokeDash: l,
      isAnimationDash: a
    } = n;
    let c = n.autofillSize, d = n.strokeWidth, u = n.autofillStrokeWidth;
    const h = this._getScale(), g = (d + wh) / 2 / h;
    d /= h, c /= h, u /= h < 1 ? 1 : h;
    const m2 = wh / h, f2 = p2 / h, { startX: v2, startY: p, endX: S, endY: w } = this._selectionRenderModel;
    if (this.leftControl.transformByState({
      height: w - p,
      left: -g + f2,
      width: d,
      strokeWidth: m2,
      top: -m2 / 2 + f2
    }), this.leftControl.setProps({
      fill: i,
      stroke: Ih
    }), this.rightControl.transformByState({
      height: w - p,
      left: S - v2 - g + f2,
      width: d,
      strokeWidth: m2,
      top: -m2 / 2 + f2
    }), this.rightControl.setProps({
      fill: i,
      stroke: Ih
    }), this.topControl.transformByState({
      width: S - v2 + d,
      top: -g + f2,
      left: -g + f2,
      height: d,
      strokeWidth: m2
    }), this.topControl.setProps({
      fill: i,
      stroke: Ih
    }), this.bottomControl.transformByState({
      width: S - v2 + d,
      top: w - p - g + f2,
      height: d,
      left: -g + f2,
      strokeWidth: m2
    }), this.bottomControl.setProps({
      fill: i,
      stroke: Ih
    }), l == null)
      this.dashedRect.hide(), this._stopAntLineAnimation();
    else {
      const C = n.strokeWidth * 2 / h;
      this.dashedRect.transformByState({
        height: w - p,
        width: S - v2,
        strokeWidth: C,
        left: -C / 2 + f2,
        top: -C / 2 + f2
      }), this.dashedRect.setProps({
        strokeDashArray: [0, l / h]
      }), this._stopAntLineAnimation(), a !== false && this._startAntLineAnimation(), this.dashedRect.show();
    }
    if (this._showAutoFill = this._showAutoFill && this._enableAutoFill, this._showAutoFill && !this._hasWidgets(o)) {
      const C = {
        fill: i,
        stroke: s,
        strokeScaleEnabled: false
      }, I2 = {
        width: c - u,
        height: c - u,
        left: S - v2 - c / 2 + u / 2 - f2,
        top: w - p - c / 2 + u / 2 - f2,
        strokeWidth: u
      };
      this._autoFillControl.setProps(C), this._autoFillControl.transformByState(I2), this._autoFillControl.show();
    } else
      this._autoFillControl.hide();
    this._updateBackgroundControl(n), this._updateHeaderBackground(n), this._updateWidgets(n);
  }
  /**
   * update selection control coordination by curr selection model
   */
  _updateControlCoord() {
    const { startX: t8, startY: n } = this._selectionRenderModel;
    this.selectionShapeGroup.show(), this.selectionShapeGroup.translate(t8, n), this.selectionShapeGroup.makeDirtyNoDebounce(true);
  }
  updateStyle(t8) {
    this._updateLayoutOfSelectionControl(t8), this._updateControlCoord();
  }
  /**
   * Update range and primary range.
   *
   * highlight cell would update if primaryWithCoord has value.
   * highlight cell would be cleared if primaryWithCoord is null.
   * highlight would keep prev value if primaryWithCoord is undefined.
   * @param rangeWithCoord
   * @param primaryWithCoord
   */
  updateRange(t8, n) {
    this._selectionRenderModel.setValue(t8, n), this._showAutoFill = n !== null, this._updateLayoutOfSelectionControl(), this._updateControlCoord();
  }
  /**
   * Update range and primary range and style.
   * @param selectionWthCoord
   */
  updateRangeBySelectionWithCoord(t8, n) {
    n && (this._rowHeaderWidth = n.rowHeaderWidth, this._columnHeaderHeight = n.columnHeaderHeight), this._selectionRenderModel.setValue(t8.rangeWithCoord, t8.primaryWithCoord), this._showAutoFill = t8.primaryWithCoord !== null, this._updateLayoutOfSelectionControl(t8.style), this._updateControlCoord();
  }
  /**
   * Update selection model with new range & primary cell(aka: highlight/current), also update row/col selection size & style.
   *
   * @deprecated  use `updateRangeBySelectionWithCoord` and `updateStyle` to do same thing.
   *
   * @param newSelectionRange
   * @param rowHeaderWidth
   * @param columnHeaderHeight
   * @param style
   * @param primaryCell primary cell
   */
  update(t8, n = 0, i = 0, o, s) {
    this._rowHeaderWidth = n, this._columnHeaderHeight = i, this.updateRangeBySelectionWithCoord({
      rangeWithCoord: t8,
      primaryWithCoord: s,
      style: o
    }), o && this.updateStyle(o);
  }
  /**
   * Update primary range.
   * highlight cell would update if primary cell has value.
   * highlight cell would be cleared if primary cell is null.
   * highlight would keep prev value if primary cell is undefined.
   *
   * @param primaryCell model.current (aka: highlight)
   */
  // @TODO lumixraku there are 3 concepts for same thing, primary and current and highlight
  // highlight is best. primary sometimes means the actual cell(actual means ignore merge)
  updateCurrCell(t8) {
    this._showAutoFill = t8 !== null, this._selectionRenderModel.setCurrentCell(t8);
  }
  clearHighlight() {
    this._showAutoFill = false, this._selectionRenderModel.clearCurrentCell(), this._updateLayoutOfSelectionControl(this._currentStyle);
  }
  getScene() {
    return this._scene;
  }
  // eslint-disable-next-line complexity
  dispose() {
    var t8, n, i, o, s, l, a, c, d, u, h, g, m2, f2, v2, p, S, w, C, I2, R, y, M7, E, T;
    (t8 = this._leftBorder) == null || t8.dispose(), (n = this._rightBorder) == null || n.dispose(), (i = this._topBorder) == null || i.dispose(), (o = this._bottomBorder) == null || o.dispose(), (s = this._backgroundControlTop) == null || s.dispose(), (l = this._backgroundControlMiddleLeft) == null || l.dispose(), (a = this._backgroundControlMiddleRight) == null || a.dispose(), (c = this._backgroundControlBottom) == null || c.dispose(), this._autoFillControl.dispose(), (d = this._selectionShapeGroup) == null || d.dispose(), (u = this._rowHeaderBackground) == null || u.dispose(), (h = this._rowHeaderBorder) == null || h.dispose(), (g = this._rowHeaderGroup) == null || g.dispose(), (m2 = this._rowHeaderBackground) == null || m2.dispose(), (f2 = this._columnHeaderBackground) == null || f2.dispose(), (v2 = this._columnHeaderBorder) == null || v2.dispose(), (p = this._columnHeaderGroup) == null || p.dispose(), (S = this._topLeftWidget) == null || S.dispose(), (w = this._topCenterWidget) == null || w.dispose(), (C = this._topRightWidget) == null || C.dispose(), (I2 = this._middleLeftWidget) == null || I2.dispose(), (R = this._middleRightWidget) == null || R.dispose(), (y = this._bottomLeftWidget) == null || y.dispose(), (M7 = this._bottomCenterWidget) == null || M7.dispose(), (E = this._bottomRightWidget) == null || E.dispose(), (T = this._controlExtension) == null || T.dispose(), super.dispose(), this._dispose$.next(this), this._dispose$.complete();
  }
  /**
   * Get the cell information of the current selection, considering the case of merging cells
   */
  getCurrentCellInfo() {
    const t8 = this.model.currentCell;
    if (t8) {
      let n;
      if (t8.isMerged) {
        const i = t8.mergeInfo;
        n = {
          startRow: i.startRow,
          endRow: i.endRow,
          startColumn: i.startColumn,
          endColumn: i.endColumn,
          startX: i.startX,
          endX: i.endX,
          startY: i.startY,
          endY: i.endY
        };
      } else {
        const { actualRow: i, actualColumn: o, startX: s, endX: l, startY: a, endY: c } = t8;
        n = {
          startRow: i,
          endRow: i,
          startColumn: o,
          endColumn: o,
          startX: s,
          endX: l,
          startY: a,
          endY: c
        };
      }
      return n;
    }
  }
  getValue() {
    return {
      ...this._selectionRenderModel.getValue(),
      style: this._currentStyle
    };
  }
  getRange() {
    return this._selectionRenderModel.getValue().rangeWithCoord;
  }
  enableHelperSelection() {
    this._isHelperSelection = true;
  }
  disableHelperSelection() {
    this._isHelperSelection = false;
  }
  _updateHeaderBackground(t8) {
    const { startX: n, startY: i, endX: o, endY: s, rangeType: l } = this._selectionRenderModel, a = this._currentStyle, c = this._getScale(), {
      stroke: d,
      rowHeaderFill: u = a.rowHeaderFill,
      rowHeaderStroke: h = a.rowHeaderStroke,
      columnHeaderFill: g = a.columnHeaderFill,
      columnHeaderStroke: m2 = a.columnHeaderStroke
    } = t8;
    let {
      rowHeaderStrokeWidth: f2 = a.rowHeaderStrokeWidth,
      columnHeaderStrokeWidth: v2 = a.columnHeaderStrokeWidth
    } = t8;
    f2 /= c, v2 /= c;
    const p = this._rowHeaderWidth, S = this._columnHeaderHeight;
    if (this._highlightHeader && S > 0) {
      let w = g;
      l === ge.COLUMN && (w = new bt(d).setAlpha(Uu2).toString()), this._columnHeaderBackground.setProps({
        fill: w
      }), this._columnHeaderBackground.resize(o - n, S), this._columnHeaderBorder.setProps({
        fill: m2
      }), this._columnHeaderBorder.transformByState({
        width: o - n,
        height: v2,
        top: S - v2 + 1 / c
        // + 1 / scale: Avoid appearing thicker due to the adjacency of the first row cells.
      }), this._columnHeaderGroup.show(), this._columnHeaderGroup.translate(n, 0);
    } else
      this._columnHeaderGroup.hide();
    if (this._columnHeaderGroup.makeDirty(true), this._highlightHeader && p > 0) {
      let w = u;
      l === ge.ROW && (w = new bt(d).setAlpha(Uu2).toString()), this._rowHeaderBackground.setProps({
        fill: w
      }), this._rowHeaderBackground.resize(p, s - i), this._rowHeaderBorder.setProps({
        fill: h
      }), this._rowHeaderBorder.transformByState({
        width: f2,
        height: s - i,
        left: p - f2 + 1 / c
      }), this._rowHeaderGroup.show(), this._rowHeaderGroup.translate(0, i);
    } else
      this._rowHeaderGroup.hide();
    this._rowHeaderGroup.makeDirty(true);
  }
  _updateBackgroundControl(t8) {
    const { startX: n, startY: i, endX: o, endY: s } = this._selectionRenderModel, l = this._getScale(), { fill: a = t8.fill } = t8;
    let { strokeWidth: c } = t8;
    c /= l;
    const d = this._selectionRenderModel.highlightToSelection();
    if (!d) {
      this._backgroundControlTop.resize(o - n, s - i), this._backgroundControlTop.setProps({ fill: a }), this._backgroundControlBottom.resize(0, 0), this._backgroundControlMiddleLeft.resize(0, 0), this._backgroundControlMiddleRight.resize(0, 0);
      return;
    }
    const { startX: u, startY: h, endX: g, endY: m2 } = d, f2 = c / 2, v2 = {
      left: -f2,
      top: -f2,
      width: o - n + f2 * 2,
      height: h - i + f2
    };
    v2.height < 0 && (v2.width = 0, v2.height = 0), this._backgroundControlTop.transformByState(v2);
    const p = {
      left: -f2,
      top: h - i,
      width: u - n + f2,
      height: m2 - h
    };
    p.width < 0 && (p.width = 0, p.height = 0), this._backgroundControlMiddleLeft.transformByState(p);
    const S = {
      left: g - n - f2,
      top: h - i,
      width: o - g + f2 * 2,
      height: m2 - h
    };
    S.width < 0 && (S.width = 0, S.height = 0), this._backgroundControlMiddleRight.transformByState(S);
    const w = {
      left: -f2,
      top: m2 - i,
      width: o - n + f2 * 2,
      height: s - m2 + f2
    };
    w.height < 0 && (w.width = 0, w.height = 0), this._backgroundControlBottom.transformByState(w), this._backgroundControlTop.setProps({ fill: a }), this._backgroundControlMiddleLeft.setProps({ fill: a }), this._backgroundControlMiddleRight.setProps({ fill: a }), this._backgroundControlBottom.setProps({ fill: a });
  }
  _updateWidgets(t8) {
    const { startX: n, startY: i, endX: o, endY: s } = this._selectionRenderModel, { stroke: l = t8.stroke, widgets: a = t8.widgets, widgetStroke: c = t8.widgetStroke } = t8, d = this._getScale();
    let { widgetSize: u, widgetStrokeWidth: h } = t8;
    u /= d, h /= d;
    const g = { left: -u / 2 + h / 2, center: (o - n) / 2 - u / 2 + h / 2, right: o - n - u / 2 + h / 2, top: -u / 2, middle: (s - i) / 2 - u / 2, bottom: s - i - u / 2 + h / 2 }, m2 = u - h;
    this._widgetRects.forEach((f2) => {
      f2.setProps({ fill: l, stroke: c });
    }), a.tl === true ? (this._topLeftWidget.transformByState({ height: m2, width: m2, left: g.left, top: g.top, strokeWidth: h }), this._topLeftWidget.show()) : this._topLeftWidget.hide(), a.tc === true ? (this._topCenterWidget.transformByState({ height: m2, width: m2, left: g.center, top: g.top, strokeWidth: h }), this._topCenterWidget.show()) : this._topCenterWidget.hide(), a.tr === true ? (this._topRightWidget.transformByState({ height: m2, width: m2, left: g.right, top: g.top, strokeWidth: h }), this._topRightWidget.show()) : this._topRightWidget.hide(), a.ml === true ? (this._middleLeftWidget.transformByState({ height: m2, width: m2, left: g.left, top: g.middle, strokeWidth: h }), this._middleLeftWidget.show()) : this._middleLeftWidget.hide(), a.mr === true ? (this._middleRightWidget.transformByState({ height: m2, width: m2, left: g.right, top: g.middle, strokeWidth: h }), this._middleRightWidget.show()) : this._middleRightWidget.hide(), a.bl === true ? (this._bottomLeftWidget.transformByState({ height: m2, width: m2, left: g.left, top: g.bottom, strokeWidth: h }), this._bottomLeftWidget.show()) : this._bottomLeftWidget.hide(), a.bc === true ? (this._bottomCenterWidget.transformByState({ height: m2, width: m2, left: g.center, top: g.bottom, strokeWidth: h }), this._bottomCenterWidget.show()) : this._bottomCenterWidget.hide(), a.br === true ? (this._bottomRightWidget.transformByState({ height: m2, width: m2, left: g.right, top: g.bottom, strokeWidth: h }), this._bottomRightWidget.show()) : this._bottomRightWidget.hide();
  }
  _hasWidgets(t8) {
    if (t8 == null)
      return false;
    const n = Object.keys(t8);
    if (n.length === 0)
      return false;
    for (const i of n)
      if (t8[i] === true)
        return true;
    return false;
  }
  _getScale() {
    const { scaleX: t8, scaleY: n } = this._scene.getAncestorScale();
    return Math.max(t8, n);
  }
  _stopAntLineAnimation() {
    this._antLineOffset = 0, Cv(this._antRequestNewFrame);
  }
  _startAntLineAnimation() {
    const t8 = this._getScale();
    this._antLineOffset += 0.6 / t8, this._antLineOffset > 160 / t8 && (this._antLineOffset = 0), this.dashedRect.setProps({
      strokeDashOffset: -this._antLineOffset
    }), this._antRequestNewFrame = a0(() => {
      this._startAntLineAnimation();
    });
  }
};
var OC = class extends j8 {
  render(e, t8 = false) {
    const n = J.now();
    return super.render(e, t8), this._afterRender(n), this;
  }
  _afterRender(e) {
    this.scene.getEngine().renderFrameTimeMetric$.next(["selectionLayer", J.now() - e]);
  }
};
var gt = createIdentifier("univer.sheet.selection-render-service");
var mm = class extends Ve {
  constructor(t8, n, i, o, s) {
    super();
    _2(this, "_downObserver");
    _2(this, "_scenePointerMoveSub");
    _2(this, "_scenePointerUpSub");
    _2(this, "_controlFillConfig$", new BehaviorSubject(null));
    _2(this, "controlFillConfig$", this._controlFillConfig$.asObservable());
    _2(this, "_selectionControls", []);
    _2(this, "_startRangeWhenPointerDown", {
      startY: 0,
      endY: 0,
      startX: 0,
      endX: 0,
      startRow: -1,
      endRow: -1,
      startColumn: -1,
      endColumn: -1
    });
    _2(this, "_activeControlIndex", -1);
    _2(this, "_startViewportPosX", 0);
    _2(this, "_startViewportPosY", 0);
    _2(this, "_scrollTimer");
    _2(this, "_cancelDownSubscription");
    _2(this, "_cancelUpSubscription");
    _2(this, "_skeleton");
    _2(this, "_scene");
    _2(this, "_highlightHeader", true);
    _2(this, "_rangeType", ge.NORMAL);
    _2(this, "_selectionStyle");
    _2(this, "_remainLastEnabled", false);
    _2(this, "_skipLastEnabled", false);
    _2(this, "_singleSelectionEnabled", false);
    _2(this, "_selectionMoveEnd$", new BehaviorSubject([]));
    _2(this, "selectionMoveEnd$", this._selectionMoveEnd$.asObservable());
    _2(this, "_selectionMoving$", new Subject());
    _2(this, "selectionMoving$", this._selectionMoving$.asObservable());
    _2(this, "_selectionMoveStart$", new Subject());
    _2(this, "selectionMoveStart$", this._selectionMoveStart$.asObservable());
    _2(this, "_selectionMoving", false);
    _2(this, "_selectionTheme");
    _2(this, "_activeViewport");
    _2(this, "interceptor", new ZC({ RANGE_MOVE_PERMISSION_CHECK: Wc2, RANGE_FILL_PERMISSION_CHECK: Bc4 }));
    _2(this, "_escapeShortcutDisposable", null);
    this._injector = t8, this._themeService = n, this._shortcutService = i, this._sheetSkeletonManagerService = o, this.contextService = s, this._initSelectionThemeFromThemeService(), this._initMoving();
  }
  get selectionMoving() {
    return this._selectionMoving;
  }
  /**
   * If true, the selector will respond to the range of merged cells and automatically extend the selected range. If false, it will ignore the merged cells.
   */
  get _shouldDetectMergedCells() {
    return this._rangeType === ge.NORMAL;
  }
  _initMoving() {
    this.disposeWithMe(this._selectionMoving$.subscribe(() => {
      this._selectionMoving = true;
    })), this.disposeWithMe(this._selectionMoveEnd$.subscribe(() => {
      this._selectionMoving = false;
    }));
  }
  _setSelectionStyle(t8) {
    this._selectionStyle = t8;
  }
  /**
   * Reset this._selectionStyle to default normal selection style
   */
  // protected _resetSelectionStyle(): void {
  //     this._setSelectionStyle(genNormalSelectionStyle(this._themeService));
  // }
  /** @deprecated This should not be provided by the selection render service. */
  getViewPort() {
    return this._activeViewport;
  }
  setSingleSelectionEnabled(t8 = false) {
    this._singleSelectionEnabled = t8;
  }
  newSelectionControl(t8, n, i) {
    const o = this.getSelectionControls().length, { rowHeaderWidth: s, columnHeaderHeight: l } = n, a = new Wd2(t8, o, this._selectionTheme, {
      highlightHeader: this._highlightHeader,
      rowHeaderWidth: s,
      columnHeaderHeight: l
    });
    this._selectionControls.push(a);
    const c = Wt4(i, n);
    return a.updateRangeBySelectionWithCoord(c, n), a.setControlExtension({
      skeleton: n,
      scene: t8,
      themeService: this._selectionTheme,
      injector: this._injector,
      selectionHooks: {
        selectionMoveEnd: () => {
          this._selectionMoveEnd$.next(this.getSelectionDataWithStyle());
        }
      }
    }), a;
  }
  /**
   * Update the corresponding selectionControl based on selectionsData from WorkbookSelectionModel
   * selectionData[i] --> selectionControls[i]
   * @param selectionsWithStyleList {ISelectionWithStyle[]} selectionsData from WorkbookSelectionModel
   */
  resetSelectionsByModelData(t8) {
    const n = this.getSelectionControls(), i = this._skeleton;
    if (!(!n || !i)) {
      for (let o = 0, s = t8.length; o < s; o++) {
        const l = t8[o], a = Wt4(l, this._skeleton), c = n[o];
        c ? c.updateRangeBySelectionWithCoord(a, i) : this.isSelectionEnabled() && this.newSelectionControl(this._scene, i, l);
      }
      t8.length < n.length && n.splice(t8.length).forEach((s) => s.dispose());
    }
  }
  refreshSelectionMoveStart() {
    this._selectionMoveStart$.next(this.getSelectionDataWithStyle());
  }
  refreshSelectionMoveEnd() {
    this._selectionMoveEnd$.next(this.getSelectionDataWithStyle());
  }
  _initSelectionThemeFromThemeService() {
    const t8 = this._themeService.getCurrentTheme();
    this._selectionTheme = new Gi(), this._selectionTheme.setTheme(t8);
  }
  setSelectionTheme(t8) {
    this._selectionTheme.setTheme(t8);
  }
  _changeRuntime(t8, n, i) {
    this._skeleton = t8, this._scene = n, this._activeViewport = i || (n == null ? void 0 : n.getViewports()[0]), n.findLayerByZIndex(Qs2) || n.addLayer(new OC(n, [], Qs2));
  }
  getSkeleton() {
    return this._skeleton;
  }
  /**
   * Generate selectionData from this._selectionControls.model .
   * @returns {ISelectionWithCoord[]} {range, primary, style}[]
   */
  getSelectionDataWithStyle() {
    const t8 = this._selectionControls;
    if (this._skeleton.worksheet) {
      const [n, i] = this._skeleton.getLocation();
      return t8.map((o) => {
        const s = o.getValue();
        return s.rangeWithCoord.sheetId = i, s.rangeWithCoord.unitId = n, s;
      });
    }
    return [];
  }
  /**
   * @TODO lumixraku DO NOT expose private props.
   */
  getSelectionControls() {
    return this._selectionControls;
  }
  /**
   * Add a selection in spreadsheet, create a new SelectionControl and then update this control by range derives from selection.
   * @param {ISelectionWithCoord} selectionWithStyle
   */
  _addSelectionControlByModelData(t8) {
    var l;
    const n = this._skeleton, i = (l = t8.style) != null ? l : Sr2(this._selectionTheme), o = this._scene;
    return t8.style = i, this.newSelectionControl(o, n, t8);
  }
  _clearAllSelectionControls() {
    const t8 = this._selectionControls;
    for (const n of t8)
      n.dispose();
    this._selectionControls.length = 0;
  }
  _getFreeze() {
    var n;
    return (n = this._sheetSkeletonManagerService.getCurrentParam()) == null ? void 0 : n.skeleton.getWorksheetConfig().freeze;
  }
  _getViewportByCell(t8, n) {
    if (t8 === void 0 || n === void 0)
      return null;
    const i = this._getFreeze();
    if (!i || i.startRow <= 0 && i.startColumn <= 0)
      return this._scene.getViewport(k2.VIEW_MAIN);
    if (t8 > i.startRow && n > i.startColumn)
      return this._scene.getViewport(k2.VIEW_MAIN);
    if (t8 <= i.startRow && n <= i.startColumn)
      return this._scene.getViewport(k2.VIEW_MAIN_LEFT_TOP);
    if (t8 <= i.startRow && n > i.startColumn)
      return this._scene.getViewport(k2.VIEW_MAIN_TOP);
    if (t8 > i.startRow && n <= i.startColumn)
      return this._scene.getViewport(k2.VIEW_MAIN_LEFT);
  }
  /**
   * Returns the selected range in the active sheet, or null if there is no active range. If multiple ranges are selected this method returns only the last selected range.
   */
  getActiveRange() {
    const t8 = this.getSelectionControls(), n = t8 && t8[t8.length - 1].model;
    return n && {
      startRow: n.startRow,
      startColumn: n.startColumn,
      endRow: n.endRow,
      endColumn: n.endColumn
    };
  }
  setActiveSelectionIndex(t8) {
    this._activeControlIndex = t8;
  }
  resetActiveSelectionIndex() {
    this._activeControlIndex = -1;
  }
  /**
   * get active(actually last) selection control
   * @returns T extends SelectionControl
   */
  getActiveSelectionControl() {
    const t8 = this.getSelectionControls();
    if (t8)
      return this._activeControlIndex < 0 ? t8[t8.length - 1] : t8[this._activeControlIndex];
  }
  endSelection() {
    var t8;
    this._clearUpdatingListeners(), this._selectionMoveEnd$.next(this.getSelectionDataWithStyle()), (t8 = this._escapeShortcutDisposable) == null || t8.dispose(), this._escapeShortcutDisposable = null;
  }
  /**
   * Clear existed selections by workbookSelections.selectionMoveEnd$
   */
  _reset() {
    var t8;
    this._clearAllSelectionControls(), (t8 = this._downObserver) == null || t8.unsubscribe(), this._downObserver = null;
  }
  /**
   * Init pointer move listener in each pointer down, unbind in each pointer up.
   * Both cell selections and row-column selections are supported by this method.
   * @param viewportMain
   * @param activeSelectionControl
   * @param rangeType
   * @param scrollTimerType
   * @param moveStartPosX
   * @param moveStartPosY
   */
  // eslint-disable-next-line max-lines-per-function
  _setupPointerMoveListener(t8, n, i, o = bE.ALL, s, l) {
    var m2, f2;
    let a = 0, c = 0, d = s, u = l;
    this._scrollTimer = y0.create(this._scene, o), this._scrollTimer.startScroll((m2 = t8 == null ? void 0 : t8.left) != null ? m2 : 0, (f2 = t8 == null ? void 0 : t8.top) != null ? f2 : 0, t8);
    const h = this._scene, g = h.getActiveViewportByCoord(U.FromArray([s, l]));
    this._scenePointerMoveSub = h.onPointerMove$.subscribeEvent((v2) => {
      var H3, A, x7, V2, D2, X2, B, j, G7;
      const { offsetX: p, offsetY: S } = v2, { x: w, y: C } = h.getCoordRelativeToViewport(U.FromArray([p, S]));
      this._movingHandler(w, C, n, i);
      let I2 = w, R = C;
      const y = this.getActiveSelectionControl(), M7 = this._getFreeze(), E = y == null ? void 0 : y.model, T = (H3 = h.getActiveViewportByCoord(U.FromArray([p, S]))) != null ? H3 : this._getViewportByCell(E == null ? void 0 : E.endRow, E == null ? void 0 : E.endColumn);
      if ((() => {
        if (!g || !T || !t8)
          return false;
        const ge2 = [k2.VIEW_MAIN, k2.VIEW_MAIN_LEFT_TOP, k2.VIEW_MAIN_TOP, k2.VIEW_MAIN_LEFT];
        return ge2.includes(g.viewportKey) && ge2.includes(T.viewportKey);
      })()) {
        if (!g || !T || !t8)
          return false;
        const ge2 = d < t8.left && w > t8.left || d > t8.left && w < t8.left, Re3 = u < t8.top && C > t8.top || u > t8.top && C < t8.top;
        ge2 && (a += 1), Re3 && (c += 1);
        const be2 = g.viewportKey, Ne3 = T.viewportKey;
        if (be2 === k2.VIEW_ROW_TOP)
          S < t8.top && ((A = E == null ? void 0 : E.endRow) != null ? A : 0) < ((x7 = M7 == null ? void 0 : M7.startRow) != null ? x7 : 0) ? R = t8.top : Re3 && c % 2 === 1 && t8.scrollToViewportPos({
            viewportScrollY: 0
          });
        else if (be2 === k2.VIEW_COLUMN_LEFT)
          p < t8.left && ((V2 = E == null ? void 0 : E.endColumn) != null ? V2 : 0) < ((D2 = M7 == null ? void 0 : M7.startColumn) != null ? D2 : 0) ? I2 = t8.left : ge2 && a % 2 === 1 && t8.scrollToViewportPos({
            viewportScrollX: 0
          });
        else if (be2 === Ne3) {
          let Z7 = false, ee3 = false;
          be2 === k2.VIEW_MAIN_LEFT_TOP ? (Z7 = true, ee3 = true) : be2 === k2.VIEW_MAIN_TOP ? ee3 = true : be2 === k2.VIEW_MAIN_LEFT && (Z7 = true), ((X2 = E == null ? void 0 : E.endRow) != null ? X2 : 0) > ((B = M7 == null ? void 0 : M7.startRow) != null ? B : 0) && (ee3 = false), ((j = E == null ? void 0 : E.endColumn) != null ? j : 0) > ((G7 = M7 == null ? void 0 : M7.startColumn) != null ? G7 : 0) && (Z7 = false), Z7 && (I2 = t8.left), ee3 && (R = t8.top);
        } else {
          const Z7 = {
            x: g.scrollX,
            y: g.scrollY
          }, ee3 = {
            x: T.scrollX,
            y: T.scrollY
          }, ne2 = Z7.x !== ee3.x && ge2 && a % 2 === 1, pe2 = Z7.y !== ee3.y && Re3 && c % 2 === 1;
          (ne2 || pe2) && (t8.scrollToBarPos({
            x: ne2 ? Z7.x : void 0,
            y: pe2 ? Z7.y : void 0
          }), ne2 || (I2 = t8.left), pe2 || (R = t8.top)), (be2 === k2.VIEW_MAIN_LEFT_TOP && Ne3 === k2.VIEW_MAIN_LEFT || Ne3 === k2.VIEW_MAIN_LEFT_TOP && be2 === k2.VIEW_MAIN_LEFT) && (I2 = t8.left), (be2 === k2.VIEW_MAIN_LEFT_TOP && Ne3 === k2.VIEW_MAIN_TOP || Ne3 === k2.VIEW_MAIN_LEFT_TOP && be2 === k2.VIEW_MAIN_TOP) && (R = t8.top);
        }
        d = w, u = C;
      }
      this._scrollTimer.scrolling(I2, R, () => {
        this._movingHandler(w, C, n, i);
      });
    });
  }
  /** @deprecated Use the function `attachSelectionWithCoord` instead`. */
  attachSelectionWithCoord(t8) {
    return Wt4(t8, this._skeleton);
  }
  /** @deprecated Use the function `attachPrimaryWithCoord` instead`. */
  attachPrimaryWithCoord(t8) {
    return Ks(this._skeleton, t8);
  }
  /**
   * @deprecated Please use `getCellWithCoordByOffset` instead.
   */
  getSelectionCellByPosition(t8, n) {
    return this.getCellWithCoordByOffset(t8, n);
  }
  getCellWithCoordByOffset(t8, n, i) {
    const o = this._scene, s = i != null ? i : this._skeleton, l = o.getViewportScrollXY(o.getViewport(k2.VIEW_MAIN)), { scaleX: a, scaleY: c } = o.getAncestorScale();
    return s.getCellWithCoordByOffset(t8, n, a, c, l);
  }
  /**
   * When mousedown and mouseup need to go to the coordination and undo stack, when mousemove does not need to go to the coordination and undo stack
   */
  _movingHandler(t8, n, i, o) {
    var I2, R, y, M7, E;
    const s = this._skeleton, l = this._scene, [a, c] = s.getLocation(), d = {
      startRow: (I2 = i == null ? void 0 : i.model.startRow) != null ? I2 : -1,
      endRow: (R = i == null ? void 0 : i.model.endRow) != null ? R : -1,
      startColumn: (y = i == null ? void 0 : i.model.startColumn) != null ? y : -1,
      endColumn: (M7 = i == null ? void 0 : i.model.endColumn) != null ? M7 : -1
    }, u = l.getViewport(k2.VIEW_MAIN), h = (E = this._getViewportByCell(d.endRow, d.endColumn)) != null ? E : u, g = l.getScrollXYInfoByViewport(
      U.FromArray([this._startViewportPosX, this._startViewportPosY]),
      h
    ), { scaleX: m2, scaleY: f2 } = l.getAncestorScale();
    o === ge.ROW ? t8 = Number.POSITIVE_INFINITY : o === ge.COLUMN && (n = Number.POSITIVE_INFINITY);
    const v2 = this._skeleton.getCellByOffset(t8, n, m2, f2, g);
    if (!v2)
      return;
    let p = {
      startRow: Math.min(v2.startRow, this._startRangeWhenPointerDown.startRow),
      startColumn: Math.min(v2.startColumn, this._startRangeWhenPointerDown.startColumn),
      endRow: Math.max(v2.endRow, this._startRangeWhenPointerDown.endRow),
      endColumn: Math.max(v2.endColumn, this._startRangeWhenPointerDown.endColumn)
    };
    this._shouldDetectMergedCells && (p = s.expandRangeByMerge(p));
    const w = Wt4({ range: p, primary: void 0, style: null }, s);
    w.rangeWithCoord.unitId = a, w.rangeWithCoord.sheetId = c, w.rangeWithCoord.rangeType = o;
    const C = d.startRow !== p.startRow || d.startColumn !== p.startColumn || d.endRow !== p.endRow || d.endColumn !== p.endColumn;
    i != null && C && (i.updateRangeBySelectionWithCoord(w), this._selectionMoving$.next(this.getSelectionDataWithStyle()));
  }
  _clearUpdatingListeners() {
    var n, i, o, s, l;
    this._scene.enableObjectsEvent(), (n = this._scenePointerMoveSub) == null || n.unsubscribe(), this._scenePointerMoveSub = null, (i = this._scenePointerUpSub) == null || i.unsubscribe(), this._scenePointerUpSub = null, (o = this._cancelDownSubscription) == null || o.unsubscribe(), this._cancelDownSubscription = null, (s = this._cancelUpSubscription) == null || s.unsubscribe(), this._cancelUpSubscription = null, (l = this._scrollTimer) == null || l.dispose();
  }
  _addEndingListeners() {
    var i, o, s;
    const t8 = this._scene, n = (i = t8.getEngine()) == null ? void 0 : i.activeScene;
    !n || n === t8 || ((o = this._cancelDownSubscription) == null || o.unsubscribe(), this._cancelDownSubscription = null, (s = this._cancelUpSubscription) == null || s.unsubscribe(), this._cancelUpSubscription = null, this._cancelDownSubscription = n.onPointerDown$.subscribeEvent(() => this._clearUpdatingListeners()), this._cancelUpSubscription = n.onPointerUp$.subscribeEvent(() => this._clearUpdatingListeners()));
  }
  /**
   * Get visible selection range & coord by offset on viewport. Nearly same as skeleton.getCellWithCoordByOffset
   * Returning selection is only one cell. primary and range are same cell.
   *
   * visible selection range means getCellWithCoordByOffset needs first matched row/col in rowHeightAccumulation & colWidthAccumulation.
   * Original name: _getCellRangeByCursorPosition
   *
   * @param offsetX position X in viewport.
   * @param offsetY
   * @param scaleX
   * @param scaleY
   * @param scrollXY
   * @returns {Nullable<ISelectionWithCoord>} selection range with coord.
   */
  _getSelectionWithCoordByOffset(t8, n, i, o, s) {
    const l = this._skeleton;
    if (l == null) return null;
    if (this._shouldDetectMergedCells) {
      const p = l == null ? void 0 : l.getCellWithCoordByOffset(
        t8,
        n,
        i,
        o,
        s,
        { firstMatch: true }
      );
      if (!p) return;
      const S = zg(p);
      return {
        primaryWithCoord: p,
        rangeWithCoord: S
      };
    }
    const { row: a, column: c } = l.getCellIndexByOffset(t8, n, i, o, s), d = l.getNoMergeCellWithCoordByIndex(a, c), { startX: u, startY: h, endX: g, endY: m2 } = d, f2 = {
      startY: h,
      endY: m2,
      startX: u,
      endX: g,
      startRow: a,
      endRow: a,
      startColumn: c,
      endColumn: c
    };
    return {
      primaryWithCoord: {
        mergeInfo: f2,
        actualRow: a,
        actualColumn: c,
        isMerged: false,
        isMergedMainCell: false,
        startY: h,
        endY: m2,
        startX: u,
        endX: g
      },
      rangeWithCoord: f2
    };
  }
  _checkClearPreviousControls(t8) {
    this.getSelectionControls().length !== 0 && (!t8.ctrlKey && !t8.shiftKey && !this._remainLastEnabled || this._singleSelectionEnabled && !t8.shiftKey) && this._clearAllSelectionControls();
  }
  _makeSelectionByTwoCells(t8, n, i, o, s) {
    const { actualRow: l, actualColumn: a, mergeInfo: c } = t8;
    this._startRangeWhenPointerDown = { ...t8.mergeInfo };
    const d = Math.min(l, n.startRow, c.startRow), u = Math.max(l, n.endRow, c.endRow), h = Math.min(a, n.startColumn, c.startColumn), g = Math.max(a, n.endColumn, c.endColumn), f2 = {
      range: i.expandRangeByMerge({
        startRow: d,
        startColumn: h,
        endRow: u,
        endColumn: g
      }),
      primary: Ru(t8),
      style: null
    }, v2 = Wt4(f2, i);
    s.updateRangeBySelectionWithCoord(v2);
  }
  isSelectionEnabled() {
    return this.contextService.getContextValue(Eh);
  }
  isSelectionDisabled() {
    return this.contextService.getContextValue(Eh) === false;
  }
  inRefSelectionMode() {
    return this.contextService.getContextValue($u);
  }
};
function fm(r) {
  return {
    range: {
      startRow: 0,
      startColumn: 0,
      endRow: r.getRowCount() - 1,
      endColumn: r.getColumnCount() - 1,
      rangeType: ge.ALL
    },
    primary: Bd2(r).primary,
    style: null
  };
}
function Bd2(r) {
  return AC(r, {
    startRow: 0,
    startColumn: 0,
    endRow: 0,
    endColumn: 0
  });
}
function AC(r, e) {
  const t8 = r.worksheet.getCellInfoInMergeData(e.startRow, e.startColumn), n = r.worksheet.getCellInfoInMergeData(e.endRow, e.endColumn);
  return {
    range: {
      startRow: t8.startRow,
      startColumn: t8.startColumn,
      endRow: n.endRow,
      endColumn: n.endColumn,
      rangeType: ge.NORMAL
    },
    primary: {
      actualRow: t8.startRow,
      actualColumn: t8.startColumn,
      startRow: t8.startRow,
      startColumn: t8.startColumn,
      endRow: t8.endRow,
      endColumn: t8.endColumn,
      isMerged: t8.isMerged,
      isMergedMainCell: t8.isMergedMainCell
    },
    style: null
  };
}
var HC2 = Object.getOwnPropertyDescriptor;
var VC2 = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? HC2(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var Xu3 = (r, e) => (t8, n) => e(t8, n, r);
var ue = class extends Ve {
  constructor(e, t8, n) {
    super();
    _2(this, "_sheetId", "");
    _2(this, "_sheetSkeletonParamStore", /* @__PURE__ */ new Map());
    _2(this, "_currentSkeleton$", new BehaviorSubject(null));
    _2(this, "currentSkeleton$", this._currentSkeleton$.asObservable());
    _2(this, "_currentSkeletonBefore$", new BehaviorSubject(null));
    _2(this, "currentSkeletonBefore$", this._currentSkeletonBefore$.asObservable());
    this._context = e, this._injector = t8, this._sheetSkService = n, this.disposeWithMe(() => {
      this._currentSkeletonBefore$.complete(), this._currentSkeleton$.complete(), this._sheetSkeletonParamStore.forEach((i) => this.disposeSkeleton(i.sheetId)), this._sheetSkeletonParamStore.clear();
    }), this._initRemoveSheet();
  }
  _initRemoveSheet() {
    this.disposeWithMe(this._context.unit.sheetDisposed$.subscribe((e) => {
      this.disposeSkeleton(e.getSheetId());
    }));
  }
  getCurrentSkeleton() {
    var e;
    return (e = this.getCurrentParam()) == null ? void 0 : e.skeleton;
  }
  /**
   * @deprecated use `getCurrentSkeleton` instead.
   */
  getCurrent() {
    return this.getCurrentParam();
  }
  /**
   * get ISheetSkeletonManagerParam from _currentSkeletonSearchParam
   * @returns
   */
  getCurrentParam() {
    return this._getSkeletonParam(this._sheetId);
  }
  /**
   * Get skeleton by sheetId
   * @param sheetId
   */
  getSkeleton(e) {
    return this._getSkeleton(e);
  }
  /**
   * Get SkeletonParam by sheetId
   * @param sheetId
   */
  getSkeletonParam(e) {
    return this._getSkeletonParam(e);
  }
  /**
   * @deprecated use `getSkeleton` instead.
   */
  getWorksheetSkeleton(e) {
    return this.getSkeletonParam(e);
  }
  // why ?? what does unitId for ??? no need unitId, this service is registered in render unit already.
  getUnitSkeleton(e, t8) {
    const n = this._getSkeletonParam(t8);
    return n != null && (n.unitId = e), n;
  }
  /**
   * Command in COMMAND_LISTENER_SKELETON_CHANGE would cause setCurrent, see @packages/sheets-ui/src/controllers/render-controllers/sheet.render-controller.ts
   * @param searchParam
   */
  setCurrent(e) {
    this._setCurrent(e.sheetId);
  }
  setSkeletonParam(e, t8) {
    this._sheetSkService.setSkeleton(t8.unitId, e, t8.skeleton), this._sheetSkeletonParamStore.set(e, t8);
  }
  _setCurrent(e) {
    this._sheetId = e;
    const t8 = this._getSkeletonParam(e), n = this._context.unitId;
    if (t8 != null)
      this.reCalculate(t8);
    else {
      const s = this._context.unit.getSheetBySheetId(e);
      if (s == null)
        return;
      const l = this._context.scene, a = this._buildSkeleton(s, l);
      this.setSkeletonParam(e, {
        unitId: n,
        sheetId: e,
        skeleton: a,
        dirty: false
      });
    }
    const i = this._getSkeletonParam(e);
    this._currentSkeletonBefore$.next(i), this._currentSkeleton$.next(i);
  }
  // @TODO why need this function? How about caller get skeleton and call sk.calculate()?
  reCalculate(e) {
    e || (e = this.getCurrentParam()), e != null && (e.dirty && (e.skeleton.makeDirty(true), e.dirty = false), e.skeleton.calculate());
  }
  /**
   * Make param dirty, if param is dirty, then the skeleton will be makeDirty in _reCalculate()
   * @param searchParm
   * @param state
   */
  makeDirty(e, t8 = true) {
    const n = this._getSkeletonParam(e.sheetId);
    n != null && (n.dirty = t8);
  }
  /**
   * @deprecated Use function `ensureSkeleton` instead.
   * @param searchParam
   */
  getOrCreateSkeleton(e) {
    return this.ensureSkeleton(e.sheetId);
  }
  ensureSkeleton(e) {
    const t8 = this._getSkeletonParam(e);
    if (t8)
      return t8.skeleton;
    const i = this._context.unit.getSheetBySheetId(e);
    if (!i)
      return;
    const o = this._buildSkeleton(i);
    return this.setSkeletonParam(e, {
      unitId: this._context.unitId,
      sheetId: e,
      skeleton: o,
      dirty: false
    }), o;
  }
  disposeSkeleton(e) {
    const t8 = this.getSkeletonParam(e);
    t8 && (t8.skeleton.dispose(), this._sheetSkeletonParamStore.delete(e), this._sheetSkService.deleteSkeleton(t8.unitId, e));
  }
  /** @deprecated Use function `attachRangeWithCoord` instead.  */
  attachRangeWithCoord(e) {
    const t8 = this.getCurrentSkeleton();
    return t8 ? bo2(t8, e) : null;
  }
  _getSkeletonParam(e) {
    return this._sheetSkeletonParamStore.get(e);
  }
  _getSkeleton(e) {
    const t8 = this._getSkeletonParam(e);
    return t8 ? t8.skeleton : null;
  }
  _buildSkeleton(e, t8) {
    return this._injector.createInstance(
      Z5,
      e,
      this._context.unit.getStyles()
    );
  }
  setColumnHeaderSize(e, t8, n) {
    var c;
    if (!e) return;
    const i = (c = this.getWorksheetSkeleton(t8)) == null ? void 0 : c.skeleton;
    if (!i) return;
    i.columnHeaderHeight = n, e.scene.getViewports()[0].top = n, e.scene.getViewport(k2.VIEW_COLUMN_RIGHT).setViewportSize({
      height: n
    }), e.scene.getViewport(k2.VIEW_COLUMN_LEFT).setViewportSize({
      height: n
    }), e.scene.getViewport(k2.VIEW_ROW_BOTTOM).setViewportSize({
      top: n
    }), e.scene.getViewport(k2.VIEW_ROW_TOP).setViewportSize({
      top: n
    }), e.scene.getViewport(k2.VIEW_LEFT_TOP).setViewportSize({
      height: n
    });
    const o = e == null ? void 0 : e.with(z), s = e == null ? void 0 : e.with(gt), l = o.getCurrentSelections();
    s.resetSelectionsByModelData(l);
    const a = this.getUnitSkeleton(e.unitId, t8);
    a && (a.commandId = sa.id, this._currentSkeleton$.next(a));
  }
  setRowHeaderSize(e, t8, n) {
    var g;
    const i = (g = this.getWorksheetSkeleton(t8)) == null ? void 0 : g.skeleton;
    if (!e || !i) return;
    i.rowHeaderWidth = n;
    const o = e.scene.getViewport(k2.VIEW_LEFT_TOP).width || 46, s = n - o, l = e.scene.getViewports()[0].left;
    e.scene.getViewports()[0].left = l + s, e.scene.getViewport(k2.VIEW_ROW_BOTTOM).setViewportSize({
      width: n
    }), e.scene.getViewport(k2.VIEW_ROW_TOP).setViewportSize({
      width: n
    }), e.scene.getViewport(k2.VIEW_COLUMN_LEFT).setViewportSize({
      left: n
    });
    const a = e.scene.getViewport(k2.VIEW_COLUMN_RIGHT).left || 0;
    e.scene.getViewport(k2.VIEW_COLUMN_RIGHT).setViewportSize({
      left: a + s
    }), e.scene.getViewport(k2.VIEW_LEFT_TOP).setViewportSize({
      width: n
    });
    const c = e == null ? void 0 : e.with(z), d = e == null ? void 0 : e.with(gt), u = c.getCurrentSelections();
    d.resetSelectionsByModelData(u);
    const h = this.getCurrent();
    h && (h.commandId = oa.id, this._currentSkeleton$.next(h));
  }
};
ue = VC2([
  Xu3(1, Inject(Injector)),
  Xu3(2, Inject(rt2))
], ue);
var NC = Object.getOwnPropertyDescriptor;
var kC = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? NC(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var Zi = (r, e) => (t8, n) => e(t8, n, r);
var DC = ["ff", "fs", "tr", "tb"];
var hi3 = class extends Ve {
  constructor(r, e, t8, n, i) {
    super(), this._renderManagerService = r, this._sheetInterceptorService = e, this._selectionManagerService = t8, this._univerInstanceService = n, this._configService = i, this._initialize();
  }
  _processLazyAutoHeight(r, e, t8, n) {
    if (n != null && n.length) {
      const i = {
        id: gd.id,
        params: {
          unitId: e,
          subUnitId: t8,
          ranges: n,
          id: et()
        },
        options: {
          onlyLocal: true
        }
      }, o = {
        id: md.id,
        params: {
          unitId: e,
          subUnitId: t8,
          id: i.params.id
        },
        options: {
          onlyLocal: true
        }
      };
      return {
        redos: [...r.redos, i],
        undos: [...r.undos, o]
      };
    }
    return r;
  }
  getUndoRedoParamsOfAutoHeight(r, e, t8) {
    const { _univerInstanceService: n } = this, i = n.getCurrentUnitForType(we.UNIVER_SHEET), o = i.getUnitId();
    let s = i.getActiveSheet(), l = s.getSheetId();
    if (e) {
      const m2 = P(n, { unitId: o, subUnitId: e });
      m2 && (s = m2.worksheet, l = s.getSheetId());
    }
    const c = this._renderManagerService.getRenderById(o).with(ue).ensureSkeleton(l);
    if (!c)
      return {
        redos: [],
        undos: []
      };
    const u = c.calculateAutoHeightInRange(r, t8).filter((m2) => {
      const { row: f2, autoHeight: v2 } = m2;
      return !(!v2 || s.getRowHeight(f2) === v2);
    });
    if (u.length === 0)
      return {
        redos: [],
        undos: []
      };
    const h = {
      subUnitId: l,
      unitId: o,
      rowsAutoHeightInfo: u
    }, g = gh(h, s);
    return {
      undos: [
        {
          id: Xo.id,
          params: g
        }
      ],
      redos: [
        {
          id: Xo.id,
          params: h
        }
      ]
    };
  }
  _initialize() {
    this.disposeWithMe(this._sheetInterceptorService.interceptAutoHeight({
      getMutations: (r) => {
        const { unitId: e, subUnitId: t8, ranges: n, autoHeightRanges: i, lazyAutoHeightRanges: o, cellHeights: s } = r, l = this.getUndoRedoParamsOfAutoHeight(i != null ? i : n, t8, s);
        return this._processLazyAutoHeight(l, e, t8, o);
      }
    }));
  }
};
hi3 = kC([
  Zi(0, ME),
  Zi(1, Inject(G)),
  Zi(2, Inject(z)),
  Zi(3, Inject(vr)),
  Zi(4, ic)
], hi3);
function Cr3(r) {
  const { rows: e, cols: t8 } = r;
  return {
    startRow: e[0],
    endRow: e[e.length - 1],
    startColumn: t8[0],
    endColumn: t8[t8.length - 1]
  };
}
function wr3(r) {
  let e = [], t8 = [];
  const n = [];
  return r.forEach((i) => {
    e = e.concat(i.rows), t8 = t8.concat(i.cols);
  }), e = Array.from(new Set(e)).sort((i, o) => i - o), t8 = Array.from(new Set(t8)).sort((i, o) => i - o), r.forEach((i) => {
    n.push({
      startRow: e.findIndex((o) => o === i.rows[0]),
      endRow: e.findIndex((o) => o === i.rows[i.rows.length - 1]),
      startColumn: t8.findIndex((o) => o === i.cols[0]),
      endColumn: t8.findIndex((o) => o === i.cols[i.cols.length - 1])
    });
  }), {
    ranges: n,
    mapFunc: (i, o) => ({
      row: e[i],
      col: t8[o]
    })
  };
}
function LC(r) {
  const e = new pt();
  return r.forEach((t8) => {
    const { rows: n, cols: i } = t8;
    n.forEach((o) => {
      i.forEach((s) => {
        e.setValue(o, s, {
          v: null,
          p: null,
          f: null,
          si: null,
          custom: null
        });
      });
    });
  }), e.getData();
}
var Uc = { : 0, : 1, : 2, : 3, : 4, : 5, : 6, : 7, : 8, : 9 };
var Js2 = ["", "", "", "", "", "", "", "", "", ""];
var zu2 = ["", "", "", "", ""];
var WC = ["", "", "", ""];
var pm = {
  : { value: 10, secUnit: false },
  : { value: 100, secUnit: false },
  : { value: 1e3, secUnit: false },
  : { value: 1e4, secUnit: true },
  : { value: 1e8, secUnit: true }
};
function Mn2(r) {
  if (!r)
    return 0;
  let e = 0, t8 = 0, n = 0, i = false;
  const o = r.split("");
  for (let s = 0; s < o.length; s++) {
    const l = Uc[o[s]];
    if (typeof l < "u")
      n = l, s === o.length - 1 && (t8 += n);
    else {
      const a = pm[o[s]], c = a.value;
      i = a.secUnit, i ? (t8 = (t8 + n) * c, e += t8, t8 = 0) : t8 += n * c, n = 0;
    }
  }
  return e + t8;
}
function BC(r) {
  let e = "", t8 = "", n = 0, i = true;
  for (; r > 0; ) {
    const o = r % 10;
    o === 0 ? i || (i = true, t8 = Js2[o] + t8) : (i = false, e = Js2[o], e += WC[n], t8 = e + t8), n++, r = Math.floor(r / 10);
  }
  return t8;
}
function FC(r) {
  let e = 0, t8 = "", n = "", i = false;
  if (r === 0)
    return Js2[0];
  for (; r > 0; ) {
    const o = r % 1e4;
    i && (n = Js2[0] + n), t8 = BC(o), t8 += o !== 0 ? zu2[e] : zu2[0], n = t8 + n, i = o < 1e3 && o > 0, r = Math.floor(r / 1e4), e++;
  }
  return n;
}
function UC(r) {
  if (!r)
    return false;
  let e = true;
  if (r)
    if (r.length === 1)
      r === "" || r in Uc ? e = true : e = false;
    else {
      const t8 = r.split("");
      for (let n = 0; n < t8.length; n++)
        if (!(t8[n] in Uc || t8[n] in pm)) {
          e = false;
          break;
        }
    }
  return e;
}
function Ss2(r) {
  if (!r)
    return {
      isExtendNumber: false
    };
  const e = /0|([1-9]+[0-9]*)/g, t8 = e.test(r);
  if (t8) {
    const n = r.match(e);
    if (n && n.length > 0) {
      const i = n[n.length - 1], o = r.lastIndexOf(i), s = r.substr(0, o), l = r.substr(o + i.length);
      return {
        isExtendNumber: true,
        matchTxt: Number(i),
        beforeTxt: s,
        afterTxt: l
      };
    }
    return {
      isExtendNumber: false
    };
  }
  return {
    isExtendNumber: t8
  };
}
function XC2(r) {
  let e;
  return r.length === 2 && (r === "" || r === "" || r === "" || r === "" || r === "" || r === "" || r === "") ? e = true : e = false, e;
}
function zC(r) {
  let e;
  return r.length === 3 && (r === "" || r === "" || r === "" || r === "" || r === "" || r === "" || r === "") ? e = true : e = false, e;
}
function jC(r, e) {
  let t8 = 0;
  for (let n = 0; n < r.length && r[n] < e; n++)
    t8++;
  return t8;
}
function es2(r) {
  let e = true;
  const t8 = r[1] - r[0];
  for (let n = 1; n < r.length; n++)
    if (r[n] - r[n - 1] !== t8) {
      e = false;
      break;
    }
  return e;
}
function YC(r, e, t8) {
  const n = [], i = Math.floor(e / r), o = e % r;
  let s = 0;
  if (i > 0) {
    for (let l = 0; l < i; l++)
      for (let a = 0; a < t8.length; a++)
        n[t8[a] + l * r] = s, s++;
    for (let l = 0; l < t8.length && t8[l] < o; l++)
      n[t8[l] + r * i] = s, s++;
  } else
    for (let l = 0; l < t8.length && t8[l] < o; l++)
      n[t8[l]] = s, s++;
  return n;
}
function br2(r, e) {
  const t8 = [];
  for (let n = 1; n <= e; n++) {
    const i = (n - 1) % r.length, o = J.deepClone(r[i]);
    _r2(o), t8.push({
      v: null,
      s: null,
      p: null,
      f: null,
      si: null,
      t: null,
      ...o
    });
  }
  return t8;
}
function ZC2(r, e) {
  var n;
  const t8 = [];
  for (let i = 1; i <= e; i++) {
    const o = (i - 1) % r.length, s = { s: (n = r[o]) == null ? void 0 : n.s };
    t8.push(s);
  }
  return t8;
}
function GC2(r) {
  let e = true;
  const t8 = r[1] / r[0];
  for (let n = 1; n < r.length; n++)
    if (r[n] / r[n - 1] !== t8) {
      e = false;
      break;
    }
  return e;
}
function qC2(r) {
  const e = [];
  for (let t8 = 1; t8 <= r; t8++)
    e.push(t8);
  return e;
}
function $s3(r, e, t8) {
  var o, s, l, a;
  const n = [], i = [];
  for (let c = 0; c < r.length; c++)
    i.push(Number((o = r[c]) == null ? void 0 : o.v));
  if (r.length > 2 && GC2(i))
    for (let c = 1; c <= e; c++) {
      const d = (c - 1) % r.length, u = J.deepClone(r[d]);
      _r2(u);
      const h = Number((s = r[r.length - 1]) == null ? void 0 : s.v) * (Number((l = r[1]) == null ? void 0 : l.v) / Number((a = r[0]) == null ? void 0 : a.v)) ** c;
      u && (Gu2(u) && (u.v = h), n.push(u));
    }
  else {
    const c = qC2(r.length);
    for (let d = 1; d <= e; d++) {
      const u = (d - 1) % r.length, h = J.deepClone(r[u]);
      _r2(h);
      const g = t8 === Cm.DOWN || t8 === Cm.RIGHT, m2 = QC(r.length + d, i, c, g);
      h && (Gu2(h) && (h.v = m2), n.push(h));
    }
  }
  return n;
}
function QC(r, e, t8, n = true) {
  function i(u) {
    let h = 0;
    for (let g = 0; g < u.length; g++)
      h += u[g];
    return h / u.length;
  }
  const o = i(t8), s = i(e);
  let l = 0, a = 0;
  for (let u = 0; u < t8.length; u++)
    l += (t8[u] - o) * (e[u] - s), a += (t8[u] - o) * (t8[u] - o);
  let c;
  a === 0 ? c = n ? 1 : -1 : c = l / a;
  const d = s - c * o;
  return Math.round((d + c * r) * 1e5) / 1e5;
}
function ju2(r, e, t8) {
  var o;
  const n = [], i = /0|([1-9]+[0-9]*)/g;
  for (let s = 1; s <= e; s++) {
    const l = (s - 1) % r.length, a = J.deepClone(r[l]);
    _r2(a);
    const c = `${(o = r[r.length - 1]) == null ? void 0 : o.v}`;
    if (!c) continue;
    const d = c == null ? void 0 : c.match(i), u = d == null ? void 0 : d[d.length - 1];
    if (!u) continue;
    const h = Math.abs(Number(u) + t8 * s), g = c.lastIndexOf(u), m2 = c.substr(0, g) + h.toString() + c.substr(g + u.length);
    a && (a.v = m2, n.push(a));
  }
  return n;
}
function gi3(r, e, t8, n = 0) {
  var l, a;
  const i = [
    ["", "", "", "", "", "", ""],
    ["", "", "", "", "", "", ""],
    ["", "", "", "", "", "", ""]
  ];
  if (n >= i.length) return [];
  const o = i[n], s = [];
  for (let c = 1; c <= e; c++) {
    const d = (c - 1) % r.length, u = J.deepClone(r[d]);
    _r2(u);
    let h = 0;
    if (((l = r[r.length - 1]) == null ? void 0 : l.v) === o[0])
      h = 7 + t8 * c;
    else {
      const m2 = `${(a = r[r.length - 1]) == null ? void 0 : a.v}`;
      if (m2) {
        const f2 = m2.substr(m2.length - 1, 1);
        h = Mn2(f2) + t8 * c;
      }
    }
    h < 0 && (h = Math.ceil(Math.abs(h) / 7) * 7 + h);
    const g = h % 7;
    u && (u.v = o[g], s.push(u));
  }
  return s;
}
function Yu3(r, e, t8) {
  var i;
  const n = [];
  for (let o = 1; o <= e; o++) {
    const s = (o - 1) % r.length, l = J.deepClone(r[s]);
    _r2(l);
    const a = `${(i = r[r.length - 1]) == null ? void 0 : i.v}`, c = Mn2(a) + t8 * o;
    let d;
    c <= 0 ? d = "" : d = FC(c), l && (l.v = d, n.push(l));
  }
  return n;
}
var ho3 = {
  enWeek1: ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"],
  enWeek2: ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"],
  enMonth1: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
  enMonth2: [
    "January",
    "February",
    "March",
    "April",
    "May",
    "June",
    "July",
    "August",
    "September",
    "October",
    "November",
    "December"
  ],
  chnMonth1: ["", "", "", "", "", "", "", "", "", "", "", ""],
  chnMonth2: ["", "", "", "", "", "", "", "", "", "", "", ""],
  chHour1: ["", "", "", "", "", "", "", "", "", "", "", ""],
  chHour2: ["", "", "", "", "", "", "", "", "", "", "", ""],
  chYear1: ["", "", "", "", "", "", "", "", "", ""],
  chSeason1: ["", "", "", ""],
  chSeason2: ["", "", "", ""]
};
function KC(r) {
  let e = false;
  return Object.keys(ho3).forEach((t8) => {
    ho3[t8].includes(r) && (e = true);
  }), e;
}
function ka2(r) {
  let e = "";
  const t8 = [];
  return Object.keys(ho3).forEach((n) => {
    ho3[n].includes(r) && (e = n, t8.push(...ho3[n]));
  }), { name: e, series: t8 };
}
function Zu2(r, e, t8, n) {
  var s;
  const i = n.length, o = [];
  for (let l = 1; l <= e; l++) {
    const a = (l - 1) % r.length, c = J.deepClone(r[a]);
    _r2(c);
    const d = `${(s = r[r.length - 1]) == null ? void 0 : s.v}`;
    let u = n.indexOf(d) + t8 * l;
    u < 0 && (u += Math.abs(t8) * i);
    const h = u % i;
    c && (c.v = n[h], o.push(c));
  }
  return o;
}
function zy(r, e) {
  const t8 = [];
  let n;
  if (e.startRow < r.startRow)
    n = Cm.UP;
  else if (e.endRow > r.endRow)
    n = Cm.DOWN;
  else if (e.startColumn < r.startColumn)
    n = Cm.LEFT;
  else if (e.endColumn > r.endColumn)
    n = Cm.RIGHT;
  else
    return [];
  if (n === Cm.DOWN || n === Cm.UP) {
    const i = r.endRow - r.startRow + 1, o = e.endRow - e.startRow + 1, s = Math.floor(o / i), l = o % i, a = {
      startRow: 0,
      startColumn: 0,
      endRow: r.endRow - r.startRow,
      endColumn: r.endColumn - r.startColumn
    };
    if (n === Cm.DOWN) {
      for (let c = 0; c < s; c++)
        t8.push({
          repeatStartCell: {
            row: r.startRow + (c + 1) * i,
            col: r.startColumn
          },
          relativeRange: a
        });
      l > 0 && t8.push({
        repeatStartCell: {
          row: r.startRow + (s + 1) * i,
          col: r.startColumn
        },
        relativeRange: {
          startRow: 0,
          startColumn: 0,
          endRow: l - 1,
          endColumn: r.endColumn - r.startColumn
        }
      });
    } else {
      for (let c = 0; c < s; c++)
        t8.push({
          repeatStartCell: {
            row: r.startRow - (c + 1) * i,
            col: r.startColumn
          },
          relativeRange: a
        });
      l > 0 && t8.push({
        repeatStartCell: {
          row: r.startRow - (s + 1) * i,
          col: r.startColumn
        },
        relativeRange: {
          startRow: i - l,
          endRow: i - 1,
          startColumn: 0,
          endColumn: r.endColumn - r.startColumn
        }
      });
    }
  }
  if (n === Cm.RIGHT || n === Cm.LEFT) {
    const i = r.endColumn - r.startColumn + 1, o = e.endColumn - e.startColumn + 1, s = Math.floor(o / i), l = o % i, a = {
      startRow: 0,
      startColumn: 0,
      endRow: r.endRow - r.startRow,
      endColumn: r.endColumn - r.startColumn
    };
    if (n === Cm.RIGHT) {
      for (let c = 0; c < s; c++)
        t8.push({
          repeatStartCell: {
            row: r.startRow,
            col: r.startColumn + (c + 1) * i
          },
          relativeRange: a
        });
      l > 0 && t8.push({
        repeatStartCell: {
          row: r.startRow,
          col: r.startColumn + (s + 1) * i
        },
        relativeRange: {
          startRow: 0,
          startColumn: 0,
          endRow: r.endRow - r.startRow,
          endColumn: l - 1
        }
      });
    } else {
      for (let c = 0; c < s; c++)
        t8.push({
          repeatStartCell: {
            row: r.startRow,
            col: r.startColumn - (c + 1) * i
          },
          relativeRange: a
        });
      l > 0 && t8.push({
        repeatStartCell: {
          row: r.startRow,
          col: r.startColumn - (s + 1) * i
        },
        relativeRange: {
          startRow: 0,
          startColumn: i - l,
          endRow: r.endRow - r.startRow,
          endColumn: i - 1
        }
      });
    }
  }
  return t8;
}
function Gu2(r) {
  return !(Gg(r.f) || B1(r.si) || r.t === fn.BOOLEAN);
}
function _r2(r) {
  r && "custom" in r && delete r.custom;
}
var Kr2 = ((r) => (r.Append = "APPEND", r.Default = "DEFAULT", r.Only = "ONLY", r))(Kr2 || {});
var mt3 = ((r) => (r.NUMBER = "number", r.DATE = "date", r.EXTEND_NUMBER = "extendNumber", r.CHN_NUMBER = "chnNumber", r.CHN_WEEK2 = "chnWeek2", r.CHN_WEEK3 = "chnWeek3", r.LOOP_SERIES = "loopSeries", r.FORMULA = "formula", r.OTHER = "other", r))(mt3 || {});
var Le3 = ((r) => (r.COPY = "COPY", r.SERIES = "SERIES", r.ONLY_FORMAT = "ONLY_FORMAT", r.NO_FORMAT = "NO_FORMAT", r))(Le3 || {});
var JC = {
  type: mt3.DATE,
  priority: 1100,
  match: (r, e) => {
    var t8;
    if (r != null && r.f || r != null && r.si)
      return false;
    if ((typeof (r == null ? void 0 : r.v) == "number" || (r == null ? void 0 : r.t) === fn.NUMBER) && r.s) {
      if (typeof r.s == "string") {
        const i = e.get(vr).getFocusedUnit().getStyles().get(r.s), o = (t8 = i == null ? void 0 : i.n) == null ? void 0 : t8.pattern;
        if (o)
          return eR.getFormatInfo(o).isDate;
      } else if (r.s.n && eR.getFormatInfo(r.s.n.pattern).isDate)
        return true;
    }
    return false;
  },
  isContinue: (r, e) => r.type === mt3.DATE,
  applyFunctions: {
    [Le3.SERIES]: (r, e, t8) => {
      const { data: n } = r;
      return t8 === Cm.LEFT || t8 === Cm.UP ? (n.reverse(), $s3(n, e, t8).reverse()) : $s3(n, e, t8);
    }
  }
};
var $C2 = {
  type: mt3.NUMBER,
  priority: 1e3,
  match: (r) => typeof (r == null ? void 0 : r.v) == "number" || (r == null ? void 0 : r.t) === fn.NUMBER,
  isContinue: (r, e) => r.type === mt3.NUMBER,
  applyFunctions: {
    [Le3.SERIES]: (r, e, t8) => {
      const { data: n } = r;
      return t8 === Cm.LEFT || t8 === Cm.UP ? (n.reverse(), $s3(n, e, t8).reverse()) : $s3(n, e, t8);
    }
  }
};
var vm = {
  type: mt3.OTHER,
  priority: 0,
  match: () => true,
  isContinue: (r, e) => r.type === mt3.OTHER
};
var e1 = {
  type: mt3.EXTEND_NUMBER,
  priority: 900,
  match: (r) => Ss2(`${r == null ? void 0 : r.v}` || "").isExtendNumber,
  isContinue: (r, e) => {
    var t8;
    if (r.type === mt3.EXTEND_NUMBER) {
      const { beforeTxt: n, afterTxt: i } = Ss2(`${(t8 = r.cellData) == null ? void 0 : t8.v}` || ""), { beforeTxt: o, afterTxt: s } = Ss2(`${e == null ? void 0 : e.v}` || "");
      if (n === o && i === s)
        return true;
    }
    return false;
  },
  applyFunctions: {
    [Le3.SERIES]: (r, e, t8) => {
      var l;
      const { data: n } = r, i = t8 === Cm.UP || t8 === Cm.LEFT;
      let o;
      if (n.length === 1)
        return o = i ? -1 : 1, Xt3(ju2(n, e, o), i);
      const s = [];
      for (let a = 0; a < n.length; a++) {
        const c = `${(l = n[a]) == null ? void 0 : l.v}`;
        c && s.push(Number(Ss2(c).matchTxt));
      }
      return i && (n.reverse(), s.reverse()), es2(s) ? (o = s[1] - s[0], Xt3(ju2(n, e, o), i)) : br2(n, e);
    }
  }
};
var t12 = {
  type: mt3.CHN_NUMBER,
  priority: 830,
  match: (r) => !!UC(`${r == null ? void 0 : r.v}` || ""),
  isContinue: (r, e) => r.type === mt3.CHN_NUMBER,
  applyFunctions: {
    [Le3.SERIES]: (r, e, t8) => {
      var a, c, d;
      const { data: n } = r, i = t8 === Cm.LEFT || t8 === Cm.UP;
      if (n.length === 1) {
        const u = `${(a = n[0]) == null ? void 0 : a.v}`;
        let h;
        return i ? h = -1 : h = 1, u && (u === "" || Mn2(u) < 7) ? Xt3(gi3(n, e, h), i) : Xt3(Yu3(n, e, h), i);
      }
      let o = false;
      for (let u = 0; u < n.length; u++)
        if (((c = n[u]) == null ? void 0 : c.v) === "") {
          o = true;
          break;
        }
      const s = [];
      let l = 0;
      for (let u = 0; u < n.length; u++) {
        const h = `${(d = n[u]) == null ? void 0 : d.v}`;
        h === "" ? u === 0 ? s.push(0) : (l++, s.push(l * 7)) : o && Mn2(h) > 0 && Mn2(h) < 7 ? s.push(Mn2(h) + l * 7) : s.push(Mn2(h));
      }
      if (i && (n.reverse(), s.reverse()), es2(s)) {
        if (o || s[s.length - 1] < 6 && s[0] > 0 || s[0] < 6 && s[s.length - 1] > 0) {
          const h = s[1] - s[0];
          return Xt3(gi3(n, e, h), i);
        }
        const u = s[1] - s[0];
        return Xt3(Yu3(n, e, u), i);
      }
      return br2(n, e);
    }
  }
};
var n13 = {
  type: mt3.CHN_WEEK2,
  priority: 820,
  match: (r) => !!XC2(`${r == null ? void 0 : r.v}` || ""),
  isContinue: (r, e) => r.type === mt3.CHN_WEEK2,
  applyFunctions: {
    [Le3.SERIES]: (r, e, t8) => {
      var l;
      const { data: n } = r, i = t8 === Cm.LEFT || t8 === Cm.UP;
      if (n.length === 1) {
        let a;
        return i ? a = -1 : a = 1, Xt3(gi3(n, e, a, 1), i);
      }
      const o = [];
      let s = 0;
      for (let a = 0; a < n.length; a++) {
        const c = `${(l = n[a]) == null ? void 0 : l.v}`, d = c == null ? void 0 : c.substr(c.length - 1, 1);
        c === "" ? a === 0 ? o.push(0) : (s++, o.push(s * 7)) : o.push(Mn2(d) + s * 7);
      }
      if (i && (n.reverse(), o.reverse()), es2(o)) {
        const a = o[1] - o[0];
        return Xt3(gi3(n, e, a, 1), i);
      }
      return br2(n, e);
    }
  }
};
var r1 = {
  type: mt3.CHN_WEEK3,
  priority: 810,
  match: (r) => zC(`${r == null ? void 0 : r.v}` || ""),
  isContinue: (r, e) => r.type === mt3.CHN_WEEK3,
  applyFunctions: {
    [Le3.SERIES]: (r, e, t8) => {
      var l;
      const { data: n } = r, i = t8 === Cm.LEFT || t8 === Cm.UP;
      if (n.length === 1) {
        let a;
        return i ? a = -1 : a = 1, Xt3(gi3(n, e, a, 2), i);
      }
      const o = [];
      let s = 0;
      for (let a = 0; a < n.length; a++) {
        const c = `${(l = n[a]) == null ? void 0 : l.v}`;
        if (c) {
          const d = c.substr(c.length - 1, 1);
          c === "" ? a === 0 ? o.push(0) : (s++, o.push(s * 7)) : o.push(Mn2(d) + s * 7);
        }
      }
      if (i && (n.reverse(), o.reverse()), es2(o)) {
        const a = o[1] - o[0];
        return Xt3(gi3(n, e, a, 2), i);
      }
      return br2(n, e);
    }
  }
};
var i1 = {
  type: mt3.LOOP_SERIES,
  priority: 800,
  match: (r) => KC(`${r == null ? void 0 : r.v}` || ""),
  isContinue: (r, e) => {
    var t8;
    return r.type === mt3.LOOP_SERIES ? ka2(`${(t8 = r.cellData) == null ? void 0 : t8.v}` || "").name === ka2(`${e == null ? void 0 : e.v}` || "").name : false;
  },
  applyFunctions: {
    [Le3.SERIES]: (r, e, t8) => {
      var a, c;
      const { data: n } = r, i = t8 === Cm.LEFT || t8 === Cm.UP, { series: o } = ka2(`${(a = n[0]) == null ? void 0 : a.v}` || "");
      if (n.length === 1) {
        let d;
        return i ? d = -1 : d = 1, Xt3(Zu2(n, e, d, o), i);
      }
      const s = [];
      let l = 0;
      for (let d = 0; d < n.length; d++) {
        const u = `${(c = n[d]) == null ? void 0 : c.v}`;
        u && (u === o[0] ? d === 0 ? s.push(0) : (l++, s.push(l * o.length)) : s.push(o.indexOf(u) + l * 7));
      }
      if (i && (n.reverse(), s.reverse()), es2(s)) {
        const d = s[1] - s[0];
        return Xt3(Zu2(n, e, d, o), i);
      }
      return br2(n, e);
    }
  }
};
function Xt3(r, e) {
  return e ? r.reverse() : r;
}
var o1 = Object.getOwnPropertyDescriptor;
var s12 = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? o1(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var Wr = (r, e) => (t8, n) => e(t8, n, r);
var el = class extends Ve {
  constructor(e, t8, n, i, o, s) {
    super();
    _2(this, "_rules", []);
    _2(this, "_hooks", []);
    _2(this, "_applyType$", new BehaviorSubject(Le3.SERIES));
    _2(this, "_isFillingStyle", true);
    _2(this, "_prevUndos", []);
    _2(this, "_autoFillLocation$", new BehaviorSubject(null));
    _2(this, "autoFillLocation$", this._autoFillLocation$.asObservable());
    _2(this, "_showMenu$", new BehaviorSubject(false));
    _2(this, "showMenu$", this._showMenu$.asObservable());
    _2(this, "_direction", Cm.DOWN);
    _2(this, "applyType$", this._applyType$.asObservable());
    _2(this, "_menu$", new BehaviorSubject([
      {
        label: "autoFill.copy",
        value: Le3.COPY,
        disable: false
      },
      {
        label: "autoFill.series",
        value: Le3.SERIES,
        disable: false
      },
      {
        label: "autoFill.formatOnly",
        value: Le3.ONLY_FORMAT,
        disable: false
      },
      {
        label: "autoFill.noFormat",
        value: Le3.NO_FORMAT,
        disable: false
      }
    ]));
    _2(this, "menu$", this._menu$.asObservable());
    this._commandService = e, this._undoRedoService = t8, this._renderManagerService = n, this._univerInstanceService = i, this._selectionManagerService = o, this._injector = s, this._init();
  }
  _init() {
    this._rules = [
      JC,
      $C2,
      e1,
      t12,
      n13,
      r1,
      i1,
      vm
    ].sort((e, t8) => t8.priority - e.priority), this._isFillingStyle = true;
  }
  _getOneByPriority(e) {
    return e.length <= 0 ? [] : [e.reduce((n, i) => (i.priority || 0) > (n.priority || 0) ? i : n, e[0])];
  }
  // a cache to undo commands of last apply-type
  _initPrevUndo() {
    this._prevUndos = [];
  }
  // eslint-disable-next-line max-lines-per-function
  async triggerAutoFill(e, t8, n, i) {
    var h;
    if (n.startColumn === i.startColumn && n.startRow === i.startRow && n.endColumn === i.endColumn && n.endRow === i.endRow)
      return false;
    if (i.endColumn < n.endColumn && i.endColumn > n.startColumn)
      return this._commandService.executeCommand(_o3.id, {
        clearRange: {
          startRow: i.startRow,
          endRow: i.endRow,
          startColumn: i.endColumn + 1,
          endColumn: n.endColumn
        },
        selectionRange: i
      });
    if (i.endRow < n.endRow && i.endRow > n.startRow)
      return this._commandService.executeCommand(_o3.id, {
        clearRange: {
          startRow: i.endRow + 1,
          endRow: n.endRow,
          startColumn: i.startColumn,
          endColumn: i.endColumn
        },
        selectionRange: i
      });
    const o = {
      startRow: i.startRow,
      endRow: i.endRow,
      startColumn: i.startColumn,
      endColumn: i.endColumn
    };
    let s = null;
    if (i.startRow < n.startRow)
      s = Cm.UP, o.endRow = n.startRow - 1;
    else if (i.endRow > n.endRow)
      s = Cm.DOWN, o.startRow = n.endRow + 1;
    else if (i.startColumn < n.startColumn)
      s = Cm.LEFT, o.endColumn = n.startColumn - 1;
    else if (i.endColumn > n.endColumn)
      s = Cm.RIGHT, o.startColumn = n.endColumn + 1;
    else
      return false;
    this.direction = s;
    const l = this._injector.invoke((g) => ku(n, g)), a = this._injector.invoke((g) => ku(o, g));
    if (!l || !a)
      return false;
    this.autoFillLocation = {
      source: l,
      target: a,
      unitId: e,
      subUnitId: t8
    };
    const c = [];
    this.getActiveHooks().forEach((g) => {
      var f2;
      const m2 = (f2 = g == null ? void 0 : g.onBeforeFillData) == null ? void 0 : f2.call(g, { source: l, target: a, unitId: e, subUnitId: t8 }, s);
      m2 && c.unshift(m2);
    }), this._initPrevUndo();
    for (let g = 0; g < c.length; g++) {
      const m2 = this.menu.find((f2) => f2.value === c[g]);
      if (m2 && !m2.disable)
        return this.fillData(c[g]);
    }
    const u = (h = this.menu.find((g) => g.disable === false)) == null ? void 0 : h.value;
    return u ? this.fillData(u) : false;
  }
  addHook(e) {
    if (this._hooks.find((t8) => t8.id === e.id))
      throw new Error(`Add hook failed, hook id '${e.id}' already exist!`);
    return e.priority === void 0 && (e.priority = 0), e.type === void 0 && (e.type = Kr2.Append), this._hooks.push(e), We(() => {
      const t8 = this._hooks.findIndex((n) => n === e);
      t8 > -1 && this._hooks.splice(t8, 1);
    });
  }
  registerRule(e) {
    if (this._rules.find((n) => n.type === e.type))
      throw new Error(`Registry rule failed, type '${e.type}' already exist!`);
    const t8 = this._rules.findIndex((n) => n.priority < e.priority);
    this._rules.splice(t8 === -1 ? this._rules.length : t8, 0, e);
  }
  getRules() {
    return this._rules;
  }
  getAllHooks() {
    return this._hooks;
  }
  getActiveHooks() {
    const { source: e, target: t8, unitId: n, subUnitId: i } = this.autoFillLocation || {};
    if (!e || !t8 || !n || !i)
      return [];
    const o = this._hooks.filter(
      (c) => {
        var d;
        return !((d = c.disable) != null && d.call(c, { source: e, target: t8, unitId: n, subUnitId: i }, this._direction, this.applyType));
      }
    ), s = o.filter((c) => c.type === Kr2.Only);
    if (s.length > 0)
      return this._getOneByPriority(s);
    const l = this._getOneByPriority(o.filter((c) => c.type === Kr2.Default)), a = o.filter((c) => c.type === Kr2.Append) || [];
    return [...l, ...a];
  }
  get applyType() {
    return this._applyType$.getValue();
  }
  set applyType(e) {
    this._applyType$.next(e);
  }
  get menu() {
    return this._menu$.getValue();
  }
  get direction() {
    return this._direction;
  }
  set direction(e) {
    this._direction = e;
  }
  isFillingStyle() {
    return this._isFillingStyle;
  }
  setFillingStyle(e) {
    this._isFillingStyle = e;
  }
  get autoFillLocation() {
    return this._autoFillLocation$.getValue();
  }
  set autoFillLocation(e) {
    this._autoFillLocation$.next(e);
  }
  setDisableApplyType(e, t8) {
    this._menu$.next(
      this._menu$.getValue().map((n) => n.value === e ? {
        ...n,
        disable: t8
      } : n)
    );
  }
  setShowMenu(e) {
    this._showMenu$.next(e);
  }
  // eslint-disable-next-line max-lines-per-function
  fillData(e) {
    var v2, p, S;
    this.applyType = e;
    const { source: t8, target: n, unitId: i = this._univerInstanceService.getCurrentUnitForType(we.UNIVER_SHEET).getUnitId(), subUnitId: o = (v2 = this._univerInstanceService.getCurrentUnitForType(we.UNIVER_SHEET).getActiveSheet()) == null ? void 0 : v2.getSheetId() } = this.autoFillLocation || {};
    if (!t8 || !n || !i || !o)
      return false;
    const s = this.direction;
    this._prevUndos.length > 0 && this._prevUndos.forEach((w) => {
      this._commandService.syncExecuteCommand(w.id, w.params);
    }), this._prevUndos = [];
    const l = En.union(Cr3(t8), Cr3(n)), a = this.getActiveHooks(), c = this._univerInstanceService.getUnit(i, we.UNIVER_SHEET);
    this._commandService.syncExecuteCommand(ie3.id, {
      selections: [
        {
          primary: { ...(S = (p = this._selectionManagerService.getCurrentLastSelection()) == null ? void 0 : p.primary) != null ? S : l },
          range: {
            ...l,
            rangeType: ge.NORMAL
          }
        }
      ],
      unitId: i,
      subUnitId: o
    });
    const d = [], u = [];
    a.forEach((w) => {
      var R;
      const { undos: C, redos: I2 } = ((R = w.onFillData) == null ? void 0 : R.call(w, { source: t8, target: n, unitId: i, subUnitId: o }, s, e)) || {};
      C && d.push(...C), I2 && u.push(...I2);
    });
    const h = u.every((w) => this._commandService.syncExecuteCommand(w.id, w.params)), g = [];
    e !== Le3.NO_FORMAT && u.forEach((w) => {
      if (w.id === ee.id) {
        const { cellValue: C } = w.params;
        new pt(C).forValue((R, y, M7) => {
          const E = Object.keys(c.getStyles().get(M7 == null ? void 0 : M7.s) || {});
          (M7 != null && M7.p || E.length && DC.some((T) => E.includes(T))) && g.push({ startRow: R, endRow: R, startColumn: y, endColumn: y });
        });
      }
    });
    const m2 = this._getAutoHeightUndoRedos(i, o, g);
    return m2.redos.every((w) => this._commandService.syncExecuteCommand(w.id, w.params)) && (d.push(...m2.undos), u.push(...m2.redos)), h && (this._prevUndos = d, this._undoRedoService.pushUndoRedo({
      unitID: i,
      undoMutations: d,
      redoMutations: u
    })), a.forEach((w) => {
      var C;
      (C = w.onAfterFillData) == null || C.call(w, { source: t8, target: n, unitId: i, subUnitId: o }, s, e);
    }), this.setShowMenu(true), true;
  }
  _getAutoHeightUndoRedos(e, t8, n) {
    var d, u;
    const i = (d = this._renderManagerService.getRenderById(e)) == null ? void 0 : d.with(ue), o = (u = i == null ? void 0 : i.getCurrentParam()) == null ? void 0 : u.skeleton;
    if (!o) return { redos: [], undos: [] };
    const s = o.calculateAutoHeightInRange(n), l = { subUnitId: t8, unitId: e, rowsAutoHeightInfo: s }, a = o.worksheet, c = gh(l, a);
    return {
      undos: [{ id: Xo.id, params: c }],
      redos: [{ id: Xo.id, params: l }]
    };
  }
};
el = s12([
  Wr(0, Ls),
  Wr(1, Qo),
  Wr(2, ME),
  Wr(3, Inject(vr)),
  Wr(4, Inject(z)),
  Wr(5, Inject(Injector))
], el);
var Hr = createIdentifier("univer.auto-fill-service");
var gr3 = {
  type: Ms.COMMAND,
  id: "sheet.command.auto-fill",
  handler: async (r, e) => {
    const t8 = r.get(Hr), n = r.get(vr), { sourceRange: i, targetRange: o } = e, s = P(n);
    if (!s) return false;
    const { subUnitId: l, unitId: a } = s;
    return t8.triggerAutoFill(a, l, i, o);
  }
};
var _o3 = {
  id: "sheet.command.auto-clear-content",
  type: Ms.COMMAND,
  handler: async (r, e) => {
    const t8 = r.get(vr), n = r.get(Ls), i = r.get(Qo), o = r.get(G), s = P(t8);
    if (!s) return false;
    const { unitId: l, subUnitId: a } = s, { clearRange: c, selectionRange: d } = e, u = {
      subUnitId: a,
      unitId: l,
      cellValue: Eu([c])
    }, h = Ae(
      r,
      u
    ), { startColumn: g, startRow: m2 } = d, f2 = {
      selections: [
        {
          primary: {
            startColumn: g,
            startRow: m2,
            endColumn: g,
            endRow: m2,
            actualRow: m2,
            actualColumn: g,
            isMerged: false,
            isMergedMainCell: false
          },
          range: {
            ...d
          }
        }
      ],
      unitId: l,
      subUnitId: a
    };
    if (n.executeCommand(ie3.id, f2), n.syncExecuteCommand(ee.id, u)) {
      const p = o.afterCommandExecute({
        id: ee.id,
        params: u
      });
      return fo(p.redos, n), i.pushUndoRedo({
        // If there are multiple mutations that form an encapsulated project, they must be encapsulated in the same undo redo element.
        // Hooks can be used to hook the code of external controllers to add new actions.
        unitID: l,
        undoMutations: [{ id: ee.id, params: h }, ...p.undos],
        redoMutations: [{ id: ee.id, params: u }, ...p.redos]
      }), true;
    }
    return false;
  }
};
function Fd2(r) {
  return r.getContextValue(gr);
}
function Ve4(r) {
  return r.getContextValue(gr) && r.getContextValue(xR) && !r.getContextValue(mE) && !r.getContextValue(PR);
}
function Sm(r) {
  return r.getContextValue(gr) && r.getContextValue(xR) && !r.getContextValue(mE) && !r.getContextValue(gE) && !r.getContextValue(PR);
}
function l1(r) {
  return r.getContextValue(gr) && r.getContextValue(xR) && r.getContextValue(mE);
}
function Ud2(r) {
  return r.getContextValue(xR) && r.getContextValue(mE);
}
function la(r) {
  return r.getContextValue(gE) && r.getContextValue(xR);
}
function jy(r) {
  return r.getContextValue(gr) && r.getContextValue(mE) && r.getContextValue(LR) && r.getContextValue(xR);
}
function mi3(r) {
  return r.getContextValue(gr) && r.getContextValue(xR) && r.getContextValue(mE) && !r.getContextValue(LR) && !r.getContextValue(DR);
}
var a13 = Object.getOwnPropertyDescriptor;
var c13 = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? a13(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var Da2 = (r, e) => (t8, n) => e(t8, n, r);
var qu2 = gm.MARK_SELECTION;
var Wi3 = createIdentifier("univer.mark-selection-service");
var tl2 = class extends Ve {
  constructor(e, t8, n) {
    super();
    _2(this, "_shapeMap", /* @__PURE__ */ new Map());
    this._currentService = e, this._renderManagerService = t8, this._themeService = n;
  }
  addShape(e, t8 = [], n = qu2) {
    var a;
    const i = this._currentService.getCurrentUnitForType(we.UNIVER_SHEET), o = (a = i.getActiveSheet()) == null ? void 0 : a.getSheetId();
    if (!o) return null;
    const s = et(), l = {
      selection: e,
      subUnitId: o,
      unitId: i.getUnitId(),
      zIndex: n,
      control: null,
      exits: t8
    };
    return this._shapeMap.set(s, l), this.refreshShapes(), s;
  }
  addShapeWithNoFresh(e, t8 = [], n = qu2) {
    var l;
    const i = this._currentService.getCurrentUnitForType(we.UNIVER_SHEET), o = (l = i.getActiveSheet()) == null ? void 0 : l.getSheetId();
    if (!o) return null;
    const s = et();
    return this._shapeMap.set(s, {
      selection: e,
      subUnitId: o,
      unitId: i.getUnitId(),
      zIndex: n,
      control: null,
      exits: t8
    }), s;
  }
  refreshShapes() {
    var i;
    const e = this._currentService.getCurrentUnitForType(we.UNIVER_SHEET);
    if (!e) return;
    const t8 = e.getUnitId(), n = (i = e.getActiveSheet()) == null ? void 0 : i.getSheetId();
    this._shapeMap.forEach((o) => {
      const { unitId: s, subUnitId: l, selection: a, control: c, zIndex: d } = o;
      if (c == null || c.dispose(), s !== t8 || l !== n)
        return;
      const u = this._renderManagerService.getRenderById(s);
      if (!u) return;
      const h = u.with(ue).getCurrentSkeleton();
      if (!h) return;
      const { scene: g } = u, { rowHeaderWidth: m2, columnHeaderHeight: f2 } = h, v2 = new Wd2(g, d, this._themeService, {
        enableAutoFill: false,
        highlightHeader: false,
        rowHeaderWidth: m2,
        columnHeaderHeight: f2
      }), p = Wt4(a, h);
      v2.updateRangeBySelectionWithCoord(p), o.control = v2;
    });
  }
  getShapeMap() {
    return this._shapeMap;
  }
  removeShape(e) {
    const t8 = this._shapeMap.get(e);
    if (!t8) return;
    const { control: n } = t8;
    n == null || n.dispose(), this._shapeMap.delete(e);
  }
  removeAllShapes() {
    for (const e of this._shapeMap.values()) {
      const { control: t8 } = e;
      t8 == null || t8.dispose();
    }
    this._shapeMap.clear();
  }
};
tl2 = c13([
  Da2(0, vr),
  Da2(1, ME),
  Da2(2, Inject(Gi))
], tl2);
function Cm2(r) {
  return {
    strokeWidth: 1.5,
    stroke: r.getColorFromTheme("primary.600"),
    fill: "rgba(178, 178, 178, 0.10)",
    widgets: {},
    strokeDash: 8
  };
}
var d1 = 10;
var u1 = 6;
function h12() {
  return et(u1);
}
function g12(r) {
  const e = r.match(/data-copy-id="([^\s]+)"/);
  return e && e[1] ? e[1] : null;
}
var m1 = class {
  constructor() {
    _2(this, "_cache", new gs(d1));
  }
  set(e, t8) {
    this._cache.set(e, t8);
  }
  get(e) {
    return this._cache.get(e);
  }
  del(e) {
    this._cache.delete(e);
  }
  clear() {
    this._cache.clear();
  }
  clearWithUnitId(e) {
    this._cache.forEach((t8, n) => {
      t8.unitId === e && this._cache.delete(n);
    });
  }
};
function nl2(r, e) {
  const t8 = e != null ? e : r.style, n = {}, i = r.tagName.toLowerCase();
  switch (i) {
    case "b":
    case "em":
    case "strong": {
      n.bl = ie.TRUE;
      break;
    }
    case "s": {
      n.st = {
        s: ie.TRUE
      };
      break;
    }
    case "u": {
      n.ul = {
        s: ie.TRUE
      };
      break;
    }
    case "i": {
      n.it = ie.TRUE;
      break;
    }
    case "sub":
    case "sup": {
      n.va = i === "sup" ? Zt.SUPERSCRIPT : Zt.SUBSCRIPT;
      break;
    }
  }
  return f1(t8, n), n;
}
function f1(r, e) {
  if (r instanceof CSSStyleDeclaration)
    for (let t8 = 0; t8 < r.length; t8++) {
      const n = r[t8], i = r.getPropertyValue(n);
      Qu3(n, i, e);
    }
  else
    for (const t8 in r) {
      const n = r[t8];
      Qu3(t8, n, e);
    }
}
function Qu3(r, e, t8) {
  switch (r) {
    case "font-family":
      t8.ff = e;
      break;
    case "font-size": {
      const n = Number.parseInt(e);
      Number.isNaN(n) || (e.endsWith("pt") ? t8.fs = n : e.endsWith("px") && (t8.fs = n * 0.75));
      break;
    }
    case "font-style":
      e === "italic" && (t8.it = ie.TRUE);
      break;
    case "font-weight": {
      (Number(e) > 400 || e === "bold") && (t8.bl = ie.TRUE);
      break;
    }
    case "text-decoration": {
      /underline/.test(e) ? t8.ul = { s: ie.TRUE } : /overline/.test(e) ? t8.ol = { s: ie.TRUE } : /line-through/.test(e) && (t8.st = { s: ie.TRUE });
      break;
    }
    case "color": {
      try {
        const n = new bt(e);
        n.isValid && (t8.cl = {
          rgb: n.toRgbString()
        });
      } catch {
      }
      break;
    }
    case "background-color": {
      const n = new bt(e);
      n.isValid && (t8.bg = {
        rgb: n.toRgbString()
      });
      break;
    }
  }
}
function p1(r) {
  const e = document.createElement("body");
  return e.innerHTML = r, e;
}
function wm(r) {
  const e = r.style, t8 = {};
  for (let n = 0; n < e.length; n++) {
    const i = e[n], o = e.getPropertyValue(i);
    switch (i) {
      case "margin-top": {
        const s = Number.parseInt(o);
        t8.spaceAbove = { v: /pt/.test(o) ? c3(s) : s };
        break;
      }
      case "margin-bottom": {
        const s = Number.parseInt(o);
        t8.spaceBelow = { v: /pt/.test(o) ? c3(s) : s };
        break;
      }
      case "line-height": {
        const s = Number.parseFloat(o);
        t8.lineSpacing = s;
        break;
      }
    }
  }
  return Object.getOwnPropertyNames(t8).length ? t8 : null;
}
function La2(r, e) {
  const t8 = [];
  for (let n = 0, i = r.length; n < i; n++)
    r[n] === ct.PARAGRAPH && t8.push({
      startIndex: n
    });
  return t8;
}
function Ku3(r, e, t8) {
  var s, l, a;
  const n = e.length, o = ((s = t8 == null ? void 0 : t8.length) != null ? s : 0) === 1 && t8[0].st === 0 && t8[0].ed === n;
  return r.p ? o && ((a = (l = r.p.body) == null ? void 0 : l.textRuns) != null && a.length) ? (r.p.body.textRuns = [], {
    ...r,
    s: t8[0].ts
  }) : r : o ? {
    ...r,
    s: t8[0].ts
  } : r;
}
var Ju4 = [
  // Rich Text Style Rules,
  "color",
  "background",
  "font-size",
  "text-align",
  "vertical-align",
  "font-weight",
  "font-style",
  "font-family",
  "text-decoration",
  "white-space",
  "word-wrap",
  // Border Style Rules,
  "border-left",
  "border-right",
  "border-top",
  "border-bottom",
  // Custom Style Rules, '--' needs to be used as a prefix.
  "--data-rotate"
];
function $u3(r, e) {
  const t8 = r.tagName.toLowerCase();
  return typeof e == "string" ? t8 === e : Array.isArray(e) ? e.some((n) => n === t8) : e(r);
}
var kl = class kl2 {
  constructor(e) {
    _2(this, "_styleMap", /* @__PURE__ */ new Map());
    _2(this, "_styleCache", /* @__PURE__ */ new Map());
    _2(this, "_styleRules", []);
    _2(this, "_afterProcessRules", []);
    _2(this, "_dom", null);
    _2(this, "_getCurrentSkeleton");
    this._getCurrentSkeleton = e.getCurrentSkeleton;
  }
  static use(e) {
    if (this._pluginList.includes(e))
      throw new Error(`Univer paste plugin ${e.name} already added`);
    this._pluginList.push(e);
  }
  // eslint-disable-next-line max-lines-per-function
  convert(e) {
    const t8 = kl2._pluginList.find((f2) => f2.checkPasteType(e));
    t8 && (this._styleRules = [...t8.stylesRules], this._afterProcessRules = [...t8.afterProcessRules]);
    const n = new pt();
    this._dom = p1(e);
    const i = this._dom.querySelector("style");
    if (i) {
      const f2 = document.createElement("div"), v2 = f2.attachShadow({ mode: "open" });
      document.body.appendChild(f2), v2.appendChild(i);
      for (const p of i.sheet.cssRules) {
        const S = p, w = S.selectorText, C = S.style;
        this._styleMap.set(w, C);
      }
      i.remove(), f2.remove();
    }
    const o = {
      dataStream: "",
      textRuns: []
    }, s = [], l = [], a = e.match(/<table\b[^>]*>([\s\S]*?)<\/table>/gi), c = [];
    this.process(null, this._dom.childNodes, o, c);
    const { paragraphs: d, dataStream: u, textRuns: h, payloads: g, customRanges: m2 } = o;
    if (d) {
      const f2 = d.map((v2) => v2.startIndex + 1);
      f2.unshift(0);
      for (let v2 = 0; v2 < f2.length; v2++) {
        let p;
        if (v2 === f2.length - 1) {
          if (p = `${u.substring(f2[v2])}\r
`, p === `\r
`)
            continue;
        } else
          p = `${u.substring(f2[v2], f2[v2 + 1] - 1)}\r
`;
        const S = [];
        h == null || h.forEach((R) => {
          R.st >= f2[v2] && R.ed <= f2[v2 + 1] && S.push({
            st: R.st - f2[v2],
            ed: R.ed - f2[v2],
            ts: R.ts
          });
        });
        const w = [];
        m2 == null || m2.forEach((R) => {
          R.startIndex >= f2[v2] && R.endIndex <= f2[v2 + 1] && w.push({
            ...R,
            startIndex: R.startIndex - f2[v2],
            endIndex: R.endIndex - f2[v2]
          });
        });
        const C = this._generateDocumentDataModelSnapshot({
          body: {
            dataStream: p,
            textRuns: S,
            paragraphs: La2(p),
            customRanges: w
          }
        }), I2 = Object.keys(n.getMatrix()).length === 0;
        n.setValue(I2 ? 0 : n.getLength(), 0, {
          v: p,
          p: C
        }), s.push({});
      }
    } else if (u) {
      const f2 = `${u}\r
`, v2 = {
        dataStream: f2,
        textRuns: h,
        paragraphs: La2(f2),
        payloads: g,
        customRanges: m2
      };
      if (!(m2 != null && m2.length))
        n.setValue(0, 0, Ku3({ v: u }, u, h));
      else {
        const p = this._generateDocumentDataModelSnapshot({
          body: v2
        });
        n.setValue(0, 0, Ku3({ v: u, p }, u, h));
      }
      s.push({});
    }
    return a && a.forEach((f2, v2) => {
      const p = n.getDataRange().endRow + 1, { cellMatrix: S, rowProperties: w, colProperties: C } = this._parseTable(f2, v2);
      S && S.forValue((I2, R, y) => {
        n.setValue(p + I2, R, y);
      }), C && l.push(...C), s.push(...w);
    }), this.dispose(), {
      rowProperties: s,
      colProperties: l,
      cellMatrix: n
    };
  }
  _getStyleBySelectorText(e, t8) {
    var i;
    const n = (i = this._styleMap.get(e)) == null ? void 0 : i.getPropertyValue(t8);
    return n || "";
  }
  _getStyle(e, t8) {
    const n = eh2(t8), i = e.style;
    let o = "";
    for (let s = 0; s < Ju4.length; s++) {
      const l = Ju4[s];
      if (l === "background") {
        let c = "";
        e.classList.forEach((u) => {
          c = this._getStyleBySelectorText(`.${u}`, "background-color") || this._getStyleBySelectorText(`.${u}`, l);
        });
        const d = i.getPropertyValue("background-color") || c || this._getStyleBySelectorText(`#${e.id}`, "background-color") || this._getStyleBySelectorText(`#${e.id}`, l) || this._getStyleBySelectorText(e.nodeName.toLowerCase(), l) || this._getStyleBySelectorText(e.nodeName, "background-color") || n["background-color"] || "";
        d && (o += `background:${d};`);
        continue;
      }
      if (l === "text-decoration") {
        let c = "";
        e.classList.forEach((u) => {
          c = this._getStyleBySelectorText(`.${u}`, "text-decoration-line") || this._getStyleBySelectorText(`.${u}`, l);
        });
        const d = i.getPropertyValue("text-decoration-line") || i.getPropertyValue("text-decoration") || c || this._getStyleBySelectorText(`#${e.id}`, "text-decoration-line") || this._getStyleBySelectorText(`#${e.id}`, l) || this._getStyleBySelectorText(e.nodeName.toLowerCase(), l) || this._getStyleBySelectorText(e.nodeName, "text-decoration-line") || n["text-decoration-line"] || "";
        d && (o += `text-decoration:${d};`);
        continue;
      }
      let a = "";
      e.classList.forEach((c) => {
        a = this._getStyleBySelectorText(`.${c}`, l);
      }), a = i.getPropertyValue(l) || this._getStyleBySelectorText(`#${e.id}`, l) || a || this._getStyleBySelectorText(e.nodeName.toLowerCase(), l) || n[l] || "", a && (o += `${l}:${a};`);
    }
    return o;
  }
  _parseTable(e, t8) {
    var l, a;
    const n = new pt(), i = (l = S12(e)) != null ? l : [], { rowProperties: o = [] } = v12(e), s = this._parseTableByHtml(this._dom, t8, (a = this._getCurrentSkeleton()) == null ? void 0 : a.skeleton);
    return s && s.forValue((c, d, u) => {
      var m2, f2, v2, p, S, w, C, I2, R, y, M7, E, T, P2, H3, A, x7, V2, D2, X2, B, j, G7, ge2;
      let h = dt(void 0, u.style);
      if ((p = (v2 = (f2 = (m2 = u == null ? void 0 : u.richTextParma) == null ? void 0 : m2.p) == null ? void 0 : f2.body) == null ? void 0 : v2.textRuns) != null && p.length) {
        const Re3 = (w = (S = u == null ? void 0 : u.richTextParma) == null ? void 0 : S.v) == null ? void 0 : w.length;
        for (let be2 = 0; be2 < ((y = (R = (I2 = (C = u == null ? void 0 : u.richTextParma) == null ? void 0 : C.p) == null ? void 0 : I2.body) == null ? void 0 : R.textRuns) == null ? void 0 : y.length); be2++) {
          const Ne3 = (T = (E = (M7 = u == null ? void 0 : u.richTextParma) == null ? void 0 : M7.p) == null ? void 0 : E.body) == null ? void 0 : T.textRuns[be2];
          Ne3.st === 0 && Ne3.ed === Re3 && (h = { ...Ne3.ts, ...h }, (A = (H3 = (P2 = u == null ? void 0 : u.richTextParma) == null ? void 0 : P2.p) == null ? void 0 : H3.body) == null || A.textRuns.splice(be2, 1), be2--);
        }
        ((X2 = (D2 = (V2 = (x7 = u == null ? void 0 : u.richTextParma) == null ? void 0 : x7.p) == null ? void 0 : V2.body) == null ? void 0 : D2.textRuns) == null ? void 0 : X2.length) === 0 && (u.content = (B = u == null ? void 0 : u.richTextParma) == null ? void 0 : B.v, delete u.richTextParma);
      }
      const g = (ge2 = (G7 = (j = u == null ? void 0 : u.richTextParma) == null ? void 0 : j.p) == null ? void 0 : G7.body) != null && ge2.textRuns ? {
        v: u.richTextParma.v,
        p: u.richTextParma.p,
        s: h,
        rowSpan: u.rowSpan,
        colSpan: u.colSpan
      } : {
        v: u.content,
        s: h,
        rowSpan: u.rowSpan,
        colSpan: u.colSpan
      };
      n.setValue(c, d, g);
    }), {
      rowProperties: o,
      colProperties: i,
      cellMatrix: n
    };
  }
  _parseTableByHtml(e, t8, n) {
    var a, c;
    const i = new pt(), o = e.querySelectorAll("table")[t8];
    if (!o)
      return i;
    const s = this._getStyle(o, ""), l = o == null ? void 0 : o.querySelectorAll("tr");
    for (let d = 0; d < l.length; d++) {
      const u = l[d], h = this._getStyle(u, s), g = u.querySelectorAll("td, th");
      let m2 = 0;
      for (let f2 = 0; f2 < g.length; ) {
        const v2 = g[f2];
        let p = "";
        const S = Number(v2.getAttribute("rowSpan")) || 1, w = Number(v2.getAttribute("colSpan")) || 1;
        if (p = this._getStyle(v2, h), d > 0) {
          const y = i.getValue(d - 1, m2);
          if ((a = y == null ? void 0 : y.style) != null && a.includes("border-bottom") && p.includes("border-top")) {
            const M7 = th2(y.style, "border-bottom");
            M7 && O32(M7.substr(M7.indexOf(":") + 1)) !== "none" && (p = p.replace(/border-top:[^;]+;/, ""));
          }
        }
        if (f2 > 0) {
          const y = i.getValue(d, m2 - 1);
          if ((c = y == null ? void 0 : y.style) != null && c.includes("border-right") && p.includes("border-left")) {
            const M7 = th2(y.style, "border-right");
            M7 && O32(M7.substr(M7.indexOf(":") + 1)) !== "none" && (p = p.replace(/border-left:[^;]+;/, ""));
          }
        }
        const { cellText: C, cellRichStyle: I2 } = this._getCellTextAndRichText(v2, p, n), R = {
          rowSpan: S,
          colSpan: w,
          content: C,
          style: p,
          richTextParma: {
            p: I2,
            v: C
          }
        };
        if (i.getValue(d, m2)) {
          m2 += 1;
          continue;
        } else
          S > 1 || w > 1 ? w12(i, p, R, { colSpan: w, rowSpan: S, rowIndex: d, colSetValueIndex: m2 }) : i.setValue(d, m2, R), m2 += w, f2++;
      }
    }
    return i;
  }
  _parseCellHtml(e, t8, n, i = /* @__PURE__ */ new Map(), o) {
    var s;
    for (const l of t8)
      if (l.nodeType === Node.TEXT_NODE) {
        const a = (s = l.nodeValue) == null ? void 0 : s.replace(/[\r\n]/g, "");
        let c;
        e && i.has(e) && (c = i.get(e)), n.dataStream += a, c && Object.getOwnPropertyNames(c).length && n.textRuns.push({
          st: n.dataStream.length - a.length,
          ed: n.dataStream.length,
          ts: c
        });
      } else {
        if (l.nodeType === Node.COMMENT_NODE || l.nodeName === "STYLE")
          continue;
        if (l.nodeName.toLowerCase() === "br")
          n.paragraphs || (n.paragraphs = []), n.paragraphs.push({ startIndex: n.dataStream.length }), n.dataStream += "\r";
        else if (l.nodeType === Node.ELEMENT_NODE) {
          const a = this._getStyle(l, o), c = e ? i.get(e) : {}, d = eh2(a), u = nl2(l, d);
          i.set(l, { ...c, ...u });
          const { childNodes: h } = l;
          this._parseCellHtml(l, h, n, i, a);
        }
      }
  }
  _getCellTextAndRichText(e, t8, n) {
    var l;
    if (e.innerHTML.includes("mso-spacerun:yes")) {
      const a = e.innerHTML.replace(/<span[^>]*mso-spacerun:yes[^>]*>[\s\S]*?<\/span>/gi, ""), c = eR.parseNumber(a);
      if (c && c.v !== void 0 && c.v !== null)
        return {
          cellText: a,
          cellRichStyle: void 0
        };
    }
    let i = "", o;
    if (/<[^>]+>/.test(e.innerHTML) && n) {
      const a = {
        dataStream: "",
        textRuns: []
      };
      this._parseCellHtml(null, e.childNodes, a, void 0, t8);
      const c = (l = n.getBlankCellDocumentModel()) == null ? void 0 : l.documentModel, d = c == null ? void 0 : c.getSnapshot(), u = `${a.dataStream}\r
`, h = {
        ...d,
        body: {
          dataStream: u,
          textRuns: a.textRuns,
          paragraphs: La2(u)
        }
      };
      c == null || c.reset(h), o = c == null ? void 0 : c.getSnapshot(), i = a.dataStream;
    } else
      i = C1(e.innerHTML.replace(/[\r\n]/g, ""));
    return {
      cellText: i,
      cellRichStyle: o
    };
  }
  _generateDocumentDataModelSnapshot(e) {
    var l;
    const t8 = this._getCurrentSkeleton();
    if (t8 == null)
      return null;
    const { skeleton: n } = t8, i = (l = n.getBlankCellDocumentModel()) == null ? void 0 : l.documentModel, s = { ...i == null ? void 0 : i.getSnapshot(), ...e };
    return i == null || i.reset(s), i == null ? void 0 : i.getSnapshot();
  }
  process(e, t8, n, i) {
    var o, s, l;
    for (const a of t8)
      if (a.nodeName.toLowerCase() === "table")
        i.push({
          index: ((o = n == null ? void 0 : n.paragraphs) == null ? void 0 : o.length) || 0
        });
      else if (a.nodeType === Node.TEXT_NODE) {
        if (((s = a.nodeValue) == null ? void 0 : s.trim()) === "")
          continue;
        const c = (l = a.nodeValue) == null ? void 0 : l.replace(/[\r\n]/g, "");
        let d;
        e && this._styleCache.has(e) && (d = this._styleCache.get(e));
        const u = {
          dataStream: "",
          textRuns: []
        };
        n.dataStream += c, u.dataStream += c, d && Object.getOwnPropertyNames(d).length && (n.textRuns.push({
          st: n.dataStream.length - c.length,
          ed: n.dataStream.length,
          ts: d
        }), u.textRuns.push({
          st: n.dataStream.length - c.length,
          ed: n.dataStream.length,
          ts: d
        }));
      } else {
        if (rI.includes(a.nodeName.toLowerCase()))
          continue;
        if (a.nodeName.toLowerCase() === "br")
          n.paragraphs || (n.paragraphs = []), n.paragraphs.push({ startIndex: n.dataStream.length }), n.dataStream += "\r";
        else if (a.nodeType === Node.ELEMENT_NODE) {
          if (a.nodeName === "STYLE")
            continue;
          const c = a, d = this._processBeforeLink(c, { body: n }), u = e ? this._styleCache.get(e) : {}, h = this._styleRules.find(({ filter: v2 }) => $u3(a, v2)), g = h ? h.getStyle(a) : nl2(a);
          this._styleCache.set(a, { ...u, ...g });
          const { childNodes: m2 } = a;
          this.process(a, m2, n, i);
          const f2 = this._afterProcessRules.find(
            ({ filter: v2 }) => $u3(a, v2)
          );
          f2 && f2.handler(n, a), this._processAfterLink(c, { body: n }, d);
        }
      }
  }
  _processBeforeLink(e, t8) {
    return t8.body.dataStream.length;
  }
  _processAfterLink(e, t8, n) {
    var s, l;
    const i = t8.body, o = e;
    o.tagName.toUpperCase() === "A" && (i.customRanges = (s = i.customRanges) != null ? s : [], i.customRanges.push({
      startIndex: n,
      endIndex: i.dataStream.length - 1,
      rangeId: (l = o.dataset.rangeid) != null ? l : et(),
      rangeType: pn.HYPERLINK,
      properties: { url: o.href }
    }));
  }
  dispose() {
    this._dom = null, this._styleCache.clear(), this._styleMap.clear();
  }
};
_2(kl, "_pluginList", []);
var fi3 = kl;
function v12(r) {
  const e = /<tr([\s\S]*?)>([\s\S]*?)<\/tr>/gi, t8 = r.matchAll(e);
  if (!t8)
    return {
      rowProperties: [],
      rowCount: 0
    };
  const i = Array.from(t8).map((o) => bm(o[1])).map((o) => {
    if (!o.height) {
      const s = o.style, l = s && s.match(/height\s*:\s*(\d+(\.\d+)?)px/);
      o.height = `${l ? Number.parseInt(l[1], 10) : xE}`;
    }
    return o;
  });
  return {
    rowProperties: i,
    rowCount: i.length
  };
}
function eh2(r) {
  const e = {};
  return r.split(";").forEach((n) => {
    const [i, o] = n.split(":");
    e[i] = o;
  }), e;
}
function bm(r) {
  if (!r)
    return {};
  const e = {}, t8 = /([\w-]+)\s*=\s*(?:(['"])([^'"]*)\2|(\S+))/g;
  let n;
  for (; (n = t8.exec(r)) !== null; ) {
    const [, i, , o, s] = n, l = o !== void 0 ? o : s;
    e[i] = l;
  }
  return e;
}
function S12(r) {
  const e = /<colgroup([\s\S]*?)>(.*?)<\/colgroup>/, t8 = r.match(e), n = /<col([\s\S]*?)>/g;
  let i;
  if (t8 != null && t8[2] ? i = t8[2].matchAll(n) : i = r.matchAll(n), !i)
    return null;
  const o = Array.from(i).map((l) => bm(l[1])), s = [];
  return o.forEach((l) => {
    const a = Number(l.span);
    if (a)
      for (let c = 0; c < a; c++) {
        const d = { ...l };
        delete d.span, s.push(d);
      }
    else
      s.push(l);
  }), s;
}
function C1(r) {
  const e = {
    "&lt;": "<",
    "&gt;": ">",
    "&amp;": "&",
    "&quot;": '"',
    "&#39;": "'",
    "&nbsp;": " "
  };
  return r.replace(/&lt;|&gt;|&amp;|&quot;|&#39;|&nbsp;|<br>/g, (t8) => e[t8]);
}
function th2(r, e) {
  if (!r || !e) return null;
  const t8 = new RegExp(`(${e}\\s*:\\s*[^;]+);`, "i"), n = r.match(t8);
  return n ? n[1] : null;
}
function w12(r, e, t8, n) {
  const { rowSpan: i, colSpan: o, rowIndex: s, colSetValueIndex: l } = n;
  for (let a = s; a < s + i; a++)
    for (let c = l; c < l + o; c++)
      a === s && c === l ? r.setValue(a, c, { ...t8, style: e }) : r.setValue(a, c, { style: e });
}
var b1 = {
  name: "univer-doc-paste-plugin-lark",
  checkPasteType(r) {
    return /lark-record-clipboard/i.test(r);
  },
  // TODO: @JOCS, support inline code copy from lark.
  stylesRules: [
    {
      filter: ["s"],
      getStyle(r) {
        const e = nl2(r);
        return {
          st: {
            s: ie.TRUE
          },
          ...e
        };
      }
    }
  ],
  afterProcessRules: [
    {
      filter(r) {
        return r.tagName === "DIV" && /ace-line/i.test(r.className);
      },
      handler(r) {
        r.paragraphs == null && (r.paragraphs = []), r.paragraphs.push({
          startIndex: r.dataStream.length
        }), r.dataStream += "\r";
      }
    }
  ]
};
var _13 = {
  name: "univer-doc-paste-plugin-univer",
  checkPasteType(r) {
    return /UniverNormal/i.test(r);
  },
  stylesRules: [],
  afterProcessRules: [
    {
      filter(r) {
        return r.tagName === "P" && /UniverNormal/i.test(r.className);
      },
      handler(r, e) {
        r.paragraphs == null && (r.paragraphs = []);
        const t8 = {
          startIndex: r.dataStream.length
        }, n = wm(e);
        n && (t8.paragraphStyle = n), r.paragraphs.push(t8), r.dataStream += "\r";
      }
    }
  ]
};
var R1 = {
  name: "univer-doc-paste-plugin-word",
  checkPasteType(r) {
    return /word|mso/i.test(r);
  },
  stylesRules: [
    {
      filter: ["b"],
      getStyle(r) {
        const e = nl2(r);
        return { bl: ie.TRUE, ...e };
      }
    }
  ],
  afterProcessRules: [
    {
      filter(r) {
        return r.tagName === "P" && /mso/i.test(r.className);
      },
      handler(r, e) {
        r.paragraphs == null && (r.paragraphs = []);
        const t8 = {
          startIndex: r.dataStream.length
        }, n = wm(e);
        n && (t8.paragraphStyle = n), r.paragraphs.push(t8), r.dataStream += "\r";
      }
    }
  ]
};
var Yn3 = ((r) => (r.COPY = "COPY", r.CUT = "CUT", r))(Yn3 || {});
function I14(r, e, t8, n, i) {
  const o = t8.map((c) => {
    var d;
    return (d = c.onCopyRow) == null ? void 0 : d.call(c, r);
  }).filter((c) => !!c), s = Xd2(o), l = zd2(s), a = e.map((c) => {
    if (!i.has(`${r}-${c}`)) {
      const d = n.getValue(r, c);
      if (d != null && d.rowSpan && (d != null && d.colSpan))
        for (let u = r; u < r + d.rowSpan; u++)
          for (let h = c; h < c + d.colSpan; h++)
            i.add(`${u}-${h}`);
      return y1(r, c, t8, n);
    }
    return null;
  }).filter((c) => !!c).join("");
  return `<tr${l}>${a}</tr>`;
}
function y1(r, e, t8, n) {
  const i = n.getValue(r, e), o = t8.map((c) => {
    var d;
    return (d = c.onCopyCellStyle) == null ? void 0 : d.call(c, r, e, i == null ? void 0 : i.rowSpan, i == null ? void 0 : i.colSpan);
  }).filter((c) => !!c), s = Xd2(o), l = zd2(s), a = t8.reduce((c, d) => {
    var u;
    return c || ((u = d.onCopyCellContent) == null ? void 0 : u.call(d, r, e)) || "";
  }, "");
  return `<td${l}>${a}</td>`;
}
function M12(r, e) {
  return `<colgroup>${r.map((n) => {
    const i = e.map((l) => {
      var a;
      return (a = l.onCopyColumn) == null ? void 0 : a.call(l, n);
    }).filter((l) => !!l), o = Xd2(i);
    return `<col ${zd2(o)} />`;
  }).join("")}</colgroup>`;
}
function Xd2(r) {
  return r.reduce((e, t8) => (Object.keys(t8).forEach((i) => {
    e[i] ? e[i] += `;${t8[i]}` : e[i] = t8[i];
  }), e), {});
}
function zd2(r) {
  return Object.keys(r).reduce((e, t8) => `${e} ${t8}="${r[t8]}"`, "");
}
var E12 = class {
  convert(e, t8, n) {
    const { cols: i, rows: o } = t8;
    if (!i.length)
      return "";
    const s = M12(i, n), l = [], a = /* @__PURE__ */ new Set();
    return o.forEach((d) => {
      l.push(I14(d, i, n, e, a));
    }), `<google-sheets-html-origin><table xmlns="http://www.w3.org/1999/xhtml" cellspacing="0" cellpadding="0" dir="ltr" style="table-layout:fixed;font-size:10pt;font-family:Arial;width:0px;border-collapse:collapse;border:none">${s}
<tbody>${l.join("")}</tbody></table>`;
  }
};
var Yy2 = (r, e, t8 = false) => {
  const n = (u) => u.endRow - u.startRow + 1, i = (u) => u.endColumn - u.startColumn + 1, o = n(e) % n(r), s = i(e) % i(r), l = {
    startRow: 0,
    endRow: n(r) - 1,
    startColumn: 0,
    endColumn: i(r) - 1
  }, a = Math.floor(n(e) / n(r)), c = Math.floor(i(e) / i(r)), d = [];
  if (!o && !s)
    for (let u = 1; u <= a; u++)
      for (let h = 1; h <= c; h++) {
        const g = n(r) * (u - 1), m2 = i(r) * (h - 1), f2 = {
          startRow: g + e.startRow,
          endRow: g + e.startRow,
          startColumn: m2 + e.startColumn,
          endColumn: m2 + e.startColumn
        };
        d.push({ repeatRelativeRange: l, startRange: f2 });
      }
  else if (!o && s && !t8)
    for (let u = 1; u <= a; u++) {
      const h = n(r) * (u - 1), g = 0, m2 = {
        startRow: h + e.startRow,
        endRow: h + e.startRow,
        startColumn: g + e.startColumn,
        endColumn: g + e.startColumn
      };
      d.push({ repeatRelativeRange: l, startRange: m2 });
    }
  else if (o && !s && !t8)
    for (let u = 1; u <= c; u++) {
      const g = i(r) * (u - 1), m2 = {
        startRow: 0 + e.startRow,
        endRow: 0 + e.startRow,
        startColumn: g + e.startColumn,
        endColumn: g + e.startColumn
      };
      d.push({ repeatRelativeRange: l, startRange: m2 });
    }
  else {
    const u = {
      startRow: e.startRow,
      endRow: e.startRow,
      startColumn: e.startColumn,
      endColumn: e.startColumn
    };
    d.push({ startRange: u, repeatRelativeRange: l });
  }
  return d;
};
function nh2(r) {
  return r ? [
    // Excel class names
    /<td[^>]*class=".*?xl.*?"[^>]*>/i,
    // Excel namespace
    /xmlns:x="urn:schemas-microsoft-com:office:excel"/i,
    // Excel ProgID
    /ProgId="Excel.Sheet"/i,
    // Office specific namespace
    /xmlns:o="urn:schemas-microsoft-com:office:office"/i,
    // Excel specific style markers
    /@mso-|mso-excel/i,
    // Excel workbook metadata
    /<x:ExcelWorkbook>/i
  ].some((t8) => t8.test(r)) : false;
}
function T1(r) {
  if (!r)
    return false;
  const e = /<img[^>]*src\s*=\s*["']data:image\/[^;]+;base64,[^"']*["'][^>]*>/i;
  return (r.match(e) || []).length > 0;
}
function P1(...r) {
  if (r.length === 1)
    return r[0];
  const e = new pt();
  return r.forEach((t8) => {
    t8 && new pt(t8).forValue((i, o, s) => {
      e.setValue(i, o, { ...e.getValue(i, o), ...s });
    });
  }), e.getMatrix();
}
function x12(r, e) {
  return r.id === e.id && r.params.unitId === e.params.unitId && r.params.subUnitId === e.params.subUnitId;
}
function rh2(r) {
  const e = [];
  for (let t8 = 0; t8 < r.length; ) {
    let n = 1;
    if (r[t8].id === ee.id) {
      const i = r[t8], o = [i];
      for (; t8 + n < r.length && x12(i, r[t8 + n]); )
        o.push(r[t8 + n]), n += 1;
      const s = P1(...o.map((l) => l.params.cellValue || {}));
      e.push({
        ...i,
        params: {
          ...i.params,
          cellValue: s
        }
      });
    } else
      e.push(r[t8]);
    t8 += n;
  }
  return e;
}
function Wa2(r, e) {
  const { startRow: t8, endRow: n, startColumn: i, endColumn: o } = r;
  for (let s = t8; s <= n; s++)
    for (let l = i; l <= o; l++)
      if (e.rows.includes(s) && e.cols.includes(l))
        return true;
}
function ih2(r, e) {
  const { startRow: t8, endRow: n, startColumn: i, endColumn: o } = e;
  for (let s = t8; s <= n; s++)
    if (!r.rows.includes(s))
      return false;
  for (let s = i; s <= o; s++)
    if (!r.cols.includes(s))
      return false;
  return true;
}
function O1(r) {
  const e = r.trim().split(`
`);
  let t8 = "<table>";
  return e.forEach((n) => {
    const i = n.split("	");
    t8 += "<tr>", i.forEach((o) => {
      t8 += `<td>${o}</td>`;
    }), t8 += "</tr>";
  }), t8 += "</table>", t8;
}
var A1 = Object.getOwnPropertyDescriptor;
var H12 = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? A1(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var Pt4 = (r, e) => (t8, n) => e(t8, n, r);
var et3 = {
  DEFAULT_COPY: "default-copy",
  DEFAULT_PASTE: "default-paste",
  SPECIAL_PASTE_VALUE: "special-paste-value",
  SPECIAL_PASTE_FORMAT: "special-paste-format",
  SPECIAL_PASTE_COL_WIDTH: "special-paste-col-width",
  SPECIAL_PASTE_BESIDES_BORDER: "special-paste-besides-border",
  SPECIAL_PASTE_FORMULA: "special-paste-formula"
};
var V12 = {
  [Oo]: "png",
  [$o]: "jpg",
  [No]: "webp",
  [Eo2]: "bmp"
};
fi3.use(R1);
fi3.use(b1);
fi3.use(_13);
var nn2 = createIdentifier("sheet.clipboard-service");
var rl2 = class extends Ve {
  constructor(e, t8, n, i, o, s, l, a, c, d, u, h, g, m2) {
    super();
    _2(this, "_clipboardHooks", []);
    _2(this, "_clipboardHooks$", new BehaviorSubject([]));
    _2(this, "clipboardHooks$", this._clipboardHooks$.asObservable());
    _2(this, "_htmlToUSM");
    _2(this, "_usmToHtml");
    _2(this, "_copyContentCache");
    _2(this, "_copyMarkId", null);
    _2(this, "_pasteOptionsCache$", new BehaviorSubject(null));
    _2(this, "pasteOptionsCache$", this._pasteOptionsCache$.asObservable());
    _2(this, "_showMenu$", new BehaviorSubject(false));
    _2(this, "showMenu$", this._showMenu$.asObservable());
    this._logService = e, this._univerInstanceService = t8, this._selectionManagerService = n, this._clipboardInterfaceService = i, this._undoRedoService = o, this._commandService = s, this._markSelectionService = l, this._notificationService = a, this._platformService = c, this._renderManagerService = d, this._themeService = u, this._localeService = h, this._errorService = g, this._injector = m2, this._htmlToUSM = new fi3({
      getCurrentSkeleton: () => {
        var f2;
        return (f2 = eA(
          we.UNIVER_SHEET,
          ue,
          this._univerInstanceService,
          this._renderManagerService
        )) == null ? void 0 : f2.getCurrentParam();
      }
    }), this._usmToHtml = new E12(), this._copyContentCache = new m1(), this.disposeWithMe(this._htmlToUSM), this._initUnitDisposed();
  }
  setShowMenu(e) {
    this._showMenu$.next(e);
  }
  getPasteMenuVisible() {
    return this._showMenu$.getValue();
  }
  getPasteOptionsCache() {
    return this._pasteOptionsCache$.getValue();
  }
  copyContentCache() {
    return this._copyContentCache;
  }
  generateCopyContent(e, t8, n, i = Yn3.COPY) {
    const o = this._clipboardHooks;
    o.forEach((l) => {
      var a;
      return (a = l.onBeforeCopy) == null ? void 0 : a.call(l, e, t8, n, i);
    });
    const s = this._generateCopyContent(e, t8, n, this._clipboardHooks);
    return o.forEach((l) => {
      var a;
      return (a = l.onAfterCopy) == null ? void 0 : a.call(l);
    }), s;
  }
  async copy(e = Yn3.COPY) {
    const t8 = this._selectionManagerService.getCurrentLastSelection();
    if (!t8)
      return false;
    const n = this._univerInstanceService.getCurrentUnitForType(we.UNIVER_SHEET), i = n.getActiveSheet();
    if (!i)
      return false;
    const o = n.getUnitId(), s = i.getSheetId(), l = this.generateCopyContent(o, s, t8.range);
    if (!l)
      return false;
    const { html: a, plain: c, matrixFragment: d, copyId: u, discreteRange: h } = l;
    this._copyContentCache.set(u, {
      unitId: n.getUnitId(),
      subUnitId: i.getSheetId(),
      range: h,
      matrix: d,
      copyType: e
    }), await this._clipboardInterfaceService.write(c, a), this._markSelectionService.removeAllShapes();
    const g = Cm2(this._themeService);
    return this._copyMarkId = this._markSelectionService.addShape({ ...t8, style: g }), true;
  }
  async cut() {
    return this.copy(Yn3.CUT);
  }
  async paste(e, t8 = et3.DEFAULT_PASTE) {
    const n = e.types, i = n.indexOf(Qt4) !== -1 ? await e.getType(Qt4).then((a) => a && a.text()) : "", o = n.indexOf(Kt) !== -1 ? await e.getType(Kt).then((a) => a && a.text()) : "", s = n.findIndex((a) => e7.has(a)), l = s === -1 || !T1(o);
    if (o && l)
      return this._platformService.isWindows && nh2(o) && this._notificationService.show({
        type: "warning",
        title: this._localeService.t("clipboard.shortCutNotify.title"),
        content: this._localeService.t("clipboard.shortCutNotify.useShortCutInstead")
      }), this._pasteHTML(o, t8);
    if (s !== -1) {
      const a = n[s], c = await e.getType(a);
      if (c) {
        const d = V12[a], u = new File(
          [c],
          `clipboard-image.${d}`,
          { type: a }
        );
        return this._pasteFiles([u], t8);
      }
    }
    return i ? this._pastePlainText(i, t8) : (this._logService.error("[SheetClipboardService]", "No valid data on clipboard"), false);
  }
  async legacyPaste(e, t8, n) {
    const i = nh2(e != null ? e : "");
    return n && !i ? this._pasteFiles(n, et3.DEFAULT_PASTE) : e ? this._pasteHTML(e, et3.DEFAULT_PASTE) : t8 ? /[\n\t]/.test(t8) ? this._pasteHTML(O1(t8), et3.DEFAULT_PASTE) : this._pastePlainText(t8, et3.DEFAULT_PASTE) : this._pasteUnrecognized();
  }
  rePasteWithPasteType(e) {
    const t8 = this._pasteOptionsCache$.getValue();
    if (!t8)
      return false;
    const n = this._injector.get(Qo), i = n.pitchTopUndoElement();
    i && fo(i.undoMutations, this._commandService) && n.popUndoToRedo();
    const { cellMatrix: o, rowProperties: s = [], colProperties: l = [], source: a, target: c } = t8;
    return this._pasteUSM({
      cellMatrix: o,
      colProperties: l,
      rowProperties: s
    }, c, et3[e], a), true;
  }
  updatePasteOptionsCache(e) {
    this._pasteOptionsCache$.next(e);
  }
  addClipboardHook(e) {
    if (this._clipboardHooks.findIndex((n) => n.id === e.id) !== -1)
      return this._logService.error("[SheetClipboardService]", "hook already exists", e.id), { dispose: () => {
      } };
    const t8 = this._clipboardHooks.findIndex((n) => {
      const i = n.priority || 0;
      return (e.priority || 0) < i;
    });
    return this._clipboardHooks.splice(t8 !== -1 ? t8 : this._clipboardHooks.length, 0, e), this._notifyClipboardHook(), We(() => {
      const n = this._clipboardHooks.indexOf(e);
      n > -1 && (this._clipboardHooks.splice(n, 1), this._notifyClipboardHook());
    });
  }
  getClipboardHooks() {
    return this._clipboardHooks;
  }
  _generateCopyContent(e, t8, n, i) {
    const o = this._univerInstanceService.getUniverSheetInstance(e), s = o == null ? void 0 : o.getSheetBySheetId(t8);
    if (!o || !s)
      return null;
    const l = i.reduce((C, I2) => {
      var y;
      const R = (y = I2.getFilteredOutRows) == null ? void 0 : y.call(I2, n);
      return R == null || R.forEach((M7) => C.add(M7)), C;
    }, /* @__PURE__ */ new Set()), { startColumn: a, startRow: c, endColumn: d, endRow: u } = n, h = s.getMatrixWithMergedCells(c, a, u, d, or.Both), g = new pt();
    let m2 = c;
    const f2 = new pt(), v2 = { rows: [], cols: [] };
    for (let C = c; C <= u; C++)
      if (!l.has(C)) {
        v2.rows.push(C);
        for (let I2 = a; I2 <= d; I2++) {
          const R = h.getValue(C, I2);
          if (R) {
            const y = J.deepClone(R);
            f2.setValue(m2 - c, I2 - a, {
              ...Gi3(),
              ...y
            }), delete y.displayV, g.setValue(m2 - c, I2 - a, {
              ...Gi3(),
              ...y
            });
          } else
            f2.setValue(m2 - c, I2 - a, Gi3()), g.setValue(m2 - c, I2 - a, Gi3()), h.setValue(C, I2, Gi3());
        }
        m2 += 1;
      }
    for (let C = a; C <= d; C++)
      v2.cols.push(C);
    let p = this._usmToHtml.convert(h, v2, i);
    const S = N1(f2), w = h12();
    return p = p.replace(/(<[a-z]+)/, (C, I2) => `${I2} data-copy-id="${w}"`), {
      copyId: w,
      plain: S,
      html: p,
      matrixFragment: g,
      discreteRange: v2
    };
  }
  _notifyClipboardHook() {
    this._clipboardHooks$.next(this._clipboardHooks);
  }
  async _executePaste(e) {
    const t8 = this._getPastingTarget();
    if (!t8.subUnitId || !t8.selection)
      return false;
    const n = this._injector.invoke((h) => ku(t8.selection.range, h, t8.unitId, t8.subUnitId));
    if (!n)
      return false;
    const { unitId: i, subUnitId: o } = t8, s = this._clipboardHooks, l = [];
    if (s.some(
      (h) => {
        var g;
        return l.push(h) && ((g = h.onBeforePaste) == null ? void 0 : g.call(h, { unitId: i, subUnitId: o, range: n })) === false;
      }
    ))
      return l.forEach((h) => {
        var g;
        return (g = h.onAfterPaste) == null ? void 0 : g.call(h, false);
      }), false;
    const c = [], d = [];
    l.forEach((h) => {
      const g = e(h, {
        unitId: i,
        subUnitId: o,
        range: n
      });
      g && (c.push(...g.redos), d.push(...g.undos));
    });
    const u = c.every((h) => this._commandService.executeCommand(h.id, h.params));
    return u && this._undoRedoService.pushUndoRedo({
      unitID: this._univerInstanceService.getCurrentUnitForType(we.UNIVER_SHEET).getUnitId(),
      undoMutations: d,
      redoMutations: c
    }), u;
  }
  async _pasteFiles(e, t8) {
    return this._executePaste((n, i) => {
      var o;
      return (o = n.onPasteFiles) == null ? void 0 : o.call(n, i, e, { pasteType: t8 });
    });
  }
  async _pastePlainText(e, t8) {
    return this._executePaste((n, i) => {
      var o;
      return (o = n.onPastePlainText) == null ? void 0 : o.call(n, i, e, { pasteType: t8 });
    });
  }
  _pasteUnrecognized() {
    return this._executePaste((e, t8) => {
      var n;
      return (n = e.onPasteUnrecognized) == null ? void 0 : n.call(e, t8);
    });
  }
  async _pasteHTML(e, t8) {
    const n = g12(e);
    return n && this._copyContentCache.get(n) ? this._pasteInternal(n, t8) : this._pasteExternal(e, t8);
  }
  async _pasteExternal(e, t8) {
    var d;
    const { rowProperties: n, colProperties: i, cellMatrix: o } = this._htmlToUSM.convert(e);
    if (!o)
      return false;
    const s = this._getPastedRange(o);
    if (!s)
      return false;
    const l = (d = this._univerInstanceService.getUniverSheetInstance(s.unitId)) == null ? void 0 : d.getSheetBySheetId(s.subUnitId);
    if (!l)
      return false;
    const a = l == null ? void 0 : l.getMergeData();
    return a.length && a.some((h) => Wa2(h, s.pastedRange) && !ih2(s.pastedRange, h)) ? (this._errorService.emit(this._localeService.t("clipboard.paste.overlappingMergedCells")), false) : this._pasteUSM(
      {
        rowProperties: n,
        colProperties: i,
        cellMatrix: o
      },
      s,
      t8
    );
  }
  // eslint-disable-next-line max-lines-per-function, complexity
  async _pasteInternal(e, t8) {
    var C, I2;
    const n = J.deepClone(this._copyContentCache.get(e)), { range: i, matrix: o, unitId: s, subUnitId: l } = n || {};
    if (!o || !n || !i || !s || !l || !o || !n)
      return false;
    const { mapFunc: a } = wr3([i]), c = (C = this._univerInstanceService.getUniverSheetInstance(s)) == null ? void 0 : C.getSheetBySheetId(l);
    o.forValue((R, y, M7) => {
      const { row: E, col: T } = a(R, y), P2 = c == null ? void 0 : c.getComposedCellStyle(E, T), H3 = J.deepClone(M7);
      if (H3.s = P2, o.setValue(R, y, H3), M7.colSpan || M7.rowSpan)
        for (let A = 0; A < M7.rowSpan; A++)
          for (let x7 = 0; x7 < M7.colSpan; x7++) {
            if (A === 0 && x7 === 0) continue;
            const V2 = R + A, D2 = y + x7;
            o.setValue(V2, D2, { s: P2 });
          }
    });
    const d = this._getPastedRange(o);
    if (!d) return false;
    const u = (I2 = this._univerInstanceService.getUniverSheetInstance(d.unitId)) == null ? void 0 : I2.getSheetBySheetId(d.subUnitId);
    if (!u)
      return false;
    const h = u == null ? void 0 : u.getMergeData();
    if (h && h.some((y) => Wa2(y, d.pastedRange) && !ih2(d.pastedRange, y)))
      return this._errorService.emit(this._localeService.t("clipboard.paste.overlappingMergedCells")), false;
    const g = this._univerInstanceService.getUnit(s);
    if (!g) return false;
    const m2 = g.getSheetBySheetId(l);
    if (!m2) return false;
    const f2 = m2.getColumnManager(), v2 = m2.getRowManager(), p = [], S = [];
    if (i.cols.forEach((R) => {
      p.push({ width: `${f2.getColumnWidth(R)}` });
    }), i.rows.forEach((R) => {
      S.push({ height: `${v2.getRowHeight(R)}` });
    }), n.copyType === Yn3.CUT) {
      const R = d.pastedRange.rows[0], y = i.rows[i.rows.length - 1] - i.rows[0] + R;
      d.pastedRange.rows = Array.from(new Array(y + 1).keys()).slice(R);
    }
    const w = this._pasteUSM(
      {
        cellMatrix: o,
        colProperties: p,
        rowProperties: S
      },
      // paste data
      d,
      t8,
      {
        range: i,
        // paste source
        unitId: n.unitId,
        subUnitId: n.subUnitId,
        copyType: n.copyType,
        copyId: e
      }
    );
    return n.copyType === Yn3.CUT && (this._copyContentCache.set(e, { ...n, matrix: null }), this._copyMarkId && this._markSelectionService.removeShape(this._copyMarkId), this._copyMarkId = null), w;
  }
  // eslint-disable-next-line max-lines-per-function
  _pasteUSM(e, t8, n, i) {
    const { rowProperties: o, colProperties: s, cellMatrix: l } = e, { unitId: a, subUnitId: c, pastedRange: d } = t8, u = d.cols.length, h = this._clipboardHooks, g = [];
    if (h.some(
      (R) => {
        var y;
        return g.push(R) && ((y = R.onBeforePaste) == null ? void 0 : y.call(R, { unitId: a, subUnitId: c, range: d })) === false;
      }
    ))
      return g.forEach((R) => {
        var y;
        return (y = R.onAfterPaste) == null ? void 0 : y.call(R, false);
      }), false;
    if (!l) return false;
    const f2 = i ? {
      unitId: i.unitId,
      subUnitId: i.subUnitId,
      range: i.range
    } : null, v2 = {
      copyType: (i == null ? void 0 : i.copyType) || Yn3.COPY,
      copyId: i == null ? void 0 : i.copyId,
      pasteType: n
    };
    let p = [], S = [];
    const w = g.filter(
      (R) => !R.specialPasteInfo && R.id !== et3.DEFAULT_PASTE || n === R.id
    );
    w.forEach((R) => {
      var E, T, P2;
      if (o) {
        const H3 = (E = R.onPasteRows) == null ? void 0 : E.call(R, { range: d, unitId: a, subUnitId: c }, o, {
          pasteType: n
        });
        H3 && (p.push(...H3.redos), S.push(...H3.undos));
      }
      const y = (T = R.onPasteColumns) == null ? void 0 : T.call(
        R,
        { range: d, unitId: a, subUnitId: c },
        s || new Array(u).map(() => ({})),
        { pasteType: n }
      );
      y && (p.push(...y.redos), S.push(...y.undos));
      const M7 = (P2 = R.onPasteCells) == null ? void 0 : P2.call(
        R,
        f2,
        { range: d, unitId: a, subUnitId: c },
        l,
        v2
      );
      M7 && (p.push(...M7.redos), S.push(...M7.undos));
    });
    const C = this._getSetSelectionOperation(a, c, d, l, n);
    C && p.push(C), p = rh2(p), S = rh2(S), S.push({ id: pn2.id, params: { unitId: t8.unitId, subUnitId: t8.subUnitId } }), this._logService.log("[SheetClipboardService]", "pasting mutations", {
      undoMutationsInfo: S,
      redoMutationsInfo: p
    });
    const I2 = p.every((R) => this._commandService.syncExecuteCommand(R.id, R.params));
    return I2 && (this._undoRedoService.pushUndoRedo({
      unitID: a,
      undoMutations: S,
      redoMutations: p
    }), this.updatePasteOptionsCache({
      target: {
        pastedRange: d,
        unitId: a,
        subUnitId: c
      },
      cellMatrix: l,
      rowProperties: o,
      colProperties: s,
      pasteType: n,
      source: i
    }), this.setShowMenu(true)), w.forEach((R) => {
      var y;
      return (y = R.onAfterPaste) == null ? void 0 : y.call(R, I2);
    }), I2;
  }
  _getSetSelectionOperation(e, t8, n, i, o) {
    var C;
    const s = (C = this._univerInstanceService.getUniverSheetInstance(e)) == null ? void 0 : C.getSheetBySheetId(t8);
    if (!s)
      return null;
    const { rows: l, cols: a } = n, c = l[0], d = a[0], u = l[l.length - 1], h = a[a.length - 1], m2 = _e({
      startRow: c,
      endRow: c,
      startColumn: d,
      endColumn: d
    }, s), f2 = i.getValue(0, 0), v2 = (f2 == null ? void 0 : f2.rowSpan) || 1, p = (f2 == null ? void 0 : f2.colSpan) || 1;
    if ((o === et3.DEFAULT_PASTE || o === et3.SPECIAL_PASTE_BESIDES_BORDER || o === et3.SPECIAL_PASTE_FORMAT) && (v2 > 1 || p > 1)) {
      const I2 = {
        startRow: c,
        endRow: c + v2 - 1,
        startColumn: d,
        endColumn: d + p - 1
      };
      m2.startRow = I2.startRow, m2.endRow = I2.endRow, m2.startColumn = I2.startColumn, m2.endColumn = I2.endColumn, m2.isMerged = true, m2.isMergedMainCell = true;
    }
    const w = {
      unitId: e,
      subUnitId: t8,
      selections: [{
        range: {
          startRow: c,
          endRow: u,
          startColumn: d,
          endColumn: h
        },
        primary: m2,
        style: null
      }]
    };
    return {
      id: ie3.id,
      params: w
    };
  }
  _getPastingTarget() {
    const e = this._univerInstanceService.getCurrentUnitForType(we.UNIVER_SHEET), t8 = e.getActiveSheet(), n = this._selectionManagerService.getCurrentLastSelection();
    return {
      unitId: e.getUnitId(),
      subUnitId: t8 == null ? void 0 : t8.getSheetId(),
      selection: n
    };
  }
  /**
   * Handles copying one range to another range, obtained by the following rules
   *
   * [Content to be assigned] => [Target range]
   *
   * I. There are no merged cells in the upper left corner of the pasted area
   *
   * 1. 1 -> 1: 1 => 1
   * 2. N -> 1: N => N
   * 3. 1 -> N: N => N
   * 4. N1 -> N2:
   *     1) N1 <N2: If N2 is a multiple of N1 (X), N1 * X => N2; If not, N1 => N1 (refer to office excel, different from google sheet)
   *     2) N1> N2: N1 => N1
   *
   * The above four cases can be combined and processed as
   *
   * Case 1, 1/2/4-2 merged into N1 => N1
   * Case 2, 3/4-1 merge into N1 * X => N2 or Case 1
   *
   * In the end we only need to judge whether N2 is a multiple of N1
   *
   * II. The pasted area contains merged cells
   *
   * 1. If N2 is a multiple of N1,
   *   1) If N2 === N1, paste this area directly and the range remains unchanged.
   *   2) Otherwise, determine whether other cells are included
   *     1] If included, tile, the range remains unchanged
   *     2] If not included, determine whether the source data is a combined cell
   *       1} If yes, tile, the range remains unchanged
   *       2} If not, only the content will be pasted, the original style will be discarded, and the scope will remain unchanged.
   *
   * 2. If N2 is not a multiple of N1, determine whether the upper left corner cell (merged or non-merged or combined) is consistent with the size of the original data.
   *   1) If consistent, only paste this area;
   *   2) If inconsistent, then determine whether the pasted area contains other cells.
   *     1] If yes, pasting is not allowed and an error will pop up;
   *     2] If not, only the content will be pasted and the original style will be discarded.
   *
   * @param rowCount
   * @param colCount
   * @param cellMatrix
   * @param range
   */
  // eslint-disable-next-line max-lines-per-function, complexity
  _transformPastedData(e, t8, n) {
    const i = this._getPastingTarget(), { selection: o, unitId: s, subUnitId: l } = i;
    if (!l || !o)
      return null;
    const a = this._injector.invoke((T) => ku(o.range, T, s, l));
    if (!a)
      return null;
    const { ranges: [c], mapFunc: d } = wr3([a]), { startRow: u, startColumn: h, endRow: g, endColumn: m2 } = c, f2 = g - u + 1, v2 = m2 - h + 1, p = this._univerInstanceService.getCurrentUnitForType(we.UNIVER_SHEET), S = p == null ? void 0 : p.getActiveSheet();
    if (!S)
      return null;
    const C = S.getMergeData().filter(
      (T) => a.rows.includes(T.startRow) && a.cols.includes(T.startColumn)
    ), I2 = C[0];
    let R = 0, y = 0, M7 = 0, E = 0;
    if (I2 && (R = I2.startRow, y = I2.startColumn, M7 = I2.endRow, E = I2.endColumn), f2 % e === 0 && v2 % t8 === 0)
      if (C.length > 0 && (f2 !== e || v2 !== t8))
        if (R === a.rows[0] && y === a.cols[0] && M7 === a.rows[f2 - 1] && E === a.cols[v2 - 1])
          if (W13(n))
            for (let P2 = 0; P2 < f2; P2++)
              for (let H3 = 0; H3 < v2; H3++) {
                const A = n.getValue(P2 % e, H3 % t8);
                A && n.setValue(P2, H3, A);
              }
          else
            n.forValue((P2, H3, A) => {
              A.s = null, delete A.colSpan, delete A.rowSpan;
            });
        else
          for (let T = 0; T < f2; T++)
            for (let P2 = 0; P2 < v2; P2++) {
              const H3 = n.getValue(T % e, P2 % t8);
              H3 && n.setValue(T, P2, H3);
            }
      else
        for (let T = 0; T < f2; T++)
          for (let P2 = 0; P2 < v2; P2++) {
            const H3 = n.getValue(T % e, P2 % t8);
            H3 && n.setValue(T, P2, H3);
          }
    else if (C.length > 0) {
      const { row: T, col: P2 } = d(u, h);
      if (this._topLeftCellsMatch(e, t8, {
        topRow: T,
        leftCol: P2
      })) {
        const A = this._expandOrShrinkRowsCols(s, l, a, t8, e);
        a.rows = A.rows, a.cols = A.cols;
      } else {
        if (g > I2.endRow || m2 > I2.endColumn)
          return null;
        n.forValue((A, x7, V2) => {
          V2.s = null, delete V2.colSpan, delete V2.rowSpan;
        });
      }
    } else {
      const T = this._expandOrShrinkRowsCols(s, l, a, t8, e);
      a.rows = T.rows, a.cols = T.cols;
    }
    return {
      pastedRange: a,
      unitId: s,
      subUnitId: l
    };
  }
  _getPastedRange(e) {
    var S;
    const t8 = this._getPastingTarget(), { selection: n, unitId: i, subUnitId: o } = t8;
    if (!o || !n)
      return null;
    const s = this._injector.invoke((w) => ku(n.range, w, i, o));
    if (!s)
      return null;
    const { startColumn: l, endColumn: a, startRow: c, endRow: d } = e.getDataRange(), u = d - c + 1, h = a - l + 1;
    if (u <= 0 || h <= 0) return null;
    const g = s.rows.length, m2 = s.cols.length, f2 = (S = this._univerInstanceService.getUniverSheetInstance(i)) == null ? void 0 : S.getSheetBySheetId(o);
    if (!f2)
      return null;
    const v2 = f2 == null ? void 0 : f2.getMergeData();
    if (g % u === 0 && m2 % h === 0 && !(v2 == null ? void 0 : v2.some((C) => Wa2(C, s)))) {
      for (let C = 0; C < g; C++)
        for (let I2 = 0; I2 < m2; I2++) {
          const R = e.getValue(C % u, I2 % h);
          R && e.setValue(C, I2, R);
        }
      return {
        pastedRange: s,
        unitId: i,
        subUnitId: o
      };
    }
    const p = this._expandOrShrinkRowsCols(i, o, s, h, u);
    return s.rows = p.rows, s.cols = p.cols, {
      pastedRange: s,
      unitId: i,
      subUnitId: o
    };
  }
  _expandOrShrinkRowsCols(e, t8, n, i, o) {
    const { rows: s, cols: l } = n, a = this._univerInstanceService.getUniverSheetInstance(e), c = a == null ? void 0 : a.getSheetBySheetId(t8);
    let d, u;
    if (s.length >= o)
      d = s.slice(0, o);
    else {
      d = s.slice(0);
      let h = s[s.length - 1] + 1;
      for (; d.length < o; )
        c.getRowFiltered(h) || d.push(h), h++;
    }
    if (l.length >= i)
      u = l.slice(0, i);
    else {
      u = l.slice(0);
      let h = l[l.length - 1] + 1;
      for (; u.length < i; )
        u.push(h), h++;
    }
    return {
      rows: d,
      cols: u
    };
  }
  /**
   * Determine whether the cells starting from the upper left corner of the range (merged or non-merged or combined) are consistent with the size of the original data
   * @param cellMatrix
   * @param range
   */
  _topLeftCellsMatch(e, t8, n) {
    const i = this._univerInstanceService.getCurrentUnitForType(we.UNIVER_SHEET), o = i == null ? void 0 : i.getActiveSheet();
    if (!o)
      return false;
    const { topRow: s, leftCol: l } = n, a = D12(
      s + e - 1,
      l,
      l + t8 - 1,
      o
    ), c = L12(
      l + t8 - 1,
      s,
      s + e - 1,
      o
    );
    return !a && !c;
  }
  removeMarkSelection() {
    this._copyMarkId && (this._markSelectionService.removeShape(this._copyMarkId), this._copyMarkId = null);
  }
  _initUnitDisposed() {
    this.disposeWithMe(
      this._univerInstanceService.getTypeOfUnitDisposed$(we.UNIVER_SHEET).subscribe((e) => {
        e && this.copyContentCache().clearWithUnitId(e.getUnitId());
      })
    );
  }
  disposePasteOptionsCache() {
    this.setShowMenu(false), this.updatePasteOptionsCache(null);
  }
};
rl2 = H12([
  Pt4(0, yt),
  Pt4(1, vr),
  Pt4(2, Inject(z)),
  Pt4(3, lr),
  Pt4(4, Qo),
  Pt4(5, Ls),
  Pt4(6, Wi3),
  Pt4(7, u3),
  Pt4(8, tt),
  Pt4(9, ME),
  Pt4(10, Inject(Gi)),
  Pt4(11, Inject(Fn)),
  Pt4(12, Inject(_E)),
  Pt4(13, Inject(Injector))
], rl2);
function N1(r) {
  let e = "";
  const t8 = r.getLength();
  return r.forRow((n, i) => {
    const o = [];
    i.forEach((s) => {
      const l = r.getValue(n, s);
      if (l) {
        const a = k1(l);
        o.push(a);
      }
    }), e += o.join("	"), n !== t8 - 1 && (e += `
`);
  }), e;
}
function k1(r) {
  return vE(r.displayV) ? r.displayV : HE(r);
}
function D12(r, e, t8, n) {
  return n.getMergeData().some(
    (i) => i.startRow <= r && r < i.endRow && e <= i.startColumn && i.startColumn <= t8
  );
}
function L12(r, e, t8, n) {
  return n.getMergeData().some(
    (i) => i.startColumn <= r && r < i.endColumn && e <= i.startRow && i.startRow <= t8
  );
}
function W13(r) {
  let e = 0;
  return r.forValue((t8, n, i) => {
    if (i && e++, e > 1)
      return false;
  }), e > 1;
}
function Gi3() {
  return {
    p: null,
    v: null,
    s: null,
    f: null,
    si: null,
    t: null
  };
}
var jd2 = 998;
var un5 = {
  id: Fn3.id,
  name: "sheet.command.copy",
  type: Ms.COMMAND,
  multi: true,
  priority: jd2,
  preconditions: Fd2,
  handler: async (r) => r.get(nn2).copy()
};
var Yd2 = {
  id: kn2.id,
  name: "sheet.command.cut",
  type: Ms.COMMAND,
  multi: true,
  priority: jd2,
  preconditions: Fd2,
  handler: async (r) => r.get(nn2).cut()
};
var hn4 = {
  id: jn2.id,
  type: Ms.COMMAND,
  multi: true,
  name: "sheet.command.paste",
  priority: jd2,
  preconditions: Fd2,
  handler: async (r, e) => {
    const n = await r.get(lr).read(), i = r.get(nn2);
    return n.length !== 0 ? i.paste(n[0], e == null ? void 0 : e.value) : false;
  }
};
var Xc = {
  id: Qi,
  type: Ms.COMMAND,
  handler: async (r, e) => {
    const t8 = r.get(nn2), { htmlContent: n, textContent: i, files: o } = e;
    return t8.legacyPaste(n, i, o), true;
  }
};
var go3 = {
  id: "sheet.command.paste-value",
  type: Ms.COMMAND,
  handler: async (r) => r.get(Ls).executeCommand(hn4.id, { value: et3.SPECIAL_PASTE_VALUE })
};
var mo3 = {
  id: "sheet.command.paste-format",
  type: Ms.COMMAND,
  handler: async (r) => r.get(Ls).executeCommand(hn4.id, {
    value: et3.SPECIAL_PASTE_FORMAT
  })
};
var ri4 = {
  id: "sheet.command.paste-col-width",
  type: Ms.COMMAND,
  handler: async (r) => r.get(Ls).executeCommand(hn4.id, {
    value: et3.SPECIAL_PASTE_COL_WIDTH
  })
};
var fo5 = {
  id: "sheet.command.paste-besides-border",
  type: Ms.COMMAND,
  handler: async (r) => r.get(Ls).executeCommand(hn4.id, {
    value: et3.SPECIAL_PASTE_BESIDES_BORDER
  })
};
var _m = {
  id: "sheet.command.optional-paste",
  type: Ms.COMMAND,
  handler: async (r, { type: e }) => r.get(nn2).rePasteWithPasteType(e)
};
var ts2 = {
  type: Ms.COMMAND,
  id: "sheet.command.delete-range-move-left-confirm",
  handler: async (r) => {
    const e = r.get(at), t8 = r.get(Ls), n = r.get(Fn), i = r.get(z), o = r.get(vr), s = i.getCurrentSelections();
    if (!s)
      return false;
    const l = P(o);
    if (!l) return false;
    const { worksheet: a } = l;
    let c = s[0].range;
    if (!c)
      return false;
    c = { ...c, endColumn: a.getColumnCount() - 1 };
    const d = (g) => g.endRow - g.startRow;
    return a.getMergeData().find((g) => {
      const m2 = En.getIntersects(g, c);
      return m2 ? d(g) > d(m2) : false;
    }) ? await e.confirm({
      id: ts2.id,
      title: { title: n.t("merge.confirm.warning") },
      children: { title: n.t("merge.confirm.dismantleMergeCellWarning") },
      cancelText: n.t("button.cancel"),
      confirmText: n.t("button.confirm")
    }) ? t8.executeCommand(vt.id) : true : t8.executeCommand(vt.id);
  }
};
var pi3 = {
  type: Ms.COMMAND,
  id: "sheet.command.delete-range-move-up-confirm",
  handler: async (r) => {
    const e = r.get(at), t8 = r.get(Ls), n = r.get(Fn), i = r.get(z), o = r.get(vr), s = i.getCurrentSelections();
    if (!s) return false;
    const l = P(o);
    if (!l) return false;
    const { worksheet: a } = l;
    let c = s[0].range;
    if (!c) return false;
    c = { ...c, endRow: a.getRowCount() - 1 };
    for (let g = c.startRow; g <= c.endRow; g++)
      if (a.getRowFiltered(g) && await e.confirm({
        id: pi3.id,
        title: { title: n.t("filter.confirm.error") },
        children: { title: n.t("filter.confirm.notAllowedToInsertRange") },
        confirmText: n.t("button.confirm")
      }))
        return false;
    const d = (g) => g.endColumn - g.startColumn;
    return a.getMergeData().find((g) => {
      const m2 = En.getIntersects(g, c);
      return m2 ? d(g) > d(m2) : false;
    }) ? await e.confirm({
      id: pi3.id,
      title: { title: n.t("merge.confirm.warning") },
      children: { title: n.t("merge.confirm.dismantleMergeCellWarning") },
      cancelText: n.t("button.cancel"),
      confirmText: n.t("button.confirm")
    }) ? t8.executeCommand(Mt.id) : true : t8.executeCommand(Mt.id);
  }
};
var aa = ((r) => (r.MergeAll = "mergeAll", r.MergeVertical = "mergeVertical", r.MergeHorizontal = "mergeHorizontal", r))(aa || {});
function qn4(r, e, t8, n, i = true, o = 1, s = true) {
  let l = { ...r };
  n == null && (n = {
    startRow: 0,
    endRow: t8.getRowCount() - 1,
    startColumn: 0,
    endColumn: t8.getColumnCount() - 1
  });
  let a;
  switch (e) {
    case Cm.UP:
      for (a = r.startRow - o; a > -1 && !t8.getRowVisible(a); )
        a -= 1;
      a >= n.startRow ? (l.startRow = a, l.endRow = a) : s && (l.startRow = n.endRow, l.endRow = n.endRow, i && (l = qn4(l, Cm.LEFT, t8, n, false)));
      break;
    case Cm.DOWN:
      for (a = r.endRow + o; a < t8.getRowCount() && !t8.getRowVisible(a); )
        a += 1;
      a <= n.endRow ? (l.startRow = a, l.endRow = a) : s && (l.startRow = n.startRow, l.endRow = n.startRow, i && (l = qn4(l, Cm.RIGHT, t8, n, false)));
      break;
    case Cm.LEFT:
      for (a = r.startColumn - o; a > -1 && !t8.getColVisible(a); )
        a -= 1;
      a >= n.startColumn ? (l.startColumn = a, l.endColumn = a) : s && (l.startColumn = n.endColumn, l.endColumn = n.endColumn, i && (l = qn4(l, Cm.UP, t8, n, false)));
      break;
    case Cm.RIGHT:
      for (a = r.endColumn + o; a < t8.getColumnCount() && !t8.getColVisible(a); )
        a += 1;
      a <= n.endColumn ? (l.startColumn = a, l.endColumn = a) : s && (l.startColumn = n.startColumn, l.endColumn = n.startColumn, i && (l = qn4(l, Cm.DOWN, t8, n, false)));
      break;
  }
  return l;
}
function Zd2(r, e, t8) {
  const n = { ...r }, { startRow: i, startColumn: o, endRow: s, endColumn: l } = Ro2(r, e, t8);
  let a = qi2(t8, i, o, s, l).hasValue, c = true, d = true;
  for (; d; ) {
    if (Cm.UP === e) {
      let u = n.startRow - 1;
      for (; u > -1 && !t8.getRowVisible(u); )
        u -= 1;
      if (u === -1) {
        d = false;
        break;
      }
      const { hasValue: h, matrix: g } = qi2(
        t8,
        u,
        n.startColumn,
        u,
        n.endColumn
      );
      if (a && !h && !c) {
        d = false;
        break;
      } else {
        if (g.getLength() !== 0) {
          let m2 = u;
          g.forValue((f2) => {
            m2 = Math.min(f2, m2);
          }), n.startRow = m2;
        } else
          n.startRow = u;
        if (n.endRow = n.startRow, !a && h) {
          d = false;
          break;
        }
        a = h, c = false;
      }
    }
    if (Cm.DOWN === e) {
      let u = n.endRow + 1;
      for (; u < t8.getRowCount() && !t8.getRowVisible(u); )
        u += 1;
      if (u === t8.getRowCount()) {
        d = false;
        break;
      }
      const { hasValue: h, matrix: g } = qi2(
        t8,
        u,
        n.startColumn,
        u,
        n.endColumn
      );
      if (a && !h && !c) {
        d = false;
        break;
      } else {
        if (g.getLength() !== 0) {
          let m2 = u;
          g.forValue((f2, v2, p) => {
            m2 = Math.max(f2 + (p.rowSpan || 1) - 1, m2);
          }), n.endRow = m2;
        } else
          n.endRow = u;
        if (n.startRow = n.endRow, !a && h) {
          d = false;
          break;
        }
        a = h, c = false;
      }
    }
    if (Cm.LEFT === e) {
      let u = n.startColumn - 1;
      for (; u > -1 && !t8.getColVisible(u); )
        u -= 1;
      if (u === -1) {
        d = false;
        break;
      }
      const { hasValue: h, matrix: g } = qi2(
        t8,
        n.startRow,
        u,
        n.endRow,
        u
      );
      if (a && !h && !c) {
        d = false;
        break;
      } else {
        if (g.getLength() !== 0) {
          let m2 = u;
          g.forValue((f2, v2) => {
            m2 = Math.min(v2, m2);
          }), n.startColumn = m2;
        } else
          n.startColumn = u;
        if (n.endColumn = n.startColumn, !a && h) {
          d = false;
          break;
        }
        a = h, c = false;
      }
    }
    if (Cm.RIGHT === e) {
      let u = n.endColumn + 1;
      for (; u < t8.getColumnCount() && !t8.getColVisible(u); )
        u += 1;
      if (u === t8.getColumnCount()) {
        d = false;
        break;
      }
      const { hasValue: h, matrix: g } = qi2(
        t8,
        n.startRow,
        u,
        n.endRow,
        u
      );
      if (a && !h && !c) {
        d = false;
        break;
      } else {
        if (g.getLength() !== 0) {
          let m2 = u;
          g.forValue((f2, v2, p) => {
            m2 = Math.max(v2 + (p.colSpan || 1) - 1, m2);
          }), n.endColumn = m2;
        } else
          n.endColumn = u;
        if (n.startColumn = n.endColumn, !a && h) {
          d = false;
          break;
        }
        a = h, c = false;
      }
    }
  }
  return us(n, t8, true);
}
function Rm(r, e, t8) {
  return qn4(r, e, t8, void 0, false, 1, false);
}
function B13(r, e, t8) {
  const n = Zd2(r, e, t8);
  return us(En.union(n, r), t8, true);
}
function F1(r, e, t8) {
  const n = Rm(r, e, t8), i = {
    startRow: Math.min(r.startRow, n.startRow),
    startColumn: Math.min(r.startColumn, n.startColumn),
    endRow: Math.max(r.endRow, n.endRow),
    endColumn: Math.max(r.endColumn, n.endColumn)
  };
  return us(En.union(r, i), t8);
}
function U12(r, e, t8, n) {
  const i = g1(t8), o = Zd2(Ro2(r, i, n), t8, n);
  return t8 === Cm.UP && o.startRow <= r.startRow ? us(
    { ...e, startColumn: r.startColumn, endColumn: r.endColumn },
    n,
    true
  ) : t8 === Cm.DOWN && o.endRow >= r.endRow ? us(
    { ...e, startColumn: r.startColumn, endColumn: r.endColumn },
    n,
    true
  ) : t8 === Cm.LEFT && o.startColumn <= r.startColumn ? us(
    { ...e, startRow: r.startRow, endRow: r.endRow },
    n,
    true
  ) : t8 === Cm.RIGHT && o.endColumn >= r.endColumn ? us(
    { ...e, startRow: r.startRow, endRow: r.endRow },
    n,
    true
  ) : En.union(En.clone(e), o);
}
function X12(r, e, t8) {
  const n = g1(e), i = Ro2(r, n, t8), o = Ro2(r, e, t8), s = Rm(i, e, t8);
  return us(En.union(o, s), t8, false);
}
function oh2(r) {
  return {
    startRow: 0,
    startColumn: 0,
    endRow: r.getRowCount() - 1,
    endColumn: r.getColumnCount() - 1,
    rangeType: ge.ALL
  };
}
function Ro2(r, e, t8) {
  let n;
  switch (e) {
    case Cm.UP:
      n = {
        startRow: r.startRow,
        startColumn: r.startColumn,
        endRow: r.startRow,
        endColumn: r.endColumn,
        rangeType: ge.NORMAL
      };
      break;
    case Cm.DOWN:
      n = {
        startRow: r.endRow,
        startColumn: r.startColumn,
        endRow: r.endRow,
        endColumn: r.endColumn,
        rangeType: ge.NORMAL
      };
      break;
    case Cm.LEFT:
      n = {
        startRow: r.startRow,
        startColumn: r.startColumn,
        endRow: r.endRow,
        endColumn: r.startColumn,
        rangeType: ge.NORMAL
      };
      break;
    case Cm.RIGHT:
      n = {
        startRow: r.startRow,
        startColumn: r.endColumn,
        endRow: r.endRow,
        endColumn: r.endColumn,
        rangeType: ge.NORMAL
      };
      break;
    default:
      throw new Error("Invalid direction");
  }
  return us(n, t8, false);
}
function qi2(r, e, t8, n, i) {
  let o = false;
  const s = r.getMatrixWithMergedCells(e, t8, n, i).forValue((l, a, c) => {
    if (j13(c))
      return o = true, false;
  });
  return {
    hasValue: o,
    matrix: s
  };
}
function zc3(r, e, t8) {
  const n = En.clone(r);
  if (e == null)
    return n;
  switch (t8) {
    case Cm.UP:
    case Cm.DOWN:
      n.startColumn = n.endColumn = e.actualColumn;
      break;
    case Cm.LEFT:
    case Cm.RIGHT:
      n.startRow = n.endRow = e.actualRow;
      break;
  }
  return n;
}
function z12(r, e, t8) {
  var l, a, c, d;
  const { primary: n, range: i } = r, o = En.clone(i);
  switch (e) {
    case Cm.UP:
    case Cm.DOWN:
      o.startRow = (l = n == null ? void 0 : n.startRow) != null ? l : i.startRow, o.endRow = (a = n == null ? void 0 : n.endRow) != null ? a : i.startRow;
      break;
    case Cm.LEFT:
    case Cm.RIGHT:
      o.startColumn = (c = n == null ? void 0 : n.startColumn) != null ? c : i.startColumn, o.endColumn = (d = n == null ? void 0 : n.endColumn) != null ? d : i.startColumn;
      break;
  }
  const s = Ro2(o, e, t8);
  switch (e) {
    case Cm.DOWN:
      return i.startRow < s.startRow;
    case Cm.UP:
      return i.endRow > s.endRow;
    case Cm.LEFT:
      return s.endColumn < i.endColumn;
    case Cm.RIGHT:
      return s.startColumn > i.startColumn;
  }
}
function Im(r, e) {
  let t8 = r[0].startRow, n = r[0].endRow;
  r.forEach((o) => {
    const { startRow: s, endRow: l } = o;
    t8 = Math.min(t8, s), n = Math.max(n, l);
  });
  const i = new Array(n - t8 + 1).fill(false);
  return e.forEach((o) => {
    const { startRow: s, endRow: l } = o;
    for (let a = Math.max(s, t8); a <= Math.min(l, n); a++)
      i[a - t8] = true;
  }), r.every((o) => {
    const { startRow: s, endRow: l } = o;
    for (let a = s; a <= l; a++)
      if (!i[a - t8])
        return false;
    return true;
  });
}
function ym(r, e) {
  let t8 = r[0].startColumn, n = r[0].endColumn;
  r.forEach((o) => {
    const { startColumn: s, endColumn: l } = o;
    t8 = Math.min(t8, s), n = Math.max(n, l);
  });
  const i = new Array(n - t8 + 1).fill(false);
  return e.forEach((o) => {
    const { startColumn: s, endColumn: l } = o;
    for (let a = Math.max(s, t8); a <= Math.min(l, n); a++)
      i[a - t8] = true;
  }), r.every((o) => {
    const { startColumn: s, endColumn: l } = o;
    for (let a = s; a <= l; a++)
      if (!i[a - t8])
        return false;
    return true;
  });
}
function Gd2(r, e) {
  return e ? r === "mergeAll" ? e.filter((t8) => !(t8.startRow === t8.endRow && t8.startColumn === t8.endColumn)) : r === "mergeVertical" ? e.filter((t8) => t8.startRow !== t8.endRow) : r === "mergeHorizontal" ? e.filter((t8) => t8.startColumn !== t8.endColumn) : e : null;
}
function j13(r) {
  return r.v !== void 0 && r.v !== null && r.v !== "" || r.p !== void 0;
}
var ca = {
  id: "sheet.command.hide-row-confirm",
  type: Ms.COMMAND,
  handler: async (r) => {
    var a;
    const t8 = (a = r.get(z).getCurrentSelections()) == null ? void 0 : a.map((c) => c.range);
    if (!(t8 != null && t8.length)) return false;
    const n = r.get(Ls), i = r.get(vr), o = P(i);
    if (!o) return false;
    const { worksheet: s } = o, l = s.getVisibleRows();
    if (Im(l, t8)) {
      const c = r.get(at), d = r.get(Fn);
      return await c.confirm({
        id: "sheet.confirm.hide-row",
        title: {
          title: d.t("info.problem")
        },
        children: { title: d.t("rightClick.hideAllRowsAlert") },
        cancelText: d.t("button.cancel"),
        confirmText: d.t("button.confirm")
      }), false;
    }
    return await n.executeCommand(Es.id), true;
  }
};
var da = {
  id: "sheet.command.hide-col-confirm",
  type: Ms.COMMAND,
  handler: async (r) => {
    var a;
    const t8 = (a = r.get(z).getCurrentSelections()) == null ? void 0 : a.map((c) => c.range);
    if (!(t8 != null && t8.length))
      return false;
    const n = r.get(Ls), i = r.get(vr), o = P(i);
    if (!o) return false;
    const { worksheet: s } = o, l = s.getVisibleCols();
    if (ym(l, t8)) {
      const c = r.get(at), d = r.get(Fn);
      return await c.confirm({
        id: "sheet.confirm.hide-col",
        title: {
          title: d.t("info.problem")
        },
        children: { title: d.t("rightClick.hideAllColumnsAlert") },
        cancelText: d.t("button.cancel"),
        confirmText: d.t("button.confirm")
      }), false;
    }
    return await n.executeCommand(bs.id), true;
  }
};
var Bi3 = {
  type: Ms.COMMAND,
  id: "sheet.command.set-range-bold",
  handler: async (r) => {
    const e = r.get(Ls);
    return r.get(Nr).getContextValue(mE) ? e.executeCommand(Lt2.id) : e.executeCommand(jh.id);
  }
};
var Fi3 = {
  type: Ms.COMMAND,
  id: "sheet.command.set-range-italic",
  handler: async (r) => {
    const e = r.get(Ls);
    return r.get(Nr).getContextValue(mE) ? e.executeCommand(Qt5.id) : e.executeCommand(zh.id);
  }
};
var Ui3 = {
  type: Ms.COMMAND,
  id: "sheet.command.set-range-underline",
  handler: async (r) => {
    const e = r.get(Ls);
    return r.get(Nr).getContextValue(mE) ? e.executeCommand(Ut3.id) : e.executeCommand(Gh.id);
  }
};
var Xi2 = {
  type: Ms.COMMAND,
  id: "sheet.command.set-range-stroke",
  handler: async (r) => {
    const e = r.get(Ls);
    return r.get(Nr).getContextValue(mE) ? e.executeCommand(Ft4.id) : e.executeCommand(Kh.id);
  }
};
var Mm2 = {
  type: Ms.COMMAND,
  id: "sheet.command.set-range-subscript",
  handler: async (r) => {
    const e = r.get(Ls);
    return r.get(Nr).getContextValue(mE) ? e.executeCommand(bt3.id) : false;
  }
};
var Em2 = {
  type: Ms.COMMAND,
  id: "sheet.command.set-range-superscript",
  handler: async (r) => {
    const e = r.get(Ls);
    return r.get(Nr).getContextValue(mE) ? e.executeCommand(Ht2.id) : false;
  }
};
var ua = {
  type: Ms.COMMAND,
  id: "sheet.command.set-range-fontsize",
  handler: async (r, e) => {
    const t8 = r.get(Ls);
    return r.get(Nr).getContextValue(mE) ? t8.executeCommand(ct3.id, e) : t8.executeCommand(Yh.id, e);
  }
};
var ha2 = {
  type: Ms.COMMAND,
  id: "sheet.command.set-range-font-family",
  handler: async (r, e) => {
    const t8 = r.get(Ls);
    return r.get(Nr).getContextValue(mE) ? t8.executeCommand(en3.id, e) : t8.executeCommand(qh.id, e);
  }
};
var Io3 = {
  type: Ms.COMMAND,
  id: "sheet.command.set-range-text-color",
  handler: async (r, e) => {
    const t8 = r.get(Ls);
    return r.get(Nr).getContextValue(mE) ? t8.executeCommand(mt2.id, e) : t8.executeCommand(Hc3.id, e);
  }
};
var qd2 = {
  type: Ms.COMMAND,
  id: "sheet.command.reset-range-text-color",
  handler: async (r) => {
    const e = r.get(Ls), n = r.get(Nr).getContextValue(mE), i = r.get(Gi);
    return n ? e.executeCommand(mt2.id, { value: null }) : e.executeCommand(Hc3.id, {
      value: i.getColorFromTheme("gray.900")
    });
  }
};
var vi3 = {
  type: Ms.COMMAND,
  id: "sheet.command.insert-range-move-down-confirm",
  handler: async (r) => {
    const e = r.get(at), t8 = r.get(Ls), n = r.get(Fn), i = r.get(z), o = r.get(vr), s = i.getCurrentSelections();
    if (!s)
      return false;
    const l = P(o);
    if (!l) return false;
    const { worksheet: a } = l;
    let c = s[0].range;
    if (!c)
      return false;
    c = { ...c, endRow: a.getRowCount() - 1 };
    for (let g = c.startRow; g <= c.endRow; g++)
      if (a.getRowFiltered(g) && await e.confirm({
        id: vi3.id,
        title: { title: n.t("filter.confirm.error") },
        children: { title: n.t("filter.confirm.notAllowedToInsertRange") },
        confirmText: n.t("button.confirm")
      }))
        return false;
    const d = (g) => g.endColumn - g.startColumn;
    return a.getMergeData().find((g) => {
      const m2 = En.getIntersects(g, c);
      return m2 ? d(g) > d(m2) : false;
    }) ? await e.confirm({
      id: vi3.id,
      title: { title: n.t("merge.confirm.warning") },
      children: { title: n.t("merge.confirm.dismantleMergeCellWarning") },
      cancelText: n.t("button.cancel"),
      confirmText: n.t("button.confirm")
    }) ? t8.executeCommand(Nt.id) : true : t8.executeCommand(Nt.id);
  }
};
var ns2 = {
  type: Ms.COMMAND,
  id: "sheet.command.insert-range-move-right-confirm",
  handler: async (r) => {
    const e = r.get(at), t8 = r.get(Ls), n = r.get(Fn), i = r.get(z), o = r.get(vr), s = i.getCurrentSelections();
    if (!s)
      return false;
    const l = P(o);
    if (!l) return false;
    const { worksheet: a } = l;
    let c = s[0].range;
    if (!c)
      return false;
    c = { ...c, endColumn: a.getColumnCount() - 1 };
    const d = (g) => g.endRow - g.startRow;
    return a.getMergeData().find((g) => {
      const m2 = En.getIntersects(g, c);
      return m2 ? d(g) > d(m2) : false;
    }) ? await e.confirm({
      id: ns2.id,
      title: { title: n.t("merge.confirm.warning") },
      children: { title: n.t("merge.confirm.dismantleMergeCellWarning") },
      cancelText: n.t("button.cancel"),
      confirmText: n.t("button.confirm")
    }) ? t8.executeCommand(an.id) : true : t8.executeCommand(an.id);
  }
};
var Tm = ((r) => (r[r.UNIVER_UNKNOWN = 0] = "UNIVER_UNKNOWN", r[r.UNIVER_DOC = 1] = "UNIVER_DOC", r[r.UNIVER_SHEET = 2] = "UNIVER_SHEET", r[r.UNIVER_SLIDE = 3] = "UNIVER_SLIDE", r[r.UNIVER_PROJECT = 4] = "UNIVER_PROJECT", r[r.UNRECOGNIZED = -1] = "UNRECOGNIZED", r))(Tm || {});
var ae = ((r) => (r[r.View = 0] = "View", r[r.Edit = 1] = "Edit", r[r.ManageCollaborator = 2] = "ManageCollaborator", r[r.Print = 3] = "Print", r[r.Duplicate = 4] = "Duplicate", r[r.Comment = 5] = "Comment", r[r.Copy = 6] = "Copy", r[r.Share = 7] = "Share", r[r.Export = 8] = "Export", r[r.MoveWorksheet = 9] = "MoveWorksheet", r[r.DeleteWorksheet = 10] = "DeleteWorksheet", r[r.HideWorksheet = 11] = "HideWorksheet", r[r.RenameWorksheet = 12] = "RenameWorksheet", r[r.CreateWorksheet = 13] = "CreateWorksheet", r[r.SetWorksheetStyle = 14] = "SetWorksheetStyle", r[r.EditWorksheetCell = 15] = "EditWorksheetCell", r[r.InsertHyperlink = 16] = "InsertHyperlink", r[r.Sort = 17] = "Sort", r[r.Filter = 18] = "Filter", r[r.PivotTable = 19] = "PivotTable", r[r.FloatImg = 20] = "FloatImg", r[r.History = 21] = "History", r[r.RwHgtClWdt = 22] = "RwHgtClWdt", r[r.ViemRwHgtClWdt = 23] = "ViemRwHgtClWdt", r[r.ViewFilter = 24] = "ViewFilter", r[r.MoveSheet = 25] = "MoveSheet", r[r.DeleteSheet = 26] = "DeleteSheet", r[r.HideSheet = 27] = "HideSheet", r[r.CopySheet = 28] = "CopySheet", r[r.RenameSheet = 29] = "RenameSheet", r[r.CreateSheet = 30] = "CreateSheet", r[r.SelectProtectedCells = 31] = "SelectProtectedCells", r[r.SelectUnProtectedCells = 32] = "SelectUnProtectedCells", r[r.SetCellStyle = 33] = "SetCellStyle", r[r.SetCellValue = 34] = "SetCellValue", r[r.SetRowStyle = 35] = "SetRowStyle", r[r.SetColumnStyle = 36] = "SetColumnStyle", r[r.InsertRow = 37] = "InsertRow", r[r.InsertColumn = 38] = "InsertColumn", r[r.DeleteRow = 39] = "DeleteRow", r[r.DeleteColumn = 40] = "DeleteColumn", r[r.EditExtraObject = 41] = "EditExtraObject", r[r.Delete = 42] = "Delete", r[r.RecoverHistory = 43] = "RecoverHistory", r[r.ViewHistory = 44] = "ViewHistory", r[r.CreatePermissionObject = 45] = "CreatePermissionObject", r[r.UNRECOGNIZED = -1] = "UNRECOGNIZED", r))(ae || {});
var Lt3 = ((r) => (r[r.Reader = 0] = "Reader", r[r.Editor = 1] = "Editor", r[r.Owner = 2] = "Owner", r[r.UNRECOGNIZED = -1] = "UNRECOGNIZED", r))(Lt3 || {});
var yn3 = ((r) => (r[r.Unkonwn = 0] = "Unkonwn", r[r.Workbook = 1] = "Workbook", r[r.Worksheet = 2] = "Worksheet", r[r.SelectRange = 3] = "SelectRange", r[r.Document = 4] = "Document", r[r.Slide = 5] = "Slide", r[r.UNRECOGNIZED = -1] = "UNRECOGNIZED", r))(yn3 || {});
var on3 = ((r) => (r[r.SomeCollaborator = 0] = "SomeCollaborator", r[r.AllCollaborator = 1] = "AllCollaborator", r[r.OneSelf = 2] = "OneSelf", r[r.UNRECOGNIZED = -1] = "UNRECOGNIZED", r))(on3 || {});
var yo2 = "UNIVER_SHEET_PERMISSION_PANEL";
var ga3 = "UNIVER_SHEET_PERMISSION_USER_PART";
var Pm = "UNIVER_SHEET_PERMISSION_USER_DIALOG";
var xm = "UNIVER_SHEET_PERMISSION_DIALOG";
var il2 = "UNIVER_SHEET_PERMISSION_USER_DIALOG_ID";
var ol = "UNIVER_SHEET_PERMISSION_DIALOG_ID";
var Cs2 = {
  [ae.Copy]: "Copy",
  [ae.SetCellStyle]: "SetCellStyle",
  [ae.SetCellValue]: "SetCellValue",
  [ae.SetRowStyle]: "SetRowStyle",
  [ae.SetColumnStyle]: "SetColumnStyle",
  [ae.InsertRow]: "InsertRow",
  [ae.InsertColumn]: "InsertColumn",
  [ae.InsertHyperlink]: "InsertHyperlink",
  [ae.DeleteRow]: "DeleteRow",
  [ae.DeleteColumn]: "DeleteColumn",
  [ae.Sort]: "Sort",
  [ae.Filter]: "Filter",
  [ae.PivotTable]: "PivotTable",
  [ae.EditExtraObject]: "EditExtraObject"
};
var Y12 = [
  ae.Copy,
  ae.SetCellStyle,
  ae.SetCellValue,
  ae.SetRowStyle,
  ae.SetColumnStyle,
  ae.InsertRow,
  ae.InsertColumn,
  ae.InsertHyperlink,
  ae.DeleteRow,
  ae.DeleteColumn,
  ae.Sort,
  ae.Filter,
  ae.PivotTable,
  ae.EditExtraObject,
  ae.View
];
var Om = "sheet-permission-menu-icon";
var Z12 = "sheet-permission-delete-icon";
var G12 = "sheet-permission-edit-icon";
var q12 = "sheet-permission-check-icon";
var Am = "sheet-permission-lock-icon";
var Q1 = {
  unitId: "",
  subUnitId: "",
  permissionId: "",
  unitType: x.SelectRange,
  id: "",
  ranges: [],
  viewState: Tu.OthersCanView,
  editState: Pu2.OnlyMe
};
var Rr3 = class {
  constructor() {
    _2(this, "_rule", Q1);
    _2(this, "_visible", false);
  }
  setVisible(e) {
    this._visible = e;
  }
  getVisible() {
    return this._visible;
  }
  reset() {
    this.setVisible(false);
  }
};
var Vr = class {
  constructor() {
    _2(this, "_userList", []);
    _2(this, "_userList$", new BehaviorSubject(this._userList));
    _2(this, "userList$", this._userList$.asObservable());
    _2(this, "_oldCollaboratorList", []);
    _2(this, "_selectUserList", []);
    _2(this, "_selectUserList$", new BehaviorSubject(this._selectUserList));
    _2(this, "selectUserList$", this._selectUserList$.asObservable());
  }
  get userList() {
    return this._userList;
  }
  // Set all editable users of this unit
  setCanEditUserList(e) {
    this._userList = e, this._userList$.next(e);
  }
  reset() {
    this._userList = [], this._oldCollaboratorList = [], this._selectUserList = [], this._selectUserList$.next([]);
  }
  get oldCollaboratorList() {
    return this._oldCollaboratorList;
  }
  setOldCollaboratorList(e) {
    this._oldCollaboratorList = e;
  }
  get selectUserList() {
    return this._selectUserList;
  }
  // The results of the user dialog selection panel should be rendered in the permission panel
  setSelectUserList(e) {
    this._selectUserList = e, this._selectUserList$.next(e);
  }
};
var Hn3 = {
  type: Ms.OPERATION,
  id: "sheet-permission.operation.openPanel",
  async handler(r, e = {}) {
    const t8 = r.get(we3), n = r.get(Rr3), i = r.get(Vr), { showDetail: o = true, fromSheetBar: s = false, rule: l, oldRule: a } = e, c = {
      header: { title: "permission.panel.title" },
      children: {
        label: yo2,
        showDetail: o,
        fromSheetBar: s,
        rule: l,
        oldRule: a
      },
      width: 330,
      onClose: () => {
        n.reset(), i.reset();
      }
    };
    return n.setVisible(true), t8.open(c), true;
  }
};
var ma2 = {
  type: Ms.COMMAND,
  id: "sheet.command.add-range-protection-from-toolbar",
  async handler(r) {
    return await r.get(Ls).executeCommand(Hn3.id, { showDetail: true }), true;
  }
};
var ii3 = {
  type: Ms.COMMAND,
  id: "sheet.command.add-range-protection-from-context-menu",
  async handler(r) {
    return await r.get(Ls).executeCommand(Hn3.id, { showDetail: true }), true;
  }
};
var oi3 = {
  type: Ms.COMMAND,
  id: "sheet.command.view-sheet-permission-from-context-menu",
  async handler(r) {
    return await r.get(Ls).executeCommand(Hn3.id, { showDetail: false }), true;
  }
};
var fa = {
  type: Ms.COMMAND,
  id: "sheet.command.add-range-protection-from-sheet-bar",
  async handler(r) {
    return await r.get(Ls).executeCommand(Hn3.id, { fromSheetBar: true, showDetail: true }), true;
  }
};
var pa2 = {
  type: Ms.COMMAND,
  id: "sheet.command.view-sheet-permission-from-sheet-bar",
  async handler(r) {
    return await r.get(Ls).executeCommand(Hn3.id, { showDetail: false }), true;
  }
};
var si3 = {
  type: Ms.COMMAND,
  id: "sheet.command.delete-range-protection-from-context-menu",
  async handler(r) {
    var u;
    const e = r.get(Ls), t8 = r.get(vr), n = r.get(Qo), i = r.get(z), o = r.get(lt), s = t8.getCurrentUnitForType(we.UNIVER_SHEET), l = s.getActiveSheet(), a = s.getUnitId(), c = l.getSheetId(), d = o.getRule(a, c);
    if (d != null && d.permissionId)
      return e.executeCommand(gc.id, { unitId: a, subUnitId: c, rule: d });
    {
      const h = (u = i.getCurrentLastSelection()) == null ? void 0 : u.range;
      if (!h)
        return false;
      const f2 = r.get(me).getSubunitRuleList(a, c).find((v2) => v2.ranges.some((p) => En.intersects(p, h)));
      if (f2) {
        const v2 = {
          unitId: a,
          subUnitId: c,
          ruleIds: [f2.id]
        };
        return await e.executeCommand(ot.id, v2) && n.pushUndoRedo({
          unitID: a,
          redoMutations: [{ id: ot.id, params: v2 }],
          undoMutations: [{ id: Be.id, params: { unitId: a, subUnitId: c, rules: [f2] } }]
        }), true;
      } else
        return false;
    }
  }
};
var li3 = {
  type: Ms.COMMAND,
  id: "sheet.command.set-range-protection-from-context-menu",
  async handler(r) {
    var d;
    const e = r.get(Ls), t8 = r.get(vr), n = r.get(z), i = r.get(lt), o = t8.getCurrentUnitForType(we.UNIVER_SHEET), s = o.getActiveSheet(), l = o.getUnitId(), a = s.getSheetId(), c = i.getRule(l, a);
    if (c != null && c.permissionId) {
      const u = {
        ...c,
        unitId: l,
        subUnitId: a,
        ranges: []
      };
      return await e.executeCommand(Hn3.id, { showDetail: true, rule: J.deepClone(u), oldRule: J.deepClone(u) }), true;
    } else {
      const u = (d = n.getCurrentLastSelection()) == null ? void 0 : d.range;
      if (!u)
        return false;
      const m2 = r.get(me).getSubunitRuleList(l, a).find((f2) => {
        var v2;
        return (v2 = f2 == null ? void 0 : f2.ranges) == null ? void 0 : v2.some((p) => En.intersects(p, u));
      });
      if (m2) {
        const f2 = {
          ...m2,
          unitId: l,
          subUnitId: a
        };
        return await e.executeCommand(Hn3.id, { showDetail: true, rule: J.deepClone(f2), oldRule: J.deepClone(f2) }), true;
      } else
        return false;
    }
  }
};
var va2 = {
  id: "sheet.command.refill",
  type: Ms.COMMAND,
  handler: async (r, e) => r.get(Hr).fillData(e.type)
};
var Mo3 = {
  id: "sheet.command.remove-row-confirm",
  type: Ms.COMMAND,
  handler: async (r, e) => {
    var c;
    const t8 = r.get(z);
    let n = e == null ? void 0 : e.range;
    if (n || (n = (c = t8.getCurrentLastSelection()) == null ? void 0 : c.range), !n)
      return false;
    const i = r.get(Ls), o = r.get(vr), s = P(o);
    if (!s) return false;
    const { worksheet: l } = s, a = l.getVisibleRows();
    if (Im(a, [n])) {
      const d = r.get(at), u = r.get(Fn);
      return await d.confirm({
        id: "sheet.confirm.remove-row",
        title: {
          title: u.t("info.problem")
        },
        children: { title: u.t("rightClick.deleteAllRowsAlert") },
        cancelText: u.t("button.cancel"),
        confirmText: u.t("button.confirm")
      }), false;
    }
    return await i.executeCommand(cs.id, { range: n }), true;
  }
};
var Eo4 = {
  id: "sheet.command.remove-col-confirm",
  type: Ms.COMMAND,
  handler: async (r, e) => {
    var c;
    const t8 = r.get(z);
    let n = e == null ? void 0 : e.range;
    if (n || (n = (c = t8.getCurrentLastSelection()) == null ? void 0 : c.range), !n)
      return false;
    const i = r.get(Ls), o = r.get(vr), s = P(o);
    if (!s) return false;
    const { worksheet: l } = s, a = l.getVisibleCols();
    if (ym(a, [n])) {
      const d = r.get(at), u = r.get(Fn);
      return await d.confirm({
        id: "sheet.confirm.remove-col",
        title: {
          title: u.t("info.problem")
        },
        children: { title: u.t("rightClick.deleteAllColumnsAlert") },
        cancelText: u.t("button.cancel"),
        confirmText: u.t("button.confirm")
      }), false;
    }
    return await i.executeCommand(ds.id, { range: n }), true;
  }
};
var Sa2 = {
  id: "sheet.command.remove-sheet-confirm",
  type: Ms.COMMAND,
  handler: async (r, e) => {
    const { subUnitId: t8 } = e, n = r.get(at), i = r.get(Ls), o = r.get(Fn);
    return await n.confirm({
      id: "sheet.confirm.remove-sheet",
      title: {
        title: o.t("sheetConfig.deleteSheet")
      },
      children: { title: o.t("sheetConfig.deleteSheetContent") },
      cancelText: o.t("button.cancel"),
      confirmText: o.t("button.confirm")
    }) ? (await i.executeCommand(Xs.id, { subUnitId: t8 }), true) : false;
  }
};
var K12 = Object.getOwnPropertyDescriptor;
var J1 = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? K12(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var Br2 = (r, e) => (t8, n) => e(t8, n, r);
var zt4 = ((r) => (r[r.OFF = 0] = "OFF", r[r.ONCE = 1] = "ONCE", r[r.INFINITE = 2] = "INFINITE", r))(zt4 || {});
var Dn2 = createIdentifier("univer.format-painter-service");
var sl2 = class extends Ve {
  constructor(e, t8, n, i, o, s) {
    super();
    _2(this, "status$");
    _2(this, "_selectionFormat");
    _2(this, "_markId", null);
    _2(this, "_status$");
    _2(this, "_defaultHook", null);
    _2(this, "_extendHooks", []);
    this._selectionManagerService = e, this._themeService = t8, this._markSelectionService = n, this._logService = i, this._commandService = o, this._undoRedoService = s, this._status$ = new BehaviorSubject(
      0
      /* OFF */
    ), this.status$ = this._status$.asObservable(), this._selectionFormat = { styles: new pt(), merges: [] };
  }
  addHook(e) {
    var t8, n, i;
    e.isDefaultHook && ((t8 = e.priority) != null ? t8 : 0) > ((i = (n = this._defaultHook) == null ? void 0 : n.priority) != null ? i : -1) ? this._defaultHook = e : (this._extendHooks.push(e), this._extendHooks.sort((o, s) => (o.priority || 0) - (s.priority || 0)));
  }
  getHooks() {
    return this._defaultHook ? [this._defaultHook, ...this._extendHooks] : this._extendHooks;
  }
  setStatus(e) {
    this._updateRangeMark(e), this._status$.next(e), this.getHooks().forEach((n) => {
      n.onStatusChange !== void 0 && n.onStatusChange(e);
    });
  }
  getStatus() {
    return this._status$.getValue();
  }
  setSelectionFormat(e) {
    this._selectionFormat = e;
  }
  getSelectionFormat() {
    return this._selectionFormat;
  }
  applyFormatPainter(e, t8, n) {
    const i = this.getHooks(), o = [], s = [];
    i.forEach((a) => {
      if (a.onApply !== void 0) {
        const c = a.onApply(
          e,
          t8,
          n,
          this._selectionFormat
        );
        c && (o.push(...c.redos), s.push(...c.undos));
      }
    });
    for (const a of i)
      if (a.onBeforeApply !== void 0 && !a.onBeforeApply({
        unitId: e,
        subUnitId: t8,
        range: n,
        redoMutationsInfo: o,
        format: this._selectionFormat,
        undoMutationsInfo: s
      }))
        return false;
    this._logService.log("[FormatPainterService]", "apply mutations", {
      undoMutationsInfo: s,
      redoMutationsInfo: o
    });
    const l = o.every((a) => this._commandService.executeCommand(a.id, a.params));
    return l && this._undoRedoService.pushUndoRedo({
      unitID: e,
      undoMutations: s,
      redoMutations: o
    }), l;
  }
  _updateRangeMark(e) {
    if (this._markSelectionService.removeAllShapes(), e !== 0) {
      const t8 = this._selectionManagerService.getCurrentLastSelection();
      if (t8) {
        const n = Cm2(this._themeService);
        e === 2 ? this._markId = this._markSelectionService.addShape({ ...t8, style: n }) : this._markId = this._markSelectionService.addShape({ ...t8, style: n }, [
          ee.id
        ]);
      }
    }
  }
};
sl2 = J1([
  Br2(0, Inject(z)),
  Br2(1, Inject(Gi)),
  Br2(2, Wi3),
  Br2(3, yt),
  Br2(4, Ls),
  Br2(5, Qo)
], sl2);
var Ca2 = {
  id: "sheet.operation.set-format-painter",
  type: Ms.OPERATION,
  handler: (r, e) => e ? (r.get(Dn2).setStatus(e.status), true) : false
};
var Qd2 = {
  type: Ms.COMMAND,
  id: "sheet.command.set-infinite-format-painter",
  handler: async (r) => {
    const t8 = r.get(Dn2).getStatus();
    let n;
    return t8 !== zt4.OFF ? n = zt4.OFF : n = zt4.INFINITE, r.get(Ls).executeCommand(Ca2.id, { status: n });
  }
};
var rs2 = {
  type: Ms.COMMAND,
  id: "sheet.command.set-once-format-painter",
  handler: async (r) => {
    const t8 = r.get(Dn2).getStatus();
    let n;
    return t8 !== zt4.OFF ? n = zt4.OFF : n = zt4.ONCE, r.get(Ls).executeCommand(Ca2.id, { status: n });
  }
};
var wa2 = {
  type: Ms.COMMAND,
  id: "sheet.command.apply-format-painter",
  handler: async (r, e) => r.get(Dn2).applyFormatPainter(e.unitId, e.subUnitId, e.range)
};
var $1 = Object.getOwnPropertyDescriptor;
var ew = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? $1(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var tw = (r, e) => (t8, n) => e(t8, n, r);
var Et2 = class {
  constructor(r, e) {
    _2(this, "_scrollStateMap", /* @__PURE__ */ new Map());
    _2(this, "_rawScrollInfo$", new BehaviorSubject(null));
    _2(this, "rawScrollInfo$", this._rawScrollInfo$.asObservable());
    _2(this, "validViewportScrollInfo$", new BehaviorSubject(null));
    _2(this, "_searchParamForScroll", null);
    this._context = r, this._sheetSkeletonManagerService = e;
  }
  dispose() {
    this._rawScrollInfo$.complete();
  }
  calcViewportScrollFromRowColOffset(r) {
    if (!r)
      return {
        viewportScrollX: 0,
        viewportScrollY: 0
      };
    let { sheetViewStartColumn: e, sheetViewStartRow: t8, offsetX: n, offsetY: i } = r;
    t8 = t8 || 0, i = i || 0;
    const o = this._sheetSkeletonManagerService.getCurrentSkeleton(), s = (o == null ? void 0 : o.rowHeightAccumulation[t8 - 1]) || 0, a = ((o == null ? void 0 : o.columnWidthAccumulation[e - 1]) || 0) + n, c = s + i;
    return {
      viewportScrollX: a,
      viewportScrollY: c
    };
  }
  setSearchParam(r) {
    this._searchParamForScroll = r;
  }
  getScrollStateByParam(r) {
    return this._getCurrentScroll(r);
  }
  getCurrentScrollState() {
    return this._getCurrentScroll(this._searchParamForScroll);
  }
  setValidScrollState(r) {
    this._setScrollState(r);
  }
  /**
   * emit raw scrollInfo by SetScrollOperation, call by ScrollCommand.id.
   * raw scrollInfo means not handled by limit scroll method.
   * @param param
   */
  emitRawScrollParam(r) {
    this._emitRawScroll(r);
  }
  /**
   * Set _scrollStateMap
   * @param scroll
   */
  setValidScrollStateToCurrSheet(r) {
    if (this._searchParamForScroll == null)
      return;
    this._setScrollState({
      ...this._searchParamForScroll,
      ...r
    });
    const e = this._searchParamForScroll.sheetId, t8 = this._sheetSkeletonManagerService.getSkeleton(e);
    t8 && t8.setScroll(r.viewportScrollX, r.viewportScrollY);
  }
  clear() {
    this._searchParamForScroll != null && this._clearByParamAndNotify(this._searchParamForScroll);
  }
  /**
   * scroll
   * @param scrollInfo
   */
  _setScrollState(r) {
    const { unitId: e, sheetId: t8, sheetViewStartColumn: n, sheetViewStartRow: i, offsetX: o, offsetY: s } = r;
    this._scrollStateMap.has(e) || this._scrollStateMap.set(e, /* @__PURE__ */ new Map());
    const l = this._scrollStateMap.get(e), a = {
      sheetViewStartRow: i,
      sheetViewStartColumn: n,
      offsetX: o,
      offsetY: s
    };
    l.set(t8, a);
  }
  _clearByParamAndNotify(r) {
    this._setScrollState({
      ...r,
      sheetViewStartRow: 0,
      sheetViewStartColumn: 0,
      offsetX: 0,
      offsetY: 0
    }), this._emitRawScroll({
      sheetViewStartRow: 0,
      sheetViewStartColumn: 0,
      offsetX: 0,
      offsetY: 0
    });
  }
  _getCurrentScroll(r) {
    var o;
    const e = {
      sheetViewStartRow: 0,
      sheetViewStartColumn: 0,
      offsetX: 0,
      offsetY: 0
    };
    if (r == null)
      return e;
    const { unitId: t8, sheetId: n } = r;
    return ((o = this._scrollStateMap.get(t8)) == null ? void 0 : o.get(n)) || e;
  }
  _emitRawScroll(r) {
    this._rawScrollInfo$.next(r);
  }
};
Et2 = ew([
  tw(1, Inject(ue))
], Et2);
var $n3 = {
  type: Ms.COMMAND,
  id: "sheet.command.set-selection-frozen",
  handler: async (r, e) => {
    const { type: t8 } = e || {}, n = r.get(vr), i = r.get(Qo), o = P(n);
    if (!o) return false;
    const { unitId: s, subUnitId: l } = o, a = r.get(Ls), d = r.get(z).getCurrentSelections();
    if (!d)
      return false;
    const u = d[(d == null ? void 0 : d.length) - 1], { range: h } = u, m2 = r.get(ME).getRenderById(s).with(Et2), { sheetViewStartRow: f2 = 0, sheetViewStartColumn: v2 = 0 } = m2.getCurrentScrollState() || {};
    let p, S, w, C;
    const { startRow: I2, startColumn: R, rangeType: y } = h;
    if (y === ge.ROW || t8 === 1)
      p = I2, w = I2 - f2, S = -1, C = 0;
    else if (y === ge.COLUMN || t8 === 2)
      p = -1, w = 0, S = R, C = R - v2;
    else if (y === ge.NORMAL)
      p = I2, w = I2 - f2, S = R, C = R - v2;
    else
      return false;
    const M7 = {
      unitId: s,
      subUnitId: l,
      startRow: p,
      startColumn: S,
      xSplit: S > 0 ? Math.max(1, C) : C,
      ySplit: p > 0 ? Math.max(1, w) : w
    }, E = ei(r, M7);
    return a.syncExecuteCommand(st.id, M7) && i.pushUndoRedo({
      unitID: s,
      undoMutations: [{ id: st.id, params: E }],
      redoMutations: [{ id: st.id, params: M7 }]
    }), true;
  }
};
var ba2 = {
  type: Ms.COMMAND,
  id: "sheet.command.set-row-frozen",
  handler: async (r) => (r.get(Ls).executeCommand($n3.id, {
    type: 1
    /* Row */
  }), true)
};
var _a2 = {
  type: Ms.COMMAND,
  id: "sheet.command.set-col-frozen",
  handler: async (r) => (r.get(Ls).executeCommand($n3.id, {
    type: 2
    /* Column */
  }), true)
};
var Kd2 = class extends Ve {
  constructor() {
    super(...arguments);
    _2(this, "rangesStack", []);
    _2(this, "selectedRangeWorksheet", "");
  }
};
var nw = Object.getOwnPropertyDescriptor;
var rw = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? nw(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var sh2 = (r, e) => (t8, n) => e(t8, n, r);
var Si3 = class {
  constructor(r, e) {
    _2(this, "_current", null);
    _2(this, "_shortcutParam", []);
    this._univerInstanceService = r, this._localeService = e;
  }
  dispose() {
    this._shortcutParam = [];
  }
  getCurrentBySearch(r) {
    return this._getCurrentBySearch(r);
  }
  getCurrent() {
    return this._getCurrentBySearch(this._current);
  }
  addOrUpdate(r) {
    const e = this._getCurrentBySearch({
      unitId: r.unitId,
      sheetId: r.sheetId,
      keycode: r.keycode
    });
    if (e != null) {
      const t8 = this._shortcutParam.indexOf(e);
      this._shortcutParam.splice(t8, 1);
    }
    return this._shortcutParam.push(r), e;
  }
  remove(r) {
    if (r == null)
      return;
    const e = this._getCurrentBySearch(r);
    if (e == null)
      return;
    const t8 = this._shortcutParam.indexOf(e);
    return this._shortcutParam.splice(t8, 1)[0];
  }
  _getCurrentBySearch(r) {
    return r == null ? void 0 : this._shortcutParam.find(
      (t8) => t8.unitId === r.unitId && t8.sheetId === r.sheetId && t8.keycode === r.keycode
    );
  }
};
Si3 = rw([
  sh2(0, vr),
  sh2(1, Inject(Fn))
], Si3);
var Ln4 = ((r) => (r[r.moveStopeOne = 0] = "moveStopeOne", r[r.moveGap = 1] = "moveGap", r[r.moveStepPage = 2] = "moveStepPage", r[r.moveStepEnd = 3] = "moveStepEnd", r))(Ln4 || {});
var Ut4 = {
  id: "sheet.command.move-selection",
  type: Ms.COMMAND,
  handler: (r, e) => {
    if (!e)
      return false;
    const t8 = P(r.get(vr));
    if (!t8) return false;
    const { workbook: n, worksheet: i } = t8, o = Bu(r, e.fromCurrentSelection).getCurrentLastSelection();
    if (!o)
      return false;
    const { direction: s, jumpOver: l, extra: a } = e, { range: c, primary: d } = o, u = zc3(c, d, s), h = l === 1 ? Zd2(u, s, i) : qn4(u, s, i), g = Uh(h.startRow, h.startColumn, i);
    if (En.equals(g, u))
      return false;
    const m2 = n.getUnitId();
    r.get(Si3).remove({
      unitId: m2,
      sheetId: i.getSheetId(),
      keycode: q1.TAB
    });
    const f2 = [
      {
        range: En.clone(g),
        primary: {
          startRow: g.startRow,
          startColumn: g.startColumn,
          endRow: g.endRow,
          endColumn: g.endColumn,
          actualRow: h.startRow,
          actualColumn: h.startColumn,
          isMerged: g.isMerged,
          isMergedMainCell: g.startRow === h.startRow && g.startColumn === h.startColumn
        }
      }
    ];
    return r.get(Ls).executeCommand(ie3.id, {
      unitId: n.getUnitId(),
      subUnitId: i.getSheetId(),
      selections: f2,
      type: we2.MOVE_END,
      extra: a,
      reveal: true
    });
  }
};
var Wn4 = {
  id: "sheet.command.move-selection-enter-tab",
  type: Ms.COMMAND,
  // eslint-disable-next-line max-lines-per-function, complexity
  handler: (r, e) => {
    var V2;
    if (!e)
      return false;
    const t8 = P(r.get(vr));
    if (!t8) return false;
    const { workbook: n, worksheet: i } = t8, o = Bu(r), { direction: s, keycode: l } = e, a = s === Cm.LEFT || s === Cm.UP, c = o.getCurrentSelections().concat(), d = c.findIndex((D2) => D2.primary), u = c[d];
    if (!u)
      return false;
    const h = a ? -1 : 1, g = d + h !== c.length ? c[d + h] : c[0], m2 = c.findIndex((D2) => D2 === g), f2 = n.getUnitId(), v2 = i.getSheetId();
    if (!u)
      return false;
    const { range: p } = u, S = u.primary;
    let w = zc3(p, S, s);
    const C = r.get(Si3), I2 = C.getCurrentBySearch({
      unitId: f2,
      sheetId: v2,
      keycode: q1.TAB
    });
    let R;
    const { startRow: y, endRow: M7, startColumn: E, endColumn: T } = p, P2 = a ? S.startRow === y && S.startColumn === E : S.endRow === M7 && S.endColumn === T;
    if (En.equals(p, S)) {
      if (l === q1.TAB)
        I2 == null && C.addOrUpdate({
          unitId: f2,
          sheetId: v2,
          keycode: q1.TAB,
          selection: u
        });
      else {
        const B = I2 == null ? void 0 : I2.selection;
        if (B != null) {
          const { range: j, primary: G7 } = B;
          w = zc3(j, G7, s);
        }
        C.remove({
          unitId: f2,
          sheetId: v2,
          keycode: q1.TAB
        });
      }
      const D2 = qn4(w, s, i), X2 = Uh(D2.startRow, D2.startColumn, i);
      if (En.equals(X2, w))
        return false;
      R = {
        range: En.clone(X2),
        primary: {
          startRow: X2.startRow,
          startColumn: X2.startColumn,
          endRow: X2.endRow,
          endColumn: X2.endColumn,
          actualRow: D2.startRow,
          actualColumn: D2.startColumn,
          isMerged: X2.isMerged,
          isMergedMainCell: X2.startRow === D2.startRow && X2.startColumn === D2.startColumn
        }
      };
    } else {
      C.remove({
        unitId: f2,
        sheetId: v2,
        keycode: q1.TAB
      });
      const D2 = J.deepClone(S), X2 = P2 ? g.range : qn4(
        {
          startRow: D2.startRow,
          startColumn: D2.startColumn,
          endRow: D2.endRow,
          endColumn: D2.endColumn
        },
        s,
        i,
        {
          startRow: y,
          endRow: M7,
          startColumn: E,
          endColumn: T
        }
      ), B = P2 && a, j = B ? Uh(X2.endRow, X2.endColumn, i) : Uh(X2.startRow, X2.startColumn, i);
      R = {
        range: P2 ? g.range : En.clone(p),
        primary: {
          startRow: j.startRow,
          startColumn: j.startColumn,
          endRow: j.endRow,
          endColumn: j.endColumn,
          actualRow: B ? j.startRow : X2.startRow,
          actualColumn: B ? j.startColumn : X2.startColumn,
          isMerged: j.isMerged,
          isMergedMainCell: j.startRow === X2.startRow && j.startColumn === X2.startColumn
        },
        style: P2 ? g.style : u.style
      };
    }
    P2 ? (c[d].primary = null, c[m2] = R, o.setSelections(f2, v2, [], we2.MOVE_END)) : c[d] = R;
    const H3 = r.get(Ls).executeCommand(ie3.id, {
      unitId: f2,
      subUnitId: v2,
      type: we2.MOVE_END,
      selections: c,
      reveal: true,
      extra: e.extra
    }), x7 = (V2 = r.get(ME).getRenderById(f2)) == null ? void 0 : V2.with(gt);
    return x7 == null || x7.refreshSelectionMoveEnd(), H3;
  }
};
var Gt3 = {
  id: "sheet.command.expand-selection",
  type: Ms.COMMAND,
  handler: (r, e) => {
    if (!e) return false;
    const t8 = P(r.get(vr));
    if (!t8) return false;
    const { worksheet: n, unitId: i, subUnitId: o } = t8, s = Bu(r).getCurrentLastSelection();
    if (!s) return false;
    const { range: l, primary: a } = s, { jumpOver: c, direction: d, extra: u } = e, g = z12(s, d, n) ? c === 1 ? U12(
      l,
      { ...En.clone(a), rangeType: ge.NORMAL },
      d,
      n
    ) : X12(l, d, n) : c === 1 ? B13(l, d, n) : F1(l, d, n);
    return g.rangeType = s.range.rangeType, En.equals(g, l) ? false : r.get(Ls).syncExecuteCommand(ie3.id, {
      unitId: i,
      subUnitId: o,
      type: we2.MOVE_END,
      selections: [
        {
          range: g,
          primary: a
          // this remains unchanged
        }
      ],
      extra: u,
      reveal: true
    });
  }
};
var Ra2 = {
  id: "sheet.command.select-all",
  type: Ms.COMMAND,
  // eslint-disable-next-line max-lines-per-function
  handler: async (r, e = { expandToGapFirst: true, loop: false }) => {
    const t8 = P(r.get(vr));
    if (!t8) return false;
    const n = Bu(r).getCurrentLastSelection();
    if (!n) return false;
    const i = r.get(Kd2), { worksheet: o, unitId: s, subUnitId: l } = t8, a = `${s}|${l}`;
    a !== i.selectedRangeWorksheet && (i.rangesStack = [], i.selectedRangeWorksheet = a);
    const c = o.getMaxRows(), d = o.getMaxColumns(), { expandToGapFirst: u, loop: h } = e, { range: g, primary: m2 } = n, f2 = g.endColumn === d - 1 && g.endRow === c - 1 && g.startRow === 0 && g.startColumn === 0;
    i.rangesStack.some((I2) => En.equals(I2, g)) || (i.rangesStack = [], i.rangesStack.push(g));
    let v2;
    if (f2)
      if (h) {
        if (i.rangesStack.findIndex((R) => En.equals(R, g)) !== i.rangesStack.length - 1)
          return false;
        v2 = i.rangesStack[0];
      } else
        return false;
    else u ? (v2 = ph(g, { left: true, right: true, up: true, down: true }, o), En.equals(v2, g) && (v2 = oh2(o))) : v2 = oh2(o);
    i.rangesStack.some((I2) => En.equals(I2, v2)) || i.rangesStack.push(v2);
    const p = [];
    p.push({
      id: ie3.id,
      params: {
        unitId: s,
        subUnitId: l,
        reveal: true,
        selections: [
          {
            range: v2,
            primary: m2
            // this remains unchanged
          }
        ]
      }
    });
    const w = r.get(G).onCommandExecute({
      id: Ra2.id,
      params: { range: g }
    });
    w.redos.length && p.push(...w.redos);
    const C = r.get(Ls);
    return fo(p, C), true;
  }
};
function iw(r) {
  return typeof r.isMainScene > "u";
}
function en4(r, e) {
  const t8 = r instanceof ws ? r : r.getCurrentUnitForType(we.UNIVER_SHEET);
  if (!t8) return null;
  const n = t8.getUnitId();
  let i, o, s, l;
  if (iw(e)) {
    const h = e.getRenderById(n);
    if (h == null) return null;
    i = h.components, i = h.components, o = h.mainComponent, s = h.scene, l = h.engine;
  } else
    i = e.components, o = e.mainComponent, s = e.scene, l = e.engine;
  if (!i || !o) return null;
  const a = o, c = i.get(Ye3.ROW), d = i.get(Ye3.COLUMN), u = i.get(Ye3.LEFT_TOP);
  return {
    spreadsheet: a,
    spreadsheetRowHeader: c,
    spreadsheetColumnHeader: d,
    spreadsheetLeftTopPlaceholder: u,
    scene: s,
    engine: l
  };
}
function lh2(r, e, t8, n) {
  const { startX: i, startY: o, endX: s, endY: l } = n.getCellWithCoordByIndex(r, e);
  return { startX: i, startY: o, endX: s, endY: l };
}
function Vn3(r, e, t8, n, i, o) {
  const s = t8.getCoordRelativeToViewport(U.FromArray([r, e])), { x: l, y: a } = s, c = t8.getScrollXYInfoByViewport(s, i), { scaleX: d, scaleY: u } = t8.getAncestorScale(), h = n.getCellIndexByOffset(
    l,
    a,
    d,
    u,
    c,
    { closeFirst: o }
  ), { row: g, column: m2 } = h, f2 = n.getNoMergeCellWithCoordByIndex(g, m2), { startX: v2, startY: p, endX: S, endY: w } = f2;
  return {
    startX: v2,
    startY: p,
    endX: S,
    endY: w,
    row: g,
    column: m2
  };
}
function Os3(r, e, t8, n) {
  const i = t8.getCoordRelativeToViewport(U.FromArray([r, e])), o = t8.getViewport(k2.VIEW_MAIN), s = t8.getScrollXYInfoByViewport(i, o), { scaleX: l, scaleY: a } = t8.getAncestorScale(), { x: c, y: d } = s, u = r / l + c, h = e / a + d;
  return { x: u, y: h };
}
var ow = Object.getOwnPropertyDescriptor;
var sw = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? ow(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var Fr = (r, e) => (t8, n) => e(t8, n, r);
Ut4.id, Wn4.id;
var lw = 3;
var Ci3 = class extends Ve {
  constructor(r, e, t8, n, i, o, s) {
    super(), this._context = r, this._injector = e, this._sheetSkeletonManagerService = t8, this._contextService = n, this._commandService = i, this._renderManagerService = o, this._scrollManagerService = s, this._initCommandListener(), this._wheelEventListener(), this._scrollBarEventListener(), this._initSkeletonListener();
  }
  _wheelEventListener() {
    const { scene: r } = this._context;
    if (!r) return;
    const e = r.getViewport(k2.VIEW_MAIN);
    e && this.disposeWithMe(
      r.onMouseWheel$.subscribeEvent((t8, n) => {
        if (t8.ctrlKey || !this._contextService.getContextValue(gr))
          return;
        let i = 0, o = 0;
        i = t8.deltaX, t8.shiftKey ? i = (t8.deltaY || t8.deltaX) * lw : o = t8.deltaY, this._commandService.executeCommand(To2.id, { offsetX: i, offsetY: o }), this._context.scene.makeDirty(true);
        const s = e.limitedScroll(e.scrollX + i, e.scrollY + o);
        s && !s.isLimitedX && !s.isLimitedY && (t8.preventDefault(), r.getParent().classType === V.SCENE_VIEWER && n.stopPropagation()), e.isWheelPreventDefaultX && e.isWheelPreventDefaultY && t8.preventDefault();
      })
    );
  }
  // eslint-disable-next-line max-lines-per-function
  _scrollBarEventListener() {
    const { scene: r } = this._context;
    if (r == null) return;
    const e = r.getViewport(k2.VIEW_MAIN);
    e && (this.disposeWithMe(
      We(
        this._scrollManagerService.rawScrollInfo$.subscribe((t8) => {
          var g;
          const n = (g = this._sheetSkeletonManagerService.getCurrentParam()) == null ? void 0 : g.skeleton;
          if (!n) return;
          if (t8 == null) {
            e.scrollToViewportPos({
              viewportScrollX: 0,
              viewportScrollY: 0
            });
            return;
          }
          const { sheetViewStartRow: i, sheetViewStartColumn: o, offsetX: s, offsetY: l, duration: a } = t8, { startX: c, startY: d } = n.getCellWithCoordByIndex(
            i,
            o,
            false
          ), u = c + s, h = d + l;
          e.scrollAnimationFrameId !== null && cancelAnimationFrame(e.scrollAnimationFrameId), a ? this._smoothScrollToViewportPos({ viewportMain: e, viewportScrollX: u, viewportScrollY: h, duration: a }) : e.scrollToViewportPos({ viewportScrollX: u, viewportScrollY: h });
        })
      )
    ), this.disposeWithMe(
      // set scrollInfo, the event is triggered in viewport@_scrollToScrollbarPos
      e.onScrollAfter$.subscribeEvent((t8) => {
        var m2;
        const n = (m2 = this._sheetSkeletonManagerService.getCurrentParam()) == null ? void 0 : m2.skeleton;
        if (n == null || t8.isTrigger === false)
          return;
        const i = this._getSheetObject();
        if (n == null || i == null)
          return;
        const { viewportScrollX: o, viewportScrollY: s, scrollX: l, scrollY: a } = t8, { row: c, column: d, rowOffset: u, columnOffset: h } = n.getOffsetRelativeToRowCol(
          o,
          s
        ), g = {
          sheetViewStartRow: c,
          sheetViewStartColumn: d,
          offsetX: h,
          offsetY: u,
          viewportScrollX: o,
          viewportScrollY: s,
          scrollX: l,
          scrollY: a
        };
        this._scrollManagerService.setValidScrollStateToCurrSheet(g), this._scrollManagerService.validViewportScrollInfo$.next({
          ...g,
          viewportScrollX: o,
          viewportScrollY: s,
          scrollX: l,
          scrollY: a
        });
      })
    ), this.disposeWithMe(
      // get scrollByBar event from viewport and exec ScrollCommand.id.
      e.onScrollByBar$.subscribeEvent((t8) => {
        var u;
        const n = (u = this._sheetSkeletonManagerService.getCurrentParam()) == null ? void 0 : u.skeleton;
        if (n == null || t8.isTrigger === false)
          return;
        const i = this._getSheetObject();
        if (n == null || i == null)
          return;
        const { viewportScrollX: o = 0, viewportScrollY: s = 0 } = t8;
        this._getFreeze();
        const { row: l, column: a, rowOffset: c, columnOffset: d } = n.getOffsetRelativeToRowCol(
          o,
          s
        );
        this._commandService.executeCommand(mn3.id, {
          sheetViewStartRow: l,
          sheetViewStartColumn: a,
          offsetX: d,
          offsetY: c
        });
      })
    ));
  }
  _initSkeletonListener() {
    this.disposeWithMe(We(
      this._sheetSkeletonManagerService.currentSkeletonBefore$.subscribe((r) => {
        if (r == null)
          return;
        const e = { unitId: r.unitId, sheetId: r.sheetId };
        if (this._scrollManagerService.setSearchParam(e), !this._getSheetObject()) return;
        const n = this._scrollManagerService.getScrollStateByParam(e), { viewportScrollX: i, viewportScrollY: o } = this._scrollManagerService.calcViewportScrollFromRowColOffset(n);
        n && this._updateViewportScroll(i, o);
      })
    ));
  }
  _smoothScrollToViewportPos(r) {
    const { viewportMain: e, viewportScrollX: t8, viewportScrollY: n, duration: i } = r, o = performance.now(), s = e.viewportScrollX, l = e.viewportScrollY, a = t8 - s, c = n - l;
    function d(u) {
      const h = u - o, g = Math.min(h / i, 1), m2 = 1 - (1 - g) ** 3, f2 = s + a * m2, v2 = l + c * m2;
      e.scrollToViewportPos({
        viewportScrollX: f2,
        viewportScrollY: v2
      }), g < 1 ? e.scrollAnimationFrameId = requestAnimationFrame(d) : e.scrollAnimationFrameId = null;
    }
    e.scrollAnimationFrameId = requestAnimationFrame(d);
  }
  _updateViewportScroll(r = 0, e = 0) {
    const t8 = this._getSheetObject();
    if (!t8) return;
    const n = t8.scene, i = n.getViewport(k2.VIEW_MAIN), o = n.getViewport(k2.VIEW_COLUMN_RIGHT), s = n.getViewport(k2.VIEW_ROW_BOTTOM), l = n.getViewport(k2.VIEW_MAIN_LEFT), a = n.getViewport(k2.VIEW_MAIN_TOP);
    i && (i.viewportScrollX = r, i.viewportScrollY = e), s && (s.viewportScrollY = e), o && (o.viewportScrollX = r), l && (l.viewportScrollY = e), a && (a.viewportScrollX = r);
  }
  scrollToRange(r, e, t8) {
    let { endRow: n, endColumn: i, startColumn: o, startRow: s } = r;
    const l = this._getViewportBounding();
    if (r.rangeType === ge.ROW ? (o = 0, i = 0) : r.rangeType === ge.COLUMN && (s = 0, n = 0), l && !e && !t8) {
      const a = l.startRow > n ? s : n, c = l.startColumn > i ? o : i;
      return this._scrollToCell(a, c);
    } else
      return this._scrollToCell(s, o, e, t8);
  }
  /**
   * Scroll spreadsheet(viewMain) to cell position. Based on the limitations of viewport and the number of rows and columns, you can only scroll to the maximum scrollable range.
   *
   * if column A ~ B is frozen. set second param to 0 would make viewMain start at column C.
   * set second param to 2 would make viewMain start at column E.
   * @param {number} row - Cell row
   * @param {number} column - Cell column
   * @returns {boolean} - true if scroll is successful
   */
  scrollToCell(r, e, t8) {
    const n = this._context.unit.getActiveSheet(), {
      ySplit: i,
      xSplit: o
    } = n.getFreeze();
    return this._commandService.syncExecuteCommand(mn3.id, {
      sheetViewStartRow: r - i,
      sheetViewStartColumn: e - o,
      offsetX: 0,
      offsetY: 0,
      duration: t8
    });
  }
  _initCommandListener() {
    this.disposeWithMe(this._commandService.onCommandExecuted((r) => {
      switch (r.id) {
        case ie3.id:
          {
            const e = r.params;
            e.unitId === this._context.unitId && e.reveal && this._scrollToSelection();
          }
          break;
        case Cd.id:
          {
            const e = r.params;
            if (e.unitId === this._context.unitId) {
              const t8 = e.range;
              this.scrollToRange(t8);
            }
          }
          break;
        case Gt3.id:
          {
            const e = r.params;
            this._scrollToSelectionForExpand(e);
          }
          break;
      }
    }));
  }
  _scrollToSelectionForExpand(r) {
    setTimeout(() => {
      const e = this._getSelectionsService().getCurrentLastSelection();
      if (e == null)
        return;
      const { startRow: t8, startColumn: n, endRow: i, endColumn: o } = e.range, s = this._getViewportBounding();
      if (s == null)
        return;
      const { startRow: l, startColumn: a, endRow: c, endColumn: d } = s;
      let u = 0, h = 0;
      t8 > l ? u = i : i < c ? u = t8 : u = l, n > a ? h = o : o < d ? h = n : h = a, r.direction === Cm.DOWN ? u = i : r.direction === Cm.UP ? u = t8 : r.direction === Cm.RIGHT ? h = o : r.direction === Cm.LEFT && (h = n), this._scrollToCell(u, h);
    }, 0);
  }
  _getFreeze() {
    var e;
    const r = (e = this._sheetSkeletonManagerService.getCurrentParam()) == null ? void 0 : e.skeleton.getWorksheetConfig();
    if (r != null)
      return r.freeze;
  }
  _updateSceneSize(r) {
    var d;
    if (r == null)
      return;
    const { unitId: e } = this._context, { skeleton: t8 } = r, n = (d = this._renderManagerService.getRenderById(e)) == null ? void 0 : d.scene;
    if (t8 == null || n == null)
      return;
    const { rowTotalHeight: i, columnTotalWidth: o, rowHeaderWidthAndMarginLeft: s, columnHeaderHeightAndMarginTop: l } = t8;
    this._context.unit.getActiveSheet() && (n == null || n.transformByState({
      width: s + o,
      height: l + i
    }));
  }
  _getSheetObject() {
    return en4(this._context.unit, this._context);
  }
  _scrollToSelectionByDirection(r) {
    const e = this._getViewportBounding();
    if (e == null)
      return false;
    const {
      startRow: t8,
      startColumn: n,
      endRow: i,
      endColumn: o
    } = e;
    let s = 0, l = 0;
    const { startRow: a, startColumn: c, endRow: d, endColumn: u } = r;
    a >= t8 && (s = d), d <= i && (s = a), c >= n && (l = u), u <= o && (l = c), this._scrollToCell(s, l);
  }
  _scrollToSelection(r = true) {
    var a;
    const e = this._getSelectionsService().getCurrentLastSelection();
    if (!e) return;
    const { startRow: t8, startColumn: n, actualRow: i, actualColumn: o } = (a = e.primary) != null ? a : e.range, s = r && i != null ? i : t8, l = r && o != null ? o : n;
    this._scrollToCell(s, l);
  }
  _getSelectionsService() {
    return Bu(this._injector);
  }
  _getViewportBounding() {
    var i, o;
    const r = (i = this._getSheetObject()) == null ? void 0 : i.scene;
    if (r == null)
      return;
    const e = r.getViewport(k2.VIEW_MAIN);
    if (e == null)
      return;
    const t8 = (o = this._sheetSkeletonManagerService.getCurrentParam()) == null ? void 0 : o.skeleton;
    if (t8 == null)
      return;
    const n = e.calcViewportInfo();
    return t8.getRangeByViewBound(n.viewBound);
  }
  // For arrow key to active cell cause scrolling.
  // eslint-disable-next-line max-lines-per-function, complexity
  _scrollToCell(r, e, t8 = false, n = false) {
    var E, T, P2;
    const { rowHeightAccumulation: i, columnWidthAccumulation: o } = (E = this._sheetSkeletonManagerService.getCurrentSkeleton()) != null ? E : {};
    if (i == null || o == null) return false;
    const s = (T = this._getSheetObject()) == null ? void 0 : T.scene;
    if (s == null) return false;
    const l = s.getViewport(k2.VIEW_MAIN);
    if (l == null) return false;
    const a = (P2 = this._sheetSkeletonManagerService.getCurrentParam()) == null ? void 0 : P2.skeleton;
    if (a == null) return false;
    const c = this._context.unit.getActiveSheet();
    if (!c) return false;
    r = J.clamp(r, 0, i.length - 1), e = J.clamp(e, 0, o.length - 1);
    const {
      startColumn: d,
      startRow: u,
      ySplit: h,
      xSplit: g
    } = c.getFreeze(), m2 = this._getViewportBounding();
    if (m2 == null) return false;
    const {
      startRow: f2,
      startColumn: v2,
      endRow: p,
      endColumn: S
    } = m2;
    let w, C;
    if (r >= u && e >= d - h && (r <= f2 && (w = r, t8 = true), r >= p)) {
      const H3 = i[r] - l.height;
      for (let A = f2; A <= r && (w = A + 1, !(i[A] >= H3)); A++)
        ;
    }
    if (e >= d && r >= u - h && (e <= v2 && (C = e, n = true), e >= S)) {
      const H3 = o[e] - l.width;
      for (let A = v2; A <= e && (C = A + 1, !(o[A] >= H3)); A++)
        ;
    }
    if (w === void 0 && C === void 0) return false;
    let { offsetX: I2, offsetY: R, sheetViewStartRow: y, sheetViewStartColumn: M7 } = this._scrollManagerService.getCurrentScrollState() || {};
    if (w = w ? Math.min(w, r) : y + h, C = C ? Math.min(C, e) : M7 + g, n) {
      I2 = 0, C = e;
      const H3 = a.getHiddenColumnsInRange({ startColumn: C - g, endColumn: C });
      C = C - H3.length;
    }
    if (t8) {
      R = 0, w = r;
      const H3 = a.getHiddenRowsInRange({ startRow: w - h, endRow: w });
      w = w - H3.length;
    }
    return this._commandService.syncExecuteCommand(mn3.id, {
      // sheetViewStartRow & offsetX should never be undefined, it's rendering, there should always be a value!
      // sheetViewStartRow: forceTop ? Math.max(0, row - freezeYSplit) : ((startSheetViewRow ?? 0) - freezeYSplit),
      // sheetViewStartColumn: forceLeft ? Math.max(0, column - freezeXSplit) : ((startSheetViewColumn ?? 0) - freezeXSplit),
      // offsetX: startSheetViewColumn === undefined ? offsetX : 0,
      // offsetY: startSheetViewRow === undefined ? offsetY : 0,
      sheetViewStartRow: Math.max(0, w - h),
      sheetViewStartColumn: Math.max(0, C - g),
      offsetX: I2,
      offsetY: R
    });
  }
};
Ci3 = sw([
  Fr(1, Inject(Injector)),
  Fr(2, Inject(ue)),
  Fr(3, Nr),
  Fr(4, Ls),
  Fr(5, ME),
  Fr(6, Inject(Et2))
], Ci3);
var gn2 = {
  id: "sheet.operation.set-scroll",
  type: Ms.OPERATION,
  handler: (r, e) => {
    if (!e)
      return false;
    const { unitId: t8, sheetId: n, offsetX: i = 0, offsetY: o = 0, sheetViewStartColumn: s, sheetViewStartRow: l, duration: a, screenRatioX: c, screenRatioY: d } = e, u = r.get(ME), h = u.getRenderById(t8).with(Et2), g = u.getRenderById(t8);
    if (!g)
      return false;
    const m2 = g.engine, f2 = m2.width, v2 = m2.height, p = c !== void 0 ? f2 * c + i : i, S = d !== void 0 ? v2 * d + o : o;
    return h.emitRawScrollParam({
      unitId: t8,
      sheetId: n,
      offsetX: p,
      offsetY: S,
      sheetViewStartRow: l,
      sheetViewStartColumn: s,
      duration: a
    }), true;
  }
};
var To2 = {
  id: "sheet.command.set-scroll-relative",
  type: Ms.COMMAND,
  // offsetXY derived from mouse wheel event
  // this._commandService.executeCommand(SetScrollRelativeCommand.id, { offsetY });
  handler: async (r, e) => {
    const t8 = r.get(Ls), n = r.get(vr), i = r.get(ME), o = P(n);
    if (!o) return false;
    const { unitId: s, subUnitId: l } = o, c = i.getRenderById(s).with(Et2).getCurrentScrollState(), { offsetX: d = 0, offsetY: u = 0 } = e || {}, {
      sheetViewStartRow: h = 0,
      sheetViewStartColumn: g = 0,
      offsetX: m2 = 0,
      offsetY: f2 = 0
    } = c || {};
    return t8.executeCommand(gn2.id, {
      unitId: s,
      sheetId: l,
      // why + ySplit? receiver - ySplit in scroll.operation.ts
      // sheetViewStartRow: sheetViewStartRow + ySplit,
      // sheetViewStartColumn: sheetViewStartColumn + xSplit,
      sheetViewStartRow: h,
      sheetViewStartColumn: g,
      offsetX: m2 + d,
      // currentOffsetX + offsetX may be negative or over max
      offsetY: f2 + u
    });
  }
};
var mn3 = {
  id: "sheet.command.scroll-view",
  type: Ms.COMMAND,
  handler: (r, e) => {
    if (!e)
      return false;
    const t8 = r.get(vr), n = r.get(ME), i = P(t8);
    if (!i) return false;
    const { workbook: o, worksheet: s, unitId: l } = i, c = n.getRenderById(l).with(Et2).getCurrentScrollState();
    if (!s)
      return false;
    const { sheetViewStartRow: d, sheetViewStartColumn: u, offsetX: h, offsetY: g, duration: m2 } = e, {
      sheetViewStartColumn: f2,
      sheetViewStartRow: v2,
      offsetX: p,
      offsetY: S
    } = c || {}, { xSplit: w, ySplit: C } = i.worksheet.getConfig().freeze;
    return r.get(Ls).syncExecuteCommand(gn2.id, {
      unitId: o.getUnitId(),
      sheetId: s.getSheetId(),
      // why + ySplit? receiver - ySplit in scroll.operation.ts
      // sheetViewStartRow: sheetViewStartRow + ySplit,
      // sheetViewStartColumn: sheetViewStartColumn + xSplit,
      sheetViewStartRow: d != null ? d : v2 != null ? v2 : 0 + C,
      sheetViewStartColumn: u != null ? u : f2 != null ? f2 : 0 + w,
      offsetX: h != null ? h : p,
      offsetY: g != null ? g : S,
      duration: m2
    });
  }
};
var Hm2 = {
  id: "sheet.command.scroll-to-cell",
  type: Ms.COMMAND,
  handler: (r, e) => {
    const t8 = r.get(vr);
    return r.get(ME).getRenderById(t8.getCurrentUnitForType(we.UNIVER_SHEET).getUnitId()).with(Ci3).scrollToRange(e.range, e.forceTop, e.forceLeft);
  }
};
var Zy = {
  id: "sheet.command.scroll-view-reset",
  type: Ms.COMMAND,
  handler: async (r) => {
    const e = r.get(vr), t8 = P(e);
    if (!t8) return false;
    const { subUnitId: n, unitId: i } = t8;
    return r.get(Ls).executeCommand(gn2.id, {
      unitId: i,
      sheetId: n,
      sheetViewStartRow: 0,
      sheetViewStartColumn: 0
    });
  }
};
var aw = Object.getOwnPropertyDescriptor;
var cw = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? aw(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var ah2 = (r, e) => (t8, n) => e(t8, n, r);
var dw = (r, e) => {
  const { unitId: t8, subUnitId: n, ranges: i } = r, o = {}, s = e.getColumnManager();
  for (let l = 0; l < i.length; l++) {
    const a = i[l];
    for (let c = a.startColumn; c < a.endColumn + 1; c++)
      o[c] = s.getColumnWidth(c);
  }
  return {
    unitId: t8,
    subUnitId: n,
    ranges: i,
    colWidth: o
  };
};
var Ir2 = class extends Ve {
  constructor(r, e) {
    super(), this._renderManagerService = r, this._univerInstanceService = e;
  }
  getUndoRedoParamsOfColWidth(r) {
    const e = { redos: [], undos: [] }, { _univerInstanceService: t8 } = this, n = P(t8);
    if (!n) return e;
    const { unitId: i, subUnitId: o, worksheet: s } = n, l = this._renderManagerService.getRenderById(i).with(ue);
    if (!l.getCurrentParam()) return e;
    const { skeleton: a } = l.getCurrentParam(), c = a.calculateAutoWidthInRange(r.ranges), d = {};
    for (const { col: g, width: m2 } of c)
      d[g] = m2;
    const u = {
      subUnitId: o,
      unitId: i,
      ranges: r.ranges,
      colWidth: d
    }, h = dw(u, s);
    return {
      undos: [
        {
          id: mt.id,
          params: h
        }
      ],
      redos: [
        {
          id: mt.id,
          params: u
        }
      ]
    };
  }
};
Ir2 = cw([
  ah2(0, ME),
  ah2(1, Inject(vr))
], Ir2);
var is2 = {
  type: Ms.COMMAND,
  id: "sheet.command.set-col-auto-width",
  handler: (r, e) => {
    const t8 = r.get(Ls), n = r.get(Qo), i = r.get(z), o = r.get(vr), s = P(o, e);
    if (!s) return false;
    const { unitId: l, subUnitId: a } = s;
    let c = [];
    if (e != null && e.ranges)
      c = [...e.ranges];
    else {
      const m2 = i.getCurrentSelections();
      for (let f2 = 0; f2 < m2.length; f2++)
        c.push(m2[f2].range);
    }
    if (!(c != null && c.length))
      return false;
    const d = {
      unitId: l,
      subUnitId: a,
      ranges: c
    }, { redos: u, undos: h } = r.get(Ir2).getUndoRedoParamsOfColWidth(d);
    return fo([...u], t8).result ? (n.pushUndoRedo({
      unitID: l,
      undoMutations: [...h],
      redoMutations: [...u]
    }), true) : false;
  }
};
var uw = Object.getOwnPropertyDescriptor;
var hw = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? uw(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var Ur = (r, e) => (t8, n) => e(t8, n, r);
var ll = class extends Ve {
  constructor(e, t8, n, i, o, s) {
    super();
    _2(this, "_editorUnitId", Dl);
    _2(this, "_editorIsDirty", false);
    _2(this, "_visibleParams", {
      visible: false,
      eventType: Kv.Dblclick,
      unitId: ""
    });
    _2(this, "_currentEditCell", null);
    _2(this, "_currentEditCellState", null);
    _2(this, "_currentEditCellLayout", null);
    _2(this, "helpFunctionVisible$", new BehaviorSubject(true));
    _2(this, "_currentEditCellState$", new BehaviorSubject(null));
    _2(this, "currentEditCellState$", this._currentEditCellState$.asObservable());
    _2(this, "_currentEditCellLayout$", new BehaviorSubject(null));
    _2(this, "currentEditCellLayout$", this._currentEditCellLayout$.asObservable());
    _2(this, "currentEditCell$", this._currentEditCellState$.pipe(
      switchMap((e8) => this._currentEditCellLayout$.pipe(map((t10) => e8 && t10 ? { ...e8, ...t10 } : null)))
    ));
    _2(this, "_visibleParams$", new BehaviorSubject(this._visibleParams));
    _2(this, "visible$", this._visibleParams$.asObservable());
    _2(this, "_afterVisibleParams$", new BehaviorSubject(this._visibleParams));
    _2(this, "afterVisible$", this._afterVisibleParams$.asObservable());
    _2(this, "_forceKeepVisible$", new BehaviorSubject(false));
    _2(this, "forceKeepVisible$", this._forceKeepVisible$.asObservable());
    this._sheetInterceptorService = e, this._renderManagerService = t8, this._themeService = n, this._univerInstanceService = i, this._editorService = o, this._contextService = s, this.disposeWithMe(We(() => {
      this._currentEditCellState$.complete(), this._currentEditCell = null;
    })), this._univerInstanceService.getTypeOfUnitDisposed$(we.UNIVER_SHEET).subscribe((l) => {
      var a;
      l.getUnitId() === ((a = this._currentEditCellState) == null ? void 0 : a.unitId) && this._clearCurrentEditCellState();
    });
  }
  refreshEditCellState() {
    const e = this.getLatestEditCellState();
    if (!e) {
      this._currentEditCellState = null, this._currentEditCellLayout = null, this._currentEditCellState$.next(null), this._currentEditCellLayout$.next(null);
      return;
    }
    const { position: t8, scaleX: n, scaleY: i, canvasOffset: o, ...s } = e;
    this._currentEditCellState = s, this._currentEditCellLayout = { position: t8, scaleX: n, scaleY: i, canvasOffset: o }, this._currentEditCellState$.next(this._currentEditCellState), this._currentEditCellLayout$.next(this._currentEditCellLayout);
  }
  refreshEditCellPosition(e) {
    var C;
    const t8 = this._currentEditCell;
    if (t8 == null)
      return;
    const n = this._univerInstanceService.getCurrentUnitForType(we.UNIVER_SHEET);
    if (!n) return;
    const i = this._renderManagerService.getRenderUnitById(n.getUnitId());
    if (!i) return;
    const o = (C = i.with(ue).getSkeletonParam(t8.sheetId)) == null ? void 0 : C.skeleton, s = i.with(gt);
    if (!o || !this._currentEditCellState) return;
    const { primary: l, scene: a, engine: c } = t8, d = Ks(o, l);
    if (d == null)
      return;
    const u = zg(d), h = AA(c);
    let { startX: g, startY: m2, endX: f2, endY: v2 } = u;
    const { scaleX: p, scaleY: S } = a.getAncestorScale(), w = a.getViewportScrollXY(s.getViewPort());
    g = PB(g, p, w), m2 = NB(m2, S, w), f2 = PB(f2, p, w), v2 = NB(v2, S, w), e && this._currentEditCellLayout && (f2 = f2 - g + this._currentEditCellLayout.position.startX, v2 = v2 - m2 + this._currentEditCellLayout.position.startY, g = this._currentEditCellLayout.position.startX, m2 = this._currentEditCellLayout.position.startY), this._currentEditCellLayout = {
      position: {
        startX: g,
        startY: m2,
        endX: f2,
        endY: v2
      },
      canvasOffset: h,
      scaleX: p,
      scaleY: S
    }, this._currentEditCellLayout$.next(this._currentEditCellLayout);
  }
  setEditCell(e) {
    this._currentEditCell = e, this._editorService.getFocusEditor() || (this._editorService.focus(Dl), this._contextService.setContextValue(mE, false), this._contextService.setContextValue(DR, false));
    const t8 = this.getLatestEditCellState();
    if (!t8) {
      this._currentEditCellState = t8, this._currentEditCellLayout = t8, this._currentEditCellState$.next(t8), this._currentEditCellLayout$.next(t8);
      return;
    }
    const { position: n, canvasOffset: i, scaleX: o, scaleY: s, ...l } = t8;
    this._currentEditCellState = l, this._currentEditCellLayout = { position: n, canvasOffset: i, scaleX: o, scaleY: s }, this._currentEditCellState$.next(this._currentEditCellState), this._currentEditCellLayout$.next(this._currentEditCellLayout);
  }
  _clearCurrentEditCellState() {
    this._currentEditCellState = null, this._currentEditCellState$.next(null), this._currentEditCellLayout = null, this._currentEditCellLayout$.next(null);
  }
  getEditCellState() {
    return this._currentEditCellState == null || this._currentEditCellLayout == null ? null : { ...this._currentEditCellState, ...this._currentEditCellLayout };
  }
  getEditCellLayout() {
    return this._currentEditCellLayout;
  }
  getEditLocation() {
    return this._currentEditCellState;
  }
  updateEditLocation(e, t8) {
    this._currentEditCellState && (this._currentEditCellState = {
      ...this._currentEditCellState,
      row: e,
      column: t8
    });
  }
  // eslint-disable-next-line max-lines-per-function, complexity
  getLatestEditCellState() {
    var H3, A, x7;
    const e = this._currentEditCell;
    if (e == null) return;
    const t8 = this._univerInstanceService.getCurrentUnitForType(we.UNIVER_SHEET);
    if (!t8) return;
    const n = this._renderManagerService.getRenderUnitById(t8.getUnitId());
    if (!n) return;
    const i = n.with(ue).getCurrentSkeleton(), o = n.with(gt);
    if (!i) return;
    const { primary: s, unitId: l, sheetId: a, scene: c, engine: d } = e, { startRow: u, startColumn: h } = s, g = Ks(i, s);
    if (g == null) return;
    const m2 = zg(g), f2 = AA(d);
    let { startX: v2, startY: p, endX: S, endY: w } = m2;
    const { scaleX: C, scaleY: I2 } = c.getAncestorScale(), R = c.getViewportScrollXY(o.getViewPort());
    v2 = PB(v2, C, R), p = NB(p, I2, R), S = PB(S, C, R), w = NB(w, I2, R);
    const y = t8.getActiveSheet();
    if (!y) return;
    const M7 = {
      workbook: t8,
      worksheet: y,
      unitId: t8.getUnitId(),
      subUnitId: y.getSheetId(),
      row: u,
      col: h,
      origin: y.getCellRaw(u, h)
    };
    let E;
    const T = this._sheetInterceptorService.writeCellInterceptor.fetchThroughInterceptors(uo)(
      y.getCell(u, h),
      M7
    );
    E = T && y.getCellDocumentModelWithFormula(T, M7.row, M7.col);
    const P2 = (H3 = E == null ? void 0 : E.documentModel) == null ? void 0 : H3.documentStyle.renderConfig;
    if (P2 != null && (P2.cellValueType = fn.STRING), !E || E.documentModel == null) {
      const V2 = y.getBlankCellDocumentModel(T, M7.row, M7.col);
      if (E != null) {
        const { verticalAlign: D2, horizontalAlign: X2, wrapStrategy: B, textRotation: j, fill: G7 } = E, { centerAngle: ge2, vertexAngle: Re3 } = A3(j);
        V2.documentModel.documentStyle.renderConfig = {
          ...P2,
          verticalAlign: D2,
          horizontalAlign: X2,
          wrapStrategy: B,
          background: { rgb: G7 },
          centerAngle: ge2,
          vertexAngle: Re3
        };
      }
      E = V2;
    }
    if (E.fill = E.fill || "#fff", (A = E.documentModel) == null || A.setZoomRatio(Math.max(C, I2)), (T == null ? void 0 : T.isInArrayFormulaRange) === true) {
      const V2 = (x7 = E.documentModel) == null ? void 0 : x7.getBody();
      V2 && (V2.textRuns = [
        {
          st: 0,
          ed: V2.dataStream.length - 2,
          ts: {
            cl: {
              rgb: this._themeService.getColorFromTheme("gray.600")
            }
          }
        }
      ]);
    }
    return {
      position: {
        startX: v2,
        startY: p,
        endX: S,
        endY: w
      },
      scaleX: C,
      scaleY: I2,
      canvasOffset: f2,
      row: u,
      column: h,
      unitId: l,
      sheetId: a,
      documentLayoutObject: E,
      editorUnitId: this._editorUnitId,
      isInArrayFormulaRange: T == null ? void 0 : T.isInArrayFormulaRange
    };
  }
  getCurrentEditorId() {
    return this._editorUnitId;
  }
  changeVisible(e) {
    this._visibleParams = e, e.visible && (this._editorIsDirty = false), this._visibleParams$.next(this._visibleParams), this._afterVisibleParams$.next(this._visibleParams);
  }
  isVisible() {
    return this._visibleParams;
  }
  enableForceKeepVisible() {
    this._forceKeepVisible$.next(true);
  }
  disableForceKeepVisible() {
    this._forceKeepVisible$.next(false);
  }
  isForceKeepVisible() {
    return this._forceKeepVisible$.getValue();
  }
  changeEditorDirty(e) {
    this._editorIsDirty = e;
  }
  getEditorDirty() {
    return this._editorIsDirty;
  }
};
ll = hw([
  Ur(0, Inject(G)),
  Ur(1, ME),
  Ur(2, Inject(Gi)),
  Ur(3, vr),
  Ur(4, Ge2),
  Ur(5, Nr)
], ll);
var qe5 = createIdentifier("univer.sheet-editor-bridge.service");
var gw = Object.getOwnPropertyDescriptor;
var mw = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? gw(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var ws3 = (r, e) => (t8, n) => e(t8, n, r);
var Po3 = class extends Ve {
  constructor(e, t8, n, i, o) {
    super();
    _2(this, "_zoom");
    this._context = e, this._sheetSkeletonManagerService = t8, this._commandService = n, this._contextService = i, this._editorBridgeService = o, this._initSkeletonListener(), this._initZoomEventListener();
  }
  updateZoom(e, t8) {
    const n = this._context.unit.getSheetBySheetId(e);
    return n ? (n.getConfig().zoomRatio = t8, n === this._context.unit.getActiveSheet() && this._updateViewZoom(t8), true) : false;
  }
  _initZoomEventListener() {
    const e = en4(this._context.unit, this._context).scene;
    this.disposeWithMe(
      // hold ctrl & mousewheel ---> zoom
      e.onMouseWheel$.subscribeEvent((t8) => {
        if (!t8.ctrlKey || !this._contextService.getContextValue(gr))
          return;
        if (this._editorBridgeService) {
          const c = this._editorBridgeService.isVisible();
          if ((c.unitId === this._context.unitId || c.unitId === Ul) && c.visible)
            return;
        }
        const n = Math.abs(t8.deltaX);
        let i = n < 40 ? 0.2 : n < 80 ? 0.4 : 0.2;
        i *= t8.deltaY > 0 ? -1 : 1, e.scaleX < 1 && (i /= 2);
        const o = this._context.unit, s = o.getActiveSheet();
        if (!s) return;
        const l = s.getZoomRatio();
        let a = +Number.parseFloat(`${l + i}`).toFixed(1);
        a = a >= 4 ? 4 : a <= 0.1 ? 0.1 : a, this._commandService.executeCommand(ss3.id, {
          zoomRatio: Math.round(a * 10) / 10,
          unitId: o.getUnitId(),
          subUnitId: s.getSheetId()
        }), t8.preventDefault();
      })
    );
  }
  _initSkeletonListener() {
    this.disposeWithMe(this._sheetSkeletonManagerService.currentSkeleton$.subscribe((e) => {
      if (e == null)
        return;
      const n = this._context.unit.getActiveSheet();
      if (!n) return;
      const i = n.getZoomRatio() || 1;
      this._zoom !== i && this._updateViewZoom(i);
    }));
  }
  /**
   * Triggered when zoom and switch sheet.
   * @param zoomRatio
   */
  _updateViewZoom(e) {
    this._zoom = e;
    const t8 = en4(this._context.unit, this._context);
    t8 == null || t8.scene.scale(e, e), t8 == null || t8.spreadsheet.makeForceDirty();
  }
};
Po3 = mw([
  ws3(1, Inject(ue)),
  ws3(2, Ls),
  ws3(3, Nr),
  ws3(4, Optional(qe5))
], Po3);
var Jt3 = {
  id: "sheet.operation.set-zoom-ratio",
  type: Ms.OPERATION,
  handler: (r, e) => {
    const n = r.get(ME).getRenderById(e.unitId);
    return n ? n.with(Po3).updateZoom(e.subUnitId, e.zoomRatio) : false;
  }
};
var os2 = {
  id: "sheet.command.change-zoom-ratio",
  type: Ms.COMMAND,
  handler: (r, e) => {
    if (!e)
      return false;
    const t8 = r.get(vr), n = P(t8);
    if (!n) return false;
    const { worksheet: i, subUnitId: o, unitId: s } = n, { delta: l, reset: a } = e;
    let c = a ? 100 : Math.round((i.getConfig().zoomRatio + l) * 100);
    c = Math.max(Lc[0], c), c = Math.min(Lc[1], c);
    const d = c / 100, h = r.get(qe5).isVisible();
    return (h.unitId === s || h.unitId === Ul) && h.visible ? false : r.get(Ls).executeCommand(Jt3.id, {
      unitId: s,
      subUnitId: o,
      zoomRatio: d
    });
  }
};
var ss3 = {
  id: "sheet.command.set-zoom-ratio",
  type: Ms.COMMAND,
  handler: (r, e) => {
    if (!e)
      return false;
    const { unitId: t8, subUnitId: n, zoomRatio: i } = e, s = r.get(qe5).isVisible();
    return (s.unitId === t8 || s.unitId === Ul) && s.visible ? false : r.get(Ls).executeCommand(Jt3.id, {
      unitId: t8,
      subUnitId: n,
      zoomRatio: i
    });
  }
};
var Nr3 = createIdentifier("univer.sheetbar-service");
var Vm2 = class extends Ve {
  constructor() {
    super();
    _2(this, "renameId$");
    _2(this, "removeId$");
    _2(this, "scroll$");
    _2(this, "scrollX$");
    _2(this, "addSheet$");
    _2(this, "_renameId$");
    _2(this, "_removeId$");
    _2(this, "_scroll$");
    _2(this, "_scrollX$");
    _2(this, "_addSheet$");
    _2(this, "_currentHandler", null);
    this._renameId$ = new Subject(), this.renameId$ = this._renameId$.asObservable(), this._removeId$ = new Subject(), this.removeId$ = this._removeId$.asObservable(), this._scroll$ = new Subject(), this.scroll$ = this._scroll$.asObservable(), this._scrollX$ = new Subject(), this.scrollX$ = this._scrollX$.asObservable(), this._addSheet$ = new Subject(), this.addSheet$ = this._addSheet$.asObservable();
  }
  setRenameId(t8) {
    this._renameId$.next(t8);
  }
  setRemoveId(t8) {
    this._removeId$.next(t8);
  }
  setScroll(t8) {
    this._scroll$.next(t8);
  }
  setScrollX(t8) {
    this._scrollX$.next(t8);
  }
  setAddSheet(t8) {
    this._addSheet$.next(t8);
  }
  triggerSheetBarMenu() {
    var t8;
    (t8 = this._currentHandler) == null || t8.handleSheetBarMenu();
  }
  registerSheetBarMenuHandler(t8) {
    if (this._currentHandler)
      throw new Error("There is already a context menu handler!");
    return this._currentHandler = t8, We(() => {
      this._currentHandler = null;
    });
  }
};
var Ia2 = {
  id: "ui-sheet.command.show-menu-list",
  type: Ms.OPERATION,
  handler: async (r) => (r.get(Nr3).triggerSheetBarMenu(), true)
};
var ya2 = {
  type: Ms.COMMAND,
  id: "sheet.command.delete-worksheet-protection-from-sheet-bar",
  async handler(r, e) {
    if (!e)
      return false;
    const t8 = r.get(Ls), n = r.get(Qo), i = r.get(lt), s = r.get(vr).getCurrentUnitForType(Tm.UNIVER_SHEET), l = s == null ? void 0 : s.getActiveSheet(), a = s.getUnitId();
    if (!l)
      return false;
    const c = l.getSheetId(), d = i.getRule(a, c);
    if (await t8.executeCommand(gc.id, {
      unitId: a,
      subUnitId: c
    })) {
      const h = [{ id: gc.id, params: { unitId: a, subUnitId: c } }], g = [{ id: ac.id, params: { unitId: a, rule: d } }];
      n.pushUndoRedo({
        unitID: a,
        redoMutations: h,
        undoMutations: g
      });
    }
    return true;
  }
};
var Ma2 = {
  type: Ms.COMMAND,
  id: "sheet.command.change-sheet-protection-from-sheet-bar",
  async handler(r) {
    return await r.get(Ls).executeCommand("sheet-permission.operation.openDialog"), true;
  }
};
var Jd2 = {
  id: "sheet.operation.set-activate-cell-edit",
  type: Ms.OPERATION,
  handler: (r, e) => (r.get(qe5).setEditCell(e), true)
};
var tt3 = {
  id: "sheet.operation.set-cell-edit-visible",
  type: Ms.OPERATION,
  handler: (r, e) => {
    if (!e)
      return false;
    const { unitId: t8 } = e, i = r.get(vr).getCurrentUnitForType(we.UNIVER_SHEET);
    return i ? (r.get(qe5).changeVisible({
      ...e,
      unitId: t8 != null ? t8 : i.getUnitId()
    }), true) : false;
  }
};
var Ea2 = {
  id: "sheet.operation.set-cell-edit-visible-f2",
  type: Ms.OPERATION,
  handler: (r, e) => {
    const t8 = r.get(Ls), i = r.get(vr).getCurrentUnitForType(we.UNIVER_SHEET);
    return i ? t8.syncExecuteCommand(tt3.id, {
      ...e,
      unitId: i.getUnitId()
    }) : false;
  }
};
var wi4 = {
  id: "sheet.operation.set-cell-edit-visible-arrow",
  type: Ms.OPERATION,
  handler: () => true
};
var Ta2 = {
  id: "sheet.operation.rename-sheet",
  type: Ms.OPERATION,
  handler: async (r, e) => {
    const t8 = r.get(Nr3);
    return e && t8.setRenameId(e.subUnitId), true;
  }
};
var $d2 = {
  id: "sheet.operation.scroll-to-range",
  type: Ms.OPERATION,
  handler: (r, e) => {
    if (!e)
      return false;
    const t8 = r.get(vr);
    return r.get(ME).getRenderById(t8.getCurrentUnitForType(we.UNIVER_SHEET).getUnitId()).with(Ci3).scrollToRange(e.range, e.forceTop, e.forceLeft);
  }
};
var Nm = {
  type: Ms.OPERATION,
  id: "sheet-permission.operation.openDialog",
  async handler(r, e) {
    const t8 = r.get(ct2);
    return t8.close("DESKTOP_FIND_REPLACE_DIALOG"), t8.open({
      id: ol,
      title: { title: "permission.dialog.allowedPermissionType" },
      children: { label: xm },
      width: 393,
      destroyOnClose: true,
      onClose: () => t8.close(ol)
    }), true;
  }
};
var xo2 = "DefinedNameContainer";
var eu2 = {
  id: "sidebar.operation.defined-name",
  type: Ms.COMMAND,
  handler: async (r, e) => {
    const t8 = r.get(we3);
    r.get(Ge2);
    const n = r.get(Fn), i = r.get(vr), o = P(i);
    if (!o) return false;
    const { unitId: s } = o;
    switch (e.value) {
      case "open":
        t8.open({
          id: xo2,
          header: { title: n.t("definedName.featureTitle") },
          children: { label: xo2 },
          onClose: () => {
          },
          width: 333
        });
        break;
      case "close":
      default:
        t8.close();
        break;
    }
    return true;
  }
};
function fw(r, e) {
  if (r.length !== e.length) return false;
  const t8 = r.sort((i, o) => i.id.localeCompare(o.id)), n = e.sort((i, o) => i.id.localeCompare(o.id));
  return t8.every((i, o) => {
    var s, l;
    return ((s = i.subject) == null ? void 0 : s.userID) === ((l = n[o].subject) == null ? void 0 : l.userID) && i.role === n[o].role;
  });
}
function km(r, e) {
  return e.some((t8) => pw(r, t8));
}
function pw(r, e) {
  const { startRow: t8, startColumn: n, endColumn: i, endRow: o } = e, s = r.getMatrixWithMergedCells(t8, n, o, i);
  let l = false;
  return s.forValue((a, c, d) => {
    if (d && (a !== t8 || c !== n) && r.cellHasValue(d))
      return l = true, false;
  }), l;
}
function Dm(r, e, t8, n) {
  const i = [], o = [], s = t8.getSheetId();
  return n.forEach((l) => {
    const a = vw(t8, l), c = {
      unitId: e,
      subUnitId: s,
      cellValue: a.getData()
    }, d = Ae(
      r,
      c
    );
    i.push({ id: ee.id, params: d }), o.push({ id: ee.id, params: c });
  }), {
    undos: i,
    redos: o
  };
}
function vw(r, e) {
  const { startRow: t8, startColumn: n, endColumn: i, endRow: o } = e, s = r.getMatrixWithMergedCells(t8, n, o, i, or.Raw), l = new pt();
  let a = null;
  return s.forValue((c, d, u) => {
    var h, g, m2, f2;
    u && c >= t8 && d >= n && (!a && r.cellHasValue(u) && (u.v !== "" || ((f2 = (m2 = (g = (h = u.p) == null ? void 0 : h.body) == null ? void 0 : g.dataStream) == null ? void 0 : m2.length) != null ? f2 : 0) > 2) && (a = u), l.setValue(c, d, null));
  }), l.setValue(t8, n, a), l;
}
function Sw(r, e, t8, n) {
  const i = t8.getActiveViewportByCoord(
    U.FromArray([r, e])
  );
  if (!i)
    return;
  const { scaleX: o, scaleY: s } = t8.getAncestorScale(), l = {
    x: i.viewportScrollX,
    y: i.viewportScrollY
  }, a = n.getCellIndexByOffset(r, e, o, s, l), c = n.worksheet.getMergedCell(a.row, a.column);
  return {
    actualRow: c ? c.startRow : a.row,
    actualCol: c ? c.startColumn : a.column,
    mergeCell: c,
    row: a.row,
    col: a.column
  };
}
function ch2(r, e, t8, n) {
  const i = n.getFreeze();
  if (!i || i.startRow <= 0 && i.startColumn <= 0)
    return t8.getViewport(k2.VIEW_MAIN);
  if (r >= i.startRow && e >= i.startColumn)
    return t8.getViewport(k2.VIEW_MAIN);
  if (r < i.startRow && e < i.startColumn)
    return t8.getViewport(k2.VIEW_MAIN_LEFT_TOP);
  if (r < i.startRow && e >= i.startColumn)
    return t8.getViewport(k2.VIEW_MAIN_TOP);
  if (r >= i.startRow && e < i.startColumn)
    return t8.getViewport(k2.VIEW_MAIN_LEFT);
}
function Cw(r, e, t8, n) {
  const i = dh2(r.left, r.top, e, t8, n), o = dh2(r.right, r.bottom, e, t8, n);
  return {
    left: i.x,
    top: i.y,
    right: o.x,
    bottom: o.y
  };
}
function dh2(r, e, t8, n, i) {
  const { scaleX: o, scaleY: s } = t8.getAncestorScale(), l = t8.getViewport(k2.VIEW_MAIN);
  if (!l)
    return {
      x: r,
      y: e
    };
  const a = i.getFreeze(), { startColumn: c, startRow: d, xSplit: u, ySplit: h } = a, g = n.getNoMergeCellWithCoordByIndex(d - h, c - u, false), m2 = n.getNoMergeCellWithCoordByIndex(d, c, false), { rowHeaderWidth: f2, columnHeaderHeight: v2 } = n, p = m2.startX - g.startX, S = m2.startY - g.startY, { top: w, left: C, viewportScrollX: I2, viewportScrollY: R } = l;
  let y;
  r > C ? y = (r - I2) * o : y = (p + f2 - (C - r)) * o;
  let M7;
  return e > w ? M7 = (e - R) * s : M7 = (S + v2 - (w - e)) * o, {
    x: y,
    y: M7
  };
}
function ww(r, e, t8, n, i) {
  let o = n, s = i;
  t8.overflowCache.forValue((c, d, u) => {
    u.startRow <= o && u.endRow >= o && u.startColumn <= s && u.endColumn >= s && (s = d, o = c);
  });
  const l = t8.getCellWithCoordByIndex(o, s);
  return {
    unitId: r.getUnitId(),
    subUnitId: e.getSheetId(),
    workbook: r,
    worksheet: e,
    row: l.actualRow,
    col: l.actualColumn
  };
}
function Lm(r, e, t8, n, i, o) {
  const { scene: s } = r, l = e.getUnitId(), { skeleton: a, sheetId: c } = n, d = Sw(i, o, s, a);
  if (!d)
    return null;
  let { actualCol: u, actualRow: h } = d;
  const g = {
    unitId: l,
    subUnitId: c,
    workbook: e,
    worksheet: t8,
    row: h,
    col: u
  };
  a.overflowCache.forValue((R, y, M7) => {
    M7.startRow <= h && M7.endRow >= h && M7.startColumn <= u && M7.endColumn >= u && (u = y, h = R);
  });
  const m2 = a.getCellWithCoordByIndex(h, u), f2 = ww(e, t8, a, h, u);
  let v2;
  m2.mergeInfo ? v2 = m2.mergeInfo : v2 = {
    startRow: f2.row,
    endRow: f2.row,
    startColumn: f2.col,
    endColumn: f2.col
  };
  const p = s.getActiveViewportByCoord(
    U.FromArray([i, o])
  );
  if (!p)
    return;
  const { scaleX: S, scaleY: w } = s.getAncestorScale(), C = {
    x: p.viewportScrollX,
    y: p.viewportScrollY
  };
  return {
    position: {
      startX: (a.getOffsetByColumn(v2.startColumn - 1) - C.x) * S,
      endX: (a.getOffsetByColumn(v2.endColumn) - C.x) * S,
      startY: (a.getOffsetByRow(v2.startRow - 1) - C.y) * w,
      endY: (a.getOffsetByRow(v2.endRow) - C.y) * w
    },
    location: g,
    overflowLocation: f2
  };
}
function kr() {
  const r = useDependency(vr), e = useObservable(() => r.getCurrentTypeOfUnit$(we.UNIVER_SHEET), void 0, void 0, []);
  return e != null ? e : null;
}
function Gy(r) {
  return useObservable(() => {
    var t8;
    return (t8 = r == null ? void 0 : r.activeSheet$) != null ? t8 : of(null);
  }, void 0, void 0, [r]);
}
function qy() {
  const r = useDependency(vr);
  return useObservable(() => merge([
    r.getTypeOfUnitAdded$(we.UNIVER_SHEET),
    r.getTypeOfUnitDisposed$(we.UNIVER_SHEET)
  ]).pipe(
    map(() => r.getAllUnitsForType(we.UNIVER_SHEET)),
    startWith(r.getAllUnitsForType(we.UNIVER_SHEET))
  ), [], void 0, [r]);
}
var Qy = "SheetUI";
var Wm2 = ((r) => (r.FILTER_PANEL_EMBED_POINT = "filter-panel-embed-point", r.SHEETS_FOOTER = "sheets-footer", r.FORMULA_AUX = "formula-aux", r))(Wm2 || {});
var bw = Object.getOwnPropertyDescriptor;
var _w = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? bw(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var bs3 = (r, e) => (t8, n) => e(t8, n, r);
var uh2 = "univer-sheet-main-canvas";
var ir3 = class extends h1 {
  constructor(e, t8, n, i) {
    super();
    _2(this, "_skeletonChangeMutations", /* @__PURE__ */ new Set());
    this._contextService = e, this._instanceSrv = t8, this._renderManagerService = n, this._themeService = i, Promise.resolve().then(() => this._init());
  }
  /**
   * Register a mutation id that will trigger the skeleton change.
   *
   * @param mutationId the id of the mutation
   * @returns a disposable to unregister the mutation
   */
  registerSkeletonChangingMutations(e) {
    return this._skeletonChangeMutations.has(e) ? We(() => {
    }) : (this._skeletonChangeMutations.add(e), We(() => this._skeletonChangeMutations.delete(e)));
  }
  /**
   * Examine if a mutation would make the skeleton to change.
   */
  checkMutationShouldTriggerRerender(e) {
    return this._skeletonChangeMutations.has(e);
  }
  _init() {
    this._initWorkbookListener(), this._initContextListener();
  }
  _initWorkbookListener() {
    this._instanceSrv.getTypeOfUnitAdded$(we.UNIVER_SHEET).pipe(takeUntil(this.dispose$)).subscribe((e) => this._createRenderer(e)), this._instanceSrv.getAllUnitsForType(we.UNIVER_SHEET).forEach((e) => this._createRenderer(e)), this._instanceSrv.getTypeOfUnitDisposed$(we.UNIVER_SHEET).pipe(takeUntil(this.dispose$)).subscribe((e) => this._disposeRenderer(e));
  }
  _createRenderer(e) {
    const t8 = e.getUnitId();
    this._renderManagerService.created$.subscribe((n) => {
      n.unitId === t8 && (n.engine.getCanvas().setId(`${uh2}_${t8}`), n.engine.getCanvas().getContext().setId(`${uh2}_${t8}`));
    }), this._renderManagerService.createRender(t8);
  }
  _disposeRenderer(e) {
    const t8 = e.getUnitId();
    this._renderManagerService.removeRender(t8);
  }
  _initContextListener() {
    this.disposeWithMe(this._contextService.subscribeContextValue$(hx).pipe(distinctUntilChanged()).subscribe(() => {
      this._renderManagerService.getRenderAll().forEach((e) => {
        e.mainComponent instanceof YB && e.mainComponent.makeForceDirty(true);
      });
    }));
  }
};
ir3 = _w([
  bs3(0, Nr),
  bs3(1, vr),
  bs3(2, ME),
  bs3(3, Inject(Gi))
], ir3);
var Rw = Object.getOwnPropertyDescriptor;
var Iw = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? Rw(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var lr2 = (r, e) => (t8, n) => e(t8, n, r);
var bi3 = class extends Ve {
  constructor(e, t8, n, i, o, s, l) {
    super();
    _2(this, "_beforeApplyData", []);
    _2(this, "_currentLocation", null);
    _2(this, "_copyData", []);
    _2(this, "_defaultHook");
    this._univerInstanceService = e, this._commandService = t8, this._autoFillService = n, this._editorBridgeService = i, this._renderManagerService = o, this._injector = s, this._sheetsRenderService = l, this._defaultHook = {
      id: "default",
      type: Kr2.Default,
      priority: 0,
      onBeforeFillData: (a, c) => this._presetAndCacheData(a, c),
      onFillData: (a, c, d) => this._fillData(a, c, d)
    }, this._init();
  }
  _init() {
    this._initDefaultHook(), this._initSelectionControlFillChanged(), this._initQuitListener(), this._initSkeletonChange();
  }
  _initSkeletonChange() {
    this.disposeWithMe(this._sheetsRenderService.registerSkeletonChangingMutations(gr3.id));
  }
  _initDefaultHook() {
    this.disposeWithMe(this._autoFillService.addHook(this._defaultHook));
  }
  _initQuitListener() {
    const e = [
      tt3.id,
      _o3.id,
      Sn.id,
      Jt3.id,
      pn2.id,
      It.id,
      Te.id,
      Me.id,
      Ue.id,
      ke2.id,
      Je2.id,
      qe2.id,
      mt.id,
      nt.id,
      ee.id
    ];
    this.disposeWithMe(this._commandService.onCommandExecuted((t8, n) => {
      var l, a;
      const i = n == null ? void 0 : n.fromCollab, o = n == null ? void 0 : n.fromSync, s = n == null ? void 0 : n.fromFormula;
      e.includes(t8.id) && !i && !o && !s && t8.params.trigger !== gr3.id && t8.params.trigger !== va2.id && this._quit(), t8.id === Ht.id && t8.params.unitId === ((l = this._currentLocation) == null ? void 0 : l.unitId) && t8.params.subUnitId === ((a = this._currentLocation) == null ? void 0 : a.subUnitId) && this._quit();
    })), this.disposeWithMe(this._univerInstanceService.unitDisposed$.subscribe((t8) => {
      var n;
      t8.getUnitId() === ((n = this._currentLocation) == null ? void 0 : n.unitId) && this._quit();
    }));
  }
  _quit() {
    this._currentLocation = null, this._beforeApplyData = [], this._copyData = [], this._autoFillService.setShowMenu(false);
  }
  _initSelectionControlFillChanged() {
    const e = new ao(), t8 = () => {
      e.dispose();
      const n = IE(we.UNIVER_SHEET, this._univerInstanceService, this._renderManagerService);
      if (!n) return;
      n.with(gt).getSelectionControls().forEach((s) => {
        e.add(s.selectionFilled$.subscribe((l) => {
          if (l == null || l.startColumn === -1 || l.startRow === -1 || l.endColumn === -1 || l.endRow === -1)
            return;
          const a = {
            startColumn: s.model.startColumn,
            endColumn: s.model.endColumn,
            startRow: s.model.startRow,
            endRow: s.model.endRow
          }, c = {
            startColumn: l.startColumn,
            endColumn: l.endColumn,
            startRow: l.startRow,
            endRow: l.endRow
          };
          this._commandService.executeCommand(gr3.id, { sourceRange: a, targetRange: c });
        })), e.add(s.fillControl.onDblclick$.subscribeEvent(() => {
          const l = {
            startColumn: s.model.startColumn,
            endColumn: s.model.endColumn,
            startRow: s.model.startRow,
            endRow: s.model.endRow
          };
          this._handleDbClickFill(l);
        })), e.add(s.fillControl.onPointerDown$.subscribeEvent(() => {
          this._editorBridgeService.isVisible().visible && this._commandService.syncExecuteCommand(
            tt3.id,
            {
              visible: false,
              eventType: Kv.PointerDown,
              unitId: n.unitId
            }
          );
        }));
      });
    };
    t8(), this.disposeWithMe(this._commandService.onCommandExecuted((n) => {
      n.id === ie3.id && t8();
    })), this.disposeWithMe(this._univerInstanceService.getCurrentTypeOfUnit$(we.UNIVER_SHEET).subscribe(() => t8()));
  }
  _handleDbClickFill(e) {
    const t8 = this._detectFillRange(e);
    t8.endRow <= e.endRow || this._commandService.executeCommand(gr3.id, { sourceRange: e, targetRange: t8 });
  }
  _detectFillRange(e) {
    var u, h, g, m2, f2, v2;
    const { startRow: t8, endRow: n, startColumn: i, endColumn: o } = e, s = (u = this._univerInstanceService.getCurrentUnitForType(we.UNIVER_SHEET)) == null ? void 0 : u.getActiveSheet();
    if (!s)
      return e;
    const l = s.getCellMatrix(), a = s.getMaxRows() - 1, c = s.getMaxColumns() - 1;
    let d = n;
    if (i > 0 && ((h = l.getValue(t8, i - 1)) == null ? void 0 : h.v) != null) {
      let p = t8;
      for (; ((g = l.getValue(p, i - 1)) == null ? void 0 : g.v) != null && p < a; )
        p += 1;
      d = p - 1;
    } else if (o < c && ((m2 = l.getValue(n, o + 1)) == null ? void 0 : m2.v) != null) {
      let p = t8;
      for (; ((f2 = l.getValue(p, o + 1)) == null ? void 0 : f2.v) != null && p < a; )
        p += 1;
      d = p - 1;
    }
    for (let p = n + 1; p <= d; p++)
      for (let S = i; S <= o; S++)
        if (((v2 = l.getValue(p, S)) == null ? void 0 : v2.v) != null) {
          d = p - 1;
          break;
        }
    return {
      startColumn: i,
      endColumn: o,
      startRow: t8,
      endRow: d
    };
  }
  // calc apply data according to copy data and direction
  _getApplyData(e, t8, n, i, o, s = true, l) {
    const a = [], c = Math.floor(n / t8), d = n % t8, u = this._autoFillService.getRules();
    if (!s && o === Le3.ONLY_FORMAT)
      return console.error("ERROR: only format can not be applied when hasStyle is false"), [];
    const h = {};
    u.forEach((g) => {
      h[g.type] = [];
    }), u.forEach((g) => {
      const { type: m2, applyFunctions: f2 = {} } = g, v2 = e[m2];
      v2 && v2.forEach((p) => {
        const S = jC(p.index, d), w = p.index.length * c + S, C = this._applyFunctions(
          p,
          w,
          i,
          o,
          f2,
          e,
          l
        ), I2 = YC(t8, n, p.index);
        h[m2].push({ data: C, index: I2 });
      });
    });
    for (let g = 0; g < n; g++)
      u.forEach((m2) => {
        const { type: f2 } = m2, v2 = h[f2];
        for (let p = 0; p < v2.length; p++)
          g in v2[p].index && a.push(v2[p].data[v2[p].index[g]]);
      });
    return a;
  }
  _applyFunctions(e, t8, n, i, o, s, l) {
    const { data: a } = e, c = n === Cm.UP || n === Cm.LEFT;
    if (i === Le3.COPY) {
      const d = o == null ? void 0 : o[Le3.COPY];
      return d ? d(e, t8, n, s, l) : (c && a.reverse(), br2(a, t8));
    }
    if (i === Le3.SERIES) {
      const d = o == null ? void 0 : o[Le3.SERIES];
      return d ? d(e, t8, n, s) : (c && a.reverse(), o != null && o[Le3.COPY] ? o[Le3.COPY](e, t8, n, s, l) : br2(a, t8));
    }
    if (i === Le3.ONLY_FORMAT) {
      const d = o == null ? void 0 : o[Le3.ONLY_FORMAT];
      return d ? d(e, t8, n, s) : ZC2(a, t8);
    }
  }
  _getCopyData(e, t8) {
    const n = this._univerInstanceService.getCurrentUnitForType(we.UNIVER_SHEET).getActiveSheet();
    if (!n)
      throw new Error("No active sheet found");
    const i = n.getCellMatrix(), o = this._autoFillService.getRules(), s = [], l = t8 === Cm.DOWN || t8 === Cm.UP;
    let a, c;
    return l ? (a = e.cols, c = e.rows) : (a = e.rows, c = e.cols), a.forEach((d) => {
      const u = this._getEmptyCopyDataPiece(), h = {
        type: void 0,
        cellData: void 0
      };
      c.forEach((g) => {
        let m2;
        l ? m2 = i.getValue(g, d) : m2 = i.getValue(d, g);
        const { type: f2, isContinue: v2 } = o.find((p) => p.match(m2, this._injector)) || vm;
        if (v2(h, m2)) {
          const p = u[f2], S = p[p.length - 1];
          S.data.push(m2), S.index.push(g - c[0]);
        } else {
          const p = u[f2];
          p ? p.push({
            data: [m2],
            index: [g - c[0]]
          }) : u[f2] = [
            {
              data: [m2],
              index: [g - c[0]]
            }
          ];
        }
        h.type = f2, h.cellData = m2;
      }), s.push(u);
    }), s;
  }
  _getEmptyCopyDataPiece() {
    const e = {};
    return this._autoFillService.getRules().forEach((t8) => {
      e[t8.type] = [];
    }), e;
  }
  _getMergeApplyData(e, t8, n, i) {
    const o = this._univerInstanceService.getCurrentUnitForType(we.UNIVER_SHEET).getActiveSheet();
    if (!o)
      throw new Error("No active sheet found");
    const s = [];
    for (let l = e.startRow; l <= e.endRow; l++)
      for (let a = e.startColumn; a <= e.endColumn; a++) {
        const { isMergedMainCell: c, startRow: d, startColumn: u, endRow: h, endColumn: g } = o.getCellInfoInMergeData(l, a);
        if (c) {
          if (n === Cm.DOWN) {
            let m2 = d + i, f2 = h + i;
            for (; f2 <= t8.endRow; )
              s.push({
                startRow: m2,
                startColumn: u,
                endRow: f2,
                endColumn: g
              }), m2 += i, f2 += i;
          } else if (n === Cm.UP) {
            let m2 = d - i, f2 = h - i;
            for (; m2 >= t8.startRow; )
              s.push({
                startRow: m2,
                startColumn: u,
                endRow: f2,
                endColumn: g
              }), m2 -= i, f2 -= i;
          } else if (n === Cm.RIGHT) {
            let m2 = u + i, f2 = g + i;
            for (; f2 <= t8.endColumn; )
              s.push({
                startRow: d,
                startColumn: m2,
                endRow: h,
                endColumn: f2
              }), m2 += i, f2 += i;
          } else if (n === Cm.LEFT) {
            let m2 = u - i, f2 = g - i;
            for (; m2 >= t8.startColumn; )
              s.push({
                startRow: d,
                startColumn: m2,
                endRow: h,
                endColumn: f2
              }), m2 -= i, f2 -= i;
          }
        }
      }
    return s;
  }
  _presetAndCacheData(e, t8) {
    const { source: n, target: i } = e, o = this._univerInstanceService.getCurrentUnitForType(we.UNIVER_SHEET).getActiveSheet();
    if (!o)
      throw new Error("No active sheet found");
    const s = o.getCellMatrix(), l = [];
    return i.rows.forEach((a) => {
      const c = [];
      i.cols.forEach((d) => {
        c.push(J.deepClone(s.getValue(a, d)));
      }), l.push(c);
    }), this._beforeApplyData = l, this._copyData = this._getCopyData(n, t8), this._currentLocation = e, this._shouldDisableSeries(this._copyData) ? (this._autoFillService.setDisableApplyType(Le3.SERIES, true), Le3.COPY) : (this._autoFillService.setDisableApplyType(Le3.SERIES, false), this._getPreferredApplyType(this._copyData));
  }
  // auto fill entry
  // eslint-disable-next-line max-lines-per-function
  _fillData(e, t8, n) {
    var H3, A;
    const i = [], o = [];
    let s = true;
    n === Le3.NO_FORMAT && (s = false, n = Le3.SERIES);
    const { source: l, target: a, unitId: c, subUnitId: d } = e;
    if (!l || !a || t8 == null)
      return {
        undos: i,
        redos: o
      };
    const u = Cr3(l), h = Cr3(a), { cols: g, rows: m2 } = a, { cols: f2, rows: v2 } = l, p = this._copyData;
    let S;
    t8 === Cm.DOWN || t8 === Cm.UP ? S = v2.length : S = f2.length;
    const w = [];
    if (t8 === Cm.DOWN || t8 === Cm.UP) {
      const x7 = m2.length, V2 = [];
      g.forEach((D2, X2) => {
        const B = p[X2], j = this._getApplyData(B, S, x7, t8, n, s, e);
        V2.push(j);
      });
      for (let D2 = 0; D2 < V2[0].length; D2++) {
        const X2 = [];
        for (let B = 0; B < V2.length; B++)
          X2.push({
            s: null,
            ...V2[B][D2]
          });
        w.push(X2);
      }
    } else {
      const x7 = g.length;
      m2.forEach((V2, D2) => {
        const X2 = p[D2], B = this._getApplyData(X2, S, x7, t8, n, s, e), j = [];
        for (let G7 = 0; G7 < B.length; G7++)
          j.push({
            s: null,
            ...B[G7]
          });
        w.push(j);
      });
    }
    let C = [];
    const I2 = this._univerInstanceService.getCurrentUnitForType(we.UNIVER_SHEET).getStyles();
    if (s ? (C = this._getMergeApplyData(u, h, t8, S), w.forEach((x7) => {
      x7.forEach((V2) => {
        V2 && I2 && I2 && (V2.s = I2.getStyleByCell(V2));
      });
    })) : w.forEach((x7, V2) => {
      x7.forEach((D2, X2) => {
        D2 && I2 && (D2.s = I2.getStyleByCell(this._beforeApplyData[V2][X2]) || null);
      });
    }), n === Le3.ONLY_FORMAT && w.forEach((x7, V2) => {
      x7.forEach((D2, X2) => {
        if (D2) {
          const B = this._beforeApplyData[V2][X2] || {};
          D2.f = B.f, D2.si = B.si, D2.t = B.t, D2.v = B.v;
        }
      });
    }), s) {
      const x7 = [], V2 = (A = (H3 = this._univerInstanceService.getUniverSheetInstance(c)) == null ? void 0 : H3.getSheetBySheetId(d)) == null ? void 0 : A.getMergeData();
      V2 && V2.forEach((B) => {
        En.intersects(B, h) && x7.push(B);
      });
      const D2 = {
        unitId: c,
        subUnitId: d,
        ranges: x7
      }, X2 = this._injector.invoke(
        ye2,
        D2
      );
      x7.length && (o.push({ id: se2.id, params: D2 }), i.unshift({ id: ne.id, params: X2 }));
    }
    const R = {
      subUnitId: d,
      unitId: c,
      cellValue: LC([a])
    }, y = this._injector.invoke(
      Ae,
      R
    );
    o.push({ id: ee.id, params: R }), i.unshift({ id: ee.id, params: y });
    const M7 = new pt();
    m2.forEach((x7, V2) => {
      g.forEach((D2, X2) => {
        w[V2][X2] && M7.setValue(x7, D2, w[V2][X2]);
      });
    });
    const E = M7.getMatrix(), T = {
      subUnitId: d,
      unitId: c,
      cellValue: E
    }, P2 = this._injector.invoke(
      Ae,
      T
    );
    if (this._autoFillService.getActiveHooks().forEach((x7) => {
      var V2;
      (V2 = x7.onBeforeSubmit) == null || V2.call(x7, e, t8, n, E);
    }), i.unshift({ id: ee.id, params: P2 }), o.push({ id: ee.id, params: T }), C != null && C.length) {
      const x7 = zr(C), V2 = {
        unitId: c,
        subUnitId: d,
        ranges: x7
      }, D2 = this._injector.invoke(
        We2,
        V2
      );
      i.unshift({ id: se2.id, params: D2 }), o.push({ id: ne.id, params: V2 });
    }
    return {
      undos: i,
      redos: o
    };
  }
  _shouldDisableSeries(e) {
    return e.every(
      (t8) => Object.keys(t8).every(
        (n) => {
          var i;
          return ((i = t8[n]) == null ? void 0 : i.length) === 0 || [mt3.OTHER, mt3.FORMULA].includes(n);
        }
      )
    );
  }
  _getPreferredApplyType(e) {
    return e.every(
      (n) => Object.keys(n).every(
        (i) => {
          var o, s;
          return ((o = n[i]) == null ? void 0 : o.length) === 0 || ((s = n[i]) == null ? void 0 : s.length) === 1 && n[i][0].data.length === 1 && mt3.NUMBER === i;
        }
      )
    ) ? Le3.COPY : Le3.SERIES;
  }
};
bi3 = Iw([
  lr2(0, vr),
  lr2(1, Ls),
  lr2(2, Hr),
  lr2(3, qe5),
  lr2(4, ME),
  lr2(5, Inject(Injector)),
  lr2(6, Inject(ir3))
], bi3);
var yw = Object.getOwnPropertyDescriptor;
var Mw = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? yw(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var Ba2 = (r, e) => (t8, n) => e(t8, n, r);
var al = class extends Ve {
  constructor(e, t8, n, i) {
    super();
    _2(this, "_enterActiveRender");
    this._context = e, this._sheetSkeletonManagerService = t8, this._renderManagerService = n, this._permissionService = i, this._initEventBinding();
  }
  // eslint-disable-next-line max-lines-per-function
  _initEventBinding() {
    const e = new ao(), t8 = this._context.unit, n = (i) => {
      if (e.dispose(), !i)
        return;
      const o = this._context.unitId, { skeleton: s } = i, l = this._renderManagerService.getRenderById(o);
      if (l && l.mainComponent) {
        const a = l.mainComponent, c = (h) => {
          const { offsetX: g, offsetY: m2 } = h, f2 = l.scene, v2 = t8.getActiveSheet();
          if (!v2)
            return;
          const p = f2.getActiveViewportByCoord(
            U.FromArray([g, m2])
          );
          if (!p)
            return;
          const { scaleX: S, scaleY: w } = f2.getAncestorScale(), C = {
            x: p.viewportScrollX,
            y: p.viewportScrollY
          }, I2 = s.getCellIndexByOffset(g, m2, S, w, C), R = s.worksheet.getMergedCell(I2.row, I2.column), y = {
            actualRow: R ? R.startRow : I2.row,
            actualCol: R ? R.startColumn : I2.column,
            row: I2.row,
            col: I2.column
          };
          if (!y || !s)
            return;
          const M7 = v2.getCell(y.actualRow, y.actualCol);
          if (!M7)
            return;
          const E = M7.customRender;
          if (!(E != null && E.length))
            return;
          const T = y.actualRow, P2 = y.actualCol, H3 = E.sort(IR), A = v2.getSheetId(), x7 = {
            data: M7,
            style: s.getStyles().getStyleByCell(M7),
            primaryWithCoord: s.getCellWithCoordByIndex(y.actualRow, y.actualCol),
            unitId: o,
            subUnitId: A,
            row: T,
            col: P2,
            workbook: t8,
            worksheet: v2
          }, V2 = {
            x: C.x + g / S,
            y: C.y + m2 / w
          }, D2 = H3.find((X2) => {
            var B;
            return (B = X2.isHit) == null ? void 0 : B.call(X2, V2, x7);
          });
          if (D2)
            return [D2, x7];
        }, d = a.onPointerDown$.subscribeEvent((h) => {
          var m2, f2, v2, p;
          const g = c(h);
          if (g) {
            const [S, w] = g, { row: C, col: I2, worksheet: R, unitId: y, subUnitId: M7 } = w;
            if (!((m2 = this._permissionService.composePermission(
              [new Pe(y).id, new Ve2(y, M7).id]
            )) == null ? void 0 : m2.every((P2) => P2.value)))
              return false;
            const T = (v2 = (f2 = R.getCell(C, I2)) == null ? void 0 : f2.selectionProtection) == null ? void 0 : v2[0];
            if ((T == null ? void 0 : T[_.Edit]) === false)
              return false;
            (p = S.onPointerDown) == null || p.call(S, w, h);
          }
        }), u = TR(a.onPointerMove$).pipe(throttleTime(30)).subscribe((h) => {
          var m2, f2, v2, p, S, w;
          const g = c(h);
          if (g) {
            const [C, I2] = g;
            this._enterActiveRender ? this._enterActiveRender.render !== C && ((f2 = (m2 = this._enterActiveRender.render).onPointerLeave) == null || f2.call(m2, this._enterActiveRender.cellContext, h), this._enterActiveRender = {
              render: C,
              cellContext: I2
            }, (v2 = C.onPointerEnter) == null || v2.call(C, I2, h)) : (this._enterActiveRender = {
              render: C,
              cellContext: I2
            }, (p = C.onPointerEnter) == null || p.call(C, I2, h));
          } else
            this._enterActiveRender && ((w = (S = this._enterActiveRender.render).onPointerLeave) == null || w.call(S, this._enterActiveRender.cellContext, h), this._enterActiveRender = null);
        });
        d && e.add(d), u && e.add(u);
      }
    };
    this.disposeWithMe(this._sheetSkeletonManagerService.currentSkeleton$.subscribe(n)), n(this._sheetSkeletonManagerService.getCurrentParam()), this.disposeWithMe(e);
  }
};
al = Mw([
  Ba2(1, Inject(ue)),
  Ba2(2, ME),
  Ba2(3, eC)
], al);
var Ew = Object.getOwnPropertyDescriptor;
var Tw = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? Ew(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var hh2 = (r, e) => (t8, n) => e(t8, n, r);
var Oo2 = class extends Ve {
  constructor(e, t8) {
    super();
    _2(this, "_currentCell$", new Subject());
    _2(this, "currentCell$", this._currentCell$.asObservable().pipe(distinctUntilChanged(
      (e8, t10) => {
        var n, i, o, s, l, a, c, d;
        return ((n = e8 == null ? void 0 : e8.location) == null ? void 0 : n.unitId) === ((i = t10 == null ? void 0 : t10.location) == null ? void 0 : i.unitId) && ((o = e8 == null ? void 0 : e8.location) == null ? void 0 : o.subUnitId) === ((s = t10 == null ? void 0 : t10.location) == null ? void 0 : s.subUnitId) && ((l = e8 == null ? void 0 : e8.location) == null ? void 0 : l.row) === ((a = t10 == null ? void 0 : t10.location) == null ? void 0 : a.row) && ((c = e8 == null ? void 0 : e8.location) == null ? void 0 : c.col) === ((d = t10 == null ? void 0 : t10.location) == null ? void 0 : d.col);
      }
    )));
    _2(this, "_endCell$", new Subject());
    _2(this, "endCell$", this._endCell$.asObservable());
    this._univerInstanceService = e, this._renderManagerService = t8, this._initCellDisposableListener();
  }
  dispose() {
    super.dispose(), this._currentCell$.complete(), this._endCell$.complete();
  }
  _initCellDisposableListener() {
    this.disposeWithMe(this._univerInstanceService.getCurrentTypeOfUnit$(we.UNIVER_SHEET).subscribe((e) => {
      e || (this._currentCell$.next(null), this._endCell$.next(null));
    }));
  }
  _calcActiveCell(e, t8) {
    const n = this._univerInstanceService.getCurrentUnitForType(we.UNIVER_SHEET);
    if (!n)
      return null;
    const i = n.getActiveSheet();
    if (!i) return;
    const o = this._renderManagerService.getRenderById(n.getUnitId());
    if (!o) return;
    const s = o.with(ue).getCurrentParam(), a = o.with(Et2).getCurrentScrollState();
    if (!(!s || !a || !o))
      return Lm(o, n, i, s, e, t8);
  }
  onDragOver(e) {
    const { offsetX: t8, offsetY: n, dataTransfer: i } = e, o = this._calcActiveCell(t8, n);
    if (!o) {
      this._currentCell$.next(null);
      return;
    }
    const { location: s, position: l } = o;
    this._currentCell$.next({
      location: s,
      position: l,
      dataTransfer: i
    });
  }
  onDrop(e) {
    const { offsetX: t8, offsetY: n, dataTransfer: i } = e, o = this._calcActiveCell(t8, n);
    if (!o) {
      this._endCell$.next(null);
      return;
    }
    const { location: s, position: l } = o;
    this._endCell$.next({
      location: s,
      position: l,
      dataTransfer: i
    });
  }
};
Oo2 = Tw([
  hh2(0, vr),
  hh2(1, ME)
], Oo2);
var Pw = Object.getOwnPropertyDescriptor;
var xw = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? Pw(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var Fa2 = (r, e) => (t8, n) => e(t8, n, r);
var cl = class extends Ve {
  constructor(r, e, t8, n) {
    super(), this._context = r, this._renderManagerService = e, this._dragManagerService = t8, this._sheetSkeletonManagerService = n, this._initDragEvent();
  }
  _initDragEvent() {
    const r = new ao(), e = (t8) => {
      if (r.dispose(), !t8)
        return;
      const { scene: n } = this._context, i = n.onDragOver$.subscribeEvent((s) => {
        this._dragManagerService.onDragOver(s);
      }), o = n.onDrop$.subscribeEvent((s) => {
        this._dragManagerService.onDrop(s);
      });
      r.add({
        dispose() {
          i.unsubscribe(), o.unsubscribe();
        }
      });
    };
    e(this._sheetSkeletonManagerService.getCurrentParam()), this.disposeWithMe(this._sheetSkeletonManagerService.currentSkeleton$.subscribe((t8) => {
      e(t8);
    }));
  }
};
cl = xw([
  Fa2(1, ME),
  Fa2(2, Inject(Oo2)),
  Fa2(3, Inject(ue))
], cl);
var Bm = class {
  constructor() {
    _2(this, "_state", null);
    _2(this, "_rect", null);
    _2(this, "_state$", new BehaviorSubject(null));
    _2(this, "state$", this._state$.asObservable());
    _2(this, "_rect$", new BehaviorSubject(null));
    _2(this, "rect$", this._rect$.asObservable());
    _2(this, "_focus", false);
    _2(this, "_focus$", new BehaviorSubject(this._focus));
    _2(this, "focus$", this._focus$.asObservable());
  }
  dispose() {
    this._state$.complete(), this._state = null, this._rect$.complete(), this._rect = null;
  }
  setState(e) {
    this._state = e, this._refresh(e);
  }
  getRect() {
    return this._rect;
  }
  setRect(e) {
    this._rect = e, this._rect$.next(e);
  }
  getState() {
    return this._state;
  }
  setFocus(e = false) {
    this._focus = e, this._focus$.next(e);
  }
  _refresh(e) {
    this._state$.next(e);
  }
};
var ls3 = createIdentifier(
  "univer.sheet-cell-editor-manager.service"
);
var Tt3 = "sheets-ui.config";
var dl = {
  formulaBar: true,
  statusBarStatistic: true,
  protectedRangeShadow: true,
  maxAutoHeightCount: 1e3
};
function tu2(r) {
  return r === true ? "always" : r === false ? "none" : r || "always";
}
function ct4({ ref: r, ...e }) {
  const { icon: t8, id: n, className: i, extend: o, ...s } = e, l = `univerjs-icon univerjs-icon-${n} ${i || ""}`.trim(), a = (0, import_react4.useRef)(`_${Hw()}`);
  return Fm2(t8, `${n}`, {
    defIds: t8.defIds,
    idSuffix: a.current
  }, {
    ref: r,
    className: l,
    ...s
  }, o);
}
function Fm2(r, e, t8, n, i) {
  return (0, import_react4.createElement)(r.tag, {
    key: e,
    ...Ow(r, t8, i),
    ...n
  }, (Aw(r, t8).children || []).map((o, s) => Fm2(o, `${e}-${r.tag}-${s}`, t8, void 0, i)));
}
function Ow(r, e, t8) {
  const n = { ...r.attrs };
  t8 != null && t8.colorChannel1 && n.fill === "colorChannel1" && (n.fill = t8.colorChannel1), r.tag === "mask" && n.id && (n.id = n.id + e.idSuffix), Object.entries(n).forEach(([o, s]) => {
    o === "mask" && typeof s == "string" && (n[o] = s.replace(/url\(#(.*)\)/, `url(#$1${e.idSuffix})`));
  });
  const { defIds: i } = e;
  return !i || i.length === 0 || (r.tag === "use" && n["xlink:href"] && (n["xlink:href"] = n["xlink:href"] + e.idSuffix), Object.entries(n).forEach(([o, s]) => {
    typeof s == "string" && (n[o] = s.replace(/url\(#(.*)\)/, `url(#$1${e.idSuffix})`));
  })), n;
}
function Aw(r, e) {
  var n;
  const { defIds: t8 } = e;
  return !t8 || t8.length === 0 ? r : r.tag === "defs" && ((n = r.children) != null && n.length) ? {
    ...r,
    children: r.children.map((i) => typeof i.attrs.id == "string" && t8 && t8.includes(i.attrs.id) ? {
      ...i,
      attrs: {
        ...i.attrs,
        id: i.attrs.id + e.idSuffix
      }
    } : i)
  } : r;
}
function Hw() {
  return Math.random().toString(36).substring(2, 8);
}
ct4.displayName = "UniverIcon";
var Vw = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M14.1544 3.75557C14.3887 3.98988 14.3887 4.36978 14.1544 4.6041L6.51409 12.2444C6.40157 12.3569 6.24896 12.4201 6.08983 12.4201C5.9307 12.4201 5.77808 12.3569 5.66556 12.2444L1.84541 8.42425C1.6111 8.18993 1.6111 7.81003 1.84541 7.57572C2.07973 7.34141 2.45963 7.34141 2.69394 7.57572L6.08983 10.9716L13.3059 3.75557C13.5402 3.52126 13.9201 3.52126 14.1544 3.75557Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var Dr3 = (0, import_react4.forwardRef)(function(e, t8) {
  return (0, import_react4.createElement)(ct4, Object.assign({}, e, {
    id: "check-mark-icon",
    ref: t8,
    icon: Vw
  }));
});
Dr3.displayName = "CheckMarkIcon";
var Nw = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M3.71274 2.86421C3.47843 2.6299 3.09853 2.6299 2.86421 2.86421C2.6299 3.09853 2.6299 3.47843 2.86421 3.71274L7.15154 8.00007L2.86421 12.2874C2.6299 12.5217 2.6299 12.9016 2.86421 13.1359C3.09853 13.3702 3.47843 13.3702 3.71274 13.1359L8.00007 8.84859L12.2874 13.1359C12.5217 13.3702 12.9016 13.3702 13.1359 13.1359C13.3702 12.9016 13.3702 12.5217 13.1359 12.2874L8.84859 8.00007L13.1359 3.71274C13.3702 3.47843 13.3702 3.09853 13.1359 2.86421C12.9016 2.6299 12.5217 2.6299 12.2874 2.86421L8.00007 7.15154L3.71274 2.86421Z"
    }
  }]
};
var Um = (0, import_react4.forwardRef)(function(e, t8) {
  return (0, import_react4.createElement)(ct4, Object.assign({}, e, {
    id: "close-icon",
    ref: t8,
    icon: Nw
  }));
});
Um.displayName = "CloseIcon";
var kw = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "g",
    attrs: {
      fill: "currentColor",
      clipPath: "url(#convert-icon_clip0_911_593)"
    },
    children: [
      {
        tag: "path",
        attrs: {
          d: "M2.44766 0.848145C1.564 0.848145 0.847656 1.56449 0.847656 2.44814V6.44814C0.847656 7.3318 1.564 8.04814 2.44766 8.04814H6.44766C7.33131 8.04814 8.04766 7.3318 8.04766 6.44814V2.44814C8.04766 1.56449 7.33131 0.848145 6.44766 0.848145H2.44766ZM2.04766 6.44814V5.04824H3.84775V6.84814H2.44766C2.22674 6.84814 2.04766 6.66906 2.04766 6.44814ZM2.04766 3.84824H3.84775V2.04814H2.44766C2.22674 2.04814 2.04766 2.22723 2.04766 2.44814V3.84824ZM5.04775 6.84814V5.04824H6.84766V6.44814C6.84766 6.66906 6.66857 6.84814 6.44766 6.84814H5.04775ZM5.04775 3.84824H6.84766V2.44814C6.84766 2.22723 6.66857 2.04814 6.44766 2.04814H5.04775V3.84824Z",
          fillRule: "evenodd",
          clipRule: "evenodd"
        }
      },
      {
        tag: "path",
        attrs: {
          d: "M9.55215 7.95166C8.66849 7.95166 7.95215 8.668 7.95215 9.55166V13.5517C7.95215 14.4353 8.66849 15.1517 9.55215 15.1517L11.5522 15.1517L13.5521 15.1517C14.4358 15.1517 15.1521 14.4353 15.1521 13.5517L15.1521 11.5518L15.1521 9.55166C15.1521 8.668 14.4358 7.95166 13.5521 7.95166H9.55215ZM13.9521 10.9518V9.55166C13.9521 9.33075 13.7731 9.15166 13.5521 9.15166H12.1522V10.9518H13.9521ZM10.9522 10.9518V9.15166H9.55215C9.33123 9.15166 9.15215 9.33075 9.15215 9.55166V10.9518H10.9522ZM9.15215 12.1518H10.9522V13.9517H9.55215C9.33123 13.9517 9.15215 13.7726 9.15215 13.5517V12.1518ZM12.1522 12.1518H13.9521V13.5517C13.9521 13.7726 13.7731 13.9517 13.5521 13.9517H12.1522V12.1518Z",
          fillRule: "evenodd",
          clipRule: "evenodd"
        }
      },
      {
        tag: "path",
        attrs: { d: "M9.62158 2.44912C9.62158 2.11775 9.89021 1.84912 10.2216 1.84912H12.7516C13.6352 1.84912 14.3516 2.56547 14.3516 3.44912V5.9791C14.3516 6.31047 14.0829 6.5791 13.7516 6.5791C13.4202 6.5791 13.1516 6.31047 13.1516 5.9791V3.44912C13.1516 3.22821 12.9725 3.04912 12.7516 3.04912H10.2216C9.89021 3.04912 9.62158 2.78049 9.62158 2.44912Z" }
      },
      {
        tag: "path",
        attrs: { d: "M5.77871 14.1507C6.11008 14.1507 6.37871 13.8821 6.37871 13.5507C6.37871 13.2193 6.11008 12.9507 5.77871 12.9507L3.24873 12.9507C3.02782 12.9507 2.84873 12.7716 2.84873 12.5507L2.84873 10.0207C2.84873 9.68933 2.5801 9.4207 2.24873 9.4207C1.91736 9.4207 1.64873 9.68933 1.64873 10.0207L1.64873 12.5507C1.64873 13.4343 2.36507 14.1507 3.24873 14.1507H5.77871Z" }
      }
    ]
  }, {
    tag: "defs",
    attrs: {},
    children: [{
      tag: "clipPath",
      attrs: { id: "convert-icon_clip0_911_593" },
      children: [{
        tag: "path",
        attrs: {
          fill: "white",
          d: "M0 0H16V16H0z"
        }
      }]
    }]
  }],
  defIds: ["convert-icon_clip0_911_593"]
};
var Xm2 = (0, import_react4.forwardRef)(function(e, t8) {
  return (0, import_react4.createElement)(ct4, Object.assign({}, e, {
    id: "convert-icon",
    ref: t8,
    icon: kw
  }));
});
Xm2.displayName = "ConvertIcon";
var Dw = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M5.3313 1.4667C5.3313 1.13533 5.59993 0.866699 5.9313 0.866699H10.069C10.4004 0.866699 10.669 1.13533 10.669 1.4667C10.669 1.79807 10.4004 2.0667 10.069 2.0667H5.9313C5.59993 2.0667 5.3313 1.79807 5.3313 1.4667Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M1.09985 3.64443C1.09985 3.31306 1.36848 3.04443 1.69985 3.04443H14.2999C14.6312 3.04443 14.8999 3.31306 14.8999 3.64443C14.8999 3.9758 14.6312 4.24443 14.2999 4.24443H1.69985C1.36848 4.24443 1.09985 3.9758 1.09985 3.64443Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M6.12398 8.30171C6.35829 8.0674 6.73819 8.0674 6.97251 8.30171L8.00007 9.32928L9.02764 8.30171C9.26195 8.0674 9.64185 8.0674 9.87617 8.30171C10.1105 8.53603 10.1105 8.91593 9.87617 9.15024L8.8486 10.1778L9.87617 11.2054C10.1105 11.4397 10.1105 11.8196 9.87617 12.0539C9.64185 12.2882 9.26195 12.2882 9.02764 12.0539L8.00007 11.0263L6.97251 12.0539C6.73819 12.2882 6.35829 12.2882 6.12398 12.0539C5.88966 11.8196 5.88966 11.4397 6.12398 11.2054L7.15154 10.1778L6.12398 9.15024C5.88966 8.91593 5.88966 8.53603 6.12398 8.30171Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M4.75332 5.22217C3.86966 5.22217 3.15332 5.93851 3.15332 6.82217V12.5331C3.15332 13.9691 4.31738 15.1332 5.75332 15.1332H10.2465C11.6825 15.1332 12.8465 13.9691 12.8465 12.5331V6.82217C12.8465 5.93851 12.1302 5.22217 11.2465 5.22217H4.75332ZM4.35332 6.82217C4.35332 6.60125 4.53241 6.42217 4.75332 6.42217H11.2465C11.4674 6.42217 11.6465 6.60125 11.6465 6.82217V12.5331C11.6465 13.3063 11.0197 13.9332 10.2465 13.9332H5.75332C4.98012 13.9332 4.35332 13.3063 4.35332 12.5331V6.82217Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    }
  ]
};
var Pa2 = (0, import_react4.forwardRef)(function(e, t8) {
  return (0, import_react4.createElement)(ct4, Object.assign({}, e, {
    id: "delete-icon",
    ref: t8,
    icon: Dw
  }));
});
Pa2.displayName = "DeleteIcon";
var Lw = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M8.85869 12.9216C8.38445 13.4708 7.61555 13.4708 7.14131 12.9216L0.358114 5.06726C-0.406895 4.18144 0.134916 2.66683 1.2168 2.66683L14.7832 2.66683C15.8651 2.66683 16.4069 4.18144 15.6419 5.06726L8.85869 12.9216Z"
    }
  }]
};
var zm2 = (0, import_react4.forwardRef)(function(e, t8) {
  return (0, import_react4.createElement)(ct4, Object.assign({}, e, {
    id: "dropdown-icon",
    ref: t8,
    icon: Lw
  }));
});
zm2.displayName = "DropdownIcon";
var Ww = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M15 8C15 11.866 11.866 15 8 15C4.13401 15 1 11.866 1 8C1 4.13401 4.13401 1 8 1C11.866 1 15 4.13401 15 8ZM10.3097 5.69014C10.544 5.92445 10.544 6.30435 10.3097 6.53867L8.84843 7.9999L10.3099 9.46137C10.5442 9.69569 10.5442 10.0756 10.3099 10.3099C10.0756 10.5442 9.69569 10.5442 9.46137 10.3099L7.9999 8.84843L6.53842 10.3099C6.30411 10.5442 5.92421 10.5442 5.6899 10.3099C5.45558 10.0756 5.45558 9.69569 5.6899 9.46137L7.15137 7.9999L5.69014 6.53867C5.45583 6.30435 5.45583 5.92445 5.69014 5.69014C5.92445 5.45583 6.30435 5.45583 6.53867 5.69014L7.9999 7.15137L9.46113 5.69014C9.69544 5.45583 10.0753 5.45583 10.3097 5.69014Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var nu2 = (0, import_react4.forwardRef)(function(e, t8) {
  return (0, import_react4.createElement)(ct4, Object.assign({}, e, {
    id: "error-icon",
    ref: t8,
    icon: Ww
  }));
});
nu2.displayName = "ErrorIcon";
var Bw = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M1.28096 4.6541C1.57489 4.50109 1.93721 4.61533 2.09022 4.90926C2.27315 5.26067 2.55999 5.60455 2.94829 5.92278C4.04628 6.82266 5.87505 7.44865 7.99828 7.44865C10.1215 7.44865 11.9503 6.82267 13.0482 5.92279C13.4366 5.60455 13.7234 5.26067 13.9063 4.90927C14.0594 4.61533 14.4217 4.50109 14.7156 4.65409C15.0095 4.8071 15.1238 5.16941 14.9708 5.46334C14.6995 5.98445 14.2981 6.44997 13.8089 6.8509C13.7298 6.91575 13.6481 6.97914 13.564 7.041L15.2245 8.70153C15.4588 8.93585 15.4588 9.31575 15.2245 9.55006C14.9902 9.78438 14.6103 9.78438 14.376 9.55006L12.5041 7.67822C11.8977 7.97568 11.2181 8.21208 10.4884 8.37706L11.0996 10.6581C11.1853 10.9782 10.9954 11.3072 10.6753 11.393C10.3552 11.4787 10.0262 11.2888 9.94045 10.9687L9.29949 8.57652C8.8758 8.62404 8.44081 8.64865 7.99828 8.64865C7.55276 8.64865 7.11487 8.62371 6.68846 8.57555L6.04723 10.9687C5.96147 11.2888 5.63247 11.4788 5.31239 11.393C4.99231 11.3073 4.80236 10.9783 4.88812 10.6582L5.49983 8.37516C4.7743 8.2105 4.09843 7.9752 3.49498 7.67947L1.62436 9.55009C1.39005 9.78441 1.01015 9.78441 0.775835 9.5501C0.54152 9.31578 0.541518 8.93588 0.775832 8.70157L2.43478 7.04261C2.34987 6.98024 2.26746 6.91632 2.18764 6.8509C1.69842 6.44997 1.29706 5.98445 1.0258 5.46335C0.872791 5.16942 0.987031 4.80711 1.28096 4.6541Z"
    }
  }]
};
var jm2 = (0, import_react4.forwardRef)(function(e, t8) {
  return (0, import_react4.createElement)(ct4, Object.assign({}, e, {
    id: "eyelash-icon",
    ref: t8,
    icon: Bw
  }));
});
jm2.displayName = "EyelashIcon";
var Fw = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 17 17",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M6.06409 5.53454C5.93592 5.53454 5.84083 5.41567 5.86897 5.29063L5.95442 4.9109C6.05444 4.48178 6.23806 4.11547 6.51182 3.81952C6.81082 3.49628 7.25398 3.35405 7.79738 3.35405C7.99847 3.35405 8.21359 3.37775 8.44188 3.42245C8.46089 3.42617 8.47974 3.43006 8.49846 3.4341C8.7099 3.4798 8.93698 3.38478 9.02031 3.18514L9.24767 2.6404C9.33457 2.43219 9.23178 2.19404 9.01582 2.12874C8.98358 2.11899 8.95028 2.10912 8.91591 2.09914C8.62745 2.01631 8.28392 1.97217 7.88074 1.97217C6.82015 1.97217 6.02714 2.23936 5.4746 2.7444C4.90987 3.26069 4.50889 3.99917 4.28413 4.9762L2.83703 11.1909C2.76126 11.5286 2.666 11.8917 2.54844 12.2812C2.42975 12.6734 2.2873 13.0595 2.12221 13.4373C1.95577 13.8159 1.76813 14.1762 1.55955 14.5171C1.49345 14.6251 1.42515 14.7282 1.35467 14.8263C1.26508 14.9509 1.3347 15.133 1.48655 15.1554C2.13635 15.2509 2.8179 15.0763 3.18197 14.5296C3.32661 14.3124 3.46779 14.0646 3.60509 13.7851C3.96635 13.0497 4.30522 12.0103 4.61867 10.6574L5.469 7.01534C5.49013 6.92483 5.57082 6.86081 5.66376 6.86081H7.62478C7.8097 6.86081 7.97051 6.73405 8.01371 6.55425L8.14014 6.02798C8.20057 5.77642 8.00992 5.53454 7.75121 5.53454H6.06409Z"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M14.3211 5.72037L12.5124 7.96963L11.4089 5.77754C11.3422 5.63012 11.1954 5.5354 11.0336 5.5354H10.3129C10.0085 5.5354 9.80921 5.85428 9.9427 6.1279L11.4089 9.05502L8.79783 12.1493C8.56587 12.4158 8.75519 12.8315 9.10855 12.8315H9.68607C9.80672 12.8315 9.9605 12.7822 10.0388 12.6904L12.1108 10.2648L13.1176 12.561C13.1786 12.7231 13.333 12.8315 13.5061 12.8315H14.3C14.5831 12.8315 14.7417 12.6175 14.6426 12.3524L13.1728 9.28628C13.1728 9.28628 15.4009 6.45542 15.6013 6.17892C15.7966 5.90929 15.6023 5.5354 15.2693 5.5354H14.6661C14.5275 5.5354 14.4333 5.58887 14.3211 5.72037Z"
    }
  }]
};
var Ym = (0, import_react4.forwardRef)(function(e, t8) {
  return (0, import_react4.createElement)(ct4, Object.assign({}, e, {
    id: "fx-icon",
    ref: t8,
    icon: Fw
  }));
});
Ym.displayName = "FxIcon";
var Uw = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M8.6 1.99991C8.60001 1.66854 8.33138 1.39991 8.00001 1.3999C7.66864 1.3999 7.40001 1.66853 7.4 1.9999L7.39996 7.3999H1.9999C1.66853 7.3999 1.3999 7.66853 1.3999 7.9999C1.3999 8.33127 1.66853 8.5999 1.9999 8.5999H7.39995L7.3999 13.9999C7.3999 14.3313 7.66853 14.5999 7.9999 14.5999C8.33127 14.5999 8.5999 14.3313 8.5999 13.9999L8.59995 8.5999H13.9999C14.3313 8.5999 14.5999 8.33127 14.5999 7.9999C14.5999 7.66853 14.3313 7.3999 13.9999 7.3999H8.59996L8.6 1.99991Z"
    }
  }]
};
var ru2 = (0, import_react4.forwardRef)(function(e, t8) {
  return (0, import_react4.createElement)(ct4, Object.assign({}, e, {
    id: "increase-icon",
    ref: t8,
    icon: Uw
  }));
});
ru2.displayName = "IncreaseIcon";
var Xw = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M8.00016 1.33203C6.68162 1.33203 5.39269 1.72302 4.29636 2.45557C3.20004 3.18811 2.34555 4.2293 1.84097 5.44747C1.33638 6.66565 1.20436 8.00609 1.4616 9.2993C1.71883 10.5925 2.35377 11.7804 3.28612 12.7127C4.21847 13.6451 5.40636 14.28 6.69956 14.5373C7.99277 14.7945 9.33321 14.6625 10.5514 14.1579C11.7696 13.6533 12.8108 12.7988 13.5433 11.7025C14.2758 10.6062 14.6668 9.31724 14.6668 7.9987C14.6649 6.23118 13.9619 4.53662 12.7121 3.2868C11.4622 2.03697 9.76768 1.33397 8.00016 1.33203ZM7.66683 3.9987C7.86461 3.9987 8.05795 4.05735 8.2224 4.16723C8.38685 4.27711 8.51502 4.43329 8.59071 4.61601C8.6664 4.79874 8.6862 4.99981 8.64762 5.19379C8.60903 5.38777 8.51379 5.56595 8.37394 5.7058C8.23409 5.84566 8.0559 5.9409 7.86192 5.97948C7.66794 6.01807 7.46687 5.99826 7.28415 5.92258C7.10142 5.84689 6.94524 5.71872 6.83536 5.55427C6.72548 5.38982 6.66683 5.19648 6.66683 4.9987C6.66683 4.73348 6.77219 4.47913 6.95972 4.29159C7.14726 4.10405 7.40162 3.9987 7.66683 3.9987ZM9.3335 11.332H6.66683C6.49002 11.332 6.32045 11.2618 6.19543 11.1368C6.0704 11.0117 6.00016 10.8422 6.00016 10.6654C6.00016 10.4886 6.0704 10.319 6.19543 10.194C6.32045 10.0689 6.49002 9.9987 6.66683 9.9987H7.3335V7.9987H6.66683C6.49002 7.9987 6.32045 7.92846 6.19543 7.80343C6.0704 7.67841 6.00016 7.50884 6.00016 7.33203C6.00016 7.15522 6.0704 6.98565 6.19543 6.86063C6.32045 6.7356 6.49002 6.66536 6.66683 6.66536H8.00016C8.17698 6.66536 8.34655 6.7356 8.47157 6.86063C8.59659 6.98565 8.66683 7.15522 8.66683 7.33203V9.9987H9.3335C9.51031 9.9987 9.67988 10.0689 9.8049 10.194C9.92993 10.319 10.0002 10.4886 10.0002 10.6654C10.0002 10.8422 9.92993 11.0117 9.8049 11.1368C9.67988 11.2618 9.51031 11.332 9.3335 11.332Z"
    }
  }]
};
var Zm = (0, import_react4.forwardRef)(function(e, t8) {
  return (0, import_react4.createElement)(ct4, Object.assign({}, e, {
    id: "info-icon",
    ref: t8,
    icon: Xw
  }));
});
Zm.displayName = "InfoIcon";
var zw = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M2.62402 7.72905C2.58427 7.72905 2.55205 7.76127 2.55205 7.80102V13.6782C2.55205 13.7179 2.58427 13.7502 2.62402 13.7502H13.3755C13.4152 13.7502 13.4474 13.7179 13.4474 13.6782V7.80102C13.4474 7.76127 13.4152 7.72905 13.3755 7.72905H2.62402ZM1.35205 7.80102C1.35205 7.09853 1.92153 6.52905 2.62402 6.52905H13.3755C14.0779 6.52905 14.6474 7.09853 14.6474 7.80102V13.6782C14.6474 14.3807 14.0779 14.9502 13.3755 14.9502H2.62402C1.92153 14.9502 1.35205 14.3807 1.35205 13.6782V7.80102Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M8 2.25005C6.69847 2.25003 5.64336 3.30513 5.64336 4.60666V7.12895C5.64336 7.46032 5.37473 7.72895 5.04336 7.72895C4.71199 7.72895 4.44336 7.46032 4.44336 7.12895V4.60666C4.44336 2.64239 6.04451 1.05565 8.00879 1.05566M8 2.25005L8.00879 1.05566L8 2.25005ZM8.00879 1.05566L8 2.25005C9.30154 2.25003 10.3567 3.30513 10.3567 4.60666V7.12895C10.3567 7.46032 10.6253 7.72895 10.9567 7.72895C11.288 7.72895 11.5567 7.46032 11.5567 7.12895V4.60666C11.5567 2.64239 9.97306 1.05565 8.00879 1.05566Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M8.00039 9.4668C8.33176 9.4668 8.60039 9.73543 8.60039 10.0668V12.0827C8.60039 12.4141 8.33176 12.6827 8.00039 12.6827C7.66902 12.6827 7.40039 12.4141 7.40039 12.0827V10.0668C7.40039 9.73543 7.66902 9.4668 8.00039 9.4668Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    }
  ]
};
var iu2 = (0, import_react4.forwardRef)(function(e, t8) {
  return (0, import_react4.createElement)(ct4, Object.assign({}, e, {
    id: "lock-icon",
    ref: t8,
    icon: zw
  }));
});
iu2.displayName = "LockIcon";
var jw = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M11.3536 6.14645C11.5488 6.34171 11.5488 6.65829 11.3536 6.85355L8.35355 9.85355C8.15829 10.0488 7.84171 10.0488 7.64645 9.85355L4.64645 6.85355C4.45118 6.65829 4.45118 6.34171 4.64645 6.14645C4.84171 5.95118 5.15829 5.95118 5.35355 6.14645L8 8.79289L10.6464 6.14645C10.8417 5.95118 11.1583 5.95118 11.3536 6.14645Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var _i3 = (0, import_react4.forwardRef)(function(e, t8) {
  return (0, import_react4.createElement)(ct4, Object.assign({}, e, {
    id: "more-down-icon",
    ref: t8,
    icon: jw
  }));
});
_i3.displayName = "MoreDownIcon";
var Yw = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M5.90913 3.57564C6.14345 3.34132 6.52335 3.34132 6.75766 3.57564L10.7577 7.57564C10.992 7.80995 10.992 8.18985 10.7577 8.42417L6.75766 12.4242C6.52335 12.6585 6.14345 12.6585 5.90913 12.4242C5.67482 12.1899 5.67482 11.81 5.90913 11.5756L9.48487 7.9999L5.90913 4.42417C5.67482 4.18985 5.67482 3.80995 5.90913 3.57564Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var jc2 = (0, import_react4.forwardRef)(function(e, t8) {
  return (0, import_react4.createElement)(ct4, Object.assign({}, e, {
    id: "more-icon",
    ref: t8,
    icon: Yw
  }));
});
jc2.displayName = "MoreIcon";
var Zw = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M12.666 2.70571C11.7769 1.76476 10.3295 1.76476 9.4404 2.70571L3.37843 9.12427C3.31779 9.18848 3.27756 9.26409 3.24979 9.3439C3.24809 9.3493 3.24299 9.3529 3.24129 9.3583L2.02912 13.2097C1.96112 13.4251 2.01439 13.6633 2.16626 13.8236C2.27393 13.9382 2.41901 14 2.56692 14C2.62699 14 2.68762 13.9898 2.74599 13.9688L6.3825 12.6846C6.3876 12.6828 6.391 12.678 6.39553 12.6762C6.47147 12.6474 6.54287 12.6042 6.60351 12.54L12.666 6.12202C13.5558 5.18048 13.5558 3.64725 12.666 2.70571ZM8.62832 5.26209L9.04031 5.69836C9.03918 5.69956 9.03748 5.70016 9.03634 5.70136L4.99182 9.9836L4.58096 9.54853L8.62832 5.26209ZM3.46287 12.4512L4.02673 10.6593L5.15446 11.8535L3.46287 12.4512ZM6.20342 11.2672L5.79256 10.8321L9.83709 6.54988C9.83822 6.54868 9.83879 6.54688 9.83992 6.54568L10.2513 6.98135L6.20342 11.2672ZM11.8647 5.27349L11.0532 6.13282L9.42963 4.41356L10.2411 3.55423C10.6888 3.08016 11.417 3.08076 11.8642 3.55423C12.3124 4.0283 12.3124 4.79942 11.8647 5.27349Z"
    }
  }]
};
var Gm = (0, import_react4.forwardRef)(function(e, t8) {
  return (0, import_react4.createElement)(ct4, Object.assign({}, e, {
    id: "pen-icon",
    ref: t8,
    icon: Zw
  }));
});
Gm.displayName = "PenIcon";
var Gw = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M5.785 6.77762C5.78908 6.7777 5.79316 6.77774 5.79725 6.77774C5.80134 6.77774 5.80543 6.7777 5.8095 6.77762H10.0184C10.0225 6.7777 10.0266 6.77774 10.0307 6.77774C10.0347 6.77774 10.0388 6.7777 10.0429 6.77762H13.6638V7.63727C13.6638 7.96864 13.9324 8.23727 14.2638 8.23727C14.5951 8.23727 14.8638 7.96864 14.8638 7.63727V3.9999C14.8638 2.56395 13.6997 1.39989 12.2637 1.3999L3.56389 1.39999C2.12797 1.40001 0.96393 2.56405 0.96392 3.99998L0.963867 11.6666C0.963857 13.1025 2.12792 14.2666 3.56387 14.2666H8.0542C8.38557 14.2666 8.6542 13.9979 8.6542 13.6666C8.6542 13.3352 8.38557 13.0666 8.0542 13.0666H3.56387C2.79067 13.0666 2.16386 12.4398 2.16387 11.6666L2.1639 6.77762H5.785ZM6.39725 2.59996L9.43065 2.59993V5.57762H6.39725V2.59996ZM5.19725 5.57762V2.59998L3.56391 2.59999C2.79072 2.6 2.16393 3.22679 2.16392 3.99998L2.16391 5.57762H5.19725ZM13.6638 5.57762V3.9999C13.6638 3.2267 13.037 2.59989 12.2638 2.5999L10.6307 2.59992V5.57762H13.6638Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M14.1223 10.2333V10.7496C14.7087 10.9869 15.1223 11.5618 15.1223 12.2333V12.8999C15.1223 13.7836 14.406 14.4999 13.5223 14.4999H11.5223C10.6387 14.4999 9.92235 13.7836 9.92235 12.8999V12.2333C9.92235 11.5618 10.336 10.9869 10.9223 10.7496V10.2333C10.9223 9.34961 11.6387 8.63328 12.5223 8.63328C13.406 8.63328 14.1223 9.34961 14.1223 10.2333ZM11.1223 12.2333C11.1223 12.0124 11.3014 11.8333 11.5223 11.8333H13.5223C13.7433 11.8333 13.9223 12.0124 13.9223 12.2333V12.8999C13.9223 13.1209 13.7433 13.2999 13.5223 13.2999H11.5223C11.3014 13.2999 11.1223 13.1209 11.1223 12.8999V12.2333ZM12.9223 10.2333V10.6333H12.1223V10.2333C12.1223 10.0124 12.3014 9.83328 12.5223 9.83328C12.7433 9.83328 12.9223 10.0124 12.9223 10.2333Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var qm = (0, import_react4.forwardRef)(function(e, t8) {
  return (0, import_react4.createElement)(ct4, Object.assign({}, e, {
    id: "protect-icon",
    ref: t8,
    icon: Gw
  }));
});
qm.displayName = "ProtectIcon";
var qw = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M15 8C15 11.866 11.866 15 8 15C4.13401 15 1 11.866 1 8C1 4.13401 4.13401 1 8 1C11.866 1 15 4.13401 15 8ZM8.00008 12.3671C8.46031 12.3671 8.83342 11.994 8.83342 11.5338C8.83342 11.0735 8.46031 10.7004 8.00008 10.7004C7.53985 10.7004 7.16675 11.0735 7.16675 11.5338C7.16675 11.994 7.53985 12.3671 8.00008 12.3671ZM8.5999 4.4335C8.5999 4.10213 8.33127 3.8335 7.9999 3.8335C7.66853 3.8335 7.3999 4.10213 7.3999 4.4335V9.36683C7.3999 9.6982 7.66853 9.96683 7.9999 9.96683C8.33127 9.96683 8.5999 9.6982 8.5999 9.36683V4.4335Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var Qm = (0, import_react4.forwardRef)(function(e, t8) {
  return (0, import_react4.createElement)(ct4, Object.assign({}, e, {
    id: "warning-icon",
    ref: t8,
    icon: qw
  }));
});
Qm.displayName = "WarningIcon";
var Qw = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 17 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M12.6551 1.98906C11.7476 1.08113 10.2757 1.08149 9.3686 1.98987L4.82542 6.53955C4.75087 6.61421 4.69336 6.70411 4.65682 6.80309L3.2461 10.625C3.16506 10.8446 3.21909 11.0912 3.3845 11.2568C3.54991 11.4224 3.79651 11.4767 4.01616 11.3959L7.85031 9.98517C7.94979 9.94856 8.04014 9.89077 8.11508 9.81579L12.6552 5.27327C13.5618 4.36621 13.5618 2.89607 12.6551 1.98906ZM10.2177 2.83779C10.6562 2.39869 11.3677 2.39851 11.8064 2.8374C12.2447 3.27584 12.2447 3.9865 11.8065 4.42497L7.3392 8.89457L4.82213 9.82068L5.74706 7.31487L10.2177 2.83779Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M1.79238 13.2999C1.46101 13.2999 1.19238 13.5685 1.19238 13.8999C1.19238 14.2313 1.46101 14.4999 1.79238 14.4999H14.4924C14.8238 14.4999 15.0924 14.2313 15.0924 13.8999C15.0924 13.5685 14.8238 13.2999 14.4924 13.2999H1.79238Z"
    }
  }]
};
var ou2 = (0, import_react4.forwardRef)(function(e, t8) {
  return (0, import_react4.createElement)(ct4, Object.assign({}, e, {
    id: "write-icon",
    ref: t8,
    icon: Qw
  }));
});
ou2.displayName = "WriteIcon";
var Kw = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M11.0363 12.2367V14.0367C11.0363 14.3681 11.3049 14.6367 11.6363 14.6367C11.9676 14.6367 12.2363 14.3681 12.2363 14.0367V12.2367H14.0364C14.3677 12.2367 14.6364 11.9681 14.6364 11.6367C14.6364 11.3054 14.3677 11.0367 14.0364 11.0367H12.2363V9.23672C12.2363 8.90535 11.9676 8.63672 11.6363 8.63672C11.3049 8.63672 11.0363 8.90535 11.0363 9.23672V11.0367H9.23635C8.90498 11.0367 8.63635 11.3054 8.63635 11.6367C8.63635 11.9681 8.90498 12.2367 9.23635 12.2367H11.0363Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M2.56365 1.36377C1.90091 1.36377 1.36365 1.90103 1.36365 2.56377V6.16377C1.36365 6.82651 1.90091 7.36377 2.56365 7.36377H6.16365C6.82639 7.36377 7.36365 6.82651 7.36365 6.16377V2.56377C7.36365 1.90103 6.82639 1.36377 6.16365 1.36377H2.56365ZM6.16365 2.56377H2.56365L2.56365 6.16377H6.16365V2.56377Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M2.56365 8.63647C1.90091 8.63647 1.36365 9.17373 1.36365 9.83647V13.4365C1.36365 14.0992 1.90091 14.6365 2.56365 14.6365H6.16365C6.82639 14.6365 7.36365 14.0992 7.36365 13.4365V9.83647C7.36365 9.17373 6.82639 8.63647 6.16365 8.63647H2.56365ZM6.16365 9.83647H2.56365L2.56365 13.4365H6.16365V9.83647Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M9.83635 7.36377C9.17361 7.36377 8.63635 6.82651 8.63635 6.16377V2.56377C8.63635 1.90103 9.17361 1.36377 9.83635 1.36377H13.4364C14.0991 1.36377 14.6364 1.90103 14.6364 2.56377V6.16377C14.6364 6.82651 14.0991 7.36377 13.4364 7.36377H9.83635ZM9.83635 6.16377V2.56377L13.4364 2.56377V6.16377H9.83635Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    }
  ]
};
var Km2 = (0, import_react4.forwardRef)(function(e, t8) {
  return (0, import_react4.createElement)(ct4, Object.assign({}, e, {
    id: "autofill-double-icon",
    ref: t8,
    icon: Kw
  }));
});
Km2.displayName = "AutofillDoubleIcon";
var Jw = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "colorChannel1",
      d: "M6.4833 1.65005C6.4833 1.31868 6.21467 1.05005 5.8833 1.05005C5.55193 1.05005 5.2833 1.31868 5.2833 1.65005V5.28345H1.65029C1.31892 5.28345 1.05029 5.55208 1.05029 5.88345C1.05029 6.21482 1.31892 6.48345 1.65029 6.48345H5.2833V9.51684H1.65029C1.31892 9.51684 1.05029 9.78547 1.05029 10.1168C1.05029 10.4482 1.31892 10.7168 1.65029 10.7168H5.2833V14.35C5.2833 14.6814 5.55193 14.95 5.8833 14.95C6.21467 14.95 6.4833 14.6814 6.4833 14.35V10.7168H9.5167V14.35C9.5167 14.6814 9.78533 14.95 10.1167 14.95C10.4481 14.95 10.7167 14.6814 10.7167 14.35V10.7168H14.3503C14.6817 10.7168 14.9503 10.4482 14.9503 10.1168C14.9503 9.78547 14.6817 9.51685 14.3503 9.51685H10.7167V6.48345H14.3503C14.6817 6.48345 14.9503 6.21482 14.9503 5.88345C14.9503 5.55208 14.6817 5.28345 14.3503 5.28345H10.7167V1.65005C10.7167 1.31868 10.4481 1.05005 10.1167 1.05005C9.78533 1.05005 9.5167 1.31868 9.5167 1.65005V5.28345L6.4833 5.28345V1.65005ZM6.4833 6.48345V9.51684L9.5167 9.51685V6.48345L6.4833 6.48345Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M1.0498 3.65005C1.0498 2.21411 2.21386 1.05005 3.6498 1.05005H12.3498C13.7857 1.05005 14.9498 2.21411 14.9498 3.65005V12.3501C14.9498 13.786 13.7857 14.95 12.3498 14.95H3.6498C2.21386 14.95 1.0498 13.786 1.0498 12.35V3.65005ZM3.6498 2.25005C2.87661 2.25005 2.2498 2.87685 2.2498 3.65005V12.35C2.2498 13.1232 2.87661 13.75 3.6498 13.75H12.3498C13.123 13.75 13.7498 13.1232 13.7498 12.3501V3.65005C13.7498 2.87685 13.123 2.25005 12.3498 2.25005H3.6498Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var su2 = (0, import_react4.forwardRef)(function(e, t8) {
  return (0, import_react4.createElement)(ct4, Object.assign({}, e, {
    id: "hide-gridlines-double-icon",
    ref: t8,
    icon: Jw
  }));
});
su2.displayName = "HideGridlinesDoubleIcon";
var $w = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 17 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M8.01281 1.36643C8.79386 0.585377 10.0602 0.585378 10.8412 1.36643L12.9223 3.44752C13.7034 4.22857 13.7034 5.4949 12.9223 6.27595L9.36445 9.83383C8.5834 10.6149 7.31707 10.6149 6.53602 9.83383L4.45493 7.75273C3.67388 6.97168 3.67388 5.70535 4.45493 4.9243L8.01281 1.36643ZM9.9927 2.21495C9.68028 1.90253 9.17375 1.90253 8.86133 2.21495L5.30346 5.77283L5.29671 5.77966L10.839 6.66224L12.0738 5.42742C12.3862 5.115 12.3862 4.60847 12.0738 4.29605L9.9927 2.21495Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M14.5179 9.48875C14.5179 9.99175 14.1101 10.3995 13.607 10.3995C13.1041 10.3995 12.6963 9.99175 12.6963 9.48875C12.6963 9.1773 13.0455 8.59966 13.3114 8.20487C13.4549 7.99177 13.7591 7.99177 13.9027 8.20486C14.1687 8.59965 14.5179 9.1773 14.5179 9.48875Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M1.98682 13.4992C1.98682 12.5603 2.74793 11.7992 3.68682 11.7992H14.2868C15.2257 11.7992 15.9868 12.5603 15.9868 13.4992V13.4992C15.9868 14.4381 15.2257 15.1992 14.2868 15.1992H3.68682C2.74793 15.1992 1.98682 14.4381 1.98682 13.4992V13.4992Z"
      }
    }
  ]
};
var Jm = (0, import_react4.forwardRef)(function(e, t8) {
  return (0, import_react4.createElement)(ct4, Object.assign({}, e, {
    id: "paint-bucket-double-icon",
    ref: t8,
    icon: $w
  }));
});
Jm.displayName = "PaintBucketDoubleIcon";
var e02 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M7.74692 9.12463C7.74692 9.46018 8.01893 9.73219 8.35448 9.73219H11.4933C11.8288 9.73219 12.1009 9.46018 12.1009 9.12463C12.1009 8.78909 11.8288 8.51707 11.4933 8.51707H8.35448C8.01893 8.51707 7.74692 8.78909 7.74692 9.12463Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "colorChannel1",
        d: "M10.8636 10.8523C10.8636 11.1879 10.5915 11.4599 10.256 11.4599H8.35448C8.01893 11.4599 7.74692 11.1879 7.74692 10.8523C7.74692 10.5168 8.01893 10.2447 8.35448 10.2447H10.256C10.5915 10.2447 10.8636 10.5168 10.8636 10.8523Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M5.4791 1.98268C5.47913 1.71529 5.87912 1.49854 6.37252 1.49854C6.86593 1.49854 7.26592 1.71529 7.26595 1.98268H7.62187C8.22277 1.98268 8.72459 2.39534 8.84412 2.9452H9.39563C10.0856 2.9452 10.6449 3.48923 10.6449 4.16032V6.00569H12.1261C13.161 6.00569 14 6.82174 14 7.82838V11.334C14 11.8174 13.8025 12.281 13.4511 12.6228L12.0693 13.9647C11.7179 14.3065 11.2412 14.4985 10.7442 14.4985H7.91116C7.05024 14.4985 6.32492 14.0431 6.10535 13.2737H3.34925C2.6593 13.2737 2.09998 12.7297 2.09998 12.0586V4.16032C2.09998 3.48923 2.6593 2.9452 3.34925 2.9452H3.90107C4.0206 2.39534 4.52241 1.98268 5.12332 1.98268H5.4791ZM3.97249 4.16032H3.24925L3.24925 12.0586H6.03725V7.82838C6.03725 6.82174 6.87623 6.00569 7.91116 6.00569H9.49563V4.16032H8.7727C8.58289 4.59611 8.13909 4.90183 7.62187 4.90183H5.12332C4.6061 4.90183 4.1623 4.59611 3.97249 4.16032ZM5.12332 2.89403H7.62187C7.79436 2.89403 7.93419 3.03003 7.93419 3.19781V3.68671C7.93419 3.85448 7.79436 3.99049 7.62187 3.99049H5.12332C4.95083 3.99049 4.811 3.85448 4.811 3.68671V3.19781C4.811 3.03003 4.95083 2.89403 5.12332 2.89403ZM7.91116 7.11157C7.56618 7.11157 7.28652 7.38359 7.28652 7.71913V12.7851C7.28652 13.1206 7.56618 13.3927 7.91116 13.3927H10.7442C10.8401 13.3927 10.9337 13.3712 11.0182 13.3311C11.1373 13.2746 11.1859 13.1423 11.1859 13.0134V12.0066C11.1859 11.8724 11.2978 11.7636 11.4358 11.7636H12.4709C12.6034 11.7636 12.7394 11.7163 12.7975 11.6004C12.8388 11.5182 12.8608 11.4272 12.8608 11.334V7.71913C12.8608 7.38359 12.5811 7.11157 12.2362 7.11157H7.91116Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    }
  ]
};
var $m2 = (0, import_react4.forwardRef)(function(e, t8) {
  return (0, import_react4.createElement)(ct4, Object.assign({}, e, {
    id: "paste-special-double-icon",
    ref: t8,
    icon: e02
  }));
});
$m2.displayName = "PasteSpecialDoubleIcon";
var t02 = () => {
  const [, r] = (0, import_react4.useState)({});
  return (0, import_react4.useCallback)(() => r((e) => !e), []);
};
function n02() {
  const r = useDependency(Ls), e = useDependency(vr), t8 = useDependency(ME), n = useDependency(Hr), i = useDependency(Fn), [o, s] = (0, import_react4.useState)([]), [l, a] = (0, import_react4.useState)(false), [c, d] = (0, import_react4.useState)({ row: -1, col: -1 }), [u, h] = (0, import_react4.useState)(Le3.SERIES), [g, m2] = (0, import_react4.useState)(false), f2 = kr(), { sheetSkeletonManagerService: v2, selectionRenderService: p } = (0, import_react4.useMemo)(() => {
    if (f2) {
      const G7 = t8.getRenderById(f2.getUnitId());
      return {
        sheetSkeletonManagerService: G7 == null ? void 0 : G7.with(ue),
        selectionRenderService: G7 == null ? void 0 : G7.with(gt)
      };
    }
    return { sheetSkeletonManagerService: null, selectionRenderService: null };
  }, [f2, t8]), S = () => {
    m2(true);
  }, w = () => {
    m2(false);
  }, C = t02();
  if ((0, import_react4.useEffect)(() => r.onCommandExecuted((ge2, Re3) => {
    ge2.id === gn2.id && C();
  }).dispose, [C, r]), (0, import_react4.useEffect)(() => {
    const G7 = v2 && We(
      v2.currentSkeleton$.subscribe((ge2) => {
        ge2 && C();
      })
    );
    return G7 == null ? void 0 : G7.dispose;
  }, [v2, C]), (0, import_react4.useEffect)(() => We(
    n.menu$.subscribe((ge2) => {
      s(ge2.map((Re3) => ({ ...Re3, index: ge2.indexOf(Re3) })));
    })
  ).dispose, [n]), (0, import_react4.useEffect)(() => We(
    n.showMenu$.subscribe((ge2) => {
      const { source: Re3, target: be2 } = n.autoFillLocation || { source: null, target: null };
      if (ge2 && Re3 && be2) {
        const Ne3 = Math.max(Re3.rows[Re3.rows.length - 1], be2.rows[be2.rows.length - 1]), Z7 = Math.max(Re3.cols[Re3.cols.length - 1], be2.cols[be2.cols.length - 1]);
        d({ row: Ne3, col: Z7 });
      } else
        d({ row: -1, col: -1 });
    })
  ).dispose, [n]), (0, import_react4.useEffect)(() => We(
    n.applyType$.subscribe((ge2) => {
      h(ge2);
    })
  ).dispose, [n]), (0, import_react4.useEffect)(() => {
    function G7() {
      a(false);
    }
    return document.addEventListener("wheel", G7), () => {
      document.removeEventListener("wheel", G7);
    };
  }, [l]), c.col < 0 || c.row < 0)
    return null;
  const I2 = en4(e, t8);
  if (!I2 || !p) return null;
  const { scene: R } = I2, y = v2 == null ? void 0 : v2.getCurrentSkeleton(), M7 = p.getViewPort(), E = R == null ? void 0 : R.scaleX, T = R == null ? void 0 : R.scaleY, P2 = R == null ? void 0 : R.getViewportScrollXY(M7);
  if (!E || !R || !E || !T || !P2) return null;
  const H3 = (y == null ? void 0 : y.getNoMergeCellWithCoordByIndex(c.row, c.col).endX) || 0, A = (y == null ? void 0 : y.getNoMergeCellWithCoordByIndex(c.row, c.col).endY) || 0, x7 = PB(H3, E, P2), V2 = NB(A, T, P2);
  if (x7 == null || V2 == null) return null;
  const D2 = (G7) => {
    a(G7);
  }, X2 = (G7) => {
    r.executeCommand(va2.id, { type: G7.value }), a(false);
  }, B = l || g, j = o.filter((G7) => !G7.disable);
  return (0, import_jsx_runtime4.jsx)("div", { className: "univer-absolute univer-inset-0 univer-z-10 univer-size-0", children: (0, import_jsx_runtime4.jsx)(
    "div",
    {
      className: "univer-absolute",
      style: { left: `${x7 + 2}px`, top: `${V2 + 2}px` },
      onMouseEnter: S,
      onMouseLeave: w,
      children: (0, import_jsx_runtime4.jsx)(
        ep,
        {
          align: "start",
          items: j.map((G7) => ({
            type: "radio",
            value: u,
            options: [{ label: i.t(G7.label), value: G7.value }],
            onSelect: () => X2(G7)
          })),
          open: l,
          onOpenChange: D2,
          children: (0, import_jsx_runtime4.jsxs)(
            "div",
            {
              className: ie2("univer-flex univer-items-center univer-gap-2 univer-rounded univer-p-1 hover:univer-bg-gray-100 dark:hover:!univer-bg-gray-800", kt2, {
                "univer-bg-gray-100 dark:!univer-bg-gray-800": l,
                "univer-bg-white dark:!univer-bg-gray-900": !l
              }),
              children: [
                (0, import_jsx_runtime4.jsx)(
                  Km2,
                  {
                    className: "univer-fill-primary-600 univer-text-gray-900 dark:!univer-text-white"
                  }
                ),
                B && (0, import_jsx_runtime4.jsx)(_i3, { className: "dark:!univer-text-white" })
              ]
            }
          )
        }
      )
    }
  ) });
}
function ef2(r, e) {
  const t8 = useDependency(qe5), n = useDependency(Ls);
  return (0, import_react4.useMemo)(() => ({
    keyCodes: [
      { keyCode: q1.ENTER },
      { keyCode: q1.ESC },
      { keyCode: q1.TAB }
    ],
    handler: (o) => {
      (o === q1.ENTER || o === q1.ESC || o === q1.TAB) && (t8.disableForceKeepVisible(), n.syncExecuteCommand(tt3.id, {
        visible: false,
        eventType: Kv.Keyboard,
        keycode: o,
        unitId: e
      }));
    }
  }), [n, t8, e]);
}
var ul = -1e3;
var gh3 = {
  width: 0,
  height: 0,
  top: ul,
  left: ul
};
var r03 = () => {
  const [r, e] = (0, import_react4.useState)({
    ...gh3
  }), t8 = useDependency(ls3), n = useDependency(Ge2), i = useDependency(Nr), o = useDependency(S1), s = useDependency(qe5), l = useObservable(s.visible$), a = useDependency(Ls), c = (0, import_react4.useRef)(0), d = useObservable(
    () => i.subscribeContextValue$(wi2),
    false,
    void 0,
    [i, wi2]
  ), u = o.get(Ld2), h = s.getEditLocation();
  (0, import_react4.useEffect)(() => {
    const v2 = t8.state$.subscribe((p) => {
      if (p == null)
        return;
      const {
        startX: S = ul,
        startY: w = ul,
        endX: C = 0,
        endY: I2 = 0,
        show: R = false
      } = p;
      if (!R)
        e({
          ...gh3
        });
      else {
        e({
          width: C - S,
          height: I2 - w,
          left: S,
          top: w
        });
        const y = n.getEditor(Dl);
        if (y == null)
          return;
        const { left: M7, top: E, width: T, height: P2 } = y.getBoundingClientRect();
        t8.setRect({ left: M7, top: E, width: T, height: P2 });
      }
    });
    return () => {
      v2.unsubscribe();
    };
  }, []), (0, import_react4.useEffect)(() => {
    d || t8.setFocus(true);
  }, [d, r]);
  const g = re(() => {
    s.isVisible().visible && a.executeCommand(tt3.id, {
      visible: false,
      eventType: Kv.PointerUp,
      unitId: h == null ? void 0 : h.unitId
    });
  });
  r7(g);
  const m2 = ef2(c, h == null ? void 0 : h.unitId), f2 = re((v2, p) => {
    a.executeCommand(wi4.id, {
      keycode: v2,
      visible: false,
      eventType: Kv.Keyboard,
      isShift: p === L1.SHIFT || p === (L1.CTRL_COMMAND | L1.SHIFT),
      unitId: h == null ? void 0 : h.unitId
    });
  });
  return (0, import_jsx_runtime4.jsx)(
    "div",
    {
      className: "univer-absolute univer-z-10 univer-flex",
      style: {
        left: r.left,
        top: r.top,
        width: r.width,
        height: r.height
      },
      children: u && (0, import_jsx_runtime4.jsx)(
        u,
        {
          editorId: Dl,
          className: "univer-relative univer-flex univer-h-full univer-w-full [&_canvas]:univer-absolute",
          initValue: "",
          onChange: () => {
          },
          isFocus: l == null ? void 0 : l.visible,
          unitId: h == null ? void 0 : h.unitId,
          subUnitId: h == null ? void 0 : h.sheetId,
          keyboardEventConfig: m2,
          onMoveInEditor: f2,
          isSupportAcrossSheet: true,
          resetSelectionOnBlur: false,
          isSingle: false,
          autoScrollbar: false,
          onFormulaSelectingChange: (v2, p) => {
            c.current = v2, p && (v2 ? s.enableForceKeepVisible() : s.disableForceKeepVisible());
          },
          disableSelectionOnClick: true,
          disableContextMenu: false
        }
      )
    }
  );
};
var tf2 = class {
  constructor() {
    _2(this, "_position", null);
    _2(this, "_position$", new BehaviorSubject(null));
    _2(this, "position$", this._position$.asObservable());
    _2(this, "_focus", false);
    _2(this, "_focus$", new BehaviorSubject(this._focus));
    _2(this, "focus$", this._focus$.asObservable());
    _2(this, "_fxBtnClick$", new Subject());
    _2(this, "fxBtnClick$", this._fxBtnClick$.asObservable());
    _2(this, "_foldBtnStatus$", new Subject());
    _2(this, "foldBtnStatus$", this._foldBtnStatus$.asObservable());
  }
  dispose() {
    this._position$.complete(), this._focus$.complete(), this._position = null, this._focus = false;
  }
  setPosition(e) {
    this._position = e, this._refresh(e);
  }
  getPosition() {
    return this._position;
  }
  setFocus(e = false) {
    this._focus = e, this._focus$.next(e);
  }
  handleFxBtnClick(e) {
    this._fxBtnClick$.next(e);
  }
  handleFoldBtnClick(e) {
    this._foldBtnStatus$.next(e);
  }
  _refresh(e) {
    this._position$.next(e);
  }
};
var as2 = createIdentifier(
  "univer.sheet-formula-editor-manager.service"
);
function i02() {
  const r = useDependency(Ls), e = useDependency(Fn), t8 = useDependency(Nr2), n = useDependency(vr), i = useDependency(we3), s = n.getCurrentUnitForType(we.UNIVER_SHEET).getUnitId(), l = () => {
    const h = t8.getDefinedNameMap(s);
    return h ? Array.from(Object.values(h)) : [];
  }, [a, c] = (0, import_react4.useState)(l());
  (0, import_react4.useEffect)(() => {
    const h = t8.update$.subscribe(() => {
      c(l());
    });
    return () => {
      h.unsubscribe();
    };
  }, []), (0, import_react4.useEffect)(() => {
    const h = i.sidebarOptions$.subscribe((g) => {
      g.id === xo2 && (g.visible || setTimeout(() => {
        i.sidebarOptions$.next({ visible: false });
      }));
    });
    return () => {
      h.unsubscribe();
    };
  }, []);
  const d = () => {
    r.executeCommand(eu2.id, { value: "open" });
  }, u = async (h) => {
    const { formulaOrRefString: g, id: m2 } = h, f2 = t8.getWorksheetByRef(s, g);
    if (!f2)
      return;
    f2.isSheetHidden() && await r.executeCommand(ui.id, { unitId: s, subUnitId: f2.getSheetId() }), t8.focusRange(s, m2);
  };
  return (0, import_jsx_runtime4.jsxs)("div", { className: "univer-w-[300px]", children: [
    (0, import_jsx_runtime4.jsx)(
      "ul",
      {
        className: ie2("univer-m-0 univer-max-h-[360px] univer-list-none univer-overflow-y-auto univer-p-0", pr),
        children: a.map((h, g) => (0, import_jsx_runtime4.jsx)(
          "li",
          {
            className: "univer-cursor-pointer univer-px-2 univer-transition-colors univer-duration-200 hover:univer-bg-gray-100 dark:hover:!univer-bg-gray-600",
            onClick: () => {
              u(h);
            },
            children: (0, import_jsx_runtime4.jsxs)(
              "div",
              {
                className: ie2("univer-flex univer-items-center univer-justify-between univer-gap-2 univer-py-1", eE),
                children: [
                  (0, import_jsx_runtime4.jsx)(
                    "div",
                    {
                      className: "univer-w-[50%] univer-flex-shrink-0 univer-truncate univer-text-sm univer-text-gray-600 dark:!univer-text-gray-200",
                      title: h.name,
                      children: h.name
                    }
                  ),
                  (0, import_jsx_runtime4.jsx)(
                    "div",
                    {
                      className: "univer-w-[50%] univer-flex-shrink-0 univer-truncate univer-text-xs univer-text-gray-400",
                      title: h.formulaOrRefString,
                      children: h.formulaOrRefString
                    }
                  )
                ]
              }
            )
          },
          g
        ))
      }
    ),
    (0, import_jsx_runtime4.jsxs)(
      "div",
      {
        className: "univer-cursor-pointer univer-p-2 univer-transition-colors univer-duration-200 hover:univer-bg-gray-100 dark:hover:!univer-bg-gray-600",
        onClick: d,
        children: [
          (0, import_jsx_runtime4.jsx)(
            "div",
            {
              className: "univer-mb-2 univer-text-sm univer-font-semibold univer-text-gray-600 dark:!univer-text-gray-200",
              children: e.t("definedName.managerTitle")
            }
          ),
          (0, import_jsx_runtime4.jsx)("div", { className: "univer-text-xs univer-text-gray-400", children: e.t("definedName.managerDescription") })
        ]
      }
    )
  ] });
}
function o02({ disable: r }) {
  const [e, t8] = (0, import_react4.useState)(""), n = useDependency(Nr2);
  (0, import_react4.useEffect)(() => {
    const o = n.currentRange$.subscribe(() => {
      t8(n.getCurrentRangeForString());
    });
    return () => {
      o.unsubscribe();
    };
  }, []);
  function i() {
  }
  return (0, import_jsx_runtime4.jsxs)(
    "div",
    {
      "data-u-comp": "defined-name",
      className: "univer-relative univer-box-border univer-flex univer-h-full univer-w-24 univer-border-r-gray-200 univer-py-1.5 univer-transition-all",
      children: [
        (0, import_jsx_runtime4.jsx)(
          "input",
          {
            className: ie2("univer-box-border univer-h-full univer-w-full univer-appearance-none univer-px-1.5 univer-text-gray-900 focus:univer-outline-none dark:!univer-border-r-gray-700 dark:!univer-bg-gray-900 dark:!univer-text-white", tE, {
              "univer-cursor-not-allowed": r
            }),
            type: "text",
            value: e,
            onChange: i
          }
        ),
        (0, import_jsx_runtime4.jsx)(
          vf2,
          {
            overlay: (0, import_jsx_runtime4.jsx)("div", { className: "univer-z-[1001]", children: (0, import_jsx_runtime4.jsx)(i02, {}) }),
            disabled: r,
            children: (0, import_jsx_runtime4.jsx)(
              "a",
              {
                className: ie2("univer-absolute univer-right-0 univer-top-0 univer-flex univer-h-full univer-cursor-pointer univer-items-center univer-justify-center univer-px-1 univer-transition-colors univer-duration-200 hover:univer-bg-gray-100 dark:!univer-text-white dark:hover:!univer-bg-gray-800", {
                  "univer-cursor-not-allowed univer-text-gray-300 hover:univer-bg-transparent dark:!univer-text-gray-700": r
                }),
                children: (0, import_jsx_runtime4.jsx)(_i3, {})
              }
            )
          }
        )
      ]
    }
  );
}
function s02(r) {
  var ne2, pe2, Ue3, me3;
  const { className: e, disableDefinedName: t8 } = r, [n, i] = (0, import_react4.useState)(false), [o, s] = (0, import_react4.useState)(
    0
    /* Down */
  ), l = useDependency(as2), a = useDependency(qe5), c = useDependency(lt), d = useDependency(me), u = useDependency(vr), h = useDependency(z), g = useDependency(eC), m2 = useDependency(Lt), f2 = useDependency(Ls), [v2, p] = (0, import_react4.useState)({
    editDisable: false,
    viewDisable: false
  }), [S, w] = (0, import_react4.useState)(false), C = useDependency(S1), I2 = useObservable(() => u.getCurrentTypeOfUnit$(we.UNIVER_SHEET), void 0, void 0, []), R = (0, import_react4.useRef)(0), y = useObservable(a.currentEditCellState$), M7 = ef2(R, (ne2 = y == null ? void 0 : y.unitId) != null ? ne2 : ""), E = C.get(Ld2), T = M1(Wm2.FORMULA_AUX), P2 = useDependency(Nr);
  useObservable((0, import_react4.useMemo)(() => P2.subscribeContextValue$(gE), [P2]));
  const H3 = P2.getContextValue(gE), A = (0, import_react4.useRef)(null), x7 = useDependency(Ge2);
  (0, import_react4.useLayoutEffect)(() => {
    const _e4 = I2.activeSheet$.pipe(
      switchMap((le2) => le2 ? merge(
        c.ruleChange$,
        d.ruleChange$,
        h.selectionMoveEnd$,
        h.selectionSet$
      ).pipe(
        switchMap(() => {
          var Bn5, Fn5;
          const it2 = I2.getUnitId(), ot4 = le2.getSheetId();
          if (!((Bn5 = h.getCurrentLastSelection()) == null ? void 0 : Bn5.range)) return EMPTY;
          const wt3 = (Fn5 = h.getCurrentLastSelection()) == null ? void 0 : Fn5.primary;
          return wt3 ? of({
            unitId: it2,
            subUnitId: ot4,
            primary: wt3
          }) : of(null);
        })
      ) : EMPTY)
    ).subscribe((le2) => {
      var it2, ot4, vt3, wt3, Bn5, Fn5;
      if (le2) {
        const { unitId: us3, subUnitId: hs3, primary: Np } = le2;
        if (c.getRule(us3, hs3)) {
          const Lp = !((ot4 = (it2 = g.getPermissionPoint(new Ve2(us3, hs3).id)) == null ? void 0 : it2.value) == null || ot4), Wp = !((wt3 = (vt3 = g.getPermissionPoint(new ls(us3, hs3).id)) == null ? void 0 : vt3.value) == null || wt3);
          p({
            viewDisable: Wp,
            editDisable: Lp
          });
          return;
        }
        const { actualRow: kp, actualColumn: Dp } = Np, Lr = m2.getCellInfo(us3, hs3, kp, Dp);
        p({
          editDisable: !((Bn5 = Lr == null ? void 0 : Lr[_.Edit]) == null || Bn5),
          viewDisable: !((Fn5 = Lr == null ? void 0 : Lr[_.View]) == null || Fn5)
        });
      } else
        p({
          viewDisable: false,
          editDisable: false
        });
    });
    return () => {
      _e4.unsubscribe();
    };
  }, [I2]), (0, import_react4.useEffect)(() => {
    const _e4 = a.visible$.subscribe((le2) => {
      i(le2.visible);
    });
    return () => _e4.unsubscribe();
  }, [a.visible$]), (0, import_react4.useEffect)(() => {
    const _e4 = a.currentEditCellState$.subscribe((le2) => {
      var it2, ot4, vt3;
      (vt3 = (ot4 = (it2 = le2 == null ? void 0 : le2.documentLayoutObject.documentModel) == null ? void 0 : it2.getBody()) == null ? void 0 : ot4.customBlocks) != null && vt3.length ? w(true) : w(false);
    });
    return () => _e4.unsubscribe();
  }, [a.currentEditCellState$]), (0, import_react4.useEffect)(() => {
    const _e4 = () => {
      if (!A.current) return;
      const le2 = A.current.getBoundingClientRect();
      l.setPosition(le2);
    };
    if (A.current) {
      _e4();
      const le2 = new ResizeObserver(_e4);
      return le2.observe(A.current), () => le2.disconnect();
    }
  }, [l]);
  function V2() {
    s(
      o === 0 ? 1 : 0
      /* Down */
    ), setTimeout(() => {
      l.handleFoldBtnClick(
        o === 1
        /* Up */
      );
    }, 150);
  }
  function D2() {
    a.isVisible().visible && f2.executeCommand(tt3.id, {
      visible: false,
      eventType: Kv.Keyboard,
      keycode: q1.ESC,
      unitId: y.unitId
    });
  }
  function X2() {
    a.isVisible().visible && f2.executeCommand(tt3.id, {
      visible: false,
      eventType: Kv.PointerDown,
      unitId: y.unitId
    });
  }
  function B() {
    l.handleFxBtnClick(true);
  }
  const { viewDisable: j, editDisable: G7 } = v2, ge2 = G7 || S, Re3 = (0, import_react4.useRef)(false), be2 = () => {
    try {
      if (a.isVisible().visible === false && !f2.syncExecuteCommand(
        tt3.id,
        {
          visible: true,
          eventType: Kv.PointerDown,
          unitId: y.unitId
        }
      )) {
        Re3.current = true;
        return;
      }
      P2.setContextValue(gE, true);
    } catch (_e4) {
      throw Re3.current = true, _e4;
    }
  }, Ne3 = () => {
    Re3.current && setTimeout(() => {
      x7.blur(true);
    }, 30), Re3.current = false;
  }, ee3 = ((me3 = (Ue3 = (pe2 = y == null ? void 0 : y.documentLayoutObject.documentModel) == null ? void 0 : pe2.getDrawingsOrder()) == null ? void 0 : Ue3.length) != null ? me3 : 0) > 0 || j;
  return (0, import_jsx_runtime4.jsxs)(
    "div",
    {
      "data-u-comp": "formula-bar",
      className: ie2("univer-box-border univer-flex univer-bg-white univer-transition-[height] univer-ease-linear dark:!univer-bg-gray-900", eE, e, {
        "univer-h-7": o === 0,
        "univer-h-20": o === 1,
        "univer-pointer-events-none": G7
      }),
      children: [
        (0, import_jsx_runtime4.jsx)("div", { className: "univer-relative univer-box-border univer-h-full univer-w-[100px]", children: (0, import_jsx_runtime4.jsx)(o02, { disable: t8 != null ? t8 : G7 }) }),
        (0, import_jsx_runtime4.jsxs)("div", { className: "univer-flex univer-h-full univer-w-full", children: [
          (0, import_jsx_runtime4.jsx)("div", { className: ie2("univer-py-1.5", { "univer-cursor-not-allowed univer-text-gray-200": ge2 }), children: (0, import_jsx_runtime4.jsxs)(
            "div",
            {
              className: ie2("univer-relative univer-box-border univer-flex univer-h-full univer-w-20 univer-items-center univer-justify-center univer-text-xs", tE),
              children: [
                (0, import_jsx_runtime4.jsx)(
                  "span",
                  {
                    className: ie2("univer-flex univer-items-center univer-justify-center univer-rounded univer-p-1 univer-text-base dark:!univer-text-white", {
                      "univer-cursor-pointer univer-text-red-600 hover:univer-bg-gray-100 dark:!univer-text-green-400 dark:hover:!univer-bg-gray-700": n
                    }),
                    onClick: D2,
                    children: (0, import_jsx_runtime4.jsx)(Um, {})
                  }
                ),
                (0, import_jsx_runtime4.jsx)(
                  "span",
                  {
                    className: ie2("univer-flex univer-items-center univer-justify-center univer-rounded univer-p-1 univer-text-base dark:!univer-text-white", {
                      "univer-cursor-pointer univer-text-green-600 hover:univer-bg-gray-100 dark:!univer-text-red-400 dark:hover:!univer-bg-gray-700": n
                    }),
                    onClick: X2,
                    children: (0, import_jsx_runtime4.jsx)(Dr3, {})
                  }
                ),
                (0, import_jsx_runtime4.jsx)(
                  "span",
                  {
                    className: "univer-flex univer-cursor-pointer univer-items-center univer-justify-center univer-rounded univer-p-1 univer-text-base hover:univer-bg-gray-100 dark:!univer-text-white dark:hover:!univer-bg-gray-700",
                    onClick: B,
                    children: (0, import_jsx_runtime4.jsx)(Ym, {})
                  }
                )
              ]
            }
          ) }),
          (0, import_jsx_runtime4.jsxs)("div", { className: "univer-flex univer-w-full univer-flex-1 univer-overflow-hidden univer-pl-3", children: [
            (0, import_jsx_runtime4.jsxs)(
              "div",
              {
                ref: A,
                className: "univer-relative univer-flex-1",
                onPointerDown: be2,
                onPointerUp: Ne3,
                style: { pointerEvents: ee3 ? "none" : "auto" },
                children: [
                  E && (0, import_jsx_runtime4.jsx)(
                    E,
                    {
                      className: "univer-relative univer-h-full univer-w-full univer-break-words univer-outline-none [&>div]:univer-ring-transparent",
                      disableSelectionOnClick: true,
                      editorId: Ul,
                      initValue: "",
                      onChange: () => {
                      },
                      isFocus: H3,
                      unitId: y == null ? void 0 : y.unitId,
                      subUnitId: y == null ? void 0 : y.sheetId,
                      isSupportAcrossSheet: true,
                      resetSelectionOnBlur: false,
                      isSingle: false,
                      keyboardEventConfig: M7,
                      onFormulaSelectingChange: (_e4, le2) => {
                        R.current = _e4, le2 && (_e4 ? a.enableForceKeepVisible() : a.disableForceKeepVisible());
                      },
                      autoScrollbar: false,
                      disableContextMenu: false
                    }
                  ),
                  ee3 && (0, import_jsx_runtime4.jsx)(
                    "div",
                    {
                      className: "univer-pointer-events-none univer-relative univer-left-0 univer-top-0 univer-z-[100] univer-h-full univer-w-full univer-cursor-not-allowed univer-bg-white"
                    }
                  )
                ]
              }
            ),
            (0, import_jsx_runtime4.jsx)(
              "div",
              {
                className: ie2("univer-flex univer-h-full univer-w-5 univer-cursor-pointer univer-items-center univer-justify-center univer-text-xs univer-text-gray-700 dark:!univer-text-gray-200", { "univer-cursor-not-allowed univer-text-gray-200 dark:!univer-text-gray-700": G7 }),
                onClick: V2,
                children: (0, import_jsx_runtime4.jsx)(
                  zm2,
                  {
                    className: ie2({
                      "univer-rotate-180": o === 1
                      /* Up */
                    })
                  }
                )
              }
            )
          ] })
        ] }),
        (0, import_jsx_runtime4.jsx)(I13, { components: T }, "formula-aux")
      ]
    }
  );
}
function As2(r) {
  const { children: e, className: t8, style: n, disabled: i = false, onClick: o, ...s } = r;
  return (0, import_jsx_runtime4.jsx)(
    vr2,
    {
      "data-u-comp": "sheet-bar-append-button",
      className: t8,
      size: "small",
      disabled: i,
      style: n,
      variant: "text",
      onClick: (a) => {
        if (i) {
          a.preventDefault();
          return;
        }
        o && o(a);
      },
      ...s,
      children: e
    }
  );
}
function l02() {
  const [r, e] = (0, import_react4.useState)([]), [t8, n] = (0, import_react4.useState)(false), i = useDependency(vr), o = useDependency(Ls), s = useDependency(Nr3), l = useDependency(lt), a = useObservable(() => i.getCurrentTypeOfUnit$(we.UNIVER_SHEET), null, false, []), c = (f2) => {
    const { sheetId: v2 } = f2;
    !v2 || !a || (f2.hidden ? o.executeCommand(ui.id, {
      unitId: a.getUnitId(),
      subUnitId: v2,
      value: v2
    }) : f2.selected || o.executeCommand(ri.id, {
      unitId: a.getUnitId(),
      subUnitId: v2
    }), n(false));
  }, d = (0, import_react4.useCallback)(() => {
    if (!a) return;
    const f2 = a.getSheets(), v2 = a.getActiveSheet(), p = f2.map((S, w) => ({
      label: S.getName(),
      index: `${w}`,
      sheetId: S.getSheetId(),
      hidden: S.isSheetHidden() === ie.TRUE,
      selected: v2 === S
    }));
    e(p);
  }, [a, l]), u = (0, import_react4.useCallback)(() => o.onCommandExecuted((f2) => {
    switch (f2.id) {
      case wt.id:
      case Ht.id:
      case jn.id:
      case hn.id:
      case Tn2.id:
      case pn2.id:
        d();
        break;
    }
  }), [o, d]);
  function h() {
    n(true);
  }
  const g = (f2) => {
    n(f2);
  };
  (0, import_react4.useEffect)(() => {
    d();
    const f2 = new ao();
    return f2.add(u()), f2.add(s.registerSheetBarMenuHandler({ handleSheetBarMenu: h })), () => f2.dispose();
  }, [u, s, d, a]);
  const m2 = (0, import_react4.useMemo)(() => r.map((f2) => ({
    type: "item",
    children: (0, import_jsx_runtime4.jsxs)("div", { className: "univer-relative univer-box-border univer-pl-6", children: [
      (f2.selected || f2.hidden) && (0, import_jsx_runtime4.jsxs)("span", { className: "univer-absolute univer-left-1 univer-top-0.5", children: [
        f2.selected && (0, import_jsx_runtime4.jsx)(Dr3, { className: "univer-size-4 univer-text-primary-600" }),
        f2.hidden && (0, import_jsx_runtime4.jsx)(jm2, { className: "univer-size-4 univer-text-gray-400" })
      ] }),
      (0, import_jsx_runtime4.jsx)(
        "span",
        {
          className: ie2({
            "univer-text-primary-600": f2.selected
          }),
          children: f2.label
        }
      )
    ] }),
    onSelect: () => {
      c(f2);
    }
  })), [r]);
  return (0, import_jsx_runtime4.jsx)(
    ep,
    {
      align: "start",
      items: m2,
      open: t8,
      onOpenChange: g,
      children: (0, import_jsx_runtime4.jsx)("div", { children: (0, import_jsx_runtime4.jsx)(As2, { children: (0, import_jsx_runtime4.jsx)(Xm2, {}) }) })
    }
  );
}
function a03(r) {
  const { sheetId: e, label: t8, color: n, selected: i, menuOverlay: o } = r, [s, l] = (0, import_react4.useState)(i), a = useDependency(Gi);
  (0, import_react4.useEffect)(() => {
    l(i);
  }, [i]);
  const c = (d) => {
    const u = a.getColorFromTheme("gray.900"), h = a.getColorFromTheme("white");
    return new bt(d).isDark() ? h : u;
  };
  return (0, import_jsx_runtime4.jsx)(
    "div",
    {
      "data-u-comp": "slide-tab-item",
      "data-id": e,
      className: ie2("univer-mx-1 univer-box-border univer-flex univer-flex-grow univer-cursor-pointer univer-select-none univer-flex-row univer-items-center univer-rounded univer-text-xs univer-transition-[colors,box-shadow]", {
        "dark:!univer-text-white": !n || n && !c(n),
        "univer-justify-center univer-bg-white univer-font-bold univer-text-primary-700 univer-shadow": s,
        "dark:!univer-bg-gray-900": s && !n,
        "univer-font-medium univer-text-gray-900 hover:univer-bg-gray-100": !s,
        "dark:hover:!univer-bg-gray-700": !s && !n
      }),
      style: {
        backgroundColor: !s && n ? n : "",
        color: !s && n ? c(n) : "",
        boxShadow: s && n ? `0px 0px 8px rgba(0, 0, 0, 0.08), inset 0px -2px 0px 0px ${n}` : ""
      },
      children: (0, import_jsx_runtime4.jsx)(
        "div",
        {
          className: "univer-box-border univer-flex univer-items-center univer-gap-1 univer-whitespace-nowrap univer-rounded univer-border-2 univer-border-solid univer-border-transparent univer-px-1.5 univer-py-1",
          children: t8
        }
      )
    },
    e
  );
}
var c02 = {
  easeOutStrong(r, e, t8, n) {
    return -t8 * ((r = r / n - 1) * r * r * r - 1) + e;
  },
  backOut(r, e, t8, n, i) {
    return typeof i > "u" && (i = 0.7), t8 * ((r = r / n - 1) * r * ((i + 1) * r + i) + 1) + e;
  }
};
var d03 = {
  loop: false,
  begin: 0,
  end: 0,
  duration: 300,
  delay: 0,
  type: "easeOutStrong",
  receive(r) {
  },
  success(r) {
  },
  cancel(r) {
  },
  complete(r) {
  }
};
var u02 = class {
  constructor(e) {
    _2(this, "_config");
    _2(this, "_status", 0);
    _2(this, "_start", 0);
    _2(this, "_handle", 0);
    _2(this, "_delayHandle", null);
    this._config = {
      ...d03,
      ...e
    }, this._config.loop && (this._config.complete = () => {
    }, this._config.success = () => {
      this.request();
    });
  }
  static success(...e) {
    let t8 = 0;
    return new Promise((n) => {
      for (let i = 0; i < e.length; i++) {
        const o = e[i], s = o._config, l = s.success;
        s.loop || (s.success = (c) => {
          t8++, l && l.call(o, c), t8 === e.length && n();
        });
      }
    });
  }
  request() {
    this._config.delay === 0 ? (this._status = 0, this._start = Date.now(), this._fakeHandle()) : (this._delayHandle && clearTimeout(this._delayHandle), this._delayHandle = setTimeout(() => {
      this._status = 0, this._start = Date.now(), this._fakeHandle();
    }, this._config.delay));
  }
  cancel() {
    this._status = 1, this._delayHandle && clearTimeout(this._delayHandle), cancelAnimationFrame(this._handle);
  }
  _fakeHandle() {
    let e = Date.now() - this._start;
    e = e >= this._config.duration ? this._config.duration : e;
    const n = c02[this._config.type](
      e,
      this._config.begin,
      this._config.end - this._config.begin,
      this._config.duration,
      0.7
    ).toFixed(2);
    if (this._config.receive(n), this._status === 1) {
      this._config.cancel(n), this._config.complete(n);
      return;
    }
    if (e === this._config.duration) {
      this._config.success(n), this._config.complete(n);
      return;
    }
    this._handle = requestAnimationFrame(() => {
      this._fakeHandle();
    });
  }
};
var vr5 = class _vr {
  constructor(e, t8) {
    _2(this, "_slideTabItem");
    _2(this, "_animate");
    _2(this, "_midline", 0);
    _2(this, "_translateX");
    _2(this, "_scrollbar");
    _2(this, "_slideTabBar");
    _2(this, "_editMode");
    _2(this, "_placeholder");
    this._slideTabItem = e, this._animate = null, this._translateX = 0, this._editMode = false, this._slideTabBar = t8, this._placeholder = null, this._scrollbar = t8.getScrollbar(), this.update();
  }
  static midline(e) {
    return e.getBoundingRect().x + e.getBoundingRect().width / 2;
  }
  static leftLine(e) {
    return e.getBoundingRect().x;
  }
  static rightLine(e) {
    return e.getBoundingRect().x + e.getBoundingRect().width;
  }
  static make(e, t8) {
    const n = [];
    return e.forEach((i) => n.push(new _vr(i, t8))), n;
  }
  getSlideTabItem() {
    return this._slideTabItem;
  }
  getEditor() {
    return this._slideTabItem.querySelector("span");
  }
  focus() {
    var e;
    (e = this.getEditor()) == null || e.focus();
  }
  selectAll() {
    const e = this.getEditor();
    e && ai4.keepSelectAll(e);
  }
  isEditMode() {
    return this._editMode;
  }
  classList() {
    return this._slideTabItem.classList;
  }
  translateX(e) {
    return this._translateX = e, this._slideTabItem.style.transform = `translateX(${e}px)`, this.getTranslateXDirection();
  }
  setEditor(e) {
    if (!this._slideTabBar.getConfig().onNameChangeCheck())
      return;
    let t8 = true;
    if (this._editMode === false) {
      const n = this._slideTabItem.querySelector("span"), i = (c) => {
        if (!this.nameCheck()) {
          if (this._editMode = false, n && (n.removeAttribute("contentEditable"), n.removeEventListener("focusout", i), n.removeEventListener("compositionstart", s), n.removeEventListener("compositionend", l), n.removeEventListener("input", a), n.removeEventListener("keydown", o)), this._slideTabBar.removeListener(), this._slideTabBar.updateItems(), this._slideTabBar.getConfig().onChangeName) {
            const d = (n == null ? void 0 : n.innerText) || "", u = this.getId();
            this._slideTabBar.getConfig().onChangeName(u, d);
          }
          e && e(c);
        }
      };
      let o = (c) => {
        n && (c.stopPropagation(), c.key === "Enter" && n.blur());
      };
      const s = (c) => {
        t8 = false;
      }, l = (c) => {
        t8 = true;
      }, a = (c) => {
        if (!n) return;
        const d = 31;
        setTimeout(() => {
          if (t8) {
            const u = n.innerText;
            u.length > d && (n.innerText = u.substring(0, d), ai4.keepLastIndex(n));
          }
        }, 0);
      };
      n && (n.setAttribute("contentEditable", "true"), n.addEventListener("focusout", i), n.addEventListener("compositionstart", s), n.addEventListener("compositionend", l), n.addEventListener("input", a), n.addEventListener("keydown", o), this._editMode = true, ai4.keepSelectAll(n));
    }
  }
  nameCheck() {
    const e = this._slideTabItem.querySelector("span");
    if (!e) return false;
    const t8 = e.innerText;
    return this._slideTabBar.getConfig().onNameCheckAlert(t8);
  }
  animate() {
    return {
      translateX: (e) => {
        this._translateX !== e && (this._animate && (this._animate.cancel(), this._animate = null), this._animate = new u02({
          begin: this._translateX,
          end: e,
          receive: (t8) => {
            this._slideTabItem.style.transform = `translateX(${t8}px)`;
          }
        }), this._translateX = e, this._animate.request());
      },
      cancel: () => {
        this._animate && (this._animate.cancel(), this._animate = null);
      }
    };
  }
  after(e) {
    this._slideTabItem.after(e._slideTabItem || e);
  }
  update() {
    this._midline = _vr.midline(this);
  }
  disableFixed() {
    if (this._placeholder) {
      const e = this._slideTabBar.primeval();
      this._slideTabItem.style.removeProperty("position"), this._slideTabItem.style.removeProperty("left"), this._slideTabItem.style.removeProperty("top"), this._slideTabItem.style.removeProperty("width"), this._slideTabItem.style.removeProperty("height"), this._slideTabItem.style.removeProperty("background"), this._slideTabItem.style.removeProperty("padding"), this._slideTabItem.style.removeProperty("box-sizing"), this._slideTabItem.style.removeProperty("font-size"), this._slideTabItem.style.removeProperty("font-family"), this._slideTabItem.style.removeProperty("font-weight"), this._slideTabItem.style.removeProperty("color"), this._slideTabItem.style.removeProperty("border-radius"), this._placeholder.after(this._slideTabItem), e.removeChild(this._placeholder), this._placeholder = null;
    }
  }
  enableFixed() {
    const e = document.createElement("div"), t8 = this.getBoundingRect(), n = getComputedStyle(this._slideTabItem), i = this._slideTabItem.querySelector("span");
    if (this._placeholder = e, this._placeholder.style.width = `${t8.width}px`, this._placeholder.style.height = `${t8.height}px`, this._placeholder.style.flexShrink = "0", this._placeholder.style.margin = n.margin, this._slideTabItem.style.background = n.background, i) {
      const o = getComputedStyle(i).padding;
      this._slideTabItem.style.padding = o;
    }
    this._slideTabItem.style.boxSizing = n.boxSizing, this._slideTabItem.style.fontSize = n.fontSize, this._slideTabItem.style.fontFamily = n.fontFamily, this._slideTabItem.style.fontWeight = n.fontWeight, this._slideTabItem.style.color = n.color, this._slideTabItem.style.borderRadius = n.borderRadius, this._slideTabItem.style.left = `${t8.x - this.getScrollbar().getScrollX()}px`, this._slideTabItem.style.top = `${t8.y}px`, this._slideTabItem.style.width = `${t8.width}px`, this._slideTabItem.style.height = `${t8.height}px`, this._slideTabItem.style.position = "fixed", this._slideTabItem.after(e), document.body.appendChild(this._slideTabItem);
  }
  addEventListener(e, t8, n) {
    this._slideTabItem.addEventListener(e, t8, n);
  }
  removeEventListener(e, t8, n) {
    this._slideTabItem.removeEventListener(e, t8, n);
  }
  getScrollbar() {
    return this._scrollbar;
  }
  getMidLine() {
    return this._midline;
  }
  getBoundingRect() {
    const e = this._slideTabItem.getBoundingClientRect();
    return e.x += this._scrollbar.getScrollX(), e;
  }
  getWidth() {
    return this.getBoundingRect().width;
  }
  getTranslateXDirection() {
    const e = _vr.midline(this);
    return e > this._midline ? 1 : e < this._midline ? -1 : 0;
  }
  equals(e) {
    return e && e._slideTabItem === this._slideTabItem;
  }
  getId() {
    return this._slideTabItem.dataset.id || "";
  }
};
var h02 = class {
  constructor(e) {
    _2(this, "_slideTabBar");
    _2(this, "_scrollX");
    const t8 = e.primeval();
    this._scrollX = t8.scrollLeft, this._slideTabBar = e;
  }
  scrollX(e) {
    const t8 = this._slideTabBar.primeval();
    t8.scrollLeft = e, this._scrollX = t8.scrollLeft;
  }
  scrollRight() {
    const e = this._slideTabBar.primeval();
    e.scrollLeft = e.scrollWidth, this._scrollX = e.scrollLeft;
  }
  getScrollX() {
    return this._scrollX;
  }
};
var Jr2 = class Jr3 {
  // eslint-disable-next-line max-lines-per-function
  constructor(e) {
    _2(this, "_activeTabItemIndex", 0);
    _2(this, "_slideTabBar");
    _2(this, "_slideTabItems", []);
    _2(this, "_config");
    _2(this, "_downActionX", 0);
    _2(this, "_moveActionX", 0);
    _2(this, "_compareIndex", 0);
    _2(this, "_activeTabItem", null);
    _2(this, "_moveAction");
    _2(this, "_upAction");
    _2(this, "_downAction");
    _2(this, "_wheelAction");
    _2(this, "_scrollIncremental", 0);
    _2(this, "_compareDirection", 0);
    _2(this, "_autoScrollTime", null);
    _2(this, "_slideScrollbar");
    _2(this, "_longPressTimer", null);
    _2(this, "_leftBoundingLine", 0);
    _2(this, "_rightBoundingLine", 0);
    _2(this, "_leftMoveX", 0);
    _2(this, "_rightMoveX", 0);
    if (e.slideTabBarContainer == null)
      throw new Error("not found slide-tab-bar root element");
    const t8 = e.slideTabBarContainer.querySelector(`${e.slideTabBarSelector}`);
    if (t8 == null)
      throw new Error("not found slide-tab-bar");
    this._slideTabBar = t8, this._slideScrollbar = new h02(this), this._config = e, this._initConfig();
    let n = 0, i = 0, o = 0;
    this._downAction = (s) => {
      var I2, R, y, M7, E, T;
      if ((I2 = this._activeTabItem) != null && I2.isEditMode())
        return;
      this._longPressTimer && (clearTimeout(this._longPressTimer), this._longPressTimer = null);
      const l = (y = (R = s.target) == null ? void 0 : R.closest(`${e.slideTabBarItemSelector}`)) == null ? void 0 : y.getAttribute("data-id"), a = this._slideTabItems.findIndex((P2) => P2.getId() === l);
      if (l == null || a === -1) return;
      if (this._activeTabItemIndex !== a) {
        (M7 = this._activeTabItem) == null || M7.removeEventListener("pointermove", this._moveAction), (E = this._activeTabItem) == null || E.removeEventListener("pointerup", this._upAction), this.removeListener(), this._config.onChangeTab(s, l);
        return;
      }
      if (this._compareIndex = a, this._downActionX = s.pageX, this._moveActionX = 0, this._scrollIncremental = 0, this._activeTabItem = this._slideTabItems[a], !this._activeTabItem) {
        console.error("Not found active slide-tab-item in sheet bar");
        return;
      }
      const c = this._activeTabItem.getSlideTabItem();
      c == null || c.setPointerCapture(s.pointerId), (T = this._activeTabItem) == null || T.addEventListener("pointerup", this._upAction);
      const { x: d, width: u } = this._activeTabItem.getBoundingRect(), { x: h, width: g } = this.getBoundingRect(), m2 = this._slideScrollbar.getScrollX();
      if (this._leftBoundingLine = this._downActionX - (d - m2), this._rightBoundingLine = d - m2 + u - this._downActionX, this._leftMoveX = d - h - m2, this._rightMoveX = h + g - (d + u) + m2, s.button === 2 || this._hasEditItem())
        return;
      const { pageX: f2, pageY: v2 } = s, p = Date.now(), S = p - o <= Jr3.DoubleClickDelay, w = Math.abs(f2 - n) < 10, C = Math.abs(v2 - i) < 10;
      S && w && C && this._activeTabItem.setEditor(), n = f2, i = v2, o = p, this._longPressTimer = setTimeout(() => {
        var P2, H3, A;
        !c || (P2 = this._activeTabItem) != null && P2.isEditMode() || ((H3 = this._activeTabItem) == null || H3.enableFixed(), this._startAutoScroll(), c.setPointerCapture(s.pointerId), c.style.cursor = "move", (A = this._activeTabItem) == null || A.addEventListener("pointermove", this._moveAction));
      }, Jr3.LongPressDelay);
    }, this._upAction = (s) => {
      var c, d, u, h;
      if ((c = this._activeTabItem) != null && c.isEditMode() || (this._longPressTimer && (clearTimeout(this._longPressTimer), this._longPressTimer = null), !this._activeTabItem)) return;
      const l = this._autoScrollTime !== null;
      this._closeAutoScroll(), this._activeTabItem.disableFixed(), this.updateItems();
      const a = (d = this._activeTabItem) == null ? void 0 : d.getSlideTabItem();
      a && (a.style.cursor = "", a.releasePointerCapture(s.pointerId), (u = this._activeTabItem) == null || u.removeEventListener("pointermove", this._moveAction), (h = this._activeTabItem) == null || h.removeEventListener("pointerup", this._upAction), this._config.onSlideEnd && this._activeTabItemIndex !== this._compareIndex && l && (this.removeListener(), this._config.onSlideEnd(s, this._compareIndex || 0)), this._scrollIncremental = 0, this._downActionX = 0, this._moveActionX = 0, this._compareIndex = 0);
    }, this._moveAction = (s) => {
      this._activeTabItem && (this._moveActionX = s.pageX - this._downActionX, this._moveActionX <= -this._leftMoveX ? this._moveActionX = -this._leftMoveX : this._moveActionX >= this._rightMoveX && (this._moveActionX = this._rightMoveX), this._scrollIncremental = 0, this._scrollLeft(s), this._scrollRight(s));
    }, this._wheelAction = (s) => {
      this.setScroll(s.deltaY);
    }, this.addListener();
  }
  static checkedSkipSlide(e) {
    let t8 = e.target;
    for (; t8 != null && t8 !== document.body; ) {
      if (t8.getAttribute("data-slide-skip"))
        return true;
      t8 = t8.parentElement;
    }
    return false;
  }
  static keepLastIndex(e) {
    setTimeout(() => {
      const t8 = window.getSelection();
      t8 && (t8.selectAllChildren(e), t8.collapseToEnd());
    });
  }
  static keepSelectAll(e) {
    setTimeout(() => {
      const t8 = window.getSelection();
      if (!t8) return;
      const n = document.createRange();
      n.selectNodeContents(e), t8.removeAllRanges(), t8.addRange(n);
    });
  }
  /**
   * The current instance is persistent, but some parameters need to be updated after refreshing
   * @param currentIndex
   */
  update(e) {
    this._config.currentIndex = e, this._initConfig(), this.removeListener(), this.addListener(), this.scrollToItem(e);
  }
  primeval() {
    return this._slideTabBar;
  }
  updateItems() {
    for (let e = 0; e < this._slideTabItems.length; e++)
      this._slideTabItems[e].animate().cancel(), this._slideTabItems[e].translateX(0), this._slideTabItems[e].update();
  }
  getScrollbar() {
    return this._slideScrollbar;
  }
  getConfig() {
    return this._config;
  }
  getBoundingRect() {
    return this._slideTabBar.getBoundingClientRect();
  }
  getSlideTabItems() {
    return this._slideTabItems;
  }
  getActiveItem() {
    return this._activeTabItem;
  }
  isLeftEnd() {
    return this._slideTabBar.scrollLeft === 0;
  }
  isRightEnd() {
    const e = this._slideTabBar.parentElement;
    return e ? this._slideTabBar.scrollWidth - e.clientWidth === this._slideTabBar.scrollLeft : false;
  }
  addListener() {
    this._slideTabBar.addEventListener("wheel", this._wheelAction), this._slideTabItems.forEach((e) => {
      e.addEventListener("pointerdown", this._downAction);
    });
  }
  removeListener() {
    this._slideTabBar.removeEventListener("wheel", this._wheelAction), this._slideTabItems.forEach((e) => {
      e.removeEventListener("pointerdown", this._downAction);
    });
  }
  setScroll(e) {
    if (this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX() + e), e > 0) {
      const t8 = this.calculateLeftScrollX();
      this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX() + t8);
    } else if (e < 0) {
      const t8 = this.calculateRightScrollX();
      this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX() + t8);
    }
    this._config.onScroll({
      leftEnd: this.isLeftEnd(),
      rightEnd: this.isRightEnd()
    });
  }
  flipPage(e) {
    if (e > 0) {
      const t8 = this.calculateLeftScrollX(true);
      this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX() + t8);
    } else if (e < 0) {
      const t8 = this.calculateRightScrollX(true);
      this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX() + t8);
    }
    this._config.onScroll({
      leftEnd: this.isLeftEnd(),
      rightEnd: this.isRightEnd()
    });
  }
  scrollToItem(e) {
    if (e = e != null ? e : this._config.currentIndex, e < 0 || e >= this._slideTabItems.length) {
      console.error("Index out of bounds");
      return;
    }
    const t8 = this.calculateTabItemScrollX(e);
    this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX() + t8), this._config.onScroll({
      leftEnd: this.isLeftEnd(),
      rightEnd: this.isRightEnd()
    });
  }
  calculateLeftScrollX(e) {
    let t8 = 0;
    const n = 4;
    return this._slideTabItems.some((i) => {
      const o = this._slideTabBar.getBoundingClientRect(), s = o.left + o.width, l = i.getSlideTabItem().getBoundingClientRect(), a = l.left, c = l.width;
      return a < s && a + c + n * 2 > s ? (t8 = e ? a - o.left - n : a + c - s + n, true) : false;
    }), t8;
  }
  calculateRightScrollX(e) {
    let t8 = 0;
    const n = 4;
    return this._slideTabItems.some((i) => {
      const o = this._slideTabBar.getBoundingClientRect(), s = o.left, l = i.getSlideTabItem().getBoundingClientRect(), a = l.left, c = l.width;
      return a - n * 2 < s && a + c > s ? (t8 = e ? a + c - o.left - o.width + n : a - s - n, true) : false;
    }), t8;
  }
  calculateTabItemScrollX(e) {
    let t8 = 0;
    const n = 4, i = this._slideTabBar.getBoundingClientRect(), o = i.left, s = i.left + i.width, l = this._slideTabItems[e].getSlideTabItem().getBoundingClientRect(), a = l.left, c = l.width;
    return a - n * 2 < o && (t8 = a - o - n), a + c + n * 2 > s && (t8 = a + c - s + n), t8;
  }
  calculateActiveTabItemScrollX() {
    var c;
    let e = 0;
    const t8 = 4, n = this._slideTabBar.getBoundingClientRect(), i = n.left, o = n.left + n.width, s = (c = this._activeTabItem) == null ? void 0 : c.getSlideTabItem().getBoundingClientRect();
    if (!s) return 0;
    const l = s.left, a = s.width;
    return l - t8 * 2 < i && l + a > i && (e = l - i - t8), l < o && l + a + t8 * 2 > o && (e = l + a - o + t8), e;
  }
  destroy() {
    this.removeListener(), this._downActionX = 0, this._moveActionX = 0, this._compareDirection = 0, this._compareIndex = 0, this._slideTabItems = [], this._activeTabItem = null;
  }
  _hasEditItem() {
    for (let e = 0; e < this._slideTabItems.length; e++)
      if (this._slideTabItems[e].isEditMode())
        return true;
    return false;
  }
  _autoScrollFrame() {
    if (this._activeTabItem)
      switch (this._compareDirection = this._activeTabItem.translateX(this._moveActionX), this._compareDirection) {
        case 1: {
          this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX() + this._scrollIncremental), this._compareRight();
          break;
        }
        case 0: {
          this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX() + this._scrollIncremental), this._compareIndex = this._activeTabItemIndex;
          break;
        }
        case -1: {
          this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX() + this._scrollIncremental), this._compareLeft();
          break;
        }
      }
    this._autoScrollTime = requestAnimationFrame(() => {
      this._autoScrollFrame();
    });
  }
  _startAutoScroll() {
    this._autoScrollTime == null && this._autoScrollFrame();
  }
  _closeAutoScroll() {
    this._autoScrollTime && cancelAnimationFrame(this._autoScrollTime), this._autoScrollTime = null;
  }
  _scrollLeft(e) {
    const t8 = this.getBoundingRect(), n = e.pageX - t8.x;
    n < this._leftBoundingLine && (this._scrollIncremental = -Math.min(Math.abs(n - this._leftBoundingLine) * 0.1, 50));
  }
  _scrollRight(e) {
    const t8 = this.getBoundingRect(), n = e.pageX - t8.x;
    n > t8.width - this._rightBoundingLine && (this._scrollIncremental = Math.min(Math.abs(n - (t8.width - this._rightBoundingLine)) * 0.1, 50));
  }
  _sortedItems() {
    if (this._activeTabItem != null && this._activeTabItemIndex != null && this._compareIndex != null && (this._slideTabItems.splice(this._activeTabItemIndex, 1), this._slideTabItems.splice(this._compareIndex, 0, this._activeTabItem), this._config.slideTabBarItemAutoSort))
      for (let e = 0; e < this._slideTabItems.length; e++) {
        const t8 = this._slideTabItems[e], n = this._slideTabItems[e + 1];
        n && t8.after(n);
      }
  }
  _compareLeft() {
    if (this._activeTabItem && this._activeTabItemIndex) {
      const e = this._slideTabItems.findIndex((o) => o.equals(this._activeTabItem)), t8 = this._slideTabItems.length, n = [];
      for (let o = 0; o < e && !(o >= e); o++)
        n.push(this._slideTabItems[o]);
      for (let o = e + 1; o < t8; o++)
        this._slideTabItems[o].animate().translateX(0);
      let i = true;
      for (let o = n.length - 1; o >= 0; o--) {
        const s = n[o];
        vr5.leftLine(this._activeTabItem) < s.getMidLine() ? (s.animate().translateX(this._activeTabItem.getWidth()), this._compareIndex = o, i = false) : (s.animate().translateX(0), i && (this._compareIndex = this._activeTabItemIndex));
      }
    }
  }
  _compareRight() {
    if (this._activeTabItem) {
      const e = this._slideTabItems.findIndex((o) => o.equals(this._activeTabItem)), t8 = this._slideTabItems.length, n = [];
      for (let o = e + 1; o < t8; o++)
        n.push(this._slideTabItems[o]);
      for (let o = 0; o < e; o++)
        this._slideTabItems[o].animate().translateX(0);
      let i = true;
      for (let o = 0; o < n.length; o++) {
        const s = n[o];
        vr5.rightLine(this._activeTabItem) > s.getMidLine() ? (s.animate().translateX(-this._activeTabItem.getWidth()), this._compareIndex = e + o + 1, i = false) : (s.animate().translateX(0), i && (this._compareIndex = this._activeTabItemIndex));
      }
    }
  }
  _initConfig() {
    const e = this._slideTabBar.querySelectorAll(`${this._config.slideTabBarItemSelector}`);
    this._downActionX = 0, this._moveActionX = 0, this._compareDirection = 0, this._compareIndex = 0, this._slideTabItems = vr5.make(e, this), this._activeTabItemIndex = this._config.currentIndex, this._activeTabItem = this._slideTabItems[this._activeTabItemIndex];
  }
};
_2(Jr2, "LongPressDelay", 500), // in milliseconds
/** Time in milliseconds with two consecutive clicks will be considered as a double click */
_2(Jr2, "DoubleClickDelay", 300);
var ai4 = Jr2;
function g02() {
  var Ne3;
  const [r, e] = (0, import_react4.useState)([]), [t8, n] = (0, import_react4.useState)(""), [i, o] = (0, import_react4.useState)(""), [s, l] = (0, import_react4.useState)(false), [a, c] = (0, import_react4.useState)([0, 0]), d = (0, import_react4.useRef)({ slideTabBar: null }), u = (0, import_react4.useRef)(null), h = useDependency(Ls), g = useDependency(Nr3), m2 = useDependency(Fn), f2 = useDependency(at), v2 = useDependency(qe5, Quantity.OPTIONAL), p = useDependency(lt), S = useDependency(me), w = useObservable(p.resetOrder$), C = kr(), I2 = useDependency(eC), R = (0, import_react4.useCallback)(() => {
    var Ue3;
    const Z7 = ((Ue3 = C.getActiveSheet()) == null ? void 0 : Ue3.getSheetId()) || "";
    n(Z7);
    const ee3 = C.getSheets(), ne2 = C.getActiveSheet(), pe2 = ee3.filter((me3) => !me3.isSheetHidden()).map((me3, _e4) => {
      var wt3;
      const le2 = p.getRule(C.getUnitId(), me3.getSheetId()), it2 = S.getSubunitRuleList(C.getUnitId(), me3.getSheetId()).length > 0, vt3 = (le2 == null ? void 0 : le2.permissionId) || it2 ? (0, import_jsx_runtime4.jsxs)(import_jsx_runtime4.Fragment, { children: [
        (0, import_jsx_runtime4.jsx)(iu2, {}),
        (0, import_jsx_runtime4.jsx)("span", { className: "univer-outline-none", children: me3.getName() })
      ] }) : (0, import_jsx_runtime4.jsx)("span", { className: "univer-outline-none", children: me3.getName() });
      return {
        sheetId: me3.getSheetId(),
        label: vt3,
        index: _e4,
        selected: ne2 === me3,
        color: (wt3 = me3.getTabColor()) != null ? wt3 : void 0
      };
    });
    e(pe2), n(Z7);
  }, [S, C, p]);
  (0, import_react4.useEffect)(() => {
    R();
    const { slideTabBar: Z7, disconnectResizeObserver: ee3 } = y(), ne2 = D2(), pe2 = [
      X2(),
      B(),
      j()
      // When adding a sheet, it no longer slides, which has been uniformly handled in setupSlideTabBarUpdate
    ];
    return () => {
      ne2.dispose(), Z7.destroy(), pe2.forEach((Ue3) => Ue3.unsubscribe()), ee3 && ee3();
    };
  }, [w, C]), (0, import_react4.useEffect)(() => {
    r.length > 0 && V2();
  }, [r]), (0, import_react4.useEffect)(() => {
    const Z7 = merge(
      p.ruleChange$,
      S.ruleChange$
    ).subscribe(() => {
      R();
    });
    return () => {
      Z7.unsubscribe();
    };
  }, [p, R]);
  const y = () => {
    const Z7 = new ai4({
      slideTabBarSelector: "[data-u-comp=slide-tab-bar]",
      slideTabBarItemSelector: "[data-u-comp=slide-tab-item]",
      slideTabBarItemAutoSort: true,
      slideTabBarContainer: u.current,
      currentIndex: 0,
      onChangeName: (ne2, pe2) => {
        h.executeCommand(Qs.id, {
          subUnitId: ne2,
          name: pe2
        });
      },
      onSlideEnd: async (ne2, pe2) => {
        await h.executeCommand(ai.id, { order: pe2 });
      },
      onChangeTab: (ne2, pe2) => {
        h.executeCommand(pn2.id, {
          subUnitId: pe2,
          unitId: C.getUnitId()
        }).then(() => {
          ne2.button === 2 && be2(true);
        });
      },
      onScroll: (ne2) => {
        g.setScroll(ne2);
      },
      onNameCheckAlert: (ne2) => T(ne2) || P2(ne2) || H3(ne2),
      onNameChangeCheck: () => {
        var le2, it2, ot4, vt3;
        const ne2 = C.getUnitId(), pe2 = C == null ? void 0 : C.getActiveSheet();
        if (!pe2)
          throw new Error("No active sheet found");
        const Ue3 = pe2.getSheetId(), me3 = p.getRule(ne2, Ue3), _e4 = S.getSubunitRuleList(ne2, Ue3).length > 0;
        return me3 || _e4 ? (it2 = (le2 = I2.getPermissionPoint(new Bs(ne2).id)) == null ? void 0 : le2.value) != null ? it2 : false : (vt3 = (ot4 = I2.getPermissionPoint(new zs(ne2).id)) == null ? void 0 : ot4.value) != null ? vt3 : false;
      }
    });
    d.current.slideTabBar = Z7;
    const ee3 = Re3(Z7);
    return { slideTabBar: Z7, disconnectResizeObserver: ee3 };
  }, M7 = p5(_e2), E = (Ne3 = M7 == null ? void 0 : M7.contextMenu) != null ? Ne3 : true, T = (Z7) => {
    if (Z7.trim() === "") {
      const ee3 = "sheetNameEmptyAlert";
      return f2.open({
        id: ee3,
        title: { title: m2.t("sheetConfig.sheetNameErrorTitle") },
        children: { title: m2.t("sheetConfig.sheetNameCannotIsEmptyError") },
        cancelText: m2.t("button.cancel"),
        confirmText: m2.t("button.confirm"),
        onClose() {
          A(), f2.close(ee3);
        },
        onConfirm() {
          A(), f2.close(ee3);
        }
      }), true;
    }
    return false;
  }, P2 = (Z7) => {
    if (!ZR(Z7)) {
      const ee3 = "sheetNameSpecCharAlert";
      return f2.open({
        id: ee3,
        title: { title: m2.t("sheetConfig.sheetNameErrorTitle") },
        children: { title: m2.t("sheetConfig.sheetNameSpecCharError") },
        cancelText: m2.t("button.cancel"),
        confirmText: m2.t("button.confirm"),
        onClose() {
          A(), f2.close(ee3);
        },
        onConfirm() {
          A(), f2.close(ee3);
        }
      }), true;
    }
    return false;
  }, H3 = (Z7) => {
    const ee3 = C.getActiveSheet();
    if ((ee3 == null ? void 0 : ee3.getName()) === Z7) return false;
    const pe2 = C.checkSheetName(Z7);
    if (pe2) {
      const Ue3 = "sheetNameRepeatAlert";
      f2.open({
        id: Ue3,
        title: { title: m2.t("sheetConfig.sheetNameErrorTitle") },
        children: { title: m2.t("sheetConfig.sheetNameAlreadyExistsError") },
        cancelText: m2.t("button.cancel"),
        confirmText: m2.t("button.confirm"),
        onClose() {
          f2.close(Ue3), A();
        },
        onConfirm() {
          f2.close(Ue3), A();
        }
      });
    }
    return pe2;
  }, A = () => {
    setTimeout(() => {
      var ee3;
      const Z7 = (ee3 = d.current.slideTabBar) == null ? void 0 : ee3.getActiveItem();
      Z7 && (Z7.focus(), Z7.selectAll());
    }, 0);
  }, x7 = () => {
    var Z7, ee3;
    (ee3 = (Z7 = d.current.slideTabBar) == null ? void 0 : Z7.getActiveItem()) == null || ee3.setEditor();
  }, V2 = () => {
    var ee3;
    const Z7 = r.findIndex((ne2) => ne2.selected);
    (ee3 = d.current.slideTabBar) == null || ee3.update(Z7);
  }, D2 = () => h.onCommandExecuted((Z7) => {
    switch (Z7.id) {
      case kn.id:
      case wt.id:
      case Ht.id:
      case jn.id:
      case hn.id:
      case Tn2.id:
      case pn2.id:
        R();
        break;
    }
  }), X2 = () => g.scroll$.subscribe((Z7) => {
    G7(Z7);
  }), B = () => g.scrollX$.subscribe((Z7) => {
    var ee3;
    (ee3 = d.current.slideTabBar) == null || ee3.flipPage(Z7);
  }), j = () => g.renameId$.subscribe(() => {
    x7();
  }), G7 = (Z7) => {
    const { leftEnd: ee3, rightEnd: ne2 } = Z7;
    let pe2 = "";
    ee3 && ne2 ? pe2 = "" : ee3 && !ne2 ? pe2 = "inset -10px 0px 10px -10px rgba(0, 0, 0, 0.2)" : !ee3 && ne2 ? pe2 = "inset 10px 0px 10px -10px rgba(0, 0, 0, 0.2)" : !ee3 && !ne2 && (pe2 = "inset 10px 0px 10px -10px rgba(0, 0, 0, 0.2), inset -10px 0px 10px -10px rgba(0, 0, 0, 0.2)"), o(pe2);
  }, ge2 = (Z7) => {
    const ee3 = Z7.calculateActiveTabItemScrollX();
    if (ee3) {
      const ne2 = Z7.getScrollbar();
      ne2.scrollX(ne2.getScrollX() + ee3);
    }
    g.setScroll({
      leftEnd: Z7.isLeftEnd(),
      rightEnd: Z7.isRightEnd()
    });
  }, Re3 = (Z7) => {
    var pe2;
    const ee3 = (pe2 = u.current) == null ? void 0 : pe2.querySelector("[data-u-comp=slide-tab-bar]");
    if (!ee3) return;
    const ne2 = new ResizeObserver(() => {
      ge2(Z7);
    });
    return ne2.observe(ee3), () => ne2.disconnect();
  }, be2 = (Z7) => {
    var ee3, ne2, pe2, Ue3, me3;
    if (E && !(v2 != null && v2.isForceKeepVisible())) {
      if (Z7) {
        const { left: _e4 } = (ne2 = (ee3 = u.current) == null ? void 0 : ee3.getBoundingClientRect()) != null ? ne2 : {}, { left: le2 } = (me3 = (Ue3 = (pe2 = d.current.slideTabBar) == null ? void 0 : pe2.getActiveItem()) == null ? void 0 : Ue3.getSlideTabItem().getBoundingClientRect()) != null ? me3 : {};
        _e4 !== void 0 && le2 !== void 0 && c([le2 - _e4, 0]);
      }
      l(Z7);
    }
  };
  return (0, import_jsx_runtime4.jsx)(
    mE2,
    {
      className: "univer-select-none",
      visible: s,
      align: { offset: a },
      trigger: ["contextMenu"],
      overlay: (0, import_jsx_runtime4.jsx)(
        E5,
        {
          menuType: Y1.FOOTER_TABS,
          onOptionSelect: (Z7) => {
            const { label: ee3, value: ne2, commandId: pe2 } = Z7;
            h.executeCommand(pe2 != null ? pe2 : ee3, { value: ne2, subUnitId: t8 }), l(false);
          }
        }
      ),
      onVisibleChange: be2,
      children: (0, import_jsx_runtime4.jsx)(
        "div",
        {
          className: "univer-max-w-[calc(100%-112px)] univer-overflow-hidden",
          ref: u,
          onDragStart: (Z7) => Z7.preventDefault(),
          onContextMenu: (Z7) => Z7.preventDefault(),
          children: (0, import_jsx_runtime4.jsx)(
            "div",
            {
              "data-u-comp": "slide-tab-bar",
              className: "univer-flex univer-select-none univer-flex-row univer-items-center univer-overflow-hidden univer-px-1.5 univer-py-1",
              style: { boxShadow: i },
              children: r.map((Z7) => (0, import_react4.createElement)(a03, { ...Z7, key: Z7.sheetId, selected: t8 === Z7.sheetId }))
            }
          )
        }
      )
    }
  );
}
var mh3 = 100;
var m02 = () => {
  var f2, v2;
  const [r, e] = (0, import_react4.useState)(true), [t8, n] = (0, import_react4.useState)(true), i = useDependency(Ls), o = useDependency(Nr3), s = useDependency(eC), a = kr().getUnitId(), c = useObservable(s.getPermissionPoint$((f2 = new Pe(a)) == null ? void 0 : f2.id)), d = useObservable(s.getPermissionPoint$((v2 = new rr(a)) == null ? void 0 : v2.id)), u = (p) => {
    const { leftEnd: S, rightEnd: w } = p;
    e(S), n(w);
  };
  (0, import_react4.useEffect)(() => {
    const p = o.scroll$.subscribe(XC((S) => {
      u(S);
    }, 100));
    return () => {
      p.unsubscribe();
    };
  }, []);
  const h = () => {
    i.executeCommand(Rc.id), setTimeout(() => {
      o.setAddSheet(0);
    }, 0);
  }, g = () => {
    o.setScrollX(-mh3);
  }, m2 = () => {
    o.setScrollX(mh3);
  };
  return (0, import_jsx_runtime4.jsxs)("div", { className: "univer-relative univer-flex univer-h-full univer-min-w-0 univer-flex-1", children: [
    (0, import_jsx_runtime4.jsxs)("div", { className: "univer-flex univer-items-center", children: [
      (0, import_jsx_runtime4.jsx)(
        As2,
        {
          className: "univer-mr-2",
          onClick: h,
          disabled: !(d != null && d.value && (c != null && c.value)),
          children: (0, import_jsx_runtime4.jsx)(ru2, {})
        }
      ),
      (0, import_jsx_runtime4.jsx)(l02, {})
    ] }),
    (0, import_jsx_runtime4.jsx)(g02, {}),
    (!r || !t8) && (0, import_jsx_runtime4.jsxs)(
      "div",
      {
        className: 'univer-relative univer-flex univer-items-center univer-px-2 after:univer-absolute after:univer-right-0 after:univer-top-1/2 after:univer-h-4 after:univer-w-px after:-univer-translate-y-1/2 after:univer-bg-gray-200 after:univer-content-[""]',
        children: [
          (0, import_jsx_runtime4.jsx)(As2, { disabled: r, onClick: g, children: (0, import_jsx_runtime4.jsx)(jc2, { className: "univer-rotate-180" }) }),
          (0, import_jsx_runtime4.jsx)(As2, { disabled: t8, onClick: m2, children: (0, import_jsx_runtime4.jsx)(jc2, {}) })
        ]
      }
    )
  ] });
};
var f02 = [50, 75, 100, 125, 150, 175, 200, 400];
function p02() {
  const r = useDependency(Ls), e = useDependency(vr), t8 = kr(), n = useDependency(qe5), i = useObservable(n.visible$), o = (0, import_react4.useCallback)(() => {
    if (!t8) return 100;
    const d = t8.getActiveSheet(), u = d && d.getZoomRatio() * 100 || 100;
    return Math.round(u);
  }, [t8]), [s, l] = (0, import_react4.useState)(() => o());
  (0, import_react4.useEffect)(() => (l(o()), r.onCommandExecuted((u) => {
    if (u.id === Jt3.id || u.id === pn2.id) {
      const h = o();
      l(h);
    }
  }).dispose), [r, o]);
  function a(d) {
    l(d);
    const u = e.getCurrentUnitForType(we.UNIVER_SHEET), h = u == null ? void 0 : u.getActiveSheet();
    if (h == null)
      return;
    const g = d / 100;
    r.executeCommand(ss3.id, {
      unitId: u.getUnitId(),
      subUnitId: h.getSheetId(),
      zoomRatio: g
    });
  }
  const c = (i == null ? void 0 : i.visible) && (i.unitId === (t8 == null ? void 0 : t8.getUnitId()) || i.unitId === Ul);
  return (0, import_jsx_runtime4.jsx)(
    Fi,
    {
      disabled: c,
      min: Lc[0],
      value: s,
      shortcuts: f02,
      onChange: a
    }
  );
}
function v02() {
  return (0, import_jsx_runtime4.jsx)("section", { className: "univer-flex univer-flex-shrink-0 univer-justify-end", children: (0, import_jsx_runtime4.jsx)(p02, {}) });
}
var nf2 = class {
  constructor() {
    _2(this, "_functions", [
      {
        func: v.MAX,
        filter: (e) => {
          var t8, n, i, o;
          return ((n = (t8 = e.values.find((s) => s.func === v.COUNTA)) == null ? void 0 : t8.value) != null ? n : 0) > 1 && ((o = (i = e.values.find((s) => s.func === v.COUNT)) == null ? void 0 : i.value) != null ? o : 0) > 0;
        }
      },
      {
        func: v.MIN,
        filter: (e) => {
          var t8, n, i, o;
          return ((n = (t8 = e.values.find((s) => s.func === v.COUNTA)) == null ? void 0 : t8.value) != null ? n : 0) > 1 && ((o = (i = e.values.find((s) => s.func === v.COUNT)) == null ? void 0 : i.value) != null ? o : 0) > 0;
        }
      },
      {
        func: Y.SUM,
        filter: (e) => {
          var t8, n, i, o;
          return ((n = (t8 = e.values.find((s) => s.func === v.COUNTA)) == null ? void 0 : t8.value) != null ? n : 0) > 1 && ((o = (i = e.values.find((s) => s.func === v.COUNT)) == null ? void 0 : i.value) != null ? o : 0) > 0;
        }
      },
      {
        func: v.COUNTA,
        filter: (e) => {
          var t8, n;
          return ((n = (t8 = e.values.find((i) => i.func === v.COUNTA)) == null ? void 0 : t8.value) != null ? n : 0) > 1;
        }
      },
      {
        func: v.COUNT,
        filter: (e) => {
          var t8, n, i, o;
          return ((n = (t8 = e.values.find((s) => s.func === v.COUNTA)) == null ? void 0 : t8.value) != null ? n : 0) > 1 && ((o = (i = e.values.find((s) => s.func === v.COUNT)) == null ? void 0 : i.value) != null ? o : 0) > 0;
        }
      },
      {
        func: v.AVERAGE,
        filter: (e) => {
          var t8, n, i, o;
          return ((n = (t8 = e.values.find((s) => s.func === v.COUNTA)) == null ? void 0 : t8.value) != null ? n : 0) > 1 && ((o = (i = e.values.find((s) => s.func === v.COUNT)) == null ? void 0 : i.value) != null ? o : 0) > 0;
        }
      }
    ]);
    _2(this, "_state$", new BehaviorSubject(null));
    _2(this, "state$", this._state$.asObservable());
  }
  dispose() {
    this._state$.complete();
  }
  setState(e) {
    var n;
    const t8 = {
      values: [],
      pattern: null
    };
    e == null || e.values.forEach((i) => {
      const o = this._functions.find((s) => s.func === i.func);
      o && (o.filter === void 0 || o.filter(e)) && t8.values.push(i);
    }), t8.pattern = (n = e == null ? void 0 : e.pattern) != null ? n : null, this._state$.next(t8);
  }
  getState() {
    return this._state$.getValue();
  }
  getFunctions() {
    return this._functions;
  }
  addFunctions(e) {
    this._functions.push(...e);
  }
};
var xa2 = createIdentifier("univer.sheet-status-bar.service");
var S02 = [
  Y.SUM,
  v.AVERAGE,
  v.MIN,
  v.MAX
];
var Ua3 = {
  [Y.SUM]: "statusbar.sum",
  [v.AVERAGE]: "statusbar.average",
  [v.MIN]: "statusbar.min",
  [v.MAX]: "statusbar.max",
  [v.COUNT]: "statusbar.count",
  [v.COUNTA]: "statusbar.countA",
  [se.CONCATENATE]: "concatenate"
};
var C02 = (r) => {
  const e = useDependency(Fn), t8 = useDependency(et2), n = useDependency(lr), i = w02(r), o = async () => {
    await n.writeText(r.value.toString()), t8.show({
      type: $C.Success,
      content: e.t("statusbar.copied")
    });
  };
  return (0, import_jsx_runtime4.jsx)(Rp, { title: e.t("statusbar.clickToCopy"), placement: "top", children: (0, import_jsx_runtime4.jsx)(
    "div",
    {
      className: "univer-flex univer-cursor-pointer univer-truncate univer-text-center univer-text-xs univer-text-gray-400",
      onClick: o,
      children: (0, import_jsx_runtime4.jsx)("span", { children: `${e.t(
        (Ua3 == null ? void 0 : Ua3[r.name]) || r.name
      )}: ${i}` })
    },
    r.name
  ) });
};
function w02(r) {
  const { pattern: e, value: t8 } = r;
  return typeof t8 != "number" ? 0 : t8 >= 1e8 ? t8.toExponential(2) : e && S02.includes(r.name) ? eR.format(e, t8, { throws: false }) : t8.toLocaleString();
}
var fh3 = 800;
var b02 = 3;
var _02 = () => {
  var u, h;
  const r = (h = (u = p5(Tt3)) == null ? void 0 : u.statusBarStatistic) != null ? h : true, [e, t8] = (0, import_react4.useState)(window.innerWidth < fh3), n = useDependency(xa2), i = n.getFunctions().map((g, m2) => ({
    name: g.func,
    value: 0,
    show: true,
    disable: false,
    pattern: null
  })), o = (g, m2, f2, v2) => {
    const [p, S] = (0, import_react4.useState)(g), [w, C] = (0, import_react4.useState)(true), I2 = (0, import_react4.useMemo)(() => p.filter((E) => E.show && !E.disable), [p]), R = (0, import_react4.useMemo)(() => I2.find((E) => E.show && !E.disable), [I2]), y = (0, import_react4.useMemo)(() => f2 && R ? [R] : I2, [f2, R, I2]), M7 = (0, import_react4.useCallback)((E) => {
      const T = E == null ? void 0 : E.values;
      if (!(T != null && T.length)) {
        C(false);
        return;
      }
      C(true), S(
        (P2) => P2.map((H3) => {
          var A, x7, V2;
          return {
            ...H3,
            value: (x7 = (A = T.find((D2) => D2.func === H3.name)) == null ? void 0 : A.value) != null ? x7 : H3.value,
            disable: !T.some((D2) => D2.func === H3.name),
            pattern: (V2 = E == null ? void 0 : E.pattern) != null ? V2 : null
          };
        })
      );
    }, []);
    return (0, import_react4.useEffect)(() => {
      if (!v2) return;
      const E = m2.state$.subscribe(M7);
      return () => E.unsubscribe();
    }, [v2, m2, M7]), {
      statistics: p,
      showList: y,
      show: w
    };
  }, { showList: s, show: l } = o(
    i,
    n,
    e,
    r
  ), a = n1(() => {
    const g = window.innerWidth < fh3;
    e !== g && t8(g);
  }, 100);
  (0, import_react4.useEffect)(() => (window.addEventListener("resize", a), () => {
    window.removeEventListener("resize", a);
  }), [e]);
  const d = ((g, m2, f2) => r ? (0, import_react4.useMemo)(() => g.length > m2 ? g.reduce((S, w, C) => (C % 2 === 0 && S.push(g.slice(C, C + 2)), S), []).map((S, w) => (0, import_jsx_runtime4.jsxs)("div", { className: "univer-grid univer-h-full univer-items-center", children: [
    S[0] && (0, import_jsx_runtime4.jsx)(
      f2,
      {
        ...S[0]
      },
      S[0].name
    ),
    S[1] && (0, import_jsx_runtime4.jsx)(
      f2,
      {
        ...S[1]
      },
      S[1].name
    )
  ] }, `stat-col-${w}`)) : g.map((p) => (0, import_jsx_runtime4.jsx)("div", { className: "univer-grid univer-h-full univer-items-center", children: (0, import_jsx_runtime4.jsx)(f2, { ...p }) }, p.name)), [g, m2, f2]) : null)(s, b02, C02);
  return l && (0, import_jsx_runtime4.jsx)(
    "div",
    {
      className: ie2('univer-relative univer-box-border univer-flex univer-h-full univer-items-center univer-overflow-hidden univer-px-2 after:univer-absolute after:univer-right-0 after:univer-top-1/2 after:univer-block after:univer-h-4 after:univer-w-px after:-univer-translate-y-1/2 after:univer-bg-gray-200 after:univer-content-[""]', {
        "univer-max-w-32": e,
        "univer-max-w-fit": !e
      }),
      children: (0, import_jsx_runtime4.jsx)("div", { className: "univer-flex univer-h-full univer-gap-x-2", children: d })
    }
  );
};
var rf2 = 36;
function R02() {
  var c;
  const r = p5(Tt3), e = useDependency(B12), t8 = (c = r == null ? void 0 : r.footer) != null ? c : true;
  if (!kr() || !t8) return null;
  const i = e.getMenuByPositionKey(Y1.FOOTER_MENU), { sheetBar: o = true, statisticBar: s = true, menus: l = true, zoomSlider: a = true } = (r == null ? void 0 : r.footer) || {};
  return !o && !s && !l && !a ? null : (0, import_jsx_runtime4.jsxs)(
    "section",
    {
      className: "univer-box-border univer-grid univer-w-full univer-grid-flow-col univer-grid-cols-[1fr,auto,auto,auto] univer-items-center univer-justify-between univer-bg-white univer-px-5 univer-text-gray-900 dark:!univer-bg-gray-900 dark:!univer-text-gray-200",
      style: {
        height: rf2
      },
      "data-range-selector": true,
      children: [
        o && (0, import_jsx_runtime4.jsx)(m02, {}),
        s && (0, import_jsx_runtime4.jsx)(_02, {}),
        l && i.length > 0 && (0, import_jsx_runtime4.jsx)("div", { className: "univer-box-border univer-flex univer-gap-2 univer-px-2", children: i.map((d) => {
          var u;
          return (u = d.children) == null ? void 0 : u.map((h) => (h == null ? void 0 : h.item) && (0, import_jsx_runtime4.jsx)(
            Oe,
            {
              ...h.item
            },
            h.key
          ));
        }) }),
        a && (0, import_jsx_runtime4.jsx)(v02, {})
      ]
    }
  );
}
function I02() {
  const r = p5(Tt3);
  return sf2() && (r == null ? void 0 : r.formulaBar) !== false ? (0, import_jsx_runtime4.jsx)(s02, {}) : null;
}
function of3() {
  return sf2() ? (0, import_jsx_runtime4.jsxs)(import_jsx_runtime4.Fragment, { children: [
    (0, import_jsx_runtime4.jsx)(r03, {}),
    (0, import_jsx_runtime4.jsx)(n02, {})
  ] }) : null;
}
function sf2() {
  const r = useDependency(vr), t8 = !!useObservable(() => r.getCurrentTypeOfUnit$(we.UNIVER_SHEET), null, false, []);
  return (0, import_react4.useMemo)(
    () => r.getAllUnitsForType(we.UNIVER_SHEET).length > 0,
    [r, t8]
  );
}
var y03 = Object.getOwnPropertyDescriptor;
var M02 = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? y03(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var Xr3 = (r, e) => (t8, n) => e(t8, n, r);
var ph3 = 5;
var vh3 = 2;
var Ao3 = class extends Ve {
  constructor(r, e, t8, n, i, o) {
    super(), this._layoutService = r, this._cellEditorManagerService = e, this._editorBridgeService = t8, this._renderManagerService = n, this._univerInstanceService = i, this._configService = o;
  }
  get _currentRenderer() {
    return IE(we.UNIVER_SHEET, this._univerInstanceService, this._renderManagerService);
  }
  get _editingUnitId() {
    var r, e;
    return (e = (r = this._editorBridgeService.getEditCellState()) == null ? void 0 : r.unitId) != null ? e : "";
  }
  get _editingRenderer() {
    return this._renderManagerService.getRenderById(this._editingUnitId);
  }
  get _renderer() {
    var e;
    const r = (e = this._univerInstanceService.getCurrentUnitOfType(we.UNIVER_SHEET)) == null ? void 0 : e.getUnitId();
    return this._editingUnitId === r ? this._editingRenderer : this._currentRenderer;
  }
  get _sheetSkeletonManagerService() {
    var r;
    return (r = this._renderer) == null ? void 0 : r.with(ue);
  }
  get engine() {
    var r;
    return (r = this._renderer) == null ? void 0 : r.engine;
  }
  // eslint-disable-next-line complexity
  fitTextSize(r) {
    var M7, E, T, P2;
    const e = this._editorBridgeService.getEditCellState();
    if (!e) return;
    const { position: t8, documentLayoutObject: n, canvasOffset: i, scaleX: o, scaleY: s } = e, { startX: l, startY: a, endX: c, endY: d } = t8, u = this._univerInstanceService.getUnit(Dl, we.UNIVER_DOC);
    if (u == null)
      return;
    const h = this._getEditorSkeleton();
    if (!h) return;
    const g = this._predictingSize(
      t8,
      i,
      h,
      n,
      o,
      s
    );
    if (!g || g.actualWidth <= 0) return;
    let { actualWidth: m2, actualHeight: f2 } = g;
    const { verticalAlign: v2, horizontalAlign: p, paddingData: S, fill: w } = n;
    m2 = m2 + ((M7 = S.l) != null ? M7 : 0) + ((E = S.r) != null ? E : 0), f2 = f2 + ((T = S.t) != null ? T : 0) + ((P2 = S.b) != null ? P2 : 0);
    let C = c - l, I2 = d - a;
    C < m2 && (C = Math.ceil(m2)), I2 < f2 && (I2 = Math.ceil(f2));
    let R = 0;
    v2 === xn.MIDDLE ? R = (I2 - f2) / 2 / s : v2 === xn.TOP ? R = S.t || 0 : R = (I2 - f2) / s;
    let y = 0;
    p === Ut.CENTER || (p === Ut.RIGHT ? y = (C - m2) / o : y = S.l || 0), R = R < (S.t || 0) ? S.t || 0 : R, y = y < (S.l || 0) ? S.l || 0 : y, u.updateDocumentDataMargin({
      t: R,
      l: y
    }), h.calculate(), this._editAreaProcessing(
      C,
      I2,
      t8,
      i,
      w,
      o,
      s,
      p,
      r
    );
  }
  /**
   * Mainly used to pre-calculate the width of the editor,
   * to determine whether it needs to be automatically widened.
   */
  _predictingSize(r, e, t8, n, i = 1, o = 1) {
    const { startX: s, endX: l } = r, { textRotation: a, wrapStrategy: c, paddingData: d } = n, u = this._univerInstanceService.getUnit(Dl, we.UNIVER_DOC), { vertexAngle: h } = A3(a);
    if (c === Bn.WRAP && h === 0) {
      u == null || u.updateDocumentDataPageSize(l - s), u == null || u.updateDocumentDataMargin({ l: d.l, t: d.t }), t8.calculate();
      const { actualWidth: v2, actualHeight: p } = t8.getActualSize();
      return {
        actualWidth: v2 * i,
        actualHeight: p * o
      };
    }
    const g = this._getEditorMaxSize(r, e, n.horizontalAlign);
    if (!g) return;
    u == null || u.updateDocumentDataPageSize(g.width / i), t8.calculate();
    const m2 = t8.getActualSize();
    let f2 = l - s;
    return f2 < m2.actualWidth * i + ph3 * i && (f2 = m2.actualWidth * i + ph3 * i), u == null || u.updateDocumentDataPageSize(f2 / i), u == null || u.updateDocumentRenderConfig({
      horizontalAlign: Ut.UNSPECIFIED,
      cellValueType: void 0
    }), {
      actualWidth: m2.actualWidth * i,
      actualHeight: m2.actualHeight * o
    };
  }
  _getEditorMaxSize(r, e, t8) {
    var S, w, C, I2;
    if (this._getEditorObject() == null)
      return;
    function i(R) {
      return Number.parseInt(R.replace("px", ""));
    }
    const o = this.engine;
    if (!o) return;
    const s = o.getCanvasElement(), l = s.getBoundingClientRect(), a = i(s.style.width), { width: c } = l, d = c / a, { startX: u, startY: h, endX: g } = r, m2 = o.width, f2 = ((w = (S = this._configService.getConfig(_e2)) == null ? void 0 : S.footer) == null || w) && ((I2 = (C = this._configService.getConfig(Tt3)) == null ? void 0 : C.footer) == null || I2) ? rf2 : 0, v2 = document.body.clientHeight - h - f2 - e.top - vh3 * 2;
    let p = c - u;
    if (t8 === Ut.CENTER) {
      const R = m2 - g, y = u;
      p = g - u + Math.min(y, R) * 2;
    } else t8 === Ut.RIGHT && (p = g);
    return {
      height: v2,
      width: p - vh3,
      scaleAdjust: d
    };
  }
  /**
   * Mainly used to calculate the volume of scenes and objects,
   * determine whether a scrollbar appears,
   * and calculate the editor's boundaries relative to the browser.
   */
  // eslint-disable-next-line max-lines-per-function
  _editAreaProcessing(r, e, t8, n, i, o = 1, s = 1, l, a) {
    var A;
    const c = this._getEditorObject();
    if (c == null)
      return;
    const d = this.engine;
    if (!d) return;
    const u = d.getCanvasElement();
    let { startX: h, startY: g } = t8;
    const { document: m2, scene: f2, engine: v2 } = c, p = f2.getViewport(We4.VIEW_MAIN), S = this._getEditorMaxSize(t8, n, l), { height: w, width: C, scaleAdjust: I2 } = S;
    let R = e, y = p == null ? void 0 : p.getScrollBar();
    R > w ? (y == null ? p && new D8(p, { enableHorizontal: false, barSize: 8 }) : p == null || p.resetCanvasSizeAndUpdateScroll(), p == null || p.scrollToViewportPos({
      viewportScrollY: R - w
    }), R = w) : (y = null, (A = p == null ? void 0 : p.getScrollBar()) == null || A.dispose()), r += (y == null ? void 0 : y.barSize) || 0, r > C && (r = C), this._addBackground(f2, r / o, e / s, i);
    const { scaleX: M7, scaleY: E } = f2.getPrecisionScale();
    f2.transformByState({
      width: r * I2 / o,
      height: e * I2 / s,
      scaleX: o * I2,
      scaleY: s * I2
    }), m2.resize(r * I2 / o, e * I2 / s), setTimeout(() => {
      v2.resizeBySize(
        Z2(r, M7),
        Z2(R, E)
      ), a == null || a();
    }, 0);
    const T = this._layoutService.getContentElement().getBoundingClientRect(), P2 = u.getBoundingClientRect();
    h = h * I2 + (P2.left - T.left), g = g * I2 + (P2.top - T.top);
    const H3 = t8.endX - t8.startX;
    l === Ut.RIGHT ? h += (H3 - r) * I2 : l === Ut.CENTER && (h += (H3 - r * I2) / 2), this._cellEditorManagerService.setState({
      startX: h,
      startY: g,
      endX: r * I2 + h,
      endY: R * I2 + g,
      show: true
    });
  }
  /**
   * Since the document does not support cell background color, an additional rect needs to be added.
   */
  _addBackground(r, e, t8, n) {
    const i = "_backgroundRectHelperColor_", o = r.getObject(i);
    o == null && n == null || (o == null ? r.addObjects(
      [
        new I12(i, {
          width: e,
          height: t8,
          fill: n,
          evented: false
        })
      ],
      zo2
    ) : n == null ? o.dispose() : (o.setProps({
      fill: n
    }), o.transformByState({
      width: e,
      height: t8
    })));
  }
  resizeCellEditor(r) {
    var I2, R;
    const e = this._cellEditorManagerService.getState();
    if (!e || !this._editorBridgeService.isVisible().visible) return;
    this._editorBridgeService.refreshEditCellPosition(true);
    const t8 = this._editorBridgeService.getEditCellState();
    if (!t8) return;
    const n = (R = (I2 = this._sheetSkeletonManagerService) == null ? void 0 : I2.getSkeletonParam(t8.sheetId)) == null ? void 0 : R.skeleton;
    if (!n) return;
    const { row: i, column: o, scaleX: s, scaleY: l, position: a, canvasOffset: c, documentLayoutObject: d } = t8, { horizontalAlign: u } = d, h = this._getEditorMaxSize(a, c, u);
    if (!h) return;
    const { height: g, width: m2, scaleAdjust: f2 } = h, v2 = n.getCellWithCoordByIndex(i, o), p = Math.min((v2.mergeInfo.endY - v2.mergeInfo.startY) * l, g) * f2, S = Math.min((v2.mergeInfo.endX - v2.mergeInfo.startX) * s, m2) * f2, w = e.endY - e.startY, C = e.endX - e.startX;
    if (w !== p || C !== S) {
      if (this._editorBridgeService.refreshEditCellPosition(true), !this._getEditorSkeleton())
        return;
      this.fitTextSize(r);
    }
  }
  _getEditorObject() {
    return Dd2(this._editorBridgeService.getCurrentEditorId(), this._renderManagerService);
  }
  _getEditorSkeleton() {
    var r;
    return (r = this._renderManagerService.getRenderById(Dl)) == null ? void 0 : r.with(D).getSkeleton();
  }
};
Ao3 = M02([
  Xr3(0, U1),
  Xr3(1, ls3),
  Xr3(2, qe5),
  Xr3(3, ME),
  Xr3(4, vr),
  Xr3(5, ic)
], Ao3);
var E02 = Object.getOwnPropertyDescriptor;
var T02 = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? E02(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var ar2 = (r, e) => (t8, n) => e(t8, n, r);
var Ho3 = class extends h1 {
  constructor(e, t8, n, i, o, s, l, a) {
    super();
    _2(this, "_d");
    this._context = e, this._instanceSrv = t8, this._commandService = n, this._editorBridgeService = i, this._selectionManagerService = o, this._contextService = s, this._renderManagerService = l, this._sheetSkeletonManagerService = a, this.disposeWithMe(this._instanceSrv.getCurrentTypeOfUnit$(we.UNIVER_SHEET).subscribe((c) => {
      c && c.getUnitId() === this._context.unitId ? this._d = this._init() : this._disposeCurrent();
    }));
  }
  _init() {
    const e = new ao();
    return this._initSelectionChangeListener(e), this._initEventListener(e), this._commandExecutedListener(e), this._initialKeyboardListener(e), e;
  }
  _disposeCurrent() {
    var e;
    (e = this._d) == null || e.dispose(), this._d = null;
  }
  _initSelectionChangeListener(e) {
    e.add(merge(
      this._selectionManagerService.selectionMoveEnd$,
      this._selectionManagerService.selectionSet$,
      this._selectionManagerService.selectionMoveStart$
    ).subscribe((t8) => this._updateEditorPosition(t8)));
  }
  _updateEditorPosition(e) {
    var n, i, o;
    if (this._editorBridgeService.isVisible().visible) return;
    const t8 = (n = e == null ? void 0 : e[e.length - 1]) == null ? void 0 : n.primary;
    if (t8) {
      const s = this._getSheetObject(), { scene: l, engine: a } = s, c = this._context.unitId, d = (i = this._context.unit.getActiveSheet()) == null ? void 0 : i.getSheetId();
      if (!d) return;
      const u = (o = this._sheetSkeletonManagerService.getSkeletonParam(d)) == null ? void 0 : o.skeleton.getCellWithCoordByIndex(t8.actualRow, t8.actualColumn), h = u ? {
        actualRow: u.actualRow,
        actualColumn: u.actualColumn,
        isMerged: u.isMerged,
        startRow: u.mergeInfo.startRow,
        startColumn: u.mergeInfo.startColumn,
        endRow: u.mergeInfo.endRow,
        endColumn: u.mergeInfo.endColumn,
        isMergedMainCell: u.isMergedMainCell
      } : t8;
      this._commandService.executeCommand(Jd2.id, {
        scene: l,
        engine: a,
        primary: h,
        unitId: c,
        sheetId: d
      });
    }
  }
  refreshEditorPosition() {
    const e = this._selectionManagerService.getWorkbookSelections(this._context.unitId);
    if (e) {
      const t8 = e.getCurrentSelections();
      t8 && this._updateEditorPosition([...t8]);
    }
  }
  _initEventListener(e) {
    const t8 = this._getSheetObject(), { spreadsheet: n, spreadsheetColumnHeader: i, spreadsheetLeftTopPlaceholder: o, spreadsheetRowHeader: s } = t8;
    e.add(n.onDblclick$.subscribeEvent((l) => {
      l.button !== 2 && this._commandService.executeCommand(tt3.id, {
        visible: true,
        eventType: Kv.Dblclick,
        unitId: this._context.unitId
      });
    })), e.add(n.onPointerDown$.subscribeEvent({
      next: this._tryHideEditor.bind(this),
      priority: -1
    })), e.add(i.onPointerDown$.subscribeEvent({
      next: this._tryHideEditor.bind(this),
      priority: -1
    })), e.add(o.onPointerDown$.subscribeEvent({
      next: this._tryHideEditor.bind(this),
      priority: -1
    })), e.add(s.onPointerDown$.subscribeEvent({
      next: this._tryHideEditor.bind(this),
      priority: -1
    }));
  }
  /**
   * Should activate the editor when the user inputs text.
   * @param d DisposableCollection
   */
  _initialKeyboardListener(e) {
    let t8 = null;
    const n = (o) => {
      const s = o.with(Re2);
      s && (t8 = We(s.onInputBefore$.subscribe((l) => {
        if (!this._isCurrentSheetFocused())
          return;
        const a = this._contextService.getContextValue(gE), c = this._contextService.getContextValue(gr), d = o.unitId;
        this._editorBridgeService.isVisible().visible || d && c && !a && this._showEditorByKeyboard(l);
      })), e.add(t8));
    }, i = this._renderManagerService.getRenderById(Dl);
    i ? n(i) : this.disposeWithMe(this._renderManagerService.created$.pipe(filter((o) => o.unitId === Dl)).subscribe((o) => {
      t8 == null || t8.dispose(), n(o);
    }));
  }
  _commandExecutedListener(e) {
    const t8 = /* @__PURE__ */ new Set([Ls2.id, ss3.id]);
    e.add(this._commandService.onCommandExecuted((n) => {
      if (t8.has(n.id)) {
        if (this._editorBridgeService.isVisible().visible) return;
        this._editorBridgeService.refreshEditCellState();
      }
      if (n.id === ee.id) {
        const i = n.params, { cellValue: o, unitId: s, subUnitId: l } = i;
        if (!o) return;
        const a = this._editorBridgeService.getEditLocation();
        if (a) {
          const { unitId: c, sheetId: d, row: u, column: h } = a;
          s === c && l === d && o && o[u] && Object.prototype.hasOwnProperty.call(o[u], h) && this._editorBridgeService.refreshEditCellState();
        }
      }
    })), e.add(this._commandService.beforeCommandExecuted((n, i) => {
      i != null && i.fromCollab || n.id === pn2.id && this._tryHideEditor();
    }));
  }
  _showEditorByKeyboard(e) {
    const t8 = e == null ? void 0 : e.event;
    e == null || !t8.data && t8.inputType !== "InsertParagraph" || this._commandService.syncExecuteCommand(tt3.id, {
      visible: true,
      eventType: Kv.Keyboard,
      keycode: t8.which,
      unitId: this._context.unitId
    });
  }
  _tryHideEditor() {
    this._editorBridgeService.isForceKeepVisible() || this._hideEditor();
  }
  _hideEditor() {
    this._editorBridgeService.isVisible().visible === true && this._commandService.syncExecuteCommand(tt3.id, {
      visible: false,
      eventType: Kv.PointerDown,
      unitId: this._context.unitId
    });
  }
  _getSheetObject() {
    return en4(this._context.unit, this._context);
  }
  _isCurrentSheetFocused() {
    var e;
    return ((e = this._instanceSrv.getFocusedUnit()) == null ? void 0 : e.getUnitId()) === this._context.unitId;
  }
};
Ho3 = T02([
  ar2(1, vr),
  ar2(2, Ls),
  ar2(3, qe5),
  ar2(4, Inject(z)),
  ar2(5, Nr),
  ar2(6, ME),
  ar2(7, Inject(ue))
], Ho3);
var lf2 = [
  q1.ARROW_DOWN,
  q1.ARROW_UP,
  q1.ARROW_LEFT,
  q1.ARROW_RIGHT
];
var P02 = [q1.ENTER, q1.TAB, ...lf2];
function af2() {
  const r = [];
  for (const e of lf2)
    r.push({
      id: wi4.id,
      binding: e,
      preconditions: (t8) => mi3(t8),
      staticParameters: {
        visible: false,
        eventType: Kv.Keyboard,
        keycode: e,
        isShift: false
      }
    }), r.push({
      id: wi4.id,
      binding: e | L1.SHIFT,
      preconditions: (t8) => mi3(t8),
      staticParameters: {
        visible: false,
        eventType: Kv.Keyboard,
        keycode: e,
        isShift: true
      }
    });
  return r;
}
var cf2 = {
  id: Ea2.id,
  binding: q1.F2,
  description: "shortcut.sheet.start-editing",
  group: "4_sheet-edit",
  preconditions: Ve4,
  staticParameters: {
    visible: true,
    eventType: Kv.Keyboard,
    keycode: q1.F2
  }
};
var df2 = {
  id: tt3.id,
  binding: q1.ENTER,
  description: "shortcut.sheet.toggle-editing",
  group: "4_sheet-edit",
  preconditions: (r) => mi3(r),
  staticParameters: {
    visible: false,
    eventType: Kv.Keyboard,
    keycode: q1.ENTER
  }
};
var uf2 = {
  id: tt3.id,
  binding: q1.TAB,
  preconditions: (r) => mi3(r),
  staticParameters: {
    visible: false,
    eventType: Kv.Keyboard,
    keycode: q1.TAB
  }
};
var hf2 = {
  id: tt3.id,
  binding: q1.ESC,
  description: "shortcut.sheet.abort-editing",
  group: "4_sheet-edit",
  preconditions: (r) => mi3(r),
  staticParameters: {
    visible: false,
    eventType: Kv.Keyboard,
    keycode: q1.ESC
  }
};
var gf2 = {
  id: tt3.id,
  binding: q1.ENTER | L1.CTRL_COMMAND,
  mac: q1.ENTER | L1.MAC_CTRL,
  preconditions: (r) => mi3(r),
  staticParameters: {
    visible: false,
    eventType: Kv.Keyboard,
    keycode: q1.ENTER | L1.CTRL_COMMAND
  }
};
var mf2 = {
  id: Gr.id,
  description: "shortcut.sheet.break-line",
  group: "4_sheet-edit",
  preconditions: (r) => l1(r),
  binding: q1.ENTER | L1.ALT
};
var ff2 = {
  id: Do2.id,
  preconditions: (r) => Ud2(r) || la(r),
  binding: q1.BACKSPACE
};
var pf2 = {
  id: ba.id,
  preconditions: (r) => Ud2(r) || la(r),
  binding: q1.DELETE
};
var vf4 = {
  id: Do2.id,
  preconditions: (r) => Ud2(r) || la(r),
  binding: q1.BACKSPACE | L1.SHIFT
};
var Sf2 = {
  id: tt3.id,
  description: "shortcut.sheet.delete-and-start-editing",
  group: "4_sheet-edit",
  preconditions: (r) => Ve4(r) && !la(r),
  binding: q1.BACKSPACE,
  staticParameters: {
    visible: true,
    eventType: Kv.Keyboard,
    keycode: q1.BACKSPACE
  }
};
function x02(r) {
  return r.startsWith("'");
}
function O02(r) {
  return r.slice(1);
}
var A02 = {
  "": "0",
  "": "1",
  "": "2",
  "": "3",
  "": "4",
  "": "5",
  "": "6",
  "": "7",
  "": "8",
  "": "9",
  : "A",
  : "B",
  : "C",
  : "D",
  : "E",
  : "F",
  : "G",
  : "H",
  : "I",
  : "J",
  : "K",
  : "L",
  : "M",
  : "N",
  : "O",
  : "P",
  : "Q",
  : "R",
  : "S",
  : "T",
  : "U",
  : "V",
  : "W",
  : "X",
  : "Y",
  : "Z",
  : "a",
  : "b",
  : "c",
  : "d",
  : "e",
  : "f",
  : "g",
  : "h",
  : "i",
  : "j",
  : "k",
  : "l",
  : "m",
  : "n",
  : "o",
  : "p",
  : "q",
  : "r",
  : "s",
  : "t",
  : "u",
  : "v",
  : "w",
  : "x",
  : "y",
  : "z",
  "": "%",
  "": "-",
  "": ".",
  "": ":",
  "": "/",
  "": "+",
  "": "@",
  "": "&",
  "": "*",
  "": "#",
  "": "=",
  "": ">",
  "": "<",
  "": "$",
  "": '"',
  "": "'",
  "": "(",
  "": ")",
  "": " ",
  "": ",",
  "": "!",
  "": "?",
  "": ";",
  "": "[",
  "": "]",
  "": "{",
  "": "}"
};
var Yc3 = {
  true: "TRUE",
  false: "FALSE"
};
function H02(r) {
  return [Ns.ZH_CN, Ns.ZH_TW].includes(r);
}
function V02(r, e, t8, n) {
  let i = r;
  if (H02(t8)) {
    if (r.startsWith("") || r.startsWith("'"))
      return `'${r.slice(1)}`;
    i = N03(i);
  }
  if (i.startsWith("="))
    return k02(r, i, e, n);
  const o = i.toLowerCase();
  return Yc3[o] ? Yc3[o] : eR.parseValue(i) == null ? r : i;
}
function N03(r) {
  const e = /['"].*?['"]/g, t8 = [], n = r.split(e);
  r.replace(e, (o) => (t8.push(o), ""));
  let i = n.join("").split("").map(W02).join("");
  return t8.forEach((o, s) => {
    i = i.slice(0, s * 2) + o + i.slice((s + 1) * 2);
  }), i;
}
function k02(r, e, t8, n) {
  const i = t8.sequenceNodesBuilder(e);
  if (!i) return r;
  let o = e, s = 0;
  return i.forEach((l, a) => {
    if (typeof l == "object") {
      const c = l.token;
      if (Yc3[c.toLowerCase()]) {
        const d = l.startIndex + s + 1, u = l.endIndex + s + 2;
        o = zr3(c.toLocaleUpperCase(), o, d, u);
      } else if (l.nodeType === $e.FUNCTION && D02(c, n, i, a) || l.nodeType === $e.REFERENCE) {
        const d = c.indexOf("!");
        if (d > -1) {
          const u = c.substring(d + 1), h = l.startIndex + s + (d + 1) + 1, g = l.endIndex + s + 2;
          o = zr3(u.toLocaleUpperCase(), o, h, g);
        } else {
          const u = l.startIndex + s + 1, h = l.endIndex + s + 2;
          o = zr3(c.toLocaleUpperCase(), o, u, h);
        }
      } else if (c.startsWith('"') && c.endsWith('"') || c.startsWith("'") && c.endsWith("'")) {
        const d = l.startIndex + s + 2, u = l.endIndex + s + 1;
        o = zr3(r.slice(d, u), o, d, u);
      } else if (l.nodeType !== $e.ARRAY) {
        const d = eR.parseValue(c);
        if (d == null) {
          const u = l.startIndex + s + 1, h = l.endIndex + s + 2;
          o = zr3(r.slice(u, h), o, u, h);
        } else if (typeof d.v == "number" && (d.z === void 0 || !eR.getFormatInfo(d.z).isDate)) {
          const u = `${d.v}`, h = l.startIndex + s + 1, g = l.endIndex + s + 2, { processedString: m2, offset: f2 } = B02(c, u);
          o = zr3(m2, o, h, g), s += f2;
        }
      }
    }
  }), o;
}
function D02(r, e, t8, n) {
  const i = e.getDescriptions();
  return t8[n + 1] !== K.OPEN_BRACKET ? false : i.get(L02(r).toLocaleUpperCase()) !== void 0;
}
function L02(r) {
  const e = /^@+/;
  return r.replace(e, "");
}
function W02(r) {
  return A02[r] || r;
}
function zr3(r, e, t8, n) {
  return e.substring(0, t8) + r + e.substring(n);
}
function B02(r, e) {
  var s, l;
  const t8 = ((s = r.match(/^\s*/)) == null ? void 0 : s[0]) || "", n = ((l = r.match(/\s*$/)) == null ? void 0 : l[0]) || "", i = t8 + e + n, o = i.length - r.length;
  return { processedString: i, offset: o };
}
var F02 = "range_selector";
var U02 = (r) => r.includes(F02);
var X02 = Object.getOwnPropertyDescriptor;
var z02 = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? X02(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var Mt2 = (r, e) => (t8, n) => e(t8, n, r);
var Sh2 = -1e3;
var Ri2 = class extends Ve {
  constructor(e, t8, n, i, o, s, l, a, c, d, u, h, g, m2, f2) {
    super();
    _2(this, "_cursorChange", 0);
    _2(this, "_editingUnit", "");
    _2(this, "_cursorTimeout");
    this._undoRedoService = e, this._contextService = t8, this._renderManagerService = n, this._editorBridgeService = i, this._cellEditorManagerService = o, this._lexerTreeBuilder = s, this._functionService = l, this._textSelectionManagerService = a, this._commandService = c, this._localService = d, this._editorService = u, this._univerInstanceService = h, this._sheetInterceptorService = g, this._sheetCellEditorResizeService = m2, this._selectionManagerService = f2, this.disposeWithMe(this._init()), this._initEditorVisibilityListener();
  }
  dispose() {
    super.dispose();
  }
  get _workbookSelections() {
    return this._selectionManagerService.getWorkbookSelections(this._editingUnit);
  }
  _init() {
    const e = new ao();
    return this._subscribeToCurrentCell(e), this._initialCursorSync(e), this._listenEditorFocus(e), this._commandExecutedListener(e), this._initSkeletonListener(e), e.add(() => {
      clearTimeout(this._cursorTimeout);
    }), this._cursorTimeout = setTimeout(() => {
      this._cursorStateListener(e);
    }, 1e3), e;
  }
  _initEditorVisibilityListener() {
    this.disposeWithMe(this._univerInstanceService.getCurrentTypeOfUnit$(we.UNIVER_SHEET).subscribe(async (e) => {
      var t8;
      if (this._editingUnit && (e == null ? void 0 : e.getUnitId()) !== this._editingUnit && !this._editorBridgeService.isForceKeepVisible()) {
        this._commandService.syncExecuteCommand(tt3.id, {
          visible: false,
          eventType: Kv.Keyboard,
          keycode: q1.ESC,
          unitId: this._editingUnit
        });
        const n = (t8 = this._renderManagerService.getRenderById(e.getUnitId())) == null ? void 0 : t8.with(Ho3);
        n && n.refreshEditorPosition();
      }
    })), this.disposeWithMe(
      this._editorBridgeService.visible$.pipe(distinctUntilChanged((e, t8) => e.visible === t8.visible)).subscribe(async (e) => {
        e.visible ? (this._editingUnit = e.unitId, this._handleEditorVisible(e)) : this._editingUnit && (await this._handleEditorInvisible(e), this._editingUnit = "");
      })
    );
  }
  _listenEditorFocus(e) {
    const t8 = this._getEditorObject();
    t8 && e.add(t8.document.onPointerDown$.subscribeEvent(() => {
      var n;
      if (this._editingUnit && this._editorBridgeService.isVisible()) {
        const i = this._editorBridgeService.getEditCellState(), o = this._editorBridgeService.getCurrentEditorId();
        if (!i || !o)
          return;
        (n = this._sheetCellEditorResizeService) == null || n.fitTextSize();
      }
    }));
  }
  _initialCursorSync(e) {
    e.add(this._cellEditorManagerService.focus$.pipe(filter((t8) => !!t8)).subscribe(() => {
      var i;
      const t8 = this._univerInstanceService.getCurrentUnitForType(we.UNIVER_DOC);
      if (!t8) return;
      const n = (i = this._renderManagerService.getRenderById(t8 == null ? void 0 : t8.getUnitId())) == null ? void 0 : i.with(Re2);
      n && n.sync();
    }));
  }
  _initSkeletonListener(e) {
    const t8 = new Set(mh);
    t8.delete(pn2.id), e.add(this._commandService.onCommandExecuted((n) => {
      var i;
      if (t8.has(n.id)) {
        switch (n.id) {
          case Je2.id:
          case qe2.id:
          case Me.id:
          case Te.id:
          case ke2.id:
          case Ue.id: {
            const o = this._editorBridgeService.getEditLocation();
            if (!o) break;
            const s = {
              startRow: o.row,
              startColumn: o.column,
              endRow: o.row,
              endColumn: o.column
            }, l = Al(s, n);
            if (!l) break;
            const a = l.startRow, c = l.startColumn;
            this._editorBridgeService.updateEditLocation(a, c);
            break;
          }
        }
        (i = this._sheetCellEditorResizeService) == null || i.resizeCellEditor(() => {
          this._textSelectionManagerService.refreshSelection({
            unitId: Dl,
            subUnitId: Dl
          });
        });
      }
    }));
  }
  /**
   * Should update current editing cell info when selection is changed.
   * @param d DisposableCollection
   */
  _subscribeToCurrentCell(e) {
    e.add(this._editorBridgeService.currentEditCellState$.subscribe((t8) => {
      var p, S;
      if (t8 == null || this._editorBridgeService.isForceKeepVisible())
        return;
      const n = this._editorBridgeService.getEditCellState();
      if (n == null)
        return;
      const { position: i, documentLayoutObject: o, scaleX: s, editorUnitId: l } = n;
      if (this._contextService.getContextValue(DR))
        return;
      const a = this._getDocumentDataModel();
      if (a == null) return;
      const { startX: c, endX: d } = i, { textRotation: u, wrapStrategy: h, documentModel: g } = o, { vertexAngle: m2 } = A3(u);
      h === Bn.WRAP && m2 === 0 && a.updateDocumentDataPageSize((d - c) / s), this._commandService.syncExecuteCommand(_a.id, {
        unitId: l,
        snapshot: g.getSnapshot()
      }), this._contextService.setContextValue(MR, true), this._textSelectionManagerService.replaceDocRanges(
        [{
          startOffset: 0,
          endOffset: 0
        }],
        {
          unitId: Dl,
          subUnitId: Dl
        }
      );
      const f2 = (p = this._renderManagerService.getRenderById(Dl)) == null ? void 0 : p.with(Re2), v2 = (S = this._renderManagerService.getRenderById(Ul)) == null ? void 0 : S.with(Re2);
      (f2 != null && f2.canFocusing || v2 != null && v2.canFocusing) && (this._univerInstanceService.setCurrentUnitForType(Dl), f2 == null || f2.activate(
        Sh2,
        Sh2,
        true
      ));
    }));
  }
  /**
   * Listen to document edits to refresh the size of the sheet editor, not for normal editor.
   */
  _commandExecutedListener(e) {
    e.add(this._commandService.onCommandExecuted((n) => {
      var i;
      if (n.id === M.id) {
        const o = n.params, { unitId: s } = o;
        if (U02(s) || (this._editorBridgeService.changeEditorDirty(true), !this._editorBridgeService.isVisible().visible))
          return;
        s === Dl && ((i = this._sheetCellEditorResizeService) == null || i.fitTextSize());
      }
    }));
    const t8 = [wi4.id];
    e.add(this._commandService.onCommandExecuted((n) => {
      if (t8.includes(n.id)) {
        const i = n.params, { keycode: o, isShift: s } = i;
        if (o != null && (this._cursorChange === 2 || this._contextService.getContextValue(gE))) {
          this._moveInEditor(o, s);
          return;
        }
        this._commandService.syncExecuteCommand(tt3.id, i);
      }
      n.id === Ea2.id && (this._cursorChange = 2);
    }));
  }
  // You can double-click on the cell or input content by keyboard to put the cell into the edit state.
  // eslint-disable-next-line complexity
  _handleEditorVisible(e) {
    var g, m2, f2, v2;
    const { eventType: t8, keycode: n } = e;
    this._cursorChange = t8 === Kv.PointerDown || t8 === Kv.Dblclick ? 2 : 1;
    const i = this._editorBridgeService.getEditLocation();
    if (i == null)
      return;
    this._commandService.syncExecuteCommand($d2.id, {
      range: {
        startRow: i.row,
        startColumn: i.column,
        endRow: i.row,
        endColumn: i.column
      }
    }), this._editorBridgeService.refreshEditCellPosition(false);
    const { unitId: o, isInArrayFormulaRange: s = false } = i, l = this._getEditorObject();
    if (l == null)
      return;
    const { document: a, scene: c } = l;
    this._contextService.setContextValue(mE, true);
    const d = this._getDocumentDataModel(), u = this._getEditorSkeleton(Dl);
    if (!u || !d)
      return;
    (g = this._sheetCellEditorResizeService) == null || g.fitTextSize(() => {
      const p = c.getViewport(We4.VIEW_MAIN);
      p == null || p.scrollToViewportPos({
        viewportScrollX: Number.POSITIVE_INFINITY,
        viewportScrollY: Number.POSITIVE_INFINITY
      });
    });
    const h = () => {
      this._emptyDocumentDataModel(d.getSnapshot().documentStyle, !!s), a.makeDirty(), (n === q1.BACKSPACE || t8 === Kv.Dblclick) && (u.calculate(), this._editorBridgeService.changeEditorDirty(true)), this._textSelectionManagerService.replaceDocRanges(
        [{
          startOffset: 0,
          endOffset: 0
        }],
        {
          unitId: Dl,
          subUnitId: Dl
        }
      );
    };
    if (this._isCellImageData(d.getSnapshot()))
      h();
    else if (t8 === Kv.Keyboard && n === q1.F2) {
      a.makeDirty(), this._textSelectionManagerService.replaceDocRanges([
        {
          startOffset: 0,
          endOffset: 0
        }
      ]);
      const p = ((f2 = (m2 = d.getBody()) == null ? void 0 : m2.dataStream.length) != null ? f2 : 2) - 2;
      this._textSelectionManagerService.replaceDocRanges(
        [{
          startOffset: p,
          endOffset: p
        }],
        {
          unitId: Dl,
          subUnitId: Dl
        }
      );
    } else if (
      // clear and edit
      t8 === Kv.Keyboard || t8 === Kv.Dblclick && s
    )
      h();
    else if (t8 === Kv.Dblclick) {
      if (this._contextService.getContextValue(LR))
        return;
      const p = d.getBody().dataStream.length - 2 || 0;
      this._textSelectionManagerService.replaceDocRanges([
        {
          startOffset: p,
          endOffset: p
        }
      ]);
    }
    (v2 = this._renderManagerService.getRenderById(o)) == null || v2.scene.resetCursor();
  }
  _refreshCurrentSelections(e) {
    const t8 = this._workbookSelections.getSelectionsOfWorksheet(e);
    t8 && (this._contextService.setContextValue($u, false), this._commandService.syncExecuteCommand(ie3.id, {
      unitId: this._editingUnit,
      subUnitId: e,
      selections: t8
    }));
  }
  async _handleEditorInvisible(e) {
    var f2, v2;
    const t8 = this._editorBridgeService.getEditCellState(), n = this._univerInstanceService.getUnit(Dl), i = J.deepClone(n == null ? void 0 : n.getSnapshot()), { keycode: o } = e;
    this._cursorChange = 0;
    const s = (f2 = t8 == null ? void 0 : t8.unitId) != null ? f2 : "";
    if (this._exitInput(e), t8 == null)
      return;
    const l = this._univerInstanceService.getUnit(s, we.UNIVER_SHEET);
    if (!l)
      return;
    const a = l.getActiveSheet(), c = l.getUnitId(), d = a.getSheetId(), { unitId: u, sheetId: h } = t8;
    if (c === u && h !== d && await this._commandService.executeCommand(ri.id, {
      subUnitId: h,
      unitId: u
    }), o === q1.ESC) {
      this._editorBridgeService.isForceKeepVisible() && this._editorBridgeService.disableForceKeepVisible(), this._refreshCurrentSelections(h);
      return;
    }
    const g = ((v2 = i == null ? void 0 : i.body) == null ? void 0 : v2.dataStream.length) === 2, m2 = t8.documentLayoutObject.documentModel ? this._isCellImageData(t8.documentLayoutObject.documentModel.getSnapshot()) : false;
    i && !(g && m2) && await this._submitEdit(i, o === (L1.CTRL_COMMAND | q1.ENTER) || o === (L1.MAC_CTRL | q1.ENTER)) === false || o !== void 0 && this._moveSelection(o, s, d);
  }
  _getEditorObject() {
    return Dd2(this._editorBridgeService.getCurrentEditorId(), this._renderManagerService);
  }
  _isCellImageData(e) {
    var n, i;
    return ((i = (n = e.drawingsOrder) == null ? void 0 : n.length) != null ? i : 0) > 0;
  }
  submitCellData(e) {
    return this._submitEdit(e.getSnapshot());
  }
  async _submitEdit(e, t8 = false) {
    var v2;
    const n = this._editorBridgeService.getEditCellState();
    if (n == null)
      return true;
    const { unitId: i, sheetId: o, row: s, column: l } = n, a = this._univerInstanceService.getUnit(i, we.UNIVER_SHEET);
    if (!a)
      return true;
    let c = a.getActiveSheet();
    if (!a.getSheetBySheetId(o))
      return true;
    c = a.getActiveSheet();
    const u = j02(
      { ...c.getCellRaw(s, l) || {} },
      e,
      this._lexerTreeBuilder,
      this._localService,
      this._functionService,
      a.getStyles()
    );
    if (!u)
      return true;
    this._removeComposedCellStyleInCellData(u, c.getComposedCellStyle(s, l));
    const h = this._sheetInterceptorService.onWriteCell(a, c, s, l, u);
    if (J.diffValue(wh3(h), wh3(c.getCellRaw(s, l))))
      return true;
    const g = t8 ? (v2 = this._workbookSelections.getCurrentLastSelection()) == null ? void 0 : v2.range : {
      startRow: s,
      startColumn: l,
      endRow: s,
      endColumn: l
    }, m2 = et(6);
    return this._commandService.syncExecuteCommand(Sn.id, {
      subUnitId: o,
      unitId: i,
      range: g,
      value: h,
      redoUndoId: m2
    }) && await this._sheetInterceptorService.onValidateCell(a, c, s, l) === false ? (this._undoRedoService.rollback(m2, i), false) : true;
  }
  _removeComposedCellStyleInCellData(e, t8) {
    if (!e.s || typeof e.s == "string")
      return;
    const n = Object.keys(e.s);
    for (const i of n)
      t8[i] !== void 0 && J.diffValue(e.s[i], t8[i]) && delete e.s[i];
  }
  _exitInput(e) {
    var i, o;
    this._contextService.setContextValue(LR, false), this._contextService.setContextValue(mE, false), this._contextService.setContextValue(MR, false), this._contextService.setContextValue(gE, false), this._cellEditorManagerService.setState({
      show: e.visible
    });
    const t8 = this._getEditorObject();
    (i = t8 == null ? void 0 : t8.scene.getViewport(We4.VIEW_MAIN)) == null || i.scrollToViewportPos({
      viewportScrollX: 0,
      viewportScrollY: 0
    });
    const n = this._editorBridgeService.getCurrentEditorId();
    n == null || !this._editorService.isSheetEditor(n) || (n === Dl && ((o = this._getEditorSkeleton(Dl)) == null || o.resetInitialWidth()), this._undoRedoService.clearUndoRedo(n), this._undoRedoService.clearUndoRedo(Ul));
  }
  _moveSelection(e, t8, n) {
    if (e == null || !P02.includes(e)) {
      this._refreshCurrentSelections(n);
      return;
    }
    let i = Cm.LEFT;
    switch (e) {
      case q1.ENTER:
        i = Cm.DOWN;
        break;
      case q1.TAB:
        i = Cm.RIGHT;
        break;
      case q1.ARROW_DOWN:
        i = Cm.DOWN;
        break;
      case q1.ARROW_UP:
        i = Cm.UP;
        break;
      case q1.ARROW_LEFT:
        i = Cm.LEFT;
        break;
      case q1.ARROW_RIGHT:
        i = Cm.RIGHT;
        break;
    }
    const o = this._univerInstanceService.getCurrentUnitOfType(we.UNIVER_SHEET);
    t8 && (o == null ? void 0 : o.getUnitId()) !== t8 && this._univerInstanceService.setCurrentUnitForType(t8), e === q1.ENTER || e === q1.TAB ? this._commandService.executeCommand(Wn4.id, {
      keycode: e,
      direction: i
    }) : this._commandService.executeCommand(Ut4.id, {
      direction: i
    });
  }
  /**
   * The user's operations follow the sequence of opening the editor and then moving the cursor.
   * The logic here predicts the user's first cursor movement behavior based on this rule
   */
  _cursorStateListener(e) {
    const t8 = this._getEditorObject();
    if (!(t8 != null && t8.document)) return;
    const { document: n } = t8;
    e.add(We(n.onPointerDown$.subscribeEvent(() => {
      this._cursorChange === 1 && (this._cursorChange = 2);
    })));
  }
  // TODO: @JOCS, is it necessary to move these commands MoveSelectionOperation\MoveCursorOperation to shortcut? and use multi-commands?
  _moveInEditor(e, t8) {
    let n = Cm.LEFT;
    e === q1.ARROW_DOWN ? n = Cm.DOWN : e === q1.ARROW_UP ? n = Cm.UP : e === q1.ARROW_RIGHT && (n = Cm.RIGHT), t8 ? this._commandService.executeCommand(vt2.id, {
      direction: n
    }) : this._commandService.executeCommand(St2.id, {
      direction: n
    });
  }
  _getDocumentDataModel() {
    return this._univerInstanceService.getUnit(Dl, we.UNIVER_DOC);
  }
  _getEditorSkeleton(e) {
    var t8;
    return (t8 = this._renderManagerService.getRenderById(e)) == null ? void 0 : t8.with(D).getSkeleton();
  }
  _getEditorViewModel(e) {
    var t8;
    return (t8 = this._renderManagerService.getRenderById(e)) == null ? void 0 : t8.with(D).getViewModel();
  }
  _getEditingUnit() {
    return this._editingUnit ? this._univerInstanceService.getUnit(this._editingUnit, we.UNIVER_SHEET) : null;
  }
  _emptyDocumentDataModel(e, t8) {
    const n = (s, l) => {
      const a = J.deepClone(s.getSnapshot()), c = this._getEditorViewModel(s.getUnitId());
      c != null && (Y02(a.body, t8), l && (a.documentStyle = e), a.drawings = {}, a.drawingsOrder = [], s.reset(a), c.reset(s));
    }, i = this._getDocumentDataModel();
    i && n(i, true);
    const o = this._univerInstanceService.getUnit(Ul, we.UNIVER_DOC);
    o && n(o);
  }
};
Ri2 = z02([
  Mt2(0, Qo),
  Mt2(1, Nr),
  Mt2(2, ME),
  Mt2(3, qe5),
  Mt2(4, ls3),
  Mt2(5, Inject(ga)),
  Mt2(6, Qt2),
  Mt2(7, Inject(m)),
  Mt2(8, Ls),
  Mt2(9, Inject(Fn)),
  Mt2(10, Ge2),
  Mt2(11, vr),
  Mt2(12, Inject(G)),
  Mt2(13, Inject(Ao3)),
  Mt2(14, Inject(z))
], Ri2);
function j02(r, e, t8, n, i, o) {
  var u, h, g;
  if ((e == null ? void 0 : e.body) == null)
    return null;
  const { body: s } = e;
  r.t = void 0;
  const l = s.dataStream;
  let c = l.substring(l.length - 2, l.length) === Bc ? l.substring(0, l.length - 2) : l;
  const d = n.getCurrentLocale();
  if (c = V02(c, t8, d, i), (u = e.drawingsOrder) != null && u.length)
    r.v = "", r.f = null, r.si = null, r.p = e, r.t = fn.STRING;
  else if (r.s && tR((g = (h = o == null ? void 0 : o.get(r.s)) == null ? void 0 : h.n) == null ? void 0 : g.pattern)) {
    r.v = c, r.f = null, r.si = null, r.p = null, r.t = fn.STRING, Zc(s) && s.dataStream !== `\r
` && (r.p = e);
    const m2 = Ch2(e);
    m2 && (r.s = m2);
  } else if (Gg(c)) {
    if (r.f === c)
      return null;
    const m2 = t8.checkIfAddBracket(c);
    for (let f2 = 0; f2 < m2; f2++)
      c += K.CLOSE_BRACKET;
    r.f = c, r.si = null, r.v = null, r.p = null;
  } else if (x02(c)) {
    const m2 = O02(c);
    r.v = m2, r.f = null, r.si = null, r.p = null, r.t = fn.FORCE_STRING;
  } else if (Zc(s))
    s.dataStream === `\r
` ? (r.v = "", r.f = null, r.si = null, r.p = null) : (r.p = e, r.v = null, r.f = null, r.si = null);
  else {
    if (c === "" && r.v == null && r.p == null)
      return null;
    r.v = c, r.f = null, r.si = null, r.p = null;
    const m2 = Ch2(e);
    m2 && (r.s = m2);
  }
  return r;
}
function Zc(r) {
  const { textRuns: e = [], paragraphs: t8 = [], customRanges: n, customBlocks: i = [] } = r, o = r.dataStream.replace(/(\r\n)+$/, ""), s = ["va"];
  return (
    // This is because after editing, an inexplicable second paragraph style will appear \r\n
    e.filter((l) => l.st < o.length).some((l) => {
      var c;
      return !!(l.ts && Object.keys(l.ts).some((d) => s.includes(d))) || Object.keys((c = l.ts) != null ? c : {}).length && l.ed - l.st < o.length;
    }) || t8.some((l) => l.bullet) || t8.length >= 2 || !!(n != null && n.length) || i.length > 0
  );
}
function Ch2(r) {
  const { body: e } = r;
  if (!e) return null;
  const { textRuns: t8 = [] } = e;
  let n = {};
  const i = e.dataStream.replace(`\r
`, "");
  return t8.forEach((o) => {
    const { st: s, ed: l, ts: a } = o;
    l - s >= i.length && (n = { ...n, ...a });
  }), Object.keys(n).length ? n : null;
}
function Y02(r, e = false) {
  r.dataStream = Bc, r.textRuns != null && (r.textRuns.length === 1 && !e ? (r.textRuns[0].st = 0, r.textRuns[0].ed = 1) : r.textRuns = void 0), r.paragraphs != null && (r.paragraphs = [
    {
      startIndex: 0
    }
  ]), r.sectionBreaks != null && (r.sectionBreaks = void 0), r.tables != null && (r.tables = void 0), r.customRanges != null && (r.customRanges = void 0), r.customBlocks != null && (r.customBlocks = void 0);
}
function wh3(r) {
  return r && Object.fromEntries(
    Object.entries(r).filter(([e, t8]) => !(t8 == null || Array.isArray(t8) && t8.length === 0 || typeof t8 == "object" && Object.keys(t8).length === 0))
  );
}
var Z02 = Object.getOwnPropertyDescriptor;
var G02 = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? Z02(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var wn2 = (r, e) => (t8, n) => e(t8, n, r);
var yr3 = class extends h1 {
  constructor(e, t8, n, i, o, s, l, a, c) {
    super();
    _2(this, "_loadedMap", /* @__PURE__ */ new WeakSet());
    _2(this, "_scheduledCallback", -1);
    this._univerInstanceService = e, this._renderManagerService = t8, this._editorBridgeService = n, this._commandService = i, this._contextService = o, this._formulaEditorManagerService = s, this._undoRedoService = l, this._textSelectionManagerService = a, this._editorService = c, this._initialize();
  }
  _initialize() {
    this._syncEditorSize(), this._listenFxBtnClick(), this._handleContentChange(), this._univerInstanceService.focused$.pipe(takeUntil(this.dispose$)).subscribe((e) => {
      this._create(e);
    }), this._create(Ul), this.disposeWithMe(this._editorService.focus$.subscribe(() => {
      var t8;
      ((t8 = this._editorService.getFocusEditor()) == null ? void 0 : t8.getEditorId()) !== Ul ? this._contextService.setContextValue(gE, false) : this._contextService.setContextValue(gE, true);
    }));
  }
  _handleContentChange() {
    this.disposeWithMe(
      this._commandService.onCommandExecuted((e) => {
        if (e.id === M.id) {
          const t8 = e.params, { unitId: n } = t8;
          n === Ul && this.autoScroll();
        }
      })
    );
  }
  _create(e) {
    if (e !== Ul)
      return;
    const t8 = this._renderManagerService.getRenderById(e);
    if (t8 == null)
      return;
    const { mainComponent: n } = t8;
    n != null && (this._loadedMap.has(n) || this._loadedMap.add(n));
  }
  _listenFxBtnClick() {
    this._formulaEditorManagerService.fxBtnClick$.pipe(takeUntil(this.dispose$)).subscribe(() => {
      var t8;
      if (this._contextService.getContextValue(MR) && !this._contextService.getContextValue(mE)) {
        this._univerInstanceService.setCurrentUnitForType(Ul);
        const n = this._univerInstanceService.getUniverDocInstance(
          Ul
        );
        this._editorBridgeService.isVisible().visible === false && this._commandService.syncExecuteCommand(
          tt3.id,
          {
            visible: true,
            eventType: Kv.PointerDown,
            unitId: Ul
          }
        );
        const o = (t8 = n == null ? void 0 : n.getBody()) == null ? void 0 : t8.dataStream;
        if (o == null)
          return;
        let s = o.startsWith("=") ? o : `=${o}`;
        s = s.replace(/\r\n$/, "");
        const l = [
          {
            startOffset: s.length,
            endOffset: s.length
          }
        ], a = {
          unitId: Ul,
          body: {
            dataStream: s
          },
          segmentId: "",
          textRanges: l
        };
        this._commandService.syncExecuteCommand(Xd.id, a), requestAnimationFrame(() => {
          this._textSelectionManagerService.replaceDocRanges([], {
            unitId: Dl,
            subUnitId: Dl
          }), this._textSelectionManagerService.replaceDocRanges(l, {
            unitId: Ul,
            subUnitId: Ul
          }), this._contextService.setContextValue(gE, true);
        });
      }
    });
  }
  _syncEditorSize() {
    const e = this._univerInstanceService.unitAdded$.pipe(filter((t8) => t8.getUnitId() === Ul));
    this.disposeWithMe(combineLatest([this._formulaEditorManagerService.position$, e]).subscribe(([t8]) => {
      if (!t8) return this._clearScheduledCallback();
      const n = Dd2(Ul, this._renderManagerService), i = this._univerInstanceService.getUniverDocInstance(
        Ul
      );
      if (n == null || i == null) return this._clearScheduledCallback();
      const { width: o, height: s } = t8;
      if (o === 0 || s === 0) return this._clearScheduledCallback();
      const { engine: l } = n;
      i.updateDocumentDataPageSize(o), this.autoScroll(), this._scheduledCallback = requestIdleCallback(() => l.resizeBySize(o, s));
    }));
  }
  _clearScheduledCallback() {
    this._scheduledCallback !== -1 && cancelIdleCallback(this._scheduledCallback), this._scheduledCallback = -1;
  }
  autoScroll() {
    var m2, f2;
    const e = this._formulaEditorManagerService.getPosition(), t8 = (m2 = this._renderManagerService.getRenderById(Ul)) == null ? void 0 : m2.with(D).getSkeleton(), n = this._renderManagerService.getRenderById(Ul), i = this._univerInstanceService.getUniverDocInstance(
      Ul
    );
    if (t8 == null || e == null || n == null || i == null)
      return;
    const { marginTop: o = 0, marginBottom: s = 0 } = i.getSnapshot().documentStyle, { scene: l, mainComponent: a } = n;
    let { actualHeight: c } = t8.getActualSize();
    c += o + s;
    const { width: d, height: u } = e, h = l.getViewport(We4.VIEW_MAIN);
    let g = h == null ? void 0 : h.getScrollBar();
    l.transformByState({
      width: d,
      height: c
    }), a == null || a.resize(d, c), c > u ? g == null ? h && new D8(h, { enableHorizontal: false, barSize: 8 }) : h == null || h.resetCanvasSizeAndUpdateScroll() : (g = null, h == null || h.scrollToViewportPos({ viewportScrollX: 0, viewportScrollY: 0 }), (f2 = h == null ? void 0 : h.getScrollBar()) == null || f2.dispose());
  }
};
yr3 = G02([
  wn2(0, vr),
  wn2(1, ME),
  wn2(2, qe5),
  wn2(3, Ls),
  wn2(4, Nr),
  wn2(5, as2),
  wn2(6, Qo),
  wn2(7, Inject(m)),
  wn2(8, Ge2)
], yr3);
var q02 = "embedding_formula_editor";
var Ky = (r) => r.includes(q02);
var lu2 = (r, e) => {
  var u, h, g, m2, f2;
  const n = e.findNodePositionByCharIndex(r.startOffset, true, r.segmentId, -1), i = e.getSkeletonData();
  let o = r.endOffset;
  if (r.segmentId) {
    const v2 = (f2 = Array.from((h = (u = i == null ? void 0 : i.skeFooters.get(r.segmentId)) == null ? void 0 : u.values()) != null ? h : [])[0]) != null ? f2 : Array.from((m2 = (g = i == null ? void 0 : i.skeHeaders.get(r.segmentId)) == null ? void 0 : g.values()) != null ? m2 : [])[0];
    v2 && (o = Math.min(v2.ed, o));
  }
  const s = e.findNodePositionByCharIndex(o, true, r.segmentId, -1);
  if (!s || !n)
    return;
  const l = {
    docsLeft: 0,
    docsTop: 0,
    pageMarginLeft: 0,
    pageMarginTop: 0
  }, a = new It2(l, e), { borderBoxPointGroup: c } = a.getRangePointData(n, s);
  return Es2(c).map((v2) => ({
    top: v2.top,
    bottom: v2.bottom,
    left: v2.left,
    right: v2.right
  }));
};
var Q02 = (r, e, t8 = -1) => {
  const n = e.findPositionByGlyph(r, t8);
  if (!n)
    return;
  const i = { ...n, isBack: true }, o = {
    docsLeft: 0,
    docsTop: 0,
    pageMarginLeft: 0,
    pageMarginTop: 0
  }, s = new It2(o, e), { borderBoxPointGroup: l } = s.getRangePointData(i, i), c = Es2(l)[0];
  return {
    top: c.top,
    bottom: c.bottom,
    left: c.left,
    right: c.right
  };
};
var K02 = (r, e, t8 = 0, n = 0) => {
  const i = lu2({ startOffset: e.startIndex, endOffset: e.endIndex + 1 }, r);
  if (i)
    return {
      rects: i.map((o) => ({
        top: o.top + n,
        bottom: o.bottom + n,
        left: o.left + t8,
        right: o.right + t8
      })),
      range: e
    };
};
var J02 = (r, e, t8 = 0, n = 0) => {
  var u, h, g;
  const i = r.findNodeByCharIndex(e.startIndex), o = i == null ? void 0 : i.parent, s = o == null ? void 0 : o.parent, l = s == null ? void 0 : s.parent, a = l == null ? void 0 : l.lines.find((m2) => m2.paragraphStart && m2.paragraphIndex === e.startIndex), c = (g = (h = (u = a == null ? void 0 : a.divides) == null ? void 0 : u[0]) == null ? void 0 : h.glyphGroup) == null ? void 0 : g[0];
  if (!c || !c)
    return;
  const d = Q02(c, r);
  if (d)
    return {
      rect: {
        top: d.top + n,
        bottom: d.bottom + n,
        left: d.left + t8,
        right: d.right + t8
      },
      segmentId: void 0,
      segmentPageIndex: -1,
      paragraph: e
    };
};
var $02 = (r, e = 0, t8 = 0) => {
  var l, a, c, d, u, h, g;
  const n = r.getViewModel().getDataModel(), i = (c = (a = (l = n.getBody()) == null ? void 0 : l.customRanges) == null ? void 0 : a.filter((m2) => m2.rangeType === pn.HYPERLINK)) != null ? c : [], o = (h = (u = (d = n.getBody()) == null ? void 0 : d.paragraphs) == null ? void 0 : u.filter((m2) => {
    var f2;
    return ((f2 = m2.bullet) == null ? void 0 : f2.listType.indexOf(zt.CHECK_LIST)) === 0;
  })) != null ? h : [], s = (g = r.getSkeletonData()) == null ? void 0 : g.pages[0].skeDrawings;
  return {
    links: i.map((m2) => K02(r, m2, e, t8)).filter(Boolean),
    checkLists: o.map((m2) => J02(r, m2, e, t8)).filter(Boolean),
    drawings: s ? Array.from(s.keys()).map((m2) => ({
      drawingId: m2,
      rect: {
        top: s.get(m2).aTop,
        bottom: s.get(m2).aTop + s.get(m2).width,
        left: s.get(m2).aLeft,
        right: s.get(m2).aLeft + s.get(m2).height
      },
      drawing: s.get(m2)
    })) : []
  };
};
function Cf2(r, e, t8) {
  var c, d, u, h, g, m2;
  const n = (u = (d = (c = e.documentSkeleton) == null ? void 0 : c.getSkeletonData()) == null ? void 0 : d.pages[0].height) != null ? u : 0, i = (m2 = (g = (h = e.documentSkeleton) == null ? void 0 : h.getSkeletonData()) == null ? void 0 : g.pages[0].width) != null ? m2 : 0, o = e.verticalAlign, s = e.horizontalAlign;
  let l = 0;
  switch (o) {
    case xn.UNSPECIFIED:
    case xn.BOTTOM:
      l = r.mergeInfo.endY - r.mergeInfo.startY - n;
      break;
    case xn.MIDDLE:
      l = (r.mergeInfo.endY - r.mergeInfo.startY - n) / 2;
      break;
  }
  let a = 0;
  switch (s) {
    case Ut.RIGHT:
      a = r.mergeInfo.endX - r.mergeInfo.startX - i;
      break;
    case Ut.CENTER:
      a = (r.mergeInfo.endX - r.mergeInfo.startX - i) / 2;
      break;
    case Ut.UNSPECIFIED: {
      t8 && (a = r.mergeInfo.endX - r.mergeInfo.startX - i);
      break;
    }
  }
  return {
    paddingLeft: a,
    paddingTop: l
  };
}
var Jy = (r, e, t8, n, i, o) => {
  var P2, H3, A;
  const s = r.get(vr), l = r.get(ME), a = s.getUnit(e, we.UNIVER_SHEET);
  if (!a)
    return null;
  const c = a.getSheetBySheetId(t8);
  if (!c)
    return null;
  const d = l.getRenderById(a.getUnitId()), u = d == null ? void 0 : d.with(ue).getSkeletonParam(c.getSheetId()), h = u == null ? void 0 : u.skeleton;
  if (!h || !d) return;
  const g = h.getFont(n, i), m2 = g == null ? void 0 : g.documentSkeleton;
  if (!m2)
    return null;
  const f2 = (H3 = (P2 = m2.getViewModel().getBody()) == null ? void 0 : P2.customRanges) == null ? void 0 : H3.find((x7) => x7.rangeId === o);
  if (!f2)
    return null;
  const v2 = Oi, p = h.getCellWithCoordByIndex(n, i);
  let { actualColumn: S, actualRow: w } = p;
  h.overflowCache.forValue((x7, V2, D2) => {
    D2.startRow <= w && D2.endRow >= w && D2.startColumn <= S && D2.endColumn >= S && (S = V2, w = x7);
  });
  const C = h.getCellWithCoordByIndex(w, S), I2 = c.getCell(C.actualRow, C.actualColumn), { topOffset: R = 0, leftOffset: y = 0 } = (A = I2 == null ? void 0 : I2.fontRenderExtension) != null ? A : {}, { paddingLeft: M7, paddingTop: E } = Cf2(C, g, false), T = lu2({ startOffset: f2.startIndex, endOffset: f2.endIndex }, m2);
  return {
    rects: T == null ? void 0 : T.map((x7) => ({
      top: x7.top + C.mergeInfo.startY + E + R + v2,
      bottom: x7.bottom + C.mergeInfo.startY + E + R + v2,
      left: x7.left + C.mergeInfo.startX + M7 + y,
      right: x7.right + C.mergeInfo.startX + M7 + y
    })),
    customRange: f2,
    label: m2.getViewModel().getBody().dataStream.slice(f2.startIndex, f2.endIndex + 1)
  };
};
var $y = (r, e, t8, n, i, o) => {
  var y, M7, E;
  const s = r.get(qe5), l = s.getEditCellState();
  if (!l || !s.isVisible().visible)
    return null;
  const { editorUnitId: c, unitId: d, sheetId: u, row: h, column: g } = l;
  if (e !== d || t8 !== u || h !== n || g !== i)
    return null;
  const m2 = r.get(ME), f2 = m2.getRenderById(c), v2 = m2.getRenderById(e);
  if (!f2 || !v2)
    return null;
  const p = f2.with(D).getSkeleton(), S = (y = v2.with(ue).getSkeletonParam(u)) == null ? void 0 : y.skeleton;
  if (!p || !S)
    return null;
  const w = (E = (M7 = p.getViewModel().getBody()) == null ? void 0 : M7.customRanges) == null ? void 0 : E.find((T) => T.rangeId === o);
  if (!w)
    return null;
  const C = 4, I2 = lu2({ startOffset: w.startIndex, endOffset: w.endIndex }, p), R = f2.engine.getCanvasElement().getBoundingClientRect();
  return {
    rects: I2 == null ? void 0 : I2.map((T) => ({
      top: T.top + R.top - C,
      bottom: T.bottom + R.top + C,
      left: T.left + R.left,
      right: T.right + R.left
    })),
    customRange: w,
    label: p.getViewModel().getBody().dataStream.slice(w.startIndex, w.endIndex + 1)
  };
};
var eb = Object.getOwnPropertyDescriptor;
var tb = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? eb(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var bh2 = (r, e) => (t8, n) => e(t8, n, r);
function cr2(r) {
  const { workbook: e, worksheet: t8, ...n } = r;
  return n;
}
var Mr3 = class extends Ve {
  constructor(e, t8) {
    super();
    _2(this, "_currentCell$", new BehaviorSubject(null));
    _2(this, "_currentRichText$", new BehaviorSubject(null));
    _2(this, "_currentClickedCell$", new Subject());
    _2(this, "_currentDbClickedCell$", new Subject());
    _2(this, "_currentCellWithEvent$", new Subject());
    _2(this, "_currentPointerDownCell$", new Subject());
    _2(this, "_currentPointerUpCell$", new Subject());
    _2(this, "_currentHoveredRowHeader$", new BehaviorSubject(null));
    _2(this, "_currentHoveredColHeader$", new BehaviorSubject(null));
    _2(this, "_currentRowHeaderClick$", new Subject());
    _2(this, "_currentColHeaderClick$", new Subject());
    _2(this, "_currentRowHeaderDbClick$", new Subject());
    _2(this, "_currentColHeaderDbClick$", new Subject());
    _2(this, "_currentRowHeaderPointerDown$", new Subject());
    _2(this, "_currentColHeaderPointerDown$", new Subject());
    _2(this, "_currentRowHeaderPointerUp$", new Subject());
    _2(this, "_currentColHeaderPointerUp$", new Subject());
    _2(this, "currentCell$", this._currentCell$.asObservable().pipe(
      distinctUntilChanged(
        (e8, t10) => {
          var n, i, o, s, l, a, c, d;
          return ((n = e8 == null ? void 0 : e8.location) == null ? void 0 : n.unitId) === ((i = t10 == null ? void 0 : t10.location) == null ? void 0 : i.unitId) && ((o = e8 == null ? void 0 : e8.location) == null ? void 0 : o.subUnitId) === ((s = t10 == null ? void 0 : t10.location) == null ? void 0 : s.subUnitId) && ((l = e8 == null ? void 0 : e8.location) == null ? void 0 : l.row) === ((a = t10 == null ? void 0 : t10.location) == null ? void 0 : a.row) && ((c = e8 == null ? void 0 : e8.location) == null ? void 0 : c.col) === ((d = t10 == null ? void 0 : t10.location) == null ? void 0 : d.col);
        }
      )
    ));
    _2(this, "currentRichTextNoDistinct$", this._currentRichText$.pipe(
      map((e8) => e8 && {
        unitId: e8.location.unitId,
        subUnitId: e8.location.subUnitId,
        row: e8.location.row,
        col: e8.location.col,
        customRange: e8.customRange,
        bullet: e8.bullet,
        rect: e8.rect,
        drawing: e8.drawing
      })
    ));
    _2(this, "currentRichText$", this._currentRichText$.pipe(
      distinctUntilChanged(
        // eslint-disable-next-line complexity
        (e8, t10) => {
          var n, i, o, s, l, a, c, d, u, h, g, m2, f2, v2, p, S, w, C;
          return ((n = e8 == null ? void 0 : e8.location) == null ? void 0 : n.unitId) === ((i = t10 == null ? void 0 : t10.location) == null ? void 0 : i.unitId) && ((o = e8 == null ? void 0 : e8.location) == null ? void 0 : o.subUnitId) === ((s = t10 == null ? void 0 : t10.location) == null ? void 0 : s.subUnitId) && ((l = e8 == null ? void 0 : e8.location) == null ? void 0 : l.row) === ((a = t10 == null ? void 0 : t10.location) == null ? void 0 : a.row) && ((c = e8 == null ? void 0 : e8.location) == null ? void 0 : c.col) === ((d = t10 == null ? void 0 : t10.location) == null ? void 0 : d.col) && ((u = e8 == null ? void 0 : e8.customRange) == null ? void 0 : u.rangeId) === ((h = t10 == null ? void 0 : t10.customRange) == null ? void 0 : h.rangeId) && ((g = e8 == null ? void 0 : e8.bullet) == null ? void 0 : g.startIndex) === ((m2 = t10 == null ? void 0 : t10.bullet) == null ? void 0 : m2.startIndex) && ((f2 = e8 == null ? void 0 : e8.customRange) == null ? void 0 : f2.startIndex) === ((v2 = t10 == null ? void 0 : t10.customRange) == null ? void 0 : v2.startIndex) && ((p = e8 == null ? void 0 : e8.customRange) == null ? void 0 : p.endIndex) === ((S = t10 == null ? void 0 : t10.customRange) == null ? void 0 : S.endIndex) && ((w = e8 == null ? void 0 : e8.drawing) == null ? void 0 : w.drawingId) === ((C = t10 == null ? void 0 : t10.drawing) == null ? void 0 : C.drawingId);
        }
      ),
      map((e8) => e8 && {
        unitId: e8.location.unitId,
        subUnitId: e8.location.subUnitId,
        row: e8.location.row,
        col: e8.location.col,
        customRange: e8.customRange,
        bullet: e8.bullet,
        rect: e8.rect,
        drawing: e8.drawing
      })
    ));
    _2(this, "currentCellPosWithEvent$", this._currentCellWithEvent$.pipe(
      distinctUntilChanged(
        (e8, t10) => {
          var n, i, o, s, l, a, c, d;
          return ((n = e8 == null ? void 0 : e8.location) == null ? void 0 : n.unitId) === ((i = t10 == null ? void 0 : t10.location) == null ? void 0 : i.unitId) && ((o = e8 == null ? void 0 : e8.location) == null ? void 0 : o.subUnitId) === ((s = t10 == null ? void 0 : t10.location) == null ? void 0 : s.subUnitId) && ((l = e8 == null ? void 0 : e8.location) == null ? void 0 : l.row) === ((a = t10 == null ? void 0 : t10.location) == null ? void 0 : a.row) && ((c = e8 == null ? void 0 : e8.location) == null ? void 0 : c.col) === ((d = t10 == null ? void 0 : t10.location) == null ? void 0 : d.col);
        }
      ),
      map((e8) => e8 && {
        unitId: e8.location.unitId,
        subUnitId: e8.location.subUnitId,
        row: e8.location.row,
        col: e8.location.col,
        event: e8.event
      })
    ));
    _2(this, "currentPosition$", this._currentCell$.asObservable());
    _2(this, "currentClickedCell$", this._currentClickedCell$.asObservable());
    _2(this, "currentDbClickedCell$", this._currentDbClickedCell$.asObservable());
    _2(this, "currentPointerDownCell$", this._currentPointerDownCell$.asObservable());
    _2(this, "currentPointerUpCell$", this._currentPointerUpCell$.asObservable());
    _2(this, "currentHoveredRowHeader$", this._currentHoveredRowHeader$.asObservable());
    _2(this, "currentHoveredColHeader$", this._currentHoveredColHeader$.asObservable());
    _2(this, "currentRowHeaderClick$", this._currentRowHeaderClick$.asObservable());
    _2(this, "currentColHeaderClick$", this._currentColHeaderClick$.asObservable());
    _2(this, "currentRowHeaderDbClick$", this._currentRowHeaderDbClick$.asObservable());
    _2(this, "currentColHeaderDbClick$", this._currentColHeaderDbClick$.asObservable());
    _2(this, "currentRowHeaderPointerDown$", this._currentRowHeaderPointerDown$.asObservable());
    _2(this, "currentColHeaderPointerDown$", this._currentColHeaderPointerDown$.asObservable());
    _2(this, "currentRowHeaderPointerUp$", this._currentRowHeaderPointerUp$.asObservable());
    _2(this, "currentColHeaderPointerUp$", this._currentColHeaderPointerUp$.asObservable());
    this._univerInstanceService = e, this._renderManagerService = t8, this._initCellDisposableListener();
  }
  dispose() {
    super.dispose(), this._currentCell$.complete(), this._currentClickedCell$.complete(), this._currentPointerDownCell$.complete(), this._currentPointerUpCell$.complete(), this._currentCellWithEvent$.complete(), this._currentRichText$.complete(), this._currentDbClickedCell$.complete(), this._currentHoveredRowHeader$.complete(), this._currentHoveredColHeader$.complete(), this._currentRowHeaderClick$.complete(), this._currentColHeaderClick$.complete(), this._currentRowHeaderDbClick$.complete(), this._currentColHeaderDbClick$.complete(), this._currentRowHeaderPointerDown$.complete(), this._currentColHeaderPointerDown$.complete(), this._currentRowHeaderPointerUp$.complete(), this._currentColHeaderPointerUp$.complete(), this.currentCellPosWithEvent$ = of(null), this.currentRichText$ = of(null);
  }
  _initCellDisposableListener() {
    this.disposeWithMe(this._univerInstanceService.getCurrentTypeOfUnit$(we.UNIVER_SHEET).subscribe((e) => {
      e || this._currentCell$.next(null);
    })), this.disposeWithMe(this._univerInstanceService.unitDisposed$.subscribe((e) => {
      var t8, n;
      ((t8 = this._currentCell$.getValue()) == null ? void 0 : t8.location.unitId) === e.getUnitId() && this._currentCell$.next(null), ((n = this._currentRichText$.getValue()) == null ? void 0 : n.location.unitId) === e.getUnitId() && this._currentRichText$.next(null);
    }));
  }
  _getCalcDeps(e) {
    const t8 = this._univerInstanceService.getUnit(e, we.UNIVER_SHEET);
    if (!t8)
      return null;
    const n = t8.getActiveSheet();
    if (!n)
      return null;
    const i = this._renderManagerService.getRenderById(t8.getUnitId());
    if (!i) return null;
    const o = i.with(ue).getSkeletonParam(n.getSheetId());
    if (!o) return null;
    const s = i.with(Et2);
    if (!(!(s != null && s.getCurrentScrollState()) || !i))
      return { currentRender: i, workbook: t8, worksheet: n, skeletonParam: o };
  }
  _calcActiveCell(e, t8, n, i, o, s) {
    var R, y, M7;
    const l = Lm(e, t8, n, i, o, s), a = i.skeleton;
    if (!l)
      return null;
    const { position: c, overflowLocation: d, location: u } = l, h = a.getFont(d.row, d.col);
    let g = null, m2 = null, f2 = null;
    const v2 = a.getCellWithCoordByIndex(d.row, d.col), p = n.getCell(d.row, d.col), { topOffset: S = 0, leftOffset: w = 0 } = (R = p == null ? void 0 : p.fontRenderExtension) != null ? R : {};
    if (h != null && h.documentSkeleton) {
      const { paddingLeft: E, paddingTop: T } = Cf2(v2, h, (p == null ? void 0 : p.v) !== null && (p == null ? void 0 : p.v) !== void 0 ? !Number.isNaN(+p.v) : false), P2 = $02(h.documentSkeleton, E, T), H3 = o - c.startX - w, A = s - c.startY - S;
      g = P2.links.find((x7) => x7.rects.some((V2) => V2.left <= H3 && H3 <= V2.right && V2.top <= A && A <= V2.bottom)), m2 = P2.checkLists.find((x7) => x7.rect.left <= H3 && H3 <= x7.rect.right && x7.rect.top <= A && A <= x7.rect.bottom), f2 = P2.drawings.find((x7) => x7.rect.left <= H3 && H3 <= x7.rect.right && x7.rect.top <= A && A <= x7.rect.bottom);
    }
    const C = (M7 = (y = g == null ? void 0 : g.rects.pop()) != null ? y : m2 == null ? void 0 : m2.rect) != null ? M7 : f2 == null ? void 0 : f2.rect, I2 = C && (() => {
      const E = C.top + v2.mergeInfo.startY + S, T = C.bottom + v2.mergeInfo.startY + S, P2 = C.left + v2.mergeInfo.startX + w, H3 = C.right + v2.mergeInfo.startX + w, A = v2.mergeInfo.startY + S, x7 = v2.mergeInfo.endY + S, V2 = v2.mergeInfo.startX + w, D2 = v2.mergeInfo.endX + w, X2 = Math.min(Math.max(E, A), A), B = Math.min(T, x7), j = Math.min(Math.max(P2, V2), V2), G7 = Math.min(H3, D2);
      return {
        top: X2,
        bottom: B,
        left: j,
        right: G7
      };
    })();
    return {
      location: u,
      position: c,
      overflowLocation: d,
      customRange: g == null ? void 0 : g.range,
      bullet: m2 == null ? void 0 : m2.paragraph,
      drawing: f2,
      rect: I2
    };
  }
  _calcActiveRowHeader(e, t8, n) {
    const i = this._getCalcDeps(e);
    if (!i)
      return;
    const { currentRender: o, worksheet: s, skeletonParam: l } = i, { scaleY: a } = o.scene.getAncestorScale(), c = o.scene.getViewports().find((h) => h.isHit(new U(t8, n)));
    if (!c || c.viewportKey !== k2.VIEW_ROW_TOP && c.viewportKey !== k2.VIEW_ROW_BOTTOM)
      return;
    const d = {
      x: c.viewportScrollX,
      y: c.viewportScrollY
    }, u = l.skeleton.getRowIndexByOffsetY(n, a, d);
    return { unitId: e, index: u, subUnitId: s.getSheetId() };
  }
  _calcActiveColHeader(e, t8, n) {
    const i = this._getCalcDeps(e);
    if (!i)
      return;
    const { currentRender: o, worksheet: s, skeletonParam: l } = i, { scaleX: a } = o.scene.getAncestorScale(), c = o.scene.getViewports().find((h) => h.isHit(new U(t8, n)));
    if (!c || c.viewportKey !== k2.VIEW_COLUMN_LEFT && c.viewportKey !== k2.VIEW_COLUMN_RIGHT)
      return;
    const d = {
      x: c.viewportScrollX,
      y: c.viewportScrollY
    }, u = l.skeleton.getColumnIndexByOffsetX(t8, a, d);
    return { unitId: e, index: u, subUnitId: s.getSheetId() };
  }
  triggerPointerDown(e, t8) {
    const n = this._getCalcDeps(e);
    if (!n)
      return;
    const { currentRender: i, workbook: o, worksheet: s, skeletonParam: l } = n, a = this._calcActiveCell(i, o, s, l, t8.offsetX, t8.offsetY);
    if (a && a.location) {
      const { unitId: c, subUnitId: d, row: u, col: h } = cr2(a.location);
      this._currentPointerDownCell$.next({
        unitId: c,
        subUnitId: d,
        row: u,
        col: h,
        event: t8
      });
    }
  }
  triggerPointerUp(e, t8) {
    const n = this._getCalcDeps(e);
    if (!n)
      return;
    const { currentRender: i, workbook: o, worksheet: s, skeletonParam: l } = n, a = this._calcActiveCell(i, o, s, l, t8.offsetX, t8.offsetY);
    if (a) {
      const c = cr2(a.location);
      this._currentPointerUpCell$.next({
        ...c,
        event: t8
      });
    }
  }
  triggerMouseMove(e, t8) {
    const n = this._getCalcDeps(e);
    if (!n)
      return;
    const { currentRender: i, workbook: o, worksheet: s, skeletonParam: l } = n, a = this._calcActiveCell(i, o, s, l, t8.offsetX, t8.offsetY);
    this._currentCell$.next(a && {
      location: cr2(a.location),
      position: a.position
    }), this._currentRichText$.next(a && {
      ...a,
      location: cr2(a.overflowLocation)
    }), this._currentCellWithEvent$.next(a && {
      ...a,
      location: cr2(a.location),
      event: t8
    });
  }
  /**
   * Trigger by pointerup.
   * @param unitId
   * @param offsetX
   * @param offsetY
   */
  triggerClick(e, t8, n) {
    const i = this._getCalcDeps(e);
    if (!i)
      return;
    const { currentRender: o, workbook: s, worksheet: l, skeletonParam: a } = i, c = this._calcActiveCell(o, s, l, a, t8, n);
    c && this._currentClickedCell$.next({
      ...c,
      location: cr2(c.location)
    });
  }
  triggerDbClick(e, t8, n) {
    const i = this._getCalcDeps(e);
    if (!i)
      return;
    const { currentRender: o, workbook: s, worksheet: l, skeletonParam: a } = i, c = this._calcActiveCell(o, s, l, a, t8, n);
    c && this._currentDbClickedCell$.next({
      ...c,
      location: cr2(c.location)
    });
  }
  triggerScroll() {
    this._currentCell$.next(null);
  }
  triggerRowHeaderClick(e, t8, n) {
    const i = this._calcActiveRowHeader(e, t8, n);
    i && this._currentRowHeaderClick$.next(i);
  }
  triggerColHeaderClick(e, t8, n) {
    const i = this._calcActiveColHeader(e, t8, n);
    i && this._currentColHeaderClick$.next(i);
  }
  triggerRowHeaderDbClick(e, t8, n) {
    const i = this._calcActiveRowHeader(e, t8, n);
    i && this._currentRowHeaderDbClick$.next(i);
  }
  triggerColHeaderDbClick(e, t8, n) {
    const i = this._calcActiveColHeader(e, t8, n);
    i && this._currentColHeaderDbClick$.next(i);
  }
  triggerRowHeaderMouseMove(e, t8, n) {
    this._currentHoveredRowHeader$.next(this._calcActiveRowHeader(e, t8, n));
  }
  triggerColHeaderMouseMove(e, t8, n) {
    this._currentHoveredColHeader$.next(this._calcActiveColHeader(e, t8, n));
  }
  triggerRowHeaderPoniterDown(e, t8, n) {
    const i = this._calcActiveRowHeader(e, t8, n);
    i && this._currentRowHeaderPointerDown$.next(i);
  }
  triggerColHeaderPoniterDown(e, t8, n) {
    const i = this._calcActiveColHeader(e, t8, n);
    i && this._currentColHeaderPointerDown$.next(i);
  }
  triggerRowHeaderPoniterUp(e, t8, n) {
    const i = this._calcActiveRowHeader(e, t8, n);
    i && this._currentRowHeaderPointerUp$.next(i);
  }
  triggerColHeaderPoniterUp(e, t8, n) {
    const i = this._calcActiveColHeader(e, t8, n);
    i && this._currentColHeaderPointerUp$.next(i);
  }
};
Mr3 = tb([
  bh2(0, vr),
  bh2(1, ME)
], Mr3);
var nb = Object.getOwnPropertyDescriptor;
var rb = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? nb(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var Xa3 = (r, e) => (t8, n) => e(t8, n, r);
var hl = class extends Ve {
  constructor(e, t8, n, i) {
    super();
    _2(this, "_active", false);
    this._context = e, this._hoverManagerService = t8, this._sheetSkeletonManagerService = n, this._scrollManagerService = i, this._initPointerEvent(), this._initScrollEvent();
  }
  get active() {
    return this._active;
  }
  // eslint-disable-next-line max-lines-per-function
  _initPointerEvent() {
    const e = new ao(), t8 = (n) => {
      if (e.dispose(), !n)
        return;
      const { mainComponent: i, unitId: o, components: s } = this._context;
      if (!i)
        return;
      e.add(i.onPointerEnter$.subscribeEvent((c) => {
        this._active = true;
      })), e.add(TR(i.onPointerMove$).subscribe((c) => {
        this._active = true, this._hoverManagerService.triggerMouseMove(o, c);
      })), e.add(i.onPointerDown$.subscribeEvent((c) => {
        this._hoverManagerService.triggerPointerDown(o, c);
      })), e.add(i.onPointerUp$.subscribeEvent((c) => {
        this._hoverManagerService.triggerPointerUp(o, c);
      })), e.add(i.onClick$.subscribeEvent((c) => {
        this._hoverManagerService.triggerClick(o, c.offsetX, c.offsetY);
      })), e.add(i.onDblclick$.subscribeEvent((c) => {
        this._hoverManagerService.triggerDbClick(o, c.offsetX, c.offsetY);
      })), e.add(i.onPointerLeave$.subscribeEvent(() => {
        this._active = false;
      }));
      const l = s.get(Ye3.ROW), a = s.get(Ye3.COLUMN);
      l && (e.add(l.onPointerMove$.subscribeEvent((c) => {
        this._hoverManagerService.triggerRowHeaderMouseMove(o, c.offsetX, c.offsetY);
      })), e.add(l.onPointerDown$.subscribeEvent((c) => {
        this._hoverManagerService.triggerRowHeaderPoniterDown(o, c.offsetX, c.offsetY);
      })), e.add(l.onPointerUp$.subscribeEvent((c) => {
        this._hoverManagerService.triggerRowHeaderPoniterUp(o, c.offsetX, c.offsetY), this._hoverManagerService.triggerRowHeaderClick(o, c.offsetX, c.offsetY);
      })), e.add(l.onDblclick$.subscribeEvent((c) => {
        this._hoverManagerService.triggerRowHeaderDbClick(o, c.offsetX, c.offsetY);
      }))), a && (e.add(a.onPointerMove$.subscribeEvent((c) => {
        this._hoverManagerService.triggerColHeaderMouseMove(o, c.offsetX, c.offsetY);
      })), e.add(a.onPointerDown$.subscribeEvent((c) => {
        this._hoverManagerService.triggerColHeaderPoniterDown(o, c.offsetX, c.offsetY);
      })), e.add(a.onPointerUp$.subscribeEvent((c) => {
        this._hoverManagerService.triggerColHeaderPoniterUp(o, c.offsetX, c.offsetY), this._hoverManagerService.triggerColHeaderClick(o, c.offsetX, c.offsetY);
      })), e.add(a.onDblclick$.subscribeEvent((c) => {
        this._hoverManagerService.triggerColHeaderDbClick(o, c.offsetX, c.offsetY);
      })));
    };
    t8(this._sheetSkeletonManagerService.getCurrentParam()), this.disposeWithMe(this._sheetSkeletonManagerService.currentSkeleton$.subscribe((n) => {
      t8(n);
    }));
  }
  _initScrollEvent() {
    this.disposeWithMe(this._scrollManagerService.validViewportScrollInfo$.subscribe(() => this._hoverManagerService.triggerScroll()));
  }
};
hl = rb([
  Xa3(1, Inject(Mr3)),
  Xa3(2, Inject(ue)),
  Xa3(3, Inject(Et2))
], hl);
var wf2 = "UI_PLUGIN_SHEETS";
var au2 = `${wf2}_BORDER_PANEL_COMPONENT`;
var bf2 = [
  {
    label: "borderLine.borderTop",
    icon: "UpBorderDoubleIcon",
    value: "top"
  },
  {
    label: "borderLine.borderBottom",
    icon: "DownBorderDoubleIcon",
    value: "bottom"
  },
  {
    label: "borderLine.borderLeft",
    icon: "LeftBorderDoubleIcon",
    value: "left"
  },
  {
    label: "borderLine.borderRight",
    icon: "RightBorderDoubleIcon",
    value: "right"
  },
  {
    label: "borderLine.borderNone",
    icon: "NoBorderIcon",
    value: "none"
  },
  {
    label: "borderLine.borderAll",
    icon: "AllBorderIcon",
    value: "all"
  },
  {
    label: "borderLine.borderOutside",
    icon: "OuterBorderDoubleIcon",
    value: "outside"
  },
  {
    label: "borderLine.borderInside",
    icon: "InnerBorderDoubleIcon",
    value: "inside"
  },
  {
    label: "borderLine.borderHorizontal",
    icon: "HorizontalBorderDoubleIcon",
    value: "horizontal"
  },
  {
    label: "borderLine.borderVertical",
    icon: "VerticalBorderDoubleIcon",
    value: "vertical"
  },
  {
    label: "borderLine.borderTlbr",
    icon: "BackSlashDoubleIcon",
    value: "tlbr"
  },
  {
    label: "borderLine.borderTlbcTlmr",
    icon: "LeftDoubleDiagonalDoubleIcon",
    value: "tlbc_tlmr"
  },
  {
    label: "borderLine.borderTlbrTlbcTlmr",
    icon: "LeftTridiagonalDoubleIcon",
    value: "tlbr_tlbc_tlmr"
  },
  {
    label: "borderLine.borderBlTr",
    icon: "SlashDoubleIcon",
    value: "bltr"
  },
  {
    label: "borderLine.borderMltrBctr",
    icon: "RightDoubleDiagonalDoubleIcon",
    value: "mltr_bctr"
  }
];
function ib(r) {
  return r.getCurrentTypeOfUnit$(we.UNIVER_SHEET).pipe(switchMap((e) => e ? e.activeSheet$.pipe(map((t8) => t8 ? { workbook: e, worksheet: t8 } : null)) : of(null)));
}
function pt3(r, e, t8) {
  return ib(r).pipe(switchMap((n) => n ? t8(n) : of(e)));
}
function ob(r, e) {
  const t8 = r.get(vr), n = r.get(Eo), i = r.get(z);
  return t8.getCurrentTypeOfUnit$(we.UNIVER_SHEET).pipe(
    switchMap((s) => s ? combineLatest([i.selectionMoveEnd$, s.activeSheet$]).pipe(
      switchMap(([l, a]) => {
        if (!a)
          return of(false);
        if (l.length === 0)
          return of(false);
        const c = n.getInterestGroupId(l);
        if (e) {
          const d = c.filter((u) => e.has(u));
          return of(d.length > 0);
        } else
          return of(c.length > 0);
      })
    ) : of(false))
  );
}
function zi3(r, e, t8) {
  return combineLatest([e, ob(r, t8)]).pipe(
    map(([n, i]) => n || i)
  );
}
function he2(r, e = {}, t8 = false) {
  var h;
  const i = r.get(vr).getCurrentTypeOfUnit$(we.UNIVER_SHEET), o = r.get(Rs), s = r.has(qe5) ? r.get(qe5) : null, l = r.get(Nr), c = ((h = s == null ? void 0 : s.visible$) != null ? h : of(null)).pipe(
    startWith(null),
    shareReplay(1)
  ), d = l.subscribeContextValue$(gE).pipe(
    startWith(false),
    shareReplay(1)
  );
  return combineLatest([o.currentUser$, i, c, d]).pipe(
    switchMap(([g, m2, f2, v2]) => !m2 || f2 != null && f2.visible && f2.unitId === m2.getUnitId() && !t8 || v2 && !t8 ? of(true) : m2.activeSheet$.pipe(
      switchMap((p) => {
        if (!p)
          return of(true);
        const S = r.get(z), w = r.get(me), C = r.get(lt), R = r.get(Nr).subscribeContextValue$(PR).pipe(startWith(false));
        return combineLatest([S.selectionMoveEnd$, R]).pipe(
          switchMap(([y, M7]) => {
            if (M7)
              return of(true);
            const E = m2.getUnitId(), T = p.getSheetId(), P2 = r.get(eC), { workbookTypes: H3 = [Pe], worksheetTypes: A, rangeTypes: x7 } = e, V2 = [];
            if (H3 == null || H3.forEach((j) => {
              V2.push(new j(E).id);
            }), A == null || A.forEach((j) => {
              V2.push(new j(E, T).id);
            }), C.getRule(E, T))
              return P2.composePermission$(V2).pipe(map((j) => j.some((G7) => G7.value === false)));
            const X2 = y == null ? void 0 : y.map((j) => j.range), B = w.getSubunitRuleList(E, T).filter((j) => X2 == null ? void 0 : X2.some((G7) => j.ranges.some((ge2) => En.intersects(G7, ge2))));
            return x7 == null || x7.forEach((j) => {
              B.forEach((G7) => {
                V2.push(new j(E, T, G7.permissionId).id);
              });
            }), P2.composePermission$(V2).pipe(map((j) => j.some((G7) => G7.value === false)));
          })
        );
      })
    ))
  );
}
function ji3(r) {
  const e = r.get(vr), t8 = r.get(z), n = r.get(me), i = r.get(eC);
  return merge(t8.selectionMoveEnd$, i.permissionPointUpdate$.pipe(debounceTime(100))).pipe(
    map(() => {
      var u;
      const o = (u = t8.getCurrentLastSelection()) == null ? void 0 : u.range;
      if (!o) return true;
      const s = e.getCurrentUnitForType(we.UNIVER_SHEET), l = s == null ? void 0 : s.getActiveSheet();
      if (!s || !l)
        return true;
      const a = s.getUnitId(), c = l.getSheetId(), d = [new Pe(a).id, new Ve2(a, c).id];
      return n.getSubunitRuleList(a, c).filter((h) => h.ranges.some((g) => En.intersects(o, g))).forEach((h) => {
        d.push(new Le2(a, c, h.permissionId).id);
      }), i.composePermission(d).some((h) => h.value === false);
    })
  );
}
function _f2(r, e) {
  const t8 = r.get(vr), n = r.get(z), i = r.get(me), o = r.get(eC);
  return merge(n.selectionMoveEnd$, o.permissionPointUpdate$.pipe(debounceTime(100))).pipe(
    map(() => {
      var h;
      const s = (h = n.getCurrentLastSelection()) == null ? void 0 : h.range;
      if (!s) return true;
      const l = t8.getCurrentUnitForType(we.UNIVER_SHEET), a = l == null ? void 0 : l.getActiveSheet();
      if (!l || !a)
        return true;
      const c = l.getUnitId(), d = a.getSheetId(), u = [new Pe(c).id, new Ve2(c, d).id];
      return i.getSubunitRuleList(c, d).filter((g) => e === "row" ? g.ranges.some((m2) => s.startRow > m2.startRow && s.startRow <= m2.endRow) : g.ranges.some((m2) => s.startColumn > m2.startColumn && s.startColumn <= m2.endColumn)).forEach((g) => {
        u.push(new Le2(c, d, g.permissionId).id);
      }), o.composePermission(u).some((g) => g.value === false);
    })
  );
}
function Rf2(r, e) {
  const t8 = r.get(vr), n = r.get(z), i = r.get(me), o = r.get(eC);
  return merge(n.selectionMoveEnd$, o.permissionPointUpdate$.pipe(debounceTime(100))).pipe(
    map(() => {
      var g;
      const s = (g = n.getCurrentLastSelection()) == null ? void 0 : g.range;
      if (!s) return true;
      const l = t8.getCurrentUnitForType(we.UNIVER_SHEET), a = l == null ? void 0 : l.getActiveSheet();
      if (!l || !a)
        return true;
      const c = l.getUnitId(), d = a.getSheetId(), u = [new Pe(c).id, new Ve2(c, d).id], h = J.deepClone(s);
      return e === "row" ? (h.startColumn = 0, h.endColumn = a.getColumnCount() - 1) : (h.startRow = 0, h.endRow = a.getRowCount() - 1), i.getSubunitRuleList(c, d).filter((m2) => m2.ranges.some((f2) => En.intersects(h, f2))).forEach((m2) => {
        u.push(new Le2(c, d, m2.permissionId).id);
      }), o.composePermission(u).some((m2) => m2.value === false);
    })
  );
}
function Oa2(r, e) {
  const t8 = r.get(vr), n = r.get(z), i = r.get(me), o = r.get(eC);
  return merge(n.selectionMoveEnd$, o.permissionPointUpdate$.pipe(debounceTime(100))).pipe(
    map(() => {
      var g;
      const s = (g = n.getCurrentLastSelection()) == null ? void 0 : g.range;
      if (!s) return true;
      const l = t8.getCurrentUnitForType(we.UNIVER_SHEET), a = l == null ? void 0 : l.getActiveSheet();
      if (!l || !a)
        return true;
      const c = l.getUnitId(), d = a.getSheetId(), u = [new Pe(c).id, new Ve2(c, d).id], h = J.deepClone(s);
      return e === "row" ? h.endRow = a.getRowCount() - 1 : h.endColumn = a.getColumnCount() - 1, i.getSubunitRuleList(c, d).filter((m2) => m2.ranges.some((f2) => En.intersects(h, f2))).forEach((m2) => {
        u.push(new Le2(c, d, m2.permissionId).id);
      }), o.composePermission(u).some((m2) => m2.value === false);
    })
  );
}
function Yi2(r, e) {
  const n = r.get(vr).getCurrentTypeOfUnit$(we.UNIVER_SHEET), i = r.get(lt), o = r.get(me), s = r.get(eC), l = r.get(Rs);
  return combineLatest([l.currentUser$, n]).pipe(
    switchMap(([a, c]) => c ? c.activeSheet$.pipe(
      switchMap((d) => {
        if (!d)
          return of(true);
        const u = c.getUnitId(), h = [];
        return e.forEach((m2) => h.push(new m2(u).id)), s.composePermission$(h).pipe(map((m2) => m2.every((f2) => f2.value === true))).pipe(
          map((m2) => {
            if (!m2)
              return true;
            const f2 = d.getSheetId(), v2 = i.getRule(u, f2), p = o.getSubunitRuleList(u, f2);
            return !!(v2 || p.length);
          })
        );
      })
    ) : of(true))
  );
}
function sb(r) {
  const e = r.get(Ft2), t8 = he2(r, { workbookTypes: [Pe], worksheetTypes: [Ve2, yr], rangeTypes: [Le2] });
  return {
    id: kc.id,
    icon: new Observable((n) => {
      const i = "AllBorderIcon", o = r.get(Ft2), s = r.get(Ls).onCommandExecuted((l) => {
        var h;
        if (l.id !== kc.id)
          return;
        const { type: c } = o.getBorderInfo(), d = bf2.find((g) => g.value === c), u = (h = d == null ? void 0 : d.icon) != null ? h : i;
        n.next(u);
      });
      return n.next(i), s.dispose;
    }),
    tooltip: "toolbar.border.main",
    type: H1.BUTTON_SELECTOR,
    slot: true,
    selections: [
      {
        label: {
          name: au2,
          hoverable: false,
          selectable: false
        },
        value$: e.borderInfo$
      }
    ],
    value$: e.borderInfo$,
    hidden$: Bi(r, we.UNIVER_SHEET),
    disabled$: t8
  };
}
var Hs2 = "sheet.menu.clear-selection";
function za2(r) {
  return {
    id: Hs2,
    type: H1.SUBITEMS,
    icon: "ClearFormatDoubleIcon",
    title: "rightClick.clearSelection",
    hidden$: Bi(r, we.UNIVER_SHEET)
  };
}
function ja2(r) {
  return {
    id: qs.id,
    type: H1.BUTTON,
    icon: "ClearFormatDoubleIcon",
    title: "rightClick.clearContent",
    disabled$: zi3(r, he2(r, {
      workbookTypes: [Pe],
      worksheetTypes: [Ve2, An],
      rangeTypes: [Le2]
    })),
    hidden$: Bi(r, we.UNIVER_SHEET)
  };
}
function Ya2(r) {
  return {
    id: Ls2.id,
    type: H1.BUTTON,
    icon: "ClearFormatDoubleIcon",
    title: "rightClick.clearFormat",
    disabled$: he2(r, {
      workbookTypes: [Pe],
      worksheetTypes: [Ve2, yr],
      rangeTypes: [Le2]
    }),
    hidden$: Bi(r, we.UNIVER_SHEET)
  };
}
function _s2(r) {
  return {
    id: Ws.id,
    type: H1.BUTTON,
    icon: "ClearFormatDoubleIcon",
    title: "rightClick.clearAll",
    tooltip: "rightClick.clearAll",
    disabled$: zi3(r, he2(r, {
      workbookTypes: [Pe],
      worksheetTypes: [Ve2, An, yr],
      rangeTypes: [Le2]
    })),
    hidden$: Bi(r, we.UNIVER_SHEET)
  };
}
var If2 = "sheet.menu.delete";
function lb(r) {
  return {
    id: If2,
    type: H1.SUBITEMS,
    title: "rightClick.delete",
    icon: "ReduceDoubleIcon",
    hidden$: zi3(r, ji3(r)),
    disabled$: he2(r, { workbookTypes: [Pe], worksheetTypes: [Ve2] })
  };
}
function _h2(r) {
  return {
    id: Eo4.id,
    type: H1.BUTTON,
    icon: "DeleteColumnDoubleIcon",
    title: "rightClick.deleteSelectedColumn",
    hidden$: Rf2(r, "col"),
    disabled$: he2(r, { workbookTypes: [Pe, Ku], worksheetTypes: [Ve2, fr] })
  };
}
function Rh2(r) {
  return {
    id: Mo3.id,
    type: H1.BUTTON,
    icon: "DeleteRowDoubleIcon",
    title: "rightClick.deleteSelectedRow",
    disabled$: he2(r, { workbookTypes: [Pe, Ju2], worksheetTypes: [Ve2, Cr] }),
    hidden$: Rf2(r, "row")
  };
}
function ab(r) {
  return {
    id: ts2.id,
    type: H1.BUTTON,
    title: "rightClick.moveLeft",
    icon: "DeleteCellShiftLeftDoubleIcon",
    disabled$: he2(r, { workbookTypes: [Pe], worksheetTypes: [Ve2], rangeTypes: [Le2] }),
    hidden$: Oa2(r, "col")
  };
}
function cb(r) {
  return {
    id: pi3.id,
    type: H1.BUTTON,
    title: "rightClick.moveUp",
    icon: "DeleteCellShiftUpDoubleIcon",
    disabled$: he2(r, { workbookTypes: [Pe], worksheetTypes: [Ve2], rangeTypes: [Le2] }),
    hidden$: Oa2(r, "row")
  };
}
function db(r) {
  const e = r.get(Ls), t8 = r.get(vr);
  return {
    id: ld.id,
    type: H1.BUTTON,
    tooltip: "toolbar.toggleGridlines",
    icon: "HideGridlinesDoubleIcon",
    activated$: new Observable((n) => {
      const i = () => {
        const s = t8.getCurrentUnitForType(we.UNIVER_SHEET);
        return s ? s.getActiveSheet().getConfig().showGridlines === ie.TRUE : false;
      }, o = new ao();
      return o.add(e.onCommandExecuted((s) => {
        (s.id === Zt2.id || s.id === pn2.id) && n.next(i());
      })), o.add(t8.getCurrentTypeOfUnit$(we.UNIVER_SHEET).subscribe(() => {
        n.next(i());
      })), n.next(i()), () => o.dispose();
    }),
    disabled$: he2(r, { workbookTypes: [Pe], worksheetTypes: [Ve2] })
  };
}
var Sn3 = `${wf2}_MENU_ITEM_INPUT_COMPONENT`;
var yf2 = (r) => {
  const { prefix: e, suffix: t8, value: n, onChange: i, min: o = Number.MIN_SAFE_INTEGER, max: s = Number.MAX_SAFE_INTEGER } = r, l = useDependency(Fn), a = useDependency(c32), [c, d] = (0, import_react4.useState)(), u = (g) => {
    if (!g) {
      d(o.toString());
      return;
    }
    const m2 = g.toString();
    d(m2), i(m2);
  };
  (0, import_react4.useEffect)(() => {
    a.visible || d(n);
  }, [a.visible]), (0, import_react4.useEffect)(() => {
    +n < o ? d(o.toString()) : +n > s ? d(s.toString()) : d(n);
  }, [n]);
  function h() {
    c && i(c);
  }
  return (0, import_jsx_runtime4.jsxs)("div", { className: "univer-inline-flex univer-items-center univer-gap-1", children: [
    l.t(e),
    (0, import_jsx_runtime4.jsx)("div", { className: "univer-w-16", onClick: (g) => g.stopPropagation(), children: (0, import_jsx_runtime4.jsx)(
      xE2,
      {
        value: Number(c),
        size: "mini",
        precision: 0,
        min: o,
        max: s,
        onPressEnter: h,
        onChange: u
      }
    ) }),
    l.t(t8)
  ] });
};
var Mf2 = "sheet.menu.cell-insert";
function ub2(r) {
  return {
    id: Mf2,
    type: H1.SUBITEMS,
    title: "rightClick.insert",
    icon: "InsertDoubleIcon",
    hidden$: zi3(r, ji3(r)),
    disabled$: he2(r, { workbookTypes: [Pe, Yu, Xu], worksheetTypes: [wr, vr3, Ve2], rangeTypes: [Le2] })
  };
}
function hb(r) {
  const e = r.get(vr), t8 = r.get(z), n = r.get(Ls), i = 1;
  return {
    id: Qu.id,
    type: H1.BUTTON,
    icon: "InsertRowAboveDoubleIcon",
    label: {
      name: Sn3,
      props: {
        prefix: "rightClick.insertRowsAbove",
        min: 1,
        max: 1e3,
        suffix: "rightClick.insertRowsAboveSuffix"
      }
    },
    value$: pt3(e, i, () => new Observable((o) => {
      function s() {
        var d;
        const a = (d = t8.getCurrentLastSelection()) == null ? void 0 : d.range;
        let c = i;
        a && (c = (a == null ? void 0 : a.endRow) - (a == null ? void 0 : a.startRow) + 1), o.next(c);
      }
      const l = n.onCommandExecuted((a) => {
        if (a.id === ie3.id)
          return s();
      });
      return s(), l.dispose;
    })),
    disabled$: he2(r, { workbookTypes: [Pe, Xu], worksheetTypes: [vr3, Ve2], rangeTypes: [Le2] }),
    hidden$: _f2(r, "row")
  };
}
function gb(r) {
  const e = r.get(vr), t8 = r.get(z), n = r.get(Ls), i = 1;
  return {
    id: sl.id,
    type: H1.BUTTON,
    icon: "LeftInsertColumnDoubleIcon",
    label: {
      name: Sn3,
      props: {
        prefix: "rightClick.insertColsLeft",
        min: 1,
        max: 1e3,
        suffix: "rightClick.insertColsLeftSuffix"
      }
    },
    value$: pt3(e, i, () => new Observable((o) => {
      function s() {
        var d;
        const a = (d = t8.getCurrentLastSelection()) == null ? void 0 : d.range;
        let c = i;
        a && (c = (a == null ? void 0 : a.endColumn) - (a == null ? void 0 : a.startColumn) + 1), o.next(c);
      }
      const l = n.onCommandExecuted((a) => {
        if (a.id === ie3.id)
          return s();
      });
      return s(), l.dispose;
    })),
    disabled$: he2(r, { workbookTypes: [Pe, Yu], worksheetTypes: [wr, Ve2], rangeTypes: [Le2] }),
    hidden$: _f2(r, "col")
  };
}
function mb(r) {
  return {
    id: ns2.id,
    type: H1.BUTTON,
    title: "rightClick.moveRight",
    icon: "InsertCellShiftRightDoubleIcon",
    disabled$: he2(r, { workbookTypes: [Pe], worksheetTypes: [Ve2], rangeTypes: [Le2] }),
    hidden$: Oa2(r, "col")
  };
}
function fb(r) {
  return {
    id: vi3.id,
    type: H1.BUTTON,
    title: "rightClick.moveDown",
    icon: "InsertCellDownDoubleIcon",
    disabled$: he2(r, { workbookTypes: [Pe], worksheetTypes: [Ve2], rangeTypes: [Le2] }),
    hidden$: Oa2(r, "row")
  };
}
function pb(r) {
  const e = r.get(vr), t8 = r.get(z), n = r.get(Ls), i = 1;
  return {
    id: nl.id,
    type: H1.BUTTON,
    icon: "InsertRowBelowDoubleIcon",
    label: {
      name: Sn3,
      props: {
        prefix: "rightClick.insertRowsAfter",
        min: 1,
        max: 1e3,
        suffix: "rightClick.insertRowsAfterSuffix"
      }
    },
    value$: pt3(e, i, () => new Observable((o) => {
      function s() {
        var d;
        const a = (d = t8.getCurrentLastSelection()) == null ? void 0 : d.range;
        let c = i;
        a && (c = (a == null ? void 0 : a.endRow) - (a == null ? void 0 : a.startRow) + 1), o.next(c);
      }
      const l = n.onCommandExecuted((a) => {
        if (a.id === ie3.id)
          return s();
      });
      return s(), l.dispose;
    })),
    disabled$: he2(r, { workbookTypes: [Pe, Xu], worksheetTypes: [vr3, Ve2], rangeTypes: [Le2] }),
    hidden$: ji3(r)
  };
}
function vb(r) {
  const e = r.get(vr), t8 = r.get(z), n = r.get(Ls), i = 1;
  return {
    id: tl.id,
    type: H1.BUTTON,
    icon: "InsertRowAboveDoubleIcon",
    label: {
      name: Sn3,
      props: {
        prefix: "rightClick.insertRowsAbove",
        min: 1,
        max: 1e3,
        suffix: "rightClick.insertRowsAboveSuffix"
      }
    },
    value$: pt3(e, i, () => new Observable((o) => {
      function s() {
        var d;
        const a = (d = t8.getCurrentLastSelection()) == null ? void 0 : d.range;
        let c = i;
        a && (c = (a == null ? void 0 : a.endRow) - (a == null ? void 0 : a.startRow) + 1), o.next(c);
      }
      const l = n.onCommandExecuted((a) => {
        if (a.id === ie3.id)
          return s();
      });
      return s(), l.dispose;
    })),
    disabled$: he2(r, { workbookTypes: [Pe, Xu], worksheetTypes: [vr3, Ve2], rangeTypes: [Le2] }),
    hidden$: ji3(r)
  };
}
function Sb(r) {
  const e = r.get(vr), t8 = r.get(z), n = r.get(Ls), i = 1;
  return {
    id: rl.id,
    type: H1.BUTTON,
    icon: "LeftInsertColumnDoubleIcon",
    label: {
      name: Sn3,
      props: {
        prefix: "rightClick.insertColsLeft",
        min: 1,
        max: 1e3,
        suffix: "rightClick.insertColsLeftSuffix"
      }
    },
    value$: pt3(e, i, () => new Observable((o) => {
      function s() {
        var d;
        const a = (d = t8.getCurrentLastSelection()) == null ? void 0 : d.range;
        let c = i;
        a && (c = (a == null ? void 0 : a.endColumn) - (a == null ? void 0 : a.startColumn) + 1), o.next(c);
      }
      const l = n.onCommandExecuted((a) => {
        if (a.id === ie3.id)
          return s();
      });
      return s(), l.dispose;
    })),
    disabled$: he2(r, { workbookTypes: [Pe, Yu], worksheetTypes: [wr, Ve2], rangeTypes: [Le2] }),
    hidden$: ji3(r)
  };
}
function Cb(r) {
  const e = r.get(vr), t8 = r.get(z), n = r.get(Ls), i = 1;
  return {
    id: il.id,
    type: H1.BUTTON,
    icon: "RightInsertColumnDoubleIcon",
    label: {
      name: Sn3,
      props: {
        prefix: "rightClick.insertColsRight",
        min: 1,
        max: 1e3,
        suffix: "rightClick.insertColsRightSuffix"
      }
    },
    value$: pt3(e, i, () => new Observable((o) => {
      function s() {
        var d;
        const a = (d = t8.getCurrentLastSelection()) == null ? void 0 : d.range;
        let c = i;
        a && (c = (a == null ? void 0 : a.endColumn) - (a == null ? void 0 : a.startColumn) + 1), o.next(c);
      }
      const l = n.onCommandExecuted((a) => {
        if (a.id === ie3.id)
          return s();
      });
      return s(), l.dispose;
    })),
    disabled$: he2(r, { workbookTypes: [Pe, Yu], worksheetTypes: [wr, Ve2], rangeTypes: [Le2] }),
    hidden$: ji3(r)
  };
}
var wb = ((r) => (r.ROW_HEADER_CONTEXT_MENU = "ROW_HEADER_CONTEXT_MENU", r.COL_HEADER_CONTEXT_MENU = "COL_HEADER_CONTEXT_MENU", r.SHEET_BAR = "SHEET_BAR", r.SHEET_FOOTER = "SHEET_FOOTER", r))(wb || {});
function bb(r) {
  const e = r.get(Dn2);
  return {
    id: rs2.id,
    subId: Qd2.id,
    type: H1.BUTTON,
    icon: "BrushIcon",
    title: "Format Painter",
    tooltip: "toolbar.formatPainter",
    activated$: new Observable((t8) => {
      let n = false;
      const i = e.status$.subscribe((o) => {
        n = o !== zt4.OFF, t8.next(n);
      });
      return t8.next(n), () => {
        i.unsubscribe();
      };
    }),
    hidden$: Bi(r, we.UNIVER_SHEET),
    disabled$: he2(r, { workbookTypes: [Pe], worksheetTypes: [mr, Ve2], rangeTypes: [Le2] }, true)
  };
}
function _b(r) {
  const e = r.get(Ls), t8 = r.get(vr), n = r.get(Nr), i = r.get(z);
  return {
    id: Bi3.id,
    type: H1.BUTTON,
    icon: "BoldIcon",
    title: "Set bold",
    tooltip: "toolbar.bold",
    disabled$: he2(r, { workbookTypes: [Pe], worksheetTypes: [Ve2, yr], rangeTypes: [Le2] }, true),
    activated$: pt3(t8, false, ({ worksheet: o }) => new Observable((s) => {
      var d;
      const l = e.onCommandExecuted((u) => {
        var g, m2;
        const h = u.id;
        if (h === ee.id || h === ie3.id || h === pn2.id) {
          const f2 = (g = i.getCurrentLastSelection()) == null ? void 0 : g.primary;
          let v2 = Si.NORMAL;
          if (f2 != null) {
            const p = o.getRange(f2.startRow, f2.startColumn);
            v2 = p == null ? void 0 : p.getFontWeight();
          }
          s.next(v2 === Si.BOLD);
        }
        if ((h === k.id || h === yt2.id) && n.getContextValue(mE) && n.getContextValue(gr)) {
          const f2 = ds3(r);
          if (f2 == null)
            return;
          const v2 = (m2 = f2.ts) == null ? void 0 : m2.bl;
          s.next(v2 === ie.TRUE);
        }
      }), a = (d = i.getCurrentLastSelection()) == null ? void 0 : d.primary;
      if (!o) {
        s.next(false);
        return;
      }
      let c = Si.NORMAL;
      if (a != null) {
        const u = o.getRange(a.startRow, a.startColumn);
        c = u == null ? void 0 : u.getFontWeight();
      }
      return s.next(c === Si.BOLD), l.dispose;
    })),
    hidden$: Bi(r, we.UNIVER_SHEET)
  };
}
function Rb(r) {
  const e = r.get(Ls), t8 = r.get(vr), n = r.get(z), i = r.get(Nr);
  return {
    id: Fi3.id,
    type: H1.BUTTON,
    icon: "ItalicIcon",
    title: "Set italic",
    tooltip: "toolbar.italic",
    disabled$: he2(
      r,
      {
        workbookTypes: [Pe],
        worksheetTypes: [Ve2, yr],
        rangeTypes: [Le2]
      },
      true
    ),
    activated$: pt3(t8, false, ({ worksheet: o }) => new Observable((s) => {
      var d;
      const l = e.onCommandExecuted((u) => {
        var g, m2;
        const h = u.id;
        if (h === ee.id || h === ie3.id || h === pn2.id) {
          const f2 = (g = n.getCurrentLastSelection()) == null ? void 0 : g.primary;
          let v2 = wi.NORMAL;
          if (f2 != null) {
            const p = o.getRange(f2.startRow, f2.startColumn);
            v2 = p == null ? void 0 : p.getFontStyle();
          }
          s.next(v2 === wi.ITALIC);
        }
        if ((h === k.id || h === yt2.id) && i.getContextValue(mE) && i.getContextValue(gr)) {
          const f2 = ds3(r);
          if (f2 == null) return;
          const v2 = (m2 = f2.ts) == null ? void 0 : m2.it;
          s.next(v2 === ie.TRUE);
        }
      }), a = (d = n.getCurrentLastSelection()) == null ? void 0 : d.primary;
      let c = wi.NORMAL;
      if (a != null) {
        const u = o.getRange(a.startRow, a.startColumn);
        c = u == null ? void 0 : u.getFontStyle();
      }
      return s.next(c === wi.ITALIC), l.dispose;
    })),
    hidden$: Bi(r, we.UNIVER_SHEET)
  };
}
function Ib(r) {
  const e = r.get(Ls), t8 = r.get(vr), n = r.get(z), i = r.get(Nr);
  return {
    id: Ui3.id,
    type: H1.BUTTON,
    icon: "UnderlineIcon",
    title: "Set underline",
    tooltip: "toolbar.underline",
    activated$: pt3(t8, false, ({ worksheet: o }) => new Observable((s) => {
      var d;
      const l = e.onCommandExecuted((u) => {
        var g, m2;
        const h = u.id;
        if (h === ee.id || h === ie3.id || h === pn2.id) {
          const f2 = (g = n.getCurrentLastSelection()) == null ? void 0 : g.primary;
          let v2;
          if (f2 != null) {
            const p = o.getRange(f2.startRow, f2.startColumn);
            v2 = p == null ? void 0 : p.getUnderline();
          }
          s.next(!!(v2 && v2.s));
        }
        if ((h === k.id || h === yt2.id) && i.getContextValue(mE) && i.getContextValue(gr)) {
          const f2 = ds3(r);
          if (f2 == null) return;
          const v2 = (m2 = f2.ts) == null ? void 0 : m2.ul;
          s.next((v2 == null ? void 0 : v2.s) === ie.TRUE);
        }
      }), a = (d = n.getCurrentLastSelection()) == null ? void 0 : d.primary;
      let c;
      if (a != null) {
        const u = o.getRange(a.startRow, a.startColumn);
        c = u == null ? void 0 : u.getUnderline();
      }
      return s.next(!!(c && c.s)), l.dispose;
    })),
    disabled$: he2(r, {
      workbookTypes: [Pe],
      worksheetTypes: [Ve2, yr],
      rangeTypes: [Le2]
    }, true),
    hidden$: Bi(r, we.UNIVER_SHEET)
  };
}
function yb(r) {
  const e = r.get(Ls), t8 = r.get(vr), n = r.get(z), i = r.get(Nr);
  return {
    id: Xi2.id,
    type: H1.BUTTON,
    icon: "StrikethroughIcon",
    title: "Set strike through",
    tooltip: "toolbar.strikethrough",
    disabled$: he2(r, {
      workbookTypes: [Pe],
      worksheetTypes: [Ve2, yr],
      rangeTypes: [Le2]
    }, true),
    activated$: pt3(t8, false, ({ worksheet: o }) => new Observable((s) => {
      var d;
      const l = e.onCommandExecuted((u) => {
        var g, m2;
        const h = u.id;
        if (h === ee.id || h === ie3.id || h === pn2.id) {
          const f2 = (g = n.getCurrentLastSelection()) == null ? void 0 : g.primary;
          let v2;
          if (f2 != null) {
            const p = o.getRange(f2.startRow, f2.startColumn);
            v2 = p == null ? void 0 : p.getStrikeThrough();
          }
          s.next(!!(v2 && v2.s));
        }
        if ((h === k.id || h === yt2.id) && i.getContextValue(mE) && i.getContextValue(gr)) {
          const f2 = ds3(r);
          if (f2 == null)
            return;
          const v2 = (m2 = f2.ts) == null ? void 0 : m2.st;
          s.next((v2 == null ? void 0 : v2.s) === ie.TRUE);
        }
      }), a = (d = n.getCurrentLastSelection()) == null ? void 0 : d.primary;
      let c;
      if (a != null) {
        const u = o.getRange(a.startRow, a.startColumn);
        c = u == null ? void 0 : u.getStrikeThrough();
      }
      return s.next(!!(c && c.s)), l.dispose;
    })),
    hidden$: Bi(r, we.UNIVER_SHEET)
  };
}
function Mb(r) {
  const e = r.get(Ls), t8 = r.get(vr), n = r.get(z), i = rt.ff;
  return {
    id: ha2.id,
    tooltip: "toolbar.font",
    type: H1.SELECTOR,
    label: w5,
    selections: ki.map((o) => ({
      label: {
        name: _5
      },
      value: o.value
    })),
    disabled$: he2(r, {
      workbookTypes: [Pe],
      worksheetTypes: [Ve2, yr],
      rangeTypes: [Le2]
    }, true),
    value$: pt3(t8, i, ({ worksheet: o }) => new Observable((s) => {
      const l = () => {
        var u;
        let c = i;
        const d = (u = n.getCurrentLastSelection()) == null ? void 0 : u.primary;
        if (d != null) {
          const h = o.getCellStyle(d.startRow, d.startColumn), g = o.getDefaultCellStyleInternal(), m2 = o.getRowStyle(d.startRow), f2 = o.getColumnStyle(d.startColumn), v2 = xr(g, m2, f2, h);
          v2.ff && (c = v2.ff);
        }
        s.next(c);
      }, a = e.onCommandExecuted((c) => {
        const d = c.id;
        (d === ee.id || d === ie3.id || d === pn2.id) && l();
      });
      return l(), a.dispose;
    })),
    hidden$: Bi(r, we.UNIVER_SHEET)
  };
}
function Eb(r) {
  const e = r.get(Ls), t8 = r.get(vr), n = r.get(z), i = r.get(Nr), o = rt.fs, s = he2(r, {
    workbookTypes: [Pe],
    worksheetTypes: [Ve2, yr],
    rangeTypes: [Le2]
  }, true);
  return {
    id: ua.id,
    type: H1.SELECTOR,
    tooltip: "toolbar.fontSize",
    label: {
      name: M5,
      props: {
        min: 1,
        max: 400,
        disabled$: s
      }
    },
    selections: ji,
    disabled$: s,
    value$: pt3(t8, o, ({ worksheet: l }) => new Observable((a) => {
      const c = () => {
        var m2;
        let h = o;
        const g = (m2 = n.getCurrentLastSelection()) == null ? void 0 : m2.primary;
        if (g != null) {
          const f2 = l.getComposedCellStyle(g.startRow, g.startColumn);
          f2.fs && (h = f2.fs);
        }
        a.next(h);
      }, d = () => {
        var g, m2;
        const h = ds3(r);
        if (h != null) {
          const f2 = (m2 = (g = h.ts) == null ? void 0 : g.fs) != null ? m2 : o;
          a.next(f2);
        }
      }, u = e.onCommandExecuted((h) => {
        const g = h.id;
        (g === ee.id || g === ie3.id || g === pn2.id) && c(), (g === k.id || g === yt2.id) && i.getContextValue(mE) && i.getContextValue(gr) && d();
      });
      return c(), u.dispose;
    })),
    hidden$: Bi(r, we.UNIVER_SHEET)
  };
}
function Tb(r) {
  return {
    id: qd2.id,
    type: H1.BUTTON,
    title: "toolbar.resetColor",
    icon: "NoColorDoubleIcon",
    disabled$: he2(r, {
      workbookTypes: [Pe],
      worksheetTypes: [Ve2, yr],
      rangeTypes: [Le2]
    }, true),
    hidden$: Bi(r, we.UNIVER_SHEET)
  };
}
function Pb(r) {
  const e = r.get(Ls), t8 = r.get(Gi), n = r.get(z);
  return {
    id: Io3.id,
    icon: "FontColorDoubleIcon",
    tooltip: "toolbar.textColor.main",
    type: H1.BUTTON_SELECTOR,
    selections: [
      {
        label: {
          name: m5,
          hoverable: false,
          selectable: false
        },
        value$: new Observable((i) => {
          var a;
          const o = rt.cl.rgb, { isAllValuesSame: s, value: l } = n.getCellStylesProperty("cl");
          s ? i.next((a = l == null ? void 0 : l.rgb) != null ? a : o) : i.next(o);
        })
      }
    ],
    value$: new Observable((i) => {
      const o = t8.getColorFromTheme("gray.900"), s = e.onCommandExecuted((l) => {
        if (l.id === Io3.id) {
          const a = l.params.value;
          i.next(a != null ? a : o);
        }
      });
      return i.next(o), s.dispose;
    }),
    hidden$: Bi(r, we.UNIVER_SHEET),
    disabled$: he2(r, {
      workbookTypes: [Pe],
      worksheetTypes: [Ve2, yr],
      rangeTypes: [Le2]
    }, true)
  };
}
function xb(r) {
  return {
    id: jc.id,
    type: H1.BUTTON,
    title: "toolbar.resetColor",
    icon: "NoColorDoubleIcon",
    disabled$: he2(r, {
      workbookTypes: [Pe],
      worksheetTypes: [Ve2, yr],
      rangeTypes: [Le2]
    })
  };
}
function Ob(r) {
  const e = r.get(Ls), t8 = r.get(Gi), n = r.get(z);
  return {
    id: Bc2.id,
    tooltip: "toolbar.fillColor.main",
    type: H1.BUTTON_SELECTOR,
    icon: "PaintBucketDoubleIcon",
    selections: [
      {
        label: {
          name: m5,
          hoverable: false,
          selectable: false
        },
        value$: new Observable((i) => {
          var a;
          const o = rt.bg.rgb, { isAllValuesSame: s, value: l } = n.getCellStylesProperty("bg");
          s ? i.next((a = l == null ? void 0 : l.rgb) != null ? a : o) : i.next(o);
        })
      }
    ],
    value$: new Observable((i) => {
      const o = t8.getColorFromTheme("primary.600"), s = e.onCommandExecuted((l) => {
        if (l.id === Bc2.id) {
          const a = l.params.value;
          i.next(a != null ? a : o);
        }
      });
      return i.next(o), s.dispose;
    }),
    hidden$: Bi(r, we.UNIVER_SHEET),
    disabled$: he2(r, {
      workbookTypes: [Pe],
      worksheetTypes: [Ve2, yr],
      rangeTypes: [Le2]
    })
  };
}
var Ih3 = [
  {
    label: "align.left",
    icon: "LeftJustifyingIcon",
    value: Ut.LEFT
  },
  {
    label: "align.center",
    icon: "HorizontallyIcon",
    value: Ut.CENTER
  },
  {
    label: "align.right",
    icon: "RightJustifyingIcon",
    value: Ut.RIGHT
  }
];
function Ab(r) {
  var s, l;
  const e = r.get(vr), t8 = r.get(z), n = e.getCurrentUnitOfType(we.UNIVER_SHEET), i = n == null ? void 0 : n.getActiveSheet().getDefaultCellStyleInternal(), o = (s = i == null ? void 0 : i.ht) != null ? s : Ut.LEFT;
  return {
    id: Gc.id,
    icon: (l = Ih3.find((a) => a.value === o)) == null ? void 0 : l.icon,
    tooltip: "toolbar.horizontalAlignMode.main",
    type: H1.SELECTOR,
    selections: Ih3,
    value$: pt3(e, o, ({ worksheet: a }) => new Observable((c) => {
      var g, m2;
      const d = r.get(Ls).onCommandExecuted((f2) => {
        var w, C;
        const v2 = f2.id;
        if (v2 !== Gc.id && v2 !== ie3.id && v2 !== pn2.id)
          return;
        const p = (w = t8.getCurrentLastSelection()) == null ? void 0 : w.primary;
        let S;
        if (p != null) {
          const I2 = a.getRange(p.startRow, p.startColumn), R = n == null ? void 0 : n.getActiveSheet().getComposedCellStyle(p.startRow, p.startColumn);
          S = (C = R == null ? void 0 : R.ht) != null ? C : I2 == null ? void 0 : I2.getHorizontalAlignment();
        }
        c.next(S != null ? S : o);
      }), u = (g = t8.getCurrentLastSelection()) == null ? void 0 : g.primary;
      let h;
      if (u != null) {
        const f2 = a.getRange(u.startRow, u.startColumn), v2 = n == null ? void 0 : n.getActiveSheet().getComposedCellStyle(u.startRow, u.startColumn);
        h = (m2 = v2 == null ? void 0 : v2.ht) != null ? m2 : f2 == null ? void 0 : f2.getHorizontalAlignment();
      }
      return c.next(h != null ? h : o), d.dispose;
    })),
    hidden$: Bi(r, we.UNIVER_SHEET),
    disabled$: he2(r, {
      workbookTypes: [Pe],
      worksheetTypes: [Ve2, yr],
      rangeTypes: [Le2]
    })
  };
}
var yh2 = [
  {
    label: "align.top",
    icon: "AlignTopIcon",
    value: xn.TOP
  },
  {
    label: "align.middle",
    icon: "VerticalCenterIcon",
    value: xn.MIDDLE
  },
  {
    label: "align.bottom",
    icon: "AlignBottomIcon",
    value: xn.BOTTOM
  }
];
function Hb(r) {
  var s, l;
  const e = r.get(vr), t8 = r.get(z), n = e.getCurrentUnitOfType(we.UNIVER_SHEET), i = n == null ? void 0 : n.getActiveSheet().getDefaultCellStyleInternal(), o = (s = i == null ? void 0 : i.vt) != null ? s : xn.BOTTOM;
  return {
    id: zc2.id,
    icon: (l = yh2.find((a) => a.value === o)) == null ? void 0 : l.icon,
    tooltip: "toolbar.verticalAlignMode.main",
    type: H1.SELECTOR,
    selections: yh2,
    value$: pt3(e, o, ({ worksheet: a }) => new Observable((c) => {
      var g, m2;
      const d = r.get(Ls).onCommandExecuted((f2) => {
        var w, C;
        const v2 = f2.id;
        if (v2 !== zc2.id && v2 !== ie3.id && v2 !== pn2.id)
          return;
        const p = (w = t8.getCurrentLastSelection()) == null ? void 0 : w.primary;
        let S;
        if (p != null) {
          const I2 = a.getRange(p.startRow, p.startColumn), R = n == null ? void 0 : n.getActiveSheet().getComposedCellStyle(p.startRow, p.startColumn);
          S = (C = R == null ? void 0 : R.vt) != null ? C : I2 == null ? void 0 : I2.getVerticalAlignment();
        }
        c.next(S != null ? S : o);
      }), u = (g = t8.getCurrentLastSelection()) == null ? void 0 : g.primary;
      let h;
      if (u != null) {
        const f2 = a.getRange(u.startRow, u.startColumn), v2 = n == null ? void 0 : n.getActiveSheet().getComposedCellStyle(u.startRow, u.startColumn);
        h = (m2 = v2 == null ? void 0 : v2.vt) != null ? m2 : f2 == null ? void 0 : f2.getVerticalAlignment();
      }
      return c.next(h != null ? h : o), d.dispose;
    })),
    hidden$: Bi(r, we.UNIVER_SHEET),
    disabled$: he2(r, {
      workbookTypes: [Pe],
      worksheetTypes: [Ve2, yr],
      rangeTypes: [Le2]
    })
  };
}
var Mh2 = [
  {
    label: "textWrap.overflow",
    icon: "OverflowIcon",
    value: Bn.OVERFLOW
  },
  {
    label: "textWrap.wrap",
    icon: "AutowrapIcon",
    value: Bn.WRAP
  },
  {
    label: "textWrap.clip",
    icon: "TruncationIcon",
    value: Bn.CLIP
  }
];
function Vb(r) {
  var s, l;
  const e = r.get(z), t8 = r.get(vr), n = t8.getCurrentUnitOfType(we.UNIVER_SHEET), i = n == null ? void 0 : n.getActiveSheet().getDefaultCellStyleInternal(), o = (s = i == null ? void 0 : i.tb) != null ? s : Bn.OVERFLOW;
  return {
    id: Kc.id,
    tooltip: "toolbar.textWrapMode.main",
    icon: (l = Mh2.find((a) => a.value === o)) == null ? void 0 : l.icon,
    type: H1.SELECTOR,
    selections: Mh2,
    value$: pt3(t8, o, ({ worksheet: a }) => new Observable((c) => {
      var g, m2;
      const d = r.get(Ls).onCommandExecuted((f2) => {
        var w, C;
        const v2 = f2.id;
        if (v2 !== Kc.id && v2 !== ie3.id && v2 !== pn2.id)
          return;
        const p = (w = e.getCurrentLastSelection()) == null ? void 0 : w.primary;
        let S;
        if (p != null) {
          const I2 = a.getRange(p.startRow, p.startColumn), R = n == null ? void 0 : n.getActiveSheet().getComposedCellStyle(p.startRow, p.startColumn);
          S = (C = R == null ? void 0 : R.tb) != null ? C : I2 == null ? void 0 : I2.getWrapStrategy();
        }
        c.next(S != null ? S : o);
      }), u = (g = e.getCurrentLastSelection()) == null ? void 0 : g.primary;
      let h;
      if (u != null) {
        const f2 = a.getRange(u.startRow, u.startColumn), v2 = n == null ? void 0 : n.getActiveSheet().getComposedCellStyle(u.startRow, u.startColumn);
        h = (m2 = v2 == null ? void 0 : v2.tb) != null ? m2 : f2 == null ? void 0 : f2.getWrapStrategy();
      }
      return c.next(h != null ? h : o), d.dispose;
    })),
    hidden$: Bi(r, we.UNIVER_SHEET),
    disabled$: he2(r, {
      workbookTypes: [Pe],
      worksheetTypes: [Ve2, yr],
      rangeTypes: [Le2]
    })
  };
}
var Eh3 = [
  {
    label: "textRotate.none",
    icon: "NoRotationIcon",
    value: 0
  },
  {
    label: "textRotate.angleUp",
    icon: "LeftRotationFortyFiveDegreesIcon",
    value: -45
  },
  {
    label: "textRotate.angleDown",
    icon: "RightRotationFortyFiveDegreesIcon",
    value: 45
  },
  {
    label: "textRotate.vertical",
    icon: "VerticalTextIcon",
    value: "v"
  },
  {
    label: "textRotate.rotationUp",
    icon: "LeftRotationNinetyDegreesIcon",
    value: -90
  },
  {
    label: "textRotate.rotationDown",
    icon: "RightRotationNinetyDegreesIcon",
    value: 90
  }
];
function Nb(r) {
  const e = r.get(z), t8 = r.get(vr), n = 0;
  return {
    id: Jc.id,
    tooltip: "toolbar.textRotateMode.main",
    icon: Eh3[0].icon,
    type: H1.SELECTOR,
    selections: Eh3,
    value$: pt3(t8, n, ({ worksheet: i }) => new Observable((o) => {
      var c, d;
      const s = r.get(Ls).onCommandExecuted((u) => {
        var f2, v2;
        const h = u.id;
        if (h !== Jc.id && h !== ie3.id && h !== pn2.id)
          return;
        const g = (f2 = e.getCurrentLastSelection()) == null ? void 0 : f2.primary;
        let m2;
        if (g != null) {
          const p = i.getRange(g.startRow, g.startColumn);
          m2 = p == null ? void 0 : p.getTextRotation();
        }
        (m2 == null ? void 0 : m2.v) === ie.TRUE ? o.next("v") : o.next((v2 = m2 && m2.a) != null ? v2 : n);
      }), l = (c = e.getCurrentLastSelection()) == null ? void 0 : c.primary;
      let a;
      if (l != null) {
        const u = i.getRange(l.startRow, l.startColumn);
        a = u == null ? void 0 : u.getTextRotation();
      }
      return (a == null ? void 0 : a.v) === ie.TRUE ? o.next("v") : o.next((d = a && a.a) != null ? d : n), s.dispose;
    })),
    hidden$: Bi(r, we.UNIVER_SHEET),
    disabled$: he2(r, {
      workbookTypes: [Pe],
      worksheetTypes: [Ve2, yr],
      rangeTypes: [Le2]
    })
  };
}
function cs3(r) {
  return new Observable((t8) => t8.next(!r.get(lr).supportClipboard));
}
function ci3(r) {
  return {
    id: un5.name,
    commandId: un5.id,
    type: H1.BUTTON,
    title: "rightClick.copy",
    icon: "CopyDoubleIcon",
    disabled$: he2(r, {
      workbookTypes: [sr2],
      worksheetTypes: [mr],
      rangeTypes: [Hs]
    }),
    hidden$: Bi(r, we.UNIVER_SHEET)
  };
}
function Za2(r) {
  return {
    id: hn4.name,
    commandId: hn4.id,
    type: H1.BUTTON,
    title: "rightClick.paste",
    icon: "PasteSpecialDoubleIcon",
    disabled$: cs3(r).pipe(
      combineLatestWith(he2(r, {
        rangeTypes: [Le2],
        worksheetTypes: [Ve2, yr, An],
        workbookTypes: [Pe]
      })),
      map(([e, t8]) => e || t8)
    ),
    hidden$: Bi(r, we.UNIVER_SHEET)
  };
}
var Vs = "sheet.menu.paste-special";
function Ga2(r) {
  return {
    id: Vs,
    type: H1.SUBITEMS,
    icon: "PasteSpecialDoubleIcon",
    title: "rightClick.pasteSpecial",
    hidden$: zi3(r, Bi(r, we.UNIVER_SHEET))
  };
}
function qa2(r) {
  return {
    id: go3.id,
    type: H1.BUTTON,
    title: "rightClick.pasteValue",
    disabled$: cs3(r).pipe(
      combineLatestWith(he2(r, {
        rangeTypes: [Le2],
        worksheetTypes: [An, Ve2],
        workbookTypes: [Pe]
      })),
      map(([e, t8]) => e || t8)
    ),
    hidden$: Bi(r, we.UNIVER_SHEET)
  };
}
function Qa2(r) {
  return {
    id: mo3.id,
    type: H1.BUTTON,
    title: "rightClick.pasteFormat",
    disabled$: cs3(r).pipe(
      combineLatestWith(he2(r, {
        rangeTypes: [Le2],
        worksheetTypes: [yr, Ve2],
        workbookTypes: [Pe]
      })),
      map(([e, t8]) => e || t8)
    ),
    hidden$: Bi(r, we.UNIVER_SHEET)
  };
}
function Ka2(r) {
  return {
    id: ri4.id,
    type: H1.BUTTON,
    title: "rightClick.pasteColWidth",
    disabled$: cs3(r).pipe(
      combineLatestWith(he2(r, {
        rangeTypes: [Le2],
        worksheetTypes: [Qt3, Ve2],
        workbookTypes: [Pe]
      })),
      map(([e, t8]) => e || t8)
    )
  };
}
function Ja2(r) {
  return {
    id: fo5.id,
    type: H1.BUTTON,
    title: "rightClick.pasteBesidesBorder",
    disabled$: cs3(r).pipe(
      combineLatestWith(he2(r, {
        rangeTypes: [Le2],
        worksheetTypes: [
          Ve2,
          yr,
          An,
          en,
          Qt3
        ],
        workbookTypes: [Pe]
      })),
      map(([e, t8]) => e || t8)
    ),
    hidden$: Bi(r, we.UNIVER_SHEET)
  };
}
function kb(r) {
  return {
    id: eo.id,
    type: H1.BUTTON,
    icon: "AutoHeightDoubleIcon",
    title: "rightClick.fitContent",
    disabled$: he2(r, {
      workbookTypes: [Pe],
      worksheetTypes: [en, Ve2],
      rangeTypes: [Le2]
    }),
    hidden$: Bi(r, we.UNIVER_SHEET)
  };
}
function Db(r) {
  return {
    id: is2.id,
    type: H1.BUTTON,
    icon: "AutoWidthDoubleIcon",
    title: "rightClick.fitContent",
    disabled$: he2(r, {
      workbookTypes: [Pe],
      worksheetTypes: [en, Ve2],
      rangeTypes: [Le2]
    }),
    hidden$: Bi(r, we.UNIVER_SHEET)
  };
}
var Ef2 = "sheet.menu.sheet-frozen";
function Lb(r) {
  return {
    id: Ef2,
    type: H1.SUBITEMS,
    title: "rightClick.freeze",
    icon: "FreezeToSelectedIcon",
    hidden$: Bi(r, we.UNIVER_SHEET)
  };
}
var Gc2 = "sheet.header-menu.sheet-frozen";
function Th2(r) {
  return {
    id: Gc2,
    type: H1.SUBITEMS,
    title: "rightClick.freeze",
    icon: "FreezeToSelectedIcon",
    hidden$: Bi(r, we.UNIVER_SHEET)
  };
}
function $a2(r) {
  return {
    id: $n3.id,
    type: H1.BUTTON,
    title: "rightClick.freeze",
    icon: "FreezeToSelectedIcon",
    // disabled$: getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetEditPermission], rangeTypes: [RangeProtectionPermissionEditPoint] }),
    hidden$: Bi(r, we.UNIVER_SHEET)
  };
}
function Wb(r) {
  return {
    id: ba2.id,
    type: H1.BUTTON,
    title: "rightClick.freezeRow",
    icon: "FreezeRowIcon",
    // disabled$: getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetEditPermission], rangeTypes: [RangeProtectionPermissionEditPoint] }),
    hidden$: Bi(r, we.UNIVER_SHEET)
  };
}
function Bb(r) {
  return {
    id: _a2.id,
    type: H1.BUTTON,
    title: "rightClick.freezeCol",
    icon: "FreezeColumnIcon",
    // disabled$: getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetEditPermission], rangeTypes: [RangeProtectionPermissionEditPoint] }),
    hidden$: Bi(r, we.UNIVER_SHEET)
  };
}
function ec2(r) {
  return {
    id: Dc.id,
    type: H1.BUTTON,
    title: "rightClick.cancelFreeze",
    icon: "CancelFreezeIcon",
    // disabled$: getCurrentRangeDisable$(accessor, { workbookTypes: [WorkbookEditablePermission], worksheetTypes: [WorksheetEditPermission], rangeTypes: [RangeProtectionPermissionEditPoint] }),
    hidden$: Bi(r, we.UNIVER_SHEET)
  };
}
function Fb(r) {
  return {
    id: ca.id,
    type: H1.BUTTON,
    icon: "HideDoubleIcon",
    title: "rightClick.hideSelectedRow",
    disabled$: he2(r, {
      workbookTypes: [Pe],
      worksheetTypes: [en, Ve2],
      rangeTypes: [Le2]
    }),
    hidden$: Bi(r, we.UNIVER_SHEET)
  };
}
function Ub(r) {
  return {
    id: da.id,
    type: H1.BUTTON,
    icon: "HideDoubleIcon",
    title: "rightClick.hideSelectedColumn",
    disabled$: he2(r, {
      workbookTypes: [Pe],
      worksheetTypes: [Ve2, Qt3],
      rangeTypes: [Le2]
    }),
    hidden$: Bi(r, we.UNIVER_SHEET)
  };
}
function Xb(r) {
  const e = r.get(vr), t8 = r.get(z), n = r.get(Ls), i = [ie3, Pt2, Tt].map((o) => o.id);
  return {
    id: ti.id,
    type: H1.BUTTON,
    icon: "EyeOutlineIcon",
    title: "rightClick.showHideRow",
    hidden$: pt3(e, true, ({ worksheet: o }) => new Observable((s) => {
      function l() {
        var d;
        const c = (d = t8.getCurrentSelections()) == null ? void 0 : d.map((u) => u.range).filter((u) => u.rangeType === ge.ROW);
        return !!(c != null && c.some((u) => {
          for (let h = u.startRow; h <= u.endRow; h++)
            if (!o.getRowRawVisible(h)) return true;
          return false;
        }));
      }
      const a = n.onCommandExecuted((c) => {
        i.findIndex((d) => d === c.id) !== -1 && s.next(!l());
      });
      return s.next(!l()), () => a.dispose();
    })),
    disabled$: he2(r, {
      workbookTypes: [Pe],
      worksheetTypes: [Ve2, en],
      rangeTypes: [Le2]
    })
  };
}
function zb(r) {
  const e = r.get(vr), t8 = r.get(z), n = r.get(Ls), i = [ie3, on, rn].map((o) => o.id);
  return {
    id: Xr.id,
    type: H1.BUTTON,
    icon: "EyeOutlineIcon",
    title: "rightClick.showHideColumn",
    hidden$: pt3(e, true, ({ worksheet: o }) => new Observable((s) => {
      function l() {
        var d;
        const c = (d = t8.getCurrentSelections()) == null ? void 0 : d.map((u) => u.range).filter((u) => u.rangeType === ge.COLUMN);
        return !c || c.length === 0 ? false : !!c.some((u) => {
          for (let h = u.startColumn; h <= u.endColumn; h++)
            if (!o.getColVisible(h)) return true;
          return false;
        });
      }
      const a = n.onCommandExecuted((c) => {
        i.findIndex((d) => d === c.id) !== -1 && s.next(!l());
      });
      return s.next(!l()), () => a.dispose();
    })),
    disabled$: he2(r, {
      workbookTypes: [Pe],
      worksheetTypes: [Qt3, Ve2],
      rangeTypes: [Le2]
    })
  };
}
function jb(r) {
  const e = r.get(Ls), t8 = r.get(vr), n = r.get(z), i = 2;
  return {
    id: Gn2.id,
    type: H1.BUTTON,
    icon: "AdjustHeightDoubleIcon",
    label: {
      name: Sn3,
      props: {
        prefix: "rightClick.rowHeight",
        suffix: "px",
        min: i,
        max: 1e3
      }
    },
    value$: pt3(t8, i, ({ worksheet: o }) => new Observable((s) => {
      function l() {
        var u;
        const c = (u = n.getCurrentLastSelection()) == null ? void 0 : u.primary, d = c ? o.getRowHeight(c.startRow) : o.getConfig().defaultRowHeight;
        s.next(d);
      }
      const a = e.onCommandExecuted((c) => {
        const d = c.id;
        if (d === ee.id || d === ie3.id || d === Fe.id)
          return l();
      });
      return l(), a.dispose;
    })),
    hidden$: he2(r, {
      workbookTypes: [Pe],
      worksheetTypes: [Ve2, en],
      rangeTypes: [Le2]
    })
  };
}
function Yb(r) {
  const e = r.get(Ls), t8 = r.get(vr), n = r.get(z), i = 2;
  return {
    id: Bn2.id,
    type: H1.BUTTON,
    icon: "AdjustWidthDoubleIcon",
    label: {
      name: Sn3,
      props: {
        prefix: "rightClick.columnWidth",
        suffix: "px",
        min: i,
        max: 1e3
      }
    },
    value$: pt3(t8, i, ({ worksheet: o }) => new Observable((s) => {
      function l() {
        var u;
        const c = (u = n.getCurrentLastSelection()) == null ? void 0 : u.primary, d = c ? o.getColumnWidth(c.startColumn) : o.getConfig().defaultColumnWidth;
        s.next(d);
      }
      const a = e.onCommandExecuted((c) => {
        const d = c.id;
        if (d === ee.id || d === ie3.id || d === mt.id)
          return l();
      });
      return l(), a.dispose;
    })),
    hidden$: he2(r, {
      workbookTypes: [Pe],
      worksheetTypes: [Ve2, Qt3],
      rangeTypes: [Le2]
    })
  };
}
function ds3(r) {
  var a;
  const e = r.get(vr), t8 = r.get(m), n = e.getUnit(Dl), i = t8.getActiveTextRange();
  if (n == null || i == null) return null;
  const o = (a = n.getBody()) == null ? void 0 : a.textRuns;
  if (o == null) return;
  const { startOffset: s } = i;
  return o.find(({ st: c, ed: d }) => s >= c && s <= d);
}
var sr5 = {
  type: Ms.COMMAND,
  id: "sheet.command.add-worksheet-merge",
  handler: async (r, e) => {
    const t8 = r.get(Ls), n = r.get(Qo), i = r.get(vr), o = r.get(at), s = r.get(Fn), l = e.unitId, a = e.subUnitId, c = e.selections, d = zr(c, e.value), u = i.getUniverSheetInstance(l).getSheetBySheetId(a), h = [], g = [], m2 = km(u, d);
    if (m2 && !e.defaultMerge && !await o.confirm({
      id: "merge.confirm.add-worksheet-merge",
      title: {
        title: "merge.confirm.warning"
      },
      children: {
        title: "merge.confirm.title"
      },
      cancelText: s.t("merge.confirm.cancel"),
      confirmText: s.t("merge.confirm.confirm")
    }))
      return false;
    const f2 = {
      unitId: l,
      subUnitId: a,
      ranges: J.deepClone(d)
    }, v2 = {
      unitId: l,
      subUnitId: a,
      ranges: J.deepClone(d)
    }, p = ye2(r, f2), S = We2(r, v2);
    if (p.ranges.length > 0 && h.push({ id: se2.id, params: p }), h.push({ id: ne.id, params: v2 }), g.push({ id: se2.id, params: S }), p.ranges.length > 0 && g.push({ id: ne.id, params: p }), m2) {
      const M7 = Dm(r, l, u, d);
      h.unshift(...M7.redos), g.push(...M7.undos);
    }
    const w = eg2(r, e, d);
    w && h.push(w);
    const C = tg(r, e);
    C && g.push(C);
    const R = r.get(G).onCommandExecute({
      id: sr5.id,
      params: { unitId: l, subUnitId: a, ranges: d }
    });
    return h.push(...R.redos), g.push(...R.undos), fo(h, t8).result ? (n.pushUndoRedo({
      unitID: l,
      undoMutations: g,
      redoMutations: h
    }), true) : false;
  }
};
var cu2 = {
  type: Ms.COMMAND,
  id: "sheet.command.add-worksheet-merge-all",
  handler: async (r) => {
    var d;
    const e = r.get(Ls), n = (d = r.get(z).getCurrentSelections()) == null ? void 0 : d.map((u) => u.range), i = Gd2(aa.MergeAll, n);
    if (!(i != null && i.length))
      return false;
    const s = r.get(vr).getCurrentUnitForType(we.UNIVER_SHEET);
    if (!s) return false;
    const l = s.getActiveSheet();
    if (!l) return false;
    const a = s.getUnitId(), c = l.getSheetId();
    return e.executeCommand(sr5.id, {
      selections: i,
      unitId: a,
      subUnitId: c
    });
  }
};
var du2 = {
  type: Ms.COMMAND,
  id: "sheet.command.add-worksheet-merge-vertical",
  handler: async (r) => {
    var d;
    const e = r.get(Ls), n = (d = r.get(z).getCurrentSelections()) == null ? void 0 : d.map((u) => u.range), i = Gd2(aa.MergeVertical, n);
    if (!(i != null && i.length))
      return false;
    const s = r.get(vr).getCurrentUnitForType(we.UNIVER_SHEET);
    if (!s) return false;
    const l = s.getActiveSheet();
    if (!l) return false;
    const a = s.getUnitId(), c = l.getSheetId();
    return e.executeCommand(sr5.id, {
      value: Em.COLUMNS,
      selections: i,
      unitId: a,
      subUnitId: c
    });
  }
};
var uu3 = {
  type: Ms.COMMAND,
  id: "sheet.command.add-worksheet-merge-horizontal",
  handler: async (r) => {
    var d;
    const e = r.get(Ls), n = (d = r.get(z).getCurrentSelections()) == null ? void 0 : d.map((u) => u.range), i = Gd2(aa.MergeHorizontal, n);
    if (!(i != null && i.length))
      return false;
    const s = r.get(vr).getCurrentUnitForType(we.UNIVER_SHEET);
    if (!s) return false;
    const l = s.getActiveSheet();
    if (!l) return false;
    const a = s.getUnitId(), c = l.getSheetId();
    return e.executeCommand(sr5.id, {
      value: Em.ROWS,
      selections: i,
      unitId: a,
      subUnitId: c
    });
  }
};
function Zb(r) {
  const e = r.get(z), t8 = r.get(me), n = r.get(vr), i = r.get(Ln), o = n.getCurrentTypeOfUnit$(we.UNIVER_SHEET);
  return combineLatest([
    e.selectionMoveEnd$,
    o.pipe(map((s) => {
      var l;
      return (l = s == null ? void 0 : s.getUnitId()) != null ? l : "";
    })),
    o.pipe(switchMap((s) => {
      var l;
      return (l = s == null ? void 0 : s.activeSheet$) != null ? l : of(null);
    }))
  ]).pipe(
    map(([s, l, a]) => {
      if (!a || !s || s.length === 0) return false;
      const c = a.getSheetId(), d = s.map((g) => g.range);
      if (i.interceptor.fetchThroughInterceptors(Kl)(false, d))
        return true;
      const h = t8.getSubunitRuleList(l, c).map((g) => g.ranges).flat();
      if (s.length < 2) {
        const g = s[0].range;
        return h.some((f2) => En.intersects(f2, g) && !En.contains(f2, g));
      }
      for (let g = 0; g < s.length; g++)
        for (let m2 = g + 1; m2 < s.length; m2++)
          if (En.intersects(s[g].range, s[m2].range))
            return true;
      return false;
    })
  );
}
function Tf2(r, e) {
  return !!gl(r, e, ge.ROW);
}
function Pf(r, e) {
  return !!gl(r, e, ge.COLUMN);
}
function gl(r, e, t8) {
  return r.find((i) => {
    const o = i.range, { startRow: s, endRow: l, startColumn: a, endColumn: c, rangeType: d } = o;
    return d === ge.ALL || d === ge.NORMAL ? false : d === t8 && (t8 === ge.COLUMN && a <= e && e <= c || t8 === ge.ROW && s <= e && e <= l);
  });
}
function Gb(r) {
  const e = zi3(r, he2(r, { workbookTypes: [Pe], worksheetTypes: [Ve2, An, yr], rangeTypes: [Le2] })), t8 = Zb(r);
  return {
    id: sr5.id,
    icon: "MergeAllIcon",
    tooltip: "toolbar.mergeCell.main",
    type: H1.SUBITEMS,
    // selections: [...MERGE_CHILDREN],
    hidden$: Bi(r, we.UNIVER_SHEET),
    disabled$: e.pipe(
      combineLatestWith(t8),
      map(([n, i]) => n || i)
    )
  };
}
function qb(r) {
  return {
    id: cu2.id,
    type: H1.BUTTON,
    title: "merge.all",
    icon: "MergeAllIcon",
    hidden$: Bi(r, we.UNIVER_SHEET)
  };
}
function Qb(r) {
  return {
    id: du2.id,
    type: H1.BUTTON,
    title: "merge.vertical",
    icon: "VerticalIntegrationIcon",
    hidden$: Bi(r, we.UNIVER_SHEET)
  };
}
function Kb(r) {
  return {
    id: uu3.id,
    type: H1.BUTTON,
    title: "merge.horizontal",
    icon: "HorizontalMergeIcon",
    hidden$: Bi(r, we.UNIVER_SHEET)
  };
}
function Jb(r) {
  return {
    id: pc.id,
    type: H1.BUTTON,
    title: "merge.cancel",
    icon: "CancelMergeIcon",
    hidden$: Bi(r, we.UNIVER_SHEET)
  };
}
function $b(r) {
  const t8 = r.get(vr).getCurrentTypeOfUnit$(we.UNIVER_SHEET), n = r.get(Rs);
  return combineLatest([t8, n.currentUser$]).pipe(
    switchMap(([i, o]) => i ? i.activeSheet$.pipe(
      switchMap((s) => {
        if (!s)
          return of(true);
        const l = r.get(me), a = r.get(lt), c = r.get(z);
        return merge(
          c.selectionMoveEnd$,
          l.ruleChange$,
          a.ruleChange$
        ).pipe(
          map(() => {
            const d = i.getUnitId(), u = s.getSheetId(), h = l.getSubunitRuleList(d, u), g = c.getCurrentSelections(), m2 = g == null ? void 0 : g.map((p) => p.range), f2 = h.map((p) => p.ranges).flat();
            if (!m2)
              return false;
            const v2 = a.getRule(d, u);
            return v2 != null && v2.permissionId ? true : m2 == null ? void 0 : m2.some((p) => f2.some((S) => En.intersects(p, S)));
          })
        );
      })
    ) : of(true))
  );
}
function e_(r) {
  const e = r.get(vr), t8 = r.get(me), n = e.getCurrentTypeOfUnit$(we.UNIVER_SHEET), i = r.get(Rs);
  return combineLatest([n, i.currentUser$]).pipe(
    switchMap(([o, s]) => o ? o.activeSheet$.pipe(
      switchMap((l) => {
        if (!l)
          return of(true);
        const a = r.get(me), c = r.get(lt), d = r.get(eC), u = r.get(z);
        return merge(
          u.selectionMoveEnd$,
          a.ruleChange$,
          c.ruleChange$
        ).pipe(
          map(() => {
            var M7, E;
            const h = o.getUnitId(), g = l.getSheetId(), m2 = t8.getSubunitRuleList(h, g), f2 = (M7 = u.getCurrentSelections()) == null ? void 0 : M7.map((T) => T.range);
            if (m2.map((T) => T.ranges).flat(), !(f2 != null && f2.length) || f2.length > 1)
              return true;
            const v2 = f2[0];
            if ((v2 == null ? void 0 : v2.rangeType) === ge.ALL || (v2 == null ? void 0 : v2.rangeType) === ge.COLUMN || (v2 == null ? void 0 : v2.rangeType) === ge.ROW)
              return true;
            const p = c.getRule(h, g);
            if (p != null && p.permissionId)
              return ((E = d.getPermissionPoint(new Mr(h, g).id)) == null ? void 0 : E.value) === false;
            if (m2.filter((T) => T.ranges.some((P2) => En.intersects(P2, v2))).length !== 1)
              return true;
            const { startRow: w, endRow: C, startColumn: I2, endColumn: R } = v2, y = r.get(Lt);
            for (let T = w; T <= C; T++)
              for (let P2 = I2; P2 <= R; P2++) {
                const H3 = y.getCellInfo(h, g, T, P2);
                if (H3)
                  return H3[_.ManageCollaborator] === false;
              }
            return false;
          })
        );
      })
    ) : of(true))
  );
}
function t_(r) {
  const e = r.get(vr), t8 = r.get(eC), n = e.getCurrentTypeOfUnit$(we.UNIVER_SHEET), i = r.get(Rs);
  return combineLatest([n, i.currentUser$]).pipe(
    switchMap(([o, s]) => o ? o.activeSheet$.pipe(
      switchMap((l) => {
        var m2;
        if (!l)
          return of(true);
        const a = o.getUnitId(), c = r.get(z), d = r.get(me), u = r.get(lt), h = (m2 = t8.composePermission$([new Pe(a).id]).pipe(map((f2) => f2.every((v2) => v2.value)))) != null ? m2 : of(false), g = merge(
          d.ruleChange$,
          u.ruleChange$
        ).pipe(
          startWith(null)
        );
        return combineLatest([h, g, c.selectionMoveEnd$]).pipe(
          map(([f2, v2, p]) => {
            if (!f2)
              return true;
            const S = c.getCurrentSelections(), w = S == null ? void 0 : S.map((C) => C.range);
            return w != null && w.length ? w.length > 1 : false;
          })
        );
      })
    ) : of(true))
  );
}
function xf2(r) {
  var c;
  const e = r.get(vr), t8 = r.get(eC), n = e.getCurrentTypeOfUnit$(we.UNIVER_SHEET), i = r.get(Rs), o = r.has(qe5) ? r.get(qe5) : null, l = r.get(Nr).subscribeContextValue$(gE).pipe(
    startWith(false),
    shareReplay(1)
  ), a = (c = o == null ? void 0 : o.visible$.pipe(
    startWith(null),
    shareReplay(1)
  )) != null ? c : of(null);
  return combineLatest([n, i.currentUser$, a, l]).pipe(
    switchMap(([d, u, h, g]) => !d || h != null && h.visible && h.unitId === d.getUnitId() || g ? of(true) : d.activeSheet$.pipe(
      switchMap((m2) => {
        var M7;
        if (!m2)
          return of(true);
        const v2 = r.get(Nr).subscribeContextValue$(PR).pipe(startWith(false)), p = d.getUnitId(), S = m2.getSheetId(), w = r.get(me), C = r.get(lt), I2 = r.get(z), R = (M7 = t8.composePermission$([new or2(p).id]).pipe(map((E) => E.every((T) => T.value)))) != null ? M7 : of(false), y = merge(
          w.ruleChange$,
          C.ruleChange$
        ).pipe(
          startWith(null)
        );
        return combineLatest([R, y, I2.selectionMoveEnd$, v2]).pipe(
          map(([E, T, P2, H3]) => {
            if (!E || H3)
              return true;
            const A = I2.getCurrentSelections(), x7 = A == null ? void 0 : A.map((B) => B.range);
            if (!(x7 != null && x7.length))
              return true;
            const V2 = C.getRule(p, S);
            if (V2 != null && V2.permissionId)
              return true;
            const D2 = w.getSubunitRuleList(p, S);
            return x7 == null ? void 0 : x7.some((B) => D2.some((j) => j.ranges.some((G7) => En.intersects(B, G7))));
          })
        );
      })
    ))
  );
}
function n_(r) {
  const e = r.get(vr), t8 = r.get(eC), n = e.getCurrentTypeOfUnit$(we.UNIVER_SHEET), i = r.get(Rs);
  return combineLatest([n, i.currentUser$]).pipe(
    switchMap(([o, s]) => o ? o.activeSheet$.pipe(
      switchMap((l) => {
        var m2;
        if (!l)
          return of(true);
        const a = o.getUnitId(), c = l.getSheetId(), d = r.get(me), u = r.get(lt), h = (m2 = t8.composePermission$([new or2(a).id]).pipe(map((f2) => f2.every((v2) => v2.value)))) != null ? m2 : of(false), g = merge(
          d.ruleChange$,
          u.ruleChange$
        ).pipe(
          startWith(null)
        );
        return combineLatest([h, g]).pipe(
          map(([f2, v2]) => {
            var w;
            if (!f2) return true;
            const p = u.getRule(a, c);
            return p != null && p.permissionId ? true : ((w = d.getSubunitRuleList(a, c)) == null ? void 0 : w.filter((C) => C == null ? void 0 : C.permissionId)).length > 0;
          })
        );
      })
    ) : of(true))
  );
}
function r_(r) {
  const e = r.get(vr), t8 = r.get(eC), n = e.getCurrentTypeOfUnit$(we.UNIVER_SHEET), i = r.get(Rs);
  return combineLatest([n, i.currentUser$]).pipe(
    switchMap(([o, s]) => o ? o.activeSheet$.pipe(
      switchMap((l) => {
        if (!l)
          return of(true);
        const a = o.getUnitId(), c = l.getSheetId(), d = r.get(lt);
        return d.ruleChange$.pipe(startWith(null)).pipe(
          map(() => {
            var h;
            return d.getRule(a, c) ? ((h = t8.getPermissionPoint(new Rr(a, c).id)) == null ? void 0 : h.value) === false : true;
          })
        );
      })
    ) : of(true))
  );
}
function i_(r) {
  const e = r.get(vr), t8 = r.get(eC), n = e.getCurrentTypeOfUnit$(we.UNIVER_SHEET), i = r.get(Rs);
  return combineLatest([n, i.currentUser$]).pipe(
    switchMap(([o, s]) => o ? o.activeSheet$.pipe(
      switchMap((l) => {
        var m2;
        if (!l)
          return of(true);
        const a = o.getUnitId(), c = r.get(me), d = r.get(lt), u = (m2 = t8.composePermission$([new or2(a).id, new Bs(a).id]).pipe(map((f2) => f2.every((v2) => v2.value)))) != null ? m2 : of(false), h = d.ruleChange$.pipe(startWith(null)), g = c.ruleChange$.pipe(startWith(null));
        return combineLatest([u, h, g]).pipe(
          map(([f2, v2, p]) => {
            if (!f2)
              return true;
            const S = l.getSheetId(), w = d.getRule(a, S), C = c.getSubunitRuleList(a, S);
            return !(w || C.length);
          })
        );
      })
    ) : of(true))
  );
}
function o_(r) {
  const e = r.get(vr), t8 = r.get(eC), n = e.getCurrentTypeOfUnit$(we.UNIVER_SHEET), i = r.get(Rs);
  return combineLatest([n, i.currentUser$]).pipe(
    switchMap(([o, s]) => o ? o.activeSheet$.pipe(
      switchMap((l) => {
        if (!l)
          return of(true);
        const a = o.getUnitId(), c = l.getSheetId(), d = r.get(z), u = r.get(me), h = r.get(lt), g = merge(
          u.ruleChange$,
          h.ruleChange$,
          d.selectionMoveEnd$
        ).pipe(startWith(null));
        return combineLatest([g]).pipe(
          map(([m2]) => {
            var E;
            const f2 = r.get(z).getCurrentSelections(), v2 = f2 == null ? void 0 : f2.map((T) => T.range);
            if (!(v2 != null && v2.length) || v2.length > 1)
              return true;
            const p = v2[0];
            if ((p == null ? void 0 : p.rangeType) === ge.ALL || (p == null ? void 0 : p.rangeType) === ge.COLUMN || (p == null ? void 0 : p.rangeType) === ge.ROW)
              return true;
            const S = h.getRule(a, c);
            if (S != null && S.permissionId)
              return ((E = t8.getPermissionPoint(new Rr(a, c).id)) == null ? void 0 : E.value) === false;
            if (u.getSubunitRuleList(a, c).filter((T) => T.ranges.some((P2) => En.intersects(P2, p))).length !== 1)
              return true;
            const { startRow: C, endRow: I2, startColumn: R, endColumn: y } = p, M7 = r.get(Lt);
            for (let T = C; T <= I2; T++)
              for (let P2 = R; P2 <= y; P2++) {
                const H3 = M7.getCellInfo(a, c, T, P2);
                if (H3)
                  return H3[_.Delete] === false;
              }
            return false;
          })
        );
      })
    ) : of(true))
  );
}
function Of2(r) {
  var c;
  const e = r.get(vr), t8 = r.get(eC), n = e.getCurrentTypeOfUnit$(we.UNIVER_SHEET), i = r.get(Rs), o = r.has(qe5) ? r.get(qe5) : null, l = r.get(Nr).subscribeContextValue$(gE), a = (c = o == null ? void 0 : o.visible$) != null ? c : of(null);
  return combineLatest([n, i.currentUser$, a, l]).pipe(
    switchMap(([d, u, h, g]) => !d || h != null && h.visible && h.unitId === d.getUnitId() || g ? of(true) : d.activeSheet$.pipe(
      switchMap((m2) => {
        var p, S;
        if (!m2)
          return of(true);
        const f2 = d.getUnitId();
        return ((S = (p = t8.getPermissionPoint$(new Pe(f2).id)) == null ? void 0 : p.pipe(map((w) => !!w.value))) != null ? S : of(false)).pipe(
          map((w) => !w)
        );
      })
    ))
  );
}
var Ns2 = "sheet.contextMenu.permission";
function s_(r) {
  return {
    id: ma2.id,
    type: H1.BUTTON,
    icon: Om,
    tooltip: "permission.toolbarMenu",
    hidden$: Bi(r, we.UNIVER_SHEET),
    disabled$: xf2(r)
  };
}
function tc2(r) {
  return {
    id: Ns2,
    type: H1.SUBITEMS,
    title: "rightClick.protectRange",
    icon: Am,
    hidden$: Bi(r, we.UNIVER_SHEET)
  };
}
function nc2(r) {
  return {
    id: ii3.id,
    type: H1.BUTTON,
    title: "rightClick.turnOnProtectRange",
    hidden$: $b(r),
    disabled$: xf2(r)
  };
}
function rc2(r) {
  return {
    id: li3.id,
    type: H1.BUTTON,
    title: "rightClick.editProtectRange",
    disabled$: t_(r),
    hidden$: e_(r)
  };
}
function ic3(r) {
  return {
    id: si3.id,
    type: H1.BUTTON,
    title: "rightClick.removeProtectRange",
    disabled$: o_(r),
    hidden$: Bi(r, we.UNIVER_SHEET)
  };
}
function oc3(r) {
  return {
    id: oi3.id,
    type: H1.BUTTON,
    title: "rightClick.viewAllProtectArea",
    disabled$: Of2(r),
    hidden$: Bi(r, we.UNIVER_SHEET)
  };
}
function l_(r) {
  return {
    id: fa.id,
    type: H1.BUTTON,
    title: "sheetConfig.addProtectSheet",
    disabled$: n_(r),
    hidden$: Bi(r, we.UNIVER_SHEET)
  };
}
function a_(r) {
  return {
    id: ya2.id,
    type: H1.BUTTON,
    title: "sheetConfig.removeProtectSheet",
    disabled$: r_(r),
    hidden$: Bi(r, we.UNIVER_SHEET)
  };
}
function c_(r) {
  return {
    id: Ma2.id,
    type: H1.BUTTON,
    title: "sheetConfig.changeSheetPermission",
    disabled$: i_(r),
    hidden$: Bi(r, we.UNIVER_SHEET)
  };
}
function d_(r) {
  return {
    id: pa2.id,
    type: H1.BUTTON,
    title: "sheetConfig.viewAllProtectArea",
    disabled$: Of2(r),
    hidden$: Bi(r, we.UNIVER_SHEET)
  };
}
function u_(r) {
  const e = r.get(vr), t8 = r.get(Ls), n = new Observable((o) => {
    const s = t8.onCommandExecuted((l) => {
      const a = l.id;
      (a === Ht.id || a === hn.id || a === wt.id) && ml(e, o);
    });
    return ml(e, o), s.dispose;
  }), i = Yi2(r, [Pe, ir]);
  return {
    id: Sa2.id,
    type: H1.BUTTON,
    title: "sheetConfig.delete",
    disabled$: combineLatest([n, i]).pipe(
      map(([o, s]) => o || s)
    ),
    hidden$: Bi(r, we.UNIVER_SHEET)
  };
}
function h_(r) {
  return {
    id: qr2.id,
    type: H1.BUTTON,
    title: "sheetConfig.copy",
    disabled$: Yi2(r, [Pe, rr]),
    hidden$: Bi(r, we.UNIVER_SHEET)
  };
}
function g_(r) {
  return {
    id: Ta2.id,
    type: H1.BUTTON,
    title: "sheetConfig.rename",
    disabled$: Yi2(r, [Pe, zs]),
    hidden$: Bi(r, we.UNIVER_SHEET)
  };
}
function m_(r) {
  return {
    id: Yc2.id,
    title: "sheetConfig.changeColor",
    type: H1.SELECTOR,
    selections: [
      {
        label: {
          name: m5,
          hoverable: false
        }
      }
    ],
    hidden$: Yi2(r, [Pe])
  };
}
function f_(r) {
  const e = r.get(vr), t8 = r.get(Ls);
  return {
    id: ed.id,
    type: H1.BUTTON,
    title: "sheetConfig.hide",
    disabled$: new Observable((n) => {
      const i = t8.onCommandExecuted((o) => {
        const s = o.id;
        (s === Ht.id || s === hn.id || s === wt.id) && ml(e, n);
      });
      return ml(e, n), i.dispose;
    }).pipe(
      combineLatestWith(Yi2(r, [Pe, Fs])),
      map(([n, i]) => n || i)
    ),
    hidden$: Bi(r, we.UNIVER_SHEET)
  };
}
function p_(r) {
  const e = r.get(vr), t8 = r.get(Ls);
  return {
    id: Ia2.id,
    type: H1.BUTTON,
    title: "sheetConfig.unhide",
    disabled$: new Observable((n) => {
      function i() {
        const s = e.getCurrentUnitForType(we.UNIVER_SHEET).getWorksheets(), l = Array.from(s.values());
        n.next(l.length === 1);
      }
      const o = t8.onCommandExecuted((s) => {
        const l = s.id;
        (l === Ht.id || l === hn.id || l === wt.id) && i();
      });
      return i(), o.dispose;
    }).pipe(
      combineLatestWith(Yi2(r, [Pe, Fs])),
      map(([n, i]) => n || i)
    ),
    hidden$: Bi(r, we.UNIVER_SHEET)
  };
}
function ml(r, e) {
  const t8 = r.getCurrentUnitForType(we.UNIVER_SHEET).getWorksheets(), n = Array.from(t8.values()).filter(
    (i) => i.getConfig().hidden === ie.FALSE
  );
  e.next(n.length === 1);
}
var v_ = {
  [w1.START]: {
    [G1.HISTORY]: {
      [rs2.id]: {
        order: 2,
        menuItemFactory: bb
      },
      [Ws.id]: {
        order: 3,
        menuItemFactory: _s2
      }
    },
    [G1.FORMAT]: {
      [ha2.id]: {
        order: 1,
        menuItemFactory: Mb
      },
      [ua.id]: {
        order: 2,
        menuItemFactory: Eb
      },
      // TODO: fontsize +
      // TODO: fontsize -
      [Bi3.id]: {
        order: 5,
        menuItemFactory: _b
      },
      [Fi3.id]: {
        order: 6,
        menuItemFactory: Rb
      },
      [Ui3.id]: {
        order: 7,
        menuItemFactory: Ib
      },
      [Xi2.id]: {
        order: 8,
        menuItemFactory: yb
      },
      [Io3.id]: {
        order: 9,
        menuItemFactory: Pb,
        [Fc.id]: {
          order: 0,
          menuItemFactory: Tb
        }
      },
      [Bc2.id]: {
        order: 10,
        menuItemFactory: Ob,
        [jc.id]: {
          order: 0,
          menuItemFactory: xb
        }
      },
      [kc.id]: {
        order: 11,
        menuItemFactory: sb
      }
    },
    [G1.LAYOUT]: {
      [Gc.id]: {
        order: 0,
        menuItemFactory: Ab
      },
      [zc2.id]: {
        order: 3,
        menuItemFactory: Hb
      },
      [Kc.id]: {
        order: 6,
        menuItemFactory: Vb
      },
      [Jc.id]: {
        order: 7,
        menuItemFactory: Nb
      },
      [hs.id]: {
        order: 8,
        menuItemFactory: Gb,
        [Wh.id]: {
          order: 0,
          menuItemFactory: qb
        },
        [Lh.id]: {
          order: 1,
          menuItemFactory: Qb
        },
        [Vh.id]: {
          order: 2,
          menuItemFactory: Kb
        },
        [pc.id]: {
          order: 3,
          menuItemFactory: Jb
        }
      }
    },
    [G1.OTHERS]: {
      [ma2.id]: {
        order: 0,
        menuItemFactory: s_
      }
    }
  },
  [Y1.MAIN_AREA]: {
    [a12.FORMAT]: {
      [un5.name]: {
        order: 0,
        menuItemFactory: ci3
      },
      // [SheetCutCommand.name]: {
      //     order: 1,
      //     menuItemFactory: CutMenuItemFactory,
      // },
      [hn4.name]: {
        order: 2,
        menuItemFactory: Za2
      },
      [Vs]: {
        order: 3,
        menuItemFactory: Ga2,
        [go3.id]: {
          order: 0,
          menuItemFactory: qa2
        },
        [mo3.id]: {
          order: 1,
          menuItemFactory: Qa2
        },
        [ri4.id]: {
          order: 2,
          menuItemFactory: Ka2
        },
        [fo5.id]: {
          order: 3,
          menuItemFactory: Ja2
        }
      },
      [Hs2]: {
        order: 4,
        menuItemFactory: za2,
        [qs.id]: {
          order: 0,
          menuItemFactory: ja2
        },
        [Ls2.id]: {
          order: 1,
          menuItemFactory: Ya2
        },
        [Ws.id]: {
          order: 2,
          menuItemFactory: _s2
        }
      }
    },
    [a12.LAYOUT]: {
      order: 1,
      [Mf2]: {
        order: 0,
        menuItemFactory: ub2,
        [Qu.id]: {
          order: 0,
          menuItemFactory: hb
        },
        [sl.id]: {
          order: 1,
          menuItemFactory: gb
        },
        [ns2.id]: {
          order: 2,
          menuItemFactory: mb
        },
        [vi3.id]: {
          order: 3,
          menuItemFactory: fb
        }
      },
      [If2]: {
        order: 0,
        menuItemFactory: lb,
        [Eo4.id]: {
          order: 0,
          menuItemFactory: _h2
        },
        [Mo3.id]: {
          order: 1,
          menuItemFactory: Rh2
        },
        [ts2.id]: {
          order: 2,
          menuItemFactory: ab
        },
        [pi3.id]: {
          order: 3,
          menuItemFactory: cb
        }
      },
      [Ef2]: {
        order: 2,
        menuItemFactory: Lb,
        [$n3.id]: {
          order: 0,
          menuItemFactory: $a2
        },
        [ba2.id]: {
          order: 1,
          menuItemFactory: Wb
        },
        [_a2.id]: {
          order: 2,
          menuItemFactory: Bb
        },
        [Dc.id]: {
          order: 3,
          menuItemFactory: ec2
        }
      },
      [Ns2]: {
        order: 3,
        menuItemFactory: tc2,
        [ii3.id]: {
          order: 0,
          menuItemFactory: nc2
        },
        [li3.id]: {
          order: 1,
          menuItemFactory: rc2
        },
        [si3.id]: {
          order: 2,
          menuItemFactory: ic3
        },
        [oi3.id]: {
          order: 3,
          menuItemFactory: oc3
        }
      }
    },
    [a12.DATA]: {
      order: 2
    },
    [a12.OTHERS]: {
      order: 3
    }
  },
  [Y1.COL_HEADER]: {
    [a12.FORMAT]: {
      [un5.name]: {
        order: 0,
        menuItemFactory: ci3
      },
      // [SheetCutCommand.name]: {
      //     order: 1,
      //     menuItemFactory: CutMenuItemFactory,
      // },
      [hn4.name]: {
        order: 2,
        menuItemFactory: Za2
      },
      [Vs]: {
        order: 3,
        menuItemFactory: Ga2,
        [go3.id]: {
          order: 0,
          menuItemFactory: qa2
        },
        [mo3.id]: {
          order: 1,
          menuItemFactory: Qa2
        },
        [ri4.id]: {
          order: 2,
          menuItemFactory: Ka2
        },
        [fo5.id]: {
          order: 3,
          menuItemFactory: Ja2
        }
      },
      [Hs2]: {
        order: 4,
        menuItemFactory: za2,
        [qs.id]: {
          order: 0,
          menuItemFactory: ja2
        },
        [Ls2.id]: {
          order: 1,
          menuItemFactory: Ya2
        },
        [Ws.id]: {
          order: 2,
          menuItemFactory: _s2
        }
      }
    },
    [a12.LAYOUT]: {
      order: 1,
      [rl.id]: {
        order: 0,
        menuItemFactory: Sb
      },
      [il.id]: {
        order: 0,
        menuItemFactory: Cb
      },
      [da.id]: {
        order: 1,
        menuItemFactory: Ub
      },
      [Xr.id]: {
        order: 2,
        menuItemFactory: zb
      },
      [Eo4.id]: {
        order: 2,
        menuItemFactory: _h2
      },
      [Bn2.id]: {
        order: 3,
        menuItemFactory: Yb
      },
      [is2.id]: {
        order: 4,
        menuItemFactory: Db
      },
      [Gc2]: {
        order: 5,
        menuItemFactory: Th2,
        [$n3.id]: {
          order: 0,
          menuItemFactory: $a2
        },
        [Dc.id]: {
          order: 3,
          menuItemFactory: ec2
        }
      },
      [Ns2]: {
        order: 6,
        menuItemFactory: tc2,
        [ii3.id]: {
          order: 0,
          menuItemFactory: nc2
        },
        [li3.id]: {
          order: 1,
          menuItemFactory: rc2
        },
        [si3.id]: {
          order: 2,
          menuItemFactory: ic3
        },
        [oi3.id]: {
          order: 3,
          menuItemFactory: oc3
        }
      }
    },
    [a12.DATA]: {
      order: 2
    },
    [a12.OTHERS]: {
      order: 3
    }
  },
  [Y1.ROW_HEADER]: {
    [a12.FORMAT]: {
      [un5.name]: {
        order: 0,
        menuItemFactory: ci3
      },
      // [SheetCutCommand.name]: {
      //     order: 1,
      //     menuItemFactory: CutMenuItemFactory,
      // },
      [hn4.name]: {
        order: 2,
        menuItemFactory: Za2
      },
      [Vs]: {
        order: 3,
        menuItemFactory: Ga2,
        [go3.id]: {
          order: 0,
          menuItemFactory: qa2
        },
        [mo3.id]: {
          order: 1,
          menuItemFactory: Qa2
        },
        [ri4.id]: {
          order: 2,
          menuItemFactory: Ka2
        },
        [fo5.id]: {
          order: 3,
          menuItemFactory: Ja2
        }
      },
      [Hs2]: {
        order: 4,
        menuItemFactory: za2,
        [qs.id]: {
          order: 0,
          menuItemFactory: ja2
        },
        [Ls2.id]: {
          order: 1,
          menuItemFactory: Ya2
        },
        [Ws.id]: {
          order: 2,
          menuItemFactory: _s2
        }
      }
    },
    [a12.LAYOUT]: {
      order: 1,
      [tl.id]: {
        order: 0,
        menuItemFactory: vb
      },
      [nl.id]: {
        order: 1,
        menuItemFactory: pb
      },
      [Mo3.id]: {
        order: 1,
        menuItemFactory: Rh2
      },
      [ca.id]: {
        order: 2,
        menuItemFactory: Fb
      },
      [ti.id]: {
        order: 2,
        menuItemFactory: Xb
      },
      [Gn2.id]: {
        order: 3,
        menuItemFactory: jb
      },
      [eo.id]: {
        order: 4,
        menuItemFactory: kb
      },
      [Gc2]: {
        order: 5,
        menuItemFactory: Th2,
        [$n3.id]: {
          order: 0,
          menuItemFactory: $a2
        },
        [Dc.id]: {
          order: 3,
          menuItemFactory: ec2
        }
      },
      [Ns2]: {
        order: 6,
        menuItemFactory: tc2,
        [ii3.id]: {
          order: 0,
          menuItemFactory: nc2
        },
        [li3.id]: {
          order: 1,
          menuItemFactory: rc2
        },
        [si3.id]: {
          order: 2,
          menuItemFactory: ic3
        },
        [oi3.id]: {
          order: 3,
          menuItemFactory: oc3
        }
      }
    },
    [a12.DATA]: {
      order: 2
    },
    [a12.OTHERS]: {
      order: 3
    }
  },
  [Y1.FOOTER_TABS]: {
    [a12.OTHERS]: {
      order: 0,
      [Sa2.id]: {
        order: 0,
        menuItemFactory: u_
      },
      [qr2.id]: {
        order: 1,
        menuItemFactory: h_
      },
      [Ta2.id]: {
        order: 2,
        menuItemFactory: g_
      },
      [Yc2.id]: {
        order: 3,
        menuItemFactory: m_
      },
      [ed.id]: {
        order: 4,
        menuItemFactory: f_
      },
      // [SetWorksheetShowCommand.id]: {
      //     order: 5,
      //     menuItemFactory: UnHideSheetMenuItemFactory,
      // },
      [Ia2.id]: {
        order: 6,
        menuItemFactory: p_
      },
      [fa.id]: {
        order: 7,
        menuItemFactory: l_
      },
      [ya2.id]: {
        order: 8,
        menuItemFactory: a_
      },
      [Ma2.id]: {
        order: 9,
        menuItemFactory: c_
      },
      [pa2.id]: {
        order: 10,
        menuItemFactory: d_
      }
    }
  },
  [Y1.FOOTER_MENU]: {
    [a12.OTHERS]: {
      [ld.id]: {
        order: 1,
        menuItemFactory: db
      }
    }
  }
};
var sc2 = "UNIVER_SHEET_PERMISSION_ALERT_DIALOG_ID";
var Af2 = "UNIVER_SHEET_PERMISSION_ALERT_DIALOG";
var S_ = Object.getOwnPropertyDescriptor;
var C_ = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? S_(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var bn3 = (r, e) => (t8, n) => e(t8, n, r);
var Ii3 = class extends Ve {
  constructor(e, t8, n, i, o, s, l, a, c) {
    super();
    _2(this, "disposableCollection", new ao());
    this._commandService = e, this._univerInstanceService = t8, this._permissionService = n, this._dialogService = i, this._rangeProtectionRuleModel = o, this._autoFillService = s, this._localeService = l, this._contextService = a, this._sheetPermissionCheckController = c, this._initialize(), this._initUIEvent();
  }
  _initUIEvent() {
    this.disposeWithMe(
      this._sheetPermissionCheckController.triggerPermissionUIEvent$.subscribe((e) => {
        this._haveNotPermissionHandle(e);
      })
    );
  }
  _haveNotPermissionHandle(e) {
    const t8 = {
      id: sc2,
      title: { title: "permission.dialog.alert" },
      children: {
        label: Af2,
        errorMsg: e
      },
      width: 320,
      destroyOnClose: true,
      showOk: true,
      onClose: () => {
        this._dialogService.close(sc2);
      },
      onOk: () => {
        this._dialogService.close(sc2);
      },
      className: "sheet-permission-user-dialog"
    };
    this._permissionService.getShowComponents() && this._dialogService.open(t8);
  }
  _getPermissionCheck(e, t8) {
    var o, s;
    let n = true, i = "";
    switch (e) {
      case va.id:
      case Ta.id:
        if (this._contextService.getContextValue(DR) === true)
          break;
        n = this._sheetPermissionCheckController.permissionCheckWithoutRange({
          workbookTypes: [Pe],
          rangeTypes: [Le2],
          worksheetTypes: [An, Ve2]
        }), i = this._localeService.t("permission.dialog.editErr");
        break;
      case tt3.id:
        if (t8.visible === false)
          break;
        n = this._sheetPermissionCheckController.permissionCheckWithoutRange({
          workbookTypes: [Pe],
          rangeTypes: [Le2],
          worksheetTypes: [An, Ve2]
        }), i = this._localeService.t("permission.dialog.editErr");
        break;
      case ri4.id:
        n = this._sheetPermissionCheckController.permissionCheckWithoutRange({
          workbookTypes: [Pe],
          rangeTypes: [Le2],
          worksheetTypes: [Ve2, Qt3]
        }), i = this._localeService.t("permission.dialog.pasteErr");
        break;
      case Xc.id:
        n = this._permissionCheckByPaste(t8), i = this._localeService.t("permission.dialog.pasteErr");
        break;
      case wa2.id:
        n = this._sheetPermissionCheckController.permissionCheckWithRanges({
          workbookTypes: [Pe],
          rangeTypes: [Le2],
          worksheetTypes: [Ve2, An, yr]
        }), i = this._localeService.t("permission.dialog.commonErr");
        break;
      case Bc2.id:
      case Bi3.id:
      case Fi3.id:
      case Ui3.id:
      case Xi2.id:
        n = this._sheetPermissionCheckController.permissionCheckWithRanges({
          workbookTypes: [Pe],
          rangeTypes: [Le2],
          worksheetTypes: [yr, Ve2]
        }), i = this._localeService.t("permission.dialog.setStyleErr");
        break;
      case un5.id:
        n = this._sheetPermissionCheckController.permissionCheckWithRanges({
          workbookTypes: [sr2],
          rangeTypes: [Hs],
          worksheetTypes: [mr]
        }), i = this._localeService.t("permission.dialog.copyErr"), (o = this._permissionService.getPermissionPoint(new sr2(this._univerInstanceService.getCurrentUnitForType(we.UNIVER_SHEET).getUnitId()).id)) != null && o.value || (i = this._localeService.t("permission.dialog.workbookCopyErr"));
        break;
      case Yd2.id:
        n = this._sheetPermissionCheckController.permissionCheckWithRanges({
          workbookTypes: [sr2, Pe],
          rangeTypes: [Hs, Le2],
          worksheetTypes: [mr, Ve2]
        }), i = this._localeService.t("permission.dialog.copyErr"), (s = this._permissionService.getPermissionPoint(new sr2(this._univerInstanceService.getCurrentUnitForType(we.UNIVER_SHEET).getUnitId()).id)) != null && s.value || (i = this._localeService.t("permission.dialog.workbookCopyErr"));
        break;
      case gr3.id:
        n = this._permissionCheckByAutoFillCommand(t8), i = this._localeService.t("permission.dialog.autoFillErr");
        break;
    }
    n || this._sheetPermissionCheckController.blockExecuteWithoutPermission(i);
  }
  _initialize() {
    this._commandExecutedListener();
  }
  _commandExecutedListener() {
    this.disposeWithMe(
      this._commandService.beforeCommandExecuted((e) => {
        this._getPermissionCheck(e.id, e == null ? void 0 : e.params);
      })
    );
  }
  _permissionCheckByPaste(e) {
    return e.value === et3.SPECIAL_PASTE_VALUE || e.value === et3.SPECIAL_PASTE_FORMULA ? this._sheetPermissionCheckController.permissionCheckWithRanges({
      workbookTypes: [Pe],
      rangeTypes: [Le2],
      worksheetTypes: [yr, Ve2]
    }) : e.value === et3.SPECIAL_PASTE_FORMAT ? this._sheetPermissionCheckController.permissionCheckWithRanges({
      workbookTypes: [Pe],
      rangeTypes: [Le2],
      worksheetTypes: [yr, Ve2]
    }) : this._sheetPermissionCheckController.permissionCheckWithRanges({
      workbookTypes: [Pe],
      rangeTypes: [Le2],
      worksheetTypes: [An, yr, Ve2]
    });
  }
  _permissionCheckByAutoFillCommand(e) {
    if (!e)
      return false;
    const { targetRange: t8 } = e, n = P(this._univerInstanceService);
    if (!n)
      return false;
    const { worksheet: i, unitId: o, subUnitId: s } = n;
    return !this._rangeProtectionRuleModel.getSubunitRuleList(o, s).reduce((c, d) => [...c, ...d.ranges], []).filter((c) => En.intersects(c, t8)).some((c) => {
      var d, u;
      for (let h = c.startRow; h <= c.endRow; h++)
        for (let g = c.startColumn; g <= c.endColumn; g++) {
          const m2 = (u = (d = i.getCell(h, g)) == null ? void 0 : d.selectionProtection) == null ? void 0 : u[0];
          if ((m2 == null ? void 0 : m2[ae.Edit]) === false)
            return true;
        }
      return false;
    });
  }
};
Ii3 = C_([
  bn3(0, Ls),
  bn3(1, vr),
  bn3(2, eC),
  bn3(3, ct2),
  bn3(4, Inject(me)),
  bn3(5, Hr),
  bn3(6, Inject(Fn)),
  bn3(7, Nr),
  bn3(8, Inject(qn))
], Ii3);
var w_ = Object.getOwnPropertyDescriptor;
var b_ = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? w_(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var dr2 = (r, e) => (t8, n) => e(t8, n, r);
var __ = "__SpreadsheetFreezeRowMainName__";
var R_ = "__SpreadsheetFreezeRowHeaderName__";
var I_ = "__SpreadsheetFreezeColumnMainName__";
var y_ = "__SpreadsheetFreezeColumnHeaderName__";
var lc3 = 2;
var M_ = 0.01;
var Qi3 = qC("freezePermissionCheck");
var Vo3 = class extends Ve {
  constructor(e, t8, n, i, o, s, l, a) {
    super();
    _2(this, "_rowFreezeHeaderRect");
    _2(this, "_rowFreezeMainRect");
    _2(this, "_columnFreezeHeaderRect");
    _2(this, "_columnFreezeMainRect");
    _2(this, "_freezeDownSubs");
    _2(this, "_freezePointerEnterSubs");
    _2(this, "_freezePointerLeaveSubs");
    _2(this, "_scenePointerMoveSub");
    _2(this, "_scenePointerUpSub");
    _2(this, "_changeToRow", -1);
    _2(this, "_changeToColumn", -1);
    _2(this, "_changeToOffsetX", 0);
    _2(this, "_changeToOffsetY", 0);
    _2(this, "_activeViewport", null);
    _2(this, "_freezeNormalHeaderColor", "");
    _2(this, "_freezeNormalMainColor", "");
    _2(this, "_freezeActiveColor", "");
    _2(this, "_freezeHoverColor", "");
    _2(this, "_lastFreeze");
    _2(this, "interceptor", new ZC({ FREEZE_PERMISSION_CHECK: Qi3 }));
    this._context = e, this._sheetSkeletonManagerService = t8, this._commandService = n, this._selectionManagerService = i, this._scrollManagerService = o, this._themeService = s, this._sheetInterceptorService = l, this._injector = a, this._initialize();
  }
  dispose() {
    super.dispose();
  }
  _initialize() {
    this._skeletonListener(), this._commandExecutedListener(), this._themeChangeListener(), this._interceptorCommands(), this._bindViewportScroll(), this._zoomRefresh();
  }
  // eslint-disable-next-line max-lines-per-function, complexity
  _createFreeze(e = 0, t8) {
    var y;
    const n = t8 != null ? t8 : this._getFreeze();
    if (n == null) return null;
    const i = (y = this._sheetSkeletonManagerService.getCurrentParam()) == null ? void 0 : y.skeleton, { startRow: o, startColumn: s } = n, l = this._getPositionByIndex(o, s);
    if (l == null || i == null) return null;
    const a = this._getSheetObject(), c = a.engine, d = (c == null ? void 0 : c.width) || 0, u = (c == null ? void 0 : c.height) || 0, h = a.scene, { startX: g, startY: m2 } = l, { rowTotalHeight: f2, columnTotalWidth: v2, rowHeaderWidthAndMarginLeft: p, columnHeaderHeightAndMarginTop: S } = i, w = d > v2 + p ? d : v2 + S, C = u > f2 + S ? u : f2 + S;
    this._changeToRow = o, this._changeToColumn = s, this._changeToOffsetX = g, this._changeToOffsetY = m2;
    const I2 = Math.max(h.scaleX, h.scaleY);
    let R = lc3 / Math.max(1, I2);
    if (e === 0) {
      (o === -1 || o === 0) && (R = R * 2);
      const M7 = R;
      this._rowFreezeHeaderRect = new I12(R_, {
        fill: this._freezeNormalHeaderColor,
        width: p,
        height: R,
        left: 0,
        top: m2 - M7,
        zIndex: 3
      });
      let E = this._freezeNormalHeaderColor;
      (o === -1 || o === 0) && (E = this._freezeNormalMainColor), this._rowFreezeMainRect = new I12(__, {
        fill: E,
        width: w * 2 / I2,
        height: R,
        left: p,
        top: m2 - M7,
        zIndex: 3
      }), h.addObjects([this._rowFreezeHeaderRect, this._rowFreezeMainRect], rr4);
    } else {
      (s === -1 || s === 0) && (R = R * 2);
      const M7 = R;
      this._columnFreezeHeaderRect = new I12(y_, {
        fill: this._freezeNormalHeaderColor,
        width: R,
        height: S,
        left: g - M7,
        top: 0,
        zIndex: 3
      });
      let E = this._freezeNormalHeaderColor;
      (s === -1 || s === 0) && (E = this._freezeNormalMainColor), this._columnFreezeMainRect = new I12(I_, {
        fill: E,
        width: R,
        height: C * 2 / I2,
        left: g - M7,
        top: S,
        zIndex: 3
      }), h.addObjects([this._columnFreezeHeaderRect, this._columnFreezeMainRect], rr4);
    }
    this._eventBinding(e);
  }
  // eslint-disable-next-line max-lines-per-function
  _eventBinding(e = 0) {
    let t8 = this._rowFreezeHeaderRect, n = this._rowFreezeMainRect;
    e === 1 && (t8 = this._columnFreezeHeaderRect, n = this._columnFreezeMainRect);
    const i = this._getSheetObject();
    if (i == null)
      return;
    const { scene: o } = i;
    if (this._freezePointerEnterSubs = new Subscription(), this._freezePointerLeaveSubs = new Subscription(), this._freezeDownSubs = new Subscription(), n) {
      const a = n.onPointerEnter$.subscribeEvent(() => {
        if (!this.interceptor.fetchThroughInterceptors(Qi3)(true, null))
          return false;
        t8 == null || t8.setProps({
          fill: this._freezeHoverColor,
          zIndex: 4
        }), o.setCursor(v1.GRAB);
      });
      this._freezePointerEnterSubs.add(a);
      const c = n.onPointerLeave$.subscribeEvent(() => {
        t8 == null || t8.setProps({
          fill: this._freezeNormalHeaderColor,
          zIndex: 3
        }), o.resetCursor();
      });
      this._freezePointerLeaveSubs.add(c);
    }
    if (t8) {
      const a = t8.onPointerEnter$.subscribeEvent(() => {
        if (!this.interceptor.fetchThroughInterceptors(Qi3)(true, null))
          return false;
        t8 == null || t8.setProps({
          fill: this._freezeHoverColor,
          zIndex: 4
        }), o.setCursor(v1.GRAB);
      });
      this._freezePointerEnterSubs.add(a);
      const c = t8.onPointerLeave$.subscribeEvent(() => {
        t8 == null || t8.setProps({
          fill: this._freezeNormalHeaderColor,
          zIndex: 3
        }), o.resetCursor();
      });
      this._freezePointerLeaveSubs.add(c);
    }
    const s = t8 == null ? void 0 : t8.onPointerDown$.subscribeEvent((a) => {
      this._freezeDown(a, t8, n, e);
    });
    s && this._freezeDownSubs.add(s);
    const l = n == null ? void 0 : n.onPointerDown$.subscribeEvent((a) => {
      this._freezeDown(a, t8, n, e);
    });
    l && this._freezeDownSubs.add(l);
  }
  // eslint-disable-next-line complexity
  _getCurrentLastVisible() {
    var v2, p, S, w, C, I2, R;
    const e = this._getSheetObject();
    if (e == null)
      return;
    const t8 = (v2 = this._sheetSkeletonManagerService.getCurrentParam()) == null ? void 0 : v2.skeleton;
    if (t8 == null)
      return;
    const n = e.scene, i = Math.max(n.scaleX, n.scaleY), o = this._scrollManagerService.getCurrentScrollState(), s = (e.engine.height - t8.columnHeaderHeight) / i, l = (e.engine.width - t8.rowHeaderWidth) / i, a = (p = o == null ? void 0 : o.sheetViewStartRow) != null ? p : 0, c = a === 0 ? -((S = o == null ? void 0 : o.offsetY) != null ? S : 0) : t8.rowHeightAccumulation[a - 1] - ((w = o == null ? void 0 : o.offsetY) != null ? w : 0);
    let d = 0, u = false;
    for (let y = a, M7 = t8.rowHeightAccumulation.length; y < M7; y++)
      if (t8.rowHeightAccumulation[y] - c > s) {
        d = y, u = true;
        break;
      }
    u || (d = t8.rowHeightAccumulation.length - 1);
    const h = (C = o == null ? void 0 : o.sheetViewStartColumn) != null ? C : 0, g = h === 0 ? -((I2 = o == null ? void 0 : o.offsetX) != null ? I2 : 0) : t8.columnWidthAccumulation[h - 1] - ((R = o == null ? void 0 : o.offsetX) != null ? R : 0);
    let m2 = 0, f2 = false;
    for (let y = h, M7 = t8.columnWidthAccumulation.length; y < M7; y++)
      if (t8.columnWidthAccumulation[y] - g > l) {
        m2 = y, f2 = true;
        break;
      }
    return f2 || (m2 = t8.columnWidthAccumulation.length - 1), { lastRow: d, lastColumn: m2 };
  }
  _getActiveViewport(e) {
    var n;
    const t8 = (n = this._getSheetObject()) == null ? void 0 : n.scene.getViewports();
    return t8 && t8.find((i) => i.isHit(new U(e.offsetX, e.offsetY))) || null;
  }
  // eslint-disable-next-line max-lines-per-function
  _freezeDown(e, t8, n, i = 0) {
    var g;
    const o = (g = this._sheetSkeletonManagerService.getCurrentParam()) == null ? void 0 : g.skeleton;
    if (o == null)
      return;
    const s = this._getSheetObject();
    if (s == null)
      return;
    if (!this.interceptor.fetchThroughInterceptors(Qi3)(true, null))
      return false;
    const { scene: a } = s;
    a.setCursor(v1.GRABBING), a.disableObjectsEvent();
    const c = this._getCurrentLastVisible(), d = c === void 0 ? Number.POSITIVE_INFINITY : o.rowHeightAccumulation[c.lastRow], u = c === void 0 ? Number.POSITIVE_INFINITY : o.columnWidthAccumulation[c.lastColumn - 1] + o.rowHeaderWidth;
    this._activeViewport = null;
    const h = this._getFreeze();
    h && (this._changeToColumn = h.startColumn, this._changeToRow = h.startRow), this._scenePointerMoveSub = a.onPointerMove$.subscribeEvent((m2) => {
      var R, y, M7, E;
      const f2 = this._getActiveViewport(m2), { startX: v2, startY: p, row: S, column: w } = Vn3(
        m2.offsetX,
        m2.offsetY,
        a,
        o,
        f2 || void 0,
        true
      );
      if (!this.interceptor.fetchThroughInterceptors(Qi3)(true, null))
        return false;
      a.setCursor(v1.GRABBING);
      const I2 = lc3 / Math.max(a.scaleX, a.scaleY);
      i === 0 ? ((R = t8.transformByState({
        top: Math.min(p, d) - I2 / 2
      })) == null || R.setProps({
        fill: this._freezeActiveColor
      }), (y = n.transformByState({
        top: Math.min(p, d) - I2 / 2
      })) == null || y.setProps({
        fill: this._freezeNormalHeaderColor
      }), this._changeToRow = c === void 0 ? S : Math.min(S, c.lastRow), this._changeToOffsetY = Math.min(p, d), this._activeViewport = f2) : ((M7 = t8.transformByState({
        left: Math.min(v2, u) - I2 / 2
      })) == null || M7.setProps({
        fill: this._freezeActiveColor
      }), (E = n.transformByState({
        left: Math.min(v2, u) - I2 / 2
      })) == null || E.setProps({
        fill: this._freezeNormalHeaderColor
      }), this._changeToColumn = c === void 0 ? w : Math.min(w, c.lastColumn), this._changeToOffsetX = v2, this._activeViewport = f2);
    }), this._scenePointerUpSub = a.onPointerUp$.subscribeEvent(() => {
      var T, P2;
      a.resetCursor(), a.enableObjectsEvent(), this._clearObserverEvent();
      const { rowHeaderWidthAndMarginLeft: m2, columnHeaderHeightAndMarginTop: f2 } = o;
      i === 0 && (this._changeToRow === 0 || this._changeToRow === -1) || i === 1 && (this._changeToColumn === 0 || this._changeToColumn === -1) ? (t8.setProps({
        fill: this._freezeNormalHeaderColor
      }), n.setProps({
        fill: this._freezeNormalMainColor
      })) : (t8 == null || t8.setProps({
        fill: this._freezeNormalHeaderColor
      }), n == null || n.setProps({
        fill: this._freezeNormalHeaderColor
      }));
      const v2 = lc3 / Math.max(a.scaleX, a.scaleY);
      i === 0 ? (this._changeToRow === 0 || this._changeToRow === -1) && (t8.transformByState({
        top: f2 - v2
      }), n.transformByState({
        top: f2 - v2
      })) : (this._changeToColumn === 0 || this._changeToColumn === -1) && (t8.transformByState({
        left: m2 - v2
      }), n.transformByState({
        left: m2 - v2
      }));
      const p = this._scrollManagerService.getCurrentScrollState() || {
        sheetViewStartRow: 0,
        sheetViewStartColumn: 0
      }, { sheetViewStartRow: S, sheetViewStartColumn: w } = p;
      if (w == null || S == null)
        return;
      const C = this._context.unit, I2 = C.getActiveSheet();
      if (!I2) return;
      const R = (T = I2.getConfig()) == null ? void 0 : T.freeze;
      let y = (R == null ? void 0 : R.xSplit) || 0, M7 = (R == null ? void 0 : R.ySplit) || 0;
      const E = (P2 = this._activeViewport) == null ? void 0 : P2.viewportKey;
      i === 0 && (!E || E === k2.VIEW_LEFT_TOP || E === k2.VIEW_MAIN_LEFT_TOP || E === k2.VIEW_MAIN_TOP || E === k2.VIEW_ROW_TOP ? M7 = this._changeToRow - (R.startRow - R.ySplit) : M7 = this._changeToRow - S, M7 = M7 < 0 ? 0 : M7), i === 1 && (!E || E === k2.VIEW_LEFT_TOP || E === k2.VIEW_MAIN_LEFT_TOP || E === k2.VIEW_MAIN_LEFT || E === k2.VIEW_COLUMN_LEFT ? y = this._changeToColumn - (R.startColumn - R.xSplit) : y = this._changeToColumn - w, y = y < 0 ? 0 : y), this._commandService.executeCommand(Oc.id, {
        startRow: M7 === 0 ? -1 : this._changeToRow,
        startColumn: y === 0 ? -1 : this._changeToColumn,
        ySplit: M7,
        xSplit: y,
        unitId: C.getUnitId(),
        subUnitId: I2.getSheetId()
      });
    });
  }
  _getViewports() {
    const e = this._getSheetObject();
    if (e == null)
      return;
    const { scene: t8 } = e, n = t8.getViewport(k2.VIEW_COLUMN_LEFT), i = t8.getViewport(k2.VIEW_COLUMN_RIGHT), o = t8.getViewport(k2.VIEW_ROW_TOP), s = t8.getViewport(k2.VIEW_ROW_BOTTOM), l = t8.getViewport(k2.VIEW_LEFT_TOP), a = t8.getViewport(k2.VIEW_MAIN), c = t8.getViewport(k2.VIEW_MAIN_LEFT_TOP), d = t8.getViewport(k2.VIEW_MAIN_LEFT), u = t8.getViewport(k2.VIEW_MAIN_TOP);
    if (!(n == null || i == null || o == null || s == null || l == null || a == null || c == null || d == null || u == null))
      return {
        viewMain: a,
        viewMainLeftTop: c,
        viewMainLeft: d,
        viewMainTop: u,
        viewColumnLeft: n,
        viewColumnRight: i,
        viewRowTop: o,
        viewRowBottom: s,
        viewLeftTop: l
      };
  }
  _bindViewportScroll() {
    const e = this._getViewports();
    if (!e)
      return;
    const { viewRowBottom: t8, viewColumnRight: n, viewMainLeft: i, viewMainTop: o } = e;
    this.disposeWithMe(
      this._scrollManagerService.validViewportScrollInfo$.subscribe((s) => {
        if (!s) return;
        const { scrollX: l, scrollY: a, viewportScrollX: c, viewportScrollY: d } = s;
        t8.isActive && t8.updateScrollVal({
          scrollY: a,
          viewportScrollY: d
        }), n.isActive && n.updateScrollVal({
          scrollX: l,
          viewportScrollX: c
        }), i.isActive && i.updateScrollVal({
          scrollY: a,
          viewportScrollY: d
        }), o.isActive && o.updateScrollVal({
          scrollX: l,
          viewportScrollX: c
        });
      })
    );
  }
  // eslint-disable-next-line max-lines-per-function, complexity
  _updateViewport(e = -1, t8 = -1, n = 0, i = 0, o = 3) {
    var y;
    const s = (y = this._sheetSkeletonManagerService.getCurrentParam()) == null ? void 0 : y.skeleton;
    if (s == null)
      return;
    const { rowHeaderWidthAndMarginLeft: l, columnHeaderHeightAndMarginTop: a } = s, c = this._getViewports();
    if (!c)
      return;
    const {
      viewMain: d,
      viewMainLeftTop: u,
      viewMainLeft: h,
      viewMainTop: g,
      viewColumnLeft: m2,
      viewColumnRight: f2,
      viewRowTop: v2,
      viewRowBottom: p,
      viewLeftTop: S
    } = c;
    f2.resizeWhenFreezeChange({
      left: l,
      top: 0,
      // ctx.clip by the size of viewport, and selection header border is slightly below column header
      // I think it's a bad design, Should not clip for selection rendering in viewport,
      height: a + 1,
      right: 0
    }), p.resizeWhenFreezeChange({
      left: 0,
      top: a,
      bottom: 0,
      width: l + 1
    }), S.resizeWhenFreezeChange({
      left: 0,
      top: 0,
      width: l + 1,
      height: a
    });
    let w = true, C = true;
    u.enable(), (e === -1 || e === 0) && (w = false), (t8 === -1 || t8 === 0) && (C = false);
    const I2 = s.getNoMergeCellWithCoordByIndex(e - n, t8 - i, false), R = s.getNoMergeCellWithCoordByIndex(e, t8, false);
    if (u.disable(), g.disable(), h.disable(), v2.disable(), m2.disable(), u.resetPadding(), g.resetPadding(), h.resetPadding(), v2.resetPadding(), m2.resetPadding(), w === false && C === false)
      d.resizeWhenFreezeChange({
        left: l,
        top: a,
        bottom: 0,
        right: 0
      }), d.resetPadding(), h.resizeWhenFreezeChange({
        left: l,
        top: a,
        bottom: 0,
        width: 0
      }), g.resizeWhenFreezeChange({
        left: l,
        top: a,
        height: 0,
        right: 0
      }), u.resizeWhenFreezeChange({
        left: l,
        top: a,
        width: 0,
        height: 0
      }), v2.resizeWhenFreezeChange({
        left: 0,
        top: a,
        width: l + 1,
        height: 0
      }), m2.resizeWhenFreezeChange({
        left: 0,
        top: 0,
        height: a + 1,
        width: 0
      });
    else if (w === true && C === false) {
      const M7 = R.startY - I2.startY;
      d.resizeWhenFreezeChange({
        left: l,
        top: a + M7,
        bottom: 0,
        right: 0
      }), d.setPadding({
        startY: I2.startY,
        endY: R.startY,
        startX: 0,
        endX: 0
      }), o & 2 && this._commandService.executeCommand(mn3.id, {
        sheetViewStartRow: 0,
        offsetY: 0
      }), g.resizeWhenFreezeChange({
        left: l,
        top: a,
        height: M7,
        right: 0
      }), g.updateScrollVal({
        viewportScrollY: I2.startY,
        rawScrollX: d.scrollX,
        viewportScrollX: d.viewportScrollX
      }), v2.resizeWhenFreezeChange({
        left: 0,
        top: a,
        width: l + 1,
        height: M7
      }), v2.updateScrollVal({
        viewportScrollY: I2.startY
      }), p.resizeWhenFreezeChange({
        left: 0,
        top: a + M7,
        bottom: 0,
        width: l + 1
      }), g.enable(), v2.enable();
    } else if (w === false && C === true) {
      const M7 = R.startX - I2.startX;
      d.resizeWhenFreezeChange({
        left: l + M7,
        top: a,
        bottom: 0,
        right: 0
      }), d.setPadding({
        startX: I2.startX,
        endX: R.startX,
        startY: 0,
        endY: 0
      }), o & 1 && this._commandService.executeCommand(mn3.id, {
        sheetViewStartColumn: 0,
        offsetX: 0
      }), h.resizeWhenFreezeChange({
        left: l,
        top: a,
        width: M7,
        bottom: 0,
        right: 0
      }), h.updateScrollVal({
        viewportScrollX: I2.startX,
        rawScrollY: d.scrollY,
        viewportScrollY: d.viewportScrollY
      }), m2.resizeWhenFreezeChange({
        left: l,
        top: 0,
        width: M7,
        height: a + 1
      }), m2.updateScrollVal({
        viewportScrollX: I2.startX
      }), f2.resizeWhenFreezeChange({
        left: l + M7,
        top: 0,
        height: a + 1,
        right: 0
      }), h.enable(), m2.enable();
    } else {
      const M7 = R.startX - I2.startX, E = R.startY - I2.startY;
      d.resizeWhenFreezeChange({
        left: l + M7,
        top: a + E,
        bottom: 0,
        right: 0
      }), d.setPadding({
        startY: I2.startY,
        endY: R.startY,
        startX: I2.startX,
        endX: R.startX
      }), o && this._commandService.executeCommand(mn3.id, {
        ...o & 1 ? {
          sheetViewStartColumn: 0,
          offsetX: 0
        } : null,
        ...o & 2 ? {
          sheetViewStartRow: 0,
          offsetY: 0
        } : null
      }), h.resizeWhenFreezeChange({
        left: l,
        top: a + E,
        width: M7,
        bottom: 0
      }), h.updateScrollVal({
        viewportScrollX: I2.startX,
        rawScrollY: d.scrollY,
        viewportScrollY: d.viewportScrollY
      }), g.resizeWhenFreezeChange({
        left: l + M7,
        top: a,
        height: E,
        right: 0
      }), g.updateScrollVal({
        viewportScrollY: I2.startY,
        rawScrollX: d.scrollX,
        viewportScrollX: d.viewportScrollX
      }), u.resizeWhenFreezeChange({
        left: l,
        top: a,
        width: M7,
        height: E
      }), u.updateScrollVal({
        viewportScrollX: I2.startX,
        viewportScrollY: I2.startY
      }), v2.resizeWhenFreezeChange({
        left: 0,
        top: a,
        width: l + 1,
        height: E
      }), v2.updateScrollVal({
        viewportScrollY: I2.startY
      }), p.resizeWhenFreezeChange({
        left: 0,
        top: a + E,
        bottom: 0,
        width: l + 1
      }), m2.resizeWhenFreezeChange({
        left: l,
        top: 0,
        width: M7,
        height: a + 1
      }), m2.updateScrollVal({
        viewportScrollX: I2.startX
      }), f2.resizeWhenFreezeChange({
        left: l + M7,
        top: 0,
        height: a + 1,
        right: 0
      }), u.enable(), g.enable(), h.enable(), v2.enable(), m2.enable();
    }
  }
  /**
   * When switching sheet tabs, it is necessary to update the frozen state of the current view.
   */
  _skeletonListener() {
    this.disposeWithMe(
      We(
        this._sheetSkeletonManagerService.currentSkeleton$.subscribe((e) => {
          [
            pn2.id,
            Nt.id,
            an.id
          ].includes((e == null ? void 0 : e.commandId) || "") && this._refreshCurrent();
        })
      )
    );
  }
  _refreshCurrent() {
    const t8 = this._context.unit.getActiveSheet();
    if (!t8) return;
    const n = t8.getConfig().freeze, { startRow: i = -1, startColumn: o = -1, ySplit: s = 0, xSplit: l = 0 } = n;
    this._refreshFreeze(
      i,
      o,
      s,
      l,
      0
      /* NONE */
    );
  }
  _themeChangeListener() {
    this._themeChange(this._themeService.getCurrentTheme()), this.disposeWithMe(
      this._themeService.currentTheme$.subscribe((e) => {
        this._clearFreeze(), this._themeChange(e), this._refreshCurrent();
      })
    );
  }
  _themeChange(e) {
    this._freezeNormalHeaderColor = vf(e, "gray.300"), this._freezeNormalMainColor = new bt(this._freezeNormalHeaderColor).setAlpha(M_).toRgbString(), this._freezeActiveColor = vf(e, "primary.600"), this._freezeHoverColor = vf(e, "gray.500");
  }
  // eslint-disable-next-line max-lines-per-function
  _interceptorCommands() {
    this.disposeWithMe(
      this._sheetInterceptorService.interceptCommand({
        // eslint-disable-next-line complexity, max-lines-per-function
        getMutations: (e) => {
          const t8 = {
            redos: [],
            undos: []
          }, n = this._getFreeze();
          if (!n)
            return t8;
          const i = (o) => {
            const s = this._context.unit, l = s.getUnitId(), a = s.getActiveSheet();
            if (!a)
              return t8;
            const c = a.getSheetId();
            this._refreshFreeze(
              o.startRow,
              o.startColumn,
              o.ySplit,
              o.xSplit,
              0
              /* NONE */
            );
            const d = {
              ...o,
              unitId: l,
              subUnitId: c,
              resetScroll: false
            }, u = ei(this._injector, d);
            return {
              undos: [{ id: st.id, params: u }],
              redos: [{ id: st.id, params: d }]
            };
          };
          if (e.id === Ye.id) {
            const o = e.params, { range: s, direction: l } = o, a = s.endRow - s.startRow + 1;
            if (s.startRow < n.startRow || s.startRow + 1 === n.startRow && l === Cm.UP) {
              const c = {
                ...n,
                startRow: Math.max(1, n.startRow + a),
                ySplit: Math.max(1, n.ySplit + a)
              };
              return i(c);
            }
          }
          if (e.id === Xe.id) {
            const o = e.params, { range: s, direction: l } = o, a = s.endColumn - s.startColumn + 1;
            if (s.startColumn < n.startColumn || s.startColumn + 1 === n.startColumn && l === Cm.LEFT) {
              const c = {
                ...n,
                startColumn: Math.max(1, n.startColumn + a),
                xSplit: Math.max(1, n.xSplit + a)
              };
              return i(c);
            }
          }
          if (e.id === ln.id) {
            const o = this._selectionManagerService.getCurrentSelections(), {
              fromRange: { startColumn: s },
              toRange: { startColumn: l }
            } = e.params, a = o == null ? void 0 : o.filter(
              (v2) => v2.range.rangeType === ge.COLUMN && v2.range.startColumn <= s && s <= v2.range.endColumn
            );
            if (!(a != null && a.length))
              return t8;
            const c = a[0].range, d = {
              ...c,
              startColumn: l,
              endColumn: l + c.endColumn - c.startColumn
            };
            if (!n || n.startColumn <= 0 || // move out of freeze
            c.startColumn >= n.startColumn && d.startColumn >= n.startColumn || // not move
            c.startColumn === d.startColumn || // move in freeze range
            c.endColumn < n.startColumn && d.startColumn < n.startColumn)
              return t8;
            const u = c.endColumn - c.startColumn + 1, h = Math.max(
              Math.min(n.startColumn, c.endColumn + 1) - c.startColumn,
              0
            );
            let g, m2;
            d.startColumn >= n.startColumn ? (g = Math.max(n.startColumn - h, 1), m2 = Math.max(n.xSplit - h, 1)) : (g = n.startColumn + u - h, m2 = n.xSplit + u - h);
            const f2 = {
              ...n,
              startColumn: g,
              xSplit: m2
            };
            return i(f2);
          }
          if (e.id === un2.id) {
            const o = this._selectionManagerService.getCurrentSelections(), {
              fromRange: { startRow: s },
              toRange: { startRow: l }
            } = e.params, a = o == null ? void 0 : o.filter(
              (v2) => v2.range.rangeType === ge.ROW && v2.range.startRow <= s && s <= v2.range.endRow
            );
            if (!(a != null && a.length))
              return t8;
            const c = a[0].range, d = {
              ...c,
              startRow: l,
              endRow: l + c.endRow - c.startRow
            };
            if (!n || n.startRow <= 0 || // move out of freeze
            c.startRow >= n.startRow && d.startRow >= n.startRow || // not move
            c.startRow === d.startRow || // move in freeze range
            c.endRow < n.startRow && d.startRow < n.startRow)
              return t8;
            const u = c.endRow - c.startRow + 1, h = Math.max(
              Math.min(n.startRow, c.endRow + 1) - c.startRow,
              0
            );
            let g, m2;
            d.startRow >= n.startRow ? (g = Math.max(n.startRow - h, 1), m2 = Math.max(n.ySplit - h, 1)) : (g = n.startRow + u - h, m2 = n.ySplit + u - h);
            const f2 = {
              ...n,
              startRow: g,
              ySplit: m2
            };
            return i(f2);
          }
          if (e.id === ds.id || e.id === cs.id) {
            const o = e.params, s = o.range;
            if (s.rangeType === ge.COLUMN && s.startColumn < n.startColumn) {
              const l = Math.min(n.startColumn, s.endColumn + 1) - s.startColumn, a = {
                ...n,
                startColumn: Math.max(1, n.startColumn - l),
                xSplit: Math.max(1, n.xSplit - l)
              };
              return i(a);
            }
            if (o.range.rangeType === ge.ROW && s.startRow < n.startRow) {
              const l = Math.min(n.startRow, s.endRow + 1) - s.startRow, a = {
                ...n,
                startRow: Math.max(1, n.startRow - l),
                ySplit: Math.max(1, n.ySplit - l)
              };
              return i(a);
            }
          }
          return t8;
        }
      })
    );
  }
  /**
   * Update freeze line position when some cmds cause sk change.
   */
  // TODO @lumixraku But there is a _zoomRefresh method? Duplicated?
  _commandExecutedListener() {
    this.disposeWithMe(
      // eslint-disable-next-line complexity
      this._commandService.onCommandExecuted((e) => {
        switch (e.id) {
          case st.id:
          case Jt3.id:
            {
              const t8 = this._lastFreeze, n = this._context.unit, i = n.getActiveSheet(), o = e.params, { unitId: s, subUnitId: l } = o;
              if (!(s === n.getUnitId() && l === (i == null ? void 0 : i.getSheetId())))
                return;
              const a = i.getConfig().freeze;
              if (this._lastFreeze = a, a == null)
                return;
              let c = 0;
              const { startRow: d = -1, startColumn: u = -1, ySplit: h = 0, xSplit: g = 0 } = a;
              (!t8 || t8.startRow !== d || t8.ySplit !== h) && (c |= 2), (!t8 || t8.startColumn !== u || t8.xSplit !== g) && (c |= 1), o.resetScroll === false && (c = 0), this._refreshFreeze(d, u, h, g, c);
            }
            break;
          case nt.id:
            {
              const t8 = this._getFreeze(), n = t8 && e.params.ranges.some((i) => i.startRow < t8.startRow);
              e.params && n && this._refreshCurrent();
            }
            break;
          case mt.id:
            {
              const t8 = this._getFreeze();
              e.params && t8 && e.params.ranges.some(
                (n) => n.startColumn < t8.startColumn
              ) && this._refreshCurrent();
            }
            break;
          case Xo.id:
            {
              const t8 = e.params, n = this._getFreeze();
              if (n && n.startRow > -1 && t8.rowsAutoHeightInfo.some((i) => i.row < n.startRow)) {
                const i = this._sheetSkeletonManagerService.currentSkeleton$.subscribe(() => {
                  this._refreshCurrent(), setTimeout(() => {
                    i.unsubscribe();
                  });
                });
              }
            }
            break;
          case on.id:
          case rn.id:
            {
              const t8 = e.params, n = this._getFreeze(), i = t8.ranges;
              n && n.startColumn > -1 && i.some((o) => o.startColumn < n.startColumn) && this._refreshCurrent();
            }
            break;
          case Pt2.id:
          case Tt.id:
            {
              const t8 = e.params, n = this._getFreeze(), i = t8.ranges;
              n && n.startRow > -1 && i.some((o) => o.startRow < n.startRow) && this._refreshCurrent();
            }
            break;
          case oa.id:
          case sa.id:
            this._refreshCurrent();
        }
      })
    );
  }
  _zoomRefresh() {
    const e = this._getSheetObject();
    if (e == null)
      return;
    const { scene: t8 } = e;
    this.disposeWithMe(t8.onTransformChange$.subscribeEvent((n) => {
      [x1.scale, x1.all].includes(n.type) && this._refreshCurrent();
    }));
  }
  _clearObserverEvent() {
    var t8, n;
    this._getSheetObject() != null && ((t8 = this._scenePointerMoveSub) == null || t8.unsubscribe(), (n = this._scenePointerUpSub) == null || n.unsubscribe(), this._scenePointerMoveSub = null, this._scenePointerUpSub = null);
  }
  _clearFreeze() {
    var t8, n, i, o, s, l;
    (t8 = this._rowFreezeHeaderRect) == null || t8.dispose(), (n = this._rowFreezeMainRect) == null || n.dispose(), (i = this._columnFreezeHeaderRect) == null || i.dispose(), (o = this._columnFreezeMainRect) == null || o.dispose(), this._getSheetObject() != null && ([this._freezeDownSubs, this._freezePointerEnterSubs, this._freezePointerLeaveSubs].forEach((a) => {
      a == null || a.unsubscribe();
    }), this._freezeDownSubs = null, this._freezePointerEnterSubs = null, this._freezePointerLeaveSubs = null, (s = this._scenePointerMoveSub) == null || s.unsubscribe(), (l = this._scenePointerUpSub) == null || l.unsubscribe(), this._scenePointerMoveSub = null, this._scenePointerUpSub = null);
  }
  _getPositionByIndex(e, t8) {
    var a;
    if (this._getSheetObject() == null)
      return;
    const i = (a = this._sheetSkeletonManagerService.getCurrentParam()) == null ? void 0 : a.skeleton, o = i == null ? void 0 : i.getNoMergeCellWithCoordByIndex(e, t8);
    if (i == null)
      return;
    if (o != null && (!isNaN(o.endX) || !isNaN(o.endY)))
      return o;
    const { rowHeaderWidthAndMarginLeft: s, columnHeaderHeightAndMarginTop: l } = i;
    return {
      startX: s,
      endX: s,
      startY: l,
      endY: l
    };
  }
  _getFreeze() {
    var t8;
    const e = (t8 = this._sheetSkeletonManagerService.getCurrentParam()) == null ? void 0 : t8.skeleton.getWorksheetConfig();
    if (e != null)
      return e.freeze;
  }
  _getSheetObject() {
    return en4(this._context.unit, this._context);
  }
  /**
   * Core function of _refreshCurrent
   * @param startRow
   * @param startColumn
   * @param ySplit
   * @param xSplit
   * @param resetScroll
   */
  _refreshFreeze(e, t8, n, i, o) {
    var l;
    const s = {
      startRow: e,
      startColumn: t8,
      ySplit: n,
      xSplit: i
    };
    this._clearFreeze(), this._createFreeze(0, s), this._createFreeze(1, s), this._updateViewport(e, t8, n, i, o), (l = this._getSheetObject()) == null || l.spreadsheet.makeForceDirty();
  }
};
Vo3 = b_([
  dr2(1, Inject(ue)),
  dr2(2, Ls),
  dr2(3, Inject(z)),
  dr2(4, Inject(Et2)),
  dr2(5, Inject(Gi)),
  dr2(6, Inject(G)),
  dr2(7, Inject(Injector))
], Vo3);
var E_ = Object.getOwnPropertyDescriptor;
var T_ = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? E_(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var ac3 = (r, e) => (t8, n) => e(t8, n, r);
var P_ = "__SpreadsheetHeaderMoveControllerBackground__";
var x_ = "__SpreadsheetHeaderMoveControllerShapeLine__";
var O_ = "rgba(0, 0, 0, 0.1)";
var A_ = "rgb(119, 119, 119)";
var H_ = 4;
var cc2 = qC("headerMovePermissionCheck");
var No3 = class extends Ve {
  constructor(e, t8, n, i) {
    super();
    _2(this, "_startOffsetX", Number.NEGATIVE_INFINITY);
    _2(this, "_startOffsetY", Number.NEGATIVE_INFINITY);
    _2(this, "_moveHelperBackgroundShape");
    _2(this, "_moveHelperLineShape");
    _2(this, "_headerPointerDownSubs");
    _2(this, "_headerPointerMoveSubs");
    _2(this, "_headerPointerLeaveSubs");
    _2(this, "_dragHeaderMoveSub");
    _2(this, "_scenePointerUpSub");
    _2(this, "_scrollTimer");
    _2(this, "_changeFromColumn", -1);
    _2(this, "_changeFromRow", -1);
    _2(this, "_changeToColumn", -1);
    _2(this, "_changeToRow", -1);
    _2(this, "interceptor", new ZC({ HEADER_MOVE_PERMISSION_CHECK: cc2 }));
    _2(this, "_workbookSelections");
    this._context = e, this._sheetSkeletonManagerService = n, this._commandService = i, this._workbookSelections = t8.getWorkbookSelections(this._context.unitId), this._init();
  }
  dispose() {
    var e, t8, n, i, o, s, l, a;
    (e = this._moveHelperBackgroundShape) == null || e.dispose(), (t8 = this._moveHelperLineShape) == null || t8.dispose(), (n = this._headerPointerMoveSubs) == null || n.unsubscribe(), (i = this._headerPointerLeaveSubs) == null || i.unsubscribe(), (o = this._headerPointerDownSubs) == null || o.unsubscribe(), this._headerPointerMoveSubs = null, this._headerPointerLeaveSubs = null, this._headerPointerDownSubs = null, (s = this._dragHeaderMoveSub) == null || s.unsubscribe(), (l = this._scenePointerUpSub) == null || l.unsubscribe(), this._dragHeaderMoveSub = null, this._scenePointerUpSub = null, (a = this._scrollTimer) == null || a.dispose();
  }
  _init() {
    this._initialRowOrColumn(ge.ROW), this._initialRowOrColumn(ge.COLUMN);
  }
  // eslint-disable-next-line max-lines-per-function
  _initialRowOrColumn(e = ge.ROW) {
    const t8 = this._context.components.get(Ye3.COLUMN), n = this._context.components.get(Ye3.ROW), i = this._context.scene, o = e === ge.ROW ? n : t8, s = (c) => {
      var p, S;
      const d = (p = this._sheetSkeletonManagerService.getCurrentParam()) == null ? void 0 : p.skeleton;
      if (d == null)
        return;
      const u = (S = this._workbookSelections.getCurrentLastSelection()) == null ? void 0 : S.range;
      if (!u || !this.interceptor.fetchThroughInterceptors(cc2)(false, u))
        return;
      const g = this._workbookSelections.getCurrentSelections(), { row: m2, column: f2 } = Vn3(c.offsetX, c.offsetY, i, d);
      if (!gl(
        g,
        e === ge.ROW ? m2 : f2,
        e
      )) {
        i.resetCursor();
        return;
      }
      i.setCursor(v1.GRAB);
    }, l = () => {
      var c, d;
      (c = this._moveHelperBackgroundShape) == null || c.hide(), (d = this._moveHelperLineShape) == null || d.hide(), i.resetCursor();
    }, a = (c, d) => {
      var H3, A;
      if (d.isStopPropagation) return;
      const u = (H3 = this._sheetSkeletonManagerService.getCurrentParam()) == null ? void 0 : H3.skeleton;
      if (u == null)
        return;
      const h = (A = this._workbookSelections.getCurrentLastSelection()) == null ? void 0 : A.range;
      if (!h || !this.interceptor.fetchThroughInterceptors(cc2)(false, h))
        return;
      const { offsetX: m2, offsetY: f2 } = c, v2 = i.getCoordRelativeToViewport(U.FromArray([m2, f2])), { x: p, y: S } = v2;
      this._startOffsetX = p, this._startOffsetY = S;
      const { row: w, column: C } = Vn3(c.offsetX, c.offsetY, i, u);
      let I2;
      e === ge.ROW ? (this._changeFromRow = w, I2 = bE.Y) : (this._changeFromColumn = C, I2 = bE.X);
      const R = this._workbookSelections.getCurrentSelections(), y = gl(
        R,
        e === ge.ROW ? w : C,
        e
      );
      if (!y)
        return;
      const M7 = i.getScrollXYInfoByViewport(
        U.FromArray([this._startOffsetX, this._startOffsetY])
      );
      this._newBackgroundAndLine(), i.setCursor(v1.GRABBING), i.disableObjectsEvent();
      let E = false, T;
      const P2 = () => {
        if (E)
          return;
        T = y0.create(i, I2), this._scrollTimer = T;
        const x7 = i.getViewport(k2.VIEW_MAIN);
        T.startScroll(p, S, x7), E = true;
      };
      this._dragHeaderMoveSub = i.onPointerMove$.subscribeEvent((x7) => {
        P2();
        const { offsetX: V2, offsetY: D2 } = x7, { x: X2, y: B } = i.getCoordRelativeToViewport(
          U.FromArray([V2, D2])
        );
        this._rowColumnMoving(
          X2,
          B,
          y,
          M7,
          e
        ), T.scrolling(X2, B, () => {
          this._rowColumnMoving(
            X2,
            B,
            y,
            M7,
            e
          );
        });
      }), this._scenePointerUpSub = i.onPointerUp$.subscribeEvent(() => {
        var V2, D2, X2;
        this._disposeBackgroundAndLine(), i.resetCursor(), i.enableObjectsEvent(), this._clearObserverEvent(), (V2 = this._scrollTimer) == null || V2.dispose();
        const x7 = this._workbookSelections.getCurrentSelections();
        if (e === ge.ROW) {
          if (this._changeFromRow !== this._changeToRow && this._changeToRow !== -1) {
            const j = (D2 = ((x7 == null ? void 0 : x7.filter(
              (G7) => G7.range.rangeType === ge.ROW && G7.range.startRow <= this._changeFromRow && this._changeFromRow <= G7.range.endRow
            )) || [])[0]) == null ? void 0 : D2.range;
            j && this._commandService.executeCommand(un2.id, {
              fromRange: j,
              toRange: {
                ...j,
                startRow: this._changeToRow,
                endRow: this._changeToRow + j.endRow - j.startRow
              }
            });
          }
          this._changeToRow = this._changeFromRow = -1;
        } else {
          if (this._changeFromColumn !== this._changeToColumn && this._changeToColumn !== -1) {
            const j = (X2 = ((x7 == null ? void 0 : x7.filter(
              (G7) => G7.range.rangeType === ge.COLUMN && G7.range.startColumn <= this._changeFromColumn && this._changeFromColumn <= G7.range.endColumn
            )) || [])[0]) == null ? void 0 : X2.range;
            j && this._commandService.executeCommand(ln.id, {
              fromRange: j,
              toRange: {
                ...j,
                startColumn: this._changeToColumn,
                endColumn: this._changeToColumn + j.endColumn - j.startColumn
              }
            });
          }
          this._changeToColumn = this._changeFromColumn = -1;
        }
      });
    };
    this._headerPointerMoveSubs = new Subscription(), this._headerPointerMoveSubs.add(o.onPointerMove$.subscribeEvent(s)), this._headerPointerLeaveSubs = new Subscription(), this._headerPointerLeaveSubs.add(o == null ? void 0 : o.onPointerLeave$.subscribeEvent(l)), this._headerPointerDownSubs = new Subscription(), this._headerPointerDownSubs.add(o == null ? void 0 : o.onPointerDown$.subscribeEvent(a));
  }
  // eslint-disable-next-line max-lines-per-function
  _rowColumnMoving(e, t8, n, i, o) {
    var B, j, G7, ge2, Re3, be2, Ne3;
    const s = this._context.scene, l = (B = this._sheetSkeletonManagerService.getCurrentParam()) == null ? void 0 : B.skeleton;
    if (l == null)
      return;
    const { rowHeaderWidth: a, columnHeaderHeight: c, rowTotalHeight: d, columnTotalWidth: u } = l, h = s.getViewportScrollXY(s.getViewport(k2.VIEW_MAIN)), { scaleX: g, scaleY: m2 } = s.getAncestorScale(), f2 = l.getCellIndexByOffset(
      e,
      t8,
      g,
      m2,
      h
    ), { row: v2, column: p } = f2, S = l.getNoMergeCellWithCoordByIndex(v2, p), { startX: w, startY: C, endX: I2, endY: R } = S, y = this._sheetSkeletonManagerService.attachRangeWithCoord(n.range);
    if (y == null)
      return;
    const M7 = Math.max(g, g), {
      startX: E,
      endX: T,
      startY: P2,
      endY: H3,
      startRow: A,
      startColumn: x7,
      endRow: V2,
      endColumn: D2
    } = y;
    o === ge.ROW ? (j = this._moveHelperBackgroundShape) == null || j.transformByState({
      height: H3 - P2,
      width: u + a,
      left: 0,
      top: P2 + (t8 - this._startOffsetY) / M7 + h.y - i.y
    }) : (G7 = this._moveHelperBackgroundShape) == null || G7.transformByState({
      height: d + c,
      width: T - E,
      left: E + (e - this._startOffsetX) / M7 + h.x - i.x,
      top: 0
    }), (ge2 = this._moveHelperBackgroundShape) == null || ge2.show();
    const X2 = H_ / M7;
    if (o === ge.ROW) {
      let Z7 = 0;
      if (v2 <= A)
        Z7 = C - X2 / 2, this._changeToRow = v2;
      else if (v2 > V2)
        Z7 = R - X2 / 2, this._changeToRow = v2 + 1;
      else
        return;
      (Re3 = this._moveHelperLineShape) == null || Re3.transformByState({
        height: X2,
        width: u,
        left: a,
        top: Z7
      });
    } else {
      let Z7 = 0;
      if (p <= x7)
        Z7 = w - X2 / 2, this._changeToColumn = p;
      else if (p > D2)
        Z7 = I2 - X2 / 2, this._changeToColumn = p + 1;
      else
        return;
      (be2 = this._moveHelperLineShape) == null || be2.transformByState({
        height: d,
        width: X2,
        left: Z7,
        top: c
      });
    }
    (Ne3 = this._moveHelperLineShape) == null || Ne3.show();
  }
  _clearObserverEvent() {
    var e, t8;
    (e = this._dragHeaderMoveSub) == null || e.unsubscribe(), (t8 = this._scenePointerUpSub) == null || t8.unsubscribe(), this._dragHeaderMoveSub = null, this._scenePointerUpSub = null;
  }
  _newBackgroundAndLine() {
    const e = this._context.scene;
    this._moveHelperBackgroundShape = new I12(P_, {
      fill: O_,
      evented: false,
      zIndex: 100
    }), this._moveHelperLineShape = new I12(x_, {
      fill: A_,
      evented: false,
      zIndex: 100
    }), e.addObjects(
      [this._moveHelperBackgroundShape, this._moveHelperLineShape],
      rr4
    );
  }
  _disposeBackgroundAndLine() {
    var e, t8;
    (e = this._moveHelperBackgroundShape) == null || e.dispose(), (t8 = this._moveHelperLineShape) == null || t8.dispose();
  }
};
No3 = T_([
  ac3(1, Inject(z)),
  ac3(2, Inject(ue)),
  ac3(3, Ls)
], No3);
var qc = ((r) => (r[r.VERTICAL = 0] = "VERTICAL", r[r.HORIZONTAL = 1] = "HORIZONTAL", r))(qc || {});
var V_ = "rgba(120, 120, 120, 0.01)";
var dc2 = "rgb(68, 71, 70)";
var lo3 = 12;
var N_ = 44;
var Qc = 4;
var Ph2 = class extends x3 {
  constructor(t8, n) {
    super(t8, n);
    _2(this, "_size", lo3);
    _2(this, "_color", dc2);
    _2(this, "_mode", 0);
    this.setShapeProps(n);
  }
  get size() {
    return this._size;
  }
  get mode() {
    return this._mode;
  }
  get color() {
    return this._color;
  }
  _draw(t8) {
    const n = this.getScene();
    if (!n) return;
    const { scaleX: i, scaleY: o } = n.getAncestorScale(), s = Math.max(i, o), l = lo3 / s, a = Qc / s;
    let { width: c, height: d } = this, u = 0, h = 0;
    this.mode === 0 ? (c = a, u = l - a) : (d = a, h = l - a), I12.drawWith(t8, {
      width: this.width,
      height: this.height,
      left: 0,
      top: 0,
      fill: V_
    }), I12.drawWith(t8, {
      width: c,
      height: d,
      fill: dc2,
      radius: a
    }), t8.save(), t8.transform(1, 0, 0, 1, u, h), I12.drawWith(t8, {
      width: c,
      height: d,
      fill: dc2,
      radius: a
    }), t8.restore();
  }
  setShapeProps(t8) {
    return t8 != null && t8.size && (this._size = t8.size), t8 != null && t8.mode && (this._mode = t8.mode), t8 != null && t8.color && (this._color = t8.color), this.mode === 0 ? this.transformByState({
      width: lo3,
      height: this.size
    }) : this.transformByState({
      width: this.size,
      height: lo3
    }), this;
  }
};
var k_ = Object.getOwnPropertyDescriptor;
var D_ = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? k_(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var uc2 = (r, e) => (t8, n) => e(t8, n, r);
var L_ = "__SpreadsheetHeaderResizeControllerShapeRow__";
var W_ = "__SpreadsheetHeaderResizeControllerShapeColumn__";
var xh2 = "__SpreadsheetHeaderResizeControllerShapeHelper__";
var Oh2 = "rgb(199, 199, 199)";
var B_ = 2;
var hc3 = qC("headerResizePermissionCheck");
var ko3 = class extends Ve {
  constructor(e, t8, n, i) {
    super();
    _2(this, "_currentRow", 0);
    _2(this, "_currentColumn", 0);
    _2(this, "_rowResizeRect");
    _2(this, "_columnResizeRect");
    _2(this, "_headerPointerSubs");
    _2(this, "_scenePointerMoveSub");
    _2(this, "_scenePointerUpSub");
    _2(this, "_resizeHelperShape");
    _2(this, "_startOffsetX", Number.POSITIVE_INFINITY);
    _2(this, "_startOffsetY", Number.POSITIVE_INFINITY);
    _2(this, "interceptor", new ZC({ HEADER_RESIZE_PERMISSION_CHECK: hc3 }));
    this._context = e, this._sheetSkeletonManagerService = t8, this._selectionManagerService = n, this._commandService = i, this._init();
  }
  dispose() {
    var e, t8, n;
    (e = this._rowResizeRect) == null || e.dispose(), this._rowResizeRect = null, (t8 = this._columnResizeRect) == null || t8.dispose(), this._columnResizeRect = null, (n = this._headerPointerSubs) == null || n.unsubscribe(), this._headerPointerSubs = null;
  }
  _init() {
    const e = this._context.scene;
    this._rowResizeRect = new Ph2(L_, {
      visible: false,
      mode: qc.HORIZONTAL,
      zIndex: 100
    }), this._columnResizeRect = new Ph2(W_, {
      visible: false,
      mode: qc.VERTICAL,
      zIndex: 100
    }), e.addObjects([this._rowResizeRect, this._columnResizeRect], rr4), this._initialHover(
      0
      /* ROW */
    ), this._initialHover(
      1
      /* COLUMN */
    ), this._initialHoverResize(
      0
      /* ROW */
    ), this._initialHoverResize(
      1
      /* COLUMN */
    );
  }
  _initialHover(e = 0) {
    const t8 = this._context.components.get(Ye3.COLUMN), n = this._context.components.get(Ye3.ROW), i = this._context.scene, o = e === 0 ? n : t8, s = (a, c) => {
      var d, u;
      (d = this._rowResizeRect) == null || d.hide(), (u = this._columnResizeRect) == null || u.hide();
    }, l = (a, c) => {
      var M7;
      const d = (M7 = this._sheetSkeletonManagerService.getCurrentParam()) == null ? void 0 : M7.skeleton;
      if (d == null || this._rowResizeRect == null || this._columnResizeRect == null)
        return;
      const { rowHeaderWidth: u, columnHeaderHeight: h } = d, { startX: g, startY: m2, endX: f2, endY: v2, row: p, column: S } = Vn3(
        a.offsetX,
        a.offsetY,
        i,
        d
      ), w = Os3(a.offsetX, a.offsetY, i), { scaleX: C, scaleY: I2 } = i.getAncestorScale(), R = Math.max(C, I2), y = lo3 / R;
      if (e === 0) {
        let E = m2 - y / 2;
        if (w.y <= m2 + y / 2 && w.y >= m2)
          this._currentRow = p - 1;
        else if (w.y >= v2 - y / 2 && w.y <= v2)
          this._currentRow = p, E = v2 - y / 2;
        else {
          this._rowResizeRect.hide();
          return;
        }
        if (this._currentRow === -1)
          return;
        if (!this.interceptor.fetchThroughInterceptors(hc3)(null, { row: this._currentRow }))
          return false;
        const P2 = Math.min(N_, u / 3);
        this._rowResizeRect.transformByState({
          left: u / 2 - P2 / 2,
          top: E
        }), this._rowResizeRect.setShapeProps({
          size: P2
        }), this._rowResizeRect.show();
      } else {
        let E = g - y / 2;
        if (w.x <= g + y / 2 && w.x >= g)
          this._currentColumn = S - 1;
        else if (w.x >= f2 - y / 2 && w.x <= f2)
          this._currentColumn = S, E = f2 - y / 2;
        else {
          this._columnResizeRect.hide();
          return;
        }
        if (this._currentColumn === -1)
          return;
        if (!this.interceptor.fetchThroughInterceptors(hc3)(null, { col: this._currentColumn }))
          return false;
        const P2 = h * 0.7;
        this._columnResizeRect.transformByState({
          left: E,
          top: h / 2 - P2 / 2
        }), this._columnResizeRect.setShapeProps({
          size: P2
        }), this._columnResizeRect.show();
      }
    };
    this._headerPointerSubs = new Subscription(), this._headerPointerSubs.add(o == null ? void 0 : o.onPointerMove$.subscribeEvent(l)), this._headerPointerSubs.add(o == null ? void 0 : o.onPointerLeave$.subscribeEvent(s));
  }
  _initialHoverResize(e = 0) {
    const t8 = this._context.scene, n = e === 0 ? this._rowResizeRect : this._columnResizeRect;
    n != null && (this.disposeWithMe(
      n.onPointerEnter$.subscribeEvent(() => {
        n != null && (n.show(), t8.setCursor(
          e === 0 ? v1.ROW_RESIZE : v1.COLUMN_RESIZE
        ));
      })
    ), this.disposeWithMe(
      n.onPointerLeave$.subscribeEvent(() => {
        n != null && (n.hide(), t8.resetCursor());
      })
    ), this.disposeWithMe(
      n.onPointerDown$.subscribeEvent((i) => {
        var D2, X2, B, j, G7, ge2, Re3;
        const o = (D2 = this._sheetSkeletonManagerService.getCurrentParam()) == null ? void 0 : D2.skeleton;
        if (o == null) return;
        const s = this._context.scene, l = s.getEngine(), a = (l == null ? void 0 : l.height) || 0, c = (l == null ? void 0 : l.width) || 0, d = s.getViewport(k2.VIEW_MAIN), u = (((B = (X2 = d == null ? void 0 : d.getScrollBar()) == null ? void 0 : X2.horizonScrollTrack) == null ? void 0 : B.height) || 0) + 10, h = (((G7 = (j = d == null ? void 0 : d.getScrollBar()) == null ? void 0 : j.verticalScrollTrack) == null ? void 0 : G7.width) || 0) + 10, g = Os3(i.offsetX, i.offsetY, s), { scaleX: m2, scaleY: f2 } = s.getAncestorScale();
        this._startOffsetX = g.x, this._startOffsetY = g.y;
        const v2 = o.getOffsetByColumn(this._currentColumn), p = o.getOffsetByRow(this._currentRow), S = o.getNoMergeCellWithCoordByIndex(this._currentRow, this._currentColumn);
        let w = false, C = 0, I2 = 0;
        const { columnTotalWidth: R, rowHeaderWidth: y, rowTotalHeight: M7, columnHeaderHeight: E } = o, T = c > R + y ? c : R + y, P2 = a > M7 + E ? a : M7 + E, H3 = Math.max(m2, f2), A = Qc / H3;
        e === 0 ? this._resizeHelperShape = new I12(xh2, {
          width: T,
          height: A,
          fill: Oh2,
          left: 0,
          top: p - A / 2
        }) : this._resizeHelperShape = new I12(xh2, {
          width: A,
          height: P2,
          fill: Oh2,
          left: v2 - A / 2,
          top: 0
        });
        const x7 = ((ge2 = this._columnResizeRect) == null ? void 0 : ge2.left) || 0, V2 = ((Re3 = this._rowResizeRect) == null ? void 0 : Re3.top) || 0;
        s.addObject(this._resizeHelperShape, rr4), s.disableObjectsEvent(), this._scenePointerMoveSub = s.onPointerMove$.subscribeEvent((be2) => {
          var it2, ot4, vt3, wt3, Bn5, Fn5;
          const Ne3 = s.getCoordRelativeToViewport(
            U.FromArray([this._startOffsetX, this._startOffsetY])
          ), Z7 = s.getScrollXYInfoByViewport(Ne3, d), ee3 = Os3(be2.offsetX, be2.offsetY, s), { x: ne2, y: pe2 } = ee3, { scaleX: Ue3, scaleY: me3 } = s.getAncestorScale(), _e4 = Math.max(Ue3, me3), le2 = Qc / _e4;
          C = ne2 - this._startOffsetX - le2 / 2, I2 = pe2 - this._startOffsetY - le2 / 2, Math.abs(e === 0 ? I2 : C) >= B_ && (w = true), e === 0 ? (I2 > a - u + Z7.y - S.startY && (I2 = a - u + Z7.y - S.startY), I2 < -(S.endY - S.startY) + 2 && (I2 = -(S.endY - S.startY) + 2), w && ((it2 = this._resizeHelperShape) == null || it2.transformByState({
            top: p + I2
          }), (ot4 = this._rowResizeRect) == null || ot4.transformByState({
            top: V2 + I2 + le2 / 2
          }), (vt3 = this._rowResizeRect) == null || vt3.show(), s.setCursor(v1.ROW_RESIZE))) : (C > c - h + Z7.x - S.startX && (C = c - h + Z7.x - S.startX), C < -(S.endX - S.startX) + 2 && (C = -(S.endX - S.startX) + 2), w && ((wt3 = this._resizeHelperShape) == null || wt3.transformByState({
            left: v2 + C
          }), (Bn5 = this._columnResizeRect) == null || Bn5.transformByState({
            left: x7 + C + le2 / 2
          }), (Fn5 = this._columnResizeRect) == null || Fn5.show(), s.setCursor(v1.COLUMN_RESIZE)));
        }), this._scenePointerUpSub = s.onPointerUp$.subscribeEvent((be2) => {
          var Z7, ee3, ne2;
          const Ne3 = this._context.scene;
          this._clearObserverEvent(), (Z7 = this._resizeHelperShape) == null || Z7.dispose(), this._resizeHelperShape = null, Ne3.enableObjectsEvent(), w && (Ne3.resetCursor(), (ee3 = this._rowResizeRect) == null || ee3.hide(), (ne2 = this._columnResizeRect) == null || ne2.hide(), e === 0 ? this._commandService.executeCommand(zn.id, {
            deltaY: I2,
            anchorRow: this._currentRow
          }) : this._commandService.executeCommand(
            Fn2.id,
            {
              deltaX: C,
              anchorCol: this._currentColumn
            }
          ));
        });
      })
    ), this.disposeWithMe(
      n.onDblclick$.subscribeEvent(() => {
        var d, u, h;
        this._context.scene.resetCursor();
        const o = (d = this._sheetSkeletonManagerService.getCurrentParam()) == null ? void 0 : d.skeleton;
        if (!o) return;
        const s = 0, l = 0, a = o.worksheet.getRowCount() - 1 || 0, c = o.worksheet.getColumnCount() - 1 || 0;
        switch (e) {
          case 1: {
            const g = this._selectionManagerService.getCurrentSelections(), m2 = [];
            for (let f2 = 0; f2 < g.length; f2++) {
              const v2 = g[f2];
              v2.range.rangeType === ge.COLUMN && this._currentColumn <= v2.range.endColumn && this._currentColumn >= v2.range.startColumn && m2.push({
                startColumn: v2.range.startColumn,
                endColumn: v2.range.endColumn,
                startRow: s,
                endRow: a
              });
            }
            m2.length === 0 && m2.push({
              startColumn: this._currentColumn,
              endColumn: this._currentColumn,
              startRow: s,
              endRow: a
            }), this._commandService.executeCommand(
              is2.id,
              { ranges: m2 }
            ), (u = this._columnResizeRect) == null || u.hide();
            break;
          }
          case 0:
            this._commandService.executeCommand(
              eo.id,
              {
                ranges: [{
                  startRow: this._currentRow,
                  endRow: this._currentRow,
                  startColumn: l,
                  endColumn: c
                }]
              }
            ), (h = this._rowResizeRect) == null || h.hide();
            break;
        }
      })
    ));
  }
  _clearObserverEvent() {
    var e, t8;
    (e = this._scenePointerMoveSub) == null || e.unsubscribe(), (t8 = this._scenePointerUpSub) == null || t8.unsubscribe(), this._scenePointerMoveSub = null, this._scenePointerUpSub = null;
  }
};
ko3 = D_([
  uc2(1, Inject(ue)),
  uc2(2, Inject(z)),
  uc2(3, Ls)
], ko3);
var F_ = Object.getOwnPropertyDescriptor;
var U_ = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? F_(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var Ki2 = (r, e) => (t8, n) => e(t8, n, r);
var X_ = 60;
var fl = class extends h1 {
  constructor(e, t8, n, i, o, s) {
    super();
    _2(this, "_renderMetric$", new Subject());
    _2(this, "renderMetric$", this._renderMetric$.asObservable());
    _2(this, "_renderFrameTimeMetric", null);
    _2(this, "_renderFrameTags", {});
    _2(this, "_afterRenderMetric$", new Subject());
    this._context = e, this._configService = t8, this._sheetSkeletonManagerService = n, this._sheetRenderService = i, this._commandService = o, this._telemetryService = s, this._addNewRender(), this._initRenderMetricSubscriber();
  }
  _addNewRender() {
    const { scene: e, engine: t8, unit: n } = this._context;
    this._addComponent(n), this._initRerenderScheduler(), this._initCommandListener();
    const i = this._context.unit.getActiveSheet();
    if (!i)
      throw new Error("No active sheet found");
    const o = i.getSheetId();
    this._sheetSkeletonManagerService.setCurrent({ sheetId: o });
    const s = () => e.render();
    this.disposeWithMe(this._context.activated$.subscribe((l) => {
      l ? t8.runRenderLoop(s) : t8.stopRenderLoop(s);
    }));
  }
  _initRenderMetricSubscriber() {
    const { engine: e } = this._context;
    e.beginFrame$.subscribe(() => {
      this._renderFrameTimeMetric = null, this._renderFrameTags = {};
    }), e.endFrame$.subscribe(() => {
      this._renderFrameTimeMetric && Object.keys(this._renderFrameTimeMetric).filter((i) => i.startsWith(ub)).length > 0 && this._afterRenderMetric$.next({
        frameTimeMetric: this._renderFrameTimeMetric,
        tags: this._renderFrameTags
      });
    }), e.renderFrameTimeMetric$.subscribe(([n, i]) => {
      this._renderFrameTimeMetric || (this._renderFrameTimeMetric = {}), this._renderFrameTimeMetric[n] || (this._renderFrameTimeMetric[n] = []), this._renderFrameTimeMetric[n].push(Math.round(i * 100) / 100);
    }), e.renderFrameTags$.subscribe(([n, i]) => {
      this._renderFrameTags[n] = i;
    });
    const t8 = [];
    this._afterRenderMetric$.pipe(withLatestFrom(e.endFrame$)).subscribe(([n, i]) => {
      t8.push({
        FPS: i.FPS,
        elapsedTime: i.elapsedTime,
        frameTime: Math.round(i.frameTime * 100) / 100,
        ...n.frameTimeMetric,
        ...n.tags
      }), t8.length > X_ && (this._captureRenderMetric(t8), t8.length = 0);
    });
  }
  /**
   * Send render metric to telemetry service
   * @param frameInfoList
   */
  _captureRenderMetric(e) {
    var u;
    const t8 = e;
    if (t8.length === 0) return;
    const n = (h) => {
      let g = 0;
      const f2 = Object.entries(h).filter(([p, S]) => Array.isArray(S)).map(([p]) => p).reduce((p, S) => {
        const w = h[S].reduce((C, I2) => C + I2, 0);
        return p[S] = w, p;
      }, {});
      return Object.keys(h).filter((p) => p.startsWith(ub)).forEach((p) => {
        g += f2[p];
      }), { ...f2, extensionTotal: g };
    }, i = e.map((h) => ({ ...h, ...n(h) })), s = ((h) => Object.entries(h[0]).filter(([f2, v2]) => !["elapsedTime"].includes(f2)).filter(([f2, v2]) => typeof v2 == "number").map(([f2]) => f2).reduce((f2, v2) => {
      const p = h.map((I2) => I2[v2]), S = Math.max(...p), w = Math.min(...p), C = p.reduce((I2, R) => I2 + R, 0) / p.length;
      return f2[v2] = {
        max: Math.round(S * 100) / 100,
        min: Math.round(w * 100) / 100,
        avg: Math.round(C * 100) / 100
      }, f2;
    }, {}))(i), l = t8[t8.length - 1].elapsedTime, a = this._context.unit.getActiveSheet().getSheetId(), c = this._context.unit.getUnitId(), d = { sheetId: a, unitId: c, elapsedTimeToStart: l, ...s };
    this._renderMetric$.next(d), (u = this._telemetryService) == null || u.capture("sheet_render_cost", d);
  }
  _addComponent(e) {
    const { scene: t8, components: n } = this._context, i = e.getActiveSheet(), o = new YB(Ye3.MAIN);
    this._addViewport(i);
    const s = new $B(Ye3.ROW), l = new EB(Ye3.COLUMN), a = new I12(Ye3.LEFT_TOP, {
      zIndex: 2,
      left: -1,
      top: -1,
      fill: "rgb(248, 249, 250)",
      stroke: "rgb(217, 217, 217)",
      strokeWidth: 1
    });
    this._context.mainComponent = o, n.set(Ye3.MAIN, o), n.set(Ye3.ROW, s), n.set(Ye3.COLUMN, l), n.set(Ye3.LEFT_TOP, a), t8.addObjects([o], Wu2), t8.addObjects(
      [s, l, a],
      rr4
    ), t8.enableLayerCache(Wu2, rr4);
  }
  _initViewports(e, t8, n) {
    const s = new tA(k2.VIEW_MAIN, e, {
      left: t8.width,
      top: n.height,
      bottom: 0,
      right: 0,
      isWheelPreventDefaultX: true,
      allowCache: true,
      bufferEdgeX: 100,
      bufferEdgeY: 100
    }), l = new tA(k2.VIEW_MAIN_LEFT_TOP, e, {
      isWheelPreventDefaultX: true,
      active: false,
      allowCache: true,
      bufferEdgeX: 0,
      bufferEdgeY: 0
    }), a = new tA(k2.VIEW_MAIN_LEFT, e, {
      isWheelPreventDefaultX: true,
      active: false,
      allowCache: true,
      bufferEdgeX: 0,
      bufferEdgeY: 100
    }), c = new tA(k2.VIEW_MAIN_TOP, e, {
      isWheelPreventDefaultX: true,
      active: false,
      allowCache: true,
      bufferEdgeX: 100,
      bufferEdgeY: 0
    }), d = new tA(k2.VIEW_ROW_TOP, e, {
      active: false,
      isWheelPreventDefaultX: true
    }), u = new tA(k2.VIEW_ROW_BOTTOM, e, {
      left: 0,
      top: n.height,
      bottom: 0,
      width: t8.width + 1,
      isWheelPreventDefaultX: true
    }), h = new tA(k2.VIEW_COLUMN_LEFT, e, {
      active: false,
      isWheelPreventDefaultX: true
    }), g = new tA(k2.VIEW_COLUMN_RIGHT, e, {
      left: t8.width,
      top: 0,
      height: n.height + 1,
      right: 0,
      isWheelPreventDefaultX: true
    }), m2 = new tA(k2.VIEW_LEFT_TOP, e, {
      left: 0,
      top: 0,
      width: t8.width,
      height: n.height,
      isWheelPreventDefaultX: true
    });
    return {
      viewMain: s,
      viewLeftTop: m2,
      viewMainLeftTop: l,
      viewMainLeft: a,
      viewMainTop: c,
      viewColumnLeft: h,
      viewRowTop: d,
      viewRowBottom: u,
      viewColumnRight: g
    };
  }
  /**
   *
   * initViewport & wheel event
   * +-----------------+--------------------+-------------------+
   * |  VIEW_LEFT_TOP  |  VIEW_COLUMN_LEFT  | VIEW_COLUMN_RIGHT |
   * +-----------------+--------------------+-------------------+
   * |  VIEW_ROW_TOP   | VIEW_MAIN_LEFT_TOP |   VIEW_MAIN_TOP   |
   * +-----------------+--------------------+-------------------+
   * | VIEW_ROW_BOTTOM |   VIEW_MAIN_LEFT   |     VIEW_MAIN     |
   * +-----------------+--------------------+-------------------+
   */
  _addViewport(e) {
    const t8 = this._context.scene, { rowHeader: n, columnHeader: i } = e.getConfig(), { viewMain: o } = this._initViewports(t8, n, i), s = this._configService.getConfig(Tt3), l = s == null ? void 0 : s.scrollConfig;
    return new D8(o, l), t8.attachControl(), o;
  }
  _initRerenderScheduler() {
    this.disposeWithMe(this._sheetSkeletonManagerService.currentSkeleton$.subscribe((e) => {
      if (!e) return null;
      const { skeleton: t8, sheetId: n } = e, i = this._context.unit, o = i == null ? void 0 : i.getSheetBySheetId(n);
      if (i == null || o == null) return;
      const { mainComponent: s, components: l } = this._context, a = s, c = l.get(Ye3.ROW), d = l.get(Ye3.COLUMN), u = l.get(Ye3.LEFT_TOP), { rowHeaderWidth: h, columnHeaderHeight: g } = t8;
      a == null || a.updateSkeleton(t8), c == null || c.updateSkeleton(t8), d == null || d.updateSkeleton(t8), u == null || u.transformByState({
        width: h,
        height: g
      });
    }));
  }
  _initCommandListener() {
    this.disposeWithMe(this._commandService.onCommandExecuted((e) => {
      const { unit: t8 } = this._context, { id: n } = e;
      if (mh.includes(n) || this._sheetRenderService.checkMutationShouldTriggerRerender(n)) {
        const i = e.params, { unitId: o, subUnitId: s } = i, l = t8.getActiveSheet();
        if (!l) return;
        const a = this._context.unitId, c = l.getSheetId();
        if (o !== a || s !== c)
          return;
        this._sheetSkeletonManagerService.makeDirty({
          sheetId: c,
          commandId: n
        }, true), this._sheetSkeletonManagerService.setCurrent({
          sheetId: c,
          commandId: n
        });
      } else fh.includes(n) && this._sheetSkeletonManagerService.reCalculate();
      e.type === Ms.MUTATION && this._markUnitDirty(e);
    }));
  }
  _markUnitDirty(e) {
    const { mainComponent: t8, scene: n } = this._context;
    if (e.id === _n.id && e.params.stageInfo != null || (t8 && t8.makeDirty(), n.makeDirty(), !e.params)) return;
    const i = e.params, o = this._spreadsheetViewports(n);
    if (e.id === ee.id && i.cellValue) {
      const s = this._cellValueToRange(i.cellValue), l = this._rangeToBounds([s]);
      this._markViewportDirty(o, l), t8.setDirtyArea(l);
    }
    if (e.id === It.id && i.from && i.to) {
      const s = i.fromRange || this._cellValueToRange(i.from.value), l = i.toRange || this._cellValueToRange(i.to.value), a = this._rangeToBounds([s, l]);
      this._markViewportDirty(o, a), t8.setDirtyArea(a);
    }
  }
  /**
   * cellValue data structure:
   * {[row]: { [col]: value}}
   * @param cellValue
   * @returns IRange
   */
  _cellValueToRange(e) {
    let t8 = 0, n = 0, i = 0, o = 0;
    for (const [d, u] of Object.entries(e)) {
      for (const h in u)
        t8 > Number(h) && (t8 = Number(h)), n < Number(h) && (n = Number(h));
      i > Number(d) && (i = Number(d)), o < Number(d) && (o = Number(d));
    }
    return {
      startRow: i,
      endRow: o,
      startColumn: t8,
      endColumn: n
    };
  }
  _rangeToBounds(e) {
    const t8 = this._sheetSkeletonManagerService.getCurrentParam().skeleton, { rowHeightAccumulation: n, columnWidthAccumulation: i, rowHeaderWidth: o, columnHeaderHeight: s } = t8, l = [];
    for (const a of e) {
      const { startRow: c, endRow: d, startColumn: u, endColumn: h } = a, g = c === 0 ? 0 : n[c - 1] + s, m2 = n[d] + s, f2 = u === 0 ? 0 : i[u - 1] + o, v2 = i[h] + o;
      l.push({ top: g, left: f2, bottom: m2, right: v2, width: v2 - f2, height: m2 - g });
    }
    return l;
  }
  _markViewportDirty(e, t8) {
    const n = e.filter((i) => i.isActive && i.cacheBound);
    for (const i of n)
      for (const o of t8)
        En.hasIntersectionBetweenTwoRect(i.cacheBound, o) && i.markDirty(true);
  }
  _spreadsheetViewports(e) {
    return e.getViewports().filter((t8) => ["viewMain", "viewMainLeftTop", "viewMainTop", "viewMainLeft"].includes(t8.viewportKey));
  }
};
fl = U_([
  Ki2(1, Inject(ic)),
  Ki2(2, Inject(ue)),
  Ki2(3, Inject(ir3)),
  Ki2(4, Ls),
  Ki2(5, Optional(t))
], fl);
var z_ = ({ className: r }) => (0, import_jsx_runtime4.jsxs)("svg", { className: r, width: "120", height: "2", viewBox: "0 0 120 2", fill: "none", xmlns: "http://www.w3.org/2000/svg", children: [
  (0, import_jsx_runtime4.jsx)("path", { d: "M0.98999 1.08218H-0.0100098V0.0821838H0.98999V1.08218Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M5.78992 1.08218H2.78992V0.0821838H5.78992V1.08218Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M7.58984 1.08218H8.58984V0.0821838H7.58984V1.08218Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M14.9152 1.08218H13.9152V0.0821838H14.9152V1.08218Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M16.7151 1.08218H19.7151V0.0821838H16.7151V1.08218Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M22.515 1.08218H21.515V0.0821838H22.515V1.08218Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M27.8405 1.08218H28.8405V0.0821838H27.8405V1.08218Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M33.6404 1.08218H30.6404V0.0821838H33.6404V1.08218Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M35.4403 1.08218H36.4403V0.0821838H35.4403V1.08218Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M42.7657 1.08218H41.7657V0.0821838H42.7657V1.08218Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M44.5657 1.08218H47.5657V0.0821838H44.5657V1.08218Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M50.3656 1.08218H49.3656V0.0821838H50.3656V1.08218Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M55.691 1.08218H56.691V0.0821838H55.691V1.08218Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M61.491 1.08218H58.491V0.0821838H61.491V1.08218Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M63.2909 1.08218H64.2909V0.0821838H63.2909V1.08218Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M70.6163 1.08218H69.6163V0.0821838H70.6163V1.08218Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M72.4163 1.08218H75.4163V0.0821838H72.4163V1.08218Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M78.2162 1.08218H77.2162V0.0821838H78.2162V1.08218Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M83.5416 1.08218H84.5416V0.0821838H83.5416V1.08218Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M89.3416 1.08218H86.3416V0.0821838H89.3416V1.08218Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M91.1415 1.08218H92.1415V0.0821838H91.1415V1.08218Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M98.4669 1.08218H97.4669V0.0821838H98.4669V1.08218Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M100.267 1.08218H103.267V0.0821838H100.267V1.08218Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M106.067 1.08218H105.067V0.0821838H106.067V1.08218Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M111.392 1.08218H112.392V0.0821838H111.392V1.08218Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M117.192 1.08218H114.192V0.0821838H117.192V1.08218Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M118.992 1.08218H119.992V0.0821838H118.992V1.08218Z" })
] });
var j_ = ({ className: r }) => (0, import_jsx_runtime4.jsxs)("svg", { className: r, width: "120", height: "2", viewBox: "0 0 120 2", fill: "none", xmlns: "http://www.w3.org/2000/svg", children: [
  (0, import_jsx_runtime4.jsx)("path", { d: "M-0.0100098 1.15771H0.98999V0.157715H-0.0100098V1.15771Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M2.78992 1.15771H5.78992V0.157715H2.78992V1.15771Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M8.58984 1.15771H7.58984V0.157715H8.58984V1.15771Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M10.3899 1.15771H11.3899V0.157715H10.3899V1.15771Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M19.0903 1.15771H18.0903V0.157715H19.0903V1.15771Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M20.8903 1.15771H23.8903V0.157715H20.8903V1.15771Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M26.6902 1.15771H25.6902V0.157715H26.6902V1.15771Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M28.4902 1.15771H29.4902V0.157715H28.4902V1.15771Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M37.1907 1.15771H36.1907V0.157715H37.1907V1.15771Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M38.9906 1.15771H41.9906V0.157715H38.9906V1.15771Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M44.7905 1.15771H43.7905V0.157715H44.7905V1.15771Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M46.5906 1.15771H47.5906V0.157715H46.5906V1.15771Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M55.291 1.15771H54.291V0.157715H55.291V1.15771Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M57.0909 1.15771H60.0909V0.157715H57.0909V1.15771Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M62.8909 1.15771H61.8909V0.157715H62.8909V1.15771Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M64.6909 1.15771H65.6909V0.157715H64.6909V1.15771Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M73.3914 1.15771H72.3914V0.157715H73.3914V1.15771Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M75.1913 1.15771H78.1913V0.157715H75.1913V1.15771Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M80.9912 1.15771H79.9912V0.157715H80.9912V1.15771Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M82.7913 1.15771H83.7913V0.157715H82.7913V1.15771Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M91.4917 1.15771H90.4917V0.157715H91.4917V1.15771Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M93.2916 1.15771H96.2916V0.157715H93.2916V1.15771Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M99.0916 1.15771H98.0916V0.157715H99.0916V1.15771Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M100.892 1.15771H101.892V0.157715H100.892V1.15771Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M109.592 1.15771H108.592V0.157715H109.592V1.15771Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M111.392 1.15771H114.392V0.157715H111.392V1.15771Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M117.192 1.15771H116.192V0.157715H117.192V1.15771Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M118.992 1.15771H119.992V0.157715H118.992V1.15771Z" })
] });
var Y_ = ({ className: r }) => (0, import_jsx_runtime4.jsxs)("svg", { className: r, width: "120", height: "2", viewBox: "0 0 120 2", fill: "none", xmlns: "http://www.w3.org/2000/svg", children: [
  (0, import_jsx_runtime4.jsx)("path", { d: "M-0.00842285 1.22449H2.99158V0.224487H-0.00842285V1.22449Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M6.14941 1.22449H9.14941V0.224487H6.14941V1.22449Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M15.3073 1.22449H12.3073V0.224487H15.3073V1.22449Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M18.4651 1.22449H21.4651V0.224487H18.4651V1.22449Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M27.6229 1.22449H24.6229V0.224487H27.6229V1.22449Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M30.7808 1.22449H33.7808V0.224487H30.7808V1.22449Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M39.9386 1.22449H36.9386V0.224487H39.9386V1.22449Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M43.0964 1.22449H46.0964V0.224487H43.0964V1.22449Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M52.2543 1.22449H49.2543V0.224487H52.2543V1.22449Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M55.4121 1.22449H58.4121V0.224487H55.4121V1.22449Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M64.5699 1.22449H61.5699V0.224487H64.5699V1.22449Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M67.7278 1.22449H70.7278V0.224487H67.7278V1.22449Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M76.8856 1.22449H73.8856V0.224487H76.8856V1.22449Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M80.0435 1.22449H83.0435V0.224487H80.0435V1.22449Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M89.2013 1.22449H86.2013V0.224487H89.2013V1.22449Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M92.3591 1.22449H95.3591V0.224487H92.3591V1.22449Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M101.517 1.22449H98.517V0.224487H101.517V1.22449Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M104.675 1.22449H107.675V0.224487H104.675V1.22449Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M113.833 1.22449H110.833V0.224487H113.833V1.22449Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M116.99 1.22449H119.99V0.224487H116.99V1.22449Z" })
] });
var Z_ = ({ className: r }) => (0, import_jsx_runtime4.jsxs)("svg", { className: r, width: "120", height: "8", viewBox: "0 0 120 8", fill: "none", xmlns: "http://www.w3.org/2000/svg", children: [
  (0, import_jsx_runtime4.jsx)(
    "path",
    {
      fillRule: "evenodd",
      clipRule: "evenodd",
      d: "M119.991 2.06215H-0.0090332V0.862152H119.991V1.86215Z"
    }
  ),
  (0, import_jsx_runtime4.jsx)(
    "path",
    {
      fillRule: "evenodd",
      clipRule: "evenodd",
      d: "M119.991 6.66215H-0.0090332V5.86215H119.991V6.86215Z"
    }
  )
] });
var G_ = ({ className: r }) => (0, import_jsx_runtime4.jsxs)("svg", { className: r, width: "120", height: "2", viewBox: "0 0 120 2", fill: "none", xmlns: "http://www.w3.org/2000/svg", children: [
  (0, import_jsx_runtime4.jsx)("path", { d: "M-0.00976562 1.65707H0.990234V0.657074H-0.00976562V1.65707Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M2.32361 1.65707H3.32361V0.657074H2.32361V1.65707Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M5.65698 1.65707H4.65698V0.657074H5.65698V1.65707Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M6.99036 1.65707H7.99036V0.657074H6.99036V1.65707Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M10.3237 1.65707H9.32373V0.657074H10.3237V1.65707Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M11.6571 1.65707H12.6571V0.657074H11.6571V1.65707Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M14.9905 1.65707H13.9905V0.657074H14.9905V1.65707Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M16.3239 1.65707H17.3239V0.657074H16.3239V1.65707Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M19.6572 1.65707H18.6572V0.657074H19.6572V1.65707Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M20.9906 1.65707H21.9906V0.657074H20.9906V1.65707Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M24.324 1.65707H23.324V0.657074H24.324V1.65707Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M25.6573 1.65707H26.6573V0.657074H25.6573V1.65707Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M28.9907 1.65707H27.9907V0.657074H28.9907V1.65707Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M30.3241 1.65707H31.3241V0.657074H30.3241V1.65707Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M33.6575 1.65707H32.6575V0.657074H33.6575V1.65707Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M34.9908 1.65707H35.9908V0.657074H34.9908V1.65707Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M38.3242 1.65707H37.3242V0.657074H38.3242V1.65707Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M39.6576 1.65707H40.6576V0.657074H39.6576V1.65707Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M42.991 1.65707H41.991V0.657074H42.991V1.65707Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M44.3243 1.65707H45.3243V0.657074H44.3243V1.65707Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M47.6577 1.65707H46.6577V0.657074H47.6577V1.65707Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M48.9911 1.65707H49.9911V0.657074H48.9911V1.65707Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M52.3245 1.65707H51.3245V0.657074H52.3245V1.65707Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M53.6578 1.65707H54.6578V0.657074H53.6578V1.65707Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M56.9912 1.65707H55.9912V0.657074H56.9912V1.65707Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M58.3246 1.65707H59.3246V0.657074H58.3246V1.65707Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M61.658 1.65707H60.658V0.657074H61.658V1.65707Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M62.9913 1.65707H63.9913V0.657074H62.9913V1.65707Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M66.3247 1.65707H65.3247V0.657074H66.3247V1.65707Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M67.6581 1.65707H68.6581V0.657074H67.6581V1.65707Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M70.9915 1.65707H69.9915V0.657074H70.9915V1.65707Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M72.3248 1.65707H73.3248V0.657074H72.3248V1.65707Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M75.6582 1.65707H74.6582V0.657074H75.6582V1.65707Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M76.9916 1.65707H77.9916V0.657074H76.9916V1.65707Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M80.325 1.65707H79.325V0.657074H80.325V1.65707Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M81.6583 1.65707H82.6583V0.657074H81.6583V1.65707Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M84.9917 1.65707H83.9917V0.657074H84.9917V1.65707Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M86.3251 1.65707H87.3251V0.657074H86.3251V1.65707Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M89.6584 1.65707H88.6584V0.657074H89.6584V1.65707Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M90.9918 1.65707H91.9918V0.657074H90.9918V1.65707Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M94.3252 1.65707H93.3252V0.657074H94.3252V1.65707Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M95.6586 1.65707H96.6586V0.657074H95.6586V1.65707Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M98.9919 1.65707H97.9919V0.657074H98.9919V1.65707Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M100.325 1.65707H101.325V0.657074H100.325V1.65707Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M103.659 1.65707H102.659V0.657074H103.659V1.65707Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M104.992 1.65707H105.992V0.657074H104.992V1.65707Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M108.325 1.65707H107.325V0.657074H108.325V1.65707Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M109.659 1.65707H110.659V0.657074H109.659V1.65707Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M112.992 1.65707H111.992V0.657074H112.992V1.65707Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M114.325 1.65707H115.325V0.657074H114.325V1.65707Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M117.659 1.65707H116.659V0.657074H117.659V1.65707Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M118.992 1.65707H119.992V0.657074H118.992V1.65707Z" })
] });
var q_ = ({ className: r }) => (0, import_jsx_runtime4.jsx)("svg", { className: r, width: "120", height: "3", viewBox: "0 0 120 3", fill: "none", xmlns: "http://www.w3.org/2000/svg", children: (0, import_jsx_runtime4.jsx)(
  "path",
  {
    fillRule: "evenodd",
    clipRule: "evenodd",
    d: "M119.991 2.42035H-0.0090332V0.420349H119.991V2.42035Z"
  }
) });
var Q_ = ({ className: r }) => (0, import_jsx_runtime4.jsxs)("svg", { className: r, width: "120", height: "3", viewBox: "0 0 120 3", fill: "none", xmlns: "http://www.w3.org/2000/svg", children: [
  (0, import_jsx_runtime4.jsx)("path", { d: "M-0.0100098 2.47614H1.98999V0.476135H-0.0100098V2.47614Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M3.99014 2.47614H9.99014V0.476135H3.99014V2.47614Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M13.9901 2.47614H11.9901V0.476135H13.9901V2.47614Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M21.1904 2.47614H23.1904V0.476135H21.1904V2.47614Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M31.1906 2.47614H25.1906V0.476135H31.1906V2.47614Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M33.1906 2.47614H35.1906V0.476135H33.1906V2.47614Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M44.3909 2.47614H42.3909V0.476135H44.3909V2.47614Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M46.391 2.47614H52.391V0.476135H46.391V2.47614Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M56.391 2.47614H54.391V0.476135H56.391V2.47614Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M63.5913 2.47614H65.5913V0.476135H63.5913V2.47614Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M73.5915 2.47614H67.5915V0.476135H73.5915V2.47614Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M75.5915 2.47614H77.5915V0.476135H75.5915V2.47614Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M86.7917 2.47614H84.7917V0.476135H86.7917V2.47614Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M88.7919 2.47614H94.7919V0.476135H88.7919V2.47614Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M98.7919 2.47614H96.7919V0.476135H98.7919V2.47614Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M105.992 2.47614H107.992V0.476135H105.992V2.47614Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M115.992 2.47614H109.992V0.476135H115.992V2.47614Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M117.992 2.47614H119.992V0.476135H117.992V2.47614Z" })
] });
var K_ = ({ className: r }) => (0, import_jsx_runtime4.jsxs)("svg", { className: r, width: "120", height: "2", viewBox: "0 0 120 2", fill: "none", xmlns: "http://www.w3.org/2000/svg", children: [
  (0, import_jsx_runtime4.jsx)("path", { d: "M-0.0100098 2.00415H1.98999V0.00415039H-0.0100098V2.00415Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M3.99014 2.00415H9.99014V0.00415039H3.99014V2.00415Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M13.9901 2.00415H11.9901V0.00415039H13.9901V2.00415Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M15.9901 2.00415H17.9901V0.00415039H15.9901V2.00415Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M27.4905 2.00415H25.4905V0.00415039H27.4905V2.00415Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M29.4906 2.00415H35.4906V0.00415039H29.4906V2.00415Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M39.4906 2.00415H37.4906V0.00415039H39.4906V2.00415Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M41.4906 2.00415H43.4906V0.00415039H41.4906V2.00415Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M52.991 2.00415H50.991V0.00415039H52.991V2.00415Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M54.9911 2.00415H60.9911V0.00415039H54.9911V2.00415Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M64.9911 2.00415H62.9911V0.00415039H64.9911V2.00415Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M66.9911 2.00415H68.9911V0.00415039H66.9911V2.00415Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M78.4915 2.00415H76.4915V0.00415039H78.4915V2.00415Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M80.4916 2.00415H86.4916V0.00415039H80.4916V2.00415Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M90.4916 2.00415H88.4916V0.00415039H90.4916V2.00415Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M92.4916 2.00415H94.4916V0.00415039H92.4916V2.00415Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M103.992 2.00415H101.992V0.00415039H103.992V2.00415Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M105.992 2.00415H111.992V0.00415039H105.992V2.00415Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M115.992 2.00415H113.992V0.00415039H115.992V2.00415Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M117.992 2.00415H119.992V0.00415039H117.992V2.00415Z" })
] });
var J_ = ({ className: r }) => (0, import_jsx_runtime4.jsxs)("svg", { className: r, width: "118", height: "3", viewBox: "0 0 118 3", fill: "none", xmlns: "http://www.w3.org/2000/svg", children: [
  (0, import_jsx_runtime4.jsx)("path", { d: "M-0.00854492 2.94815H1.99146V0.948151H-0.00854492V2.94815Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M6.09668 2.94815H8.09668V0.948151H6.09668V2.94815Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M14.2019 2.94815H12.2019V0.948151H14.2019V2.94815Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M18.3071 2.94815H20.3071V0.948151H18.3071V2.94815Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M26.4124 2.94815H24.4124V0.948151H26.4124V2.94815Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M30.5176 2.94815H32.5176V0.948151H30.5176V2.94815Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M38.6228 2.94815H36.6228V0.948151H38.6228V2.94815Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M42.728 2.94815H44.728V0.948151H42.728V2.94815Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M50.8333 2.94815H48.8333V0.948151H50.8333V2.94815Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M54.9385 2.94815H56.9385V0.948151H54.9385V2.94815Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M63.0437 2.94815H61.0437V0.948151H63.0437V2.94815Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M67.1489 2.94815H69.1489V0.948151H67.1489V2.94815Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M75.2542 2.94815H73.2542V0.948151H75.2542V2.94815Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M79.3594 2.94815H81.3594V0.948151H79.3594V2.94815Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M87.4645 2.94815H85.4645V0.948151H87.4645V2.94815Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M91.5697 2.94815H93.5697V0.948151H91.5697V2.94815Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M99.6749 2.94815H97.6749V0.948151H99.6749V2.94815Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M103.78 2.94815H105.78V0.948151H103.78V2.94815Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M111.885 2.94815H109.885V0.948151H111.885V2.94815Z" }),
  (0, import_jsx_runtime4.jsx)("path", { d: "M115.991 2.94815H117.991V0.948151H115.991V2.94815Z" })
] });
var $_ = ({ className: r }) => (0, import_jsx_runtime4.jsx)("svg", { className: r, width: "120", height: "4", viewBox: "0 0 120 4", fill: "none", xmlns: "http://www.w3.org/2000/svg", children: (0, import_jsx_runtime4.jsx)(
  "path",
  {
    fillRule: "evenodd",
    clipRule: "evenodd",
    d: "M119.991 3.86215H-0.0090332V0.862152H119.991V3.86215Z"
  }
) });
var eR2 = ({ className: r }) => (0, import_jsx_runtime4.jsx)("svg", { className: r, width: "120", height: "2", viewBox: "0 0 120 2", fill: "none", xmlns: "http://www.w3.org/2000/svg", children: (0, import_jsx_runtime4.jsx)(
  "path",
  {
    fillRule: "evenodd",
    clipRule: "evenodd",
    d: "M119.991 1.15668H-0.0090332V0.156677H119.991V1.15668Z"
  }
) });
function Ah2(r) {
  const { type: e = Le.THIN, className: t8 } = r;
  switch (e) {
    case Le.DASH_DOT:
      return (0, import_jsx_runtime4.jsx)(z_, { className: t8 });
    case Le.DASH_DOT_DOT:
      return (0, import_jsx_runtime4.jsx)(j_, { className: t8 });
    case Le.DASHED:
      return (0, import_jsx_runtime4.jsx)(Y_, { className: t8 });
    case Le.HAIR:
      return (0, import_jsx_runtime4.jsx)(G_, { className: t8 });
    case Le.MEDIUM:
      return (0, import_jsx_runtime4.jsx)(q_, { className: t8 });
    case Le.MEDIUM_DASH_DOT:
      return (0, import_jsx_runtime4.jsx)(Q_, { className: t8 });
    case Le.MEDIUM_DASH_DOT_DOT:
      return (0, import_jsx_runtime4.jsx)(K_, { className: t8 });
    case Le.MEDIUM_DASHED:
      return (0, import_jsx_runtime4.jsx)(J_, { className: t8 });
    case Le.THICK:
      return (0, import_jsx_runtime4.jsx)($_, { className: t8 });
    case Le.DOUBLE:
      return (0, import_jsx_runtime4.jsx)(Z_, { className: t8 });
    case Le.THIN:
    default:
      return (0, import_jsx_runtime4.jsx)(eR2, { className: t8 });
  }
}
var tR2 = [
  {
    label: Le.THIN,
    value: Le.THIN
  },
  {
    label: Le.HAIR,
    value: Le.HAIR
  },
  {
    label: Le.DOTTED,
    value: Le.DOTTED
  },
  {
    label: Le.DASHED,
    value: Le.DASHED
  },
  {
    label: Le.DASH_DOT,
    value: Le.DASH_DOT
  },
  {
    label: Le.DASH_DOT_DOT,
    value: Le.DASH_DOT_DOT
  },
  {
    label: Le.MEDIUM,
    value: Le.MEDIUM
  },
  {
    label: Le.MEDIUM_DASHED,
    value: Le.MEDIUM_DASHED
  },
  {
    label: Le.MEDIUM_DASH_DOT,
    value: Le.MEDIUM_DASH_DOT
  },
  {
    label: Le.MEDIUM_DASH_DOT_DOT,
    value: Le.MEDIUM_DASH_DOT_DOT
  },
  {
    label: Le.THICK,
    value: Le.THICK
  },
  {
    label: Le.DOUBLE,
    value: Le.DOUBLE
  }
];
function nR(r) {
  var e;
  if (r)
    for (const t8 in r) {
      const n = r[t8];
      if ((e = n == null ? void 0 : n.cl) != null && e.rgb) return n.cl.rgb;
    }
}
function rR(r) {
  var e;
  if (r)
    for (const t8 in r) {
      const n = r[t8];
      if ((e = n == null ? void 0 : n.cl) != null && e.rgb) return n.s;
    }
}
function Hf(r) {
  var h;
  const e = useDependency(S1), t8 = useDependency(Ft2), n = useDependency(z), { isAllValuesSame: i, value: o } = n.getCellStylesProperty("bd"), s = i ? nR(o) : void 0, l = i ? rR(o) : void 0, { onChange: a, value: c } = r;
  function d(g, m2) {
    a == null || a({
      ...c,
      [m2]: g
    });
  }
  function u(g) {
    const m2 = e.get(g);
    return m2 && (0, import_jsx_runtime4.jsx)(m2, { className: "univer-fill-primary-600" });
  }
  return (0, import_jsx_runtime4.jsxs)("section", { className: "univer-box-border univer-grid univer-gap-2 univer-p-1.5", children: [
    (0, import_jsx_runtime4.jsx)(
      "div",
      {
        className: "univer-box-border univer-grid univer-grid-cols-5 univer-gap-2 univer-text-gray-600 dark:!univer-text-gray-200",
        children: bf2.map((g) => (0, import_jsx_runtime4.jsx)(
          "a",
          {
            className: ie2("univer-flex univer-size-6 univer-cursor-pointer univer-items-center univer-justify-center univer-justify-self-center univer-rounded hover:univer-bg-gray-100 dark:hover:!univer-bg-gray-700", {
              "univer-bg-gray-200 dark:!univer-bg-gray-600": t8.getBorderInfo().type === g.value
            }),
            onClick: (m2) => {
              m2.stopPropagation(), d(g.value, "type");
            },
            children: u(g.icon)
          },
          g.value
        ))
      }
    ),
    (0, import_jsx_runtime4.jsx)(zE, {}),
    (0, import_jsx_runtime4.jsxs)("div", { className: "univer-flex univer-items-center univer-gap-2", children: [
      (0, import_jsx_runtime4.jsx)("div", { children: (0, import_jsx_runtime4.jsx)(
        vf2,
        {
          overlay: (0, import_jsx_runtime4.jsx)("div", { className: "univer-rounded-lg univer-p-4", children: (0, import_jsx_runtime4.jsx)(sE, { value: s, onChange: (g) => d(g, "color") }) }),
          children: (0, import_jsx_runtime4.jsxs)(
            "button",
            {
              className: "univer-flex univer-cursor-pointer univer-items-center univer-gap-2 univer-rounded univer-border-none univer-bg-transparent univer-p-1 hover:univer-bg-gray-100 dark:hover:!univer-bg-gray-700",
              type: "button",
              children: [
                (0, import_jsx_runtime4.jsx)(
                  Jm,
                  {
                    className: "univer-fill-primary-600 dark:!univer-text-white",
                    extend: { colorChannel1: (h = c == null ? void 0 : c.color) != null ? h : "" }
                  }
                ),
                (0, import_jsx_runtime4.jsx)(_i3, { className: "dark:!univer-text-white" })
              ]
            }
          )
        }
      ) }),
      (0, import_jsx_runtime4.jsx)("div", { children: (0, import_jsx_runtime4.jsx)(
        vf2,
        {
          overlay: (0, import_jsx_runtime4.jsx)("section", { className: "univer-rounded-lg univer-p-1.5", children: (0, import_jsx_runtime4.jsx)("ul", { className: "univer-m-0 univer-grid univer-list-none univer-gap-1 univer-p-0", children: tR2.map((g) => (0, import_jsx_runtime4.jsxs)(
            "li",
            {
              className: "univer-flex univer-cursor-pointer univer-items-center univer-justify-center univer-rounded univer-px-1 univer-py-3 hover:univer-bg-gray-100 dark:hover:!univer-bg-gray-700",
              onClick: () => d(g.value, "style"),
              children: [
                g.value === l && (0, import_jsx_runtime4.jsx)(
                  Dr3,
                  {
                    className: "univer-absolute univer-left-3 univer-text-primary-600"
                  }
                ),
                (0, import_jsx_runtime4.jsx)(
                  Ah2,
                  {
                    className: "univer-ml-6 univer-fill-gray-900 dark:!univer-fill-white",
                    type: g.value
                  }
                )
              ]
            },
            g.value
          )) }) }),
          children: (0, import_jsx_runtime4.jsxs)(
            "button",
            {
              className: "univer-flex univer-cursor-pointer univer-items-center univer-gap-2 univer-rounded univer-border-none univer-bg-transparent univer-p-1 hover:univer-bg-gray-100 dark:hover:!univer-bg-gray-700",
              type: "button",
              children: [
                (0, import_jsx_runtime4.jsx)(
                  Ah2,
                  {
                    className: "univer-fill-gray-900 dark:!univer-fill-white",
                    type: l != null ? l : Le.THIN
                  }
                ),
                (0, import_jsx_runtime4.jsx)(_i3, { className: "dark:!univer-text-white" })
              ]
            }
          )
        }
      ) })
    ] })
  ] });
}
var hu2 = "sheets.component.cell-popup";
var iR = Object.getOwnPropertyDescriptor;
var oR = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? iR(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var ur3 = (r, e) => (t8, n) => e(t8, n, r);
var yi3 = class extends Ve {
  constructor(e, t8, n, i, o, s, l) {
    super();
    _2(this, "_popupMenuFeatureMap", /* @__PURE__ */ new Map());
    _2(this, "_isSelectionMoving", false);
    this._globalPopupManagerService = e, this._renderManagerService = t8, this._univerInstanceService = n, this._refRangeService = i, this._commandService = o, this._refSelectionsService = s, this._selectionManagerService = l, this._initMoving();
  }
  _initMoving() {
    this.disposeWithMe(
      this._refSelectionsService.selectionMoving$.subscribe(() => {
        this._isSelectionMoving = true;
      })
    ), this.disposeWithMe(
      this._refSelectionsService.selectionMoveEnd$.subscribe(() => {
        this._isSelectionMoving = false;
      })
    ), this.disposeWithMe(
      this._selectionManagerService.selectionMoving$.subscribe(() => {
        this._isSelectionMoving = true;
      })
    ), this.disposeWithMe(
      this._selectionManagerService.selectionMoveEnd$.subscribe(() => {
        this._isSelectionMoving = false;
      })
    );
  }
  /**
   * Register a feature menu callback for a specific drawing type.such as image, chart, etc.
   */
  registerFeatureMenu(e, t8) {
    this._popupMenuFeatureMap.set(e, t8);
  }
  /**
   * Get the feature menu by drawing type, the function should be called when a drawing element need trigger popup menu, so the unitId, subUnitId, drawingId should be provided.
   * @param {string} unitId the unit id
   * @param {string} subUnitId the sub unit id
   * @param {string} drawingId the drawing id
   * @param {DrawingTypeEnum} drawingType the feature type
   * @returns the feature menu if it exists, otherwise return undefined
   */
  getFeatureMenu(e, t8, n, i) {
    const o = this._popupMenuFeatureMap.get(i);
    if (o)
      return o(e, t8, n, i);
  }
  dispose() {
    super.dispose(), this._popupMenuFeatureMap.clear();
  }
  _createHiddenRectObserver(e) {
    const { row: t8, column: n, worksheet: i, skeleton: o, currentRender: s } = e, l = () => {
      var B, j;
      const u = i.getFreeze(), { startRow: h, startColumn: g, xSplit: m2, ySplit: f2 } = u, v2 = h - f2, p = g - m2, { rowHeightAccumulation: S, columnWidthAccumulation: w, rowHeaderWidth: C, columnHeaderHeight: I2 } = o, R = C + (p === -1 ? 0 : w[p + m2 - 1] - ((B = w[p - 1]) != null ? B : 0)), y = I2 + (v2 === -1 ? 0 : S[v2 + f2 - 1] - ((j = S[v2]) != null ? j : 0)), M7 = s.engine.getCanvasElement(), E = M7.getBoundingClientRect(), T = gc3(M7.style.width), P2 = E.width / T, H3 = s.scene.getAncestorScale().scaleX, A = R * P2 * H3, x7 = y * P2 * H3, V2 = {
        left: -1 / 0,
        top: -1 / 0,
        right: E.left + A,
        bottom: E.top + x7
      }, D2 = {
        left: E.left + A,
        top: -1 / 0,
        right: 1 / 0,
        bottom: E.top + x7
      }, X2 = {
        left: -1 / 0,
        top: E.top + x7,
        right: E.left + A,
        bottom: 1 / 0
      };
      return t8 < h && n < g ? [] : t8 < h ? [V2] : n < g ? [V2] : [V2, D2, X2];
    }, a = l(), c = new BehaviorSubject(a), d = new ao();
    return d.add(this._commandService.onCommandExecuted((u) => {
      u.id === st.id && c.next(l());
    })), d.add(TR(s.engine.onTransformChange$).pipe(throttleTime(16)).subscribe(() => {
      c.next(l());
    })), {
      rects$: c,
      disposable: d
    };
  }
  // #region attach to object
  // Unlike _createCellPositionObserver, this bind to a certain position.
  _createPositionObserver(e, t8, n, i) {
    const o = () => {
      const { scene: c } = t8, d = Cw(e, c, n, i), u = t8.engine.getCanvasElement(), h = u.getBoundingClientRect(), g = gc3(u.style.width), m2 = h.width / g;
      return {
        left: d.left * m2 + h.left,
        right: d.right * m2 + h.left,
        top: d.top * m2 + h.top,
        bottom: d.bottom * m2 + h.top
      };
    }, s = o(), l = new BehaviorSubject(s), a = new ao();
    return a.add(this._commandService.onCommandExecuted((c) => {
      (c.id === gn2.id || c.id === Jt3.id) && l.next(o());
    })), {
      position: s,
      position$: l,
      disposable: a
    };
  }
  /**
   * attach a popup to canvas object
   * @param targetObject target canvas object
   * @param popup popup item
   * @returns disposable
   */
  attachPopupToObject(e, t8) {
    var S;
    const n = this._univerInstanceService.getCurrentUnitForType(we.UNIVER_SHEET), i = n.getActiveSheet();
    if (!i || this._isSelectionMoving && !t8.showOnSelectionMoving)
      return {
        dispose: () => {
        },
        canDispose: () => true
      };
    const o = n.getUnitId(), s = i.getSheetId(), l = (S = this._renderManagerService.getRenderById(o)) == null ? void 0 : S.with(ue).ensureSkeleton(s), a = this._renderManagerService.getRenderById(o);
    if (!a || !l)
      return {
        dispose: () => {
        },
        canDispose: () => true
      };
    const { left: c, top: d, width: u, height: h } = e, g = {
      left: c,
      right: c + u,
      top: d,
      bottom: d + h
    }, { position: m2, position$: f2, disposable: v2 } = this._createPositionObserver(g, a, l, i), p = this._globalPopupManagerService.addPopup({
      ...t8,
      unitId: o,
      subUnitId: s,
      anchorRect: m2,
      anchorRect$: f2,
      canvasElement: a.engine.getCanvasElement()
    });
    return {
      dispose: () => {
        this._globalPopupManagerService.removePopup(p), f2.complete(), v2.dispose();
      },
      canDispose: () => this._globalPopupManagerService.activePopupId !== p
    };
  }
  // #endregion
  // #region attach to position
  attachPopupByPosition(e, t8, n) {
    var v2;
    let i = this._univerInstanceService.getCurrentUnitForType(we.UNIVER_SHEET), o = i.getActiveSheet();
    if (!o)
      return null;
    const s = i.getUnitId(), l = o.getSheetId();
    if (s !== n.unitId || n.subUnitId !== l)
      return null;
    if (this._isSelectionMoving && !t8.showOnSelectionMoving)
      return;
    const a = (v2 = this._renderManagerService.getRenderById(s)) == null ? void 0 : v2.with(ue).getOrCreateSkeleton({
      sheetId: l
    }), c = this._renderManagerService.getRenderById(s);
    if (!c || !a)
      return null;
    const { position: d, position$: u, disposable: h } = this._createPositionObserver(e, c, a, o), { rects$: g, disposable: m2 } = this._createHiddenRectObserver({
      row: n.row,
      column: n.col,
      worksheet: o,
      skeleton: a,
      currentRender: c
    }), f2 = this._globalPopupManagerService.addPopup({
      ...t8,
      unitId: s,
      subUnitId: l,
      anchorRect: d,
      anchorRect$: u,
      hiddenRects$: g,
      canvasElement: c.engine.getCanvasElement()
    });
    return {
      dispose: () => {
        this._globalPopupManagerService.removePopup(f2), u.complete(), h.dispose(), m2.dispose(), i = null, o = null;
      },
      canDispose: () => this._globalPopupManagerService.activePopupId !== f2
    };
  }
  // #endregion
  // #region attach to absolute position
  attachPopupToAbsolutePosition(e, t8, n, i) {
    var g;
    const o = this._univerInstanceService.getCurrentUnitForType(we.UNIVER_SHEET), s = o.getActiveSheet();
    if (!s)
      return null;
    const l = o.getUnitId(), a = s.getSheetId();
    if (n && l !== n || i && i !== a)
      return null;
    const c = (g = this._renderManagerService.getRenderById(l)) == null ? void 0 : g.with(ue).ensureSkeleton(a), d = this._renderManagerService.getRenderById(l);
    if (!d || !c)
      return null;
    if (this._isSelectionMoving && !t8.showOnSelectionMoving)
      return;
    const u = new BehaviorSubject(e), h = this._globalPopupManagerService.addPopup({
      ...t8,
      unitId: l,
      subUnitId: a,
      anchorRect: e,
      anchorRect$: u.asObservable(),
      canvasElement: d.engine.getCanvasElement()
    });
    return {
      dispose: () => {
        this._globalPopupManagerService.removePopup(h), u.complete();
      },
      canDispose: () => this._globalPopupManagerService.activePopupId !== h
    };
  }
  // #endregion
  // #region attach to cell
  /**
   * Bind popup to the right part of cell at(row, col).
   * This popup would move with the cell.
   * @param row
   * @param col
   * @param popup
   * @param _unitId
   * @param _subUnitId
   * @param viewport
   * @returns
   */
  attachPopupToCell(e, t8, n, i, o, s) {
    let l = this._univerInstanceService.getCurrentUnitForType(we.UNIVER_SHEET), a = l.getActiveSheet();
    if (!a)
      return null;
    const c = l.getUnitId(), d = a.getSheetId();
    if (i && c !== i || o && d !== o)
      return null;
    const u = this._renderManagerService.getRenderById(c), h = u == null ? void 0 : u.with(ue).ensureSkeleton(d), g = u == null ? void 0 : u.with(gt);
    if (!u || !h || !g)
      return null;
    if (this._isSelectionMoving && !n.showOnSelectionMoving)
      return;
    const m2 = s != null ? s : ch2(e, t8, u.scene, a);
    if (!m2)
      return null;
    const { position: f2, position$: v2, disposable: p, updateRowCol: S } = this._createCellPositionObserver(e, t8, u, h, m2), { rects$: w, disposable: C } = this._createHiddenRectObserver({
      row: e,
      column: t8,
      worksheet: a,
      skeleton: h,
      currentRender: u
    }), I2 = this._globalPopupManagerService.addPopup({
      ...n,
      unitId: c,
      subUnitId: d,
      anchorRect: f2,
      anchorRect$: v2,
      canvasElement: u.engine.getCanvasElement(),
      hiddenRects$: w
    }), R = new ao();
    R.add(p), R.add(We(() => {
      this._globalPopupManagerService.removePopup(I2), v2.complete();
    })), R.add(C);
    const y = { startRow: e, endRow: e, startColumn: t8, endColumn: t8 };
    return R.add(this._refRangeService.watchRange(c, d, y, (M7, E) => {
      E ? S(E.startRow, E.startColumn) : R.dispose();
    })), {
      dispose() {
        R.dispose(), a = null, l = null;
      },
      canDispose: () => this._globalPopupManagerService.activePopupId !== I2
    };
  }
  /**
   * attach Comp to floatDOM
   * @param range
   * @param popup
   * @param _unitId
   * @param _subUnitId
   * @param viewport
   * @param showOnSelectionMoving
   */
  attachRangePopup(e, t8, n, i, o, s = false) {
    const l = this._univerInstanceService.getCurrentUnitForType(we.UNIVER_SHEET), a = l.getActiveSheet();
    if (!a)
      return null;
    const c = l.getUnitId(), d = a.getSheetId();
    if (n && c !== n || i && d !== i)
      return null;
    const u = this._renderManagerService.getRenderById(c), h = u == null ? void 0 : u.with(ue).getOrCreateSkeleton({
      sheetId: d
    }), g = u == null ? void 0 : u.with(gt);
    if (!u || !h || !g)
      return null;
    if (g.selectionMoving && !s)
      return;
    const m2 = o != null ? o : ch2(e.startRow, e.startColumn, u.scene, a);
    if (!m2)
      return null;
    const { position: f2, position$: v2, disposable: p, updateRange: S, topLeftPos$: w, rightBottomPos$: C } = this._createRangePositionObserver(e, u, h, m2), { rects$: I2, disposable: R } = this._createHiddenRectObserver({
      row: e.startRow,
      column: e.startColumn,
      worksheet: a,
      skeleton: h,
      currentRender: u
    }), y = this._globalPopupManagerService.addPopup({
      ...t8,
      unitId: c,
      subUnitId: d,
      anchorRect: f2,
      anchorRect$: v2,
      canvasElement: u.engine.getCanvasElement(),
      hiddenRects$: I2
    }), M7 = new ao();
    M7.add(p), M7.add(We(() => {
      this._globalPopupManagerService.removePopup(y), w.complete(), C.complete();
    })), M7.add(R);
    const E = { ...e };
    return M7.add(this._refRangeService.watchRange(c, d, E, (T, P2) => {
      P2 ? S(P2) : M7.dispose();
    })), {
      dispose() {
        M7.dispose();
      },
      canDispose: () => this._globalPopupManagerService.activePopupId !== y
    };
  }
  /**
   *
   * @param initialRow
   * @param initialCol
   * @param currentRender
   * @param skeleton
   * @param activeViewport
   */
  _createCellPositionObserver(e, t8, n, i, o) {
    let s = e, l = t8;
    const a = this._calcCellPositionByCell(s, l, n, i, o), c = new BehaviorSubject(a), d = () => c.next(this._calcCellPositionByCell(s, l, n, i, o)), u = new ao();
    return u.add(n.engine.clientRect$.subscribe(() => d())), u.add(TR(n.engine.onTransformChange$).pipe(throttleTime(16)).subscribe(() => d())), u.add(this._commandService.onCommandExecuted((g) => {
      if (g.id === Xo.id && g.params.rowsAutoHeightInfo.findIndex((f2) => f2.row === s) > -1) {
        d();
        return;
      }
      (mh.indexOf(g.id) > -1 || g.id === gn2.id || g.id === Jt3.id) && d();
    })), {
      position$: c,
      disposable: u,
      position: a,
      updateRowCol: (g, m2) => {
        s = g, l = m2, d();
      }
    };
  }
  // TODO @lumixraku to a normal function, not method.
  _calcCellPositionByCell(e, t8, n, i, o) {
    const { scene: s, engine: l } = n;
    if (i._disposed || s._disposed)
      return {
        left: 0,
        right: 0,
        top: 0,
        bottom: 0
      };
    const a = i.getCellWithCoordByIndex(e, t8), c = a.isMergedMainCell ? a.mergeInfo : a, { scaleX: d, scaleY: u } = s.getAncestorScale(), h = {
      x: o.viewportScrollX,
      y: o.viewportScrollY
    }, g = l.getCanvasElement();
    if (!g)
      return {
        left: 0,
        right: 0,
        top: 0,
        bottom: 0
      };
    const m2 = g.getBoundingClientRect(), f2 = gc3(g.style.width), { top: v2, left: p, width: S } = m2, w = S / f2;
    return {
      left: (c.startX - h.x) * w * d + p,
      right: (c.endX - h.x) * w * d + p,
      top: (c.startY - h.y) * w * u + v2,
      bottom: (c.endY - h.y) * w * u + v2
    };
  }
  // #endregion
  /**
   * Unlike _createCellPositionObserver, this accept a range not a single cell.
   * @param initialRow
   * @param initialCol
   * @param currentRender
   * @param skeleton
   * @param activeViewport
   */
  _createRangePositionObserver(e, t8, n, i) {
    let { startRow: o, startColumn: s, endRow: l, endColumn: a } = e;
    const c = this._calcCellPositionByCell(o, s, t8, n, i), d = new BehaviorSubject(c), u = this._calcCellPositionByCell(l, a, t8, n, i), h = new BehaviorSubject(u), g = () => {
      const S = this._calcCellPositionByCell(o, s, t8, n, i), w = this._calcCellPositionByCell(l, a, t8, n, i);
      d.next(S), h.next(w);
    }, m2 = new ao();
    m2.add(t8.engine.clientRect$.subscribe(() => g())), m2.add(this._commandService.onCommandExecuted((S) => {
      if (S.id === Xo.id && S.params.rowsAutoHeightInfo.findIndex((C) => C.row === o) > -1) {
        g();
        return;
      }
      (mh.indexOf(S.id) > -1 || S.id === gn2.id || S.id === Jt3.id) && g();
    }));
    const f2 = (S) => {
      o = S.startRow, s = S.startColumn, l = S.endRow, a = S.endColumn, g();
    }, v2 = d.pipe(
      map((S) => {
        const w = this._calcCellPositionByCell(l, a, t8, n, i);
        return {
          top: S.top,
          left: S.left,
          right: w.right,
          bottom: w.bottom
        };
      })
    ), p = {
      top: c.top,
      left: c.left,
      right: u.right,
      bottom: u.bottom
    };
    return {
      position$: v2,
      position: p,
      updateRange: f2,
      topLeftPos$: d,
      rightBottomPos$: h,
      disposable: m2
    };
  }
};
yi3 = oR([
  ur3(0, Inject(rt3)),
  ur3(1, ME),
  ur3(2, vr),
  ur3(3, Inject(xt)),
  ur3(4, Ls),
  ur3(5, Fu),
  ur3(6, Inject(z))
], yi3);
function gc3(r) {
  return Number.parseInt(r.replace("px", ""));
}
var sR = Object.getOwnPropertyDescriptor;
var lR = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? sR(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var aR = (r, e) => (t8, n) => e(t8, n, r);
var Mi3 = class extends Ve {
  constructor(e) {
    super();
    _2(this, "_cellPopupMap", /* @__PURE__ */ new Map());
    _2(this, "_change$", new Subject());
    _2(this, "change$", this._change$.asObservable());
    this._sheetCanvasPopManagerService = e;
  }
  _ensureCellPopupMap(e, t8) {
    let n = this._cellPopupMap.get(e);
    n || (n = /* @__PURE__ */ new Map(), this._cellPopupMap.set(e, n));
    let i = n.get(t8);
    return i || (i = new pt(), n.set(t8, i)), i;
  }
  showPopup(e, t8) {
    var u, h;
    const { direction: n = "horizontal" } = t8, { unitId: i, subUnitId: o, row: s, col: l } = e, a = this._ensureCellPopupMap(i, o), c = (u = a.getValue(s, l)) == null ? void 0 : u[n];
    t8.id = (h = t8.id) != null ? h : et();
    const d = () => {
      var v2;
      const g = a.getValue(s, l);
      if (!g)
        return;
      const m2 = g[n];
      if (!m2)
        return;
      const f2 = m2 == null ? void 0 : m2.popups.findIndex((p) => p.id === t8.id && p.componentKey === t8.componentKey);
      m2 == null || m2.popups.splice(f2, 1), m2.popups.length === 0 && ((v2 = m2.disposable) == null || v2.dispose(), g[n] = void 0), this._change$.next({
        ...e,
        direction: n
      });
    };
    if (c)
      c.popups.push(t8), c.popups.sort((g, m2) => g.priority - m2.priority);
    else {
      const g = this._sheetCanvasPopManagerService.attachPopupToCell(
        s,
        l,
        {
          ...t8,
          direction: n,
          componentKey: hu2,
          extraProps: {
            ...e,
            direction: n
          },
          noPushMinimumGap: true,
          autoRelayout: false,
          zIndex: 90
        },
        i,
        o
      );
      a.setValue(s, l, {
        ...a.getValue(s, l),
        [n]: {
          disposable: g,
          popups: [t8]
        }
      });
    }
    return this._change$.next({
      ...e,
      direction: n
    }), We(d);
  }
  getPopups(e, t8, n, i, o) {
    var l, a;
    return ((a = (l = this._ensureCellPopupMap(e, t8).getValue(n, i)) == null ? void 0 : l[o]) == null ? void 0 : a.popups) || [];
  }
};
Mi3 = lR([
  aR(0, Inject(yi3))
], Mi3);
var Vf = (r) => {
  const { popup: e } = r, t8 = e.extraProps, { row: n, col: i, direction: o, unitId: s, subUnitId: l } = t8, a = useDependency(Mi3);
  useObservable(
    (0, import_react4.useMemo)(() => a.change$.pipe(
      filter((u) => u.row === n && u.col === i && u.direction === o)
    ), [a, n, i, o])
  );
  const c = a.getPopups(s, l, n, i, o), d = useDependency(S1);
  return (0, import_jsx_runtime4.jsx)("div", { "data-u-comp": "cell-popup", className: "univer-ml-px univer-flex univer-flex-col", children: c.map((u) => {
    var g;
    const h = d.get(u.componentKey);
    return h ? (0, import_jsx_runtime4.jsx)(h, { popup: u }, (g = u.id) != null ? g : u.componentKey) : null;
  }) });
};
var Hh2 = (r) => {
  const {
    inputId: e,
    state: t8 = false,
    type: n = "range",
    confirm: i,
    cancel: o,
    name: s,
    formulaOrRefString: l,
    comment: a = "",
    localSheetId: c = ng2,
    hidden: d = false,
    // excel
    id: u
  } = r, g = useDependency(vr).getCurrentUnitForType(we.UNIVER_SHEET), m2 = useDependency(Fn), f2 = useDependency(Nr2), v2 = useDependency(Qt2), p = useDependency(ga), S = useDependency(S1), w = (0, import_react4.useMemo)(() => S.get(hm), []), C = (0, import_react4.useMemo)(() => S.get(Ld2), []);
  if (g == null)
    return;
  const I2 = (0, import_react4.useMemo)(() => g.getUnitId(), []), R = (0, import_react4.useMemo)(() => g.getActiveSheet().getSheetId(), []), [y, M7] = (0, import_react4.useState)(s), [E, T] = (0, import_react4.useState)(l), [P2, H3] = (0, import_react4.useState)(a), [A, x7] = (0, import_react4.useState)(c), [V2, D2] = (0, import_react4.useState)(""), [X2, B] = (0, import_react4.useState)(n), [j, G7] = (0, import_react4.useState)(true), ge2 = [{
    label: m2.t("definedName.scopeWorkbook"),
    value: ng2
  }], Re3 = (me3) => !Wc(me3);
  (0, import_react4.useEffect)(() => {
    G7(true), M7(s), H3(a), x7(c);
    let me3 = l;
    l.substring(0, 1) === X.EQUALS ? B("formula") : Re3(l) ? (B("formula"), me3 = X.EQUALS + l) : B("range"), T(me3), D2("");
  }, [t8]), g.getSheetOrders().forEach((me3) => {
    const _e4 = g.getSheetBySheetId(me3);
    ge2.push({
      label: (_e4 == null ? void 0 : _e4.getName()) || "",
      value: me3
    });
  });
  const be2 = (me3) => {
    T(me3);
  }, Ne3 = (me3) => {
    T(me3 || "");
  }, Z7 = () => {
    if (y.length === 0) {
      D2(m2.t("definedName.nameEmpty"));
      return;
    }
    if (f2.getValueByName(I2, y) != null && (u == null || u.length === 0)) {
      D2(m2.t("definedName.nameDuplicate"));
      return;
    }
    if (!J.isValidParameter(y) || un(y) || !J.isStartValidPosition(y) && !r0(y.substring(0, 1))) {
      D2(m2.t("definedName.nameInvalid"));
      return;
    }
    if (g.getSheetOrders().map((le2) => {
      var it2;
      return ((it2 = g.getSheetBySheetId(le2)) == null ? void 0 : it2.getName()) || "";
    }).includes(y)) {
      D2(m2.t("definedName.nameSheetConflict"));
      return;
    }
    if (E.length === 0) {
      D2(m2.t("definedName.formulaOrRefStringEmpty"));
      return;
    }
    if (!j) {
      D2(m2.t("definedName.formulaOrRefStringInvalid"));
      return;
    }
    if (v2.hasExecutor(y.toUpperCase())) {
      D2(m2.t("definedName.nameConflict"));
      return;
    }
    const _e4 = g.getActiveSheet().getName();
    i && i({
      id: u || "",
      name: y,
      formulaOrRefString: p.convertRefersToAbsolute(E, ye.ALL, ye.ALL, _e4),
      comment: P2,
      localSheetId: A
    });
  }, ee3 = (me3) => {
    const _e4 = me3;
    _e4 === "formula" ? l[0] === X.EQUALS ? T(l) : T(`${X.EQUALS}`) : l[0] === X.EQUALS ? T("") : T(l), B(_e4);
  }, ne2 = (0, import_react4.useRef)(null), [pe2, Ue3] = (0, import_react4.useState)(false);
  return r7((me3) => {
    var le2;
    ((le2 = ne2.current) == null ? void 0 : le2.isClickOutSide(me3)) && Ue3(false);
  }), (0, import_jsx_runtime4.jsxs)(
    "div",
    {
      className: ie2("univer-grid univer-space-y-2 univer-pb-1", eE, {
        "univer-hidden": !t8
      }),
      children: [
        (0, import_jsx_runtime4.jsx)("div", { children: (0, import_jsx_runtime4.jsx)(
          Vx,
          {
            className: "univer-w-full",
            placeholder: m2.t("definedName.inputNamePlaceholder"),
            value: y,
            allowClear: true,
            onChange: M7
          }
        ) }),
        (0, import_jsx_runtime4.jsx)("div", { children: (0, import_jsx_runtime4.jsxs)(kE, { value: X2, onChange: ee3, children: [
          (0, import_jsx_runtime4.jsx)(TE, { value: "range", children: m2.t("definedName.ratioRange") }),
          (0, import_jsx_runtime4.jsx)(TE, { value: "formula", children: m2.t("definedName.ratioFormula") })
        ] }) }),
        X2 === "range" ? w && (0, import_jsx_runtime4.jsx)(
          w,
          {
            unitId: I2,
            subUnitId: R,
            initialValue: E,
            onChange: (me3, _e4) => be2(_e4),
            supportAcrossSheet: true
          }
        ) : C && (0, import_jsx_runtime4.jsx)("div", { className: "univer-relative univer-mt-4 univer-h-full", children: (0, import_jsx_runtime4.jsx)("div", { className: "univer-relative univer-h-8 univer-select-none", children: (0, import_jsx_runtime4.jsx)(
          C,
          {
            ref: ne2,
            className: ie2("univer-box-border univer-h-8 univer-w-full univer-cursor-pointer univer-items-center univer-rounded-lg univer-bg-white univer-pt-2 univer-transition-colors hover:univer-border-primary-600 dark:!univer-bg-gray-700 dark:!univer-text-white [&>div:first-child]:univer-px-2.5 [&>div]:univer-h-5 [&>div]:univer-ring-transparent", kt2),
            initValue: E,
            unitId: I2,
            subUnitId: R,
            isFocus: pe2,
            isSupportAcrossSheet: true,
            onChange: (me3 = "") => {
              Ne3(me3 || "");
            },
            onVerify: (me3) => {
              G7(me3);
            },
            onFocus: () => Ue3(true)
          }
        ) }) }),
        (0, import_jsx_runtime4.jsx)("div", { children: (0, import_jsx_runtime4.jsx)(
          LE,
          {
            className: "univer-w-full",
            value: A,
            options: ge2,
            onChange: x7
          }
        ) }),
        (0, import_jsx_runtime4.jsx)("div", { children: (0, import_jsx_runtime4.jsx)(
          Vx,
          {
            className: "univer-w-full",
            placeholder: m2.t("definedName.inputCommentPlaceholder"),
            value: P2,
            onChange: H3,
            allowClear: true
          }
        ) }),
        (0, import_jsx_runtime4.jsxs)(
          "div",
          {
            className: ie2("univer-items-center univer-gap-1 univer-text-sm univer-text-red-500", {
              "univer-hidden": V2.length === 0,
              "univer-flex": V2.length !== 0
            }),
            children: [
              (0, import_jsx_runtime4.jsx)("span", { children: V2 }),
              (0, import_jsx_runtime4.jsx)(nu2, {})
            ]
          }
        ),
        (0, import_jsx_runtime4.jsxs)("div", { className: "univer-flex univer-gap-2", children: [
          (0, import_jsx_runtime4.jsx)(
            vr2,
            {
              onClick: () => {
                o == null || o();
              },
              children: m2.t("definedName.cancel")
            }
          ),
          (0, import_jsx_runtime4.jsx)(
            vr2,
            {
              variant: "primary",
              onClick: Z7,
              children: m2.t("definedName.confirm")
            }
          )
        ] })
      ]
    }
  );
};
var Nf = () => {
  const r = useDependency(Ls), t8 = useDependency(vr).getCurrentUnitOfType(we.UNIVER_SHEET), n = useDependency(Fn), i = useDependency(Nr2), o = useDependency(z);
  if (t8 == null)
    return;
  const s = t8.getUnitId(), l = () => {
    const P2 = i.getDefinedNameMap(s);
    return P2 ? Array.from(Object.values(P2)) : [];
  }, [a, c] = (0, import_react4.useState)(false), [d, u] = (0, import_react4.useState)(l()), [h, g] = (0, import_react4.useState)(null), [m2, f2] = (0, import_react4.useState)();
  (0, import_react4.useEffect)(() => {
    const P2 = i.update$.subscribe(() => {
      u(l());
    });
    return () => {
      P2.unsubscribe();
    };
  }, []);
  const v2 = (P2) => {
    const { name: H3, formulaOrRefString: A, comment: x7, localSheetId: V2, hidden: D2 } = P2;
    let X2 = P2.id;
    if (X2 == null || X2.length === 0)
      X2 = et(10), r.executeCommand(fc.id, { id: X2, unitId: s, name: H3, formulaOrRefString: A, comment: x7, localSheetId: V2, hidden: D2 });
    else {
      const B = { id: X2, unitId: s, name: H3, formulaOrRefString: A, comment: x7, localSheetId: V2, hidden: D2 };
      r.executeCommand(Qr.id, B);
    }
    c(false), g(null);
  }, p = (P2) => {
    f2(P2);
  };
  function S() {
    f2(null);
  }
  function w(P2) {
    const H3 = i.getValueById(s, P2);
    r.executeCommand(Yr.id, { ...H3, unitId: s }), f2(null);
  }
  const C = async (P2) => {
    const { formulaOrRefString: H3, id: A } = P2, x7 = i.getWorksheetByRef(s, H3);
    if (!x7)
      return;
    x7.isSheetHidden() && await r.executeCommand(ui.id, { unitId: s, subUnitId: x7.getSheetId() }), i.focusRange(s, A);
  }, I2 = () => {
    const P2 = d.length + 1, H3 = n.t("definedName.defaultName") + P2;
    if (i.getValueByName(s, H3) == null)
      return H3;
    let A = P2 + 1;
    for (; ; ) {
      const x7 = n.t("definedName.defaultName") + A;
      if (i.getValueByName(s, x7) == null)
        return x7;
      A++;
    }
  }, R = () => {
    var x7;
    const P2 = (x7 = t8.getActiveSheet()) == null ? void 0 : x7.getName();
    if (!P2)
      return "";
    const H3 = o.getCurrentSelections();
    return H3 == null ? "" : H3.map((V2) => Hc2(P2, V2.range)).join(",");
  }, y = () => {
    c(false), g(null);
  }, M7 = () => {
    c(true), g(null);
  }, E = (P2) => {
    c(false), g(P2);
  }, T = (P2) => {
    const H3 = t8.getSheetBySheetId(P2);
    return H3 == null ? "" : H3.getName();
  };
  return (0, import_jsx_runtime4.jsx)(
    "div",
    {
      "data-u-comp": "defined-name-container",
      className: "univer-relative univer-box-border univer-w-full",
      children: (0, import_jsx_runtime4.jsxs)("div", { className: ie2("univer-w-full univer-overflow-hidden univer-overflow-y-auto", pr), children: [
        (0, import_jsx_runtime4.jsxs)("div", { className: "univer-mb-4", children: [
          (0, import_jsx_runtime4.jsxs)(
            vr2,
            {
              className: ie2(
                "univer-w-full",
                {
                  "univer-hidden": a
                }
              ),
              onClick: M7,
              children: [
                (0, import_jsx_runtime4.jsx)(ru2, {}),
                (0, import_jsx_runtime4.jsx)("span", { className: "univer-ml-1", children: n.t("definedName.addButton") })
              ]
            }
          ),
          a && (0, import_jsx_runtime4.jsx)(
            Hh2,
            {
              confirm: v2,
              cancel: y,
              state: a,
              inputId: "insertDefinedName",
              name: I2(),
              formulaOrRefString: R()
            }
          )
        ] }, "insertDefinedName"),
        d.map((P2, H3) => (0, import_jsx_runtime4.jsxs)(
          "div",
          {
            className: "univer-relative univer-w-full univer-divide-x-0 univer-divide-y univer-divide-solid univer-divide-gray-200 dark:!univer-divide-gray-600",
            children: [
              (0, import_jsx_runtime4.jsxs)(
                "div",
                {
                  className: ie2("univer-group univer-relative univer-flex univer-w-full univer-cursor-default univer-select-none univer-items-center univer-justify-between univer-rounded-md univer-p-2 hover:univer-bg-gray-50 dark:hover:!univer-bg-gray-700", {
                    "univer-hidden": P2.id === h
                  }),
                  onClick: () => {
                    C(P2);
                  },
                  children: [
                    (0, import_jsx_runtime4.jsxs)("div", { title: P2.comment, children: [
                      (0, import_jsx_runtime4.jsxs)(
                        "div",
                        {
                          className: "univer-my-1 univer-max-h-[100px] univer-max-w-[190px] univer-truncate univer-text-sm univer-font-medium univer-text-gray-900 dark:!univer-text-white",
                          children: [
                            P2.name,
                            (0, import_jsx_runtime4.jsx)("span", { className: "univer-text-xxs univer-ml-1 univer-text-gray-400", children: P2.localSheetId === ng2 || P2.localSheetId == null ? "" : T(P2.localSheetId) })
                          ]
                        }
                      ),
                      (0, import_jsx_runtime4.jsx)(
                        "div",
                        {
                          className: "univer-my-1 univer-max-h-[100px] univer-w-full univer-max-w-[190px] univer-truncate univer-text-xs univer-text-gray-500",
                          title: P2.formulaOrRefString,
                          children: P2.formulaOrRefString
                        }
                      )
                    ] }),
                    (0, import_jsx_runtime4.jsxs)(
                      "div",
                      {
                        className: "univer-absolute univer-right-5 univer-top-1/2 univer-hidden -univer-translate-y-1/2 univer-cursor-pointer univer-items-center univer-justify-end univer-gap-7 univer-text-xs univer-text-primary-600 group-hover:univer-flex dark:hover:!univer-bg-gray-600",
                        children: [
                          (0, import_jsx_runtime4.jsx)(Rp, { title: n.t("definedName.updateButton"), placement: "top", children: (0, import_jsx_runtime4.jsx)(
                            "a",
                            {
                              className: "univer-rounded univer-p-1 hover:univer-bg-gray-100",
                              onClick: (A) => {
                                A.stopPropagation(), E(P2.id);
                              },
                              children: (0, import_jsx_runtime4.jsx)(Gm, {})
                            }
                          ) }),
                          (0, import_jsx_runtime4.jsx)(Rp, { title: n.t("definedName.deleteButton"), placement: "top", children: (0, import_jsx_runtime4.jsx)(
                            "a",
                            {
                              className: "univer-rounded univer-p-1 univer-text-red-600 hover:univer-bg-gray-100",
                              onClick: (A) => {
                                A.stopPropagation(), p(P2.id);
                              },
                              children: (0, import_jsx_runtime4.jsx)(Pa2, {})
                            }
                          ) })
                        ]
                      }
                    )
                  ]
                }
              ),
              (0, import_jsx_runtime4.jsx)(
                uE,
                {
                  visible: m2 === P2.id,
                  onClose: S,
                  onConfirm: () => {
                    w(P2.id);
                  },
                  children: n.t("definedName.deleteConfirmText")
                }
              ),
              P2.id === h && (0, import_jsx_runtime4.jsx)(
                Hh2,
                {
                  confirm: v2,
                  cancel: y,
                  state: P2.id === h,
                  id: P2.id,
                  inputId: P2.id + H3,
                  name: P2.name,
                  formulaOrRefString: P2.formulaOrRefString,
                  comment: P2.comment,
                  localSheetId: P2.localSheetId
                }
              )
            ]
          },
          H3
        ))
      ] })
    }
  );
};
var kf = {
  id: Es.id,
  // when focusing on any other input tag do not trigger this shortcut
  preconditions: (r) => Ve4(r),
  binding: q1.Digit9 | L1.CTRL_COMMAND
};
var Df2 = {
  id: bs.id,
  // when focusing on any other input tag do not trigger this shortcut
  preconditions: (r) => Ve4(r),
  binding: q1.Digit0 | L1.CTRL_COMMAND | L1.SHIFT
};
var Lf = {
  id: Ut4.id,
  description: "shortcut.sheet.select-below-cell",
  group: "3_sheet-view",
  binding: q1.ARROW_DOWN,
  priority: 100,
  preconditions: Ve4,
  staticParameters: {
    direction: Cm.DOWN
  }
};
var Wf = {
  id: Ut4.id,
  description: "shortcut.sheet.select-up-cell",
  group: "3_sheet-view",
  binding: q1.ARROW_UP,
  priority: 100,
  preconditions: Ve4,
  staticParameters: {
    direction: Cm.UP
  }
};
var Bf2 = {
  id: Ut4.id,
  description: "shortcut.sheet.select-left-cell",
  group: "3_sheet-view",
  binding: q1.ARROW_LEFT,
  priority: 100,
  preconditions: Sm,
  staticParameters: {
    direction: Cm.LEFT
  }
};
var Ff = {
  id: Ut4.id,
  description: "shortcut.sheet.select-right-cell",
  group: "3_sheet-view",
  binding: q1.ARROW_RIGHT,
  priority: 100,
  preconditions: Sm,
  staticParameters: {
    direction: Cm.RIGHT
  }
};
var Uf = {
  id: Wn4.id,
  description: "shortcut.sheet.select-next-cell",
  group: "3_sheet-view",
  binding: q1.TAB,
  priority: 100,
  preconditions: Ve4,
  staticParameters: {
    direction: Cm.RIGHT,
    keycode: q1.TAB
  }
};
var Xf2 = {
  id: Wn4.id,
  description: "shortcut.sheet.select-previous-cell",
  group: "3_sheet-view",
  binding: q1.TAB | L1.SHIFT,
  priority: 100,
  preconditions: Ve4,
  staticParameters: {
    direction: Cm.LEFT,
    keycode: q1.TAB
  }
};
var zf2 = {
  id: Wn4.id,
  description: "shortcut.sheet.select-below-cell",
  group: "3_sheet-view",
  binding: q1.ENTER,
  priority: 100,
  preconditions: Ve4,
  staticParameters: {
    direction: Cm.DOWN,
    keycode: q1.ENTER
  }
};
var jf = {
  id: Wn4.id,
  description: "shortcut.sheet.select-up-cell",
  group: "3_sheet-view",
  binding: q1.ENTER | L1.SHIFT,
  priority: 100,
  preconditions: Ve4,
  staticParameters: {
    direction: Cm.UP,
    keycode: q1.ENTER
  }
};
var Yf2 = {
  id: Ut4.id,
  description: "shortcut.sheet.select-below-value-cell",
  group: "3_sheet-view",
  binding: q1.ARROW_DOWN | L1.CTRL_COMMAND,
  preconditions: Ve4,
  staticParameters: {
    direction: Cm.DOWN,
    jumpOver: Ln4.moveGap
  }
};
var Zf2 = {
  id: Ut4.id,
  description: "shortcut.sheet.select-up-value-cell",
  group: "3_sheet-view",
  binding: q1.ARROW_UP | L1.CTRL_COMMAND,
  preconditions: Ve4,
  staticParameters: {
    direction: Cm.UP,
    jumpOver: Ln4.moveGap
  }
};
var Gf2 = {
  id: Ut4.id,
  description: "shortcut.sheet.select-left-value-cell",
  group: "3_sheet-view",
  binding: q1.ARROW_LEFT | L1.CTRL_COMMAND,
  preconditions: Ve4,
  staticParameters: {
    direction: Cm.LEFT,
    jumpOver: Ln4.moveGap
  }
};
var qf2 = {
  id: Ut4.id,
  description: "shortcut.sheet.select-right-value-cell",
  group: "3_sheet-view",
  binding: q1.ARROW_RIGHT | L1.CTRL_COMMAND,
  preconditions: Ve4,
  staticParameters: {
    direction: Cm.RIGHT,
    jumpOver: Ln4.moveGap
  }
};
var Qf = {
  id: Gt3.id,
  description: "shortcut.sheet.expand-selection-down",
  group: "3_sheet-view",
  binding: q1.ARROW_DOWN | L1.SHIFT,
  preconditions: Ve4,
  staticParameters: {
    direction: Cm.DOWN
  }
};
var Kf2 = {
  id: Gt3.id,
  description: "shortcut.sheet.expand-selection-up",
  group: "3_sheet-view",
  binding: q1.ARROW_UP | L1.SHIFT,
  preconditions: Ve4,
  staticParameters: {
    direction: Cm.UP
  }
};
var Jf2 = {
  id: Gt3.id,
  description: "shortcut.sheet.expand-selection-left",
  group: "3_sheet-view",
  binding: q1.ARROW_LEFT | L1.SHIFT,
  preconditions: Ve4,
  staticParameters: {
    direction: Cm.LEFT
  }
};
var $f = {
  id: Gt3.id,
  description: "shortcut.sheet.expand-selection-right",
  group: "3_sheet-view",
  binding: q1.ARROW_RIGHT | L1.SHIFT,
  preconditions: Ve4,
  staticParameters: {
    direction: Cm.RIGHT
  }
};
var ep2 = {
  id: Gt3.id,
  description: "shortcut.sheet.expand-selection-to-below-gap",
  group: "3_sheet-view",
  binding: q1.ARROW_DOWN | L1.SHIFT | L1.CTRL_COMMAND,
  preconditions: Ve4,
  staticParameters: {
    direction: Cm.DOWN,
    jumpOver: Ln4.moveGap
  }
};
var tp = {
  id: Gt3.id,
  description: "shortcut.sheet.expand-selection-to-up-gap",
  group: "3_sheet-view",
  binding: q1.ARROW_UP | L1.SHIFT | L1.CTRL_COMMAND,
  preconditions: Ve4,
  staticParameters: {
    direction: Cm.UP,
    jumpOver: Ln4.moveGap
  }
};
var np = {
  id: Gt3.id,
  description: "shortcut.sheet.expand-selection-to-left-gap",
  group: "3_sheet-view",
  binding: q1.ARROW_LEFT | L1.SHIFT | L1.CTRL_COMMAND,
  preconditions: Ve4,
  staticParameters: {
    direction: Cm.LEFT,
    jumpOver: Ln4.moveGap
  }
};
var rp = {
  id: Gt3.id,
  description: "shortcut.sheet.expand-selection-to-right-gap",
  group: "3_sheet-view",
  binding: q1.ARROW_RIGHT | L1.SHIFT | L1.CTRL_COMMAND,
  preconditions: Ve4,
  staticParameters: {
    direction: Cm.RIGHT,
    jumpOver: Ln4.moveGap
  }
};
var ip = {
  id: Ra2.id,
  description: "shortcut.sheet.select-all",
  group: "3_sheet-view",
  binding: q1.A | L1.CTRL_COMMAND,
  preconditions: Ve4,
  staticParameters: {
    expandToGapFirst: true,
    loop: true
  }
};
var op = {
  id: Bi3.id,
  description: "shortcut.sheet.set-bold",
  group: "4_sheet-edit",
  preconditions: (r) => Ve4(r),
  binding: q1.B | L1.CTRL_COMMAND
};
var sp = {
  id: Fi3.id,
  description: "shortcut.sheet.set-italic",
  group: "4_sheet-edit",
  preconditions: (r) => Ve4(r),
  binding: q1.I | L1.CTRL_COMMAND
};
var lp = {
  id: Ui3.id,
  description: "shortcut.sheet.set-underline",
  group: "4_sheet-edit",
  preconditions: (r) => Ve4(r),
  binding: q1.U | L1.CTRL_COMMAND
};
var ap = {
  id: Xi2.id,
  description: "shortcut.sheet.set-strike-through",
  group: "4_sheet-edit",
  preconditions: (r) => Ve4(r),
  binding: q1.X | L1.SHIFT | L1.CTRL_COMMAND
};
var cp = {
  id: qs.id,
  // when focusing on any other input tag do not trigger this shortcut
  preconditions: (r) => Ve4(r),
  binding: q1.DELETE,
  mac: q1.BACKSPACE
};
var dp = {
  id: qs.id,
  // when focusing on any other input tag do not trigger this shortcut
  preconditions: (r) => Ve4(r),
  mac: q1.DELETE
};
var up = {
  id: qs.id,
  // when focusing on any other input tag do not trigger this shortcut
  preconditions: (r) => Ve4(r),
  binding: L1.SHIFT + q1.BACKSPACE
};
var hp = {
  id: Yd2.id,
  // when focusing on any other input tag do not trigger this shortcut
  preconditions: (r) => Ve4(r),
  binding: L1.SHIFT + q1.DELETE
};
var gp = {
  id: os2.id,
  description: "shortcut.sheet.zoom-in",
  binding: q1.EQUAL | L1.CTRL_COMMAND,
  group: "3_sheet-view",
  preconditions: Ve4,
  priority: 1,
  staticParameters: {
    delta: 0.2
  }
};
var mp = {
  id: Rg.id,
  binding: q1.EQUAL | L1.CTRL_COMMAND
};
var fp = {
  id: os2.id,
  description: "shortcut.sheet.zoom-out",
  binding: q1.MINUS | L1.CTRL_COMMAND,
  group: "3_sheet-view",
  preconditions: Ve4,
  priority: 1,
  staticParameters: {
    delta: -0.2
  }
};
var pp = {
  id: Rg.id,
  binding: q1.MINUS | L1.CTRL_COMMAND
};
var vp = {
  id: os2.id,
  description: "shortcut.sheet.reset-zoom",
  binding: q1.Digit0 | L1.CTRL_COMMAND,
  preconditions: Ve4,
  group: "3_sheet-view",
  priority: 1,
  staticParameters: {
    reset: true
  }
};
var Sp = {
  id: Rg.id,
  binding: q1.Digit0 | L1.CTRL_COMMAND
};
var cR2 = Object.getOwnPropertyDescriptor;
var dR = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? cR2(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var Un3 = (r, e) => (t8, n) => e(t8, n, r);
var pl = class extends Ve {
  constructor(r, e, t8, n, i, o, s, l) {
    super(), this._injector = r, this._componentManager = e, this._layoutService = t8, this._commandService = n, this._shortcutService = i, this._menuManagerService = o, this._uiPartsService = s, this._configService = l, this._init();
  }
  _init() {
    this._initComponents(), this._initCommands(), this._initMenus(), this._initShortcuts(), this._initWorkbenchParts(), this._initFocusHandler();
  }
  _initComponents() {
    const r = this._componentManager;
    this.disposeWithMe(r.register(Sn3, yf2)), this.disposeWithMe(r.register(au2, Hf)), this.disposeWithMe(r.register(xo2, Nf)), this.disposeWithMe(r.register(hu2, Vf)), this.disposeWithMe(r.register("HideGridlinesDoubleIcon", su2));
  }
  _initCommands() {
    [
      cu2,
      sr5,
      uu3,
      du2,
      os2,
      Gt3,
      Ut4,
      Wn4,
      Ta2,
      Sa2,
      Mo3,
      Eo4,
      ca,
      da,
      mn3,
      Hm2,
      Ra2,
      Jd2,
      jh,
      wi4,
      tt3,
      Ea2,
      Bi3,
      Fi3,
      Ui3,
      Xi2,
      Mm2,
      Em2,
      ua,
      ha2,
      Io3,
      qd2,
      zh,
      Kh,
      qh,
      Yh,
      Ca2,
      Qd2,
      rs2,
      wa2,
      gn2,
      To2,
      $n3,
      ba2,
      _a2,
      $d2,
      Gh,
      ss3,
      Jt3,
      Ia2,
      va2,
      vi3,
      pi3,
      ns2,
      ts2,
      eu2,
      gr3,
      _o3,
      // permission
      Hn3,
      Nm,
      ma2,
      ii3,
      oi3,
      fa,
      pa2,
      Ma2,
      si3,
      li3,
      ya2,
      is2,
      oa,
      sa
    ].forEach((r) => {
      this.disposeWithMe(this._commandService.registerCommand(r));
    });
  }
  _initMenus() {
    this._menuManagerService.mergeMenu(v_);
  }
  _initShortcuts() {
    [
      // selection shortcuts
      Lf,
      Wf,
      Bf2,
      Ff,
      Uf,
      Xf2,
      zf2,
      jf,
      // MoveBackSelectionShortcutItem,
      Yf2,
      Zf2,
      Gf2,
      qf2,
      Qf,
      Kf2,
      Jf2,
      $f,
      ep2,
      tp,
      np,
      rp,
      ip,
      // view shortcuts
      gp,
      fp,
      vp,
      Sp,
      mp,
      pp,
      // toggle cell style shortcuts
      op,
      sp,
      lp,
      ap,
      // cell content editing shortcuts
      cp,
      dp,
      up,
      hp,
      ...af2(),
      df2,
      cf2,
      uf2,
      mf2,
      ff2,
      pf2,
      Sf2,
      hf2,
      gf2,
      vf4,
      // operation shortcuts
      kf,
      Df2
    ].forEach((r) => {
      this.disposeWithMe(this._shortcutService.registerShortcut(r));
    });
  }
  _initWorkbenchParts() {
    const r = this._uiPartsService, e = this._injector;
    this.disposeWithMe(r.registerComponent(c12.HEADER, () => connectInjector(I02, e))), this.disposeWithMe(r.registerComponent(c12.FOOTER, () => connectInjector(R02, e))), this.disposeWithMe(r.registerComponent(c12.CONTENT, () => connectInjector(of3, e)));
  }
  _initFocusHandler() {
    this.disposeWithMe(
      this._layoutService.registerFocusHandler(we.UNIVER_SHEET, (r) => {
        const e = this._injector.get(ME), t8 = this._injector.get(vr), n = IE(we.UNIVER_DOC, t8, e), i = n == null ? void 0 : n.with(Re2);
        i == null || i.focus();
      })
    );
  }
};
pl = dR([
  Un3(0, Inject(Injector)),
  Un3(1, Inject(S1)),
  Un3(2, U1),
  Un3(3, Ls),
  Un3(4, ye3),
  Un3(5, B12),
  Un3(6, D1),
  Un3(7, ic)
], pl);
var uR2 = Object.getOwnPropertyDescriptor;
var hR = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? uR2(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var Ji2 = (r, e) => (t8, n) => e(t8, n, r);
var gR = qC("statusBarPermissionCorrect");
var mR2 = class {
  constructor() {
    _2(this, "_sum", 0);
    _2(this, "_count", 0);
    _2(this, "_countNumber", 0);
    _2(this, "_min", Number.POSITIVE_INFINITY);
    _2(this, "_max", Number.NEGATIVE_INFINITY);
  }
  add(e, t8, n) {
    if (!J.isDefine(e == null ? void 0 : e.v))
      return;
    const i = e == null ? void 0 : e.t;
    let { v: o } = e;
    const s = (a) => {
      this._sum += a, this._countNumber++, this._min = Math.min(this._min, a), this._max = Math.max(this._max, a);
    }, l = (a, c, d) => {
      var g;
      if (!((g = a == null ? void 0 : a.n) != null && g.pattern))
        return;
      const { pattern: u } = a.n;
      d[u] || (d[u] = eR.getFormatInfo(u)), d[u].isDate && s(c);
    };
    if (typeof o == "string" && i === fn.NUMBER) {
      const a = Number(o);
      Number.isNaN(a) || (o = a);
    }
    if (typeof o == "number" && i !== fn.STRING)
      s(o);
    else if (i === fn.NUMBER && e.s) {
      const a = t8.get(e.s);
      l(a, o, n);
    }
    this._count++;
  }
  getResults() {
    return {
      sum: this._sum,
      count: this._countNumber,
      // the countA in formula is the count of all values
      countA: this._count,
      min: this._min,
      max: this._max
    };
  }
};
function fR(r) {
  const { sum: e, count: t8, countA: n, min: i, max: o } = r.getResults();
  return [
    {
      func: v.MAX,
      value: o
    },
    {
      func: v.MIN,
      value: i
    },
    {
      func: Y.SUM,
      value: e
    },
    {
      func: v.COUNTA,
      value: n
    },
    {
      func: v.COUNT,
      value: t8
    },
    {
      func: v.AVERAGE,
      value: e / t8
    }
  ];
}
var Er2 = class extends Ve {
  constructor(e, t8, n, i, o) {
    super();
    _2(this, "interceptor", new ZC({ STATUS_BAR_PERMISSION_CORRECT: gR }));
    this._univerInstanceService = e, this._selectionManagerService = t8, this._statusBarService = n, this._commandService = i, this._numfmtService = o, this._init();
  }
  _init() {
    this._registerSelectionListener();
  }
  _registerSelectionListener() {
    const e = n1((n) => {
      var o;
      const i = (o = n[n.length - 1]) == null ? void 0 : o.primary;
      this._calculateSelection(
        n.map((s) => s.range),
        i
      );
    }, 100), t8 = n1((n) => {
      var o;
      const i = (o = n[n.length - 1]) == null ? void 0 : o.primary;
      this._calculateSelection(
        n.map((s) => s.range),
        i
      );
    }, 500);
    this.disposeWithMe(
      We(
        this._selectionManagerService.selectionMoving$.subscribe((n) => {
          n && t8(n);
        })
      )
    ), this.disposeWithMe(
      We(
        this._selectionManagerService.selectionMoveEnd$.subscribe((n) => {
          n && e(n);
        })
      )
    ), this.disposeWithMe(
      this._commandService.onCommandExecuted((n) => {
        if (n.id === ee.id) {
          const i = this._selectionManagerService.getCurrentSelections();
          i && e(i);
        }
      })
    );
  }
  _clearResult() {
    this._statusBarService.setState(null);
  }
  getRangeStartEndInfo(e, t8) {
    return e.rangeType === ge.ALL ? {
      startRow: 0,
      startColumn: 0,
      endRow: t8.getRowCount() - 1,
      endColumn: t8.getColumnCount() - 1
    } : e.rangeType === ge.COLUMN ? {
      startRow: 0,
      startColumn: e.startColumn,
      endRow: t8.getRowCount() - 1,
      endColumn: e.endColumn
    } : e.rangeType === ge.ROW ? {
      startRow: e.startRow,
      startColumn: 0,
      endRow: e.endRow,
      endColumn: t8.getColumnCount() - 1
    } : {
      startRow: e.startRow,
      startColumn: e.startColumn,
      endRow: e.endRow,
      endColumn: e.endColumn
    };
  }
  // eslint-disable-next-line max-lines-per-function
  _calculateSelection(e, t8) {
    var a;
    const n = this._univerInstanceService.getCurrentUnitForType(we.UNIVER_SHEET);
    if (!n)
      return this._clearResult();
    const i = n.getUnitId(), o = n.getActiveSheet(), s = o == null ? void 0 : o.getSheetId();
    if (!s)
      return this._clearResult();
    const l = {};
    if (this._univerInstanceService.getCurrentUnitForType(we.UNIVER_SHEET).getSheets().forEach((c) => {
      const d = c.getConfig();
      l[c.getSheetId()] = {
        cellData: new pt(d.cellData),
        rowCount: d.rowCount,
        columnCount: d.columnCount,
        rowData: d.rowData,
        columnData: d.columnData
      };
    }), e != null && e.length) {
      const c = [];
      e.forEach((S) => {
        const { startRow: w, endRow: C } = S;
        let I2 = null;
        for (let R = w; R <= C; R++)
          o.getRowVisible(R) ? I2 === null && (I2 = R) : I2 !== null && (c.push({ ...S, startRow: I2, endRow: R - 1 }), I2 = null);
        I2 !== null && c.push({ ...S, startRow: I2, endRow: C });
      });
      const d = Pu(c), u = new mR2(), h = n.getStyles(), g = {};
      for (const S of d) {
        const { startRow: w, startColumn: C, endColumn: I2, endRow: R } = this.getRangeStartEndInfo(S, o);
        for (let y = w; y <= R; y++)
          for (let M7 = C; M7 <= I2; M7++) {
            const E = o.getCellRaw(y, M7);
            u.add(E, h, g);
          }
      }
      const m2 = fR(u);
      if (m2.every((S) => S === void 0))
        return;
      let f2 = null;
      if (t8) {
        const { actualRow: S, actualColumn: w } = t8;
        f2 = (a = this._numfmtService.getValue(i, s, S, w)) == null ? void 0 : a.pattern;
      }
      const p = {
        values: m2.filter((S) => S !== void 0),
        pattern: f2
      };
      this._statusBarService.setState(p);
    } else
      this._clearResult();
  }
};
Er2 = hR([
  Ji2(0, vr),
  Ji2(1, Inject(z)),
  Ji2(2, xa2),
  Ji2(3, Ls),
  Ji2(4, Inject(Wt))
], Er2);
var pR = (r = []) => {
  const e = useDependency(Wi3);
  (0, import_react4.useEffect)(() => {
    const t8 = r.map((n) => e.addShape({
      range: n,
      style: {
        fill: "rgba(73, 184, 17, 0.05)",
        strokeWidth: 1,
        stroke: "#49B811",
        widgets: {}
      },
      primary: {
        startColumn: n.startColumn,
        endColumn: n.endColumn,
        startRow: n.startRow,
        endRow: n.endRow,
        actualRow: n.startRow,
        actualColumn: n.startColumn,
        isMerged: false,
        isMergedMainCell: false
      }
    }));
    return () => {
      t8.forEach((n) => {
        n && e.removeShape(n);
      });
    };
  }, [r]);
};
var vR2 = Object.getOwnPropertyDescriptor;
var SR2 = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? vR2(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var Vh3 = (r, e) => (t8, n) => e(t8, n, r);
var Ei2 = class extends Ve {
  constructor(e, t8) {
    super();
    _2(this, "_previousSheetIndex", -1);
    this._commandService = e, this._univerInstanceService = t8, this.disposeWithMe(this._commandService.beforeCommandExecuted((n) => {
      if (n.id === Ht.id)
        return this._beforeAdjustActiveSheetOnRemoveSheet(
          n
        );
    })), this.disposeWithMe(this._commandService.onCommandExecuted((n, i) => {
      if (n.id === Ht.id)
        return this._adjustActiveSheetOnRemoveSheet(n);
      if (n.id === wt.id && n.params.hidden)
        return this._adjustActiveSheetOnHideSheet(n);
      if (i != null && i.fromCollab) return false;
      if (n.id === hn.id)
        return this._adjustActiveSheetOnInsertSheet(n);
      if (n.id === wt.id && !n.params.hidden)
        return this._adjustActiveSheetOnShowSheet(n);
      if (n.id === ie3.id)
        return this._adjustActiveSheetOnSelection(n);
    }));
  }
  _adjustActiveSheetOnHideSheet(e) {
    var a;
    const { unitId: t8, subUnitId: n } = e.params, i = this._univerInstanceService.getUniverSheetInstance(t8);
    if (!i || ((a = i.getActiveSheet()) == null ? void 0 : a.getSheetId()) !== n)
      return;
    const s = i.getActiveSheetIndex(), l = Nh2(i, s);
    this._switchToNextSheet(t8, l);
  }
  _beforeAdjustActiveSheetOnRemoveSheet(e) {
    const { unitId: t8, subUnitId: n } = e.params, i = this._univerInstanceService.getUniverSheetInstance(t8);
    if (!i)
      return;
    const o = i.getSheetBySheetId(n);
    o && (this._previousSheetIndex = i.getSheetIndex(o));
  }
  _adjustActiveSheetOnRemoveSheet(e) {
    if (this._previousSheetIndex === -1)
      return;
    const { unitId: t8 } = e.params, n = this._univerInstanceService.getUniverSheetInstance(t8);
    if (!n)
      return;
    if (n.getActiveSheet().getSheetId() === e.params.subUnitId) {
      const o = this._previousSheetIndex, s = o >= 1 ? o - 1 : 0, l = Nh2(n, s);
      this._switchToNextSheet(t8, l);
    }
  }
  _adjustActiveSheetOnInsertSheet(e) {
    const { unitId: t8, sheet: n } = e.params;
    this._switchToNextSheet(t8, n.id);
  }
  _adjustActiveSheetOnShowSheet(e) {
    const { unitId: t8, subUnitId: n } = e.params;
    this._switchToNextSheet(t8, n);
  }
  _adjustActiveSheetOnSelection(e) {
    var i;
    const { unitId: t8, subUnitId: n } = e.params;
    n !== ((i = this._univerInstanceService.getUnit(t8)) == null ? void 0 : i.getActiveSheet().getSheetId()) && this._switchToNextSheet(t8, n);
  }
  _switchToNextSheet(e, t8) {
    this._commandService.executeCommand(pn2.id, {
      unitId: e,
      subUnitId: t8
    });
  }
};
Ei2 = SR2([
  Vh3(0, Ls),
  Vh3(1, vr)
], Ei2);
function Nh2(r, e) {
  const t8 = r.getSheetSize();
  for (let n = e; n > -1; n--) {
    const i = r.getSheetByIndex(n);
    if (!i.getConfig().hidden)
      return i.getSheetId();
  }
  for (let n = e; n < t8; n++) {
    const i = r.getSheetByIndex(n);
    if (!i.getConfig().hidden)
      return i.getSheetId();
  }
  throw new Error(
    "[ActiveWorksheetController]: could not find the next unhidden sheet! Collaboration error perhaps."
  );
}
var CR = Object.getOwnPropertyDescriptor;
var wR = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? CR(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var kh3 = (r, e) => (t8, n) => e(t8, n, r);
var po3 = ((r) => (r[r.INFO = 0] = "INFO", r[r.WARNING = 1] = "WARNING", r[r.ERROR = 2] = "ERROR", r))(po3 || {});
var Do3 = class extends Ve {
  constructor(e, t8) {
    super();
    _2(this, "_currentAlert$", new Subject());
    _2(this, "_currentAlert", /* @__PURE__ */ new Map());
    _2(this, "currentAlert$", this._currentAlert$.asObservable());
    this._renderManagerService = e, this._cellPopupManagerService = t8, this.disposeWithMe(() => {
      this._currentAlert$.complete();
    });
  }
  get currentAlert() {
    return this._currentAlert;
  }
  showAlert(e) {
    var d;
    let t8 = this._currentAlert.get(e.key);
    t8 && t8.dispose.dispose(), t8 ? t8.dispose.dispose() : (t8 = {
      alert: e,
      dispose: {
        dispose() {
        }
      }
    }, this._currentAlert.set(e.key, t8));
    const { location: n } = e, { row: i, col: o, unitId: s, subUnitId: l } = n;
    if (!this._renderManagerService.getRenderById(s))
      return;
    const c = this._cellPopupManagerService.showPopup(
      {
        unitId: s,
        subUnitId: l,
        row: i,
        col: o
      },
      {
        componentKey: Cp,
        direction: "horizontal",
        extraProps: {
          alert: e
        },
        priority: 1
      }
    );
    c && (t8 && ((d = t8.dispose) == null || d.dispose()), t8.dispose = c), this._currentAlert$.next(Array.from(this._currentAlert.entries()));
  }
  removeAlert(e) {
    const t8 = this._currentAlert.get(e);
    t8 && (this._currentAlert.delete(e), t8 == null || t8.dispose.dispose(), this._currentAlert$.next(Array.from(this._currentAlert.entries())));
  }
  clearAlert() {
    this._currentAlert.forEach((e) => {
      e.dispose.dispose();
    }), this._currentAlert.clear(), this._currentAlert$.next(Array.from(this._currentAlert.entries()));
  }
};
Do3 = wR([
  kh3(0, ME),
  kh3(1, Inject(Mi3))
], Do3);
function bR({ popup: r }) {
  var s;
  const e = (s = r.extraProps) == null ? void 0 : s.alert;
  if (!e)
    return null;
  const { type: t8, title: n, message: i } = e, o = {
    [po3.ERROR]: (0, import_jsx_runtime4.jsx)(nu2, { className: "univer-mr-1.5 univer-text-red-500" }),
    [po3.INFO]: (0, import_jsx_runtime4.jsx)(Zm, { className: "univer-mr-1.5 univer-text-blue-500" }),
    [po3.WARNING]: (0, import_jsx_runtime4.jsx)(Qm, { className: "univer-mr-1.5 univer-text-yellow-500" })
  };
  return (0, import_jsx_runtime4.jsxs)(
    "div",
    {
      className: "univer-z-[100] univer-box-border univer-w-[156px] univer-rounded-lg univer-bg-white univer-px-2 univer-py-1 univer-text-gray-900 univer-shadow dark:!univer-bg-black dark:!univer-text-white",
      children: [
        (0, import_jsx_runtime4.jsxs)(
          "div",
          {
            className: "univer-mb-1.5 univer-flex univer-h-5 univer-flex-row univer-items-center univer-text-sm univer-font-medium",
            children: [
              t8 ? o[t8] : null,
              n
            ]
          }
        ),
        (0, import_jsx_runtime4.jsx)("div", { className: "univer-text-sm", children: i })
      ]
    }
  );
}
var Cp = "univer.sheet.cell-alert";
var _R = Object.getOwnPropertyDescriptor;
var RR = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? _R(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var IR2 = (r, e) => (t8, n) => e(t8, n, r);
var vl = class extends Ve {
  constructor(r, e) {
    super(), this._context = r, this._componentManager = e, this._initComponent();
  }
  _initComponent() {
    this.disposeWithMe(
      this._componentManager.register(Cp, bR)
    );
  }
};
vl = RR([
  IR2(1, Inject(S1))
], vl);
var yR = Object.getOwnPropertyDescriptor;
var MR2 = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? yR(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var Rs3 = (r, e) => (t8, n) => e(t8, n, r);
var Ti2 = class extends Ve {
  constructor(e, t8, n, i) {
    super();
    _2(this, "_isPointer", false);
    this._hoverManagerService = e, this._instanceService = t8, this._commandService = n, this._renderManagerService = i, this._initPointerEvent(), this._initHover();
  }
  get _mainComponent() {
    var e;
    return (e = IE(we.UNIVER_SHEET, this._instanceService, this._renderManagerService)) == null ? void 0 : e.mainComponent;
  }
  _initHover() {
    this.disposeWithMe(this._hoverManagerService.currentRichText$.subscribe((e) => {
      var t8, n;
      e != null && e.bullet ? (this._isPointer || (t8 = this._mainComponent) == null || t8.setCursor(v1.POINTER), this._isPointer = true) : (this._isPointer && ((n = this._mainComponent) == null || n.setCursor(v1.AUTO)), this._isPointer = false);
    }));
  }
  _initPointerEvent() {
    this.disposeWithMe(this._hoverManagerService.currentClickedCell$.subscribe((e) => {
      const { location: t8, bullet: n } = e;
      n && this._commandService.executeCommand(ud.id, {
        unitId: t8.unitId,
        subUnitId: t8.subUnitId,
        row: t8.row,
        col: t8.col,
        paragraphIndex: n.startIndex
      });
    }));
  }
};
Ti2 = MR2([
  Rs3(0, Inject(Mr3)),
  Rs3(1, vr),
  Rs3(2, Ls),
  Rs3(3, ME)
], Ti2);
var Dh2 = 2;
var ER = [
  { value: "DEFAULT_PASTE", label: "rightClick.paste" },
  { value: "SPECIAL_PASTE_VALUE", label: "rightClick.pasteValue" },
  { value: "SPECIAL_PASTE_FORMAT", label: "rightClick.pasteFormat" },
  { value: "SPECIAL_PASTE_COL_WIDTH", label: "rightClick.pasteColWidth" },
  { value: "SPECIAL_PASTE_BESIDES_BORDER", label: "rightClick.pasteBesidesBorder" },
  { value: "SPECIAL_PASTE_FORMULA", label: "formula.operation.pasteFormula" }
];
var TR2 = (r) => {
  var P2, H3, A, x7, V2;
  const e = useDependency(vr), t8 = useDependency(ME), n = kr();
  if (!r || !n) return null;
  const i = {
    startRow: r.rows[0],
    startCol: r.cols[0],
    endRow: r.rows[r.rows.length - 1],
    endCol: r.cols[r.cols.length - 1]
  };
  if (i.endRow < 0 || i.endCol < 0)
    return null;
  const o = t8.getRenderById(n.getUnitId()), s = o == null ? void 0 : o.with(ue), l = o == null ? void 0 : o.with(gt), a = en4(e, t8);
  if (!a || !l) return null;
  const { scene: c } = a, d = s == null ? void 0 : s.getCurrentSkeleton(), u = l.getViewPort(), h = c == null ? void 0 : c.scaleX, g = c == null ? void 0 : c.scaleY, m2 = c == null ? void 0 : c.getViewportScrollXY(u), f2 = (P2 = c.getEngine()) == null ? void 0 : P2.getCanvas();
  if (!h || !c || !h || !g || !m2) return null;
  const v2 = d == null ? void 0 : d.getNoMergeCellPositionByIndex(i.endRow, i.endCol), p = (H3 = v2 == null ? void 0 : v2.endX) != null ? H3 : 0, S = (A = v2 == null ? void 0 : v2.endY) != null ? A : 0, w = (x7 = PB(p, h, m2)) != null ? x7 : -9999, C = (V2 = NB(S, g, m2)) != null ? V2 : -9999, I2 = f2 == null ? void 0 : f2.getWidth(), R = f2 == null ? void 0 : f2.getHeight();
  if (!I2 || !R) return null;
  const y = w + 50 <= I2, M7 = C + 50 <= R;
  let E = w, T = C;
  return y || (E = I2 - 100), M7 || (T = R - 100), {
    positionX: E,
    positionY: T
  };
};
var PR2 = () => {
  const r = useDependency(nn2), e = useObservable(r.showMenu$, false), t8 = useObservable(r.pasteOptionsCache$, null), n = useDependency(Fn), i = useDependency(Ls), [o, s] = (0, import_react4.useState)(false), [l, a] = (0, import_react4.useState)(false), c = t8 == null ? void 0 : t8.target.pastedRange, d = TR2(c);
  if (!d || !e || d.positionX < 50 || d.positionY < 30) return null;
  const u = o || l, h = (g) => {
    a(false), i.executeCommand(_m.id, { type: g });
  };
  return (0, import_jsx_runtime4.jsx)("div", { className: "univer-absolute univer-inset-0 univer-z-10 univer-size-0", children: (0, import_jsx_runtime4.jsx)(
    "div",
    {
      className: "univer-absolute",
      style: {
        left: d.positionX + Dh2,
        top: d.positionY + Dh2
      },
      onMouseEnter: () => s(true),
      onMouseLeave: () => s(false),
      children: (0, import_jsx_runtime4.jsx)(
        ep,
        {
          align: "start",
          items: ER.map((g) => ({
            type: "checkbox",
            value: g.value,
            label: n.t(g.label),
            checked: (t8 == null ? void 0 : t8.pasteType) === et3[g.value],
            onSelect: () => h(g.value)
          })),
          open: l,
          onOpenChange: a,
          children: (0, import_jsx_runtime4.jsxs)(
            "div",
            {
              className: ie2("univer-flex univer-items-center univer-gap-2 univer-rounded univer-p-1 hover:univer-bg-gray-100 dark:hover:!univer-bg-gray-800", kt2, {
                "univer-bg-gray-100 dark:!univer-bg-gray-800": l,
                "univer-bg-white dark:!univer-bg-gray-900": !l
              }),
              children: [
                (0, import_jsx_runtime4.jsx)(
                  $m2,
                  {
                    className: "univer-fill-primary-600 univer-text-gray-900 dark:!univer-text-white"
                  }
                ),
                u && (0, import_jsx_runtime4.jsx)(_i3, { className: "dark:!univer-text-white" })
              ]
            }
          )
        }
      )
    }
  ) });
};
var xR2 = [
  tt3.id,
  Sn.id,
  Jt3.id,
  It.id,
  Te.id,
  Me.id,
  Ue.id,
  ke2.id,
  Je2.id,
  qe2.id,
  mt.id,
  nt.id,
  ie3.id,
  mC
];
function OR(r, e, t8, n, i) {
  const o = [], s = [];
  if (n.copyType === Yn3.CUT) {
    const { undos: l, redos: a } = AR(r, e, i);
    o.push(...a), s.push(...l);
  } else {
    const { undos: l, redos: a } = _p(e, t8, i);
    o.push(...a), s.push(...l);
    const { undos: c, redos: d } = HR(e, t8, i);
    o.push(...d), s.push(...c);
    const { undos: u, redos: h } = wp(e, r, t8, i);
    o.push(...h), s.push(...u);
    const { undos: g, redos: m2 } = bp(e, r, t8, i, true);
    o.push(...m2), s.push(...g);
    const { undos: f2, redos: v2 } = Kc2(
      e,
      t8,
      i
    );
    o.push(...v2), s.push(...f2);
  }
  return {
    undos: s,
    redos: o
  };
}
function AR(r, e, t8) {
  let n = [], i = [];
  const { range: o, subUnitId: s, unitId: l } = r, { range: a, subUnitId: c } = e, d = a ? Cr3(a) : null, u = o ? Cr3(o) : null;
  if (u && d) {
    const h = t8.get(vr), g = t8.get(G), m2 = h.getUniverSheetInstance(l), f2 = m2 == null ? void 0 : m2.getSheetBySheetId(s), v2 = m2 == null ? void 0 : m2.getSheetBySheetId(c);
    if (f2 && v2) {
      const p = new pt(), S = new pt(), w = f2.getCellMatrix(), C = v2.getCellMatrix();
      Or.foreach(u, (B, j) => {
        p.setValue(B, j, J.deepClone(w.getValue(B, j))), S.setValue(B, j, null);
      });
      const I2 = new pt();
      Or.foreach(d, (B, j) => {
        I2.setValue(B, j, J.deepClone(C.getValue(B, j)));
      });
      const R = new pt();
      Or.foreach(u, (B, j) => {
        const G7 = V1(B, j), ge2 = En.getRelativeRange(G7, u), Re3 = En.getPositionRange(ge2, d);
        R.setValue(Re3.startRow, Re3.startColumn, w.getValue(B, j));
      });
      const y = {
        fromRange: u,
        toRange: d,
        from: {
          value: S.getMatrix(),
          subUnitId: s
        },
        to: {
          value: R.getMatrix(),
          subUnitId: c
        },
        unitId: l
      }, M7 = {
        fromRange: d,
        toRange: u,
        from: {
          value: p.getMatrix(),
          subUnitId: s
        },
        to: {
          value: I2.getMatrix(),
          subUnitId: c
        },
        unitId: l
      }, E = g.onCommandExecute({
        id: bt2.id,
        params: { toRange: d, fromRange: u }
      }), T = f2.getMergeData(), P2 = v2.getMergeData(), H3 = T.filter((B) => En.intersects(B, u)), A = P2.filter((B) => En.intersects(B, d)), x7 = H3.map((B) => En.getRelativeRange(B, u)).map((B) => En.getPositionRange(B, d)), V2 = zr(x7), D2 = [
        {
          id: se2.id,
          params: {
            unitId: l,
            subUnitId: s,
            ranges: H3
          }
        },
        {
          id: se2.id,
          params: {
            unitId: l,
            subUnitId: s,
            ranges: A
          }
        },
        {
          id: ne.id,
          params: {
            unitId: l,
            subUnitId: c,
            ranges: V2
          }
        }
      ], X2 = [
        {
          id: se2.id,
          params: {
            unitId: l,
            subUnitId: c,
            ranges: V2
          }
        },
        {
          id: ne.id,
          params: {
            unitId: l,
            subUnitId: c,
            ranges: A
          }
        },
        {
          id: ne.id,
          params: {
            unitId: l,
            subUnitId: s,
            ranges: H3
          }
        }
      ];
      n = [
        { id: It.id, params: y },
        ...E.redos,
        ...D2,
        {
          id: ie3.id,
          params: {
            unitId: l,
            subUnitId: c,
            selections: [{ range: d }],
            type: we2.MOVE_END
          }
        }
      ], i = [
        { id: It.id, params: M7 },
        ...E.undos,
        ...X2,
        {
          id: ie3.id,
          params: {
            unitId: l,
            subUnitId: s,
            type: we2.MOVE_END,
            selections: [{ range: u }]
          }
        }
      ];
    }
  }
  return {
    undos: i,
    redos: n
  };
}
function wp(r, e, t8, n) {
  var m2;
  const { unitId: i, subUnitId: o, range: s } = r, l = (m2 = n.get(vr).getUniverSheetInstance(i)) == null ? void 0 : m2.getSheetBySheetId(o), a = [], c = [], { mapFunc: d } = wr3([s]), u = new pt();
  t8.forValue((f2, v2, p) => {
    var I2, R;
    const { row: S, col: w } = d(f2, v2), C = {
      v: p.v,
      t: p.t
    };
    if (!p.p && p.v && !e) {
      const y = l == null ? void 0 : l.getCellStyle(S, w);
      if (tR((I2 = y == null ? void 0 : y.n) == null ? void 0 : I2.pattern))
        C.t = fn.STRING;
      else {
        const M7 = String(p.v), E = eR.parseValue(M7);
        (E == null ? void 0 : E.v) !== void 0 && typeof E.v == "number" && (!E.z && a1(M7) ? C.t = fn.FORCE_STRING : C.v = E.v);
      }
    }
    if ((R = p.p) != null && R.body && Zc(p.p.body)) {
      const y = J.deepClone({ p: p.p, v: p.v });
      u.setValue(S, w, y);
    } else
      u.setValue(S, w, J.deepClone(C));
  });
  const h = {
    unitId: i,
    subUnitId: o,
    cellValue: J.deepClone(u.getMatrix())
  };
  a.push({
    id: ee.id,
    params: h
  });
  const g = Ae(
    n,
    h
  );
  return c.push({
    id: ee.id,
    params: g
  }), {
    undos: c,
    redos: a
  };
}
function bp(r, e, t8, n, i = false) {
  var f2;
  const o = [], s = [], { unitId: l, subUnitId: a, range: c } = r, d = (f2 = n.get(vr).getUniverSheetInstance(l)) == null ? void 0 : f2.getSheetBySheetId(a), u = new pt(), { mapFunc: h } = wr3([c]);
  t8.forValue((v2, p, S) => {
    var M7, E;
    const w = {
      s: Object.assign({}, {
        ...rt,
        pd: h2,
        bg: null,
        cl: null
      }, S.s)
    }, C = w.s.bd;
    C && (Object.keys(C).length > 0 || (w.s.bd = {
      b: null,
      l: null,
      r: null,
      t: null
    }));
    const { row: I2, col: R } = h(v2, p), y = d == null ? void 0 : d.getCellStyle(I2, R);
    if (S.v && !e && tR((M7 = y == null ? void 0 : y.n) == null ? void 0 : M7.pattern))
      w.s || (w.s = {}), w.s.n = y == null ? void 0 : y.n;
    else {
      const T = String(S.v), P2 = eR.parseValue(T);
      P2 != null && P2.z && (w.s || (w.s = {}), typeof w.s == "object" && ((E = w.s) != null && E.n ? w.s.n.pattern = P2.z : w.s.n = { pattern: P2.z }));
    }
    u.setValue(I2, R, w);
  });
  const g = {
    unitId: l,
    subUnitId: a,
    cellValue: J.deepClone(u.getMatrix())
  };
  o.push({
    id: ee.id,
    params: g
  });
  const m2 = Ae(
    n,
    g
  );
  return s.push({
    id: ee.id,
    params: m2
  }), {
    undos: s,
    redos: o
  };
}
function _p(r, e, t8) {
  const n = [], i = [], o = new pt(), { unitId: s, subUnitId: l, range: a } = r, { mapFunc: c } = wr3([a]);
  if (e.forEach((d, u) => {
    Object.keys(u).forEach((h) => {
      const g = Number(h), { row: m2, col: f2 } = c(d, g);
      o.setValue(m2, f2, { s: null });
    });
  }), o.getLength() > 0) {
    const d = {
      subUnitId: l,
      unitId: s,
      cellValue: J.deepClone(o.getMatrix())
    };
    n.push({
      id: ee.id,
      params: d
    });
    const u = Ae(
      t8,
      d
    );
    i.push({
      id: ee.id,
      params: u
    });
  }
  return { undos: i, redos: n };
}
function HR(r, e, t8) {
  const n = [], i = [], o = new pt(), { unitId: s, subUnitId: l, range: a } = r, { mapFunc: c } = wr3([a]);
  if (e.forValue((d, u, h) => {
    const { row: g, col: m2 } = c(d, u);
    o.setValue(g, m2, { v: null, p: null });
  }), o.getLength() > 0) {
    const d = {
      subUnitId: l,
      unitId: s,
      cellValue: J.deepClone(o.getMatrix())
    };
    n.push({
      id: ee.id,
      params: d
    });
    const u = Ae(
      t8,
      d
    );
    i.push({
      id: ee.id,
      params: u
    });
  }
  return { undos: i, redos: n };
}
function Kc2(r, e, t8) {
  const n = [], i = [], { unitId: o, subUnitId: s, range: l } = r, { startColumn: a, startRow: c, endColumn: d, endRow: u } = Cr3(l), h = [];
  e.forValue((S, w, C) => {
    if (C.rowSpan && C.rowSpan > 1) {
      const I2 = C.colSpan || 1, R = {
        startRow: c + S,
        endRow: c + S + C.rowSpan - 1,
        startColumn: a + w,
        endColumn: a + w + I2 - 1
      };
      h.push(R);
    } else if (C.colSpan && C.colSpan > 1) {
      const I2 = C.rowSpan || 1, R = {
        startRow: c + S,
        endRow: c + S + I2 - 1,
        startColumn: a + w,
        endColumn: a + w + C.colSpan - 1
      };
      h.push(R);
    }
  });
  const m2 = t8.get(vr).getUniverSheetInstance(o), f2 = m2 == null ? void 0 : m2.getSheetBySheetId(s);
  if (m2 && f2) {
    const w = f2.getMergeData().filter(
      (R) => En.intersects({ startRow: c, startColumn: a, endRow: u, endColumn: d }, R)
    ), C = {
      unitId: o,
      subUnitId: s,
      ranges: w
    };
    n.push({
      id: se2.id,
      params: C
    });
    const I2 = ye2(
      t8,
      C
    );
    i.push({
      id: ne.id,
      params: I2
    });
  }
  const v2 = {
    unitId: o,
    subUnitId: s,
    ranges: h
  };
  h.length > 0 && n.push({
    id: ne.id,
    params: v2
  });
  const p = We2(
    t8,
    v2
  );
  return h.length > 0 && i.push({
    id: se2.id,
    params: p
  }), { undos: i, redos: n };
}
function VR(r) {
  if (!r.includes("\r") && J.isLegalUrl(r)) {
    const n = et(), i = `${r}`, o = {
      startIndex: 0,
      endIndex: i.length - 1,
      rangeId: n,
      rangeType: pn.HYPERLINK,
      properties: {
        url: r
      }
    };
    return {
      dataStream: `${i}\r
`,
      paragraphs: [{
        startIndex: i.length
      }],
      customRanges: [o]
    };
  }
  let e = r.replace(/(\r\n|\n)/g, "\r");
  e.endsWith(`\r
`) || (e += `\r
`);
  const t8 = [];
  for (let n = 0; n < e.length; n++)
    e[n] === "\r" && t8.push({ startIndex: n });
  return {
    dataStream: e,
    paragraphs: t8,
    sectionBreaks: [{ startIndex: e.indexOf(`
`) }]
  };
}
var NR = Object.getOwnPropertyDescriptor;
var kR = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? NR(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var rn3 = (r, e) => (t8, n) => e(t8, n, r);
var DR2 = [
  ke2.id,
  Ue.id,
  Me.id,
  Te.id,
  It.id,
  Je2.id,
  qe2.id
];
var Tr2 = class extends h1 {
  constructor(e, t8, n, i, o, s, l, a, c, d) {
    super();
    _2(this, "_refreshOptionalPaste$", new Subject());
    _2(this, "refreshOptionalPaste$", this._refreshOptionalPaste$.asObservable());
    this._injector = e, this._instanceService = t8, this._renderManagerService = n, this._commandService = i, this._contextService = o, this._configService = s, this._sheetClipboardService = l, this._messageService = a, this._localService = c, this._uiPartsService = d, this._init(), this._initCommandListener(), this._initUIComponents(), this._pasteWithDoc();
  }
  refreshOptionalPaste() {
    this._refreshOptionalPaste$.next(Math.random());
  }
  _pasteWithDoc() {
    var n;
    const e = (i) => {
      i.onPaste$.pipe(takeUntil(this.dispose$)).subscribe((o) => {
        var d, u;
        if (!Ve4(this._contextService))
          return;
        o.event.preventDefault();
        const s = o.event, l = (d = s.clipboardData) == null ? void 0 : d.getData("text/html"), a = (u = s.clipboardData) == null ? void 0 : u.getData("text/plain"), c = this._resolveClipboardFiles(s.clipboardData);
        this._commandService.executeCommand(Xc.id, { htmlContent: l, textContent: a, files: c });
      }), i == null || i.onKeydown$.subscribe((o) => {
        o.event.key === "Escape" && this._sheetClipboardService.removeMarkSelection();
      });
    };
    let t8 = (n = this._renderManagerService.getRenderById(Dl)) == null ? void 0 : n.with(Re2);
    t8 && e(t8), this._renderManagerService.created$.subscribe((i) => {
      var o;
      i.unitId === Dl && (t8 = (o = this._renderManagerService.getRenderById(Dl)) == null ? void 0 : o.with(Re2), t8 && e(t8));
    });
  }
  _resolveClipboardFiles(e) {
    if (!e)
      return;
    const t8 = Array.from(e.items).map((n) => n.kind === "file" ? n.getAsFile() : void 0).filter(Boolean);
    return t8.length > 0 ? t8 : void 0;
  }
  _init() {
    [un5, Yd2, hn4].forEach(
      (t8) => this.disposeWithMe(this._commandService.registerMultipleCommand(t8))
    ), [
      go3,
      mo3,
      ri4,
      fo5,
      Xc,
      _m
    ].forEach((t8) => this.disposeWithMe(this._commandService.registerCommand(t8))), this.disposeWithMe(this._sheetClipboardService.addClipboardHook(this._initCopyingHooks())), this.disposeWithMe(this._sheetClipboardService.addClipboardHook(this._initPastingHook()));
    const e = this._initSpecialPasteHooks().map(
      (t8) => this._sheetClipboardService.addClipboardHook(t8)
    );
    this.disposeWithMe({ dispose: () => e.forEach((t8) => t8.dispose()) });
  }
  // eslint-disable-next-line max-lines-per-function
  _initCopyingHooks() {
    const e = this;
    let t8 = null;
    return {
      id: et3.DEFAULT_COPY,
      isDefaultHook: true,
      onBeforeCopy(n, i) {
        t8 = e._getWorksheet(n, i);
      },
      onCopyCellContent(n, i) {
        var l, a, c, d;
        const o = t8.getCell(n, i);
        return (a = (l = o == null ? void 0 : o.p) == null ? void 0 : l.body) != null && a.paragraphs || (d = (c = o == null ? void 0 : o.p) == null ? void 0 : c.body) != null && d.textRuns ? Wd(o.p) : o ? HE(o) : "";
      },
      onCopyCellStyle: (n, i, o, s) => {
        const l = {};
        (o || s) && (l.rowspan = `${o || 1}`, l.colspan = `${s || 1}`);
        const a = t8.getMergedCell(n, i), c = t8.getComposedCellStyle(n, i);
        let d = "";
        if (c && (d = j1(c)), a) {
          const u = a.endRow, h = a.endColumn, m2 = t8.getRange(u, h).getTextStyle();
          if (m2) {
            const f2 = j1(m2);
            d ? d += f2 ? `;${f2}` : "" : d = f2;
          }
        }
        return d && (l.style = d), Object.keys(l).length ? l : null;
      },
      onCopyColumn(n) {
        return {
          width: `${t8.getColumnWidth(n)}`
        };
      },
      onCopyRow(n) {
        return {
          style: `height: ${t8.getRowHeight(n)}px;`
        };
      },
      onAfterCopy() {
        t8 = null;
      },
      getFilteredOutRows(n) {
        var a;
        const { startRow: i, endRow: o } = n, s = (a = e._instanceService.getCurrentUnitForType(we.UNIVER_SHEET)) == null ? void 0 : a.getActiveSheet(), l = [];
        if (!s)
          return l;
        for (let c = i; c <= o; c++)
          s.getRowFiltered(c) && l.push(c);
        return l;
      }
    };
  }
  // eslint-disable-next-line max-lines-per-function
  _initPastingHook() {
    const e = this;
    let t8 = null, n = null, i = null;
    return {
      id: et3.DEFAULT_PASTE,
      isDefaultHook: true,
      onBeforePaste({ unitId: o, subUnitId: s, range: l }) {
        i = e._getWorksheet(o, s), t8 = o, n = s;
        const a = e._configService.getConfig(pd), c = l.rows[l.rows.length - 1], d = l.cols[l.cols.length - 1];
        return a && c * d > a ? (e._messageService.show({
          type: $C.Error,
          content: e._localService.t("clipboard.paste.exceedMaxCells")
        }), false) : true;
      },
      // eslint-disable-next-line max-lines-per-function
      onPasteRows(o, s) {
        const { range: l } = o, a = [], c = [], d = i.getMaxRows(), u = d - 1, h = l.rows[l.rows.length - 1] - u, g = s.length - h, m2 = i.getRowManager();
        if (h > 0) {
          const p = {};
          s.slice(g).forEach((C, I2) => {
            const { height: R } = C || {};
            R && (p[I2] = {
              h: Number.parseFloat(R),
              hd: ie.FALSE
            });
          });
          const S = {
            startColumn: l.cols[0],
            endColumn: l.cols[l.cols.length - 1],
            endRow: l.rows[l.rows.length - 1],
            startRow: d
          }, w = {
            unitId: t8,
            subUnitId: n,
            range: S,
            rowInfo: p
          };
          a.push({
            id: Ue.id,
            params: w
          }), c.push({
            id: Te.id,
            params: {
              unitId: t8,
              subUnitId: n,
              range: S
            }
          });
        }
        const f2 = {}, v2 = {};
        if (s.slice(0, g).forEach((p, S) => {
          var C, I2;
          const { height: w } = p;
          if (w) {
            const R = m2.getRow(l.rows[0] + S), y = Number.parseFloat(w);
            if (R) {
              const { h: M7 = xE, ah: E = 0 } = R, T = Math.max(M7, E);
              y > T ? (f2[S + l.rows[0]] = y, v2[S + l.rows[0]] = T) : (f2[S + l.rows[0]] = T, v2[S + l.rows[0]] = T);
            } else
              f2[S + l.rows[0]] = y, v2[S + l.rows[0]] = (I2 = (C = m2.getRow(l.rows[0] + S)) == null ? void 0 : C.h) != null ? I2 : xE;
          }
        }), Object.keys(f2).length) {
          const p = {
            unitId: t8,
            subUnitId: n,
            ranges: [{
              startRow: l.rows[0],
              endRow: Math.min(l.rows[l.rows.length - 1], d),
              startColumn: l.cols[0],
              endColumn: l.cols[l.cols.length - 1]
            }],
            rowHeight: f2
          };
          a.push({
            id: nt.id,
            params: p
          }), c.push({
            id: nt.id,
            params: {
              ...p,
              rowHeight: v2
            }
          });
        }
        return {
          redos: a,
          undos: c
        };
      },
      // eslint-disable-next-line max-lines-per-function
      onPasteColumns(o, s, l) {
        var w;
        const { range: a } = o, c = [], d = [], u = i.getMaxColumns(), h = u - 1, g = a.cols[a.cols.length - 1] - h, m2 = s.length - g, f2 = (w = e._configService.getConfig(YR)) != null ? w : DE, v2 = a.cols, p = v2[0];
        if (g > 0) {
          const C = {
            startRow: a.rows[0],
            endRow: a.rows[a.rows.length - 1],
            endColumn: a.cols[a.cols.length - 1],
            startColumn: u
          }, I2 = {
            unitId: t8,
            subUnitId: n,
            range: C,
            colInfo: s.slice(m2).map((R, y) => ({
              w: R.width ? Math.max(+R.width, i.getColumnWidth(v2[y])) : f2,
              hd: ie.FALSE
            }))
          };
          c.push({
            id: ke2.id,
            params: I2
          }), d.push({
            id: Me.id,
            params: {
              unitId: t8,
              subUnitId: n,
              range: C
            }
          });
        }
        const S = {
          unitId: t8,
          subUnitId: n,
          ranges: [{
            startRow: a.rows[0],
            endRow: a.rows[a.rows.length - 1],
            startColumn: a.cols[0],
            endColumn: Math.min(a.cols[a.cols.length - 1], u)
          }]
        };
        if (s.length > 0) {
          const C = {
            ...S,
            colWidth: s.slice(0, m2).reduce((R, y, M7) => {
              var E;
              return R[M7 + p] = y.width ? Math.max(+y.width, (E = i.getColumnWidth(v2[M7])) != null ? E : f2) : f2, R;
            }, {})
          }, I2 = {
            ...S,
            colWidth: s.slice(0, m2).reduce((R, y, M7) => {
              var E;
              return R[M7 + p] = (E = i.getColumnWidth(v2[M7])) != null ? E : f2, R;
            }, {})
          };
          c.push({
            id: mt.id,
            params: C
          }), d.push({
            id: mt.id,
            params: I2
          });
        }
        return {
          redos: c,
          undos: d
        };
      },
      onPastePlainText(o, s, l) {
        return e._onPastePlainText(o, s, l);
      },
      onPasteCells(o, s, l, a) {
        return e._onPasteCells(o, s, l, a);
      },
      onAfterPaste(o) {
        i = null;
      }
    };
  }
  _generateDocumentDataModelSnapshot(e) {
    var l, a;
    const t8 = (l = eA(
      we.UNIVER_SHEET,
      ue,
      this._instanceService,
      this._renderManagerService
    )) == null ? void 0 : l.getCurrentParam();
    if (t8 == null)
      return null;
    const { skeleton: n } = t8, i = (a = n.getBlankCellDocumentModel()) == null ? void 0 : a.documentModel, s = { ...i == null ? void 0 : i.getSnapshot(), ...e };
    return i == null || i.reset(s), i == null ? void 0 : i.getSnapshot();
  }
  _onPastePlainText(e, t8, n) {
    const { range: i, unitId: o, subUnitId: s } = e;
    let l;
    if (/\r|\n/.test(t8) || J.isLegalUrl(t8)) {
      const c = VR(t8), d = this._generateDocumentDataModelSnapshot({ body: c });
      l = {
        [i.rows[0]]: {
          [i.cols[0]]: {
            p: d,
            v: null,
            f: null
          }
        }
      };
    } else if (Gg(t8))
      l = {
        [i.rows[0]]: {
          [i.cols[0]]: {
            f: t8,
            v: null,
            p: null
          }
        }
      };
    else {
      const c = eR.parseNumber(t8);
      c != null && c.z ? l = {
        [i.rows[0]]: {
          [i.cols[0]]: {
            v: c.v,
            s: {
              n: {
                pattern: c.z
              }
            },
            f: null
          }
        }
      } : l = {
        [i.rows[0]]: {
          [i.cols[0]]: {
            v: t8,
            f: null
          }
        }
      };
    }
    const a = {
      unitId: o,
      subUnitId: s,
      cellValue: l
    };
    return {
      redos: [
        {
          id: ee.id,
          params: a
        }
      ],
      undos: [
        {
          id: ee.id,
          params: Ae(this._injector, a)
        }
      ]
    };
  }
  _onPasteCells(e, t8, n, i) {
    return this._injector.invoke((o) => OR(e, t8, n, i, o));
  }
  // eslint-disable-next-line max-lines-per-function
  _initSpecialPasteHooks() {
    const e = this, t8 = {
      id: et3.SPECIAL_PASTE_VALUE,
      specialPasteInfo: {
        label: "specialPaste.value"
      },
      onPasteCells: (s, l, a) => this._injector.invoke((c) => wp(l, s, a, c))
    }, n = {
      id: et3.SPECIAL_PASTE_FORMAT,
      specialPasteInfo: {
        label: "specialPaste.format"
      },
      onPasteCells: (s, l, a) => {
        const c = [], d = [], { undos: u, redos: h } = this._injector.invoke((p) => _p(l, a, p));
        c.push(...h), d.push(...u);
        const { undos: g, redos: m2 } = this._injector.invoke((p) => Kc2(
          l,
          a,
          p
        ));
        c.push(...m2), d.push(...g);
        const { undos: f2, redos: v2 } = this._injector.invoke((p) => bp(
          l,
          s,
          a,
          p
        ));
        return c.push(...v2), d.push(...f2), {
          undos: d,
          redos: c
        };
      }
    }, i = {
      id: et3.SPECIAL_PASTE_COL_WIDTH,
      specialPasteInfo: {
        label: "specialPaste.colWidth"
      },
      onPasteCells() {
        return {
          undos: [],
          redos: []
        };
      },
      onPasteColumns(s, l, a) {
        var M7, E;
        const c = e._instanceService.getCurrentUnitForType(we.UNIVER_SHEET), d = c.getUnitId(), u = (M7 = c.getActiveSheet()) == null ? void 0 : M7.getSheetId();
        if (!d || !u)
          throw new Error("Cannot find unitId or subUnitId");
        const h = [], g = [], m2 = e._getWorksheet(d, u), { range: f2 } = s, v2 = f2.cols, p = v2[0], S = m2.getMaxColumns(), w = f2.cols[f2.cols.length - 1] - S, C = l.length - w, I2 = (E = e._configService.getConfig(YR)) != null ? E : DE, R = {
          unitId: d,
          subUnitId: u,
          ranges: [{
            startRow: f2.rows[0],
            endRow: Math.min(f2.cols[f2.cols.length - 1], S),
            startColumn: f2.cols[0],
            endColumn: f2.cols[f2.cols.length - 1]
          }],
          colWidth: l.slice(0, C).reduce((T, P2, H3) => {
            var A;
            return T[H3 + p] = P2.width ? Math.max(+P2.width, (A = m2.getColumnWidth(v2[H3])) != null ? A : I2) : I2, T;
          }, {})
        }, y = {
          unitId: d,
          subUnitId: u,
          ranges: [{
            startRow: f2.rows[0],
            endRow: Math.min(f2.cols[f2.cols.length - 1], S),
            startColumn: f2.cols[0],
            endColumn: f2.cols[f2.cols.length - 1]
          }],
          colWidth: l.slice(0, C).reduce((T, P2, H3) => {
            var A;
            return T[H3 + p] = (A = m2.getColumnWidth(v2[H3])) != null ? A : I2, T;
          }, {})
        };
        return h.push({
          id: mt.id,
          params: R
        }), g.push({
          id: mt.id,
          params: y
        }), {
          redos: h,
          undos: g
        };
      }
    }, o = {
      id: et3.SPECIAL_PASTE_BESIDES_BORDER,
      specialPasteInfo: {
        label: "specialPaste.besidesBorder"
      },
      onPasteCells: (s, l, a, c) => {
        e._instanceService.getCurrentUnitForType(we.UNIVER_SHEET);
        const d = [], u = [], { range: h, unitId: g, subUnitId: m2 } = l, f2 = new pt();
        a.forValue((C, I2, R) => {
          const y = R.s;
          if (typeof y == "object") {
            const M7 = J.deepClone(R);
            M7.s && (M7.s = {
              ...y,
              bd: null
            }), f2.setValue(h.rows[C], h.cols[I2], M7);
          }
        });
        const v2 = {
          unitId: g,
          subUnitId: m2,
          cellValue: f2.getData()
        };
        d.push({
          id: ee.id,
          params: v2
        });
        const p = this._injector.invoke(
          Ae,
          v2
        );
        u.push({
          id: ee.id,
          params: p
        });
        const { undos: S, redos: w } = this._injector.invoke((C) => Kc2(l, a, C));
        return u.push(...S), d.push(...w), {
          redos: d,
          undos: u
        };
      }
    };
    return [t8, n, i, o];
  }
  _getWorksheet(e, t8) {
    var i;
    const n = (i = this._instanceService.getUniverSheetInstance(e)) == null ? void 0 : i.getSheetBySheetId(t8);
    if (!n)
      throw new Error(
        `[SheetClipboardController]: cannot find a worksheet with unitId ${e} and subUnitId ${t8}.`
      );
    return n;
  }
  _initCommandListener() {
    var t8;
    this.disposeWithMe(
      this._commandService.onCommandExecuted((n) => {
        n.id === sr5.id ? this._sheetClipboardService.removeMarkSelection() : DR2.includes(n.id) && this._sheetClipboardService.removeMarkSelection();
      })
    );
    const e = this._configService.getConfig(Tt3);
    (t8 = e == null ? void 0 : e.clipboardConfig) != null && t8.hidePasteOptions || (this.disposeWithMe(
      this._commandService.onCommandExecuted((n) => {
        xR2.includes(n.id) && this._sheetClipboardService.disposePasteOptionsCache();
      })
    ), this.disposeWithMe(
      this._commandService.onCommandExecuted((n) => {
        if (n.id === gn2.id) {
          if (!this._sheetClipboardService.getPasteMenuVisible())
            return;
          const o = n.params.unitId, s = this._sheetClipboardService.getPasteOptionsCache(), l = s == null ? void 0 : s.target.unitId;
          o === l && this._refreshOptionalPaste$.next(Math.random());
        }
      })
    ));
  }
  _initUIComponents() {
    var t8;
    const e = this._configService.getConfig(Tt3);
    (t8 = e == null ? void 0 : e.clipboardConfig) != null && t8.hidePasteOptions || this.disposeWithMe(
      this._uiPartsService.registerComponent(c12.CONTENT, () => connectInjector(PR2, this._injector))
    );
  }
};
Tr2 = kR([
  rn3(0, Inject(Injector)),
  rn3(1, vr),
  rn3(2, ME),
  rn3(3, Ls),
  rn3(4, Nr),
  rn3(5, ic),
  rn3(6, nn2),
  rn3(7, et2),
  rn3(8, Inject(Fn)),
  rn3(9, D1)
], Tr2);
var LR2 = Object.getOwnPropertyDescriptor;
var WR = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? LR2(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var $i = (r, e) => (t8, n) => e(t8, n, r);
var Pi3 = class extends Ve {
  constructor(r, e, t8, n, i) {
    super(), this._selectionManagerService = r, this._themeService = e, this._instanceSrv = t8, this._cmdSrv = n, this._definedNamesService = i, this._init();
  }
  _init() {
    this.disposeWithMe(merge(
      this._selectionManagerService.selectionMoveStart$,
      this._selectionManagerService.selectionMoving$,
      this._selectionManagerService.selectionMoveEnd$,
      this._selectionManagerService.selectionSet$
    ).pipe(filter((r) => !!r)).subscribe((r) => {
      this._syncDefinedNameRange(r);
    })), this.disposeWithMe(this._definedNamesService.focusRange$.subscribe(async (r) => {
      if (r == null) return;
      const { unitId: e } = r;
      let { formulaOrRefString: t8 } = r;
      if (t8.substring(0, 1) === X.EQUALS && (t8 = t8.substring(1)), !Wc(t8))
        return;
      const i = this._instanceSrv.getUnit(e), o = await this._getSelections(i, e, t8);
      this._selectionManagerService.setSelections(o), this._cmdSrv.executeCommand(Cd.id, {
        unitId: e,
        range: o[0].range
      });
    }));
  }
  _syncDefinedNameRange(r) {
    if (r.length === 0)
      return;
    const e = r[r.length - 1], t8 = this._instanceSrv.getCurrentUnitForType(we.UNIVER_SHEET), n = t8 == null ? void 0 : t8.getActiveSheet();
    n && this._definedNamesService.setCurrentRange({
      range: e.range,
      unitId: t8.getUnitId(),
      sheetId: n.getSheetId()
    });
  }
  async _getSelections(r, e, t8) {
    const n = t8.split(",");
    let i = r.getActiveSheet();
    if (!i)
      return [];
    const o = [];
    for (let s = 0; s < n.length; s++) {
      const l = n[s].trim(), a = Dr(l.trim());
      if (s === 0) {
        const d = r.getSheetBySheetName(a.sheetName);
        d && i.getSheetId() !== d.getSheetId() && (i = d, await this._cmdSrv.executeCommand(ri.id, {
          subUnitId: i.getSheetId(),
          unitId: e
        }));
      }
      if (i.getName() !== a.sheetName)
        continue;
      let c = null;
      if (s === n.length - 1) {
        const d = a.range, { startRow: u, startColumn: h, endRow: g, endColumn: m2 } = d;
        c = _e({
          startRow: u,
          startColumn: h,
          endRow: g,
          endColumn: m2
        }, i);
      }
      o.push({
        range: a.range,
        style: Sr2(this._themeService),
        primary: c
      });
    }
    return o;
  }
};
Pi3 = WR([
  $i(0, Inject(z)),
  $i(1, Inject(Gi)),
  $i(2, vr),
  $i(3, Ls),
  $i(4, Nr2)
], Pi3);
var BR = Object.getOwnPropertyDescriptor;
var FR = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? BR(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var Xn3 = (r, e) => (t8, n) => e(t8, n, r);
var UR = {
  pageSize: {
    width: Number.POSITIVE_INFINITY,
    height: Number.POSITIVE_INFINITY
  },
  documentFlavor: uu.UNSPECIFIED,
  marginTop: 5,
  marginBottom: 5,
  marginRight: 0,
  marginLeft: 0,
  paragraphLineGapDefault: 0,
  renderConfig: {
    horizontalAlign: Ut.UNSPECIFIED,
    verticalAlign: xn.TOP,
    centerAngle: 0,
    vertexAngle: 0,
    wrapStrategy: Bn.WRAP,
    isRenderStyle: ie.FALSE
  }
};
var xi2 = class extends Ve {
  constructor(r, e, t8, n, i, o, s, l) {
    super(), this._univerInstanceService = r, this._renderManagerService = e, this._editorBridgeService = t8, this._commandService = n, this._rangeProtectionRuleModel = i, this._worksheetProtectionRuleModel = o, this._formulaEditorController = s, this._formulaEditorManagerService = l, this._initialize();
  }
  _initialize() {
    this._syncFormulaEditorContent(), this._commandExecutedListener();
  }
  _getEditorViewModel(r) {
    var e;
    return (e = this._renderManagerService.getRenderById(r)) == null ? void 0 : e.with(D).getViewModel();
  }
  // Sync cell content to formula editor bar when sheet selection changed.
  _syncFormulaEditorContent() {
    this.disposeWithMe(this._editorBridgeService.currentEditCellState$.subscribe((r) => {
      r == null || this._editorBridgeService.isForceKeepVisible() || !this._rangeProtectionRuleModel.getRangeRuleInitState() || !this._worksheetProtectionRuleModel.getSheetRuleInitState() || this._editorSyncHandler(r);
    }));
  }
  // Sync cell content to formula editor bar when sheet selection changed or visible changed.
  _editorSyncHandler(r) {
    var i, o, s;
    let e = J.deepClone((i = r.documentLayoutObject.documentModel) == null ? void 0 : i.getBody());
    const t8 = J.deepClone((o = r.documentLayoutObject.documentModel) == null ? void 0 : o.drawings), n = J.deepClone((s = r.documentLayoutObject.documentModel) == null ? void 0 : s.getDrawingsOrder());
    (!e || r.isInArrayFormulaRange === true && this._editorBridgeService.isVisible().eventType === Kv.Dblclick) && (e = {
      dataStream: `\r
`,
      paragraphs: [
        {
          startIndex: 0
        }
      ],
      textRuns: []
    }), this._syncContentAndRender(Ul, e, t8, n);
  }
  _commandExecutedListener() {
    const r = [Dl, Ul];
    this.disposeWithMe(
      this._commandService.onCommandExecuted((t8) => {
        if (t8.id === M.id) {
          const n = t8.params, { unitId: i, trigger: o, isSync: s } = n;
          if (s || o === _a.id)
            return;
          if (r.includes(i)) {
            const l = this._univerInstanceService.getUnit(i, we.UNIVER_DOC), a = i === Ul ? Dl : Ul;
            this._checkAndSetRenderStyleConfig(l), this._syncActionsAndRender(a, n);
          }
        }
      })
    );
    const e = [ee.id, It.id];
    this.disposeWithMe(
      this._commandService.onCommandExecuted((t8) => {
        var n, i, o, s, l, a, c;
        if (e.includes(t8.id)) {
          const d = this._editorBridgeService.getLatestEditCellState();
          if (d == null)
            return;
          let u = false;
          const { row: h, column: g } = d;
          if (t8.id === ee.id && t8.params ? (i = (n = t8.params.cellValue) == null ? void 0 : n[h]) != null && i[g] && (u = true) : t8.id === It.id && t8.params && (s = (o = t8.params.to.value) == null ? void 0 : o[h]) != null && s[g] && (u = true), u) {
            const m2 = J.deepClone((l = d.documentLayoutObject.documentModel) == null ? void 0 : l.getBody()), f2 = J.deepClone((a = d.documentLayoutObject.documentModel) == null ? void 0 : a.drawings), v2 = J.deepClone((c = d.documentLayoutObject.documentModel) == null ? void 0 : c.getDrawingsOrder());
            if (m2 == null)
              return;
            this._syncContentAndRender(Ul, m2, f2, v2);
          }
        }
      })
    );
  }
  // Sync actions between cell editor and formula editor, and make `dataStream` and `paragraph` is the same.
  _syncActionsAndRender(r, e) {
    var l;
    const t8 = [Dl, Ul], n = this._renderManagerService.getRenderById(r);
    if (n == null)
      return;
    const i = n.with(D).getSkeleton(), o = this._univerInstanceService.getUnit(r, we.UNIVER_DOC), s = this._getEditorViewModel(r);
    o == null || s == null || (this._commandService.syncExecuteCommand(M.id, {
      ...e,
      textRanges: null,
      isSync: true,
      unitId: r,
      syncer: e.unitId
    }), s.reset(o), i.calculate(), t8.includes(r) && ((l = n.mainComponent) == null || l.makeDirty()));
  }
  _syncContentAndRender(r, e, t8, n) {
    var c, d;
    r === Ul && e.paragraphs && (e.paragraphs = this._clearParagraph(e.paragraphs));
    const i = [Dl, Ul], o = (c = this._renderManagerService.getRenderById(r)) == null ? void 0 : c.with(D).getSkeleton(), s = this._univerInstanceService.getUnit(r, we.UNIVER_DOC), l = this._getEditorViewModel(r);
    if (s == null || l == null || o == null)
      return;
    s.getSnapshot().body = e, s.getSnapshot().drawings = t8 != null ? t8 : {}, s.getSnapshot().drawingsOrder = n != null ? n : [], this._checkAndSetRenderStyleConfig(s), l.reset(s);
    const a = this._renderManagerService.getRenderById(r);
    a != null && (o.calculate(), i.includes(r) && ((d = a.mainComponent) == null || d.makeDirty()), r === Ul && this._formulaEditorController.autoScroll());
  }
  _checkAndSetRenderStyleConfig(r) {
    var o;
    const e = r.getSnapshot(), { body: t8 } = e;
    if (e.id !== Ul)
      return;
    e.documentStyle = UR;
    let n = e.documentStyle.renderConfig;
    n == null && (n = {}, e.documentStyle.renderConfig = n);
    const i = this._formulaEditorManagerService.getPosition();
    if (i) {
      const s = i.width;
      e.documentStyle.pageSize = {
        width: s,
        height: 1 / 0
      };
    }
    ((o = t8 == null ? void 0 : t8.dataStream) != null ? o : "").startsWith("=") ? n.isRenderStyle = ie.TRUE : n.isRenderStyle = ie.FALSE;
  }
  _clearParagraph(r) {
    const e = J.deepClone(r);
    for (const t8 of e)
      t8.paragraphStyle && (t8.paragraphStyle.horizontalAlign = Ut.UNSPECIFIED);
    return e;
  }
};
xi2 = FR([
  Xn3(0, vr),
  Xn3(1, ME),
  Xn3(2, qe5),
  Xn3(3, Ls),
  Xn3(4, Inject(me)),
  Xn3(5, Inject(lt)),
  Xn3(6, Inject(yr3)),
  Xn3(7, as2)
], xi2);
var XR2 = Object.getOwnPropertyDescriptor;
var zR = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? XR2(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var eo3 = (r, e) => (t8, n) => e(t8, n, r);
var mc2 = "SHEET_FORCE_STRING_ALERT";
var Sl = class extends Ve {
  constructor(r, e, t8, n, i, o) {
    super(), this._context = r, this._hoverManagerService = e, this._cellAlertManagerService = t8, this._localeService = n, this._zenZoneService = i, this._configService = o, this._init();
  }
  _init() {
    this._initCellAlertPopup(), this._initZenService();
  }
  _initCellAlertPopup() {
    this.disposeWithMe(this._hoverManagerService.currentCell$.subscribe((r) => {
      var e, t8;
      if (r) {
        const n = r.location, i = this._context.unit, o = i.getActiveSheet();
        if (!o) return this._hideAlert();
        const s = o.getCell(n.row, n.col);
        if (!s || s.v === null || s.v === void 0) return this._hideAlert();
        let l;
        if (s != null && s.s) {
          const a = i.getStyles().get(s.s);
          a != null && a.n && (l = a.n);
        }
        if (tR(l == null ? void 0 : l.pattern)) {
          this._hideAlert();
          return;
        }
        if ((s.t === fn.FORCE_STRING || s.t === fn.STRING) && (Z1(s.v) || typeof s.v == "string" && eR.parseNumber(s.v))) {
          if ((e = this._configService.getConfig(Tt3)) != null && e.disableForceStringAlert)
            return;
          const a = this._cellAlertManagerService.currentAlert.get(mc2), c = (t8 = a == null ? void 0 : a.alert) == null ? void 0 : t8.location;
          if (c && c.row === r.location.row && c.col === r.location.col && c.subUnitId === r.location.subUnitId && c.unitId === r.location.unitId) {
            this._hideAlert();
            return;
          }
          this._cellAlertManagerService.showAlert({
            type: po3.ERROR,
            title: this._localeService.t("info.error"),
            message: this._localeService.t("info.forceStringInfo"),
            location: n,
            width: 200,
            height: 74,
            key: mc2
          });
          return;
        }
      }
      this._hideAlert();
    }));
  }
  _initZenService() {
    this.disposeWithMe(this._zenZoneService.visible$.subscribe((r) => {
      r && this._hideAlert();
    }));
  }
  _hideAlert() {
    this._cellAlertManagerService.removeAlert(mc2);
  }
};
Sl = zR([
  eo3(1, Inject(Mr3)),
  eo3(2, Inject(Do3)),
  eo3(3, Inject(Fn)),
  eo3(4, st2),
  eo3(5, ic)
], Sl);
var jR = Object.getOwnPropertyDescriptor;
var YR2 = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? jR(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var fc3 = (r, e) => (t8, n) => e(t8, n, r);
var Cl = class extends h1 {
  constructor(r, e, t8, n) {
    super(), this._context = r, this._sheetSkeletonManagerService = e, this._sheetInterceptorService = t8, this._configService = n, this._initViewModelIntercept();
  }
  _initViewModelIntercept() {
    const r = {
      tl: {
        size: 6,
        color: "#409f11"
      }
    };
    this.disposeWithMe(
      this._sheetInterceptorService.intercept(
        ht.CELL_CONTENT,
        {
          priority: 10,
          effect: sr.Style,
          handler: (e, t8, n) => {
            var s, l, a;
            if (!((s = this._sheetSkeletonManagerService.getCurrentParam()) == null ? void 0 : s.skeleton))
              return n(e);
            const o = t8.rawData;
            if (!o || o.v === null || o.v === void 0)
              return n(e);
            if (((e == null ? void 0 : e.t) === fn.FORCE_STRING || (e == null ? void 0 : e.t) === fn.STRING) && (Z1(o.v) || typeof o.v == "string" && eR.parseNumber(o.v))) {
              const c = t8.workbook.getStyles().get(o.s);
              return tR((l = c == null ? void 0 : c.n) == null ? void 0 : l.pattern) || (a = this._configService.getConfig(Tt3)) != null && a.disableForceStringMark || (e === o && (e = { ...o }), e.markers = { ...e == null ? void 0 : e.markers, ...r }), n(e);
            }
            return n(e);
          }
        }
      )
    );
  }
};
Cl = YR2([
  fc3(1, Inject(ue)),
  fc3(2, Inject(G)),
  fc3(3, ic)
], Cl);
var ZR2 = Object.getOwnPropertyDescriptor;
var GR = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? ZR2(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var hr2 = (r, e) => (t8, n) => e(t8, n, r);
var Oi2 = class extends Ve {
  constructor(r, e, t8, n, i, o, s) {
    super(), this._commandService = r, this._formatPainterService = e, this._univerInstanceService = t8, this._renderManagerService = n, this._selectionManagerService = i, this._sheetInterceptorService = o, this._injector = s, this._initialize();
  }
  _initialize() {
    this._addDefaultHook();
  }
  _addDefaultHook() {
    const r = {
      id: "default-format-painter",
      priority: 0,
      isDefaultHook: true,
      onStatusChange: (e) => {
        if (e !== zt4.OFF) {
          const t8 = this._collectSelectionRangeFormat();
          t8 && this._formatPainterService.setSelectionFormat(t8);
        }
      },
      onApply: (e, t8, n, i) => this._getUndoRedoMutationInfo(e, t8, n, i)
    };
    this._formatPainterService.addHook(r);
  }
  _collectSelectionRangeFormat() {
    const r = this._selectionManagerService.getCurrentLastSelection(), e = r == null ? void 0 : r.range;
    if (!e) return null;
    const { startRow: t8, endRow: n, startColumn: i, endColumn: o } = e, s = this._univerInstanceService.getCurrentUnitForType(we.UNIVER_SHEET), l = s == null ? void 0 : s.getActiveSheet();
    if (!l) return null;
    const a = l.getCellMatrix(), c = s.getStyles(), d = new pt(), u = [];
    for (let h = t8; h <= n; h++)
      for (let g = i; g <= o; g++) {
        const m2 = a.getValue(h, g);
        d.setValue(h, g, c.getStyleByCell(m2) || {});
        const { isMergedMainCell: f2, ...v2 } = l.getCellInfoInMergeData(h, g);
        f2 && u.push({
          startRow: v2.startRow,
          startColumn: v2.startColumn,
          endRow: v2.endRow,
          endColumn: v2.endColumn
        });
      }
    return {
      styles: d,
      merges: u
    };
  }
  // eslint-disable-next-line max-lines-per-function
  _getUndoRedoMutationInfo(r, e, t8, n) {
    const i = this._sheetInterceptorService, o = this._univerInstanceService, { merges: s, styles: l } = n;
    if (!l) return { undos: [], redos: [] };
    const { startRow: a, startColumn: c, endRow: d, endColumn: u } = l.getDataRange(), h = d - a + 1, g = u - c + 1, m2 = t8.startRow === t8.endRow && t8.startColumn === t8.endColumn ? {
      startRow: t8.startRow,
      startColumn: t8.startColumn,
      endRow: t8.startRow + h - 1,
      endColumn: t8.startColumn + g - 1
    } : t8, f2 = Array.from({ length: m2.endRow - m2.startRow + 1 }, () => Array.from({ length: m2.endColumn - m2.startColumn + 1 }, () => ({}))), v2 = [];
    f2.forEach((A, x7) => {
      A.forEach((V2, D2) => {
        const X2 = x7 % h + a, B = D2 % g + c, j = l.getValue(X2, B);
        j && (f2[x7][D2].s = Object.keys(j).length > 0 ? j : null);
      });
    });
    let p = 0, S = 0;
    s.forEach((A) => {
      A.startRow === a && A.startColumn === c && (p = A.endRow - A.startRow, S = A.endColumn - A.startColumn);
      const x7 = {
        startRow: A.startRow - a,
        startColumn: A.startColumn - c,
        endRow: A.endRow - a,
        endColumn: A.endColumn - c
      }, V2 = Math.max(1, Math.floor((m2.endRow - m2.startRow + 1) / h)), D2 = Math.max(1, Math.floor((m2.endColumn - m2.startColumn + 1) / g));
      for (let X2 = 0; X2 < V2; X2++)
        for (let B = 0; B < D2; B++)
          v2.push({
            startRow: x7.startRow + X2 * h + m2.startRow,
            startColumn: x7.startColumn + B * g + m2.startColumn,
            endRow: x7.endRow + X2 * h + m2.startRow,
            endColumn: x7.endColumn + B * g + m2.startColumn
          });
    });
    const w = [m2], C = new pt(), I2 = new pt();
    if (J.isArray(f2))
      for (let A = 0; A < w.length; A++) {
        const { startRow: x7, startColumn: V2, endRow: D2, endColumn: X2 } = w[A];
        for (let B = 0; B <= D2 - x7; B++)
          for (let j = 0; j <= X2 - V2; j++)
            C.setValue(B + x7, j + V2, { s: null }), I2.setValue(B + x7, j + V2, f2[B][j]);
      }
    const R = {
      subUnitId: e,
      unitId: r,
      cellValue: C.getMatrix()
    }, y = {
      subUnitId: e,
      unitId: r,
      cellValue: I2.getMatrix()
    }, M7 = this._injector.invoke(
      Ae,
      R
    ), { undos: E, redos: T } = i.onCommandExecute({
      id: Sn.id,
      params: { ...y, range: w }
    }), P2 = [], H3 = [];
    if (v2.length > 0) {
      const A = zr(v2), x7 = o.getUnit(r).getSheetBySheetId(e), V2 = km(x7, A), D2 = {
        unitId: r,
        subUnitId: e,
        ranges: A
      }, X2 = {
        unitId: r,
        subUnitId: e,
        ranges: A
      };
      P2.push({ id: se2.id, params: D2 }), P2.push({ id: ne.id, params: X2 });
      const B = this._injector.invoke(
        ye2,
        D2
      ), j = this._injector.invoke(
        We2,
        X2
      );
      if (H3.push({ id: se2.id, params: j }), H3.push({ id: ne.id, params: B }), V2) {
        const G7 = this._injector.invoke((ge2) => Dm(ge2, r, x7, A));
        P2.unshift(...G7.redos), H3.push(...G7.undos);
      }
    }
    if (!En.equals(m2, t8)) {
      const A = {
        actualRow: m2.startRow,
        actualColumn: m2.startColumn,
        rangeType: ge.NORMAL,
        isMerged: p > 0 || S > 0,
        isMergedMainCell: false,
        startRow: m2.startRow,
        startColumn: m2.startColumn,
        endRow: m2.startRow + p,
        endColumn: m2.startColumn + S
      };
      P2.push({
        id: ie3.id,
        params: {
          unitId: r,
          subUnitId: e,
          type: we2.ONLY_SET,
          selections: [{ range: m2, primary: A, style: null }]
        }
      }), H3.unshift({
        id: ie3.id,
        params: {
          unitId: r,
          subUnitId: e,
          type: we2.ONLY_SET,
          selections: [{ range: t8, primary: A, style: null }]
        }
      });
    }
    return {
      undos: [
        { id: ee.id, params: R },
        { id: ee.id, params: M7 },
        ...E,
        ...H3
      ],
      redos: [
        { id: ee.id, params: R },
        { id: ee.id, params: y },
        ...T,
        ...P2
      ]
    };
  }
};
Oi2 = GR([
  hr2(0, Ls),
  hr2(1, Dn2),
  hr2(2, vr),
  hr2(3, ME),
  hr2(4, Inject(z)),
  hr2(5, Inject(G)),
  hr2(6, Inject(Injector))
], Oi2);
var qR2 = Object.getOwnPropertyDescriptor;
var QR = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? qR2(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var pc3 = (r, e) => (t8, n) => e(t8, n, r);
var wl = class extends Ve {
  constructor(r, e, t8, n) {
    super(), this._context = r, this._markSelectionService = e, this._commandService = t8, this._sheetSkeletonManagerService = n, this._initListeners();
  }
  _initListeners() {
    this._addRemoveListener(), this._addRefreshListener();
  }
  _addRemoveListener() {
    const r = [tt3.id];
    this.disposeWithMe(
      this._commandService.onCommandExecuted((e) => {
        r.includes(e.id) ? this._markSelectionService.removeAllShapes() : this._markSelectionService.getShapeMap().forEach((n, i) => {
          n.exits.includes(e.id) && this._markSelectionService.removeShape(i);
        });
      })
    );
  }
  _addRefreshListener() {
    this.disposeWithMe(this._sheetSkeletonManagerService.currentSkeleton$.subscribe((r) => {
      r && this._markSelectionService.refreshShapes();
    }));
  }
};
wl = QR([
  pc3(1, Inject(Wi3)),
  pc3(2, Ls),
  pc3(3, Inject(ue))
], wl);
function KR() {
  const r = kr();
  return r ? (0, import_jsx_runtime4.jsx)(JR, { workbook: r }) : null;
}
function JR(r) {
  const { workbook: e } = r, [t8, n] = (0, import_react4.useState)([]), [i, o] = (0, import_react4.useState)(""), s = (0, import_react4.useRef)(/* @__PURE__ */ new Map()), l = useDependency(Ls), a = (0, import_react4.useCallback)(() => {
    const d = e.getActiveSheet().getSheetId(), u = e.getSheets(), h = e.getActiveSheet(), g = u.filter((m2) => !m2.isSheetHidden()).map((m2, f2) => {
      var v2;
      return {
        sheetId: m2.getSheetId(),
        label: m2.getName(),
        index: f2,
        selected: h === m2,
        color: (v2 = m2.getTabColor()) != null ? v2 : void 0
      };
    });
    if (n(g), o(d), s.current.has(d)) {
      const m2 = s.current.get(d);
      m2 && m2.scrollIntoView({ behavior: "smooth", block: "nearest" });
    }
    s.current.clear();
  }, [e]);
  (0, import_react4.useEffect)(() => a(), [a]);
  const c = (0, import_react4.useCallback)((d) => {
    l.executeCommand(pn2.id, {
      unitId: e.getUnitId(),
      subUnitId: d
    });
  }, [l, e]);
  return (0, import_react4.useEffect)(() => {
    const d = l.onCommandExecuted((u) => {
      switch (u.id) {
        case wt.id:
        case Ht.id:
        case jn.id:
        case hn.id:
        case Tn2.id:
        case pn2.id:
          a();
          break;
      }
    });
    return () => d.dispose();
  }, [l, a]), (0, import_jsx_runtime4.jsx)(
    "div",
    {
      className: "univer-h-8 univer-w-full univer-overflow-x-scroll univer-bg-gray-100 dark:!univer-bg-gray-900",
      children: (0, import_jsx_runtime4.jsx)("div", { className: "univer-flex univer-h-8 univer-flex-nowrap univer-items-center", children: t8.map((d) => (0, import_jsx_runtime4.jsx)(
        "div",
        {
          ref: (u) => {
            s.current.set(d.sheetId, u);
          },
          className: ie2(
            `
                              univer-box-border univer-h-full univer-min-w-12 univer-max-w-[120px] univer-shrink-0
                              univer-flex-nowrap univer-items-center univer-truncate univer-px-1 univer-py-0.5
                              univer-text-center univer-text-xs univer-leading-7
                            `,
            tE,
            {
              "univer-bg-white univer-text-primary-600 dark:!univer-bg-slate-600": d.sheetId === i
            }
          ),
          onClick: () => c(d.sheetId),
          children: d.label
        },
        d.sheetId
      )) })
    }
  );
}
var $R = {
  [Y1.MAIN_AREA]: {
    [a12.FORMAT]: {
      [un5.name]: {
        order: 0,
        menuItemFactory: ci3
      }
    },
    [a12.DATA]: {
      order: 2
    },
    [a12.OTHERS]: {
      order: 3
    }
  },
  [Y1.COL_HEADER]: {
    [a12.FORMAT]: {
      [un5.name]: {
        order: 0,
        menuItemFactory: ci3
      }
    },
    [a12.LAYOUT]: {
      order: 1
    },
    [a12.DATA]: {
      order: 2
    },
    [a12.OTHERS]: {
      order: 3
    }
  },
  [Y1.ROW_HEADER]: {
    [a12.FORMAT]: {
      [un5.name]: {
        order: 0,
        menuItemFactory: ci3
      }
    },
    [a12.LAYOUT]: {
      order: 1
    },
    [a12.DATA]: {
      order: 2
    },
    [a12.OTHERS]: {
      order: 3
    }
  }
};
var eI = Object.getOwnPropertyDescriptor;
var tI = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? eI(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var zn4 = (r, e) => (t8, n) => e(t8, n, r);
var bl = class extends Ve {
  constructor(r, e, t8, n, i, o, s, l) {
    super(), this._injector = r, this._componentManager = e, this._layoutService = t8, this._commandService = n, this._shortcutService = i, this._menuManagerService = o, this._uiPartsService = s, this._configService = l, this._init();
  }
  _init() {
    this._initComponents(), this._initCommands(), this._initMenus(), this._initShortcuts(), this._initWorkbenchParts(), this._initFocusHandler();
  }
  _initComponents() {
    const r = this._componentManager;
    this.disposeWithMe(r.register(Sn3, yf2)), this.disposeWithMe(r.register(au2, Hf)), this.disposeWithMe(r.register(xo2, Nf)), this.disposeWithMe(r.register(hu2, Vf)), this.disposeWithMe(r.register("HideGridlinesDoubleIcon", su2));
  }
  _initCommands() {
    [
      cu2,
      sr5,
      uu3,
      du2,
      os2,
      Gt3,
      Ut4,
      Wn4,
      Ta2,
      Sa2,
      Mo3,
      Eo4,
      ca,
      da,
      mn3,
      Hm2,
      Ra2,
      Jd2,
      jh,
      wi4,
      tt3,
      Ea2,
      Bi3,
      Fi3,
      Ui3,
      Xi2,
      Mm2,
      Em2,
      ua,
      ha2,
      Io3,
      qd2,
      zh,
      Kh,
      qh,
      Yh,
      Ca2,
      Qd2,
      rs2,
      wa2,
      gn2,
      To2,
      $n3,
      ba2,
      _a2,
      $d2,
      Gh,
      ss3,
      Jt3,
      Ia2,
      va2,
      vi3,
      pi3,
      ns2,
      ts2,
      eu2,
      gr3,
      _o3,
      // permission
      Hn3,
      Nm,
      ma2,
      ii3,
      oi3,
      fa,
      pa2,
      Ma2,
      si3,
      li3,
      ya2,
      is2,
      oa,
      sa
    ].forEach((r) => {
      this.disposeWithMe(this._commandService.registerCommand(r));
    });
  }
  _initMenus() {
    this._menuManagerService.mergeMenu($R);
  }
  _initShortcuts() {
    [
      // selection shortcuts
      Lf,
      Wf,
      Bf2,
      Ff,
      Uf,
      Xf2,
      zf2,
      jf,
      // MoveBackSelectionShortcutItem,
      Yf2,
      Zf2,
      Gf2,
      qf2,
      Qf,
      Kf2,
      Jf2,
      $f,
      ep2,
      tp,
      np,
      rp,
      ip,
      // view shortcuts
      gp,
      fp,
      vp,
      Sp,
      mp,
      pp,
      // toggle cell style shortcuts
      op,
      sp,
      lp,
      ap,
      // cell content editing shortcuts
      cp,
      dp,
      up,
      hp,
      ...af2(),
      df2,
      cf2,
      uf2,
      mf2,
      ff2,
      pf2,
      Sf2,
      hf2,
      gf2,
      vf4,
      // operation shortcuts
      kf,
      Df2
    ].forEach((r) => {
      this.disposeWithMe(this._shortcutService.registerShortcut(r));
    });
  }
  _initWorkbenchParts() {
    const r = this._uiPartsService, e = this._injector;
    this.disposeWithMe(r.registerComponent(c12.HEADER, () => connectInjector(KR, e))), this.disposeWithMe(r.registerComponent(c12.CONTENT, () => connectInjector(of3, e)));
  }
  _initFocusHandler() {
    this.disposeWithMe(
      this._layoutService.registerFocusHandler(we.UNIVER_SHEET, (r) => {
        const e = this._injector.get(ME), t8 = this._injector.get(vr), n = IE(we.UNIVER_DOC, t8, e), i = n == null ? void 0 : n.with(Re2);
        i == null || i.focus();
      })
    );
  }
};
bl = tI([
  zn4(0, Inject(Injector)),
  zn4(1, Inject(S1)),
  zn4(2, U1),
  zn4(3, Ls),
  zn4(4, ye3),
  zn4(5, B12),
  zn4(6, D1),
  zn4(7, ic)
], bl);
var nI = Object.getOwnPropertyDescriptor;
var rI2 = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? nI(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var vc2 = (r, e) => (t8, n) => e(t8, n, r);
var _l = class extends Ve {
  constructor(e, t8, n, i) {
    super();
    _2(this, "_disposableCollection", new ao());
    _2(this, "_initialize", () => {
      const e8 = this._disposableCollection;
      this.disposeWithMe(
        this._selectionManagerService.selectionMoveEnd$.subscribe(() => {
          e8.dispose(), this._selectionRenderService.getSelectionControls().forEach((n2) => {
            e8.add(
              We(
                n2.selectionMoveEnd$.subscribe((i8) => {
                  if (!i8)
                    return;
                  const o = n2.model.getRange(), s = {
                    startRow: o.startRow,
                    startColumn: o.startColumn,
                    endRow: o.endRow,
                    endColumn: o.endColumn,
                    rangeType: o.rangeType
                  }, l = {
                    startRow: i8.startRow,
                    startColumn: i8.startColumn,
                    endRow: i8.endRow,
                    endColumn: i8.endColumn,
                    // rangeType must equal to fromRange
                    rangeType: o.rangeType
                  };
                  if (s.startRow === l.startRow && s.startColumn === l.startColumn || l.startRow < 0 || l.startColumn < 0)
                    return;
                  const a = {
                    fromRange: s,
                    toRange: l
                  };
                  this._commandService.executeCommand(bt2.id, a);
                })
              )
            );
          });
        })
      );
    });
    this._context = e, this._selectionRenderService = t8, this._selectionManagerService = n, this._commandService = i, this._initialize();
  }
  dispose() {
    var e;
    super.dispose(), (e = this._disposableCollection) == null || e.dispose();
  }
};
_l = rI2([
  vc2(1, Inject(gt)),
  vc2(2, Inject(z)),
  vc2(3, Inject(Ls))
], _l);
var iI = Object.getOwnPropertyDescriptor;
var oI = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? iI(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var sI = (r, e) => (t8, n) => e(t8, n, r);
var Ai3 = class extends Ve {
  constructor(r) {
    super(), this._sheetPermissionInitController = r, this._initPermission();
  }
  _initPermission() {
    this._sheetPermissionInitController.initPermission();
  }
};
Ai3 = oI([
  sI(0, Inject($t))
], Ai3);
var lI = Object.getOwnPropertyDescriptor;
var aI = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? lI(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var _n3 = (r, e) => (t8, n) => e(t8, n, r);
var Rl = class extends h1 {
  constructor(e, t8, n, i, o, s, l, a, c, d) {
    super();
    _2(this, "disposableCollection", new ao());
    this._context = e, this._univerInstanceService = t8, this._permissionService = n, this._selectionManagerService = i, this._rangeProtectionRuleModel = o, this._headerMoveRenderController = s, this._selectionRenderService = l, this._headerFreezeRenderController = a, this._rangeProtectionCache = c, this._headerResizeRenderController = d, this._initHeaderMovePermissionInterceptor(), this._initHeaderResizePermissionInterceptor(), this._initRangeFillPermissionInterceptor(), this._initRangeMovePermissionInterceptor();
  }
  _initHeaderMovePermissionInterceptor() {
    const e = this._headerMoveRenderController.interceptor.getInterceptPoints().HEADER_MOVE_PERMISSION_CHECK;
    this.disposeWithMe(
      this._headerMoveRenderController.interceptor.intercept(e, {
        handler: (t8, n) => {
          const i = P(this._univerInstanceService);
          if (!i)
            return false;
          const { unitId: o, subUnitId: s } = i;
          if (!this._permissionService.composePermission([new Pe(o).id, new Ve2(o, s).id]).every((a) => a.value))
            return false;
          if (!n)
            return true;
          if (n.rangeType !== ge.ROW && n.rangeType !== ge.COLUMN)
            return t8;
          if (n.rangeType === ge.ROW) {
            for (let a = n.startRow; a <= n.endRow; a++)
              if (this._rangeProtectionCache.getRowPermissionInfo(o, s, a, [ae.Edit]) === false)
                return false;
          } else
            for (let a = n.startColumn; a <= n.endColumn; a++)
              if (this._rangeProtectionCache.getColPermissionInfo(o, s, a, [ae.Edit]) === false)
                return false;
          return true;
        }
      })
    );
  }
  _initHeaderResizePermissionInterceptor() {
    this._headerResizeRenderController && this.disposeWithMe(
      this._headerResizeRenderController.interceptor.intercept(this._headerResizeRenderController.interceptor.getInterceptPoints().HEADER_RESIZE_PERMISSION_CHECK, {
        handler: (e, t8) => {
          var s, l, a, c;
          const n = P(this._univerInstanceService);
          if (!n)
            return false;
          const { unitId: i, subUnitId: o } = n;
          if (t8.row) {
            if (((l = (s = this._permissionService.getPermissionPoint(new en(i, o).id)) == null ? void 0 : s.value) != null ? l : false) === false)
              return false;
          } else if (t8.col && ((c = (a = this._permissionService.getPermissionPoint(new Qt3(i, o).id)) == null ? void 0 : a.value) != null ? c : false) === false)
            return false;
          return true;
        }
      })
    );
  }
  _initRangeFillPermissionInterceptor() {
    this.disposeWithMe(
      this._selectionRenderService.interceptor.intercept(this._selectionRenderService.interceptor.getInterceptPoints().RANGE_FILL_PERMISSION_CHECK, {
        handler: (e, t8) => {
          var m2, f2, v2;
          const n = P(this._univerInstanceService);
          if (!n)
            return false;
          const { worksheet: i, unitId: o, subUnitId: s } = n;
          if (!this._permissionService.composePermission([
            new Pe(o).id,
            new Ve2(o, s).id,
            new An(o, s).id,
            new yr(o, s).id
          ]).every((p) => p.value))
            return false;
          const a = (m2 = this._selectionManagerService.getCurrentSelections()) == null ? void 0 : m2.map((p) => p.range), c = a == null ? void 0 : a.find((p) => {
            const S = Os3(t8.x, t8.y, t8.scene, t8.skeleton), w = t8.skeleton.getCellWithCoordByIndex(p.endRow, p.endColumn), C = Math.abs(w.endX - S.x), I2 = Math.abs(w.endY - S.y);
            return C <= 5 && I2 <= 5;
          });
          if (!c)
            return true;
          const { startRow: d, endRow: u, startColumn: h, endColumn: g } = c;
          for (let p = d; p <= u; p++)
            for (let S = h; S <= g; S++) {
              const w = (v2 = (f2 = i.getCell(p, S)) == null ? void 0 : f2.selectionProtection) == null ? void 0 : v2[0];
              if ((w == null ? void 0 : w[ae.Edit]) === false || (w == null ? void 0 : w[ae.View]) === false)
                return false;
            }
          return true;
        }
      })
    );
  }
  _initRangeMovePermissionInterceptor() {
    this.disposeWithMe(
      this._selectionRenderService.interceptor.intercept(this._selectionRenderService.interceptor.getInterceptPoints().RANGE_MOVE_PERMISSION_CHECK, {
        handler: (e, t8) => {
          var h;
          const n = P(this._univerInstanceService);
          if (!n)
            return false;
          const { worksheet: i, unitId: o, subUnitId: s } = n;
          if (!this._permissionService.composePermission([new Pe(o).id, new Ve2(o, s).id]).every((g) => g.value))
            return false;
          const a = (h = this._selectionManagerService.getCurrentSelections()) == null ? void 0 : h.map((g) => g.range), c = this._rangeProtectionRuleModel.getSubunitRuleList(o, s).reduce((g, m2) => [...g, ...m2.ranges], []), d = a == null ? void 0 : a.filter((g) => c.some((m2) => En.intersects(m2, g)));
          return !(d == null ? void 0 : d.some((g) => {
            var S, w;
            const { startRow: m2, startColumn: f2, endRow: v2, endColumn: p } = g;
            for (let C = m2; C <= v2; C++)
              for (let I2 = f2; I2 <= p; I2++) {
                const R = (w = (S = i.getCell(C, I2)) == null ? void 0 : S.selectionProtection) == null ? void 0 : w[0];
                if ((R == null ? void 0 : R[ae.Edit]) === false)
                  return true;
              }
            return false;
          }));
        }
      })
    );
  }
  _initFreezePermissionInterceptor() {
    this.disposeWithMe(
      this._headerFreezeRenderController.interceptor.intercept(this._headerFreezeRenderController.interceptor.getInterceptPoints().FREEZE_PERMISSION_CHECK, {
        handler: (e, t8) => {
          var s, l;
          const n = this._univerInstanceService.getCurrentUnitForType(we.UNIVER_SHEET);
          return !(n == null ? void 0 : n.getActiveSheet()) || !n ? false : (l = (s = this._permissionService.getPermissionPoint(new Pe(n.getUnitId()).id)) == null ? void 0 : s.value) != null ? l : false;
        }
      })
    );
  }
};
Rl = aI([
  _n3(1, vr),
  _n3(2, eC),
  _n3(3, Inject(z)),
  _n3(4, Inject(me)),
  _n3(5, Inject(No3)),
  _n3(6, gt),
  _n3(7, Inject(Vo3)),
  _n3(8, Inject(Lt)),
  _n3(9, Optional(ko3))
], Rl);
var cI = Object.getOwnPropertyDescriptor;
var dI = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? cI(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var to2 = (r, e) => (t8, n) => e(t8, n, r);
var uI = "SHEET_PERMISSION_PASTE_PLUGIN";
var Hi3 = class extends Ve {
  constructor(e, t8, n, i, o) {
    super();
    _2(this, "disposableCollection", new ao());
    this._univerInstanceService = e, this._selectionManagerService = t8, this._localService = n, this._sheetClipboardService = i, this._sheetPermissionCheckController = o, this._initClipboardHook();
  }
  _initClipboardHook() {
    this.disposeWithMe(
      this._sheetClipboardService.addClipboardHook({
        id: uI,
        onBeforePaste: (e) => {
          var h, g, m2;
          const [t8] = wr3([e.range]).ranges, n = (h = this._selectionManagerService.getCurrentLastSelection()) == null ? void 0 : h.range;
          if (!n)
            return false;
          const i = {
            startRow: n.startRow + t8.startRow,
            endRow: n.startRow + t8.endRow,
            startColumn: n.startColumn + t8.startColumn,
            endColumn: n.startColumn + t8.endColumn
          }, s = this._univerInstanceService.getCurrentUnitForType(we.UNIVER_SHEET).getActiveSheet();
          if (!s)
            return false;
          const { startRow: l, endRow: a, startColumn: c, endColumn: d } = i;
          let u = true;
          for (let f2 = l; f2 <= a; f2++)
            for (let v2 = c; v2 <= d; v2++) {
              const p = (m2 = (g = s.getCell(f2, v2)) == null ? void 0 : g.selectionProtection) == null ? void 0 : m2[0];
              if ((p == null ? void 0 : p[ae.Edit]) === false) {
                u = false;
                break;
              }
            }
          return u || this._sheetPermissionCheckController.blockExecuteWithoutPermission(this._localService.t("permission.dialog.pasteErr")), u;
        }
      })
    );
  }
};
Hi3 = dI([
  to2(0, vr),
  to2(1, Inject(z)),
  to2(2, Inject(Fn)),
  to2(3, Inject(nn2)),
  to2(4, Inject(qn))
], Hi3);
var hI = Object.getOwnPropertyDescriptor;
var gI = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? hI(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var Is2 = (r, e) => (t8, n) => e(t8, n, r);
var Il = class extends h1 {
  constructor(e, t8, n, i, o) {
    super();
    _2(this, "disposableCollection", new ao());
    this._context = e, this._univerInstanceService = t8, this._permissionService = n, this._statusBarController = i, this._rangeProtectionCache = o, this._initStatusBarPermissionInterceptor();
  }
  _initStatusBarPermissionInterceptor() {
    this.disposeWithMe(
      this._statusBarController.interceptor.intercept(this._statusBarController.interceptor.getInterceptPoints().STATUS_BAR_PERMISSION_CORRECT, {
        priority: 100,
        handler: (e, t8) => {
          var a;
          const n = P(this._univerInstanceService);
          if (!n)
            return e != null ? e : [];
          const { worksheet: i, unitId: o, subUnitId: s } = n;
          return ((a = this._permissionService.getPermissionPoint(new ls(o, s).id)) == null ? void 0 : a.value) === false ? t8.forEach((c) => {
            const d = c.getArrayValue();
            d.forEach((u, h) => {
              u.forEach((g, m2) => {
                d[h][m2] = ce.create();
              });
            });
          }) : t8.forEach((c) => {
            const d = c.getArrayValue(), u = c.getCurrentRow(), h = c.getCurrentColumn();
            d.forEach((g, m2) => {
              g.forEach((f2, v2) => {
                var w;
                if (((w = i.getCellRaw(m2 + u, v2 + h)) == null ? void 0 : w.v) === void 0)
                  return;
                const S = this._rangeProtectionCache.getCellInfo(o, s, m2 + u, v2 + h);
                (S == null ? void 0 : S[ae.View]) === false && (d[m2][v2] = ce.create());
              });
            });
          }), t8;
        }
      })
    );
  }
};
Il = gI([
  Is2(1, vr),
  Is2(2, eC),
  Is2(3, Inject(Er2)),
  Is2(4, Inject(Lt))
], Il);
var Rp2 = (r, e, t8, n, i) => {
  const o = r.get(Fn), s = r.get(lt), l = r.get(me);
  let a = "";
  if (e.length === 0)
    a = o.t("permission.panel.emptyRangeError");
  else if (e.length > 1) {
    let c = false;
    for (let d = 0; d < e.length; d++) {
      for (let u = d + 1; u < e.length; u++)
        if (En.intersects(e[d], e[u])) {
          c = true;
          break;
        }
      if (c)
        break;
    }
    c && (a = o.t("permission.panel.rangeOverlapError"));
  }
  if (!a) {
    if (s.getRule(n, i) && !t8)
      return a = o.t("permission.panel.rangeOverlapOverPermissionError"), a;
    const d = l.getSubunitRuleList(n, i).filter((h) => h.permissionId !== t8).find((h) => h.ranges.some((g) => e.some((m2) => En.intersects(g, m2))));
    (d == null ? void 0 : d.ranges.find((h) => e.some((g) => En.intersects(h, g)))) && (a = o.t("permission.panel.rangeOverlapOverPermissionError"));
  }
  return a === "" ? void 0 : a;
};
var mI = (r, e) => {
  if (r.length !== 1)
    return false;
  const t8 = r[0], n = e.getRowCount(), i = e.getColumnCount(), { startRow: o, endRow: s, startColumn: l, endColumn: a } = t8;
  return o === 0 && l === 0 && s === n - 1 && a === i - 1;
};
var fI = (r, e) => {
  var a, c;
  const t8 = r.get(vr), n = r.get(z), i = t8.getCurrentUnitForType(we.UNIVER_SHEET), o = i.getActiveSheet();
  let s = x.SelectRange, l = (c = (a = n.getCurrentSelections()) == null ? void 0 : a.map((d) => d.range)) != null ? c : [];
  return e && (s = x.Worksheet, l = [{
    startRow: 0,
    startColumn: 0,
    endRow: o.getRowCount() - 1,
    endColumn: o.getColumnCount() - 1,
    rangeType: ge.ALL
  }]), {
    unitId: i.getUnitId(),
    subUnitId: o.getSheetId(),
    permissionId: "",
    unitType: s,
    description: "",
    id: "",
    ranges: l,
    editState: Pu2.OnlyMe,
    viewState: Tu.OthersCanView
  };
};
var pI = (r, e) => {
  const i = r.get(vr).getCurrentUnitForType(we.UNIVER_SHEET).getActiveSheet(), { unitType: o } = e;
  return o === x.Worksheet ? {
    ...e,
    ranges: [{
      startRow: 0,
      startColumn: 0,
      endRow: i.getRowCount() - 1,
      endColumn: i.getColumnCount() - 1,
      rangeType: ge.ALL
    }]
  } : e;
};
var vI = (r) => {
  const { viewState: e, editState: t8, permissionId: n, ranges: i, rangesErrMsg: o, desc: s, oldRule: l, id: a } = r, c = useDependency(Rr3), d = useDependency(we3), u = useDependency(dE), h = useDependency(Fn), g = useDependency(Ls), m2 = useDependency(Vr), v2 = useDependency(vr).getCurrentUnitForType(we.UNIVER_SHEET), p = v2 == null ? void 0 : v2.getActiveSheet();
  if (!v2 || !p)
    return null;
  const S = v2.getUnitId(), w = p.getSheetId();
  return (0, import_jsx_runtime4.jsxs)("div", { className: "univer-mt-auto univer-flex univer-flex-row-reverse univer-gap-2 univer-py-5", children: [
    (0, import_jsx_runtime4.jsx)(
      vr2,
      {
        variant: "primary",
        onClick: async () => {
          if (o) return;
          const C = {
            unitId: S,
            subUnitId: w,
            permissionId: n,
            id: a,
            viewState: e,
            editState: t8,
            unitType: x.SelectRange,
            ranges: i,
            description: s
          };
          mI(i, p) && (C.unitType = x.Worksheet, C.ranges = []);
          let R = m2.selectUserList;
          C.editState === Pu2.OnlyMe && (R = [], m2.setSelectUserList([]));
          const y = {
            read: C.viewState === Tu.OthersCanView ? on3.AllCollaborator : on3.SomeCollaborator,
            edit: C.editState === Pu2.DesignedUserCanEdit ? on3.SomeCollaborator : on3.OneSelf
          };
          if (C.editState === Pu2.DesignedUserCanEdit && R.length === 0 && (R = [], y.edit = on3.OneSelf), C.permissionId) {
            const E = fw(R.filter((x7) => x7.role === Lt3.Editor), m2.oldCollaboratorList.filter((x7) => x7.role === Lt3.Editor)), T = (l == null ? void 0 : l.viewState) === C.viewState, P2 = (l == null ? void 0 : l.editState) === C.editState, H3 = C.unitType === (l == null ? void 0 : l.unitType) && C.description === l.description && C.ranges === l.ranges, A = !E || !T || !P2;
            if (H3 && A)
              await u.update({
                objectType: C.unitType,
                objectID: C.permissionId,
                unitID: C.unitId,
                share: void 0,
                name: "",
                strategies: [],
                scope: y,
                collaborators: {
                  collaborators: R
                }
              });
            else {
              let x7 = C.permissionId;
              A && (C.unitType === x.Worksheet ? x7 = await u.create({
                worksheetObject: {
                  collaborators: R,
                  unitID: C.unitId,
                  name: "",
                  strategies: [{ role: Lt3.Editor, action: ae.Edit }, { role: Lt3.Reader, action: ae.View }],
                  scope: y
                },
                objectType: x.Worksheet
              }) : x7 = await u.create({
                selectRangeObject: {
                  collaborators: R,
                  unitID: C.unitId,
                  name: "",
                  scope: y
                },
                objectType: x.SelectRange
              })), g.executeCommand(xc.id, {
                rule: {
                  ...C,
                  permissionId: x7
                },
                oldRule: l
              });
            }
          } else if (C.unitType === x.Worksheet) {
            const E = await u.create({
              worksheetObject: {
                collaborators: R,
                unitID: C.unitId,
                name: "",
                strategies: [{ role: Lt3.Editor, action: ae.Edit }, { role: Lt3.Reader, action: ae.View }],
                scope: y
              },
              objectType: x.Worksheet
            }), { ranges: T = [], ...P2 } = C;
            P2.permissionId = E, g.executeCommand(ac.id, {
              rule: P2,
              unitId: C.unitId
            });
          } else if (C.unitType === x.SelectRange) {
            const E = await u.create({
              selectRangeObject: {
                collaborators: R,
                unitID: C.unitId,
                name: "",
                scope: y
              },
              objectType: x.SelectRange
            });
            g.executeCommand(Nu.id, {
              rule: C,
              permissionId: E
            });
          }
          const M7 = {
            header: { title: `${h.t("permission.panel.title")}` },
            children: {
              label: yo2,
              showDetail: false
            },
            width: 330
          };
          d.open(M7);
        },
        children: h.t("permission.button.confirm")
      }
    ),
    (0, import_jsx_runtime4.jsx)(
      vr2,
      {
        onClick: () => {
          c.reset(), m2.reset(), d.close();
        },
        children: h.t("permission.button.cancel")
      }
    )
  ] });
};
var SI = (r) => {
  const { ranges: e, onRangesChange: t8, desc: n, onDescChange: i, rangesErrMsg: o, permissionId: s } = r, l = useDependency(S1), a = (0, import_react4.useMemo)(() => l.get(hm), []), c = useDependency(vr), d = useDependency(Fn), u = useDependency(Injector), h = c.getCurrentUnitForType(we.UNIVER_SHEET), g = h == null ? void 0 : h.getActiveSheet();
  if (!h || !g)
    return null;
  const m2 = h.getUnitId(), f2 = g.getSheetId(), v2 = (p) => {
    const S = p.split(",").map(Dr).map((E) => E.range);
    if (S.some((E) => !z1(E) || E.endColumn < E.startColumn || E.endRow < E.startRow))
      return;
    const w = c.getCurrentUnitForType(we.UNIVER_SHEET), C = w == null ? void 0 : w.getActiveSheet();
    if (!w || !C)
      return;
    const I2 = w.getUnitId(), R = C.getSheetId(), y = S.map((E) => {
      const T = C.getRowCount(), P2 = C.getColumnCount();
      return kh(E, T, P2), E;
    }), M7 = Rp2(u, y, s, I2, R);
    t8(y, M7);
  };
  return (0, import_jsx_runtime4.jsxs)(import_jsx_runtime4.Fragment, { children: [
    (0, import_jsx_runtime4.jsx)(
      gE2,
      {
        className: "univer-font-medium",
        label: d.t("permission.panel.protectedRange"),
        error: o,
        children: a && (0, import_jsx_runtime4.jsx)(
          a,
          {
            unitId: m2,
            subUnitId: f2,
            initialValue: e == null ? void 0 : e.map((p) => Ft(p)).join(","),
            onChange: (p, S) => v2(S)
          }
        )
      }
    ),
    (0, import_jsx_runtime4.jsx)(gE2, { className: "univer-font-medium", label: d.t("permission.panel.permissionDirection"), children: (0, import_jsx_runtime4.jsx)(
      Vx,
      {
        value: n,
        onChange: (p) => i(p),
        placeholder: d.t("permission.panel.permissionDirectionPlaceholder")
      }
    ) })
  ] });
};
var Ip = "data:image/png;base64,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";
var CI = (r) => {
  const { editState: e, onEditStateChange: t8, viewState: n, onViewStateChange: i, permissionId: o } = r, s = useDependency(Fn), l = useDependency(ct2), a = useDependency(dE), c = useDependency(Vr), d = useDependency(Rs), u = useDependency(vr), h = useObservable(c.selectUserList$, c.selectUserList), g = u.getCurrentUnitForType(we.UNIVER_SHEET), m2 = g == null ? void 0 : g.getActiveSheet();
  if (!g || !m2)
    return null;
  const f2 = g.getUnitId(), v2 = async () => {
    const p = await a.listCollaborators({
      objectID: f2,
      unitID: f2
    }), S = d.getCurrentUser();
    c.setCanEditUserList(p.filter((w) => {
      var C;
      return ((C = w.subject) == null ? void 0 : C.userID) !== S.userID;
    })), l.open({
      id: il2,
      title: { title: "" },
      children: { label: Pm },
      width: 280,
      destroyOnClose: true,
      closable: false,
      onClose: () => l.close(il2),
      className: "sheet-permission-user-dialog"
    });
  };
  return (0, import_react4.useEffect)(() => {
    o ? (async () => {
      const w = (await a.listCollaborators({
        objectID: o,
        unitID: f2
      })).filter((C) => C.role === Lt3.Editor);
      w.length > 0 && t8(Pu2.DesignedUserCanEdit), c.setSelectUserList(w), c.setOldCollaboratorList(w);
    })() : (c.setSelectUserList([]), c.setOldCollaboratorList([]));
  }, []), (0, import_jsx_runtime4.jsxs)(import_jsx_runtime4.Fragment, { children: [
    (0, import_jsx_runtime4.jsx)(gE2, { className: "univer-font-medium", label: s.t("permission.panel.editPermission"), children: (0, import_jsx_runtime4.jsxs)(
      kE,
      {
        value: e,
        onChange: (p) => t8(p),
        className: "univer-flex univer-flex-col",
        children: [
          (0, import_jsx_runtime4.jsx)(TE, { value: Pu2.OnlyMe, children: (0, import_jsx_runtime4.jsx)("span", { children: s.t("permission.panel.onlyICanEdit") }) }),
          (0, import_jsx_runtime4.jsx)(TE, { value: Pu2.DesignedUserCanEdit, children: (0, import_jsx_runtime4.jsx)("span", { children: s.t("permission.panel.designedUserCanEdit") }) })
        ]
      }
    ) }),
    e === Pu2.DesignedUserCanEdit && (0, import_jsx_runtime4.jsxs)(
      "div",
      {
        className: ie2("univer-mb-2 univer-flex univer-h-[270px] univer-flex-col univer-overflow-y-auto univer-rounded-lg univer-p-3", kt2),
        children: [
          (0, import_jsx_runtime4.jsxs)("div", { className: "univer-flex univer-items-center univer-justify-between univer-text-sm", children: [
            (0, import_jsx_runtime4.jsx)("span", { children: s.t("permission.panel.designedPerson") }),
            (0, import_jsx_runtime4.jsx)("span", { className: "univer-cursor-pointer univer-text-primary-600", onClick: v2, children: s.t("permission.panel.addPerson") })
          ] }),
          (0, import_jsx_runtime4.jsx)("div", { className: "univer-my-2 univer-h-px univer-bg-gray-200" }),
          (0, import_jsx_runtime4.jsx)("div", { className: "univer-flex-1", children: (h == null ? void 0 : h.length) > 0 ? h.map((p) => {
            var S, w, C;
            return (0, import_jsx_runtime4.jsxs)(
              "div",
              {
                className: "univer-mb-3 univer-flex univer-h-7 univer-items-center univer-leading-7 last:univer-mb-0",
                children: [
                  (0, import_jsx_runtime4.jsx)(YS, { size: 24, src: (S = p.subject) == null ? void 0 : S.avatar }),
                  (0, import_jsx_runtime4.jsx)(
                    "span",
                    {
                      className: "univer-ml-1.5 univer-w-[130px] univer-truncate univer-text-gray-900 dark:!univer-text-white",
                      children: (w = p.subject) == null ? void 0 : w.name
                    }
                  ),
                  (0, import_jsx_runtime4.jsx)(
                    LE,
                    {
                      className: "!univer-w-[90px] univer-min-w-0 univer-cursor-pointer",
                      borderless: true,
                      value: "edit",
                      options: [
                        { label: `${s.t("permission.panel.canEdit")}`, value: "edit" },
                        { label: `${s.t("permission.panel.delete")}`, value: "delete" }
                      ],
                      onChange: (I2) => {
                        I2 === "delete" && c.setSelectUserList(h.filter((R) => {
                          var y, M7;
                          return ((y = R.subject) == null ? void 0 : y.userID) !== ((M7 = p.subject) == null ? void 0 : M7.userID);
                        }));
                      }
                    }
                  )
                ]
              },
              (C = p.subject) == null ? void 0 : C.userID
            );
          }) : (0, import_jsx_runtime4.jsxs)(
            "div",
            {
              className: "univer-flex univer-h-full univer-flex-col univer-items-center univer-justify-center",
              children: [
                (0, import_jsx_runtime4.jsx)("img", { width: 240, height: 120, src: Ip, alt: "" }),
                (0, import_jsx_runtime4.jsx)(
                  "p",
                  {
                    className: "univer-w-60 univer-break-words univer-text-sm univer-text-gray-400",
                    children: s.t("permission.dialog.userEmpty")
                  }
                )
              ]
            }
          ) })
        ]
      }
    ),
    (0, import_jsx_runtime4.jsx)(gE2, { className: "univer-font-medium", label: s.t("permission.panel.viewPermission"), children: (0, import_jsx_runtime4.jsxs)(
      kE,
      {
        value: n,
        onChange: (p) => i(p),
        className: "univer-flex univer-flex-col last:univer-mb-0",
        children: [
          (0, import_jsx_runtime4.jsx)(TE, { value: Tu.OthersCanView, children: (0, import_jsx_runtime4.jsx)("span", { children: s.t("permission.panel.othersCanView") }) }),
          (0, import_jsx_runtime4.jsx)(TE, { value: Tu.NoOneElseCanView, children: (0, import_jsx_runtime4.jsx)("span", { children: s.t("permission.panel.noOneElseCanView") }) })
        ]
      }
    ) })
  ] });
};
var wI = (r) => {
  var w, C;
  const { fromSheetBar: e, rule: t8, oldRule: n } = r, i = useDependency(Injector), o = useDependency(S1), s = t8 ? pI(i, t8) : fI(i, e), [l, a] = (0, import_react4.useState)(s.ranges), [c, d] = (0, import_react4.useState)(() => Rp2(i, s.ranges, s.permissionId, s.unitId, s.subUnitId)), [u, h] = (0, import_react4.useState)(s.description), [g, m2] = (0, import_react4.useState)((w = s.editState) != null ? w : Pu2.OnlyMe), [f2, v2] = (0, import_react4.useState)((C = s.viewState) != null ? C : Tu.OthersCanView), p = o.get(ga3), S = p != null ? p : CI;
  return (0, import_react4.useEffect)(() => {
    const I2 = i.get(vr), R = i.get(we3), y = I2.getCurrentUnitOfType(we.UNIVER_SHEET);
    if (!y) return;
    const M7 = y.getActiveSheet().getSheetId(), E = y.activeSheet$.subscribe((T) => {
      (T == null ? void 0 : T.getSheetId()) !== M7 && R.close();
    });
    return () => {
      E.unsubscribe();
    };
  }, []), (0, import_jsx_runtime4.jsxs)(
    "div",
    {
      className: "univer-mt-4 univer-flex univer-h-[calc(100%-16px)] univer-flex-col",
      children: [
        (0, import_jsx_runtime4.jsx)(
          SI,
          {
            permissionId: s.permissionId,
            ranges: l,
            onRangesChange: (I2, R) => {
              a(I2), d(R);
            },
            rangesErrMsg: c,
            desc: u,
            onDescChange: (I2) => h(I2)
          }
        ),
        (0, import_jsx_runtime4.jsx)(
          S,
          {
            editState: g,
            onEditStateChange: (I2) => m2(I2),
            viewState: f2,
            onViewStateChange: (I2) => v2(I2),
            permissionId: s.permissionId
          }
        ),
        (0, import_jsx_runtime4.jsx)(
          vI,
          {
            permissionId: s.permissionId,
            id: s.id,
            ranges: l,
            rangesErrMsg: c,
            desc: u,
            viewState: f2,
            editState: g,
            oldRule: n
          }
        )
      ]
    }
  );
};
var bI = "data:image/png;base64,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";
function _I() {
  var A;
  const [r, e] = (0, import_react4.useState)(true), [t8, n] = (0, import_react4.useState)(false), [i, o] = (0, import_react4.useState)([]), s = useDependency(Fn), l = useDependency(me), a = useDependency(lt), c = useDependency(vr), d = useDependency(Ls), u = useDependency(we3), h = useDependency(dE), g = useDependency(eC), f2 = useDependency(Rs).getCurrentUser(), v2 = useDependency(Vr), p = useObservable(a.ruleRefresh$, ""), S = useObservable(l.ruleRefresh$, ""), w = c.getCurrentUnitOfType(we.UNIVER_SHEET);
  if (!w) return null;
  const C = w.getUnitId(), I2 = (0, import_react4.useCallback)(async (x7) => {
    var Z7;
    const V2 = w.getActiveSheet(), D2 = w.getUnitId(), X2 = V2.getSheetId(), B = [], j = [];
    w.getSheets().forEach((ee3) => {
      const ne2 = ee3.getSheetId();
      l.getSubunitRuleList(D2, ne2).forEach((me3) => {
        me3.permissionId && B.push(me3.permissionId);
      });
      const Ue3 = a.getRule(D2, ne2);
      Ue3 != null && Ue3.permissionId && j.push(Ue3.permissionId);
    });
    const G7 = [...B, ...j], ge2 = await h.list({
      objectIDs: G7,
      unitID: D2,
      actions: St
    }), Re3 = l.getSubunitRuleList(D2, X2).map((ee3) => ee3.permissionId), be2 = (Z7 = a.getRule(D2, X2)) == null ? void 0 : Z7.permissionId;
    be2 && Re3.push(be2);
    const Ne3 = ge2.filter((ee3) => {
      var ne2;
      return Re3.includes(ee3.objectID) || ee3.objectID === ((ne2 = a.getRule(D2, X2)) == null ? void 0 : ne2.permissionId);
    });
    return x7 ? Ne3 : ge2;
  }, []), [R, y] = (0, import_react4.useState)([]);
  (0, import_react4.useEffect)(() => {
    const x7 = merge(
      l.ruleChange$,
      a.ruleChange$
    ).subscribe(async () => {
      const V2 = await I2(r);
      y(V2);
    });
    return () => {
      x7.unsubscribe();
    };
  }, [r]), (0, import_react4.useEffect)(() => {
    const x7 = w.activeSheet$.pipe(
      distinctUntilChanged((V2, D2) => (V2 == null ? void 0 : V2.getSheetId()) === (D2 == null ? void 0 : D2.getSheetId()))
    ).subscribe(async () => {
      const V2 = await I2(r);
      y(V2);
    });
    return () => {
      x7.unsubscribe();
    };
  }, [r]), (0, import_react4.useEffect)(() => {
    (async () => {
      if (p || S) {
        const V2 = await I2(true);
        y(V2);
      }
    })();
  }, [p, S]);
  function M7(x7) {
    const { unitId: V2, subUnitId: D2, unitType: X2 } = x7;
    let B;
    X2 === yn3.Worksheet ? B = d.executeCommand(gc.id, { unitId: V2, subUnitId: D2, rule: x7 }) : X2 === yn3.SelectRange && (B = d.executeCommand(hc.id, { unitId: V2, subUnitId: D2, rule: x7 })), B && (n(!t8), x7.ranges === i && o([]));
  }
  (0, import_react4.useEffect)(() => {
    v2.reset();
  }, []), pR(i);
  const E = (0, import_react4.useMemo)(() => {
    const x7 = /* @__PURE__ */ new Map();
    return w.getSheets().forEach((V2) => {
      const D2 = V2.getSheetId();
      l.getSubunitRuleList(C, D2).forEach((j) => {
        x7.set(j.permissionId, j);
      });
      const B = a.getRule(C, D2);
      B && x7.set(B == null ? void 0 : B.permissionId, B);
    }), x7;
  }, [C, w, l, a]), T = (x7) => {
    x7.subUnitId !== w.getActiveSheet().getSheetId() && d.executeCommand(pn2.id, {
      unitId: x7.unitId,
      subUnitId: x7.subUnitId
    });
    const V2 = {
      header: { title: "permission.panel.title" },
      children: {
        label: yo2,
        showDetail: true,
        rule: J.deepClone(x7),
        oldRule: J.deepClone(x7)
      },
      width: 330
    };
    u.open(V2);
  }, P2 = (x7) => {
    e(x7);
  }, H3 = (A = g.getPermissionPoint(new or2(C).id)) == null ? void 0 : A.value;
  return (0, import_jsx_runtime4.jsxs)("div", { className: "univer-mt-2 univer-flex univer-h-[calc(100%-8px)] univer-flex-col", children: [
    (0, import_jsx_runtime4.jsxs)("div", { className: "univer-flex univer-h-[30px] univer-py-2", children: [
      (0, import_jsx_runtime4.jsxs)("div", { className: "univer-mr-5 univer-flex univer-cursor-pointer univer-flex-col univer-items-center", onClick: () => P2(true), children: [
        (0, import_jsx_runtime4.jsxs)("div", { className: ie2("univer-h-6 univer-text-base univer-font-medium univer-leading-6", { "univer-text-blue-500": r }), children: [
          " ",
          s.t("permission.panel.currentSheet")
        ] }),
        (0, import_jsx_runtime4.jsx)("div", { className: ie2("univer-mt-1 univer-h-0.5 univer-w-6", { "univer-bg-blue-500": r }) })
      ] }),
      (0, import_jsx_runtime4.jsxs)("div", { className: "univer-mr-5 univer-flex univer-cursor-pointer univer-flex-col univer-items-center", onClick: () => P2(false), children: [
        (0, import_jsx_runtime4.jsx)("div", { className: ie2("univer-h-6 univer-text-base univer-font-medium univer-leading-6", { "univer-text-blue-500": !r }), children: s.t("permission.panel.allSheet") }),
        (0, import_jsx_runtime4.jsx)("div", { className: ie2("univer-mt-1 univer-h-0.5 univer-w-6", { "univer-bg-blue-500": !r }) })
      ] })
    ] }),
    (R == null ? void 0 : R.length) > 0 ? (0, import_jsx_runtime4.jsx)("div", { children: R == null ? void 0 : R.map((x7) => {
      var ne2, pe2, Ue3, me3, _e4;
      const V2 = E.get(x7.objectID);
      if (!V2)
        return null;
      const D2 = x7.actions.find((le2) => le2.action === ae.Edit), X2 = D2 == null ? void 0 : D2.allowed, B = x7.actions.find((le2) => le2.action === ae.View), j = B == null ? void 0 : B.allowed, G7 = x7.actions.find((le2) => le2.action === ae.ManageCollaborator), ge2 = x7.actions.find((le2) => le2.action === ae.Delete), Re3 = (G7 == null ? void 0 : G7.allowed) || f2.userID === ((ne2 = x7.creator) == null ? void 0 : ne2.userID), be2 = (ge2 == null ? void 0 : ge2.allowed) || f2.userID === ((pe2 = x7.creator) == null ? void 0 : pe2.userID);
      let Ne3 = "";
      const Z7 = w.getSheetBySheetId(V2.subUnitId), ee3 = Z7 == null ? void 0 : Z7.getName();
      if (V2.unitType === yn3.SelectRange) {
        const le2 = V2.ranges, it2 = le2 != null && le2.length ? le2.map((ot4) => {
          const vt3 = Ft(ot4);
          return vt3 === "NaN" ? "" : vt3;
        }).filter((ot4) => !!ot4).join(",") : "";
        Ne3 = `${ee3}(${it2})`;
      } else V2.unitType === yn3.Worksheet && (Ne3 = ee3 || "");
      return (0, import_jsx_runtime4.jsxs)(
        "div",
        {
          className: ie2("univer-mt-3 univer-rounded-lg univer-p-3 hover:univer-bg-gray-50", kt2),
          onMouseMove: () => {
            const { subUnitId: le2, unitType: it2 } = V2, ot4 = w.getActiveSheet();
            if (!ot4)
              return false;
            const vt3 = ot4.getSheetId();
            if (le2 !== vt3)
              return false;
            if (it2 === yn3.SelectRange) {
              const wt3 = V2.ranges || [];
              wt3 !== i && o(wt3);
            } else if (it2 === yn3.Worksheet) {
              const wt3 = [{ startRow: 0, endRow: ot4.getRowCount() - 1, startColumn: 0, endColumn: ot4.getColumnCount() - 1 }];
              wt3 !== i && o(wt3);
            }
          },
          onMouseLeave: () => o([]),
          children: [
            (0, import_jsx_runtime4.jsxs)("div", { className: "univer-flex univer-h-5 univer-justify-between univer-leading-5", children: [
              (0, import_jsx_runtime4.jsx)(Rp, { title: Ne3, children: (0, import_jsx_runtime4.jsx)(
                "div",
                {
                  className: "univer-max-w-[200px] univer-truncate univer-text-sm univer-font-medium",
                  children: Ne3
                }
              ) }),
              (Re3 || be2) && (0, import_jsx_runtime4.jsxs)("div", { className: "univer-flex univer-items-center", children: [
                Re3 && (0, import_jsx_runtime4.jsx)(Rp, { title: s.t("permission.panel.edit"), children: (0, import_jsx_runtime4.jsx)(
                  "div",
                  {
                    className: "univer-box-border univer-h-6 univer-rounded-sm univer-p-1 hover:univer-bg-gray-200",
                    onClick: () => T(V2),
                    children: (0, import_jsx_runtime4.jsx)(ou2, {})
                  }
                ) }),
                be2 && (0, import_jsx_runtime4.jsx)(Rp, { title: s.t("permission.panel.delete"), children: (0, import_jsx_runtime4.jsx)(
                  "div",
                  {
                    className: "univer-box-border univer-h-6 univer-rounded-sm univer-p-1 hover:univer-bg-gray-200",
                    onClick: () => M7(V2),
                    children: (0, import_jsx_runtime4.jsx)(Pa2, {})
                  }
                ) })
              ] })
            ] }),
            (0, import_jsx_runtime4.jsx)("div", { className: "univer-my-2 univer-h-px univer-bg-gray-200" }),
            (0, import_jsx_runtime4.jsxs)("div", { children: [
              (0, import_jsx_runtime4.jsxs)("div", { className: "univer-flex univer-items-center", children: [
                (0, import_jsx_runtime4.jsx)(Rp, { title: (me3 = (Ue3 = x7.creator) == null ? void 0 : Ue3.name) != null ? me3 : "", children: (0, import_jsx_runtime4.jsx)("div", { children: (0, import_jsx_runtime4.jsx)(YS, { src: (_e4 = x7.creator) == null ? void 0 : _e4.avatar, className: "univer-mr-1.5", size: 24 }) }) }),
                (0, import_jsx_runtime4.jsx)(
                  "span",
                  {
                    className: "univer-h-4 univer-flex-grow univer-text-xs univer-text-gray-900 dark:!univer-text-white",
                    children: s.t("permission.panel.created")
                  }
                ),
                (0, import_jsx_runtime4.jsx)(
                  "span",
                  {
                    className: "univer-h-4 univer-text-xs univer-text-gray-900 dark:!univer-text-white",
                    children: X2 ? `${s.t("permission.panel.iCanEdit")}` : `${s.t("permission.panel.iCanNotEdit")}`
                  }
                )
              ] }),
              (0, import_jsx_runtime4.jsxs)("div", { className: "univer-mt-2 univer-flex univer-items-center", children: [
                (0, import_jsx_runtime4.jsx)(
                  "span",
                  {
                    className: "univer-h-4 univer-flex-grow univer-text-xs univer-text-gray-900 dark:!univer-text-white",
                    children: s.t("permission.panel.viewPermission")
                  }
                ),
                (0, import_jsx_runtime4.jsx)(
                  "span",
                  {
                    className: "univer-h-4 univer-text-xs univer-text-gray-900 dark:!univer-text-white",
                    children: j ? `${s.t("permission.panel.iCanView")}` : `${s.t("permission.panel.iCanNotView")}`
                  }
                )
              ] }),
              V2.description && (0, import_jsx_runtime4.jsx)(Rp, { title: V2.description, children: (0, import_jsx_runtime4.jsx)(
                "div",
                {
                  className: "univer-text-3 univer-mt-2 univer-max-w-64 univer-truncate univer-text-sm univer-text-gray-400",
                  children: V2.description
                }
              ) })
            ] })
          ]
        },
        x7.objectID
      );
    }) }) : (0, import_jsx_runtime4.jsxs)(
      "div",
      {
        className: "univer-flex univer-flex-1 univer-flex-col univer-items-center univer-justify-center",
        children: [
          (0, import_jsx_runtime4.jsx)("img", { width: 240, height: 120, src: bI, alt: "", draggable: false }),
          (0, import_jsx_runtime4.jsx)("p", { className: "univer-w-60 univer-break-words univer-text-sm univer-text-gray-400", children: s.t("permission.dialog.listEmpty") })
        ]
      }
    ),
    H3 && (0, import_jsx_runtime4.jsx)("div", { className: "univer-mt-auto univer-py-5", children: (0, import_jsx_runtime4.jsxs)(
      vr2,
      {
        className: "univer-w-full",
        variant: "primary",
        onClick: () => {
          const x7 = {
            header: { title: `${s.t("permission.panel.title")}` },
            children: {
              label: yo2,
              showDetail: true
            },
            width: 330
          };
          u.open(x7);
        },
        children: [
          (0, import_jsx_runtime4.jsx)("div", { children: "+ " }),
          s.t("permission.button.addNewPermission")
        ]
      }
    ) })
  ] });
}
var RI = ({ showDetail: r, fromSheetBar: e, rule: t8, oldRule: n }) => {
  var u;
  const i = useDependency(vr), o = useDependency(z);
  if (!useDependency(Rr3).getVisible()) return null;
  const l = P(i);
  if (!l) return null;
  const { worksheet: a } = l, d = ((u = o.getCurrentSelections()) == null ? void 0 : u.map((h) => h.range)).reduce((h, g) => h + Hc2(a.getName(), g), "");
  return r ? (0, import_jsx_runtime4.jsx)(
    wI,
    {
      fromSheetBar: e,
      rule: t8,
      oldRule: n
    },
    e ? "sheet-bar" : "normal"
  ) : (0, import_jsx_runtime4.jsx)(_I, {}, d);
};
var II = ({ loading: r, children: e }) => (0, import_jsx_runtime4.jsxs)("div", { className: "univer-relative univer-h-full univer-w-full", children: [
  r && (0, import_jsx_runtime4.jsx)(
    "div",
    {
      className: "univer-absolute -univer-bottom-0.5 -univer-left-0.5 -univer-right-0.5 -univer-top-0.5 univer-z-10 univer-flex univer-items-center univer-justify-center univer-bg-white univer-backdrop-blur dark:!univer-bg-black",
      children: (0, import_jsx_runtime4.jsx)(
        "div",
        {
          className: "univer-size-10 univer-animate-spin univer-rounded-full univer-border-4 univer-border-solid univer-border-gray-100 univer-border-t-primary-500"
        }
      )
    }
  ),
  (0, import_jsx_runtime4.jsx)("div", { className: r ? "univer-pointer-events-none univer-blur-sm" : "", children: e })
] });
var yI = () => {
  const r = useDependency(Fn), e = useDependency(vr), t8 = useDependency(dE), n = useDependency(In), i = useDependency(ct2), o = useDependency(eC), s = e.getCurrentUnitForType(we.UNIVER_SHEET), l = s.getActiveSheet();
  if (!l)
    throw new Error("No active sheet found");
  const [a, c] = (0, import_react4.useState)([]), d = useDependency(Ls), [u, h] = (0, import_react4.useState)(() => !!n.getRule(s.getUnitId(), l.getSheetId())), [g, m2] = (0, import_react4.useState)(() => Object.keys(Cs2).reduce((v2, p) => (v2[p] = {
    text: r.t(`permission.panel.${Cs2[Number(p)]}`),
    allowed: true
  }, v2), {}));
  (0, import_react4.useEffect)(() => {
    (async () => {
      const p = s.getUnitId(), S = await t8.listCollaborators({
        objectID: p,
        unitID: p
      });
      c(S);
    })();
  }, []), (0, import_react4.useEffect)(() => {
    (async () => {
      const p = s.getUnitId(), S = n.getRule(p, l.getSheetId());
      if (!S)
        return;
      h(true);
      const C = (await t8.list({
        unitID: s.getUnitId(),
        objectIDs: [S.permissionId],
        actions: Y12
      }))[0].strategies.reduce((I2, R) => (Cs2[R.action] && (I2[R.action] = {
        text: r.t(`permission.panel.${Cs2[R.action]}`),
        allowed: R.role !== Lt3.Owner
      }), I2), {});
      m2(C), setTimeout(() => {
        h(false);
      }, 100);
    })();
  }, []);
  const f2 = async () => {
    const v2 = e.getCurrentUnitForType(we.UNIVER_SHEET), p = v2 == null ? void 0 : v2.getActiveSheet();
    if (!p)
      throw new Error("No active sheet found");
    const S = v2.getUnitId(), w = p.getSheetId(), C = n.getRule(S, w), I2 = Object.keys(g).map((y) => ({
      action: Number(y),
      role: g[y].allowed ? Lt3.Editor : Lt3.Owner
    }));
    let R = C == null ? void 0 : C.permissionId;
    R ? t8.update({
      objectType: yn3.Worksheet,
      objectID: R,
      unitID: S,
      strategies: I2,
      share: void 0,
      name: "",
      scope: {
        read: on3.AllCollaborator,
        edit: on3.AllCollaborator
      },
      collaborators: void 0
    }).then(() => {
      be().forEach((y) => {
        const M7 = new y(S, w), E = M7.subType, T = I2.find((P2) => P2.action === E);
        T && o.updatePermissionPoint(M7.id, T.role === Lt3.Editor);
      });
    }) : (R = await t8.create({
      objectType: yn3.Worksheet,
      worksheetObject: {
        unitID: S,
        collaborators: a,
        name: "",
        strategies: I2,
        scope: {
          read: on3.AllCollaborator,
          edit: on3.AllCollaborator
        }
      }
    }), d.executeCommand(sd.id, {
      rule: {
        permissionId: R,
        unitId: S,
        subUnitId: w
      }
    }));
  };
  return (0, import_jsx_runtime4.jsx)(II, { loading: u, children: (0, import_jsx_runtime4.jsxs)("div", { className: ie2("univer-flex univer-flex-col", JS), children: [
    Object.keys(g).map((v2) => {
      const p = g[v2], { text: S, allowed: w } = p;
      return (0, import_jsx_runtime4.jsxs)(
        "div",
        {
          className: "univer-my-1.5 univer-flex univer-h-5 univer-items-center univer-justify-between univer-leading-5",
          children: [
            (0, import_jsx_runtime4.jsx)("div", { children: S }),
            (0, import_jsx_runtime4.jsx)(
              FE,
              {
                defaultChecked: w,
                onChange: () => {
                  m2({
                    ...g,
                    [v2]: {
                      ...p,
                      allowed: !w
                    }
                  });
                }
              }
            )
          ]
        },
        S
      );
    }),
    (0, import_jsx_runtime4.jsxs)(
      "div",
      {
        className: ie2("univer-flex univer-h-9 univer-items-center univer-justify-end univer-gap-2 univer-pt-2", JS),
        children: [
          (0, import_jsx_runtime4.jsx)(
            vr2,
            {
              onClick: () => {
                i.close(ol);
              },
              children: r.t("permission.button.cancel")
            }
          ),
          (0, import_jsx_runtime4.jsx)(
            vr2,
            {
              variant: "primary",
              onClick: () => {
                f2(), i.close(ol);
              },
              children: r.t("permission.button.confirm")
            }
          )
        ]
      }
    )
  ] }) });
};
var MI = () => {
  var d;
  const [r, e] = (0, import_react4.useState)(""), t8 = useDependency(Fn), n = useDependency(ct2), i = useDependency(Vr), o = useObservable(i.userList$, i.userList), s = (d = o == null ? void 0 : o.filter((u) => {
    var h;
    return ((h = u.subject) == null ? void 0 : h.name.toLocaleLowerCase().includes(r.toLocaleLowerCase())) && u.role === Lt3.Editor;
  })) != null ? d : [], [l, a] = (0, import_react4.useState)(i.selectUserList), c = (u) => {
    if ((l == null ? void 0 : l.findIndex((g) => {
      var m2, f2;
      return ((m2 = g.subject) == null ? void 0 : m2.userID) === ((f2 = u.subject) == null ? void 0 : f2.userID);
    })) === -1) {
      const g = { ...u };
      a([...l, g]);
    } else {
      const g = l.filter((m2) => {
        var f2, v2;
        return ((f2 = m2.subject) == null ? void 0 : f2.userID) !== ((v2 = u.subject) == null ? void 0 : v2.userID);
      });
      a(g);
    }
  };
  return (0, import_jsx_runtime4.jsxs)("div", { children: [
    (0, import_jsx_runtime4.jsx)("div", { children: (0, import_jsx_runtime4.jsx)(
      Vx,
      {
        className: "univer-w-full",
        placeholder: t8.t("permission.dialog.search"),
        value: r,
        onChange: (u) => e(u)
      }
    ) }),
    (0, import_jsx_runtime4.jsx)("div", { className: ie2("univer-h-60 univer-overflow-y-auto", pr), children: (s == null ? void 0 : s.length) > 0 ? s == null ? void 0 : s.map((u) => {
      var h, g, m2;
      return (0, import_jsx_runtime4.jsxs)(
        "div",
        {
          className: "univer-my-2 univer-flex univer-items-center univer-rounded-md hover:univer-bg-gray-50",
          onClick: () => c(u),
          children: [
            (0, import_jsx_runtime4.jsx)(YS, { src: (h = u.subject) == null ? void 0 : h.avatar, size: 24 }),
            (0, import_jsx_runtime4.jsx)("div", { className: "univer-ml-1.5 univer-flex-1", children: (g = u.subject) == null ? void 0 : g.name }),
            (l == null ? void 0 : l.findIndex((f2) => {
              var v2, p;
              return ((v2 = f2.subject) == null ? void 0 : v2.userID) === ((p = u.subject) == null ? void 0 : p.userID);
            })) !== -1 && (0, import_jsx_runtime4.jsx)("div", { children: (0, import_jsx_runtime4.jsx)(Dr3, {}) })
          ]
        },
        (m2 = u.subject) == null ? void 0 : m2.userID
      );
    }) : (0, import_jsx_runtime4.jsxs)("div", { className: "univer-flex univer-h-full univer-flex-col univer-items-center", children: [
      (0, import_jsx_runtime4.jsx)(
        "img",
        {
          className: "univer-w-full",
          src: Ip,
          alt: "empty list",
          draggable: false
        }
      ),
      (0, import_jsx_runtime4.jsx)("p", { className: "univer-text-sm univer-text-gray-400", children: t8.t("permission.dialog.userEmpty") })
    ] }) }),
    (0, import_jsx_runtime4.jsx)("div", { className: "univer-h-px univer-w-full univer-bg-gray-200" }),
    (0, import_jsx_runtime4.jsxs)("div", { className: "univer-flex univer-items-center univer-justify-end univer-gap-1 univer-py-2", children: [
      (0, import_jsx_runtime4.jsx)(
        vr2,
        {
          onClick: () => n.close(il2),
          children: t8.t("permission.button.cancel")
        }
      ),
      (0, import_jsx_runtime4.jsx)(
        vr2,
        {
          variant: "primary",
          onClick: () => {
            i.setSelectUserList(l), n.close(il2);
          },
          children: t8.t("permission.button.confirm")
        }
      )
    ] })
  ] });
};
var EI = ({ errorMsg: r }) => {
  const e = useDependency(Fn);
  return (0, import_jsx_runtime4.jsx)("div", { children: (0, import_jsx_runtime4.jsx)("p", { className: "univer-m-0", children: r || e.t("permission.dialog.alertContent") }) });
};
var yp = "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNCIgaGVpZ2h0PSI0IiB2aWV3Qm94PSIwIDAgNCA0IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8bWFzayBpZD0ibWFzazBfNzU5XzExMDgiIHN0eWxlPSJtYXNrLXR5cGU6YWxwaGEiIG1hc2tVbml0cz0idXNlclNwYWNlT25Vc2UiIHg9IjAiIHk9IjAiIHdpZHRoPSI0IiBoZWlnaHQ9IjQiPgo8cmVjdCB3aWR0aD0iNCIgaGVpZ2h0PSI0IiBmaWxsPSIjRDZEOEQ5Ii8+CjwvbWFzaz4KPGcgbWFzaz0idXJsKCNtYXNrMF83NTlfMTEwOCkiPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTS0zLjY0MDAyIDMuNDQxNDFMMi4wNzM5NyAtMi4yNzI1OEwyLjc4MTA4IC0xLjU2NTQ4TC0yLjkzMjkxIDQuMTQ4NTJMLTMuNjQwMDIgMy40NDE0MVoiIGZpbGw9IiNENkQ4REIiLz4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0tMS41MTg2OCA1LjU2Mjc1TDQuMTk1MzEgLTAuMTUxMjQ1TDQuOTAyNDIgMC41NTU4NjJMLTAuODExNTc1IDYuMjY5ODZMLTEuNTE4NjggNS41NjI3NVoiIGZpbGw9IiNENkQ4REIiLz4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0wLjYwMjY1NiA3LjY4NDAzTDYuMzE2NjUgMS45NzAwM0w3LjAyMzc2IDIuNjc3MTRMMS4zMDk3NiA4LjM5MTEzTDAuNjAyNjU2IDcuNjg0MDNaIiBmaWxsPSIjRDZEOERCIi8+CjwvZz4KPC9zdmc+";
var gu2 = "RANGE_PROTECTION_CAN_VIEW_RENDER_EXTENSION_KEY";
var mu3 = "RANGE_PROTECTION_CAN_NOT_VIEW_RENDER_EXTENSION_KEY";
var TI = 25;
var PI = 80;
var Mp = class extends C3 {
  constructor(t8) {
    super();
    _2(this, "_pattern", null);
    _2(this, "_img", new Image());
    _2(this, "renderCache", /* @__PURE__ */ new Set());
    _2(this, "_shadowStrategy", "always");
    this._img.src = yp, t8 && (this._shadowStrategy = t8);
  }
  clearCache() {
    this.renderCache.clear();
  }
  /**
   * Set the shadow strategy for this extension
   * @param strategy The shadow strategy
   */
  setShadowStrategy(t8) {
    this._shadowStrategy = t8, this.clearCache();
  }
  /**
   * Get the current shadow strategy
   */
  getShadowStrategy() {
    return this._shadowStrategy;
  }
  draw(t8, n, i) {
    const { worksheet: o } = i;
    o && (t8.save(), this._pattern || (this._pattern = t8.createPattern(this._img, "repeat")), this.renderCache.clear(), Or.foreach(i.rowColumnSegment, (s, l) => {
      if (!o.getRowVisible(s) || !o.getColVisible(l))
        return;
      const { selectionProtection: a = [] } = o.getCell(s, l) || {};
      this._pattern && (t8.fillStyle = this._pattern, a.forEach((c) => {
        if (c.ruleId && this.shouldRender(c)) {
          if (this.renderCache.has(c.ruleId))
            return;
          this.renderCache.add(c.ruleId), c.ranges.forEach((d) => {
            const u = i.getCellWithCoordByIndex(d.startRow, d.startColumn, false), h = i.getCellWithCoordByIndex(d.endRow, d.endColumn, false);
            t8.fillRect(u.startX, u.startY, h.endX - u.startX, h.endY - u.startY);
          });
        }
      }));
    }), t8.restore());
  }
};
var xI = class extends Mp {
  constructor(t8) {
    super(t8);
    _2(this, "uKey", gu2);
    _2(this, "Z_INDEX", TI);
  }
  shouldRender(t8) {
    return this._shadowStrategy === "none" ? false : this._shadowStrategy === "non-editable" ? (t8 == null ? void 0 : t8[ae.View]) !== false && (t8 == null ? void 0 : t8[ae.Edit]) === false : this._shadowStrategy === "non-viewable" ? (t8 == null ? void 0 : t8[ae.View]) === false : (t8 == null ? void 0 : t8[ae.View]) !== false;
  }
};
var OI = class extends Mp {
  constructor(t8) {
    super(t8);
    _2(this, "uKey", mu3);
    _2(this, "Z_INDEX", PI);
  }
  shouldRender(t8) {
    return this._shadowStrategy === "none" ? false : (t8 == null ? void 0 : t8[ae.View]) === false;
  }
};
var fu2 = "worksheet-protection";
var Lh3 = 25;
var AI = 80;
var HI = class extends C3 {
  constructor(t8) {
    super();
    _2(this, "uKey", fu2);
    _2(this, "Z_INDEX", Lh3);
    _2(this, "_pattern");
    _2(this, "_img", new Image());
    _2(this, "_shadowStrategy", "always");
    this._img.src = yp, t8 && (this._shadowStrategy = t8);
  }
  draw(t8, n, i) {
    const { worksheet: o } = i;
    if (!o)
      return false;
    t8.save(), this._pattern || (this._pattern = t8.createPattern(this._img, "repeat"));
    const { startRow: s, startColumn: l, endRow: a, endColumn: c } = i.rowColumnSegment, d = i.getCellWithCoordByIndex(s, l, false), u = i.getCellWithCoordByIndex(a, c, false), { hasWorksheetRule: h = false, selectionProtection: g = [] } = o.getCell(s, l) || {};
    if (!this._pattern)
      return;
    if (g.length > 0) {
      const f2 = g[0];
      (f2 == null ? void 0 : f2[ae.View]) ? this.setZIndex(Lh3) : this.setZIndex(AI);
    }
    t8.fillStyle = this._pattern;
    let m2 = h;
    if (this._shadowStrategy === "none")
      m2 = false;
    else if (h && g.length > 0) {
      const f2 = g[0];
      this._shadowStrategy === "non-editable" ? m2 = (f2 == null ? void 0 : f2[ae.Edit]) === false : this._shadowStrategy === "non-viewable" && (m2 = (f2 == null ? void 0 : f2[ae.View]) === false);
    }
    m2 && t8.fillRect(d.startX, d.startY, u.endX - d.startX, u.endY - d.startY), t8.restore();
  }
  /**
   * Set the shadow strategy for this extension
   * @param strategy The shadow strategy
   */
  setShadowStrategy(t8) {
    this._shadowStrategy = t8;
  }
  /**
   * Get the current shadow strategy
   */
  getShadowStrategy() {
    return this._shadowStrategy;
  }
  setZIndex(t8) {
    this.Z_INDEX = t8;
  }
};
var VI = Object.getOwnPropertyDescriptor;
var pu2 = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? VI(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var an3 = (r, e) => (t8, n) => e(t8, n, r);
var Vi2 = class extends Ve {
  constructor(r, e) {
    super(), this._injector = r, this._componentManager = e, this._init();
  }
  _init() {
    this._initComponents(), this._initUiPartComponents();
  }
  _initComponents() {
    [
      [Om, qm],
      [Z12, Pa2],
      [G12, ou2],
      [q12, Dr3],
      [Am, iu2],
      [yo2, RI],
      [Pm, MI],
      [xm, yI],
      [Af2, EI]
    ].forEach(([r, e]) => {
      this.disposeWithMe(this._componentManager.register(
        r,
        e
      ));
    });
  }
  _initUiPartComponents() {
    const e = this._injector.get(ic).getConfig(Tt3);
    if (e != null && e.protectedRangeUserSelector) {
      const { component: t8, framework: n } = e.protectedRangeUserSelector;
      this.disposeWithMe(
        this._componentManager.register(ga3, t8, {
          framework: n
        })
      );
    }
  }
};
Vi2 = pu2([
  an3(0, Inject(Injector)),
  an3(1, Inject(S1))
], Vi2);
var yl = class extends Ve {
  constructor(e, t8, n, i, o) {
    super();
    _2(this, "_rangeProtectionCanViewRenderExtension");
    _2(this, "_rangeProtectionCanNotViewRenderExtension");
    this._context = e, this._rangeProtectionRuleModel = t8, this._sheetSkeletonManagerService = n, this._permissionService = i, this._configService = o;
    const s = this._configService.getConfig(Tt3), l = tu2(s == null ? void 0 : s.protectedRangeShadow);
    this._rangeProtectionCanViewRenderExtension = new xI(l), this._rangeProtectionCanNotViewRenderExtension = new OI(l), this._initSkeleton(), this._initRender(), this.disposeWithMe(this._rangeProtectionRuleModel.ruleChange$.subscribe((a) => {
      var c, d;
      ((c = a.oldRule) != null && c.id && this._rangeProtectionCanViewRenderExtension.renderCache.has(a.oldRule.id) || this._rangeProtectionCanViewRenderExtension.renderCache.has(a.rule.id)) && this._rangeProtectionCanViewRenderExtension.clearCache(), ((d = a.oldRule) != null && d.id && this._rangeProtectionCanNotViewRenderExtension.renderCache.has(a.oldRule.id) || this._rangeProtectionCanNotViewRenderExtension.renderCache.has(a.rule.id)) && this._rangeProtectionCanNotViewRenderExtension.clearCache();
    }));
  }
  _initRender() {
    const e = this._context.mainComponent;
    e && (e.getExtensionByKey(gu2) || e.register(this._rangeProtectionCanViewRenderExtension), e.getExtensionByKey(mu3) || e.register(this._rangeProtectionCanNotViewRenderExtension));
  }
  _initSkeleton() {
    const e = () => {
      var t8;
      this._sheetSkeletonManagerService.reCalculate(), (t8 = this._context.mainComponent) == null || t8.makeDirty();
    };
    this.disposeWithMe(merge(
      this._permissionService.permissionPointUpdate$.pipe(throttleTime(300, void 0, { trailing: true })),
      this._rangeProtectionRuleModel.rangeRuleInitStateChange$,
      this._rangeProtectionRuleModel.ruleChange$
    ).pipe().subscribe(e));
  }
};
yl = pu2([
  an3(1, Inject(me)),
  an3(2, Inject(ue)),
  an3(3, eC),
  an3(4, ic)
], yl);
var Ml = class extends Ve {
  constructor(e, t8, n, i, o) {
    super();
    _2(this, "_worksheetProtectionRenderExtension");
    this._context = e, this._renderManagerService = t8, this._sheetSkeletonManagerService = n, this._worksheetProtectionRuleModel = i, this._configService = o;
    const s = this._configService.getConfig(Tt3), l = tu2(s == null ? void 0 : s.protectedRangeShadow);
    this._worksheetProtectionRenderExtension = new HI(l), this._initSkeleton(), l !== "none" && this._initRender();
  }
  _initRender() {
    const e = this._context.unitId, t8 = e && this._renderManagerService.getRenderById(e), n = t8 && t8.mainComponent;
    n && (n.getExtensionByKey(fu2) || n.register(this._worksheetProtectionRenderExtension));
  }
  _initSkeleton() {
    const e = () => {
      var t8;
      this._sheetSkeletonManagerService.reCalculate(), (t8 = this._context.mainComponent) == null || t8.makeDirty();
    };
    this.disposeWithMe(merge(
      this._worksheetProtectionRuleModel.worksheetRuleInitStateChange$
    ).pipe().subscribe(e));
  }
};
Ml = pu2([
  an3(1, Inject(ME)),
  an3(2, Inject(ue)),
  an3(3, Inject(lt)),
  an3(4, Inject(ic))
], Ml);
var NI = Object.getOwnPropertyDescriptor;
var kI = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? NI(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var Sc2 = (r, e) => (t8, n) => e(t8, n, r);
var El = class extends Ve {
  constructor(r, e, t8, n) {
    super(), this._context = r, this._sheetSkeletonManagerService = e, this._sheetClipboardService = t8, this._sheetClipboardController = n, this._initialize();
  }
  _initialize() {
    this.disposeWithMe(
      We(this._sheetSkeletonManagerService.currentSkeleton$.subscribe((r) => {
        if (!(r != null && r.unitId) || !this._sheetClipboardService.getPasteMenuVisible())
          return;
        const e = this._sheetClipboardService.getPasteOptionsCache(), t8 = e == null ? void 0 : e.target.unitId;
        r.unitId === t8 && this._sheetClipboardController.refreshOptionalPaste();
      }))
    );
  }
};
El = kI([
  Sc2(1, Inject(ue)),
  Sc2(2, nn2),
  Sc2(3, Inject(Tr2))
], El);
var DI = Object.getOwnPropertyDescriptor;
var LI = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? DI(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var Cc2 = (r, e) => (t8, n) => e(t8, n, r);
var Tl = class extends Ve {
  constructor(r, e, t8, n) {
    super(), this._context = r, this._formatPainterService = e, this._selectionRenderService = t8, this._commandService = n, this._initialize();
  }
  _initialize() {
    this._bindFormatPainterStatus(), this._commandExecutedListener();
  }
  _commandExecutedListener() {
    this.disposeWithMe(
      this._selectionRenderService.selectionMoveEnd$.subscribe((r) => {
        var e;
        if (this._formatPainterService.getStatus() !== zt4.OFF) {
          const { rangeWithCoord: t8 } = r[r.length - 1];
          this._commandService.executeCommand(wa2.id, {
            unitId: this._context.unitId,
            subUnitId: ((e = this._context.unit.getActiveSheet()) == null ? void 0 : e.getSheetId()) || "",
            range: {
              startRow: t8.startRow,
              startColumn: t8.startColumn,
              endRow: t8.endRow,
              endColumn: t8.endColumn
            }
          }), this._formatPainterService.getStatus() === zt4.ONCE && this._commandService.executeCommand(rs2.id);
        }
      })
    );
  }
  _bindFormatPainterStatus() {
    this.disposeWithMe(
      We(this._formatPainterService.status$.subscribe((r) => {
        const e = this._context.scene;
        e && (r !== zt4.OFF ? e.setDefaultCursor(v1.CELL) : e.setDefaultCursor(v1.DEFAULT));
      }))
    );
  }
};
Tl = LI([
  Cc2(1, Dn2),
  Cc2(2, gt),
  Cc2(3, Ls)
], Tl);
var Jc2 = ((r) => (r[r.NORMAL = 0] = "NORMAL", r[r.HIGHLIGHT = 1] = "HIGHLIGHT", r))(Jc2 || {});
var WI = "rgba(0, 0, 0, 0.15)";
var In3 = "rgb(0, 0, 0)";
var ys2 = "rgb(255, 255, 255, 1)";
var BI = class extends x3 {
  constructor(t8, n) {
    super(t8, n);
    _2(this, "_size", 12);
    _2(this, "_iconRatio", 0.4);
    _2(this, "_mode", 0);
    this.setShapeProps(n);
  }
  setShapeProps(t8) {
    t8 != null && t8.size && (this._size = t8.size), t8 != null && t8.mode && (this._mode = t8.mode), this.transformByState({
      width: this._size,
      height: this._size
    });
  }
  _draw(t8) {
    this._mode === 1 && I12.drawWith(t8, {
      width: this._size,
      height: this._size,
      radius: this._size,
      fill: WI
    });
    const n = this._size * 0.5 * this._iconRatio, i = Math.PI / 180 * 60, o = n * Math.sin(i), s = n * Math.cos(i);
    O3.drawWith(t8, {
      pointsGroup: [
        [
          { x: -o + this._size / 2, y: -s + this._size / 2 },
          { x: o + this._size / 2, y: -s + this._size / 2 },
          { x: this._size / 2, y: n + this._size / 2 }
        ]
      ],
      // left: this.left,
      // top: this.top,
      fill: In3
    });
  }
};
var FI = Object.getOwnPropertyDescriptor;
var UI = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? FI(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var Ms3 = (r, e) => (t8, n) => e(t8, n, r);
var XI = "__SpreadsheetHeaderMenuSHAPEControllerShape__";
var zI = "__SpreadsheetHeaderMenuMAINControllerShape__";
var jI = "rgba(0, 0, 0, 0.1)";
var Pl = class extends Ve {
  constructor(e, t8, n, i, o) {
    super();
    _2(this, "_hoverRect");
    _2(this, "_hoverMenu");
    _2(this, "_currentColumn", Number.POSITIVE_INFINITY);
    _2(this, "_headerPointerSubs");
    _2(this, "_colHeaderPointerSubs");
    this._context = e, this._sheetSkeletonManagerService = t8, this._contextMenuService = n, this._commandService = i, this._selectionManagerService = o, this._initialize();
  }
  dispose() {
    var e, t8, n;
    (e = this._hoverRect) == null || e.dispose(), (t8 = this._hoverMenu) == null || t8.dispose(), (n = this._headerPointerSubs) == null || n.unsubscribe(), this._headerPointerSubs = null;
  }
  _initialize() {
    const e = this._context.scene;
    this._hoverRect = new I12(XI, {
      fill: jI,
      evented: false
    }), this._hoverMenu = new BI(zI, { zIndex: 100, visible: false }), e.addObjects([this._hoverRect, this._hoverMenu], rr4), this._initialHover(
      0
      /* ROW */
    ), this._initialHover(
      1
      /* COLUMN */
    ), this._initialHoverMenu();
  }
  // eslint-disable-next-line max-lines-per-function
  _initialHover(e = 0) {
    var u, h, g;
    const t8 = this._context.components.get(Ye3.COLUMN), n = this._context.components.get(Ye3.ROW), i = e === 0 ? n : t8, o = (m2) => {
      var y, M7, E;
      const f2 = (y = this._sheetSkeletonManagerService.getCurrentParam()) == null ? void 0 : y.skeleton;
      if (f2 == null)
        return;
      const { rowHeaderWidth: v2, columnHeaderHeight: p } = f2, { startX: S, startY: w, endX: C, endY: I2, column: R } = Vn3(
        m2.offsetX,
        m2.offsetY,
        this._context.scene,
        f2
      );
      if (e === 0)
        (M7 = this._hoverRect) == null || M7.transformByState({
          width: v2,
          height: I2 - w,
          left: 0,
          top: w
        });
      else {
        if (this._currentColumn = R, (E = this._hoverRect) == null || E.transformByState({
          width: C - S,
          height: p,
          left: S,
          top: 0
        }), this._hoverMenu == null)
          return;
        if (C - S < p * 2) {
          this._hoverMenu.hide();
          return;
        }
        const T = p * 0.8;
        this._hoverMenu.transformByState({
          left: C - p,
          top: p / 2 - T / 2
        }), this._hoverMenu.setShapeProps({ size: T }), this._hoverMenu.show();
      }
    }, s = () => {
      var m2;
      (m2 = this._hoverRect) == null || m2.show();
    }, l = () => {
      var m2, f2;
      (m2 = this._hoverRect) == null || m2.hide(), (f2 = this._hoverMenu) == null || f2.hide();
    };
    this._headerPointerSubs = new Subscription();
    const a = i.onPointerMove$.subscribeEvent(o), c = i.onPointerEnter$.subscribeEvent(s), d = i.onPointerLeave$.subscribeEvent(l);
    (u = this._headerPointerSubs) == null || u.add(a), (h = this._headerPointerSubs) == null || h.add(c), (g = this._headerPointerSubs) == null || g.add(d);
  }
  _initialHoverMenu() {
    this._hoverMenu != null && (this._hoverMenu.onPointerEnter$.subscribeEvent(() => {
      this._hoverMenu != null && (this._hoverMenu.setProps({
        mode: Jc2.HIGHLIGHT,
        visible: true
      }), this._context.scene.setCursor(v1.POINTER));
    }), this._hoverMenu.onPointerLeave$.subscribeEvent(() => {
      this._hoverMenu != null && (this._hoverMenu.setProps({
        mode: Jc2.NORMAL,
        visible: false
      }), this._context.scene.resetCursor());
    }), this._hoverMenu.onPointerDown$.subscribeEvent((e) => {
      var o;
      const t8 = this._currentColumn, n = (o = this._selectionManagerService.getCurrentSelections()) == null ? void 0 : o.map((s) => s.range);
      if (!!!(n != null && n.filter((s) => s.rangeType === ge.COLUMN).find((s) => {
        const { startColumn: l, endColumn: a } = s;
        return t8 >= l && t8 <= a;
      }))) {
        const s = this._getSelectionOnColumn(t8);
        this._commandService.syncExecuteCommand(ie3.id, s);
      }
      e.stopPropagation(), e.preventDefault(), this._contextMenuService.triggerContextMenu(e, Y1.COL_HEADER);
    }));
  }
  _getSelectionOnColumn(e) {
    const t8 = this._context.unit, n = t8.getActiveSheet();
    if (!n)
      throw new Error("No active worksheet");
    return {
      unitId: t8.getUnitId(),
      subUnitId: n.getSheetId(),
      selections: [
        {
          range: {
            startRow: 0,
            startColumn: e,
            endRow: n.getRowCount() - 1,
            endColumn: e,
            rangeType: ge.COLUMN
          },
          primary: {
            startRow: 0,
            startColumn: e,
            endRow: 0,
            endColumn: e,
            actualRow: 0,
            actualColumn: e,
            isMerged: false,
            isMergedMainCell: false
          },
          style: null
        }
      ]
    };
  }
};
Pl = UI([
  Ms3(1, Inject(ue)),
  Ms3(2, c32),
  Ms3(3, Ls),
  Ms3(4, Inject(z))
], Pl);
var $c = ((r) => (r[r.ROW = 0] = "ROW", r[r.COLUMN = 1] = "COLUMN", r))($c || {});
var ao4 = 12;
var YI = 0.4;
var Wh3 = class extends x3 {
  constructor(t8, n, i) {
    super(t8, n);
    _2(this, "_size", ao4);
    _2(this, "_iconRatio", YI);
    _2(this, "_hovered", true);
    _2(this, "_hasPrevious", true);
    _2(this, "_hasNext", true);
    _2(this, "_unhideType");
    n && this.setShapeProps(n), this.onPointerEnter$.subscribeEvent(() => this.setShapeProps({ hovered: true })), this.onPointerLeave$.subscribeEvent(() => this.setShapeProps({ hovered: false })), this.onPointerDown$.subscribeEvent(() => i == null ? void 0 : i());
  }
  setShapeProps(t8) {
    t8.type !== void 0 && (this._unhideType = t8.type), t8.hovered !== void 0 && (this._hovered = t8.hovered), t8.hasPrevious !== void 0 && (this._hasPrevious = t8.hasPrevious), t8.hasNext !== void 0 && (this._hasNext = t8.hasNext), this.transformByState({
      width: this._size * (this._unhideType === 1 ? 2 : 1),
      height: this._size * (this._unhideType === 0 ? 2 : 1)
    });
  }
  _draw(t8) {
    this._unhideType === 0 ? this._drawOnRow(t8) : this._drawOnCol(t8);
  }
  _drawOnRow(t8) {
    this._hovered && (!this._hasNext || !this._hasPrevious ? I12.drawWith(t8, {
      width: this._size,
      height: this._size,
      stroke: In3,
      fill: ys2
    }) : I12.drawWith(t8, {
      width: this._size,
      height: 2 * this._size,
      stroke: In3,
      fill: ys2
    }));
    const n = this._size * 0.5 * this._iconRatio, i = Math.PI / 3, o = n * Math.cos(i), s = n * Math.sin(i);
    if (this._hasPrevious && O3.drawWith(t8, {
      pointsGroup: [
        [
          { x: this._size / 2, y: this._size / 2 - s },
          { x: this._size / 2 - s, y: this._size / 2 + o },
          { x: this._size / 2 + s, y: this._size / 2 + o }
        ]
      ],
      fill: In3
    }), this._hasNext) {
      const l = this._hasPrevious ? 3 : 1;
      O3.drawWith(t8, {
        pointsGroup: [
          [
            { x: this._size / 2, y: this._size * l / 2 + s },
            { x: this._size / 2 - s, y: this._size * l / 2 - o },
            { x: this._size / 2 + s, y: this._size * l / 2 - o }
          ]
        ],
        fill: In3
      });
    }
  }
  /**
   *
   * @param ctx
   */
  _drawOnCol(t8) {
    this._hovered && (!this._hasNext || !this._hasPrevious ? I12.drawWith(t8, {
      width: this._size,
      height: this._size,
      stroke: In3,
      fill: ys2
    }) : I12.drawWith(t8, {
      width: 2 * this._size,
      height: this._size,
      stroke: In3,
      fill: ys2
    }));
    const n = this._size * 0.5 * this._iconRatio, i = Math.PI / 3, o = n * Math.cos(i), s = n * Math.sin(i);
    if (this._hasPrevious && O3.drawWith(t8, {
      pointsGroup: [
        [
          { x: -o + this._size / 2, y: this._size / 2 },
          { x: this._size / 2 + s, y: this._size / 2 - s },
          { x: this._size / 2 + s, y: this._size / 2 + s }
        ]
      ],
      fill: In3
    }), this._hasNext) {
      const l = this._hasPrevious ? 3 : 1;
      O3.drawWith(t8, {
        pointsGroup: [
          [
            { x: o + this._size * l / 2, y: this._size / 2 },
            { x: -s + this._size * l / 2, y: this._size / 2 - s },
            { x: -s + this._size * l / 2, y: this._size / 2 + s }
          ]
        ],
        fill: In3
      });
    }
  }
};
var ZI = Object.getOwnPropertyDescriptor;
var GI = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? ZI(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var Bh2 = (r, e) => (t8, n) => e(t8, n, r);
var Fh2 = "__SpreadsheetHeaderUnhideSHAPEControllerShape__";
var xl = class extends h1 {
  constructor(e, t8, n) {
    super();
    _2(this, "_shapes", { cols: [], rows: [] });
    this._context = e, this._sheetSkeletonManagerService = t8, this._commandService = n, this._init();
  }
  get _workbook() {
    return this._context.unit;
  }
  dispose() {
    super.dispose(), this._clearShapes();
  }
  _init() {
    let e = "";
    this._context.unit.activeSheet$.pipe(takeUntil(this.dispose$)).subscribe((t8) => {
      if (this._clearShapes(), !t8) {
        e = "";
        return;
      }
      e = t8.getSheetId(), this._update(this._workbook, t8);
    }), this.disposeWithMe(
      this._sheetSkeletonManagerService.currentSkeleton$.subscribe((t8) => {
        if (t8) {
          const { unitId: n, sheetId: i } = t8;
          if (n === this._workbook.getUnitId() && i === e) {
            const o = this._workbook.getSheetBySheetId(i);
            o && this._update(this._workbook, o);
          }
        }
      })
    );
  }
  _update(e, t8) {
    var h;
    const n = (h = this._sheetSkeletonManagerService.getSkeletonParam(t8.getSheetId())) == null ? void 0 : h.skeleton;
    if (!n) return;
    const i = t8.getHiddenRows(), o = t8.getHiddenCols(), s = this._getSheetObject(), { scene: l } = s, a = t8.getRowCount(), c = i.map((g) => {
      const { startRow: m2, endRow: f2 } = g, v2 = lh2(m2, 0, l, n), p = m2 !== 0, S = f2 !== a - 1;
      return new Wh3(
        Fh2,
        {
          type: $c.ROW,
          hovered: false,
          hasPrevious: p,
          hasNext: S,
          top: v2.startY - (p ? ao4 : 0),
          left: v2.startX - ao4
        },
        () => this._commandService.executeCommand(
          fn2.id,
          {
            unitId: e.getUnitId(),
            subUnitId: t8.getSheetId(),
            ranges: [g]
          }
        )
      );
    }), d = t8.getColumnCount(), u = o.map((g) => {
      const { startColumn: m2, endColumn: f2 } = g, v2 = lh2(0, m2, l, n), p = m2 !== 0, S = f2 !== d - 1;
      return new Wh3(
        Fh2,
        {
          type: $c.COLUMN,
          hovered: false,
          hasPrevious: p,
          hasNext: S,
          top: 20 - ao4,
          left: v2.startX - (p ? ao4 : 0)
        },
        () => this._commandService.executeCommand(
          mn.id,
          {
            unitId: e.getUnitId(),
            subUnitId: t8.getSheetId(),
            ranges: [g]
          }
        )
      );
    });
    l.addObjects(u, Bu3), l.addObjects(c, Bu3), this._clearShapes(), this._shapes = { cols: u, rows: c };
  }
  _clearShapes() {
    this._shapes.cols.forEach((e) => e.dispose()), this._shapes.rows.forEach((e) => e.dispose()), this._shapes = { cols: [], rows: [] };
  }
  _getSheetObject() {
    return en4(this._workbook, this._context);
  }
};
xl = GI([
  Bh2(1, Inject(ue)),
  Bh2(2, Ls)
], xl);
var qI = Object.getOwnPropertyDescriptor;
var QI = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? qI(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var jr2 = (r, e) => (t8, n) => e(t8, n, r);
var KI = [Ut4.id, Wn4.id];
var ed2 = class extends Ve {
  constructor(r, e, t8, n, i, o, s) {
    super(), this._context = r, this._sheetSkeletonManagerService = e, this._commandService = t8, this._renderManagerService = n, this._selectionManagerService = i, this._scrollManagerService = o, this._univerInstanceService = s, this._init();
  }
  scrollToRange(r) {
    let { endRow: e, endColumn: t8, startColumn: n, startRow: i } = r;
    const o = this._getViewportBounding();
    if (r.rangeType === ge.ROW ? (n = 0, t8 = 0) : r.rangeType === ge.COLUMN && (i = 0, e = 0), o) {
      const s = o.startRow > e ? i : e, l = o.startColumn > t8 ? n : t8;
      return this._scrollToCell(s, l);
    } else
      return this._scrollToCell(i, n);
  }
  _init() {
    this._initCommandListener(), this._initScrollEventListener(), this._initPointerScrollEvent(), this._initSkeletonListener();
  }
  _initCommandListener() {
    this.disposeWithMe(
      this._commandService.onCommandExecuted((r) => {
        if (KI.includes(r.id))
          this._scrollToSelection();
        else if (r.id === Cd.id) {
          const e = r.params.range;
          this.scrollToRange(e);
        } else if (r.id === Gt3.id) {
          const e = r.params;
          this._scrollToSelectionForExpand(e);
        }
      })
    );
  }
  _scrollToSelectionForExpand(r) {
    setTimeout(() => {
      const e = this._selectionManagerService.getCurrentLastSelection();
      if (e == null)
        return;
      const { startRow: t8, startColumn: n, endRow: i, endColumn: o } = e.range, s = this._getViewportBounding();
      if (s == null)
        return;
      const { startRow: l, startColumn: a, endRow: c, endColumn: d } = s;
      let u = 0, h = 0;
      t8 > l ? u = i : i < c ? u = t8 : u = l, n > a ? h = o : o < d ? h = n : h = a, r.direction === Cm.DOWN ? u = i : r.direction === Cm.UP ? u = t8 : r.direction === Cm.RIGHT ? h = o : r.direction === Cm.LEFT && (h = n), this._scrollToCell(u, h);
    }, 0);
  }
  _getFreeze() {
    var e;
    const r = (e = this._sheetSkeletonManagerService.getCurrentParam()) == null ? void 0 : e.skeleton.getWorksheetConfig();
    if (r != null)
      return r.freeze;
  }
  // eslint-disable-next-line max-lines-per-function
  _initScrollEventListener() {
    const { scene: r } = this._context;
    if (r == null) return;
    const e = r.getViewport(k2.VIEW_MAIN);
    e && (this.disposeWithMe(
      We(
        // wheel event --> set-scroll.command('sheet.operation.set-scroll') --> scroll.operation.ts -->
        // scrollManagerService.setScrollInfoAndEmitEvent --->  scrollManagerService.setScrollInfo(raw value, may be negative) &&
        // _notifyCurrentScrollInfo
        this._scrollManagerService.rawScrollInfo$.subscribe((t8) => {
          var h;
          if (t8 == null) {
            e.scrollToViewportPos({
              viewportScrollX: 0,
              viewportScrollY: 0
            });
            return;
          }
          const n = (h = this._sheetSkeletonManagerService.getCurrentParam()) == null ? void 0 : h.skeleton;
          if (!n) return;
          const { sheetViewStartRow: i, sheetViewStartColumn: o, offsetX: s, offsetY: l } = t8, { startX: a, startY: c } = n.getCellWithCoordByIndex(
            i,
            o,
            false
          ), d = a + s, u = c + l;
          e.scrollToViewportPos({ viewportScrollX: d, viewportScrollY: u });
        })
      )
    ), this.disposeWithMe(
      e.onScrollAfter$.subscribeEvent((t8) => {
        var m2;
        if (!t8) return;
        const n = (m2 = this._sheetSkeletonManagerService.getCurrentParam()) == null ? void 0 : m2.skeleton;
        if (n == null) return;
        const i = this._getSheetObject();
        if (n == null || i == null) return;
        const { viewportScrollX: o, viewportScrollY: s, scrollX: l, scrollY: a } = t8, { row: c, column: d, rowOffset: u, columnOffset: h } = n.getOffsetRelativeToRowCol(
          o,
          s
        ), g = {
          sheetViewStartRow: c,
          sheetViewStartColumn: d,
          offsetX: h,
          offsetY: u,
          viewportScrollX: o,
          viewportScrollY: s,
          scrollX: l,
          scrollY: a
        };
        this._scrollManagerService.setValidScrollStateToCurrSheet(g), this._scrollManagerService.validViewportScrollInfo$.next({
          ...g,
          scrollX: l,
          scrollY: a,
          viewportScrollX: o,
          viewportScrollY: s
        });
      })
    ), this.disposeWithMe(
      e.onScrollByBar$.subscribeEvent((t8) => {
        var h;
        const n = (h = this._sheetSkeletonManagerService.getCurrentParam()) == null ? void 0 : h.skeleton;
        if (n == null || t8.isTrigger === false)
          return;
        const i = this._getSheetObject();
        if (n == null || i == null)
          return;
        const { viewportScrollX: o = 0, viewportScrollY: s = 0 } = t8, l = this._getFreeze(), { row: a, column: c, rowOffset: d, columnOffset: u } = n.getOffsetRelativeToRowCol(
          o,
          s
        );
        this._commandService.executeCommand(mn3.id, {
          sheetViewStartRow: a + ((l == null ? void 0 : l.ySplit) || 0),
          sheetViewStartColumn: c + ((l == null ? void 0 : l.xSplit) || 0),
          offsetX: u,
          offsetY: d
        });
      })
    ));
  }
  _initSkeletonListener() {
    this.disposeWithMe(We(
      this._sheetSkeletonManagerService.currentSkeletonBefore$.subscribe((r) => {
        if (r == null)
          return;
        const e = { unitId: r.unitId, sheetId: r.sheetId };
        this._scrollManagerService.setSearchParam(e);
        const t8 = this._getSheetObject();
        if (!t8) return;
        const i = t8.scene.getViewport(k2.VIEW_MAIN), o = this._scrollManagerService.getScrollStateByParam(e), { viewportScrollX: s, viewportScrollY: l } = this._scrollManagerService.calcViewportScrollFromRowColOffset(o);
        i && (o ? (i.viewportScrollX = s, i.viewportScrollY = l) : (i.viewportScrollX = 0, i.viewportScrollY = 0), this._updateSceneSize(r));
      })
    ));
  }
  /**
   * for mobile
   */
  // eslint-disable-next-line max-lines-per-function
  _initPointerScrollEvent() {
    const r = this._getSheetObject();
    if (!r) return;
    const e = this._scrollManagerService, t8 = r.scene, n = r.spreadsheet, i = t8.getViewport(k2.VIEW_MAIN), o = { x: 0, y: 0 };
    let s = false;
    const l = { x: 0, y: 0 }, a = 0.95;
    let c = null;
    const d = () => {
      if (!i) return;
      l.x *= a, l.y *= a, o.x += l.x, o.y += l.y;
      const h = l.x, g = l.y;
      (g !== 0 || h !== 0) && this._commandService.executeCommand(To2.id, { offsetY: g, offsetX: h }), Math.abs(l.x) > 1 || Math.abs(l.y) > 1 ? c = requestAnimationFrame(d) : c = null;
    }, u = () => {
      cancelAnimationFrame(c), c = null;
    };
    n.onPointerDown$.subscribeEvent((h, g) => {
      u(), i && (o.x = h.offsetX, o.y = h.offsetY, s = true, g.stopPropagation());
    }), n.onPointerMove$.subscribeEvent((h, g) => {
      if (!s || !i) return;
      const m2 = h, f2 = -(m2.offsetX - o.x), v2 = -(m2.offsetY - o.y);
      l.x = -(m2.offsetX - o.x), l.y = -(m2.offsetY - o.y);
      const p = f2, S = v2;
      (f2 !== 0 || v2 !== 0) && (S !== 0 || p !== 0) && this._commandService.executeCommand(To2.id, { offsetY: S, offsetX: p }), e.getCurrentScrollState(), o.x = m2.offsetX, o.y = m2.offsetY, g.stopPropagation();
    }), n.onPointerUp$.subscribeEvent((h) => {
      s = false, c = requestAnimationFrame(d);
    }), n.onPointerLeave$.subscribeEvent(() => {
      s = false;
    }), n.onPointerOut$.subscribeEvent(() => {
      s = false;
    }), t8.onPointerOut$.subscribeEvent(() => {
      s = false;
    }), t8.onPointerCancel$.subscribeEvent(() => {
      s = false;
    });
  }
  _updateSceneSize(r) {
    var u;
    if (r == null)
      return;
    const { unitId: e } = this._context, { skeleton: t8 } = r, n = (u = this._renderManagerService.getRenderById(e)) == null ? void 0 : u.scene;
    if (t8 == null || n == null)
      return;
    const { rowTotalHeight: i, columnTotalWidth: o, rowHeaderWidthAndMarginLeft: s, columnHeaderHeightAndMarginTop: l } = t8, c = this._context.unit.getActiveSheet();
    if (!c) return;
    const d = c.getZoomRatio() || 1;
    n == null || n.setScaleValueOnly(d, d), n == null || n.transformByState({
      width: s + o,
      height: l + i
    });
  }
  _getSheetObject() {
    return en4(this._context.unit, this._context);
  }
  _scrollToSelectionByDirection(r) {
    const e = this._getViewportBounding();
    if (e == null)
      return false;
    const {
      startRow: t8,
      startColumn: n,
      endRow: i,
      endColumn: o
    } = e;
    let s = 0, l = 0;
    const { startRow: a, startColumn: c, endRow: d, endColumn: u } = r;
    a >= t8 && (s = d), d <= i && (s = a), c >= n && (l = u), u <= o && (l = c), this._scrollToCell(s, l);
  }
  _scrollToSelection(r = true) {
    const e = this._selectionManagerService.getCurrentLastSelection();
    if (e == null)
      return;
    const { startRow: t8, startColumn: n, actualRow: i, actualColumn: o } = e.primary, s = r ? i : t8, l = r ? o : n;
    this._scrollToCell(s, l);
  }
  _getViewportBounding() {
    var n, i;
    const r = (n = this._getSheetObject()) == null ? void 0 : n.scene;
    if (r == null)
      return;
    const e = r.getViewport(k2.VIEW_MAIN);
    if (e == null)
      return;
    const t8 = (i = this._sheetSkeletonManagerService.getCurrentParam()) == null ? void 0 : i.skeleton;
    if (t8 != null)
      return t8.getRangeByViewport(e.calcViewportInfo());
  }
  // eslint-disable-next-line max-lines-per-function, complexity
  _scrollToCell(r, e) {
    var I2, R, y, M7;
    const { rowHeightAccumulation: t8, columnWidthAccumulation: n } = (R = (I2 = this._sheetSkeletonManagerService.getCurrentParam()) == null ? void 0 : I2.skeleton) != null ? R : {};
    if (t8 == null || n == null) return false;
    const i = (y = this._getSheetObject()) == null ? void 0 : y.scene;
    if (i == null) return false;
    const o = i.getViewport(k2.VIEW_MAIN);
    if (o == null || ((M7 = this._sheetSkeletonManagerService.getCurrentParam()) == null ? void 0 : M7.skeleton) == null) return false;
    const l = this._context.unit.getActiveSheet();
    if (!l) return false;
    const {
      startColumn: a,
      startRow: c,
      ySplit: d,
      xSplit: u
    } = l.getFreeze(), h = this._getViewportBounding();
    if (h == null) return false;
    const {
      startRow: g,
      startColumn: m2,
      endRow: f2,
      endColumn: v2
    } = h;
    let p, S;
    if (r >= c && e >= a - u && (r <= g && (p = r), r >= f2)) {
      const E = t8[r] - o.height;
      for (let T = g; T <= r; T++)
        if (t8[T] >= E) {
          p = T + 1;
          break;
        }
    }
    if (e >= a && r >= c - d && (e <= m2 && (S = e), e >= v2)) {
      const E = n[e] - o.width;
      for (let T = m2; T <= e; T++)
        if (n[T] >= E) {
          S = T + 1;
          break;
        }
    }
    if (p === void 0 && S === void 0) return false;
    const { offsetX: w, offsetY: C } = this._scrollManagerService.getCurrentScrollState() || {};
    return this._commandService.syncExecuteCommand(mn3.id, {
      sheetViewStartRow: p,
      sheetViewStartColumn: S,
      offsetX: S === void 0 ? w : 0,
      offsetY: p === void 0 ? C : 0
    });
  }
};
ed2 = QI([
  jr2(1, Inject(ue)),
  jr2(2, Ls),
  jr2(3, ME),
  jr2(4, Inject(z)),
  jr2(5, Inject(Et2)),
  jr2(6, vr)
], ed2);
var JI = Object.getOwnPropertyDescriptor;
var $I = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? JI(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var Uh3 = (r, e) => (t8, n) => e(t8, n, r);
var Ol2 = class extends Ve {
  constructor(r, e, t8) {
    super(), this._context = r, this._sheetSkeletonManagerService = e, this._renderManagerService = t8, this.disposeWithMe(this._context.unit.sheetDisposed$.subscribe((n) => {
      this._sheetSkeletonManagerService.disposeSkeleton(n.getSheetId());
    })), this._sheetSkeletonManagerService.currentSkeleton$.subscribe((n) => {
      this._updateSceneSize(n);
    });
  }
  _updateSceneSize(r) {
    var d;
    if (r == null)
      return;
    const { unitId: e } = this._context, { skeleton: t8 } = r, n = (d = this._renderManagerService.getRenderById(e)) == null ? void 0 : d.scene;
    if (t8 == null || n == null)
      return;
    const { rowTotalHeight: i, columnTotalWidth: o, rowHeaderWidthAndMarginLeft: s, columnHeaderHeightAndMarginTop: l } = t8;
    this._context.unit.getActiveSheet() && (n == null || n.transformByState({
      width: s + o,
      height: l + i
    }));
  }
};
Ol2 = $I([
  Uh3(1, Inject(ue)),
  Uh3(2, ME)
], Ol2);
var ey = Object.getOwnPropertyDescriptor;
var ty = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? ey(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var Xh2 = (r, e) => (t8, n) => e(t8, n, r);
createIdentifier("sheets-ui.services.auto-height");
function ny(r, e) {
  const t8 = [], n = [...r];
  let i = e;
  for (; n.length > 0; ) {
    const o = n.shift();
    if (!o)
      break;
    const s = o.endRow - o.startRow + 1;
    if (s > i) {
      t8.push({
        ...o,
        startRow: o.startRow,
        endRow: o.startRow + i - 1
      }), n.unshift({
        ...o,
        startRow: o.startRow + i
      });
      break;
    } else
      t8.push(o), i -= s;
  }
  return { result: t8, lasts: n };
}
var ry = 500;
var Al2 = class extends Ve {
  constructor(e, t8, n) {
    super();
    _2(this, "_autoHeightTasks", []);
    _2(this, "_calculateLoopId", null);
    this._context = e, this._sheetSkeletonManagerService = t8, this._commandService = n, this._initMarkDirty();
  }
  _initMarkDirty() {
    this.disposeWithMe(
      this._commandService.onCommandExecuted((e) => {
        if (e.id === gd.id) {
          const t8 = e.params, { unitId: n, subUnitId: i, ranges: o, id: s } = t8;
          if (n !== this._context.unitId)
            return;
          this.startAutoHeightTask({
            ranges: o,
            sheetId: i,
            id: s,
            // 10s timeout
            maxTime: 1e4
          });
        }
        if (e.id === md.id) {
          const t8 = e.params, { unitId: n, id: i } = t8;
          if (n !== this._context.unitId)
            return;
          this.cancelTask(i);
        }
      })
    );
  }
  _loopTask(e) {
    const t8 = e.skeleton;
    let n = [], i = [];
    if (e.maxTime && e.maxTime + e.startTime <= Date.now())
      n = e.ranges;
    else {
      const l = ny(e.ranges, ry);
      n = l.result, i = l.lasts;
    }
    const s = t8.calculateAutoHeightInRange(n).filter((l) => {
      const { row: a, autoHeight: c } = l;
      return !(!c || t8.getRowHeight(a) === c);
    });
    if (i.length && (e.ranges = i, this._autoHeightTasks.unshift(e)), s.length) {
      const l = {
        unitId: this._context.unitId,
        subUnitId: e.sheetId,
        rowsAutoHeightInfo: s
      };
      this._commandService.syncExecuteCommand(Xo.id, l);
    }
  }
  _calculateLoop(e) {
    for (; this._autoHeightTasks.length && !(e.timeRemaining() <= 0); ) {
      const t8 = this._autoHeightTasks.shift();
      if (!t8) {
        this._calculateLoopId = null;
        return;
      }
      this._loopTask(t8);
    }
    this._calculateLoopId = requestIdleCallback((t8) => {
      this._calculateLoop(t8);
    });
  }
  _initialCalculateLoop() {
    this._calculateLoopId === null && (this._calculateLoopId = requestIdleCallback((e) => {
      this._calculateLoop(e);
    }));
  }
  startAutoHeightTask(e) {
    const t8 = this._sheetSkeletonManagerService.getSkeleton(e.sheetId);
    if (!t8)
      return;
    e.ranges = En.mergeRanges(e.ranges.map((i) => ({
      ...i,
      startColumn: 0,
      endColumn: 0
    })));
    const n = En.subtractMulti(
      e.ranges,
      this._autoHeightTasks.filter((i) => i.sheetId === e.sheetId).map((i) => i.ranges).flat()
    );
    n.length && (this._autoHeightTasks.push({
      ...e,
      startTime: Date.now(),
      skeleton: t8,
      ranges: n
    }), this._initialCalculateLoop());
  }
  cancelTask(e) {
    const t8 = this._autoHeightTasks.findIndex((n) => n.id === e);
    t8 !== -1 && this._autoHeightTasks.splice(t8, 1);
  }
};
Al2 = ty([
  Xh2(1, Inject(ue)),
  Xh2(2, Ls)
], Al2);
function Ep(r) {
  const { popup: e } = r, { extraProps: t8 } = e, { options: n, defaultValue: i, onChange: o } = t8, [s, l] = (0, import_react4.useState)(i != null ? i : []);
  return (0, import_jsx_runtime4.jsx)(
    oE,
    {
      options: n,
      value: s,
      onChange: o
    }
  );
}
Ep.componentKey = "sheets.dropdown.cascader";
function Tp(r) {
  const { popup: e } = r, { extraProps: t8 } = e, { defaultValue: n, onChange: i } = t8;
  return (0, import_jsx_runtime4.jsx)(
    sE,
    {
      value: n,
      onChange: i
    }
  );
}
Tp.componentKey = "sheets.dropdown.color";
function Pp(r) {
  const { popup: e } = r, { extraProps: t8 } = e, { hideFn: n, patternType: i, defaultValue: o, onChange: s, showTime: l } = t8, [a, c] = (0, import_react4.useState)(o), d = (0, import_react4.useMemo)(() => i !== "time" ? tn() : tn("1900-01-01 00:00:00"), []), u = a && a.isValid() ? a : d, h = useDependency(Fn), g = async () => {
    if (!u) return;
    await (s == null ? void 0 : s(u)) && n();
  };
  return (0, import_jsx_runtime4.jsxs)(
    "div",
    {
      className: "univer-rounded univer-bg-white univer-p-2 univer-shadow-lg dark:!univer-bg-black",
      children: [
        i === "time" ? (0, import_jsx_runtime4.jsx)(
          Zh,
          {
            value: u.toDate(),
            onValueChange: (m2) => {
              c(tn(m2));
            }
          }
        ) : (0, import_jsx_runtime4.jsx)(
          Xa,
          {
            value: u.toDate(),
            showTime: l != null ? l : i === "datetime",
            onValueChange: (m2) => {
              c(tn(m2));
            }
          }
        ),
        (0, import_jsx_runtime4.jsx)(
          "footer",
          {
            className: ie2("univer-mt-2 univer-flex univer-justify-end univer-pt-2", JS),
            children: (0, import_jsx_runtime4.jsx)(vr2, { size: "small", variant: "primary", onClick: g, disabled: !u || !u.isValid(), children: h.t("dataValidation.alert.ok") })
          }
        )
      ]
    }
  );
}
Pp.componentKey = "sheets.dropdown.date";
function iy(r) {
  return r.filter(Boolean).join(",");
}
function oy(r) {
  return r.split(",").filter(Boolean);
}
function sy(r) {
  const { value: e, onChange: t8, multiple: n, options: i, title: o, onEdit: s, filter: l, style: a, location: c, showEdit: d } = r, u = useDependency(Fn), h = l == null ? void 0 : l.toLowerCase(), { row: g, col: m2, unitId: f2, subUnitId: v2 } = c, p = i.filter((C) => h ? C.label.toLowerCase().includes(h) : true), S = useDependency(qn), w = (0, import_react4.useMemo)(() => S.permissionCheckWithRanges(
    {
      workbookTypes: [Pe],
      rangeTypes: [Le2],
      worksheetTypes: [Ve2]
    },
    [{ startColumn: m2, startRow: g, endColumn: m2, endRow: g }],
    f2,
    v2
  ), [S, m2, g, f2, v2]);
  return (0, import_jsx_runtime4.jsxs)(
    "div",
    {
      "data-u-comp": "sheets-dropdown-list",
      className: ie2("univer-box-border univer-rounded-lg univer-bg-white univer-py-1 univer-text-gray-900 univer-shadow dark:!univer-bg-black dark:!univer-text-white", kt2),
      style: a,
      children: [
        (0, import_jsx_runtime4.jsx)("div", { className: "univer-px-3.5 univer-py-1 univer-pt-2 univer-text-xs", children: o }),
        (0, import_jsx_runtime4.jsx)(
          "div",
          {
            className: ie2("univer-flex univer-max-h-52 univer-flex-col univer-gap-1 univer-overflow-y-auto univer-px-2 univer-py-1", pr),
            children: p.map((C, I2) => {
              const R = e.indexOf(C.value) > -1, y = () => {
                let T;
                R ? T = new Set(e.filter((H3) => H3 !== C.value)) : T = new Set(n ? [...e, C.value] : [C.value]);
                const P2 = [];
                i.forEach((H3) => {
                  T.has(H3.value) && P2.push(H3.value);
                }), t8(P2);
              }, M7 = C.label.toLocaleLowerCase().indexOf(h), E = new bt(C.color).isDark();
              return (0, import_jsx_runtime4.jsxs)(
                "div",
                {
                  className: "univer-flex univer-cursor-pointer univer-flex-row univer-items-center univer-justify-between univer-rounded-md univer-px-1.5 univer-py-1 hover:univer-bg-gray-50 dark:hover:!univer-bg-gray-700",
                  onClick: y,
                  children: [
                    (0, import_jsx_runtime4.jsx)(
                      "div",
                      {
                        className: ie2("univer-inline-flex univer-h-4 univer-w-fit univer-items-center univer-truncate univer-rounded-full univer-px-1.5 univer-text-xs", {
                          "univer-text-gray-900": !E,
                          "univer-text-white": E
                        }),
                        style: { background: C.color },
                        children: h && C.label.toLowerCase().includes(h) ? (0, import_jsx_runtime4.jsxs)(import_jsx_runtime4.Fragment, { children: [
                          (0, import_jsx_runtime4.jsx)("span", { children: C.label.substring(0, M7) }),
                          (0, import_jsx_runtime4.jsx)("span", { className: "univer-font-semibold", children: C.label.substring(M7, M7 + h.length) }),
                          (0, import_jsx_runtime4.jsx)("span", { children: C.label.substring(M7 + h.length) })
                        ] }) : C.label
                      }
                    ),
                    (0, import_jsx_runtime4.jsx)(
                      "div",
                      {
                        className: "univer-ml-3 univer-h-4 univer-w-4 univer-flex-shrink-0 univer-flex-grow-0 univer-text-base univer-text-primary-500",
                        children: R && (0, import_jsx_runtime4.jsx)(Dr3, { className: "univer-text-primary-600" })
                      }
                    )
                  ]
                },
                I2
              );
            })
          },
          l
        ),
        d && w && (0, import_jsx_runtime4.jsx)("div", { className: ie2("univer-box-border univer-px-2 univer-pt-1", JS), children: (0, import_jsx_runtime4.jsx)(
          "a",
          {
            className: "univer-block univer-cursor-pointer univer-rounded univer-px-1.5 univer-py-1 univer-text-xs hover:univer-bg-gray-100 dark:hover:!univer-bg-gray-800",
            onClick: s,
            children: u.t("dataValidation.list.edit")
          }
        ) })
      ]
    }
  );
}
function xp(r) {
  var I2, R, y, M7;
  const { popup: { extraProps: e } } = r, { location: t8, hideFn: n, onChange: i, onEdit: o, options: s, defaultValue: l, multiple: a, showEdit: c } = e, { worksheet: d } = t8, [u, h] = (0, import_react4.useState)(""), g = useDependency(Ls), m2 = useDependency(Fn), [f2, v2] = (0, import_react4.useState)(l), p = useDependency(qe5), S = useDependency(vr), w = ot2.useContext(), C = ((R = (I2 = w.current) == null ? void 0 : I2.right) != null ? R : 0) - ((M7 = (y = w.current) == null ? void 0 : y.left) != null ? M7 : 0);
  return (0, import_react4.useEffect)(() => {
    const E = g.onCommandExecuted((T) => {
      var P2, H3;
      if (T.id === M.id) {
        const A = T.params, { unitId: x7 } = A, V2 = S.getUnit(x7, we.UNIVER_DOC);
        if (!V2 || !p.isVisible().visible) return;
        const D2 = Je.transform.getPlainText((H3 = (P2 = V2.getSnapshot().body) == null ? void 0 : P2.dataStream) != null ? H3 : "");
        h(D2);
      }
    });
    return () => {
      E.dispose();
    };
  }, [g, p, S]), d ? (0, import_jsx_runtime4.jsx)(
    sy,
    {
      style: { minWidth: C, maxWidth: Math.max(C, 200) },
      title: a ? m2.t("dataValidation.listMultiple.dropdown") : m2.t("dataValidation.list.dropdown"),
      value: oy(f2 != null ? f2 : ""),
      multiple: a,
      onChange: async (E) => {
        const T = iy(E);
        v2(T), await (i == null ? void 0 : i(E)) !== false && n();
      },
      options: s,
      onEdit: o,
      filter: u,
      location: t8,
      showEdit: c
    }
  ) : null;
}
xp.componentKey = "sheets.dropdown.list";
var zh3 = {
  datepicker: Pp,
  list: xp,
  color: Tp,
  cascader: Ep
};
var ly = Object.getOwnPropertyDescriptor;
var ay = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? ly(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var Es3 = (r, e) => (t8, n) => e(t8, n, r);
var Op = createIdentifier("ICellDropdownManagerService");
var Hl = class extends Ve {
  constructor(r, e, t8, n) {
    super(), this._canvasPopupManagerService = r, this._zenZoneService = e, this._renderManagerService = t8, this._componentManager = n, Object.values(zh3).forEach((i) => {
      this.disposeWithMe(this._componentManager.register(i.componentKey, i));
    });
  }
  showDropdown(r) {
    const { location: e, onHide: t8, closeOnOutSide: n = true } = r, { row: i, col: o, unitId: s, subUnitId: l } = e;
    if (this._zenZoneService.visible)
      throw new Error("[SheetCellDropdownManagerService]: cannot show dropdown when zen mode is visible");
    const a = zh3[r.type], c = this._renderManagerService.getRenderById(Ul), d = new ao(), u = this._canvasPopupManagerService.attachPopupToCell(
      i,
      o,
      {
        componentKey: a.componentKey,
        onClickOutside: () => {
          n && d.dispose();
        },
        offset: [0, 3],
        excludeOutside: [c == null ? void 0 : c.engine.getCanvasElement()].filter(Boolean),
        extraProps: {
          ...r,
          ...r.props,
          hideFn: () => {
            d.dispose();
          }
        }
      },
      s,
      l
    );
    if (!u)
      throw new Error("[SheetCellDropdownManagerService]: cannot show dropdown");
    return d.add(u), d.add({
      dispose: () => {
        t8 == null || t8();
      }
    }), d;
  }
};
Hl = ay([
  Es3(0, Inject(yi3)),
  Es3(1, st2),
  Es3(2, ME),
  Es3(3, Inject(S1))
], Hl);
var cy = qC("PRINTING_RANGE");
var dy = qC("PRINTING_COMPONENT_COLLECT");
var uy = qC("PRINTING_DOM_COLLECT");
var Ap = class extends Ve {
  constructor() {
    super();
    _2(this, "_printComponentMap", /* @__PURE__ */ new Map());
    _2(this, "interceptor", new ZC({
      PRINTING_RANGE: cy,
      PRINTING_COMPONENT_COLLECT: dy,
      PRINTING_DOM_COLLECT: uy
    }));
    this.disposeWithMe(this.interceptor.intercept(this.interceptor.getInterceptPoints().PRINTING_RANGE, {
      priority: -1,
      handler: (t8) => t8
    })), this.disposeWithMe(this.interceptor.intercept(this.interceptor.getInterceptPoints().PRINTING_COMPONENT_COLLECT, {
      priority: -1,
      handler: (t8) => t8
    })), this.disposeWithMe(this.interceptor.intercept(this.interceptor.getInterceptPoints().PRINTING_DOM_COLLECT, {
      priority: -1,
      handler: (t8) => t8
    }));
  }
  registerPrintComponent(t8, n) {
    this._printComponentMap.set(t8, n);
  }
  getPrintComponent(t8) {
    return this._printComponentMap.get(t8);
  }
};
var hy = class extends Wd2 {
  constructor(t8, n, i, o) {
    super(t8, n, i, o);
    _2(this, "_fillControlTopLeft");
    _2(this, "_fillControlBottomRight");
    _2(this, "_rangeType", ge.NORMAL);
    this._scene = t8, this._zIndex = n, this._themeService = i, this._rangeType = (o == null ? void 0 : o.rangeType) || ge.NORMAL, this.initControlPoints();
  }
  initControlPoints() {
    const t8 = this.currentStyle, n = t8.expandCornerSize || 0, i = (t8.expandCornerSize || 0) / 4, o = t8.autofillStrokeWidth || 0, s = t8.stroke, l = t8.autofillStroke, a = this.zIndex;
    this._fillControlTopLeft = new I12(Fc2.fillTopLeft + a, {
      zIndex: a + 2,
      width: n,
      height: n,
      radius: n / 2,
      visualWidth: i,
      visualHeight: i,
      strokeWidth: o
    }), this._fillControlBottomRight = new I12(Fc2.fillBottomRight + a, {
      zIndex: a + 2,
      width: n,
      height: n,
      radius: n / 2,
      visualHeight: i,
      visualWidth: i,
      strokeWidth: o
    });
    const c = {
      fill: s,
      stroke: l,
      strokeScaleEnabled: false
    };
    this._fillControlTopLeft.setProps({ ...c }), this._fillControlBottomRight.setProps({ ...c });
    const d = [
      this._fillControlTopLeft,
      this._fillControlBottomRight
    ];
    switch (this._rangeType) {
      case ge.ROW:
        this.rowHeaderGroup.addObjects(...d);
        break;
      case ge.COLUMN:
        this.columnHeaderGroup.addObjects(...d);
        break;
      case ge.NORMAL:
        this.selectionShapeGroup.addObjects(...d);
    }
    this.getScene().addObjects(d, Qs2);
  }
  get fillControlTopLeft() {
    return this._fillControlTopLeft;
  }
  set fillControlTopLeft(t8) {
    this._fillControlTopLeft = t8;
  }
  get fillControlBottomRight() {
    return this._fillControlBottomRight;
  }
  set fillControlBottomRight(t8) {
    this._fillControlBottomRight = t8;
  }
  get rangeType() {
    return this._rangeType;
  }
  set rangeType(t8) {
    this._rangeType = t8;
  }
  dispose() {
    var t8, n;
    (t8 = this._fillControlBottomRight) == null || t8.dispose(), (n = this._fillControlTopLeft) == null || n.dispose(), super.dispose();
  }
  _updateLayoutOfSelectionControl(t8) {
    var o, s;
    super._updateLayoutOfSelectionControl(t8);
    const n = this.currentStyle;
    t8 == null && (t8 = n);
    const {
      widgets: i = n.widgets
    } = t8;
    if (this.currentStyle = t8, this._enableAutoFill === true && !super._hasWidgets(i)) {
      const { viewportScrollX: l, viewportScrollY: a } = this.getViewportMainScrollInfo(), { endX: c, endY: d } = this.selectionModel;
      this.transformControlPoint(l, a, c, d), this.fillControlTopLeft.show(), this.fillControlBottomRight.show();
    } else
      (o = this.fillControlTopLeft) == null || o.hide(), (s = this.fillControlBottomRight) == null || s.hide();
  }
  getViewportMainScrollInfo() {
    const t8 = this.getScene().getViewport(k2.VIEW_MAIN);
    return {
      viewportScrollX: (t8 == null ? void 0 : t8.viewportScrollX) || 0,
      viewportScrollY: (t8 == null ? void 0 : t8.viewportScrollY) || 0,
      width: (t8 == null ? void 0 : t8.width) || 0,
      height: (t8 == null ? void 0 : t8.height) || 0
    };
  }
  /**
   * Mainly for row & col selection control point position. update control point position by when scrolling.
   * @param viewportScrollX viewportScrollX
   * @param viewportScrollY
   * @param sheetContentWidth
   * @param sheetContentHeight max sheet content height, for very short sheet, control pointer shoud not out of sheet
   */
  transformControlPoint(t8 = 0, n = 0, i = 0, o = 0) {
    const s = this.currentStyle, l = this.selectionModel.rangeType, a = s.expandCornerSize, { startX: c, startY: d, endX: u, endY: h } = this.selectionModel, g = this.getViewportMainScrollInfo(), m2 = g.width, f2 = g.height;
    switch (l) {
      case ge.NORMAL:
        this.fillControlTopLeft.transformByState({
          left: -a / 2,
          top: -a / 2
        }), this.fillControlBottomRight.transformByState({
          left: u - c - a / 2,
          top: h - d - a / 2
        });
        break;
      case ge.ROW:
        {
          const v2 = Math.min(m2 / 2 + t8, i), p = -a / 2 + v2;
          this.fillControlTopLeft.transformByState({
            left: p,
            top: -a / 2
          }), this.fillControlBottomRight.transformByState({
            left: p,
            top: -a / 2 + h - d
          });
        }
        break;
      case ge.COLUMN:
        {
          const v2 = Math.min(+f2 / 2 + n, o), p = -a / 2 + v2;
          this.fillControlTopLeft.transformByState({
            left: -a / 2,
            top: p
          }), this.fillControlBottomRight.transformByState({
            left: -a / 2 + u - c,
            top: p
          });
        }
        break;
      default:
        console.error("unknown range type");
    }
  }
};
var gy = Object.getOwnPropertyDescriptor;
var my = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? gy(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var Rn2 = (r, e) => (t8, n) => e(t8, n, r);
var td2 = class extends mm {
  constructor(e, t8, n, i, o, s, l, a, c, d) {
    super(
      t8,
      n,
      i,
      s,
      c
    );
    _2(this, "_workbookSelections");
    _2(this, "_renderDisposable", null);
    _2(this, "_expandingSelection", false);
    _2(this, "_selectionControls", []);
    _2(this, "expandingControlMode", "bottom-right");
    this._context = e, this._logService = l, this._commandService = a, this._contextService = c, this._scrollManagerService = d, this._workbookSelections = o.getWorkbookSelections(this._context.unitId), this._init();
  }
  _init() {
    const e = this._getSheetObject();
    this._initEventListeners(e), this._initSelectionChangeListener(), this._initSkeletonChangeListener(), this._initUserActionSyncListener(), this._updateControlPointWhenScrolling();
  }
  _initSkeletonChangeListener() {
    this.disposeWithMe(this._sheetSkeletonManagerService.currentSkeleton$.subscribe((e) => {
      if (e == null) {
        this._logService.error("[SelectionRenderService]: should not receive null!");
        return;
      }
      const t8 = this._context.unitId, { sheetId: n, skeleton: i } = e, { scene: o } = this._context, s = o.getViewport(k2.VIEW_MAIN);
      this._changeRuntime(i, o, s), this._workbookSelections.getCurrentLastSelection() || this._commandService.syncExecuteCommand(ie3.id, {
        unitId: t8,
        subUnitId: n,
        selections: [Bd2(i)]
      });
    }));
  }
  _initSelectionChangeListener() {
  }
  _initEventListeners(e) {
    const { spreadsheetRowHeader: t8, spreadsheetColumnHeader: n, spreadsheet: i, spreadsheetLeftTopPlaceholder: o } = e, { scene: s } = this._context;
    this._initSpreadsheetEvent(e), this.disposeWithMe(
      t8 == null ? void 0 : t8.onPointerUp$.subscribeEvent((l, a) => {
        if (this._normalSelectionDisabled()) return;
        const c = this._sheetSkeletonManagerService.getCurrentParam().skeleton, { row: d } = Vn3(l.offsetX, l.offsetY, s, c);
        Tf2(this._workbookSelections.getCurrentSelections(), d) || (this.createNewSelection(l, (i.zIndex || 1) + 1, ge.ROW, this._getActiveViewport(l)), this._selectionMoveEnd$.next(this.getSelectionDataWithStyle()));
      })
    ), this.disposeWithMe(
      n == null ? void 0 : n.onPointerUp$.subscribeEvent((l, a) => {
        if (this._normalSelectionDisabled()) return;
        const c = this._sheetSkeletonManagerService.getCurrentParam().skeleton, { column: d } = Vn3(l.offsetX, l.offsetY, s, c);
        Pf(this._workbookSelections.getCurrentSelections(), d) || (this.createNewSelection(l, (i.zIndex || 1) + 1, ge.COLUMN, this._getActiveViewport(l)), this._selectionMoveEnd$.next(this.getSelectionDataWithStyle()));
      })
    ), this.disposeWithMe(o == null ? void 0 : o.onPointerUp$.subscribeEvent((l, a) => {
      if (this._normalSelectionDisabled()) return;
      this._reset();
      const c = this._sheetSkeletonManagerService.getCurrentParam().skeleton, d = fm(c);
      this._addSelectionControlByModelData(d), this.refreshSelectionMoveStart(), a.stopPropagation(), this._selectionMoveEnd$.next(this.getSelectionDataWithStyle());
    }));
  }
  _initSpreadsheetEvent(e) {
    const { spreadsheet: t8 } = e;
    let n;
    const i = 500, o = { x: 0, y: 0 }, s = () => {
      clearTimeout(n);
    }, l = (d, u) => {
      this.createNewSelection(
        d,
        t8.zIndex + 1,
        ge.NORMAL,
        this._getActiveViewport(d)
      ), u && this._selectionMoveEnd$.next(this.getSelectionDataWithStyle());
    };
    t8 == null || t8.onPointerMove$.subscribeEvent((d, u) => {
      (Math.abs(d.offsetX - o.x) > 10 || Math.abs(d.offsetY - o.y) > 10) && s();
    });
    const a = t8 == null ? void 0 : t8.onPointerDown$.subscribeEvent((d, u) => {
      o.x = d.offsetX, o.y = d.offsetY, n = setTimeout(() => {
        l(d, true);
      }, i), u.stopPropagation();
    }), c = t8 == null ? void 0 : t8.onPointerUp$.subscribeEvent((d, u) => {
      if (this._normalSelectionDisabled()) return;
      clearTimeout(n);
      const h = 10;
      Math.abs(d.offsetX - o.x) > h || Math.abs(d.offsetY - o.y) > h || (l(d, false), u.stopPropagation());
    });
    this.disposeWithMe(We(a)), this.disposeWithMe(We(c));
  }
  _initUserActionSyncListener() {
    this.disposeWithMe(this.selectionMoveStart$.subscribe((e) => this._updateSelections(e, we2.MOVE_START))), this.disposeWithMe(this.selectionMoving$.subscribe((e) => this._updateSelections(e, we2.MOVING))), this.disposeWithMe(this._contextService.subscribeContextValue$($u).pipe(startWith(false), distinctUntilChanged()).subscribe((e) => {
      var t8;
      e ? ((t8 = this._renderDisposable) == null || t8.dispose(), this._renderDisposable = null, this._reset()) : this._renderDisposable = We(
        this.selectionMoveEnd$.subscribe((n) => this._updateSelections(n, we2.MOVE_END))
      );
    }));
  }
  _updateSelections(e, t8) {
    const n = this._context.unit, i = n.getUnitId(), o = n.getActiveSheet().getSheetId();
    e.length !== 0 && this._commandService.executeCommand(ie3.id, {
      unitId: i,
      subUnitId: o,
      type: t8,
      selections: e.map(
        (s) => vh(s)
      )
    });
  }
  /**
   * invoked when pointerup or long press on spreadsheet, or pointerdown on row&col
   * then move curr selection to cell at cursor
   * Main purpose to create a new selection, or update curr selection to a new range.
   * @param evt
   * @param _zIndex
   * @param rangeType
   * @param viewport
   */
  createNewSelection(e, t8 = 0, n = ge.NORMAL, i) {
    this._rangeType = n;
    const o = this._skeleton, s = this._scene;
    if (!s || !o)
      return;
    i && (this._activeViewport = i);
    const { offsetX: l, offsetY: a } = e, c = s.getCoordRelativeToViewport(U.FromArray([l, a])), { x: d, y: u } = c;
    this._startViewportPosX = d, this._startViewportPosY = u;
    const h = s.getScrollXYInfoByViewport(c), { scaleX: g, scaleY: m2 } = s.getAncestorScale(), f2 = this._skeleton.getCellByOffset(d, u, g, m2, h);
    if (!f2) return;
    switch (n) {
      case ge.NORMAL:
        break;
      case ge.ROW:
        f2.startColumn = 0, f2.endColumn = this._skeleton.getColumnCount() - 1;
        break;
      case ge.COLUMN:
        f2.startRow = 0, f2.endRow = this._skeleton.getRowCount() - 1;
        break;
      case ge.ALL:
        f2.startRow = 0, f2.startColumn = 0, f2.endRow = this._skeleton.getRowCount() - 1, f2.endColumn = this._skeleton.getColumnCount() - 1;
    }
    const v2 = { range: f2, primary: f2, style: null };
    v2.range.rangeType = n;
    const p = Wt4(v2, this._skeleton);
    this._startRangeWhenPointerDown = { ...p.rangeWithCoord };
    let S = this.getActiveSelectionControl();
    const w = { ...p.rangeWithCoord };
    for (const C of this.getSelectionControls())
      if (C.model.isEqual(w)) {
        S = C;
        break;
      }
    (S == null ? void 0 : S.model.rangeType) !== n ? (this._clearAllSelectionControls(), S = this.newSelectionControl(s, o, v2)) : S.updateRangeBySelectionWithCoord(p), this._selectionMoveStart$.next(this.getSelectionDataWithStyle()), this._clearUpdatingListeners(), this._expandingSelection = false;
  }
  /**
   * Not same as PC version,
   * new selection control for mobile do one more thing: bind event for two control points.
   * @param scene
   * @param rangeType
   */
  newSelectionControl(e, t8, n) {
    const i = this.getSelectionControls(), { rowHeaderWidth: o, columnHeaderHeight: s } = t8, l = n.range.rangeType, a = new hy(e, i.length, this._themeService, {
      highlightHeader: this._highlightHeader,
      rowHeaderWidth: o,
      columnHeaderHeight: s,
      rangeType: l
    }), c = Wt4(n, t8);
    a.updateRangeBySelectionWithCoord(c), this._selectionControls.push(a);
    const { expandingModeForTopLeft: d, expandingModeForBottomRight: u } = (() => {
      switch (l) {
        case ge.NORMAL:
          return {
            expandingModeForTopLeft: "top-left",
            expandingModeForBottomRight: "bottom-right"
            /* BOTTOM_RIGHT */
          };
        case ge.ROW:
          return {
            expandingModeForTopLeft: "top",
            expandingModeForBottomRight: "bottom"
            /* BOTTOM */
          };
        case ge.COLUMN:
          return {
            expandingModeForTopLeft: "left",
            expandingModeForBottomRight: "right"
            /* RIGHT */
          };
        case ge.ALL:
          return {
            expandingModeForTopLeft: "top-left",
            expandingModeForBottomRight: "bottom-right"
            /* BOTTOM_RIGHT */
          };
        default:
          return {
            expandingModeForTopLeft: "top-left",
            expandingModeForBottomRight: "bottom-right"
            /* BOTTOM_RIGHT */
          };
      }
    })();
    return a.fillControlTopLeft.onPointerDown$.subscribeEvent((h) => {
      this._expandingSelection = true, this.expandingControlMode = d, this._selectionMoveStart$.next(this.getSelectionDataWithStyle()), this._fillControlPointerDownHandler(
        h,
        l,
        this._activeViewport
      );
    }), a.fillControlBottomRight.onPointerDown$.subscribeEvent((h) => {
      this._expandingSelection = true, this.expandingControlMode = u, this._selectionMoveStart$.next(this.getSelectionDataWithStyle()), this._fillControlPointerDownHandler(
        h,
        l,
        this._activeViewport
      );
    }), (l === ge.ROW || l === ge.COLUMN) && !e.getViewport(k2.VIEW_MAIN), a;
  }
  // same as PC
  _getActiveViewport(e) {
    const t8 = this._getSheetObject();
    return t8 == null ? void 0 : t8.scene.getActiveViewportByCoord(U.FromArray([e.offsetX, e.offsetY]));
  }
  // same as PC
  _getSheetObject() {
    return en4(this._context.unit, this._context);
  }
  // same as PC
  _normalSelectionDisabled() {
    return this._contextService.getContextValue($u);
  }
  getSelectionControls() {
    return this._selectionControls;
  }
  _fillControlPointerDownHandler(e, t8 = ge.NORMAL, n, i = bE.ALL) {
    var u, h, g;
    const o = this._skeleton, s = this._scene;
    if (!s || !o)
      return;
    n && (this._activeViewport = n);
    const l = s.getViewport(k2.VIEW_MAIN), a = this.getActiveSelectionControl();
    if (!a) return;
    this._changeCurrCellWhenControlPointerDown(), this._selectionMoveStart$.next(this.getSelectionDataWithStyle()), this._clearUpdatingListeners(), this._addEndingListeners(), this._scrollTimer = y0.create(this._scene, i), this._scrollTimer.startScroll((u = l == null ? void 0 : l.left) != null ? u : 0, (h = l == null ? void 0 : l.top) != null ? h : 0, l), (g = s.getTransformer()) == null || g.clearSelectedObjects();
    const c = s.getCoordRelativeToViewport(U.FromArray([e.offsetX, e.offsetY]));
    this._setupPointerMoveListener(l, a, t8, i, c.x, c.y);
    const d = this._shortcutService.forceEscape();
    this._scenePointerUpSub = s.onPointerUp$.subscribeEvent((m2) => {
      this.endSelection(), this._expandingSelection = false, this.expandingControlMode = "bottom-right", this._selectionMoveEnd$.next(this.getSelectionDataWithStyle()), d.dispose();
    });
  }
  _changeCurrCellWhenControlPointerDown() {
    const e = this.getActiveSelectionControl(), t8 = this._skeleton;
    let n;
    const { startRow: i, startColumn: o, endRow: s, endColumn: l } = e.model;
    switch (this.expandingControlMode) {
      case "top-left":
        n = t8.getCellWithCoordByIndex(s, l);
        break;
      case "bottom-right":
        n = t8.getCellWithCoordByIndex(i, o);
        break;
      case "left":
        n = t8.getCellWithCoordByIndex(i, l), n.isMerged = false, n.isMergedMainCell = false;
        break;
      case "right":
        n = t8.getCellWithCoordByIndex(i, o), n.isMerged = false, n.isMergedMainCell = false;
        break;
      case "top":
        n = t8.getCellWithCoordByIndex(s, o), n.isMerged = false, n.isMergedMainCell = false;
        break;
      case "bottom":
        n = t8.getCellWithCoordByIndex(i, o), n.isMerged = false, n.isMergedMainCell = false;
        break;
      default:
        n = t8.getCellWithCoordByIndex(i, o);
    }
    return e.updateCurrCell(n), n;
  }
  /**
   * Not same as _moving in PC (base selection render service)
   * The diff is
   * In base version, new selection is determined by the cursor cell and _startRangeWhenPointerDown
   *
   * In Mobile version, new selection is determined by cursor cell and current of activeSelectionControl.model
   */
  _movingHandler(e, t8, n, i) {
    var M7, E, T, P2, H3, A, x7, V2, D2, X2, B, j, G7;
    this._rangeType = i;
    const o = this._skeleton, s = this._scene, l = {
      startRow: n.model.startRow,
      endRow: n.model.endRow,
      startColumn: n.model.startColumn,
      endColumn: n.model.endColumn
    }, a = s.getViewport(k2.VIEW_MAIN), c = (M7 = this._getViewportByCell(l.endRow, l.endColumn)) != null ? M7 : a, d = s.getScrollXYInfoByViewport(
      U.FromArray([this._startViewportPosX, this._startViewportPosY]),
      c
    ), { scaleX: u, scaleY: h } = s.getAncestorScale();
    i === ge.ROW ? e = Number.POSITIVE_INFINITY : i === ge.COLUMN && (t8 = Number.POSITIVE_INFINITY);
    const g = this._getSelectionWithCoordByOffset(e, t8, u, h, d);
    if (!g)
      return false;
    const { rangeWithCoord: m2 } = g, f2 = n.model.currentCell, v2 = (E = f2 == null ? void 0 : f2.mergeInfo.startRow) != null ? E : -1, p = (T = f2 == null ? void 0 : f2.mergeInfo.endRow) != null ? T : -1, S = (P2 = f2 == null ? void 0 : f2.mergeInfo.startColumn) != null ? P2 : -1, w = (H3 = f2 == null ? void 0 : f2.mergeInfo.endColumn) != null ? H3 : -1;
    let C = {
      startRow: Math.min(m2.startRow, v2),
      startColumn: Math.min(m2.startColumn, S),
      endRow: Math.max(m2.endRow, p),
      endColumn: Math.max(m2.endColumn, w)
    };
    if (i === ge.NORMAL ? C = o.expandRangeByMerge(C) : i === ge.COLUMN ? C = {
      startRow: Math.min(m2.startRow, (A = f2 == null ? void 0 : f2.actualRow) != null ? A : -1),
      startColumn: Math.min(m2.startColumn, (x7 = f2 == null ? void 0 : f2.actualColumn) != null ? x7 : -1),
      endRow: Math.max(m2.endRow, (V2 = f2 == null ? void 0 : f2.actualRow) != null ? V2 : -1),
      endColumn: Math.max(m2.endColumn, (D2 = f2 == null ? void 0 : f2.actualColumn) != null ? D2 : -1)
    } : i === ge.ROW && (C = {
      startRow: Math.min(m2.startRow, (X2 = f2 == null ? void 0 : f2.actualRow) != null ? X2 : -1),
      startColumn: Math.min(m2.startColumn, (B = f2 == null ? void 0 : f2.actualColumn) != null ? B : -1),
      endRow: Math.max(m2.endRow, (j = f2 == null ? void 0 : f2.actualRow) != null ? j : -1),
      endColumn: Math.max(m2.endColumn, (G7 = f2 == null ? void 0 : f2.actualColumn) != null ? G7 : -1)
    }), !C)
      return false;
    const R = Wt4({ range: C, style: null, primary: null }, o);
    (l.startRow !== C.startRow || l.startColumn !== C.startColumn || l.endRow !== C.endRow || l.endColumn !== C.endColumn) && n && (n.updateRangeBySelectionWithCoord(R), this._selectionMoving$.next(this.getSelectionDataWithStyle()));
  }
  _updateControlPointWhenScrolling() {
    const { scene: e } = this._context;
    if (!e.getViewport(k2.VIEW_MAIN)) return;
    const n = this._scrollManagerService.validViewportScrollInfo$.subscribe((i) => {
      var h;
      if (i == null)
        return;
      const { viewportScrollX: o, viewportScrollY: s } = i, l = this.getActiveSelectionControl();
      if (l == null)
        return;
      const a = (h = this._sheetSkeletonManagerService.getCurrentParam()) == null ? void 0 : h.skeleton, c = a == null ? void 0 : a.rowTotalHeight, d = a == null ? void 0 : a.columnTotalWidth, u = l.rangeType;
      u === ge.COLUMN ? l.transformControlPoint(0, s, d, c) : u === ge.ROW && l.transformControlPoint(o, 0, d, c);
    });
    this.disposeWithMe(We(n));
  }
};
td2 = my([
  Rn2(1, Inject(Injector)),
  Rn2(2, Inject(Gi)),
  Rn2(3, ye3),
  Rn2(4, Inject(z)),
  Rn2(5, Inject(ue)),
  Rn2(6, yt),
  Rn2(7, Ls),
  Rn2(8, Nr),
  Rn2(9, Inject(Et2))
], td2);
var fy = Object.defineProperty;
var py = Object.getOwnPropertyDescriptor;
var vy = (r, e, t8) => e in r ? fy(r, e, { enumerable: true, configurable: true, writable: true, value: t8 }) : r[e] = t8;
var Sy = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? py(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var no2 = (r, e) => (t8, n) => e(t8, n, r);
var Hp = (r, e, t8) => vy(r, typeof e != "symbol" ? e + "" : e, t8);
var Vl = class extends Ol {
  /** @ignore */
  constructor(r = dl, e, t8, n, i, o) {
    super(), this._config = r, this._injector = e, this._renderManagerService = t8, this._configService = n, this._univerInstanceService = i, this._componentManager = o;
    const { menu: s, ...l } = oo(
      {},
      dl,
      this._config
    );
    if (l.protectedRangeUserSelector) {
      const { component: a, framework: c } = l.protectedRangeUserSelector;
      this.disposeWithMe(
        this._componentManager.register(
          ga3,
          a,
          {
            framework: c
          }
        )
      );
    }
    s && this._configService.setConfig("menu", s, { merge: true }), this._configService.setConfig(Tt3, { ...l });
  }
  onStarting() {
    GC(this._injector, nC([
      [Si3],
      [qe5, { useClass: ll }],
      [nn2, { useClass: rl2 }],
      [Nr3, { useClass: Vm2 }],
      [Dn2, { useClass: sl2 }],
      [ls3, { useClass: Bm }],
      [as2, { useClass: tf2 }],
      [Fu, { useClass: fo2 }],
      [Hr, { useClass: el }],
      [Ap],
      [xa2, { useClass: nf2 }],
      [Wi3, { useClass: tl2 }],
      [Mr3],
      [Oo2],
      [yi3],
      [Mi3],
      [Do3],
      [Kd2],
      [Op, { useClass: Hl }],
      [Ao3],
      // controllers
      [Ei2],
      [hi3],
      [Ir2],
      [yr3],
      [ir3],
      [bl],
      [Er2],
      [bi3],
      [Oi2],
      [Pi3],
      [xi2],
      [Ti2],
      [Ri2],
      // permission
      [Rr3],
      [Ai3],
      [Vr],
      [Hi3],
      [Ii3],
      [Vi2]
    ], this._config.override));
  }
  onReady() {
    this._config.disableAutoFocus || this._initAutoFocus(), GC(this._injector, [
      [Tr2]
    ]), this._registerRenderBasics(), zc(this._injector, [
      [bl],
      [ir3],
      [Ei2],
      [Ii3],
      [Ai3]
    ]);
  }
  onRendered() {
    this._registerRenderModules(), zc(this._injector, [
      [Vi2],
      [Rr3],
      [Tr2],
      [yr3],
      [Pi3],
      [Er2],
      [hi3],
      [Ir2],
      [xi2],
      [Ti2],
      [Ri2]
    ]);
  }
  onSteady() {
    zc(this._injector, [
      [Oi2],
      [bi3],
      [Hi3]
    ]);
  }
  _registerRenderBasics() {
    [
      [ue],
      [Ol2],
      [fl],
      [gt, { useClass: td2 }],
      [Et2],
      [Al2]
    ].forEach((r) => {
      this.disposeWithMe(this._renderManagerService.registerRenderModule(we.UNIVER_SHEET, r));
    });
  }
  // We have to let render basics get bootstrapped before. Because some render controllers relies on
  // a correct skeleton when they get loaded.
  _registerRenderModules() {
    var n;
    const r = [
      [No3],
      [xl],
      [ko3],
      // TODO: Should not register these two Controllers at the same time
      [Ci3],
      [ed2],
      [Vo3],
      [Po3],
      [Tl],
      [El],
      [vl],
      [Sl],
      [wl],
      [hl],
      [cl],
      [Cl],
      [al],
      // [SheetContextMenuMobileRenderController],
      [_l],
      // editor
      [Ho3],
      // permission
      [Rl],
      [Il],
      [yl],
      [Ml]
    ], e = this._configService.getConfig(_e2);
    ((n = e == null ? void 0 : e.contextMenu) != null ? n : true) && r.push([Pl]), r.forEach((i) => {
      this.disposeWithMe(this._renderManagerService.registerRenderModule(we.UNIVER_SHEET, i));
    });
  }
  _initAutoFocus() {
    const r = this._univerInstanceService;
    this.disposeWithMe(r.getCurrentTypeOfUnit$(we.UNIVER_SHEET).pipe(filter((e) => !!e)).subscribe((e) => r.focusUnit(e.getUnitId())));
  }
};
Hp(Vl, "pluginName", "SHEET_UI_PLUGIN");
Hp(Vl, "type", we.UNIVER_SHEET);
Vl = Sy([
  qR(ss, F3),
  no2(1, Inject(Injector)),
  no2(2, ME),
  no2(3, ic),
  no2(4, vr),
  no2(5, Inject(S1))
], Vl);
var Cy = Object.getOwnPropertyDescriptor;
var wy = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? Cy(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var wc = (r, e) => (t8, n) => e(t8, n, r);
var nd2 = class extends Ve {
  constructor(r, e, t8, n) {
    super(), this._context = r, this._contextMenuService = e, this._selectionManagerService = t8, this._selectionRenderService = n, this._init();
  }
  _init() {
    var l, a;
    const e = ((a = (l = this._context) == null ? void 0 : l.mainComponent) == null ? void 0 : a.onPointerDown$).subscribeEvent((c) => {
      if (c.button === 2) {
        const d = this._selectionManagerService.getCurrentSelections(), u = d == null ? void 0 : d[0];
        if (!u)
          return;
        const h = u.range.rangeType, g = this._selectionRenderService.getSkeleton(), f2 = Wt4(u, g).rangeWithCoord, v2 = () => {
          if (!f2)
            return false;
          const S = c.offsetX, w = c.offsetY;
          switch (h) {
            case ge.ROW:
              return f2.startY <= w && f2.endY >= w;
            case ge.COLUMN:
              return f2.startX <= S && f2.endX >= S;
            default:
              return f2.startX <= S && f2.endX >= S && f2.startY <= w && f2.endY >= w;
          }
        }, p = (S) => {
          this._contextMenuService.triggerContextMenu(c, S);
        };
        v2() ? h === ge.COLUMN ? p(Y1.COL_HEADER) : h === ge.ROW ? p(Y1.ROW_HEADER) : p(Y1.MAIN_AREA) : p(Y1.MAIN_AREA);
      }
    });
    this.disposeWithMe(e);
    const t8 = this._context.components.get(Ye3.COLUMN), i = this._context.components.get(Ye3.ROW).onPointerDown$.subscribeEvent((c) => {
      c.button === 2 && this._contextMenuService.triggerContextMenu(c, Y1.ROW_HEADER);
    });
    this.disposeWithMe(i);
    const s = t8.onPointerDown$.subscribeEvent((c) => {
      c.button === 2 && this._contextMenuService.triggerContextMenu(c, Y1.COL_HEADER);
    });
    this.disposeWithMe(s);
  }
};
nd2 = wy([
  wc(1, c32),
  wc(2, Inject(z)),
  wc(3, gt)
], nd2);
var by = Object.getOwnPropertyDescriptor;
var _y = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? by(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var jh3 = (r, e) => (t8, n) => e(t8, n, r);
function Ry(r) {
  return typeof r.setShadowStrategy == "function";
}
var rd2 = class extends Ve {
  constructor(e, t8) {
    super();
    _2(this, "_currentStrategy");
    _2(this, "_strategySubject");
    this._configService = e, this._renderManagerService = t8;
    const n = this._configService.getConfig(Tt3);
    this._currentStrategy = tu2(n == null ? void 0 : n.protectedRangeShadow), this._strategySubject = new BehaviorSubject(this._currentStrategy), this.disposeWithMe({
      dispose: () => {
        this._strategySubject.complete();
      }
    });
  }
  _updateAllWorkbooks(e) {
    this._renderManagerService.getRenderAll().forEach((n) => {
      const i = n.mainComponent;
      if (!i)
        return;
      const o = [
        { key: gu2 },
        { key: mu3 },
        { key: fu2 }
      ];
      let s = false;
      for (const { key: l } of o) {
        const a = i.getExtensionByKey(l);
        a && Ry(a) && (a.setShadowStrategy(e), s = true);
      }
      s && i.makeDirty(true);
    });
  }
  setProtectedRangeShadowStrategy(e) {
    this._currentStrategy = e, this._strategySubject.next(e), this._updateAllWorkbooks(e);
  }
  getProtectedRangeShadowStrategy() {
    return this._currentStrategy;
  }
  getProtectedRangeShadowStrategy$() {
    return this._strategySubject.asObservable();
  }
  dispose() {
    super.dispose(), this._strategySubject.complete();
  }
};
rd2 = _y([
  jh3(0, ic),
  jh3(1, ME)
], rd2);
var Iy = Object.getOwnPropertyDescriptor;
var yy = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? Iy(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var jn4 = (r, e) => (t8, n) => e(t8, n, r);
var id2 = class extends mm {
  constructor(e, t8, n, i, o, s, l, a, c) {
    super(
      t8,
      n,
      i,
      s,
      c
    );
    _2(this, "_workbookSelections");
    _2(this, "_renderDisposable", null);
    this._context = e, this._logService = l, this._commandService = a, this._contextService = c, this._workbookSelections = o.getWorkbookSelections(this._context.unitId), this._init();
  }
  _init() {
    const e = this._getSheetObject();
    this._contextService.setContextValue(Eh, true), this._initEventListeners(e), this._initSelectionModelChangeListener(), this._initThemeChangeListener(), this._initSkeletonChangeListener(), this._initUserActionSyncListener();
  }
  dispose() {
    var e;
    super.dispose(), (e = this._renderDisposable) == null || e.dispose();
  }
  _initEventListeners(e) {
    const { spreadsheetRowHeader: t8, spreadsheetColumnHeader: n, spreadsheet: i, spreadsheetLeftTopPlaceholder: o } = e, { scene: s } = this._context;
    this.disposeWithMe(i == null ? void 0 : i.onPointerDown$.subscribeEvent((l, a) => {
      this.isSelectionDisabled() || this.inRefSelectionMode() || (this._onPointerDown(l, i.zIndex + 1, ge.NORMAL, this._getActiveViewport(l)), l.button !== 2 && a.stopPropagation());
    })), this.disposeWithMe(
      t8 == null ? void 0 : t8.onPointerDown$.subscribeEvent((l, a) => {
        if (this.isSelectionDisabled() || this.inRefSelectionMode()) return;
        const c = this._sheetSkeletonManagerService.getCurrentParam().skeleton, { row: d } = Vn3(l.offsetX, l.offsetY, s, c);
        Tf2(this._workbookSelections.getCurrentSelections(), d) || (this._onPointerDown(l, (i.zIndex || 1) + 1, ge.ROW, this._getActiveViewport(l), bE.Y), l.button !== 2 && a.stopPropagation());
      })
    ), this.disposeWithMe(n == null ? void 0 : n.onPointerDown$.subscribeEvent((l, a) => {
      if (this.isSelectionDisabled() || this.inRefSelectionMode()) return;
      const c = this._sheetSkeletonManagerService.getCurrentParam().skeleton, { column: d } = Vn3(l.offsetX, l.offsetY, s, c);
      Pf(this._workbookSelections.getCurrentSelections(), d) || (this._onPointerDown(l, (i.zIndex || 1) + 1, ge.COLUMN, this._getActiveViewport(l), bE.X), l.button !== 2 && a.stopPropagation());
    })), this.disposeWithMe(o == null ? void 0 : o.onPointerDown$.subscribeEvent((l, a) => {
      if (this.isSelectionDisabled() || this.inRefSelectionMode()) return;
      this._reset();
      const c = this._sheetSkeletonManagerService.getCurrentParam().skeleton, d = fm(c);
      this._addSelectionControlByModelData(d), this.refreshSelectionMoveEnd(), l.button !== 2 && a.stopPropagation();
    }));
  }
  _initThemeChangeListener() {
    this.disposeWithMe(this._themeService.currentTheme$.subscribe(() => {
      this._initSelectionThemeFromThemeService();
      const e = this._workbookSelections.getCurrentSelections();
      e && this.resetSelectionsByModelData(e);
    }));
  }
  /**
   * Response for selection model changing.
   */
  _initSelectionModelChangeListener() {
    this.disposeWithMe(merge(
      this._workbookSelections.selectionMoveEnd$,
      // triggered by keyboard(e.g. arrow key tab enter)
      this._workbookSelections.selectionSet$
      // shift + arrow key
    ).subscribe((e) => {
      this.resetSelectionsByModelData(e);
    }));
  }
  disableSelection() {
    this._contextService.setContextValue(Eh, false);
  }
  enableSelection() {
    this._contextService.setContextValue(Eh, true);
  }
  transparentSelection() {
    const e = this._themeService.getCurrentTheme(), t8 = s1(e, "primary.600", "transparent");
    this.setSelectionTheme(t8);
    const n = this._workbookSelections.getCurrentSelections();
    for (let i = 0; i < n.length; i++) {
      const o = n[i];
      o.style = Sr2(this._selectionTheme);
    }
    this.resetSelectionsByModelData(n);
  }
  showSelection() {
    const e = this._themeService.getCurrentTheme();
    this.setSelectionTheme(e);
    const t8 = this._workbookSelections.getCurrentSelections();
    for (let n = 0; n < t8.length; n++) {
      const i = t8[n];
      i.style && (i.style = Sr2(this._selectionTheme));
    }
    this.resetSelectionsByModelData(t8);
  }
  /**
   * Handle events in spreadsheet. (e.g. drag and move to make a selection)
   */
  _initUserActionSyncListener() {
    this.disposeWithMe(this.selectionMoveStart$.subscribe((e) => this._updateSelections(e, we2.MOVE_START))), this.disposeWithMe(this.selectionMoving$.subscribe((e) => this._updateSelections(e, we2.MOVING))), this.disposeWithMe(this._contextService.subscribeContextValue$($u).pipe(startWith(false), distinctUntilChanged()).subscribe((e) => {
      e && this._reset();
    })), this.disposeWithMe(this._contextService.subscribeContextValue$(Eh).pipe(startWith(true), distinctUntilChanged()).subscribe((e) => {
      var t8;
      e ? this._renderDisposable = We(
        this.selectionMoveEnd$.subscribe((n) => {
          this._updateSelections(n, we2.MOVE_END);
        })
      ) : ((t8 = this._renderDisposable) == null || t8.dispose(), this._renderDisposable = null, this._reset());
    }));
  }
  /**
   * Update selectionData to selectionDataModel (WorkBookSelections) by SetSelectionsOperation.
   *
   * Unlike baseSelectionRenderService@resetSelectionsByModelData, this method is for update WorkbookSelectionModel.
   *
   *
   * @param selectionDataWithStyleList
   * @param type
   */
  _updateSelections(e, t8) {
    const n = this._context.unit, i = n.getUnitId(), o = n.getActiveSheet().getSheetId();
    if (e.length === 0)
      return;
    const s = e.map(
      (l) => vh(l)
    );
    this._commandService.executeCommand(ie3.id, {
      unitId: i,
      subUnitId: o,
      type: t8,
      selections: s
    });
  }
  _initSkeletonChangeListener() {
    this.disposeWithMe(this._sheetSkeletonManagerService.currentSkeleton$.subscribe((e) => {
      var c, d;
      if (e == null) {
        this._logService.error("[SelectionRenderService]: should not receive null!");
        return;
      }
      const t8 = this._context.unitId, { sheetId: n, skeleton: i } = e, { scene: o } = this._context, s = o.getViewport(k2.VIEW_MAIN), l = (d = (c = this._skeleton) == null ? void 0 : c.worksheet) == null ? void 0 : d.getSheetId();
      if (this._changeRuntime(i, o, s), l !== i.worksheet.getSheetId()) {
        const u = this._workbookSelections.getCurrentSelections();
        this._commandService.syncExecuteCommand(ie3.id, {
          unitId: t8,
          subUnitId: n,
          selections: u.length !== 0 ? u : [Bd2(i)]
        });
      }
      const a = this._workbookSelections.getCurrentSelections();
      a != null && this.resetSelectionsByModelData(a);
    }));
  }
  _getActiveViewport(e) {
    const t8 = this._getSheetObject();
    return t8 == null ? void 0 : t8.scene.getActiveViewportByCoord(U.FromArray([e.offsetX, e.offsetY]));
  }
  _getSheetObject() {
    return en4(this._context.unit, this._context);
  }
  /**
   * Handle pointer down event, bind pointermove & pointerup handler.
   * then trigger selectionMoveStart$.
   *
   * @param evt
   * @param _zIndex
   * @param rangeType
   * @param viewport
   * @param scrollTimerType
   */
  // eslint-disable-next-line complexity, max-lines-per-function
  _onPointerDown(e, t8 = 0, n = ge.NORMAL, i, o = bE.ALL) {
    var T, P2;
    this._rangeType = n;
    const s = this._skeleton, l = this._scene;
    if (!l || !s)
      return;
    i && (this._activeViewport = i);
    const { offsetX: a, offsetY: c } = e, d = l.getViewport(k2.VIEW_MAIN);
    if (!d) return;
    const u = l.getCoordRelativeToViewport(U.FromArray([a, c])), { x: h, y: g } = u;
    this._startViewportPosX = h, this._startViewportPosY = g;
    const m2 = l.getScrollXYInfoByViewport(u), { scaleX: f2, scaleY: v2 } = l.getAncestorScale(), p = this._skeleton.getCellByOffset(h, g, f2, v2, m2);
    if (!p) return;
    switch (n) {
      case ge.NORMAL:
        break;
      case ge.ROW:
        p.startColumn = 0, p.endColumn = this._skeleton.getColumnCount() - 1, p.startRow = p.actualRow, p.endRow = p.actualRow;
        break;
      case ge.COLUMN:
        p.startRow = 0, p.endRow = this._skeleton.getRowCount() - 1, p.startColumn = p.actualColumn, p.endColumn = p.actualColumn;
        break;
      case ge.ALL:
        p.startRow = 0, p.startColumn = 0, p.endRow = this._skeleton.getRowCount() - 1, p.endColumn = this._skeleton.getColumnCount() - 1;
    }
    const S = { range: p, primary: p, style: null };
    S.range.rangeType = n;
    const w = Wt4(S, this._skeleton);
    this._startRangeWhenPointerDown = { ...w.rangeWithCoord };
    let C = this.getActiveSelectionControl();
    const I2 = { ...w.rangeWithCoord, rangeType: n }, R = this.getSelectionControls();
    for (const H3 of R)
      if (e.button === 2 && En.contains(H3.model, I2)) {
        C = H3;
        return;
      }
    this._checkClearPreviousControls(e);
    const y = C == null ? void 0 : C.model.currentCell, M7 = e.shiftKey && y, E = this._remainLastEnabled && !e.ctrlKey && !e.shiftKey && !this._skipLastEnabled && !this._singleSelectionEnabled;
    M7 ? this._makeSelectionByTwoCells(
      y,
      I2,
      s,
      n,
      C
      // Get updated in this method
    ) : E && C ? C.updateRangeBySelectionWithCoord(w) : C = this.newSelectionControl(l, s, S);
    for (let H3 = 0; H3 < this.getSelectionControls().length - 1; H3++)
      this.getSelectionControls()[H3].clearHighlight();
    l.disableObjectsEvent(), this._clearUpdatingListeners(), this._addEndingListeners(), (T = l.getTransformer()) == null || T.clearSelectedObjects(), this._setupPointerMoveListener(d, C, n, o, h, g), this._escapeShortcutDisposable = this._shortcutService.forceEscape(), this._selectionMoveStart$.next(this.getSelectionDataWithStyle()), this._scenePointerUpSub = l.onPointerUp$.subscribeEvent(() => {
      var H3;
      this._clearUpdatingListeners(), this._selectionMoveEnd$.next(this.getSelectionDataWithStyle()), (H3 = this._escapeShortcutDisposable) == null || H3.dispose(), this._escapeShortcutDisposable = null;
    }), (P2 = this._scene.getEngine()) == null || P2.setCapture();
  }
};
id2 = yy([
  jn4(1, Inject(Injector)),
  jn4(2, Inject(Gi)),
  jn4(3, ye3),
  jn4(4, Inject(z)),
  jn4(5, Inject(ue)),
  jn4(6, yt),
  jn4(7, Ls),
  jn4(8, Nr)
], id2);
var My = Object.defineProperty;
var Ey = Object.getOwnPropertyDescriptor;
var Ty = (r, e, t8) => e in r ? My(r, e, { enumerable: true, configurable: true, writable: true, value: t8 }) : r[e] = t8;
var Py = (r, e, t8, n) => {
  for (var i = n > 1 ? void 0 : n ? Ey(e, t8) : e, o = r.length - 1, s; o >= 0; o--)
    (s = r[o]) && (i = s(i) || i);
  return i;
};
var ro3 = (r, e) => (t8, n) => e(t8, n, r);
var Vp = (r, e, t8) => Ty(r, typeof e != "symbol" ? e + "" : e, t8);
var Nl = class extends Ol {
  /** @ignore */
  constructor(r = dl, e, t8, n, i, o) {
    super(), this._config = r, this._injector = e, this._renderManagerService = t8, this._configService = n, this._univerInstanceService = i, this._componentManager = o;
    const { menu: s, ...l } = oo(
      {},
      dl,
      this._config
    );
    if (l.protectedRangeUserSelector) {
      const { component: a, framework: c } = l.protectedRangeUserSelector;
      this.disposeWithMe(
        this._componentManager.register(
          ga3,
          a,
          {
            framework: c
          }
        )
      );
    }
    s && this._configService.setConfig("menu", s, { merge: true }), this._configService.setConfig(Tt3, { ...l });
  }
  onStarting() {
    GC(this._injector, nC([
      [Si3],
      [qe5, { useClass: ll }],
      [nn2, { useClass: rl2 }],
      [Nr3, { useClass: Vm2 }],
      [Dn2, { useClass: sl2 }],
      [ls3, { useClass: Bm }],
      [as2, { useClass: tf2 }],
      [Fu, { useClass: fo2 }],
      [Hr, { useClass: el }],
      [Ap],
      [xa2, { useClass: nf2 }],
      [Wi3, { useClass: tl2 }],
      [Mr3],
      [Oo2],
      [yi3],
      [Mi3],
      [Do3],
      [Kd2],
      [Op, { useClass: Hl }],
      [Ao3],
      // controllers
      [Ei2],
      [hi3],
      [Ir2],
      [yr3],
      [ir3],
      [pl],
      [Er2],
      [bi3],
      [Oi2],
      [Pi3],
      [xi2],
      [Ti2],
      [Ri2],
      // permission
      [Rr3],
      [Ai3],
      [Vr],
      [rd2],
      [Hi3],
      [Ii3],
      [Vi2]
    ], this._config.override));
  }
  onReady() {
    this._config.disableAutoFocus || this._initAutoFocus(), GC(this._injector, [
      [Tr2]
    ]), this._registerRenderBasics(), zc(this._injector, [
      [pl],
      [ir3],
      [Ei2],
      [Ii3],
      [Ai3]
    ]);
  }
  onRendered() {
    this._registerRenderModules(), zc(this._injector, [
      [Vi2],
      [Rr3],
      [Tr2],
      [yr3],
      [Pi3],
      [Er2],
      [hi3],
      [Ir2],
      [xi2],
      [Ti2],
      [Ri2]
    ]);
  }
  onSteady() {
    zc(this._injector, [
      [Oi2],
      [bi3],
      [Hi3]
    ]);
  }
  _registerRenderBasics() {
    [
      [ue],
      [Ol2],
      [fl],
      [gt, { useClass: id2 }],
      [Al2]
    ].forEach((r) => {
      this.disposeWithMe(this._renderManagerService.registerRenderModule(we.UNIVER_SHEET, r));
    });
  }
  // We have to let render basics get bootstrapped before. Because some render controllers relies on
  // a correct skeleton when they get loaded.
  _registerRenderModules() {
    var n;
    const r = [
      [No3],
      [xl],
      [ko3],
      // Caution: ScrollRenderController should placed before ZoomRenderController.
      [Et2],
      [Ci3],
      [Vo3],
      [Po3],
      [Tl],
      [El],
      [vl],
      [Sl],
      [wl],
      [hl],
      [cl],
      [Cl],
      [al],
      [nd2],
      [_l],
      // editor
      [Ho3],
      // permission
      [Rl],
      [Il],
      [yl],
      [Ml]
    ], e = this._configService.getConfig(_e2);
    ((n = e == null ? void 0 : e.contextMenu) != null ? n : true) && r.push([Pl]), r.forEach((i) => {
      this.disposeWithMe(this._renderManagerService.registerRenderModule(we.UNIVER_SHEET, i));
    });
  }
  _initAutoFocus() {
    const r = this._univerInstanceService;
    this.disposeWithMe(r.getCurrentTypeOfUnit$(we.UNIVER_SHEET).pipe(filter((e) => !!e)).subscribe((e) => r.focusUnit(e.getUnitId())));
  }
};
Vp(Nl, "pluginName", "SHEET_UI_PLUGIN");
Vp(Nl, "type", we.UNIVER_SHEET);
Nl = Py([
  qR(ss),
  ro3(1, Inject(Injector)),
  ro3(2, ME),
  ro3(3, ic),
  ro3(4, vr),
  ro3(5, Inject(S1))
], Nl);
function e22(r, e, t8, n) {
  const { from: i, to: o } = t8, { column: s, columnOffset: l, row: a, rowOffset: c } = i, { column: d, columnOffset: u, row: h, rowOffset: g } = o, m2 = n.ensureSkeleton(e);
  if (m2 == null)
    throw new Error("No current skeleton");
  const f2 = bo2(m2, {
    startColumn: s,
    endColumn: s,
    startRow: a,
    endRow: a
  }), v2 = bo2(m2, {
    startColumn: d,
    endColumn: d,
    startRow: h,
    endRow: h
  }), { startX: p, startY: S } = f2, { startX: w, startY: C } = v2, I2 = de(p + l, 1), R = de(S + c, 1);
  let y = de(w + u - I2, 1), M7 = de(C + g - R, 1);
  return f2.startX === v2.endX && (y = 0), f2.startY === v2.endY && (M7 = 0), {
    unitId: r,
    subUnitId: e,
    left: I2,
    top: R,
    width: y,
    height: M7
  };
}
function t2(r, e, t8, n, i, o, s) {
  const { column: l, columnOffset: a, row: c, rowOffset: d } = t8, u = s.ensureSkeleton(e);
  if (u == null)
    throw new Error("No current skeleton");
  const h = bo2(u, {
    startColumn: l,
    endColumn: l,
    startRow: c,
    endRow: c
  }), { startX: g, startY: m2 } = h, f2 = de(g + a, 1), v2 = de(m2 + d, 1), p = o.getCellWithCoordByOffset(f2 + n, v2 + i, u);
  if (p == null)
    throw new Error("No end selection cell");
  const S = {
    column: p.actualColumn,
    columnOffset: de(f2 + n - p.startX, 1),
    row: p.actualRow,
    rowOffset: de(v2 + i - p.startY, 1)
  };
  return {
    unitId: r,
    subUnitId: e,
    sheetTransform: {
      from: {
        column: l,
        columnOffset: a,
        row: c,
        rowOffset: d
      },
      to: S
    },
    transform: {
      left: f2,
      top: v2,
      width: n,
      height: i
    }
  };
}

export {
  RediContext,
  RediProvider,
  RediConsumer,
  connectInjector,
  connectDependencies,
  WithDependency,
  useInjector,
  useDependency,
  useObservable,
  useUpdateBinder,
  G3,
  Ai,
  we3 as we,
  s3,
  S1,
  Pe2 as Pe,
  Bi,
  Pi,
  a5,
  d5,
  h5,
  f5,
  _12 as _1,
  C5,
  v5,
  re,
  g5,
  p5,
  Fi,
  m5,
  b5,
  L5,
  w5,
  _5,
  ki,
  y5,
  ji,
  Ui,
  M5,
  zi,
  Wi,
  Yi,
  Gi2 as Gi,
  Xi,
  U1,
  Fe2 as Fe,
  H1,
  ke3 as ke,
  w1,
  G1,
  De,
  A32 as A3,
  fe,
  Te2 as Te,
  Zn,
  Y1,
  a12 as a1,
  B12 as B1,
  je,
  E5,
  qi,
  Ji,
  _e2 as _e,
  et2 as et,
  oe,
  B5,
  Fn3 as Fn,
  kn2 as kn,
  jn2 as jn,
  Qi,
  q1,
  L1,
  tt,
  Un,
  ye3 as ye,
  ze,
  W5,
  Y5,
  X5,
  q5,
  ie4 as ie,
  le,
  c12 as c1,
  D1,
  Yn,
  nt2 as nt,
  to,
  Gn3 as Gn,
  rt3 as rt,
  Xn,
  ot2 as ot,
  no,
  Qn,
  I13 as I1,
  M1,
  ro,
  oo2 as oo,
  Oe,
  ao2 as ao,
  a3,
  c32 as c3,
  er,
  co,
  lt2 as lt,
  tr,
  nr,
  st2 as st,
  rr2 as rr,
  or3 as or,
  B3,
  We3 as We,
  Lo,
  u3,
  ir2 as ir,
  Ye2 as Ye,
  So,
  Qt4 as Qt,
  Kt,
  Oo,
  $o,
  Eo2 as Eo,
  No,
  Ki,
  e7,
  lr,
  Ge,
  at,
  t7,
  Xe2 as Xe,
  ct2 as ct,
  qe3 as qe,
  ut,
  Je3 as Je,
  Qe,
  sr3 as sr,
  ar,
  cr,
  Ke,
  e3,
  ur,
  t3,
  F3,
  Li,
  wi2 as wi,
  k3,
  n7,
  r7,
  O32 as O3,
  dr,
  dt,
  yi,
  o72 as o7,
  i7,
  l7,
  s72 as s7,
  a7,
  c7,
  u7,
  Dt,
  od,
  rd,
  sd2 as sd,
  $e3 as $e,
  We4 as We2,
  id,
  zo2 as zo,
  ad,
  Js,
  zf,
  pt2 as pt,
  cd,
  Gf,
  ld2 as ld,
  Yf,
  Kf,
  qf,
  Xf,
  Zf,
  Zt3 as Zt,
  Mo2 as Mo,
  bn2 as bn,
  Ke2,
  Ae2 as Ae,
  pa,
  Gr,
  Kr,
  qr3 as qr,
  Xr2 as Xr,
  ma,
  bd,
  Sa,
  Md,
  Jt2 as Jt,
  _d,
  va,
  yn2 as yn,
  Ca,
  Zr,
  Jr,
  $r,
  Do2 as Do,
  ba,
  Ud,
  Fd,
  Hd,
  Wd,
  Nt3 as Nt,
  ro2,
  rs,
  is,
  Po2 as Po,
  Oa,
  No2,
  Ta,
  Lt2 as Lt,
  Qt5 as Qt2,
  Ut3 as Ut,
  Ft4 as Ft,
  bt3 as bt,
  Ht2 as Ht,
  ct3 as ct2,
  en3 as en,
  mt2 as mt,
  Et,
  Un2,
  yt2 as yt,
  _a,
  qd,
  Xd,
  wa,
  Jd,
  $d,
  Fn4 as Fn2,
  Lo2,
  qn3 as qn,
  gr2 as gr,
  xn3 as xn,
  so2 as so,
  Pa,
  On2 as On,
  Na,
  lt3 as lt2,
  Qo3 as Qo,
  Uo2 as Uo,
  Fo2 as Fo,
  Ho2 as Ho,
  tt2,
  Xn2,
  Xe3 as Xe2,
  fi2 as fi,
  It2 as It,
  nA,
  Fa,
  ka,
  mr2 as mr,
  Jn2 as Jn,
  Es2 as Es,
  Xt2 as Xt,
  Jo2 as Jo,
  Va,
  AA,
  Re2 as Re,
  ko2 as ko,
  Wa,
  Is,
  Ss,
  Hn2 as Hn,
  Rs2 as Rs,
  bs2 as bs,
  ys,
  xs,
  ja,
  SA,
  za,
  Os2 as Os,
  St2 as St,
  vt2 as vt,
  kA,
  Sr,
  Ge2,
  Oi,
  nr2,
  Bn4 as Bn,
  wt2 as wt,
  Se2 as Se,
  hg,
  Ao2 as Ao,
  uo3 as uo,
  br,
  af,
  Io2 as Io,
  So2,
  wr2 as wr,
  Bf,
  Mf,
  Jf,
  Dd2 as Dd,
  hm,
  Ld2 as Ld,
  Ye3 as Ye2,
  oa,
  sa,
  gm,
  Sr2,
  bo2 as bo,
  Wt4 as Wt,
  Ks,
  xC,
  Wd2,
  gt,
  mm,
  fm,
  Bd2 as Bd,
  AC,
  ue,
  DC,
  hi3 as hi,
  Cr3 as Cr,
  wr3 as wr2,
  zy,
  mt3 as mt2,
  Le3 as Le,
  el,
  Hr,
  gr3 as gr2,
  _o3 as _o,
  Ve4 as Ve,
  jy,
  Wi3 as Wi2,
  tl2 as tl,
  Yn3 as Yn2,
  Yy2 as Yy,
  rh2 as rh,
  et3 as et2,
  nn2 as nn,
  rl2 as rl,
  N1,
  un5 as un,
  Yd2 as Yd,
  hn4 as hn,
  Xc,
  go3 as go,
  mo3 as mo,
  ri4 as ri,
  fo5 as fo,
  ts2 as ts,
  pi3 as pi,
  ca,
  da,
  Bi3 as Bi2,
  Fi3 as Fi2,
  Ui3 as Ui2,
  Xi2,
  Mm2 as Mm,
  Em2 as Em,
  ua,
  ha2 as ha,
  Io3 as Io2,
  qd2,
  vi3 as vi,
  ns2 as ns,
  ga3 as ga,
  Vr,
  Hn3 as Hn2,
  ma2,
  ii3 as ii,
  oi3 as oi,
  fa,
  pa2,
  si3 as si,
  li3 as li,
  va2,
  Mo3 as Mo2,
  Eo4 as Eo2,
  Sa2,
  zt4 as zt,
  Dn2 as Dn,
  Ca2,
  Qd2 as Qd,
  rs2,
  wa2,
  Et2,
  $n3 as $n,
  ba2,
  _a2,
  Ln4 as Ln,
  Ut4 as Ut2,
  Wn4 as Wn,
  Gt3 as Gt,
  Ra2 as Ra,
  en4 as en2,
  lh2 as lh,
  Vn3 as Vn,
  Os3 as Os2,
  Ci3 as Ci,
  gn2 as gn,
  To2 as To,
  mn3 as mn,
  Hm2 as Hm,
  Zy,
  Ir2 as Ir,
  is2,
  ll,
  qe5 as qe2,
  Jt3 as Jt2,
  os2 as os,
  ss3 as ss,
  Ia2 as Ia,
  ya2 as ya,
  Ma2 as Ma,
  Jd2,
  tt3,
  Ea2 as Ea,
  wi4 as wi2,
  Ta2,
  $d2,
  Nm,
  eu2 as eu,
  ww,
  kr,
  Gy,
  qy,
  Qy,
  Wm2 as Wm,
  ir3 as ir2,
  bi3 as bi,
  al,
  Oo2,
  cl,
  Bm,
  ls3 as ls,
  ef2 as ef,
  as2 as as,
  s02 as s0,
  m02 as m0,
  nf2 as nf,
  xa2 as xa,
  Ua3 as Ua,
  R02 as R0,
  I02 as I0,
  of3 as of,
  Ao3 as Ao2,
  F02 as F0,
  U02 as U0,
  Ri2 as Ri,
  yr3 as yr,
  q02 as q0,
  Ky,
  $02 as $0,
  Jy,
  $y,
  Mr3 as Mr,
  hl,
  pt3 as pt2,
  ob,
  zi3 as zi2,
  he2 as he,
  wb,
  Vs,
  gl,
  v_,
  Ii3 as Ii,
  Vo3 as Vo,
  No3,
  ko3 as ko2,
  fl,
  yi3 as yi2,
  Mi3 as Mi,
  pl,
  Er2 as Er,
  pR,
  po3 as po,
  Do3 as Do2,
  KR,
  Op,
  Hl,
  Ap,
  Vl,
  rd2,
  id2,
  Nl,
  e22 as e2,
  t2
};
/*! Bundled license information:

@wendellhu/redi/dist/esm/react-bindings/index.js:
  (* istanbul ignore next -- @preserve *)

@univerjs/ui/lib/es/index.js:
  (*!
      localForage -- Offline Storage, Improved
      Version 1.10.0
      https://localforage.github.io/localForage
      (c) 2013-2017 Mozilla, Apache License 2.0
  *)
*/
//# sourceMappingURL=chunk-DZMX4FYO.js.map
