import {
  k
} from "./chunk-FOCXVU2X.js";
import {
  B1,
  Bi,
  H1,
  Hm,
  L1,
  S1,
  U1,
  Yi,
  at,
  ct,
  en2 as en,
  et,
  fe,
  lh,
  q1,
  ue,
  useDependency,
  useObservable,
  ye
} from "./chunk-DZMX4FYO.js";
import {
  I1,
  ME,
  Sn2 as Sn,
  hx,
  ie,
  ju,
  pn2 as pn,
  ri,
  ss,
  x3,
  z
} from "./chunk-I7I3GTAS.js";
import {
  $C,
  Dx,
  I,
  LE,
  Vx,
  em,
  gE,
  require_jsx_runtime,
  require_react,
  vr as vr2,
  yE
} from "./chunk-YFGUMDM2.js";
import {
  AR,
  BC,
  BehaviorSubject,
  En,
  Fn,
  Gi,
  Inject,
  Injector,
  J,
  Ls,
  Ms,
  Nr,
  Ol,
  Qo,
  Subject,
  Ve,
  We,
  ao,
  bt,
  combineLatest,
  createIdentifier,
  debounceTime,
  filter,
  fromEvent,
  gr,
  h1,
  ic,
  jC,
  mE,
  map,
  merge,
  oo,
  pt,
  qR,
  skip,
  takeUntil,
  throttleTime,
  vr,
  we,
  wg
} from "./chunk-RGZYGL3P.js";
import {
  __toESM
} from "./chunk-DC5AMYBS.js";

// node_modules/@univerjs/find-replace/lib/es/index.js
var import_react = __toESM(require_react());
var import_jsx_runtime = __toESM(require_jsx_runtime());
var st = Object.defineProperty;
var rt = (t, e, n) => e in t ? st(t, e, { enumerable: true, configurable: true, writable: true, value: n }) : t[e] = n;
var o = (t, e, n) => rt(t, typeof e != "symbol" ? e + "" : e, n);
var Re = "FIND_REPLACE_INPUT_FOCUS";
var be = "FIND_REPLACE_DIALOG_FOCUS";
var Ie = "FIND_REPLACE_REPLACE_REVEALED";
var xt = Object.getOwnPropertyDescriptor;
var Fe = (t, e, n, i) => {
  for (var s = i > 1 ? void 0 : i ? xt(e, n) : e, r = t.length - 1, a; r >= 0; r--)
    (a = t[r]) && (s = a(s) || s);
  return s;
};
var L = (t, e) => (n, i) => e(n, i, t);
var gi = class extends Ve {
};
var f = createIdentifier("find-replace.service");
function Et(t) {
  return typeof t.findString < "u" || typeof t.inputtingFindString < "u" || typeof t.findDirection < "u" || typeof t.matchesTheWholeCell < "u" || typeof t.caseSensitive < "u" || typeof t.findScope < "u" || typeof t.findBy < "u";
}
var K = class extends Ve {
  constructor(e, n, i, s) {
    super();
    o(this, "currentMatch$", new BehaviorSubject(null));
    o(this, "replaceables$", new BehaviorSubject([]));
    o(this, "_findModels", []);
    o(this, "_matchingModel", null);
    o(this, "_matches", []);
    o(this, "_currentSearchingDisposables", null);
    this._state = e, this._providers = n, this._univerInstanceService = i, this._commandService = s, this.disposeWithMe(
      this._state.stateUpdates$.pipe(throttleTime(200, void 0, { leading: true, trailing: true })).subscribe(async (r) => {
        const a = this._state.state;
        Et(r) && (a.findString !== "" && !a.replaceRevealed ? (await this._startSearching(), this._state.changeState({ findCompleted: true })) : r.replaceRevealed !== true && this._stopSearching());
      })
    );
  }
  get searched() {
    return this._findModels.length > 0;
  }
  dispose() {
    super.dispose(), this._stopSearching(), this.currentMatch$.complete(), this.replaceables$.complete(), this._state.changeState({ ...te(), revealed: false });
  }
  async start() {
    if (!this._state.findString)
      return { results: [] };
    const e = await this._startSearching();
    return this._state.changeState({ findCompleted: true }), e;
  }
  focusSelection() {
    var e;
    (e = this._matchingModel) == null || e.focusSelection();
  }
  /** Call this method to start a `searching`. */
  async _startSearching() {
    if (!this._state.findString)
      return { results: [] };
    const e = Array.from(this._providers), n = this._findModels = (await Promise.all(e.map((s) => s.find({
      findString: this._state.findString,
      findDirection: this._state.findDirection,
      findScope: this._state.findScope,
      findBy: this._state.findBy,
      replaceRevealed: this._state.replaceRevealed,
      caseSensitive: this._state.caseSensitive,
      matchesTheWholeCell: this._state.matchesTheWholeCell
    })))).flat();
    this._subscribeToModelsChanges(n);
    const i = this._matches = n.map((s) => s.getMatches()).flat();
    return this.replaceables$.next(i.filter((s) => s.replaceable)), i.length ? (this._moveToInitialMatch(n), this._state.changeState({ matchesCount: i.length }), { results: i }) : (this._state.changeState({ matchesCount: 0, matchesPosition: 0 }), { results: [] });
  }
  /** Terminate the current searching session, when searching string is empty. */
  _stopSearching() {
    var e;
    this._providers.forEach((n) => n.terminate()), this._findModels = [], this._matches = [], this._matchingModel = null, (e = this._currentSearchingDisposables) == null || e.dispose(), this._currentSearchingDisposables = null, this.currentMatch$.next(null), this.replaceables$.next([]), this._state.changeState({
      findCompleted: false,
      matchesCount: 0,
      matchesPosition: 0
    });
  }
  // When a document's content changes, we should reset all matches and try to move to the next match.
  _subscribeToModelsChanges(e) {
    const n = this._currentSearchingDisposables = new ao(), i = combineLatest(e.map((s) => s.matchesUpdate$)).pipe(debounceTime(220)).subscribe(([...s]) => {
      const r = this._matches = s.flat();
      r.length ? (this._moveToInitialMatch(this._findModels, true), this._state.changeState({ matchesCount: r.length }), this.replaceables$.next(r.filter((a) => a.replaceable))) : (this._state.changeState({ matchesCount: 0, matchesPosition: 0 }), this.replaceables$.next([]));
    });
    e.forEach((s) => n.add(We(s.activelyChangingMatch$.subscribe((r) => {
      const a = this._matches.findIndex((l2) => l2 === r);
      this._state.changeState({ matchesPosition: a + 1 });
    })))), n.add(We(i));
  }
  async replace() {
    return this._matchingModel ? this._matchingModel.replace(this._state.replaceString) : false;
  }
  async replaceAll() {
    const e = await Promise.all(this._findModels.map((n) => n.replaceAll(this._state.replaceString))).then((n) => n.reduce((i, s) => (i.success += s.success, i.failure += s.failure, i), { success: 0, failure: 0 }));
    return e.failure === 0 && this._stopSearching(), e;
  }
  getCurrentMatch() {
    return this._state.matchesPosition > 0 ? this._matches[this._state.matchesPosition - 1] : null;
  }
  _markMatch(e) {
    const n = this._matches.findIndex((i) => i === e);
    this.currentMatch$.next(e), this._state.changeState({ matchesPosition: n + 1 });
  }
  moveToNextMatch() {
    if (!this._matchingModel)
      return;
    const e = this._findModels.length === 1, n = this._matchingModel.moveToNextMatch({ loop: e });
    if (n)
      return this._markMatch(n), n;
    {
      const i = this._findModels.findIndex((s) => s === this._matchingModel);
      return this._moveToNextUnitMatch(i);
    }
  }
  _moveToNextUnitMatch(e) {
    const n = this._findModels.length;
    for (let i = (e + 1) % n; i !== e; ) {
      const s = this._findModels[i], r = s.moveToNextMatch({ ignoreSelection: true });
      if (r)
        return this._matchingModel = s, this._markMatch(r), r;
      i = (i + 1) % n;
    }
    if (this._matchingModel) {
      const i = this._matchingModel.moveToNextMatch({ ignoreSelection: true });
      return i && this._markMatch(i), i;
    }
  }
  moveToPreviousMatch() {
    if (!this._matchingModel)
      return;
    const e = this._findModels.length === 1, n = this._matchingModel.moveToPreviousMatch({ loop: e });
    if (n) {
      const i = this._matches.findIndex((s) => s === n);
      return this.currentMatch$.next(n), this._state.changeState({ matchesPosition: i + 1 }), n;
    } else {
      const i = this._findModels.length, s = this._findModels.findIndex((a) => a === this._matchingModel);
      for (let a = (s - 1 + i) % i; a !== s; ) {
        const l2 = this._findModels[a], d = l2.moveToPreviousMatch({ ignoreSelection: true });
        if (d)
          return this._matchingModel = l2, this._markMatch(d), d;
        a = (a - 1) % i;
      }
      const r = this._matchingModel.moveToPreviousMatch({ ignoreSelection: true });
      return r && this._markMatch(r), r;
    }
  }
  _moveToInitialMatch(e, n = false) {
    var r;
    const i = (r = this._univerInstanceService.getFocusedUnit()) == null ? void 0 : r.getUnitId();
    if (!i)
      return -1;
    const s = e.findIndex((a) => a.unitId === i);
    if (s !== -1) {
      this._matchingModel = e[s];
      const a = this._matchingModel.moveToNextMatch({ stayIfOnMatch: true, noFocus: n });
      if (a)
        return this._markMatch(a), s;
    }
    return this._moveToNextUnitMatch(s), 0;
  }
};
K = Fe([
  L(2, vr),
  L(3, Ls)
], K);
var q = ((t) => (t.ROW = "row", t.COLUMN = "column", t))(q || {});
var Z = ((t) => (t.VALUE = "value", t.FORMULA = "formula", t))(Z || {});
var z2 = ((t) => (t.SUBUNIT = "subunit", t.UNIT = "unit", t))(z2 || {});
function te() {
  return {
    caseSensitive: false,
    findBy: "value",
    findCompleted: false,
    findDirection: "row",
    findScope: "subunit",
    findString: "",
    inputtingFindString: "",
    matchesCount: 0,
    matchesPosition: 0,
    matchesTheWholeCell: false,
    replaceRevealed: false,
    replaceString: "",
    revealed: true
  };
}
var Nt = class {
  constructor() {
    o(this, "_stateUpdates$", new Subject());
    o(this, "stateUpdates$", this._stateUpdates$.asObservable());
    o(this, "_state$", new BehaviorSubject(te()));
    o(this, "state$", this._state$.asObservable());
    o(this, "_findString", "");
    o(this, "_inputtingFindString", "");
    o(this, "_replaceString", "");
    o(this, "_revealed", false);
    o(this, "_replaceRevealed", false);
    o(this, "_matchesPosition", 0);
    o(this, "_matchesCount", 0);
    o(this, "_caseSensitive", true);
    o(this, "_matchesTheWholeCell", false);
    o(this, "_findDirection", "row");
    o(this, "_findScope", "subunit");
    o(this, "_findBy", "value");
    o(this, "_findCompleted", false);
  }
  get state() {
    return this._state$.getValue();
  }
  get inputtingFindString() {
    return this._inputtingFindString;
  }
  get findString() {
    return this._findString;
  }
  get revealed() {
    return this._revealed;
  }
  get replaceRevealed() {
    return this._replaceRevealed;
  }
  get matchesPosition() {
    return this._matchesPosition;
  }
  get matchesCount() {
    return this._matchesCount;
  }
  get replaceString() {
    return this._replaceString;
  }
  get caseSensitive() {
    return this._caseSensitive;
  }
  get matchesTheWholeCell() {
    return this._matchesTheWholeCell;
  }
  get findDirection() {
    return this._findDirection;
  }
  get findScope() {
    return this._findScope;
  }
  get findBy() {
    return this._findBy;
  }
  get findCompleted() {
    return this._findCompleted;
  }
  // eslint-disable-next-line max-lines-per-function, complexity
  changeState(e) {
    let n = false;
    const i = {};
    typeof e.findString < "u" && e.findString !== this._findString && (this._findString = e.findString, i.findString = this._findString, n = true), typeof e.revealed < "u" && e.revealed !== this._revealed && (this._revealed = e.revealed, i.revealed = e.revealed, n = true), typeof e.replaceRevealed < "u" && e.replaceRevealed !== this._replaceRevealed && (this._replaceRevealed = e.replaceRevealed, i.replaceRevealed = e.replaceRevealed, n = true), typeof e.replaceString < "u" && e.replaceString !== this._replaceString && (this._replaceString = e.replaceString, i.replaceString = e.replaceString, n = true), typeof e.matchesCount < "u" && e.matchesCount !== this._matchesCount && (this._matchesCount = e.matchesCount, i.matchesCount = e.matchesCount, n = true), typeof e.matchesPosition < "u" && e.matchesPosition !== this._matchesPosition && (this._matchesPosition = e.matchesPosition, i.matchesPosition = e.matchesPosition, n = true), typeof e.findBy < "u" && e.findBy !== this._findBy && (this._findBy = e.findBy, i.findBy = e.findBy, n = true), typeof e.findScope < "u" && e.findScope !== this._findScope && (this._findScope = e.findScope, i.findScope = e.findScope, n = true), typeof e.findDirection < "u" && e.findDirection !== this._findDirection && (this._findDirection = e.findDirection, i.findDirection = e.findDirection, n = true), typeof e.caseSensitive < "u" && e.caseSensitive !== this._caseSensitive && (this._caseSensitive = e.caseSensitive, i.caseSensitive = e.caseSensitive, n = true), typeof e.matchesTheWholeCell < "u" && e.matchesTheWholeCell !== this._matchesTheWholeCell && (this._matchesTheWholeCell = e.matchesTheWholeCell, i.matchesTheWholeCell = e.matchesTheWholeCell, n = true), typeof e.inputtingFindString < "u" && e.inputtingFindString !== this._inputtingFindString && (this._inputtingFindString = e.inputtingFindString, i.inputtingFindString = e.inputtingFindString, n = true), typeof e.findCompleted < "u" && e.findCompleted !== this._findCompleted && (this._findCompleted = e.findCompleted, i.findCompleted = e.findCompleted, n = true), n && (this._state$.next({
      caseSensitive: this._caseSensitive,
      findBy: this._findBy,
      findCompleted: this._findCompleted,
      findDirection: this._findDirection,
      findScope: this._findScope,
      findString: this._findString,
      inputtingFindString: this._inputtingFindString,
      matchesCount: this._matchesCount,
      matchesPosition: this._matchesPosition,
      matchesTheWholeCell: this._matchesTheWholeCell,
      replaceRevealed: this._replaceRevealed,
      revealed: this._revealed
    }), this._stateUpdates$.next(i));
  }
};
var Y = class extends Ve {
  constructor(e, n) {
    super();
    o(this, "_providers", /* @__PURE__ */ new Set());
    o(this, "_state", new Nt());
    o(this, "_model");
    o(this, "_currentMatch$", new BehaviorSubject(null));
    o(this, "currentMatch$", this._currentMatch$.asObservable());
    o(this, "_replaceables$", new BehaviorSubject([]));
    o(this, "replaceables$", this._replaceables$.asObservable());
    o(this, "_focusSignal$", new Subject());
    o(this, "focusSignal$", this._focusSignal$.asObservable());
    this._injector = e, this._contextService = n;
  }
  get stateUpdates$() {
    return this._state.stateUpdates$;
  }
  get state$() {
    return this._state.state$;
  }
  get revealed() {
    return this._state.revealed;
  }
  get replaceRevealed() {
    return this._state.replaceRevealed;
  }
  dispose() {
    super.dispose(), this._currentMatch$.next(null), this._currentMatch$.complete(), this._replaceables$.next([]), this._replaceables$.complete(), this._focusSignal$.complete();
  }
  getProviders() {
    return this._providers;
  }
  getCurrentMatch() {
    var e;
    return (e = this._model) == null ? void 0 : e.getCurrentMatch();
  }
  getFindString() {
    return this._state.findString;
  }
  changeFindString(e) {
    this._state.changeState({ findString: e });
  }
  focusFindInput() {
    this._focusSignal$.next();
  }
  changeInputtingFindString(e) {
    e ? this._state.changeState({ inputtingFindString: e }) : this._state.changeState({ inputtingFindString: "", findString: "" });
  }
  changeReplaceString(e) {
    this._state.changeState({ replaceString: e });
  }
  changeMatchesTheWholeCell(e) {
    this._state.changeState({ matchesTheWholeCell: e });
  }
  changeCaseSensitive(e) {
    this._state.changeState({ caseSensitive: e });
  }
  changeFindBy(e) {
    this._state.changeState({ findBy: e }), this._toggleDisplayRawFormula(
      e === "formula"
      /* FORMULA */
    );
  }
  changeFindScope(e) {
    this._state.changeState({ findScope: e });
  }
  changeFindDirection(e) {
    this._state.changeState({ findDirection: e });
  }
  moveToNextMatch() {
    this._model && (this._state.replaceRevealed && !this._model.searched ? (this._state.changeState({ findString: this._state.inputtingFindString }), this._model.start()) : this._model.moveToNextMatch(), this._focusSignal$.next());
  }
  moveToPreviousMatch() {
    this._model && (this._state.replaceRevealed && !this._model.searched ? (this._state.changeState({ findString: this._state.inputtingFindString }), this._model.start()) : this._model.moveToPreviousMatch(), this._focusSignal$.next());
  }
  async replace() {
    return this._model ? this._model.replace() : false;
  }
  async replaceAll() {
    if (!this._model)
      throw new Error("[FindReplaceService] replaceAll: model is not initialized!");
    return this._model.replaceAll();
  }
  revealReplace() {
    this._state.changeState({ replaceRevealed: true, inputtingFindString: this._state.findString }), this._toggleRevealReplace(true);
  }
  focusSelection() {
    var e;
    (e = this._model) == null || e.focusSelection();
  }
  start(e = false) {
    if (this._providers.size === 0)
      return false;
    this._model = this._injector.createInstance(K, this._state, this._providers), this._model.currentMatch$.subscribe((i) => this._currentMatch$.next(i)), this._model.replaceables$.subscribe((i) => this._replaceables$.next(i));
    const n = te();
    return e && (n.replaceRevealed = true), this._state.changeState(n), this._toggleRevealReplace(e), true;
  }
  find() {
    var e;
    (e = this._model) == null || e.start();
  }
  terminate() {
    var e;
    (e = this._model) == null || e.dispose(), this._model = null, this._toggleDisplayRawFormula(false), this._toggleRevealReplace(false);
  }
  registerFindReplaceProvider(e) {
    return this._providers.add(e), We(() => this._providers.delete(e));
  }
  _toggleRevealReplace(e) {
    this._contextService.setContextValue(Ie, e);
  }
  _toggleDisplayRawFormula(e) {
    this._contextService.setContextValue(hx, e);
  }
};
Y = Fe([
  L(0, Inject(Injector)),
  L(1, Nr)
], Y);
var De = {
  id: "ui.command.replace-current-match",
  type: Ms.COMMAND,
  handler: (t) => t.get(f).replace()
};
var $t = "CONFIRM_REPLACE_ALL";
var ye2 = {
  id: "ui.command.replace-all-matches",
  type: Ms.COMMAND,
  handler: async (t) => {
    const e = t.get(at), n = t.get(Fn), i = t.get(et);
    if (!await e.confirm({
      id: $t,
      title: { title: n.t("find-replace.replace.confirm.title") },
      cancelText: n.t("button.cancel"),
      confirmText: n.t("button.confirm")
    }))
      return false;
    const r = await t.get(f).replaceAll(), { success: a, failure: l2 } = r;
    return l2 > 0 ? (a === 0 ? i.show({
      type: $C.Error,
      content: n.t("find-replace.replace.all-failure")
    }) : i.show({
      type: $C.Warning,
      content: n.t("find-replace.replace.partial-success", `${a}`, `${l2}`)
    }), false) : (i.show({
      type: $C.Success,
      content: n.t("find-replace.replace.all-success", `${a}`)
    }), true);
  }
};
var x = {
  id: "ui.operation.open-find-dialog",
  type: Ms.OPERATION,
  handler: (t) => {
    const e = t.get(f);
    return e.revealed ? e.focusFindInput() : e.start(), true;
  }
};
var ie2 = {
  id: "ui.operation.open-replace-dialog",
  type: Ms.OPERATION,
  handler: (t) => {
    const e = t.get(f);
    return e.revealed ? e.replaceRevealed ? e.focusFindInput() : e.revealReplace() : e.start(true), true;
  }
};
var Pe = {
  type: Ms.OPERATION,
  id: "ui.operation.go-to-next-match",
  handler: (t) => (t.get(f).moveToNextMatch(), true)
};
var Te = {
  type: Ms.OPERATION,
  id: "ui.operation.go-to-previous-match",
  handler: (t) => (t.get(f).moveToPreviousMatch(), true)
};
var xe = {
  type: Ms.OPERATION,
  id: "ui.operation.focus-selection",
  handler: (t) => (t.get(f).focusSelection(), true)
};
function Ee({ ref: t, ...e }) {
  const { icon: n, id: i, className: s, extend: r, ...a } = e, l2 = `univerjs-icon univerjs-icon-${i} ${s || ""}`.trim(), d = (0, import_react.useRef)(`_${Lt()}`);
  return Ne(n, `${i}`, {
    defIds: n.defIds,
    idSuffix: d.current
  }, {
    ref: t,
    className: l2,
    ...a
  }, r);
}
function Ne(t, e, n, i, s) {
  return (0, import_react.createElement)(t.tag, {
    key: e,
    ...Ot(t, n, s),
    ...i
  }, (At(t, n).children || []).map((r, a) => Ne(r, `${e}-${t.tag}-${a}`, n, void 0, s)));
}
function Ot(t, e, n) {
  const i = { ...t.attrs };
  n != null && n.colorChannel1 && i.fill === "colorChannel1" && (i.fill = n.colorChannel1), t.tag === "mask" && i.id && (i.id = i.id + e.idSuffix), Object.entries(i).forEach(([r, a]) => {
    r === "mask" && typeof a == "string" && (i[r] = a.replace(/url\(#(.*)\)/, `url(#$1${e.idSuffix})`));
  });
  const { defIds: s } = e;
  return !s || s.length === 0 || (t.tag === "use" && i["xlink:href"] && (i["xlink:href"] = i["xlink:href"] + e.idSuffix), Object.entries(i).forEach(([r, a]) => {
    typeof a == "string" && (i[r] = a.replace(/url\(#(.*)\)/, `url(#$1${e.idSuffix})`));
  })), i;
}
function At(t, e) {
  var i;
  const { defIds: n } = e;
  return !n || n.length === 0 ? t : t.tag === "defs" && ((i = t.children) != null && i.length) ? {
    ...t,
    children: t.children.map((s) => typeof s.attrs.id == "string" && n && n.includes(s.attrs.id) ? {
      ...s,
      attrs: {
        ...s.attrs,
        id: s.attrs.id + e.idSuffix
      }
    } : s)
  } : t;
}
function Lt() {
  return Math.random().toString(36).substring(2, 8);
}
Ee.displayName = "UniverIcon";
var wt = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M7.71899 1.36938C4.37604 1.36938 1.66602 4.07941 1.66602 7.42236C1.66602 10.7653 4.37604 13.4753 7.71899 13.4753C9.16744 13.4753 10.4971 12.9666 11.5389 12.118L13.6598 14.4109C13.8848 14.6542 14.2644 14.669 14.5077 14.444C14.7509 14.219 14.7657 13.8393 14.5407 13.5961L12.3906 11.2716C13.2536 10.2254 13.772 8.88442 13.772 7.42236C13.772 4.07941 11.0619 1.36938 7.71899 1.36938ZM2.86602 7.42236C2.86602 4.74215 5.03878 2.56938 7.71899 2.56938C10.3992 2.56938 12.572 4.74215 12.572 7.42236C12.572 10.1026 10.3992 12.2753 7.71899 12.2753C5.03878 12.2753 2.86602 10.1026 2.86602 7.42236Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var $e = (0, import_react.forwardRef)(function(e, n) {
  return (0, import_react.createElement)(Ee, Object.assign({}, e, {
    id: "search-icon",
    ref: n,
    icon: wt
  }));
});
$e.displayName = "SearchIcon";
function Oe(t) {
  const {
    findCompleted: e,
    localeService: n,
    matchesCount: i,
    matchesPosition: s,
    initialFindString: r,
    findReplaceService: a,
    onChange: l2,
    ...d
  } = t, [_, p2] = (0, import_react.useState)(r), I2 = e && i === 0 ? n.t("find-replace.dialog.no-result") : i === 0 ? " " : void 0;
  function S(g2) {
    s === i && g2 === 1 ? a.moveToNextMatch() : s === 1 && g2 === i || g2 < s ? a.moveToPreviousMatch() : a.moveToNextMatch();
  }
  return (0, import_jsx_runtime.jsx)("div", { className: "univer-relative univer-flex univer-items-center univer-gap-2", onDrag: (g2) => g2.stopPropagation(), children: (0, import_jsx_runtime.jsx)(
    Vx,
    {
      "data-u-comp": "search-input",
      autoFocus: true,
      placeholder: n.t("find-replace.dialog.find-placeholder"),
      value: _,
      onChange: (g2) => {
        p2(g2), l2 == null || l2(g2);
      },
      slot: (0, import_jsx_runtime.jsx)(
        Dx,
        {
          loop: true,
          text: I2,
          value: s,
          total: i,
          onChange: S
        }
      ),
      ...d
    }
  ) });
}
function Ae(t, e) {
  const n = (0, import_react.useCallback)(() => {
    var s;
    (s = document.querySelector(".univer-find-input input")) == null || s.focus();
  }, []), i = (0, import_react.useCallback)(() => {
    const s = document.querySelectorAll("[data-u-comp=find-replace-dialog] [data-u-comp=search-input]");
    return Array.from(s).some((r) => r === document.activeElement);
  }, []);
  return (0, import_react.useImperativeHandle)(e, () => ({ focus: n, selectHasFocus: i })), (0, import_react.useEffect)(() => {
    const s = t.focusSignal$.subscribe(() => n());
    return () => s.unsubscribe();
  }, [t, n]), { focus: n, selectHasFocus: i };
}
var Ut = (0, import_react.forwardRef)(function(e, n) {
  const i = useDependency(Fn), s = useDependency(f), r = useDependency(Ls), a = useObservable(s.state$, void 0, true), { findCompleted: l2, findString: d, matchesCount: _, matchesPosition: p2 } = a, M = (0, import_react.useCallback)(() => {
    r.executeCommand(ie2.id);
  }, [r]), I2 = Yi((S) => s.changeFindString(S), 500);
  return Ae(s, n), (0, import_jsx_runtime.jsxs)(import_jsx_runtime.Fragment, { children: [
    (0, import_jsx_runtime.jsx)(
      Oe,
      {
        findCompleted: l2,
        matchesCount: _,
        matchesPosition: p2,
        findReplaceService: s,
        localeService: i,
        initialFindString: d,
        onChange: I2
      }
    ),
    (0, import_jsx_runtime.jsx)("div", { className: "univer-mt-4 univer-text-center", children: (0, import_jsx_runtime.jsx)(
      "a",
      {
        className: "hover:univer-text-primary-500/80 univer-cursor-pointer univer-text-sm univer-text-primary-500 univer-transition-colors",
        onClick: M,
        children: i.t("find-replace.dialog.advanced-finding")
      }
    ) })
  ] });
});
var Bt = (0, import_react.forwardRef)(function(e, n) {
  const i = useDependency(f), s = useDependency(Fn), r = useDependency(Ls), a = useDependency(et), l2 = useObservable(i.currentMatch$, void 0, true), d = useObservable(i.replaceables$, void 0, true), _ = useObservable(i.state$, void 0, true), {
    matchesCount: p2,
    matchesPosition: M,
    findString: I2,
    inputtingFindString: S,
    replaceString: g2,
    caseSensitive: Ue,
    matchesTheWholeCell: Be,
    findDirection: We2,
    findScope: ke,
    findBy: je,
    findCompleted: W2
  } = _, Ve2 = S.length === 0, Ge = p2 === 0 || !(l2 != null && l2.replaceable), He = d.length === 0, Ke2 = (0, import_react.useCallback)(
    (h) => i.changeInputtingFindString(h),
    [i]
  ), qe2 = (0, import_react.useCallback)(
    (h) => i.changeReplaceString(h),
    [i]
  ), { focus: Ze2 } = Ae(i, n), ze2 = (0, import_react.useCallback)(() => {
    I2 === S ? i.moveToNextMatch() : (i.changeFindString(S), i.find());
  }, [I2, S, i]), Ye = (0, import_react.useCallback)(() => r.executeCommand(De.id), [r]), Je2 = (0, import_react.useCallback)(async () => {
    await r.executeCommand(ye2.id), Ze2();
  }, [r]), Qe2 = (0, import_react.useCallback)((h) => {
    i.changeFindDirection(h);
  }, [i]), Xe2 = (0, import_react.useCallback)((h) => {
    i.changeFindScope(h);
  }, [i]), et3 = (0, import_react.useCallback)((h) => {
    i.changeFindBy(h);
  }, [i]), tt2 = kt(s), it2 = jt(s), nt2 = Vt(s);
  return (0, import_react.useEffect)(() => {
    W2 && p2 === 0 && a.show({
      content: s.t("find-replace.dialog.no-match"),
      type: $C.Warning,
      duration: 5e3
    });
  }, [W2, p2, a, s]), (0, import_jsx_runtime.jsxs)("div", { children: [
    (0, import_jsx_runtime.jsx)(gE, { label: s.t("find-replace.dialog.find"), children: (0, import_jsx_runtime.jsx)(
      Oe,
      {
        findCompleted: W2,
        className: "univer-find-input",
        matchesCount: p2,
        matchesPosition: M,
        findReplaceService: i,
        localeService: s,
        initialFindString: S,
        onChange: Ke2
      }
    ) }),
    (0, import_jsx_runtime.jsx)(gE, { label: s.t("find-replace.dialog.replace"), children: (0, import_jsx_runtime.jsx)(
      Vx,
      {
        placeholder: s.t("find-replace.dialog.replace-placeholder"),
        value: g2,
        onChange: (h) => qe2(h)
      }
    ) }),
    (0, import_jsx_runtime.jsx)(gE, { label: s.t("find-replace.dialog.find-direction.title"), children: (0, import_jsx_runtime.jsx)(LE, { value: We2, options: it2, onChange: Qe2 }) }),
    (0, import_jsx_runtime.jsx)(yE, { children: (0, import_jsx_runtime.jsxs)(import_jsx_runtime.Fragment, { children: [
      (0, import_jsx_runtime.jsx)(gE, { label: s.t("find-replace.dialog.find-scope.title"), children: (0, import_jsx_runtime.jsx)(LE, { value: ke, options: tt2, onChange: Xe2 }) }),
      (0, import_jsx_runtime.jsx)(gE, { label: s.t("find-replace.dialog.find-by.title"), children: (0, import_jsx_runtime.jsx)(LE, { value: je, options: nt2, onChange: et3 }) })
    ] }) }),
    (0, import_jsx_runtime.jsx)(yE, { children: (0, import_jsx_runtime.jsxs)(import_jsx_runtime.Fragment, { children: [
      (0, import_jsx_runtime.jsx)(gE, { children: (0, import_jsx_runtime.jsx)(
        em,
        {
          checked: Ue,
          onChange: (h) => {
            i.changeCaseSensitive(h);
          },
          children: s.t("find-replace.dialog.case-sensitive")
        }
      ) }),
      (0, import_jsx_runtime.jsx)(gE, { children: (0, import_jsx_runtime.jsx)(
        em,
        {
          checked: Be,
          onChange: (h) => {
            i.changeMatchesTheWholeCell(h);
          },
          children: s.t("find-replace.dialog.match-the-whole-cell")
        }
      ) })
    ] }) }),
    (0, import_jsx_runtime.jsxs)("div", { className: "univer-mt-6 univer-flex univer-justify-between", children: [
      (0, import_jsx_runtime.jsx)(vr2, { variant: "primary", onClick: ze2, disabled: Ve2, children: s.t("find-replace.dialog.find") }),
      (0, import_jsx_runtime.jsxs)("span", { className: "univer-inline-flex univer-gap-2", children: [
        (0, import_jsx_runtime.jsx)(vr2, { disabled: Ge, onClick: Ye, children: s.t("find-replace.dialog.replace") }),
        (0, import_jsx_runtime.jsx)(vr2, { disabled: He, onClick: Je2, children: s.t("find-replace.dialog.replace-all") })
      ] })
    ] })
  ] });
});
function Wt() {
  const t = useDependency(f), e = useDependency(U1), n = useDependency(Nr), i = useObservable(t.state$, void 0, true), s = (0, import_react.useRef)(null);
  (0, import_react.useEffect)(() => {
    let d;
    return s.current && (d = e.registerContainerElement(s.current)), () => d == null ? void 0 : d.dispose();
  }, [e]);
  const r = (0, import_react.useRef)(null), a = (0, import_react.useCallback)(
    (d) => n.setContextValue(be, d),
    [n]
  ), l2 = (0, import_react.useCallback)(
    (d) => n.setContextValue(Re, d),
    [n]
  );
  return (0, import_react.useEffect)(() => {
    var _;
    const d = fromEvent(document, "focusin").subscribe((p2) => {
      var M;
      p2.target && ((M = s.current) != null && M.contains(p2.target)) ? a(true) : a(false), !r.current || !r.current.selectHasFocus() ? l2(false) : l2(true);
    });
    return (_ = r.current) == null || _.focus(), a(true), l2(true), () => {
      d.unsubscribe(), a(false);
    };
  }, [a, l2]), (0, import_jsx_runtime.jsx)("div", { ref: s, "data-u-comp": "find-replace-dialog", children: i.replaceRevealed ? (0, import_jsx_runtime.jsx)(Bt, { ref: r }) : (0, import_jsx_runtime.jsx)(Ut, { ref: r }) });
}
function kt(t) {
  const e = t.getCurrentLocale();
  return (0, import_react.useMemo)(() => [
    { label: t.t("find-replace.dialog.find-scope.current-sheet"), value: z2.SUBUNIT },
    { label: t.t("find-replace.dialog.find-scope.workbook"), value: z2.UNIT }
  ], [e]);
}
function jt(t) {
  const e = t.getCurrentLocale();
  return (0, import_react.useMemo)(() => [
    { label: t.t("find-replace.dialog.find-direction.row"), value: q.ROW },
    { label: t.t("find-replace.dialog.find-direction.column"), value: q.COLUMN }
  ], [e]);
}
function Vt(t) {
  const e = t.getCurrentLocale();
  return (0, import_react.useMemo)(() => [
    { label: t.t("find-replace.dialog.find-by.value"), value: Z.VALUE },
    { label: t.t("find-replace.dialog.find-by.formula"), value: Z.FORMULA }
  ], [e]);
}
function y(t) {
  return t.getContextValue(be);
}
function Gt(t) {
  return t.getContextValue(Ie);
}
function Le(t) {
  return t.getContextValue(Re);
}
var E = "7_find-replace-shortcuts";
function ne(t) {
  return t.getContextValue(gr);
}
function se(t) {
  return !t.getContextValue(mE);
}
var Ht = {
  id: x.id,
  description: "find-replace.shortcut.open-find-dialog",
  binding: q1.F | L1.CTRL_COMMAND,
  group: E,
  preconditions(t) {
    return !y(t) && ne(t) && se(t);
  }
};
var Kt = {
  id: x.id,
  description: "find-replace.shortcut.open-find-dialog",
  binding: q1.F | L1.CTRL_COMMAND,
  mac: q1.F | L1.MAC_CTRL,
  preconditions(t) {
    return !y(t) && ne(t) && se(t);
  }
};
var qt = {
  id: ie2.id,
  description: "find-replace.shortcut.open-replace-dialog",
  binding: q1.H | L1.CTRL_COMMAND,
  mac: q1.H | L1.MAC_CTRL,
  group: E,
  preconditions(t) {
    return ne(t) && se(t) && (!y(t) || !Gt(t));
  }
};
var Zt = {
  id: Pe.id,
  description: "find-replace.shortcut.go-to-next-match",
  binding: q1.ENTER,
  group: E,
  priority: 1e3,
  preconditions(t) {
    return Le(t) && y(t);
  }
};
var zt = {
  id: Te.id,
  description: "find-replace.shortcut.go-to-previous-match",
  binding: q1.ENTER | L1.SHIFT,
  group: E,
  priority: 1e3,
  preconditions(t) {
    return Le(t) && y(t);
  }
};
var Yt = {
  id: xe.id,
  description: "find-replace.shortcut.focus-selection",
  binding: q1.ESC,
  group: E,
  priority: 1e3,
  preconditions(t) {
    return y(t);
  }
};
function Jt(t) {
  const e = t.get(Nr);
  return {
    id: x.id,
    icon: "SearchIcon",
    tooltip: "find-replace.toolbar",
    type: H1.BUTTON,
    hidden$: Bi(t, we.UNIVER_SHEET),
    disabled$: combineLatest([
      e.subscribeContextValue$(mE),
      e.subscribeContextValue$(gr)
    ]).pipe(map(([n, i]) => n || !i))
  };
}
var Qt = {
  [fe.ORGANIZATION]: {
    [x.id]: {
      order: 2,
      menuItemFactory: Jt
    }
  }
};
var Xt = Object.getOwnPropertyDescriptor;
var ei = (t, e, n, i) => {
  for (var s = i > 1 ? void 0 : i ? Xt(e, n) : e, r = t.length - 1, a; r >= 0; r--)
    (a = t[r]) && (s = a(s) || s);
  return s;
};
var v = (t, e) => (n, i) => e(n, i, t);
var ce = "DESKTOP_FIND_REPLACE_DIALOG";
var we2 = 350;
var ti = 20;
var ii = 64;
var w = class extends h1 {
  constructor(e, n, i, s, r, a, l2, d, _) {
    super();
    o(this, "_closingListenerDisposable");
    this._univerInstanceService = e, this._menuManagerService = n, this._shortcutService = i, this._commandService = s, this._findReplaceService = r, this._dialogService = a, this._layoutService = l2, this._localeService = d, this._componentManager = _, this._initCommands(), this._initUI(), this._initShortcuts();
  }
  dispose() {
    var e;
    super.dispose(), (e = this._closingListenerDisposable) == null || e.dispose(), this._closingListenerDisposable = null;
  }
  _initCommands() {
    [
      x,
      ie2,
      Pe,
      Te,
      ye2,
      De,
      xe
    ].forEach((e) => {
      this.disposeWithMe(this._commandService.registerCommand(e));
    });
  }
  _initShortcuts() {
    [
      qt,
      Ht,
      Kt,
      zt,
      Zt,
      Yt
    ].forEach((e) => this.disposeWithMe(this._shortcutService.registerShortcut(e)));
  }
  _initUI() {
    [
      ["FindReplaceDialog", Wt],
      ["SearchIcon", $e]
    ].forEach(([e, n]) => {
      this.disposeWithMe(
        this._componentManager.register(e, n)
      );
    }), this._menuManagerService.mergeMenu(Qt), this._findReplaceService.stateUpdates$.pipe(takeUntil(this.dispose$)).subscribe((e) => {
      e.revealed === true && this._openPanel();
    });
  }
  _openPanel() {
    this._dialogService.open({
      id: ce,
      draggable: true,
      width: we2,
      title: { title: this._localeService.t("find-replace.dialog.title") },
      children: { label: "FindReplaceDialog" },
      destroyOnClose: true,
      mask: false,
      maskClosable: false,
      defaultPosition: ni(),
      preservePositionOnDestroy: true,
      onClose: () => this.closePanel()
    }), this._closingListenerDisposable = We(this._univerInstanceService.focused$.pipe(takeUntil(this.dispose$)).subscribe((e) => {
      (!e || !this._univerInstanceService.getUniverSheetInstance(e)) && this.closePanel();
    }));
  }
  closePanel() {
    this._closingListenerDisposable && (this._closingListenerDisposable.dispose(), this._closingListenerDisposable = null, this._dialogService.close(ce), this._findReplaceService.terminate(), queueMicrotask(() => this._layoutService.focus()));
  }
};
w = ei([
  v(0, vr),
  v(1, B1),
  v(2, ye),
  v(3, Ls),
  v(4, f),
  v(5, ct),
  v(6, U1),
  v(7, Inject(Fn)),
  v(8, Inject(S1))
], w);
function ni() {
  const { innerWidth: t } = window;
  return { x: t - we2 - ti, y: ii };
}
var si = "find-replace.config";
var le = {};
var ri2 = Object.getOwnPropertyDescriptor;
var ai = (t, e, n, i) => {
  for (var s = i > 1 ? void 0 : i ? ri2(e, n) : e, r = t.length - 1, a; r >= 0; r--)
    (a = t[r]) && (s = a(s) || s);
  return s;
};
var de = (t, e) => (n, i) => e(n, i, t);
var oi = "UNIVER_FIND_REPLACE_PLUGIN";
var V;
var he = (V = class extends Ol {
  constructor(t = le, e, n) {
    super(), this._config = t, this._injector = e, this._configService = n;
    const { ...i } = oo(
      {},
      le,
      this._config
    );
    this._configService.setConfig(si, i);
  }
  onStarting() {
    [
      [w],
      [f, { useClass: Y }]
    ].forEach((t) => this._injector.add(t));
  }
  onRendered() {
    this._injector.get(w);
  }
}, o(V, "pluginName", oi), V);
he = ai([
  de(1, Inject(Injector)),
  de(2, ic)
], he);

// node_modules/@univerjs/sheets-find-replace/lib/es/index.js
var ge = Object.defineProperty;
var fe2 = (h, e, t) => e in h ? ge(h, e, { enumerable: true, configurable: true, writable: true, value: t }) : h[e] = t;
var f2 = (h, e, t) => fe2(h, typeof e != "symbol" ? e + "" : e, t);
var se2 = {
  id: "sheet.command.replace",
  type: Ms.COMMAND,
  handler: async (h, e) => {
    const t = h.get(Qo), i = h.get(Ls), { unitId: n, replacements: r } = e, s = t.__tempBatchingUndoRedo(n), o3 = await Promise.all(r.map((c3) => i.executeCommand(Sn.id, {
      unitId: n,
      subUnitId: c3.subUnitId,
      value: c3.value
    })));
    return s.dispose(), Ke(o3, r);
  }
};
function Ke(h, e) {
  let t = 0, i = 0;
  return h.forEach((n, r) => {
    const s = e[r].count;
    n ? t += s : i += s;
  }), { success: t, failure: i };
}
var Qe = class extends x3 {
  constructor(t, i) {
    super(t, i);
    f2(this, "_activated", false);
    f2(this, "_inHiddenRange", false);
    f2(this, "_color");
    i && this.setShapeProps(i);
  }
  setShapeProps(t) {
    this._activated = !!t.activated, typeof t.inHiddenRange < "u" && (this._inHiddenRange = t.inHiddenRange), typeof t.color < "u" && (this._color = t.color), this.transformByState({
      width: t.width,
      height: t.height
    });
  }
  _draw(t) {
    const i = this._activated, n = `rgba(${this._color.r}, ${this._color.g}, ${this._color.b}, 0.35)`, r = `rgb(${this._color.r}, ${this._color.g}, ${this._color.b})`;
    I1.drawWith(t, {
      width: this.width,
      height: this.height,
      fill: n,
      stroke: i ? r : void 0,
      strokeWidth: i ? 2 : 0,
      evented: false
    });
  }
};
function Y2(h, e) {
  return h.startRow === e.startRow && h.startColumn === e.startColumn;
}
function K2(h, e) {
  return h.startRow < e.startRow || h.startRow === e.startRow && h.startColumn <= e.startColumn;
}
function Q(h, e) {
  return h.startColumn < e.startColumn || h.startColumn === e.startColumn && h.startRow <= e.startRow;
}
function Xe(h, e) {
  return h.startRow > e.startRow || h.startRow === e.startRow && h.startColumn >= e.startColumn;
}
function ze(h, e) {
  return h.startColumn > e.startColumn || h.startColumn === e.startColumn && h.startRow >= e.startRow;
}
function Je(h, e) {
  const { range: t } = h, { startRow: i, startColumn: n } = t, r = e.getMergedCell(i, n);
  return r ? En.equals(t, r) : t.endRow === t.startRow && t.endColumn === t.startColumn;
}
var Ze = Object.getOwnPropertyDescriptor;
var N = (h, e, t, i) => {
  for (var n = i > 1 ? void 0 : i ? Ze(e, t) : e, r = h.length - 1, s; r >= 0; r--)
    (s = h[r]) && (n = s(n) || n);
  return n;
};
var m = (h, e) => (t, i) => e(t, i, h);
var x2 = class extends Ve {
  constructor(e, t, i, n, r) {
    super();
    f2(this, "_provider");
    this._injector = e, this._findReplaceController = t, this._contextService = i, this._findReplaceService = n, this._commandService = r, this._init(), this._initCommands();
  }
  dispose() {
    super.dispose(), this._findReplaceController.closePanel(), this._provider.dispose();
  }
  _init() {
    const e = this._injector.createInstance(E2);
    this._provider = e, this.disposeWithMe(this._findReplaceService.registerFindReplaceProvider(e)), this.disposeWithMe(this._contextService.subscribeContextValue$(mE).pipe(filter((t) => !!t)).subscribe(() => this._findReplaceController.closePanel()));
  }
  _initCommands() {
    [se2].forEach((e) => this.disposeWithMe(this._commandService.registerCommand(e)));
  }
};
x2 = N([
  m(0, Inject(Injector)),
  m(1, Inject(w)),
  m(2, Nr),
  m(3, f),
  m(4, Ls)
], x2);
var qe = "sheets-find-replace-provider";
var et2 = 1e4;
var T = class extends gi {
  constructor(e, t, i, n, r, s, o3, c3) {
    super();
    f2(this, "_matchesUpdate$", new Subject());
    f2(this, "matchesUpdate$", this._matchesUpdate$.asObservable());
    f2(this, "_activelyChangingMatch$", new Subject());
    f2(this, "activelyChangingMatch$", this._activelyChangingMatch$.asObservable());
    f2(this, "_matchesByWorksheet", /* @__PURE__ */ new Map());
    f2(this, "_matches", []);
    f2(this, "_matchesPosition", 0);
    f2(this, "_activeHighlightIndex", -1);
    f2(this, "_highlightShapes", []);
    f2(this, "_currentHighlightShape", null);
    f2(this, "_query", null);
    f2(this, "_workbookSelections");
    this._workbook = e, this._sheetSkeletonManagerService = t, this._univerInstanceService = i, this._renderManagerService = n, this._commandService = r, this._contextService = s, this._themeService = o3, this._workbookSelections = c3.getWorkbookSelections(this.unitId);
  }
  get _matchesCount() {
    return this._matches.length;
  }
  get unitId() {
    return this._workbook.getUnitId();
  }
  get matchesCount() {
    return this._matchesCount;
  }
  get matchesPosition() {
    return this._matchesPosition;
  }
  get currentMatch() {
    return this._matchesPosition > 0 ? this._matches[this._matchesPosition - 1] : null;
  }
  dispose() {
    super.dispose(), this._disposeHighlights(), this._toggleDisplayRawFormula(false);
  }
  getMatches() {
    return this._matches;
  }
  start(e) {
    switch (this._query = e, e.findBy === Z.FORMULA ? this._toggleDisplayRawFormula(true) : this._toggleDisplayRawFormula(false), e.findScope) {
      case z2.UNIT:
        this.findInWorkbook(e);
        break;
      case z2.SUBUNIT:
      default:
        this.findInActiveWorksheet(e);
        break;
    }
  }
  focusSelection() {
    const e = this.currentMatch;
    e && this._commandService.executeCommand(ju.id, {
      unitId: e.unitId,
      subUnit: e.range.subUnitId,
      range: e.range.range
    });
  }
  _toggleDisplayRawFormula(e) {
    this._contextService.setContextValue(hx, e);
  }
  /**
   * Find all matches in the current workbook no matter which worksheet is activated.
   * @param query the query object
   * @returns the query complete event
   */
  findInWorkbook(e) {
    const t = this._workbook.getUnitId();
    let i, n = true;
    const r = () => {
      const s = this._workbook.getSheets().filter((o3) => !o3.isSheetHidden()).map((o3) => {
        const c3 = this._findInWorksheet(o3, e, t), l2 = o3.getSheetId(), { results: a } = c3;
        return a.length ? this._matchesByWorksheet.set(l2, c3.results) : this._matchesByWorksheet.delete(l2), c3;
      });
      this._matches = s.map((o3) => o3.results).flat(), this._updateFindHighlight(), n ? (i = { results: this._matches }, n = false) : this._matchesUpdate$.next(this._matches);
    };
    return this.disposeWithMe(this._sheetSkeletonManagerService.currentSkeleton$.subscribe(() => {
      this._updateFindHighlight(), this._updateCurrentHighlightShape(this._activeHighlightIndex);
    })), this.disposeWithMe(
      wg(this._commandService.onCommandExecuted.bind(this._commandService)).pipe(filter(([s, o3]) => s.id === pn.id && !(o3 != null && o3.fromFindReplace))).subscribe(() => {
        const s = this._workbook.getActiveSheet();
        if (!s)
          return;
        const o3 = s.getSheetId();
        this._matchesByWorksheet.has(o3) && this._findNextMatchOnActiveSheetChange(s);
      })
    ), this.disposeWithMe(
      wg(this._commandService.onCommandExecuted.bind(this._commandService)).pipe(
        filter(
          ([s]) => s.type === Ms.MUTATION && s.params.unitId === this._workbook.getUnitId()
        ),
        throttleTime(600, void 0, { leading: false, trailing: true })
      ).subscribe(() => r())
    ), r(), i;
  }
  /**
   * This method is used in `findInWorkbook`. When the active sheet changes, this method helps to find the next match
   * in the new worksheet.
   */
  _findNextMatchOnActiveSheetChange(e) {
    let t, i, n = 0;
    const r = this._matchesByWorksheet.get(e.getSheetId()), s = this._workbookSelections.getCurrentSelections();
    s != null && s.length ? ([t, n] = this._findNextMatchByRange(r, s[0].range), i = r.findIndex((o3) => o3 === t)) : (t = r[0], i = 0, n = this._matches.findIndex((o3) => o3 === t)), this._matchesPosition = n + 1, this._activelyChangingMatch$.next(t), this._activeHighlightIndex = i, this._updateFindHighlight(), this._updateCurrentHighlightShape(i);
  }
  /**
   * Find all matches (only) in the currently activated worksheet.
   * @param query the query object
   * @returns the query complete event
   */
  findInActiveWorksheet(e) {
    const t = this._workbook.getUnitId(), i = () => {
      var d;
      const c3 = this._workbook.getActiveSheet();
      if (!c3) return false;
      const l2 = this._workbookSelections.getCurrentSelections();
      return (d = l2 == null ? void 0 : l2.some((u3) => !Je(u3, c3))) != null ? d : false;
    };
    let n, r = true, s = false;
    const o3 = () => {
      const c3 = this._workbook.getActiveSheet();
      if (!c3) return { results: [] };
      const l2 = this.currentMatch;
      s = i();
      const a = this._workbookSelections.getCurrentSelections(), d = s ? this._findInSelections(c3, a, e, t) : this._findInWorksheet(c3, e, t);
      return this._matches = d.results, this._matchesPosition = this._tryRestoreLastMatchesPosition(l2, this._matches), r ? (n = d, r = false) : this._matchesUpdate$.next(this._matches), this._updateFindHighlight(), d;
    };
    return this.disposeWithMe(this._sheetSkeletonManagerService.currentSkeleton$.subscribe(() => this._updateFindHighlight())), this.disposeWithMe(
      merge(
        wg(this._commandService.onCommandExecuted.bind(this._commandService)).pipe(
          filter(([c3]) => {
            if (c3.type === Ms.MUTATION && c3.params.unitId === this._workbook.getUnitId())
              return true;
            if (c3.id === ie.id && c3.params.unitId === t) {
              const l2 = i();
              return l2 === false && s === false ? false : (s = l2, true);
            }
            return false;
          })
        ),
        // activeSheet$ is a BehaviorSubject, so we need to skip the first
        this._workbook.activeSheet$.pipe(skip(1))
      ).pipe(debounceTime(200)).subscribe(() => o3())
    ), o3(), n;
  }
  _findInRange(e, t, i, n, r) {
    const s = [], o3 = e.getSheetId(), c3 = (t.findDirection === q.COLUMN ? e.iterateByColumn : e.iterateByRow).bind(e)(i);
    for (const l2 of c3) {
      const { row: a, col: d, colSpan: u3, rowSpan: _, value: S } = l2;
      if (r != null && r(a, d) || !S || e.getRowFiltered(a))
        continue;
      const { hit: I2, replaceable: C2, isFormula: p2 } = tt(e, a, d, t, S);
      if (I2) {
        const U = {
          provider: qe,
          unitId: n,
          replaceable: C2,
          isFormula: p2,
          range: {
            subUnitId: o3,
            range: {
              startRow: a,
              startColumn: d,
              endColumn: d + (u3 != null ? u3 : 1) - 1,
              endRow: a + (_ != null ? _ : 1) - 1
            }
          }
        };
        s.push(U);
      }
    }
    return { results: s };
  }
  _findInSelections(e, t, i, n) {
    const { findDirection: r } = i, s = r === q.ROW ? K2 : Q, o3 = /* @__PURE__ */ new Set();
    return { results: t.map((l2) => this._findInRange(e, i, l2.range, n, (a, d) => {
      const u3 = `${a}-${d}`;
      return o3.has(u3) ? true : (o3.add(u3), false);
    }).results).flat().sort((l2, a) => s(l2.range.range, a.range.range) ? -1 : 1) };
  }
  /** Find matches in a given worksheet. */
  _findInWorksheet(e, t, i) {
    const n = e.getRowCount(), r = e.getColumnCount(), s = { startRow: 0, startColumn: 0, endRow: n - 1, endColumn: r - 1 };
    return this._findInRange(e, t, s, i);
  }
  _disposeHighlights() {
    var e;
    this._highlightShapes.forEach((t) => {
      var i;
      (i = t.getScene()) == null || i.makeDirty(), t.dispose();
    }), this._highlightShapes = [], (e = this._currentHighlightShape) == null || e.dispose(), this._currentHighlightShape = null;
  }
  _updateFindHighlight() {
    var d;
    this._disposeHighlights();
    const e = (d = this._sheetSkeletonManagerService.getCurrent()) == null ? void 0 : d.skeleton;
    if (!e)
      return;
    const t = this._workbook.getUnitId(), i = this._renderManagerService.getRenderById(t);
    if (i == null)
      return;
    const { scene: n } = i, r = this._matches, s = this._themeService.getColorFromTheme("yellow.400"), o3 = new bt(s).toRgb(), c3 = this._workbook.getActiveSheet();
    if (!c3)
      return;
    const l2 = c3.getSheetId(), a = r.filter((u3) => u3.range.subUnitId === l2).map((u3, _) => {
      const { startColumn: S, startRow: I2, endColumn: C2, endRow: p2 } = u3.range.range, U = lh(I2, S, n, e), oe = lh(p2, C2, n, e), { startX: D, startY: $ } = U, { endX: he2, endY: ce2 } = oe;
      let P = true;
      for (let v2 = I2; v2 <= p2; v2++)
        if (c3.getRowRawVisible(v2)) {
          P = false;
          break;
        }
      let B = true;
      for (let v2 = S; v2 <= C2; v2++)
        if (c3.getColVisible(v2)) {
          B = false;
          break;
        }
      const ae = P || B, le2 = B ? 2 : he2 - D, de2 = P ? 2 : ce2 - $, ue2 = {
        left: D,
        top: $,
        color: o3,
        width: le2,
        height: de2,
        evented: false,
        inHiddenRange: ae,
        zIndex: et2
      };
      return new Qe(`find-highlight-${_}`, ue2);
    });
    n.addObjects(a), this._highlightShapes = a, n.makeDirty();
  }
  _updateCurrentHighlightShape(e) {
    var t;
    if ((t = this._currentHighlightShape) == null || t.setShapeProps({ activated: false }), this._currentHighlightShape = null, e !== void 0) {
      const i = this._highlightShapes[e];
      if (!i)
        return;
      this._currentHighlightShape = i, i.setShapeProps({ activated: true });
    }
  }
  _getSheetObject() {
    return en(this._univerInstanceService, this._renderManagerService);
  }
  _focusMatch(e) {
    var i;
    const t = e.range.subUnitId;
    t !== ((i = this._workbook.getActiveSheet()) == null ? void 0 : i.getSheetId()) && this._commandService.executeCommand(ri.id, { unitId: this._workbook.getUnitId(), subUnitId: t }, { fromFindReplace: true }), this._commandService.executeCommand(
      Hm.id,
      { range: e.range.range },
      { fromFindReplace: true }
    );
  }
  _tryRestoreLastMatchesPosition(e, t) {
    if (!e) return 0;
    const { subUnitId: i } = e.range, { startColumn: n, startRow: r } = e.range.range, s = t.findIndex((o3) => {
      if (i !== o3.range.subUnitId)
        return false;
      const { startColumn: c3, startRow: l2 } = o3.range.range;
      return c3 === n && l2 === r;
    });
    return s > -1 ? s + 1 : 0;
  }
  moveToNextMatch(e) {
    var o3, c3, l2, a, d;
    if (!this._matches.length)
      return null;
    const t = (o3 = e == null ? void 0 : e.loop) != null ? o3 : false, i = (c3 = e == null ? void 0 : e.stayIfOnMatch) != null ? c3 : false, n = (l2 = e == null ? void 0 : e.noFocus) != null ? l2 : false, r = (a = e == null ? void 0 : e.ignoreSelection) != null ? a : false, s = this._findNextMatch(t, i, r);
    if (s) {
      const [u3, _] = s;
      return this._matchesPosition = _ + 1, this._query.findScope === z2.UNIT ? this._activeHighlightIndex = this._matchesByWorksheet.get(u3.range.subUnitId).findIndex((S) => S === u3) : this._activeHighlightIndex = _, n || this._focusMatch(u3), ((d = this._workbook.getActiveSheet()) == null ? void 0 : d.getSheetId()) === u3.range.subUnitId && this._updateCurrentHighlightShape(this._activeHighlightIndex), u3;
    }
    return this._matchesPosition = 0, this._updateCurrentHighlightShape(), null;
  }
  moveToPreviousMatch(e) {
    var o3, c3, l2, a, d;
    if (!this._matches.length)
      return null;
    const t = (o3 = e == null ? void 0 : e.loop) != null ? o3 : false, i = (c3 = e == null ? void 0 : e.stayIfOnMatch) != null ? c3 : false, n = (l2 = e == null ? void 0 : e.noFocus) != null ? l2 : false, r = (a = e == null ? void 0 : e.ignoreSelection) != null ? a : false, s = this._findPreviousMatch(t, i, r);
    if (s) {
      const [u3, _] = s;
      return this._matchesPosition = _ + 1, this._query.findScope === z2.UNIT ? this._activeHighlightIndex = this._matchesByWorksheet.get(u3.range.subUnitId).findIndex((S) => S === u3) : this._activeHighlightIndex = _, n || this._focusMatch(u3), ((d = this._workbook.getActiveSheet()) == null ? void 0 : d.getSheetId()) === u3.range.subUnitId && this._updateCurrentHighlightShape(this._activeHighlightIndex), u3;
    }
    return this._matchesPosition = 0, this._updateCurrentHighlightShape(), null;
  }
  _findPreviousMatch(e = false, t = false, i = false) {
    var o3;
    if (this.currentMatch) {
      const c3 = this._matches.findIndex((u3) => u3 === this.currentMatch);
      if (t)
        return [this.currentMatch, c3];
      const l2 = c3 - 1;
      if (!e && l2 < 0)
        return null;
      const a = this._matches.length, d = (l2 + a) % a;
      return [this._matches[d], d];
    }
    const n = this._workbookSelections.getCurrentLastSelection();
    if (i || !n) {
      const c3 = this._matches.length - 1;
      return [this._matches[c3], c3];
    }
    if (this._query.findScope !== z2.UNIT)
      return this._findPreviousMatchByRange(this._matches, n.range);
    const r = (o3 = this._workbook.getActiveSheet()) == null ? void 0 : o3.getSheetId();
    if (!r)
      return null;
    const s = this._findPreviousWorksheetThatHasAMatch(r, e);
    return s ? this._findPreviousMatchByRange(this._matchesByWorksheet.get(s), n.range) : null;
  }
  _findNextMatch(e = false, t = false, i = false) {
    var o3;
    if (this.currentMatch) {
      const c3 = this._matches.findIndex((u3) => u3 === this.currentMatch);
      if (t)
        return [this.currentMatch, c3];
      const l2 = c3 + 1, a = this._matches.length;
      if (!e && l2 >= a)
        return null;
      const d = l2 % a;
      return [this._matches[d], d];
    }
    const n = this._workbookSelections.getCurrentLastSelection();
    if (i || !n)
      return [this._matches[0], 0];
    if (this._query.findScope !== z2.UNIT)
      return this._findNextMatchByRange(this._matches, n.range, t);
    const r = (o3 = this._workbook.getActiveSheet()) == null ? void 0 : o3.getSheetId();
    if (!r)
      return null;
    const s = this._findNextWorksheetThatHasAMatch(r, e);
    return s ? this._findNextMatchByRange(this._matchesByWorksheet.get(s), n.range) : null;
  }
  _findPreviousWorksheetThatHasAMatch(e, t = false) {
    const i = this._workbook.getSheetOrders(), n = i.findIndex((o3) => o3 === e), s = (t ? BC(i, n + 1) : i.slice(0, n + 1)).findLast((o3) => this._matchesByWorksheet.has(o3));
    return s != null ? s : null;
  }
  _findNextWorksheetThatHasAMatch(e, t = false) {
    const i = this._workbook.getSheetOrders(), n = i.findIndex((o3) => o3 === e), s = (t ? BC(i, n) : i.slice(n)).find((o3) => this._matchesByWorksheet.has(o3));
    return s != null ? s : null;
  }
  _findNextMatchByRange(e, t, i = false) {
    const n = this._query.findDirection === q.ROW;
    let r = e.findIndex((o3) => {
      const c3 = o3.range.range;
      if (!(n ? K2(t, c3) : Q(t, c3)))
        return false;
      const a = Y2(t, c3);
      return i ? a : !a;
    });
    r === -1 && (r = e.length - 1);
    const s = e[r];
    return [s, this._matches.findIndex((o3) => o3 === s)];
  }
  _findPreviousMatchByRange(e, t, i = false) {
    const n = this._query.findDirection === q.ROW;
    let r = this._matches.findLastIndex((o3) => {
      const c3 = o3.range.range;
      if (!(n ? Xe(t, c3) : ze(t, c3)))
        return false;
      const a = Y2(t, c3);
      return i ? a : !a;
    });
    r === -1 && (r = 0);
    const s = e[r];
    return [s, this._matches.findIndex((o3) => o3 === s)];
  }
  async replace(e) {
    if (this._matchesCount === 0 || !this.currentMatch || !this._query || !this.currentMatch.replaceable)
      return false;
    const t = this.currentMatch.range, i = this._workbook.getSheetBySheetId(this.currentMatch.range.subUnitId), n = this._getReplacedCellData(
      this.currentMatch,
      i,
      this._query.findBy === Z.FORMULA,
      this._query.findString,
      e,
      this._query.caseSensitive ? "g" : "ig"
    ), r = {
      unitId: this.currentMatch.unitId,
      subUnitId: t.subUnitId,
      value: {
        [t.range.startRow]: {
          [t.range.startColumn]: n
        }
      }
    };
    return this._commandService.executeCommand(Sn.id, r);
  }
  async replaceAll(e) {
    if (this._matchesCount === 0 || !this._query)
      return { success: 0, failure: 0 };
    const t = this._workbook.getUnitId(), { findString: i, caseSensitive: n, findBy: r } = this._query, s = r === Z.FORMULA, o3 = n ? "g" : "ig", c3 = [];
    return jC(this._matches.filter((a) => a.replaceable), (a) => a.range.subUnitId).forEach((a, d) => {
      const u3 = new pt(), _ = this._workbook.getSheetBySheetId(d);
      a.forEach((S) => {
        const { startColumn: I2, startRow: C2 } = S.range.range, p2 = this._getReplacedCellData(S, _, s, i, e, o3);
        p2 && u3.setValue(C2, I2, p2);
      }), c3.push({
        count: a.length,
        subUnitId: d,
        value: u3.getMatrix()
      });
    }), c3 ? this._commandService.executeCommand(se2.id, {
      unitId: t,
      replacements: c3
    }) : { success: 0, failure: 0 };
  }
  _getReplacedCellData(e, t, i, n, r, s) {
    var _;
    const o3 = e.range.range, { startRow: c3, startColumn: l2 } = o3, a = t.getCellRaw(c3, l2);
    if (e.isFormula)
      return i ? { f: a.f.replace(new RegExp(X2(n), s), r), v: null } : null;
    if (!!((_ = a.p) != null && _.body)) {
      const S = J.deepClone(a.p);
      return AR(S.body, n, r, this._query.caseSensitive), { p: S };
    }
    return { v: a.v.toString().replace(new RegExp(X2(n), s), r) };
  }
};
T = N([
  m(2, vr),
  m(3, ME),
  m(4, Ls),
  m(5, Nr),
  m(6, Inject(Gi)),
  m(7, Inject(z))
], T);
function X2(h) {
  return h.replace(/[-[\]{}()*+?.,\\^$|#\s]/g, "\\$&");
}
var E2 = class extends Ve {
  constructor(e, t, i) {
    super();
    f2(this, "_findModelsByUnitId", /* @__PURE__ */ new Map());
    this._univerInstanceService = e, this._renderManagerService = t, this._injector = i;
  }
  async find(e) {
    this._terminate();
    const t = this._univerInstanceService.getCurrentUnitOfType(we.UNIVER_SHEET);
    if (!t) return [];
    const i = this._preprocessQuery(e), n = this._renderManagerService.getRenderById(t.getUnitId()).with(ue), r = this._injector.createInstance(T, t, n);
    return this._findModelsByUnitId.set(t.getUnitId(), r), r.start(i), [r];
  }
  terminate() {
    this._terminate();
  }
  _terminate() {
    this._findModelsByUnitId.forEach((e) => e.dispose()), this._findModelsByUnitId.clear();
  }
  /**
   * Parsed the query object before do actual searching in favor of performance.
   * @param query the raw query object
   * @returns the parsed query object
   */
  _preprocessQuery(e) {
    let t = e.caseSensitive ? e.findString : e.findString.toLowerCase();
    return t = t.trim(), {
      ...e,
      findString: t
    };
  }
};
E2 = N([
  m(0, vr),
  m(1, ME),
  m(2, Inject(Injector))
], E2);
var g = { hit: false, replaceable: false, isFormula: false, rawData: null };
function tt(h, e, t, i, n) {
  const { findBy: r } = i, s = r === Z.FORMULA, o3 = h.getCellRaw(e, t);
  return g.rawData = o3, !(o3 != null && o3.f) ? (g.isFormula = false, W(n, i) ? o3 ? (g.hit = true, g.replaceable = true) : (g.hit = true, g.replaceable = false) : (g.hit = false, g.replaceable = false), g) : (g.isFormula = true, s ? W({ v: o3.f }, i) ? (g.hit = true, g.replaceable = true, g) : (g.hit = false, g.replaceable = false, g) : (g.replaceable = false, W(n, i) ? g.hit = true : g.hit = false, g));
}
function W(h, e) {
  let t = it(h);
  return t ? e.matchesTheWholeCell ? (t = nt(t), e.caseSensitive ? t === e.findString : t.toLowerCase() === e.findString) : e.caseSensitive ? t.indexOf(e.findString) > -1 : t.toLowerCase().indexOf(e.findString) > -1 : false;
}
function it(h) {
  var t, i, n;
  const e = (n = (i = (t = h == null ? void 0 : h.p) == null ? void 0 : t.body) == null ? void 0 : i.dataStream) != null ? n : h == null ? void 0 : h.v;
  return typeof e == "number" ? `${e}` : typeof e == "boolean" ? e ? "1" : "0" : e;
}
function nt(h) {
  return h.replace(/^ +/g, "").replace(/ +$/g, "");
}
var st2 = "sheets-find-replace.config";
var z3 = {};
var rt2 = Object.defineProperty;
var ot = Object.getOwnPropertyDescriptor;
var ht = (h, e, t) => e in h ? rt2(h, e, { enumerable: true, configurable: true, writable: true, value: t }) : h[e] = t;
var ct2 = (h, e, t, i) => {
  for (var n = i > 1 ? void 0 : i ? ot(e, t) : e, r = h.length - 1, s; r >= 0; r--)
    (s = h[r]) && (n = s(n) || n);
  return n;
};
var J2 = (h, e) => (t, i) => e(t, i, h);
var re = (h, e, t) => ht(h, typeof e != "symbol" ? e + "" : e, t);
var at2 = "SHEET_FIND_REPLACE_PLUGIN";
var y2 = class extends Ol {
  constructor(h = z3, e, t) {
    super(), this._config = h, this._injector = e, this._configService = t;
    const { ...i } = oo(
      {},
      z3,
      this._config
    );
    this._configService.setConfig(st2, i);
  }
  onStarting() {
    [[x2]].forEach((h) => this._injector.add(h));
  }
  onSteady() {
    this._injector.get(x2);
  }
};
re(y2, "pluginName", at2);
re(y2, "type", we.UNIVER_SHEET);
y2 = ct2([
  qR(ss, ss, he),
  J2(1, Inject(Injector)),
  J2(2, ic)
], y2);

// node_modules/@univerjs/sheets-find-replace/lib/es/facade.js
var u2 = Object.defineProperty;
var p = (a, e, t) => e in a ? u2(a, e, { enumerable: true, configurable: true, writable: true, value: t }) : a[e] = t;
var c2 = (a, e, t) => p(a, typeof e != "symbol" ? e + "" : e, t);
var w2 = Object.getOwnPropertyDescriptor;
var C = (a, e, t, s) => {
  for (var n = s > 1 ? void 0 : s ? w2(e, t) : e, i = a.length - 1, r; i >= 0; i--)
    (r = a[i]) && (n = r(n) || n);
  return n;
};
var o2 = (a, e) => (t, s) => e(t, s, a);
var l = class extends Ve {
  constructor(e, t, s, n) {
    super();
    c2(this, "_state", new Nt());
    c2(this, "_model");
    c2(this, "_complete");
    this._injector = t, this._univerInstanceService = s, this._findReplaceService = n;
    const i = this._findReplaceService.getProviders();
    this._model = this._injector.createInstance(K, this._state, i);
    const r = {
      ...te(),
      ...e
    };
    this._state.changeState(r);
  }
  findAll() {
    return !this._state.findCompleted || !this._complete ? [] : this._complete.results.map((e) => this._findMatchToFRange(e));
  }
  findNext() {
    var t;
    if (!this._state.findCompleted || !this._complete)
      return null;
    const e = (t = this._model) == null ? void 0 : t.moveToNextMatch();
    return e ? this._findMatchToFRange(e) : null;
  }
  findPrevious() {
    var t;
    const e = (t = this._model) == null ? void 0 : t.moveToPreviousMatch();
    return e ? this._findMatchToFRange(e) : null;
  }
  getCurrentMatch() {
    var t;
    if (!this._state.findCompleted || !this._complete)
      throw new Error("Find operation is not completed.");
    const e = (t = this._model) == null ? void 0 : t.currentMatch$.value;
    return e ? this._findMatchToFRange(e) : null;
  }
  async matchCaseAsync(e) {
    return this._state.changeState({ caseSensitive: e, findCompleted: false }), new Promise((t) => {
      const s = this._state.stateUpdates$.subscribe(async (n) => {
        n.findCompleted === true && (s.unsubscribe(), await this.ensureCompleteAsync(), t(this));
      });
    });
  }
  async matchEntireCellAsync(e) {
    return this._state.changeState({ matchesTheWholeCell: e, findCompleted: false }), new Promise((t) => {
      const s = this._state.stateUpdates$.subscribe(async (n) => {
        n.findCompleted === true && (s.unsubscribe(), await this.ensureCompleteAsync(), t(this));
      });
    });
  }
  async matchFormulaTextAsync(e) {
    return this._state.changeState({ findBy: e ? Z.FORMULA : Z.VALUE, findCompleted: false }), new Promise((t) => {
      const s = this._state.stateUpdates$.subscribe(async (n) => {
        n.findCompleted === true && (s.unsubscribe(), await this.ensureCompleteAsync(), t(this));
      });
    });
  }
  async replaceAllWithAsync(e) {
    var s, n, i;
    await this._state.changeState({ replaceRevealed: true, replaceString: e });
    const t = (i = (n = await ((s = this._model) == null ? void 0 : s.replaceAll())) == null ? void 0 : n.success) != null ? i : 0;
    return this._state.changeState({ replaceRevealed: false }), t;
  }
  async replaceWithAsync(e) {
    var t;
    return await this._state.changeState({ replaceRevealed: true, replaceString: e }), await ((t = this._model) == null ? void 0 : t.replace()), this._state.changeState({ replaceRevealed: false }), true;
  }
  async ensureCompleteAsync() {
    var e;
    this._complete = await ((e = this._model) == null ? void 0 : e.start());
  }
  _findMatchToFRange(e) {
    const { unitId: t } = e, { subUnitId: s, range: n } = e.range, i = this._univerInstanceService.getUnit(t), r = i.getSheetBySheetId(s);
    return this._injector.createInstance(k, i, r, n);
  }
};
l = C([
  o2(1, Inject(Injector)),
  o2(2, vr),
  o2(3, f)
], l);
var R = class extends I {
  async createTextFinderAsync(e) {
    const t = { findString: e }, s = this._injector.createInstance(l, t);
    return await s.ensureCompleteAsync(), s;
  }
};
I.extend(R);

// node_modules/@univerjs/preset-sheets-find-replace/lib/es/index.js
function f3(n = {}) {
  return {
    plugins: [
      [he],
      [y2]
    ].filter((e) => !!e)
  };
}
export {
  Z as FindBy,
  q as FindDirection,
  gi as FindModel,
  w as FindReplaceController,
  K as FindReplaceModel,
  Nt as FindReplaceState,
  z2 as FindScope,
  Pe as GoToNextMatchOperation,
  Te as GoToPreviousMatchOperation,
  f as IFindReplaceService,
  x as OpenFindDialogOperation,
  ie2 as OpenReplaceDialogOperation,
  ye2 as ReplaceAllMatchesCommand,
  De as ReplaceCurrentMatchCommand,
  se2 as SheetReplaceCommand,
  x2 as SheetsFindReplaceController,
  he as UniverFindReplacePlugin,
  y2 as UniverSheetsFindReplacePlugin,
  f3 as UniverSheetsFindReplacePreset,
  te as createInitFindReplaceState
};
//# sourceMappingURL=@univerjs_presets_preset-sheets-find-replace.js.map
