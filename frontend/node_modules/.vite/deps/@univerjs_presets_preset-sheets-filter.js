import {
  He,
  Me,
  Se,
  Ue,
  Xt,
  wt as wt2
} from "./chunk-3V44O7ZC.js";
import {
  B,
  Bt,
  Ee,
  Ft,
  G,
  I,
  M,
  Ne,
  Oe,
  R,
  Rt,
  St,
  ae,
  ar,
  b,
  cr,
  dr,
  fe,
  p,
  pt,
  q,
  ur,
  wt,
  y,
  yt,
  zt
} from "./chunk-D7B6XFA6.js";
import {
  S,
  k,
  xn
} from "./chunk-FOCXVU2X.js";
import "./chunk-DZMX4FYO.js";
import "./chunk-I7I3GTAS.js";
import {
  I as I2,
  O,
  j
} from "./chunk-YFGUMDM2.js";
import {
  Inject,
  Injector,
  Ls
} from "./chunk-RGZYGL3P.js";
import "./chunk-DC5AMYBS.js";

// node_modules/@univerjs/sheets-filter/lib/es/facade.js
var E = Object.getOwnPropertyDescriptor;
var R2 = (i, e, t, r) => {
  for (var n = r > 1 ? void 0 : r ? E(e, t) : e, a = i.length - 1, c; a >= 0; a--)
    (c = i[a]) && (n = c(n) || n);
  return n;
};
var g = (i, e) => (t, r) => e(t, r, i);
var s = class {
  constructor(i, e, t, r, n) {
    this._workbook = i, this._worksheet = e, this._filterModel = t, this._injector = r, this._commandSrv = n;
  }
  /**
   * Get the filtered out rows by this filter.
   * @returns {number[]} Filtered out rows by this filter.
   * @example
   * ```typescript
   * const fWorkbook = univerAPI.getActiveWorkbook();
   * const fWorksheet = fWorkbook.getActiveSheet();
   *
   * // Set some values of the range C1:F10
   * const fRange = fWorksheet.getRange('C1:F10');
   * fRange.setValues([
   *   [1, 2, 3, 4],
   *   [2, 3, 4, 5],
   *   [3, 4, 5, 6],
   *   [4, 5, 6, 7],
   *   [5, 6, 7, 8],
   *   [6, 7, 8, 9],
   *   [7, 8, 9, 10],
   *   [8, 9, 10, 11],
   *   [9, 10, 11, 12],
   *   [10, 11, 12, 13],
   * ]);
   *
   * // Create a filter on the range C1:F10
   * let fFilter = fRange.createFilter();
   *
   * // If the filter already exists, remove it and create a new one
   * if (!fFilter) {
   *   fRange.getFilter().remove();
   *   fFilter = fRange.createFilter();
   * }
   *
   * // Set the filter criteria of the column C, filter out the rows that are not 1, 5, 9
   * const column = fWorksheet.getRange('C:C').getColumn();
   * fFilter.setColumnFilterCriteria(column, {
   *   colId: 0,
   *   filters: {
   *     filters: ['1', '5', '9'],
   *   },
   * });
   *
   * // Get the filtered out rows
   * console.log(fFilter.getFilteredOutRows()); // [1, 2, 3, 5, 6, 7, 9]
   * ```
   */
  getFilteredOutRows() {
    return Array.from(this._filterModel.filteredOutRows).sort();
  }
  /**
   * Get the filter criteria of a column.
   * @param {number} column - The column index.
   * @returns {Nullable<IFilterColumn>} The filter criteria of the column.
   * @example
   * ```typescript
   * const fWorkbook = univerAPI.getActiveWorkbook();
   * const fWorksheet = fWorkbook.getActiveSheet();
   *
   * // Set some values of the range C1:F10
   * const fRange = fWorksheet.getRange('C1:F10');
   * fRange.setValues([
   *   [1, 2, 3, 4],
   *   [2, 3, 4, 5],
   *   [3, 4, 5, 6],
   *   [4, 5, 6, 7],
   *   [5, 6, 7, 8],
   *   [6, 7, 8, 9],
   *   [7, 8, 9, 10],
   *   [8, 9, 10, 11],
   *   [9, 10, 11, 12],
   *   [10, 11, 12, 13],
   * ]);
   *
   * // Create a filter on the range C1:F10
   * let fFilter = fRange.createFilter();
   *
   * // If the filter already exists, remove it and create a new one
   * if (!fFilter) {
   *   fRange.getFilter().remove();
   *   fFilter = fRange.createFilter();
   * }
   *
   * // Set the filter criteria of the column C, filter out the rows that are not 1, 5, 9
   * const column = fWorksheet.getRange('C:C').getColumn();
   * fFilter.setColumnFilterCriteria(column, {
   *   colId: 0,
   *   filters: {
   *     filters: ['1', '5', '9'],
   *   },
   * });
   *
   * // Print the filter criteria of the column C and D
   * console.log(fFilter.getColumnFilterCriteria(column)); // { colId: 0, filters: { filters: ['1', '5', '9'] } }
   * console.log(fFilter.getColumnFilterCriteria(column + 1)); // undefined
   * ```
   */
  getColumnFilterCriteria(i) {
    var e;
    return (e = this._filterModel.getFilterColumn(i)) == null ? void 0 : e.getColumnData();
  }
  /**
   * Clear the filter criteria of a column.
   * @param {number} column - The column index.
   * @returns {FFilter} The FFilter instance for chaining.
   * @example
   * ```typescript
   * const fWorkbook = univerAPI.getActiveWorkbook();
   * const fWorksheet = fWorkbook.getActiveSheet();
   *
   * // Set some values of the range C1:F10
   * const fRange = fWorksheet.getRange('C1:F10');
   * fRange.setValues([
   *   [1, 2, 3, 4],
   *   [2, 3, 4, 5],
   *   [3, 4, 5, 6],
   *   [4, 5, 6, 7],
   *   [5, 6, 7, 8],
   *   [6, 7, 8, 9],
   *   [7, 8, 9, 10],
   *   [8, 9, 10, 11],
   *   [9, 10, 11, 12],
   *   [10, 11, 12, 13],
   * ]);
   *
   * // Create a filter on the range C1:F10
   * let fFilter = fRange.createFilter();
   *
   * // If the filter already exists, remove it and create a new one
   * if (!fFilter) {
   *   fRange.getFilter().remove();
   *   fFilter = fRange.createFilter();
   * }
   *
   * // Set the filter criteria of the column C, filter out the rows that are not 1, 5, 9
   * const column = fWorksheet.getRange('C:C').getColumn();
   * fFilter.setColumnFilterCriteria(column, {
   *   colId: 0,
   *   filters: {
   *     filters: ['1', '5', '9'],
   *   },
   * });
   *
   * // Clear the filter criteria of the column C after 3 seconds
   * setTimeout(() => {
   *   fFilter.removeColumnFilterCriteria(column);
   * }, 3000);
   * ```
   */
  removeColumnFilterCriteria(i) {
    return this._commandSrv.syncExecuteCommand(cr.id, {
      unitId: this._workbook.getUnitId(),
      subUnitId: this._worksheet.getSheetId(),
      col: i,
      criteria: null
    }), this;
  }
  /**
   * Set the filter criteria of a column.
   * @param {number} column - The column index.
   * @param {ISetSheetsFilterCriteriaCommandParams['criteria']} criteria - The new filter criteria.
   * @returns {FFilter} The FFilter instance for chaining.
   * @example
   * ```typescript
   * const fWorkbook = univerAPI.getActiveWorkbook();
   * const fWorksheet = fWorkbook.getActiveSheet();
   *
   * // Set some values of the range C1:F10
   * const fRange = fWorksheet.getRange('C1:F10');
   * fRange.setValues([
   *   [1, 2, 3, 4],
   *   [2, 3, 4, 5],
   *   [3, 4, 5, 6],
   *   [4, 5, 6, 7],
   *   [5, 6, 7, 8],
   *   [6, 7, 8, 9],
   *   [7, 8, 9, 10],
   *   [8, 9, 10, 11],
   *   [9, 10, 11, 12],
   *   [10, 11, 12, 13],
   * ]);
   *
   * // Create a filter on the range C1:F10
   * let fFilter = fRange.createFilter();
   *
   * // If the filter already exists, remove it and create a new one
   * if (!fFilter) {
   *   fRange.getFilter().remove();
   *   fFilter = fRange.createFilter();
   * }
   *
   * // Set the filter criteria of the column C, filter out the rows that are not 1, 5, 9
   * const column = fWorksheet.getRange('C:C').getColumn();
   * fFilter.setColumnFilterCriteria(column, {
   *   colId: 0,
   *   filters: {
   *     filters: ['1', '5', '9'],
   *   },
   * });
   * ```
   */
  setColumnFilterCriteria(i, e) {
    return this._commandSrv.syncExecuteCommand(cr.id, {
      unitId: this._workbook.getUnitId(),
      subUnitId: this._worksheet.getSheetId(),
      col: i,
      criteria: e
    }), this;
  }
  /**
   * Get the range of the filter.
   * @returns {FRange} The range of the filter.
   * @example
   * ```typescript
   * const fWorkbook = univerAPI.getActiveWorkbook();
   * const fWorksheet = fWorkbook.getActiveSheet();
   * const fFilter = fWorksheet.getFilter();
   * console.log(fFilter?.getRange().getA1Notation());
   * ```
   */
  getRange() {
    const i = this._filterModel.getRange();
    return this._injector.createInstance(k, this._workbook, this._worksheet, i);
  }
  /**
   * Remove the filter criteria of all columns.
   * @returns {FFilter} The FFilter instance for chaining.
   * @example
   * ```typescript
   * const fWorkbook = univerAPI.getActiveWorkbook();
   * const fWorksheet = fWorkbook.getActiveSheet();
   *
   * // Set some values of the range C1:F10
   * const fRange = fWorksheet.getRange('C1:F10');
   * fRange.setValues([
   *   [1, 2, 3, 4],
   *   [2, 3, 4, 5],
   *   [3, 4, 5, 6],
   *   [4, 5, 6, 7],
   *   [5, 6, 7, 8],
   *   [6, 7, 8, 9],
   *   [7, 8, 9, 10],
   *   [8, 9, 10, 11],
   *   [9, 10, 11, 12],
   *   [10, 11, 12, 13],
   * ]);
   *
   * // Create a filter on the range C1:F10
   * let fFilter = fRange.createFilter();
   *
   * // If the filter already exists, remove it and create a new one
   * if (!fFilter) {
   *   fRange.getFilter().remove();
   *   fFilter = fRange.createFilter();
   * }
   *
   * // Set the filter criteria of the column C, filter out the rows that are not 1, 5, 9
   * const column = fWorksheet.getRange('C:C').getColumn();
   * fFilter.setColumnFilterCriteria(column, {
   *   colId: 0,
   *   filters: {
   *     filters: ['1', '5', '9'],
   *   },
   * });
   *
   * // Clear the filter criteria of all columns after 3 seconds
   * setTimeout(() => {
   *   fFilter.removeFilterCriteria();
   * }, 3000);
   * ```
   */
  removeFilterCriteria() {
    return this._commandSrv.syncExecuteCommand(dr.id), this;
  }
  /**
   * Remove the filter from the worksheet.
   * @returns {boolean} True if the filter is removed successfully; otherwise, false.
   * @example
   * ```typescript
   * const fWorkbook = univerAPI.getActiveWorkbook();
   * const fWorksheet = fWorkbook.getActiveSheet();
   * const fRange = fWorksheet.getRange('A1:D14');
   * let fFilter = fRange.createFilter();
   *
   * // If the worksheet already has a filter, remove it and create a new filter.
   * if (!fFilter) {
   *   fWorksheet.getFilter().remove();
   *   fFilter = fRange.createFilter();
   * }
   * console.log(fFilter);
   * ```
   */
  remove() {
    return this._commandSrv.syncExecuteCommand(zt.id, {
      unitId: this._workbook.getUnitId(),
      subUnitId: this._worksheet.getSheetId()
    });
  }
};
s = R2([
  g(3, Inject(Injector)),
  g(4, Ls)
], s);
var I3 = class extends k {
  createFilter() {
    return this._getFilterModel() || !this._commandService.syncExecuteCommand(Bt.id, {
      unitId: this._workbook.getUnitId(),
      subUnitId: this._worksheet.getSheetId(),
      range: this._range
    }) ? null : this.getFilter();
  }
  /**
   * Get the filter for the current range's worksheet.
   * @returns {FFilter | null} The interface class to handle the filter. If the worksheet does not have a filter,
   * this method would return `null`.
   */
  getFilter() {
    const e = this._getFilterModel();
    return e ? this._injector.createInstance(s, this._workbook, this._worksheet, e) : null;
  }
  _getFilterModel() {
    return this._injector.get(M).getFilterModel(
      this._workbook.getUnitId(),
      this._worksheet.getSheetId()
    );
  }
};
k.extend(I3);
var x = class extends S {
  getFilter() {
    const e = this._getFilterModel();
    return e ? this._injector.createInstance(s, this._workbook, this._worksheet, e) : null;
  }
  _getFilterModel() {
    return this._injector.get(M).getFilterModel(
      this._workbook.getUnitId(),
      this._worksheet.getSheetId()
    );
  }
};
S.extend(x);
var U = class {
  get CustomFilterOperator() {
    return I;
  }
};
O.extend(U);
var M2 = class extends j {
  get SheetBeforeRangeFilter() {
    return "SheetBeforeRangeFilter";
  }
  get SheetRangeFiltered() {
    return "SheetRangeFiltered";
  }
  get SheetRangeFilterCleared() {
    return "SheetRangeFilterCleared";
  }
  get SheetBeforeRangeFilterClear() {
    return "SheetBeforeRangeFilterClear";
  }
};
j.extend(M2);
j.extend(xn);
var p2 = class extends I2 {
  /**
   * @ignore
   */
  _initialize(e) {
    const t = e.get(Ls);
    this.registerEventHandler(
      this.Event.SheetBeforeRangeFilter,
      () => t.beforeCommandExecuted((r) => {
        r.id === cr.id && this._beforeRangeFilter(r);
      })
    ), this.registerEventHandler(
      this.Event.SheetBeforeRangeFilterClear,
      () => t.beforeCommandExecuted((r) => {
        r.id === dr.id && this._beforeRangeFilterClear();
      })
    ), this.registerEventHandler(
      this.Event.SheetRangeFiltered,
      () => t.onCommandExecuted((r) => {
        r.id === cr.id && this._onRangeFiltered(r);
      })
    ), this.registerEventHandler(
      this.Event.SheetRangeFilterCleared,
      () => t.onCommandExecuted((r) => {
        r.id === dr.id && this._onRangeFilterCleared();
      })
    );
  }
  _beforeRangeFilter(e) {
    const t = e.params, r = this.getUniverSheet(t.unitId), n = {
      workbook: r,
      worksheet: r.getSheetBySheetId(t.subUnitId),
      col: t.col,
      criteria: t.criteria
    };
    if (this.fireEvent(this.Event.SheetBeforeRangeFilter, n), n.cancel)
      throw new Error("SetSheetsFilterCriteriaCommand canceled.");
  }
  _onRangeFiltered(e) {
    const t = e.params, r = this.getUniverSheet(t.unitId), n = {
      workbook: r,
      worksheet: r.getSheetBySheetId(t.subUnitId),
      col: t.col,
      criteria: t.criteria
    };
    this.fireEvent(this.Event.SheetRangeFiltered, n);
  }
  _beforeRangeFilterClear() {
    const e = this.getActiveWorkbook();
    if (!e) return;
    const t = {
      workbook: e,
      worksheet: e.getActiveSheet()
    };
    if (this.fireEvent(this.Event.SheetBeforeRangeFilterClear, t), t.cancel)
      throw new Error("SetSheetsFilterCriteriaCommand canceled.");
  }
  _onRangeFilterCleared() {
    const e = this.getActiveWorkbook();
    if (!e) return;
    const t = {
      workbook: e,
      worksheet: e.getActiveSheet()
    };
    this.fireEvent(this.Event.SheetRangeFilterCleared, t);
  }
};
I2.extend(p2);

// node_modules/@univerjs/preset-sheets-filter/lib/es/index.js
function p3(e = {}) {
  const { enableSyncSwitch: r } = e;
  return {
    plugins: [
      [fe, { enableSyncSwitch: r }],
      He
    ].filter((t) => !!t)
  };
}
export {
  Xt as ChangeFilterByOperation,
  dr as ClearSheetsFilterCriteriaCommand,
  Se as CloseFilterPanelOperation,
  I as CustomFilterOperator,
  Ee as FILTER_MUTATIONS,
  b as FilterBy,
  yt as FilterColumn,
  q as FilterModel,
  Me as OpenFilterPanelOperation,
  ur as ReCalcSheetsFilterCommand,
  B as ReCalcSheetsFilterMutation,
  zt as RemoveSheetFilterCommand,
  y as RemoveSheetsFilterMutation,
  Ne as SHEET_FILTER_SNAPSHOT_ID,
  Bt as SetSheetFilterRangeCommand,
  cr as SetSheetsFilterCriteriaCommand,
  p as SetSheetsFilterCriteriaMutation,
  R as SetSheetsFilterRangeMutation,
  M as SheetsFilterService,
  G as SheetsFilterSyncController,
  ar as SmartToggleSheetsFilterCommand,
  Ue as UniverSheetsFilterMobileUIPlugin,
  fe as UniverSheetsFilterPlugin,
  p3 as UniverSheetsFilterPreset,
  He as UniverSheetsFilterUIPlugin,
  wt2 as UniverSheetsFilterUIWorkerPlugin,
  wt as equals,
  ae as getCustomFilterFn,
  Rt as greaterThan,
  pt as greaterThanOrEqualTo,
  St as lessThan,
  Ft as lessThanOrEqualTo,
  Oe as notEquals
};
//# sourceMappingURL=@univerjs_presets_preset-sheets-filter.js.map
