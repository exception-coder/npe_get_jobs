import "./chunk-WEJEHBT6.js";
import {
  s
} from "./chunk-H7DYKDNM.js";
import {
  A,
  Ae as Ae3,
  Be as Be3,
  D as D3,
  De as De4,
  F as F2,
  Fe as Fe4,
  Ge as Ge4,
  He as He2,
  Le as Le3,
  O as O2,
  P as P5,
  Pe as Pe4,
  Ve as Ve5,
  Y as Y4,
  at as at2,
  ct as ct3,
  it,
  je as je3,
  lt as lt4,
  ot as ot4,
  q as q7,
  re as re3,
  rt as rt4,
  se as se3,
  st as st3,
  w,
  xe as xe2
} from "./chunk-6335LBDU.js";
import {
  D,
  Ee,
  I as I2,
  Je as Je2,
  Ke,
  L,
  N as N3,
  Q,
  V as V3,
  Ve as Ve2,
  X as X4,
  Xe,
  Y as Y3,
  Ye,
  _e as _e2,
  q as q5,
  v as v5,
  x as x2,
  ze as ze2
} from "./chunk-AFUSFBAE.js";
import {
  C,
  k as k5
} from "./chunk-FOCXVU2X.js";
import {
  $t as $t2,
  Br as Br2,
  Bt,
  Cc as Cc2,
  Cn,
  De as De3,
  Gt as Gt3,
  Lr,
  Ms as Ms2,
  Mt as Mt3,
  Oe as Oe4,
  Pe as Pe3,
  Ps as Ps2,
  Wr,
  Xa,
  Ze,
  _t as _t2,
  br as br4,
  ge as ge2,
  gt as gt2,
  ii as ii2,
  je as je2,
  kr as kr2,
  ni,
  nt as nt3,
  ot as ot3,
  pe,
  rt as rt3,
  vn as vn2,
  ws as ws2,
  xe,
  xt as xt2,
  ze as ze5
} from "./chunk-RWMUFXJB.js";
import {
  $0 as $02,
  $d,
  $d2,
  $e as $e2,
  $n,
  $o,
  $r,
  $y,
  A3 as A32,
  AA,
  AC,
  Ae as Ae2,
  Ai,
  Ao,
  Ao2,
  Ap as Ap2,
  B1 as B12,
  B3,
  B5,
  Bd,
  Bf,
  Bi,
  Bi2,
  Bm,
  Bn as Bn2,
  C5,
  Ca as Ca2,
  Ca2 as Ca3,
  Ci,
  Cr as Cr3,
  D1,
  DC,
  Dd as Dd2,
  De as De2,
  Dn as Dn2,
  Do,
  Do2,
  Dt as Dt2,
  E5,
  Ea,
  Em,
  Eo,
  Eo2 as Eo3,
  Er as Er2,
  Es as Es2,
  Et as Et2,
  Et2 as Et3,
  F0 as F02,
  F3,
  Fa as Fa2,
  Fd,
  Fe,
  Fi,
  Fi2,
  Fn as Fn2,
  Fn2 as Fn4,
  Fo,
  Ft as Ft3,
  G1,
  G3 as G32,
  Ge,
  Ge2 as Ge3,
  Gf,
  Gi as Gi2,
  Gn,
  Gr as Gr2,
  Gt as Gt2,
  Gy,
  H1,
  Hd,
  Hl,
  Hm,
  Hn,
  Hn2,
  Ho,
  Hr as Hr2,
  Ht as Ht3,
  I0,
  I1 as I12,
  Ia,
  Ii,
  Io as Io2,
  Io2 as Io3,
  Ir as Ir2,
  Is,
  It as It2,
  Jd,
  Jd2,
  Je as Je3,
  Jf,
  Ji,
  Jn as Jn3,
  Jo as Jo2,
  Jr as Jr2,
  Js as Js3,
  Jt as Jt2,
  Jt2 as Jt3,
  Jy,
  KR,
  Ke as Ke2,
  Ke2 as Ke3,
  Kf,
  Ki,
  Kr as Kr2,
  Ks as Ks2,
  Kt,
  Ky,
  L1,
  L5,
  Ld,
  Le as Le2,
  Li,
  Ln as Ln3,
  Lo as Lo2,
  Lo2 as Lo3,
  Lt as Lt2,
  M1,
  M5,
  Ma as Ma2,
  Md,
  Mf,
  Mi,
  Mm,
  Mo,
  Mo2,
  Mr as Mr2,
  N1,
  Na,
  Nl,
  Nm,
  No,
  No2,
  No3,
  Nt as Nt2,
  O3 as O32,
  Oa as Oa3,
  Oe as Oe2,
  Oi as Oi2,
  On as On3,
  Oo,
  Oo2,
  Op,
  Os,
  Os2,
  Pa,
  Pe,
  Pi,
  Po as Po2,
  Qd,
  Qe as Qe2,
  Qi,
  Qn,
  Qo as Qo2,
  Qt as Qt2,
  Qt2 as Qt4,
  Qy,
  R0,
  Ra,
  Re,
  RediConsumer,
  RediContext,
  RediProvider,
  Ri,
  Rs,
  S1 as S12,
  SA,
  Sa,
  Sa2,
  Se,
  So,
  So2,
  Sr as Sr3,
  Sr2 as Sr4,
  Ss as Ss2,
  St as St3,
  Ta,
  Ta2,
  Te,
  To,
  U0,
  U1 as U12,
  Ua,
  Ud,
  Ui,
  Ui2,
  Un,
  Un2,
  Uo,
  Ut,
  Ut2,
  Va,
  Ve as Ve4,
  Vl,
  Vn as Vn2,
  Vo,
  Vr,
  Vs as Vs2,
  W5,
  Wa,
  Wd,
  Wd2,
  We as We2,
  We2 as We4,
  Wi as Wi2,
  Wi2 as Wi3,
  WithDependency,
  Wm as Wm2,
  Wn as Wn3,
  Wt as Wt2,
  X5,
  Xc,
  Xd,
  Xe as Xe2,
  Xe2 as Xe5,
  Xf,
  Xi,
  Xi2,
  Xn as Xn2,
  Xn2 as Xn3,
  Xr as Xr2,
  Xt as Xt2,
  Y1,
  Y5,
  Yd,
  Ye as Ye2,
  Ye2 as Ye4,
  Yf as Yf2,
  Yi,
  Yn,
  Yn2 as Yn3,
  Yy as Yy2,
  Zf,
  Zn,
  Zr,
  Zt as Zt2,
  Zy,
  _1,
  _5,
  _a,
  _a2,
  _d,
  _e as _e3,
  _o as _o2,
  a1 as a12,
  a3 as a32,
  a5,
  a7,
  ad as ad2,
  af,
  al as al2,
  ao as ao2,
  ar,
  as as as2,
  at,
  b5,
  ba as ba2,
  ba2 as ba3,
  bd,
  bi,
  bn,
  bo,
  br as br3,
  bs as bs3,
  bt as bt2,
  c1 as c12,
  c3 as c32,
  c7,
  ca as ca3,
  cd as cd2,
  cl,
  co as co2,
  connectDependencies,
  connectInjector,
  cr as cr2,
  ct,
  ct2,
  d5,
  da,
  dr,
  dt,
  e2 as e22,
  e3 as e32,
  e7,
  ef,
  el as el3,
  en as en2,
  en2 as en3,
  er,
  et as et2,
  et2 as et3,
  eu as eu2,
  f5,
  fa as fa2,
  fe as fe2,
  fi as fi2,
  fl,
  fm,
  fo as fo3,
  g5,
  ga as ga3,
  gl,
  gm,
  gn as gn2,
  go,
  gr as gr2,
  gr2 as gr3,
  gt,
  h5,
  ha as ha4,
  he,
  hg,
  hi,
  hl as hl2,
  hm,
  hn as hn2,
  i7,
  id as id2,
  id2 as id3,
  ie as ie2,
  ii,
  ir,
  ir2 as ir3,
  is,
  is2,
  ja,
  je,
  ji,
  jn,
  jy,
  k3,
  kA,
  ka as ka2,
  ke as ke2,
  ki,
  kn,
  ko,
  ko2,
  kr,
  l7,
  ld as ld3,
  le as le3,
  lh,
  li as li2,
  ll,
  lr,
  ls as ls2,
  lt,
  lt2 as lt3,
  m0,
  m5,
  ma as ma3,
  ma2 as ma4,
  mm,
  mn as mn2,
  mo,
  mr as mr2,
  mt as mt2,
  mt2 as mt3,
  n7,
  nA,
  nf,
  nn as nn2,
  no,
  nr,
  nr2 as nr3,
  ns as ns2,
  nt,
  o7 as o72,
  oa,
  ob as ob2,
  od as od2,
  oe,
  of,
  oi as oi2,
  oo as oo3,
  or as or2,
  os,
  ot,
  p5,
  pR,
  pa as pa2,
  pa2 as pa3,
  pi,
  pl,
  po,
  pt as pt2,
  pt2 as pt3,
  q0,
  q1,
  q5 as q52,
  qd,
  qd2,
  qe,
  qe2 as qe3,
  qf,
  qi,
  qn as qn2,
  qr as qr2,
  qy,
  r7,
  rd,
  rd2,
  re as re2,
  rh,
  ri as ri2,
  rl as rl2,
  ro,
  ro2,
  rr as rr2,
  rs as rs2,
  rs2 as rs3,
  rt,
  s0 as s02,
  s3,
  s7 as s72,
  sa,
  sd as sd2,
  si as si2,
  so as so2,
  sr as sr2,
  ss as ss2,
  st,
  t2,
  t3,
  t7,
  tl as tl3,
  to,
  tr,
  ts as ts2,
  tt,
  tt2,
  tt3,
  u3,
  u7,
  ua as ua2,
  ue as ue2,
  un as un3,
  uo as uo3,
  ur,
  useDependency,
  useInjector,
  useObservable,
  useUpdateBinder,
  ut,
  v5 as v52,
  v_,
  va,
  va2,
  vi,
  vt as vt2,
  w1,
  w5,
  wa,
  wa2,
  wb,
  we as we2,
  wi,
  wi2,
  wr as wr2,
  wr2 as wr3,
  wt as wt2,
  ww,
  xC,
  xa as xa2,
  xn,
  xs as xs2,
  y5,
  ya,
  ye as ye2,
  yi as yi2,
  yi2 as yi3,
  yn,
  yr as yr2,
  ys as ys2,
  yt as yt2,
  za,
  ze as ze3,
  zf,
  zi,
  zi2,
  zo,
  zt,
  zy
} from "./chunk-DZMX4FYO.js";
import {
  $,
  $0,
  $7,
  $B,
  $E,
  $T,
  $c,
  $e,
  $f,
  $h,
  $t,
  $u,
  $v,
  A3,
  A7,
  Aa,
  Ac,
  Ae,
  Ah,
  Al,
  An,
  Ar,
  Ar2,
  At,
  Ax,
  B,
  B1,
  B7,
  Bc,
  Be,
  Be2,
  Bh,
  Bh2,
  Bn,
  Bo,
  Br,
  Bs,
  Bu,
  Bx,
  C3,
  C7,
  CB,
  CE,
  Ca,
  Cc,
  Cd,
  Ce,
  Ch,
  Cl,
  Co,
  Cr,
  Cr2,
  Cs,
  Ct,
  Cu,
  Cv,
  D as D2,
  D7,
  D8,
  DB,
  Da,
  Db,
  Dc,
  Dd,
  De,
  Dh,
  Dn,
  Dr,
  Dr2,
  Ds,
  Dt,
  E,
  E0,
  E7,
  EB,
  Ec,
  Ee as Ee2,
  Eh,
  Eo as Eo2,
  Er,
  Es,
  Et,
  Eu,
  F,
  F0,
  F6,
  FB,
  Fa,
  Fb,
  Fc,
  Fe as Fe2,
  Fe2 as Fe3,
  Fh,
  Fn as Fn3,
  Fr,
  Fs,
  Ft,
  Ft2,
  Fu,
  Fv,
  G,
  G3,
  G4,
  G6,
  GB,
  GT,
  Gc,
  Gc2,
  Ge as Ge2,
  Gh,
  Gn as Gn2,
  Gr,
  Gt,
  Gu,
  Gv,
  Gx,
  H4,
  HB,
  HT,
  Hc,
  Hc2,
  He,
  Hh,
  Hh2,
  Hr,
  Hs,
  Ht,
  Ht2,
  Hx,
  I,
  I1,
  I4,
  I7,
  IB,
  IE,
  I_,
  Ic,
  Ih,
  Ih2,
  In,
  Io,
  Ir,
  It,
  J as J2,
  J1,
  J4,
  J5,
  JB,
  JT,
  Jb,
  Jc,
  Je,
  Je2 as Je4,
  Jh,
  Jn,
  Jn2,
  Jr,
  Js,
  Js2,
  Jt,
  Ju,
  Jv,
  K,
  K2,
  K3,
  KB,
  KT,
  Kb,
  Kc,
  Kh,
  Kl,
  Kn,
  Ko,
  Kr,
  Ks,
  Kt as Kt2,
  Ku,
  Kv,
  L3,
  L7,
  LB,
  La,
  Le,
  Lg,
  Lh,
  Lm,
  Ln,
  Ln2,
  Lo,
  Ls as Ls2,
  Ls2 as Ls3,
  Lt,
  Lv,
  M,
  M2,
  M3,
  M4,
  M7,
  ME,
  Ma,
  Mb,
  Me,
  Mh,
  Ml,
  Mn,
  Mr,
  Mt,
  Mt2,
  Mu,
  N,
  N0,
  N2,
  N7,
  NB,
  NT,
  Nb,
  Nh,
  Nn,
  Nr,
  Nr2,
  Nt,
  Nu,
  Nv,
  O3,
  O7,
  OB,
  Oa,
  Oa2,
  Oc,
  Oe,
  Oe2 as Oe3,
  Oh,
  Oi,
  On,
  On2,
  Ot,
  Ou,
  Ov,
  P,
  P3,
  P4,
  P7,
  PB,
  Pe as Pe2,
  Ph,
  Pm,
  Pn,
  Po,
  Ps,
  Pt,
  Pu,
  Pv,
  Q as Q3,
  Q1,
  Q2,
  QB,
  QT,
  Q_,
  Qc,
  Qe,
  Qe2 as Qe3,
  Qh,
  Qo,
  Qr,
  Qs,
  Qs2,
  Qt,
  Qt2 as Qt3,
  Qu,
  Qu2,
  Qv,
  R6,
  R7,
  Rb,
  Rc,
  Rd,
  Rh,
  Rn,
  Ro,
  Rr,
  Ru,
  Rv,
  Rx,
  S1,
  S6,
  S7,
  SB,
  Sh,
  Si,
  Sl,
  Sn,
  Sn2,
  Sr,
  Sr2,
  Ss,
  St,
  St2,
  Sx,
  T,
  T3,
  T6,
  T7,
  T8,
  TB,
  Tc,
  Te as Te2,
  Th,
  Th2,
  Tl,
  Tn,
  Ts,
  Tt,
  Tu,
  Tx,
  U,
  U1,
  U7,
  UB,
  UT,
  Uc,
  Ue,
  Uh,
  Ul,
  Ur,
  Ur2,
  Us,
  Us2,
  V,
  V2,
  VB,
  VT,
  Vb,
  Vc,
  Ve as Ve3,
  Vh,
  Vi,
  Vn,
  Vs,
  Vv,
  W,
  W2,
  WB,
  WT,
  Wc,
  We as We3,
  Wh,
  Wh2,
  Wi,
  Wm,
  Wn as Wn2,
  Ws,
  Ws2,
  Wt,
  Wu,
  Wv,
  Wx,
  X,
  X1,
  X2,
  X3,
  XB,
  XT,
  Xb,
  Xe as Xe3,
  Xe2 as Xe4,
  Xh,
  Xn,
  Xo,
  Xr,
  Xs,
  Xs2,
  Xt,
  Xu,
  Xv,
  Xx,
  Y,
  Y2,
  YB,
  YT,
  Yc,
  Ye as Ye3,
  Yf,
  Yh,
  Yn as Yn2,
  Yr,
  Ys,
  Yt,
  Yt2,
  Yu,
  Yv,
  Yx,
  Yy,
  Z,
  Z2,
  Z4,
  Z5,
  ZB,
  ZT,
  Zb,
  Zc,
  Zh,
  Zh2,
  Zl,
  Zo,
  Zs,
  Zt,
  Zv,
  _,
  _7,
  _8,
  _B,
  _e,
  _e2 as _e4,
  _h,
  _l,
  _n,
  _o,
  _r,
  _r2,
  _t,
  a0,
  a3,
  aB,
  ab,
  ac,
  ad,
  ae,
  ai,
  al,
  an,
  an2,
  ar as ar2,
  as,
  au,
  ay,
  bB,
  bE,
  ba,
  bb,
  bc,
  bc2,
  be,
  be2,
  be3,
  bh,
  bl,
  br,
  br2,
  bs,
  bs2,
  bt,
  c1,
  c3,
  c4,
  cB,
  ca,
  ca2,
  cc,
  cd,
  ce,
  ci,
  cn,
  co,
  cr,
  cr2 as cr3,
  cs,
  d0,
  d3,
  dB,
  dE,
  dd,
  de,
  dn,
  dr as dr2,
  ds,
  dz,
  e1,
  e2,
  e3,
  eA,
  eB,
  ea,
  eb,
  ed,
  ee,
  ee2,
  eg,
  ei,
  el,
  el2,
  en,
  eo,
  er as er2,
  eu,
  ey,
  f,
  f7,
  fB,
  fa,
  fc,
  fd,
  fe,
  fe2 as fe3,
  fh,
  fi,
  fn as fn2,
  fo,
  fo2,
  fr,
  fs,
  fs2,
  ft,
  fx,
  g,
  g2,
  g3,
  g4,
  gB,
  ga,
  ga2,
  gc,
  gd,
  ge,
  gh,
  gn,
  gr,
  gu,
  h2,
  h4,
  hB,
  hC,
  ha,
  ha2,
  ha3,
  hb,
  hc,
  hd,
  hl,
  hn,
  ho,
  hr,
  hs,
  ht,
  hx,
  iB,
  ib,
  id,
  ie as ie3,
  il,
  io,
  ir as ir2,
  iu,
  iy,
  j,
  j3,
  j6,
  j7,
  j8,
  jB,
  jc,
  jd,
  jh,
  jm,
  jn as jn2,
  js,
  ju,
  jx,
  k,
  k2,
  k4,
  kB,
  ka,
  kb,
  kc,
  kc2,
  ke as ke3,
  kh,
  kn as kn2,
  ks,
  ku,
  l0,
  lB,
  la,
  lb,
  ld,
  ld2,
  le,
  le2,
  li,
  ln,
  lo,
  lr as lr2,
  ls,
  lt as lt2,
  m,
  m2,
  m3,
  m4,
  m6,
  mB,
  ma,
  ma2,
  mc,
  md,
  me,
  mh,
  mn,
  mr,
  ms,
  mt,
  mu,
  nB,
  nb,
  ne,
  ng,
  nl,
  nn,
  nr as nr2,
  ns,
  nt as nt2,
  ny,
  ny2,
  o7,
  oB,
  ob,
  od,
  og,
  oi,
  ol,
  on,
  on2,
  oo as oo2,
  or,
  or2 as or3,
  ot as ot2,
  ou,
  p2,
  pB,
  pa,
  pb,
  pb2,
  pc,
  pd,
  ph,
  pn,
  pn2,
  pr as pr2,
  ps,
  pt,
  q,
  q2,
  q3,
  q4,
  q5 as q6,
  qT,
  qe as qe2,
  qh,
  qn,
  qo,
  qr,
  qs,
  qt,
  qu,
  qu2,
  qv,
  qx,
  r0,
  rB,
  rb,
  re,
  rg,
  ri,
  rl,
  rn,
  rr,
  rr2 as rr3,
  rs,
  rt as rt2,
  ru,
  ry,
  s0,
  s7,
  sB,
  sb,
  sd,
  se,
  se2,
  sg,
  sh,
  si,
  sl,
  sn,
  so,
  sr as sr3,
  ss,
  st as st2,
  su,
  t0,
  tA,
  tB,
  tb,
  te,
  tg,
  ti,
  tl,
  tl2,
  to as to2,
  ts,
  ty,
  uB,
  ua,
  ub,
  uc,
  ud,
  ue,
  ui,
  ui2,
  un,
  un2,
  uo,
  uo2,
  ur as ur2,
  us,
  ut as ut2,
  v,
  v1,
  v2,
  v3,
  v4,
  vB,
  ve,
  ve2,
  vh,
  vh2,
  vl,
  vn,
  vr as vr2,
  vr2 as vr4,
  vt,
  w3,
  w7,
  w8,
  wB,
  we as we3,
  wh,
  wn,
  wr,
  ws,
  wt,
  x,
  x0,
  x1,
  x2 as x4,
  x3,
  xB,
  xE,
  xa,
  xc,
  xh,
  xm,
  xr,
  xs,
  xt,
  xv,
  y,
  y0,
  y2,
  yB,
  yc,
  ye,
  ye2 as ye3,
  yh,
  yi,
  yr,
  ys,
  yv,
  z,
  z0,
  z3,
  z8,
  zB,
  zb,
  zc as zc2,
  ze,
  ze2 as ze4,
  zh,
  zn,
  zr,
  zs,
  zs2,
  zx
} from "./chunk-I7I3GTAS.js";
import {
  $ as $2,
  AE,
  I as I3,
  LE,
  O,
  P as P2,
  Vx,
  ie,
  kt,
  pr,
  require_jsx_runtime,
  require_react,
  vr as vr3,
  xE as xE2,
  zE
} from "./chunk-YFGUMDM2.js";
import {
  Ap,
  Fn,
  GC,
  Gi,
  Inject,
  Injector,
  J,
  Jo,
  Ls,
  Ms,
  Observable,
  Ol,
  Optional,
  Or,
  Ve,
  We,
  Wn,
  XR,
  Z1,
  _C,
  a1,
  ao,
  combineLatest,
  debounceTime,
  eR,
  et,
  filter,
  fn,
  gC,
  ic,
  jg,
  ke,
  map,
  merge,
  n1,
  nR,
  oo,
  qR,
  rR,
  sR,
  sr,
  switchMap,
  tR,
  tap,
  vr,
  we,
  wg,
  yt,
  zc
} from "./chunk-RGZYGL3P.js";
import {
  __toESM
} from "./chunk-DC5AMYBS.js";

// node_modules/@univerjs/sheets-numfmt-ui/lib/es/index.js
var import_jsx_runtime = __toESM(require_jsx_runtime());
var import_react = __toESM(require_react());
var ut3 = Object.defineProperty;
var mt4 = (e, t4, r) => t4 in e ? ut3(e, t4, { enumerable: true, configurable: true, writable: true, value: r }) : e[t4] = r;
var X6 = (e, t4, r) => mt4(e, typeof t4 != "symbol" ? t4 + "" : t4, r);
var xe3 = {};
var _n2 = Object.getOwnPropertyDescriptor;
var Sn3 = (e, t4, r, n2) => {
  for (var i = n2 > 1 ? void 0 : n2 ? _n2(t4, r) : t4, s2 = e.length - 1, o3; s2 >= 0; s2--)
    (o3 = e[s2]) && (i = o3(i) || i);
  return i;
};
var k6 = (e, t4) => (r, n2) => t4(r, n2, e);
var oe2 = "SHEET_NUMFMT_ALERT";
var de2 = class extends Ve {
  constructor(e, t4, r, n2, i, s2, o3) {
    super(), this._context = e, this._hoverManagerService = t4, this._cellAlertManagerService = r, this._localeService = n2, this._zenZoneService = i, this._numfmtService = s2, this._configService = o3, this._init();
  }
  _init() {
    this._initCellAlertPopup(), this._initZenService();
  }
  _initCellAlertPopup() {
    this.disposeWithMe(this._hoverManagerService.currentCell$.pipe(debounceTime(100)).subscribe((e) => {
      var t4, r;
      if (e) {
        const n2 = e.location, i = this._context.unit, s2 = i.getActiveSheet();
        if (!s2) return this._hideAlert();
        const o3 = n2.unitId, m8 = n2.subUnitId;
        let c2;
        const a4 = s2.getCell(n2.row, n2.col);
        if (a4 != null && a4.s) {
          const u = i.getStyles().get(a4.s);
          u != null && u.n && (c2 = u.n);
        }
        if (c2 || (c2 = this._numfmtService.getValue(o3, m8, n2.row, n2.col)), !c2) {
          this._hideAlert();
          return;
        }
        if (tR(c2.pattern) && J.isDefine(a4 == null ? void 0 : a4.v) && Z1(a4.v)) {
          if ((t4 = this._configService.getConfig(se3)) != null && t4.disableTextFormatAlert)
            return;
          const u = this._cellAlertManagerService.currentAlert.get(oe2), l3 = (r = u == null ? void 0 : u.alert) == null ? void 0 : r.location;
          if (l3 && l3.row === n2.row && l3.col === n2.col && l3.subUnitId === n2.subUnitId && l3.unitId === n2.unitId) {
            this._hideAlert();
            return;
          }
          this._cellAlertManagerService.showAlert({
            type: po.ERROR,
            title: this._localeService.t("info.error"),
            message: this._localeService.t("info.forceStringInfo"),
            location: n2,
            width: 200,
            height: 74,
            key: oe2
          });
          return;
        }
      }
      this._hideAlert();
    }));
  }
  _initZenService() {
    this.disposeWithMe(this._zenZoneService.visible$.subscribe((e) => {
      e && this._hideAlert();
    }));
  }
  _hideAlert() {
    this._cellAlertManagerService.removeAlert(oe2);
  }
};
de2 = Sn3([
  k6(1, Inject(Mr2)),
  k6(2, Inject(Do2)),
  k6(3, Inject(Fn)),
  k6(4, st),
  k6(5, Inject(Wt)),
  k6(6, ic)
], de2);
var ce2 = {
  id: "sheet.operation.close.numfmt.panel",
  type: Ms.OPERATION,
  handler: () => (
    // do nothing, just notify panel is closed
    true
  )
};
var A2 = {
  id: "sheet.operation.open.numfmt.panel",
  type: Ms.OPERATION,
  handler: (e) => (e.get(j2).openPanel(), true)
};
var Cn2 = Object.getOwnPropertyDescriptor;
var yn2 = (e, t4, r, n2) => {
  for (var i = n2 > 1 ? void 0 : n2 ? Cn2(t4, r) : t4, s2 = e.length - 1, o3; s2 >= 0; s2--)
    (o3 = e[s2]) && (i = o3(i) || i);
  return i;
};
var bn2 = (e, t4) => (r, n2) => t4(r, n2, e);
var Ee3 = (0, import_react.createContext)([]);
var H = class {
  constructor(e) {
    this._localStorageService = e;
  }
  _getKey(e) {
    return `userHabitController_${e}`;
  }
  async addHabit(e, t4) {
    const r = this._getKey(e);
    return this._localStorageService.getItem(r).then((n2) => {
      n2 || this._localStorageService.setItem(r, t4);
    });
  }
  markHabit(e, t4) {
    const r = this._getKey(e);
    this._localStorageService.getItem(r).then((n2) => {
      if (n2) {
        const i = n2.findIndex((s2) => s2 === t4);
        i > -1 && n2.splice(i, 1), n2.unshift(t4), this._localStorageService.setItem(r, n2);
      }
    });
  }
  async getHabit(e, t4) {
    const r = this._getKey(e), n2 = await this._localStorageService.getItem(r);
    if (t4 && n2) {
      const i = n2.map((s2, o3, m8) => {
        const c2 = m8.length;
        return {
          value: s2,
          priority: c2 - o3
        };
      });
      return t4.sort((s2, o3) => {
        var a4, u;
        const m8 = ((a4 = i.find((l3) => l3.value === s2)) == null ? void 0 : a4.priority) || -1;
        return (((u = i.find((l3) => l3.value === o3)) == null ? void 0 : u.priority) || -1) - m8;
      });
    }
    return n2 || [];
  }
  deleteHabit(e) {
    this._localStorageService.removeItem(e);
  }
};
H = yn2([
  bn2(0, Inject(XR))
], H);
var Re2 = "numfmtCurrency";
var In2 = (e) => {
  const t4 = useDependency(H), [r, n2] = (0, import_react.useState)(re3);
  return (0, import_react.useEffect)(() => {
    t4.addHabit("numfmtCurrency", []).then(() => {
      t4.getHabit(Re2, [...re3]).then((s2) => {
        n2(s2), e && e(s2);
      });
    });
  }, []), { userHabitCurrency: r, mark: (s2) => {
    t4.markHabit(Re2, s2);
  } };
};
var Nn2 = () => {
  const e = (0, import_react.useRef)([]), [t4, r] = (0, import_react.useState)({});
  return (0, import_react.useEffect)(() => {
    e.current.forEach((i) => {
      i();
    }), e.current = [];
  }, [t4]), (i) => {
    e.current.push(i), r({});
  };
};
var En = (e) => !!ot4(e) && e.startsWith("_(");
var Tn2 = (e) => {
  const { defaultPattern: t4, action: r, onChange: n2 } = e, [i, s2] = (0, import_react.useState)(() => P5(t4 || "", 2)), o3 = (0, import_react.useContext)(Ee3), [m8, c2] = (0, import_react.useState)(() => ot4(t4) || o3[0]), a4 = (0, import_react.useMemo)(() => o3.map((p) => ({ label: p, value: p })), []), l3 = useDependency(Fn).t;
  r.current = () => F2(`_("${m8}"* #,##0${i > 0 ? ".0" : ""}_)`, i);
  const v7 = (p) => {
    c2(p), n2(F2(`_("${p}"* #,##0${i > 0 ? ".0" : ""}_)`, i));
  }, f3 = (p) => {
    const d2 = p || 0;
    s2(d2), n2(F2(`_("${m8}"* #,##0${d2 > 0 ? ".0" : ""}_)`, d2));
  };
  return (0, import_jsx_runtime.jsxs)("div", { children: [
    (0, import_jsx_runtime.jsxs)("div", { className: "univer-mt-4 univer-flex univer-justify-between", children: [
      (0, import_jsx_runtime.jsxs)("div", { className: "option", children: [
        (0, import_jsx_runtime.jsx)("div", { className: "univer-text-sm univer-text-gray-400", children: l3("sheet.numfmt.decimalLength") }),
        (0, import_jsx_runtime.jsx)("div", { className: "univer-mt-2 univer-w-32", children: (0, import_jsx_runtime.jsx)(
          xE2,
          {
            value: i,
            step: 1,
            precision: 0,
            max: 20,
            min: 0,
            onChange: f3
          }
        ) })
      ] }),
      (0, import_jsx_runtime.jsxs)("div", { className: "option", children: [
        (0, import_jsx_runtime.jsx)("div", { className: "univer-text-sm univer-text-gray-400", children: l3("sheet.numfmt.currencyType") }),
        (0, import_jsx_runtime.jsx)("div", { className: "univer-mt-2 univer-w-36", children: (0, import_jsx_runtime.jsx)(
          LE,
          {
            options: a4,
            value: m8,
            onChange: v7
          }
        ) })
      ] })
    ] }),
    (0, import_jsx_runtime.jsx)("div", { className: "univer-mt-4 univer-text-sm univer-text-gray-400", children: l3("sheet.numfmt.accountingDes") })
  ] });
};
var Mn2 = (e) => !!ot4(e) && !e.startsWith("_(");
var wn2 = (e) => {
  const r = useDependency(Fn).t, n2 = (0, import_react.useContext)(Ee3), [i, s2] = (0, import_react.useState)(() => ot4(e.defaultPattern) || n2[0]), [o3, m8] = (0, import_react.useState)(() => P5(e.defaultPattern || "", 2)), [c2, a4] = (0, import_react.useState)(() => {
    var g7;
    const d2 = it(i);
    return ((g7 = d2.find((I5) => rR(I5.value, e.defaultPattern))) == null ? void 0 : g7.value) || d2[0].value;
  }), u = (0, import_react.useMemo)(() => it(i), [i]), l3 = (0, import_react.useMemo)(() => n2.map((d2) => ({ label: d2, value: d2 })), [n2]);
  e.action.current = () => F2(c2, o3);
  const v7 = (d2) => {
    if (d2 === void 0)
      return;
    s2(d2);
    const S = it(d2)[0].value;
    a4(S), e.onChange(F2(S, o3));
  }, f3 = (d2) => {
    d2 !== void 0 && (a4(d2), e.onChange(F2(d2, o3)));
  }, p = (d2) => {
    m8(d2 || 0), e.onChange(F2(c2, d2 || 0));
  };
  return (0, import_jsx_runtime.jsxs)("div", { children: [
    (0, import_jsx_runtime.jsxs)("div", { className: "univer-mt-4 univer-flex univer-justify-between", children: [
      (0, import_jsx_runtime.jsxs)("div", { className: "option", children: [
        (0, import_jsx_runtime.jsx)("div", { className: "univer-text-sm univer-text-gray-400", children: r("sheet.numfmt.decimalLength") }),
        (0, import_jsx_runtime.jsx)("div", { className: "univer-mt-2 univer-w-32", children: (0, import_jsx_runtime.jsx)(
          xE2,
          {
            value: o3,
            max: 20,
            min: 0,
            onChange: p
          }
        ) })
      ] }),
      (0, import_jsx_runtime.jsxs)("div", { className: "option", children: [
        (0, import_jsx_runtime.jsx)("div", { className: "univer-text-sm univer-text-gray-400", children: r("sheet.numfmt.currencyType") }),
        (0, import_jsx_runtime.jsx)("div", { className: "univer-mt-2 univer-w-36", children: (0, import_jsx_runtime.jsx)(
          LE,
          {
            value: i,
            options: l3,
            onChange: v7
          }
        ) })
      ] })
    ] }),
    (0, import_jsx_runtime.jsx)("div", { className: "label univer-mt-4", children: r("sheet.numfmt.negType") }),
    (0, import_jsx_runtime.jsx)("div", { className: "univer-mt-2", children: (0, import_jsx_runtime.jsx)(AE, { value: c2, options: u, onChange: f3 }) }),
    (0, import_jsx_runtime.jsx)("div", { className: "univer-mt-4 univer-text-sm univer-text-gray-400", children: r("sheet.numfmt.currencyDes") })
  ] });
};
function tt4({ ref: e, ...t4 }) {
  const { icon: r, id: n2, className: i, extend: s2, ...o3 } = t4, m8 = `univerjs-icon univerjs-icon-${n2} ${i || ""}`.trim(), c2 = (0, import_react.useRef)(`_${Rn2()}`);
  return nt4(r, `${n2}`, {
    defIds: r.defIds,
    idSuffix: c2.current
  }, {
    ref: e,
    className: m8,
    ...o3
  }, s2);
}
function nt4(e, t4, r, n2, i) {
  return (0, import_react.createElement)(e.tag, {
    key: t4,
    ...Pn2(e, r, i),
    ...n2
  }, (xn2(e, r).children || []).map((s2, o3) => nt4(s2, `${t4}-${e.tag}-${o3}`, r, void 0, i)));
}
function Pn2(e, t4, r) {
  const n2 = { ...e.attrs };
  r != null && r.colorChannel1 && n2.fill === "colorChannel1" && (n2.fill = r.colorChannel1), e.tag === "mask" && n2.id && (n2.id = n2.id + t4.idSuffix), Object.entries(n2).forEach(([s2, o3]) => {
    s2 === "mask" && typeof o3 == "string" && (n2[s2] = o3.replace(/url\(#(.*)\)/, `url(#$1${t4.idSuffix})`));
  });
  const { defIds: i } = t4;
  return !i || i.length === 0 || (e.tag === "use" && n2["xlink:href"] && (n2["xlink:href"] = n2["xlink:href"] + t4.idSuffix), Object.entries(n2).forEach(([s2, o3]) => {
    typeof o3 == "string" && (n2[s2] = o3.replace(/url\(#(.*)\)/, `url(#$1${t4.idSuffix})`));
  })), n2;
}
function xn2(e, t4) {
  var n2;
  const { defIds: r } = t4;
  return !r || r.length === 0 ? e : e.tag === "defs" && ((n2 = e.children) != null && n2.length) ? {
    ...e,
    children: e.children.map((i) => typeof i.attrs.id == "string" && r && r.includes(i.attrs.id) ? {
      ...i,
      attrs: {
        ...i.attrs,
        id: i.attrs.id + t4.idSuffix
      }
    } : i)
  } : e;
}
function Rn2() {
  return Math.random().toString(36).substring(2, 8);
}
tt4.displayName = "UniverIcon";
var $n2 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M14.1544 3.75557C14.3887 3.98988 14.3887 4.36978 14.1544 4.6041L6.51409 12.2444C6.40157 12.3569 6.24896 12.4201 6.08983 12.4201C5.9307 12.4201 5.77808 12.3569 5.66556 12.2444L1.84541 8.42425C1.6111 8.18993 1.6111 7.81003 1.84541 7.57572C2.07973 7.34141 2.45963 7.34141 2.69394 7.57572L6.08983 10.9716L13.3059 3.75557C13.5402 3.52126 13.9201 3.52126 14.1544 3.75557Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var rt5 = (0, import_react.forwardRef)(function(t4, r) {
  return (0, import_react.createElement)(tt4, Object.assign({}, t4, {
    id: "check-mark-icon",
    ref: r,
    icon: $n2
  }));
});
rt5.displayName = "CheckMarkIcon";
var ae2 = "customFormat";
var le4 = "numfmt_custom_pattern";
function On4(e) {
  const { defaultPattern: t4, action: r, onChange: n2 } = e, i = useDependency(H), s2 = useDependency(XR), o3 = useDependency(Fn), [m8, c2] = (0, import_react.useState)(t4);
  r.current = () => (i.markHabit(ae2, m8), s2.getItem(le4).then((f3 = []) => {
    const p = [.../* @__PURE__ */ new Set([m8, ...f3 || []])].splice(0, 10).filter((d2) => !!d2);
    s2.setItem(le4, p);
  }), m8);
  const [a4, u] = (0, import_react.useState)([]);
  (0, import_react.useEffect)(() => {
    s2.getItem(le4).then((f3) => {
      const p = [
        ...Ae3.map((d2) => d2.suffix("$")),
        ...Fe4.map((d2) => d2.suffix),
        ...De4.map((d2) => d2.suffix)
      ];
      p.push(...f3 || []), i.addHabit(ae2, []).finally(() => {
        i.getHabit(ae2, p).then((d2) => {
          u([...new Set(d2)]);
        });
      });
    });
  }, []);
  const l3 = (f3) => {
    c2(f3), n2(f3);
  }, v7 = () => {
    n2(m8);
  };
  return (0, import_jsx_runtime.jsxs)("div", { children: [
    (0, import_jsx_runtime.jsx)("div", { className: "univer-mt-4 univer-text-sm univer-text-gray-400", children: o3.t("sheet.numfmt.customFormat") }),
    (0, import_jsx_runtime.jsx)(
      Vx,
      {
        placeholder: o3.t("sheet.numfmt.customFormat"),
        onBlur: v7,
        value: m8,
        onChange: c2,
        className: "univer-mt-2 univer-w-full"
      }
    ),
    (0, import_jsx_runtime.jsx)(
      "div",
      {
        className: ie("univer-mt-2 univer-max-h-[400px] univer-overflow-auto univer-rounded-lg univer-p-2", kt),
        children: a4.map((f3) => (0, import_jsx_runtime.jsxs)(
          "div",
          {
            onClick: () => l3(f3),
            className: "univer-flex univer-cursor-pointer univer-items-center univer-gap-1.5 univer-py-1.5 univer-text-sm",
            children: [
              (0, import_jsx_runtime.jsx)("div", { className: "univer-flex univer-w-4 univer-items-center univer-text-primary-600", children: m8 === f3 && (0, import_jsx_runtime.jsx)(rt5, {}) }),
              (0, import_jsx_runtime.jsx)("div", { children: f3 })
            ]
          },
          f3
        ))
      }
    ),
    (0, import_jsx_runtime.jsx)(
      "div",
      {
        className: "univer-mt-3 univer-text-sm univer-text-gray-600 dark:!univer-text-gray-200",
        children: o3.t("sheet.numfmt.customFormatDes")
      }
    )
  ] });
}
var Un3 = (e) => {
  const t4 = eR.getFormatInfo(e);
  return ct3().map((r) => r.value).includes(e) || ["date", "datetime", "time"].includes(t4.type);
};
function kn3(e) {
  const { onChange: t4, defaultPattern: r } = e, n2 = (0, import_react.useMemo)(ct3, []), i = useDependency(Fn), [s2, o3] = (0, import_react.useState)(() => {
    if (r) {
      const c2 = n2.find((a4) => a4.value === r);
      if (c2)
        return c2.value;
    }
    return n2[0].value;
  });
  e.action.current = () => s2;
  const m8 = (c2) => {
    c2 !== void 0 && (o3(c2), t4(c2));
  };
  return (0, import_jsx_runtime.jsxs)("div", { children: [
    (0, import_jsx_runtime.jsx)("div", { className: "univer-mt-4 univer-text-sm univer-text-gray-400", children: i.t("sheet.numfmt.dateType") }),
    (0, import_jsx_runtime.jsx)("div", { className: "univer-mt-2", children: (0, import_jsx_runtime.jsx)(AE, { value: s2, options: n2, onChange: m8 }) }),
    (0, import_jsx_runtime.jsx)(
      "div",
      {
        className: "univer-mt-3.5 univer-text-sm/5 univer-text-gray-600 dark:!univer-text-gray-200",
        children: i.t("sheet.numfmt.dateDes")
      }
    )
  ] });
}
var Dn3 = (e) => !e;
var Fn5 = (e) => {
  const r = useDependency(Fn).t;
  return e.action.current = () => "", (0, import_jsx_runtime.jsx)("div", { children: (0, import_jsx_runtime.jsx)(
    "div",
    {
      className: "univer-mt-3.5 univer-text-sm/5 univer-text-gray-600 dark:!univer-text-gray-200",
      children: r("sheet.numfmt.generalDes")
    }
  ) });
};
var Ln4 = (e) => lt4().some((t4) => rR(t4.value, e));
function An2(e) {
  const t4 = useDependency(Fn), r = (0, import_react.useMemo)(lt4, []), [n2, i] = (0, import_react.useState)(() => P5(e.defaultPattern || "", 0)), [s2, o3] = (0, import_react.useState)(() => {
    const l3 = r.find((v7) => rR(v7.value, e.defaultPattern || ""));
    return (l3 == null ? void 0 : l3.value) || r[0].value;
  }), m8 = (0, import_react.useMemo)(() => F2(s2, Number(n2 || 0)), [s2, n2]), c2 = (0, import_react.useMemo)(() => !rt4(s2), [s2]), a4 = (l3) => {
    i(l3 || 0), e.onChange(F2(s2, Number(l3 || 0)));
  }, u = (l3) => {
    l3 !== void 0 && (i(P5(l3, 0)), o3(l3), e.onChange(l3));
  };
  return e.action.current = () => m8, (0, import_jsx_runtime.jsxs)("div", { children: [
    (0, import_jsx_runtime.jsx)("div", { className: "univer-mt-4 univer-text-sm univer-text-gray-400", children: t4.t("sheet.numfmt.decimalLength") }),
    (0, import_jsx_runtime.jsx)("div", { className: "univer-mt-2", children: (0, import_jsx_runtime.jsx)(
      xE2,
      {
        disabled: c2,
        value: n2,
        max: 20,
        min: 0,
        onChange: a4
      }
    ) }),
    (0, import_jsx_runtime.jsxs)("div", { className: "univer-mt-4 univer-text-sm univer-text-gray-400", children: [
      " ",
      t4.t("sheet.numfmt.negType")
    ] }),
    (0, import_jsx_runtime.jsx)("div", { className: "univer-mt-2", children: (0, import_jsx_runtime.jsx)(AE, { onChange: u, options: r, value: s2 }) }),
    (0, import_jsx_runtime.jsx)(
      "div",
      {
        className: "univer-mt-3.5 univer-text-sm/5 univer-text-gray-600 dark:!univer-text-gray-200",
        children: t4.t("sheet.numfmt.thousandthPercentileDes")
      }
    )
  ] });
}
var Hn3 = (e) => {
  const { defaultValue: t4, defaultPattern: r, row: n2, col: i } = e.value, s2 = useDependency(Fn), o3 = (0, import_react.useRef)(() => ""), m8 = s2.t, c2 = Nn2(), a4 = (0, import_react.useMemo)(
    () => [
      { label: "sheet.numfmt.general", component: Fn5 },
      { label: "sheet.numfmt.accounting", component: Tn2 },
      { label: "sheet.numfmt.currency", component: wn2 },
      { label: "sheet.numfmt.date", component: kn3 },
      { label: "sheet.numfmt.thousandthPercentile", component: An2 },
      { label: "sheet.numfmt.customFormat", component: On4 }
    ].map((_3) => ({ ..._3, label: m8(_3.label) })),
    []
  ), [u, l3] = (0, import_react.useState)(g7), [v7, f3] = (0, import_react.useState)(() => `${n2}_${i}`), { mark: p, userHabitCurrency: d2 } = In2(() => f3(`${n2}_${i}_userCurrency'`)), S = (0, import_react.useMemo)(() => {
    var _3;
    return (_3 = a4.find((U2) => U2.label === u)) == null ? void 0 : _3.component;
  }, [u]);
  function g7() {
    return [Dn3, En, Mn2, Un3, Ln4].reduce((U2, at3, lt5) => U2 || (at3(r) ? a4[lt5].label : ""), "") || a4[0].label;
  }
  const I5 = a4.map((_3) => ({
    label: _3.label,
    value: _3.label
  })), w4 = (_3) => {
    l3(_3), c2(() => e.onChange({ type: "change", value: o3.current() || "" }));
  }, R3 = (0, import_react.useCallback)((_3) => {
    e.onChange({ type: "change", value: _3 });
  }, []), O5 = () => {
    const _3 = o3.current() || "", U2 = ot4(_3);
    U2 && p(U2), e.onChange({ type: "confirm", value: _3 });
  }, D5 = () => {
    e.onChange({ type: "cancel", value: "" });
  }, ie4 = {
    onChange: R3,
    defaultValue: t4,
    defaultPattern: r,
    action: o3
  };
  return (0, import_react.useEffect)(() => {
    l3(g7()), f3(`${n2}_${i}`);
  }, [n2, i]), (0, import_jsx_runtime.jsxs)(
    "div",
    {
      className: ie("univer-flex univer-h-full univer-flex-col univer-justify-between univer-overflow-y-auto univer-pb-5", pr),
      children: [
        (0, import_jsx_runtime.jsxs)("div", { children: [
          (0, import_jsx_runtime.jsx)("div", { className: "univer-mt-3.5 univer-text-sm univer-text-gray-400", children: m8("sheet.numfmt.numfmtType") }),
          (0, import_jsx_runtime.jsx)("div", { className: "univer-mt-2", children: (0, import_jsx_runtime.jsx)(LE, { className: "univer-w-full", value: u, options: I5, onChange: w4 }) }),
          (0, import_jsx_runtime.jsx)("div", { children: S && (0, import_jsx_runtime.jsx)(Ee3.Provider, { value: d2, children: (0, import_react.createElement)(S, { ...ie4, key: v7 }) }) })
        ] }),
        (0, import_jsx_runtime.jsxs)("div", { className: "univer-mb-5 univer-mt-3.5 univer-flex univer-justify-end", children: [
          (0, import_jsx_runtime.jsx)(vr3, { onClick: D5, className: "univer-mr-3", children: m8("sheet.numfmt.cancel") }),
          (0, import_jsx_runtime.jsx)(vr3, { variant: "primary", onClick: O5, children: m8("sheet.numfmt.confirm") })
        ] })
      ]
    }
  );
};
var jn3 = Object.getOwnPropertyDescriptor;
var Bn3 = (e, t4, r, n2) => {
  for (var i = n2 > 1 ? void 0 : n2 ? jn3(t4, r) : t4, s2 = e.length - 1, o3; s2 >= 0; s2--)
    (o3 = e[s2]) && (i = o3(i) || i);
  return i;
};
var M6 = (e, t4) => (r, n2) => t4(r, n2, e);
var $e3 = "SHEET_NUMFMT_PANEL";
var j2 = class extends Ve {
  constructor(t4, r, n2, i, s2, o3, m8, c2, a4, u, l3) {
    super();
    X6(this, "_previewPattern", "");
    X6(this, "_sidebarDisposable", null);
    this._sheetInterceptorService = t4, this._themeService = r, this._univerInstanceService = n2, this._commandService = i, this._selectionManagerService = s2, this._renderManagerService = o3, this._numfmtService = m8, this._componentManager = c2, this._sidebarService = a4, this._localeService = u, this._sheetsNumfmtCellContentController = l3, this._initRealTimeRenderingInterceptor(), this._initPanel(), this._initCommands(), this._initCloseListener(), this._commandExecutedListener(), this._initNumfmtLocalChange();
  }
  _initNumfmtLocalChange() {
    this.disposeWithMe(merge(this._sheetsNumfmtCellContentController.locale$, this._localeService.currentLocale$).subscribe(() => {
      this._forceUpdate();
    }));
  }
  openPanel() {
    var S;
    const t4 = this._sidebarService, r = this._selectionManagerService, n2 = this._commandService, i = this._univerInstanceService, s2 = this._numfmtService, o3 = this._localeService, c2 = (((S = r.getCurrentSelections()) == null ? void 0 : S.map((g7) => g7.range)) || [])[0];
    if (!c2)
      return false;
    const a4 = i.getCurrentUnitForType(we.UNIVER_SHEET), u = a4.getActiveSheet();
    if (!u)
      return false;
    const l3 = u.getCellRaw(c2.startRow, c2.startColumn), v7 = s2.getValue(
      a4.getUnitId(),
      u.getSheetId(),
      c2.startRow,
      c2.startColumn
    );
    let f3 = "";
    v7 && (f3 = v7.pattern);
    const p = (l3 == null ? void 0 : l3.t) === fn.NUMBER ? l3.v : 12345678, d2 = {
      onChange: (g7) => {
        var I5;
        if (g7.type === "change")
          this._previewPattern = g7.value, this._forceUpdate();
        else if (g7.type === "confirm") {
          const w4 = ((I5 = r.getCurrentSelections()) == null ? void 0 : I5.map((D5) => D5.range)) || [], R3 = { values: [] }, O5 = st3(g7.value);
          w4.forEach((D5) => {
            Or.foreach(D5, (ie4, _3) => {
              R3.values.push({
                row: ie4,
                col: _3,
                pattern: g7.value,
                type: O5
              });
            });
          }), n2.executeCommand(O2.id, R3), t4.close();
        } else g7.type === "cancel" && t4.close();
      },
      value: { defaultPattern: f3, defaultValue: p, row: c2.startRow, col: c2.startColumn }
    };
    return this._sidebarDisposable = t4.open({
      header: { title: o3.t("sheet.numfmt.title") },
      children: {
        label: $e3,
        ...d2
        // need passthrough to react props.
      },
      onClose: () => {
        this._forceUpdate(), n2.executeCommand(ce2.id);
      }
    }), true;
  }
  _forceUpdate(t4) {
    var n2;
    const r = this._renderManagerService.getRenderById(
      t4 != null ? t4 : this._univerInstanceService.getCurrentUnitForType(we.UNIVER_SHEET).getUnitId()
    );
    r == null || r.with(ue2).reCalculate(), (n2 = r == null ? void 0 : r.mainComponent) == null || n2.makeDirty();
  }
  _initCommands() {
    [
      A2,
      ce2
    ].forEach((t4) => {
      this.disposeWithMe(this._commandService.registerCommand(t4));
    });
  }
  _initPanel() {
    this.disposeWithMe(
      this._componentManager.register($e3, Hn3)
    );
  }
  // eslint-disable-next-line max-lines-per-function
  _initRealTimeRenderingInterceptor() {
    const t4 = new Observable((n2) => {
      this._commandService.onCommandExecuted((i) => {
        i.id === A2.id && n2.next(true), i.id === ce2.id && n2.next(false);
      });
    }), r = combineLatest([
      t4,
      this._selectionManagerService.selectionMoveEnd$.pipe(
        map((n2) => n2 ? n2.map((i) => i.range) : [])
      )
    ]);
    this.disposeWithMe(
      We(
        r.pipe(
          switchMap(
            ([n2, i]) => new Observable((s2) => {
              const o3 = new ao();
              return n2 && i.length && s2.next({ selectionRanges: i, disposableCollection: o3 }), () => {
                o3.dispose();
              };
            })
          ),
          tap(() => {
            this._previewPattern = null;
          })
        ).subscribe(({ disposableCollection: n2, selectionRanges: i }) => {
          var o3, m8;
          const s2 = this._univerInstanceService.getCurrentUnitForType(we.UNIVER_SHEET);
          this.openPanel(), n2.add(
            this._sheetInterceptorService.intercept(ht.CELL_CONTENT, {
              priority: 99,
              effect: sr.Value | sr.Style,
              handler: (c2, a4, u) => {
                var p;
                const { row: l3, col: v7 } = a4, f3 = u(c2) || {};
                if (i.find(
                  (d2) => d2.startColumn <= v7 && d2.endColumn >= v7 && d2.startRow <= l3 && d2.endRow >= l3
                )) {
                  const d2 = a4.worksheet.getCellRaw(l3, v7), S = d2 == null ? void 0 : d2.v, g7 = d2 == null ? void 0 : d2.t;
                  if (S == null || g7 !== fn.NUMBER || this._previewPattern === null)
                    return f3;
                  const I5 = Ge4(this._previewPattern, S, this._sheetsNumfmtCellContentController.locale);
                  if (I5.color) {
                    const w4 = (p = this._themeService.getColorFromTheme(`${I5.color}.500`)) != null ? p : I5.color;
                    return {
                      ...f3,
                      v: I5.result,
                      t: fn.STRING,
                      s: { cl: { rgb: w4 } }
                    };
                  }
                  return {
                    ...f3,
                    v: I5.result,
                    t: fn.STRING
                  };
                }
                return f3;
              }
            })
          ), (m8 = (o3 = this._renderManagerService.getRenderById(s2.getUnitId())) == null ? void 0 : o3.mainComponent) == null || m8.makeDirty();
        })
      )
    );
  }
  _commandExecutedListener() {
    const t4 = [li.id, to2.id];
    this.disposeWithMe(
      new Observable((r) => {
        const n2 = this._commandService.onCommandExecuted((i) => {
          if (t4.includes(i.id)) {
            const s2 = i.params;
            r.next(s2.unitId);
          }
        });
        return () => n2.dispose();
      }).pipe(debounceTime(16)).subscribe((r) => this._forceUpdate(r))
    );
  }
  _initCloseListener() {
    this._univerInstanceService.getCurrentTypeOfUnit$(we.UNIVER_SHEET).subscribe((t4) => {
      var r;
      t4 || ((r = this._sidebarDisposable) == null || r.dispose(), this._sidebarDisposable = null);
    });
  }
};
j2 = Bn3([
  M6(0, Inject(G)),
  M6(1, Inject(Gi)),
  M6(2, vr),
  M6(3, Ls),
  M6(4, Inject(z)),
  M6(5, ME),
  M6(6, Wt),
  M6(7, Inject(S12)),
  M6(8, we2),
  M6(9, Inject(Fn)),
  M6(10, Inject(D3))
], j2);
var Vn3 = Object.getOwnPropertyDescriptor;
var Wn4 = (e, t4, r, n2) => {
  for (var i = n2 > 1 ? void 0 : n2 ? Vn3(t4, r) : t4, s2 = e.length - 1, o3; s2 >= 0; s2--)
    (o3 = e[s2]) && (i = o3(i) || i);
  return i;
};
var F4 = (e, t4) => (r, n2) => t4(r, n2, e);
var Gn3 = () => {
  let e = [];
  return {
    add: (i, s2, o3, m8, c2) => e.push({ unitId: i, subUnitId: s2, row: o3, col: m8, value: c2 }),
    getEffects: () => e,
    clean: () => {
      e = [];
    }
  };
};
var J3 = class extends Ve {
  constructor(t4, r, n2, i, s2) {
    super();
    X6(this, "_collectEffectMutation", Gn3());
    this._sheetInterceptorService = t4, this._numfmtService = r, this._univerInstanceService = n2, this._injector = i, this._editorBridgeService = s2, this._initInterceptorEditorStart(), this._initInterceptorEditorEnd(), this._initInterceptorCommands();
  }
  _initInterceptorEditorStart() {
    this._editorBridgeService && this.disposeWithMe(
      We(
        this._sheetInterceptorService.writeCellInterceptor.intercept(uo2, {
          handler: (t4, r, n2) => {
            const i = r.row, s2 = r.col, o3 = this._numfmtService.getValue(
              r.unitId,
              r.subUnitId,
              i,
              s2
            );
            if (o3)
              switch (st3(o3.pattern)) {
                case "scientific":
                case "currency":
                case "grouped":
                case "number": {
                  const c2 = r.worksheet.getCellRaw(i, s2);
                  return (c2 == null ? void 0 : c2.t) === fn.NUMBER && (c2 == null ? void 0 : c2.v) !== void 0 && c2.v !== null && Z1(c2.v) && (c2.v = ba(Number(c2.v))), n2 && n2(c2);
                }
                case "percent":
                case "date":
                case "time":
                case "datetime":
                default:
                  return n2 && n2(t4);
              }
            return n2(t4);
          }
        })
      )
    );
  }
  /**
   * Process the  values after  edit
   * @private
   * @memberof NumfmtService
   */
  // eslint-disable-next-line max-lines-per-function
  _initInterceptorEditorEnd() {
    this.disposeWithMe(
      We(
        this._sheetInterceptorService.writeCellInterceptor.intercept(ms, {
          // eslint-disable-next-line complexity
          handler: (t4, r, n2) => {
            var a4, u, l3;
            if (!(t4 != null && t4.v) && !(t4 != null && t4.p))
              return n2(t4);
            this._collectEffectMutation.clean();
            const i = this._numfmtService.getValue(
              r.unitId,
              r.subUnitId,
              r.row,
              r.col
            ), s2 = r.worksheet.getCellRaw(r.row, r.col);
            if (tR(i == null ? void 0 : i.pattern) || t4.t === fn.FORCE_STRING)
              return n2(t4);
            const o3 = (a4 = t4.p) == null ? void 0 : a4.body, m8 = (l3 = (u = t4 == null ? void 0 : t4.p) == null ? void 0 : u.body) != null && l3.dataStream ? t4.p.body.dataStream.replace(/\r\n$/, "") : String(t4.v), c2 = sR(m8);
            if (o3)
              if (Kn2(o3)) {
                const { dataStream: v7 } = o3, f3 = v7.replace(/\r\n$/, ""), p = Number(f3);
                if (Number.isNaN(p) && !c2)
                  return n2(t4);
              } else
                return n2(t4);
            if (c2) {
              if (!c2.z && !(i != null && i.pattern) && (s2 == null ? void 0 : s2.t) !== fn.STRING && (s2 == null ? void 0 : s2.t) !== fn.FORCE_STRING && a1(m8))
                return n2({
                  ...t4,
                  p: void 0,
                  v: m8,
                  t: fn.FORCE_STRING
                });
              c2.z && this._collectEffectMutation.add(
                r.unitId,
                r.subUnitId,
                r.row,
                r.col,
                {
                  pattern: c2.z
                }
              );
              const v7 = Number(c2.v);
              return n2({ ...t4, p: void 0, v: v7, t: fn.NUMBER });
            }
            return n2(t4);
          }
        })
      )
    );
  }
  _initInterceptorCommands() {
    const t4 = this;
    this.disposeWithMe(
      this._sheetInterceptorService.interceptCommand({
        getMutations(r) {
          var n2;
          switch (r.id) {
            case Sn2.id: {
              const i = t4._univerInstanceService.getCurrentUnitForType(we.UNIVER_SHEET), s2 = i.getUnitId(), o3 = (n2 = i.getActiveSheet()) == null ? void 0 : n2.getSheetId();
              if (!o3)
                return {
                  redos: [],
                  undos: []
                };
              const m8 = t4._collectEffectMutation.getEffects();
              if (t4._collectEffectMutation.clean(), !m8.length)
                return {
                  redos: [],
                  undos: []
                };
              const c2 = m8.filter((v7) => {
                var f3;
                return !!((f3 = v7.value) != null && f3.pattern);
              }).map((v7) => ({
                row: v7.row,
                col: v7.col,
                pattern: v7.value.pattern
              })), a4 = m8.filter((v7) => {
                var f3;
                return !((f3 = v7.value) != null && f3.pattern);
              }).map((v7) => ({
                startRow: v7.row,
                endColumn: v7.col,
                startColumn: v7.col,
                endRow: v7.row
              })), u = [], l3 = [];
              if (c2.length) {
                const v7 = {
                  id: to2.id,
                  params: Us2(s2, o3, c2)
                };
                u.push(v7), l3.push(...Zh2(t4._injector, v7.params));
              }
              if (a4.length) {
                const v7 = {
                  id: li.id,
                  params: {
                    unitId: s2,
                    subUnitId: o3,
                    ranges: a4
                  }
                };
                u.push(v7), l3.push(...Qh(t4._injector, v7.params));
              }
              return {
                redos: u,
                undos: l3.reverse()
              };
            }
          }
          return {
            redos: [],
            undos: []
          };
        }
      })
    );
  }
  dispose() {
    super.dispose(), this._collectEffectMutation.clean();
  }
};
J3 = Wn4([
  F4(0, Inject(G)),
  F4(1, Inject(Wt)),
  F4(2, Inject(vr)),
  F4(3, Inject(Injector)),
  F4(4, Optional(qe3))
], J3);
function Kn2(e) {
  const { textRuns: t4 = [], paragraphs: r = [], customRanges: n2, customBlocks: i = [] } = e, s2 = ["va"];
  return !(t4.some((o3) => !!(o3.ts && Object.keys(o3.ts).some((c2) => s2.includes(c2)))) || r.some((o3) => o3.bullet) || r.length >= 2 || n2 != null && n2.length || i.length > 0);
}
var it2 = (e) => [
  {
    label: "sheet.numfmt.general",
    pattern: null
  },
  {
    label: "sheet.numfmt.text",
    pattern: Ap
  },
  "|",
  {
    label: "sheet.numfmt.number",
    pattern: "0"
  },
  {
    label: "sheet.numfmt.percent",
    pattern: "0.00%"
  },
  {
    label: "sheet.numfmt.scientific",
    pattern: "0.00E+00"
  },
  "|",
  {
    label: "sheet.numfmt.accounting",
    pattern: `"${e}" #,##0.00_);[Red]("${e}"#,##0.00)`
  },
  {
    label: "sheet.numfmt.financialValue",
    pattern: "#,##0.00;[Red]#,##0.00"
  },
  {
    label: "sheet.numfmt.currency",
    pattern: `"${e}"#,##0.00_);[Red]("${e}"#,##0.00)`
  },
  {
    label: "sheet.numfmt.roundingCurrency",
    pattern: `"${e}"#,##0;[Red]"${e}"#,##0`
  },
  "|",
  {
    label: "sheet.numfmt.date",
    pattern: "yyyy-mm-dd;@"
  },
  {
    label: "sheet.numfmt.time",
    pattern: 'am/pm h":"mm":"ss'
  },
  {
    label: "sheet.numfmt.dateTime",
    pattern: "yyyy-m-d am/pm h:mm"
  },
  {
    label: "sheet.numfmt.timeDuration",
    pattern: "h:mm:ss"
  },
  "|",
  {
    label: "sheet.numfmt.moreFmt",
    pattern: ""
  }
];
var Zn2 = (e) => ({
  icon: new Observable((t4) => {
    const r = e.get(Fn);
    return t4.next(xe2(r.getCurrentLocale()).icon), r.localeChanged$.subscribe(() => {
      t4.next(xe2(r.getCurrentLocale()).icon);
    });
  }),
  id: je3.id,
  title: "sheet.numfmt.currency",
  tooltip: "sheet.numfmt.currency",
  type: H1.BUTTON,
  hidden$: Bi(e, we.UNIVER_SHEET),
  disabled$: he(e, { workbookTypes: [Pe2], worksheetTypes: [Ve3, yr], rangeTypes: [Le] })
});
var Yn4 = (e) => ({
  icon: "AddDigitsIcon",
  id: Ve5.id,
  title: "sheet.numfmt.addDecimal",
  tooltip: "sheet.numfmt.addDecimal",
  type: H1.BUTTON,
  hidden$: Bi(e, we.UNIVER_SHEET),
  disabled$: he(e, { workbookTypes: [Pe2], worksheetTypes: [Ve3, yr], rangeTypes: [Le] })
});
var zn2 = (e) => ({
  icon: "ReduceDigitsIcon",
  id: Be3.id,
  title: "sheet.numfmt.subtractDecimal",
  tooltip: "sheet.numfmt.subtractDecimal",
  type: H1.BUTTON,
  hidden$: Bi(e, we.UNIVER_SHEET),
  disabled$: he(e, { workbookTypes: [Pe2], worksheetTypes: [Ve3, yr], rangeTypes: [Le] })
});
var Xn4 = (e) => ({
  icon: "PercentIcon",
  id: Le3.id,
  title: "sheet.numfmt.percent",
  tooltip: "sheet.numfmt.percent",
  type: H1.BUTTON,
  hidden$: Bi(e, we.UNIVER_SHEET),
  disabled$: he(e, { workbookTypes: [Pe2], worksheetTypes: [Ve3, yr], rangeTypes: [Le] })
});
var qn3 = (e) => {
  const t4 = e.get(vr), r = e.get(Ls), n2 = e.get(Fn), i = e.get(z), s2 = [li.id, to2.id], o3 = pt3(
    t4,
    "",
    ({ workbook: m8, worksheet: c2 }) => new Observable(
      (a4) => merge(
        i.selectionMoveEnd$,
        wg(r.onCommandExecuted.bind(r)).pipe(
          filter(([u]) => s2.includes(u.id))
        )
      ).subscribe(() => {
        var l3, v7;
        const u = i.getCurrentSelections();
        if (u && u[0]) {
          const f3 = u[0].range, p = f3.startRow, d2 = f3.startColumn, S = (v7 = m8.getStyles().get((l3 = c2.getCell(p, d2)) == null ? void 0 : l3.s)) == null ? void 0 : v7.n, g7 = S == null ? void 0 : S.pattern, I5 = Y4(n2.getCurrentLocale());
          let w4 = n2.t("sheet.numfmt.general");
          if (nR(g7)) {
            a4.next(w4);
            return;
          }
          if (g7) {
            const R3 = it2(I5).filter((O5) => typeof O5 == "object" && O5.pattern).find(
              (O5) => rR(g7, O5.pattern)
            );
            R3 && typeof R3 == "object" && R3.pattern ? w4 = n2.t(R3.label) : w4 = n2.t("sheet.numfmt.moreFmt");
          }
          a4.next(w4);
        }
      })
    )
  );
  return {
    label: st4,
    id: A2.id,
    tooltip: "sheet.numfmt.title",
    type: H1.SELECTOR,
    slot: true,
    selections: [
      {
        label: {
          name: ot5,
          hoverable: false,
          selectable: false
        }
      }
    ],
    value$: o3,
    hidden$: Bi(e, we.UNIVER_SHEET),
    disabled$: he(e, { workbookTypes: [Pe2], worksheetTypes: [yr, Ve3], rangeTypes: [Le] })
  };
};
var st4 = "sheet.numfmt.moreNumfmtType";
var ot5 = "sheet.numfmt.moreNumfmtType.options";
var Jn4 = (e) => {
  const { value: t4 } = e, r = useDependency(Fn), n2 = t4 != null ? t4 : r.t("sheet.numfmt.general");
  return (0, import_jsx_runtime.jsx)("span", { className: "univer-text-sm", children: n2 });
};
var Qn2 = () => {
  const e = useDependency(Ls), t4 = useDependency(Fn), r = useDependency(U12), n2 = useDependency(D3), i = useDependency(z), s2 = (a4) => {
    const u = i.getCurrentLastSelection();
    if (!u)
      return;
    const l3 = u.range, v7 = [];
    Or.foreach(l3, (f3, p) => {
      a4 ? v7.push({ row: f3, col: p, pattern: a4, type: st3(a4) }) : v7.push({ row: f3, col: p });
    }), e.executeCommand(O2.id, { values: v7 }), r.focus();
  }, o3 = (0, import_react.useMemo)(() => {
    const a4 = w.get(t4.getCurrentLocale());
    return it2(a4);
  }, [t4]), m8 = (a4) => {
    if (a4 === 0)
      s2(null);
    else if (a4 === o3.length - 1)
      e.executeCommand(A2.id), r.focus();
    else {
      const u = o3[a4];
      u.pattern && s2(u.pattern);
    }
  }, c2 = 1220;
  return (0, import_jsx_runtime.jsx)("div", { className: "univer-grid univer-gap-1 univer-p-1.5", children: o3.map((a4, u) => a4 === "|" ? (0, import_jsx_runtime.jsx)(zE, {}, u) : (0, import_jsx_runtime.jsxs)(
    "div",
    {
      className: "univer-flex univer-h-7 univer-items-center univer-justify-between univer-gap-6 univer-rounded univer-px-2 univer-text-sm hover:univer-bg-gray-100 dark:hover:!univer-bg-gray-700",
      onClick: () => {
        m8(u);
      },
      children: [
        (0, import_jsx_runtime.jsx)("span", { children: t4.t(a4.label) }),
        (0, import_jsx_runtime.jsx)("span", { className: "univer-text-xs univer-text-gray-500", children: a4.pattern ? He2(a4.pattern || "", c2, n2.locale).result.trim() : "" })
      ]
    },
    u
  )) });
};
var er3 = {
  [fe2.FORMULAS]: {
    [je3.id]: {
      order: 0,
      menuItemFactory: Zn2
    },
    [Ve5.id]: {
      order: 1,
      menuItemFactory: Yn4
    },
    [Be3.id]: {
      order: 2,
      menuItemFactory: zn2
    },
    [Le3.id]: {
      order: 3,
      menuItemFactory: Xn4
    },
    [A2.id]: {
      order: 4,
      menuItemFactory: qn3
    }
  }
};
var tr2 = Object.getOwnPropertyDescriptor;
var nr4 = (e, t4, r, n2) => {
  for (var i = n2 > 1 ? void 0 : n2 ? tr2(t4, r) : t4, s2 = e.length - 1, o3; s2 >= 0; s2--)
    (o3 = e[s2]) && (i = o3(i) || i);
  return i;
};
var Oe5 = (e, t4) => (r, n2) => t4(r, n2, e);
var Q4 = class extends Ve {
  constructor(e, t4) {
    super(), this._componentManager = e, this._menuManagerService = t4, this._initMenu();
  }
  _initMenu() {
    this._menuManagerService.mergeMenu(er3), [
      [st4, Jn4],
      [ot5, Qn2]
    ].forEach(([e, t4]) => {
      this.disposeWithMe(
        this._componentManager.register(e, t4)
      );
    });
  }
};
Q4 = nr4([
  Oe5(0, Inject(S12)),
  Oe5(1, B12)
], Q4);
var rr4 = Object.defineProperty;
var ir4 = Object.getOwnPropertyDescriptor;
var sr4 = (e, t4, r) => t4 in e ? rr4(e, t4, { enumerable: true, configurable: true, writable: true, value: r }) : e[t4] = r;
var or4 = (e, t4, r, n2) => {
  for (var i = n2 > 1 ? void 0 : n2 ? ir4(t4, r) : t4, s2 = e.length - 1, o3; s2 >= 0; s2--)
    (o3 = e[s2]) && (i = o3(i) || i);
  return i;
};
var ue3 = (e, t4) => (r, n2) => t4(r, n2, e);
var ct4 = (e, t4, r) => sr4(e, typeof t4 != "symbol" ? t4 + "" : t4, r);
var cr4 = "SHEET_NUMFMT_UI_PLUGIN";
var ee3 = class extends Ol {
  constructor(e = xe3, t4, r, n2) {
    super(), this._config = e, this._injector = t4, this._configService = r, this._renderManagerService = n2;
    const { menu: i, ...s2 } = oo(
      {},
      xe3,
      this._config
    );
    i && this._configService.setConfig("menu", i, { merge: true }), this._configService.setConfig("sheets-numfmt-ui.config", s2);
  }
  onStarting() {
    GC(this._injector, [
      [j2],
      [J3],
      [H],
      [Q4]
    ]);
  }
  onRendered() {
    this._registerRenderModules(), zc(this._injector, [
      [j2],
      [J3],
      [Q4]
    ]);
  }
  _registerRenderModules() {
    [
      [de2]
    ].forEach((t4) => {
      this.disposeWithMe(this._renderManagerService.registerRenderModule(we.UNIVER_SHEET, t4));
    });
  }
};
ct4(ee3, "pluginName", cr4);
ct4(ee3, "type", we.UNIVER_SHEET);
ee3 = or4([
  qR(Nl, A),
  ue3(1, Inject(Injector)),
  ue3(2, ic),
  ue3(3, ME)
], ee3);

// node_modules/@univerjs/network/lib/es/facade.js
var w2 = Object.getOwnPropertyDescriptor;
var l = (t4, e, c2, r) => {
  for (var i = r > 1 ? void 0 : r ? w2(e, c2) : e, s2 = t4.length - 1, o3; s2 >= 0; s2--)
    (o3 = t4[s2]) && (i = o3(i) || i);
  return i;
};
var a = (t4, e) => (c2, r) => e(c2, r, t4);
var n = class extends $2 {
  constructor(t4, e) {
    super(), this._injector = t4, this._httpService = e;
  }
  /**
   * Send a GET request to the server.
   * @param {string} url - The requested URL.
   * @param {IRequestParams} [params] - Query parameters.
   * @returns {Promise<HTTPResponse>} Network response.
   */
  get(t4, e) {
    return this._httpService.get(t4, e);
  }
  /**
   * Send a POST request to the server.
   * @param {string} url - The requested URL.
   * @param {IPostRequestParams} [params] - Query parameters.
   * @returns {Promise<HTTPResponse>} Network response.
   */
  post(t4, e) {
    return this._httpService.post(t4, e);
  }
  /**
   * Send a PUT request to the server.
   * @param {string} url - The requested URL
   * @param {IPostRequestParams} [params] - Query parameters
   * @returns {Promise<HTTPResponse>} Network response
   */
  put(t4, e) {
    return this._httpService.put(t4, e);
  }
  /**
   * Send DELETE request to the server.
   * @param {string} url - The requested URL
   * @param {IRequestParams} [params] - Query parameters
   * @returns {Promise<HTTPResponse>} Network response
   */
  delete(t4, e) {
    return this._httpService.delete(t4, e);
  }
  /**
   * Send PATCH request to the server.
   * @param {string} url - The requested URL
   * @param {IPostRequestParams} [params] - Query parameters
   * @returns {Promise<HTTPResponse>} Network response
   */
  patch(t4, e) {
    return this._httpService.patch(t4, e);
  }
  /**
   * Request for a stream of server-sent events. Instead of a single response, the server sends a stream of responses,
   * Univer wraps the stream in an [`Observable`](https://rxjs.dev/guide/observable) which you can call `subscribe` on.
   * @param {HTTPRequestMethod} method - HTTP request method
   * @param {string} url - The requested URL
   * @param {IPostRequestParams} [params] - params Query parameters
   * @returns {Observable<HTTPEvent>} An observable that emits the network response.
   */
  getSSE(t4, e, c2) {
    return this._httpService.getSSE(t4, e, c2);
  }
};
n = l([
  a(0, Inject(Injector)),
  a(1, Inject(x2))
], n);
var f2 = class extends I3 {
  getNetwork() {
    return this._injector.createInstance(n);
  }
  createSocket(e) {
    const r = this._injector.createInstance(Ye).createSocket(e);
    if (!r)
      throw new Error("[WebSocketService]: failed to create socket!");
    return r;
  }
};
I3.extend(f2);

// node_modules/@univerjs/ui/lib/es/facade.js
var F5 = Object.defineProperty;
var R = (n2, e, t4) => e in n2 ? F5(n2, e, { enumerable: true, configurable: true, writable: true, value: t4 }) : n2[e] = t4;
var o = (n2, e, t4) => R(n2, typeof e != "symbol" ? e + "" : e, t4);
var J6 = Object.getOwnPropertyDescriptor;
var D4 = (n2, e, t4, r) => {
  for (var i = r > 1 ? void 0 : r ? J6(e, t4) : e, s2 = n2.length - 1, c2; s2 >= 0; s2--)
    (c2 = n2[s2]) && (i = c2(i) || i);
  return i;
};
var d = (n2, e) => (t4, r) => e(t4, r, n2);
var E2 = class extends $2 {
  /**
   * Append the menu to any menu position on Univer UI.
   * @param {string | string[]} path - Some predefined path to append the menu. The paths can be an array,
   * or an array joined by `|` separator. Since lots of submenus reuse the same name,
   * you may need to specify their parent menus as well.
   *
   * @example
   * ```typescript
   * // This menu item will appear on every `contextMenu.others` section.
   * univerAPI.createMenu({
   *   id: 'custom-menu-id-1',
   *   title: 'Custom Menu 1',
   *   action: () => {
   *     console.log('Custom Menu 1 clicked');
   *   },
   * }).appendTo('contextMenu.others');
   *
   * // This menu item will only appear on the `contextMenu.others` section on the main area.
   * univerAPI.createMenu({
   *   id: 'custom-menu-id-2',
   *   title: 'Custom Menu 2',
   *   action: () => {
   *     console.log('Custom Menu 2 clicked');
   *   },
   * }).appendTo(['contextMenu.mainArea', 'contextMenu.others']);
   * ```
   */
  appendTo(e) {
    const t4 = typeof e == "string" ? e.split("|") : e, r = t4.length, i = {};
    let s2 = i;
    const c2 = this.__getSchema();
    t4.forEach((S, B4) => {
      B4 === r - 1 ? s2[S] = c2 : s2[S] = {}, s2 = s2[S];
    }), this._menuManagerService.mergeMenu(i);
  }
};
var a2;
var _2 = (a2 = class extends E2 {
  constructor(e, t4, r, i) {
    super();
    o(this, "_commandToRegister", /* @__PURE__ */ new Map());
    o(this, "_buildingSchema");
    this._item = e, this._injector = t4, this._commandService = r, this._menuManagerService = i;
    const s2 = typeof e.action == "string" ? e.action : et(12);
    s2 !== e.action && this._commandToRegister.set(s2, e.action), this._buildingSchema = {
      // eslint-disable-next-line ts/explicit-function-return-type
      menuItemFactory: () => ({
        id: e.id,
        type: H1.BUTTON,
        // we only support button for now
        icon: e.icon,
        title: e.title,
        tooltip: e.tooltip,
        commandId: s2
      })
    }, typeof e.order < "u" && (this._buildingSchema.order = e.order);
  }
  /**
   * @ignore
   */
  __getSchema() {
    return this._commandToRegister.forEach((e, t4) => {
      this._commandService.hasCommand(t4) || this._commandService.registerCommand({
        id: t4,
        type: Ms.COMMAND,
        handler: e
      });
    }), { [this._item.id]: this._buildingSchema };
  }
}, o(a2, "RibbonStartGroup", G1), o(a2, "RibbonPosition", w1), o(a2, "MenuManagerPosition", ke2), a2);
_2 = D4([
  d(1, Inject(Injector)),
  d(2, Ls),
  d(3, B12)
], _2);
var l2 = class extends E2 {
  constructor(e, t4, r) {
    super();
    o(this, "_menuByGroups", []);
    o(this, "_submenus", []);
    o(this, "_buildingSchema");
    this._item = e, this._injector = t4, this._menuManagerService = r, this._buildingSchema = {
      // eslint-disable-next-line ts/explicit-function-return-type
      menuItemFactory: () => ({
        id: e.id,
        type: H1.SUBITEMS,
        icon: e.icon,
        title: e.title,
        tooltip: e.tooltip
      })
    }, typeof e.order < "u" && (this._buildingSchema.order = e.order);
  }
  /**
   * Add a menu to the submenu. It can be a {@link FMenu} or a {@link FSubmenu}.
   * @param {FMenu | FSubmenu} submenu - Menu to add to the submenu.
   * @returns {FSubmenu} The FSubmenu itself for chaining calls.
   * @example
   * ```typescript
   * // Create two leaf menus.
   * const menu1 = univerAPI.createMenu({
   *   id: 'submenu-nested-1',
   *   title: 'Item 1',
   *   action: () => {
   *     console.log('Item 1 clicked');
   *   }
   * });
   * const menu2 = univerAPI.createMenu({
   *   id: 'submenu-nested-2',
   *   title: 'Item 2',
   *   action: () => {
   *     console.log('Item 2 clicked');
   *   }
   * });
   *
   * // Add the leaf menus to a submenu.
   * const submenu = univerAPI.createSubmenu({ id: 'submenu-nested', title: 'Nested Submenu' })
   *   .addSubmenu(menu1)
   *   .addSeparator()
   *   .addSubmenu(menu2);
   *
   * // Create a root submenu append to the `contextMenu.others` section.
   * univerAPI.createSubmenu({ id: 'custom-submenu', title: 'Custom Submenu' })
   *   .addSubmenu(submenu)
   *   .appendTo('contextMenu.others');
   * ```
   */
  addSubmenu(e) {
    return this._submenus.push(e), this;
  }
  /**
   * Add a separator to the submenu.
   * @returns {FSubmenu} The FSubmenu itself for chaining calls.
   * @example
   * ```typescript
   * // Create two leaf menus.
   * const menu1 = univerAPI.createMenu({
   *   id: 'submenu-nested-1',
   *   title: 'Item 1',
   *   action: () => {
   *     console.log('Item 1 clicked');
   *   }
   * });
   * const menu2 = univerAPI.createMenu({
   *   id: 'submenu-nested-2',
   *   title: 'Item 2',
   *   action: () => {
   *     console.log('Item 2 clicked');
   *   }
   * });
   *
   * // Add the leaf menus to a submenu and add a separator between them.
   * // Append the submenu to the `contextMenu.others` section.
   * univerAPI.createSubmenu({ id: 'submenu-nested', title: 'Nested Submenu' })
   *   .addSubmenu(menu1)
   *   .addSeparator()
   *   .addSubmenu(menu2)
   *   .appendTo('contextMenu.others');
   * ```
   */
  addSeparator() {
    return this._menuByGroups.push(this._submenus), this._submenus = [], this;
  }
  /**
   * @ignore
   */
  __getSchema() {
    const e = {};
    return this.addSeparator(), this._menuByGroups.forEach((t4, r) => {
      const i = {};
      t4.forEach((s2) => {
        Object.assign(i, s2.__getSchema());
      }), e[`${this._item.id}-group-${r}`] = i;
    }), { [this._item.id]: Object.assign(this._buildingSchema, e) };
  }
};
l2 = D4([
  d(1, Inject(Injector)),
  d(2, B12)
], l2);
var Q5 = Object.getOwnPropertyDescriptor;
var X7 = (n2, e, t4, r) => {
  for (var i = r > 1 ? void 0 : r ? Q5(e, t4) : e, s2 = n2.length - 1, c2; s2 >= 0; s2--)
    (c2 = n2[s2]) && (i = c2(i) || i);
  return i;
};
var h3 = (n2, e) => (t4, r) => e(t4, r, n2);
var b = class extends $2 {
  constructor(e, t4, r, i) {
    super();
    o(this, "_forceDisableDisposable", null);
    this._injector = e, this._renderManagerService = t4, this._univerInstanceService = r, this._shortcutService = i;
  }
  /**
   * Enable shortcuts of Univer.
   * @returns {FShortcut} The Facade API instance itself for chaining.
   *
   * @example
   * ```typescript
   * fShortcut.enableShortcut(); // Use the FShortcut instance used by disableShortcut before, do not create a new instance
   * ```
   */
  enableShortcut() {
    var e;
    return (e = this._forceDisableDisposable) == null || e.dispose(), this._forceDisableDisposable = null, this;
  }
  /**
   * Disable shortcuts of Univer.
   * @returns {FShortcut} The Facade API instance itself for chaining.
   *
   * @example
   * ```typescript
   * const fShortcut = univerAPI.getShortcut();
   * fShortcut.disableShortcut();
   * ```
   */
  disableShortcut() {
    return this._forceDisableDisposable || (this._forceDisableDisposable = this._shortcutService.forceDisable()), this;
  }
  /**
   * Trigger shortcut of Univer by a KeyboardEvent and return the matched shortcut item.
   * @param {KeyboardEvent} e - The KeyboardEvent to trigger.
   * @returns {IShortcutItem<object> | undefined} The matched shortcut item.
   *
   * @example
   * ```typescript
   * // Assum the current sheet is empty sheet.
   * const fWorkbook = univerAPI.getActiveWorkbook();
   * const fWorksheet = fWorkbook.getActiveSheet();
   * const fRange = fWorksheet.getRange('A1');
   *
   * // Set A1 cell active and set value to 'Hello Univer'.
   * fRange.activate();
   * fRange.setValue('Hello Univer');
   * console.log(fRange.getCellStyle().bold); // false
   *
   * // Set A1 cell bold by shortcut.
   * const fShortcut = univerAPI.getShortcut();
   * const pseudoEvent = new KeyboardEvent('keydown', {
   *   key: 'b',
   *   ctrlKey: true,
   *   keyCode: univerAPI.Enum.KeyCode.B
   * });
   * const ifShortcutItem = fShortcut.triggerShortcut(pseudoEvent);
   * if (ifShortcutItem) {
   *   const commandId = ifShortcutItem.id;
   *   console.log(fRange.getCellStyle().bold); // true
   * }
   * ```
   */
  triggerShortcut(e) {
    const t4 = this._univerInstanceService.getCurrentUnitForType(we.UNIVER_SHEET);
    if (!t4)
      return;
    const r = this._renderManagerService.getRenderById(t4.getUnitId());
    return r ? (r.engine.getCanvasElement().dispatchEvent(e), this._shortcutService.dispatch(e)) : void 0;
  }
  /**
   * Dispatch a KeyboardEvent to the shortcut service and return the matched shortcut item.
   * @param {KeyboardEvent} e - The KeyboardEvent to dispatch.
   * @returns {IShortcutItem<object> | undefined} The matched shortcut item.
   *
   * @example
   * ```typescript
   * const fShortcut = univerAPI.getShortcut();
   * const pseudoEvent = new KeyboardEvent('keydown', { key: 's', ctrlKey: true });
   * const ifShortcutItem = fShortcut.dispatchShortcutEvent(pseudoEvent);
   * if (ifShortcutItem) {
   *   const commandId = ifShortcutItem.id;
   *   // Do something with the commandId.
   * }
   * ```
   */
  dispatchShortcutEvent(e) {
    return this._shortcutService.dispatch(e);
  }
};
b = X7([
  h3(0, Inject(Injector)),
  h3(1, Inject(ME)),
  h3(2, vr),
  h3(3, ye2)
], b);
var Y6 = class extends I3 {
  getURL() {
    return new URL(window.location.href);
  }
  getShortcut() {
    return this._injector.createInstance(b);
  }
  copy() {
    return this._commandService.executeCommand(Fn2.id);
  }
  paste() {
    return this._commandService.executeCommand(jn.id);
  }
  createMenu(e) {
    return this._injector.createInstance(_2, e);
  }
  createSubmenu(e) {
    return this._injector.createInstance(l2, e);
  }
  openSiderbar(e) {
    return this._injector.get(we2).open(e);
  }
  openSidebar(e) {
    return this.openSiderbar(e);
  }
  openDialog(e) {
    const r = this._injector.get(ct).open({
      ...e,
      onClose: () => {
        r.dispose();
      }
    });
    return r;
  }
  getComponentManager() {
    return this._injector.get(S12);
  }
  showMessage(e) {
    return this._injector.get(et2).show(e), this;
  }
  setUIVisible(e, t4) {
    return this._injector.get(D1).setUIVisible(e, t4), this;
  }
  isUIVisible(e) {
    return this._injector.get(D1).isUIVisible(e);
  }
  registerUIPart(e, t4) {
    return this._injector.get(D1).registerComponent(e, () => connectInjector(t4, this._injector));
  }
  registerComponent(e, t4, r) {
    const i = this._injector.get(S12);
    return this.disposeWithMe(i.register(e, t4, r));
  }
  setCurrent(e) {
    if (!this._injector.get(ME).getRenderById(e))
      throw new Error("Unit not found");
    this._univerInstanceService.setCurrentUnitForType(e);
  }
};
I3.extend(Y6);
var Z3 = class extends P2 {
  onBeforeCopy(e) {
    return this._injector.get(Ls).beforeCommandExecuted((r) => {
      r.id === Fn2.id && e();
    });
  }
  onCopy(e) {
    return this._injector.get(Ls).onCommandExecuted((r) => {
      r.id === Fn2.id && e();
    });
  }
  onBeforePaste(e) {
    return this._injector.get(Ls).beforeCommandExecuted((r) => {
      r.id === jn.id && e();
    });
  }
  onPaste(e) {
    return this._injector.get(Ls).onCommandExecuted((r) => {
      (r.id === jn.id || r.id === Qi) && e();
    });
  }
};
P2.extend(Z3);
var ee4 = class extends O {
  get BuiltInUIPart() {
    return c12;
  }
  get KeyCode() {
    return q1;
  }
};
O.extend(ee4);

// node_modules/@univerjs/docs-ui/lib/es/facade.js
var h6 = Object.defineProperty;
var v6 = (n2, e, t4) => e in n2 ? h6(n2, e, { enumerable: true, configurable: true, writable: true, value: t4 }) : n2[e] = t4;
var m7 = (n2, e, t4) => v6(n2, typeof e != "symbol" ? e + "" : e, t4);
var M8 = Object.getOwnPropertyDescriptor;
var R2 = (n2, e, t4, r) => {
  for (var i = r > 1 ? void 0 : r ? M8(e, t4) : e, s2 = n2.length - 1, d2; s2 >= 0; s2--)
    (d2 = n2[s2]) && (i = d2(i) || i);
  return i;
};
var c = (n2, e) => (t4, r) => e(t4, r, n2);
var o2 = class {
  constructor(n2, e, t4, r, i, s2) {
    m7(this, "id");
    this._documentDataModel = n2, this._injector = e, this._univerInstanceService = t4, this._commandService = r, this._resourceManagerService = i, this._renderManagerService = s2, this.id = this._documentDataModel.getUnitId();
  }
  getId() {
    return this._documentDataModel.getUnitId();
  }
  getName() {
    return this.getSnapshot().title || "";
  }
  getSnapshot() {
    const n2 = this._resourceManagerService.getResourcesByType(this.id, we.UNIVER_DOC), e = this._documentDataModel.getSnapshot();
    return e.resources = n2, e;
  }
  undo() {
    return this._univerInstanceService.focusUnit(this.id), this._commandService.executeCommand(gC.id);
  }
  redo() {
    return this._univerInstanceService.focusUnit(this.id), this._commandService.executeCommand(_C.id);
  }
  /**
   * Adds the specified text to the end of this text region.
   * @param text - The text to be added to the end of this text region.
   */
  appendText(n2) {
    const e = this.id, { body: t4 } = this.getSnapshot();
    if (!t4)
      throw new Error("The document body is empty");
    const r = t4.dataStream.length - 2, i = {
      startOffset: r,
      endOffset: r,
      collapsed: true,
      segmentId: ""
    }, { segmentId: s2 } = i;
    return this._commandService.executeCommand(va.id, {
      unitId: e,
      body: {
        dataStream: n2
      },
      range: i,
      segmentId: s2
    });
  }
  /**
   * Sets the selection to a specified text range in the document.
   * @param startOffset - The starting offset of the selection in the document.
   * @param endOffset - The ending offset of the selection in the document.
   * @example
   * ```typescript
   * document.setSelection(10, 20);
   * ```
   */
  setSelection(n2, e) {
    var r;
    const t4 = (r = this._renderManagerService.getRenderById(this.getId())) == null ? void 0 : r.with(Re);
    t4 == null || t4.removeAllRanges(), t4 == null || t4.addDocRanges(
      [
        {
          startOffset: n2,
          endOffset: e,
          rangeType: jg.TEXT
        }
      ],
      true
    );
  }
};
o2 = R2([
  c(1, Inject(Injector)),
  c(2, vr),
  c(3, Ls),
  c(4, Jo),
  c(5, ME)
], o2);
var O4 = class extends I3 {
  createUniverDoc(e) {
    const t4 = this._univerInstanceService.createUnit(we.UNIVER_DOC, e);
    return this._injector.createInstance(o2, t4);
  }
  getActiveDocument() {
    const e = this._univerInstanceService.getCurrentUnitForType(we.UNIVER_DOC);
    return e ? this._injector.createInstance(o2, e) : null;
  }
  getUniverDoc(e) {
    const t4 = this._univerInstanceService.getUniverDocInstance(e);
    return t4 ? this._injector.createInstance(o2, t4) : null;
  }
};
I3.extend(O4);

// node_modules/@univerjs/sheets-formula/lib/es/facade.js
var z2 = class extends I3 {
  /**
   * Initialize the FUniver instance.
   * @ignore
   */
  _initialize() {
    this._debouncedFormulaCalculation = n1(() => {
      this._commandService.executeCommand(
        uo.id,
        {
          commands: [],
          forceCalculation: true
        },
        {
          onlyLocal: true
        }
      );
    }, 10);
  }
  registerFunction(t4) {
    let r = this._injector.get(Br2);
    r || (this._injector.add([Br2, { useClass: _t2 }]), r = this._injector.get(Br2));
    const e = r.registerFunctions(t4);
    return this._debouncedFormulaCalculation(), e;
  }
};
I3.extend(z2);
var B2 = class extends s {
  /**
   * Initialize the FUniver instance.
   * @ignore
   */
  _initialize() {
    this._debouncedFormulaCalculation = n1(() => {
      this._commandService.executeCommand(
        uo.id,
        {
          commands: [],
          forceCalculation: true
        },
        {
          onlyLocal: true
        }
      );
    }, 10);
  }
  setInitialFormulaComputing(t4) {
    const e = this._injector.get(Wn).stage, o3 = this._injector.get(yt), n2 = this._injector.get(ic);
    e > ke.Starting && o3.warn("[FFormula]", "CalculationMode is called after the Starting lifecycle and will take effect the next time the Univer Sheet is constructed. If you want it to take effect when the Univer Sheet is initialized this time, consider calling it before the Ready lifecycle or using configuration.");
    const i = n2.getConfig(ge2);
    if (!i) {
      n2.setConfig(ge2, { initialFormulaComputing: t4 });
      return;
    }
    i.initialFormulaComputing = t4;
  }
  registerFunction(t4, r, e) {
    var c2;
    let o3 = this._injector.get(Br2);
    o3 || (this._injector.add([Br2, { useClass: _t2 }]), o3 = this._injector.get(Br2));
    const n2 = {
      name: t4,
      func: r,
      description: typeof e == "string" ? e : (c2 = e == null ? void 0 : e.description) != null ? c2 : "",
      locales: typeof e == "object" ? e.locales : void 0
    }, i = o3.registerFunction(n2);
    return this._debouncedFormulaCalculation(), i;
  }
  registerAsyncFunction(t4, r, e) {
    var c2;
    let o3 = this._injector.get(Br2);
    o3 || (this._injector.add([Br2, { useClass: _t2 }]), o3 = this._injector.get(Br2));
    const n2 = {
      name: t4,
      func: r,
      description: typeof e == "string" ? e : (c2 = e == null ? void 0 : e.description) != null ? c2 : "",
      locales: typeof e == "object" ? e.locales : void 0
    }, i = o3.registerAsyncFunction(n2);
    return this._debouncedFormulaCalculation(), i;
  }
};
s.extend(B2);
var G2 = class {
  get CalculationMode() {
    return Pe3;
  }
};
O.extend(G2);
var T2 = class extends C {
  getAllFormulaError() {
    const t4 = [], r = this._workbook, e = r.getUnitId(), o3 = r.getSheets(), n2 = this._injector.get(_r).getArrayFormulaCellData();
    return o3.forEach((i) => {
      var h7;
      const c2 = i.getName(), _3 = i.getSheetId(), C2 = i.getCellMatrix(), m8 = ((h7 = n2 == null ? void 0 : n2[e]) == null ? void 0 : h7[_3]) || {};
      C2.forValue((F7, d2, u) => {
        var g7;
        if (!u) return;
        const l3 = (g7 = m8 == null ? void 0 : m8[F7]) == null ? void 0 : g7[d2], a4 = ry(u, !!l3);
        a4 && t4.push({
          sheetName: c2,
          row: F7,
          column: d2,
          formula: u.f || "",
          errorType: a4
        });
      });
    }), t4;
  }
};
C.extend(T2);
var V4 = class extends k5 {
  getFormulaError() {
    var d2, u;
    const t4 = [], r = this._workbook.getUnitId(), e = this._worksheet.getSheetId(), o3 = this._worksheet.getName(), n2 = this._workbook.getSheetBySheetId(e);
    if (!n2) return t4;
    const i = this._injector.get(_r).getArrayFormulaCellData(), c2 = ((d2 = i == null ? void 0 : i[r]) == null ? void 0 : d2[e]) || {}, _3 = n2.getCellMatrix(), { startRow: C2, endRow: m8, startColumn: h7, endColumn: F7 } = this._range;
    for (let l3 = C2; l3 <= m8; l3++)
      for (let a4 = h7; a4 <= F7; a4++) {
        const g7 = _3.getValue(l3, a4);
        if (!g7) continue;
        const E3 = (u = c2 == null ? void 0 : c2[l3]) == null ? void 0 : u[a4], x6 = ry(g7, !!E3);
        x6 && t4.push({
          sheetName: o3,
          row: l3,
          column: a4,
          formula: g7.f || "",
          errorType: x6
        });
      }
    return t4;
  }
};
k5.extend(V4);

// node_modules/@univerjs/sheets-numfmt/lib/es/facade.js
var g6 = class extends k5 {
  setNumberFormat(o3) {
    const t4 = [], { startColumn: e, startRow: s2, endColumn: r, endRow: u } = this._range;
    for (let m8 = s2; m8 <= u; m8++)
      for (let n2 = e; n2 <= r; n2++)
        t4.push({ row: m8, col: n2, pattern: o3 });
    return this._commandService.syncExecuteCommand(O2.id, {
      unitId: this._workbook.getUnitId(),
      subUnitId: this._worksheet.getSheetId(),
      values: t4
    }), this;
  }
  setNumberFormats(o3) {
    var m8;
    const t4 = [], { startColumn: e, startRow: s2, endColumn: r, endRow: u } = this._range;
    for (let n2 = s2; n2 <= u; n2++)
      for (let a4 = e; a4 <= r; a4++) {
        const c2 = (m8 = o3[n2 - s2]) == null ? void 0 : m8[a4 - e];
        t4.push({ row: n2, col: a4, pattern: c2 });
      }
    return this._commandService.syncExecuteCommand(O2.id, {
      unitId: this._workbook.getUnitId(),
      subUnitId: this._worksheet.getSheetId(),
      values: t4
    }), this;
  }
  getNumberFormat() {
    var t4, e;
    const o3 = this.getCellStyle();
    return (e = (t4 = o3 == null ? void 0 : o3.numberFormat) == null ? void 0 : t4.pattern) != null ? e : "";
  }
  getNumberFormats() {
    return this.getCellStyles().map((t4) => t4.map((e) => {
      var s2, r;
      return (r = (s2 = e == null ? void 0 : e.numberFormat) == null ? void 0 : s2.pattern) != null ? r : "";
    }));
  }
};
k5.extend(g6);
var b2 = class extends C {
  setNumfmtLocal(o3) {
    return this._injector.get(D3).setNumfmtLocal(o3), this;
  }
};
C.extend(b2);

// node_modules/@univerjs/sheets-formula-ui/lib/es/facade.js
var t = class extends I3 {
  showRangeSelectorDialog(o3) {
    return this._injector.get(Lr).showRangeSelectorDialog(o3);
  }
};
I3.extend(t);

// node_modules/@univerjs/preset-sheets-core/lib/es/index.js
function rr5(m8 = {}) {
  var n2;
  const {
    container: l3 = "app",
    workerURL: t4,
    header: p,
    footer: u,
    toolbar: a4,
    ribbonType: c2,
    formulaBar: g7,
    menu: f3,
    contextMenu: S,
    disableAutoFocus: d2,
    docs: i,
    sheets: r,
    formula: o3,
    disableTextFormatAlert: U2,
    disableTextFormatMark: x6
  } = m8, e = !!t4;
  return {
    plugins: [
      V3,
      [q6, {
        hasScroll: i == null ? void 0 : i.hasScroll
      }],
      o7,
      [k3, {
        container: l3,
        header: p,
        toolbar: a4,
        ribbonType: c2,
        menu: f3,
        contextMenu: S,
        disableAutoFocus: d2
      }],
      wr2,
      e ? [N, { workerURL: t4 }] : null,
      [Wi, {
        notExecuteFormula: e,
        function: o3 == null ? void 0 : o3.function
      }],
      [ss, {
        notExecuteFormula: e,
        onlyRegisterFormulaRelatedMutations: false,
        isRowStylePrecedeColumnStyle: r == null ? void 0 : r.isRowStylePrecedeColumnStyle,
        autoHeightForMergedCells: r == null ? void 0 : r.autoHeightForMergedCells,
        freezeSync: r == null ? void 0 : r.freezeSync
      }],
      [Nl, {
        formulaBar: g7,
        footer: u,
        maxAutoHeightCount: r == null ? void 0 : r.maxAutoHeightCount,
        clipboardConfig: r == null ? void 0 : r.clipboardConfig,
        scrollConfig: r == null ? void 0 : r.scrollConfig,
        protectedRangeShadow: (n2 = r == null ? void 0 : r.protectedRangeShadow) != null ? n2 : true,
        protectedRangeUserSelector: r == null ? void 0 : r.protectedRangeUserSelector,
        disableForceStringAlert: r == null ? void 0 : r.disableForceStringAlert,
        disableForceStringMark: r == null ? void 0 : r.disableForceStringMark
      }],
      [A, {
        disableTextFormatAlert: U2,
        disableTextFormatMark: x6
      }],
      ee3,
      [ot3, {
        notExecuteFormula: e,
        description: o3 == null ? void 0 : o3.description,
        initialFormulaComputing: o3 == null ? void 0 : o3.initialFormulaComputing
      }],
      [Bt, {
        functionScreenTips: o3 == null ? void 0 : o3.functionScreenTips
      }]
    ].filter((F7) => !!F7)
  };
}
export {
  DC as AFFECT_LAYOUT_STYLES,
  ms as AFTER_CELL_EDIT,
  Le2 as APPLY_TYPE,
  Fb as ActiveDirtyManagerService,
  Ve5 as AddDecimalCommand,
  eg as AddMergeRedoSelectionsOperationFactory,
  We3 as AddMergeUndoMutationFactory,
  tg as AddMergeUndoSelectionsOperationFactory,
  Nu as AddRangeProtectionCommand,
  ii as AddRangeProtectionFromContextMenuCommand,
  fa2 as AddRangeProtectionFromSheetBarCommand,
  ma4 as AddRangeProtectionFromToolbarCommand,
  Be2 as AddRangeProtectionMutation,
  dd as AddRangeThemeMutation,
  Wh2 as AddWorksheetMergeAllCommand,
  hs as AddWorksheetMergeCommand,
  Vh as AddWorksheetMergeHorizontalCommand,
  ne as AddWorksheetMergeMutation,
  Lh as AddWorksheetMergeVerticalCommand,
  ac as AddWorksheetProtectionCommand,
  ft as AddWorksheetProtectionMutation,
  Mo as AfterSpaceCommand,
  Uo as AlignCenterCommand,
  Ho as AlignJustifyCommand,
  Qo2 as AlignLeftCommand,
  lt3 as AlignOperationCommand,
  Fo as AlignRightCommand,
  cc as AppendRowCommand,
  wa2 as ApplyFormatPainterCommand,
  q2 as ArrayValueObject,
  Po as AstRootNodeFactory,
  Ur as AstTreeBuilder,
  Yf as AsyncArrayObject,
  ny2 as AsyncCustomFunction,
  $f as AsyncObject,
  Xe as AuthInterceptorFactory,
  _o2 as AutoClearContentCommand,
  gr3 as AutoFillCommand,
  bi as AutoFillController,
  el3 as AutoFillService,
  hi as AutoHeightController,
  Ir2 as AutoWidthController,
  T7 as BASE_OBJECT_ARRAY,
  uo2 as BEFORE_CELL_EDIT,
  SB as BG_Z_INDEX,
  X as BORDER_TYPE,
  FB as BORDER_Z_INDEX,
  hb as Background,
  V2 as BaseFunction,
  a3 as BaseObject,
  Xn as BaseReferenceObject,
  mm as BaseSelectionRenderService,
  Ht as BaseValueObject,
  rr as BooleanValue,
  T as BooleanValueObject,
  pb as Border,
  Ft2 as BorderStyleManagerService,
  Gr2 as BreakLineCommand,
  ge as BreakType,
  Ge as BrowserClipboardService,
  c12 as BuiltInUIPart,
  xn as BulletListCommand,
  Sx as CHECK_OBJECT_ARRAY,
  Tx as CIRCLE_OBJECT_ARRAY,
  z3 as COLOR_BLACK_RGB,
  m5 as COLOR_PICKER_COMPONENT,
  mh as COMMAND_LISTENER_SKELETON_CHANGE,
  fh as COMMAND_LISTENER_VALUE_CHANGE,
  f5 as COMMON_LABEL_COMPONENT,
  Yn3 as COPY_TYPE,
  Ae3 as CURRENCYFORMAT,
  v1 as CURSOR_TYPE,
  Pn as CalculateController,
  Js as CalculateFormulaService,
  Pe3 as CalculationMode,
  Dc as CancelFrozenCommand,
  md as CancelMarkDirtyRowAutoHeightMutation,
  ye as Canvas,
  I4 as CanvasColorService,
  nt as CanvasFloatDomService,
  Qn as CanvasPopup,
  Xn2 as CanvasPopupService,
  k4 as CanvasRenderMode,
  Do2 as CellAlertManagerService,
  po as CellAlertType,
  al2 as CellCustomRenderController,
  Bm as CellEditorManagerService,
  Mi as CellPopupManagerService,
  gr2 as ChangeListNestingLevelCommand,
  qn2 as ChangeListNestingLevelType,
  Lo3 as ChangeListTypeCommand,
  Ma2 as ChangeSheetProtectionFromSheetBarCommand,
  os as ChangeZoomRatioCommand,
  _e as ChannelClient,
  ue as ChannelServer,
  K as ChannelService,
  so2 as CheckListCommand,
  m6 as CheckboxShape,
  z8 as Circle,
  Ws2 as ClearSelectionAllCommand,
  qs as ClearSelectionContentCommand,
  Ls3 as ClearSelectionFormatCommand,
  bb as ColumnHeaderLayout,
  h5 as CommonLabel,
  I12 as ComponentContainer,
  L7 as ComponentExtension,
  S12 as ComponentManager,
  co2 as ContextMenu,
  a12 as ContextMenuGroup,
  Y1 as ContextMenuPosition,
  er as ContextMenuService,
  UB as Control,
  Fn2 as CopyCommand,
  qr as CopySheetCommand,
  W5 as CopyShortcutItem,
  Xd as CoverContentCommand,
  Wa as CreateDocTableCommand,
  Db as Custom,
  jm as CustomFunction,
  _1 as CustomLabel,
  JB as CustomObject,
  kn as CutCommand,
  Jt2 as CutContentCommand,
  Y5 as CutShortcutItem,
  mt3 as DATA_TYPE,
  Fe4 as DATEFMTLISG,
  ha as DEFAULT_DOCUMENT_FONTSIZE,
  G3 as DEFAULT_FONTFACE_PLANE,
  DB as DEFAULT_FRAME_LIST_SIZE,
  Qv as DEFAULT_FRAME_SAMPLE_SIZE,
  Hh as DEFAULT_INTERVAL_COUNT,
  yv as DEFAULT_MEASURE_TEXT,
  ca as DEFAULT_OFFSET_SPACING,
  h2 as DEFAULT_PADDING_DATA,
  $T as DEFAULT_SKELETON_FOOTER,
  NT as DEFAULT_SKELETON_HEADER,
  wi as DISABLE_AUTO_FOCUS_KEY,
  bh as DISABLE_NORMAL_SELECTIONS,
  id2 as DOCS_COMPONENT_BACKGROUND_LAYER_INDEX,
  Js3 as DOCS_COMPONENT_DEFAULT_Z_INDEX,
  ad2 as DOCS_COMPONENT_HEADER_LAYER_INDEX,
  zo as DOCS_COMPONENT_MAIN_LAYER_INDEX,
  $e2 as DOCS_VIEW_KEY,
  ka as DOCUMENT_CONTEXT_CLIP_TYPE,
  E as DOC_INTERCEPTOR_POINT,
  sd2 as DOC_UI_PLUGIN_NAME,
  Oi2 as DOC_VERTICAL_PADDING,
  HT as DRAWING_OBJECT_LAYER_INDEX,
  UT as DRAWING_OBJECT_LOWER_LAYER_INDEX,
  GT as DRAWING_OBJECT_UPPER_LAYER_INDEX,
  _8 as DashedRect,
  N2 as DataStreamTreeNode,
  y as DataSyncPrimaryController,
  f as DataSyncReplicaController,
  rd as DefaultDocContainerConfig,
  od2 as DefaultToolbarConfig,
  Kn as DefinedNameDataController,
  Ps as DefinedNamesService,
  yn as DeleteCommand,
  Zr as DeleteCustomBlockCommand,
  Do as DeleteLeftCommand,
  vt as DeleteRangeMoveLeftCommand,
  ts2 as DeleteRangeMoveLeftConfirmCommand,
  Mt2 as DeleteRangeMoveUpCommand,
  pi as DeleteRangeMoveUpConfirmCommand,
  hc as DeleteRangeProtectionCommand,
  si2 as DeleteRangeProtectionFromContextMenuCommand,
  ot2 as DeleteRangeProtectionMutation,
  ba2 as DeleteRightCommand,
  gc as DeleteWorksheetProtectionCommand,
  ya as DeleteWorksheetProtectionFormSheetBarCommand,
  _t as DeleteWorksheetProtectionMutation,
  mc as DeleteWorksheetRangeThemeStyleCommand,
  sn as DeleteWorksheetRangeThemeStyleMutation,
  Da as DeleteWorksheetRangeThemeStyleMutationFactory,
  Fn3 as DeltaColumnWidthCommand,
  zn as DeltaRowHeightCommand,
  vh as DependencyManagerBaseService,
  Th as DependencyManagerService,
  Mt3 as DescriptionService,
  Ye2 as DesktopBeforeCloseService,
  Xe2 as DesktopConfirmService,
  qe as DesktopDialogService,
  Je3 as DesktopGalleryService,
  Qe2 as DesktopGlobalZoneService,
  Fe as DesktopLayoutService,
  sr2 as DesktopLocalFileService,
  cr2 as DesktopLocalStorageService,
  E5 as DesktopMenu,
  Ke2 as DesktopMessageService,
  e32 as DesktopNotificationService,
  ur as DesktopSidebarService,
  B3 as DesktopUIController,
  t3 as DesktopZenZoneService,
  Kv as DeviceInputEventType,
  g2 as DeviceType,
  Dt2 as DocAutoFormatService,
  uo3 as DocBackScrollRenderController,
  w8 as DocBackground,
  Bn2 as DocCanvasPopManagerService,
  ro2 as DocCopyCommand,
  Os as DocCreateTableOperation,
  rs2 as DocCutCommand,
  wt2 as DocEventManagerService,
  No2 as DocIMEInputManagerService,
  J2 as DocInterceptorService,
  is as DocPasteCommand,
  af as DocPrintInterceptorService,
  br3 as DocRenderController,
  Oa3 as DocSelectAllCommand,
  m3 as DocSelectionManagerService,
  Re as DocSelectionRenderService,
  v4 as DocSimpleSkeleton,
  D2 as DocSkeletonManagerService,
  Io2 as DocStateChangeManagerService,
  te as DocStateEmitService,
  Ss2 as DocTableDeleteColumnsCommand,
  Is as DocTableDeleteRowsCommand,
  Hn as DocTableDeleteTableCommand,
  SA as DocTableInsertColumnCommand,
  ys2 as DocTableInsertColumnLeftCommand,
  xs2 as DocTableInsertColumnRightCommand,
  Rs as DocTableInsertRowAboveCommand,
  bs3 as DocTableInsertRowBellowCommand,
  ja as DocTableInsertRowCommand,
  za as DocTableTabCommand,
  Ao as DocUIController,
  So2 as DocsRenderService,
  hg as DocsUIMenuSchema,
  d3 as DocumentEditArea,
  v3 as DocumentSkeleton,
  c1 as DocumentSkeletonPageType,
  e3 as DocumentViewModel,
  ve as Documents,
  ze as DocumentsSpanAndLineExtensionRegistry,
  Oo2 as DragManagerService,
  cl as DragRenderController,
  HB as Drawing,
  QB as DumbCanvasColorService,
  q0 as EMBEDDING_FORMULA_EDITOR,
  Ld as EMBEDDING_FORMULA_EDITOR_COMPONENT_KEY,
  c4 as EMOJI_REG,
  ey as ENGINE_FORMULA_CYCLE_REFERENCE_COUNT,
  Ca as ENGINE_FORMULA_PLUGIN_CONFIG_KEY,
  or as ERROR_TYPE_SET,
  s0 as EXPAND_SIZE_FOR_RENDER_OVERFLOW,
  Pu as EditStateEnum,
  Ri as EditingRenderController,
  kA as Editor,
  ll as EditorBridgeService,
  _d as EditorInsertTextCommandId,
  Sr3 as EditorService,
  W2 as EffectRefRangId,
  hd as EmptyMutation,
  be as Engine,
  bn as EnterCommand,
  oe as ErrorController,
  m2 as ErrorType,
  g4 as ErrorValueObject,
  $0 as EventConstants,
  jd as ExclusiveRangeService,
  Gt2 as ExpandSelectionCommand,
  Oo as FILE_PNG_CLIPBOARD_MIME_TYPE,
  Ki as FILE_SVG_XML_CLIPBOARD_MIME_TYPE,
  Eo as FILE__BMP_CLIPBOARD_MIME_TYPE,
  $o as FILE__JPEG_CLIPBOARD_MIME_TYPE,
  No as FILE__WEBP_CLIPBOARD_MIME_TYPE,
  p2 as FIX_ONE_PIXEL_BLUR_OFFSET,
  nb as FONT_EXTENSION_Z_INDEX,
  w5 as FONT_FAMILY_COMPONENT,
  _5 as FONT_FAMILY_ITEM_COMPONENT,
  ki as FONT_FAMILY_LIST,
  M5 as FONT_SIZE_COMPONENT,
  ji as FONT_SIZE_LIST,
  Ms2 as FORMULA_PROMPT_ACTIVATED,
  ea as FUNCTION_NAMES_ARRAY,
  le2 as FUNCTION_NAMES_COMPATIBILITY,
  xm as FUNCTION_NAMES_CUBE,
  Qe as FUNCTION_NAMES_DATABASE,
  be2 as FUNCTION_NAMES_DATE,
  Z2 as FUNCTION_NAMES_ENGINEERING,
  ee as FUNCTION_NAMES_FINANCIAL,
  Oe as FUNCTION_NAMES_INFORMATION,
  De as FUNCTION_NAMES_LOGICAL,
  fe as FUNCTION_NAMES_LOOKUP,
  Y2 as FUNCTION_NAMES_MATH,
  v as FUNCTION_NAMES_STATISTICAL,
  se as FUNCTION_NAMES_TEXT,
  Vb as FUNCTION_NAMES_UNIVER,
  Wu as FUNCTION_NAMES_WEB,
  yh as FactoryAddRangeProtectionMutation,
  _h as FactoryDeleteRangeProtectionMutation,
  Bh2 as FactorySetRangeProtectionMutation,
  Bh as FeatureCalculationManagerService,
  N3 as FetchHTTPImplementation,
  Gn as FloatDom,
  to as FloatDomSingle,
  fx as Font,
  S1 as FontCache,
  b5 as FontFamily,
  L5 as FontFamilyItem,
  y5 as FontSize,
  zt as FormatPainterStatus,
  s02 as FormulaBar,
  Us as FormulaCurrentConfigService,
  _r as FormulaDataModel,
  Zs as FormulaDependencyGenerator,
  bs as FormulaDependencyTree,
  Ks as FormulaDependencyTreeType,
  Si as FormulaDependencyTreeVirtual,
  Cc2 as FormulaEditor,
  yr2 as FormulaEditorController,
  Je as FormulaExecuteStageType,
  Sr as FormulaExecutedStateType,
  xt2 as FormulaRefRangeService,
  $t2 as FormulaReorderController,
  Ws as FormulaRuntimeService,
  On as FunctionNodeFactory,
  sh as FunctionService,
  yc as FunctionType,
  qu as GlobalComputingStatusService,
  Lr as GlobalRangeSelectorService,
  tr as GlobalZone,
  e2 as GlyphType,
  s7 as Group,
  v52 as HEADING_ITEM_COMPONENT,
  Ui as HEADING_LIST,
  Kt as HTML_CLIPBOARD_MIME_TYPE,
  Q as HTTPEventType,
  I2 as HTTPHeaders,
  _e2 as HTTPProgress,
  X4 as HTTPRequest,
  q5 as HTTPResponse,
  v5 as HTTPResponseError,
  x2 as HTTPService,
  L as HTTPStatusCode,
  Vo as HeaderFreezeRenderController,
  No3 as HeaderMoveRenderController,
  ko2 as HeaderResizeRenderController,
  C5 as HeadingItem,
  ws2 as HelpFunctionOperation,
  da as HideColConfirmCommand,
  ca3 as HideRowConfirmCommand,
  xB as HitCanvas,
  Po2 as HorizontalLineCommand,
  Mr2 as HoverManagerService,
  hl2 as HoverRenderController,
  Qs as HyperlinkEngineFormulaService,
  kb as IActiveDirtyManagerService,
  Hr2 as IAutoFillService,
  ir as IBeforeCloseService,
  zs as ICalculateFormulaService,
  T8 as ICanvasColorService,
  rt as ICanvasPopupService,
  ls2 as ICellEditorManagerService,
  lr as IClipboardInterfaceService,
  at as IConfirmService,
  c32 as IContextMenuService,
  Nr as IDefinedNamesService,
  Jn as IDependencyManagerService,
  Gt3 as IDescriptionService,
  ct as IDialogService,
  Nt2 as IDocClipboardService,
  qe3 as IEditorBridgeService,
  Ge3 as IEditorService,
  Eo2 as IExclusiveRangeService,
  vr2 as IFeatureCalculationManagerService,
  Dn2 as IFormatPainterService,
  Yt as IFormulaCurrentConfigService,
  Xs as IFormulaDependencyGenerator,
  as2 as IFormulaEditorManagerService,
  St as IFormulaRuntimeService,
  Qt as IFunctionService,
  ut as IGalleryService,
  lt as IGlobalZoneService,
  Y3 as IHTTPImplementation,
  Lo as IHyperlinkEngineFormulaService,
  U12 as ILayoutService,
  Ai as ILeftSidebarService,
  ar as ILocalFileService,
  Ta as IMEInputCommand,
  Wi3 as IMarkSelectionService,
  B12 as IMenuManagerService,
  et2 as IMessageService,
  N0 as INITIAL_MATRIX,
  Zv as INITIAL_Path2,
  ht as INTERCEPTOR_POINT,
  u3 as INotificationService,
  Wt as INumfmtService,
  Ma as IOtherFormulaManagerService,
  tt as IPlatformService,
  I as IRPCChannelService,
  Fu as IRefSelectionsService,
  Br2 as IRegisterFunctionService,
  g as IRemoteInstanceService,
  Xa as IRemoteRegisterFunctionService,
  m as IRemoteSyncService,
  ME as IRenderManagerService,
  $E as IRenderingEngine,
  Op as ISheetCellDropdownManagerService,
  nn2 as ISheetClipboardService,
  _o as ISheetRowFilteredService,
  gt as ISheetSelectionRenderService,
  ye2 as IShortcutService,
  we2 as ISidebarService,
  ze2 as ISocketService,
  xa2 as IStatusBarService,
  Qu as ISuperTableService,
  We2 as IUIController,
  D1 as IUIPartsService,
  le as IWatermarkTypeEnum,
  st as IZenZoneService,
  GB as Image,
  Sa as InnerPasteCommand,
  ol as InsertColAfterCommand,
  sl as InsertColBeforeCommand,
  Dr2 as InsertColByRangeCommand,
  Xe4 as InsertColCommand,
  ke3 as InsertColMutation,
  rs as InsertColMutationUndoFactory,
  va as InsertCommand,
  $d as InsertCustomRangeCommand,
  fc as InsertDefinedNameCommand,
  ni as InsertFunctionCommand,
  pe as InsertFunctionOperation,
  rl as InsertMultiColsLeftCommand,
  il as InsertMultiColsRightCommand,
  tl2 as InsertMultiRowsAboveCommand,
  nl as InsertMultiRowsAfterCommand,
  Nt as InsertRangeMoveDownCommand,
  vi as InsertRangeMoveDownConfirmCommand,
  an2 as InsertRangeMoveRightCommand,
  ns2 as InsertRangeMoveRightConfirmCommand,
  el2 as InsertRowAfterCommand,
  Qu2 as InsertRowBeforeCommand,
  Nr2 as InsertRowByRangeCommand,
  Ye3 as InsertRowCommand,
  Ue as InsertRowMutation,
  xs as InsertRowMutationUndoFactory,
  Rc as InsertSheetCommand,
  hn as InsertSheetMutation,
  Jr as InsertSheetUndoMutationFactory,
  ha3 as InterceptCellContentPriority,
  br as Interpreter,
  xv as IsSafari,
  Ln3 as JumpOver,
  q1 as KeyCode,
  ga as LINK_VIEW_PORT_TYPE,
  Mn as LambdaNodeFactory,
  Bo as LambdaParameterNodeFactory,
  Oa as LambdaValueObjectObject,
  j8 as Layer,
  Ar as Lexer,
  ae as LexerNode,
  ga2 as LexerTreeBuilder,
  P3 as LineType,
  J4 as Liquid,
  Fn4 as ListOperationCommand,
  CE as MAIN_VIEW_PORT_KEY,
  j6 as MAXIMUM_COL_WIDTH,
  ma as MAXIMUM_ROW_HEIGHT,
  pd as MAX_CELL_PER_SHEET_KEY,
  m4 as MEASURE_EXTENT,
  R6 as MEASURE_EXTENT_FOR_PARAGRAPH,
  Kl as MERGE_CELL_INTERCEPTOR_CHECK,
  L3 as MIDDLE_CELL_POS_MAGIC_NUMBER,
  pa as MIN_COL_WIDTH,
  gd as MarkDirtyRowAutoHeightMutation,
  tl3 as MarkSelectionService,
  zx as Marker,
  H1 as MenuItemType,
  ke2 as MenuManagerPosition,
  je as MenuManagerService,
  Ln2 as MergeCellController,
  Ve2 as MergeInterceptorFactory,
  Jr2 as MergeTwoParagraphCommand,
  L1 as MetaKeys,
  Lo2 as MobileContextMenu,
  KR as MobileSheetBar,
  n7 as MockMessageService,
  Cn as MoreFunctionsOperation,
  ln as MoveColsCommand,
  qe2 as MoveColsMutation,
  xa as MoveColsMutationUndoFactory,
  St3 as MoveCursorOperation,
  bt as MoveRangeCommand,
  It as MoveRangeMutation,
  un2 as MoveRowsCommand,
  Je4 as MoveRowsMutation,
  Aa as MoveRowsMutationUndoFactory,
  Ut2 as MoveSelectionCommand,
  Wn3 as MoveSelectionEnterAndTabCommand,
  vt2 as MoveSelectionOperation,
  zf as NORMAL_TEXT_SELECTION_PLUGIN_NAME,
  jB as NORMAL_TEXT_SELECTION_PLUGIN_STYLE,
  De4 as NUMBERFORMAT,
  It2 as NodePositionConvertToCursor,
  ka2 as NodePositionConvertToRectRange,
  ce as NullValueObject,
  y2 as NumberValueObject,
  ks as NumfmtService,
  t0 as ORIENTATION_TYPE,
  w3 as ObjectType,
  wn as OperatorNodeFactory,
  Q3 as OperatorType,
  On3 as OrderListCommand,
  Ih as OtherFormulaManagerService,
  Oe4 as OtherFormulaMarkDirty,
  Vs2 as PASTE_SPECIAL_MENU_ID,
  Ax as PATH_OBJECT_ARRAY,
  Qt2 as PLAIN_TEXT_CLIPBOARD_MIME_TYPE,
  ge2 as PLUGIN_CONFIG_KEY_BASE,
  et3 as PREDEFINED_HOOK_NAME,
  TB as PRINTING_BG_Z_INDEX,
  Q2 as PageLayoutType,
  jn as PasteCommand,
  Ud as PastePluginLark,
  Fd as PastePluginUniver,
  Hd as PastePluginWord,
  X1 as Path,
  Jv as Path2,
  eb as PerformanceMonitor,
  sg as PermissionPointsDefinitions,
  Un as PlatformService,
  e1 as PointerInput,
  Nn as PrefixNodeFactory,
  u7 as PrintFloatDomSingle,
  qi as ProgressBar,
  Na as QuickListCommand,
  ii2 as QuickSumCommand,
  hm as RANGE_SELECTOR_COMPONENT_KEY,
  F02 as RANGE_SELECTOR_SYMBOLS,
  Bx as RECT_OBJECT_ARRAY,
  $u as REF_SELECTIONS_ENABLED,
  Rx as REGULAR_POLYGON_OBJECT_ARRAY,
  V as RENDER_CLASS_TYPE,
  hx as RENDER_RAW_FORMULA_KEY,
  J5 as RICHTEXT_OBJECT_ARRAY,
  Sh as RangeMergeUtil,
  Lt as RangeProtectionCache,
  Gr as RangeProtectionPermissionDeleteProtectionPoint,
  Le as RangeProtectionPermissionEditPoint,
  Kr as RangeProtectionPermissionManageCollaPoint,
  Hs as RangeProtectionPermissionViewPoint,
  ts as RangeProtectionRefRangeService,
  Rn as RangeProtectionRenderModel,
  me as RangeProtectionRuleModel,
  ns as RangeProtectionService,
  pn as RangeReferenceObject,
  Wr as RangeSelector,
  Ct as RangeThemeStyle,
  I1 as Rect,
  ot as RectPopup,
  Va as RectRange,
  RediConsumer,
  RediContext,
  RediProvider,
  q52 as RedoShortcutItem,
  xt as RefRangeService,
  De3 as RefSelectionsRenderService,
  fo2 as RefSelectionsService,
  br4 as ReferenceAbsoluteOperation,
  Sn as ReferenceNodeFactory,
  va2 as RefillCommand,
  kc as RegisterFunctionMutation,
  _t2 as RegisterFunctionService,
  je2 as RegisterOtherFormulaService,
  Cc as RegisterWorksheetRangeThemeStyleCommand,
  gn as RegisterWorksheetRangeThemeStyleMutation,
  O3 as RegularPolygon,
  $ as RemoteInstanceServiceName,
  nt3 as RemoteRegisterFunctionService,
  M as RemoteSyncPrimaryService,
  W as RemoteSyncServiceName,
  xr as RemoveColByRangeCommand,
  ds as RemoveColCommand,
  Eo3 as RemoveColConfirmCommand,
  Me as RemoveColMutation,
  Yr as RemoveDefinedNameCommand,
  oo2 as RemoveDefinedNameMutation,
  fa as RemoveFeatureCalculationMutation,
  ye3 as RemoveMergeUndoMutationFactory,
  li as RemoveNumfmtMutation,
  ma2 as RemoveOtherFormulaMutation,
  fd as RemoveRangeThemeMutation,
  Ar2 as RemoveRowByRangeCommand,
  cs as RemoveRowCommand,
  Mo2 as RemoveRowConfirmCommand,
  Te2 as RemoveRowMutation,
  Xs2 as RemoveSheetCommand,
  Sa2 as RemoveSheetConfirmCommand,
  Ht2 as RemoveSheetMutation,
  al as RemoveSheetUndoMutationFactory,
  tl as RemoveSuperTableMutation,
  pc as RemoveWorksheetMergeCommand,
  se2 as RemoveWorksheetMergeMutation,
  Ta2 as RenameSheetOperation,
  I7 as RenderComponent,
  P4 as RenderManagerService,
  of as RenderSheetContent,
  R0 as RenderSheetFooter,
  I0 as RenderSheetHeader,
  z0 as RenderUnit,
  ys as ReorderRangeCommand,
  On2 as ReorderRangeMutation,
  La as ReorderRangeUndoMutationFactory,
  qd as ReplaceContentCommand,
  wa as ReplaceSelectionCommand,
  _a as ReplaceSnapshotCommand,
  Jd as ReplaceTextRunsCommand,
  jc as ResetBackgroundColorCommand,
  Un2 as ResetInlineFormatTextBackgroundColorCommand,
  qd2 as ResetRangeTextColorCommand,
  Zy as ResetScrollCommand,
  Fc as ResetTextColorCommand,
  Ee as ResponseHeader,
  Je2 as RetryInterceptorFactory,
  ao2 as Ribbon,
  fe2 as RibbonDataGroup,
  A32 as RibbonFormulasGroup,
  De2 as RibbonInsertGroup,
  Zn as RibbonOthersGroup,
  w1 as RibbonPosition,
  G1 as RibbonStartGroup,
  Te as RibbonViewGroup,
  WB as RichText,
  M4 as RichTextEditingMutation,
  Jf as RichTextEditor,
  tb as RollingAverage,
  jx as RowHeaderLayout,
  ng as SCOPE_WORKBOOK_VALUE_DEFINED_NAME,
  Eh as SELECTIONS_ENABLED,
  Ih2 as SELECTION_CONTROL_BORDER_BUFFER_COLOR,
  wh as SELECTION_CONTROL_BORDER_BUFFER_WIDTH,
  gm as SELECTION_SHAPE_DEPTH,
  ny as SHAPE_OBJECT_ARRAY,
  f7 as SHAPE_TYPE,
  se3 as SHEETS_NUMFMT_PLUGIN_CONFIG_KEY,
  ub as SHEET_EXTENSION_PREFIX,
  lb as SHEET_EXTENSION_TYPE,
  Qy as SHEET_UI_PLUGIN_NAME,
  k2 as SHEET_VIEWPORT_KEY,
  Ye4 as SHEET_VIEW_KEY,
  Xx as SLIDE_NAVIGATION_KEY,
  xE as Scene,
  CB as SceneCanvas,
  Yx as SceneViewer,
  D8 as ScrollBar,
  mn2 as ScrollCommand,
  y0 as ScrollTimer,
  bE as ScrollTimerType,
  Hm as ScrollToCellCommand,
  Cd as ScrollToCellOperation,
  $d2 as ScrollToRangeOperation,
  Ps2 as SearchFunctionOperation,
  Ra as SelectAllCommand,
  gt2 as SelectEditorFormulaOperation,
  ju as SelectRangeCommand,
  Wd2 as SelectionControl,
  we3 as SelectionMoveType,
  Wd2 as SelectionShape,
  xC as SelectionShapeExtension,
  Jd2 as SetActivateCellEditOperation,
  ws as SetArrayFormulaDataMutation,
  Bc as SetBackgroundColorCommand,
  jh as SetBoldCommand,
  kc2 as SetBorderBasicCommand,
  Uc as SetBorderColorCommand,
  vn as SetBorderCommand,
  bc2 as SetBorderPositionCommand,
  Ec as SetBorderStyleCommand,
  wi2 as SetCellEditVisibleArrowOperation,
  tt3 as SetCellEditVisibleOperation,
  Ea as SetCellEditVisibleWithF2Operation,
  Tc as SetColDataCommand,
  Gt as SetColDataMutation,
  Fa as SetColDataMutationFactory,
  bs2 as SetColHiddenCommand,
  on2 as SetColHiddenMutation,
  rn as SetColVisibleMutation,
  Bn as SetColWidthCommand,
  _a2 as SetColumnFrozenCommand,
  sa as SetColumnHeaderHeightCommand,
  je3 as SetCurrencyCommand,
  Qr as SetDefinedNameCommand,
  ca2 as SetDefinedNameMutation,
  Jb as SetDefinedNameMutationFactory,
  Xn3 as SetDocZoomRatioCommand,
  tt2 as SetDocZoomRatioOperation,
  la as SetFeatureCalculationMutation,
  qh as SetFontFamilyCommand,
  Yh as SetFontSizeCommand,
  Ca3 as SetFormatPainterOperation,
  _n as SetFormulaCalculationNotificationMutation,
  lo as SetFormulaCalculationResultMutation,
  uo as SetFormulaCalculationStartMutation,
  co as SetFormulaCalculationStopMutation,
  fo as SetFormulaDataMutation,
  Oc as SetFrozenCommand,
  st2 as SetFrozenMutation,
  ei as SetFrozenMutationFactory,
  Ac as SetGridlinesColorCommand,
  Kt2 as SetGridlinesColorMutation,
  Gc2 as SetHorizontalTextAlignCommand,
  Qd as SetInfiniteFormatPainterCommand,
  Lt2 as SetInlineFormatBoldCommand,
  yt2 as SetInlineFormatCommand,
  en2 as SetInlineFormatFontFamilyCommand,
  ct2 as SetInlineFormatFontSizeCommand,
  Qt4 as SetInlineFormatItalicCommand,
  Ft3 as SetInlineFormatStrikethroughCommand,
  bt2 as SetInlineFormatSubscriptCommand,
  Ht3 as SetInlineFormatSuperscriptCommand,
  Et2 as SetInlineFormatTextBackgroundColorCommand,
  mt2 as SetInlineFormatTextColorCommand,
  Ut as SetInlineFormatUnderlineCommand,
  zh as SetItalicCommand,
  O2 as SetNumfmtCommand,
  to2 as SetNumfmtMutation,
  rs3 as SetOnceFormatPainterCommand,
  ha2 as SetOtherFormulaMutation,
  Jh as SetOverlineCommand,
  Xe5 as SetParagraphNamedStyleCommand,
  Le3 as SetPercentCommand,
  xc as SetProtectionCommand,
  Bi2 as SetRangeBoldCommand,
  ha4 as SetRangeFontFamilyCommand,
  ua2 as SetRangeFontSizeCommand,
  Fi2 as SetRangeItalicCommand,
  li2 as SetRangeProtectionFromContextMenuCommand,
  fe3 as SetRangeProtectionMutation,
  Xi2 as SetRangeStrickThroughCommand,
  Mm as SetRangeSubscriptCommand,
  Em as SetRangeSuperscriptCommand,
  Io3 as SetRangeTextColorCommand,
  Rd as SetRangeThemeMutation,
  Ui2 as SetRangeUnderlineCommand,
  Sn2 as SetRangeValuesCommand,
  ee2 as SetRangeValuesMutation,
  Ae as SetRangeValuesUndoMutationFactory,
  $c as SetRowDataCommand,
  Jt as SetRowDataMutation,
  eu as SetRowDataMutationFactory,
  ba3 as SetRowFrozenCommand,
  oa as SetRowHeaderWidthCommand,
  Gn2 as SetRowHeightCommand,
  Es as SetRowHiddenCommand,
  Pt as SetRowHiddenMutation,
  Tt as SetRowVisibleMutation,
  gn2 as SetScrollOperation,
  To as SetScrollRelativeCommand,
  Xr as SetSelectedColsVisibleCommand,
  ti as SetSelectedRowsVisibleCommand,
  $n as SetSelectionFrozenCommand,
  ie3 as SetSelectionsOperation,
  mn as SetSpecificColsVisibleCommand,
  fn2 as SetSpecificRowsVisibleCommand,
  Kh as SetStrikeThroughCommand,
  Ce as SetStyleCommand,
  el as SetSuperTableMutation,
  ho as SetSuperTableOptionMutation,
  Yc as SetTabColorCommand,
  kn2 as SetTabColorMutation,
  Hc2 as SetTextColorCommand,
  Jc as SetTextRotationCommand,
  k as SetTextSelectionsOperation,
  Kc as SetTextWrapCommand,
  Gh as SetUnderlineCommand,
  zc2 as SetVerticalTextAlignCommand,
  oi as SetWorkbookNameCommand,
  si as SetWorkbookNameMutation,
  ri as SetWorksheetActivateCommand,
  pn2 as SetWorksheetActiveOperation,
  is2 as SetWorksheetColAutoWidthCommand,
  mt as SetWorksheetColWidthMutation,
  qo as SetWorksheetColWidthMutationFactory,
  Zc as SetWorksheetColumnCountCommand,
  qt as SetWorksheetColumnCountMutation,
  su as SetWorksheetColumnCountUndoMutationFactory,
  Qc as SetWorksheetDefaultStyleCommand,
  Yt2 as SetWorksheetDefaultStyleMutation,
  ou as SetWorksheetDefaultStyleMutationFactory,
  ed as SetWorksheetHideCommand,
  wt as SetWorksheetHideMutation,
  Qs2 as SetWorksheetNameCommand,
  jn2 as SetWorksheetNameMutation,
  ai as SetWorksheetOrderCommand,
  Tn as SetWorksheetOrderMutation,
  sd as SetWorksheetPermissionPointsCommand,
  Js2 as SetWorksheetPermissionPointsMutation,
  od as SetWorksheetProtectionCommand,
  Et as SetWorksheetProtectionMutation,
  uc as SetWorksheetRangeThemeStyleCommand,
  nn as SetWorksheetRangeThemeStyleMutation,
  Oa2 as SetWorksheetRangeThemeStyleMutationFactory,
  Xh as SetWorksheetRightToLeftCommand,
  ps as SetWorksheetRightToLeftMutation,
  Xo as SetWorksheetRowAutoHeightMutation,
  gh as SetWorksheetRowAutoHeightMutationFactory,
  id as SetWorksheetRowCountCommand,
  Xt as SetWorksheetRowCountMutation,
  ru as SetWorksheetRowCountUndoMutationFactory,
  nt2 as SetWorksheetRowHeightMutation,
  eo as SetWorksheetRowIsAutoHeightCommand,
  Fe3 as SetWorksheetRowIsAutoHeightMutation,
  ui2 as SetWorksheetShowCommand,
  ss2 as SetZoomRatioCommand,
  Jt3 as SetZoomRatioOperation,
  x3 as Shape,
  ie2 as SharedController,
  m0 as SheetBar,
  yi3 as SheetCanvasPopManagerService,
  Hl as SheetCellDropdownManagerService,
  Ao2 as SheetCellEditorResizeService,
  rl2 as SheetClipboardService,
  N7 as SheetColumnHeaderExtensionRegistry,
  $7 as SheetComponent,
  un3 as SheetCopyCommand,
  Yd as SheetCutCommand,
  C3 as SheetExtension,
  G as SheetInterceptorService,
  wb as SheetMenuPosition,
  vn2 as SheetOnlyPasteFormulaCommand,
  fo3 as SheetPasteBesidesBorderCommand,
  ri2 as SheetPasteColWidthCommand,
  hn2 as SheetPasteCommand,
  mo as SheetPasteFormatCommand,
  Xc as SheetPasteShortKeyCommand,
  Qi as SheetPasteShortKeyCommandName,
  go as SheetPasteValueCommand,
  qn as SheetPermissionCheckController,
  Ii as SheetPermissionCheckUIController,
  $t as SheetPermissionInitController,
  Nm as SheetPermissionOpenDialogOperation,
  Hn2 as SheetPermissionOpenPanelOperation,
  rd2 as SheetPermissionRenderManagerService,
  Vr as SheetPermissionUserManagerService,
  Ap2 as SheetPrintInterceptorService,
  ve2 as SheetRangeThemeModel,
  Ts as SheetRangeThemeService,
  fl as SheetRenderController,
  hl as SheetRowFilteredService,
  P7 as SheetRowHeaderExtensionRegistry,
  Et3 as SheetScrollManagerService,
  id3 as SheetSelectionRenderService,
  iu as SheetSkeletonChangeType,
  ue2 as SheetSkeletonManagerService,
  rt2 as SheetSkeletonService,
  pl as SheetUIController,
  au as SheetValueChangeType,
  Jn2 as SheetsFreezeSyncController,
  D3 as SheetsNumfmtCellContentController,
  ir3 as SheetsRenderService,
  Ci as SheetsScrollRenderController,
  z as SheetsSelectionsService,
  v_ as SheetsUIMenuSchema,
  Wm2 as SheetsUIPart,
  le3 as ShortcutPanelController,
  G32 as ShortcutPanelService,
  ze3 as ShortcutService,
  sb as ShowGridlinesState,
  Ia as ShowMenuListCommand,
  nr as Sidebar,
  eu2 as SidebarDefinedNameOperation,
  no as SingleCanvasPopup,
  or2 as SingleUnitUIController,
  Nv as SkeletonType,
  ZB as Slide,
  Fi as Slider,
  Cu as SplitDelimiterEnum,
  ad as SplitTextToColumnsCommand,
  YB as Spreadsheet,
  EB as SpreadsheetColumnHeader,
  q3 as SpreadsheetExtensionRegistry,
  U7 as SpreadsheetHeader,
  $B as SpreadsheetRowHeader,
  Z5 as SpreadsheetSkeleton,
  Er2 as StatusBarController,
  nf as StatusBarService,
  j as StringValueObject,
  Be3 as SubtractDecimalCommand,
  Dn as SuffixNodeFactory,
  Nb as SuperTableService,
  ko as SwitchDocModeCommand,
  iy as TEXT_OBJECT_ARRAY,
  mr2 as TEXT_RANGE_LAYER_INDEX,
  x1 as TRANSFORM_CHANGE_OBSERVABLE_TYPE,
  Zt2 as TabCommand,
  t7 as TestConfirmService,
  Z4 as Text,
  Xt2 as TextRange,
  a32 as ThemeSwitcherService,
  Ke as ThresholdInterceptorFactory,
  ud as ToggleCellCheckboxCommand,
  Pa as ToggleCheckListCommand,
  ld2 as ToggleGridlinesCommand,
  Zt as ToggleGridlinesMutation,
  s3 as ToggleShortcutPanelOperation,
  ro as ToolbarButton,
  Oe2 as ToolbarItem,
  B1 as Transform,
  xe as TriggerCalculationController,
  E5 as UIMenu,
  B5 as UIMenuSchema,
  Yn as UIPartsService,
  _e3 as UI_PLUGIN_CONFIG_KEY,
  ga3 as UNIVER_SHEET_PERMISSION_USER_PART,
  Li as UNIVER_UI_PLUGIN_NAME,
  KB as UNIVER_WATERMARK_LAYER_INDEX,
  VB as UNIVER_WATERMARK_STORAGE_KEY,
  Ji as UNI_DISABLE_CHANGING_FOCUS_KEY,
  X5 as UndoShortcutItem,
  Ln as UnionNodeFactory,
  _ as UnitAction,
  x4 as UnitObject,
  q6 as UniverDocsPlugin,
  wr2 as UniverDocsUIPlugin,
  Wi as UniverFormulaEnginePlugin,
  F3 as UniverMobileUIPlugin,
  V3 as UniverNetworkPlugin,
  rb as UniverPrintingContext,
  N as UniverRPCMainThreadPlugin,
  x as UniverRPCWorkerThreadPlugin,
  rt3 as UniverRemoteSheetsFormulaPlugin,
  o7 as UniverRenderEnginePlugin,
  ab as UniverRenderingContext,
  O7 as UniverRenderingContext2D,
  rr5 as UniverSheetsCorePreset,
  ot3 as UniverSheetsFormulaPlugin,
  Bt as UniverSheetsFormulaUIPlugin,
  Vl as UniverSheetsMobileUIPlugin,
  A as UniverSheetsNumfmtPlugin,
  ee3 as UniverSheetsNumfmtUIPlugin,
  ss as UniverSheetsPlugin,
  Nl as UniverSheetsUIPlugin,
  k3 as UniverUIPlugin,
  cd as UnregisterWorksheetRangeThemeStyleCommand,
  Ys as UnregisterWorksheetRangeThemeStyleMutation,
  Ca2 as UpdateCommand,
  ze5 as UpdateDefinedNameController,
  Ze as UpdateFormulaController,
  fs2 as VALIDATE_CELL,
  J1 as VERTICAL_ROTATE_ANGLE,
  We4 as VIEWPORT_KEY,
  Io as ValueNodeFactory,
  Mt as ValueObjectFactory,
  U as Vector2,
  oi2 as ViewSheetPermissionFromContextMenuCommand,
  pa3 as ViewSheetPermissionFromSheetBarCommand,
  Tu as ViewStateEnum,
  tA as Viewport,
  XB as WatermarkLayer,
  Ye as WebSocketService,
  q as WebWorkerRemoteInstanceService,
  WithDependency,
  nr2 as WorkbookCommentPermission,
  sr3 as WorkbookCopyPermission,
  Gu as WorkbookCopySheetPermission,
  or3 as WorkbookCreateProtectPermission,
  rr3 as WorkbookCreateSheetPermission,
  Ku as WorkbookDeleteColumnPermission,
  Ju as WorkbookDeleteRowPermission,
  ir2 as WorkbookDeleteSheetPermission,
  ar2 as WorkbookDuplicatePermission,
  Pe2 as WorkbookEditablePermission,
  ur2 as WorkbookExportPermission,
  Fs as WorkbookHideSheetPermission,
  qu2 as WorkbookHistoryPermission,
  Yu as WorkbookInsertColumnPermission,
  Xu as WorkbookInsertRowPermission,
  Bs as WorkbookManageCollaboratorPermission,
  js as WorkbookMoveSheetPermission,
  dn as WorkbookPermissionService,
  lr2 as WorkbookPrintPermission,
  cr3 as WorkbookRecoverHistoryPermission,
  zs2 as WorkbookRenameSheetPermission,
  Ou as WorkbookSelectionModel,
  dr2 as WorkbookSharePermission,
  gr as WorkbookViewHistoryPermission,
  hr as WorkbookViewPermission,
  mr as WorksheetCopyPermission,
  fr as WorksheetDeleteColumnPermission,
  Rr as WorksheetDeleteProtectionPermission,
  Cr2 as WorksheetDeleteRowPermission,
  pr2 as WorksheetEditExtraObjectPermission,
  Ve3 as WorksheetEditPermission,
  Sr2 as WorksheetFilterPermission,
  wr as WorksheetInsertColumnPermission,
  Ir as WorksheetInsertHyperlinkPermission,
  vr4 as WorksheetInsertRowPermission,
  Mr as WorksheetManageCollaboratorPermission,
  Vn as WorksheetPermissionService,
  _r2 as WorksheetPivotTablePermission,
  In as WorksheetProtectionPointModel,
  lt2 as WorksheetProtectionRuleModel,
  Ph as WorksheetSelectProtectedCellsPermission,
  Nh as WorksheetSelectUnProtectedCellsPermission,
  yr as WorksheetSetCellStylePermission,
  An as WorksheetSetCellValuePermission,
  Qt3 as WorksheetSetColumnStylePermission,
  en as WorksheetSetRowStylePermission,
  br2 as WorksheetSortPermission,
  ls as WorksheetViewPermission,
  D as XHRHTTPImplementation,
  Pe as ZIndexManager,
  Yn2 as ZebraCrossingCacheController,
  rr2 as ZenZone,
  Yf2 as addCustomDecorationBySelectionFactory,
  ld3 as addCustomDecorationFactory,
  Ge2 as addCustomRangeBySelectionFactory,
  Xe3 as addCustomRangeFactory,
  Hh2 as addMergeCellsUtil,
  Al as adjustRangeOnMutation,
  us as alignToMergedCellsBorders,
  Ks2 as attachPrimaryWithCoord,
  bo as attachRangeWithCoord,
  Wt2 as attachSelectionWithCoord,
  St2 as baseProtectionActions,
  nr3 as calcDocRangePositions,
  $02 as calculateDocSkeletonRects,
  kr2 as calculateFormula,
  v2 as calculateRectRotate,
  Cv as cancelRequestFrame,
  io as checkCellValueType,
  gl as checkInHeaderRanges,
  og as checkRangesEditablePermission,
  gB as checkStyle,
  Pv as clampRange,
  zB as clearLineByBorderType,
  F as compareToken,
  connectDependencies,
  connectInjector,
  Wd as convertBodyToHtml,
  t2 as convertPositionCellToSheetOverGrid,
  e22 as convertPositionSheetOverGridToAbsolute,
  Jo2 as convertPositionsToRectRanges,
  Ru as convertPrimaryWithCoordToPrimary,
  vh2 as convertSelectionDataToRange,
  A3 as convertTextRotation,
  PB as convertTransformToOffsetX,
  NB as convertTransformToOffsetY,
  Ic as convertUnitDataToRuntime,
  pt as copyRangeStyles,
  _7 as createCanvasElement,
  qT as createImageElement,
  mu as createTopMatrixFromMatrix,
  gu as createTopMatrixFromRanges,
  re3 as currencySymbols,
  Zl as defaultWorkbookPermissionPoints,
  Cs as defaultWorksheetPermissionPoint,
  Q1 as degToRad,
  Kf as deleteCustomDecorationFactory,
  ze4 as deleteCustomRangeFactory,
  pt3 as deriveStateFromActiveSheet$,
  Wh as deserializeRangeForR1C1,
  Dr as deserializeRangeWithSheet,
  Cr as deserializeRangeWithSheetWithCache,
  Cr3 as discreteRangeToRange,
  Xf as docDrawingPositionToTransform,
  Gv as drawDiagonalineByBorderType,
  X2 as drawLineByBorderType,
  hB as expandRangeIfIntersects,
  ph as expandToContinuousRange,
  ry as extractFormulaError,
  Qh as factoryRemoveNumfmtUndoMutation,
  Zh2 as factorySetNumfmtUndoMutation,
  Zo as findAllRectangle,
  Mh as findFirstNonEmptyCell,
  Z as fixLineWidthByScale,
  ut2 as followSelectionOperation,
  Y as fromModule,
  Zh as functionArray,
  Lm as functionCompatibility,
  Pm as functionCube,
  Wm as functionDatabase,
  Lg as functionDate,
  Ua as functionDisplayNames,
  U1 as functionEngineering,
  F0 as functionFinancial,
  ld as functionInformation,
  Dd as functionLogical,
  hC as functionLookup,
  I_ as functionMath,
  Q_ as functionMeta,
  dE as functionStatistical,
  Rb as functionText,
  pb2 as functionUniver,
  Mb as functionWeb,
  Sr4 as genNormalSelectionStyle,
  AC as genSelectionByRange,
  ma3 as genTableSource,
  Vi as generateAstNode,
  Oi as generateExecuteAstNodeData,
  er2 as generateNullCell,
  Eu as generateNullCellValue,
  pa2 as generateParagraphs,
  cr as generateRandomDependencyTreeId,
  Fv as generateRandomKey,
  ci as generateStringWithSequence,
  Zb as getAbsoluteRefTypeWitString,
  on as getAbsoluteRefTypeWithSingleString,
  zr as getAddMergeMutationRangeByType,
  Ee2 as getAllRangePermissionPoint,
  fm as getAllSelection,
  cn as getAllWorkbookPermissionPoint,
  be3 as getAllWorksheetPermissionPoint,
  He as getAllWorksheetPermissionPointByPointPanel,
  Jn3 as getAnchorBounding,
  zy as getAutoFillRepeatRange,
  AA as getCanvasOffsetByEngine,
  Uh as getCellAtRowCol,
  iB as getCellByIndexWithMergeInfo,
  Ov as getCellPositionByIndex,
  ww as getCellRealRange,
  l0 as getCharSpaceApply,
  M2 as getColor,
  Ke3 as getCommandSkeleton,
  lh as getCoordByCell,
  Vn2 as getCoordByOffset,
  Pe4 as getCurrencyFormat,
  it as getCurrencyFormatOptions,
  at2 as getCurrencyOptions,
  Y4 as getCurrencySymbolByLocale,
  xe2 as getCurrencySymbolIconByLocale,
  ot4 as getCurrencyType,
  ob2 as getCurrentExclusiveRangeInterest$,
  he as getCurrentRangeDisable$,
  Be as getCurrentScrollXY,
  IE as getCurrentTypeOfRenderer,
  $r as getCursorWhenDelete,
  bd as getCustomBlockIdsInSelections,
  Jy as getCustomRangePosition,
  Md as getCutActionsFromDocRanges,
  E0 as getDPI,
  ct3 as getDateFormatOptions,
  P5 as getDecimalFromPattern,
  q7 as getDecimalString,
  Fh as getDefaultRangePermission,
  B7 as getDevicePixelRatio,
  cd2 as getDocObject,
  Gf as getDocObjectById,
  re as getDocsSkeletonPageSize,
  $y as getEditingCustomRangePosition,
  Dd2 as getEditorObject,
  Kr2 as getEmptyTableCell,
  qr2 as getEmptyTableRow,
  g3 as getFontStyleString,
  Xv as getGroupState,
  Pi as getHeaderFooterMenuHiddenObservable,
  Er as getInsertRangeMutations,
  IB as getLastColumn,
  Yy as getLastLine,
  Es2 as getLineBounding,
  qv as getLineOffset,
  R7 as getLineWidth,
  Wv as getLineWith,
  N1 as getMatrixPlainText,
  Bi as getMenuHiddenObservable,
  Vs as getMoveRangeUndoRedoMutations,
  rg as getNextPrimaryCell,
  lt4 as getNumberFormatOptions,
  M3 as getNumberUnitValue,
  ay as getObjectValue,
  zi2 as getObservableWithExclusiveRange$,
  wB as getOffsetRectForDom,
  fi2 as getOneTextSelectionRange,
  dz as getPageFromPath,
  $v as getParagraphByGlyph,
  He2 as getPatternPreview,
  Ge4 as getPatternPreviewIgnoreGeneral,
  st3 as getPatternType,
  F6 as getPointerPrefix,
  _e4 as getPrimaryForRange,
  zb as getRangeWithRefsString,
  Ur2 as getRemoveRangeMutations,
  Yy2 as getRepeatRange,
  Ae2 as getRichTextEditPath,
  M7 as getRotateOffsetAndFarthestHypotenuse,
  Yv as getRotateOrientation,
  E7 as getScale,
  Bu as getSelectionsService,
  $h as getSeparateEffectedRangesOnCommand,
  P as getSheetCommandTarget,
  Ko as getSheetCommandTargetWorkbook,
  Qe3 as getSheetMutationTarget,
  en3 as getSheetObject,
  Lv as getSizeForDom,
  Ch as getSkeletonChangedEffectedRange,
  kB as getSystemHighlightColor,
  Xr2 as getTableColumn,
  OB as getTableIdAndSliceIndex,
  Bd as getTopLeftSelectionOfCurrSheet,
  Os2 as getTransformCoord,
  _B as getTranslateInSpreadContextWithPixelRatio,
  Rh as getValueChangedEffectedRange,
  j3 as getValueType,
  as as getVisibleRanges,
  LB as glyphIterator,
  c7 as handelExcelToJson,
  l7 as handelTableToJson,
  Dt as handleBaseInsertRange,
  Wn2 as handleBaseMoveRowsCols,
  Ot as handleBaseRemoveRange,
  Co as handleCommonDefaultRangeChangeWithEffectRefCommands,
  xh as handleCommonRangeChangeWithEffectRefCommandsSkipNoInterests,
  Ro as handleDefaultRangeChangeWithEffectRefCommands,
  Ah as handleDefaultRangeChangeWithEffectRefCommandsSkipNoInterests,
  Ul as handleDeleteRangeMoveLeft,
  Tl as handleDeleteRangeMoveUp,
  Dh as handleDeleteRangeMutation,
  dr as handleDomToJson,
  Br as handleIRemoveCol,
  Sl as handleIRemoveRow,
  Ml as handleInsertCol,
  _l as handleInsertRangeMoveDown,
  bl as handleInsertRangeMoveRight,
  Oh as handleInsertRangeMutation,
  vl as handleInsertRow,
  Fr as handleMoveCols,
  Cl as handleMoveRange,
  Hr as handleMoveRows,
  ty as handleNumfmtInCell,
  s72 as handlePlainToJson,
  ua as handleRefStringInfo,
  dt as handleStringToStyle,
  o72 as handleTableColgroup,
  a7 as handleTableMergeData,
  i7 as handleTableRowGroup,
  ZT as hasAllLatin,
  j7 as hasArabic,
  JT as hasBasicLatin,
  x0 as hasCJK,
  T6 as hasCJKPunctuation,
  r0 as hasCJKText,
  eB as hasLatinExtendedA,
  tB as hasLatinExtendedB,
  QT as hasLatinOneSupplement,
  mB as hasListGlyph,
  qf as hasParagraphInTable,
  Rv as hasSpace,
  w7 as hasTibetan,
  oB as hasUnMergedCellInRow,
  e7 as imageMimeTypeSet,
  S7 as inViewRanges,
  Vc as includeFormulaLexerToken,
  fi as initSheetFormulaData,
  dB as injectStyle,
  XT as isArray,
  C7 as isCjkCenterAlignedPunctuation,
  G4 as isCjkLeftAlignedPunctuation,
  q4 as isCjkRightAlignedPunctuation,
  WT as isDate,
  Ky as isEmbeddingFormulaEditor,
  vB as isFirstGlyph,
  an as isFormulaLexerToken,
  H4 as isFunction,
  bc as isInDirtyRange,
  Fa2 as isInSameTableCell,
  pB as isIndentByGlyph,
  fB as isLastGlyph,
  VT as isNumber,
  KT as isObject,
  rt4 as isPatternHasDecimal,
  bB as isPlaceholderOrSpace,
  U0 as isRangeSelector,
  uB as isRectIntersect,
  so as isReferenceString,
  un as isReferenceStringWithEffectiveColumn,
  Wc as isReferenceStrings,
  YT as isRegExp,
  yB as isSameLine,
  Th2 as isSingleCellSelection,
  S6 as isString,
  nA as isValidRectRange,
  d0 as lineIterator,
  w as localeCurrencySymbolMap,
  Xb as matchRefDrawToken,
  K3 as matchToken,
  lB as mergeInfoOffset,
  a5 as mergeMenuConfigs,
  rh as mergeSetRangeValues,
  Ds as needsQuoting,
  pt2 as neoGetDocObject,
  Kb as normalizeSheetName,
  X3 as operatorToken,
  G6 as parseDataStreamToTree,
  cB as pixelToPt,
  de as precisionTo,
  sB as ptToMM,
  c3 as ptToPixel,
  aB as ptToPx,
  nB as pxToInch,
  T3 as pxToNum,
  rB as pxToPt,
  Ls2 as quoteSheetName,
  D7 as radToDeg,
  Qo as rangeMerge,
  ku as rangeToDiscreteRange,
  Wx as renderImageWatermark,
  qx as renderTextWatermark,
  Gx as renderUserInfoWatermark,
  Hx as renderWatermark,
  Fe2 as replaceSelectionFactory,
  a0 as requestNewFrame,
  Oe3 as rotateRange,
  At as runRefRangeMutations,
  $e as sequenceNodeType,
  Ft as serializeRange,
  Ss as serializeRangeToRefString,
  Hc as serializeRangeWithSheet,
  Gc as serializeRangeWithSpreadsheet,
  kh as setEndForRange,
  A7 as setLineType,
  F2 as setPatternDecimal,
  ib as sheetContentViewportKeys,
  ob as sheetHeaderViewportKeys,
  fs as singleReferenceToGrid,
  Mu as splitRangeText,
  yi2 as splitSpanText,
  h4 as startWithEmoji,
  yi as strip,
  ba as stripErrorMargin,
  So as supportClipboardAPI,
  Xi as t,
  O32 as textTrim,
  B as toModule,
  K2 as toPx,
  Us2 as transformCellsToRange,
  Vv as transformObjectOutOfGroup,
  Zf as transformToDocDrawingPosition,
  ui as unquoteSheetName,
  kr as useActiveWorkbook,
  Gy as useActiveWorksheet,
  Wi2 as useClickOutSide,
  M1 as useComponentsOfPart,
  p5 as useConfigValue,
  Yi as useDebounceFn,
  useDependency,
  re2 as useEvent,
  pR as useHighlightRange,
  useInjector,
  ef as useKeyEventConfig,
  Bf as useKeyboardEvent,
  useObservable,
  d5 as useObservableRef,
  Mf as useResize,
  g5 as useScrollYOverContainer,
  r7 as useSidebarClick,
  oo3 as useToolbarItemStatus,
  useUpdateBinder,
  zi as useUpdateEffect,
  Gi2 as useVirtualList,
  qy as useWorkbooks,
  wr3 as virtualizeDiscreteRanges,
  Se as whenDocAndEditorFocused,
  jy as whenFormulaEditorActivated,
  Ve4 as whenSheetEditorFocused,
  eA as withCurrentTypeOfRenderer
};
//# sourceMappingURL=@univerjs_presets_preset-sheets-core.js.map
