import {
  Cr,
  Ct,
  Dt,
  Ei,
  Es,
  Fs as Fs2,
  It as It3,
  J as J3,
  K,
  Nr,
  Nt as Nt2,
  Oi,
  Or,
  Ot,
  Pe as Pe3,
  Rr,
  Rt,
  Si,
  St,
  Tr,
  Tt as Tt2,
  Vs,
  Wt,
  _t as _t2,
  ae,
  be,
  bt as bt2,
  de as de2,
  di,
  ee as ee2,
  gr as gr3,
  gs,
  it,
  js as js2,
  le,
  me as me2,
  mi,
  ms,
  mt,
  nt as nt2,
  oe,
  re,
  st as st2,
  ue as ue2,
  ve,
  we as we3
} from "./chunk-R2GQM2IX.js";
import {
  at as at3
} from "./chunk-ST7J4VGM.js";
import {
  Tt as Tt3
} from "./chunk-Q5F7IOB3.js";
import {
  Ie
} from "./chunk-ZKTLMAEM.js";
import {
  He
} from "./chunk-3V44O7ZC.js";
import {
  Nn,
  Ut,
  V2,
  ve2
} from "./chunk-MJPQD5L4.js";
import {
  $t as $t2,
  Cd,
  Fm,
  Gm,
  Gr,
  Hm,
  Hr,
  Id,
  Ir,
  J as J2,
  Jt,
  Md,
  Pd,
  Pe as Pe2,
  Rd,
  Re,
  Rm,
  Tt,
  Ud,
  Xe,
  Ye as Ye2,
  Ym,
  at as at2,
  bd,
  ce,
  fd,
  fe as fe3,
  fm,
  gd,
  gr as gr2,
  hd,
  ie as ie3,
  jt,
  km,
  pd,
  pe,
  pm,
  pr,
  se,
  wd,
  xm,
  xt as xt2,
  zt
} from "./chunk-2TCKJKRG.js";
import "./chunk-6Q4G5S6Y.js";
import {
  de
} from "./chunk-P747PEZ4.js";
import {
  C,
  S,
  v
} from "./chunk-VAEXAE3K.js";
import {
  Pt,
  nt
} from "./chunk-ZTXDQJG2.js";
import {
  f
} from "./chunk-MO6OUX3Q.js";
import {
  R,
  fe as fe2
} from "./chunk-D7B6XFA6.js";
import {
  A
} from "./chunk-6335LBDU.js";
import {
  V,
  Ye,
  x,
  ze
} from "./chunk-AFUSFBAE.js";
import {
  xt as xt3
} from "./chunk-Y7AJ2W7V.js";
import {
  N2,
  a2,
  o2
} from "./chunk-O4VVQILI.js";
import {
  Bt,
  ot as ot2
} from "./chunk-RWMUFXJB.js";
import {
  B1 as B12,
  Bi,
  D1,
  G1,
  H1,
  Io,
  It as It2,
  Nl,
  No2 as No,
  Nt,
  S1,
  at,
  c1,
  connectInjector,
  ct,
  en2 as en,
  et as et2,
  he,
  ir,
  k3,
  ka,
  lh,
  ls,
  mr,
  tt2 as tt,
  u3,
  ue,
  useDependency,
  useObservable,
  we as we2,
  wr
} from "./chunk-DZMX4FYO.js";
import {
  $t,
  At,
  At2,
  Be2 as Be,
  Br,
  Cl,
  D,
  Dr,
  Fs,
  Hc,
  Ht2 as Ht,
  I1,
  It,
  Je,
  Je2,
  Le,
  M2,
  M4 as M,
  ME,
  Ml,
  N,
  O3,
  On2 as On,
  P,
  Pe,
  Sh,
  Sl,
  Sr,
  Tl,
  U,
  Ue,
  Ul,
  Ve as Ve2,
  W2 as W,
  Wi,
  Zo,
  _l,
  _n,
  _t,
  bl,
  cr2 as cr,
  ee2 as ee,
  fe2 as fe,
  ft,
  g,
  gr,
  hn,
  ie as ie2,
  js,
  k,
  k2,
  ke,
  li,
  m3 as m,
  me,
  ne,
  o7,
  ot,
  pn2 as pn,
  q5 as q,
  qe,
  ri,
  ss,
  st,
  to,
  uo,
  vl,
  wt,
  x1,
  x3,
  xt,
  z,
  zs2 as zs
} from "./chunk-I7I3GTAS.js";
import {
  $,
  $C,
  I,
  Rp,
  eE,
  ie,
  require_jsx_runtime,
  require_react,
  vr as vr2
} from "./chunk-YFGUMDM2.js";
import {
  B1,
  BehaviorSubject,
  El,
  En,
  Fn,
  GC,
  Gg,
  Gi,
  Inject,
  Injector,
  J,
  KC,
  Ls,
  Ms,
  Ns,
  Ol,
  Optional,
  Subject,
  TR,
  Ua,
  Ve,
  We,
  XR,
  ao,
  bt,
  combineLatest,
  createIdentifier,
  dE,
  debounceTime,
  distinctUntilChanged,
  eC,
  et,
  filter,
  fromEvent,
  h1,
  ic,
  jg,
  map,
  mapTo,
  merge,
  n1,
  nC,
  of,
  oo,
  pt,
  qR,
  sI,
  shareReplay,
  switchMap,
  takeUntil,
  throttleTime,
  vr,
  we,
  ws,
  yt,
  zc
} from "./chunk-RGZYGL3P.js";
import {
  __toESM
} from "./chunk-DC5AMYBS.js";

// node_modules/@univerjs-pro/collaboration-client-ui/lib/es/index.js
var import_jsx_runtime = __toESM(require_jsx_runtime());
var import_react = __toESM(require_react());
var _0x59d238 = _0x6a51;
(function(_0x347e9e, _0x26e18e) {
  const _0x56a38f = _0x6a51, _0x12ab5c = _0x347e9e();
  while (!![]) {
    try {
      const _0xbff4ac = parseInt(_0x56a38f(906)) / 1 * (-parseInt(_0x56a38f(681)) / 2) + parseInt(_0x56a38f(822)) / 3 + -parseInt(_0x56a38f(526)) / 4 * (parseInt(_0x56a38f(489)) / 5) + -parseInt(_0x56a38f(434)) / 6 + parseInt(_0x56a38f(695)) / 7 + parseInt(_0x56a38f(462)) / 8 + parseInt(_0x56a38f(700)) / 9;
      if (_0xbff4ac === _0x26e18e) break;
      else _0x12ab5c["push"](_0x12ab5c["shift"]());
    } catch (_0x173f8c) {
      _0x12ab5c["push"](_0x12ab5c["shift"]());
    }
  }
})(_0x3e21, 896482);
var Ft = Object[_0x59d238(830)];
var kt = (_0x12df93, _0x5259d2, _0x245c09) => _0x5259d2 in _0x12df93 ? Ft(_0x12df93, _0x5259d2, { "enumerable": true, "configurable": true, "writable": true, "value": _0x245c09 }) : _0x12df93[_0x5259d2] = _0x245c09;
var l = (_0x320552, _0x359b9a, _0x2af815) => kt(_0x320552, typeof _0x359b9a != _0x59d238(708) ? _0x359b9a + "" : _0x359b9a, _0x2af815);
function _0x3e21() {
  const _0x21ba94 = ["labelPosition", "univer-flex univer-items-center", "type", "RECT", "transformSelections", "CLOSE_ROOM", "RemoveRowCommandId", "fillRule", "_handleJoinEvent", "origin", "push", "_onRefRangeChange", "_scene", "getCellPositionByOffset", "_updateSubUnitFromURLParams", "redoState", "_injector", "UNIVER_COLLABORATION_CLIENT_WEB_PLUGIN", "SYNCED", "entries", "unit", "MUTATION", "_registerDependencies", "getParam", "setTimeout", "_dataLoaderService", "0 0 17 16", "m1Prime", "_httpService", "setUndoRedoMutationParamsCache", "clearInterval", "DeleteRangeMoveUpCommandId", "InsertColCommandId", "_online", "_unitStatus", "LICENSE_IMPORT_SIZE_EXCEEDED", "setAlpha", "createSocket", "_docSyncEditingCollabCursorService", "YUUMI_PROMPT_MAX_TOKENS_EXCEEDED", "session.collaboration-timeout", "_init", "FETCH_MISS", "saveOfflineData", "_config", "LICENSE_EXPORT_SIZE_EXCEEDED", "saveTaskMap", "EMAIL_VERIFY_CODE_NOT_FOUND_OR_EXPIRED", "restore", "_hideTimer", "stage", "name", "none", "subunit", "session.connection-failed", "skeleton", "CONNECTOR_DATA_TOO_LARGE", "tag", "_docStateChangeManagerService", "NO_OTHER_CLIENTS_EDITING", "permission.title", "blue.400", "_drawTextRange", "YUUMI_AI_RUN_FAILED", "createInstance", "/universer-api/license/formula/limit/start", "disposeWithMe", "_startSheetCollabCursor", "_themeService", "values", "M0 0H16V16H0z", "_checkAndWaitForCalculationPermission", "executionId", "onRendered", "MoveRangeCommandId", "Success", "makeDirty", "children", "application/json", "maxFormulaLimit", "send", "_setFormulaLimitStatus", "includes", "ENTITLE_UPDOWN_GRADE_NOT_SUPPORT", "next", "ONLINE", "_unitOnClients", "_backgroundColor", "column", "_univerInstanceService", "attrs", "FromArray", "_handleHover", "sessionStatus$", "_context", "show", "data", "removeParam", "_disabled", "_textBubble", "onPointerEnter$", "m2Prime", "pluginName", "whenReady", "MOBILE_VERIFY_CODE_MISMATCH", "url(#on-line-icon_clip0_910_349)", "_localeService", "Failed", "override", "transformMutationsWithChangeset", "CURRENT_STATUS_CANNOT_OPERATE", "_beforeCloseService", "Error", "_collabSessionService", "_showGuardMessage", "getOwnPropertyDescriptor", "storage", "collab-client.tooltip.reconnect", "mask", "min", "getUnitId", "isEditing", "code", "APPLY_REJECT", "_setupSubUnitSync", "_colorAssignService", "45740ocuVrM", "_onCursorDelete", "INVALID_INVITE_CODE", "defs", "releaseFormulaLimitUrl", "_docTransformStateCacheService", "INVALID_ARGUMENT", "_configService", "_refRangeService", "getTypeOfUnitAdded$", "getUndoRedoMutationParamsCache", "_initResize", "USER_NOT_FOUND", "getViewport", "11980647ncRWpl", "_collabCursorState$", "AWAITING", "_draw", "clipPath", "16560981ifYFQc", "now", "No unitID or type in URL. Will not load files from remote address.", "ENTITLE_REPORT_LIMIT_EXCEED", "cursorInfo", "http://www.w3.org/2000/svg", "PERMISSION_DENIED", "_setupBeforeClosingHandler", "symbol", "getUniverSheetInstance", "cursorInfo$", "map", "body", "currentColor", "_clearPolling", "_lastResponseTimestamp", "ENSURE_SNAPSHOT_EXECUTION", "endRow", "TOO_MANY_REQUESTS", "post", "getMember", "EMAIL_HAS_BEEN_BOUND", "eventID", "COMPLETION_FINISHED", "actions", "ENTITLE_CHAT_LIMIT_EXCEED", "_maxFormulaLimit", "set", "_transformHistoryAndStateStack", "max", "CONFLICT", "_getSessionTicket", "random", "setStateCache", "startRow", "currentUsage", "purple.300", "SUBMIT_CHANGESET_TIMEOUT", "getVpScrollXYInfoByPosToVp", "UPDATE_CURSOR", "from", "addObject", "_createSocketURL", "Unknown user", "uni.network.url-service", "LICENSE_MAX_UNITS_EXCEEDED", "YUUMI_SUBSCRIPTION_NOT_FOUND", "triggerDblclick", "UNDEFINED", "history", "_revisionService", "_color", "exhaustSavingTask", "OFFLINE", "_shapes", "NOT_FOUND", "focused$", "unload", "_startCalculationLimit", "_send", "collaboration-client-ui.config", "text", "_currentUsage", "_checkCalculationAvailable", "ENTITLE_INSUFFICIENT_QUOTA", "unshift", "SNAPSHOT_INVALID_SNAPSHOT", "xlink:href", "[RemoteUniscriptService]: no focused unit", "DeleteRangeMoveLeftCommandId", "_anchor", "loadOfflineData", "_commandService", "getUnhiddenWorksheets", "getActiveSheet", "_range", "registerBeforeClose", "_initStatusComponent", "_name", "has", "_transformPreviousActiveRange", "on-line-icon", "_notificationService", "InsertRangeMoveDownCommandId", "with", "fill", "color", "asObservable", "endColumn", "ALREADY_EXISTS", "_memberService", "session.will-retry", "complete", "MOBILE_VERIFY_CODE_NOT_FOUND_OR_EXPIRED", "roomMembers", "moveTo", "searchParams", "_docClipboardService", "REDEMPTION_INVALID_CODE", "path", "getStateCache", "_clearOtherTimers", "_instanceService", "_registerRenderDependencies", "UNRECOGNIZED", "red.300", "INTERNAL_ERROR", "stringify", "currentSkeleton$", "height", "_toggleOnline", "_docSkeletonManagerService", "getRenderById", "contains", "_getSaveTimeout", "REDEMPTION_USER_REDEEM_TIMES_EXCEED", "_taskIds", "permission.content", "_docTransformIMECacheService", "collabCursorState$", "transformStateCache", "Warning", "2458422iifuyW", "evenodd", "REDEMPTION_CODE_HAS_BEEN_CREATED", "getFocusedUnit", "range", "_initStatusListener", "_status$", "...", "defineProperty", "_hasFormulaInDirtyRanges", "displayName", "ENTITLE_NEED_BILLING_ADDRESS", "getSheetBySheetId", "univer-text-sm univer-leading-8 univer-text-gray-600 dark:!univer-text-gray-200", "_urlService", "LOGIN_TOKEN_PROCESSING_FAILED", "LICENSE_DISTRO_REJECTED", "editingUnit", "parse", "PAYMENT_CHANNEL_NOT_SUPPORT", "getAncestorScale", "getItem", "getUnitStatus$", "USER_IS_ANONYMOUS", "findNodePositionByCharIndex", "collab-text-range-", "off-line-icon", "delete", "START_CALCULATION", "toRgbString", "string", "YUUMI_ASYNCIO_CANCELLED", "_saveTaskMap", "limitInfo", "_docTransformSelectionsService", "_entityInit$", "onTransformChange$", "getMergeData", "_toggleOffline", "onPointerLeave$", "OffLineIcon", "InsertRowCommandId", "getDocRanges", "1em", "runId", "sheetId", "EMAIL_VERIFY_CODE_MISMATCH", "collabStatus.notCollab", "_drawRectRange", "No remote instance service injected. May not syncing edits to the web worker.", "saveImage", "event$", "parseInt", "collaboration.closeRoom", "_hovered", "LICENSE_MAX_MEMBERS_PER_UNIT_EXCEEDED", "YUUMI_URL_COL_OUT_OF_RANGE", "white", "_anchorDot", "functionsExecutedState", "_sheetSkeletonManagerService", "error", "green.600", "ERROR_AGAIN", "registerRefRange", "rgba(255, 255, 255, 0.01)", "resize", "[CollaborationDataLoaderController]", "REDEMPTION_USER_NOT_ELIGIBLE", "_messageService", "deepClone", "TEXT", "_updateLocalCursor", "memberID", "/run/", "startColumn", "_getFormulaLimitStatus", "_refreshCollabCursors", "measureText", "_imageIoService", "transformIMECache", "imageSourceType", "setItem", "_assignedColors", "46ZqNAJu", "registerRenderModule", "_syncEditingCollabCursorService", "_removeCollabCursors", "_initCommandInterceptor", "InsertRangeMoveRightCommandId", "undoState", "_initEntityListener", "status$", "USER_NOT_INVITED_CODE", "clearTimeout", "USERS_LEAVE", "_session", "APPLY_DUPLICATED", "enableLocalCache", "_cursors", "source", "_handleLeaveEvent", "drawWith", "find", "fillStyle", "_scheduleClearOtherTimer", "getCurrentRevOfUnit", "pipe", "REDEMPTION_CODE_FULLY_REDEEMED", "DATA_SOURCE_TOO_LARGE", "INVITE_CODE_HAS_BEEN_UES", "INVITE_CODE_REQUIRED", "idSuffix", "setParam", "APPLY_REVISION_CONFILICT", "setActiveRange", "_scheduleHeartbeat", "subscribe", "_entities", "length", "getCellMatrix", "_heartbeatTimer", "unsubscribe", "collaboration.single-unit.warning", "getColorFromTheme", "_hover", "_eventUnsubscribe", "LOGIN_FAILED", "getCollabEntity$", "fillText", "result", "hide", "SOCKET_FAILED", "split", "bold 13px Source Han Sans CN", "dispose", "replace", "_ensureSubject", "_initCommandExecutedListener", "getCollabCursors$", "top", "subscribeEvent", "disableLocalCache", "collabStatus.fetchMiss", "current", "_drawAnchor", "isActive", "getTypeOfUnitDisposed$", "/universer-api/license/formula/limit/done", "transformMutation", "RemoveColCommandId", "startsWith", "all", "_scheduleSaving", "YUUMI_UNABLE_LOAD_URL", "OnLineIcon", "mutations", "key", "_colorIndex", "UNIVER_DOC", "_cachedData", "unitId", "APPLY_PERMISSION_DENIED", "_updateCollabCursors", "_handleEvent", "REDEMPTION_CODE_INACTIVE", "syncEditingCollabCursor", "_releaseCalculationLimit", "_id", "ENTITLE_DUP_SUBSCRIPTION", "getRangePointData", "isArray", "onCommandExecuted", "params", "SNAPSHOT_HAS_BEEN_REMOVED", "_collabCursorController", "_startDocCollabCursor", "_initEvent", "jiqing.500", "_renderManagerService", "location", "SOCKET_FAILED_RETRY", "4844406HZHvop", "collab-rect-range-", "get", "colorChannel1", "bottom", "UniverIcon", "INVITE_CODE_ALREADY_BOUND", "executeCommand", "toString", "popstate", "UNAUTHENTICATED", "univer-mr-2 univer-flex univer-text-xl", "unitID", "dispose$", "_transformService", "_getScale", "forEach", "YUUMI_TABLE_NOT_FOUND_IN_UNIT", "url(#$1", "sessionTicket", "replaceState", "YUUMI_ALL_TABLES_IS_INVALID", "debug", "textRanges", "ACTIVE_UNIT_EVENT_CHANNEL", "add", "off-line-icon_clip0_910_343", "AWAITING_WITH_PENDING", "1080712qURqAB", "onLocalMutation", "urlChange$", "OTHER_CLIENT_EDITING", "newValue", "defIds", "getMemberID", "_document", "_updateURLWithCurrentState", "assignAColorForMemberID", "doc.mutation.rich-text-editing", "formula.calculation.unable", "setConfig", "CHANGESET_REVISION_CONFILICT", "_collaborationController", "addObjects", "_logService", "0 0 16 16", "collaboration-client.offline-data-not-saved", "_cursorInfo$", "font", "JOIN_ROOM_FAILED", "_lastPointer", "currentTheme$", "use", "black", "ticket", "6150hYtdkP", "_roomMembers$", "WECHAT_HAS_BEEN_BOUND", "REDEMPTION_CODE_NOT_STARTED", "assign", "on-line-icon_clip0_910_349", "_getSheetObject", "SUCCESS", "width", "_handleHeartbeatEvent", "YUUMI_CONNECTOR_URL_NOT_FOUND", "setShapeProps", "url(#off-line-icon_clip0_910_343)", "collabStatus.synced", "selection", "onStarting", "row", "href", "size", "#FFF", "getValue", "div", "_render", "getSheetId", "M4.5865 11.6499C3.36983 11.6499 1.6665 11.1024 1.6665 8.9124C1.6665 6.3574 4.2215 5.8099 4.9515 5.8099C5.3165 4.5324 6.0465 2.5249 8.9665 2.5249C11.5215 2.5249 12.6165 3.9849 12.9815 5.2624C12.9815 5.2624 16.2665 5.6274 16.2665 8.7299C16.2665 10.9199 14.8065 11.6499 13.3465 11.6499M6.7767 11.6497L8.9667 13.4747L11.8867 9.82466", "_localStorageService", "yellow.400", "then", "_docSkeleton", "transformRemoteChangeset", "init", "UNIVER_SHEET", "APPLY_NON_SEQUENTIAL_REVISION", "requireSession", "getCurrent", "_cursorShapes", "_labelPosition", "5692bNXfOa", "getformulaLimitStatusUrl", "collabStatus.conflict", "ENTITLE_CAN_NOT_BUY_LOWER_OTP", "_getMergeRange", "_cursor", "round", "OTHER_CLIENTS_EDITING", "roomMembers$", "lineTo", "NOT_COLLAB", "_removeClearOtherTimer", "_collaborationUIEventService", "_saveCache", "ranges", "MOBILE_HAS_BEEN_BOUND", "_pollingInterval", "_selfUnitIDs", "substring", "_initDependencies", "save", "_getAnchorBounding", "_applyCommand", "_onCursorUpdate", "onMouseMove", "backgroundColor", "entityInit$", "getConfig", "_transformUndoRedoStack"];
  _0x3e21 = function() {
    return _0x21ba94;
  };
  return _0x3e21();
}
function Ve3({ ref: _0x22d4c9, ..._0x3ad316 }) {
  const _0x3656d5 = _0x59d238, { icon: _0x304a0e, id: _0x416805, className: _0x1361d2, extend: _0x21d643, ..._0x3cc475 } = _0x3ad316, _0x35eeac = ("univerjs-icon univerjs-icon-" + _0x416805 + " " + (_0x1361d2 || ""))["trim"](), _0xc4c451 = (0, import_react.useRef)("_" + gi());
  return Ut2(_0x304a0e, "" + _0x416805, { "defIds": _0x304a0e[_0x3656d5(467)], "idSuffix": _0xc4c451[_0x3656d5(396)] }, { "ref": _0x22d4c9, "className": _0x35eeac, ..._0x3cc475 }, _0x21d643);
}
function Ut2(_0x272e95, _0x39a164, _0x39754c, _0x522c69, _0xce846f) {
  const _0x4ae7dd = _0x59d238;
  return (0, import_react.createElement)(_0x272e95[_0x4ae7dd(612)], { "key": _0x39a164, ...mi2(_0x272e95, _0x39754c, _0xce846f), ..._0x522c69 }, (fi(_0x272e95, _0x39754c)[_0x4ae7dd(632)] || [])[_0x4ae7dd(711)]((_0x524e1f, _0x31f17b) => Ut2(_0x524e1f, _0x39a164 + "-" + _0x272e95[_0x4ae7dd(612)] + "-" + _0x31f17b, _0x39754c, void 0, _0xce846f)));
}
function mi2(_0x347158, _0x15b497, _0x5c785d) {
  const _0x1d8b6b = _0x59d238, _0x3427bf = { ..._0x347158[_0x1d8b6b(645)] };
  _0x5c785d != null && _0x5c785d["colorChannel1"] && _0x3427bf[_0x1d8b6b(785)] === _0x1d8b6b(437) && (_0x3427bf[_0x1d8b6b(785)] = _0x5c785d[_0x1d8b6b(437)]), _0x347158[_0x1d8b6b(612)] === _0x1d8b6b(673) && _0x3427bf["id"] && (_0x3427bf["id"] = _0x3427bf["id"] + _0x15b497["idSuffix"]), Object[_0x1d8b6b(574)](_0x3427bf)[_0x1d8b6b(450)](([_0x2b5453, _0x2a90df]) => {
    const _0x4217f3 = _0x1d8b6b;
    _0x2b5453 === "mask" && typeof _0x2a90df == _0x4217f3(852) && (_0x3427bf[_0x2b5453] = _0x2a90df[_0x4217f3(388)](/url\(#(.*)\)/, _0x4217f3(452) + _0x15b497["idSuffix"] + ")"));
  });
  const { defIds: _0xe0fb15 } = _0x15b497;
  return !_0xe0fb15 || _0xe0fb15[_0x1d8b6b(371)] === 0 || (_0x347158[_0x1d8b6b(612)] === _0x1d8b6b(486) && _0x3427bf[_0x1d8b6b(767)] && (_0x3427bf["xlink:href"] = _0x3427bf[_0x1d8b6b(767)] + _0x15b497[_0x1d8b6b(364)]), Object[_0x1d8b6b(574)](_0x3427bf)[_0x1d8b6b(450)](([_0x2cf1df, _0x8a6e4b]) => {
    const _0x277774 = _0x1d8b6b;
    typeof _0x8a6e4b == _0x277774(852) && (_0x3427bf[_0x2cf1df] = _0x8a6e4b[_0x277774(388)](/url\(#(.*)\)/, _0x277774(452) + _0x15b497[_0x277774(364)] + ")"));
  })), _0x3427bf;
}
function fi(_0x551d0e, _0x1f8859) {
  const _0x1c6fc7 = _0x59d238;
  var _0x225e00;
  const { defIds: _0x22f297 } = _0x1f8859;
  return !_0x22f297 || _0x22f297[_0x1c6fc7(371)] === 0 ? _0x551d0e : _0x551d0e[_0x1c6fc7(612)] === "defs" && ((_0x225e00 = _0x551d0e[_0x1c6fc7(632)]) != null && _0x225e00[_0x1c6fc7(371)]) ? { ..._0x551d0e, "children": _0x551d0e["children"][_0x1c6fc7(711)]((_0x355b42) => typeof _0x355b42[_0x1c6fc7(645)]["id"] == _0x1c6fc7(852) && _0x22f297 && _0x22f297[_0x1c6fc7(637)](_0x355b42[_0x1c6fc7(645)]["id"]) ? { ..._0x355b42, "attrs": { ..._0x355b42[_0x1c6fc7(645)], "id": _0x355b42[_0x1c6fc7(645)]["id"] + _0x1f8859[_0x1c6fc7(364)] } } : _0x355b42) } : _0x551d0e;
}
function gi() {
  const _0x5c6e6d = _0x59d238;
  return Math[_0x5c6e6d(732)]()["toString"](36)[_0x5c6e6d(544)](2, 8);
}
Ve3[_0x59d238(832)] = _0x59d238(439);
var vi = { "tag": "svg", "attrs": { "xmlns": _0x59d238(705), "fill": "none", "viewBox": _0x59d238(479), "width": _0x59d238(865), "height": "1em" }, "children": [{ "tag": "g", "attrs": { "clipPath": _0x59d238(501) }, "children": [{ "tag": "path", "attrs": { "stroke": _0x59d238(713), "d": "M3.61971 11.6499C2.40304 11.6499 0.699707 11.1024 0.699707 8.9124C0.699707 6.3574 3.25471 5.8099 3.98471 5.8099C4.34971 4.5324 5.07971 2.5249 7.99971 2.5249C10.5547 2.5249 11.6497 3.9849 12.0147 5.2624C12.0147 5.2624 15.2997 5.6274 15.2997 8.7299C15.2997 10.9199 13.8397 11.6499 12.3797 11.6499M9.82471 9.82466L6.17471 13.4747M6.17471 9.82466L9.82471 13.4747", "strokeLinecap": _0x59d238(532), "strokeLinejoin": _0x59d238(532), "strokeWidth": 1.2 } }] }, { "tag": _0x59d238(684), "attrs": {}, "children": [{ "tag": "clipPath", "attrs": { "id": _0x59d238(460) }, "children": [{ "tag": _0x59d238(799), "attrs": { "fill": _0x59d238(879), "d": _0x59d238(625) } }] }] }], "defIds": [_0x59d238(460)] };
var Lt = (0, import_react.forwardRef)(function(_0x33511d, _0x1a5fe7) {
  const _0x229fe = _0x59d238;
  return (0, import_react.createElement)(Ve3, Object[_0x229fe(493)]({}, _0x33511d, { "id": _0x229fe(848), "ref": _0x1a5fe7, "icon": vi }));
});
Lt[_0x59d238(832)] = _0x59d238(862);
var Ei2 = { "tag": "svg", "attrs": { "xmlns": _0x59d238(705), "fill": _0x59d238(607), "viewBox": _0x59d238(581), "width": _0x59d238(865), "height": _0x59d238(865) }, "children": [{ "tag": "g", "attrs": { "clipPath": _0x59d238(660) }, "children": [{ "tag": _0x59d238(799), "attrs": { "stroke": _0x59d238(713), "d": _0x59d238(513), "strokeLinecap": _0x59d238(532), "strokeLinejoin": _0x59d238(532), "strokeWidth": 1.2 } }] }, { "tag": _0x59d238(684), "attrs": {}, "children": [{ "tag": _0x59d238(699), "attrs": { "id": _0x59d238(494) }, "children": [{ "tag": _0x59d238(799), "attrs": { "fill": _0x59d238(879), "d": _0x59d238(625), "transform": "translate(.97)" } }] }] }], "defIds": [_0x59d238(494)] };
var Mt = (0, import_react.forwardRef)(function(_0x31076e, _0x2f409b) {
  const _0x36f150 = _0x59d238;
  return (0, import_react.createElement)(Ve3, Object[_0x36f150(493)]({}, _0x31076e, { "id": _0x36f150(781), "ref": _0x2f409b, "icon": Ei2 }));
});
Mt[_0x59d238(832)] = _0x59d238(407);
function pi(_0x45f6e3) {
  const _0x24b770 = _0x59d238;
  switch (_0x45f6e3) {
    case Si[_0x24b770(753)]:
      return "collabStatus.offline";
    case Si[_0x24b770(730)]:
      return _0x24b770(528);
    case Si[_0x24b770(597)]:
      return _0x24b770(395);
    case Si["NOT_COLLAB"]:
      return _0x24b770(869);
    case Si[_0x24b770(697)]:
    case Si[_0x24b770(461)]:
      return "collabStatus.syncing";
    case Si[_0x24b770(573)]:
    case Si["PENDING"]:
      return _0x24b770(502);
  }
}
function Oi2(_0x2d7248) {
  const _0x553e64 = _0x59d238, { status$: _0x6aa93f } = _0x2d7248, _0x3e1fdb = useObservable(_0x6aa93f, Si[_0x553e64(536)]), _0x1e3408 = useDependency(Fn), _0x4cec22 = useDependency(we3), _0x45a4f3 = _0x3e1fdb !== Si["OFFLINE"], _0x4ffbf4 = _0x1e3408["t"](pi(_0x3e1fdb)), _0x10909c = _0x45a4f3 ? (0, import_jsx_runtime.jsx)(Mt, {}) : (0, import_jsx_runtime.jsx)(Lt, {}), _0xc10134 = (0, import_react.useCallback)(() => {
    _0x45a4f3 || _0x4cec22["reconnect"]();
  }, [_0x45a4f3, _0x4cec22]);
  function _0x5d858f() {
    const _0x22f7f6 = _0x553e64;
    return (0, import_jsx_runtime.jsxs)(_0x22f7f6(510), { "className": _0x22f7f6(556), "onClick": _0xc10134, "children": [(0, import_jsx_runtime.jsx)(_0x22f7f6(510), { "className": ie(_0x22f7f6(445), { "univer-text-green-500": _0x45a4f3, "univer-text-red-500": !_0x45a4f3 }), "children": _0x10909c }), (0, import_jsx_runtime.jsx)("div", { "className": _0x22f7f6(835), "children": _0x4ffbf4 })] });
  }
  return _0x45a4f3 ? _0x5d858f() : (0, import_jsx_runtime.jsx)(Rp, { "title": _0x1e3408["t"](_0x553e64(672)), "children": _0x5d858f() });
}
var Ti = Object[_0x59d238(670)];
var Ci = (_0x5adba9, _0x1cbb72, _0x3eb8fb, _0x18cc92) => {
  const _0x3e37ee = _0x59d238;
  for (var _0x4dac33 = _0x18cc92 > 1 ? void 0 : _0x18cc92 ? Ti(_0x1cbb72, _0x3eb8fb) : _0x1cbb72, _0x242d87 = _0x5adba9[_0x3e37ee(371)] - 1, _0x3e72f4; _0x242d87 >= 0; _0x242d87--) (_0x3e72f4 = _0x5adba9[_0x242d87]) && (_0x4dac33 = _0x3e72f4(_0x4dac33) || _0x4dac33);
  return _0x4dac33;
};
var se2 = (_0x933da7, _0x3b0d91) => (_0x4845fc, _0x1c84c4) => _0x3b0d91(_0x4845fc, _0x1c84c4, _0x933da7);
var oe2 = class extends Ve {
  constructor(_0x2bfc49, _0x1866fe, _0x181d82, _0x2654e1) {
    const _0x407157 = _0x59d238;
    super(), l(this, _0x407157(828), new BehaviorSubject(Si[_0x407157(536)])), this[_0x407157(644)] = _0x2bfc49, this[_0x407157(571)] = _0x1866fe, this["_collaborationController"] = _0x181d82, this["_uiPartsService"] = _0x2654e1, this[_0x407157(777)](), this["_initStatusListener"]();
  }
  [_0x59d238(827)]() {
    const _0x22f485 = _0x59d238;
    this[_0x22f485(621)](this[_0x22f485(644)][_0x22f485(756)][_0x22f485(359)](switchMap(() => {
      const _0x2d24a5 = _0x22f485, _0x7413e = this[_0x2d24a5(644)]["getFocusedUnit"]();
      return _0x7413e ? this[_0x2d24a5(476)][_0x2d24a5(380)](_0x7413e["getUnitId"]()) : of(null);
    }), switchMap((_0xbed8d8) => _0xbed8d8 ? _0xbed8d8[_0x22f485(914)] : of(Si[_0x22f485(536)])))[_0x22f485(369)]((_0x4de1cb) => {
      const _0x58bd6c = _0x22f485;
      this[_0x58bd6c(828)]["next"](_0x4de1cb);
    }));
  }
  [_0x59d238(777)]() {
    const _0x3d6f96 = _0x59d238;
    this[_0x3d6f96(621)](this["_uiPartsService"]["registerComponent"](c1["HEADER_MENU"], () => connectInjector(Ri({ "status$": this[_0x3d6f96(828)]["asObservable"]() }), this[_0x3d6f96(571)])));
  }
};
oe2 = Ci([se2(0, vr), se2(1, Inject(Injector)), se2(2, Inject(nt2)), se2(3, D1)], oe2);
function Ri(_0x2f4207) {
  const { status$: _0x390b7d } = _0x2f4207;
  return function() {
    return (0, import_jsx_runtime.jsx)(Oi2, { "status$": _0x390b7d });
  };
}
var At3 = createIdentifier(_0x59d238(744));
var Di = Object["getOwnPropertyDescriptor"];
var Ni = (_0x1adbb8, _0x5e51d0, _0x43488a, _0x4edde9) => {
  const _0x2ca2d7 = _0x59d238;
  for (var _0x103b61 = _0x4edde9 > 1 ? void 0 : _0x4edde9 ? Di(_0x5e51d0, _0x43488a) : _0x5e51d0, _0x585b22 = _0x1adbb8[_0x2ca2d7(371)] - 1, _0x3dc63; _0x585b22 >= 0; _0x585b22--) (_0x3dc63 = _0x1adbb8[_0x585b22]) && (_0x103b61 = _0x3dc63(_0x103b61) || _0x103b61);
  return _0x103b61;
};
var K2 = (_0x5680a8, _0x39ba6e) => (_0x36f8e8, _0x480914) => _0x39ba6e(_0x36f8e8, _0x480914, _0x5680a8);
var ae2 = class extends h1 {
  constructor(_0x3788e3, _0x43adff, _0x28cbed, _0x418279, _0x42d607) {
    const _0x361f56 = _0x59d238;
    super(), this["_urlService"] = _0x3788e3, this["_logService"] = _0x43adff, this[_0x361f56(772)] = _0x28cbed, this["_dataLoaderService"] = _0x418279, _0x42d607 ? _0x42d607 == null || _0x42d607[_0x361f56(658)]()["then"](() => this[_0x361f56(596)]()) : (this[_0x361f56(478)][_0x361f56(456)](_0x361f56(889), _0x361f56(871)), this[_0x361f56(596)]());
  }
  async [_0x59d238(596)]() {
    const _0x3ed8fb = _0x59d238, _0x5c8e57 = this[_0x3ed8fb(836)][_0x3ed8fb(578)](_0x3ed8fb(575)), _0x4864b9 = this["_urlService"][_0x3ed8fb(578)](_0x3ed8fb(557)), _0x17e89c = this[_0x3ed8fb(836)][_0x3ed8fb(578)](_0x3ed8fb(608));
    if (!_0x5c8e57 || !_0x4864b9) {
      this["_logService"][_0x3ed8fb(456)](_0x3ed8fb(889), _0x3ed8fb(702));
      return;
    }
    const _0x3d84ef = await this[_0x3ed8fb(580)]["loadUnit"](_0x5c8e57, Number(_0x4864b9), _0x17e89c);
    _0x3d84ef && _0x3d84ef instanceof ws && this[_0x3ed8fb(679)](_0x3d84ef);
  }
  async [_0x59d238(679)](_0x56d170) {
    const _0x45a082 = _0x59d238;
    await this["_updateSubUnitFromURLParams"](_0x56d170), _0x56d170["activeSheet$"][_0x45a082(359)](takeUntil(this[_0x45a082(447)]))[_0x45a082(369)]((_0xd9e2dc) => {
      const _0x5cff6c = _0x45a082;
      _0xd9e2dc && this[_0x5cff6c(470)](_0xd9e2dc);
    }), this[_0x45a082(836)]["urlChange$"][_0x45a082(359)](takeUntil(this[_0x45a082(447)]))[_0x45a082(369)](() => this[_0x45a082(569)](_0x56d170));
  }
  [_0x59d238(470)](_0x445057, _0x24e08e = false) {
    const _0x2689c7 = _0x59d238, _0x5db2f6 = this[_0x2689c7(836)][_0x2689c7(578)]("subunit");
    _0x445057[_0x2689c7(512)]() !== _0x5db2f6 && this[_0x2689c7(836)][_0x2689c7(365)](_0x2689c7(608), _0x445057[_0x2689c7(512)](), _0x24e08e);
  }
  async ["_updateSubUnitFromURLParams"](_0x4e0b93) {
    const _0x2e4a4e = _0x59d238;
    var _0x1e4088;
    const _0x363aeb = this[_0x2e4a4e(836)][_0x2e4a4e(578)](_0x2e4a4e(608));
    if (!_0x363aeb || !_0x4e0b93[_0x2e4a4e(834)](_0x363aeb)) {
      const _0x3cd920 = _0x4e0b93[_0x2e4a4e(773)]()[0], _0x519861 = _0x4e0b93[_0x2e4a4e(834)](_0x3cd920);
      if (!_0x519861) return;
      this["_updateURLWithCurrentState"](_0x519861, true), await this["_commandService"][_0x2e4a4e(441)](ri["id"], { "unitId": _0x4e0b93["getUnitId"](), "subUnitId": _0x3cd920 });
      return;
    }
    ((_0x1e4088 = _0x4e0b93[_0x2e4a4e(774)]()) == null ? void 0 : _0x1e4088[_0x2e4a4e(512)]()) !== _0x363aeb && await this[_0x2e4a4e(772)][_0x2e4a4e(441)](ri["id"], { "unitId": _0x4e0b93[_0x2e4a4e(675)](), "subUnitId": _0x363aeb });
  }
};
ae2 = Ni([K2(0, At3), K2(1, yt), K2(2, Ls), K2(3, Inject(Ot)), K2(4, Optional(g))], ae2);
var bi = Object[_0x59d238(670)];
var Ui = (_0xdd8d31, _0x53270a, _0xaf63d0, _0xc7eb83) => {
  const _0x3271ba = _0x59d238;
  for (var _0x4b298c = _0xc7eb83 > 1 ? void 0 : _0xc7eb83 ? bi(_0x53270a, _0xaf63d0) : _0x53270a, _0x5735f2 = _0xdd8d31[_0x3271ba(371)] - 1, _0x23fef6; _0x5735f2 >= 0; _0x5735f2--) (_0x23fef6 = _0xdd8d31[_0x5735f2]) && (_0x4b298c = _0x23fef6(_0x4b298c) || _0x4b298c);
  return _0x4b298c;
};
var tt2 = (_0x2d6ab4, _0x772101) => (_0x5976cb, _0x212564) => _0x772101(_0x5976cb, _0x212564, _0x2d6ab4);
function _0x6a51(_0x820361, _0x2695ee) {
  const _0x3e21be = _0x3e21();
  return _0x6a51 = function(_0x6a5188, _0x455bf7) {
    _0x6a5188 = _0x6a5188 - 354;
    let _0x4cd062 = _0x3e21be[_0x6a5188];
    return _0x4cd062;
  }, _0x6a51(_0x820361, _0x2695ee);
}
var Ae = class extends h1 {
  constructor(_0x4f9a29, _0x3e7e31) {
    const _0x514683 = _0x59d238;
    super(), this[_0x514683(797)] = _0x4f9a29, this[_0x514683(901)] = _0x3e7e31, this["_init"]();
  }
  [_0x59d238(596)]() {
    const _0x3f0d25 = _0x59d238, _0x52ea2c = this;
    this[_0x3f0d25(621)](this[_0x3f0d25(797)]["addClipboardHook"]({ "onBeforePasteImage": async (_0x4b1336) => {
      const _0x4c2abb = _0x3f0d25, _0x1e27e0 = await _0x52ea2c[_0x4c2abb(901)][_0x4c2abb(872)](_0x4b1336);
      return _0x1e27e0 ? { "source": _0x1e27e0[_0x4c2abb(922)], "imageSourceType": _0x1e27e0[_0x4c2abb(903)] } : null;
    } }));
  }
};
Ae = Ui([tt2(0, Nt), tt2(1, El)], Ae);
var st3 = [_0x59d238(736), _0x59d238(430), _0x59d238(884), _0x59d238(805), _0x59d238(616), _0x59d238(515)];
var je = class extends Ve {
  constructor() {
    const _0x5908d8 = _0x59d238;
    super(...arguments), l(this, _0x5908d8(905), /* @__PURE__ */ new Map()), l(this, _0x5908d8(410), 0);
  }
  [_0x59d238(471)](_0x4f5eca) {
    const _0x26fc97 = _0x59d238;
    if (this[_0x26fc97(905)][_0x26fc97(779)](_0x4f5eca)) return this[_0x26fc97(905)][_0x26fc97(436)](_0x4f5eca);
    const _0x38d09e = st3[this[_0x26fc97(410)]];
    return this[_0x26fc97(410)] = (this["_colorIndex"] + 1) % st3[_0x26fc97(371)], this[_0x26fc97(905)][_0x26fc97(727)](_0x4f5eca, _0x38d09e), _0x38d09e;
  }
};
function Pt2(_0x10684f) {
  const _0x8fca39 = _0x59d238;
  let _0xdd43a1 = "";
  for (const _0x1cd55b of _0x10684f) {
    const { startOffset: _0x4df6a6, endOffset: _0x3c7d49, isActive: _0x3fa7b9, rangeType: _0x23e361, segmentId: _0x88a194, segmentPage: _0x3ea36c } = _0x1cd55b;
    _0xdd43a1[_0x8fca39(371)] && (_0xdd43a1 += ","), _0xdd43a1 += _0x4df6a6 + ":" + _0x3c7d49 + ":" + (_0x3fa7b9 ? "1" : "0") + ":" + _0x23e361 + ":" + _0x88a194 + ":" + _0x3ea36c;
  }
  return _0xdd43a1;
}
function Li(_0x52afbf) {
  const _0x580b49 = _0x59d238, _0xb004a0 = _0x52afbf[_0x580b49(385)](","), _0x2e78c0 = [];
  for (const _0x3d0ad8 of _0xb004a0) {
    const [_0xba9250, _0x5ea6d8, _0x4271fa, _0x4185fa, _0x1fa31c, _0x4b7705] = _0x3d0ad8[_0x580b49(385)](":");
    _0x2e78c0[_0x580b49(565)]({ "startOffset": Number(_0xba9250), "endOffset": Number(_0x5ea6d8), "collapsed": _0xba9250 === _0x5ea6d8, "isActive": _0x4271fa === "1", "rangeType": _0x4185fa === jg[_0x580b49(893)] ? jg[_0x580b49(893)] : jg[_0x580b49(558)], "segmentId": typeof _0x1fa31c == _0x580b49(852) ? String(_0x1fa31c) : "", "segmentPage": Number(_0x4b7705 != null ? _0x4b7705 : -1) });
  }
  return _0x2e78c0["some"]((_0x132f4f) => _0x132f4f[_0x580b49(398)]) || (_0x2e78c0[0][_0x580b49(398)] = true), _0x2e78c0;
}
var Xe2 = class extends h1 {
  constructor() {
    const _0x3f0847 = _0x59d238;
    super(...arguments), l(this, _0x3f0847(696), new BehaviorSubject(null)), l(this, "collabCursorState$", this["_collabCursorState$"][_0x3f0847(787)]());
  }
  [_0x59d238(418)](_0x9b54ac) {
    const _0xf01caf = _0x59d238, { unitID: _0x336c5c, memberID: _0x435840, textRanges: _0x1cf86e } = _0x9b54ac, _0x5459dc = Pt2(_0x1cf86e);
    if (_0x5459dc === "") return;
    const _0x541779 = { "unitID": _0x336c5c, "memberID": _0x435840, "selection": _0x5459dc };
    this[_0xf01caf(696)][_0xf01caf(639)](_0x541779);
  }
};
var Mi = Object[_0x59d238(670)];
var Ai = (_0x3d93e5, _0x324915, _0x539bd7, _0x23f26f) => {
  const _0x18e8f3 = _0x59d238;
  for (var _0xd7c54a = _0x23f26f > 1 ? void 0 : _0x23f26f ? Mi(_0x324915, _0x539bd7) : _0x324915, _0x51c38e = _0x3d93e5[_0x18e8f3(371)] - 1, _0x976825; _0x51c38e >= 0; _0x51c38e--) (_0x976825 = _0x3d93e5[_0x51c38e]) && (_0xd7c54a = _0x976825(_0xd7c54a) || _0xd7c54a);
  return _0xd7c54a;
};
var A2 = (_0x345b13, _0x24b315) => (_0x2ce0c6, _0x45fd34) => _0x24b315(_0x2ce0c6, _0x45fd34, _0x345b13);
var Pi = 300;
var wi = 100;
var Pe4 = class extends h1 {
  constructor(_0x142ddb, _0x4a11e1, _0x50f899, _0x492f02, _0x2a3cd8, _0x542a49, _0x42bf28, _0x1b791a, _0x3ae49a) {
    const _0x59205a = _0x59d238;
    super(), l(this, "_online", false), l(this, _0x59205a(596), false), l(this, "_cursorInfo$", new BehaviorSubject(/* @__PURE__ */ new Map())), l(this, _0x59205a(710), this[_0x59205a(481)][_0x59205a(787)]()), l(this, _0x59205a(490), new BehaviorSubject([])), l(this, _0x59205a(534), this[_0x59205a(490)][_0x59205a(359)](debounceTime(Pi))), l(this, "_updateLocalCursor", n1((_0x25ba4e) => {
      const _0x13f2cd = _0x59205a, _0x23d351 = { "eventID": Rm[_0x13f2cd(739)], "data": { "unitID": this["unitID"], "memberID": this[_0x13f2cd(918)]["getMemberID"](), "selection": Pt2(_0x25ba4e) } };
      this[_0x13f2cd(918)]["send"](_0x23d351, this[_0x13f2cd(446)]);
    }, wi)), this[_0x59205a(446)] = _0x142ddb, this[_0x59205a(918)] = _0x4a11e1, this[_0x59205a(571)] = _0x50f899, this[_0x59205a(680)] = _0x492f02, this[_0x59205a(790)] = _0x2a3cd8, this[_0x59205a(908)] = _0x542a49, this["_transformService"] = _0x42bf28, this["_univerInstanceService"] = _0x1b791a, this[_0x59205a(772)] = _0x3ae49a;
  }
  get [_0x59d238(704)]() {
    const _0x26a1a2 = _0x59d238;
    return this[_0x26a1a2(481)][_0x26a1a2(509)]();
  }
  get ["roomMembers"]() {
    const _0x57c156 = _0x59d238;
    return this[_0x57c156(490)][_0x57c156(509)]();
  }
  [_0x59d238(387)]() {
    const _0x3eb9ec = _0x59d238;
    super[_0x3eb9ec(387)](), this["_cursorInfo$"][_0x3eb9ec(639)](/* @__PURE__ */ new Map()), this[_0x3eb9ec(481)][_0x3eb9ec(792)](), this[_0x3eb9ec(490)]["next"]([]), this[_0x3eb9ec(490)][_0x3eb9ec(792)]();
  }
  [_0x59d238(519)]() {
    const _0x202e94 = _0x59d238;
    this[_0x202e94(596)] || (this[_0x202e94(596)] = true, this["_session"][_0x202e94(648)][_0x202e94(359)](takeUntil(this[_0x202e94(447)]))[_0x202e94(369)]((_0xa7f918) => {
      const _0x3c5f52 = _0x202e94;
      _0xa7f918 === me2[_0x3c5f52(640)] ? this["_toggleOnline"]() : this[_0x3c5f52(860)]();
    }), this["_session"][_0x202e94(873)]["pipe"](takeUntil(this[_0x202e94(447)]))[_0x202e94(369)]((_0x159c40) => {
      const _0x5c2684 = _0x202e94, _0x255988 = _0x159c40[_0x5c2684(722)];
      _0x255988 === Rm[_0x5c2684(739)] && this[_0x5c2684(549)](_0x159c40), _0x255988 === Rm["USERS_LEAVE"] && this[_0x5c2684(682)](_0x159c40);
    }), this["disposeWithMe"](this[_0x202e94(772)]["onCommandExecuted"]((_0x3a8b89) => {
      const _0x5dfe27 = _0x202e94, _0x579443 = _0x3a8b89[_0x5dfe27(425)];
      _0x579443 != null && this[_0x5dfe27(588)] && _0x3a8b89["id"] === k["id"] && _0x579443[_0x5dfe27(413)] === this["unitID"] && _0x579443[_0x5dfe27(676)] === false && _0x579443[_0x5dfe27(540)][_0x5dfe27(371)] > 0 && this["_updateLocalCursor"](_0x579443[_0x5dfe27(540)]);
    })), this[_0x202e94(908)][_0x202e94(819)][_0x202e94(359)](takeUntil(this[_0x202e94(447)]))[_0x202e94(369)]((_0x35fb5c) => {
      const _0x544af3 = _0x202e94;
      if ((_0x35fb5c == null ? void 0 : _0x35fb5c[_0x544af3(446)]) !== this[_0x544af3(446)]) return;
      const _0x42e26e = { "eventID": Rm["UPDATE_CURSOR"], "data": _0x35fb5c };
      this[_0x544af3(549)](_0x42e26e);
    }), this[_0x202e94(621)](this["_commandService"][_0x202e94(424)]((_0x8c8515) => {
      const _0x5e2ee2 = _0x202e94;
      if (_0x8c8515[_0x5e2ee2(425)] == null) return;
      const _0x5db050 = _0x8c8515[_0x5e2ee2(425)];
      if (_0x8c8515["id"] !== M["id"] || _0x5db050["unitId"] !== this[_0x5e2ee2(446)]) return;
      const _0x5a3a4c = { "id": "doc.mutation.rich-text-editing", "params": _0x5db050 }, _0x41807e = this["cursorInfo"];
      for (const [_0x40933d, _0x248cf2] of _0x41807e) {
        const _0x214370 = { "id": _0x5e2ee2(472), "params": { "unitId": this[_0x5e2ee2(446)], "actions": null, "textRanges": _0x248cf2[_0x5e2ee2(540)] } }, _0x3608f4 = this[_0x5e2ee2(448)][_0x5e2ee2(401)](_0x5a3a4c, _0x214370, false);
        if (ce(_0x3608f4)) throw _0x3608f4[_0x5e2ee2(883)];
        _0x41807e[_0x5e2ee2(727)](_0x40933d, { ..._0x248cf2, "ranges": _0x3608f4[_0x5e2ee2(656)][_0x5e2ee2(425)]["textRanges"] });
      }
      queueMicrotask(() => {
        const _0x538a41 = _0x5e2ee2;
        this[_0x538a41(481)][_0x538a41(639)](_0x41807e);
      });
    })));
  }
  ["_onCursorUpdate"](_0x7a05bc) {
    const _0x356377 = _0x59d238;
    var _0x182f8d, _0x346227;
    const { memberID: _0x300dad, selection: _0x6ffadd } = _0x7a05bc["data"], _0x4db147 = Li(_0x6ffadd), _0x1d6db6 = (_0x346227 = (_0x182f8d = this["_memberService"][_0x356377(720)](this[_0x356377(446)], _0x300dad)) == null ? void 0 : _0x182f8d[_0x356377(606)]) != null ? _0x346227 : _0x356377(743), _0x471454 = { "color": this[_0x356377(680)][_0x356377(471)](_0x300dad), "name": _0x1d6db6, "ranges": _0x4db147 }, _0x39c9b7 = this["cursorInfo"];
    _0x39c9b7[_0x356377(727)](_0x300dad, _0x471454), this[_0x356377(481)][_0x356377(639)](_0x39c9b7);
  }
  [_0x59d238(682)](_0x326761) {
    const _0x25568a = _0x59d238, { memberID: _0x44f840 } = _0x326761[_0x25568a(651)], _0x33dd37 = this["cursorInfo"];
    _0x33dd37[_0x25568a(849)](_0x44f840), this["_cursorInfo$"][_0x25568a(639)](_0x33dd37);
  }
  [_0x59d238(810)]() {
    const _0x26cb88 = _0x59d238;
    var _0x1294d1;
    if (this[_0x26cb88(588)] = true, ((_0x1294d1 = this[_0x26cb88(644)]["getFocusedUnit"]()) == null ? void 0 : _0x1294d1[_0x26cb88(675)]()) !== this[_0x26cb88(446)]) return;
    const _0x2c2241 = this[_0x26cb88(571)][_0x26cb88(436)](m)[_0x26cb88(864)]();
    Array[_0x26cb88(423)](_0x2c2241) && _0x2c2241[_0x26cb88(371)] > 0 && this[_0x26cb88(894)](_0x2c2241);
  }
  [_0x59d238(860)]() {
    const _0x1b26fa = _0x59d238;
    this[_0x1b26fa(588)] = false;
  }
};
Pe4 = Ai([A2(2, Inject(Injector)), A2(3, Inject(je)), A2(4, Inject(Pe3)), A2(5, Inject(Xe2)), A2(6, Pe2), A2(7, vr), A2(8, Ls)], Pe4);
var yi = Object[_0x59d238(670)];
var $i = (_0x40816d, _0x26d902, _0x5724f1, _0x29a929) => {
  const _0x470498 = _0x59d238;
  for (var _0x2772b7 = _0x29a929 > 1 ? void 0 : _0x29a929 ? yi(_0x26d902, _0x5724f1) : _0x26d902, _0x56dac7 = _0x40816d[_0x470498(371)] - 1, _0x2b679a; _0x56dac7 >= 0; _0x56dac7--) (_0x2b679a = _0x40816d[_0x56dac7]) && (_0x2772b7 = _0x2b679a(_0x2772b7) || _0x2772b7);
  return _0x2772b7;
};
var B = (_0x3d6670, _0x333e39) => (_0x209361, _0x1cbadc) => _0x333e39(_0x209361, _0x1cbadc, _0x3d6670);
var xi = 300;
var Bi2 = 100;
var Fi = () => {
  let _0x43c1c5 = [], _0x5bc8d6 = false;
  return (_0x45c3c5) => {
    _0x43c1c5["push"](_0x45c3c5), _0x5bc8d6 || (_0x5bc8d6 = true, setTimeout(() => {
      const _0x344c2d = _0x6a51;
      _0x43c1c5[_0x344c2d(450)]((_0x5e95d4) => _0x5e95d4()), _0x43c1c5 = [], _0x5bc8d6 = false;
    }));
  };
};
var we4 = class extends h1 {
  constructor(_0x3971c9, _0x74b32d, _0x478eab, _0xccdf80, _0x3f8a5a, _0x290876, _0x644a86, _0x5ecb9) {
    const _0x40a7b4 = _0x59d238;
    super(), l(this, _0x40a7b4(588), false), l(this, "_init", false), l(this, _0x40a7b4(481), new BehaviorSubject(/* @__PURE__ */ new Map())), l(this, _0x40a7b4(710), this[_0x40a7b4(481)]["asObservable"]()), l(this, "_roomMembers$", new BehaviorSubject([])), l(this, _0x40a7b4(534), this["_roomMembers$"]["pipe"](debounceTime(xi))), l(this, "_updateLocalCursor", n1((_0x56ecbb, _0x2bd760) => {
      const _0x23d4ed = _0x40a7b4, _0x2a2995 = { "eventID": Rm[_0x23d4ed(739)], "data": { "unitID": this[_0x23d4ed(446)], "memberID": this[_0x23d4ed(918)][_0x23d4ed(468)](), "selection": Hc(_0x56ecbb, _0x2bd760["range"]) } };
      this[_0x23d4ed(918)][_0x23d4ed(635)](_0x2a2995, this[_0x23d4ed(446)]);
    }, Bi2)), this[_0x40a7b4(446)] = _0x3971c9, this["_session"] = _0x74b32d, this[_0x40a7b4(571)] = _0x478eab, this[_0x40a7b4(680)] = _0xccdf80, this[_0x40a7b4(790)] = _0x3f8a5a, this[_0x40a7b4(644)] = _0x290876, this[_0x40a7b4(772)] = _0x644a86, this[_0x40a7b4(689)] = _0x5ecb9;
  }
  get [_0x59d238(704)]() {
    const _0x5c21d6 = _0x59d238;
    return this[_0x5c21d6(481)]["getValue"]();
  }
  get [_0x59d238(794)]() {
    const _0x40bc77 = _0x59d238;
    return this[_0x40bc77(490)]["getValue"]();
  }
  [_0x59d238(387)]() {
    const _0x49b99e = _0x59d238;
    super[_0x49b99e(387)](), this[_0x49b99e(481)][_0x49b99e(639)](/* @__PURE__ */ new Map()), this[_0x49b99e(481)][_0x49b99e(792)](), this["_roomMembers$"][_0x49b99e(639)]([]), this[_0x49b99e(490)][_0x49b99e(792)]();
  }
  ["init"]() {
    const _0x372bd1 = _0x59d238;
    this["_init"] || (this[_0x372bd1(596)] = true, this[_0x372bd1(918)][_0x372bd1(648)][_0x372bd1(359)](takeUntil(this[_0x372bd1(447)]))[_0x372bd1(369)]((_0x7868f2) => {
      const _0x4deb47 = _0x372bd1;
      _0x7868f2 === me2[_0x4deb47(640)] ? this[_0x4deb47(810)]() : this[_0x4deb47(860)]();
    }), this["_session"][_0x372bd1(873)][_0x372bd1(359)](takeUntil(this[_0x372bd1(447)]))[_0x372bd1(369)]((_0x30b731) => {
      const _0x1781fd = _0x372bd1, _0x59c894 = _0x30b731[_0x1781fd(722)];
      _0x59c894 === Rm[_0x1781fd(739)] && this[_0x1781fd(549)](_0x30b731), _0x59c894 === Rm[_0x1781fd(917)] && this[_0x1781fd(682)](_0x30b731);
    }), this["_onRefRangeChange"](), this[_0x372bd1(621)](this["_commandService"][_0x372bd1(424)]((_0x5b50e9) => {
      const _0xbad7c0 = _0x372bd1;
      if (this[_0xbad7c0(588)] && _0x5b50e9["id"] === ie2["id"] && _0x5b50e9["params"][_0xbad7c0(413)] === this[_0xbad7c0(446)]) {
        const _0xe96d51 = _0x5b50e9["params"];
        this[_0xbad7c0(894)](_0xe96d51["subUnitId"], _0xe96d51["selections"][0]);
      }
    })));
  }
  ["_onCursorUpdate"](_0x5b0740) {
    const _0x50dbcc = _0x59d238;
    var _0x3a5cef, _0x2ea748;
    const { memberID: _0x580369, selection: _0x305048 } = _0x5b0740[_0x50dbcc(651)], { sheetName: _0x60ebf6, range: _0x254a74 } = Dr(_0x305048), _0x843dd7 = { "name": (_0x2ea748 = (_0x3a5cef = this[_0x50dbcc(790)][_0x50dbcc(720)](this["unitID"], _0x580369)) == null ? void 0 : _0x3a5cef[_0x50dbcc(606)]) != null ? _0x2ea748 : "Unknown user", "range": this[_0x50dbcc(530)](_0x60ebf6, _0x254a74), "sheetID": _0x60ebf6, "color": this[_0x50dbcc(680)][_0x50dbcc(471)](_0x580369), "selection": _0x305048 }, _0x557272 = this["cursorInfo"];
    _0x557272["set"](_0x580369, _0x843dd7), this["_cursorInfo$"][_0x50dbcc(639)](_0x557272);
  }
  [_0x59d238(682)](_0x552170) {
    const _0xb21a0d = _0x59d238, { memberID: _0x4ee011 } = _0x552170[_0xb21a0d(651)], _0x2c7648 = this[_0xb21a0d(704)];
    _0x2c7648["delete"](_0x4ee011), this[_0xb21a0d(481)][_0xb21a0d(639)](_0x2c7648);
  }
  [_0x59d238(530)](_0x164344, _0x4e4f10) {
    const _0x3deee0 = _0x59d238;
    var _0x128d86, _0x25d97c;
    const _0x1e15d5 = (_0x25d97c = (_0x128d86 = this[_0x3deee0(644)][_0x3deee0(709)](this[_0x3deee0(446)])) == null ? void 0 : _0x128d86[_0x3deee0(834)](_0x164344)) == null ? void 0 : _0x25d97c[_0x3deee0(859)]();
    return (_0x1e15d5 == null ? void 0 : _0x1e15d5[_0x3deee0(355)]((_0x353b8d) => En[_0x3deee0(813)](_0x353b8d, _0x4e4f10))) || _0x4e4f10;
  }
  [_0x59d238(566)]() {
    const _0x1a6c02 = _0x59d238, _0x4b0bdc = new ao(), _0x1409e3 = Fi(), _0x2d8759 = () => {
      const _0x5925bf = _0x6a51;
      _0x4b0bdc["dispose"]();
      const _0x2c7917 = (_0x41bdb7, _0x4eef77, _0x223cb3, _0x482de5) => {
        const _0x1768ea = _0x6a51;
        let _0x25f168 = [];
        switch (_0x41bdb7["id"]) {
          case W[_0x1768ea(769)]: {
            _0x25f168 = Ul(_0x41bdb7, _0x482de5);
            break;
          }
          case W[_0x1768ea(586)]: {
            _0x25f168 = Tl(_0x41bdb7, _0x482de5);
            break;
          }
          case W[_0x1768ea(587)]: {
            _0x25f168 = Ml(_0x41bdb7, _0x482de5);
            break;
          }
          case W[_0x1768ea(783)]: {
            _0x25f168 = _l(_0x41bdb7, _0x482de5);
            break;
          }
          case W[_0x1768ea(911)]: {
            _0x25f168 = bl(_0x41bdb7, _0x482de5);
            break;
          }
          case W[_0x1768ea(863)]: {
            _0x25f168 = vl(_0x41bdb7, _0x482de5);
            break;
          }
          case W[_0x1768ea(629)]: {
            _0x25f168 = Cl(_0x41bdb7, _0x482de5);
            break;
          }
          case W[_0x1768ea(402)]: {
            _0x25f168 = Br(_0x41bdb7, _0x482de5);
            break;
          }
          case W[_0x1768ea(561)]: {
            _0x25f168 = Sl(_0x41bdb7, _0x482de5);
            break;
          }
        }
        const _0x5bb8c6 = At(_0x25f168, _0x482de5), _0x3d5bff = this[_0x1768ea(704)][_0x1768ea(436)](_0x4eef77);
        if (_0x3d5bff && _0x5bb8c6) {
          const _0x4dc161 = { ..._0x3d5bff, "range": _0x5bb8c6 };
          this["cursorInfo"][_0x1768ea(727)](_0x4eef77, _0x4dc161), _0x1409e3(() => {
            const _0x35c1bf = _0x1768ea, _0x2c56a9 = this[_0x35c1bf(689)][_0x35c1bf(886)](_0x5bb8c6, (_0x26e551) => (_0x2c56a9[_0x35c1bf(387)](), _0x2c7917(_0x26e551, _0x4eef77, _0x223cb3, _0x5bb8c6)));
            _0x4b0bdc[_0x35c1bf(459)](_0x2c56a9);
          });
        }
        return { "redos": [], "undos": [] };
      };
      this[_0x5925bf(704)][_0x5925bf(450)]((_0x5d4dcf, _0x446254) => {
        const _0x5a4805 = _0x5925bf, { range: _0x343ff7, sheetID: _0x8c1ac6 } = _0x5d4dcf, _0x1c69f9 = this[_0x5a4805(689)][_0x5a4805(886)](_0x343ff7, (_0xe43881) => (_0x1c69f9[_0x5a4805(387)](), _0x2c7917(_0xe43881, _0x446254, _0x8c1ac6, _0x343ff7)));
        _0x4b0bdc[_0x5a4805(459)](_0x1c69f9);
      });
    };
    this[_0x1a6c02(621)](We(this[_0x1a6c02(481)][_0x1a6c02(369)](() => {
      _0x2d8759();
    })));
  }
  [_0x59d238(810)]() {
    const _0x210752 = _0x59d238;
    var _0x10012d, _0x4d604b;
    if (this[_0x210752(588)] = true, ((_0x10012d = this[_0x210752(644)][_0x210752(825)]()) == null ? void 0 : _0x10012d[_0x210752(675)]()) !== this[_0x210752(446)]) return;
    const _0x1e0d2c = (_0x4d604b = this[_0x210752(571)][_0x210752(436)](z)["getCurrentSelections"]()) == null ? void 0 : _0x4d604b[0], _0x2c7274 = this["_univerInstanceService"]["getCurrentUnitForType"](we[_0x210752(520)])["getActiveSheet"]();
    _0x1e0d2c && _0x2c7274 && this[_0x210752(894)](_0x2c7274["getSheetId"](), _0x1e0d2c);
  }
  [_0x59d238(860)]() {
    const _0x205768 = _0x59d238;
    this[_0x205768(588)] = false;
  }
};
we4 = $i([B(2, Inject(Injector)), B(3, Inject(je)), B(4, Inject(Pe3)), B(5, vr), B(6, Ls), B(7, Inject(xt))], we4);
var ki = Object[_0x59d238(670)];
var Hi = (_0x484c4b, _0x369b41, _0x3d2dd3, _0x2d12f3) => {
  const _0x1649ed = _0x59d238;
  for (var _0x300659 = _0x2d12f3 > 1 ? void 0 : _0x2d12f3 ? ki(_0x369b41, _0x3d2dd3) : _0x369b41, _0x15c5dd = _0x484c4b[_0x1649ed(371)] - 1, _0x559e0f; _0x15c5dd >= 0; _0x15c5dd--) (_0x559e0f = _0x484c4b[_0x15c5dd]) && (_0x300659 = _0x559e0f(_0x300659) || _0x300659);
  return _0x300659;
};
var Ee = (_0x28391f, _0x4b7718) => (_0x21f944, _0x4b7493) => _0x4b7718(_0x21f944, _0x4b7493, _0x28391f);
var H = class extends h1 {
  constructor(_0x2b0617, _0x5b8f06, _0x1dfaa8) {
    const _0x3e41ba = _0x59d238;
    super(), l(this, _0x3e41ba(370), /* @__PURE__ */ new Map()), l(this, "_entityInit$", new Subject()), this[_0x3e41ba(644)] = _0x2b0617, this[_0x3e41ba(571)] = _0x5b8f06, this[_0x3e41ba(668)] = _0x1dfaa8, this["_init"]();
  }
  ["dispose"]() {
    const _0x46f6de = _0x59d238;
    super[_0x46f6de(387)](), this[_0x46f6de(857)][_0x46f6de(792)](), this[_0x46f6de(370)]["forEach"]((_0x15dab7) => _0x15dab7[_0x46f6de(387)]());
  }
  [_0x59d238(391)](_0x3329c7) {
    const _0x5e5729 = _0x59d238;
    return this["_entities"][_0x5e5729(779)](_0x3329c7) ? this[_0x5e5729(370)][_0x5e5729(436)](_0x3329c7)[_0x5e5729(710)] : this[_0x5e5729(857)]["pipe"](filter((_0x14bbf0) => _0x14bbf0[_0x5e5729(446)] === _0x3329c7), switchMap((_0x1c2bd4) => _0x1c2bd4["cursorInfo$"]));
  }
  [_0x59d238(596)]() {
    const _0x376fe0 = _0x59d238;
    this[_0x376fe0(644)]["getTypeOfUnitAdded$"](we[_0x376fe0(520)])[_0x376fe0(359)](takeUntil(this["dispose$"]))["subscribe"](async (_0x266e34) => {
      const _0x3929f8 = _0x376fe0, _0x127906 = _0x266e34[_0x3929f8(675)](), _0x57be94 = await this[_0x3929f8(622)](_0x127906);
      this[_0x3929f8(857)][_0x3929f8(639)](_0x57be94), this[_0x3929f8(370)]["set"](_0x127906, _0x57be94);
    }), this["_univerInstanceService"][_0x376fe0(690)](we[_0x376fe0(411)])["pipe"](takeUntil(this[_0x376fe0(447)]))["pipe"](filter((_0x381f28) => !_0x381f28[_0x376fe0(675)]()[_0x376fe0(403)]("__")))[_0x376fe0(369)](async (_0x50574c) => {
      const _0x4d24ba = _0x376fe0, _0x2bed4f = _0x50574c[_0x4d24ba(675)](), _0x419cc5 = await this[_0x4d24ba(428)](_0x2bed4f);
      this[_0x4d24ba(857)][_0x4d24ba(639)](_0x419cc5), this[_0x4d24ba(370)]["set"](_0x2bed4f, _0x419cc5);
    }), merge(this[_0x376fe0(644)]["getTypeOfUnitDisposed$"](we[_0x376fe0(411)]), this[_0x376fe0(644)][_0x376fe0(399)](we[_0x376fe0(520)]))[_0x376fe0(359)](takeUntil(this[_0x376fe0(447)]))["subscribe"]((_0x3c8975) => {
      const _0xff3594 = _0x376fe0, _0x2c6eb0 = _0x3c8975[_0xff3594(675)](), _0x526982 = this["_entities"][_0xff3594(436)](_0x2c6eb0);
      _0x526982 && (_0x526982[_0xff3594(387)](), this[_0xff3594(370)]["delete"](_0x2c6eb0));
    });
  }
  async [_0x59d238(622)](_0x3e41ff) {
    const _0x3d8ce8 = _0x59d238, _0x150ac3 = await this[_0x3d8ce8(668)][_0x3d8ce8(522)](_0x3e41ff), _0x3e02b1 = this[_0x3d8ce8(571)][_0x3d8ce8(619)](we4, _0x3e41ff, _0x150ac3);
    return _0x3e02b1[_0x3d8ce8(519)](), _0x3e02b1;
  }
  async [_0x59d238(428)](_0x22ad99) {
    const _0x2e1b7f = _0x59d238, _0x10161f = await this[_0x2e1b7f(668)][_0x2e1b7f(522)](_0x22ad99), _0x5db107 = this["_injector"][_0x2e1b7f(619)](Pe4, _0x22ad99, _0x10161f);
    return _0x5db107["init"](), _0x5db107;
  }
};
H = Hi([Ee(0, vr), Ee(1, Inject(Injector)), Ee(2, Inject(we3))], H);
var Q = 20;
var it2 = 200;
var pe2 = 4;
var Yi = 5;
function Wi2(_0x1a112a, _0x570eff) {
  const _0x153828 = _0x59d238;
  let { radius: _0x215483, width: _0x2fd0df, height: _0x585128 } = _0x570eff;
  _0x215483 = _0x215483 != null ? _0x215483 : 0, _0x2fd0df = _0x2fd0df != null ? _0x2fd0df : 30, _0x585128 = _0x585128 != null ? _0x585128 : 30;
  let _0x13ebb6 = 0, _0xd79293 = 0, _0x40b3f0 = 0;
  _0x13ebb6 = _0xd79293 = _0x40b3f0 = Math[_0x153828(674)](_0x215483, _0x2fd0df / 2, _0x585128 / 2), _0x1a112a["beginPath"](), _0x1a112a[_0x153828(795)](_0x13ebb6, 0), _0x1a112a["lineTo"](_0x2fd0df - _0xd79293, 0), _0x1a112a["arc"](_0x2fd0df - _0xd79293, _0xd79293, _0xd79293, Math["PI"] * 3 / 2, 0, false), _0x1a112a[_0x153828(535)](_0x2fd0df, _0x585128 - _0x40b3f0), _0x1a112a["arc"](_0x2fd0df - _0x40b3f0, _0x585128 - _0x40b3f0, _0x40b3f0, 0, Math["PI"] / 2, false), _0x1a112a[_0x153828(535)](0, _0x585128), _0x1a112a[_0x153828(535)](0, _0x13ebb6), _0x1a112a["arc"](_0x13ebb6, _0x13ebb6, _0x13ebb6, Math["PI"], Math["PI"] * 3 / 2, false), _0x1a112a["closePath"](), _0x570eff["fill"] && (_0x1a112a[_0x153828(546)](), _0x1a112a[_0x153828(356)] = _0x570eff[_0x153828(785)], _0x570eff[_0x153828(562)] === _0x153828(823) ? _0x1a112a[_0x153828(785)]("evenodd") : _0x1a112a["fill"](), _0x1a112a["restore"]());
}
var me3 = class _me extends x3 {
  constructor(_0x595685, _0x3647c2) {
    const _0x21c6d2 = _0x59d238;
    super(_0x595685, _0x3647c2), l(this, _0x21c6d2(786)), l(this, "text"), this[_0x21c6d2(786)] = _0x3647c2 == null ? void 0 : _0x3647c2[_0x21c6d2(786)], this[_0x21c6d2(761)] = _0x3647c2 == null ? void 0 : _0x3647c2[_0x21c6d2(761)];
  }
  static [_0x59d238(354)](_0xcb4474, _0x2adf69) {
    const _0xc1f05d = _0x59d238, { text: _0xb5e2ce, color: _0x453c86 } = _0x2adf69;
    _0xcb4474[_0xc1f05d(546)](), _0xcb4474[_0xc1f05d(482)] = _0xc1f05d(386);
    const _0x51c113 = _0xcb4474[_0xc1f05d(900)](_0xb5e2ce)[_0xc1f05d(497)], _0x547d8c = Math["min"](_0x51c113 + 2 * pe2, it2);
    Wi2(_0xcb4474, { "height": Q, "radius": 4, "width": _0x547d8c, "fill": _0x453c86 }), _0xcb4474[_0xc1f05d(356)] = _0xc1f05d(508);
    const _0x309d2f = pe2, _0x2d2ea1 = Q - Yi, _0x5208a1 = it2 - 2 * pe2;
    if (_0x51c113 > _0x5208a1) {
      let _0x2df196 = "", _0x53d66c = 0;
      for (const _0x36e979 of _0xb5e2ce) {
        const _0x61efef = _0xcb4474[_0xc1f05d(900)](_0x36e979)[_0xc1f05d(497)];
        if (_0x53d66c + _0x61efef <= _0x5208a1 - _0xcb4474[_0xc1f05d(900)]("...")[_0xc1f05d(497)]) _0x2df196 += _0x36e979, _0x53d66c += _0x61efef;
        else {
          _0x2df196 += _0xc1f05d(829);
          break;
        }
      }
      _0xcb4474[_0xc1f05d(381)](_0x2df196, _0x309d2f, _0x2d2ea1);
    } else _0xcb4474[_0xc1f05d(381)](_0xb5e2ce, _0x309d2f, _0x2d2ea1);
    _0xcb4474[_0xc1f05d(603)]();
  }
  [_0x59d238(698)](_0x2718a0) {
    const _0x2ba5ac = _0x59d238;
    _me[_0x2ba5ac(354)](_0x2718a0, this);
  }
};
var Oe = "collab-text-anchor-";
var Vi = _0x59d238(847);
var ji = _0x59d238(435);
var z2 = 6;
var Xi = 1.5;
var Te = 4;
var Gi2 = 1.5;
var Ki = _0x59d238(887);
var nt3 = class {
  constructor(_0x8cf2cb, _0x5f4b6b, _0x20c04c, _0x1cec9e) {
    const _0x264449 = _0x59d238;
    l(this, _0x264449(754), []), l(this, "_anchor", null), l(this, "_textBubble", null), l(this, _0x264449(880), null), l(this, _0x264449(604), null), l(this, _0x264449(378), null), this[_0x264449(531)] = _0x8cf2cb, this["_scene"] = _0x5f4b6b, this[_0x264449(517)] = _0x20c04c, this[_0x264449(469)] = _0x1cec9e, this[_0x264449(511)]();
  }
  set [_0x59d238(377)](_0x2c801d) {
    const _0x3359c4 = _0x59d238;
    _0x2c801d ? (this[_0x3359c4(880)] && this[_0x3359c4(880)]["hide"](), this[_0x3359c4(654)] && this[_0x3359c4(654)][_0x3359c4(650)]()) : (this[_0x3359c4(880)] && this[_0x3359c4(880)]["show"](), this[_0x3359c4(654)] && this[_0x3359c4(654)][_0x3359c4(383)]());
  }
  ["dispose"]() {
    const _0x2df982 = _0x59d238;
    for (const _0x42b600 of this[_0x2df982(754)]) _0x42b600[_0x2df982(387)]();
    this[_0x2df982(654)] && this[_0x2df982(654)][_0x2df982(387)](), this[_0x2df982(880)] && this[_0x2df982(880)][_0x2df982(387)](), this[_0x2df982(770)] && this[_0x2df982(770)]["dispose"](), this[_0x2df982(378)] && this[_0x2df982(378)]();
  }
  [_0x59d238(511)]() {
    const _0x13064d = _0x59d238;
    var _0x48692e;
    const { _docSkeleton: _0x23706b, _document: _0x3f1f78 } = this, { color: _0x1a620d, name: _0x30a36a, ranges: _0x1f6bde } = this[_0x13064d(531)], _0x47cf96 = _0x3f1f78["getOffsetConfig"](), { docsLeft: _0x4196d7, docsTop: _0x6c854b } = _0x47cf96, _0x2c8c00 = new It2(_0x47cf96, _0x23706b);
    for (const { startOffset: _0x3209f4, endOffset: _0x26da37, rangeType: _0x48b663, segmentId: _0x56146f, segmentPage: _0x4b13cf, collapsed: _0xdbed70, isActive: _0x3a0e8e } of _0x1f6bde) {
      const _0x3db2ef = _0x23706b["findNodePositionByCharIndex"](_0x3209f4, true, _0x56146f, _0x4b13cf);
      let _0x1c241c = _0x23706b[_0x13064d(846)](_0x26da37, true, _0x56146f, _0x4b13cf);
      if (_0x1c241c == null && (_0x1c241c = _0x23706b[_0x13064d(846)](_0x26da37 - 1, false, _0x56146f, _0x4b13cf)), _0x3a0e8e) {
        const { contentBoxPointGroup: _0x4836dc } = _0x2c8c00[_0x13064d(422)](_0x1c241c, _0x1c241c);
        if (_0x4836dc["length"] === 0) continue;
        this["_drawAnchor"](_0x1a620d, _0x4836dc, _0x4196d7, _0x6c854b, _0x30a36a), this[_0x13064d(378)] = this[_0x13064d(647)]();
      }
      if (_0x3db2ef && _0x1c241c) {
        if (_0x48b663 === jg["RECT"]) {
          const _0x48e892 = new ka(_0x47cf96, _0x23706b), { pointGroup: _0x348ab0 } = (_0x48692e = _0x48e892[_0x13064d(422)](_0x3db2ef, _0x1c241c)) != null ? _0x48692e : {};
          if (_0x348ab0 == null || _0x348ab0[_0x13064d(371)] === 0) continue;
          this[_0x13064d(870)](_0x1a620d, _0x348ab0, _0x4196d7, _0x6c854b);
        } else {
          if (!_0xdbed70) {
            const { borderBoxPointGroup: _0x11b5a4 } = _0x2c8c00[_0x13064d(422)](_0x3db2ef, _0x1c241c);
            if (_0x11b5a4[_0x13064d(371)] === 0) continue;
            this[_0x13064d(617)](_0x1a620d, _0x11b5a4, _0x4196d7, _0x6c854b);
          }
        }
      }
    }
  }
  [_0x59d238(397)](_0x10e633, _0x2d4eef, _0x650971, _0x3ee90d, _0x51a9f0) {
    const _0x1135f3 = _0x59d238, _0x416e0c = this[_0x1135f3(547)](_0x2d4eef), { left: _0x1662d1, top: _0x2588bb, height: _0x39fe26 } = _0x416e0c, _0x53dbc2 = this["_getScale"](), _0x5e8a69 = Gi2 / _0x53dbc2, _0x21b681 = new I1(Oe + et(z2), { "left": _0x1662d1 + _0x650971 - _0x5e8a69, "top": _0x2588bb + _0x3ee90d, "height": _0x39fe26, "width": Xi, "fill": _0x10e633 || M2(Ua[_0x1135f3(487)], 0), "strokeWidth": _0x5e8a69, "stroke": Ki, "evented": true });
    this[_0x1135f3(770)] = _0x21b681, this[_0x1135f3(567)][_0x1135f3(741)](_0x21b681, mr);
    const _0x1663f6 = new I1(Oe + et(z2), { "left": _0x1662d1 + _0x650971 - _0x5e8a69, "top": _0x2588bb + _0x3ee90d - Te / 2, "height": Te, "width": Te, "fill": _0x10e633 || M2(Ua[_0x1135f3(487)], 0), "strokeWidth": 0, "stroke": _0x10e633 || M2(Ua["black"], 0), "evented": false });
    this["_anchorDot"] = _0x1663f6, this[_0x1135f3(567)][_0x1135f3(741)](_0x1663f6, mr);
    const _0x3f616b = new me3(Oe + et(z2), { "left": _0x1662d1 + _0x650971 - _0x5e8a69, "top": _0x2588bb + _0x3ee90d - Q, "text": _0x51a9f0, "color": _0x10e633 });
    this[_0x1135f3(654)] = _0x3f616b, this["_scene"]["addObject"](_0x3f616b, mr), this[_0x1135f3(377)] = false;
  }
  ["_handleHover"]() {
    const _0x325b97 = _0x59d238, _0x2c31e6 = this[_0x325b97(770)][_0x325b97(655)][_0x325b97(393)](() => {
      const _0x4898df = _0x325b97;
      this[_0x4898df(377)] = true;
    }), _0x5cc1b7 = this[_0x325b97(770)]["onPointerLeave$"]["subscribeEvent"](() => {
      const _0x21ca4c = _0x325b97;
      this[_0x21ca4c(604)] && clearTimeout(this[_0x21ca4c(604)]), this[_0x21ca4c(604)] = setTimeout(() => {
        const _0x5ec682 = _0x21ca4c;
        this[_0x5ec682(377)] = false;
      }, 2e3);
    });
    return () => {
      const _0x164b01 = _0x325b97;
      _0x2c31e6[_0x164b01(374)](), _0x5cc1b7["unsubscribe"]();
    };
  }
  [_0x59d238(617)](_0x54f295, _0x5ab534, _0x2434be, _0x49e3a3) {
    const _0x56f26e = _0x59d238, _0x4167e5 = new bt(_0x54f295)[_0x56f26e(591)](0.2)[_0x56f26e(851)](), _0x2b49dc = new O3(Vi + et(z2), { "pointsGroup": _0x5ab534, "fill": _0x4167e5 || M2(Ua[_0x56f26e(487)], 0.2), "left": _0x2434be, "top": _0x49e3a3, "evented": false, "debounceParentDirty": false });
    this["_shapes"][_0x56f26e(565)](_0x2b49dc), this[_0x56f26e(567)][_0x56f26e(741)](_0x2b49dc, mr);
  }
  [_0x59d238(870)](_0x4c17a, _0x483f44, _0x340973, _0x17e4be) {
    const _0x51b9c4 = _0x59d238, _0x4c1721 = new bt(_0x4c17a)[_0x51b9c4(591)](0.2)["toRgbString"](), _0x1b4896 = new O3(ji + et(z2), { "pointsGroup": _0x483f44, "fill": _0x4c1721 || M2(Ua["black"], 0.2), "left": _0x340973, "top": _0x17e4be, "evented": false, "debounceParentDirty": false });
    this["_shapes"][_0x51b9c4(565)](_0x1b4896), this["_scene"][_0x51b9c4(741)](_0x1b4896, mr);
  }
  ["_getAnchorBounding"](_0x32d1b4) {
    const _0x1a9370 = _0x32d1b4[0], _0xb9d2f5 = _0x1a9370[0], _0x6c7acd = _0x1a9370[2], { x: _0x2a77f5, y: _0x1fdbaf } = _0xb9d2f5, { x: _0x4f4a17, y: _0x8fcffb } = _0x6c7acd;
    return { "left": _0x2a77f5, "top": _0x1fdbaf, "width": _0x4f4a17 - _0x2a77f5, "height": _0x8fcffb - _0x1fdbaf };
  }
  [_0x59d238(449)]() {
    const _0x2fd2ec = _0x59d238, { scaleX: _0x39d2a8, scaleY: _0x5cdedc } = this[_0x2fd2ec(567)][_0x2fd2ec(842)]();
    return Math[_0x2fd2ec(729)](_0x39d2a8, _0x5cdedc);
  }
};
var zi = Object["getOwnPropertyDescriptor"];
var Ji = (_0xf6409c, _0x558cd5, _0x55c2ff, _0x37d21a) => {
  const _0x539b0b = _0x59d238;
  for (var _0x44f30f = _0x37d21a > 1 ? void 0 : _0x37d21a ? zi(_0x558cd5, _0x55c2ff) : _0x558cd5, _0x838576 = _0xf6409c[_0x539b0b(371)] - 1, _0xca73c1; _0x838576 >= 0; _0x838576--) (_0xca73c1 = _0xf6409c[_0x838576]) && (_0x44f30f = _0xca73c1(_0x44f30f) || _0x44f30f);
  return _0x44f30f;
};
var ie4 = (_0x33b2e2, _0x5060b8) => (_0x53ba26, _0x866af9) => _0x5060b8(_0x53ba26, _0x866af9, _0x33b2e2);
var ye = class extends h1 {
  constructor(_0x3409a2, _0x415be5, _0x3c2dd9, _0x28b3b0, _0x638552) {
    const _0x432889 = _0x59d238;
    super(), l(this, _0x432889(524), []), l(this, _0x432889(921), []), this[_0x432889(649)] = _0x3409a2, this["_docSkeletonManagerService"] = _0x415be5, this[_0x432889(427)] = _0x3c2dd9, this["_commandService"] = _0x28b3b0, this[_0x432889(623)] = _0x638552, this["_init"]();
  }
  [_0x59d238(596)]() {
    const _0x38359b = _0x59d238, _0x1961dd = this["_context"][_0x38359b(413)], _0x45dcf1 = this["_docSkeletonManagerService"];
    this[_0x38359b(621)](combineLatest([this["_collabCursorController"][_0x38359b(391)](_0x1961dd), this[_0x38359b(623)][_0x38359b(485)]])[_0x38359b(359)](map(([_0x3cebb3, _0x2ec83e]) => ({ "skeleton": _0x45dcf1["getSkeleton"](), "cursors": [..._0x3cebb3[_0x38359b(624)]()]["flatMap"]((_0x47ce44) => ({ ..._0x47ce44, "color": this[_0x38359b(623)][_0x38359b(376)](_0x47ce44[_0x38359b(786)]) })) })))["subscribe"]((_0x1840cd) => {
      const _0x1e30d5 = _0x38359b;
      if (this[_0x1e30d5(909)](), _0x1840cd) {
        const { skeleton: _0x18675f, cursors: _0x5e7b93 } = _0x1840cd;
        this[_0x1e30d5(415)](_0x18675f, _0x5e7b93);
      }
    })), this[_0x38359b(692)](), this[_0x38359b(390)]();
  }
  ["_updateCollabCursors"](_0x1441de, _0x3428ae) {
    const _0x51a0c1 = _0x59d238, { scene: _0x2c49de, mainComponent: _0x35929e } = this[_0x51a0c1(649)], _0x41b48a = _0x3428ae[_0x51a0c1(711)]((_0x1f09a1) => new nt3(_0x1f09a1, _0x2c49de, _0x1441de, _0x35929e));
    this[_0x51a0c1(524)] = _0x41b48a, this["_cursors"] = _0x3428ae;
  }
  [_0x59d238(899)]() {
    const _0x66905d = _0x59d238;
    this[_0x66905d(909)]();
    const { scene: _0x4b92f2, mainComponent: _0x51a223 } = this[_0x66905d(649)], _0x1b863e = this[_0x66905d(811)]["getSkeleton"](), _0x5f6e36 = this[_0x66905d(921)]["map"]((_0x48d9b8) => new nt3(_0x48d9b8, _0x4b92f2, _0x1b863e, _0x51a223));
    this[_0x66905d(524)] = _0x5f6e36;
  }
  [_0x59d238(909)]() {
    const _0x148b2f = _0x59d238;
    this[_0x148b2f(524)][_0x148b2f(450)]((_0x5021b1) => _0x5021b1[_0x148b2f(387)]()), this[_0x148b2f(524)] = [];
  }
  [_0x59d238(390)]() {
    const _0x52a74a = _0x59d238, _0x24c925 = [tt["id"]];
    this["disposeWithMe"](this[_0x52a74a(772)][_0x52a74a(424)]((_0x583c86) => {
      const _0x52eab8 = _0x52a74a;
      _0x24c925[_0x52eab8(637)](_0x583c86["id"]) && _0x583c86["params"][_0x52eab8(413)] === this[_0x52eab8(649)]["unitId"] && this[_0x52eab8(899)]();
    }));
  }
  [_0x59d238(692)]() {
    const _0x3898ae = _0x59d238;
    this[_0x3898ae(621)](TR(this[_0x3898ae(649)]["engine"][_0x3898ae(858)])[_0x3898ae(359)](filter((_0x3284bb) => _0x3284bb[_0x3898ae(557)] === x1[_0x3898ae(888)]), throttleTime(16))["subscribe"](() => {
      const _0x1dbd0c = _0x3898ae;
      this[_0x1dbd0c(899)]();
    }));
  }
};
ye = Ji([ie4(1, Inject(D)), ie4(2, Inject(H)), ie4(3, Ls), ie4(4, Inject(Gi))], ye);
var Zi = 1;
var Qi = 1.5;
var qi = class extends x3 {
  constructor(_0x4a89db, _0x28ee43) {
    const _0x5e95bc = _0x59d238;
    super(_0x4a89db, _0x28ee43), l(this, _0x5e95bc(751)), l(this, _0x5e95bc(876), false), l(this, _0x5e95bc(775)), l(this, "_name", ""), l(this, "_labelPosition", _0x5e95bc(392)), l(this, "_backgroundColor"), _0x28ee43 && this["setShapeProps"](_0x28ee43), this["onPointerEnter$"][_0x5e95bc(393)](() => this[_0x5e95bc(500)]({ "hovered": true })), this[_0x5e95bc(861)][_0x5e95bc(393)](() => this[_0x5e95bc(500)]({ "hovered": false }));
  }
  [_0x59d238(500)](_0x326db7) {
    const _0x11b525 = _0x59d238;
    var _0x58668c, _0x1a7df0, _0x3c8d11, _0x832e10, _0x1693a9, _0x44b7f0;
    this[_0x11b525(751)] = (_0x58668c = _0x326db7["color"]) != null ? _0x58668c : this[_0x11b525(751)], this[_0x11b525(876)] = (_0x1a7df0 = _0x326db7["hovered"]) != null ? _0x1a7df0 : this["_hovered"], this["_range"] = (_0x3c8d11 = _0x326db7[_0x11b525(826)]) != null ? _0x3c8d11 : this[_0x11b525(775)], this[_0x11b525(778)] = (_0x832e10 = _0x326db7[_0x11b525(606)]) != null ? _0x832e10 : this["_name"], this["_labelPosition"] = (_0x1693a9 = _0x326db7[_0x11b525(555)]) != null ? _0x1693a9 : this[_0x11b525(525)], this[_0x11b525(642)] = (_0x44b7f0 = _0x326db7[_0x11b525(551)]) != null ? _0x44b7f0 : this[_0x11b525(642)], this["transformByState"]({ "width": _0x326db7[_0x11b525(497)], "height": _0x326db7[_0x11b525(809)] });
  }
  [_0x59d238(550)](_0x2c1382) {
    const _0x3436db = _0x59d238, { row: _0x279029, column: _0x3fdafc } = _0x2c1382;
    if (_0x279029 >= this[_0x3436db(775)][_0x3436db(734)] && _0x279029 <= this[_0x3436db(775)][_0x3436db(717)] && _0x3fdafc >= this[_0x3436db(775)]["startColumn"] && _0x3fdafc <= this[_0x3436db(775)]["endColumn"]) {
      this["setShapeProps"]({ "hovered": true });
      return;
    }
    this[_0x3436db(500)]({ "hovered": false });
  }
  [_0x59d238(747)](_0xe425c1) {
    return false;
  }
  ["_draw"](_0x4613ef) {
    const _0x39205b = _0x59d238;
    I1[_0x39205b(354)](_0x4613ef, { "width": this[_0x39205b(497)], "height": this[_0x39205b(809)], "strokeWidth": Qi, "stroke": this[_0x39205b(751)], "evented": false, "fill": this[_0x39205b(642)] }), this["_hovered"] && (_0x4613ef["save"](), _0x4613ef["transform"](1, 0, 0, 1, this[_0x39205b(497)], this[_0x39205b(525)] === _0x39205b(438) ? 0 : -Q), me3[_0x39205b(354)](_0x4613ef, { "text": this[_0x39205b(778)], "color": this["_color"] }), _0x4613ef[_0x39205b(603)]());
  }
};
var en2 = Object["getOwnPropertyDescriptor"];
var tn = (_0x488d55, _0x31ed1e, _0x33b398, _0x265a33) => {
  for (var _0x114a8f = _0x265a33 > 1 ? void 0 : _0x265a33 ? en2(_0x31ed1e, _0x33b398) : _0x31ed1e, _0x161d4f = _0x488d55["length"] - 1, _0x34a940; _0x161d4f >= 0; _0x161d4f--) (_0x34a940 = _0x488d55[_0x161d4f]) && (_0x114a8f = _0x34a940(_0x114a8f) || _0x114a8f);
  return _0x114a8f;
};
var Ce = (_0x213f85, _0x5ebc6a) => (_0x494081, _0x529d55) => _0x5ebc6a(_0x494081, _0x529d55, _0x213f85);
var sn = 5001;
var $e = class extends h1 {
  constructor(_0x3b02a5, _0x460807, _0x180f50, _0x317baa) {
    const _0x268743 = _0x59d238;
    super(), l(this, _0x268743(921), /* @__PURE__ */ new Set()), l(this, _0x268743(484), null), this[_0x268743(649)] = _0x3b02a5, this[_0x268743(882)] = _0x460807, this[_0x268743(427)] = _0x180f50, this[_0x268743(623)] = _0x317baa, this["_init"]();
  }
  ["_init"]() {
    const _0x50c4d0 = _0x59d238;
    this[_0x50c4d0(882)][_0x50c4d0(808)]["pipe"](takeUntil(this[_0x50c4d0(447)]), switchMap((_0x53eebf) => {
      const _0x5b0e66 = _0x50c4d0;
      if (_0x53eebf) {
        const _0x51ee76 = _0x53eebf[_0x5b0e66(867)];
        return combineLatest(this[_0x5b0e66(427)]["getCollabCursors$"](this[_0x5b0e66(649)]["unitId"]), this["_themeService"]["currentTheme$"])[_0x5b0e66(359)](map(([_0x479415, _0x1f7244]) => {
          const _0xfe3271 = _0x5b0e66, _0x3b19ae = /* @__PURE__ */ new Map();
          return _0x479415[_0xfe3271(450)]((_0x7021e6, _0x384647) => {
            const _0x297a77 = _0xfe3271;
            if (_0x7021e6["sheetID"] === _0x51ee76) {
              const _0x2fbce8 = { ..._0x7021e6 };
              _0x2fbce8[_0x297a77(786)] = this[_0x297a77(623)][_0x297a77(376)](_0x7021e6[_0x297a77(786)]), _0x3b19ae[_0x297a77(727)](_0x384647, _0x2fbce8);
            }
          }), { "skeleton": _0x53eebf, "cursors": _0x3b19ae };
        }));
      }
      return of({ "skeleton": null, "cursors": /* @__PURE__ */ new Map() });
    }))[_0x50c4d0(369)](({ skeleton: _0x537c91, cursors: _0x1dea6c }) => {
      const _0x2feddf = _0x50c4d0;
      this[_0x2feddf(909)](), _0x537c91 && this[_0x2feddf(415)](_0x537c91, _0x1dea6c);
    }), this["_sheetSkeletonManagerService"][_0x50c4d0(808)][_0x50c4d0(369)]((_0x422988) => {
      const _0x220d0d = _0x50c4d0;
      if (_0x422988 == null) return;
      const { skeleton: _0x2a49d1 } = _0x422988, { scene: _0x5966db } = this[_0x220d0d(649)];
      _0x5966db["onPointerMove$"][_0x220d0d(393)](n1((_0x558b57) => {
        const _0x48270f = _0x220d0d;
        var _0x1ca14b, _0x459a1c;
        const { offsetX: _0x4aa052, offsetY: _0xea7fa6 } = _0x558b57, { x: _0x46c20a, y: _0x232e07 } = _0x5966db["getRelativeToViewportCoord"](U[_0x48270f(646)]([_0x4aa052, _0xea7fa6])), { scaleX: _0x4bed93, scaleY: _0xd60259 } = _0x5966db["getAncestorScale"](), _0x15ae2e = _0x5966db[_0x48270f(694)](k2["VIEW_MAIN"]), _0x1aa04f = _0x5966db[_0x48270f(738)](U[_0x48270f(646)]([_0x46c20a, _0x232e07]), _0x15ae2e), _0x4c36ff = _0x2a49d1[_0x48270f(568)](_0x4aa052, _0xea7fa6, _0x4bed93, _0xd60259, _0x1aa04f);
        ((_0x1ca14b = this[_0x48270f(484)]) == null ? void 0 : _0x1ca14b[_0x48270f(643)]) === _0x4c36ff["column"] && ((_0x459a1c = this[_0x48270f(484)]) == null ? void 0 : _0x459a1c["row"]) === _0x4c36ff[_0x48270f(505)] || this[_0x48270f(921)][_0x48270f(450)]((_0x16286c) => {
          const _0x30deeb = _0x48270f;
          _0x16286c[_0x30deeb(550)](_0x4c36ff);
        });
      }, 100));
    });
  }
  [_0x59d238(415)](_0x2455ba, _0xe89d1c) {
    const _0x58bfbf = _0x59d238;
    var _0x1918df;
    const _0x3621e8 = (_0x1918df = this["_sheetSkeletonManagerService"][_0x58bfbf(523)]()) == null ? void 0 : _0x1918df[_0x58bfbf(610)];
    if (!_0x3621e8) return;
    const _0x457d35 = this[_0x58bfbf(495)]();
    if (!_0x457d35) return;
    this[_0x58bfbf(921)][_0x58bfbf(450)]((_0x5e06cd) => {
      const _0x5e181a = _0x58bfbf;
      _0x5e06cd[_0x5e181a(631)]();
    });
    const { scene: _0x282612 } = _0x457d35, _0xc18c37 = nn(Array[_0x58bfbf(740)](_0xe89d1c[_0x58bfbf(624)]()))["map"]((_0x25190b) => {
      const _0x403f71 = _0x58bfbf, { color: _0x42ab6b, range: _0x95e007, name: _0x335785, selection: _0x3084af, sheetID: _0xbf89d4 } = _0x25190b, { startColumn: _0x52a408, startRow: _0x28f54a, endColumn: _0x4466d9, endRow: _0x42017f } = _0x95e007, _0x322be2 = lh(_0x28f54a, _0x52a408, _0x282612, _0x3621e8), _0x4019e0 = lh(_0x42017f, _0x4466d9, _0x282612, _0x3621e8), { columnHeaderHeightAndMarginTop: _0x466a24 } = _0x3621e8, { startX: _0x375e2a, startY: _0x427084 } = _0x322be2, { endX: _0x5275d1, endY: _0x30c0cb } = _0x4019e0, _0xbd31a0 = _0x5275d1 - _0x375e2a, _0xcfaf7f = _0x30c0cb - _0x427084, _0x4e31fa = { "labelPosition": _0x427084 - _0x466a24 >= Q ? _0x403f71(392) : "bottom", "sheetID": _0xbf89d4, "range": _0x95e007, "color": _0x42ab6b, "name": _0x335785, "selection": _0x3084af, "left": _0x375e2a, "top": _0x427084, "width": _0xbd31a0, "height": _0xcfaf7f, "evented": false, "zIndex": sn };
      return new qi(_0x335785, _0x4e31fa);
    });
    _0x282612[_0x58bfbf(477)](_0xc18c37, Zi), this["_cursors"] = new Set(_0xc18c37);
  }
  [_0x59d238(909)]() {
    const _0x575889 = _0x59d238;
    var _0x5854d7;
    (_0x5854d7 = this[_0x575889(921)]) == null || _0x5854d7[_0x575889(450)]((_0x18e7d3) => _0x18e7d3[_0x575889(387)]());
  }
  [_0x59d238(495)]() {
    const _0x4eb26e = _0x59d238;
    return en(this[_0x4eb26e(649)][_0x4eb26e(575)], this[_0x4eb26e(649)]);
  }
};
$e = tn([Ce(1, Inject(ue)), Ce(2, Inject(H)), Ce(3, Inject(Gi))], $e);
function nn(_0x5c8a10) {
  const _0x1cd0be = _0x59d238, _0x2ba19b = /* @__PURE__ */ new Map();
  return _0x5c8a10[_0x1cd0be(450)]((_0x5634b1) => {
    const _0x5d7f39 = _0x1cd0be;
    if (_0x2ba19b[_0x5d7f39(779)](_0x5634b1[_0x5d7f39(503)])) {
      const _0x429026 = _0x2ba19b[_0x5d7f39(436)](_0x5634b1["selection"]);
      _0x429026[_0x5d7f39(606)] += ", " + _0x5634b1[_0x5d7f39(606)];
    } else _0x2ba19b[_0x5d7f39(727)](_0x5634b1[_0x5d7f39(503)], _0x5634b1);
  }), Array[_0x1cd0be(740)](_0x2ba19b[_0x1cd0be(624)]());
}
var rn = Object[_0x59d238(670)];
var on = (_0x2b360b, _0x3b3395, _0x394cdb, _0x23cbeb) => {
  const _0x53be82 = _0x59d238;
  for (var _0x24769a = _0x23cbeb > 1 ? void 0 : _0x23cbeb ? rn(_0x3b3395, _0x394cdb) : _0x3b3395, _0x33af5c = _0x2b360b[_0x53be82(371)] - 1, _0x4aa56b; _0x33af5c >= 0; _0x33af5c--) (_0x4aa56b = _0x2b360b[_0x33af5c]) && (_0x24769a = _0x4aa56b(_0x24769a) || _0x24769a);
  return _0x24769a;
};
var F = (_0x1e77d1, _0x48610e) => (_0x5dc22e, _0x4361b4) => _0x48610e(_0x5dc22e, _0x4361b4, _0x1e77d1);
var ce2 = class extends Ve {
  constructor(_0x32beeb, _0x95560, _0x518a06, _0x5cb6e0, _0xff9602, _0x1bb5e) {
    const _0x177f7c = _0x59d238;
    super(), this[_0x177f7c(666)] = _0x32beeb, this["_localCacheService"] = _0x95560, this[_0x177f7c(538)] = _0x518a06, this[_0x177f7c(891)] = _0x5cb6e0, this["_notificationService"] = _0xff9602, this[_0x177f7c(661)] = _0x1bb5e, this[_0x177f7c(707)](), this[_0x177f7c(429)]();
  }
  [_0x59d238(707)]() {
    const _0x4a7420 = _0x59d238;
    this["disposeWithMe"](this[_0x4a7420(666)][_0x4a7420(776)](() => {
      const _0x5992ce = _0x4a7420;
      if (this["_localCacheService"][_0x5992ce(601)][_0x5992ce(507)]) return this[_0x5992ce(661)]["t"](_0x5992ce(480));
    }));
  }
  [_0x59d238(429)]() {
    const _0x5d7d94 = _0x59d238;
    this["disposeWithMe"](this[_0x5d7d94(538)][_0x5d7d94(873)][_0x5d7d94(369)]((_0x27a379) => {
      const _0x58c736 = _0x5d7d94;
      _0x27a379["id"] === re[_0x58c736(465)] && this[_0x58c736(891)][_0x58c736(650)]({ "type": $C[_0x58c736(821)], "content": this[_0x58c736(661)]["t"](_0x58c736(375)) }), _0x27a379["id"] === re[_0x58c736(560)] && this[_0x58c736(891)][_0x58c736(650)]({ "type": $C["Warning"], "content": this[_0x58c736(661)]["t"](_0x58c736(875)) }), _0x27a379["id"] === re[_0x58c736(706)] && this[_0x58c736(782)]["show"]({ "title": this["_localeService"]["t"](_0x58c736(615)), "content": this[_0x58c736(661)]["t"](_0x58c736(817)), "type": "error", "duration": 0 }), _0x27a379["id"] === re["CONFLICT"] && this[_0x58c736(891)]["show"]({ "type": $C[_0x58c736(667)], "content": this[_0x58c736(661)]["t"](_0x58c736(875)) + "(" + _0x27a379["data"] + ")" }), _0x27a379["id"] === re[_0x58c736(483)] && this["_messageService"]["show"]({ "type": $C[_0x58c736(821)], "content": this[_0x58c736(661)]["t"](_0x27a379[_0x58c736(651)] || "") }), _0x27a379["id"] === re[_0x58c736(433)] && this[_0x58c736(891)][_0x58c736(650)]({ "type": $C[_0x58c736(821)], "content": this["_localeService"]["t"](_0x58c736(791)) }), _0x27a379["id"] === re[_0x58c736(384)] && this[_0x58c736(891)][_0x58c736(650)]({ "type": $C[_0x58c736(667)], "content": this[_0x58c736(661)]["t"](_0x58c736(609)) }), _0x27a379["id"] === re[_0x58c736(737)] && this[_0x58c736(891)][_0x58c736(650)]({ "type": $C["Error"], "content": this[_0x58c736(661)]["t"](_0x58c736(595)) });
    }));
  }
};
ce2 = on([F(0, ir), F(1, J3), F(2, Inject(ve)), F(3, et2), F(4, u3), F(5, Inject(Fn))], ce2);
var an = _0x59d238(760);
var rt = {};
var cn = Object["getOwnPropertyDescriptor"];
var _n2 = (_0x4715ca, _0x39b637, _0x964c9a, _0x1955c0) => {
  const _0x4ea024 = _0x59d238;
  for (var _0x3bd760 = _0x1955c0 > 1 ? void 0 : _0x1955c0 ? cn(_0x39b637, _0x964c9a) : _0x39b637, _0x2ec656 = _0x4715ca[_0x4ea024(371)] - 1, _0x4d0459; _0x2ec656 >= 0; _0x2ec656--) (_0x4d0459 = _0x4715ca[_0x2ec656]) && (_0x3bd760 = _0x4d0459(_0x3bd760) || _0x3bd760);
  return _0x3bd760;
};
var ot3 = (_0x5f39b3, _0x200c39) => (_0x5815c8, _0x1c0fc3) => _0x200c39(_0x5815c8, _0x1c0fc3, _0x5f39b3);
var _e = class {
  constructor(_0x199827, _0x49449e) {
    const _0x48067f = _0x59d238;
    this[_0x48067f(448)] = _0x199827, this[_0x48067f(431)] = _0x49449e;
  }
  ["transformIMECache"](_0x1c4224) {
    const _0x3486bb = _0x59d238;
    this[_0x3486bb(554)](_0x1c4224), this[_0x3486bb(780)](_0x1c4224);
  }
  ["transformRemoteChangeset"](_0x23bb52) {
    const _0x412348 = _0x59d238, { unitID: _0x5f324f } = _0x23bb52, _0x318514 = this[_0x412348(431)]["getRenderById"](_0x5f324f)[_0x412348(784)](No), { redoCache: _0x16b76a } = _0x318514[_0x412348(691)]();
    if (_0x16b76a[_0x412348(371)] === 0) return _0x23bb52;
    let _0x4fb215 = J[_0x412348(892)](_0x23bb52["mutations"][0]);
    for (let _0x35fd91 = 0; _0x35fd91 < _0x16b76a["length"]; _0x35fd91++) {
      const _0x46a3a3 = { "id": _0x412348(472), "params": { ..._0x16b76a[_0x35fd91] } }, _0x51e4cc = this[_0x412348(448)][_0x412348(401)](_0x4fb215, _0x46a3a3, false);
      if (ce(_0x51e4cc)) throw _0x51e4cc[_0x412348(883)];
      _0x4fb215 = _0x51e4cc[_0x412348(582)];
    }
    return { ...J[_0x412348(892)](_0x23bb52), "mutations": [_0x4fb215] };
  }
  [_0x59d238(554)](_0x15c39d) {
    const _0x368dd5 = _0x59d238, { unitID: _0x118968 } = _0x15c39d, _0x455320 = this["_renderManagerService"][_0x368dd5(812)](_0x118968)["with"](No), { undoCache: _0x27990b, redoCache: _0x486159 } = _0x455320[_0x368dd5(691)]();
    if (_0x27990b[_0x368dd5(371)] === 0 || _0x486159["length"] === 0) return;
    const _0x2d9e9e = [], _0x287b19 = [];
    let _0x3017a8 = J[_0x368dd5(892)](_0x15c39d[_0x368dd5(408)][0]), _0x2f6df3 = J[_0x368dd5(892)](_0x15c39d[_0x368dd5(408)][0]);
    for (let _0x15167e = _0x27990b[_0x368dd5(371)] - 1; _0x15167e >= 0; _0x15167e--) {
      const _0x48bf39 = { "id": "doc.mutation.rich-text-editing", "params": { ..._0x27990b[_0x15167e] } }, _0x331256 = { "id": _0x368dd5(472), "params": { ..._0x486159[_0x15167e] } }, _0x3640ac = this["_transformService"][_0x368dd5(401)](_0x3017a8, _0x48bf39, false), _0x4234de = this[_0x368dd5(448)][_0x368dd5(401)](_0x2f6df3, _0x331256, false);
      if (ce(_0x3640ac)) throw _0x3640ac[_0x368dd5(883)];
      if (ce(_0x4234de)) throw _0x4234de[_0x368dd5(883)];
      _0x2d9e9e[_0x368dd5(765)](_0x3640ac[_0x368dd5(656)]["params"]), _0x287b19["unshift"](_0x4234de["m2Prime"][_0x368dd5(425)]), _0x3017a8 = _0x3640ac["m1Prime"], _0x2f6df3 = _0x4234de[_0x368dd5(582)];
    }
    _0x455320[_0x368dd5(584)]({ "undoCache": _0x2d9e9e, "redoCache": _0x287b19 });
  }
  [_0x59d238(780)](_0x27635b) {
    const _0x32b05f = _0x59d238, { unitID: _0x160870 } = _0x27635b, _0x5a7e4f = this[_0x32b05f(431)]["getRenderById"](_0x160870)[_0x32b05f(784)](No), _0x43b773 = _0x5a7e4f["getActiveRange"]();
    if (_0x43b773 == null) return;
    const _0x4223d0 = [{ "id": _0x32b05f(472), "params": { "unitId": _0x27635b[_0x32b05f(446)], "actions": null, "textRanges": [_0x43b773] } }], _0x515f03 = this["_transformService"][_0x32b05f(664)](_0x27635b, _0x4223d0);
    if (!hd(_0x515f03)) throw _0x515f03["error"];
    const _0x5f57b6 = _0x515f03[_0x32b05f(656)][0][_0x32b05f(425)][_0x32b05f(457)];
    Array[_0x32b05f(423)](_0x5f57b6) && _0x5f57b6[_0x32b05f(371)] && _0x5a7e4f[_0x32b05f(367)](_0x5f57b6[0]);
  }
};
_e = _n2([ot3(0, Pe2), ot3(1, ME)], _e);
var ln = Object[_0x59d238(670)];
var hn2 = (_0x423051, _0x419738, _0x5cecfb, _0x549e2d) => {
  for (var _0x830bf0 = _0x549e2d > 1 ? void 0 : _0x549e2d ? ln(_0x419738, _0x5cecfb) : _0x419738, _0x312418 = _0x423051["length"] - 1, _0x36ad17; _0x312418 >= 0; _0x312418--) (_0x36ad17 = _0x423051[_0x312418]) && (_0x830bf0 = _0x36ad17(_0x830bf0) || _0x830bf0);
  return _0x830bf0;
};
var Re2 = (_0x47d098, _0x3dcb6e) => (_0x36393c, _0x59acb4) => _0x3dcb6e(_0x36393c, _0x59acb4, _0x47d098);
var le2 = class {
  constructor(_0x44e3fa, _0x3246e0, _0x46796c) {
    const _0x3d191f = _0x59d238;
    this[_0x3d191f(571)] = _0x44e3fa, this[_0x3d191f(448)] = _0x3246e0, this[_0x3d191f(613)] = _0x46796c;
  }
  [_0x59d238(820)](_0xe68741) {
    const _0x47dd3d = _0x59d238;
    this[_0x47dd3d(728)](_0xe68741);
  }
  [_0x59d238(518)](_0x3a92c2) {
    const _0x51a5a2 = _0x59d238, { unitID: _0x56f5ad } = _0x3a92c2, { collaboration: _0x161d7e } = this[_0x51a5a2(613)][_0x51a5a2(800)](_0x56f5ad);
    if (_0x161d7e["length"] === 0) return _0x3a92c2;
    let _0x227836 = J["deepClone"](_0x3a92c2["mutations"][0]);
    for (let _0x2584d4 = 0; _0x2584d4 < _0x161d7e[_0x51a5a2(371)]; _0x2584d4++) {
      const _0xec201b = { "id": "doc.mutation.rich-text-editing", "params": { "unitId": _0x161d7e[_0x2584d4][_0x51a5a2(413)], ..._0x161d7e[_0x2584d4][_0x51a5a2(570)] } }, _0x19e8b0 = this[_0x51a5a2(448)][_0x51a5a2(401)](_0x227836, _0xec201b, false);
      if (ce(_0x19e8b0)) throw _0x19e8b0[_0x51a5a2(883)];
      _0x227836 = _0x19e8b0[_0x51a5a2(582)];
    }
    return { ...J[_0x51a5a2(892)](_0x3a92c2), "mutations": [_0x227836] };
  }
  [_0x59d238(728)](_0x39a179) {
    const _0x3c6524 = _0x59d238, { unitID: _0x21f1be } = _0x39a179, { history: _0x445b51, collaboration: _0x5b54f2 } = this[_0x3c6524(613)][_0x3c6524(800)](_0x21f1be);
    if (_0x445b51[_0x3c6524(371)] === 0 && _0x5b54f2[_0x3c6524(371)] === 0) return;
    const _0x13e899 = [], _0x53f105 = [];
    let _0x639263 = J[_0x3c6524(892)](_0x39a179[_0x3c6524(408)][0]), _0x5bdb11 = J[_0x3c6524(892)](_0x39a179[_0x3c6524(408)][0]);
    for (let _0xbb6151 = _0x445b51["length"] - 1; _0xbb6151 >= 0; _0xbb6151--) {
      const _0x3949e6 = { "id": _0x3c6524(472), "params": { "unitId": _0x445b51[_0xbb6151]["unitId"], ..._0x445b51[_0xbb6151][_0x3c6524(912)] } }, _0x274105 = { "id": _0x3c6524(472), "params": { "unitId": _0x445b51[_0xbb6151]["unitId"], ..._0x445b51[_0xbb6151][_0x3c6524(570)] } }, _0x37ae5c = this[_0x3c6524(448)][_0x3c6524(401)](_0x639263, _0x3949e6, false), _0x3bda8f = this[_0x3c6524(448)]["transformMutation"](_0x5bdb11, _0x274105, false);
      if (ce(_0x37ae5c)) throw _0x37ae5c["error"];
      if (ce(_0x3bda8f)) throw _0x3bda8f[_0x3c6524(883)];
      _0x13e899[_0x3c6524(765)]({ ..._0x445b51[_0xbb6151], "undoState": _0x37ae5c[_0x3c6524(656)][_0x3c6524(425)], "redoState": _0x3bda8f[_0x3c6524(656)]["params"] }), _0x639263 = _0x37ae5c[_0x3c6524(582)], _0x5bdb11 = _0x3bda8f["m1Prime"];
    }
    _0x639263 = J[_0x3c6524(892)](_0x39a179[_0x3c6524(408)][0]), _0x5bdb11 = J[_0x3c6524(892)](_0x39a179[_0x3c6524(408)][0]);
    for (let _0xc01855 = _0x5b54f2[_0x3c6524(371)] - 1; _0xc01855 >= 0; _0xc01855--) {
      const _0xc60ca1 = { "id": "doc.mutation.rich-text-editing", "params": { "unitId": _0x5b54f2[_0xc01855][_0x3c6524(413)], ..._0x5b54f2[_0xc01855][_0x3c6524(912)] } }, _0xb7066a = { "id": _0x3c6524(472), "params": { "unitId": _0x5b54f2[_0xc01855][_0x3c6524(413)], ..._0x5b54f2[_0xc01855][_0x3c6524(570)] } }, _0xeb15f2 = this[_0x3c6524(448)]["transformMutation"](_0x639263, _0xc60ca1, false), _0x4f7c99 = this[_0x3c6524(448)][_0x3c6524(401)](_0x5bdb11, _0xb7066a, false);
      if (ce(_0xeb15f2)) throw _0xeb15f2["error"];
      if (ce(_0x4f7c99)) throw _0x4f7c99["error"];
      _0x53f105["unshift"]({ ..._0x5b54f2[_0xc01855], "undoState": _0xeb15f2["m2Prime"]["params"], "redoState": _0x4f7c99[_0x3c6524(656)][_0x3c6524(425)] }), _0x639263 = _0xeb15f2[_0x3c6524(582)], _0x5bdb11 = _0x4f7c99[_0x3c6524(582)];
    }
    this[_0x3c6524(613)][_0x3c6524(733)](_0x21f1be, { "history": _0x13e899, "collaboration": _0x53f105 });
  }
};
le2 = hn2([Re2(0, Inject(Injector)), Re2(1, Pe2), Re2(2, Inject(Io))], le2);
var un = Object["getOwnPropertyDescriptor"];
var dn = (_0x144287, _0x50b337, _0x2338dc, _0x377292) => {
  const _0x426747 = _0x59d238;
  for (var _0x2384ba = _0x377292 > 1 ? void 0 : _0x377292 ? un(_0x50b337, _0x2338dc) : _0x50b337, _0x7c28cd = _0x144287[_0x426747(371)] - 1, _0x378450; _0x7c28cd >= 0; _0x7c28cd--) (_0x378450 = _0x144287[_0x7c28cd]) && (_0x2384ba = _0x378450(_0x2384ba) || _0x2384ba);
  return _0x2384ba;
};
var at4 = (_0x2f1641, _0x2fe8ce) => (_0x2878e7, _0x38a46c) => _0x2fe8ce(_0x2878e7, _0x38a46c, _0x2f1641);
var he2 = class {
  constructor(_0x29615e, _0x4cbb49) {
    const _0x162f9d = _0x59d238;
    this[_0x162f9d(571)] = _0x29615e, this["_transformService"] = _0x4cbb49;
  }
  ["transformSelections"](_0xdd675) {
    const _0x4dd9ba = _0x59d238;
    var _0x2a8a62;
    const _0x306b80 = this[_0x4dd9ba(571)][_0x4dd9ba(436)](m), _0x2ba74a = (_0x2a8a62 = _0x306b80[_0x4dd9ba(864)]()) != null ? _0x2a8a62 : [];
    if (_0x2ba74a[_0x4dd9ba(371)] === 0) return;
    const _0x1160b4 = _0xdd675[_0x4dd9ba(446)], _0x2db4e2 = [{ "id": "doc.mutation.rich-text-editing", "params": { "unitId": _0x1160b4, "actions": null, "textRanges": _0x2ba74a } }], _0x8eb3ae = this[_0x4dd9ba(448)][_0x4dd9ba(664)](_0xdd675, _0x2db4e2);
    if (!hd(_0x8eb3ae)) throw _0x8eb3ae[_0x4dd9ba(883)];
    const _0x32cd61 = _0x8eb3ae[_0x4dd9ba(656)][0][_0x4dd9ba(425)][_0x4dd9ba(457)];
    Array[_0x4dd9ba(423)](_0x32cd61) && _0x32cd61[_0x4dd9ba(371)] && _0x306b80["replaceDocRanges"](_0x32cd61, { "unitId": _0x1160b4, "subUnitId": _0x1160b4 }, false);
  }
};
he2 = dn([at4(0, Inject(Injector)), at4(1, Pe2)], he2);
var Sn = Object[_0x59d238(670)];
var In = (_0x38ab2e, _0x1ea82d, _0xc2c3c5, _0x498a85) => {
  const _0x54ae5b = _0x59d238;
  for (var _0x12ef26 = _0x498a85 > 1 ? void 0 : _0x498a85 ? Sn(_0x1ea82d, _0xc2c3c5) : _0x1ea82d, _0x56add7 = _0x38ab2e[_0x54ae5b(371)] - 1, _0x8be8a9; _0x56add7 >= 0; _0x56add7--) (_0x8be8a9 = _0x38ab2e[_0x56add7]) && (_0x12ef26 = _0x8be8a9(_0x12ef26) || _0x12ef26);
  return _0x12ef26;
};
var b = (_0x322909, _0x2f4c1e) => (_0xfc77ff, _0x5a1d5b) => _0x2f4c1e(_0xfc77ff, _0x5a1d5b, _0x322909);
var ue3 = class extends Ve {
  constructor(_0x3b6222, _0x14dd64, _0x162044, _0x146a27, _0x50345f, _0x57c23b, _0x2a3821, _0x1372a6) {
    const _0x3c1849 = _0x59d238;
    super(), l(this, _0x3c1849(828), new BehaviorSubject(Si[_0x3c1849(536)])), this[_0x3c1849(613)] = _0x3b6222, this["_collaborationController"] = _0x14dd64, this["_docTransformIMECacheService"] = _0x162044, this[_0x3c1849(686)] = _0x146a27, this[_0x3c1849(856)] = _0x50345f, this[_0x3c1849(593)] = _0x57c23b, this[_0x3c1849(891)] = _0x2a3821, this["_localeService"] = _0x1372a6, this[_0x3c1849(913)]();
  }
  ["_initEntityListener"]() {
    const _0xa847f2 = _0x59d238;
    this[_0xa847f2(621)](this[_0xa847f2(476)][_0xa847f2(552)]["subscribe"]((_0x4c4b88) => {
      const _0x2c1574 = _0xa847f2, _0x3209b5 = this[_0x2c1574(613)]["docStateChange$"][_0x2c1574(369)]((_0x12fa70) => {
        const _0x2c59b0 = _0x2c1574;
        if (_0x12fa70 == null) return;
        const { unitId: _0x52d2df, redoState: _0x39b476, commandId: _0x3c1426 } = _0x12fa70;
        if (_0x52d2df !== _0x4c4b88[_0x2c59b0(446)]) return;
        const _0x36414e = { "id": _0x3c1426, "type": Ms[_0x2c59b0(576)], "params": { "unitId": _0x52d2df, "actions": _0x39b476[_0x2c59b0(724)], "textRanges": null } };
        _0x4c4b88[_0x2c59b0(463)](_0x36414e);
      });
      if (_0x4c4b88[_0x2c1574(621)](_0x3209b5), _0x4c4b88 instanceof It3) {
        const _0x4f92aa = { "onTransformIME": (_0x111e6a) => this[_0x2c1574(818)][_0x2c1574(902)](_0x111e6a), "onTransformState": (_0x53907b) => this[_0x2c1574(686)]["transformStateCache"](_0x53907b), "onTransformSelections": (_0x1f6499) => this[_0x2c1574(856)][_0x2c1574(559)](_0x1f6499), "onSyncEditingCollabCursor": (_0x4fe18f) => this[_0x2c1574(593)][_0x2c1574(418)](_0x4fe18f), "onTransformRemoteChangesetByIMECache": (_0x57c477) => this["_docTransformIMECacheService"][_0x2c1574(518)](_0x57c477), "onTransformRemoteChangesetByStateCache": (_0x179b79) => this[_0x2c1574(686)][_0x2c1574(518)](_0x179b79) };
        _0x4c4b88["addHandlerCallback"](_0x4f92aa);
      }
    }));
  }
};
ue3 = In([b(0, Inject(Io)), b(1, Inject(nt2)), b(2, Inject(_e)), b(3, Inject(le2)), b(4, Inject(he2)), b(5, Inject(Xe2)), b(6, et2), b(7, Inject(Fn))], ue3);
var Z = ((_0x248691) => (_0x248691[_0x248691[_0x59d238(748)] = 0] = _0x59d238(748), _0x248691[_0x248691["OK"] = 1] = "OK", _0x248691[_0x248691[_0x59d238(806)] = 2] = _0x59d238(806), _0x248691[_0x248691[_0x59d238(706)] = 3] = _0x59d238(706), _0x248691[_0x248691["NOT_FOUND"] = 4] = _0x59d238(755), _0x248691[_0x248691[_0x59d238(444)] = 5] = _0x59d238(444), _0x248691[_0x248691[_0x59d238(789)] = 6] = "ALREADY_EXISTS", _0x248691[_0x248691[_0x59d238(687)] = 7] = "INVALID_ARGUMENT", _0x248691[_0x248691[_0x59d238(718)] = 8] = _0x59d238(718), _0x248691[_0x248691[_0x59d238(723)] = 9] = _0x59d238(723), _0x248691[_0x248691["LOGIN_FAILED"] = 10] = _0x59d238(379), _0x248691[_0x248691[_0x59d238(659)] = 11] = "MOBILE_VERIFY_CODE_MISMATCH", _0x248691[_0x248691[_0x59d238(793)] = 12] = _0x59d238(793), _0x248691[_0x248691[_0x59d238(868)] = 13] = "EMAIL_VERIFY_CODE_MISMATCH", _0x248691[_0x248691[_0x59d238(602)] = 14] = "EMAIL_VERIFY_CODE_NOT_FOUND_OR_EXPIRED", _0x248691[_0x248691["AUTHORIZE_CODE_ILLEGAL"] = 15] = "AUTHORIZE_CODE_ILLEGAL", _0x248691[_0x248691[_0x59d238(837)] = 16] = _0x59d238(837), _0x248691[_0x248691[_0x59d238(665)] = 100] = _0x59d238(665), _0x248691[_0x248691[_0x59d238(885)] = 101] = _0x59d238(885), _0x248691[_0x248691[_0x59d238(693)] = 201] = _0x59d238(693), _0x248691[_0x248691[_0x59d238(845)] = 202] = "USER_IS_ANONYMOUS", _0x248691[_0x248691[_0x59d238(475)] = 5001] = _0x59d238(475), _0x248691[_0x248691[_0x59d238(766)] = 6001] = _0x59d238(766), _0x248691[_0x248691["SNAPSHOT_HAS_BEEN_REMOVED"] = 6002] = _0x59d238(426), _0x248691[_0x248691["ENSURE_SNAPSHOT_EXECUTION"] = 6003] = _0x59d238(716), _0x248691[_0x248691[_0x59d238(678)] = 7001] = "APPLY_REJECT", _0x248691[_0x248691[_0x59d238(521)] = 7002] = _0x59d238(521), _0x248691[_0x248691[_0x59d238(366)] = 7003] = _0x59d238(366), _0x248691[_0x248691[_0x59d238(414)] = 7004] = _0x59d238(414), _0x248691[_0x248691["APPLY_DUPLICATED"] = 7005] = _0x59d238(919), _0x248691[_0x248691[_0x59d238(611)] = 8001] = _0x59d238(611), _0x248691[_0x248691["LICENSE_MAX_UNITS_EXCEEDED"] = 9001] = _0x59d238(745), _0x248691[_0x248691[_0x59d238(877)] = 9002] = _0x59d238(877), _0x248691[_0x248691[_0x59d238(590)] = 9003] = "LICENSE_IMPORT_SIZE_EXCEEDED", _0x248691[_0x248691[_0x59d238(600)] = 9004] = _0x59d238(600), _0x248691[_0x248691[_0x59d238(838)] = 9005] = _0x59d238(838), _0x248691[_0x248691["YUUMI_UNABLE_LOAD_URL"] = 10001] = _0x59d238(406), _0x248691[_0x248691[_0x59d238(878)] = 10002] = _0x59d238(878), _0x248691[_0x248691["YUUMI_RATE_OVER_LIMIT"] = 10003] = "YUUMI_RATE_OVER_LIMIT", _0x248691[_0x248691[_0x59d238(746)] = 10004] = _0x59d238(746), _0x248691[_0x248691["YUUMI_NO_CUBOID_FOR_QUESTION"] = 10010] = "YUUMI_NO_CUBOID_FOR_QUESTION", _0x248691[_0x248691[_0x59d238(853)] = 10011] = "YUUMI_ASYNCIO_CANCELLED", _0x248691[_0x248691[_0x59d238(451)] = 10012] = _0x59d238(451), _0x248691[_0x248691["YUUMI_ALL_TABLES_IS_INVALID"] = 10013] = _0x59d238(455), _0x248691[_0x248691["YUUMI_PROMPT_MAX_TOKENS_EXCEEDED"] = 10014] = _0x59d238(594), _0x248691[_0x248691[_0x59d238(618)] = 10015] = _0x59d238(618), _0x248691[_0x248691[_0x59d238(499)] = 10016] = "YUUMI_CONNECTOR_URL_NOT_FOUND", _0x248691[_0x248691["PY_RUNTIME_SCRIPT_ERROR"] = 11001] = "PY_RUNTIME_SCRIPT_ERROR", _0x248691[_0x248691["INVITE_CODE_HAS_BEEN_UES"] = 12001] = _0x59d238(362), _0x248691[_0x248691[_0x59d238(683)] = 12002] = _0x59d238(683), _0x248691[_0x248691[_0x59d238(363)] = 12003] = _0x59d238(363), _0x248691[_0x248691["USER_NOT_INVITED_CODE"] = 12004] = _0x59d238(915), _0x248691[_0x248691[_0x59d238(440)] = 12005] = "INVITE_CODE_ALREADY_BOUND", _0x248691[_0x248691[_0x59d238(491)] = 13001] = _0x59d238(491), _0x248691[_0x248691[_0x59d238(541)] = 13002] = _0x59d238(541), _0x248691[_0x248691[_0x59d238(721)] = 13003] = _0x59d238(721), _0x248691[_0x248691[_0x59d238(529)] = 14001] = _0x59d238(529), _0x248691[_0x248691[_0x59d238(638)] = 14002] = _0x59d238(638), _0x248691[_0x248691[_0x59d238(421)] = 14003] = _0x59d238(421), _0x248691[_0x248691[_0x59d238(841)] = 14004] = "PAYMENT_CHANNEL_NOT_SUPPORT", _0x248691[_0x248691["ENTITLE_CHAT_LIMIT_EXCEED"] = 14101] = _0x59d238(725), _0x248691[_0x248691[_0x59d238(703)] = 14102] = _0x59d238(703), _0x248691[_0x248691[_0x59d238(764)] = 14103] = "ENTITLE_INSUFFICIENT_QUOTA", _0x248691[_0x248691["ENTITLE_NEED_BILLING_ADDRESS"] = 14301] = _0x59d238(833), _0x248691[_0x248691["REDEMPTION_INVALID_CODE"] = 15001] = _0x59d238(798), _0x248691[_0x248691[_0x59d238(417)] = 15002] = _0x59d238(417), _0x248691[_0x248691[_0x59d238(360)] = 15003] = "REDEMPTION_CODE_FULLY_REDEEMED", _0x248691[_0x248691["REDEMPTION_CODE_NOT_STARTED"] = 15004] = _0x59d238(492), _0x248691[_0x248691[_0x59d238(890)] = 15005] = "REDEMPTION_USER_NOT_ELIGIBLE", _0x248691[_0x248691[_0x59d238(815)] = 15006] = _0x59d238(815), _0x248691[_0x248691[_0x59d238(824)] = 15007] = _0x59d238(824), _0x248691[_0x248691[_0x59d238(361)] = 16001] = _0x59d238(361), _0x248691[_0x248691[_0x59d238(804)] = -1] = "UNRECOGNIZED", _0x248691))(Z || {});
function mn(_0x595d77) {
  const _0x3a4933 = _0x59d238;
  var _0x41af81, _0x2b9ac4;
  const _0x113389 = (_0x41af81 = _0x595d77["stageInfo"]) == null ? void 0 : _0x41af81[_0x3a4933(605)], _0x27a7ef = ((_0x2b9ac4 = _0x595d77["stageInfo"]) == null ? void 0 : _0x2b9ac4["totalFormulasToCalculate"]) || 0;
  return _0x113389 === Je[_0x3a4933(850)] && _0x27a7ef > 0;
}
function fn(_0x3bd0c6) {
  const _0x290aa3 = _0x59d238;
  return _0x3bd0c6[_0x290aa3(881)] === Sr[_0x290aa3(496)];
}
var gn = Object["getOwnPropertyDescriptor"];
var vn = (_0x491176, _0x10ab90, _0x5034dd, _0x10438e) => {
  for (var _0x36ca6b = _0x10438e > 1 ? void 0 : _0x10438e ? gn(_0x10ab90, _0x5034dd) : _0x10ab90, _0x4e5a93 = _0x491176["length"] - 1, _0x339a63; _0x4e5a93 >= 0; _0x4e5a93--) (_0x339a63 = _0x491176[_0x4e5a93]) && (_0x36ca6b = _0x339a63(_0x36ca6b) || _0x36ca6b);
  return _0x36ca6b;
};
var P2 = (_0x54a288, _0x449f71) => (_0x2f2406, _0xe34441) => _0x449f71(_0x2f2406, _0xe34441, _0x54a288);
var En2 = "/universer-api/license/formula/limit/status";
var pn2 = _0x59d238(620);
var On2 = _0x59d238(400);
var de3 = class extends Ve {
  constructor(_0x106b70, _0x45201a, _0x57b72c, _0x3c2a0a, _0x5ca943, _0x5b184a, _0x280a44) {
    const _0x8b8a67 = _0x59d238;
    super(), l(this, _0x8b8a67(542), null), l(this, _0x8b8a67(726), 0), l(this, _0x8b8a67(762), 0), l(this, _0x8b8a67(816), []), l(this, _0x8b8a67(715), 0), this[_0x8b8a67(891)] = _0x106b70, this[_0x8b8a67(772)] = _0x45201a, this[_0x8b8a67(688)] = _0x57b72c, this[_0x8b8a67(583)] = _0x3c2a0a, this["_univerInstanceService"] = _0x5ca943, this[_0x8b8a67(478)] = _0x5b184a, this["_localeService"] = _0x280a44, this["_initCommandInterceptor"]();
  }
  [_0x59d238(910)]() {
    const _0x133c5f = _0x59d238;
    this[_0x133c5f(621)](this[_0x133c5f(772)]["beforeCommandExecuted"]((_0x12c320, _0x4d7312) => {
      const _0x4c5a9e = _0x133c5f;
      var _0x23cd44;
      if (_0x12c320["id"] !== uo["id"]) return;
      const _0x33c777 = _0x12c320["params"];
      if (!this["_hasFormulaInDirtyRanges"]((_0x23cd44 = _0x33c777["dirtyRanges"]) != null ? _0x23cd44 : [])) return;
      if (!this[_0x4c5a9e(763)]()) throw this[_0x4c5a9e(626)](_0x12c320, _0x4d7312), this[_0x4c5a9e(669)](), new KC();
    })), this["disposeWithMe"](this[_0x133c5f(772)]["onCommandExecuted"]((_0xf7692b, _0x356b0f) => {
      const _0x245f77 = _0x133c5f;
      if (_0xf7692b["id"] !== _n["id"]) return;
      const _0xf1b40 = _0xf7692b["params"];
      if (mn(_0xf1b40)) {
        const _0x15deb6 = et();
        this[_0x245f77(816)][_0x245f77(565)](_0x15deb6), this[_0x245f77(758)](_0x15deb6);
      } else {
        if (fn(_0xf1b40) && this["_taskIds"][_0x245f77(371)] > 0) {
          const _0x275ded = this[_0x245f77(816)]["shift"]();
          this["_releaseCalculationLimit"](_0x275ded);
        }
      }
    }));
  }
  [_0x59d238(387)]() {
    const _0x256796 = _0x59d238;
    super["dispose"](), this["_clearPolling"](), this[_0x256796(816)] = [], this[_0x256796(762)] = 0, this[_0x256796(726)] = 0, this["_lastResponseTimestamp"] = 0;
  }
  async [_0x59d238(626)](_0x128045, _0x26f0f6) {
    const _0x157b65 = _0x59d238;
    for (let _0x5c74ee = 0; _0x5c74ee < 30; _0x5c74ee++) try {
      if (await this[_0x157b65(898)](), this[_0x157b65(763)]()) {
        this[_0x157b65(548)](_0x128045, _0x26f0f6), this[_0x157b65(891)][_0x157b65(650)]({ "content": this[_0x157b65(661)]["t"]("formula.calculation.started"), "type": $C[_0x157b65(630)] });
        return;
      }
      await new Promise((_0x3b8c04) => {
        const _0x37a5fd = _0x157b65;
        this["_pollingInterval"] = window[_0x37a5fd(579)](_0x3b8c04, 1e3);
      });
    } catch (_0x3d0b76) {
      this[_0x157b65(478)][_0x157b65(883)](_0x3d0b76);
    }
    this[_0x157b65(891)][_0x157b65(650)]({ "content": this["_localeService"]["t"](_0x157b65(473)), "type": $C[_0x157b65(667)] });
  }
  [_0x59d238(548)](_0x208ae9, _0x337941) {
    const _0x1b70ed = _0x59d238;
    try {
      this[_0x1b70ed(772)][_0x1b70ed(441)](_0x208ae9["id"], _0x208ae9["params"], _0x337941);
    } catch (_0x2de1fa) {
      this[_0x1b70ed(478)][_0x1b70ed(883)](_0x2de1fa);
    }
  }
  [_0x59d238(636)](_0x562a46, _0x271345) {
    const _0x2ce586 = _0x59d238;
    _0x271345 < this[_0x2ce586(715)] || (this[_0x2ce586(715)] = _0x271345, this[_0x2ce586(726)] = Number[_0x2ce586(874)](_0x562a46[_0x2ce586(634)]), this["_currentUsage"] = Number["parseInt"](_0x562a46[_0x2ce586(735)]));
  }
  async [_0x59d238(758)](_0x56e1da) {
    const _0x2e58cb = _0x59d238;
    var _0x52deff, _0x5597d6;
    const _0x45a0da = Date[_0x2e58cb(701)]();
    try {
      const _0x1c5c38 = ((_0x52deff = this["_configService"][_0x2e58cb(553)](K)) == null ? void 0 : _0x52deff["startFormulaLimitUrl"]) || pn2, _0x3b1a9c = (await this[_0x2e58cb(583)][_0x2e58cb(719)](_0x1c5c38, { "body": JSON["stringify"]({ "taskId": _0x56e1da }) }))[_0x2e58cb(712)];
      if (((_0x5597d6 = _0x3b1a9c[_0x2e58cb(883)]) == null ? void 0 : _0x5597d6[_0x2e58cb(677)]) !== Z["OK"]) return;
      this[_0x2e58cb(636)](_0x3b1a9c[_0x2e58cb(855)], _0x45a0da);
    } catch (_0x54da3e) {
      this[_0x2e58cb(478)][_0x2e58cb(883)](_0x54da3e);
    }
  }
  async [_0x59d238(898)](_0x432f8d) {
    const _0x348b8f = _0x59d238;
    var _0x3f335f, _0x2a842e;
    const _0x36e572 = Date[_0x348b8f(701)]();
    try {
      const _0x192116 = ((_0x3f335f = this["_configService"][_0x348b8f(553)](K)) == null ? void 0 : _0x3f335f[_0x348b8f(527)]) || En2, _0xec42ac = _0x432f8d ? _0x192116 + "?taskId=" + encodeURIComponent(_0x432f8d) : _0x192116, _0x2b95e3 = (await this["_httpService"][_0x348b8f(436)](_0xec42ac))["body"];
      if (((_0x2a842e = _0x2b95e3[_0x348b8f(883)]) == null ? void 0 : _0x2a842e[_0x348b8f(677)]) !== Z["OK"]) return;
      this["_setFormulaLimitStatus"](_0x2b95e3[_0x348b8f(855)], _0x36e572);
    } catch (_0x266bae) {
      this[_0x348b8f(478)][_0x348b8f(883)](_0x266bae);
    }
  }
  async [_0x59d238(419)](_0x21b51b) {
    const _0x48c32c = _0x59d238;
    var _0x2e66eb, _0x41a481;
    const _0xa53243 = Date[_0x48c32c(701)]();
    try {
      const _0x20c042 = ((_0x2e66eb = this[_0x48c32c(688)]["getConfig"](K)) == null ? void 0 : _0x2e66eb[_0x48c32c(685)]) || On2, _0x3d0e13 = (await this[_0x48c32c(583)][_0x48c32c(719)](_0x20c042, { "body": JSON["stringify"]({ "taskId": _0x21b51b }) }))[_0x48c32c(712)];
      if (((_0x41a481 = _0x3d0e13["error"]) == null ? void 0 : _0x41a481[_0x48c32c(677)]) !== Z["OK"]) return;
      this[_0x48c32c(636)](_0x3d0e13[_0x48c32c(855)], _0xa53243);
    } catch (_0x167d11) {
      this[_0x48c32c(478)][_0x48c32c(883)](_0x167d11);
    }
  }
  ["_checkCalculationAvailable"]() {
    const _0xfe483f = _0x59d238;
    return this[_0xfe483f(726)] === 0 ? true : this["_maxFormulaLimit"] - this[_0xfe483f(762)] > 0;
  }
  [_0x59d238(714)]() {
    const _0x240d0d = _0x59d238;
    this[_0x240d0d(542)] && (clearTimeout(this[_0x240d0d(542)]), this[_0x240d0d(542)] = null);
  }
  ["_showGuardMessage"]() {
    const _0x124017 = _0x59d238;
    this["_messageService"][_0x124017(650)]({ "content": this[_0x124017(661)]["t"]("formula.calculation.waiting"), "type": $C["Loading"] });
  }
  [_0x59d238(831)](_0x4c9826) {
    const _0x35d8cb = _0x59d238;
    for (const _0x5a1d85 of _0x4c9826) {
      const { unitId: _0x1f7473, sheetId: _0x29f733, range: _0x59cffa } = _0x5a1d85, _0xf1e75a = this[_0x35d8cb(644)]["getUnit"](_0x1f7473);
      if (!_0xf1e75a) continue;
      const _0x4c3885 = _0xf1e75a[_0x35d8cb(834)](_0x29f733);
      if (!_0x4c3885) continue;
      const _0x117905 = _0x4c3885[_0x35d8cb(372)]();
      for (let _0x1906a0 = _0x59cffa["startRow"]; _0x1906a0 <= _0x59cffa[_0x35d8cb(717)]; _0x1906a0++) for (let _0x3aebfe = _0x59cffa[_0x35d8cb(897)]; _0x3aebfe <= _0x59cffa[_0x35d8cb(788)]; _0x3aebfe++) {
        const _0x12676a = _0x117905[_0x35d8cb(509)](_0x1906a0, _0x3aebfe);
        if (_0x12676a && (Gg(_0x12676a["f"]) || B1(_0x12676a["si"]))) return true;
      }
    }
    return false;
  }
};
de3 = vn([P2(0, Inject(et2)), P2(1, Ls), P2(2, ic), P2(3, Inject(x)), P2(4, vr), P2(5, yt), P2(6, Inject(Fn))], de3);
var Tn = Object["getOwnPropertyDescriptor"];
var Cn = (_0x320050, _0x10505d, _0x26d2db, _0x33107b) => {
  const _0x510d96 = _0x59d238;
  for (var _0x12d2e6 = _0x33107b > 1 ? void 0 : _0x33107b ? Tn(_0x10505d, _0x26d2db) : _0x10505d, _0x2908b9 = _0x320050[_0x510d96(371)] - 1, _0x57c930; _0x2908b9 >= 0; _0x2908b9--) (_0x57c930 = _0x320050[_0x2908b9]) && (_0x12d2e6 = _0x57c930(_0x12d2e6) || _0x12d2e6);
  return _0x12d2e6;
};
var De = (_0xff0ee2, _0x20b6d7) => (_0x3caf17, _0x3b8f15) => _0x20b6d7(_0x3caf17, _0x3b8f15, _0xff0ee2);
var xe = class extends Ve {
  constructor(_0x3eee56, _0x2fede3, _0x3d7edf) {
    const _0x339171 = _0x59d238;
    super(), l(this, _0x339171(412), /* @__PURE__ */ new Map()), l(this, "_saveTaskMap", /* @__PURE__ */ new Map()), l(this, _0x339171(653), false), this[_0x339171(688)] = _0x3eee56, this[_0x339171(514)] = _0x2fede3, this[_0x339171(750)] = _0x3d7edf;
  }
  [_0x59d238(394)]() {
    const _0x208d01 = _0x59d238;
    this[_0x208d01(653)] = true;
  }
  [_0x59d238(920)]() {
    const _0x55f804 = _0x59d238;
    this[_0x55f804(653)] = false;
  }
  get [_0x59d238(601)]() {
    const _0x5a84bb = _0x59d238;
    return this[_0x5a84bb(854)];
  }
  [_0x59d238(387)]() {
    const _0x2cc85c = _0x59d238;
    this[_0x2cc85c(752)]()["then"](() => super[_0x2cc85c(387)]());
  }
  async [_0x59d238(771)](_0x4c7c0c) {
    const _0x10daca = _0x59d238;
    return this[_0x10daca(653)] ? null : this["_localStorageService"][_0x10daca(843)](Nr(_0x4c7c0c));
  }
  async [_0x59d238(598)](_0x41c58f, _0x4f7601) {
    const _0x435ae4 = _0x59d238;
    return !!this["_localStorageService"][_0x435ae4(904)](_0x41c58f, _0x4f7601);
  }
  ["updateOfflineData"](_0x3c86d2, _0xba0120, _0x1d508f, _0xb4ccb) {
    const _0x4eda92 = _0x59d238, _0x349a76 = this[_0x4eda92(750)][_0x4eda92(358)](_0x3c86d2);
    this[_0x4eda92(412)][_0x4eda92(727)](_0x3c86d2, { "unitID": _0x3c86d2, "type": _0xba0120, "awaitingChangeset": _0x1d508f, "mutations": _0xb4ccb, "rev": _0x349a76 }), this[_0x4eda92(854)]["has"](_0x3c86d2) || this[_0x4eda92(405)](_0x3c86d2);
  }
  [_0x59d238(405)](_0x558bf2) {
    const _0x351af5 = _0x59d238, _0x54d814 = this[_0x351af5(814)]();
    _0x54d814 === 0 ? this[_0x351af5(539)](_0x558bf2) : this[_0x351af5(854)][_0x351af5(727)](_0x558bf2, setTimeout(() => this[_0x351af5(539)](_0x558bf2), _0x54d814));
  }
  [_0x59d238(814)]() {
    const _0x2930a1 = _0x59d238;
    var _0x4ec7ba;
    return (_0x4ec7ba = this[_0x2930a1(688)]["getConfig"](Tr)) != null ? _0x4ec7ba : Or;
  }
  [_0x59d238(539)](_0x31c6d6) {
    const _0x5a65f2 = _0x59d238, _0x24a3fe = this[_0x5a65f2(854)]["get"](_0x31c6d6);
    return _0x24a3fe !== void 0 && window[_0x5a65f2(916)](_0x24a3fe), this[_0x5a65f2(514)][_0x5a65f2(904)](Nr(_0x31c6d6), this[_0x5a65f2(412)]["get"](_0x31c6d6))[_0x5a65f2(516)](() => this["_saveTaskMap"]["delete"](_0x31c6d6));
  }
  async ["exhaustSavingTask"]() {
    const _0x1a626a = _0x59d238, _0x10c763 = [];
    this[_0x1a626a(854)][_0x1a626a(450)]((_0x284816, _0x1325f1) => {
      const _0xbc8ad6 = _0x1a626a;
      window[_0xbc8ad6(916)](_0x284816), _0x10c763[_0xbc8ad6(565)](this[_0xbc8ad6(539)](_0x1325f1)[_0xbc8ad6(516)](() => {
        const _0x344c22 = _0xbc8ad6;
        this[_0x344c22(854)][_0x344c22(849)](_0x1325f1);
      }));
    }), await Promise[_0x1a626a(404)](_0x10c763);
  }
};
xe = Cn([De(0, ic), De(1, XR), De(2, Inject(Jt))], xe);
var Rn = class extends h1 {
  constructor() {
    const _0x3d1463 = _0x59d238;
    super(), l(this, _0x3d1463(464)), this[_0x3d1463(464)] = fromEvent(window, _0x3d1463(443))["pipe"](takeUntil(this["dispose$"]), shareReplay(1), mapTo(void 0));
  }
  [_0x59d238(365)](_0x126381, _0x3aeaae, _0x2fc020 = false) {
    const _0x4a7d91 = _0x59d238, _0x9f2b68 = new URL(window[_0x4a7d91(432)]["href"]);
    _0x9f2b68[_0x4a7d91(796)][_0x4a7d91(727)](_0x126381, _0x3aeaae), _0x2fc020 ? window[_0x4a7d91(749)][_0x4a7d91(454)]("", "", _0x9f2b68["toString"]()) : window["history"]["pushState"]("", "", _0x9f2b68[_0x4a7d91(442)]());
  }
  [_0x59d238(652)](_0x579459, _0x179f1e = false) {
    const _0x3db3d2 = _0x59d238, _0x171bfb = new URL(window["location"][_0x3db3d2(506)]);
    _0x171bfb[_0x3db3d2(796)][_0x3db3d2(849)](_0x579459), _0x179f1e ? window[_0x3db3d2(749)]["replaceState"]("", "", _0x171bfb[_0x3db3d2(442)]()) : window[_0x3db3d2(749)]["pushState"]("", "", _0x171bfb[_0x3db3d2(442)]());
  }
  [_0x59d238(578)](_0x3a6db2) {
    const _0x3b6598 = _0x59d238;
    var _0x3e111c;
    return (_0x3e111c = new URL(window[_0x3b6598(432)][_0x3b6598(506)])[_0x3b6598(796)][_0x3b6598(436)](_0x3a6db2)) != null ? _0x3e111c : void 0;
  }
};
var Dn = Object[_0x59d238(830)];
var Nn2 = Object["getOwnPropertyDescriptor"];
var bn = (_0x1fdde8, _0x453ca9, _0x554ef5) => _0x453ca9 in _0x1fdde8 ? Dn(_0x1fdde8, _0x453ca9, { "enumerable": true, "configurable": true, "writable": true, "value": _0x554ef5 }) : _0x1fdde8[_0x453ca9] = _0x554ef5;
var Un = (_0x1714f9, _0x1930c2, _0x5b1b90, _0x5076be) => {
  for (var _0xfa6367 = _0x5076be > 1 ? void 0 : _0x5076be ? Nn2(_0x1930c2, _0x5b1b90) : _0x1930c2, _0x2188d7 = _0x1714f9["length"] - 1, _0x3f16aa; _0x2188d7 >= 0; _0x2188d7--) (_0x3f16aa = _0x1714f9[_0x2188d7]) && (_0xfa6367 = _0x3f16aa(_0xfa6367) || _0xfa6367);
  return _0xfa6367;
};
var Ne = (_0x2b7f85, _0x257106) => (_0x61e78, _0x258362) => _0x257106(_0x61e78, _0x258362, _0x2b7f85);
var Ln = (_0x5b6c79, _0xd36efa, _0xe7d03e) => bn(_0x5b6c79, _0xd36efa + "", _0xe7d03e);
var Mn = _0x59d238(572);
var Be2 = class extends Ol {
  constructor(_0x5a55a0 = rt, _0x411e38, _0x2d76f0, _0x287d48) {
    const _0x3a40e2 = _0x59d238;
    super(), this[_0x3a40e2(599)] = _0x5a55a0, this[_0x3a40e2(431)] = _0x411e38, this[_0x3a40e2(571)] = _0x2d76f0, this["_configService"] = _0x287d48;
    const { ..._0x34d582 } = oo({}, rt, this[_0x3a40e2(599)]);
    this[_0x3a40e2(688)][_0x3a40e2(474)](an, _0x34d582);
  }
  [_0x59d238(504)]() {
    const _0x1af994 = _0x59d238;
    this[_0x1af994(577)](), this["_initDependencies"]();
  }
  [_0x59d238(628)]() {
    this["_registerRenderDependencies"]();
  }
  [_0x59d238(577)]() {
    const _0x3bb4e3 = _0x59d238;
    var _0x492711;
    const _0x12bcfd = [[je], [de3], [he2], [_e], [le2], [Xe2], [At3, { "useClass": Rn }], [ze, { "useClass": Ye }], [J3, { "useClass": xe }], [oe2], [ue3], [ce2], [H], [Ae], [ae2]];
    GC(this["_injector"], nC(_0x12bcfd, (_0x492711 = this[_0x3bb4e3(599)]) == null ? void 0 : _0x492711[_0x3bb4e3(663)]));
  }
  [_0x59d238(803)]() {
    const _0x3576e3 = _0x59d238;
    this["disposeWithMe"](this[_0x3576e3(431)]["registerRenderModule"](we["UNIVER_DOC"], [ye])), this[_0x3576e3(621)](this["_renderManagerService"][_0x3576e3(907)](we[_0x3576e3(520)], [$e]));
  }
  [_0x59d238(545)]() {
    zc(this["_injector"], [[H], [oe2], [ue3], [ce2], [ae2], [de3]]);
  }
};
Ln(Be2, _0x59d238(657), Mn), Be2 = Un([qR(Dt), Ne(1, ME), Ne(2, Inject(Injector)), Ne(3, ic)], Be2);
var An = Object[_0x59d238(670)];
var Pn = (_0x3ec79f, _0x30eada, _0xb42690, _0x203442) => {
  const _0x6cddf5 = _0x59d238;
  for (var _0x3a8b0b = _0x203442 > 1 ? void 0 : _0x203442 ? An(_0x30eada, _0xb42690) : _0x30eada, _0x3e6855 = _0x3ec79f[_0x6cddf5(371)] - 1, _0x5da4d2; _0x3e6855 >= 0; _0x3e6855--) (_0x5da4d2 = _0x3ec79f[_0x3e6855]) && (_0x3a8b0b = _0x5da4d2(_0x3a8b0b) || _0x3a8b0b);
  return _0x3a8b0b;
};
var J4 = (_0x33f6b9, _0x2ac31a) => (_0x3d3204, _0x4b537b) => _0x2ac31a(_0x3d3204, _0x4b537b, _0x33f6b9);
var ct2 = class extends Wt {
  constructor(_0x4b2307, _0x2f4e24, _0x2d3b76, _0x3abb86, _0x1ba51e) {
    super(_0x4b2307, _0x2f4e24, _0x2d3b76, _0x3abb86, _0x1ba51e);
  }
  async [_0x59d238(592)](_0x53c344) {
    const _0x13ec1f = _0x59d238, _0x2cc974 = await this[_0x13ec1f(731)](), _0x240b7a = this["_createSocketURL"](_0x53c344, _0x2cc974);
    return this["_doCreateSocket"](_0x240b7a);
  }
  [_0x59d238(742)](_0x582c79, _0x235236) {
    const _0x4773e3 = _0x59d238, _0x39d3ea = typeof window > "u" ? new URL(_0x582c79) : new URL(_0x582c79, window[_0x4773e3(432)][_0x4773e3(564)]);
    _0x39d3ea[_0x4773e3(796)][_0x4773e3(727)](_0x4773e3(453), _0x235236);
    const _0x4bcd7c = typeof window > "u" ? new URLSearchParams() : new URLSearchParams(window[_0x4773e3(432)]["search"]);
    return _0x4bcd7c[_0x4773e3(436)](_0x4773e3(866)) && _0x39d3ea[_0x4773e3(796)][_0x4773e3(727)](_0x4773e3(866), _0x4bcd7c[_0x4773e3(436)](_0x4773e3(866))), _0x39d3ea[_0x4773e3(442)]();
  }
  async ["_getSessionTicket"]() {
    const _0xfa499b = _0x59d238;
    var _0x14c2b5, _0xc5ca34, _0x448768;
    const _0x417529 = this[_0xfa499b(688)][_0xfa499b(553)](K), _0x1c2354 = (_0x14c2b5 = _0x417529 == null ? void 0 : _0x417529["wsSessionTicketUrl"]) != null ? _0x14c2b5 : gr3;
    return (_0x448768 = (_0xc5ca34 = (await this[_0xfa499b(583)][_0xfa499b(436)](_0x1c2354, { "headers": { "Content-Type": _0xfa499b(633) } }))[_0xfa499b(712)]) == null ? void 0 : _0xc5ca34[_0xfa499b(488)]) != null ? _0x448768 : "";
  }
};
ct2 = Pn([J4(0, Inject(Injector)), J4(1, Inject(x)), J4(2, ic), J4(3, yt), J4(4, gr2)], ct2);
var wn = Object["getOwnPropertyDescriptor"];
var yn = (_0x126c1a, _0xfd7e5b, _0x4a10f9, _0x4bb4cb) => {
  const _0x1bcc0c = _0x59d238;
  for (var _0x3159c5 = _0x4bb4cb > 1 ? void 0 : _0x4bb4cb ? wn(_0xfd7e5b, _0x4a10f9) : _0xfd7e5b, _0x3029e4 = _0x126c1a[_0x1bcc0c(371)] - 1, _0x479264; _0x3029e4 >= 0; _0x3029e4--) (_0x479264 = _0x126c1a[_0x3029e4]) && (_0x3159c5 = _0x479264(_0x3159c5) || _0x3159c5);
  return _0x3159c5;
};
var be2 = (_0x26f827, _0x2d6eab) => (_0x34b6ac, _0x4e94f2) => _0x2d6eab(_0x34b6ac, _0x4e94f2, _0x26f827);
var _t3 = class extends Ve {
  constructor(_0x4108c0, _0x40bef3, _0x46dbf9) {
    const _0x59deb8 = _0x59d238;
    super(), this["_instanceService"] = _0x4108c0, this[_0x59deb8(583)] = _0x40bef3, this["_configService"] = _0x46dbf9;
  }
  async ["runOnServer"](_0x5550e5, _0x43e917, _0x27259d, ..._0x3c98ce) {
    const _0x137f46 = _0x59d238;
    var _0x323931, _0x2515c7, _0x56dd4c, _0x1ced96;
    const _0x508639 = this[_0x137f46(802)]["getFocusedUnit"]();
    if (!_0x508639) throw new Error(_0x137f46(768));
    const _0x194603 = ((_0x323931 = this[_0x137f46(688)][_0x137f46(553)](Rr)) != null ? _0x323931 : Cr) + "/" + _0x5550e5 + _0x137f46(896) + _0x43e917, _0x3dfb8b = new URL(window[_0x137f46(432)][_0x137f46(506)]), _0x18bf22 = { "scriptId": _0x5550e5, "runId": (_0x2515c7 = _0x3dfb8b[_0x137f46(796)]["get"](_0x137f46(866))) != null ? _0x2515c7 : "", "function": _0x43e917, "unitId": _0x508639[_0x137f46(675)](), "argsOfFunction": JSON[_0x137f46(807)](_0x3c98ce), "invokeId": (_0x56dd4c = _0x27259d["invokeId"]) != null ? _0x56dd4c : "", "executionId": (_0x1ced96 = _0x27259d[_0x137f46(627)]) != null ? _0x1ced96 : "" };
    try {
      const _0x4c6a8b = await this[_0x137f46(583)][_0x137f46(719)](_0x194603, { "body": _0x18bf22 });
      return _0x4c6a8b[_0x137f46(712)][_0x137f46(883)] && _0x4c6a8b[_0x137f46(712)][_0x137f46(883)][_0x137f46(677)] !== Z["OK"] ? _0x137f46(662) : _0x4c6a8b[_0x137f46(712)][_0x137f46(382)];
    } catch {
      return _0x137f46(662);
    }
  }
};
_t3 = yn([be2(0, vr), be2(1, Inject(x)), be2(2, ic)], _t3);
var lt = 3e4;
var ht = _0x59d238(458);
var tr = class extends Ve {
  constructor() {
    const _0x3c002f = _0x59d238;
    super(), l(this, _0x3c002f(420), et()), l(this, _0x3c002f(543), /* @__PURE__ */ new Set()), l(this, _0x3c002f(641), /* @__PURE__ */ new Map()), l(this, _0x3c002f(373), null), l(this, _0x3c002f(801), /* @__PURE__ */ new Map()), l(this, _0x3c002f(589), /* @__PURE__ */ new Map()), this[_0x3c002f(596)]();
  }
  [_0x59d238(387)]() {
    const _0x3a9609 = _0x59d238;
    super[_0x3a9609(387)](), this[_0x3a9609(801)][_0x3a9609(450)]((_0x50dc07, _0x42ddfa) => this[_0x3a9609(537)](_0x42ddfa)), this[_0x3a9609(373)] && window[_0x3a9609(585)](this["_heartbeatTimer"]);
  }
  [_0x59d238(844)](_0x666e4f) {
    return this["_ensureSubject"](_0x666e4f)["pipe"](distinctUntilChanged());
  }
  [_0x59d238(839)](_0x48d1b8) {
    const _0x2442ca = _0x59d238;
    this[_0x2442ca(543)]["size"] === 0 && this[_0x2442ca(368)](), this[_0x2442ca(543)][_0x2442ca(459)](_0x48d1b8), this["_send"]({ "type": 0, "memberID": this[_0x2442ca(420)], "unitIDs": [_0x48d1b8], "isForwarded": false });
  }
  ["disposeUnit"](_0x2f5d31) {
    const _0x29fdce = _0x59d238;
    this[_0x29fdce(543)][_0x29fdce(849)](_0x2f5d31), this[_0x29fdce(543)]["size"] === 0 && this[_0x29fdce(373)] && window[_0x29fdce(585)](this[_0x29fdce(373)]);
  }
  [_0x59d238(596)]() {
    const _0x3b17e9 = _0x59d238;
    this["disposeWithMe"](We(fromEvent(window, _0x3b17e9(671))[_0x3b17e9(369)]((_0x25f281) => {
      const _0x3c85e0 = _0x3b17e9;
      if (_0x25f281[_0x3c85e0(409)] !== ht || !_0x25f281["newValue"]) return;
      const _0x1d45df = JSON[_0x3c85e0(840)](_0x25f281[_0x3c85e0(466)]);
      this["_handleEvent"](_0x1d45df);
    }))), window["addEventListener"](_0x3b17e9(757), () => this["_send"]({ "type": 1, "memberID": this[_0x3b17e9(420)], "unitIDs": Array[_0x3b17e9(740)](this[_0x3b17e9(543)]) }));
  }
  [_0x59d238(416)](_0x29400d) {
    const _0x59af21 = _0x59d238;
    switch (_0x29400d[_0x59af21(557)]) {
      case 0:
        this[_0x59af21(563)](_0x29400d);
        break;
      case 1:
        this[_0x59af21(923)](_0x29400d);
        break;
      case 2:
        this[_0x59af21(498)](_0x29400d);
        break;
    }
  }
  [_0x59d238(563)](_0x1c16ac) {
    const _0x41699a = _0x59d238, { unitIDs: _0x45e193, memberID: _0x49ebd0, isForwarded: _0x2075ea } = _0x1c16ac;
    _0x45e193[_0x41699a(450)]((_0x4282ad) => {
      const _0x23dec = _0x41699a;
      if (!_0x2075ea && this[_0x23dec(641)][_0x23dec(779)](_0x4282ad) && this[_0x23dec(389)](_0x4282ad)[_0x23dec(639)](mi["OTHER_CLIENTS_EDITING"]), !this[_0x23dec(641)]["has"](_0x4282ad) || !this[_0x23dec(641)][_0x23dec(436)](_0x4282ad)[_0x23dec(779)](_0x49ebd0)) {
        const _0x309f2c = this[_0x23dec(641)]["get"](_0x4282ad) || /* @__PURE__ */ new Set();
        _0x309f2c[_0x23dec(459)](_0x49ebd0), this["_unitOnClients"][_0x23dec(727)](_0x4282ad, _0x309f2c), this[_0x23dec(357)](_0x49ebd0);
      }
    }), _0x2075ea || this["_send"]({ "type": 0, "memberID": this[_0x41699a(420)], "unitIDs": [...this["_selfUnitIDs"]], "isForwarded": true });
  }
  ["_scheduleClearOtherTimer"](_0x1eb295) {
    const _0x55b95e = _0x59d238;
    this[_0x55b95e(537)](_0x1eb295);
    const _0x1369b8 = window[_0x55b95e(579)](() => {
      const _0x26a40a = _0x55b95e;
      this[_0x26a40a(641)][_0x26a40a(450)]((_0x188072) => {
        const _0xb710f1 = _0x26a40a;
        _0x188072[_0xb710f1(849)](_0x1eb295);
      });
    }, lt * 2);
    this[_0x55b95e(801)][_0x55b95e(727)](_0x1eb295, _0x1369b8);
  }
  [_0x59d238(537)](_0x55c09b) {
    const _0x736284 = _0x59d238;
    if (this[_0x736284(801)][_0x736284(779)](_0x55c09b)) {
      const _0x5bc7ac = this[_0x736284(801)]["get"](_0x55c09b);
      _0x5bc7ac && window["clearTimeout"](_0x5bc7ac), this[_0x736284(801)][_0x736284(727)](_0x55c09b, null);
    }
  }
  ["_handleLeaveEvent"](_0x2f8cb3) {
    const _0x2d3a91 = _0x59d238, { memberID: _0x421245, unitIDs: _0x1aa28a } = _0x2f8cb3;
    _0x1aa28a["forEach"]((_0x531062) => {
      const _0x1d4429 = _0x6a51;
      var _0x99f726;
      const _0xdabe90 = this[_0x1d4429(641)]["get"](_0x531062);
      _0xdabe90 && (_0xdabe90["delete"](_0x421245), (_0x99f726 = this["_ensureSubject"](_0x531062)) == null || _0x99f726[_0x1d4429(639)](_0xdabe90["size"] === 0 ? mi[_0x1d4429(614)] : mi[_0x1d4429(533)]));
    }), this[_0x2d3a91(537)](_0x421245);
  }
  [_0x59d238(498)](_0x5a6cbe) {
    const _0x28fd29 = _0x59d238;
    this[_0x28fd29(357)](_0x5a6cbe[_0x28fd29(895)]);
  }
  [_0x59d238(759)](_0x38e38f) {
    const _0x48b0f8 = _0x59d238;
    localStorage[_0x48b0f8(904)](ht, JSON[_0x48b0f8(807)](_0x38e38f));
  }
  [_0x59d238(368)]() {
    this["_heartbeatTimer"] = window["setInterval"](() => {
      const _0x63016f = _0x6a51;
      this[_0x63016f(759)]({ "type": 2, "memberID": this[_0x63016f(420)] });
    }, lt);
  }
  ["_ensureSubject"](_0xdddc8c) {
    const _0x31fd74 = _0x59d238;
    return this[_0x31fd74(589)][_0x31fd74(779)](_0xdddc8c) || this[_0x31fd74(589)][_0x31fd74(727)](_0xdddc8c, new BehaviorSubject(mi[_0x31fd74(614)])), this["_unitStatus"]["get"](_0xdddc8c);
  }
};

// node_modules/@univerjs-pro/edit-history-loader/lib/es/index.js
var import_react3 = __toESM(require_react());

// node_modules/@univerjs-pro/edit-history-viewer/lib/es/index.js
var import_jsx_runtime2 = __toESM(require_jsx_runtime());
var import_react2 = __toESM(require_react());
var _0x24fbc0 = _0x4d04;
(function(_0x41ed3a, _0x453f96) {
  const _0x3bf553 = _0x4d04, _0xb4571d = _0x41ed3a();
  while (!![]) {
    try {
      const _0xcccc1a = parseInt(_0x3bf553(657)) / 1 * (parseInt(_0x3bf553(820)) / 2) + parseInt(_0x3bf553(803)) / 3 * (parseInt(_0x3bf553(540)) / 4) + parseInt(_0x3bf553(733)) / 5 * (-parseInt(_0x3bf553(507)) / 6) + parseInt(_0x3bf553(885)) / 7 * (parseInt(_0x3bf553(700)) / 8) + -parseInt(_0x3bf553(558)) / 9 * (parseInt(_0x3bf553(895)) / 10) + -parseInt(_0x3bf553(502)) / 11 + parseInt(_0x3bf553(653)) / 12;
      if (_0xcccc1a === _0x453f96) break;
      else _0xb4571d["push"](_0xb4571d["shift"]());
    } catch (_0xcd4f66) {
      _0xb4571d["push"](_0xb4571d["shift"]());
    }
  }
})(_0xb262, 523240);
var xe2 = Object["defineProperty"];
var Ae2 = (_0x46e955, _0x1e6b0c, _0x508ca6) => _0x1e6b0c in _0x46e955 ? xe2(_0x46e955, _0x1e6b0c, { "enumerable": true, "configurable": true, "writable": true, "value": _0x508ca6 }) : _0x46e955[_0x1e6b0c] = _0x508ca6;
var _ = (_0x281833, _0x2ef894, _0x19491a) => Ae2(_0x281833, typeof _0x2ef894 != "symbol" ? _0x2ef894 + "" : _0x2ef894, _0x19491a);
function _0x4d04(_0x18dd74, _0x98281) {
  const _0xb26206 = _0xb262();
  return _0x4d04 = function(_0x4d04bf, _0x5971ad) {
    _0x4d04bf = _0x4d04bf - 491;
    let _0x5b03d2 = _0xb26206[_0x4d04bf];
    return _0x5b03d2;
  }, _0x4d04(_0x18dd74, _0x98281);
}
var Pe5 = "edit-history-viewer.config";
var le3 = {};
var ss2 = Object[_0x24fbc0(668)];
var is = (_0x256110, _0x15bb1b, _0xad7b67, _0x4d7bda) => {
  for (var _0x3b4c80 = _0x4d7bda > 1 ? void 0 : _0x4d7bda ? ss2(_0x15bb1b, _0xad7b67) : _0x15bb1b, _0x199fcb = _0x256110["length"] - 1, _0x331d56; _0x199fcb >= 0; _0x199fcb--) (_0x331d56 = _0x256110[_0x199fcb]) && (_0x3b4c80 = _0x331d56(_0x3b4c80) || _0x3b4c80);
  return _0x3b4c80;
};
var ns = (_0x26711d, _0x3072fa) => (_0x4a793c, _0x1d9a70) => _0x3072fa(_0x4a793c, _0x1d9a70, _0x26711d);
var H2 = class extends Ve {
  constructor(_0x183192) {
    const _0x3a10c7 = _0x24fbc0;
    super(), this[_0x3a10c7(499)] = _0x183192, this["_init"]();
  }
  [_0x24fbc0(493)]() {
    const _0x219ef7 = _0x24fbc0;
    this[_0x219ef7(693)](this[_0x219ef7(499)][_0x219ef7(709)][_0x219ef7(597)]((_0x2adf85) => {
      const _0x3b739d = _0x219ef7;
      _0x2adf85 != null && _0x2adf85[_0x3b739d(931)] && this[_0x3b739d(499)][_0x3b739d(606)]({ "show": false });
    }));
  }
};
H2 = is([ns(0, ls)], H2);
var W2 = ((_0x3341fd) => (_0x3341fd[_0x3341fd[_0x24fbc0(811)] = 0] = _0x24fbc0(811), _0x3341fd[_0x3341fd["OK"] = 1] = "OK", _0x3341fd[_0x3341fd[_0x24fbc0(899)] = 2] = _0x24fbc0(899), _0x3341fd[_0x3341fd[_0x24fbc0(738)] = 3] = _0x24fbc0(738), _0x3341fd[_0x3341fd["NOT_FOUND"] = 4] = _0x24fbc0(538), _0x3341fd[_0x3341fd[_0x24fbc0(523)] = 5] = _0x24fbc0(523), _0x3341fd[_0x3341fd["ALREADY_EXISTS"] = 6] = "ALREADY_EXISTS", _0x3341fd[_0x3341fd[_0x24fbc0(702)] = 7] = _0x24fbc0(702), _0x3341fd[_0x3341fd[_0x24fbc0(890)] = 8] = "TOO_MANY_REQUESTS", _0x3341fd[_0x3341fd["COMPLETION_FINISHED"] = 9] = _0x24fbc0(836), _0x3341fd[_0x3341fd[_0x24fbc0(509)] = 10] = _0x24fbc0(509), _0x3341fd[_0x3341fd["MOBILE_VERIFY_CODE_MISMATCH"] = 11] = _0x24fbc0(550), _0x3341fd[_0x3341fd[_0x24fbc0(553)] = 12] = _0x24fbc0(553), _0x3341fd[_0x3341fd[_0x24fbc0(530)] = 13] = _0x24fbc0(530), _0x3341fd[_0x3341fd["EMAIL_VERIFY_CODE_NOT_FOUND_OR_EXPIRED"] = 14] = "EMAIL_VERIFY_CODE_NOT_FOUND_OR_EXPIRED", _0x3341fd[_0x3341fd[_0x24fbc0(779)] = 15] = _0x24fbc0(779), _0x3341fd[_0x3341fd[_0x24fbc0(843)] = 16] = _0x24fbc0(843), _0x3341fd[_0x3341fd["CURRENT_STATUS_CANNOT_OPERATE"] = 100] = _0x24fbc0(729), _0x3341fd[_0x3341fd[_0x24fbc0(570)] = 101] = _0x24fbc0(570), _0x3341fd[_0x3341fd[_0x24fbc0(756)] = 201] = _0x24fbc0(756), _0x3341fd[_0x3341fd[_0x24fbc0(731)] = 202] = _0x24fbc0(731), _0x3341fd[_0x3341fd["CHANGESET_REVISION_CONFILICT"] = 5001] = _0x24fbc0(646), _0x3341fd[_0x3341fd["SNAPSHOT_INVALID_SNAPSHOT"] = 6001] = _0x24fbc0(757), _0x3341fd[_0x3341fd[_0x24fbc0(835)] = 6002] = _0x24fbc0(835), _0x3341fd[_0x3341fd[_0x24fbc0(525)] = 6003] = "ENSURE_SNAPSHOT_EXECUTION", _0x3341fd[_0x3341fd[_0x24fbc0(809)] = 7001] = _0x24fbc0(809), _0x3341fd[_0x3341fd[_0x24fbc0(732)] = 7002] = _0x24fbc0(732), _0x3341fd[_0x3341fd["APPLY_REVISION_CONFILICT"] = 7003] = _0x24fbc0(891), _0x3341fd[_0x3341fd[_0x24fbc0(578)] = 7004] = "APPLY_PERMISSION_DENIED", _0x3341fd[_0x3341fd["APPLY_DUPLICATED"] = 7005] = _0x24fbc0(684), _0x3341fd[_0x3341fd[_0x24fbc0(847)] = 8001] = _0x24fbc0(847), _0x3341fd[_0x3341fd["LICENSE_MAX_UNITS_EXCEEDED"] = 9001] = _0x24fbc0(937), _0x3341fd[_0x3341fd[_0x24fbc0(628)] = 9002] = _0x24fbc0(628), _0x3341fd[_0x3341fd["LICENSE_IMPORT_SIZE_EXCEEDED"] = 9003] = _0x24fbc0(599), _0x3341fd[_0x3341fd[_0x24fbc0(838)] = 9004] = _0x24fbc0(838), _0x3341fd[_0x3341fd[_0x24fbc0(673)] = 9005] = _0x24fbc0(673), _0x3341fd[_0x3341fd["YUUMI_UNABLE_LOAD_URL"] = 10001] = _0x24fbc0(528), _0x3341fd[_0x3341fd[_0x24fbc0(882)] = 10002] = _0x24fbc0(882), _0x3341fd[_0x3341fd[_0x24fbc0(604)] = 10003] = _0x24fbc0(604), _0x3341fd[_0x3341fd[_0x24fbc0(616)] = 10004] = "YUUMI_SUBSCRIPTION_NOT_FOUND", _0x3341fd[_0x3341fd["YUUMI_NO_CUBOID_FOR_QUESTION"] = 10010] = _0x24fbc0(723), _0x3341fd[_0x3341fd[_0x24fbc0(532)] = 10011] = _0x24fbc0(532), _0x3341fd[_0x3341fd[_0x24fbc0(909)] = 10012] = _0x24fbc0(909), _0x3341fd[_0x3341fd[_0x24fbc0(810)] = 10013] = _0x24fbc0(810), _0x3341fd[_0x3341fd[_0x24fbc0(737)] = 10014] = _0x24fbc0(737), _0x3341fd[_0x3341fd[_0x24fbc0(712)] = 10015] = _0x24fbc0(712), _0x3341fd[_0x3341fd[_0x24fbc0(826)] = 10016] = _0x24fbc0(826), _0x3341fd[_0x3341fd[_0x24fbc0(641)] = 11001] = _0x24fbc0(641), _0x3341fd[_0x3341fd[_0x24fbc0(943)] = 12001] = _0x24fbc0(943), _0x3341fd[_0x3341fd[_0x24fbc0(894)] = 12002] = _0x24fbc0(894), _0x3341fd[_0x3341fd["INVITE_CODE_REQUIRED"] = 12003] = "INVITE_CODE_REQUIRED", _0x3341fd[_0x3341fd[_0x24fbc0(868)] = 12004] = _0x24fbc0(868), _0x3341fd[_0x3341fd[_0x24fbc0(714)] = 12005] = _0x24fbc0(714), _0x3341fd[_0x3341fd["WECHAT_HAS_BEEN_BOUND"] = 13001] = "WECHAT_HAS_BEEN_BOUND", _0x3341fd[_0x3341fd["MOBILE_HAS_BEEN_BOUND"] = 13002] = _0x24fbc0(724), _0x3341fd[_0x3341fd["EMAIL_HAS_BEEN_BOUND"] = 13003] = _0x24fbc0(919), _0x3341fd[_0x3341fd[_0x24fbc0(600)] = 14001] = _0x24fbc0(600), _0x3341fd[_0x3341fd["ENTITLE_UPDOWN_GRADE_NOT_SUPPORT"] = 14002] = _0x24fbc0(920), _0x3341fd[_0x3341fd[_0x24fbc0(518)] = 14003] = _0x24fbc0(518), _0x3341fd[_0x3341fd["PAYMENT_CHANNEL_NOT_SUPPORT"] = 14004] = _0x24fbc0(774), _0x3341fd[_0x3341fd["ENTITLE_CHAT_LIMIT_EXCEED"] = 14101] = _0x24fbc0(880), _0x3341fd[_0x3341fd[_0x24fbc0(846)] = 14102] = _0x24fbc0(846), _0x3341fd[_0x3341fd["ENTITLE_INSUFFICIENT_QUOTA"] = 14103] = "ENTITLE_INSUFFICIENT_QUOTA", _0x3341fd[_0x3341fd[_0x24fbc0(853)] = 14301] = "ENTITLE_NEED_BILLING_ADDRESS", _0x3341fd[_0x3341fd[_0x24fbc0(910)] = 15001] = _0x24fbc0(910), _0x3341fd[_0x3341fd[_0x24fbc0(692)] = 15002] = _0x24fbc0(692), _0x3341fd[_0x3341fd["REDEMPTION_CODE_FULLY_REDEEMED"] = 15003] = _0x24fbc0(614), _0x3341fd[_0x3341fd[_0x24fbc0(925)] = 15004] = _0x24fbc0(925), _0x3341fd[_0x3341fd[_0x24fbc0(938)] = 15005] = "REDEMPTION_USER_NOT_ELIGIBLE", _0x3341fd[_0x3341fd["REDEMPTION_USER_REDEEM_TIMES_EXCEED"] = 15006] = "REDEMPTION_USER_REDEEM_TIMES_EXCEED", _0x3341fd[_0x3341fd["REDEMPTION_CODE_HAS_BEEN_CREATED"] = 15007] = "REDEMPTION_CODE_HAS_BEEN_CREATED", _0x3341fd[_0x3341fd[_0x24fbc0(542)] = 16001] = _0x24fbc0(542), _0x3341fd[_0x3341fd[_0x24fbc0(718)] = -1] = _0x24fbc0(718), _0x3341fd))(W2 || {});
var x2 = ((_0x353ed0) => (_0x353ed0[_0x353ed0[_0x24fbc0(771)] = 0] = "UNIVER_UNKNOWN", _0x353ed0[_0x353ed0[_0x24fbc0(873)] = 1] = "UNIVER_DOC", _0x353ed0[_0x353ed0[_0x24fbc0(567)] = 2] = _0x24fbc0(567), _0x353ed0[_0x353ed0[_0x24fbc0(935)] = 3] = _0x24fbc0(935), _0x353ed0[_0x353ed0[_0x24fbc0(856)] = 4] = _0x24fbc0(856), _0x353ed0[_0x353ed0[_0x24fbc0(718)] = -1] = "UNRECOGNIZED", _0x353ed0))(x2 || {});
var D2 = ((_0xe61ac8) => (_0xe61ac8[_0xe61ac8[_0x24fbc0(623)] = 0] = _0x24fbc0(623), _0xe61ac8[_0xe61ac8[_0x24fbc0(496)] = 1] = _0x24fbc0(496), _0xe61ac8[_0xe61ac8["ManageCollaborator"] = 2] = "ManageCollaborator", _0xe61ac8[_0xe61ac8["Print"] = 3] = _0x24fbc0(577), _0xe61ac8[_0xe61ac8[_0x24fbc0(592)] = 4] = _0x24fbc0(592), _0xe61ac8[_0xe61ac8["Comment"] = 5] = "Comment", _0xe61ac8[_0xe61ac8[_0x24fbc0(917)] = 6] = _0x24fbc0(917), _0xe61ac8[_0xe61ac8["Share"] = 7] = _0x24fbc0(913), _0xe61ac8[_0xe61ac8[_0x24fbc0(815)] = 8] = _0x24fbc0(815), _0xe61ac8[_0xe61ac8[_0x24fbc0(585)] = 9] = _0x24fbc0(585), _0xe61ac8[_0xe61ac8[_0x24fbc0(902)] = 10] = _0x24fbc0(902), _0xe61ac8[_0xe61ac8[_0x24fbc0(786)] = 11] = _0x24fbc0(786), _0xe61ac8[_0xe61ac8[_0x24fbc0(680)] = 12] = _0x24fbc0(680), _0xe61ac8[_0xe61ac8["CreateWorksheet"] = 13] = _0x24fbc0(665), _0xe61ac8[_0xe61ac8[_0x24fbc0(560)] = 14] = _0x24fbc0(560), _0xe61ac8[_0xe61ac8["EditWorksheetCell"] = 15] = _0x24fbc0(697), _0xe61ac8[_0xe61ac8[_0x24fbc0(930)] = 16] = "InsertHyperlink", _0xe61ac8[_0xe61ac8[_0x24fbc0(776)] = 17] = _0x24fbc0(776), _0xe61ac8[_0xe61ac8[_0x24fbc0(678)] = 18] = _0x24fbc0(678), _0xe61ac8[_0xe61ac8[_0x24fbc0(710)] = 19] = "PivotTable", _0xe61ac8[_0xe61ac8[_0x24fbc0(766)] = 20] = _0x24fbc0(766), _0xe61ac8[_0xe61ac8[_0x24fbc0(758)] = 21] = "History", _0xe61ac8[_0xe61ac8[_0x24fbc0(813)] = 22] = _0x24fbc0(813), _0xe61ac8[_0xe61ac8[_0x24fbc0(854)] = 23] = _0x24fbc0(854), _0xe61ac8[_0xe61ac8[_0x24fbc0(734)] = 24] = _0x24fbc0(734), _0xe61ac8[_0xe61ac8[_0x24fbc0(571)] = 25] = _0x24fbc0(571), _0xe61ac8[_0xe61ac8["DeleteSheet"] = 26] = _0x24fbc0(632), _0xe61ac8[_0xe61ac8[_0x24fbc0(513)] = 27] = _0x24fbc0(513), _0xe61ac8[_0xe61ac8["CopySheet"] = 28] = "CopySheet", _0xe61ac8[_0xe61ac8[_0x24fbc0(659)] = 29] = "RenameSheet", _0xe61ac8[_0xe61ac8[_0x24fbc0(631)] = 30] = _0x24fbc0(631), _0xe61ac8[_0xe61ac8[_0x24fbc0(699)] = 31] = _0x24fbc0(699), _0xe61ac8[_0xe61ac8["SelectUnProtectedCells"] = 32] = _0x24fbc0(573), _0xe61ac8[_0xe61ac8[_0x24fbc0(881)] = 33] = "SetCellStyle", _0xe61ac8[_0xe61ac8["SetCellValue"] = 34] = _0x24fbc0(823), _0xe61ac8[_0xe61ac8[_0x24fbc0(572)] = 35] = _0x24fbc0(572), _0xe61ac8[_0xe61ac8["SetColumnStyle"] = 36] = _0x24fbc0(559), _0xe61ac8[_0xe61ac8[_0x24fbc0(898)] = 37] = _0x24fbc0(898), _0xe61ac8[_0xe61ac8[_0x24fbc0(728)] = 38] = _0x24fbc0(728), _0xe61ac8[_0xe61ac8[_0x24fbc0(630)] = 39] = _0x24fbc0(630), _0xe61ac8[_0xe61ac8[_0x24fbc0(637)] = 40] = "DeleteColumn", _0xe61ac8[_0xe61ac8["EditExtraObject"] = 41] = _0x24fbc0(915), _0xe61ac8[_0xe61ac8[_0x24fbc0(795)] = 42] = "Delete", _0xe61ac8[_0xe61ac8["RecoverHistory"] = 43] = _0x24fbc0(800), _0xe61ac8[_0xe61ac8[_0x24fbc0(849)] = 44] = _0x24fbc0(849), _0xe61ac8[_0xe61ac8[_0x24fbc0(500)] = 45] = _0x24fbc0(500), _0xe61ac8[_0xe61ac8[_0x24fbc0(718)] = -1] = _0x24fbc0(718), _0xe61ac8))(D2 || {});
function rs(_0x399468) {
  const _0x5bf8d4 = _0x24fbc0;
  return !!(_0x399468 && _0x399468[_0x5bf8d4(905)] && _0x399468[_0x5bf8d4(905)] !== W2["OK"] && _0x399468[_0x5bf8d4(905)] !== "OK");
}
var ie5 = (_0x162591, _0x1c419e) => {
  const _0x5d7024 = _0x24fbc0;
  if (!_0x162591) return { "date": "", "time": "" };
  const _0x1ae2de = new Date(_0x162591), _0x2781f1 = _0x1ae2de[_0x5d7024(521)]()[_0x5d7024(627)]("T")[0];
  switch (_0x1c419e) {
    case Ns["ZH_CN"]:
      return { "date": J5(_0x2781f1, _0x1c419e), "time": _0x1ae2de[_0x5d7024(760)]() + ":" + String(_0x1ae2de[_0x5d7024(942)]())[_0x5d7024(901)](2, "0") };
    default:
      return { "date": J5(_0x2781f1, _0x1c419e), "time": _0x1ae2de[_0x5d7024(760)]() + ":" + _0x1ae2de[_0x5d7024(942)]() };
  }
};
var as = (_0x3e37de, _0x2bb09d) => {
  const _0x1c1e0a = _0x24fbc0, _0x33688b = _0x3e37de["user"] || _0x2bb09d["t"](_0x1c1e0a(492));
  if (_0x3e37de[_0x1c1e0a(648)][_0x1c1e0a(861)]((_0x10e7b6) => _0x10e7b6 === se["id"]) && _0x3e37de[_0x1c1e0a(772)]) {
    const _0x4ddd08 = ie5(_0x3e37de["recoverTime"], _0x2bb09d[_0x1c1e0a(767)]()), _0x2a6006 = _0x4ddd08["date"] + " " + _0x4ddd08["time"];
    return _0x33688b + " " + _0x2bb09d["t"](_0x1c1e0a(634)) + " " + _0x2a6006 + " " + _0x2bb09d["t"](_0x1c1e0a(575));
  }
  const _0x532ada = os(_0x3e37de), _0x184581 = _0x532ada[_0x1c1e0a(618)] === 1 ? _0x2bb09d["t"](_0x532ada[0]) : "" + _0x2bb09d["t"](_0x532ada[0]) + _0x2bb09d["t"](_0x1c1e0a(638));
  return _0x33688b + " " + _0x184581;
};
function os(_0x2425a0) {
  const _0x3d49c0 = _0x24fbc0;
  if (_0x2425a0[_0x3d49c0(648)][_0x3d49c0(618)] === 0) return [""];
  const _0x184ced = _0x3d49c0(837), _0xa780de = _0x184ced + _0x3d49c0(924), _0x5e02e8 = [{ "id": pd["id"], "action": _0x184ced + "createSheet" }, { "id": se["id"], "action": _0x184ced + _0x3d49c0(569) }, { "id": hn["id"], "action": _0x184ced + _0x3d49c0(750) }, { "id": Ht["id"], "action": _0x184ced + _0x3d49c0(933) }, { "id": st["id"], "action": _0x184ced + _0x3d49c0(755) }, { "id": R["id"], "action": _0x184ced + "setFilter" }, { "id": S["id"], "action": _0x184ced + _0x3d49c0(735) }, { "id": v["id"], "action": _0x184ced + "setDV" }, { "id": o2["id"], "action": _0x184ced + _0x3d49c0(791) }, { "id": a2["id"], "action": _0x184ced + _0x3d49c0(791) }, { "id": ft["id"], "action": _0x184ced + _0x3d49c0(908) }, { "id": Be["id"], "action": _0x184ced + _0x3d49c0(908) }, { "id": V2["id"], "action": _0x184ced + _0x3d49c0(633) }, { "id": ot["id"], "action": _0x184ced + "deleteProtection" }, { "id": _t["id"], "action": _0x184ced + _0x3d49c0(921) }]["filter"]((_0x2e7870) => _0x2425a0[_0x3d49c0(648)][_0x3d49c0(620)](_0x2e7870["id"]));
  return _0x5e02e8 != null && _0x5e02e8[_0x3d49c0(618)] ? _0x5e02e8["map"]((_0x2b3f44) => _0x2b3f44[_0x3d49c0(683)]) : [_0xa780de];
}
function J5(_0x161a30, _0x1df202) {
  const _0x53e583 = _0x24fbc0, [_0x3aabfb, _0x47001e, _0xb847dd] = (/* @__PURE__ */ new Date())["toISOString"]()[_0x53e583(627)]("T")[0][_0x53e583(627)]("-"), [_0x5d69df, _0x29f045, _0xd29969] = _0x161a30[_0x53e583(627)]("-"), _0x5442ba = _0x3aabfb === _0x5d69df && _0x47001e === _0x29f045 && _0xb847dd === _0xd29969;
  let _0x538299 = "", _0x5e790a = "", _0x6518ba = "";
  switch (_0x1df202) {
    case Ns["ZH_CN"]:
      return _0x5442ba ? "" : (_0x538299 = _0x3aabfb === _0x5d69df ? "" : _0x5d69df + "", _0x5e790a = _0x29f045 + "", _0x6518ba = _0xd29969 + "", "" + _0x538299 + _0x5e790a + _0x6518ba);
    default:
      return _0x5442ba ? _0x53e583(534) : (_0x538299 = _0x3aabfb === _0x5d69df ? "" : _0x5d69df + "-", _0x5e790a = _0x29f045 + "-", _0x6518ba = "" + _0xd29969, "" + _0x538299 + _0x5e790a + _0x6518ba);
  }
}
function cs(_0x2cd1b5) {
  return _0x2cd1b5 ? _0x2cd1b5["reduce"]((_0xa437c1, _0x4b8c6d) => {
    const _0x19e5e6 = _0x4d04, _0x1ccffd = new Date(_0x4b8c6d[_0x19e5e6(717)])[_0x19e5e6(521)]()[_0x19e5e6(627)]("T")[0];
    return _0xa437c1[_0x19e5e6(618)] > 0 && _0xa437c1[_0xa437c1["length"] - 1][_0x19e5e6(799)] === _0x1ccffd ? _0xa437c1[_0xa437c1[_0x19e5e6(618)] - 1][_0x19e5e6(752)][_0x19e5e6(869)](_0x4b8c6d) : _0xa437c1[_0x19e5e6(869)]({ "dateString": _0x1ccffd, "versions": [_0x4b8c6d] }), _0xa437c1;
  }, []) : [];
}
var _s = Object["getOwnPropertyDescriptor"];
var ls2 = (_0xc26948, _0xbfd9fb, _0x4cbcb3, _0x5695de) => {
  const _0x192f50 = _0x24fbc0;
  for (var _0x48043c = _0x5695de > 1 ? void 0 : _0x5695de ? _s(_0xbfd9fb, _0x4cbcb3) : _0xbfd9fb, _0x3727dc = _0xc26948[_0x192f50(618)] - 1, _0x4f12ff; _0x3727dc >= 0; _0x3727dc--) (_0x4f12ff = _0xc26948[_0x3727dc]) && (_0x48043c = _0x4f12ff(_0x48043c) || _0x48043c);
  return _0x48043c;
};
var O = (_0x1ec607, _0x304c72) => (_0x3860ee, _0x41ae58) => _0x304c72(_0x3860ee, _0x41ae58, _0x1ec607);
var us = _0x24fbc0(522);
var A3 = class extends Ve {
  constructor(_0x3d24bc, _0x515e86, _0xe9b5fd, _0x2bebc8, _0x275921, _0x5886df, _0x4d24bf) {
    const _0x5342f8 = _0x24fbc0;
    super(), _(this, "_workbookDataCache", /* @__PURE__ */ new Map()), this["_snapshotServerService"] = _0x3d24bc, this["_univerInstanceService"] = _0x515e86, this[_0x5342f8(804)] = _0xe9b5fd, this[_0x5342f8(695)] = _0x2bebc8, this[_0x5342f8(551)] = _0x275921, this[_0x5342f8(848)] = _0x5886df, this[_0x5342f8(807)] = _0x4d24bf;
  }
  ["dispose"]() {
    const _0x349586 = _0x24fbc0;
    this[_0x349586(802)][_0x349586(625)](), super[_0x349586(491)]();
  }
  async [_0x24fbc0(591)](_0x200de0, _0x203f53) {
    const _0x479a27 = _0x24fbc0, _0x841e23 = this[_0x479a27(867)]() + "/" + _0x200de0 + _0x479a27(537) + (_0x203f53 ? "&lastLabel=" + _0x203f53 : "");
    try {
      const _0x1e5d52 = (await this[_0x479a27(551)]["get"](_0x841e23))["body"];
      if (_0x1e5d52 && _0x1e5d52[_0x479a27(749)] && _0x1e5d52["error"]["code"] === W2["OK"]) {
        const { hasMore: _0x5826a0, lastLabel: _0x4f17e8 } = _0x1e5d52, _0x5a35b9 = hs(_0x1e5d52), _0x21b295 = _0x1e5d52[_0x479a27(626)][_0x479a27(650)];
        return { "hasMore": _0x5826a0, "lastLabel": _0x4f17e8, "versions": _0x5a35b9, "members": _0x21b295 };
      }
    } catch (_0x34e2d6) {
      console[_0x479a27(749)](_0x34e2d6);
    }
    return null;
  }
  [_0x24fbc0(867)]() {
    const _0x5a39e6 = _0x24fbc0;
    var _0x40be64;
    const _0x5a119c = this[_0x5a39e6(695)][_0x5a39e6(677)](Pe5);
    return (_0x40be64 = _0x5a119c == null ? void 0 : _0x5a119c[_0x5a39e6(862)]) != null ? _0x40be64 : us;
  }
  async ["loadSheet"](_0x1e957e, _0x268ca4, _0x28712c) {
    const _0x4cab99 = _0x24fbc0;
    var _0x2b0128, _0x12a8b9;
    _0x28712c === void 0 && (_0x28712c = {}), this[_0x4cab99(802)][_0x4cab99(517)](_0x1e957e) || this[_0x4cab99(802)][_0x4cab99(506)](_0x1e957e, /* @__PURE__ */ new Map());
    const { snapshot: _0x55c424, changesets: _0x1b16cd, error: _0x571c86 } = await this["_snapshotServerService"][_0x4cab99(516)](_0x28712c, { "unitID": _0x1e957e, "type": x2["UNIVER_SHEET"], "revision": _0x268ca4 });
    if (rs(_0x571c86) || !_0x55c424 || !_0x55c424["workbook"]) throw new Error(_0x4cab99(671));
    const _0x44d23c = (_0x2b0128 = _0x1b16cd == null ? void 0 : _0x1b16cd[_0x4cab99(618)]) != null ? _0x2b0128 : 0;
    if (_0x268ca4 !== 0 && _0x55c424[_0x4cab99(524)] + _0x44d23c !== _0x268ca4) throw new Error(_0x4cab99(531));
    const { workbook: _0x5b7622 } = _0x55c424, _0x2b8ce2 = _0x5b7622[_0x4cab99(801)] ? Object[_0x4cab99(669)](_0x5b7622[_0x4cab99(801)])[_0x4cab99(789)](([_0x4e4efb, _0x2e621b]) => {
      const _0x3acc16 = _0x4cab99;
      var _0x3fe10a, _0x560781;
      return (_0x560781 = (_0x3fe10a = _0x2e621b[_0x3acc16(579)]) == null ? void 0 : _0x3fe10a["map"]((_0x2b4707) => _0x2b4707)) != null ? _0x560781 : [];
    })[_0x4cab99(652)]() : [], _0x959f89 = (await Promise["all"](_0x2b8ce2["map"]((_0x71e829) => this[_0x4cab99(824)][_0x4cab99(814)](_0x28712c, { "unitID": _0x1e957e, "type": x2[_0x4cab99(567)], "blockID": _0x71e829 })[_0x4cab99(515)]((_0x1203c8) => _0x1203c8["block"]))))[_0x4cab99(694)]((_0x1c916f) => !!_0x1c916f), _0x4432c5 = Hm(_0x55c424, _0x959f89, _0x28712c);
    return (_0x12a8b9 = this["_workbookDataCache"][_0x4cab99(878)](_0x1e957e)) == null || _0x12a8b9["set"](_0x268ca4, { "workbook": _0x4432c5 }), new Promise((_0x42149b) => {
      const _0x1fb344 = _0x4cab99, _0x342256 = this[_0x1fb344(508)][_0x1fb344(703)](we[_0x1fb344(567)]);
      _0x342256 ? (this[_0x1fb344(508)][_0x1fb344(923)](_0x342256[_0x1fb344(595)]()), setTimeout(() => {
        const _0x3a7ef4 = _0x1fb344;
        this[_0x3a7ef4(790)](_0x4432c5, _0x1b16cd), this["_sheetPermissionInitController"]["refreshRangeProtectPermission"](), _0x42149b(true);
      }, 0)) : (this[_0x1fb344(790)](_0x4432c5, _0x1b16cd), _0x42149b(true));
    });
  }
  [_0x24fbc0(790)](_0x13d5dd, _0x3539e4) {
    const _0x376951 = _0x24fbc0, _0x58b23f = this[_0x376951(508)][_0x376951(726)](we[_0x376951(567)], _0x13d5dd);
    this[_0x376951(508)][_0x376951(928)](_0x58b23f["getUnitId"]());
    const _0x5cc410 = this[_0x376951(848)][_0x376951(874)][_0x376951(503)](this[_0x376951(848)][_0x376951(874)]["getInterceptPoints"]()[_0x376951(580)]);
    return _0x3539e4 == null || _0x3539e4[_0x376951(556)]((_0x3af7ba) => {
      const _0x46389 = _0x376951, _0x49da62 = _0x3af7ba[_0x46389(687)][_0x46389(789)]((_0x104a0f) => ({ "id": _0x104a0f["id"], "params": JSON["parse"](_0x104a0f[_0x46389(543)]) }));
      ({ ..._0x3af7ba, "mutations": _0x5cc410(_0x49da62, null) || _0x49da62 })[_0x46389(687)][_0x46389(556)]((_0x4c56e2) => {
        const _0x188fba = _0x46389;
        this[_0x188fba(804)][_0x188fba(787)](_0x4c56e2["id"]) && this["_commandService"]["syncExecuteCommand"](_0x4c56e2["id"], _0x4c56e2["params"]);
      });
    }), _0x58b23f;
  }
};
A3 = ls2([O(0, gr2), O(1, vr), O(2, Ls), O(3, ic), O(4, Inject(x)), O(5, Inject(pr)), O(6, Inject($t))], A3);
function hs(_0x573761) {
  const _0x59b8af = _0x24fbc0;
  var _0x35f0de, _0x14ee24;
  const _0x5c513b = [], { entities: _0x218cde, historyIds: _0x1784ee } = _0x573761, { datas: _0x25104b, users: _0x3b59d7 } = _0x218cde;
  for (const _0x2df992 of _0x1784ee) if (_0x25104b[_0x2df992]) {
    const _0x45417e = !!((_0x35f0de = _0x3b59d7[_0x25104b[_0x2df992][_0x59b8af(858)]]) != null && _0x35f0de[_0x59b8af(635)]);
    _0x5c513b[_0x59b8af(869)]({ "unitId": _0x25104b[_0x2df992][_0x59b8af(784)], "user": _0x45417e ? "" : ((_0x14ee24 = _0x3b59d7 == null ? void 0 : _0x3b59d7[_0x25104b[_0x2df992][_0x59b8af(858)]]) == null ? void 0 : _0x14ee24["name"]) || "", "isAnonymous": _0x45417e, "id": _0x2df992, "time": _0x25104b[_0x2df992][_0x59b8af(841)] ? Number(_0x25104b[_0x2df992][_0x59b8af(841)]) : void 0, "commands": _0x25104b[_0x2df992][_0x59b8af(887)], "startRev": Number(_0x25104b[_0x2df992][_0x59b8af(672)]), "endRev": Number(_0x25104b[_0x2df992]["endRevision"]), "recoverTime": _0x25104b[_0x2df992][_0x59b8af(772)] ? Number(_0x25104b[_0x2df992][_0x59b8af(772)]) : void 0 });
  }
  return _0x5c513b;
}
var Is = Object["getOwnPropertyDescriptor"];
var ds = (_0x43204f, _0xb1424d, _0x4ffd23, _0x1b1f54) => {
  const _0x4c7976 = _0x24fbc0;
  for (var _0x44f932 = _0x1b1f54 > 1 ? void 0 : _0x1b1f54 ? Is(_0xb1424d, _0x4ffd23) : _0xb1424d, _0x33e579 = _0x43204f[_0x4c7976(618)] - 1, _0x2ce604; _0x33e579 >= 0; _0x33e579--) (_0x2ce604 = _0x43204f[_0x33e579]) && (_0x44f932 = _0x2ce604(_0x44f932) || _0x44f932);
  return _0x44f932;
};
var $2 = (_0x7a3742, _0x488f45) => (_0x56a12a, _0x2d6582) => _0x488f45(_0x56a12a, _0x2d6582, _0x7a3742);
var ne2 = ((_0x145b66) => (_0x145b66[_0x24fbc0(689)] = _0x24fbc0(761), _0x145b66[_0x24fbc0(883)] = "exited", _0x145b66[_0x24fbc0(785)] = _0x24fbc0(749), _0x145b66))(ne2 || {});
var y = ((_0x4b2bad) => (_0x4b2bad[_0x24fbc0(661)] = _0x24fbc0(866), _0x4b2bad[_0x24fbc0(904)] = _0x24fbc0(889), _0x4b2bad[_0x24fbc0(763)] = _0x24fbc0(498), _0x4b2bad))(y || {});
var vs = _0x24fbc0(857);
var g2 = class extends Ve {
  constructor(_0x4d4fca, _0x5deab5, _0x1a9138, _0x5d1bdb) {
    const _0x55a8e3 = _0x24fbc0;
    super(), _(this, "_versions$", new BehaviorSubject([])), _(this, _0x55a8e3(563), this["_versions$"][_0x55a8e3(927)]()), _(this, _0x55a8e3(940), new BehaviorSubject("")), _(this, "currentVersion$", this[_0x55a8e3(940)]["asObservable"]()), _(this, _0x55a8e3(589), new BehaviorSubject("entered")), _(this, _0x55a8e3(649), this[_0x55a8e3(589)][_0x55a8e3(927)]()), _(this, _0x55a8e3(778), new BehaviorSubject(0)), _(this, _0x55a8e3(842), this[_0x55a8e3(778)][_0x55a8e3(927)]()), _(this, _0x55a8e3(817), new BehaviorSubject("")), _(this, _0x55a8e3(667), this["_unitId$"]["asObservable"]()), _(this, _0x55a8e3(612), false), _(this, "_loadingState$", new BehaviorSubject(_0x55a8e3(866))), _(this, _0x55a8e3(707), this[_0x55a8e3(739)][_0x55a8e3(927)]()), _(this, _0x55a8e3(593), null), _(this, _0x55a8e3(674), true), _(this, _0x55a8e3(740), /* @__PURE__ */ new Map()), _(this, _0x55a8e3(840)), _(this, _0x55a8e3(922)), _(this, "_maskElement"), _(this, _0x55a8e3(660), false), this[_0x55a8e3(544)] = _0x4d4fca, this[_0x55a8e3(615)] = _0x5deab5, this[_0x55a8e3(907)] = _0x1a9138, this[_0x55a8e3(640)] = _0x5d1bdb;
  }
  async [_0x24fbc0(698)](_0x118bc9, _0x355501, _0x4c2cc1) {
    const _0x34f13a = _0x24fbc0;
    this[_0x34f13a(840)] = _0x355501, this[_0x34f13a(660)] = _0x4c2cc1, this[_0x34f13a(817)][_0x34f13a(830)](_0x118bc9), this[_0x34f13a(612)] = true;
    const _0x5b6434 = await this[_0x34f13a(640)][_0x34f13a(591)](_0x118bc9);
    if (this[_0x34f13a(612)] = false, _0x5b6434) {
      const { versions: _0x31ae17, lastLabel: _0x218dec, hasMore: _0x14c053, members: _0x1de967 } = _0x5b6434;
      _0x31ae17[_0x34f13a(618)] === 0 && _0x31ae17["push"]({ "unitId": _0x118bc9, "id": vs, "startRev": 1, "endRev": 0, "time": Date[_0x34f13a(727)](), "user": this["_localeService"]["t"]("editHistory.panel.currentUser"), "commands": [], "isAnonymous": false }), this["_updateVersions"](_0x31ae17, _0x14c053, _0x218dec, _0x1de967), this["_currentVersion$"][_0x34f13a(830)](_0x31ae17[0]["id"]);
    } else this[_0x34f13a(589)][_0x34f13a(830)]("error");
  }
  async [_0x24fbc0(651)]() {
    const _0x181d18 = _0x24fbc0;
    if (!this[_0x181d18(593)] || !this[_0x181d18(674)] || this[_0x181d18(612)]) return false;
    this[_0x181d18(612)] = true;
    const _0x184eb7 = await this[_0x181d18(640)][_0x181d18(591)](this[_0x181d18(784)], this[_0x181d18(593)]);
    if (this[_0x181d18(612)] = false, _0x184eb7) {
      const { versions: _0x520e9f, lastLabel: _0x4bcded, hasMore: _0x27f07c, members: _0x543d48 } = _0x184eb7;
      this[_0x181d18(565)](_0x520e9f, _0x27f07c, _0x4bcded, _0x543d48);
    } else this[_0x181d18(544)][_0x181d18(931)]({ "content": this[_0x181d18(907)]["t"]("editHistory.panel.listFetchError"), "type": $C[_0x181d18(785)], "duration": 3e3 });
    return true;
  }
  async [_0x24fbc0(636)](_0x1e537e) {
    const _0x4fbb42 = _0x24fbc0;
    var _0x57d31f;
    const _0x23413a = (_0x57d31f = this["_versions$"][_0x4fbb42(792)]) == null ? void 0 : _0x57d31f["find"]((_0x36a547) => _0x36a547["id"] === _0x1e537e), { endRev: _0xe2696a } = _0x23413a || {};
    _0xe2696a || _0xe2696a === 0 ? (this[_0x4fbb42(739)][_0x4fbb42(830)]("loading"), await this[_0x4fbb42(640)][_0x4fbb42(831)](this[_0x4fbb42(784)], _0xe2696a), this[_0x4fbb42(739)][_0x4fbb42(830)](_0x4fbb42(498))) : this[_0x4fbb42(589)][_0x4fbb42(830)](_0x4fbb42(749));
  }
  async [_0x24fbc0(708)](_0x4d8d42) {
    const _0x10ae95 = _0x24fbc0, _0x1c5709 = _0x4d8d42 ? this["getVersion"](_0x4d8d42) : this[_0x10ae95(527)]();
    if (!_0x1c5709) return;
    const _0x5b026d = _0x1c5709[_0x10ae95(510)], _0x38c333 = ie5(_0x1c5709[_0x10ae95(717)], this[_0x10ae95(907)][_0x10ae95(767)]());
    await this["_confirmService"][_0x10ae95(495)]({ "id": _0x10ae95(704), "title": { "title": this["_localeService"]["t"](_0x10ae95(533)) }, "children": { "title": this["_localeService"]["t"](_0x10ae95(859)) + _0x10ae95(574) + _0x38c333[_0x10ae95(644)] + " " + _0x38c333[_0x10ae95(717)] + ")" }, "cancelText": this[_0x10ae95(907)]["t"](_0x10ae95(906)), "confirmText": this[_0x10ae95(907)]["t"](_0x10ae95(602)) }) && this[_0x10ae95(778)][_0x10ae95(830)](_0x5b026d);
  }
  ["_updateVersions"](_0xed6555, _0x396fba, _0x896970, _0x136c15) {
    const _0x5a2607 = _0x24fbc0;
    this[_0x5a2607(666)][_0x5a2607(830)](this[_0x5a2607(666)][_0x5a2607(792)]["concat"](_0xed6555)), this[_0x5a2607(674)] = _0x396fba, this[_0x5a2607(593)] = _0x896970, _0x136c15 && Object[_0x5a2607(736)](_0x136c15)[_0x5a2607(556)]((_0x21ab51) => this[_0x5a2607(740)][_0x5a2607(506)](_0x21ab51, _0x136c15[_0x21ab51]));
  }
  [_0x24fbc0(527)]() {
    const _0x43818d = _0x24fbc0;
    return this[_0x43818d(713)](this[_0x43818d(940)][_0x43818d(792)]);
  }
  [_0x24fbc0(713)](_0x3f3221) {
    const _0xeaa27c = _0x24fbc0;
    var _0x4786ce;
    return (_0x4786ce = this[_0xeaa27c(666)][_0xeaa27c(792)]) == null ? void 0 : _0x4786ce[_0xeaa27c(647)]((_0x68e017) => _0x68e017["id"] === _0x3f3221);
  }
  [_0x24fbc0(759)](_0x27f2de) {
    const _0x5702e5 = _0x24fbc0;
    return this[_0x5702e5(740)]["get"](_0x27f2de);
  }
  [_0x24fbc0(596)]() {
    const _0x512c87 = _0x24fbc0;
    this[_0x512c87(529)] = document["createElement"](_0x512c87(827)), this[_0x512c87(529)][_0x512c87(780)] = _0x512c87(941), this[_0x512c87(529)]["style"][_0x512c87(754)] = "absolute", this[_0x512c87(529)][_0x512c87(888)]["top"] = "0", this[_0x512c87(529)][_0x512c87(888)][_0x512c87(613)] = "0", this[_0x512c87(529)][_0x512c87(888)]["width"] = _0x512c87(701), this[_0x512c87(529)][_0x512c87(888)]["height"] = _0x512c87(701), this[_0x512c87(529)][_0x512c87(888)][_0x512c87(547)] = "rgba(225, 225, 225, 0.5)", this[_0x512c87(529)]["style"]["color"] = _0x512c87(783), this["_maskElement"][_0x512c87(888)][_0x512c87(621)] = _0x512c87(561), this[_0x512c87(529)][_0x512c87(888)][_0x512c87(884)] = _0x512c87(557), this[_0x512c87(529)]["style"]["zIndex"] = _0x512c87(721), this["_maskElement"]["style"][_0x512c87(621)] = "none", this[_0x512c87(922)][_0x512c87(825)](this["_maskElement"]);
  }
  [_0x24fbc0(879)]() {
    const _0x2ce2bf = _0x24fbc0;
    var _0x4aa069;
    const _0x2a4f59 = (_0x4aa069 = document[_0x2ce2bf(497)](this[_0x2ce2bf(840)])) == null ? void 0 : _0x4aa069[_0x2ce2bf(872)](_0x2ce2bf(808));
    _0x2a4f59 && (this["_maskContainer"] = _0x2a4f59, this[_0x2ce2bf(596)]());
  }
  [_0x24fbc0(775)]() {
    const _0x34478c = _0x24fbc0;
    this[_0x34478c(922)] || this["_initMaskContainer"](), this[_0x34478c(529)] && (this[_0x34478c(529)]["style"][_0x34478c(621)] = _0x34478c(561));
  }
  [_0x24fbc0(608)]() {
    const _0x35c949 = _0x24fbc0;
    this[_0x35c949(529)] && (this["_maskElement"][_0x35c949(888)][_0x35c949(621)] = "none");
  }
  set [_0x24fbc0(851)](_0x4eb01c) {
    const _0x2f3ab0 = _0x24fbc0;
    this[_0x2f3ab0(589)][_0x2f3ab0(830)](_0x4eb01c);
  }
  set [_0x24fbc0(663)](_0x431118) {
    const _0x2bf0e9 = _0x24fbc0;
    _0x431118 !== this["_currentVersion$"][_0x2bf0e9(792)] && this[_0x2bf0e9(940)][_0x2bf0e9(830)](_0x431118);
  }
  get [_0x24fbc0(663)]() {
    const _0x4e6a82 = _0x24fbc0;
    return this["_currentVersion$"][_0x4e6a82(792)];
  }
  set [_0x24fbc0(784)](_0x4e0a75) {
    const _0x3af2fa = _0x24fbc0;
    this[_0x3af2fa(817)]["next"](_0x4e0a75);
  }
  get ["unitId"]() {
    const _0x471a06 = _0x24fbc0;
    return this[_0x471a06(817)][_0x471a06(792)];
  }
  get ["canRevert"]() {
    const _0x52b45d = _0x24fbc0;
    return this[_0x52b45d(660)];
  }
  get ["loadingState"]() {
    const _0x4ad933 = _0x24fbc0;
    return this[_0x4ad933(739)][_0x4ad933(792)];
  }
};
g2 = ds([$2(0, et2), $2(1, at), $2(2, Inject(Fn)), $2(3, Inject(A3))], g2);
function j({ ref: _0xb486c3, ..._0x3f29c5 }) {
  const _0x5f1640 = _0x24fbc0, { icon: _0x3f5d1a, id: _0x3074ee, className: _0xb48f68, extend: _0xa74588, ..._0x590966 } = _0x3f29c5, _0x501e26 = ("univerjs-icon univerjs-icon-" + _0x3074ee + " " + (_0xb48f68 || ""))[_0x5f1640(819)](), _0x1703cc = (0, import_react2.useRef)("_" + ms2());
  return Le2(_0x3f5d1a, "" + _0x3074ee, { "defIds": _0x3f5d1a[_0x5f1640(834)], "idSuffix": _0x1703cc[_0x5f1640(877)] }, { "ref": _0xb486c3, "className": _0x501e26, ..._0x590966 }, _0xa74588);
}
function Le2(_0x3a0aa6, _0x115d90, _0x2f47d8, _0x5c8c60, _0x49b7ad) {
  const _0x5cc787 = _0x24fbc0;
  return (0, import_react2.createElement)(_0x3a0aa6["tag"], { "key": _0x115d90, ...Es2(_0x3a0aa6, _0x2f47d8, _0x49b7ad), ..._0x5c8c60 }, (Ss(_0x3a0aa6, _0x2f47d8)[_0x5cc787(656)] || [])[_0x5cc787(789)]((_0x402764, _0x38c181) => Le2(_0x402764, _0x115d90 + "-" + _0x3a0aa6["tag"] + "-" + _0x38c181, _0x2f47d8, void 0, _0x49b7ad)));
}
function Es2(_0x4a00f6, _0x236236, _0x4099d9) {
  const _0x302471 = _0x24fbc0, _0x605046 = { ..._0x4a00f6["attrs"] };
  _0x4099d9 != null && _0x4099d9[_0x302471(796)] && _0x605046[_0x302471(617)] === "colorChannel1" && (_0x605046[_0x302471(617)] = _0x4099d9[_0x302471(796)]), _0x4a00f6[_0x302471(926)] === _0x302471(552) && _0x605046["id"] && (_0x605046["id"] = _0x605046["id"] + _0x236236[_0x302471(886)]), Object["entries"](_0x605046)[_0x302471(556)](([_0x56bb85, _0x292c8f]) => {
    const _0x2d17fe = _0x302471;
    _0x56bb85 === _0x2d17fe(552) && typeof _0x292c8f == "string" && (_0x605046[_0x56bb85] = _0x292c8f[_0x2d17fe(929)](/url\(#(.*)\)/, _0x2d17fe(568) + _0x236236["idSuffix"] + ")"));
  });
  const { defIds: _0x4c96c4 } = _0x236236;
  return !_0x4c96c4 || _0x4c96c4[_0x302471(618)] === 0 || (_0x4a00f6["tag"] === _0x302471(504) && _0x605046["xlink:href"] && (_0x605046["xlink:href"] = _0x605046[_0x302471(797)] + _0x236236[_0x302471(886)]), Object[_0x302471(669)](_0x605046)[_0x302471(556)](([_0x2e2e7e, _0x170eca]) => {
    const _0x3c1e8a = _0x302471;
    typeof _0x170eca == _0x3c1e8a(679) && (_0x605046[_0x2e2e7e] = _0x170eca[_0x3c1e8a(929)](/url\(#(.*)\)/, _0x3c1e8a(568) + _0x236236["idSuffix"] + ")"));
  })), _0x605046;
}
function Ss(_0x539b6c, _0x19bf2d) {
  const _0x48799b = _0x24fbc0;
  var _0x376f28;
  const { defIds: _0x1a5268 } = _0x19bf2d;
  return !_0x1a5268 || _0x1a5268["length"] === 0 ? _0x539b6c : _0x539b6c["tag"] === "defs" && ((_0x376f28 = _0x539b6c[_0x48799b(656)]) != null && _0x376f28[_0x48799b(618)]) ? { ..._0x539b6c, "children": _0x539b6c[_0x48799b(656)][_0x48799b(789)]((_0x13030b) => typeof _0x13030b[_0x48799b(675)]["id"] == _0x48799b(679) && _0x1a5268 && _0x1a5268[_0x48799b(620)](_0x13030b[_0x48799b(675)]["id"]) ? { ..._0x13030b, "attrs": { ..._0x13030b["attrs"], "id": _0x13030b[_0x48799b(675)]["id"] + _0x19bf2d[_0x48799b(886)] } } : _0x13030b) } : _0x539b6c;
}
function _0xb262() {
  const _0x448b8c = ["editHistory.action.revertSheetSuffix", "_diffRangesMap", "Print", "APPLY_PERMISSION_DENIED", "blocks", "COMPRESS_MUTATION_APPLY", "editHistory.panel.revertDesc", "getVpScrollXYInfoByPosToVp", "subUnitId", "_lastPointer", "MoveWorksheet", "_initRender", "FromArray", "rules", "_status$", "univer-text-sm univer-leading-5 univer-text-gray-500 dark:!univer-text-gray-300", "getVersions", "Duplicate", "_lastLabel", "getDialogs$", "getUnitId", "_createMask", "subscribe", "_sidebarDisposable", "LICENSE_IMPORT_SIZE_EXCEEDED", "ENTITLE_CAN_NOT_BUY_LOWER_OTP", "_renderManagerService", "editHistory.panel.confirm", "params", "YUUMI_RATE_OVER_LIMIT", "url(#restore-icon_clip0_1247_2)", "setState", "register", "hideMask", "_transformMutationByOrder", "_getSheetObject", "_permissionService", "_fetching", "left", "REDEMPTION_CODE_FULLY_REDEEMED", "_confirmService", "YUUMI_SUBSCRIPTION_NOT_FOUND", "fill", "length", "onSteady", "includes", "display", "univer-flex univer-h-12 univer-cursor-default univer-items-center", "View", "currentSkeleton$", "clear", "entities", "split", "LICENSE_MAX_MEMBERS_PER_UNIT_EXCEEDED", "permissionPointUpdate$", "DeleteRow", "CreateSheet", "DeleteSheet", "addSparkline", "editHistory.action.revertSheetPrefix", "anonymous", "triggerLoadSheet", "DeleteColumn", "editHistory.action.etc", "substring", "_historyFetchService", "PY_RUNTIME_SCRIPT_ERROR", "_injector", "name", "date", "startColumn", "CHANGESET_REVISION_CONFILICT", "find", "commands", "status$", "users", "loadMoreVersions", "flat", "9658020RATEoB", "univer-flex univer-flex-1 univer-items-center univer-justify-center", "open", "children", "172013flCiJx", "_diffs", "RenameSheet", "_canRevert", "Init", "scrollEvent$", "currentVersion", "univer-flex univer-flex-1 univer-items-center univer-text-sm univer-text-gray-600 dark:!univer-text-gray-200", "CreateWorksheet", "_versions$", "unitId$", "getOwnPropertyDescriptor", "entries", "_transformService", "[HistoryFetchService]: request snapshot error!", "startRevision", "LICENSE_DISTRO_REJECTED", "_hasMore", "attrs", "column", "getConfig", "Filter", "string", "RenameWorksheet", "add", "stopPropagation", "action", "APPLY_DUPLICATED", "VIEW_MAIN", "univer-flex univer-h-7 univer-w-full univer-items-center univer-justify-center", "mutations", "_versionDiffService", "Entered", "top", "onMouseMove", "REDEMPTION_CODE_INACTIVE", "disposeWithMe", "filter", "_configService", "_updateDiffMarks", "EditWorksheetCell", "triggerLoadVersions", "SelectProtectedCells", "40xeHEUL", "100%", "INVALID_ARGUMENT", "getCurrentUnitForType", "confirm-revert-revision", "registerRenderModule", "univer-ml-2 univer-flex univer-h-5 univer-items-center univer-justify-center univer-rounded univer-border univer-border-primary-600 univer-bg-primary-50 univer-px-1.5 univer-text-xs univer-text-primary-600", "loadingState$", "triggerRevert", "state$", "PivotTable", "skeleton", "YUUMI_AI_RUN_FAILED", "getVersion", "INVITE_CODE_ALREADY_BOUND", "ensureVersion", "onRendered", "time", "UNRECOGNIZED", "0 0 16 16", "getDataRange", "1000", "univer-h-full univer-space-y-2 univer-overflow-auto univer-pb-4", "YUUMI_NO_CUBOID_FOR_QUESTION", "MOBILE_HAS_BEEN_BOUND", "0 0 16 17", "createUnit", "now", "InsertColumn", "CURRENT_STATUS_CANNOT_OPERATE", "univer-ml-2.5 univer-flex univer-size-8 univer-cursor-pointer univer-items-center univer-justify-center univer-rounded", "USER_IS_ANONYMOUS", "APPLY_NON_SEQUENTIAL_REVISION", "280jTSyFy", "ViewFilter", "setDV", "keys", "YUUMI_PROMPT_MAX_TOKENS_EXCEEDED", "PERMISSION_DENIED", "_loadingState$", "_members", "restore-icon_clip0_1247_2", "_dialogOptions$", "sheetId", "editHistory.header.revert", "onStarting", "univer-flex univer-size-6 univer-items-center univer-justify-center univer-rounded univer-text-gray-400 hover:univer-bg-gray-100 dark:hover:!univer-bg-gray-700", "_combineRanges", "transformMutations", "error", "insertSheet", "none", "versions", "pipe", "position", "setFrozen", "USER_NOT_FOUND", "SNAPSHOT_INVALID_SNAPSHOT", "History", "getMember", "getHours", "entered", "m1Prime", "Loaded", "rule", "#0B9EFB", "FloatImg", "getCurrentLocale", "history-panel", "Comment", "merge", "UNIVER_UNKNOWN", "recoverTime", "_initActiveSwitch", "PAYMENT_CHANNEL_NOT_SUPPORT", "showMask", "Sort", "changesets", "_revertRevision$", "AUTHORIZE_CODE_ILLEGAL", "className", "subType", "editHistory.info.loading", "white", "unitId", "Error", "HideWorksheet", "hasCommand", "_sidebarService", "map", "_createUnit", "setCF", "value", "currentColor", "sheet", "Delete", "colorChannel1", "xlink:href", "_openPanel", "dateString", "RecoverHistory", "blockMeta", "_workbookDataCache", "51QURDVB", "_commandService", "editHistory.panel.title", "_config", "_sheetPermissionInitController", ".univer-app-container-content", "APPLY_REJECT", "YUUMI_ALL_TABLES_IS_INVALID", "UNDEFINED", "univer-m-auto univer-animate-spin", "RwHgtClWdt", "getDeserializedSheetBlock", "Export", "RestoreIcon", "_unitId$", "closeAll", "trim", "2gSotxP", "endRow", "hidden", "SetCellValue", "_snapshotServerService", "append", "YUUMI_CONNECTOR_URL_NOT_FOUND", "div", "_removeDiffMarks", "evenodd", "next", "loadSheet", "_getActiveSubUnitId", "rgba(58, 96, 247, 0.20)", "defIds", "SNAPSHOT_HAS_BEEN_REMOVED", "COMPLETION_FINISHED", "editHistory.action.", "LICENSE_EXPORT_SIZE_EXCEEDED", "ranges", "_historyContainerId", "createTime", "revertRevision$", "LOGIN_TOKEN_PROCESSING_FAILED", "range", "pluginName", "ENTITLE_REPORT_LIMIT_EXCEED", "CONNECTOR_DATA_TOO_LARGE", "_compressMutationService", "ViewHistory", "http://www.w3.org/2000/svg", "status", "M8.79993 14.0166C8.79993 14.4585 8.44176 14.8166 7.99993 14.8166C4.23529 14.8166 1.18345 11.7648 1.18345 8.00017C1.18345 4.23554 4.23529 1.18369 7.99993 1.1837C11.7646 1.1837 14.8164 4.23554 14.8164 8.00017C14.8164 8.442 14.4582 8.80017 14.0164 8.80017C13.5746 8.80017 13.2164 8.442 13.2164 8.00017C13.2164 5.11919 10.8809 2.7837 7.99993 2.7837C5.11895 2.7837 2.78345 5.11919 2.78345 8.00017C2.78345 10.8812 5.11895 13.2166 7.99993 13.2166C8.44176 13.2166 8.79993 13.5748 8.79993 14.0166Z", "ENTITLE_NEED_BILLING_ADDRESS", "ViemRwHgtClWdt", "endColumn", "UNIVER_PROJECT", "VIRTUAL_VERSION_NOW", "userId", "editHistory.panel.revertConfirmText", "bottom", "some", "historyListServerUrl", "setValue", "toString", "_componentManager", "init", "_getAPIPrefix", "USER_NOT_INVITED_CODE", "push", "M2.06678 3.37926C2.0668 1.94333 3.23085 0.779297 4.66678 0.779297H9.44256C10.1796 0.779297 10.8821 1.09213 11.3751 1.63999L13.2659 3.74079C13.6955 4.21822 13.9333 4.83779 13.9333 5.4801V12.7126C13.9333 14.1486 12.7692 15.3126 11.3333 15.3126H4.66665C3.2307 15.3126 2.06663 14.1486 2.06665 12.7126L2.06678 3.37926ZM4.66678 1.9793C3.89359 1.9793 3.26679 2.60609 3.26678 3.37928L3.26665 12.7126C3.26664 13.4858 3.89344 14.1126 4.66665 14.1126H11.3333C12.1065 14.1126 12.7333 13.4858 12.7333 12.7126V5.4801C12.7333 5.44882 12.7322 5.41764 12.7302 5.3866H10.7985C9.91488 5.3866 9.19853 4.67026 9.19853 3.78661V1.9793H4.66678ZM10.4832 2.44275L12.0526 4.1866H10.7985C10.5776 4.1866 10.3985 4.00752 10.3985 3.78661V2.35649C10.4279 2.38389 10.4561 2.41266 10.4832 2.44275Z", "defs", "querySelector", "UNIVER_DOC", "interceptor", "getCurrent", "active", "current", "get", "_initMaskContainer", "ENTITLE_CHAT_LIMIT_EXCEED", "SetCellStyle", "YUUMI_URL_COL_OUT_OF_RANGE", "Exited", "justifyContent", "1333444IklExx", "idSuffix", "command", "style", "loading", "TOO_MANY_REQUESTS", "APPLY_REVISION_CONFILICT", "getViewport", "univer-text-gray-500", "INVALID_INVITE_CODE", "3136610fqHsKT", "displayName", "_initPanel", "InsertRow", "INTERNAL_ERROR", "addObjects", "padStart", "DeleteWorksheet", "_uiPartsService", "Loading", "code", "editHistory.panel.cancel", "_localeService", "addProtection", "YUUMI_TABLE_NOT_FOUND_IN_UNIT", "REDEMPTION_INVALID_CODE", "span", "from", "Share", "values", "EditExtraObject", "_sheetSkeletonManagerService", "Copy", "svg", "EMAIL_HAS_BEEN_BOUND", "ENTITLE_UPDOWN_GRADE_NOT_SUPPORT", "deleteProtection", "_maskContainer", "disposeUnit", "editSheet", "REDEMPTION_CODE_NOT_STARTED", "tag", "asObservable", "focusUnit", "replace", "InsertHyperlink", "show", "onPointerMove$", "removeSheet", "UniverIcon", "UNIVER_SLIDE", "_extractRanges", "LICENSE_MAX_UNITS_EXCEEDED", "REDEMPTION_USER_NOT_ELIGIBLE", "assign", "_currentVersion$", "history-mask", "getMinutes", "INVITE_CODE_HAS_BEEN_UES", "getCellPositionByOffset", "dispose", "editHistory.panel.unknownUser", "_init", "close", "confirm", "Edit", "getElementById", "loaded", "_cellEditorManagerService", "CreatePermissionObject", "_historyManagerService", "11066484JoGYuU", "fetchThroughInterceptors", "use", "M6.42416 4.42417C6.65847 4.18985 6.65847 3.80995 6.42416 3.57564C6.18984 3.34132 5.80994 3.34132 5.57563 3.57564L1.57564 7.57564C1.34132 7.80995 1.34132 8.18985 1.57564 8.42417L5.57563 12.4242C5.80994 12.6585 6.18984 12.6585 6.42416 12.4242C6.65847 12.1899 6.65847 11.81 6.42416 11.5756L3.44843 8.5999H14C14.3314 8.5999 14.6 8.33127 14.6 7.9999C14.6 7.66853 14.3314 7.3999 14 7.3999H3.44843L6.42416 4.42417Z", "set", "29244zlYDKj", "_univerInstanceService", "LOGIN_FAILED", "endRev", "_currentVersionDiff$", "clipPath", "HideSheet", "canRevert", "then", "getUnitOnRev", "has", "ENTITLE_DUP_SUBSCRIPTION", "1em", "_context", "toISOString", "/universer-api/history", "UNAUTHENTICATED", "rev", "ENSURE_SNAPSHOT_EXECUTION", "setConfig", "getCurrentVersion", "YUUMI_UNABLE_LOAD_URL", "_maskElement", "EMAIL_VERIFY_CODE_MISMATCH", "[HistoryFetchService]: wrong rev from the server!", "YUUMI_ASYNCIO_CANCELLED", "editHistory.panel.revertConfirm", "Today", "univer-text-2xl dark:!univer-text-white", "back-icon", "/list?length=20", "NOT_FOUND", "restore-icon", "117704ubCBZf", "univer-flex univer-items-center univer-justify-center", "DATA_SOURCE_TOO_LARGE", "data", "_messageService", "path", "cellValue", "backgroundColor", "univer-animate-spin", "memberId", "MOBILE_VERIFY_CODE_MISMATCH", "_httpService", "mask", "MOBILE_VERIFY_CODE_NOT_FOUND_OR_EXPIRED", "updatePermissionPoint", "currentVersionDiff$", "forEach", "center", "18MSYyjs", "SetColumnStyle", "SetWorksheetStyle", "flex", "forValue", "versions$", "startRow", "_updateVersions", "subscribeEvent", "UNIVER_SHEET", "url(#$1", "revertSheet", "ERROR_AGAIN", "MoveSheet", "SetRowStyle", "SelectUnProtectedCells", ": ("];
  _0xb262 = function() {
    return _0x448b8c;
  };
  return _0xb262();
}
function ms2() {
  const _0x591409 = _0x24fbc0;
  return Math["random"]()[_0x591409(864)](36)[_0x591409(639)](2, 8);
}
j[_0x24fbc0(896)] = _0x24fbc0(934);
var fs = { "tag": "svg", "attrs": { "xmlns": _0x24fbc0(850), "fill": _0x24fbc0(751), "viewBox": "0 0 16 16", "width": _0x24fbc0(519), "height": _0x24fbc0(519) }, "children": [{ "tag": _0x24fbc0(545), "attrs": { "fill": _0x24fbc0(793), "d": _0x24fbc0(505) } }] };
var ye2 = (0, import_react2.forwardRef)(function(_0x3646bc, _0x586176) {
  const _0x437821 = _0x24fbc0;
  return (0, import_react2.createElement)(j, Object[_0x437821(939)]({}, _0x3646bc, { "id": _0x437821(536), "ref": _0x586176, "icon": fs }));
});
ye2["displayName"] = "BackIcon";
var gs2 = { "tag": _0x24fbc0(918), "attrs": { "xmlns": _0x24fbc0(850), "fill": _0x24fbc0(751), "viewBox": _0x24fbc0(725), "width": _0x24fbc0(519), "height": _0x24fbc0(519) }, "children": [{ "tag": "g", "attrs": { "fill": "currentColor", "clipPath": _0x24fbc0(605) }, "children": [{ "tag": _0x24fbc0(545), "attrs": { "d": "M7.41252 10.6196C7.64683 10.3852 7.64683 10.0053 7.41252 9.77103L6.77012 9.12863H9.67836C9.89927 9.12863 10.0784 9.30772 10.0784 9.52863V11.1953C10.0784 11.5267 10.347 11.7953 10.6784 11.7953C11.0097 11.7953 11.2784 11.5267 11.2784 11.1953V9.52863C11.2784 8.64497 10.562 7.92863 9.67836 7.92863H6.77012L7.41252 7.28623C7.64683 7.05191 7.64683 6.67201 7.41252 6.4377C7.1782 6.20338 6.79831 6.20338 6.56399 6.4377L4.89732 8.10437C4.66301 8.33868 4.66301 8.71858 4.89732 8.95289L6.56399 10.6196C6.79831 10.8539 7.1782 10.8539 7.41252 10.6196Z" } }, { "tag": _0x24fbc0(545), "attrs": { "d": _0x24fbc0(870), "fillRule": "evenodd", "clipRule": _0x24fbc0(829) } }] }, { "tag": _0x24fbc0(871), "attrs": {}, "children": [{ "tag": _0x24fbc0(512), "attrs": { "id": _0x24fbc0(741) }, "children": [{ "tag": "rect", "attrs": { "width": 16, "height": 16, "y": 0.05, "fill": _0x24fbc0(783), "rx": 4 } }] }] }], "defIds": ["restore-icon_clip0_1247_2"] };
var Ce2 = (0, import_react2.forwardRef)(function(_0x2f9f86, _0x3d10cc) {
  const _0x4b6a2f = _0x24fbc0;
  return (0, import_react2.createElement)(j, Object[_0x4b6a2f(939)]({}, _0x2f9f86, { "id": _0x4b6a2f(539), "ref": _0x3d10cc, "icon": gs2 }));
});
Ce2["displayName"] = _0x24fbc0(816);
var ps = { "tag": _0x24fbc0(918), "attrs": { "xmlns": _0x24fbc0(850), "fill": "none", "viewBox": _0x24fbc0(719), "width": "1em", "height": _0x24fbc0(519) }, "children": [{ "tag": "path", "attrs": { "fill": "#0B9EFB", "d": _0x24fbc0(852), "fillOpacity": 0.2, "fillRule": _0x24fbc0(829), "clipRule": _0x24fbc0(829) } }, { "tag": _0x24fbc0(545), "attrs": { "fill": _0x24fbc0(765), "d": "M7.20007 1.98384C7.20007 1.54201 7.55824 1.18384 8.00007 1.18384C11.7647 1.18384 14.8165 4.23568 14.8165 8.00032C14.8165 11.765 11.7647 14.8168 8.00007 14.8168C4.23543 14.8168 1.18359 11.765 1.18359 8.00032C1.18359 7.55849 1.54177 7.20031 1.98359 7.20031C2.42542 7.20031 2.78359 7.55849 2.78359 8.00032C2.78359 10.8813 5.11909 13.2168 8.00007 13.2168C10.8811 13.2168 13.2165 10.8813 13.2165 8.00032C13.2165 5.11933 10.8811 2.78384 8.00007 2.78384C7.55824 2.78384 7.20007 2.42567 7.20007 1.98384Z", "fillRule": "evenodd", "clipRule": _0x24fbc0(829) } }] };
var re2 = (0, import_react2.forwardRef)(function(_0x45ff90, _0x21c4d9) {
  return (0, import_react2.createElement)(j, Object["assign"]({}, _0x45ff90, { "id": "loading-multi-icon", "ref": _0x21c4d9, "icon": ps }));
});
re2["displayName"] = "LoadingMultiIcon";
function Ns2() {
  const _0x5b48f6 = _0x24fbc0;
  var _0x259564;
  const _0x11b8cc = useDependency(g2), _0x5ed771 = useDependency(Fn), _0x4b77c0 = (0, import_react2.useCallback)(() => {
    const _0x38471e = _0x4d04;
    _0x11b8cc[_0x38471e(851)] = ne2[_0x38471e(883)];
  }, [_0x11b8cc]), _0x3bea7a = (0, import_react2.useCallback)(() => {
    const _0x555379 = _0x4d04;
    _0x11b8cc[_0x555379(708)]();
  }, [_0x11b8cc]), _0xb126a6 = useObservable(_0x11b8cc["currentVersion$"]), _0x436554 = useObservable(_0x11b8cc[_0x5b48f6(563)]), _0x3020eb = _0xb126a6 === ((_0x259564 = _0x436554 == null ? void 0 : _0x436554[0]) == null ? void 0 : _0x259564["id"]), _0x4db246 = _0xb126a6 !== "" && !_0x3020eb && _0x11b8cc[_0x5b48f6(514)];
  return (0, import_jsx_runtime2.jsxs)(_0x5b48f6(827), { "className": ie(_0x5b48f6(622), eE), "children": [(0, import_jsx_runtime2.jsx)("a", { "className": _0x5b48f6(730), "role": "button", "onClick": _0x4b77c0, "children": (0, import_jsx_runtime2.jsx)(ye2, { "className": _0x5b48f6(535) }) }), (0, import_jsx_runtime2.jsx)(_0x5b48f6(827), { "className": _0x5b48f6(654), "children": _0x4db246 && (0, import_jsx_runtime2.jsx)(vr2, { "variant": "primary", "onClick": _0x3bea7a, "children": _0x5ed771["t"](_0x5b48f6(744)) }) })] });
}
var Rs = Object[_0x24fbc0(668)];
var Os = (_0x552219, _0x2427da, _0x9a6041, _0x5d7f22) => {
  for (var _0x35cdf0 = _0x5d7f22 > 1 ? void 0 : _0x5d7f22 ? Rs(_0x2427da, _0x9a6041) : _0x2427da, _0x5e26f1 = _0x552219["length"] - 1, _0x3f21bb; _0x5e26f1 >= 0; _0x5e26f1--) (_0x3f21bb = _0x552219[_0x5e26f1]) && (_0x35cdf0 = _0x3f21bb(_0x35cdf0) || _0x35cdf0);
  return _0x35cdf0;
};
var T = (_0x480751, _0x3d2bde) => (_0x3a57f4, _0x1f4f57) => _0x3d2bde(_0x3a57f4, _0x1f4f57, _0x480751);
var F2 = class extends Ve {
  constructor(_0x591201, _0x25a3bc, _0x1a8a84, _0x5bf4b1, _0x3ec5d9, _0xab596b) {
    const _0x1a066f = _0x24fbc0;
    super(), this[_0x1a066f(611)] = _0x591201, this[_0x1a066f(903)] = _0x25a3bc, this[_0x1a066f(544)] = _0x1a8a84, this[_0x1a066f(907)] = _0x5bf4b1, this[_0x1a066f(501)] = _0x3ec5d9, this["_injector"] = _0xab596b, this[_0x1a066f(493)]();
  }
  [_0x24fbc0(493)]() {
    const _0x282867 = _0x24fbc0;
    this[_0x282867(693)](this[_0x282867(501)]["currentVersion$"][_0x282867(597)]((_0x1b497c) => {
      const _0x32b4b4 = _0x282867;
      _0x1b497c && this[_0x32b4b4(501)][_0x32b4b4(636)](_0x1b497c);
    })), this[_0x282867(693)](this["_permissionService"][_0x282867(629)][_0x282867(597)]((_0x2d0938) => {
      const _0x495ac6 = _0x282867, _0x2cf179 = this[_0x495ac6(501)][_0x495ac6(784)];
      _0x2cf179 && (_0x2d0938[_0x495ac6(781)] === D2[_0x495ac6(496)] && _0x2d0938[_0x495ac6(792)] === true && this[_0x495ac6(611)][_0x495ac6(554)](new Pe(_0x2cf179)["id"], false), _0x2d0938[_0x495ac6(781)] === D2[_0x495ac6(659)] && _0x2d0938[_0x495ac6(792)] === true && this["_permissionService"][_0x495ac6(554)](new zs(_0x2cf179)["id"], false), _0x2d0938[_0x495ac6(781)] === D2[_0x495ac6(571)] && _0x2d0938[_0x495ac6(792)] === true && this[_0x495ac6(611)][_0x495ac6(554)](new js(_0x2cf179)["id"], false), _0x2d0938[_0x495ac6(781)] === D2[_0x495ac6(513)] && _0x2d0938[_0x495ac6(792)] === true && this[_0x495ac6(611)]["updatePermissionPoint"](new Fs(_0x2cf179)["id"], false), _0x2d0938[_0x495ac6(781)] === D2[_0x495ac6(769)] && _0x2d0938[_0x495ac6(792)] === true && this[_0x495ac6(611)][_0x495ac6(554)](new Pe(_0x2cf179)["id"], false), _0x2d0938[_0x495ac6(781)] === D2["FloatImg"] && _0x2d0938["value"] === true && this["_permissionService"]["updatePermissionPoint"](new Pe(_0x2cf179)["id"], false));
    })), this["disposeWithMe"](this[_0x282867(903)]["registerComponent"](c1["HEADER"], () => connectInjector(Ns2, this[_0x282867(642)]))), this[_0x282867(693)](this[_0x282867(501)][_0x282867(707)][_0x282867(597)]((_0x54582d) => {
      const _0x597257 = _0x282867;
      _0x54582d === y["Loading"] && (this[_0x597257(501)][_0x597257(775)](), this["_messageService"][_0x597257(931)]({ "type": $C["Info"], "content": this["_localeService"]["t"](_0x597257(782)) })), _0x54582d === y[_0x597257(763)] && this[_0x597257(501)][_0x597257(608)]();
    }));
  }
};
F2 = Os([T(0, eC), T(1, D1), T(2, et2), T(3, Inject(Fn)), T(4, Inject(g2)), T(5, Inject(Injector))], F2);
var Ms2 = Object[_0x24fbc0(668)];
var Ds = (_0x2160e0, _0x3caa5a, _0x13d2a7, _0x146a06) => {
  const _0x35d752 = _0x24fbc0;
  for (var _0xfd3b80 = _0x146a06 > 1 ? void 0 : _0x146a06 ? Ms2(_0x3caa5a, _0x13d2a7) : _0x3caa5a, _0x3cb944 = _0x2160e0[_0x35d752(618)] - 1, _0x100c55; _0x3cb944 >= 0; _0x3cb944--) (_0x100c55 = _0x2160e0[_0x3cb944]) && (_0xfd3b80 = _0x100c55(_0xfd3b80) || _0xfd3b80);
  return _0xfd3b80;
};
var Z2 = (_0x331b9a, _0x50e50b) => (_0x1e4d06, _0x299382) => _0x50e50b(_0x1e4d06, _0x299382, _0x331b9a);
var w = class extends Ve {
  constructor(_0x5572f3, _0x4987c9, _0x868bb1) {
    const _0x1516b5 = _0x24fbc0;
    super(), _(this, _0x1516b5(576), /* @__PURE__ */ new Map()), _(this, _0x1516b5(511), new BehaviorSubject({ "ranges": /* @__PURE__ */ new Map(), "active": null })), _(this, _0x1516b5(555), this[_0x1516b5(511)][_0x1516b5(927)]()), this[_0x1516b5(501)] = _0x5572f3, this["_transformService"] = _0x4987c9, this["_snapshotServerService"] = _0x868bb1, this["_init"]();
  }
  ["_init"]() {
    const _0x5086b4 = _0x24fbc0;
    this[_0x5086b4(576)] = /* @__PURE__ */ new Map(), this["disposeWithMe"](this[_0x5086b4(501)][_0x5086b4(667)][_0x5086b4(597)]((_0x30bba8) => {
      const _0xdd785b = _0x5086b4;
      _0x30bba8 && !this["_diffRangesMap"][_0xdd785b(517)](_0x30bba8) && this["_diffRangesMap"][_0xdd785b(506)](_0x30bba8, /* @__PURE__ */ new Map());
    })), this[_0x5086b4(693)](this[_0x5086b4(501)]["currentVersion$"]["subscribe"](async (_0x2d8281) => {
      const _0x1d52f4 = _0x5086b4;
      var _0x3356be;
      _0x2d8281 && (await this[_0x1d52f4(715)](_0x2d8281), this["_currentVersionDiff$"][_0x1d52f4(830)](((_0x3356be = this["_diffRangesMap"][_0x1d52f4(878)](this[_0x1d52f4(501)]["unitId"])) == null ? void 0 : _0x3356be[_0x1d52f4(878)](_0x2d8281)) || { "ranges": /* @__PURE__ */ new Map(), "active": null }));
    }));
  }
  async [_0x24fbc0(715)](_0x5f55f4) {
    const _0x5d9f26 = _0x24fbc0;
    var _0x47a8c2, _0x574818;
    const _0x46f9b8 = this[_0x5d9f26(501)][_0x5d9f26(713)](_0x5f55f4), _0x5635c0 = this["_historyManagerService"][_0x5d9f26(784)];
    if (!_0x46f9b8 || !_0x5635c0) return;
    const _0x56fc42 = this[_0x5d9f26(576)][_0x5d9f26(878)](_0x5635c0);
    if (_0x56fc42 || this[_0x5d9f26(576)]["set"](_0x5635c0, /* @__PURE__ */ new Map()), (_0x47a8c2 = this[_0x5d9f26(576)][_0x5d9f26(878)](_0x5635c0)) != null && _0x47a8c2["has"](_0x46f9b8["id"])) return;
    const { startRev: _0x291c24, endRev: _0x5ecc9a } = _0x46f9b8;
    if (_0x291c24 === 1) {
      _0x56fc42[_0x5d9f26(506)](_0x46f9b8["id"], { "ranges": /* @__PURE__ */ new Map(), "active": null });
      return;
    }
    const _0x230590 = _0x291c24 - 1, _0x3f7956 = _0x5ecc9a, _0x183b22 = await this[_0x5d9f26(824)]["fetchMissingChangesets"]({}, { "unitID": _0x5635c0, "from": _0x230590, "to": _0x3f7956, "type": x2[_0x5d9f26(567)] });
    if (((_0x574818 = _0x183b22[_0x5d9f26(749)]) == null ? void 0 : _0x574818[_0x5d9f26(905)]) === W2["OK"]) {
      const _0x3d85cc = _0x183b22[_0x5d9f26(777)][_0x5d9f26(789)]((_0x206744) => ((_0x206744["mutations"] === null || _0x206744[_0x5d9f26(687)] === void 0) && (_0x206744[_0x5d9f26(687)] = []), Id(_0x206744)))["map"]((_0x17d410) => _0x17d410[_0x5d9f26(687)][_0x5d9f26(789)]((_0x46a7bc) => ({ ..._0x46a7bc, "params": { ..._0x46a7bc[_0x5d9f26(603)], "memberId": _0x17d410["userID"] } })))[_0x5d9f26(652)](), _0x5c864c = this[_0x5d9f26(609)](_0x3d85cc), _0x31bd30 = this["_getActiveSubUnitId"](_0x3d85cc), _0x399e67 = this[_0x5d9f26(936)](_0x5c864c);
      _0x56fc42["set"](_0x46f9b8["id"], { "ranges": _0x399e67, "active": _0x31bd30 });
    }
  }
  ["_transformMutationByOrder"](_0x448303) {
    const _0x2fb38d = _0x24fbc0;
    let _0xd9dc0e = [];
    for (let _0x432bea = 0; _0x432bea < _0x448303[_0x2fb38d(618)]; _0x432bea++) {
      const _0x4f39d3 = _0x448303[_0x432bea];
      if (_0xd9dc0e[_0x2fb38d(869)](_0x4f39d3), _0x432bea !== _0x448303["length"] - 1) {
        const _0xc3a655 = _0x448303[_0x432bea + 1], _0x94619e = this[_0x2fb38d(670)][_0x2fb38d(748)](_0xd9dc0e, [_0xc3a655]);
        fd(_0x94619e) ? _0xd9dc0e = _0x94619e[_0x2fb38d(762)] : _0xd9dc0e = [];
      }
    }
    return _0xd9dc0e;
  }
  [_0x24fbc0(832)](_0x2db048) {
    const _0x5c6ca4 = _0x24fbc0;
    let _0xc285da = [];
    return _0x2db048["forEach"]((_0x11f14f) => {
      const _0x15cf61 = _0x4d04;
      if (_0x11f14f["id"] === hn["id"]) {
        const _0x2c7aa6 = _0x11f14f["params"];
        _0xc285da[_0x15cf61(869)](_0x2c7aa6[_0x15cf61(794)]["id"]);
      } else {
        if (_0x11f14f["id"] === Ht["id"]) {
          const _0x1d3cbd = _0x11f14f[_0x15cf61(603)];
          _0xc285da[_0x15cf61(618)] > 0 && (_0xc285da = _0xc285da[_0x15cf61(694)]((_0x467ec8) => _0x467ec8 !== _0x1d3cbd[_0x15cf61(583)]));
        } else {
          if (_0x11f14f["id"] === wt["id"]) {
            const _0x2aaea0 = _0x11f14f["params"];
            _0x2aaea0[_0x15cf61(822)] ? _0xc285da = _0xc285da[_0x15cf61(694)]((_0x326372) => _0x326372 !== _0x2aaea0["subUnitId"]) : _0xc285da["push"](_0x2aaea0[_0x15cf61(583)]);
          } else {
            const _0x1418d5 = _0x11f14f[_0x15cf61(603)];
            _0x1418d5[_0x15cf61(583)] && _0xc285da[_0x15cf61(869)](_0x1418d5[_0x15cf61(583)]);
          }
        }
      }
    }), _0xc285da[_0x5c6ca4(618)] > 0 ? _0xc285da[_0xc285da["length"] - 1] : null;
  }
  [_0x24fbc0(936)](_0x5a74da) {
    const _0x33b3f8 = _0x24fbc0, _0x2a5e71 = /* @__PURE__ */ new Map();
    return _0x5a74da[_0x33b3f8(556)]((_0x339c40) => {
      const _0x3c1767 = _0x33b3f8;
      var _0x237240, _0x41f6d4;
      const _0x39e896 = (_0x237240 = _0x339c40[_0x3c1767(603)]) == null ? void 0 : _0x237240[_0x3c1767(549)];
      if (_0x39e896) {
        _0x2a5e71[_0x3c1767(517)](_0x39e896) || _0x2a5e71[_0x3c1767(506)](_0x39e896, []);
        const _0x273466 = this["_getRangesByMutation"](_0x339c40);
        (_0x41f6d4 = _0x2a5e71[_0x3c1767(878)](_0x39e896)) == null || _0x41f6d4[_0x3c1767(869)](..._0x273466);
      }
    }), _0x2a5e71["forEach"]((_0x3712ae, _0x4bfb1b) => {
      const _0x56a9eb = _0x33b3f8;
      _0x2a5e71[_0x56a9eb(506)](_0x4bfb1b, this["_combineRanges"](_0x3712ae));
    }), _0x2a5e71;
  }
  ["_getRangesByMutation"](_0x3a443c) {
    const _0x5e3e4c = _0x24fbc0;
    switch (_0x3a443c["id"]) {
      case Be["id"]: {
        const _0x5303d6 = _0x3a443c[_0x5e3e4c(603)];
        return _0x5303d6[_0x5e3e4c(588)][_0x5e3e4c(789)]((_0x1d1309) => _0x1d1309[_0x5e3e4c(839)][_0x5e3e4c(789)]((_0x5c75ad) => ({ "range": _0x5c75ad, "unitId": _0x5303d6["unitId"], "subUnitId": _0x5303d6[_0x5e3e4c(583)] })))[_0x5e3e4c(652)]();
      }
      case ne["id"]: {
        const _0x3a37ed = _0x3a443c[_0x5e3e4c(603)];
        return _0x3a37ed["ranges"][_0x5e3e4c(789)]((_0x12a323) => ({ "range": _0x12a323, "unitId": _0x3a37ed[_0x5e3e4c(784)], "subUnitId": _0x3a37ed[_0x5e3e4c(583)] }));
      }
      case Ue["id"]: {
        const _0x2cf8d0 = _0x3a443c[_0x5e3e4c(603)];
        return [{ "range": _0x2cf8d0["range"], "unitId": _0x2cf8d0["unitId"], "subUnitId": _0x2cf8d0["subUnitId"] }];
      }
      case ke["id"]: {
        const _0x1d7b2c = _0x3a443c["params"];
        return [{ "range": _0x1d7b2c["range"], "unitId": _0x1d7b2c["unitId"], "subUnitId": _0x1d7b2c[_0x5e3e4c(583)] }];
      }
      case It["id"]: {
        const _0x3d2ada = _0x3a443c["params"], { from: _0x3fd6da, to: _0x1240b0, unitId: _0x3c1186 } = _0x3d2ada;
        return [{ "range": ue4(_0x3fd6da[_0x5e3e4c(792)]), "unitId": _0x3c1186, "subUnitId": _0x3fd6da[_0x5e3e4c(583)] }, { "range": ue4(_0x1240b0[_0x5e3e4c(792)]), "unitId": _0x3c1186, "subUnitId": _0x1240b0[_0x5e3e4c(583)] }];
      }
      case Je2["id"]: {
        const _0x2b5759 = _0x3a443c["params"], { unitId: _0x1ab40d, subUnitId: _0x11f608, sourceRange: _0x236560, targetRange: _0x211a9b } = _0x2b5759, _0x2aed22 = _0x236560[_0x5e3e4c(821)] - _0x236560[_0x5e3e4c(564)] + 1;
        return [{ "range": _0x211a9b["startRow"] <= _0x236560[_0x5e3e4c(564)] ? _0x211a9b : { ..._0x211a9b, "startRow": _0x211a9b[_0x5e3e4c(564)] - _0x2aed22, "endRow": _0x211a9b["endRow"] - _0x2aed22 }, "unitId": _0x1ab40d, "subUnitId": _0x11f608 }];
      }
      case qe["id"]: {
        const _0x31324f = _0x3a443c[_0x5e3e4c(603)], { unitId: _0x3e146a, subUnitId: _0x5bcb5b, sourceRange: _0x12fd68, targetRange: _0x21e6b1 } = _0x31324f, _0x1dfe43 = _0x12fd68[_0x5e3e4c(855)] - _0x12fd68[_0x5e3e4c(645)] + 1;
        return [{ "range": _0x21e6b1[_0x5e3e4c(645)] <= _0x12fd68[_0x5e3e4c(645)] ? _0x21e6b1 : { ..._0x21e6b1, "startColumn": _0x21e6b1[_0x5e3e4c(645)] - _0x1dfe43, "endColumn": _0x21e6b1[_0x5e3e4c(855)] - _0x1dfe43 }, "unitId": _0x3e146a, "subUnitId": _0x5bcb5b }];
      }
      case to["id"]: {
        const _0x11b0dd = _0x3a443c[_0x5e3e4c(603)], { values: _0xcdb29c, unitId: _0x80834, subUnitId: _0x184f78 } = _0x11b0dd;
        return Object[_0x5e3e4c(914)](_0xcdb29c)["map"]((_0x46d179) => _0x46d179["ranges"][_0x5e3e4c(789)]((_0x163815) => ({ "range": _0x163815, "unitId": _0x80834, "subUnitId": _0x184f78 })))["flat"]();
      }
      case li["id"]: {
        const _0x48766f = _0x3a443c[_0x5e3e4c(603)], { ranges: _0x39cb8, unitId: _0x11c292, subUnitId: _0x1b790a } = _0x48766f;
        return _0x39cb8["map"]((_0x140874) => ({ "range": _0x140874, "unitId": _0x11c292, "subUnitId": _0x1b790a }));
      }
      case On["id"]: {
        const _0x2248f5 = _0x3a443c[_0x5e3e4c(603)], { unitId: _0x1976ff, subUnitId: _0x101f40, range: _0x72719a } = _0x2248f5;
        return [{ "range": _0x72719a, "unitId": _0x1976ff, "subUnitId": _0x101f40 }];
      }
      case fe["id"]: {
        const _0x4f462d = _0x3a443c[_0x5e3e4c(603)];
        return _0x4f462d[_0x5e3e4c(764)][_0x5e3e4c(839)][_0x5e3e4c(789)]((_0x45efff) => ({ "range": _0x45efff, "unitId": _0x4f462d[_0x5e3e4c(784)], "subUnitId": _0x4f462d[_0x5e3e4c(583)] }));
      }
      case ee["id"]: {
        const _0x692c2c = _0x3a443c[_0x5e3e4c(603)];
        return _0x692c2c[_0x5e3e4c(546)] ? Ts(_0x692c2c[_0x5e3e4c(546)])["map"]((_0x4b6bb8) => ({ "range": _0x4b6bb8, "unitId": _0x692c2c[_0x5e3e4c(784)], "subUnitId": _0x692c2c[_0x5e3e4c(583)] })) : [];
      }
      case R["id"]: {
        const _0x2cc5ed = _0x3a443c[_0x5e3e4c(603)];
        return [{ "range": _0x2cc5ed[_0x5e3e4c(844)], "unitId": _0x2cc5ed[_0x5e3e4c(784)], "subUnitId": _0x2cc5ed[_0x5e3e4c(583)] }];
      }
      case S["id"]: {
        const _0x29734 = _0x3a443c[_0x5e3e4c(603)];
        return (Array["isArray"](_0x29734[_0x5e3e4c(764)]) ? _0x29734[_0x5e3e4c(764)] : [_0x29734[_0x5e3e4c(764)]])[_0x5e3e4c(789)]((_0x4ef0c8) => _0x4ef0c8[_0x5e3e4c(839)][_0x5e3e4c(789)]((_0x504d36) => ({ "range": _0x504d36, "unitId": _0x29734["unitId"], "subUnitId": _0x29734[_0x5e3e4c(583)] })))["flat"]();
      }
      case o2["id"]: {
        const _0xba58c4 = _0x3a443c[_0x5e3e4c(603)];
        return _0xba58c4[_0x5e3e4c(764)]["ranges"][_0x5e3e4c(789)]((_0x569465) => ({ "range": _0x569465, "unitId": _0xba58c4[_0x5e3e4c(784)], "subUnitId": _0xba58c4[_0x5e3e4c(583)] }));
      }
      default:
        return [];
    }
  }
  [_0x24fbc0(747)](_0x2c37b5) {
    const _0x48d132 = _0x24fbc0;
    if (_0x2c37b5[_0x48d132(618)] <= 1) return _0x2c37b5;
    const _0x146ca6 = /* @__PURE__ */ new Map();
    return _0x2c37b5[_0x48d132(556)]((_0x46675b) => {
      const _0x21dd60 = _0x48d132;
      var _0x418446;
      const { unitId: _0x47a556, subUnitId: _0xaedd92 } = _0x46675b, _0x467851 = _0x47a556 + "-" + _0xaedd92;
      _0x146ca6[_0x21dd60(517)](_0x467851) ? (_0x418446 = _0x146ca6[_0x21dd60(878)](_0x467851)) == null || _0x418446[_0x21dd60(869)](_0x46675b) : _0x146ca6["set"](_0x467851, [_0x46675b]);
    }), Array[_0x48d132(912)](_0x146ca6[_0x48d132(914)]())[_0x48d132(789)]((_0x124a0b) => new Sh()[_0x48d132(681)](..._0x124a0b[_0x48d132(789)]((_0x1e96ae) => _0x1e96ae[_0x48d132(844)]))[_0x48d132(770)]()[_0x48d132(789)]((_0x42f077) => ({ "range": _0x42f077, "unitId": _0x124a0b[0][_0x48d132(784)], "subUnitId": _0x124a0b[0][_0x48d132(583)] })))[_0x48d132(652)]();
  }
};
w = Ds([Z2(0, Inject(g2)), Z2(1, Pe2), Z2(2, gr2)], w);
function ue4(_0x1a8113) {
  const _0x31b57f = _0x24fbc0;
  return new pt(_0x1a8113)[_0x31b57f(720)]();
}
function Ts(_0x2d3430) {
  const _0x14bcff = _0x24fbc0, _0x3892c3 = new pt(_0x2d3430), _0x24e936 = new pt();
  return _0x3892c3[_0x14bcff(562)]((_0x4355cb, _0xc91b26) => {
    const _0x4fb47e = _0x14bcff;
    _0x24e936[_0x4fb47e(863)](_0x4355cb, _0xc91b26, 1);
  }), Zo(_0x24e936);
}
var bs = Object[_0x24fbc0(668)];
var Ps = (_0x42a01a, _0x2c681b, _0x242384, _0x20bea8) => {
  for (var _0x279746 = _0x20bea8 > 1 ? void 0 : _0x20bea8 ? bs(_0x2c681b, _0x242384) : _0x2c681b, _0x502923 = _0x42a01a["length"] - 1, _0x49d1a6; _0x502923 >= 0; _0x502923--) (_0x49d1a6 = _0x42a01a[_0x502923]) && (_0x279746 = _0x49d1a6(_0x279746) || _0x279746);
  return _0x279746;
};
var b2 = (_0xc62066, _0x39d728) => (_0x235458, _0x9aa052) => _0x39d728(_0x235458, _0x9aa052, _0xc62066);
var q2 = class extends Ve {
  constructor(_0x54483b, _0x48ca15, _0x128411, _0x22f76c, _0x1bc77e, _0x28dc59, _0x3852a5) {
    const _0x5db653 = _0x24fbc0;
    super(), _(this, _0x5db653(658), /* @__PURE__ */ new Set()), _(this, _0x5db653(584), null), this[_0x5db653(520)] = _0x54483b, this[_0x5db653(501)] = _0x48ca15, this["_versionDiffService"] = _0x128411, this[_0x5db653(508)] = _0x22f76c, this[_0x5db653(601)] = _0x1bc77e, this["_sheetSkeletonManagerService"] = _0x28dc59, this["_commandService"] = _0x3852a5, this["_init"]();
  }
  ["_init"]() {
    const _0x2beabf = _0x24fbc0;
    this[_0x2beabf(586)](), this[_0x2beabf(773)]();
  }
  [_0x24fbc0(586)]() {
    const _0x2ffebc = _0x24fbc0;
    this[_0x2ffebc(693)](combineLatest([this[_0x2ffebc(501)][_0x2ffebc(707)], this[_0x2ffebc(916)][_0x2ffebc(624)]])[_0x2ffebc(753)](switchMap(([_0x80c9d0, _0x32c52d]) => {
      const _0x3ce101 = _0x2ffebc;
      if (_0x80c9d0 === y["Loaded"] && _0x32c52d) {
        const _0x3be449 = _0x32c52d[_0x3ce101(743)];
        return this[_0x3ce101(688)][_0x3ce101(555)][_0x3ce101(753)](map((_0x495e8b) => {
          const _0x2ed4b4 = _0x3ce101, _0x447039 = /* @__PURE__ */ new Map();
          return _0x495e8b[_0x2ed4b4(839)][_0x2ed4b4(556)]((_0x411748, _0x438c6b) => {
            const _0x47642d = _0x2ed4b4, _0x37e871 = _0x411748[_0x47642d(694)]((_0x140d8f) => _0x140d8f[_0x47642d(583)] === _0x3be449);
            _0x447039[_0x47642d(506)](_0x438c6b, _0x37e871);
          }), { "skeleton": _0x32c52d, "diffs": _0x447039 };
        }));
      }
      return of({ "skeleton": null, "diffs": /* @__PURE__ */ new Map() });
    }))[_0x2ffebc(597)](({ skeleton: _0x451d5f, diffs: _0x3b4460 }) => {
      const _0x45e05b = _0x2ffebc;
      this[_0x45e05b(828)](), _0x451d5f && this["_updateDiffMarks"](_0x451d5f, _0x3b4460);
    })), this[_0x2ffebc(693)](this["_sheetSkeletonManagerService"][_0x2ffebc(624)][_0x2ffebc(597)]((_0x5b151f) => {
      const _0x431f74 = _0x2ffebc;
      if (_0x5b151f == null) return;
      const { skeleton: _0x56cd25 } = _0x5b151f, { scene: _0x471315 } = this[_0x431f74(520)];
      _0x471315[_0x431f74(932)][_0x431f74(566)](n1((_0x3ce256) => {
        const _0x2de5c4 = _0x431f74;
        var _0x1e2b05, _0x5614d1;
        const { offsetX: _0x3828ce, offsetY: _0x4cc41b } = _0x3ce256, { x: _0x181439, y: _0x5e1d8a } = _0x471315["getRelativeToViewportCoord"](U[_0x2de5c4(587)]([_0x3828ce, _0x4cc41b])), { scaleX: _0x42b5b7, scaleY: _0x41cca1 } = _0x471315["getAncestorScale"](), _0x55058c = _0x471315[_0x2de5c4(892)](k2[_0x2de5c4(685)]), _0x557ef7 = _0x471315[_0x2de5c4(582)](U[_0x2de5c4(587)]([_0x181439, _0x5e1d8a]), _0x55058c), _0x1603dc = _0x56cd25[_0x2de5c4(944)](_0x3828ce, _0x4cc41b, _0x42b5b7, _0x41cca1, _0x557ef7);
        ((_0x1e2b05 = this[_0x2de5c4(584)]) == null ? void 0 : _0x1e2b05[_0x2de5c4(676)]) === _0x1603dc[_0x2de5c4(676)] && ((_0x5614d1 = this[_0x2de5c4(584)]) == null ? void 0 : _0x5614d1["row"]) === _0x1603dc["row"] || this[_0x2de5c4(658)][_0x2de5c4(556)]((_0x576397) => {
          const _0x3e80fb = _0x2de5c4;
          _0x576397[_0x3e80fb(691)](_0x1603dc);
        });
      }, 100));
    }));
  }
  ["_initActiveSwitch"]() {
    const _0x7e5d30 = _0x24fbc0;
    this[_0x7e5d30(693)](this[_0x7e5d30(501)]["loadingState$"][_0x7e5d30(597)]((_0x3d662f) => {
      const _0x37a960 = _0x7e5d30, _0x1b2f10 = new ao();
      return _0x3d662f === y[_0x37a960(763)] && (_0x1b2f10[_0x37a960(491)](), _0x1b2f10[_0x37a960(681)](this[_0x37a960(688)][_0x37a960(555)]["subscribe"]((_0x5a5b9e) => {
        const _0xe2c8be = _0x37a960;
        _0x5a5b9e[_0xe2c8be(876)] && this[_0xe2c8be(804)]["executeCommand"](pn["id"], { "unitId": this[_0xe2c8be(520)][_0xe2c8be(784)], "subUnitId": _0x5a5b9e[_0xe2c8be(876)] });
      }))), () => _0x1b2f10[_0x37a960(491)]();
    }));
  }
  [_0x24fbc0(696)](_0x12c3da, _0x4ad6be) {
    const _0x5a3582 = _0x24fbc0;
    var _0x5e040e;
    const _0x4d7c36 = (_0x5e040e = this[_0x5a3582(916)][_0x5a3582(875)]()) == null ? void 0 : _0x5e040e[_0x5a3582(711)];
    if (!_0x4d7c36) return;
    this[_0x5a3582(658)][_0x5a3582(556)]((_0x5ab581) => {
      _0x5ab581["makeDirty"]();
    });
    const { scene: _0x514d48 } = this[_0x5a3582(520)], _0x5ca3c4 = Array["from"](_0x4ad6be["keys"]())[_0x5a3582(789)]((_0xa213c0) => _0x4ad6be["get"](_0xa213c0)[_0x5a3582(789)]((_0x452d5f) => {
      const _0x25c947 = _0x5a3582;
      var _0x1ee158;
      const { range: _0x2f0d5e, subUnitId: _0x292a65, unitId: _0x28b6d1 } = _0x452d5f, { startColumn: _0x4d1ee4, startRow: _0x16c09a, endColumn: _0xce6fa7, endRow: _0x11e9ea } = _0x2f0d5e, _0x1274da = lh(_0x16c09a, _0x4d1ee4, _0x514d48, _0x4d7c36), _0xdbb709 = lh(_0x11e9ea, _0xce6fa7, _0x514d48, _0x4d7c36), { columnHeaderHeightAndMarginTop: _0x3c2057 } = _0x4d7c36, { startX: _0x47a32a, startY: _0x483faa } = _0x1274da, { endX: _0x523ac4, endY: _0x239b44 } = _0xdbb709, _0x2ef432 = _0x523ac4 - _0x47a32a, _0x3d85c4 = _0x239b44 - _0x483faa, _0x3272d8 = { "labelPosition": _0x483faa - _0x3c2057 >= 20 ? _0x25c947(690) : _0x25c947(860), "sheetID": _0x292a65, "range": _0x2f0d5e, "color": _0x25c947(833), "fillAfterStrokeEnabled": true, "backgroundColor": _0x25c947(833), "name": ((_0x1ee158 = this["_historyManagerService"][_0x25c947(759)](_0xa213c0)) == null ? void 0 : _0x1ee158[_0x25c947(643)]) || "", "selection": _0x28b6d1 + "-" + _0x292a65 + "-" + _0x2f0d5e[_0x25c947(645)] + "-" + _0x2f0d5e["startRow"] + "-" + _0x2f0d5e[_0x25c947(855)] + "-" + _0x2f0d5e[_0x25c947(821)], "left": _0x47a32a, "top": _0x483faa, "width": _0x2ef432, "height": _0x3d85c4, "evented": false, "zIndex": 1 };
      return new qi("", _0x3272d8);
    }))[_0x5a3582(652)]();
    _0x514d48[_0x5a3582(900)](_0x5ca3c4, 1), this[_0x5a3582(658)] = new Set(_0x5ca3c4);
  }
  [_0x24fbc0(828)]() {
    const _0x1d0f76 = _0x24fbc0;
    var _0x382b6e;
    (_0x382b6e = this[_0x1d0f76(658)]) == null || _0x382b6e["forEach"]((_0x3b93bf) => _0x3b93bf[_0x1d0f76(491)]());
  }
  [_0x24fbc0(610)]() {
    const _0x3be40f = _0x24fbc0;
    return en(this[_0x3be40f(508)], this[_0x3be40f(601)]);
  }
};
q2 = Ps([b2(1, Inject(g2)), b2(2, Inject(w)), b2(3, vr), b2(4, ME), b2(5, Inject(ue)), b2(6, Ls)], q2);
function Ls2() {
  const _0x87929f = _0x24fbc0, _0x3e1f46 = useDependency(g2), _0x5acb72 = useObservable(_0x3e1f46["versions$"]), [_0x37e765, _0x15333b] = (0, import_react2.useState)(false), _0xf0d71d = cs(_0x5acb72);
  return _0x5acb72 ? (0, import_jsx_runtime2.jsx)(_0x87929f(827), { "className": "univer-overflow-hidden", "children": (0, import_jsx_runtime2.jsxs)(_0x87929f(827), { "className": _0x87929f(722), "children": [_0xf0d71d[_0x87929f(789)]((_0x3ba444, _0x4cd584) => (0, import_jsx_runtime2.jsxs)(import_react2.Fragment, { "children": [(0, import_jsx_runtime2.jsx)(ws2, { "date": _0x3ba444[_0x87929f(799)] }), _0x3ba444[_0x87929f(752)]["map"]((_0x2885d3, _0x478afb) => (0, import_jsx_runtime2.jsx)($s, { "index": [_0x4cd584, _0x478afb], "item": _0x2885d3 }, _0x4cd584 + "-" + _0x478afb))] }, _0x3ba444[_0x87929f(799)])), _0x37e765 && (0, import_jsx_runtime2.jsx)(ys, {})] }) }) : (0, import_jsx_runtime2.jsx)(Cs, {});
}
function ys() {
  const _0x5a7523 = _0x24fbc0;
  return (0, import_jsx_runtime2.jsx)(_0x5a7523(827), { "className": _0x5a7523(686), "children": (0, import_jsx_runtime2.jsx)(re2, { "className": _0x5a7523(548) }) });
}
function Cs() {
  const _0x4e0592 = _0x24fbc0;
  return (0, import_jsx_runtime2.jsx)(_0x4e0592(827), { "className": _0x4e0592(541), "children": (0, import_jsx_runtime2.jsx)(_0x4e0592(911), { "className": _0x4e0592(893), "children": (0, import_jsx_runtime2.jsx)(re2, { "className": _0x4e0592(812) }) }) });
}
function ws2(_0x3d91b6) {
  const _0x273a77 = _0x24fbc0, _0xf9fc06 = useDependency(Fn), { date: _0x130f19 } = _0x3d91b6;
  return (0, import_jsx_runtime2.jsx)(_0x273a77(827), { "className": "univer-flex univer-items-center univer-gap-2.5 univer-py-1.5 univer-text-sm univer-font-medium", "children": J5(_0x130f19, _0xf9fc06[_0x273a77(767)]()) });
}
function $s(_0x5bbe40) {
  const _0xc5bd74 = _0x24fbc0, { item: _0x5e1c9c, index: _0x4b0b4b } = _0x5bbe40, { time: _0x2712b4, user: _0x5e3406 } = _0x5e1c9c, [_0x2cec68, _0x3cf0a4] = _0x4b0b4b, _0x4a1b1f = useDependency(g2), _0x1149ee = useObservable(_0x4a1b1f["currentVersion$"], "", true) === _0x5e1c9c["id"], _0x2a612b = _0x2cec68 === 0 && _0x3cf0a4 === 0, _0x1b457f = !_0x2a612b && _0x4a1b1f[_0xc5bd74(514)], _0x4a6fc3 = useDependency(Fn), _0x49bc20 = _0x4a6fc3["getCurrentLocale"](), _0x4f6eb4 = ie5(_0x2712b4, _0x49bc20), _0x2d688d = _0x4a6fc3["t"]("editHistory.panel.currentVersion"), _0x41f03d = (0, import_react2.useCallback)((_0x88704e) => {
    const _0x43ae66 = _0xc5bd74;
    _0x4a1b1f["loadingState"] !== y[_0x43ae66(904)] && (_0x4a1b1f["currentVersion"] = _0x88704e);
  }, [_0x4a1b1f]), _0xce3081 = (0, import_react2.useCallback)((_0x2c9e39) => {
    const _0x29fa17 = _0xc5bd74;
    _0x4a1b1f[_0x29fa17(708)](_0x2c9e39);
  }, [_0x4a1b1f]);
  return (0, import_jsx_runtime2.jsxs)("div", { "className": ie("univer-h-15 univer-flex univer-cursor-pointer univer-flex-col univer-justify-center univer-gap-1 univer-rounded-md univer-px-4 univer-py-1.5 univer-transition-colors hover:univer-bg-gray-100 dark:hover:!univer-bg-gray-800", { "univer-bg-gray-50 dark:!univer-bg-gray-900": _0x1149ee }), "onClick": () => _0x41f03d(_0x5e1c9c["id"]), "children": [(0, import_jsx_runtime2.jsxs)("div", { "className": "univer-flex univer-h-6 univer-w-full univer-justify-between", "children": [(0, import_jsx_runtime2.jsxs)(_0xc5bd74(827), { "className": _0xc5bd74(664), "children": [(0, import_jsx_runtime2.jsx)(_0xc5bd74(911), { "children": _0x4f6eb4["time"] }), _0x2a612b && (0, import_jsx_runtime2.jsx)("span", { "className": _0xc5bd74(706), "children": _0x2d688d })] }), (0, import_jsx_runtime2.jsx)(_0xc5bd74(827), { "children": _0x1b457f && (0, import_jsx_runtime2.jsx)(Rp, { "title": _0x4a6fc3["t"](_0xc5bd74(581)), "children": (0, import_jsx_runtime2.jsx)(_0xc5bd74(827), { "onClick": (_0x130c82) => {
    const _0x4583b8 = _0xc5bd74;
    _0x130c82[_0x4583b8(682)](), _0xce3081(_0x5e1c9c["id"]);
  }, "className": _0xc5bd74(746), "children": (0, import_jsx_runtime2.jsx)(Ce2, {}) }) }) })] }), (0, import_jsx_runtime2.jsx)(_0xc5bd74(827), { "className": _0xc5bd74(590), "children": as(_0x5e1c9c, _0x4a6fc3) })] });
}
var Us = Object["getOwnPropertyDescriptor"];
var Vs2 = (_0x2576ff, _0x1cc29a, _0x12035d, _0x566a83) => {
  const _0x1c2ed0 = _0x24fbc0;
  for (var _0x2c2078 = _0x566a83 > 1 ? void 0 : _0x566a83 ? Us(_0x1cc29a, _0x12035d) : _0x1cc29a, _0x5e4c58 = _0x2576ff[_0x1c2ed0(618)] - 1, _0xbfefcb; _0x5e4c58 >= 0; _0x5e4c58--) (_0xbfefcb = _0x2576ff[_0x5e4c58]) && (_0x2c2078 = _0xbfefcb(_0x2c2078) || _0x2c2078);
  return _0x2c2078;
};
var U2 = (_0x219a2f, _0x516375) => (_0x35f77a, _0x24f481) => _0x516375(_0x35f77a, _0x24f481, _0x219a2f);
var he3 = _0x24fbc0(768);
var Y = class extends Ve {
  constructor(_0x67409c, _0x184630, _0x32a424, _0x4d675e) {
    const _0x4d938a = _0x24fbc0;
    super(), _(this, _0x4d938a(598), null), this[_0x4d938a(788)] = _0x67409c, this[_0x4d938a(865)] = _0x184630, this[_0x4d938a(907)] = _0x32a424, this[_0x4d938a(501)] = _0x4d675e, this[_0x4d938a(493)]();
  }
  [_0x24fbc0(493)]() {
    const _0x38b2d3 = _0x24fbc0;
    this[_0x38b2d3(897)](), this[_0x38b2d3(798)]();
  }
  ["_openPanel"]() {
    const _0x450ad4 = _0x24fbc0;
    if (this[_0x450ad4(598)]) return;
    const _0x466414 = { "header": { "title": this[_0x450ad4(907)]["t"](_0x450ad4(805)) }, "children": { "label": he3 }, "onClose": () => {
      const _0x21c309 = _0x450ad4;
      this[_0x21c309(598)] = null, this["_historyManagerService"][_0x21c309(851)] = ne2["Exited"];
    } };
    this[_0x450ad4(598)] = this["_sidebarService"][_0x450ad4(655)]({ ..._0x466414 });
  }
  [_0x24fbc0(897)]() {
    const _0x4b6121 = _0x24fbc0;
    this[_0x4b6121(693)](this[_0x4b6121(865)][_0x4b6121(607)](he3, Ls2)), this[_0x4b6121(693)](this[_0x4b6121(788)][_0x4b6121(662)][_0x4b6121(753)](debounceTime(100))[_0x4b6121(597)]((_0x29c8df) => {
      const _0x551181 = _0x4b6121, { target: _0xbe44e4 } = _0x29c8df || {};
      if (_0xbe44e4) {
        const { scrollTop: _0x4cfc87, scrollHeight: _0x4422c2, clientHeight: _0x4c86bb } = _0xbe44e4;
        _0x4cfc87 + _0x4c86bb >= _0x4422c2 - 5 && this[_0x551181(501)][_0x551181(651)]();
      }
    }));
  }
};
Y = Vs2([U2(0, we2), U2(1, Inject(S1)), U2(2, Inject(Fn)), U2(3, Inject(g2))], Y);
var ks = class extends Ve {
  constructor() {
    const _0x38eb4d = _0x24fbc0;
    super(), _(this, _0x38eb4d(742), new Subject());
  }
  [_0x24fbc0(655)]() {
    return We(() => {
    });
  }
  [_0x24fbc0(494)]() {
  }
  [_0x24fbc0(818)](_0x40ca47) {
  }
  [_0x24fbc0(594)]() {
    const _0x105711 = _0x24fbc0;
    return this["_dialogOptions$"][_0x105711(927)]();
  }
};
var Hs = Object["defineProperty"];
var xs = Object[_0x24fbc0(668)];
var As = (_0x3cd603, _0x19934f, _0x23c438) => _0x19934f in _0x3cd603 ? Hs(_0x3cd603, _0x19934f, { "enumerable": true, "configurable": true, "writable": true, "value": _0x23c438 }) : _0x3cd603[_0x19934f] = _0x23c438;
var Fs3 = (_0x29cf4e, _0x5a06fd, _0x419aee, _0x59b88e) => {
  const _0x53749a = _0x24fbc0;
  for (var _0x2926d4 = _0x59b88e > 1 ? void 0 : _0x59b88e ? xs(_0x5a06fd, _0x419aee) : _0x5a06fd, _0x39925e = _0x29cf4e[_0x53749a(618)] - 1, _0x3d963b; _0x39925e >= 0; _0x39925e--) (_0x3d963b = _0x29cf4e[_0x39925e]) && (_0x2926d4 = _0x3d963b(_0x2926d4) || _0x2926d4);
  return _0x2926d4;
};
var K3 = (_0x18d362, _0x445e8a) => (_0x32272b, _0x3e3640) => _0x445e8a(_0x32272b, _0x3e3640, _0x18d362);
var Ys = (_0x30d317, _0xca65a, _0x2c2690) => As(_0x30d317, _0xca65a + "", _0x2c2690);
var Bs = "UNIVER_EDIT_HISTORY_VIEWER_PLUGIN";
var ee3 = class extends Ol {
  constructor(_0x4bfcc5 = le3, _0xfec4d1, _0x3f8fee, _0x1612af) {
    const _0x51ea2 = _0x24fbc0;
    super(), this["_config"] = _0x4bfcc5, this[_0x51ea2(642)] = _0xfec4d1, this[_0x51ea2(601)] = _0x3f8fee, this[_0x51ea2(695)] = _0x1612af;
    const { ..._0x275232 } = oo({}, le3, this[_0x51ea2(806)]);
    this[_0x51ea2(695)][_0x51ea2(526)](Pe5, _0x275232);
  }
  [_0x24fbc0(745)]() {
    const _0x1544d3 = _0x24fbc0;
    [[g2], [F2], [w], [A3], [Y], [H2], [gr2, { "useClass": Nt2 }], [ct, { "useClass": ks }], [El, { "useClass": Rt }]][_0x1544d3(556)]((_0x4cc6ef) => this["_injector"][_0x1544d3(681)](_0x4cc6ef)), this[_0x1544d3(642)][_0x1544d3(878)](F2);
  }
  [_0x24fbc0(716)]() {
    const _0x4e963c = _0x24fbc0;
    [[q2]][_0x4e963c(556)]((_0x4f5547) => {
      const _0x7b62f2 = _0x4e963c;
      this[_0x7b62f2(693)](this[_0x7b62f2(601)][_0x7b62f2(705)](we[_0x7b62f2(567)], _0x4f5547));
    }), this[_0x4e963c(642)][_0x4e963c(878)](H2), this["_injector"][_0x4e963c(878)](Y);
  }
  [_0x24fbc0(619)]() {
    const _0x394b3f = _0x24fbc0;
    this[_0x394b3f(642)][_0x394b3f(878)](w);
  }
};
Ys(ee3, _0x24fbc0(845), Bs), ee3 = Fs3([qR(Nl, V), K3(1, Inject(Injector)), K3(2, ME), K3(3, ic)], ee3);

// node_modules/@univerjs-pro/edit-history-loader/lib/es/index.js
var _0x8bb7a6 = _0x3800;
(function(_0x21fb35, _0x35ae51) {
  const _0x403236 = _0x3800, _0x38ebc1 = _0x21fb35();
  while (!![]) {
    try {
      const _0x1a8b5c = -parseInt(_0x403236(409)) / 1 * (-parseInt(_0x403236(374)) / 2) + parseInt(_0x403236(358)) / 3 * (-parseInt(_0x403236(425)) / 4) + parseInt(_0x403236(467)) / 5 + parseInt(_0x403236(469)) / 6 * (parseInt(_0x403236(399)) / 7) + -parseInt(_0x403236(430)) / 8 + -parseInt(_0x403236(397)) / 9 + parseInt(_0x403236(387)) / 10;
      if (_0x1a8b5c === _0x35ae51) break;
      else _0x38ebc1["push"](_0x38ebc1["shift"]());
    } catch (_0xf619d0) {
      _0x38ebc1["push"](_0x38ebc1["shift"]());
    }
  }
})(_0x278a, 727193);
var G = Object[_0x8bb7a6(390)];
var B2 = (_0x36fb15, _0x498224, _0x4798ee) => _0x498224 in _0x36fb15 ? G(_0x36fb15, _0x498224, { "enumerable": true, "configurable": true, "writable": true, "value": _0x4798ee }) : _0x36fb15[_0x498224] = _0x4798ee;
var g3 = (_0x9b0bb1, _0x447ba9, _0x574be9) => B2(_0x9b0bb1, typeof _0x447ba9 != "symbol" ? _0x447ba9 + "" : _0x447ba9, _0x574be9);
function _0x278a() {
  const _0x2cdde2 = ["getCurrentLocale", "_commandService", "_permissionService", "add", "display", "currentTheme$", "status$", "exhaustSavingTask", " has been registered.", "revertRevision$", "attrs", "defs", "onStarting", "dispose", "mask", "history-container", "historyUniver$", "show", "registerCommand", "position", "tag", "history-icon_clip0_907_281", "getElementById", "Entered", "getOwnPropertyDescriptor", "http://www.w3.org/2000/svg", "_pluginMap", "every", "entries", "_themeService", "block", "_disposableCollection", "1461lfapGJ", "event$", "editHistory.panel.listFetchError", "data", "univerContainerId", "get", "CHANGESET_ACK", "clear", "path", "dataset", "editHistory.panel.revertFailed", "includes", "zIndex", "univer-history-container", "_messageService", "_revertErrorTimer", "2376354pfiNGM", "Error", "current", "OPERATION", "UNIVER_CONTAINER_ID", "none", "closeAll", "_init", "fill", "left", "setLocale", "unsubscribe", "getSheetId", "12260150FfMRqZ", "xlink:href", "edit-history-loader.config", "defineProperty", "getConfig", "historyUniver", "UNIVER_EDIT_HISTORY_LOADER_PLUGIN", "unMountHistoryContent", "registerPlugin", "composePermission", "2190321EhSzib", "UniverIcon", "1062509pJBbef", "_initPlugins", "_injector", "_checkCanRevert", "getLocales", "_sidebarService", "defIds", "createElement", "UNIVER_SHEET", "univer-container", "1ydkFjj", "toString", "set", "_dialogService", "1em", "from", "_historyUniver$", "historyListServerUrl", "_localeService", "url(#$1", "Exited", "children", "map", "_componentManager", "_univerInstanceService", "_configService", "11568vhghaf", "univer.operation.toggle-edit-history", "UNIVER_UNKNOWN", "mutations", "M4.45388 4.14989H3.52896C4.61144 2.8939 6.21319 2.0999 7.9999 2.0999C11.2584 2.0999 13.8999 4.74142 13.8999 7.9999C13.8999 11.2584 11.2584 13.8999 7.9999 13.8999C4.74142 13.8999 2.0999 11.2584 2.0999 7.9999C2.0999 7.66853 1.83127 7.3999 1.4999 7.3999C1.16853 7.3999 0.899902 7.66853 0.899902 7.9999C0.899902 11.9211 4.07868 15.0999 7.9999 15.0999C11.9211 15.0999 15.0999 11.9211 15.0999 7.9999C15.0999 4.07868 11.9211 0.899902 7.9999 0.899902C5.88709 0.899902 3.9903 1.82298 2.69023 3.28636V2.38625C2.69023 2.05488 2.42161 1.78625 2.09023 1.78625C1.75886 1.78625 1.49023 2.05488 1.49023 2.38625V4.74989C1.49023 5.08126 1.75886 5.34989 2.09023 5.34989H4.45388C4.78525 5.34989 5.05388 5.08126 5.05388 4.74989C5.05388 4.41851 4.78525 4.14989 4.45388 4.14989Z", "3393648ObgLKs", "random", "register", "assign", "forEach", "next", "colorChannel1", "uComp", "displayName", "M0 0H16V16H0z", "subscribe", "invoke", "setConfig", "OTHERS", "setDarkMode", "flat", "permissionId", "mergeMenu", "string", "session", "currentColor", "substring", "__getInjector", "mountHistoryContent", "_selectionProtectionRuleModel", "pluginName", "disposeWithMe", "top", "location", "HistoryIcon", "close", "getSubunitRuleList", "_localCacheService", "getUnit", "length", "eventID", "replace", "1185965miQkoD", "appendChild", "6dgkVil", "_initContainer", "some", "1000", "getAllPlugins", "onCommandExecuted", "_collaborationController", "params", "idSuffix", "value", "_config", "style", "_historyManagerService", "div", "[HistoryLoaderService]: Plugin ", "_initListener"];
  _0x278a = function() {
    return _0x2cdde2;
  };
  return _0x278a();
}
var x4 = _0x8bb7a6(389);
var w2 = {};
function A4({ ref: _0x3d155d, ..._0x138655 }) {
  const _0x2a4ad7 = _0x8bb7a6, { icon: _0x488ecf, id: _0x48227e, className: _0x222c40, extend: _0x51963e, ..._0x628d8c } = _0x138655, _0x2400f8 = ("univerjs-icon univerjs-icon-" + _0x48227e + " " + (_0x222c40 || ""))["trim"](), _0x4bca15 = (0, import_react3.useRef)("_" + si());
  return F3(_0x488ecf, "" + _0x48227e, { "defIds": _0x488ecf[_0x2a4ad7(405)], "idSuffix": _0x4bca15[_0x2a4ad7(376)] }, { "ref": _0x3d155d, "className": _0x2400f8, ..._0x628d8c }, _0x51963e);
}
function F3(_0x4179aa, _0x35363d, _0x21a2c7, _0x5cf68b, _0x395794) {
  const _0x35d2eb = _0x8bb7a6;
  return (0, import_react3.createElement)(_0x4179aa[_0x35d2eb(346)], { "key": _0x35363d, ...ni(_0x4179aa, _0x21a2c7, _0x395794), ..._0x5cf68b }, (oi(_0x4179aa, _0x21a2c7)["children"] || [])[_0x35d2eb(421)]((_0x35163c, _0x497570) => F3(_0x35163c, _0x35363d + "-" + _0x4179aa[_0x35d2eb(346)] + "-" + _0x497570, _0x21a2c7, void 0, _0x395794)));
}
function ni(_0x263fdd, _0x5a4167, _0x1f9f40) {
  const _0x19a68c = _0x8bb7a6, _0x29deae = { ..._0x263fdd[_0x19a68c(495)] };
  _0x1f9f40 != null && _0x1f9f40[_0x19a68c(436)] && _0x29deae[_0x19a68c(382)] === _0x19a68c(436) && (_0x29deae[_0x19a68c(382)] = _0x1f9f40["colorChannel1"]), _0x263fdd[_0x19a68c(346)] === _0x19a68c(499) && _0x29deae["id"] && (_0x29deae["id"] = _0x29deae["id"] + _0x5a4167[_0x19a68c(477)]), Object[_0x19a68c(354)](_0x29deae)[_0x19a68c(434)](([_0x543d64, _0x3f9273]) => {
    const _0x263d22 = _0x19a68c;
    _0x543d64 === _0x263d22(499) && typeof _0x3f9273 == _0x263d22(448) && (_0x29deae[_0x543d64] = _0x3f9273[_0x263d22(466)](/url\(#(.*)\)/, _0x263d22(418) + _0x5a4167[_0x263d22(477)] + ")"));
  });
  const { defIds: _0x8ebd94 } = _0x5a4167;
  return !_0x8ebd94 || _0x8ebd94[_0x19a68c(464)] === 0 || (_0x263fdd[_0x19a68c(346)] === "use" && _0x29deae[_0x19a68c(388)] && (_0x29deae[_0x19a68c(388)] = _0x29deae[_0x19a68c(388)] + _0x5a4167["idSuffix"]), Object[_0x19a68c(354)](_0x29deae)[_0x19a68c(434)](([_0x29c3d8, _0x244c05]) => {
    const _0x4cd61a = _0x19a68c;
    typeof _0x244c05 == _0x4cd61a(448) && (_0x29deae[_0x29c3d8] = _0x244c05["replace"](/url\(#(.*)\)/, _0x4cd61a(418) + _0x5a4167[_0x4cd61a(477)] + ")"));
  })), _0x29deae;
}
function _0x3800(_0x56f65f, _0x4bf4d1) {
  const _0x278a45 = _0x278a();
  return _0x3800 = function(_0x38001c, _0xd81994) {
    _0x38001c = _0x38001c - 346;
    let _0x152b44 = _0x278a45[_0x38001c];
    return _0x152b44;
  }, _0x3800(_0x56f65f, _0x4bf4d1);
}
function oi(_0x1cdc1a, _0x1f2339) {
  const _0x2ce963 = _0x8bb7a6;
  var _0x13d9ed;
  const { defIds: _0x4f76f4 } = _0x1f2339;
  return !_0x4f76f4 || _0x4f76f4[_0x2ce963(464)] === 0 ? _0x1cdc1a : _0x1cdc1a[_0x2ce963(346)] === _0x2ce963(496) && ((_0x13d9ed = _0x1cdc1a[_0x2ce963(420)]) != null && _0x13d9ed[_0x2ce963(464)]) ? { ..._0x1cdc1a, "children": _0x1cdc1a["children"][_0x2ce963(421)]((_0x35ae4c) => typeof _0x35ae4c[_0x2ce963(495)]["id"] == _0x2ce963(448) && _0x4f76f4 && _0x4f76f4[_0x2ce963(369)](_0x35ae4c[_0x2ce963(495)]["id"]) ? { ..._0x35ae4c, "attrs": { ..._0x35ae4c[_0x2ce963(495)], "id": _0x35ae4c["attrs"]["id"] + _0x1f2339[_0x2ce963(477)] } } : _0x35ae4c) } : _0x1cdc1a;
}
function si() {
  const _0x3d84a5 = _0x8bb7a6;
  return Math[_0x3d84a5(431)]()[_0x3d84a5(410)](36)[_0x3d84a5(451)](2, 8);
}
A4[_0x8bb7a6(438)] = _0x8bb7a6(398);
var ai = { "tag": "svg", "attrs": { "xmlns": _0x8bb7a6(351), "fill": _0x8bb7a6(379), "viewBox": "0 0 16 16", "width": _0x8bb7a6(413), "height": _0x8bb7a6(413) }, "children": [{ "tag": "g", "attrs": { "fill": _0x8bb7a6(450), "clipPath": "url(#history-icon_clip0_907_281)" }, "children": [{ "tag": _0x8bb7a6(366), "attrs": { "d": _0x8bb7a6(429) } }, { "tag": _0x8bb7a6(366), "attrs": { "d": "M8.28291 5.16293C8.28295 4.83156 8.01435 4.5629 7.68298 4.56287C7.35161 4.56283 7.08295 4.83143 7.08291 5.1628L7.08252 8.63494C7.0825 8.79881 7.1495 8.95555 7.26796 9.06877L9.70073 11.3939C9.94029 11.6228 10.3201 11.6142 10.549 11.3747C10.778 11.1351 10.7694 10.7553 10.5298 10.5263L8.28255 8.37852L8.28291 5.16293Z" } }] }, { "tag": _0x8bb7a6(496), "attrs": {}, "children": [{ "tag": "clipPath", "attrs": { "id": _0x8bb7a6(347) }, "children": [{ "tag": _0x8bb7a6(366), "attrs": { "fill": "white", "d": _0x8bb7a6(439) } }] }] }], "defIds": ["history-icon_clip0_907_281"] };
var j2 = (0, import_react3.forwardRef)(function(_0x44e8f6, _0x2e939b) {
  const _0x126a66 = _0x8bb7a6;
  return (0, import_react3.createElement)(A4, Object[_0x126a66(433)]({}, _0x44e8f6, { "id": "history-icon", "ref": _0x2e939b, "icon": ai }));
});
j2[_0x8bb7a6(438)] = _0x8bb7a6(459);
var ci = Object[_0x8bb7a6(350)];
var li2 = (_0x2dba7a, _0x53a0ff, _0x55aac3, _0x22bafc) => {
  for (var _0x1c1562 = _0x22bafc > 1 ? void 0 : _0x22bafc ? ci(_0x53a0ff, _0x55aac3) : _0x53a0ff, _0x1067c0 = _0x2dba7a["length"] - 1, _0x1cf322; _0x1067c0 >= 0; _0x1067c0--) (_0x1cf322 = _0x2dba7a[_0x1067c0]) && (_0x1c1562 = _0x1cf322(_0x1c1562) || _0x1c1562);
  return _0x1c1562;
};
var l2 = (_0x2971a6, _0xa33186) => (_0x4c4204, _0x39a16b) => _0xa33186(_0x4c4204, _0x39a16b, _0x2971a6);
var ui = _0x8bb7a6(408);
var V3 = _0x8bb7a6(378);
var d = _0x8bb7a6(371);
var f2 = class extends Ve {
  constructor(_0x302c01, _0x5cd462, _0x249e1c, _0x3ba6a4, _0x345b0f, _0x2efc73, _0x3ae947, _0x562789, _0x289c9d, _0x212569) {
    const _0x906ebd = _0x8bb7a6;
    super(), g3(this, _0x906ebd(415), new BehaviorSubject(null)), g3(this, _0x906ebd(501), this[_0x906ebd(415)]["asObservable"]()), g3(this, _0x906ebd(357), new ao()), g3(this, _0x906ebd(352), /* @__PURE__ */ new Map()), this["_localeService"] = _0x302c01, this[_0x906ebd(423)] = _0x5cd462, this[_0x906ebd(424)] = _0x249e1c, this["_commandService"] = _0x3ba6a4, this[_0x906ebd(372)] = _0x345b0f, this["_permissionService"] = _0x2efc73, this["_selectionProtectionRuleModel"] = _0x3ae947, this["_dialogService"] = _0x562789, this[_0x906ebd(404)] = _0x289c9d, this["_themeService"] = _0x212569, this["_init"]();
  }
  get ["historyUniver"]() {
    const _0x5f9ba3 = _0x8bb7a6;
    return this[_0x5f9ba3(415)][_0x5f9ba3(478)];
  }
  ["_init"]() {
    const _0x420f66 = _0x8bb7a6;
    this[_0x420f66(470)](), this[_0x420f66(400)]();
  }
  ["_initContainer"]() {
    const _0xba743c = _0x8bb7a6;
    var _0x426449;
    const _0x521be7 = (_0x426449 = this["_configService"]["getConfig"](V3)) != null ? _0x426449 : ui, _0x4fc3b6 = document[_0xba743c(348)](_0x521be7);
    if (!_0x4fc3b6) return;
    const _0x36d503 = document[_0xba743c(406)](_0xba743c(482));
    _0x36d503["id"] = d, _0x36d503[_0xba743c(367)][_0xba743c(437)] = _0xba743c(500), _0x36d503[_0xba743c(480)][_0xba743c(504)] = "absolute", _0x36d503["style"][_0xba743c(457)] = "0", _0x36d503[_0xba743c(480)][_0xba743c(383)] = "0", _0x36d503[_0xba743c(480)]["width"] = "100%", _0x36d503["style"]["height"] = "100%", _0x36d503[_0xba743c(480)][_0xba743c(370)] = _0xba743c(472), _0x36d503[_0xba743c(480)]["display"] = _0xba743c(379), _0x4fc3b6[_0xba743c(468)](_0x36d503);
  }
  ["_initPlugins"]() {
    const _0x2596c5 = _0x8bb7a6;
    var _0x28ac8d;
    [[o7], [k3, { "container": d, "header": true, "toolbar": false, "footer": true, "contextMenu": false, "override": [[ct, null]] }], [V], [At2, { "override": [[El, null]] }], [q, { "hasScroll": false }], [wr], [A], [ss, { "notExecuteFormula": true }], [Nl], [ot2], [Bt], [Re], [fe2], [He], [N2], [xt3], [de], [at3], [C], [Ie], [Tt3], [Wi, { "notExecuteFormula": true }], [N, { "workerURL": "./worker.js" }], [nt], [f], [Pt], [ve2], [Nn], [Ut, { "notExecuteFormula": true }], [ee3, { "historyListServerUrl": (_0x28ac8d = this["_configService"][_0x2596c5(391)](x4)) == null ? void 0 : _0x28ac8d[_0x2596c5(416)] }]][_0x2596c5(434)](([_0x4150ed, _0x47a1fa]) => this[_0x2596c5(395)](_0x4150ed, _0x47a1fa));
  }
  [_0x8bb7a6(498)]() {
    const _0x360a9f = _0x8bb7a6;
    super[_0x360a9f(498)](), this[_0x360a9f(394)](), this[_0x360a9f(352)][_0x360a9f(365)]();
  }
  ["registerPlugin"](_0x7865e8, _0x5a8e90, _0x3299e0) {
    const _0x30767f = _0x8bb7a6;
    if (this["_pluginMap"]["has"](_0x7865e8[_0x30767f(455)]) && !_0x3299e0) throw new Error(_0x30767f(483) + _0x7865e8[_0x30767f(455)] + _0x30767f(493));
    this[_0x30767f(352)][_0x30767f(411)](_0x7865e8[_0x30767f(455)], [_0x7865e8, _0x5a8e90]);
  }
  [_0x8bb7a6(473)]() {
    const _0x11a7e7 = _0x8bb7a6;
    return Array[_0x11a7e7(414)](this["_pluginMap"]["values"]());
  }
  ["mountHistoryContent"](_0x1bf2b2) {
    const _0x1b9aa9 = _0x8bb7a6, _0x2f80ec = document[_0x1b9aa9(348)](d);
    _0x2f80ec && (_0x2f80ec["style"]["display"] = _0x1b9aa9(356), this["_initUniver"](_0x1bf2b2, d));
  }
  [_0x8bb7a6(394)]() {
    const _0x4e634a = _0x8bb7a6;
    var _0x454f95;
    this[_0x4e634a(357)][_0x4e634a(498)](), (_0x454f95 = this[_0x4e634a(392)]) == null || _0x454f95[_0x4e634a(498)](), this[_0x4e634a(415)][_0x4e634a(435)](null);
    const _0x4e0527 = document[_0x4e634a(348)](d);
    _0x4e0527 && (_0x4e0527[_0x4e634a(480)][_0x4e634a(489)] = _0x4e634a(379));
  }
  ["_initUniver"](_0x23db17, _0x28958d) {
    const _0x53e2fb = _0x8bb7a6;
    if (this[_0x53e2fb(392)]) return;
    const _0x5e4e05 = new sI({ "locales": { [this[_0x53e2fb(417)][_0x53e2fb(485)]()]: this[_0x53e2fb(417)][_0x53e2fb(403)]() }, "override": [[dE, { "useClass": Tt2 }]] }), _0x2ce234 = _0x5e4e05[_0x53e2fb(452)]();
    this[_0x53e2fb(456)](this[_0x53e2fb(355)]["darkMode$"][_0x53e2fb(440)]((_0x3dbcb4) => {
      const _0x2fcbd4 = _0x53e2fb;
      _0x2ce234[_0x2fcbd4(363)](Gi)[_0x2fcbd4(444)](_0x3dbcb4);
    })), this[_0x53e2fb(456)](this["_themeService"][_0x53e2fb(490)]["subscribe"]((_0x471d8f) => {
      _0x2ce234["get"](Gi)["setTheme"](_0x471d8f);
    })), _0x2ce234[_0x53e2fb(363)](Fn)[_0x53e2fb(384)](this[_0x53e2fb(417)][_0x53e2fb(485)]()), _0x2ce234["get"](ic)[_0x53e2fb(442)](K, this["_configService"][_0x53e2fb(391)](K));
    const _0x3828bb = this["_configService"][_0x53e2fb(391)](J2);
    _0x3828bb && _0x5e4e05[_0x53e2fb(395)](Tt, { "license": _0x3828bb["ls"] }), this[_0x53e2fb(352)][_0x53e2fb(434)](([_0x42c2f0, _0x36e689]) => {
      const _0x3f5d2d = _0x53e2fb;
      _0x5e4e05[_0x3f5d2d(395)](_0x42c2f0, _0x36e689);
    }), _0x2ce234[_0x53e2fb(441)]((_0x3d69a7) => {
      const _0x1446dc = _0x53e2fb;
      this[_0x1446dc(484)](_0x3d69a7, _0x23db17);
    }), this[_0x53e2fb(415)]["next"](_0x5e4e05);
    const _0x1524ee = _0x2ce234["get"](g2), _0x4efeb4 = this[_0x53e2fb(402)](_0x23db17);
    _0x1524ee["triggerLoadVersions"](_0x23db17, _0x28958d, _0x4efeb4);
  }
  ["_initListener"](_0x5060fa, _0x2e2c93) {
    const _0x43935d = _0x8bb7a6, _0x18dc51 = _0x5060fa["get"](g2);
    this[_0x43935d(357)]["add"](_0x18dc51[_0x43935d(491)][_0x43935d(440)]((_0x950b7e) => {
      const _0x531bdf = _0x43935d;
      switch (_0x950b7e) {
        case ne2[_0x531bdf(349)]:
          this[_0x531bdf(412)][_0x531bdf(380)](), this[_0x531bdf(404)][_0x531bdf(460)]();
          break;
        case ne2[_0x531bdf(419)]:
          this["unMountHistoryContent"]();
          break;
        case ne2[_0x531bdf(375)]:
          this[_0x531bdf(394)](), this[_0x531bdf(372)][_0x531bdf(502)]({ "content": this["_localeService"]["t"](_0x531bdf(360)), "type": $C[_0x531bdf(375)], "duration": 3e3 });
          break;
      }
    })), this[_0x43935d(357)][_0x43935d(488)](_0x18dc51[_0x43935d(494)][_0x43935d(440)](async (_0x48829c) => {
      const _0x105cf6 = _0x43935d;
      _0x48829c && this[_0x105cf6(486)]["executeCommand"](se["id"], { "unitId": _0x2e2c93, "revision": _0x48829c });
    }));
  }
  ["_checkCanRevert"](_0x9d250d) {
    const _0x5cfb73 = _0x8bb7a6, _0x134ce4 = this[_0x5cfb73(423)][_0x5cfb73(463)](_0x9d250d)["getSheets"]()[_0x5cfb73(421)]((_0x3316f9) => _0x3316f9[_0x5cfb73(386)]()), _0x95d8f5 = new Pe(_0x9d250d)["id"], _0x5dc401 = _0x134ce4[_0x5cfb73(421)]((_0x2bf9ee) => new Ve2(_0x9d250d, _0x2bf9ee)["id"]), _0x1f94b3 = _0x134ce4[_0x5cfb73(421)]((_0x501f37) => this[_0x5cfb73(454)][_0x5cfb73(461)](_0x9d250d, _0x501f37)[_0x5cfb73(421)]((_0x499f13) => new Le(_0x9d250d, _0x501f37, _0x499f13[_0x5cfb73(446)])["id"]))[_0x5cfb73(445)](), _0x56cfd6 = new cr(_0x9d250d)["id"];
    return this[_0x5cfb73(487)][_0x5cfb73(396)]([_0x95d8f5, ..._0x5dc401, ..._0x1f94b3, _0x56cfd6])[_0x5cfb73(353)]((_0x463ad0) => !!_0x463ad0["value"]);
  }
};
f2 = li2([l2(0, Inject(Fn)), l2(1, vr), l2(2, ic), l2(3, Ls), l2(4, et2), l2(5, eC), l2(6, Inject(me)), l2(7, Inject(ct)), l2(8, Inject(we2)), l2(9, Inject(Gi))], f2);
var b3 = { "id": _0x8bb7a6(426), "type": Ms[_0x8bb7a6(377)], "handler": (_0x355d85) => {
  const _0x4e4640 = _0x8bb7a6, _0xa256ce = _0x355d85[_0x4e4640(363)](f2), _0x19c514 = _0x355d85[_0x4e4640(363)](vr), { unitId: _0x558a6d } = P(_0x19c514) || {};
  return _0x558a6d ? (_0xa256ce[_0x4e4640(453)](_0x558a6d), true) : false;
} };
function hi(_0x2ede0a) {
  const _0x41c63f = _0x8bb7a6;
  return { "id": b3["id"], "type": H1["BUTTON"], "icon": "HistoryIcon", "tooltip": "editHistory.panel.title", "hidden$": Bi(_0x2ede0a, we[_0x41c63f(407)]), "disabled$": he(_0x2ede0a, { "workbookTypes": [Pe, gr], "worksheetTypes": [], "rangeTypes": [] }) };
}
var gi2 = { [G1[_0x8bb7a6(443)]]: { [b3["id"]]: { "order": 0.2, "menuItemFactory": hi } } };
var mi3 = Object[_0x8bb7a6(350)];
var vi2 = (_0x32a0e2, _0x35e387, _0x4779cf, _0x1b9395) => {
  const _0x5effd5 = _0x8bb7a6;
  for (var _0x1513b0 = _0x1b9395 > 1 ? void 0 : _0x1b9395 ? mi3(_0x35e387, _0x4779cf) : _0x35e387, _0x273e00 = _0x32a0e2[_0x5effd5(464)] - 1, _0xc1474c; _0x273e00 >= 0; _0x273e00--) (_0xc1474c = _0x32a0e2[_0x273e00]) && (_0x1513b0 = _0xc1474c(_0x1513b0) || _0x1513b0);
  return _0x1513b0;
};
var m2 = (_0x2f7351, _0x434978) => (_0xd5b719, _0x4b12c6) => _0x434978(_0xd5b719, _0x4b12c6, _0x2f7351);
var p = class extends h1 {
  constructor(_0x21e145, _0x52dae4, _0x1a6e6a, _0x3c536b, _0x40ee08, _0x24da57, _0x4d53e6, _0x4876d7) {
    const _0x6cb388 = _0x8bb7a6;
    super(), g3(this, _0x6cb388(373), null), this[_0x6cb388(486)] = _0x21e145, this["_menuManagerService"] = _0x52dae4, this["_componentManager"] = _0x1a6e6a, this[_0x6cb388(481)] = _0x3c536b, this[_0x6cb388(417)] = _0x40ee08, this[_0x6cb388(372)] = _0x24da57, this["_collaborationController"] = _0x4d53e6, this[_0x6cb388(462)] = _0x4876d7, this[_0x6cb388(381)]();
  }
  [_0x8bb7a6(381)]() {
    const _0x240866 = _0x8bb7a6;
    [b3][_0x240866(434)]((_0x51228a) => this[_0x240866(456)](We(this[_0x240866(486)][_0x240866(503)](_0x51228a)))), this[_0x240866(456)](this[_0x240866(422)][_0x240866(432)]("HistoryIcon", j2)), this["_menuManagerService"][_0x240866(447)](gi2), this[_0x240866(456)](this[_0x240866(486)][_0x240866(474)]((_0x1b03b2) => {
      const _0xe031e9 = _0x240866;
      if (_0x1b03b2["id"] === se["id"]) {
        this[_0xe031e9(372)][_0xe031e9(502)]({ "content": this[_0xe031e9(417)]["t"]("editHistory.panel.reverting"), "type": $C["Loading"], "duration": 5e3 });
        const { unitId: _0x4b09d9 } = _0x1b03b2[_0xe031e9(476)], _0x572594 = this[_0xe031e9(475)]["getCollabEntity"](_0x4b09d9), _0x283780 = combineLatest([_0x572594[_0xe031e9(449)][_0xe031e9(359)], _0x572594["state$"]])["subscribe"](async ([_0x6ff2fe, _0x104edc]) => {
          const _0x3e3dfb = _0xe031e9;
          var _0x4075cf;
          _0x6ff2fe[_0x3e3dfb(465)] === Rm[_0x3e3dfb(364)] && (_0x104edc == null ? void 0 : _0x104edc["status"]) === Si["SYNCED"] && _0x6ff2fe[_0x3e3dfb(361)][_0x3e3dfb(428)][_0x3e3dfb(471)]((_0xc802e3) => _0xc802e3["id"] === se["id"]) && (this[_0x3e3dfb(481)][_0x3e3dfb(394)](), _0x283780[_0x3e3dfb(385)](), this["_revertErrorTimer"] && clearTimeout(this[_0x3e3dfb(373)]), await ((_0x4075cf = this["_localCacheService"]) == null ? void 0 : _0x4075cf[_0x3e3dfb(492)]()), setTimeout(() => window[_0x3e3dfb(458)]["reload"]()));
        });
        this[_0xe031e9(373)] = setTimeout(() => {
          const _0x3a5149 = _0xe031e9;
          _0x283780[_0x3a5149(385)](), this[_0x3a5149(372)]["show"]({ "content": this[_0x3a5149(417)]["t"](_0x3a5149(368)), "type": $C[_0x3a5149(375)], "duration": 3e3 });
        }, 5e3);
      }
    }));
  }
};
p = vi2([m2(0, Ls), m2(1, B12), m2(2, Inject(S1)), m2(3, Inject(f2)), m2(4, Inject(Fn)), m2(5, et2), m2(6, Inject(nt2)), m2(7, J3)], p);
var di2 = Object["getOwnPropertyDescriptor"];
var fi2 = (_0x4190d9, _0x157533, _0x20e151, _0x9749ad) => {
  for (var _0x16c75f = _0x9749ad > 1 ? void 0 : _0x9749ad ? di2(_0x157533, _0x20e151) : _0x157533, _0x4a9d0b = _0x4190d9["length"] - 1, _0x40c2f9; _0x4a9d0b >= 0; _0x4a9d0b--) (_0x40c2f9 = _0x4190d9[_0x4a9d0b]) && (_0x16c75f = _0x40c2f9(_0x16c75f) || _0x16c75f);
  return _0x16c75f;
};
var R2 = (_0x564541, _0x1a95a2) => (_0x5b58b2, _0x11c0ae) => _0x1a95a2(_0x5b58b2, _0x11c0ae, _0x564541);
var _i = _0x8bb7a6(393);
var _2;
var N3 = (_2 = class extends Ol {
  constructor(_0x33cc89 = w2, _0x139ee5, _0x504ed1) {
    const _0x5e81c2 = _0x8bb7a6;
    super(), this[_0x5e81c2(479)] = _0x33cc89, this[_0x5e81c2(401)] = _0x139ee5, this["_configService"] = _0x504ed1;
    const { menu: _0x2feeae, ..._0x51b199 } = oo({}, w2, this[_0x5e81c2(479)]);
    _0x2feeae && this["_configService"][_0x5e81c2(442)]("menu", _0x2feeae, { "merge": true }), this[_0x5e81c2(424)][_0x5e81c2(442)](x4, _0x51b199), this[_0x5e81c2(479)][_0x5e81c2(362)] && this[_0x5e81c2(424)]["setConfig"](V3, this[_0x5e81c2(479)]["univerContainerId"]);
  }
  [_0x8bb7a6(497)]() {
    const _0x5dc805 = _0x8bb7a6;
    [[f2], [p]][_0x5dc805(434)]((_0x47aafe) => this[_0x5dc805(401)][_0x5dc805(488)](_0x47aafe));
  }
  ["onSteady"]() {
    const _0x5a0766 = _0x8bb7a6;
    this[_0x5a0766(401)][_0x5a0766(363)](p);
  }
}, g3(_2, "type", we[_0x8bb7a6(427)]), g3(_2, "pluginName", _i), _2);
N3 = fi2([R2(1, Inject(Injector)), R2(2, ic)], N3);

// node_modules/@univerjs-pro/collaboration-client/lib/es/facade.js
var _0x274932 = _0x4cf6;
(function(_0x16c59a, _0x3c3942) {
  var _0x168a17 = _0x4cf6, _0xa1db99 = _0x16c59a();
  while (!![]) {
    try {
      var _0x1cd26c = -parseInt(_0x168a17(298)) / 1 + parseInt(_0x168a17(294)) / 2 + -parseInt(_0x168a17(297)) / 3 + parseInt(_0x168a17(287)) / 4 + parseInt(_0x168a17(311)) / 5 + parseInt(_0x168a17(293)) / 6 + -parseInt(_0x168a17(291)) / 7;
      if (_0x1cd26c === _0x3c3942) break;
      else _0xa1db99["push"](_0xa1db99["shift"]());
    } catch (_0x32eeed) {
      _0xa1db99["push"](_0xa1db99["shift"]());
    }
  }
})(_0x54b1, 753576);
function _0x54b1() {
  var _0x3c4220 = ["3778881iBPaFX", "290725qsCoax", "subscribeCollaborators", "extend", "members$", "waitForRoom$", "_injector", "loadActiveSheetAsync", "length", "loadUnitOfRevision", "from", "loadServerUnit", "getUniverSheet", "get", "1353810qxUyIc", "createInstance", "_handler", "subscribe", "loadSheetAsync", "loadActiveSheet", "readyForCollab", "3013952vxFaKW", "loadServerUnitOfRevision", "pipe", "_collaborationController", "2851359FqvZwi", "loadSheet", "2953968oRrlhQ", "2389374KnJKwK", "getOwnPropertyDescriptor", "[FCollaboration]: this method should be override."];
  _0x54b1 = function() {
    return _0x3c4220;
  };
  return _0x54b1();
}
var f3 = Object[_0x274932(295)];
var y2 = (_0x1ab7b4, _0x5e4d49, _0x2f8eb7, _0xe41ff5) => {
  var _0x4ecb50 = _0x274932;
  for (var _0x6b0740 = _0xe41ff5 > 1 ? void 0 : _0xe41ff5 ? f3(_0x5e4d49, _0x2f8eb7) : _0x5e4d49, _0x4862d9 = _0x1ab7b4[_0x4ecb50(305)] - 1, _0x15ec82; _0x4862d9 >= 0; _0x4862d9--) (_0x15ec82 = _0x1ab7b4[_0x4862d9]) && (_0x6b0740 = _0x15ec82(_0x6b0740) || _0x6b0740);
  return _0x6b0740;
};
var a = (_0x4ac891, _0x580141) => (_0xc636b3, _0x2593ef) => _0x580141(_0xc636b3, _0x2593ef, _0x4ac891);
var c = class extends $ {
  constructor(_0x25f4a0, _0x1f4cd7, _0x33505a, _0x1f57b4, _0x29f2be) {
    var _0x11e5b9 = _0x274932;
    super(), this[_0x11e5b9(282)] = _0x25f4a0, this[_0x11e5b9(303)] = _0x1f4cd7, this["_univerInstanceService"] = _0x33505a, this["_snapshotService"] = _0x1f57b4, this[_0x11e5b9(290)] = _0x29f2be;
  }
  async [_0x274932(285)]() {
    return this["loadActiveSheetAsync"]();
  }
  async [_0x274932(304)]() {
    var _0x595e1b = _0x274932;
    throw new Error(_0x595e1b(296));
  }
  async [_0x274932(292)](_0x30bb96) {
    var _0x27fab1 = _0x274932;
    return this[_0x27fab1(284)](_0x30bb96);
  }
  async ["loadSheetAsync"](_0x57e28f, _0x8aec85) {
    var _0x3e16e6 = _0x274932;
    return await this["_snapshotService"][_0x3e16e6(292)](_0x57e28f, 0, _0x8aec85) ? (await this[_0x3e16e6(290)][_0x3e16e6(286)](_0x57e28f), this[_0x3e16e6(282)][_0x3e16e6(309)](_0x57e28f)) : null;
  }
  [_0x274932(299)](_0x1b8393, _0x94e8e0) {
    var _0x2a76ab = _0x274932;
    const _0x4be9e0 = this["_injector"][_0x2a76ab(310)](Pe3)[_0x2a76ab(302)](_0x1b8393)[_0x2a76ab(289)](switchMap((_0x4cd11b) => _0x4cd11b[_0x2a76ab(301)]))[_0x2a76ab(283)]((_0x2042ce) => _0x94e8e0(Array[_0x2a76ab(307)](_0x2042ce["values"]())));
    return We(_0x4be9e0);
  }
};
c = y2([a(1, Inject(Injector)), a(2, vr), a(3, Inject(zt)), a(4, Inject(nt2))], c);
var w3 = class extends I {
  ["getCollaboration"]() {
    var _0x30c69c = _0x274932;
    return this[_0x30c69c(303)][_0x30c69c(281)](c, { "getUniverSheet": (_0xc60ee4) => this["getUniverSheet"](_0xc60ee4) });
  }
  [_0x274932(308)](_0xf16a32, _0x2455f8, _0x3d895b) {
    var _0x3eb9a1 = _0x274932;
    return this[_0x3eb9a1(303)]["get"](Ot)["loadUnit"](_0xf16a32, _0x2455f8, _0x3d895b);
  }
  [_0x274932(288)](_0x2c4c82, _0x2d4349, _0x283f73) {
    var _0x2a6785 = _0x274932;
    return this["_injector"][_0x2a6785(310)](Ot)[_0x2a6785(306)](_0x2c4c82, _0x2d4349, _0x283f73);
  }
};
function _0x4cf6(_0x2c7e16, _0x4abb21) {
  var _0x54b160 = _0x54b1();
  return _0x4cf6 = function(_0x4cf6b0, _0x3ac094) {
    _0x4cf6b0 = _0x4cf6b0 - 281;
    var _0x11cced = _0x54b160[_0x4cf6b0];
    return _0x11cced;
  }, _0x4cf6(_0x2c7e16, _0x4abb21);
}
I[_0x274932(300)](w3);

// node_modules/@univerjs-pro/collaboration-client-ui/lib/es/facade.js
var _0x3fa250 = _0x243b;
function _0x200a() {
  var _0x1a6f56 = ["7TZauBt", "811342djfXLL", "_injector", "5UuxLYA", "3278760CZDdZm", "3341924ACkhyR", "238430bUEFgk", "3657510sWCYxj", "2619270jWVfPx", "get", "runOnServer", "12779860CkXkHX", "9TsalWU"];
  _0x200a = function() {
    return _0x1a6f56;
  };
  return _0x200a();
}
function _0x243b(_0x1599fc, _0x46f0cf) {
  var _0x200a4f = _0x200a();
  return _0x243b = function(_0x243be3, _0x4a0a0d) {
    _0x243be3 = _0x243be3 - 384;
    var _0x23b134 = _0x200a4f[_0x243be3];
    return _0x23b134;
  }, _0x243b(_0x1599fc, _0x46f0cf);
}
(function(_0x201061, _0x55bcb0) {
  var _0x10a457 = _0x243b, _0x31c218 = _0x201061();
  while (!![]) {
    try {
      var _0x565229 = parseInt(_0x10a457(385)) / 1 * (-parseInt(_0x10a457(391)) / 2) + parseInt(_0x10a457(393)) / 3 + parseInt(_0x10a457(390)) / 4 + -parseInt(_0x10a457(388)) / 5 * (-parseInt(_0x10a457(392)) / 6) + -parseInt(_0x10a457(386)) / 7 + parseInt(_0x10a457(389)) / 8 + -parseInt(_0x10a457(384)) / 9 * (parseInt(_0x10a457(396)) / 10);
      if (_0x565229 === _0x55bcb0) break;
      else _0x31c218["push"](_0x31c218["shift"]());
    } catch (_0x27d529) {
      _0x31c218["push"](_0x31c218["shift"]());
    }
  }
})(_0x200a, 499604);
var o = class extends I {
  [_0x3fa250(395)](_0x1977aa, _0x584ab3, ..._0x4c3022) {
    var _0x45a486 = _0x3fa250;
    return this[_0x45a486(387)][_0x45a486(394)](_t3)["runOnServer"](_0x1977aa, _0x584ab3, {}, ..._0x4c3022);
  }
};
I["extend"](o);

// node_modules/@univerjs/preset-sheets-collaboration/lib/es/index.js
function u(e) {
  const o3 = new URL(e, window.location.origin);
  switch (o3.protocol) {
    case "https:":
      o3.protocol = "wss:";
      break;
    case "http:":
      o3.protocol = "ws:";
      break;
  }
  return o3.toString();
}
function h(e = {}) {
  const {
    universerEndpoint: o3,
    univerContainerId: i = "app",
    enableOfflineEditing: t = true,
    enableSingleActiveInstanceLock: n = true
  } = e, r = o3 != null ? o3 : `${window.location.protocol}//${window.location.host}`;
  return {
    plugins: [
      Re,
      [Dt, {
        socketService: ct2,
        enableOfflineEditing: t,
        enableSingleActiveInstanceLock: n,
        enableAuthServer: true,
        authzUrl: `${r}/universer-api/authz`,
        snapshotServerUrl: `${r}/universer-api/snapshot`,
        collabSubmitChangesetUrl: `${r}/universer-api/comb`,
        collabWebSocketUrl: u(`${r}/universer-api/comb/connect`),
        loginUrlKey: `${r}/universer-api/oidc/authpage`,
        uploadFileServerUrl: `${r}/universer-api/stream/file/upload`,
        signUrlServerUrl: `${r}/universer-api/file/{fileID}/sign-url`,
        downloadEndpointUrl: `${r}/`,
        wsSessionTicketUrl: `${r}/universer-api/user/session-ticket`,
        sendChangesetTimeout: 200
      }],
      [Be2, {}],
      [N3, {
        univerContainerId: i,
        historyListServerUrl: `${r}/universer-api/history`
      }]
    ]
  };
}
export {
  Tt2 as AuthzIoHttpService,
  le as AwaitingState,
  oe as AwaitingWithPendingState,
  ct2 as BrowserCollaborationSocketService,
  K as COLLABORATION_CLIENT_PLUGIN_CONFIG_KEY,
  nt2 as CollaborationController,
  ae2 as CollaborationDataLoaderController,
  st2 as CollaborationEntity,
  Rm as CollaborationEvent,
  Rt as CollaborationImageIoService,
  mt as CollaborationSession,
  we3 as CollaborationSessionService,
  Wt as CollaborationSocketService,
  Si as CollaborationStatus,
  re as CollaborationUIEventId,
  ve as CollaborationUIEventService,
  bt2 as CollaborativeUndoRedoService,
  Ei as CommentService,
  pr as CompressMutationService,
  ue2 as ConflictState,
  pd as CreateUnitMutation,
  Es as DEFAULT_COLLAB_WEB_SOCKET_URL,
  Cr as DEFAULT_REMOTE_UNISCRIPT_EXECUTION_ENDPOINT,
  gr3 as DEFAULT_WS_SESSION_TICKET_URL,
  Ot as DataLoaderService,
  oe2 as DesktopCollaborationStatusDisplayController,
  It3 as DocCollaborationEntity,
  $t2 as DocTransformController,
  ee2 as FetchingMissState,
  ms as HEARTBEAT_INTERVAL_KEY,
  di as HEARTBEAT_TIMEOUT_KEY,
  f2 as HistoryLoaderService,
  g2 as HistoryManagerService,
  ne2 as HistoryModeStatus,
  Oi as ICollaborationSocketService,
  J3 as ILocalCacheService,
  Fs2 as INetworkConditionService,
  _t2 as ISingleActiveUnitService,
  gr2 as ISnapshotServerService,
  Pe2 as ITransformService,
  At3 as IURLService,
  Or as LOCAL_CACHE_INTERVAL,
  Tr as LOCAL_CACHE_INTERVAL_KEY,
  Pe3 as MemberService,
  Ct as MentionIoHttpService,
  de2 as OfflineState,
  ae as PendingState,
  Rr as REMOTE_UNISCRIPT_EXECUTION_ENDPOINT_KEY,
  gs as RETRY_CONNECTING_MAX_COUNT_KEY,
  _t3 as RemoteUniscriptService,
  se as RevertRevisionMutation,
  Jt as RevisionService,
  Pd as SINGLE_HISTORY_MUTATIONS,
  Cd as SINGLE_SNAPSHOT_MUTATIONS,
  me2 as SessionStatus,
  qi as SheetCollabCursorShape,
  St as SheetCollaborationEntity,
  jt as SheetTransformController,
  it as SheetTransformSelectionsService,
  Xe as SnapshotSaveService,
  Nt2 as SnapshotServerOverHTTPService,
  zt as SnapshotService,
  be as SyncedState,
  fe3 as TransformService,
  V3 as UNIVER_CONTAINER_ID_KEY,
  d as UNIVER_HISTORY_CONTAINER_ID,
  mi as UnitStatus,
  Dt as UniverCollaborationClientPlugin,
  Be2 as UniverCollaborationClientUIPlugin,
  Re as UniverCollaborationPlugin,
  N3 as UniverEditHistoryLoaderPlugin,
  ee3 as UniverEditHistoryViewerPlugin,
  h as UniverSheetsCollaborationPreset,
  tr as WebBrowserSingleActiveUnitService,
  Rn as WebURLService,
  Ir as b64DecodeUnicode,
  bd as b64EncodeUnicode,
  js2 as deserializeToCombResponse,
  km as generateTempDocumentSnapshot,
  xm as generateTemporarySnap,
  Nr as getLocalCacheKey,
  Md as getSheetBlocksFromSnapshot,
  Hr as isTransformChangesetsFailure,
  Rd as isTransformChangesetsSuccess,
  ce as isTransformMutationFailure,
  at2 as isTransformMutationSuccess,
  pe as isTransformMutationsFailure,
  fd as isTransformMutationsSuccess,
  Gr as isTransformMutationsWithChangesetFailure,
  hd as isTransformMutationsWithChangesetSuccess,
  Ud as mapDocumentTypeToUniverType,
  wd as parseChangesetToProtocol,
  fm as parseMutationToProtocol,
  Id as parseProtocolChangeset,
  gd as parseProtocolCommand,
  pm as parseProtocolMutation,
  Vs as serializeCombRequest,
  ie3 as textDecoder,
  xt2 as textEncoder,
  Ym as transformDocumentDataToSnapshot,
  Gm as transformSnapshotToDocumentData,
  Hm as transformSnapshotToWorkbookData,
  Fm as transformWorkbookDataToSnapshot,
  Ye2 as uuidv4
};
//# sourceMappingURL=@univerjs_presets_preset-sheets-collaboration.js.map
