import {
  C,
  M,
  g,
  m
} from "./chunk-2GFBUOZM.js";
import {
  S,
  k,
  xn
} from "./chunk-FOCXVU2X.js";
import {
  B1,
  Bi,
  D1,
  H1,
  S1,
  U1,
  Wm,
  Y1,
  a1,
  at,
  connectInjector,
  ct,
  fe,
  he,
  ir2 as ir,
  ob,
  useDependency,
  useObservable
} from "./chunk-DZMX4FYO.js";
import {
  Ft,
  Le,
  P,
  Pe,
  Ve as Ve2,
  _e2 as _e,
  br2 as br,
  ie as ie2,
  ph,
  z
} from "./chunk-I7I3GTAS.js";
import {
  I,
  TE,
  XS,
  em,
  hE,
  ie,
  j,
  kE,
  pr,
  require_jsx_runtime,
  require_react,
  vf,
  vr as vr2
} from "./chunk-YFGUMDM2.js";
import {
  BehaviorSubject,
  Fn,
  Inject,
  Injector,
  J,
  Ls,
  Ms,
  Ns,
  Ol,
  Ve,
  XC,
  ge,
  h1,
  ic,
  oo,
  qR,
  takeUntil,
  vr,
  we
} from "./chunk-RGZYGL3P.js";
import {
  __toESM
} from "./chunk-DC5AMYBS.js";

// node_modules/@univerjs/sheets-sort-ui/lib/es/index.js
var import_jsx_runtime = __toESM(require_jsx_runtime());
var import_react = __toESM(require_react());
var Ve3 = Object.defineProperty;
var Ge = (e, t, r) => t in e ? Ve3(e, t, { enumerable: true, configurable: true, writable: true, value: r }) : e[t] = r;
var Y = (e, t, r) => Ge(e, typeof t != "symbol" ? t + "" : t, r);
var Et = (e) => {
  const [t, r] = (0, import_react.useState)("0"), n = useDependency(Fn);
  return (0, import_jsx_runtime.jsxs)("div", { className: "univer-text-sm", children: [
    (0, import_jsx_runtime.jsx)("div", { className: "extend-confirm-desc", children: n.t("sheets-sort.dialog.sort-reminder-desc") }),
    (0, import_jsx_runtime.jsxs)(
      kE,
      {
        className: "univer-mt-4",
        value: t,
        direction: "vertical",
        onChange: (o) => {
          r(o), e.onChange(o);
        },
        children: [
          (0, import_jsx_runtime.jsx)(TE, { value: "0", children: n.t("sheets-sort.dialog.sort-reminder-no") }),
          (0, import_jsx_runtime.jsx)(TE, { value: "1", children: n.t("sheets-sort.dialog.sort-reminder-ext") })
        ]
      }
    )
  ] });
};
var Tt = Object.getOwnPropertyDescriptor;
var bt = (e, t, r, n) => {
  for (var o = n > 1 ? void 0 : n ? Tt(t, r) : t, s = e.length - 1, i; s >= 0; s--)
    (i = e[s]) && (o = i(o) || o);
  return o;
};
var D = (e, t) => (r, n) => t(r, n, e);
var B = {
  MERGE_ERROR: "sheets-sort.error.merge-size",
  EMPTY_ERROR: "sheets-sort.error.empty",
  SINGLE_ERROR: "sheets-sort.error.single",
  FORMULA_ARRAY: "sheets-sort.error.formula-array"
};
var C2 = class extends Ve {
  constructor(t, r, n, o, s, i) {
    super();
    Y(this, "_customSortState$", new BehaviorSubject(null));
    Y(this, "customSortState$", this._customSortState$.asObservable());
    this._univerInstanceService = t, this._confirmService = r, this._selectionManagerService = n, this._sheetsSortService = o, this._localeService = s, this._commandService = i;
  }
  async triggerSortDirectly(t, r, n) {
    const o = n || await this._detectSortLocation(r);
    if (!o || !this._check(o))
      return false;
    const i = {
      orderRules: [{
        type: t ? m.ASC : m.DESC,
        colIndex: o.colIndex
      }],
      range: o.range
    };
    return this._sheetsSortService.applySort(i, o.unitId, o.subUnitId), true;
  }
  async triggerSortCustomize() {
    const t = await this._detectSortLocation();
    return !t || !this._check(t) ? false : (this.showCustomSortPanel(t), true);
  }
  customSortState() {
    return this._customSortState$.getValue();
  }
  getTitles(t) {
    var l, u;
    const r = (l = this.customSortState()) == null ? void 0 : l.location;
    if (!r)
      return [];
    const { unitId: n, subUnitId: o, range: s } = r, i = (u = this._univerInstanceService.getUnit(n)) == null ? void 0 : u.getSheetBySheetId(o);
    if (!i)
      return [];
    const a = Ot(this._localeService);
    return Array.from({ length: s.endColumn - s.startColumn + 1 }, (_, v) => {
      var m3;
      const E2 = (m3 = i.getCell(s.startRow, v + s.startColumn)) == null ? void 0 : m3.v;
      return {
        index: v + s.startColumn,
        label: t ? `${E2 != null ? E2 : a(v + s.startColumn)}` : a(v + s.startColumn)
      };
    });
  }
  setSelection(t, r, n) {
    var i;
    const o = (i = this._univerInstanceService.getUnit(t)) == null ? void 0 : i.getSheetBySheetId(r);
    if (!o)
      return;
    const s = {
      unitId: t,
      subUnitId: r,
      selections: [{ range: n, primary: _e(n, o), style: null }]
    };
    this._commandService.executeCommand(ie2.id, s);
  }
  async showCheckError(t) {
    return await this._confirmService.confirm({
      id: "sort-range-check-error",
      title: {
        title: this._localeService.t("info.tooltip")
      },
      children: {
        title: (0, import_jsx_runtime.jsx)("div", { children: this._localeService.t(t) })
      },
      cancelText: this._localeService.t("sheets-sort.dialog.cancel"),
      confirmText: this._localeService.t("sheets-sort.dialog.confirm")
    });
  }
  async showExtendConfirm() {
    let t = false;
    return await this._confirmService.confirm({
      id: "extend-sort-range-dialog",
      title: {
        title: this._localeService.t("sheets-sort.dialog.sort-reminder")
      },
      children: {
        title: (0, import_jsx_runtime.jsx)(
          Et,
          {
            onChange: (n) => {
              t = n === "1";
            }
          }
        )
      },
      width: 400,
      cancelText: this._localeService.t("sheets-sort.dialog.cancel"),
      confirmText: this._localeService.t("sheets-sort.dialog.confirm")
    }) ? t ? "extend" : "keep" : "cancel";
  }
  showCustomSortPanel(t) {
    this._customSortState$.next({ location: t, show: true });
  }
  closeCustomSortPanel() {
    this._customSortState$.next({ show: false });
  }
  _check(t) {
    return this._sheetsSortService.singleCheck(t) ? this._sheetsSortService.mergeCheck(t) ? this._sheetsSortService.formulaCheck(t) ? this._sheetsSortService.emptyCheck(t) ? true : (this.showCheckError(B.EMPTY_ERROR), false) : (this.showCheckError(B.FORMULA_ARRAY), false) : (this.showCheckError(B.MERGE_ERROR), false) : (this.showCheckError(B.SINGLE_ERROR), false);
  }
  async _detectSortLocation(t) {
    const r = this._univerInstanceService.getCurrentUnitForType(we.UNIVER_SHEET), n = r.getActiveSheet(), o = r.getUnitId(), s = n.getSheetId(), i = this._selectionManagerService.getCurrentLastSelection();
    if (!i)
      return null;
    let a;
    if (t === true)
      a = ph(i.range, { up: true, down: true, left: true, right: true }, n), this.setSelection(o, s, a);
    else if (t === false)
      a = i.range;
    else {
      const l = await this.showExtendConfirm();
      if (l === "cancel")
        return null;
      l === "keep" ? a = i.range : (a = ph(i.range, { up: true, down: true, left: true, right: true }, n), this.setSelection(o, s, a));
    }
    return {
      range: a,
      unitId: o,
      subUnitId: s,
      colIndex: i.primary.actualColumn
    };
  }
};
C2 = bt([
  D(0, vr),
  D(1, at),
  D(2, Inject(z)),
  D(3, Inject(g)),
  D(4, Inject(Fn)),
  D(5, Ls)
], C2);
function Ot(e) {
  return (t) => {
    const r = J.chatAtABC(t);
    switch (e.getCurrentLocale()) {
      case Ns.ZH_CN:
        return `"${r}"åˆ—`;
      case Ns.EN_US:
        return `Column "${r}"`;
      default:
        return `Column "${r}"`;
    }
  };
}
var J2 = {
  id: "sheet.command.sort-range-asc",
  type: Ms.COMMAND,
  handler: async (e) => await e.get(C2).triggerSortDirectly(true, false)
};
var Q = {
  id: "sheet.command.sort-range-asc-ext",
  type: Ms.COMMAND,
  handler: async (e) => await e.get(C2).triggerSortDirectly(true, true)
};
var ee = {
  id: "sheet.command.sort-range-desc",
  type: Ms.COMMAND,
  handler: async (e) => await e.get(C2).triggerSortDirectly(false, false)
};
var te = {
  id: "sheet.command.sort-range-desc-ext",
  type: Ms.COMMAND,
  handler: async (e) => await e.get(C2).triggerSortDirectly(false, true)
};
var re = {
  id: "sheet.command.sort-range-custom",
  type: Ms.COMMAND,
  handler: async (e) => await e.get(C2).triggerSortCustomize()
};
var ne = {
  id: "sheet.command.sort-range-asc-ctx",
  type: Ms.COMMAND,
  handler: async (e) => await e.get(C2).triggerSortDirectly(true, false)
};
var oe = {
  id: "sheet.command.sort-range-asc-ext-ctx",
  type: Ms.COMMAND,
  handler: async (e) => await e.get(C2).triggerSortDirectly(true, true)
};
var se = {
  id: "sheet.command.sort-range-desc-ctx",
  type: Ms.COMMAND,
  handler: async (e) => await e.get(C2).triggerSortDirectly(false, false)
};
var ie3 = {
  id: "sheet.command.sort-range-desc-ext-ctx",
  type: Ms.COMMAND,
  handler: async (e) => await e.get(C2).triggerSortDirectly(false, true)
};
var ce = {
  id: "sheet.command.sort-range-custom-ctx",
  type: Ms.COMMAND,
  handler: async (e) => await e.get(C2).triggerSortCustomize()
};
var Nt = "sheets-sort-ui.config";
var fe2 = {};
function x({ ref: e, ...t }) {
  const { icon: r, id: n, className: o, extend: s, ...i } = t, a = `univerjs-icon univerjs-icon-${n} ${o || ""}`.trim(), l = (0, import_react.useRef)(`_${Dt()}`);
  return be(r, `${n}`, {
    defIds: r.defIds,
    idSuffix: l.current
  }, {
    ref: e,
    className: a,
    ...i
  }, s);
}
function be(e, t, r, n, o) {
  return (0, import_react.createElement)(e.tag, {
    key: t,
    ...Lt(e, r, o),
    ...n
  }, (kt(e, r).children || []).map((s, i) => be(s, `${t}-${e.tag}-${i}`, r, void 0, o)));
}
function Lt(e, t, r) {
  const n = { ...e.attrs };
  r != null && r.colorChannel1 && n.fill === "colorChannel1" && (n.fill = r.colorChannel1), e.tag === "mask" && n.id && (n.id = n.id + t.idSuffix), Object.entries(n).forEach(([s, i]) => {
    s === "mask" && typeof i == "string" && (n[s] = i.replace(/url\(#(.*)\)/, `url(#$1${t.idSuffix})`));
  });
  const { defIds: o } = t;
  return !o || o.length === 0 || (e.tag === "use" && n["xlink:href"] && (n["xlink:href"] = n["xlink:href"] + t.idSuffix), Object.entries(n).forEach(([s, i]) => {
    typeof i == "string" && (n[s] = i.replace(/url\(#(.*)\)/, `url(#$1${t.idSuffix})`));
  })), n;
}
function kt(e, t) {
  var n;
  const { defIds: r } = t;
  return !r || r.length === 0 ? e : e.tag === "defs" && ((n = e.children) != null && n.length) ? {
    ...e,
    children: e.children.map((o) => typeof o.attrs.id == "string" && r && r.includes(o.attrs.id) ? {
      ...o,
      attrs: {
        ...o.attrs,
        id: o.attrs.id + t.idSuffix
      }
    } : o)
  } : e;
}
function Dt() {
  return Math.random().toString(36).substring(2, 8);
}
x.displayName = "UniverIcon";
var $t = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M12.4208 14.4667C12.4208 14.798 12.1522 15.0667 11.8208 15.0667C11.4895 15.0667 11.2208 14.798 11.2208 14.4667V2.98193L9.97861 4.22417C9.7443 4.45848 9.3644 4.45848 9.13008 4.22417C8.89577 3.98985 8.89577 3.60995 9.13008 3.37564L11.3967 1.10897C11.6311 0.874657 12.011 0.874657 12.2453 1.10897L14.5119 3.37564C14.7463 3.60995 14.7463 3.98985 14.5119 4.22417C14.2776 4.45848 13.8977 4.45848 13.6634 4.22417L12.4208 2.9816V14.4667Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M1.98967 10.2798C1.6583 10.2798 1.38967 10.0112 1.38967 9.67983C1.38967 9.34846 1.6583 9.07983 1.98967 9.07983H6.50138C6.74406 9.07983 6.96284 9.22602 7.05571 9.45022C7.14858 9.67443 7.09725 9.9325 6.92565 10.1041L3.43819 13.5916H6.50138C6.83276 13.5916 7.10138 13.8602 7.10138 14.1916C7.10138 14.5229 6.83276 14.7916 6.50138 14.7916H1.98967C1.74699 14.7916 1.52821 14.6454 1.43534 14.4212C1.34247 14.197 1.3938 13.9389 1.5654 13.7673L5.05286 10.2798H1.98967Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M5.1846 1.86439C4.8641 0.989866 3.62725 0.989866 3.30674 1.86439L1.34882 7.20672C1.23479 7.51786 1.39458 7.86252 1.70571 7.97655C2.01684 8.09058 2.3615 7.93079 2.47553 7.61966L3.06159 6.02055L3.06338 6.02056H5.42975L6.01581 7.61966C6.12984 7.93079 6.4745 8.09058 6.78563 7.97655C7.09677 7.86252 7.25655 7.51786 7.14252 7.20672L5.1846 1.86439ZM4.98996 4.82056L4.24567 2.78971L3.50138 4.82056H4.98996Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    }
  ]
};
var ae = (0, import_react.forwardRef)(function(t, r) {
  return (0, import_react.createElement)(x, Object.assign({}, t, {
    id: "ascending-icon",
    ref: r,
    icon: $t
  }));
});
ae.displayName = "AscendingIcon";
var Ht = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M14.1544 3.75557C14.3887 3.98988 14.3887 4.36978 14.1544 4.6041L6.51409 12.2444C6.40157 12.3569 6.24896 12.4201 6.08983 12.4201C5.9307 12.4201 5.77808 12.3569 5.66556 12.2444L1.84541 8.42425C1.6111 8.18993 1.6111 7.81003 1.84541 7.57572C2.07973 7.34141 2.45963 7.34141 2.69394 7.57572L6.08983 10.9716L13.3059 3.75557C13.5402 3.52126 13.9201 3.52126 14.1544 3.75557Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var Oe = (0, import_react.forwardRef)(function(t, r) {
  return (0, import_react.createElement)(x, Object.assign({}, t, {
    id: "check-mark-icon",
    ref: r,
    icon: Ht
  }));
});
Oe.displayName = "CheckMarkIcon";
var At = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M9.77445 9.24306L9.77457 11.9573C9.77458 12.2887 9.50597 12.5574 9.17459 12.5574C8.84322 12.5574 8.57458 12.2888 8.57457 11.9574L8.57439 7.79509C8.57438 7.46372 8.84299 7.19508 9.17436 7.19507C9.3281 7.19493 9.48196 7.25351 9.59925 7.3708L11.3465 9.11808C11.5808 9.3524 11.5808 9.7323 11.3465 9.96661C11.1122 10.2009 10.7323 10.2009 10.498 9.96661L9.77445 9.24306Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M6.22584 10.5094L6.22572 7.79514C6.22571 7.46377 6.49433 7.19513 6.8257 7.19512C7.15707 7.1951 7.42571 7.46372 7.42572 7.79509L7.4259 11.9574C7.42592 12.2888 7.1573 12.5574 6.82593 12.5574C6.67228 12.5575 6.51828 12.4989 6.40104 12.3817L4.65376 10.6344C4.41945 10.4001 4.41945 10.0202 4.65376 9.78588C4.88808 9.55156 5.26798 9.55156 5.50229 9.78588L6.22584 10.5094Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M1.14014 3.73989C1.14014 2.30396 2.3042 1.13989 3.74014 1.13989H12.2601C13.6961 1.13989 14.8601 2.30395 14.8601 3.73989V12.2599C14.8601 13.6958 13.6961 14.8599 12.2601 14.8599H3.74014C2.3042 14.8599 1.14014 13.6958 1.14014 12.2599V3.73989ZM2.34014 5.86724V12.2599C2.34014 13.0331 2.96694 13.6599 3.74014 13.6599H12.2601C13.0333 13.6599 13.6601 13.0331 13.6601 12.2599V5.86724H2.34014ZM13.6601 4.66724H2.34014V3.73989C2.34014 2.9667 2.96694 2.33989 3.74014 2.33989H12.2601C13.0333 2.33989 13.6601 2.96669 13.6601 3.73989V4.66724Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    }
  ]
};
var Ne = (0, import_react.forwardRef)(function(t, r) {
  return (0, import_react.createElement)(x, Object.assign({}, t, {
    id: "custom-sort-icon",
    ref: r,
    icon: At
  }));
});
Ne.displayName = "CustomSortIcon";
var Ut = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M5.3313 1.4667C5.3313 1.13533 5.59993 0.866699 5.9313 0.866699H10.069C10.4004 0.866699 10.669 1.13533 10.669 1.4667C10.669 1.79807 10.4004 2.0667 10.069 2.0667H5.9313C5.59993 2.0667 5.3313 1.79807 5.3313 1.4667Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M1.09985 3.64443C1.09985 3.31306 1.36848 3.04443 1.69985 3.04443H14.2999C14.6312 3.04443 14.8999 3.31306 14.8999 3.64443C14.8999 3.9758 14.6312 4.24443 14.2999 4.24443H1.69985C1.36848 4.24443 1.09985 3.9758 1.09985 3.64443Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M4.75332 5.22217C3.86966 5.22217 3.15332 5.93851 3.15332 6.82217V13.1332C3.15332 14.2377 4.04875 15.1332 5.15332 15.1332H10.8465C11.9511 15.1332 12.8465 14.2377 12.8465 13.1331V6.82217C12.8465 5.93851 12.1302 5.22217 11.2465 5.22217H4.75332ZM4.35332 6.82217C4.35332 6.60125 4.53241 6.42217 4.75332 6.42217H11.2465C11.4674 6.42217 11.6465 6.60125 11.6465 6.82217V13.1331C11.6465 13.575 11.2884 13.9331 10.8465 13.9331H5.15332C4.71149 13.9331 4.35332 13.575 4.35332 13.1332V6.82217Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    }
  ]
};
var Le2 = (0, import_react.forwardRef)(function(t, r) {
  return (0, import_react.createElement)(x, Object.assign({}, t, {
    id: "delete-empty-icon",
    ref: r,
    icon: Ut
  }));
});
Le2.displayName = "DeleteEmptyIcon";
var Pt = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M12.4208 1.53335C12.4208 1.20198 12.1522 0.93335 11.8208 0.93335C11.4895 0.93335 11.2208 1.20198 11.2208 1.53335V13.0181L9.97861 11.7758C9.7443 11.5415 9.3644 11.5415 9.13008 11.7758C8.89577 12.0101 8.89577 12.39 9.13008 12.6244L11.3967 14.891C11.6311 15.1253 12.011 15.1253 12.2453 14.891L14.5119 12.6244C14.7463 12.39 14.7463 12.0101 14.5119 11.7758C14.2776 11.5415 13.8977 11.5415 13.6634 11.7758L12.4208 13.0184V1.53335Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M1.98967 10.2798C1.6583 10.2798 1.38967 10.0112 1.38967 9.67983C1.38967 9.34846 1.6583 9.07983 1.98967 9.07983H6.50138C6.74406 9.07983 6.96284 9.22602 7.05571 9.45022C7.14858 9.67443 7.09725 9.9325 6.92565 10.1041L3.43819 13.5916H6.50138C6.83276 13.5916 7.10138 13.8602 7.10138 14.1916C7.10138 14.5229 6.83276 14.7916 6.50138 14.7916H1.98967C1.74699 14.7916 1.52821 14.6454 1.43534 14.4212C1.34247 14.197 1.3938 13.9389 1.5654 13.7673L5.05286 10.2798H1.98967Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M5.1846 1.86439C4.8641 0.989866 3.62725 0.989866 3.30674 1.86439L1.34882 7.20672C1.23479 7.51786 1.39458 7.86252 1.70571 7.97655C2.01684 8.09058 2.3615 7.93079 2.47553 7.61966L3.06159 6.02055L3.06338 6.02056H5.42975L6.01581 7.61966C6.12984 7.93079 6.4745 8.09058 6.78563 7.97655C7.09677 7.86252 7.25655 7.51786 7.14252 7.20672L5.1846 1.86439ZM4.98996 4.82056L4.24567 2.78971L3.50138 4.82056H4.98996Z",
        fillRule: "evenodd",
        clipRule: "evenodd"
      }
    }
  ]
};
var le = (0, import_react.forwardRef)(function(t, r) {
  return (0, import_react.createElement)(x, Object.assign({}, t, {
    id: "descending-icon",
    ref: r,
    icon: Pt
  }));
});
le.displayName = "DescendingIcon";
var Zt = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M1.9064 3.20024C1.57503 3.20024 1.3064 2.93161 1.3064 2.60024C1.3064 2.26887 1.57503 2.00024 1.9064 2.00024H4.57306C4.90443 2.00024 5.17306 2.26887 5.17306 2.60024C5.17306 2.93161 4.90443 3.20024 4.57306 3.20024H1.9064ZM1.3064 6.19985C1.3064 6.53122 1.57503 6.79985 1.9064 6.79985H5.9064C6.23777 6.79985 6.5064 6.53122 6.5064 6.19985C6.5064 5.86848 6.23777 5.59985 5.9064 5.59985H1.9064C1.57503 5.59985 1.3064 5.86848 1.3064 6.19985ZM1.9064 10.3997C1.57503 10.3997 1.3064 10.1311 1.3064 9.79971C1.3064 9.46834 1.57503 9.19971 1.9064 9.19971H7.23973C7.5711 9.19971 7.83973 9.46834 7.83973 9.79971C7.83973 10.1311 7.5711 10.3997 7.23973 10.3997H1.9064ZM1.9064 13.9996C1.57503 13.9996 1.3064 13.7309 1.3064 13.3996C1.3064 13.0682 1.57503 12.7996 1.9064 12.7996H8.57306C8.90443 12.7996 9.17306 13.0682 9.17306 13.3996C9.17306 13.7309 8.90443 13.9996 8.57306 13.9996H1.9064Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M12.4267 14.2667C12.4267 14.5981 12.1581 14.8667 11.8267 14.8667C11.4953 14.8667 11.2267 14.5981 11.2267 14.2667V3.18198L9.98447 4.42422C9.75015 4.65853 9.37026 4.65853 9.13594 4.42422C8.90163 4.1899 8.90163 3.81 9.13594 3.57569L11.4026 1.30902C11.6369 1.07471 12.0168 1.07471 12.2511 1.30902L14.5178 3.57569C14.7521 3.81 14.7521 4.1899 14.5178 4.42422C14.2835 4.65853 13.9036 4.65853 13.6693 4.42422L12.4267 3.18165V14.2667Z"
    }
  }]
};
var ke = (0, import_react.forwardRef)(function(t, r) {
  return (0, import_react.createElement)(x, Object.assign({}, t, {
    id: "expand-ascending-icon",
    ref: r,
    icon: Zt
  }));
});
ke.displayName = "ExpandAscendingIcon";
var jt = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M1.9064 12.7998C1.57503 12.7998 1.3064 13.0684 1.3064 13.3998C1.3064 13.7311 1.57503 13.9998 1.9064 13.9998H4.57306C4.90443 13.9998 5.17306 13.7311 5.17306 13.3998C5.17306 13.0684 4.90443 12.7998 4.57306 12.7998H1.9064ZM1.3064 9.80015C1.3064 9.46878 1.57503 9.20015 1.9064 9.20015H5.9064C6.23777 9.20015 6.5064 9.46878 6.5064 9.80015C6.5064 10.1315 6.23777 10.4001 5.9064 10.4001H1.9064C1.57503 10.4001 1.3064 10.1315 1.3064 9.80015ZM1.9064 5.60029C1.57503 5.60029 1.3064 5.86892 1.3064 6.20029C1.3064 6.53166 1.57503 6.80029 1.9064 6.80029H7.23973C7.5711 6.80029 7.83973 6.53166 7.83973 6.20029C7.83973 5.86892 7.5711 5.60029 7.23973 5.60029H1.9064ZM1.9064 2.00044C1.57503 2.00044 1.3064 2.26907 1.3064 2.60044C1.3064 2.93181 1.57503 3.20044 1.9064 3.20044H8.57306C8.90443 3.20044 9.17306 2.93181 9.17306 2.60044C9.17306 2.26907 8.90443 2.00044 8.57306 2.00044H1.9064Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }, {
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M12.4267 1.7333C12.4267 1.40193 12.1581 1.1333 11.8267 1.1333C11.4953 1.1333 11.2267 1.40193 11.2267 1.7333V12.818L9.98447 11.5758C9.75015 11.3415 9.37026 11.3415 9.13594 11.5758C8.90163 11.8101 8.90163 12.19 9.13594 12.4243L11.4026 14.691C11.6369 14.9253 12.0168 14.9253 12.2511 14.691L14.5178 12.4243C14.7521 12.19 14.7521 11.8101 14.5178 11.5758C14.2835 11.3415 13.9036 11.3415 13.6693 11.5758L12.4267 12.8183V1.7333Z"
    }
  }]
};
var De = (0, import_react.forwardRef)(function(t, r) {
  return (0, import_react.createElement)(x, Object.assign({}, t, {
    id: "expand-descending-icon",
    ref: r,
    icon: jt
  }));
});
De.displayName = "ExpandDescendingIcon";
var Bt = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M8.6 1.99991C8.60001 1.66854 8.33138 1.39991 8.00001 1.3999C7.66864 1.3999 7.40001 1.66853 7.4 1.9999L7.39996 7.3999H1.9999C1.66853 7.3999 1.3999 7.66853 1.3999 7.9999C1.3999 8.33127 1.66853 8.5999 1.9999 8.5999H7.39995L7.3999 13.9999C7.3999 14.3313 7.66853 14.5999 7.9999 14.5999C8.33127 14.5999 8.5999 14.3313 8.5999 13.9999L8.59995 8.5999H13.9999C14.3313 8.5999 14.5999 8.33127 14.5999 7.9999C14.5999 7.66853 14.3313 7.3999 13.9999 7.3999H8.59996L8.6 1.99991Z"
    }
  }]
};
var K = (0, import_react.forwardRef)(function(t, r) {
  return (0, import_react.createElement)(x, Object.assign({}, t, {
    id: "increase-icon",
    ref: r,
    icon: Bt
  }));
});
K.displayName = "IncreaseIcon";
var Ft2 = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [{
    tag: "path",
    attrs: {
      fill: "currentColor",
      d: "M11.3536 6.14645C11.5488 6.34171 11.5488 6.65829 11.3536 6.85355L8.35355 9.85355C8.15829 10.0488 7.84171 10.0488 7.64645 9.85355L4.64645 6.85355C4.45118 6.65829 4.45118 6.34171 4.64645 6.14645C4.84171 5.95118 5.15829 5.95118 5.35355 6.14645L8 8.79289L10.6464 6.14645C10.8417 5.95118 11.1583 5.95118 11.3536 6.14645Z",
      fillRule: "evenodd",
      clipRule: "evenodd"
    }
  }]
};
var $e = (0, import_react.forwardRef)(function(t, r) {
  return (0, import_react.createElement)(x, Object.assign({}, t, {
    id: "more-down-icon",
    ref: r,
    icon: Ft2
  }));
});
$e.displayName = "MoreDownIcon";
var Vt = {
  tag: "svg",
  attrs: {
    xmlns: "http://www.w3.org/2000/svg",
    fill: "none",
    viewBox: "0 0 16 16",
    width: "1em",
    height: "1em"
  },
  children: [
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M6 5C6.55228 5 7 4.55228 7 4C7 3.44772 6.55228 3 6 3C5.44772 3 5 3.44772 5 4C5 4.55228 5.44772 5 6 5Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M6 9C6.55228 9 7 8.55229 7 8C7 7.44772 6.55228 7 6 7C5.44772 7 5 7.44772 5 8C5 8.55229 5.44772 9 6 9Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M7 12C7 12.5523 6.55228 13 6 13C5.44772 13 5 12.5523 5 12C5 11.4477 5.44772 11 6 11C6.55228 11 7 11.4477 7 12Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M10 5C10.5523 5 11 4.55228 11 4C11 3.44772 10.5523 3 10 3C9.44771 3 9 3.44772 9 4C9 4.55228 9.44771 5 10 5Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M11 8C11 8.55229 10.5523 9 10 9C9.44771 9 9 8.55229 9 8C9 7.44772 9.44771 7 10 7C10.5523 7 11 7.44772 11 8Z"
      }
    },
    {
      tag: "path",
      attrs: {
        fill: "currentColor",
        d: "M10 13C10.5523 13 11 12.5523 11 12C11 11.4477 10.5523 11 10 11C9.44771 11 9 11.4477 9 12C9 12.5523 9.44771 13 10 13Z"
      }
    }
  ]
};
var He = (0, import_react.forwardRef)(function(t, r) {
  return (0, import_react.createElement)(x, Object.assign({}, t, {
    id: "sequence-icon",
    ref: r,
    icon: Vt
  }));
});
He.displayName = "SequenceIcon";
function Gt() {
  const e = useDependency(C2), t = useObservable(e.customSortState$);
  return !t || !t.location ? null : (0, import_jsx_runtime.jsx)(Wt, { state: t });
}
function Wt({ state: e }) {
  const t = useDependency(g), r = useDependency(Fn), n = useDependency(C2), [o, s] = (0, import_react.useState)(false), [i, a] = (0, import_react.useState)(0), l = (0, import_react.useRef)(null), { range: u, unitId: _, subUnitId: v } = e.location, E2 = n.getTitles(o), [m3, A] = (0, import_react.useState)([
    { type: m.ASC, colIndex: u.startColumn }
  ]), j2 = (0, import_react.useCallback)((d, S2) => {
    const U = [...m3];
    S2 === null ? U.splice(d, 1) : U[d] = S2, A(U);
  }, [m3]), h = (0, import_react.useCallback)(
    XC(() => {
      const d = [...m3], S2 = zt(u, m3);
      S2 !== null && (d.push({ type: m.ASC, colIndex: S2 }), A(d));
    }, 200),
    [m3, u]
  ), z2 = (0, import_react.useCallback)((d, S2) => {
    t.applySort({ range: u, orderRules: d, hasTitle: S2 }), n.closeCustomSortPanel();
  }, [t, n, u]), je = (0, import_react.useCallback)(() => {
    n.closeCustomSortPanel();
  }, [n]), Be = (0, import_react.useCallback)((d) => {
    s(d), d ? n.setSelection(_, v, { ...u, startRow: u.startRow + 1 }) : n.setSelection(_, v, u);
  }, [n, u, v, _]);
  (0, import_react.useEffect)(() => {
    l.current && m3.length > 5 && (l.current.scrollTop = l.current.scrollHeight);
  }, [m3]);
  const Fe = m3.length < E2.length, Ce = m3.map((d) => ({ ...d, id: `${d.colIndex}` }));
  return (0, import_jsx_runtime.jsxs)("div", { children: [
    (0, import_jsx_runtime.jsxs)("div", { onMouseDown: (d) => {
      d.stopPropagation();
    }, children: [
      (0, import_jsx_runtime.jsxs)("div", { className: "univer-flex univer-items-center univer-justify-between", children: [
        (0, import_jsx_runtime.jsx)(em, { checked: o, onChange: (d) => Be(!!d), children: r.t("sheets-sort.dialog.first-row-check") }),
        Fe ? (0, import_jsx_runtime.jsxs)(
          "div",
          {
            className: "univer-flex univer-cursor-pointer univer-select-none univer-items-center univer-text-base",
            onClick: h,
            children: [
              (0, import_jsx_runtime.jsx)(K, {}),
              (0, import_jsx_runtime.jsx)("span", { className: "univer-ml-1.5", children: r.t("sheets-sort.dialog.add-condition") })
            ]
          }
        ) : (0, import_jsx_runtime.jsxs)(
          "div",
          {
            className: "univer-flex univer-cursor-pointer univer-select-none univer-items-center univer-text-base univer-text-primary-500 disabled:univer-cursor-not-allowed disabled:univer-divide-opacity-30 disabled:univer-text-gray-800",
            children: [
              (0, import_jsx_runtime.jsx)(K, {}),
              (0, import_jsx_runtime.jsx)("span", { className: "univer-ml-1.5 univer-text-xs", children: r.t("sheets-sort.dialog.add-condition") })
            ]
          }
        )
      ] }),
      (0, import_jsx_runtime.jsx)(
        "div",
        {
          ref: l,
          className: ie("univer-max-h-[310px] univer-overflow-y-auto univer-overflow-x-hidden", pr),
          onScroll: (d) => {
            const S2 = d.currentTarget.scrollTop;
            a(S2);
          },
          children: (0, import_jsx_runtime.jsx)(
            hE,
            {
              className: "[&_.react-grid-item]:univer-transition-none [&_.react-grid-placeholder]:univer-rounded [&_.react-grid-placeholder]:!univer-bg-gray-200",
              list: Ce,
              onListChange: A,
              idKey: "id",
              draggableHandle: "[data-u-comp=sort-panel-item-handler]",
              itemRender: (d) => (0, import_jsx_runtime.jsx)(
                qt,
                {
                  titles: E2,
                  list: Ce,
                  item: d,
                  onChange: (S2, U) => j2(U, S2),
                  scrollPosition: i
                }
              ),
              rowHeight: 32,
              margin: [0, 12]
            }
          )
        }
      )
    ] }),
    (0, import_jsx_runtime.jsxs)("div", { className: "univer-mt-5 univer-flex univer-justify-end", children: [
      (0, import_jsx_runtime.jsx)(
        vr2,
        {
          className: "univer-ml-3",
          onClick: () => je(),
          children: r.t("sheets-sort.dialog.cancel")
        }
      ),
      (0, import_jsx_runtime.jsx)(
        vr2,
        {
          className: "univer-ml-3",
          variant: "primary",
          onClick: () => z2(m3, o),
          children: r.t("sheets-sort.dialog.confirm")
        }
      )
    ] })
  ] });
}
function qt(e) {
  var j2;
  const { list: t, item: r, titles: n, onChange: o, scrollPosition: s } = e, i = useDependency(Fn), a = n.filter((h) => !t.some((z2) => z2.colIndex === h.index) || h.index === r.colIndex), l = t.findIndex((h) => h.colIndex === r.colIndex), u = (0, import_react.useCallback)((h) => {
    o({ ...r, colIndex: h.index }, l), v(false);
  }, [l, r, o]), [_, v] = (0, import_react.useState)(false), E2 = (h) => {
    v(h);
  };
  (0, import_react.useEffect)(() => {
    v(false);
  }, [s]);
  const m3 = t.length > 1, A = (j2 = n.find((h) => h.index === r.colIndex)) == null ? void 0 : j2.label;
  return (0, import_jsx_runtime.jsxs)("div", { className: "univer-grid univer-grid-flow-col univer-grid-cols-2 univer-items-center univer-gap-2", children: [
    (0, import_jsx_runtime.jsxs)("div", { className: "univer-flex univer-items-center", children: [
      (0, import_jsx_runtime.jsx)(
        "div",
        {
          "data-u-comp": "sort-panel-item-handler",
          className: "univer-flex univer-cursor-pointer univer-items-center univer-justify-center univer-text-base univer-text-gray-700",
          children: (0, import_jsx_runtime.jsx)(He, {})
        }
      ),
      (0, import_jsx_runtime.jsx)(
        vf,
        {
          overlay: (0, import_jsx_runtime.jsx)(
            "ul",
            {
              className: ie("univer-my-0 univer-box-border univer-grid univer-max-h-[310px] univer-w-[var(--radix-popper-anchor-width)] univer-items-center univer-gap-1 univer-overflow-y-auto univer-overflow-x-hidden univer-rounded-lg univer-border univer-bg-white univer-p-1 univer-text-base univer-shadow-lg", pr),
              children: a.map((h) => (0, import_jsx_runtime.jsxs)(
                "li",
                {
                  onClick: () => u(h),
                  className: "univer-relative univer-box-border univer-flex univer-h-7 univer-cursor-pointer univer-list-none univer-items-center univer-justify-between univer-rounded univer-px-2 univer-text-sm univer-transition-all hover:univer-bg-gray-100 dark:hover:!univer-bg-gray-700",
                  children: [
                    (0, import_jsx_runtime.jsx)("span", { className: "univer-max-w-[220px] univer-truncate", children: h.label }),
                    (0, import_jsx_runtime.jsx)("span", { children: h.index === r.colIndex && (0, import_jsx_runtime.jsx)(Oe, {}) })
                  ]
                },
                h.index
              ))
            }
          ),
          open: _,
          onOpenChange: E2,
          children: (0, import_jsx_runtime.jsxs)(
            "div",
            {
              className: ie("univer-ml-2 univer-flex univer-w-full univer-items-center univer-justify-between univer-overflow-hidden univer-rounded-md univer-py-1.5 univer-text-sm univer-text-gray-900 dark:!univer-text-white"),
              children: [
                (0, import_jsx_runtime.jsx)(
                  "span",
                  {
                    className: "univer-max-w-[220px] univer-truncate",
                    children: A
                  }
                ),
                (0, import_jsx_runtime.jsx)($e, {})
              ]
            }
          )
        }
      )
    ] }),
    (0, import_jsx_runtime.jsxs)("div", { className: "univer-flex univer-items-center univer-justify-end univer-gap-2", children: [
      (0, import_jsx_runtime.jsxs)(
        kE,
        {
          value: r.type,
          onChange: (h) => {
            o({ ...r, type: h }, l);
          },
          children: [
            (0, import_jsx_runtime.jsx)(TE, { value: m.ASC, children: i.t("sheets-sort.general.sort-asc") }),
            (0, import_jsx_runtime.jsx)(TE, { value: m.DESC, children: i.t("sheets-sort.general.sort-desc") })
          ]
        }
      ),
      (0, import_jsx_runtime.jsx)(
        "a",
        {
          className: "univer-flex univer-cursor-pointer univer-items-center univer-text-sm univer-transition-colors hover:univer-text-red-500",
          onClick: () => o(null, l),
          children: !m3 && (0, import_jsx_runtime.jsx)(Le2, {})
        }
      )
    ] })
  ] });
}
function zt(e, t) {
  const { startColumn: r, endColumn: n } = e, o = new Set(t.map((s) => s == null ? void 0 : s.colIndex));
  for (let s = r; s <= n; s++)
    if (!o.has(s))
      return s;
  return null;
}
function Yt(e) {
  const { range: t, colIndex: r, onClose: n } = e, o = useDependency(C2), s = useDependency(vr), i = useDependency(Fn), a = (0, import_react.useCallback)((l) => {
    const { unitId: u, subUnitId: _ } = P(s) || {};
    if (t && u && _) {
      const v = { ...t, startRow: t.startRow + 1 };
      o.triggerSortDirectly(l, false, { unitId: u, subUnitId: _, range: v, colIndex: r });
    } else
      throw new Error(`Cannot find the target to sort. unitId: ${u}, subUnitId: ${_}, range: ${t}, colIndex: ${r}`);
    n();
  }, [t, r, o, s, n]);
  return (0, import_jsx_runtime.jsxs)(XS, { className: "univer-mb-3 univer-w-full univer-grid-cols-2", children: [
    (0, import_jsx_runtime.jsxs)(vr2, { onClick: () => a(true), children: [
      (0, import_jsx_runtime.jsx)(ae, {}),
      i.t("sheets-sort.general.sort-asc")
    ] }),
    (0, import_jsx_runtime.jsxs)(vr2, { onClick: () => a(false), children: [
      (0, import_jsx_runtime.jsx)(le, {}),
      i.t("sheets-sort.general.sort-desc")
    ] })
  ] });
}
var Ae = "sheet.menu.sheets-sort";
var Ue = "sheet.menu.sheets-sort-ctx";
var Z = "AscendingIcon";
var de = "ExpandAscendingIcon";
var ue = "DescendingIcon";
var he2 = "ExpandDescendingIcon";
var ge2 = "CustomSortIcon";
function Xt(e) {
  return {
    id: Ae,
    type: H1.SUBITEMS,
    icon: Z,
    tooltip: "sheets-sort.general.sort",
    hidden$: Bi(e, we.UNIVER_SHEET),
    disabled$: he(e, { workbookTypes: [Pe], worksheetTypes: [br, Ve2], rangeTypes: [Le] })
  };
}
function Kt(e) {
  return {
    id: J2.id,
    icon: Z,
    title: "sheets-sort.general.sort-asc-cur",
    type: H1.BUTTON,
    hidden$: ob(e)
  };
}
function Jt(e) {
  return {
    id: Q.id,
    title: "sheets-sort.general.sort-asc-ext",
    icon: de,
    type: H1.BUTTON
  };
}
function Qt(e) {
  return {
    id: ee.id,
    title: "sheets-sort.general.sort-desc-cur",
    icon: ue,
    type: H1.BUTTON
  };
}
function er(e) {
  return {
    id: te.id,
    title: "sheets-sort.general.sort-desc-ext",
    icon: he2,
    type: H1.BUTTON
  };
}
function tr(e) {
  return {
    id: re.id,
    title: "sheets-sort.general.sort-custom",
    type: H1.BUTTON,
    icon: ge2
  };
}
function rr(e) {
  return {
    id: Ue,
    title: "sheets-sort.general.sort",
    type: H1.SUBITEMS,
    icon: Z,
    hidden$: Bi(e, we.UNIVER_SHEET),
    disabled$: he(e, {
      workbookTypes: [Pe],
      worksheetTypes: [br, Ve2],
      rangeTypes: [Le]
    })
  };
}
function nr(e) {
  return {
    id: ne.id,
    title: "sheets-sort.general.sort-asc-cur",
    type: H1.BUTTON,
    icon: Z,
    disabled$: he(e, { workbookTypes: [Pe], worksheetTypes: [br, Ve2], rangeTypes: [Le] })
  };
}
function or(e) {
  return {
    id: oe.id,
    title: "sheets-sort.general.sort-asc-ext",
    type: H1.BUTTON,
    icon: de,
    disabled$: he(e, { workbookTypes: [Pe], worksheetTypes: [br, Ve2], rangeTypes: [Le] })
  };
}
function sr(e) {
  return {
    id: se.id,
    title: "sheets-sort.general.sort-desc-cur",
    type: H1.BUTTON,
    icon: ue,
    disabled$: he(e, { workbookTypes: [Pe], worksheetTypes: [br, Ve2], rangeTypes: [Le] })
  };
}
function ir2(e) {
  return {
    id: ie3.id,
    title: "sheets-sort.general.sort-desc-ext",
    type: H1.BUTTON,
    icon: he2,
    disabled$: he(e, { workbookTypes: [Pe], worksheetTypes: [br, Ve2], rangeTypes: [Le] })
  };
}
function cr(e) {
  return {
    id: ce.id,
    title: "sheets-sort.general.sort-custom",
    type: H1.BUTTON,
    icon: ge2,
    disabled$: he(e, { workbookTypes: [Pe], worksheetTypes: [br, Ve2], rangeTypes: [Le] })
  };
}
var ar = {
  [fe.ORGANIZATION]: {
    [Ae]: {
      order: 3,
      menuItemFactory: Xt,
      [J2.id]: {
        order: 0,
        menuItemFactory: Kt
      },
      [Q.id]: {
        order: 1,
        menuItemFactory: Jt
      },
      [ee.id]: {
        order: 2,
        menuItemFactory: Qt
      },
      [te.id]: {
        order: 3,
        menuItemFactory: er
      },
      [re.id]: {
        order: 4,
        menuItemFactory: tr
      }
    }
  },
  [Y1.MAIN_AREA]: {
    [a1.DATA]: {
      [Ue]: {
        order: 0,
        menuItemFactory: rr,
        [ne.id]: {
          order: 0,
          menuItemFactory: nr
        },
        [oe.id]: {
          order: 1,
          menuItemFactory: or
        },
        [se.id]: {
          order: 2,
          menuItemFactory: sr
        },
        [ie3.id]: {
          order: 3,
          menuItemFactory: ir2
        },
        [ce.id]: {
          order: 4,
          menuItemFactory: cr
        }
      }
    }
  }
};
var lr = Object.getOwnPropertyDescriptor;
var dr = (e, t, r, n) => {
  for (var o = n > 1 ? void 0 : n ? lr(t, r) : t, s = e.length - 1, i; s >= 0; s--)
    (i = e[s]) && (o = i(o) || o);
  return o;
};
var y = (e, t) => (r, n) => t(r, n, e);
var Se = "custom-sort-dialog";
var Pe2 = 560;
var ur = 128;
var G = class extends h1 {
  constructor(e, t, r, n, o, s, i, a, l, u) {
    super(), this._commandService = e, this._menuManagerService = t, this._dialogService = r, this._layoutService = n, this._uiPartsService = o, this._sheetRenderService = s, this._localeService = i, this._sheetsSortUIService = a, this._injector = l, this._componentManager = u, this._initCommands(), this._initMenu(), this._initUI();
  }
  _initMenu() {
    this._menuManagerService.mergeMenu(ar);
  }
  _initCommands() {
    [
      J2,
      Q,
      ee,
      te,
      re,
      ne,
      oe,
      se,
      ie3,
      ce
    ].forEach((e) => this.disposeWithMe(this._commandService.registerCommand(e))), this.disposeWithMe(this._sheetRenderService.registerSkeletonChangingMutations(M.id));
  }
  _initUI() {
    this.disposeWithMe(
      this._uiPartsService.registerComponent(Wm.FILTER_PANEL_EMBED_POINT, () => connectInjector(Yt, this._injector))
    ), [
      ["CustomSortPanel", Gt],
      [Z, ae],
      [de, ke],
      [ue, le],
      [he2, De],
      [ge2, Ne]
    ].forEach(([e, t]) => {
      this.disposeWithMe(
        this._componentManager.register(e, t)
      );
    }), this._sheetsSortUIService.customSortState$.pipe(takeUntil(this.dispose$)).subscribe((e) => {
      e && e.show && e.location ? this._openCustomSortPanel(e.location) : e && !(e != null && e.show) && this._closePanel();
    });
  }
  _openCustomSortPanel(e) {
    this._dialogService.open({
      id: Se,
      draggable: true,
      width: Pe2,
      title: { title: `${this._localeService.t("sheets-sort.general.sort-custom")}: ${Ft(e.range)}` },
      children: { label: "CustomSortPanel" },
      destroyOnClose: true,
      defaultPosition: hr(),
      preservePositionOnDestroy: false,
      onClose: () => this._closePanel(),
      mask: true
    });
  }
  _closePanel() {
    this._dialogService.close(Se), queueMicrotask(() => this._layoutService.focus());
  }
};
G = dr([
  y(0, Ls),
  y(1, B1),
  y(2, ct),
  y(3, U1),
  y(4, D1),
  y(5, Inject(ir)),
  y(6, Inject(Fn)),
  y(7, Inject(C2)),
  y(8, Inject(Injector)),
  y(9, Inject(S1))
], G);
function hr() {
  return { x: (window.innerWidth - Pe2) / 2, y: ur };
}
var gr = Object.defineProperty;
var Cr = Object.getOwnPropertyDescriptor;
var mr = (e, t, r) => t in e ? gr(e, t, { enumerable: true, configurable: true, writable: true, value: r }) : e[t] = r;
var vr3 = (e, t, r, n) => {
  for (var o = n > 1 ? void 0 : n ? Cr(t, r) : t, s = e.length - 1, i; s >= 0; s--)
    (i = e[s]) && (o = i(o) || o);
  return o;
};
var pe = (e, t) => (r, n) => t(r, n, e);
var Ze = (e, t, r) => mr(e, typeof t != "symbol" ? t + "" : t, r);
var fr = "SHEET_SORT_UI_PLUGIN";
var W = class extends Ol {
  constructor(e = fe2, t, r) {
    super(), this._config = e, this._injector = t, this._configService = r;
    const { ...n } = oo(
      {},
      fe2,
      this._config
    );
    this._configService.setConfig(Nt, n);
  }
  onStarting() {
    [
      [C2],
      [G]
    ].forEach((e) => this._injector.add(e));
  }
  onRendered() {
    this._injector.get(G);
  }
};
Ze(W, "type", we.UNIVER_SHEET);
Ze(W, "pluginName", fr);
W = vr3([
  qR(C),
  pe(1, Inject(Injector)),
  pe(2, ic)
], W);

// node_modules/@univerjs/sheets-sort/lib/es/facade.js
var E = class extends k {
  sort(o) {
    const e = this._range.startColumn, r = (Array.isArray(o) ? o : [o]).map((n) => typeof n == "number" ? { colIndex: n + e, type: m.ASC } : {
      colIndex: n.column + e,
      type: n.ascending ? m.ASC : m.DESC
    });
    return this._commandService.syncExecuteCommand(M.id, {
      orderRules: r,
      range: this._range,
      hasTitle: false,
      unitId: this._workbook.getUnitId(),
      subUnitId: this._worksheet.getSheetId()
    }), this;
  }
};
k.extend(E);
var w2 = class extends S {
  sort(o, e = true) {
    const t = [{
      colIndex: o,
      type: e ? m.ASC : m.DESC
    }], r = {
      startRow: 0,
      startColumn: 0,
      endRow: this._worksheet.getRowCount() - 1,
      endColumn: this._worksheet.getColumnCount() - 1,
      rangeType: ge.ALL
    };
    return this._commandService.syncExecuteCommand(M.id, {
      orderRules: t,
      range: r,
      hasTitle: false,
      unitId: this._workbook.getUnitId(),
      subUnitId: this._worksheet.getSheetId()
    }), this;
  }
};
S.extend(w2);
var p2 = class {
  get SheetRangeSorted() {
    return "SheetRangeSorted";
  }
  get SheetBeforeRangeSort() {
    return "SheetBeforeRangeSort";
  }
};
j.extend(xn);
var x2 = class extends I {
  /**
   * @ignore
   */
  _initialize(o) {
    const e = o.get(Ls);
    this.registerEventHandler(
      this.Event.SheetBeforeRangeSort,
      () => e.beforeCommandExecuted((t) => {
        t.id === M.id && this._beforeRangeSort(t);
      })
    ), this.registerEventHandler(
      this.Event.SheetRangeSorted,
      () => e.onCommandExecuted((t) => {
        t.id === M.id && this._onRangeSorted(t);
      })
    );
  }
  _beforeRangeSort(o) {
    const e = o.params, t = this.getUniverSheet(e.unitId), r = t.getSheetBySheetId(e.subUnitId), { startColumn: n, endColumn: g3, startRow: a, endRow: S2 } = e.range, c2 = r.getRange(a, n, S2 - a + 1, g3 - n + 1), i = {
      workbook: t,
      worksheet: r,
      range: c2,
      sortColumn: e.orderRules.map((d) => ({
        column: d.colIndex - n,
        ascending: d.type === m.ASC
      }))
    };
    if (this.fireEvent(this.Event.SheetBeforeRangeSort, i), i.cancel)
      throw new Error("SortRangeCommand canceled.");
  }
  _onRangeSorted(o) {
    const e = o.params, t = this.getUniverSheet(e.unitId), r = t.getSheetBySheetId(e.subUnitId), { startColumn: n, endColumn: g3, startRow: a, endRow: S2 } = e.range, c2 = r.getRange(a, n, S2 - a + 1, g3 - n + 1), i = {
      workbook: t,
      worksheet: r,
      range: c2,
      sortColumn: e.orderRules.map((d) => ({
        column: d.colIndex - n,
        ascending: d.type === m.ASC
      }))
    };
    if (this.fireEvent(this.Event.SheetRangeSorted, i), i.cancel)
      throw new Error("SortRangeCommand canceled.");
  }
};
I.extend(x2);
j.extend(p2);

// node_modules/@univerjs/preset-sheets-sort/lib/es/index.js
function m2() {
  return {
    plugins: [
      C,
      W
    ].filter((r) => !!r)
  };
}
export {
  g as SheetsSortService,
  J2 as SortRangeAscCommand,
  Q as SortRangeAscExtCommand,
  oe as SortRangeAscExtInCtxMenuCommand,
  ne as SortRangeAscInCtxMenuCommand,
  M as SortRangeCommand,
  re as SortRangeCustomCommand,
  ce as SortRangeCustomInCtxMenuCommand,
  ee as SortRangeDescCommand,
  te as SortRangeDescExtCommand,
  ie3 as SortRangeDescExtInCtxMenuCommand,
  se as SortRangeDescInCtxMenuCommand,
  m as SortType,
  C as UniverSheetsSortPlugin,
  m2 as UniverSheetsSortPreset,
  W as UniverSheetsSortUIPlugin
};
//# sourceMappingURL=@univerjs_presets_preset-sheets-sort.js.map
