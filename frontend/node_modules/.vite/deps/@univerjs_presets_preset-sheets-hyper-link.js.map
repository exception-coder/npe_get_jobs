{
  "version": 3,
  "sources": ["../../@univerjs/sheets-hyper-link/lib/es/facade.js", "../../@univerjs/sheets-hyper-link-ui/lib/es/facade.js", "../../@univerjs/preset-sheets-hyper-link/lib/es/index.js"],
  "sourcesContent": ["import { Inject as L, generateRandomId as f, CustomRangeType as C, DataStreamTreeTokenType as p, ICommandService as b, CanceledError as d } from \"@univerjs/core\";\nimport { SheetsHyperLinkParserService as a, AddHyperLinkCommand as u, UpdateHyperLinkCommand as g, CancelHyperLinkCommand as S } from \"@univerjs/sheets-hyper-link\";\nimport { FWorkbook as v, FWorksheet as w, FRange as _ } from \"@univerjs/sheets/facade\";\nimport { FEventName as x, FUniver as y } from \"@univerjs/core/facade\";\nvar I = Object.getOwnPropertyDescriptor, E = (s, e, i, r) => {\n  for (var n = r > 1 ? void 0 : r ? I(e, i) : e, t = s.length - 1, o; t >= 0; t--)\n    (o = s[t]) && (n = o(n) || n);\n  return n;\n}, H = (s, e) => (i, r) => e(i, r, s);\nlet m = class {\n  constructor(s, e) {\n    this._workbook = s, this._parserService = e;\n  }\n  getRangeUrl(s) {\n    return this._parserService.buildHyperLink(this._workbook.getId(), s.getSheetId(), s.getRange()), this;\n  }\n};\nm = E([\n  H(1, L(a))\n], m);\nclass U extends v {\n  createSheetHyperlink(e, i) {\n    return this._injector.get(a).buildHyperLink(this.getId(), e, i);\n  }\n  /**\n   * Parse the hyperlink string to get the hyperlink info.\n   * @param {string} hyperlink the hyperlink string\n   * @returns {ISheetHyperLinkInfo} the hyperlink info\n   */\n  parseSheetHyperlink(e) {\n    return this._injector.get(a).parseHyperLink(e);\n  }\n}\nv.extend(U);\nclass R extends w {\n  getUrl() {\n    return this._injector.get(a).buildHyperLink(this._workbook.getUnitId(), this._worksheet.getSheetId());\n  }\n}\nw.extend(R);\nclass T extends _ {\n  // #region hyperlink\n  setHyperLink(e, i) {\n    const r = {\n      unitId: this.getUnitId(),\n      subUnitId: this._worksheet.getSheetId(),\n      link: {\n        row: this._range.startRow,\n        column: this._range.startColumn,\n        payload: e,\n        display: i,\n        id: f()\n      }\n    };\n    return this._commandService.executeCommand(u.id, r);\n  }\n  getHyperLinks() {\n    var i, r, n;\n    const e = this._worksheet.getCellRaw(this._range.startRow, this._range.startColumn);\n    return e != null && e.p ? (n = (r = (i = e.p.body) == null ? void 0 : i.customRanges) == null ? void 0 : r.filter((t) => t.rangeType === C.HYPERLINK).map((t) => {\n      var o, h, c, l, k;\n      return {\n        id: `${t.rangeId}`,\n        startIndex: t.startIndex,\n        endIndex: t.endIndex,\n        url: (h = (o = t.properties) == null ? void 0 : o.url) != null ? h : \"\",\n        label: (k = (l = (c = e.p) == null ? void 0 : c.body) == null ? void 0 : l.dataStream.slice(t.startIndex, t.endIndex + 1).replaceAll(p.CUSTOM_RANGE_START, \"\").replaceAll(p.CUSTOM_RANGE_END, \"\")) != null ? k : \"\"\n      };\n    })) != null ? n : [] : [];\n  }\n  updateHyperLink(e, i, r) {\n    const n = {\n      unitId: this.getUnitId(),\n      subUnitId: this._worksheet.getSheetId(),\n      row: this._range.startRow,\n      column: this._range.startColumn,\n      id: e,\n      payload: {\n        payload: i,\n        display: r\n      }\n    };\n    return this._commandService.executeCommand(g.id, n);\n  }\n  cancelHyperLink(e) {\n    const i = {\n      unitId: this.getUnitId(),\n      subUnitId: this._worksheet.getSheetId(),\n      row: this._range.startRow,\n      column: this._range.startColumn,\n      id: e\n    };\n    return this._commandService.syncExecuteCommand(S.id, i);\n  }\n  getUrl() {\n    return this._injector.get(a).buildHyperLink(this.getUnitId(), this.getSheetId(), this.getRange());\n  }\n  // #endregion\n}\n_.extend(T);\nclass B {\n  get BeforeSheetLinkAdd() {\n    return \"BeforeSheetLinkAdd\";\n  }\n  get BeforeSheetLinkCancel() {\n    return \"BeforeSheetLinkCancel\";\n  }\n  get BeforeSheetLinkUpdate() {\n    return \"BeforeSheetLinkUpdate\";\n  }\n}\nx.extend(B);\nclass A extends y {\n  /**\n   * @ignore\n   */\n  _initialize(e) {\n    const i = e.get(b);\n    this.registerEventHandler(\n      this.Event.BeforeSheetLinkAdd,\n      () => i.beforeCommandExecuted((r) => {\n        if (r.id !== u.id) return;\n        const n = this.getCommandSheetTarget(r);\n        if (!n) return;\n        const t = r.params, o = {\n          workbook: n.workbook,\n          worksheet: n.worksheet,\n          row: t.link.row,\n          col: t.link.column,\n          link: t.link\n        };\n        if (this.fireEvent(this.Event.BeforeSheetLinkAdd, o), o.cancel)\n          throw new d();\n      })\n    ), this.registerEventHandler(\n      this.Event.BeforeSheetLinkUpdate,\n      () => i.beforeCommandExecuted((r) => {\n        if (r.id !== g.id) return;\n        const n = this.getCommandSheetTarget(r);\n        if (!n) return;\n        const t = r.params, o = {\n          workbook: n.workbook,\n          worksheet: n.worksheet,\n          row: t.row,\n          column: t.column,\n          id: t.id,\n          payload: t.payload\n        };\n        if (this.fireEvent(this.Event.BeforeSheetLinkUpdate, o), o.cancel)\n          throw new d();\n      })\n    ), this.registerEventHandler(\n      this.Event.BeforeSheetLinkCancel,\n      () => i.beforeCommandExecuted((r) => {\n        if (r.id !== S.id) return;\n        const n = this.getCommandSheetTarget(r);\n        if (!n) return;\n        const t = r.params, o = {\n          workbook: n.workbook,\n          worksheet: n.worksheet,\n          row: t.row,\n          column: t.column,\n          id: t.id\n        };\n        if (this.fireEvent(this.Event.BeforeSheetLinkCancel, o), o.cancel)\n          throw new d();\n      })\n    );\n  }\n}\ny.extend(A);\nexport {\n  U as FWorkbookHyperLinkMixin\n};\n", "import { SheetsHyperLinkParserService as t } from \"@univerjs/sheets-hyper-link\";\nimport { SheetsHyperLinkResolverService as n } from \"@univerjs/sheets-hyper-link-ui\";\nimport { FWorkbookHyperLinkMixin as s } from \"@univerjs/sheets-hyper-link/facade\";\nimport { FWorkbook as k } from \"@univerjs/sheets/facade\";\nclass p extends s {\n  // TODO: this should be migrated back to hyperlink ui plugin\n  navigateToSheetHyperlink(e) {\n    const r = this._injector.get(t), o = this._injector.get(n), i = r.parseHyperLink(e);\n    o.navigate(i);\n  }\n}\nk.extend(p);\n", "import { UniverSheetsHyperLinkPlugin as t } from \"@univerjs/sheets-hyper-link\";\nexport * from \"@univerjs/sheets-hyper-link\";\nimport { UniverSheetsHyperLinkUIPlugin as n } from \"@univerjs/sheets-hyper-link-ui\";\nexport * from \"@univerjs/sheets-hyper-link-ui\";\nimport \"@univerjs/sheets-hyper-link/lib/facade\";\nimport \"@univerjs/sheets-hyper-link-ui/lib/facade\";\nfunction l(r = {}) {\n  const { urlHandler: e } = r;\n  return {\n    plugins: [\n      t,\n      [n, {\n        urlHandler: e\n      }]\n    ].filter((i) => !!i)\n  };\n}\nexport {\n  l as UniverSheetsHyperLinkPreset\n};\n"],
  "mappings": "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",
  "names": ["I", "E", "R", "l", "k"]
}
