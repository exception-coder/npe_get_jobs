// @univerjs-pro/collaboration-client/index
(function(_0x551f44,_0x54f785){var _0x236572=_0x4ecd,_0x4040e3=_0x551f44();while(!![]){try{var _0x4704ba=-parseInt(_0x236572(0x1f1))/0x1*(parseInt(_0x236572(0x4c9))/0x2)+parseInt(_0x236572(0x231))/0x3*(parseInt(_0x236572(0x36d))/0x4)+parseInt(_0x236572(0x400))/0x5+-parseInt(_0x236572(0x1f4))/0x6+-parseInt(_0x236572(0x30f))/0x7*(parseInt(_0x236572(0x2a1))/0x8)+-parseInt(_0x236572(0x201))/0x9*(parseInt(_0x236572(0x3e3))/0xa)+parseInt(_0x236572(0x448))/0xb;if(_0x4704ba===_0x54f785)break;else _0x4040e3['push'](_0x4040e3['shift']());}catch(_0x1e47a8){_0x4040e3['push'](_0x4040e3['shift']());}}}(_0x1677,0xb9835),function(_0xabeee6,_0x462c5e){var _0x211fd0=_0x4ecd;typeof exports==_0x211fd0(0x394)&&typeof module<'u'?_0x462c5e(exports,require('@univerjs-pro/collaboration'),require('@univerjs/core'),require('@univerjs/docs'),require('@univerjs/sheets'),require('rxjs'),require('@univerjs/telemetry'),require('rxjs/operators'),require('@univerjs/network'),require('@univerjs/drawing'),require('@univerjs-pro/license')):typeof define==_0x211fd0(0x29c)&&define[_0x211fd0(0x35f)]?define([_0x211fd0(0x523),_0x211fd0(0x24b),'@univerjs/core',_0x211fd0(0x25d),_0x211fd0(0x20a),_0x211fd0(0x53d),'@univerjs/telemetry','rxjs/operators','@univerjs/network',_0x211fd0(0x45a),_0x211fd0(0x4df)],_0x462c5e):(_0xabeee6=typeof globalThis<'u'?globalThis:_0xabeee6||self,_0x462c5e(_0xabeee6[_0x211fd0(0x3c8)]={},_0xabeee6[_0x211fd0(0x296)],_0xabeee6[_0x211fd0(0x258)],_0xabeee6[_0x211fd0(0x447)],_0xabeee6[_0x211fd0(0x26e)],_0xabeee6[_0x211fd0(0x53d)],_0xabeee6['UniverTelemetry'],_0xabeee6[_0x211fd0(0x53d)][_0x211fd0(0x3dd)],_0xabeee6['UniverNetwork'],_0xabeee6[_0x211fd0(0x3ea)],_0xabeee6[_0x211fd0(0x46a)]));}(this,function(_0x36d18b,_0x5a7fdc,_0x29a664,_0x438bd6,_0x1ce604,_0x32c204,_0x2d504f,_0x12f47e,_0x200e90,_0x2b4a05,_0x480ca8){'use strict';var _0x997d7=_0x4ecd;var _0x48c8dc=Object[_0x997d7(0x1ed)],_0x50b038=(_0x3e70d3,_0x543dd7,_0x1735a0)=>_0x543dd7 in _0x3e70d3?_0x48c8dc(_0x3e70d3,_0x543dd7,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0x1735a0}):_0x3e70d3[_0x543dd7]=_0x1735a0,_0x260f1e=(_0x3459e2,_0x4b40fc,_0x4f86f7)=>_0x50b038(_0x3459e2,typeof _0x4b40fc!=_0x997d7(0x2d5)?_0x4b40fc+'':_0x4b40fc,_0x4f86f7);const _0xe80868=_0x997d7(0x2b9),_0x4a7c93=_0x997d7(0x2a6),_0x53efe6=_0x997d7(0x246),_0x4aaab9=_0x997d7(0x3ef),_0x2b6987='HEARTBEAT_INTERVAL',_0x315b2c=_0x997d7(0x252),_0x547549='RETRY_CONNECTING_MAX_COUNT',_0xc708f2=_0x997d7(0x3a8),_0x4afe1a=_0x997d7(0x449),_0x278fe0=_0x997d7(0x22e),_0x48a22d=_0x997d7(0x41f),_0x77defc=_0x997d7(0x362);var _0x4015c2=(_0x1d314e=>(_0x1d314e[_0x1d314e[_0x997d7(0x1fa)]=0x0]=_0x997d7(0x1fa),_0x1d314e[_0x1d314e['OK']=0x1]='OK',_0x1d314e[_0x1d314e[_0x997d7(0x2bc)]=0x2]=_0x997d7(0x2bc),_0x1d314e[_0x1d314e[_0x997d7(0x2ad)]=0x3]='PERMISSION_DENIED',_0x1d314e[_0x1d314e[_0x997d7(0x247)]=0x4]=_0x997d7(0x247),_0x1d314e[_0x1d314e[_0x997d7(0x3af)]=0x5]='UNAUTHENTICATED',_0x1d314e[_0x1d314e[_0x997d7(0x557)]=0x6]=_0x997d7(0x557),_0x1d314e[_0x1d314e[_0x997d7(0x51c)]=0x7]=_0x997d7(0x51c),_0x1d314e[_0x1d314e[_0x997d7(0x4d7)]=0x8]='TOO_MANY_REQUESTS',_0x1d314e[_0x1d314e[_0x997d7(0x505)]=0x9]=_0x997d7(0x505),_0x1d314e[_0x1d314e[_0x997d7(0x2b6)]=0xa]=_0x997d7(0x2b6),_0x1d314e[_0x1d314e['MOBILE_VERIFY_CODE_MISMATCH']=0xb]=_0x997d7(0x43e),_0x1d314e[_0x1d314e['MOBILE_VERIFY_CODE_NOT_FOUND_OR_EXPIRED']=0xc]='MOBILE_VERIFY_CODE_NOT_FOUND_OR_EXPIRED',_0x1d314e[_0x1d314e[_0x997d7(0x437)]=0xd]=_0x997d7(0x437),_0x1d314e[_0x1d314e['EMAIL_VERIFY_CODE_NOT_FOUND_OR_EXPIRED']=0xe]=_0x997d7(0x53b),_0x1d314e[_0x1d314e['AUTHORIZE_CODE_ILLEGAL']=0xf]=_0x997d7(0x4bd),_0x1d314e[_0x1d314e[_0x997d7(0x24e)]=0x10]=_0x997d7(0x24e),_0x1d314e[_0x1d314e[_0x997d7(0x579)]=0x64]='CURRENT_STATUS_CANNOT_OPERATE',_0x1d314e[_0x1d314e[_0x997d7(0x31f)]=0x65]='ERROR_AGAIN',_0x1d314e[_0x1d314e[_0x997d7(0x1f8)]=0xc9]=_0x997d7(0x1f8),_0x1d314e[_0x1d314e[_0x997d7(0x240)]=0xca]='USER_IS_ANONYMOUS',_0x1d314e[_0x1d314e[_0x997d7(0x53e)]=0x1389]=_0x997d7(0x53e),_0x1d314e[_0x1d314e[_0x997d7(0x423)]=0x1771]=_0x997d7(0x423),_0x1d314e[_0x1d314e[_0x997d7(0x49b)]=0x1772]=_0x997d7(0x49b),_0x1d314e[_0x1d314e[_0x997d7(0x429)]=0x1773]=_0x997d7(0x429),_0x1d314e[_0x1d314e[_0x997d7(0x248)]=0x1b59]='APPLY_REJECT',_0x1d314e[_0x1d314e[_0x997d7(0x216)]=0x1b5a]=_0x997d7(0x216),_0x1d314e[_0x1d314e['APPLY_REVISION_CONFILICT']=0x1b5b]=_0x997d7(0x52d),_0x1d314e[_0x1d314e['APPLY_PERMISSION_DENIED']=0x1b5c]=_0x997d7(0x308),_0x1d314e[_0x1d314e[_0x997d7(0x559)]=0x1b5d]='APPLY_DUPLICATED',_0x1d314e[_0x1d314e[_0x997d7(0x490)]=0x1f41]='CONNECTOR_DATA_TOO_LARGE',_0x1d314e[_0x1d314e[_0x997d7(0x282)]=0x2329]='LICENSE_MAX_UNITS_EXCEEDED',_0x1d314e[_0x1d314e[_0x997d7(0x329)]=0x232a]=_0x997d7(0x329),_0x1d314e[_0x1d314e[_0x997d7(0x227)]=0x232b]=_0x997d7(0x227),_0x1d314e[_0x1d314e['LICENSE_EXPORT_SIZE_EXCEEDED']=0x232c]=_0x997d7(0x2ea),_0x1d314e[_0x1d314e[_0x997d7(0x1ee)]=0x232d]=_0x997d7(0x1ee),_0x1d314e[_0x1d314e[_0x997d7(0x44d)]=0x2711]='YUUMI_UNABLE_LOAD_URL',_0x1d314e[_0x1d314e[_0x997d7(0x377)]=0x2712]=_0x997d7(0x377),_0x1d314e[_0x1d314e[_0x997d7(0x25a)]=0x2713]='YUUMI_RATE_OVER_LIMIT',_0x1d314e[_0x1d314e[_0x997d7(0x574)]=0x2714]=_0x997d7(0x574),_0x1d314e[_0x1d314e[_0x997d7(0x3fe)]=0x271a]=_0x997d7(0x3fe),_0x1d314e[_0x1d314e[_0x997d7(0x402)]=0x271b]=_0x997d7(0x402),_0x1d314e[_0x1d314e[_0x997d7(0x524)]=0x271c]=_0x997d7(0x524),_0x1d314e[_0x1d314e['YUUMI_ALL_TABLES_IS_INVALID']=0x271d]='YUUMI_ALL_TABLES_IS_INVALID',_0x1d314e[_0x1d314e[_0x997d7(0x2e0)]=0x271e]=_0x997d7(0x2e0),_0x1d314e[_0x1d314e['YUUMI_AI_RUN_FAILED']=0x271f]='YUUMI_AI_RUN_FAILED',_0x1d314e[_0x1d314e[_0x997d7(0x530)]=0x2720]=_0x997d7(0x530),_0x1d314e[_0x1d314e['PY_RUNTIME_SCRIPT_ERROR']=0x2af9]=_0x997d7(0x32b),_0x1d314e[_0x1d314e[_0x997d7(0x36c)]=0x2ee1]='INVITE_CODE_HAS_BEEN_UES',_0x1d314e[_0x1d314e[_0x997d7(0x32e)]=0x2ee2]='INVALID_INVITE_CODE',_0x1d314e[_0x1d314e['INVITE_CODE_REQUIRED']=0x2ee3]=_0x997d7(0x27e),_0x1d314e[_0x1d314e['USER_NOT_INVITED_CODE']=0x2ee4]=_0x997d7(0x22f),_0x1d314e[_0x1d314e[_0x997d7(0x417)]=0x2ee5]='INVITE_CODE_ALREADY_BOUND',_0x1d314e[_0x1d314e['WECHAT_HAS_BEEN_BOUND']=0x32c9]=_0x997d7(0x32c),_0x1d314e[_0x1d314e[_0x997d7(0x504)]=0x32ca]=_0x997d7(0x504),_0x1d314e[_0x1d314e[_0x997d7(0x263)]=0x32cb]=_0x997d7(0x263),_0x1d314e[_0x1d314e['ENTITLE_CAN_NOT_BUY_LOWER_OTP']=0x36b1]='ENTITLE_CAN_NOT_BUY_LOWER_OTP',_0x1d314e[_0x1d314e[_0x997d7(0x2ff)]=0x36b2]=_0x997d7(0x2ff),_0x1d314e[_0x1d314e['ENTITLE_DUP_SUBSCRIPTION']=0x36b3]=_0x997d7(0x48b),_0x1d314e[_0x1d314e[_0x997d7(0x4fb)]=0x36b4]=_0x997d7(0x4fb),_0x1d314e[_0x1d314e[_0x997d7(0x23b)]=0x3715]=_0x997d7(0x23b),_0x1d314e[_0x1d314e[_0x997d7(0x575)]=0x3716]=_0x997d7(0x575),_0x1d314e[_0x1d314e[_0x997d7(0x4ed)]=0x3717]='ENTITLE_INSUFFICIENT_QUOTA',_0x1d314e[_0x1d314e[_0x997d7(0x1ea)]=0x37dd]=_0x997d7(0x1ea),_0x1d314e[_0x1d314e['REDEMPTION_INVALID_CODE']=0x3a99]='REDEMPTION_INVALID_CODE',_0x1d314e[_0x1d314e[_0x997d7(0x373)]=0x3a9a]=_0x997d7(0x373),_0x1d314e[_0x1d314e[_0x997d7(0x549)]=0x3a9b]='REDEMPTION_CODE_FULLY_REDEEMED',_0x1d314e[_0x1d314e[_0x997d7(0x28f)]=0x3a9c]=_0x997d7(0x28f),_0x1d314e[_0x1d314e[_0x997d7(0x3c9)]=0x3a9d]=_0x997d7(0x3c9),_0x1d314e[_0x1d314e[_0x997d7(0x502)]=0x3a9e]='REDEMPTION_USER_REDEEM_TIMES_EXCEED',_0x1d314e[_0x1d314e['REDEMPTION_CODE_HAS_BEEN_CREATED']=0x3a9f]=_0x997d7(0x55c),_0x1d314e[_0x1d314e[_0x997d7(0x48a)]=0x3e81]='DATA_SOURCE_TOO_LARGE',_0x1d314e[_0x1d314e[_0x997d7(0x3ab)]=-0x1]=_0x997d7(0x3ab),_0x1d314e))(_0x4015c2||{}),_0x60f00c=(_0x2e4a00=>(_0x2e4a00[_0x2e4a00[_0x997d7(0x229)]=0x0]=_0x997d7(0x229),_0x2e4a00[_0x2e4a00[_0x997d7(0x47c)]=0x1]='UNIVER_DOC',_0x2e4a00[_0x2e4a00['UNIVER_SHEET']=0x2]=_0x997d7(0x4c5),_0x2e4a00[_0x2e4a00[_0x997d7(0x4e3)]=0x3]=_0x997d7(0x4e3),_0x2e4a00[_0x2e4a00[_0x997d7(0x4ff)]=0x4]=_0x997d7(0x4ff),_0x2e4a00[_0x2e4a00['UNRECOGNIZED']=-0x1]='UNRECOGNIZED',_0x2e4a00))(_0x60f00c||{}),_0x1f168c=(_0x295691=>(_0x295691[_0x295691['UNKNOWN_CMD']=0x0]=_0x997d7(0x225),_0x295691[_0x295691[_0x997d7(0x556)]=0x1]='HELLO',_0x295691[_0x295691[_0x997d7(0x32a)]=0x2]=_0x997d7(0x32a),_0x295691[_0x295691['LEAVE']=0x3]=_0x997d7(0x50c),_0x295691[_0x295691['INGEST']=0x4]=_0x997d7(0x55a),_0x295691[_0x295691[_0x997d7(0x230)]=0x5]='HEARTBEAT',_0x295691[_0x295691[_0x997d7(0x3e6)]=0x6]=_0x997d7(0x3e6),_0x295691[_0x295691[_0x997d7(0x3ab)]=-0x1]=_0x997d7(0x3ab),_0x295691))(_0x1f168c||{}),_0x2eda57=(_0x57a483=>(_0x57a483[_0x57a483[_0x997d7(0x4cf)]=0x0]=_0x997d7(0x4cf),_0x57a483[_0x57a483['OK']=0x1]='OK',_0x57a483[_0x57a483['FAIL']=0x2]='FAIL',_0x57a483[_0x57a483['JOIN_ROOM_FULL']=0x3e9]=_0x997d7(0x497),_0x57a483[_0x57a483['JOIN_ROOM_NOT_EXISTS']=0x3ea]='JOIN_ROOM_NOT_EXISTS',_0x57a483[_0x57a483['JOIN_ROOM_PERMISSION_DENIED']=0x3eb]=_0x997d7(0x54b),_0x57a483[_0x57a483[_0x997d7(0x2ec)]=0x3ec]=_0x997d7(0x2ec),_0x57a483[_0x57a483[_0x997d7(0x3ab)]=-0x1]=_0x997d7(0x3ab),_0x57a483))(_0x2eda57||{}),_0x241a4e=(_0x515295=>(_0x515295[_0x515295[_0x997d7(0x385)]=0x0]=_0x997d7(0x385),_0x515295[_0x515295[_0x997d7(0x416)]=0x1]='HttpImport',_0x515295[_0x515295['HttpExport']=0x2]='HttpExport',_0x515295[_0x515295[_0x997d7(0x4f6)]=0x3]=_0x997d7(0x4f6),_0x515295[_0x515295[_0x997d7(0x4e6)]=0x4]=_0x997d7(0x4e6),_0x515295[_0x515295[_0x997d7(0x472)]=0x5]='UserProfileImg',_0x515295[_0x515295[_0x997d7(0x4c0)]=0x6]=_0x997d7(0x4c0),_0x515295[_0x515295['UNRECOGNIZED']=-0x1]=_0x997d7(0x3ab),_0x515295))(_0x241a4e||{});const _0x5ecfcb='collaboration_new_changeset';function _0x2a03fd(_0x380984){var _0x3200fd=_0x997d7;return JSON['stringify'](_0x380984)[_0x3200fd(0x307)];}var _0xedfb31=(_0x25a9b4=>(_0x25a9b4[_0x997d7(0x477)]=_0x997d7(0x477),_0x25a9b4[_0x997d7(0x2ad)]=_0x997d7(0x2ad),_0x25a9b4[_0x997d7(0x3ce)]=_0x997d7(0x3ce),_0x25a9b4['CLOSE_ROOM']=_0x997d7(0x21a),_0x25a9b4[_0x997d7(0x25b)]=_0x997d7(0x25b),_0x25a9b4[_0x997d7(0x3b7)]=_0x997d7(0x3b7),_0x25a9b4['SOCKET_FAILED']='SOCKET_FAILED',_0x25a9b4[_0x997d7(0x3f3)]='SUBMIT_CHANGESET_TIMEOUT',_0x25a9b4))(_0xedfb31||{});class _0x495958{constructor(){var _0x37a64a=_0x997d7;_0x260f1e(this,_0x37a64a(0x3bf),new _0x32c204[(_0x37a64a(0x41c))]()),_0x260f1e(this,_0x37a64a(0x25c),this['_event$'][_0x37a64a(0x313)]());}[_0x997d7(0x2d4)](_0x254219){var _0x443a2c=_0x997d7;this['_event$'][_0x443a2c(0x476)](_0x254219);}}class _0x3e15b7{constructor(){var _0x49d418=_0x997d7;_0x260f1e(this,_0x49d418(0x44b),new _0x32c204[(_0x49d418(0x41c))]()),_0x260f1e(this,_0x49d418(0x3d8),this[_0x49d418(0x44b)]['asObservable']());}[_0x997d7(0x20e)](_0x22e4f7){var _0x57e0af=_0x997d7;this[_0x57e0af(0x44b)][_0x57e0af(0x476)](_0x22e4f7);}}var _0x364068=Object[_0x997d7(0x539)],_0x148430=(_0x12ba16,_0x1867b8,_0xa1e2c,_0x14605d)=>{for(var _0x374fa7=_0x14605d>0x1?void 0x0:_0x14605d?_0x364068(_0x1867b8,_0xa1e2c):_0x1867b8,_0x1a5ebe=_0x12ba16['length']-0x1,_0x4bae23;_0x1a5ebe>=0x0;_0x1a5ebe--)(_0x4bae23=_0x12ba16[_0x1a5ebe])&&(_0x374fa7=_0x4bae23(_0x374fa7)||_0x374fa7);return _0x374fa7;},_0x3ec42a=(_0x438716,_0x3f7077)=>(_0x1a98cd,_0x37af04)=>_0x3f7077(_0x1a98cd,_0x37af04,_0x438716);_0x36d18b[_0x997d7(0x409)]=class extends _0x29a664[_0x997d7(0x285)]{constructor(_0x357c4e,_0x2a5f4c){var _0x979931=_0x997d7;super(),_0x260f1e(this,'_roomMembers',new Map()),_0x260f1e(this,_0x979931(0x431),new _0x32c204[(_0x979931(0x41c))]()),(this['_univerInstanceService']=_0x357c4e,this[_0x979931(0x4c6)]=_0x2a5f4c,this[_0x979931(0x31b)](_0x32c204[_0x979931(0x2e7)](this['_univerInstanceService']['getTypeOfUnitDisposed$'](_0x29a664['UniverInstanceType'][_0x979931(0x4c5)])[_0x979931(0x2ab)](_0x12f47e[_0x979931(0x2b1)](_0x2daf6b=>_0x2daf6b[_0x979931(0x4ae)]())),this[_0x979931(0x432)][_0x979931(0x525)](_0x29a664[_0x979931(0x319)][_0x979931(0x47c)])[_0x979931(0x2ab)](_0x12f47e['map'](_0x113faa=>_0x113faa[_0x979931(0x4ae)]())),this[_0x979931(0x432)][_0x979931(0x525)](_0x29a664[_0x979931(0x319)][_0x979931(0x4e3)])[_0x979931(0x2ab)](_0x12f47e['map'](_0x5708bf=>_0x5708bf[_0x979931(0x4ae)]())))['subscribe'](_0x2c57dd=>this['_removeRoom'](_0x2c57dd))));}[_0x997d7(0x36b)](_0x33f3d0){var _0x4509ea=_0x997d7;return this[_0x4509ea(0x332)][_0x4509ea(0x572)](_0x33f3d0)?_0x32c204['of'](this[_0x4509ea(0x332)][_0x4509ea(0x47e)](_0x33f3d0)):this[_0x4509ea(0x431)][_0x4509ea(0x2ab)](_0x12f47e[_0x4509ea(0x2b1)](_0xfed236=>{var _0x462086=_0x4509ea;if(_0xfed236===_0x33f3d0)return this[_0x462086(0x332)]['get'](_0xfed236);}));}[_0x997d7(0x546)](_0x352345){var _0x18bf8d=_0x997d7;this[_0x18bf8d(0x4c6)][_0x18bf8d(0x546)](_0x352345);}[_0x997d7(0x420)](){var _0x47a497=_0x997d7;return this[_0x47a497(0x4c6)][_0x47a497(0x420)]();}[_0x997d7(0x486)](_0x594edb,_0xe9c04b){var _0x3d0fd2=_0x997d7;let _0x20e890=this['_roomMembers'][_0x3d0fd2(0x47e)](_0x594edb);_0x20e890||(_0x20e890=new _0xe298f5(),this[_0x3d0fd2(0x332)][_0x3d0fd2(0x41e)](_0x594edb,_0x20e890),this[_0x3d0fd2(0x431)][_0x3d0fd2(0x476)](_0x594edb)),_0x20e890[_0x3d0fd2(0x486)](_0xe9c04b);}[_0x997d7(0x341)](_0x371613,_0x5f44b7){var _0x18e820=_0x997d7;const _0x281f0c=this[_0x18e820(0x332)][_0x18e820(0x47e)](_0x371613);_0x281f0c&&_0x281f0c['removeMember'](_0x5f44b7);}[_0x997d7(0x422)](_0x11f1e1){var _0x36d583=_0x997d7;return this[_0x36d583(0x332)]['get'](_0x11f1e1);}[_0x997d7(0x436)](_0x5f102f,_0x1eccb3){var _0x12a37d=_0x997d7;const _0x1eea97=this[_0x12a37d(0x332)]['get'](_0x5f102f);if(_0x1eea97)return _0x1eea97[_0x12a37d(0x436)](_0x1eccb3);}[_0x997d7(0x2cb)](_0x74a28){var _0x1b7980=_0x997d7;const _0x101519=this[_0x1b7980(0x332)][_0x1b7980(0x47e)](_0x74a28);_0x101519&&(_0x101519['dispose'](),this['_roomMembers'][_0x1b7980(0x375)](_0x74a28));}[_0x997d7(0x206)](){var _0x94c4e9=_0x997d7;this[_0x94c4e9(0x332)][_0x94c4e9(0x2bd)](_0x1f3f2f=>_0x1f3f2f[_0x94c4e9(0x206)]()),this[_0x94c4e9(0x332)][_0x94c4e9(0x2ef)](),this['_roomCreated$'][_0x94c4e9(0x42a)]();}},_0x36d18b[_0x997d7(0x409)]=_0x148430([_0x3ec42a(0x0,_0x29a664[_0x997d7(0x208)]),_0x3ec42a(0x1,_0x29a664[_0x997d7(0x346)](_0x29a664[_0x997d7(0x353)]))],_0x36d18b[_0x997d7(0x409)]);class _0xe298f5 extends _0x29a664[_0x997d7(0x285)]{constructor(){var _0x166009=_0x997d7;super(...arguments),_0x260f1e(this,_0x166009(0x312),new Map()),_0x260f1e(this,_0x166009(0x350),new _0x32c204['BehaviorSubject'](this['_members'])),_0x260f1e(this,'members$',this['_members$'][_0x166009(0x313)]());}['dispose'](){var _0x5e8463=_0x997d7;this[_0x5e8463(0x312)][_0x5e8463(0x2ef)]();}[_0x997d7(0x486)](_0x1e6fbd){var _0x279f76=_0x997d7;this[_0x279f76(0x312)][_0x279f76(0x41e)](_0x1e6fbd[_0x279f76(0x298)],_0x1e6fbd),this[_0x279f76(0x2cd)]();}[_0x997d7(0x341)](_0x259179){var _0x2fa9dc=_0x997d7;this[_0x2fa9dc(0x312)]['delete'](_0x259179);}['getMember'](_0x20a283){var _0x53d29c=_0x997d7;return this[_0x53d29c(0x312)][_0x53d29c(0x47e)](_0x20a283);}['getAllMembers'](){var _0x4e4251=_0x997d7;return Array[_0x4e4251(0x410)](this[_0x4e4251(0x312)][_0x4e4251(0x453)]());}[_0x997d7(0x2cd)](){var _0x43daab=_0x997d7;this[_0x43daab(0x350)][_0x43daab(0x476)](this[_0x43daab(0x312)]);}}var _0x16951b=Object[_0x997d7(0x539)],_0x104870=(_0x1cdc44,_0x340f38,_0x2e882a,_0x34d02b)=>{var _0x7d153e=_0x997d7;for(var _0x4ad0c7=_0x34d02b>0x1?void 0x0:_0x34d02b?_0x16951b(_0x340f38,_0x2e882a):_0x340f38,_0x443e7e=_0x1cdc44[_0x7d153e(0x307)]-0x1,_0x1bab9a;_0x443e7e>=0x0;_0x443e7e--)(_0x1bab9a=_0x1cdc44[_0x443e7e])&&(_0x4ad0c7=_0x1bab9a(_0x4ad0c7)||_0x4ad0c7);return _0x4ad0c7;},_0x2b39f1=(_0x101b66,_0x3d6e41)=>(_0x8347ae,_0x53d1f0)=>_0x3d6e41(_0x8347ae,_0x53d1f0,_0x101b66),_0xbd299=(_0x53eed9=>(_0x53eed9[_0x53eed9['IDLE']=0x0]=_0x997d7(0x33c),_0x53eed9[_0x53eed9[_0x997d7(0x249)]=0x1]=_0x997d7(0x249),_0x53eed9[_0x53eed9['OFFLINE']=0x2]='OFFLINE',_0x53eed9[_0x53eed9[_0x997d7(0x42b)]=0x3]=_0x997d7(0x42b),_0x53eed9))(_0xbd299||{});const _0x43b024={[_0x2eda57['FAIL']]:_0x997d7(0x228),[_0x2eda57['JOIN_ROOM_FULL']]:'session.room-full',[_0x2eda57[_0x997d7(0x21c)]]:_0x997d7(0x42d),[_0x2eda57[_0x997d7(0x54b)]]:'session.room-permission-denied',[_0x2eda57[_0x997d7(0x2ec)]]:_0x997d7(0x358)};_0x36d18b['CollaborationSession']=class extends _0x29a664['RxDisposable']{constructor(_0x44356d,_0x58a92c,_0x582ace,_0x17125a,_0x75d8fd,_0x18e4d2,_0x2b1066,_0x252585){var _0x2eeb19=_0x997d7;super(),_0x260f1e(this,'_sessionStatus$',new _0x32c204[(_0x2eeb19(0x4be))](0x0)),_0x260f1e(this,_0x2eeb19(0x40f),this[_0x2eeb19(0x442)][_0x2eeb19(0x313)]()),_0x260f1e(this,_0x2eeb19(0x3bf),new _0x32c204[(_0x2eeb19(0x41c))]()),_0x260f1e(this,_0x2eeb19(0x25c),this[_0x2eeb19(0x3bf)][_0x2eeb19(0x313)]()),_0x260f1e(this,_0x2eeb19(0x49e)),_0x260f1e(this,_0x2eeb19(0x3d6)),_0x260f1e(this,_0x2eeb19(0x3f2)),_0x260f1e(this,_0x2eeb19(0x338),!0x1),_0x260f1e(this,_0x2eeb19(0x272),null),(this[_0x2eeb19(0x4e0)]=_0x44356d,this['_logService']=_0x582ace,this[_0x2eeb19(0x261)]=_0x17125a,this['_memberService']=_0x75d8fd,this['_commentService']=_0x18e4d2,this['_collaborationUIEventService']=_0x2b1066,this[_0x2eeb19(0x571)]=_0x252585,this['_shouldReportTelemetry']=!!this['_telemetryService'],_0x58a92c['pipe'](_0x32c204[_0x2eeb19(0x45b)](this[_0x2eeb19(0x2a0)]))[_0x2eeb19(0x3cc)](_0x2c4403=>{var _0x2b2820=_0x2eeb19,_0x3c9fe7;typeof _0x2c4403>'u'||(this[_0x2b2820(0x49e)]=_0x2c4403,_0x2c4403?(this['_joinRoom'](_0x2c4403),this[_0x2b2820(0x3d6)]=_0x2c4403[_0x2b2820(0x3e4)][_0x2b2820(0x3cc)](_0x1c21d8=>{var _0x349fdb=_0x2b2820;_0x1c21d8[_0x349fdb(0x259)]===this[_0x349fdb(0x4e0)]&&this[_0x349fdb(0x30b)](_0x1c21d8);})):(this[_0x2b2820(0x520)](),this['_sessionStatus$']['next'](0x2),(_0x3c9fe7=this[_0x2b2820(0x3d6)])==null||_0x3c9fe7['unsubscribe'](),this[_0x2b2820(0x3d6)]=null));}));}get['sessionStatus'](){var _0x5cb58b=_0x997d7;return this[_0x5cb58b(0x442)][_0x5cb58b(0x53f)]();}[_0x997d7(0x2f1)](){var _0x5d8c94=_0x997d7,_0x21d45b,_0x58cc1d;return(_0x58cc1d=(_0x21d45b=this['_socket'])==null?void 0x0:_0x21d45b[_0x5d8c94(0x298)])!=null?_0x58cc1d:null;}['dispose'](){var _0x28e53c=_0x997d7;super[_0x28e53c(0x206)](),this[_0x28e53c(0x2a0)][_0x28e53c(0x476)](),this[_0x28e53c(0x2a0)]['complete']();}['close'](){var _0x4867e1=_0x997d7,_0x26e861,_0x502534;this[_0x4867e1(0x520)](),(_0x26e861=this[_0x4867e1(0x49e)])==null||_0x26e861[_0x4867e1(0x4ea)]({'cmd':_0x1f168c[_0x4867e1(0x50c)],'data':{'roomID':this[_0x4867e1(0x4e0)]}}),(_0x502534=this[_0x4867e1(0x49e)])==null||_0x502534[_0x4867e1(0x4f9)](),this[_0x4867e1(0x3bf)][_0x4867e1(0x42a)](),this['_sessionStatus$'][_0x4867e1(0x42a)](),this[_0x4867e1(0x206)]();}['_onCombEvent'](_0x1a2a9e){var _0x1a6e86=_0x997d7;_0x1a2a9e[_0x1a6e86(0x235)]===_0x1f168c['JOIN']?this[_0x1a6e86(0x4d4)](_0x1a2a9e):_0x1a2a9e[_0x1a6e86(0x235)]===_0x1f168c[_0x1a6e86(0x3e6)]&&this[_0x1a6e86(0x570)](_0x1a2a9e);}['_joinRoom'](_0x2a5038){var _0x12650c=_0x997d7;this['_sessionStatus$'][_0x12650c(0x476)](0x1),_0x2a5038[_0x12650c(0x4ea)]({'cmd':_0x1f168c[_0x12650c(0x32a)],'routeKey':this[_0x12650c(0x4e0)],'routeType':'','data':{'rooms':[{'roomID':this[_0x12650c(0x4e0)]}]}});}[_0x997d7(0x4d4)](_0x427153){var _0x45a51d=_0x997d7,_0x366cc5;if(_0x427153[_0x45a51d(0x3e9)]in _0x43b024){this[_0x45a51d(0x47a)][_0x45a51d(0x2d4)]({'id':_0xedfb31[_0x45a51d(0x25b)],'data':_0x43b024[_0x427153[_0x45a51d(0x3e9)]]}),this[_0x45a51d(0x442)][_0x45a51d(0x476)](0x2);return;}this[_0x45a51d(0x442)]['next'](0x3);const _0x16d69e=(_0x366cc5=_0x427153[_0x45a51d(0x40b)][_0x45a51d(0x457)][this['_unitID']])==null?void 0x0:_0x366cc5['members'];_0x16d69e&&_0x16d69e[_0x45a51d(0x2bd)](_0x2e980f=>this[_0x45a51d(0x303)][_0x45a51d(0x486)](this[_0x45a51d(0x4e0)],_0x2e980f));}[_0x997d7(0x570)](_0x472f12){var _0x680012=_0x997d7;try{const _0x146322=_0x472f12[_0x680012(0x40b)];switch(_0x146322[_0x680012(0x328)]){case _0x5a7fdc[_0x680012(0x315)][_0x680012(0x4b8)]:this[_0x680012(0x3d7)](_0x146322),this['_event$']['next'](_0x146322);break;case _0x5a7fdc[_0x680012(0x315)][_0x680012(0x47b)]:this['_onUserLeave'](_0x146322),this[_0x680012(0x3bf)][_0x680012(0x476)](_0x146322);break;case _0x5a7fdc[_0x680012(0x315)][_0x680012(0x243)]:case _0x5a7fdc[_0x680012(0x315)][_0x680012(0x3a7)]:this['_stopTelemetryCollaborationNewChangeset'](),this[_0x680012(0x563)](),this[_0x680012(0x3bf)][_0x680012(0x476)](_0x146322);break;case _0x5a7fdc[_0x680012(0x315)]['MSG_FOR_ERROR']:this[_0x680012(0x221)][_0x680012(0x4ee)](_0x680012(0x3ae)+JSON[_0x680012(0x22d)](_0x146322)),this[_0x680012(0x3bf)][_0x680012(0x476)](_0x146322);break;case _0x5a7fdc['CollaborationEvent'][_0x680012(0x2a2)]:this[_0x680012(0x510)]['onCommentUpdate'](_0x146322[_0x680012(0x40b)]),this[_0x680012(0x3bf)][_0x680012(0x476)](_0x146322);break;default:this['_event$'][_0x680012(0x476)](_0x146322);}}catch(_0x513593){this[_0x680012(0x221)][_0x680012(0x4ee)](_0x513593,_0x472f12);}}[_0x997d7(0x3d7)](_0x5bb932){var _0x224442=_0x997d7;this[_0x224442(0x303)][_0x224442(0x486)](this[_0x224442(0x4e0)],_0x5bb932['data']);}['_onUserLeave'](_0x26e0d3){var _0x501be4=_0x997d7;this['_memberService'][_0x501be4(0x341)](this[_0x501be4(0x4e0)],_0x26e0d3['data'][_0x501be4(0x298)]);}async[_0x997d7(0x4ea)](_0x246144,_0x1764c1){var _0xdbb878=_0x997d7;if(this['sessionStatus']!==0x3||!this['_socket'])throw new Error(_0xdbb878(0x421));try{_0x246144[_0xdbb878(0x328)]===_0x5a7fdc[_0xdbb878(0x315)][_0xdbb878(0x48e)]&&(this[_0xdbb878(0x34e)](),this[_0xdbb878(0x380)](_0x246144)),this['_socket']['send']({'cmd':_0x1f168c['INGEST'],'routeKey':_0x1764c1,'routeType':'','data':_0x246144});}catch(_0x300572){this[_0xdbb878(0x221)][_0xdbb878(0x4ee)](_0x300572);}}[_0x997d7(0x34e)](){var _0x1c81c9=_0x997d7,_0x22fe63;this[_0x1c81c9(0x3f2)]=setTimeout(()=>{var _0x203c92=_0x1c81c9;this[_0x203c92(0x3f2)]=null,this[_0x203c92(0x47a)][_0x203c92(0x2d4)]({'id':_0xedfb31[_0x203c92(0x3f3)]});},(_0x22fe63=this['_configService'][_0x1c81c9(0x368)](_0x315b2c))!=null?_0x22fe63:0x4e20);}[_0x997d7(0x563)](){var _0x346ece=_0x997d7;this[_0x346ece(0x3f2)]&&(clearTimeout(this[_0x346ece(0x3f2)]),this[_0x346ece(0x3f2)]=null);}[_0x997d7(0x380)](_0x16501c){var _0x46fe12=_0x997d7;if(!this[_0x46fe12(0x338)])return;const {data:_0x25a0aa}=_0x16501c,{unitID:_0x250e49,changeset:_0x2e6de8}=_0x25a0aa,{mutations:_0x128a67,type:_0x3f3653}=_0x2e6de8;this[_0x46fe12(0x272)]={'unitId':_0x250e49,'type':_0x3f3653,'startTime':performance[_0x46fe12(0x554)](),'stopTime':0x0,'duration':0x0,'size':_0x2a03fd(_0x128a67)};}[_0x997d7(0x3a2)](){var _0x37fc92=_0x997d7;if(this[_0x37fc92(0x338)]){if(!this['_telemetryInfo']){this[_0x37fc92(0x221)][_0x37fc92(0x4ee)](_0x37fc92(0x443),_0x37fc92(0x405));return;}this[_0x37fc92(0x272)][_0x37fc92(0x4ce)]=performance['now'](),this[_0x37fc92(0x272)]['duration']=this[_0x37fc92(0x272)][_0x37fc92(0x4ce)]-this[_0x37fc92(0x272)]['startTime'],this['_telemetryService'][_0x37fc92(0x349)](_0x5ecfcb,this['_telemetryInfo']),this[_0x37fc92(0x272)]=null;}}[_0x997d7(0x520)](){this['_telemetryInfo']=null;}},_0x36d18b[_0x997d7(0x4d1)]=_0x104870([_0x2b39f1(0x2,_0x29a664[_0x997d7(0x492)]),_0x2b39f1(0x3,_0x29a664[_0x997d7(0x4fc)]),_0x2b39f1(0x4,_0x29a664[_0x997d7(0x346)](_0x36d18b[_0x997d7(0x409)])),_0x2b39f1(0x5,_0x29a664['Inject'](_0x3e15b7)),_0x2b39f1(0x6,_0x29a664[_0x997d7(0x346)](_0x495958)),_0x2b39f1(0x7,_0x29a664[_0x997d7(0x29b)](_0x2d504f[_0x997d7(0x280)]))],_0x36d18b['CollaborationSession']);const _0x3e2be6=_0x29a664[_0x997d7(0x38e)](_0x997d7(0x3ed));function _0x82f518(_0x47a676){return'unit-cache-'+_0x47a676;}var _0x5ac726=Object['getOwnPropertyDescriptor'],_0x132989=(_0xbb4164,_0x11496b,_0x3df4e0,_0xbc3ca9)=>{var _0x3c3261=_0x997d7;for(var _0x396dd8=_0xbc3ca9>0x1?void 0x0:_0xbc3ca9?_0x5ac726(_0x11496b,_0x3df4e0):_0x11496b,_0x1f3631=_0xbb4164[_0x3c3261(0x307)]-0x1,_0x3900cb;_0x1f3631>=0x0;_0x1f3631--)(_0x3900cb=_0xbb4164[_0x1f3631])&&(_0x396dd8=_0x3900cb(_0x396dd8)||_0x396dd8);return _0x396dd8;},_0x512f62=(_0x11b3c3,_0x3f918a)=>(_0x51df40,_0x32ece0)=>_0x3f918a(_0x51df40,_0x32ece0,_0x11b3c3);function _0x59fc4b(_0x44a2bd){var _0x10eb54=_0x997d7;const {unitID:_0x200fdf,mutations:_0x4cca68}=_0x44a2bd;return{'unitId':_0x200fdf,'subUnitId':_0x4cca68[_0x10eb54(0x307)]>0x0?_0x4cca68[0x0]['params'][_0x10eb54(0x288)]:null};}_0x36d18b[_0x997d7(0x415)]=class{constructor(_0x94e894,_0x36bbe4,_0x17c2e9){var _0x2d42f9=_0x997d7;this[_0x2d42f9(0x30a)]=_0x94e894,this['_transformService']=_0x36bbe4,this[_0x2d42f9(0x44c)]=_0x17c2e9;}[_0x997d7(0x440)](_0x1c2969){var _0x88484a=_0x997d7,_0xa9eb56,_0x571149,_0x42de08,_0xf58cb;const _0x458af5=this['_injector'][_0x88484a(0x47e)](_0x1ce604[_0x88484a(0x41b)]),{unitId:_0x15dcea,subUnitId:_0x1f932c}=_0x59fc4b(_0x1c2969),_0xd5988f=_0x458af5==null?void 0x0:_0x458af5[_0x88484a(0x379)](_0x15dcea)['getCurrentSelections'](),_0x37155d=(_0x571149=(_0xa9eb56=this[_0x88484a(0x44c)][_0x88484a(0x458)](_0x15dcea))==null?void 0x0:_0xa9eb56[_0x88484a(0x27d)]())==null?void 0x0:_0x571149[_0x88484a(0x383)]();if(_0xd5988f[_0x88484a(0x307)]===0x0||!_0x15dcea||!_0x1f932c)return;const _0x4c64c6=[{'id':_0x1ce604['SetSelectionsOperation']['id'],'params':{'unitId':_0x15dcea,'subUnitId':_0x37155d,'selections':_0x29a664['Tools']['deepClone'](_0xd5988f)}}],_0x126185=this[_0x88484a(0x536)]['transformMutationsWithChangeset'](_0x1c2969,_0x4c64c6);if(!_0x5a7fdc[_0x88484a(0x260)](_0x126185))throw _0x126185[_0x88484a(0x4ee)];const _0x4e09ae=(_0xf58cb=(_0x42de08=_0x126185[_0x88484a(0x2d3)][0x0])==null?void 0x0:_0x42de08[_0x88484a(0x200)])==null?void 0x0:_0xf58cb[_0x88484a(0x518)];if(Array['isArray'](_0x4e09ae)&&_0x4e09ae[_0x88484a(0x307)]){if(_0x4e09ae['length']===_0x4c64c6[0x0]['params']['selections'][_0x88484a(0x307)]&&_0x4e09ae[_0x88484a(0x2c3)]((_0x1e9542,_0x39e29f)=>_0x29a664['Rectangle'][_0x88484a(0x205)](_0x1e9542[_0x88484a(0x300)],_0x4c64c6[0x0][_0x88484a(0x200)][_0x88484a(0x518)][_0x39e29f]['range'])))return;this[_0x88484a(0x30a)][_0x88484a(0x47e)](_0x29a664[_0x88484a(0x37f)])[_0x88484a(0x459)](_0x1ce604[_0x88484a(0x26c)]['id'],{'unitId':_0x15dcea,'subUnitId':_0x37155d,'selections':_0x4e09ae});}}},_0x36d18b['SheetTransformSelectionsService']=_0x132989([_0x512f62(0x0,_0x29a664['Inject'](_0x29a664[_0x997d7(0x2c6)])),_0x512f62(0x1,_0x5a7fdc[_0x997d7(0x4a5)]),_0x512f62(0x2,_0x29a664[_0x997d7(0x208)])],_0x36d18b['SheetTransformSelectionsService']);const _0x4f3087=_0x29a664['createIdentifier'](_0x997d7(0x291));var _0x4ff042=(_0x2ba5a8=>(_0x2ba5a8[_0x2ba5a8[_0x997d7(0x44e)]=0x0]='NO_OTHER_CLIENTS_EDITING',_0x2ba5a8[_0x2ba5a8['OTHER_CLIENTS_EDITING']=0x1]=_0x997d7(0x3f7),_0x2ba5a8))(_0x4ff042||{});const _0x3fa783='collaboration-client.config',_0x1ee5fd={},_0x236b73=new Set([_0x1ce604['InsertSheetMutation']['id']]);function _0x592534(_0x19354a,_0x1c4774,_0x1cc78a,_0x4f8cf8,_0x568a88){var _0x585937=_0x997d7,_0xbfcebd,_0x391ae5,_0x1b1506,_0x376c86;const _0xfd6c34=[];for(const _0x526ce9 of _0x19354a)if(_0x236b73[_0x585937(0x572)](_0x526ce9['id'])){if(_0xfd6c34[_0x585937(0x307)]>0x0)break;_0xfd6c34['push'](_0x526ce9);break;}else _0xfd6c34[_0x585937(0x3f6)](_0x526ce9);const _0x1d32cf=(_0x391ae5=(_0xbfcebd=_0x568a88[_0x585937(0x420)]())==null?void 0x0:_0xbfcebd[_0x585937(0x4cd)])!=null?_0x391ae5:_0x585937(0x374),_0x27a763=(_0x376c86=(_0x1b1506=_0x568a88[_0x585937(0x420)]())==null?void 0x0:_0x1b1506[_0x585937(0x298)])!=null?_0x376c86:_0x585937(0x374);return{'changeset':{'unitID':_0x1c4774,'type':_0x5a7fdc[_0x585937(0x51e)](_0x1cc78a[_0x585937(0x371)](_0x1c4774)),'baseRev':_0x4f8cf8['getCurrentRevOfUnit'](_0x1c4774),'revision':0x0,'userID':_0x1d32cf,'memberID':_0x27a763,'mutations':_0xfd6c34},'pendingMutations':_0x19354a['slice'](_0xfd6c34['length'])};}function _0x1a13a4(_0x184b66,_0xead148,_0x5629ce,_0x461eb0,_0x17a07e){var _0x4987ad=_0x997d7,_0x44a549,_0x299a35,_0x98b702,_0x28b4f8;const _0x481b1c=[_0x184b66[_0x4987ad(0x516)]((_0xd6d151,_0x5d2948)=>{var _0x282666=_0x4987ad,_0x1a9cf7;const {id:_0xdc738d}=_0xd6d151,{id:_0x297045,type:_0x317e3b}=_0x5d2948,_0x43b08f=(_0x1a9cf7=_0xd6d151[_0x282666(0x200)])!=null?_0x1a9cf7:{'actions':null},_0x2fa650=_0x5d2948[_0x282666(0x200)];if(_0xdc738d&&_0xdc738d!==_0x297045)throw new Error(_0x282666(0x36a)+_0xdc738d+'\x20-\x20'+_0x297045+'.');return{..._0xd6d151,'id':_0x297045,'type':_0x317e3b,'params':{'unitId':_0x2fa650[_0x282666(0x441)],'textRanges':_0x2fa650[_0x282666(0x211)],'actions':_0x29a664[_0x282666(0x2bf)]['compose'](_0x43b08f['actions'],_0x2fa650[_0x282666(0x2c7)])}};},{})],_0x24c674=(_0x299a35=(_0x44a549=_0x17a07e['getCurrentUser']())==null?void 0x0:_0x44a549[_0x4987ad(0x4cd)])!=null?_0x299a35:'unknown',_0x4cf44c=(_0x28b4f8=(_0x98b702=_0x17a07e[_0x4987ad(0x420)]())==null?void 0x0:_0x98b702[_0x4987ad(0x298)])!=null?_0x28b4f8:_0x4987ad(0x374);return{'changeset':{'unitID':_0xead148,'type':_0x5a7fdc['mapDocumentTypeToUniverType'](_0x5629ce[_0x4987ad(0x371)](_0xead148)),'baseRev':_0x461eb0[_0x4987ad(0x4e4)](_0xead148),'revision':0x0,'userID':_0x24c674,'memberID':_0x4cf44c,'mutations':_0x481b1c},'pendingMutations':[]};}function _0x44a4a1(_0x1ce12d,_0xeab38c){var _0x24b018=_0x997d7;const _0x1f9cd0=new _0x32c204['ReplaySubject'](0x1);return setTimeout(()=>_0x1f9cd0[_0x24b018(0x476)](_0xeab38c),_0x1ce12d),_0x1f9cd0['asObservable']()[_0x24b018(0x2ab)](_0x32c204[_0x24b018(0x2f3)](0x1));}const _0x4b247a={'id':_0x1ce604['EmptyMutation']['id'],'type':_0x29a664['CommandType'][_0x997d7(0x2b5)],'params':{}};var _0x512f92=Object['getOwnPropertyDescriptor'],_0x5c433b=(_0x509c21,_0x474395,_0x375a81,_0x5bd1dc)=>{var _0x4e7f1d=_0x997d7;for(var _0x56aa1a=_0x5bd1dc>0x1?void 0x0:_0x5bd1dc?_0x512f92(_0x474395,_0x375a81):_0x474395,_0x4d5f30=_0x509c21[_0x4e7f1d(0x307)]-0x1,_0x2dd586;_0x4d5f30>=0x0;_0x4d5f30--)(_0x2dd586=_0x509c21[_0x4d5f30])&&(_0x56aa1a=_0x2dd586(_0x56aa1a)||_0x56aa1a);return _0x56aa1a;},_0x4bdbf6=(_0x74cd88,_0x2a119d)=>(_0x390a1c,_0x2bc7bd)=>_0x2a119d(_0x390a1c,_0x2bc7bd,_0x74cd88),_0x54c82e=(_0x4b166a=>(_0x4b166a['NOT_COLLAB']=_0x997d7(0x428),_0x4b166a['SYNCED']=_0x997d7(0x39c),_0x4b166a[_0x997d7(0x4bc)]=_0x997d7(0x564),_0x4b166a['AWAITING']='awaiting',_0x4b166a[_0x997d7(0x23e)]=_0x997d7(0x2cc),_0x4b166a['FETCH_MISS']=_0x997d7(0x254),_0x4b166a['CONFLICT']=_0x997d7(0x4a0),_0x4b166a[_0x997d7(0x3fd)]=_0x997d7(0x54a),_0x4b166a))(_0x54c82e||{});const _0x1ed61b=0xea60;class _0x383ca2{constructor(_0xd6ea47,_0x1e52e4,_0x22c1a6,_0x359125,_0x5b3c72,_0x2e3eef,_0x193e1c,_0x541fc6,_0x11ac6f){var _0x38a4c0=_0x997d7;_0x260f1e(this,_0x38a4c0(0x480),null),_0x260f1e(this,_0x38a4c0(0x2f8),[]),(this[_0x38a4c0(0x297)]=_0xd6ea47,this[_0x38a4c0(0x3b0)]=_0x1e52e4,this[_0x38a4c0(0x38d)]=_0x5b3c72,this[_0x38a4c0(0x2dc)]=_0x2e3eef,this[_0x38a4c0(0x552)]=_0x193e1c,this[_0x38a4c0(0x4da)]=_0x541fc6,this[_0x38a4c0(0x2ce)]=_0x11ac6f,this['_awaitingChangeset']=_0x22c1a6,this[_0x38a4c0(0x2f8)]=_0x359125);}[_0x997d7(0x27f)](_0x273097){var _0x29460d=_0x997d7;const _0x2014f3=this['_revisionService']['getCurrentRevOfUnit'](this[_0x29460d(0x297)]);return _0x273097[_0x29460d(0x295)]>_0x2014f3+0x1?(this[_0x29460d(0x38d)][_0x29460d(0x43c)]({'from':_0x2014f3,'to':_0x273097[_0x29460d(0x295)]-0x1}),!0x0):!0x1;}[_0x997d7(0x52f)](_0x20feeb){var _0x364e94=_0x997d7;this['_undoRedoService'][_0x364e94(0x4c4)](this[_0x364e94(0x297)],_0x20feeb);}[_0x997d7(0x34f)](_0x4aed7c){var _0x319c79=_0x997d7,_0x631571,_0x27c279;(_0x27c279=(_0x631571=this[_0x319c79(0x38d)])[_0x319c79(0x2a9)])==null||_0x27c279[_0x319c79(0x23d)](_0x631571,_0x4aed7c);}['_transformIMECache'](_0x46cee8){var _0x474b65=_0x997d7,_0x17fb77,_0x4df2b4;return(_0x4df2b4=(_0x17fb77=this[_0x474b65(0x38d)])[_0x474b65(0x3b9)])==null?void 0x0:_0x4df2b4[_0x474b65(0x23d)](_0x17fb77,_0x46cee8);}[_0x997d7(0x507)](_0x3ac28b){var _0x34736c=_0x997d7,_0x505965,_0x1914b1;return(_0x1914b1=(_0x505965=this[_0x34736c(0x38d)])[_0x34736c(0x3a5)])==null?void 0x0:_0x1914b1[_0x34736c(0x23d)](_0x505965,_0x3ac28b);}['_transformRemoteChangesetByIMECache'](_0x13db96){var _0x5aecc4=_0x997d7,_0x91ef5e,_0x2e3a13,_0x2c4da6;return(_0x2c4da6=(_0x2e3a13=(_0x91ef5e=this[_0x5aecc4(0x38d)])[_0x5aecc4(0x40d)])==null?void 0x0:_0x2e3a13[_0x5aecc4(0x23d)](_0x91ef5e,_0x13db96))!=null?_0x2c4da6:_0x13db96;}[_0x997d7(0x56b)](_0x5ed2d0){var _0x3e00f6=_0x997d7,_0x3ef635,_0x4e3042,_0x1b20a5;return(_0x1b20a5=(_0x4e3042=(_0x3ef635=this[_0x3e00f6(0x38d)])['onTransformRemoteChangesetByStateCache'])==null?void 0x0:_0x4e3042[_0x3e00f6(0x23d)](_0x3ef635,_0x5ed2d0))!=null?_0x1b20a5:_0x5ed2d0;}[_0x997d7(0x21b)](_0x350d9e){var _0x14a0b7=_0x997d7,_0x5f1cbf,_0x35ecf5;if(this[_0x14a0b7(0x3b0)]===_0x60f00c[_0x14a0b7(0x47c)]){const {unitID:_0x3aef2b,mutations:_0x33188f,memberID:_0x5eaa3e}=_0x350d9e,_0x4b4c3b=_0x33188f[_0x14a0b7(0x307)]>0x0?_0x33188f[0x0][_0x14a0b7(0x200)][_0x14a0b7(0x211)]:[];Array[_0x14a0b7(0x2c5)](_0x4b4c3b)&&_0x4b4c3b[_0x14a0b7(0x307)]>0x0&&((_0x35ecf5=(_0x5f1cbf=this[_0x14a0b7(0x38d)])['onSyncEditingCollabCursor'])==null||_0x35ecf5['call'](_0x5f1cbf,{'unitID':_0x3aef2b,'memberID':_0x5eaa3e,'textRanges':_0x4b4c3b}));}}[_0x997d7(0x2b3)](){var _0x5103f6=_0x997d7,_0xa59c6f;(_0xa59c6f=this[_0x5103f6(0x2ce)])==null||_0xa59c6f[_0x5103f6(0x543)](this['unitID'],this[_0x5103f6(0x3b0)],this['_awaitingChangeset'],this[_0x5103f6(0x2f8)]);}[_0x997d7(0x352)](){var _0x3f631a=_0x997d7;return this[_0x3f631a(0x4da)]['getCurrentRevOfUnit'](this[_0x3f631a(0x297)]);}['_incrementRevisionNumber'](){var _0x9553c0=_0x997d7;this[_0x9553c0(0x4da)]['incrementRevOfUnit'](this['unitID']);}[_0x997d7(0x517)](_0x213357){var _0x32211d=_0x997d7,_0x5a8cf6;let _0x483057=this['_transformRemoteChangesetByIMECache'](_0x213357);_0x483057=this[_0x32211d(0x56b)](_0x483057);const _0x5c2f6f=_0x29a664[_0x32211d(0x56c)](_0x483057['mutations'],this[_0x32211d(0x2dc)],{'fromCollab':!0x0});if(!_0x5c2f6f['result'])throw _0x5c2f6f['error']instanceof Error?_0x5c2f6f[_0x32211d(0x4ee)]:new Error((_0x5a8cf6=_0x5c2f6f['error'])!=null?_0x5a8cf6:_0x32211d(0x39f));this['_transformIMECache'](_0x483057),this[_0x32211d(0x507)](_0x483057),this[_0x32211d(0x52f)](_0x213357),this[_0x32211d(0x34f)](_0x483057),this['_syncEditingCollabCursor'](_0x483057),this['_incrementRevisionNumber']();}}_0x36d18b['SyncedState']=class extends _0x383ca2{constructor(_0x333254,_0x6d64dc,_0x59cf4c,_0x1a5b37,_0x5b2523,_0x3f73b5,_0x48dce8,_0x206c2b,_0x194daa,_0x33935e){var _0xcc64bf=_0x997d7;super(_0x333254,_0x6d64dc,null,[],_0x59cf4c,_0x48dce8,_0x3f73b5,_0x1a5b37,_0x33935e),_0x260f1e(this,_0xcc64bf(0x370),_0xcc64bf(0x39c)),(this[_0xcc64bf(0x30a)]=_0x5b2523,this[_0xcc64bf(0x221)]=_0x206c2b,this[_0xcc64bf(0x536)]=_0x194daa,this[_0xcc64bf(0x450)]=_0x33935e);}[_0x997d7(0x560)](_0x1dbced){var _0x52e21f=_0x997d7;const _0x15dd73=this[_0x52e21f(0x30a)]['createInstance'](_0x36d18b[_0x52e21f(0x265)],this[_0x52e21f(0x297)],this[_0x52e21f(0x3b0)],[_0x1dbced],this['_handler']);return _0x15dd73[_0x52e21f(0x23a)](),_0x15dd73['_updateLocalCache'](),_0x15dd73;}[_0x997d7(0x42c)](_0x2553af){var _0x57b706=_0x997d7;if(this[_0x57b706(0x27f)](_0x2553af))return this[_0x57b706(0x30a)]['createInstance'](_0x36d18b[_0x57b706(0x310)],this[_0x57b706(0x297)],this[_0x57b706(0x3b0)],null,[],null,[_0x2553af],this[_0x57b706(0x38d)]);try{const _0x2057a4=this[_0x57b706(0x536)][_0x57b706(0x576)](_0x2553af,[_0x4b247a]);if(_0x5a7fdc[_0x57b706(0x260)](_0x2057a4)){const {c1Prime:_0x2eaf14}=_0x2057a4;return this[_0x57b706(0x517)](_0x2eaf14),this;}throw _0x2057a4[_0x57b706(0x4ee)];}catch(_0x105a09){return this[_0x57b706(0x221)]['error'](_0x105a09),this[_0x57b706(0x2c0)](!0x1);}}[_0x997d7(0x2c0)](_0x3bf12a){var _0x7d44d3=_0x997d7;return this['_injector'][_0x7d44d3(0x55e)](_0x36d18b[_0x7d44d3(0x445)],this[_0x7d44d3(0x297)],this[_0x7d44d3(0x3b0)],null,[],this['_handler'],_0x3bf12a);}[_0x997d7(0x4e8)](){var _0x229a12=_0x997d7;throw new Error(_0x229a12(0x392));}['onRemoteRej'](){var _0xbefbcc=_0x997d7;throw new Error(_0xbefbcc(0x26b));}[_0x997d7(0x4db)](){return this;}[_0x997d7(0x271)](){var _0x41076d=_0x997d7;return this['_injector']['createInstance'](_0x36d18b[_0x41076d(0x290)],this[_0x41076d(0x297)],this[_0x41076d(0x3b0)],null,[],this[_0x41076d(0x38d)]);}[_0x997d7(0x317)](){return this;}['resend'](){throw new Error('[SyncedState]:\x20invalid\x20calling\x20to\x20`resend`.');}[_0x997d7(0x528)](){var _0x114c9d=_0x997d7;const _0x413298=this[_0x114c9d(0x4da)][_0x114c9d(0x4e4)](this['unitID']);return this[_0x114c9d(0x38d)][_0x114c9d(0x43c)]({'from':_0x413298,'to':0x0}),this['_injector'][_0x114c9d(0x55e)](_0x36d18b[_0x114c9d(0x310)],this['unitID'],this[_0x114c9d(0x3b0)],null,[],null,[],this[_0x114c9d(0x38d)]);}},_0x36d18b[_0x997d7(0x568)]=_0x5c433b([_0x4bdbf6(0x3,_0x29a664[_0x997d7(0x346)](_0x5a7fdc[_0x997d7(0x424)])),_0x4bdbf6(0x4,_0x29a664['Inject'](_0x29a664[_0x997d7(0x2c6)])),_0x4bdbf6(0x5,_0x29a664[_0x997d7(0x232)]),_0x4bdbf6(0x6,_0x29a664[_0x997d7(0x37f)]),_0x4bdbf6(0x7,_0x29a664['ILogService']),_0x4bdbf6(0x8,_0x5a7fdc['ITransformService']),_0x4bdbf6(0x9,_0x29a664[_0x997d7(0x29b)](_0x3e2be6))],_0x36d18b[_0x997d7(0x568)]),_0x36d18b['PendingState']=class extends _0x383ca2{constructor(_0x402406,_0x3f366d,_0x424240,_0x259422,_0x1fa317,_0x4fe842,_0x1b56ab,_0x5cc4a4,_0x3dbadf,_0x5838d4,_0x953a8f,_0x45b393,_0x163ef7,_0x5088ce){var _0x5aeedd=_0x997d7;super(_0x402406,_0x3f366d,null,_0x424240,_0x259422,_0x3dbadf,_0x163ef7,_0x4fe842,_0x5088ce),_0x260f1e(this,_0x5aeedd(0x370),_0x5aeedd(0x564)),_0x260f1e(this,'_scheduleCompleteTimestamp',null),_0x260f1e(this,_0x5aeedd(0x406),null),(this[_0x5aeedd(0x30a)]=_0x1fa317,this['_memberService']=_0x1b56ab,this[_0x5aeedd(0x221)]=_0x5cc4a4,this[_0x5aeedd(0x261)]=_0x5838d4,this[_0x5aeedd(0x536)]=_0x953a8f,this['_univerInstanceService']=_0x45b393);}['appendMutation'](_0x512698){var _0x1d54c4=_0x997d7;return this[_0x1d54c4(0x2f8)][_0x1d54c4(0x3f6)](_0x512698),this[_0x1d54c4(0x2b3)](),this;}[_0x997d7(0x42c)](_0x1f99b5){var _0x37f997=_0x997d7;if(this[_0x37f997(0x27f)](_0x1f99b5))return this['_clearScheduledTask'](),this[_0x37f997(0x30a)]['createInstance'](_0x36d18b['FetchingMissState'],this['unitID'],this[_0x37f997(0x3b0)],null,this[_0x37f997(0x2f8)],null,[_0x1f99b5],this[_0x37f997(0x38d)]);try{const _0x5adc3d=this[_0x37f997(0x536)][_0x37f997(0x576)](_0x1f99b5,this['_pendingMutations']);if(_0x5a7fdc[_0x37f997(0x260)](_0x5adc3d)){const {c1Prime:_0x4fba81,m2Prime:_0x222184}=_0x5adc3d;this[_0x37f997(0x517)](_0x4fba81);const _0x16e111=this[_0x37f997(0x30a)][_0x37f997(0x55e)](_0x36d18b['PendingState'],this[_0x37f997(0x297)],this[_0x37f997(0x3b0)],_0x222184,this[_0x37f997(0x38d)]);this[_0x37f997(0x508)]();const _0x9600fc=new Date()[_0x37f997(0x299)](),_0x2ddcd4=this[_0x37f997(0x535)]?Math[_0x37f997(0x287)](this[_0x37f997(0x535)]-_0x9600fc,0x0):this[_0x37f997(0x3f1)]();return _0x16e111[_0x37f997(0x23a)](_0x2ddcd4),_0x16e111;}throw _0x5adc3d[_0x37f997(0x4ee)];}catch(_0x54ad76){return this[_0x37f997(0x221)][_0x37f997(0x4ee)](_0x54ad76),this[_0x37f997(0x2c0)](!0x1);}}[_0x997d7(0x4e8)](){var _0x2b7898=_0x997d7;throw new Error(_0x2b7898(0x475));}['onRemoteRej'](){var _0x715e87=_0x997d7;throw new Error(_0x715e87(0x426));}['onRemoteRetry'](){return this;}['toggleOffline'](){var _0x368fe0=_0x997d7;return this[_0x368fe0(0x508)](),this[_0x368fe0(0x30a)][_0x368fe0(0x55e)](_0x36d18b[_0x368fe0(0x290)],this[_0x368fe0(0x297)],this[_0x368fe0(0x3b0)],null,this['_pendingMutations'],this[_0x368fe0(0x38d)]);}[_0x997d7(0x317)](){return this;}[_0x997d7(0x23a)](_0x352194){var _0x56f5ed=_0x997d7;const _0x4a60b5=_0x352194!=null?_0x352194:this['_getSendChangesetTimeout']();this[_0x56f5ed(0x535)]=new Date()[_0x56f5ed(0x299)]()+_0x4a60b5,this['_sendingTimer']=setTimeout(()=>{var _0x298bb1=_0x56f5ed;this[_0x298bb1(0x508)]();let _0x19e783=null;switch(this['type']){case _0x60f00c[_0x298bb1(0x4c5)]:{_0x19e783=_0x592534(this[_0x298bb1(0x2f8)],this[_0x298bb1(0x297)],this[_0x298bb1(0x432)],this[_0x298bb1(0x4da)],this[_0x298bb1(0x303)]);break;}case _0x60f00c['UNIVER_DOC']:{this[_0x298bb1(0x2f8)][_0x298bb1(0x2c3)](_0x33427d=>_0x33427d['id']===_0x438bd6[_0x298bb1(0x515)]['id'])?_0x19e783=_0x1a13a4(this['_pendingMutations'],this[_0x298bb1(0x297)],this[_0x298bb1(0x432)],this[_0x298bb1(0x4da)],this[_0x298bb1(0x303)]):_0x19e783=_0x592534(this[_0x298bb1(0x2f8)],this[_0x298bb1(0x297)],this[_0x298bb1(0x432)],this[_0x298bb1(0x4da)],this[_0x298bb1(0x303)]);break;}default:throw new Error('[PendingState]:\x20unhandled\x20univer\x20type:\x20'+this[_0x298bb1(0x3b0)]+_0x298bb1(0x357));}const {changeset:_0x3b27ca,pendingMutations:_0x54b1d5}=_0x19e783;this['_handler'][_0x298bb1(0x314)](_0x3b27ca);const _0x5f42c6=_0x54b1d5[_0x298bb1(0x307)]?this[_0x298bb1(0x30a)][_0x298bb1(0x55e)](_0x36d18b[_0x298bb1(0x4ba)],this[_0x298bb1(0x297)],this[_0x298bb1(0x3b0)],_0x3b27ca,_0x54b1d5,this[_0x298bb1(0x38d)],void 0x0):this['_injector'][_0x298bb1(0x55e)](_0x36d18b[_0x298bb1(0x37e)],this[_0x298bb1(0x297)],this[_0x298bb1(0x3b0)],_0x3b27ca,this[_0x298bb1(0x38d)]);_0x5f42c6[_0x298bb1(0x2b3)](),this[_0x298bb1(0x38d)][_0x298bb1(0x4bf)](this,_0x5f42c6);},_0x4a60b5);}[_0x997d7(0x3f1)](){var _0x1ddafd=_0x997d7,_0x5d9057;const _0x28a5a7=this['_configService'][_0x1ddafd(0x368)](_0x3fa783);return(_0x5d9057=_0x28a5a7==null?void 0x0:_0x28a5a7[_0x1ddafd(0x3c6)])!=null?_0x5d9057:0x7d0;}[_0x997d7(0x482)](){var _0xe702c8=_0x997d7;throw new Error(_0xe702c8(0x4c8));}[_0x997d7(0x508)](){var _0x4ff68b=_0x997d7;this[_0x4ff68b(0x406)]!=null&&(clearTimeout(this[_0x4ff68b(0x406)]),this['_sendingTimer']=null);}[_0x997d7(0x2c0)](_0x1edd8a){var _0x5bae14=_0x997d7;return this['_clearScheduledTask'](),this[_0x5bae14(0x30a)]['createInstance'](_0x36d18b[_0x5bae14(0x445)],this[_0x5bae14(0x297)],this['type'],null,this[_0x5bae14(0x2f8)],this[_0x5bae14(0x38d)],_0x1edd8a);}},_0x36d18b[_0x997d7(0x265)]=_0x5c433b([_0x4bdbf6(0x4,_0x29a664[_0x997d7(0x346)](_0x29a664['Injector'])),_0x4bdbf6(0x5,_0x29a664[_0x997d7(0x346)](_0x5a7fdc[_0x997d7(0x424)])),_0x4bdbf6(0x6,_0x29a664['Inject'](_0x36d18b[_0x997d7(0x409)])),_0x4bdbf6(0x7,_0x29a664[_0x997d7(0x492)]),_0x4bdbf6(0x8,_0x29a664[_0x997d7(0x37f)]),_0x4bdbf6(0x9,_0x29a664['IConfigService']),_0x4bdbf6(0xa,_0x5a7fdc['ITransformService']),_0x4bdbf6(0xb,_0x29a664['IUniverInstanceService']),_0x4bdbf6(0xc,_0x29a664[_0x997d7(0x232)]),_0x4bdbf6(0xd,_0x29a664[_0x997d7(0x29b)](_0x3e2be6))],_0x36d18b['PendingState']),_0x36d18b[_0x997d7(0x37e)]=class extends _0x383ca2{constructor(_0x4759c0,_0x2c7f0d,_0x454d95,_0x29f83f,_0x59e524,_0x4c4ac6,_0x4aeee9,_0x3d19fb,_0x15c175,_0xd12488,_0x4129b5){var _0x468c87=_0x997d7;super(_0x4759c0,_0x2c7f0d,_0x454d95,[],_0x29f83f,_0x4aeee9,_0xd12488,_0x4c4ac6,_0x4129b5),_0x260f1e(this,_0x468c87(0x370),_0x468c87(0x40a)),_0x260f1e(this,_0x468c87(0x2dd),0x0),_0x260f1e(this,_0x468c87(0x220)),_0x260f1e(this,_0x468c87(0x25f)),(this['_injector']=_0x59e524,this[_0x468c87(0x221)]=_0x3d19fb,this[_0x468c87(0x536)]=_0x15c175);}[_0x997d7(0x560)](_0x1edc66){var _0x54b01a=_0x997d7;this[_0x54b01a(0x508)]();const _0x193c87=this[_0x54b01a(0x30a)][_0x54b01a(0x55e)](_0x36d18b[_0x54b01a(0x4ba)],this[_0x54b01a(0x297)],this['type'],this[_0x54b01a(0x480)],[_0x1edc66],this['_handler'],this[_0x54b01a(0x220)]);return _0x193c87[_0x54b01a(0x2b3)](),_0x193c87;}[_0x997d7(0x42c)](_0x5a0de5){var _0x4add01=_0x997d7;if(this[_0x4add01(0x27f)](_0x5a0de5))return this[_0x4add01(0x508)](),this[_0x4add01(0x30a)][_0x4add01(0x55e)](_0x36d18b['FetchingMissState'],this[_0x4add01(0x297)],this['type'],this[_0x4add01(0x480)],[],null,[_0x5a0de5],this['_handler']);try{const _0xad6a79=this[_0x4add01(0x536)][_0x4add01(0x25e)]([_0x5a0de5],[this['_awaitingChangeset']],!0x1);if(_0x5a7fdc[_0x4add01(0x3d3)](_0xad6a79)){const {c1Prime:_0x3224c0,c2Prime:_0x5a4406}=_0xad6a79;this[_0x4add01(0x517)](_0x3224c0[0x0]),_0x5a4406[0x0][_0x4add01(0x2e9)]=this[_0x4add01(0x352)](),this[_0x4add01(0x508)]();const _0x3dd5ed=this[_0x4add01(0x30a)]['createInstance'](_0x36d18b[_0x4add01(0x37e)],this[_0x4add01(0x297)],this[_0x4add01(0x3b0)],_0x5a4406[0x0],this[_0x4add01(0x38d)]);return _0x3dd5ed[_0x4add01(0x2b3)](),_0x3dd5ed;}return this['_onConflict'](!0x1);}catch(_0x263f1f){return this[_0x4add01(0x221)][_0x4add01(0x4ee)](_0x263f1f),this[_0x4add01(0x2c0)](!0x1);}}[_0x997d7(0x4e8)](_0x5a8c95){var _0x493cbd=_0x997d7;this['_clearScheduledTask']();const _0x583517=this[_0x493cbd(0x4da)]['getCurrentRevOfUnit'](this[_0x493cbd(0x297)]);if(_0x5a8c95[_0x493cbd(0x295)]<_0x583517-0x1)return this;if(this[_0x493cbd(0x27f)](_0x5a8c95))return this[_0x493cbd(0x30a)][_0x493cbd(0x55e)](_0x36d18b[_0x493cbd(0x310)],this['unitID'],this['type'],null,[],this['_awaitingChangeset'],[],this['_handler']);this[_0x493cbd(0x47f)]();const _0x5ea49d=this['_injector'][_0x493cbd(0x55e)](_0x36d18b[_0x493cbd(0x568)],this[_0x493cbd(0x297)],this['type'],this[_0x493cbd(0x38d)]);return _0x5ea49d[_0x493cbd(0x2b3)](),_0x5ea49d;}[_0x997d7(0x35a)](_0x2117df){var _0x507b2d=_0x997d7;return this[_0x507b2d(0x2c0)](!!(_0x2117df!=null&&_0x2117df[_0x507b2d(0x3e1)]));}['onRemoteRetry'](_0x40ac91){var _0x1ccd77=_0x997d7;return this[_0x1ccd77(0x2dd)]>_0x1ed61b?this[_0x1ccd77(0x271)]():(this[_0x1ccd77(0x220)]=_0x44a4a1(this[_0x1ccd77(0x2dd)],{'timeout':this[_0x1ccd77(0x2dd)],'reqId':_0x40ac91[_0x1ccd77(0x451)]}),this[_0x1ccd77(0x25f)]=this[_0x1ccd77(0x220)][_0x1ccd77(0x3cc)](({reqId:_0xf3bef9,timeout:_0x3d5589})=>{var _0x25d751=_0x1ccd77;this[_0x25d751(0x302)](_0xf3bef9,_0x3d5589);}),this);}[_0x997d7(0x271)](){var _0x19c489=_0x997d7;return this['_clearScheduledTask'](),this[_0x19c489(0x30a)][_0x19c489(0x55e)](_0x36d18b[_0x19c489(0x290)],this[_0x19c489(0x297)],this[_0x19c489(0x3b0)],this[_0x19c489(0x480)],[],this['_handler']);}[_0x997d7(0x317)](){return this;}['resend'](){var _0x4fcced=_0x997d7;this[_0x4fcced(0x38d)]['onSendChangeset'](this[_0x4fcced(0x480)]);}[_0x997d7(0x2c0)](_0x5e81f7){var _0x4a16f7=_0x997d7;return this[_0x4a16f7(0x508)](),this[_0x4a16f7(0x30a)]['createInstance'](_0x36d18b[_0x4a16f7(0x445)],this['unitID'],this[_0x4a16f7(0x3b0)],this[_0x4a16f7(0x480)],[],this[_0x4a16f7(0x38d)],_0x5e81f7);}['_resendWithTimeout'](_0x55c029,_0x50c8f1){var _0x311353=_0x997d7,_0x468694;_0x55c029===((_0x468694=this[_0x311353(0x480)])==null?void 0x0:_0x468694[_0x311353(0x451)])&&(this[_0x311353(0x482)](),this['_resendTimeout']=_0x50c8f1===0x0?0x3e8:_0x50c8f1*0x2);}[_0x997d7(0x508)](){var _0x21067a=_0x997d7,_0x2ac30a;(_0x2ac30a=this['_sender'])==null||_0x2ac30a[_0x21067a(0x2f5)](),this[_0x21067a(0x2dd)]=0x0;}},_0x36d18b[_0x997d7(0x37e)]=_0x5c433b([_0x4bdbf6(0x4,_0x29a664[_0x997d7(0x346)](_0x29a664[_0x997d7(0x2c6)])),_0x4bdbf6(0x5,_0x29a664[_0x997d7(0x346)](_0x5a7fdc[_0x997d7(0x424)])),_0x4bdbf6(0x6,_0x29a664[_0x997d7(0x37f)]),_0x4bdbf6(0x7,_0x29a664['ILogService']),_0x4bdbf6(0x8,_0x5a7fdc[_0x997d7(0x4a5)]),_0x4bdbf6(0x9,_0x29a664['IUndoRedoService']),_0x4bdbf6(0xa,_0x29a664[_0x997d7(0x29b)](_0x3e2be6))],_0x36d18b[_0x997d7(0x37e)]),_0x36d18b[_0x997d7(0x4ba)]=class extends _0x383ca2{constructor(_0x332a86,_0x123093,_0x1306a7,_0x43edb4,_0x68e2c6,_0x28f78f,_0x564abd,_0x58ae9e,_0x5654c7,_0x52c693,_0x4eafbd,_0x4d637d,_0x437cc6){var _0x54ae6d=_0x997d7;super(_0x332a86,_0x123093,_0x1306a7,_0x43edb4,_0x68e2c6,_0x5654c7,_0x4d637d,_0x58ae9e,_0x437cc6),_0x260f1e(this,'status',_0x54ae6d(0x2cc)),_0x260f1e(this,_0x54ae6d(0x2dd),0x0),_0x260f1e(this,_0x54ae6d(0x220)),_0x260f1e(this,'_sender'),(this['_injector']=_0x564abd,this[_0x54ae6d(0x221)]=_0x52c693,this[_0x54ae6d(0x536)]=_0x4eafbd,this[_0x54ae6d(0x450)]=_0x437cc6,_0x28f78f&&(this[_0x54ae6d(0x220)]=_0x28f78f,this[_0x54ae6d(0x25f)]=this[_0x54ae6d(0x220)]['subscribe'](({reqId:_0x3af823,timeout:_0x330ba5})=>{var _0x4377b6=_0x54ae6d;this[_0x4377b6(0x302)](_0x3af823,_0x330ba5);})));}[_0x997d7(0x560)](_0x2db6c0){var _0xbda67a=_0x997d7;return this[_0xbda67a(0x2f8)][_0xbda67a(0x3f6)](_0x2db6c0),this;}[_0x997d7(0x42c)](_0x20d1a2){var _0x780d0=_0x997d7;if(this[_0x780d0(0x27f)](_0x20d1a2))return this[_0x780d0(0x508)](),this['_injector'][_0x780d0(0x55e)](_0x36d18b[_0x780d0(0x310)],this['unitID'],this[_0x780d0(0x3b0)],this[_0x780d0(0x480)],this[_0x780d0(0x2f8)],null,[_0x20d1a2],this[_0x780d0(0x38d)]);try{const _0x161d41=this[_0x780d0(0x536)]['transformChangesets']([_0x20d1a2],[this[_0x780d0(0x480)]],!0x1);if(_0x5a7fdc[_0x780d0(0x3d3)](_0x161d41)){const {c1Prime:_0x5d42d8,c2Prime:_0x35ecfb}=_0x161d41,_0x4eb461=this[_0x780d0(0x536)][_0x780d0(0x576)](_0x5d42d8[0x0],this[_0x780d0(0x2f8)]);if(_0x5a7fdc[_0x780d0(0x260)](_0x4eb461)){const {c1Prime:_0x1cf268,m2Prime:_0x425002}=_0x4eb461;return this[_0x780d0(0x517)](_0x1cf268),_0x35ecfb[0x0][_0x780d0(0x2e9)]=this[_0x780d0(0x352)](),this[_0x780d0(0x508)](),this[_0x780d0(0x30a)][_0x780d0(0x55e)](_0x36d18b['AwaitingWithPendingState'],this[_0x780d0(0x297)],this[_0x780d0(0x3b0)],_0x35ecfb[0x0],_0x425002,this[_0x780d0(0x38d)],void 0x0);}throw _0x4eb461[_0x780d0(0x4ee)];}throw _0x161d41['error'];}catch(_0x4ae5eb){return this[_0x780d0(0x221)][_0x780d0(0x4ee)](_0x4ae5eb),this[_0x780d0(0x2c0)](!0x1);}}['onRemoteAck'](_0x3add83){var _0xba5e86=_0x997d7;if(this[_0xba5e86(0x508)](),this[_0xba5e86(0x27f)](_0x3add83))return this[_0xba5e86(0x30a)][_0xba5e86(0x55e)](_0x36d18b[_0xba5e86(0x310)],this['unitID'],this[_0xba5e86(0x3b0)],null,this[_0xba5e86(0x2f8)],this[_0xba5e86(0x480)],[],this[_0xba5e86(0x38d)]);this[_0xba5e86(0x47f)]();const _0x5976d2=this[_0xba5e86(0x30a)]['createInstance'](_0x36d18b['PendingState'],this['unitID'],this[_0xba5e86(0x3b0)],this[_0xba5e86(0x2f8)],this[_0xba5e86(0x38d)]);return _0x5976d2[_0xba5e86(0x23a)](),_0x5976d2[_0xba5e86(0x2b3)](),_0x5976d2;}['onRemoteRej'](_0x592a51){var _0x5a512b=_0x997d7;return this[_0x5a512b(0x2c0)](!!(_0x592a51!=null&&_0x592a51['isPermissionRej']));}[_0x997d7(0x4db)](_0x140451){var _0x41e85a=_0x997d7;return this['_resendTimeout']>_0x1ed61b?this[_0x41e85a(0x271)]():(this[_0x41e85a(0x220)]=_0x44a4a1(this[_0x41e85a(0x2dd)],{'timeout':this[_0x41e85a(0x2dd)],'reqId':_0x140451[_0x41e85a(0x451)]}),this[_0x41e85a(0x25f)]=this[_0x41e85a(0x220)]['subscribe'](({reqId:_0x18f725,timeout:_0x4068ed})=>{var _0xe5ab9f=_0x41e85a;this[_0xe5ab9f(0x302)](_0x18f725,_0x4068ed);}),this);}['toggleOffline'](){var _0x1bc08e=_0x997d7;return this[_0x1bc08e(0x508)](),this[_0x1bc08e(0x30a)][_0x1bc08e(0x55e)](_0x36d18b['OfflineState'],this[_0x1bc08e(0x297)],this['type'],this[_0x1bc08e(0x480)],this[_0x1bc08e(0x2f8)],this[_0x1bc08e(0x38d)]);}['toggleOnline'](){return this;}['resend'](){var _0x2c222d=_0x997d7;this[_0x2c222d(0x38d)][_0x2c222d(0x314)](this[_0x2c222d(0x480)]);}[_0x997d7(0x2c0)](_0x294649){var _0x4f3b0f=_0x997d7;return this['_clearScheduledTask'](),this[_0x4f3b0f(0x30a)][_0x4f3b0f(0x55e)](_0x36d18b['ConflictState'],this[_0x4f3b0f(0x297)],this[_0x4f3b0f(0x3b0)],null,this['_pendingMutations'],this[_0x4f3b0f(0x38d)],_0x294649);}[_0x997d7(0x302)](_0x31a04e,_0x2c46e8){var _0x3bde3b=_0x997d7,_0x5b2585;_0x31a04e===((_0x5b2585=this[_0x3bde3b(0x480)])==null?void 0x0:_0x5b2585[_0x3bde3b(0x451)])&&(this[_0x3bde3b(0x482)](),this[_0x3bde3b(0x2dd)]=_0x2c46e8===0x0?0x3e8:_0x2c46e8*0x2);}['_clearScheduledTask'](){var _0xb0f7e6=_0x997d7,_0x359f4d;(_0x359f4d=this[_0xb0f7e6(0x25f)])==null||_0x359f4d['unsubscribe'](),this[_0xb0f7e6(0x2dd)]=0x0;}},_0x36d18b['AwaitingWithPendingState']=_0x5c433b([_0x4bdbf6(0x6,_0x29a664[_0x997d7(0x346)](_0x29a664[_0x997d7(0x2c6)])),_0x4bdbf6(0x7,_0x29a664[_0x997d7(0x346)](_0x5a7fdc[_0x997d7(0x424)])),_0x4bdbf6(0x8,_0x29a664[_0x997d7(0x37f)]),_0x4bdbf6(0x9,_0x29a664['ILogService']),_0x4bdbf6(0xa,_0x5a7fdc[_0x997d7(0x4a5)]),_0x4bdbf6(0xb,_0x29a664['IUndoRedoService']),_0x4bdbf6(0xc,_0x29a664['Optional'](_0x3e2be6))],_0x36d18b[_0x997d7(0x4ba)]),_0x36d18b['ConflictState']=class extends _0x383ca2{constructor(_0x1c5db5,_0x35c3f8,_0x5b2f58,_0x3802e2,_0x23f0cd,_0x4ea158=!0x1,_0x50e878,_0x3dad7a,_0x4231d0,_0x5b5c8f,_0x127df1,_0x54987e,_0x163e1b){var _0x4ca719=_0x997d7;super(_0x1c5db5,_0x35c3f8,_0x5b2f58,_0x3802e2,_0x23f0cd,_0x3dad7a,_0x4231d0,_0x5b5c8f,_0x163e1b),_0x260f1e(this,_0x4ca719(0x370),'conflict'),(this[_0x4ca719(0x381)]=_0x4ea158,this['_permissionService']=_0x50e878,this[_0x4ca719(0x389)]=_0x127df1,this['_collaborationUIEventService']=_0x54987e,this['localCacheService']=_0x163e1b,this[_0x4ca719(0x43b)](),this['_clearLocalCache'](),this['_disableEditing']());}[_0x997d7(0x560)](){return this;}['onRemoteChangeset'](){return this;}[_0x997d7(0x4e8)](){return this;}['onRemoteRej'](){return this;}[_0x997d7(0x4db)](){return this;}[_0x997d7(0x271)](){return this;}[_0x997d7(0x317)](){return this;}[_0x997d7(0x482)](){var _0x4ed8c2=_0x997d7;throw new Error(_0x4ed8c2(0x3bc));}[_0x997d7(0x292)](){var _0x1df70f=_0x997d7,_0x1ae0e9;(_0x1ae0e9=this[_0x1df70f(0x2ce)])==null||_0x1ae0e9[_0x1df70f(0x543)](this['unitID'],this['type'],null,[]);}[_0x997d7(0x43b)](){var _0x49c30c=_0x997d7;this[_0x49c30c(0x381)]?this['_collaborationUIEventService'][_0x49c30c(0x2d4)]({'id':_0xedfb31[_0x49c30c(0x2ad)]}):this[_0x49c30c(0x47a)][_0x49c30c(0x2d4)]({'id':_0xedfb31['CONFLICT']});}['_disableEditing'](){var _0x80a748=_0x997d7;this['_permissionService'][_0x80a748(0x56e)](new _0x1ce604[(_0x80a748(0x4e5))](this['unitID'])['id'],!0x1);}},_0x36d18b[_0x997d7(0x445)]=_0x5c433b([_0x4bdbf6(0x6,_0x29a664[_0x997d7(0x346)](_0x29a664['IPermissionService'])),_0x4bdbf6(0x7,_0x29a664[_0x997d7(0x37f)]),_0x4bdbf6(0x8,_0x29a664[_0x997d7(0x232)]),_0x4bdbf6(0x9,_0x29a664[_0x997d7(0x346)](_0x5a7fdc[_0x997d7(0x424)])),_0x4bdbf6(0xa,_0x29a664[_0x997d7(0x346)](_0x29a664[_0x997d7(0x503)])),_0x4bdbf6(0xb,_0x29a664[_0x997d7(0x346)](_0x495958)),_0x4bdbf6(0xc,_0x29a664[_0x997d7(0x29b)](_0x3e2be6))],_0x36d18b['ConflictState']),_0x36d18b[_0x997d7(0x290)]=class extends _0x383ca2{constructor(_0xa8b7b0,_0x3a0a8e,_0x187cce,_0x490ecd,_0x50344a,_0x261c0a,_0x28f307,_0x148518,_0x23b197,_0x3ad4af){var _0x5baa46=_0x997d7;super(_0xa8b7b0,_0x3a0a8e,_0x187cce,_0x490ecd,_0x50344a,_0x148518,_0x23b197,_0x28f307,_0x3ad4af),_0x260f1e(this,_0x5baa46(0x370),'offline'),this[_0x5baa46(0x30a)]=_0x261c0a;}[_0x997d7(0x560)](_0xaf1f36){var _0xcf1815=_0x997d7;return this[_0xcf1815(0x2f8)][_0xcf1815(0x3f6)](_0xaf1f36),this['_updateLocalCache'](),this;}[_0x997d7(0x42c)](_0x3ee95b){var _0x597b82=_0x997d7;throw new Error(_0x597b82(0x309));}[_0x997d7(0x4e8)](){var _0x1c0e1b=_0x997d7;throw new Error(_0x1c0e1b(0x238));}[_0x997d7(0x35a)](){var _0x22a57f=_0x997d7;throw new Error(_0x22a57f(0x33b));}['onRemoteRetry'](){return this;}[_0x997d7(0x271)](){return this;}['toggleOnline'](){var _0x65a5a7=_0x997d7;const {_injector:_0x2c0ee0,_pendingMutations:_0x5837ed,_awaitingChangeset:_0x38eb6c,unitID:_0x3197f7,_handler:_0x2925f0,type:_0x3662fd}=this,_0x2a94b4=_0x163990(_0x2c0ee0,_0x3197f7,_0x3662fd,_0x38eb6c,_0x5837ed,_0x2925f0);return _0x2a94b4 instanceof _0x36d18b[_0x65a5a7(0x265)]?_0x2a94b4[_0x65a5a7(0x23a)]():(_0x2a94b4 instanceof _0x36d18b[_0x65a5a7(0x4ba)]||_0x2a94b4 instanceof _0x36d18b[_0x65a5a7(0x37e)])&&_0x2a94b4[_0x65a5a7(0x482)](),_0x2a94b4;}[_0x997d7(0x482)](){var _0x7a045d=_0x997d7;throw new Error(_0x7a045d(0x3f9));}},_0x36d18b[_0x997d7(0x290)]=_0x5c433b([_0x4bdbf6(0x5,_0x29a664[_0x997d7(0x346)](_0x29a664['Injector'])),_0x4bdbf6(0x6,_0x29a664[_0x997d7(0x346)](_0x5a7fdc[_0x997d7(0x424)])),_0x4bdbf6(0x7,_0x29a664[_0x997d7(0x37f)]),_0x4bdbf6(0x8,_0x29a664[_0x997d7(0x232)]),_0x4bdbf6(0x9,_0x29a664[_0x997d7(0x29b)](_0x3e2be6))],_0x36d18b[_0x997d7(0x290)]),_0x36d18b['FetchingMissState']=class extends _0x383ca2{constructor(_0x243057,_0x1c0889,_0x198c36,_0x5d2768,_0xfa5de6,_0xc64113,_0x28277d,_0x406b8d,_0x1c1d82,_0x140bd1,_0xb4e98,_0x173abb,_0x21bea8,_0x5b1c47){var _0x7b5189=_0x997d7;super(_0x243057,_0x1c0889,_0x198c36,_0x5d2768,_0x28277d,_0xb4e98,_0x173abb,_0x1c1d82,_0x5b1c47),_0x260f1e(this,_0x7b5189(0x370),_0x7b5189(0x254)),(this['_acknowledgedAwaitingChangeset']=_0xfa5de6,this['_queuedRemoteChangesets']=_0xc64113,this[_0x7b5189(0x30a)]=_0x406b8d,this[_0x7b5189(0x221)]=_0x140bd1,this[_0x7b5189(0x536)]=_0x21bea8,this[_0x7b5189(0x450)]=_0x5b1c47);}[_0x997d7(0x403)](_0xf8035){var _0x920344=_0x997d7;try{const _0x9a5eb9=[..._0xf8035,...this[_0x920344(0x3da)]],_0x1813bc=[this['_awaitingChangeset']||this[_0x920344(0x527)]]['filter'](_0x170146=>!!_0x170146);let _0x30631d,_0x436f8c;if(_0x1813bc[_0x920344(0x307)]){const _0x180af0=this[_0x920344(0x536)][_0x920344(0x25e)](_0x9a5eb9,_0x1813bc,!0x1);if(!_0x5a7fdc[_0x920344(0x3d3)](_0x180af0))throw _0x180af0[_0x920344(0x4ee)];_0x30631d=_0x180af0[_0x920344(0x1ec)],_0x436f8c=_0x180af0[_0x920344(0x219)];}else _0x30631d=_0x9a5eb9,_0x436f8c=[];let _0x21cc15=this['_pendingMutations'];_0x30631d[_0x920344(0x2bd)](_0x4632f2=>{var _0x411d10=_0x920344;let _0x2306c1;if(_0x21cc15[_0x411d10(0x307)]){const _0x3bf3d2=this[_0x411d10(0x536)][_0x411d10(0x576)](_0x4632f2,_0x21cc15);if(!_0x5a7fdc[_0x411d10(0x260)](_0x3bf3d2))throw _0x3bf3d2[_0x411d10(0x4ee)];_0x2306c1=_0x3bf3d2[_0x411d10(0x1ec)],_0x21cc15=_0x3bf3d2[_0x411d10(0x2d3)];}else _0x2306c1=_0x4632f2;this[_0x411d10(0x517)](_0x2306c1);}),this[_0x920344(0x527)]&&this[_0x920344(0x47f)](),this[_0x920344(0x480)]&&_0x436f8c[_0x920344(0x307)]&&(_0x436f8c[0x0]['baseRev']=this[_0x920344(0x352)]());let _0x3fd070;if(this[_0x920344(0x480)]&&_0x21cc15[_0x920344(0x307)]!==0x0)_0x3fd070=this['_injector'][_0x920344(0x55e)](_0x36d18b[_0x920344(0x4ba)],this['unitID'],this['type'],_0x436f8c[0x0],_0x21cc15,this[_0x920344(0x38d)],void 0x0);else{if(this[_0x920344(0x480)]&&_0x21cc15['length']===0x0)_0x436f8c[0x0][_0x920344(0x2e9)]=this[_0x920344(0x352)](),_0x3fd070=this['_injector']['createInstance'](_0x36d18b[_0x920344(0x37e)],this['unitID'],this[_0x920344(0x3b0)],_0x436f8c[0x0],this['_handler']);else{if(_0x21cc15['length']!==0x0){const _0x264a88=this[_0x920344(0x30a)][_0x920344(0x55e)](_0x36d18b[_0x920344(0x265)],this[_0x920344(0x297)],this[_0x920344(0x3b0)],_0x21cc15,this[_0x920344(0x38d)]);_0x264a88[_0x920344(0x23a)](),_0x3fd070=_0x264a88;}else _0x3fd070=this[_0x920344(0x30a)][_0x920344(0x55e)](_0x36d18b['SyncedState'],this[_0x920344(0x297)],this[_0x920344(0x3b0)],this[_0x920344(0x38d)]);}}return _0x3fd070['_updateLocalCache'](),_0x3fd070;}catch(_0x3552cb){return this[_0x920344(0x221)][_0x920344(0x4ee)]('[FetchMissState]',_0x920344(0x511),_0x3552cb),this['_injector'][_0x920344(0x55e)](_0x36d18b[_0x920344(0x445)],this['unitID'],this[_0x920344(0x3b0)],this[_0x920344(0x480)],this['_pendingMutations'],this['_handler'],!0x1);}}['resend'](){var _0x41c6e9=_0x997d7;throw new Error(_0x41c6e9(0x3be));}[_0x997d7(0x560)](_0x17375e){var _0x34ce27=_0x997d7;return this['_pendingMutations'][_0x34ce27(0x3f6)](_0x17375e),this;}['onRemoteChangeset'](_0x22c658){var _0x4b4956=_0x997d7;return this[_0x4b4956(0x3da)][_0x4b4956(0x3f6)](_0x22c658),this;}[_0x997d7(0x4e8)](_0x25862a){var _0x2a2e9e=_0x997d7;if(this['_awaitingChangeset'])return this[_0x2a2e9e(0x527)]=this['_awaitingChangeset'],this['_awaitingChangeset']=null,this;throw new Error(_0x2a2e9e(0x56a));}[_0x997d7(0x35a)](_0x12bc06){var _0x515b63=_0x997d7;return this[_0x515b63(0x2c0)](!!(_0x12bc06!=null&&_0x12bc06[_0x515b63(0x3e1)]));}[_0x997d7(0x4db)](){return this;}[_0x997d7(0x271)](){var _0x24bb9e=_0x997d7;return this[_0x24bb9e(0x30a)][_0x24bb9e(0x55e)](_0x36d18b[_0x24bb9e(0x290)],this[_0x24bb9e(0x297)],this[_0x24bb9e(0x3b0)],this[_0x24bb9e(0x480)],this['_pendingMutations'],this[_0x24bb9e(0x38d)]);}['toggleOnline'](){return this;}['_onConflict'](_0x273970){var _0x480a71=_0x997d7;return this[_0x480a71(0x30a)][_0x480a71(0x55e)](_0x36d18b[_0x480a71(0x445)],this['unitID'],this[_0x480a71(0x3b0)],this['_awaitingChangeset'],this[_0x480a71(0x2f8)],this[_0x480a71(0x38d)],_0x273970);}},_0x36d18b[_0x997d7(0x310)]=_0x5c433b([_0x4bdbf6(0x7,_0x29a664[_0x997d7(0x346)](_0x29a664[_0x997d7(0x2c6)])),_0x4bdbf6(0x8,_0x29a664[_0x997d7(0x346)](_0x5a7fdc['RevisionService'])),_0x4bdbf6(0x9,_0x29a664[_0x997d7(0x492)]),_0x4bdbf6(0xa,_0x29a664['ICommandService']),_0x4bdbf6(0xb,_0x29a664['IUndoRedoService']),_0x4bdbf6(0xc,_0x5a7fdc['ITransformService']),_0x4bdbf6(0xd,_0x29a664[_0x997d7(0x29b)](_0x3e2be6))],_0x36d18b[_0x997d7(0x310)]);function _0x163990(_0x4fcc3b,_0xb50f4e,_0x44ed06,_0x15eb57,_0xc9d5c7,_0x23a263){var _0x44adb4=_0x997d7;return _0x15eb57&&_0xc9d5c7['length']?_0x4fcc3b[_0x44adb4(0x55e)](_0x36d18b[_0x44adb4(0x4ba)],_0xb50f4e,_0x44ed06,_0x15eb57,_0xc9d5c7,_0x23a263,void 0x0):_0x15eb57?_0x4fcc3b[_0x44adb4(0x55e)](_0x36d18b[_0x44adb4(0x37e)],_0xb50f4e,_0x44ed06,_0x15eb57,_0x23a263):_0xc9d5c7[_0x44adb4(0x307)]?_0x4fcc3b['createInstance'](_0x36d18b[_0x44adb4(0x265)],_0xb50f4e,_0x44ed06,_0xc9d5c7,_0x23a263):_0x4fcc3b['createInstance'](_0x36d18b[_0x44adb4(0x568)],_0xb50f4e,_0x44ed06,_0x23a263);}var _0x3ad3e0=Object[_0x997d7(0x539)],_0x100945=(_0x5b96a3,_0x1147b8,_0x36fbad,_0x43019d)=>{var _0x2ddd1f=_0x997d7;for(var _0x136046=_0x43019d>0x1?void 0x0:_0x43019d?_0x3ad3e0(_0x1147b8,_0x36fbad):_0x1147b8,_0x13d8ab=_0x5b96a3[_0x2ddd1f(0x307)]-0x1,_0x543a14;_0x13d8ab>=0x0;_0x13d8ab--)(_0x543a14=_0x5b96a3[_0x13d8ab])&&(_0x136046=_0x543a14(_0x136046)||_0x136046);return _0x136046;},_0x5baccc=(_0x213e8c,_0x357e11)=>(_0x183391,_0x123f3a)=>_0x357e11(_0x183391,_0x123f3a,_0x213e8c);_0x36d18b['CollaborationEntity']=class extends _0x29a664[_0x997d7(0x330)]{constructor(_0x353c92,_0x1f4080,_0x5374b9,_0x4652cd,_0x2ecdd3,_0x571034,_0x5337e0,_0x458044,_0xd5b844,_0xdd0779,_0x2d1dc7,_0x3f4dce,_0x244ed3,_0x1ab9cf){var _0x3cba61=_0x997d7;super(),_0x260f1e(this,_0x3cba61(0x224),new _0x32c204['BehaviorSubject'](null)),_0x260f1e(this,_0x3cba61(0x3d9),this['_state$'][_0x3cba61(0x313)]()),_0x260f1e(this,_0x3cba61(0x342)),_0x260f1e(this,_0x3cba61(0x239),!0x1),_0x260f1e(this,_0x3cba61(0x269),''),_0x260f1e(this,_0x3cba61(0x36e),0x0),_0x260f1e(this,_0x3cba61(0x351),this[_0x3cba61(0x3d9)]['pipe'](_0x32c204[_0x3cba61(0x2b1)](_0x1b3c68=>_0x1b3c68?_0x1b3c68[_0x3cba61(0x370)]:_0x54c82e[_0x3cba61(0x3fd)]),_0x32c204['shareReplay'](0x1))),_0x260f1e(this,_0x3cba61(0x3ec),!0x1),_0x260f1e(this,_0x3cba61(0x256),[]),(this[_0x3cba61(0x297)]=_0x353c92,this['session']=_0x1f4080,this[_0x3cba61(0x31d)]=_0x5374b9,this['_injector']=_0x4652cd,this[_0x3cba61(0x1ef)]=_0x2ecdd3,this[_0x3cba61(0x389)]=_0x571034,this['_revisionService']=_0x5337e0,this[_0x3cba61(0x2e5)]=_0x458044,this['_univerInstanceService']=_0xd5b844,this['_logService']=_0xdd0779,this[_0x3cba61(0x2dc)]=_0x2d1dc7,this[_0x3cba61(0x412)]=_0x3f4dce,this[_0x3cba61(0x3e0)]=_0x244ed3,this[_0x3cba61(0x2ce)]=_0x1ab9cf);}get[_0x997d7(0x31a)](){var _0x1196cc=_0x997d7;return this[_0x1196cc(0x342)];}async[_0x997d7(0x369)](){var _0x45942=_0x997d7;if(this[_0x45942(0x31a)])throw new Error(_0x45942(0x2e2));await this[_0x45942(0x275)]();}[_0x997d7(0x382)](){var _0x4793af=_0x997d7;return this[_0x4793af(0x239)]=!0x0,_0x29a664['toDisposable'](()=>{var _0x9e94d9=_0x4793af;this[_0x9e94d9(0x239)]=!0x1,this['_exhaustRemoteChangesetQueue']();});}[_0x997d7(0x237)](_0x43c4c1){var _0x32a89e=_0x997d7;this[_0x32a89e(0x2ed)](_0x43c4c1);}[_0x997d7(0x452)](_0x30836f){var _0x29f83c=_0x997d7;this['_state']=_0x30836f,this[_0x29f83c(0x224)][_0x29f83c(0x476)](_0x30836f);}async[_0x997d7(0x275)](){var _0x210090=_0x997d7,_0x1bbeae;this['_updateState'](await this[_0x210090(0x4f0)]()),this[_0x210090(0x3e0)]&&((_0x1bbeae=this['_singleActiveUnitService'])==null||_0x1bbeae[_0x210090(0x294)](this['unitID']),this[_0x210090(0x31b)](this[_0x210090(0x3e0)]['getUnitStatus$'](this[_0x210090(0x297)])[_0x210090(0x3cc)](_0xe4b941=>{var _0x60b767=_0x210090;this[_0x60b767(0x221)][_0x60b767(0x1ff)](_0x60b767(0x359),'editing\x20status\x20changed\x20to',_0xe4b941),_0xe4b941===_0x4ff042[_0x60b767(0x3f7)]?(this[_0x60b767(0x2e5)]['emitEvent']({'id':_0xedfb31[_0x60b767(0x477)]}),this['_permissionService'][_0x60b767(0x56e)](new _0x1ce604[(_0x60b767(0x4e5))](this[_0x60b767(0x297)])['id'],!0x1),this[_0x60b767(0x412)][_0x60b767(0x26a)](!0x1)):(this[_0x60b767(0x412)][_0x60b767(0x56e)](new _0x1ce604[(_0x60b767(0x4e5))](this[_0x60b767(0x297)])['id'],!0x0),this[_0x60b767(0x412)]['setShowComponents'](!0x0));})));let _0x4a49ba=!0x1;return this[_0x210090(0x31b)](this['session'][_0x210090(0x40f)][_0x210090(0x3cc)](_0x36e382=>{var _0x5ad819=_0x210090;_0x36e382===_0xbd299[_0x5ad819(0x42b)]?this[_0x5ad819(0x331)](_0x4a49ba):_0x36e382===_0xbd299[_0x5ad819(0x3fd)]&&(_0x4a49ba=!0x0,this[_0x5ad819(0x4f5)]());})),this[_0x210090(0x31b)](this[_0x210090(0x28d)][_0x210090(0x25c)][_0x210090(0x3cc)](_0x260228=>{var _0x128238=_0x210090;try{switch(_0x260228[_0x128238(0x328)]){case _0x5a7fdc[_0x128238(0x315)][_0x128238(0x257)]:{this[_0x128238(0x2c9)](_0x5a7fdc[_0x128238(0x3ba)](_0x260228[_0x128238(0x40b)]));break;}case _0x5a7fdc[_0x128238(0x315)][_0x128238(0x243)]:{this[_0x128238(0x334)](_0x260228[_0x128238(0x40b)]);break;}case _0x5a7fdc[_0x128238(0x315)][_0x128238(0x2ac)]:{this[_0x128238(0x54c)]();break;}case _0x5a7fdc['CollaborationEvent']['CHANGESET_SHOULD_RETRY']:{this['_onRemoteRetry'](_0x260228[_0x128238(0x40b)]);break;}case _0x5a7fdc[_0x128238(0x315)][_0x128238(0x2c8)]:{this[_0x128238(0x4dc)](_0x260228['data'][_0x128238(0x414)][_0x128238(0x2b1)](_0x335442=>_0x5a7fdc[_0x128238(0x3ba)](_0x335442)));break;}case _0x5a7fdc[_0x128238(0x315)][_0x128238(0x51d)]:{this[_0x128238(0x54c)]({'isPermissionRej':!0x0});break;}case _0x5a7fdc[_0x128238(0x315)][_0x128238(0x483)]:break;}}catch(_0x385b14){throw console['error'](_0x128238(0x384),_0x385b14),_0x385b14;}})),this[_0x210090(0x342)];}[_0x997d7(0x397)](){var _0x244987=_0x997d7;this[_0x244987(0x3ec)]=!0x1;}[_0x997d7(0x481)](){var _0xacd0ba=_0x997d7;if(this['_transitionLocked'])throw new Error(_0xacd0ba(0x2b7));this[_0xacd0ba(0x3ec)]=!0x0;}[_0x997d7(0x2ed)](_0x306ab4){var _0x43e29e=_0x997d7;this[_0x43e29e(0x481)](),this[_0x43e29e(0x452)](this[_0x43e29e(0x342)][_0x43e29e(0x560)](_0x306ab4)),this['_unlockTransition']();}[_0x997d7(0x2c9)](_0xdd170d){var _0x4dfcaa=_0x997d7;if(!(_0xdd170d[_0x4dfcaa(0x295)]<=this[_0x4dfcaa(0x4da)][_0x4dfcaa(0x4e4)](this['unitID']))){if(this[_0x4dfcaa(0x239)]){this[_0x4dfcaa(0x256)][_0x4dfcaa(0x3f6)](_0xdd170d);return;}this['_applyRemoteChangeset'](_0xdd170d);}}[_0x997d7(0x335)](){var _0x137c9a=_0x997d7;this['_remoteChangesetQueue'][_0x137c9a(0x2bd)](_0xdd862e=>this[_0x137c9a(0x2b8)](_0xdd862e)),this[_0x137c9a(0x256)]=[];}['_applyRemoteChangeset'](_0x4ea887){var _0x557a12=_0x997d7;const _0x584cd0=this['_compressMutationService'][_0x557a12(0x4b9)][_0x557a12(0x468)](this[_0x557a12(0x1ef)][_0x557a12(0x4b9)]['getInterceptPoints']()[_0x557a12(0x513)])(_0x4ea887[_0x557a12(0x2af)],null)||_0x4ea887[_0x557a12(0x2af)],_0x2a5267={..._0x4ea887,'mutations':_0x584cd0};this[_0x557a12(0x481)](),this['_updateState'](this[_0x557a12(0x342)]['onRemoteChangeset'](_0x2a5267)),this[_0x557a12(0x397)]();}[_0x997d7(0x334)](_0xf5df97){var _0x308652=_0x997d7;this[_0x308652(0x481)](),this[_0x308652(0x452)](this[_0x308652(0x342)][_0x308652(0x4e8)](_0xf5df97)),this[_0x308652(0x397)]();}[_0x997d7(0x54c)](_0x5de156){var _0x4d16cf=_0x997d7;this[_0x4d16cf(0x481)](),this[_0x4d16cf(0x452)](this['_state']['onRemoteRej'](_0x5de156)),this[_0x4d16cf(0x397)]();}['_onRemoteRetry'](_0x1dd90e){var _0x336d9f=_0x997d7;this[_0x336d9f(0x481)](),this[_0x336d9f(0x452)](this[_0x336d9f(0x342)]['onRemoteRetry'](_0x1dd90e)),this[_0x336d9f(0x397)]();}[_0x997d7(0x4dc)](_0x4b69d4){var _0x569f55=_0x997d7;if(!(this[_0x569f55(0x342)]instanceof _0x36d18b['FetchingMissState']))throw new TypeError('[CollaborationEntity]:\x20cannot\x20apply\x20missing\x20results\x20on\x20other\x20states!');const _0x2f8fd6=_0x4b69d4[_0x569f55(0x2b1)](_0xd42d5a=>{var _0x9e4b28=_0x569f55;const _0x553b84=this['_compressMutationService'][_0x9e4b28(0x4b9)][_0x9e4b28(0x468)](this[_0x9e4b28(0x1ef)][_0x9e4b28(0x4b9)][_0x9e4b28(0x2d1)]()[_0x9e4b28(0x513)])(_0xd42d5a[_0x9e4b28(0x2af)],null)||_0xd42d5a[_0x9e4b28(0x2af)];return{..._0xd42d5a,'mutations':_0x553b84};});this['_lockTransition'](),this[_0x569f55(0x452)](this[_0x569f55(0x342)][_0x569f55(0x403)](_0x2f8fd6)),this['_unlockTransition']();}[_0x997d7(0x4f5)](){var _0xd508d2=_0x997d7;this[_0xd508d2(0x481)](),this['_updateState'](this[_0xd508d2(0x342)][_0xd508d2(0x271)]()),this['_unlockTransition']();}[_0x997d7(0x331)](_0xf60a67=!0x1){var _0x5f2496=_0x997d7;this[_0x5f2496(0x481)](),this[_0x5f2496(0x452)](this[_0x5f2496(0x342)][_0x5f2496(0x317)]()),this[_0x5f2496(0x397)]();const _0x9aba55=this[_0x5f2496(0x342)];_0xf60a67&&_0x9aba55 instanceof _0x36d18b[_0x5f2496(0x568)]&&(this[_0x5f2496(0x481)](),this[_0x5f2496(0x452)](_0x9aba55[_0x5f2496(0x528)]()),this[_0x5f2496(0x397)]());}async[_0x997d7(0x4f0)](){return new Promise(_0x57a318=>{var _0xa4e792=_0x4ecd;this['session'][_0xa4e792(0x40f)]['pipe'](_0x32c204['take'](0x1))[_0xa4e792(0x3cc)](async _0x4007f8=>{var _0x792e5f=_0xa4e792;_0x57a318(await this[_0x792e5f(0x4e7)](_0x4007f8===_0xbd299[_0x792e5f(0x42b)]));});});}[_0x997d7(0x3cf)](){const _0x6b007b=this['unitID'];return{'onStateChange':(_0x206cad,_0x388bda)=>{var _0x230708=_0x4ecd;if(_0x206cad!==this[_0x230708(0x342)])throw new Error(_0x230708(0x506)+_0x206cad[_0x230708(0x370)]+_0x230708(0x45c)+_0x388bda[_0x230708(0x370)]+_0x230708(0x418)+this['_state'][_0x230708(0x370)]);this[_0x230708(0x452)](_0x388bda);},'onSendChangeset':_0x581e23=>{var _0x25a3cc=_0x4ecd;_0x581e23['sid']||(_0x581e23[_0x25a3cc(0x2eb)]=this[_0x25a3cc(0x269)],_0x581e23[_0x25a3cc(0x451)]=++this[_0x25a3cc(0x36e)]);const _0x3fadde={'eventID':_0x5a7fdc[_0x25a3cc(0x315)][_0x25a3cc(0x48e)],'data':{'unitID':_0x581e23[_0x25a3cc(0x297)],'unitType':this['_type'],'changeset':_0x581e23,'memberID':this[_0x25a3cc(0x28d)][_0x25a3cc(0x2f1)]()}};this[_0x25a3cc(0x28d)]['send'](_0x3fadde,this[_0x25a3cc(0x297)]);},'onMissingChangesets':({from:_0x2ddc72,to:_0x4d35c8})=>{var _0x104949=_0x4ecd;this[_0x104949(0x221)][_0x104949(0x1ff)]('[CollaborationEntity]',_0x104949(0x494)+_0x2ddc72+_0x104949(0x29f)+_0x4d35c8);const _0x49b724={'eventID':_0x5a7fdc[_0x104949(0x315)][_0x104949(0x4f3)],'data':{'unitID':_0x6b007b,'unitType':this['_type'],'from':_0x2ddc72,'to':_0x4d35c8}};this['session'][_0x104949(0x4ea)](_0x49b724,this[_0x104949(0x297)]);}};}async[_0x997d7(0x4e7)](_0x374f5){var _0x69f7cf=_0x997d7,_0x3c1b31,_0x408f13,_0x59bc24;const _0x3a6960=await((_0x3c1b31=this[_0x69f7cf(0x2ce)])==null?void 0x0:_0x3c1b31[_0x69f7cf(0x4b3)](this[_0x69f7cf(0x297)])),_0x239b23=(_0x408f13=_0x3a6960==null?void 0x0:_0x3a6960[_0x69f7cf(0x2af)])!=null?_0x408f13:[],_0x5a400e=(_0x59bc24=_0x3a6960==null?void 0x0:_0x3a6960[_0x69f7cf(0x4f2)])!=null?_0x59bc24:null,_0x12e105=!!(_0x5a400e!=null&&_0x5a400e['sid'])&&!!(_0x5a400e!=null&&_0x5a400e[_0x69f7cf(0x451)]);this[_0x69f7cf(0x269)]=_0x12e105?_0x5a400e['sid']:_0x5a7fdc[_0x69f7cf(0x2da)](),this[_0x69f7cf(0x36e)]=_0x12e105?_0x5a400e[_0x69f7cf(0x451)]:0x0;const _0x4f8609=this['unitID'];try{this['_replayCachedMutations'](_0x5a400e,_0x239b23);}catch(_0x337763){this[_0x69f7cf(0x221)][_0x69f7cf(0x4ee)](_0x337763);}const _0x3d8459=this[_0x69f7cf(0x3cf)]();if(_0x374f5){const _0x54bc2e=_0x163990(this[_0x69f7cf(0x30a)],_0x4f8609,this[_0x69f7cf(0x31d)],_0x5a400e,_0x239b23,_0x3d8459);return _0x54bc2e instanceof _0x36d18b[_0x69f7cf(0x265)]?_0x54bc2e['_schedule']():(_0x54bc2e instanceof _0x36d18b[_0x69f7cf(0x4ba)]||_0x54bc2e instanceof _0x36d18b[_0x69f7cf(0x37e)])&&_0x54bc2e[_0x69f7cf(0x482)](),_0x54bc2e;}return this[_0x69f7cf(0x30a)][_0x69f7cf(0x55e)](_0x36d18b['OfflineState'],_0x4f8609,this['_type'],_0x5a400e,_0x239b23,_0x3d8459);}[_0x997d7(0x54e)](_0xf44711,_0x2e29ec){var _0x200b20=_0x997d7,_0x3521fa,_0x7bc0eb;const _0x1d7b07=this[_0x200b20(0x1ef)][_0x200b20(0x4b9)][_0x200b20(0x468)](this['_compressMutationService'][_0x200b20(0x4b9)][_0x200b20(0x2d1)]()[_0x200b20(0x513)]);(_0x3521fa=_0x1d7b07((_0xf44711==null?void 0x0:_0xf44711[_0x200b20(0x2af)])||[],null))==null||_0x3521fa[_0x200b20(0x2bd)](_0x143beb=>this['_commandService'][_0x200b20(0x459)](_0x143beb['id'],_0x143beb[_0x200b20(0x200)])),(_0x7bc0eb=_0x1d7b07(_0x2e29ec||[],null))==null||_0x7bc0eb['forEach'](_0x33bb81=>this[_0x200b20(0x2dc)][_0x200b20(0x459)](_0x33bb81['id'],_0x33bb81[_0x200b20(0x200)]));}},_0x36d18b[_0x997d7(0x430)]=_0x100945([_0x5baccc(0x3,_0x29a664[_0x997d7(0x346)](_0x29a664[_0x997d7(0x2c6)])),_0x5baccc(0x4,_0x29a664[_0x997d7(0x346)](_0x5a7fdc[_0x997d7(0x2fe)])),_0x5baccc(0x5,_0x29a664[_0x997d7(0x346)](_0x29a664[_0x997d7(0x503)])),_0x5baccc(0x6,_0x29a664['Inject'](_0x5a7fdc[_0x997d7(0x424)])),_0x5baccc(0x7,_0x29a664[_0x997d7(0x346)](_0x495958)),_0x5baccc(0x8,_0x29a664[_0x997d7(0x208)]),_0x5baccc(0x9,_0x29a664[_0x997d7(0x492)]),_0x5baccc(0xa,_0x29a664['ICommandService']),_0x5baccc(0xb,_0x29a664['IPermissionService']),_0x5baccc(0xc,_0x29a664[_0x997d7(0x29b)](_0x4f3087)),_0x5baccc(0xd,_0x29a664['Optional'](_0x3e2be6))],_0x36d18b[_0x997d7(0x430)]),_0x36d18b['DocCollaborationEntity']=class extends _0x36d18b[_0x997d7(0x430)]{constructor(_0x176100,_0x57b735,_0x3ebe59,_0x320fc0,_0x296ada,_0x3ab41a,_0x2e5d01,_0x17617b,_0x5bbac1,_0x2efb3f,_0x1b3459,_0x52965b,_0x20489a,_0x30587d){var _0x1f0b06=_0x997d7;super(_0x176100,_0x3ebe59,_0x57b735,_0x320fc0,_0x296ada,_0x3ab41a,_0x2e5d01,_0x17617b,_0x5bbac1,_0x2efb3f,_0x1b3459,_0x52965b,_0x20489a,_0x30587d),_0x260f1e(this,_0x1f0b06(0x2f9),null),(this[_0x1f0b06(0x297)]=_0x176100,this[_0x1f0b06(0x3b0)]=_0x57b735);}[_0x997d7(0x533)](_0x438161){var _0x82ac93=_0x997d7;this[_0x82ac93(0x2f9)]=_0x438161;}['dispose'](){var _0x4d28c4=_0x997d7;this[_0x4d28c4(0x2f9)]=null,super['dispose']();}[_0x997d7(0x3cf)](){var _0x19168f=_0x997d7;const _0x41e8e9=super['_createHandler']();return _0x41e8e9[_0x19168f(0x3b9)]=_0x43b26b=>{var _0x5a88b3=_0x19168f,_0x24a622,_0x599b87;return(_0x599b87=(_0x24a622=this['_handlerCallback'])==null?void 0x0:_0x24a622[_0x5a88b3(0x3b9)])==null?void 0x0:_0x599b87['call'](_0x24a622,_0x43b26b);},_0x41e8e9[_0x19168f(0x3a5)]=_0x338f61=>{var _0x258220=_0x19168f,_0x54cb07,_0x489987;return(_0x489987=(_0x54cb07=this[_0x258220(0x2f9)])==null?void 0x0:_0x54cb07['onTransformState'])==null?void 0x0:_0x489987[_0x258220(0x23d)](_0x54cb07,_0x338f61);},_0x41e8e9['onTransformSelections']=_0x322aaa=>{var _0x4dfa98=_0x19168f,_0x14245c,_0x6c2221;return(_0x6c2221=(_0x14245c=this[_0x4dfa98(0x2f9)])==null?void 0x0:_0x14245c[_0x4dfa98(0x2a9)])==null?void 0x0:_0x6c2221[_0x4dfa98(0x23d)](_0x14245c,_0x322aaa);},_0x41e8e9[_0x19168f(0x28e)]=_0x56776b=>{var _0x173b59=_0x19168f,_0x314abe,_0x2a2e13;return(_0x2a2e13=(_0x314abe=this[_0x173b59(0x2f9)])==null?void 0x0:_0x314abe[_0x173b59(0x28e)])==null?void 0x0:_0x2a2e13[_0x173b59(0x23d)](_0x314abe,_0x56776b);},_0x41e8e9['onTransformRemoteChangesetByIMECache']=_0x5675ad=>{var _0x8cdff8=_0x19168f,_0x58ec71,_0x540fd5,_0xf403c4;if(!((_0x58ec71=this[_0x8cdff8(0x2f9)])!=null&&_0x58ec71[_0x8cdff8(0x40d)]))throw new Error(_0x8cdff8(0x24d));return(_0xf403c4=(_0x540fd5=this[_0x8cdff8(0x2f9)])==null?void 0x0:_0x540fd5['onTransformRemoteChangesetByIMECache'])==null?void 0x0:_0xf403c4[_0x8cdff8(0x23d)](_0x540fd5,_0x5675ad);},_0x41e8e9[_0x19168f(0x49d)]=_0xd3e856=>{var _0x5a98c6=_0x19168f,_0x3d464e,_0x4dd0bb,_0x341bea;if(!((_0x3d464e=this[_0x5a98c6(0x2f9)])!=null&&_0x3d464e[_0x5a98c6(0x49d)]))throw new Error(_0x5a98c6(0x4f4));return(_0x341bea=(_0x4dd0bb=this['_handlerCallback'])==null?void 0x0:_0x4dd0bb['onTransformRemoteChangesetByStateCache'])==null?void 0x0:_0x341bea[_0x5a98c6(0x23d)](_0x4dd0bb,_0xd3e856);},_0x41e8e9;}async[_0x997d7(0x275)](){var _0x3d33b0=_0x997d7;const _0x23bb61=await super['_init']();return this[_0x3d33b0(0x31b)](this[_0x3d33b0(0x2dc)][_0x3d33b0(0x39b)]((_0x25bda4,_0x386fe4)=>{var _0x5ae2c8=_0x3d33b0;if(_0x25bda4[_0x5ae2c8(0x3b0)]!==_0x29a664['CommandType']['MUTATION']||_0x386fe4!=null&&_0x386fe4[_0x5ae2c8(0x266)]||_0x386fe4!=null&&_0x386fe4[_0x5ae2c8(0x55b)]||_0x25bda4['id']===_0x438bd6['RichTextEditingMutation']['id'])return;const _0xb99959=_0x25bda4[_0x5ae2c8(0x200)];if((_0xb99959==null?void 0x0:_0xb99959['unitId'])!==this[_0x5ae2c8(0x297)])return;const _0xe0859a=_0x25bda4,_0x3169db=this[_0x5ae2c8(0x1ef)][_0x5ae2c8(0x4b9)][_0x5ae2c8(0x468)](this['_compressMutationService'][_0x5ae2c8(0x4b9)]['getInterceptPoints']()[_0x5ae2c8(0x321)])([_0xe0859a],this[_0x5ae2c8(0x432)])||[_0xe0859a];this[_0x5ae2c8(0x2ed)](_0x3169db[0x0]);})),_0x23bb61;}},_0x36d18b[_0x997d7(0x522)]=_0x100945([_0x5baccc(0x3,_0x29a664[_0x997d7(0x346)](_0x29a664[_0x997d7(0x2c6)])),_0x5baccc(0x4,_0x29a664[_0x997d7(0x346)](_0x5a7fdc[_0x997d7(0x2fe)])),_0x5baccc(0x5,_0x29a664[_0x997d7(0x346)](_0x29a664[_0x997d7(0x503)])),_0x5baccc(0x6,_0x29a664[_0x997d7(0x346)](_0x5a7fdc[_0x997d7(0x424)])),_0x5baccc(0x7,_0x29a664[_0x997d7(0x346)](_0x495958)),_0x5baccc(0x8,_0x29a664[_0x997d7(0x208)]),_0x5baccc(0x9,_0x29a664[_0x997d7(0x492)]),_0x5baccc(0xa,_0x29a664[_0x997d7(0x37f)]),_0x5baccc(0xb,_0x29a664[_0x997d7(0x471)]),_0x5baccc(0xc,_0x29a664[_0x997d7(0x29b)](_0x4f3087)),_0x5baccc(0xd,_0x29a664['Optional'](_0x3e2be6))],_0x36d18b['DocCollaborationEntity']),_0x36d18b['SheetCollaborationEntity']=class extends _0x36d18b[_0x997d7(0x430)]{constructor(_0x28d6df,_0x4a8293,_0x473e80,_0x58eef5,_0x156867,_0x223dea,_0x436e5c,_0x8a8cc0,_0x3aa194,_0x10cceb,_0x181a5e,_0x4b6fd8,_0x51d577,_0x46004a,_0x3390f7){var _0x100028=_0x997d7;super(_0x28d6df,_0x473e80,_0x4a8293,_0x58eef5,_0x156867,_0x223dea,_0x436e5c,_0x3aa194,_0x10cceb,_0x181a5e,_0x4b6fd8,_0x51d577,_0x46004a,_0x3390f7),this[_0x100028(0x297)]=_0x28d6df,this[_0x100028(0x3b0)]=_0x4a8293,this[_0x100028(0x333)]=_0x8a8cc0;}['_createHandler'](){var _0x312ab1=_0x997d7;const _0x4de053=super[_0x312ab1(0x3cf)]();return _0x4de053['onTransformSelections']=_0x3d62ef=>this[_0x312ab1(0x333)][_0x312ab1(0x440)](_0x3d62ef),_0x4de053;}async[_0x997d7(0x275)](){var _0xa04aa8=_0x997d7;const _0x49d3a7=await super['_init']();return this['disposeWithMe'](this[_0xa04aa8(0x2dc)]['onCommandExecuted']((_0x88aec2,_0x1422ce)=>{var _0x26d4d3=_0xa04aa8;if(_0x88aec2['type']!==_0x29a664[_0x26d4d3(0x567)][_0x26d4d3(0x2b5)]||_0x1422ce!=null&&_0x1422ce[_0x26d4d3(0x266)]||_0x1422ce!=null&&_0x1422ce[_0x26d4d3(0x55b)])return;const _0x21eede=_0x88aec2['params'];if((_0x21eede==null?void 0x0:_0x21eede[_0x26d4d3(0x441)])!==this[_0x26d4d3(0x297)])return;const _0xcec95a=_0x88aec2,_0x2bc742=this[_0x26d4d3(0x1ef)][_0x26d4d3(0x4b9)]['fetchThroughInterceptors'](this['_compressMutationService'][_0x26d4d3(0x4b9)][_0x26d4d3(0x2d1)]()[_0x26d4d3(0x321)])([_0xcec95a],this[_0x26d4d3(0x432)])||[_0xcec95a];this[_0x26d4d3(0x2ed)](_0x2bc742[0x0]);})),_0x49d3a7;}},_0x36d18b[_0x997d7(0x454)]=_0x100945([_0x5baccc(0x3,_0x29a664[_0x997d7(0x346)](_0x29a664['Injector'])),_0x5baccc(0x4,_0x29a664[_0x997d7(0x346)](_0x5a7fdc[_0x997d7(0x2fe)])),_0x5baccc(0x5,_0x29a664[_0x997d7(0x346)](_0x29a664['LocaleService'])),_0x5baccc(0x6,_0x29a664[_0x997d7(0x346)](_0x5a7fdc[_0x997d7(0x424)])),_0x5baccc(0x7,_0x29a664[_0x997d7(0x346)](_0x36d18b[_0x997d7(0x415)])),_0x5baccc(0x8,_0x29a664[_0x997d7(0x346)](_0x495958)),_0x5baccc(0x9,_0x29a664[_0x997d7(0x208)]),_0x5baccc(0xa,_0x29a664[_0x997d7(0x492)]),_0x5baccc(0xb,_0x29a664['ICommandService']),_0x5baccc(0xc,_0x29a664[_0x997d7(0x471)]),_0x5baccc(0xd,_0x29a664['Optional'](_0x4f3087)),_0x5baccc(0xe,_0x29a664['Optional'](_0x3e2be6))],_0x36d18b[_0x997d7(0x454)]);const _0x3b1d7a=_0x29a664[_0x997d7(0x38e)](_0x997d7(0x4eb));function _0x5a583b(_0x1c49c1){var _0x4f4895=_0x997d7,_0x5125f1,_0x4261ce,_0x1e4b97,_0x39c512,_0x1b286a;const _0x163f03=_0x1c49c1[_0x4f4895(0x40b)],_0x2486b5=JSON[_0x4f4895(0x487)](_0x163f03);switch(_0x2486b5[_0x4f4895(0x235)]){case _0x1f168c['HEARTBEAT']:case _0x1f168c['HELLO']:{const _0x104b56=_0x2486b5[_0x4f4895(0x473)];return{..._0x2486b5,'data':_0x104b56,'cmd':_0x2486b5[_0x4f4895(0x235)]};}case _0x1f168c[_0x4f4895(0x32a)]:{const _0xfd3f96=_0x2486b5[_0x4f4895(0x44f)];return{..._0x2486b5,'data':_0xfd3f96,'cmd':_0x2486b5[_0x4f4895(0x235)]};}case _0x1f168c[_0x4f4895(0x3e6)]:{const _0x301f48=_0x2486b5[_0x4f4895(0x4d0)];switch(_0x301f48[_0x4f4895(0x328)]){case _0x5a7fdc[_0x4f4895(0x315)]['PERMISSION_REJ']:return{..._0x2486b5,'data':{..._0x301f48,'data':(_0x5125f1=_0x301f48[_0x4f4895(0x4bb)])==null?void 0x0:_0x5125f1['cs']},'cmd':_0x2486b5[_0x4f4895(0x235)]};case _0x5a7fdc[_0x4f4895(0x315)]['CHANGESET_ACK']:return{..._0x2486b5,'data':{..._0x301f48,'data':(_0x4261ce=_0x301f48['csAckEvent'])==null?void 0x0:_0x4261ce['cs']},'cmd':_0x2486b5[_0x4f4895(0x235)]};case _0x5a7fdc['CollaborationEvent'][_0x4f4895(0x257)]:return{..._0x2486b5,'data':{..._0x301f48,'data':(_0x1e4b97=_0x301f48[_0x4f4895(0x519)])==null?void 0x0:_0x1e4b97['cs']},'cmd':_0x2486b5[_0x4f4895(0x235)]};case _0x5a7fdc[_0x4f4895(0x315)][_0x4f4895(0x2ac)]:return{..._0x2486b5,'data':{..._0x301f48,'data':(_0x39c512=_0x301f48[_0x4f4895(0x30c)])==null?void 0x0:_0x39c512['cs']},'cmd':_0x2486b5[_0x4f4895(0x235)]};case _0x5a7fdc['CollaborationEvent']['CHANGESET_SHOULD_RETRY']:return{..._0x2486b5,'data':{..._0x301f48,'data':(_0x1b286a=_0x301f48[_0x4f4895(0x396)])==null?void 0x0:_0x1b286a['cs']},'cmd':_0x2486b5[_0x4f4895(0x235)]};case _0x5a7fdc[_0x4f4895(0x315)][_0x4f4895(0x4f8)]:return{..._0x2486b5,'data':{..._0x301f48,'data':_0x301f48['updateCursorEvent']},'cmd':_0x2486b5[_0x4f4895(0x235)]};case _0x5a7fdc['CollaborationEvent'][_0x4f4895(0x4b8)]:return{..._0x2486b5,'data':{..._0x301f48,'data':_0x301f48[_0x4f4895(0x27a)]},'cmd':_0x2486b5[_0x4f4895(0x235)]};case _0x5a7fdc[_0x4f4895(0x315)][_0x4f4895(0x47b)]:return{..._0x2486b5,'data':{..._0x301f48,'data':_0x301f48[_0x4f4895(0x51f)]},'cmd':_0x2486b5[_0x4f4895(0x235)]};case _0x5a7fdc[_0x4f4895(0x315)][_0x4f4895(0x390)]:return{..._0x2486b5,'data':{..._0x301f48,'data':_0x301f48['liveShareNewHost']},'cmd':_0x2486b5[_0x4f4895(0x235)]};case _0x5a7fdc[_0x4f4895(0x315)]['LIVESHARE_FETCH_OPERATIONS']:case _0x5a7fdc[_0x4f4895(0x315)][_0x4f4895(0x4d8)]:return{..._0x2486b5,'data':{..._0x301f48,'data':_0x301f48[_0x4f4895(0x462)]},'cmd':_0x2486b5[_0x4f4895(0x235)]};case _0x5a7fdc['CollaborationEvent']['LIVESHARE_TERMINATE']:return{..._0x2486b5,'data':{..._0x301f48,'data':_0x301f48[_0x4f4895(0x427)]},'cmd':_0x2486b5[_0x4f4895(0x235)]};case _0x5a7fdc['CollaborationEvent']['MSG_FOR_ERROR']:return{..._0x2486b5,'data':_0x301f48,'cmd':_0x2486b5[_0x4f4895(0x235)]};case _0x5a7fdc[_0x4f4895(0x315)][_0x4f4895(0x2a2)]:return{..._0x2486b5,'data':{..._0x301f48,'data':_0x301f48[_0x4f4895(0x348)]},'cmd':_0x2486b5[_0x4f4895(0x235)]};case _0x5a7fdc[_0x4f4895(0x315)][_0x4f4895(0x4c1)]:return{..._0x2486b5,'data':{..._0x301f48,'data':_0x301f48[_0x4f4895(0x45d)]},'cmd':_0x2486b5[_0x4f4895(0x235)]};case _0x5a7fdc[_0x4f4895(0x315)][_0x4f4895(0x35e)]:return{..._0x2486b5,'data':{..._0x301f48,'data':_0x301f48['shouldCloseConn']},'cmd':_0x2486b5[_0x4f4895(0x235)]};case _0x5a7fdc[_0x4f4895(0x315)]['UNISCRIPT_RUN']:return{..._0x2486b5,'data':{..._0x301f48,'data':_0x301f48[_0x4f4895(0x264)]},'cmd':_0x2486b5[_0x4f4895(0x235)]};default:return _0x2486b5;}}default:return _0x2486b5;}}function _0x4151ad(_0x4b8c85){var _0x3829c7=_0x997d7;switch(_0x4b8c85[_0x3829c7(0x235)]){case _0x1f168c[_0x3829c7(0x230)]:case _0x1f168c[_0x3829c7(0x556)]:return JSON['stringify']({'cmd':_0x4b8c85[_0x3829c7(0x235)],'routeKey':_0x4b8c85['routeKey']});case _0x1f168c[_0x3829c7(0x55a)]:{let _0x1afaa6;switch(_0x4b8c85[_0x3829c7(0x40b)][_0x3829c7(0x328)]){case _0x5a7fdc[_0x3829c7(0x315)][_0x3829c7(0x4f8)]:{_0x1afaa6={'eventID':_0x5a7fdc['CollaborationEvent'][_0x3829c7(0x4f8)],'updateCursorEvent':_0x4b8c85[_0x3829c7(0x40b)][_0x3829c7(0x40b)]};break;}case _0x5a7fdc[_0x3829c7(0x315)][_0x3829c7(0x47b)]:{_0x1afaa6={'eventID':_0x5a7fdc[_0x3829c7(0x315)][_0x3829c7(0x47b)],'leaveEvent':_0x4b8c85[_0x3829c7(0x40b)][_0x3829c7(0x40b)]};break;}case _0x5a7fdc['CollaborationEvent']['USERS_ENTER']:{_0x1afaa6={'eventID':_0x5a7fdc[_0x3829c7(0x315)][_0x3829c7(0x4b8)],'joinEvent':_0x4b8c85[_0x3829c7(0x40b)][_0x3829c7(0x40b)]};break;}case _0x5a7fdc[_0x3829c7(0x315)][_0x3829c7(0x390)]:{_0x1afaa6={'eventID':_0x5a7fdc['CollaborationEvent'][_0x3829c7(0x390)],'liveShareNewHost':_0x4b8c85[_0x3829c7(0x40b)]['data']};break;}case _0x5a7fdc[_0x3829c7(0x315)]['LIVESHARE_OPERATION']:{_0x1afaa6={'eventID':_0x5a7fdc['CollaborationEvent']['LIVESHARE_OPERATION'],'liveShareOperation':_0x4b8c85['data'][_0x3829c7(0x40b)]};break;}case _0x5a7fdc[_0x3829c7(0x315)][_0x3829c7(0x391)]:{_0x1afaa6={'eventID':_0x5a7fdc[_0x3829c7(0x315)][_0x3829c7(0x391)],'liveShareTerminate':_0x4b8c85[_0x3829c7(0x40b)][_0x3829c7(0x40b)]};break;}case _0x5a7fdc['CollaborationEvent'][_0x3829c7(0x23c)]:{_0x1afaa6={'eventID':_0x5a7fdc[_0x3829c7(0x315)][_0x3829c7(0x23c)],'liveShareRequestHost':_0x4b8c85[_0x3829c7(0x40b)]['data']};break;}case _0x5a7fdc[_0x3829c7(0x315)]['LIVESHARE_FETCH_OPERATIONS']:{_0x1afaa6={'eventID':_0x5a7fdc[_0x3829c7(0x315)][_0x3829c7(0x3b4)]};break;}default:_0x1afaa6={'eventID':_0x4b8c85[_0x3829c7(0x40b)][_0x3829c7(0x328)]};}return JSON['stringify']({'cmd':_0x4b8c85['cmd'],'routeKey':_0x4b8c85[_0x3829c7(0x259)],'collaMsg':_0x1afaa6});}case _0x1f168c[_0x3829c7(0x32a)]:return JSON[_0x3829c7(0x22d)]({'cmd':_0x4b8c85[_0x3829c7(0x235)],'routeKey':_0x4b8c85['routeKey'],'joinReq':_0x4b8c85[_0x3829c7(0x40b)]});case _0x1f168c[_0x3829c7(0x50c)]:return JSON[_0x3829c7(0x22d)]({'cmd':_0x4b8c85[_0x3829c7(0x235)],'routeKey':_0x4b8c85[_0x3829c7(0x259)],'leaveReq':_0x4b8c85[_0x3829c7(0x40b)]});default:throw new Error(_0x3829c7(0x3f8));}}var _0x20e378=Object[_0x997d7(0x539)],_0xfa7d74=(_0x359b25,_0x6276ba,_0x41b1c0,_0x65dc8e)=>{for(var _0xc8a5ba=_0x65dc8e>0x1?void 0x0:_0x65dc8e?_0x20e378(_0x6276ba,_0x41b1c0):_0x6276ba,_0x513391=_0x359b25['length']-0x1,_0x79c488;_0x513391>=0x0;_0x513391--)(_0x79c488=_0x359b25[_0x513391])&&(_0xc8a5ba=_0x79c488(_0xc8a5ba)||_0xc8a5ba);return _0xc8a5ba;},_0x510100=(_0x1dda47,_0x1b7ce6)=>(_0x3d0d27,_0x2adabf)=>_0x1b7ce6(_0x3d0d27,_0x2adabf,_0x1dda47);const _0x5b4d23=_0x29a664['createIdentifier'](_0x997d7(0x3b2));function _0x272dc1(_0x751e1b,_0x5cf344,_0x2601d2){var _0x5cb311=_0x997d7;return _0x751e1b+'/'+_0x5cf344+'/unit/'+_0x2601d2+_0x5cb311(0x4fa);}_0x36d18b[_0x997d7(0x562)]=class extends _0x29a664[_0x997d7(0x285)]{constructor(_0x2e9d08,_0x510f25,_0x3b59f6,_0x47aed8,_0x58633e){var _0x55fd18=_0x997d7;super(),this[_0x55fd18(0x30a)]=_0x2e9d08,this[_0x55fd18(0x3f4)]=_0x510f25,this[_0x55fd18(0x261)]=_0x3b59f6,this[_0x55fd18(0x221)]=_0x47aed8,this[_0x55fd18(0x32d)]=_0x58633e;}[_0x997d7(0x241)](_0x67fecd){var _0x330d19=_0x997d7;const _0x401c5b=this[_0x330d19(0x30a)][_0x330d19(0x47e)](_0x200e90[_0x330d19(0x52c)]);if(!_0x401c5b)throw new Error(_0x330d19(0x3c1));const _0x248b6d=_0x401c5b['createSocket'](_0x67fecd);if(!_0x248b6d)throw new Error('[CollaborationSocketService]:\x20failed\x20to\x20create\x20socket!');const _0x1563c4=new _0x29a664[(_0x330d19(0x4a7))](),_0x5ac26c=new _0x32c204[(_0x330d19(0x41c))]();_0x1563c4['add'](_0x248b6d['close$'][_0x330d19(0x3cc)](_0x1871e9=>_0x5ac26c[_0x330d19(0x476)](_0x1871e9))),_0x1563c4[_0x330d19(0x388)](_0x29a664['toDisposable'](()=>_0x5ac26c[_0x330d19(0x42a)]()));const _0x5b6ae0=new _0x32c204[(_0x330d19(0x41c))]();_0x1563c4[_0x330d19(0x388)](_0x248b6d[_0x330d19(0x521)][_0x330d19(0x3cc)](_0x1708f5=>_0x5b6ae0['next'](_0x1708f5))),_0x1563c4[_0x330d19(0x388)](_0x29a664['toDisposable'](()=>_0x5b6ae0['complete']()));const _0xe8f7ac=new _0x32c204[(_0x330d19(0x41c))]();_0x1563c4[_0x330d19(0x388)](_0x248b6d[_0x330d19(0x3e4)]['subscribe'](_0x17fb6e=>{var _0x6c7bd0=_0x330d19;const _0x589046=_0x5a583b(_0x17fb6e);_0xe8f7ac[_0x6c7bd0(0x476)](_0x589046);})),_0x1563c4[_0x330d19(0x388)](_0x29a664[_0x330d19(0x4b5)](()=>_0xe8f7ac[_0x330d19(0x42a)]()));let _0x12b5d4;const _0x1a429b=()=>{var _0x15e802=_0x330d19;_0x5b6ae0[_0x15e802(0x476)](new Event(_0x15e802(0x37a))),_0x5ac26c[_0x15e802(0x476)](new Event(_0x15e802(0x37a))),_0x12b5d4['close']();};return _0x12b5d4={'memberID':'','close$':_0x5ac26c[_0x330d19(0x313)](),'error$':_0x5b6ae0['asObservable'](),'open$':_0x248b6d[_0x330d19(0x37b)],'message$':_0xe8f7ac[_0x330d19(0x313)](),'send':_0x5e9654=>{var _0x66ef35=_0x330d19;if(_0x5e9654['cmd']===_0x1f168c['INGEST']){if(_0x5e9654[_0x66ef35(0x40b)][_0x66ef35(0x328)]===_0x5a7fdc[_0x66ef35(0x315)][_0x66ef35(0x48e)]){this[_0x66ef35(0x276)](_0x12b5d4,_0x5e9654[_0x66ef35(0x40b)])[_0x66ef35(0x327)](_0x2afd3a=>{var _0x243c41=_0x66ef35;this[_0x243c41(0x221)][_0x243c41(0x4ee)](_0x2afd3a),_0x1a429b();});return;}if(_0x5e9654[_0x66ef35(0x40b)][_0x66ef35(0x328)]===_0x5a7fdc['CollaborationEvent'][_0x66ef35(0x4f3)]){const _0x173bb1=_0x5e9654[_0x66ef35(0x40b)];this['_fetchMissChangesets'](_0x173bb1)[_0x66ef35(0x367)](_0x14deea=>{var _0x1f1d73=_0x66ef35;_0xe8f7ac[_0x1f1d73(0x476)]({'cmd':_0x1f168c['RECV'],'code':_0x2eda57['OK'],'routeKey':_0x173bb1[_0x1f1d73(0x40b)]['unitID'],'routeType':'','data':{'eventID':_0x5a7fdc[_0x1f1d73(0x315)][_0x1f1d73(0x2c8)],'data':{'changesets':_0x14deea}}});})['catch'](_0x162812=>{var _0x395e2c=_0x66ef35;this[_0x395e2c(0x221)][_0x395e2c(0x4ee)](_0x162812),_0x1a429b();});return;}}_0x248b6d['send'](_0x4151ad(_0x5e9654));},'close':()=>{var _0x46f1a9=_0x330d19;_0x248b6d[_0x46f1a9(0x4f9)](),_0x1563c4[_0x46f1a9(0x206)]();}},_0x12b5d4;}async[_0x997d7(0x276)](_0x10f3c1,_0x4629be){var _0x1b5706=_0x997d7,_0x29497b;const {unitType:_0x54988e,unitID:_0x2bc918,changeset:_0x2088a7}=_0x4629be[_0x1b5706(0x40b)],_0x196c70={'unitID':_0x2bc918,'memberID':_0x10f3c1['memberID'],'type':_0x54988e,'changeset':_0x5a7fdc[_0x1b5706(0x26d)](_0x2088a7)},_0x4f4726=this[_0x1b5706(0x261)][_0x1b5706(0x368)](_0x3fa783),_0x174cc0=_0x272dc1((_0x29497b=_0x4f4726==null?void 0x0:_0x4f4726[_0x1b5706(0x301)])!=null?_0x29497b:_0x4afe1a,_0x54988e,_0x2bc918);try{await this['_httpService']['post'](_0x174cc0,{'body':_0x196c70});}catch(_0x50c737){throw this[_0x1b5706(0x221)]['error'](_0x1b5706(0x443),'submit\x20changeset\x20error!'),_0x50c737;}}async['_fetchMissChangesets'](_0x37fdd5){var _0x51d28c=_0x997d7;const {unitID:_0x29c3cf,from:_0x18e008,to:_0x71c6ea,unitType:_0x3f8306}=_0x37fdd5[_0x51d28c(0x40b)];return(await this[_0x51d28c(0x32d)][_0x51d28c(0x3cb)]({'metadata':void 0x0},{'unitID':_0x29c3cf,'type':_0x3f8306,'from':_0x18e008,'to':_0x71c6ea}))[_0x51d28c(0x414)]['map'](_0x56cadd=>((_0x56cadd[_0x51d28c(0x2af)]===null||_0x56cadd['mutations']===void 0x0)&&(_0x56cadd[_0x51d28c(0x2af)]=[]),_0x56cadd));}},_0x36d18b[_0x997d7(0x562)]=_0xfa7d74([_0x510100(0x0,_0x29a664['Inject'](_0x29a664[_0x997d7(0x2c6)])),_0x510100(0x1,_0x29a664[_0x997d7(0x346)](_0x200e90['HTTPService'])),_0x510100(0x2,_0x29a664[_0x997d7(0x4fc)]),_0x510100(0x3,_0x29a664[_0x997d7(0x492)]),_0x510100(0x4,_0x5a7fdc[_0x997d7(0x42f)])],_0x36d18b[_0x997d7(0x562)]);var _0x3b7f11=Object[_0x997d7(0x539)],_0x4d7ad0=(_0x2bd9b5,_0x37966f,_0x4624e5,_0x53d94e)=>{var _0x501334=_0x997d7;for(var _0x1a820f=_0x53d94e>0x1?void 0x0:_0x53d94e?_0x3b7f11(_0x37966f,_0x4624e5):_0x37966f,_0xccb86b=_0x2bd9b5[_0x501334(0x307)]-0x1,_0x863605;_0xccb86b>=0x0;_0xccb86b--)(_0x863605=_0x2bd9b5[_0xccb86b])&&(_0x1a820f=_0x863605(_0x1a820f)||_0x1a820f);return _0x1a820f;},_0x4b0319=(_0x3be6fc,_0x16583d)=>(_0x47dc32,_0x3c9d0)=>_0x16583d(_0x47dc32,_0x3c9d0,_0x3be6fc);_0x36d18b[_0x997d7(0x446)]=class extends _0x29a664[_0x997d7(0x285)]{constructor(_0x3fa719,_0x151af5,_0x4dc205,_0x2054cd,_0xf55f1b,_0x4acd0c){var _0x1a7085=_0x997d7;super(),_0x260f1e(this,_0x1a7085(0x2aa),new _0x32c204[(_0x1a7085(0x4be))](void 0x0)),_0x260f1e(this,'socket$',this[_0x1a7085(0x2aa)][_0x1a7085(0x313)]()),_0x260f1e(this,_0x1a7085(0x4cc),null),_0x260f1e(this,_0x1a7085(0x4f7),new Map()),_0x260f1e(this,_0x1a7085(0x325),new _0x32c204['BehaviorSubject'](_0xbd299['IDLE'])),_0x260f1e(this,_0x1a7085(0x351),this[_0x1a7085(0x325)]['asObservable']()),_0x260f1e(this,_0x1a7085(0x337),!0x1),_0x260f1e(this,_0x1a7085(0x3ca)),_0x260f1e(this,'_retryCount',0x0),_0x260f1e(this,_0x1a7085(0x3a3)),_0x260f1e(this,_0x1a7085(0x38f)),(this[_0x1a7085(0x30a)]=_0x3fa719,this[_0x1a7085(0x221)]=_0x151af5,this['_configService']=_0x4dc205,this[_0x1a7085(0x3fa)]=_0x2054cd,this[_0x1a7085(0x47a)]=_0xf55f1b,this[_0x1a7085(0x283)]=_0x4acd0c,this[_0x1a7085(0x32f)]());}get[_0x997d7(0x49e)](){return this['_socket$']['getValue']();}[_0x997d7(0x32f)](){var _0x55f674=_0x997d7;this['_networkConditionService']&&this['disposeWithMe'](this['_networkConditionService'][_0x55f674(0x33d)][_0x55f674(0x3cc)](_0x62035b=>{var _0x5bfc17=_0x55f674;_0x62035b&&!this[_0x5bfc17(0x49e)]&&this[_0x5bfc17(0x4a8)](),_0x62035b||this['_onOffline']();}));}[_0x997d7(0x206)](){var _0x51b287=_0x997d7;super[_0x51b287(0x206)](),this[_0x51b287(0x2fc)](),this['_clearTimeoutTimer'](),this[_0x51b287(0x4ca)](),this[_0x51b287(0x4f7)][_0x51b287(0x2bd)](_0x1be062=>_0x1be062[_0x51b287(0x206)]()),this['_sessions'][_0x51b287(0x2ef)](),this[_0x51b287(0x325)]['complete']();}async[_0x997d7(0x1fe)](_0x1f6c48){var _0x588089=_0x997d7;if(this[_0x588089(0x4f7)][_0x588089(0x572)](_0x1f6c48))return this['_sessions'][_0x588089(0x47e)](_0x1f6c48);this[_0x588089(0x555)]();const _0xdae5a6=this[_0x588089(0x30a)][_0x588089(0x55e)](_0x36d18b[_0x588089(0x4d1)],_0x1f6c48,this[_0x588089(0x2aa)][_0x588089(0x313)]());return this[_0x588089(0x4f7)]['set'](_0x1f6c48,_0xdae5a6),_0xdae5a6;}['closeSession'](_0x1c0710){var _0x577d3b=_0x997d7,_0xa4bf1f;const _0x4e2738=this[_0x577d3b(0x4f7)][_0x577d3b(0x47e)](_0x1c0710);_0x4e2738&&(this[_0x577d3b(0x4f7)][_0x577d3b(0x375)](_0x1c0710),_0x4e2738[_0x577d3b(0x4f9)]()),this[_0x577d3b(0x4f7)][_0x577d3b(0x498)]||(_0xa4bf1f=this[_0x577d3b(0x49e)])==null||_0xa4bf1f[_0x577d3b(0x4f9)]();}['reconnect'](){var _0x5e68f1=_0x997d7;this[_0x5e68f1(0x207)]=0x0,this[_0x5e68f1(0x2fc)](),this[_0x5e68f1(0x529)]();}['_clearRetryConnectingTimer'](){var _0x51483f=_0x997d7;this[_0x51483f(0x3ca)]!=null&&(clearTimeout(this[_0x51483f(0x3ca)]),this['_retryConnectingTimer']=null);}async[_0x997d7(0x485)](){var _0x3037b2=_0x997d7,_0x491638;const _0x1ff99c=this['_configService']['getConfig'](_0x3fa783),_0x26b8c9=(_0x491638=_0x1ff99c==null?void 0x0:_0x1ff99c[_0x3037b2(0x4d5)])!=null?_0x491638:_0x53efe6,_0x14286b=await this[_0x3037b2(0x3fa)][_0x3037b2(0x479)](_0x26b8c9);return this['_candidateSocket']=_0x14286b,_0x14286b;}async[_0x997d7(0x555)](){var _0xe17ebb=_0x997d7,_0x26e872,_0x2b49f9;try{const _0xb3d3cc=(_0x2b49f9=(_0x26e872=this['_socket'])!=null?_0x26e872:this['_candidateSocket'])!=null?_0x2b49f9:await this[_0xe17ebb(0x485)]();if(_0xb3d3cc){const _0x1edde1=_0xb3d3cc[_0xe17ebb(0x4ea)];_0xb3d3cc[_0xe17ebb(0x4ea)]=_0x10769d=>(this[_0xe17ebb(0x49f)](),_0x1edde1[_0xe17ebb(0x493)](_0xb3d3cc,[_0x10769d])),_0xb3d3cc[_0xe17ebb(0x3e4)]['subscribe'](_0xc20e68=>this['_onMessage'](_0xb3d3cc,_0xc20e68)),_0xb3d3cc[_0xe17ebb(0x521)][_0xe17ebb(0x2ab)](_0x12f47e[_0xe17ebb(0x2f3)](0x1))[_0xe17ebb(0x3cc)](_0x3cb633=>this[_0xe17ebb(0x221)]['error'](_0xe17ebb(0x27c),_0x3cb633)),_0xb3d3cc[_0xe17ebb(0x37b)][_0xe17ebb(0x2ab)](_0x12f47e['take'](0x1))[_0xe17ebb(0x3cc)](()=>{var _0x5eec31=_0xe17ebb;this[_0x5eec31(0x542)](_0xb3d3cc);}),_0xb3d3cc[_0xe17ebb(0x2a7)][_0xe17ebb(0x2ab)](_0x12f47e['take'](0x1))[_0xe17ebb(0x3cc)](_0x419eef=>{var _0x2cbebe=_0xe17ebb;this['_logService'][_0x2cbebe(0x1ff)](_0x2cbebe(0x344),'socket\x20close',_0x419eef),this[_0x2cbebe(0x2ca)]();});}}catch(_0x513a3d){this[_0xe17ebb(0x221)][_0xe17ebb(0x4ee)](_0x513a3d),this[_0xe17ebb(0x2ca)]();}}[_0x997d7(0x542)](_0x596767){var _0x36676c=_0x997d7;this['_logService'][_0x36676c(0x1ff)](_0x36676c(0x344),_0x36676c(0x438)),_0x596767[_0x36676c(0x4ea)]({'cmd':_0x1f168c[_0x36676c(0x556)]}),this['_rescheduleHeartbeat']();}[_0x997d7(0x3eb)](){var _0x26a764=_0x997d7;this[_0x26a764(0x337)]=!0x1,this['_candidateSocket']=null,this[_0x26a764(0x325)][_0x26a764(0x476)](_0xbd299[_0x26a764(0x3fd)]),this[_0x26a764(0x2aa)]['next'](null),this[_0x26a764(0x50d)](),this[_0x26a764(0x4ca)]();}[_0x997d7(0x2ca)](){var _0x45e18a=_0x997d7,_0x16dcf1;this[_0x45e18a(0x3eb)](),this['_retryCount']<((_0x16dcf1=this['_configService']['getConfig'](_0x547549))!=null?_0x16dcf1:0x3)?(this['_collaborationUIEventService']['emitEvent']({'id':_0xedfb31['SOCKET_FAILED_RETRY']}),this[_0x45e18a(0x529)]()):this[_0x45e18a(0x47a)][_0x45e18a(0x2d4)]({'id':_0xedfb31[_0x45e18a(0x489)]});}[_0x997d7(0x529)](){var _0x37fb32=_0x997d7,_0x5ea410;const _0x2b44aa=this[_0x37fb32(0x207)],_0x3abc0f=this[_0x37fb32(0x261)][_0x37fb32(0x368)](_0x3fa783),_0x23b0a0=_0x2b44aa===0x0?0x0:((_0x5ea410=_0x3abc0f==null?void 0x0:_0x3abc0f[_0x37fb32(0x464)])!=null?_0x5ea410:0x4e20)*0x2**_0x2b44aa;this[_0x37fb32(0x3ca)]=setTimeout(()=>{var _0x16fb94=_0x37fb32;clearTimeout(this[_0x16fb94(0x3ca)]),this[_0x16fb94(0x3ca)]=null,this[_0x16fb94(0x555)]();},_0x23b0a0),this['_retryCount']+=0x1;}['_onMessage'](_0x43ff69,_0x9c3fc0){var _0x386a4b=_0x997d7;const {cmd:_0x20a6b6}=_0x9c3fc0;_0x20a6b6===_0x1f168c[_0x386a4b(0x556)]&&!this[_0x386a4b(0x337)]&&(_0x43ff69[_0x386a4b(0x298)]=_0x9c3fc0[_0x386a4b(0x40b)][_0x386a4b(0x298)],this[_0x386a4b(0x2aa)]['next'](_0x43ff69),this[_0x386a4b(0x325)][_0x386a4b(0x476)](_0xbd299[_0x386a4b(0x42b)]),this['_socketReady']=!0x0,this[_0x386a4b(0x4cc)]=null),_0x20a6b6===_0x1f168c[_0x386a4b(0x230)]&&this[_0x386a4b(0x50d)](),this[_0x386a4b(0x49f)]();}[_0x997d7(0x49f)](){var _0x56e27b=_0x997d7,_0x2e8467;this[_0x56e27b(0x4ca)](),this[_0x56e27b(0x3a3)]=setTimeout(()=>this[_0x56e27b(0x20d)](),(_0x2e8467=this['_configService'][_0x56e27b(0x368)](_0x2b6987))!=null?_0x2e8467:0x7530);}['_sendHeartbeat'](){var _0x1069fc=_0x997d7;this[_0x1069fc(0x49e)][_0x1069fc(0x4ea)]({'cmd':_0x1f168c[_0x1069fc(0x230)]}),this[_0x1069fc(0x46b)]();}['_waitForHeartbeatResponse'](){var _0x3aaef4=_0x997d7,_0x3435ab;this[_0x3aaef4(0x38f)]=setTimeout(()=>this['_onConnectionFailed'](),(_0x3435ab=this['_configService'][_0x3aaef4(0x368)](_0x315b2c))!=null?_0x3435ab:0x4e20);}[_0x997d7(0x4ca)](){var _0x2d307e=_0x997d7;this[_0x2d307e(0x3a3)]!=null&&(clearTimeout(this[_0x2d307e(0x3a3)]),this[_0x2d307e(0x3a3)]=null);}[_0x997d7(0x50d)](){var _0x430b14=_0x997d7;this[_0x430b14(0x38f)]!=null&&(clearTimeout(this[_0x430b14(0x38f)]),this[_0x430b14(0x38f)]=null);}},_0x36d18b[_0x997d7(0x446)]=_0x4d7ad0([_0x4b0319(0x0,_0x29a664['Inject'](_0x29a664[_0x997d7(0x2c6)])),_0x4b0319(0x1,_0x29a664[_0x997d7(0x492)]),_0x4b0319(0x2,_0x29a664[_0x997d7(0x4fc)]),_0x4b0319(0x3,_0x5b4d23),_0x4b0319(0x4,_0x29a664[_0x997d7(0x346)](_0x495958)),_0x4b0319(0x5,_0x29a664[_0x997d7(0x29b)](_0x3b1d7a))],_0x36d18b['CollaborationSessionService']);var _0x1373b7=Object[_0x997d7(0x539)],_0x154857=(_0xf6f537,_0x1301ef,_0x55ec14,_0x9d3824)=>{var _0x36960d=_0x997d7;for(var _0x20fbc9=_0x9d3824>0x1?void 0x0:_0x9d3824?_0x1373b7(_0x1301ef,_0x55ec14):_0x1301ef,_0xb903e2=_0xf6f537[_0x36960d(0x307)]-0x1,_0x5f5041;_0xb903e2>=0x0;_0xb903e2--)(_0x5f5041=_0xf6f537[_0xb903e2])&&(_0x20fbc9=_0x5f5041(_0x20fbc9)||_0x20fbc9);return _0x20fbc9;},_0x5d3ecd=(_0x5cffd3,_0x1a9fa7)=>(_0x3e97d3,_0x187d9d)=>_0x1a9fa7(_0x3e97d3,_0x187d9d,_0x5cffd3);_0x36d18b[_0x997d7(0x322)]=class extends _0x29a664[_0x997d7(0x330)]{constructor(_0x47eb7a,_0x945440,_0x17013,_0x1399f7){var _0x52b943=_0x997d7,_0x56948a;super(),_0x260f1e(this,'_entities',new Map()),_0x260f1e(this,_0x52b943(0x35d),new _0x32c204['Subject']()),_0x260f1e(this,_0x52b943(0x262),this[_0x52b943(0x35d)][_0x52b943(0x313)]()),(this[_0x52b943(0x30a)]=_0x47eb7a,this[_0x52b943(0x419)]=_0x945440,this[_0x52b943(0x261)]=_0x17013,this['_univerInstanceService']=_0x1399f7,((_0x56948a=this[_0x52b943(0x261)][_0x52b943(0x368)](_0x3fa783))==null?void 0x0:_0x56948a[_0x52b943(0x204)])!==!0x1&&this['_init']());}['dispose'](){var _0x409319=_0x997d7;super[_0x409319(0x206)](),this[_0x409319(0x537)][_0x409319(0x2bd)](_0x128711=>_0x128711[_0x409319(0x206)]()),this['_entities']['clear']();}['getCollabEntity'](_0x491b07){var _0x3065b0=_0x997d7,_0x50c8d4;return(_0x50c8d4=this[_0x3065b0(0x537)][_0x3065b0(0x47e)](_0x491b07))!=null?_0x50c8d4:null;}[_0x997d7(0x326)](_0x301433){var _0x5d492c=_0x997d7;const _0x4179e1=this['getCollabEntity'](_0x301433);return _0x4179e1?_0x32c204['of'](_0x4179e1):this[_0x5d492c(0x35d)][_0x5d492c(0x2ab)](_0x12f47e['filter'](_0x509c1d=>_0x509c1d['unitID']===_0x301433));}[_0x997d7(0x33f)](_0x55ae9e){var _0x322cfc=_0x997d7;return _0x32c204[_0x322cfc(0x3b1)](this[_0x322cfc(0x326)](_0x55ae9e)[_0x322cfc(0x2ab)](_0x12f47e[_0x322cfc(0x2b1)](()=>{})));}[_0x997d7(0x275)](){var _0x1d9a91=_0x997d7;this['_univerInstanceService']['getTypeOfUnitAdded$'](_0x29a664[_0x1d9a91(0x319)][_0x1d9a91(0x4c5)])[_0x1d9a91(0x2ab)](_0x32c204[_0x1d9a91(0x45b)](this['dispose$']),_0x12f47e[_0x1d9a91(0x50a)](0x10))[_0x1d9a91(0x3cc)](async _0x4a8183=>{var _0x2b7719=_0x1d9a91;const _0x4536cc=_0x4a8183[_0x2b7719(0x4ae)](),_0x4313d5=await this[_0x2b7719(0x44a)](_0x4536cc,_0x60f00c[_0x2b7719(0x4c5)]);this[_0x2b7719(0x537)][_0x2b7719(0x41e)](_0x4536cc,_0x4313d5);}),this[_0x1d9a91(0x432)][_0x1d9a91(0x51b)](_0x29a664['UniverInstanceType'][_0x1d9a91(0x47c)])[_0x1d9a91(0x2ab)](_0x32c204[_0x1d9a91(0x45b)](this['dispose$']),_0x12f47e[_0x1d9a91(0x50a)](0x10))[_0x1d9a91(0x2ab)](_0x12f47e[_0x1d9a91(0x469)](_0xa3637c=>!_0xa3637c['getUnitId']()[_0x1d9a91(0x2e3)]('__')))[_0x1d9a91(0x3cc)](async _0x370d8=>{var _0x48000a=_0x1d9a91;const _0x1433e1=_0x370d8[_0x48000a(0x4ae)](),_0x49f081=await this[_0x48000a(0x44a)](_0x1433e1,_0x60f00c[_0x48000a(0x47c)]);this[_0x48000a(0x537)]['set'](_0x1433e1,_0x49f081);}),_0x32c204['merge'](this[_0x1d9a91(0x432)][_0x1d9a91(0x525)](_0x29a664['UniverInstanceType'][_0x1d9a91(0x4c5)]),this['_univerInstanceService']['getTypeOfUnitDisposed$'](_0x29a664[_0x1d9a91(0x319)][_0x1d9a91(0x47c)]))[_0x1d9a91(0x2ab)](_0x32c204[_0x1d9a91(0x45b)](this[_0x1d9a91(0x2a0)]))[_0x1d9a91(0x3cc)](_0x3d9c4d=>{var _0xaa8aa9=_0x1d9a91;const _0x42a8a9=_0x3d9c4d[_0xaa8aa9(0x4ae)](),_0x12dd1b=this[_0xaa8aa9(0x537)][_0xaa8aa9(0x47e)](_0x42a8a9);_0x12dd1b&&(_0x12dd1b['dispose'](),this[_0xaa8aa9(0x537)]['delete'](_0x42a8a9));});}async[_0x997d7(0x44a)](_0x1e5651,_0x46ac0e){var _0x49eb9f=_0x997d7;const _0x149271=await this[_0x49eb9f(0x419)]['requireSession'](_0x1e5651),_0x524073=this[_0x49eb9f(0x30a)][_0x49eb9f(0x55e)](this['_getCtorByUniverType'](_0x46ac0e),_0x1e5651,_0x46ac0e,_0x149271);return await _0x524073[_0x49eb9f(0x369)](),this['_entityInit$'][_0x49eb9f(0x476)](_0x524073),_0x524073;}['_getCtorByUniverType'](_0x385c90){var _0x345c71=_0x997d7;switch(_0x385c90){case _0x60f00c['UNIVER_DOC']:return _0x36d18b[_0x345c71(0x522)];case _0x60f00c['UNIVER_SHEET']:return _0x36d18b[_0x345c71(0x454)];default:throw new Error(_0x345c71(0x2b2)+_0x385c90);}}},_0x36d18b[_0x997d7(0x322)]=_0x154857([_0x5d3ecd(0x0,_0x29a664[_0x997d7(0x346)](_0x29a664[_0x997d7(0x2c6)])),_0x5d3ecd(0x1,_0x29a664[_0x997d7(0x346)](_0x36d18b[_0x997d7(0x446)])),_0x5d3ecd(0x2,_0x29a664[_0x997d7(0x4fc)]),_0x5d3ecd(0x3,_0x29a664['IUniverInstanceService'])],_0x36d18b['CollaborationController']);var _0x4f5a28=Object[_0x997d7(0x539)],_0x1fabce=(_0x3086f3,_0x2be102,_0x4ed696,_0x4cf03d)=>{for(var _0x57e018=_0x4cf03d>0x1?void 0x0:_0x4cf03d?_0x4f5a28(_0x2be102,_0x4ed696):_0x2be102,_0x4aa861=_0x3086f3['length']-0x1,_0x53127d;_0x4aa861>=0x0;_0x4aa861--)(_0x53127d=_0x3086f3[_0x4aa861])&&(_0x57e018=_0x53127d(_0x57e018)||_0x57e018);return _0x57e018;},_0x443904=(_0x22a3a0,_0x56167c)=>(_0x514338,_0x49f5f7)=>_0x56167c(_0x514338,_0x49f5f7,_0x22a3a0);const _0x3af0a4='DEFAULT_FILE_NAME',_0x5d6c95=_0x997d7(0x234);let _0x4788c3=class extends _0x29a664[_0x997d7(0x285)]{constructor(_0x242d49,_0x4c9d96){var _0x2c7a6e=_0x997d7;super(),this['_univerInstanceService']=_0x242d49,this[_0x2c7a6e(0x261)]=_0x4c9d96,this[_0x2c7a6e(0x275)]();}['_init'](){var _0x3cc057=_0x997d7;this[_0x3cc057(0x31b)](this[_0x3cc057(0x432)][_0x3cc057(0x274)][_0x3cc057(0x3cc)](()=>{var _0x863bf3=_0x3cc057,_0x47af14;const _0x771eb4=this[_0x863bf3(0x432)][_0x863bf3(0x213)]();let _0x3a6e28=(_0x47af14=this['_configService']['getConfig'](_0x3af0a4))!=null?_0x47af14:_0x5d6c95;_0x771eb4 instanceof _0x29a664[_0x863bf3(0x23f)]&&(_0x3a6e28=_0x771eb4[_0x863bf3(0x4d2)]),document[_0x863bf3(0x324)]=_0x3a6e28;}));}};_0x4788c3=_0x1fabce([_0x443904(0x0,_0x29a664[_0x997d7(0x208)]),_0x443904(0x1,_0x29a664[_0x997d7(0x4fc)])],_0x4788c3);var _0x1c7e94=Object['getOwnPropertyDescriptor'],_0x3e7e4d=(_0xa7a6eb,_0x476645,_0x2687c9,_0x55e98b)=>{var _0x23db95=_0x997d7;for(var _0x401c23=_0x55e98b>0x1?void 0x0:_0x55e98b?_0x1c7e94(_0x476645,_0x2687c9):_0x476645,_0x8602eb=_0xa7a6eb[_0x23db95(0x307)]-0x1,_0x8d74c3;_0x8602eb>=0x0;_0x8602eb--)(_0x8d74c3=_0xa7a6eb[_0x8602eb])&&(_0x401c23=_0x8d74c3(_0x401c23)||_0x401c23);return _0x401c23;},_0x24dd4a=(_0x577ada,_0x611cdb)=>(_0xcf1053,_0x5eee7e)=>_0x611cdb(_0xcf1053,_0x5eee7e,_0x577ada);let _0x57ab38=class{constructor(_0x4076a0,_0x4fba16,_0xb2b31b){var _0x481620=_0x997d7;this['_configService']=_0x4076a0,this[_0x481620(0x3f4)]=_0x4fba16,this[_0x481620(0x456)]=_0xb2b31b,this[_0x481620(0x369)]();}['init'](){var _0x26edaf=_0x997d7;this[_0x26edaf(0x3f4)][_0x26edaf(0x3d5)]({'priority':0x1,'interceptor':(_0x498197,_0x43b2ec)=>_0x43b2ec(_0x498197)['pipe'](_0x32c204[_0x26edaf(0x273)](async _0xd207ef=>{var _0x2b1417=_0x26edaf;const _0x1c12d1=_0xd207ef;if(_0x1c12d1[_0x2b1417(0x370)]===0x191){if(typeof window>'u')throw new Error(_0x2b1417(0x3a4));if(window[_0x2b1417(0x55f)](this[_0x2b1417(0x456)]['t'](_0x2b1417(0x24a)))){const _0x4606ae=window[_0x2b1417(0x279)](window[_0x2b1417(0x53c)][_0x2b1417(0x2ee)]);window[_0x2b1417(0x53c)][_0x2b1417(0x2ee)]=this[_0x2b1417(0x2e4)]()+_0x2b1417(0x347)+_0x4606ae;}}return _0x1c12d1;}))});}[_0x997d7(0x2e4)](){var _0x16fb4a=_0x997d7,_0x320160;const _0x4c0afa=this[_0x16fb4a(0x261)][_0x16fb4a(0x368)](_0x3fa783);return(_0x320160=_0x4c0afa==null?void 0x0:_0x4c0afa[_0x16fb4a(0x41d)])!=null?_0x320160:_0x278fe0;}};_0x57ab38=_0x3e7e4d([_0x24dd4a(0x0,_0x29a664[_0x997d7(0x4fc)]),_0x24dd4a(0x1,_0x29a664[_0x997d7(0x346)](_0x200e90[_0x997d7(0x218)])),_0x24dd4a(0x2,_0x29a664[_0x997d7(0x346)](_0x29a664[_0x997d7(0x503)]))],_0x57ab38);var _0x3db826=Object[_0x997d7(0x539)],_0xc23e00=(_0x5e8777,_0x114bbf,_0x18910b,_0x1d58ed)=>{for(var _0x52c719=_0x1d58ed>0x1?void 0x0:_0x1d58ed?_0x3db826(_0x114bbf,_0x18910b):_0x114bbf,_0x3ed8c1=_0x5e8777['length']-0x1,_0x47ed92;_0x3ed8c1>=0x0;_0x3ed8c1--)(_0x47ed92=_0x5e8777[_0x3ed8c1])&&(_0x52c719=_0x47ed92(_0x52c719)||_0x52c719);return _0x52c719;},_0xbd05af=(_0x502496,_0x1ab914)=>(_0x32fb32,_0xe30fd0)=>_0x1ab914(_0x32fb32,_0xe30fd0,_0x502496);const _0x450ae3=_0x997d7(0x2ba);_0x36d18b[_0x997d7(0x3dc)]=class extends _0x29a664[_0x997d7(0x285)]{constructor(_0x31ec09,_0x3daf48){var _0x90d5d7=_0x997d7;super(),this['_HTTPService']=_0x31ec09,this[_0x90d5d7(0x261)]=_0x3daf48,this[_0x90d5d7(0x305)]();}[_0x997d7(0x305)](){var _0x48fccc=_0x997d7;const _0x3050fa=this;this[_0x48fccc(0x31b)](this[_0x48fccc(0x210)][_0x48fccc(0x3d5)]({'priority':0x3e7,'interceptor':_0x200e90[_0x48fccc(0x27b)]({'isMatch'(_0x57f6bb){var _0x4ca79f=_0x48fccc,_0x141f5d;if(_0x57f6bb[_0x4ca79f(0x50e)]==='POST'&&((_0x141f5d=_0x57f6bb[_0x4ca79f(0x38b)])!=null&&_0x141f5d['body'])){const {objectID:_0x55b02d,objectType:_0x342e65}=_0x57f6bb['requestParams'][_0x4ca79f(0x22b)]||{};if(!_0x55b02d||_0x342e65===void 0x0)return!0x1;const _0x5272bc=_0x3050fa[_0x4ca79f(0x2a4)]()+'/'+_0x342e65+'/object/'+_0x55b02d+'/allowed';if(_0x57f6bb['url']===_0x5272bc)return!0x0;}return!0x1;},'getParamsFromRequest'(_0x1b67d8){var _0x193f60=_0x48fccc,_0x6b332;return(_0x6b332=_0x1b67d8['requestParams'])==null?void 0x0:_0x6b332[_0x193f60(0x22b)];},'mergeParamsToRequest'(_0x4fba21,_0x4a343a){var _0x4c978c=_0x48fccc;const _0x520611=_0x3050fa[_0x4c978c(0x2a4)]()+_0x4c978c(0x4d9),_0x31b3bf=_0x4fba21[_0x4c978c(0x516)]((_0xb093cf,_0xf7612e)=>{var _0x371de0=_0x4c978c;const {unitID:_0x4a1122,objectID:_0x4d6b16,objectType:_0x50939d,actions:_0x44ae1d}=_0xf7612e;return _0xb093cf[_0x4a1122]||(_0xb093cf[_0x4a1122]={}),_0xb093cf[_0x4a1122][_0x4d6b16]||(_0xb093cf[_0x4a1122][_0x4d6b16]={'objectID':_0x4d6b16,'objectType':_0x50939d,'actions':[]}),_0xb093cf[_0x4a1122][_0x4d6b16][_0x371de0(0x2c7)][_0x371de0(0x3f6)](..._0x44ae1d),_0xb093cf;},{}),_0x4677fe=[];for(const _0x35e82a in _0x31b3bf)for(const _0x3cab94 in _0x31b3bf[_0x35e82a]){const {actions:_0x203ee3,objectType:_0x422887}=_0x31b3bf[_0x35e82a][_0x3cab94],_0x29a983=[...new Set(_0x203ee3)];_0x4677fe[_0x4c978c(0x3f6)]({'unitID':_0x35e82a,'objectID':_0x3cab94,'objectType':_0x422887,'actions':_0x29a983});}return new _0x200e90[(_0x4c978c(0x3d4))]('POST',_0x520611,{'headers':_0x4a343a[_0x4c978c(0x1f0)],'withCredentials':_0x4a343a[_0x4c978c(0x408)],'responseType':_0x4a343a[_0x4c978c(0x40e)],'body':{'requests':_0x4677fe}});}},{'distributeResult'(_0x22d61a,_0x2bacfd){var _0x106d1c=_0x48fccc;const {objectActions:_0x425ae8}=_0x22d61a;return _0x2bacfd[_0x106d1c(0x2b1)](_0x3275c3=>{var _0x4ce072=_0x106d1c;const {unitID:_0x4d7ad1,objectID:_0x8f9f9a,actions:_0x5b6338}=_0x3275c3,_0x27787a=_0x425ae8[_0x4ce072(0x455)](_0x553ff6=>_0x553ff6['unitID']===_0x4d7ad1&&_0x553ff6[_0x4ce072(0x1f6)]===_0x8f9f9a),_0x1e80d2=_0x5b6338[_0x4ce072(0x2b1)](_0x3512e9=>_0x27787a==null?void 0x0:_0x27787a[_0x4ce072(0x2c7)]['find'](_0x143555=>_0x143555['action']===_0x3512e9))[_0x4ce072(0x469)](_0x24a8c0=>!!_0x24a8c0);return{'config':_0x3275c3,'result':{'actions':_0x1e80d2,'error':_0x22d61a[_0x4ce072(0x4ee)]}};});}})}));}[_0x997d7(0x2a4)](){var _0x31219a=_0x997d7,_0x281e0e;const _0x28c647=this[_0x31219a(0x261)]['getConfig'](_0x3fa783);return(_0x281e0e=_0x28c647==null?void 0x0:_0x28c647[_0x31219a(0x534)])!=null?_0x281e0e:_0x450ae3;}async['create'](_0x1f5b30){var _0x3c3634=_0x997d7;const _0x1772cc=this[_0x3c3634(0x2a4)]()+'/'+_0x1f5b30[_0x3c3634(0x46e)]+_0x3c3634(0x509);return(await this[_0x3c3634(0x210)][_0x3c3634(0x540)](_0x1772cc,{'body':_0x1f5b30}))[_0x3c3634(0x22b)]['objectID']||'';}async['list'](_0xa43be){var _0x12b98d=_0x997d7;const _0x16be38=this[_0x12b98d(0x2a4)]()+_0x12b98d(0x311);return(await this[_0x12b98d(0x210)][_0x12b98d(0x540)](_0x16be38,{'body':_0xa43be}))[_0x12b98d(0x22b)][_0x12b98d(0x46f)];}async[_0x997d7(0x550)](_0x2603b9){var _0x57be6a=_0x997d7,_0x335aa6,_0x30886b;const _0x4b8818=this[_0x57be6a(0x2a4)]()+'/'+_0x2603b9[_0x57be6a(0x46e)]+_0x57be6a(0x48f)+_0x2603b9[_0x57be6a(0x1f6)],_0x320b1f=await this[_0x57be6a(0x210)][_0x57be6a(0x306)](_0x4b8818,{'body':_0x2603b9});if(((_0x30886b=(_0x335aa6=_0x320b1f==null?void 0x0:_0x320b1f[_0x57be6a(0x22b)])==null?void 0x0:_0x335aa6[_0x57be6a(0x4ee)])==null?void 0x0:_0x30886b['code'])!==0x1)throw new Error(_0x57be6a(0x4a6));}async['allowed'](_0xa9fa92){var _0xe04589=_0x997d7;const _0x538374=this[_0xe04589(0x2a4)]()+'/'+_0xa9fa92[_0xe04589(0x46e)]+'/object/'+_0xa9fa92[_0xe04589(0x1f6)]+_0xe04589(0x34a);return(await this[_0xe04589(0x210)][_0xe04589(0x540)](_0x538374,{'body':_0xa9fa92}))[_0xe04589(0x22b)]['actions'];}async[_0x997d7(0x3f0)](_0x5758da){var _0x496a8b=_0x997d7;const _0xaf9ec0=this[_0x496a8b(0x2a4)]()+_0x496a8b(0x4d9);return(await this[_0x496a8b(0x210)]['post'](_0xaf9ec0,{'body':{'requests':_0x5758da}}))[_0x496a8b(0x22b)][_0x496a8b(0x36f)];}async[_0x997d7(0x52e)](_0x40ecd0){var _0x3f3908=_0x997d7;const _0x250793=this[_0x3f3908(0x2a4)]()+'/'+_0x40ecd0[_0x3f3908(0x46e)]+'/role',_0x2b4347=await this['_HTTPService'][_0x3f3908(0x540)](_0x250793,{'body':_0x40ecd0});return{'roles':_0x2b4347[_0x3f3908(0x22b)]['roles'],'actions':_0x2b4347[_0x3f3908(0x22b)][_0x3f3908(0x2c7)]};}async[_0x997d7(0x4fd)](_0x273da7){var _0x1de26f=_0x997d7;const _0x30262b=this[_0x1de26f(0x2a4)]()+_0x1de26f(0x43a);await this[_0x1de26f(0x210)][_0x1de26f(0x375)](_0x30262b,{'params':{'collaboratorID':_0x273da7[_0x1de26f(0x33a)],'objectID':_0x273da7['objectID'],'unitID':_0x273da7[_0x1de26f(0x297)]}});}async[_0x997d7(0x565)](_0x8746f8){var _0xf98833=_0x997d7;const _0x3ffe6d=this['_getAPIPrefixPath']()+_0xf98833(0x43a);await this[_0xf98833(0x210)]['patch'](_0x3ffe6d,{'body':_0x8746f8});}async[_0x997d7(0x242)](_0x348098){var _0x24a162=_0x997d7;const _0x462572=this[_0x24a162(0x2a4)]()+'/collaborator';await this[_0x24a162(0x210)][_0x24a162(0x540)](_0x462572,{'body':_0x348098});}async[_0x997d7(0x3c2)](_0x3f2c92){var _0x5950cc=_0x997d7;const _0x597dea=this['_getAPIPrefixPath']()+_0x5950cc(0x43a);return(await this['_HTTPService']['get'](_0x597dea,{'params':{'objectID':_0x3f2c92[_0x5950cc(0x1f6)],'unitID':_0x3f2c92['unitID']}}))[_0x5950cc(0x22b)][_0x5950cc(0x270)];}async['putCollaborators'](_0x37f46b){var _0x373c6d=_0x997d7;const _0x2e0328=this[_0x373c6d(0x2a4)]()+_0x373c6d(0x43a);await this[_0x373c6d(0x210)][_0x373c6d(0x306)](_0x2e0328,{'body':_0x37f46b});}},_0x36d18b[_0x997d7(0x3dc)]=_0xc23e00([_0xbd05af(0x0,_0x29a664[_0x997d7(0x346)](_0x200e90['HTTPService'])),_0xbd05af(0x1,_0x29a664[_0x997d7(0x346)](_0x29a664[_0x997d7(0x4fc)]))],_0x36d18b[_0x997d7(0x3dc)]);var _0x2cf14d=typeof globalThis<'u'?globalThis:typeof window<'u'?window:typeof global<'u'?global:typeof self<'u'?self:{};function _0x574301(_0x3b567e){var _0x545163=_0x997d7;return _0x3b567e&&_0x3b567e['__esModule']&&Object[_0x545163(0x236)][_0x545163(0x203)]['call'](_0x3b567e,_0x545163(0x460))?_0x3b567e[_0x545163(0x460)]:_0x3b567e;}var _0x367d61={'exports':{}};function _0x141fe1(_0x19f5aa){var _0x4f6f68=_0x997d7;throw new Error(_0x4f6f68(0x4b1)+_0x19f5aa+_0x4f6f68(0x463));}var _0x55a1d1={'exports':{}},_0x34192c=_0x55a1d1[_0x997d7(0x523)],_0x2fb6f5;function _0x45d273(){return _0x2fb6f5||(_0x2fb6f5=0x1,function(_0x3b4155,_0x136e18){(function(_0x5de41d,_0x143747){_0x3b4155['exports']=_0x143747();}(_0x34192c,function(){var _0xd0a385=_0xd0a385||function(_0x55c17e,_0x7cbbaf){var _0x53cf93=_0x4ecd,_0x5bca64;if(typeof window<'u'&&window['crypto']&&(_0x5bca64=window[_0x53cf93(0x3fb)]),typeof self<'u'&&self[_0x53cf93(0x3fb)]&&(_0x5bca64=self[_0x53cf93(0x3fb)]),typeof globalThis<'u'&&globalThis[_0x53cf93(0x3fb)]&&(_0x5bca64=globalThis[_0x53cf93(0x3fb)]),!_0x5bca64&&typeof window<'u'&&window[_0x53cf93(0x2f7)]&&(_0x5bca64=window[_0x53cf93(0x2f7)]),!_0x5bca64&&typeof _0x2cf14d<'u'&&_0x2cf14d[_0x53cf93(0x3fb)]&&(_0x5bca64=_0x2cf14d['crypto']),!_0x5bca64&&typeof _0x141fe1==_0x53cf93(0x29c))try{_0x5bca64=require('crypto');}catch{}var _0x2f0f49=function(){var _0x222eda=_0x53cf93;if(_0x5bca64){if(typeof _0x5bca64[_0x222eda(0x2d7)]==_0x222eda(0x29c))try{return _0x5bca64[_0x222eda(0x2d7)](new Uint32Array(0x1))[0x0];}catch{}if(typeof _0x5bca64[_0x222eda(0x56f)]==_0x222eda(0x29c))try{return _0x5bca64['randomBytes'](0x4)['readInt32LE']();}catch{}}throw new Error(_0x222eda(0x339));},_0x548af3=Object[_0x53cf93(0x3e7)]||(function(){function _0x52b7f9(){}return function(_0x519306){var _0xeb581=_0x4ecd,_0x5a4d65;return _0x52b7f9[_0xeb581(0x236)]=_0x519306,_0x5a4d65=new _0x52b7f9(),_0x52b7f9[_0xeb581(0x236)]=null,_0x5a4d65;};}()),_0x16238a={},_0x3cc764=_0x16238a[_0x53cf93(0x3ff)]={},_0x51883c=_0x3cc764['Base']=(function(){return{'extend':function(_0x153fb2){var _0x4e857b=_0x4ecd,_0x3bd4b=_0x548af3(this);return _0x153fb2&&_0x3bd4b['mixIn'](_0x153fb2),(!_0x3bd4b[_0x4e857b(0x203)]('init')||this[_0x4e857b(0x369)]===_0x3bd4b[_0x4e857b(0x369)])&&(_0x3bd4b[_0x4e857b(0x369)]=function(){var _0x13e78c=_0x4e857b;_0x3bd4b[_0x13e78c(0x4a4)][_0x13e78c(0x369)][_0x13e78c(0x493)](this,arguments);}),_0x3bd4b[_0x4e857b(0x369)][_0x4e857b(0x236)]=_0x3bd4b,_0x3bd4b[_0x4e857b(0x4a4)]=this,_0x3bd4b;},'create':function(){var _0x41f01b=_0x4ecd,_0x201b3e=this[_0x41f01b(0x202)]();return _0x201b3e[_0x41f01b(0x369)][_0x41f01b(0x493)](_0x201b3e,arguments),_0x201b3e;},'init':function(){},'mixIn':function(_0xce8061){var _0xa30347=_0x4ecd;for(var _0x4b26ba in _0xce8061)_0xce8061[_0xa30347(0x203)](_0x4b26ba)&&(this[_0x4b26ba]=_0xce8061[_0x4b26ba]);_0xce8061[_0xa30347(0x203)]('toString')&&(this[_0xa30347(0x3a6)]=_0xce8061[_0xa30347(0x3a6)]);},'clone':function(){var _0x54d0ac=_0x4ecd;return this['init'][_0x54d0ac(0x236)][_0x54d0ac(0x202)](this);}};}()),_0x10e699=_0x3cc764[_0x53cf93(0x466)]=_0x51883c[_0x53cf93(0x202)]({'init':function(_0x4d33bc,_0x1a9e43){var _0x5f1003=_0x53cf93;_0x4d33bc=this[_0x5f1003(0x30d)]=_0x4d33bc||[],_0x1a9e43!=_0x7cbbaf?this[_0x5f1003(0x4c3)]=_0x1a9e43:this[_0x5f1003(0x4c3)]=_0x4d33bc[_0x5f1003(0x307)]*0x4;},'toString':function(_0x5e532b){var _0x1bb189=_0x53cf93;return(_0x5e532b||_0x37fad3)[_0x1bb189(0x22d)](this);},'concat':function(_0x3dbd08){var _0x486f3a=_0x53cf93,_0xaced35=this[_0x486f3a(0x30d)],_0x3cae76=_0x3dbd08[_0x486f3a(0x30d)],_0x3805b2=this[_0x486f3a(0x4c3)],_0x4f2f8f=_0x3dbd08[_0x486f3a(0x4c3)];if(this[_0x486f3a(0x360)](),_0x3805b2%0x4)for(var _0xa10fec=0x0;_0xa10fec<_0x4f2f8f;_0xa10fec++){var _0x14d6d0=_0x3cae76[_0xa10fec>>>0x2]>>>0x18-_0xa10fec%0x4*0x8&0xff;_0xaced35[_0x3805b2+_0xa10fec>>>0x2]|=_0x14d6d0<<0x18-(_0x3805b2+_0xa10fec)%0x4*0x8;}else{for(var _0x27c81e=0x0;_0x27c81e<_0x4f2f8f;_0x27c81e+=0x4)_0xaced35[_0x3805b2+_0x27c81e>>>0x2]=_0x3cae76[_0x27c81e>>>0x2];}return this[_0x486f3a(0x4c3)]+=_0x4f2f8f,this;},'clamp':function(){var _0xb25149=_0x53cf93,_0x40204d=this[_0xb25149(0x30d)],_0x559f93=this[_0xb25149(0x4c3)];_0x40204d[_0x559f93>>>0x2]&=0xffffffff<<0x20-_0x559f93%0x4*0x8,_0x40204d[_0xb25149(0x307)]=_0x55c17e[_0xb25149(0x212)](_0x559f93/0x4);},'clone':function(){var _0x267f9f=_0x53cf93,_0x3652ad=_0x51883c['clone']['call'](this);return _0x3652ad[_0x267f9f(0x30d)]=this[_0x267f9f(0x30d)][_0x267f9f(0x3c4)](0x0),_0x3652ad;},'random':function(_0x187442){for(var _0x2f3df7=[],_0x169f80=0x0;_0x169f80<_0x187442;_0x169f80+=0x4)_0x2f3df7['push'](_0x2f0f49());return new _0x10e699['init'](_0x2f3df7,_0x187442);}}),_0x4726c2=_0x16238a['enc']={},_0x37fad3=_0x4726c2[_0x53cf93(0x251)]={'stringify':function(_0x2d0182){var _0xf8cc92=_0x53cf93;for(var _0x2cb41b=_0x2d0182[_0xf8cc92(0x30d)],_0x30daef=_0x2d0182['sigBytes'],_0x2be015=[],_0x44e809=0x0;_0x44e809<_0x30daef;_0x44e809++){var _0x2ab83e=_0x2cb41b[_0x44e809>>>0x2]>>>0x18-_0x44e809%0x4*0x8&0xff;_0x2be015[_0xf8cc92(0x3f6)]((_0x2ab83e>>>0x4)[_0xf8cc92(0x3a6)](0x10)),_0x2be015[_0xf8cc92(0x3f6)]((_0x2ab83e&0xf)['toString'](0x10));}return _0x2be015[_0xf8cc92(0x34b)]('');},'parse':function(_0x570254){var _0x196a1d=_0x53cf93;for(var _0x535a15=_0x570254[_0x196a1d(0x307)],_0x2a54ec=[],_0xe1183c=0x0;_0xe1183c<_0x535a15;_0xe1183c+=0x2)_0x2a54ec[_0xe1183c>>>0x3]|=parseInt(_0x570254[_0x196a1d(0x2fd)](_0xe1183c,0x2),0x10)<<0x18-_0xe1183c%0x8*0x4;return new _0x10e699[(_0x196a1d(0x369))](_0x2a54ec,_0x535a15/0x2);}},_0x239836=_0x4726c2['Latin1']={'stringify':function(_0x3f5997){var _0x1a8e14=_0x53cf93;for(var _0x12db96=_0x3f5997[_0x1a8e14(0x30d)],_0x3432b3=_0x3f5997[_0x1a8e14(0x4c3)],_0x13ac2b=[],_0xd5038e=0x0;_0xd5038e<_0x3432b3;_0xd5038e++){var _0x58334a=_0x12db96[_0xd5038e>>>0x2]>>>0x18-_0xd5038e%0x4*0x8&0xff;_0x13ac2b[_0x1a8e14(0x3f6)](String[_0x1a8e14(0x318)](_0x58334a));}return _0x13ac2b[_0x1a8e14(0x34b)]('');},'parse':function(_0x384605){for(var _0xfa2d5f=_0x384605['length'],_0x3e7aa3=[],_0x106e3c=0x0;_0x106e3c<_0xfa2d5f;_0x106e3c++)_0x3e7aa3[_0x106e3c>>>0x2]|=(_0x384605['charCodeAt'](_0x106e3c)&0xff)<<0x18-_0x106e3c%0x4*0x8;return new _0x10e699['init'](_0x3e7aa3,_0xfa2d5f);}},_0x291bad=_0x4726c2[_0x53cf93(0x3b6)]={'stringify':function(_0x501a69){var _0x4ca5ff=_0x53cf93;try{return decodeURIComponent(escape(_0x239836[_0x4ca5ff(0x22d)](_0x501a69)));}catch{throw new Error(_0x4ca5ff(0x281));}},'parse':function(_0x43f613){var _0x359ab8=_0x53cf93;return _0x239836[_0x359ab8(0x487)](unescape(encodeURIComponent(_0x43f613)));}},_0x4e073d=_0x3cc764[_0x53cf93(0x277)]=_0x51883c[_0x53cf93(0x202)]({'reset':function(){var _0x32faf8=_0x53cf93;this[_0x32faf8(0x4cb)]=new _0x10e699[(_0x32faf8(0x369))](),this[_0x32faf8(0x3b8)]=0x0;},'_append':function(_0x4d91cb){var _0x51216e=_0x53cf93;typeof _0x4d91cb==_0x51216e(0x2f0)&&(_0x4d91cb=_0x291bad[_0x51216e(0x487)](_0x4d91cb)),this[_0x51216e(0x4cb)]['concat'](_0x4d91cb),this[_0x51216e(0x3b8)]+=_0x4d91cb[_0x51216e(0x4c3)];},'_process':function(_0x481b28){var _0xd663b3=_0x53cf93,_0x3a2eb5,_0x106759=this[_0xd663b3(0x4cb)],_0x5eaed7=_0x106759[_0xd663b3(0x30d)],_0x450bd7=_0x106759[_0xd663b3(0x4c3)],_0xf3fb24=this[_0xd663b3(0x488)],_0x594bfc=_0xf3fb24*0x4,_0x209985=_0x450bd7/_0x594bfc;_0x481b28?_0x209985=_0x55c17e[_0xd663b3(0x212)](_0x209985):_0x209985=_0x55c17e[_0xd663b3(0x287)]((_0x209985|0x0)-this[_0xd663b3(0x470)],0x0);var _0x44f1f8=_0x209985*_0xf3fb24,_0x18c5e7=_0x55c17e[_0xd663b3(0x3a9)](_0x44f1f8*0x4,_0x450bd7);if(_0x44f1f8){for(var _0x4da8c5=0x0;_0x4da8c5<_0x44f1f8;_0x4da8c5+=_0xf3fb24)this[_0xd663b3(0x355)](_0x5eaed7,_0x4da8c5);_0x3a2eb5=_0x5eaed7[_0xd663b3(0x425)](0x0,_0x44f1f8),_0x106759[_0xd663b3(0x4c3)]-=_0x18c5e7;}return new _0x10e699[(_0xd663b3(0x369))](_0x3a2eb5,_0x18c5e7);},'clone':function(){var _0x2bd818=_0x53cf93,_0x39914a=_0x51883c[_0x2bd818(0x4e2)][_0x2bd818(0x23d)](this);return _0x39914a['_data']=this[_0x2bd818(0x4cb)][_0x2bd818(0x4e2)](),_0x39914a;},'_minBufferSize':0x0});_0x3cc764[_0x53cf93(0x46c)]=_0x4e073d[_0x53cf93(0x202)]({'cfg':_0x51883c['extend'](),'init':function(_0x180281){var _0x47bcd3=_0x53cf93;this[_0x47bcd3(0x566)]=this[_0x47bcd3(0x566)]['extend'](_0x180281),this[_0x47bcd3(0x214)]();},'reset':function(){var _0x4cce20=_0x53cf93;_0x4e073d['reset'][_0x4cce20(0x23d)](this),this[_0x4cce20(0x4fe)]();},'update':function(_0x1d2dc5){var _0x34f9b0=_0x53cf93;return this[_0x34f9b0(0x51a)](_0x1d2dc5),this[_0x34f9b0(0x2df)](),this;},'finalize':function(_0x3fd37d){var _0x64b20a=_0x53cf93;_0x3fd37d&&this[_0x64b20a(0x51a)](_0x3fd37d);var _0x344cbc=this['_doFinalize']();return _0x344cbc;},'blockSize':0x10,'_createHelper':function(_0x23eb4e){return function(_0x966dc5,_0x3ad980){var _0x20cbcf=_0x4ecd;return new _0x23eb4e['init'](_0x3ad980)[_0x20cbcf(0x4a3)](_0x966dc5);};},'_createHmacHelper':function(_0x48d3af){return function(_0xbd21b5,_0x4b9dd1){var _0x48e40a=_0x4ecd;return new _0x5c6610['HMAC']['init'](_0x48d3af,_0x4b9dd1)[_0x48e40a(0x4a3)](_0xbd21b5);};}});var _0x5c6610=_0x16238a[_0x53cf93(0x49c)]={};return _0x16238a;}(Math);return _0xd0a385;}));}(_0x55a1d1)),_0x55a1d1['exports'];}var _0x3d6c84={'exports':{}},_0x670467=_0x3d6c84[_0x997d7(0x523)],_0x29741d;function _0x12cba4(){var _0x178f23=_0x997d7;return _0x29741d||(_0x29741d=0x1,function(_0x7426e5,_0x32beca){(function(_0x579e43,_0x5595a0){_0x7426e5['exports']=_0x5595a0(_0x45d273());}(_0x670467,function(_0x127d6a){var _0x825c0e=_0x4ecd;return(function(){var _0x2777f6=_0x4ecd,_0x50b4d4=_0x127d6a,_0x246c52=_0x50b4d4[_0x2777f6(0x3ff)],_0x1bdd13=_0x246c52[_0x2777f6(0x466)],_0x1388ca=_0x50b4d4['enc'];_0x1388ca[_0x2777f6(0x1e9)]={'stringify':function(_0x3d978b){var _0x53ac0=_0x2777f6,_0x3d3ee9=_0x3d978b['words'],_0x305a32=_0x3d978b[_0x53ac0(0x4c3)],_0xdfc6d6=this[_0x53ac0(0x461)];_0x3d978b[_0x53ac0(0x360)]();for(var _0x232380=[],_0x48ef3a=0x0;_0x48ef3a<_0x305a32;_0x48ef3a+=0x3)for(var _0x374b85=_0x3d3ee9[_0x48ef3a>>>0x2]>>>0x18-_0x48ef3a%0x4*0x8&0xff,_0x4d4b4d=_0x3d3ee9[_0x48ef3a+0x1>>>0x2]>>>0x18-(_0x48ef3a+0x1)%0x4*0x8&0xff,_0x513d91=_0x3d3ee9[_0x48ef3a+0x2>>>0x2]>>>0x18-(_0x48ef3a+0x2)%0x4*0x8&0xff,_0x38b88d=_0x374b85<<0x10|_0x4d4b4d<<0x8|_0x513d91,_0x2a95bd=0x0;_0x2a95bd<0x4&&_0x48ef3a+_0x2a95bd*0.75<_0x305a32;_0x2a95bd++)_0x232380[_0x53ac0(0x3f6)](_0xdfc6d6[_0x53ac0(0x4a9)](_0x38b88d>>>0x6*(0x3-_0x2a95bd)&0x3f));var _0x4939c2=_0xdfc6d6[_0x53ac0(0x4a9)](0x40);if(_0x4939c2){for(;_0x232380[_0x53ac0(0x307)]%0x4;)_0x232380['push'](_0x4939c2);}return _0x232380[_0x53ac0(0x34b)]('');},'parse':function(_0x3bf67d){var _0x206878=_0x2777f6,_0x4493c1=_0x3bf67d[_0x206878(0x307)],_0x40e944=this[_0x206878(0x461)],_0x3eec24=this[_0x206878(0x34c)];if(!_0x3eec24){_0x3eec24=this['_reverseMap']=[];for(var _0x416005=0x0;_0x416005<_0x40e944[_0x206878(0x307)];_0x416005++)_0x3eec24[_0x40e944[_0x206878(0x26f)](_0x416005)]=_0x416005;}var _0x22c7b1=_0x40e944[_0x206878(0x4a9)](0x40);if(_0x22c7b1){var _0x164af0=_0x3bf67d[_0x206878(0x3f5)](_0x22c7b1);_0x164af0!==-0x1&&(_0x4493c1=_0x164af0);}return _0x5db922(_0x3bf67d,_0x4493c1,_0x3eec24);},'_map':_0x2777f6(0x2fb)};function _0x5db922(_0x6c2304,_0x197219,_0x11a20b){var _0x46b746=_0x2777f6;for(var _0x43b803=[],_0x363764=0x0,_0x30f10a=0x0;_0x30f10a<_0x197219;_0x30f10a++)if(_0x30f10a%0x4){var _0x3cf6dc=_0x11a20b[_0x6c2304[_0x46b746(0x26f)](_0x30f10a-0x1)]<<_0x30f10a%0x4*0x2,_0x1bb308=_0x11a20b[_0x6c2304[_0x46b746(0x26f)](_0x30f10a)]>>>0x6-_0x30f10a%0x4*0x2,_0x3ff6f4=_0x3cf6dc|_0x1bb308;_0x43b803[_0x363764>>>0x2]|=_0x3ff6f4<<0x18-_0x363764%0x4*0x8,_0x363764++;}return _0x1bdd13['create'](_0x43b803,_0x363764);}}()),_0x127d6a['enc'][_0x825c0e(0x1e9)];}));}(_0x3d6c84)),_0x3d6c84[_0x178f23(0x523)];}var _0x5ec732={'exports':{}},_0x48783e=_0x5ec732['exports'],_0x5a7ab0;function _0x1a8182(){var _0x4f82e4=_0x997d7;return _0x5a7ab0||(_0x5a7ab0=0x1,function(_0x2fd577,_0x2b62f9){(function(_0x31f835,_0x1dc566){var _0x18fce2=_0x4ecd;_0x2fd577[_0x18fce2(0x523)]=_0x1dc566(_0x45d273());}(_0x48783e,function(_0x2f9073){var _0x2aa6c2=_0x4ecd;return function(_0x21f3b3){var _0x6a89cf=_0x4ecd,_0x541143=_0x2f9073,_0x27c642=_0x541143[_0x6a89cf(0x3ff)],_0x4713a5=_0x27c642[_0x6a89cf(0x466)],_0x562707=_0x27c642[_0x6a89cf(0x46c)],_0x1ff375=_0x541143[_0x6a89cf(0x49c)],_0x59d7b4=[];(function(){for(var _0x1b91c0=0x0;_0x1b91c0<0x40;_0x1b91c0++)_0x59d7b4[_0x1b91c0]=_0x21f3b3['abs'](_0x21f3b3['sin'](_0x1b91c0+0x1))*0x100000000|0x0;}());var _0x12340f=_0x1ff375[_0x6a89cf(0x363)]=_0x562707[_0x6a89cf(0x202)]({'_doReset':function(){var _0x4ff726=_0x6a89cf;this[_0x4ff726(0x38c)]=new _0x4713a5['init']([0x67452301,0xefcdab89,0x98badcfe,0x10325476]);},'_doProcessBlock':function(_0x400974,_0x279d6e){var _0x3a15de=_0x6a89cf;for(var _0x17bf35=0x0;_0x17bf35<0x10;_0x17bf35++){var _0x4774df=_0x279d6e+_0x17bf35,_0x234f28=_0x400974[_0x4774df];_0x400974[_0x4774df]=(_0x234f28<<0x8|_0x234f28>>>0x18)&0xff00ff|(_0x234f28<<0x18|_0x234f28>>>0x8)&0xff00ff00;}var _0x3a404a=this[_0x3a15de(0x38c)][_0x3a15de(0x30d)],_0x474732=_0x400974[_0x279d6e+0x0],_0x3b88ab=_0x400974[_0x279d6e+0x1],_0x30120d=_0x400974[_0x279d6e+0x2],_0x488856=_0x400974[_0x279d6e+0x3],_0x21c4fa=_0x400974[_0x279d6e+0x4],_0x537878=_0x400974[_0x279d6e+0x5],_0x1a4c56=_0x400974[_0x279d6e+0x6],_0x20bf81=_0x400974[_0x279d6e+0x7],_0x15e35d=_0x400974[_0x279d6e+0x8],_0x514906=_0x400974[_0x279d6e+0x9],_0x544add=_0x400974[_0x279d6e+0xa],_0x161bfd=_0x400974[_0x279d6e+0xb],_0x474412=_0x400974[_0x279d6e+0xc],_0x5aa7e7=_0x400974[_0x279d6e+0xd],_0x555b88=_0x400974[_0x279d6e+0xe],_0x31906b=_0x400974[_0x279d6e+0xf],_0x4d760a=_0x3a404a[0x0],_0x2ae8b1=_0x3a404a[0x1],_0x1a7b21=_0x3a404a[0x2],_0x4f2ec8=_0x3a404a[0x3];_0x4d760a=_0x45366e(_0x4d760a,_0x2ae8b1,_0x1a7b21,_0x4f2ec8,_0x474732,0x7,_0x59d7b4[0x0]),_0x4f2ec8=_0x45366e(_0x4f2ec8,_0x4d760a,_0x2ae8b1,_0x1a7b21,_0x3b88ab,0xc,_0x59d7b4[0x1]),_0x1a7b21=_0x45366e(_0x1a7b21,_0x4f2ec8,_0x4d760a,_0x2ae8b1,_0x30120d,0x11,_0x59d7b4[0x2]),_0x2ae8b1=_0x45366e(_0x2ae8b1,_0x1a7b21,_0x4f2ec8,_0x4d760a,_0x488856,0x16,_0x59d7b4[0x3]),_0x4d760a=_0x45366e(_0x4d760a,_0x2ae8b1,_0x1a7b21,_0x4f2ec8,_0x21c4fa,0x7,_0x59d7b4[0x4]),_0x4f2ec8=_0x45366e(_0x4f2ec8,_0x4d760a,_0x2ae8b1,_0x1a7b21,_0x537878,0xc,_0x59d7b4[0x5]),_0x1a7b21=_0x45366e(_0x1a7b21,_0x4f2ec8,_0x4d760a,_0x2ae8b1,_0x1a4c56,0x11,_0x59d7b4[0x6]),_0x2ae8b1=_0x45366e(_0x2ae8b1,_0x1a7b21,_0x4f2ec8,_0x4d760a,_0x20bf81,0x16,_0x59d7b4[0x7]),_0x4d760a=_0x45366e(_0x4d760a,_0x2ae8b1,_0x1a7b21,_0x4f2ec8,_0x15e35d,0x7,_0x59d7b4[0x8]),_0x4f2ec8=_0x45366e(_0x4f2ec8,_0x4d760a,_0x2ae8b1,_0x1a7b21,_0x514906,0xc,_0x59d7b4[0x9]),_0x1a7b21=_0x45366e(_0x1a7b21,_0x4f2ec8,_0x4d760a,_0x2ae8b1,_0x544add,0x11,_0x59d7b4[0xa]),_0x2ae8b1=_0x45366e(_0x2ae8b1,_0x1a7b21,_0x4f2ec8,_0x4d760a,_0x161bfd,0x16,_0x59d7b4[0xb]),_0x4d760a=_0x45366e(_0x4d760a,_0x2ae8b1,_0x1a7b21,_0x4f2ec8,_0x474412,0x7,_0x59d7b4[0xc]),_0x4f2ec8=_0x45366e(_0x4f2ec8,_0x4d760a,_0x2ae8b1,_0x1a7b21,_0x5aa7e7,0xc,_0x59d7b4[0xd]),_0x1a7b21=_0x45366e(_0x1a7b21,_0x4f2ec8,_0x4d760a,_0x2ae8b1,_0x555b88,0x11,_0x59d7b4[0xe]),_0x2ae8b1=_0x45366e(_0x2ae8b1,_0x1a7b21,_0x4f2ec8,_0x4d760a,_0x31906b,0x16,_0x59d7b4[0xf]),_0x4d760a=_0x567e2b(_0x4d760a,_0x2ae8b1,_0x1a7b21,_0x4f2ec8,_0x3b88ab,0x5,_0x59d7b4[0x10]),_0x4f2ec8=_0x567e2b(_0x4f2ec8,_0x4d760a,_0x2ae8b1,_0x1a7b21,_0x1a4c56,0x9,_0x59d7b4[0x11]),_0x1a7b21=_0x567e2b(_0x1a7b21,_0x4f2ec8,_0x4d760a,_0x2ae8b1,_0x161bfd,0xe,_0x59d7b4[0x12]),_0x2ae8b1=_0x567e2b(_0x2ae8b1,_0x1a7b21,_0x4f2ec8,_0x4d760a,_0x474732,0x14,_0x59d7b4[0x13]),_0x4d760a=_0x567e2b(_0x4d760a,_0x2ae8b1,_0x1a7b21,_0x4f2ec8,_0x537878,0x5,_0x59d7b4[0x14]),_0x4f2ec8=_0x567e2b(_0x4f2ec8,_0x4d760a,_0x2ae8b1,_0x1a7b21,_0x544add,0x9,_0x59d7b4[0x15]),_0x1a7b21=_0x567e2b(_0x1a7b21,_0x4f2ec8,_0x4d760a,_0x2ae8b1,_0x31906b,0xe,_0x59d7b4[0x16]),_0x2ae8b1=_0x567e2b(_0x2ae8b1,_0x1a7b21,_0x4f2ec8,_0x4d760a,_0x21c4fa,0x14,_0x59d7b4[0x17]),_0x4d760a=_0x567e2b(_0x4d760a,_0x2ae8b1,_0x1a7b21,_0x4f2ec8,_0x514906,0x5,_0x59d7b4[0x18]),_0x4f2ec8=_0x567e2b(_0x4f2ec8,_0x4d760a,_0x2ae8b1,_0x1a7b21,_0x555b88,0x9,_0x59d7b4[0x19]),_0x1a7b21=_0x567e2b(_0x1a7b21,_0x4f2ec8,_0x4d760a,_0x2ae8b1,_0x488856,0xe,_0x59d7b4[0x1a]),_0x2ae8b1=_0x567e2b(_0x2ae8b1,_0x1a7b21,_0x4f2ec8,_0x4d760a,_0x15e35d,0x14,_0x59d7b4[0x1b]),_0x4d760a=_0x567e2b(_0x4d760a,_0x2ae8b1,_0x1a7b21,_0x4f2ec8,_0x5aa7e7,0x5,_0x59d7b4[0x1c]),_0x4f2ec8=_0x567e2b(_0x4f2ec8,_0x4d760a,_0x2ae8b1,_0x1a7b21,_0x30120d,0x9,_0x59d7b4[0x1d]),_0x1a7b21=_0x567e2b(_0x1a7b21,_0x4f2ec8,_0x4d760a,_0x2ae8b1,_0x20bf81,0xe,_0x59d7b4[0x1e]),_0x2ae8b1=_0x567e2b(_0x2ae8b1,_0x1a7b21,_0x4f2ec8,_0x4d760a,_0x474412,0x14,_0x59d7b4[0x1f]),_0x4d760a=_0x1013d2(_0x4d760a,_0x2ae8b1,_0x1a7b21,_0x4f2ec8,_0x537878,0x4,_0x59d7b4[0x20]),_0x4f2ec8=_0x1013d2(_0x4f2ec8,_0x4d760a,_0x2ae8b1,_0x1a7b21,_0x15e35d,0xb,_0x59d7b4[0x21]),_0x1a7b21=_0x1013d2(_0x1a7b21,_0x4f2ec8,_0x4d760a,_0x2ae8b1,_0x161bfd,0x10,_0x59d7b4[0x22]),_0x2ae8b1=_0x1013d2(_0x2ae8b1,_0x1a7b21,_0x4f2ec8,_0x4d760a,_0x555b88,0x17,_0x59d7b4[0x23]),_0x4d760a=_0x1013d2(_0x4d760a,_0x2ae8b1,_0x1a7b21,_0x4f2ec8,_0x3b88ab,0x4,_0x59d7b4[0x24]),_0x4f2ec8=_0x1013d2(_0x4f2ec8,_0x4d760a,_0x2ae8b1,_0x1a7b21,_0x21c4fa,0xb,_0x59d7b4[0x25]),_0x1a7b21=_0x1013d2(_0x1a7b21,_0x4f2ec8,_0x4d760a,_0x2ae8b1,_0x20bf81,0x10,_0x59d7b4[0x26]),_0x2ae8b1=_0x1013d2(_0x2ae8b1,_0x1a7b21,_0x4f2ec8,_0x4d760a,_0x544add,0x17,_0x59d7b4[0x27]),_0x4d760a=_0x1013d2(_0x4d760a,_0x2ae8b1,_0x1a7b21,_0x4f2ec8,_0x5aa7e7,0x4,_0x59d7b4[0x28]),_0x4f2ec8=_0x1013d2(_0x4f2ec8,_0x4d760a,_0x2ae8b1,_0x1a7b21,_0x474732,0xb,_0x59d7b4[0x29]),_0x1a7b21=_0x1013d2(_0x1a7b21,_0x4f2ec8,_0x4d760a,_0x2ae8b1,_0x488856,0x10,_0x59d7b4[0x2a]),_0x2ae8b1=_0x1013d2(_0x2ae8b1,_0x1a7b21,_0x4f2ec8,_0x4d760a,_0x1a4c56,0x17,_0x59d7b4[0x2b]),_0x4d760a=_0x1013d2(_0x4d760a,_0x2ae8b1,_0x1a7b21,_0x4f2ec8,_0x514906,0x4,_0x59d7b4[0x2c]),_0x4f2ec8=_0x1013d2(_0x4f2ec8,_0x4d760a,_0x2ae8b1,_0x1a7b21,_0x474412,0xb,_0x59d7b4[0x2d]),_0x1a7b21=_0x1013d2(_0x1a7b21,_0x4f2ec8,_0x4d760a,_0x2ae8b1,_0x31906b,0x10,_0x59d7b4[0x2e]),_0x2ae8b1=_0x1013d2(_0x2ae8b1,_0x1a7b21,_0x4f2ec8,_0x4d760a,_0x30120d,0x17,_0x59d7b4[0x2f]),_0x4d760a=_0x12cc3b(_0x4d760a,_0x2ae8b1,_0x1a7b21,_0x4f2ec8,_0x474732,0x6,_0x59d7b4[0x30]),_0x4f2ec8=_0x12cc3b(_0x4f2ec8,_0x4d760a,_0x2ae8b1,_0x1a7b21,_0x20bf81,0xa,_0x59d7b4[0x31]),_0x1a7b21=_0x12cc3b(_0x1a7b21,_0x4f2ec8,_0x4d760a,_0x2ae8b1,_0x555b88,0xf,_0x59d7b4[0x32]),_0x2ae8b1=_0x12cc3b(_0x2ae8b1,_0x1a7b21,_0x4f2ec8,_0x4d760a,_0x537878,0x15,_0x59d7b4[0x33]),_0x4d760a=_0x12cc3b(_0x4d760a,_0x2ae8b1,_0x1a7b21,_0x4f2ec8,_0x474412,0x6,_0x59d7b4[0x34]),_0x4f2ec8=_0x12cc3b(_0x4f2ec8,_0x4d760a,_0x2ae8b1,_0x1a7b21,_0x488856,0xa,_0x59d7b4[0x35]),_0x1a7b21=_0x12cc3b(_0x1a7b21,_0x4f2ec8,_0x4d760a,_0x2ae8b1,_0x544add,0xf,_0x59d7b4[0x36]),_0x2ae8b1=_0x12cc3b(_0x2ae8b1,_0x1a7b21,_0x4f2ec8,_0x4d760a,_0x3b88ab,0x15,_0x59d7b4[0x37]),_0x4d760a=_0x12cc3b(_0x4d760a,_0x2ae8b1,_0x1a7b21,_0x4f2ec8,_0x15e35d,0x6,_0x59d7b4[0x38]),_0x4f2ec8=_0x12cc3b(_0x4f2ec8,_0x4d760a,_0x2ae8b1,_0x1a7b21,_0x31906b,0xa,_0x59d7b4[0x39]),_0x1a7b21=_0x12cc3b(_0x1a7b21,_0x4f2ec8,_0x4d760a,_0x2ae8b1,_0x1a4c56,0xf,_0x59d7b4[0x3a]),_0x2ae8b1=_0x12cc3b(_0x2ae8b1,_0x1a7b21,_0x4f2ec8,_0x4d760a,_0x5aa7e7,0x15,_0x59d7b4[0x3b]),_0x4d760a=_0x12cc3b(_0x4d760a,_0x2ae8b1,_0x1a7b21,_0x4f2ec8,_0x21c4fa,0x6,_0x59d7b4[0x3c]),_0x4f2ec8=_0x12cc3b(_0x4f2ec8,_0x4d760a,_0x2ae8b1,_0x1a7b21,_0x161bfd,0xa,_0x59d7b4[0x3d]),_0x1a7b21=_0x12cc3b(_0x1a7b21,_0x4f2ec8,_0x4d760a,_0x2ae8b1,_0x30120d,0xf,_0x59d7b4[0x3e]),_0x2ae8b1=_0x12cc3b(_0x2ae8b1,_0x1a7b21,_0x4f2ec8,_0x4d760a,_0x514906,0x15,_0x59d7b4[0x3f]),_0x3a404a[0x0]=_0x3a404a[0x0]+_0x4d760a|0x0,_0x3a404a[0x1]=_0x3a404a[0x1]+_0x2ae8b1|0x0,_0x3a404a[0x2]=_0x3a404a[0x2]+_0x1a7b21|0x0,_0x3a404a[0x3]=_0x3a404a[0x3]+_0x4f2ec8|0x0;},'_doFinalize':function(){var _0x3f6b84=_0x6a89cf,_0x587b79=this[_0x3f6b84(0x4cb)],_0x5f01ef=_0x587b79[_0x3f6b84(0x30d)],_0x1d69ce=this[_0x3f6b84(0x3b8)]*0x8,_0x14bbf4=_0x587b79[_0x3f6b84(0x4c3)]*0x8;_0x5f01ef[_0x14bbf4>>>0x5]|=0x80<<0x18-_0x14bbf4%0x20;var _0x5cab99=_0x21f3b3[_0x3f6b84(0x20f)](_0x1d69ce/0x100000000),_0x11369c=_0x1d69ce;_0x5f01ef[(_0x14bbf4+0x40>>>0x9<<0x4)+0xf]=(_0x5cab99<<0x8|_0x5cab99>>>0x18)&0xff00ff|(_0x5cab99<<0x18|_0x5cab99>>>0x8)&0xff00ff00,_0x5f01ef[(_0x14bbf4+0x40>>>0x9<<0x4)+0xe]=(_0x11369c<<0x8|_0x11369c>>>0x18)&0xff00ff|(_0x11369c<<0x18|_0x11369c>>>0x8)&0xff00ff00,_0x587b79[_0x3f6b84(0x4c3)]=(_0x5f01ef[_0x3f6b84(0x307)]+0x1)*0x4,this[_0x3f6b84(0x2df)]();for(var _0x5d7e15=this['_hash'],_0x1cdbdb=_0x5d7e15[_0x3f6b84(0x30d)],_0x3ea2a1=0x0;_0x3ea2a1<0x4;_0x3ea2a1++){var _0x4e1551=_0x1cdbdb[_0x3ea2a1];_0x1cdbdb[_0x3ea2a1]=(_0x4e1551<<0x8|_0x4e1551>>>0x18)&0xff00ff|(_0x4e1551<<0x18|_0x4e1551>>>0x8)&0xff00ff00;}return _0x5d7e15;},'clone':function(){var _0x1f084f=_0x6a89cf,_0x46b3a2=_0x562707['clone'][_0x1f084f(0x23d)](this);return _0x46b3a2[_0x1f084f(0x38c)]=this[_0x1f084f(0x38c)][_0x1f084f(0x4e2)](),_0x46b3a2;}});function _0x45366e(_0x1aded9,_0x2eb5ca,_0x5d0e68,_0x13ff4b,_0x421305,_0x1712ad,_0x52d2e9){var _0x206ff7=_0x1aded9+(_0x2eb5ca&_0x5d0e68|~_0x2eb5ca&_0x13ff4b)+_0x421305+_0x52d2e9;return(_0x206ff7<<_0x1712ad|_0x206ff7>>>0x20-_0x1712ad)+_0x2eb5ca;}function _0x567e2b(_0x2ea22a,_0x2a5c03,_0x3a62d4,_0x19783e,_0x392f84,_0x29f86e,_0x498569){var _0x4a7c1d=_0x2ea22a+(_0x2a5c03&_0x19783e|_0x3a62d4&~_0x19783e)+_0x392f84+_0x498569;return(_0x4a7c1d<<_0x29f86e|_0x4a7c1d>>>0x20-_0x29f86e)+_0x2a5c03;}function _0x1013d2(_0xab64cc,_0x31e227,_0x3ea837,_0x3b206c,_0x577529,_0x12fff6,_0x35e5f9){var _0x5dd2d9=_0xab64cc+(_0x31e227^_0x3ea837^_0x3b206c)+_0x577529+_0x35e5f9;return(_0x5dd2d9<<_0x12fff6|_0x5dd2d9>>>0x20-_0x12fff6)+_0x31e227;}function _0x12cc3b(_0x460be5,_0x11164e,_0x5df081,_0x5b7792,_0x538c5c,_0x5b8192,_0x362ced){var _0x4efd19=_0x460be5+(_0x5df081^(_0x11164e|~_0x5b7792))+_0x538c5c+_0x362ced;return(_0x4efd19<<_0x5b8192|_0x4efd19>>>0x20-_0x5b8192)+_0x11164e;}_0x541143['MD5']=_0x562707['_createHelper'](_0x12340f),_0x541143[_0x6a89cf(0x284)]=_0x562707[_0x6a89cf(0x3c0)](_0x12340f);}(Math),_0x2f9073[_0x2aa6c2(0x363)];}));}(_0x5ec732)),_0x5ec732[_0x4f82e4(0x523)];}var _0x3166b2={'exports':{}},_0x3f8942={'exports':{}},_0x56d242=_0x3f8942[_0x997d7(0x523)],_0x32e28e;function _0x289822(){return _0x32e28e||(_0x32e28e=0x1,function(_0x4b3f89,_0x328ac7){(function(_0x4e7699,_0x5c9337){var _0x7b16e2=_0x4ecd;_0x4b3f89[_0x7b16e2(0x523)]=_0x5c9337(_0x45d273());}(_0x56d242,function(_0x484afd){return(function(){var _0x856719=_0x4ecd,_0x432278=_0x484afd,_0x4302c5=_0x432278[_0x856719(0x3ff)],_0x47a8c3=_0x4302c5[_0x856719(0x466)],_0x225aa1=_0x4302c5[_0x856719(0x46c)],_0x531006=_0x432278['algo'],_0x51f9a4=[],_0xe26dc8=_0x531006['SHA1']=_0x225aa1['extend']({'_doReset':function(){var _0x33ffc9=_0x856719;this[_0x33ffc9(0x38c)]=new _0x47a8c3[(_0x33ffc9(0x369))]([0x67452301,0xefcdab89,0x98badcfe,0x10325476,0xc3d2e1f0]);},'_doProcessBlock':function(_0x40cfae,_0x16e7e5){var _0x139244=_0x856719;for(var _0x4389be=this[_0x139244(0x38c)][_0x139244(0x30d)],_0x1e562a=_0x4389be[0x0],_0x1abb99=_0x4389be[0x1],_0x5425d4=_0x4389be[0x2],_0x225f79=_0x4389be[0x3],_0x39816d=_0x4389be[0x4],_0xe49f0=0x0;_0xe49f0<0x50;_0xe49f0++){if(_0xe49f0<0x10)_0x51f9a4[_0xe49f0]=_0x40cfae[_0x16e7e5+_0xe49f0]|0x0;else{var _0x300133=_0x51f9a4[_0xe49f0-0x3]^_0x51f9a4[_0xe49f0-0x8]^_0x51f9a4[_0xe49f0-0xe]^_0x51f9a4[_0xe49f0-0x10];_0x51f9a4[_0xe49f0]=_0x300133<<0x1|_0x300133>>>0x1f;}var _0x2bb428=(_0x1e562a<<0x5|_0x1e562a>>>0x1b)+_0x39816d+_0x51f9a4[_0xe49f0];_0xe49f0<0x14?_0x2bb428+=(_0x1abb99&_0x5425d4|~_0x1abb99&_0x225f79)+0x5a827999:_0xe49f0<0x28?_0x2bb428+=(_0x1abb99^_0x5425d4^_0x225f79)+0x6ed9eba1:_0xe49f0<0x3c?_0x2bb428+=(_0x1abb99&_0x5425d4|_0x1abb99&_0x225f79|_0x5425d4&_0x225f79)-0x70e44324:_0x2bb428+=(_0x1abb99^_0x5425d4^_0x225f79)-0x359d3e2a,_0x39816d=_0x225f79,_0x225f79=_0x5425d4,_0x5425d4=_0x1abb99<<0x1e|_0x1abb99>>>0x2,_0x1abb99=_0x1e562a,_0x1e562a=_0x2bb428;}_0x4389be[0x0]=_0x4389be[0x0]+_0x1e562a|0x0,_0x4389be[0x1]=_0x4389be[0x1]+_0x1abb99|0x0,_0x4389be[0x2]=_0x4389be[0x2]+_0x5425d4|0x0,_0x4389be[0x3]=_0x4389be[0x3]+_0x225f79|0x0,_0x4389be[0x4]=_0x4389be[0x4]+_0x39816d|0x0;},'_doFinalize':function(){var _0x30274e=_0x856719,_0x2be16c=this['_data'],_0x4196ee=_0x2be16c[_0x30274e(0x30d)],_0x1c47e0=this[_0x30274e(0x3b8)]*0x8,_0x458afb=_0x2be16c[_0x30274e(0x4c3)]*0x8;return _0x4196ee[_0x458afb>>>0x5]|=0x80<<0x18-_0x458afb%0x20,_0x4196ee[(_0x458afb+0x40>>>0x9<<0x4)+0xe]=Math[_0x30274e(0x20f)](_0x1c47e0/0x100000000),_0x4196ee[(_0x458afb+0x40>>>0x9<<0x4)+0xf]=_0x1c47e0,_0x2be16c[_0x30274e(0x4c3)]=_0x4196ee[_0x30274e(0x307)]*0x4,this[_0x30274e(0x2df)](),this[_0x30274e(0x38c)];},'clone':function(){var _0x173502=_0x856719,_0x20fe5b=_0x225aa1[_0x173502(0x4e2)][_0x173502(0x23d)](this);return _0x20fe5b[_0x173502(0x38c)]=this[_0x173502(0x38c)][_0x173502(0x4e2)](),_0x20fe5b;}});_0x432278[_0x856719(0x43d)]=_0x225aa1[_0x856719(0x2de)](_0xe26dc8),_0x432278[_0x856719(0x22a)]=_0x225aa1['_createHmacHelper'](_0xe26dc8);}()),_0x484afd['SHA1'];}));}(_0x3f8942)),_0x3f8942['exports'];}var _0x389ad1={'exports':{}},_0x20bc14=_0x389ad1['exports'],_0xf8f1c0;function _0x4d828e(){return _0xf8f1c0||(_0xf8f1c0=0x1,function(_0x5cee00,_0xdac81c){(function(_0x2e1db6,_0x5bb6f0){var _0x365146=_0x4ecd;_0x5cee00[_0x365146(0x523)]=_0x5bb6f0(_0x45d273());}(_0x20bc14,function(_0x22273c){(function(){var _0x358c17=_0x4ecd,_0x3b9f8=_0x22273c,_0x1f6f6a=_0x3b9f8[_0x358c17(0x3ff)],_0x41e1cd=_0x1f6f6a[_0x358c17(0x413)],_0x350cca=_0x3b9f8['enc'],_0x15565f=_0x350cca[_0x358c17(0x3b6)],_0x381d1d=_0x3b9f8[_0x358c17(0x49c)];_0x381d1d[_0x358c17(0x465)]=_0x41e1cd['extend']({'init':function(_0x2916a4,_0x3cf25b){var _0x631dd=_0x358c17;_0x2916a4=this['_hasher']=new _0x2916a4[(_0x631dd(0x369))](),typeof _0x3cf25b==_0x631dd(0x2f0)&&(_0x3cf25b=_0x15565f[_0x631dd(0x487)](_0x3cf25b));var _0xe7811c=_0x2916a4[_0x631dd(0x488)],_0x5eb78c=_0xe7811c*0x4;_0x3cf25b['sigBytes']>_0x5eb78c&&(_0x3cf25b=_0x2916a4[_0x631dd(0x4a3)](_0x3cf25b)),_0x3cf25b['clamp']();for(var _0x2d889e=this[_0x631dd(0x222)]=_0x3cf25b[_0x631dd(0x4e2)](),_0x281e7a=this[_0x631dd(0x2db)]=_0x3cf25b['clone'](),_0x4f9bff=_0x2d889e['words'],_0x582289=_0x281e7a[_0x631dd(0x30d)],_0x328f69=0x0;_0x328f69<_0xe7811c;_0x328f69++)_0x4f9bff[_0x328f69]^=0x5c5c5c5c,_0x582289[_0x328f69]^=0x36363636;_0x2d889e[_0x631dd(0x4c3)]=_0x281e7a[_0x631dd(0x4c3)]=_0x5eb78c,this[_0x631dd(0x214)]();},'reset':function(){var _0x1cb8f9=_0x358c17,_0x3bd56c=this[_0x1cb8f9(0x4b7)];_0x3bd56c[_0x1cb8f9(0x214)](),_0x3bd56c[_0x1cb8f9(0x550)](this[_0x1cb8f9(0x2db)]);},'update':function(_0x53295c){var _0x2087f=_0x358c17;return this[_0x2087f(0x4b7)][_0x2087f(0x550)](_0x53295c),this;},'finalize':function(_0x5c4401){var _0x3bb3fd=_0x358c17,_0x2c67a3=this[_0x3bb3fd(0x4b7)],_0x583d2b=_0x2c67a3['finalize'](_0x5c4401);_0x2c67a3[_0x3bb3fd(0x214)]();var _0x32d0ea=_0x2c67a3['finalize'](this[_0x3bb3fd(0x222)][_0x3bb3fd(0x4e2)]()[_0x3bb3fd(0x4e1)](_0x583d2b));return _0x32d0ea;}});}());}));}(_0x389ad1)),_0x389ad1['exports'];}var _0x5e79b0=_0x3166b2[_0x997d7(0x523)],_0x50c53d;function _0x1c1feb(){return _0x50c53d||(_0x50c53d=0x1,function(_0x1a0ab3,_0x126a49){(function(_0x4f5f1e,_0x8db3a6,_0x4d5e4b){var _0x10eca7=_0x4ecd;_0x1a0ab3[_0x10eca7(0x523)]=_0x8db3a6(_0x45d273(),_0x289822(),_0x4d828e());}(_0x5e79b0,function(_0x5bb806){var _0x3c61d5=_0x4ecd;return(function(){var _0xa2e663=_0x4ecd,_0x45eced=_0x5bb806,_0x5aea21=_0x45eced['lib'],_0x4626fe=_0x5aea21[_0xa2e663(0x413)],_0x38277c=_0x5aea21[_0xa2e663(0x466)],_0x2ea8f2=_0x45eced[_0xa2e663(0x49c)],_0x1949b4=_0x2ea8f2[_0xa2e663(0x363)],_0x2a52c5=_0x2ea8f2[_0xa2e663(0x43f)]=_0x4626fe['extend']({'cfg':_0x4626fe[_0xa2e663(0x202)]({'keySize':0x80/0x20,'hasher':_0x1949b4,'iterations':0x1}),'init':function(_0x3b8a82){var _0x324830=_0xa2e663;this[_0x324830(0x566)]=this[_0x324830(0x566)]['extend'](_0x3b8a82);},'compute':function(_0x14cd7f,_0x573e64){var _0x25f0c3=_0xa2e663;for(var _0x5cb2f3,_0x35bf28=this[_0x25f0c3(0x566)],_0x5cd1a9=_0x35bf28['hasher'][_0x25f0c3(0x3e7)](),_0x11e4e2=_0x38277c[_0x25f0c3(0x3e7)](),_0xb37c8d=_0x11e4e2[_0x25f0c3(0x30d)],_0x1a5659=_0x35bf28[_0x25f0c3(0x215)],_0x139266=_0x35bf28[_0x25f0c3(0x2fa)];_0xb37c8d['length']<_0x1a5659;){_0x5cb2f3&&_0x5cd1a9[_0x25f0c3(0x550)](_0x5cb2f3),_0x5cb2f3=_0x5cd1a9[_0x25f0c3(0x550)](_0x14cd7f)[_0x25f0c3(0x4a3)](_0x573e64),_0x5cd1a9['reset']();for(var _0x46f33b=0x1;_0x46f33b<_0x139266;_0x46f33b++)_0x5cb2f3=_0x5cd1a9[_0x25f0c3(0x4a3)](_0x5cb2f3),_0x5cd1a9[_0x25f0c3(0x214)]();_0x11e4e2[_0x25f0c3(0x4e1)](_0x5cb2f3);}return _0x11e4e2['sigBytes']=_0x1a5659*0x4,_0x11e4e2;}});_0x45eced[_0xa2e663(0x43f)]=function(_0x208d6d,_0x1f7e42,_0x5939c2){var _0x5c5636=_0xa2e663;return _0x2a52c5[_0x5c5636(0x3e7)](_0x5939c2)[_0x5c5636(0x40c)](_0x208d6d,_0x1f7e42);};}()),_0x5bb806[_0x3c61d5(0x43f)];}));}(_0x3166b2)),_0x3166b2['exports'];}var _0xa3df45={'exports':{}},_0x282986=_0xa3df45[_0x997d7(0x523)],_0x22a4a9;function _0xe5b910(){var _0x34b1e2=_0x997d7;return _0x22a4a9||(_0x22a4a9=0x1,function(_0x3b7309,_0x2683a7){(function(_0x4ac4f0,_0x5d1882,_0x11fa7d){_0x3b7309['exports']=_0x5d1882(_0x45d273(),_0x1c1feb());}(_0x282986,function(_0x11a209){var _0x180f95=_0x4ecd;_0x11a209[_0x180f95(0x3ff)][_0x180f95(0x2be)]||function(_0x1fec6a){var _0x2847f3=_0x180f95,_0x153729=_0x11a209,_0x28885e=_0x153729[_0x2847f3(0x3ff)],_0x22c4a4=_0x28885e[_0x2847f3(0x413)],_0x351338=_0x28885e['WordArray'],_0x41d7f5=_0x28885e['BufferedBlockAlgorithm'],_0xa374d2=_0x153729['enc'];_0xa374d2[_0x2847f3(0x3b6)];var _0x1c275e=_0xa374d2[_0x2847f3(0x1e9)],_0x5685ce=_0x153729['algo'],_0x159fd4=_0x5685ce[_0x2847f3(0x43f)],_0x4d63b7=_0x28885e[_0x2847f3(0x2be)]=_0x41d7f5[_0x2847f3(0x202)]({'cfg':_0x22c4a4['extend'](),'createEncryptor':function(_0x34b077,_0x193af2){var _0x1f2dbb=_0x2847f3;return this[_0x1f2dbb(0x3e7)](this[_0x1f2dbb(0x24c)],_0x34b077,_0x193af2);},'createDecryptor':function(_0x46187f,_0x5f4555){var _0x2b5794=_0x2847f3;return this[_0x2b5794(0x3e7)](this[_0x2b5794(0x345)],_0x46187f,_0x5f4555);},'init':function(_0x391803,_0x2253da,_0x321056){var _0x90eb7=_0x2847f3;this[_0x90eb7(0x566)]=this[_0x90eb7(0x566)][_0x90eb7(0x202)](_0x321056),this[_0x90eb7(0x411)]=_0x391803,this[_0x90eb7(0x233)]=_0x2253da,this[_0x90eb7(0x214)]();},'reset':function(){var _0x4a10a9=_0x2847f3;_0x41d7f5[_0x4a10a9(0x214)][_0x4a10a9(0x23d)](this),this[_0x4a10a9(0x4fe)]();},'process':function(_0x1e9c46){var _0x2858fc=_0x2847f3;return this[_0x2858fc(0x51a)](_0x1e9c46),this[_0x2858fc(0x2df)]();},'finalize':function(_0x2ea426){var _0x2df93c=_0x2847f3;_0x2ea426&&this['_append'](_0x2ea426);var _0x212573=this[_0x2df93c(0x3c3)]();return _0x212573;},'keySize':0x80/0x20,'ivSize':0x80/0x20,'_ENC_XFORM_MODE':0x1,'_DEC_XFORM_MODE':0x2,'_createHelper':(function(){function _0x51b826(_0x50bef4){return typeof _0x50bef4=='string'?_0x1da02e:_0x5b0ed2;}return function(_0x4f53eb){return{'encrypt':function(_0x140505,_0x1fe4e5,_0x1cf046){var _0x48f0f2=_0x4ecd;return _0x51b826(_0x1fe4e5)[_0x48f0f2(0x1eb)](_0x4f53eb,_0x140505,_0x1fe4e5,_0x1cf046);},'decrypt':function(_0x33df46,_0x4bbc9b,_0x13b769){var _0x21f937=_0x4ecd;return _0x51b826(_0x4bbc9b)[_0x21f937(0x444)](_0x4f53eb,_0x33df46,_0x4bbc9b,_0x13b769);}};};}())});_0x28885e[_0x2847f3(0x4aa)]=_0x4d63b7[_0x2847f3(0x202)]({'_doFinalize':function(){var _0x179a30=_0x2847f3,_0x263b11=this[_0x179a30(0x2df)](!0x0);return _0x263b11;},'blockSize':0x1});var _0x539243=_0x153729['mode']={},_0x110716=_0x28885e['BlockCipherMode']=_0x22c4a4[_0x2847f3(0x202)]({'createEncryptor':function(_0x58b12f,_0x28cf4e){var _0x1fd698=_0x2847f3;return this[_0x1fd698(0x531)][_0x1fd698(0x3e7)](_0x58b12f,_0x28cf4e);},'createDecryptor':function(_0x5b93c4,_0x33d9cb){var _0x4a44fa=_0x2847f3;return this['Decryptor'][_0x4a44fa(0x3e7)](_0x5b93c4,_0x33d9cb);},'init':function(_0x3a7704,_0x113170){var _0x344259=_0x2847f3;this['_cipher']=_0x3a7704,this[_0x344259(0x393)]=_0x113170;}}),_0x11f34c=_0x539243[_0x2847f3(0x501)]=(function(){var _0x3f0045=_0x2847f3,_0x302441=_0x110716['extend']();_0x302441[_0x3f0045(0x531)]=_0x302441['extend']({'processBlock':function(_0x2b1750,_0x457cee){var _0x52a310=_0x3f0045,_0x49239c=this[_0x52a310(0x376)],_0x4101c3=_0x49239c['blockSize'];_0x269631[_0x52a310(0x23d)](this,_0x2b1750,_0x457cee,_0x4101c3),_0x49239c[_0x52a310(0x49a)](_0x2b1750,_0x457cee),this[_0x52a310(0x2f4)]=_0x2b1750[_0x52a310(0x3c4)](_0x457cee,_0x457cee+_0x4101c3);}}),_0x302441[_0x3f0045(0x387)]=_0x302441[_0x3f0045(0x202)]({'processBlock':function(_0xd7d115,_0x139160){var _0x13269b=_0x3f0045,_0x58b2d8=this[_0x13269b(0x376)],_0x1d82d7=_0x58b2d8[_0x13269b(0x488)],_0x22d259=_0xd7d115[_0x13269b(0x3c4)](_0x139160,_0x139160+_0x1d82d7);_0x58b2d8[_0x13269b(0x54f)](_0xd7d115,_0x139160),_0x269631[_0x13269b(0x23d)](this,_0xd7d115,_0x139160,_0x1d82d7),this[_0x13269b(0x2f4)]=_0x22d259;}});function _0x269631(_0x4710c5,_0x49ed55,_0x68ebe8){var _0x6306da=_0x3f0045,_0x2f1587,_0x5b393e=this['_iv'];_0x5b393e?(_0x2f1587=_0x5b393e,this[_0x6306da(0x393)]=_0x1fec6a):_0x2f1587=this[_0x6306da(0x2f4)];for(var _0x205658=0x0;_0x205658<_0x68ebe8;_0x205658++)_0x4710c5[_0x49ed55+_0x205658]^=_0x2f1587[_0x205658];}return _0x302441;}()),_0x5beb2b=_0x153729[_0x2847f3(0x577)]={},_0x1646e9=_0x5beb2b['Pkcs7']={'pad':function(_0xff2cdd,_0x3c2885){var _0x174f1e=_0x2847f3;for(var _0x3467d7=_0x3c2885*0x4,_0x201c2f=_0x3467d7-_0xff2cdd[_0x174f1e(0x4c3)]%_0x3467d7,_0x131c70=_0x201c2f<<0x18|_0x201c2f<<0x10|_0x201c2f<<0x8|_0x201c2f,_0x50d50a=[],_0x351d11=0x0;_0x351d11<_0x201c2f;_0x351d11+=0x4)_0x50d50a[_0x174f1e(0x3f6)](_0x131c70);var _0xde456e=_0x351338[_0x174f1e(0x3e7)](_0x50d50a,_0x201c2f);_0xff2cdd[_0x174f1e(0x4e1)](_0xde456e);},'unpad':function(_0x2498ef){var _0x37dd94=_0x2847f3,_0x271fbe=_0x2498ef[_0x37dd94(0x30d)][_0x2498ef[_0x37dd94(0x4c3)]-0x1>>>0x2]&0xff;_0x2498ef[_0x37dd94(0x4c3)]-=_0x271fbe;}};_0x28885e['BlockCipher']=_0x4d63b7[_0x2847f3(0x202)]({'cfg':_0x4d63b7[_0x2847f3(0x566)][_0x2847f3(0x202)]({'mode':_0x11f34c,'padding':_0x1646e9}),'reset':function(){var _0x347363=_0x2847f3,_0x239e92;_0x4d63b7[_0x347363(0x214)][_0x347363(0x23d)](this);var _0x57f4b4=this[_0x347363(0x566)],_0x1b608a=_0x57f4b4['iv'],_0x1dd7ff=_0x57f4b4['mode'];this['_xformMode']==this[_0x347363(0x24c)]?_0x239e92=_0x1dd7ff[_0x347363(0x39e)]:(_0x239e92=_0x1dd7ff[_0x347363(0x4e9)],this[_0x347363(0x470)]=0x1),this['_mode']&&this[_0x347363(0x547)][_0x347363(0x3b3)]==_0x239e92?this[_0x347363(0x547)][_0x347363(0x369)](this,_0x1b608a&&_0x1b608a[_0x347363(0x30d)]):(this[_0x347363(0x547)]=_0x239e92[_0x347363(0x23d)](_0x1dd7ff,this,_0x1b608a&&_0x1b608a[_0x347363(0x30d)]),this['_mode'][_0x347363(0x3b3)]=_0x239e92);},'_doProcessBlock':function(_0x5a1d1e,_0x344b0a){var _0x3e9d54=_0x2847f3;this[_0x3e9d54(0x547)][_0x3e9d54(0x474)](_0x5a1d1e,_0x344b0a);},'_doFinalize':function(){var _0x28f54d=_0x2847f3,_0x1979f6,_0x296243=this[_0x28f54d(0x566)][_0x28f54d(0x50f)];return this[_0x28f54d(0x411)]==this[_0x28f54d(0x24c)]?(_0x296243[_0x28f54d(0x577)](this[_0x28f54d(0x4cb)],this[_0x28f54d(0x488)]),_0x1979f6=this[_0x28f54d(0x2df)](!0x0)):(_0x1979f6=this[_0x28f54d(0x2df)](!0x0),_0x296243['unpad'](_0x1979f6)),_0x1979f6;},'blockSize':0x80/0x20});var _0x56644c=_0x28885e['CipherParams']=_0x22c4a4[_0x2847f3(0x202)]({'init':function(_0x18710f){var _0x34c9bf=_0x2847f3;this[_0x34c9bf(0x24f)](_0x18710f);},'toString':function(_0x48e118){var _0x7d4161=_0x2847f3;return(_0x48e118||this['formatter'])[_0x7d4161(0x22d)](this);}}),_0x187bf3=_0x153729[_0x2847f3(0x4ab)]={},_0x2663fe=_0x187bf3[_0x2847f3(0x2d8)]={'stringify':function(_0x48d6c6){var _0x5c3e24=_0x2847f3,_0x1217de,_0x5d3d8a=_0x48d6c6['ciphertext'],_0x17a623=_0x48d6c6[_0x5c3e24(0x4b0)];return _0x17a623?_0x1217de=_0x351338[_0x5c3e24(0x3e7)]([0x53616c74,0x65645f5f])[_0x5c3e24(0x4e1)](_0x17a623)[_0x5c3e24(0x4e1)](_0x5d3d8a):_0x1217de=_0x5d3d8a,_0x1217de[_0x5c3e24(0x3a6)](_0x1c275e);},'parse':function(_0x28bc48){var _0x5706fe=_0x2847f3,_0x437941,_0x307954=_0x1c275e['parse'](_0x28bc48),_0x59a54b=_0x307954['words'];return _0x59a54b[0x0]==0x53616c74&&_0x59a54b[0x1]==0x65645f5f&&(_0x437941=_0x351338['create'](_0x59a54b[_0x5706fe(0x3c4)](0x2,0x4)),_0x59a54b[_0x5706fe(0x425)](0x0,0x4),_0x307954[_0x5706fe(0x4c3)]-=0x10),_0x56644c['create']({'ciphertext':_0x307954,'salt':_0x437941});}},_0x5b0ed2=_0x28885e[_0x2847f3(0x209)]=_0x22c4a4[_0x2847f3(0x202)]({'cfg':_0x22c4a4[_0x2847f3(0x202)]({'format':_0x2663fe}),'encrypt':function(_0x547fb3,_0x3986d7,_0x617bcd,_0x2a6d35){var _0x543594=_0x2847f3;_0x2a6d35=this['cfg'][_0x543594(0x202)](_0x2a6d35);var _0x5c4d04=_0x547fb3[_0x543594(0x39e)](_0x617bcd,_0x2a6d35),_0x4a4fce=_0x5c4d04[_0x543594(0x4a3)](_0x3986d7),_0x4b5d75=_0x5c4d04[_0x543594(0x566)];return _0x56644c[_0x543594(0x3e7)]({'ciphertext':_0x4a4fce,'key':_0x617bcd,'iv':_0x4b5d75['iv'],'algorithm':_0x547fb3,'mode':_0x4b5d75[_0x543594(0x20c)],'padding':_0x4b5d75[_0x543594(0x50f)],'blockSize':_0x547fb3[_0x543594(0x488)],'formatter':_0x2a6d35[_0x543594(0x4ab)]});},'decrypt':function(_0xaf4d1a,_0x39b3a7,_0x231397,_0x2bf52e){var _0x3134d6=_0x2847f3;_0x2bf52e=this[_0x3134d6(0x566)][_0x3134d6(0x202)](_0x2bf52e),_0x39b3a7=this[_0x3134d6(0x1fd)](_0x39b3a7,_0x2bf52e[_0x3134d6(0x4ab)]);var _0x1c538b=_0xaf4d1a[_0x3134d6(0x4e9)](_0x231397,_0x2bf52e)[_0x3134d6(0x4a3)](_0x39b3a7[_0x3134d6(0x35b)]);return _0x1c538b;},'_parse':function(_0x1ee63a,_0x7a71d6){var _0x3410db=_0x2847f3;return typeof _0x1ee63a==_0x3410db(0x2f0)?_0x7a71d6[_0x3410db(0x487)](_0x1ee63a,this):_0x1ee63a;}}),_0x19075d=_0x153729['kdf']={},_0x1aa61c=_0x19075d[_0x2847f3(0x2d8)]={'execute':function(_0x5b55fa,_0x2b3fd8,_0x385c93,_0x3dd661,_0x29ae2b){var _0x8f5a64=_0x2847f3;if(_0x3dd661||(_0x3dd661=_0x351338[_0x8f5a64(0x4ad)](0x40/0x8)),_0x29ae2b)var _0x1f87ab=_0x159fd4[_0x8f5a64(0x3e7)]({'keySize':_0x2b3fd8+_0x385c93,'hasher':_0x29ae2b})[_0x8f5a64(0x40c)](_0x5b55fa,_0x3dd661);else var _0x1f87ab=_0x159fd4['create']({'keySize':_0x2b3fd8+_0x385c93})[_0x8f5a64(0x40c)](_0x5b55fa,_0x3dd661);var _0x2a8467=_0x351338[_0x8f5a64(0x3e7)](_0x1f87ab['words']['slice'](_0x2b3fd8),_0x385c93*0x4);return _0x1f87ab['sigBytes']=_0x2b3fd8*0x4,_0x56644c[_0x8f5a64(0x3e7)]({'key':_0x1f87ab,'iv':_0x2a8467,'salt':_0x3dd661});}},_0x1da02e=_0x28885e[_0x2847f3(0x372)]=_0x5b0ed2['extend']({'cfg':_0x5b0ed2['cfg']['extend']({'kdf':_0x1aa61c}),'encrypt':function(_0x6997d4,_0x158dd0,_0x272472,_0x4335af){var _0x34d463=_0x2847f3;_0x4335af=this[_0x34d463(0x566)]['extend'](_0x4335af);var _0x5c5919=_0x4335af[_0x34d463(0x538)]['execute'](_0x272472,_0x6997d4['keySize'],_0x6997d4[_0x34d463(0x3c5)],_0x4335af['salt'],_0x4335af[_0x34d463(0x45f)]);_0x4335af['iv']=_0x5c5919['iv'];var _0x491528=_0x5b0ed2[_0x34d463(0x1eb)][_0x34d463(0x23d)](this,_0x6997d4,_0x158dd0,_0x5c5919['key'],_0x4335af);return _0x491528['mixIn'](_0x5c5919),_0x491528;},'decrypt':function(_0x5a0e5b,_0x345f83,_0x2e90fd,_0x14742a){var _0x4a0291=_0x2847f3;_0x14742a=this[_0x4a0291(0x566)][_0x4a0291(0x202)](_0x14742a),_0x345f83=this[_0x4a0291(0x1fd)](_0x345f83,_0x14742a[_0x4a0291(0x4ab)]);var _0x80c04e=_0x14742a[_0x4a0291(0x538)][_0x4a0291(0x316)](_0x2e90fd,_0x5a0e5b['keySize'],_0x5a0e5b[_0x4a0291(0x3c5)],_0x345f83['salt'],_0x14742a[_0x4a0291(0x45f)]);_0x14742a['iv']=_0x80c04e['iv'];var _0x1e5efe=_0x5b0ed2[_0x4a0291(0x444)][_0x4a0291(0x23d)](this,_0x5a0e5b,_0x345f83,_0x80c04e[_0x4a0291(0x42e)],_0x14742a);return _0x1e5efe;}});}();}));}(_0xa3df45)),_0xa3df45[_0x34b1e2(0x523)];}var _0x289dc5=_0x367d61[_0x997d7(0x523)],_0x1927fd;function _0x2082ca(){var _0x1c2f27=_0x997d7;return _0x1927fd||(_0x1927fd=0x1,function(_0x467ee0,_0x5a8fe8){(function(_0x4dee76,_0x19de02,_0x5d653d){var _0x357353=_0x4ecd;_0x467ee0[_0x357353(0x523)]=_0x19de02(_0x45d273(),_0x12cba4(),_0x1a8182(),_0x1c1feb(),_0xe5b910());}(_0x289dc5,function(_0x4d8da5){var _0x5acecc=_0x4ecd;return(function(){var _0x17ab2d=_0x4ecd,_0x1aae6f=_0x4d8da5,_0x5d5acf=_0x1aae6f['lib'],_0x21f724=_0x5d5acf[_0x17ab2d(0x3bb)],_0x55252d=_0x1aae6f[_0x17ab2d(0x49c)],_0x160ee1=[],_0x4265e5=[],_0x5946dc=[],_0xc765b1=[],_0x64a963=[],_0x324b79=[],_0x267aaa=[],_0x58107b=[],_0x53d99f=[],_0x6d1b9c=[];(function(){for(var _0x429bdb=[],_0x522d8e=0x0;_0x522d8e<0x100;_0x522d8e++)_0x522d8e<0x80?_0x429bdb[_0x522d8e]=_0x522d8e<<0x1:_0x429bdb[_0x522d8e]=_0x522d8e<<0x1^0x11b;for(var _0x4bafb0=0x0,_0x499ee0=0x0,_0x522d8e=0x0;_0x522d8e<0x100;_0x522d8e++){var _0x5d931c=_0x499ee0^_0x499ee0<<0x1^_0x499ee0<<0x2^_0x499ee0<<0x3^_0x499ee0<<0x4;_0x5d931c=_0x5d931c>>>0x8^_0x5d931c&0xff^0x63,_0x160ee1[_0x4bafb0]=_0x5d931c,_0x4265e5[_0x5d931c]=_0x4bafb0;var _0x388906=_0x429bdb[_0x4bafb0],_0x40c27a=_0x429bdb[_0x388906],_0x183c39=_0x429bdb[_0x40c27a],_0x4bbb96=_0x429bdb[_0x5d931c]*0x101^_0x5d931c*0x1010100;_0x5946dc[_0x4bafb0]=_0x4bbb96<<0x18|_0x4bbb96>>>0x8,_0xc765b1[_0x4bafb0]=_0x4bbb96<<0x10|_0x4bbb96>>>0x10,_0x64a963[_0x4bafb0]=_0x4bbb96<<0x8|_0x4bbb96>>>0x18,_0x324b79[_0x4bafb0]=_0x4bbb96;var _0x4bbb96=_0x183c39*0x1010101^_0x40c27a*0x10001^_0x388906*0x101^_0x4bafb0*0x1010100;_0x267aaa[_0x5d931c]=_0x4bbb96<<0x18|_0x4bbb96>>>0x8,_0x58107b[_0x5d931c]=_0x4bbb96<<0x10|_0x4bbb96>>>0x10,_0x53d99f[_0x5d931c]=_0x4bbb96<<0x8|_0x4bbb96>>>0x18,_0x6d1b9c[_0x5d931c]=_0x4bbb96,_0x4bafb0?(_0x4bafb0=_0x388906^_0x429bdb[_0x429bdb[_0x429bdb[_0x183c39^_0x388906]]],_0x499ee0^=_0x429bdb[_0x429bdb[_0x499ee0]]):_0x4bafb0=_0x499ee0=0x1;}}());var _0x50adbf=[0x0,0x1,0x2,0x4,0x8,0x10,0x20,0x40,0x80,0x1b,0x36],_0xb14b98=_0x55252d[_0x17ab2d(0x4af)]=_0x21f724[_0x17ab2d(0x202)]({'_doReset':function(){var _0x420f6c=_0x17ab2d,_0x4c969a;if(!(this['_nRounds']&&this['_keyPriorReset']===this['_key'])){for(var _0x8cb025=this[_0x420f6c(0x2cf)]=this[_0x420f6c(0x233)],_0x1f88b5=_0x8cb025['words'],_0x51c4d6=_0x8cb025[_0x420f6c(0x4c3)]/0x4,_0x1422c3=this['_nRounds']=_0x51c4d6+0x6,_0x5103ef=(_0x1422c3+0x1)*0x4,_0x419ff8=this['_keySchedule']=[],_0x2002f6=0x0;_0x2002f6<_0x5103ef;_0x2002f6++)_0x2002f6<_0x51c4d6?_0x419ff8[_0x2002f6]=_0x1f88b5[_0x2002f6]:(_0x4c969a=_0x419ff8[_0x2002f6-0x1],_0x2002f6%_0x51c4d6?_0x51c4d6>0x6&&_0x2002f6%_0x51c4d6==0x4&&(_0x4c969a=_0x160ee1[_0x4c969a>>>0x18]<<0x18|_0x160ee1[_0x4c969a>>>0x10&0xff]<<0x10|_0x160ee1[_0x4c969a>>>0x8&0xff]<<0x8|_0x160ee1[_0x4c969a&0xff]):(_0x4c969a=_0x4c969a<<0x8|_0x4c969a>>>0x18,_0x4c969a=_0x160ee1[_0x4c969a>>>0x18]<<0x18|_0x160ee1[_0x4c969a>>>0x10&0xff]<<0x10|_0x160ee1[_0x4c969a>>>0x8&0xff]<<0x8|_0x160ee1[_0x4c969a&0xff],_0x4c969a^=_0x50adbf[_0x2002f6/_0x51c4d6|0x0]<<0x18),_0x419ff8[_0x2002f6]=_0x419ff8[_0x2002f6-_0x51c4d6]^_0x4c969a);for(var _0x221a96=this['_invKeySchedule']=[],_0x341846=0x0;_0x341846<_0x5103ef;_0x341846++){var _0x2002f6=_0x5103ef-_0x341846;if(_0x341846%0x4)var _0x4c969a=_0x419ff8[_0x2002f6];else var _0x4c969a=_0x419ff8[_0x2002f6-0x4];_0x341846<0x4||_0x2002f6<=0x4?_0x221a96[_0x341846]=_0x4c969a:_0x221a96[_0x341846]=_0x267aaa[_0x160ee1[_0x4c969a>>>0x18]]^_0x58107b[_0x160ee1[_0x4c969a>>>0x10&0xff]]^_0x53d99f[_0x160ee1[_0x4c969a>>>0x8&0xff]]^_0x6d1b9c[_0x160ee1[_0x4c969a&0xff]];}}},'encryptBlock':function(_0x383559,_0x441ced){var _0x35ca9f=_0x17ab2d;this[_0x35ca9f(0x3fc)](_0x383559,_0x441ced,this[_0x35ca9f(0x41a)],_0x5946dc,_0xc765b1,_0x64a963,_0x324b79,_0x160ee1);},'decryptBlock':function(_0x5b11e7,_0xccdddc){var _0x348a5c=_0x17ab2d,_0x20f16e=_0x5b11e7[_0xccdddc+0x1];_0x5b11e7[_0xccdddc+0x1]=_0x5b11e7[_0xccdddc+0x3],_0x5b11e7[_0xccdddc+0x3]=_0x20f16e,this[_0x348a5c(0x3fc)](_0x5b11e7,_0xccdddc,this[_0x348a5c(0x21d)],_0x267aaa,_0x58107b,_0x53d99f,_0x6d1b9c,_0x4265e5);var _0x20f16e=_0x5b11e7[_0xccdddc+0x1];_0x5b11e7[_0xccdddc+0x1]=_0x5b11e7[_0xccdddc+0x3],_0x5b11e7[_0xccdddc+0x3]=_0x20f16e;},'_doCryptBlock':function(_0x49bddb,_0x1bcb99,_0x42b8ea,_0x26e1f5,_0x1c0650,_0x2e030d,_0x8559d3,_0x264260){var _0x34a47d=_0x17ab2d;for(var _0x2ab194=this[_0x34a47d(0x3cd)],_0x1aad28=_0x49bddb[_0x1bcb99]^_0x42b8ea[0x0],_0xc921bd=_0x49bddb[_0x1bcb99+0x1]^_0x42b8ea[0x1],_0x1d7dbd=_0x49bddb[_0x1bcb99+0x2]^_0x42b8ea[0x2],_0x1c620f=_0x49bddb[_0x1bcb99+0x3]^_0x42b8ea[0x3],_0x22a142=0x4,_0x4c5174=0x1;_0x4c5174<_0x2ab194;_0x4c5174++){var _0x5031e9=_0x26e1f5[_0x1aad28>>>0x18]^_0x1c0650[_0xc921bd>>>0x10&0xff]^_0x2e030d[_0x1d7dbd>>>0x8&0xff]^_0x8559d3[_0x1c620f&0xff]^_0x42b8ea[_0x22a142++],_0x444f46=_0x26e1f5[_0xc921bd>>>0x18]^_0x1c0650[_0x1d7dbd>>>0x10&0xff]^_0x2e030d[_0x1c620f>>>0x8&0xff]^_0x8559d3[_0x1aad28&0xff]^_0x42b8ea[_0x22a142++],_0xeef4e9=_0x26e1f5[_0x1d7dbd>>>0x18]^_0x1c0650[_0x1c620f>>>0x10&0xff]^_0x2e030d[_0x1aad28>>>0x8&0xff]^_0x8559d3[_0xc921bd&0xff]^_0x42b8ea[_0x22a142++],_0x342545=_0x26e1f5[_0x1c620f>>>0x18]^_0x1c0650[_0x1aad28>>>0x10&0xff]^_0x2e030d[_0xc921bd>>>0x8&0xff]^_0x8559d3[_0x1d7dbd&0xff]^_0x42b8ea[_0x22a142++];_0x1aad28=_0x5031e9,_0xc921bd=_0x444f46,_0x1d7dbd=_0xeef4e9,_0x1c620f=_0x342545;}var _0x5031e9=(_0x264260[_0x1aad28>>>0x18]<<0x18|_0x264260[_0xc921bd>>>0x10&0xff]<<0x10|_0x264260[_0x1d7dbd>>>0x8&0xff]<<0x8|_0x264260[_0x1c620f&0xff])^_0x42b8ea[_0x22a142++],_0x444f46=(_0x264260[_0xc921bd>>>0x18]<<0x18|_0x264260[_0x1d7dbd>>>0x10&0xff]<<0x10|_0x264260[_0x1c620f>>>0x8&0xff]<<0x8|_0x264260[_0x1aad28&0xff])^_0x42b8ea[_0x22a142++],_0xeef4e9=(_0x264260[_0x1d7dbd>>>0x18]<<0x18|_0x264260[_0x1c620f>>>0x10&0xff]<<0x10|_0x264260[_0x1aad28>>>0x8&0xff]<<0x8|_0x264260[_0xc921bd&0xff])^_0x42b8ea[_0x22a142++],_0x342545=(_0x264260[_0x1c620f>>>0x18]<<0x18|_0x264260[_0x1aad28>>>0x10&0xff]<<0x10|_0x264260[_0xc921bd>>>0x8&0xff]<<0x8|_0x264260[_0x1d7dbd&0xff])^_0x42b8ea[_0x22a142++];_0x49bddb[_0x1bcb99]=_0x5031e9,_0x49bddb[_0x1bcb99+0x1]=_0x444f46,_0x49bddb[_0x1bcb99+0x2]=_0xeef4e9,_0x49bddb[_0x1bcb99+0x3]=_0x342545;},'keySize':0x100/0x20});_0x1aae6f[_0x17ab2d(0x4af)]=_0x21f724[_0x17ab2d(0x2de)](_0xb14b98);}()),_0x4d8da5[_0x5acecc(0x4af)];}));}(_0x367d61)),_0x367d61[_0x1c2f27(0x523)];}var _0x4c6de9=_0x2082ca();const _0x41beb7=_0x574301(_0x4c6de9);var _0x396354=_0x12cba4();const _0x136bf4=_0x574301(_0x396354);var _0x1fdb87={'exports':{}},_0x1c40f5=_0x1fdb87[_0x997d7(0x523)],_0x1e1a45;function _0x3630c2(){return _0x1e1a45||(_0x1e1a45=0x1,function(_0x3c66fc,_0x5ccbb2){(function(_0x410477,_0x1f6c35){var _0x3199a7=_0x4ecd;_0x3c66fc[_0x3199a7(0x523)]=_0x1f6c35(_0x45d273());}(_0x1c40f5,function(_0x520066){var _0xa5f4e7=_0x4ecd;return _0x520066[_0xa5f4e7(0x2f2)][_0xa5f4e7(0x3b6)];}));}(_0x1fdb87)),_0x1fdb87['exports'];}var _0x5adb6b=_0x3630c2();const _0xbc6c15=_0x574301(_0x5adb6b);var _0x105091={'exports':{}},_0xe5ab3=_0x105091[_0x997d7(0x523)],_0x921f70;function _0x462879(){var _0x562919=_0x997d7;return _0x921f70||(_0x921f70=0x1,function(_0x318948,_0x454f03){(function(_0x20b946,_0x244c05){var _0x127d4a=_0x4ecd;_0x318948[_0x127d4a(0x523)]=_0x244c05(_0x45d273());}(_0xe5ab3,function(_0x4dc504){var _0x3ad3f1=_0x4ecd;return(function(){var _0x51a3cf=_0x4ecd;if(typeof ArrayBuffer==_0x51a3cf(0x29c)){var _0x599523=_0x4dc504,_0x1e8f15=_0x599523['lib'],_0x53e73d=_0x1e8f15[_0x51a3cf(0x466)],_0xb4e44f=_0x53e73d['init'],_0x5d19e6=_0x53e73d[_0x51a3cf(0x369)]=function(_0x4d60a3){var _0x437f0a=_0x51a3cf;if(_0x4d60a3 instanceof ArrayBuffer&&(_0x4d60a3=new Uint8Array(_0x4d60a3)),(_0x4d60a3 instanceof Int8Array||typeof Uint8ClampedArray<'u'&&_0x4d60a3 instanceof Uint8ClampedArray||_0x4d60a3 instanceof Int16Array||_0x4d60a3 instanceof Uint16Array||_0x4d60a3 instanceof Int32Array||_0x4d60a3 instanceof Uint32Array||_0x4d60a3 instanceof Float32Array||_0x4d60a3 instanceof Float64Array)&&(_0x4d60a3=new Uint8Array(_0x4d60a3[_0x437f0a(0x2c4)],_0x4d60a3['byteOffset'],_0x4d60a3[_0x437f0a(0x2b0)])),_0x4d60a3 instanceof Uint8Array){for(var _0x30418b=_0x4d60a3[_0x437f0a(0x2b0)],_0x3c6141=[],_0x2150df=0x0;_0x2150df<_0x30418b;_0x2150df++)_0x3c6141[_0x2150df>>>0x2]|=_0x4d60a3[_0x2150df]<<0x18-_0x2150df%0x4*0x8;_0xb4e44f[_0x437f0a(0x23d)](this,_0x3c6141,_0x30418b);}else _0xb4e44f[_0x437f0a(0x493)](this,arguments);};_0x5d19e6[_0x51a3cf(0x236)]=_0x53e73d;}}()),_0x4dc504['lib'][_0x3ad3f1(0x466)];}));}(_0x105091)),_0x105091[_0x562919(0x523)];}var _0x2a0005=_0x462879();const _0x4f629c=_0x574301(_0x2a0005);var _0x1c5410={'exports':{}},_0x21dd33=_0x1c5410[_0x997d7(0x523)],_0x2715b0;function _0x11338a(){return _0x2715b0||(_0x2715b0=0x1,function(_0x444b70,_0x238b4f){(function(_0x4765ae,_0x36c338,_0x4c3ae9){var _0x3a553f=_0x4ecd;_0x444b70[_0x3a553f(0x523)]=_0x36c338(_0x45d273(),_0xe5b910());}(_0x21dd33,function(_0x2e42cf){var _0x58f6ca=_0x4ecd;return _0x2e42cf[_0x58f6ca(0x577)]['NoPadding']={'pad':function(){},'unpad':function(){}},_0x2e42cf[_0x58f6ca(0x577)][_0x58f6ca(0x2b4)];}));}(_0x1c5410)),_0x1c5410['exports'];}var _0xc0afa8=_0x11338a();const _0x136663=_0x574301(_0xc0afa8);function _0x216cbb(_0x44f16f,_0x5d5ebd){var _0x346580=_0x997d7;const _0x330ff0=_0x5d5ebd-_0x44f16f[_0x346580(0x307)]%_0x5d5ebd,_0x56af14=String[_0x346580(0x318)](_0x330ff0)[_0x346580(0x514)](_0x330ff0);return _0x44f16f+_0x56af14;}function _0x5d2891(_0x56c424,_0x5cbef4){var _0x323b96=_0x997d7;const _0x21a752=_0x4f629c[_0x323b96(0x4ad)](0x10),_0xb43dcd=_0x216cbb(_0x56c424,0x10),_0x39255f=_0x41beb7['encrypt'](_0xbc6c15[_0x323b96(0x487)](_0xb43dcd),_0x136bf4[_0x323b96(0x487)](_0x5cbef4),{'iv':_0x21a752,'padding':_0x136663});return _0x21a752['concat'](_0x39255f[_0x323b96(0x35b)])[_0x323b96(0x3a6)](_0x136bf4);}function _0x52f6dd(){var _0x28fd47=_0x997d7;const _0x550878=_0x480ca8[_0x28fd47(0x548)]()['__Key__'];if(_0x550878){const _0x1cc67e={'time':Math[_0x28fd47(0x20f)](Date[_0x28fd47(0x554)]()/0x3e8),'domain':location[_0x28fd47(0x3e5)]};return _0x5d2891(JSON[_0x28fd47(0x22d)](_0x1cc67e),_0x550878);}}var _0x6fcaa8=Object[_0x997d7(0x539)],_0x1b12f2=(_0x94aea7,_0xdec25f,_0x29c159,_0x4c3894)=>{var _0x1497e2=_0x997d7;for(var _0x2fefc8=_0x4c3894>0x1?void 0x0:_0x4c3894?_0x6fcaa8(_0xdec25f,_0x29c159):_0xdec25f,_0x160bc3=_0x94aea7[_0x1497e2(0x307)]-0x1,_0x50e9fa;_0x160bc3>=0x0;_0x160bc3--)(_0x50e9fa=_0x94aea7[_0x160bc3])&&(_0x2fefc8=_0x50e9fa(_0x2fefc8)||_0x2fefc8);return _0x2fefc8;},_0x5ce86b=(_0xeb3c6a,_0x1a1547)=>(_0x579574,_0x340340)=>_0x1a1547(_0x579574,_0x340340,_0xeb3c6a);let _0x4417fe=class{constructor(_0x497343){var _0x1c0d8f=_0x997d7;this[_0x1c0d8f(0x3f4)]=_0x497343,this[_0x1c0d8f(0x544)]();}[_0x997d7(0x544)](){var _0x170aa2=_0x997d7;this[_0x170aa2(0x3f4)]['registerHTTPInterceptor']({'interceptor':(_0x1a433c,_0x1f1ec4)=>{var _0x239214=_0x170aa2;const _0x8ba26b=_0x1a433c[_0x239214(0x1f0)],_0x4e4300=_0x52f6dd();return _0x4e4300&&_0x8ba26b['set'](_0x239214(0x2d2),_0x4e4300),_0x1f1ec4(_0x1a433c);}});}};_0x4417fe=_0x1b12f2([_0x5ce86b(0x0,_0x29a664[_0x997d7(0x346)](_0x200e90['HTTPService']))],_0x4417fe);var _0x3076f9=Object[_0x997d7(0x539)],_0x865346=(_0x16a038,_0x1fbc86,_0x156257,_0x43b1b7)=>{var _0x17f1a3=_0x997d7;for(var _0x4ce736=_0x43b1b7>0x1?void 0x0:_0x43b1b7?_0x3076f9(_0x1fbc86,_0x156257):_0x1fbc86,_0x4b29f5=_0x16a038[_0x17f1a3(0x307)]-0x1,_0x2353d2;_0x4b29f5>=0x0;_0x4b29f5--)(_0x2353d2=_0x16a038[_0x4b29f5])&&(_0x4ce736=_0x2353d2(_0x4ce736)||_0x4ce736);return _0x4ce736;},_0x4e8cc0=(_0xcb9d45,_0x1268ad)=>(_0x1e5f57,_0x73ebba)=>_0x1268ad(_0x1e5f57,_0x73ebba,_0xcb9d45);_0x36d18b[_0x997d7(0x52a)]=class extends _0x29a664[_0x997d7(0x330)]{constructor(_0x19d8ac,_0x43261e,_0x205c85){var _0x414366=_0x997d7;super(),_0x260f1e(this,_0x414366(0x433),new _0x32c204[(_0x414366(0x4be))](null)),_0x260f1e(this,_0x414366(0x29a),this['_unitInfo$'][_0x414366(0x313)]()),(this[_0x414366(0x221)]=_0x19d8ac,this['_snapshotService']=_0x43261e,this['_localCacheService']=_0x205c85);}async[_0x997d7(0x323)](_0x3018a4,_0x26b990,_0x3761b7){var _0xcff606=_0x997d7;this['_unitInfo$'][_0xcff606(0x476)]({'unitId':_0x3018a4,'type':_0x26b990});let _0x59b53c=null;switch(_0x26b990){case _0x60f00c[_0xcff606(0x4c5)]:{_0x59b53c=await this['_snapshotService'][_0xcff606(0x226)](_0x3018a4,_0x3761b7);break;}case _0x60f00c[_0xcff606(0x47c)]:{_0x59b53c=await this[_0xcff606(0x54d)][_0xcff606(0x551)](_0x3018a4,_0x3761b7);break;}default:{this[_0xcff606(0x221)][_0xcff606(0x4ee)]('[DataLoaderService]',_0xcff606(0x28a));break;}}return _0x59b53c;}async['loadUnit'](_0x2c07c0,_0x2e1705,_0x316293){var _0x51e9a7=_0x997d7,_0x1eda32;this[_0x51e9a7(0x433)]['next']({'unitId':_0x2c07c0,'type':_0x2e1705,'subUnitId':_0x316293});let _0x5884cd=0x0;const _0x4a25d9=await((_0x1eda32=this['_localCacheService'])==null?void 0x0:_0x1eda32[_0x51e9a7(0x4b3)](_0x2c07c0));return _0x4a25d9&&(_0x4a25d9[_0x51e9a7(0x4f2)]||_0x4a25d9[_0x51e9a7(0x2af)][_0x51e9a7(0x307)]!==0x0)&&(_0x5884cd=_0x4a25d9[_0x51e9a7(0x4dd)]),_0x5884cd===0x0&&this[_0x51e9a7(0x221)][_0x51e9a7(0x1ff)]('[DataLoaderService]',_0x51e9a7(0x1f9)),this[_0x51e9a7(0x323)](_0x2c07c0,_0x2e1705,_0x5884cd);}},_0x36d18b[_0x997d7(0x52a)]=_0x865346([_0x4e8cc0(0x0,_0x29a664[_0x997d7(0x492)]),_0x4e8cc0(0x1,_0x29a664['Inject'](_0x5a7fdc[_0x997d7(0x573)])),_0x4e8cc0(0x2,_0x29a664[_0x997d7(0x29b)](_0x3e2be6))],_0x36d18b[_0x997d7(0x52a)]);var _0x5239d6=Object[_0x997d7(0x539)],_0x2b6ebb=(_0x512c0f,_0x50170e,_0x12ff89,_0x6c4fbb)=>{var _0x8c8b97=_0x997d7;for(var _0x187dce=_0x6c4fbb>0x1?void 0x0:_0x6c4fbb?_0x5239d6(_0x50170e,_0x12ff89):_0x50170e,_0x562f4d=_0x512c0f[_0x8c8b97(0x307)]-0x1,_0x2b66eb;_0x562f4d>=0x0;_0x562f4d--)(_0x2b66eb=_0x512c0f[_0x562f4d])&&(_0x187dce=_0x2b66eb(_0x187dce)||_0x187dce);return _0x187dce;},_0x3b6329=(_0x1f69ad,_0x5b17f8)=>(_0x4c6ae,_0x3825e6)=>_0x5b17f8(_0x4c6ae,_0x3825e6,_0x1f69ad);const _0x232409=[_0x997d7(0x354),_0x997d7(0x407),_0x997d7(0x2e8),_0x997d7(0x478),_0x997d7(0x304)],_0x2d2fbd=0x5*0x400*0x400,_0x3b867b=_0x997d7(0x386),_0x557d2e=_0x997d7(0x31c);_0x36d18b[_0x997d7(0x4a1)]=class{constructor(_0x593c28,_0x52760f,_0x2c032c){var _0x5663ee=_0x997d7;_0x260f1e(this,'_waitCount',0x0),_0x260f1e(this,_0x5663ee(0x365),new _0x32c204['Subject']()),_0x260f1e(this,_0x5663ee(0x561),this['_change$']),_0x260f1e(this,'_imageSourceCache',new Map()),(this[_0x5663ee(0x3f4)]=_0x593c28,this[_0x5663ee(0x261)]=_0x52760f,this[_0x5663ee(0x432)]=_0x2c032c);}[_0x997d7(0x267)](_0x5f2deb){var _0x1ca29e=_0x997d7;this[_0x1ca29e(0x2e6)]=_0x5f2deb,this[_0x1ca29e(0x365)][_0x1ca29e(0x476)](_0x5f2deb);}[_0x997d7(0x4c2)](_0x22ef5e,_0x1cab4e){var _0x53717e=_0x997d7;if(_0x1cab4e===_0x2b4a05[_0x53717e(0x244)]['BASE64']){const _0x1242c6=new Image();return _0x1242c6['src']=_0x22ef5e,_0x1242c6;}return this[_0x53717e(0x395)][_0x53717e(0x47e)](_0x22ef5e);}[_0x997d7(0x3db)](_0x1a8262,_0x58f9fb,_0x5d77d6){var _0x586d80=_0x997d7;_0x58f9fb===_0x2b4a05[_0x586d80(0x244)]['BASE64']||_0x5d77d6==null||this[_0x586d80(0x395)][_0x586d80(0x41e)](_0x1a8262,_0x5d77d6);}async['getImage'](_0x42ed88){var _0x18eb9d=_0x997d7;try{const _0x299906=this[_0x18eb9d(0x2e1)](this['_getSignURL'](),''+_0x42ed88),_0x279eda=(await this[_0x18eb9d(0x3f4)][_0x18eb9d(0x47e)](_0x299906))[_0x18eb9d(0x22b)];if(_0x279eda[_0x18eb9d(0x4ee)]&&_0x279eda[_0x18eb9d(0x4ee)]['code']===_0x4015c2['OK']){const _0x22a4ff=new URL(_0x279eda[_0x18eb9d(0x253)],this['_getDownloadEndpointURL']())[_0x18eb9d(0x3a6)]();return Promise[_0x18eb9d(0x39d)](_0x22a4ff);}return Promise['reject'](_0x279eda[_0x18eb9d(0x4ee)]);}catch(_0x3fedc6){return Promise[_0x18eb9d(0x3a0)](_0x3fedc6);}}async[_0x997d7(0x48c)](_0x593097){var _0x1b6762=_0x997d7;let _0x28078c='';if(!_0x232409[_0x1b6762(0x289)](_0x593097[_0x1b6762(0x3b0)]))return this[_0x1b6762(0x34d)](),Promise[_0x1b6762(0x3a0)](new Error(_0x2b4a05[_0x1b6762(0x245)][_0x1b6762(0x4b6)]));if(_0x593097[_0x1b6762(0x498)]>_0x2d2fbd)return this[_0x1b6762(0x34d)](),Promise[_0x1b6762(0x3a0)](new Error(_0x2b4a05[_0x1b6762(0x245)][_0x1b6762(0x1fb)]));try{const _0x19a610=new FormData();_0x19a610[_0x1b6762(0x52b)]('file',_0x593097);const _0xb9e2a7=this[_0x1b6762(0x432)]['getFocusedUnit'](),_0x298676=_0xb9e2a7==null?void 0x0:_0xb9e2a7[_0x1b6762(0x4ae)]();if(!_0x298676)throw new Error(_0x1b6762(0x496));const _0x750144=this['_getUploadFileURL']()+'?size='+_0x593097[_0x1b6762(0x498)][_0x1b6762(0x3a6)]()+_0x1b6762(0x4ef)+_0x241a4e[_0x1b6762(0x4f6)]+_0x1b6762(0x29e)+encodeURIComponent(_0x298676),_0x9c7357={'body':_0x19a610},_0x3764e8=(await this[_0x1b6762(0x3f4)][_0x1b6762(0x540)](_0x750144,_0x9c7357))[_0x1b6762(0x22b)];if(typeof _0x3764e8[_0x1b6762(0x3ac)]!=_0x1b6762(0x2f0))return this[_0x1b6762(0x34d)](),Promise[_0x1b6762(0x3a0)](new Error(_0x2b4a05[_0x1b6762(0x245)][_0x1b6762(0x526)]));_0x28078c=_0x3764e8[_0x1b6762(0x3ac)];}catch{return this[_0x1b6762(0x34d)](),Promise[_0x1b6762(0x3a0)](new Error(_0x2b4a05[_0x1b6762(0x245)][_0x1b6762(0x526)]));}return new Promise((_0x57809c,_0x2a323f)=>{var _0xe1cc34=_0x1b6762;const _0x182e8b=new FileReader();_0x182e8b[_0xe1cc34(0x2d0)](_0x593097),_0x182e8b[_0xe1cc34(0x2c1)]=_0xae2b3a=>{var _0x5bdee2=_0xe1cc34,_0x1d8751;const _0x5750fb=(_0x1d8751=_0xae2b3a['target'])==null?void 0x0:_0x1d8751[_0x5bdee2(0x3aa)];if(_0x5750fb==null){this['_decreaseWaiting'](),_0x2a323f(new Error(_0x2b4a05['ImageUploadStatusType'][_0x5bdee2(0x526)]));return;}const _0x14e590=_0x29a664[_0x5bdee2(0x4de)](0x6);_0x57809c({'imageId':_0x14e590,'imageSourceType':_0x2b4a05[_0x5bdee2(0x244)]['UUID'],'source':_0x28078c,'base64Cache':_0x5750fb,'status':_0x2b4a05[_0x5bdee2(0x245)][_0x5bdee2(0x343)]}),this[_0x5bdee2(0x34d)]();};});}[_0x997d7(0x30e)](){var _0x5cb628=_0x997d7,_0x58494e;const _0x609e9f=this[_0x5cb628(0x261)][_0x5cb628(0x368)](_0x3fa783);return(_0x58494e=_0x609e9f==null?void 0x0:_0x609e9f[_0x5cb628(0x28b)])!=null?_0x58494e:_0x3b867b;}[_0x997d7(0x4d3)](){var _0x5bd86f=_0x997d7,_0x2bb207;const _0x5058b9=this[_0x5bd86f(0x261)][_0x5bd86f(0x368)](_0x3fa783);return(_0x2bb207=_0x5058b9==null?void 0x0:_0x5058b9['signUrlServerUrl'])!=null?_0x2bb207:_0x557d2e;}[_0x997d7(0x3de)](){var _0x217155=_0x997d7,_0xa87f13;const _0x263331=this[_0x217155(0x261)][_0x217155(0x368)](_0x3fa783);return(_0xa87f13=_0x263331==null?void 0x0:_0x263331[_0x217155(0x499)])!=null?_0xa87f13:location['origin'];}[_0x997d7(0x2e1)](_0x251c8d,_0x34b3ff){var _0x250c87=_0x997d7;return _0x251c8d['replace'](_0x250c87(0x3b5),_0x34b3ff);}[_0x997d7(0x34d)](){var _0x3b3ad2=_0x997d7;this['_waitCount']-=0x1,this['_change$'][_0x3b3ad2(0x476)](this['_waitCount']);}},_0x36d18b['CollaborationImageIoService']=_0x2b6ebb([_0x3b6329(0x0,_0x29a664[_0x997d7(0x346)](_0x200e90[_0x997d7(0x218)])),_0x3b6329(0x1,_0x29a664[_0x997d7(0x4fc)]),_0x3b6329(0x2,_0x29a664[_0x997d7(0x346)](_0x29a664['IUniverInstanceService']))],_0x36d18b['CollaborationImageIoService']);var _0x5dabf8=Object[_0x997d7(0x539)],_0x4f4b0a=(_0x3be0b8,_0x4002d0,_0x1454b9,_0x4bc916)=>{var _0x5caaed=_0x997d7;for(var _0x2bd6c4=_0x4bc916>0x1?void 0x0:_0x4bc916?_0x5dabf8(_0x4002d0,_0x1454b9):_0x4002d0,_0x1a0cb6=_0x3be0b8[_0x5caaed(0x307)]-0x1,_0x50c918;_0x1a0cb6>=0x0;_0x1a0cb6--)(_0x50c918=_0x3be0b8[_0x1a0cb6])&&(_0x2bd6c4=_0x50c918(_0x2bd6c4)||_0x2bd6c4);return _0x2bd6c4;},_0x3e776e=(_0x54f06c,_0x82f883)=>(_0x505002,_0x55fc8b)=>_0x82f883(_0x505002,_0x55fc8b,_0x54f06c);const _0x49b07d=_0x997d7(0x2ba);_0x36d18b[_0x997d7(0x2a3)]=class{constructor(_0x5ef63a,_0x179486){var _0x460ac1=_0x997d7;this[_0x460ac1(0x261)]=_0x5ef63a,this[_0x460ac1(0x210)]=_0x179486;}[_0x997d7(0x2a4)](){var _0x4fdc79=_0x997d7,_0x6c354f;const _0x1e06bb=this[_0x4fdc79(0x261)][_0x4fdc79(0x368)](_0x3fa783);return(_0x6c354f=_0x1e06bb==null?void 0x0:_0x1e06bb[_0x4fdc79(0x534)])!=null?_0x6c354f:_0x49b07d;}async[_0x997d7(0x3ad)](_0x18c51a){var _0x5dcdfe=_0x997d7;const _0x54a818=this['_getAPIPrefixPath']()+_0x5dcdfe(0x43a);return{'list':[{'title':_0x5dcdfe(0x2bb),'mentions':(await this[_0x5dcdfe(0x210)][_0x5dcdfe(0x47e)](_0x54a818,{'params':{'objectID':_0x18c51a['unitId'],'unitID':_0x18c51a['unitId']}}))['body'][_0x5dcdfe(0x270)][_0x5dcdfe(0x2b1)](_0x3cf220=>({'objectId':_0x3cf220['id'],'name':_0x3cf220['subject'][_0x5dcdfe(0x4d2)],'metadata':{'icon':_0x3cf220[_0x5dcdfe(0x532)][_0x5dcdfe(0x2c2)]},'label':_0x3cf220[_0x5dcdfe(0x532)]['name'],'objectType':_0x29a664[_0x5dcdfe(0x20b)][_0x5dcdfe(0x366)]})),'metadata':{},'type':_0x29a664[_0x5dcdfe(0x20b)][_0x5dcdfe(0x366)]}]};}},_0x36d18b[_0x997d7(0x2a3)]=_0x4f4b0a([_0x3e776e(0x0,_0x29a664[_0x997d7(0x346)](_0x29a664['IConfigService'])),_0x3e776e(0x1,_0x29a664[_0x997d7(0x346)](_0x200e90[_0x997d7(0x218)]))],_0x36d18b['MentionIoHttpService']);var _0x128420=Object[_0x997d7(0x539)],_0x4c7d1f=(_0xf7ef07,_0x2e2fa3,_0x52f56c,_0x4e6279)=>{var _0x1376ad=_0x997d7;for(var _0xbdc2db=_0x4e6279>0x1?void 0x0:_0x4e6279?_0x128420(_0x2e2fa3,_0x52f56c):_0x2e2fa3,_0x3ebb12=_0xf7ef07[_0x1376ad(0x307)]-0x1,_0x4bbc11;_0x3ebb12>=0x0;_0x3ebb12--)(_0x4bbc11=_0xf7ef07[_0x3ebb12])&&(_0xbdc2db=_0x4bbc11(_0xbdc2db)||_0xbdc2db);return _0xbdc2db;},_0x315ae4=(_0x3f73b6,_0x181b0c)=>(_0x32ca1c,_0x2b98af)=>_0x181b0c(_0x32ca1c,_0x2b98af,_0x3f73b6);let _0x1f7836=class extends _0x29a664[_0x997d7(0x330)]{constructor(_0x348e68,_0x248a58,_0x2f3785,_0x4d948f,_0x4a4ad7){var _0x5d87f4=_0x997d7;super(),this['_injector']=_0x348e68,this[_0x5d87f4(0x432)]=_0x248a58,this[_0x5d87f4(0x412)]=_0x2f3785,this[_0x5d87f4(0x50b)]=_0x4d948f,this[_0x5d87f4(0x47a)]=_0x4a4ad7,this[_0x5d87f4(0x439)](),this['_initCloseConn']();}[_0x997d7(0x340)](){var _0x777287=_0x997d7;const _0x18bd89=async _0x15c080=>{var _0x5de1a4=_0x4ecd;(await this[_0x5de1a4(0x50b)]['requireSession'](_0x15c080))[_0x5de1a4(0x25c)][_0x5de1a4(0x2ab)](_0x12f47e[_0x5de1a4(0x469)](_0x54b529=>_0x54b529[_0x5de1a4(0x328)]===_0x5a7fdc['CollaborationEvent'][_0x5de1a4(0x35e)]),_0x12f47e['takeUntil'](this[_0x5de1a4(0x2a0)]))[_0x5de1a4(0x3cc)](_0x686dca=>{var _0x2f03ff=_0x5de1a4;const _0x1d21e5=_0x686dca,{reason:_0xabe5e}=_0x1d21e5['data'];this[_0x2f03ff(0x47a)][_0x2f03ff(0x2d4)]({'id':_0xedfb31[_0x2f03ff(0x21a)],'data':_0xabe5e}),this[_0x2f03ff(0x412)][_0x2f03ff(0x56e)](new _0x1ce604['WorkbookEditablePermission'](_0x15c080)['id'],!0x1),this[_0x2f03ff(0x50b)][_0x2f03ff(0x223)](_0x15c080);});};_0x32c204[_0x777287(0x2e7)](this[_0x777287(0x432)]['getTypeOfUnitAdded$'](_0x29a664[_0x777287(0x319)][_0x777287(0x4c5)]),this[_0x777287(0x432)][_0x777287(0x51b)](_0x29a664[_0x777287(0x319)]['UNIVER_DOC']))[_0x777287(0x2ab)](_0x12f47e[_0x777287(0x2b1)](_0x3c0b22=>_0x3c0b22[_0x777287(0x4ae)]()),_0x12f47e['filter'](_0x10eaae=>!_0x29a664[_0x777287(0x320)](_0x10eaae)),_0x12f47e['takeUntil'](this[_0x777287(0x2a0)]))[_0x777287(0x3cc)](_0x149873=>{_0x18bd89(_0x149873);});}[_0x997d7(0x439)](){var _0x1818a8=_0x997d7;const _0x4fe6c0=async _0x25166b=>{var _0x47b345=_0x4ecd;const _0x4e38eb=await this[_0x47b345(0x50b)][_0x47b345(0x1fe)](_0x25166b),_0x713cf7=this[_0x47b345(0x30a)][_0x47b345(0x47e)](_0x1ce604[_0x47b345(0x28c)]);_0x4e38eb[_0x47b345(0x25c)][_0x47b345(0x2ab)](_0x12f47e[_0x47b345(0x469)](_0xeaf2ac=>_0xeaf2ac[_0x47b345(0x328)]===_0x5a7fdc[_0x47b345(0x315)]['UPDATE_PERMISSION_OBJ']),_0x12f47e[_0x47b345(0x45b)](this[_0x47b345(0x2a0)]))[_0x47b345(0x3cc)](_0x3bb800=>{var _0x2178dc=_0x47b345;const _0x13347d=_0x3bb800,{objectId:_0x4c7a9c}=_0x13347d[_0x2178dc(0x40b)];_0x4c7a9c===_0x25166b?_0x713cf7['initWorkbookPermissionChange'](_0x25166b):_0x713cf7[_0x2178dc(0x35c)](_0x25166b,_0x4c7a9c);});};_0x32c204['merge'](this[_0x1818a8(0x432)]['getTypeOfUnitAdded$'](_0x29a664[_0x1818a8(0x319)][_0x1818a8(0x4c5)]))[_0x1818a8(0x2ab)](_0x12f47e['map'](_0x3afab0=>_0x3afab0['getUnitId']()),_0x12f47e[_0x1818a8(0x469)](_0x21027a=>!_0x29a664['isInternalEditorID'](_0x21027a)),_0x12f47e['takeUntil'](this[_0x1818a8(0x2a0)]))['subscribe'](_0x2f079c=>{_0x4fe6c0(_0x2f079c);});}};_0x1f7836=_0x4c7d1f([_0x315ae4(0x0,_0x29a664[_0x997d7(0x346)](_0x29a664[_0x997d7(0x2c6)])),_0x315ae4(0x1,_0x29a664['IUniverInstanceService']),_0x315ae4(0x2,_0x29a664[_0x997d7(0x471)]),_0x315ae4(0x3,_0x29a664['Inject'](_0x36d18b['CollaborationSessionService'])),_0x315ae4(0x4,_0x29a664[_0x997d7(0x346)](_0x495958))],_0x1f7836);var _0x14fce0=Object['getOwnPropertyDescriptor'],_0x4b0786=(_0x5b2de8,_0x49de44,_0x373d3a,_0x390ee6)=>{var _0x4f3ca=_0x997d7;for(var _0x51cbcc=_0x390ee6>0x1?void 0x0:_0x390ee6?_0x14fce0(_0x49de44,_0x373d3a):_0x49de44,_0x2d4dd7=_0x5b2de8[_0x4f3ca(0x307)]-0x1,_0x1c6bc7;_0x2d4dd7>=0x0;_0x2d4dd7--)(_0x1c6bc7=_0x5b2de8[_0x2d4dd7])&&(_0x51cbcc=_0x1c6bc7(_0x51cbcc)||_0x51cbcc);return _0x51cbcc;},_0x5cea33=(_0x5b04e0,_0x5d5ed7)=>(_0x395dec,_0x485d84)=>_0x5d5ed7(_0x395dec,_0x485d84,_0x5b04e0);_0x36d18b[_0x997d7(0x255)]=class{constructor(_0xb76f40,_0x28b90c){this['_configService']=_0xb76f40,this['_httpService']=_0x28b90c;}async[_0x997d7(0x31e)](_0x1df3f3,_0x8554c5){var _0x4083c7=_0x997d7,_0x4c5b68;const {unitID:_0x4e5513,type:_0x6dd02e,revision:_0x2124b4=0x0}=_0x8554c5,_0x421d70=this[_0x4083c7(0x4b2)]()+'/'+_0x6dd02e+_0x4083c7(0x484)+_0x4e5513+'/rev/'+_0x2124b4,_0x157978=(await this[_0x4083c7(0x3f4)][_0x4083c7(0x47e)](_0x421d70))['body'],_0x4a7345=(_0x4c5b68=_0x157978['snapshot'])==null?void 0x0:_0x4c5b68[_0x4083c7(0x378)];if(_0x4a7345){const _0x5e7349=_0x4a7345==null?void 0x0:_0x4a7345[_0x4083c7(0x3df)],_0x40264b=_0x5a7fdc['textEncoder'][_0x4083c7(0x22c)](_0x5a7fdc[_0x4083c7(0x4c7)](_0x5e7349));_0x4a7345[_0x4083c7(0x3df)]=_0x40264b,Object[_0x4083c7(0x53a)](_0x4a7345[_0x4083c7(0x401)])['forEach'](([,_0x579009])=>{var _0x554205=_0x4083c7;const _0x2e5d47=_0x579009[_0x554205(0x3df)],_0x336702=_0x5a7fdc[_0x554205(0x21e)][_0x554205(0x22c)](_0x5a7fdc[_0x554205(0x4c7)](_0x2e5d47));_0x579009[_0x554205(0x3df)]=_0x336702;});}return _0x157978;}async[_0x997d7(0x3e2)](_0xcfed00,_0x47cdee){var _0x5e8bd6=_0x997d7;const {unitID:_0x3a1dc9,type:_0x17d93c,blockID:_0x26b5ba}=_0x47cdee,_0x5537e5=this['_getAPIPrefix']()+'/'+_0x17d93c+_0x5e8bd6(0x484)+_0x3a1dc9+'/block/'+_0x26b5ba;return(await this[_0x5e8bd6(0x3f4)]['get'](_0x5537e5))[_0x5e8bd6(0x22b)];}async[_0x997d7(0x404)](_0x108e14,_0x5cbb9f){var _0x1cb88a=_0x997d7;const {unitID:_0x2f716c,type:_0x2e2ba8,blockID:_0x41bcc6}=_0x5cbb9f,_0x4cb065=this[_0x1cb88a(0x467)]()+_0x1cb88a(0x356)+_0x2e2ba8+_0x1cb88a(0x484)+_0x2f716c+_0x1cb88a(0x356)+_0x41bcc6;return(await this[_0x1cb88a(0x3f4)]['get'](_0x4cb065))[_0x1cb88a(0x22b)];}async['fetchMissingChangesets'](_0x4ae3d5,_0x194e5b){var _0x4ef8d4=_0x997d7;const {unitID:_0xa9a3f,type:_0x19fae9,from:_0x32400a,to:_0x2669fd}=_0x194e5b,_0x58e80f=this[_0x4ef8d4(0x467)]()+'/'+_0x19fae9+_0x4ef8d4(0x484)+_0xa9a3f+_0x4ef8d4(0x3e8)+_0x32400a+_0x4ef8d4(0x3d2)+_0x2669fd;return(await this['_httpService'][_0x4ef8d4(0x47e)](_0x58e80f))[_0x4ef8d4(0x22b)];}[_0x997d7(0x4b2)](){var _0x418a43=_0x997d7,_0x399ba6;return(_0x399ba6=this[_0x418a43(0x261)][_0x418a43(0x368)](_0x4a7c93))!=null?_0x399ba6:this[_0x418a43(0x467)]();}[_0x997d7(0x467)](){var _0x7f9bd6=_0x997d7,_0x9f193b;const _0x421032=this[_0x7f9bd6(0x261)][_0x7f9bd6(0x368)](_0x3fa783);return(_0x9f193b=_0x421032==null?void 0x0:_0x421032[_0x7f9bd6(0x278)])!=null?_0x9f193b:_0xe80868;}async[_0x997d7(0x336)](_0x2e8c4f,_0x4b9d65){var _0x22425f=_0x997d7;const _0x2bd66d='/universer-api/snapshot/'+_0x4b9d65[_0x22425f(0x3b0)]+_0x22425f(0x484)+_0x4b9d65[_0x22425f(0x297)]+_0x22425f(0x33e);return(await this[_0x22425f(0x3f4)][_0x22425f(0x47e)](_0x2bd66d,{'params':{'resourceId':JSON['stringify'](_0x4b9d65[_0x22425f(0x4ec)])}}))[_0x22425f(0x22b)];}[_0x997d7(0x4f1)](){throw new Error('This\x20method\x20should\x20not\x20be\x20called\x20on\x20the\x20client\x20side!');}[_0x997d7(0x2a8)](){throw new Error('This\x20method\x20should\x20not\x20be\x20called\x20on\x20the\x20client\x20side!');}[_0x997d7(0x1f3)](){var _0x2aa41c=_0x997d7;throw new Error(_0x2aa41c(0x217));}['saveChangeset'](){var _0xdf8902=_0x997d7;throw new Error(_0xdf8902(0x217));}[_0x997d7(0x2a5)](){var _0x11b49c=_0x997d7;throw new Error(_0x11b49c(0x217));}['getLatestCsReqIdBySid'](){throw new Error('This\x20method\x20should\x20not\x20be\x20called\x20on\x20the\x20client\x20side!');}},_0x36d18b[_0x997d7(0x255)]=_0x4b0786([_0x5cea33(0x0,_0x29a664[_0x997d7(0x4fc)]),_0x5cea33(0x1,_0x29a664[_0x997d7(0x346)](_0x200e90['HTTPService']))],_0x36d18b[_0x997d7(0x255)]);var _0x2c46a9=Object[_0x997d7(0x539)],_0x4abf13=(_0x5b5ce8,_0x39c610,_0x15ca72,_0x12a528)=>{var _0x1cb2d0=_0x997d7;for(var _0x5ed1b4=_0x12a528>0x1?void 0x0:_0x12a528?_0x2c46a9(_0x39c610,_0x15ca72):_0x39c610,_0x34f154=_0x5b5ce8[_0x1cb2d0(0x307)]-0x1,_0x52733e;_0x34f154>=0x0;_0x34f154--)(_0x52733e=_0x5b5ce8[_0x34f154])&&(_0x5ed1b4=_0x52733e(_0x5ed1b4)||_0x5ed1b4);return _0x5ed1b4;},_0x111041=(_0x3d2709,_0x2c0e50)=>(_0x3059e5,_0x40ee7a)=>_0x2c0e50(_0x3059e5,_0x40ee7a,_0x3d2709);_0x36d18b[_0x997d7(0x2d6)]=class extends _0x29a664[_0x997d7(0x4d6)]{constructor(_0x33414a,_0x37a382,_0x5650ce,_0x5e6dac,_0x5a1fe7){var _0x156afd=_0x997d7;super(_0x33414a,_0x37a382,_0x5650ce),this['_transformService']=_0x5e6dac,this[_0x156afd(0x221)]=_0x5a1fe7;}['transformUndoRedo'](_0x24c46e,_0x706d9){var _0x4fdf9a=_0x997d7;const _0x5d2e80=this[_0x4fdf9a(0x364)](_0x24c46e);if(_0x5d2e80)try{const _0x53344c=this[_0x4fdf9a(0x3a1)](_0x5d2e80,_0x706d9);this[_0x4fdf9a(0x541)](_0x24c46e,_0x53344c);}catch(_0x2741d9){this[_0x4fdf9a(0x221)][_0x4fdf9a(0x4ee)](_0x4fdf9a(0x286),_0x2741d9),this[_0x4fdf9a(0x48d)](_0x24c46e);}const _0x4cd6ba=this[_0x4fdf9a(0x500)](_0x24c46e);if(_0x4cd6ba)try{const _0x3dd43c=this[_0x4fdf9a(0x3a1)](_0x4cd6ba,_0x706d9);this[_0x4fdf9a(0x2f6)](_0x24c46e,_0x3dd43c);}catch(_0x4ccc72){this['_logService'][_0x4fdf9a(0x4ee)](_0x4ccc72),this[_0x4fdf9a(0x46d)](_0x24c46e);}}['_clearUndo'](_0x52aa11){var _0x4b633b=_0x997d7;const _0x103faa=this[_0x4b633b(0x364)](_0x52aa11);_0x103faa&&(_0x103faa[_0x4b633b(0x307)]=0x0,this[_0x4b633b(0x250)]());}[_0x997d7(0x46d)](_0x3cf752){var _0x5b12ec=_0x997d7;const _0x4d7473=this[_0x5b12ec(0x500)](_0x3cf752);_0x4d7473&&(_0x4d7473['length']=0x0,this[_0x5b12ec(0x250)]());}[_0x997d7(0x541)](_0x32f1aa,_0xb19a36){var _0x2283a8=_0x997d7;this[_0x2283a8(0x56d)][_0x2283a8(0x41e)](_0x32f1aa,_0xb19a36),this['_updateStatus']();}[_0x997d7(0x2f6)](_0x42bccd,_0x66923a){var _0x49d64e=_0x997d7;this[_0x49d64e(0x435)]['set'](_0x42bccd,_0x66923a),this['_updateStatus']();}[_0x997d7(0x3a1)](_0x2a1aab,_0x1ba684){var _0x41c7ac=_0x997d7;const _0x2b283e=[];let _0x306f48=_0x1ba684,_0x2d4243=_0x1ba684;for(let _0x5d2534=_0x2a1aab[_0x41c7ac(0x307)]-0x1;_0x5d2534>=0x0;_0x5d2534--){const {unitID:_0x4daf44,undoMutations:_0x2e130d,redoMutations:_0x25698d}=_0x2a1aab[_0x5d2534],_0x51fda2=this[_0x41c7ac(0x536)][_0x41c7ac(0x576)](_0x306f48,_0x2e130d),_0xfce4ca=this[_0x41c7ac(0x536)][_0x41c7ac(0x576)](_0x2d4243,_0x25698d);if(_0x5a7fdc[_0x41c7ac(0x1f5)](_0x51fda2)||_0x5a7fdc[_0x41c7ac(0x1f5)](_0xfce4ca)){this[_0x41c7ac(0x221)][_0x41c7ac(0x4ee)]('[CollaborationUndoRedoService]',_0x41c7ac(0x2ae),_0x51fda2,_0xfce4ca);break;}_0x306f48=_0x51fda2['c1Prime'],_0x2d4243=_0xfce4ca[_0x41c7ac(0x1ec)],_0x2b283e['push']({'unitID':_0x4daf44,'undoMutations':_0x51fda2[_0x41c7ac(0x2d3)],'redoMutations':_0xfce4ca[_0x41c7ac(0x2d3)]});}return _0x2b283e[_0x41c7ac(0x578)]();}},_0x36d18b[_0x997d7(0x2d6)]=_0x4abf13([_0x111041(0x0,_0x29a664['IUniverInstanceService']),_0x111041(0x1,_0x29a664[_0x997d7(0x37f)]),_0x111041(0x2,_0x29a664[_0x997d7(0x399)]),_0x111041(0x3,_0x5a7fdc[_0x997d7(0x4a5)]),_0x111041(0x4,_0x29a664['ILogService'])],_0x36d18b['CollaborativeUndoRedoService']);var _0x445173=Object['defineProperty'],_0x23fd22=Object[_0x997d7(0x539)],_0x1e0309=(_0x47a1d1,_0x58374c,_0x54dd7f)=>_0x58374c in _0x47a1d1?_0x445173(_0x47a1d1,_0x58374c,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0x54dd7f}):_0x47a1d1[_0x58374c]=_0x54dd7f,_0x4e8bc1=(_0x29587f,_0xee8218,_0x218397,_0x15e11b)=>{var _0x54057d=_0x997d7;for(var _0x5c407b=_0x15e11b>0x1?void 0x0:_0x15e11b?_0x23fd22(_0xee8218,_0x218397):_0xee8218,_0x221459=_0x29587f[_0x54057d(0x307)]-0x1,_0x53021d;_0x221459>=0x0;_0x221459--)(_0x53021d=_0x29587f[_0x221459])&&(_0x5c407b=_0x53021d(_0x5c407b)||_0x5c407b);return _0x5c407b;},_0x1a6df7=(_0x18e6aa,_0x4864a2)=>(_0x87d986,_0x158fe4)=>_0x4864a2(_0x87d986,_0x158fe4,_0x18e6aa),_0x3cdfa2=(_0x5cafc2,_0x1d837e,_0x17c352)=>_0x1e0309(_0x5cafc2,_0x1d837e+'',_0x17c352);const _0x3b0cc0=_0x997d7(0x3d1);_0x36d18b[_0x997d7(0x4ac)]=class extends _0x29a664[_0x997d7(0x1f2)]{constructor(_0x5435e9,_0x515220,_0x99297c,_0x52fd3d){var _0x10b9df=_0x997d7;super(),_0x260f1e(this,_0x10b9df(0x47d)),(this[_0x10b9df(0x221)]=_0x515220,this['_injector']=_0x99297c,this[_0x10b9df(0x261)]=_0x52fd3d);const {..._0x3027f6}=_0x29a664[_0x10b9df(0x2e7)]({},_0x1ee5fd,_0x5435e9);if(!_0x3027f6[_0x10b9df(0x38a)])throw new Error('[UniverCollaborationClientPlugin]:\x20you\x20must\x20provide\x20a\x20socketService\x20implementation\x20in\x20config!');this[_0x10b9df(0x47d)]=_0x3027f6,this[_0x10b9df(0x261)]['setConfig'](_0x3fa783,_0x3027f6);}[_0x997d7(0x4b4)](){var _0x236ac8=_0x997d7;this[_0x236ac8(0x39a)](),this['_initDependencies']();}['_registerDependencies'](){var _0x515402=_0x997d7,_0x2b5138,_0x47c563;this[_0x515402(0x30a)][_0x515402(0x572)](_0x29a664[_0x515402(0x232)])&&this[_0x515402(0x221)]['error']('[UniverCollaborationClientPlugin]','you\x20should\x20override\x20\x22IUndoRedoService\x22\x20provided\x20in\x20\x22core\x22\x20package!');const _0x4466dc=_0x29a664[_0x515402(0x3c7)]([[_0x29a664['IUndoRedoService'],{'useClass':_0x36d18b[_0x515402(0x2d6)]}],[_0x36d18b[_0x515402(0x446)]],[_0x36d18b[_0x515402(0x409)]],[_0x36d18b['SheetTransformSelectionsService']],[_0x57ab38],[_0x4417fe],[_0x3e15b7],[_0x1f7836],[_0x495958],[_0x36d18b[_0x515402(0x52a)]],[_0x5b4d23,{'useClass':this[_0x515402(0x47d)][_0x515402(0x38a)]}],[_0x5a7fdc[_0x515402(0x42f)],{'useClass':_0x36d18b[_0x515402(0x255)]}],[_0x29a664[_0x515402(0x398)],{'useClass':_0x36d18b[_0x515402(0x3dc)]}],[_0x2b4a05['IImageIoService'],{'useClass':_0x36d18b[_0x515402(0x4a1)]}],[_0x29a664['IMentionIOService'],{'useClass':_0x36d18b[_0x515402(0x2a3)]}],[_0x36d18b['CollaborationController']],[_0x4788c3]],(_0x2b5138=this[_0x515402(0x47d)])==null?void 0x0:_0x2b5138['override']);if(!((_0x47c563=this[_0x515402(0x47d)])!=null&&_0x47c563[_0x515402(0x37c)])){const _0x2b2328=_0x4466dc['findIndex'](([_0x12744d])=>_0x12744d===_0x4f3087);_0x2b2328!==-0x1&&_0x4466dc[_0x515402(0x425)](_0x2b2328,0x1);}_0x29a664[_0x515402(0x29d)](this['_injector'],_0x4466dc);}[_0x997d7(0x2d9)](){var _0x31bc31=_0x997d7,_0x11af39,_0x14c5f4,_0x56dcb2;this['_injector']['get'](_0x200e90[_0x31bc31(0x218)])[_0x31bc31(0x3d5)]({'priority':0x14,'interceptor':_0x200e90['ThresholdInterceptorFactory']({'maxParallel':0x6})}),(_0x11af39=this[_0x31bc31(0x47d)])!=null&&_0x11af39[_0x31bc31(0x512)]||(_0x14c5f4=this['_injector'][_0x31bc31(0x47e)](_0x3e2be6,_0x29a664[_0x31bc31(0x558)]['OPTIONAL']))==null||_0x14c5f4[_0x31bc31(0x268)](),(_0x56dcb2=this[_0x31bc31(0x47d)])!=null&&_0x56dcb2[_0x31bc31(0x545)]&&_0x29a664[_0x31bc31(0x361)](this['_injector'],[[_0x57ab38]]),_0x29a664[_0x31bc31(0x361)](this[_0x31bc31(0x30a)],[[_0x4417fe],[_0x36d18b[_0x31bc31(0x322)]],[_0x1f7836]]);}},_0x3cdfa2(_0x36d18b[_0x997d7(0x4ac)],'pluginName',_0x3b0cc0),_0x36d18b['UniverCollaborationClientPlugin']=_0x4e8bc1([_0x29a664[_0x997d7(0x553)](_0x5a7fdc[_0x997d7(0x3d0)],_0x200e90['UniverNetworkPlugin']),_0x1a6df7(0x1,_0x29a664['ILogService']),_0x1a6df7(0x2,_0x29a664['Inject'](_0x29a664['Injector'])),_0x1a6df7(0x3,_0x29a664['IConfigService'])],_0x36d18b[_0x997d7(0x4ac)]),_0x36d18b[_0x997d7(0x45e)]=_0x3fa783,_0x36d18b['CollaborationStatus']=_0x54c82e,_0x36d18b[_0x997d7(0x21f)]=_0xedfb31,_0x36d18b['CollaborationUIEventService']=_0x495958,_0x36d18b['CommentService']=_0x3e15b7,_0x36d18b['DEFAULT_COLLAB_WEB_SOCKET_URL']=_0x53efe6,_0x36d18b[_0x997d7(0x491)]=_0x77defc,_0x36d18b[_0x997d7(0x1fc)]=_0x4aaab9,_0x36d18b['HEARTBEAT_INTERVAL_KEY']=_0x2b6987,_0x36d18b[_0x997d7(0x4a2)]=_0x315b2c,_0x36d18b['ICollaborationSocketService']=_0x5b4d23,_0x36d18b[_0x997d7(0x495)]=_0x3e2be6,_0x36d18b[_0x997d7(0x3ee)]=_0x3b1d7a,_0x36d18b[_0x997d7(0x37d)]=_0x4f3087,_0x36d18b[_0x997d7(0x3a8)]=0x3e8,_0x36d18b[_0x997d7(0x3bd)]=_0xc708f2,_0x36d18b['REMOTE_UNISCRIPT_EXECUTION_ENDPOINT_KEY']=_0x48a22d,_0x36d18b[_0x997d7(0x434)]=_0x547549,_0x36d18b[_0x997d7(0x293)]=_0xbd299,_0x36d18b[_0x997d7(0x569)]=_0x4ff042,_0x36d18b[_0x997d7(0x55d)]=_0x5a583b,_0x36d18b['getLocalCacheKey']=_0x82f518,_0x36d18b['serializeCombRequest']=_0x4151ad,Object[_0x997d7(0x1ed)](_0x36d18b,Symbol['toStringTag'],{'value':_0x997d7(0x1f7)});}));function _0x4ecd(_0x54fdcb,_0x5bddf6){var _0x167719=_0x1677();return _0x4ecd=function(_0x4ecd6b,_0x499990){_0x4ecd6b=_0x4ecd6b-0x1e9;var _0x16a1c2=_0x167719[_0x4ecd6b];return _0x16a1c2;},_0x4ecd(_0x54fdcb,_0x5bddf6);}function _0x1677(){var _0x182f6e=['_onJoinRoomEvent','collabWebSocketUrl','LocalUndoRedoService','TOO_MANY_REQUESTS','LIVESHARE_OPERATION','/-/object/-/batch_allowed','_revisionService','onRemoteRetry','_onFetchMissResult','rev','generateRandomId','@univerjs-pro/license','_unitID','concat','clone','UNIVER_SLIDE','getCurrentRevOfUnit','WorkbookEditablePermission','UnitSnapshot','_createInitialStateImpl','onRemoteAck','createDecryptor','send','univer-pro.collaboration-client.network-condition.service','resourceIDs','ENTITLE_INSUFFICIENT_QUOTA','error','&source=','_createInitialState','saveSnapshot','awaitingChangeset','FETCH_MISSING','onTransformRemoteChangesetByStateCache\x20callback\x20is\x20not\x20added\x20yet.','_toggleOffline','UnitEmbedded','_sessions','UPDATE_CURSOR','close','/new_changes','PAYMENT_CHANNEL_NOT_SUPPORT','IConfigService','deleteCollaborator','_doReset','UNIVER_PROJECT','_getRedoStack','CBC','REDEMPTION_USER_REDEEM_TIMES_EXCEED','LocaleService','MOBILE_HAS_BEEN_BOUND','COMPLETION_FINISHED','[CollaborationEntity]:\x20invalid\x20state\x20transition!\x20State\x20transferred\x20from\x20is\x20not\x20the\x20current\x20state.\x0aBefore:\x20','_transformStateCache','_clearScheduledTask','/object','delay','_collaborationSessionService','LEAVE','_clearTimeoutTimer','method','padding','_commentService','failed\x20to\x20apply\x20missed\x20changesets!','enableOfflineEditing','COMPRESS_MUTATION_APPLY','repeat','RichTextEditingMutation','reduce','_executeRemoteChangeset','selections','newCsEvent','_append','getTypeOfUnitAdded$','INVALID_ARGUMENT','PERMISSION_REJ','mapDocumentTypeToUniverType','leaveEvent','_throwTelemetryCollaborationNewChangeset','error$','DocCollaborationEntity','exports','YUUMI_TABLE_NOT_FOUND_IN_UNIT','getTypeOfUnitDisposed$','ERROR_IMAGE','_acknowledgedAwaitingChangeset','fetchMiss','_tryReconnect','DataLoaderService','append','ISocketService','APPLY_REVISION_CONFILICT','listRoles','_transformUndoredo','YUUMI_CONNECTOR_URL_NOT_FOUND','Encryptor','subject','addHandlerCallback','authzUrl','_scheduleCompleteTimestamp','_transformService','_entities','kdf','getOwnPropertyDescriptor','entries','EMAIL_VERIFY_CODE_NOT_FOUND_OR_EXPIRED','location','rxjs','CHANGESET_REVISION_CONFILICT','getValue','post','_substituteUndoStack','_onConnectionOpen','updateOfflineData','_initRequestHeader','enableAuthServer','setCurrentUser','_mode','getGlobalObject','REDEMPTION_CODE_FULLY_REDEEMED','offline','JOIN_ROOM_PERMISSION_DENIED','_onRemoteRejected','_snapshotService','_replayCachedMutations','decryptBlock','update','loadDoc','_undoRedoService','DependentOn','now','_tryEnsureSocket','HELLO','ALREADY_EXISTS','Quantity','APPLY_DUPLICATED','INGEST','onlyLocal','REDEMPTION_CODE_HAS_BEEN_CREATED','deserializeToCombResponse','createInstance','confirm','appendMutation','change$','CollaborationSocketService','_clearCollaborationTimeoutTimer','pending','updateCollaborator','cfg','CommandType','SyncedState','UnitStatus','[FetchingMissState]:\x20not\x20expected\x20to\x20receive\x20ack\x20when\x20`this._awaitingChangeset`\x20is\x20null!','_transformRemoteChangesetByStateCache','sequenceExecute','_undoStacks','updatePermissionPoint','randomBytes','_onRecvEvent','_telemetryService','has','SnapshotService','YUUMI_SUBSCRIPTION_NOT_FOUND','ENTITLE_REPORT_LIMIT_EXCEED','transformMutationsWithChangeset','pad','reverse','CURRENT_STATUS_CANNOT_OPERATE','Base64','ENTITLE_NEED_BILLING_ADDRESS','encrypt','c1Prime','defineProperty','LICENSE_DISTRO_REJECTED','_compressMutationService','headers','1861keSRYi','Plugin','saveSheetBlock','5982810TQEJLS','isTransformMutationsWithChangesetFailure','objectID','Module','USER_NOT_FOUND','fetching\x20the\x20latest\x20document\x20from\x20the\x20server.','UNDEFINED','ERROR_EXCEED_SIZE','DEFAULT_WS_SESSION_TICKET_URL','_parse','requireSession','debug','params','6440697RWivbj','extend','hasOwnProperty','enableCollaboration','equals','dispose','_retryCount','IUniverInstanceService','SerializableCipher','@univerjs/sheets','MentionType','mode','_sendHeartbeat','onCommentUpdate','floor','_HTTPService','textRanges','ceil','getFocusedUnit','reset','keySize','APPLY_NON_SEQUENTIAL_REVISION','This\x20method\x20should\x20not\x20be\x20called\x20on\x20the\x20client\x20side!','HTTPService','c2Prime','CLOSE_ROOM','_syncEditingCollabCursor','JOIN_ROOM_NOT_EXISTS','_invKeySchedule','textEncoder','CollaborationUIEventId','_resendTimer','_logService','_oKey','closeSession','_state$','UNKNOWN_CMD','loadSheet','LICENSE_IMPORT_SIZE_EXCEEDED','session.join-failed','UNIVER_UNKNOWN','HmacSHA1','body','encode','stringify','/universer-api/oidc/authpage','USER_NOT_INVITED_CODE','HEARTBEAT','9126fJesir','IUndoRedoService','_key','Univer','cmd','prototype','onLocalMutation','[OfflineState]:\x20received\x20acknowledgement.','_collaborationPaused','_schedule','ENTITLE_CHAT_LIMIT_EXCEED','LIVESHARE_REQUEST_HOST','call','AWAITING_WITH_PENDING','Workbook','USER_IS_ANONYMOUS','_doCreateSocket','createCollaborator','CHANGESET_ACK','ImageSourceType','ImageUploadStatusType','ws://127.0.0.1:8000/universer-api/comb/connect','NOT_FOUND','APPLY_REJECT','JOINING','auth.needGotoLoginAlert','@univerjs-pro/collaboration','_ENC_XFORM_MODE','onTransformRemoteChangesetByIMECache\x20callback\x20is\x20not\x20added\x20yet.','LOGIN_TOKEN_PROCESSING_FAILED','mixIn','_updateStatus','Hex','HEARTBEAT_TIMEOUT','url','fetch_missing','SnapshotServerOverHTTPService','_remoteChangesetQueue','NEW_CHANGESETS','UniverCore','routeKey','YUUMI_RATE_OVER_LIMIT','JOIN_ROOM_FAILED','event$','@univerjs/docs','transformChangesets','_sender','isTransformMutationsWithChangesetSuccess','_configService','entityInit$','EMAIL_HAS_BEEN_BOUND','uniscriptRunEvent','PendingState','fromCollab','setWaitCount','disableLocalCache','_changesetSessionId','setShowComponents','[SyncedState]:\x20received\x20rejection.','SetSelectionsOperation','parseChangesetToProtocol','UniverSheets','charCodeAt','collaborators','toggleOffline','_telemetryInfo','concatMap','focused$','_init','_submitChangeset','BufferedBlockAlgorithm','snapshotServerUrl','encodeURIComponent','joinEvent','MergeInterceptorFactory','[CollaborationSessionService]:\x20socket\x20error','getActiveSheet','INVITE_CODE_REQUIRED','_checkMissing','ITelemetryService','Malformed\x20UTF-8\x20data','LICENSE_MAX_UNITS_EXCEEDED','_networkConditionService','HmacMD5','Disposable','[CollaborationUndoRedoService]','max','subUnitId','includes','Unknown\x20type.\x20Will\x20not\x20load\x20files\x20from\x20remote\x20address.','uploadFileServerUrl','SheetPermissionInitController','session','onSyncEditingCollabCursor','REDEMPTION_CODE_NOT_STARTED','OfflineState','univer-pro.collaboration-client.single-active-unit-service','_clearLocalCache','SessionStatus','editingUnit','revision','UniverProCollaboration','unitID','memberID','getTime','unitInfo$','Optional','function','registerDependencies','&assign=','\x20to\x20','dispose$','78896qWqVbv','COMMENT_UPDATE','MentionIoHttpService','_getAPIPrefixPath','copyFileMeta','SNAPSHOT_URL_KEY','close$','updateSnapshot','onTransformSelections','_socket$','pipe','CHANGESET_REJ','PERMISSION_DENIED','transformStack\x20failed!','mutations','byteLength','map','[CollaborationController]:\x20invalid\x20univer\x20type:\x20','_updateLocalCache','NoPadding','MUTATION','LOGIN_FAILED','[CollaborationEntity]:\x20cannot\x20lock\x20transition\x20twice!\x20This\x20is\x20an\x20implementation\x20error,\x20meaning\x20you\x20transit\x20the\x20collaboration\x20state\x20again\x20in\x20the\x20process\x20of\x20a\x20previous\x20transition.\x20This\x20should\x20never\x20happen.','_applyRemoteChangeset','/universer-api/snapshot','/universer-api/authz','People','INTERNAL_ERROR','forEach','Cipher','JSONX','_onConflict','onload','avatar','every','buffer','isArray','Injector','actions','PSEUDO_FETCH_MISSING_RESULT','_onRemoteChangeset','_onConnectionFailed','_removeRoom','awaiting_with_pending','_emitMembers','_localCacheService','_keyPriorReset','readAsDataURL','getInterceptPoints','x-univer-host','m2Prime','emitEvent','symbol','CollaborativeUndoRedoService','getRandomValues','OpenSSL','_initDependencies','uuidv4','_iKey','_commandService','_resendTimeout','_createHelper','_process','YUUMI_PROMPT_MAX_TOKENS_EXCEEDED','_replaceFileID','[CollaborationEntity]:\x20initial\x20state\x20has\x20been\x20created\x20before.\x20You\x20should\x20not\x20call\x20\x22init\x22\x20twice.','startsWith','_getLoginPath','_eventService','_waitCount','merge','image/jpg','baseRev','LICENSE_EXPORT_SIZE_EXCEEDED','sid','GLOBAL_ROOMS_CNT_EXCEEDS','_onLocalMutation','href','clear','string','getMemberID','enc','take','_prevBlock','unsubscribe','_substituteRedoStack','msCrypto','_pendingMutations','_handlerCallback','iterations','ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=','_clearRetryConnectingTimer','substr','CompressMutationService','ENTITLE_UPDOWN_GRADE_NOT_SUPPORT','range','collabSubmitChangesetUrl','_resendWithTimeout','_memberService','image/bmp','_initMergeInterceptor','put','length','APPLY_PERMISSION_DENIED','[OfflineState]:\x20received\x20changeset.','_injector','_onCombEvent','csRejEvent','words','_getUploadFileURL','217WqTWUb','FetchingMissState','/-/object/list','_members','asObservable','onSendChangeset','CollaborationEvent','execute','toggleOnline','fromCharCode','UniverInstanceType','state','disposeWithMe','/universer-api/file/{fileID}/sign-url','_type','getUnitOnRev','ERROR_AGAIN','isInternalEditorID','COMPRESS_MUTATION_SEND','CollaborationController','loadUnitOfRevision','title','_status$','getCollabEntity$','catch','eventID','LICENSE_MAX_MEMBERS_PER_UNIT_EXCEEDED','JOIN','PY_RUNTIME_SCRIPT_ERROR','WECHAT_HAS_BEEN_BOUND','_snapshotServerService','INVALID_INVITE_CODE','_listenToNetworkCondition','RxDisposable','_toggleOnline','_roomMembers','_sheetTransformSelectionsService','_onRemoteACK','_exhaustRemoteChangesetQueue','getResourcesRequest','_socketReady','_shouldReportTelemetry','Native\x20crypto\x20module\x20could\x20not\x20be\x20used\x20to\x20get\x20secure\x20random\x20number.','collaboratorID','[OfflineState]:\x20received\x20rejection.','IDLE','online$','/resources','readyForCollab','_initCloseConn','removeMember','_state','SUCCUSS','[CollaborationSessionService]','_DEC_XFORM_MODE','Inject','?url=','commentUpdateEvent','capture','/allowed','join','_reverseMap','_decreaseWaiting','_scheduleCollaborationTimeoutTimer','_transformSelections','_members$','status$','_getCurrentRevision','UserManagerService','image/png','_doProcessBlock','/block/','\x20in\x20_schedule.','session.room-cnt-exceeds','[CollaborationEntity]','onRemoteRej','ciphertext','refreshPermission','_entityInit$','SHOULD_CLOSE_CONN','amd','clamp','touchDependencies','/universer-api/uniscript','MD5','_getUndoStack','_change$','PERSON','then','getConfig','init','Cannot\x20assemble\x20a\x20changeset\x20from\x20multiple\x20mutations\x20of\x20different\x20types:\x20','waitForRoom$','INVITE_CODE_HAS_BEEN_UES','376IYIXPO','_changesetReqId','objectActions','status','getUnitType','PasswordBasedCipher','REDEMPTION_CODE_INACTIVE','unknown','delete','_cipher','YUUMI_URL_COL_OUT_OF_RANGE','workbook','getWorkbookSelections','connection\x20error','open$','enableSingleActiveInstanceLock','ISingleActiveUnitService','AwaitingState','ICommandService','_startTelemetryCollaborationNewChangeset','_isPermissionRej','pauseCollaboration','getSheetId','Error\x20on\x20receiving\x20event','Undefined','/universer-api/stream/file/upload','Decryptor','add','_localeService','socketService','requestParams','_hash','_handler','createIdentifier','_timeoutTimer','LIVESHARE_NEW_HOST','LIVESHARE_TERMINATE','[SyncedState]:\x20received\x20acknowledgement.','_iv','object','_imageSourceCache','csShouldRetryEvent','_unlockTransition','IAuthzIoService','IContextService','_registerDependencies','onCommandExecuted','synced','resolve','createEncryptor','[CollaborationState]:\x20apply\x20error!','reject','_transformStack','_stopTelemetryCollaborationNewChangeset','_sendHeartbeatTimer','[AuthServerService]:\x20you\x20should\x20provide\x20authentication\x20info\x20on\x20Node.js.','onTransformState','toString','CHANGESET_SHOULD_RETRY','LOCAL_CACHE_INTERVAL','min','result','UNRECOGNIZED','FileId','list','save\x20fail\x20reason\x20is\x20','UNAUTHENTICATED','type','firstValueFrom','univer-pro.collaboration-client-socket-service','__creator','LIVESHARE_FETCH_OPERATIONS','{fileID}','Utf8','SOCKET_FAILED_RETRY','_nDataBytes','onTransformIME','parseProtocolChangeset','BlockCipher','[ConflictState]:\x20invalid\x20calling\x20to\x20`resend`.','LOCAL_CACHE_INTERVAL_KEY','[FetchingMissState]:\x20invalid\x20calling\x20to\x20`resend`.','_event$','_createHmacHelper','[CollaborationSocketService]:\x20failed\x20to\x20get\x20web\x20socket\x20factory!','listCollaborators','_doFinalize','slice','ivSize','sendChangesetTimeout','mergeOverrideWithDependencies','UniverProCollaborationClient','REDEMPTION_USER_NOT_ELIGIBLE','_retryConnectingTimer','fetchMissingChangesets','subscribe','_nRounds','CONFLICT','_createHandler','UniverCollaborationPlugin','UNIVER_COLLABORATION_CLIENT_PLUGIN','&to=','isTransformChangesetsSuccess','HTTPRequest','registerHTTPInterceptor','_socketMessageSubscription','_onUserJoin','commentUpdate$','state$','_queuedRemoteChangesets','addImageSourceCache','AuthzIoHttpService','operators','_getDownloadEndpointURL','originalMeta','_singleActiveUnitService','isPermissionRej','getSheetBlock','10xkDFgN','message$','hostname','RECV','create','/fetchmissing?from=','code','UniverDrawing','_onOffline','_transitionLocked','collaboration-client.local-cache-service','INetworkConditionService','/universer-api/user/session-ticket','batchAllowed','_getSendChangesetTimeout','_collaborationTimeoutTimer','SUBMIT_CHANGESET_TIMEOUT','_httpService','indexOf','push','OTHER_CLIENTS_EDITING','[serializeCombRequest]:\x20should\x20not\x20fall\x20into\x20default\x20branch!','[OfflineState]:\x20invalid\x20calling\x20to\x20`resend`.','_socketService','crypto','_doCryptBlock','OFFLINE','YUUMI_NO_CUBOID_FOR_QUESTION','lib','1429460HFQTHQ','sheets','YUUMI_ASYNCIO_CANCELLED','onMissedChangesetFetched','getDeserializedSheetBlock','telemetry\x20info\x20is\x20not\x20initialized','_sendingTimer','image/jpeg','withCredentials','MemberService','awaiting','data','compute','onTransformRemoteChangesetByIMECache','responseType','sessionStatus$','from','_xformMode','_permissionService','Base','changesets','SheetTransformSelectionsService','HttpImport','INVITE_CODE_ALREADY_BOUND','\x0aCurrent:\x20','_collabSessionService','_keySchedule','SheetsSelectionsService','Subject','loginUrlKey','set','REMOTE_UNISCRIPT_EXECUTION_ENDPOINT','getCurrentUser','[CollaborationSession]:\x20should\x20not\x20send\x20message\x20when\x20the\x20session\x20is\x20offline!','getRoom','SNAPSHOT_INVALID_SNAPSHOT','RevisionService','splice','[PendingState]:\x20received\x20rejection.','liveShareNewHost','not_collab','ENSURE_SNAPSHOT_EXECUTION','complete','ONLINE','onRemoteChangeset','session.room-not-exists','key','ISnapshotServerService','CollaborationEntity','_roomCreated$','_univerInstanceService','_unitInfo$','RETRY_CONNECTING_MAX_COUNT_KEY','_redoStacks','getMember','EMAIL_VERIFY_CODE_MISMATCH','socket\x20open.','_initUnitPermissionChange','/collaborator','_showConflictNotification','onMissingChangesets','SHA1','MOBILE_VERIFY_CODE_MISMATCH','EvpKDF','transformSelections','unitId','_sessionStatus$','[CollaborationSession]','decrypt','ConflictState','CollaborationSessionService','UniverDocs','27751691fClwcG','/universer-api/comb','_startCollaboration','_commentUpdate$','_instanceService','YUUMI_UNABLE_LOAD_URL','NO_OTHER_CLIENTS_EDITING','joinRsp','localCacheService','reqId','_updateState','values','SheetCollaborationEntity','find','localeService','roomInfos','getUnit','executeCommand','@univerjs/drawing','takeUntil','\x0aAfter:\x20','updatePermissionObjEvent','COLLABORATION_CLIENT_PLUGIN_CONFIG_KEY','hasher','default','_map','liveShareOperation','\x22.\x20Please\x20configure\x20the\x20dynamicRequireTargets\x20or/and\x20ignoreDynamicRequires\x20option\x20of\x20@rollup/plugin-commonjs\x20appropriately\x20for\x20this\x20require\x20call\x20to\x20work.','retryConnectingInterval','HMAC','WordArray','_getAPIPrefix','fetchThroughInterceptors','filter','UniverProLicense','_waitForHeartbeatResponse','Hasher','_clearRedo','objectType','objects','_minBufferSize','IPermissionService','UserProfileImg','infoRsp','processBlock','[PendingState]:\x20received\x20acknowledgement.','next','OTHER_CLIENT_EDITING','image/gif','createSocket','_collaborationUIEventService','USERS_LEAVE','UNIVER_DOC','_config','get','_incrementRevisionNumber','_awaitingChangeset','_lockTransition','resend','UNISCRIPT_RUN','/unit/','_createSocket','updateMember','parse','blockSize','SOCKET_FAILED','DATA_SOURCE_TOO_LARGE','ENTITLE_DUP_SUBSCRIPTION','saveImage','_clearUndo','SUBMIT_CHANGESET','/object/','CONNECTOR_DATA_TOO_LARGE','DEFAULT_REMOTE_UNISCRIPT_EXECUTION_ENDPOINT','ILogService','apply','fetching\x20missing\x20changesets\x20from\x20','ILocalCacheService','unitId\x20is\x20not\x20found','JOIN_ROOM_FULL','size','downloadEndpointUrl','encryptBlock','SNAPSHOT_HAS_BEEN_REMOVED','algo','onTransformRemoteChangesetByStateCache','_socket','_rescheduleHeartbeat','conflict','CollaborationImageIoService','HEARTBEAT_TIMEOUT_KEY','finalize','$super','ITransformService','Failed\x20to\x20update\x20permission\x20point','DisposableCollection','reconnect','charAt','StreamCipher','format','UniverCollaborationClientPlugin','random','getUnitId','AES','salt','Could\x20not\x20dynamically\x20require\x20\x22','getSnapshotAPIPath','loadOfflineData','onStarting','toDisposable','ERROR_IMAGE_TYPE','_hasher','USERS_ENTER','interceptor','AwaitingWithPendingState','permissionRejEvent','PENDING','AUTHORIZE_CODE_ILLEGAL','BehaviorSubject','onStateChange','ClipsheetFragments','UPDATE_PERMISSION_OBJ','getImageSourceCache','sigBytes','transformUndoRedo','UNIVER_SHEET','_userManagerService','b64DecodeUnicode','[PendingState]:\x20invalid\x20calling\x20to\x20`resend`.','340xzbsJq','_clearHeartbeatTimer','_data','_candidateSocket','userID','stopTime','UNKNOWN_CODE','collaMsg','CollaborationSession','name','_getSignURL'];_0x1677=function(){return _0x182f6e;};return _0x1677();}

// @univerjs-pro/collaboration-client/facade
function _0x350f(_0x1a12db,_0x288da1){var _0x3635af=_0x3635();return _0x350f=function(_0x350fcc,_0x5efc80){_0x350fcc=_0x350fcc-0xe2;var _0x13f87b=_0x3635af[_0x350fcc];return _0x13f87b;},_0x350f(_0x1a12db,_0x288da1);}(function(_0x431062,_0x49cfa7){var _0x3bafa4=_0x350f,_0xe4842a=_0x431062();while(!![]){try{var _0x2013af=parseInt(_0x3bafa4(0x115))/0x1+parseInt(_0x3bafa4(0xf5))/0x2+-parseInt(_0x3bafa4(0xf3))/0x3*(parseInt(_0x3bafa4(0x107))/0x4)+parseInt(_0x3bafa4(0x10c))/0x5+parseInt(_0x3bafa4(0xee))/0x6+-parseInt(_0x3bafa4(0xe9))/0x7+-parseInt(_0x3bafa4(0xfa))/0x8;if(_0x2013af===_0x49cfa7)break;else _0xe4842a['push'](_0xe4842a['shift']());}catch(_0x224297){_0xe4842a['push'](_0xe4842a['shift']());}}}(_0x3635,0xd3248),function(_0x30c58e,_0x158d30){var _0x1b967b=_0x350f;typeof exports=='object'&&typeof module<'u'?_0x158d30(exports,require('@univerjs-pro/collaboration-client'),require('@univerjs/core/facade'),require('@univerjs-pro/collaboration'),require('@univerjs/core'),require('rxjs')):typeof define==_0x1b967b(0x104)&&define[_0x1b967b(0xe5)]?define([_0x1b967b(0xfc),_0x1b967b(0xe6),_0x1b967b(0x113),_0x1b967b(0xf0),'@univerjs/core',_0x1b967b(0xf9)],_0x158d30):(_0x30c58e=typeof globalThis<'u'?globalThis:_0x30c58e||self,_0x158d30(_0x30c58e[_0x1b967b(0xfd)]={},_0x30c58e[_0x1b967b(0xf7)],_0x30c58e[_0x1b967b(0xef)],_0x30c58e[_0x1b967b(0xe7)],_0x30c58e[_0x1b967b(0x10e)],_0x30c58e[_0x1b967b(0xf9)]));}(this,function(_0x41ac2a,_0x36535c,_0x355a7f,_0x53573a,_0x2ed65c,_0x8337b1){'use strict';var _0x1bedcb=_0x350f;var _0x3fbdb6=Object[_0x1bedcb(0x100)],_0x2a719b=(_0x5b7c25,_0x1e8694,_0x3f70e7,_0x2ae772)=>{var _0x27fba4=_0x1bedcb;for(var _0x17db19=_0x2ae772>0x1?void 0x0:_0x2ae772?_0x3fbdb6(_0x1e8694,_0x3f70e7):_0x1e8694,_0x681ca7=_0x5b7c25[_0x27fba4(0x111)]-0x1,_0x3207cf;_0x681ca7>=0x0;_0x681ca7--)(_0x3207cf=_0x5b7c25[_0x681ca7])&&(_0x17db19=_0x3207cf(_0x17db19)||_0x17db19);return _0x17db19;},_0x142842=(_0x5bf7e5,_0xed6a48)=>(_0x132cb4,_0x4fd8f1)=>_0xed6a48(_0x132cb4,_0x4fd8f1,_0x5bf7e5);_0x41ac2a[_0x1bedcb(0xe2)]=class extends _0x355a7f[_0x1bedcb(0xf4)]{constructor(_0x3a8d96,_0x258388,_0x417193,_0x7acab4,_0x5f08a2){var _0x1c09fc=_0x1bedcb;super(),this['_handler']=_0x3a8d96,this[_0x1c09fc(0xe8)]=_0x258388,this[_0x1c09fc(0xe3)]=_0x417193,this[_0x1c09fc(0xf2)]=_0x7acab4,this[_0x1c09fc(0xf6)]=_0x5f08a2;}async[_0x1bedcb(0xec)](){return this['loadActiveSheetAsync']();}async['loadActiveSheetAsync'](){var _0x200d95=_0x1bedcb;throw new Error(_0x200d95(0xeb));}async['loadSheet'](_0x26943a){var _0x934b2c=_0x1bedcb;return this[_0x934b2c(0x10a)](_0x26943a);}async['loadSheetAsync'](_0x2292c9,_0x51d9c8){var _0x540fd6=_0x1bedcb;return await this[_0x540fd6(0xf2)][_0x540fd6(0xf1)](_0x2292c9,0x0,_0x51d9c8)?(await this[_0x540fd6(0xf6)]['readyForCollab'](_0x2292c9),this['_handler'][_0x540fd6(0x116)](_0x2292c9)):null;}['subscribeCollaborators'](_0x18730a,_0x50cdc8){var _0x10ca7b=_0x1bedcb;const _0x4d09ad=this['_injector']['get'](_0x36535c['MemberService'])[_0x10ca7b(0x110)](_0x18730a)['pipe'](_0x8337b1[_0x10ca7b(0x103)](_0x14752e=>_0x14752e[_0x10ca7b(0xed)]))[_0x10ca7b(0x101)](_0x4e0a04=>_0x50cdc8(Array['from'](_0x4e0a04[_0x10ca7b(0x109)]())));return _0x2ed65c['toDisposable'](_0x4d09ad);}},_0x41ac2a[_0x1bedcb(0xe2)]=_0x2a719b([_0x142842(0x1,_0x2ed65c[_0x1bedcb(0x105)](_0x2ed65c[_0x1bedcb(0x10b)])),_0x142842(0x2,_0x2ed65c[_0x1bedcb(0x114)]),_0x142842(0x3,_0x2ed65c[_0x1bedcb(0x105)](_0x53573a[_0x1bedcb(0xe4)])),_0x142842(0x4,_0x2ed65c[_0x1bedcb(0x105)](_0x36535c[_0x1bedcb(0xfb)]))],_0x41ac2a['FCollaboration']);class _0x132580 extends _0x355a7f[_0x1bedcb(0x108)]{['getCollaboration'](){var _0x496e5a=_0x1bedcb;return this[_0x496e5a(0xe8)][_0x496e5a(0xff)](_0x41ac2a[_0x496e5a(0xe2)],{'getUniverSheet':_0x1b14d3=>this[_0x496e5a(0x116)](_0x1b14d3)});}[_0x1bedcb(0x112)](_0x4a034e,_0x189b1f,_0x33a516){var _0x5a1160=_0x1bedcb;return this[_0x5a1160(0xe8)][_0x5a1160(0xea)](_0x36535c[_0x5a1160(0xf8)])[_0x5a1160(0x106)](_0x4a034e,_0x189b1f,_0x33a516);}[_0x1bedcb(0xfe)](_0x5c0efe,_0x18bd2e,_0x54faf3){var _0x37b5a4=_0x1bedcb;return this[_0x37b5a4(0xe8)]['get'](_0x36535c[_0x37b5a4(0xf8)])['loadUnitOfRevision'](_0x5c0efe,_0x18bd2e,_0x54faf3);}}_0x355a7f[_0x1bedcb(0x108)][_0x1bedcb(0x10d)](_0x132580),Object[_0x1bedcb(0x102)](_0x41ac2a,Symbol['toStringTag'],{'value':_0x1bedcb(0x10f)});}));function _0x3635(){var _0x5d7826=['getUniverSheet','FCollaboration','_univerInstanceService','SnapshotService','amd','@univerjs-pro/collaboration-client','UniverProCollaboration','_injector','8269513aMRbnC','get','[FCollaboration]:\x20this\x20method\x20should\x20be\x20override.','loadActiveSheet','members$','3570714GgzlOf','UniverCoreFacade','@univerjs-pro/collaboration','loadSheet','_snapshotService','2528781Cehufn','FBase','2567456IKhOoA','_collaborationController','UniverProCollaborationClient','DataLoaderService','rxjs','6708328JrdQVg','CollaborationController','exports','UniverProCollaborationClientFacade','loadServerUnitOfRevision','createInstance','getOwnPropertyDescriptor','subscribe','defineProperty','switchMap','function','Inject','loadUnit','4EEmyJR','FUniver','values','loadSheetAsync','Injector','6744870sszaDZ','extend','UniverCore','Module','waitForRoom$','length','loadServerUnit','@univerjs/core/facade','IUniverInstanceService','499846kxAATa'];_0x3635=function(){return _0x5d7826;};return _0x3635();}

// @univerjs-pro/collaboration-client-ui/index
(function(_0x39a91c,_0x3c1999){const _0x45bbc2=_0x1a8e,_0x592ba6=_0x39a91c();while(!![]){try{const _0x39fa18=parseInt(_0x45bbc2(0x1e2))/0x1+-parseInt(_0x45bbc2(0x425))/0x2+-parseInt(_0x45bbc2(0x253))/0x3*(parseInt(_0x45bbc2(0x3b0))/0x4)+parseInt(_0x45bbc2(0x204))/0x5*(-parseInt(_0x45bbc2(0x205))/0x6)+parseInt(_0x45bbc2(0x270))/0x7+parseInt(_0x45bbc2(0x3ef))/0x8+-parseInt(_0x45bbc2(0x28a))/0x9;if(_0x39fa18===_0x3c1999)break;else _0x592ba6['push'](_0x592ba6['shift']());}catch(_0x2ae363){_0x592ba6['push'](_0x592ba6['shift']());}}}(_0x14a7,0xd7a44),function(_0x41738b,_0x71ca4c){const _0x39a7ef=_0x1a8e;typeof exports=='object'&&typeof module<'u'?_0x71ca4c(exports,require('react/jsx-runtime'),require('@univerjs-pro/collaboration-client'),require('@univerjs/core'),require('@univerjs/ui'),require('rxjs'),require('@univerjs/design'),require('react'),require('@univerjs/rpc'),require('@univerjs/sheets'),require('@univerjs/engine-render'),require('@univerjs/network'),require('@univerjs/docs-ui'),require('@univerjs/drawing'),require('@univerjs-pro/collaboration'),require('@univerjs/docs'),require('@univerjs/engine-formula'),require('rxjs/operators'),require('@univerjs/sheets-ui')):typeof define=='function'&&define[_0x39a7ef(0x1d2)]?define([_0x39a7ef(0x444),_0x39a7ef(0x1ff),_0x39a7ef(0x401),_0x39a7ef(0x28f),'@univerjs/ui',_0x39a7ef(0x31a),_0x39a7ef(0x1e0),_0x39a7ef(0x493),'@univerjs/rpc',_0x39a7ef(0x360),_0x39a7ef(0x36a),_0x39a7ef(0x2e5),_0x39a7ef(0x34d),_0x39a7ef(0x2b5),_0x39a7ef(0x288),'@univerjs/docs',_0x39a7ef(0x323),_0x39a7ef(0x468),_0x39a7ef(0x21e)],_0x71ca4c):(_0x41738b=typeof globalThis<'u'?globalThis:_0x41738b||self,_0x71ca4c(_0x41738b[_0x39a7ef(0x1f7)]={},_0x41738b[_0x39a7ef(0x382)],_0x41738b[_0x39a7ef(0x3c8)],_0x41738b['UniverCore'],_0x41738b[_0x39a7ef(0x22f)],_0x41738b[_0x39a7ef(0x31a)],_0x41738b[_0x39a7ef(0x3b9)],_0x41738b['React'],_0x41738b[_0x39a7ef(0x1e8)],_0x41738b[_0x39a7ef(0x224)],_0x41738b[_0x39a7ef(0x464)],_0x41738b['UniverNetwork'],_0x41738b[_0x39a7ef(0x3ad)],_0x41738b[_0x39a7ef(0x32c)],_0x41738b[_0x39a7ef(0x223)],_0x41738b[_0x39a7ef(0x21a)],_0x41738b[_0x39a7ef(0x1ea)],_0x41738b[_0x39a7ef(0x31a)]['operators'],_0x41738b[_0x39a7ef(0x20b)]));}(this,function(_0x46875a,_0x246a04,_0x46104e,_0x161ac6,_0x4291c6,_0x66cc31,_0x37af48,_0x166ef5,_0xbc9216,_0xc6f6be,_0x1fade8,_0x4db2d9,_0x5d4e8b,_0x275a1a,_0x48fdef,_0x4db13e,_0x50020c,_0x136df2,_0x5b4c60){'use strict';const _0x4624f5=_0x1a8e;var _0x489fc9=Object[_0x4624f5(0x340)],_0x1b6f59=(_0x2f034f,_0x5c44a7,_0x4e409e)=>_0x5c44a7 in _0x2f034f?_0x489fc9(_0x2f034f,_0x5c44a7,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0x4e409e}):_0x2f034f[_0x5c44a7]=_0x4e409e,_0x47bfcc=(_0x3a75be,_0x3aaffa,_0x2e5fd1)=>_0x1b6f59(_0x3a75be,typeof _0x3aaffa!='symbol'?_0x3aaffa+'':_0x3aaffa,_0x2e5fd1);function _0x3874fc({ref:_0x8d73ff,..._0x2edd9d}){const _0x6a3ff8=_0x4624f5,{icon:_0x1103ff,id:_0x2347d1,className:_0x47f2ad,extend:_0x5749d4,..._0x566b9e}=_0x2edd9d,_0x2ab888=(_0x6a3ff8(0x486)+_0x2347d1+'\x20'+(_0x47f2ad||''))[_0x6a3ff8(0x358)](),_0x406f6=_0x166ef5[_0x6a3ff8(0x2a7)]('_'+_0x2bd72d());return _0xd862a4(_0x1103ff,''+_0x2347d1,{'defIds':_0x1103ff[_0x6a3ff8(0x40a)],'idSuffix':_0x406f6[_0x6a3ff8(0x472)]},{'ref':_0x8d73ff,'className':_0x2ab888,..._0x566b9e},_0x5749d4);}function _0xd862a4(_0x1afe7a,_0x33591f,_0x3ee733,_0x15eafa,_0x257323){const _0xed069b=_0x4624f5;return _0x166ef5[_0xed069b(0x3cc)](_0x1afe7a['tag'],{'key':_0x33591f,..._0x504ee4(_0x1afe7a,_0x3ee733,_0x257323),..._0x15eafa},(_0x301629(_0x1afe7a,_0x3ee733)['children']||[])[_0xed069b(0x44e)]((_0x71a161,_0x2e2b7b)=>_0xd862a4(_0x71a161,_0x33591f+'-'+_0x1afe7a['tag']+'-'+_0x2e2b7b,_0x3ee733,void 0x0,_0x257323)));}function _0x504ee4(_0x3870cb,_0x138cac,_0x1005ff){const _0x48ddcd=_0x4624f5,_0xf1b5cd={..._0x3870cb[_0x48ddcd(0x495)]};_0x1005ff!=null&&_0x1005ff[_0x48ddcd(0x39f)]&&_0xf1b5cd[_0x48ddcd(0x201)]===_0x48ddcd(0x39f)&&(_0xf1b5cd[_0x48ddcd(0x201)]=_0x1005ff[_0x48ddcd(0x39f)]),_0x3870cb[_0x48ddcd(0x32f)]===_0x48ddcd(0x231)&&_0xf1b5cd['id']&&(_0xf1b5cd['id']=_0xf1b5cd['id']+_0x138cac['idSuffix']),Object[_0x48ddcd(0x2a6)](_0xf1b5cd)[_0x48ddcd(0x265)](([_0x337cb1,_0x31e44b])=>{const _0x1b6909=_0x48ddcd;_0x337cb1==='mask'&&typeof _0x31e44b==_0x1b6909(0x306)&&(_0xf1b5cd[_0x337cb1]=_0x31e44b['replace'](/url\(#(.*)\)/,_0x1b6909(0x28e)+_0x138cac[_0x1b6909(0x35e)]+')'));});const {defIds:_0x41edb4}=_0x138cac;return!_0x41edb4||_0x41edb4['length']===0x0||(_0x3870cb[_0x48ddcd(0x32f)]===_0x48ddcd(0x275)&&_0xf1b5cd[_0x48ddcd(0x284)]&&(_0xf1b5cd[_0x48ddcd(0x284)]=_0xf1b5cd[_0x48ddcd(0x284)]+_0x138cac[_0x48ddcd(0x35e)]),Object[_0x48ddcd(0x2a6)](_0xf1b5cd)[_0x48ddcd(0x265)](([_0x3ecec7,_0x4c1d74])=>{const _0x456352=_0x48ddcd;typeof _0x4c1d74==_0x456352(0x306)&&(_0xf1b5cd[_0x3ecec7]=_0x4c1d74[_0x456352(0x3bc)](/url\(#(.*)\)/,_0x456352(0x28e)+_0x138cac[_0x456352(0x35e)]+')'));})),_0xf1b5cd;}function _0x301629(_0x5df16e,_0x4b3cb7){const _0x865fcd=_0x4624f5;var _0x1ee7ea;const {defIds:_0x3673ef}=_0x4b3cb7;return!_0x3673ef||_0x3673ef[_0x865fcd(0x1e5)]===0x0?_0x5df16e:_0x5df16e[_0x865fcd(0x32f)]==='defs'&&((_0x1ee7ea=_0x5df16e[_0x865fcd(0x34c)])!=null&&_0x1ee7ea[_0x865fcd(0x1e5)])?{..._0x5df16e,'children':_0x5df16e[_0x865fcd(0x34c)][_0x865fcd(0x44e)](_0x22acce=>typeof _0x22acce[_0x865fcd(0x495)]['id']==_0x865fcd(0x306)&&_0x3673ef&&_0x3673ef[_0x865fcd(0x354)](_0x22acce[_0x865fcd(0x495)]['id'])?{..._0x22acce,'attrs':{..._0x22acce[_0x865fcd(0x495)],'id':_0x22acce[_0x865fcd(0x495)]['id']+_0x4b3cb7['idSuffix']}}:_0x22acce)}:_0x5df16e;}function _0x2bd72d(){const _0x3e5712=_0x4624f5;return Math['random']()[_0x3e5712(0x266)](0x24)[_0x3e5712(0x27b)](0x2,0x8);}_0x3874fc[_0x4624f5(0x49e)]=_0x4624f5(0x3af);const _0x5a0d1b={'tag':_0x4624f5(0x396),'attrs':{'xmlns':_0x4624f5(0x208),'fill':_0x4624f5(0x3ba),'viewBox':_0x4624f5(0x350),'width':'1em','height':'1em'},'children':[{'tag':'g','attrs':{'clipPath':_0x4624f5(0x2cb)},'children':[{'tag':_0x4624f5(0x461),'attrs':{'stroke':'currentColor','d':_0x4624f5(0x1dc),'strokeLinecap':'round','strokeLinejoin':_0x4624f5(0x31e),'strokeWidth':1.2}}]},{'tag':_0x4624f5(0x2ff),'attrs':{},'children':[{'tag':_0x4624f5(0x246),'attrs':{'id':_0x4624f5(0x453)},'children':[{'tag':_0x4624f5(0x461),'attrs':{'fill':_0x4624f5(0x471),'d':'M0\x200H16V16H0z'}}]}]}],'defIds':[_0x4624f5(0x453)]},_0x879869=_0x166ef5[_0x4624f5(0x28d)](function(_0x52cbcc,_0xcd2715){const _0x302fa6=_0x4624f5;return _0x166ef5[_0x302fa6(0x3cc)](_0x3874fc,Object[_0x302fa6(0x2b7)]({},_0x52cbcc,{'id':_0x302fa6(0x45e),'ref':_0xcd2715,'icon':_0x5a0d1b}));});_0x879869[_0x4624f5(0x49e)]=_0x4624f5(0x43e);const _0x3ee199={'tag':'svg','attrs':{'xmlns':_0x4624f5(0x208),'fill':_0x4624f5(0x3ba),'viewBox':'0\x200\x2017\x2016','width':_0x4624f5(0x437),'height':'1em'},'children':[{'tag':'g','attrs':{'clipPath':'url(#on-line-icon_clip0_910_349)'},'children':[{'tag':_0x4624f5(0x461),'attrs':{'stroke':_0x4624f5(0x2a8),'d':_0x4624f5(0x206),'strokeLinecap':_0x4624f5(0x31e),'strokeLinejoin':_0x4624f5(0x31e),'strokeWidth':1.2}}]},{'tag':'defs','attrs':{},'children':[{'tag':_0x4624f5(0x246),'attrs':{'id':_0x4624f5(0x2a1)},'children':[{'tag':'path','attrs':{'fill':_0x4624f5(0x471),'d':_0x4624f5(0x3a3),'transform':'translate(.97)'}}]}]}],'defIds':[_0x4624f5(0x2a1)]},_0xc8a5ab=_0x166ef5['forwardRef'](function(_0x5aaba8,_0x3c3199){const _0x1603b0=_0x4624f5;return _0x166ef5[_0x1603b0(0x3cc)](_0x3874fc,Object[_0x1603b0(0x2b7)]({},_0x5aaba8,{'id':'on-line-icon','ref':_0x3c3199,'icon':_0x3ee199}));});_0xc8a5ab[_0x4624f5(0x49e)]=_0x4624f5(0x349);function _0xe2a3cc(_0xffd0af){const _0x46744e=_0x4624f5;switch(_0xffd0af){case _0x46104e[_0x46744e(0x2e6)][_0x46744e(0x442)]:return _0x46744e(0x49f);case _0x46104e[_0x46744e(0x2e6)]['CONFLICT']:return _0x46744e(0x1f6);case _0x46104e[_0x46744e(0x2e6)][_0x46744e(0x3a7)]:return _0x46744e(0x258);case _0x46104e[_0x46744e(0x2e6)][_0x46744e(0x484)]:return _0x46744e(0x47f);case _0x46104e[_0x46744e(0x2e6)][_0x46744e(0x3dd)]:case _0x46104e[_0x46744e(0x2e6)][_0x46744e(0x2d7)]:return _0x46744e(0x2d5);case _0x46104e['CollaborationStatus'][_0x46744e(0x219)]:case _0x46104e[_0x46744e(0x2e6)][_0x46744e(0x3f6)]:return _0x46744e(0x316);}}function _0x58006a(_0x5b11b1){const _0x549c66=_0x4624f5,{status$:_0x33bccf}=_0x5b11b1,_0x329ec4=_0x4291c6['useObservable'](_0x33bccf,_0x46104e[_0x549c66(0x2e6)][_0x549c66(0x484)]),_0xe9d830=_0x4291c6[_0x549c66(0x3fd)](_0x161ac6[_0x549c66(0x25a)]),_0x319616=_0x4291c6[_0x549c66(0x3fd)](_0x46104e[_0x549c66(0x26a)]),_0x14f059=_0x329ec4!==_0x46104e['CollaborationStatus'][_0x549c66(0x442)],_0x3b1b11=_0xe9d830['t'](_0xe2a3cc(_0x329ec4)),_0x437d34=_0x14f059?_0x246a04[_0x549c66(0x2cf)](_0xc8a5ab,{}):_0x246a04[_0x549c66(0x2cf)](_0x879869,{}),_0x1a0225=_0x166ef5[_0x549c66(0x352)](()=>{const _0x368dea=_0x549c66;_0x14f059||_0x319616[_0x368dea(0x474)]();},[_0x14f059,_0x319616]);function _0x32cb69(){const _0x1d9b62=_0x549c66;return _0x246a04['jsxs'](_0x1d9b62(0x414),{'className':'univer-flex\x20univer-items-center','onClick':_0x1a0225,'children':[_0x246a04['jsx'](_0x1d9b62(0x414),{'className':_0x37af48['clsx'](_0x1d9b62(0x3ac),{'univer-text-green-500':_0x14f059,'univer-text-red-500':!_0x14f059}),'children':_0x437d34}),_0x246a04['jsx'](_0x1d9b62(0x414),{'className':_0x1d9b62(0x400),'children':_0x3b1b11})]});}return _0x14f059?_0x32cb69():_0x246a04[_0x549c66(0x2cf)](_0x37af48[_0x549c66(0x318)],{'title':_0xe9d830['t'](_0x549c66(0x47d)),'children':_0x32cb69()});}var _0x13d5fd=Object['getOwnPropertyDescriptor'],_0x1d9a4a=(_0x243bdd,_0xc1e9d5,_0x4a996e,_0xc727a5)=>{const _0x35f124=_0x4624f5;for(var _0x21886c=_0xc727a5>0x1?void 0x0:_0xc727a5?_0x13d5fd(_0xc1e9d5,_0x4a996e):_0xc1e9d5,_0x36ee63=_0x243bdd[_0x35f124(0x1e5)]-0x1,_0x5e4002;_0x36ee63>=0x0;_0x36ee63--)(_0x5e4002=_0x243bdd[_0x36ee63])&&(_0x21886c=_0x5e4002(_0x21886c)||_0x21886c);return _0x21886c;},_0x2fc7d5=(_0x55ca09,_0x1509fe)=>(_0x10faf0,_0x214fb9)=>_0x1509fe(_0x10faf0,_0x214fb9,_0x55ca09);_0x46875a[_0x4624f5(0x492)]=class extends _0x161ac6[_0x4624f5(0x482)]{constructor(_0x382067,_0x47a158,_0x282d21,_0xa37ee1){const _0x2b296b=_0x4624f5;super(),_0x47bfcc(this,_0x2b296b(0x3e7),new _0x66cc31['BehaviorSubject'](_0x46104e['CollaborationStatus'][_0x2b296b(0x484)])),(this['_univerInstanceService']=_0x382067,this[_0x2b296b(0x298)]=_0x47a158,this[_0x2b296b(0x2c0)]=_0x282d21,this[_0x2b296b(0x2ab)]=_0xa37ee1,this[_0x2b296b(0x384)](),this[_0x2b296b(0x33d)]());}['_initStatusListener'](){const _0x4ad62b=_0x4624f5;this[_0x4ad62b(0x30f)](this[_0x4ad62b(0x485)]['focused$'][_0x4ad62b(0x1ef)](_0x66cc31[_0x4ad62b(0x46f)](()=>{const _0x588c97=_0x4ad62b,_0x3938fa=this[_0x588c97(0x485)][_0x588c97(0x45a)]();return _0x3938fa?this['_collaborationController'][_0x588c97(0x46c)](_0x3938fa[_0x588c97(0x30b)]()):_0x66cc31['of'](null);}),_0x66cc31[_0x4ad62b(0x46f)](_0x22da9e=>_0x22da9e?_0x22da9e[_0x4ad62b(0x2dd)]:_0x66cc31['of'](_0x46104e[_0x4ad62b(0x2e6)][_0x4ad62b(0x484)])))[_0x4ad62b(0x26b)](_0x1e5375=>{const _0x2f6df3=_0x4ad62b;this[_0x2f6df3(0x3e7)][_0x2f6df3(0x3c9)](_0x1e5375);}));}[_0x4624f5(0x384)](){const _0x532a40=_0x4624f5;this[_0x532a40(0x30f)](this[_0x532a40(0x2ab)][_0x532a40(0x3eb)](_0x4291c6[_0x532a40(0x411)]['HEADER_MENU'],()=>_0x4291c6[_0x532a40(0x370)](_0x423244({'status$':this[_0x532a40(0x3e7)][_0x532a40(0x215)]()}),this[_0x532a40(0x298)])));}},_0x46875a[_0x4624f5(0x492)]=_0x1d9a4a([_0x2fc7d5(0x0,_0x161ac6[_0x4624f5(0x37d)]),_0x2fc7d5(0x1,_0x161ac6[_0x4624f5(0x2b0)](_0x161ac6[_0x4624f5(0x2c2)])),_0x2fc7d5(0x2,_0x161ac6[_0x4624f5(0x2b0)](_0x46104e[_0x4624f5(0x23f)])),_0x2fc7d5(0x3,_0x4291c6[_0x4624f5(0x228)])],_0x46875a[_0x4624f5(0x492)]);function _0x423244(_0x4dc632){const {status$:_0x451a79}=_0x4dc632;return function(){return _0x246a04['jsx'](_0x58006a,{'status$':_0x451a79});};}const _0x5a3a5f=_0x161ac6[_0x4624f5(0x282)]('uni.network.url-service');var _0x4f5c71=Object['getOwnPropertyDescriptor'],_0x318a87=(_0x53c002,_0x4063b5,_0x528898,_0x249335)=>{const _0x1e2fae=_0x4624f5;for(var _0x1ae9dd=_0x249335>0x1?void 0x0:_0x249335?_0x4f5c71(_0x4063b5,_0x528898):_0x4063b5,_0x1c09c7=_0x53c002[_0x1e2fae(0x1e5)]-0x1,_0x1bf666;_0x1c09c7>=0x0;_0x1c09c7--)(_0x1bf666=_0x53c002[_0x1c09c7])&&(_0x1ae9dd=_0x1bf666(_0x1ae9dd)||_0x1ae9dd);return _0x1ae9dd;},_0x158e8b=(_0x229ae8,_0x5d6300)=>(_0x3a4259,_0x2e48a9)=>_0x5d6300(_0x3a4259,_0x2e48a9,_0x229ae8);_0x46875a[_0x4624f5(0x25f)]=class extends _0x161ac6[_0x4624f5(0x240)]{constructor(_0x3c2c95,_0x57c844,_0x3012bc,_0x2d2d4b,_0x291d1e){const _0x42fd77=_0x4624f5;super(),this[_0x42fd77(0x27e)]=_0x3c2c95,this[_0x42fd77(0x3a2)]=_0x57c844,this[_0x42fd77(0x43a)]=_0x3012bc,this[_0x42fd77(0x1e1)]=_0x2d2d4b,_0x291d1e?_0x291d1e==null||_0x291d1e[_0x42fd77(0x38f)]()[_0x42fd77(0x2e0)](()=>this[_0x42fd77(0x48d)]()):(this[_0x42fd77(0x3a2)]['debug'](_0x42fd77(0x48a),'No\x20remote\x20instance\x20service\x20injected.\x20May\x20not\x20syncing\x20edits\x20to\x20the\x20web\x20worker.'),this[_0x42fd77(0x48d)]());}async[_0x4624f5(0x48d)](){const _0x1263eb=_0x4624f5,_0x28c684=this[_0x1263eb(0x27e)]['getParam'](_0x1263eb(0x285)),_0x3ccaf9=this[_0x1263eb(0x27e)]['getParam'](_0x1263eb(0x35b)),_0x4adb75=this['_urlService'][_0x1263eb(0x3cd)](_0x1263eb(0x1cc));if(!_0x28c684||!_0x3ccaf9){this[_0x1263eb(0x3a2)]['debug']('[CollaborationDataLoaderController]',_0x1263eb(0x489));return;}const _0x268129=await this[_0x1263eb(0x1e1)][_0x1263eb(0x2ef)](_0x28c684,Number(_0x3ccaf9),_0x4adb75);_0x268129&&_0x268129 instanceof _0x161ac6[_0x1263eb(0x477)]&&this[_0x1263eb(0x296)](_0x268129);}async[_0x4624f5(0x296)](_0x218552){const _0x66c61f=_0x4624f5;await this[_0x66c61f(0x404)](_0x218552),_0x218552[_0x66c61f(0x1f4)]['pipe'](_0x66cc31[_0x66c61f(0x45d)](this['dispose$']))[_0x66c61f(0x26b)](_0x22f203=>{const _0x441d76=_0x66c61f;_0x22f203&&this[_0x441d76(0x2c6)](_0x22f203);}),this['_urlService'][_0x66c61f(0x23e)][_0x66c61f(0x1ef)](_0x66cc31[_0x66c61f(0x45d)](this['dispose$']))[_0x66c61f(0x26b)](()=>this['_updateSubUnitFromURLParams'](_0x218552));}['_updateURLWithCurrentState'](_0x22d09a,_0x5ec5e4=!0x1){const _0x796eb2=_0x4624f5,_0x1f1fe8=this[_0x796eb2(0x27e)][_0x796eb2(0x3cd)]('subunit');_0x22d09a[_0x796eb2(0x447)]()!==_0x1f1fe8&&this[_0x796eb2(0x27e)][_0x796eb2(0x2c9)](_0x796eb2(0x1cc),_0x22d09a[_0x796eb2(0x447)](),_0x5ec5e4);}async[_0x4624f5(0x404)](_0xdffe92){const _0x378517=_0x4624f5;var _0x31c659;const _0x37a4c9=this[_0x378517(0x27e)][_0x378517(0x3cd)](_0x378517(0x1cc));if(!_0x37a4c9||!_0xdffe92[_0x378517(0x481)](_0x37a4c9)){const _0x1644ee=_0xdffe92['getUnhiddenWorksheets']()[0x0],_0x4a08c1=_0xdffe92[_0x378517(0x481)](_0x1644ee);if(!_0x4a08c1)return;this['_updateURLWithCurrentState'](_0x4a08c1,!0x0),await this[_0x378517(0x43a)][_0x378517(0x225)](_0xc6f6be['SetWorksheetActivateCommand']['id'],{'unitId':_0xdffe92['getUnitId'](),'subUnitId':_0x1644ee});return;}((_0x31c659=_0xdffe92['getActiveSheet']())==null?void 0x0:_0x31c659[_0x378517(0x447)]())!==_0x37a4c9&&await this['_commandService'][_0x378517(0x225)](_0xc6f6be[_0x378517(0x244)]['id'],{'unitId':_0xdffe92[_0x378517(0x30b)](),'subUnitId':_0x37a4c9});}},_0x46875a[_0x4624f5(0x25f)]=_0x318a87([_0x158e8b(0x0,_0x5a3a5f),_0x158e8b(0x1,_0x161ac6[_0x4624f5(0x210)]),_0x158e8b(0x2,_0x161ac6[_0x4624f5(0x41a)]),_0x158e8b(0x3,_0x161ac6['Inject'](_0x46104e[_0x4624f5(0x1fa)])),_0x158e8b(0x4,_0x161ac6[_0x4624f5(0x41f)](_0xbc9216[_0x4624f5(0x3a9)]))],_0x46875a[_0x4624f5(0x25f)]);var _0x582e4f=Object[_0x4624f5(0x272)],_0x4e6c57=(_0x40201a,_0x58ab84,_0x4acd1b,_0x8b88a5)=>{const _0x5a8eb5=_0x4624f5;for(var _0x5e28af=_0x8b88a5>0x1?void 0x0:_0x8b88a5?_0x582e4f(_0x58ab84,_0x4acd1b):_0x58ab84,_0x3a69cc=_0x40201a[_0x5a8eb5(0x1e5)]-0x1,_0x467cb9;_0x3a69cc>=0x0;_0x3a69cc--)(_0x467cb9=_0x40201a[_0x3a69cc])&&(_0x5e28af=_0x467cb9(_0x5e28af)||_0x5e28af);return _0x5e28af;},_0x47b507=(_0x26b1e4,_0x1a2ce8)=>(_0x25af79,_0xc18dbc)=>_0x1a2ce8(_0x25af79,_0xc18dbc,_0x26b1e4);let _0x665a7a=class extends _0x161ac6[_0x4624f5(0x240)]{constructor(_0x536590,_0x15159f){const _0x59c500=_0x4624f5;super(),this[_0x59c500(0x1fe)]=_0x536590,this['_imageIoService']=_0x15159f,this[_0x59c500(0x48d)]();}[_0x4624f5(0x48d)](){const _0x1ba81c=_0x4624f5,_0x4d231d=this;this[_0x1ba81c(0x30f)](this['_docClipboardService'][_0x1ba81c(0x378)]({'onBeforePasteImage':async _0x21584e=>{const _0x3ad2c4=_0x1ba81c,_0x4e9323=await _0x4d231d[_0x3ad2c4(0x424)][_0x3ad2c4(0x29f)](_0x21584e);return _0x4e9323?{'source':_0x4e9323[_0x3ad2c4(0x309)],'imageSourceType':_0x4e9323[_0x3ad2c4(0x356)]}:null;}}));}};_0x665a7a=_0x4e6c57([_0x47b507(0x0,_0x5d4e8b[_0x4624f5(0x26f)]),_0x47b507(0x1,_0x275a1a[_0x4624f5(0x1d5)])],_0x665a7a);const _0x167276=[_0x4624f5(0x1f8),_0x4624f5(0x238),_0x4624f5(0x3a0),_0x4624f5(0x2cc),'blue.400','yellow.400'];class _0x1846fc extends _0x161ac6[_0x4624f5(0x482)]{constructor(){const _0xa1d2e1=_0x4624f5;super(...arguments),_0x47bfcc(this,_0xa1d2e1(0x27a),new Map()),_0x47bfcc(this,_0xa1d2e1(0x260),0x0);}['assignAColorForMemberID'](_0x2c819c){const _0x5e9a02=_0x4624f5;if(this[_0x5e9a02(0x27a)]['has'](_0x2c819c))return this['_assignedColors'][_0x5e9a02(0x333)](_0x2c819c);const _0x38e613=_0x167276[this[_0x5e9a02(0x260)]];return this[_0x5e9a02(0x260)]=(this[_0x5e9a02(0x260)]+0x1)%_0x167276[_0x5e9a02(0x1e5)],this[_0x5e9a02(0x27a)][_0x5e9a02(0x3d5)](_0x2c819c,_0x38e613),_0x38e613;}}function _0xa63dd7(_0x54eb37){const _0x3d6c59=_0x4624f5;let _0x15b4cb='';for(const _0x10cc92 of _0x54eb37){const {startOffset:_0x2da0a1,endOffset:_0x331b9a,isActive:_0x2014af,rangeType:_0x5809ba,segmentId:_0x130c72,segmentPage:_0xb890be}=_0x10cc92;_0x15b4cb[_0x3d6c59(0x1e5)]&&(_0x15b4cb+=','),_0x15b4cb+=_0x2da0a1+':'+_0x331b9a+':'+(_0x2014af?'1':'0')+':'+_0x5809ba+':'+_0x130c72+':'+_0xb890be;}return _0x15b4cb;}function _0x7e2e27(_0x23bae7){const _0x5ce0f0=_0x4624f5,_0x23ec43=_0x23bae7[_0x5ce0f0(0x44a)](','),_0x588347=[];for(const _0x313416 of _0x23ec43){const [_0x599993,_0x176852,_0x1d9c78,_0x4cf3b1,_0x5bb60d,_0x166929]=_0x313416[_0x5ce0f0(0x44a)](':');_0x588347[_0x5ce0f0(0x426)]({'startOffset':Number(_0x599993),'endOffset':Number(_0x176852),'collapsed':_0x599993===_0x176852,'isActive':_0x1d9c78==='1','rangeType':_0x4cf3b1===_0x161ac6[_0x5ce0f0(0x29b)][_0x5ce0f0(0x2d1)]?_0x161ac6[_0x5ce0f0(0x29b)][_0x5ce0f0(0x2d1)]:_0x161ac6[_0x5ce0f0(0x29b)][_0x5ce0f0(0x475)],'segmentId':typeof _0x5bb60d==_0x5ce0f0(0x306)?String(_0x5bb60d):'','segmentPage':Number(_0x166929!=null?_0x166929:-0x1)});}return _0x588347['some'](_0x1d27ed=>_0x1d27ed[_0x5ce0f0(0x37e)])||(_0x588347[0x0][_0x5ce0f0(0x37e)]=!0x0),_0x588347;}class _0x360498 extends _0x161ac6[_0x4624f5(0x240)]{constructor(){const _0x434d28=_0x4624f5;super(...arguments),_0x47bfcc(this,_0x434d28(0x3b8),new _0x66cc31[(_0x434d28(0x41e))](null)),_0x47bfcc(this,'collabCursorState$',this['_collabCursorState$'][_0x434d28(0x215)]());}[_0x4624f5(0x26c)](_0x1aa26e){const _0x5ad895=_0x4624f5,{unitID:_0x5f19ae,memberID:_0x21d109,textRanges:_0x3c6c3d}=_0x1aa26e,_0x207765=_0xa63dd7(_0x3c6c3d);if(_0x207765==='')return;const _0x48d573={'unitID':_0x5f19ae,'memberID':_0x21d109,'selection':_0x207765};this['_collabCursorState$'][_0x5ad895(0x3c9)](_0x48d573);}}var _0x47ce8f=Object[_0x4624f5(0x272)],_0x55c00a=(_0x25934b,_0x3d3967,_0x152ff7,_0x464338)=>{for(var _0x10933f=_0x464338>0x1?void 0x0:_0x464338?_0x47ce8f(_0x3d3967,_0x152ff7):_0x3d3967,_0x262a38=_0x25934b['length']-0x1,_0x249a21;_0x262a38>=0x0;_0x262a38--)(_0x249a21=_0x25934b[_0x262a38])&&(_0x10933f=_0x249a21(_0x10933f)||_0x10933f);return _0x10933f;},_0x25c269=(_0x5bdaae,_0x2a5e8e)=>(_0x531365,_0x59ba94)=>_0x2a5e8e(_0x531365,_0x59ba94,_0x5bdaae);const _0x28488e=0x12c,_0x406130=0x64;let _0x2262fb=class extends _0x161ac6[_0x4624f5(0x240)]{constructor(_0x6ce01f,_0x14a533,_0x443724,_0x530c72,_0x13bbeb,_0x4ef41e,_0x487800,_0x285957,_0x3da708){const _0xb95fd4=_0x4624f5;super(),_0x47bfcc(this,_0xb95fd4(0x27f),!0x1),_0x47bfcc(this,_0xb95fd4(0x48d),!0x1),_0x47bfcc(this,_0xb95fd4(0x218),new _0x66cc31['BehaviorSubject'](new Map())),_0x47bfcc(this,_0xb95fd4(0x3ed),this[_0xb95fd4(0x218)][_0xb95fd4(0x215)]()),_0x47bfcc(this,_0xb95fd4(0x3a8),new _0x66cc31[(_0xb95fd4(0x41e))]([])),_0x47bfcc(this,'roomMembers$',this[_0xb95fd4(0x3a8)][_0xb95fd4(0x1ef)](_0x66cc31[_0xb95fd4(0x405)](_0x28488e))),_0x47bfcc(this,_0xb95fd4(0x2c5),_0x161ac6[_0xb95fd4(0x3e4)](_0x5742d7=>{const _0x5083b6=_0xb95fd4,_0x5328ac={'eventID':_0x48fdef[_0x5083b6(0x3b2)][_0x5083b6(0x261)],'data':{'unitID':this[_0x5083b6(0x2e9)],'memberID':this[_0x5083b6(0x344)][_0x5083b6(0x3d2)](),'selection':_0xa63dd7(_0x5742d7)}};this[_0x5083b6(0x344)]['send'](_0x5328ac,this[_0x5083b6(0x2e9)]);},_0x406130)),(this['unitID']=_0x6ce01f,this['_session']=_0x14a533,this[_0xb95fd4(0x298)]=_0x443724,this['_colorAssignService']=_0x530c72,this[_0xb95fd4(0x23a)]=_0x13bbeb,this[_0xb95fd4(0x3f5)]=_0x4ef41e,this['_transformService']=_0x487800,this[_0xb95fd4(0x485)]=_0x285957,this[_0xb95fd4(0x43a)]=_0x3da708);}get[_0x4624f5(0x20c)](){const _0x4d5ad3=_0x4624f5;return this[_0x4d5ad3(0x218)][_0x4d5ad3(0x3dc)]();}get[_0x4624f5(0x2fe)](){const _0x3d3584=_0x4624f5;return this[_0x3d3584(0x3a8)][_0x3d3584(0x3dc)]();}['dispose'](){const _0x189164=_0x4624f5;super['dispose'](),this[_0x189164(0x218)]['next'](new Map()),this['_cursorInfo$'][_0x189164(0x487)](),this[_0x189164(0x3a8)][_0x189164(0x3c9)]([]),this[_0x189164(0x3a8)]['complete']();}[_0x4624f5(0x2b2)](){const _0x31dd4e=_0x4624f5;this[_0x31dd4e(0x48d)]||(this['_init']=!0x0,this[_0x31dd4e(0x344)][_0x31dd4e(0x221)][_0x31dd4e(0x1ef)](_0x66cc31[_0x31dd4e(0x45d)](this[_0x31dd4e(0x289)]))[_0x31dd4e(0x26b)](_0x7066ae=>{const _0x35694e=_0x31dd4e;_0x7066ae===_0x46104e[_0x35694e(0x290)][_0x35694e(0x428)]?this['_toggleOnline']():this[_0x35694e(0x1dd)]();}),this[_0x31dd4e(0x344)][_0x31dd4e(0x3fa)][_0x31dd4e(0x1ef)](_0x66cc31[_0x31dd4e(0x45d)](this[_0x31dd4e(0x289)]))[_0x31dd4e(0x26b)](_0x8f5b3=>{const _0x11b227=_0x31dd4e,_0x152bbe=_0x8f5b3['eventID'];_0x152bbe===_0x48fdef[_0x11b227(0x3b2)][_0x11b227(0x261)]&&this[_0x11b227(0x315)](_0x8f5b3),_0x152bbe===_0x48fdef[_0x11b227(0x3b2)][_0x11b227(0x217)]&&this['_onCursorDelete'](_0x8f5b3);}),this['disposeWithMe'](this[_0x31dd4e(0x43a)][_0x31dd4e(0x391)](_0x185c27=>{const _0x5d4e38=_0x31dd4e,_0x181f30=_0x185c27['params'];_0x181f30!=null&&this['_online']&&_0x185c27['id']===_0x4db13e[_0x5d4e38(0x1d7)]['id']&&_0x181f30[_0x5d4e38(0x470)]===this['unitID']&&_0x181f30[_0x5d4e38(0x281)]===!0x1&&_0x181f30[_0x5d4e38(0x1e9)][_0x5d4e38(0x1e5)]>0x0&&this[_0x5d4e38(0x2c5)](_0x181f30[_0x5d4e38(0x1e9)]);})),this['_syncEditingCollabCursorService'][_0x31dd4e(0x422)][_0x31dd4e(0x1ef)](_0x66cc31[_0x31dd4e(0x45d)](this[_0x31dd4e(0x289)]))['subscribe'](_0x2f054a=>{const _0x5b3369=_0x31dd4e;if((_0x2f054a==null?void 0x0:_0x2f054a[_0x5b3369(0x2e9)])!==this['unitID'])return;const _0x465b9f={'eventID':_0x48fdef['CollaborationEvent']['UPDATE_CURSOR'],'data':_0x2f054a};this[_0x5b3369(0x315)](_0x465b9f);}),this['disposeWithMe'](this[_0x31dd4e(0x43a)]['onCommandExecuted'](_0x5eeada=>{const _0x22e80b=_0x31dd4e;if(_0x5eeada['params']==null)return;const _0x395393=_0x5eeada[_0x22e80b(0x276)];if(_0x5eeada['id']!==_0x4db13e['RichTextEditingMutation']['id']||_0x395393[_0x22e80b(0x470)]!==this[_0x22e80b(0x2e9)])return;const _0x39a862={'id':_0x22e80b(0x25b),'params':_0x395393},_0x253af1=this[_0x22e80b(0x20c)];for(const [_0x1c58ed,_0x5a66d8]of _0x253af1){const _0x4ba3c5={'id':_0x22e80b(0x25b),'params':{'unitId':this[_0x22e80b(0x2e9)],'actions':null,'textRanges':_0x5a66d8[_0x22e80b(0x1e9)]}},_0x59a6af=this[_0x22e80b(0x27c)][_0x22e80b(0x3d7)](_0x39a862,_0x4ba3c5,!0x1);if(_0x48fdef['isTransformMutationFailure'](_0x59a6af))throw _0x59a6af[_0x22e80b(0x3ff)];_0x253af1[_0x22e80b(0x3d5)](_0x1c58ed,{..._0x5a66d8,'ranges':_0x59a6af[_0x22e80b(0x397)][_0x22e80b(0x276)][_0x22e80b(0x3c5)]});}queueMicrotask(()=>{const _0x4829f9=_0x22e80b;this[_0x4829f9(0x218)][_0x4829f9(0x3c9)](_0x253af1);});})));}[_0x4624f5(0x315)](_0x51f33b){const _0x34210e=_0x4624f5;var _0x4b6137,_0x9105e1;const {memberID:_0x3886f5,selection:_0x5744db}=_0x51f33b['data'],_0x1969ab=_0x7e2e27(_0x5744db),_0xc5a33d=(_0x9105e1=(_0x4b6137=this[_0x34210e(0x23a)]['getMember'](this[_0x34210e(0x2e9)],_0x3886f5))==null?void 0x0:_0x4b6137[_0x34210e(0x433)])!=null?_0x9105e1:_0x34210e(0x463),_0x2b9790={'color':this[_0x34210e(0x274)][_0x34210e(0x2ba)](_0x3886f5),'name':_0xc5a33d,'ranges':_0x1969ab},_0x8a8f85=this['cursorInfo'];_0x8a8f85[_0x34210e(0x3d5)](_0x3886f5,_0x2b9790),this[_0x34210e(0x218)][_0x34210e(0x3c9)](_0x8a8f85);}[_0x4624f5(0x2de)](_0x5cbfb2){const _0x45ca51=_0x4624f5,{memberID:_0x37970f}=_0x5cbfb2['data'],_0xe406b8=this[_0x45ca51(0x20c)];_0xe406b8[_0x45ca51(0x40e)](_0x37970f),this[_0x45ca51(0x218)][_0x45ca51(0x3c9)](_0xe406b8);}[_0x4624f5(0x24d)](){const _0x12c179=_0x4624f5;var _0x4a4fd8;if(this['_online']=!0x0,((_0x4a4fd8=this[_0x12c179(0x485)][_0x12c179(0x45a)]())==null?void 0x0:_0x4a4fd8[_0x12c179(0x30b)]())!==this[_0x12c179(0x2e9)])return;const _0x174f0e=this[_0x12c179(0x298)][_0x12c179(0x333)](_0x4db13e[_0x12c179(0x3c7)])[_0x12c179(0x2ae)]();Array[_0x12c179(0x462)](_0x174f0e)&&_0x174f0e[_0x12c179(0x1e5)]>0x0&&this[_0x12c179(0x2c5)](_0x174f0e);}['_toggleOffline'](){const _0x62379=_0x4624f5;this[_0x62379(0x27f)]=!0x1;}};_0x2262fb=_0x55c00a([_0x25c269(0x2,_0x161ac6[_0x4624f5(0x2b0)](_0x161ac6[_0x4624f5(0x2c2)])),_0x25c269(0x3,_0x161ac6[_0x4624f5(0x2b0)](_0x1846fc)),_0x25c269(0x4,_0x161ac6['Inject'](_0x46104e[_0x4624f5(0x222)])),_0x25c269(0x5,_0x161ac6[_0x4624f5(0x2b0)](_0x360498)),_0x25c269(0x6,_0x48fdef['ITransformService']),_0x25c269(0x7,_0x161ac6[_0x4624f5(0x37d)]),_0x25c269(0x8,_0x161ac6[_0x4624f5(0x41a)])],_0x2262fb);var _0x2278be=Object[_0x4624f5(0x272)],_0x11a7d9=(_0x370f85,_0x43d9f3,_0x399957,_0x2db51c)=>{for(var _0x2b32cb=_0x2db51c>0x1?void 0x0:_0x2db51c?_0x2278be(_0x43d9f3,_0x399957):_0x43d9f3,_0x4b13aa=_0x370f85['length']-0x1,_0x190f73;_0x4b13aa>=0x0;_0x4b13aa--)(_0x190f73=_0x370f85[_0x4b13aa])&&(_0x2b32cb=_0x190f73(_0x2b32cb)||_0x2b32cb);return _0x2b32cb;},_0x5ea10f=(_0x5ac5ff,_0x545fda)=>(_0x571717,_0x171529)=>_0x545fda(_0x571717,_0x171529,_0x5ac5ff);const _0x15a2ba=0x12c,_0x2c182a=0x64,_0x1cd72c=()=>{let _0x1e0796=[],_0x385d17=!0x1;return _0x166c55=>{_0x1e0796['push'](_0x166c55),_0x385d17||(_0x385d17=!0x0,setTimeout(()=>{_0x1e0796['forEach'](_0x40d488=>_0x40d488()),_0x1e0796=[],_0x385d17=!0x1;}));};};let _0x285ce1=class extends _0x161ac6[_0x4624f5(0x240)]{constructor(_0x156e92,_0x800dea,_0x52de8c,_0x2a37f0,_0x13e197,_0x95fdaa,_0x41dcde,_0x44f945){const _0x333339=_0x4624f5;super(),_0x47bfcc(this,_0x333339(0x27f),!0x1),_0x47bfcc(this,'_init',!0x1),_0x47bfcc(this,_0x333339(0x218),new _0x66cc31['BehaviorSubject'](new Map())),_0x47bfcc(this,_0x333339(0x3ed),this[_0x333339(0x218)]['asObservable']()),_0x47bfcc(this,'_roomMembers$',new _0x66cc31[(_0x333339(0x41e))]([])),_0x47bfcc(this,_0x333339(0x479),this[_0x333339(0x3a8)]['pipe'](_0x66cc31[_0x333339(0x405)](_0x15a2ba))),_0x47bfcc(this,_0x333339(0x2c5),_0x161ac6[_0x333339(0x3e4)]((_0x1fc79,_0x2b6c61)=>{const _0x459161=_0x333339,_0x1d7f0c={'eventID':_0x48fdef['CollaborationEvent'][_0x459161(0x261)],'data':{'unitID':this[_0x459161(0x2e9)],'memberID':this[_0x459161(0x344)][_0x459161(0x3d2)](),'selection':_0x50020c[_0x459161(0x45c)](_0x1fc79,_0x2b6c61[_0x459161(0x3d1)])}};this[_0x459161(0x344)][_0x459161(0x418)](_0x1d7f0c,this[_0x459161(0x2e9)]);},_0x2c182a)),(this[_0x333339(0x2e9)]=_0x156e92,this[_0x333339(0x344)]=_0x800dea,this[_0x333339(0x298)]=_0x52de8c,this[_0x333339(0x274)]=_0x2a37f0,this[_0x333339(0x23a)]=_0x13e197,this[_0x333339(0x485)]=_0x95fdaa,this[_0x333339(0x43a)]=_0x41dcde,this['_refRangeService']=_0x44f945);}get[_0x4624f5(0x20c)](){const _0x314306=_0x4624f5;return this[_0x314306(0x218)]['getValue']();}get[_0x4624f5(0x2fe)](){const _0x2406a4=_0x4624f5;return this[_0x2406a4(0x3a8)][_0x2406a4(0x3dc)]();}[_0x4624f5(0x214)](){const _0x1be0bb=_0x4624f5;super[_0x1be0bb(0x214)](),this[_0x1be0bb(0x218)][_0x1be0bb(0x3c9)](new Map()),this[_0x1be0bb(0x218)]['complete'](),this[_0x1be0bb(0x3a8)][_0x1be0bb(0x3c9)]([]),this[_0x1be0bb(0x3a8)][_0x1be0bb(0x487)]();}[_0x4624f5(0x2b2)](){const _0x3d8ed2=_0x4624f5;this[_0x3d8ed2(0x48d)]||(this[_0x3d8ed2(0x48d)]=!0x0,this[_0x3d8ed2(0x344)][_0x3d8ed2(0x221)][_0x3d8ed2(0x1ef)](_0x66cc31[_0x3d8ed2(0x45d)](this[_0x3d8ed2(0x289)]))[_0x3d8ed2(0x26b)](_0x33c10c=>{const _0x33e309=_0x3d8ed2;_0x33c10c===_0x46104e[_0x33e309(0x290)][_0x33e309(0x428)]?this[_0x33e309(0x24d)]():this[_0x33e309(0x1dd)]();}),this[_0x3d8ed2(0x344)][_0x3d8ed2(0x3fa)][_0x3d8ed2(0x1ef)](_0x66cc31[_0x3d8ed2(0x45d)](this[_0x3d8ed2(0x289)]))[_0x3d8ed2(0x26b)](_0x550a36=>{const _0x3a6cf0=_0x3d8ed2,_0x4bd5b2=_0x550a36[_0x3a6cf0(0x327)];_0x4bd5b2===_0x48fdef['CollaborationEvent']['UPDATE_CURSOR']&&this[_0x3a6cf0(0x315)](_0x550a36),_0x4bd5b2===_0x48fdef[_0x3a6cf0(0x3b2)][_0x3a6cf0(0x217)]&&this[_0x3a6cf0(0x2de)](_0x550a36);}),this[_0x3d8ed2(0x1cd)](),this['disposeWithMe'](this[_0x3d8ed2(0x43a)]['onCommandExecuted'](_0x3c4335=>{const _0x58811f=_0x3d8ed2;if(this['_online']&&_0x3c4335['id']===_0xc6f6be[_0x58811f(0x278)]['id']&&_0x3c4335[_0x58811f(0x276)][_0x58811f(0x470)]===this['unitID']){const _0x2c6244=_0x3c4335[_0x58811f(0x276)];this[_0x58811f(0x2c5)](_0x2c6244[_0x58811f(0x41b)],_0x2c6244[_0x58811f(0x209)][0x0]);}})));}['_onCursorUpdate'](_0x37f342){const _0x2f6360=_0x4624f5;var _0x1dff97,_0x703710;const {memberID:_0x266ef1,selection:_0xbc74a4}=_0x37f342[_0x2f6360(0x345)],{sheetName:_0x549446,range:_0x55b03}=_0x50020c[_0x2f6360(0x269)](_0xbc74a4),_0xae412b={'name':(_0x703710=(_0x1dff97=this[_0x2f6360(0x23a)]['getMember'](this[_0x2f6360(0x2e9)],_0x266ef1))==null?void 0x0:_0x1dff97[_0x2f6360(0x433)])!=null?_0x703710:_0x2f6360(0x463),'range':this[_0x2f6360(0x412)](_0x549446,_0x55b03),'sheetID':_0x549446,'color':this[_0x2f6360(0x274)][_0x2f6360(0x2ba)](_0x266ef1),'selection':_0xbc74a4},_0x10caaf=this[_0x2f6360(0x20c)];_0x10caaf[_0x2f6360(0x3d5)](_0x266ef1,_0xae412b),this['_cursorInfo$'][_0x2f6360(0x3c9)](_0x10caaf);}[_0x4624f5(0x2de)](_0x40b3f8){const _0x42e950=_0x4624f5,{memberID:_0x557ea0}=_0x40b3f8['data'],_0x2c76e1=this[_0x42e950(0x20c)];_0x2c76e1[_0x42e950(0x40e)](_0x557ea0),this['_cursorInfo$']['next'](_0x2c76e1);}[_0x4624f5(0x412)](_0x3768fe,_0x4e5d35){const _0x53a174=_0x4624f5;var _0x452567,_0x2c11a2;const _0x4cf103=(_0x2c11a2=(_0x452567=this[_0x53a174(0x485)]['getUniverSheetInstance'](this[_0x53a174(0x2e9)]))==null?void 0x0:_0x452567[_0x53a174(0x481)](_0x3768fe))==null?void 0x0:_0x2c11a2['getMergeData']();return(_0x4cf103==null?void 0x0:_0x4cf103[_0x53a174(0x1d8)](_0x57bce5=>_0x161ac6['Rectangle']['contains'](_0x57bce5,_0x4e5d35)))||_0x4e5d35;}['_onRefRangeChange'](){const _0x9d8619=_0x4624f5,_0x5670a3=new _0x161ac6[(_0x9d8619(0x46a))](),_0x8f853=_0x1cd72c(),_0x1b6564=()=>{const _0x4496ea=_0x9d8619;_0x5670a3[_0x4496ea(0x214)]();const _0x4845c9=(_0x4e5d48,_0x444cb4,_0x34756d,_0x3361f5)=>{const _0x3f344f=_0x4496ea;let _0x44fae0=[];switch(_0x4e5d48['id']){case _0xc6f6be['EffectRefRangId']['DeleteRangeMoveLeftCommandId']:{_0x44fae0=_0xc6f6be[_0x3f344f(0x22b)](_0x4e5d48,_0x3361f5);break;}case _0xc6f6be[_0x3f344f(0x361)][_0x3f344f(0x20a)]:{_0x44fae0=_0xc6f6be[_0x3f344f(0x430)](_0x4e5d48,_0x3361f5);break;}case _0xc6f6be[_0x3f344f(0x361)]['InsertColCommandId']:{_0x44fae0=_0xc6f6be[_0x3f344f(0x24e)](_0x4e5d48,_0x3361f5);break;}case _0xc6f6be[_0x3f344f(0x361)][_0x3f344f(0x279)]:{_0x44fae0=_0xc6f6be[_0x3f344f(0x379)](_0x4e5d48,_0x3361f5);break;}case _0xc6f6be[_0x3f344f(0x361)][_0x3f344f(0x29d)]:{_0x44fae0=_0xc6f6be['handleInsertRangeMoveRight'](_0x4e5d48,_0x3361f5);break;}case _0xc6f6be['EffectRefRangId'][_0x3f344f(0x37f)]:{_0x44fae0=_0xc6f6be[_0x3f344f(0x420)](_0x4e5d48,_0x3361f5);break;}case _0xc6f6be[_0x3f344f(0x361)][_0x3f344f(0x34f)]:{_0x44fae0=_0xc6f6be['handleMoveRange'](_0x4e5d48,_0x3361f5);break;}case _0xc6f6be[_0x3f344f(0x361)][_0x3f344f(0x30c)]:{_0x44fae0=_0xc6f6be[_0x3f344f(0x31d)](_0x4e5d48,_0x3361f5);break;}case _0xc6f6be[_0x3f344f(0x361)][_0x3f344f(0x26e)]:{_0x44fae0=_0xc6f6be[_0x3f344f(0x33a)](_0x4e5d48,_0x3361f5);break;}}const _0x3e40aa=_0xc6f6be[_0x3f344f(0x335)](_0x44fae0,_0x3361f5),_0x1b410a=this['cursorInfo'][_0x3f344f(0x333)](_0x444cb4);if(_0x1b410a&&_0x3e40aa){const _0x25673e={..._0x1b410a,'range':_0x3e40aa};this[_0x3f344f(0x20c)]['set'](_0x444cb4,_0x25673e),_0x8f853(()=>{const _0x511fd4=_0x3f344f,_0x2392dc=this[_0x511fd4(0x216)][_0x511fd4(0x255)](_0x3e40aa,_0x19572d=>(_0x2392dc['dispose'](),_0x4845c9(_0x19572d,_0x444cb4,_0x34756d,_0x3e40aa)));_0x5670a3[_0x511fd4(0x455)](_0x2392dc);});}return{'redos':[],'undos':[]};};this['cursorInfo'][_0x4496ea(0x265)]((_0x269efa,_0x3f0b07)=>{const _0x2ad6c5=_0x4496ea,{range:_0x44d0af,sheetID:_0x49fc84}=_0x269efa,_0x54a8e7=this[_0x2ad6c5(0x216)][_0x2ad6c5(0x255)](_0x44d0af,_0x11a34c=>(_0x54a8e7[_0x2ad6c5(0x214)](),_0x4845c9(_0x11a34c,_0x3f0b07,_0x49fc84,_0x44d0af)));_0x5670a3[_0x2ad6c5(0x455)](_0x54a8e7);});};this[_0x9d8619(0x30f)](_0x161ac6['toDisposable'](this[_0x9d8619(0x218)][_0x9d8619(0x26b)](()=>{_0x1b6564();})));}[_0x4624f5(0x24d)](){const _0x1f7c78=_0x4624f5;var _0x3fe35f,_0x1c2079;if(this['_online']=!0x0,((_0x3fe35f=this[_0x1f7c78(0x485)][_0x1f7c78(0x45a)]())==null?void 0x0:_0x3fe35f[_0x1f7c78(0x30b)]())!==this[_0x1f7c78(0x2e9)])return;const _0x23eb5c=(_0x1c2079=this['_injector'][_0x1f7c78(0x333)](_0xc6f6be['SheetsSelectionsService'])[_0x1f7c78(0x491)]())==null?void 0x0:_0x1c2079[0x0],_0x399dfa=this[_0x1f7c78(0x485)][_0x1f7c78(0x2bc)](_0x161ac6[_0x1f7c78(0x2d9)][_0x1f7c78(0x28b)])[_0x1f7c78(0x203)]();_0x23eb5c&&_0x399dfa&&this[_0x1f7c78(0x2c5)](_0x399dfa[_0x1f7c78(0x447)](),_0x23eb5c);}[_0x4624f5(0x1dd)](){const _0x1b72fc=_0x4624f5;this[_0x1b72fc(0x27f)]=!0x1;}};_0x285ce1=_0x11a7d9([_0x5ea10f(0x2,_0x161ac6[_0x4624f5(0x2b0)](_0x161ac6[_0x4624f5(0x2c2)])),_0x5ea10f(0x3,_0x161ac6[_0x4624f5(0x2b0)](_0x1846fc)),_0x5ea10f(0x4,_0x161ac6[_0x4624f5(0x2b0)](_0x46104e[_0x4624f5(0x222)])),_0x5ea10f(0x5,_0x161ac6['IUniverInstanceService']),_0x5ea10f(0x6,_0x161ac6[_0x4624f5(0x41a)]),_0x5ea10f(0x7,_0x161ac6['Inject'](_0xc6f6be[_0x4624f5(0x372)]))],_0x285ce1);var _0xfa0237=Object[_0x4624f5(0x272)],_0x33189d=(_0x131046,_0x50b1ad,_0x3c96a2,_0x492368)=>{for(var _0x802f16=_0x492368>0x1?void 0x0:_0x492368?_0xfa0237(_0x50b1ad,_0x3c96a2):_0x50b1ad,_0x2f5fd4=_0x131046['length']-0x1,_0x47ad8e;_0x2f5fd4>=0x0;_0x2f5fd4--)(_0x47ad8e=_0x131046[_0x2f5fd4])&&(_0x802f16=_0x47ad8e(_0x802f16)||_0x802f16);return _0x802f16;},_0x60fcfe=(_0x59dede,_0x1a2503)=>(_0x38ab0f,_0x52ddff)=>_0x1a2503(_0x38ab0f,_0x52ddff,_0x59dede);let _0x1508be=class extends _0x161ac6[_0x4624f5(0x240)]{constructor(_0x18b50f,_0xece82a,_0x324dc9){const _0x9d4787=_0x4624f5;super(),_0x47bfcc(this,_0x9d4787(0x3e2),new Map()),_0x47bfcc(this,_0x9d4787(0x29c),new _0x66cc31[(_0x9d4787(0x434))]()),(this['_univerInstanceService']=_0x18b50f,this[_0x9d4787(0x298)]=_0xece82a,this[_0x9d4787(0x264)]=_0x324dc9,this['_init']());}[_0x4624f5(0x214)](){const _0x326559=_0x4624f5;super[_0x326559(0x214)](),this[_0x326559(0x29c)]['complete'](),this['_entities']['forEach'](_0x5f07a4=>_0x5f07a4[_0x326559(0x214)]());}['getCollabCursors$'](_0xf5de5d){const _0x25b689=_0x4624f5;return this['_entities'][_0x25b689(0x390)](_0xf5de5d)?this[_0x25b689(0x3e2)][_0x25b689(0x333)](_0xf5de5d)[_0x25b689(0x3ed)]:this[_0x25b689(0x29c)][_0x25b689(0x1ef)](_0x66cc31[_0x25b689(0x438)](_0x2c3244=>_0x2c3244['unitID']===_0xf5de5d),_0x66cc31[_0x25b689(0x46f)](_0x5c1fcc=>_0x5c1fcc[_0x25b689(0x3ed)]));}[_0x4624f5(0x48d)](){const _0x2ced5f=_0x4624f5;this[_0x2ced5f(0x485)][_0x2ced5f(0x3b5)](_0x161ac6['UniverInstanceType'][_0x2ced5f(0x28b)])[_0x2ced5f(0x1ef)](_0x66cc31['takeUntil'](this[_0x2ced5f(0x289)]))[_0x2ced5f(0x26b)](async _0x473be6=>{const _0x3bfbfc=_0x2ced5f,_0x4dc573=_0x473be6['getUnitId'](),_0x5a1fe7=await this[_0x3bfbfc(0x351)](_0x4dc573);this[_0x3bfbfc(0x29c)][_0x3bfbfc(0x3c9)](_0x5a1fe7),this[_0x3bfbfc(0x3e2)]['set'](_0x4dc573,_0x5a1fe7);}),this['_univerInstanceService'][_0x2ced5f(0x3b5)](_0x161ac6[_0x2ced5f(0x2d9)][_0x2ced5f(0x23d)])[_0x2ced5f(0x1ef)](_0x66cc31[_0x2ced5f(0x45d)](this[_0x2ced5f(0x289)]))[_0x2ced5f(0x1ef)](_0x66cc31[_0x2ced5f(0x438)](_0x3df3f=>!_0x3df3f[_0x2ced5f(0x30b)]()[_0x2ced5f(0x25e)]('__')))[_0x2ced5f(0x26b)](async _0x5afa52=>{const _0x288190=_0x2ced5f,_0x42fd5d=_0x5afa52['getUnitId'](),_0x290f79=await this[_0x288190(0x2c7)](_0x42fd5d);this['_entityInit$'][_0x288190(0x3c9)](_0x290f79),this[_0x288190(0x3e2)][_0x288190(0x3d5)](_0x42fd5d,_0x290f79);}),_0x66cc31[_0x2ced5f(0x348)](this[_0x2ced5f(0x485)][_0x2ced5f(0x2f4)](_0x161ac6['UniverInstanceType']['UNIVER_DOC']),this[_0x2ced5f(0x485)][_0x2ced5f(0x2f4)](_0x161ac6[_0x2ced5f(0x2d9)]['UNIVER_SHEET']))[_0x2ced5f(0x1ef)](_0x66cc31['takeUntil'](this[_0x2ced5f(0x289)]))[_0x2ced5f(0x26b)](_0x3f4675=>{const _0x23adc6=_0x2ced5f,_0x3c17ce=_0x3f4675['getUnitId'](),_0xfc078a=this[_0x23adc6(0x3e2)][_0x23adc6(0x333)](_0x3c17ce);_0xfc078a&&(_0xfc078a[_0x23adc6(0x214)](),this[_0x23adc6(0x3e2)][_0x23adc6(0x40e)](_0x3c17ce));});}async[_0x4624f5(0x351)](_0x3eec7e){const _0x588ef0=_0x4624f5,_0x460088=await this['_collabSessionService'][_0x588ef0(0x43b)](_0x3eec7e),_0x418629=this[_0x588ef0(0x298)][_0x588ef0(0x3f2)](_0x285ce1,_0x3eec7e,_0x460088);return _0x418629['init'](),_0x418629;}async['_startDocCollabCursor'](_0x13f518){const _0x1bbf0f=_0x4624f5,_0x501abf=await this['_collabSessionService']['requireSession'](_0x13f518),_0x9a2322=this['_injector'][_0x1bbf0f(0x3f2)](_0x2262fb,_0x13f518,_0x501abf);return _0x9a2322['init'](),_0x9a2322;}};_0x1508be=_0x33189d([_0x60fcfe(0x0,_0x161ac6[_0x4624f5(0x37d)]),_0x60fcfe(0x1,_0x161ac6[_0x4624f5(0x2b0)](_0x161ac6[_0x4624f5(0x2c2)])),_0x60fcfe(0x2,_0x161ac6['Inject'](_0x46104e[_0x4624f5(0x26a)]))],_0x1508be);const _0x5a3e8a=0x14,_0x3574cb=0xc8,_0x319642=0x4,_0x5ad9a7=0x5;function _0xe175e2(_0x2f754e,_0x56fe6d){const _0x19e68f=_0x4624f5;let {radius:_0x116b5d,width:_0x558098,height:_0x9fbc0d}=_0x56fe6d;_0x116b5d=_0x116b5d!=null?_0x116b5d:0x0,_0x558098=_0x558098!=null?_0x558098:0x1e,_0x9fbc0d=_0x9fbc0d!=null?_0x9fbc0d:0x1e;let _0x7423e4=0x0,_0x58bdba=0x0,_0x347f51=0x0;_0x7423e4=_0x58bdba=_0x347f51=Math['min'](_0x116b5d,_0x558098/0x2,_0x9fbc0d/0x2),_0x2f754e['beginPath'](),_0x2f754e['moveTo'](_0x7423e4,0x0),_0x2f754e[_0x19e68f(0x467)](_0x558098-_0x58bdba,0x0),_0x2f754e[_0x19e68f(0x2aa)](_0x558098-_0x58bdba,_0x58bdba,_0x58bdba,Math['PI']*0x3/0x2,0x0,!0x1),_0x2f754e[_0x19e68f(0x467)](_0x558098,_0x9fbc0d-_0x347f51),_0x2f754e[_0x19e68f(0x2aa)](_0x558098-_0x347f51,_0x9fbc0d-_0x347f51,_0x347f51,0x0,Math['PI']/0x2,!0x1),_0x2f754e['lineTo'](0x0,_0x9fbc0d),_0x2f754e['lineTo'](0x0,_0x7423e4),_0x2f754e['arc'](_0x7423e4,_0x7423e4,_0x7423e4,Math['PI'],Math['PI']*0x3/0x2,!0x1),_0x2f754e[_0x19e68f(0x450)](),_0x56fe6d[_0x19e68f(0x201)]&&(_0x2f754e[_0x19e68f(0x37b)](),_0x2f754e[_0x19e68f(0x42c)]=_0x56fe6d[_0x19e68f(0x201)],_0x56fe6d[_0x19e68f(0x457)]==='evenodd'?_0x2f754e[_0x19e68f(0x201)]('evenodd'):_0x2f754e[_0x19e68f(0x201)](),_0x2f754e[_0x19e68f(0x304)]());}class _0x6ab412 extends _0x1fade8[_0x4624f5(0x3d9)]{constructor(_0x4fbca6,_0x343612){const _0x3252bf=_0x4624f5;super(_0x4fbca6,_0x343612),_0x47bfcc(this,'color'),_0x47bfcc(this,_0x3252bf(0x32d)),(this[_0x3252bf(0x2fc)]=_0x343612==null?void 0x0:_0x343612[_0x3252bf(0x2fc)],this[_0x3252bf(0x32d)]=_0x343612==null?void 0x0:_0x343612[_0x3252bf(0x32d)]);}static[_0x4624f5(0x3b4)](_0x18afcb,_0x4edf0c){const _0x1ed160=_0x4624f5,{text:_0x589130,color:_0x34c7dc}=_0x4edf0c;_0x18afcb[_0x1ed160(0x37b)](),_0x18afcb[_0x1ed160(0x371)]=_0x1ed160(0x49b);const _0x265d95=_0x18afcb[_0x1ed160(0x478)](_0x589130)['width'],_0x54ccf8=Math[_0x1ed160(0x38a)](_0x265d95+0x2*_0x319642,_0x3574cb);_0xe175e2(_0x18afcb,{'height':_0x5a3e8a,'radius':0x4,'width':_0x54ccf8,'fill':_0x34c7dc}),_0x18afcb[_0x1ed160(0x42c)]=_0x1ed160(0x213);const _0x349b3a=_0x319642,_0x48e380=_0x5a3e8a-_0x5ad9a7,_0x1a69ce=_0x3574cb-0x2*_0x319642;if(_0x265d95>_0x1a69ce){let _0x42b243='',_0x253b4a=0x0;for(const _0x5cf810 of _0x589130){const _0x8d1159=_0x18afcb[_0x1ed160(0x478)](_0x5cf810)[_0x1ed160(0x230)];if(_0x253b4a+_0x8d1159<=_0x1a69ce-_0x18afcb[_0x1ed160(0x478)](_0x1ed160(0x362))[_0x1ed160(0x230)])_0x42b243+=_0x5cf810,_0x253b4a+=_0x8d1159;else{_0x42b243+=_0x1ed160(0x362);break;}}_0x18afcb['fillText'](_0x42b243,_0x349b3a,_0x48e380);}else _0x18afcb[_0x1ed160(0x3e1)](_0x589130,_0x349b3a,_0x48e380);_0x18afcb[_0x1ed160(0x304)]();}[_0x4624f5(0x249)](_0x2ab829){_0x6ab412['drawWith'](_0x2ab829,this);}}const _0x22ea6a='collab-text-anchor-',_0x7e52ff=_0x4624f5(0x36c),_0x349ac6=_0x4624f5(0x211),_0x21cd66=0x6,_0x1ac3bb=1.5,_0xc9f299=0x4,_0x108bd2=1.5,_0x3faf28=_0x4624f5(0x2f7);class _0x5942d4{constructor(_0x59727b,_0x1e3f12,_0xd7e4bf,_0x3361b2){const _0x2c5481=_0x4624f5;_0x47bfcc(this,'_shapes',[]),_0x47bfcc(this,_0x2c5481(0x454),null),_0x47bfcc(this,_0x2c5481(0x2f6),null),_0x47bfcc(this,'_anchorDot',null),_0x47bfcc(this,_0x2c5481(0x488),null),_0x47bfcc(this,'_eventUnsubscribe',null),(this[_0x2c5481(0x3ea)]=_0x59727b,this[_0x2c5481(0x2f3)]=_0x1e3f12,this[_0x2c5481(0x212)]=_0xd7e4bf,this[_0x2c5481(0x44b)]=_0x3361b2,this[_0x2c5481(0x399)]());}set[_0x4624f5(0x3da)](_0x5825b0){const _0x389e96=_0x4624f5;_0x5825b0?(this[_0x389e96(0x377)]&&this[_0x389e96(0x377)][_0x389e96(0x295)](),this['_textBubble']&&this[_0x389e96(0x2f6)][_0x389e96(0x27d)]()):(this[_0x389e96(0x377)]&&this[_0x389e96(0x377)][_0x389e96(0x27d)](),this[_0x389e96(0x2f6)]&&this[_0x389e96(0x2f6)][_0x389e96(0x295)]());}['dispose'](){const _0xfc06a3=_0x4624f5;for(const _0x283c2a of this[_0xfc06a3(0x387)])_0x283c2a[_0xfc06a3(0x214)]();this[_0xfc06a3(0x2f6)]&&this[_0xfc06a3(0x2f6)][_0xfc06a3(0x214)](),this[_0xfc06a3(0x377)]&&this[_0xfc06a3(0x377)][_0xfc06a3(0x214)](),this['_anchor']&&this[_0xfc06a3(0x454)][_0xfc06a3(0x214)](),this['_eventUnsubscribe']&&this[_0xfc06a3(0x250)]();}[_0x4624f5(0x399)](){const _0xf6a5f3=_0x4624f5;var _0x19c86b;const {_docSkeleton:_0x4cee51,_document:_0x8ff928}=this,{color:_0x19bac8,name:_0x57fd98,ranges:_0x582562}=this[_0xf6a5f3(0x3ea)],_0x4c5856=_0x8ff928[_0xf6a5f3(0x25d)](),{docsLeft:_0x560f25,docsTop:_0x500460}=_0x4c5856,_0x3e7cf5=new _0x5d4e8b[(_0xf6a5f3(0x36b))](_0x4c5856,_0x4cee51);for(const {startOffset:_0x23520e,endOffset:_0x1c1701,rangeType:_0x31ecd1,segmentId:_0x3e237a,segmentPage:_0x543c35,collapsed:_0x1b2d97,isActive:_0x4f22f3}of _0x582562){const _0x3cec7b=_0x4cee51[_0xf6a5f3(0x31b)](_0x23520e,!0x0,_0x3e237a,_0x543c35);let _0x493c4d=_0x4cee51[_0xf6a5f3(0x31b)](_0x1c1701,!0x0,_0x3e237a,_0x543c35);if(_0x493c4d==null&&(_0x493c4d=_0x4cee51[_0xf6a5f3(0x31b)](_0x1c1701-0x1,!0x1,_0x3e237a,_0x543c35)),_0x4f22f3){const {contentBoxPointGroup:_0x5df147}=_0x3e7cf5[_0xf6a5f3(0x38e)](_0x493c4d,_0x493c4d);if(_0x5df147['length']===0x0)continue;this[_0xf6a5f3(0x407)](_0x19bac8,_0x5df147,_0x560f25,_0x500460,_0x57fd98),this[_0xf6a5f3(0x250)]=this[_0xf6a5f3(0x226)]();}if(_0x3cec7b&&_0x493c4d){if(_0x31ecd1===_0x161ac6[_0xf6a5f3(0x29b)][_0xf6a5f3(0x475)]){const _0x501a18=new _0x5d4e8b[(_0xf6a5f3(0x2d0))](_0x4c5856,_0x4cee51),{pointGroup:_0x85b3d5}=(_0x19c86b=_0x501a18[_0xf6a5f3(0x38e)](_0x3cec7b,_0x493c4d))!=null?_0x19c86b:{};if(_0x85b3d5==null||_0x85b3d5[_0xf6a5f3(0x1e5)]===0x0)continue;this[_0xf6a5f3(0x48e)](_0x19bac8,_0x85b3d5,_0x560f25,_0x500460);}else{if(!_0x1b2d97){const {borderBoxPointGroup:_0x7c9f47}=_0x3e7cf5[_0xf6a5f3(0x38e)](_0x3cec7b,_0x493c4d);if(_0x7c9f47[_0xf6a5f3(0x1e5)]===0x0)continue;this[_0xf6a5f3(0x256)](_0x19bac8,_0x7c9f47,_0x560f25,_0x500460);}}}}}['_drawAnchor'](_0x28e112,_0xde7109,_0x4c80c2,_0x40302f,_0x50862d){const _0x4b0133=_0x4624f5,_0x91f582=this[_0x4b0133(0x363)](_0xde7109),{left:_0x2d7d99,top:_0x1e8042,height:_0x33c4dd}=_0x91f582,_0x4e8fe4=this[_0x4b0133(0x328)](),_0x25bcd9=_0x108bd2/_0x4e8fe4,_0x1cd87a=new _0x1fade8['Rect'](_0x22ea6a+_0x161ac6[_0x4b0133(0x497)](_0x21cd66),{'left':_0x2d7d99+_0x4c80c2-_0x25bcd9,'top':_0x1e8042+_0x40302f,'height':_0x33c4dd,'width':_0x1ac3bb,'fill':_0x28e112||_0x1fade8[_0x4b0133(0x293)](_0x161ac6[_0x4b0133(0x406)][_0x4b0133(0x4a2)],0x0),'strokeWidth':_0x25bcd9,'stroke':_0x3faf28,'evented':!0x0});this[_0x4b0133(0x454)]=_0x1cd87a,this['_scene'][_0x4b0133(0x49c)](_0x1cd87a,_0x5d4e8b[_0x4b0133(0x44c)]);const _0x3df983=new _0x1fade8[(_0x4b0133(0x374))](_0x22ea6a+_0x161ac6[_0x4b0133(0x497)](_0x21cd66),{'left':_0x2d7d99+_0x4c80c2-_0x25bcd9,'top':_0x1e8042+_0x40302f-_0xc9f299/0x2,'height':_0xc9f299,'width':_0xc9f299,'fill':_0x28e112||_0x1fade8[_0x4b0133(0x293)](_0x161ac6[_0x4b0133(0x406)][_0x4b0133(0x4a2)],0x0),'strokeWidth':0x0,'stroke':_0x28e112||_0x1fade8[_0x4b0133(0x293)](_0x161ac6['COLORS'][_0x4b0133(0x4a2)],0x0),'evented':!0x1});this['_anchorDot']=_0x3df983,this[_0x4b0133(0x2f3)][_0x4b0133(0x49c)](_0x3df983,_0x5d4e8b['TEXT_RANGE_LAYER_INDEX']);const _0x1f9cf5=new _0x6ab412(_0x22ea6a+_0x161ac6['generateRandomId'](_0x21cd66),{'left':_0x2d7d99+_0x4c80c2-_0x25bcd9,'top':_0x1e8042+_0x40302f-_0x5a3e8a,'text':_0x50862d,'color':_0x28e112});this[_0x4b0133(0x2f6)]=_0x1f9cf5,this['_scene'][_0x4b0133(0x49c)](_0x1f9cf5,_0x5d4e8b[_0x4b0133(0x44c)]),this[_0x4b0133(0x3da)]=!0x1;}[_0x4624f5(0x226)](){const _0x118671=_0x4624f5,_0x575a21=this[_0x118671(0x454)][_0x118671(0x1d3)][_0x118671(0x37c)](()=>{const _0x2c4956=_0x118671;this[_0x2c4956(0x3da)]=!0x0;}),_0x568398=this['_anchor'][_0x118671(0x498)][_0x118671(0x37c)](()=>{const _0x4964fa=_0x118671;this[_0x4964fa(0x488)]&&clearTimeout(this['_hideTimer']),this['_hideTimer']=setTimeout(()=>{const _0x1c8a26=_0x4964fa;this[_0x1c8a26(0x3da)]=!0x1;},0x7d0);});return()=>{const _0x409074=_0x118671;_0x575a21[_0x409074(0x3aa)](),_0x568398['unsubscribe']();};}['_drawTextRange'](_0x3894f6,_0x53eb5c,_0x3b8ce3,_0x5a1dc7){const _0x39ccb7=_0x4624f5,_0x29bafe=new _0x161ac6[(_0x39ccb7(0x2a9))](_0x3894f6)[_0x39ccb7(0x45b)](0.2)[_0x39ccb7(0x466)](),_0x1d4b17=new _0x1fade8['RegularPolygon'](_0x7e52ff+_0x161ac6[_0x39ccb7(0x497)](_0x21cd66),{'pointsGroup':_0x53eb5c,'fill':_0x29bafe||_0x1fade8[_0x39ccb7(0x293)](_0x161ac6['COLORS'][_0x39ccb7(0x4a2)],0.2),'left':_0x3b8ce3,'top':_0x5a1dc7,'evented':!0x1,'debounceParentDirty':!0x1});this[_0x39ccb7(0x387)]['push'](_0x1d4b17),this[_0x39ccb7(0x2f3)][_0x39ccb7(0x49c)](_0x1d4b17,_0x5d4e8b[_0x39ccb7(0x44c)]);}[_0x4624f5(0x48e)](_0x1e041d,_0x4e0162,_0x8a3555,_0x35a54f){const _0xbbeb2b=_0x4624f5,_0x2fb77f=new _0x161ac6[(_0xbbeb2b(0x2a9))](_0x1e041d)[_0xbbeb2b(0x45b)](0.2)[_0xbbeb2b(0x466)](),_0x30a017=new _0x1fade8[(_0xbbeb2b(0x3fe))](_0x349ac6+_0x161ac6['generateRandomId'](_0x21cd66),{'pointsGroup':_0x4e0162,'fill':_0x2fb77f||_0x1fade8[_0xbbeb2b(0x293)](_0x161ac6[_0xbbeb2b(0x406)][_0xbbeb2b(0x4a2)],0.2),'left':_0x8a3555,'top':_0x35a54f,'evented':!0x1,'debounceParentDirty':!0x1});this['_shapes'][_0xbbeb2b(0x426)](_0x30a017),this[_0xbbeb2b(0x2f3)][_0xbbeb2b(0x49c)](_0x30a017,_0x5d4e8b[_0xbbeb2b(0x44c)]);}[_0x4624f5(0x363)](_0x39b9b9){const _0x227915=_0x39b9b9[0x0],_0x4d7eae=_0x227915[0x0],_0x3587df=_0x227915[0x2],{x:_0x2f1ed9,y:_0x4fa667}=_0x4d7eae,{x:_0x15ef27,y:_0x2e7394}=_0x3587df;return{'left':_0x2f1ed9,'top':_0x4fa667,'width':_0x15ef27-_0x2f1ed9,'height':_0x2e7394-_0x4fa667};}[_0x4624f5(0x328)](){const _0x459a10=_0x4624f5,{scaleX:_0x57d601,scaleY:_0x41b8f3}=this[_0x459a10(0x2f3)][_0x459a10(0x1fc)]();return Math[_0x459a10(0x251)](_0x57d601,_0x41b8f3);}}var _0x4a5667=Object[_0x4624f5(0x272)],_0xb1469b=(_0x512f72,_0x3130c1,_0x1296c5,_0x171887)=>{const _0x1d3fce=_0x4624f5;for(var _0x4d22ad=_0x171887>0x1?void 0x0:_0x171887?_0x4a5667(_0x3130c1,_0x1296c5):_0x3130c1,_0x18fd73=_0x512f72[_0x1d3fce(0x1e5)]-0x1,_0x4b61d2;_0x18fd73>=0x0;_0x18fd73--)(_0x4b61d2=_0x512f72[_0x18fd73])&&(_0x4d22ad=_0x4b61d2(_0x4d22ad)||_0x4d22ad);return _0x4d22ad;},_0xf20c48=(_0x547082,_0x1c8e31)=>(_0x2d57c6,_0x59290c)=>_0x1c8e31(_0x2d57c6,_0x59290c,_0x547082);let _0x47d0f4=class extends _0x161ac6[_0x4624f5(0x240)]{constructor(_0x743b12,_0x31eb66,_0x2dee19,_0x298aed,_0x445271){const _0x177637=_0x4624f5;super(),_0x47bfcc(this,_0x177637(0x34b),[]),_0x47bfcc(this,'_cursors',[]),(this[_0x177637(0x38c)]=_0x743b12,this[_0x177637(0x395)]=_0x31eb66,this[_0x177637(0x2c8)]=_0x2dee19,this[_0x177637(0x43a)]=_0x298aed,this[_0x177637(0x3c0)]=_0x445271,this[_0x177637(0x48d)]());}[_0x4624f5(0x48d)](){const _0x3394a9=_0x4624f5,_0x3a307e=this[_0x3394a9(0x38c)][_0x3394a9(0x470)],_0x4597fd=this[_0x3394a9(0x395)];this['disposeWithMe'](_0x66cc31[_0x3394a9(0x2f0)]([this['_collabCursorController']['getCollabCursors$'](_0x3a307e),this[_0x3394a9(0x3c0)][_0x3394a9(0x271)]])[_0x3394a9(0x1ef)](_0x136df2['map'](([_0x3119bd,_0x3cd825])=>({'skeleton':_0x4597fd[_0x3394a9(0x341)](),'cursors':[..._0x3119bd[_0x3394a9(0x42f)]()][_0x3394a9(0x1f5)](_0x4aa686=>({..._0x4aa686,'color':this[_0x3394a9(0x3c0)]['getColorFromTheme'](_0x4aa686[_0x3394a9(0x2fc)])}))})))[_0x3394a9(0x26b)](_0x4fcfe0=>{const _0xee3841=_0x3394a9;if(this[_0xee3841(0x22c)](),_0x4fcfe0){const {skeleton:_0xbb0f9f,cursors:_0x4670a1}=_0x4fcfe0;this[_0xee3841(0x398)](_0xbb0f9f,_0x4670a1);}})),this['_initResize'](),this[_0x3394a9(0x36d)]();}[_0x4624f5(0x398)](_0x29ba06,_0x1fb455){const _0x34e260=_0x4624f5,{scene:_0x3f327e,mainComponent:_0x36598c}=this[_0x34e260(0x38c)],_0x21d5d3=_0x1fb455[_0x34e260(0x44e)](_0x3081d2=>new _0x5942d4(_0x3081d2,_0x3f327e,_0x29ba06,_0x36598c));this['_cursorShapes']=_0x21d5d3,this[_0x34e260(0x322)]=_0x1fb455;}[_0x4624f5(0x2b3)](){const _0x2bf5fe=_0x4624f5;this[_0x2bf5fe(0x22c)]();const {scene:_0x284a6e,mainComponent:_0x11ecf0}=this[_0x2bf5fe(0x38c)],_0x524ae1=this['_docSkeletonManagerService'][_0x2bf5fe(0x341)](),_0x3e1231=this['_cursors'][_0x2bf5fe(0x44e)](_0x2603bd=>new _0x5942d4(_0x2603bd,_0x284a6e,_0x524ae1,_0x11ecf0));this['_cursorShapes']=_0x3e1231;}[_0x4624f5(0x22c)](){const _0x1c7506=_0x4624f5;this[_0x1c7506(0x34b)][_0x1c7506(0x265)](_0x4d9f99=>_0x4d9f99[_0x1c7506(0x214)]()),this['_cursorShapes']=[];}[_0x4624f5(0x36d)](){const _0x2f7ebb=_0x4624f5,_0x5b1e0d=[_0x5d4e8b['SetDocZoomRatioOperation']['id']];this[_0x2f7ebb(0x30f)](this[_0x2f7ebb(0x43a)]['onCommandExecuted'](_0xa672e5=>{const _0x2b8c92=_0x2f7ebb;_0x5b1e0d[_0x2b8c92(0x354)](_0xa672e5['id'])&&_0xa672e5[_0x2b8c92(0x276)]['unitId']===this[_0x2b8c92(0x38c)][_0x2b8c92(0x470)]&&this[_0x2b8c92(0x2b3)]();}));}[_0x4624f5(0x40d)](){const _0x11e0c1=_0x4624f5;this[_0x11e0c1(0x30f)](_0x161ac6[_0x11e0c1(0x312)](this[_0x11e0c1(0x38c)][_0x11e0c1(0x303)][_0x11e0c1(0x36f)])['pipe'](_0x136df2[_0x11e0c1(0x438)](_0x586fd8=>_0x586fd8[_0x11e0c1(0x35b)]===_0x1fade8[_0x11e0c1(0x37a)][_0x11e0c1(0x38b)]),_0x136df2[_0x11e0c1(0x440)](0x10))['subscribe'](()=>{const _0x14d1e2=_0x11e0c1;this[_0x14d1e2(0x2b3)]();}));}};_0x47d0f4=_0xb1469b([_0xf20c48(0x1,_0x161ac6[_0x4624f5(0x2b0)](_0x4db13e[_0x4624f5(0x242)])),_0xf20c48(0x2,_0x161ac6[_0x4624f5(0x2b0)](_0x1508be)),_0xf20c48(0x3,_0x161ac6[_0x4624f5(0x41a)]),_0xf20c48(0x4,_0x161ac6[_0x4624f5(0x2b0)](_0x161ac6[_0x4624f5(0x31f)]))],_0x47d0f4);const _0xd5b4f0=0x1,_0x5f0efe=1.5;class _0x5c4987 extends _0x1fade8[_0x4624f5(0x3d9)]{constructor(_0x22a934,_0x5593ae){const _0x1c7248=_0x4624f5;super(_0x22a934,_0x5593ae),_0x47bfcc(this,'_color'),_0x47bfcc(this,_0x1c7248(0x2a0),!0x1),_0x47bfcc(this,_0x1c7248(0x24c)),_0x47bfcc(this,'_name',''),_0x47bfcc(this,'_labelPosition','top'),_0x47bfcc(this,'_backgroundColor'),(_0x5593ae&&this[_0x1c7248(0x3e0)](_0x5593ae),this[_0x1c7248(0x1d3)][_0x1c7248(0x37c)](()=>this['setShapeProps']({'hovered':!0x0})),this['onPointerLeave$'][_0x1c7248(0x37c)](()=>this['setShapeProps']({'hovered':!0x1})));}['setShapeProps'](_0x124c0f){const _0x39eefd=_0x4624f5;var _0x530750,_0x38243f,_0x3cbe7a,_0x301d22,_0x3b97e6,_0x58fd44;this[_0x39eefd(0x452)]=(_0x530750=_0x124c0f[_0x39eefd(0x2fc)])!=null?_0x530750:this[_0x39eefd(0x452)],this[_0x39eefd(0x2a0)]=(_0x38243f=_0x124c0f[_0x39eefd(0x42d)])!=null?_0x38243f:this[_0x39eefd(0x2a0)],this[_0x39eefd(0x24c)]=(_0x3cbe7a=_0x124c0f[_0x39eefd(0x3d1)])!=null?_0x3cbe7a:this['_range'],this[_0x39eefd(0x33f)]=(_0x301d22=_0x124c0f[_0x39eefd(0x433)])!=null?_0x301d22:this[_0x39eefd(0x33f)],this[_0x39eefd(0x3f4)]=(_0x3b97e6=_0x124c0f['labelPosition'])!=null?_0x3b97e6:this[_0x39eefd(0x3f4)],this[_0x39eefd(0x446)]=(_0x58fd44=_0x124c0f[_0x39eefd(0x331)])!=null?_0x58fd44:this['_backgroundColor'],this[_0x39eefd(0x2f8)]({'width':_0x124c0f[_0x39eefd(0x230)],'height':_0x124c0f['height']});}[_0x4624f5(0x28c)](_0x1ae4bc){const _0x4f3789=_0x4624f5,{row:_0x4dd8ec,column:_0x86e9b}=_0x1ae4bc;if(_0x4dd8ec>=this[_0x4f3789(0x24c)][_0x4f3789(0x2e8)]&&_0x4dd8ec<=this[_0x4f3789(0x24c)]['endRow']&&_0x86e9b>=this[_0x4f3789(0x24c)][_0x4f3789(0x2cd)]&&_0x86e9b<=this[_0x4f3789(0x24c)][_0x4f3789(0x3f9)]){this[_0x4f3789(0x3e0)]({'hovered':!0x0});return;}this[_0x4f3789(0x3e0)]({'hovered':!0x1});}[_0x4624f5(0x1f3)](_0x12fcfe){return!0x1;}['_draw'](_0x13ca51){const _0x4f1cbc=_0x4624f5;_0x1fade8[_0x4f1cbc(0x374)][_0x4f1cbc(0x3b4)](_0x13ca51,{'width':this['width'],'height':this[_0x4f1cbc(0x3f8)],'strokeWidth':_0x5f0efe,'stroke':this[_0x4f1cbc(0x452)],'evented':!0x1,'fill':this[_0x4f1cbc(0x446)]}),this[_0x4f1cbc(0x2a0)]&&(_0x13ca51[_0x4f1cbc(0x37b)](),_0x13ca51['transform'](0x1,0x0,0x0,0x1,this['width'],this['_labelPosition']===_0x4f1cbc(0x23b)?0x0:-_0x5a3e8a),_0x6ab412[_0x4f1cbc(0x3b4)](_0x13ca51,{'text':this['_name'],'color':this[_0x4f1cbc(0x452)]}),_0x13ca51['restore']());}}var _0x222b6c=Object[_0x4624f5(0x272)],_0x44d088=(_0x3972e2,_0x350b7b,_0x2782a7,_0x37e1ff)=>{const _0x41429d=_0x4624f5;for(var _0x389d18=_0x37e1ff>0x1?void 0x0:_0x37e1ff?_0x222b6c(_0x350b7b,_0x2782a7):_0x350b7b,_0x533d26=_0x3972e2[_0x41429d(0x1e5)]-0x1,_0x165812;_0x533d26>=0x0;_0x533d26--)(_0x165812=_0x3972e2[_0x533d26])&&(_0x389d18=_0x165812(_0x389d18)||_0x389d18);return _0x389d18;},_0x49f4d0=(_0x566584,_0x2e9bb9)=>(_0x8e1276,_0x51bc22)=>_0x2e9bb9(_0x8e1276,_0x51bc22,_0x566584);const _0x5356fe=0x1389;let _0x2d665f=class extends _0x161ac6['RxDisposable']{constructor(_0x3ac546,_0x2225fa,_0x4cfbeb,_0x1e8d2a){const _0x106e99=_0x4624f5;super(),_0x47bfcc(this,_0x106e99(0x322),new Set()),_0x47bfcc(this,_0x106e99(0x1fd),null),(this[_0x106e99(0x38c)]=_0x3ac546,this[_0x106e99(0x393)]=_0x2225fa,this['_collabCursorController']=_0x4cfbeb,this['_themeService']=_0x1e8d2a,this['_init']());}[_0x4624f5(0x48d)](){const _0x40c3c4=_0x4624f5;this[_0x40c3c4(0x393)][_0x40c3c4(0x330)][_0x40c3c4(0x1ef)](_0x136df2[_0x40c3c4(0x45d)](this[_0x40c3c4(0x289)]),_0x136df2[_0x40c3c4(0x46f)](_0x377cfc=>{const _0xa6ace8=_0x40c3c4;if(_0x377cfc){const _0x3bc775=_0x377cfc[_0xa6ace8(0x2bf)];return _0x66cc31[_0xa6ace8(0x2f0)](this[_0xa6ace8(0x2c8)][_0xa6ace8(0x2c3)](this[_0xa6ace8(0x38c)][_0xa6ace8(0x470)]),this[_0xa6ace8(0x3c0)][_0xa6ace8(0x271)])[_0xa6ace8(0x1ef)](_0x136df2[_0xa6ace8(0x44e)](([_0x726aaf,_0x22a5c8])=>{const _0x51db45=_0xa6ace8,_0x5ca8a5=new Map();return _0x726aaf[_0x51db45(0x265)]((_0x5dd89e,_0x21aec5)=>{const _0x59b6ee=_0x51db45;if(_0x5dd89e['sheetID']===_0x3bc775){const _0x85e4f4={..._0x5dd89e};_0x85e4f4[_0x59b6ee(0x2fc)]=this[_0x59b6ee(0x3c0)][_0x59b6ee(0x3d8)](_0x5dd89e[_0x59b6ee(0x2fc)]),_0x5ca8a5[_0x59b6ee(0x3d5)](_0x21aec5,_0x85e4f4);}}),{'skeleton':_0x377cfc,'cursors':_0x5ca8a5};}));}return _0x66cc31['of']({'skeleton':null,'cursors':new Map()});}))['subscribe'](({skeleton:_0x4af596,cursors:_0x4cdeff})=>{const _0x1f6f63=_0x40c3c4;this[_0x1f6f63(0x22c)](),_0x4af596&&this[_0x1f6f63(0x398)](_0x4af596,_0x4cdeff);}),this[_0x40c3c4(0x393)][_0x40c3c4(0x330)]['subscribe'](_0x2eec4d=>{const _0x6551b6=_0x40c3c4;if(_0x2eec4d==null)return;const {skeleton:_0x4ec28c}=_0x2eec4d,{scene:_0x207b74}=this[_0x6551b6(0x38c)];_0x207b74[_0x6551b6(0x458)][_0x6551b6(0x37c)](_0x161ac6[_0x6551b6(0x3e4)](_0xed68=>{const _0x1f371a=_0x6551b6;var _0x18a802,_0x36aba4;const {offsetX:_0x5c2771,offsetY:_0x4d078b}=_0xed68,{x:_0x3b3b50,y:_0x30c118}=_0x207b74[_0x1f371a(0x2fd)](_0x1fade8[_0x1f371a(0x305)][_0x1f371a(0x427)]([_0x5c2771,_0x4d078b])),{scaleX:_0x365b45,scaleY:_0x197a9a}=_0x207b74['getAncestorScale'](),_0x29601e=_0x207b74[_0x1f371a(0x3db)](_0x1fade8['SHEET_VIEWPORT_KEY'][_0x1f371a(0x2bd)]),_0x13104c=_0x207b74[_0x1f371a(0x483)](_0x1fade8[_0x1f371a(0x305)][_0x1f371a(0x427)]([_0x3b3b50,_0x30c118]),_0x29601e),_0x299ebf=_0x4ec28c['getCellPositionByOffset'](_0x5c2771,_0x4d078b,_0x365b45,_0x197a9a,_0x13104c);((_0x18a802=this[_0x1f371a(0x1fd)])==null?void 0x0:_0x18a802[_0x1f371a(0x476)])===_0x299ebf[_0x1f371a(0x476)]&&((_0x36aba4=this['_lastPointer'])==null?void 0x0:_0x36aba4[_0x1f371a(0x3e5)])===_0x299ebf[_0x1f371a(0x3e5)]||this['_cursors'][_0x1f371a(0x265)](_0x2ca931=>{const _0x9fb1fa=_0x1f371a;_0x2ca931[_0x9fb1fa(0x28c)](_0x299ebf);});},0x64));});}[_0x4624f5(0x398)](_0x24b9cd,_0xd7a9f){const _0x2104f7=_0x4624f5;var _0x4a9344;const _0x1a6e72=(_0x4a9344=this[_0x2104f7(0x393)][_0x2104f7(0x2e2)]())==null?void 0x0:_0x4a9344[_0x2104f7(0x49a)];if(!_0x1a6e72)return;const _0x46b57d=this[_0x2104f7(0x3df)]();if(!_0x46b57d)return;this[_0x2104f7(0x322)][_0x2104f7(0x265)](_0x35c410=>{const _0x52b53e=_0x2104f7;_0x35c410[_0x52b53e(0x236)]();});const {scene:_0x4c3713}=_0x46b57d,_0x58f058=_0x22fbae(Array[_0x2104f7(0x243)](_0xd7a9f[_0x2104f7(0x42f)]()))[_0x2104f7(0x44e)](_0x4227d3=>{const _0x444647=_0x2104f7,{color:_0x584e3c,range:_0x584927,name:_0xe96b1b,selection:_0x5cd971,sheetID:_0xe886fb}=_0x4227d3,{startColumn:_0xaa0ef,startRow:_0x3bb447,endColumn:_0x3fc287,endRow:_0x28e3ff}=_0x584927,_0x376d17=_0x5b4c60['getCoordByCell'](_0x3bb447,_0xaa0ef,_0x4c3713,_0x1a6e72),_0xf6a6a6=_0x5b4c60['getCoordByCell'](_0x28e3ff,_0x3fc287,_0x4c3713,_0x1a6e72),{columnHeaderHeightAndMarginTop:_0x360639}=_0x1a6e72,{startX:_0x39b636,startY:_0xd31f44}=_0x376d17,{endX:_0xdec112,endY:_0x5ef07b}=_0xf6a6a6,_0x4b6b08=_0xdec112-_0x39b636,_0x47fc30=_0x5ef07b-_0xd31f44,_0x3afda2={'labelPosition':_0xd31f44-_0x360639>=_0x5a3e8a?_0x444647(0x3a1):_0x444647(0x23b),'sheetID':_0xe886fb,'range':_0x584927,'color':_0x584e3c,'name':_0xe96b1b,'selection':_0x5cd971,'left':_0x39b636,'top':_0xd31f44,'width':_0x4b6b08,'height':_0x47fc30,'evented':!0x1,'zIndex':_0x5356fe};return new _0x5c4987(_0xe96b1b,_0x3afda2);});_0x4c3713[_0x2104f7(0x2dc)](_0x58f058,_0xd5b4f0),this[_0x2104f7(0x322)]=new Set(_0x58f058);}[_0x4624f5(0x22c)](){const _0x169345=_0x4624f5;var _0x4117e9;(_0x4117e9=this[_0x169345(0x322)])==null||_0x4117e9['forEach'](_0x5e188b=>_0x5e188b[_0x169345(0x214)]());}['_getSheetObject'](){const _0x3910ae=_0x4624f5;return _0x5b4c60[_0x3910ae(0x386)](this[_0x3910ae(0x38c)]['unit'],this[_0x3910ae(0x38c)]);}};_0x2d665f=_0x44d088([_0x49f4d0(0x1,_0x161ac6[_0x4624f5(0x2b0)](_0x5b4c60[_0x4624f5(0x39a)])),_0x49f4d0(0x2,_0x161ac6['Inject'](_0x1508be)),_0x49f4d0(0x3,_0x161ac6[_0x4624f5(0x2b0)](_0x161ac6['ThemeService']))],_0x2d665f);function _0x22fbae(_0x165e1a){const _0x9686a1=_0x4624f5,_0x109777=new Map();return _0x165e1a[_0x9686a1(0x265)](_0x50bc15=>{const _0x1f5fb5=_0x9686a1;if(_0x109777[_0x1f5fb5(0x390)](_0x50bc15['selection'])){const _0x3a5512=_0x109777[_0x1f5fb5(0x333)](_0x50bc15['selection']);_0x3a5512[_0x1f5fb5(0x433)]+=',\x20'+_0x50bc15[_0x1f5fb5(0x433)];}else _0x109777['set'](_0x50bc15['selection'],_0x50bc15);}),Array['from'](_0x109777['values']());}var _0xb4bcb1=Object['getOwnPropertyDescriptor'],_0x1a32df=(_0x3b7189,_0x4ec178,_0x54e464,_0x3452de)=>{const _0x1b9732=_0x4624f5;for(var _0x6c02dd=_0x3452de>0x1?void 0x0:_0x3452de?_0xb4bcb1(_0x4ec178,_0x54e464):_0x4ec178,_0x33ae4a=_0x3b7189[_0x1b9732(0x1e5)]-0x1,_0x109921;_0x33ae4a>=0x0;_0x33ae4a--)(_0x109921=_0x3b7189[_0x33ae4a])&&(_0x6c02dd=_0x109921(_0x6c02dd)||_0x6c02dd);return _0x6c02dd;},_0x3aea0f=(_0x176467,_0x14e6b1)=>(_0x41191e,_0x5abc01)=>_0x14e6b1(_0x41191e,_0x5abc01,_0x176467);let _0x1a48d1=class extends _0x161ac6[_0x4624f5(0x482)]{constructor(_0x52e10a,_0x5558f8,_0x15aa9d,_0x445bb7,_0x30b562,_0x241f9f){const _0x2573ec=_0x4624f5;super(),this[_0x2573ec(0x2f5)]=_0x52e10a,this[_0x2573ec(0x346)]=_0x5558f8,this['_collaborationUIEventService']=_0x15aa9d,this[_0x2573ec(0x47b)]=_0x445bb7,this[_0x2573ec(0x3bd)]=_0x30b562,this[_0x2573ec(0x23c)]=_0x241f9f,this[_0x2573ec(0x3f1)](),this[_0x2573ec(0x413)]();}[_0x4624f5(0x3f1)](){const _0x5bba5e=_0x4624f5;this[_0x5bba5e(0x30f)](this[_0x5bba5e(0x2f5)]['registerBeforeClose'](()=>{const _0x5e4787=_0x5bba5e;if(this[_0x5e4787(0x346)][_0x5e4787(0x47c)]['size'])return this[_0x5e4787(0x23c)]['t'](_0x5e4787(0x1f9));}));}[_0x4624f5(0x413)](){const _0x58c133=_0x4624f5;this[_0x58c133(0x30f)](this[_0x58c133(0x449)][_0x58c133(0x3fa)][_0x58c133(0x26b)](_0x1285e4=>{const _0x16c244=_0x58c133;_0x1285e4['id']===_0x46104e[_0x16c244(0x334)]['OTHER_CLIENT_EDITING']&&this[_0x16c244(0x47b)][_0x16c244(0x27d)]({'type':_0x37af48[_0x16c244(0x366)][_0x16c244(0x241)],'content':this[_0x16c244(0x23c)]['t'](_0x16c244(0x1d1))}),_0x1285e4['id']===_0x46104e[_0x16c244(0x334)][_0x16c244(0x403)]&&this['_messageService'][_0x16c244(0x27d)]({'type':_0x37af48[_0x16c244(0x366)][_0x16c244(0x241)],'content':this[_0x16c244(0x23c)]['t'](_0x16c244(0x436))}),_0x1285e4['id']===_0x46104e[_0x16c244(0x334)][_0x16c244(0x2a5)]&&this[_0x16c244(0x3bd)][_0x16c244(0x27d)]({'title':this[_0x16c244(0x23c)]['t'](_0x16c244(0x339)),'content':this['_localeService']['t']('permission.content'),'type':'error','duration':0x0}),_0x1285e4['id']===_0x46104e[_0x16c244(0x334)][_0x16c244(0x499)]&&this[_0x16c244(0x47b)][_0x16c244(0x27d)]({'type':_0x37af48[_0x16c244(0x366)][_0x16c244(0x368)],'content':this[_0x16c244(0x23c)]['t']('collaboration.closeRoom')+'('+_0x1285e4[_0x16c244(0x345)]+')'}),_0x1285e4['id']===_0x46104e[_0x16c244(0x334)][_0x16c244(0x2ce)]&&this[_0x16c244(0x47b)][_0x16c244(0x27d)]({'type':_0x37af48['MessageType'][_0x16c244(0x241)],'content':this[_0x16c244(0x23c)]['t'](_0x1285e4[_0x16c244(0x345)]||'')}),_0x1285e4['id']===_0x46104e['CollaborationUIEventId'][_0x16c244(0x1f0)]&&this[_0x16c244(0x47b)]['show']({'type':_0x37af48[_0x16c244(0x366)][_0x16c244(0x241)],'content':this['_localeService']['t']('session.will-retry')}),_0x1285e4['id']===_0x46104e[_0x16c244(0x334)][_0x16c244(0x2b6)]&&this[_0x16c244(0x47b)][_0x16c244(0x27d)]({'type':_0x37af48['MessageType'][_0x16c244(0x368)],'content':this['_localeService']['t'](_0x16c244(0x46d))}),_0x1285e4['id']===_0x46104e[_0x16c244(0x334)][_0x16c244(0x342)]&&this['_messageService'][_0x16c244(0x27d)]({'type':_0x37af48[_0x16c244(0x366)][_0x16c244(0x368)],'content':this[_0x16c244(0x23c)]['t'](_0x16c244(0x22a))});}));}};_0x1a48d1=_0x1a32df([_0x3aea0f(0x0,_0x4291c6[_0x4624f5(0x234)]),_0x3aea0f(0x1,_0x46104e['ILocalCacheService']),_0x3aea0f(0x2,_0x161ac6[_0x4624f5(0x2b0)](_0x46104e[_0x4624f5(0x421)])),_0x3aea0f(0x3,_0x4291c6['IMessageService']),_0x3aea0f(0x4,_0x4291c6[_0x4624f5(0x2be)]),_0x3aea0f(0x5,_0x161ac6[_0x4624f5(0x2b0)](_0x161ac6['LocaleService']))],_0x1a48d1);const _0x2f76a0=_0x4624f5(0x2ca),_0xbf724b={};var _0x525560=Object[_0x4624f5(0x272)],_0x39ab76=(_0x1099bf,_0x3b7e14,_0x4d5bdd,_0x40b79a)=>{const _0x20f698=_0x4624f5;for(var _0x5cf551=_0x40b79a>0x1?void 0x0:_0x40b79a?_0x525560(_0x3b7e14,_0x4d5bdd):_0x3b7e14,_0xb6897=_0x1099bf[_0x20f698(0x1e5)]-0x1,_0x46af3b;_0xb6897>=0x0;_0xb6897--)(_0x46af3b=_0x1099bf[_0xb6897])&&(_0x5cf551=_0x46af3b(_0x5cf551)||_0x5cf551);return _0x5cf551;},_0x345a26=(_0x5e6075,_0x4b3678)=>(_0xd65cf4,_0x10d20e)=>_0x4b3678(_0xd65cf4,_0x10d20e,_0x5e6075);let _0x6698d6=class{constructor(_0x36c676,_0x3e4712){const _0x151b0e=_0x4624f5;this[_0x151b0e(0x27c)]=_0x36c676,this[_0x151b0e(0x338)]=_0x3e4712;}['transformIMECache'](_0x3dbc5e){const _0x558447=_0x4624f5;this[_0x558447(0x3bf)](_0x3dbc5e),this[_0x558447(0x394)](_0x3dbc5e);}[_0x4624f5(0x3c2)](_0x141025){const _0xe14221=_0x4624f5,{unitID:_0x3365e2}=_0x141025,_0x486c6c=this['_renderManagerService'][_0xe14221(0x1ed)](_0x3365e2)[_0xe14221(0x287)](_0x5d4e8b[_0xe14221(0x32b)]),{redoCache:_0x502a16}=_0x486c6c['getUndoRedoMutationParamsCache']();if(_0x502a16['length']===0x0)return _0x141025;let _0x53d5a0=_0x161ac6[_0xe14221(0x460)]['deepClone'](_0x141025[_0xe14221(0x35d)][0x0]);for(let _0x3ee009=0x0;_0x3ee009<_0x502a16[_0xe14221(0x1e5)];_0x3ee009++){const _0x4a64c5={'id':_0xe14221(0x25b),'params':{..._0x502a16[_0x3ee009]}},_0x115a32=this[_0xe14221(0x27c)][_0xe14221(0x3d7)](_0x53d5a0,_0x4a64c5,!0x1);if(_0x48fdef[_0xe14221(0x32e)](_0x115a32))throw _0x115a32[_0xe14221(0x3ff)];_0x53d5a0=_0x115a32[_0xe14221(0x494)];}return{..._0x161ac6[_0xe14221(0x460)][_0xe14221(0x2d8)](_0x141025),'mutations':[_0x53d5a0]};}[_0x4624f5(0x3bf)](_0x11433d){const _0x1cfbe0=_0x4624f5,{unitID:_0x14d498}=_0x11433d,_0x2b9811=this[_0x1cfbe0(0x338)][_0x1cfbe0(0x1ed)](_0x14d498)[_0x1cfbe0(0x287)](_0x5d4e8b[_0x1cfbe0(0x32b)]),{undoCache:_0x394620,redoCache:_0xb3b2ff}=_0x2b9811[_0x1cfbe0(0x302)]();if(_0x394620[_0x1cfbe0(0x1e5)]===0x0||_0xb3b2ff['length']===0x0)return;const _0x43d85d=[],_0x5318e7=[];let _0x1948f3=_0x161ac6['Tools'][_0x1cfbe0(0x2d8)](_0x11433d['mutations'][0x0]),_0x39e7f7=_0x161ac6[_0x1cfbe0(0x460)][_0x1cfbe0(0x2d8)](_0x11433d[_0x1cfbe0(0x35d)][0x0]);for(let _0xde89e2=_0x394620[_0x1cfbe0(0x1e5)]-0x1;_0xde89e2>=0x0;_0xde89e2--){const _0x30ab9e={'id':_0x1cfbe0(0x25b),'params':{..._0x394620[_0xde89e2]}},_0x50efd7={'id':_0x1cfbe0(0x25b),'params':{..._0xb3b2ff[_0xde89e2]}},_0x5c9ce8=this['_transformService'][_0x1cfbe0(0x3d7)](_0x1948f3,_0x30ab9e,!0x1),_0xaadcab=this[_0x1cfbe0(0x27c)][_0x1cfbe0(0x3d7)](_0x39e7f7,_0x50efd7,!0x1);if(_0x48fdef['isTransformMutationFailure'](_0x5c9ce8))throw _0x5c9ce8[_0x1cfbe0(0x3ff)];if(_0x48fdef[_0x1cfbe0(0x32e)](_0xaadcab))throw _0xaadcab[_0x1cfbe0(0x3ff)];_0x43d85d[_0x1cfbe0(0x1f2)](_0x5c9ce8['m2Prime'][_0x1cfbe0(0x276)]),_0x5318e7[_0x1cfbe0(0x1f2)](_0xaadcab[_0x1cfbe0(0x397)][_0x1cfbe0(0x276)]),_0x1948f3=_0x5c9ce8[_0x1cfbe0(0x494)],_0x39e7f7=_0xaadcab['m1Prime'];}_0x2b9811['setUndoRedoMutationParamsCache']({'undoCache':_0x43d85d,'redoCache':_0x5318e7});}[_0x4624f5(0x394)](_0x483508){const _0x23aed7=_0x4624f5,{unitID:_0x582c3f}=_0x483508,_0x1d7e1c=this['_renderManagerService']['getRenderById'](_0x582c3f)[_0x23aed7(0x287)](_0x5d4e8b[_0x23aed7(0x32b)]),_0x18f0b4=_0x1d7e1c[_0x23aed7(0x3a6)]();if(_0x18f0b4==null)return;const _0x958197=[{'id':_0x23aed7(0x25b),'params':{'unitId':_0x483508[_0x23aed7(0x2e9)],'actions':null,'textRanges':[_0x18f0b4]}}],_0x4b42be=this[_0x23aed7(0x27c)][_0x23aed7(0x2bb)](_0x483508,_0x958197);if(!_0x48fdef[_0x23aed7(0x245)](_0x4b42be))throw _0x4b42be[_0x23aed7(0x3ff)];const _0x5ccda8=_0x4b42be[_0x23aed7(0x397)][0x0][_0x23aed7(0x276)][_0x23aed7(0x3c5)];Array[_0x23aed7(0x462)](_0x5ccda8)&&_0x5ccda8[_0x23aed7(0x1e5)]&&_0x1d7e1c['setActiveRange'](_0x5ccda8[0x0]);}};_0x6698d6=_0x39ab76([_0x345a26(0x0,_0x48fdef['ITransformService']),_0x345a26(0x1,_0x1fade8[_0x4624f5(0x383)])],_0x6698d6);var _0xe85881=Object[_0x4624f5(0x272)],_0x20e6bb=(_0x283a50,_0x57ab02,_0x3bd32a,_0x2a9cac)=>{const _0x11942a=_0x4624f5;for(var _0x4eac68=_0x2a9cac>0x1?void 0x0:_0x2a9cac?_0xe85881(_0x57ab02,_0x3bd32a):_0x57ab02,_0x5850a2=_0x283a50[_0x11942a(0x1e5)]-0x1,_0x36852f;_0x5850a2>=0x0;_0x5850a2--)(_0x36852f=_0x283a50[_0x5850a2])&&(_0x4eac68=_0x36852f(_0x4eac68)||_0x4eac68);return _0x4eac68;},_0x5e50d1=(_0x11388c,_0x4da7e3)=>(_0x59d4f4,_0x18ad08)=>_0x4da7e3(_0x59d4f4,_0x18ad08,_0x11388c);let _0xa7a54c=class{constructor(_0x7f556b,_0x1af56e,_0x2ee72d){const _0x3af573=_0x4624f5;this[_0x3af573(0x298)]=_0x7f556b,this[_0x3af573(0x27c)]=_0x1af56e,this[_0x3af573(0x22e)]=_0x2ee72d;}[_0x4624f5(0x307)](_0x1aaee7){const _0x93433d=_0x4624f5;this[_0x93433d(0x3c1)](_0x1aaee7);}[_0x4624f5(0x3c2)](_0x1053a4){const _0x3043a3=_0x4624f5,{unitID:_0x270535}=_0x1053a4,{collaboration:_0x39335c}=this[_0x3043a3(0x22e)][_0x3043a3(0x39e)](_0x270535);if(_0x39335c[_0x3043a3(0x1e5)]===0x0)return _0x1053a4;let _0x340834=_0x161ac6[_0x3043a3(0x460)][_0x3043a3(0x2d8)](_0x1053a4[_0x3043a3(0x35d)][0x0]);for(let _0x42ea20=0x0;_0x42ea20<_0x39335c['length'];_0x42ea20++){const _0x40ca5e={'id':_0x3043a3(0x25b),'params':{'unitId':_0x39335c[_0x42ea20]['unitId'],..._0x39335c[_0x42ea20][_0x3043a3(0x4a1)]}},_0x1c19af=this[_0x3043a3(0x27c)][_0x3043a3(0x3d7)](_0x340834,_0x40ca5e,!0x1);if(_0x48fdef[_0x3043a3(0x32e)](_0x1c19af))throw _0x1c19af[_0x3043a3(0x3ff)];_0x340834=_0x1c19af['m1Prime'];}return{..._0x161ac6['Tools'][_0x3043a3(0x2d8)](_0x1053a4),'mutations':[_0x340834]};}[_0x4624f5(0x3c1)](_0x1de933){const _0x4d3d5b=_0x4624f5,{unitID:_0x1e54c7}=_0x1de933,{history:_0x33ebd3,collaboration:_0x197a05}=this[_0x4d3d5b(0x22e)][_0x4d3d5b(0x39e)](_0x1e54c7);if(_0x33ebd3[_0x4d3d5b(0x1e5)]===0x0&&_0x197a05[_0x4d3d5b(0x1e5)]===0x0)return;const _0x4fdf63=[],_0x1d6504=[];let _0x24483f=_0x161ac6[_0x4d3d5b(0x460)][_0x4d3d5b(0x2d8)](_0x1de933[_0x4d3d5b(0x35d)][0x0]),_0x1d48d6=_0x161ac6[_0x4d3d5b(0x460)][_0x4d3d5b(0x2d8)](_0x1de933[_0x4d3d5b(0x35d)][0x0]);for(let _0x30bf00=_0x33ebd3['length']-0x1;_0x30bf00>=0x0;_0x30bf00--){const _0x240579={'id':_0x4d3d5b(0x25b),'params':{'unitId':_0x33ebd3[_0x30bf00][_0x4d3d5b(0x470)],..._0x33ebd3[_0x30bf00]['undoState']}},_0x17607b={'id':_0x4d3d5b(0x25b),'params':{'unitId':_0x33ebd3[_0x30bf00][_0x4d3d5b(0x470)],..._0x33ebd3[_0x30bf00][_0x4d3d5b(0x4a1)]}},_0x462534=this[_0x4d3d5b(0x27c)][_0x4d3d5b(0x3d7)](_0x24483f,_0x240579,!0x1),_0x27c7fb=this[_0x4d3d5b(0x27c)][_0x4d3d5b(0x3d7)](_0x1d48d6,_0x17607b,!0x1);if(_0x48fdef[_0x4d3d5b(0x32e)](_0x462534))throw _0x462534[_0x4d3d5b(0x3ff)];if(_0x48fdef[_0x4d3d5b(0x32e)](_0x27c7fb))throw _0x27c7fb['error'];_0x4fdf63['unshift']({..._0x33ebd3[_0x30bf00],'undoState':_0x462534[_0x4d3d5b(0x397)][_0x4d3d5b(0x276)],'redoState':_0x27c7fb['m2Prime'][_0x4d3d5b(0x276)]}),_0x24483f=_0x462534[_0x4d3d5b(0x494)],_0x1d48d6=_0x27c7fb['m1Prime'];}_0x24483f=_0x161ac6[_0x4d3d5b(0x460)][_0x4d3d5b(0x2d8)](_0x1de933[_0x4d3d5b(0x35d)][0x0]),_0x1d48d6=_0x161ac6['Tools'][_0x4d3d5b(0x2d8)](_0x1de933['mutations'][0x0]);for(let _0x20eb2d=_0x197a05[_0x4d3d5b(0x1e5)]-0x1;_0x20eb2d>=0x0;_0x20eb2d--){const _0x2ac1b8={'id':_0x4d3d5b(0x25b),'params':{'unitId':_0x197a05[_0x20eb2d][_0x4d3d5b(0x470)],..._0x197a05[_0x20eb2d][_0x4d3d5b(0x20e)]}},_0x2653b7={'id':_0x4d3d5b(0x25b),'params':{'unitId':_0x197a05[_0x20eb2d][_0x4d3d5b(0x470)],..._0x197a05[_0x20eb2d][_0x4d3d5b(0x4a1)]}},_0x5a45e0=this[_0x4d3d5b(0x27c)][_0x4d3d5b(0x3d7)](_0x24483f,_0x2ac1b8,!0x1),_0x446a2d=this[_0x4d3d5b(0x27c)][_0x4d3d5b(0x3d7)](_0x1d48d6,_0x2653b7,!0x1);if(_0x48fdef['isTransformMutationFailure'](_0x5a45e0))throw _0x5a45e0[_0x4d3d5b(0x3ff)];if(_0x48fdef[_0x4d3d5b(0x32e)](_0x446a2d))throw _0x446a2d[_0x4d3d5b(0x3ff)];_0x1d6504[_0x4d3d5b(0x1f2)]({..._0x197a05[_0x20eb2d],'undoState':_0x5a45e0['m2Prime'][_0x4d3d5b(0x276)],'redoState':_0x446a2d[_0x4d3d5b(0x397)][_0x4d3d5b(0x276)]}),_0x24483f=_0x5a45e0[_0x4d3d5b(0x494)],_0x1d48d6=_0x446a2d[_0x4d3d5b(0x494)];}this[_0x4d3d5b(0x22e)][_0x4d3d5b(0x207)](_0x1e54c7,{'history':_0x4fdf63,'collaboration':_0x1d6504});}};_0xa7a54c=_0x20e6bb([_0x5e50d1(0x0,_0x161ac6[_0x4624f5(0x2b0)](_0x161ac6[_0x4624f5(0x2c2)])),_0x5e50d1(0x1,_0x48fdef[_0x4624f5(0x254)]),_0x5e50d1(0x2,_0x161ac6[_0x4624f5(0x2b0)](_0x5d4e8b[_0x4624f5(0x3f0)]))],_0xa7a54c);var _0x57ad3c=Object[_0x4624f5(0x272)],_0x42e18e=(_0x30091c,_0x3f8d4e,_0x5e41f2,_0x165eb7)=>{const _0x1407cc=_0x4624f5;for(var _0x44becc=_0x165eb7>0x1?void 0x0:_0x165eb7?_0x57ad3c(_0x3f8d4e,_0x5e41f2):_0x3f8d4e,_0x3c2778=_0x30091c[_0x1407cc(0x1e5)]-0x1,_0xcae1a;_0x3c2778>=0x0;_0x3c2778--)(_0xcae1a=_0x30091c[_0x3c2778])&&(_0x44becc=_0xcae1a(_0x44becc)||_0x44becc);return _0x44becc;},_0x3e339d=(_0x14fe80,_0x578ed5)=>(_0x1a9d2d,_0x47fe78)=>_0x578ed5(_0x1a9d2d,_0x47fe78,_0x14fe80);let _0x16e8f2=class{constructor(_0x4d088f,_0x24c689){this['_injector']=_0x4d088f,this['_transformService']=_0x24c689;}['transformSelections'](_0x561d0f){const _0xafd62=_0x4624f5;var _0x478b5d;const _0xf6ec35=this[_0xafd62(0x298)][_0xafd62(0x333)](_0x4db13e[_0xafd62(0x3c7)]),_0x2205ed=(_0x478b5d=_0xf6ec35[_0xafd62(0x2ae)]())!=null?_0x478b5d:[];if(_0x2205ed[_0xafd62(0x1e5)]===0x0)return;const _0x44c61e=_0x561d0f[_0xafd62(0x2e9)],_0x3a8dbf=[{'id':_0xafd62(0x25b),'params':{'unitId':_0x44c61e,'actions':null,'textRanges':_0x2205ed}}],_0x2063bb=this['_transformService']['transformMutationsWithChangeset'](_0x561d0f,_0x3a8dbf);if(!_0x48fdef['isTransformMutationsWithChangesetSuccess'](_0x2063bb))throw _0x2063bb[_0xafd62(0x3ff)];const _0x127821=_0x2063bb['m2Prime'][0x0][_0xafd62(0x276)][_0xafd62(0x3c5)];Array['isArray'](_0x127821)&&_0x127821['length']&&_0xf6ec35[_0xafd62(0x2b8)](_0x127821,{'unitId':_0x44c61e,'subUnitId':_0x44c61e},!0x1);}};_0x16e8f2=_0x42e18e([_0x3e339d(0x0,_0x161ac6[_0x4624f5(0x2b0)](_0x161ac6[_0x4624f5(0x2c2)])),_0x3e339d(0x1,_0x48fdef['ITransformService'])],_0x16e8f2);var _0x51fbdb=Object[_0x4624f5(0x272)],_0x485991=(_0x5b2727,_0x12d06e,_0x56d4d4,_0x5a2083)=>{for(var _0x5e01b0=_0x5a2083>0x1?void 0x0:_0x5a2083?_0x51fbdb(_0x12d06e,_0x56d4d4):_0x12d06e,_0x2024d9=_0x5b2727['length']-0x1,_0x587b4a;_0x2024d9>=0x0;_0x2024d9--)(_0x587b4a=_0x5b2727[_0x2024d9])&&(_0x5e01b0=_0x587b4a(_0x5e01b0)||_0x5e01b0);return _0x5e01b0;},_0xb392fd=(_0x2ba211,_0x2aba97)=>(_0x45d113,_0x582c43)=>_0x2aba97(_0x45d113,_0x582c43,_0x2ba211);let _0x41f840=class extends _0x161ac6[_0x4624f5(0x482)]{constructor(_0x3155a2,_0x5739f4,_0x407101,_0x43c9c1,_0x22486e,_0x4f5593,_0x139f99,_0x1b07de){const _0x124180=_0x4624f5;super(),_0x47bfcc(this,_0x124180(0x3e7),new _0x66cc31[(_0x124180(0x41e))](_0x46104e['CollaborationStatus']['NOT_COLLAB'])),(this[_0x124180(0x22e)]=_0x3155a2,this[_0x124180(0x2c0)]=_0x5739f4,this['_docTransformIMECacheService']=_0x407101,this['_docTransformStateCacheService']=_0x43c9c1,this[_0x124180(0x1df)]=_0x22486e,this[_0x124180(0x2eb)]=_0x4f5593,this[_0x124180(0x47b)]=_0x139f99,this[_0x124180(0x23c)]=_0x1b07de,this[_0x124180(0x21d)]());}[_0x4624f5(0x21d)](){const _0x4fe9e4=_0x4624f5;this[_0x4fe9e4(0x30f)](this[_0x4fe9e4(0x2c0)][_0x4fe9e4(0x43c)][_0x4fe9e4(0x26b)](_0x5531b7=>{const _0x1049b=_0x4fe9e4,_0x243c49=this['_docStateChangeManagerService'][_0x1049b(0x2fa)]['subscribe'](_0x1e31c9=>{const _0x3cf30c=_0x1049b;if(_0x1e31c9==null)return;const {unitId:_0x1c2a68,redoState:_0x2d92c6,commandId:_0x29b2bc}=_0x1e31c9;if(_0x1c2a68!==_0x5531b7['unitID'])return;const _0x1665c8={'id':_0x29b2bc,'type':_0x161ac6[_0x3cf30c(0x367)]['MUTATION'],'params':{'unitId':_0x1c2a68,'actions':_0x2d92c6[_0x3cf30c(0x31c)],'textRanges':null}};_0x5531b7['onLocalMutation'](_0x1665c8);});if(_0x5531b7[_0x1049b(0x30f)](_0x243c49),_0x5531b7 instanceof _0x46104e[_0x1049b(0x465)]){const _0x1b75b4={'onTransformIME':_0xf94ca=>this[_0x1049b(0x3d4)]['transformIMECache'](_0xf94ca),'onTransformState':_0xc0a988=>this[_0x1049b(0x3d3)]['transformStateCache'](_0xc0a988),'onTransformSelections':_0x1ba053=>this[_0x1049b(0x1df)][_0x1049b(0x297)](_0x1ba053),'onSyncEditingCollabCursor':_0x3f76d3=>this[_0x1049b(0x2eb)][_0x1049b(0x26c)](_0x3f76d3),'onTransformRemoteChangesetByIMECache':_0x4b6beb=>this['_docTransformIMECacheService'][_0x1049b(0x3c2)](_0x4b6beb),'onTransformRemoteChangesetByStateCache':_0x1604a9=>this[_0x1049b(0x3d3)][_0x1049b(0x3c2)](_0x1604a9)};_0x5531b7[_0x1049b(0x1e3)](_0x1b75b4);}}));}};_0x41f840=_0x485991([_0xb392fd(0x0,_0x161ac6[_0x4624f5(0x2b0)](_0x5d4e8b[_0x4624f5(0x3f0)])),_0xb392fd(0x1,_0x161ac6[_0x4624f5(0x2b0)](_0x46104e[_0x4624f5(0x23f)])),_0xb392fd(0x2,_0x161ac6[_0x4624f5(0x2b0)](_0x6698d6)),_0xb392fd(0x3,_0x161ac6[_0x4624f5(0x2b0)](_0xa7a54c)),_0xb392fd(0x4,_0x161ac6[_0x4624f5(0x2b0)](_0x16e8f2)),_0xb392fd(0x5,_0x161ac6[_0x4624f5(0x2b0)](_0x360498)),_0xb392fd(0x6,_0x4291c6['IMessageService']),_0xb392fd(0x7,_0x161ac6[_0x4624f5(0x2b0)](_0x161ac6['LocaleService']))],_0x41f840);var _0x5a1443=(_0x5ceda4=>(_0x5ceda4[_0x5ceda4[_0x4624f5(0x451)]=0x0]=_0x4624f5(0x451),_0x5ceda4[_0x5ceda4['OK']=0x1]='OK',_0x5ceda4[_0x5ceda4['INTERNAL_ERROR']=0x2]=_0x4624f5(0x313),_0x5ceda4[_0x5ceda4[_0x4624f5(0x2a5)]=0x3]=_0x4624f5(0x2a5),_0x5ceda4[_0x5ceda4['NOT_FOUND']=0x4]=_0x4624f5(0x47e),_0x5ceda4[_0x5ceda4[_0x4624f5(0x1d0)]=0x5]='UNAUTHENTICATED',_0x5ceda4[_0x5ceda4[_0x4624f5(0x364)]=0x6]='ALREADY_EXISTS',_0x5ceda4[_0x5ceda4[_0x4624f5(0x259)]=0x7]=_0x4624f5(0x259),_0x5ceda4[_0x5ceda4['TOO_MANY_REQUESTS']=0x8]=_0x4624f5(0x308),_0x5ceda4[_0x5ceda4['COMPLETION_FINISHED']=0x9]=_0x4624f5(0x2b4),_0x5ceda4[_0x5ceda4[_0x4624f5(0x2ac)]=0xa]=_0x4624f5(0x2ac),_0x5ceda4[_0x5ceda4['MOBILE_VERIFY_CODE_MISMATCH']=0xb]=_0x4624f5(0x3b1),_0x5ceda4[_0x5ceda4[_0x4624f5(0x30e)]=0xc]=_0x4624f5(0x30e),_0x5ceda4[_0x5ceda4['EMAIL_VERIFY_CODE_MISMATCH']=0xd]=_0x4624f5(0x375),_0x5ceda4[_0x5ceda4[_0x4624f5(0x1e4)]=0xe]=_0x4624f5(0x1e4),_0x5ceda4[_0x5ceda4[_0x4624f5(0x40f)]=0xf]=_0x4624f5(0x40f),_0x5ceda4[_0x5ceda4[_0x4624f5(0x267)]=0x10]=_0x4624f5(0x267),_0x5ceda4[_0x5ceda4['CURRENT_STATUS_CANNOT_OPERATE']=0x64]=_0x4624f5(0x439),_0x5ceda4[_0x5ceda4[_0x4624f5(0x200)]=0x65]=_0x4624f5(0x200),_0x5ceda4[_0x5ceda4[_0x4624f5(0x3b3)]=0xc9]=_0x4624f5(0x3b3),_0x5ceda4[_0x5ceda4['USER_IS_ANONYMOUS']=0xca]='USER_IS_ANONYMOUS',_0x5ceda4[_0x5ceda4['CHANGESET_REVISION_CONFILICT']=0x1389]='CHANGESET_REVISION_CONFILICT',_0x5ceda4[_0x5ceda4[_0x4624f5(0x2f1)]=0x1771]=_0x4624f5(0x2f1),_0x5ceda4[_0x5ceda4[_0x4624f5(0x4a0)]=0x1772]='SNAPSHOT_HAS_BEEN_REMOVED',_0x5ceda4[_0x5ceda4[_0x4624f5(0x32a)]=0x1773]='ENSURE_SNAPSHOT_EXECUTION',_0x5ceda4[_0x5ceda4[_0x4624f5(0x22d)]=0x1b59]=_0x4624f5(0x22d),_0x5ceda4[_0x5ceda4[_0x4624f5(0x39b)]=0x1b5a]=_0x4624f5(0x39b),_0x5ceda4[_0x5ceda4[_0x4624f5(0x365)]=0x1b5b]=_0x4624f5(0x365),_0x5ceda4[_0x5ceda4[_0x4624f5(0x2df)]=0x1b5c]='APPLY_PERMISSION_DENIED',_0x5ceda4[_0x5ceda4[_0x4624f5(0x21f)]=0x1b5d]='APPLY_DUPLICATED',_0x5ceda4[_0x5ceda4['CONNECTOR_DATA_TOO_LARGE']=0x1f41]=_0x4624f5(0x2ed),_0x5ceda4[_0x5ceda4[_0x4624f5(0x1e7)]=0x2329]=_0x4624f5(0x1e7),_0x5ceda4[_0x5ceda4['LICENSE_MAX_MEMBERS_PER_UNIT_EXCEEDED']=0x232a]=_0x4624f5(0x46e),_0x5ceda4[_0x5ceda4['LICENSE_IMPORT_SIZE_EXCEEDED']=0x232b]=_0x4624f5(0x248),_0x5ceda4[_0x5ceda4['LICENSE_EXPORT_SIZE_EXCEEDED']=0x232c]=_0x4624f5(0x20f),_0x5ceda4[_0x5ceda4['LICENSE_DISTRO_REJECTED']=0x232d]=_0x4624f5(0x347),_0x5ceda4[_0x5ceda4[_0x4624f5(0x2d6)]=0x2711]=_0x4624f5(0x2d6),_0x5ceda4[_0x5ceda4[_0x4624f5(0x257)]=0x2712]=_0x4624f5(0x257),_0x5ceda4[_0x5ceda4[_0x4624f5(0x3ca)]=0x2713]=_0x4624f5(0x3ca),_0x5ceda4[_0x5ceda4[_0x4624f5(0x1f1)]=0x2714]='YUUMI_SUBSCRIPTION_NOT_FOUND',_0x5ceda4[_0x5ceda4[_0x4624f5(0x235)]=0x271a]=_0x4624f5(0x235),_0x5ceda4[_0x5ceda4[_0x4624f5(0x1cf)]=0x271b]=_0x4624f5(0x1cf),_0x5ceda4[_0x5ceda4[_0x4624f5(0x291)]=0x271c]=_0x4624f5(0x291),_0x5ceda4[_0x5ceda4[_0x4624f5(0x2ad)]=0x271d]=_0x4624f5(0x2ad),_0x5ceda4[_0x5ceda4[_0x4624f5(0x262)]=0x271e]='YUUMI_PROMPT_MAX_TOKENS_EXCEEDED',_0x5ceda4[_0x5ceda4['YUUMI_AI_RUN_FAILED']=0x271f]='YUUMI_AI_RUN_FAILED',_0x5ceda4[_0x5ceda4[_0x4624f5(0x2e4)]=0x2720]=_0x4624f5(0x2e4),_0x5ceda4[_0x5ceda4[_0x4624f5(0x473)]=0x2af9]=_0x4624f5(0x473),_0x5ceda4[_0x5ceda4[_0x4624f5(0x229)]=0x2ee1]='INVITE_CODE_HAS_BEEN_UES',_0x5ceda4[_0x5ceda4['INVALID_INVITE_CODE']=0x2ee2]='INVALID_INVITE_CODE',_0x5ceda4[_0x5ceda4[_0x4624f5(0x2a3)]=0x2ee3]=_0x4624f5(0x2a3),_0x5ceda4[_0x5ceda4['USER_NOT_INVITED_CODE']=0x2ee4]='USER_NOT_INVITED_CODE',_0x5ceda4[_0x5ceda4[_0x4624f5(0x2fb)]=0x2ee5]=_0x4624f5(0x2fb),_0x5ceda4[_0x5ceda4['WECHAT_HAS_BEEN_BOUND']=0x32c9]=_0x4624f5(0x2c1),_0x5ceda4[_0x5ceda4[_0x4624f5(0x277)]=0x32ca]=_0x4624f5(0x277),_0x5ceda4[_0x5ceda4['EMAIL_HAS_BEEN_BOUND']=0x32cb]='EMAIL_HAS_BEEN_BOUND',_0x5ceda4[_0x5ceda4['ENTITLE_CAN_NOT_BUY_LOWER_OTP']=0x36b1]=_0x4624f5(0x2ea),_0x5ceda4[_0x5ceda4[_0x4624f5(0x1ee)]=0x36b2]=_0x4624f5(0x1ee),_0x5ceda4[_0x5ceda4[_0x4624f5(0x1de)]=0x36b3]=_0x4624f5(0x1de),_0x5ceda4[_0x5ceda4[_0x4624f5(0x3b7)]=0x36b4]=_0x4624f5(0x3b7),_0x5ceda4[_0x5ceda4[_0x4624f5(0x3e6)]=0x3715]=_0x4624f5(0x3e6),_0x5ceda4[_0x5ceda4[_0x4624f5(0x2f9)]=0x3716]=_0x4624f5(0x2f9),_0x5ceda4[_0x5ceda4[_0x4624f5(0x385)]=0x3717]=_0x4624f5(0x385),_0x5ceda4[_0x5ceda4[_0x4624f5(0x369)]=0x37dd]=_0x4624f5(0x369),_0x5ceda4[_0x5ceda4[_0x4624f5(0x232)]=0x3a99]=_0x4624f5(0x232),_0x5ceda4[_0x5ceda4[_0x4624f5(0x3f7)]=0x3a9a]=_0x4624f5(0x3f7),_0x5ceda4[_0x5ceda4[_0x4624f5(0x41c)]=0x3a9b]=_0x4624f5(0x41c),_0x5ceda4[_0x5ceda4[_0x4624f5(0x268)]=0x3a9c]=_0x4624f5(0x268),_0x5ceda4[_0x5ceda4['REDEMPTION_USER_NOT_ELIGIBLE']=0x3a9d]=_0x4624f5(0x388),_0x5ceda4[_0x5ceda4[_0x4624f5(0x423)]=0x3a9e]='REDEMPTION_USER_REDEEM_TIMES_EXCEED',_0x5ceda4[_0x5ceda4[_0x4624f5(0x336)]=0x3a9f]='REDEMPTION_CODE_HAS_BEEN_CREATED',_0x5ceda4[_0x5ceda4['DATA_SOURCE_TOO_LARGE']=0x3e81]=_0x4624f5(0x29e),_0x5ceda4[_0x5ceda4['UNRECOGNIZED']=-0x1]='UNRECOGNIZED',_0x5ceda4))(_0x5a1443||{});function _0x5b982b(_0x29df05){const _0x345493=_0x4624f5;var _0x45588c,_0x970d53;const _0x1f327b=(_0x45588c=_0x29df05[_0x345493(0x42a)])==null?void 0x0:_0x45588c[_0x345493(0x3bb)],_0x2c4028=((_0x970d53=_0x29df05[_0x345493(0x42a)])==null?void 0x0:_0x970d53[_0x345493(0x42b)])||0x0;return _0x1f327b===_0x50020c[_0x345493(0x416)][_0x345493(0x41d)]&&_0x2c4028>0x0;}function _0x2088f2(_0x2ce4d7){const _0x2abe2c=_0x4624f5;return _0x2ce4d7['functionsExecutedState']===_0x50020c[_0x2abe2c(0x3c4)][_0x2abe2c(0x44d)];}var _0x2ac3f3=Object['getOwnPropertyDescriptor'],_0x4d9d48=(_0x1a34ef,_0x341851,_0x3aa090,_0x50e4e7)=>{const _0x24d6a4=_0x4624f5;for(var _0x42d82f=_0x50e4e7>0x1?void 0x0:_0x50e4e7?_0x2ac3f3(_0x341851,_0x3aa090):_0x341851,_0x3e055d=_0x1a34ef[_0x24d6a4(0x1e5)]-0x1,_0x207251;_0x3e055d>=0x0;_0x3e055d--)(_0x207251=_0x1a34ef[_0x3e055d])&&(_0x42d82f=_0x207251(_0x42d82f)||_0x42d82f);return _0x42d82f;},_0x18dac4=(_0x2ce19b,_0x2476ef)=>(_0x245232,_0x10710c)=>_0x2476ef(_0x245232,_0x10710c,_0x2ce19b);const _0x3f8613='/universer-api/license/formula/limit/status',_0x446ba0=_0x4624f5(0x299),_0x14fb45=_0x4624f5(0x392);let _0x35cb3d=class extends _0x161ac6[_0x4624f5(0x482)]{constructor(_0x58b5e9,_0x2d38f9,_0x2dad49,_0x1610d,_0x12a469,_0x4a1ef0,_0x2b95d1){const _0xfff95b=_0x4624f5;super(),_0x47bfcc(this,_0xfff95b(0x44f),null),_0x47bfcc(this,_0xfff95b(0x320),0x0),_0x47bfcc(this,_0xfff95b(0x3c3),0x0),_0x47bfcc(this,_0xfff95b(0x3f3),[]),_0x47bfcc(this,_0xfff95b(0x389),0x0),(this[_0xfff95b(0x47b)]=_0x58b5e9,this[_0xfff95b(0x43a)]=_0x2d38f9,this[_0xfff95b(0x415)]=_0x2dad49,this[_0xfff95b(0x373)]=_0x1610d,this[_0xfff95b(0x485)]=_0x12a469,this[_0xfff95b(0x3a2)]=_0x4a1ef0,this[_0xfff95b(0x23c)]=_0x2b95d1,this[_0xfff95b(0x202)]());}[_0x4624f5(0x202)](){const _0x17e65a=_0x4624f5;this[_0x17e65a(0x30f)](this['_commandService'][_0x17e65a(0x355)]((_0x46da84,_0x3904e2)=>{const _0x548cd2=_0x17e65a;var _0x43c55a;if(_0x46da84['id']!==_0x50020c['SetFormulaCalculationStartMutation']['id'])return;const _0x40e99a=_0x46da84['params'];if(!this[_0x548cd2(0x24b)]((_0x43c55a=_0x40e99a[_0x548cd2(0x39c)])!=null?_0x43c55a:[]))return;if(!this[_0x548cd2(0x2af)]())throw this['_checkAndWaitForCalculationPermission'](_0x46da84,_0x3904e2),this[_0x548cd2(0x1ec)](),new _0x161ac6[(_0x548cd2(0x3e8))]();})),this[_0x17e65a(0x30f)](this[_0x17e65a(0x43a)][_0x17e65a(0x391)]((_0x11799f,_0x5c6828)=>{const _0x55ff92=_0x17e65a;if(_0x11799f['id']!==_0x50020c[_0x55ff92(0x1ce)]['id'])return;const _0x20c17e=_0x11799f[_0x55ff92(0x276)];if(_0x5b982b(_0x20c17e)){const _0x235f3a=_0x161ac6[_0x55ff92(0x497)]();this[_0x55ff92(0x3f3)]['push'](_0x235f3a),this[_0x55ff92(0x20d)](_0x235f3a);}else{if(_0x2088f2(_0x20c17e)&&this[_0x55ff92(0x3f3)][_0x55ff92(0x1e5)]>0x0){const _0x1f3da8=this[_0x55ff92(0x3f3)][_0x55ff92(0x35c)]();this[_0x55ff92(0x1d4)](_0x1f3da8);}}}));}[_0x4624f5(0x214)](){const _0x23ce92=_0x4624f5;super[_0x23ce92(0x214)](),this[_0x23ce92(0x3e9)](),this[_0x23ce92(0x3f3)]=[],this[_0x23ce92(0x3c3)]=0x0,this[_0x23ce92(0x320)]=0x0,this[_0x23ce92(0x389)]=0x0;}async[_0x4624f5(0x45f)](_0x101b15,_0x4c4502){const _0x69e3cd=_0x4624f5;for(let _0x1f82d6=0x0;_0x1f82d6<0x1e;_0x1f82d6++)try{if(await this[_0x69e3cd(0x459)](),this['_checkCalculationAvailable']()){this[_0x69e3cd(0x47a)](_0x101b15,_0x4c4502),this[_0x69e3cd(0x47b)][_0x69e3cd(0x27d)]({'content':this[_0x69e3cd(0x23c)]['t']('formula.calculation.started'),'type':_0x37af48[_0x69e3cd(0x366)][_0x69e3cd(0x292)]});return;}await new Promise(_0xc5a6ab=>{const _0x21d217=_0x69e3cd;this[_0x21d217(0x44f)]=window['setTimeout'](_0xc5a6ab,0x3e8);});}catch(_0x16db0a){this[_0x69e3cd(0x3a2)][_0x69e3cd(0x3ff)](_0x16db0a);}this[_0x69e3cd(0x47b)][_0x69e3cd(0x27d)]({'content':this[_0x69e3cd(0x23c)]['t']('formula.calculation.unable'),'type':_0x37af48[_0x69e3cd(0x366)][_0x69e3cd(0x368)]});}['_applyCommand'](_0x55cf87,_0x4620fa){const _0x531796=_0x4624f5;try{this[_0x531796(0x43a)][_0x531796(0x225)](_0x55cf87['id'],_0x55cf87[_0x531796(0x276)],_0x4620fa);}catch(_0x5b95c0){this[_0x531796(0x3a2)][_0x531796(0x3ff)](_0x5b95c0);}}[_0x4624f5(0x237)](_0x327078,_0x40d1be){const _0x43e82c=_0x4624f5;_0x40d1be<this[_0x43e82c(0x389)]||(this[_0x43e82c(0x389)]=_0x40d1be,this[_0x43e82c(0x320)]=Number[_0x43e82c(0x3ab)](_0x327078[_0x43e82c(0x2e7)]),this[_0x43e82c(0x3c3)]=Number['parseInt'](_0x327078['currentUsage']));}async[_0x4624f5(0x20d)](_0x4e5f43){const _0x4b7fe2=_0x4624f5;var _0x34fcc9,_0x5dd860;const _0x4a35a6=Date[_0x4b7fe2(0x480)]();try{const _0x3eaa02=((_0x34fcc9=this[_0x4b7fe2(0x415)]['getConfig'](_0x46104e['COLLABORATION_CLIENT_PLUGIN_CONFIG_KEY']))==null?void 0x0:_0x34fcc9[_0x4b7fe2(0x43f)])||_0x446ba0,_0x24ec91=(await this['_httpService']['post'](_0x3eaa02,{'body':JSON[_0x4b7fe2(0x3e3)]({'taskId':_0x4e5f43})}))['body'];if(((_0x5dd860=_0x24ec91['error'])==null?void 0x0:_0x5dd860[_0x4b7fe2(0x429)])!==_0x5a1443['OK'])return;this[_0x4b7fe2(0x237)](_0x24ec91[_0x4b7fe2(0x410)],_0x4a35a6);}catch(_0x29ceba){this['_logService'][_0x4b7fe2(0x3ff)](_0x29ceba);}}async[_0x4624f5(0x459)](_0x30eb24){const _0x23e231=_0x4624f5;var _0x376444,_0x3d42dc;const _0x1d2c48=Date['now']();try{const _0x348652=((_0x376444=this[_0x23e231(0x415)][_0x23e231(0x310)](_0x46104e[_0x23e231(0x33c)]))==null?void 0x0:_0x376444[_0x23e231(0x33b)])||_0x3f8613,_0x40014e=_0x30eb24?_0x348652+'?taskId='+encodeURIComponent(_0x30eb24):_0x348652,_0x1d04c7=(await this[_0x23e231(0x373)][_0x23e231(0x333)](_0x40014e))[_0x23e231(0x3d0)];if(((_0x3d42dc=_0x1d04c7[_0x23e231(0x3ff)])==null?void 0x0:_0x3d42dc['code'])!==_0x5a1443['OK'])return;this['_setFormulaLimitStatus'](_0x1d04c7[_0x23e231(0x410)],_0x1d2c48);}catch(_0x308174){this[_0x23e231(0x3a2)]['error'](_0x308174);}}async['_releaseCalculationLimit'](_0x51cea0){const _0x348fd5=_0x4624f5;var _0x3ad1c9,_0x2f7f0a;const _0x4295ff=Date['now']();try{const _0x150e09=((_0x3ad1c9=this['_configService'][_0x348fd5(0x310)](_0x46104e[_0x348fd5(0x33c)]))==null?void 0x0:_0x3ad1c9[_0x348fd5(0x1eb)])||_0x14fb45,_0x5381c1=(await this[_0x348fd5(0x373)]['post'](_0x150e09,{'body':JSON[_0x348fd5(0x3e3)]({'taskId':_0x51cea0})}))['body'];if(((_0x2f7f0a=_0x5381c1['error'])==null?void 0x0:_0x2f7f0a[_0x348fd5(0x429)])!==_0x5a1443['OK'])return;this['_setFormulaLimitStatus'](_0x5381c1[_0x348fd5(0x410)],_0x4295ff);}catch(_0x38cbc7){this[_0x348fd5(0x3a2)][_0x348fd5(0x3ff)](_0x38cbc7);}}[_0x4624f5(0x2af)](){const _0x4a6dae=_0x4624f5;return this[_0x4a6dae(0x320)]===0x0?!0x0:this['_maxFormulaLimit']-this[_0x4a6dae(0x3c3)]>0x0;}[_0x4624f5(0x3e9)](){const _0x317336=_0x4624f5;this[_0x317336(0x44f)]&&(clearTimeout(this[_0x317336(0x44f)]),this[_0x317336(0x44f)]=null);}[_0x4624f5(0x1ec)](){const _0x2f312c=_0x4624f5;this[_0x2f312c(0x47b)][_0x2f312c(0x27d)]({'content':this[_0x2f312c(0x23c)]['t']('formula.calculation.waiting'),'type':_0x37af48[_0x2f312c(0x366)][_0x2f312c(0x3ee)]});}[_0x4624f5(0x24b)](_0x16db6e){const _0x52a069=_0x4624f5;for(const _0x4780fc of _0x16db6e){const {unitId:_0x3a0bb8,sheetId:_0x5cf83c,range:_0x120e3d}=_0x4780fc,_0x930c3e=this[_0x52a069(0x485)][_0x52a069(0x3cb)](_0x3a0bb8);if(!_0x930c3e)continue;const _0x276474=_0x930c3e['getSheetBySheetId'](_0x5cf83c);if(!_0x276474)continue;const _0x1bbdad=_0x276474[_0x52a069(0x263)]();for(let _0x530494=_0x120e3d['startRow'];_0x530494<=_0x120e3d[_0x52a069(0x3fc)];_0x530494++)for(let _0x46a3e3=_0x120e3d[_0x52a069(0x2cd)];_0x46a3e3<=_0x120e3d[_0x52a069(0x3f9)];_0x46a3e3++){const _0x288878=_0x1bbdad[_0x52a069(0x3dc)](_0x530494,_0x46a3e3);if(_0x288878&&(_0x161ac6[_0x52a069(0x326)](_0x288878['f'])||_0x161ac6[_0x52a069(0x321)](_0x288878['si'])))return!0x0;}}return!0x1;}};_0x35cb3d=_0x4d9d48([_0x18dac4(0x0,_0x161ac6[_0x4624f5(0x2b0)](_0x4291c6[_0x4624f5(0x337)])),_0x18dac4(0x1,_0x161ac6[_0x4624f5(0x41a)]),_0x18dac4(0x2,_0x161ac6[_0x4624f5(0x343)]),_0x18dac4(0x3,_0x161ac6[_0x4624f5(0x2b0)](_0x4db2d9[_0x4624f5(0x30d)])),_0x18dac4(0x4,_0x161ac6[_0x4624f5(0x37d)]),_0x18dac4(0x5,_0x161ac6[_0x4624f5(0x210)]),_0x18dac4(0x6,_0x161ac6['Inject'](_0x161ac6[_0x4624f5(0x25a)]))],_0x35cb3d);var _0xfc29a9=Object[_0x4624f5(0x272)],_0x178809=(_0x2a0a4b,_0x5dbc4a,_0x47e7da,_0x3e573c)=>{const _0x4484a3=_0x4624f5;for(var _0x246796=_0x3e573c>0x1?void 0x0:_0x3e573c?_0xfc29a9(_0x5dbc4a,_0x47e7da):_0x5dbc4a,_0x289a78=_0x2a0a4b[_0x4484a3(0x1e5)]-0x1,_0x584463;_0x289a78>=0x0;_0x289a78--)(_0x584463=_0x2a0a4b[_0x289a78])&&(_0x246796=_0x584463(_0x246796)||_0x246796);return _0x246796;},_0x56963f=(_0x45f3f1,_0x44dc63)=>(_0x453083,_0x2acc20)=>_0x44dc63(_0x453083,_0x2acc20,_0x45f3f1);let _0x4673bd=class extends _0x161ac6[_0x4624f5(0x482)]{constructor(_0x546d27,_0x5603fb,_0x499217){const _0x763431=_0x4624f5;super(),_0x47bfcc(this,_0x763431(0x3ce),new Map()),_0x47bfcc(this,_0x763431(0x1fb),new Map()),_0x47bfcc(this,'_disabled',!0x1),(this[_0x763431(0x415)]=_0x546d27,this[_0x763431(0x2f2)]=_0x5603fb,this[_0x763431(0x25c)]=_0x499217);}[_0x4624f5(0x448)](){this['_disabled']=!0x0;}[_0x4624f5(0x35a)](){this['_disabled']=!0x1;}get['saveTaskMap'](){return this['_saveTaskMap'];}[_0x4624f5(0x214)](){const _0x3e2c85=_0x4624f5;this[_0x3e2c85(0x324)]()[_0x3e2c85(0x2e0)](()=>super[_0x3e2c85(0x214)]());}async['loadOfflineData'](_0x2694b9){const _0x1eb06f=_0x4624f5;return this['_disabled']?null:this['_localStorageService'][_0x1eb06f(0x3d6)](_0x46104e[_0x1eb06f(0x319)](_0x2694b9));}async[_0x4624f5(0x311)](_0x5315e4,_0x2ae806){const _0x49aa6d=_0x4624f5;return!!this[_0x49aa6d(0x2f2)][_0x49aa6d(0x332)](_0x5315e4,_0x2ae806);}['updateOfflineData'](_0xfd2cab,_0x561fea,_0x40a660,_0x2413ff){const _0x414ed8=_0x4624f5,_0x5a1758=this[_0x414ed8(0x25c)]['getCurrentRevOfUnit'](_0xfd2cab);this[_0x414ed8(0x3ce)]['set'](_0xfd2cab,{'unitID':_0xfd2cab,'type':_0x561fea,'awaitingChangeset':_0x40a660,'mutations':_0x2413ff,'rev':_0x5a1758}),this[_0x414ed8(0x1fb)][_0x414ed8(0x390)](_0xfd2cab)||this[_0x414ed8(0x456)](_0xfd2cab);}[_0x4624f5(0x456)](_0x3083e4){const _0x368b10=_0x4624f5,_0x198619=this[_0x368b10(0x300)]();_0x198619===0x0?this[_0x368b10(0x3b6)](_0x3083e4):this[_0x368b10(0x1fb)][_0x368b10(0x3d5)](_0x3083e4,setTimeout(()=>this[_0x368b10(0x3b6)](_0x3083e4),_0x198619));}['_getSaveTimeout'](){const _0x516b3e=_0x4624f5;var _0x43ba0a;return(_0x43ba0a=this[_0x516b3e(0x415)]['getConfig'](_0x46104e['LOCAL_CACHE_INTERVAL_KEY']))!=null?_0x43ba0a:_0x46104e['LOCAL_CACHE_INTERVAL'];}[_0x4624f5(0x3b6)](_0x1c13ea){const _0x4decf5=_0x4624f5,_0x4dc18b=this[_0x4decf5(0x1fb)]['get'](_0x1c13ea);return _0x4dc18b!==void 0x0&&window[_0x4decf5(0x435)](_0x4dc18b),this[_0x4decf5(0x2f2)]['setItem'](_0x46104e['getLocalCacheKey'](_0x1c13ea),this[_0x4decf5(0x3ce)][_0x4decf5(0x333)](_0x1c13ea))[_0x4decf5(0x2e0)](()=>this[_0x4decf5(0x1fb)][_0x4decf5(0x40e)](_0x1c13ea));}async[_0x4624f5(0x324)](){const _0x12cfb7=_0x4624f5,_0x3e7908=[];this[_0x12cfb7(0x1fb)]['forEach']((_0x385f05,_0x4038a9)=>{const _0x5ca9ac=_0x12cfb7;window['clearTimeout'](_0x385f05),_0x3e7908[_0x5ca9ac(0x426)](this[_0x5ca9ac(0x3b6)](_0x4038a9)[_0x5ca9ac(0x2e0)](()=>{const _0x781732=_0x5ca9ac;this[_0x781732(0x1fb)][_0x781732(0x40e)](_0x4038a9);}));}),await Promise[_0x12cfb7(0x42e)](_0x3e7908);}};_0x4673bd=_0x178809([_0x56963f(0x0,_0x161ac6[_0x4624f5(0x343)]),_0x56963f(0x1,_0x161ac6[_0x4624f5(0x2ee)]),_0x56963f(0x2,_0x161ac6['Inject'](_0x48fdef['RevisionService']))],_0x4673bd);class _0x49e0db extends _0x161ac6['RxDisposable']{constructor(){const _0x17f0c9=_0x4624f5;super(),_0x47bfcc(this,_0x17f0c9(0x23e)),this[_0x17f0c9(0x23e)]=_0x66cc31[_0x17f0c9(0x38d)](window,_0x17f0c9(0x3a5))[_0x17f0c9(0x1ef)](_0x66cc31[_0x17f0c9(0x45d)](this[_0x17f0c9(0x289)]),_0x66cc31[_0x17f0c9(0x496)](0x1),_0x66cc31[_0x17f0c9(0x46b)](void 0x0));}[_0x4624f5(0x2c9)](_0x448091,_0x14555d,_0x5ce2c9=!0x1){const _0x10e6be=_0x4624f5,_0x14b27e=new URL(window[_0x10e6be(0x227)][_0x10e6be(0x33e)]);_0x14b27e['searchParams'][_0x10e6be(0x3d5)](_0x448091,_0x14555d),_0x5ce2c9?window['history'][_0x10e6be(0x445)]('','',_0x14b27e['toString']()):window['history']['pushState']('','',_0x14b27e[_0x10e6be(0x266)]());}[_0x4624f5(0x39d)](_0x85c3d8,_0x540f59=!0x1){const _0x3b5705=_0x4624f5,_0x3b51b3=new URL(window['location'][_0x3b5705(0x33e)]);_0x3b51b3[_0x3b5705(0x357)]['delete'](_0x85c3d8),_0x540f59?window[_0x3b5705(0x3c6)][_0x3b5705(0x445)]('','',_0x3b51b3['toString']()):window['history'][_0x3b5705(0x3fb)]('','',_0x3b51b3[_0x3b5705(0x266)]());}[_0x4624f5(0x3cd)](_0x1a6025){const _0x58f1aa=_0x4624f5;var _0x2bd162;return(_0x2bd162=new URL(window['location'][_0x58f1aa(0x33e)])[_0x58f1aa(0x357)][_0x58f1aa(0x333)](_0x1a6025))!=null?_0x2bd162:void 0x0;}}var _0x2cdf0a=Object[_0x4624f5(0x340)],_0x1a810a=Object['getOwnPropertyDescriptor'],_0x49289e=(_0x32a4ee,_0x2a34ac,_0x59f67e)=>_0x2a34ac in _0x32a4ee?_0x2cdf0a(_0x32a4ee,_0x2a34ac,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0x59f67e}):_0x32a4ee[_0x2a34ac]=_0x59f67e,_0x4057e8=(_0x41faf3,_0x45e67e,_0x3447d1,_0x410bed)=>{const _0x11c49b=_0x4624f5;for(var _0x1fbf22=_0x410bed>0x1?void 0x0:_0x410bed?_0x1a810a(_0x45e67e,_0x3447d1):_0x45e67e,_0x4efb20=_0x41faf3[_0x11c49b(0x1e5)]-0x1,_0x4ed5ce;_0x4efb20>=0x0;_0x4efb20--)(_0x4ed5ce=_0x41faf3[_0x4efb20])&&(_0x1fbf22=_0x4ed5ce(_0x1fbf22)||_0x1fbf22);return _0x1fbf22;},_0x45387b=(_0x41761c,_0x1ee7b3)=>(_0x4d0bbc,_0xfe0718)=>_0x1ee7b3(_0x4d0bbc,_0xfe0718,_0x41761c),_0x5efc18=(_0x502a18,_0x32440e,_0x52311d)=>_0x49289e(_0x502a18,_0x32440e+'',_0x52311d);const _0x2e2247='UNIVER_COLLABORATION_CLIENT_WEB_PLUGIN';_0x46875a['UniverCollaborationClientUIPlugin']=class extends _0x161ac6[_0x4624f5(0x24a)]{constructor(_0x367569=_0xbf724b,_0x3f7d35,_0x11a6d0,_0x54f727){const _0x147342=_0x4624f5;super(),this[_0x147342(0x419)]=_0x367569,this[_0x147342(0x338)]=_0x3f7d35,this['_injector']=_0x11a6d0,this['_configService']=_0x54f727;const {..._0x5eeb18}=_0x161ac6[_0x147342(0x348)]({},_0xbf724b,this['_config']);this[_0x147342(0x415)][_0x147342(0x441)](_0x2f76a0,_0x5eeb18);}['onStarting'](){const _0x4a5d5d=_0x4624f5;this[_0x4a5d5d(0x325)](),this[_0x4a5d5d(0x40b)]();}[_0x4624f5(0x43d)](){const _0x4d862f=_0x4624f5;this[_0x4d862f(0x286)]();}[_0x4624f5(0x325)](){const _0x40b94f=_0x4624f5;var _0xc12153;const _0x4267be=[[_0x1846fc],[_0x35cb3d],[_0x16e8f2],[_0x6698d6],[_0xa7a54c],[_0x360498],[_0x5a3a5f,{'useClass':_0x49e0db}],[_0x4db2d9[_0x40b94f(0x3be)],{'useClass':_0x4db2d9[_0x40b94f(0x239)]}],[_0x46104e[_0x40b94f(0x49d)],{'useClass':_0x4673bd}],[_0x46875a[_0x40b94f(0x492)]],[_0x41f840],[_0x1a48d1],[_0x1508be],[_0x665a7a],[_0x46875a['CollaborationDataLoaderController']]];_0x161ac6[_0x40b94f(0x381)](this[_0x40b94f(0x298)],_0x161ac6['mergeOverrideWithDependencies'](_0x4267be,(_0xc12153=this['_config'])==null?void 0x0:_0xc12153[_0x40b94f(0x280)]));}[_0x4624f5(0x286)](){const _0x511404=_0x4624f5;this[_0x511404(0x30f)](this[_0x511404(0x338)]['registerRenderModule'](_0x161ac6[_0x511404(0x2d9)][_0x511404(0x23d)],[_0x47d0f4])),this[_0x511404(0x30f)](this['_renderManagerService']['registerRenderModule'](_0x161ac6[_0x511404(0x2d9)][_0x511404(0x28b)],[_0x2d665f]));}[_0x4624f5(0x40b)](){const _0x1aa9a8=_0x4624f5;_0x161ac6[_0x1aa9a8(0x301)](this[_0x1aa9a8(0x298)],[[_0x1508be],[_0x46875a[_0x1aa9a8(0x492)]],[_0x41f840],[_0x1a48d1],[_0x46875a[_0x1aa9a8(0x25f)]],[_0x35cb3d]]);}},_0x5efc18(_0x46875a['UniverCollaborationClientUIPlugin'],'pluginName',_0x2e2247),_0x46875a[_0x4624f5(0x3ae)]=_0x4057e8([_0x161ac6[_0x4624f5(0x48f)](_0x46104e[_0x4624f5(0x1db)]),_0x45387b(0x1,_0x1fade8['IRenderManagerService']),_0x45387b(0x2,_0x161ac6['Inject'](_0x161ac6[_0x4624f5(0x2c2)])),_0x45387b(0x3,_0x161ac6[_0x4624f5(0x343)])],_0x46875a[_0x4624f5(0x3ae)]);var _0x4c2125=Object['getOwnPropertyDescriptor'],_0x6768c0=(_0x27b955,_0x42dc63,_0x1c9e69,_0x567291)=>{const _0x20b807=_0x4624f5;for(var _0x80e7d9=_0x567291>0x1?void 0x0:_0x567291?_0x4c2125(_0x42dc63,_0x1c9e69):_0x42dc63,_0x347aeb=_0x27b955[_0x20b807(0x1e5)]-0x1,_0x435d90;_0x347aeb>=0x0;_0x347aeb--)(_0x435d90=_0x27b955[_0x347aeb])&&(_0x80e7d9=_0x435d90(_0x80e7d9)||_0x80e7d9);return _0x80e7d9;},_0x53b6af=(_0x3e492b,_0x57d939)=>(_0x3b8d27,_0x8b69c3)=>_0x57d939(_0x3b8d27,_0x8b69c3,_0x3e492b);_0x46875a[_0x4624f5(0x417)]=class extends _0x46104e[_0x4624f5(0x314)]{constructor(_0x184e66,_0x2bf2ad,_0x4d1552,_0x403921,_0x58e700){super(_0x184e66,_0x2bf2ad,_0x4d1552,_0x403921,_0x58e700);}async[_0x4624f5(0x408)](_0x4be928){const _0x637255=_0x4624f5,_0x1ffe02=await this[_0x637255(0x1d9)](),_0xb0ee1d=this['_createSocketURL'](_0x4be928,_0x1ffe02);return this[_0x637255(0x2db)](_0xb0ee1d);}[_0x4624f5(0x431)](_0x1cc26e,_0x18ee55){const _0x2144f5=_0x4624f5,_0x70f96c=typeof window>'u'?new URL(_0x1cc26e):new URL(_0x1cc26e,window['location']['origin']);_0x70f96c[_0x2144f5(0x357)][_0x2144f5(0x3d5)](_0x2144f5(0x2d2),_0x18ee55);const _0x157335=typeof window>'u'?new URLSearchParams():new URLSearchParams(window['location']['search']);return _0x157335[_0x2144f5(0x333)](_0x2144f5(0x2da))&&_0x70f96c['searchParams'][_0x2144f5(0x3d5)](_0x2144f5(0x2da),_0x157335[_0x2144f5(0x333)](_0x2144f5(0x2da))),_0x70f96c[_0x2144f5(0x266)]();}async['_getSessionTicket'](){const _0x36f71d=_0x4624f5;var _0x37994d,_0x40a5c4,_0x554bc4;const _0x2102bc=this['_configService'][_0x36f71d(0x310)](_0x46104e[_0x36f71d(0x33c)]),_0x5c35b7=(_0x37994d=_0x2102bc==null?void 0x0:_0x2102bc[_0x36f71d(0x35f)])!=null?_0x37994d:_0x46104e[_0x36f71d(0x2a2)];return(_0x554bc4=(_0x40a5c4=(await this[_0x36f71d(0x373)]['get'](_0x5c35b7,{'headers':{'Content-Type':_0x36f71d(0x48b)}}))[_0x36f71d(0x3d0)])==null?void 0x0:_0x40a5c4['ticket'])!=null?_0x554bc4:'';}},_0x46875a[_0x4624f5(0x417)]=_0x6768c0([_0x53b6af(0x0,_0x161ac6[_0x4624f5(0x2b0)](_0x161ac6[_0x4624f5(0x2c2)])),_0x53b6af(0x1,_0x161ac6[_0x4624f5(0x2b0)](_0x4db2d9[_0x4624f5(0x30d)])),_0x53b6af(0x2,_0x161ac6[_0x4624f5(0x343)]),_0x53b6af(0x3,_0x161ac6[_0x4624f5(0x210)]),_0x53b6af(0x4,_0x48fdef['ISnapshotServerService'])],_0x46875a[_0x4624f5(0x417)]);var _0x1a0c68=Object[_0x4624f5(0x272)],_0x18e6da=(_0x5e0b66,_0x30c15b,_0x2feb64,_0x105b05)=>{const _0x146a5e=_0x4624f5;for(var _0x2d0d3b=_0x105b05>0x1?void 0x0:_0x105b05?_0x1a0c68(_0x30c15b,_0x2feb64):_0x30c15b,_0x4afebb=_0x5e0b66[_0x146a5e(0x1e5)]-0x1,_0x371b2d;_0x4afebb>=0x0;_0x4afebb--)(_0x371b2d=_0x5e0b66[_0x4afebb])&&(_0x2d0d3b=_0x371b2d(_0x2d0d3b)||_0x2d0d3b);return _0x2d0d3b;},_0x1c64a7=(_0x8106f,_0x486c9e)=>(_0x164830,_0x57913a)=>_0x486c9e(_0x164830,_0x57913a,_0x8106f);_0x46875a[_0x4624f5(0x3a4)]=class extends _0x161ac6[_0x4624f5(0x482)]{constructor(_0x50c1b9,_0x8c480e,_0x31eab8){const _0x2c81ee=_0x4624f5;super(),this[_0x2c81ee(0x34a)]=_0x50c1b9,this['_httpService']=_0x8c480e,this[_0x2c81ee(0x415)]=_0x31eab8;}async[_0x4624f5(0x294)](_0x59dece,_0x49782c,_0xde71e4,..._0x53bdf0){const _0x3fce4d=_0x4624f5;var _0x34e900,_0x5369d0,_0x5b9f56,_0x271a72;const _0x1f2a18=this[_0x3fce4d(0x34a)][_0x3fce4d(0x45a)]();if(!_0x1f2a18)throw new Error(_0x3fce4d(0x247));const _0x68dcb2=((_0x34e900=this[_0x3fce4d(0x415)][_0x3fce4d(0x310)](_0x46104e[_0x3fce4d(0x469)]))!=null?_0x34e900:_0x46104e[_0x3fce4d(0x26d)])+'/'+_0x59dece+_0x3fce4d(0x490)+_0x49782c,_0x138dcc=new URL(window[_0x3fce4d(0x227)]['href']),_0x4a9470={'scriptId':_0x59dece,'runId':(_0x5369d0=_0x138dcc[_0x3fce4d(0x357)][_0x3fce4d(0x333)](_0x3fce4d(0x2da)))!=null?_0x5369d0:'','function':_0x49782c,'unitId':_0x1f2a18['getUnitId'](),'argsOfFunction':JSON[_0x3fce4d(0x3e3)](_0x53bdf0),'invokeId':(_0x5b9f56=_0xde71e4['invokeId'])!=null?_0x5b9f56:'','executionId':(_0x271a72=_0xde71e4[_0x3fce4d(0x2ec)])!=null?_0x271a72:''};try{const _0x301675=await this['_httpService'][_0x3fce4d(0x376)](_0x68dcb2,{'body':_0x4a9470});return _0x301675[_0x3fce4d(0x3d0)][_0x3fce4d(0x3ff)]&&_0x301675[_0x3fce4d(0x3d0)][_0x3fce4d(0x3ff)]['code']!==_0x5a1443['OK']?_0x3fce4d(0x443):_0x301675[_0x3fce4d(0x3d0)][_0x3fce4d(0x233)];}catch{return _0x3fce4d(0x443);}}},_0x46875a['RemoteUniscriptService']=_0x18e6da([_0x1c64a7(0x0,_0x161ac6[_0x4624f5(0x37d)]),_0x1c64a7(0x1,_0x161ac6[_0x4624f5(0x2b0)](_0x4db2d9[_0x4624f5(0x30d)])),_0x1c64a7(0x2,_0x161ac6['IConfigService'])],_0x46875a[_0x4624f5(0x3a4)]);const _0x44039e=0x7530,_0x21dbfb='ACTIVE_UNIT_EVENT_CHANNEL';class _0xbd79a9 extends _0x161ac6['Disposable']{constructor(){const _0x4aed3f=_0x4624f5;super(),_0x47bfcc(this,_0x4aed3f(0x432),_0x161ac6[_0x4aed3f(0x497)]()),_0x47bfcc(this,_0x4aed3f(0x24f),new Set()),_0x47bfcc(this,'_unitOnClients',new Map()),_0x47bfcc(this,_0x4aed3f(0x40c),null),_0x47bfcc(this,'_clearOtherTimers',new Map()),_0x47bfcc(this,_0x4aed3f(0x29a),new Map()),this[_0x4aed3f(0x48d)]();}[_0x4624f5(0x214)](){const _0x591f57=_0x4624f5;super[_0x591f57(0x214)](),this[_0x591f57(0x1da)][_0x591f57(0x265)]((_0x275f63,_0x4b4519)=>this['_removeClearOtherTimer'](_0x4b4519)),this[_0x591f57(0x40c)]&&window[_0x591f57(0x2e3)](this[_0x591f57(0x40c)]);}[_0x4624f5(0x317)](_0xe4de9a){const _0x58534d=_0x4624f5;return this[_0x58534d(0x2c4)](_0xe4de9a)[_0x58534d(0x1ef)](_0x66cc31['distinctUntilChanged']());}[_0x4624f5(0x21c)](_0x5e63ad){const _0x5f20c8=_0x4624f5;this['_selfUnitIDs'][_0x5f20c8(0x36e)]===0x0&&this['_scheduleHeartbeat'](),this[_0x5f20c8(0x24f)]['add'](_0x5e63ad),this[_0x5f20c8(0x409)]({'type':0x0,'memberID':this[_0x5f20c8(0x432)],'unitIDs':[_0x5e63ad],'isForwarded':!0x1});}[_0x4624f5(0x353)](_0x5ea865){const _0x64953a=_0x4624f5;this[_0x64953a(0x24f)]['delete'](_0x5ea865),this[_0x64953a(0x24f)][_0x64953a(0x36e)]===0x0&&this[_0x64953a(0x40c)]&&window[_0x64953a(0x2e3)](this[_0x64953a(0x40c)]);}[_0x4624f5(0x48d)](){const _0x149284=_0x4624f5;this[_0x149284(0x30f)](_0x161ac6[_0x149284(0x2b9)](_0x66cc31[_0x149284(0x38d)](window,_0x149284(0x30a))[_0x149284(0x26b)](_0x281bc7=>{const _0x2df8c1=_0x149284;if(_0x281bc7[_0x2df8c1(0x220)]!==_0x21dbfb||!_0x281bc7[_0x2df8c1(0x2b1)])return;const _0x929690=JSON[_0x2df8c1(0x34e)](_0x281bc7['newValue']);this[_0x2df8c1(0x2a4)](_0x929690);}))),window[_0x149284(0x283)]('unload',()=>this[_0x149284(0x409)]({'type':0x1,'memberID':this['_id'],'unitIDs':Array['from'](this[_0x149284(0x24f)])}));}['_handleEvent'](_0x5df6d0){const _0x183c67=_0x4624f5;switch(_0x5df6d0[_0x183c67(0x35b)]){case 0x0:this[_0x183c67(0x1d6)](_0x5df6d0);break;case 0x1:this[_0x183c67(0x329)](_0x5df6d0);break;case 0x2:this[_0x183c67(0x3cf)](_0x5df6d0);break;}}[_0x4624f5(0x1d6)](_0x4973dc){const _0x546d0b=_0x4624f5,{unitIDs:_0x56e80b,memberID:_0x5b6ff2,isForwarded:_0x5ead33}=_0x4973dc;_0x56e80b['forEach'](_0x1d3542=>{const _0x4e05a1=_0x1a8e;if(!_0x5ead33&&this[_0x4e05a1(0x2e1)][_0x4e05a1(0x390)](_0x1d3542)&&this[_0x4e05a1(0x2c4)](_0x1d3542)[_0x4e05a1(0x3c9)](_0x46104e['UnitStatus'][_0x4e05a1(0x402)]),!this[_0x4e05a1(0x2e1)][_0x4e05a1(0x390)](_0x1d3542)||!this['_unitOnClients']['get'](_0x1d3542)[_0x4e05a1(0x390)](_0x5b6ff2)){const _0x291a9c=this['_unitOnClients'][_0x4e05a1(0x333)](_0x1d3542)||new Set();_0x291a9c[_0x4e05a1(0x455)](_0x5b6ff2),this[_0x4e05a1(0x2e1)][_0x4e05a1(0x3d5)](_0x1d3542,_0x291a9c),this[_0x4e05a1(0x48c)](_0x5b6ff2);}}),_0x5ead33||this['_send']({'type':0x0,'memberID':this[_0x546d0b(0x432)],'unitIDs':[...this[_0x546d0b(0x24f)]],'isForwarded':!0x0});}[_0x4624f5(0x48c)](_0x2b18c3){const _0x20f15d=_0x4624f5;this[_0x20f15d(0x380)](_0x2b18c3);const _0x3bc30d=window[_0x20f15d(0x1e6)](()=>{const _0xc6e11d=_0x20f15d;this['_unitOnClients'][_0xc6e11d(0x265)](_0x10676d=>{const _0x472708=_0xc6e11d;_0x10676d[_0x472708(0x40e)](_0x2b18c3);});},_0x44039e*0x2);this[_0x20f15d(0x1da)][_0x20f15d(0x3d5)](_0x2b18c3,_0x3bc30d);}[_0x4624f5(0x380)](_0x203423){const _0x125d12=_0x4624f5;if(this[_0x125d12(0x1da)][_0x125d12(0x390)](_0x203423)){const _0x2e9405=this[_0x125d12(0x1da)]['get'](_0x203423);_0x2e9405&&window['clearTimeout'](_0x2e9405),this[_0x125d12(0x1da)][_0x125d12(0x3d5)](_0x203423,null);}}[_0x4624f5(0x329)](_0xbbd737){const _0x24e1bd=_0x4624f5,{memberID:_0x4f2029,unitIDs:_0x430e1a}=_0xbbd737;_0x430e1a[_0x24e1bd(0x265)](_0x55b81e=>{const _0x909a1=_0x24e1bd;var _0x16a7c6;const _0xbb3476=this['_unitOnClients'][_0x909a1(0x333)](_0x55b81e);_0xbb3476&&(_0xbb3476['delete'](_0x4f2029),(_0x16a7c6=this['_ensureSubject'](_0x55b81e))==null||_0x16a7c6[_0x909a1(0x3c9)](_0xbb3476[_0x909a1(0x36e)]===0x0?_0x46104e[_0x909a1(0x2d3)][_0x909a1(0x1cb)]:_0x46104e[_0x909a1(0x2d3)][_0x909a1(0x402)]));}),this[_0x24e1bd(0x380)](_0x4f2029);}[_0x4624f5(0x3cf)](_0x2f8ed6){const _0x3921ff=_0x4624f5;this['_scheduleClearOtherTimer'](_0x2f8ed6[_0x3921ff(0x3de)]);}[_0x4624f5(0x409)](_0x47037d){localStorage['setItem'](_0x21dbfb,JSON['stringify'](_0x47037d));}[_0x4624f5(0x2d4)](){const _0x2a0d68=_0x4624f5;this['_heartbeatTimer']=window[_0x2a0d68(0x3ec)](()=>{const _0x4180d1=_0x2a0d68;this[_0x4180d1(0x409)]({'type':0x2,'memberID':this[_0x4180d1(0x432)]});},_0x44039e);}[_0x4624f5(0x2c4)](_0x3966ae){const _0x587623=_0x4624f5;return this['_unitStatus']['has'](_0x3966ae)||this[_0x587623(0x29a)]['set'](_0x3966ae,new _0x66cc31[(_0x587623(0x41e))](_0x46104e[_0x587623(0x2d3)][_0x587623(0x1cb)])),this[_0x587623(0x29a)][_0x587623(0x333)](_0x3966ae);}}_0x46875a['IURLService']=_0x5a3a5f,_0x46875a[_0x4624f5(0x359)]=_0x5c4987,_0x46875a['WebBrowserSingleActiveUnitService']=_0xbd79a9,_0x46875a[_0x4624f5(0x252)]=_0x49e0db,Object[_0x4624f5(0x340)](_0x46875a,Symbol[_0x4624f5(0x21b)],{'value':_0x4624f5(0x273)});}));function _0x1a8e(_0x56b0b5,_0xcea906){const _0x14a715=_0x14a7();return _0x1a8e=function(_0x1a8e47,_0x2f648c){_0x1a8e47=_0x1a8e47-0x1cb;let _0xf27d37=_0x14a715[_0x1a8e47];return _0xf27d37;},_0x1a8e(_0x56b0b5,_0xcea906);}function _0x14a7(){const _0x19ae58=['MOBILE_VERIFY_CODE_MISMATCH','CollaborationEvent','USER_NOT_FOUND','drawWith','getTypeOfUnitAdded$','_saveCache','PAYMENT_CHANNEL_NOT_SUPPORT','_collabCursorState$','UniverDesign','none','stage','replace','_notificationService','ISocketService','_transformUndoRedoStack','_themeService','_transformHistoryAndStateStack','transformRemoteChangeset','_currentUsage','FormulaExecutedStateType','textRanges','history','DocSelectionManagerService','UniverProCollaborationClient','next','YUUMI_RATE_OVER_LIMIT','getUnit','createElement','getParam','_cachedData','_handleHeartbeatEvent','body','range','getMemberID','_docTransformStateCacheService','_docTransformIMECacheService','set','getItem','transformMutation','getColorFromTheme','Shape','_hover','getViewport','getValue','AWAITING','memberID','_getSheetObject','setShapeProps','fillText','_entities','stringify','debounce','row','ENTITLE_CHAT_LIMIT_EXCEED','_status$','CanceledError','_clearPolling','_cursor','registerComponent','setInterval','cursorInfo$','Loading','12848760UgXbap','DocStateChangeManagerService','_setupBeforeClosingHandler','createInstance','_taskIds','_labelPosition','_syncEditingCollabCursorService','PENDING','REDEMPTION_CODE_INACTIVE','height','endColumn','event$','pushState','endRow','useDependency','RegularPolygon','error','univer-text-sm\x20univer-leading-8\x20univer-text-gray-600\x20dark:!univer-text-gray-200','@univerjs-pro/collaboration-client','OTHER_CLIENTS_EDITING','CLOSE_ROOM','_updateSubUnitFromURLParams','debounceTime','COLORS','_drawAnchor','createSocket','_send','defIds','_initDependencies','_heartbeatTimer','_initResize','delete','AUTHORIZE_CODE_ILLEGAL','limitInfo','BuiltInUIPart','_getMergeRange','_initEvent','div','_configService','FormulaExecuteStageType','BrowserCollaborationSocketService','send','_config','ICommandService','subUnitId','REDEMPTION_CODE_FULLY_REDEEMED','START_CALCULATION','BehaviorSubject','Optional','handleInsertRow','CollaborationUIEventService','collabCursorState$','REDEMPTION_USER_REDEEM_TIMES_EXCEED','_imageIoService','376572jdieHg','push','FromArray','ONLINE','code','stageInfo','totalFormulasToCalculate','fillStyle','hovered','all','values','handleDeleteRangeMoveUp','_createSocketURL','_id','name','Subject','clearTimeout','collaboration.closeRoom','1em','filter','CURRENT_STATUS_CANNOT_OPERATE','_commandService','requireSession','entityInit$','onRendered','OffLineIcon','startFormulaLimitUrl','throttleTime','setConfig','OFFLINE','Failed','exports','replaceState','_backgroundColor','getSheetId','disableLocalCache','_collaborationUIEventService','split','_document','TEXT_RANGE_LAYER_INDEX','SUCCESS','map','_pollingInterval','closePath','UNDEFINED','_color','off-line-icon_clip0_910_343','_anchor','add','_scheduleSaving','fillRule','onPointerMove$','_getFormulaLimitStatus','getFocusedUnit','setAlpha','serializeRangeWithSheet','takeUntil','off-line-icon','_checkAndWaitForCalculationPermission','Tools','path','isArray','Unknown\x20user','UniverEngineRender','DocCollaborationEntity','toRgbString','lineTo','rxjs/operators','REMOTE_UNISCRIPT_EXECUTION_ENDPOINT_KEY','DisposableCollection','mapTo','getCollabEntity$','session.connection-failed','LICENSE_MAX_MEMBERS_PER_UNIT_EXCEEDED','switchMap','unitId','white','current','PY_RUNTIME_SCRIPT_ERROR','reconnect','RECT','column','Workbook','measureText','roomMembers$','_applyCommand','_messageService','saveTaskMap','collab-client.tooltip.reconnect','NOT_FOUND','collabStatus.notCollab','now','getSheetBySheetId','Disposable','getVpScrollXYInfoByPosToVp','NOT_COLLAB','_univerInstanceService','univerjs-icon\x20univerjs-icon-','complete','_hideTimer','No\x20unitID\x20or\x20type\x20in\x20URL.\x20Will\x20not\x20load\x20files\x20from\x20remote\x20address.','[CollaborationDataLoaderController]','application/json','_scheduleClearOtherTimer','_init','_drawRectRange','DependentOn','/run/','getCurrentSelections','DesktopCollaborationStatusDisplayController','react','m1Prime','attrs','shareReplay','generateRandomId','onPointerLeave$','CONFLICT','skeleton','bold\x2013px\x20Source\x20Han\x20Sans\x20CN','addObject','ILocalCacheService','displayName','collabStatus.offline','SNAPSHOT_HAS_BEEN_REMOVED','redoState','black','NO_OTHER_CLIENTS_EDITING','subunit','_onRefRangeChange','SetFormulaCalculationNotificationMutation','YUUMI_ASYNCIO_CANCELLED','UNAUTHENTICATED','collaboration.single-unit.warning','amd','onPointerEnter$','_releaseCalculationLimit','IImageIoService','_handleJoinEvent','SetTextSelectionsOperation','find','_getSessionTicket','_clearOtherTimers','UniverCollaborationClientPlugin','M3.61971\x2011.6499C2.40304\x2011.6499\x200.699707\x2011.1024\x200.699707\x208.9124C0.699707\x206.3574\x203.25471\x205.8099\x203.98471\x205.8099C4.34971\x204.5324\x205.07971\x202.5249\x207.99971\x202.5249C10.5547\x202.5249\x2011.6497\x203.9849\x2012.0147\x205.2624C12.0147\x205.2624\x2015.2997\x205.6274\x2015.2997\x208.7299C15.2997\x2010.9199\x2013.8397\x2011.6499\x2012.3797\x2011.6499M9.82471\x209.82466L6.17471\x2013.4747M6.17471\x209.82466L9.82471\x2013.4747','_toggleOffline','ENTITLE_DUP_SUBSCRIPTION','_docTransformSelectionsService','@univerjs/design','_dataLoaderService','143104dpbOhB','addHandlerCallback','EMAIL_VERIFY_CODE_NOT_FOUND_OR_EXPIRED','length','setTimeout','LICENSE_MAX_UNITS_EXCEEDED','UniverRpc','ranges','UniverEngineFormula','releaseFormulaLimitUrl','_showGuardMessage','getRenderById','ENTITLE_UPDOWN_GRADE_NOT_SUPPORT','pipe','SOCKET_FAILED_RETRY','YUUMI_SUBSCRIPTION_NOT_FOUND','unshift','triggerDblclick','activeSheet$','flatMap','collabStatus.conflict','UniverProCollaborationClientUi','purple.300','collaboration-client.offline-data-not-saved','DataLoaderService','_saveTaskMap','getAncestorScale','_lastPointer','_docClipboardService','react/jsx-runtime','ERROR_AGAIN','fill','_initCommandInterceptor','getActiveSheet','14590CWxtwa','1812eVxkPS','M4.5865\x2011.6499C3.36983\x2011.6499\x201.6665\x2011.1024\x201.6665\x208.9124C1.6665\x206.3574\x204.2215\x205.8099\x204.9515\x205.8099C5.3165\x204.5324\x206.0465\x202.5249\x208.9665\x202.5249C11.5215\x202.5249\x2012.6165\x203.9849\x2012.9815\x205.2624C12.9815\x205.2624\x2016.2665\x205.6274\x2016.2665\x208.7299C16.2665\x2010.9199\x2014.8065\x2011.6499\x2013.3465\x2011.6499M6.7767\x2011.6497L8.9667\x2013.4747L11.8867\x209.82466','setStateCache','http://www.w3.org/2000/svg','selections','DeleteRangeMoveUpCommandId','UniverSheetsUi','cursorInfo','_startCalculationLimit','undoState','LICENSE_EXPORT_SIZE_EXCEEDED','ILogService','collab-rect-range-','_docSkeleton','#FFF','dispose','asObservable','_refRangeService','USERS_LEAVE','_cursorInfo$','SYNCED','UniverDocs','toStringTag','editingUnit','_initEntityListener','@univerjs/sheets-ui','APPLY_DUPLICATED','key','sessionStatus$','MemberService','UniverProCollaboration','UniverSheets','executeCommand','_handleHover','location','IUIPartsService','INVITE_CODE_HAS_BEEN_UES','session.collaboration-timeout','handleDeleteRangeMoveLeft','_removeCollabCursors','APPLY_REJECT','_docStateChangeManagerService','UniverUi','width','mask','REDEMPTION_INVALID_CODE','result','IBeforeCloseService','YUUMI_NO_CUBOID_FOR_QUESTION','makeDirty','_setFormulaLimitStatus','jiqing.500','WebSocketService','_memberService','bottom','_localeService','UNIVER_DOC','urlChange$','CollaborationController','RxDisposable','Warning','DocSkeletonManagerService','from','SetWorksheetActivateCommand','isTransformMutationsWithChangesetSuccess','clipPath','[RemoteUniscriptService]:\x20no\x20focused\x20unit','LICENSE_IMPORT_SIZE_EXCEEDED','_draw','Plugin','_hasFormulaInDirtyRanges','_range','_toggleOnline','handleInsertCol','_selfUnitIDs','_eventUnsubscribe','max','WebURLService','1562286ftGtly','ITransformService','registerRefRange','_drawTextRange','YUUMI_URL_COL_OUT_OF_RANGE','collabStatus.fetchMiss','INVALID_ARGUMENT','LocaleService','doc.mutation.rich-text-editing','_revisionService','getOffsetConfig','startsWith','CollaborationDataLoaderController','_colorIndex','UPDATE_CURSOR','YUUMI_PROMPT_MAX_TOKENS_EXCEEDED','getCellMatrix','_collabSessionService','forEach','toString','LOGIN_TOKEN_PROCESSING_FAILED','REDEMPTION_CODE_NOT_STARTED','deserializeRangeWithSheet','CollaborationSessionService','subscribe','syncEditingCollabCursor','DEFAULT_REMOTE_UNISCRIPT_EXECUTION_ENDPOINT','RemoveRowCommandId','IDocClipboardService','9926210SjavBu','currentTheme$','getOwnPropertyDescriptor','Module','_colorAssignService','use','params','MOBILE_HAS_BEEN_BOUND','SetSelectionsOperation','InsertRangeMoveDownCommandId','_assignedColors','substring','_transformService','show','_urlService','_online','override','isEditing','createIdentifier','addEventListener','xlink:href','unit','_registerRenderDependencies','with','@univerjs-pro/collaboration','dispose$','6243093RvHIRZ','UNIVER_SHEET','onMouseMove','forwardRef','url(#$1','@univerjs/core','SessionStatus','YUUMI_TABLE_NOT_FOUND_IN_UNIT','Success','getColor','runOnServer','hide','_setupSubUnitSync','transformSelections','_injector','/universer-api/license/formula/limit/start','_unitStatus','DOC_RANGE_TYPE','_entityInit$','InsertRangeMoveRightCommandId','DATA_SOURCE_TOO_LARGE','saveImage','_hovered','on-line-icon_clip0_910_349','DEFAULT_WS_SESSION_TICKET_URL','INVITE_CODE_REQUIRED','_handleEvent','PERMISSION_DENIED','entries','useRef','currentColor','ColorKit','arc','_uiPartsService','LOGIN_FAILED','YUUMI_ALL_TABLES_IS_INVALID','getDocRanges','_checkCalculationAvailable','Inject','newValue','init','_refreshCollabCursors','COMPLETION_FINISHED','@univerjs/drawing','SOCKET_FAILED','assign','replaceDocRanges','toDisposable','assignAColorForMemberID','transformMutationsWithChangeset','getCurrentUnitForType','VIEW_MAIN','INotificationService','sheetId','_collaborationController','WECHAT_HAS_BEEN_BOUND','Injector','getCollabCursors$','_ensureSubject','_updateLocalCursor','_updateURLWithCurrentState','_startDocCollabCursor','_collabCursorController','setParam','collaboration-client-ui.config','url(#off-line-icon_clip0_910_343)','red.300','startColumn','JOIN_ROOM_FAILED','jsx','NodePositionConvertToRectRange','TEXT','sessionTicket','UnitStatus','_scheduleHeartbeat','collabStatus.syncing','YUUMI_UNABLE_LOAD_URL','AWAITING_WITH_PENDING','deepClone','UniverInstanceType','runId','_doCreateSocket','addObjects','status$','_onCursorDelete','APPLY_PERMISSION_DENIED','then','_unitOnClients','getCurrent','clearInterval','YUUMI_CONNECTOR_URL_NOT_FOUND','@univerjs/network','CollaborationStatus','maxFormulaLimit','startRow','unitID','ENTITLE_CAN_NOT_BUY_LOWER_OTP','_docSyncEditingCollabCursorService','executionId','CONNECTOR_DATA_TOO_LARGE','ILocalStorageService','loadUnit','combineLatest','SNAPSHOT_INVALID_SNAPSHOT','_localStorageService','_scene','getTypeOfUnitDisposed$','_beforeCloseService','_textBubble','rgba(255,\x20255,\x20255,\x200.01)','transformByState','ENTITLE_REPORT_LIMIT_EXCEED','docStateChange$','INVITE_CODE_ALREADY_BOUND','color','getRelativeToViewportCoord','roomMembers','defs','_getSaveTimeout','touchDependencies','getUndoRedoMutationParamsCache','engine','restore','Vector2','string','transformStateCache','TOO_MANY_REQUESTS','source','storage','getUnitId','RemoveColCommandId','HTTPService','MOBILE_VERIFY_CODE_NOT_FOUND_OR_EXPIRED','disposeWithMe','getConfig','saveOfflineData','fromEventSubject','INTERNAL_ERROR','CollaborationSocketService','_onCursorUpdate','collabStatus.synced','getUnitStatus$','Tooltip','getLocalCacheKey','rxjs','findNodePositionByCharIndex','actions','handleIRemoveCol','round','ThemeService','_maxFormulaLimit','isFormulaId','_cursors','@univerjs/engine-formula','exhaustSavingTask','_registerDependencies','isFormulaString','eventID','_getScale','_handleLeaveEvent','ENSURE_SNAPSHOT_EXECUTION','DocIMEInputManagerService','UniverDrawing','text','isTransformMutationFailure','tag','currentSkeleton$','backgroundColor','setItem','get','CollaborationUIEventId','runRefRangeMutations','REDEMPTION_CODE_HAS_BEEN_CREATED','IMessageService','_renderManagerService','permission.title','handleIRemoveRow','getformulaLimitStatusUrl','COLLABORATION_CLIENT_PLUGIN_CONFIG_KEY','_initStatusListener','href','_name','defineProperty','getSkeleton','SUBMIT_CHANGESET_TIMEOUT','IConfigService','_session','data','_localCacheService','LICENSE_DISTRO_REJECTED','merge','OnLineIcon','_instanceService','_cursorShapes','children','@univerjs/docs-ui','parse','MoveRangeCommandId','0\x200\x2016\x2016','_startSheetCollabCursor','useCallback','disposeUnit','includes','beforeCommandExecuted','imageSourceType','searchParams','trim','SheetCollabCursorShape','enableLocalCache','type','shift','mutations','idSuffix','wsSessionTicketUrl','@univerjs/sheets','EffectRefRangId','...','_getAnchorBounding','ALREADY_EXISTS','APPLY_REVISION_CONFILICT','MessageType','CommandType','Error','ENTITLE_NEED_BILLING_ADDRESS','@univerjs/engine-render','NodePositionConvertToCursor','collab-text-range-','_initCommandExecutedListener','size','onTransformChange$','connectInjector','font','RefRangeService','_httpService','Rect','EMAIL_VERIFY_CODE_MISMATCH','post','_anchorDot','addClipboardHook','handleInsertRangeMoveDown','TRANSFORM_CHANGE_OBSERVABLE_TYPE','save','subscribeEvent','IUniverInstanceService','isActive','InsertRowCommandId','_removeClearOtherTimer','registerDependencies','React','IRenderManagerService','_initStatusComponent','ENTITLE_INSUFFICIENT_QUOTA','getSheetObject','_shapes','REDEMPTION_USER_NOT_ELIGIBLE','_lastResponseTimestamp','min','resize','_context','fromEvent','getRangePointData','whenReady','has','onCommandExecuted','/universer-api/license/formula/limit/done','_sheetSkeletonManagerService','_transformPreviousActiveRange','_docSkeletonManagerService','svg','m2Prime','_updateCollabCursors','_render','SheetSkeletonManagerService','APPLY_NON_SEQUENTIAL_REVISION','dirtyRanges','removeParam','getStateCache','colorChannel1','green.600','top','_logService','M0\x200H16V16H0z','RemoteUniscriptService','popstate','getActiveRange','FETCH_MISS','_roomMembers$','IRemoteInstanceService','unsubscribe','parseInt','univer-mr-2\x20univer-flex\x20univer-text-xl','UniverDocsUi','UniverCollaborationClientUIPlugin','UniverIcon','4VIbCTe'];_0x14a7=function(){return _0x19ae58;};return _0x14a7();}

// @univerjs-pro/collaboration-client-ui/facade
(function(_0x2fc59f,_0x7bff46){var _0x17babd=_0x51c7,_0x269fe5=_0x2fc59f();while(!![]){try{var _0x154c94=-parseInt(_0x17babd(0xd9))/0x1*(-parseInt(_0x17babd(0xe7))/0x2)+parseInt(_0x17babd(0xe0))/0x3*(-parseInt(_0x17babd(0xd4))/0x4)+parseInt(_0x17babd(0xd8))/0x5+parseInt(_0x17babd(0xd7))/0x6+parseInt(_0x17babd(0xd3))/0x7*(-parseInt(_0x17babd(0xe5))/0x8)+-parseInt(_0x17babd(0xdd))/0x9*(parseInt(_0x17babd(0xd6))/0xa)+-parseInt(_0x17babd(0xe3))/0xb*(parseInt(_0x17babd(0xdb))/0xc);if(_0x154c94===_0x7bff46)break;else _0x269fe5['push'](_0x269fe5['shift']());}catch(_0x1a87fa){_0x269fe5['push'](_0x269fe5['shift']());}}}(_0x5cda,0x8f1c2),function(_0x2b76b4,_0x14c58c){var _0x3107a4=_0x51c7;typeof exports==_0x3107a4(0xe4)&&typeof module<'u'?_0x14c58c(require('@univerjs-pro/collaboration-client-ui'),require('@univerjs/core/facade')):typeof define==_0x3107a4(0xe9)&&define[_0x3107a4(0xd5)]?define([_0x3107a4(0xe6),_0x3107a4(0xde)],_0x14c58c):(_0x2b76b4=typeof globalThis<'u'?globalThis:_0x2b76b4||self,_0x14c58c(_0x2b76b4[_0x3107a4(0xdf)],_0x2b76b4['UniverCoreFacade']));}(this,function(_0x5840f5,_0x3e02cf){'use strict';var _0x20e9ed=_0x51c7;class _0x3a4cc8 extends _0x3e02cf[_0x20e9ed(0xe2)]{[_0x20e9ed(0xdc)](_0x4e9481,_0x3c4314,..._0x508d3c){var _0x2667b8=_0x20e9ed;return this[_0x2667b8(0xe8)]['get'](_0x5840f5[_0x2667b8(0xe1)])['runOnServer'](_0x4e9481,_0x3c4314,{},..._0x508d3c);}}_0x3e02cf['FUniver'][_0x20e9ed(0xda)](_0x3a4cc8);}));function _0x51c7(_0x96f382,_0x40b6ee){var _0x5cdad6=_0x5cda();return _0x51c7=function(_0x51c75e,_0x3d3fdf){_0x51c75e=_0x51c75e-0xd3;var _0x398235=_0x5cdad6[_0x51c75e];return _0x398235;},_0x51c7(_0x96f382,_0x40b6ee);}function _0x5cda(){var _0x4e529c=['2324GRWHmz','amd','10EiKCDT','4822764XtbdEO','4652530flDroF','23cwrGzl','extend','36ptFXjV','runOnServer','1661211nKYHqZ','@univerjs/core/facade','UniverProCollaborationClientUi','4914KTDHZk','RemoteUniscriptService','FUniver','3665629hyBDrY','object','24312IRucUX','@univerjs-pro/collaboration-client-ui','87750LRLeqz','_injector','function','49KWnUSj'];_0x5cda=function(){return _0x4e529c;};return _0x5cda();}

// @univerjs-pro/thread-comment-datasource/index
(function(_0x8bd348,_0x12e2ac){const _0x558de9=_0x179d,_0x156c26=_0x8bd348();while(!![]){try{const _0x4f5b9d=-parseInt(_0x558de9(0x1d6))/0x1*(-parseInt(_0x558de9(0x1e3))/0x2)+-parseInt(_0x558de9(0x17e))/0x3*(-parseInt(_0x558de9(0x1cb))/0x4)+-parseInt(_0x558de9(0x1d8))/0x5+-parseInt(_0x558de9(0x1d3))/0x6+parseInt(_0x558de9(0x1b1))/0x7*(parseInt(_0x558de9(0x177))/0x8)+parseInt(_0x558de9(0x1a3))/0x9*(parseInt(_0x558de9(0x1c8))/0xa)+-parseInt(_0x558de9(0x1d0))/0xb*(-parseInt(_0x558de9(0x1ad))/0xc);if(_0x4f5b9d===_0x12e2ac)break;else _0x156c26['push'](_0x156c26['shift']());}catch(_0xae0d1){_0x156c26['push'](_0x156c26['shift']());}}}(_0x500b,0x51f57),function(_0x28a0f2,_0x461ffd){const _0x1d1591=_0x179d;typeof exports==_0x1d1591(0x187)&&typeof module<'u'?_0x461ffd(exports,require('@univerjs-pro/collaboration-client'),require('@univerjs-pro/license'),require('@univerjs/core'),require('@univerjs/thread-comment-ui'),require('@univerjs/thread-comment'),require('rxjs'),require('@univerjs/network')):typeof define==_0x1d1591(0x1f4)&&define['amd']?define([_0x1d1591(0x1de),_0x1d1591(0x1b2),_0x1d1591(0x17b),_0x1d1591(0x19a),_0x1d1591(0x1b4),'@univerjs/thread-comment',_0x1d1591(0x18f),_0x1d1591(0x1ec)],_0x461ffd):(_0x28a0f2=typeof globalThis<'u'?globalThis:_0x28a0f2||self,_0x461ffd(_0x28a0f2['UniverProThreadCommentDatasource']={},_0x28a0f2[_0x1d1591(0x1cd)],_0x28a0f2[_0x1d1591(0x1aa)],_0x28a0f2[_0x1d1591(0x19b)],_0x28a0f2[_0x1d1591(0x194)],_0x28a0f2[_0x1d1591(0x1fd)],_0x28a0f2['rxjs'],_0x28a0f2[_0x1d1591(0x1a8)]));}(this,function(_0x3322e8,_0x59d384,_0x1b662c,_0x103b71,_0x2cda3d,_0xfae4d1,_0x51e7e9,_0x161ded){'use strict';const _0x2b48fb=_0x179d;const _0xec0ce0=_0x2b48fb(0x1ac);var _0x3e8cc9=(_0x4d4721=>(_0x4d4721[_0x4d4721['OpenOrReOpen']=0x0]=_0x2b48fb(0x1be),_0x4d4721[_0x4d4721['Solved']=0x1]='Solved',_0x4d4721[_0x4d4721[_0x2b48fb(0x1b8)]=-0x1]='UNRECOGNIZED',_0x4d4721))(_0x3e8cc9||{}),_0xc556b0=(_0x23cde4=>(_0x23cde4[_0x23cde4[_0x2b48fb(0x1f3)]=0x0]=_0x2b48fb(0x1f3),_0x23cde4[_0x23cde4[_0x2b48fb(0x188)]=0x1]=_0x2b48fb(0x188),_0x23cde4[_0x23cde4[_0x2b48fb(0x1f0)]=0x2]='Reply',_0x23cde4[_0x23cde4['Edit']=0x3]=_0x2b48fb(0x1c0),_0x23cde4[_0x23cde4[_0x2b48fb(0x1fa)]=0x4]=_0x2b48fb(0x1fa),_0x23cde4[_0x23cde4[_0x2b48fb(0x1b0)]=0x5]='Solve',_0x23cde4[_0x23cde4['UNRECOGNIZED']=-0x1]=_0x2b48fb(0x1b8),_0x23cde4))(_0xc556b0||{});const _0x49f3fb=_0x133bcf=>_0x103b71[_0x2b48fb(0x1ba)](new Date(+_0x133bcf))[_0x2b48fb(0x179)]('YYYY/MM/DD\x20HH:mm'),_0x19bb97=async(_0x57cc3f,_0x2a97ba)=>{const _0x24e463=_0x2b48fb,_0x23622a=_0x57cc3f['get'](_0x103b71[_0x24e463(0x1db)]),_0x1c6be2=_0x57cc3f['get'](_0x161ded[_0x24e463(0x1a7)]);_0x2a97ba[_0x24e463(0x176)](_0x1c8789=>{const _0xa77103=_0x24e463;_0x23622a[_0xa77103(0x190)](_0x1c8789)&&_0x2a97ba[_0xa77103(0x1d4)](_0x1c8789);}),_0x2a97ba['size']&&(await _0x1c6be2[_0x24e463(0x1cc)](_0x24e463(0x1a4),{'params':{'userIDs':[..._0x2a97ba]}}))[_0x24e463(0x185)][_0x24e463(0x1e1)]['forEach'](_0x5bd8e4=>{_0x5bd8e4&&_0x23622a['addUser'](_0x5bd8e4);});};var _0x4f276c=Object['getOwnPropertyDescriptor'],_0x192a67=(_0x1c5512,_0x399fa8,_0xdf0462,_0x37f90b)=>{const _0x28ea20=_0x2b48fb;for(var _0x2a81d8=_0x37f90b>0x1?void 0x0:_0x37f90b?_0x4f276c(_0x399fa8,_0xdf0462):_0x399fa8,_0x14e717=_0x1c5512[_0x28ea20(0x1f7)]-0x1,_0xd598f;_0x14e717>=0x0;_0x14e717--)(_0xd598f=_0x1c5512[_0x14e717])&&(_0x2a81d8=_0xd598f(_0x2a81d8)||_0x2a81d8);return _0x2a81d8;},_0x408730=(_0x2c4ca3,_0x92285e)=>(_0x5e53f5,_0x3a3cbd)=>_0x92285e(_0x5e53f5,_0x3a3cbd,_0x2c4ca3);let _0x36d340=class extends _0x103b71[_0x2b48fb(0x1a2)]{constructor(_0x3a008e,_0x2bc5b6,_0x17e9a1,_0x34a69a){const _0x3a0934=_0x2b48fb;super(),this['_commentService']=_0x3a008e,this[_0x3a0934(0x1ea)]=_0x2bc5b6,this[_0x3a0934(0x18e)]=_0x17e9a1,this[_0x3a0934(0x1e5)]=_0x34a69a,this['_init'](),this[_0x3a0934(0x17f)]();}['_initUserSync'](){const _0x5586c3=_0x2b48fb;this['disposeWithMe'](this[_0x5586c3(0x1ea)]['commentUpdate$'][_0x5586c3(0x1a5)](_0x51e7e9[_0x5586c3(0x173)](0x10))[_0x5586c3(0x192)](_0x51f3f0=>{const _0x25ee77=_0x5586c3,_0x515d2d=new Set();_0x51f3f0[_0x25ee77(0x176)](_0xf994d4=>{const _0x308f29=_0x25ee77;switch(_0xf994d4['type']){case _0x308f29(0x1ee):{const _0x504f53=_0xf994d4['payload'][_0x308f29(0x1c1)];_0x515d2d[_0x308f29(0x1ee)](_0x504f53);break;}}}),_0x19bb97(this[_0x25ee77(0x1e5)],_0x515d2d);}));}['_init'](){const _0x4a2852=_0x2b48fb;this[_0x4a2852(0x1c6)](this[_0x4a2852(0x1f9)]['commentUpdate$'][_0x4a2852(0x192)](async _0x59108a=>{const _0x422cc4=_0x4a2852;var _0x499f50,_0x4b5532,_0xc14dfa,_0x290c86;const _0x2b49cc=(_0x499f50=this[_0x422cc4(0x1ea)][_0x422cc4(0x1c9)](_0x59108a[_0x422cc4(0x184)])[_0x422cc4(0x1d1)](_0x10e619=>_0x10e619[_0x422cc4(0x183)]===_0x59108a[_0x422cc4(0x183)]))==null?void 0x0:_0x499f50[_0x422cc4(0x1cf)];if(!_0x2b49cc)return;const {unitId:_0x269581,subUnitId:_0x3e98ee}=_0x2b49cc;switch(_0x59108a[_0x422cc4(0x1e6)]&&this[_0x422cc4(0x18e)][_0x422cc4(0x1dd)](_0x59108a['user']),_0x59108a[_0x422cc4(0x182)]){case _0xc556b0[_0x422cc4(0x188)]:break;case _0xc556b0['Reply']:{this['_threadCommentModel'][_0x422cc4(0x1d5)](_0x269581,_0x3e98ee,{'unitId':_0x269581,'subUnitId':_0x3e98ee,'ref':'','id':_0x59108a[_0x422cc4(0x1b3)],'dT':_0x49f3fb(+_0x59108a['createTimestamp']),'threadId':_0x59108a['threadId'],'personId':(_0xc14dfa=(_0x4b5532=_0x59108a[_0x422cc4(0x1e6)])==null?void 0x0:_0x4b5532[_0x422cc4(0x174)])!=null?_0xc14dfa:_0x59108a['userId'],'text':JSON['parse'](_0x59108a[_0x422cc4(0x1e4)]),'parentId':_0x2b49cc['id']});break;}case _0xc556b0['Delete']:{const _0x3c89d3=this[_0x422cc4(0x1ea)]['getComment'](_0x269581,_0x3e98ee,_0x59108a[_0x422cc4(0x1b3)]);_0x3c89d3&&_0x3c89d3[_0x422cc4(0x1bb)]&&this[_0x422cc4(0x1ea)]['deleteComment'](_0x269581,_0x3e98ee,_0x59108a['replyId']);break;}case _0xc556b0[_0x422cc4(0x1c0)]:{this[_0x422cc4(0x1ea)][_0x422cc4(0x1da)](_0x269581,_0x3e98ee,{'commentId':_0x59108a[_0x422cc4(0x1b3)],'text':JSON[_0x422cc4(0x1a6)](_0x59108a[_0x422cc4(0x1e4)])});break;}case _0xc556b0['Solve']:{const _0x2eef9f=(_0x290c86=this['_threadCommentModel'][_0x422cc4(0x1c9)](_0x59108a[_0x422cc4(0x184)])[_0x422cc4(0x1d1)](_0x4f5773=>_0x4f5773[_0x422cc4(0x183)]===_0x59108a[_0x422cc4(0x183)]))==null?void 0x0:_0x290c86['root'];_0x2eef9f&&this[_0x422cc4(0x1ea)][_0x422cc4(0x1ef)](_0x269581,_0x3e98ee,_0x2eef9f['id'],_0x59108a['solved']===_0x3e8cc9[_0x422cc4(0x1ae)]);break;}}}));}};_0x36d340=_0x192a67([_0x408730(0x0,_0x103b71['Inject'](_0x59d384[_0x2b48fb(0x1b6)])),_0x408730(0x1,_0x103b71[_0x2b48fb(0x1e2)](_0xfae4d1[_0x2b48fb(0x17d)])),_0x408730(0x2,_0x103b71['Inject'](_0x103b71[_0x2b48fb(0x1db)])),_0x408730(0x3,_0x103b71[_0x2b48fb(0x1e2)](_0x103b71['Injector']))],_0x36d340);const _0x52e4ae=_0x2b48fb(0x1bf),_0x2ed7e3={};var _0x283fab=Object[_0x2b48fb(0x1a0)],_0x4c53ac=(_0x1baaf5,_0x103c6a,_0x1ac6f5,_0x1762e3)=>{const _0x5eadda=_0x2b48fb;for(var _0x5e1735=_0x1762e3>0x1?void 0x0:_0x1762e3?_0x283fab(_0x103c6a,_0x1ac6f5):_0x103c6a,_0x2db6d7=_0x1baaf5[_0x5eadda(0x1f7)]-0x1,_0x5e3fb1;_0x2db6d7>=0x0;_0x2db6d7--)(_0x5e3fb1=_0x1baaf5[_0x2db6d7])&&(_0x5e1735=_0x5e3fb1(_0x5e1735)||_0x5e1735);return _0x5e1735;},_0x363d45=(_0x527b38,_0x2ad9f4)=>(_0x1c6e27,_0x32dae3)=>_0x2ad9f4(_0x1c6e27,_0x32dae3,_0x527b38);function _0x349549(_0x28639b,_0x50b3c5){const _0x1e5b83=_0x2b48fb,_0x574373=_0x28639b[_0x1e5b83(0x17c)][0x0];return{..._0x50b3c5,'id':_0x574373[_0x1e5b83(0x1b3)],'resolved':_0x28639b[_0x1e5b83(0x191)]===0x1,'dT':_0x49f3fb(_0x574373[_0x1e5b83(0x1fc)]),'personId':_0x574373[_0x1e5b83(0x19f)],'threadId':_0x574373[_0x1e5b83(0x183)]};}function _0x29b5ac(_0x1cd325,_0x55adb8,_0xeeac8c){const _0x24b811=_0x2b48fb;var _0x46369,_0x2b9b3c;if(((_0x2b9b3c=(_0x46369=_0x1cd325==null?void 0x0:_0x1cd325['replies'])==null?void 0x0:_0x46369[_0x24b811(0x1f7)])!=null?_0x2b9b3c:0x0)>0x0){const _0x28cd0d=(_0x22efd3,_0x55fc93)=>({'id':_0x22efd3['replyId'],'threadId':_0x22efd3[_0x24b811(0x183)],'dT':_0x49f3fb(_0x22efd3[_0x24b811(0x1fc)]),'personId':_0x22efd3[_0x24b811(0x19f)],'resolved':_0x1cd325[_0x24b811(0x191)]===_0x3e8cc9['Solved'],'unitId':_0x55adb8,'subUnitId':_0xeeac8c,'text':JSON[_0x24b811(0x1a6)](_0x22efd3[_0x24b811(0x1e4)]),'parentId':_0x55fc93}),_0x3831f5=_0x28cd0d(_0x1cd325[_0x24b811(0x17c)][0x0]);return{..._0x3831f5,'children':_0x1cd325[_0x24b811(0x17c)][_0x24b811(0x1fb)](0x1)[_0x24b811(0x18d)](_0x532f6d=>_0x28cd0d(_0x532f6d,_0x3831f5['id']))};}return null;}let _0x39803a=class{constructor(_0x142487,_0x3c2eee,_0x2ced65){const _0x536d56=_0x2b48fb;this[_0x536d56(0x19c)]=_0x142487,this[_0x536d56(0x18e)]=_0x3c2eee,this['_sessionService']=_0x2ced65;}async[_0x2b48fb(0x1d5)](_0x49e6b5){const _0x43cf14=_0x2b48fb;var _0x3ec4e1,_0x1d1a59;const {parentId:_0x168344,unitId:_0x19dd20,text:_0x256325,threadId:_0x280aa0}=_0x49e6b5,_0x3a52e5=(_0x1d1a59=(_0x3ec4e1=_0x256325[_0x43cf14(0x193)])==null?void 0x0:_0x3ec4e1[_0x43cf14(0x178)](_0x4904a6=>_0x4904a6[_0x43cf14(0x1f1)]===_0x103b71[_0x43cf14(0x1c3)]['COMMENT'])[_0x43cf14(0x18d)](_0x4850c0=>_0x4850c0['rangeId']))!=null?_0x1d1a59:[],_0x247b18=JSON[_0x43cf14(0x198)](_0x256325),_0x48356c=(await this[_0x43cf14(0x180)][_0x43cf14(0x1ed)](_0x19dd20))[_0x43cf14(0x1b7)]();if(_0x168344){const _0x7d8424={'memberId':_0x48356c,'unitId':_0x19dd20,'content':_0x247b18,'mention':_0x3a52e5,'threadId':_0x280aa0},_0x16a133=(await this['_httpService']['post'](_0x43cf14(0x1df)+_0x19dd20+_0x43cf14(0x1c4),{'body':_0x7d8424}))[_0x43cf14(0x185)][_0x43cf14(0x1e8)];return{..._0x49e6b5,'id':_0x16a133[_0x43cf14(0x1b3)],'dT':_0x103b71[_0x43cf14(0x1ba)](+_0x16a133['createTimestamp'])['format']('YYYY/MM/DD\x20HH:mm'),'personId':_0x16a133['userId']};}else{const _0x22d027={'memberId':_0x48356c,'unitId':_0x19dd20,'content':_0x247b18,'mention':_0x3a52e5},_0x10bb01=await this[_0x43cf14(0x19c)][_0x43cf14(0x1b9)](_0x43cf14(0x1df)+_0x19dd20+_0x43cf14(0x1f5),{'body':_0x22d027});return _0x349549(_0x10bb01[_0x43cf14(0x185)][_0x43cf14(0x19e)],_0x49e6b5);}}async['updateComment'](_0x3b32d4){const _0x2d8b69=_0x2b48fb;var _0x468ed2,_0xfbdf19;const {text:_0x50b2c2,unitId:_0x4a42ec}=_0x3b32d4,_0x517df5=(_0xfbdf19=(_0x468ed2=_0x50b2c2[_0x2d8b69(0x193)])==null?void 0x0:_0x468ed2[_0x2d8b69(0x178)](_0x33714d=>_0x33714d[_0x2d8b69(0x1f1)]===_0x103b71[_0x2d8b69(0x1c3)]['COMMENT'])[_0x2d8b69(0x18d)](_0x5454fa=>_0x5454fa[_0x2d8b69(0x189)]))!=null?_0xfbdf19:[],_0x5a2d6d=JSON[_0x2d8b69(0x198)](_0x50b2c2),_0x34fc88=_0x3b32d4[_0x2d8b69(0x183)],_0x263be1=_0x3b32d4['id'],_0x475d74={'memberId':(await this[_0x2d8b69(0x180)][_0x2d8b69(0x1ed)](_0x4a42ec))['getMemberID'](),'unitId':_0x4a42ec,'threadId':_0x34fc88,'mention':_0x517df5,'content':_0x5a2d6d,'replyId':_0x263be1},_0x59ef43=await this[_0x2d8b69(0x19c)][_0x2d8b69(0x1b9)]('/universer-api/comment/unit/'+_0x4a42ec+'/edit',{'body':_0x475d74});return!_0x59ef43['body'][_0x2d8b69(0x1f8)]||_0x59ef43[_0x2d8b69(0x185)][_0x2d8b69(0x1f8)]['code']===0x1;}async[_0x2b48fb(0x1ef)](_0x572980){const _0xd2025c=_0x2b48fb,{unitId:_0x5dc79a}=_0x572980,_0x3e2414=_0x572980[_0xd2025c(0x183)],_0x38ff91={'memberId':this[_0xd2025c(0x18e)]['getCurrentUser']()[_0xd2025c(0x174)],'unitId':_0x5dc79a,'threadId':_0x3e2414,'solved':_0x572980['resolved']?_0x3e8cc9[_0xd2025c(0x1ae)]:_0x3e8cc9['OpenOrReOpen']},_0x3a4d0b=await this[_0xd2025c(0x19c)][_0xd2025c(0x1b9)](_0xd2025c(0x1df)+_0x5dc79a+_0xd2025c(0x19d),{'body':_0x38ff91});return!_0x3a4d0b[_0xd2025c(0x185)][_0xd2025c(0x1f8)]||_0x3a4d0b[_0xd2025c(0x185)][_0xd2025c(0x1f8)][_0xd2025c(0x1e7)]===0x1;}async[_0x2b48fb(0x1a1)](_0x1bd1a4,_0x3b4186,_0x2c666c,_0x5cb414){const _0x2cf342=_0x2b48fb,_0x27a5a5={'memberId':(await this[_0x2cf342(0x180)][_0x2cf342(0x1ed)](_0x1bd1a4))[_0x2cf342(0x1b7)](),'threadId':_0x2c666c,'replyId':_0x5cb414,'unitId':_0x1bd1a4},_0x8e2e7c=await this[_0x2cf342(0x19c)][_0x2cf342(0x1b9)]('/universer-api/comment/unit/'+_0x1bd1a4+_0x2cf342(0x1f6),{'body':_0x27a5a5});return!_0x8e2e7c[_0x2cf342(0x185)][_0x2cf342(0x1f8)]||_0x8e2e7c[_0x2cf342(0x185)]['error'][_0x2cf342(0x1e7)]===0x1;}async[_0x2b48fb(0x196)](_0x9548b0,_0x41b165,_0x541e99){const _0x278023=_0x2b48fb,_0x5adfc1={'unitId':_0x9548b0,'threadId':_0x541e99},_0x3e9515=await this[_0x278023(0x19c)][_0x278023(0x1b9)](_0x278023(0x1df)+_0x9548b0+_0x278023(0x199),{'body':_0x5adfc1}),_0x3ecd27=_0x541e99[_0x278023(0x18d)](_0xdd0633=>_0x29b5ac(_0x3e9515[_0x278023(0x185)][_0x278023(0x1ab)][_0xdd0633],_0x9548b0,_0x41b165))[_0x278023(0x178)](Boolean);return Object[_0x278023(0x1b5)](_0x3e9515[_0x278023(0x185)][_0x278023(0x1e1)])[_0x278023(0x176)](_0x373753=>{this['_userService']['addUser'](_0x373753);}),_0x3ecd27;}[_0x2b48fb(0x1c7)](_0x4c48ed){const _0x343911=_0x2b48fb;return{'id':_0x4c48ed['id'],'threadId':_0x4c48ed[_0x343911(0x183)],'ref':_0x4c48ed[_0x343911(0x1dc)]};}};_0x39803a=_0x4c53ac([_0x363d45(0x0,_0x103b71[_0x2b48fb(0x1e2)](_0x161ded[_0x2b48fb(0x1a7)])),_0x363d45(0x1,_0x103b71['Inject'](_0x103b71[_0x2b48fb(0x1db)])),_0x363d45(0x2,_0x103b71[_0x2b48fb(0x1e2)](_0x59d384['CollaborationSessionService']))],_0x39803a);var _0x53b2cb=Object[_0x2b48fb(0x1a0)],_0x1eef12=(_0x1681c6,_0x4fb12c,_0x31b305,_0x337dfc)=>{for(var _0x49b106=_0x337dfc>0x1?void 0x0:_0x337dfc?_0x53b2cb(_0x4fb12c,_0x31b305):_0x4fb12c,_0x3e7299=_0x1681c6['length']-0x1,_0x4d4163;_0x3e7299>=0x0;_0x3e7299--)(_0x4d4163=_0x1681c6[_0x3e7299])&&(_0x49b106=_0x4d4163(_0x49b106)||_0x49b106);return _0x49b106;},_0x472c9d=(_0x36fb1f,_0x25f064)=>(_0x316bbf,_0x4da007)=>_0x25f064(_0x316bbf,_0x4da007,_0x36fb1f);let _0x3aeb59=class extends _0x103b71['Disposable']{constructor(_0x82182,_0x5e73a9){const _0xf9ac09=_0x2b48fb;super(),this[_0xf9ac09(0x1e9)]=_0x82182,this[_0xf9ac09(0x18a)]=_0x5e73a9,this[_0xf9ac09(0x1d7)]();}['_initDataSource'](){const _0x5315de=_0x2b48fb;this[_0x5315de(0x1e9)][_0x5315de(0x1c5)]=this['_threadCommentDataSource'],this['_threadCommentDataSourceService'][_0x5315de(0x1bc)]=!0x1;}};_0x3aeb59=_0x1eef12([_0x472c9d(0x0,_0xfae4d1[_0x2b48fb(0x1ca)]),_0x472c9d(0x1,_0x103b71[_0x2b48fb(0x1e2)](_0x39803a))],_0x3aeb59);var _0x5075b2=Object[_0x2b48fb(0x1d2)],_0x1f6ccb=Object[_0x2b48fb(0x1a0)],_0x5a868d=(_0x538e27,_0x2919cd,_0x175495)=>_0x2919cd in _0x538e27?_0x5075b2(_0x538e27,_0x2919cd,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0x175495}):_0x538e27[_0x2919cd]=_0x175495,_0x3d1941=(_0x253b38,_0x5e0a82,_0x409c12,_0x34bb9e)=>{for(var _0xf57037=_0x34bb9e>0x1?void 0x0:_0x34bb9e?_0x1f6ccb(_0x5e0a82,_0x409c12):_0x5e0a82,_0x758ffd=_0x253b38['length']-0x1,_0x291288;_0x758ffd>=0x0;_0x758ffd--)(_0x291288=_0x253b38[_0x758ffd])&&(_0xf57037=_0x291288(_0xf57037)||_0xf57037);return _0xf57037;},_0x44c498=(_0x2ba6b6,_0x3bbadb)=>(_0x2c8b05,_0x5a99e8)=>_0x3bbadb(_0x2c8b05,_0x5a99e8,_0x2ba6b6),_0x272167=(_0x320c5a,_0x154022,_0x5dd033)=>_0x5a868d(_0x320c5a,typeof _0x154022!=_0x2b48fb(0x18b)?_0x154022+'':_0x154022,_0x5dd033);_0x3322e8[_0x2b48fb(0x1eb)]=class extends _0x103b71['Plugin']{constructor(_0x1bf2da=_0x2ed7e3,_0x5953bf,_0x6d65e2){const _0x4a6524=_0x2b48fb;super(),this[_0x4a6524(0x1a9)]=_0x1bf2da,this[_0x4a6524(0x1e5)]=_0x5953bf,this[_0x4a6524(0x1e0)]=_0x6d65e2;const {..._0x405cc5}=_0x103b71[_0x4a6524(0x18c)]({},_0x2ed7e3,this[_0x4a6524(0x1a9)]);this['_configService'][_0x4a6524(0x181)](_0x52e4ae,_0x405cc5);}[_0x2b48fb(0x197)](){const _0x2c83a0=_0x2b48fb;[[_0x39803a],[_0x3aeb59],[_0x36d340]][_0x2c83a0(0x176)](_0x3ab0f0=>{const _0x5f4d13=_0x2c83a0;this[_0x5f4d13(0x1e5)][_0x5f4d13(0x1ee)](_0x3ab0f0);});}[_0x2b48fb(0x175)](){const _0x2d6b2a=_0x2b48fb;this[_0x2d6b2a(0x1e5)][_0x2d6b2a(0x1cc)](_0x3aeb59),this[_0x2d6b2a(0x1e5)][_0x2d6b2a(0x1cc)](_0x36d340);}},_0x272167(_0x3322e8[_0x2b48fb(0x1eb)],_0x2b48fb(0x1d9),_0xec0ce0),_0x272167(_0x3322e8[_0x2b48fb(0x1eb)],_0x2b48fb(0x182),_0x103b71[_0x2b48fb(0x1af)][_0x2b48fb(0x195)]),_0x3322e8[_0x2b48fb(0x1eb)]=_0x3d1941([_0x103b71[_0x2b48fb(0x186)](_0x2cda3d[_0x2b48fb(0x1f2)],_0x59d384['UniverCollaborationClientPlugin'],_0x1b662c[_0x2b48fb(0x17a)]),_0x44c498(0x1,_0x103b71[_0x2b48fb(0x1e2)](_0x103b71[_0x2b48fb(0x1ce)])),_0x44c498(0x2,_0x103b71['IConfigService'])],_0x3322e8[_0x2b48fb(0x1eb)]),Object[_0x2b48fb(0x1d2)](_0x3322e8,Symbol[_0x2b48fb(0x1c2)],{'value':_0x2b48fb(0x1bd)});}));function _0x179d(_0x10d494,_0x3df04f){const _0x500b08=_0x500b();return _0x179d=function(_0x179dab,_0x39bc1d){_0x179dab=_0x179dab-0x173;let _0x10e092=_0x500b08[_0x179dab];return _0x10e092;},_0x179d(_0x10d494,_0x3df04f);}function _0x500b(){const _0x131d5e=['forEach','8iWkETe','filter','format','UniverLicensePlugin','@univerjs-pro/license','replies','ThreadCommentModel','1299CdoyOh','_initUserSync','_sessionService','setConfig','type','threadId','unitId','body','DependentOn','object','Add','rangeId','_threadCommentDataSource','symbol','merge','map','_userService','rxjs','getUser','solved','subscribe','customRanges','UniverThreadCommentUi','UNIVER_UNKNOWN','listComments','onStarting','stringify','/list','@univerjs/core','UniverCore','_httpService','/solved','comment','userId','getOwnPropertyDescriptor','deleteComment','Disposable','1878597dibaMy','/universer-api/user/list','pipe','parse','HTTPService','UniverNetwork','_config','UniverProLicense','comments','UNIVER_THREAD_COMMENT_DATA_SOURCE_PLUGIN','84CdnZND','Solved','UniverInstanceType','Solve','2711541gDJAHH','@univerjs-pro/collaboration-client','replyId','@univerjs/thread-comment-ui','values','CommentService','getMemberID','UNRECOGNIZED','post','dayjs','parentId','syncUpdateMutationToColla','Module','OpenOrReOpen','thread-comment-data-source.config','Edit','personId','toStringTag','CustomRangeType','/reply','dataSource','disposeWithMe','saveCommentToSnapshot','10TdaHRT','getUnit','IThreadCommentDataSourceService','4348XZLcED','get','UniverProCollaborationClient','Injector','root','158477ibLGpv','find','defineProperty','3271200mXIGXe','delete','addComment','8197vJtdQE','_initDataSource','3195920gthGhg','pluginName','updateComment','UserManagerService','ref','addUser','exports','/universer-api/comment/unit/','_configService','users','Inject','86nZbuvi','content','_injector','user','code','reply','_threadCommentDataSourceService','_threadCommentModel','UniverThreadCommentDataSourcePlugin','@univerjs/network','requireSession','add','resolveComment','Reply','rangeType','UniverThreadCommentUIPlugin','Unknown','function','/add','/delete','length','error','_commentService','Delete','slice','createTimestamp','UniverThreadComment','bufferTime','userID','onReady'];_0x500b=function(){return _0x131d5e;};return _0x500b();}

// @univerjs-pro/edit-history-viewer/index
function _0xfb6f(_0x15eb0d,_0x1f3aef){const _0x347f96=_0x347f();return _0xfb6f=function(_0xfb6f5,_0x113b8c){_0xfb6f5=_0xfb6f5-0x97;let _0x120527=_0x347f96[_0xfb6f5];return _0x120527;},_0xfb6f(_0x15eb0d,_0x1f3aef);}function _0x347f(){const _0x4beb67=['filter','AddSheetSparklineMutation','_versions$','combineLatest','dispose','0\x200\x2016\x2017','object','Print','addProtection','UniverEditHistoryViewerPlugin','UNIVER_SHEET','UNIVER_UNKNOWN','flex','UNIVER_SLIDE','ViewHistory','1000','memberId','_getAPIPrefix','querySelector','100%','includes','concat','IConfigService','endRev','history-mask','@univerjs/drawing','SheetPermissionInitController','_sheetSkeletonManagerService','206127WkLxrO','scrollEvent$','width','SheetSkeletonManagerService','currentVersionDiff$','DeleteSheet','useObservable','[HistoryFetchService]:\x20wrong\x20rev\x20from\x20the\x20server!','confirm-revert-revision','LOGIN_TOKEN_PROCESSING_FAILED','fetchThroughInterceptors','getAncestorScale','SHEET_VIEWPORT_KEY','CreateWorksheet','editHistory.info.loading','active','COMPRESS_MUTATION_APPLY','_initPanel','_localeService','tag','createTime','REDEMPTION_CODE_FULLY_REDEEMED','blocks','editHistory.panel.revertConfirm','UniverSheetsUi','padStart','UniverInstanceType','refreshRangeProtectPermission','MoveColsMutation','_diffRangesMap','View','UniverNetworkPlugin','@univerjs/ui','path','IPermissionService','mask','2MppdTv','PAYMENT_CHANNEL_NOT_SUPPORT','getVersion','&lastLabel=','ITransformService','disposeUnit','LICENSE_MAX_MEMBERS_PER_UNIT_EXCEEDED','univer-text-2xl\x20dark:!univer-text-white','editHistory.action.','blockMeta','useDependency','ENTITLE_CAN_NOT_BUY_LOWER_OTP','DATA_SOURCE_TOO_LARGE','length','editHistory.action.revertSheetPrefix','Injector','value','getCurrent','entities','commands','rgba(225,\x20225,\x20225,\x200.5)','WorkbookMoveSheetPermission','REDEMPTION_CODE_INACTIVE','_sheetPermissionInitController','DeleteWorksheet','FloatImg','RemoveSheetMutation','MOBILE_VERIFY_CODE_MISMATCH','get','EMAIL_HAS_BEEN_BOUND','getHours','clsx','subUnitId','error','clipPath','univer-flex\x20univer-items-center\x20univer-gap-2.5\x20univer-py-1.5\x20univer-text-sm\x20univer-font-medium','values','SetWorksheetStyle','Loaded','INVALID_INVITE_CODE','jsxs','_sidebarDisposable','map','_uiPartsService','_historyFetchService','InsertRowMutation','svg','_hasMore','SetWorksheetActiveOperation','_getActiveSubUnitId','_permissionService','current','restore-icon_clip0_1247_2','currentVersion','_status$','InsertRow','children','COMPLETION_FINISHED','_createMask','editSheet','ERROR_AGAIN','endRow','all','univer-flex\x20univer-items-center\x20univer-justify-center','VIRTUAL_VERSION_NOW','focusUnit','YUUMI_RATE_OVER_LIMIT','React','DisposableCollection','ComponentManager','borderBottomClassName','parseProtocolChangeset','revertRevision$','.univer-app-container-content','params','range','column','YUUMI_NO_CUBOID_FOR_QUESTION','BackIcon','_confirmService','RevertRevisionMutation','_context','canRevert','_maskContainer','SetCellStyle','YUUMI_PROMPT_MAX_TOKENS_EXCEEDED','BehaviorSubject','AddConditionalRuleMutation','toISOString','DependentOn','InsertHyperlink','_messageService','getUnitOnRev','debounce','loadMoreVersions','use','SheetCollabCursorShape','Exited','@univerjs/core','unitId$','center','YUUMI_CONNECTOR_URL_NOT_FOUND','EditExtraObject','ENTITLE_DUP_SUBSCRIPTION','DeleteRow','pipe','univer-text-gray-500','_compressMutationService','useCallback','exited','InsertColMutation','[HistoryFetchService]:\x20request\x20snapshot\x20error!','_members','style','History','Vector2','_versionDiffService','WorkbookRenameSheetPermission','Fragment','MessageType','history-panel','UNIVER_DOC','getDialogs$','div','Duplicate',':\x20(','univer-flex\x20univer-flex-1\x20univer-items-center\x20univer-text-sm\x20univer-text-gray-600\x20dark:!univer-text-gray-200','subType','PY_RUNTIME_SCRIPT_ERROR','hideMask','keys','onMouseMove','mutations','SetWorksheetHideMutation','push','APPLY_PERMISSION_DENIED','clear','now','changesets','_unitId$','LoadingMultiIcon','rect','ICommandService','onSteady','SetColumnStyle','getMember','_dialogOptions$','from','UniverSheetsConditionalFormatting','_lastLabel','function','/universer-api/history','top','m1Prime','row','INVALID_ARGUMENT','status','M2.06678\x203.37926C2.0668\x201.94333\x203.23085\x200.779297\x204.66678\x200.779297H9.44256C10.1796\x200.779297\x2010.8821\x201.09213\x2011.3751\x201.63999L13.2659\x203.74079C13.6955\x204.21822\x2013.9333\x204.83779\x2013.9333\x205.4801V12.7126C13.9333\x2014.1486\x2012.7692\x2015.3126\x2011.3333\x2015.3126H4.66665C3.2307\x2015.3126\x202.06663\x2014.1486\x202.06665\x2012.7126L2.06678\x203.37926ZM4.66678\x201.9793C3.89359\x201.9793\x203.26679\x202.60609\x203.26678\x203.37928L3.26665\x2012.7126C3.26664\x2013.4858\x203.89344\x2014.1126\x204.66665\x2014.1126H11.3333C12.1065\x2014.1126\x2012.7333\x2013.4858\x2012.7333\x2012.7126V5.4801C12.7333\x205.44882\x2012.7322\x205.41764\x2012.7302\x205.3866H10.7985C9.91488\x205.3866\x209.19853\x204.67026\x209.19853\x203.78661V1.9793H4.66678ZM10.4832\x202.44275L12.0526\x204.1866H10.7985C10.5776\x204.1866\x2010.3985\x204.00752\x2010.3985\x203.78661V2.35649C10.4279\x202.38389\x2010.4561\x202.41266\x2010.4832\x202.44275Z','getUnitId','REDEMPTION_CODE_NOT_STARTED','UniverNetwork','univer-overflow-hidden','justifyContent','CHANGESET_REVISION_CONFILICT','registerComponent','INTERNAL_ERROR','editHistory.panel.title','bottom','set','_updateVersions','Init','rule','_combineRanges','_componentManager','useRef','ViemRwHgtClWdt','_maskElement','editHistory.panel.confirm','_removeDiffMarks','@univerjs/sheets-conditional-formatting','forwardRef','5676730knniww','loaded','278590nfnptL','triggerRevert','YUUMI_SUBSCRIPTION_NOT_FOUND','recoverTime','rgba(58,\x2096,\x20247,\x200.20)','string','currentVersion$','Sort','user','6007738SUxPyd','RenameWorksheet','MoveRangeMutation','_extractRanges','Plugin','left','UNRECOGNIZED','amd','_fetching','MOBILE_VERIFY_CODE_NOT_FOUND_OR_EXPIRED','UniverCore','name','univer-m-auto\x20univer-animate-spin','7vrGNKx','flat','ENTITLE_NEED_BILLING_ADDRESS','xlink:href','editHistory.panel.cancel','_lastPointer','_init','addObjects','UNIVER_PROJECT','loadSheet','getOwnPropertyDescriptor','endColumn','_workbookDataCache','createSheet','#0B9EFB','dateString','ranges','APPLY_DUPLICATED','LICENSE_MAX_UNITS_EXCEEDED','setFilter','SetNumfmtMutation','getVpScrollXYInfoByPosToVp','jsx','CopySheet','Edit','UniverProSheetsSparkline','getCurrentLocale','ENTITLE_UPDOWN_GRADE_NOT_SUPPORT','registerRenderModule','YUUMI_ALL_TABLES_IS_INVALID','1em','createElement','AddWorksheetProtectionMutation','revertSheet','ManageCollaborator','displayName','InsertColumn','INVITE_CODE_REQUIRED','position','5309272hGkMwU','APPLY_REJECT','editHistory.action.etc','data','UniverSheetsUIPlugin','604xPbGDH','WorkbookEditablePermission','AddDataValidationMutation','LocaleService','merge','NOT_FOUND','entries','ObjectMatrix','_initRender','fetchMissingChangesets','state$','onRendered','SnapshotServerOverHTTPService','onStarting','APPLY_REVISION_CONFILICT','Inject','_transformService','getCurrentUnitForType','editHistory.panel.currentUser','CreateSheet','UNDEFINED','LICENSE_IMPORT_SIZE_EXCEEDED','createUnit','YUUMI_UNABLE_LOAD_URL','makeDirty','HTTPService','CollaborationImageIoService','users','_loadingState$','endRevision','updatePermissionPoint','some','MoveRowsMutation','EMAIL_VERIFY_CODE_MISMATCH','setDV','SetRowStyle','_canRevert','Info','EMAIL_VERIFY_CODE_NOT_FOUND_OR_EXPIRED','insertSheet','showMask','SelectProtectedCells','workbook','toDisposable','loadingState$','parse','M7.41252\x2010.6196C7.64683\x2010.3852\x207.64683\x2010.0053\x207.41252\x209.77103L6.77012\x209.12863H9.67836C9.89927\x209.12863\x2010.0784\x209.30772\x2010.0784\x209.52863V11.1953C10.0784\x2011.5267\x2010.347\x2011.7953\x2010.6784\x2011.7953C11.0097\x2011.7953\x2011.2784\x2011.5267\x2011.2784\x2011.1953V9.52863C11.2784\x208.64497\x2010.562\x207.92863\x209.67836\x207.92863H6.77012L7.41252\x207.28623C7.64683\x207.05191\x207.64683\x206.67201\x207.41252\x206.4377C7.1782\x206.20338\x206.79831\x206.20338\x206.56399\x206.4377L4.89732\x208.10437C4.66301\x208.33868\x204.66301\x208.71858\x204.89732\x208.95289L6.56399\x2010.6196C6.79831\x2010.8539\x207.1782\x2010.8539\x207.41252\x2010.6196Z','getRelativeToViewportCoord','6KaQznM','next','sheet','cellValue','MoveWorksheet','skeleton','onPointerMove$','action','unitId','block','@univerjs/sheets','RangeMergeUtil','getCoordByCell','setCF','transformMutations','zIndex','UniverProCollaboration','_renderManagerService','ViewFilter','AUTHORIZE_CODE_ILLEGAL','none','PERMISSION_DENIED','USER_NOT_INVITED_CODE','univer-text-sm\x20univer-leading-5\x20univer-text-gray-500\x20dark:!univer-text-gray-300','evenodd','attrs','_snapshotServerService','ENTITLE_REPORT_LIMIT_EXCEED','_currentVersion$','split','CreatePermissionObject','univer-animate-spin','AddRangeProtectionMutation','status$','setFrozen','YUUMI_AI_RUN_FAILED','SelectUnProtectedCells','LocaleType','6039945ltywkd','deleteProtection','IUIPartsService','HideSheet','LICENSE_DISTRO_REJECTED','Disposable','_initMaskContainer','LICENSE_EXPORT_SIZE_EXCEEDED','Loading','Today','editHistory.panel.listFetchError','ISnapshotServerService','_revertRevision$','date','CURRENT_STATUS_CANNOT_OPERATE','versions','LOGIN_FAILED','subscribe','reduce','url(#restore-icon_clip0_1247_2)','symbol','SetRangeValuesMutation','toStringTag','0\x200\x2016\x2016','white','UniverSheets','edit-history-viewer.config','FromArray','defs','code','DeleteRangeProtectionMutation','_commandService','YUUMI_ASYNCIO_CANCELLED','ReorderRangeMutation','_historyContainerId','_getRangesByMutation','switchMap','setState','height','M6.42416\x204.42417C6.65847\x204.18985\x206.65847\x203.80995\x206.42416\x203.57564C6.18984\x203.34132\x205.80994\x203.34132\x205.57563\x203.57564L1.57564\x207.57564C1.34132\x207.80995\x201.34132\x208.18985\x201.57564\x208.42417L5.57563\x2012.4242C5.80994\x2012.6585\x206.18984\x2012.6585\x206.42416\x2012.4242C6.65847\x2012.1899\x206.65847\x2011.81\x206.42416\x2011.5756L3.44843\x208.5999H14C14.3314\x208.5999\x2014.6\x208.33127\x2014.6\x207.9999C14.6\x207.66853\x2014.3314\x207.3999\x2014\x207.3999H3.44843L6.42416\x204.42417Z','SetCellValue','fill','REDEMPTION_CODE_HAS_BEEN_CREATED','userID','YUUMI_URL_COL_OUT_OF_RANGE','REDEMPTION_INVALID_CODE','Export','stopPropagation','_currentVersionDiff$','idSuffix','_httpService','triggerLoadSheet','getElementById','univerjs-icon\x20univerjs-icon-','_createUnit','removeSheet','assign','_transformMutationByOrder','getSheetObject','Comment','currentSkeleton$','RecoverHistory','ENTITLE_CHAT_LIMIT_EXCEED','UniverEngineRender','useState','hasCommand','restore-icon','Module','react/jsx-runtime','CONNECTOR_DATA_TOO_LARGE','ZH_CN','MOBILE_HAS_BEEN_BOUND','Filter','IDialogService','currentColor','editHistory.panel.revertDesc','hidden','_sidebarService','rules','UniverProCollaborationClient','span','colorChannel1','IMessageService','rxjs','_updateDiffMarks','close','init','IUniverInstanceService','UpdateDataValidationMutation','rev','HistoryModeStatus','getMinutes','disposeWithMe','entered','open','defineProperty','ICellEditorManagerService','startRow','DeleteColumn','startColumn','UniverDesign','getInterceptPoints','SetSheetsFilterRangeMutation','EditWorksheetCell','TOO_MANY_REQUESTS','setValue','univer-ml-2.5\x20univer-flex\x20univer-size-8\x20univer-cursor-pointer\x20univer-items-center\x20univer-justify-center\x20univer-rounded','_cellEditorManagerService','register','IConfirmService','button','_openPanel','show','Share','find','confirm','then','getConfig','http://www.w3.org/2000/svg','editHistory.header.revert','time','_injector','UniverProEditHistoryViewer','8970mOLGne','has','InsertSheetMutation','PivotTable','_configService','_univerInstanceService','univer-flex\x20univer-size-6\x20univer-items-center\x20univer-justify-center\x20univer-rounded\x20univer-text-gray-400\x20hover:univer-bg-gray-100\x20dark:hover:!univer-bg-gray-700','asObservable','WorkbookHideSheetPermission','SNAPSHOT_HAS_BEEN_REMOVED','@univerjs-pro/collaboration','UniverSheetsFilter','add','_initActiveSwitch','substring','ENSURE_SNAPSHOT_EXECUTION','getDeserializedSheetBlock','editHistory.panel.currentVersion','_diffs','UNAUTHENTICATED','forEach','display','syncExecuteCommand','sheetId','getDataRange','getVersions','exports','REDEMPTION_USER_NOT_ELIGIBLE','HistoryManagerService','interceptor','RenameSheet','userId','ALREADY_EXISTS','univer-flex\x20univer-h-12\x20univer-cursor-default\x20univer-items-center','@univerjs-pro/collaboration-client-ui','SetConditionalRuleMutation','loadingState','versions$','UniverUi','Delete','univer-h-full\x20univer-space-y-2\x20univer-overflow-auto\x20univer-pb-4','_historyManagerService','INVITE_CODE_HAS_BEEN_UES','HEADER','@univerjs/data-validation','url(#$1','Tooltip','USER_NOT_FOUND','CompressMutationService','MoveSheet','ensureVersion','setConfig','SNAPSHOT_INVALID_SNAPSHOT'];_0x347f=function(){return _0x4beb67;};return _0x347f();}(function(_0x1ace9a,_0x247c82){const _0x14bf15=_0xfb6f,_0x2a9f3a=_0x1ace9a();while(!![]){try{const _0x3752af=-parseInt(_0x14bf15(0x232))/0x1*(parseInt(_0x14bf15(0x256))/0x2)+-parseInt(_0x14bf15(0x1e1))/0x3*(parseInt(_0x14bf15(0x110))/0x4)+-parseInt(_0x14bf15(0xce))/0x5*(-parseInt(_0x14bf15(0x140))/0x6)+parseInt(_0x14bf15(0xe4))/0x7*(parseInt(_0x14bf15(0x10b))/0x8)+-parseInt(_0x14bf15(0x166))/0x9+parseInt(_0x14bf15(0xcc))/0xa+parseInt(_0x14bf15(0xd7))/0xb;if(_0x3752af===_0x247c82)break;else _0x2a9f3a['push'](_0x2a9f3a['shift']());}catch(_0x241294){_0x2a9f3a['push'](_0x2a9f3a['shift']());}}}(_0x347f,0x7b2a6),function(_0x3772e9,_0x25455c){const _0x564c94=_0xfb6f;typeof exports==_0x564c94(0x21c)&&typeof module<'u'?_0x25455c(exports,require('@univerjs-pro/collaboration'),require('@univerjs-pro/collaboration-client'),require('@univerjs/core'),require('@univerjs/drawing'),require('@univerjs/engine-render'),require('@univerjs/network'),require('@univerjs/sheets-ui'),require('@univerjs/ui'),require('@univerjs/design'),require('@univerjs/sheets'),require('rxjs'),require('@univerjs-pro/sheets-sparkline'),require('@univerjs/data-validation'),require('@univerjs/sheets-conditional-formatting'),require('@univerjs/sheets-filter'),require('react/jsx-runtime'),require('react'),require('@univerjs-pro/collaboration-client-ui')):typeof define==_0x564c94(0xad)&&define[_0x564c94(0xde)]?define([_0x564c94(0x1fb),_0x564c94(0x1eb),'@univerjs-pro/collaboration-client',_0x564c94(0x2b8),_0x564c94(0x22f),'@univerjs/engine-render','@univerjs/network','@univerjs/sheets-ui',_0x564c94(0x252),'@univerjs/design',_0x564c94(0x14a),_0x564c94(0x1b9),'@univerjs-pro/sheets-sparkline',_0x564c94(0x20d),_0x564c94(0xca),'@univerjs/sheets-filter',_0x564c94(0x1aa),'react',_0x564c94(0x203)],_0x25455c):(_0x3772e9=typeof globalThis<'u'?globalThis:_0x3772e9||self,_0x25455c(_0x3772e9[_0x564c94(0x1e0)]={},_0x3772e9[_0x564c94(0x150)],_0x3772e9[_0x564c94(0x1b5)],_0x3772e9[_0x564c94(0xe1)],_0x3772e9['UniverDrawing'],_0x3772e9[_0x564c94(0x1a5)],_0x3772e9[_0x564c94(0xb7)],_0x3772e9[_0x564c94(0x24a)],_0x3772e9[_0x564c94(0x207)],_0x3772e9[_0x564c94(0x1ca)],_0x3772e9[_0x564c94(0x17f)],_0x3772e9[_0x564c94(0x1b9)],_0x3772e9[_0x564c94(0xfd)],_0x3772e9['UniverDataValidation'],_0x3772e9[_0x564c94(0xab)],_0x3772e9[_0x564c94(0x1ec)],_0x3772e9[_0x564c94(0x299)],_0x3772e9[_0x564c94(0x299)],_0x3772e9['UniverProCollaborationClientUi']));}(this,function(_0x4d70eb,_0xa43662,_0x450e2e,_0x242e1a,_0x149d4f,_0xfc4827,_0x3ebdc4,_0x316cbf,_0x1bf0bf,_0x368c21,_0x467fd2,_0x2a386a,_0x52613e,_0x2b3974,_0x532ec1,_0x2eebc6,_0x7b355a,_0x3f8f3c,_0x444a03){'use strict';const _0x31b547=_0xfb6f;var _0x12c448=Object[_0x31b547(0x1c5)],_0x39b870=(_0x38861a,_0x3fadac,_0x1eb374)=>_0x3fadac in _0x38861a?_0x12c448(_0x38861a,_0x3fadac,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0x1eb374}):_0x38861a[_0x3fadac]=_0x1eb374,_0x554995=(_0x2c614a,_0x3fc312,_0x17cb8a)=>_0x39b870(_0x2c614a,typeof _0x3fc312!=_0x31b547(0x17a)?_0x3fc312+'':_0x3fc312,_0x17cb8a);const _0x1ac248=_0x31b547(0x180),_0x47955f={};var _0x1d5651=Object[_0x31b547(0xee)],_0x20f3ba=(_0x41405d,_0x4c3bef,_0x3b6d1d,_0x5063de)=>{const _0x38568b=_0x31b547;for(var _0x399990=_0x5063de>0x1?void 0x0:_0x5063de?_0x1d5651(_0x4c3bef,_0x3b6d1d):_0x4c3bef,_0x17d854=_0x41405d[_0x38568b(0x263)]-0x1,_0xbed1ec;_0x17d854>=0x0;_0x17d854--)(_0xbed1ec=_0x41405d[_0x17d854])&&(_0x399990=_0xbed1ec(_0x399990)||_0x399990);return _0x399990;},_0xcbc74a=(_0x1eeb57,_0x43b86f)=>(_0x437b79,_0x251003)=>_0x43b86f(_0x437b79,_0x251003,_0x1eeb57);let _0x157c76=class extends _0x242e1a[_0x31b547(0x16b)]{constructor(_0x292757){const _0x4e756d=_0x31b547;super(),this['_cellEditorManagerService']=_0x292757,this[_0x4e756d(0xea)]();}[_0x31b547(0xea)](){const _0x3c8650=_0x31b547;this[_0x3c8650(0x1c2)](this['_cellEditorManagerService'][_0x3c8650(0x11a)]['subscribe'](_0x56f106=>{const _0x181bad=_0x3c8650;_0x56f106!=null&&_0x56f106['show']&&this[_0x181bad(0x1d1)][_0x181bad(0x18b)]({'show':!0x1});}));}};_0x157c76=_0x20f3ba([_0xcbc74a(0x0,_0x316cbf[_0x31b547(0x1c6)])],_0x157c76);var _0x3f26b4=(_0x1967a8=>(_0x1967a8[_0x1967a8[_0x31b547(0x124)]=0x0]=_0x31b547(0x124),_0x1967a8[_0x1967a8['OK']=0x1]='OK',_0x1967a8[_0x1967a8[_0x31b547(0xbc)]=0x2]=_0x31b547(0xbc),_0x1967a8[_0x1967a8[_0x31b547(0x155)]=0x3]=_0x31b547(0x155),_0x1967a8[_0x1967a8[_0x31b547(0x115)]=0x4]=_0x31b547(0x115),_0x1967a8[_0x1967a8[_0x31b547(0x1f4)]=0x5]=_0x31b547(0x1f4),_0x1967a8[_0x1967a8[_0x31b547(0x201)]=0x6]=_0x31b547(0x201),_0x1967a8[_0x1967a8[_0x31b547(0xb2)]=0x7]=_0x31b547(0xb2),_0x1967a8[_0x1967a8['TOO_MANY_REQUESTS']=0x8]=_0x31b547(0x1ce),_0x1967a8[_0x1967a8[_0x31b547(0x28f)]=0x9]=_0x31b547(0x28f),_0x1967a8[_0x1967a8[_0x31b547(0x176)]=0xa]='LOGIN_FAILED',_0x1967a8[_0x1967a8[_0x31b547(0x271)]=0xb]=_0x31b547(0x271),_0x1967a8[_0x1967a8[_0x31b547(0xe0)]=0xc]=_0x31b547(0xe0),_0x1967a8[_0x1967a8[_0x31b547(0x131)]=0xd]=_0x31b547(0x131),_0x1967a8[_0x1967a8[_0x31b547(0x136)]=0xe]=_0x31b547(0x136),_0x1967a8[_0x1967a8[_0x31b547(0x153)]=0xf]=_0x31b547(0x153),_0x1967a8[_0x1967a8[_0x31b547(0x23b)]=0x10]=_0x31b547(0x23b),_0x1967a8[_0x1967a8[_0x31b547(0x174)]=0x64]='CURRENT_STATUS_CANNOT_OPERATE',_0x1967a8[_0x1967a8[_0x31b547(0x292)]=0x65]=_0x31b547(0x292),_0x1967a8[_0x1967a8['USER_NOT_FOUND']=0xc9]=_0x31b547(0x210),_0x1967a8[_0x1967a8['USER_IS_ANONYMOUS']=0xca]='USER_IS_ANONYMOUS',_0x1967a8[_0x1967a8[_0x31b547(0xba)]=0x1389]=_0x31b547(0xba),_0x1967a8[_0x1967a8['SNAPSHOT_INVALID_SNAPSHOT']=0x1771]=_0x31b547(0x215),_0x1967a8[_0x1967a8[_0x31b547(0x1ea)]=0x1772]='SNAPSHOT_HAS_BEEN_REMOVED',_0x1967a8[_0x1967a8['ENSURE_SNAPSHOT_EXECUTION']=0x1773]=_0x31b547(0x1f0),_0x1967a8[_0x1967a8[_0x31b547(0x10c)]=0x1b59]='APPLY_REJECT',_0x1967a8[_0x1967a8['APPLY_NON_SEQUENTIAL_REVISION']=0x1b5a]='APPLY_NON_SEQUENTIAL_REVISION',_0x1967a8[_0x1967a8[_0x31b547(0x11e)]=0x1b5b]='APPLY_REVISION_CONFILICT',_0x1967a8[_0x1967a8[_0x31b547(0x9e)]=0x1b5c]='APPLY_PERMISSION_DENIED',_0x1967a8[_0x1967a8[_0x31b547(0xf5)]=0x1b5d]='APPLY_DUPLICATED',_0x1967a8[_0x1967a8[_0x31b547(0x1ab)]=0x1f41]=_0x31b547(0x1ab),_0x1967a8[_0x1967a8[_0x31b547(0xf6)]=0x2329]='LICENSE_MAX_UNITS_EXCEEDED',_0x1967a8[_0x1967a8[_0x31b547(0x25c)]=0x232a]=_0x31b547(0x25c),_0x1967a8[_0x1967a8['LICENSE_IMPORT_SIZE_EXCEEDED']=0x232b]=_0x31b547(0x125),_0x1967a8[_0x1967a8[_0x31b547(0x16d)]=0x232c]=_0x31b547(0x16d),_0x1967a8[_0x1967a8[_0x31b547(0x16a)]=0x232d]='LICENSE_DISTRO_REJECTED',_0x1967a8[_0x1967a8[_0x31b547(0x127)]=0x2711]=_0x31b547(0x127),_0x1967a8[_0x1967a8[_0x31b547(0x192)]=0x2712]='YUUMI_URL_COL_OUT_OF_RANGE',_0x1967a8[_0x1967a8[_0x31b547(0x298)]=0x2713]=_0x31b547(0x298),_0x1967a8[_0x1967a8[_0x31b547(0xd0)]=0x2714]=_0x31b547(0xd0),_0x1967a8[_0x1967a8[_0x31b547(0x2a3)]=0x271a]=_0x31b547(0x2a3),_0x1967a8[_0x1967a8[_0x31b547(0x186)]=0x271b]=_0x31b547(0x186),_0x1967a8[_0x1967a8['YUUMI_TABLE_NOT_FOUND_IN_UNIT']=0x271c]='YUUMI_TABLE_NOT_FOUND_IN_UNIT',_0x1967a8[_0x1967a8[_0x31b547(0x101)]=0x271d]=_0x31b547(0x101),_0x1967a8[_0x1967a8['YUUMI_PROMPT_MAX_TOKENS_EXCEEDED']=0x271e]=_0x31b547(0x2ab),_0x1967a8[_0x1967a8[_0x31b547(0x163)]=0x271f]=_0x31b547(0x163),_0x1967a8[_0x1967a8[_0x31b547(0x2bb)]=0x2720]=_0x31b547(0x2bb),_0x1967a8[_0x1967a8[_0x31b547(0x97)]=0x2af9]=_0x31b547(0x97),_0x1967a8[_0x1967a8['INVITE_CODE_HAS_BEEN_UES']=0x2ee1]=_0x31b547(0x20b),_0x1967a8[_0x1967a8['INVALID_INVITE_CODE']=0x2ee2]=_0x31b547(0x27d),_0x1967a8[_0x1967a8[_0x31b547(0x109)]=0x2ee3]=_0x31b547(0x109),_0x1967a8[_0x1967a8[_0x31b547(0x156)]=0x2ee4]=_0x31b547(0x156),_0x1967a8[_0x1967a8['INVITE_CODE_ALREADY_BOUND']=0x2ee5]='INVITE_CODE_ALREADY_BOUND',_0x1967a8[_0x1967a8['WECHAT_HAS_BEEN_BOUND']=0x32c9]='WECHAT_HAS_BEEN_BOUND',_0x1967a8[_0x1967a8[_0x31b547(0x1ad)]=0x32ca]='MOBILE_HAS_BEEN_BOUND',_0x1967a8[_0x1967a8['EMAIL_HAS_BEEN_BOUND']=0x32cb]=_0x31b547(0x273),_0x1967a8[_0x1967a8[_0x31b547(0x261)]=0x36b1]=_0x31b547(0x261),_0x1967a8[_0x1967a8[_0x31b547(0xff)]=0x36b2]=_0x31b547(0xff),_0x1967a8[_0x1967a8['ENTITLE_DUP_SUBSCRIPTION']=0x36b3]=_0x31b547(0x2bd),_0x1967a8[_0x1967a8['PAYMENT_CHANNEL_NOT_SUPPORT']=0x36b4]=_0x31b547(0x257),_0x1967a8[_0x1967a8[_0x31b547(0x1a4)]=0x3715]=_0x31b547(0x1a4),_0x1967a8[_0x1967a8[_0x31b547(0x15b)]=0x3716]=_0x31b547(0x15b),_0x1967a8[_0x1967a8['ENTITLE_INSUFFICIENT_QUOTA']=0x3717]='ENTITLE_INSUFFICIENT_QUOTA',_0x1967a8[_0x1967a8[_0x31b547(0xe6)]=0x37dd]=_0x31b547(0xe6),_0x1967a8[_0x1967a8[_0x31b547(0x193)]=0x3a99]=_0x31b547(0x193),_0x1967a8[_0x1967a8[_0x31b547(0x26c)]=0x3a9a]='REDEMPTION_CODE_INACTIVE',_0x1967a8[_0x1967a8['REDEMPTION_CODE_FULLY_REDEEMED']=0x3a9b]=_0x31b547(0x247),_0x1967a8[_0x1967a8[_0x31b547(0xb6)]=0x3a9c]=_0x31b547(0xb6),_0x1967a8[_0x1967a8['REDEMPTION_USER_NOT_ELIGIBLE']=0x3a9d]=_0x31b547(0x1fc),_0x1967a8[_0x1967a8['REDEMPTION_USER_REDEEM_TIMES_EXCEED']=0x3a9e]='REDEMPTION_USER_REDEEM_TIMES_EXCEED',_0x1967a8[_0x1967a8[_0x31b547(0x190)]=0x3a9f]=_0x31b547(0x190),_0x1967a8[_0x1967a8[_0x31b547(0x262)]=0x3e81]='DATA_SOURCE_TOO_LARGE',_0x1967a8[_0x1967a8[_0x31b547(0xdd)]=-0x1]=_0x31b547(0xdd),_0x1967a8))(_0x3f26b4||{}),_0x57e78f=(_0x1894cb=>(_0x1894cb[_0x1894cb[_0x31b547(0x221)]=0x0]=_0x31b547(0x221),_0x1894cb[_0x1894cb['UNIVER_DOC']=0x1]=_0x31b547(0x2cf),_0x1894cb[_0x1894cb[_0x31b547(0x220)]=0x2]=_0x31b547(0x220),_0x1894cb[_0x1894cb[_0x31b547(0x223)]=0x3]='UNIVER_SLIDE',_0x1894cb[_0x1894cb[_0x31b547(0xec)]=0x4]=_0x31b547(0xec),_0x1894cb[_0x1894cb[_0x31b547(0xdd)]=-0x1]=_0x31b547(0xdd),_0x1894cb))(_0x57e78f||{}),_0x3df9c5=(_0x58f8f0=>(_0x58f8f0[_0x58f8f0[_0x31b547(0x250)]=0x0]=_0x31b547(0x250),_0x58f8f0[_0x58f8f0[_0x31b547(0xfc)]=0x1]='Edit',_0x58f8f0[_0x58f8f0[_0x31b547(0x106)]=0x2]=_0x31b547(0x106),_0x58f8f0[_0x58f8f0[_0x31b547(0x21d)]=0x3]=_0x31b547(0x21d),_0x58f8f0[_0x58f8f0[_0x31b547(0x2d2)]=0x4]='Duplicate',_0x58f8f0[_0x58f8f0[_0x31b547(0x1a1)]=0x5]='Comment',_0x58f8f0[_0x58f8f0['Copy']=0x6]='Copy',_0x58f8f0[_0x58f8f0[_0x31b547(0x1d7)]=0x7]=_0x31b547(0x1d7),_0x58f8f0[_0x58f8f0[_0x31b547(0x194)]=0x8]=_0x31b547(0x194),_0x58f8f0[_0x58f8f0[_0x31b547(0x144)]=0x9]=_0x31b547(0x144),_0x58f8f0[_0x58f8f0['DeleteWorksheet']=0xa]=_0x31b547(0x26e),_0x58f8f0[_0x58f8f0['HideWorksheet']=0xb]='HideWorksheet',_0x58f8f0[_0x58f8f0['RenameWorksheet']=0xc]=_0x31b547(0xd8),_0x58f8f0[_0x58f8f0['CreateWorksheet']=0xd]=_0x31b547(0x23f),_0x58f8f0[_0x58f8f0[_0x31b547(0x27b)]=0xe]=_0x31b547(0x27b),_0x58f8f0[_0x58f8f0[_0x31b547(0x1cd)]=0xf]='EditWorksheetCell',_0x58f8f0[_0x58f8f0[_0x31b547(0x2b0)]=0x10]=_0x31b547(0x2b0),_0x58f8f0[_0x58f8f0[_0x31b547(0xd5)]=0x11]=_0x31b547(0xd5),_0x58f8f0[_0x58f8f0[_0x31b547(0x1ae)]=0x12]='Filter',_0x58f8f0[_0x58f8f0[_0x31b547(0x1e4)]=0x13]=_0x31b547(0x1e4),_0x58f8f0[_0x58f8f0[_0x31b547(0x26f)]=0x14]=_0x31b547(0x26f),_0x58f8f0[_0x58f8f0[_0x31b547(0x2c8)]=0x15]=_0x31b547(0x2c8),_0x58f8f0[_0x58f8f0['RwHgtClWdt']=0x16]='RwHgtClWdt',_0x58f8f0[_0x58f8f0[_0x31b547(0xc6)]=0x17]=_0x31b547(0xc6),_0x58f8f0[_0x58f8f0['ViewFilter']=0x18]=_0x31b547(0x152),_0x58f8f0[_0x58f8f0[_0x31b547(0x212)]=0x19]=_0x31b547(0x212),_0x58f8f0[_0x58f8f0[_0x31b547(0x237)]=0x1a]=_0x31b547(0x237),_0x58f8f0[_0x58f8f0[_0x31b547(0x169)]=0x1b]=_0x31b547(0x169),_0x58f8f0[_0x58f8f0[_0x31b547(0xfb)]=0x1c]=_0x31b547(0xfb),_0x58f8f0[_0x58f8f0[_0x31b547(0x1ff)]=0x1d]=_0x31b547(0x1ff),_0x58f8f0[_0x58f8f0[_0x31b547(0x123)]=0x1e]=_0x31b547(0x123),_0x58f8f0[_0x58f8f0[_0x31b547(0x139)]=0x1f]=_0x31b547(0x139),_0x58f8f0[_0x58f8f0[_0x31b547(0x164)]=0x20]='SelectUnProtectedCells',_0x58f8f0[_0x58f8f0[_0x31b547(0x2aa)]=0x21]=_0x31b547(0x2aa),_0x58f8f0[_0x58f8f0[_0x31b547(0x18e)]=0x22]=_0x31b547(0x18e),_0x58f8f0[_0x58f8f0[_0x31b547(0x133)]=0x23]=_0x31b547(0x133),_0x58f8f0[_0x58f8f0['SetColumnStyle']=0x24]=_0x31b547(0xa7),_0x58f8f0[_0x58f8f0[_0x31b547(0x28d)]=0x25]=_0x31b547(0x28d),_0x58f8f0[_0x58f8f0[_0x31b547(0x108)]=0x26]='InsertColumn',_0x58f8f0[_0x58f8f0[_0x31b547(0x2be)]=0x27]=_0x31b547(0x2be),_0x58f8f0[_0x58f8f0[_0x31b547(0x1c8)]=0x28]=_0x31b547(0x1c8),_0x58f8f0[_0x58f8f0[_0x31b547(0x2bc)]=0x29]=_0x31b547(0x2bc),_0x58f8f0[_0x58f8f0[_0x31b547(0x208)]=0x2a]='Delete',_0x58f8f0[_0x58f8f0[_0x31b547(0x1a3)]=0x2b]=_0x31b547(0x1a3),_0x58f8f0[_0x58f8f0[_0x31b547(0x224)]=0x2c]='ViewHistory',_0x58f8f0[_0x58f8f0['CreatePermissionObject']=0x2d]=_0x31b547(0x15e),_0x58f8f0[_0x58f8f0[_0x31b547(0xdd)]=-0x1]=_0x31b547(0xdd),_0x58f8f0))(_0x3df9c5||{});function _0x4ac758(_0x500766){const _0x40c2a5=_0x31b547;return!!(_0x500766&&_0x500766['code']&&_0x500766[_0x40c2a5(0x183)]!==_0x3f26b4['OK']&&_0x500766[_0x40c2a5(0x183)]!=='OK');}const _0x558a9b=(_0x14747b,_0x48459c)=>{const _0x1879b8=_0x31b547;if(!_0x14747b)return{'date':'','time':''};const _0x21e3a3=new Date(_0x14747b),_0xbfc4c5=_0x21e3a3['toISOString']()['split']('T')[0x0];switch(_0x48459c){case _0x242e1a[_0x1879b8(0x165)]['ZH_CN']:return{'date':_0x10059b(_0xbfc4c5,_0x48459c),'time':_0x21e3a3[_0x1879b8(0x274)]()+':'+String(_0x21e3a3[_0x1879b8(0x1c1)]())[_0x1879b8(0x24b)](0x2,'0')};default:return{'date':_0x10059b(_0xbfc4c5,_0x48459c),'time':_0x21e3a3[_0x1879b8(0x274)]()+':'+_0x21e3a3[_0x1879b8(0x1c1)]()};}},_0x556eb6=(_0xea3da5,_0x34f178)=>{const _0x1dcfeb=_0x31b547,_0x3c6f5=_0xea3da5[_0x1dcfeb(0xd6)]||_0x34f178['t']('editHistory.panel.unknownUser');if(_0xea3da5[_0x1dcfeb(0x269)][_0x1dcfeb(0x12f)](_0x1fe97f=>_0x1fe97f===_0xa43662['RevertRevisionMutation']['id'])&&_0xea3da5[_0x1dcfeb(0xd1)]){const _0x24d767=_0x558a9b(_0xea3da5[_0x1dcfeb(0xd1)],_0x34f178[_0x1dcfeb(0xfe)]()),_0x14e34d=_0x24d767[_0x1dcfeb(0x173)]+'\x20'+_0x24d767[_0x1dcfeb(0x1de)];return _0x3c6f5+'\x20'+_0x34f178['t'](_0x1dcfeb(0x264))+'\x20'+_0x14e34d+'\x20'+_0x34f178['t']('editHistory.action.revertSheetSuffix');}const _0x5f3886=_0x55b2be(_0xea3da5),_0x3c0813=_0x5f3886[_0x1dcfeb(0x263)]===0x1?_0x34f178['t'](_0x5f3886[0x0]):''+_0x34f178['t'](_0x5f3886[0x0])+_0x34f178['t'](_0x1dcfeb(0x10d));return _0x3c6f5+'\x20'+_0x3c0813;};function _0x55b2be(_0xa65105){const _0x126cb4=_0x31b547;if(_0xa65105[_0x126cb4(0x269)][_0x126cb4(0x263)]===0x0)return[''];const _0x5958fa=_0x126cb4(0x25e),_0x215bf4=_0x5958fa+_0x126cb4(0x291),_0x3822c5=[{'id':_0xa43662['CreateUnitMutation']['id'],'action':_0x5958fa+_0x126cb4(0xf1)},{'id':_0xa43662[_0x126cb4(0x2a6)]['id'],'action':_0x5958fa+_0x126cb4(0x105)},{'id':_0x467fd2['InsertSheetMutation']['id'],'action':_0x5958fa+_0x126cb4(0x137)},{'id':_0x467fd2[_0x126cb4(0x270)]['id'],'action':_0x5958fa+_0x126cb4(0x19d)},{'id':_0x467fd2['SetFrozenMutation']['id'],'action':_0x5958fa+_0x126cb4(0x162)},{'id':_0x2eebc6[_0x126cb4(0x1cc)]['id'],'action':_0x5958fa+_0x126cb4(0xf7)},{'id':_0x2b3974[_0x126cb4(0x112)]['id'],'action':_0x5958fa+_0x126cb4(0x132)},{'id':_0x2b3974[_0x126cb4(0x1be)]['id'],'action':_0x5958fa+_0x126cb4(0x132)},{'id':_0x532ec1[_0x126cb4(0x204)]['id'],'action':_0x5958fa+_0x126cb4(0x14d)},{'id':_0x532ec1[_0x126cb4(0x2ad)]['id'],'action':_0x5958fa+_0x126cb4(0x14d)},{'id':_0x467fd2[_0x126cb4(0x104)]['id'],'action':_0x5958fa+_0x126cb4(0x21e)},{'id':_0x467fd2['AddRangeProtectionMutation']['id'],'action':_0x5958fa+_0x126cb4(0x21e)},{'id':_0x52613e[_0x126cb4(0x217)]['id'],'action':_0x5958fa+'addSparkline'},{'id':_0x467fd2[_0x126cb4(0x184)]['id'],'action':_0x5958fa+_0x126cb4(0x167)},{'id':_0x467fd2['DeleteWorksheetProtectionMutation']['id'],'action':_0x5958fa+_0x126cb4(0x167)}][_0x126cb4(0x216)](_0x3771b5=>_0xa65105[_0x126cb4(0x269)][_0x126cb4(0x22a)](_0x3771b5['id']));return _0x3822c5!=null&&_0x3822c5['length']?_0x3822c5['map'](_0x39bbb7=>_0x39bbb7[_0x126cb4(0x147)]):[_0x215bf4];}function _0x10059b(_0x3b4c13,_0xcd7a75){const _0x5d293f=_0x31b547,[_0x5d3579,_0x478f63,_0x2d673f]=new Date()[_0x5d293f(0x2ae)]()[_0x5d293f(0x15d)]('T')[0x0][_0x5d293f(0x15d)]('-'),[_0x2370bb,_0x33185f,_0x554c5b]=_0x3b4c13[_0x5d293f(0x15d)]('-'),_0x4af5c6=_0x5d3579===_0x2370bb&&_0x478f63===_0x33185f&&_0x2d673f===_0x554c5b;let _0x4bc2d1='',_0x16acad='',_0x3d27e6='';switch(_0xcd7a75){case _0x242e1a[_0x5d293f(0x165)][_0x5d293f(0x1ac)]:return _0x4af5c6?'':(_0x4bc2d1=_0x5d3579===_0x2370bb?'':_0x2370bb+'',_0x16acad=_0x33185f+'',_0x3d27e6=_0x554c5b+'',''+_0x4bc2d1+_0x16acad+_0x3d27e6);default:return _0x4af5c6?_0x5d293f(0x16f):(_0x4bc2d1=_0x5d3579===_0x2370bb?'':_0x2370bb+'-',_0x16acad=_0x33185f+'-',_0x3d27e6=''+_0x554c5b,''+_0x4bc2d1+_0x16acad+_0x3d27e6);}}function _0x521051(_0x2ebe50){const _0x32f199=_0x31b547;return _0x2ebe50?_0x2ebe50[_0x32f199(0x178)]((_0x43f7aa,_0x1e84b4)=>{const _0x503f82=_0x32f199,_0x423f80=new Date(_0x1e84b4[_0x503f82(0x1de)])[_0x503f82(0x2ae)]()['split']('T')[0x0];return _0x43f7aa['length']>0x0&&_0x43f7aa[_0x43f7aa[_0x503f82(0x263)]-0x1][_0x503f82(0xf3)]===_0x423f80?_0x43f7aa[_0x43f7aa[_0x503f82(0x263)]-0x1][_0x503f82(0x175)][_0x503f82(0x9d)](_0x1e84b4):_0x43f7aa[_0x503f82(0x9d)]({'dateString':_0x423f80,'versions':[_0x1e84b4]}),_0x43f7aa;},[]):[];}var _0x49b78e=Object[_0x31b547(0xee)],_0x5b717d=(_0x557e5a,_0x45ff8b,_0xe9eb38,_0x429a60)=>{for(var _0x4fcdbd=_0x429a60>0x1?void 0x0:_0x429a60?_0x49b78e(_0x45ff8b,_0xe9eb38):_0x45ff8b,_0x4defb8=_0x557e5a['length']-0x1,_0x12bdfa;_0x4defb8>=0x0;_0x4defb8--)(_0x12bdfa=_0x557e5a[_0x4defb8])&&(_0x4fcdbd=_0x12bdfa(_0x4fcdbd)||_0x4fcdbd);return _0x4fcdbd;},_0xde113=(_0x3d5130,_0x172e9b)=>(_0x721783,_0x49db48)=>_0x172e9b(_0x721783,_0x49db48,_0x3d5130);const _0x589cb3=_0x31b547(0xae);let _0x1e528b=class extends _0x242e1a['Disposable']{constructor(_0xe7edda,_0x24f3e0,_0x13db19,_0x543baf,_0x160d5a,_0xfbaf75,_0x28c8be){const _0x2218c1=_0x31b547;super(),_0x554995(this,_0x2218c1(0xf0),new Map()),(this['_snapshotServerService']=_0xe7edda,this[_0x2218c1(0x1e6)]=_0x24f3e0,this['_commandService']=_0x13db19,this[_0x2218c1(0x1e5)]=_0x543baf,this[_0x2218c1(0x198)]=_0x160d5a,this['_compressMutationService']=_0xfbaf75,this[_0x2218c1(0x26d)]=_0x28c8be);}[_0x31b547(0x21a)](){const _0x10557a=_0x31b547;this[_0x10557a(0xf0)][_0x10557a(0x9f)](),super['dispose']();}async['getVersions'](_0x5e1ccc,_0x3e8098){const _0x16e7bb=_0x31b547,_0x3668c4=this[_0x16e7bb(0x227)]()+'/'+_0x5e1ccc+'/list?length=20'+(_0x3e8098?_0x16e7bb(0x259)+_0x3e8098:'');try{const _0x328d16=(await this[_0x16e7bb(0x198)]['get'](_0x3668c4))['body'];if(_0x328d16&&_0x328d16['error']&&_0x328d16[_0x16e7bb(0x277)][_0x16e7bb(0x183)]===_0x3f26b4['OK']){const {hasMore:_0x208a1d,lastLabel:_0x4852db}=_0x328d16,_0x4674d6=_0x4052b4(_0x328d16),_0x7db076=_0x328d16[_0x16e7bb(0x268)][_0x16e7bb(0x12b)];return{'hasMore':_0x208a1d,'lastLabel':_0x4852db,'versions':_0x4674d6,'members':_0x7db076};}}catch(_0x33b820){console[_0x16e7bb(0x277)](_0x33b820);}return null;}[_0x31b547(0x227)](){const _0x3fdf16=_0x31b547;var _0x383e26;const _0x345d47=this[_0x3fdf16(0x1e5)][_0x3fdf16(0x1db)](_0x1ac248);return(_0x383e26=_0x345d47==null?void 0x0:_0x345d47['historyListServerUrl'])!=null?_0x383e26:_0x589cb3;}async[_0x31b547(0xed)](_0x2fdb6d,_0x1d9d89,_0x52a5ad){const _0xb3edf2=_0x31b547;var _0x4d5973,_0xcc03ee;_0x52a5ad===void 0x0&&(_0x52a5ad={}),this[_0xb3edf2(0xf0)][_0xb3edf2(0x1e2)](_0x2fdb6d)||this[_0xb3edf2(0xf0)][_0xb3edf2(0xbf)](_0x2fdb6d,new Map());const {snapshot:_0x4e7433,changesets:_0x506ce6,error:_0x44dce2}=await this[_0xb3edf2(0x15a)][_0xb3edf2(0x2b2)](_0x52a5ad,{'unitID':_0x2fdb6d,'type':_0x57e78f[_0xb3edf2(0x220)],'revision':_0x1d9d89});if(_0x4ac758(_0x44dce2)||!_0x4e7433||!_0x4e7433[_0xb3edf2(0x13a)])throw new Error(_0xb3edf2(0x2c5));const _0x8a7fba=(_0x4d5973=_0x506ce6==null?void 0x0:_0x506ce6[_0xb3edf2(0x263)])!=null?_0x4d5973:0x0;if(_0x1d9d89!==0x0&&_0x4e7433[_0xb3edf2(0x1bf)]+_0x8a7fba!==_0x1d9d89)throw new Error(_0xb3edf2(0x239));const {workbook:_0xa9717c}=_0x4e7433,_0xbb48b7=_0xa9717c[_0xb3edf2(0x25f)]?Object['entries'](_0xa9717c['blockMeta'])[_0xb3edf2(0x280)](([_0x2341d7,_0x4dfb79])=>{const _0x1e50bc=_0xb3edf2;var _0x1b94ab,_0x2e3ee2;return(_0x2e3ee2=(_0x1b94ab=_0x4dfb79[_0x1e50bc(0x248)])==null?void 0x0:_0x1b94ab['map'](_0x5cda98=>_0x5cda98))!=null?_0x2e3ee2:[];})['flat']():[],_0x3f0a83=(await Promise[_0xb3edf2(0x294)](_0xbb48b7[_0xb3edf2(0x280)](_0x372ab1=>this['_snapshotServerService'][_0xb3edf2(0x1f1)](_0x52a5ad,{'unitID':_0x2fdb6d,'type':_0x57e78f[_0xb3edf2(0x220)],'blockID':_0x372ab1})[_0xb3edf2(0x1da)](_0x3166fb=>_0x3166fb[_0xb3edf2(0x149)]))))['filter'](_0x6ec88=>!!_0x6ec88),_0x5980d6=_0xa43662['transformSnapshotToWorkbookData'](_0x4e7433,_0x3f0a83,_0x52a5ad);return(_0xcc03ee=this[_0xb3edf2(0xf0)]['get'](_0x2fdb6d))==null||_0xcc03ee[_0xb3edf2(0xbf)](_0x1d9d89,{'workbook':_0x5980d6}),new Promise(_0x4b6cc1=>{const _0x49736d=_0xb3edf2,_0x2dff9a=this[_0x49736d(0x1e6)][_0x49736d(0x121)](_0x242e1a[_0x49736d(0x24c)][_0x49736d(0x220)]);_0x2dff9a?(this[_0x49736d(0x1e6)][_0x49736d(0x25b)](_0x2dff9a[_0x49736d(0xb5)]()),setTimeout(()=>{const _0x203259=_0x49736d;this[_0x203259(0x19c)](_0x5980d6,_0x506ce6),this[_0x203259(0x26d)][_0x203259(0x24d)](),_0x4b6cc1(!0x0);},0x0)):(this['_createUnit'](_0x5980d6,_0x506ce6),_0x4b6cc1(!0x0));});}[_0x31b547(0x19c)](_0x29b036,_0x3fd315){const _0xdd62eb=_0x31b547,_0x5e618a=this[_0xdd62eb(0x1e6)][_0xdd62eb(0x126)](_0x242e1a[_0xdd62eb(0x24c)][_0xdd62eb(0x220)],_0x29b036);this['_univerInstanceService'][_0xdd62eb(0x297)](_0x5e618a[_0xdd62eb(0xb5)]());const _0x12d8e3=this[_0xdd62eb(0x2c1)][_0xdd62eb(0x1fe)][_0xdd62eb(0x23c)](this['_compressMutationService'][_0xdd62eb(0x1fe)][_0xdd62eb(0x1cb)]()[_0xdd62eb(0x242)]);return _0x3fd315==null||_0x3fd315[_0xdd62eb(0x1f5)](_0x2cb55f=>{const _0x2ad601=_0xdd62eb,_0x250d64=_0x2cb55f['mutations']['map'](_0x11bccc=>({'id':_0x11bccc['id'],'params':JSON[_0x2ad601(0x13d)](_0x11bccc[_0x2ad601(0x10e)])}));({..._0x2cb55f,'mutations':_0x12d8e3(_0x250d64,null)||_0x250d64}[_0x2ad601(0x9b)][_0x2ad601(0x1f5)](_0x2ff079=>{const _0x18a575=_0x2ad601;this[_0x18a575(0x185)][_0x18a575(0x1a7)](_0x2ff079['id'])&&this['_commandService'][_0x18a575(0x1f7)](_0x2ff079['id'],_0x2ff079[_0x18a575(0x2a0)]);}));}),_0x5e618a;}};_0x1e528b=_0x5b717d([_0xde113(0x0,_0xa43662['ISnapshotServerService']),_0xde113(0x1,_0x242e1a['IUniverInstanceService']),_0xde113(0x2,_0x242e1a[_0x31b547(0xa5)]),_0xde113(0x3,_0x242e1a[_0x31b547(0x22c)]),_0xde113(0x4,_0x242e1a['Inject'](_0x3ebdc4[_0x31b547(0x129)])),_0xde113(0x5,_0x242e1a[_0x31b547(0x11f)](_0xa43662[_0x31b547(0x211)])),_0xde113(0x6,_0x242e1a[_0x31b547(0x11f)](_0x467fd2[_0x31b547(0x230)]))],_0x1e528b);function _0x4052b4(_0x564b08){const _0x2d52e8=_0x31b547;var _0x21dd95,_0x58b092;const _0x3a705d=[],{entities:_0x39c252,historyIds:_0x567365}=_0x564b08,{datas:_0x2de79c,users:_0x2267b5}=_0x39c252;for(const _0xd1b61e of _0x567365)if(_0x2de79c[_0xd1b61e]){const _0x46f8ca=!!((_0x21dd95=_0x2267b5[_0x2de79c[_0xd1b61e][_0x2d52e8(0x200)]])!=null&&_0x21dd95['anonymous']);_0x3a705d[_0x2d52e8(0x9d)]({'unitId':_0x2de79c[_0xd1b61e][_0x2d52e8(0x148)],'user':_0x46f8ca?'':((_0x58b092=_0x2267b5==null?void 0x0:_0x2267b5[_0x2de79c[_0xd1b61e][_0x2d52e8(0x200)]])==null?void 0x0:_0x58b092[_0x2d52e8(0xe2)])||'','isAnonymous':_0x46f8ca,'id':_0xd1b61e,'time':_0x2de79c[_0xd1b61e][_0x2d52e8(0x246)]?Number(_0x2de79c[_0xd1b61e]['createTime']):void 0x0,'commands':_0x2de79c[_0xd1b61e]['command'],'startRev':Number(_0x2de79c[_0xd1b61e]['startRevision']),'endRev':Number(_0x2de79c[_0xd1b61e][_0x2d52e8(0x12d)]),'recoverTime':_0x2de79c[_0xd1b61e]['recoverTime']?Number(_0x2de79c[_0xd1b61e][_0x2d52e8(0xd1)]):void 0x0});}return _0x3a705d;}var _0xa059e2=Object[_0x31b547(0xee)],_0xc3fd21=(_0x3b8481,_0x1fde2e,_0x4b2b2,_0x10fa2e)=>{const _0x2db6ff=_0x31b547;for(var _0x216cba=_0x10fa2e>0x1?void 0x0:_0x10fa2e?_0xa059e2(_0x1fde2e,_0x4b2b2):_0x1fde2e,_0x23f215=_0x3b8481[_0x2db6ff(0x263)]-0x1,_0x19f0e7;_0x23f215>=0x0;_0x23f215--)(_0x19f0e7=_0x3b8481[_0x23f215])&&(_0x216cba=_0x19f0e7(_0x216cba)||_0x216cba);return _0x216cba;},_0x1bcdd6=(_0x543db4,_0x22096e)=>(_0x18bba3,_0x32de44)=>_0x22096e(_0x18bba3,_0x32de44,_0x543db4),_0x3eaf5d=(_0x4f7259=>(_0x4f7259['Entered']=_0x31b547(0x1c3),_0x4f7259['Exited']=_0x31b547(0x2c3),_0x4f7259['Error']=_0x31b547(0x277),_0x4f7259))(_0x3eaf5d||{}),_0x576eaa=(_0x19cd17=>(_0x19cd17[_0x31b547(0xc1)]=_0x31b547(0x1bc),_0x19cd17[_0x31b547(0x16e)]='loading',_0x19cd17[_0x31b547(0x27c)]=_0x31b547(0xcd),_0x19cd17))(_0x576eaa||{});const _0x5e37df=_0x31b547(0x296);_0x4d70eb[_0x31b547(0x1fd)]=class extends _0x242e1a['Disposable']{constructor(_0x2484b8,_0x59b52a,_0x4dbdc2,_0x3a0afd){const _0x34b4b7=_0x31b547;super(),_0x554995(this,_0x34b4b7(0x218),new _0x2a386a[(_0x34b4b7(0x2ac))]([])),_0x554995(this,'versions$',this[_0x34b4b7(0x218)]['asObservable']()),_0x554995(this,_0x34b4b7(0x15c),new _0x2a386a[(_0x34b4b7(0x2ac))]('')),_0x554995(this,_0x34b4b7(0xd4),this[_0x34b4b7(0x15c)][_0x34b4b7(0x1e8)]()),_0x554995(this,_0x34b4b7(0x28c),new _0x2a386a[(_0x34b4b7(0x2ac))](_0x34b4b7(0x1c3))),_0x554995(this,_0x34b4b7(0x161),this['_status$'][_0x34b4b7(0x1e8)]()),_0x554995(this,_0x34b4b7(0x172),new _0x2a386a[(_0x34b4b7(0x2ac))](0x0)),_0x554995(this,_0x34b4b7(0x29e),this[_0x34b4b7(0x172)][_0x34b4b7(0x1e8)]()),_0x554995(this,'_unitId$',new _0x2a386a[(_0x34b4b7(0x2ac))]('')),_0x554995(this,_0x34b4b7(0x2b9),this[_0x34b4b7(0xa2)][_0x34b4b7(0x1e8)]()),_0x554995(this,_0x34b4b7(0xdf),!0x1),_0x554995(this,_0x34b4b7(0x12c),new _0x2a386a['BehaviorSubject'](_0x34b4b7(0x1bc))),_0x554995(this,'loadingState$',this[_0x34b4b7(0x12c)]['asObservable']()),_0x554995(this,_0x34b4b7(0xac),null),_0x554995(this,_0x34b4b7(0x285),!0x0),_0x554995(this,'_members',new Map()),_0x554995(this,_0x34b4b7(0x188)),_0x554995(this,'_maskContainer'),_0x554995(this,_0x34b4b7(0xc7)),_0x554995(this,_0x34b4b7(0x134),!0x1),(this[_0x34b4b7(0x2b1)]=_0x2484b8,this[_0x34b4b7(0x2a5)]=_0x59b52a,this[_0x34b4b7(0x244)]=_0x4dbdc2,this[_0x34b4b7(0x282)]=_0x3a0afd);}async['triggerLoadVersions'](_0x5f2c01,_0xd6bb33,_0xd4f5ba){const _0x529118=_0x31b547;this[_0x529118(0x188)]=_0xd6bb33,this[_0x529118(0x134)]=_0xd4f5ba,this['_unitId$']['next'](_0x5f2c01),this[_0x529118(0xdf)]=!0x0;const _0x1f4459=await this['_historyFetchService'][_0x529118(0x1fa)](_0x5f2c01);if(this['_fetching']=!0x1,_0x1f4459){const {versions:_0x554d3e,lastLabel:_0xc9e02d,hasMore:_0x404040,members:_0x1016bf}=_0x1f4459;_0x554d3e[_0x529118(0x263)]===0x0&&_0x554d3e['push']({'unitId':_0x5f2c01,'id':_0x5e37df,'startRev':0x1,'endRev':0x0,'time':Date[_0x529118(0xa0)](),'user':this[_0x529118(0x244)]['t'](_0x529118(0x122)),'commands':[],'isAnonymous':!0x1}),this['_updateVersions'](_0x554d3e,_0x404040,_0xc9e02d,_0x1016bf),this[_0x529118(0x15c)][_0x529118(0x141)](_0x554d3e[0x0]['id']);}else this[_0x529118(0x28c)][_0x529118(0x141)](_0x529118(0x277));}async[_0x31b547(0x2b4)](){const _0x13f696=_0x31b547;if(!this[_0x13f696(0xac)]||!this[_0x13f696(0x285)]||this['_fetching'])return!0x1;this[_0x13f696(0xdf)]=!0x0;const _0x13fbe1=await this['_historyFetchService']['getVersions'](this[_0x13f696(0x148)],this[_0x13f696(0xac)]);if(this[_0x13f696(0xdf)]=!0x1,_0x13fbe1){const {versions:_0x4b734c,lastLabel:_0x1431bc,hasMore:_0x1deda1,members:_0x35615d}=_0x13fbe1;this['_updateVersions'](_0x4b734c,_0x1deda1,_0x1431bc,_0x35615d);}else this[_0x13f696(0x2b1)][_0x13f696(0x1d6)]({'content':this[_0x13f696(0x244)]['t'](_0x13f696(0x170)),'type':_0x368c21[_0x13f696(0x2cd)]['Error'],'duration':0xbb8});return!0x0;}async[_0x31b547(0x199)](_0x15b2bf){const _0x176b0d=_0x31b547;var _0xaeb6a3;const _0x2d6453=(_0xaeb6a3=this['_versions$'][_0x176b0d(0x266)])==null?void 0x0:_0xaeb6a3[_0x176b0d(0x1d8)](_0x455232=>_0x455232['id']===_0x15b2bf),{endRev:_0x405ba3}=_0x2d6453||{};_0x405ba3||_0x405ba3===0x0?(this[_0x176b0d(0x12c)][_0x176b0d(0x141)]('loading'),await this['_historyFetchService'][_0x176b0d(0xed)](this[_0x176b0d(0x148)],_0x405ba3),this['_loadingState$']['next'](_0x176b0d(0xcd))):this[_0x176b0d(0x28c)]['next'](_0x176b0d(0x277));}async[_0x31b547(0xcf)](_0x311a79){const _0x588636=_0x31b547,_0x764c40=_0x311a79?this[_0x588636(0x258)](_0x311a79):this['getCurrentVersion']();if(!_0x764c40)return;const _0x3b1d8a=_0x764c40[_0x588636(0x22d)],_0x347aa9=_0x558a9b(_0x764c40[_0x588636(0x1de)],this[_0x588636(0x244)][_0x588636(0xfe)]());await this[_0x588636(0x2a5)][_0x588636(0x1d9)]({'id':_0x588636(0x23a),'title':{'title':this['_localeService']['t'](_0x588636(0x249))},'children':{'title':this['_localeService']['t']('editHistory.panel.revertConfirmText')+_0x588636(0x2d3)+_0x347aa9[_0x588636(0x173)]+'\x20'+_0x347aa9[_0x588636(0x1de)]+')'},'cancelText':this['_localeService']['t'](_0x588636(0xe8)),'confirmText':this[_0x588636(0x244)]['t'](_0x588636(0xc8))})&&this[_0x588636(0x172)]['next'](_0x3b1d8a);}[_0x31b547(0xc0)](_0x200c4a,_0xaeaf4e,_0x2f07bd,_0x17e087){const _0x3a41a1=_0x31b547;this['_versions$']['next'](this['_versions$'][_0x3a41a1(0x266)][_0x3a41a1(0x22b)](_0x200c4a)),this[_0x3a41a1(0x285)]=_0xaeaf4e,this[_0x3a41a1(0xac)]=_0x2f07bd,_0x17e087&&Object[_0x3a41a1(0x99)](_0x17e087)['forEach'](_0x22048b=>this[_0x3a41a1(0x2c6)][_0x3a41a1(0xbf)](_0x22048b,_0x17e087[_0x22048b]));}['getCurrentVersion'](){const _0x3c766e=_0x31b547;return this[_0x3c766e(0x258)](this['_currentVersion$'][_0x3c766e(0x266)]);}['getVersion'](_0xdec813){const _0x293568=_0x31b547;var _0x1a41d6;return(_0x1a41d6=this[_0x293568(0x218)][_0x293568(0x266)])==null?void 0x0:_0x1a41d6[_0x293568(0x1d8)](_0x3a45ce=>_0x3a45ce['id']===_0xdec813);}[_0x31b547(0xa8)](_0x4225d5){const _0x48ccfa=_0x31b547;return this['_members'][_0x48ccfa(0x272)](_0x4225d5);}[_0x31b547(0x290)](){const _0x39e4e4=_0x31b547;this[_0x39e4e4(0xc7)]=document[_0x39e4e4(0x103)]('div'),this[_0x39e4e4(0xc7)]['className']=_0x39e4e4(0x22e),this['_maskElement'][_0x39e4e4(0x2c7)][_0x39e4e4(0x10a)]='absolute',this[_0x39e4e4(0xc7)][_0x39e4e4(0x2c7)][_0x39e4e4(0xaf)]='0',this[_0x39e4e4(0xc7)][_0x39e4e4(0x2c7)][_0x39e4e4(0xdc)]='0',this[_0x39e4e4(0xc7)][_0x39e4e4(0x2c7)][_0x39e4e4(0x234)]='100%',this[_0x39e4e4(0xc7)][_0x39e4e4(0x2c7)][_0x39e4e4(0x18c)]=_0x39e4e4(0x229),this[_0x39e4e4(0xc7)]['style']['backgroundColor']=_0x39e4e4(0x26a),this[_0x39e4e4(0xc7)][_0x39e4e4(0x2c7)]['color']=_0x39e4e4(0x17e),this['_maskElement'][_0x39e4e4(0x2c7)]['display']=_0x39e4e4(0x222),this[_0x39e4e4(0xc7)][_0x39e4e4(0x2c7)][_0x39e4e4(0xb9)]=_0x39e4e4(0x2ba),this[_0x39e4e4(0xc7)][_0x39e4e4(0x2c7)][_0x39e4e4(0x14f)]=_0x39e4e4(0x225),this[_0x39e4e4(0xc7)][_0x39e4e4(0x2c7)][_0x39e4e4(0x1f6)]=_0x39e4e4(0x154),this[_0x39e4e4(0x2a9)]['append'](this[_0x39e4e4(0xc7)]);}[_0x31b547(0x16c)](){const _0x448ef4=_0x31b547;var _0x41ba1f;const _0x10eadd=(_0x41ba1f=document[_0x448ef4(0x19a)](this[_0x448ef4(0x188)]))==null?void 0x0:_0x41ba1f[_0x448ef4(0x228)](_0x448ef4(0x29f));_0x10eadd&&(this[_0x448ef4(0x2a9)]=_0x10eadd,this[_0x448ef4(0x290)]());}[_0x31b547(0x138)](){const _0x357b2c=_0x31b547;this[_0x357b2c(0x2a9)]||this['_initMaskContainer'](),this[_0x357b2c(0xc7)]&&(this[_0x357b2c(0xc7)][_0x357b2c(0x2c7)][_0x357b2c(0x1f6)]='flex');}[_0x31b547(0x98)](){const _0xa94c1c=_0x31b547;this[_0xa94c1c(0xc7)]&&(this['_maskElement'][_0xa94c1c(0x2c7)]['display']=_0xa94c1c(0x154));}set[_0x31b547(0xb3)](_0x2c50d7){this['_status$']['next'](_0x2c50d7);}set[_0x31b547(0x28b)](_0x5250a3){const _0x4cccba=_0x31b547;_0x5250a3!==this[_0x4cccba(0x15c)][_0x4cccba(0x266)]&&this['_currentVersion$'][_0x4cccba(0x141)](_0x5250a3);}get[_0x31b547(0x28b)](){return this['_currentVersion$']['value'];}set['unitId'](_0x20390a){const _0x5c526b=_0x31b547;this[_0x5c526b(0xa2)]['next'](_0x20390a);}get[_0x31b547(0x148)](){const _0xd780e5=_0x31b547;return this[_0xd780e5(0xa2)][_0xd780e5(0x266)];}get[_0x31b547(0x2a8)](){const _0x954e48=_0x31b547;return this[_0x954e48(0x134)];}get[_0x31b547(0x205)](){const _0x1253e3=_0x31b547;return this[_0x1253e3(0x12c)]['value'];}},_0x4d70eb[_0x31b547(0x1fd)]=_0xc3fd21([_0x1bcdd6(0x0,_0x1bf0bf[_0x31b547(0x1b8)]),_0x1bcdd6(0x1,_0x1bf0bf[_0x31b547(0x1d3)]),_0x1bcdd6(0x2,_0x242e1a['Inject'](_0x242e1a[_0x31b547(0x113)])),_0x1bcdd6(0x3,_0x242e1a[_0x31b547(0x11f)](_0x1e528b))],_0x4d70eb[_0x31b547(0x1fd)]);function _0xd27a99({ref:_0x5d0250,..._0x3f2690}){const _0x18ac28=_0x31b547,{icon:_0xd0316b,id:_0x693385,className:_0x364555,extend:_0x2822aa,..._0x50f41e}=_0x3f2690,_0x3a745c=(_0x18ac28(0x19b)+_0x693385+'\x20'+(_0x364555||''))['trim'](),_0xf6d7a3=_0x3f8f3c[_0x18ac28(0xc5)]('_'+_0x4dee21());return _0xffafb3(_0xd0316b,''+_0x693385,{'defIds':_0xd0316b['defIds'],'idSuffix':_0xf6d7a3[_0x18ac28(0x289)]},{'ref':_0x5d0250,'className':_0x3a745c,..._0x50f41e},_0x2822aa);}function _0xffafb3(_0x156428,_0x24f309,_0x15f7b5,_0x562889,_0x17983e){const _0x119960=_0x31b547;return _0x3f8f3c['createElement'](_0x156428[_0x119960(0x245)],{'key':_0x24f309,..._0x329378(_0x156428,_0x15f7b5,_0x17983e),..._0x562889},(_0x215454(_0x156428,_0x15f7b5)['children']||[])[_0x119960(0x280)]((_0x30c5e7,_0x30be40)=>_0xffafb3(_0x30c5e7,_0x24f309+'-'+_0x156428[_0x119960(0x245)]+'-'+_0x30be40,_0x15f7b5,void 0x0,_0x17983e)));}function _0x329378(_0x411bf2,_0x270ee7,_0x1122d7){const _0x59c0f8=_0x31b547,_0x34093a={..._0x411bf2[_0x59c0f8(0x159)]};_0x1122d7!=null&&_0x1122d7[_0x59c0f8(0x1b7)]&&_0x34093a[_0x59c0f8(0x18f)]===_0x59c0f8(0x1b7)&&(_0x34093a[_0x59c0f8(0x18f)]=_0x1122d7[_0x59c0f8(0x1b7)]),_0x411bf2['tag']===_0x59c0f8(0x255)&&_0x34093a['id']&&(_0x34093a['id']=_0x34093a['id']+_0x270ee7[_0x59c0f8(0x197)]),Object['entries'](_0x34093a)[_0x59c0f8(0x1f5)](([_0x29eb41,_0x15526e])=>{const _0xdccd40=_0x59c0f8;_0x29eb41===_0xdccd40(0x255)&&typeof _0x15526e=='string'&&(_0x34093a[_0x29eb41]=_0x15526e['replace'](/url\(#(.*)\)/,_0xdccd40(0x20e)+_0x270ee7[_0xdccd40(0x197)]+')'));});const {defIds:_0x6c3179}=_0x270ee7;return!_0x6c3179||_0x6c3179[_0x59c0f8(0x263)]===0x0||(_0x411bf2[_0x59c0f8(0x245)]===_0x59c0f8(0x2b5)&&_0x34093a['xlink:href']&&(_0x34093a[_0x59c0f8(0xe7)]=_0x34093a[_0x59c0f8(0xe7)]+_0x270ee7[_0x59c0f8(0x197)]),Object[_0x59c0f8(0x116)](_0x34093a)[_0x59c0f8(0x1f5)](([_0x4b222f,_0x3f3b43])=>{const _0x477b82=_0x59c0f8;typeof _0x3f3b43==_0x477b82(0xd3)&&(_0x34093a[_0x4b222f]=_0x3f3b43['replace'](/url\(#(.*)\)/,_0x477b82(0x20e)+_0x270ee7['idSuffix']+')'));})),_0x34093a;}function _0x215454(_0xe26dc2,_0xe641bd){const _0x65ecaa=_0x31b547;var _0x20dd50;const {defIds:_0x1b9e9b}=_0xe641bd;return!_0x1b9e9b||_0x1b9e9b[_0x65ecaa(0x263)]===0x0?_0xe26dc2:_0xe26dc2[_0x65ecaa(0x245)]==='defs'&&((_0x20dd50=_0xe26dc2['children'])!=null&&_0x20dd50['length'])?{..._0xe26dc2,'children':_0xe26dc2[_0x65ecaa(0x28e)]['map'](_0x25090a=>typeof _0x25090a[_0x65ecaa(0x159)]['id']==_0x65ecaa(0xd3)&&_0x1b9e9b&&_0x1b9e9b['includes'](_0x25090a[_0x65ecaa(0x159)]['id'])?{..._0x25090a,'attrs':{..._0x25090a[_0x65ecaa(0x159)],'id':_0x25090a['attrs']['id']+_0xe641bd['idSuffix']}}:_0x25090a)}:_0xe26dc2;}function _0x4dee21(){const _0x3ff2e3=_0x31b547;return Math['random']()['toString'](0x24)[_0x3ff2e3(0x1ef)](0x2,0x8);}_0xd27a99['displayName']='UniverIcon';const _0x117b3f={'tag':_0x31b547(0x284),'attrs':{'xmlns':_0x31b547(0x1dc),'fill':'none','viewBox':'0\x200\x2016\x2016','width':_0x31b547(0x102),'height':_0x31b547(0x102)},'children':[{'tag':_0x31b547(0x253),'attrs':{'fill':_0x31b547(0x1b0),'d':_0x31b547(0x18d)}}]},_0x7764d3=_0x3f8f3c[_0x31b547(0xcb)](function(_0x20889b,_0x15f116){const _0x5789fc=_0x31b547;return _0x3f8f3c[_0x5789fc(0x103)](_0xd27a99,Object[_0x5789fc(0x19e)]({},_0x20889b,{'id':'back-icon','ref':_0x15f116,'icon':_0x117b3f}));});_0x7764d3[_0x31b547(0x107)]=_0x31b547(0x2a4);const _0x4e8567={'tag':'svg','attrs':{'xmlns':_0x31b547(0x1dc),'fill':_0x31b547(0x154),'viewBox':_0x31b547(0x21b),'width':_0x31b547(0x102),'height':_0x31b547(0x102)},'children':[{'tag':'g','attrs':{'fill':'currentColor','clipPath':_0x31b547(0x179)},'children':[{'tag':'path','attrs':{'d':_0x31b547(0x13e)}},{'tag':'path','attrs':{'d':_0x31b547(0xb4),'fillRule':_0x31b547(0x158),'clipRule':_0x31b547(0x158)}}]},{'tag':_0x31b547(0x182),'attrs':{},'children':[{'tag':_0x31b547(0x278),'attrs':{'id':_0x31b547(0x28a)},'children':[{'tag':_0x31b547(0xa4),'attrs':{'width':0x10,'height':0x10,'y':0.05,'fill':'white','rx':0x4}}]}]}],'defIds':[_0x31b547(0x28a)]},_0x343251=_0x3f8f3c[_0x31b547(0xcb)](function(_0x3530e0,_0x3ace04){const _0x2823ed=_0x31b547;return _0x3f8f3c[_0x2823ed(0x103)](_0xd27a99,Object['assign']({},_0x3530e0,{'id':_0x2823ed(0x1a8),'ref':_0x3ace04,'icon':_0x4e8567}));});_0x343251[_0x31b547(0x107)]='RestoreIcon';const _0x1f2635={'tag':'svg','attrs':{'xmlns':_0x31b547(0x1dc),'fill':'none','viewBox':_0x31b547(0x17d),'width':'1em','height':_0x31b547(0x102)},'children':[{'tag':_0x31b547(0x253),'attrs':{'fill':_0x31b547(0xf2),'d':'M8.79993\x2014.0166C8.79993\x2014.4585\x208.44176\x2014.8166\x207.99993\x2014.8166C4.23529\x2014.8166\x201.18345\x2011.7648\x201.18345\x208.00017C1.18345\x204.23554\x204.23529\x201.18369\x207.99993\x201.1837C11.7646\x201.1837\x2014.8164\x204.23554\x2014.8164\x208.00017C14.8164\x208.442\x2014.4582\x208.80017\x2014.0164\x208.80017C13.5746\x208.80017\x2013.2164\x208.442\x2013.2164\x208.00017C13.2164\x205.11919\x2010.8809\x202.7837\x207.99993\x202.7837C5.11895\x202.7837\x202.78345\x205.11919\x202.78345\x208.00017C2.78345\x2010.8812\x205.11895\x2013.2166\x207.99993\x2013.2166C8.44176\x2013.2166\x208.79993\x2013.5748\x208.79993\x2014.0166Z','fillOpacity':0.2,'fillRule':_0x31b547(0x158),'clipRule':'evenodd'}},{'tag':_0x31b547(0x253),'attrs':{'fill':_0x31b547(0xf2),'d':'M7.20007\x201.98384C7.20007\x201.54201\x207.55824\x201.18384\x208.00007\x201.18384C11.7647\x201.18384\x2014.8165\x204.23568\x2014.8165\x208.00032C14.8165\x2011.765\x2011.7647\x2014.8168\x208.00007\x2014.8168C4.23543\x2014.8168\x201.18359\x2011.765\x201.18359\x208.00032C1.18359\x207.55849\x201.54177\x207.20031\x201.98359\x207.20031C2.42542\x207.20031\x202.78359\x207.55849\x202.78359\x208.00032C2.78359\x2010.8813\x205.11909\x2013.2168\x208.00007\x2013.2168C10.8811\x2013.2168\x2013.2165\x2010.8813\x2013.2165\x208.00032C13.2165\x205.11933\x2010.8811\x202.78384\x208.00007\x202.78384C7.55824\x202.78384\x207.20007\x202.42567\x207.20007\x201.98384Z','fillRule':'evenodd','clipRule':_0x31b547(0x158)}}]},_0x265f14=_0x3f8f3c[_0x31b547(0xcb)](function(_0x2ce705,_0x33d708){const _0x426226=_0x31b547;return _0x3f8f3c[_0x426226(0x103)](_0xd27a99,Object[_0x426226(0x19e)]({},_0x2ce705,{'id':'loading-multi-icon','ref':_0x33d708,'icon':_0x1f2635}));});_0x265f14[_0x31b547(0x107)]=_0x31b547(0xa3);function _0x3b7200(){const _0x3ffe2a=_0x31b547;var _0x434bdf;const _0x4b5a66=_0x1bf0bf[_0x3ffe2a(0x260)](_0x4d70eb['HistoryManagerService']),_0x5964b4=_0x1bf0bf[_0x3ffe2a(0x260)](_0x242e1a[_0x3ffe2a(0x113)]),_0x1f0fe8=_0x3f8f3c[_0x3ffe2a(0x2c2)](()=>{const _0x501697=_0x3ffe2a;_0x4b5a66[_0x501697(0xb3)]=_0x3eaf5d['Exited'];},[_0x4b5a66]),_0x53de66=_0x3f8f3c[_0x3ffe2a(0x2c2)](()=>{const _0xba2fdd=_0x3ffe2a;_0x4b5a66[_0xba2fdd(0xcf)]();},[_0x4b5a66]),_0x56db79=_0x1bf0bf[_0x3ffe2a(0x238)](_0x4b5a66[_0x3ffe2a(0xd4)]),_0xa29094=_0x1bf0bf[_0x3ffe2a(0x238)](_0x4b5a66[_0x3ffe2a(0x206)]),_0x5e9ecd=_0x56db79===((_0x434bdf=_0xa29094==null?void 0x0:_0xa29094[0x0])==null?void 0x0:_0x434bdf['id']),_0x2a10dc=_0x56db79!==''&&!_0x5e9ecd&&_0x4b5a66[_0x3ffe2a(0x2a8)];return _0x7b355a[_0x3ffe2a(0x27e)](_0x3ffe2a(0x2d1),{'className':_0x368c21[_0x3ffe2a(0x275)](_0x3ffe2a(0x202),_0x368c21[_0x3ffe2a(0x29c)]),'children':[_0x7b355a[_0x3ffe2a(0xfa)]('a',{'className':_0x3ffe2a(0x1d0),'role':_0x3ffe2a(0x1d4),'onClick':_0x1f0fe8,'children':_0x7b355a[_0x3ffe2a(0xfa)](_0x7764d3,{'className':_0x3ffe2a(0x25d)})}),_0x7b355a[_0x3ffe2a(0xfa)](_0x3ffe2a(0x2d1),{'className':'univer-flex\x20univer-flex-1\x20univer-items-center\x20univer-justify-center','children':_0x2a10dc&&_0x7b355a['jsx'](_0x368c21['Button'],{'variant':'primary','onClick':_0x53de66,'children':_0x5964b4['t'](_0x3ffe2a(0x1dd))})})]});}var _0x9ad3e2=Object[_0x31b547(0xee)],_0x18ab86=(_0x2b8668,_0x3f6b98,_0x213f28,_0x129853)=>{const _0x3bee9a=_0x31b547;for(var _0x29ef78=_0x129853>0x1?void 0x0:_0x129853?_0x9ad3e2(_0x3f6b98,_0x213f28):_0x3f6b98,_0x250efa=_0x2b8668[_0x3bee9a(0x263)]-0x1,_0x506cf1;_0x250efa>=0x0;_0x250efa--)(_0x506cf1=_0x2b8668[_0x250efa])&&(_0x29ef78=_0x506cf1(_0x29ef78)||_0x29ef78);return _0x29ef78;},_0x1696e5=(_0x4e6c45,_0x2d558e)=>(_0x3173a8,_0x418a4a)=>_0x2d558e(_0x3173a8,_0x418a4a,_0x4e6c45);let _0x509149=class extends _0x242e1a[_0x31b547(0x16b)]{constructor(_0x264d8e,_0x351638,_0x4c175f,_0x2dbed9,_0x2626c9,_0x5e96b9){const _0x454e7d=_0x31b547;super(),this[_0x454e7d(0x288)]=_0x264d8e,this['_uiPartsService']=_0x351638,this['_messageService']=_0x4c175f,this[_0x454e7d(0x244)]=_0x2dbed9,this[_0x454e7d(0x20a)]=_0x2626c9,this[_0x454e7d(0x1df)]=_0x5e96b9,this[_0x454e7d(0xea)]();}[_0x31b547(0xea)](){const _0x1fff5f=_0x31b547;this[_0x1fff5f(0x1c2)](this[_0x1fff5f(0x20a)][_0x1fff5f(0xd4)][_0x1fff5f(0x177)](_0x2bd3d9=>{const _0x514099=_0x1fff5f;_0x2bd3d9&&this['_historyManagerService'][_0x514099(0x199)](_0x2bd3d9);})),this[_0x1fff5f(0x1c2)](this['_permissionService']['permissionPointUpdate$'][_0x1fff5f(0x177)](_0x4a680e=>{const _0x25ee77=_0x1fff5f,_0x5ba603=this[_0x25ee77(0x20a)][_0x25ee77(0x148)];_0x5ba603&&(_0x4a680e[_0x25ee77(0x2d5)]===_0x3df9c5[_0x25ee77(0xfc)]&&_0x4a680e[_0x25ee77(0x266)]===!0x0&&this['_permissionService'][_0x25ee77(0x12e)](new _0x467fd2[(_0x25ee77(0x111))](_0x5ba603)['id'],!0x1),_0x4a680e[_0x25ee77(0x2d5)]===_0x3df9c5[_0x25ee77(0x1ff)]&&_0x4a680e['value']===!0x0&&this['_permissionService']['updatePermissionPoint'](new _0x467fd2[(_0x25ee77(0x2cb))](_0x5ba603)['id'],!0x1),_0x4a680e[_0x25ee77(0x2d5)]===_0x3df9c5['MoveSheet']&&_0x4a680e[_0x25ee77(0x266)]===!0x0&&this['_permissionService'][_0x25ee77(0x12e)](new _0x467fd2[(_0x25ee77(0x26b))](_0x5ba603)['id'],!0x1),_0x4a680e[_0x25ee77(0x2d5)]===_0x3df9c5[_0x25ee77(0x169)]&&_0x4a680e[_0x25ee77(0x266)]===!0x0&&this['_permissionService'][_0x25ee77(0x12e)](new _0x467fd2[(_0x25ee77(0x1e9))](_0x5ba603)['id'],!0x1),_0x4a680e[_0x25ee77(0x2d5)]===_0x3df9c5[_0x25ee77(0x1a1)]&&_0x4a680e[_0x25ee77(0x266)]===!0x0&&this['_permissionService'][_0x25ee77(0x12e)](new _0x467fd2[(_0x25ee77(0x111))](_0x5ba603)['id'],!0x1),_0x4a680e[_0x25ee77(0x2d5)]===_0x3df9c5[_0x25ee77(0x26f)]&&_0x4a680e[_0x25ee77(0x266)]===!0x0&&this['_permissionService'][_0x25ee77(0x12e)](new _0x467fd2['WorkbookEditablePermission'](_0x5ba603)['id'],!0x1));})),this['disposeWithMe'](this[_0x1fff5f(0x281)][_0x1fff5f(0xbb)](_0x1bf0bf['BuiltInUIPart'][_0x1fff5f(0x20c)],()=>_0x1bf0bf['connectInjector'](_0x3b7200,this[_0x1fff5f(0x1df)]))),this[_0x1fff5f(0x1c2)](this['_historyManagerService'][_0x1fff5f(0x13c)]['subscribe'](_0x4447bb=>{const _0x5a78d1=_0x1fff5f;_0x4447bb===_0x576eaa[_0x5a78d1(0x16e)]&&(this[_0x5a78d1(0x20a)]['showMask'](),this['_messageService']['show']({'type':_0x368c21[_0x5a78d1(0x2cd)][_0x5a78d1(0x135)],'content':this[_0x5a78d1(0x244)]['t'](_0x5a78d1(0x240))})),_0x4447bb===_0x576eaa[_0x5a78d1(0x27c)]&&this['_historyManagerService']['hideMask']();}));}};_0x509149=_0x18ab86([_0x1696e5(0x0,_0x242e1a[_0x31b547(0x254)]),_0x1696e5(0x1,_0x1bf0bf[_0x31b547(0x168)]),_0x1696e5(0x2,_0x1bf0bf[_0x31b547(0x1b8)]),_0x1696e5(0x3,_0x242e1a['Inject'](_0x242e1a['LocaleService'])),_0x1696e5(0x4,_0x242e1a[_0x31b547(0x11f)](_0x4d70eb[_0x31b547(0x1fd)])),_0x1696e5(0x5,_0x242e1a[_0x31b547(0x11f)](_0x242e1a[_0x31b547(0x265)]))],_0x509149);var _0x516ed6=Object['getOwnPropertyDescriptor'],_0x4b87a5=(_0x5a7b8c,_0x11a3c3,_0x16baf4,_0x1273ce)=>{const _0x5ece9e=_0x31b547;for(var _0x2f7629=_0x1273ce>0x1?void 0x0:_0x1273ce?_0x516ed6(_0x11a3c3,_0x16baf4):_0x11a3c3,_0x1c4202=_0x5a7b8c[_0x5ece9e(0x263)]-0x1,_0x5a59cb;_0x1c4202>=0x0;_0x1c4202--)(_0x5a59cb=_0x5a7b8c[_0x1c4202])&&(_0x2f7629=_0x5a59cb(_0x2f7629)||_0x2f7629);return _0x2f7629;},_0x4885e9=(_0x5c744c,_0x1977d1)=>(_0xf56ad,_0x5279a6)=>_0x1977d1(_0xf56ad,_0x5279a6,_0x5c744c);let _0xf4d0fb=class extends _0x242e1a[_0x31b547(0x16b)]{constructor(_0x10c8f0,_0x41d153,_0xc9774d){const _0x401dbb=_0x31b547;super(),_0x554995(this,_0x401dbb(0x24f),new Map()),_0x554995(this,'_currentVersionDiff$',new _0x2a386a[(_0x401dbb(0x2ac))]({'ranges':new Map(),'active':null})),_0x554995(this,'currentVersionDiff$',this[_0x401dbb(0x196)][_0x401dbb(0x1e8)]()),(this[_0x401dbb(0x20a)]=_0x10c8f0,this[_0x401dbb(0x120)]=_0x41d153,this['_snapshotServerService']=_0xc9774d,this[_0x401dbb(0xea)]());}[_0x31b547(0xea)](){const _0x4420f6=_0x31b547;this[_0x4420f6(0x24f)]=new Map(),this[_0x4420f6(0x1c2)](this['_historyManagerService'][_0x4420f6(0x2b9)][_0x4420f6(0x177)](_0x515656=>{const _0xeb352e=_0x4420f6;_0x515656&&!this['_diffRangesMap'][_0xeb352e(0x1e2)](_0x515656)&&this[_0xeb352e(0x24f)]['set'](_0x515656,new Map());})),this[_0x4420f6(0x1c2)](this[_0x4420f6(0x20a)][_0x4420f6(0xd4)][_0x4420f6(0x177)](async _0x9d24a9=>{const _0x35be8a=_0x4420f6;var _0x3d4c20;_0x9d24a9&&(await this[_0x35be8a(0x213)](_0x9d24a9),this['_currentVersionDiff$'][_0x35be8a(0x141)](((_0x3d4c20=this[_0x35be8a(0x24f)]['get'](this[_0x35be8a(0x20a)][_0x35be8a(0x148)]))==null?void 0x0:_0x3d4c20[_0x35be8a(0x272)](_0x9d24a9))||{'ranges':new Map(),'active':null}));}));}async[_0x31b547(0x213)](_0x2cad90){const _0x34a070=_0x31b547;var _0x45a6de,_0x359543;const _0x269d80=this[_0x34a070(0x20a)]['getVersion'](_0x2cad90),_0x397fe9=this[_0x34a070(0x20a)]['unitId'];if(!_0x269d80||!_0x397fe9)return;const _0x309df9=this[_0x34a070(0x24f)]['get'](_0x397fe9);if(_0x309df9||this['_diffRangesMap'][_0x34a070(0xbf)](_0x397fe9,new Map()),(_0x45a6de=this[_0x34a070(0x24f)][_0x34a070(0x272)](_0x397fe9))!=null&&_0x45a6de[_0x34a070(0x1e2)](_0x269d80['id']))return;const {startRev:_0x14577a,endRev:_0x223c21}=_0x269d80;if(_0x14577a===0x1){_0x309df9[_0x34a070(0xbf)](_0x269d80['id'],{'ranges':new Map(),'active':null});return;}const _0x5afd2d=_0x14577a-0x1,_0x2756a2=_0x223c21,_0x13187f=await this[_0x34a070(0x15a)][_0x34a070(0x119)]({},{'unitID':_0x397fe9,'from':_0x5afd2d,'to':_0x2756a2,'type':_0x57e78f[_0x34a070(0x220)]});if(((_0x359543=_0x13187f[_0x34a070(0x277)])==null?void 0x0:_0x359543[_0x34a070(0x183)])===_0x3f26b4['OK']){const _0x454d3c=_0x13187f[_0x34a070(0xa1)][_0x34a070(0x280)](_0x3658fd=>((_0x3658fd['mutations']===null||_0x3658fd[_0x34a070(0x9b)]===void 0x0)&&(_0x3658fd[_0x34a070(0x9b)]=[]),_0xa43662[_0x34a070(0x29d)](_0x3658fd)))[_0x34a070(0x280)](_0xfd3ca3=>_0xfd3ca3[_0x34a070(0x9b)][_0x34a070(0x280)](_0x13a234=>({..._0x13a234,'params':{..._0x13a234[_0x34a070(0x2a0)],'memberId':_0xfd3ca3[_0x34a070(0x191)]}})))['flat'](),_0x14f9b5=this[_0x34a070(0x19f)](_0x454d3c),_0x5289a4=this[_0x34a070(0x287)](_0x454d3c),_0xa3f889=this[_0x34a070(0xda)](_0x14f9b5);_0x309df9['set'](_0x269d80['id'],{'ranges':_0xa3f889,'active':_0x5289a4});}}[_0x31b547(0x19f)](_0x1acbd2){const _0x373794=_0x31b547;let _0x52c847=[];for(let _0x2ee5cf=0x0;_0x2ee5cf<_0x1acbd2['length'];_0x2ee5cf++){const _0x2e2987=_0x1acbd2[_0x2ee5cf];if(_0x52c847[_0x373794(0x9d)](_0x2e2987),_0x2ee5cf!==_0x1acbd2['length']-0x1){const _0xab06e6=_0x1acbd2[_0x2ee5cf+0x1],_0x5db412=this[_0x373794(0x120)][_0x373794(0x14e)](_0x52c847,[_0xab06e6]);_0xa43662['isTransformMutationsSuccess'](_0x5db412)?_0x52c847=_0x5db412[_0x373794(0xb0)]:_0x52c847=[];}}return _0x52c847;}[_0x31b547(0x287)](_0x28ba30){const _0x6b35b7=_0x31b547;let _0x38cfff=[];return _0x28ba30[_0x6b35b7(0x1f5)](_0x402737=>{const _0x6f8dc1=_0x6b35b7;if(_0x402737['id']===_0x467fd2[_0x6f8dc1(0x1e3)]['id']){const _0x215020=_0x402737[_0x6f8dc1(0x2a0)];_0x38cfff[_0x6f8dc1(0x9d)](_0x215020[_0x6f8dc1(0x142)]['id']);}else{if(_0x402737['id']===_0x467fd2[_0x6f8dc1(0x270)]['id']){const _0x2e1ef5=_0x402737[_0x6f8dc1(0x2a0)];_0x38cfff[_0x6f8dc1(0x263)]>0x0&&(_0x38cfff=_0x38cfff[_0x6f8dc1(0x216)](_0x3ab2d2=>_0x3ab2d2!==_0x2e1ef5['subUnitId']));}else{if(_0x402737['id']===_0x467fd2[_0x6f8dc1(0x9c)]['id']){const _0x4ba195=_0x402737[_0x6f8dc1(0x2a0)];_0x4ba195[_0x6f8dc1(0x1b2)]?_0x38cfff=_0x38cfff[_0x6f8dc1(0x216)](_0x79963c=>_0x79963c!==_0x4ba195[_0x6f8dc1(0x276)]):_0x38cfff[_0x6f8dc1(0x9d)](_0x4ba195[_0x6f8dc1(0x276)]);}else{const _0x37bf6a=_0x402737[_0x6f8dc1(0x2a0)];_0x37bf6a[_0x6f8dc1(0x276)]&&_0x38cfff[_0x6f8dc1(0x9d)](_0x37bf6a[_0x6f8dc1(0x276)]);}}}}),_0x38cfff['length']>0x0?_0x38cfff[_0x38cfff['length']-0x1]:null;}[_0x31b547(0xda)](_0x3164fb){const _0x426d13=_0x31b547,_0x209ea8=new Map();return _0x3164fb[_0x426d13(0x1f5)](_0x174ad7=>{const _0x3f9136=_0x426d13;var _0x45794c,_0x4411f7;const _0x1c0137=(_0x45794c=_0x174ad7[_0x3f9136(0x2a0)])==null?void 0x0:_0x45794c[_0x3f9136(0x226)];if(_0x1c0137){_0x209ea8[_0x3f9136(0x1e2)](_0x1c0137)||_0x209ea8[_0x3f9136(0xbf)](_0x1c0137,[]);const _0x1b5287=this[_0x3f9136(0x189)](_0x174ad7);(_0x4411f7=_0x209ea8[_0x3f9136(0x272)](_0x1c0137))==null||_0x4411f7[_0x3f9136(0x9d)](..._0x1b5287);}}),_0x209ea8['forEach']((_0x2d37c1,_0x5003fc)=>{_0x209ea8['set'](_0x5003fc,this['_combineRanges'](_0x2d37c1));}),_0x209ea8;}[_0x31b547(0x189)](_0x17f153){const _0x4cd28b=_0x31b547;switch(_0x17f153['id']){case _0x467fd2[_0x4cd28b(0x160)]['id']:{const _0x325a04=_0x17f153[_0x4cd28b(0x2a0)];return _0x325a04[_0x4cd28b(0x1b4)][_0x4cd28b(0x280)](_0xd09a9=>_0xd09a9[_0x4cd28b(0xf4)][_0x4cd28b(0x280)](_0x51b3c0=>({'range':_0x51b3c0,'unitId':_0x325a04[_0x4cd28b(0x148)],'subUnitId':_0x325a04[_0x4cd28b(0x276)]})))[_0x4cd28b(0xe5)]();}case _0x467fd2['AddWorksheetMergeMutation']['id']:{const _0x1d7f18=_0x17f153[_0x4cd28b(0x2a0)];return _0x1d7f18[_0x4cd28b(0xf4)][_0x4cd28b(0x280)](_0x1436f1=>({'range':_0x1436f1,'unitId':_0x1d7f18[_0x4cd28b(0x148)],'subUnitId':_0x1d7f18[_0x4cd28b(0x276)]}));}case _0x467fd2[_0x4cd28b(0x283)]['id']:{const _0x3f7f37=_0x17f153['params'];return[{'range':_0x3f7f37[_0x4cd28b(0x2a1)],'unitId':_0x3f7f37[_0x4cd28b(0x148)],'subUnitId':_0x3f7f37[_0x4cd28b(0x276)]}];}case _0x467fd2[_0x4cd28b(0x2c4)]['id']:{const _0x1a2fe6=_0x17f153[_0x4cd28b(0x2a0)];return[{'range':_0x1a2fe6[_0x4cd28b(0x2a1)],'unitId':_0x1a2fe6[_0x4cd28b(0x148)],'subUnitId':_0x1a2fe6[_0x4cd28b(0x276)]}];}case _0x467fd2[_0x4cd28b(0xd9)]['id']:{const _0x1ee49a=_0x17f153[_0x4cd28b(0x2a0)],{from:_0x5442ae,to:_0x36b434,unitId:_0x5aad82}=_0x1ee49a;return[{'range':_0x37bedf(_0x5442ae['value']),'unitId':_0x5aad82,'subUnitId':_0x5442ae[_0x4cd28b(0x276)]},{'range':_0x37bedf(_0x36b434[_0x4cd28b(0x266)]),'unitId':_0x5aad82,'subUnitId':_0x36b434[_0x4cd28b(0x276)]}];}case _0x467fd2[_0x4cd28b(0x130)]['id']:{const _0x24184e=_0x17f153[_0x4cd28b(0x2a0)],{unitId:_0x4b6aa3,subUnitId:_0x964749,sourceRange:_0x52dd3f,targetRange:_0x4f549a}=_0x24184e,_0x1dff02=_0x52dd3f[_0x4cd28b(0x293)]-_0x52dd3f['startRow']+0x1;return[{'range':_0x4f549a[_0x4cd28b(0x1c7)]<=_0x52dd3f['startRow']?_0x4f549a:{..._0x4f549a,'startRow':_0x4f549a[_0x4cd28b(0x1c7)]-_0x1dff02,'endRow':_0x4f549a[_0x4cd28b(0x293)]-_0x1dff02},'unitId':_0x4b6aa3,'subUnitId':_0x964749}];}case _0x467fd2[_0x4cd28b(0x24e)]['id']:{const _0x5ac01b=_0x17f153['params'],{unitId:_0x124bfb,subUnitId:_0x8aa672,sourceRange:_0x133f5e,targetRange:_0x456bbf}=_0x5ac01b,_0x294afa=_0x133f5e[_0x4cd28b(0xef)]-_0x133f5e['startColumn']+0x1;return[{'range':_0x456bbf[_0x4cd28b(0x1c9)]<=_0x133f5e[_0x4cd28b(0x1c9)]?_0x456bbf:{..._0x456bbf,'startColumn':_0x456bbf['startColumn']-_0x294afa,'endColumn':_0x456bbf[_0x4cd28b(0xef)]-_0x294afa},'unitId':_0x124bfb,'subUnitId':_0x8aa672}];}case _0x467fd2[_0x4cd28b(0xf8)]['id']:{const _0x134d8c=_0x17f153[_0x4cd28b(0x2a0)],{values:_0x3d2700,unitId:_0xb38ee8,subUnitId:_0x1ff212}=_0x134d8c;return Object['values'](_0x3d2700)[_0x4cd28b(0x280)](_0x588602=>_0x588602['ranges']['map'](_0x112372=>({'range':_0x112372,'unitId':_0xb38ee8,'subUnitId':_0x1ff212})))['flat']();}case _0x467fd2['RemoveNumfmtMutation']['id']:{const _0x1e9117=_0x17f153[_0x4cd28b(0x2a0)],{ranges:_0x4c7f61,unitId:_0x17c8e9,subUnitId:_0x1cff8c}=_0x1e9117;return _0x4c7f61[_0x4cd28b(0x280)](_0x52a7b2=>({'range':_0x52a7b2,'unitId':_0x17c8e9,'subUnitId':_0x1cff8c}));}case _0x467fd2[_0x4cd28b(0x187)]['id']:{const _0x1061ed=_0x17f153[_0x4cd28b(0x2a0)],{unitId:_0x43a4c0,subUnitId:_0xb0139f,range:_0x125e46}=_0x1061ed;return[{'range':_0x125e46,'unitId':_0x43a4c0,'subUnitId':_0xb0139f}];}case _0x467fd2['SetRangeProtectionMutation']['id']:{const _0x2748ed=_0x17f153['params'];return _0x2748ed[_0x4cd28b(0xc2)]['ranges'][_0x4cd28b(0x280)](_0x467ae1=>({'range':_0x467ae1,'unitId':_0x2748ed[_0x4cd28b(0x148)],'subUnitId':_0x2748ed[_0x4cd28b(0x276)]}));}case _0x467fd2[_0x4cd28b(0x17b)]['id']:{const _0x44fe5a=_0x17f153[_0x4cd28b(0x2a0)];return _0x44fe5a[_0x4cd28b(0x143)]?_0x57b5ff(_0x44fe5a[_0x4cd28b(0x143)])[_0x4cd28b(0x280)](_0x154e91=>({'range':_0x154e91,'unitId':_0x44fe5a[_0x4cd28b(0x148)],'subUnitId':_0x44fe5a['subUnitId']})):[];}case _0x2eebc6[_0x4cd28b(0x1cc)]['id']:{const _0x354000=_0x17f153[_0x4cd28b(0x2a0)];return[{'range':_0x354000[_0x4cd28b(0x2a1)],'unitId':_0x354000[_0x4cd28b(0x148)],'subUnitId':_0x354000['subUnitId']}];}case _0x2b3974[_0x4cd28b(0x112)]['id']:{const _0x44f181=_0x17f153[_0x4cd28b(0x2a0)];return(Array['isArray'](_0x44f181[_0x4cd28b(0xc2)])?_0x44f181[_0x4cd28b(0xc2)]:[_0x44f181[_0x4cd28b(0xc2)]])[_0x4cd28b(0x280)](_0x29c06c=>_0x29c06c[_0x4cd28b(0xf4)]['map'](_0x1133fc=>({'range':_0x1133fc,'unitId':_0x44f181[_0x4cd28b(0x148)],'subUnitId':_0x44f181[_0x4cd28b(0x276)]})))[_0x4cd28b(0xe5)]();}case _0x532ec1[_0x4cd28b(0x204)]['id']:{const _0x841c6c=_0x17f153['params'];return _0x841c6c['rule'][_0x4cd28b(0xf4)][_0x4cd28b(0x280)](_0x4cd46f=>({'range':_0x4cd46f,'unitId':_0x841c6c[_0x4cd28b(0x148)],'subUnitId':_0x841c6c[_0x4cd28b(0x276)]}));}default:return[];}}[_0x31b547(0xc3)](_0x27a9a3){const _0x1894f7=_0x31b547;if(_0x27a9a3['length']<=0x1)return _0x27a9a3;const _0x21fcb3=new Map();return _0x27a9a3['forEach'](_0x2bb72e=>{const _0x20442c=_0xfb6f;var _0x4ec420;const {unitId:_0x462b30,subUnitId:_0x1b508d}=_0x2bb72e,_0x45ae3d=_0x462b30+'-'+_0x1b508d;_0x21fcb3[_0x20442c(0x1e2)](_0x45ae3d)?(_0x4ec420=_0x21fcb3['get'](_0x45ae3d))==null||_0x4ec420[_0x20442c(0x9d)](_0x2bb72e):_0x21fcb3[_0x20442c(0xbf)](_0x45ae3d,[_0x2bb72e]);}),Array[_0x1894f7(0xaa)](_0x21fcb3[_0x1894f7(0x27a)]())[_0x1894f7(0x280)](_0x22f0f2=>new _0x467fd2[(_0x1894f7(0x14b))]()[_0x1894f7(0x1ed)](..._0x22f0f2[_0x1894f7(0x280)](_0x4a28b3=>_0x4a28b3[_0x1894f7(0x2a1)]))[_0x1894f7(0x114)]()[_0x1894f7(0x280)](_0x4d221a=>({'range':_0x4d221a,'unitId':_0x22f0f2[0x0]['unitId'],'subUnitId':_0x22f0f2[0x0][_0x1894f7(0x276)]})))[_0x1894f7(0xe5)]();}};_0xf4d0fb=_0x4b87a5([_0x4885e9(0x0,_0x242e1a[_0x31b547(0x11f)](_0x4d70eb['HistoryManagerService'])),_0x4885e9(0x1,_0xa43662[_0x31b547(0x25a)]),_0x4885e9(0x2,_0xa43662[_0x31b547(0x171)])],_0xf4d0fb);function _0x37bedf(_0x3cf9e1){const _0x485ebf=_0x31b547;return new _0x242e1a[(_0x485ebf(0x117))](_0x3cf9e1)[_0x485ebf(0x1f9)]();}function _0x57b5ff(_0x1c36fa){const _0x1d16cf=_0x31b547,_0x4db583=new _0x242e1a['ObjectMatrix'](_0x1c36fa),_0x5d6e20=new _0x242e1a[(_0x1d16cf(0x117))]();return _0x4db583['forValue']((_0x2129b8,_0x375063)=>{const _0x51a5d8=_0x1d16cf;_0x5d6e20[_0x51a5d8(0x1cf)](_0x2129b8,_0x375063,0x1);}),_0x467fd2['findAllRectangle'](_0x5d6e20);}var _0x144e18=Object[_0x31b547(0xee)],_0x39e913=(_0x537400,_0x3cf440,_0x3db9d7,_0x4adec5)=>{const _0x4e642f=_0x31b547;for(var _0x182b49=_0x4adec5>0x1?void 0x0:_0x4adec5?_0x144e18(_0x3cf440,_0x3db9d7):_0x3cf440,_0x1a6c95=_0x537400[_0x4e642f(0x263)]-0x1,_0x49a370;_0x1a6c95>=0x0;_0x1a6c95--)(_0x49a370=_0x537400[_0x1a6c95])&&(_0x182b49=_0x49a370(_0x182b49)||_0x182b49);return _0x182b49;},_0x459e0a=(_0x2e29ed,_0x576faa)=>(_0x36e20f,_0x3132d6)=>_0x576faa(_0x36e20f,_0x3132d6,_0x2e29ed);let _0x5705b4=class extends _0x242e1a[_0x31b547(0x16b)]{constructor(_0x3d38fe,_0x9ea559,_0x1f0799,_0x1d2358,_0x16ef02,_0x5384fe,_0x4a6580){const _0x28c4d7=_0x31b547;super(),_0x554995(this,_0x28c4d7(0x1f3),new Set()),_0x554995(this,_0x28c4d7(0xe9),null),(this[_0x28c4d7(0x2a7)]=_0x3d38fe,this[_0x28c4d7(0x20a)]=_0x9ea559,this['_versionDiffService']=_0x1f0799,this[_0x28c4d7(0x1e6)]=_0x1d2358,this['_renderManagerService']=_0x16ef02,this['_sheetSkeletonManagerService']=_0x5384fe,this[_0x28c4d7(0x185)]=_0x4a6580,this[_0x28c4d7(0xea)]());}[_0x31b547(0xea)](){const _0x9d4be6=_0x31b547;this['_initRender'](),this[_0x9d4be6(0x1ee)]();}[_0x31b547(0x118)](){const _0x59df90=_0x31b547;this[_0x59df90(0x1c2)](_0x2a386a[_0x59df90(0x219)]([this[_0x59df90(0x20a)][_0x59df90(0x13c)],this[_0x59df90(0x231)][_0x59df90(0x1a2)]])[_0x59df90(0x2bf)](_0x2a386a[_0x59df90(0x18a)](([_0x164977,_0x9fa8c])=>{const _0x52e673=_0x59df90;if(_0x164977===_0x576eaa[_0x52e673(0x27c)]&&_0x9fa8c){const _0x297198=_0x9fa8c[_0x52e673(0x1f8)];return this[_0x52e673(0x2ca)][_0x52e673(0x236)][_0x52e673(0x2bf)](_0x2a386a[_0x52e673(0x280)](_0x5f1c38=>{const _0x3d4bec=_0x52e673,_0x32f275=new Map();return _0x5f1c38[_0x3d4bec(0xf4)][_0x3d4bec(0x1f5)]((_0x519eb2,_0x316d87)=>{const _0x3f4e8b=_0x3d4bec,_0x516e57=_0x519eb2[_0x3f4e8b(0x216)](_0x58fdb4=>_0x58fdb4['subUnitId']===_0x297198);_0x32f275[_0x3f4e8b(0xbf)](_0x316d87,_0x516e57);}),{'skeleton':_0x9fa8c,'diffs':_0x32f275};}));}return _0x2a386a['of']({'skeleton':null,'diffs':new Map()});}))[_0x59df90(0x177)](({skeleton:_0xaad6ea,diffs:_0x41f686})=>{const _0x20f001=_0x59df90;this[_0x20f001(0xc9)](),_0xaad6ea&&this['_updateDiffMarks'](_0xaad6ea,_0x41f686);})),this[_0x59df90(0x1c2)](this[_0x59df90(0x231)][_0x59df90(0x1a2)]['subscribe'](_0x1b31c1=>{const _0x35d922=_0x59df90;if(_0x1b31c1==null)return;const {skeleton:_0x3524fd}=_0x1b31c1,{scene:_0x54d115}=this['_context'];_0x54d115[_0x35d922(0x146)]['subscribeEvent'](_0x242e1a[_0x35d922(0x2b3)](_0x173d93=>{const _0x3ea16f=_0x35d922;var _0x4432de,_0x3756c9;const {offsetX:_0x5c27f3,offsetY:_0x394432}=_0x173d93,{x:_0x118b4a,y:_0x4edcdf}=_0x54d115[_0x3ea16f(0x13f)](_0xfc4827[_0x3ea16f(0x2c9)][_0x3ea16f(0x181)]([_0x5c27f3,_0x394432])),{scaleX:_0x33bc2a,scaleY:_0x5b87aa}=_0x54d115[_0x3ea16f(0x23d)](),_0x67fd0a=_0x54d115['getViewport'](_0xfc4827[_0x3ea16f(0x23e)]['VIEW_MAIN']),_0x458c5e=_0x54d115[_0x3ea16f(0xf9)](_0xfc4827[_0x3ea16f(0x2c9)][_0x3ea16f(0x181)]([_0x118b4a,_0x4edcdf]),_0x67fd0a),_0x53a269=_0x3524fd['getCellPositionByOffset'](_0x5c27f3,_0x394432,_0x33bc2a,_0x5b87aa,_0x458c5e);((_0x4432de=this[_0x3ea16f(0xe9)])==null?void 0x0:_0x4432de[_0x3ea16f(0x2a2)])===_0x53a269['column']&&((_0x3756c9=this[_0x3ea16f(0xe9)])==null?void 0x0:_0x3756c9[_0x3ea16f(0xb1)])===_0x53a269[_0x3ea16f(0xb1)]||this[_0x3ea16f(0x1f3)][_0x3ea16f(0x1f5)](_0x5d42dc=>{const _0x1d9dea=_0x3ea16f;_0x5d42dc[_0x1d9dea(0x9a)](_0x53a269);});},0x64));}));}[_0x31b547(0x1ee)](){const _0x18fcd7=_0x31b547;this[_0x18fcd7(0x1c2)](this['_historyManagerService'][_0x18fcd7(0x13c)]['subscribe'](_0x534b0c=>{const _0x4e684b=_0x18fcd7,_0x5bd25b=new _0x242e1a[(_0x4e684b(0x29a))]();return _0x534b0c===_0x576eaa[_0x4e684b(0x27c)]&&(_0x5bd25b['dispose'](),_0x5bd25b[_0x4e684b(0x1ed)](this[_0x4e684b(0x2ca)]['currentVersionDiff$']['subscribe'](_0x1f333a=>{const _0x2c61e4=_0x4e684b;_0x1f333a[_0x2c61e4(0x241)]&&this[_0x2c61e4(0x185)]['executeCommand'](_0x467fd2[_0x2c61e4(0x286)]['id'],{'unitId':this[_0x2c61e4(0x2a7)][_0x2c61e4(0x148)],'subUnitId':_0x1f333a[_0x2c61e4(0x241)]});}))),()=>_0x5bd25b[_0x4e684b(0x21a)]();}));}[_0x31b547(0x1ba)](_0x476f95,_0x444132){const _0x45cf9f=_0x31b547;var _0x5e748d;const _0x35c2cf=(_0x5e748d=this[_0x45cf9f(0x231)][_0x45cf9f(0x267)]())==null?void 0x0:_0x5e748d[_0x45cf9f(0x145)];if(!_0x35c2cf)return;this[_0x45cf9f(0x1f3)][_0x45cf9f(0x1f5)](_0x5a0273=>{const _0x28a68d=_0x45cf9f;_0x5a0273[_0x28a68d(0x128)]();});const {scene:_0x47bae0}=this[_0x45cf9f(0x2a7)],_0x21d1f7=Array[_0x45cf9f(0xaa)](_0x444132[_0x45cf9f(0x99)]())['map'](_0x50e975=>_0x444132[_0x45cf9f(0x272)](_0x50e975)[_0x45cf9f(0x280)](_0x17234f=>{const _0x2ce160=_0x45cf9f;var _0x25eccf;const {range:_0x380a54,subUnitId:_0x13ff4d,unitId:_0x127c74}=_0x17234f,{startColumn:_0x408476,startRow:_0x4e32a3,endColumn:_0x277753,endRow:_0x24397c}=_0x380a54,_0x2377cb=_0x316cbf[_0x2ce160(0x14c)](_0x4e32a3,_0x408476,_0x47bae0,_0x35c2cf),_0x5f0071=_0x316cbf[_0x2ce160(0x14c)](_0x24397c,_0x277753,_0x47bae0,_0x35c2cf),{columnHeaderHeightAndMarginTop:_0x51e13a}=_0x35c2cf,{startX:_0x2c9fd5,startY:_0x104c52}=_0x2377cb,{endX:_0x46dbb0,endY:_0xc5b041}=_0x5f0071,_0x1319d7=_0x46dbb0-_0x2c9fd5,_0x461383=_0xc5b041-_0x104c52,_0x2ec3af={'labelPosition':_0x104c52-_0x51e13a>=0x14?_0x2ce160(0xaf):_0x2ce160(0xbe),'sheetID':_0x13ff4d,'range':_0x380a54,'color':_0x2ce160(0xd2),'fillAfterStrokeEnabled':!0x0,'backgroundColor':_0x2ce160(0xd2),'name':((_0x25eccf=this[_0x2ce160(0x20a)][_0x2ce160(0xa8)](_0x50e975))==null?void 0x0:_0x25eccf[_0x2ce160(0xe2)])||'','selection':_0x127c74+'-'+_0x13ff4d+'-'+_0x380a54[_0x2ce160(0x1c9)]+'-'+_0x380a54['startRow']+'-'+_0x380a54['endColumn']+'-'+_0x380a54[_0x2ce160(0x293)],'left':_0x2c9fd5,'top':_0x104c52,'width':_0x1319d7,'height':_0x461383,'evented':!0x1,'zIndex':0x1};return new _0x444a03[(_0x2ce160(0x2b6))]('',_0x2ec3af);}))['flat']();_0x47bae0[_0x45cf9f(0xeb)](_0x21d1f7,0x1),this[_0x45cf9f(0x1f3)]=new Set(_0x21d1f7);}['_removeDiffMarks'](){const _0x41e7eb=_0x31b547;var _0x4840ca;(_0x4840ca=this[_0x41e7eb(0x1f3)])==null||_0x4840ca[_0x41e7eb(0x1f5)](_0x4f95be=>_0x4f95be[_0x41e7eb(0x21a)]());}['_getSheetObject'](){const _0x27d0e7=_0x31b547;return _0x316cbf[_0x27d0e7(0x1a0)](this[_0x27d0e7(0x1e6)],this[_0x27d0e7(0x151)]);}};_0x5705b4=_0x39e913([_0x459e0a(0x1,_0x242e1a[_0x31b547(0x11f)](_0x4d70eb['HistoryManagerService'])),_0x459e0a(0x2,_0x242e1a['Inject'](_0xf4d0fb)),_0x459e0a(0x3,_0x242e1a[_0x31b547(0x1bd)]),_0x459e0a(0x4,_0xfc4827['IRenderManagerService']),_0x459e0a(0x5,_0x242e1a['Inject'](_0x316cbf[_0x31b547(0x235)])),_0x459e0a(0x6,_0x242e1a[_0x31b547(0xa5)])],_0x5705b4);function _0x5468c2(){const _0x56a4c0=_0x31b547,_0x252b3c=_0x1bf0bf['useDependency'](_0x4d70eb['HistoryManagerService']),_0x2e5e48=_0x1bf0bf[_0x56a4c0(0x238)](_0x252b3c[_0x56a4c0(0x206)]),[_0x17e11b,_0xceaccf]=_0x3f8f3c[_0x56a4c0(0x1a6)](!0x1),_0x51acb3=_0x521051(_0x2e5e48);return _0x2e5e48?_0x7b355a[_0x56a4c0(0xfa)]('div',{'className':_0x56a4c0(0xb8),'children':_0x7b355a[_0x56a4c0(0x27e)](_0x56a4c0(0x2d1),{'className':_0x56a4c0(0x209),'children':[_0x51acb3['map']((_0x31fd23,_0x541f0f)=>_0x7b355a[_0x56a4c0(0x27e)](_0x3f8f3c[_0x56a4c0(0x2cc)],{'children':[_0x7b355a[_0x56a4c0(0xfa)](_0x5c7d85,{'date':_0x31fd23[_0x56a4c0(0xf3)]}),_0x31fd23[_0x56a4c0(0x175)][_0x56a4c0(0x280)]((_0x34d664,_0x234ed8)=>_0x7b355a[_0x56a4c0(0xfa)](_0x59ab5f,{'index':[_0x541f0f,_0x234ed8],'item':_0x34d664},_0x541f0f+'-'+_0x234ed8))]},_0x31fd23[_0x56a4c0(0xf3)])),_0x17e11b&&_0x7b355a[_0x56a4c0(0xfa)](_0x368880,{})]})}):_0x7b355a[_0x56a4c0(0xfa)](_0x525081,{});}function _0x368880(){const _0x2376fb=_0x31b547;return _0x7b355a['jsx'](_0x2376fb(0x2d1),{'className':'univer-flex\x20univer-h-7\x20univer-w-full\x20univer-items-center\x20univer-justify-center','children':_0x7b355a[_0x2376fb(0xfa)](_0x265f14,{'className':_0x2376fb(0x15f)})});}function _0x525081(){const _0x58f670=_0x31b547;return _0x7b355a[_0x58f670(0xfa)](_0x58f670(0x2d1),{'className':_0x58f670(0x295),'children':_0x7b355a[_0x58f670(0xfa)](_0x58f670(0x1b6),{'className':_0x58f670(0x2c0),'children':_0x7b355a[_0x58f670(0xfa)](_0x265f14,{'className':_0x58f670(0xe3)})})});}function _0x5c7d85(_0x59a1b8){const _0x6206fc=_0x31b547,_0x33d8e2=_0x1bf0bf[_0x6206fc(0x260)](_0x242e1a[_0x6206fc(0x113)]),{date:_0x411c15}=_0x59a1b8;return _0x7b355a['jsx'](_0x6206fc(0x2d1),{'className':_0x6206fc(0x279),'children':_0x10059b(_0x411c15,_0x33d8e2[_0x6206fc(0xfe)]())});}function _0x59ab5f(_0x10d24b){const _0x3b9f86=_0x31b547,{item:_0x45a092,index:_0x1e8970}=_0x10d24b,{time:_0x117178,user:_0x3058a9}=_0x45a092,[_0x1766be,_0x55a2c7]=_0x1e8970,_0x405e38=_0x1bf0bf[_0x3b9f86(0x260)](_0x4d70eb[_0x3b9f86(0x1fd)]),_0xe905cb=_0x1bf0bf[_0x3b9f86(0x238)](_0x405e38['currentVersion$'],'',!0x0)===_0x45a092['id'],_0x238acb=_0x1766be===0x0&&_0x55a2c7===0x0,_0x9aafd4=!_0x238acb&&_0x405e38[_0x3b9f86(0x2a8)],_0x268f49=_0x1bf0bf[_0x3b9f86(0x260)](_0x242e1a['LocaleService']),_0x331478=_0x268f49['getCurrentLocale'](),_0x37db17=_0x558a9b(_0x117178,_0x331478),_0x48c4c6=_0x268f49['t'](_0x3b9f86(0x1f2)),_0x16e704=_0x3f8f3c[_0x3b9f86(0x2c2)](_0x5c098e=>{const _0x7ea36e=_0x3b9f86;_0x405e38[_0x7ea36e(0x205)]!==_0x576eaa[_0x7ea36e(0x16e)]&&(_0x405e38[_0x7ea36e(0x28b)]=_0x5c098e);},[_0x405e38]),_0x185e8a=_0x3f8f3c['useCallback'](_0x404bad=>{_0x405e38['triggerRevert'](_0x404bad);},[_0x405e38]);return _0x7b355a[_0x3b9f86(0x27e)](_0x3b9f86(0x2d1),{'className':_0x368c21['clsx']('univer-h-15\x20univer-flex\x20univer-cursor-pointer\x20univer-flex-col\x20univer-justify-center\x20univer-gap-1\x20univer-rounded-md\x20univer-px-4\x20univer-py-1.5\x20univer-transition-colors\x20hover:univer-bg-gray-100\x20dark:hover:!univer-bg-gray-800',{'univer-bg-gray-50\x20dark:!univer-bg-gray-900':_0xe905cb}),'onClick':()=>_0x16e704(_0x45a092['id']),'children':[_0x7b355a[_0x3b9f86(0x27e)](_0x3b9f86(0x2d1),{'className':'univer-flex\x20univer-h-6\x20univer-w-full\x20univer-justify-between','children':[_0x7b355a[_0x3b9f86(0x27e)]('div',{'className':_0x3b9f86(0x2d4),'children':[_0x7b355a[_0x3b9f86(0xfa)](_0x3b9f86(0x1b6),{'children':_0x37db17['time']}),_0x238acb&&_0x7b355a[_0x3b9f86(0xfa)](_0x3b9f86(0x1b6),{'className':'univer-ml-2\x20univer-flex\x20univer-h-5\x20univer-items-center\x20univer-justify-center\x20univer-rounded\x20univer-border\x20univer-border-primary-600\x20univer-bg-primary-50\x20univer-px-1.5\x20univer-text-xs\x20univer-text-primary-600','children':_0x48c4c6})]}),_0x7b355a['jsx'](_0x3b9f86(0x2d1),{'children':_0x9aafd4&&_0x7b355a['jsx'](_0x368c21[_0x3b9f86(0x20f)],{'title':_0x268f49['t'](_0x3b9f86(0x1b1)),'children':_0x7b355a[_0x3b9f86(0xfa)](_0x3b9f86(0x2d1),{'onClick':_0xf0388a=>{const _0x4de5d5=_0x3b9f86;_0xf0388a[_0x4de5d5(0x195)](),_0x185e8a(_0x45a092['id']);},'className':_0x3b9f86(0x1e7),'children':_0x7b355a[_0x3b9f86(0xfa)](_0x343251,{})})})})]}),_0x7b355a['jsx'](_0x3b9f86(0x2d1),{'className':_0x3b9f86(0x157),'children':_0x556eb6(_0x45a092,_0x268f49)})]});}var _0x516577=Object[_0x31b547(0xee)],_0x4e969c=(_0x43fe49,_0x17463a,_0x21c7cd,_0x44947b)=>{const _0xf5016e=_0x31b547;for(var _0x2a1da7=_0x44947b>0x1?void 0x0:_0x44947b?_0x516577(_0x17463a,_0x21c7cd):_0x17463a,_0x27b0bc=_0x43fe49[_0xf5016e(0x263)]-0x1,_0xa6699;_0x27b0bc>=0x0;_0x27b0bc--)(_0xa6699=_0x43fe49[_0x27b0bc])&&(_0x2a1da7=_0xa6699(_0x2a1da7)||_0x2a1da7);return _0x2a1da7;},_0x23b19d=(_0x21bc07,_0x3caa25)=>(_0x2ca23c,_0x1bfab3)=>_0x3caa25(_0x2ca23c,_0x1bfab3,_0x21bc07);const _0x29b3c2=_0x31b547(0x2ce);let _0x46c43a=class extends _0x242e1a[_0x31b547(0x16b)]{constructor(_0x14aafc,_0x3d4992,_0x3bac21,_0x49e381){const _0xfecc89=_0x31b547;super(),_0x554995(this,_0xfecc89(0x27f),null),(this[_0xfecc89(0x1b3)]=_0x14aafc,this[_0xfecc89(0xc4)]=_0x3d4992,this[_0xfecc89(0x244)]=_0x3bac21,this[_0xfecc89(0x20a)]=_0x49e381,this[_0xfecc89(0xea)]());}['_init'](){const _0x52f594=_0x31b547;this['_initPanel'](),this[_0x52f594(0x1d5)]();}[_0x31b547(0x1d5)](){const _0x1b629a=_0x31b547;if(this[_0x1b629a(0x27f)])return;const _0x60512={'header':{'title':this[_0x1b629a(0x244)]['t'](_0x1b629a(0xbd))},'children':{'label':_0x29b3c2},'onClose':()=>{const _0x36c68a=_0x1b629a;this[_0x36c68a(0x27f)]=null,this[_0x36c68a(0x20a)]['status']=_0x3eaf5d[_0x36c68a(0x2b7)];}};this[_0x1b629a(0x27f)]=this[_0x1b629a(0x1b3)][_0x1b629a(0x1c4)]({..._0x60512});}[_0x31b547(0x243)](){const _0x4b9bbd=_0x31b547;this[_0x4b9bbd(0x1c2)](this['_componentManager'][_0x4b9bbd(0x1d2)](_0x29b3c2,_0x5468c2)),this[_0x4b9bbd(0x1c2)](this[_0x4b9bbd(0x1b3)][_0x4b9bbd(0x233)][_0x4b9bbd(0x2bf)](_0x2a386a['debounceTime'](0x64))[_0x4b9bbd(0x177)](_0x571da8=>{const _0x40b305=_0x4b9bbd,{target:_0x569aa0}=_0x571da8||{};if(_0x569aa0){const {scrollTop:_0x57f31d,scrollHeight:_0x43b945,clientHeight:_0x9babb2}=_0x569aa0;_0x57f31d+_0x9babb2>=_0x43b945-0x5&&this[_0x40b305(0x20a)][_0x40b305(0x2b4)]();}}));}};_0x46c43a=_0x4e969c([_0x23b19d(0x0,_0x1bf0bf['ISidebarService']),_0x23b19d(0x1,_0x242e1a['Inject'](_0x1bf0bf[_0x31b547(0x29b)])),_0x23b19d(0x2,_0x242e1a[_0x31b547(0x11f)](_0x242e1a[_0x31b547(0x113)])),_0x23b19d(0x3,_0x242e1a[_0x31b547(0x11f)](_0x4d70eb[_0x31b547(0x1fd)]))],_0x46c43a);class _0x2b47b0 extends _0x242e1a[_0x31b547(0x16b)]{constructor(){super(),_0x554995(this,'_dialogOptions$',new _0x2a386a['Subject']());}[_0x31b547(0x1c4)](){const _0x3d00db=_0x31b547;return _0x242e1a[_0x3d00db(0x13b)](()=>{});}[_0x31b547(0x1bb)](){}['closeAll'](_0x40c25c){}[_0x31b547(0x2d0)](){const _0x4a37a5=_0x31b547;return this[_0x4a37a5(0xa9)][_0x4a37a5(0x1e8)]();}}var _0x44a5b3=Object[_0x31b547(0x1c5)],_0x1bc99e=Object['getOwnPropertyDescriptor'],_0x4ab7ac=(_0x54826b,_0x4fa6c1,_0x36da9c)=>_0x4fa6c1 in _0x54826b?_0x44a5b3(_0x54826b,_0x4fa6c1,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0x36da9c}):_0x54826b[_0x4fa6c1]=_0x36da9c,_0x53ac55=(_0x21634d,_0x38426a,_0x4e2fe9,_0x347aef)=>{const _0x7dac7=_0x31b547;for(var _0x1aa5d0=_0x347aef>0x1?void 0x0:_0x347aef?_0x1bc99e(_0x38426a,_0x4e2fe9):_0x38426a,_0x441eaa=_0x21634d[_0x7dac7(0x263)]-0x1,_0x278c94;_0x441eaa>=0x0;_0x441eaa--)(_0x278c94=_0x21634d[_0x441eaa])&&(_0x1aa5d0=_0x278c94(_0x1aa5d0)||_0x1aa5d0);return _0x1aa5d0;},_0x4f74c=(_0xb5db46,_0x4dda10)=>(_0x52f063,_0xb42530)=>_0x4dda10(_0x52f063,_0xb42530,_0xb5db46),_0x190443=(_0x42a10d,_0x117caa,_0x5e4ed3)=>_0x4ab7ac(_0x42a10d,_0x117caa+'',_0x5e4ed3);const _0x34f73f='UNIVER_EDIT_HISTORY_VIEWER_PLUGIN';_0x4d70eb['UniverEditHistoryViewerPlugin']=class extends _0x242e1a[_0x31b547(0xdb)]{constructor(_0x4314ba=_0x47955f,_0x3496bf,_0x913d32,_0x531a5d){const _0x3b2339=_0x31b547;super(),this['_config']=_0x4314ba,this[_0x3b2339(0x1df)]=_0x3496bf,this[_0x3b2339(0x151)]=_0x913d32,this[_0x3b2339(0x1e5)]=_0x531a5d;const {..._0x542a98}=_0x242e1a['merge']({},_0x47955f,this['_config']);this['_configService'][_0x3b2339(0x214)](_0x1ac248,_0x542a98);}[_0x31b547(0x11d)](){const _0x5d11b1=_0x31b547;[[_0x4d70eb['HistoryManagerService']],[_0x509149],[_0xf4d0fb],[_0x1e528b],[_0x46c43a],[_0x157c76],[_0xa43662[_0x5d11b1(0x171)],{'useClass':_0x450e2e[_0x5d11b1(0x11c)]}],[_0x1bf0bf[_0x5d11b1(0x1af)],{'useClass':_0x2b47b0}],[_0x149d4f['IImageIoService'],{'useClass':_0x450e2e[_0x5d11b1(0x12a)]}]][_0x5d11b1(0x1f5)](_0x2df266=>this[_0x5d11b1(0x1df)][_0x5d11b1(0x1ed)](_0x2df266)),this[_0x5d11b1(0x1df)][_0x5d11b1(0x272)](_0x509149);}[_0x31b547(0x11b)](){const _0x558c9b=_0x31b547;[[_0x5705b4]][_0x558c9b(0x1f5)](_0x15243a=>{const _0x37ce1c=_0x558c9b;this[_0x37ce1c(0x1c2)](this[_0x37ce1c(0x151)][_0x37ce1c(0x100)](_0x242e1a[_0x37ce1c(0x24c)]['UNIVER_SHEET'],_0x15243a));}),this[_0x558c9b(0x1df)]['get'](_0x157c76),this[_0x558c9b(0x1df)][_0x558c9b(0x272)](_0x46c43a);}[_0x31b547(0xa6)](){const _0x4fa186=_0x31b547;this[_0x4fa186(0x1df)][_0x4fa186(0x272)](_0xf4d0fb);}},_0x190443(_0x4d70eb['UniverEditHistoryViewerPlugin'],'pluginName',_0x34f73f),_0x4d70eb[_0x31b547(0x21f)]=_0x53ac55([_0x242e1a[_0x31b547(0x2af)](_0x316cbf[_0x31b547(0x10f)],_0x3ebdc4[_0x31b547(0x251)]),_0x4f74c(0x1,_0x242e1a['Inject'](_0x242e1a['Injector'])),_0x4f74c(0x2,_0xfc4827['IRenderManagerService']),_0x4f74c(0x3,_0x242e1a[_0x31b547(0x22c)])],_0x4d70eb[_0x31b547(0x21f)]),_0x4d70eb[_0x31b547(0x1c0)]=_0x3eaf5d,Object[_0x31b547(0x1c5)](_0x4d70eb,Symbol[_0x31b547(0x17c)],{'value':_0x31b547(0x1a9)});}));

// @univerjs-pro/edit-history-loader/index
function _0x1723(){const _0x2066ae=['UniverSheetsUIPlugin','BehaviorSubject','@univerjs/engine-render','_disposableCollection','getSheetCommandTarget','next','WorkbookEditablePermission','IConfigService','@univerjs/sheets-formula','exhaustSavingTask','appendChild','svg','_localeService','@univerjs-pro/sheets-sparkline','getOwnPropertyDescriptor','length','Plugin','AuthzIoHttpService','@univerjs/sheets-data-validation','UniverLicensePlugin','@univerjs/sheets-data-validation-ui','none','UniverNetworkPlugin','attrs','UniverRenderEnginePlugin','fill','_historyUniver$','triggerLoadVersions','SYNCED','@univerjs/ui','string','values','_pluginMap','@univerjs/drawing','CollaborationController','UniverDocs','getCurrentLocale','darkMode$','data','UniverUIPlugin','_init','disposeWithMe','UniverEngineRender','UniverProLicense','revertRevision$','setConfig','_checkCanRevert','UniverSheetsConditionalFormattingUIPlugin','registerPlugin','UniverSheetSparklinePlugin','@univerjs/sheets-filter','path','currentTheme$','getCurrentRangeDisable$','@univerjs-pro/sheets-sparkline-ui','has','UniverSheetsDataValidationUIPlugin','UniverNetwork','from','6kHTJhu','UniverProSheetsPivot','add','ThemeService','editHistory.panel.revertFailed','UniverSheetsDrawingPlugin','_localCacheService','location','onSteady','getLocales','defs','clipPath','trim','height','784182HNYbMi','ComponentManager','Inject','univer-history-container','@univerjs/network','ICommandService','subscribe','_initListener','getMenuHiddenObservable','_messageService','UniverSheetsFilterUi','_sidebarService','CollaborationEvent','includes','UniverSheetsDataValidation','Disposable','createElement','UniverProEditHistoryViewer','UniverDataValidationPlugin','0\x200\x2016\x2016','UniverSheetsNumfmtPlugin','object','_revertErrorTimer','1em','eventID','UniverProSheetsSparkline','HistoryManagerService','@univerjs/sheets-hyper-link','@univerjs/design','show','HistoryIcon','editHistory.panel.listFetchError','_config','UniverUi','UniverSheetsFormula','ILocalCacheService','OPERATION','random','UniverSheetsDrawingUIPlugin','set','@univerjs-pro/collaboration','xlink:href','HistoryModeStatus','permissionId','mask','status$','UniverSheetsHyperLink','defIds','_initContainer','UniverSheets','mergeMenu','colorChannel1','UniverSheetsConditionalFormatting','_configService','UniverInstanceType','1LfoyLX','_menuManagerService','218617iSutFX','@univerjs/sheets-conditional-formatting-ui','getUnit','IMessageService','dataset','@univerjs/sheets-hyper-link-ui','assign','display','clear','RevertRevisionMutation','history-container','dispose','menu','url(#$1','_permissionService','UNIVER_SHEET','event$','IPermissionService','./worker.js','history-icon','setDarkMode','tag','IDialogService','absolute','children','getConfig','UniverRpc','close','invoke','edit-history-loader.config','_initUniver','UniverSheetsPivotTablePlugin','current','@univerjs-pro/license','UniverSheetsHyperLinkPlugin','2933300jQHcBc','pluginName','DisposableCollection','_historyManagerService','IAuthzIoService','Exited','_commandService','Loading','_themeService','UniverProSheetsSparklineUi','currentColor','react','map','React','@univerjs/data-validation','forEach','UniverSheetsPlugin','@univerjs-pro/sheets-pivot','UniverSheetsDataValidationUi','155erUgmN','MenuItemType','toString','every','flat','closeAll','merge','@univerjs/engine-formula','CommandType','toDisposable','UniverEngineFormula','2956UPGlTu','value','some','function','style','M4.45388\x204.14989H3.52896C4.61144\x202.8939\x206.21319\x202.0999\x207.9999\x202.0999C11.2584\x202.0999\x2013.8999\x204.74142\x2013.8999\x207.9999C13.8999\x2011.2584\x2011.2584\x2013.8999\x207.9999\x2013.8999C4.74142\x2013.8999\x202.0999\x2011.2584\x202.0999\x207.9999C2.0999\x207.66853\x201.83127\x207.3999\x201.4999\x207.3999C1.16853\x207.3999\x200.899902\x207.66853\x200.899902\x207.9999C0.899902\x2011.9211\x204.07868\x2015.0999\x207.9999\x2015.0999C11.9211\x2015.0999\x2015.0999\x2011.9211\x2015.0999\x207.9999C15.0999\x204.07868\x2011.9211\x200.899902\x207.9999\x200.899902C5.88709\x200.899902\x203.9903\x201.82298\x202.69023\x203.28636V2.38625C2.69023\x202.05488\x202.42161\x201.78625\x202.09023\x201.78625C1.75886\x201.78625\x201.49023\x202.05488\x201.49023\x202.38625V4.74989C1.49023\x205.08126\x201.75886\x205.34989\x202.09023\x205.34989H4.45388C4.78525\x205.34989\x205.05388\x205.08126\x205.05388\x204.74989C5.05388\x204.41851\x204.78525\x204.14989\x204.45388\x204.14989Z','div','@univerjs/docs','Univer','UniverIcon','UniverSheetsFilter','ISidebarService','_componentManager','substring','@univerjs/drawing-ui','1000','status','UniverSheetsDrawingUi','@univerjs/sheets-conditional-formatting','_initPlugins','unMountHistoryContent','mutations','replace','909369xJFccl','LS_CONFIG_KEY','_injector','__getInjector','univer.operation.toggle-edit-history','UNIVER_HISTORY_CONTAINER_ID','getSheets','COLLABORATION_CLIENT_PLUGIN_CONFIG_KEY','editHistory.panel.title','@univerjs-pro/collaboration-client','UniverDrawingUi','univerjs-icon\x20univerjs-icon-','onCommandExecuted','UNIVER_CONTAINER_ID_KEY','historyListServerUrl','entries','getSubunitRuleList','http://www.w3.org/2000/svg','_dialogService','getAllPlugins','url(#history-icon_clip0_907_281)','_collaborationController','historyUniver','2114656bRZxky','rxjs','UniverCore','UniverDrawingUIPlugin','unsubscribe','Entered','@univerjs/sheets-ui','executeCommand','RxDisposable','UNIVER_EDIT_HISTORY_LOADER_PLUGIN','UNIVER_CONTAINER_ID','@univerjs/sheets','composePermission','UniverSheetsFilterUIPlugin','UniverDrawingPlugin','idSuffix','MessageType','width','Error','UniverDocsUi','WorksheetEditPermission','UniverCollaborationPlugin','LocaleService','IImageIoService','displayName','38304SBaTzD','UniverEditHistoryLoaderPlugin','editHistory.panel.reverting','WorkbookViewHistoryPermission','session','UniverSheetsConditionalFormattingPlugin','UniverSheetsDrawing','M8.28291\x205.16293C8.28295\x204.83156\x208.01435\x204.5629\x207.68298\x204.56287C7.35161\x204.56283\x207.08295\x204.83143\x207.08291\x205.1628L7.08252\x208.63494C7.0825\x208.79881\x207.1495\x208.95555\x207.26796\x209.06877L9.70073\x2011.3939C9.94029\x2011.6228\x2010.3201\x2011.6142\x2010.549\x2011.3747C10.778\x2011.1351\x2010.7694\x2010.7553\x2010.5298\x2010.5263L8.28255\x208.37852L8.28291\x205.16293Z','\x20has\x20been\x20registered.','RangeProtectionRuleModel','HistoryLoaderService','@univerjs/docs-ui','M0\x200H16V16H0z','univerContainerId','get','combineLatest','@univerjs/sheets-drawing-ui','100%','UniverSheetsDataValidationPlugin','setTheme','IUniverInstanceService','getElementById'];_0x1723=function(){return _0x2066ae;};return _0x1723();}function _0x3795(_0x4f0d79,_0x998248){const _0x1723d6=_0x1723();return _0x3795=function(_0x37958a,_0x6f3d2d){_0x37958a=_0x37958a-0xf5;let _0x3100f6=_0x1723d6[_0x37958a];return _0x3100f6;},_0x3795(_0x4f0d79,_0x998248);}(function(_0x216beb,_0x5b5038){const _0x2acd91=_0x3795,_0x17ca84=_0x216beb();while(!![]){try{const _0x5e4364=parseInt(_0x2acd91(0x1c9))/0x1*(parseInt(_0x2acd91(0x133))/0x2)+parseInt(_0x2acd91(0x192))/0x3+parseInt(_0x2acd91(0x20c))/0x4*(parseInt(_0x2acd91(0x201))/0x5)+-parseInt(_0x2acd91(0x184))/0x6*(parseInt(_0x2acd91(0x1cb))/0x7)+-parseInt(_0x2acd91(0x11a))/0x8+-parseInt(_0x2acd91(0x103))/0x9+parseInt(_0x2acd91(0x1ee))/0xa;if(_0x5e4364===_0x5b5038)break;else _0x17ca84['push'](_0x17ca84['shift']());}catch(_0x5b3f97){_0x17ca84['push'](_0x17ca84['shift']());}}}(_0x1723,0x30df5),function(_0x40d2f5,_0xcae3cd){const _0x168e6d=_0x3795;typeof exports==_0x168e6d(0x1a7)&&typeof module<'u'?_0xcae3cd(exports,require('@univerjs/core'),require('@univerjs-pro/collaboration'),require('@univerjs-pro/collaboration-client'),require('@univerjs/design'),require('react'),require('@univerjs/ui'),require('rxjs'),require('@univerjs/sheets'),require('@univerjs-pro/edit-history-viewer'),require('@univerjs-pro/license'),require('@univerjs-pro/sheets-pivot'),require('@univerjs-pro/sheets-sparkline'),require('@univerjs-pro/sheets-sparkline-ui'),require('@univerjs/data-validation'),require('@univerjs/docs'),require('@univerjs/docs-ui'),require('@univerjs/drawing'),require('@univerjs/drawing-ui'),require('@univerjs/engine-formula'),require('@univerjs/engine-render'),require('@univerjs/network'),require('@univerjs/rpc'),require('@univerjs/sheets-conditional-formatting'),require('@univerjs/sheets-conditional-formatting-ui'),require('@univerjs/sheets-data-validation'),require('@univerjs/sheets-data-validation-ui'),require('@univerjs/sheets-drawing'),require('@univerjs/sheets-drawing-ui'),require('@univerjs/sheets-filter'),require('@univerjs/sheets-filter-ui'),require('@univerjs/sheets-formula'),require('@univerjs/sheets-formula-ui'),require('@univerjs/sheets-hyper-link'),require('@univerjs/sheets-hyper-link-ui'),require('@univerjs/sheets-numfmt'),require('@univerjs/sheets-ui')):typeof define==_0x168e6d(0x20f)&&define['amd']?define(['exports','@univerjs/core',_0x168e6d(0x1ba),_0x168e6d(0x10c),_0x168e6d(0x1ae),_0x168e6d(0x1f9),_0x168e6d(0x166),'rxjs',_0x168e6d(0x125),'@univerjs-pro/edit-history-viewer',_0x168e6d(0x1ec),_0x168e6d(0x1ff),_0x168e6d(0x156),_0x168e6d(0x17f),_0x168e6d(0x1fc),_0x168e6d(0x213),_0x168e6d(0x13e),_0x168e6d(0x16a),_0x168e6d(0xfa),_0x168e6d(0x208),_0x168e6d(0x14b),_0x168e6d(0x196),'@univerjs/rpc',_0x168e6d(0xfe),_0x168e6d(0x1cc),_0x168e6d(0x15b),_0x168e6d(0x15d),'@univerjs/sheets-drawing',_0x168e6d(0x143),_0x168e6d(0x17b),'@univerjs/sheets-filter-ui',_0x168e6d(0x151),'@univerjs/sheets-formula-ui',_0x168e6d(0x1ad),_0x168e6d(0x1d0),'@univerjs/sheets-numfmt',_0x168e6d(0x120)],_0xcae3cd):(_0x40d2f5=typeof globalThis<'u'?globalThis:_0x40d2f5||self,_0xcae3cd(_0x40d2f5['UniverProEditHistoryLoader']={},_0x40d2f5[_0x168e6d(0x11c)],_0x40d2f5['UniverProCollaboration'],_0x40d2f5['UniverProCollaborationClient'],_0x40d2f5['UniverDesign'],_0x40d2f5[_0x168e6d(0x1fb)],_0x40d2f5[_0x168e6d(0x1b3)],_0x40d2f5[_0x168e6d(0x11b)],_0x40d2f5[_0x168e6d(0x1c3)],_0x40d2f5[_0x168e6d(0x1a3)],_0x40d2f5[_0x168e6d(0x174)],_0x40d2f5[_0x168e6d(0x185)],_0x40d2f5[_0x168e6d(0x1ab)],_0x40d2f5[_0x168e6d(0x1f7)],_0x40d2f5['UniverDataValidation'],_0x40d2f5[_0x168e6d(0x16c)],_0x40d2f5[_0x168e6d(0x12d)],_0x40d2f5['UniverDrawing'],_0x40d2f5[_0x168e6d(0x10d)],_0x40d2f5[_0x168e6d(0x20b)],_0x40d2f5[_0x168e6d(0x173)],_0x40d2f5[_0x168e6d(0x182)],_0x40d2f5[_0x168e6d(0x1e5)],_0x40d2f5[_0x168e6d(0x1c6)],_0x40d2f5['UniverSheetsConditionalFormattingUi'],_0x40d2f5[_0x168e6d(0x1a0)],_0x40d2f5[_0x168e6d(0x200)],_0x40d2f5[_0x168e6d(0x139)],_0x40d2f5[_0x168e6d(0xfd)],_0x40d2f5[_0x168e6d(0xf6)],_0x40d2f5[_0x168e6d(0x19c)],_0x40d2f5[_0x168e6d(0x1b4)],_0x40d2f5['UniverSheetsFormulaUi'],_0x40d2f5[_0x168e6d(0x1c0)],_0x40d2f5['UniverSheetsHyperLinkUi'],_0x40d2f5['UniverSheetsNumfmt'],_0x40d2f5['UniverSheetsUi']));}(this,function(_0x2f6d46,_0x2c1ffa,_0x1ac28c,_0x2b1cf6,_0xdc0735,_0xa4bee0,_0x5946d7,_0xb7bcb6,_0x348ea4,_0x4d4c93,_0x48c5e5,_0x17a5fa,_0x2c4667,_0x51a8d5,_0x552024,_0x418a6a,_0x151362,_0x15543d,_0x130f08,_0x2669db,_0x5d5482,_0x5c0f99,_0x4a5cff,_0x57466a,_0x401700,_0x5a30fa,_0x492e3e,_0x4c1ef3,_0x744652,_0x45f668,_0x52006b,_0x16e5f1,_0x286a42,_0x16efd7,_0x1d12a0,_0x1a6714,_0x122728){'use strict';const _0x353da9=_0x3795;var _0x3f9ef6=Object['defineProperty'],_0x24db74=(_0x1e3ceb,_0xb7ac5c,_0xb473c7)=>_0xb7ac5c in _0x1e3ceb?_0x3f9ef6(_0x1e3ceb,_0xb7ac5c,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0xb473c7}):_0x1e3ceb[_0xb7ac5c]=_0xb473c7,_0x3c57bf=(_0x1704a8,_0x28aff3,_0x25cc0d)=>_0x24db74(_0x1704a8,typeof _0x28aff3!='symbol'?_0x28aff3+'':_0x28aff3,_0x25cc0d),_0x3de355;const _0x3bb203=_0x353da9(0x1e8),_0x2a7967={};function _0x4bfea6({ref:_0x43e369,..._0x2ee350}){const _0x52878a=_0x353da9,{icon:_0x28d698,id:_0x58d991,className:_0x5512cf,extend:_0x39d1d0,..._0x42344f}=_0x2ee350,_0x3e7d13=(_0x52878a(0x10e)+_0x58d991+'\x20'+(_0x5512cf||''))[_0x52878a(0x190)](),_0x2c939a=_0xa4bee0['useRef']('_'+_0x95d845());return _0x28ec21(_0x28d698,''+_0x58d991,{'defIds':_0x28d698[_0x52878a(0x1c1)],'idSuffix':_0x2c939a[_0x52878a(0x1eb)]},{'ref':_0x43e369,'className':_0x3e7d13,..._0x42344f},_0x39d1d0);}function _0x28ec21(_0x5b2ceb,_0x8cad47,_0x10b599,_0x4a6ae4,_0x1de0e0){const _0x3f30c7=_0x353da9;return _0xa4bee0[_0x3f30c7(0x1a2)](_0x5b2ceb[_0x3f30c7(0x1e0)],{'key':_0x8cad47,..._0x3e4ba5(_0x5b2ceb,_0x10b599,_0x1de0e0),..._0x4a6ae4},(_0x27b1ab(_0x5b2ceb,_0x10b599)[_0x3f30c7(0x1e3)]||[])[_0x3f30c7(0x1fa)]((_0x207da0,_0x292624)=>_0x28ec21(_0x207da0,_0x8cad47+'-'+_0x5b2ceb[_0x3f30c7(0x1e0)]+'-'+_0x292624,_0x10b599,void 0x0,_0x1de0e0)));}function _0x3e4ba5(_0x17cd6c,_0x29dd16,_0x4f0664){const _0x782dd6=_0x353da9,_0x37dee9={..._0x17cd6c[_0x782dd6(0x160)]};_0x4f0664!=null&&_0x4f0664['colorChannel1']&&_0x37dee9[_0x782dd6(0x162)]===_0x782dd6(0x1c5)&&(_0x37dee9[_0x782dd6(0x162)]=_0x4f0664[_0x782dd6(0x1c5)]),_0x17cd6c[_0x782dd6(0x1e0)]===_0x782dd6(0x1be)&&_0x37dee9['id']&&(_0x37dee9['id']=_0x37dee9['id']+_0x29dd16[_0x782dd6(0x129)]),Object['entries'](_0x37dee9)[_0x782dd6(0x1fd)](([_0x125e8,_0x28249a])=>{const _0x32ccfd=_0x782dd6;_0x125e8==='mask'&&typeof _0x28249a==_0x32ccfd(0x167)&&(_0x37dee9[_0x125e8]=_0x28249a[_0x32ccfd(0x102)](/url\(#(.*)\)/,'url(#$1'+_0x29dd16[_0x32ccfd(0x129)]+')'));});const {defIds:_0x50028a}=_0x29dd16;return!_0x50028a||_0x50028a[_0x782dd6(0x158)]===0x0||(_0x17cd6c[_0x782dd6(0x1e0)]==='use'&&_0x37dee9[_0x782dd6(0x1bb)]&&(_0x37dee9[_0x782dd6(0x1bb)]=_0x37dee9[_0x782dd6(0x1bb)]+_0x29dd16[_0x782dd6(0x129)]),Object[_0x782dd6(0x112)](_0x37dee9)[_0x782dd6(0x1fd)](([_0x364040,_0xd68de7])=>{const _0x3cae82=_0x782dd6;typeof _0xd68de7=='string'&&(_0x37dee9[_0x364040]=_0xd68de7[_0x3cae82(0x102)](/url\(#(.*)\)/,_0x3cae82(0x1d8)+_0x29dd16['idSuffix']+')'));})),_0x37dee9;}function _0x27b1ab(_0x31c339,_0x29338c){const _0x13ceb4=_0x353da9;var _0x32aaac;const {defIds:_0x660e20}=_0x29338c;return!_0x660e20||_0x660e20[_0x13ceb4(0x158)]===0x0?_0x31c339:_0x31c339[_0x13ceb4(0x1e0)]===_0x13ceb4(0x18e)&&((_0x32aaac=_0x31c339[_0x13ceb4(0x1e3)])!=null&&_0x32aaac[_0x13ceb4(0x158)])?{..._0x31c339,'children':_0x31c339[_0x13ceb4(0x1e3)][_0x13ceb4(0x1fa)](_0x57b683=>typeof _0x57b683[_0x13ceb4(0x160)]['id']==_0x13ceb4(0x167)&&_0x660e20&&_0x660e20[_0x13ceb4(0x19f)](_0x57b683[_0x13ceb4(0x160)]['id'])?{..._0x57b683,'attrs':{..._0x57b683[_0x13ceb4(0x160)],'id':_0x57b683[_0x13ceb4(0x160)]['id']+_0x29338c[_0x13ceb4(0x129)]}}:_0x57b683)}:_0x31c339;}function _0x95d845(){const _0x40ab73=_0x353da9;return Math[_0x40ab73(0x1b7)]()[_0x40ab73(0x203)](0x24)[_0x40ab73(0xf9)](0x2,0x8);}_0x4bfea6[_0x353da9(0x132)]=_0x353da9(0xf5);const _0x3b06e2={'tag':_0x353da9(0x154),'attrs':{'xmlns':_0x353da9(0x114),'fill':_0x353da9(0x15e),'viewBox':_0x353da9(0x1a5),'width':'1em','height':_0x353da9(0x1a9)},'children':[{'tag':'g','attrs':{'fill':_0x353da9(0x1f8),'clipPath':_0x353da9(0x117)},'children':[{'tag':_0x353da9(0x17c),'attrs':{'d':_0x353da9(0x211)}},{'tag':_0x353da9(0x17c),'attrs':{'d':_0x353da9(0x13a)}}]},{'tag':'defs','attrs':{},'children':[{'tag':_0x353da9(0x18f),'attrs':{'id':'history-icon_clip0_907_281'},'children':[{'tag':_0x353da9(0x17c),'attrs':{'fill':'white','d':_0x353da9(0x13f)}}]}]}],'defIds':['history-icon_clip0_907_281']},_0x544f07=_0xa4bee0['forwardRef'](function(_0x13e6b4,_0x1dfe1d){const _0x5f2854=_0x353da9;return _0xa4bee0[_0x5f2854(0x1a2)](_0x4bfea6,Object[_0x5f2854(0x1d1)]({},_0x13e6b4,{'id':_0x5f2854(0x1de),'ref':_0x1dfe1d,'icon':_0x3b06e2}));});_0x544f07[_0x353da9(0x132)]='HistoryIcon';var _0x5256a9=Object[_0x353da9(0x157)],_0x1be8e4=(_0x527db5,_0x1872d5,_0x23f51f,_0x1e67c8)=>{const _0x31bc17=_0x353da9;for(var _0x1f919a=_0x1e67c8>0x1?void 0x0:_0x1e67c8?_0x5256a9(_0x1872d5,_0x23f51f):_0x1872d5,_0x585e69=_0x527db5[_0x31bc17(0x158)]-0x1,_0x2a72db;_0x585e69>=0x0;_0x585e69--)(_0x2a72db=_0x527db5[_0x585e69])&&(_0x1f919a=_0x2a72db(_0x1f919a)||_0x1f919a);return _0x1f919a;},_0x1206b0=(_0x407b08,_0x27f55b)=>(_0x495394,_0x46177e)=>_0x27f55b(_0x495394,_0x46177e,_0x407b08);const _0x1e67bd='univer-container',_0x59e2bb=_0x353da9(0x124),_0x51e7e3=_0x353da9(0x195);_0x2f6d46[_0x353da9(0x13d)]=class extends _0x2c1ffa[_0x353da9(0x1a1)]{constructor(_0x5cdeec,_0x30937d,_0x5370a0,_0x427fc0,_0x3c80ac,_0x5bdab6,_0x5c2928,_0x372937,_0x59ebde,_0x3b66fb){const _0x49093e=_0x353da9;super(),_0x3c57bf(this,'_historyUniver$',new _0xb7bcb6[(_0x49093e(0x14a))](null)),_0x3c57bf(this,'historyUniver$',this[_0x49093e(0x163)]['asObservable']()),_0x3c57bf(this,_0x49093e(0x14c),new _0x2c1ffa[(_0x49093e(0x1f0))]()),_0x3c57bf(this,_0x49093e(0x169),new Map()),(this[_0x49093e(0x155)]=_0x5cdeec,this['_univerInstanceService']=_0x30937d,this['_configService']=_0x5370a0,this['_commandService']=_0x427fc0,this[_0x49093e(0x19b)]=_0x3c80ac,this['_permissionService']=_0x5bdab6,this['_selectionProtectionRuleModel']=_0x5c2928,this['_dialogService']=_0x372937,this[_0x49093e(0x19d)]=_0x59ebde,this[_0x49093e(0x1f6)]=_0x3b66fb,this[_0x49093e(0x171)]());}get[_0x353da9(0x119)](){const _0x3e076a=_0x353da9;return this[_0x3e076a(0x163)][_0x3e076a(0x20d)];}[_0x353da9(0x171)](){const _0x523f6e=_0x353da9;this[_0x523f6e(0x1c2)](),this[_0x523f6e(0xff)]();}['_initContainer'](){const _0x5532c3=_0x353da9;var _0x25dc41;const _0x527765=(_0x25dc41=this[_0x5532c3(0x1c7)][_0x5532c3(0x1e4)](_0x59e2bb))!=null?_0x25dc41:_0x1e67bd,_0x50a4cb=document['getElementById'](_0x527765);if(!_0x50a4cb)return;const _0x4e6b3d=document[_0x5532c3(0x1a2)](_0x5532c3(0x212));_0x4e6b3d['id']=_0x51e7e3,_0x4e6b3d[_0x5532c3(0x1cf)]['uComp']=_0x5532c3(0x1d5),_0x4e6b3d[_0x5532c3(0x210)]['position']=_0x5532c3(0x1e2),_0x4e6b3d[_0x5532c3(0x210)]['top']='0',_0x4e6b3d['style']['left']='0',_0x4e6b3d[_0x5532c3(0x210)][_0x5532c3(0x12b)]=_0x5532c3(0x144),_0x4e6b3d[_0x5532c3(0x210)][_0x5532c3(0x191)]='100%',_0x4e6b3d[_0x5532c3(0x210)]['zIndex']=_0x5532c3(0xfb),_0x4e6b3d[_0x5532c3(0x210)]['display']='none',_0x50a4cb[_0x5532c3(0x153)](_0x4e6b3d);}[_0x353da9(0xff)](){const _0x351e42=_0x353da9;var _0x3813ce;[[_0x5d5482[_0x351e42(0x161)]],[_0x5946d7[_0x351e42(0x170)],{'container':_0x51e7e3,'header':!0x0,'toolbar':!0x1,'footer':!0x0,'contextMenu':!0x1,'override':[[_0x5946d7[_0x351e42(0x1e1)],null]]}],[_0x5c0f99[_0x351e42(0x15f)]],[_0x15543d[_0x351e42(0x128)],{'override':[[_0x15543d[_0x351e42(0x131)],null]]}],[_0x418a6a['UniverDocsPlugin'],{'hasScroll':!0x1}],[_0x151362['UniverDocsUIPlugin']],[_0x1a6714[_0x351e42(0x1a6)]],[_0x348ea4[_0x351e42(0x1fe)],{'notExecuteFormula':!0x0}],[_0x122728[_0x351e42(0x149)]],[_0x16e5f1['UniverSheetsFormulaPlugin']],[_0x286a42['UniverSheetsFormulaUIPlugin']],[_0x1ac28c[_0x351e42(0x12f)]],[_0x45f668['UniverSheetsFilterPlugin']],[_0x52006b[_0x351e42(0x127)]],[_0x57466a[_0x351e42(0x138)]],[_0x401700[_0x351e42(0x178)]],[_0x16efd7[_0x351e42(0x1ed)]],[_0x1d12a0['UniverSheetsHyperLinkUIPlugin']],[_0x552024[_0x351e42(0x1a4)]],[_0x5a30fa[_0x351e42(0x145)]],[_0x492e3e[_0x351e42(0x181)]],[_0x2669db['UniverFormulaEnginePlugin'],{'notExecuteFormula':!0x0}],[_0x4a5cff['UniverRPCMainThreadPlugin'],{'workerURL':_0x351e42(0x1dd)}],[_0x130f08[_0x351e42(0x11d)]],[_0x4c1ef3[_0x351e42(0x189)]],[_0x744652[_0x351e42(0x1b8)]],[_0x2c4667[_0x351e42(0x17a)]],[_0x51a8d5['UniverSheetSparklineUIPlugin']],[_0x17a5fa[_0x351e42(0x1ea)],{'notExecuteFormula':!0x0}],[_0x4d4c93['UniverEditHistoryViewerPlugin'],{'historyListServerUrl':(_0x3813ce=this['_configService'][_0x351e42(0x1e4)](_0x3bb203))==null?void 0x0:_0x3813ce[_0x351e42(0x111)]}]]['forEach'](([_0x5ca177,_0x67cd75])=>this['registerPlugin'](_0x5ca177,_0x67cd75));}[_0x353da9(0x1d6)](){const _0x369871=_0x353da9;super[_0x369871(0x1d6)](),this[_0x369871(0x100)](),this[_0x369871(0x169)][_0x369871(0x1d3)]();}[_0x353da9(0x179)](_0x65e539,_0x392d67,_0x2c5bd8){const _0x50c9ba=_0x353da9;if(this[_0x50c9ba(0x169)][_0x50c9ba(0x180)](_0x65e539[_0x50c9ba(0x1ef)])&&!_0x2c5bd8)throw new Error('[HistoryLoaderService]:\x20Plugin\x20'+_0x65e539['pluginName']+_0x50c9ba(0x13b));this[_0x50c9ba(0x169)][_0x50c9ba(0x1b9)](_0x65e539[_0x50c9ba(0x1ef)],[_0x65e539,_0x392d67]);}[_0x353da9(0x116)](){const _0x143fd2=_0x353da9;return Array[_0x143fd2(0x183)](this['_pluginMap'][_0x143fd2(0x168)]());}['mountHistoryContent'](_0x3bd937){const _0x205df4=_0x353da9,_0x2c9706=document[_0x205df4(0x148)](_0x51e7e3);_0x2c9706&&(_0x2c9706[_0x205df4(0x210)]['display']='block',this[_0x205df4(0x1e9)](_0x3bd937,_0x51e7e3));}[_0x353da9(0x100)](){const _0x18a27f=_0x353da9;var _0x4510ec;this[_0x18a27f(0x14c)]['dispose'](),(_0x4510ec=this['historyUniver'])==null||_0x4510ec[_0x18a27f(0x1d6)](),this[_0x18a27f(0x163)]['next'](null);const _0x57d8d4=document[_0x18a27f(0x148)](_0x51e7e3);_0x57d8d4&&(_0x57d8d4[_0x18a27f(0x210)][_0x18a27f(0x1d2)]=_0x18a27f(0x15e));}[_0x353da9(0x1e9)](_0x14d188,_0x2a040b){const _0x3dbabc=_0x353da9;if(this[_0x3dbabc(0x119)])return;const _0x4e0463=new _0x2c1ffa[(_0x3dbabc(0x214))]({'locales':{[this['_localeService'][_0x3dbabc(0x16d)]()]:this[_0x3dbabc(0x155)][_0x3dbabc(0x18d)]()},'override':[[_0x2c1ffa[_0x3dbabc(0x1f2)],{'useClass':_0x2b1cf6[_0x3dbabc(0x15a)]}]]}),_0x2b1ce4=_0x4e0463[_0x3dbabc(0x106)]();this[_0x3dbabc(0x172)](this[_0x3dbabc(0x1f6)][_0x3dbabc(0x16e)][_0x3dbabc(0x198)](_0x5ded2f=>{const _0x310a11=_0x3dbabc;_0x2b1ce4['get'](_0x2c1ffa[_0x310a11(0x187)])[_0x310a11(0x1df)](_0x5ded2f);})),this['disposeWithMe'](this[_0x3dbabc(0x1f6)][_0x3dbabc(0x17d)][_0x3dbabc(0x198)](_0x979cba=>{const _0x18d86b=_0x3dbabc;_0x2b1ce4[_0x18d86b(0x141)](_0x2c1ffa[_0x18d86b(0x187)])[_0x18d86b(0x146)](_0x979cba);})),_0x2b1ce4['get'](_0x2c1ffa[_0x3dbabc(0x130)])['setLocale'](this[_0x3dbabc(0x155)][_0x3dbabc(0x16d)]()),_0x2b1ce4[_0x3dbabc(0x141)](_0x2c1ffa[_0x3dbabc(0x150)])[_0x3dbabc(0x176)](_0x2b1cf6['COLLABORATION_CLIENT_PLUGIN_CONFIG_KEY'],this[_0x3dbabc(0x1c7)][_0x3dbabc(0x1e4)](_0x2b1cf6[_0x3dbabc(0x10a)]));const _0x2c303f=this[_0x3dbabc(0x1c7)][_0x3dbabc(0x1e4)](_0x48c5e5[_0x3dbabc(0x104)]);_0x2c303f&&_0x4e0463[_0x3dbabc(0x179)](_0x48c5e5[_0x3dbabc(0x15c)],{'license':_0x2c303f['ls']}),this[_0x3dbabc(0x169)][_0x3dbabc(0x1fd)](([_0x50bbc1,_0x4b4785])=>{_0x4e0463['registerPlugin'](_0x50bbc1,_0x4b4785);}),_0x2b1ce4[_0x3dbabc(0x1e7)](_0x30373a=>{const _0x5db122=_0x3dbabc;this[_0x5db122(0x199)](_0x30373a,_0x14d188);}),this[_0x3dbabc(0x163)][_0x3dbabc(0x14e)](_0x4e0463);const _0x38a6d7=_0x2b1ce4[_0x3dbabc(0x141)](_0x4d4c93[_0x3dbabc(0x1ac)]),_0x4a619d=this['_checkCanRevert'](_0x14d188);_0x38a6d7[_0x3dbabc(0x164)](_0x14d188,_0x2a040b,_0x4a619d);}['_initListener'](_0x48e071,_0x10df93){const _0x558ec2=_0x353da9,_0x3eabaf=_0x48e071[_0x558ec2(0x141)](_0x4d4c93[_0x558ec2(0x1ac)]);this[_0x558ec2(0x14c)]['add'](_0x3eabaf[_0x558ec2(0x1bf)][_0x558ec2(0x198)](_0x215f7b=>{const _0x459442=_0x558ec2;switch(_0x215f7b){case _0x4d4c93['HistoryModeStatus'][_0x459442(0x11f)]:this[_0x459442(0x115)][_0x459442(0x206)](),this[_0x459442(0x19d)][_0x459442(0x1e6)]();break;case _0x4d4c93[_0x459442(0x1bc)][_0x459442(0x1f3)]:this['unMountHistoryContent']();break;case _0x4d4c93['HistoryModeStatus'][_0x459442(0x12c)]:this[_0x459442(0x100)](),this['_messageService'][_0x459442(0x1af)]({'content':this['_localeService']['t'](_0x459442(0x1b1)),'type':_0xdc0735['MessageType'][_0x459442(0x12c)],'duration':0xbb8});break;}})),this['_disposableCollection'][_0x558ec2(0x186)](_0x3eabaf[_0x558ec2(0x175)]['subscribe'](async _0x464f5a=>{const _0x46f3f2=_0x558ec2;_0x464f5a&&this[_0x46f3f2(0x1f4)][_0x46f3f2(0x121)](_0x1ac28c[_0x46f3f2(0x1d4)]['id'],{'unitId':_0x10df93,'revision':_0x464f5a});}));}[_0x353da9(0x177)](_0x508148){const _0x2d88f5=_0x353da9,_0x52aeee=this['_univerInstanceService'][_0x2d88f5(0x1cd)](_0x508148)[_0x2d88f5(0x109)]()[_0x2d88f5(0x1fa)](_0x332c8f=>_0x332c8f['getSheetId']()),_0x3a623b=new _0x348ea4[(_0x2d88f5(0x14f))](_0x508148)['id'],_0x59345c=_0x52aeee[_0x2d88f5(0x1fa)](_0xd5b2d=>new _0x348ea4[(_0x2d88f5(0x12e))](_0x508148,_0xd5b2d)['id']),_0xd67f0f=_0x52aeee[_0x2d88f5(0x1fa)](_0x32ab0b=>this['_selectionProtectionRuleModel'][_0x2d88f5(0x113)](_0x508148,_0x32ab0b)[_0x2d88f5(0x1fa)](_0x5a05fe=>new _0x348ea4['RangeProtectionPermissionEditPoint'](_0x508148,_0x32ab0b,_0x5a05fe[_0x2d88f5(0x1bd)])['id']))[_0x2d88f5(0x205)](),_0x205ad7=new _0x348ea4['WorkbookRecoverHistoryPermission'](_0x508148)['id'];return this[_0x2d88f5(0x1d9)][_0x2d88f5(0x126)]([_0x3a623b,..._0x59345c,..._0xd67f0f,_0x205ad7])[_0x2d88f5(0x204)](_0x134cec=>!!_0x134cec['value']);}},_0x2f6d46[_0x353da9(0x13d)]=_0x1be8e4([_0x1206b0(0x0,_0x2c1ffa[_0x353da9(0x194)](_0x2c1ffa[_0x353da9(0x130)])),_0x1206b0(0x1,_0x2c1ffa['IUniverInstanceService']),_0x1206b0(0x2,_0x2c1ffa[_0x353da9(0x150)]),_0x1206b0(0x3,_0x2c1ffa[_0x353da9(0x197)]),_0x1206b0(0x4,_0x5946d7['IMessageService']),_0x1206b0(0x5,_0x2c1ffa[_0x353da9(0x1dc)]),_0x1206b0(0x6,_0x2c1ffa['Inject'](_0x348ea4[_0x353da9(0x13c)])),_0x1206b0(0x7,_0x2c1ffa['Inject'](_0x5946d7[_0x353da9(0x1e1)])),_0x1206b0(0x8,_0x2c1ffa[_0x353da9(0x194)](_0x5946d7[_0x353da9(0xf7)])),_0x1206b0(0x9,_0x2c1ffa[_0x353da9(0x194)](_0x2c1ffa[_0x353da9(0x187)]))],_0x2f6d46['HistoryLoaderService']);const _0x590e58={'id':_0x353da9(0x107),'type':_0x2c1ffa[_0x353da9(0x209)][_0x353da9(0x1b6)],'handler':_0x54a213=>{const _0x588d40=_0x353da9,_0xdc93a6=_0x54a213[_0x588d40(0x141)](_0x2f6d46[_0x588d40(0x13d)]),_0x493cff=_0x54a213[_0x588d40(0x141)](_0x2c1ffa[_0x588d40(0x147)]),{unitId:_0x491b1d}=_0x348ea4[_0x588d40(0x14d)](_0x493cff)||{};return _0x491b1d?(_0xdc93a6['mountHistoryContent'](_0x491b1d),!0x0):!0x1;}};function _0x2c40a1(_0x3da8b4){const _0x4eab9a=_0x353da9;return{'id':_0x590e58['id'],'type':_0x5946d7[_0x4eab9a(0x202)]['BUTTON'],'icon':_0x4eab9a(0x1b0),'tooltip':_0x4eab9a(0x10b),'hidden$':_0x5946d7[_0x4eab9a(0x19a)](_0x3da8b4,_0x2c1ffa[_0x4eab9a(0x1c8)][_0x4eab9a(0x1da)]),'disabled$':_0x122728[_0x4eab9a(0x17e)](_0x3da8b4,{'workbookTypes':[_0x348ea4[_0x4eab9a(0x14f)],_0x348ea4[_0x4eab9a(0x136)]],'worksheetTypes':[],'rangeTypes':[]})};}const _0x37f0be={[_0x5946d7['RibbonStartGroup']['OTHERS']]:{[_0x590e58['id']]:{'order':0.2,'menuItemFactory':_0x2c40a1}}};var _0xc8660=Object[_0x353da9(0x157)],_0x136514=(_0x5ef931,_0x4efb23,_0xe7d86,_0x58d48f)=>{const _0x3b4f3d=_0x353da9;for(var _0xb64af1=_0x58d48f>0x1?void 0x0:_0x58d48f?_0xc8660(_0x4efb23,_0xe7d86):_0x4efb23,_0x22f67f=_0x5ef931[_0x3b4f3d(0x158)]-0x1,_0x22550b;_0x22f67f>=0x0;_0x22f67f--)(_0x22550b=_0x5ef931[_0x22f67f])&&(_0xb64af1=_0x22550b(_0xb64af1)||_0xb64af1);return _0xb64af1;},_0x43d96a=(_0x35274c,_0x26a6ad)=>(_0x2bd05c,_0x7ce232)=>_0x26a6ad(_0x2bd05c,_0x7ce232,_0x35274c);let _0x3e5f6d=class extends _0x2c1ffa[_0x353da9(0x122)]{constructor(_0x242ee5,_0x4621a3,_0x26caee,_0x145fa6,_0x57b261,_0x1bdb6b,_0x4564f8,_0x5b68be){const _0x5fc892=_0x353da9;super(),_0x3c57bf(this,_0x5fc892(0x1a8),null),(this[_0x5fc892(0x1f4)]=_0x242ee5,this[_0x5fc892(0x1ca)]=_0x4621a3,this[_0x5fc892(0xf8)]=_0x26caee,this[_0x5fc892(0x1f1)]=_0x145fa6,this[_0x5fc892(0x155)]=_0x57b261,this['_messageService']=_0x1bdb6b,this[_0x5fc892(0x118)]=_0x4564f8,this[_0x5fc892(0x18a)]=_0x5b68be,this[_0x5fc892(0x171)]());}[_0x353da9(0x171)](){const _0x558fce=_0x353da9;[_0x590e58]['forEach'](_0x5c58f7=>this[_0x558fce(0x172)](_0x2c1ffa[_0x558fce(0x20a)](this[_0x558fce(0x1f4)]['registerCommand'](_0x5c58f7)))),this[_0x558fce(0x172)](this[_0x558fce(0xf8)]['register'](_0x558fce(0x1b0),_0x544f07)),this[_0x558fce(0x1ca)][_0x558fce(0x1c4)](_0x37f0be),this[_0x558fce(0x172)](this[_0x558fce(0x1f4)][_0x558fce(0x10f)](_0x32b4ff=>{const _0xfa329e=_0x558fce;if(_0x32b4ff['id']===_0x1ac28c[_0xfa329e(0x1d4)]['id']){this[_0xfa329e(0x19b)][_0xfa329e(0x1af)]({'content':this[_0xfa329e(0x155)]['t'](_0xfa329e(0x135)),'type':_0xdc0735[_0xfa329e(0x12a)][_0xfa329e(0x1f5)],'duration':0x1388});const {unitId:_0x1464ab}=_0x32b4ff['params'],_0x296999=this[_0xfa329e(0x118)]['getCollabEntity'](_0x1464ab),_0x444e19=_0xb7bcb6[_0xfa329e(0x142)]([_0x296999[_0xfa329e(0x137)][_0xfa329e(0x1db)],_0x296999['state$']])[_0xfa329e(0x198)](async([_0xfb42f3,_0x3ca1bb])=>{const _0x1f0275=_0xfa329e;var _0x164af4;_0xfb42f3[_0x1f0275(0x1aa)]===_0x1ac28c[_0x1f0275(0x19e)]['CHANGESET_ACK']&&(_0x3ca1bb==null?void 0x0:_0x3ca1bb[_0x1f0275(0xfc)])===_0x2b1cf6['CollaborationStatus'][_0x1f0275(0x165)]&&_0xfb42f3[_0x1f0275(0x16f)][_0x1f0275(0x101)][_0x1f0275(0x20e)](_0x4a2f81=>_0x4a2f81['id']===_0x1ac28c[_0x1f0275(0x1d4)]['id'])&&(this[_0x1f0275(0x1f1)][_0x1f0275(0x100)](),_0x444e19['unsubscribe'](),this[_0x1f0275(0x1a8)]&&clearTimeout(this['_revertErrorTimer']),await((_0x164af4=this['_localCacheService'])==null?void 0x0:_0x164af4[_0x1f0275(0x152)]()),setTimeout(()=>window[_0x1f0275(0x18b)]['reload']()));});this[_0xfa329e(0x1a8)]=setTimeout(()=>{const _0x53370c=_0xfa329e;_0x444e19[_0x53370c(0x11e)](),this[_0x53370c(0x19b)][_0x53370c(0x1af)]({'content':this[_0x53370c(0x155)]['t'](_0x53370c(0x188)),'type':_0xdc0735['MessageType'][_0x53370c(0x12c)],'duration':0xbb8});},0x1388);}}));}};_0x3e5f6d=_0x136514([_0x43d96a(0x0,_0x2c1ffa['ICommandService']),_0x43d96a(0x1,_0x5946d7['IMenuManagerService']),_0x43d96a(0x2,_0x2c1ffa[_0x353da9(0x194)](_0x5946d7[_0x353da9(0x193)])),_0x43d96a(0x3,_0x2c1ffa[_0x353da9(0x194)](_0x2f6d46[_0x353da9(0x13d)])),_0x43d96a(0x4,_0x2c1ffa[_0x353da9(0x194)](_0x2c1ffa[_0x353da9(0x130)])),_0x43d96a(0x5,_0x5946d7[_0x353da9(0x1ce)]),_0x43d96a(0x6,_0x2c1ffa[_0x353da9(0x194)](_0x2b1cf6[_0x353da9(0x16b)])),_0x43d96a(0x7,_0x2b1cf6[_0x353da9(0x1b5)])],_0x3e5f6d);var _0x19627e=Object[_0x353da9(0x157)],_0x4958f2=(_0x376633,_0x3b8ff1,_0x23875d,_0x184452)=>{for(var _0x159745=_0x184452>0x1?void 0x0:_0x184452?_0x19627e(_0x3b8ff1,_0x23875d):_0x3b8ff1,_0x5a27a9=_0x376633['length']-0x1,_0x2886ae;_0x5a27a9>=0x0;_0x5a27a9--)(_0x2886ae=_0x376633[_0x5a27a9])&&(_0x159745=_0x2886ae(_0x159745)||_0x159745);return _0x159745;},_0x55c981=(_0x1b68c2,_0x505ace)=>(_0x51ff24,_0x1216af)=>_0x505ace(_0x51ff24,_0x1216af,_0x1b68c2);const _0x2c887a=_0x353da9(0x123);_0x2f6d46['UniverEditHistoryLoaderPlugin']=(_0x3de355=class extends _0x2c1ffa[_0x353da9(0x159)]{constructor(_0x6112b2=_0x2a7967,_0x299c67,_0x496941){const _0x7373af=_0x353da9;super(),this[_0x7373af(0x1b2)]=_0x6112b2,this['_injector']=_0x299c67,this[_0x7373af(0x1c7)]=_0x496941;const {menu:_0x5e1fa2,..._0x404012}=_0x2c1ffa[_0x7373af(0x207)]({},_0x2a7967,this[_0x7373af(0x1b2)]);_0x5e1fa2&&this[_0x7373af(0x1c7)]['setConfig'](_0x7373af(0x1d7),_0x5e1fa2,{'merge':!0x0}),this[_0x7373af(0x1c7)][_0x7373af(0x176)](_0x3bb203,_0x404012),this[_0x7373af(0x1b2)][_0x7373af(0x140)]&&this[_0x7373af(0x1c7)][_0x7373af(0x176)](_0x59e2bb,this[_0x7373af(0x1b2)][_0x7373af(0x140)]);}['onStarting'](){const _0x285614=_0x353da9;[[_0x2f6d46[_0x285614(0x13d)]],[_0x3e5f6d]][_0x285614(0x1fd)](_0x591991=>this[_0x285614(0x105)][_0x285614(0x186)](_0x591991));}[_0x353da9(0x18c)](){const _0x30a5e0=_0x353da9;this['_injector'][_0x30a5e0(0x141)](_0x3e5f6d);}},_0x3c57bf(_0x3de355,'type',_0x2c1ffa['UniverInstanceType']['UNIVER_UNKNOWN']),_0x3c57bf(_0x3de355,_0x353da9(0x1ef),_0x2c887a),_0x3de355),_0x2f6d46[_0x353da9(0x134)]=_0x4958f2([_0x55c981(0x1,_0x2c1ffa[_0x353da9(0x194)](_0x2c1ffa['Injector'])),_0x55c981(0x2,_0x2c1ffa[_0x353da9(0x150)])],_0x2f6d46[_0x353da9(0x134)]),_0x2f6d46[_0x353da9(0x110)]=_0x59e2bb,_0x2f6d46[_0x353da9(0x108)]=_0x51e7e3,Object['defineProperty'](_0x2f6d46,Symbol['toStringTag'],{'value':'Module'});}));

// index
(function(e,o){typeof exports=="object"&&typeof module<"u"?o(exports,require("@univerjs-pro/collaboration"),require("@univerjs-pro/collaboration-client"),require("@univerjs-pro/collaboration-client-ui"),require("@univerjs-pro/edit-history-loader"),require("@univerjs-pro/collaboration-client/lib/facade"),require("@univerjs-pro/collaboration-client-ui/lib/facade")):typeof define=="function"&&define.amd?define(["exports","@univerjs-pro/collaboration","@univerjs-pro/collaboration-client","@univerjs-pro/collaboration-client-ui","@univerjs-pro/edit-history-loader","@univerjs-pro/collaboration-client/lib/facade","@univerjs-pro/collaboration-client-ui/lib/facade"],o):(e=typeof globalThis<"u"?globalThis:e||self,o(e.UniverPresetSheetsCollaboration={},e.UniverProCollaboration,e.UniverProCollaborationClient,e.UniverProCollaborationClientUi,e.UniverProEditHistoryLoader))})(this,(function(e,o,l,t,a){"use strict";function s(n){const i=new URL(n,window.location.origin);switch(i.protocol){case"https:":i.protocol="wss:";break;case"http:":i.protocol="ws:";break}return i.toString()}function u(n={}){const{universerEndpoint:i,univerContainerId:c="app",enableOfflineEditing:p=!0,enableSingleActiveInstanceLock:v=!0}=n,r=i!=null?i:`${window.location.protocol}//${window.location.host}`;return{plugins:[o.UniverCollaborationPlugin,[l.UniverCollaborationClientPlugin,{socketService:t.BrowserCollaborationSocketService,enableOfflineEditing:p,enableSingleActiveInstanceLock:v,enableAuthServer:!0,authzUrl:`${r}/universer-api/authz`,snapshotServerUrl:`${r}/universer-api/snapshot`,collabSubmitChangesetUrl:`${r}/universer-api/comb`,collabWebSocketUrl:s(`${r}/universer-api/comb/connect`),loginUrlKey:`${r}/universer-api/oidc/authpage`,uploadFileServerUrl:`${r}/universer-api/stream/file/upload`,signUrlServerUrl:`${r}/universer-api/file/{fileID}/sign-url`,downloadEndpointUrl:`${r}/`,wsSessionTicketUrl:`${r}/universer-api/user/session-ticket`,sendChangesetTimeout:200}],[t.UniverCollaborationClientUIPlugin,{}],[a.UniverEditHistoryLoaderPlugin,{univerContainerId:c,historyListServerUrl:`${r}/universer-api/history`}]]}}e.UniverSheetsCollaborationPreset=u,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
