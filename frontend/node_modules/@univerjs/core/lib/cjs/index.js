"use strict";var Id=Object.defineProperty;var Sd=(e,t,n)=>t in e?Id(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var p=(e,t,n)=>Sd(e,typeof t!="symbol"?t+"":t,n);Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const Ae=require("@wendellhu/redi"),ce=require("rxjs"),ls=require("rxjs/operators"),Kr=require("@univerjs/themes");function Od(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in e)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(e,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}const Pt=typeof global<"u"?global:typeof self<"u"?self:window;function vd(){const t=new Map;let n=0;typeof Pt.requestIdleCallback!="function"&&(Pt.requestIdleCallback=function(s){const i=Date.now(),o=++n,a=setTimeout(function(){t.delete(o);const c=Math.max(0,50-(Date.now()-i));s({didTimeout:c===0,timeRemaining(){return c}})},1);return t.set(o,a),o}),typeof Pt.cancelIdleCallback!="function"&&(Pt.cancelIdleCallback=function(s){const i=t.get(s);i!==void 0&&(clearTimeout(i),t.delete(s))})}function wd(){typeof Pt.Array.prototype.findLastIndex!="function"&&(Pt.Array.prototype.findLastIndex=function(t,n){if(this==null)throw new TypeError("Array.prototype.findLastIndex called on null or undefined");if(typeof t!="function")throw new TypeError("callback must be a function");const r=this.length>>>0;for(let s=r-1;s>=0;s--)if(s in this&&t.call(n,this[s],s,this))return s;return-1}),typeof Pt.Array.prototype.findLast!="function"&&(Pt.Array.prototype.findLast=function(t,n){const r=this.findLastIndex(t,n);return r!==-1?this[r]:void 0})}function bd(){typeof Pt.String.prototype.at!="function"&&(Pt.String.prototype.at=function(t){if(this==null)throw new TypeError("String.prototype.at called on null or undefined");const n=this.length;if(t<0&&(t=n+t),!(t<0||t>=n))return this.charAt(t)})}function Ad(){vd(),wd(),bd()}function Ur(e,t){const n=e.indexOf(t);return n>-1?(e.splice(n,1),!0):!1}function Td(e){const t=new Set,n=[];for(const r of e)t.has(r)||(t.add(r),n.push(r));return n}function yd(e,t){const n=new Set,r=[];for(const s of e){const i=t(s);n.has(i)||(n.add(i),r.push(s))}return r}function Nd(e,t){for(let n=e.length-1;n>-1;n--){const r=e[n];if(t(r,n))return r}return null}function Md(e,t){if(e.length===0)return e;const n=t%e.length;return e.slice(n).concat(e.slice(0,n))}function Ld(e,t){const n=new Map;return e.forEach(r=>{const s=t(r);let i=n.get(s);n.has(s)||(i=[],n.set(s,i)),i.push(r)}),n}function Dd(e){return Array.isArray(e)?e:[e]}function St(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ni,ma;function xd(){if(ma)return ni;ma=1;var e=function(t){if(t=t||{},this.Promise=t.Promise||Promise,this.queues=Object.create(null),this.domainReentrant=t.domainReentrant||!1,this.domainReentrant){if(typeof process>"u"||typeof process.domain>"u")throw new Error("Domain-reentrant locks require `process.domain` to exist. Please flip `opts.domainReentrant = false`, use a NodeJS version that still implements Domain, or install a browser polyfill.");this.domains=Object.create(null)}this.timeout=t.timeout||e.DEFAULT_TIMEOUT,this.maxOccupationTime=t.maxOccupationTime||e.DEFAULT_MAX_OCCUPATION_TIME,this.maxExecutionTime=t.maxExecutionTime||e.DEFAULT_MAX_EXECUTION_TIME,t.maxPending===1/0||Number.isInteger(t.maxPending)&&t.maxPending>=0?this.maxPending=t.maxPending:this.maxPending=e.DEFAULT_MAX_PENDING};return e.DEFAULT_TIMEOUT=0,e.DEFAULT_MAX_OCCUPATION_TIME=0,e.DEFAULT_MAX_EXECUTION_TIME=0,e.DEFAULT_MAX_PENDING=1e3,e.prototype.acquire=function(t,n,r,s){if(Array.isArray(t))return this._acquireBatch(t,n,r,s);if(typeof n!="function")throw new Error("You must pass a function to execute");var i=null,o=null,a=null;typeof r!="function"&&(s=r,r=null,a=new this.Promise(function(k,W){i=k,o=W})),s=s||{};var l=!1,c=null,u=null,h=null,d=this,f=function(k,W,S){u&&(clearTimeout(u),u=null),h&&(clearTimeout(h),h=null),k&&(d.queues[t]&&d.queues[t].length===0&&delete d.queues[t],d.domainReentrant&&delete d.domains[t]),l||(a?W?o(W):i(S):typeof r=="function"&&r(W,S),l=!0),k&&d.queues[t]&&d.queues[t].length>0&&d.queues[t].shift()()},g=function(k){if(l)return f(k);c&&(clearTimeout(c),c=null),d.domainReentrant&&k&&(d.domains[t]=process.domain);var W=s.maxExecutionTime||d.maxExecutionTime;if(W&&(h=setTimeout(function(){d.queues[t]&&f(k,new Error("Maximum execution time is exceeded "+t))},W)),n.length===1){var S=!1;try{n(function(C,w){S||(S=!0,f(k,C,w))})}catch(C){S||(S=!0,f(k,C))}}else d._promiseTry(function(){return n()}).then(function(C){f(k,void 0,C)},function(C){f(k,C)})};d.domainReentrant&&process.domain&&(g=process.domain.bind(g));var _=s.maxPending||d.maxPending;if(!d.queues[t])d.queues[t]=[],g(!0);else if(d.domainReentrant&&process.domain&&process.domain===d.domains[t])g(!1);else if(d.queues[t].length>=_)f(!1,new Error("Too many pending tasks in queue "+t));else{var R=function(){g(!0)};s.skipQueue?d.queues[t].unshift(R):d.queues[t].push(R);var b=s.timeout||d.timeout;b&&(c=setTimeout(function(){c=null,f(!1,new Error("async-lock timed out in queue "+t))},b))}var F=s.maxOccupationTime||d.maxOccupationTime;if(F&&(u=setTimeout(function(){d.queues[t]&&f(!1,new Error("Maximum occupation time is exceeded in queue "+t))},F)),a)return a},e.prototype._acquireBatch=function(t,n,r,s){typeof r!="function"&&(s=r,r=null);var i=this,o=function(l,c){return function(u){i.acquire(l,c,u,s)}},a=t.reduceRight(function(l,c){return o(c,l)},n);if(typeof r=="function")a(r);else return new this.Promise(function(l,c){a.length===1?a(function(u,h){u?c(u):l(h)}):l(a())})},e.prototype.isBusy=function(t){return t?!!this.queues[t]:Object.keys(this.queues).length>0},e.prototype._promiseTry=function(t){try{return this.Promise.resolve(t())}catch(n){return this.Promise.reject(n)}},ni=e,ni}var ri,ga;function Ud(){return ga||(ga=1,ri=xd()),ri}var Pd=Ud();const kd=St(Pd),Fd=new Set(["true","false"]);function Bd(e){return Fd.has(e.toLowerCase())}const Pr="__INTERNAL_EDITOR__",io=`${Pr}DOCS_NORMAL`,oo=`${Pr}DOCS_FORMULA_BAR`,Nl=`${Pr}ZEN_EDITOR`,Ml=`\r
`,Ll="isRowStylePrecedeColumnStyle",Dl=Symbol("AUTO_HEIGHT_FOR_MERGED_CELLS");function $d(e){return`${Pr}${e}`}function xl(e){return e.startsWith(Pr)}function Hd(e,t){t.forEach(n=>e.add(n))}function Ul(e,t){t.forEach(([n])=>{e.has(n)&&e.get(n)})}function Pl(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||!e||typeof t!="object"||!t)return!1;const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;const s=Object.prototype.hasOwnProperty.bind(t);for(let i=0;i<n.length;i++){const o=n[i];if(!s(o))return!1;const a=e[o],l=t[o];if(a!==l)return!1}return!0}class Ss extends Error{constructor(t){super(t),this.name="CustomCommandExecutionError"}}class jd extends Ss{constructor(){super("Canceled by facade"),this.name="CanceledError"}}function Wd(e,t=16){let n=0,r=null;return function(...i){const o=Date.now();o-n<t?(r&&clearTimeout(r),r=setTimeout(()=>{n=o,e.apply(this,i)},t)):(n=o,e.apply(this,i))}}var Pn=(e=>(e[e.Style=1]="Style",e[e.Value=2]="Value",e))(Pn||{});function Yd(e){return`sheet_interceptor_${e}`}const kl=e=>function(t,n){let r=-1,s=t;for(let i=0;i<=e.length;i++){if(i<=r)throw new Error("[SheetInterceptorService]: next() called multiple times!");if(r=i,i===e.length)return s;const o=e[i];let a=!1;if(s=o.handler(s,n,l=>(a=!0,l)),!a)break}return s};class Gd{constructor(t){p(this,"_interceptorsByName",new Map);p(this,"_interceptorPoints");this._interceptorPoints=t}fetchThroughInterceptors(t,n){const r=t;let s=this._interceptorsByName.get(r);return n&&(s=s.filter(n)),kl(s||[])}intercept(t,n){const r=t;this._interceptorsByName.has(r)||this._interceptorsByName.set(r,[]);const s=this._interceptorsByName.get(r);return s.push(n),this._interceptorsByName.set(r,s.sort((i,o)=>{var a,l;return((a=o.priority)!=null?a:0)-((l=i.priority)!=null?l:0)})),()=>Ur(this._interceptorsByName.get(r),n)}getInterceptPoints(){return this._interceptorPoints}dispose(){this._interceptorsByName.clear()}}function Vd(e){return`sheet_async_interceptor_${e}`}const zd=e=>async function(t,n){let r=-1,s=t;for(let i=0;i<=e.length;i++){if(i<=r)throw new Error("[SheetInterceptorService]: next() called multiple times!");if(r=i,i===e.length)return s;const o=e[i];let a=!1;if(s=await o.handler(s,n,async l=>(a=!0,l)),!a)break}return s};class Kd{constructor(t){p(this,"_asyncInterceptorsByName",new Map);p(this,"_asyncInterceptorPoints");this._asyncInterceptorPoints=t}fetchThroughAsyncInterceptors(t,n){const r=t;let s=this._asyncInterceptorsByName.get(r);return n&&(s=s.filter(n)),zd(s||[])}async interceptAsync(t,n){const r=t;this._asyncInterceptorsByName.has(r)||this._asyncInterceptorsByName.set(r,[]);const s=this._asyncInterceptorsByName.get(r);return s.push(n),this._asyncInterceptorsByName.set(r,s.sort((i,o)=>{var a,l;return((a=o.priority)!=null?a:0)-((l=i.priority)!=null?l:0)})),()=>Ur(this._asyncInterceptorsByName.get(r),n)}getInterceptPoints(){return this._asyncInterceptorPoints}dispose(){this._asyncInterceptorsByName.clear()}}function Fl(e){return e.map(t=>t/255)}function Bl(e){return e.map(t=>Math.round(t*255))}function Xd([e,t,n]){const r=Math.max(e,t,n),s=Math.min(e,t,n),i=(r+s)/2;let o=0,a=0;if(r!==s){const l=r-s;switch(a=i>.5?l/(2-r-s):l/(r+s),r){case e:o=(t-n)/l+(t<n?6:0);break;case t:o=(n-e)/l+2;break;case n:o=(e-t)/l+4;break}o/=6}return[o,a,i]}function Os(e,t,n){const r=[e,t,n].map(s=>s<=.03928?s/12.92:((s+.055)/1.055)**2.4);return .2126*r[0]+.7152*r[1]+.0722*r[2]}function _a(e,t){return(Math.max(e,t)+.05)/(Math.min(e,t)+.05)}function qd(e,t,n){let r,s,i;if(t===0)r=s=i=n;else{const o=(c,u,h)=>{let d=h;return d<0&&(d+=1),d>1&&(d-=1),d<.16666666666666666?c+(u-c)*6*d:d<.5?u:d<.6666666666666666?c+(u-c)*(.6666666666666666-d)*6:c},a=n<.5?n*(1+t):n+t-n*t,l=2*n-a;r=o(l,a,e+1/3),s=o(l,a,e),i=o(l,a,e-1/3)}return[r,s,i]}const si={r:1,g:1,b:1},ii={r:0,g:0,b:0},Zd=Os(si.r,si.g,si.b),Jd=Os(ii.r,ii.g,ii.b);function Qd(e){const t=Os(e[0],e[1],e[2]),n=_a(Zd,t),r=Xd(e);let s=1-r[2],i,o,a;do i=qd(r[0],r[1],s),o=Os(i[0],i[1],i[2]),a=_a(o,Jd),s+=.01;while(s<=1&&s>=0&&Math.abs(a-n)<.01);return i}function ef(e){return Bl(Qd(Fl(e)))}const gt=[[.333,-.667,-.667,0,1],[-.667,.333,-.667,0,1],[-.667,-.667,.333,0,1],[0,0,0,1,0]];function tf(e){const t=e[0],n=e[1],r=e[2];let s=[gt[0][0]*t+gt[0][1]*n+gt[0][2]*r+gt[0][4],gt[1][0]*t+gt[1][1]*n+gt[1][2]*r+gt[1][4],gt[2][0]*t+gt[2][1]*n+gt[2][2]*r+gt[2][4]];return s=s.map(i=>i>1?1:i<0?0:i),s}function nf(e){return Bl(tf(Fl(e)))}var $l=typeof global=="object"&&global&&global.Object===Object&&global,rf=typeof self=="object"&&self&&self.Object===Object&&self,On=$l||rf||Function("return this")(),Vn=On.Symbol,Hl=Object.prototype,sf=Hl.hasOwnProperty,of=Hl.toString,tr=Vn?Vn.toStringTag:void 0;function af(e){var t=sf.call(e,tr),n=e[tr];try{e[tr]=void 0;var r=!0}catch{}var s=of.call(e);return r&&(t?e[tr]=n:delete e[tr]),s}var lf=Object.prototype,cf=lf.toString;function uf(e){return cf.call(e)}var hf="[object Null]",df="[object Undefined]",pa=Vn?Vn.toStringTag:void 0;function kr(e){return e==null?e===void 0?df:hf:pa&&pa in Object(e)?af(e):uf(e)}function qn(e){return e!=null&&typeof e=="object"}var ff="[object Symbol]";function ks(e){return typeof e=="symbol"||qn(e)&&kr(e)==ff}function mf(e,t){for(var n=-1,r=e==null?0:e.length,s=Array(r);++n<r;)s[n]=t(e[n],n,e);return s}var zn=Array.isArray,Ea=Vn?Vn.prototype:void 0,Ca=Ea?Ea.toString:void 0;function jl(e){if(typeof e=="string")return e;if(zn(e))return mf(e,jl)+"";if(ks(e))return Ca?Ca.call(e):"";var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var gf=/\s/;function _f(e){for(var t=e.length;t--&&gf.test(e.charAt(t)););return t}var pf=/^\s+/;function Ef(e){return e&&e.slice(0,_f(e)+1).replace(pf,"")}function It(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Ra=NaN,Cf=/^[-+]0x[0-9a-f]+$/i,Rf=/^0b[01]+$/i,If=/^0o[0-7]+$/i,Sf=parseInt;function Ia(e){if(typeof e=="number")return e;if(ks(e))return Ra;if(It(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=It(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=Ef(e);var n=Rf.test(e);return n||If.test(e)?Sf(e.slice(2),n?2:8):Cf.test(e)?Ra:+e}function Wl(e){return e}var Of="[object AsyncFunction]",vf="[object Function]",wf="[object GeneratorFunction]",bf="[object Proxy]";function ao(e){if(!It(e))return!1;var t=kr(e);return t==vf||t==wf||t==Of||t==bf}var oi=On["__core-js_shared__"],Sa=(function(){var e=/[^.]+$/.exec(oi&&oi.keys&&oi.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""})();function Af(e){return!!Sa&&Sa in e}var Tf=Function.prototype,yf=Tf.toString;function Nf(e){if(e!=null){try{return yf.call(e)}catch{}try{return e+""}catch{}}return""}var Mf=/[\\^$.*+?()[\]{}|]/g,Lf=/^\[object .+?Constructor\]$/,Df=Function.prototype,xf=Object.prototype,Uf=Df.toString,Pf=xf.hasOwnProperty,kf=RegExp("^"+Uf.call(Pf).replace(Mf,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Ff(e){if(!It(e)||Af(e))return!1;var t=ao(e)?kf:Lf;return t.test(Nf(e))}function Bf(e,t){return e==null?void 0:e[t]}function lo(e,t){var n=Bf(e,t);return Ff(n)?n:void 0}var Oa=Object.create,$f=(function(){function e(){}return function(t){if(!It(t))return{};if(Oa)return Oa(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}})();function Hf(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function jf(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}var Wf=800,Yf=16,Gf=Date.now;function Vf(e){var t=0,n=0;return function(){var r=Gf(),s=Yf-(r-n);if(n=r,s>0){if(++t>=Wf)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}function zf(e){return function(){return e}}var vs=(function(){try{var e=lo(Object,"defineProperty");return e({},"",{}),e}catch{}})(),Kf=vs?function(e,t){return vs(e,"toString",{configurable:!0,enumerable:!1,value:zf(t),writable:!0})}:Wl,Xf=Vf(Kf),qf=9007199254740991,Zf=/^(?:0|[1-9]\d*)$/;function co(e,t){var n=typeof e;return t=t==null?qf:t,!!t&&(n=="number"||n!="symbol"&&Zf.test(e))&&e>-1&&e%1==0&&e<t}function uo(e,t,n){t=="__proto__"&&vs?vs(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function Fs(e,t){return e===t||e!==e&&t!==t}var Jf=Object.prototype,Qf=Jf.hasOwnProperty;function Yl(e,t,n){var r=e[t];(!(Qf.call(e,t)&&Fs(r,n))||n===void 0&&!(t in e))&&uo(e,t,n)}function em(e,t,n,r){var s=!n;n||(n={});for(var i=-1,o=t.length;++i<o;){var a=t[i],l=void 0;l===void 0&&(l=e[a]),s?uo(n,a,l):Yl(n,a,l)}return n}var va=Math.max;function tm(e,t,n){return t=va(t===void 0?e.length-1:t,0),function(){for(var r=arguments,s=-1,i=va(r.length-t,0),o=Array(i);++s<i;)o[s]=r[t+s];s=-1;for(var a=Array(t+1);++s<t;)a[s]=r[s];return a[t]=n(o),Hf(e,this,a)}}function nm(e,t){return Xf(tm(e,t,Wl),e+"")}var rm=9007199254740991;function Gl(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=rm}function ho(e){return e!=null&&Gl(e.length)&&!ao(e)}function sm(e,t,n){if(!It(n))return!1;var r=typeof t;return(r=="number"?ho(n)&&co(t,n.length):r=="string"&&t in n)?Fs(n[t],e):!1}function Vl(e){return nm(function(t,n){var r=-1,s=n.length,i=s>1?n[s-1]:void 0,o=s>2?n[2]:void 0;for(i=e.length>3&&typeof i=="function"?(s--,i):void 0,o&&sm(n[0],n[1],o)&&(i=s<3?void 0:i,s=1),t=Object(t);++r<s;){var a=n[r];a&&e(t,a,r,i)}return t})}var im=Object.prototype;function zl(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||im;return e===n}function om(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}var am="[object Arguments]";function wa(e){return qn(e)&&kr(e)==am}var Kl=Object.prototype,lm=Kl.hasOwnProperty,cm=Kl.propertyIsEnumerable,Ti=wa((function(){return arguments})())?wa:function(e){return qn(e)&&lm.call(e,"callee")&&!cm.call(e,"callee")};function um(){return!1}var Xl=typeof exports=="object"&&exports&&!exports.nodeType&&exports,ba=Xl&&typeof module=="object"&&module&&!module.nodeType&&module,hm=ba&&ba.exports===Xl,Aa=hm?On.Buffer:void 0,dm=Aa?Aa.isBuffer:void 0,ql=dm||um,fm="[object Arguments]",mm="[object Array]",gm="[object Boolean]",_m="[object Date]",pm="[object Error]",Em="[object Function]",Cm="[object Map]",Rm="[object Number]",Im="[object Object]",Sm="[object RegExp]",Om="[object Set]",vm="[object String]",wm="[object WeakMap]",bm="[object ArrayBuffer]",Am="[object DataView]",Tm="[object Float32Array]",ym="[object Float64Array]",Nm="[object Int8Array]",Mm="[object Int16Array]",Lm="[object Int32Array]",Dm="[object Uint8Array]",xm="[object Uint8ClampedArray]",Um="[object Uint16Array]",Pm="[object Uint32Array]",Fe={};Fe[Tm]=Fe[ym]=Fe[Nm]=Fe[Mm]=Fe[Lm]=Fe[Dm]=Fe[xm]=Fe[Um]=Fe[Pm]=!0;Fe[fm]=Fe[mm]=Fe[bm]=Fe[gm]=Fe[Am]=Fe[_m]=Fe[pm]=Fe[Em]=Fe[Cm]=Fe[Rm]=Fe[Im]=Fe[Sm]=Fe[Om]=Fe[vm]=Fe[wm]=!1;function km(e){return qn(e)&&Gl(e.length)&&!!Fe[kr(e)]}function Fm(e){return function(t){return e(t)}}var Zl=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Or=Zl&&typeof module=="object"&&module&&!module.nodeType&&module,Bm=Or&&Or.exports===Zl,ai=Bm&&$l.process,Ta=(function(){try{var e=Or&&Or.require&&Or.require("util").types;return e||ai&&ai.binding&&ai.binding("util")}catch{}})(),ya=Ta&&Ta.isTypedArray,Jl=ya?Fm(ya):km;function $m(e,t){var n=zn(e),r=!n&&Ti(e),s=!n&&!r&&ql(e),i=!n&&!r&&!s&&Jl(e),o=n||r||s||i,a=o?om(e.length,String):[],l=a.length;for(var c in e)o&&(c=="length"||s&&(c=="offset"||c=="parent")||i&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||co(c,l))||a.push(c);return a}function Hm(e,t){return function(n){return e(t(n))}}function jm(e){var t=[];if(e!=null)for(var n in Object(e))t.push(n);return t}var Wm=Object.prototype,Ym=Wm.hasOwnProperty;function Gm(e){if(!It(e))return jm(e);var t=zl(e),n=[];for(var r in e)r=="constructor"&&(t||!Ym.call(e,r))||n.push(r);return n}function Ql(e){return ho(e)?$m(e):Gm(e)}var Vm=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,zm=/^\w*$/;function Km(e,t){if(zn(e))return!1;var n=typeof e;return n=="number"||n=="symbol"||n=="boolean"||e==null||ks(e)?!0:zm.test(e)||!Vm.test(e)||t!=null&&e in Object(t)}var Ar=lo(Object,"create");function Xm(){this.__data__=Ar?Ar(null):{},this.size=0}function qm(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var Zm="__lodash_hash_undefined__",Jm=Object.prototype,Qm=Jm.hasOwnProperty;function eg(e){var t=this.__data__;if(Ar){var n=t[e];return n===Zm?void 0:n}return Qm.call(t,e)?t[e]:void 0}var tg=Object.prototype,ng=tg.hasOwnProperty;function rg(e){var t=this.__data__;return Ar?t[e]!==void 0:ng.call(t,e)}var sg="__lodash_hash_undefined__";function ig(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Ar&&t===void 0?sg:t,this}function Rn(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Rn.prototype.clear=Xm;Rn.prototype.delete=qm;Rn.prototype.get=eg;Rn.prototype.has=rg;Rn.prototype.set=ig;function og(){this.__data__=[],this.size=0}function Bs(e,t){for(var n=e.length;n--;)if(Fs(e[n][0],t))return n;return-1}var ag=Array.prototype,lg=ag.splice;function cg(e){var t=this.__data__,n=Bs(t,e);if(n<0)return!1;var r=t.length-1;return n==r?t.pop():lg.call(t,n,1),--this.size,!0}function ug(e){var t=this.__data__,n=Bs(t,e);return n<0?void 0:t[n][1]}function hg(e){return Bs(this.__data__,e)>-1}function dg(e,t){var n=this.__data__,r=Bs(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}function Vt(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Vt.prototype.clear=og;Vt.prototype.delete=cg;Vt.prototype.get=ug;Vt.prototype.has=hg;Vt.prototype.set=dg;var ec=lo(On,"Map");function fg(){this.size=0,this.__data__={hash:new Rn,map:new(ec||Vt),string:new Rn}}function mg(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function $s(e,t){var n=e.__data__;return mg(t)?n[typeof t=="string"?"string":"hash"]:n.map}function gg(e){var t=$s(this,e).delete(e);return this.size-=t?1:0,t}function _g(e){return $s(this,e).get(e)}function pg(e){return $s(this,e).has(e)}function Eg(e,t){var n=$s(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}function an(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}an.prototype.clear=fg;an.prototype.delete=gg;an.prototype.get=_g;an.prototype.has=pg;an.prototype.set=Eg;var Cg="Expected a function";function fo(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(Cg);var n=function(){var r=arguments,s=t?t.apply(this,r):r[0],i=n.cache;if(i.has(s))return i.get(s);var o=e.apply(this,r);return n.cache=i.set(s,o)||i,o};return n.cache=new(fo.Cache||an),n}fo.Cache=an;var Rg=500;function Ig(e){var t=fo(e,function(r){return n.size===Rg&&n.clear(),r}),n=t.cache;return t}var Sg=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Og=/\\(\\)?/g,vg=Ig(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(Sg,function(n,r,s,i){t.push(s?i.replace(Og,"$1"):r||n)}),t});function wg(e){return e==null?"":jl(e)}function tc(e,t){return zn(e)?e:Km(e,t)?[e]:vg(wg(e))}function nc(e){if(typeof e=="string"||ks(e))return e;var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}function bg(e,t){t=tc(t,e);for(var n=0,r=t.length;e!=null&&n<r;)e=e[nc(t[n++])];return n&&n==r?e:void 0}function rc(e,t,n){var r=e==null?void 0:bg(e,t);return r===void 0?n:r}var sc=Hm(Object.getPrototypeOf,Object),Ag="[object Object]",Tg=Function.prototype,yg=Object.prototype,ic=Tg.toString,Ng=yg.hasOwnProperty,Mg=ic.call(Object);function Lg(e){if(!qn(e)||kr(e)!=Ag)return!1;var t=sc(e);if(t===null)return!0;var n=Ng.call(t,"constructor")&&t.constructor;return typeof n=="function"&&n instanceof n&&ic.call(n)==Mg}function Dg(){this.__data__=new Vt,this.size=0}function xg(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}function Ug(e){return this.__data__.get(e)}function Pg(e){return this.__data__.has(e)}var kg=200;function Fg(e,t){var n=this.__data__;if(n instanceof Vt){var r=n.__data__;if(!ec||r.length<kg-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new an(r)}return n.set(e,t),this.size=n.size,this}function Zn(e){var t=this.__data__=new Vt(e);this.size=t.size}Zn.prototype.clear=Dg;Zn.prototype.delete=xg;Zn.prototype.get=Ug;Zn.prototype.has=Pg;Zn.prototype.set=Fg;var oc=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Na=oc&&typeof module=="object"&&module&&!module.nodeType&&module,Bg=Na&&Na.exports===oc,Ma=Bg?On.Buffer:void 0;Ma&&Ma.allocUnsafe;function $g(e,t){return e.slice()}var La=On.Uint8Array;function Hg(e){var t=new e.constructor(e.byteLength);return new La(t).set(new La(e)),t}function jg(e,t){var n=Hg(e.buffer);return new e.constructor(n,e.byteOffset,e.length)}function Wg(e){return typeof e.constructor=="function"&&!zl(e)?$f(sc(e)):{}}function Yg(e){return function(t,n,r){for(var s=-1,i=Object(t),o=r(t),a=o.length;a--;){var l=o[++s];if(n(i[l],l,i)===!1)break}return t}}var Gg=Yg(),li=function(){return On.Date.now()},Vg="Expected a function",zg=Math.max,Kg=Math.min;function Xg(e,t,n){var r,s,i,o,a,l,c=0,u=!1,h=!1,d=!0;if(typeof e!="function")throw new TypeError(Vg);t=Ia(t)||0,It(n)&&(u=!!n.leading,h="maxWait"in n,i=h?zg(Ia(n.maxWait)||0,t):i,d="trailing"in n?!!n.trailing:d);function f(C){var w=r,T=s;return r=s=void 0,c=C,o=e.apply(T,w),o}function g(C){return c=C,a=setTimeout(b,t),u?f(C):o}function _(C){var w=C-l,T=C-c,B=t-w;return h?Kg(B,i-T):B}function R(C){var w=C-l,T=C-c;return l===void 0||w>=t||w<0||h&&T>=i}function b(){var C=li();if(R(C))return F(C);a=setTimeout(b,_(C))}function F(C){return a=void 0,d&&r?f(C):(r=s=void 0,o)}function k(){a!==void 0&&clearTimeout(a),c=0,r=l=s=a=void 0}function W(){return a===void 0?o:F(li())}function S(){var C=li(),w=R(C);if(r=arguments,s=this,l=C,w){if(a===void 0)return g(l);if(h)return clearTimeout(a),a=setTimeout(b,t),f(l)}return a===void 0&&(a=setTimeout(b,t)),o}return S.cancel=k,S.flush=W,S}function yi(e,t,n){(n!==void 0&&!Fs(e[t],n)||n===void 0&&!(t in e))&&uo(e,t,n)}function qg(e){return qn(e)&&ho(e)}function Ni(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}function Zg(e){return em(e,Ql(e))}function Jg(e,t,n,r,s,i,o){var a=Ni(e,n),l=Ni(t,n),c=o.get(l);if(c){yi(e,n,c);return}var u=i?i(a,l,n+"",e,t,o):void 0,h=u===void 0;if(h){var d=zn(l),f=!d&&ql(l),g=!d&&!f&&Jl(l);u=l,d||f||g?zn(a)?u=a:qg(a)?u=jf(a):f?(h=!1,u=$g(l)):g?(h=!1,u=jg(l)):u=[]:Lg(l)||Ti(l)?(u=a,Ti(a)?u=Zg(a):(!It(a)||ao(a))&&(u=Wg(l))):h=!1}h&&(o.set(l,u),s(u,l,r,i,o),o.delete(l)),yi(e,n,u)}function mo(e,t,n,r,s){e!==t&&Gg(t,function(i,o){if(s||(s=new Zn),It(i))Jg(e,t,o,n,mo,r,s);else{var a=r?r(Ni(e,o),i,o+"",e,t,s):void 0;a===void 0&&(a=i),yi(e,o,a)}},Ql)}var Qg=Vl(function(e,t,n,r){mo(e,t,n,r)}),Hs=Vl(function(e,t,n){mo(e,t,n)});function e_(e,t,n,r){if(!It(e))return e;t=tc(t,e);for(var s=-1,i=t.length,o=i-1,a=e;a!=null&&++s<i;){var l=nc(t[s]),c=n;if(l==="__proto__"||l==="constructor"||l==="prototype")return e;if(s!=o){var u=a[l];c=void 0,c===void 0&&(c=It(u)?u:co(t[s+1])?[]:{})}Yl(a,l,c),a=a[l]}return e}function t_(e,t,n){return e==null?e:e_(e,t,n)}class vn{constructor(){p(this,"cursor",0)}reset(){return this.cursor=0,this}moveCursor(t){this.cursor+=t}moveCursorTo(t){this.cursor=t}}function n_(e,t){for(const n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}function ac(e){return/^-?\d+(\.\d+)?$/.test(e)}function r_(e){return ac(e)?Number(e)<=Number.MAX_SAFE_INTEGER:!1}function s_(e){return Number(e)>Number.MAX_SAFE_INTEGER||e.length>=18}class go{constructor(){p(this,"_data",[])}static create(){return new go}add(t){this._data.indexOf(t)>-1||this._data.push(t)}delete(t){const n=this._data.indexOf(t);this._data.splice(n,1)}getData(){return this._data}}class _o{constructor(){p(this,"_data",new Map)}static create(){return new _o}add(t,n){this._data.has(t)||this._data.set(t,n)}delete(t){this._data.delete(t)}getData(){return this._data}}function i_(e){const t=new MessageChannel;let n=!1;const r=()=>{n||e()};return t.port1.onmessage=r,t.port2.postMessage(null),()=>{n=!0,t.port1.onmessage=null,t.port1.close(),t.port2.close()}}async function lc(e){for(const[t,n]of e.entries())try{if(!await n())return{index:t,result:!1}}catch(r){return{index:t,result:!1,error:r}}return{result:!0,index:-1}}function cc(e){for(const[t,n]of e.entries())try{if(!n())return{index:t,result:!1}}catch(r){return{index:t,result:!1,error:r}}return{result:!0,index:-1}}function o_(e,t){return t.forEach(n=>e.add(n)),e}function a_(e){return e instanceof ce.Subscription||e instanceof ce.Subject||e&&"closed"in e&&typeof e.unsubscribe<"u"}function We(e){let t=!1;return e?a_(e)?{dispose:()=>e.unsubscribe()}:typeof e=="function"?{dispose:()=>{t||(t=!0,e())}}:e:We(()=>{})}function l_(e){return We(()=>{e.unsubscribe()})}class js{constructor(){p(this,"_disposables",new Set)}add(t){const n=We(t);return this._disposables.add(n),{dispose:(r=!1)=>{r||n.dispose(),this._disposables.delete(n)}}}dispose(){this._disposables.forEach(t=>{t.dispose()}),this._disposables.clear()}}class Ke{constructor(){p(this,"_disposed",!1);p(this,"_collection",new js)}disposeWithMe(t){return this._collection.add(t)}ensureNotDisposed(){if(this._disposed)throw new Error("[Disposable]: object is disposed!")}dispose(){this._disposed||(this._disposed=!0,this._collection.dispose())}}class c_ extends Ke{constructor(){super(...arguments);p(this,"dispose$",new ce.Subject)}dispose(){super.dispose(),this.dispose$.next(),this.dispose$.complete()}}class u_ extends Ke{constructor(n){super();p(this,"_ref",0);this._rootDisposable=n}inc(){if(this._disposed)throw new Error("[RCDisposable]: should not ref to a disposed.");this._ref+=1}dec(){this._ref-=1,this._ref===0&&(this._rootDisposable.dispose(),this.dispose())}}var Oe=(e=>(e[e.UNIVER_UNKNOWN=0]="UNIVER_UNKNOWN",e[e.UNIVER_DOC=1]="UNIVER_DOC",e[e.UNIVER_SHEET=2]="UNIVER_SHEET",e[e.UNIVER_SLIDE=3]="UNIVER_SLIDE",e[e.UNIVER_PROJECT=4]="UNIVER_PROJECT",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED",e))(Oe||{}),Ut=(e=>(e[e.Reader=0]="Reader",e[e.Editor=1]="Editor",e[e.Owner=2]="Owner",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED",e))(Ut||{}),Mi=(e=>(e[e.SomeCollaborator=0]="SomeCollaborator",e[e.AllCollaborator=1]="AllCollaborator",e[e.OneSelf=2]="OneSelf",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED",e))(Mi||{});class Ws extends Ke{}const h_="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let d_=e=>crypto.getRandomValues(new Uint8Array(e)),f_=(e,t,n)=>{let r=(2<<Math.log2(e.length-1))-1,s=-~(1.6*r*t/e.length);return(i=t)=>{let o="";for(;;){let a=n(s),l=s|0;for(;l--;)if(o+=e[a[l]&r]||"",o.length>=i)return o}}},m_=(e,t=21)=>f_(e,t|0,d_),g_=(e=21)=>{let t="",n=crypto.getRandomValues(new Uint8Array(e|=0));for(;e--;)t+=h_[n[e]&63];return t};const uc=new Set(["ac","ad","ae","aero","af","ag","ai","al","am","ao","aq","ar","arpa","as","asia","at","au","aw","ax","az","ba","bb","bd","be","bf","bg","bh","bi","biz","bj","bm","bn","bo","br","bs","bt","bv","bw","by","bz","ca","cat","cc","cd","cf","cg","ch","ci","ck","cl","cm","cn","co","com","coop","cr","cu","cv","cw","cx","cy","cz","de","dj","dk","dm","do","dz","ec","edu","ee","eg","er","es","et","eu","fi","fj","fk","fm","fo","fr","ga","gb","gd","ge","gf","gg","gh","gi","gl","gm","gn","gov","gp","gq","gr","gs","gt","gu","gw","gy","hk","hm","hn","hr","ht","hu","id","ie","il","im","in","info","int","io","iq","ir","is","it","je","jm","jo","jobs","jp","ke","kg","kh","ki","km","kn","kp","kr","kw","ky","kz","la","lb","lc","li","lk","lr","ls","lt","lu","lv","ly","ma","mc","md","me","mg","mh","mil","mk","ml","mm","mn","mo","mobi","mp","mq","mr","ms","mt","mu","museum","mv","mw","mx","my","mz","na","name","nc","ne","net","nf","ng","ni","nl","no","np","nr","nu","nz","om","onion","org","pa","pe","pf","pg","ph","pk","pl","pm","pn","post","pr","pro","ps","pt","pw","py","qa","re","ro","rs","ru","rw","sa","sb","sc","sd","se","sg","sh","si","sj","sk","sl","sm","sn","so","sr","ss","st","su","sv","sx","sy","sz","tc","td","tel","tf","tg","th","tj","tk","tl","tm","tn","to","tr","tt","tv","tw","tz","ua","ug","uk","us","uy","uz","va","vc","ve","vg","vi","vn","vu","wf","ws","yt","za","zm","zw"]),__=new RegExp("^(?:(?:(?:https?|ftp):)?\\/\\/)?(?:\\S+(?::\\S*)?@)?(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z0-9\\u00a1-\\uffff][a-z0-9\\u00a1-\\uffff_-]{0,62})?[a-z0-9\\u00a1-\\uffff]\\.)+(?:[a-z\\u00a1-\\uffff]{2,}\\.?))(?::\\d{2,5})?(?:[/?#]\\S*)?$","i");function p_(e){if(!Number.isNaN(+e))return!1;if(e.startsWith("http://localhost:3002")||e.startsWith("localhost:3002"))return!0;if(__.test(e)){if(hc(e))return!0;try{const r=new URL(dc(e)).hostname.split(".").pop();if(r&&uc.has(r))return!0}catch{return!1}}return!1}function hc(e){return/^[a-zA-Z]+:\/\//.test(e)}function E_(e){return/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/.test(e)}function dc(e){return hc(e)?e:E_(e)?`mailto://${e}`:`https://${e}`}const qt=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function po(e,t){const n=Z.getValueType(e),r=Z.getValueType(t);return n!==r?!1:Z.isArray(e)?C_(e,t):Z.isObject(e)?R_(e,t):Z.isDate(e)?e.getTime()===t.getTime():Z.isRegExp(e)?e.toString()===t.toString():e===t}function C_(e,t){if(e.length!==t.length)return!1;for(let n=0,r=e.length;n<r;n++){const s=e[n],i=t[n];if(!po(s,i))return!1}return!0}function R_(e,t){const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(const s of n){if(!r.includes(s))return!1;const i=e[s],o=t[s];if(!po(i,o))return!1}return!0}class Z{static deleteNull(t){for(const n in t)(t[n]===null||t[n]===void 0)&&delete t[n];return t}static stringAt(t){let n="",r=t;for(;r>=qt.length;)r/=qt.length,r-=1,n+=qt[r%qt.length];const s=t%qt.length;return n+=qt[s],n}static indexAt(t){let n=0;for(let r=0;r<t.length-1;r+=1){const s=t.charCodeAt(r)-65,i=t.length-1-r;n+=qt.length**i+qt.length*s}return n+=t.charCodeAt(t.length-1)-65,n}static deleteBlank(t){return Z.isString(t)?t.replace(/\s/g,""):t}static getSystemType(){const t=navigator.userAgent,n=navigator.platform==="Win32"||navigator.platform==="Windows",r=navigator.platform==="Mac68K"||navigator.platform==="MacPPC"||navigator.platform==="Macintosh"||navigator.platform==="MacIntel";if(r)return"Mac";if(navigator.platform==="X11"&&!n&&!r)return"Unix";if(String(navigator.platform).indexOf("Linux")>-1)return"Linux";if(n){if(t.indexOf("Windows NT 5.0")>-1||t.indexOf("Windows 2000")>-1)return"Windows 2000";if(t.indexOf("Windows NT 5.1")>-1||t.indexOf("Windows XP")>-1)return"Windows XP";if(t.indexOf("Windows NT 5.2")>-1||t.indexOf("Windows 2003")>-1)return"Windows 2003";if(t.indexOf("Windows NT 6.0")>-1||t.indexOf("Windows Vista")>-1)return"Windows Vista";if(t.indexOf("Windows NT 6.1")>-1||t.indexOf("Windows 7")>-1)return"Windows 7";if(t.indexOf("Windows NT 10")>-1||t.indexOf("Windows 10")>-1)return"Windows 10";if(t.indexOf("Windows NT 11")>-1||t.indexOf("Windows 11")>-1)return"Windows 11"}return"Unknown system"}static getBrowserType(){const t=navigator.userAgent,n=t.indexOf("Opera")>-1,r=t.indexOf("compatible")>-1&&t.indexOf("MSIE")>-1&&!n,s=t.indexOf("Trident")>-1&&t.indexOf("rv:11.0")>-1,i=t.indexOf("Edge")>-1,o=t.indexOf("Firefox")>-1,a=t.indexOf("Safari")>-1&&t.indexOf("Chrome")===-1,l=t.indexOf("Chrome")>-1&&t.indexOf("Safari")>-1;if(r){new RegExp("MSIE (\\d+\\.\\d+);").test(t);const u=Number.parseFloat(RegExp.$1);return u===7?"IE7":u===8?"IE8":u===9?"IE9":u===10?"IE10":"0"}return o?"FF":n?"Opera":a?"Safari":l?"Chrome":i?"Edge":s?"IE11":"Unknown browser"}static getClassName(t){return t.constructor.name}static deepMerge(t,...n){n.forEach(o=>o&&i(o));function r(o,a){o.forEach((l,c)=>{var u,h;if(Z.isArray(l)){const d=(u=a[c])!=null?u:[];a[c]=d,r(l,d);return}if(Z.isObject(l)){const d=(h=a[c])!=null?h:{};a[c]=d,s(l,d);return}a[c]=l})}function s(o,a){Object.keys(o).forEach(l=>{var u,h;const c=o[l];if(Z.isObject(c)){const d=(u=a[l])!=null?u:{};a[l]=d,s(c,d);return}if(Z.isArray(c)){const d=(h=a[l])!=null?h:[];a[l]=d,r(c,d);return}a[l]=c})}function i(o){Object.keys(o).forEach(a=>{var c,u;const l=o[a];if(Z.isArray(l)){const h=(c=t[a])!=null?c:[];t[a]=h,r(l,h);return}if(Z.isObject(l)){const h=(u=t[a])!=null?u:{};t[a]=h,s(l,h);return}t[a]=l})}return t}static numberFixed(t,n){return Number(Number(t).toFixed(n))}static diffValue(t,n){return po(t,n)}static deepClone(t){if(!this.isDefine(t))return t;if(this.isRegExp(t))return new RegExp(t);if(this.isDate(t))return new Date(t);if(this.isArray(t)){const n=[];return t.forEach((r,s)=>{n[s]=Z.deepClone(r)}),n}if(this.isObject(t)){const n={};return Object.keys(t).forEach(r=>{const s=t[r];n[r]=Z.deepClone(s)}),Object.setPrototypeOf(n,Object.getPrototypeOf(t)),n}return t}static getLanguage(){const t="en-US";return globalThis.navigator&&(navigator.languages&&navigator.languages[0]||navigator.language)||t}static getValueType(t){return Object.prototype.toString.apply(t)}static isDefine(t){return t!=null}static isBlank(t){return this.isDefine(t)?this.isString(t)?t.trim()==="":!1:!0}static isPlainObject(t){return this.isDefine(t)?Object.getPrototypeOf(t)===Object.getPrototypeOf({}):!1}static isDate(t){return this.getValueType(t)==="[object Date]"}static isRegExp(t){return this.getValueType(t)==="[object RegExp]"}static isArray(t){return this.getValueType(t)==="[object Array]"}static isString(t){return this.getValueType(t)==="[object String]"}static isNumber(t){return this.getValueType(t)==="[object Number]"}static isStringNumber(t){return!isNaN(Number.parseFloat(t))&&isFinite(t)}static isObject(t){return this.getValueType(t)==="[object Object]"}static isEmptyObject(t){for(const n in t)return!1;return!0}static isTablet(){return/ipad|android|android 3.0|xoom|sch-i800|playbook|tablet|kindle/i.test(navigator.userAgent.toLowerCase())}static isIPhone(){return/iPhone/i.test(navigator.userAgent)}static isLegalUrl(t){return p_(t)}static normalizeUrl(t){return dc(t)}static topLevelDomainCombiningString(){return[...uc].join("|")}static removeNull(t){return this.isObject(t)&&Object.keys(t).forEach(n=>{const r=t[n];r==null?delete t[n]:Z.removeNull(r)}),t}static fillTwoDimensionalArray(t,n,r){return new Array(t).fill(r).map(s=>new Array(n).fill(r))}static numToWord(t){let n="";for(;t>0;){let r=t%26;r=r===0?r=26:r,n=String.fromCharCode(96+r)+n,t=(t-r)/26}return n.toLocaleUpperCase()}static ABCatNum(t){if(t==null||t.length===0)return Number.NaN;const n=t.toLowerCase().split(""),r=n.length;let s=0,i=0;for(let o=0;o<r;o++)i=n[o].charCodeAt(0)-96,s+=i*26**(r-o-1);return s===0?Number.NaN:s-1}static chatAtABC(t){let i="";for(;t>=0;)i=String.fromCharCode(t%26+97)+i,t=Math.floor(t/26)-1;return i.toUpperCase()}static commonExtend(t,n){const r={};for(const s in t)r[s]=t[s];for(const s in n)n[s]!=null&&(r[s]=n[s]);return r}static hasIntersectionBetweenTwoRanges(t,n,r,s){return n>=r&&s>=t}static isStartValidPosition(t){return/^[A-Za-zА-Яа-яЁё_]/.test(t)}static isValidParameter(t){const n=/[~!@#$%^&*()+=\-{}\[\]\|:;"'<>,?\/ ]+/.test(t),r=t.length<=255;return!n&&r}static clamp(t,n,r){return Math.max(n,Math.min(r,t))}static now(){return performance&&performance.now?performance.now():Date.now()}}function tt(e=21,t){return t?m_(t,e)():g_(e)}function ar(...e){const t={},n=e.length;for(let r=n-1;r>=0;r--){const s=e[r];if(s){const i=Object.keys(s);for(const o of i)t[o]===void 0&&(t[o]=s[o])}}return t}const I_=()=>typeof process<"u"&&process.versions!=null&&process.versions.node!=null;function S_(e){const n=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/\\\*/g,".*").replace(/\\\?/g,".");return new RegExp(`^${n}$`,"i")}var fc=(e=>(e[e.DEFAULT_SERIES=0]="DEFAULT_SERIES",e[e.ALTERNATE_SERIES=1]="ALTERNATE_SERIES",e))(fc||{}),De=(e=>(e[e.NONE=0]="NONE",e[e.THIN=1]="THIN",e[e.HAIR=2]="HAIR",e[e.DOTTED=3]="DOTTED",e[e.DASHED=4]="DASHED",e[e.DASH_DOT=5]="DASH_DOT",e[e.DASH_DOT_DOT=6]="DASH_DOT_DOT",e[e.DOUBLE=7]="DOUBLE",e[e.MEDIUM=8]="MEDIUM",e[e.MEDIUM_DASHED=9]="MEDIUM_DASHED",e[e.MEDIUM_DASH_DOT=10]="MEDIUM_DASH_DOT",e[e.MEDIUM_DASH_DOT_DOT=11]="MEDIUM_DASH_DOT_DOT",e[e.SLANT_DASH_DOT=12]="SLANT_DASH_DOT",e[e.THICK=13]="THICK",e))(De||{}),mc=(e=>(e.TOP="top",e.BOTTOM="bottom",e.LEFT="left",e.RIGHT="right",e.NONE="none",e.ALL="all",e.OUTSIDE="outside",e.INSIDE="inside",e.HORIZONTAL="horizontal",e.VERTICAL="vertical",e.TLBR="tlbr",e.TLBC_TLMR="tlbc_tlmr",e.TLBR_TLBC_TLMR="tlbr_tlbc_tlmr",e.BLTR="bl_tr",e.MLTR_BCTR="mltr_bctr",e))(mc||{}),Et=(e=>(e[e.UNSUPPORTED=0]="UNSUPPORTED",e[e.RGB=1]="RGB",e[e.HEX=2]="HEX",e[e.THEME=3]="THEME",e))(Et||{}),gc=(e=>(e[e.ON=0]="ON",e[e.OFF=1]="OFF",e))(gc||{}),_c=(e=>(e[e.PASTE_NORMAL=0]="PASTE_NORMAL",e[e.PASTE_NO_BORDERS=1]="PASTE_NO_BORDERS",e[e.PASTE_FORMAT=2]="PASTE_FORMAT",e[e.PASTE_FORMULA=3]="PASTE_FORMULA",e[e.PASTE_DATA_VALIDATION=4]="PASTE_DATA_VALIDATION",e[e.PASTE_VALUES=5]="PASTE_VALUES",e[e.PASTE_CONDITIONAL_FORMATTING=6]="PASTE_CONDITIONAL_FORMATTING",e[e.PASTE_COLUMN_WIDTHS=7]="PASTE_COLUMN_WIDTHS",e))(_c||{}),pc=(e=>(e[e.LEFT=0]="LEFT",e[e.RIGHT=1]="RIGHT",e))(pc||{}),Ec=(e=>(e[e.DOCUMENT=0]="DOCUMENT",e[e.PROJECT=1]="PROJECT",e))(Ec||{}),Cc=(e=>(e[e.COLUMNS=0]="COLUMNS",e[e.ROWS=1]="ROWS",e))(Cc||{}),Rc=(e=>(e[e.UP=0]="UP",e[e.RIGHT=1]="RIGHT",e[e.DOWN=2]="DOWN",e[e.LEFT=3]="LEFT",e))(Rc||{});function O_(e){switch(e){case 3:return 1;case 1:return 3;case 0:return 2;case 2:return 0}}var Ic=(e=>(e[e.INTERPOLATION_POINT_TYPE_UNSPECIFIED=0]="INTERPOLATION_POINT_TYPE_UNSPECIFIED",e[e.MIN=1]="MIN",e[e.MAX=2]="MAX",e[e.NUMBER=3]="NUMBER",e[e.PERCENT=4]="PERCENT",e[e.PERCENTILE=5]="PERCENTILE",e))(Ic||{}),Fr=(e=>(e.EN_US="enUS",e.FR_FR="frFR",e.ZH_CN="zhCN",e.RU_RU="ruRU",e.ZH_TW="zhTW",e.VI_VN="viVN",e.FA_IR="faIR",e.KO_KR="koKR",e.ES_ES="esES",e.CA_ES="caES",e))(Fr||{}),ws=(e=>(e[e.PERSON=0]="PERSON",e[e.FILE=1]="FILE",e[e.DATE=2]="DATE",e[e.LOCATION=3]="LOCATION",e[e.EVENT=4]="EVENT",e))(ws||{}),Sc=(e=>(e[e.RANGE=0]="RANGE",e[e.SHEET=1]="SHEET",e))(Sc||{}),Oc=(e=>(e.Line="line",e.LineInv="lineInv",e.Triangle="triangle",e.RtTriangle="rtTriangle",e.Rect="rect",e.Diamond="diamond",e.Parallelogram="parallelogram",e.Trapezoid="trapezoid",e.NonIsocelesTrapezoid="nonIsocelesTrapezoid",e.Pentagon="pentagon",e.Hexagon="hexagon",e.Heptagon="heptagon",e.Octagon="octagon",e.Decagon="decagon",e.Dodecagon="dodecagon",e.Star4="star4",e.Star5="star5",e.Star6="star6",e.Star7="star7",e.Star8="star8",e.Star10="star10",e.Star12="star12",e.Star16="star16",e.Star24="star24",e.Star32="star32",e.RoundRect="roundRect",e.Round1Rect="round1Rect",e.Round2SameRect="round2SameRect",e.Round2DiagRect="round2DiagRect",e.Ellipse="ellipse",e))(Oc||{}),vc=(e=>(e.RightArrow="rightArrow",e.LeftArrow="leftArrow",e.UpArrow="upArrow",e.DownArrow="downArrow",e.LeftRightArrow="leftRightArrow",e.UpDownArrow="upDownArrow",e.QuadArrow="quadArrow",e.LeftRightUpArrow="leftRightUpArrow",e.BentArrow="bentArrow",e.UturnArrow="uturnArrow",e.CircularArrow="circularArrow",e.NotchedRightArrow="notchedRightArrow",e.HomePlate="homePlate",e.Chevron="chevron",e.LeftCircularArrow="leftCircularArrow",e.LeftRightCircularArrow="leftRightCircularArrow",e))(vc||{}),wc=(e=>(e.Plaque="plaque",e.Can="can",e.Cube="cube",e.Bevel="bevel",e.Donut="donut",e.NoSmoking="noSmoking",e.BlockArc="blockArc",e.FoldedCorner="foldedCorner",e))(wc||{}),bc=(e=>(e.SmileyFace="smileyFace",e.Heart="heart",e.LightningBolt="lightningBolt",e.Sun="sun",e.Moon="moon",e.Cloud="cloud",e.Arc="arc",e.Backpack="backpack",e.Frame="frame",e.HalfFrame="halfFrame",e.Corner="corner",e.Chord="chord",e.Pie="pie",e.Teardrop="teardrop",e.WedgeRectCallout="wedgeRectCallout",e.WedgeRRectCallout="wedgeRRectCallout",e.WedgeEllipseCallout="wedgeEllipseCallout",e.CloudCallout="cloudCallout",e.BorderCallout1="borderCallout1",e.BorderCallout2="borderCallout2",e.BorderCallout3="borderCallout3",e.AccentCallout1="accentCallout1",e.AccentCallout2="accentCallout2",e.AccentCallout3="accentCallout3",e.Callout1="callout1",e.Callout2="callout2",e.Callout3="callout3",e.ActionButtonBackPrevious="actionButtonBackPrevious",e.ActionButtonEnd="actionButtonEnd",e.ActionButtonForwardNext="actionButtonForwardNext",e.ActionButtonHelp="actionButtonHelp",e.ActionButtonHome="actionButtonHome",e.ActionButtonInformation="actionButtonInformation",e.ActionButtonMovie="actionButtonMovie",e.ActionButtonReturn="actionButtonReturn",e.ActionButtonSound="actionButtonSound",e))(bc||{}),Ac=(e=>(e[e.RELATIVE_DATE_UNSPECIFIED=0]="RELATIVE_DATE_UNSPECIFIED",e[e.PAST_YEAR=1]="PAST_YEAR",e[e.PAST_MONTH=2]="PAST_MONTH",e[e.PAST_WEEK=3]="PAST_WEEK",e[e.YESTERDAY=4]="YESTERDAY",e[e.TODAY=5]="TODAY",e[e.TOMORROW=6]="TOMORROW",e))(Ac||{}),Tc=(e=>(e[e.GRID=0]="GRID",e[e.KANBAN=1]="KANBAN",e[e.GANTT=2]="GANTT",e))(Tc||{}),Tr=(e=>(e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.LEFT_TO_RIGHT=1]="LEFT_TO_RIGHT",e[e.RIGHT_TO_LEFT=2]="RIGHT_TO_LEFT",e))(Tr||{}),yc=(e=>(e[e.DASH=0]="DASH",e[e.DASH_DOT_DOT_HEAVY=1]="DASH_DOT_DOT_HEAVY",e[e.DASH_DOT_HEAVY=2]="DASH_DOT_HEAVY",e[e.DASHED_HEAVY=3]="DASHED_HEAVY",e[e.DASH_LONG=4]="DASH_LONG",e[e.DASH_LONG_HEAVY=5]="DASH_LONG_HEAVY",e[e.DOT_DASH=6]="DOT_DASH",e[e.DOT_DOT_DASH=7]="DOT_DOT_DASH",e[e.DOTTED=8]="DOTTED",e[e.DOTTED_HEAVY=9]="DOTTED_HEAVY",e[e.DOUBLE=10]="DOUBLE",e[e.NONE=11]="NONE",e[e.SINGLE=12]="SINGLE",e[e.THICK=13]="THICK",e[e.WAVE=14]="WAVE",e[e.WAVY_DOUBLE=15]="WAVY_DOUBLE",e[e.WAVY_HEAVY=16]="WAVY_HEAVY",e[e.WORDS=17]="WORDS",e))(yc||{}),Tt=(e=>(e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.LEFT=1]="LEFT",e[e.CENTER=2]="CENTER",e[e.RIGHT=3]="RIGHT",e[e.JUSTIFIED=4]="JUSTIFIED",e[e.BOTH=5]="BOTH",e[e.DISTRIBUTED=6]="DISTRIBUTED",e))(Tt||{}),_n=(e=>(e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.TOP=1]="TOP",e[e.MIDDLE=2]="MIDDLE",e[e.BOTTOM=3]="BOTTOM",e))(_n||{}),In=(e=>(e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.OVERFLOW=1]="OVERFLOW",e[e.CLIP=2]="CLIP",e[e.WRAP=3]="WRAP",e))(In||{}),bs=(e=>(e[e.NORMAL=0]="NORMAL",e[e.ITALIC=1]="ITALIC",e))(bs||{}),As=(e=>(e[e.NORMAL=0]="NORMAL",e[e.BOLD=1]="BOLD",e))(As||{}),Yt=(e=>(e[e.NORMAL=1]="NORMAL",e[e.SUBSCRIPT=2]="SUBSCRIPT",e[e.SUPERSCRIPT=3]="SUPERSCRIPT",e))(Yt||{}),ie=(e=>(e[e.FALSE=0]="FALSE",e[e.TRUE=1]="TRUE",e))(ie||{}),en=(e=>(e[e.STRING=1]="STRING",e[e.NUMBER=2]="NUMBER",e[e.BOOLEAN=3]="BOOLEAN",e[e.FORCE_STRING=4]="FORCE_STRING",e))(en||{}),it=(e=>(e[e.DARK1=0]="DARK1",e[e.LIGHT1=1]="LIGHT1",e[e.DARK2=2]="DARK2",e[e.LIGHT2=3]="LIGHT2",e[e.ACCENT1=4]="ACCENT1",e[e.ACCENT2=5]="ACCENT2",e[e.ACCENT3=6]="ACCENT3",e[e.ACCENT4=7]="ACCENT4",e[e.ACCENT5=8]="ACCENT5",e[e.ACCENT6=9]="ACCENT6",e[e.HYPERLINK=10]="HYPERLINK",e[e.FOLLOWED_HYPERLINK=11]="FOLLOWED_HYPERLINK",e))(it||{}),Ys=(e=>(e.OFFICE="Office",e.OFFICE_2007_2010="Office 2007-2010",e.GRAYSCALE="Grayscale",e.BLUE_WARM="Blue Warm",e.BLUE="Blue",e.BLUE_II="Blue II",e.BLUE_GREEN="Blue Green",e.GREEN="Green",e.GREEN_YELLOW="Green Yellow",e.YELLOW="Yellow",e.YELLOW_ORANGE="Yellow Orange",e.ORANGE="Orange",e.ORANGE_RED="Orange Red",e.RED_ORANGE="Red Orange",e.RED="Red",e.RED_VIOLET="Red Violet",e.VIOLET="Violet",e.VIOLET_II="Violet II",e.MEDIAN="Median",e.PAPER="Paper",e.MARQUEE="Marquee",e.SLIPSTREAM="Slipstream",e.Aspect="Aspect",e))(Ys||{}),Nc=(e=>(e[e.character=0]="character",e[e.paragraph=1]="paragraph",e[e.table=2]="table",e[e.numbering=3]="numbering",e))(Nc||{}),Mc=(e=>(e[e.TAB=0]="TAB",e[e.SPACE=1]="SPACE",e[e.NOTHING=2]="NOTHING",e))(Mc||{}),fe=(e=>(e[e.BULLET=0]="BULLET",e[e.NONE=1]="NONE",e[e.DECIMAL=2]="DECIMAL",e[e.DECIMAL_ZERO=3]="DECIMAL_ZERO",e[e.UPPER_LETTER=4]="UPPER_LETTER",e[e.LOWER_LETTER=5]="LOWER_LETTER",e[e.UPPER_ROMAN=6]="UPPER_ROMAN",e[e.LOWER_ROMAN=7]="LOWER_ROMAN",e[e.ORDINAL=8]="ORDINAL",e[e.CARDINAL_TEXT=9]="CARDINAL_TEXT",e[e.ORDINAL_TEXT=10]="ORDINAL_TEXT",e[e.HEX=11]="HEX",e[e.CHICAGO=12]="CHICAGO",e[e.IDEOGRAPH_DIGITAL=13]="IDEOGRAPH_DIGITAL",e[e.JAPANESE_COUNTING=14]="JAPANESE_COUNTING",e[e.AIUEO=15]="AIUEO",e[e.IROHA=16]="IROHA",e[e.DECIMAL_FULL_WIDTH=17]="DECIMAL_FULL_WIDTH",e[e.DECIMAL_HALF_WIDTH=18]="DECIMAL_HALF_WIDTH",e[e.JAPANESE_LEGAL=19]="JAPANESE_LEGAL",e[e.JAPANESE_DIGITAL_TEN_THOUSAND=20]="JAPANESE_DIGITAL_TEN_THOUSAND",e[e.DECIMAL_ENCLOSED_CIRCLE=21]="DECIMAL_ENCLOSED_CIRCLE",e[e.DECIMAL_FULL_WIDTH2=22]="DECIMAL_FULL_WIDTH2",e[e.AIUEO_FULL_WIDTH=23]="AIUEO_FULL_WIDTH",e[e.IROHA_FULL_WIDTH=24]="IROHA_FULL_WIDTH",e[e.GANADA=25]="GANADA",e[e.CHOSUNG=26]="CHOSUNG",e[e.DECIMAL_ENCLOSED_FULLSTOP=27]="DECIMAL_ENCLOSED_FULLSTOP",e[e.DECIMAL_ENCLOSED_PAREN=28]="DECIMAL_ENCLOSED_PAREN",e[e.DECIMAL_ENCLOSED_CIRCLE_CHINESE=29]="DECIMAL_ENCLOSED_CIRCLE_CHINESE",e[e.IDEOGRAPH_ENCLOSED_CIRCLE=30]="IDEOGRAPH_ENCLOSED_CIRCLE",e[e.IDEOGRAPH_TRADITIONAL=31]="IDEOGRAPH_TRADITIONAL",e[e.IDEOGRAPH_ZODIAC=32]="IDEOGRAPH_ZODIAC",e[e.IDEOGRAPH_ZODIAC_TRADITIONAL=33]="IDEOGRAPH_ZODIAC_TRADITIONAL",e[e.TAIWANESE_COUNTING=34]="TAIWANESE_COUNTING",e[e.IDEOGRAPH_LEGAL_TRADITIONAL=35]="IDEOGRAPH_LEGAL_TRADITIONAL",e[e.TAIWANESE_COUNTING_THOUSAND=36]="TAIWANESE_COUNTING_THOUSAND",e[e.TAIWANESE_DIGITAL=37]="TAIWANESE_DIGITAL",e[e.CHINESE_COUNTING=38]="CHINESE_COUNTING",e[e.CHINESE_LEGAL_SIMPLIFIED=39]="CHINESE_LEGAL_SIMPLIFIED",e[e.CHINESE_COUNTING_THOUSAND=40]="CHINESE_COUNTING_THOUSAND",e[e.KOREAN_DIGITAL=41]="KOREAN_DIGITAL",e[e.KOREAN_COUNTING=42]="KOREAN_COUNTING",e[e.KOREAN_LEGAL=43]="KOREAN_LEGAL",e[e.KOREAN_DIGITAL2=44]="KOREAN_DIGITAL2",e[e.VIETNAMESE_COUNTING=45]="VIETNAMESE_COUNTING",e[e.RUSSIAN_LOWER=46]="RUSSIAN_LOWER",e[e.RUSSIAN_UPPER=47]="RUSSIAN_UPPER",e[e.NUMBER_IN_DASH=48]="NUMBER_IN_DASH",e[e.HEBREW1=49]="HEBREW1",e[e.HEBREW2=50]="HEBREW2",e[e.ARABIC_ALPHA=51]="ARABIC_ALPHA",e[e.ARABIC_ABJAD=52]="ARABIC_ABJAD",e[e.HINDI_VOWELS=53]="HINDI_VOWELS",e[e.HINDI_CONSONANTS=54]="HINDI_CONSONANTS",e[e.HINDI_NUMBERS=55]="HINDI_NUMBERS",e[e.HINDI_COUNTING=56]="HINDI_COUNTING",e[e.THAI_LETTERS=57]="THAI_LETTERS",e[e.THAI_NUMBERS=58]="THAI_NUMBERS",e[e.THAI_COUNTING=59]="THAI_COUNTING",e[e.CUSTOM=60]="CUSTOM",e))(fe||{}),Br=(e=>(e[e.BULLET_ALIGNMENT_UNSPECIFIED=0]="BULLET_ALIGNMENT_UNSPECIFIED",e[e.START=1]="START",e[e.CENTER=2]="CENTER",e[e.END=3]="END",e[e.BOTH=4]="BOTH",e))(Br||{}),rn=(e=>(e[e.HYPERLINK=0]="HYPERLINK",e[e.FIELD=1]="FIELD",e[e.SDT=2]="SDT",e[e.BOOKMARK=3]="BOOKMARK",e[e.COMMENT=4]="COMMENT",e[e.CUSTOM=5]="CUSTOM",e[e.MENTION=6]="MENTION",e[e.UNI_FORMULA=7]="UNI_FORMULA",e[e.DELTED=9999]="DELTED",e))(rn||{}),pn=(e=>(e[e.COMMENT=0]="COMMENT",e[e.DELETED=9999]="DELETED",e))(pn||{}),Lc=(e=>(e[e.DRAWING=0]="DRAWING",e[e.CUSTOM=1]="CUSTOM",e))(Lc||{}),Eo=(e=>(e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.TRADITIONAL=1]="TRADITIONAL",e[e.MODERN=2]="MODERN",e))(Eo||{}),Dc=(e=>(e[e.DEFAULT=0]="DEFAULT",e[e.LINES=1]="LINES",e[e.LINES_AND_CHARS=2]="LINES_AND_CHARS",e[e.SNAP_TO_CHARS=3]="SNAP_TO_CHARS",e))(Dc||{}),xc=(e=>(e[e.SECTION_TYPE_UNSPECIFIED=0]="SECTION_TYPE_UNSPECIFIED",e[e.CONTINUOUS=1]="CONTINUOUS",e[e.NEXT_PAGE=2]="NEXT_PAGE",e[e.EVEN_PAGE=3]="EVEN_PAGE",e[e.ODD_PAGE=4]="ODD_PAGE",e))(xc||{}),Uc=(e=>(e[e.COLUMN_SEPARATOR_STYLE_UNSPECIFIED=0]="COLUMN_SEPARATOR_STYLE_UNSPECIFIED",e[e.NONE=1]="NONE",e[e.BETWEEN_EACH_COLUMN=2]="BETWEEN_EACH_COLUMN",e))(Uc||{}),Pc=(e=>(e[e.NORMAL=0]="NORMAL",e[e.TBRL=1]="TBRL",e[e.LRTBV=2]="LRTBV",e))(Pc||{}),kc=(e=>(e[e.TEXT_RUN=0]="TEXT_RUN",e[e.AUTO_TEXT=1]="AUTO_TEXT",e[e.PAGE_BREAK=2]="PAGE_BREAK",e[e.COLUMN_BREAK=3]="COLUMN_BREAK",e[e.FOOT_NOTE_REFERENCE=4]="FOOT_NOTE_REFERENCE",e[e.HORIZONTAL_RULE=5]="HORIZONTAL_RULE",e[e.EQUATION=6]="EQUATION",e[e.DRAWING=7]="DRAWING",e[e.PERSON=8]="PERSON",e[e.RICH_LINK=9]="RICH_LINK",e))(kc||{}),Fc=(e=>(e[e.BOTH_SIDES=0]="BOTH_SIDES",e[e.LEFT=1]="LEFT",e[e.RIGHT=2]="RIGHT",e[e.LARGEST=3]="LARGEST",e))(Fc||{}),Bc=(e=>(e[e.INLINE=0]="INLINE",e[e.WRAP_NONE=1]="WRAP_NONE",e[e.WRAP_POLYGON=2]="WRAP_POLYGON",e[e.WRAP_SQUARE=3]="WRAP_SQUARE",e[e.WRAP_THROUGH=4]="WRAP_THROUGH",e[e.WRAP_TIGHT=5]="WRAP_TIGHT",e[e.WRAP_TOP_AND_BOTTOM=6]="WRAP_TOP_AND_BOTTOM",e))(Bc||{}),Xe=(e=>(e[e.NAMED_STYLE_TYPE_UNSPECIFIED=0]="NAMED_STYLE_TYPE_UNSPECIFIED",e[e.NORMAL_TEXT=1]="NORMAL_TEXT",e[e.TITLE=2]="TITLE",e[e.SUBTITLE=3]="SUBTITLE",e[e.HEADING_1=4]="HEADING_1",e[e.HEADING_2=5]="HEADING_2",e[e.HEADING_3=6]="HEADING_3",e[e.HEADING_4=7]="HEADING_4",e[e.HEADING_5=8]="HEADING_5",e))(Xe||{}),$c=(e=>(e[e.AUTO=0]="AUTO",e[e.AT_LEAST=1]="AT_LEAST",e[e.EXACT=2]="EXACT",e))($c||{}),Hc=(e=>(e[e.DASH_STYLE_UNSPECIFIED=0]="DASH_STYLE_UNSPECIFIED",e[e.SOLID=1]="SOLID",e[e.DOT=2]="DOT",e[e.DASH=3]="DASH",e))(Hc||{}),jc=(e=>(e[e.TAB_STOP_ALIGNMENT_UNSPECIFIED=0]="TAB_STOP_ALIGNMENT_UNSPECIFIED",e[e.START=1]="START",e[e.CENTER=2]="CENTER",e[e.END=3]="END",e))(jc||{}),Wc=(e=>(e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.SPECIFIED=1]="SPECIFIED",e))(Wc||{}),Yc=(e=>(e[e.START=0]="START",e[e.CENTER=1]="CENTER",e[e.END=2]="END",e))(Yc||{}),Gc=(e=>(e[e.AUTO_FIT=0]="AUTO_FIT",e[e.FIXED=1]="FIXED",e))(Gc||{}),Vc=(e=>(e[e.NONE=0]="NONE",e[e.WRAP=1]="WRAP",e))(Vc||{}),zc=(e=>(e[e.AUTO=0]="AUTO",e[e.AT_LEAST=1]="AT_LEAST",e[e.EXACT=2]="EXACT",e))(zc||{}),Kc=(e=>(e[e.CONTENT_ALIGNMENT_UNSPECIFIED=0]="CONTENT_ALIGNMENT_UNSPECIFIED",e[e.BOTH=1]="BOTH",e[e.TOP=2]="TOP",e[e.CENTER=3]="CENTER",e[e.BOTTOM=4]="BOTTOM",e))(Kc||{}),kn=(e=>(e.NORMAL="normal",e.BOLD="bold",e.ITALIC="italic",e))(kn||{}),Xc=(e=>(e[e.PAGE=0]="PAGE",e[e.COLUMN=1]="COLUMN",e[e.CHARACTER=2]="CHARACTER",e[e.MARGIN=3]="MARGIN",e[e.INSIDE_MARGIN=4]="INSIDE_MARGIN",e[e.OUTSIDE_MARGIN=5]="OUTSIDE_MARGIN",e[e.LEFT_MARGIN=6]="LEFT_MARGIN",e[e.RIGHT_MARGIN=7]="RIGHT_MARGIN",e))(Xc||{}),qc=(e=>(e[e.PAGE=0]="PAGE",e[e.PARAGRAPH=1]="PARAGRAPH",e[e.LINE=2]="LINE",e[e.MARGIN=3]="MARGIN",e[e.TOP_MARGIN=4]="TOP_MARGIN",e[e.BOTTOM_MARGIN=5]="BOTTOM_MARGIN",e[e.INSIDE_MARGIN=6]="INSIDE_MARGIN",e[e.OUTSIDE_MARGIN=7]="OUTSIDE_MARGIN",e))(qc||{}),Zc=(e=>(e[e.POINT=0]="POINT",e[e.LINE=1]="LINE",e[e.CHARACTER=2]="CHARACTER",e[e.PIXEL=3]="PIXEL",e[e.PERCENT=4]="PERCENT",e))(Zc||{}),Jc=(e=>(e[e.CENTER=0]="CENTER",e[e.INSIDE=1]="INSIDE",e[e.LEFT=2]="LEFT",e[e.OUTSIDE=3]="OUTSIDE",e[e.RIGHT=4]="RIGHT",e[e.BOTH=5]="BOTH",e[e.DISTRIBUTE=6]="DISTRIBUTE",e))(Jc||{}),Qc=(e=>(e[e.BOTTOM=0]="BOTTOM",e[e.CENTER=1]="CENTER",e[e.INSIDE=2]="INSIDE",e[e.OUTSIDE=3]="OUTSIDE",e[e.TOP=4]="TOP",e))(Qc||{}),eu=(e=>(e[e.compressPunctuation=0]="compressPunctuation",e[e.compressPunctuationAndJapaneseKana=1]="compressPunctuationAndJapaneseKana",e[e.doNotCompress=2]="doNotCompress",e))(eu||{}),tu=(e=>(e[e.PORTRAIT=0]="PORTRAIT",e[e.LANDSCAPE=1]="LANDSCAPE",e))(tu||{}),ct=(e=>(e.Letter="Letter",e.Tabloid="Tabloid",e.Legal="Legal",e.Statement="Statement",e.Executive="Executive",e.Folio="Folio",e.A3="A3",e.A4="A4",e.A5="A5",e.B4="B4",e.B5="B5",e))(ct||{});const v_=["A3","A4","A5","B4","B5","Letter","Tabloid","Legal","Statement","Executive","Folio"];var nu=(e=>(e[e.forward=0]="forward",e[e.backward=1]="backward",e[e.front=2]="front",e[e.back=3]="back",e))(nu||{}),ru=(e=>(e[e.UNRECOGNIZED=-1]="UNRECOGNIZED",e[e.DRAWING_IMAGE=0]="DRAWING_IMAGE",e[e.DRAWING_SHAPE=1]="DRAWING_SHAPE",e[e.DRAWING_CHART=2]="DRAWING_CHART",e[e.DRAWING_TABLE=3]="DRAWING_TABLE",e[e.DRAWING_SMART_ART=4]="DRAWING_SMART_ART",e[e.DRAWING_VIDEO=5]="DRAWING_VIDEO",e[e.DRAWING_GROUP=6]="DRAWING_GROUP",e[e.DRAWING_UNIT=7]="DRAWING_UNIT",e[e.DRAWING_DOM=8]="DRAWING_DOM",e))(ru||{}),Co=(e=>(e[e.SLIDE=0]="SLIDE",e[e.MASTER=1]="MASTER",e[e.LAYOUT=2]="LAYOUT",e[e.HANDOUT_MASTER=3]="HANDOUT_MASTER",e[e.NOTES_MASTER=4]="NOTES_MASTER",e))(Co||{}),su=(e=>(e[e.SHAPE=0]="SHAPE",e[e.IMAGE=1]="IMAGE",e[e.TEXT=2]="TEXT",e[e.SPREADSHEET=3]="SPREADSHEET",e[e.DOCUMENT=4]="DOCUMENT",e[e.SLIDE=5]="SLIDE",e))(su||{}),iu=(e=>(e[e.RELATIVE_SLIDE_LINK_UNSPECIFIED=0]="RELATIVE_SLIDE_LINK_UNSPECIFIED",e[e.NEXT_SLIDE=1]="NEXT_SLIDE",e[e.PREVIOUS_SLIDE=2]="PREVIOUS_SLIDE",e[e.FIRST_SLIDE=3]="FIRST_SLIDE",e[e.LAST_SLIDE=4]="LAST_SLIDE",e))(iu||{});function w_(e=tt(6),t=Fr.EN_US,n=""){return{id:e,locale:t,title:n,tableSource:{},drawings:{},drawingsOrder:[],headers:{},footers:{},body:{dataStream:`\r
`,textRuns:[],customBlocks:[],tables:[],paragraphs:[{startIndex:0,paragraphStyle:{spaceAbove:{v:5},lineSpacing:1,spaceBelow:{v:0}}}],sectionBreaks:[{startIndex:1}]},documentStyle:{pageSize:{width:793.3333333333334,height:1122.6666666666667},documentFlavor:Eo.TRADITIONAL,marginTop:50,marginBottom:50,marginRight:50,marginLeft:50,renderConfig:{zeroWidthParagraphBreak:ie.FALSE,vertexAngle:0,centerAngle:0,background:{rgb:"#ccc"}},autoHyphenation:ie.TRUE,doNotHyphenateCaps:ie.FALSE,consecutiveHyphenLimit:2,defaultHeaderId:"",defaultFooterId:"",evenPageHeaderId:"",evenPageFooterId:"",firstPageHeaderId:"",firstPageFooterId:"",evenAndOddHeaders:ie.FALSE,useFirstPageHeaderFooter:ie.FALSE,marginHeader:30,marginFooter:30},settings:{}}}var dn={},nr={},Xr={},Da;function b_(){if(Da)return Xr;Da=1,Object.defineProperty(Xr,"__esModule",{value:!0});function e(r,s){if(Array.isArray(s))return!1;for(let i in r)if(!n(r[i],s[i]))return!1;for(let i in s)if(r[i]===void 0)return!1;return!0}function t(r,s){if(!Array.isArray(s)||r.length!==s.length)return!1;for(let i=0;i<r.length;i++)if(!n(r[i],s[i]))return!1;return!0}function n(r,s){return r===s?!0:r===null||s===null||typeof r!="object"||typeof s!="object"?!1:Array.isArray(r)?t(r,s):e(r,s)}return Xr.default=n,Xr}var qr={},xa;function A_(){if(xa)return qr;xa=1,Object.defineProperty(qr,"__esModule",{value:!0});function e(t){if(t===null)return null;if(Array.isArray(t))return t.map(e);if(typeof t=="object"){const n={};for(let r in t)n[r]=e(t[r]);return n}else return t}return qr.default=e,qr}var ci={},Ua;function ou(){return Ua||(Ua=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.eachChildOf=e.advancer=e.readCursor=e.writeCursor=e.WriteCursor=e.ReadCursor=e.isValidPathItem=void 0;function t(u,h){if(!u)throw new Error(h)}const n=u=>u!=null&&typeof u=="object"&&!Array.isArray(u),r=(u,h)=>typeof u==typeof h?u>h:typeof u=="string"&&typeof h=="number";function s(u,h){for(let d in u){const f=d;h.write(f,u[f])}}e.isValidPathItem=u=>typeof u=="number"||typeof u=="string"&&u!=="__proto__";class i{constructor(h=null){this.parents=[],this.indexes=[],this.lcIdx=-1,this.idx=-1,this.container=h}ascend(){t(this.parents.length===this.indexes.length/2),this.idx===0?this.parents.length?(this.lcIdx=this.indexes.pop(),this.container=this.parents.pop(),this.idx=this.indexes.pop()):(this.lcIdx=0,this.idx=-1):(t(this.idx>0),this.idx--,n(this.container[this.idx])&&this.idx--)}getPath(){const h=[];let d=this.container,f=this.parents.length-1,g=this.idx;for(;g>=0;)h.unshift(d[g]),g===0?(g=this.indexes[f*2],d=this.parents[f--]):g-=n(d[g-1])?2:1;return h}}class o extends i{get(){return this.container?this.container.slice(this.idx+1):null}getKey(){return t(this.container!=null,"Invalid call to getKey before cursor descended"),this.container[this.idx]}getComponent(){let h;return this.container&&this.container.length>this.idx+1&&n(h=this.container[this.idx+1])?h:null}descendFirst(){let h=this.idx+1;if(!this.container||h>=this.container.length||n(this.container[h])&&h+1>=this.container.length)return!1;n(this.container[h])&&h++;const d=this.container[h];return Array.isArray(d)?(this.indexes.push(this.idx),this.parents.push(this.container),this.indexes.push(h),this.idx=0,this.container=d):this.idx=h,!0}nextSibling(){if(t(this.parents.length===this.indexes.length/2),this.idx>0||this.parents.length===0)return!1;const h=this.indexes[this.indexes.length-1]+1,d=this.parents[this.parents.length-1];return h>=d.length?!1:(t(!isNaN(h)),this.indexes[this.indexes.length-1]=h,this.container=d[h],!0)}_init(h,d,f,g){this.container=h,this.idx=d,this.parents=f.slice(),this.indexes=g.slice()}clone(){const h=new o;return h._init(this.container,this.idx,this.parents,this.indexes),h}*[Symbol.iterator](){if(this.descendFirst()){do yield this.getKey();while(this.nextSibling());this.ascend()}}traverse(h,d){const f=this.getComponent();f&&d(f,h);for(const g of this)h&&h.descend(g),this.traverse(h,d),h&&h.ascend()}eachPick(h,d){this.traverse(h,(f,g)=>{f.p!=null&&d(f.p,g)})}eachDrop(h,d){this.traverse(h,(f,g)=>{f.d!=null&&d(f.d,g)})}}e.ReadCursor=o;class a extends i{constructor(h=null){super(h),this.pendingDescent=[],this._op=h}flushDescent(){t(this.parents.length===this.indexes.length/2),this.container===null&&(this._op=this.container=[]);for(let h=0;h<this.pendingDescent.length;h++){const d=this.pendingDescent[h];let f=this.idx+1;if(f<this.container.length&&n(this.container[f])&&f++,t(f===this.container.length||!n(this.container[f])),f===this.container.length)this.container.push(d),this.idx=f;else if(this.container[f]===d)this.idx=f;else{if(!Array.isArray(this.container[f])){const g=this.container.splice(f,this.container.length-f);this.container.push(g),this.lcIdx>-1&&(this.lcIdx=f)}for(this.indexes.push(this.idx),this.parents.push(this.container),this.lcIdx!==-1&&(t(r(d,this.container[this.lcIdx][0])),f=this.lcIdx+1,this.lcIdx=-1);f<this.container.length&&r(d,this.container[f][0]);)f++;if(this.indexes.push(f),this.idx=0,f<this.container.length&&this.container[f][0]===d)this.container=this.container[f];else{const g=[d];this.container.splice(f,0,g),this.container=g}}}this.pendingDescent.length=0}reset(){this.lcIdx=-1}getComponent(){this.flushDescent();const h=this.idx+1;if(h<this.container.length&&n(this.container[h]))return this.container[h];{const d={};return this.container.splice(h,0,d),d}}write(h,d){const f=this.getComponent();t(f[h]==null||f[h]===d,"Internal consistency error: Overwritten component. File a bug"),f[h]=d}get(){return this._op}descend(h){if(!e.isValidPathItem(h))throw Error("Invalid JSON key");this.pendingDescent.push(h)}descendPath(h){return this.pendingDescent.push(...h),this}ascend(){this.pendingDescent.length?this.pendingDescent.pop():super.ascend()}mergeTree(h,d=s){if(h===null)return;if(t(Array.isArray(h)),h===this._op)throw Error("Cannot merge into my own tree");const f=this.lcIdx,g=this.parents.length;let _=0;for(let R=0;R<h.length;R++){const b=h[R];typeof b=="string"||typeof b=="number"?(_++,this.descend(b)):Array.isArray(b)?this.mergeTree(b,d):typeof b=="object"&&d(b,this)}for(;_--;)this.ascend();this.lcIdx=this.parents.length===g?f:-1}at(h,d){this.descendPath(h),d(this);for(let f=0;f<h.length;f++)this.ascend();return this}writeAtPath(h,d,f){return this.at(h,()=>this.write(d,f)),this.reset(),this}writeMove(h,d,f=0){return this.writeAtPath(h,"p",f).writeAtPath(d,"d",f)}getPath(){const h=super.getPath();return h.push(...this.pendingDescent),h}}e.WriteCursor=a,e.writeCursor=()=>new a,e.readCursor=u=>new o(u);function l(u,h,d){let f,g;g=f=u?u.descendFirst():!1;function _(R){let b;for(;g;){const F=b=u.getKey();if(R!=null){let k=!1;if(h&&typeof F=="number"&&(b=h(F,u.getComponent()),b<0&&(b=~b,k=!0)),r(b,R))return null;if(b===R&&!k)return u}d&&typeof b=="number"&&d(b,u.getComponent()),g=u.nextSibling()}return null}return _.end=()=>{f&&u.ascend()},_}e.advancer=l;function c(u,h,d){let f,g,_,R;for(f=g=u&&u.descendFirst(),_=R=h&&h.descendFirst();f||_;){let b=f?u.getKey():null,F=_?h.getKey():null;b!==null&&F!==null&&(r(F,b)?F=null:b!==F&&(b=null)),d(b==null?F:b,b!=null?u:null,F!=null?h:null),b!=null&&f&&(f=u.nextSibling()),F!=null&&_&&(_=h.nextSibling())}g&&u.ascend(),R&&h.ascend()}e.eachChildOf=c})(ci)),ci}var ui={},Pa;function au(){return Pa||(Pa=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ConflictType=void 0,(function(t){t[t.RM_UNEXPECTED_CONTENT=1]="RM_UNEXPECTED_CONTENT",t[t.DROP_COLLISION=2]="DROP_COLLISION",t[t.BLACKHOLE=3]="BLACKHOLE"})(e.ConflictType||(e.ConflictType={}))})(ui)),ui}var At={},fn={},ka;function Ro(){return ka||(ka=1,Object.defineProperty(fn,"__esModule",{value:!0}),fn.uniToStrPos=fn.strPosToUni=void 0,fn.strPosToUni=(e,t=e.length)=>{let n=0,r=0;for(;r<t;r++){const s=e.charCodeAt(r);s>=55296&&s<=57343&&(n++,r++)}if(r!==t)throw Error("Invalid offset - splits unicode bytes");return r-n},fn.uniToStrPos=(e,t)=>{let n=0;for(;t>0;t--){const r=e.charCodeAt(n);n+=r>=55296&&r<=57343?2:1}return n}),fn}var hi={},Fa;function Li(){return Fa||(Fa=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.uniSlice=e.dlen=e.eachOp=void 0;const t=Ro(),n=S=>{if(!Array.isArray(S))throw Error("Op must be an array of components");let C=null;for(let w=0;w<S.length;w++){const T=S[w];switch(typeof T){case"object":if(typeof T.d!="number"&&typeof T.d!="string")throw Error("Delete must be number or string");if(e.dlen(T.d)<=0)throw Error("Deletes must not be empty");break;case"string":if(!(T.length>0))throw Error("Inserts cannot be empty");break;case"number":if(!(T>0))throw Error("Skip components must be >0");if(typeof C=="number")throw Error("Adjacent skip components should be combined");break}C=T}if(typeof C=="number")throw Error("Op has a trailing skip")};function r(S,C){let w=0,T=0;for(let B=0;B<S.length;B++){const $=S[B];switch(C($,w,T),typeof $){case"object":w+=e.dlen($.d);break;case"string":T+=t.strPosToUni($);break;case"number":w+=$,T+=$;break}}}e.eachOp=r;function s(S,C){const w=[],T=a(w);return r(S,(B,$,m)=>{T(C(B,$,m))}),h(w)}const i=S=>S,o=S=>s(S,i);e.dlen=S=>typeof S=="number"?S:t.strPosToUni(S);const a=S=>C=>{if(!(!C||C.d===0||C.d===""))if(S.length===0)S.push(C);else if(typeof C==typeof S[S.length-1])if(typeof C=="object"){const w=S[S.length-1];w.d=typeof w.d=="string"&&typeof C.d=="string"?w.d+C.d:e.dlen(w.d)+e.dlen(C.d)}else S[S.length-1]+=C;else S.push(C)},l=S=>typeof S=="number"?S:typeof S=="string"?t.strPosToUni(S):typeof S.d=="number"?S.d:t.strPosToUni(S.d);e.uniSlice=(S,C,w)=>{const T=t.uniToStrPos(S,C),B=w==null?1/0:t.uniToStrPos(S,w);return S.slice(T,B)};const c=(S,C,w)=>typeof S=="number"?w==null?S-C:Math.min(S,w)-C:e.uniSlice(S,C,w),u=S=>{let C=0,w=0;return{take:($,m)=>{if(C===S.length)return $===-1?null:$;const x=S[C];let O;if(typeof x=="number")return $===-1||x-w<=$?(O=x-w,++C,w=0,O):(w+=$,$);if(typeof x=="string"){if($===-1||m==="i"||t.strPosToUni(x.slice(w))<=$)return O=x.slice(w),++C,w=0,O;{const N=w+t.uniToStrPos(x.slice(w),$);return O=x.slice(w,N),w=N,O}}else{if($===-1||m==="d"||e.dlen(x.d)-w<=$)return O={d:c(x.d,w)},++C,w=0,O;{let N=c(x.d,w,w+$);return w+=$,{d:N}}}},peek:()=>S[C]}},h=S=>(S.length>0&&typeof S[S.length-1]=="number"&&S.pop(),S);function d(S,C,w){if(w!=="left"&&w!=="right")throw Error("side ("+w+") must be 'left' or 'right'");n(S),n(C);const T=[],B=a(T),{take:$,peek:m}=u(S);for(let O=0;O<C.length;O++){const N=C[O];let A,v;switch(typeof N){case"number":for(A=N;A>0;)v=$(A,"i"),B(v),typeof v!="string"&&(A-=l(v));break;case"string":w==="left"&&typeof m()=="string"&&B($(-1)),B(t.strPosToUni(N));break;case"object":for(A=e.dlen(N.d);A>0;)switch(v=$(A,"i"),typeof v){case"number":A-=v;break;case"string":B(v);break;case"object":A-=e.dlen(v.d)}break}}let x;for(;x=$(-1);)B(x);return h(T)}function f(S,C){n(S),n(C);const w=[],T=a(w),{take:B}=u(S);for(let m=0;m<C.length;m++){const x=C[m];let O,N;switch(typeof x){case"number":for(O=x;O>0;)N=B(O,"d"),T(N),typeof N!="object"&&(O-=l(N));break;case"string":T(x);break;case"object":O=e.dlen(x.d);let A=0;for(;A<O;)switch(N=B(O-A,"d"),typeof N){case"number":T({d:c(x.d,A,A+N)}),A+=N;break;case"string":A+=t.strPosToUni(N);break;case"object":T(N)}break}}let $;for(;$=B(-1);)T($);return h(w)}const g=(S,C)=>{let w=0;for(let T=0;T<C.length&&S>w;T++){const B=C[T];switch(typeof B){case"number":{w+=B;break}case"string":const $=t.strPosToUni(B);w+=$,S+=$;break;case"object":S-=Math.min(e.dlen(B.d),S-w);break}}return S},_=(S,C)=>typeof S=="number"?g(S,C):S.map(w=>g(w,C));function R(S,C,w){return s(S,(T,B)=>typeof T=="object"&&typeof T.d=="number"?{d:w.slice(C,B,B+T.d)}:T)}function b(S){return s(S,C=>{switch(typeof C){case"object":if(typeof C.d=="number")throw Error("Cannot invert text op: Deleted characters missing from operation. makeInvertible must be called first.");return C.d;case"string":return{d:C};case"number":return C}})}function F(S){return s(S,C=>typeof C=="object"&&typeof C.d=="string"?{d:t.strPosToUni(C.d)}:C)}function k(S){let C=!0;return r(S,w=>{typeof w=="object"&&typeof w.d=="number"&&(C=!1)}),C}function W(S){return{name:"text-unicode",uri:"http://sharejs.org/types/text-unicode",trim:h,normalize:o,checkOp:n,create(C=""){if(typeof C!="string")throw Error("Initial data must be a string");return S.create(C)},apply(C,w){n(w);const T=S.builder(C);for(let B=0;B<w.length;B++){const $=w[B];switch(typeof $){case"number":T.skip($);break;case"string":T.append($);break;case"object":T.del(e.dlen($.d));break}}return T.build()},transform:d,compose:f,transformPosition:g,transformSelection:_,isInvertible:k,makeInvertible(C,w){return R(C,w,S)},stripInvertible:F,invert:b,invertWithDoc(C,w){return b(R(C,w,S))},isNoop:C=>C.length===0}}e.default=W})(hi)),hi}var Zr={},Ba;function T_(){if(Ba)return Zr;Ba=1,Object.defineProperty(Zr,"__esModule",{value:!0});const e=Li(),t=Ro();function n(r,s){return{get:r,getLength(){return r().length},insert(i,o,a){const l=t.strPosToUni(r(),i);return s([l,o],a)},remove(i,o,a){const l=t.strPosToUni(r(),i);return s([l,{d:o}],a)},_onOp(i){e.eachOp(i,(o,a,l)=>{switch(typeof o){case"string":this.onInsert&&this.onInsert(l,o);break;case"object":const c=e.dlen(o.d);this.onRemove&&this.onRemove(l,c)}})},onInsert:null,onRemove:null}}return Zr.default=n,n.provides={text:!0},Zr}var $a;function y_(){return $a||($a=1,(function(e){var t=At&&At.__createBinding||(Object.create?(function(d,f,g,_){_===void 0&&(_=g),Object.defineProperty(d,_,{enumerable:!0,get:function(){return f[g]}})}):(function(d,f,g,_){_===void 0&&(_=g),d[_]=f[g]})),n=At&&At.__setModuleDefault||(Object.create?(function(d,f){Object.defineProperty(d,"default",{enumerable:!0,value:f})}):function(d,f){d.default=f}),r=At&&At.__importStar||function(d){if(d&&d.__esModule)return d;var f={};if(d!=null)for(var g in d)Object.hasOwnProperty.call(d,g)&&t(f,d,g);return n(f,d),f},s=At&&At.__importDefault||function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(e,"__esModule",{value:!0}),e.type=e.remove=e.insert=void 0;const i=Ro(),o=r(Li()),a=s(T_()),l={create(d){return d},toString(d){return d},builder(d){if(typeof d!="string")throw Error("Invalid document snapshot: "+d);const f=[];return{skip(g){let _=i.uniToStrPos(d,g);if(_>d.length)throw Error("The op is too long for this document");f.push(d.slice(0,_)),d=d.slice(_)},append(g){f.push(g)},del(g){d=d.slice(i.uniToStrPos(d,g))},build(){return f.join("")+d}}},slice:o.uniSlice},c=o.default(l),u=Object.assign(Object.assign({},c),{api:a.default});e.type=u,e.insert=(d,f)=>f.length===0?[]:d===0?[f]:[d,f],e.remove=(d,f)=>o.dlen(f)===0?[]:d===0?[{d:f}]:[d,{d:f}];var h=Li();Object.defineProperty(e,"makeType",{enumerable:!0,get:function(){return h.default}})})(At)),At}var Ha;function N_(){return Ha||(Ha=1,(function(e){var t=nr&&nr.__importDefault||function(I){return I&&I.__esModule?I:{default:I}};Object.defineProperty(e,"__esModule",{value:!0}),e.editOp=e.replaceOp=e.insertOp=e.moveOp=e.removeOp=e.type=void 0;const n=t(b_()),r=t(A_()),s=ou(),i=au();function o(I,D){if(!I)throw new Error(D)}e.type={name:"json1",uri:"http://sharejs.org/types/JSONv1",readCursor:s.readCursor,writeCursor:s.writeCursor,create:I=>I,isNoop:I=>I==null,setDebug(I){},registerSubtype:b,checkValidOp:B,normalize:$,apply:m,transformPosition:x,compose:O,tryTransform:L,transform:J,makeInvertible:v,invert:N,invertWithDoc:y,RM_UNEXPECTED_CONTENT:i.ConflictType.RM_UNEXPECTED_CONTENT,DROP_COLLISION:i.ConflictType.DROP_COLLISION,BLACKHOLE:i.ConflictType.BLACKHOLE,transformNoConflict:(I,D,Y)=>le(()=>!0,I,D,Y),typeAllowingConflictsPred:I=>Object.assign(Object.assign({},e.type),{transform:(D,Y,G)=>le(I,D,Y,G)})};const a=I=>I?I.getComponent():null;function l(I){return I&&typeof I=="object"&&!Array.isArray(I)}const c=I=>Array.isArray(I)?I.slice():I!==null&&typeof I=="object"?Object.assign({},I):I,u=I=>I&&(I.p!=null||I.r!==void 0),h=I=>I&&(I.d!=null||I.i!==void 0);function d(I,D){return o(I!=null),typeof D=="number"?(o(Array.isArray(I),"Invalid key - child is not an array"),(I=I.slice()).splice(D,1)):(o(l(I),"Invalid key - child is not an object"),delete(I=Object.assign({},I))[D]),I}function f(I,D,Y){return typeof D=="number"?(o(I!=null,"Container is missing for key"),o(Array.isArray(I),"Cannot use numerical key for object container"),o(I.length>=D,"Cannot insert into out of bounds index"),I.splice(D,0,Y)):(o(l(I),"Cannot insert into missing item"),o(I[D]===void 0,"Trying to overwrite value at key. Your op needs to remove it first"),I[D]=Y),Y}e.removeOp=(I,D=!0)=>s.writeCursor().writeAtPath(I,"r",D).get(),e.moveOp=(I,D)=>s.writeCursor().writeMove(I,D).get(),e.insertOp=(I,D)=>s.writeCursor().writeAtPath(I,"i",D).get(),e.replaceOp=(I,D,Y)=>s.writeCursor().at(I,G=>{G.write("r",D),G.write("i",Y)}).get(),e.editOp=(I,D,Y,G=!1)=>s.writeCursor().at(I,H=>C(H,D,Y,G)).get();const g=(I,D)=>I!=null&&(typeof D=="number"?Array.isArray(I):typeof I=="object"),_=(I,D)=>g(I,D)?I[D]:void 0,R={};function b(I){let D=I.type?I.type:I;D.name&&(R[D.name]=D),D.uri&&(R[D.uri]=D)}const F=I=>{const D=R[I];if(D)return D;throw Error("Missing type: "+I)};b(y_());const k=(I,D)=>I+D;b({name:"number",apply:k,compose:k,invert:I=>-I,transform:I=>I});const W=I=>I==null?null:I.et?F(I.et):I.es?R["text-unicode"]:I.ena!=null?R.number:null,S=I=>I.es?I.es:I.ena!=null?I.ena:I.e,C=(I,D,Y,G=!1)=>{const[H,j]=typeof D=="string"?[F(D),D]:[D,D.name];!G&&H.isNoop&&H.isNoop(Y)||(j==="number"?I.write("ena",Y):j==="text-unicode"?I.write("es",Y):(I.write("et",j),I.write("e",Y)))};function w(I){o(typeof I=="number"),o(I>=0),o(I===(0|I))}function T(I){typeof I=="number"?w(I):o(typeof I=="string")}function B(I){if(I===null)return;const D=new Set,Y=new Set,G=j=>{let Q=!0,ee=!1;for(let U in j){const z=j[U];if(Q=!1,o(U==="p"||U==="r"||U==="d"||U==="i"||U==="e"||U==="es"||U==="ena"||U==="et","Invalid component item '"+U+"'"),U==="p")w(z),o(!D.has(z)),D.add(z),o(j.r===void 0);else if(U==="d")w(z),o(!Y.has(z)),Y.add(z),o(j.i===void 0);else if(U==="e"||U==="es"||U==="ena"){o(!ee),ee=!0;const X=W(j);o(X,"Missing type in edit"),X.checkValidOp&&X.checkValidOp(S(j))}}o(!Q)},H=(j,Q,ee)=>{if(!Array.isArray(j))throw Error("Op must be null or a list");if(j.length===0)throw Error("Empty descent");Q||T(j[0]);let U=1,z=0,X=0;for(let ne=0;ne<j.length;ne++){const me=j[ne];if(o(me!=null),Array.isArray(me)){const pe=H(me,!1);if(z){const K=typeof X,he=typeof pe;K===he?o(X<pe,"descent keys are not in order"):o(K==="number"&&he==="string")}X=pe,z++,U=3}else typeof me=="object"?(o(U===1,`Prev not scalar - instead ${U}`),G(me),U=2):(o(U!==3),T(me),o(s.isValidPathItem(me),"Invalid path key"),U=1)}return o(z!==1,"Operation makes multiple descents. Remove some []"),o(U===2||U===3),j[0]};H(I,!0),o(D.size===Y.size,"Mismatched picks and drops in op");for(let j=0;j<D.size;j++)o(D.has(j)),o(Y.has(j))}function $(I){let D=0,Y=[];const G=s.writeCursor();return G.mergeTree(I,(H,j)=>{const Q=W(H);if(Q){const U=S(H);C(j,Q,Q.normalize?Q.normalize(U):U)}for(const U of["r","p","i","d"])if(H[U]!==void 0){const z=U==="p"||U==="d"?(ee=H[U],Y[ee]==null&&(Y[ee]=D++),Y[ee]):H[U];j.write(U,z)}var ee}),G.get()}function m(I,D){if(B(D),D===null)return I;const Y=[];return(function G(H,j){let Q=H,ee=0,U={root:H},z=0,X=U,ne="root";function me(){for(;z<ee;z++){let pe=j[z];typeof pe!="object"&&(o(g(X,ne)),X=X[ne]=c(X[ne]),ne=pe)}}for(;ee<j.length;ee++){const pe=j[ee];if(Array.isArray(pe)){const K=G(Q,pe);K!==Q&&K!==void 0&&(me(),Q=X[ne]=K)}else if(typeof pe=="object"){pe.d!=null?(me(),Q=f(X,ne,Y[pe.d])):pe.i!==void 0&&(me(),Q=f(X,ne,pe.i));const K=W(pe);if(K)me(),Q=X[ne]=K.apply(Q,S(pe));else if(pe.e!==void 0)throw Error("Subtype "+pe.et+" undefined")}else Q=_(Q,pe)}return U.root})(I=(function G(H,j){const Q=[];let ee=0;for(;ee<j.length;ee++){const ne=j[ee];if(Array.isArray(ne))break;typeof ne!="object"&&(Q.push(H),H=_(H,ne))}for(let ne=j.length-1;ne>=ee;ne--)H=G(H,j[ne]);for(--ee;ee>=0;ee--){const ne=j[ee];if(typeof ne!="object"){const me=Q.pop();H=H===_(me,ne)?me:H===void 0?d(me,ne):(z=ne,X=H,(U=c(U=me))[z]=X,U)}else u(ne)&&(o(H!==void 0,"Cannot pick up or remove undefined"),ne.p!=null&&(Y[ne.p]=H),H=void 0)}var U,z,X;return H})(I,D),D)}function x(I,D){I=I.slice(),B(D);const Y=s.readCursor(D);let G,H,j=!1;const Q=[];for(let U=0;;U++){const z=I[U],X=Y.getComponent();if(X&&(X.r!==void 0?j=!0:X.p!=null&&(j=!1,G=X.p,H=U)),U>=I.length)break;let ne=0;const me=s.advancer(Y,void 0,(K,he)=>{u(he)&&ne++});Q.unshift(me);const pe=me(z);if(typeof z=="number"&&(I[U]-=ne),!pe)break}if(Q.forEach(U=>U.end()),j)return null;const ee=()=>{let U=0;if(G!=null){const z=Y.getPath();U=z.length,I=z.concat(I.slice(H))}for(;U<I.length;U++){const z=I[U],X=a(Y),ne=W(X);if(ne){const K=S(X);ne.transformPosition&&(I[U]=ne.transformPosition(I[U],K));break}let me=0;const pe=s.advancer(Y,(K,he)=>h(he)?~(K-me):K-me,(K,he)=>{h(he)&&me++})(z);if(typeof z=="number"&&(I[U]+=me),!pe)break}};return G!=null?Y.eachDrop(null,U=>{U===G&&ee()}):ee(),I}function O(I,D){if(B(I),B(D),I==null)return D;if(D==null)return I;let Y=0;const G=s.readCursor(I),H=s.readCursor(D),j=s.writeCursor(),Q=[],ee=[],U=[],z=[],X=[],ne=[],me=new Set;G.traverse(null,K=>{K.p!=null&&(U[K.p]=G.clone())}),H.traverse(null,K=>{K.d!=null&&(z[K.d]=H.clone())});const pe=s.writeCursor();return(function K(he,xe,ye,Ie,Be,Bt,nt,qe){o(xe||ye);const $e=a(xe),ft=a(ye),Ot=!!ft&&ft.r!==void 0,cn=!!$e&&$e.i!==void 0,mt=$e?$e.d:null,lt=ft?ft.p:null,$t=(Bt||Ot)&&lt==null;if(lt!=null)Ie=z[lt],nt=ee[lt]=new s.WriteCursor;else if(ft&&ft.r!==void 0)Ie=null;else{const se=a(Ie);se&&se.d!=null&&(Ie=null)}const be=a(Ie);if(mt!=null)if(he=U[mt],qe=Q[mt]=new s.WriteCursor,$t)Bt&&!Ot&&qe.write("r",!0);else{const se=X[mt]=Y++;nt.write("d",se)}else if($e&&$e.i!==void 0)he=null;else{const se=a(he);se&&se.p!=null&&(he=null)}let ae;cn?(o(Be===void 0),ae=$e.i):ae=Be;const Ce=(lt==null?!cn||Bt||Ot:ae===void 0)?null:nt.getComponent();if(lt!=null){if(!(Be!==void 0||cn)){const se=mt!=null?X[mt]:Y++;ne[lt]=se,qe.write("p",se)}}else Ot&&(cn||Be!==void 0||(ft.r,qe.write("r",ft.r)));const ue=$t?null:W($e),re=W(be);if((ue||re)&&(ue&&ue.name,re&&re.name),ue&&re){o(ue===re);const se=S($e),Re=S(be),ze=ue.compose(se,Re);C(nt,ue,ze),me.add(be)}else ue?C(nt,ue,S($e)):re&&(C(nt,re,S(be)),me.add(be));const de=typeof ae=="object"&&ae!=null;let we=!1,ve=0,Te=0,Ve=0,Ye=0,He=0;const et=s.advancer(Ie,(se,Re)=>h(Re)?Ye-se-1:se-Ye,(se,Re)=>{h(Re)&&Ye++}),Se=s.advancer(he,(se,Re)=>u(Re)?ve-se-1:se-ve,(se,Re)=>{u(Re)&&ve++});if(s.eachChildOf(xe,ye,(se,Re,ze)=>{let rt,Ht,un=se,vt=se,er=se;if(typeof se=="number"){let Ze=se+Ve;Ht=et(Ze),vt=Ze+Ye;let je=se+Te;rt=Se(je),h(a(Ht))&&(rt=null),un=je+ve,er=se+He,o(un>=0,"p1PickKey is negative"),o(vt>=0,"p2DropKey is negative");const wt=h(a(Re)),jt=u(a(ze));(wt||jt&&!$t)&&He--,wt&&Te--,jt&&Ve--}else rt=Se(se),Ht=et(se);qe.descend(un),nt.descend(vt);const wn=de&&!h(a(Re))?ae[er]:void 0,Mt=K(rt,Re,ze,Ht,wn,$t,nt,qe);var Lt,ge,ke;de&&!$t?wn!==Mt&&(we||(ae=Array.isArray(ae)?ae.slice():Object.assign({},ae),we=!0),Lt=ae,ke=Mt,typeof(ge=er)=="number"?(o(Array.isArray(Lt)),o(ge<Lt.length)):(o(!Array.isArray(Lt)),o(Lt[ge]!==void 0)),ke===void 0?typeof ge=="number"?Lt.splice(ge,1):delete Lt[ge]:Lt[ge]=ke):o(Mt===void 0),nt.ascend(),qe.ascend()}),Se.end(),et.end(),Ce!=null)Ce.i=ae;else if(!Bt&&!Ot&&lt==null)return ae})(G,G.clone(),H,H.clone(),void 0,!1,j,pe),j.reset(),j.mergeTree(pe.get()),j.reset(),j.get(),Q.map(K=>K.get()),ee.map(K=>K.get()),G.traverse(j,(K,he)=>{const xe=K.p;if(xe!=null){const ye=X[xe];ye!=null&&he.write("p",ye);const Ie=Q[xe];Ie&&Ie.get(),Ie&&he.mergeTree(Ie.get())}else K.r!==void 0&&he.write("r",K.r)}),j.reset(),j.get(),H.traverse(j,(K,he)=>{const xe=K.d;if(xe!=null){const Ie=ne[xe];Ie!=null&&he.write("d",Ie);const Be=ee[xe];Be&&he.mergeTree(Be.get())}else K.i!==void 0&&he.write("i",K.i);const ye=W(K);ye&&!me.has(K)&&C(he,ye,S(K))}),j.get()}function N(I){if(I==null)return null;const D=new s.ReadCursor(I),Y=new s.WriteCursor;let G;const H=[],j=[];return(function Q(ee,U,z){const X=ee.getComponent();let ne,me=!1;if(X){X.p!=null&&(U.write("d",X.p),H[X.p]=ee.clone()),X.r!==void 0&&U.write("i",X.r),X.d!=null&&(U.write("p",X.d),z=void 0),X.i!==void 0&&(z=ne=X.i);const K=W(X);K&&(z===void 0?(G||(G=new Set),G.add(X)):(S(X),z=K.apply(z,S(X)),me=!0))}let pe=0;for(const K of ee){U.descend(K);const he=typeof K=="number"?K-pe:K,xe=_(z,he);h(ee.getComponent())&&pe++;const ye=Q(ee,U,xe);if(z!==void 0&&ye!==void 0){if(me||(me=!0,z=c(z)),!g(z,he))throw Error("Cannot modify child - invalid operation");z[he]=ye}U.ascend()}if(ne===void 0)return me?z:void 0;U.write("r",z)})(D,Y,void 0),G&&(Y.reset(),(function Q(ee,U,z){const X=U.getComponent();if(X){const K=X.d;if(K!=null&&(ee=H[K],z=j[K]=s.writeCursor()),G.has(X)){const he=W(X);if(!he.invert)throw Error(`Cannot invert subtype ${he.name}`);C(z,he,he.invert(S(X)))}}let ne=0,me=0;const pe=s.advancer(ee,(K,he)=>u(he)?ne-K-1:K-ne,(K,he)=>{u(he)&&ne++});for(const K of U)if(typeof K=="number"){const he=K-me,xe=pe(he),ye=he+ne;z.descend(ye),Q(xe,U,z),h(U.getComponent())&&me++,z.ascend()}else z.descend(K),Q(pe(K),U,z),z.ascend();pe.end()})(D.clone(),D,Y),j.length&&(Y.reset(),D.traverse(Y,(Q,ee)=>{const U=Q.p;if(U!=null){const z=j[U];z&&z.get(),z&&ee.mergeTree(z.get())}}))),Y.get()}const A=(I,D)=>I.some(Y=>typeof Y=="object"&&(Array.isArray(Y)?A(Y,D):D(Y)));function v(I,D){if(I==null||!A(I,U=>{var z;return U.r!==void 0||((z=W(U))===null||z===void 0?void 0:z.makeInvertible)!=null}))return I;const Y=new s.ReadCursor(I),G=new s.WriteCursor;let H=!1;const j=[],Q=[],ee=(U,z,X)=>{const ne=U.getComponent();let me=!1;if(ne){ne.d!=null&&z.write("d",ne.d),ne.i!==void 0&&z.write("i",ne.i);const K=ne.p;if(K!=null&&(j[K]=U.clone(),o(X!==void 0,"Operation picks up at an invalid key"),Q[K]=X,z.write("p",ne.p)),ne.r!==void 0&&X===void 0)throw Error("Invalid doc / op in makeInvertible: removed item missing from doc");const he=W(ne);he&&(he.makeInvertible?H=!0:C(z,he,S(ne),!0))}let pe=0;for(const K of U){z.descend(K);const he=typeof K=="number"?K-pe:K,xe=_(X,he),ye=ee(U,z,xe);xe!==ye&&(me||(me=!0,X=c(X)),ye===void 0?(X=d(X,he),typeof K=="number"&&pe++):X[he]=ye),z.ascend()}return ne&&(ne.r!==void 0?(z.write("r",r.default(X)),X=void 0):ne.p!=null&&(X=void 0)),X};return ee(Y,G,D),G.get(),H&&(G.reset(),(function U(z,X,ne,me,pe){const K=X.getComponent();if(K){K.i!==void 0?(me=K.i,pe=!0):K.d!=null&&(me=Q[K.d],z=j[K.d],pe=!1,K.d);let Ie=W(K);if(Ie&&Ie.makeInvertible){const Be=S(K);C(ne,Ie,Ie.makeInvertible(Be,me),!0)}}let he=0,xe=0;const ye=s.advancer(z,(Ie,Be)=>u(Be)?he-Ie-1:Ie-he,(Ie,Be)=>{u(Be)&&he++});for(const Ie of X)if(typeof Ie=="number"){const Be=Ie-xe,Bt=ye(Be),nt=Be+he,qe=_(me,pe?Be:nt);ne.descend(Ie),U(Bt,X,ne,qe,pe),h(X.getComponent())&&xe++,ne.ascend()}else{const Be=_(me,Ie);ne.descend(Ie),U(ye(Ie),X,ne,Be,pe),ne.ascend()}ye.end()})(Y.clone(),Y,G,D,!1)),G.get()}function y(I,D){return N(v(I,D))}const M=I=>{if(I==null)return null;const D=I.slice();for(let Y=0;Y<I.length;Y++){const G=D[Y];Array.isArray(G)&&(D[Y]=M(G))}return D};function L(I,D,Y){o(Y==="left"||Y==="right","Direction must be left or right");const G=Y==="left"?0:1;if(D==null)return{ok:!0,result:I};B(I),B(D);let H=null;const j=[],Q=[],ee=[],U=[],z=[],X=[],ne=[],me=[],pe=[],K=[],he=[],xe=[],ye=[],Ie=[],Be=[];let Bt=0;const nt=s.readCursor(I),qe=s.readCursor(D),$e=s.writeCursor();if((function be(ae,Ce=null,ue){const re=a(Ce);re&&(re.r!==void 0?ue=Ce.clone():re.p!=null&&(ue=null,X[re.p]=ae.clone()));const de=ae.getComponent();let we;de&&(we=de.p)!=null&&(z[we]=Ce?Ce.clone():null,ee[we]=ae.clone(),ue&&(K[we]=!0,pe[we]=ue),re&&re.p!=null&&(Ie[we]=re.p));const ve=s.advancer(Ce);for(const Te of ae)be(ae,ve(Te),ue);ve.end()})(qe,nt,null),(function be(ae,Ce,ue,re,de){const we=ue.getComponent();let ve,Te=!1;we&&((ve=we.d)!=null?(U[ve]=ue.clone(),re!=null&&(Be[re]==null&&(Be[re]=[]),Be[re].push(ve)),K[ve],ae=z[ve]||null,Ce=ee[ve]||null,K[ve]?(de&&(he[ve]=!0),de=pe[ve]||null):!de||G!==1&&Ie[ve]!=null||H==null&&(H={type:i.ConflictType.RM_UNEXPECTED_CONTENT,op1:e.removeOp(de.getPath()),op2:e.moveOp(Ce.getPath(),ue.getPath())}),Te=!0):we.i!==void 0&&(ae=Ce=null,Te=!0,de&&H==null&&(H={type:i.ConflictType.RM_UNEXPECTED_CONTENT,op1:e.removeOp(de.getPath()),op2:e.insertOp(ue.getPath(),we.i)})));const Ve=a(ae);Ve&&(Ve.r!==void 0?de=ae.clone():Ve.p!=null&&(Ve.p,re=Ve.p,de=null));const Ye=W(we);Ye&&de&&H==null&&(H={type:i.ConflictType.RM_UNEXPECTED_CONTENT,op1:e.removeOp(de.getPath()),op2:e.editOp(ue.getPath(),Ye,S(we),!0)});let He=0,et=0;const Se=s.advancer(Ce,(Re,ze)=>u(ze)?He-Re-1:Re-He,(Re,ze)=>{u(ze)&&He++}),se=s.advancer(ae);for(const Re of ue)if(typeof Re=="number"){const ze=Re-et,rt=Se(ze);et+=+be(se(ze+He),rt,ue,re,de)}else{const ze=Se(Re);be(se(Re),ze,ue,re,de)}return Se.end(),se.end(),Te})(nt,qe,qe.clone(),null,null),U.map(be=>be&&be.get()),H)return{ok:!1,conflict:H};he.map(be=>!!be);const ft=[];let Ot=null;(function be(ae,Ce,ue,re,de){let we=!1;const ve=a(Ce);if(u(ve)){const Se=ve.p;Se!=null?(ue=U[Se],re=xe[Se]=s.writeCursor(),we=!0,de=null):(ue=null,de=Ce.clone())}else h(a(ue))&&(ue=null);const Te=ae.getComponent();if(Te){const Se=Te.p;Se!=null?(de&&(me[Se]=de),ft[Se]=de||G===1&&we?null:re.getComponent(),j[Se]=ae.clone(),ue&&(ne[Se]=ue.clone())):Te.r!==void 0&&(de||re.write("r",!0),(de||we)&&(Ot==null&&(Ot=new Set),Ot.add(Te)))}let Ve=0,Ye=0;const He=s.advancer(Ce,void 0,(Se,se)=>{u(se)&&Ve++}),et=s.advancer(ue,(Se,se)=>h(se)?~(Se-Ye):Se-Ye,(Se,se)=>{h(se)&&Ye++});if(ae)for(const Se of ae)if(typeof Se=="string"){const se=He(Se),Re=et(Se);re.descend(Se),be(ae,se,Re,re,de),re.ascend()}else{const se=He(Se),Re=Se-Ve,ze=u(a(se))?null:et(Re),rt=Re+Ye;o(rt>=0),re.descend(rt),be(ae,se,ze,re,de),re.ascend()}He.end(),et.end()})(nt,qe,qe.clone(),$e,null),$e.reset();let cn=[];if((function be(ae,Ce,ue,re,de,we){o(Ce);const ve=Ce.getComponent();let Te=a(re),Ve=!1;const Ye=(ge,ke,Ze)=>ge?e.moveOp(ge.getPath(),ke.getPath()):e.insertOp(ke.getPath(),Ze.i);if(h(ve)){const ge=ve.d;ge!=null&&(Q[ge]=Ce.clone());const ke=ge!=null?ft[ge]:null;let Ze=!1;if(ve.i!==void 0||ge!=null&&ke){let je;Te&&(Te.i!==void 0||(je=Te.d)!=null&&!K[je])&&(Ze=je!=null?ge!=null&&ge===Ie[je]:n.default(Te.i,ve.i),Ze||je!=null&&G!==1&&Ie[je]!=null||H==null&&(H={type:i.ConflictType.DROP_COLLISION,op1:Ye(ge!=null?j[ge]:null,Ce,ve),op2:Ye(je!=null?ee[je]:null,re,Te)})),Ze||(we?H==null&&(H={type:i.ConflictType.RM_UNEXPECTED_CONTENT,op1:Ye(ge!=null?j[ge]:null,Ce,ve),op2:e.removeOp(we.getPath())}):(ge!=null?(cn[Bt]=ge,de.write("d",ke.p=Bt++)):de.write("i",r.default(ve.i)),Ve=!0))}else if(ge!=null&&!ke){const je=me[ge];je&&(we=je.clone())}ge!=null?(ae=j[ge],ue=X[ge],re=ne[ge]):ve.i!==void 0&&(ae=ue=null,Ze||(re=null))}else u(a(ae))&&(ae=ue=re=null);const He=a(ae),et=a(ue);if(u(et)){const ge=et.p;et.r!==void 0&&(!He||He.r===void 0)||K[ge]?(re=null,we=ue.clone()):ge!=null&&(re=U[ge],G!==1&&Ie[ge]!=null||((de=ye[ge])||(de=ye[ge]=s.writeCursor()),de.reset(),we=null))}else!h(ve)&&h(Te)&&(re=null);Te=re!=null?re.getComponent():null;const Se=W(ve);if(Se){const ge=S(ve);if(we)H==null&&(H={type:i.ConflictType.RM_UNEXPECTED_CONTENT,op1:e.editOp(Ce.getPath(),Se,ge,!0),op2:e.removeOp(we.getPath())});else{const ke=W(Te);let Ze;if(ke){if(Se!==ke)throw Error("Transforming incompatible types");const je=S(Te);Ze=Se.transform(ge,je,Y)}else Ze=r.default(ge);C(de,Se,Ze)}}let se=0,Re=0,ze=0,rt=0,Ht=0,un=0,vt=ae!=null&&ae.descendFirst(),er=vt;const wn=s.advancer(ue,void 0,(ge,ke)=>{u(ke)&&ze++});let Mt=re!=null&&re.descendFirst(),Lt=Mt;for(const ge of Ce)if(typeof ge=="number"){let ke;const Ze=h(Ce.getComponent()),je=ge-Re;{let Kt;for(;vt&&typeof(Kt=ae.getKey())=="number";){Kt+=se;const bt=ae.getComponent(),bn=u(bt);if(Kt>je||Kt===je&&(!bn||G===0&&Ze))break;if(bn){se--;const hn=bt.p;Ie.includes(hn),bt.d,a(ye[bt.d]),u(a(ye[bt.d])),(bt.r===void 0||Ot&&Ot.has(bt))&&(hn==null||!ft[hn]||G!==1&&Ie.includes(hn))||Ht--}vt=ae.nextSibling()}ke=vt&&Kt===je?ae:null}const wt=je-se;let jt=wn(wt);const ti=wt-ze;let zr=null;{let Kt,bt;for(;Mt&&typeof(Kt=re.getKey())=="number";){bt=Kt-rt;const bn=re.getComponent(),hn=h(bn);if(bt>ti)break;if(bt===ti){if(!hn){zr=re;break}{if(G===0&&Ze){zr=re;break}const Xt=jt&&u(jt.getComponent());if(G===0&&Xt)break}}if(hn){const Xt=bn.d;K[Xt],Ie[Xt],bn.i===void 0&&(K[Xt]||Ie[Xt]!=null&&G!==1)?(K[Xt]||Ie[Xt]!=null&&G===0)&&(rt++,un--):rt++}Mt=re.nextSibling()}}const fa=ti+rt+Ht+un;o(fa>=0,"trying to descend to a negative index"),de.descend(fa),Ze&&(ke=jt=zr=null,Re++),be(ke,Ce,jt,zr,de,we)&&un++,de.ascend()}else{let ke;for(;vt&&(ke=ae.getKey(),typeof ke!="string"||!(ke>ge||ke===ge));)vt=ae.nextSibling();const Ze=vt&&ke===ge?ae:null,je=wn(ge);let wt;for(;Mt&&(wt=re.getKey(),typeof wt!="string"||!(wt>ge||wt===ge));)Mt=re.nextSibling();const jt=Mt&&wt===ge?re:null;de.descend(ge),be(Ze,Ce,je,jt,de,we),de.ascend()}return wn.end(),er&&ae.ascend(),Lt&&re.ascend(),Ve})(nt,nt.clone(),qe,qe.clone(),$e,null),H)return{ok:!1,conflict:H};$e.reset();const mt=(be,ae,Ce)=>be.traverse(ae,(ue,re)=>{ue.d!=null&&Ce(ue.d,be,re)});(K.length||xe.length)&&(mt(qe,$e,(be,ae,Ce)=>{K[be]&&!he[be]&&Ce.write("r",!0),xe[be]&&Ce.mergeTree(xe[be].get())}),$e.reset());const lt=[],$t=[];if((ye.length||K.length)&&!H){const be=s.readCursor(M($e.get()));if(mt(be,null,(ae,Ce)=>{lt[ae]=Ce.clone()}),ye.forEach(ae=>{ae&&mt(s.readCursor(ae.get()),null,(Ce,ue)=>{lt[Ce]=ue.clone()})}),(function ae(Ce,ue,re,de,we,ve){const Te=a(ue);if(Te&&u(Te))if(Te.p!=null){const se=Te.p;lt[se].getPath(),re=lt[se],de=$t[se]=s.writeCursor()}else Te.r!==void 0&&(re=null);else h(a(re))&&(re=null);const Ve=Ce.getComponent();if(Ve){let se;if((se=Ve.d)!=null){const Re=ye[se];Re&&(Re.get(),de.mergeTree(Re.get()),re=s.readCursor(Re.get()))}}let Ye=0,He=0;const et=s.advancer(ue,void 0,(se,Re)=>{u(Re)&&Ye--}),Se=s.advancer(re,(se,Re)=>h(Re)?-(se-He)-1:se-He,(se,Re)=>{h(Re)&&He++});for(const se of Ce)if(typeof se=="number"){const Re=et(se),ze=se+Ye,rt=Se(ze),Ht=ze+He;de.descend(Ht),ae(Ce,Re,rt,de),de.ascend()}else de.descend(se),ae(Ce,et(se),Se(se),de),de.ascend();et.end(),Se.end()})(qe,be,be.clone(),$e),$e.reset(),H)return{ok:!1,conflict:H};if($e.get(),$t.length){const ae=$t.map(ue=>ue?ue.get():null),Ce=s.readCursor(M($e.get()));if(mt(Ce,$e,(ue,re,de)=>{const we=ae[ue];we&&(de.mergeTree(we),ae[ue]=null)}),ae.find(ue=>ue)){const ue=s.writeCursor(),re=s.writeCursor();let de=0,we=0;ae.forEach(ve=>{ve!=null&&mt(s.readCursor(ve),null,Te=>{const Ve=cn[Te];ue.writeMove(j[Ve].getPath(),Q[Ve].getPath(),de++);const Ye=Be[Ve];Ye&&Ye.forEach(He=>{K[He]||G!==1&&Ie[He]!=null||re.writeMove(ee[He].getPath(),U[He].getPath(),we++)})})}),H={type:i.ConflictType.BLACKHOLE,op1:ue.get(),op2:re.get()}}}}return H?{ok:!1,conflict:H}:{ok:!0,result:$e.get()}}const P=I=>{const D=new Error("Transform detected write conflict");throw D.conflict=I,D.type=D.name="writeConflict",D};function J(I,D,Y){const G=L(I,D,Y);if(G.ok)return G.result;P(G.conflict)}const V=I=>{const D=s.writeCursor();return s.readCursor(I).traverse(D,(Y,G)=>{(h(Y)||W(Y))&&G.write("r",!0)}),D.get()},oe=(I,D)=>{const{type:Y,op1:G,op2:H}=I;switch(Y){case i.ConflictType.DROP_COLLISION:return D==="left"?[null,V(H)]:[V(G),null];case i.ConflictType.RM_UNEXPECTED_CONTENT:let j=!1;return s.readCursor(G).traverse(null,Q=>{Q.r!==void 0&&(j=!0)}),j?[null,V(H)]:[V(G),null];case i.ConflictType.BLACKHOLE:return[V(G),V(H)];default:throw Error("Unrecognised conflict: "+Y)}};function le(I,D,Y,G){let H=null;for(;;){const j=L(D,Y,G);if(j.ok)return O(H,j.result);{const{conflict:Q}=j;I(Q)||P(Q);const[ee,U]=oe(Q,G);D=O($(D),ee),Y=O($(Y),U),H=O(H,U)}}}})(nr)),nr}var ja;function M_(){return ja||(ja=1,(function(e){var t=dn&&dn.__createBinding||(Object.create?(function(i,o,a,l){l===void 0&&(l=a),Object.defineProperty(i,l,{enumerable:!0,get:function(){return o[a]}})}):(function(i,o,a,l){l===void 0&&(l=a),i[l]=o[a]})),n=dn&&dn.__exportStar||function(i,o){for(var a in i)a!=="default"&&!o.hasOwnProperty(a)&&t(o,i,a)};Object.defineProperty(e,"__esModule",{value:!0}),n(N_(),e);var r=ou();Object.defineProperty(e,"ReadCursor",{enumerable:!0,get:function(){return r.ReadCursor}}),Object.defineProperty(e,"WriteCursor",{enumerable:!0,get:function(){return r.WriteCursor}});var s=au();Object.defineProperty(e,"ConflictType",{enumerable:!0,get:function(){return s.ConflictType}})})(dn)),dn}var ot=M_();const L_=St(ot),D_=Od({__proto__:null,default:L_},[ot]);var Ee=(e=>(e[e.COVER=0]="COVER",e[e.REPLACE=1]="REPLACE",e))(Ee||{}),q=(e=>(e.RETAIN="r",e.INSERT="i",e.DELETE="d",e))(q||{});const Jn=Ae.createIdentifier("univer.context-service");class lu extends Ke{constructor(){super(...arguments);p(this,"_contextChanged$",new ce.Subject);p(this,"contextChanged$",this._contextChanged$.asObservable());p(this,"_contextMap",new Map)}dispose(){super.dispose(),this._contextChanged$.complete(),this._contextMap.clear()}getContextValue(n){var r;return(r=this._contextMap.get(n))!=null?r:!1}setContextValue(n,r){this._contextMap.set(n,r),this._contextChanged$.next({[n]:r})}subscribeContextValue$(n){return new ce.Observable(r=>{const s=this._contextChanged$.pipe(ce.filter(i=>typeof i[n]<"u")).subscribe(i=>r.next(i[n]));return this._contextMap.has(n)&&r.next(this._contextMap.get(n)),()=>s.unsubscribe()})}}var cu=(e=>(e[e.SILENT=0]="SILENT",e[e.ERROR=1]="ERROR",e[e.WARN=2]="WARN",e[e.INFO=3]="INFO",e[e.VERBOSE=4]="VERBOSE",e))(cu||{});const Ct=Ae.createIdentifier("univer.log");class uu extends Ke{constructor(){super(...arguments);p(this,"_logLevel",3);p(this,"_deduction",new Set)}dispose(){super.dispose(),this._logLevel=3,this._deduction.clear()}debug(...n){this._logLevel>=4&&this._log(console.debug,...n)}log(...n){this._logLevel>=3&&this._log(console.log,...n)}warn(...n){this._logLevel>=2&&this._log(console.warn,...n)}error(...n){this._logLevel>=1&&this._log(console.error,...n)}deprecate(...n){this._logLevel>=2&&this._logWithDeduplication(console.error,...n)}setLogLevel(n){this._logLevel=n}_log(n,...r){const s=r[0];/^\[(.*?)\]/g.test(s)?n(`\x1B[97;104m${s}\x1B[0m`,...r.slice(1)):n(...r)}_logWithDeduplication(n,...r){const s=x_(...r);this._deduction.has(s)||(this._deduction.add(s),this._log(n,...r))}}function x_(...e){return e.map(t=>JSON.stringify(t)).join("")}var U_=Object.getOwnPropertyDescriptor,P_=(e,t,n,r)=>{for(var s=r>1?void 0:r?U_(t,n):t,i=e.length-1,o;i>=0;i--)(o=e[i])&&(s=o(s)||s);return s},Wa=(e,t)=>(n,r)=>t(n,r,e),$r=(e=>(e[e.COMMAND=0]="COMMAND",e[e.OPERATION=1]="OPERATION",e[e.MUTATION=2]="MUTATION",e))($r||{});const Hr=Ae.createIdentifier("univer.core.command-service");class k_{constructor(){p(this,"_commands",new Map);p(this,"_commandTypes",new Map)}registerCommand(t){if(this._commands.has(t.id))throw new Error(`[CommandRegistry]: command "${t.id}" has been registered before.`);return this._commands.set(t.id,t),this._commandTypes.set(t.id,t.type),We(()=>{this.unregisterCommand(t.id)})}unregisterCommand(t){this._commands.delete(t),this._commandTypes.delete(t)}hasCommand(t){return this._commands.has(t)}getCommand(t){return this._commands.has(t)?[this._commands.get(t)]:null}getCommandType(t){return this._commandTypes.get(t)}}const hu={id:"nil",type:0,handler:()=>!0};exports.CommandService=class extends Ke{constructor(n,r){super();p(this,"_commandRegistry");p(this,"_beforeCommandExecutionListeners",[]);p(this,"_commandExecutedListeners",[]);p(this,"_multiCommandDisposables",new Map);p(this,"_commandExecutingLevel",0);p(this,"_commandExecutionStack",[]);this._injector=n,this._logService=r,this._commandRegistry=new k_,this.registerCommand(hu)}dispose(){super.dispose(),this._commandExecutedListeners.length=0,this._beforeCommandExecutionListeners.length=0}hasCommand(n){return this._commandRegistry.hasCommand(n)}registerCommand(n){return this._commandRegistry.registerCommand(n)}unregisterCommand(n){var r;this._commandRegistry.unregisterCommand(n),(r=this._multiCommandDisposables.get(n))==null||r.dispose()}registerMultipleCommand(n){return this._registerMultiCommand(n)}beforeCommandExecuted(n){if(this._beforeCommandExecutionListeners.indexOf(n)===-1)return this._beforeCommandExecutionListeners.push(n),We(()=>{const r=this._beforeCommandExecutionListeners.indexOf(n);this._beforeCommandExecutionListeners.splice(r,1)});throw new Error("[CommandService]: could not add a listener twice.")}onCommandExecuted(n){if(this._commandExecutedListeners.indexOf(n)===-1)return this._commandExecutedListeners.push(n),We(()=>{const r=this._commandExecutedListeners.indexOf(n);this._commandExecutedListeners.splice(r,1)});throw new Error("[CommandService]: could not add a listener twice.")}async executeCommand(n,r,s){try{const i=this._commandRegistry.getCommand(n);if(i){const[o]=i,a={id:o.id,type:o.type,params:r},l=this._pushCommandExecutionStack(a),c=s!=null?s:{};this._beforeCommandExecutionListeners.forEach(h=>h(a,c));const u=await this._execute(o,r,c);return this._commandExecutedListeners.forEach(h=>h(a,c)),l.dispose(),u}throw new Error(`[CommandService]: command "${n}" is not registered.`)}catch(i){if(i instanceof Ss)return!1;throw i}}syncExecuteCommand(n,r,s){var i;try{const o=this._commandRegistry.getCommand(n);if(o){const[a]=o,l={id:a.id,type:a.type,params:r};if(a.type===2){const d=Nd(this._commandExecutionStack,f=>f.type===0);d&&(l.params=(i=l.params)!=null?i:{},l.params.trigger=d.id)}const c=this._pushCommandExecutionStack(l),u=s!=null?s:{};this._beforeCommandExecutionListeners.forEach(d=>d(l,u));const h=this._syncExecute(a,r,u);return this._commandExecutedListeners.forEach(d=>d(l,u)),c.dispose(),h}throw new Error(`[CommandService]: command "${n}" is not registered.`)}catch(o){if(o instanceof Ss)return!1;throw o}}_pushCommandExecutionStack(n){return this._commandExecutionStack.push(n),We(()=>Ur(this._commandExecutionStack,n))}_registerMultiCommand(n){const r=this._commandRegistry.getCommand(n.id);let s;if(r){if(r[0].multi!==!0)throw new Error("Command has registered as a single command.");s=r[0]}else{s=new F_(n.id);const o=new js;o.add(this._commandRegistry.registerCommand(s)),o.add(We(()=>{this._multiCommandDisposables.delete(n.id)})),this._multiCommandDisposables.set(n.id,o)}const i=s.registerImplementation(n);return We(()=>{var o;i.dispose(),s.hasImplementations()||(o=this._multiCommandDisposables.get(n.id))==null||o.dispose()})}async _execute(n,r,s){this._logService.debug("[CommandService]",`${"|-".repeat(Math.max(this._commandExecutingLevel,0))}executing command "${n.id}"`),this._commandExecutingLevel++;let i;try{i=await this._injector.invoke(n.handler,r,s),this._commandExecutingLevel--}catch(o){throw i=!1,this._commandExecutingLevel=0,o}return i}_syncExecute(n,r,s){this._logService.debug("[CommandService]",`${"|-".repeat(Math.max(0,this._commandExecutingLevel))}executing command "${n.id}".`),this._commandExecutingLevel++;let i;try{if(i=this._injector.invoke(n.handler,r,s),i instanceof Promise)throw new TypeError("[CommandService]: Command handler should not return a promise.");this._commandExecutingLevel--}catch(o){throw i=!1,this._commandExecutingLevel=0,o}return i}};exports.CommandService=P_([Wa(0,Ae.Inject(Ae.Injector)),Wa(1,Ct)],exports.CommandService);class F_{constructor(t){p(this,"name");p(this,"multi",!0);p(this,"type",0);p(this,"priority",0);p(this,"_implementations",[]);p(this,"handler",async(t,n)=>{if(!this._implementations.length)return!1;const r=t.get(Ct),s=t.get(Jn),i=t.get(Ae.Injector);for(const o of this._implementations){const a=o.command.preconditions;if((!a||a&&a(s))&&(r.debug("[MultiCommand]",`executing implementation "${o.command.name}".`),await i.invoke(o.command.handler,n)))return!0}return!1});this.id=t,this.name=t}registerImplementation(t){const n={command:t};return this._implementations.push(n),this._implementations.sort((r,s)=>s.command.priority-r.command.priority),We(()=>{const r=this._implementations.indexOf(n);this._implementations.splice(r,1)})}hasImplementations(){return this._implementations.length>0}}function Gs(e,t,n){const r=e.map(s=>()=>t.syncExecuteCommand(s.id,s.params,n));return cc(r)}function B_(e,t,n){const r=e.map(s=>()=>t.executeCommand(s.id,s.params,n));return lc(r)}function du(e){return new ce.Observable(t=>{const n=e((...r)=>t.next(r));return()=>n==null?void 0:n.dispose()})}function Di(e){return function(n){return new ce.Observable(r=>(n.subscribe({next:s=>{r.next(s),e(s)&&r.complete()},complete:()=>r.complete(),error:s=>r.error(s)}),()=>r.unsubscribe()))}}function $_(e=0){return t=>{let n=[];return t.pipe(ce.tap(r=>n.push(r)),ce.debounceTime(e),ce.map(()=>n),ce.tap(()=>n=[]))}}function H_(e){const t=new ce.ReplaySubject(1);return setTimeout(()=>t.next(),e),t.pipe(ce.take(1))}function j_(e,t){const n=new ce.BehaviorSubject(t);return e.subscribe(n),n}const W_=e=>new Promise(t=>{ce.merge(du(e.onCommandExecuted.bind(e)).pipe(ls.filter(([n])=>n.type===$r.MUTATION)),ce.timer(300)).pipe(ls.debounceTime(16),ls.first()).subscribe(()=>{t()})});function fu(e,t){let n=0,r=e.length-1;if(t<e[0])return 0;if(t>=e[e.length-1])return e.length-1;for(;n<=r;){if(e[n]===t){for(;n<e.length&&e[n]===t;)n++;return n}if(t>e[n]&&t<e[n+1])return n+1;if(e[r]===t){for(;r<e.length&&e[r]===t;)r++;return r}if(t>e[r-1]&&t<e[r])return r;n++,r--}return-1}function Y_(e,t){let n=0,r=e.length-1;for(;n<=r;){const s=Math.floor((r+n)/2);if(t<e[s]&&(s===0||t>=e[s-1]))return s;if(t>=e[s])n=s+1;else if(t<e[s])r=s-1;else return-1}return-1}function mu(e,t){let n=0,r=e.length;for(;n<r;){const s=Math.floor((n+r)/2);e[s]<=t?n=s+1:r=s}return n<e.length?n:e.length-1}function lr(e,t,n=!1){let r=e.length-1;if(t<0||t<e[0])return 0;if(e.length<40||t<=e[20]||t>=e[r-20]?r=fu(e,t):r=mu(e,t),n){const s=e[r];return e.indexOf(s)}return r}function G_(e){const t=new Blob([e],{type:"text/javascript"});return window.URL.createObjectURL(t)}const cr=2,gu=1;function V_(e,t){if(t==null||e==null)return!0;const{left:n=0,top:r=0,height:s=0,width:i=0,angle:o=0}=t,{left:a=0,top:l=0,height:c=0,width:u=0,angle:h=0}=e,d=u,f=c,g=i,_=s;return Math.abs(a-n)>cr||Math.abs(l-r)>cr||Math.abs(d-g)>cr||Math.abs(f-_)>cr||Math.abs(h-o)>gu}function cs(e,t,n){const{dataStream:r,textRuns:s=[]}=e;let i=t;const o=[];for(const a of s){const{st:l,ed:c}=a;Z.hasIntersectionBetweenTwoRanges(t,n,l,c)&&(l>i?(o.push(r.slice(i,l)),o.push(xi(r,{...a,ed:Math.min(c,n)}))):o.push(xi(r,{...a,st:i,ed:Math.min(c,n)}))),i=Math.max(t,Math.min(c,n))}return i!==n&&o.push(r.slice(i,n)),o.join("")}function z_(e,t=!0){var n;if(t&&((n=e.paragraphs)!=null&&n.length)){const{dataStream:r,paragraphs:s=[]}=e;let i="",o=-1;for(const a of s){const{startIndex:l,paragraphStyle:c={}}=a,{spaceAbove:u,spaceBelow:h,lineSpacing:d}=c,f=[];u!=null&&(typeof u=="number"?f.push(`margin-top: ${u}px`):f.push(`margin-top: ${u.v}px`)),h!=null&&(typeof h=="number"?f.push(`margin-bottom: ${h}px`):f.push(`margin-bottom: ${h.v}px`)),d!=null&&f.push(`line-height: ${d}`),l>o+1?i+=`<p class="UniverNormal" ${f.length?`style="${f.join("; ")};"`:""}>${cs(e,o+1,l)}</p>`:i+=`<p class="UniverNormal" ${f.length?`style="${f.join("; ")};"`:""}></p>`,o=l}return o!==r.length&&(i+=cs(e,o,r.length)),i}else return cs(e,0,e.dataStream.length)}function xi(e,t){const{st:n,ed:r,ts:s={}}=t,{ff:i,fs:o,it:a,bl:l,ul:c,st:u,ol:h,bg:d,cl:f,va:g}=s;let _=e.slice(n,r);const R=[];return a===ie.TRUE&&(_=`<i>${_}</i>`),g===Yt.SUPERSCRIPT?_=`<sup>${_}</sup>`:g===Yt.SUBSCRIPT&&(_=`<sub>${_}</sub>`),(c==null?void 0:c.s)===ie.TRUE&&(_=`<u>${_}</u>`),(u==null?void 0:u.s)===ie.TRUE&&(_=`<s>${_}</s>`),l===ie.TRUE&&(_=`<strong>${_}</strong>`),i&&R.push(`font-family: ${i}`),f&&R.push(`color: ${f.rgb}`),o&&R.push(`font-size: ${o}pt`),h&&R.push("text-decoration: overline"),d&&R.push(`background: ${d.rgb}`),R.length?`<span style="${R.join("; ")};">${_}</span>`:_}const _u={[Ys.OFFICE]:{[it.ACCENT1]:"#4472C4",[it.ACCENT2]:"#ED7D31",[it.ACCENT3]:"#A5A5A5",[it.ACCENT4]:"#70AD47",[it.ACCENT5]:"#5B9BD5",[it.ACCENT6]:"#70AD47",[it.DARK1]:"#000000",[it.DARK2]:"#44546A",[it.LIGHT1]:"#FFFFFF",[it.LIGHT2]:"#E7E6E6",[it.HYPERLINK]:"#0563C1",[it.FOLLOWED_HYPERLINK]:"#954F72"}};class Vs{constructor(){p(this,"_themeValue",it.LIGHT1);p(this,"_themeColors");p(this,"_themeTint");p(this,"_rgbValue","");p(this,"_colorType");this._colorType=Et.UNSUPPORTED,this._themeColors=Ys.OFFICE,this._themeTint=0}asRgbColor(){return new Ts(this._rgbValue,this)}asThemeColor(){return new ys(this._themeValue,this._themeTint,this._themeColors,this)}build(){switch(this._colorType){case Et.THEME:return this.asThemeColor();case Et.RGB:return this.asRgbColor();case Et.UNSUPPORTED:throw new Error("unsupported color type")}}setRgbColor(t){return this._colorType=Et.RGB,this._rgbValue=t,this}setThemeColors(t){this._colorType=Et.THEME,this._themeColors=t}setThemeTint(t){this._colorType=Et.THEME,this._themeTint=t}setThemeColor(t){return this._colorType=Et.THEME,this._themeValue=t,this}getColorType(){return this._colorType}}class Sn{constructor(t){p(this,"_builder");this._builder=t}static rgbColorToHexValue(t){return`#${((1<<24)+(t.getRed()<<16)+(t.getGreen()<<8)+t.getBlue()).toString(16).slice(1)}`}static hexValueToRgbColor(t){t?t.indexOf("#")>-1&&(t=t.substring(1)):t="#000000";const n=+`0x${t[0]}${t[1]}`,r=+`0x${t[2]}${t[3]}`,s=+`0x${t[4]}${t[5]}`;return new Vs().setRgbColor(`rgb(${n},${r},${s})`).asRgbColor()}static hexToRgbString(t){const n=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;t=t.replace(n,(i,o,a,l)=>o+o+a+a+l+l);const r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);let s=null;if(r){const i=Number.parseInt(r[1],16),o=Number.parseInt(r[2],16),a=Number.parseInt(r[3],16);s=`rgba(${i},${o},${a})`}return s}asRgbColor(){return this._builder.asRgbColor()}asThemeColor(){return this._builder.asThemeColor()}getColorType(){return this._builder.getColorType()}clone(){return new Sn(this._builder)}equals(t){return!1}}class pu{constructor(t){p(this,"_saturation",0);p(this,"_hue",0);p(this,"_lightness",0);p(this,"_alpha",0);const n=t.getRed()/255,r=t.getGreen()/255,s=t.getBlue()/255,i=t.getAlpha()/255,o=Math.min(n,Math.min(r,s)),a=Math.max(n,Math.max(r,s)),l=a-o;if(a===o){this._hue=0,this._saturation=0,this._lightness=a;return}this._lightness=(o+a)/2,this._lightness<.5?this._saturation=l/(a+o):this._saturation=l/(2-a-o),n===a&&(this._hue=(r-s)/l),r===a&&(this._hue=2+(s-n)/l),s===a&&(this._hue=4+(n-r)/l),this._hue*=60,this._hue<0&&(this._hue+=360),this._alpha=i}asRgbColor(){const t=new Vs;if(this._saturation===0)return t.setRgbColor(`rgba(${this._lightness*255},${this._lightness*255},${this._lightness*255},${this._alpha*255})`),t.asRgbColor();let n;this._lightness<.5?n=this._lightness*(1+this._saturation):n=this._lightness+this._saturation-this._lightness*this._saturation;const r=2*this._lightness-n,s=this._hue/360,i=s+1/3,o=this.setColor(n,r,i),a=this.setColor(n,r,s),l=s-1/3,c=this.setColor(n,r,l);return t.setRgbColor(`rgba(${Math.round(o*255)},${Math.round(a*255)},${Math.round(c*255)},${this._alpha*255})`),t.asRgbColor()}getLightness(){return this._lightness}getHue(){return this._hue}getSaturation(){return this._saturation}getAlpha(){return this._alpha}setColor(t,n,r){r<0&&(r+=1),r>1&&(r-=1);let s;return 6*r<1?s=n+(t-n)*6*r:2*r<1?s=t:3*r<2?s=n+(t-n)*(2/3-r)*6:s=n,s}setLightness(t){this._lightness=t}}const _t=class _t extends Sn{constructor(n,r){super(r);p(this,"_cssString");p(this,"_red");p(this,"_green");p(this,"_blue");p(this,"_alpha");let s=n.match(_t.RGBA_EXTRACT);if(s){const i=+s[1],o=+s[2],a=+s[3],l=+s[4];this._cssString=n,this._red=i,this._green=o,this._blue=a,this._alpha=l;return}if(s=n.match(_t.RGB_EXTRACT),s){const i=+s[1],o=+s[2],a=+s[3];this._cssString=n,this._red=i,this._green=o,this._blue=a,this._alpha=1;return}throw new Error("Invalid rgba or rgb color")}asHexString(){return Sn.rgbColorToHexValue(this)}getRed(){let n=this._red+_t.RGB_COLOR_AMT;return n>255?n=255:n<0&&(n=0),n}getGreen(){let n=this._green+_t.RGB_COLOR_AMT;return n>255?n=255:n<0&&(n=0),n}getBlue(){let n=this._blue+_t.RGB_COLOR_AMT;return n>255?n=255:n<0&&(n=0),n}getAlpha(){return this._alpha}getColorType(){return Et.RGB}clone(){return new _t(this._cssString,this._builder)}asThemeColor(){throw new Error("rgb color not support to themeColor")}equals(n){return n instanceof _t?n._red===this._red&&n._blue===this._blue&&n._green===this._green&&n._alpha===this._alpha:!1}getCssString(){return this._cssString}};p(_t,"RGB_COLOR_AMT",0),p(_t,"RGBA_EXTRACT",new RegExp("\\s*rgba\\s*\\((\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d.\\d|\\d\\s*)\\)\\s*")),p(_t,"RGB_EXTRACT",new RegExp("\\s*rgb\\s*\\((\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d+\\s*)\\)\\s*"));let Ts=_t;const Zt=class Zt extends Sn{constructor(n,r,s,i){super(i);p(this,"_themeColorType");p(this,"_themeTint");p(this,"_themeColors");this._themeColorType=n,this._themeTint=r,this._themeColors=s}lumValue(n,r){if(n==null)return r;let s;return n<0?s=r*(1+n):s=r*(1-n)+(255-255*(1-n)),s}asRgbColor(){const n=_u[this._themeColors];if(n==null)throw new Error("not find themeColors type");const r=n[this._themeColorType];if(r==null)throw new Error("not find themeColors value");let s;if(Zt._cacheThemeColor.has(this._themeColors)){if(s=Zt._cacheThemeColor.get(this._themeColors),s.has(this._themeColorType))return s.get(this._themeColorType)}else s=new Map,Zt._cacheThemeColor.set(this._themeColors,s);const i=new pu(Sn.hexValueToRgbColor(r));i.setLightness(this.lumValue(this._themeTint,i.getLightness()*255)/255);const o=i.asRgbColor();return s.set(this._themeColorType,o),o}clone(){return new Zt(this._themeColorType,this._themeTint,this._themeColors,this._builder)}equals(n){return n instanceof Zt?n._themeColorType===this._themeColorType:!1}getColorType(){return Et.THEME}getThemeColorType(){return this._themeColorType}};p(Zt,"_cacheThemeColor",new Map);let ys=Zt;const K_="rgb(",X_="rgba(",Ui={aliceBlue:[240,248,255],antiqueWhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blancheAlmond:[255,235,205],blue:[0,0,255],blueViolet:[138,43,226],brown:[165,42,42],burlyWood:[222,184,135],cadetBlue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornFlowerBlue:[100,149,237],cornSilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkBlue:[0,0,139],darkCyan:[0,139,139],darkGoldenrod:[184,132,11],darkGray:[169,169,169],darkGreen:[0,100,0],darkGrey:[169,169,169],darkKhaki:[189,183,107],darkMagenta:[139,0,139],darkOliveGreen:[85,107,47],darkOrange:[255,140,0],darkOrchid:[153,50,204],darkRed:[139,0,0],darkSalmon:[233,150,122],darkSeaGreen:[143,188,143],darkSlateBlue:[72,61,139],darkSlateGray:[47,79,79],darkSlateGrey:[47,79,79],darkTurquoise:[0,206,209],darkViolet:[148,0,211],darkYellow:[139,128,0],deepPink:[255,20,147],deepSkyBlue:[0,191,255],dimGray:[105,105,105],dimGrey:[105,105,105],dodgerBlue:[30,144,255],firebrick:[178,34,34],floralWhite:[255,255,240],forestGreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostWhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenYellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotPink:[255,105,180],indianRed:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderBlush:[255,240,245],lawnGreen:[124,252,0],lemonChiffon:[255,250,205],lightblue:[173,216,230],lightCoral:[240,128,128],lightCyan:[224,255,255],lightGoldenrodYellow:[250,250,210],lightGray:[211,211,211],lightGreen:[144,238,144],lightGrey:[211,211,211],lightPink:[255,182,193],lightSalmon:[255,160,122],lightSeaGreen:[32,178,170],lightSkyBlue:[135,206,250],lightSlateGray:[119,136,153],lightSlateGrey:[119,136,153],lightSteelBlue:[176,196,222],lightYellow:[255,255,224],lime:[0,255,0],limeGreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumAquamarine:[102,205,170],mediumBlue:[0,0,205],mediumOrchid:[186,85,211],mediumPurple:[147,112,219],mediumSeaGreen:[60,179,113],mediumSlateBlue:[123,104,238],mediumSpringGreen:[0,250,154],mediumTurquoise:[72,209,204],mediumVioletRed:[199,21,133],midBightBlue:[25,25,112],mintCream:[245,255,250],mistyRose:[255,228,225],moccasin:[255,228,181],navajoWhite:[255,222,173],navy:[0,0,128],oldLace:[253,245,230],olive:[128,128,0],oliveDrab:[107,142,35],orange:[255,165,0],orangeRed:[255,69,0],orchid:[218,112,214],paleGoldenrod:[238,232,170],paleGreen:[152,251,152],paleTurquoise:[175,238,238],paleVioletRed:[219,112,147],papayaWhip:[255,239,213],peachPuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderBlue:[176,224,230],purple:[128,0,128],rebeccaPurple:[102,51,153],red:[255,0,0],rosyBrown:[188,143,143],royalBlue:[65,105,225],saddleBrown:[139,69,19],salmon:[250,128,114],sandyBrown:[244,164,96],seaGreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyBlue:[135,206,235],slateBlue:[106,90,205],slateGray:[119,128,144],slateGrey:[119,128,144],snow:[255,255,250],springGreen:[0,255,127],steelBlue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whiteSmoke:[245,245,245],yellow:[255,255,0],yellowGreen:[154,205,5]};class pt{constructor(t){p(this,"_color");p(this,"_rgbColor");p(this,"_isValid",!1);if(t==null){this._setNullColor();return}if(t instanceof pt){this._color={...t._color},this._rgbColor={...t._rgbColor};return}const n=Eu(t);if(n==null){this._setNullColor();return}this._color=n;const r=ep(this._color);if(r==null){this._setNullColor();return}this._rgbColor=r,this._isValid=!0}static mix(t,n,r){var c,u;r=Math.min(1,Math.max(0,r));const s=new pt(t).toRgb(),i=new pt(n).toRgb(),o=(c=s.a)!=null?c:1,a=(u=i.a)!=null?u:1,l={r:(i.r-s.r)*r+s.r,g:(i.g-s.g)*r+s.g,b:(i.b-s.b)*r+s.b,a:(a-o)*r+o};return new pt(l)}static getContrastRatio(t,n){const r=new pt(t).getLuminance(),s=new pt(n).getLuminance();return(Math.max(r,s)+.05)/(Math.min(r,s)+.05)}get isValid(){return this._isValid}toRgb(){return this._rgbColor}toRgbString(){const{r:t,g:n,b:r,a:s=1}=this.toRgb(),i=s<1;return`rgb${i?"a":""}(${t},${n},${r}${i?`,${s}`:""})`}toString(){return this.toRgbString()}toHexString(t){const{r:n,g:r,b:s,a:i=1}=this.toRgb(),o=i<1,a=[Jr(Math.round(n).toString(16)),Jr(Math.round(r).toString(16)),Jr(Math.round(s).toString(16)),Jr(Math.round(i*255).toString(16))];return t&&a[0][0]===a[0][1]&&a[1][0]===a[1][1]&&a[2][0]===a[2][1]&&a[3][0]===a[3][1]?o?`#${a[0][0]}${a[1][0]}${a[2][0]}${a[3][0]}`:`#${a[0][0]}${a[1][0]}${a[2][0]}`:o?`#${a[0]}${a[1]}${a[2]}${a[3]}`:`#${a[0]}${a[1]}${a[2]}`}toHsv(){return sp(this.toRgb())}toHsl(){return rp(this.toRgb())}lighten(t=10){const n=this.toHsl();return n.l+=t,n.l=Math.min(Math.max(n.l,0),100),new pt(n)}darken(t=10){const n=this.toHsl();return n.l-=t,n.l=Math.min(Math.max(n.l,0),100),new pt(n)}setAlpha(t){return new pt({...this._rgbColor,a:t})}getLuminance(){let{r:t,g:n,b:r}=this.toRgb();return t=di(t),n=di(n),r=di(r),Number((.2126*t+.7152*n+.0722*r).toFixed(3))}getBrightness(){const{r:t,g:n,b:r}=this.toRgb();return(t*299+n*587+r*114)/1e3}getAlpha(){var t;return(t=this._color.a)!=null?t:1}isDark(){return this.getBrightness()<128}isLight(){return!this.isDark()}_setNullColor(){this._isValid=!1,this._color={r:0,g:0,b:0,a:0},this._rgbColor={r:0,g:0,b:0,a:0}}}const Jr=e=>e.length===1?`0${e}`:e,di=e=>(e/=255,e<=.03928?e/12.92:((e+.055)/1.055)**2.4),Eu=e=>{if(op(e)){if("r"in e){const r={r:Math.round(e.r),g:Math.round(e.g),b:Math.round(e.b)};return e.a!==void 0&&(r.a=e.a),r}if("l"in e){const r={h:Math.round(e.h),s:e.s,l:e.l};return e.a!==void 0&&(r.a=e.a),r}const n={h:Math.round(e.h),s:e.s,v:e.v};return e.a!==void 0&&(n.a=e.a),n}const t=e.trim();if(Ui[t]){const n=Ui[t],r={r:Math.round(n[0]),g:Math.round(n[1]),b:Math.round(n[2])};return r.a=n[3]||1,r}if(t.startsWith("#"))return q_(t);if(t.startsWith("rgb"))return Z_(t);if(t.startsWith("hsl"))return J_(t);if(t.startsWith("hsv"))return Q_(t)},q_=e=>{const t=e.substring(1),n=new RegExp(`.{1,${t.length>=6?2:1}}`,"g");let r=t.match(n);if(!r||r.length<3)throw new Error(`The color '${e}' is illegal hex color`);r[0].length===1&&(r=r.map(i=>i+i));const s={r:Number.parseInt(r[0],16),g:Number.parseInt(r[1],16),b:Number.parseInt(r[2],16)};return r.length>3&&(s.a=Number.parseInt(r[3],16)/255),s},Z_=e=>{const t=e.indexOf("(");if(t===-1)throw new Error(`The color '${e}' is illegal rgb color`);const n=e.substring(t+1,e.length-1).split(",");if(n.length<3)throw new Error(`The color '${e}' is illegal rgb color`);const r={r:Number.parseInt(n[0],10),g:Number.parseInt(n[1],10),b:Number.parseInt(n[2],10)};return n.length>3&&(r.a=Number.parseFloat(n[3])),r},J_=e=>{const t=e.indexOf("(");if(t===-1)throw new Error(`The color '${e}' is illegal hsl color`);const n=e.substring(t+1,e.length-1).split(",");if(n.length<3)throw new Error(`The color '${e}' is illegal hsl color`);const r={h:Number.parseInt(n[0],10),s:Number.parseFloat(n[1]),l:Number.parseFloat(n[2])};return n.length>3&&(r.a=Number.parseFloat(n[3])),r},Q_=e=>{const t=e.indexOf("(");if(t===-1)throw new Error(`The color '${e}' is illegal hsv color`);const n=e.substring(t+1,e.length-1).split(",");if(n.length<3)throw new Error(`The color '${e}' is illegal hsv color`);const r={h:Number.parseInt(n[0],10),s:Number.parseFloat(n[1]),v:Number.parseFloat(n[2])};return n.length>3&&(r.a=Number.parseFloat(n[3])),r},ep=e=>{const t=Eu(e);if(t!=null)return"r"in t?t:"l"in t?tp(t):np(t)},fi=(e,t,n)=>(n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e),tp=e=>{let{h:t,s:n,l:r}=e;t/=360,n/=100,r/=100;let s=0,i=0,o=0;if(n===0)s=i=o=r;else{const l=r<.5?r*(1+n):r+n-r*n,c=2*r-l;s=fi(c,l,t+1/3),i=fi(c,l,t),o=fi(c,l,t-1/3)}const a={r:Math.round(s*255),g:Math.round(i*255),b:Math.round(o*255)};return e.a!==void 0&&(a.a=e.a),a},np=e=>{let{h:t,s:n,v:r}=e;t=t/360*6,n/=100,r/=100;const s=Math.floor(t),i=t-s,o=r*(1-n),a=r*(1-i*n),l=r*(1-(1-i)*n),c=s%6,u=[r,a,o,o,l,r][c],h=[l,r,r,a,o,o][c],d=[o,o,l,r,r,a][c],f={r:u*255,g:h*255,b:d*255};return e.a!==void 0&&(f.a=e.a),f},rp=e=>{let{r:t,g:n,b:r}=e;t/=255,n/=255,r/=255;const s=Math.max(t,n,r),i=Math.min(t,n,r),o=(s+i)/2;let a,l;if(s===i)a=l=0;else{const u=s-i;switch(l=o>.5?u/(2-s-i):u/(s+i),s){case t:a=(n-r)/u+(n<r?6:0);break;case n:a=(r-t)/u+2;break;default:a=(t-n)/u+4;break}a/=6}const c={h:Math.round(a*360),s:Math.round(l*100),l:Math.round(o*100)};return e.a!==void 0&&(c.a=e.a),c},sp=e=>{let{r:t,g:n,b:r}=e;t/=255,n/=255,r/=255;const s=Math.max(t,n,r),i=Math.min(t,n,r);let o;const a=s,l=s-i,c=s===0?0:l/s;if(s===i)o=0;else{switch(s){case t:o=(n-r)/l+(n<r?6:0);break;case n:o=(r-t)/l+2;break;default:o=(t-n)/l+4;break}o/=6}const u={h:Math.round(o*360),s:Math.round(c*100),v:Math.round(a*100)};return e.a!==void 0&&(u.a=e.a),u},ip=e=>e==null,op=e=>!ip(e)&&typeof e=="object";function ap(e){const t=/^#(?:[0]{3}|[0]{6})\b/,n=/^rgb\s*\(\s*0+\s*,\s*0+\s*,\s*0+\s*\)$/,r=/^rgba\s*\(\s*0+\s*,\s*0+\s*,\s*0+\s*,\s*(1|1\.0*|0?\.\d+)\)$/,s=/^hsl\s*\(\s*0*\s*,\s*0%*\s*,\s*0%*\s*\)$/,i=/^hsla\s*\(\s*0*\s*,\s*0%*\s*,\s*0%*\s*,\s*(1|1\.0*|0?\.\d+)\)$/;return!!(t.test(e)||n.test(e)||r.test(e)||s.test(e)||i.test(e))}function lp(e){const t=/^#(?:[Ff]{3}|[Ff]{6})\b/,n=/^rgb\s*\(\s*255\s*,\s*255\s*,\s*255\s*\)$/,r=/^rgba\s*\(\s*255\s*,\s*255\s*,\s*255\s*,\s*(1|1\.0*|0?\.\d+)\)$/,s=/^hsl\s*\(\s*0*\s*,\s*0%*\s*,\s*100%*\s*\)$/,i=/^hsla\s*\(\s*0*\s*,\s*0%*\s*,\s*100%*\s*,\s*(1|1\.0*|0?\.\d+)\)$/;return!!(t.test(e)||n.test(e)||r.test(e)||s.test(e)||i.test(e))}function Cu(e){return e&&(e.s!==void 0||e.p!==void 0||e.v!==void 0||e.t!==void 0||e.f!==void 0||e.si!==void 0||e.custom!==void 0)}function cp(e){if(e.t!==void 0)return e.t;if(typeof e.v=="string")return en.STRING;if(typeof e.v=="number")return en.NUMBER;if(typeof e.v=="boolean")return en.BOOLEAN}function up(e){if(e==null)return!0;const{v:t,f:n,si:r,p:s,custom:i}=e;return!(!(t==null||typeof t=="string"&&t.length===0)||n!=null&&n.length>0||r!=null&&r.length>0||s!=null||i!=null)}function Ru(e){return e!=null&&(typeof e=="string"||typeof e=="number"||typeof e=="boolean")}var _e=(e=>(e[e.NORMAL=0]="NORMAL",e[e.ROW=1]="ROW",e[e.COLUMN=2]="COLUMN",e[e.ALL=3]="ALL",e))(_e||{}),Ne=(e=>(e[e.NONE=0]="NONE",e[e.ROW=1]="ROW",e[e.COLUMN=2]="COLUMN",e[e.ALL=3]="ALL",e))(Ne||{});function hp(e){return[e.startRow,e.startColumn,e.endRow,e.endColumn]}var Iu=(e=>(e.NONE="none",e.BACKWARD="backward",e.FORWARD="forward",e))(Iu||{}),Su=(e=>(e.RECT="RECT",e.TEXT="TEXT",e))(Su||{});function dp(e,t,n){let r=!1,s=!1,i=e,o=t,a=e,l=t;if(n==null)return{actualRow:e,actualColumn:t,isMergedMainCell:s,isMerged:r,endRow:i,endColumn:o,startRow:a,startColumn:l};for(let c=0;c<n.length;c++){const{startRow:u,endRow:h,startColumn:d,endColumn:f}=n[c];if(e===u&&t===d){i=h,o=f,a=u,l=d,s=!0;break}if(e>=u&&e<=h&&t>=d&&t<=f){i=h,o=f,a=u,l=d,r=!0;break}}return{actualRow:e,actualColumn:t,isMergedMainCell:s,isMerged:r,endRow:i,endColumn:o,startRow:a,startColumn:l}}var Fn=(e=>(e.Raw="raw",e.Intercepted="intercepted",e.Both="both",e))(Fn||{});function fp(e,t){const n={};for(const r in e){const s=Number(r),i=e[s];for(const o in i){const a=Number(o),l=i[a],c=t(s,a,l);c!==void 0&&(n[s]?n[s][a]=c:n[s]={[a]:c})}}return n}function tn(e){let t=0;const n=Object.keys(e);for(const r of n){const s=Number(r);t=Math.max(t,s)}return t+1}function mp(e,t,n){const r=tn(n),s=n;for(let i=r-1;i>=e;i--)s[i+1]=s[i];s[e]=t}function Pi(e,t,n){const r=Object.keys(n).reduce((s,i)=>Math.max(s,Number.parseInt(i)),0)+1;for(let s=e;s<r;s++)s<e+t?delete n[s]:n[s]!==void 0&&(n[s-t]=n[s],delete n[s])}function gp(e,t){const n=e,r=Object.keys(n),s=r.length,i=t,o=Object.keys(i),a=o.length,l={};let c=0;for(let u=0;u<s;u++,c++){const h=r[u];l[c]=n[h]}for(let u=0;u<a;u++,c++){const h=o[u];l[c]=i[h]}return l}function _p(e,t,n){const r=n;if(tn(n)>0){const i={};let o=0;for(let a=e;a<=t;a++)r[a]&&(i[o]=r[a],o++);return i}return{}}function ki(e,t,n,r){const s=e>n;if(!s&&e+t>n)throw new Error("Invalid move operation");s?pp(e,t,n,r):Ep(e,t,n,r)}function pp(e,t,n,r){const s=r,i=[];for(let o=e;o<e+t;o++)i.push(s[o]);for(let o=e-1;o>=n;o--){const a=s[o];s[o+t]=a,a===void 0&&delete s[o+t]}i.forEach((o,a)=>{s[n+a]=o,o===void 0&&delete s[n+a]})}function Ep(e,t,n,r){const s=r,i=[];for(let o=e;o<e+t;o++)i.push(s[o]);for(let o=e+t;o<n;o++){const a=s[o];s[o-t]=a,a===void 0&&delete s[o-t]}i.forEach((o,a)=>{s[n+a-t]=o,o===void 0&&delete s[n+a-t]})}class dt{constructor(t={}){p(this,"_matrix");this._setOriginValue(t)}static MakeObjectMatrixSize(t){return new dt({[t-1]:{}})}getMatrix(){return this._matrix}forEach(t){const n=this._matrix,r=Object.keys(n);for(const s of r){const i=Number(s),o=n[i];if(t(i,o)===!1)return this}return this}forRow(t){const n=this._matrix,r=Object.keys(n);for(const s of r){const i=Number(s),o=n[i];if(t(i,Object.keys(o).map(l=>Number(l)))===!1)return this}return this}forValue(t){const n=this._matrix;for(const r in n){const s=Number(r),i=n[s];if(i)for(const o in i){const a=Number(o),l=i[a];if(t(s,a,l)===!1)return this}}return this}swapRow(t,n){const r=this._matrix[t],s=this._matrix[n];this._matrix[t]=s,this._matrix[n]=r}getRow(t){return this._matrix[t]}getRowOrCreate(t){let n=this.getRow(t);return n==null&&(n={},this._matrix[t]=n),n}reset(){this._setOriginValue({})}hasValue(){const t=this._matrix,n=Object.keys(t);if(n.length===0)return!1;for(const r of n){const s=Number(r),i=t[s];if(Object.keys(i).length>0)return!0}return!1}getValue(t,n){var r,s;return(s=(r=this._matrix)==null?void 0:r[t])==null?void 0:s[n]}setValue(t,n,r){const s=this.getRowOrCreate(t);s[n]=r}deleteValue(t,n){var r,s;(s=(r=this._matrix)==null?void 0:r[t])==null||delete s[n]}realDeleteValue(t,n){var r,s,i;if((s=(r=this._matrix)==null?void 0:r[t])==null||delete s[n],this.getRow(t)){const o=this.getRow(t);if(o==null)return;Object.keys(o).length===0&&((i=this._matrix)==null||delete i[t])}}setRow(t,n){this._matrix[t]=n}moveRows(t,n,r){ki(t,n,r,this._matrix)}moveColumns(t,n,r){this.forEach((s,i)=>{ki(t,n,r,i)})}insertRows(t,n){const r=Object.keys(this._matrix);for(let s=r.length-1;s>=0;s--){const i=Number(r[s]);if(i>=t){const o=this._matrix[i];delete this._matrix[i],this._matrix[i+n]=o}}}insertColumns(t,n){const r=Object.keys(this._matrix);for(let s=0;s<r.length;s++){const i=Number(r[s]),o=this._matrix[i],a=Object.keys(o);for(let l=a.length-1;l>=0;l--){const c=Number(a[l]);if(c>=t){const u=o[c];delete o[c],o[c+n]=u}}}}removeRows(t,n){Pi(t,n,this._matrix)}removeColumns(t,n){this.forEach((r,s)=>{s&&Pi(t,n,s)})}getFragment(t,n,r,s){const i=new dt;let o=0;for(let a=t;a<=n;a++){const l={};let c=0;for(let u=r;u<=s;u++){const h=this.getValue(a,u);l[c]=h,c++}i.setRow(o,l),o++}return i}getSlice(t,n,r,s){const i=new dt;for(let o=t;o<=n;o++)for(let a=r;a<=s;a++){const l=this.getValue(o,a);l&&i.setValue(o,a,Z.deepClone(l))}return i}getSizeOf(){return Object.keys(this._matrix).length}getLength(){return tn(this._matrix)}getRange(){const r=this.getLength()-1;let s=0;const i=this.getLength();for(let o=0;o<i;o++){const a=this.getRow(o);if(a){const l=tn(a)-1;s=l>s?l:s}}return{startRow:0,startColumn:0,endRow:r,endColumn:s}}toNativeArray(){const t=new Array;return this.forValue((n,r,s)=>{t.push(s)}),t}toArray(){const t=[];return this.forRow((n,r)=>{t[n]==null&&(t[n]=[]),r.forEach(s=>{t[n][s]=this.getValue(n,s)})}),t}toFullArray(){const t=this.getRange(),{endColumn:n,endRow:r}=t,s=[];for(let i=0;i<=r;i++){const o=new Array(n+1).fill(void 0);s.push(o)}return this.forValue((i,o,a)=>{s[i][o]=a}),s}toJSON(){return this._matrix}clone(){const t=JSON.stringify(this._matrix);return JSON.parse(t)}getData(){const t=JSON.stringify(this._matrix);return JSON.parse(t)}getArrayData(){let t=0,n=0,r=!1,s=!1;const i=new dt;return this.forEach((o,a)=>{r||(r=!0,t=o),Object.keys(a).forEach(l=>{const c=Number(l);s?c<n&&(n=c):(s=!0,n=c);const u=this.getValue(o,c);i.setValue(o-t,c-n,u)})}),i.getData()}getStartEndScope(){let t=1/0,n=-1/0,r=1/0,s=-1/0;const i=Object.keys(this._matrix);i.length>0&&(t=+i[0],n=+i[i.length-1]);for(const o of i){const a=Object.keys(this._matrix[o]);a.length>0&&(r=Math.min(r,+a[0]),s=Math.max(s,+a[a.length-1]))}return{startRow:t,endRow:n,startColumn:r,endColumn:s}}getDataRange(){let t=0,n=0,r=0,s=-1,i=!1,o=!1;return this.forEach((a,l)=>{if(i||(i=!0,t=a),l==null)return;const c=tn(l)-1;c>r&&(r=c),Object.keys(l).forEach(u=>{const h=Number(u);o?h<n&&(n=h):(o=!0,n=h)}),a>s&&(s=a)}),{startRow:t,startColumn:n,endRow:s,endColumn:r}}getDiscreteRanges(){const t=[];return this.forEach((n,r)=>{Object.keys(r).forEach(s=>{const i=Number(s);let o=!1;for(const a of t)if(n>=a.startRow&&n<=a.endRow+1&&i>=a.startColumn&&i<=a.endColumn+1){a.endRow=Math.max(n,a.endRow),a.endColumn=Math.max(i,a.endColumn),o=!0;break}o||t.push({startRow:n,endRow:n,startColumn:i,endColumn:i})})}),t}merge(t){this.forValue((n,r)=>{const s=t.getValue(n,r);s!=null&&this.setValue(n,r,s)})}_setOriginValue(t={}){this._matrix=t}}function Ou(e){const{actualRow:t,actualColumn:n,isMerged:r,isMergedMainCell:s,mergeInfo:i}=e;let{startY:o,endY:a,startX:l,endX:c}=e,u=t,h=n,d=t,f=n;if(r&&i){const{startRow:g,startColumn:_,endRow:R,endColumn:b,startY:F,endY:k,startX:W,endX:S}=i;u=g,h=_,d=R,f=b,o=F,a=k,l=W,c=S}return s&&(o=i.startY,a=i.endY,l=i.startX,c=i.endX,d=i.endRow,f=i.endColumn),{startRow:u,startColumn:h,endRow:d,endColumn:f,startY:o,endY:a,startX:l,endX:c}}const Cp=Ou;function Rp(e){if(!e)return;const{actualRow:t,actualColumn:n,isMerged:r,isMergedMainCell:s,startRow:i,startColumn:o,endRow:a,endColumn:l}=e;let c=t,u=n,h=t,d=n;return(r||s)&&(c=i,u=o,h=a,d=l),{startRow:c,startColumn:u,endRow:h,endColumn:d}}function vu(e){var n;return!e||(((n=e==null?void 0:e.v)==null?void 0:n.toString())||"").length===0&&!e.p}function Fi(e){return vu(e)&&(e==null?void 0:e.coverable)!==!1}function Dt(e){if(e){if(e.rgb)return new pt(e.rgb).toHexString();if(e.th)return new Vs().setThemeColor(e.th).asThemeColor().asRgbColor().getCssString()}return null}function wu(e){return Z.isString(e)&&e.substring(0,1)==="="&&e.length>1}function Ip(e){return Z.isString(e)&&e.length>0}function Sp(e,t=!1){var i;let n="";const r=new Map([["ff",()=>{e.ff&&(n+=`font-family: ${e.ff}; `)}],["fs",()=>{if(e.fs){let o=e.fs;e.va&&(o/=2),n+=`font-size: ${o}pt; `}}],["it",()=>{e.it&&(n+="font-style: italic; ")}],["bl",()=>{e.bl&&(n+="font-weight: bold; ")}],["ul",()=>{var o;(o=e.ul)!=null&&o.s&&(n.indexOf("text-decoration-line")>-1?n=n.replace(/(text-decoration-line:\s*[^;]+)(?=;)/g,(a,l)=>`${l} underline`):n+="text-decoration: underline; ",e.ul.cl&&n.indexOf("text-decoration-color")===-1&&(n+=`text-decoration-color: ${Dt(e.ul.cl)}; `),e.ul.t&&n.indexOf("text-decoration-style")===-1&&(n+=`text-decoration-style: ${e.ul.t} `))}],["st",()=>{var o;(o=e.st)!=null&&o.s&&(n.indexOf("text-decoration-line")>-1?n=n.replace(/(text-decoration-line:\s*[^;]+)(?=;)/g,(a,l)=>`${l} line-through`):n+="text-decoration-line: line-through; ",e.st.cl&&n.indexOf("text-decoration-color")===-1&&(n+=`text-decoration-color: ${Dt(e.st.cl)}; `),e.st.t&&n.indexOf("text-decoration-style")===-1&&(n+=`text-decoration-style: ${e.st.t} `))}],["ol",()=>{var o;(o=e.ol)!=null&&o.s&&(n.indexOf("text-decoration-line")>-1?n=n.replace(/(text-decoration-line:\s*[^;]+)(?=;)/g,(a,l)=>`${l} overline`):n+="text-decoration-line: overline; ",e.ol.cl&&n.indexOf("text-decoration-color")===-1&&(n+=`text-decoration-color: ${Dt(e.ol.cl)}; `),e.ol.t&&n.indexOf("text-decoration-style")===-1&&(n+=`text-decoration-style: ${e.ol.t} `))}],["bg",()=>{e.bg&&(n+=`background: ${Dt(e.bg)}; `)}],["bd",()=>{var o,a,l,c,u,h,d,f,g,_,R,b;(o=e.bd)!=null&&o.b&&(n+=`border-bottom: ${Qr((a=e.bd)==null?void 0:a.b.s)} ${(l=Dt(e.bd.b.cl))!=null?l:""}; `),(c=e.bd)!=null&&c.t&&(n+=`border-top: ${Qr((u=e.bd)==null?void 0:u.t.s)} ${(h=Dt(e.bd.t.cl))!=null?h:""}; `),(d=e.bd)!=null&&d.r&&(n+=`border-right: ${Qr((f=e.bd)==null?void 0:f.r.s)} ${(g=Dt(e.bd.r.cl))!=null?g:""}; `),(_=e.bd)!=null&&_.l&&(n+=`border-left: ${Qr((R=e.bd)==null?void 0:R.l.s)} ${(b=Dt(e.bd.l.cl))!=null?b:""}; `)}],["cl",()=>{e.cl&&(n+=`color: ${Dt(e.cl)}; `)}],["va",()=>{e.va===Yt.SUBSCRIPT?n+="vertical-align: sub; ":e.va===Yt.SUPERSCRIPT&&(n+="vertical-align: super; ")}],["td",()=>{e.td===Tr.LEFT_TO_RIGHT?n+="direction: ltr; ":e.td===Tr.RIGHT_TO_LEFT&&(n+="direction: rtl; ")}],["tr",()=>{var o,a,l;e.tr&&(n+=`--data-rotate: (${(o=e.tr)==null?void 0:o.a}deg${(a=e.tr)!=null&&a.v?` ,${(l=e.tr)==null?void 0:l.v}`:""});`)}],["ht",()=>{e.ht===Tt.LEFT?n+="text-align: left; ":e.ht===Tt.RIGHT?n+="text-align: right; ":e.ht===Tt.CENTER?n+="text-align: center; ":e.ht===Tt.JUSTIFIED&&(n+="text-align: justify; ")}],["vt",()=>{e.vt===_n.BOTTOM?n+="vertical-align: bottom; ":e.vt===_n.TOP?n+="vertical-align: top; ":e.vt===_n.MIDDLE&&(n+="vertical-align: middle; ")}],["tb",()=>{e.tb===In.CLIP?n+="white-space: nowrap; overflow-x: hidden; ":e.tb===In.WRAP&&(n+="white-space: normal;")}],["pd",()=>{var u,h,d,f,g,_,R,b;const o=`${(u=e.pd)==null?void 0:u.b}pt`,a=`${(h=e.pd)==null?void 0:h.t}pt`,l=`${(d=e.pd)==null?void 0:d.l}pt`,c=`${(f=e.pd)==null?void 0:f.r}pt`;(g=e.pd)!=null&&g.b&&(n+=`padding-bottom: ${o}; `),(_=e.pd)!=null&&_.t&&(n+=`padding-top: ${a}; `),(R=e.pd)!=null&&R.l&&(n+=`padding-left: ${l}; `),(b=e.pd)!=null&&b.r&&(n+=`padding-right: ${c}; `)}]]),s=["bd","tr","tb"];for(const o in e)t&&s.includes(o)||(i=r.get(o))==null||i();return n}function Qr(e){let t="";return e===De.NONE?t="none":e===De.THIN?t="0.5pt solid":e===De.HAIR?t="0.5pt double":e===De.DOTTED?t="0.5pt dotted":e===De.DASHED||e===De.DASH_DOT?t="0.5pt dashed":e===De.DASH_DOT_DOT?t="0.5pt dotted":e===De.DOUBLE?t="0.5pt double":e===De.MEDIUM?t="1pt solid":e===De.MEDIUM_DASHED||e===De.MEDIUM_DASH_DOT?t="1pt dashed":e===De.MEDIUM_DASH_DOT_DOT?t="1pt dotted":e===De.SLANT_DASH_DOT?t="0.5pt dashed":e===De.THICK&&(t="1.5pt solid"),t}function Op(e){let t=0;if(e=e.trim(),e==="none")t=De.NONE;else if(e==="0.5pt solid")t=De.THIN;else if(e==="0.5pt double")t=De.HAIR;else if(e==="0.5pt dotted")t=De.DOTTED;else if(e==="0.5pt dashed")t=De.DASHED;else if(e==="1pt solid")t=De.MEDIUM;else if(e==="1pt dashed")t=De.MEDIUM_DASHED;else if(e==="1pt dotted")t=De.MEDIUM_DASH_DOT_DOT;else if(e==="1.5pt solid")t=De.THICK;else if(!e.includes("none"))t=De.THIN;else return De.NONE;return t}function vp(e,t){let n=e.body;if(t){const{headers:r,footers:s}=e;r!=null&&r[t]?n=r[t].body:s!=null&&s[t]&&(n=s[t].body)}return n}function wp(e,t){const{startRow:n,endRow:r,startColumn:s,endColumn:i,rangeType:o}=e;if(n<0||s<0||r<0||i<0||!(Number.isNaN(n)&&Number.isNaN(r))&&o===_e.COLUMN||!(Number.isNaN(s)&&Number.isNaN(i))&&o===_e.ROW||o!==_e.ROW&&o!==_e.COLUMN&&(Number.isNaN(s)||Number.isNaN(n)||Number.isNaN(i)||Number.isNaN(r)))return!1;if(t){const a=t.getRowCount(),l=t.getColumnCount();if(r>=a||i>=l)return!1}return!0}function bp(e,t){return{startRow:e,endRow:e,startColumn:t,endColumn:t}}function Bi(e){return wu(e)?{f:e,v:null,p:null}:Ru(e)?{v:e,p:null,f:null}:(Cu(e),e)}function Ap(e,t){const n=new dt,{startRow:r,startColumn:s,endRow:i,endColumn:o}=t;if(Z.isArray(e))for(let a=0;a<=i-r;a++)for(let l=0;l<=o-s;l++)n.setValue(a+r,l+s,Bi(e[a][l]));else new dt(e).forValue((l,c,u)=>{n.setValue(l,c,Bi(u))});return n.getMatrix()}function Io(e,t){return Object.prototype.toString.call(e)===Object.prototype.toString.call(t)?Object.prototype.toString.call(e)==="[object Object]"||Object.prototype.toString.call(e)==="[object Array]"?Object.keys(e).length!==Object.keys(t).length?!1:Object.keys(e).every(n=>Io(e[n],t[n])):e===t:!1}function bu(e,t){const n=e.ts||{},r=t.ts||{};return e.sId!==t.sId?!1:Io(n,r)}function Tp(e,t){return t.some(n=>e.indexOf(n)>-1)}var us={exports:{}},yp=us.exports,Ya;function Np(){return Ya||(Ya=1,(function(e,t){(function(n,r){e.exports=r()})(yp,(function(){var n=1e3,r=6e4,s=36e5,i="millisecond",o="second",a="minute",l="hour",c="day",u="week",h="month",d="quarter",f="year",g="date",_="Invalid Date",R=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,b=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,F={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(N){var A=["th","st","nd","rd"],v=N%100;return"["+N+(A[(v-20)%10]||A[v]||A[0])+"]"}},k=function(N,A,v){var y=String(N);return!y||y.length>=A?N:""+Array(A+1-y.length).join(v)+N},W={s:k,z:function(N){var A=-N.utcOffset(),v=Math.abs(A),y=Math.floor(v/60),M=v%60;return(A<=0?"+":"-")+k(y,2,"0")+":"+k(M,2,"0")},m:function N(A,v){if(A.date()<v.date())return-N(v,A);var y=12*(v.year()-A.year())+(v.month()-A.month()),M=A.clone().add(y,h),L=v-M<0,P=A.clone().add(y+(L?-1:1),h);return+(-(y+(v-M)/(L?M-P:P-M))||0)},a:function(N){return N<0?Math.ceil(N)||0:Math.floor(N)},p:function(N){return{M:h,y:f,w:u,d:c,D:g,h:l,m:a,s:o,ms:i,Q:d}[N]||String(N||"").toLowerCase().replace(/s$/,"")},u:function(N){return N===void 0}},S="en",C={};C[S]=F;var w="$isDayjsObject",T=function(N){return N instanceof x||!(!N||!N[w])},B=function N(A,v,y){var M;if(!A)return S;if(typeof A=="string"){var L=A.toLowerCase();C[L]&&(M=L),v&&(C[L]=v,M=L);var P=A.split("-");if(!M&&P.length>1)return N(P[0])}else{var J=A.name;C[J]=A,M=J}return!y&&M&&(S=M),M||!y&&S},$=function(N,A){if(T(N))return N.clone();var v=typeof A=="object"?A:{};return v.date=N,v.args=arguments,new x(v)},m=W;m.l=B,m.i=T,m.w=function(N,A){return $(N,{locale:A.$L,utc:A.$u,x:A.$x,$offset:A.$offset})};var x=(function(){function N(v){this.$L=B(v.locale,null,!0),this.parse(v),this.$x=this.$x||v.x||{},this[w]=!0}var A=N.prototype;return A.parse=function(v){this.$d=(function(y){var M=y.date,L=y.utc;if(M===null)return new Date(NaN);if(m.u(M))return new Date;if(M instanceof Date)return new Date(M);if(typeof M=="string"&&!/Z$/i.test(M)){var P=M.match(R);if(P){var J=P[2]-1||0,V=(P[7]||"0").substring(0,3);return L?new Date(Date.UTC(P[1],J,P[3]||1,P[4]||0,P[5]||0,P[6]||0,V)):new Date(P[1],J,P[3]||1,P[4]||0,P[5]||0,P[6]||0,V)}}return new Date(M)})(v),this.init()},A.init=function(){var v=this.$d;this.$y=v.getFullYear(),this.$M=v.getMonth(),this.$D=v.getDate(),this.$W=v.getDay(),this.$H=v.getHours(),this.$m=v.getMinutes(),this.$s=v.getSeconds(),this.$ms=v.getMilliseconds()},A.$utils=function(){return m},A.isValid=function(){return this.$d.toString()!==_},A.isSame=function(v,y){var M=$(v);return this.startOf(y)<=M&&M<=this.endOf(y)},A.isAfter=function(v,y){return $(v)<this.startOf(y)},A.isBefore=function(v,y){return this.endOf(y)<$(v)},A.$g=function(v,y,M){return m.u(v)?this[y]:this.set(M,v)},A.unix=function(){return Math.floor(this.valueOf()/1e3)},A.valueOf=function(){return this.$d.getTime()},A.startOf=function(v,y){var M=this,L=!!m.u(y)||y,P=m.p(v),J=function(H,j){var Q=m.w(M.$u?Date.UTC(M.$y,j,H):new Date(M.$y,j,H),M);return L?Q:Q.endOf(c)},V=function(H,j){return m.w(M.toDate()[H].apply(M.toDate("s"),(L?[0,0,0,0]:[23,59,59,999]).slice(j)),M)},oe=this.$W,le=this.$M,I=this.$D,D="set"+(this.$u?"UTC":"");switch(P){case f:return L?J(1,0):J(31,11);case h:return L?J(1,le):J(0,le+1);case u:var Y=this.$locale().weekStart||0,G=(oe<Y?oe+7:oe)-Y;return J(L?I-G:I+(6-G),le);case c:case g:return V(D+"Hours",0);case l:return V(D+"Minutes",1);case a:return V(D+"Seconds",2);case o:return V(D+"Milliseconds",3);default:return this.clone()}},A.endOf=function(v){return this.startOf(v,!1)},A.$set=function(v,y){var M,L=m.p(v),P="set"+(this.$u?"UTC":""),J=(M={},M[c]=P+"Date",M[g]=P+"Date",M[h]=P+"Month",M[f]=P+"FullYear",M[l]=P+"Hours",M[a]=P+"Minutes",M[o]=P+"Seconds",M[i]=P+"Milliseconds",M)[L],V=L===c?this.$D+(y-this.$W):y;if(L===h||L===f){var oe=this.clone().set(g,1);oe.$d[J](V),oe.init(),this.$d=oe.set(g,Math.min(this.$D,oe.daysInMonth())).$d}else J&&this.$d[J](V);return this.init(),this},A.set=function(v,y){return this.clone().$set(v,y)},A.get=function(v){return this[m.p(v)]()},A.add=function(v,y){var M,L=this;v=Number(v);var P=m.p(y),J=function(le){var I=$(L);return m.w(I.date(I.date()+Math.round(le*v)),L)};if(P===h)return this.set(h,this.$M+v);if(P===f)return this.set(f,this.$y+v);if(P===c)return J(1);if(P===u)return J(7);var V=(M={},M[a]=r,M[l]=s,M[o]=n,M)[P]||1,oe=this.$d.getTime()+v*V;return m.w(oe,this)},A.subtract=function(v,y){return this.add(-1*v,y)},A.format=function(v){var y=this,M=this.$locale();if(!this.isValid())return M.invalidDate||_;var L=v||"YYYY-MM-DDTHH:mm:ssZ",P=m.z(this),J=this.$H,V=this.$m,oe=this.$M,le=M.weekdays,I=M.months,D=M.meridiem,Y=function(j,Q,ee,U){return j&&(j[Q]||j(y,L))||ee[Q].slice(0,U)},G=function(j){return m.s(J%12||12,j,"0")},H=D||function(j,Q,ee){var U=j<12?"AM":"PM";return ee?U.toLowerCase():U};return L.replace(b,(function(j,Q){return Q||(function(ee){switch(ee){case"YY":return String(y.$y).slice(-2);case"YYYY":return m.s(y.$y,4,"0");case"M":return oe+1;case"MM":return m.s(oe+1,2,"0");case"MMM":return Y(M.monthsShort,oe,I,3);case"MMMM":return Y(I,oe);case"D":return y.$D;case"DD":return m.s(y.$D,2,"0");case"d":return String(y.$W);case"dd":return Y(M.weekdaysMin,y.$W,le,2);case"ddd":return Y(M.weekdaysShort,y.$W,le,3);case"dddd":return le[y.$W];case"H":return String(J);case"HH":return m.s(J,2,"0");case"h":return G(1);case"hh":return G(2);case"a":return H(J,V,!0);case"A":return H(J,V,!1);case"m":return String(V);case"mm":return m.s(V,2,"0");case"s":return String(y.$s);case"ss":return m.s(y.$s,2,"0");case"SSS":return m.s(y.$ms,3,"0");case"Z":return P}return null})(j)||P.replace(":","")}))},A.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},A.diff=function(v,y,M){var L,P=this,J=m.p(y),V=$(v),oe=(V.utcOffset()-this.utcOffset())*r,le=this-V,I=function(){return m.m(P,V)};switch(J){case f:L=I()/12;break;case h:L=I();break;case d:L=I()/3;break;case u:L=(le-oe)/6048e5;break;case c:L=(le-oe)/864e5;break;case l:L=le/s;break;case a:L=le/r;break;case o:L=le/n;break;default:L=le}return M?L:m.a(L)},A.daysInMonth=function(){return this.endOf(h).$D},A.$locale=function(){return C[this.$L]},A.locale=function(v,y){if(!v)return this.$L;var M=this.clone(),L=B(v,y,!0);return L&&(M.$L=L),M},A.clone=function(){return m.w(this.$d,this)},A.toDate=function(){return new Date(this.valueOf())},A.toJSON=function(){return this.isValid()?this.toISOString():null},A.toISOString=function(){return this.$d.toISOString()},A.toString=function(){return this.$d.toUTCString()},N})(),O=x.prototype;return $.prototype=O,[["$ms",i],["$s",o],["$m",a],["$H",l],["$W",c],["$M",h],["$y",f],["$D",g]].forEach((function(N){O[N[1]]=function(A){return this.$g(A,N[0],N[1])}})),$.extend=function(N,A){return N.$i||(N(A,x,$),N.$i=!0),$},$.locale=B,$.isDayjs=T,$.unix=function(N){return $(1e3*N)},$.en=C[S],$.Ls=C,$.p={},$}))})(us)),us.exports}var Mp=Np();const zt=St(Mp);var hs={exports:{}},Lp=hs.exports,Ga;function Dp(){return Ga||(Ga=1,(function(e,t){(function(n,r){e.exports=r()})(Lp,(function(){return function(n,r){var s=r.prototype,i=s.format;s.format=function(o){var a=this,l=this.$locale();if(!this.isValid())return i.bind(this)(o);var c=this.$utils(),u=(o||"YYYY-MM-DDTHH:mm:ssZ").replace(/\[([^\]]+)]|Q|wo|ww|w|WW|W|zzz|z|gggg|GGGG|Do|X|x|k{1,2}|S/g,(function(h){switch(h){case"Q":return Math.ceil((a.$M+1)/3);case"Do":return l.ordinal(a.$D);case"gggg":return a.weekYear();case"GGGG":return a.isoWeekYear();case"wo":return l.ordinal(a.week(),"W");case"w":case"ww":return c.s(a.week(),h==="w"?1:2,"0");case"W":case"WW":return c.s(a.isoWeek(),h==="W"?1:2,"0");case"k":case"kk":return c.s(String(a.$H===0?24:a.$H),h==="k"?1:2,"0");case"X":return Math.floor(a.$d.getTime()/1e3);case"x":return a.$d.getTime();case"z":return"["+a.offsetName()+"]";case"zzz":return"["+a.offsetName("long")+"]";default:return h}}));return i.bind(this)(u)}}}))})(hs)),hs.exports}var xp=Dp();const Up=St(xp);var ds={exports:{}},Pp=ds.exports,Va;function kp(){return Va||(Va=1,(function(e,t){(function(n,r){e.exports=r()})(Pp,(function(){var n={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},r=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|Q|YYYY|YY?|ww?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,s=/\d/,i=/\d\d/,o=/\d\d?/,a=/\d*[^-_:/,()\s\d]+/,l={},c=function(R){return(R=+R)+(R>68?1900:2e3)},u=function(R){return function(b){this[R]=+b}},h=[/[+-]\d\d:?(\d\d)?|Z/,function(R){(this.zone||(this.zone={})).offset=(function(b){if(!b||b==="Z")return 0;var F=b.match(/([+-]|\d\d)/g),k=60*F[1]+(+F[2]||0);return k===0?0:F[0]==="+"?-k:k})(R)}],d=function(R){var b=l[R];return b&&(b.indexOf?b:b.s.concat(b.f))},f=function(R,b){var F,k=l.meridiem;if(k){for(var W=1;W<=24;W+=1)if(R.indexOf(k(W,0,b))>-1){F=W>12;break}}else F=R===(b?"pm":"PM");return F},g={A:[a,function(R){this.afternoon=f(R,!1)}],a:[a,function(R){this.afternoon=f(R,!0)}],Q:[s,function(R){this.month=3*(R-1)+1}],S:[s,function(R){this.milliseconds=100*+R}],SS:[i,function(R){this.milliseconds=10*+R}],SSS:[/\d{3}/,function(R){this.milliseconds=+R}],s:[o,u("seconds")],ss:[o,u("seconds")],m:[o,u("minutes")],mm:[o,u("minutes")],H:[o,u("hours")],h:[o,u("hours")],HH:[o,u("hours")],hh:[o,u("hours")],D:[o,u("day")],DD:[i,u("day")],Do:[a,function(R){var b=l.ordinal,F=R.match(/\d+/);if(this.day=F[0],b)for(var k=1;k<=31;k+=1)b(k).replace(/\[|\]/g,"")===R&&(this.day=k)}],w:[o,u("week")],ww:[i,u("week")],M:[o,u("month")],MM:[i,u("month")],MMM:[a,function(R){var b=d("months"),F=(d("monthsShort")||b.map((function(k){return k.slice(0,3)}))).indexOf(R)+1;if(F<1)throw new Error;this.month=F%12||F}],MMMM:[a,function(R){var b=d("months").indexOf(R)+1;if(b<1)throw new Error;this.month=b%12||b}],Y:[/[+-]?\d+/,u("year")],YY:[i,function(R){this.year=c(R)}],YYYY:[/\d{4}/,u("year")],Z:h,ZZ:h};function _(R){var b,F;b=R,F=l&&l.formats;for(var k=(R=b.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,(function($,m,x){var O=x&&x.toUpperCase();return m||F[x]||n[x]||F[O].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(function(N,A,v){return A||v.slice(1)}))}))).match(r),W=k.length,S=0;S<W;S+=1){var C=k[S],w=g[C],T=w&&w[0],B=w&&w[1];k[S]=B?{regex:T,parser:B}:C.replace(/^\[|\]$/g,"")}return function($){for(var m={},x=0,O=0;x<W;x+=1){var N=k[x];if(typeof N=="string")O+=N.length;else{var A=N.regex,v=N.parser,y=$.slice(O),M=A.exec(y)[0];v.call(m,M),$=$.replace(M,"")}}return(function(L){var P=L.afternoon;if(P!==void 0){var J=L.hours;P?J<12&&(L.hours+=12):J===12&&(L.hours=0),delete L.afternoon}})(m),m}}return function(R,b,F){F.p.customParseFormat=!0,R&&R.parseTwoDigitYear&&(c=R.parseTwoDigitYear);var k=b.prototype,W=k.parse;k.parse=function(S){var C=S.date,w=S.utc,T=S.args;this.$u=w;var B=T[1];if(typeof B=="string"){var $=T[2]===!0,m=T[3]===!0,x=$||m,O=T[2];m&&(O=T[2]),l=this.$locale(),!$&&O&&(l=F.Ls[O]),this.$d=(function(y,M,L,P){try{if(["x","X"].indexOf(M)>-1)return new Date((M==="X"?1e3:1)*y);var J=_(M)(y),V=J.year,oe=J.month,le=J.day,I=J.hours,D=J.minutes,Y=J.seconds,G=J.milliseconds,H=J.zone,j=J.week,Q=new Date,ee=le||(V||oe?1:Q.getDate()),U=V||Q.getFullYear(),z=0;V&&!oe||(z=oe>0?oe-1:Q.getMonth());var X,ne=I||0,me=D||0,pe=Y||0,K=G||0;return H?new Date(Date.UTC(U,z,ee,ne,me,pe,K+60*H.offset*1e3)):L?new Date(Date.UTC(U,z,ee,ne,me,pe,K)):(X=new Date(U,z,ee,ne,me,pe,K),j&&(X=P(X).week(j).toDate()),X)}catch{return new Date("")}})(C,B,w,F),this.init(),O&&O!==!0&&(this.$L=this.locale(O).$L),x&&C!=this.format(B)&&(this.$d=new Date("")),l={}}else if(B instanceof Array)for(var N=B.length,A=1;A<=N;A+=1){T[1]=B[A-1];var v=F.apply(this,T);if(v.isValid()){this.$d=v.$d,this.$L=v.$L,this.init();break}A===N&&(this.$d=new Date(""))}else W.call(this,S)}}}))})(ds)),ds.exports}var Fp=kp();const Bp=St(Fp);var fs={exports:{}},$p=fs.exports,za;function Hp(){return za||(za=1,(function(e,t){(function(n,r){e.exports=r()})($p,(function(){return function(n,r,s){var i=r.prototype,o=function(h){return h&&(h.indexOf?h:h.s)},a=function(h,d,f,g,_){var R=h.name?h:h.$locale(),b=o(R[d]),F=o(R[f]),k=b||F.map((function(S){return S.slice(0,g)}));if(!_)return k;var W=R.weekStart;return k.map((function(S,C){return k[(C+(W||0))%7]}))},l=function(){return s.Ls[s.locale()]},c=function(h,d){return h.formats[d]||(function(f){return f.replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(function(g,_,R){return _||R.slice(1)}))})(h.formats[d.toUpperCase()])},u=function(){var h=this;return{months:function(d){return d?d.format("MMMM"):a(h,"months")},monthsShort:function(d){return d?d.format("MMM"):a(h,"monthsShort","months",3)},firstDayOfWeek:function(){return h.$locale().weekStart||0},weekdays:function(d){return d?d.format("dddd"):a(h,"weekdays")},weekdaysMin:function(d){return d?d.format("dd"):a(h,"weekdaysMin","weekdays",2)},weekdaysShort:function(d){return d?d.format("ddd"):a(h,"weekdaysShort","weekdays",3)},longDateFormat:function(d){return c(h.$locale(),d)},meridiem:this.$locale().meridiem,ordinal:this.$locale().ordinal}};i.localeData=function(){return u.bind(this)()},s.localeData=function(){var h=l();return{firstDayOfWeek:function(){return h.weekStart||0},weekdays:function(){return s.weekdays()},weekdaysShort:function(){return s.weekdaysShort()},weekdaysMin:function(){return s.weekdaysMin()},months:function(){return s.months()},monthsShort:function(){return s.monthsShort()},longDateFormat:function(d){return c(h,d)},meridiem:h.meridiem,ordinal:h.ordinal}},s.months=function(){return a(l(),"months")},s.monthsShort=function(){return a(l(),"monthsShort","months",3)},s.weekdays=function(h){return a(l(),"weekdays",null,null,h)},s.weekdaysShort=function(h){return a(l(),"weekdaysShort","weekdays",3,h)},s.weekdaysMin=function(h){return a(l(),"weekdaysMin","weekdays",2,h)}}}))})(fs)),fs.exports}var jp=Hp();const Wp=St(jp);var ms={exports:{}},Yp=ms.exports,Ka;function Gp(){return Ka||(Ka=1,(function(e,t){(function(n,r){e.exports=r()})(Yp,(function(){var n={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};return function(r,s,i){var o=s.prototype,a=o.format;i.en.formats=n,o.format=function(l){l===void 0&&(l="YYYY-MM-DDTHH:mm:ssZ");var c=this.$locale().formats,u=(function(h,d){return h.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,(function(f,g,_){var R=_&&_.toUpperCase();return g||d[_]||n[_]||d[R].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(function(b,F,k){return F||k.slice(1)}))}))})(l,c===void 0?{}:c);return a.call(this,u)}}}))})(ms)),ms.exports}var Vp=Gp();const zp=St(Vp);var gs={exports:{}},Kp=gs.exports,Xa;function Xp(){return Xa||(Xa=1,(function(e,t){(function(n,r){e.exports=r()})(Kp,(function(){var n="minute",r=/[+-]\d\d(?::?\d\d)?/g,s=/([+-]|\d\d)/g;return function(i,o,a){var l=o.prototype;a.utc=function(_){var R={date:_,utc:!0,args:arguments};return new o(R)},l.utc=function(_){var R=a(this.toDate(),{locale:this.$L,utc:!0});return _?R.add(this.utcOffset(),n):R},l.local=function(){return a(this.toDate(),{locale:this.$L,utc:!1})};var c=l.parse;l.parse=function(_){_.utc&&(this.$u=!0),this.$utils().u(_.$offset)||(this.$offset=_.$offset),c.call(this,_)};var u=l.init;l.init=function(){if(this.$u){var _=this.$d;this.$y=_.getUTCFullYear(),this.$M=_.getUTCMonth(),this.$D=_.getUTCDate(),this.$W=_.getUTCDay(),this.$H=_.getUTCHours(),this.$m=_.getUTCMinutes(),this.$s=_.getUTCSeconds(),this.$ms=_.getUTCMilliseconds()}else u.call(this)};var h=l.utcOffset;l.utcOffset=function(_,R){var b=this.$utils().u;if(b(_))return this.$u?0:b(this.$offset)?h.call(this):this.$offset;if(typeof _=="string"&&(_=(function(S){S===void 0&&(S="");var C=S.match(r);if(!C)return null;var w=(""+C[0]).match(s)||["-",0,0],T=w[0],B=60*+w[1]+ +w[2];return B===0?0:T==="+"?B:-B})(_),_===null))return this;var F=Math.abs(_)<=16?60*_:_;if(F===0)return this.utc(R);var k=this.clone();if(R)return k.$offset=F,k.$u=!1,k;var W=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();return(k=this.local().add(F+W,n)).$offset=F,k.$x.$localOffset=W,k};var d=l.format;l.format=function(_){var R=_||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return d.call(this,R)},l.valueOf=function(){var _=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*_},l.isUTC=function(){return!!this.$u},l.toISOString=function(){return this.toDate().toISOString()},l.toString=function(){return this.toDate().toUTCString()};var f=l.toDate;l.toDate=function(_){return _==="s"&&this.$offset?a(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():f.call(this)};var g=l.diff;l.diff=function(_,R,b){if(_&&this.$u===_.$u)return g.call(this,_,R,b);var F=this.local(),k=a(_).local();return g.call(F,k,R,b)}}}))})(gs)),gs.exports}var qp=Xp();const Zp=St(qp);var _s={exports:{}},Jp=_s.exports,qa;function Qp(){return qa||(qa=1,(function(e,t){(function(n,r){e.exports=r()})(Jp,(function(){return function(n,r){r.prototype.weekday=function(s){var i=this.$locale().weekStart||0,o=this.$W,a=(o<i?o+7:o)-i;return this.$utils().u(s)?a:this.subtract(a,"day").add(s,"day")}}}))})(_s)),_s.exports}var eE=Qp();const tE=St(eE);var ps={exports:{}},nE=ps.exports,Za;function rE(){return Za||(Za=1,(function(e,t){(function(n,r){e.exports=r()})(nE,(function(){var n="week",r="year";return function(s,i,o){var a=i.prototype;a.week=function(l){if(l===void 0&&(l=null),l!==null)return this.add(7*(l-this.week()),"day");var c=this.$locale().yearStart||1;if(this.month()===11&&this.date()>25){var u=o(this).startOf(r).add(1,r).date(c),h=o(this).endOf(n);if(u.isBefore(h))return 1}var d=o(this).startOf(r).date(c).startOf(n).subtract(1,"millisecond"),f=this.diff(d,n,!0);return f<0?o(this).startOf("week").week():Math.ceil(f)},a.weeks=function(l){return l===void 0&&(l=null),this.week(l)}}}))})(ps)),ps.exports}var sE=rE();const iE=St(sE);var Es={exports:{}},oE=Es.exports,Ja;function aE(){return Ja||(Ja=1,(function(e,t){(function(n,r){e.exports=r()})(oE,(function(){return function(n,r){r.prototype.weekYear=function(){var s=this.month(),i=this.week(),o=this.year();return i===1&&s===11?o+1:s===0&&i>=52?o-1:o}}}))})(Es)),Es.exports}var lE=aE();const cE=St(lE);zt.extend(Bp);zt.extend(Up);zt.extend(tE);zt.extend(Wp);zt.extend(iE);zt.extend(cE);zt.extend(Zp);zt.extend(zp);function zs(e,t,n,r){if(e>t)throw new Error("a1 should be less than a2");if(n>r)throw new Error("b1 should be less than b2");if(t<n||r<e)return[e,t];if(n<=e&&r>=t)return[];const s=r-n+1;return e<n&&t>r?[e,t-s]:n<=e&&r<t?[r+1-s,t-s]:n>e&&r>=t?[e,n-1]:[e,t]}function uE(e){if(e==null)return!1;const t=e.bullet;return(t==null?void 0:t.listId)!=null}function hE(e){if(e==null)return!1;const t=e.paragraphStyle;return Au(t)}function Au(e){var t;return!(e==null||(e.indentStart==null||e.indentStart.v===0)&&e.hanging==null||((t=e.hanging)==null?void 0:t.v)===0)}function Tu(e,t,n){return e.slice(0,t)+n+e.slice(t)}function yu(e,t,n){return t>n?e:e.slice(0,t)+e.slice(n)}function dE(e){if(e==null||typeof e=="boolean")return!1;if(typeof e=="number")return!isNaN(e);if(typeof e=="string"){const t=e.trim();return t===""?!1:!isNaN(Number(t))}return!1}function fE(e){let t=0;for(let n=0;n<e.length;n++)t=e.charCodeAt(n)+(t<<6)+(t<<16)-t;return t>>>0}function mE(...e){let t;return e.length===1&&Array.isArray(e[0])?t=e[0]:t=e,Hs({},...t)}const Le=Symbol("newer"),Je=Symbol("older");class gE{constructor(t){p(this,"entry");this.entry=t}[Symbol.iterator](){return this}next(){const t=this.entry;return t?(this.entry=t[Le],{done:!1,value:t.key}):{done:!0,value:void 0}}}class _E{constructor(t){p(this,"entry");this.entry=t}[Symbol.iterator](){return this}next(){const t=this.entry;return t?(this.entry=t[Le],{done:!1,value:t.value}):{done:!0,value:void 0}}}class pE{constructor(t){p(this,"entry");this.entry=t}[Symbol.iterator](){return this}next(){const t=this.entry;return t?(this.entry=t[Le],{done:!1,value:[t.key,t.value]}):{done:!0,value:void 0}}}var Tl,yl;yl=Le,Tl=Je;class Qa{constructor(t,n){p(this,"key");p(this,"value");p(this,yl);p(this,Tl);this.key=t,this.value=n,this[Le]=void 0,this[Je]=void 0}toJSON(){return{key:this.key,value:this.value}}}class yr{constructor(...t){p(this,"_keymap");p(this,"size",0);p(this,"limit");p(this,"oldest");p(this,"newest");p(this,"_onShiftListeners",[]);if(ur.hasLength(t,1)){if(ur.isNumber(t[0])){const n=t[0];this._initialize(n,void 0);return}if(ur.isIterable(t[0])){const n=t[0];this._initialize(0,n);return}return}if(ur.hasLength(t,2)){const n=t[0],r=t[1];this._initialize(n,r)}}onShift(t){if(this._onShiftListeners.indexOf(t)===-1)return this._onShiftListeners.push(t),We(()=>Ur(this._onShiftListeners,t));throw new Error("[LRUMap]: the listener has been registered!")}_initialize(t,n){this.oldest=void 0,this.newest=void 0,this.size=0,this.limit=t,this._keymap=new Map,n&&(this.assign(n),t<1&&(this.limit=this.size))}_markEntryAsUsed(t){t!==this.newest&&(t[Le]&&(t===this.oldest&&(this.oldest=t[Le]),t[Le][Je]=t[Je]),t[Je]&&(t[Je][Le]=t[Le]),t[Le]=void 0,t[Je]=this.newest,this.newest&&(this.newest[Le]=t),this.newest=t)}assign(t){let n,r=this.limit||Number.MAX_VALUE;this._keymap.clear();const s=t[Symbol.iterator]();for(let i=s.next();!i.done;i=s.next()){const o=new Qa(i.value[0],i.value[1]);if(this._keymap.set(o.key,o),n?(n[Le]=o,o[Je]=n):this.oldest=o,n=o,r--===0)throw new Error("overflow")}this.newest=n,this.size=this._keymap.size}set(t,n){let r=this._keymap.get(t);return r?(r.value=n,this._markEntryAsUsed(r),this):(this._keymap.set(t,r=new Qa(t,n)),this.newest?(this.newest[Le]=r,r[Je]=this.newest):this.oldest=r,this.newest=r,++this.size,this.size>this.limit&&this.shift(),this)}shift(){const t=this.oldest;if(t)return this.oldest&&this.oldest[Le]?(this.oldest=this.oldest[Le],this.oldest[Je]=void 0):(this.oldest=void 0,this.newest=void 0),t[Le]=t[Je]=void 0,this._keymap.delete(t.key),--this.size,this._onShiftListeners.forEach(n=>n(t)),[t.key,t.value]}get(t){const n=this._keymap.get(t);if(n)return this._markEntryAsUsed(n),n.value}has(t){return this._keymap.has(t)}find(t){const n=this._keymap.get(t);return n?n.value:void 0}delete(t){const n=this._keymap.get(t);if(n)return this._keymap.delete(n.key),n[Le]&&n[Je]?(n[Je][Le]=n[Le],n[Le][Je]=n[Je]):n[Le]?(n[Le][Je]=void 0,this.oldest=n[Le]):n[Je]?(n[Je][Le]=void 0,this.newest=n[Je]):this.oldest=this.newest=void 0,this.size--,n.value}clear(){this.oldest=void 0,this.newest=void 0,this.size=0,this._keymap.clear()}keys(){return new gE(this.oldest)}values(){return new _E(this.oldest)}entries(){return this[Symbol.iterator]()}[Symbol.iterator](){return new pE(this.oldest)}forEach(t,n){typeof n!="object"&&(n=this);let r=this.oldest;for(;r;)t.call(n,r.value,r.key,this),r=r[Le]}toJSON(){const t=new Array(this.size);let n=0,r=this.oldest;for(;r;)t[n++]={key:r.key,value:r.value},r=r[Le];return t}toString(){let t="",n=this.oldest;for(;n;)t+=`${String(n.key)}:${n.value}`,n=n[Le],n&&(t+=" < ");return t}}class ur{static hasLength(t,n){return t.length===n}static getValueType(t){return Object.prototype.toString.apply(t)}static isObject(t){return this.getValueType(t)==="[object Object]"}static isIterable(t){return t[Symbol.iterator]!=null}static isNumber(t){return this.getValueType(t)==="[object Number]"}}const hr=2,dr=2**2,Cs=2**3,fr=2**4,mr=2**5,gr=2**6,$i=2**7,Hi=2**8,ji=2**9,EE=0,CE=2958466,RE=-694324,IE=35830291,SE=-1,el=1,Yn=6,So="general",Oo="hash",Gn="zero",vo="qmark",wo="slash",Nr="group",Ns="scale",bo="comma",Ao="break",Ks="text",To="plus",yo="minus",Ms="point",No="space",Mo="percent",Xs="digit",Lo="calendar",Mr="error",Do="datetime",xo="duration",Uo="condition",Po="dbnum",ko="natnum",Fo="locale",Bo="color",Nu="modifier",$o="ampm",Ho="escaped",jo="string",Wo="skip",Yo="exp",Go="fill",Vo="paren",qs="char",OE=["#000","#FFF","#F00","#0F0","#00F","#FF0","#F0F","#0FF","#000","#FFF","#F00","#0F0","#00F","#FF0","#F0F","#0FF","#800","#080","#008","#880","#808","#088","#CCC","#888","#99F","#936","#FFC","#CFF","#606","#F88","#06C","#CCF","#008","#F0F","#FF0","#0FF","#808","#800","#088","#00F","#0CF","#CFF","#CFC","#FF9","#9CF","#F9C","#C9F","#FC9","#36F","#3CC","#9C0","#FC0"],Wi=["¤","$","£","¥","֏","؋","৳","฿","៛","₡","₦","₩","₪","₫","€","₭","₮","₱","₲","₴","₸","₹","₺","₼","₽","₾","₿"],Yi=new RegExp("["+Wi.join("")+"]"),mi=Object.freeze({1078:"af",1052:"sq",1118:"am",5121:"ar_DZ",15361:"ar_BH",3073:"ar_EG",2049:"ar_IQ",11265:"ar_JO",13313:"ar_KW",12289:"ar_LB",4097:"ar_LY",6145:"ar_MA",8193:"ar_OM",16385:"ar_QA",1025:"ar_SA",10241:"ar_SY",7169:"ar_TN",14337:"ar_AE",9217:"ar_YE",1067:"hy",1101:"as",2092:"az_AZ",1068:"az_AZ",1069:"eu",1059:"be",2117:"bn",1093:"bn_IN",5146:"bs",1026:"bg",1109:"my",1027:"ca",2052:"zh_CN",3076:"zh_HK",5124:"zh_MO",4100:"zh_SG",1028:"zh_TW",1050:"hr",1029:"cs",1030:"da",1125:"dv",2067:"nl_BE",1043:"nl_NL",1126:"bin",3081:"en_AU",10249:"en_BZ",4105:"en_CA",9225:"en_CB",2057:"en_GB",16393:"en_IN",6153:"en_IE",8201:"en_JM",5129:"en_NZ",13321:"en_PH",7177:"en_ZA",11273:"en_TT",1033:"en_US",12297:"en_ZW",1061:"et",1071:"mk",1080:"fo",1065:"fa",1124:"fil",1035:"fi",2060:"fr_BE",11276:"fr_CM",3084:"fr_CA",9228:"fr_CG",12300:"fr_CI",1036:"fr_FR",5132:"fr_LU",13324:"fr_ML",6156:"fr_MC",14348:"fr_MA",10252:"fr_SN",4108:"fr_CH",7180:"fr",1122:"fy_NL",2108:"gd_IE",1084:"gd",1110:"gl",1079:"ka",3079:"de_AT",1031:"de_DE",5127:"de_LI",4103:"de_LU",2055:"de_CH",1032:"el",1140:"gn",1095:"gu",1279:"en",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig_NG",1057:"id",1040:"it_IT",2064:"it_CH",1041:"ja",1099:"kn",1120:"ks",1087:"kk",1107:"km",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1142:"la",1062:"lv",1063:"lt",2110:"ms_BN",1086:"ms_MY",1100:"ml",1082:"mt",1112:"mni",1153:"mi",1102:"mr",1104:"mn",2128:"mn",1121:"ne",1044:"no_NO",2068:"no_NO",1096:"or",1045:"pl",1046:"pt_BR",2070:"pt_PT",1094:"pa",1047:"rm",2072:"ro_MO",1048:"ro_RO",1049:"ru",2073:"ru_MO",1083:"se",1103:"sa",3098:"sr_SP",2074:"sr_SP",1072:"st",1074:"tn",1113:"sd",1115:"si",1051:"sk",1060:"sl",1143:"so",1070:"sb",11274:"es_AR",16394:"es_BO",13322:"es_CL",9226:"es_CO",5130:"es_CR",7178:"es_DO",12298:"es_EC",17418:"es_SV",4106:"es_GT",18442:"es_HN",2058:"es_MX",19466:"es_NI",6154:"es_PA",15370:"es_PY",10250:"es_PE",20490:"es_PR",1034:"es_ES",14346:"es_UY",8202:"es_VE",1089:"sw",2077:"sv_FI",1053:"sv_SE",1114:"syc",1064:"tg",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1073:"ts",1055:"tr",1090:"tk",1058:"uk",1056:"ur",2115:"uz_UZ",1091:"uz_UZ",1075:"ve",1066:"vi",1106:"cy",1076:"xh",1085:"yi",1077:"zu"}),Mu=/^([a-z\d]+)(?:[_-]([a-z\d]+))?(?:\.([a-z\d]+))?(?:@([a-z\d]+))?$/i,Bn={},E=(e,t="")=>e.replace(/~/g,t).split(";"),Pe=(e,t=0,n=0)=>(e.mmm||(e.mmm=t<1?e.mmmm.concat():e.mmmm.map(r=>{const s=r.slice(0,t%10);return s+(t<10||r===s?"":".")})),e.ddd||(e.ddd=n<1?e.dddd.concat():e.dddd.map(r=>{const s=r.slice(0,n%10);return s+(n<10||r===s?"":".")})),!e.mmm6&&e.mmmm6&&(e.mmm6=e.mmmm6),e),vE={group:" ",decimal:".",positive:"+",negative:"-",percent:"%",exponent:"E",nan:"NaN",infinity:"∞",ampm:E("AM;PM"),mmmm6:E("Muharram;Safar;Rabiʻ I;Rabiʻ II;Jumada I;Jumada II;Rajab;Shaʻban;Ramadan;Shawwal;Dhuʻl-Qiʻdah;Dhuʻl-Hijjah"),mmm6:E("Muh.;Saf.;Rab. I;Rab. II;Jum. I;Jum. II;Raj.;Sha.;Ram.;Shaw.;Dhuʻl-Q.;Dhuʻl-H."),mmmm:E("January;February;March;April;May;June;July;August;September;October;November;December"),mmm:E("Jan;Feb;Mar;Apr;May;Jun;Jul;Aug;Sep;Oct;Nov;Dec"),dddd:E("Sunday;Monday;Tuesday;Wednesday;Thursday;Friday;Saturday"),ddd:E("Sun;Mon;Tue;Wed;Thu;Fri;Sat"),bool:E("TRUE;FALSE"),preferMDY:!1};function zo(e){const t=Mu.exec(e);if(!t)throw new SyntaxError(`Malformed locale: ${e}`);return{lang:t[1]+(t[2]?"_"+t[2]:""),language:t[1],territory:t[2]||""}}function Ko(e){if(typeof e=="number")return mi[e&65535]||null;const t=parseInt(e,16);return isFinite(t)&&mi[t&65535]?mi[t&65535]||null:Mu.test(e)?e:null}function Qn(e){const t=Ko(e);let n=null;if(t){const r=zo(t);n=Bn[r.lang]||Bn[r.language]||null}return n}function Gi(e){return Object.assign({},vE,e)}function te(e,t){const n=typeof t=="object"?t:zo(t);return Bn[n.lang]=Gi(e),n.language!==n.lang&&!Bn[n.language]&&(Bn[n.language]=Gi(e)),Bn[n.lang]}const sn=Gi({group:",",preferMDY:!0});sn.isDefault=!0;te({group:",",ampm:E("上午;下午"),mmmm:E("一月;二月;三月;四月;五月;六月;七月;八月;九月;十月;十一月;十二月"),mmm:E("1月;2月;3月;4月;5月;6月;7月;8月;9月;10月;11月;12月"),dddd:E("~日;~一;~二;~三;~四;~五;~六","星期"),ddd:E("周日;周一;周二;周三;周四;周五;周六")},"zh_CN");const Xo={group:",",ampm:E("上午;下午"),mmmm:E("1月;2月;3月;4月;5月;6月;7月;8月;9月;10月;11月;12月"),mmm:E("1月;2月;3月;4月;5月;6月;7月;8月;9月;10月;11月;12月"),dddd:E("~日;~一;~二;~三;~四;~五;~六","星期"),ddd:E("周日;周一;周二;周三;周四;周五;周六")};te({...Xo,nan:"非數值",dddd:E("~日;~一;~二;~三;~四;~五;~六","星期")},"zh_TW");te({...Xo,dddd:E("~日;~一;~二;~三;~四;~五;~六","星期")},"zh_HK");te({...Xo,ampm:E("午前;午後"),dddd:E("日~;月~;火~;水~;木~;金~;土~","曜日"),ddd:E("日;月;火;水;木;金;土")},"ja");te({group:",",ampm:E("오전;오후"),mmmm:E("1월;2월;3월;4월;5월;6월;7월;8월;9월;10월;11월;12월"),mmm:E("1월;2월;3월;4월;5월;6월;7월;8월;9월;10월;11월;12월"),dddd:E("일요일;월요일;화요일;수요일;목요일;금요일;토요일"),ddd:E("일;월;화;수;목;금;토")},"ko");te({group:",",ampm:E("ก่อนเที่ยง;หลังเที่ยง"),mmmm:E("มกร~;กุมภาพันธ์;มีน~;เมษายน;พฤษภ~;มิถุนายน;กรกฎ~;สิงห~;กันยายน;ตุล~;พฤศจิกายน;ธันว~","าคม"),mmm:E("ม.ค.;ก.พ.;มี.ค.;เม.ย.;พ.ค.;มิ.ย.;ก.ค.;ส.ค.;ก.ย.;ต.ค.;พ.ย.;ธ.ค."),dddd:E("วันอาทิตย์;วันจันทร์;วันอังคาร;วันพุธ;วันพฤหัสบดี;วันศุกร์;วันเสาร์"),ddd:E("อา.;จ.;อ.;พ.;พฤ.;ศ.;ส.")},"th");te(Pe({decimal:",",ampm:E("dop.;odp."),mmmm:E("ledna;února;března;dubna;května;června;července;srpna;září;října;listopadu;prosince"),mmm:E("I;II;III;IV;V;VI;VII;VIII;IX;X;XI;XII"),dddd:E("neděle;pondělí;úterý;středa;čtvrtek;pátek;sobota"),bool:E("PRAVDA;NEPRAVDA")},-1,2),"cs");te(Pe({group:".",decimal:",",mmmm:E("januar;februar;marts;april;maj;juni;juli;august;september;oktober;november;december"),dddd:E("søn~;man~;tirs~;ons~;tors~;fre~;lør~","dag"),bool:E("SAND;FALSK")},13,13),"da");te(Pe({group:".",decimal:",",ampm:E("a.m.;p.m."),mmmm:E("januari;februari;maart;april;mei;juni;juli;augustus;september;oktober;november;december"),mmm:E("jan.;feb.;mrt.;apr.;mei;jun.;jul.;aug.;sep.;okt.;nov.;dec."),dddd:E("zondag;maandag;dinsdag;woensdag;donderdag;vrijdag;zaterdag"),bool:E("WAAR;ONWAAR")},-1,2),"nl");te({group:",",preferMDY:!0},"en");te({group:",",preferMDY:!0},"en_US");te({group:","},"en_AU");te({group:","},"en_CA");te({group:","},"en_GB");te({group:",",mmm:E("Jan;Feb;Mar;Apr;May;Jun;Jul;Aug;Sept;Oct;Nov;Dec")},"en_IE");te(Pe({decimal:",",nan:"epäluku",ampm:E("ap.;ip."),mmmm:E("tammi~;helmi~;maalis~;huhti~;touko~;kesä~;heinä~;elo~;syys~;loka~;marras~;joulu~","kuuta"),mmm:E("tammik.;helmik.;maalisk.;huhtik.;toukok.;kesäk.;heinäk.;elok.;syysk.;lokak.;marrask.;jouluk."),dddd:E("sunnun~;maanan~;tiis~;keskiviikkona;tors~;perjan~;lauan~","taina"),bool:E("TOSI;EPÄTOSI")},-1,2),"fi");const qo=Pe({group:" ",decimal:",",mmmm:E("janvier;février;mars;avril;mai;juin;juillet;août;septembre;octobre;novembre;décembre"),mmm:E("janv.;févr.;mars;avr.;mai;juin;juil.;août;sept.;oct.;nov.;déc."),dddd:E("~manche;lun~;mar~;mercre~;jeu~;vendre~;same~","di"),bool:E("VRAI;FAUX")},-1,13);te({...qo},"fr");te({...qo,mmm:E("janv.;févr.;mars;avr.;mai;juin;juill.;août;sept.;oct.;nov.;déc.")},"fr_CA");te({group:"'",decimal:".",...qo},"fr_CH");const Lu=Pe({mmmm:E("Januar;Februar;März;April;Mai;Juni;Juli;August;September;Oktober;November;Dezember"),mmm:E("Jan.;Feb.;März;Apr.;Mai;Juni;Juli;Aug.;Sept.;Okt.;Nov.;Dez."),dddd:E("Sonn~;Mon~;Diens~;Mittwoch;Donners~;Frei~;Sams~","tag"),bool:E("WAHR;FALSCH")},-1,12);te({group:".",decimal:",",...Lu},"de");te({group:"'",decimal:".",...Lu},"de_CH");te(Pe({group:".",decimal:",",ampm:E("π.μ.;μ.μ."),mmmm:E("Ιανουαρ~;Φεβρουαρ~;Μαρτ~;Απριλ~;Μαΐου;Ιουν~;Ιουλ~;Αυγούστου;Σεπτεμβρ~;Οκτωβρ~;Νοεμβρ~;Δεκεμβρ~","ίου"),mmm:E("Ιαν;Φεβ;Μαρ;Απρ;Μαΐ;Ιουν;Ιουλ;Αυγ;Σεπ;Οκτ;Νοε;Δεκ"),dddd:E("Κυριακή;Δευτέρα;Τρίτη;Τετάρτη;Πέμπτη;Παρασκευή;Σάββατο")},-1,3),"el");te({decimal:",",ampm:E("de.;du."),mmmm:E("január;február;március;április;május;június;július;augusztus;szeptember;október;november;december"),mmm:E("jan.;febr.;márc.;ápr.;máj.;jún.;júl.;aug.;szept.;okt.;nov.;dec."),dddd:E("vasárnap;hétfő;kedd;szerda;csütörtök;péntek;szombat"),ddd:E("V;H;K;Sze;Cs;P;Szo"),bool:E("IGAZ;HAMIS")},"hu");te(Pe({group:".",decimal:",",ampm:E("f.h.;e.h."),mmmm:E("janúar;febrúar;mars;apríl;maí;júní;júlí;ágúst;september;október;nóvember;desember"),dddd:E("sunnu~;mánu~;þriðju~;miðviku~;fimmtu~;föstu~;laugar~","dagur")},13,13),"is");te(Pe({group:".",decimal:",",mmmm:E("Januari;Februari;Maret;April;Mei;Juni;Juli;Agustus;September;Oktober;November;Desember"),dddd:E("Minggu;Senin;Selasa;Rabu;Kamis;Jumat;Sabtu")},3,3),"id");const Du=Pe({mmmm:E("gennaio;febbraio;marzo;aprile;maggio;giugno;luglio;agosto;settembre;ottobre;novembre;dicembre"),dddd:E("domenica;lunedì;martedì;mercoledì;giovedì;venerdì;sabato"),bool:E("VERO;FALSO")},3,3);te({group:".",decimal:",",...Du},"it");te({group:"'",decimal:".",...Du},"it_CH");const xu={decimal:",",ampm:E("a.m.;p.m."),mmmm:E("januar;februar;mars;april;mai;juni;juli;august;september;oktober;november;desember"),mmm:E("jan.;feb.;mar.;apr.;mai;jun.;jul.;aug.;sep.;okt.;nov.;des."),dddd:E("søn~;man~;tirs~;ons~;tors~;fre~;lør~","dag"),bool:E("SANN;USANN")};te(Pe({...xu},-1,13),"nb");te(Pe({...xu},-1,13),"no");te(Pe({decimal:",",mmmm:E("stycznia;lutego;marca;kwietnia;maja;czerwca;lipca;sierpnia;września;października;listopada;grudnia"),dddd:E("niedziela;poniedziałek;wtorek;środa;czwartek;piątek;sobota"),ddd:E("niedz.;pon.;wt.;śr.;czw.;pt.;sob."),bool:E("PRAWDA;FAŁSZ")},3,-1),"pl");const Uu={group:".",decimal:",",mmmm:E("janeiro;fevereiro;março;abril;maio;junho;julho;agosto;setembro;outubro;novembro;dezembro"),dddd:E("domingo;segunda-feira;terça-feira;quarta-feira;quinta-feira;sexta-feira;sábado"),bool:E("VERDADEIRO;FALSO")};te(Pe(Uu,13,13),"pt");te(Pe(Uu,13,13),"pt_BR");te({decimal:",",nan:"не число",mmmm:E("января;февраля;марта;апреля;мая;июня;июля;августа;сентября;октября;ноября;декабря"),mmm:E("янв.;февр.;мар.;апр.;мая;июн.;июл.;авг.;сент.;окт.;нояб.;дек."),dddd:E("воскресенье;понедельник;вторник;среда;четверг;пятница;суббота"),ddd:E("вс;пн;вт;ср;чт;пт;сб"),mmmm6:E("рамадан;шавваль;зуль-каада;зуль-хиджжа;мухаррам;раби-уль-авваль;раби-уль-ахир;джумад-уль-авваль;джумад-уль-ахир;раджаб;шаабан;рамадан"),mmm6:E("рам.;шав.;зуль-к.;зуль-х.;мух.;раб. I;раб. II;джум. I;джум. II;радж.;шааб.;рам."),bool:E("ИСТИНА;ЛОЖЬ")},"ru");te(Pe({decimal:",",mmmm:E("januára;februára;marca;apríla;mája;júna;júla;augusta;septembra;októbra;novembra;decembra"),dddd:E("nedeľa;pondelok;utorok;streda;štvrtok;piatok;sobota")},3,2),"sk");const Ft={group:".",decimal:",",ampm:E("a. m.;p. m."),mmmm:E("enero;febrero;marzo;abril;mayo;junio;julio;agosto;septiem~;octu~;noviem~;diciem~","bre"),mmm:E("ene;feb;mar;abr;may;jun;jul;ago;sept;oct;nov;dic"),dddd:E("domingo;lunes;martes;miércoles;jueves;viernes;sábado"),ddd:E("dom;lun;mar;mié;jue;vie;sáb"),bool:E("VERDADERO;FALSO")},wE=E("ene;feb;mar;abr;may;jun;jul;ago;sep;oct;nov;dic"),Zo=E("ene.;feb.;mar.;abr.;may.;jun.;jul.;ago.;sept.;oct.;nov.;dic.");te({...Ft},"es");te({...Ft},"es_AR");te({...Ft},"es_BO");te({...Ft},"es_CL");te({...Ft},"es_CO");te({...Ft},"es_EC");te({...Ft,mmm:wE,ampm:E("a.m.;p.m.")},"es_MX");te({...Ft,mmm:Zo},"es_PY");te({...Ft,mmm:Zo},"es_UY");te({...Ft,mmm:Zo,mmmm:E("enero;febrero;marzo;abril;mayo;junio;julio;agosto;setiembre;octubre;noviembre;diciembre")},"es_VE");te({decimal:",",ampm:E("fm;em"),mmmm:E("januari;februari;mars;april;maj;juni;juli;augusti;september;oktober;november;december"),mmm:E("jan.;feb.;mars;apr.;maj;juni;juli;aug.;sep.;okt.;nov.;dec."),dddd:E("sön~;mån~;tis~;ons~;tors~;fre~;lör~","dag"),ddd:E("sön;mån;tis;ons;tors;fre;lör")},"sv");te(Pe({group:".",decimal:",",ampm:E("ÖÖ;ÖS"),mmmm:E("Ocak;Şubat;Mart;Nisan;Mayıs;Haziran;Temmuz;Ağustos;Eylül;Ekim;Kasım;Aralık"),mmm:E("Oca;Şub;Mar;Nis;May;Haz;Tem;Ağu;Eyl;Eki;Kas;Ara"),dddd:E("Pazar;Pazartesi;Salı;Çarşamba;Perşembe;Cuma;Cumartesi"),ddd:E("Paz;Pzt;Sal;Çar;Per;Cum;Cmt"),bool:E("DOĞRU;YANLIŞ")},3,-1),"tr");te({group:",",ampm:E("yb;yh"),mmmm:E("Ionawr;Chwefror;Mawrth;Ebrill;Mai;Mehefin;Gorffennaf;Awst;Medi;Hydref;Tachwedd;Rhagfyr"),mmm:E("Ion;Chwef;Maw;Ebr;Mai;Meh;Gorff;Awst;Medi;Hyd;Tach;Rhag"),dddd:E("Dydd Sul;Dydd Llun;Dydd Mawrth;Dydd Mercher;Dydd Iau;Dydd Gwener;Dydd Sadwrn"),ddd:E("Sul;Llun;Maw;Mer;Iau;Gwen;Sad")},"cy");te({group:".",decimal:",",mmmm:E("yanvar;fevral;mart;aprel;may;iyun;iyul;avqust;sentyabr;oktyabr;noyabr;dekabr"),mmm:E("yan;fev;mar;apr;may;iyn;iyl;avq;sen;okt;noy;dek"),dddd:E("bazar;bazar ertəsi;çərşənbə axşamı;çərşənbə;cümə axşamı;cümə;şənbə"),ddd:E("B.;B.e.;Ç.a.;Ç.;C.a.;C.;Ş.")},"az");te(Pe({decimal:",",mmmm:E("студзеня;лютага;сакавіка;красавіка;мая;чэрвеня;ліпеня;жніўня;верасня;кастрычніка;лістапада;снежня"),dddd:E("нядзеля;панядзелак;аўторак;серада;чацвер;пятніца;субота"),ddd:E("нд;пн;аў;ср;чц;пт;сб")},3,-1),"be");te({decimal:",",ampm:E("пр.об.;сл.об."),mmmm:E("януари;февруари;март;април;май;юни;юли;август;септември;октомври;ноември;декември"),mmm:E("яну;фев;март;апр;май;юни;юли;авг;сеп;окт;ное;дек"),dddd:E("неделя;понеделник;вторник;сряда;четвъртък;петък;събота"),ddd:E("нд;пн;вт;ср;чт;пт;сб"),bool:E("ИСТИНА;ЛОЖЬ")},"bg");te({group:".",decimal:",",mmmm:E("de gener;de febrer;de març;d’abril;de maig;de juny;de juliol;d’agost;de setembre;d’octubre;de novembre;de desembre"),mmm:E("de gen.;de febr.;de març;d’abr.;de maig;de juny;de jul.;d’ag.;de set.;d’oct.;de nov.;de des."),dddd:E("diumenge;dilluns;dimarts;dimecres;dijous;divendres;dissabte"),ddd:E("dg.;dl.;dt.;dc.;dj.;dv.;ds."),ampm:E("a. m.;p. m.")},"ca");te(Pe({group:",",decimal:".",mmmm:E("Enero;Pebrero;Marso;Abril;Mayo;Hunyo;Hulyo;Agosto;Setyembre;Oktubre;Nobyembre;Disyembre"),dddd:E("Linggo;Lunes;Martes;Miyerkules;Huwebes;Biyernes;Sabado")},3,3),"fil");te({group:",",decimal:".",mmmm:E("જાન્યુઆરી;ફેબ્રુઆરી;માર્ચ;એપ્રિલ;મે;જૂન;જુલાઈ;ઑગસ્ટ;સપ્ટેમ્બર;ઑક્ટોબર;નવેમ્બર;ડિસેમ્બર"),mmm:E("જાન્યુ;ફેબ્રુ;માર્ચ;એપ્રિલ;મે;જૂન;જુલાઈ;ઑગસ્ટ;સપ્ટે;ઑક્ટો;નવે;ડિસે"),dddd:E("રવિ~;સોમ~;મંગળ~;બુધ~;ગુરુ~;શુક્ર~;શનિ~","વાર"),ddd:E("રવિ;સોમ;મંગળ;બુધ;ગુરુ;શુક્ર;શનિ")},"gu");te({group:",",decimal:".",ampm:E("לפנה״צ;אחה״צ"),dddd:E("~ראשון;~שני;~שלישי;~רביעי;~חמישי;~שישי;~שבת","יום "),ddd:E("~א׳;~ב׳;~ג׳;~ד׳;~ה׳;~ו׳;שבת","יום "),mmmm:E("ינואר;פברואר;מרץ;אפריל;מאי;יוני;יולי;אוגוסט;ספטמבר;אוקטובר;נובמבר;דצמבר"),mmm:E("ינו׳;פבר׳;מרץ;אפר׳;מאי;יוני;יולי;אוג׳;ספט׳;אוק׳;נוב׳;דצמ׳"),mmmm6:E("רמדאן;שוואל;ד׳ו אל־קעדה;ד׳ו אל־חיג׳ה;מוחרם;רביע אל־אוול;רביע א־ת׳אני;ג׳ומאדא אל־אולא;ג׳ומאדא א־ת׳אניה;רג׳ב;שעבאן;רמדאן"),mmm6:E("רמדאן;שוואל;ד׳ו אל־קעדה;ד׳ו אל־חיג׳ה;מוחרם;רביע א׳;רביע ב׳;ג׳ומאדא א׳;ג׳ומאדא ב׳;רג׳ב;שעבאן;רמדאן")},"he");te(Pe({group:".",decimal:",",mmmm:E("siječnja;veljače;ožujka;travnja;svibnja;lipnja;srpnja;kolovoza;rujna;listopada;studenoga;prosinca"),mmm:E("sij;velj;ožu;tra;svi;lip;srp;kol;ruj;lis;stu;pro"),dddd:E("nedjelja;ponedjeljak;utorak;srijeda;četvrtak;petak;subota")},-1,3),"hr");te({decimal:",",mmmm:E("հունվարի;փետրվարի;մարտի;ապրիլի;մայիսի;հունիսի;հուլիսի;օգոստոսի;սեպտեմբերի;հոկտեմբերի;նոյեմբերի;դեկտեմբերի"),mmm:E("հնվ;փտվ;մրտ;ապր;մյս;հնս;հլս;օգս;սեպ;հոկ;նոյ;դեկ"),dddd:E("կիրակի;երկուշաբթի;երեքշաբթի;չորեքշաբթի;հինգշաբթի;ուրբաթ;շաբաթ"),ddd:E("կիր;երկ;երք;չրք;հնգ;ուր;շբթ")},"hy");te(Pe({decimal:",",mmmm:E("იანვარი;თებერვალი;მარტი;აპრილი;მაისი;ივნისი;ივლისი;აგვისტო;სექტემბერი;ოქტომბერი;ნოემბერი;დეკემბერი"),dddd:E("კვირა;ორშაბათი;სამშაბათი;ოთხშაბათი;ხუთშაბათი;პარასკევი;შაბათი")},3,3),"ka");te(Pe({decimal:",",mmmm:E("қаңтар;ақпан;наурыз;сәуір;мамыр;маусым;шілде;тамыз;қыркүйек;қазан;қараша;желтоқсан"),dddd:E("жексенбі;дүйсенбі;сейсенбі;сәрсенбі;бейсенбі;жұма;сенбі"),ddd:E("жс;дс;сс;ср;бс;жм;сб")},13,-1),"kk");te({group:",",mmmm:E("ಜನವರಿ;ಫೆಬ್ರವರಿ;ಮಾರ್ಚ್;ಏಪ್ರಿಲ್;ಮೇ;ಜೂನ್;ಜುಲೈ;ಆಗಸ್ಟ್;ಸೆಪ್ಟೆಂಬರ್;ಅಕ್ಟೋಬರ್;ನವೆಂಬರ್;ಡಿಸೆಂಬರ್"),mmm:E("ಜನವರಿ;ಫೆಬ್ರವರಿ;ಮಾರ್ಚ್;ಏಪ್ರಿ;ಮೇ;ಜೂನ್;ಜುಲೈ;ಆಗಸ್ಟ್;ಸೆಪ್ಟೆಂ;ಅಕ್ಟೋ;ನವೆಂ;ಡಿಸೆಂ"),dddd:E("ಭಾನು~;ಸೋಮ~;ಮಂಗಳ~;ಬುಧ~;ಗುರು~;ಶುಕ್ರ~;ಶನಿ~","ವಾರ"),ddd:E("ಭಾನು;ಸೋಮ;ಮಂಗಳ;ಬುಧ;ಗುರು;ಶುಕ್ರ;ಶನಿ"),ampm:E("ಪೂರ್ವಾಹ್ನ;ಅಪರಾಹ್ನ")},"kn");te({decimal:",",mmmm:E("sausio;vasario;kovo;balandžio;gegužės;birželio;liepos;rugpjūčio;rugsėjo;spalio;lapkričio;gruodžio"),mmm:E("saus.;vas.;kov.;bal.;geg.;birž.;liep.;rugp.;rugs.;spal.;lapkr.;gruod."),dddd:E("sekmadienis;pirmadienis;antradienis;trečiadienis;ketvirtadienis;penktadienis;šeštadienis"),ddd:E("sk;pr;an;tr;kt;pn;št"),ampm:E("priešpiet;popiet")},"lt");te({decimal:",",mmmm:E("janvāris;februāris;marts;aprīlis;maijs;jūnijs;jūlijs;augusts;septembris;oktobris;novembris;decembris"),mmm:E("janv.;febr.;marts;apr.;maijs;jūn.;jūl.;aug.;sept.;okt.;nov.;dec."),dddd:E("svētdiena;pirmdiena;otrdiena;trešdiena;ceturtdiena;piektdiena;sestdiena"),ddd:E("svētd.;pirmd.;otrd.;trešd.;ceturtd.;piektd.;sestd."),ampm:E("priekšpusdienā;pēcpusdienā")},"lv");te({group:",",decimal:".",mmmm:E("ജനുവരി;ഫെബ്രുവരി;മാർച്ച്;ഏപ്രിൽ;മേയ്;ജൂൺ;ജൂലൈ;ഓഗസ്റ്റ്;സെപ്റ്റംബർ;ഒക്‌ടോബർ;നവംബർ;ഡിസംബർ"),mmm:E("ജനു;ഫെബ്രു;മാർ;ഏപ്രി;മേയ്;ജൂൺ;ജൂലൈ;ഓഗ;സെപ്റ്റം;ഒക്ടോ;നവം;ഡിസം"),dddd:E("ഞായറാഴ്‌ച;തിങ്കളാഴ്‌ച;ചൊവ്വാഴ്ച;ബുധനാഴ്‌ച;വ്യാഴാഴ്‌ച;വെള്ളിയാഴ്‌ച;ശനിയാഴ്‌ച"),ddd:E("ഞായർ;തിങ്കൾ;ചൊവ്വ;ബുധൻ;വ്യാഴം;വെള്ളി;ശനി")},"ml");te({group:",",decimal:".",mmmm:E("нэгдүгээ~;хоёрдугаа~;гуравдугаа~;дөрөвдүгээ~;тавдугаа~;зургаадугаа~;долоодугаа~;наймдугаа~;есдүгээ~;аравдугаа~;арван нэгдүгээ~;арван хоёрдугаа~","р сар"),mmm:E("1~;2~;3~;4~;5~;6~;7~;8~;9~;10~;11~;12~","-р сар"),dddd:E("ням;даваа;мягмар;лхагва;пүрэв;баасан;бямба"),ddd:E("Ня;Да;Мя;Лх;Пү;Ба;Бя"),ampm:E("ү.ө.;ү.х.")},"mn");te({group:",",decimal:".",mmmm:E("जानेवारी;फेब्रुवारी;मार्च;एप्रिल;मे;जून;जुलै;ऑगस्ट;सप्टेंबर;ऑक्टोबर;नोव्हेंबर;डिसेंबर"),mmm:E("जाने;फेब्रु;मार्च;एप्रि;मे;जून;जुलै;ऑग;सप्टें;ऑक्टो;नोव्हें;डिसें"),dddd:E("रविवार;सोमवार;मंगळवार;बुधवार;गुरुवार;शुक्रवार;शनिवार"),ddd:E("रवि;सोम;मंगळ;बुध;गुरु;शुक्र;शनि")},"mr");te(Pe({group:",",decimal:".",mmmm:E("ဇန်နဝါရီ;ဖေဖော်ဝါရီ;မတ်;ဧပြီ;မေ;ဇွန်;ဇူလိုင်;ဩဂုတ်;စက်တင်ဘာ;အောက်တိုဘာ;နိုဝင်ဘာ;ဒီဇင်ဘာ"),mmm:E("ဇန်;ဖေ;မတ်;ဧ;မေ;ဇွန်;ဇူ;ဩ;စက်;အောက်;နို;ဒီ"),dddd:E("တနင်္ဂနွေ;တနင်္လာ;အင်္ဂါ;ဗုဒ္ဓဟူး;ကြာသပတေး;သောကြာ;စနေ"),ampm:E("နံနက်;ညနေ")},-1,0),"my");te({group:",",decimal:".",mmmm:E("ਜਨਵਰੀ;ਫ਼ਰਵਰੀ;ਮਾਰਚ;ਅਪ੍ਰੈਲ;ਮਈ;ਜੂਨ;ਜੁਲਾਈ;ਅਗਸਤ;ਸਤੰਬਰ;ਅਕਤੂਬਰ;ਨਵੰਬਰ;ਦਸੰਬਰ"),mmm:E("ਜਨ;ਫ਼ਰ;ਮਾਰਚ;ਅਪ੍ਰੈ;ਮਈ;ਜੂਨ;ਜੁਲਾ;ਅਗ;ਸਤੰ;ਅਕਤੂ;ਨਵੰ;ਦਸੰ"),dddd:E("ਐਤਵਾਰ;ਸੋਮਵਾਰ;ਮੰਗਲਵਾਰ;ਬੁੱਧਵਾਰ;ਵੀਰਵਾਰ;ਸ਼ੁੱਕਰਵਾਰ;ਸ਼ਨਿੱਚਰਵਾਰ"),ddd:E("ਐਤ;ਸੋਮ;ਮੰਗਲ;ਬੁੱਧ;ਵੀਰ;ਸ਼ੁੱਕਰ;ਸ਼ਨਿੱਚਰ"),ampm:E("ਪੂ.ਦੁ.;ਬਾ.ਦੁ.")},"pa");te({group:".",decimal:",",mmmm:E("ianuarie;februarie;martie;aprilie;mai;iunie;iulie;august;septem~;octom~;noiem~;decem~","brie"),mmm:E("ian.;feb.;mar.;apr.;mai;iun.;iul.;aug.;sept.;oct.;nov.;dec."),dddd:E("duminică;luni;marți;miercuri;joi;vineri;sâmbătă"),ddd:E("dum.;lun.;mar.;mie.;joi;vin.;sâm."),ampm:E("a.m.;p.m.")},"ro");te(Pe({group:".",decimal:",",mmmm:E("januar;februar;marec;april;maj;junij;julij;avgust;september;oktober;november;december"),mmm:E("jan.;feb.;mar.;apr.;maj;jun.;jul.;avg.;sep.;okt.;nov.;dec."),dddd:E("nedelja;ponedeljek;torek;sreda;četrtek;petek;sobota"),ampm:E("dop.;pop.")},-1,13),"sl");te(Pe({group:".",decimal:",",mmmm:E("јануар;фебруар;март;април;мај;јун;јул;август;септембар;октобар;новембар;децембар"),dddd:E("недеља;понедељак;уторак;среда;четвртак;петак;субота")},3,3),"sr");te({group:",",decimal:".",mmmm:E("ஜனவரி;பிப்ரவரி;மார்ச்;ஏப்ரல்;மே;ஜூன்;ஜூலை;ஆகஸ்ட்;செப்டம்பர்;அக்டோபர்;நவம்பர்;டிசம்பர்"),mmm:E("ஜன.;பிப்.;மார்.;ஏப்.;மே;ஜூன்;ஜூலை;ஆக.;செப்.;அக்.;நவ.;டிச."),dddd:E("ஞாயிறு;திங்கள்;செவ்வாய்;புதன்;வியாழன்;வெள்ளி;சனி"),ddd:E("ஞாயி.;திங்.;செவ்.;புத.;வியா.;வெள்.;சனி")},"ta");te({group:",",decimal:".",mmmm:E("జనవరి;ఫిబ్రవరి;మార్చి;ఏప్రిల్;మే;జూన్;జులై;ఆగస్టు;సెప్టెంబర్;అక్టోబర్;నవంబర్;డిసెంబర్"),mmm:E("జన;ఫిబ్ర;మార్చి;ఏప్రి;మే;జూన్;జులై;ఆగ;సెప్టెం;అక్టో;నవం;డిసెం"),dddd:E("ఆదివారం;సోమవారం;మంగళవారం;బుధవారం;గురువారం;శుక్రవారం;శనివారం"),ddd:E("ఆది;సోమ;మంగళ;బుధ;గురు;శుక్ర;శని")},"te");te({decimal:",",mmmm:E("січня;лютого;березня;квітня;травня;червня;липня;серпня;вересня;жовтня;листопада;грудня"),mmm:E("січ.;лют.;бер.;квіт.;трав.;черв.;лип.;серп.;вер.;жовт.;лист.;груд."),dddd:E("неділю;понеділок;вівторок;середу;четвер;пʼятницю;суботу"),ddd:E("нд;пн;вт;ср;чт;пт;сб"),ampm:E("дп;пп")},"uk");te({group:".",decimal:",",mmmm:E("~1;~2;~3;~4;~5;~6;~7;~8;~9;~10;~11;~12","tháng "),mmm:E("~1;~2;~3;~4;~5;~6;~7;~8;~9;~10;~11;~12","thg "),dddd:E("Chủ Nhật;Thứ Hai;Thứ Ba;Thứ Tư;Thứ Năm;Thứ Sáu;Thứ Bảy"),ddd:E("CN;Th 2;Th 3;Th 4;Th 5;Th 6;Th 7"),ampm:E("SA;CH")},"vi");te(Pe({group:"٬",decimal:"٫",ampm:E("ص;م"),mmmm:E("يناير;فبراير;مارس;أبريل;مايو;يونيو;يوليو;أغسطس;سبتمبر;أكتوبر;نوفمبر;ديسمبر"),dddd:E("الأحد;الاثنين;الثلاثاء;الأربعاء;الخميس;الجمعة;السبت"),mmmm6:E("رمضان;شوال;ذو القعدة;ذو الحجة;محرم;ربيع الأول;ربيع الآخرة;جمادى الأولى;جمادى الآخرة;رجب;شعبان;رمضان")},0,0),"ar");te({group:",",decimal:".",mmmm:E("জানুয়ারী;ফেব্রুয়ারী;মার্চ;এপ্রিল;মে;জুন;জুলাই;আগস্ট;সেপ্টেম্বর;অক্টোবর;নভেম্বর;ডিসেম্বর"),mmm:E("জানু;ফেব;মার্চ;এপ্রি;মে;জুন;জুল;আগ;সেপ্টেঃ;অক্টোঃ;নভেঃ;ডিসেঃ"),dddd:E("রবিবার;সোমবার;মঙ্গলবার;বুধবার;বৃহস্পতিবার;শুক্রবার;শনিবার"),ddd:E("রবি;সোম;মঙ্গল;বুধ;বৃহস্পতি;শুক্র;শনি")},"bn");te({group:",",decimal:".",mmmm:E("जनवरी;फ़रवरी;मार्च;अप्रैल;मई;जून;जुलाई;अगस्त;सितंबर;अक्तूबर;नवंबर;दिसंबर"),mmm:E("जन॰;फ़र॰;मार्च;अप्रैल;मई;जून;जुल॰;अग॰;सित॰;अक्तू॰;नव॰;दिस॰"),dddd:E("रविवार;सोमवार;मंगलवार;बुधवार;गुरुवार;शुक्रवार;शनिवार"),ddd:E("रवि;सोम;मंगल;बुध;गुरु;शुक्र;शनि"),ampm:E("am;pm")},"hi");const Pu={overflow:"######",dateErrorThrows:!1,dateErrorNumber:!0,bigintErrorNumber:!1,dateSpanLarge:!0,leap1900:!0,nbsp:!1,throws:!0,invalid:"######",locale:"",ignoreTimezone:!1,grouping:[3,3],indexColors:!0,skipChar:"",repeatChar:""};function Rt(e,t=0){if(typeof e!="number")return e;if(e<0)return-Rt(-e,t);if(t){const n=10**t||1;return Rt(e*n,0)/n}return Math.round(e)}const bE=1e-13;function ku(e,t=2,n=2){const r=e<0?-1:1,s=10**(t||2),i=10**(n||2);let o=Math.abs(e),a=0,l=0,c=0,u=1,h,d;if(e=o,e%1===0)d=[e*r,1];else if(e<1e-19)d=[r,1e19];else if(e>1e19)d=[1e19*r,1];else{do if(o=1/(o-Math.floor(o)),h=u,u=u*Math.floor(o)+a,a=h,l=c,c=Math.floor(e*u+.5),c>=s||u>=i)return[r*l,a];while(Math.abs(e-c/u)>=bE&&o!==Math.floor(o));d=[r*c,u]}return d}const ht=Math.floor;function Fu(e,t=!0){if(t&&e>=0){if(e===0)return[1900,1,0];if(e===60)return[1900,2,29];if(e<60)return[1900,e<32?1:2,(e-1)%31+1]}let n=e+68569+2415019;const r=ht(4*n/146097);n=n-ht((146097*r+3)/4);const s=ht(4e3*(n+1)/1461001);n=n-ht(1461*s/4)+31;const i=ht(80*n/2447),o=n-ht(2447*i/80);n=ht(i/11);const a=i+2-12*n;return[100*(r-49)+s+n|0,a|0,o|0]}function AE(e){return Fu(e+1462)}function TE(e){if(e===60)throw new Error("#VALUE!");if(e<=1)return[1317,8,29];if(e<60)return[1317,e<32?9:10,1+(e-2)%30];const t=10631/30,n=8.01/60;let r=e+466935;const s=ht(r/10631);r=r-10631*s;const i=ht((r-n)/t);r=r-ht(i*t+n);const o=ht((r+28.5001)/29.5);return o===13?[30*s+i,12,30]:[30*s+i,o,r-ht(29.5001*o-29)]}function Bu(e,t=0,n=!0){const r=ht(e);return t===Yn?TE(r):t===SE?AE(r):Fu(r,n)}const es=Math.floor,gi=86400;function Jo(e,t){let n=null;if(Array.isArray(e)){const[r,s,i,o,a,l]=e;n=Date.UTC(r,s==null?0:s-1,i!=null?i:1,o||0,a||0,l||0)}else if(e instanceof Date&&(n=e*1,!t||!t.ignoreTimezone)){const r=new Date;r.setUTCFullYear(e.getFullYear(),e.getMonth(),e.getDate()),r.setUTCHours(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()),n=r*1}if(n!=null&&isFinite(n)){const r=n/864e5;return r-(r<=-25509?-25568:-25569)}return null}function yE(e,t){let n=e|0;const r=gi*(e-n);let s=es(r);r-s>.9999&&(s+=1,s===gi&&(s=0,n+=1));const i=s<0?gi+s:s,[o,a,l]=Bu(e,0,t&&t.leap1900),c=es(i/60/60)%60,u=es(i/60)%60,h=es(i)%60;return[o,a,l,c,u,h]}const NE=["!d-m-y","!d-m-Y","!j-m-y","!j-m-Y","!d-n-y","!d-n-Y","!j-n-y","!j-n-Y","?m-d-y","?m-d-Y","?m-j-y","?m-j-Y","?n-d-y","?n-d-Y","?n-j-y","?n-j-Y","d-M-y","d-M-Y","j-M-y","j-M-Y","M-d-y","M-d-Y","M-j-y","M-j-Y","d-F-y","d-F-Y","F-d-y","F-d-Y","F-j-y","F-j-Y","j-F-y","j-F-Y","y-F-d","y-F-j","y-M-d","y-M-j","Y-F-d","Y-F-j","Y-M-d","Y-m-d","Y-M-j","Y-m-j","Y-n-d","Y-n-j","j-F","j-M","d-F","d-M","n-d","n-j","n-Y","m-d","m-j","m-Y","M-Y","M-y","F-y","F-Y","Y-M","Y-n","Y-m","Y-F","Y-M"],ME={j:"d",d:"d",D:"ddd",l:"dddd",n:"m",m:"m",M:"mmm",F:"mmmm",y:"yy",Y:"yyyy"},LE={j:"dd",d:"dd",D:"ddd",l:"dddd",n:"mm",m:"mm",M:"mmm",F:"mmmm",y:"yy",Y:"yyyy"},$u={},Hu={};function ut(e,t,n=1){if(e){const r=e[0],s=e.slice(1);r==="!"?ut(s,t,4):r==="?"?ut(s,t,2):(t[r]=t[r]||{},ut(s,t[r],n))}else t.$=n}function tl(e,t){ut(e,t),ut(e+" x",t),ut(e+" l",t),ut(e+" l x",t),ut("l "+e,t),ut("l "+e+" x",t),ut(e+" D",t),ut(e+" D x",t),ut("D "+e,t),ut("D "+e+" x",t)}NE.forEach(e=>{e[0]!=="?"&&tl(e,$u),e[0]!=="!"&&tl(e,Hu)});const DE=new Date().getUTCFullYear(),nl=".",xE=",",_i=" ",vr=" ",wr=" ",Rs="'",Is="٬",UE={".":[xE,vr,wr,Rs,Is],",":[nl,vr,wr,Rs,Is],"٫":[nl,vr,wr,Rs,Is]},pi=e=>e&&e.length===1&&e>="0"&&e<="9";function Qo(e,t={}){const n=Qn(t.locale||"")||sn,r=n.decimal,s=[...UE[r]||[Rs,Is]];!s.includes(n.group)&&n.group!==_i&&n.group!==r&&s.push(n.group);let i="",o="",a=1,l="",c=!1,u=!1,h=!1,d=!1,f=!1,g=null,_=!1,R=0;const b=[_i,vr,wr,"+","%","(","-"].concat(Wi);for(;b.includes(e[R]);){const w=e[R];if(w==="-"){if(c||u)return null;c=!0,a=-1}else if(Yi.test(w)){if(f)return null;f=!0,g=w}else if(w==="("){if(u||c)return null;u=!0,a=-1}else if(w==="%"){if(d)return null;d=!0}R++}let F=!1,k;if(e[R]===r||pi(e[R]))for(;R<e.length;){const w=e[R];if(!k&&s.includes(w))k=w;else if(!(k&&k===w))if(w===r){if(F)break;i+=".",F=!0}else if(pi(w))i+=w;else break;R++}if(e[R]==="e"||e[R]==="E"){o+=e[R],R++,(e[R]==="+"||e[R]==="-")&&(o+=e[R],R++);const w=R;for(;pi(e[R]);)o+=e[R],R++;if(w===R)return null}const W=[_i,vr,wr,"%","$",")"].concat(Wi);for(;W.includes(e[R]);){const w=e[R];if(Yi.test(w)){if(f)return null;f=!0,g=w,_=!0}else if(w===")"){if(h||!u)return null;h=!0}else if(w==="%"){if(d)return null;d=!0}R++}if(R!==e.length)return null;let S=parseFloat(i+o);if(!isFinite(S))return null;if(o){if(d||f)return null;l="0.00E+00"}else if(d){if(f)return null;l=i.includes(".")?"0.00%":"0%",S*=.01}else if(f){const w=i.includes(".")?"#,##0.00":"#,##0";_?l=w+g:l=g+w}else k&&(l=i.includes(".")?"#,##0.00":"#,##0");const C={v:S*a};return l&&(C.z=l),C}function PE(e,t,n){if(n<1||t<1||t>12)return!1;if(t===2){const s=e%4===0&&e%100!==0||e%400===0||e===1900?29:28;if(n>s)return!1}else if((t===4||t===6||t===9||t===11)&&n>30||(t===1||t===3||t===5||t===7||t===8||t===10||t===12)&&n>31)return!1;return!0}const rl=(e,t,n=!1)=>{for(const r of t)if(e.startsWith(r[0])){let s=r[0].length;return n&&(r[2]==="D"||r[2]==="M")&&e[s]==="."&&s++,[e.slice(0,s),r]}return["",null]},xt=(e,t,n,r)=>{const s=n.path||"",i=Object.keys(t);for(let o=0;o<i.length;o++){let a;const l=i[o];if(t[l]){if(l==="$"||l==="€")e||(a=n);else if(l==="-"){const c=/^(\s*([./-]|,\s)\s*|\s+)/.exec(e);if(c){const u=c[1]==="-"||c[1]==="/"||c[1]==="."?c[1]:" ";if(!n.sep||n.sep===u){const h=c[0].replace(/\s+/g," ");a=xt(e.slice(c[0].length),t[l],{...n,sep:u,path:s+h},r)}}}else if(l===" "){const c=/^[,.]?\s+/.exec(e);if(c){const u=c[0].replace(/\s+/g," ");a=xt(e.slice(c[0].length),t[l],{...n,path:s+u},r)}}else if(l==="j"||l==="d"){const c=/^(0?[1-9]|1\d|2\d|3[01])\b/.exec(e);c&&(a=xt(e.slice(c[0].length),t[l],{...n,day:c[0],path:s+l},r))}else if(l==="n"||l==="m"){const c=/^(0?[1-9]|1[012])\b/.exec(e);c&&(a=xt(e.slice(c[0].length),t[l],{...n,month:+c[0],_mon:c[0],path:s+l},r))}else if(l==="F"||l==="M"){const[c,u]=rl(e,r.mon,r.mp);u&&u[2]===l&&(a=xt(e.slice(c.length),t[l],{...n,month:u[1],_mon:c,path:s+l},r))}else if(l==="l"||l==="D"){const[c,u]=rl(e,r.day,r.dp);u&&u[2]===l&&(a=xt(e.slice(c.length),t[l],{...n,path:s+l},r))}else if(l==="y"){const c=/^\d\d\b/.exec(e);if(c){const u=+c[0]>=30?+c[0]+1900:+c[0]+2e3;a=xt(e.slice(c[0].length),t[l],{...n,year:u,path:s+l},r)}}else if(l==="Y"){const c=/^\d\d\d\d\b/.exec(e);c&&(a=xt(e.slice(c[0].length),t[l],{...n,year:+c[0],path:s+l},r))}else if(l==="x"){const c=Zs(e,{locale:r.locale});c&&(a=xt("",t[l],{...n,time:c.v,tf:c.z,path:s+l},r))}else throw new Error(`Unknown date token "${l}"`);if(a&&PE(n.year||1916,n.month||1,n.day?+n.day:1))return a}}},ju=e=>e.replace(/\s+/g," ").trim().replace(/’/,"'").replace(/\.$/,"").toLowerCase(),ts=(e,t)=>{const n=e.map((r,s)=>[ju(r),s+1,t]);return n.sort((r,s)=>s[0].length-r[0].length),n};function ea(e,t={}){var i;const n=Qn(t.locale||"")||sn,r={mon:ts(n.mmmm,"F").concat(ts(n.mmm,"M")),mp:n.mmm[0].at(-1)===".",day:ts(n.dddd,"l").concat(ts(n.ddd,"D")),dp:n.ddd[0].at(-1)===".",locale:t.locale},s=xt(ju(e),n.preferMDY?Hu:$u,{path:""},r);if(s){if(s.sep==="."&&s.path.length===3)return null;const o=+((i=s.year)!=null?i:DE);s.day||(s.day=1);let a=-1/0;if(o<1900)return null;o<=1900&&s.month<=2?a=25568:o<1e4&&(a=25569);const l=Date.UTC(o,s.month-1,s.day)/864e5+a+(s.time||0);if(l>=0&&l<=2958465){const c=s._mon[0]==="0"||s.day[0]==="0"||s._mon.length===2&&s.day.length===2,u=s.path.replace(/[jdlDnmMFyYx]/g,h=>h==="x"?s.tf||"":(c?LE[h]:ME[h])||h);return{v:l,z:u}}}return null}const Ei=e=>e.replace(/\s+/g,"").trim().replace(/\./g,"").toLowerCase();function Zs(e,t={}){const n=Qn(t.locale||"")||sn,r=/^\s*([10]?\d|2[0-4])(?::([0-5]\d|\d))?(?::([0-5]\d|\d))?(\.\d{1,10})?(?=\s*[^\s\d]|$)/.exec(e);let s="";if(r){const i=Ei(e.slice(r[0].length));if(i===Ei(n.ampm[0])||i==="a"||i==="am")s="a";else if(i===Ei(n.ampm[1])||i==="p"||i==="pm")s="p";else if(i)return null}if(r){const[,i,o,a,l]=r;if(l&&!a||!s&&!o&&!a)return null;let c=+(i||0)*1;if(s){if(c>=13)return null;s==="p"&&(c+=12)}const u=+(o||0)*1,h=+(a||0)*1,d=+(l||0)*1;return{v:(c*60*60+u*60+h+d)/(3600*24),z:(i.length===2?"hh":"h")+":mm"+(a?":ss":"")+(s?" AM/PM":"")}}return null}function Wu(e,t={}){const n=Qn(t.locale||"")||sn,r=e.trim().toLowerCase(),s=n.bool[0].toLowerCase();if(r==="true"||r===s)return{v:!0};const i=n.bool[1].toLowerCase();return r==="false"||r===i?{v:!1}:null}function kE(e,t){var n,r,s;return(s=(r=(n=Qo(e,t))!=null?n:ea(e,t))!=null?r:Zs(e,t))!=null?s:Wu(e,t)}function mn(e,t,n){return t[n+"_max"]=e.length,t[n+"_min"]=e.replace(/#/g,"").length,t}function Ge(e,t){typeof e=="string"?t.push({type:"string",value:e}):t.push(e)}function sl(e,t){const n=e&&e.type;return n===Oo||n===Gn||n===vo||n===Xs&&t==="den"}function _r(e){var k,W,S;const t=[],n={scale:1,percent:!1,text:!1,date:0,date_eval:!1,date_system:el,sec_decimals:0,general:!1,clock:24,int_pattern:[],frac_pattern:[],man_pattern:[],den_pattern:[],num_pattern:[],tokens:t};let r="int",s=null;const i=[];let o,a=!1,l=-1,c=!1,u="",h=!1;for(;++l<e.length&&!c;){const C=e[l],w=C.type||Mr;if(u+=C.raw,w===So)n.general=!0,Ge(C,t);else if(sl(C,r)){const T=n[r+"_pattern"];sl(o,r)||(o==null?void 0:o.type)===Nr?(T.push((T.pop()||"")+C.value),s.num+=C.value):(T.push(C.value),s={type:r,num:C.value},Ge(s,t))}else if(w===Vo)C.value==="("&&(n.parens=!0),Ge(C.value,t);else if(w===Xs)Ge(C.value,t);else if(w===wo)if(h=!0,n[r+"_pattern"].length){if(!s)throw new SyntaxError("Format pattern is missing a numerator");n.fractions=!0,n.num_pattern.push(n[r+"_pattern"].pop()),s.type="num",r="den",Ge({type:"div"},t)}else Ge(C.value,t);else if(w===bo)Ge(",",t);else if(w===Ns)n.scale=.001**C.raw.length;else if(w===Nr){if(r==="int"&&(n.grouping=!0),r==="den")throw new SyntaxError("Cannot group denominator digits")}else if(w===No)Ge(C,t);else if(w===Ao){c=!0;break}else if(w===Ks)n.text=!0,Ge(C,t);else if(w===To||w===yo)Ge(C,t);else if(w===xo){const T=C.value.toLowerCase(),B=T[0],$={type:"",size:0,date:1,pad:T.length};B==="h"?($.size=fr,$.type="hour-elap"):B==="m"?($.size=mr,$.type="min-elap"):($.size=gr,$.type="sec-elap"),n.date=n.date|$.size,i.push($),Ge($,t)}else if(n.date&&w===Ms&&((k=e[l+1])==null?void 0:k.type)===Gn){let T=1;l++;let B="0";((W=e[l+1])==null?void 0:W.type)===Gn&&(B+="0",T=2,l++),((S=e[l+1])==null?void 0:S.type)===Gn&&(B+="0",T=3,l++),u+=B;const $=[gr,$i,Hi,ji][T];n.date=n.date|$,n.date_eval=!0,n.sec_decimals=Math.max(n.sec_decimals,T),Ge({type:"subsec",size:$,decimals:T,date:1},t)}else if(w===Lo)a||(C.value==="B2"||C.value==="b2"?n.date_system=Yn:n.date_system=el);else if(w===Do){const T={type:"",size:0,date:1},B=C.value.toLowerCase(),$=B[0];if(B==="y"||B==="yy")T.size=hr,T.type="year-short";else if($==="y"||$==="e")T.size=hr,T.type="year";else if(B==="b"||B==="bb")T.size=hr,T.type="b-year-short";else if($==="b")T.size=hr,T.type="b-year";else if(B==="d"||B==="dd")T.size=Cs,T.type="day",T.pad=/dd/.test(B);else if(B==="ddd"||B==="aaa")T.size=Cs,T.type="weekday-short";else if($==="d"||$==="a")T.size=Cs,T.type="weekday";else if($==="h")T.size=fr,T.type="hour",T.pad=/hh/i.test(B);else if($==="m"){B.length===3?(T.size=dr,T.type="monthname-short"):B.length===5?(T.size=dr,T.type="monthname-single"):B.length>=4&&(T.size=dr,T.type="monthname");const m=i[i.length-1];!T.type&&m&&!m.used&&m.size&(fr|gr)&&(m.used=!0,T.size=mr,T.type="min",T.pad=/mm/.test(B)),T.type||(T.size=dr,T.type="month",T.pad=/mm/.test(B),T.indeterminate=!0)}else if($==="s"){T.size=gr,T.type="sec",T.pad=/ss/.test(B);const m=i[i.length-1];m&&m.size&mr?T.used=!0:m&&m.indeterminate&&(delete m.indeterminate,m.size=mr,m.type="min",T.used=!0)}n.date=n.date|T.size,n.date_eval=!0,i.push(T),Ge(T,t)}else if(w===$o)n.clock=12,n.date=n.date|fr,n.date_eval=!0,C.short=C.value==="A/P",Ge(C,t);else if(w===jo||w===Ho||w===qs)Ge(C.value,t);else if(w===Uo)n.condition=[C.value[0],parseFloat(C.value[1])];else if(w===Fo){const T=C.value.split("-"),B=T.length<2?"":T.slice(1).join("-"),$=T[0];$&&Ge($,t);const m=Ko(B);m&&(n.locale=m);const x=parseInt(B,16);isFinite(x)&&x&16711680&&(x>>16&255)===6&&(n.date_system=Yn),a=!0}else if(w===Bo){let T,B=C.value.toLowerCase();(T=/^color\s*(\d+)$/i.exec(B))&&(B=parseInt(T[1],10)),n.color=B}else if(w===Mo)n.scale=100,n.percent=!0,Ge("%",t);else if(w===Ms)Ge(C,t),n.date||(n.dec_fractions=!0,r="frac");else if(w===Yo)n.exponential=!0,n.exp_plus=C.value.includes("+"),r="man",Ge({type:"exp",plus:n.exp_plus},t);else if(w===Wo)Ge(C,t);else if(w===Go)Ge(C,t);else if(!(w===Po||w===ko))throw w===Mr?new SyntaxError(`Illegal character: ${u}`):new SyntaxError(`Unknown token ${w} in ${u}`);o=C}if(n.tokensUsed=l,n.pattern=u,/^((?:\[[^\]]+\])+)(;|$)/.test(n.pattern)&&!/^\[(?:h+|m+|s+)\]/.test(n.pattern)&&Ge({type:"text"},t),n.fractions&&n.dec_fractions||n.grouping&&!n.int_pattern.length||n.fractions&&n.exponential||n.fractions&&n.den_pattern.length*n.num_pattern.length===0||h&&!n.fractions&&!n.date||n.exponential&&(n.int_pattern.length||n.frac_pattern.length)*n.man_pattern.length===0)throw new SyntaxError(`Invalid pattern: ${u}`);const d=n.int_pattern.join(""),f=n.man_pattern.join(""),g=n.frac_pattern.join("");mn(d,n,"int");let _=0;for(let C=0;C<d.length;C++){const w=d[d.length-1-C];/^[0-9?]/.test(w)&&(_=C+1)}n.int_min=_,mn(g,n,"frac"),mn(f,n,"man");let R=n.num_pattern.join(""),b=n.den_pattern[0]||"";if(b.includes("?")||R.includes("?")?(b=b.replace(/\d/g,"?"),b=b.replace(/#$/g,"?"),mn(R,n,"num"),mn(b,n,"den"),R=R.replace(/#$/g,"?")):(mn(R,n,"num"),mn(b,n,"den")),n.int_p=d,n.man_p=f,n.num_p=R,n.den_p=b,n.den_pattern.length&&(n.denominator=parseInt(n.den_pattern.join("").replace(/\D/g,""),10)),n.integer=!!d.length,!n.integer&&!n.exponential&&g.length){const C=n.tokens.findIndex(w=>w.type==="point");n.tokens.splice(C,0,{type:"int",value:"#"}),n.integer=!0,n.int_pattern=["#"],n.int_p="#"}if(n.fractions)for(let C=0;C<t.length-1;C++){const w=t[C];if(w.type!=="string"&&w.type!=="space")continue;const T=t[C+1].type;T==="num"?w.rule="num+int":T==="div"?w.rule="num":T==="den"&&(w.rule="den")}return n.grouping&&n.int_pattern.length>1&&(n.grouping=!1),n}function FE(e){if(e===0)return e;const t=Math.ceil(Math.log10(e<0?-e:e)),n=10**(16-Math.floor(t));return isFinite(n)?Math.round(e*n)/n:0}function Yu(e,t=0){const n=Math.floor(Math.log10(e));return t>1?Math.floor(n/t)*t:n}function Gu(e,t=1){return t<-300?parseFloat(e.toExponential().split("e")[0]):e*10**-t}const BE={total:1,sign:0,period:0,int:1,frac:0};function $E(e,t=!0){const n=Math.abs(e);if(!n)return BE;const r=t&&e<0?1:0,s=Math.floor(n),i=Math.floor(Math.log10(n)+1);let o=0,a=0;if(s!==n){o=1;const l=String(Rt(n*10**-i,15));let c=l.length,u=!0,h=0;for(;h<=l.length;){if(l[h]==="."){c--;break}else l[h]==="0"&&u?c--:u=!1;h++}a=c-i,a<0&&(a=0,o=0)}return{total:r+Math.max(i,1)+o+a,digits:Math.max(i,0)+a,sign:r,period:o,int:Math.max(i,1),frac:a}}const Mn=(e,t)=>e.replace(/\./,t.decimal),il=(e,t,n)=>{const r=Math.abs(t);let s;return e===1?s=e:s=Rt(e,5),[Mn(s+"",n),n.exponent,t<0?n.negative:n.positive,r<10?"0":"",r]};function ol(e,t,n,r){const s=n|0;if(typeof n=="string")e.push(n);else if(n===s)e.push(Math.abs(s));else{const i=Math.abs(n);let o=Yu(i),a=Gu(i,o);a===10&&(a=1,o++);const l=$E(i);if(o>=-4&&o<=-1){const c=i.toPrecision(10+o).replace(/\.?0+$/,"");e.push(Mn(c,r))}else if(o===10){const c=i.toFixed(10).slice(0,12).replace(/\.$/,"");e.push(Mn(c,r))}else if(Math.abs(o)<=9)if(l.total<=11){const c=Rt(i,9).toFixed(l.frac);e.push(Mn(c,r))}else o===9?e.push(Math.floor(i)):o>=0&&o<9?e.push(Mn(String(Rt(i,9-o)),r)):e.push(...il(a,o,r));else l.total>=12?e.push(...il(a,o,r)):e.push(Mn(Rt(i,9).toFixed(l.frac),r))}return e}function gn(e,t=!1){return e==="0"?"0":e==="?"?t?" ":" ":""}const rr=86400,HE=(e,t,n)=>n?e<RE||t>=IE:e<EE||t>=CE;function al(e,t,n,r){var A,v;let s="",i="",o="",a="",l="",c="",u=0,h=0;if(typeof e=="bigint"){if(e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER)e=Number(e);else return n.bigintErrorNumber?String(e):n.overflow;h=e}else h=Math.trunc(e);let d=0,f=0,g=1,_=0,R=0,b=0,F=0,k=0,W=0;const S=r||sn;if(!t.text&&isFinite(t.scale)&&t.scale!==1&&(e=FE(e*t.scale)),t.exponential){let y=Math.abs(e);y&&(u=Yu(y,t.int_max)),e&&!t.integer&&u++,y=Gu(y,u),t.int_max===1&&Rt(y,t.frac_max)===10&&(y=1,u++),e=e<0?-y:y,s+=Math.abs(u)}if(t.integer){const y=Math.abs(Rt(e,t.fractions?1:t.frac_max));c+=y<1?"":Math.floor(y)}const C=(A=n.grouping[0])!=null?A:3,w=(v=n.grouping[1])!=null?v:C;t.dec_fractions&&(l=String(Rt(e,t.frac_max)).split(".")[1]||"");const T=!t.error&&(t.num_p.includes("0")||t.den_p.includes("0"));let B=T;if(t.fractions){B=T||!!(e%1);const y=Math.abs(t.integer?e%1:e);if(y)if(B=!0,t.denominator&&isFinite(t.denominator))a+=t.denominator,o+=Rt(y*t.denominator),o==="0"&&(o="",a="",B=T);else{const M=ku(y,1/0,t.den_max);o+=M[0],a+=M[1],t.integer&&o==="0"&&(o="",a="",B=T)}else!e&&!t.integer&&(B=!0,o="0",a="1");t.integer&&!B&&!Math.trunc(e)&&(c="0")}if(t.date){h=Math.trunc(e);const y=rr*(e-h);if(d=Math.floor(y),W=y-d,Math.abs(W)<1e-6?W=0:W>.9999&&(W=0,d+=1,d===rr&&(d=0,h+=1)),W){const M=t.date&ji||t.date&Hi||t.date&$i;(M===ji&&W>.9995||M===Hi&&W>.995||M===$i&&W>.95||!M&&W>=.5)&&(d++,W=0)}if(h||t.date_system){const M=Bu(e,t.date_system,n.leap1900);f=M[0],g=M[1],_=M[2]}if(d){const M=d<0?rr+d:d;k=Math.floor(M)%60,F=Math.floor(M/60)%60,b=Math.floor(M/60/60)%60}if(R=(6+h)%7,t.date_eval&&HE(e,h+d/rr,n.dateSpanLarge)){if(n.dateErrorThrows)throw new Error("Date out of bounds");if(n.dateErrorNumber){const M=e<0?[S.negative]:[];return ol(M,{},e,S).join("")}return n.overflow}}const $=gn("?",n.nbsp);u<0?i="-":t.exp_plus&&(i="+");const m=[],x=(y,M,L,P)=>{const J=!P&&y.length>M.length?L.length+y.length-M.length:L.length;y.length<M.length&&(P+=y.length-M.length);for(let V=0;V<J;V++)m.push(y[V+P]||gn(L[V],n.nbsp));return J};let O=!1;const N={int:0,frac:0,man:0,num:0,den:0};for(let y=0,M=t.tokens.length;y<M;y++){const L=t.tokens[y],P=L.type,J=L.num?L.num.length:0;if(P==="string")L.rule?L.rule==="num"?B?m.push(L.value.replace(/ /g,$)):(t.num_min>0||t.den_min>0)&&m.push(L.value.replace(/./g,$)):L.rule==="num+int"?B&&c?m.push(L.value.replace(/ /g,$)):t.den_min>0&&(c||t.num_min)&&m.push(L.value.replace(/./g,$)):L.rule==="den"&&(B?m.push(L.value.replace(/ /g,$)):(t.den_min>0||t.den_min>0)&&m.push(L.value.replace(/./g,$))):m.push(L.value.replace(/ /g,$));else if(P==="space")L.rule==="num+int"?(B||t.num_min||t.den_min)&&(c||t.num_min)&&m.push($):m.push($);else if(P==="error")m.push(n.invalid);else if(P==="point")m.push(t.date?L.value:S.decimal);else if(P==="general")ol(m,t,e,S);else if(P==="exp")m.push(S.exponent);else if(P==="minus")L.volatile&&t.date||L.volatile&&(e>=0||typeof e!="number")||(L.volatile&&!t.fractions&&(t.integer||t.dec_fractions)?(e<0&&c&&c!=="0"||l)&&m.push(S.negative):m.push(S.negative));else if(P==="plus")m.push(S.positive);else if(P==="text")m.push(e);else if(P==="fill")n.fillChar&&m.push(n.fillChar,L.value);else if(P==="skip")n.skipChar?m.push(n.skipChar,L.value):m.push(n.nbsp?" ":" ");else if(P==="div")B?m.push("/"):t.num_min>0||t.den_min>0?m.push($):m.push(gn("#",n.nbsp));else if(P==="int")if(t.int_pattern.length===1){const V=t.int_p,oe=Math.max(t.int_min,c.length);let le="";for(let I=oe;I>0;I--){const D=c.charAt(c.length-I),Y=D?"":V.charAt(V.length-I)||V[0];let G="";if(t.grouping){const H=I-1-C;H>=0&&!(H%w)&&(G=D||Y==="0"?S.group:gn("?",n.nbsp))}le+=(D||gn(Y,n.nbsp))+G}m.push(le)}else N.int+=x(c,t.int_p,L.num,N.int);else if(P==="frac"){const V=N.frac;for(let oe=0;oe<J;oe++)m.push(l[oe+V]||gn(L.num[oe],n.nbsp));N.frac+=J}else if(P==="man")!N[P]&&!N.man&&m.push(i),N.man+=x(s,t.man_p,L.num,N.man);else if(P==="num")N.num+=x(o,t.num_p,L.num,N.num);else if(P==="den"){const V=N.den;for(let oe=0;oe<J;oe++){let le=a[oe+V];if(!le){const I=L.num[oe];"123456789".includes(I)||O&&I==="0"?(O=!0,le=n.nbsp?" ":" "):!O&&oe===J-1&&I==="0"&&!a?le="1":le=gn(I,n.nbsp)}m.push(le)}N.den+=J}else if(P==="year")f<0&&m.push(S.negative),m.push(String(Math.abs(f)).padStart(4,"0"));else if(P==="year-short"){const V=f%100;m.push(V<10?"0":"",V)}else if(P==="month")m.push(L.pad&&g<10?"0":"",g);else if(P==="monthname-single")t.date_system===Yn?m.push(S.mmmm6[g-1].charAt(0)):m.push(S.mmmm[g-1].charAt(0));else if(P==="monthname-short")t.date_system===Yn?m.push(S.mmm6[g-1]):m.push(S.mmm[g-1]);else if(P==="monthname")t.date_system===Yn?m.push(S.mmmm6[g-1]):m.push(S.mmmm[g-1]);else if(L.type==="weekday-short")m.push(S.ddd[R]);else if(P==="weekday")m.push(S.dddd[R]);else if(P==="day")m.push(L.pad&&_<10?"0":"",_);else if(P==="hour"){const V=b%t.clock||(t.clock<24?t.clock:0);m.push(L.pad&&V<10?"0":"",V)}else if(P==="min")m.push(L.pad&&F<10?"0":"",F);else if(P==="sec")m.push(L.pad&&k<10?"0":"",k);else if(P==="subsec"){m.push(S.decimal);const V=W.toFixed(t.sec_decimals);m.push(V.slice(2,2+L.decimals))}else if(P==="ampm"){const V=b<12?0:1;L.short&&!r?m.push("AP"[V]):m.push(S.ampm[V])}else if(P==="hour-elap"){e<0&&m.push(S.negative);const V=h*24+Math.floor(Math.abs(d)/3600);m.push(String(Math.abs(V)).padStart(L.pad,"0"))}else if(P==="min-elap"){e<0&&m.push(S.negative);const V=h*1440+Math.floor(Math.abs(d)/60);m.push(String(Math.abs(V)).padStart(L.pad,"0"))}else if(P==="sec-elap"){e<0&&m.push(S.negative);const V=h*rr+Math.abs(d);m.push(String(Math.abs(V)).padStart(L.pad,"0"))}else if(P==="b-year")m.push(f+543);else if(P==="b-year-short"){const V=(f+543)%100;m.push(V<10?"0":"",V)}}return m.join("")}const jE=_r([{type:Ks,value:"@",raw:"@"}]);function Vu(e,t){for(let n=0;n<3;n++){const r=t[n];if(r){let s;if(r.condition){const i=r.condition[0],o=r.condition[1];i==="="?s=e===o:i===">"?s=e>o:i==="<"?s=e<o:i===">="?s=e>=o:i==="<="?s=e<=o:i==="<>"&&(s=e!==o)}else s=!0;if(s)return r}}}function WE(e,t,n){const r=t.partitions;let s=r[3],i=null;return(typeof e=="number"||typeof e=="bigint")&&isFinite(e)&&(s=Vu(e,r)),s&&s.color&&(i=s.color),i&&typeof i=="number"&&n.indexColors&&(i=OE[i-1]||"#000"),i}function YE(e,t,n){const r=t.partitions,s=Qn(t.locale||n.locale),i=r[3]?r[3]:jE;if(typeof e=="boolean"&&(e=(s||sn).bool[e?0:1]),e==null)return"";const o=typeof e=="bigint";if(typeof e!="number"&&!o)return al(e,i,n,s);if(!o&&!isFinite(e)){const l=s||sn;return isNaN(e)?l.nan:(e<0?l.negative:"")+l.infinity}const a=Vu(e,r);return a?al(e,a,n,s):n.overflow}function zu(e){return!!(e[0]&&e[0].percent||e[1]&&e[1].percent||e[2]&&e[2].percent||e[3]&&e[3].percent)}function Ku(e){return!!(e[0]&&e[0].date||e[1]&&e[1].date||e[2]&&e[2].date||e[3]&&e[3].date)}function Xu(e){const[t,n,r,s]=e;return!!((!t||t.generated)&&(!n||n.generated)&&(!r||r.generated)&&s&&s.text&&!s.generated)}const GE={text:15,datetime:10.8,date:10.8,time:10.8,percent:10.6,currency:10.4,grouped:10.2,scientific:6,number:4,fraction:2,general:0,error:0},VE=[["DMY",1],["DM",2],["MY",3],["MDY",4],["MD",5],["hmsa",6],["hma",7],["hms",8],["hm",9]];function zE(e,t=null){var h;const[n,r]=e,s=n.frac_max,i={type:"general",isDate:Ku(e),isText:Xu(e),isPercent:zu(e),maxDecimals:n.general?9:s,scale:(h=n.scale)!=null?h:1,color:0,parentheses:0,grouped:n.grouping?1:0},o=!i.isDate&&!i.isText&&!n.error&&n.tokens.some(d=>d.type==="string"&&(t?d.value===t:Yi.test(d.value)));let a="G",l=s>=0?Math.min(15,s):"",c="",u="";if(r&&r.color&&(u="-",i.color=1),n.parens&&(c="()",i.parentheses=1),o)a="C",i.type="currency";else if(n.error)i.type="error",i.maxDecimals=0;else if(i.isDate){let d=0,f=0,g="";n.tokens.forEach(R=>{const b=R.type;/^(b-)?year/.test(b)?(g+="Y",f++):b.startsWith("month")?(g+="M",f++):/^(week)?day/.test(b)?(g+="D",f++):(b==="hour"||b==="min"||b==="sec"||b==="ampm")&&(g+=b[0],d++)}),i.type="date",f&&d?i.type="datetime":!f&&d&&(i.type="time");const _=VE.find(R=>g.startsWith(R[0]));a=_?"D":"G",l=_?_[1]:""}else i.isText?(a="G",i.type="text",l="",i.maxDecimals=0):n.general?(a="G",i.type="general",l=""):n.fractions?(a="G",i.type="fraction",l=""):n.exponential?(a="S",i.type="scientific"):i.isPercent?(a="P",i.type="percent"):n.grouping?(a=",",i.type="grouped"):(n.int_max||s)&&(a="F",i.type="number");return i.code=a+l+u+c,i.level=GE[i.type],Object.freeze(i)}function KE(e){const[t]=e;return{year:!!(t.date&hr),month:!!(t.date&dr),day:!!(t.date&Cs),hours:!!(t.date&fr),minutes:!!(t.date&mr),seconds:!!(t.date&gr),clockType:t.clock===12?12:24}}const XE=[[So,/^General/i,0],[Oo,/^#/,0],[Gn,/^0/,0],[vo,/^\?/,0],[wo,/^\//,0],[Ao,/^;/,0],[Ks,/^@/,0],[To,/^\+/,0],[yo,/^-/,0],[Ms,/^\./,0],[No,/^ /,0],[Mo,/^%/,0],[Xs,/^[1-9]/,0],[Lo,/^(?:B[12])/i,0],[Mr,/^B$/,0],[Do,/^(?:[hH]+|[mM]+|[sS]+|[yY]+|[bB]+|[dD]+|[gG]+|[aA]{3,}|e+)/,0],[xo,/^(?:\[(h+|m+|s+)\])/i,1],[Uo,/^\[(<[=>]?|>=?|=)\s*(-?[.\d]+)\]/,[1,2]],[Po,/^\[(DBNum[0-4]?\d)\]/i,1],[ko,/^\[(NatNum[0-4]?\d)\]/i,1],[Fo,/^\[\$([^\]]+)\]/,1],[Bo,/^\[(black|blue|cyan|green|magenta|red|white|yellow|color\s*\d+)\]/i,1],[Nu,/^\[([^\]]+)\]/,1],[$o,/^(?:AM\/PM|am\/pm|A\/P)/,0],[Ho,/^\\(.)/,1],[jo,/^"([^"]*?)"/,1],[Wo,/^_(\\.|.)/,1],[Yo,/^[Ee]([+-])/,1],[Go,/^\*(\\.|.)/,1],[Vo,/^[()]/,0],[Mr,/^[EÈÉÊËèéêëĒēĔĕĖėĘęĚěȄȅȆȇȨȩNnÑñŃńŅņŇňǸǹ["*/\\_]/,0],[qs,/^./,0]],qE=63,ZE=35,JE=48,QE=57,Ci=e=>{const t=(e||"\0").charCodeAt(0);return t===qE||t===ZE||t>=JE&&t<=QE};function $n(e){let t=0;const n=[],r=[];for(;t<e.length;){const s=e.slice(t);let i=0;const o=/^(,+)(.)?/.exec(s);if(o){const a=o[1];i=a.length;const l=e[t-1]||"";let c=!1,u=!1;Ci(l)?(c=!0,u=!0):l==="."&&(u=!0);const h=o[2]||"";if(c&&(!h||h===";")&&(c=!1),u&&Ci(h)&&(u=!1),c&&!u)n.push({type:Nr,value:",",raw:a});else if(!c&&u)n.push({type:Ns,value:",",raw:a});else if(c&&u){const d={type:Ns,value:",",raw:a};n.push(d),r.push(d)}else n.push({type:bo,value:",",raw:a})}else{let a;for(const[l,c,u]of XE){const h=c.exec(s);if(h){const d=Array.isArray(u)?u.map(f=>h[f]):h[u||0];a={type:l,value:d,raw:h[0]},n.push(a),i=h[0].length;break}}r.length&&a.raw===";"&&(r.length=0),r.length&&Ci(a.raw)&&(r.forEach(l=>l.type=Nr),r.length=0)}if(!i){const a=s[0];i=1,n.push({type:qs,value:a,raw:a})}t+=i}return n}const Ri=e=>{const t=e.condition;t&&t[1]<0&&(t[0]==="<"||t[0]==="<="||t[0]==="=")||e.tokens.unshift({type:"minus",volatile:!0})},ll=(e,t=null)=>{const n={};for(const r in e)Array.isArray(e[r])?n[r]=[...e[r]]:n[r]=e[r];return t&&n.tokens.unshift(t),n.generated=!0,n};function e0(e){var h;const t=[];let n=!1,r,s=null,i=0,o=!1,a=0,l=0,c=$n(e);do{if(o=_r(c),(o.date||o.general)&&(o.int_pattern.length||o.frac_pattern.length||o.scale!==1||o.text))throw new Error("Illegal format");if(o.condition&&(l++,n=!0),o.text){if(s)throw new Error("Unexpected partition");s=o}o.locale&&(r=Ko(o.locale)),t.push(o),i=((h=c[o.tokensUsed])==null?void 0:h.type)==="break"?1:0,c=c.slice(o.tokensUsed+i),a++}while(i&&a<4&&l<3);if(i)throw new Error("Unexpected partition");if(l>2)throw new Error("Unexpected condition");const u=t[3];if(u&&(u.int_pattern.length||u.frac_pattern.length||u.date))throw new Error("Unexpected partition");if(n){const d=t.length;if(d===1&&(t[1]=_r($n("General")),t[1].generated=!0),d<3){const f=t[0],g=t[1];if(Ri(f),g.condition)Ri(g);else{const _=f.condition;(_[0]==="="||_[1]>=0&&(_[0]===">"||_[0]===">="))&&g.tokens.unshift({type:"minus",volatile:!0})}}else t.forEach(Ri)}else{if(t.length<4&&s)for(let d=0,f=t.length;d<f;d++)t[d]===s&&t.splice(d,1);if(t.length<1&&s&&(t[0]=_r($n("General")),t[0].generated=!0),t.length<2){const d={type:"minus",volatile:!0};t.push(ll(t[0],d))}if(t.length<3&&t.push(ll(t[0])),t.length<4)if(s)t.push(s);else{const d=_r($n("@"));d.generated=!0,t.push(d)}t[0].condition=[">",0],t[1].condition=["<",0],t[2].condition=null}return{pattern:e,partitions:t,locale:r}}const cl=Object.create({});function ln(e,t=!1){e||(e="General");let n=cl[e];if(!n)try{n=e0(e),cl[e]=n}catch(r){if(t)throw r;const s={tokens:[{type:"error"}],error:r.message};n={pattern:e,partitions:[s,s,s,s],error:r.message,locale:null}}return n}function qu(e,t,n={}){var o;const r=Object.assign({},Pu,n),s=ln(e,r.throws),i=(o=Jo(t,r))!=null?o:t;return YE(i,s,r)}function t0(e,t,n){var o;const r=Object.assign({},Pu,n),s=ln(e,r.throws),i=(o=Jo(t,r))!=null?o:t;return WE(i,s,r)}function n0(e){const t=ln(e,!1);return Ku(t.partitions)}function r0(e){const t=ln(e,!1);return zu(t.partitions)}function s0(e){const t=ln(e,!1);return Xu(t.partitions)}function i0(e){try{return ln(e,!0),!0}catch{return!1}}function o0(e,t={}){const n=ln(e,!1);return n.info||(n.info=zE(n.partitions,t==null?void 0:t.currency)),n.info}function a0(e){const t=ln(e,!1);return t.dateInfo||(t.dateInfo=KE(t.partitions)),t.dateInfo}const Ln=Object.freeze({AMPM:$o,BREAK:Ao,CALENDAR:Lo,CHAR:qs,COLOR:Bo,COMMA:bo,CONDITION:Uo,DATETIME:Do,DBNUM:Po,DIGIT:Xs,DURATION:xo,ERROR:Mr,ESCAPED:Ho,EXP:Yo,FILL:Go,GENERAL:So,GROUP:Nr,HASH:Oo,LOCALE:Fo,MINUS:yo,MODIFIER:Nu,NATNUM:ko,PAREN:Vo,PERCENT:Mo,PLUS:To,POINT:Ms,QMARK:vo,SCALE:Ns,SKIP:Wo,SLASH:wo,SPACE:No,STRING:jo,TEXT:Ks,ZERO:Gn}),l0=Object.freeze(Object.defineProperty({__proto__:null,addLocale:te,dateFromSerial:yE,dateToSerial:Jo,dec2frac:ku,format:qu,formatColor:t0,getFormatDateInfo:a0,getFormatInfo:o0,getLocale:Qn,isDateFormat:n0,isPercentFormat:r0,isTextFormat:s0,isValidFormat:i0,parseBool:Wu,parseDate:ea,parseLocale:zo,parseNumber:Qo,parseTime:Zs,parseValue:kE,round:Rt,tokenTypes:Ln,tokenize:$n},Symbol.toStringTag,{value:"Module"})),Zu="@@@",Ju="@",Qu="General";function c0(e){return e===Zu||e===Ju}function u0(e){return e==null||e===Qu}const h0=(e,t)=>{if(e&&!t||!e&&t)return!1;const n=i=>{const o=$n(i);let a="",l=!1,c=!1;for(const u of o){if(u.type===Ln.POINT){l=!0;continue}if(!(c&&u.type===Ln.MINUS)&&u.type!==Ln.SKIP){if(u.type===Ln.COLOR){c=!0;continue}else c=!1;l&&u.type===Ln.ZERO||(l=!1,l||(a+=u.value||""))}}return a},r=n(e),s=n(t);return r===s},d0=new Set(["m d"]),f0=new Set(["h:mm AM/PM","hh:mm AM/PM"]),m0=e=>{var s,i;const t=(i=(s=ea(e))!=null?s:Zs(e))!=null?i:Qo(e);if(!t)return null;const{v:n,z:r}=t;return r&&(d0.has(r)||f0.has(r)&&!/\s(A|AM|P|PM)$/i.test(e)||r.includes("#,##0")&&qu(r,n)!==e)?null:t},g0={sheetId:"",range:{startRow:-1,endRow:-1,startColumn:-1,endColumn:-1}},_0={startRow:-1,startColumn:-1,endRow:-1,endColumn:-1},p0={startRow:0,startColumn:0,endRow:0,endColumn:0},E0={row:0,column:0},st={ff:"Arial",fs:11,it:ie.FALSE,bl:ie.FALSE,ul:{s:ie.FALSE},st:{s:ie.FALSE},ol:{s:ie.FALSE},tr:{a:0,v:ie.FALSE},td:Tr.UNSPECIFIED,cl:{rgb:"#000000"},bg:{rgb:"#fff"},ht:Tt.UNSPECIFIED,vt:_n.UNSPECIFIED,tb:In.UNSPECIFIED,pd:{t:0,r:0,b:0,l:0},n:null,bd:{b:null,l:null,r:null,t:null}},eh={id:"default_slide",title:"defaultSlide",pageSize:{width:300,height:300}},C0=[io,Nl,oo],R0={[Xe.HEADING_1]:{fs:20,bl:1},[Xe.HEADING_2]:{fs:18,bl:1},[Xe.HEADING_3]:{fs:16,bl:1},[Xe.HEADING_4]:{fs:14,bl:1},[Xe.HEADING_5]:{fs:12,bl:1},[Xe.NORMAL_TEXT]:null,[Xe.TITLE]:{fs:26,bl:1},[Xe.SUBTITLE]:{fs:15,cl:{rgb:"#999999"}},[Xe.NAMED_STYLE_TYPE_UNSPECIFIED]:null},An=4,I0={[Xe.HEADING_1]:{spaceAbove:{v:20},spaceBelow:{v:6+An}},[Xe.HEADING_2]:{spaceAbove:{v:18},spaceBelow:{v:6+An}},[Xe.HEADING_3]:{spaceAbove:{v:16},spaceBelow:{v:6+An}},[Xe.HEADING_4]:{spaceAbove:{v:14},spaceBelow:{v:4+An}},[Xe.HEADING_5]:{spaceAbove:{v:12},spaceBelow:{v:4+An}},[Xe.NORMAL_TEXT]:{spaceAbove:{v:0},spaceBelow:{v:0}},[Xe.TITLE]:{spaceAbove:{v:0},spaceBelow:{v:3+An}},[Xe.SUBTITLE]:{spaceAbove:{v:0},spaceBelow:{v:16}},[Xe.NAMED_STYLE_TYPE_UNSPECIFIED]:null},S0="univer-sheets-chart-print-chart",O0="univer-docs-drawing-printing";var th=(e=>(e.ARRAY_CONVERTOR="ARRAY_CONVERTOR",e.MATRIX_CONVERTOR="MATRIX_CONVERTOR",e))(th||{});const v0={[ct.A3]:{width:1123,height:1587},[ct.A4]:{width:794,height:1124},[ct.A5]:{width:559,height:794},[ct.B4]:{width:944,height:1344},[ct.B5]:{width:665,height:944},[ct.Executive]:{width:696,height:1008},[ct.Folio]:{width:816,height:1248},[ct.Legal]:{width:816,height:1344},[ct.Letter]:{width:816,height:1056},[ct.Statement]:{width:528,height:816},[ct.Tabloid]:{width:1056,height:1632}};function ns(e,t){const{textRuns:n=[]}=t;let r=0;for(const i of n){const{ts:o={},st:a,ed:l}=i;if(o[e]==null)return ie.FALSE;switch(e){case"bl":case"it":{if(o[e]===ie.FALSE)return ie.FALSE;break}case"ul":case"st":{if(o[e].s===ie.FALSE)return ie.FALSE;break}default:throw new Error(`unknown style key: ${e} in IStyleBase`)}r+=l-a}return t.dataStream.indexOf(`\r
`)===r?ie.TRUE:ie.FALSE}const br=class br{constructor(t,n,r){p(this,"_range");p(this,"_worksheet");this._deps=r,this._range=n,this._worksheet=t}static foreach(t,n){const{startRow:r,startColumn:s,endRow:i,endColumn:o}=t;for(let a=r;a<=i;a++)for(let l=s;l<=o;l++)n(a,l)}getRangeData(){return this._range}getValue(){return this.getValues()[0][0]}getValues(){const{startRow:t,endRow:n,startColumn:r,endColumn:s}=this._range,i=[];for(let o=t;o<=n;o++){const a=[];for(let l=r;l<=s;l++)a.push(this.getMatrix().getValue(o,l)||null);i.push(a)}return i}getMatrix(){const{startRow:t,endRow:n,startColumn:r,endColumn:s}=this._range,i=this._worksheet.getCellMatrix(),o=new dt;for(let a=t;a<=n;a++)for(let l=r;l<=s;l++)o.setValue(a,l,i.getValue(a,l)||null);return o}getMatrixObject(){const{startRow:t,endRow:n,startColumn:r,endColumn:s}=this._range,i=this._worksheet.getCellMatrix(),o=new dt;for(let a=t;a<=n;a++)for(let l=r;l<=s;l++)o.setValue(a-t,l-r,i.getValue(a,l)||{});return o}getA1Notation(){const{startRow:t,endRow:n,startColumn:r,endColumn:s}=this._range;let i,o;return r<s?(i=Z.numToWord(r+1)+(t+1),o=Z.numToWord(s+1)+(n+1)):(i=Z.numToWord(s+1)+(n+1),o=Z.numToWord(r+1)+(t+1)),i===o?`${i}`:`${i}:${o}`}getBackground(){return this.getBackgrounds()[0][0]}getBackgrounds(){const t=this._deps.getStyles();return this.getValues().map(n=>n.map(r=>{var i;const s=t.getStyleByCell(r);return((i=s==null?void 0:s.bg)==null?void 0:i.rgb)||st.bg.rgb}))}getCell(t,n){const{startRow:r,startColumn:s}=this._range,i={startRow:r+t,endRow:r+t,startColumn:s+n,endColumn:s+n};return new br(this._worksheet,i,this._deps)}getColumn(){return this._range.startColumn}getObjectValue(t={}){return this.getObjectValues(t)[0][0]}getObjectValues(t={}){var a;const{startRow:n,endRow:r,startColumn:s,endColumn:i}=this._range,o=this._worksheet.getCellMatrix().getFragment(n,r,s,i).getData();if(t.isIncludeStyle){const l=this._deps.getStyles();for(let c=0;c<=r-n;c++)for(let u=0;u<=i-s;u++){if(o==null||((a=o==null?void 0:o[c])==null?void 0:a[u])==null)continue;const h=o[c][u].s;h&&(o[c][u].s=l.get(h))}}return o}getFontColor(){return this.getFontColors()[0][0]}getFontColors(){const t=this._deps.getStyles();return this.getValues().map(n=>n.map(r=>{var i;const s=t.getStyleByCell(r);return((i=s==null?void 0:s.cl)==null?void 0:i.rgb)||st.cl.rgb}))}getFontFamilies(){return this._getStyles("ff")}getFontFamily(){return this.getFontFamilies()[0][0]}getUnderlines(){return this._getStyles("ul")}getUnderline(){var n,r;const{p:t}=(n=this.getValue())!=null?n:{};return t&&Array.isArray((r=t.body)==null?void 0:r.textRuns)&&t.body.textRuns.length>0?ns("ul",t.body)===ie.TRUE?{s:ie.TRUE}:{s:ie.FALSE}:this.getUnderlines()[0][0]}getOverlines(){return this._getStyles("ol")}getOverline(){return this.getOverlines()[0][0]}getStrikeThrough(){var n,r;const{p:t}=(n=this.getValue())!=null?n:{};return t&&Array.isArray((r=t.body)==null?void 0:r.textRuns)&&t.body.textRuns.length>0?ns("st",t.body)===ie.TRUE?{s:ie.TRUE}:{s:ie.FALSE}:this.getStrikeThroughs()[0][0]}getStrikeThroughs(){return this._getStyles("st")}getFontSize(){var n,r;const t=((n=this.getValue())==null?void 0:n.p)||{};return t&&Array.isArray((r=t.body)==null?void 0:r.textRuns)&&t.body.textRuns.length>0?t.body.textRuns.some(s=>{var i;return((i=s==null?void 0:s.ts)==null?void 0:i.fs)!=null})?Math.max(...t.body.textRuns.map(s=>{var i;return((i=s==null?void 0:s.ts)==null?void 0:i.fs)||0})):this.getFontSizes()[0][0]:this.getFontSizes()[0][0]}getFontSizes(){return this._getStyles("fs")}getBorder(){return this.getBorders()[0][0]}getBorders(){return this._getStyles("bd")}getFontStyle(){var n,r;const{p:t}=(n=this.getValue())!=null?n:{};return t&&Array.isArray((r=t.body)==null?void 0:r.textRuns)&&t.body.textRuns.length>0?ns("it",t.body)===ie.TRUE?bs.ITALIC:bs.NORMAL:this._getFontStyles()[0][0]}_getFontStyles(){return this._getStyles("it")}getFontWeight(){var n,r;const{p:t}=(n=this.getValue())!=null?n:{};return t&&Array.isArray((r=t.body)==null?void 0:r.textRuns)&&t.body.textRuns.length>0?ns("bl",t.body)===ie.TRUE?As.BOLD:As.NORMAL:this._getFontWeights()[0][0]}_getFontWeights(){return this._getStyles("bl")}getGridId(){return this._worksheet.getSheetId()}getHeight(){const{_range:t,_worksheet:n}=this,{startRow:r,endRow:s}=t;let i=0;for(let o=0;o<=s-r;o++){const a=n.getRowHeight(o);i+=a}return i}getHorizontalAlignment(){return this.getHorizontalAlignments()[0][0]}getHorizontalAlignments(){return this._getStyles("ht")}getLastColumn(){return this._range.endColumn}getLastRow(){return this._range.endRow}getNumColumns(){const{startColumn:t,endColumn:n}=this._range;return n-t+1}getNumRows(){const{startRow:t,endRow:n}=this._range;return n-t+1}getRichTextValue(){return this.getRichTextValues()[0][0]}getRichTextValues(){return this.getValues().map(t=>t.map(n=>(n==null?void 0:n.p)||""))}getRowIndex(){return this._range.startRow}getSheet(){return this._worksheet}getTextDirection(){return this.getTextDirections()[0][0]}getTextDirections(){return this._getStyles("td")}getTextRotation(){return this.getTextRotations()[0][0]}getTextRotations(){return this._getStyles("tr")}getTextStyle(){return this.getTextStyles()[0][0]}getTextStyles(){const t=this._deps.getStyles();return this.getValues().map(n=>n.map(r=>t.getStyleByCell(r)))}getVerticalAlignment(){return this.getVerticalAlignments()[0][0]}getVerticalAlignments(){return this._getStyles("vt")}getWidth(){const{_range:t,_worksheet:n}=this,{startColumn:r,endColumn:s}=t;let i=0;for(let o=0;o<=s-r;o++)i+=n.getColumnWidth(o);return i}getWrap(){return this.getWrapStrategy()===In.WRAP?ie.TRUE:ie.FALSE}getWrapStrategies(){return this._getStyles("tb")}getWrapStrategy(){return this.getWrapStrategies()[0][0]}forEach(t){br.foreach(this._range,t)}_getStyles(t){const n=this._deps.getStyles();return this.getValues().map(r=>r.map(s=>{const i=n&&n.getStyleByCell(s);return i&&i[t]||st[t]}))}};p(br,"transformRange",(t,n)=>{const r=n.getMaxColumns()-1,s=n.getMaxRows()-1;return t.rangeType===_e.ALL?{startColumn:0,startRow:0,endColumn:r,endRow:s}:t.rangeType===_e.COLUMN?{startRow:0,endRow:s,startColumn:t.startColumn,endColumn:t.endColumn}:t.rangeType===_e.ROW?{startColumn:0,endColumn:r,startRow:t.startRow,endRow:t.endRow}:{startColumn:t.startColumn,endColumn:Math.min(t.endColumn,r),startRow:t.startRow,endRow:Math.min(t.endRow,s)}});let Kn=br;function nh(e,t,n=0,r=e.length-1,s=w0){for(;r>n;){if(r-n>600){const l=r-n+1,c=t-n+1,u=Math.log(l),h=.5*Math.exp(2*u/3),d=.5*Math.sqrt(u*h*(l-h)/l)*(c-l/2<0?-1:1),f=Math.max(n,Math.floor(t-c*h/l+d)),g=Math.min(r,Math.floor(t+(l-c)*h/l+d));nh(e,t,f,g,s)}const i=e[t];let o=n,a=r;for(sr(e,n,t),s(e[r],i)>0&&sr(e,n,r);o<a;){for(sr(e,o,a),o++,a--;s(e[o],i)<0;)o++;for(;s(e[a],i)>0;)a--}s(e[n],i)===0?sr(e,n,a):(a++,sr(e,a,r)),a<=t&&(n=a+1),t<=a&&(r=a-1)}}function sr(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function w0(e,t){return e<t?-1:e>t?1:0}class Ls{constructor(t=9){this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(t){let n=this.data;const r=[];if(!ss(t,n))return r;const s=this.toBBox,i=[];for(;n;){for(let o=0;o<n.children.length;o++){const a=n.children[o],l=n.leaf?s(a):a;ss(t,l)&&(n.leaf?r.push(a):Si(t,l)?this._all(a,r):i.push(a))}n=i.pop()}return r}collides(t){let n=this.data;if(!ss(t,n))return!1;const r=[];for(;n;){for(let s=0;s<n.children.length;s++){const i=n.children[s],o=n.leaf?this.toBBox(i):i;if(ss(t,o)){if(n.leaf||Si(t,o))return!0;r.push(i)}}n=r.pop()}return!1}load(t){if(!(t&&t.length))return this;if(t.length<this._minEntries){for(let r=0;r<t.length;r++)this.insert(t[r]);return this}let n=this._build(t.slice(),0,t.length-1,0);if(!this.data.children.length)this.data=n;else if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){const r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}return this}insert(t){return t&&this._insert(t,this.data.height-1),this}clear(){return this.data=Dn([]),this}remove(t,n){if(!t)return this;let r=this.data;const s=this.toBBox(t),i=[],o=[];let a,l,c;for(;r||i.length;){if(r||(r=i.pop(),l=i[i.length-1],a=o.pop(),c=!0),r.leaf){const u=b0(t,r.children,n);if(u!==-1)return r.children.splice(u,1),i.push(r),this._condense(i),this}!c&&!r.leaf&&Si(r,s)?(i.push(r),o.push(a),a=0,l=r,r=r.children[0]):l?(a++,r=l.children[a],c=!1):r=null}return this}toBBox(t){return t}compareMinX(t,n){return t.minX-n.minX}compareMinY(t,n){return t.minY-n.minY}toJSON(){return this.data}fromJSON(t){return this.data=t,this}_all(t,n){const r=[];for(;t;)t.leaf?n.push(...t.children):r.push(...t.children),t=r.pop();return n}_build(t,n,r,s){const i=r-n+1;let o=this._maxEntries,a;if(i<=o)return a=Dn(t.slice(n,r+1)),Tn(a,this.toBBox),a;s||(s=Math.ceil(Math.log(i)/Math.log(o)),o=Math.ceil(i/Math.pow(o,s-1))),a=Dn([]),a.leaf=!1,a.height=s;const l=Math.ceil(i/o),c=l*Math.ceil(Math.sqrt(o));ul(t,n,r,c,this.compareMinX);for(let u=n;u<=r;u+=c){const h=Math.min(u+c-1,r);ul(t,u,h,l,this.compareMinY);for(let d=u;d<=h;d+=l){const f=Math.min(d+l-1,h);a.children.push(this._build(t,d,f,s-1))}}return Tn(a,this.toBBox),a}_chooseSubtree(t,n,r,s){for(;s.push(n),!(n.leaf||s.length-1===r);){let i=1/0,o=1/0,a;for(let l=0;l<n.children.length;l++){const c=n.children[l],u=Ii(c),h=y0(t,c)-u;h<o?(o=h,i=u<i?u:i,a=c):h===o&&u<i&&(i=u,a=c)}n=a||n.children[0]}return n}_insert(t,n,r){const s=r?t:this.toBBox(t),i=[],o=this._chooseSubtree(s,this.data,n,i);for(o.children.push(t),Er(o,s);n>=0&&i[n].children.length>this._maxEntries;)this._split(i,n),n--;this._adjustParentBBoxes(s,i,n)}_split(t,n){const r=t[n],s=r.children.length,i=this._minEntries;this._chooseSplitAxis(r,i,s);const o=this._chooseSplitIndex(r,i,s),a=Dn(r.children.splice(o,r.children.length-o));a.height=r.height,a.leaf=r.leaf,Tn(r,this.toBBox),Tn(a,this.toBBox),n?t[n-1].children.push(a):this._splitRoot(r,a)}_splitRoot(t,n){this.data=Dn([t,n]),this.data.height=t.height+1,this.data.leaf=!1,Tn(this.data,this.toBBox)}_chooseSplitIndex(t,n,r){let s,i=1/0,o=1/0;for(let a=n;a<=r-n;a++){const l=pr(t,0,a,this.toBBox),c=pr(t,a,r,this.toBBox),u=N0(l,c),h=Ii(l)+Ii(c);u<i?(i=u,s=a,o=h<o?h:o):u===i&&h<o&&(o=h,s=a)}return s||r-n}_chooseSplitAxis(t,n,r){const s=t.leaf?this.compareMinX:A0,i=t.leaf?this.compareMinY:T0,o=this._allDistMargin(t,n,r,s),a=this._allDistMargin(t,n,r,i);o<a&&t.children.sort(s)}_allDistMargin(t,n,r,s){t.children.sort(s);const i=this.toBBox,o=pr(t,0,n,i),a=pr(t,r-n,r,i);let l=rs(o)+rs(a);for(let c=n;c<r-n;c++){const u=t.children[c];Er(o,t.leaf?i(u):u),l+=rs(o)}for(let c=r-n-1;c>=n;c--){const u=t.children[c];Er(a,t.leaf?i(u):u),l+=rs(a)}return l}_adjustParentBBoxes(t,n,r){for(let s=r;s>=0;s--)Er(n[s],t)}_condense(t){for(let n=t.length-1,r;n>=0;n--)t[n].children.length===0?n>0?(r=t[n-1].children,r.splice(r.indexOf(t[n]),1)):this.clear():Tn(t[n],this.toBBox)}}function b0(e,t,n){if(!n)return t.indexOf(e);for(let r=0;r<t.length;r++)if(n(e,t[r]))return r;return-1}function Tn(e,t){pr(e,0,e.children.length,t,e)}function pr(e,t,n,r,s){s||(s=Dn(null)),s.minX=1/0,s.minY=1/0,s.maxX=-1/0,s.maxY=-1/0;for(let i=t;i<n;i++){const o=e.children[i];Er(s,e.leaf?r(o):o)}return s}function Er(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function A0(e,t){return e.minX-t.minX}function T0(e,t){return e.minY-t.minY}function Ii(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function rs(e){return e.maxX-e.minX+(e.maxY-e.minY)}function y0(e,t){return(Math.max(t.maxX,e.maxX)-Math.min(t.minX,e.minX))*(Math.max(t.maxY,e.maxY)-Math.min(t.minY,e.minY))}function N0(e,t){const n=Math.max(e.minX,t.minX),r=Math.max(e.minY,t.minY),s=Math.min(e.maxX,t.maxX),i=Math.min(e.maxY,t.maxY);return Math.max(0,s-n)*Math.max(0,i-r)}function Si(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function ss(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function Dn(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function ul(e,t,n,r,s){const i=[t,n];for(;i.length;){if(n=i.pop(),t=i.pop(),n-t<=r)continue;const o=t+Math.ceil((n-t)/r/2)*r;nh(e,o,t,n,s),i.push(t,o,o,n)}}function M0(e,t,n,r=!1){if(t===0&&n===0)return e;let s={...e};const i=s.startAbsoluteRefType||Ne.NONE,o=s.endAbsoluteRefType||Ne.NONE,a=s.rangeType||_e.NORMAL;if(!r&&i===Ne.ALL&&o===Ne.ALL)return s;const l=hl(s.startRow,n,s.startColumn,t,a),c=hl(s.endRow,n,s.endColumn,t,a);return r||i===Ne.NONE&&o===Ne.NONE?s={...s,startRow:l.row,startColumn:l.column,endRow:c.row,endColumn:c.column}:(i===Ne.NONE?s={...s,startRow:l.row,startColumn:l.column}:i===Ne.COLUMN?s={...s,startRow:l.row}:i===Ne.ROW&&(s={...s,startColumn:l.column}),o===Ne.NONE?s={...s,endRow:c.row,endColumn:c.column}:o===Ne.COLUMN?s={...s,endRow:c.row}:o===Ne.ROW&&(s={...s,endColumn:c.column}),s)}function hl(e,t,n,r,s){return s===_e.NORMAL?{row:e+t,column:n+r}:s===_e.ROW?{row:e+t,column:n}:s===_e.COLUMN?{row:e,column:n+r}:{row:e,column:n}}function ta(e){const t=new Set,n=new Set;for(const o of e)t.add(o.startColumn),t.add(o.endColumn+1),n.add(o.startRow),n.add(o.endRow+1);const r=Array.from(t).sort((o,a)=>o-a),s=Array.from(n).sort((o,a)=>o-a);e.sort((o,a)=>o.startRow-a.startRow||o.startColumn-a.startColumn);const i=[];for(let o=0;o<s.length-1;o++)for(let a=0;a<r.length-1;a++){const l=r[a],c=r[a+1]-1,u=s[o],h=s[o+1]-1;for(const d of e){if(d.startRow>h)break;if(d.startRow<=u&&d.endRow>=h&&d.startColumn<=l&&d.endColumn>=c){i.push({startColumn:l,endColumn:c,startRow:u,endRow:h});break}}}return i}function L0(e){e.sort((r,s)=>r.startRow-s.startRow||r.startColumn-s.startColumn);const t={};for(const r of e)t[r.startRow]||(t[r.startRow]=[]),t[r.startRow].push(r);const n=[];for(const r in t){const s=t[+r];s.sort((o,a)=>o.startColumn-a.startColumn);let i=s[0];for(let o=1;o<s.length;o++){const a=s[o];a.startColumn<=i.endColumn+1&&a.startRow===i.startRow&&a.endRow===i.endRow?i.endColumn=Math.max(i.endColumn,a.endColumn):(n.push(i),i=a)}n.push(i)}return n}function D0(e){e.sort((r,s)=>r.startColumn-s.startColumn||r.startRow-s.startRow);const t={};for(const r of e)t[r.startColumn]||(t[r.startColumn]=[]),t[r.startColumn].push(r);const n=[];for(const r in t){const s=t[+r];s.sort((o,a)=>o.startRow-a.startRow);let i=s[0];for(let o=1;o<s.length;o++){const a=s[o];a.startRow<=i.endRow+1&&a.startColumn===i.startColumn&&a.endColumn===i.endColumn?i.endRow=Math.max(i.endRow,a.endRow):(n.push(i),i=a)}n.push(i)}return n}function x0(e){const t=ta(e),n=L0(t);return D0(n)}function U0(e,t){const n=[];return e.forEach(r=>{n.push(...on.subtract(r,t))}),on.mergeRanges(n)}function rh(e,t){const n=dl(e.startRow,e.endRow,t.startRow,t.endRow),r=dl(e.startColumn,e.endColumn,t.startColumn,t.endColumn);if(!n||!r)return null;const[s,i]=n,[o,a]=r,l=P0(e.rangeType,t.rangeType,s,i,o,a);return{startRow:s,endRow:i,startColumn:o,endColumn:a,rangeType:l}}function dl(e,t,n,r){const s=isNaN(e)?-1/0:e,i=isNaN(t)?1/0:t,o=isNaN(n)?-1/0:n,a=isNaN(r)?1/0:r,l=Math.max(s,o),c=Math.min(i,a);if(l<=c){const u=l===-1/0?Number.NaN:l,h=c===1/0?Number.NaN:c;return[u,h]}else return null}function P0(e,t,n,r,s,i){const o=e!==void 0?e:fl(n,r,s,i),a=t!==void 0?t:fl(n,r,s,i);return o===_e.ALL||a===_e.ALL?o===a?o:o===_e.ALL?a:o:o===a?o:(o===_e.NORMAL||a===_e.NORMAL,_e.NORMAL)}function fl(e,t,n,r){const s=!isNaN(e)&&!isNaN(t),i=!isNaN(n)&&!isNaN(r);return s&&i?_e.NORMAL:s?_e.ROW:i?_e.COLUMN:_e.ALL}const Wt=class Wt{static clone(t){return t.rangeType!==void 0?{startRow:t.startRow,startColumn:t.startColumn,endRow:t.endRow,endColumn:t.endColumn,rangeType:t.rangeType}:{startRow:t.startRow,startColumn:t.startColumn,endRow:t.endRow,endColumn:t.endColumn}}static equals(t,n){return t==null||n==null?!1:t.endRow===n.endRow&&t.endColumn===n.endColumn&&t.startRow===n.startRow&&t.startColumn===n.startColumn&&(t.rangeType===n.rangeType||t.rangeType===void 0&&n.rangeType===_e.NORMAL||n.rangeType===void 0&&t.rangeType===_e.NORMAL)}static simpleRangesIntersect(t,n){const{startRow:r,endRow:s,startColumn:i,endColumn:o}=t,{startRow:a,endRow:l,startColumn:c,endColumn:u}=n,h=r<=l&&s>=a,d=i<=u&&o>=c;return h&&d}static intersects(t,n){if(t.rangeType===_e.ROW&&n.rangeType===_e.COLUMN||t.rangeType===_e.COLUMN&&n.rangeType===_e.ROW)return!0;if(t.rangeType===_e.ROW&&n.rangeType===_e.ROW)return t.startRow<=n.endRow&&t.endRow>=n.startRow;if(t.rangeType===_e.COLUMN&&n.rangeType===_e.COLUMN)return t.startColumn<=n.endColumn&&t.endColumn>=n.startColumn;const r=Math.floor(Number.MAX_SAFE_INTEGER/10),s=Number.isNaN(t.startRow)?0:t.startRow,i=Number.isNaN(t.endRow)?r:t.endRow,o=Number.isNaN(t.startColumn)?0:t.startColumn,a=Number.isNaN(t.endColumn)?r:t.endColumn,l=Number.isNaN(n.startRow)?0:n.startRow,c=Number.isNaN(n.endRow)?r:n.endRow,u=Number.isNaN(n.startColumn)?0:n.startColumn,h=Number.isNaN(n.endColumn)?r:n.endColumn,d=Math.abs(o+a-u-h),f=Math.abs(o-a)+Math.abs(u-h),g=Math.abs(s+i-l-c),_=Math.abs(s-i)+Math.abs(l-c);return d<=f&&g<=_}static doAnyRangesIntersect(t,n){const r=new Ls;return r.load(t.map(s=>({minX:s.startColumn,minY:s.startRow,maxX:s.endColumn,maxY:s.endRow}))),n.some(s=>r.search({minX:s.startColumn,minY:s.startRow,maxX:s.endColumn,maxY:s.endRow}).length>0)}static getIntersects(t,n){const r=t.startRow,s=t.endRow,i=t.startColumn,o=t.endColumn,a=n.startRow,l=n.endRow,c=n.startColumn,u=n.endColumn;let h,d,f,g;if(a<=s)a>=r?d=a:d=r;else return null;if(l>=r)l>=s?g=s:g=l;else return null;if(c<=o)c>i?h=c:h=i;else return null;if(u>=i)u>=o?f=o:f=u;else return null;return{startRow:d,endRow:g,startColumn:h,endColumn:f,rangeType:_e.NORMAL}}static contains(t,n){return t.startRow<=n.startRow&&t.endRow>=n.endRow&&t.startColumn<=n.startColumn&&t.endColumn>=n.endColumn}static realContain(t,n){return Wt.contains(t,n)&&(t.startRow<n.startRow||t.endRow>n.endRow||t.startColumn<n.startColumn||t.endColumn>n.endColumn)}static union(...t){return t.reduce((n,r)=>({startRow:Math.min(n.startRow,r.startRow),startColumn:Math.min(n.startColumn,r.startColumn),endRow:Math.max(n.endRow,r.endRow),endColumn:Math.max(n.endColumn,r.endColumn),rangeType:_e.NORMAL}),t[0])}static realUnion(...t){const n=t.some(i=>i.rangeType===_e.COLUMN),r=t.some(i=>i.rangeType===_e.ROW),s=Wt.union(...t);return{startColumn:r?Number.NaN:s.startColumn,endColumn:r?Number.NaN:s.endColumn,startRow:n?Number.NaN:s.startRow,endRow:n?Number.NaN:s.endRow,rangeType:r?_e.ROW:n?_e.COLUMN:_e.NORMAL}}static subtract(t,n){if(n.startRow>t.endRow||n.endRow<t.startRow||n.startColumn>t.endColumn||n.endColumn<t.startColumn)return[t];const r=[];n.startRow>=t.startRow&&r.push({startRow:t.startRow,startColumn:t.startColumn,endRow:n.startRow-1,endColumn:t.endColumn}),n.endRow<=t.endRow&&r.push({startRow:n.endRow+1,startColumn:t.startColumn,endRow:t.endRow,endColumn:t.endColumn});const s=Math.max(t.startRow,n.startRow),i=Math.min(t.endRow,n.endRow);return n.startColumn>=t.startColumn&&r.push({startRow:s,startColumn:t.startColumn,endRow:i,endColumn:n.startColumn-1}),n.endColumn<=t.endColumn&&r.push({startRow:s,startColumn:n.endColumn+1,endRow:i,endColumn:t.endColumn}),r.filter(a=>a.startRow<=a.endRow&&a.startColumn<=a.endColumn)}static mergeRanges(t){return x0(t)}static splitIntoGrid(t){return ta(t)}static subtractMulti(t,n){if(!n.length)return t;let r=t;return n.forEach(s=>{r=U0(r,s)}),r}static hasIntersectionBetweenTwoRect(t,n){return!(t.left>n.right||t.right<n.left||t.top>n.bottom||t.bottom<n.top)}static getIntersectionBetweenTwoRect(t,n){const r=Math.max(t.left,n.left),s=Math.min(t.right,n.right),i=Math.max(t.top,n.top),o=Math.min(t.bottom,n.bottom);return s<=r||o<=i?null:{left:r,right:s,top:i,bottom:o,width:s-r,height:o-i}}static sort(t){return t.sort((n,r)=>n.startRow-r.startRow||n.startColumn-r.startColumn)}};p(Wt,"getRelativeRange",(t,n)=>({startRow:t.startRow-n.startRow,endRow:t.endRow-t.startRow,startColumn:t.startColumn-n.startColumn,endColumn:t.endColumn-t.startColumn})),p(Wt,"getPositionRange",(t,n,r)=>({...r||{},startRow:r&&[Ne.ROW,Ne.ALL].includes(r.startAbsoluteRefType||0)?r.startRow:t.startRow+n.startRow,endRow:r&&[Ne.ROW,Ne.ALL].includes(r.endAbsoluteRefType||0)?r.endRow:t.endRow+t.startRow+n.startRow,startColumn:r&&[Ne.COLUMN,Ne.ALL].includes(r.startAbsoluteRefType||0)?r.startColumn:t.startColumn+n.startColumn,endColumn:r&&[Ne.COLUMN,Ne.ALL].includes(r.endAbsoluteRefType||0)?r.endColumn:t.endColumn+t.startColumn+n.startColumn})),p(Wt,"moveHorizontal",(t,n=0,r=0)=>({...t,startColumn:t.startColumn+n,endColumn:t.endColumn+n+r})),p(Wt,"moveVertical",(t,n=0,r=0)=>({...t,startRow:t.startRow+n,endRow:t.endRow+n+r})),p(Wt,"moveOffset",(t,n,r)=>{const s={...t};switch(t.startAbsoluteRefType){case Ne.ROW:s.startColumn+=n;break;case Ne.COLUMN:s.startRow+=r;break;case Ne.ALL:break;case Ne.NONE:default:s.startRow+=r,s.startColumn+=n;break}switch(t.endAbsoluteRefType){case Ne.ROW:s.endColumn+=n;break;case Ne.COLUMN:s.endRow+=r;break;case Ne.ALL:break;case Ne.NONE:default:s.endRow+=r,s.endColumn+=n;break}return s});let on=Wt;function k0(e,t){if(e.length===0||e[0].length===0)return null;const n=new Array(e[0].length).fill(0);let r=0,s=null;for(let i=0;i<e.length;i++){for(let a=0;a<e[0].length;a++)n[a]=t(e[i][a])?n[a]+1:0;const o=F0(n);o.area>r&&(r=o.area,s={startColumn:o.start,startRow:i-o.height+1,endColumn:o.end,endRow:i})}return s}function F0(e){const t=[];let n=0,r={area:0,height:0,start:0,end:0},s=0;for(;s<e.length;)if(t.length===0||e[s]>=e[t[t.length-1]])t.push(s++);else{const i=e[t.pop()],o=t.length===0?s:s-t[t.length-1]-1;i*o>n&&(n=i*o,r={area:n,height:i,start:t.length===0?0:t[t.length-1]+1,end:s-1})}for(;t.length>0;){const i=e[t.pop()],o=t.length===0?s:s-t[t.length-1]-1;i*o>n&&(n=i*o,r={area:n,height:i,start:t.length===0?0:t[t.length-1]+1,end:s-1})}return r}function B0(e,t){Kn.foreach(t,(n,r)=>{e[n][r]=void 0})}function $0(e,t){const n=e.toFullArray(),r=[];for(;;){const s=k0(n,t);if(!s)break;r.push(s),B0(n,s)}return r}class H0{constructor(t,n){p(this,"_values",[]);p(this,"_keys",[]);p(this,"_keyMaps",new Map);this._values=t,this._keys=n,t.forEach(r=>{this._initKeyMap(r)})}_initKeyMap(t){this._keys.forEach(n=>{const r=t[n],s=this._keyMaps.get(n)||new Map;s.set(r,t),this._keyMaps.set(n,s)})}getValue(t,n){const r=n||this._keys;for(let s=0;s<r.length;s++){const i=this._keyMaps.get(r[s]);if(i!=null&&i.has(t))return i.get(t)}return null}hasValue(t){for(let n=0;n<this._keys.length;n++){const r=this._keyMaps.get(this._keys[n]);if(r!=null&&r.has(t))return!0}return!1}addValue(t){this._values.push(t),this._initKeyMap(t)}setValue(t,n,r){const s=this.getValue(t);s&&Object.keys(s).includes(n)&&(s[n]=r)}deleteValue(t,n){const r=this.getValue(t,n);if(r){this._keys.forEach(i=>{const o=this._keyMaps.get(i),a=r[i];o==null||o.delete(a)});const s=this._values.findIndex(i=>i===r);this._values.splice(s,1)}}getValues(){return this._values}getKeyMap(t){var n;return[...((n=this._keyMaps.get(t))==null?void 0:n.keys())||[]]}clear(){this._values=[],this._keys=[],this._keyMaps.clear()}}function Vi(e,t,n,r){return{forEach(s){for(let i=e;i<=t;i++)for(let o=n;o<=r;o++)s(i,o)}}}function j0(e){if(e==null||e.length===0)return Number.NaN;const t=e.toLowerCase().split(""),n=t.length,r=o=>o.charCodeAt(0)-96;let s=0,i=0;for(let o=0;o<n;o++)i=r(t[o]),s+=i*26**(n-o-1);return s===0?Number.NaN:s-1}const Ds=65,sh=90,W0=97;function Y0(e){const t=sh-Ds+1;let n="";for(;e>=0;)n=String.fromCharCode(e%t+Ds)+n,e=Math.floor(e/t)-1;return n}function ih(e,t){let n="";for(;t>0;)n+=e,t--;return n}function G0(e,t=!1){const n=sh-Ds+1;let r=W0;t&&(r=Ds);const s=String.fromCharCode(e%n+r),i=Math.floor(e/n)+1;return ih(s,i)}function V0(e,t){return e.zIndex>t.zIndex?1:e.zIndex===t.zIndex?0:-1}function z0(e,t){return e.zIndex>t.zIndex?-1:e.zIndex===t.zIndex?0:1}function jr(e="index",t=1){return(n,r)=>n[e]>r[e]?t:n[e]===r[e]?0:-t}function Wr(e,t=!1){const n=[];for(const r of e){const{st:s,ed:i,ts:o}=r;if(r.sId===void 0&&delete r.sId,s===i||!t&&Z.isEmptyObject(o)&&r.sId==null)continue;if(n.length===0){n.push(r);continue}const a=n.pop();bu(r,a)&&Z.hasIntersectionBetweenTwoRanges(a.st,a.ed,r.st,r.ed)?n.push({...r,st:a.st,ed:i}):n.push(a,r)}return n}function oh(e,t,n,r){var c;const{textRuns:s}=e;if(s==null)return;const i=[],o=s.length;let a=!1;const l=(c=t.textRuns)!=null?c:[];if(l.length)for(const u of l)u.st+=r,u.ed+=r;for(let u=0;u<o;u++){const h=s[u],{st:d,ed:f}=h;if(f<=r)i.push(h);else if(r>d&&r<f){a=!0;const g={...h,ed:r};i.push(g),l.length&&i.push(...l);const _={...h,st:r+n,ed:f+n};i.push(_)}else h.st+=n,h.ed+=n,a||(a=!0,i.push(...l)),i.push(h)}a||(a=!0,i.push(...l)),e.textRuns=Wr(i)}function ah(e,t,n,r){const{paragraphs:s}=e;if(s==null)return;const{paragraphs:i}=t,o=[];for(let l=0,c=s.length;l<c;l++){const u=s[l],{startIndex:h}=u;h>=r&&(u.startIndex+=n),o.push(u.startIndex)}let a=-1;if(i){for(let l=0,c=i.length;l<c;l++){const u=i[l];u.startIndex+=r;const h=u.startIndex;a=o.indexOf(h)}a!==-1&&s.splice(a,1),s.push(...i),s.sort(jr("startIndex"))}}function lh(e,t,n,r){const{sectionBreaks:s}=e;if(s==null)return;for(let o=0,a=s.length;o<a;o++){const l=s[o],{startIndex:c}=l;c>=r&&(l.startIndex+=n)}const i=t.sectionBreaks;if(i){for(let o=0,a=i.length;o<a;o++){const l=i[o];l.startIndex+=r}s.push(...i),s.sort(jr("startIndex"))}}function ch(e,t,n,r){const{customBlocks:s=[]}=e;for(let o=0,a=s.length;o<a;o++){const l=s[o],{startIndex:c}=l;c>=r&&(l.startIndex+=n)}const i=t.customBlocks;if(i){for(let o=0,a=i.length;o<a;o++){const l=i[o];l.startIndex+=r}s.push(...i),s.sort(jr("startIndex"))}s.length&&!e.customBlocks&&(e.customBlocks=s)}function uh(e,t,n,r){const{tables:s}=e;if(s==null)return;for(let o=0,a=s.length;o<a;o++){const l=s[o],{startIndex:c,endIndex:u}=l;c>r?(l.startIndex+=n,l.endIndex+=n):u>r&&(l.endIndex+=n)}const i=t.tables;if(i){for(let o=0,a=i.length;o<a;o++){const l=i[o];l.startIndex+=r,l.endIndex+=r}s.push(...i),s.sort(jr("startIndex"))}}const hh="$",ml=e=>e.split(hh)[0];function na(e){if(e.length<=1)return e;e.sort((s,i)=>s.startIndex-i.startIndex);const t=[];let n={...e[0]};n.rangeId=ml(n.rangeId);for(let s=1;s<e.length;s++){const i=e[s];i.rangeId=ml(i.rangeId),i.rangeId===n.rangeId&&Pl(n.properties,i.properties)&&n.endIndex+1>=i.startIndex?n.endIndex=i.endIndex:(t.push(n),n={...i})}t.push(n);const r=Object.create(null);for(let s=0,i=t.length;s<i;s++){const o=t[s],a=o.rangeId;r[a]?(o.rangeId=`${a}${hh}${r[a]}`,r[a]=r[a]+1):r[a]=1}return t}function zi(e,t){const n=e.findIndex(s=>s.startIndex<t&&s.endIndex>=t),r=e[n];r&&e.splice(n,1,{rangeId:r.rangeId,rangeType:r.rangeType,startIndex:r.startIndex,endIndex:t-1,properties:{...r.properties}},{rangeId:r.rangeId,rangeType:r.rangeType,startIndex:t,endIndex:r.endIndex,properties:{...r.properties}})}function dh(e){if(e.length<=1)return e;e.sort((r,s)=>r.startIndex-s.startIndex);const t=[];let n={...e[0]};for(let r=1;r<e.length;r++){const s=e[r];s.id===n.id&&n.endIndex+1>=s.startIndex?n.endIndex=s.endIndex:(t.push(n),n={...s})}return t.push(n),t}function Ki(e,t){e.filter(r=>r.startIndex<t&&r.endIndex>=t).forEach(r=>{const s=e.indexOf(r);e.splice(s,1,{id:r.id,type:r.type,startIndex:r.startIndex,endIndex:t-1},{id:r.id,type:r.type,startIndex:t,endIndex:r.endIndex})})}function K0(e,t,n,r){e.customRanges||(e.customRanges=[]);const{customRanges:s}=e;zi(s,r);for(let o=0,a=s.length;o<a;o++){const l=s[o],{startIndex:c}=l;c>=r&&(l.startIndex+=n,l.endIndex+=n)}const i=[];if(t.customRanges){for(let o=0,a=t.customRanges.length;o<a;o++){const l=t.customRanges[o];l.startIndex+=r,l.endIndex+=r,i.push(l)}s.push(...i)}e.customRanges=na(s)}function X0(e,t,n,r){e.customDecorations||(e.customDecorations=[]);const{customDecorations:s}=e;Ki(s,r);for(let o=0,a=s.length;o<a;o++){const l=s[o],{startIndex:c}=l;c>=r&&(l.startIndex+=n,l.endIndex+=n)}const i=[];if(t.customDecorations){for(let o=0,a=t.customDecorations.length;o<a;o++){const l=t.customDecorations[o];l.startIndex+=r,l.endIndex+=r,i.push(l)}s.push(...i)}e.customDecorations=dh(s)}function fh(e,t,n){const{textRuns:r}=e,s=n,i=n+t,o=[];if(r){const a=[];for(let l=0,c=r.length;l<c;l++){const u=r[l],{st:h,ed:d}=u;if(s<=h&&i>=d){o.push({...u,st:h-s,ed:d-s});continue}else h<=s&&d>=i?(o.push({...u,st:s-s,ed:i-s}),u.ed-=t):s>=h&&s<d?(o.push({...u,st:s-s,ed:d-s}),u.ed=s):i>h&&i<=d?(o.push({...u,st:h-s,ed:i-s}),u.st=i-t,u.ed-=t):h>=i&&(u.st-=t,u.ed-=t);a.push(u)}e.textRuns=a}return o.length===0&&o.push({st:0,ed:t,ts:{}}),o}function mh(e,t,n){const{paragraphs:r}=e,s=n,i=n+t,o=[];if(r){const a=[];for(let l=0,c=r.length;l<c;l++){const u=r[l],{startIndex:h}=u;if(h>=s&&h<i){o.push({...u,startIndex:h-n});continue}else h>=i&&(u.startIndex-=t);a.push(u)}e.paragraphs=a}return o}function gh(e,t,n){const{sectionBreaks:r}=e,s=n,i=n+t-1,o=[];if(r){const a=[];for(let l=0,c=r.length;l<c;l++){const u=r[l],{startIndex:h}=u;if(h>=s&&h<=i){o.push({...u,startIndex:h-n});continue}else h>i&&(u.startIndex-=t);a.push(u)}e.sectionBreaks=a}return o}function _h(e,t,n){const{customBlocks:r=[]}=e,s=n,i=n+t-1,o=[];if(r){const a=[];for(let l=0,c=r.length;l<c;l++){const u=r[l],{startIndex:h}=u;if(h>=s&&h<=i){o.push({...u,startIndex:h-n});continue}else h>i&&(u.startIndex-=t);a.push(u)}e.customBlocks=a}return r.length&&!e.customBlocks&&(e.customBlocks=r),o}function ph(e,t,n){const{tables:r}=e,s=n,i=n+t-1,o=[];if(r){const a=[];for(let l=0,c=r.length;l<c;l++){const u=r[l],{startIndex:h,endIndex:d}=u;if(s<=h&&i>=d){o.push({...u,startIndex:h-n,endIndex:d-n});continue}else if(h<=s&&d>=i){const f=zs(h,d,s,i);if(f.length===0||(u.startIndex=f[0],u.endIndex=f[1],u.startIndex===u.endIndex))continue}else i<h&&(u.startIndex-=t,u.endIndex-=t);a.push(u)}e.tables=a}return o}function q0(e,t,n){const{customRanges:r}=e,s=n,i=n+t-1,o=[];if(r){const a=[];for(let l=0,c=r.length;l<c;l++){const u=r[l],{startIndex:h,endIndex:d}=u;if(h>=s&&d<=i){o.push(u);continue}else if(Math.max(s,h)<=Math.min(i,d)){const f=zs(h,d,s,i);if(f.length===0)continue;u.startIndex=f[0],u.endIndex=f[1]}else i<h&&(u.startIndex-=t,u.endIndex-=t);a.push(u)}e.customRanges=na(a)}return o}function Z0(e,t,n,r=!0){const{customDecorations:s}=e,i=n,o=n+t-1,a=[];if(s){const l=[];for(let c=0,u=s.length;c<u;c++){const h=s[c],{startIndex:d,endIndex:f}=h;if(d>=i&&f<=o){a.push(h);continue}else if(Math.max(i,d)<=Math.min(o,f)){const g=zs(d,f,i,o);if(g.length===0)continue;h.startIndex=g[0],h.endIndex=g[1]}else o<d&&r&&(h.startIndex-=t,h.endIndex-=t);l.push(h)}e.customDecorations=l}return a}var Eh=(e=>(e.ORDER_LIST_QUICK_1="1.",e.ORDER_LIST_QUICK_2="a)",e.ORDER_LIST_QUICK_3="a.",e.ORDER_LIST_QUICK_4="i.",e.ORDER_LIST_QUICK_5="A.",e.ORDER_LIST_QUICK_6="I.",e.ORDER_LIST_QUICK_7="01.",e.BULLET_LIST="*",e))(Eh||{}),kt=(e=>(e.BULLET_LIST="BULLET_LIST",e.BULLET_LIST_1="BULLET_LIST_1",e.BULLET_LIST_2="BULLET_LIST_2",e.BULLET_LIST_3="BULLET_LIST_3",e.BULLET_LIST_4="BULLET_LIST_4",e.BULLET_LIST_5="BULLET_LIST_5",e.ORDER_LIST="ORDER_LIST",e.ORDER_LIST_1="ORDER_LIST_1",e.ORDER_LIST_2="ORDER_LIST_2",e.ORDER_LIST_3="ORDER_LIST_3",e.ORDER_LIST_4="ORDER_LIST_4",e.ORDER_LIST_5="ORDER_LIST_5",e.ORDER_LIST_QUICK_2="ORDER_LIST_QUICK_2",e.ORDER_LIST_QUICK_3="ORDER_LIST_QUICK_3",e.ORDER_LIST_QUICK_4="ORDER_LIST_QUICK_4",e.ORDER_LIST_QUICK_5="ORDER_LIST_QUICK_5",e.ORDER_LIST_QUICK_6="ORDER_LIST_QUICK_6",e.CHECK_LIST="CHECK_LIST",e.CHECK_LIST_CHECKED="CHECK_LIST_CHECKED",e))(kt||{});const is={"a)":{glyphFormat:"%1)",glyphType:fe.DECIMAL},"1.":{glyphType:fe.DECIMAL},"a.":{glyphFormat:"%1.",glyphType:fe.LOWER_LETTER},"A.":{glyphType:fe.UPPER_LETTER},"i.":{glyphFormat:"%1.",glyphType:fe.LOWER_ROMAN},"I.":{glyphFormat:"%1.",glyphType:fe.UPPER_LETTER}},yn=e=>[...e,...e,...e].map((t,n)=>({glyphFormat:` %${n+1}`,glyphSymbol:t,bulletAlignment:Br.START,textStyle:{fs:12},startNumber:0,paragraphProperties:{hanging:{v:21},indentStart:{v:21*n}}})),Nn=e=>e.map((t,n)=>({...t,bulletAlignment:Br.START,textStyle:{fs:12},startNumber:0,paragraphProperties:{hanging:{v:21},indentStart:{v:21*n}}})),gl=(e,t)=>new Array(9).fill(0).map((n,r)=>({glyphFormat:` %${r+1}`,glyphSymbol:e,bulletAlignment:Br.START,textStyle:{fs:16},startNumber:0,paragraphProperties:{hanging:{v:21},indentStart:{v:21*r},textStyle:t}})),Yr={BULLET_LIST:{listType:"BULLET_LIST",nestingLevel:yn(["●","○","■"])},BULLET_LIST_1:{listType:"BULLET_LIST",nestingLevel:yn(["❖","➢","■"])},BULLET_LIST_2:{listType:"BULLET_LIST",nestingLevel:yn(["✔","●","◆"])},BULLET_LIST_3:{listType:"BULLET_LIST",nestingLevel:yn(["■","◆","○"])},BULLET_LIST_4:{listType:"BULLET_LIST",nestingLevel:yn(["✧","○","■"])},BULLET_LIST_5:{listType:"BULLET_LIST",nestingLevel:yn(["➢","○","◆"])},ORDER_LIST:{listType:"ORDER_LIST",nestingLevel:Nn([{glyphFormat:"%1.",glyphType:fe.DECIMAL},{glyphFormat:"%2.",glyphType:fe.LOWER_LETTER},{glyphFormat:"%3.",glyphType:fe.LOWER_ROMAN},{glyphFormat:"%4.",glyphType:fe.DECIMAL},{glyphFormat:"%5.",glyphType:fe.LOWER_LETTER},{glyphFormat:"%6.",glyphType:fe.LOWER_ROMAN},{glyphFormat:"%7.",glyphType:fe.DECIMAL},{glyphFormat:"%8.",glyphType:fe.LOWER_LETTER},{glyphFormat:"%9.",glyphType:fe.LOWER_ROMAN}])},ORDER_LIST_1:{listType:"ORDER_LIST",nestingLevel:Nn([{glyphFormat:"%1)",glyphType:fe.DECIMAL},{glyphFormat:"%2)",glyphType:fe.LOWER_LETTER},{glyphFormat:"%3)",glyphType:fe.LOWER_ROMAN},{glyphFormat:"%4)",glyphType:fe.DECIMAL},{glyphFormat:"%5)",glyphType:fe.LOWER_LETTER},{glyphFormat:"%6)",glyphType:fe.LOWER_ROMAN},{glyphFormat:"%7)",glyphType:fe.DECIMAL},{glyphFormat:"%8)",glyphType:fe.LOWER_LETTER},{glyphFormat:"%9)",glyphType:fe.LOWER_ROMAN}])},ORDER_LIST_2:{listType:"ORDER_LIST",nestingLevel:Nn(["%1.","%1.%2.","%1.%2.%3.","%1.%2.%3.%4.","%1.%2.%3.%4.%5.","%1.%2.%3.%4.%5.%6.","%1.%2.%3.%4.%5.%6.%7."].map(e=>({glyphFormat:e,glyphType:fe.DECIMAL})))},ORDER_LIST_3:{listType:"ORDER_LIST",nestingLevel:Nn([{glyphFormat:"%1.",glyphType:fe.UPPER_LETTER},{glyphFormat:"%2.",glyphType:fe.LOWER_LETTER},{glyphFormat:"%3.",glyphType:fe.LOWER_ROMAN},{glyphFormat:"%4.",glyphType:fe.UPPER_LETTER},{glyphFormat:"%5.",glyphType:fe.LOWER_LETTER},{glyphFormat:"%6.",glyphType:fe.LOWER_ROMAN},{glyphFormat:"%7.",glyphType:fe.UPPER_LETTER},{glyphFormat:"%8.",glyphType:fe.LOWER_LETTER},{glyphFormat:"%9.",glyphType:fe.LOWER_ROMAN}])},ORDER_LIST_4:{listType:"ORDER_LIST",nestingLevel:Nn([{glyphFormat:"%1.",glyphType:fe.UPPER_LETTER},{glyphFormat:"%2.",glyphType:fe.DECIMAL},{glyphFormat:"%3.",glyphType:fe.LOWER_ROMAN},{glyphFormat:"%4.",glyphType:fe.UPPER_LETTER},{glyphFormat:"%5.",glyphType:fe.DECIMAL},{glyphFormat:"%6.",glyphType:fe.LOWER_ROMAN},{glyphFormat:"%7.",glyphType:fe.UPPER_LETTER},{glyphFormat:"%8.",glyphType:fe.DECIMAL},{glyphFormat:"%9.",glyphType:fe.LOWER_ROMAN}])},ORDER_LIST_5:{listType:"ORDER_LIST",nestingLevel:Nn([{glyphFormat:"%1.",glyphType:fe.DECIMAL_ZERO},{glyphFormat:"%2.",glyphType:fe.LOWER_LETTER},{glyphFormat:"%3.",glyphType:fe.LOWER_ROMAN},{glyphFormat:"%4.",glyphType:fe.DECIMAL_ZERO},{glyphFormat:"%5.",glyphType:fe.LOWER_LETTER},{glyphFormat:"%6.",glyphType:fe.LOWER_ROMAN},{glyphFormat:"%7.",glyphType:fe.DECIMAL_ZERO},{glyphFormat:"%8.",glyphType:fe.LOWER_LETTER},{glyphFormat:"%9.",glyphType:fe.LOWER_ROMAN}])},CHECK_LIST:{listType:"CHECK_LIST",nestingLevel:gl("☐")},CHECK_LIST_CHECKED:{listType:"CHECK_LIST_CHECKED",nestingLevel:gl("☑",{st:{s:ie.TRUE}})}},os=e=>{const{glyphFormat:t,glyphType:n}=e,r=Z.deepClone(Yr.ORDER_LIST);return r.nestingLevel[0].glyphFormat=t,r.nestingLevel[0].glyphType=n,r},J0={ORDER_LIST_QUICK_2:os(is["a)"]),ORDER_LIST_QUICK_3:os(is["a."]),ORDER_LIST_QUICK_4:os(is["i."]),ORDER_LIST_QUICK_6:os(is["I."])};Object.assign(Yr,J0);const Q0={"1.":"ORDER_LIST","a)":"ORDER_LIST_QUICK_2","a.":"ORDER_LIST_QUICK_3","i.":"ORDER_LIST_QUICK_4","A.":"ORDER_LIST_3","I.":"ORDER_LIST_QUICK_6","01.":"ORDER_LIST_5","*":"BULLET_LIST"};function eC(e,t,n,r,s){const i=tC(e,t,n,r,s),o=nC(e,t,n,r,s),a=rC(e,t,n,r,s),l=sC(e,t,n,r,s),c=iC(e,t,n,r,s),u=oC(e,t,n,r),h=aC(e,t,n,r,s);return{dataStream:"",textRuns:i,paragraphs:o,sectionBreaks:a,customBlocks:l,tables:c,customRanges:u,customDecorations:h}}function tC(e,t,n,r,s){const{textRuns:i}=e,{textRuns:o}=t;if(i==null||o==null)return;const a=fh(e,n,r);if(s!==Ee.REPLACE){const l=Ch(o,a,s);t.textRuns=l}return oh(e,t,n,r),a}function Ch(e,t,n){if(t.length===0)return e;e=Z.deepClone(e),t=Z.deepClone(t);const r=[],s=e.length,i=t.length;let o=0,a=0,l=null;function c(){return l?(r.push(l),l=null,!0):!1}for(;o<s&&a<i;){const{st:f,ed:g,ts:_}=e[o],{st:R,ed:b,ts:F,sId:k}=t[a];let W;if(n===Ee.COVER?W={...F,..._}:W={..._},g<R)c()||r.push(e[o]),o++;else if(b<f)c()||r.push(t[a]),a++;else{const S={st:Math.min(f,R),ed:Math.max(f,R),ts:f<R?{..._}:{...F},sId:f<R?void 0:k};S.ed>S.st&&r.push(S),r.push({st:Math.max(f,R),ed:Math.min(g,b),ts:W,sId:k}),g<b?(o++,t[a].st=g,t[a].st===t[a].ed&&a++):(a++,e[o].st=b,e[o].st===e[o].ed&&o++);const C={st:Math.min(g,b),ed:Math.max(g,b),ts:g<b?{...F}:{..._},sId:g<b?k:void 0};l=C.ed>C.st?C:null}}c();const u=r[r.length-1],h=e[s-1],d=t[i-1];return u&&u.ed!==Math.max(h.ed,d.ed)&&(h.ed>d.ed?r.push(h):r.push(d)),Wr(r)}function nC(e,t,n,r,s){const{paragraphs:i}=e,{paragraphs:o}=t;if(i==null||o==null)return;const a=mh(e,n,r);if(s!==Ee.REPLACE){const l=[];for(const c of o){const{startIndex:u,paragraphStyle:h,bullet:d}=c;let f=[];for(const g of a){const{startIndex:_,paragraphStyle:R,bullet:b}=g;let F,k;if(s===Ee.COVER?(F={...R,...h},k={listId:"",listType:kt.BULLET_LIST,nestingLevel:0,textStyle:{},...b,...d}):(F={...h,...R},k={listId:"",listType:kt.BULLET_LIST,nestingLevel:0,textStyle:{},...d,...b}),u===_){f.push({startIndex:u,paragraphStyle:F,bullet:k});break}}l.push(...f),f=[]}t.paragraphs=l}return ah(e,t,n,r),a}function rC(e,t,n,r,s){const{sectionBreaks:i}=e,{sectionBreaks:o}=t;if(i==null||o==null)return;const a=gh(e,n,r);if(s!==Ee.REPLACE){const l=[];for(const c of o){const{startIndex:u}=c;let h=[];for(const d of a){const{startIndex:f}=d;if(u===f){s===Ee.COVER?h.push({...d,...c}):h.push({...c,...d});break}}l.push(...h),h=[]}t.sectionBreaks=l}return lh(e,t,n,r),a}function sC(e,t,n,r,s){const{customBlocks:i=[]}=e,{customBlocks:o}=t;if(i==null||o==null)return;const a=_h(e,n,r);if(s!==Ee.REPLACE){const l=[];for(const c of o){const{startIndex:u}=c;let h=[];for(const d of a){const{startIndex:f}=d;if(u===f){s===Ee.COVER?h.push({...d,...c}):h.push({...c,...d});break}}l.push(...h),h=[]}t.customBlocks=l}return ch(e,t,n,r),i.length&&!e.customBlocks&&(e.customBlocks=i),a}function iC(e,t,n,r,s){const{tables:i}=e,{tables:o}=t;if(i==null||o==null)return;const a=ph(e,n,r);if(s!==Ee.REPLACE){const l=[];for(const c of o){const{startIndex:u,endIndex:h}=c;let d=[];for(const f of a){const{startIndex:g,endIndex:_}=f;if(g>=u&&_<=h){s===Ee.COVER?d.push({...f,...c}):d.push({...c,...f});break}}l.push(...d),d=[]}t.tables=l}return uh(e,t,n,r),a}function oC(e,t,n,r,s){e.customRanges||(e.customRanges=[]),zi(e.customRanges,r),zi(e.customRanges,r+n);const i=r,o=r+n-1,{customRanges:a}=t,l=[],c=new Map;e.customRanges.forEach(h=>{const{startIndex:d,endIndex:f}=h;d>=i&&f<=o?c.set(h.rangeId,h):l.push(h)});const u=[];return a?(a.forEach(h=>{const{startIndex:d,endIndex:f}=h;l.push({...h,startIndex:d+r,endIndex:f+r})}),e.customRanges=na(l),u):[]}function aC(e,t,n,r,s){e.customDecorations||(e.customDecorations=[]),Ki(e.customDecorations,r),Ki(e.customDecorations,r+n);const i=[],{customDecorations:o}=e,{customDecorations:a=[]}=t;if(s===Ee.REPLACE){for(let l=0;l<o.length;l++){const c=o[l],{startIndex:u,endIndex:h}=c;u>=r&&h<=r+n-1&&i.push(c)}a.forEach(l=>{const{startIndex:c,endIndex:u}=l;o.push({...l,startIndex:c+r,endIndex:u+r})})}else for(const l of a){const{id:c}=l;if(l.type===pn.DELETED){const u=o.filter(h=>h.id===c);u.length&&i.push(...u)}else o.push({...l,startIndex:l.startIndex+r,endIndex:l.endIndex+r})}for(const l of i){const{id:c}=l,u=o.findIndex(h=>h.id===c);u!==-1&&o.splice(u,1)}return e.customDecorations=dh(o),i}var ra=(e=>(e[e.copy=0]="copy",e[e.cut=1]="cut",e))(ra||{});function xs(e,t,n,r=!0){const{textRuns:s}=e;if(s){const i=[];for(const o of s){const a=Z.deepClone(o),{st:l,ed:c}=a;Z.hasIntersectionBetweenTwoRanges(l,c,t,n)&&(t>=l&&t<=c?i.push({...a,st:t,ed:Math.min(n,c)}):n>=l&&n<=c?i.push({...a,st:Math.max(t,l),ed:n}):i.push(a))}return Wr(i.map(o=>{const{st:a,ed:l}=o;return{...o,st:a-t,ed:l-t}}))}else if(r)return[{st:0,ed:n-t,ts:{}}]}function Rh(e,t,n){const{tables:r=[]}=e,s=[];for(const i of r){const o=Z.deepClone(i),{startIndex:a,endIndex:l}=o;a>=t&&l<=n&&s.push({...o,startIndex:a-t,endIndex:l-t})}return s}function Ih(e,t,n){const{paragraphs:r=[]}=e,s=[];for(const i of r){const{startIndex:o}=i;if(o>=t&&o<n){const a=Z.deepClone(i);s.push(a)}}if(s.length)return s.map(i=>({...i,startIndex:i.startIndex-t}))}function lC(e,t,n){const{sectionBreaks:r=[]}=e,s=[];for(const i of r){const{startIndex:o}=i;o>=t&&o<=n&&s.push(Z.deepClone(i))}if(s.length)return s.map(i=>({...i,startIndex:i.startIndex-t}))}function Sh(e,t,n){const{customBlocks:r=[]}=e,s=[];for(const i of r){const{startIndex:o}=i;o>=t&&o<n&&s.push(Z.deepClone(i))}if(s.length)return s.map(i=>({...i,startIndex:i.startIndex-t}))}function yt(e,t,n,r=!0,s=1){const{dataStream:i}=e,o={dataStream:i.slice(t,n)};o.textRuns=xs(e,t,n,r);const a=Rh(e,t,n);if(a.length&&(o.tables=a),o.paragraphs=Ih(e,t,n),s===1){const c=vh(e,t,n);c?o.customDecorations=c:r&&(o.customDecorations=[])}const{customRanges:l}=Oh(e,t,n);return l?o.customRanges=l:r&&(o.customRanges=[]),o.customBlocks=Sh(e,t,n),o}function cC(e){const{dataStream:t,textRuns:n,paragraphs:r,customRanges:s,customDecorations:i,tables:o}=e;let a=0,l=0;s==null||s.forEach(u=>{u.startIndex<0&&(a=Math.max(a,-u.startIndex)),u.endIndex>t.length-1&&(l=Math.max(l,u.endIndex-t.length+1))});const c=`${t}`;return n&&(n[0]&&(n[0].st=n[0].st-a),n[n.length-1]&&(n[n.length-1].ed=n[n.length-1].ed+l)),n==null||n.forEach(u=>{u.st+=a,u.ed+=a}),r==null||r.forEach(u=>{u.startIndex+=a}),s==null||s.forEach(u=>{u.startIndex+=a,u.endIndex+=a}),i==null||i.forEach(u=>{u.startIndex+=a,u.endIndex+=l}),o==null||o.forEach(u=>{u.startIndex+=a,u.endIndex+=l}),{...e,dataStream:c,textRuns:n,paragraphs:r,customRanges:s,customDecorations:i,tables:o}}function Oh(e,t,n){if(e.customRanges==null)return{};const{customRanges:r}=e;return{customRanges:r.filter(a=>Math.max(a.startIndex,t)<=Math.min(a.endIndex,n-1)).map(a=>({...a,startIndex:Math.max(a.startIndex,t),endIndex:Math.min(a.endIndex,n-1)})).map(a=>({...a,startIndex:a.startIndex-t,endIndex:a.endIndex-t})),leftOffset:0,rightOffset:0}}function vh(e,t,n){if(e.customDecorations==null)return;const{customDecorations:r=[]}=e,s=[];return r.forEach(i=>{if(Math.max(i.startIndex,t)<=Math.min(i.endIndex,n-1)){const o=Z.deepClone(i);s.push({...o,startIndex:Math.max(o.startIndex-t,0),endIndex:Math.min(o.endIndex,n-1)-t})}}),s}function uC(e,t,n){return e==null||t==null?e!=null?e:t:Ch(e,t,n)}function hC(e,t,n){if(e==null||t==null)return e!=null?e:t;if(t.length===0||e.length===0)return e;if(t.length>1||e.length>1)throw new Error("Cannot cover multiple customRanges");return n===Ee.REPLACE?[{...e[0]}]:[{...t[0],...e[0]}]}function dC(e,t,n){return t.length===0||e.length===0||n===Ee.REPLACE?e:[...e,...t.filter(r=>!e.some(s=>r.id===s.id))]}function Xi(e,t,n=Ee.COVER){if(t.dataStream!=="")throw new Error("Cannot compose other body with non-empty dataStream");const r={dataStream:e.dataStream},{textRuns:s,paragraphs:i=[],customRanges:o,customDecorations:a=[]}=e,{textRuns:l,paragraphs:c=[],customRanges:u,customDecorations:h=[]}=t;r.textRuns=uC(l,s,n),r.customRanges=hC(u,o,n);const d=dC(h,a,n);d.length&&(r.customDecorations=d);const f=[];let g=0,_=0;for(;g<i.length&&_<c.length;){const R=i[g],b=c[_],{startIndex:F}=R,{startIndex:k}=b;F===k?(f.push(Z.deepMerge(R,b)),g++,_++):F<k?(f.push(Z.deepClone(R)),g++):(f.push(Z.deepClone(b)),_++)}return g<i.length&&f.push(...i.slice(g)),_<c.length&&f.push(...c.slice(_)),f.length&&(r.paragraphs=f),r}function fC(e){const{body:t}=e;if(t==null)return!0;const{textRuns:n,paragraphs:r,customRanges:s,customBlocks:i,customDecorations:o,tables:a}=t;return n==null&&r==null&&s==null&&i==null&&o==null&&a==null}class xn{constructor(t){p(this,"_index",0);p(this,"_offset",0);this._actions=t}hasNext(){return this.peekLength()<Number.POSITIVE_INFINITY}next(t){t||(t=Number.POSITIVE_INFINITY);const n=this._actions[this._index];if(n){const r=this._offset,s=n.len;return t>=s-r?(t=s-r,this._index+=1,this._offset=0):this._offset+=t,n.t===q.DELETE||n.t===q.RETAIN&&n.body==null?Z.deepClone({...n,len:t}):Z.deepClone({...n,len:t,body:yt(n.body,r,r+t,!1)})}else return{t:q.RETAIN,len:Number.POSITIVE_INFINITY}}peek(){return this._actions[this._index]}peekLength(){return this._actions[this._index]?this._actions[this._index].len-this._offset:Number.POSITIVE_INFINITY}peekType(){const t=this._actions[this._index];return t?t.t:q.RETAIN}rest(){if(this.hasNext()){if(this._offset===0)return this._actions.slice(this._index);{const t=this._offset,n=this._index,r=this.next(),s=this._actions.slice(this._index);return this._offset=t,this._index=n,[r].concat(s)}}else return[]}}function wh(e,t,n){const{dataStream:r}=e,s=n,i=n+t,o=fh(e,t,n),a=mh(e,t,n),l=gh(e,t,n),c=_h(e,t,n),u=ph(e,t,n),h=q0(e,t,n),d=Z0(e,t,n);let f="";return r&&(e.dataStream=yu(r,s,i),f=r.slice(s,i)),{dataStream:f,textRuns:o,paragraphs:a,sectionBreaks:l,customBlocks:c,tables:u,customRanges:h,customDecorations:d}}function bh(e,t,n,r){e.dataStream=Tu(e.dataStream,r,t.dataStream),oh(e,t,n,r),ah(e,t,n,r),lh(e,t,n,r),ch(e,t,n,r),uh(e,t,n,r),K0(e,t,n,r),X0(e,t,n,r)}function mC(e,t,n,r,s=Ee.COVER){return eC(e,t,n,r,s)}function gC(e,t,n){return t<=0?{dataStream:""}:wh(e,t,n)}function _C(e,t,n,r){n!==0&&bh(e,t,n,r)}function pC(e,t){const n=new vn;return n.reset(),t.forEach(r=>{const s=Z.deepClone(r);switch(s.t){case q.RETAIN:{const{coverType:i,body:o,len:a}=s;o!=null&&mC(e,o,a,n.cursor,i),n.moveCursor(a);break}case q.INSERT:{const{body:i,len:o}=s;_C(e,i,o,n.cursor),n.moveCursor(o);break}case q.DELETE:{const{len:i}=s;gC(e,i,n.cursor);break}default:throw new Error(`Unknown action type for action: ${s}.`)}}),e}function EC(e,t,n,r,s){if(e==null||t==null)return t;if(e.length===0||t.length===0)return[];t=Z.deepClone(t),e=Z.deepClone(e);const i=[],o=t.length,a=e.length;let l=0,c=0,u=null;function h(){return u?(i.push(u),u=null,!0):!1}for(;l<o&&c<a;){const{st:_,ed:R,ts:b}=t[l],{st:F,ed:k,ts:W,sId:S}=e[c];let C={};if(s===0)C={...b},n===Ee.COVER&&r===Ee.REPLACE&&W&&(C=Object.assign({},W,C));else if(C={...b},n===Ee.REPLACE){if(r===Ee.REPLACE)C={...W};else if(b&&W){const w=Object.keys(b);for(const T of w)W[T]&&delete C[T]}}else if(r===Ee.REPLACE){if(W){const w=Object.keys(W);for(const T of w)W[T]!==void 0&&(C[T]=W[T])}}else if(W){const w=Object.keys(W);for(const T of w)C[T]!==void 0&&delete C[T]}if(R<F)h()||i.push(t[l]),l++;else if(k<_)h()||i.push(e[c]),c++;else{const w={st:Math.min(_,F),ed:Math.max(_,F),ts:_<F?{...b}:{...W}};w.ed>w.st&&i.push(),i.push({st:Math.max(_,F),ed:Math.min(R,k),ts:C,sId:S}),R<k?(l++,e[c].st=R,e[c].st===e[c].ed&&c++):(c++,t[l].st=k,t[l].st===t[l].ed&&l++);const T={st:Math.min(R,k),ed:Math.max(R,k),ts:R<k?{...W}:{...b},sId:R<k?S:void 0};u=T.ed>T.st?T:null}}h();const d=i[i.length-1],f=t[o-1],g=e[a-1];return d.ed!==Math.max(f.ed,g.ed)&&(f.ed>g.ed?i.push(f):i.push(g)),Wr(i,!0)}function CC(e,t,n,r,s){if(e==null||t==null)return t;if(e.length===0||t.length===0)return[];if(e.length>1||t.length>1)throw new Error("CustomRanges is only supported transform for length one now.");const i=e[0],o=t[0];if(n===Ee.REPLACE)return s===1?[Z.deepClone(i)]:[Z.deepClone(o)];if(r===Ee.REPLACE){const a=Z.deepClone(o);return s===1&&Object.assign(a,Z.deepClone(i)),[a]}else{const a=Z.deepClone(o);return s===1&&Object.assign(a,Z.deepClone(i)),[a]}}function _l(e,t,n,r,s){const i={startIndex:t.startIndex};if(t.paragraphStyle&&(i.paragraphStyle=Z.deepClone(t.paragraphStyle),e.paragraphStyle)){if(n===Ee.REPLACE)if(r===Ee.REPLACE)s===1&&(i.paragraphStyle={...e.paragraphStyle});else if(s===1){const o=Object.keys(e.paragraphStyle);for(const a of o)e.paragraphStyle[a]!==void 0&&(i.paragraphStyle[a]=e.paragraphStyle[a])}else{const o=Object.keys(e.paragraphStyle);for(const a of o)i.paragraphStyle[a]===void 0&&(i.paragraphStyle[a]=e.paragraphStyle[a])}else if(r===Ee.REPLACE)if(s===1){const o=Object.keys(e.paragraphStyle);for(const a of o)e.paragraphStyle[a]!==void 0&&(i.paragraphStyle[a]=e.paragraphStyle[a])}else{const o=Object.keys(e.paragraphStyle);for(const a of o)i.paragraphStyle[a]===void 0&&(i.paragraphStyle[a]=e.paragraphStyle[a])}else if(s===1){const o=Object.keys(e.paragraphStyle);for(const a of o)i.paragraphStyle[a]&&delete i.paragraphStyle[a]}}return n===Ee.REPLACE&&r===Ee.REPLACE?i.bullet=s===1?Z.deepClone(e.bullet):Z.deepClone(t.bullet):e.bullet===void 0?i.bullet=Z.deepClone(t.bullet):n===Ee.REPLACE||r===Ee.REPLACE?i.bullet=s===0&&t.bullet?Z.deepClone(t.bullet):Z.deepClone(e.bullet):s===0&&t.bullet!==void 0&&(i.bullet=Z.deepClone(t.bullet)),i}function RC(e,t){if(e==null||t==null)return t;if(e.length===0||t.length===0)return Z.deepClone(t);const n=[];for(const r of t){const{id:s,type:i}=r;let o=!1;for(const a of e)if(a.id===s){(a.type===pn.DELETED||i===pn.DELETED)&&(o=!0,n.push({...r,type:pn.DELETED}));break}o||n.push(r)}return n}function IC(e,t,n=!1){const{body:r,coverType:s=Ee.COVER}=e,{body:i,coverType:o=Ee.COVER}=t;if(r==null||r.dataStream!==""||i==null||i.dataStream!=="")throw new Error("Data stream is not supported in retain transform.");const a={dataStream:""},l=o,{textRuns:c,paragraphs:u=[],customRanges:h,customDecorations:d}=r,{textRuns:f,paragraphs:g=[],customRanges:_,customDecorations:R}=i,b=EC(c,f,s,o,n?1:0);b&&(a.textRuns=b);const F=CC(h,_,s,o,n?1:0);F&&(a.customRanges=F);const k=RC(d,R);k&&(a.customDecorations=k);const W=[];let S=0,C=0;for(;S<u.length&&C<g.length;){const w=u[S],T=g[C],{startIndex:B}=w,{startIndex:$}=T;if(B===$){let m={startIndex:B};n?m=_l(w,T,s,o,1):m=_l(w,T,s,o,0),W.push(m),S++,C++}else B<$?S++:(W.push(Z.deepClone(T)),C++)}return C<g.length&&W.push(...g.slice(C)),W.length&&(a.paragraphs=W),{coverType:l,body:a}}function pl(e){return Object.keys(e).length===1}const jn=class jn{constructor(){p(this,"_actions",[])}static apply(t,n){return pC(t,n)}static compose(t,n){const r=new xn(t),s=new xn(n),i=new jn;for(;r.hasNext()||s.hasNext();)if(s.peekType()===q.INSERT)i.push(s.next());else if(r.peekType()===q.DELETE)i.push(r.next());else{const o=Math.min(r.peekLength(),s.peekLength()),a=r.next(o),l=s.next(o);if(a.t===q.INSERT&&l.t===q.RETAIN)l.body==null?i.push(a):i.push({...a,body:Xi(a.body,l.body,l.coverType)});else if(a.t===q.RETAIN&&l.t===q.RETAIN)if(a.body==null&&l.body==null)i.push(a.len!==Number.POSITIVE_INFINITY?a:l);else if(a.body&&l.body){const c=a.coverType===Ee.REPLACE||l.coverType===Ee.REPLACE?Ee.REPLACE:Ee.COVER;i.push({...a,t:q.RETAIN,coverType:c,body:Xi(a.body,l.body,l.coverType)})}else i.push(a.body?a:l);else a.t===q.RETAIN&&l.t===q.DELETE?i.push(l):a.t===q.INSERT&&(l.t,q.DELETE)}return i.trimEndUselessRetainAction(),i.serialize()}static transform(t,n,r="right"){return this._transform(n,t,r==="left"?"right":"left")}static _transform(t,n,r="right"){const s=new xn(t),i=new xn(n),o=new jn;for(;s.hasNext()||i.hasNext();)if(s.peekType()===q.INSERT&&(r==="left"||i.peekType()!==q.INSERT)){const a=s.next();o.retain(a.len)}else if(i.peekType()===q.INSERT)o.push(i.next());else{const a=Math.min(s.peekLength(),i.peekLength()),l=s.next(a),c=i.next(a);if(l.t===q.DELETE)continue;if(c.t===q.DELETE){o.push(c);continue}if(l.body==null||c.body==null)o.push(c);else{const{coverType:u,body:h}=IC(l,c,r==="left");o.push({...c,t:q.RETAIN,coverType:u,body:h})}}return o.trimEndUselessRetainAction(),o.serialize()}static transformPosition(t,n,r=!1){const s=new xn(t);let i=0;for(;s.hasNext()&&i<=n;){const o=s.peekLength(),a=s.peekType();if(s.next(),a===q.DELETE){n-=Math.min(o,n-i);continue}else a===q.INSERT&&(i<n||!r)&&(n+=o);i+=o}return n}static isNoop(t){return t.length===0}static invert(t){const n=[];for(const r of t)if(r.t===q.INSERT)n.push({t:q.DELETE,len:r.len,body:r.body});else if(r.t===q.DELETE){if(r.body==null)throw new Error("Can not invert DELETE action without body property, makeInvertible must be called first.");n.push({t:q.INSERT,body:r.body,len:r.len})}else if(r.body!=null){if(r.oldBody==null)throw new Error("Can not invert RETAIN action without oldBody property, makeInvertible must be called first.");n.push({t:q.RETAIN,body:r.oldBody,oldBody:r.body,len:r.len,coverType:Ee.REPLACE})}else n.push(r);return n}static makeInvertible(t,n){const r=[];let s=0;for(const i of t){if(i.t===q.DELETE&&(i.body==null||i.body&&i.body.dataStream.length!==i.len)){const o=yt(n,s,s+i.len,!1);i.len=o.dataStream.length,i.body=o}if(i.t===q.RETAIN&&i.body!=null){const o=yt(n,s,s+i.len,!0);i.oldBody={...o,dataStream:""},i.len=o.dataStream.length}r.push(i),i.t!==q.INSERT&&(s+=i.len)}return r}insert(t,n){const r={t:q.INSERT,body:n,len:t};return this.push(r),this}retain(t,n,r){const s={t:q.RETAIN,len:t};return n!=null&&(s.body=n),r!=null&&(s.coverType=r),this.push(s),this}delete(t){const n={t:q.DELETE,len:t};return this.push(n),this}empty(){return this._actions=[],this}serialize(){return this._actions}push(...t){if(t.length>1){for(const i of t)this.push(i);return this}let n=this._actions.length,r=this._actions[n-1];const s=Z.deepClone(t[0]);if(s.t===q.RETAIN&&s.len===0&&s.body==null)return this;if(typeof r=="object"){if(r.t===q.DELETE&&s.t===q.DELETE)return r.len+=s.len,this;if(r.t===q.DELETE&&s.t===q.INSERT&&(n-=1,r=this._actions[n-1],r==null))return this._actions.unshift(s),this;if(r.t===q.RETAIN&&s.t===q.RETAIN&&r.body==null&&s.body==null)return r.len+=s.len,this;if(r.t===q.INSERT&&pl(r.body)&&s.t===q.INSERT&&pl(s.body))return r.len+=s.len,r.body.dataStream+=s.body.dataStream,this}return n===this._actions.length?this._actions.push(s):this._actions.splice(n,0,s),this}trimEndUselessRetainAction(){let t=this._actions[this._actions.length-1];for(;t&&t.t===q.RETAIN&&fC(t);)this._actions.pop(),t=this._actions[this._actions.length-1];return this}};p(jn,"id","text-x"),p(jn,"uri","https://github.com/dream-num/univer#text-x");let Me=jn;Object.defineProperty(Me,"name",{value:"text-x"});const Wn=class Wn{static registerSubtype(t){var n;t==null||this._subTypes.has(t.name)&&((n=this._subTypes.get(t.name))==null?void 0:n.id)!==Me.id||(this._subTypes.set(t.name,t),ot.type.registerSubtype(t))}static apply(t,n){if(!ot.type.isNoop(n))return ot.type.apply(t,n)}static compose(t,n){return ot.type.compose(t,n)}static transform(t,n,r){return ot.type.transform(t,n,r)}static transformPosition(t,n,r="right"){return t&&t.length===2&&t[0]==="body"&&t[1].et===Me.name?Me.transformPosition(t[1].e,n,r==="left"):n}static invertWithDoc(t,n){return ot.type.invertWithDoc(t,n)}static isNoop(t){return ot.type.isNoop(t)}static getInstance(){return this._instance==null&&(this._instance=new Wn),this._instance}removeOp(t,n){return ot.removeOp(t,n)}moveOp(t,n){return ot.moveOp(t,n)}insertOp(t,n){return ot.insertOp(t,n)}replaceOp(t,n,r){return ot.replaceOp(t,n,r)}editOp(t,n=["body"]){return ot.editOp(n,Me.name,t)}};p(Wn,"uri","https://github.com/dream-num/univer#json-x"),p(Wn,"_subTypes",new Map),p(Wn,"_instance",null);let Gt=Wn;Gt.registerSubtype(Me);var Ah=(e=>(e.PARAGRAPH="PARAGRAPH",e.SECTION_BREAK="SECTION_BREAK",e.TABLE="TABLE",e.TABLE_ROW="TABLE_ROW",e.TABLE_CELL="TABLE_CELL",e.CUSTOM_BLOCK="CUSTOM_BLOCK",e))(Ah||{}),at=(e=>(e.PARAGRAPH="\r",e.SECTION_BREAK=`
`,e.TABLE_START="",e.TABLE_ROW_START="\x1B",e.TABLE_CELL_START="",e.TABLE_CELL_END="",e.TABLE_ROW_END="",e.TABLE_END="",e.CUSTOM_RANGE_START="",e.CUSTOM_RANGE_END="",e.COLUMN_BREAK="\v",e.PAGE_BREAK="\f",e.DOCS_END="\0",e.TAB="	",e.CUSTOM_BLOCK="\b",e.LETTER="",e.SPACE=" ",e))(at||{});function SC(e){return`${e}`}const OC=[at.TABLE_START,at.TABLE_ROW_START,at.TABLE_CELL_START,at.TABLE_CELL_END,at.TABLE_ROW_END,at.TABLE_END],Js=e=>{const t=e.endsWith(`\r
`)?e.slice(0,-2):e;return OC.reduce((n,r)=>n.replaceAll(r,""),t)},vC=e=>e?Js(e).replaceAll("\r","")==="":!0,wC=e=>{const t=e.replace(/\n/g,"\r"),n=[],r=[];let s=0,i="";const o=(l,c=!0)=>{const u=t.slice(s,l);if(Z.isLegalUrl(u)){const h=tt(),d=`${u}`,f={startIndex:s,endIndex:s+d.length-1,rangeId:h,rangeType:rn.HYPERLINK,properties:{url:e}};r.push(f),i+=d,s=l+1,c&&(i+="\r",n.push({startIndex:l}))}else i+=t.slice(s,l+1),s=l+1,c&&n.push({startIndex:l})};let a=0;for(let l=0;l<t.length;l++)t[l]==="\r"&&(o(l),a=l);return(a!==t.length-1||t.length===1)&&o(t.length,!1),{dataStream:i,paragraphs:n,customRanges:r}},sa={id:"default_doc",documentStyle:{}};class bC extends Ws{constructor(n){var r;super();p(this,"type",Oe.UNIVER_DOC);p(this,"_name$",new ce.BehaviorSubject(""));p(this,"name$",this._name$.asObservable());p(this,"snapshot");this.snapshot={...sa,...n},this._name$.next((r=this.snapshot.title)!=null?r:"No Title")}getUnitId(){throw new Error("Method not implemented.")}getRev(){var n;return(n=this.snapshot.rev)!=null?n:1}incrementRev(){this.snapshot.rev=this.getRev()+1}setRev(n){this.snapshot.rev=n}setName(n){this.snapshot.title=n,this._name$.next(n)}get drawings(){return this.snapshot.drawings}get documentStyle(){return this.snapshot.documentStyle}get lists(){return this.snapshot.lists}get zoomRatio(){var n;return((n=this.snapshot.settings)==null?void 0:n.zoomRatio)||1}resetDrawing(n,r){this.snapshot.drawings=n,this.snapshot.drawingsOrder=r}getBody(){return this.snapshot.body}getSnapshot(){return this.snapshot}getBulletPresetList(){var s;const n=(s=this.snapshot.lists)!=null?s:{};return{...Yr,...n}}updateDocumentId(n){this.snapshot.id=n}updateDocumentRenderConfig(n){const{documentStyle:r}=this.snapshot;r.renderConfig==null?r.renderConfig=n:r.renderConfig={...r.renderConfig,...n}}getDocumentStyle(){return this.snapshot.documentStyle}updateDocumentStyle(n){this.snapshot.documentStyle==null?this.snapshot.documentStyle=n:this.snapshot.documentStyle={...this.snapshot.documentStyle,...n}}updateDocumentDataMargin(n){const{t:r,l:s,b:i,r:o}=n,{documentStyle:a}=this.snapshot;r!=null&&(a.marginTop=r),s!=null&&(a.marginLeft=s),i!=null&&(a.marginBottom=i),o!=null&&(a.marginRight=o)}updateDocumentDataPageSize(n,r){const{documentStyle:s}=this.snapshot;if(!s.pageSize){s.pageSize={width:n!=null?n:Number.POSITIVE_INFINITY,height:r!=null?r:Number.POSITIVE_INFINITY};return}n!==void 0&&(s.pageSize.width=n),r!==void 0&&(s.pageSize.height=r)}updateDrawing(n,r){const{drawings:s}=this,{width:i,height:o,left:a,top:l}=r,c=s==null?void 0:s[n];if(!c)return;const u=c.docTransform;u.size.width=i,u.size.height=o,u.positionH.posOffset=a,u.positionV.posOffset=l}setZoomRatio(n=1){this.snapshot.settings?this.snapshot.settings.zoomRatio=n:this.snapshot.settings={zoomRatio:n}}setDisabled(n){this.snapshot.disabled=n}getDisabled(){return this.snapshot.disabled}getTitle(){return this.snapshot.title}}class Nt extends bC{constructor(n){var s,i;super(Z.isEmptyObject(n)?w_():n);p(this,"_unitId");p(this,"headerModelMap",new Map);p(this,"footerModelMap",new Map);p(this,"change$",new ce.BehaviorSubject(0));const r=6;this._unitId=(s=this.snapshot.id)!=null?s:tt(r),this._initializeHeaderFooterModel(),this._name$.next((i=this.snapshot.title)!=null?i:"")}dispose(){super.dispose(),this.headerModelMap.forEach(n=>{n.dispose()}),this.footerModelMap.forEach(n=>{n.dispose()}),this._name$.complete()}getDrawings(){return this.snapshot.drawings}getDrawingsOrder(){return this.snapshot.drawingsOrder}getCustomRanges(){var n;return(n=this.snapshot.body)==null?void 0:n.customRanges}getCustomDecorations(){var n;return(n=this.snapshot.body)==null?void 0:n.customDecorations}getSettings(){return this.snapshot.settings}reset(n){if(n.id&&n.id!==this._unitId)throw new Error("Cannot reset a document model with a different unit id!");this.snapshot={...sa,...n},this._initializeHeaderFooterModel(),this.change$.next(this.change$.value+1)}getSelfOrHeaderFooterModel(n){if(n!=null){if(this.headerModelMap.has(n))return this.headerModelMap.get(n);if(this.footerModelMap.has(n))return this.footerModelMap.get(n)}return this}getUnitId(){return this._unitId}apply(n){if(!Gt.isNoop(n))return this.snapshot=Gt.apply(this.snapshot,n),n!=null&&n.some(r=>Array.isArray(r)&&((r==null?void 0:r[0])==="headers"||(r==null?void 0:r[0])==="footers"))&&(this.headerModelMap.clear(),this.footerModelMap.clear(),this._initializeHeaderFooterModel()),this.change$.next(this.change$.value+1),this.snapshot}sliceBody(n,r,s=ra.copy){const i=this.getBody();if(i!=null)return yt(i,n,r,!1,s)}_initializeHeaderFooterModel(){const{headers:n,footers:r}=this.getSnapshot();if(n)for(const s in n){const i=n[s];this.headerModelMap.set(s,new Nt(i)),this.headerModelMap.get(s).updateDocumentId(this.getUnitId())}if(r)for(const s in r){const i=r[s];this.footerModelMap.set(s,new Nt(i)),this.footerModelMap.get(s).updateDocumentId(this.getUnitId())}}updateDocumentId(n){super.updateDocumentId(n),this._unitId=n}getPlainText(){var n,r;return Js((r=(n=this.getBody())==null?void 0:n.dataStream)!=null?r:"")}}function AC(e){const{ranges:t,id:n,type:r}=e,s=new Me;let i=0;for(let o=0;o<t.length;o++){const a=t[o],{startOffset:l,endOffset:c}=a;l>0&&s.push({t:q.RETAIN,len:l-i}),s.push({t:q.RETAIN,body:{dataStream:"",customDecorations:[{id:n,type:r,startIndex:0,endIndex:c-l-1}]},len:c-l}),i=c}return s}function TC(e){var u,h,d;const{id:t,segmentId:n,documentDataModel:r}=e,s=r==null?void 0:r.getBody();if(!r||!s)return!1;const i=(d=(h=(u=r.getSelfOrHeaderFooterModel(n))==null?void 0:u.getBody())==null?void 0:h.customDecorations)==null?void 0:d.find(f=>f.id===t);if(!i)return!1;const o=new Me,{startIndex:a,endIndex:l}=i,c=l-a+1;return o.push({t:q.RETAIN,len:a}),o.push({t:q.RETAIN,len:c,body:{dataStream:"",customDecorations:[{startIndex:0,endIndex:c-1,id:t,type:pn.DELETED}]}}),o}function Th(e,t,n,r){return e<=n&&t>=n||e>=n&&e<=r}function yC(e,t){const n=[];for(let r=0,s=t.length;r<s;r++){const i=t[r];e.collapsed?i.startIndex<e.startOffset&&e.startOffset<=i.endIndex&&n.push(i):Th(e.startOffset,e.endOffset-1,i.startIndex,i.endIndex)&&n.push(i)}return n}function NC(e){return{...Z.deepClone(e),rangeId:tt()}}function MC(e,t){const n=[];let r=e[0];for(const s of t)s<e[0]||s>e[1]||(r<s&&n.push([r,s-1]),r=s+1);return r<=e[1]&&n.push([r,e[1]]),n}function yh(e,t,n,r){const s=[];for(let i=0,o=n.length;i<o;i++){const a=n[i];if((r===void 0||a.rangeType===r)&&Math.max(a.startIndex,e)<=Math.min(a.endIndex,t)&&s.push({...a}),a.startIndex>t)break}return s}function LC(e,t){var i,o,a,l,c;const n=yh(e.startOffset,e.collapsed?e.startOffset:e.endOffset-1,(i=t.customRanges)!=null?i:[]),r=Math.min(e.startOffset,(a=(o=n[0])==null?void 0:o.startIndex)!=null?a:1/0),s=Math.max(e.endOffset,((c=(l=n[n.length-1])==null?void 0:l.endIndex)!=null?c:-1/0)+1);return{startOffset:r,endOffset:s,collapsed:r===s}}var Oi,El;function DC(){if(El)return Oi;El=1;var e=-1,t=1,n=0;function r(m,x,O,N,A){if(m===x)return m?[[n,m]]:[];if(O!=null){var v=B(m,x,O);if(v)return v}var y=a(m,x),M=m.substring(0,y);m=m.substring(y),x=x.substring(y),y=c(m,x);var L=m.substring(m.length-y);m=m.substring(0,m.length-y),x=x.substring(0,x.length-y);var P=s(m,x);return M&&P.unshift([n,M]),L&&P.push([n,L]),F(P,A),N&&h(P),P}function s(m,x){var O;if(!m)return[[t,x]];if(!x)return[[e,m]];var N=m.length>x.length?m:x,A=m.length>x.length?x:m,v=N.indexOf(A);if(v!==-1)return O=[[t,N.substring(0,v)],[n,A],[t,N.substring(v+A.length)]],m.length>x.length&&(O[0][0]=O[2][0]=e),O;if(A.length===1)return[[e,m],[t,x]];var y=u(m,x);if(y){var M=y[0],L=y[1],P=y[2],J=y[3],V=y[4],oe=r(M,P),le=r(L,J);return oe.concat([[n,V]],le)}return i(m,x)}function i(m,x){for(var O=m.length,N=x.length,A=Math.ceil((O+N)/2),v=A,y=2*A,M=new Array(y),L=new Array(y),P=0;P<y;P++)M[P]=-1,L[P]=-1;M[v+1]=0,L[v+1]=0;for(var J=O-N,V=J%2!==0,oe=0,le=0,I=0,D=0,Y=0;Y<A;Y++){for(var G=-Y+oe;G<=Y-le;G+=2){var H=v+G,j;G===-Y||G!==Y&&M[H-1]<M[H+1]?j=M[H+1]:j=M[H-1]+1;for(var Q=j-G;j<O&&Q<N&&m.charAt(j)===x.charAt(Q);)j++,Q++;if(M[H]=j,j>O)le+=2;else if(Q>N)oe+=2;else if(V){var ee=v+J-G;if(ee>=0&&ee<y&&L[ee]!==-1){var U=O-L[ee];if(j>=U)return o(m,x,j,Q)}}}for(var z=-Y+I;z<=Y-D;z+=2){var ee=v+z,U;z===-Y||z!==Y&&L[ee-1]<L[ee+1]?U=L[ee+1]:U=L[ee-1]+1;for(var X=U-z;U<O&&X<N&&m.charAt(O-U-1)===x.charAt(N-X-1);)U++,X++;if(L[ee]=U,U>O)D+=2;else if(X>N)I+=2;else if(!V){var H=v+J-z;if(H>=0&&H<y&&M[H]!==-1){var j=M[H],Q=v+j-H;if(U=O-U,j>=U)return o(m,x,j,Q)}}}}return[[e,m],[t,x]]}function o(m,x,O,N){var A=m.substring(0,O),v=x.substring(0,N),y=m.substring(O),M=x.substring(N),L=r(A,v),P=r(y,M);return L.concat(P)}function a(m,x){if(!m||!x||m.charAt(0)!==x.charAt(0))return 0;for(var O=0,N=Math.min(m.length,x.length),A=N,v=0;O<A;)m.substring(v,A)==x.substring(v,A)?(O=A,v=O):N=A,A=Math.floor((N-O)/2+O);return k(m.charCodeAt(A-1))&&A--,A}function l(m,x){var O=m.length,N=x.length;if(O==0||N==0)return 0;O>N?m=m.substring(O-N):O<N&&(x=x.substring(0,O));var A=Math.min(O,N);if(m==x)return A;for(var v=0,y=1;;){var M=m.substring(A-y),L=x.indexOf(M);if(L==-1)return v;y+=L,(L==0||m.substring(A-y)==x.substring(0,y))&&(v=y,y++)}}function c(m,x){if(!m||!x||m.slice(-1)!==x.slice(-1))return 0;for(var O=0,N=Math.min(m.length,x.length),A=N,v=0;O<A;)m.substring(m.length-A,m.length-v)==x.substring(x.length-A,x.length-v)?(O=A,v=O):N=A,A=Math.floor((N-O)/2+O);return W(m.charCodeAt(m.length-A))&&A--,A}function u(m,x){var O=m.length>x.length?m:x,N=m.length>x.length?x:m;if(O.length<4||N.length*2<O.length)return null;function A(le,I,D){for(var Y=le.substring(D,D+Math.floor(le.length/4)),G=-1,H="",j,Q,ee,U;(G=I.indexOf(Y,G+1))!==-1;){var z=a(le.substring(D),I.substring(G)),X=c(le.substring(0,D),I.substring(0,G));H.length<X+z&&(H=I.substring(G-X,G)+I.substring(G,G+z),j=le.substring(0,D-X),Q=le.substring(D+z),ee=I.substring(0,G-X),U=I.substring(G+z))}return H.length*2>=le.length?[j,Q,ee,U,H]:null}var v=A(O,N,Math.ceil(O.length/4)),y=A(O,N,Math.ceil(O.length/2)),M;if(!v&&!y)return null;y?v?M=v[4].length>y[4].length?v:y:M=y:M=v;var L,P,J,V;m.length>x.length?(L=M[0],P=M[1],J=M[2],V=M[3]):(J=M[0],V=M[1],L=M[2],P=M[3]);var oe=M[4];return[L,P,J,V,oe]}function h(m){for(var x=!1,O=[],N=0,A=null,v=0,y=0,M=0,L=0,P=0;v<m.length;)m[v][0]==n?(O[N++]=v,y=L,M=P,L=0,P=0,A=m[v][1]):(m[v][0]==t?L+=m[v][1].length:P+=m[v][1].length,A&&A.length<=Math.max(y,M)&&A.length<=Math.max(L,P)&&(m.splice(O[N-1],0,[e,A]),m[O[N-1]+1][0]=t,N--,N--,v=N>0?O[N-1]:-1,y=0,M=0,L=0,P=0,A=null,x=!0)),v++;for(x&&F(m),b(m),v=1;v<m.length;){if(m[v-1][0]==e&&m[v][0]==t){var J=m[v-1][1],V=m[v][1],oe=l(J,V),le=l(V,J);oe>=le?(oe>=J.length/2||oe>=V.length/2)&&(m.splice(v,0,[n,V.substring(0,oe)]),m[v-1][1]=J.substring(0,J.length-oe),m[v+1][1]=V.substring(oe),v++):(le>=J.length/2||le>=V.length/2)&&(m.splice(v,0,[n,J.substring(0,le)]),m[v-1][0]=t,m[v-1][1]=V.substring(0,V.length-le),m[v+1][0]=e,m[v+1][1]=J.substring(le),v++),v++}v++}}var d=/[^a-zA-Z0-9]/,f=/\s/,g=/[\r\n]/,_=/\n\r?\n$/,R=/^\r?\n\r?\n/;function b(m){function x(le,I){if(!le||!I)return 6;var D=le.charAt(le.length-1),Y=I.charAt(0),G=D.match(d),H=Y.match(d),j=G&&D.match(f),Q=H&&Y.match(f),ee=j&&D.match(g),U=Q&&Y.match(g),z=ee&&le.match(_),X=U&&I.match(R);return z||X?5:ee||U?4:G&&!j&&Q?3:j||Q?2:G||H?1:0}for(var O=1;O<m.length-1;){if(m[O-1][0]==n&&m[O+1][0]==n){var N=m[O-1][1],A=m[O][1],v=m[O+1][1],y=c(N,A);if(y){var M=A.substring(A.length-y);N=N.substring(0,N.length-y),A=M+A.substring(0,A.length-y),v=M+v}for(var L=N,P=A,J=v,V=x(N,A)+x(A,v);A.charAt(0)===v.charAt(0);){N+=A.charAt(0),A=A.substring(1)+v.charAt(0),v=v.substring(1);var oe=x(N,A)+x(A,v);oe>=V&&(V=oe,L=N,P=A,J=v)}m[O-1][1]!=L&&(L?m[O-1][1]=L:(m.splice(O-1,1),O--),m[O][1]=P,J?m[O+1][1]=J:(m.splice(O+1,1),O--))}O++}}function F(m,x){m.push([n,""]);for(var O=0,N=0,A=0,v="",y="",M;O<m.length;){if(O<m.length-1&&!m[O][1]){m.splice(O,1);continue}switch(m[O][0]){case t:A++,y+=m[O][1],O++;break;case e:N++,v+=m[O][1],O++;break;case n:var L=O-A-N-1;if(x){if(L>=0&&C(m[L][1])){var P=m[L][1].slice(-1);if(m[L][1]=m[L][1].slice(0,-1),v=P+v,y=P+y,!m[L][1]){m.splice(L,1),O--;var J=L-1;m[J]&&m[J][0]===t&&(A++,y=m[J][1]+y,J--),m[J]&&m[J][0]===e&&(N++,v=m[J][1]+v,J--),L=J}}if(S(m[O][1])){var P=m[O][1].charAt(0);m[O][1]=m[O][1].slice(1),v+=P,y+=P}}if(O<m.length-1&&!m[O][1]){m.splice(O,1);break}if(v.length>0||y.length>0){v.length>0&&y.length>0&&(M=a(y,v),M!==0&&(L>=0?m[L][1]+=y.substring(0,M):(m.splice(0,0,[n,y.substring(0,M)]),O++),y=y.substring(M),v=v.substring(M)),M=c(y,v),M!==0&&(m[O][1]=y.substring(y.length-M)+m[O][1],y=y.substring(0,y.length-M),v=v.substring(0,v.length-M)));var V=A+N;v.length===0&&y.length===0?(m.splice(O-V,V),O=O-V):v.length===0?(m.splice(O-V,V,[t,y]),O=O-V+1):y.length===0?(m.splice(O-V,V,[e,v]),O=O-V+1):(m.splice(O-V,V,[e,v],[t,y]),O=O-V+2)}O!==0&&m[O-1][0]===n?(m[O-1][1]+=m[O][1],m.splice(O,1)):O++,A=0,N=0,v="",y="";break}}m[m.length-1][1]===""&&m.pop();var oe=!1;for(O=1;O<m.length-1;)m[O-1][0]===n&&m[O+1][0]===n&&(m[O][1].substring(m[O][1].length-m[O-1][1].length)===m[O-1][1]?(m[O][1]=m[O-1][1]+m[O][1].substring(0,m[O][1].length-m[O-1][1].length),m[O+1][1]=m[O-1][1]+m[O+1][1],m.splice(O-1,1),oe=!0):m[O][1].substring(0,m[O+1][1].length)==m[O+1][1]&&(m[O-1][1]+=m[O+1][1],m[O][1]=m[O][1].substring(m[O+1][1].length)+m[O+1][1],m.splice(O+1,1),oe=!0)),O++;oe&&F(m,x)}function k(m){return m>=55296&&m<=56319}function W(m){return m>=56320&&m<=57343}function S(m){return W(m.charCodeAt(0))}function C(m){return k(m.charCodeAt(m.length-1))}function w(m){for(var x=[],O=0;O<m.length;O++)m[O][1].length>0&&x.push(m[O]);return x}function T(m,x,O,N){return C(m)||S(N)?null:w([[n,m],[e,x],[t,O],[n,N]])}function B(m,x,O){var N=typeof O=="number"?{index:O,length:0}:O.oldRange,A=typeof O=="number"?null:O.newRange,v=m.length,y=x.length;if(N.length===0&&(A===null||A.length===0)){var M=N.index,L=m.slice(0,M),P=m.slice(M),J=A?A.index:null;e:{var V=M+y-v;if(J!==null&&J!==V||V<0||V>y)break e;var oe=x.slice(0,V),le=x.slice(V);if(le!==P)break e;var I=Math.min(M,V),D=L.slice(0,I),Y=oe.slice(0,I);if(D!==Y)break e;var G=L.slice(I),H=oe.slice(I);return T(D,G,H,P)}e:{if(J!==null&&J!==M)break e;var j=M,oe=x.slice(0,j),le=x.slice(j);if(oe!==L)break e;var Q=Math.min(v-j,y-j),ee=P.slice(P.length-Q),U=le.slice(le.length-Q);if(ee!==U)break e;var G=P.slice(0,P.length-Q),H=le.slice(0,le.length-Q);return T(L,G,H,ee)}}if(N.length>0&&A&&A.length===0)e:{var D=m.slice(0,N.index),ee=m.slice(N.index+N.length),I=D.length,Q=ee.length;if(y<I+Q)break e;var Y=x.slice(0,I),U=x.slice(y-Q);if(D!==Y||ee!==U)break e;var G=m.slice(I,v-Q),H=x.slice(I,y-Q);return T(D,G,H,ee)}return null}function $(m,x,O,N){return r(m,x,O,N,!0)}return $.INSERT=t,$.DELETE=e,$.EQUAL=n,Oi=$,Oi}var xC=DC();const ia=St(xC);function UC(e){var h,d,f;const{rangeId:t,segmentId:n,documentDataModel:r,insert:s}=e,i=(d=(h=r.getSelfOrHeaderFooterModel(n).getBody())==null?void 0:h.customRanges)==null?void 0:d.find(g=>g.rangeId===t);if(!i)return!1;const{startIndex:o,endIndex:a}=i,l=new Me,c=a-o+1;l.push({t:q.RETAIN,len:o}),l.push({t:q.RETAIN,len:c,body:{dataStream:"",customRanges:[]}}),s&&l.push({t:q.INSERT,body:s,len:s.dataStream.length});const u=a+1+((f=s==null?void 0:s.dataStream.length)!=null?f:0);return l.selections=[{startOffset:u,endOffset:u,collapsed:!0}],l}function PC(e){const{ranges:t,rangeId:n,rangeType:r,wholeEntity:s,properties:i,body:o}=e;let a=0;const l=new Me;let c=!1;return t.forEach(u=>{var k,W,S;const h=LC(u,o);if(!h||!o)return!1;const{startOffset:d,endOffset:f}=h,g=(k=o.customRanges)!=null?k:[],_=(C,w,T)=>{var O,N,A,v;const B=yh(C,w,g,r),$=Math.min((N=(O=B[0])==null?void 0:O.startIndex)!=null?N:1/0,C),m=Math.max((v=(A=B[B.length-1])==null?void 0:A.endIndex)!=null?v:-1/0,w),x={rangeId:T?`${n}$${T}`:n,rangeType:r,startIndex:0,endIndex:m-$,wholeEntity:s,properties:{...i}};l.push({t:q.RETAIN,len:$-a}),l.push({t:q.RETAIN,len:m-$+1,body:{dataStream:"",customRanges:[x]},coverType:Ee.COVER}),a=m+1},R=((W=o.paragraphs)!=null?W:[]).filter(C=>C.startIndex<f&&C.startIndex>d),b=((S=o.customBlocks)!=null?S:[]).filter(C=>C.startIndex<f&&C.startIndex>d);MC([d,f-1],[...R.map(C=>C.startIndex),...b.map(C=>C.startIndex)]).forEach(([C,w],T)=>_(C,w,T)),c=!0,l.selections=[{startOffset:h.endOffset,endOffset:h.endOffset,collapsed:!0}]}),c?l:!1}function Nh(e,t,n=0,r=null,s=!0){e.sort((c,u)=>c.startOffset-u.startOffset);const i=[],{paragraphs:o=[]}=t,a=o==null?void 0:o.find(c=>c.startIndex>=e[0].startOffset&&c.startIndex<e[0].endOffset);let l=n;if(e.forEach(c=>{const{startOffset:u,endOffset:h}=c;u>l&&(i.push({t:q.RETAIN,len:u-l}),l=u),l<h&&(i.push({t:q.DELETE,len:h-l}),l=h)}),r&&i.push({t:q.INSERT,body:r,len:r.dataStream.length}),a&&s){const c=o.find(u=>u.startIndex-n>=e[e.length-1].endOffset-1);c&&(c.startIndex>l&&(i.push({t:q.RETAIN,len:c.startIndex-l}),l=c.startIndex),i.push({t:q.RETAIN,len:1,body:{dataStream:"",paragraphs:[{...c,startIndex:0,bullet:a==null?void 0:a.bullet}]},coverType:Ee.REPLACE}))}return i}function kC(e,t,n=0){const r=[];let s=n;return e.forEach(i=>{const{startOffset:o,endOffset:a}=i;o>s&&(r.push({t:q.RETAIN,len:o-s}),s=o),a>s&&(r.push({t:q.RETAIN,len:a-s,body:{...Z.deepClone(t),dataStream:""}}),s=a)}),r}const FC=e=>{var h;const{selection:t,body:n,doc:r}=e,s=t.segmentId,i=(h=r.getSelfOrHeaderFooterModel(s))==null?void 0:h.getBody();if(!i)return!1;const o=t.collapsed?null:yt(i,t.startOffset,t.endOffset),a=ia(o?o.dataStream:"",n.dataStream);let l=0;const c=a.map(([d,f])=>{switch(d){case 0:{const g={t:q.RETAIN,body:{...yt(n,l,l+f.length,!1),dataStream:""},len:f.length};return l+=f.length,g}case 1:{const g={t:q.INSERT,body:yt(n,l,l+f.length),len:f.length};return l+=f.length,g}default:return{t:q.DELETE,len:f.length}}}),u=new Me;return u.push({t:q.RETAIN,len:t.startOffset}),u.push(...c),u};function BC(e,t){return!!((e==null?void 0:e.length)===(t==null?void 0:t.length)&&(e!=null&&e.every((n,r)=>JSON.stringify(n)===JSON.stringify(t==null?void 0:t[r]))))}const $C=e=>{var d;const{selection:t,body:n,doc:r,themeService:s}=e,i=t.segmentId,o=(d=r.getSelfOrHeaderFooterModel(i))==null?void 0:d.getBody();if(!o)return!1;const a=t.collapsed?null:yt(o,t.startOffset,t.endOffset),l=ia(a?a.dataStream:"",n.dataStream);let c=0;const u=l.map(([f,g])=>{switch(f){case 0:{const _=xs(n,c,c+g.length,!1),R=xs(a,c,c+g.length,!1),b={t:q.RETAIN,body:BC(_,R)?void 0:{textRuns:_==null?void 0:_.map(F=>{var k,W,S,C,w,T,B;return{...F,ts:{...F.ts,cl:(S=(W=(k=F.ts)==null?void 0:k.cl)==null?void 0:W.rgb)!=null&&S.includes(".")?{rgb:s.getColorFromTheme((T=(w=(C=F.ts)==null?void 0:C.cl)==null?void 0:w.rgb)!=null?T:"")}:(B=F.ts)==null?void 0:B.cl}}}),dataStream:""},len:g.length};return c+=g.length,b}case 1:{const _={t:q.INSERT,body:yt(n,c,c+g.length),len:g.length};return c+=g.length,_}default:return{t:q.DELETE,len:g.length}}});if(u.every(f=>f.t===q.RETAIN&&!f.body))return!1;const h=new Me;return h.push({t:q.RETAIN,len:t.startOffset}),h.push(...u),h};function HC(e,t){const n=[],{customBlocks:r=[]}=e;for(const s of t){const{startOffset:i,endOffset:o}=s;if(!(i==null||o==null))for(const a of r){const{startIndex:l}=a;l>=i&&l<o&&n.push(a.blockId)}}return n}function jC(e,t=""){if(!t)return["body"];const{headers:n,footers:r}=e.getSnapshot();if(n==null&&r==null)throw new Error("Document data model must have headers or footers when update by segment id");if((n==null?void 0:n[t])!=null)return["headers",t,"body"];if((r==null?void 0:r[t])!=null)return["footers",t,"body"];throw new Error("Segment id not found in headers or footers")}const WC=e=>{var _,R,b,F;const{selection:t,documentDataModel:n,drawings:r}=e,{collapsed:s,startOffset:i,segmentId:o}=t,a=new Me,l=Gt.getInstance(),c=[],u=n.getSelfOrHeaderFooterModel(o).getBody();if(!u)return!1;const h=(R=(_=n.getSnapshot().drawingsOrder)==null?void 0:_.length)!=null?R:0;let d=0;if(s)i>0&&a.push({t:q.RETAIN,len:i});else{const k=Nh([t],u,0,null,!1);a.push(...k);const W=HC(u,[t]),S=(b=n.getDrawings())!=null?b:{},C=(F=n.getDrawingsOrder())!=null?F:[],w=W.sort((T,B)=>C.indexOf(T)>C.indexOf(B)?-1:C.indexOf(T)<C.indexOf(B)?1:0);if(w.length>0)for(const T of w){const B=S[T],$=C.indexOf(T);if(B==null||$<0)continue;const m=l.removeOp(["drawings",T],B),x=l.removeOp(["drawingsOrder",$],T);c.push(m),c.push(x),d++}}a.push({t:q.INSERT,body:{dataStream:"\b".repeat(r.length),customBlocks:r.map((k,W)=>({startIndex:W,blockId:k.drawingId}))},len:r.length});const f=jC(n,o),g=l.editOp(a.serialize(),f);c.push(g);for(const k of r){const{drawingId:W}=k,S=l.insertOp(["drawings",W],k),C=l.insertOp(["drawingsOrder",h-d],W);c.push(S),c.push(C)}return c.reduce((k,W)=>Gt.compose(k,W),null)};function YC(e,t){if(typeof t>"u")return{startOffset:e,endOffset:e,collapsed:!0};if(t<e)throw new Error(`Cannot make a doc selection when endOffset ${t} is less than startOffset ${e}.`);return{startOffset:e,endOffset:t,collapsed:e===t}}function GC(e){const{startOffset:t,endOffset:n,collapsed:r}=e,s=Math.min(t,n),i=Math.max(t,n);return{startOffset:s,endOffset:i,collapsed:r}}function VC(e,t,n,r){return Math.max(e,n)<=Math.min(t,r)}function qi(e,t,n,r){const{startOffset:s,endOffset:i}=e,o=r!=null?r:oa(t,n),a=[];let l=-1;for(let c=0;c<o.length;c++){const u=o[c],{startIndex:h}=u;(s>l&&s<=h||i>l&&i<=h||h>=s&&h<=i)&&a.push(u),l=h}return a}function Zi(e,t,n){const r=[],s=oa(t,n);for(const i of e){const o=qi(i,t,n,s);r.push(...o)}return r}const zC=[at.PARAGRAPH,at.TABLE_START,at.TABLE_END,at.TABLE_ROW_START,at.TABLE_CELL_START,at.TABLE_CELL_END];function oa(e,t){const n=[];for(let r=0;r<e.length;r++){const s=e[r],{startIndex:i}=s;let o=i-1;for(;!zC.includes(t[o])&&o>=0;)o--;n.push({...s,paragraphStart:o+1,paragraphEnd:s.startIndex})}return n}const KC=e=>{var h,d,f;const{paragraphs:t,segmentId:n,document:r}=e;let s=e.listType;const i=(d=(h=r.getSelfOrHeaderFooterModel(n).getBody())==null?void 0:h.paragraphs)!=null?d:[],o=t.every(g=>{var _;return((_=g.bullet)==null?void 0:_.listType.indexOf(s))===0});let l=tt(6);if(t.length===1){const g=i.indexOf(t[0]),_=i[g-1],R=i[g+1];_&&_.bullet&&_.bullet.listType.indexOf(s)===0?(l=_.bullet.listId,s!==kt.CHECK_LIST&&(s=_.bullet.listType)):R&&R.bullet&&R.bullet.listType.indexOf(s)===0&&(l=R.bullet.listId,s!==kt.CHECK_LIST&&(s=R.bullet.listType))}const c=new vn;c.reset();const u=new Me;for(const g of t){const{startIndex:_,paragraphStyle:R={},bullet:b}=g;u.push({t:q.RETAIN,len:_-c.cursor}),u.push({t:q.RETAIN,len:1,body:{dataStream:"",paragraphs:[o?{paragraphStyle:R,startIndex:0}:{startIndex:0,paragraphStyle:{...R},bullet:{nestingLevel:(f=b==null?void 0:b.nestingLevel)!=null?f:0,textStyle:{fs:20},listType:s,listId:l}}]},coverType:Ee.REPLACE}),c.moveCursorTo(_+1)}return u},XC=e=>{var h;const{paragraphIndex:t,segmentId:n,document:r}=e,s=(h=r.getSelfOrHeaderFooterModel(n).getBody())==null?void 0:h.paragraphs;if(s==null)return!1;const i=s.find(d=>d.startIndex===t);if(!(i!=null&&i.bullet)||i.bullet.listType.indexOf(kt.CHECK_LIST)===-1)return!1;const o=new vn;o.reset();const a=new Me,{startIndex:l,paragraphStyle:c={}}=i,u=i.bullet.listType===kt.CHECK_LIST?kt.CHECK_LIST_CHECKED:kt.CHECK_LIST;return a.push({t:q.RETAIN,len:l-o.cursor}),a.push({t:q.RETAIN,len:1,body:{dataStream:"",paragraphs:[{...i,paragraphStyle:c,startIndex:0,bullet:{...i.bullet,listType:u}}]},coverType:Ee.REPLACE}),o.moveCursorTo(l+1),a},qC=e=>{var u,h;const{paragraphs:t,listType:n,segmentId:r,document:s}=e;if(((u=s.getSelfOrHeaderFooterModel(r).getBody())==null?void 0:u.paragraphs)==null)return!1;const a=tt(6),l=new vn;l.reset();const c=new Me;for(const d of t){const{startIndex:f,paragraphStyle:g={},bullet:_}=d;c.push({t:q.RETAIN,len:f-l.cursor}),c.push({t:q.RETAIN,len:1,body:{dataStream:"",paragraphs:[{startIndex:0,paragraphStyle:g,bullet:{nestingLevel:(h=_==null?void 0:_.nestingLevel)!=null?h:0,textStyle:(_==null?void 0:_.listType)===n?_.textStyle:{fs:20},listType:n,listId:a}}]},coverType:Ee.REPLACE}),l.moveCursorTo(f+1)}return c};function ZC(e,t){return t.some(n=>e.startIndex>n.startIndex&&e.startIndex<n.endIndex)}const JC=e=>{var c,u,h;const{paragraphs:t,document:n,type:r}=e,s=new vn;s.reset();const i=new Me,o=(c=n.getSnapshot().lists)!=null?c:{},a=(h=(u=n.getBody())==null?void 0:u.tables)!=null?h:[],l={...Yr,...o};for(const d of t){const{startIndex:f,paragraphStyle:g={},bullet:_}=d,R=ZC(d,a);if(i.push({t:q.RETAIN,len:f-s.cursor}),_){const b=_.listType;let F=l[b].nestingLevel.length-1;R&&(F=Math.min(F,2)),i.push({t:q.RETAIN,len:1,body:{dataStream:"",paragraphs:[{startIndex:0,paragraphStyle:{...g},bullet:{..._,nestingLevel:Math.max(Math.min(_.nestingLevel+r,F),0)}}]},coverType:Ee.REPLACE})}else i.push({t:q.RETAIN,len:1});s.moveCursorTo(f+1)}return i},QC=e=>{var R,b,F,k;const{textRanges:t,segmentId:n,document:r,style:s,paragraphTextRun:i,cursor:o,deleteLen:a,textX:l}=e,c=r.getSelfOrHeaderFooterModel(n),u=(b=(R=c.getBody())==null?void 0:R.paragraphs)!=null?b:[],h=(k=(F=c.getBody())==null?void 0:F.dataStream)!=null?k:"",d=Zi(t,u,h),f=new vn;o&&f.moveCursorTo(o);const g=l!=null?l:new Me;d.sort((W,S)=>W.startIndex-S.startIndex);const _=Math.max(0,d[0].paragraphStart-1);_>f.cursor&&(g.push({t:q.RETAIN,len:_-f.cursor}),f.moveCursorTo(_)),a&&g.push({t:q.DELETE,len:a});for(const W of d){const{startIndex:S,paragraphStyle:C={}}=W,w=S-f.cursor;g.push({t:q.RETAIN,len:w,...i?{body:{dataStream:"",textRuns:[{ts:i,st:0,ed:w}]},coverType:Ee.REPLACE}:null}),g.push({t:q.RETAIN,len:1,body:{dataStream:"",paragraphs:[{startIndex:0,paragraphStyle:{...C,...s}}]},coverType:Ee.REPLACE}),f.moveCursorTo(S+1)}return g};class Qe{}p(Qe,"customRange",{add:PC,delete:UC,copyCustomRange:NC,getCustomRangesInterestsWithSelection:yC,isIntersecting:Th}),p(Qe,"customDecoration",{add:AC,delete:TC}),p(Qe,"selection",{replace:FC,makeSelection:YC,normalizeSelection:GC,delete:Nh,replaceTextRuns:$C,retain:kC}),p(Qe,"range",{isIntersects:VC,getParagraphsInRange:qi,getParagraphsInRanges:Zi}),p(Qe,"transform",{getPlainText:Js,fromPlainText:wC,isEmptyDocument:vC}),p(Qe,"paragraph",{bullet:{set:qC,switch:KC,toggleChecklist:XC,changeNestLevel:JC},style:{set:QC},util:{transform:oa,getParagraphsInRange:qi,getParagraphsInRanges:Zi}}),p(Qe,"drawing",{add:WC});function eR(e,t,n,r){var c;if(t==="")return e;const s={id:"mock-id",body:e,documentStyle:{}},i=new Nt(s),o=t.length;let a;for(;(a=(r?i.getBody().dataStream:i.getBody().dataStream.toLowerCase()).indexOf(t))>=0;){const u=new Me,h=Gt.getInstance();if(a>0&&u.retain(a),n.length>0){const d=i.sliceBody(a,a+o),f={dataStream:n};if(Array.isArray(d==null?void 0:d.textRuns)&&d.textRuns.length&&(f.textRuns=[{...d.textRuns[0],st:0,ed:n.length}]),(c=d==null?void 0:d.customRanges)!=null&&c.length){const g=d.customRanges[0];f.customRanges=[{...g,startIndex:0,endIndex:n.length-1}]}u.insert(n.length,f)}u.delete(o),i.apply(h.editOp(u.serialize()))}const l=i.getBody();return i.dispose(),l}function tR(e){if(e.customRanges||(e.customRanges=[]),!e.paragraphs){e.paragraphs=[];for(let t=0;t<e.dataStream.length;t++)e.dataStream[t]==="\r"&&e.paragraphs.push({startIndex:t})}return e.customBlocks||(e.customBlocks=[]),e.textRuns||(e.textRuns=[]),e.customDecorations||(e.customDecorations=[]),e.sectionBreaks||(e.sectionBreaks=[]),e.tables||(e.tables=[]),e}function Mh(e){var t;return e.body=tR((t=e.body)!=null?t:{dataStream:""}),e.drawingsOrder||(e.drawingsOrder=[]),e.drawings||(e.drawings={}),e.documentStyle||(e.documentStyle={}),e}class Gr{constructor(t={}){p(this,"_style");this._style=t}static create(t={}){return new Gr(t)}get fontFamily(){return this._style.ff}get fontSize(){return this._style.fs}get italic(){return this._style.it===ie.TRUE}get bold(){return this._style.bl===ie.TRUE}get underline(){return this._style.ul&&Jt.create(this._style.ul)}get bottomBorderLine(){return this._style.bbl&&Jt.create(this._style.bbl)}get strikethrough(){return this._style.st&&Jt.create(this._style.st)}get overline(){return this._style.ol&&Jt.create(this._style.ol)}get background(){return this._style.bg}get border(){return this._style.bd}get color(){return this._style.cl}get verticalAlign(){return this._style.va}get numberFormat(){return this._style.n}copy(){return nn.create(Z.deepClone(this._style))}getValue(){return{...this._style}}}class nn extends Gr{static create(t={}){return new nn(t)}constructor(t={}){super(t)}setFontFamily(t){return this._style.ff=t,this}setFontSize(t){return this._style.fs=t,this}setItalic(t){return this._style.it=t?1:0,this}setBold(t){return this._style.bl=t?1:0,this}setUnderline(t){return this._style.ul=t.build(),this}setBottomBorderLine(t){return this._style.bbl=t.build(),this}setStrikethrough(t){return this._style.st=t.build(),this}setOverline(t){return this._style.ol=t.build(),this}setBackground(t){return this._style.bg=t,this}setBorder(t){return this._style.bd=t,this}setColor(t){return this._style.cl=t,this}setVerticalAlign(t){return this._style.va=t,this}copy(){return nn.create(Z.deepClone(this._style))}build(){return this.getValue()}}class Jt{constructor(t={s:1}){p(this,"_decoration");this._decoration=t}static create(t={s:1}){return new Jt(t)}get show(){return this._decoration.s===ie.TRUE}get followFontColor(){return this._decoration.c===ie.TRUE}get color(){return this._decoration.cl}get type(){return this._decoration.t}setShow(t){return this._decoration.s=t?1:0,this}setFollowFontColor(t){return this._decoration.c=t?1:0,this}setColor(t){return this._decoration.cl=t,this}setLineType(t){return this._decoration.t=t,this}copy(){return Jt.create(Z.deepClone(this._decoration))}build(){return{...this._decoration}}}class Vr{constructor(t={}){p(this,"_style");this._style=t}static create(t={}){return new Vr(t)}get indentFirstLine(){return this._style.indentFirstLine}get hanging(){return this._style.hanging}get indentStart(){return this._style.indentStart}get tabStops(){return this._style.tabStops}get indentEnd(){return this._style.indentEnd}get textStyle(){return this._style.textStyle}get headingId(){return this._style.headingId}get namedStyleType(){return this._style.namedStyleType}get horizontalAlign(){return this._style.horizontalAlign}get lineSpacing(){return this._style.lineSpacing}get direction(){return this._style.direction}get spacingRule(){return this._style.spacingRule}get snapToGrid(){return this._style.snapToGrid}get spaceAbove(){return this._style.spaceAbove}get spaceBelow(){return this._style.spaceBelow}get borderBetween(){return this._style.borderBetween}get borderTop(){return this._style.borderTop}get borderBottom(){return this._style.borderBottom}get borderLeft(){return this._style.borderLeft}get borderRight(){return this._style.borderRight}get keepLines(){return this._style.keepLines===ie.TRUE}get keepNext(){return this._style.keepNext===ie.TRUE}get wordWrap(){return this._style.wordWrap===ie.TRUE}get widowControl(){return this._style.widowControl===ie.TRUE}get shading(){return this._style.shading}get suppressHyphenation(){return this._style.suppressHyphenation===ie.TRUE}copy(){return Lr.create(Z.deepClone(this._style))}getValue(){return this._style}}class Lr extends Vr{static create(t={}){return new Lr(t)}constructor(t={}){super(t)}setIndentFirstLine(t){return this._style.indentFirstLine=t,this}setHanging(t){return this._style.hanging=t,this}setIndentStart(t){return this._style.indentStart=t,this}setTabStops(t){return this._style.tabStops=t,this}setIndentEnd(t){return this._style.indentEnd=t,this}setTextStyle(t){return this._style.textStyle=t,this}setHeadingId(t){return this._style.headingId=t,this}setNamedStyleType(t){return this._style.namedStyleType=t,this}setHorizontalAlign(t){return this._style.horizontalAlign=t,this}setLineSpacing(t){return this._style.lineSpacing=t,this}setDirection(t){return this._style.direction=t,this}setSpacingRule(t){return this._style.spacingRule=t,this}setSnapToGrid(t){return this._style.snapToGrid=t?1:0,this}setSpaceAbove(t){return this._style.spaceAbove=t,this}setSpaceBelow(t){return this._style.spaceBelow=t,this}setBorderBetween(t){return this._style.borderBetween=t,this}setBorderTop(t){return this._style.borderTop=t,this}setBorderBottom(t){return this._style.borderBottom=t,this}setBorderLeft(t){return this._style.borderLeft=t,this}setBorderRight(t){return this._style.borderRight=t,this}setKeepLines(t){return this._style.keepLines=t?1:0,this}setKeepNext(t){return this._style.keepNext=t?1:0,this}setWordWrap(t){return this._style.wordWrap=t?1:0,this}setWidowControl(t){return this._style.widowControl=t?1:0,this}setShading(t){return this._style.shading=t,this}setSuppressHyphenation(t){return this._style.suppressHyphenation=t?1:0,this}copy(){return Lr.create(Z.deepClone(this._style))}build(){return this.getValue()}}class Qt{constructor(t){p(this,"_data");if(!t.body)throw new Error("Invalid document data, body is required");this._data=Mh(t)}static create(t){return new Qt(t)}static createByBody(t){return new Qt({body:t,id:"d",documentStyle:{}})}copy(){return En.create(Z.deepClone(this._data))}slice(t,n){const{body:r,...s}=this._data;return En.create({...Z.deepClone(s),body:yt(r,t,n)})}toPlainText(){var t,n;return Qe.transform.getPlainText((n=(t=this._data.body)==null?void 0:t.dataStream)!=null?n:"").replaceAll("\r",`
`)}getParagraphStyle(){var t,n;return Vr.create((n=(t=this._data.body)==null?void 0:t.paragraphs)==null?void 0:n[0].paragraphStyle)}getParagraphBullet(){var t,n;return(n=(t=this._data.body)==null?void 0:t.paragraphs)==null?void 0:n[0].bullet}getParagraphs(){var r,s;const t=(s=(r=this._data.body)==null?void 0:r.paragraphs)!=null?s:[];let n=0;return t.map(i=>{const o=this.slice(n,i.startIndex);return n=i.startIndex,o})}getTextRuns(){var t,n;return((n=(t=this._data.body)==null?void 0:t.textRuns)!=null?n:[]).map(r=>({...r,ts:r.ts?Gr.create(r.ts):null}))}getLinks(){var t,n,r;return(r=(n=(t=this._data.body)==null?void 0:t.customRanges)==null?void 0:n.filter(s=>s.rangeType===rn.HYPERLINK))!=null?r:[]}getData(){return this._data}}class En extends Qt{constructor(n){super(n);p(this,"_doc");this._doc=new Nt(n)}static newEmptyData(){return Mh({id:"d",documentStyle:{},drawings:{},drawingsOrder:[],body:{dataStream:`\r
`,customBlocks:[],customRanges:[],paragraphs:[{startIndex:0}],textRuns:[],tables:[],sectionBreaks:[]}})}static create(n){return new En(n!=null?n:En.newEmptyData())}insertText(n,r,s){var u,h;let i=((h=(u=this._data.body)==null?void 0:u.dataStream.length)!=null?h:2)-2,o,a;if(typeof n=="string"?o=n:(i=Math.min(n,i),o=r),typeof r=="object"?a=r instanceof nn?r.build():r:a=s instanceof nn?s.build():s,!o)return this;const l={dataStream:o,textRuns:a?[{ts:a,st:i,ed:i+o.length}]:[]},c=Qe.selection.replace({doc:this._doc,selection:{startOffset:i,endOffset:i,collapsed:!0},body:l});if(!c)throw new Error("Insert text failed, please check.");return Me.apply(this._doc.getBody(),c.serialize()),this}insertRichText(n,r){var a,l;let s=((l=(a=this._data.body)==null?void 0:a.dataStream.length)!=null?l:2)-2,i;typeof n=="object"?i=n instanceof Qt?n.getData():n:(s=Math.min(n,s),i=r instanceof Qt?r.getData():r);const o=Qe.selection.replace({doc:this._doc,selection:{startOffset:s,endOffset:s,collapsed:!0},body:i.body});if(!o)throw new Error("Insert text failed, please check.");return Me.apply(this._doc.getBody(),o.serialize()),this}delete(n,r){if(r!==void 0){if(!r)return this;const s=Qe.selection.delete([{startOffset:n,endOffset:n+r,collapsed:!0}],this._data.body);Me.apply(this._doc.getBody(),s)}return this}setStyle(n,r,s){const i={dataStream:"",textRuns:[{ts:s instanceof nn?s.build():s,st:0,ed:r-n}]},o=Qe.selection.retain([{startOffset:n,endOffset:r,collapsed:!0}],i);return Me.apply(this._doc.getBody(),o),this}setLink(n,r,s){const i=Qe.customRange.add({rangeType:rn.HYPERLINK,rangeId:tt(),properties:{url:s},ranges:[{startOffset:n,endOffset:r,collapsed:!1}],body:this._data.body});if(!i)throw new Error("Insert text failed, please check.");return Me.apply(this._doc.getBody(),i.serialize()),this}cancelLink(n,r){if(typeof n=="string"){const s=Qe.customRange.delete({rangeId:n,documentDataModel:this._doc});if(!s)throw new Error("Insert text failed, please check.");Me.apply(this._doc.getBody(),s.serialize())}else this.slice(n,r).getLinks().forEach(i=>{const o=Qe.customRange.delete({rangeId:i.rangeId,documentDataModel:this._doc});if(!o)throw new Error("Insert text failed, please check.");Me.apply(this._doc.getBody(),o.serialize())});return this}updateLink(n,r){var i,o;const s=(o=(i=this._data.body)==null?void 0:i.customRanges)==null?void 0:o.find(a=>a.rangeId===n);if(!s)throw new Error("Link not found");return s.properties.url=r,this}insertParagraph(n,r){var o,a;let s,i;return typeof n=="object"?(s={dataStream:"\r",paragraphs:[{startIndex:0,paragraphStyle:n.build()}]},i=((a=(o=this._data.body)==null?void 0:o.dataStream.length)!=null?a:2)-2):(i=n,s={dataStream:"\r",paragraphs:[{startIndex:0,paragraphStyle:r==null?void 0:r.build()}]}),this.insertRichText(i,Qt.create({body:s,id:"d",documentStyle:{}})),this}insertLink(n,r,s){let i="",o="";typeof n=="string"?(i=n,o=r):(i=r,o=s);const a=En.createByBody({dataStream:i,customRanges:[{rangeType:rn.HYPERLINK,rangeId:tt(),properties:{url:o},startIndex:0,endIndex:i.length-1}]});return typeof n=="number"?this.insertRichText(n,a):this.insertRichText(a)}}const nR="__default_document_sub_component_id20231101__";class Lh{constructor(){p(this,"skipNextObservers",!1);p(this,"lastReturnValue");p(this,"isStopPropagation",!1)}stopPropagation(){this.isStopPropagation=!0}}class rR extends ce.Subject{constructor(){super(...arguments);p(this,"_sortedObservers",[])}subscribe(){throw new Error("[EventSubject]: please use `subscribeEvent` instead of `subscribe` method for `EventSubject`.")}next(){throw new Error("[EventSubject]: please use `emitEvent` instead of `next` method for `EventSubject`.")}unsubscribe(){super.unsubscribe(),this._sortedObservers.length=0}complete(){super.complete(),this._sortedObservers.length=0}subscribeEvent(n){let r;typeof n=="function"?r={next:([i,o])=>n(i,o)}:r=n;const s=super.subscribe(r);return this._sortedObservers.push(r),this._sortedObservers.sort((i,o)=>{var a,l;return((a=i.priority)!=null?a:0)-((l=o.priority)!=null?l:0)}),s.add(()=>this._sortedObservers=this._sortedObservers.filter(i=>i!==r)),s}clearObservers(){this._sortedObservers.forEach(n=>{var r;return(r=n.complete)==null?void 0:r.call(n)}),this._sortedObservers.length=0}emitEvent(n){var r;if(!this.closed){const s=new Lh;s.lastReturnValue=n;for(const i of this._sortedObservers){const o=(r=i.next)==null?void 0:r.call(i,[n,s]);if(s.lastReturnValue=o,s.skipNextObservers)return{handled:!0,lastReturnValue:s.lastReturnValue,stopPropagation:s.isStopPropagation}}return{handled:this._sortedObservers.length>0,lastReturnValue:s.lastReturnValue,stopPropagation:s.isStopPropagation}}throw new Error("[EventSubject]: cannot emit event on a closed subject.")}}function sR(e){return new ce.Observable(t=>{const n=e.subscribeEvent(r=>{t.next(r)});return()=>n.unsubscribe()})}const Qs=Ae.createIdentifier("core.resource-manager.service"),Ji={[Ut.Editor]:"Editor",[Ut.Owner]:"Owner",[Ut.Reader]:"Reader",[Ut.UNRECOGNIZED]:"UNRECOGNIZED"},Us=e=>e?{userID:`${Ji[e]}_${tt(8)}`,name:Ji[e],avatar:""}:{userID:"",name:"",avatar:"",anonymous:!0,canBindAnonymous:!1},iR=(e,t)=>e.startsWith(Ji[t]);class Dr extends Ke{constructor(){super(...arguments);p(this,"_model",new Map);p(this,"_userChange$",new ce.Subject);p(this,"userChange$",this._userChange$.asObservable());p(this,"_currentUser$",new ce.BehaviorSubject(Us()));p(this,"currentUser$",this._currentUser$.asObservable())}dispose(){super.dispose(),this._model.clear(),this._userChange$.complete(),this._currentUser$.complete()}getCurrentUser(){return this._currentUser$.getValue()}setCurrentUser(n){this.addUser(n),this._currentUser$.next(n)}addUser(n){this._model.set(n.userID,n),this._userChange$.next({type:"add",user:n})}getUser(n,r){const s=this._model.get(n);if(s)return s;r&&r()}delete(n){const r=this.getUser(n);this._model.delete(n),r&&this._userChange$.next({type:"delete",user:r})}clear(){this._model.clear(),this._userChange$.next({type:"clear"})}list(){return Array.from(this._model.values())}}var oR=Object.getOwnPropertyDescriptor,aR=(e,t,n,r)=>{for(var s=r>1?void 0:r?oR(t,n):t,i=e.length-1,o;i>=0;i--)(o=e[i])&&(s=o(s)||s);return s},Cl=(e,t)=>(n,r)=>t(n,r,e);exports.AuthzIoLocalService=class{constructor(t,n){p(this,"_permissionMap",new Map([]));this._resourceManagerService=t,this._userManagerService=n,this._initSnapshot(),this._initDefaultUser()}_initDefaultUser(){const t=this._userManagerService.getCurrentUser();t&&t.userID||this._userManagerService.setCurrentUser(Us(Ut.Owner))}_getRole(t){const n=this._userManagerService.getCurrentUser();return n?iR(n.userID,t):!1}_initSnapshot(){this._resourceManagerService.registerPluginResource({toJson:t=>{const n=[...this._permissionMap.keys()].reduce((r,s)=>{const i=this._permissionMap.get(s);return r[s]=i,r},{});return JSON.stringify(n)},parseJson:t=>JSON.parse(t),pluginName:"SHEET_AuthzIoMockService_PLUGIN",businesses:[Oe.UNIVER_SHEET,Oe.UNIVER_DOC,Oe.UNIVER_SLIDE],onLoad:(t,n)=>{for(const r in n)this._permissionMap.set(r,n[r])},onUnLoad:()=>{this._permissionMap.clear()}})}async create(t){return tt(8)}async allowed(t){return Promise.resolve([])}async batchAllowed(t){return Promise.resolve([])}async list(t){const n=[];return t.objectIDs.forEach(r=>{const s=this._permissionMap.get(r);if(s){const i={objectID:r,unitID:t.unitID,objectType:s.objectType,name:s.name,shareOn:!1,shareRole:Ut.Owner,shareScope:-1,scope:{read:Mi.AllCollaborator,edit:Mi.AllCollaborator},creator:Us(Ut.Owner),strategies:[{action:6,role:1},{action:16,role:1},{action:17,role:1},{action:18,role:1},{action:19,role:1},{action:33,role:1},{action:34,role:1},{action:35,role:1},{action:36,role:1},{action:37,role:1},{action:38,role:1},{action:39,role:1},{action:40,role:1}],actions:t.actions.map(o=>({action:o,allowed:this._getRole(Ut.Owner)||this._getRole(Ut.Editor)}))};n.push(i)}}),n}async listCollaborators(){return[]}async listRoles(){return{roles:[],actions:[]}}async deleteCollaborator(){}async update(t){}async updateCollaborator(){}async createCollaborator(){}async putCollaborators(t){}};exports.AuthzIoLocalService=aR([Cl(0,Qs),Cl(1,Ae.Inject(Dr))],exports.AuthzIoLocalService);const Dh=Ae.createIdentifier("IAuthzIoIoService"),aa=Ae.createIdentifier("univer.config-service");class xh{constructor(){p(this,"_configChanged$",new ce.Subject);p(this,"configChanged$",this._configChanged$.asObservable());p(this,"_config",new Map)}dispose(){this._config.clear(),this._configChanged$.complete()}getConfig(t){return this._config.get(t)}setConfig(t,n,r){var o;const{merge:s=!1}=r||{};let i=(o=this._config.get(t))!=null?o:{};s?i=Hs(i,n):i=n,this._config.set(t,i),this._configChanged$.next({[t]:i})}deleteConfig(t){return this._config.delete(t)}subscribeConfigValue$(t){return new ce.Observable(n=>{Object.prototype.hasOwnProperty.call(this._config,t)&&n.next(this._config.get(t));const r=this.configChanged$.pipe(ce.filter(s=>Object.prototype.hasOwnProperty.call(s,t))).subscribe(s=>n.next(s[t]));return()=>r.unsubscribe()})}}const Cr="FOCUSING_UNIT",Hn="FOCUSING_SHEET",Rr="FOCUSING_DOC",Ir="FOCUSING_SLIDE",lR="FOCUSING_EDITOR_BUT_HIDDEN",Uh="EDITOR_ACTIVATED",cR="FOCUSING_EDITOR_INPUT_FORMULA",Ph="FOCUSING_FX_BAR_EDITOR",uR="FOCUSING_UNIVER_EDITOR",hR="FOCUSING_EDITOR_INPUT_FORMULA",dR="FOCUSING_PANEL_EDITOR",fR="FOCUSING_UNIVER_EDITOR_STANDALONE_SINGLE_MODE",mR="FOCUSING_COMMON_DRAWINGS",gR="FORMULA_EDITOR_ACTIVATED";class kh extends Ke{constructor(){super(...arguments);p(this,"_error$",new ce.Subject);p(this,"error$",this._error$.asObservable())}dispose(){this._error$.complete()}emit(n){this._error$.next({errorKey:n})}}var la=(e=>(e.URL="URL",e.UUID="UUID",e.BASE64="BASE64",e))(la||{}),Fh=(e=>(e.SUCCUSS="0",e.ERROR_EXCEED_SIZE="1",e.ERROR_IMAGE_TYPE="2",e.ERROR_UPLOAD_COUNT_LIMIT="3",e.ERROR_IMAGE="4",e))(Fh||{});const Qi=Ae.createIdentifier("core.image-io.service"),_R="0.11.0",pR={version:_R};function ER(e="",t=Fr.ZH_CN,n=""){return{id:e,sheetOrder:[],name:n,appVersion:pR.version,locale:t,styles:{},sheets:{},resources:[]}}class Bh{constructor(t={}){p(this,"_styles");p(this,"_cacheMap",new yr(1e5));this._styles=t,this._generateCacheMap()}each(t){return Object.entries(this._styles).forEach(t),this}search(t,n){if(this._cacheMap.has(n))return this._cacheMap.get(n);const r=this._getExistingStyleId(t);return r||"-1"}get(t){return typeof t!="string"?t:(t=String(t),this._styles[t])}add(t,n){const r=tt(6);return this._styles[r]=t,this._cacheMap.set(n,r),r}setValue(t){if(t==null)return;const n=JSON.stringify(t),r=this.search(t,n);return r!=="-1"?r:this.add(t,n)}addCustomStyle(t,n){n!=null&&(this._styles[t]=n,this._cacheMap.set(JSON.stringify(n),t))}remove(t){this._styles[t]&&(delete this._styles[t],this._cacheMap.delete(JSON.stringify(this._styles[t])))}toJSON(){return this._styles}getStyleByCell(t){let n;t&&Z.isObject(t.s)?n=t.s:n=(t==null?void 0:t.s)&&this.get(t.s);const r=t==null?void 0:t.interceptorStyle;return r?{...n,...r}:n}_generateCacheMap(){const{_styles:t,_cacheMap:n}=this;for(const r in t){const s=JSON.stringify(t[r]);n.set(s,r)}}_getExistingStyleId(t){const{_styles:n}=this;for(const r in n)if(Z.diffValue(n[r],t))return r;return null}}const CR=(e,t)=>t.length===e.length&&!e.some(n=>t.some(r=>!on.equals(r,n))),RR=(e,t)=>t.length===e.length&&e.every((n,r)=>{const s=t[r];return s.unitId===n.unitId&&s.sheetId===n.sheetId&&on.equals(n.range,s.range)}),eo={t:0,b:2,l:2,r:2},IR=e=>({sbr:.6,sbo:e,spr:.6,spo:e}),Rl=90;function Sr(e,t,n={}){const r=e.length,{textRotation:s,paddingData:i,horizontalAlign:o=Tt.UNSPECIFIED,verticalAlign:a=_n.UNSPECIFIED,wrapStrategy:l=In.UNSPECIFIED,cellValueType:c}=n,{t:u,r:h,b:d,l:f}=i||eo,{vertexAngle:g,centerAngle:_}=jh(s),R={id:"d",body:{dataStream:`${e}${Ml}`,textRuns:[{ts:t,st:0,ed:r}],paragraphs:[{startIndex:r,paragraphStyle:{horizontalAlign:o}}],sectionBreaks:[{startIndex:r+1}]},documentStyle:{pageSize:{width:Number.POSITIVE_INFINITY,height:Number.POSITIVE_INFINITY},marginTop:u,marginBottom:d,marginRight:h,marginLeft:f,renderConfig:{horizontalAlign:o,verticalAlign:a,centerAngle:_,vertexAngle:g,wrapStrategy:l,cellValueType:c}},drawings:{},drawingsOrder:[]};return new Nt(R)}function SR(e){if(!e)return{};const{tr:t,td:n,ht:r,vt:s,tb:i,pd:o}=e;return{textRotation:t,textDirection:n,horizontalAlign:r,verticalAlign:s,wrapStrategy:i,paddingData:o}}function Il(e){if(!e)return{};const{ff:t,fs:n,it:r,bl:s,ul:i,st:o,ol:a,cl:l,bg:c}=e,u={};return t&&(u.ff=t),n&&(u.fs=n),r&&(u.it=r),s&&(u.bl=s),i&&(u.ul=i),o&&(u.st=o),a&&(u.ol=a),l&&(u.cl=l),c&&(u.bg=c),u}function $h(e,t,n){var i;const r=e.getBody();if((i=r.customRanges)!=null&&i.some(o=>o.rangeType===rn.HYPERLINK))return;const s=Qe.customRange.add({ranges:[{startOffset:0,endOffset:r.dataStream.length-1,collapsed:!1}],rangeId:n,rangeType:rn.HYPERLINK,body:r,properties:{url:t,refId:n}});s&&Me.apply(r,s.serialize())}function Hh(e){return e!=null}const OR='"Helvetica Neue", Helvetica, Arial, "PingFang SC", "Hiragino Sans GB", "Heiti SC", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif';function Sl(e){const t=st.ff,n=st.fs;if(!e){const h=`${n}pt  ${t}`;return{fontCache:h,fontString:h,fontSize:n,originFontSize:n,fontFamily:t}}let r=kn.ITALIC;(e.it===0||e.it===void 0)&&(r=kn.NORMAL);let s=kn.BOLD;(e.bl===0||e.bl===void 0)&&(s=kn.NORMAL);let i=n;e.fs&&(i=Math.ceil(e.fs));let o=t;if(e.ff){let h=e.ff;h=h.replace(/"/g,"").replace(/'/g,""),h.indexOf(" ")>-1&&(h=`"${h}"`),h==null&&(h=t),o=h}const{va:a}=e;let l=i;if(a===Yt.SUBSCRIPT||a===Yt.SUPERSCRIPT){const h=vR(o,l),{sbr:d,spr:f}=h;l*=a===Yt.SUBSCRIPT?d:f}const c=`${r} ${s} ${l}pt ${o}`,u=`${c}, ${OR} `;return{fontCache:c,fontString:u,fontSize:l,originFontSize:i,fontFamily:o}}function vR(e,t){return IR(t)}function jh(e){const{a:t=0,v:n=ie.FALSE}=e||{a:0,v:ie.FALSE};let r=0,s=t;return n===ie.TRUE&&(r=Rl,s=Rl),{centerAngle:r,vertexAngle:s}}class wR{constructor(t,n){p(this,"_columnData",{});this._config=t,this._columnData=n}getColumnData(){return this._columnData}getColVisible(t){const{_columnData:n}=this,r=n[t];return r?r.hd!==ie.TRUE:!0}getColumnStyle(t){var n;return(n=this._columnData[t])==null?void 0:n.s}setColumnStyle(t,n){const r=this.getColumnOrCreate(t);r.s=n}getHiddenCols(t=0,n=this.getSize()-1){const r=[];let s=!1,i=-1;for(let o=t;o<=n;o++){const a=this.getColVisible(o);s&&a?(s=!1,r.push({rangeType:_e.COLUMN,startColumn:i,endColumn:o-1,startRow:0,endRow:0})):!s&&!a&&(s=!0,i=o)}return s&&r.push({startRow:0,endRow:0,startColumn:i,endColumn:n,rangeType:_e.COLUMN}),r}getVisibleCols(t=0,n=this.getSize()-1){const r=[];let s=!1,i=-1;for(let o=t;o<=n;o++){const a=this.getColVisible(o);s&&!a?(s=!1,r.push({rangeType:_e.COLUMN,startColumn:i,endColumn:o-1,startRow:0,endRow:0})):!s&&a&&(s=!0,i=o)}return s&&r.push({startRow:0,endRow:0,startColumn:i,endColumn:n,rangeType:_e.COLUMN}),r}getColumnDatas(t,n){const r={};let s=0;for(let i=t;i<t+n;i++){const o=this.getColumn(i);r[s]=o!=null?o:{w:this._config.defaultColumnWidth,hd:ie.FALSE},s++}return r}getSize(){return tn(this._columnData)}getColumnWidth(t){var n,r;return(r=(n=this._columnData[t])==null?void 0:n.w)!=null?r:this._config.defaultColumnWidth}setColumnWidth(t,n){const r=this._columnData[t];n===this._config.defaultColumnWidth?r&&(delete r.w,Object.keys(r).length===0&&delete this._columnData[t]):this._columnData[t]=r?{...r,w:n}:{w:n}}getColumn(t){return this._columnData[t]}removeColumn(t){delete this._columnData[t]}getColumnOrCreate(t){const{_columnData:n}=this,r=n[t];if(r)return r;const s={};return this._columnData[t]=s,s}setCustomMetadata(t,n){const r=this.getColumn(t);r&&(r.custom=n)}getCustomMetadata(t){var n;return(n=this.getColumn(t))==null?void 0:n.custom}}const bR=2e3;class AR{constructor(t,n,r){p(this,"_rowData");this._config=t,this._viewModel=n,this._rowData=r}getRowData(){return this._rowData}getRowStyle(t){var n;return(n=this._rowData[t])==null?void 0:n.s}setRowStyle(t,n){const r=this.getRowOrCreate(t);r.s=n}getRowDatas(t,n){const r={};let s=0;for(let i=t;i<t+n;i++){const o=this.getRow(i);r[s]=o!=null?o:{h:this._config.defaultRowHeight,hd:ie.FALSE},s++}return r}getRowHeight(t,n=1){const{_rowData:r}=this,s=this._config;let i=0;for(let o=0;o<n;o++){const a=r[o+t]||{hd:ie.FALSE,h:s.defaultRowHeight},{ia:l,ah:c,h:u=s.defaultRowHeight}=a;i+=(l==null||l===ie.TRUE)&&typeof c=="number"?c:u}return i}setRowHeight(t,n){const r=this._rowData[t];if(n===this._config.defaultRowHeight)r&&(delete r.h,Object.keys(r).length===0&&delete this._rowData[t]);else{const s=Math.min(n,bR);this._rowData[t]=r?{...r,h:s}:{h:s}}}getRow(t){return this._rowData[t]}removeRow(t){delete this._rowData[t]}getRowOrCreate(t){const{_rowData:n}=this,r=n[t];if(r)return r;const s={};return n[t]=s,s}getHiddenRows(t=0,n=this.getSize()-1){const r=[];let s=!1,i=-1;for(let o=t;o<=n;o++){const a=this.getRowRawVisible(o);s&&a?(s=!1,r.push({startRow:i,endRow:o-1,startColumn:0,endColumn:0,rangeType:_e.ROW})):!s&&!a&&(s=!0,i=o)}return s&&r.push({startRow:i,endRow:n,startColumn:0,endColumn:0,rangeType:_e.ROW}),r}getVisibleRows(t=0,n=this.getSize()-1){const r=[];let s=!1,i=-1;for(let o=t;o<=n;o++){const a=this.getRowRawVisible(o);s&&!a?(s=!1,r.push({startRow:i,endRow:o-1,startColumn:0,endColumn:0,rangeType:_e.ROW})):!s&&a&&(s=!0,i=o)}return s&&r.push({startRow:i,endRow:n,startColumn:0,endColumn:0,rangeType:_e.ROW}),r}getRowRawVisible(t){const n=this.getRow(t);return n?n.hd!==ie.TRUE:!0}getSize(){return tn(this._rowData)}setCustomMetadata(t,n){const r=this.getRow(t);r&&(r.custom=n)}getCustomMetadata(t){var n;return(n=this.getRow(t))==null?void 0:n.custom}}const TR="DEFAULT_WORKSHEET_ROW_COUNT",Wh=1e3,yR="DEFAULT_WORKSHEET_COLUMN_COUNT",Yh=20,NR="DEFAULT_WORKSHEET_ROW_HEIGHT",Gh=24,MR="DEFAULT_WORKSHEET_COLUMN_WIDTH",Vh=88,LR="DEFAULT_WORKSHEET_ROW_TITLE_WIDTH",zh=46,DR="DEFAULT_WORKSHEET_COLUMN_TITLE_HEIGHT",Kh=20;function Xh(e){const t={name:"Sheet1",id:"sheet-01",tabColor:"",hidden:ie.FALSE,rowCount:Wh,columnCount:Yh,zoomRatio:1,freeze:{xSplit:0,ySplit:0,startRow:-1,startColumn:-1},scrollTop:0,scrollLeft:0,defaultColumnWidth:Vh,defaultRowHeight:Gh,mergeData:[],cellData:{},rowData:{},columnData:{},showGridlines:ie.TRUE,rowHeader:{width:zh,hidden:ie.FALSE},columnHeader:{height:Kh,hidden:ie.FALSE},rightToLeft:ie.FALSE};return Object.keys(t).forEach(n=>{const r=n;typeof e[r]>"u"&&(e[r]=t[r])}),e}class xR extends Ke{constructor(n){super();p(this,"_cellCache",new Map);p(this,"_rowCache",new Map);p(this,"_columnCache",new Map);p(this,"_hasRow",!1);p(this,"_hasColumn",!1);p(this,"_hasAll",!1);p(this,"_allIndex",-1);p(this,"_mergeData");p(this,"_rangeMap",new yr(5e4));p(this,"_skeletonCache",new yr(5e4));this._init(n.concat())}_init(n){this._mergeData=n,this._createCache(n)}_clearCache(){this._cellCache.clear(),this._rowCache.clear(),this._columnCache.clear(),this._hasAll=!1,this._allIndex=-1,this._rangeMap.clear(),this._skeletonCache.clear(),this._hasColumn=!1,this._hasRow=!1}_createCache(n){let r=0;for(const s of n){const{rangeType:i}=s;i===_e.ROW?this._createRowCache(s,r):i===_e.COLUMN?this._createColumnCache(s,r):i===_e.ALL?this._createCellAllCache(r):this._createCellCache(s,r),r++}}rebuild(n){this._clearCache(),this._init(n.concat())}_createRowCache(n,r){const{startRow:s,endRow:i}=n;for(let o=s;o<=i;o++)this._rowCache.set(o,r),this._hasRow=!0}_createColumnCache(n,r){const{startColumn:s,endColumn:i}=n;for(let o=s;o<=i;o++)this._columnCache.set(o,r),this._hasColumn=!0}_createCellAllCache(n){this._hasAll=!0,this._allIndex=n}_createCellCache(n,r){for(let s=n.startRow;s<=n.endRow;s++){let i=this._cellCache.get(s);i==null&&(i=new Map,this._cellCache.set(s,i));for(let o=n.startColumn;o<=n.endColumn;o++)i.set(o,r)}}add(n){this._mergeData.push(n),this._clearCache(),this._createCache(this._mergeData)}remove(n,r){const s=this._getMergeDataIndex(n,r);s!==-1&&(this._mergeData.splice(s,1),this._clearCache(),this._createCache(this._mergeData))}getMergedCell(n,r){const s=this._getMergeDataIndex(n,r);return s!==-1?this._mergeData[s]:null}getMergeDataIndex(n,r){return this._getMergeDataIndex(n,r)}isRowContainsMergedCell(n){return this._hasAll||!Z.isEmptyObject(this._columnCache)?!0:this._mergeData.some(r=>r.startRow<=n&&n<=r.endRow)}isColumnContainsMergedCell(n){return this._hasAll||!Z.isEmptyObject(this._rowCache)?!0:this._mergeData.some(r=>r.startColumn<=n&&n<=r.endColumn)}getMergedCellRange(n,r,s,i){const o=[],a=`${n}-${r}-${s}-${i}`;if(this._rangeMap.has(a))return this._getRangeFromCache(a);let l=0;const c=[];for(const u of this._mergeData||[])on.intersects(u,{startRow:n,endRow:s,startColumn:r,endColumn:i})&&(o.push({...u}),c.push(l)),l++;return this._rangeMap.set(a,c),o}getMergedCellRangeForSkeleton(n,r,s,i){const o=[],a=this._mergeData,l=`${n}-${r}-${s}-${i}`;if(this._skeletonCache.has(l))return this._getSkeletonRangeFromCache(l);const c=[];for(let u=0;u<a.length;u++){const{startRow:h,endRow:d,startColumn:f,endColumn:g}=a[u];for(let _=n;_<=s;_++){let R=!1;for(let b=r;b<=i;b++)if(_>=h&&_<=d&&b>=f&&b<=g){o.push({startRow:h,endRow:d,startColumn:f,endColumn:g}),c.push(u),R=!0;break}if(R)break}}return this._skeletonCache.set(l,c),o}_getRangeFromCache(n){const r=this._rangeMap.get(n)||[],s=[];for(const i of r)s.push({...this._mergeData[i]});return s}_getSkeletonRangeFromCache(n){const r=this._skeletonCache.get(n)||[],s=[];for(const i of r)s.push({...this._mergeData[i]});return s}_getMergeDataIndex(n,r){var i;if(this._hasAll)return this._allIndex;if(this._hasRow){const o=this._rowCache.get(n);if(o!==void 0)return o}if(this._hasColumn){const o=this._columnCache.get(r);if(o!==void 0)return o}const s=(i=this._cellCache.get(n))==null?void 0:i.get(r);return s!==void 0?s:-1}getMergeDataSnapshot(){return this._mergeData}dispose(){this._clearCache(),this._mergeData=[]}}class qh extends Ke{constructor(n){super();p(this,"_cellContentInterceptor",null);p(this,"_rowFilteredInterceptor",null);this.getRawCell=n}dispose(){super.dispose(),this._cellContentInterceptor=null,this._rowFilteredInterceptor=null}getCell(n,r,s,i){return this._cellContentInterceptor?this._cellContentInterceptor.getCell(n,r,Pn.Value|Pn.Style,s,i):this.getRawCell(n,r)}getCellValueOnly(n,r){return this._cellContentInterceptor?this._cellContentInterceptor.getCell(n,r,Pn.Value):this.getRawCell(n,r)}getCellStyleOnly(n,r){return this._cellContentInterceptor?this._cellContentInterceptor.getCell(n,r,Pn.Style):this.getRawCell(n,r)}getRowFiltered(n){var r,s;return(s=(r=this._rowFilteredInterceptor)==null?void 0:r.getRowFiltered(n))!=null?s:!1}registerCellContentInterceptor(n){if(this._cellContentInterceptor)throw new Error("[SheetViewModel]: Interceptor already registered.");return this._cellContentInterceptor=n,We(()=>this._cellContentInterceptor=null)}registerRowFilteredInterceptor(n){if(this._rowFilteredInterceptor)throw new Error("[SheetViewModel]: Interceptor already registered.");return this._rowFilteredInterceptor=n,We(()=>this._rowFilteredInterceptor=null)}}const Ol={isDeepClone:!1,displayRawFormula:!1,ignoreTextRotation:!1};class xr{constructor(t,n,r){p(this,"_sheetId");p(this,"_snapshot");p(this,"_cellData");p(this,"_rowManager");p(this,"_columnManager");p(this,"_viewModel");p(this,"_spanModel");p(this,"_isRowStylePrecedeColumnStyle",!0);p(this,"_getCellHeight");var a;this.unitId=t,this._styles=r,this._snapshot=Xh(n);const{columnData:s,rowData:i,cellData:o}=this._snapshot;this._sheetId=(a=this._snapshot.id)!=null?a:tt(6),this._cellData=new dt(o),this._viewModel=new qh((l,c)=>this.getCellRaw(l,c)),this._rowManager=new AR(this._snapshot,this._viewModel,i),this._columnManager=new wR(this._snapshot,s),this._spanModel=new xR(this._snapshot.mergeData)}__interceptViewModel(t){t(this._viewModel)}__registerGetCellHeight(t){return this._getCellHeight=t,We(()=>{this._getCellHeight=null})}getSnapshot(){return this._snapshot}getCellHeight(t,n){return this._getCellHeight?this._getCellHeight(t,n):this._snapshot.defaultRowHeight}setMergeData(t){this._snapshot.mergeData=t,this.getSpanModel().rebuild(t)}getSpanModel(){return this._spanModel}setIsRowStylePrecedeColumnStyle(t){this._isRowStylePrecedeColumnStyle=t}getStyleDataByHash(t){return{...this._styles.get(t)}}setStyleData(t){return this._styles.setValue(t)}getColumnStyle(t,n=!1){return n?this._columnManager.getColumnStyle(t):this._styles.get(this._columnManager.getColumnStyle(t))}setColumnStyle(t,n){this._columnManager.setColumnStyle(t,n)}getRowStyle(t,n=!1){return n?this._rowManager.getRowStyle(t):this._styles.get(this._rowManager.getRowStyle(t))}setRowStyle(t,n){this._rowManager.setRowStyle(t,n)}getDefaultCellStyle(){return this._snapshot.defaultStyle}getDefaultCellStyleInternal(){const t=this._snapshot.defaultStyle;return this._styles.get(t)}setDefaultCellStyle(t){this._snapshot.defaultStyle=t}getCellStyle(t,n){const r=this.getCell(t,n);if(r){const s=r.s;return typeof s=="string"?this._styles.get(s):s}return null}getComposedCellStyle(t,n,r){const s=this.getDefaultCellStyleInternal(),i=this.getRowStyle(t),o=this.getColumnStyle(n),a=this.getCell(t,n),l=this._styles.getStyleByCell(a);return(r!=null?r:this._isRowStylePrecedeColumnStyle)?ar(s,o,i,a==null?void 0:a.themeStyle,l):ar(s,i,o,a==null?void 0:a.themeStyle,l)}getComposedCellStyleByCellData(t,n,r,s){const i=this.getDefaultCellStyleInternal(),o=this.getRowStyle(t),a=this.getColumnStyle(n),l=this._styles.getStyleByCell(r);return(s!=null?s:this._isRowStylePrecedeColumnStyle)?ar(i,a,o,r==null?void 0:r.themeStyle,l):ar(i,o,a,r==null?void 0:r.themeStyle,l)}getCellMatrix(){return this._cellData}getCellMatrixPrintRange(){const t=this.getCellMatrix(),n=this.getMergeData();let r=-1,s=-1,i=-1,o=-1,a=!1,l=!1;return t.forEach((c,u)=>{Object.keys(u).forEach(h=>{const d=+h,f=t.getValue(c,d),g=f!=null&&f.s?this._styles.get(f.s):null,_=(g==null?void 0:g.bd)&&(g.bd.b||g.bd.l||g.bd.r||g.bd.t||g.bd.bc_tr||g.bd.bl_tr||g.bd.ml_tr||g.bd.tl_bc||g.bd.tl_br||g.bd.tl_mr);(f&&(f.v!==null&&f.v!==void 0&&f.v!==""||f.p)||g!=null&&g.bg||_)&&(a?r=Math.min(r,c):(r=c,a=!0),s=Math.max(s,c),l?i=Math.min(i,d):(l=!0,i=d),o=Math.max(o,d))})}),n.forEach(c=>{a?r=Math.min(r,c.startRow):(r=c.startRow,a=!0),s=Math.max(s,c.endRow),l?i=Math.min(i,c.startColumn):(i=c.startColumn,a=!0),o=Math.max(o,c.endColumn)}),!a||!l?null:{startColumn:i,startRow:r,endColumn:o,endRow:s}}getRowManager(){return this._rowManager}getUnitId(){return this.unitId}getSheetId(){return this._sheetId}getColumnManager(){return this._columnManager}getName(){return this._snapshot.name}clone(){const{_snapshot:t}=this,n=Z.deepClone(t);return new xr(this.unitId,n,this._styles)}getMergeData(){return this._spanModel.getMergeDataSnapshot()}getMergedCell(t,n){return this._spanModel.getMergedCell(t,n)}getMergedCellRange(t,n,r,s){return this._spanModel.getMergedCellRange(t,n,r,s)}isRowContainsMergedCell(t){return this._spanModel.isRowContainsMergedCell(t)}isColumnContainsMergedCell(t){return this._spanModel.isColumnContainsMergedCell(t)}getCellInfoInMergeData(t,n){const r=this.getMergedCell(t,n);let s=!1,i=!1,o=t,a=n,l=t,c=n;if(r){const{startRow:u,endRow:h,startColumn:d,endColumn:f}=r;t===u&&n===d?(o=h,a=f,l=u,c=d,i=!0):t>=u&&t<=h&&n>=d&&n<=f&&(o=h,a=f,l=u,c=d,s=!0)}return{actualRow:t,actualColumn:n,isMergedMainCell:i,isMerged:s,endRow:o,endColumn:a,startRow:l,startColumn:c}}getCell(t,n){return t<0||n<0?null:this._viewModel.getCell(t,n)}getCellValueOnly(t,n){return t<0||n<0?null:this._viewModel.getCellValueOnly(t,n)}getCellStyleOnly(t,n){return t<0||n<0?null:this._viewModel.getCellStyleOnly(t,n)}getCellRaw(t,n){return this.getCellMatrix().getValue(t,n)}getCellWithFilteredInterceptors(t,n,r,s){return this._viewModel.getCell(t,n,r,s)}getRowFiltered(t){return this._viewModel.getRowFiltered(t)}getRangeFilterRows(t){const n=[];for(let r=t.startRow;r<=t.endRow;r++)this.getRowFiltered(r)&&n.push(r);return n}getMatrixWithMergedCells(t,n,r,s,i=Fn.Raw){const o=this.getCellMatrix(),a=this._spanModel.getMergedCellRange(t,n,r,s),l=new dt;return Vi(t,r,n,s).forEach((c,u)=>{var d;let h;if(i===Fn.Raw)h=this.getCellRaw(c,u);else if(i===Fn.Intercepted)h=this.getCell(c,u);else if(i===Fn.Both){const f=this.getCellRaw(c,u);if(f){h={...f};const g=(d=this.getCell(c,u))==null?void 0:d.v;Hh(g)&&h&&(h.displayV=String(g))}}h&&l.setValue(c,u,h)}),a.forEach(c=>{const{startColumn:u,startRow:h,endColumn:d,endRow:f}=c;Vi(h,f,u,d).forEach((g,_)=>{g===h&&_===u&&l.setValue(g,_,{...o.getValue(g,_),rowSpan:f-h+1,colSpan:d-u+1}),(g!==h||_!==u)&&l.realDeleteValue(g,_)})}),l}getRange(t,n,r,s){return typeof t=="object"?new Kn(this,t,{getStyles:()=>this._styles}):new Kn(this,{startRow:t,startColumn:n,endColumn:s||n,endRow:r||t},{getStyles:()=>this._styles})}getScrollLeftTopFromSnapshot(){return{scrollLeft:this._snapshot.scrollLeft,scrollTop:this._snapshot.scrollTop}}getZoomRatio(){return this._snapshot.zoomRatio||1}getConfig(){return this._snapshot}getFreeze(){return this._snapshot.freeze}getMaxColumns(){const{_snapshot:t}=this,{columnCount:n}=t;return n}getMaxRows(){const{_snapshot:t}=this,{rowCount:n}=t;return n}getRowCount(){return this._snapshot.rowCount}setRowCount(t){this._snapshot.rowCount=t}getColumnCount(){return this._snapshot.columnCount}setColumnCount(t){this._snapshot.columnCount=t}isSheetHidden(){return this._snapshot.hidden}hasHiddenGridlines(){const{_snapshot:t}=this,{showGridlines:n}=t;return n===0}getGridlinesColor(){return this.getConfig().gridlinesColor}getTabColor(){const{_snapshot:t}=this,{tabColor:n}=t;return n}getColumnWidth(t){return this.getColumnManager().getColumnWidth(t)}getRowHeight(t){return this._viewModel.getRowFiltered(t)?0:this.getRowManager().getRowHeight(t)}isRowFiltered(t){return this._viewModel.getRowFiltered(t)}getRowVisible(t){return!this.isRowFiltered(t)&&this.getRowRawVisible(t)}getRowRawVisible(t){return this.getRowManager().getRowRawVisible(t)}getHiddenRows(t,n){const r=this.getMaxColumns()-1,s=this._rowManager.getHiddenRows(t,n);return s.forEach(i=>i.endColumn=r),s}getColVisible(t){return this._columnManager.getColVisible(t)}getHiddenCols(t,n){const r=this.getMaxRows()-1,s=this._columnManager.getHiddenCols(t,n);return s.forEach(i=>i.endRow=r),s}getVisibleRows(){const t=this.getRowCount();return this._rowManager.getVisibleRows(0,t-1)}getVisibleCols(){const t=this.getColumnCount();return this._columnManager.getVisibleCols(0,t-1)}isRightToLeft(){const{_snapshot:t}=this,{rightToLeft:n}=t;return n}getLastRowWithContent(){return this._cellData.getLength()-1}getLastColumnWithContent(){return this._cellData.getRange().endColumn}getDataRangeScope(){return this._cellData.getStartEndScope()}cellHasValue(t){return t&&(t.v!==void 0||t.f!==void 0||t.p!==void 0)}iterateByRow(t,n=!0){const{startRow:r,startColumn:s,endRow:i,endColumn:o}=t,a=this;return{[Symbol.iterator]:()=>{let l=r,c=s;return{next(){for(;;){if(c>o&&(l+=1,c=s),l>i)return{done:!0,value:void 0};const u=a.getCell(l,c),h=!u,d=a.getMergedCell(l,c);if(d){if(l!==d.startRow||c!==d.startColumn){c=d.endColumn+1;continue}if(h&&n){c=d.endColumn+1;continue}const g={row:l,col:c,value:u};return g.colSpan=d.endColumn-d.startColumn+1,g.rowSpan=d.endRow-d.startRow+1,c=d.endColumn+1,{done:!1,value:g}}if(h&&n)c+=1;else{const f={row:l,col:c,value:u};return c+=1,{done:!1,value:f}}}}}}}}iterateByColumn(t,n=!0,r=!0){const{startRow:s,startColumn:i,endRow:o,endColumn:a}=t,l=this;return{[Symbol.iterator]:()=>{let c=s,u=i;return{next(){for(;;){if(c>o&&(u+=1,c=s),u>a)return{done:!0,value:void 0};const h=l.getMergedCell(c,u);if(h){const g=c!==h.startRow,_=g||u!==h.startColumn;if(r&&_||!r&&g){c=h.endRow+1;continue}const R=l.getCell(h.startRow,h.startColumn);if(!R&&n){c=h.endRow+1;continue}const F={row:c,col:h.startColumn,value:R};return F.colSpan=h.endColumn-h.startColumn+1,F.rowSpan=h.endRow-h.startRow+1,c=h.endRow+1,{done:!1,value:F}}const d=l.getCell(c,u);if(!d&&n)c+=1;else{const g={row:c,col:u,value:d};return c+=1,{done:!1,value:g}}}}}}}}getCellDocumentModel(t,n,r=Ol){var _;if(!t)return;const{isDeepClone:s,displayRawFormula:i,ignoreTextRotation:o}={...Ol,...r};let a,l="document";const c=SR(n),u=o?st.tr:c.textRotation||st.tr;let h=c.horizontalAlign||st.ht;const d=c.verticalAlign||st.vt,f=c.wrapStrategy||st.tb,g=c.paddingData||eo;if(t.f&&i)a=Sr(t.f.toString(),{},{verticalAlign:d}),h=st.ht;else if(t.p){const{centerAngle:R,vertexAngle:b}=jh(u);a=this._updateConfigAndGetDocumentModel(s?Z.deepClone(t.p):t.p,h,g,{horizontalAlign:h,verticalAlign:d,centerAngle:R,vertexAngle:b,wrapStrategy:f,zeroWidthParagraphBreak:1})}else if(t.v!=null){const R=Il(n);l=Sl(R).fontCache;let b=Zh(t);t.t===en.FORCE_STRING&&i&&(b=`'${b}`),a=Sr(b,R,{...c,textRotation:u,cellValueType:t.t})}return a&&t.linkUrl&&t.linkId&&$h(a,t.linkUrl,t.linkId),{documentModel:a,fontString:l,textRotation:u,wrapStrategy:f,verticalAlign:d,horizontalAlign:h,paddingData:g,fill:(_=n==null?void 0:n.bg)==null?void 0:_.rgb}}_updateConfigAndGetDocumentModel(t,n,r,s){var o,a,l,c,u;if(!s||!((o=t.body)!=null&&o.dataStream))return;t.documentStyle||(t.documentStyle={}),t.documentStyle.marginTop=(a=r.t)!=null?a:0,t.documentStyle.marginBottom=(l=r.b)!=null?l:2,t.documentStyle.marginLeft=(c=r.l)!=null?c:2,t.documentStyle.marginRight=(u=r.r)!=null?u:2,t.documentStyle.pageSize={width:Number.POSITIVE_INFINITY,height:Number.POSITIVE_INFINITY},t.documentStyle.renderConfig={...t.documentStyle.renderConfig,...s};const i=t.body.paragraphs||[];for(const h of i)h.paragraphStyle||(h.paragraphStyle={}),h.paragraphStyle.horizontalAlign=n;return new Nt(t)}getBlankCellDocumentModel(t,n,r){const s=this.getComposedCellStyleByCellData(n,r,t),i=Il(s),o=this.getCellDocumentModel(t,s,{ignoreTextRotation:!0});if(o!=null)return o.documentModel==null&&(o.documentModel=Sr("",i)),o;const a="";let l="document";const c=st.tr,u=st.ht,h=st.vt,d=st.tb,f=eo;return l=Sl({}).fontCache,{documentModel:Sr(a,i),fontString:l,textRotation:c,wrapStrategy:d,verticalAlign:h,horizontalAlign:u,paddingData:f}}getCellDocumentModelWithFormula(t,n,r){const s=this.getComposedCellStyleByCellData(n,r,t);return this.getCellDocumentModel(t,s,{isDeepClone:!0,displayRawFormula:!0,ignoreTextRotation:!0})}getCustomMetadata(){return this._snapshot.custom}setCustomMetadata(t){this._snapshot.custom=t}}function Zh(e){var r,s;if(!e)return"";const t=(s=(r=e.p)==null?void 0:r.body)==null?void 0:s.dataStream;if(t)return Qe.transform.getPlainText(t);const n=e.v;return typeof n=="string"?e.t===en.BOOLEAN?n.toUpperCase():n.replace(/[\r\n]/g,""):typeof n=="number"?e.t===en.BOOLEAN?n?"TRUE":"FALSE":n.toString():typeof n=="boolean"?n?"TRUE":"FALSE":""}function UR(e){if(e===null)return"";if(e!=null&&e.p){const t=e==null?void 0:e.p.body;if(t==null)return"";const n=t.dataStream;return Qe.transform.getPlainText(n)}return e==null?void 0:e.v}var PR=Object.getOwnPropertyDescriptor,kR=(e,t,n,r)=>{for(var s=r>1?void 0:r?PR(t,n):t,i=e.length-1,o;i>=0;i--)(o=e[i])&&(s=o(s)||s);return s},FR=(e,t)=>(n,r)=>t(n,r,e);function BR(e,t){return`${e.getUnitId()}|${t.getSheetId()}`}exports.Workbook=class extends Ws{constructor(n={},r){super();p(this,"type",Oe.UNIVER_SHEET);p(this,"_sheetCreated$",new ce.Subject);p(this,"sheetCreated$",this._sheetCreated$.asObservable());p(this,"_sheetDisposed$",new ce.Subject);p(this,"sheetDisposed$",this._sheetDisposed$.asObservable());p(this,"_activeSheet$",new ce.BehaviorSubject(null));p(this,"activeSheet$",this._activeSheet$.asObservable());p(this,"_worksheets");p(this,"_styles");p(this,"_snapshot");p(this,"_unitId");p(this,"_count");p(this,"_name$");p(this,"name$");this._logService=r;const s=ER();Z.isEmptyObject(n)?this._snapshot=s:this._snapshot=Z.commonExtend(s,n);const{styles:i}=this._snapshot;(this._snapshot.id==null||this._snapshot.id.length===0)&&(this._snapshot.id=tt(6)),this._unitId=this._snapshot.id,this._styles=new Bh(i),this._count=1,this._worksheets=new Map,this._name$=new ce.BehaviorSubject(n.name||""),this.name$=this._name$.asObservable(),this._parseWorksheetSnapshots()}get _activeSheet(){return this._activeSheet$.getValue()}get name(){return this._name$.getValue()}static isIRangeType(n){return typeof n=="string"||"startRow"in n||"row"in n}dispose(){super.dispose(),this._sheetCreated$.complete(),this._sheetDisposed$.complete(),this._activeSheet$.complete(),this._name$.complete()}save(){return Z.deepClone(this._snapshot)}getSnapshot(){return this._snapshot}getName(){return this._snapshot.name}setName(n){this._name$.next(n),this._snapshot.name=n}getUnitId(){return this._unitId}getRev(){var n;return(n=this._snapshot.rev)!=null?n:1}incrementRev(){this._snapshot.rev=this.getRev()+1}setRev(n){this._snapshot.rev=n}addWorksheet(n,r,s){const{sheets:i,sheetOrder:o}=this._snapshot;if(i[n])return!1;i[n]=s,o.splice(r,0,n);const a=new xr(this._unitId,s,this._styles);return this._worksheets.set(n,a),this._sheetCreated$.next(a),!0}getSheetOrders(){return this._snapshot.sheetOrder}getWorksheets(){return this._worksheets}getActiveSpreadsheet(){return this}getStyles(){return this._styles}addStyles(n){Object.entries(n).forEach(([r,s])=>{this._styles.addCustomStyle(r,s)})}removeStyles(n){n.forEach(r=>{this._styles.remove(r)})}getConfig(){return this._snapshot}getIndexBySheetId(n){const{sheetOrder:r}=this._snapshot;return r.findIndex(s=>s===n)}getActiveSheet(n){if(!this._activeSheet&&typeof n>"u")throw new Error(`[Workbook]: no active Worksheet on Workbook ${this._unitId}!`);return this._activeSheet}ensureActiveSheet(){const n=this._activeSheet;if(n)return n;const r=this._snapshot.sheetOrder;for(let i=0,o=r.length;i<o;i++){const a=this._worksheets.get(r[i]);if(a&&a.isSheetHidden()!==ie.TRUE)return this.setActiveSheet(a),a}const s=this._worksheets.get(r[0]);return this.setActiveSheet(s),s}setActiveSheet(n){this._activeSheet$.next(n)}removeSheet(n){const r=this._worksheets.get(n);return r?(this._worksheets.delete(n),this._snapshot.sheetOrder.splice(this._snapshot.sheetOrder.indexOf(n),1),delete this._snapshot.sheets[n],this._sheetDisposed$.next(r),!0):!1}getActiveSheetIndex(){const{sheetOrder:n}=this._snapshot;return n.findIndex(r=>this._worksheets.get(r)===this._activeSheet)}getSheetSize(){return this._snapshot.sheetOrder.length}getSheets(){const{sheetOrder:n}=this._snapshot;return n.map(r=>this._worksheets.get(r))}getSheetsName(){const{sheetOrder:n}=this._snapshot,r=[];return n.forEach(s=>{const i=this._worksheets.get(s);i&&r.push(i.getName())}),r}getSheetIndex(n){const{sheetOrder:r}=this._snapshot;return r.findIndex(s=>n.getSheetId()===s)}getSheetBySheetName(n){const{sheetOrder:r}=this._snapshot,s=r.find(i=>this._worksheets.get(i).getName()===n);return this._worksheets.get(s)}getSheetBySheetId(n){return this._worksheets.get(n)}getSheetByIndex(n){const{sheetOrder:r}=this._snapshot;return this._worksheets.get(r[n])}getHiddenWorksheets(){return this.getSheets().filter(n=>n.getConfig().hidden===ie.TRUE).map(n=>n.getConfig().id)}getUnhiddenWorksheets(){return this.getSheets().filter(n=>n.getConfig().hidden!==ie.TRUE).map(n=>n.getConfig().id)}load(n){this._snapshot=n}checkSheetName(n){return this.getSheetsName().includes(n)}uniqueSheetName(n="Sheet1"){let r=n;for(;this.checkSheetName(r);)r=n+this._count,this._count++;return r}generateNewSheetName(n){let r=n+this._count;for(;this.checkSheetName(r);)r=n+this._count,this._count++;return r}_parseWorksheetSnapshots(){const{_snapshot:n,_worksheets:r}=this,{sheets:s,sheetOrder:i}=n;if(Z.isEmptyObject(s)){const o=tt();s[o]={id:o}}for(const o in s){const a=s[o],{name:l}=a;a.name=this.uniqueSheetName(l),a.name!==l&&this._logService.debug("[Workbook]",`The worksheet name ${l} is duplicated, we changed it to ${a.name}. Please fix the problem in your snapshot.`);const c=new xr(this._unitId,a,this._styles);r.set(o,c),i.includes(o)||i.push(o)}this.ensureActiveSheet()}getCustomMetadata(){return this._snapshot.custom}setCustomMetadata(n){this._snapshot.custom=n}};exports.Workbook=kR([FR(1,Ct)],exports.Workbook);class ca extends Ws{constructor(n){var r;super();p(this,"type",Oe.UNIVER_SLIDE);p(this,"_activePage$",new ce.BehaviorSubject(null));p(this,"activePage$",this._activePage$.asObservable());p(this,"_name$");p(this,"name$");p(this,"_snapshot");p(this,"_unitId");this._snapshot={...eh,...n},this._unitId=(r=this._snapshot.id)!=null?r:tt(6),this._name$=new ce.BehaviorSubject(this._snapshot.title),this.name$=this._name$.asObservable()}get _activePage(){var r,s;const n=this._activePage$.getValue();if(!n){const i=(r=this.getPageOrder())==null?void 0:r[0];return i?(s=this.getPages())==null?void 0:s[i]:null}return n}setName(n){var r;this._snapshot.title=n,this._name$.next(n),this._unitId=(r=this._snapshot.id)!=null?r:tt(6)}getRev(){return 0}incrementRev(){}setRev(n){}getSnapshot(){return this._snapshot}getUnitId(){return this._unitId}getPages(){var n;return(n=this._snapshot.body)==null?void 0:n.pages}getPageOrder(){var n;return(n=this._snapshot.body)==null?void 0:n.pageOrder}getPage(n){const r=this.getPages();return r==null?void 0:r[n]}getElementsByPage(n){var r;return(r=this.getPage(n))==null?void 0:r.pageElements}getElement(n,r){var s;return(s=this.getElementsByPage(n))==null?void 0:s[r]}getPageSize(){return this._snapshot.pageSize}getBlankPage(){const n=tt(6);return{id:n,pageType:Co.SLIDE,zIndex:10,title:n,description:"",pageBackgroundFill:{rgb:"rgb(255,255,255)"},pageElements:{}}}setActivePage(n){this._activePage$.next(n)}getActivePage(){return this._activePage}updatePage(n,r){this._snapshot.body&&(this._snapshot.body.pages[n]=r)}appendPage(n){var i;if(!this._snapshot.body)return;this._snapshot.body.pages[n.id]=n;const r=this._activePage,s=this._snapshot.body.pageOrder.indexOf((i=r==null?void 0:r.id)!=null?i:"");this._snapshot.body.pageOrder.splice(s+1,0,n.id)}}var $R=Object.getOwnPropertyDescriptor,HR=(e,t,n,r)=>{for(var s=r>1?void 0:r?$R(t,n):t,i=e.length-1,o;i>=0;i--)(o=e[i])&&(s=o(s)||s);return s},vl=(e,t)=>(n,r)=>t(n,r,e);const Xn=Ae.createIdentifier("univer.current");exports.UniverInstanceService=class extends Ke{constructor(n,r){super();p(this,"_unitsByType",new Map);p(this,"_createHandler");p(this,"_ctorByType",new Map);p(this,"_currentUnits",new Map);p(this,"_currentUnits$",new ce.BehaviorSubject(this._currentUnits));p(this,"currentUnits$",this._currentUnits$.asObservable());p(this,"_unitAdded$",new ce.Subject);p(this,"unitAdded$",this._unitAdded$.asObservable());p(this,"_unitDisposed$",new ce.Subject);p(this,"unitDisposed$",this._unitDisposed$.asObservable());p(this,"_focused$",new ce.BehaviorSubject(null));p(this,"focused$",this._focused$.asObservable());this._injector=n,this._contextService=r}dispose(){super.dispose(),this._focused$.complete(),this._currentUnits$.complete(),this._unitAdded$.complete(),this._currentUnits.clear(),this._unitsByType.clear()}__setCreateHandler(n){this._createHandler=n}createUnit(n,r,s){return this._createHandler(n,r,this._ctorByType.get(n),s)}registerCtorForType(n,r){return this._ctorByType.set(n,r),{dispose:()=>{this._ctorByType.delete(n)}}}getCurrentTypeOfUnit$(n){return this.currentUnits$.pipe(ce.map(r=>{var s;return(s=r.get(n))!=null?s:null}),ce.distinctUntilChanged())}getCurrentUnitForType(n){return this._currentUnits.get(n)}getCurrentUnitOfType(n){return this.getCurrentUnitForType(n)}setCurrentUnitForType(n){const r=this._getUnitById(n);if(!r)throw new Error(`[UniverInstanceService]: no document with unitId ${n}!`);this._currentUnits.set(r[1],r[0]),this._currentUnits$.next(this._currentUnits)}getTypeOfUnitAdded$(n){return this._unitAdded$.pipe(ce.filter(r=>r.type===n))}__addUnit(n,r){var a;const s=n.type;this._unitsByType.has(s)||this._unitsByType.set(s,[]);const i=this._unitsByType.get(s),o=n.getUnitId();if(i.findIndex(l=>l.getUnitId()===o)!==-1)throw new Error(`[UniverInstanceService]: cannot create a unit with the same unit id: ${o}.`);i.push(n),this._unitAdded$.next(n),((a=r==null?void 0:r.makeCurrent)==null||a)&&this.setCurrentUnitForType(n.getUnitId())}getTypeOfUnitDisposed$(n){return this.unitDisposed$.pipe(ce.filter(r=>r.type===n))}getUnit(n,r){var i;const s=(i=this._getUnitById(n))==null?void 0:i[0];return r&&(s==null?void 0:s.type)!==r?null:s}getCurrentUniverDocInstance(){return this.getCurrentUnitForType(Oe.UNIVER_DOC)}getUniverDocInstance(n){return this.getUnit(n,Oe.UNIVER_DOC)}getUniverSheetInstance(n){return this.getUnit(n,Oe.UNIVER_SHEET)}getAllUnitsForType(n){var r;return(r=this._unitsByType.get(n))!=null?r:[]}changeDoc(n,r){const s=this.getAllUnitsForType(Oe.UNIVER_DOC),i=s.find(o=>o.getUnitId()===n);if(i!=null){const o=s.indexOf(i);s.splice(o,1)}this.__addUnit(r)}get focused(){var r;const n=this._focused$.getValue();return n?(r=this._getUnitById(n))==null?void 0:r[0]:null}focusUnit(n){this._focused$.next(n),this.focused instanceof exports.Workbook?(this._contextService.setContextValue(Cr,!0),this._contextService.setContextValue(Rr,!1),this._contextService.setContextValue(Hn,!0),this._contextService.setContextValue(Ir,!1),this.setCurrentUnitForType(n)):this.focused instanceof Nt?(this._contextService.setContextValue(Cr,!0),this._contextService.setContextValue(Rr,!0),this._contextService.setContextValue(Hn,!1),this._contextService.setContextValue(Ir,!1),this.setCurrentUnitForType(n)):this.focused instanceof ca?(this._contextService.setContextValue(Cr,!0),this._contextService.setContextValue(Rr,!1),this._contextService.setContextValue(Hn,!1),this._contextService.setContextValue(Ir,!0),this.setCurrentUnitForType(n)):(this._contextService.setContextValue(Cr,!1),this._contextService.setContextValue(Rr,!1),this._contextService.setContextValue(Hn,!1),this._contextService.setContextValue(Ir,!1))}getFocusedUnit(){return this.focused}getUnitType(n){const r=this._getUnitById(n);return r?r[1]:Oe.UNRECOGNIZED}disposeUnit(n){const r=this._getUnitById(n);if(!r)return!1;const[s,i]=r,o=this._unitsByType.get(i),a=o.indexOf(s);return o.splice(a,1),this._tryResetCurrentOnRemoval(n,i),this._tryResetFocusOnRemoval(n),this._unitDisposed$.next(s),!0}_tryResetCurrentOnRemoval(n,r){const s=this.getCurrentUnitForType(r);(s==null?void 0:s.getUnitId())===n&&(this._currentUnits.set(r,null),this._currentUnits$.next(this._currentUnits))}_tryResetFocusOnRemoval(n){var r;((r=this.focused)==null?void 0:r.getUnitId())===n&&this._focused$.next(null)}_getUnitById(n){for(const[r,s]of this._unitsByType){const i=s.find(o=>o.getUnitId()===n);if(i)return[i,r]}}};exports.UniverInstanceService=HR([vl(0,Ae.Inject(Ae.Injector)),vl(1,Jn)],exports.UniverInstanceService);var Ue=(e=>(e[e.Starting=0]="Starting",e[e.Ready=1]="Ready",e[e.Rendered=2]="Rendered",e[e.Steady=3]="Steady",e))(Ue||{});const Jh={0:"Starting",1:"Ready",2:"Rendered",3:"Steady"};var jR=Object.getOwnPropertyDescriptor,WR=(e,t,n,r)=>{for(var s=r>1?void 0:r?jR(t,n):t,i=e.length-1,o;i>=0;i--)(o=e[i])&&(s=o(s)||s);return s},YR=(e,t)=>(n,r)=>t(n,r,e);class Qh extends Error{constructor(t){super(`[LifecycleService]: lifecycle stage "${Jh[t]}" will never be reached!`),this.name="LifecycleUnreachableError"}}exports.LifecycleService=class extends Ke{constructor(n){super();p(this,"_lifecycle$",new ce.BehaviorSubject(Ue.Starting));p(this,"lifecycle$",this._lifecycle$.asObservable());p(this,"_lock",!1);this._logService=n,this._reportProgress(Ue.Starting)}get stage(){return this._lifecycle$.getValue()}set stage(n){if(this._lock)throw new Error("[LifecycleService]: cannot set new stage when related logic is all handled!");if(n<this.stage)throw new Error("[LifecycleService]: lifecycle stage cannot go backward!");n!==this.stage&&(this._lock=!0,this._reportProgress(n),this._lifecycle$.next(n),this._lock=!1)}dispose(){this._lifecycle$.complete(),super.dispose()}onStage(n){return ce.firstValueFrom(this.lifecycle$.pipe(ce.filter(r=>r>=n),Di(r=>r===n),ce.map(()=>{}))).catch(r=>r.name==="EmptyError"?Promise.reject(new Qh(n)):Promise.reject(r))}subscribeWithPrevious(){return ce.merge(ed(this.stage),this._lifecycle$.pipe(ce.skip(1))).pipe(Di(n=>n===Ue.Steady))}_reportProgress(n){this._logService.debug("[LifecycleService]",`lifecycle progressed to "${Jh[n]}".`)}};exports.LifecycleService=WR([YR(0,Ct)],exports.LifecycleService);function ed(e){switch(e){case Ue.Starting:return ce.of(Ue.Starting);case Ue.Ready:return ce.of(Ue.Starting,Ue.Ready);case Ue.Rendered:return ce.of(Ue.Starting,Ue.Ready,Ue.Rendered);default:return ce.of(Ue.Starting,Ue.Ready,Ue.Rendered,Ue.Steady)}}const GR=Ae.createIdentifier("ILocalStorageService");class Cn extends Ke{constructor(){super();p(this,"_currentLocale$",new ce.BehaviorSubject(Fr.ZH_CN));p(this,"currentLocale$",this._currentLocale$.asObservable());p(this,"_locales",null);p(this,"localeChanged$",new ce.Subject);p(this,"t",(n,...r)=>{if(!this._locales)throw new Error("[LocaleService]: Locale not initialized");const s=n.split("."),i=this.resolveKeyPath(this._locales[this._currentLocale],s);if(typeof i=="string"){let o=i;return r.forEach((a,l)=>{o=o.replace(`{${l}}`,a)}),o}else return n});this.disposeWithMe(We(()=>{this._locales=null,this._currentLocale$.complete(),this.localeChanged$.complete()}))}get _currentLocale(){return this._currentLocale$.value}load(n){var r;this._locales=Hs((r=this._locales)!=null?r:{},n)}setLocale(n){this._currentLocale$.next(n),this.localeChanged$.next()}getLocales(){var n;return(n=this._locales)==null?void 0:n[this._currentLocale]}getCurrentLocale(){return this._currentLocale}resolveKeyPath(n,r){const s=r.shift();if(s&&n&&s in n){const i=n[s];return r.length>0&&(typeof i=="object"||Array.isArray(i))?this.resolveKeyPath(i,r):i}return null}}var VR=Object.getOwnPropertyDescriptor,zR=(e,t,n,r)=>{for(var s=r>1?void 0:r?VR(t,n):t,i=e.length-1,o;i>=0;i--)(o=e[i])&&(s=o(s)||s);return s},KR=(e,t)=>(n,r)=>t(n,r,e);exports.MentionIOLocalService=class{constructor(t){this._userManagerService=t}async list(t){return{list:[{type:ws.PERSON,mentions:[{objectType:ws.PERSON,objectId:this._userManagerService.getCurrentUser().userID,label:this._userManagerService.getCurrentUser().name,metadata:{icon:this._userManagerService.getCurrentUser().avatar}}],metadata:{},title:"PEOPLE"}],page:t.page,size:t.size,total:1}}};exports.MentionIOLocalService=zR([KR(0,Ae.Inject(Dr))],exports.MentionIOLocalService);const td=Ae.createIdentifier("univer.service.mention-io");var ua=(e=>(e.INIT="init",e.FETCHING="fetching",e.DONE="done",e))(ua||{});const nd=Ae.createIdentifier("univer.permission-service");class rd extends Ke{constructor(){super(...arguments);p(this,"_permissionPointMap",new Map);p(this,"_permissionPointUpdate$",new ce.Subject);p(this,"permissionPointUpdate$",this._permissionPointUpdate$.asObservable());p(this,"_showComponents",!0)}setShowComponents(n){this._showComponents=n}getShowComponents(){return this._showComponents}deletePermissionPoint(n){const r=this._permissionPointMap.get(n);r&&(r.complete(),this._permissionPointMap.delete(n))}addPermissionPoint(n){const r=n instanceof ce.BehaviorSubject,s=r?n.getValue():n;return s.id?this._permissionPointMap.get(s.id)?(console.warn(`${s.id} PermissionPoint already exists`),!1):(this._permissionPointMap.set(s.id,r?n:new ce.BehaviorSubject(s)),this._permissionPointUpdate$.next(s),!0):!1}updatePermissionPoint(n,r){const s=this._permissionPointMap.get(n);if(!s)return;const i=s.getValue();i.value=r,i.status=ua.DONE,s.next(i),this._permissionPointUpdate$.next(i)}clearPermissionMap(){this._permissionPointMap.clear()}getPermissionPoint(n){const r=this._permissionPointMap.get(n);if(r)return r.getValue()}getPermissionPoint$(n){const r=this._permissionPointMap.get(n);if(r)return r}composePermission$(n){const r=n.map(s=>{var o;const i=(o=this._permissionPointMap)==null?void 0:o.get(s);if(!i)throw new Error(`[PermissionService]: ${s} permissionPoint does not exist!`);return i.asObservable()});return ce.combineLatest(r).pipe(ls.map(s=>s))}composePermission(n){return n.map(s=>{var o;const i=(o=this._permissionPointMap)==null?void 0:o.get(s);if(!i)throw new Error(`[PermissionService]: ${s} permissionPoint does not exist!`);return i.getValue()})}getAllPermissionPoint(){const n=new Map;return this._permissionPointMap.forEach((r,s)=>{n.set(s,r)}),n}}function sd(e,t){if(!t)return e;const n=[];for(const r of e){const s=t.find(([i])=>i===r[0]);if(s){if(s[1]===null)continue;n.push([r[0],s[1]])}else n.push(r)}return n}var XR=Object.getOwnPropertyDescriptor,qR=(e,t,n,r)=>{for(var s=r>1?void 0:r?XR(t,n):t,i=e.length-1,o;i>=0;i--)(o=e[i])&&(s=o(s)||s);return s},vi=(e,t)=>(n,r)=>t(n,r,e);const ZR=4,id=Symbol("DependentOn");class to extends Ke{onStarting(){}onReady(){}onRendered(){}onSteady(){}getUnitType(){return this.constructor.type}getPluginName(){return this.constructor.pluginName}}p(to,"pluginName"),p(to,"type",Oe.UNIVER_UNKNOWN);class JR{constructor(){p(this,"_plugins",[])}addPlugin(t){this._plugins.push(t)}removePlugins(){const t=this._plugins.slice();return this._plugins.length=0,t}forEachPlugin(t){this._plugins.forEach(t)}}function QR(...e){return function(t){t[id]=e}}exports.PluginService=class{constructor(t,n,r){p(this,"_pluginRegistry",new Map);p(this,"_pluginStore",new JR);p(this,"_seenPlugins",new Set);p(this,"_loadedPlugins",new Set);p(this,"_loadedPluginTypes",new Set([Oe.UNIVER_UNKNOWN]));p(this,"_flushTimerByType",new Map);this._injector=t,this._lifecycleService=n,this._logService=r}dispose(){this._pluginStore.removePlugins().forEach(t=>t.dispose()),this._flushTimerByType.forEach(t=>clearTimeout(t))}registerPlugin(t,n){this._assertPluginValid(t);const r={plugin:t,options:n};this._pluginRegistry.set(t.pluginName,r),this._logService.debug("[PluginService]",`Plugin "${t.pluginName}" registered.`);const{type:s}=t;this._loadedPluginTypes.has(s)&&(s===Oe.UNIVER_UNKNOWN?this._loadFromPlugins([r]):this._flushType(s))}startPluginsForType(t){this._loadedPluginTypes.has(t)||this._loadPluginsForType(t)}_loadPluginsForType(t){const n=Array.from(this._pluginRegistry.keys()),r=[];n.forEach(s=>{const i=this._pluginRegistry.get(s);i.plugin.type===t&&r.push(i)}),this._loadFromPlugins(r),this._loadedPluginTypes.add(t)}_assertPluginValid(t){const{type:n,pluginName:r}=t;if(n===Oe.UNRECOGNIZED)throw new Error(`[PluginService]: invalid plugin type for ${t.name}. Please assign a "type" to your plugin.`);if(!r)throw new Error(`[PluginService]: no plugin name for ${t.name}. Please assign a "pluginName" to your plugin.`);if(this._seenPlugins.has(r))throw new Error(`[PluginService]: duplicated plugin name for "${r}". Maybe a plugin that dependents on "${r} has already registered it. In that case please register "${r}" before the that plugin.`);this._seenPlugins.add(t.pluginName)}_flushType(t){this._flushTimerByType.get(t)===void 0&&this._flushTimerByType.set(t,setTimeout(()=>{this._loadPluginsForType(t),this._flushTimerByType.delete(t)},ZR))}_loadFromPlugins(t){const n=[],r=new Set,s=o=>{const{plugin:a}=o,{pluginName:l}=a;if(this._loadedPlugins.has(l)||r.has(l))return;r.add(l),this._pluginRegistry.delete(l);const c=a[id];c&&c.forEach(u=>{const h=this._pluginRegistry.get(u.pluginName);if(h)s(h);else if(!this._seenPlugins.has(u.pluginName)&&!r.has(u.pluginName)){if(a.type===Oe.UNIVER_UNKNOWN&&u.type!==Oe.UNIVER_UNKNOWN)throw new Error(`[PluginService]: cannot register a plugin with Univer type that depends on a plugin with other type. The dependent is ${a.pluginName} and the dependency is ${u.pluginName}.`);a.type!==u.type&&u.type!==Oe.UNIVER_UNKNOWN&&this._logService.debug("[PluginService]",`Plugin "${l}" depends on "${u.pluginName}" which has different type.`),this._logService.debug("[PluginService]",`Plugin "${l}" depends on "${u.pluginName}" which is not registered. Univer will automatically register it with default configuration.`),this._assertPluginValid(u),s({plugin:u,options:void 0})}}),n.push(o)};t.forEach(o=>s(o));const i=n.map(o=>this._initPlugin(o.plugin,o.options));this._pluginsRunLifecycle(i)}_pluginsRunLifecycle(t){const n=this._lifecycleService.stage;if(ed(n).subscribe(r=>this._runStage(t,r)),n!==Ue.Steady){const r=this._lifecycleService.lifecycle$.pipe(ce.skip(1)).subscribe(s=>{this._runStage(t,s),s===Ue.Steady&&r.unsubscribe()})}}_runStage(t,n){t.forEach(r=>{switch(n){case Ue.Starting:r.onStarting();break;case Ue.Ready:r.onReady();break;case Ue.Rendered:r.onRendered();break;case Ue.Steady:r.onSteady();break}})}_initPlugin(t,n){const r=this._injector.createInstance(t,n);return this._pluginStore.addPlugin(r),this._loadedPlugins.add(t.pluginName),this._logService.debug("[PluginService]",`Plugin "${r.getPluginName()}" loaded.`),r}};exports.PluginService=qR([vi(0,Ae.Inject(Ae.Injector)),vi(1,Ae.Inject(exports.LifecycleService)),vi(2,Ct)],exports.PluginService);const no=Ae.createIdentifier("resource-loader-service");var eI=Object.getOwnPropertyDescriptor,tI=(e,t,n,r)=>{for(var s=r>1?void 0:r?eI(t,n):t,i=e.length-1,o;i>=0;i--)(o=e[i])&&(s=o(s)||s);return s},nI=(e,t)=>(n,r)=>t(n,r,e);exports.ResourceManagerService=class extends Ke{constructor(n){super();p(this,"_resourceMap",new Map);p(this,"_register$",new ce.Subject);p(this,"register$",this._register$.asObservable());this._logService=n}getAllResourceHooks(){return[...this._resourceMap.values()]}getResources(n,r){return r?this.getResourcesByType(n,r):this.getAllResourceHooks().map(o=>{const a=o.toJson(n);return{name:o.pluginName,data:a}})}getResourcesByType(n,r){return this.getAllResourceHooks().filter(o=>o.businesses.includes(r)).map(o=>{const a=o.toJson(n);return{name:o.pluginName,data:a}})}registerPluginResource(n){const r=n.pluginName;if(this._resourceMap.has(r))throw new Error(`the pluginName is registered {${r}}`);return this._resourceMap.set(r,n),this._register$.next(n),We(()=>this._resourceMap.delete(r))}disposePluginResource(n){this._resourceMap.delete(n)}loadResources(n,r){this.getAllResourceHooks().forEach(s=>{var o;const i=(o=r==null?void 0:r.find(a=>a.name===s.pluginName))==null?void 0:o.data;if(i)try{const a=s.parseJson(i);s.onLoad(n,a)}catch(a){this._logService.error("[ResourceManagerService]","loadResources error",a)}})}unloadResources(n,r){this.getAllResourceHooks().filter(s=>s.businesses.includes(r)).forEach(s=>{s.onUnLoad(n)})}dispose(){this._register$.complete(),this._resourceMap.clear()}};exports.ResourceManagerService=tI([nI(0,Ct)],exports.ResourceManagerService);class Ps extends Ke{constructor(){super();p(this,"_darkMode$",new ce.BehaviorSubject(!1));p(this,"darkMode$",this._darkMode$.asObservable());p(this,"_validColorCache",new Map);p(this,"_currentTheme",Kr.defaultTheme);p(this,"_currentTheme$",new ce.BehaviorSubject(this._currentTheme));p(this,"currentTheme$",this._currentTheme$.asObservable());this.disposeWithMe(We(()=>{this._currentTheme=Kr.defaultTheme,this._currentTheme$.complete(),this._darkMode$.complete()}))}get darkMode(){return this._darkMode$.getValue()}isValidThemeColor(n){if(this._validColorCache.has(n))return this._validColorCache.get(n);let r=!1;const s=n.split(".");if(s.length===1)r=n in Kr.defaultTheme;else if(s.length===2){const[i,o]=s;r=i in Kr.defaultTheme&&o in this._currentTheme[i]}return this._validColorCache.set(n,r),r}getCurrentTheme(){return this._currentTheme}setTheme(n){this._currentTheme=n,this._currentTheme$.next(n)}setDarkMode(n){this._darkMode$.next(n)}getColorFromTheme(n){return rc(this._currentTheme,n)}}var rI=Object.getOwnPropertyDescriptor,sI=(e,t,n,r)=>{for(var s=r>1?void 0:r?rI(t,n):t,i=e.length-1,o;i>=0;i--)(o=e[i])&&(s=o(s)||s);return s},wi=(e,t)=>(n,r)=>t(n,r,e);const ei=Ae.createIdentifier("univer.undo-redo.service"),iI=20;class od{dispose(){}async dispatchToHandlers(){return!1}}const ad="univer.command.redo",ld="univer.command.undo",cd=new class extends od{constructor(){super(...arguments);p(this,"type",$r.COMMAND);p(this,"id",ld)}handler(t){const n=t.get(ei),r=n.pitchTopUndoElement();if(!r)return!1;const s=t.get(Hr);return Gs(r.undoMutations,s)?(n.popUndoToRedo(),!0):!1}},ud=new class extends od{constructor(){super(...arguments);p(this,"type",$r.COMMAND);p(this,"id",ad)}handler(t){const n=t.get(ei),r=n.pitchTopRedoElement();if(!r)return!1;const s=t.get(Hr);return Gs(r.redoMutations,s)?(n.popRedoToUndo(),!0):!1}};exports.LocalUndoRedoService=class extends Ke{constructor(n,r,s){super();p(this,"undoRedoStatus$");p(this,"_undoRedoStatus$",new ce.BehaviorSubject({undos:0,redos:0}));p(this,"_undoStacks",new Map);p(this,"_redoStacks",new Map);p(this,"_batchingStatus",new Map);this._univerInstanceService=n,this._commandService=r,this._contextService=s,this.undoRedoStatus$=this._undoRedoStatus$.asObservable(),this.disposeWithMe(this._commandService.registerCommand(cd)),this.disposeWithMe(this._commandService.registerCommand(ud)),this.disposeWithMe(We(()=>this._undoRedoStatus$.complete())),this.disposeWithMe(We(this._univerInstanceService.focused$.subscribe(()=>this._updateStatus())))}pushUndoRedo(n){const{unitID:r}=n,s=this._getRedoStack(r,!0),i=this._getUndoStack(r,!0);if(s.length=0,this._batchingStatus.has(n.unitID)){const a=this._batchingStatus.get(n.unitID),l=this._pitchUndoElement(n.unitID);a===0||!l?(o(n),this._batchingStatus.set(n.unitID,1)):this._tryBatchingElements(l,n)}else o(n);function o(a){i.push(a),i.length>iI&&i.splice(0,1)}this._updateStatus()}clearUndoRedo(n){const r=this._getRedoStack(n);r&&(r.length=0);const s=this._getUndoStack(n);s&&(s.length=0),this._updateStatus()}pitchTopUndoElement(){const n=this._getFocusedUnitId();return this._pitchUndoElement(n)}pitchTopRedoElement(){const n=this._getFocusedUnitId();return this._pitchRedoElement(n)}_pitchUndoElement(n){const r=this._getUndoStack(n);return r!=null&&r.length?r[r.length-1]:null}_pitchRedoElement(n){const r=this._getRedoStack(n);return r!=null&&r.length?r[r.length-1]:null}popUndoToRedo(){const r=this._getUndoStackForFocused().pop();r&&(this._getRedoStackForFocused().push(r),this._updateStatus())}popRedoToUndo(){const r=this._getRedoStackForFocused().pop();r&&(this._getUndoStackForFocused().push(r),this._updateStatus())}rollback(n,r){const s=r||this._getFocusedUnitId(),i=this._getUndoStack(s),o=i==null?void 0:i[(i==null?void 0:i.length)-1];o&&o.id===n&&(i.pop(),Gs(o.undoMutations,this._commandService))}__tempBatchingUndoRedo(n){if(this._batchingStatus.has(n))throw new Error("[LocalUndoRedoService]: cannot batching undo redo twice at the same time!");return this._batchingStatus.set(n,0),We(()=>this._batchingStatus.delete(n))}_updateStatus(){var i,o;const n=this._getFocusedUnitId(),r=n&&((i=this._undoStacks.get(n))==null?void 0:i.length)||0,s=n&&((o=this._redoStacks.get(n))==null?void 0:o.length)||0;this._undoRedoStatus$.next({undos:r,redos:s})}_getUndoStack(n,r=!1){let s=this._undoStacks.get(n);return!s&&r&&(s=[],this._undoStacks.set(n,s)),s||null}_getRedoStack(n,r=!1){let s=this._redoStacks.get(n);return!s&&r&&(s=[],this._redoStacks.set(n,s)),s||null}_getUndoStackForFocused(){const n=this._getFocusedUnitId();if(!n)throw new Error("No focused univer instance!");return this._getUndoStack(n,!0)}_getRedoStackForFocused(){const n=this._getFocusedUnitId();if(!n)throw new Error("No focused univer instance!");return this._getRedoStack(n,!0)}_tryBatchingElements(n,r){n.redoMutations.push(...r.redoMutations),n.undoMutations.push(...r.undoMutations)}_getFocusedUnitId(){var o,a,l,c;let n="";const r=this._contextService.getContextValue(Hn),s=this._contextService.getContextValue(Ph),i=this._contextService.getContextValue(Uh);return r?s?n=oo:i?n=io:n=(a=(o=this._univerInstanceService.getFocusedUnit())==null?void 0:o.getUnitId())!=null?a:"":n=(c=(l=this._univerInstanceService.getFocusedUnit())==null?void 0:l.getUnitId())!=null?c:"",n}};exports.LocalUndoRedoService=sI([wi(0,Xn),wi(1,Hr),wi(2,Jn)],exports.LocalUndoRedoService);class hd{constructor(t,n=100){p(this,"_imageCacheMap");this._injector=t,this._imageCacheMap=new yr(n)}_getImageCacheKey(t,n){return`${t}-${n}`}getImage(t,n,r,s){const i=this._getImageCacheKey(t,n),o=this._imageCacheMap.get(i);return o||((async()=>{const a=new Image,l=this._injector.has(Qi)?this._injector.get(Qi):null;if(t===la.UUID)try{a.src=await(l==null?void 0:l.getImage(n))||""}catch(c){console.error(c)}else a.src=n;a.onload=()=>{a.removeAttribute("data-error"),r==null||r()},a.onerror=()=>{a.setAttribute("data-error","true"),s==null||s()},this._imageCacheMap.set(i,a)})(),null)}}function oI(e){return!(e.length===0||e.length>31||e.startsWith("'")||e.endsWith("'")||/[:\\\/\?\*\[\]]/.test(e))}function aI(e,t){return!(!e||e.length===0||e.length>255||t.has(e)||/[ :\\\/\?\*\[\]]/.test(e)||!/^[\p{L}_]/u.test(e)||/^\$?[A-Za-z]{1,3}\$?[0-9]+$/.test(e)||/^[rR]\d+[cC]\d+$/.test(e)||/^\d+$/.test(e))}const wl=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],bi=1,ir=8;class ha{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[n,r]=new Uint8Array(t,0,2);if(n!==219)throw new Error("Data does not appear to be in a KDBush format.");const s=r>>4;if(s!==bi)throw new Error(`Got v${s} data when expected v${bi}.`);const i=wl[r&15];if(!i)throw new Error("Unrecognized array type.");const[o]=new Uint16Array(t,2,1),[a]=new Uint32Array(t,4,1);return new ha(a,o,i,t)}constructor(t,n=64,r=Float64Array,s){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+n,2),65535),this.ArrayType=r,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const i=wl.indexOf(this.ArrayType),o=t*2*this.ArrayType.BYTES_PER_ELEMENT,a=t*this.IndexArrayType.BYTES_PER_ELEMENT,l=(8-a%8)%8;if(i<0)throw new Error(`Unexpected typed array class: ${r}.`);s&&s instanceof ArrayBuffer?(this.data=s,this.ids=new this.IndexArrayType(this.data,ir,t),this.coords=new this.ArrayType(this.data,ir+a+l,t*2),this._pos=t*2,this._finished=!0):(this.data=new ArrayBuffer(ir+o+a+l),this.ids=new this.IndexArrayType(this.data,ir,t),this.coords=new this.ArrayType(this.data,ir+a+l,t*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(bi<<4)+i]),new Uint16Array(this.data,2,1)[0]=n,new Uint32Array(this.data,4,1)[0]=t)}add(t,n){const r=this._pos>>1;return this.ids[r]=r,this.coords[this._pos++]=t,this.coords[this._pos++]=n,r}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return ro(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,n,r,s){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:i,coords:o,nodeSize:a}=this,l=[0,i.length-1,0],c=[];for(;l.length;){const u=l.pop()||0,h=l.pop()||0,d=l.pop()||0;if(h-d<=a){for(let R=d;R<=h;R++){const b=o[2*R],F=o[2*R+1];b>=t&&b<=r&&F>=n&&F<=s&&c.push(i[R])}continue}const f=d+h>>1,g=o[2*f],_=o[2*f+1];g>=t&&g<=r&&_>=n&&_<=s&&c.push(i[f]),(u===0?t<=g:n<=_)&&(l.push(d),l.push(f-1),l.push(1-u)),(u===0?r>=g:s>=_)&&(l.push(f+1),l.push(h),l.push(1-u))}return c}within(t,n,r){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:s,coords:i,nodeSize:o}=this,a=[0,s.length-1,0],l=[],c=r*r;for(;a.length;){const u=a.pop()||0,h=a.pop()||0,d=a.pop()||0;if(h-d<=o){for(let R=d;R<=h;R++)bl(i[2*R],i[2*R+1],t,n)<=c&&l.push(s[R]);continue}const f=d+h>>1,g=i[2*f],_=i[2*f+1];bl(g,_,t,n)<=c&&l.push(s[f]),(u===0?t-r<=g:n-r<=_)&&(a.push(d),a.push(f-1),a.push(1-u)),(u===0?t+r>=g:n+r>=_)&&(a.push(f+1),a.push(h),a.push(1-u))}return l}}function ro(e,t,n,r,s,i){if(s-r<=n)return;const o=r+s>>1;dd(e,t,o,r,s,i),ro(e,t,n,r,o-1,1-i),ro(e,t,n,o+1,s,1-i)}function dd(e,t,n,r,s,i){for(;s>r;){if(s-r>600){const c=s-r+1,u=n-r+1,h=Math.log(c),d=.5*Math.exp(2*h/3),f=.5*Math.sqrt(h*d*(c-d)/c)*(u-c/2<0?-1:1),g=Math.max(r,Math.floor(n-u*d/c+f)),_=Math.min(s,Math.floor(n+(c-u)*d/c+f));dd(e,t,n,g,_,i)}const o=t[2*n+i];let a=r,l=s;for(or(e,t,r,n),t[2*s+i]>o&&or(e,t,r,s);a<l;){for(or(e,t,a,l),a++,l--;t[2*a+i]<o;)a++;for(;t[2*l+i]>o;)l--}t[2*r+i]===o?or(e,t,r,l):(l++,or(e,t,l,s)),l<=n&&(r=l+1),n<=l&&(s=l-1)}}function or(e,t,n,r){Ai(e,n,r),Ai(t,2*n,2*r),Ai(t,2*n+1,2*r+1)}function Ai(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function bl(e,t,n,r){const s=e-n,i=t-r;return s*s+i*i}class lI{constructor(t=!1){p(this,"_tree",new Map);p(this,"_oneCellCache",new Map);p(this,"_kdTree",new Map);this._enableOneCellCache=t}dispose(){this.clear()}getTree(t,n){return this._tree.has(t)||this._tree.set(t,new Map),this._tree.get(t).has(n)||this._tree.get(t).set(n,new Ls),this._tree.get(t).get(n)}_getOneCellCache(t,n,r,s){return this._oneCellCache.has(t)||this._oneCellCache.set(t,new Map),this._oneCellCache.get(t).has(n)||this._oneCellCache.get(t).set(n,new Map),this._oneCellCache.get(t).get(n).has(r)||this._oneCellCache.get(t).get(n).set(r,new Map),this._oneCellCache.get(t).get(n).get(r).has(s)||this._oneCellCache.get(t).get(n).get(r).set(s,new Set),this._oneCellCache.get(t).get(n).get(r).get(s)}_removeOneCellCache(t,n,r,s,i){const o=this._oneCellCache.get(t);if(!o)return;const a=o.get(n);if(!a)return;const l=a.get(r);if(!l)return;const c=l.get(s);c&&c.delete(i)}_removeCellCacheByRange(t){const{unitId:n,sheetId:r,range:s,id:i}=t,o=this._oneCellCache.get(n);if(!o)return;const a=o.get(r);if(!a)return;const{startRow:l,startColumn:c,endRow:u,endColumn:h}=s;for(let d=l;d<=u;d++){const f=a.get(d);if(f)for(let g=c;g<=h;g++){const _=f.get(g);_&&_.delete(i)}}}_insertOneCellCache(t,n,r,s,i){this._getOneCellCache(t,n,r,s).add(i)}_getRdTreeItems(t){const n=[];for(const[r,s]of t)for(const[i,o]of s)n.push({x:i,y:r,ids:o});return n}_searchByOneCellCache(t){var g;const{unitId:n,sheetId:r,range:s}=t,{startRow:i,startColumn:o,endRow:a,endColumn:l}=s,c=(g=this._kdTree.get(n))==null?void 0:g.get(r);if(!c)return[];const{tree:u,items:h}=c,d=u.range(o,i,l,a),f=[];for(const _ of d){const R=h[_];f.push(...Array.from(R.ids))}return f}openKdTree(){var t;for(const[n,r]of this._oneCellCache){this._kdTree.has(n)||this._kdTree.set(n,new Map);for(const[s,i]of r){const o=this._getRdTreeItems(i),a=new ha(o.length);(t=this._kdTree.get(n))==null||t.set(s,{tree:a,items:o});for(const l of o)a.add(l.x,l.y);a.finish()}}}closeKdTree(){var t;for(const[n,r]of this._oneCellCache)for(const[s,i]of r)(t=this._kdTree.get(n))==null||t.set(s,void 0)}insert(t){const{unitId:n,sheetId:r,range:s,id:i}=t;if(!n||n.length===0)return;let{startRow:o,endRow:a,startColumn:l,endColumn:c}=s;if(this._enableOneCellCache&&o===a&&l===c){this._insertOneCellCache(n,r,o,l,i);return}const u=this.getTree(n,r);Number.isNaN(o)&&(o=0),Number.isNaN(l)&&(l=0),Number.isNaN(a)&&(a=Number.POSITIVE_INFINITY),Number.isNaN(c)&&(c=Number.POSITIVE_INFINITY),u.insert({minX:l,minY:o,maxX:c,maxY:a,id:i})}bulkInsert(t){for(const n of t)this.insert(n)}*searchGenerator(t){var a;const{unitId:n,sheetId:r,range:s}=t;if(this._enableOneCellCache){const l=this._searchByOneCellCache(t);for(const c of l)yield c}const i=(a=this._tree.get(n))==null?void 0:a.get(r);if(!i)return;const o=i.search({minX:s.startColumn,minY:s.startRow,maxX:s.endColumn,maxY:s.endRow});for(const l of o)yield l.id}bulkSearch(t,n){const r=new Set;for(const s of t)for(const i of this.searchGenerator(s))(n==null?void 0:n.has(i))!==!0&&r.add(i);return r}removeById(t,n){var r,s;n?((r=this._tree.get(t))==null||r.delete(n),(s=this._oneCellCache.get(t))==null||s.delete(n)):(this._tree.delete(t),this._oneCellCache.delete(t))}_removeRTreeItem(t){const{unitId:n,sheetId:r,range:s,id:i}=t,o=this.getTree(n,r),a=o.search({minX:s.startColumn,minY:s.startRow,maxX:s.endColumn,maxY:s.endRow});for(let l=0;l<a.length;l++)a[l].id===i&&o.remove(a[l])}remove(t){const{unitId:n,sheetId:r,range:s,id:i}=t,{startRow:o,startColumn:a,endRow:l,endColumn:c}=s;this._enableOneCellCache?o===l&&a===c?this._removeOneCellCache(n,r,s.startRow,s.startColumn,i):(this._removeCellCacheByRange(t),this._removeRTreeItem(t)):this._removeRTreeItem(t)}bulkRemove(t){for(const n of t)this.remove(n)}clear(){this._tree.clear(),this._oneCellCache.clear()}toJSON(){const t={};return this._tree.forEach((n,r)=>{t[r]={},n.forEach((s,i)=>{t[r][i]=s.toJSON()})}),t}fromJSON(t){this._tree.clear();for(const n in t){this._tree.set(n,new Map);for(const r in t[n]){const s=new Ls;s.fromJSON(t[n][r]),this._tree.get(n).set(r,s)}}}}function cI(e){return new Promise(t=>setTimeout(t,e))}function uI(e=1){return new Promise(t=>{let n=0;const r=()=>{n++,n>=e?t():requestAnimationFrame(r)};requestAnimationFrame(r)})}var hI=Object.getOwnPropertyDescriptor,dI=(e,t,n,r)=>{for(var s=r>1?void 0:r?hI(t,n):t,i=e.length-1,o;i>=0;i--)(o=e[i])&&(s=o(s)||s);return s},fI=(e,t)=>(n,r)=>t(n,r,e);exports.Skeleton=class extends Ke{constructor(n){super();p(this,"_fontLocale");p(this,"_dirty",!0);this._localeService=n,this._localeInitial()}get dirty(){return this._dirty}getFontLocale(){return this._fontLocale}makeDirty(n){this._dirty=n}dispose(){super.dispose(),this._fontLocale=null}_localeInitial(){}};exports.Skeleton=dI([fI(0,Ae.Inject(Cn))],exports.Skeleton);var mI=Object.getOwnPropertyDescriptor,gI=(e,t,n,r)=>{for(var s=r>1?void 0:r?mI(t,n):t,i=e.length-1,o;i>=0;i--)(o=e[i])&&(s=o(s)||s);return s},as=(e,t)=>(n,r)=>t(n,r,e);exports.SheetSkeleton=class extends exports.Skeleton{constructor(n,r,s,i,o,a){super(s);p(this,"_worksheetData");p(this,"_renderRawFormula",!1);p(this,"_cellData");p(this,"_imageCacheMap");p(this,"_skipAutoHeightForMergedCells",!0);p(this,"_rowTotalHeight",0);p(this,"_columnTotalWidth",0);p(this,"_rowHeaderWidth",0);p(this,"_columnHeaderHeight",0);p(this,"_rowHeightAccumulation",[]);p(this,"_columnWidthAccumulation",[]);p(this,"_marginTop",0);p(this,"_marginLeft",0);p(this,"_scaleX");p(this,"_scaleY");p(this,"_scrollX");p(this,"_scrollY");this.worksheet=n,this._styles=r,this._contextService=i,this._configService=o,this._injector=a,this._worksheetData=this.worksheet.getConfig(),this._cellData=this.worksheet.getCellMatrix(),this._imageCacheMap=new hd(this._injector),this.initConfig()}initConfig(){var n,r;this._skipAutoHeightForMergedCells=!((n=this._configService.getConfig(Dl))!=null&&n),this.worksheet.setIsRowStylePrecedeColumnStyle((r=this._configService.getConfig(Ll))!=null?r:!1)}resetCache(){}getWorksheetConfig(){return this._worksheetData}getLocation(){return[this.worksheet.getUnitId(),this.worksheet.getSheetId()]}set columnHeaderHeight(n){this._columnHeaderHeight=n,this._worksheetData.columnHeader.height=n}set rowHeaderWidth(n){this._rowHeaderWidth=n,this._worksheetData.rowHeader.width=n}get rowHeightAccumulation(){return this._rowHeightAccumulation}get rowTotalHeight(){return this._rowTotalHeight}get columnWidthAccumulation(){return this._columnWidthAccumulation}get columnTotalWidth(){return this._columnTotalWidth}get rowHeaderWidth(){return this._rowHeaderWidth}get columnHeaderHeight(){return this._columnHeaderHeight}setMarginLeft(n){this._marginLeft=n}setMarginTop(n){this._marginTop=n}setScale(n,r){this._updateLayout(),this._scaleX=n,this._scaleY=r||n,this._updateLayout()}setScroll(n,r){Z.isDefine(n)&&(this._scrollX=n),Z.isDefine(r)&&(this._scrollY=r)}get scrollX(){return this._scrollX}get scrollY(){return this._scrollY}get scaleX(){return this._scaleX}get scaleY(){return this._scaleY}get rowHeaderWidthAndMarginLeft(){return this.rowHeaderWidth+this._marginLeft}get columnHeaderHeightAndMarginTop(){return this.columnHeaderHeight+this._marginTop}get imageCacheMap(){return this._imageCacheMap}_generateRowMatrixCache(n,r,s){let i=0;const o=[],a=r;for(let l=0;l<n;l++){let c=s;if(this.worksheet.getRowFiltered(l))c=0;else if(a[l]!=null){const u=a[l];if(!u)continue;const{h=s,ah:d,ia:f}=u;(f==null||f===ie.TRUE)&&typeof d=="number"?c=d:c=h,u.hd===ie.TRUE&&(c=0)}i+=c,o.push(i)}return{rowTotalHeight:i,rowHeightAccumulation:o}}_generateColumnMatrixCache(n,r,s){let i=0;const o=[],a=r;for(let l=0;l<n;l++){let c=s;if(a[l]!=null){const u=a[l];if(!u)continue;u.w!=null&&(c=u.w),u.hd===ie.TRUE&&(c=0)}i+=c,o.push(i)}return{columnTotalWidth:i,columnWidthAccumulation:o}}intersectMergeRange(n,r){return!!this.worksheet.getMergedCell(n,r)}_getOverflowBound(n,r,s,i,o=Tt.LEFT){let a=0;if(r>s){const l=this._columnWidthAccumulation.length-1;for(let c=r;c>=s;c--){const u=c,h=this.worksheet.getCell(n,u);if(!Fi(h)&&u!==r||this.intersectMergeRange(n,u))return u===r?u:u+1>l?l:u+1;const{startX:d,endX:f}=Un(n,u,this.rowHeightAccumulation,this.columnWidthAccumulation);if(o===Tt.CENTER&&u===r?a+=(f-d)/2:a+=f-d,i<a)return u}return r}for(let l=r;l<=s;l++){const c=l,u=this.worksheet.getCell(n,c);if(!Fi(u)&&c!==r||this.intersectMergeRange(n,c))return c===r?c:c-1<0?0:c-1;const{startX:h,endX:d}=Un(n,c,this.rowHeightAccumulation,this.columnWidthAccumulation);if(o===Tt.CENTER&&c===r?a+=(d-h)/2:a+=d-h,i<a)return c}return s}_updateLayout(){if(!this.dirty)return;const{rowData:n,columnData:r,defaultRowHeight:s,defaultColumnWidth:i,rowCount:o,columnCount:a,rowHeader:l,columnHeader:c}=this._worksheetData,{rowTotalHeight:u,rowHeightAccumulation:h}=this._generateRowMatrixCache(o,n,s),{columnTotalWidth:d,columnWidthAccumulation:f}=this._generateColumnMatrixCache(a,r,i);this._rowHeaderWidth=l.hidden!==ie.TRUE?this._dynamicallyUpdateRowHeaderWidth(l):0,this._columnHeaderHeight=c.hidden!==ie.TRUE?c.height:0,this._rowTotalHeight=u,this._rowHeightAccumulation=h,this._columnTotalWidth=d,this._columnWidthAccumulation=f,this.makeDirty(!1)}calculate(){return this.resetCache(),this._updateLayout(),this}resetRangeCache(n){}_dynamicallyUpdateRowHeaderWidth(n){const s=`${this.worksheet.getRowCount()}`.length*8;return Math.max(n.width,s)}_hasUnMergedCellInRow(n,r,s){if(!this.worksheet.getMergeData())return!1;for(let o=r;o<=s;o++){const{isMerged:a,isMergedMainCell:l}=this.worksheet.getCellInfoInMergeData(n,o);if(!a&&!l)return!0}return!1}expandRangeByMerge(n){let{startRow:r,startColumn:s,endRow:i,endColumn:o}=n;const a=this._worksheetData.mergeData;if(!a)return{startRow:r,startColumn:s,endRow:i,endColumn:o};let l=!0;const c=new dt;for(;l;){l=!1;for(let u=0;u<a.length;u++){const{startRow:h,startColumn:d,endRow:f,endColumn:g}=a[u];if(c.getValue(h,d))continue;rh({startColumn:s,startRow:r,endColumn:o,endRow:i},{startColumn:d,startRow:h,endColumn:g,endRow:f})&&(r=Math.min(r,h),s=Math.min(s,d),i=Math.max(i,f),o=Math.max(o,g),c.setValue(h,d,!0),l=!0)}}return{startRow:r,startColumn:s,endRow:i,endColumn:o}}getColumnCount(){return this._columnWidthAccumulation.length}getRowCount(){return this._rowHeightAccumulation.length}_getCellMergeInfo(n,r){return this.worksheet.getCellInfoInMergeData(n,r)}getNoMergeCellPositionByIndex(n,r,s=!0){return this.getNoMergeCellWithCoordByIndex(n,r,s)}getNoMergeCellWithCoordByIndex(n,r,s=!0){const{rowHeightAccumulation:i,columnWidthAccumulation:o,rowHeaderWidthAndMarginLeft:a,columnHeaderHeightAndMarginTop:l}=this;let{startY:c,endY:u,startX:h,endX:d}=Un(n,r,i,o);return s&&(c+=l,u+=l,h+=a,d+=a),{startY:c,endY:u,startX:h,endX:d}}getNoMergeCellPositionByIndexWithNoHeader(n,r){const{rowHeightAccumulation:s,columnWidthAccumulation:i}=this,{startY:o,endY:a,startX:l,endX:c}=Un(n,r,s,i);return{startY:o,endY:a,startX:l,endX:c}}getRowIndexByOffsetY(n,r,s,i){var l;const{rowHeightAccumulation:o}=this;n=md(n,r,s,this.columnHeaderHeightAndMarginTop);let a=lr(o,n,i==null?void 0:i.firstMatch);return i!=null&&i.closeFirst&&Math.abs(o[a]-n)<Math.abs(n-((l=o[a-1])!=null?l:0))&&(a=a+1),a}getColumnIndexByOffsetX(n,r,s,i){var c;const o=fd(n,r,s,this.rowHeaderWidthAndMarginLeft),{columnWidthAccumulation:a}=this;let l=lr(a,o,i==null?void 0:i.firstMatch);return i!=null&&i.closeFirst&&Math.abs(a[l]-o)<Math.abs(o-((c=a[l-1])!=null?c:0))&&(l=l+1),l}getCellIndexByOffset(n,r,s,i,o,a){const l=this.getRowIndexByOffsetY(r,i,o,a),c=this.getColumnIndexByOffsetX(n,s,o,a);return{row:l,column:c}}getCellByOffset(n,r,s,i,o){const a=this==null?void 0:this.getCellIndexByOffset(n,r,s,i,o,{firstMatch:!0});return a?this.worksheet.getCellInfoInMergeData(a.row,a.column):null}getCellWithCoordByIndex(n,r,s=!0){const{rowHeightAccumulation:i,columnWidthAccumulation:o,rowHeaderWidthAndMarginLeft:a,columnHeaderHeightAndMarginTop:l}=this,c=Un(n,r,i,o,this.worksheet.getCellInfoInMergeData(n,r)),{isMerged:u,isMergedMainCell:h}=c;let{startY:d,endY:f,startX:g,endX:_,mergeInfo:R}=c,b=a,F=l;return s===!1&&(b=0,F=0),d+=F,f+=F,g+=b,_+=b,R.startY+=F,R.endY+=F,R.startX+=b,R.endX+=b,{actualRow:n,actualColumn:r,startX:g,startY:d,endX:_,endY:f,isMerged:u,isMergedMainCell:h,mergeInfo:R}}getCellWithCoordByOffset(n,r,s,i,o,a){const{row:l,column:c}=this.getCellIndexByOffset(n,r,s,i,o,a);return this.getCellWithCoordByIndex(l,c)}getOffsetByColumn(n){const{columnWidthAccumulation:r,rowHeaderWidthAndMarginLeft:s}=this,i=r.length-1,o=r[n];return o!=null?o+s:n<0?s:r[i]+s}getOffsetByRow(n){const{rowHeightAccumulation:r,columnHeaderHeightAndMarginTop:s}=this,i=r.length-1,o=r[n];return o!=null?o+s:n<0?s:r[i]+s}getOffsetRelativeToRowCol(n,r){const s=lr(this.columnWidthAccumulation,n);let i=0;s===0?i=n:i=n-this._columnWidthAccumulation[s-1];const o=lr(this.rowHeightAccumulation,r);let a=0;return o===0?a=r:a=r-this._rowHeightAccumulation[o-1],{row:o,column:s,columnOffset:i,rowOffset:a}}_updateConfigAndGetDocumentModel(n,r,s,i){var a,l,c,u,h;if(!i||!((a=n.body)!=null&&a.dataStream))return;n.documentStyle||(n.documentStyle={}),n.documentStyle.marginTop=(l=s.t)!=null?l:0,n.documentStyle.marginBottom=(c=s.b)!=null?c:2,n.documentStyle.marginLeft=(u=s.l)!=null?u:2,n.documentStyle.marginRight=(h=s.r)!=null?h:2,n.documentStyle.pageSize={width:Number.POSITIVE_INFINITY,height:Number.POSITIVE_INFINITY},n.documentStyle.renderConfig={...n.documentStyle.renderConfig,...i};const o=n.body.paragraphs||[];for(const d of o)d.paragraphStyle||(d.paragraphStyle={}),d.paragraphStyle.horizontalAlign=r;return new Nt(n)}dispose(){super.dispose(),this._rowHeightAccumulation=[],this._columnWidthAccumulation=[],this._rowTotalHeight=0,this._columnTotalWidth=0,this._rowHeaderWidth=0,this._columnHeaderHeight=0,this._worksheetData=null,this._cellData=null,this._styles=null,this.worksheet=null}};exports.SheetSkeleton=gI([as(2,Ae.Inject(Cn)),as(3,Jn),as(4,aa),as(5,Ae.Inject(Ae.Injector))],exports.SheetSkeleton);function da(e,t,n,r){const s=e-1,i=t-1,o=n[s]||0;let a=n[e];a==null&&(a=n[n.length-1]);const l=r[i]||0;let c=r[t];return c==null&&(c=r[r.length-1]),{startY:o,endY:a,startX:l,endX:c}}function _I(e,t,n,r){return da(e,t,n,r)}function Un(e,t,n,r,s){e=Z.clamp(e,0,n.length-1),t=Z.clamp(t,0,r.length-1);let{startY:i,endY:o,startX:a,endX:l}=da(e,t,n,r);if(!s)return{startY:i,endY:o,startX:a,endX:l,isMerged:!1,isMergedMainCell:!1,actualRow:e,actualColumn:t,mergeInfo:{startY:i,endY:o,startX:a,endX:l,startRow:e,startColumn:t,endRow:e,endColumn:t}};const{isMerged:c,isMergedMainCell:u,startRow:h,startColumn:d,endRow:f,endColumn:g}=s;let _={startRow:h,startColumn:d,endRow:f,endColumn:g,startY:i,endY:o,startX:a,endX:l};const R=n.length-1,b=r.length-1;if(c&&h!==-1&&d!==-1){const F=n[h-1]||0,k=n[f]||n[R],W=r[d-1]||0,S=r[g]||r[b];_={..._,startY:F,endY:k,startX:W,endX:S}}else if(!c&&f!==-1&&g!==-1){const F=n[f]||n[R],k=r[g]||r[b];_={..._,startY:i,endY:F,startX:a,endX:k}}return{isMerged:c,isMergedMainCell:u,actualRow:e,actualColumn:t,startY:i,endY:o,startX:a,endX:l,mergeInfo:_}}function fd(e,t,n,r){const{x:s}=n;return e/t+s-r}function md(e,t,n,r){const{y:s}=n;return e=e/t+s-r,e}const pI=["script","style","meta","comment","link"];var gd=(e=>(e[e.INFO=0]="INFO",e[e.STOP=1]="STOP",e[e.WARNING=2]="WARNING",e))(gd||{}),_d=(e=>(e[e.DISABLED=0]="DISABLED",e[e.FULL_ALPHA=1]="FULL_ALPHA",e[e.FULL_HANGUL=2]="FULL_HANGUL",e[e.FULL_KATAKANA=3]="FULL_KATAKANA",e[e.HALF_ALPHA=4]="HALF_ALPHA",e[e.HALF_HANGUL=5]="HALF_HANGUL",e[e.HALF_KATAKANA=6]="HALF_KATAKANA",e[e.HIRAGANA=7]="HIRAGANA",e[e.NO_CONTROL=8]="NO_CONTROL",e[e.OFF=9]="OFF",e[e.ON=10]="ON",e))(_d||{}),pd=(e=>(e.BETWEEN="between",e.EQUAL="equal",e.GREATER_THAN="greaterThan",e.GREATER_THAN_OR_EQUAL="greaterThanOrEqual",e.LESS_THAN="lessThan",e.LESS_THAN_OR_EQUAL="lessThanOrEqual",e.NOT_BETWEEN="notBetween",e.NOT_EQUAL="notEqual",e))(pd||{}),Ed=(e=>(e[e.TEXT=0]="TEXT",e[e.ARROW=1]="ARROW",e[e.CUSTOM=2]="CUSTOM",e))(Ed||{}),Cd=(e=>(e.VALID="valid",e.INVALID="invalid",e.VALIDATING="validating",e))(Cd||{}),Rd=(e=>(e.CUSTOM="custom",e.LIST="list",e.LIST_MULTIPLE="listMultiple",e.NONE="none",e.TEXT_LENGTH="textLength",e.DATE="date",e.TIME="time",e.WHOLE="whole",e.DECIMAL="decimal",e.CHECKBOX="checkbox",e.ANY="any",e))(Rd||{}),EI=Object.getOwnPropertyDescriptor,CI=(e,t,n,r)=>{for(var s=r>1?void 0:r?EI(t,n):t,i=e.length-1,o;i>=0;i--)(o=e[i])&&(s=o(s)||s);return s},Al=(e,t)=>(n,r)=>t(n,r,e);let so=class extends Ke{constructor(e,t){super(),this._resourceManagerService=e,this._univerInstanceService=t,this._init()}_init(){const e=n=>{n.businesses.forEach(r=>{switch(r){case Oe.UNRECOGNIZED:case Oe.UNIVER_UNKNOWN:case Oe.UNIVER_SLIDE:case Oe.UNIVER_DOC:{this._univerInstanceService.getAllUnitsForType(Oe.UNIVER_DOC).forEach(s=>{const o=(s.getSnapshot().resources||[]).find(a=>a.name===n.pluginName);if(o)try{const a=n.parseJson(o.data);n.onLoad(s.getUnitId(),a)}catch{console.error(`Load Document{${s.getUnitId()}} Resources{${n.pluginName}} Data Error.`)}});break}case Oe.UNIVER_SHEET:this._univerInstanceService.getAllUnitsForType(Oe.UNIVER_SHEET).forEach(s=>{const o=(s.getSnapshot().resources||[]).find(a=>a.name===n.pluginName);if(o)try{const a=n.parseJson(o.data);n.onLoad(s.getUnitId(),a)}catch{console.error(`Load Workbook{${s.getUnitId()}} Resources{${n.pluginName}} Data Error.`)}})}})};this._resourceManagerService.getAllResourceHooks().forEach(n=>e(n)),this.disposeWithMe(this._resourceManagerService.register$.subscribe(n=>e(n))),this.disposeWithMe(this._univerInstanceService.getTypeOfUnitAdded$(Oe.UNIVER_SHEET).subscribe(n=>{this._resourceManagerService.loadResources(n.getUnitId(),n.getSnapshot().resources)})),this.disposeWithMe(this._univerInstanceService.getTypeOfUnitAdded$(Oe.UNIVER_DOC).subscribe(n=>{const r=n.getUnitId();xl(r)||this._resourceManagerService.loadResources(n.getUnitId(),n.getSnapshot().resources)})),this.disposeWithMe(this._univerInstanceService.getTypeOfUnitDisposed$(Oe.UNIVER_SHEET).subscribe(n=>{this._resourceManagerService.unloadResources(n.getUnitId(),Oe.UNIVER_SHEET)})),this.disposeWithMe(this._univerInstanceService.getTypeOfUnitDisposed$(Oe.UNIVER_DOC).subscribe(n=>{this._resourceManagerService.unloadResources(n.getUnitId(),Oe.UNIVER_DOC)}))}saveUnit(e){const t=this._univerInstanceService.getUnit(e);if(!t)return null;const n=this._resourceManagerService.getResources(e,t.type),r=Z.deepClone(t.getSnapshot());return r.resources=n,r}};so=CI([Al(0,Ae.Inject(Qs)),Al(1,Ae.Inject(Xn))],so);class RI{constructor(t={},n){p(this,"_startedTypes",new Set);p(this,"_injector");p(this,"_disposingCallbacks",new js);const r=this._injector=II(n,t==null?void 0:t.override),{theme:s,darkMode:i,locale:o,locales:a,logLevel:l}=t;s&&this._injector.get(Ps).setTheme(s),i&&this._injector.get(Ps).setDarkMode(i),a&&this._injector.get(Cn).load(a),o&&this._injector.get(Cn).setLocale(o),l&&this._injector.get(Ct).setLogLevel(l),this._init(r)}get _univerInstanceService(){return this._injector.get(Xn)}get _pluginService(){return this._injector.get(exports.PluginService)}__getInjector(){return this._injector}onDispose(t){const n=this._disposingCallbacks.add(We(t));return We(()=>n.dispose(!0))}dispose(){this._disposingCallbacks.dispose(),this._injector.dispose()}setLocale(t){this._injector.get(Cn).setLocale(t)}createUnit(t,n){return this._univerInstanceService.createUnit(t,n)}createUniverSheet(t){return this._injector.get(Ct).warn("[Univer]","Univer.createUniverSheet is deprecated, use createUnit instead"),this._univerInstanceService.createUnit(Oe.UNIVER_SHEET,t)}createUniverDoc(t){return this._injector.get(Ct).warn("[Univer]","Univer.createUniverDoc is deprecated, use createUnit instead"),this._univerInstanceService.createUnit(Oe.UNIVER_DOC,t)}createUniverSlide(t){return this._injector.get(Ct).warn("[Univer]","Univer.createUniverSlide is deprecated, use createUnit instead"),this._univerInstanceService.createUnit(Oe.UNIVER_SLIDE,t)}_init(t){this._univerInstanceService.registerCtorForType(Oe.UNIVER_SHEET,exports.Workbook),this._univerInstanceService.registerCtorForType(Oe.UNIVER_DOC,Nt),this._univerInstanceService.registerCtorForType(Oe.UNIVER_SLIDE,ca);const n=t.get(Xn);n.__setCreateHandler((r,s,i,o)=>{if(!this._startedTypes.has(r)){this._pluginService.startPluginsForType(r),this._startedTypes.add(r);const l=t.createInstance(i,s);return n.__addUnit(l,o),this._tryProgressToReady(),l}const a=t.createInstance(i,s);return n.__addUnit(a,o),a})}_tryProgressToReady(){this._injector.get(exports.LifecycleService).stage<Ue.Ready&&(this._injector.get(exports.LifecycleService).stage=Ue.Ready)}registerPlugin(t,n){this._pluginService.registerPlugin(t,n)}registerPlugins(t){t.forEach(n=>{const[r,s]=n;this._pluginService.registerPlugin(r,s)})}}function II(e,t){const n=sd([[kh],[Cn],[Ps],[exports.LifecycleService],[exports.PluginService],[Dr],[Xn,{useClass:exports.UniverInstanceService}],[nd,{useClass:rd}],[Ct,{useClass:uu,lazy:!0}],[Hr,{useClass:exports.CommandService}],[ei,{useClass:exports.LocalUndoRedoService,lazy:!0}],[aa,{useClass:xh}],[Jn,{useClass:lu}],[Qs,{useClass:exports.ResourceManagerService,lazy:!0}],[no,{useClass:so,lazy:!0}],[Dh,{useClass:exports.AuthzIoLocalService}],[td,{useClass:exports.MentionIOLocalService,lazy:!0}]],t),r=e?e.createChild(n):new Ae.Injector(n);return Ul(r,[[Dr],[no]]),r}Ad();exports.ABCToNumber=j0;exports.AUTO_HEIGHT_FOR_MERGED_CELLS=Dl;exports.AbsoluteRefType=Ne;exports.ActionIterator=xn;exports.AlignTypeH=Jc;exports.AlignTypeV=Qc;exports.ArrangeTypeEnum=nu;exports.ArrowsAndMarkersShapes=vc;exports.AsyncInterceptorManager=Kd;exports.AsyncLock=kd;exports.AutoFillSeries=fc;exports.BaselineOffset=Yt;exports.BasicShapes=Oc;exports.BlockType=Lc;exports.BooleanNumber=ie;exports.BorderStyleTypes=De;exports.BorderType=mc;exports.BuildTextUtils=Qe;exports.BulletAlignment=Br;exports.COLORS=Ui;exports.CanceledError=jd;exports.CellModeEnum=Fn;exports.CellValueType=en;exports.Color=Sn;exports.ColorBuilder=Vs;exports.ColorKit=pt;exports.ColorType=Et;exports.ColumnSeparatorType=Uc;exports.CommandType=$r;exports.CommonHideTypes=gc;exports.ConfigService=xh;exports.ContextService=lu;exports.CopyPasteType=_c;exports.CustomCommandExecutionError=Ss;exports.CustomDecorationType=pn;exports.CustomRangeType=rn;exports.DEFAULT_CELL=E0;exports.DEFAULT_DOC=sa;exports.DEFAULT_DOCUMENT_SUB_COMPONENT_ID=nR;exports.DEFAULT_EMPTY_DOCUMENT_VALUE=Ml;exports.DEFAULT_NUMBER_FORMAT=Qu;exports.DEFAULT_RANGE=_0;exports.DEFAULT_RANGE_ARRAY=g0;exports.DEFAULT_SELECTION=p0;exports.DEFAULT_SLIDE=eh;exports.DEFAULT_STYLES=st;exports.DEFAULT_TEXT_FORMAT=Zu;exports.DEFAULT_TEXT_FORMAT_EXCEL=Ju;exports.DEFAULT_WORKSHEET_COLUMN_COUNT=Yh;exports.DEFAULT_WORKSHEET_COLUMN_COUNT_KEY=yR;exports.DEFAULT_WORKSHEET_COLUMN_TITLE_HEIGHT=Kh;exports.DEFAULT_WORKSHEET_COLUMN_TITLE_HEIGHT_KEY=DR;exports.DEFAULT_WORKSHEET_COLUMN_WIDTH=Vh;exports.DEFAULT_WORKSHEET_COLUMN_WIDTH_KEY=MR;exports.DEFAULT_WORKSHEET_ROW_COUNT=Wh;exports.DEFAULT_WORKSHEET_ROW_COUNT_KEY=TR;exports.DEFAULT_WORKSHEET_ROW_HEIGHT=Gh;exports.DEFAULT_WORKSHEET_ROW_HEIGHT_KEY=NR;exports.DEFAULT_WORKSHEET_ROW_TITLE_WIDTH=zh;exports.DEFAULT_WORKSHEET_ROW_TITLE_WIDTH_KEY=LR;exports.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY=oo;exports.DOCS_NORMAL_EDITOR_UNIT_ID_KEY=io;exports.DOCS_ZEN_EDITOR_UNIT_ID_KEY=Nl;exports.DOC_DRAWING_PRINTING_COMPONENT_KEY=O0;exports.DOC_RANGE_TYPE=Su;exports.DashStyleType=Hc;exports.DataStreamTreeNodeType=Ah;exports.DataStreamTreeTokenType=at;exports.DataValidationErrorStyle=gd;exports.DataValidationImeMode=_d;exports.DataValidationOperator=pd;exports.DataValidationRenderMode=Ed;exports.DataValidationStatus=Cd;exports.DataValidationType=Rd;exports.DeleteDirection=pc;exports.DependentOn=QR;exports.DesktopLogService=uu;exports.DeveloperMetadataVisibility=Ec;exports.Dimension=Cc;exports.Direction=Rc;exports.Disposable=Ke;exports.DisposableCollection=js;exports.DocStyleType=Nc;exports.DocumentDataModel=Nt;exports.DocumentFlavor=Eo;exports.DrawingTypeEnum=ru;exports.EDITOR_ACTIVATED=Uh;exports.EXTENSION_NAMES=th;exports.ErrorService=kh;exports.EventState=Lh;exports.EventSubject=rR;exports.FOCUSING_COMMON_DRAWINGS=mR;exports.FOCUSING_DOC=Rr;exports.FOCUSING_EDITOR_BUT_HIDDEN=lR;exports.FOCUSING_EDITOR_INPUT_FORMULA=cR;exports.FOCUSING_EDITOR_STANDALONE=hR;exports.FOCUSING_FX_BAR_EDITOR=Ph;exports.FOCUSING_PANEL_EDITOR=dR;exports.FOCUSING_SHEET=Hn;exports.FOCUSING_SLIDE=Ir;exports.FOCUSING_UNIT=Cr;exports.FOCUSING_UNIVER_EDITOR=uR;exports.FOCUSING_UNIVER_EDITOR_STANDALONE_SINGLE_MODE=fR;exports.FORMULA_EDITOR_ACTIVATED=gR;exports.FollowNumberWithType=Mc;exports.FontItalic=bs;exports.FontStyleType=kn;exports.FontWeight=As;exports.GridType=Dc;exports.HLSColor=pu;exports.HorizontalAlign=Tt;exports.IAuthzIoService=Dh;exports.ICommandService=Hr;exports.IConfigService=aa;exports.IContextService=Jn;exports.IImageIoService=Qi;exports.ILocalStorageService=GR;exports.ILogService=Ct;exports.IMentionIOService=td;exports.IPermissionService=nd;exports.IResourceLoaderService=no;exports.IResourceManagerService=Qs;exports.IS_ROW_STYLE_PRECEDE_COLUMN_STYLE=Ll;exports.IUndoRedoService=ei;exports.IUniverInstanceService=Xn;exports.ImageCacheMap=hd;exports.ImageSourceType=la;exports.ImageUploadStatusType=Fh;exports.InterceptorEffectEnum=Pn;exports.InterceptorManager=Gd;exports.InterpolationPointType=Ic;exports.JSON1=D_;exports.JSONX=Gt;exports.LRUHelper=ur;exports.LRUMap=yr;exports.LifecycleStages=Ue;exports.LifecycleUnreachableError=Qh;exports.ListGlyphType=fe;exports.LocaleService=Cn;exports.LocaleType=Fr;exports.LogLevel=cu;exports.MOVE_BUFFER_VALUE=cr;exports.MemoryCursor=vn;exports.MentionType=ws;exports.NAMED_STYLE_MAP=R0;exports.NAMED_STYLE_SPACE_MAP=I0;exports.NamedStyleType=Xe;exports.NilCommand=hu;exports.NumberUnitType=Zc;exports.ObjectMatrix=dt;exports.ObjectRelativeFromH=Xc;exports.ObjectRelativeFromV=qc;exports.OtherShapes=wc;exports.PAGE_SIZE=v0;exports.PAPER_TYPES=v_;exports.PRESET_LIST_TYPE=Yr;exports.PRINT_CHART_COMPONENT_KEY=S0;exports.PageElementType=su;exports.PageOrientType=tu;exports.PageType=Co;exports.PaperType=ct;exports.ParagraphElementType=kc;exports.ParagraphStyleBuilder=Lr;exports.ParagraphStyleValue=Vr;exports.PermissionService=rd;exports.PermissionStatus=ua;exports.Plugin=to;exports.PositionedObjectLayoutType=Bc;exports.PresetListType=kt;exports.ProtectionType=Sc;exports.QuickListType=Eh;exports.QuickListTypeMap=Q0;exports.RANGE_DIRECTION=Iu;exports.RANGE_TYPE=_e;exports.RBush=Ls;exports.RCDisposable=u_;exports.RGBA_PAREN=X_;exports.RGB_PAREN=K_;exports.ROTATE_BUFFER_VALUE=gu;exports.RTree=lI;exports.Range=Kn;exports.Rectangle=on;exports.RedoCommand=ud;exports.RedoCommandId=ad;exports.RefAlias=H0;exports.Registry=go;exports.RegistryAsMap=_o;exports.RelativeDate=Ac;exports.RelativeSlideLink=iu;exports.RgbColor=Ts;exports.RichTextBuilder=En;exports.RichTextValue=Qt;exports.RxDisposable=c_;exports.SHEET_EDITOR_UNITS=C0;exports.SectionType=xc;exports.SheetTypes=Tc;exports.SheetViewModel=qh;exports.SliceBodyType=ra;exports.SlideDataModel=ca;exports.SpacingRule=$c;exports.SpecialShapes=bc;exports.Styles=Bh;exports.THEME_COLORS=_u;exports.TabStopAlignment=jc;exports.TableAlignmentType=Yc;exports.TableLayoutType=Gc;exports.TableRowHeightRule=zc;exports.TableSizeType=Wc;exports.TableTextWrapType=Vc;exports.TextDecoration=yc;exports.TextDecorationBuilder=Jt;exports.TextDirection=Tr;exports.TextDirectionType=Pc;exports.TextStyleBuilder=nn;exports.TextStyleValue=Gr;exports.TextX=Me;exports.TextXActionType=q;exports.ThemeColor=ys;exports.ThemeColorType=it;exports.ThemeColors=Ys;exports.ThemeService=Ps;exports.Tools=Z;exports.UndoCommand=cd;exports.UndoCommandId=ld;exports.UnitModel=Ws;exports.Univer=RI;exports.UniverInstanceType=Oe;exports.UpdateDocsAttributeType=Ee;exports.UserManagerService=Dr;exports.VerticalAlign=_n;exports.VerticalAlignmentType=Kc;exports.Worksheet=xr;exports.WrapStrategy=In;exports.WrapTextType=Fc;exports.addLinkToDocumentModel=$h;exports.afterInitApply=W_;exports.afterTime=H_;exports.awaitTime=cI;exports.binSearchFirstGreaterThanTarget=mu;exports.binarySearchArray=Y_;exports.bufferDebounceTime=$_;exports.cellToRange=bp;exports.characterSpacingControlType=eu;exports.checkForSubstrings=Tp;exports.checkIfMove=V_;exports.checkParagraphHasBullet=uE;exports.checkParagraphHasIndent=hE;exports.checkParagraphHasIndentByStyle=Au;exports.codeToBlob=G_;exports.composeBody=Xi;exports.composeInterceptors=kl;exports.composeStyles=ar;exports.concatMatrixArray=gp;exports.convertBodyToHtml=z_;exports.convertCellToRange=Ou;exports.convertObservableToBehaviorSubject=j_;exports.covertCellValue=Bi;exports.covertCellValues=Ap;exports.covertTextRunToHtml=xi;exports.createAsyncInterceptorKey=Vd;exports.createDefaultUser=Us;exports.createDocumentModelWithStyle=Sr;exports.createInterceptorKey=Yd;exports.createInternalEditorID=$d;exports.createREGEXFromWildChar=S_;exports.createRowColIter=Vi;exports.customNameCharacterCheck=aI;exports.dayjs=zt;exports.debounce=Xg;exports.dedupe=Td;exports.dedupeBy=yd;exports.deepCompare=Io;exports.delayAnimationFrame=uI;exports.deleteContent=yu;exports.extractPureTextFromCell=Zh;exports.fromCallback=du;exports.fromEventSubject=sR;exports.fromObservable=l_;exports.generateRandomId=tt;exports.get=rc;exports.getArrayLength=tn;exports.getBodySlice=yt;exports.getBodySliceHtml=cs;exports.getBorderStyleType=Op;exports.getCellCoordByIndexSimple=da;exports.getCellInfoInMergeData=dp;exports.getCellPositionByIndexSimple=_I;exports.getCellValueType=cp;exports.getCellWithCoordByIndexCore=Un;exports.getColorStyle=Dt;exports.getCustomBlockSlice=Sh;exports.getCustomDecorationSlice=vh;exports.getCustomRangeSlice=Oh;exports.getDocsUpdateBody=vp;exports.getIntersectRange=rh;exports.getNumfmtParseValueFilter=m0;exports.getOriginCellValue=UR;exports.getParagraphsSlice=Ih;exports.getPlainText=Js;exports.getReverseDirection=O_;exports.getSectionBreakSlice=lC;exports.getTableSlice=Rh;exports.getTextRunSlice=xs;exports.getTransformOffsetX=fd;exports.getTransformOffsetY=md;exports.getWorksheetUID=BR;exports.groupBy=Ld;exports.handleStyleToString=Sp;exports.hashAlgorithm=fE;exports.horizontalLineSegmentsSubtraction=zs;exports.insertMatrixArray=mp;exports.insertTextToContent=Tu;exports.invertColorByHSL=ef;exports.invertColorByMatrix=nf;exports.isBlackColor=ap;exports.isBooleanString=Bd;exports.isCellCoverable=Fi;exports.isCellV=Ru;exports.isDefaultFormat=u0;exports.isEmptyCell=vu;exports.isFormulaId=Ip;exports.isFormulaString=wu;exports.isICellData=Cu;exports.isInternalEditorID=xl;exports.isNodeEnv=I_;exports.isNotNullOrUndefined=Hh;exports.isNullCell=up;exports.isNumeric=ac;exports.isPatternEqualWithoutDecimal=h0;exports.isRangesEqual=CR;exports.isRealNum=dE;exports.isSafeNumeric=r_;exports.isSameStyleTextRun=bu;exports.isTextFormat=c0;exports.isUnitRangesEqual=RR;exports.isValidRange=wp;exports.isWhiteColor=lp;exports.makeArray=Dd;exports.makeCellRangeToRangeData=Rp;exports.makeCellToSelection=Cp;exports.makeCustomRangeStream=SC;exports.mapObjectMatrix=fp;exports.merge=Hs;exports.mergeLocales=mE;exports.mergeOverrideWithDependencies=sd;exports.mergeSets=o_;exports.mergeWith=Qg;exports.mergeWorksheetSnapshotWithDefault=Xh;exports.mixinClass=n_;exports.moveMatrixArray=ki;exports.moveRangeByOffset=M0;exports.nameCharacterCheck=oI;exports.normalizeBody=cC;exports.normalizeTextRuns=Wr;exports.numberToABC=Y0;exports.numberToListABC=G0;exports.numfmt=l0;exports.queryObjectMatrix=$0;exports.registerDependencies=Hd;exports.remove=Ur;exports.repeatStringNumTimes=ih;exports.replaceInDocumentBody=eR;exports.requestImmediateMacroTask=i_;exports.rotate=Md;exports.searchArray=lr;exports.searchInOrderedArray=fu;exports.selectionToArray=hp;exports.sequence=cc;exports.sequenceAsync=lc;exports.sequenceExecute=Gs;exports.sequenceExecuteAsync=B_;exports.set=t_;exports.shallowEqual=Pl;exports.skipParseTagNames=pI;exports.sliceMatrixArray=_p;exports.sortRules=V0;exports.sortRulesByDesc=z0;exports.sortRulesFactory=jr;exports.spliceArray=Pi;exports.splitIntoGrid=ta;exports.takeAfter=Di;exports.textDiff=ia;exports.throttle=Wd;exports.toDisposable=We;exports.touchDependencies=Ul;exports.updateAttributeByDelete=wh;exports.updateAttributeByInsert=bh;exports.willLoseNumericPrecision=s_;Object.keys(Ae).forEach(e=>{e!=="default"&&!Object.prototype.hasOwnProperty.call(exports,e)&&Object.defineProperty(exports,e,{enumerable:!0,get:()=>Ae[e]})});
