(function(f,Re){typeof exports=="object"&&typeof module<"u"?Re(exports,require("@wendellhu/redi"),require("rxjs"),require("rxjs/operators"),require("@univerjs/themes")):typeof define=="function"&&define.amd?define(["exports","@wendellhu/redi","rxjs","rxjs/operators","@univerjs/themes"],Re):(f=typeof globalThis<"u"?globalThis:f||self,Re(f.UniverCore={},f["@wendellhu/redi"],f.rxjs,f.rxjs.operators,f.UniverThemes))})(this,(function(f,Re,oe,Kr,Xr){"use strict";var CI=Object.defineProperty;var RI=(f,Re,oe)=>Re in f?CI(f,Re,{enumerable:!0,configurable:!0,writable:!0,value:oe}):f[Re]=oe;var C=(f,Re,oe)=>RI(f,typeof Re!="symbol"?Re+"":Re,oe);var Cd,Rd;function Sd(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in e)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(e,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}const Lt=typeof global<"u"?global:typeof self<"u"?self:window;function Od(){const t=new Map;let n=0;typeof Lt.requestIdleCallback!="function"&&(Lt.requestIdleCallback=function(s){const i=Date.now(),o=++n,a=setTimeout(function(){t.delete(o);const c=Math.max(0,50-(Date.now()-i));s({didTimeout:c===0,timeRemaining(){return c}})},1);return t.set(o,a),o}),typeof Lt.cancelIdleCallback!="function"&&(Lt.cancelIdleCallback=function(s){const i=t.get(s);i!==void 0&&(clearTimeout(i),t.delete(s))})}function vd(){typeof Lt.Array.prototype.findLastIndex!="function"&&(Lt.Array.prototype.findLastIndex=function(t,n){if(this==null)throw new TypeError("Array.prototype.findLastIndex called on null or undefined");if(typeof t!="function")throw new TypeError("callback must be a function");const r=this.length>>>0;for(let s=r-1;s>=0;s--)if(s in this&&t.call(n,this[s],s,this))return s;return-1}),typeof Lt.Array.prototype.findLast!="function"&&(Lt.Array.prototype.findLast=function(t,n){const r=this.findLastIndex(t,n);return r!==-1?this[r]:void 0})}function wd(){typeof Lt.String.prototype.at!="function"&&(Lt.String.prototype.at=function(t){if(this==null)throw new TypeError("String.prototype.at called on null or undefined");const n=this.length;if(t<0&&(t=n+t),!(t<0||t>=n))return this.charAt(t)})}function bd(){Od(),vd(),wd()}function tr(e,t){const n=e.indexOf(t);return n>-1?(e.splice(n,1),!0):!1}function Ad(e){const t=new Set,n=[];for(const r of e)t.has(r)||(t.add(r),n.push(r));return n}function Td(e,t){const n=new Set,r=[];for(const s of e){const i=t(s);n.has(i)||(n.add(i),r.push(s))}return r}function yd(e,t){for(let n=e.length-1;n>-1;n--){const r=e[n];if(t(r,n))return r}return null}function Nd(e,t){if(e.length===0)return e;const n=t%e.length;return e.slice(n).concat(e.slice(0,n))}function Md(e,t){const n=new Map;return e.forEach(r=>{const s=t(r);let i=n.get(s);n.has(s)||(i=[],n.set(s,i)),i.push(r)}),n}function Ld(e){return Array.isArray(e)?e:[e]}function mt(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ni,ma;function Dd(){if(ma)return ni;ma=1;var e=function(t){if(t=t||{},this.Promise=t.Promise||Promise,this.queues=Object.create(null),this.domainReentrant=t.domainReentrant||!1,this.domainReentrant){if(typeof process>"u"||typeof process.domain>"u")throw new Error("Domain-reentrant locks require `process.domain` to exist. Please flip `opts.domainReentrant = false`, use a NodeJS version that still implements Domain, or install a browser polyfill.");this.domains=Object.create(null)}this.timeout=t.timeout||e.DEFAULT_TIMEOUT,this.maxOccupationTime=t.maxOccupationTime||e.DEFAULT_MAX_OCCUPATION_TIME,this.maxExecutionTime=t.maxExecutionTime||e.DEFAULT_MAX_EXECUTION_TIME,t.maxPending===1/0||Number.isInteger(t.maxPending)&&t.maxPending>=0?this.maxPending=t.maxPending:this.maxPending=e.DEFAULT_MAX_PENDING};return e.DEFAULT_TIMEOUT=0,e.DEFAULT_MAX_OCCUPATION_TIME=0,e.DEFAULT_MAX_EXECUTION_TIME=0,e.DEFAULT_MAX_PENDING=1e3,e.prototype.acquire=function(t,n,r,s){if(Array.isArray(t))return this._acquireBatch(t,n,r,s);if(typeof n!="function")throw new Error("You must pass a function to execute");var i=null,o=null,a=null;typeof r!="function"&&(s=r,r=null,a=new this.Promise(function(x,Y){i=x,o=Y})),s=s||{};var l=!1,c=null,u=null,h=null,d=this,m=function(x,Y,O){u&&(clearTimeout(u),u=null),h&&(clearTimeout(h),h=null),x&&(d.queues[t]&&d.queues[t].length===0&&delete d.queues[t],d.domainReentrant&&delete d.domains[t]),l||(a?Y?o(Y):i(O):typeof r=="function"&&r(Y,O),l=!0),x&&d.queues[t]&&d.queues[t].length>0&&d.queues[t].shift()()},_=function(x){if(l)return m(x);c&&(clearTimeout(c),c=null),d.domainReentrant&&x&&(d.domains[t]=process.domain);var Y=s.maxExecutionTime||d.maxExecutionTime;if(Y&&(h=setTimeout(function(){d.queues[t]&&m(x,new Error("Maximum execution time is exceeded "+t))},Y)),n.length===1){var O=!1;try{n(function(R,b){O||(O=!0,m(x,R,b))})}catch(R){O||(O=!0,m(x,R))}}else d._promiseTry(function(){return n()}).then(function(R){m(x,void 0,R)},function(R){m(x,R)})};d.domainReentrant&&process.domain&&(_=process.domain.bind(_));var p=s.maxPending||d.maxPending;if(!d.queues[t])d.queues[t]=[],_(!0);else if(d.domainReentrant&&process.domain&&process.domain===d.domains[t])_(!1);else if(d.queues[t].length>=p)m(!1,new Error("Too many pending tasks in queue "+t));else{var I=function(){_(!0)};s.skipQueue?d.queues[t].unshift(I):d.queues[t].push(I);var A=s.timeout||d.timeout;A&&(c=setTimeout(function(){c=null,m(!1,new Error("async-lock timed out in queue "+t))},A))}var B=s.maxOccupationTime||d.maxOccupationTime;if(B&&(u=setTimeout(function(){d.queues[t]&&m(!1,new Error("Maximum occupation time is exceeded in queue "+t))},B)),a)return a},e.prototype._acquireBatch=function(t,n,r,s){typeof r!="function"&&(s=r,r=null);var i=this,o=function(l,c){return function(u){i.acquire(l,c,u,s)}},a=t.reduceRight(function(l,c){return o(c,l)},n);if(typeof r=="function")a(r);else return new this.Promise(function(l,c){a.length===1?a(function(u,h){u?c(u):l(h)}):l(a())})},e.prototype.isBusy=function(t){return t?!!this.queues[t]:Object.keys(this.queues).length>0},e.prototype._promiseTry=function(t){try{return this.Promise.resolve(t())}catch(n){return this.Promise.reject(n)}},ni=e,ni}var ri,ga;function Ud(){return ga||(ga=1,ri=Dd()),ri}var Pd=Ud();const kd=mt(Pd),Fd=new Set(["true","false"]);function xd(e){return Fd.has(e.toLowerCase())}const nr="__INTERNAL_EDITOR__",si=`${nr}DOCS_NORMAL`,ii=`${nr}DOCS_FORMULA_BAR`,_a=`${nr}ZEN_EDITOR`,pa=`\r
`,Ea="isRowStylePrecedeColumnStyle",Ca=Symbol("AUTO_HEIGHT_FOR_MERGED_CELLS");function Bd(e){return`${nr}${e}`}function Ra(e){return e.startsWith(nr)}function $d(e,t){t.forEach(n=>e.add(n))}function Ia(e,t){t.forEach(([n])=>{e.has(n)&&e.get(n)})}function Sa(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||!e||typeof t!="object"||!t)return!1;const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;const s=Object.prototype.hasOwnProperty.bind(t);for(let i=0;i<n.length;i++){const o=n[i];if(!s(o))return!1;const a=e[o],l=t[o];if(a!==l)return!1}return!0}class qr extends Error{constructor(t){super(t),this.name="CustomCommandExecutionError"}}class Hd extends qr{constructor(){super("Canceled by facade"),this.name="CanceledError"}}function jd(e,t=16){let n=0,r=null;return function(...i){const o=Date.now();o-n<t?(r&&clearTimeout(r),r=setTimeout(()=>{n=o,e.apply(this,i)},t)):(n=o,e.apply(this,i))}}var bn=(e=>(e[e.Style=1]="Style",e[e.Value=2]="Value",e))(bn||{});function Wd(e){return`sheet_interceptor_${e}`}const Oa=e=>function(t,n){let r=-1,s=t;for(let i=0;i<=e.length;i++){if(i<=r)throw new Error("[SheetInterceptorService]: next() called multiple times!");if(r=i,i===e.length)return s;const o=e[i];let a=!1;if(s=o.handler(s,n,l=>(a=!0,l)),!a)break}return s};class Yd{constructor(t){C(this,"_interceptorsByName",new Map);C(this,"_interceptorPoints");this._interceptorPoints=t}fetchThroughInterceptors(t,n){const r=t;let s=this._interceptorsByName.get(r);return n&&(s=s.filter(n)),Oa(s||[])}intercept(t,n){const r=t;this._interceptorsByName.has(r)||this._interceptorsByName.set(r,[]);const s=this._interceptorsByName.get(r);return s.push(n),this._interceptorsByName.set(r,s.sort((i,o)=>{var a,l;return((a=o.priority)!=null?a:0)-((l=i.priority)!=null?l:0)})),()=>tr(this._interceptorsByName.get(r),n)}getInterceptPoints(){return this._interceptorPoints}dispose(){this._interceptorsByName.clear()}}function Gd(e){return`sheet_async_interceptor_${e}`}const Vd=e=>async function(t,n){let r=-1,s=t;for(let i=0;i<=e.length;i++){if(i<=r)throw new Error("[SheetInterceptorService]: next() called multiple times!");if(r=i,i===e.length)return s;const o=e[i];let a=!1;if(s=await o.handler(s,n,async l=>(a=!0,l)),!a)break}return s};class zd{constructor(t){C(this,"_asyncInterceptorsByName",new Map);C(this,"_asyncInterceptorPoints");this._asyncInterceptorPoints=t}fetchThroughAsyncInterceptors(t,n){const r=t;let s=this._asyncInterceptorsByName.get(r);return n&&(s=s.filter(n)),Vd(s||[])}async interceptAsync(t,n){const r=t;this._asyncInterceptorsByName.has(r)||this._asyncInterceptorsByName.set(r,[]);const s=this._asyncInterceptorsByName.get(r);return s.push(n),this._asyncInterceptorsByName.set(r,s.sort((i,o)=>{var a,l;return((a=o.priority)!=null?a:0)-((l=i.priority)!=null?l:0)})),()=>tr(this._asyncInterceptorsByName.get(r),n)}getInterceptPoints(){return this._asyncInterceptorPoints}dispose(){this._asyncInterceptorsByName.clear()}}function va(e){return e.map(t=>t/255)}function wa(e){return e.map(t=>Math.round(t*255))}function Kd([e,t,n]){const r=Math.max(e,t,n),s=Math.min(e,t,n),i=(r+s)/2;let o=0,a=0;if(r!==s){const l=r-s;switch(a=i>.5?l/(2-r-s):l/(r+s),r){case e:o=(t-n)/l+(t<n?6:0);break;case t:o=(n-e)/l+2;break;case n:o=(e-t)/l+4;break}o/=6}return[o,a,i]}function Zr(e,t,n){const r=[e,t,n].map(s=>s<=.03928?s/12.92:((s+.055)/1.055)**2.4);return .2126*r[0]+.7152*r[1]+.0722*r[2]}function ba(e,t){return(Math.max(e,t)+.05)/(Math.min(e,t)+.05)}function Xd(e,t,n){let r,s,i;if(t===0)r=s=i=n;else{const o=(c,u,h)=>{let d=h;return d<0&&(d+=1),d>1&&(d-=1),d<.16666666666666666?c+(u-c)*6*d:d<.5?u:d<.6666666666666666?c+(u-c)*(.6666666666666666-d)*6:c},a=n<.5?n*(1+t):n+t-n*t,l=2*n-a;r=o(l,a,e+1/3),s=o(l,a,e),i=o(l,a,e-1/3)}return[r,s,i]}const oi={r:1,g:1,b:1},ai={r:0,g:0,b:0},qd=Zr(oi.r,oi.g,oi.b),Zd=Zr(ai.r,ai.g,ai.b);function Jd(e){const t=Zr(e[0],e[1],e[2]),n=ba(qd,t),r=Kd(e);let s=1-r[2],i,o,a;do i=Xd(r[0],r[1],s),o=Zr(i[0],i[1],i[2]),a=ba(o,Zd),s+=.01;while(s<=1&&s>=0&&Math.abs(a-n)<.01);return i}function Qd(e){return wa(Jd(va(e)))}const gt=[[.333,-.667,-.667,0,1],[-.667,.333,-.667,0,1],[-.667,-.667,.333,0,1],[0,0,0,1,0]];function ef(e){const t=e[0],n=e[1],r=e[2];let s=[gt[0][0]*t+gt[0][1]*n+gt[0][2]*r+gt[0][4],gt[1][0]*t+gt[1][1]*n+gt[1][2]*r+gt[1][4],gt[2][0]*t+gt[2][1]*n+gt[2][2]*r+gt[2][4]];return s=s.map(i=>i>1?1:i<0?0:i),s}function tf(e){return wa(ef(va(e)))}var Aa=typeof global=="object"&&global&&global.Object===Object&&global,nf=typeof self=="object"&&self&&self.Object===Object&&self,un=Aa||nf||Function("return this")(),An=un.Symbol,Ta=Object.prototype,rf=Ta.hasOwnProperty,sf=Ta.toString,rr=An?An.toStringTag:void 0;function of(e){var t=rf.call(e,rr),n=e[rr];try{e[rr]=void 0;var r=!0}catch{}var s=sf.call(e);return r&&(t?e[rr]=n:delete e[rr]),s}var af=Object.prototype,lf=af.toString;function cf(e){return lf.call(e)}var uf="[object Null]",hf="[object Undefined]",ya=An?An.toStringTag:void 0;function sr(e){return e==null?e===void 0?hf:uf:ya&&ya in Object(e)?of(e):cf(e)}function Tn(e){return e!=null&&typeof e=="object"}var df="[object Symbol]";function Jr(e){return typeof e=="symbol"||Tn(e)&&sr(e)==df}function ff(e,t){for(var n=-1,r=e==null?0:e.length,s=Array(r);++n<r;)s[n]=t(e[n],n,e);return s}var yn=Array.isArray,Na=An?An.prototype:void 0,Ma=Na?Na.toString:void 0;function La(e){if(typeof e=="string")return e;if(yn(e))return ff(e,La)+"";if(Jr(e))return Ma?Ma.call(e):"";var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var mf=/\s/;function gf(e){for(var t=e.length;t--&&mf.test(e.charAt(t)););return t}var _f=/^\s+/;function pf(e){return e&&e.slice(0,gf(e)+1).replace(_f,"")}function _t(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Da=NaN,Ef=/^[-+]0x[0-9a-f]+$/i,Cf=/^0b[01]+$/i,Rf=/^0o[0-7]+$/i,If=parseInt;function Ua(e){if(typeof e=="number")return e;if(Jr(e))return Da;if(_t(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=_t(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=pf(e);var n=Cf.test(e);return n||Rf.test(e)?If(e.slice(2),n?2:8):Ef.test(e)?Da:+e}function Pa(e){return e}var Sf="[object AsyncFunction]",Of="[object Function]",vf="[object GeneratorFunction]",wf="[object Proxy]";function li(e){if(!_t(e))return!1;var t=sr(e);return t==Of||t==vf||t==Sf||t==wf}var ci=un["__core-js_shared__"],ka=(function(){var e=/[^.]+$/.exec(ci&&ci.keys&&ci.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""})();function bf(e){return!!ka&&ka in e}var Af=Function.prototype,Tf=Af.toString;function yf(e){if(e!=null){try{return Tf.call(e)}catch{}try{return e+""}catch{}}return""}var Nf=/[\\^$.*+?()[\]{}|]/g,Mf=/^\[object .+?Constructor\]$/,Lf=Function.prototype,Df=Object.prototype,Uf=Lf.toString,Pf=Df.hasOwnProperty,kf=RegExp("^"+Uf.call(Pf).replace(Nf,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Ff(e){if(!_t(e)||bf(e))return!1;var t=li(e)?kf:Mf;return t.test(yf(e))}function xf(e,t){return e==null?void 0:e[t]}function ui(e,t){var n=xf(e,t);return Ff(n)?n:void 0}var Fa=Object.create,Bf=(function(){function e(){}return function(t){if(!_t(t))return{};if(Fa)return Fa(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}})();function $f(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function Hf(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}var jf=800,Wf=16,Yf=Date.now;function Gf(e){var t=0,n=0;return function(){var r=Yf(),s=Wf-(r-n);if(n=r,s>0){if(++t>=jf)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}function Vf(e){return function(){return e}}var Qr=(function(){try{var e=ui(Object,"defineProperty");return e({},"",{}),e}catch{}})(),zf=Qr?function(e,t){return Qr(e,"toString",{configurable:!0,enumerable:!1,value:Vf(t),writable:!0})}:Pa,Kf=Gf(zf),Xf=9007199254740991,qf=/^(?:0|[1-9]\d*)$/;function hi(e,t){var n=typeof e;return t=t==null?Xf:t,!!t&&(n=="number"||n!="symbol"&&qf.test(e))&&e>-1&&e%1==0&&e<t}function di(e,t,n){t=="__proto__"&&Qr?Qr(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function es(e,t){return e===t||e!==e&&t!==t}var Zf=Object.prototype,Jf=Zf.hasOwnProperty;function xa(e,t,n){var r=e[t];(!(Jf.call(e,t)&&es(r,n))||n===void 0&&!(t in e))&&di(e,t,n)}function Qf(e,t,n,r){var s=!n;n||(n={});for(var i=-1,o=t.length;++i<o;){var a=t[i],l=void 0;l===void 0&&(l=e[a]),s?di(n,a,l):xa(n,a,l)}return n}var Ba=Math.max;function em(e,t,n){return t=Ba(t===void 0?e.length-1:t,0),function(){for(var r=arguments,s=-1,i=Ba(r.length-t,0),o=Array(i);++s<i;)o[s]=r[t+s];s=-1;for(var a=Array(t+1);++s<t;)a[s]=r[s];return a[t]=n(o),$f(e,this,a)}}function tm(e,t){return Kf(em(e,t,Pa),e+"")}var nm=9007199254740991;function $a(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=nm}function fi(e){return e!=null&&$a(e.length)&&!li(e)}function rm(e,t,n){if(!_t(n))return!1;var r=typeof t;return(r=="number"?fi(n)&&hi(t,n.length):r=="string"&&t in n)?es(n[t],e):!1}function Ha(e){return tm(function(t,n){var r=-1,s=n.length,i=s>1?n[s-1]:void 0,o=s>2?n[2]:void 0;for(i=e.length>3&&typeof i=="function"?(s--,i):void 0,o&&rm(n[0],n[1],o)&&(i=s<3?void 0:i,s=1),t=Object(t);++r<s;){var a=n[r];a&&e(t,a,r,i)}return t})}var sm=Object.prototype;function ja(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||sm;return e===n}function im(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}var om="[object Arguments]";function Wa(e){return Tn(e)&&sr(e)==om}var Ya=Object.prototype,am=Ya.hasOwnProperty,lm=Ya.propertyIsEnumerable,mi=Wa((function(){return arguments})())?Wa:function(e){return Tn(e)&&am.call(e,"callee")&&!lm.call(e,"callee")};function cm(){return!1}var Ga=typeof f=="object"&&f&&!f.nodeType&&f,Va=Ga&&typeof module=="object"&&module&&!module.nodeType&&module,um=Va&&Va.exports===Ga,za=um?un.Buffer:void 0,hm=za?za.isBuffer:void 0,Ka=hm||cm,dm="[object Arguments]",fm="[object Array]",mm="[object Boolean]",gm="[object Date]",_m="[object Error]",pm="[object Function]",Em="[object Map]",Cm="[object Number]",Rm="[object Object]",Im="[object RegExp]",Sm="[object Set]",Om="[object String]",vm="[object WeakMap]",wm="[object ArrayBuffer]",bm="[object DataView]",Am="[object Float32Array]",Tm="[object Float64Array]",ym="[object Int8Array]",Nm="[object Int16Array]",Mm="[object Int32Array]",Lm="[object Uint8Array]",Dm="[object Uint8ClampedArray]",Um="[object Uint16Array]",Pm="[object Uint32Array]",xe={};xe[Am]=xe[Tm]=xe[ym]=xe[Nm]=xe[Mm]=xe[Lm]=xe[Dm]=xe[Um]=xe[Pm]=!0,xe[dm]=xe[fm]=xe[wm]=xe[mm]=xe[bm]=xe[gm]=xe[_m]=xe[pm]=xe[Em]=xe[Cm]=xe[Rm]=xe[Im]=xe[Sm]=xe[Om]=xe[vm]=!1;function km(e){return Tn(e)&&$a(e.length)&&!!xe[sr(e)]}function Fm(e){return function(t){return e(t)}}var Xa=typeof f=="object"&&f&&!f.nodeType&&f,ir=Xa&&typeof module=="object"&&module&&!module.nodeType&&module,xm=ir&&ir.exports===Xa,gi=xm&&Aa.process,qa=(function(){try{var e=ir&&ir.require&&ir.require("util").types;return e||gi&&gi.binding&&gi.binding("util")}catch{}})(),Za=qa&&qa.isTypedArray,Ja=Za?Fm(Za):km;function Bm(e,t){var n=yn(e),r=!n&&mi(e),s=!n&&!r&&Ka(e),i=!n&&!r&&!s&&Ja(e),o=n||r||s||i,a=o?im(e.length,String):[],l=a.length;for(var c in e)o&&(c=="length"||s&&(c=="offset"||c=="parent")||i&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||hi(c,l))||a.push(c);return a}function $m(e,t){return function(n){return e(t(n))}}function Hm(e){var t=[];if(e!=null)for(var n in Object(e))t.push(n);return t}var jm=Object.prototype,Wm=jm.hasOwnProperty;function Ym(e){if(!_t(e))return Hm(e);var t=ja(e),n=[];for(var r in e)r=="constructor"&&(t||!Wm.call(e,r))||n.push(r);return n}function Qa(e){return fi(e)?Bm(e):Ym(e)}var Gm=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Vm=/^\w*$/;function zm(e,t){if(yn(e))return!1;var n=typeof e;return n=="number"||n=="symbol"||n=="boolean"||e==null||Jr(e)?!0:Vm.test(e)||!Gm.test(e)||t!=null&&e in Object(t)}var or=ui(Object,"create");function Km(){this.__data__=or?or(null):{},this.size=0}function Xm(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var qm="__lodash_hash_undefined__",Zm=Object.prototype,Jm=Zm.hasOwnProperty;function Qm(e){var t=this.__data__;if(or){var n=t[e];return n===qm?void 0:n}return Jm.call(t,e)?t[e]:void 0}var eg=Object.prototype,tg=eg.hasOwnProperty;function ng(e){var t=this.__data__;return or?t[e]!==void 0:tg.call(t,e)}var rg="__lodash_hash_undefined__";function sg(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=or&&t===void 0?rg:t,this}function hn(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}hn.prototype.clear=Km,hn.prototype.delete=Xm,hn.prototype.get=Qm,hn.prototype.has=ng,hn.prototype.set=sg;function ig(){this.__data__=[],this.size=0}function ts(e,t){for(var n=e.length;n--;)if(es(e[n][0],t))return n;return-1}var og=Array.prototype,ag=og.splice;function lg(e){var t=this.__data__,n=ts(t,e);if(n<0)return!1;var r=t.length-1;return n==r?t.pop():ag.call(t,n,1),--this.size,!0}function cg(e){var t=this.__data__,n=ts(t,e);return n<0?void 0:t[n][1]}function ug(e){return ts(this.__data__,e)>-1}function hg(e,t){var n=this.__data__,r=ts(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}function $t(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}$t.prototype.clear=ig,$t.prototype.delete=lg,$t.prototype.get=cg,$t.prototype.has=ug,$t.prototype.set=hg;var el=ui(un,"Map");function dg(){this.size=0,this.__data__={hash:new hn,map:new(el||$t),string:new hn}}function fg(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function ns(e,t){var n=e.__data__;return fg(t)?n[typeof t=="string"?"string":"hash"]:n.map}function mg(e){var t=ns(this,e).delete(e);return this.size-=t?1:0,t}function gg(e){return ns(this,e).get(e)}function _g(e){return ns(this,e).has(e)}function pg(e,t){var n=ns(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}function Xt(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Xt.prototype.clear=dg,Xt.prototype.delete=mg,Xt.prototype.get=gg,Xt.prototype.has=_g,Xt.prototype.set=pg;var Eg="Expected a function";function _i(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(Eg);var n=function(){var r=arguments,s=t?t.apply(this,r):r[0],i=n.cache;if(i.has(s))return i.get(s);var o=e.apply(this,r);return n.cache=i.set(s,o)||i,o};return n.cache=new(_i.Cache||Xt),n}_i.Cache=Xt;var Cg=500;function Rg(e){var t=_i(e,function(r){return n.size===Cg&&n.clear(),r}),n=t.cache;return t}var Ig=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Sg=/\\(\\)?/g,Og=Rg(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(Ig,function(n,r,s,i){t.push(s?i.replace(Sg,"$1"):r||n)}),t});function vg(e){return e==null?"":La(e)}function tl(e,t){return yn(e)?e:zm(e,t)?[e]:Og(vg(e))}function nl(e){if(typeof e=="string"||Jr(e))return e;var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}function wg(e,t){t=tl(t,e);for(var n=0,r=t.length;e!=null&&n<r;)e=e[nl(t[n++])];return n&&n==r?e:void 0}function rl(e,t,n){var r=e==null?void 0:wg(e,t);return r===void 0?n:r}var sl=$m(Object.getPrototypeOf,Object),bg="[object Object]",Ag=Function.prototype,Tg=Object.prototype,il=Ag.toString,yg=Tg.hasOwnProperty,Ng=il.call(Object);function Mg(e){if(!Tn(e)||sr(e)!=bg)return!1;var t=sl(e);if(t===null)return!0;var n=yg.call(t,"constructor")&&t.constructor;return typeof n=="function"&&n instanceof n&&il.call(n)==Ng}function Lg(){this.__data__=new $t,this.size=0}function Dg(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}function Ug(e){return this.__data__.get(e)}function Pg(e){return this.__data__.has(e)}var kg=200;function Fg(e,t){var n=this.__data__;if(n instanceof $t){var r=n.__data__;if(!el||r.length<kg-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new Xt(r)}return n.set(e,t),this.size=n.size,this}function Nn(e){var t=this.__data__=new $t(e);this.size=t.size}Nn.prototype.clear=Lg,Nn.prototype.delete=Dg,Nn.prototype.get=Ug,Nn.prototype.has=Pg,Nn.prototype.set=Fg;var ol=typeof f=="object"&&f&&!f.nodeType&&f,al=ol&&typeof module=="object"&&module&&!module.nodeType&&module,xg=al&&al.exports===ol,ll=xg?un.Buffer:void 0;ll&&ll.allocUnsafe;function Bg(e,t){return e.slice()}var cl=un.Uint8Array;function $g(e){var t=new e.constructor(e.byteLength);return new cl(t).set(new cl(e)),t}function Hg(e,t){var n=$g(e.buffer);return new e.constructor(n,e.byteOffset,e.length)}function jg(e){return typeof e.constructor=="function"&&!ja(e)?Bf(sl(e)):{}}function Wg(e){return function(t,n,r){for(var s=-1,i=Object(t),o=r(t),a=o.length;a--;){var l=o[++s];if(n(i[l],l,i)===!1)break}return t}}var Yg=Wg(),pi=function(){return un.Date.now()},Gg="Expected a function",Vg=Math.max,zg=Math.min;function Kg(e,t,n){var r,s,i,o,a,l,c=0,u=!1,h=!1,d=!0;if(typeof e!="function")throw new TypeError(Gg);t=Ua(t)||0,_t(n)&&(u=!!n.leading,h="maxWait"in n,i=h?Vg(Ua(n.maxWait)||0,t):i,d="trailing"in n?!!n.trailing:d);function m(R){var b=r,y=s;return r=s=void 0,c=R,o=e.apply(y,b),o}function _(R){return c=R,a=setTimeout(A,t),u?m(R):o}function p(R){var b=R-l,y=R-c,$=t-b;return h?zg($,i-y):$}function I(R){var b=R-l,y=R-c;return l===void 0||b>=t||b<0||h&&y>=i}function A(){var R=pi();if(I(R))return B(R);a=setTimeout(A,p(R))}function B(R){return a=void 0,d&&r?m(R):(r=s=void 0,o)}function x(){a!==void 0&&clearTimeout(a),c=0,r=l=s=a=void 0}function Y(){return a===void 0?o:B(pi())}function O(){var R=pi(),b=I(R);if(r=arguments,s=this,l=R,b){if(a===void 0)return _(l);if(h)return clearTimeout(a),a=setTimeout(A,t),m(l)}return a===void 0&&(a=setTimeout(A,t)),o}return O.cancel=x,O.flush=Y,O}function Ei(e,t,n){(n!==void 0&&!es(e[t],n)||n===void 0&&!(t in e))&&di(e,t,n)}function Xg(e){return Tn(e)&&fi(e)}function Ci(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}function qg(e){return Qf(e,Qa(e))}function Zg(e,t,n,r,s,i,o){var a=Ci(e,n),l=Ci(t,n),c=o.get(l);if(c){Ei(e,n,c);return}var u=i?i(a,l,n+"",e,t,o):void 0,h=u===void 0;if(h){var d=yn(l),m=!d&&Ka(l),_=!d&&!m&&Ja(l);u=l,d||m||_?yn(a)?u=a:Xg(a)?u=Hf(a):m?(h=!1,u=Bg(l)):_?(h=!1,u=Hg(l)):u=[]:Mg(l)||mi(l)?(u=a,mi(a)?u=qg(a):(!_t(a)||li(a))&&(u=jg(l))):h=!1}h&&(o.set(l,u),s(u,l,r,i,o),o.delete(l)),Ei(e,n,u)}function Ri(e,t,n,r,s){e!==t&&Yg(t,function(i,o){if(s||(s=new Nn),_t(i))Zg(e,t,o,n,Ri,r,s);else{var a=r?r(Ci(e,o),i,o+"",e,t,s):void 0;a===void 0&&(a=i),Ei(e,o,a)}},Qa)}var Jg=Ha(function(e,t,n,r){Ri(e,t,n,r)}),rs=Ha(function(e,t,n){Ri(e,t,n)});function Qg(e,t,n,r){if(!_t(e))return e;t=tl(t,e);for(var s=-1,i=t.length,o=i-1,a=e;a!=null&&++s<i;){var l=nl(t[s]),c=n;if(l==="__proto__"||l==="constructor"||l==="prototype")return e;if(s!=o){var u=a[l];c=void 0,c===void 0&&(c=_t(u)?u:hi(t[s+1])?[]:{})}xa(a,l,c),a=a[l]}return e}function e_(e,t,n){return e==null?e:Qg(e,t,n)}class dn{constructor(){C(this,"cursor",0)}reset(){return this.cursor=0,this}moveCursor(t){this.cursor+=t}moveCursorTo(t){this.cursor=t}}function t_(e,t){for(const n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}function ul(e){return/^-?\d+(\.\d+)?$/.test(e)}function n_(e){return ul(e)?Number(e)<=Number.MAX_SAFE_INTEGER:!1}function r_(e){return Number(e)>Number.MAX_SAFE_INTEGER||e.length>=18}class Ii{constructor(){C(this,"_data",[])}static create(){return new Ii}add(t){this._data.indexOf(t)>-1||this._data.push(t)}delete(t){const n=this._data.indexOf(t);this._data.splice(n,1)}getData(){return this._data}}class Si{constructor(){C(this,"_data",new Map)}static create(){return new Si}add(t,n){this._data.has(t)||this._data.set(t,n)}delete(t){this._data.delete(t)}getData(){return this._data}}function s_(e){const t=new MessageChannel;let n=!1;const r=()=>{n||e()};return t.port1.onmessage=r,t.port2.postMessage(null),()=>{n=!0,t.port1.onmessage=null,t.port1.close(),t.port2.close()}}async function hl(e){for(const[t,n]of e.entries())try{if(!await n())return{index:t,result:!1}}catch(r){return{index:t,result:!1,error:r}}return{result:!0,index:-1}}function dl(e){for(const[t,n]of e.entries())try{if(!n())return{index:t,result:!1}}catch(r){return{index:t,result:!1,error:r}}return{result:!0,index:-1}}function i_(e,t){return t.forEach(n=>e.add(n)),e}function o_(e){return e instanceof oe.Subscription||e instanceof oe.Subject||e&&"closed"in e&&typeof e.unsubscribe<"u"}function We(e){let t=!1;return e?o_(e)?{dispose:()=>e.unsubscribe()}:typeof e=="function"?{dispose:()=>{t||(t=!0,e())}}:e:We(()=>{})}function a_(e){return We(()=>{e.unsubscribe()})}class ss{constructor(){C(this,"_disposables",new Set)}add(t){const n=We(t);return this._disposables.add(n),{dispose:(r=!1)=>{r||n.dispose(),this._disposables.delete(n)}}}dispose(){this._disposables.forEach(t=>{t.dispose()}),this._disposables.clear()}}class ze{constructor(){C(this,"_disposed",!1);C(this,"_collection",new ss)}disposeWithMe(t){return this._collection.add(t)}ensureNotDisposed(){if(this._disposed)throw new Error("[Disposable]: object is disposed!")}dispose(){this._disposed||(this._disposed=!0,this._collection.dispose())}}class l_ extends ze{constructor(){super(...arguments);C(this,"dispose$",new oe.Subject)}dispose(){super.dispose(),this.dispose$.next(),this.dispose$.complete()}}class c_ extends ze{constructor(n){super();C(this,"_ref",0);this._rootDisposable=n}inc(){if(this._disposed)throw new Error("[RCDisposable]: should not ref to a disposed.");this._ref+=1}dec(){this._ref-=1,this._ref===0&&(this._rootDisposable.dispose(),this.dispose())}}var ve=(e=>(e[e.UNIVER_UNKNOWN=0]="UNIVER_UNKNOWN",e[e.UNIVER_DOC=1]="UNIVER_DOC",e[e.UNIVER_SHEET=2]="UNIVER_SHEET",e[e.UNIVER_SLIDE=3]="UNIVER_SLIDE",e[e.UNIVER_PROJECT=4]="UNIVER_PROJECT",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED",e))(ve||{}),Dt=(e=>(e[e.Reader=0]="Reader",e[e.Editor=1]="Editor",e[e.Owner=2]="Owner",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED",e))(Dt||{}),Oi=(e=>(e[e.SomeCollaborator=0]="SomeCollaborator",e[e.AllCollaborator=1]="AllCollaborator",e[e.OneSelf=2]="OneSelf",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED",e))(Oi||{});class is extends ze{}const u_="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let h_=e=>crypto.getRandomValues(new Uint8Array(e)),d_=(e,t,n)=>{let r=(2<<Math.log2(e.length-1))-1,s=-~(1.6*r*t/e.length);return(i=t)=>{let o="";for(;;){let a=n(s),l=s|0;for(;l--;)if(o+=e[a[l]&r]||"",o.length>=i)return o}}},f_=(e,t=21)=>d_(e,t|0,h_),m_=(e=21)=>{let t="",n=crypto.getRandomValues(new Uint8Array(e|=0));for(;e--;)t+=u_[n[e]&63];return t};const fl=new Set(["ac","ad","ae","aero","af","ag","ai","al","am","ao","aq","ar","arpa","as","asia","at","au","aw","ax","az","ba","bb","bd","be","bf","bg","bh","bi","biz","bj","bm","bn","bo","br","bs","bt","bv","bw","by","bz","ca","cat","cc","cd","cf","cg","ch","ci","ck","cl","cm","cn","co","com","coop","cr","cu","cv","cw","cx","cy","cz","de","dj","dk","dm","do","dz","ec","edu","ee","eg","er","es","et","eu","fi","fj","fk","fm","fo","fr","ga","gb","gd","ge","gf","gg","gh","gi","gl","gm","gn","gov","gp","gq","gr","gs","gt","gu","gw","gy","hk","hm","hn","hr","ht","hu","id","ie","il","im","in","info","int","io","iq","ir","is","it","je","jm","jo","jobs","jp","ke","kg","kh","ki","km","kn","kp","kr","kw","ky","kz","la","lb","lc","li","lk","lr","ls","lt","lu","lv","ly","ma","mc","md","me","mg","mh","mil","mk","ml","mm","mn","mo","mobi","mp","mq","mr","ms","mt","mu","museum","mv","mw","mx","my","mz","na","name","nc","ne","net","nf","ng","ni","nl","no","np","nr","nu","nz","om","onion","org","pa","pe","pf","pg","ph","pk","pl","pm","pn","post","pr","pro","ps","pt","pw","py","qa","re","ro","rs","ru","rw","sa","sb","sc","sd","se","sg","sh","si","sj","sk","sl","sm","sn","so","sr","ss","st","su","sv","sx","sy","sz","tc","td","tel","tf","tg","th","tj","tk","tl","tm","tn","to","tr","tt","tv","tw","tz","ua","ug","uk","us","uy","uz","va","vc","ve","vg","vi","vn","vu","wf","ws","yt","za","zm","zw"]),g_=new RegExp("^(?:(?:(?:https?|ftp):)?\\/\\/)?(?:\\S+(?::\\S*)?@)?(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z0-9\\u00a1-\\uffff][a-z0-9\\u00a1-\\uffff_-]{0,62})?[a-z0-9\\u00a1-\\uffff]\\.)+(?:[a-z\\u00a1-\\uffff]{2,}\\.?))(?::\\d{2,5})?(?:[/?#]\\S*)?$","i");function __(e){if(!Number.isNaN(+e))return!1;if(e.startsWith("http://localhost:3002")||e.startsWith("localhost:3002"))return!0;if(g_.test(e)){if(ml(e))return!0;try{const r=new URL(gl(e)).hostname.split(".").pop();if(r&&fl.has(r))return!0}catch{return!1}}return!1}function ml(e){return/^[a-zA-Z]+:\/\//.test(e)}function p_(e){return/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/.test(e)}function gl(e){return ml(e)?e:p_(e)?`mailto://${e}`:`https://${e}`}const qt=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function vi(e,t){const n=Z.getValueType(e),r=Z.getValueType(t);return n!==r?!1:Z.isArray(e)?E_(e,t):Z.isObject(e)?C_(e,t):Z.isDate(e)?e.getTime()===t.getTime():Z.isRegExp(e)?e.toString()===t.toString():e===t}function E_(e,t){if(e.length!==t.length)return!1;for(let n=0,r=e.length;n<r;n++){const s=e[n],i=t[n];if(!vi(s,i))return!1}return!0}function C_(e,t){const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(const s of n){if(!r.includes(s))return!1;const i=e[s],o=t[s];if(!vi(i,o))return!1}return!0}class Z{static deleteNull(t){for(const n in t)(t[n]===null||t[n]===void 0)&&delete t[n];return t}static stringAt(t){let n="",r=t;for(;r>=qt.length;)r/=qt.length,r-=1,n+=qt[r%qt.length];const s=t%qt.length;return n+=qt[s],n}static indexAt(t){let n=0;for(let r=0;r<t.length-1;r+=1){const s=t.charCodeAt(r)-65,i=t.length-1-r;n+=qt.length**i+qt.length*s}return n+=t.charCodeAt(t.length-1)-65,n}static deleteBlank(t){return Z.isString(t)?t.replace(/\s/g,""):t}static getSystemType(){const t=navigator.userAgent,n=navigator.platform==="Win32"||navigator.platform==="Windows",r=navigator.platform==="Mac68K"||navigator.platform==="MacPPC"||navigator.platform==="Macintosh"||navigator.platform==="MacIntel";if(r)return"Mac";if(navigator.platform==="X11"&&!n&&!r)return"Unix";if(String(navigator.platform).indexOf("Linux")>-1)return"Linux";if(n){if(t.indexOf("Windows NT 5.0")>-1||t.indexOf("Windows 2000")>-1)return"Windows 2000";if(t.indexOf("Windows NT 5.1")>-1||t.indexOf("Windows XP")>-1)return"Windows XP";if(t.indexOf("Windows NT 5.2")>-1||t.indexOf("Windows 2003")>-1)return"Windows 2003";if(t.indexOf("Windows NT 6.0")>-1||t.indexOf("Windows Vista")>-1)return"Windows Vista";if(t.indexOf("Windows NT 6.1")>-1||t.indexOf("Windows 7")>-1)return"Windows 7";if(t.indexOf("Windows NT 10")>-1||t.indexOf("Windows 10")>-1)return"Windows 10";if(t.indexOf("Windows NT 11")>-1||t.indexOf("Windows 11")>-1)return"Windows 11"}return"Unknown system"}static getBrowserType(){const t=navigator.userAgent,n=t.indexOf("Opera")>-1,r=t.indexOf("compatible")>-1&&t.indexOf("MSIE")>-1&&!n,s=t.indexOf("Trident")>-1&&t.indexOf("rv:11.0")>-1,i=t.indexOf("Edge")>-1,o=t.indexOf("Firefox")>-1,a=t.indexOf("Safari")>-1&&t.indexOf("Chrome")===-1,l=t.indexOf("Chrome")>-1&&t.indexOf("Safari")>-1;if(r){new RegExp("MSIE (\\d+\\.\\d+);").test(t);const u=Number.parseFloat(RegExp.$1);return u===7?"IE7":u===8?"IE8":u===9?"IE9":u===10?"IE10":"0"}return o?"FF":n?"Opera":a?"Safari":l?"Chrome":i?"Edge":s?"IE11":"Unknown browser"}static getClassName(t){return t.constructor.name}static deepMerge(t,...n){n.forEach(o=>o&&i(o));function r(o,a){o.forEach((l,c)=>{var u,h;if(Z.isArray(l)){const d=(u=a[c])!=null?u:[];a[c]=d,r(l,d);return}if(Z.isObject(l)){const d=(h=a[c])!=null?h:{};a[c]=d,s(l,d);return}a[c]=l})}function s(o,a){Object.keys(o).forEach(l=>{var u,h;const c=o[l];if(Z.isObject(c)){const d=(u=a[l])!=null?u:{};a[l]=d,s(c,d);return}if(Z.isArray(c)){const d=(h=a[l])!=null?h:[];a[l]=d,r(c,d);return}a[l]=c})}function i(o){Object.keys(o).forEach(a=>{var c,u;const l=o[a];if(Z.isArray(l)){const h=(c=t[a])!=null?c:[];t[a]=h,r(l,h);return}if(Z.isObject(l)){const h=(u=t[a])!=null?u:{};t[a]=h,s(l,h);return}t[a]=l})}return t}static numberFixed(t,n){return Number(Number(t).toFixed(n))}static diffValue(t,n){return vi(t,n)}static deepClone(t){if(!this.isDefine(t))return t;if(this.isRegExp(t))return new RegExp(t);if(this.isDate(t))return new Date(t);if(this.isArray(t)){const n=[];return t.forEach((r,s)=>{n[s]=Z.deepClone(r)}),n}if(this.isObject(t)){const n={};return Object.keys(t).forEach(r=>{const s=t[r];n[r]=Z.deepClone(s)}),Object.setPrototypeOf(n,Object.getPrototypeOf(t)),n}return t}static getLanguage(){const t="en-US";return globalThis.navigator&&(navigator.languages&&navigator.languages[0]||navigator.language)||t}static getValueType(t){return Object.prototype.toString.apply(t)}static isDefine(t){return t!=null}static isBlank(t){return this.isDefine(t)?this.isString(t)?t.trim()==="":!1:!0}static isPlainObject(t){return this.isDefine(t)?Object.getPrototypeOf(t)===Object.getPrototypeOf({}):!1}static isDate(t){return this.getValueType(t)==="[object Date]"}static isRegExp(t){return this.getValueType(t)==="[object RegExp]"}static isArray(t){return this.getValueType(t)==="[object Array]"}static isString(t){return this.getValueType(t)==="[object String]"}static isNumber(t){return this.getValueType(t)==="[object Number]"}static isStringNumber(t){return!isNaN(Number.parseFloat(t))&&isFinite(t)}static isObject(t){return this.getValueType(t)==="[object Object]"}static isEmptyObject(t){for(const n in t)return!1;return!0}static isTablet(){return/ipad|android|android 3.0|xoom|sch-i800|playbook|tablet|kindle/i.test(navigator.userAgent.toLowerCase())}static isIPhone(){return/iPhone/i.test(navigator.userAgent)}static isLegalUrl(t){return __(t)}static normalizeUrl(t){return gl(t)}static topLevelDomainCombiningString(){return[...fl].join("|")}static removeNull(t){return this.isObject(t)&&Object.keys(t).forEach(n=>{const r=t[n];r==null?delete t[n]:Z.removeNull(r)}),t}static fillTwoDimensionalArray(t,n,r){return new Array(t).fill(r).map(s=>new Array(n).fill(r))}static numToWord(t){let n="";for(;t>0;){let r=t%26;r=r===0?r=26:r,n=String.fromCharCode(96+r)+n,t=(t-r)/26}return n.toLocaleUpperCase()}static ABCatNum(t){if(t==null||t.length===0)return Number.NaN;const n=t.toLowerCase().split(""),r=n.length;let s=0,i=0;for(let o=0;o<r;o++)i=n[o].charCodeAt(0)-96,s+=i*26**(r-o-1);return s===0?Number.NaN:s-1}static chatAtABC(t){let i="";for(;t>=0;)i=String.fromCharCode(t%26+97)+i,t=Math.floor(t/26)-1;return i.toUpperCase()}static commonExtend(t,n){const r={};for(const s in t)r[s]=t[s];for(const s in n)n[s]!=null&&(r[s]=n[s]);return r}static hasIntersectionBetweenTwoRanges(t,n,r,s){return n>=r&&s>=t}static isStartValidPosition(t){return/^[A-Za-zА-Яа-яЁё_]/.test(t)}static isValidParameter(t){const n=/[~!@#$%^&*()+=\-{}\[\]\|:;"'<>,?\/ ]+/.test(t),r=t.length<=255;return!n&&r}static clamp(t,n,r){return Math.max(n,Math.min(r,t))}static now(){return performance&&performance.now?performance.now():Date.now()}}function tt(e=21,t){return t?f_(t,e)():m_(e)}function ar(...e){const t={},n=e.length;for(let r=n-1;r>=0;r--){const s=e[r];if(s){const i=Object.keys(s);for(const o of i)t[o]===void 0&&(t[o]=s[o])}}return t}const R_=()=>typeof process<"u"&&process.versions!=null&&process.versions.node!=null;function I_(e){const n=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/\\\*/g,".*").replace(/\\\?/g,".");return new RegExp(`^${n}$`,"i")}var _l=(e=>(e[e.DEFAULT_SERIES=0]="DEFAULT_SERIES",e[e.ALTERNATE_SERIES=1]="ALTERNATE_SERIES",e))(_l||{}),Ue=(e=>(e[e.NONE=0]="NONE",e[e.THIN=1]="THIN",e[e.HAIR=2]="HAIR",e[e.DOTTED=3]="DOTTED",e[e.DASHED=4]="DASHED",e[e.DASH_DOT=5]="DASH_DOT",e[e.DASH_DOT_DOT=6]="DASH_DOT_DOT",e[e.DOUBLE=7]="DOUBLE",e[e.MEDIUM=8]="MEDIUM",e[e.MEDIUM_DASHED=9]="MEDIUM_DASHED",e[e.MEDIUM_DASH_DOT=10]="MEDIUM_DASH_DOT",e[e.MEDIUM_DASH_DOT_DOT=11]="MEDIUM_DASH_DOT_DOT",e[e.SLANT_DASH_DOT=12]="SLANT_DASH_DOT",e[e.THICK=13]="THICK",e))(Ue||{}),pl=(e=>(e.TOP="top",e.BOTTOM="bottom",e.LEFT="left",e.RIGHT="right",e.NONE="none",e.ALL="all",e.OUTSIDE="outside",e.INSIDE="inside",e.HORIZONTAL="horizontal",e.VERTICAL="vertical",e.TLBR="tlbr",e.TLBC_TLMR="tlbc_tlmr",e.TLBR_TLBC_TLMR="tlbr_tlbc_tlmr",e.BLTR="bl_tr",e.MLTR_BCTR="mltr_bctr",e))(pl||{}),pt=(e=>(e[e.UNSUPPORTED=0]="UNSUPPORTED",e[e.RGB=1]="RGB",e[e.HEX=2]="HEX",e[e.THEME=3]="THEME",e))(pt||{}),El=(e=>(e[e.ON=0]="ON",e[e.OFF=1]="OFF",e))(El||{}),Cl=(e=>(e[e.PASTE_NORMAL=0]="PASTE_NORMAL",e[e.PASTE_NO_BORDERS=1]="PASTE_NO_BORDERS",e[e.PASTE_FORMAT=2]="PASTE_FORMAT",e[e.PASTE_FORMULA=3]="PASTE_FORMULA",e[e.PASTE_DATA_VALIDATION=4]="PASTE_DATA_VALIDATION",e[e.PASTE_VALUES=5]="PASTE_VALUES",e[e.PASTE_CONDITIONAL_FORMATTING=6]="PASTE_CONDITIONAL_FORMATTING",e[e.PASTE_COLUMN_WIDTHS=7]="PASTE_COLUMN_WIDTHS",e))(Cl||{}),Rl=(e=>(e[e.LEFT=0]="LEFT",e[e.RIGHT=1]="RIGHT",e))(Rl||{}),Il=(e=>(e[e.DOCUMENT=0]="DOCUMENT",e[e.PROJECT=1]="PROJECT",e))(Il||{}),Sl=(e=>(e[e.COLUMNS=0]="COLUMNS",e[e.ROWS=1]="ROWS",e))(Sl||{}),Ol=(e=>(e[e.UP=0]="UP",e[e.RIGHT=1]="RIGHT",e[e.DOWN=2]="DOWN",e[e.LEFT=3]="LEFT",e))(Ol||{});function S_(e){switch(e){case 3:return 1;case 1:return 3;case 0:return 2;case 2:return 0}}var vl=(e=>(e[e.INTERPOLATION_POINT_TYPE_UNSPECIFIED=0]="INTERPOLATION_POINT_TYPE_UNSPECIFIED",e[e.MIN=1]="MIN",e[e.MAX=2]="MAX",e[e.NUMBER=3]="NUMBER",e[e.PERCENT=4]="PERCENT",e[e.PERCENTILE=5]="PERCENTILE",e))(vl||{}),lr=(e=>(e.EN_US="enUS",e.FR_FR="frFR",e.ZH_CN="zhCN",e.RU_RU="ruRU",e.ZH_TW="zhTW",e.VI_VN="viVN",e.FA_IR="faIR",e.KO_KR="koKR",e.ES_ES="esES",e.CA_ES="caES",e))(lr||{}),os=(e=>(e[e.PERSON=0]="PERSON",e[e.FILE=1]="FILE",e[e.DATE=2]="DATE",e[e.LOCATION=3]="LOCATION",e[e.EVENT=4]="EVENT",e))(os||{}),wl=(e=>(e[e.RANGE=0]="RANGE",e[e.SHEET=1]="SHEET",e))(wl||{}),bl=(e=>(e.Line="line",e.LineInv="lineInv",e.Triangle="triangle",e.RtTriangle="rtTriangle",e.Rect="rect",e.Diamond="diamond",e.Parallelogram="parallelogram",e.Trapezoid="trapezoid",e.NonIsocelesTrapezoid="nonIsocelesTrapezoid",e.Pentagon="pentagon",e.Hexagon="hexagon",e.Heptagon="heptagon",e.Octagon="octagon",e.Decagon="decagon",e.Dodecagon="dodecagon",e.Star4="star4",e.Star5="star5",e.Star6="star6",e.Star7="star7",e.Star8="star8",e.Star10="star10",e.Star12="star12",e.Star16="star16",e.Star24="star24",e.Star32="star32",e.RoundRect="roundRect",e.Round1Rect="round1Rect",e.Round2SameRect="round2SameRect",e.Round2DiagRect="round2DiagRect",e.Ellipse="ellipse",e))(bl||{}),Al=(e=>(e.RightArrow="rightArrow",e.LeftArrow="leftArrow",e.UpArrow="upArrow",e.DownArrow="downArrow",e.LeftRightArrow="leftRightArrow",e.UpDownArrow="upDownArrow",e.QuadArrow="quadArrow",e.LeftRightUpArrow="leftRightUpArrow",e.BentArrow="bentArrow",e.UturnArrow="uturnArrow",e.CircularArrow="circularArrow",e.NotchedRightArrow="notchedRightArrow",e.HomePlate="homePlate",e.Chevron="chevron",e.LeftCircularArrow="leftCircularArrow",e.LeftRightCircularArrow="leftRightCircularArrow",e))(Al||{}),Tl=(e=>(e.Plaque="plaque",e.Can="can",e.Cube="cube",e.Bevel="bevel",e.Donut="donut",e.NoSmoking="noSmoking",e.BlockArc="blockArc",e.FoldedCorner="foldedCorner",e))(Tl||{}),yl=(e=>(e.SmileyFace="smileyFace",e.Heart="heart",e.LightningBolt="lightningBolt",e.Sun="sun",e.Moon="moon",e.Cloud="cloud",e.Arc="arc",e.Backpack="backpack",e.Frame="frame",e.HalfFrame="halfFrame",e.Corner="corner",e.Chord="chord",e.Pie="pie",e.Teardrop="teardrop",e.WedgeRectCallout="wedgeRectCallout",e.WedgeRRectCallout="wedgeRRectCallout",e.WedgeEllipseCallout="wedgeEllipseCallout",e.CloudCallout="cloudCallout",e.BorderCallout1="borderCallout1",e.BorderCallout2="borderCallout2",e.BorderCallout3="borderCallout3",e.AccentCallout1="accentCallout1",e.AccentCallout2="accentCallout2",e.AccentCallout3="accentCallout3",e.Callout1="callout1",e.Callout2="callout2",e.Callout3="callout3",e.ActionButtonBackPrevious="actionButtonBackPrevious",e.ActionButtonEnd="actionButtonEnd",e.ActionButtonForwardNext="actionButtonForwardNext",e.ActionButtonHelp="actionButtonHelp",e.ActionButtonHome="actionButtonHome",e.ActionButtonInformation="actionButtonInformation",e.ActionButtonMovie="actionButtonMovie",e.ActionButtonReturn="actionButtonReturn",e.ActionButtonSound="actionButtonSound",e))(yl||{}),Nl=(e=>(e[e.RELATIVE_DATE_UNSPECIFIED=0]="RELATIVE_DATE_UNSPECIFIED",e[e.PAST_YEAR=1]="PAST_YEAR",e[e.PAST_MONTH=2]="PAST_MONTH",e[e.PAST_WEEK=3]="PAST_WEEK",e[e.YESTERDAY=4]="YESTERDAY",e[e.TODAY=5]="TODAY",e[e.TOMORROW=6]="TOMORROW",e))(Nl||{}),Ml=(e=>(e[e.GRID=0]="GRID",e[e.KANBAN=1]="KANBAN",e[e.GANTT=2]="GANTT",e))(Ml||{}),cr=(e=>(e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.LEFT_TO_RIGHT=1]="LEFT_TO_RIGHT",e[e.RIGHT_TO_LEFT=2]="RIGHT_TO_LEFT",e))(cr||{}),Ll=(e=>(e[e.DASH=0]="DASH",e[e.DASH_DOT_DOT_HEAVY=1]="DASH_DOT_DOT_HEAVY",e[e.DASH_DOT_HEAVY=2]="DASH_DOT_HEAVY",e[e.DASHED_HEAVY=3]="DASHED_HEAVY",e[e.DASH_LONG=4]="DASH_LONG",e[e.DASH_LONG_HEAVY=5]="DASH_LONG_HEAVY",e[e.DOT_DASH=6]="DOT_DASH",e[e.DOT_DOT_DASH=7]="DOT_DOT_DASH",e[e.DOTTED=8]="DOTTED",e[e.DOTTED_HEAVY=9]="DOTTED_HEAVY",e[e.DOUBLE=10]="DOUBLE",e[e.NONE=11]="NONE",e[e.SINGLE=12]="SINGLE",e[e.THICK=13]="THICK",e[e.WAVE=14]="WAVE",e[e.WAVY_DOUBLE=15]="WAVY_DOUBLE",e[e.WAVY_HEAVY=16]="WAVY_HEAVY",e[e.WORDS=17]="WORDS",e))(Ll||{}),vt=(e=>(e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.LEFT=1]="LEFT",e[e.CENTER=2]="CENTER",e[e.RIGHT=3]="RIGHT",e[e.JUSTIFIED=4]="JUSTIFIED",e[e.BOTH=5]="BOTH",e[e.DISTRIBUTED=6]="DISTRIBUTED",e))(vt||{}),fn=(e=>(e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.TOP=1]="TOP",e[e.MIDDLE=2]="MIDDLE",e[e.BOTTOM=3]="BOTTOM",e))(fn||{}),mn=(e=>(e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.OVERFLOW=1]="OVERFLOW",e[e.CLIP=2]="CLIP",e[e.WRAP=3]="WRAP",e))(mn||{}),as=(e=>(e[e.NORMAL=0]="NORMAL",e[e.ITALIC=1]="ITALIC",e))(as||{}),ls=(e=>(e[e.NORMAL=0]="NORMAL",e[e.BOLD=1]="BOLD",e))(ls||{}),Ht=(e=>(e[e.NORMAL=1]="NORMAL",e[e.SUBSCRIPT=2]="SUBSCRIPT",e[e.SUPERSCRIPT=3]="SUPERSCRIPT",e))(Ht||{}),ae=(e=>(e[e.FALSE=0]="FALSE",e[e.TRUE=1]="TRUE",e))(ae||{}),Zt=(e=>(e[e.STRING=1]="STRING",e[e.NUMBER=2]="NUMBER",e[e.BOOLEAN=3]="BOOLEAN",e[e.FORCE_STRING=4]="FORCE_STRING",e))(Zt||{}),ot=(e=>(e[e.DARK1=0]="DARK1",e[e.LIGHT1=1]="LIGHT1",e[e.DARK2=2]="DARK2",e[e.LIGHT2=3]="LIGHT2",e[e.ACCENT1=4]="ACCENT1",e[e.ACCENT2=5]="ACCENT2",e[e.ACCENT3=6]="ACCENT3",e[e.ACCENT4=7]="ACCENT4",e[e.ACCENT5=8]="ACCENT5",e[e.ACCENT6=9]="ACCENT6",e[e.HYPERLINK=10]="HYPERLINK",e[e.FOLLOWED_HYPERLINK=11]="FOLLOWED_HYPERLINK",e))(ot||{}),cs=(e=>(e.OFFICE="Office",e.OFFICE_2007_2010="Office 2007-2010",e.GRAYSCALE="Grayscale",e.BLUE_WARM="Blue Warm",e.BLUE="Blue",e.BLUE_II="Blue II",e.BLUE_GREEN="Blue Green",e.GREEN="Green",e.GREEN_YELLOW="Green Yellow",e.YELLOW="Yellow",e.YELLOW_ORANGE="Yellow Orange",e.ORANGE="Orange",e.ORANGE_RED="Orange Red",e.RED_ORANGE="Red Orange",e.RED="Red",e.RED_VIOLET="Red Violet",e.VIOLET="Violet",e.VIOLET_II="Violet II",e.MEDIAN="Median",e.PAPER="Paper",e.MARQUEE="Marquee",e.SLIPSTREAM="Slipstream",e.Aspect="Aspect",e))(cs||{}),Dl=(e=>(e[e.character=0]="character",e[e.paragraph=1]="paragraph",e[e.table=2]="table",e[e.numbering=3]="numbering",e))(Dl||{}),Ul=(e=>(e[e.TAB=0]="TAB",e[e.SPACE=1]="SPACE",e[e.NOTHING=2]="NOTHING",e))(Ul||{}),fe=(e=>(e[e.BULLET=0]="BULLET",e[e.NONE=1]="NONE",e[e.DECIMAL=2]="DECIMAL",e[e.DECIMAL_ZERO=3]="DECIMAL_ZERO",e[e.UPPER_LETTER=4]="UPPER_LETTER",e[e.LOWER_LETTER=5]="LOWER_LETTER",e[e.UPPER_ROMAN=6]="UPPER_ROMAN",e[e.LOWER_ROMAN=7]="LOWER_ROMAN",e[e.ORDINAL=8]="ORDINAL",e[e.CARDINAL_TEXT=9]="CARDINAL_TEXT",e[e.ORDINAL_TEXT=10]="ORDINAL_TEXT",e[e.HEX=11]="HEX",e[e.CHICAGO=12]="CHICAGO",e[e.IDEOGRAPH_DIGITAL=13]="IDEOGRAPH_DIGITAL",e[e.JAPANESE_COUNTING=14]="JAPANESE_COUNTING",e[e.AIUEO=15]="AIUEO",e[e.IROHA=16]="IROHA",e[e.DECIMAL_FULL_WIDTH=17]="DECIMAL_FULL_WIDTH",e[e.DECIMAL_HALF_WIDTH=18]="DECIMAL_HALF_WIDTH",e[e.JAPANESE_LEGAL=19]="JAPANESE_LEGAL",e[e.JAPANESE_DIGITAL_TEN_THOUSAND=20]="JAPANESE_DIGITAL_TEN_THOUSAND",e[e.DECIMAL_ENCLOSED_CIRCLE=21]="DECIMAL_ENCLOSED_CIRCLE",e[e.DECIMAL_FULL_WIDTH2=22]="DECIMAL_FULL_WIDTH2",e[e.AIUEO_FULL_WIDTH=23]="AIUEO_FULL_WIDTH",e[e.IROHA_FULL_WIDTH=24]="IROHA_FULL_WIDTH",e[e.GANADA=25]="GANADA",e[e.CHOSUNG=26]="CHOSUNG",e[e.DECIMAL_ENCLOSED_FULLSTOP=27]="DECIMAL_ENCLOSED_FULLSTOP",e[e.DECIMAL_ENCLOSED_PAREN=28]="DECIMAL_ENCLOSED_PAREN",e[e.DECIMAL_ENCLOSED_CIRCLE_CHINESE=29]="DECIMAL_ENCLOSED_CIRCLE_CHINESE",e[e.IDEOGRAPH_ENCLOSED_CIRCLE=30]="IDEOGRAPH_ENCLOSED_CIRCLE",e[e.IDEOGRAPH_TRADITIONAL=31]="IDEOGRAPH_TRADITIONAL",e[e.IDEOGRAPH_ZODIAC=32]="IDEOGRAPH_ZODIAC",e[e.IDEOGRAPH_ZODIAC_TRADITIONAL=33]="IDEOGRAPH_ZODIAC_TRADITIONAL",e[e.TAIWANESE_COUNTING=34]="TAIWANESE_COUNTING",e[e.IDEOGRAPH_LEGAL_TRADITIONAL=35]="IDEOGRAPH_LEGAL_TRADITIONAL",e[e.TAIWANESE_COUNTING_THOUSAND=36]="TAIWANESE_COUNTING_THOUSAND",e[e.TAIWANESE_DIGITAL=37]="TAIWANESE_DIGITAL",e[e.CHINESE_COUNTING=38]="CHINESE_COUNTING",e[e.CHINESE_LEGAL_SIMPLIFIED=39]="CHINESE_LEGAL_SIMPLIFIED",e[e.CHINESE_COUNTING_THOUSAND=40]="CHINESE_COUNTING_THOUSAND",e[e.KOREAN_DIGITAL=41]="KOREAN_DIGITAL",e[e.KOREAN_COUNTING=42]="KOREAN_COUNTING",e[e.KOREAN_LEGAL=43]="KOREAN_LEGAL",e[e.KOREAN_DIGITAL2=44]="KOREAN_DIGITAL2",e[e.VIETNAMESE_COUNTING=45]="VIETNAMESE_COUNTING",e[e.RUSSIAN_LOWER=46]="RUSSIAN_LOWER",e[e.RUSSIAN_UPPER=47]="RUSSIAN_UPPER",e[e.NUMBER_IN_DASH=48]="NUMBER_IN_DASH",e[e.HEBREW1=49]="HEBREW1",e[e.HEBREW2=50]="HEBREW2",e[e.ARABIC_ALPHA=51]="ARABIC_ALPHA",e[e.ARABIC_ABJAD=52]="ARABIC_ABJAD",e[e.HINDI_VOWELS=53]="HINDI_VOWELS",e[e.HINDI_CONSONANTS=54]="HINDI_CONSONANTS",e[e.HINDI_NUMBERS=55]="HINDI_NUMBERS",e[e.HINDI_COUNTING=56]="HINDI_COUNTING",e[e.THAI_LETTERS=57]="THAI_LETTERS",e[e.THAI_NUMBERS=58]="THAI_NUMBERS",e[e.THAI_COUNTING=59]="THAI_COUNTING",e[e.CUSTOM=60]="CUSTOM",e))(fe||{}),ur=(e=>(e[e.BULLET_ALIGNMENT_UNSPECIFIED=0]="BULLET_ALIGNMENT_UNSPECIFIED",e[e.START=1]="START",e[e.CENTER=2]="CENTER",e[e.END=3]="END",e[e.BOTH=4]="BOTH",e))(ur||{}),Jt=(e=>(e[e.HYPERLINK=0]="HYPERLINK",e[e.FIELD=1]="FIELD",e[e.SDT=2]="SDT",e[e.BOOKMARK=3]="BOOKMARK",e[e.COMMENT=4]="COMMENT",e[e.CUSTOM=5]="CUSTOM",e[e.MENTION=6]="MENTION",e[e.UNI_FORMULA=7]="UNI_FORMULA",e[e.DELTED=9999]="DELTED",e))(Jt||{}),gn=(e=>(e[e.COMMENT=0]="COMMENT",e[e.DELETED=9999]="DELETED",e))(gn||{}),Pl=(e=>(e[e.DRAWING=0]="DRAWING",e[e.CUSTOM=1]="CUSTOM",e))(Pl||{}),wi=(e=>(e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.TRADITIONAL=1]="TRADITIONAL",e[e.MODERN=2]="MODERN",e))(wi||{}),kl=(e=>(e[e.DEFAULT=0]="DEFAULT",e[e.LINES=1]="LINES",e[e.LINES_AND_CHARS=2]="LINES_AND_CHARS",e[e.SNAP_TO_CHARS=3]="SNAP_TO_CHARS",e))(kl||{}),Fl=(e=>(e[e.SECTION_TYPE_UNSPECIFIED=0]="SECTION_TYPE_UNSPECIFIED",e[e.CONTINUOUS=1]="CONTINUOUS",e[e.NEXT_PAGE=2]="NEXT_PAGE",e[e.EVEN_PAGE=3]="EVEN_PAGE",e[e.ODD_PAGE=4]="ODD_PAGE",e))(Fl||{}),xl=(e=>(e[e.COLUMN_SEPARATOR_STYLE_UNSPECIFIED=0]="COLUMN_SEPARATOR_STYLE_UNSPECIFIED",e[e.NONE=1]="NONE",e[e.BETWEEN_EACH_COLUMN=2]="BETWEEN_EACH_COLUMN",e))(xl||{}),Bl=(e=>(e[e.NORMAL=0]="NORMAL",e[e.TBRL=1]="TBRL",e[e.LRTBV=2]="LRTBV",e))(Bl||{}),$l=(e=>(e[e.TEXT_RUN=0]="TEXT_RUN",e[e.AUTO_TEXT=1]="AUTO_TEXT",e[e.PAGE_BREAK=2]="PAGE_BREAK",e[e.COLUMN_BREAK=3]="COLUMN_BREAK",e[e.FOOT_NOTE_REFERENCE=4]="FOOT_NOTE_REFERENCE",e[e.HORIZONTAL_RULE=5]="HORIZONTAL_RULE",e[e.EQUATION=6]="EQUATION",e[e.DRAWING=7]="DRAWING",e[e.PERSON=8]="PERSON",e[e.RICH_LINK=9]="RICH_LINK",e))($l||{}),Hl=(e=>(e[e.BOTH_SIDES=0]="BOTH_SIDES",e[e.LEFT=1]="LEFT",e[e.RIGHT=2]="RIGHT",e[e.LARGEST=3]="LARGEST",e))(Hl||{}),jl=(e=>(e[e.INLINE=0]="INLINE",e[e.WRAP_NONE=1]="WRAP_NONE",e[e.WRAP_POLYGON=2]="WRAP_POLYGON",e[e.WRAP_SQUARE=3]="WRAP_SQUARE",e[e.WRAP_THROUGH=4]="WRAP_THROUGH",e[e.WRAP_TIGHT=5]="WRAP_TIGHT",e[e.WRAP_TOP_AND_BOTTOM=6]="WRAP_TOP_AND_BOTTOM",e))(jl||{}),qe=(e=>(e[e.NAMED_STYLE_TYPE_UNSPECIFIED=0]="NAMED_STYLE_TYPE_UNSPECIFIED",e[e.NORMAL_TEXT=1]="NORMAL_TEXT",e[e.TITLE=2]="TITLE",e[e.SUBTITLE=3]="SUBTITLE",e[e.HEADING_1=4]="HEADING_1",e[e.HEADING_2=5]="HEADING_2",e[e.HEADING_3=6]="HEADING_3",e[e.HEADING_4=7]="HEADING_4",e[e.HEADING_5=8]="HEADING_5",e))(qe||{}),Wl=(e=>(e[e.AUTO=0]="AUTO",e[e.AT_LEAST=1]="AT_LEAST",e[e.EXACT=2]="EXACT",e))(Wl||{}),Yl=(e=>(e[e.DASH_STYLE_UNSPECIFIED=0]="DASH_STYLE_UNSPECIFIED",e[e.SOLID=1]="SOLID",e[e.DOT=2]="DOT",e[e.DASH=3]="DASH",e))(Yl||{}),Gl=(e=>(e[e.TAB_STOP_ALIGNMENT_UNSPECIFIED=0]="TAB_STOP_ALIGNMENT_UNSPECIFIED",e[e.START=1]="START",e[e.CENTER=2]="CENTER",e[e.END=3]="END",e))(Gl||{}),Vl=(e=>(e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.SPECIFIED=1]="SPECIFIED",e))(Vl||{}),zl=(e=>(e[e.START=0]="START",e[e.CENTER=1]="CENTER",e[e.END=2]="END",e))(zl||{}),Kl=(e=>(e[e.AUTO_FIT=0]="AUTO_FIT",e[e.FIXED=1]="FIXED",e))(Kl||{}),Xl=(e=>(e[e.NONE=0]="NONE",e[e.WRAP=1]="WRAP",e))(Xl||{}),ql=(e=>(e[e.AUTO=0]="AUTO",e[e.AT_LEAST=1]="AT_LEAST",e[e.EXACT=2]="EXACT",e))(ql||{}),Zl=(e=>(e[e.CONTENT_ALIGNMENT_UNSPECIFIED=0]="CONTENT_ALIGNMENT_UNSPECIFIED",e[e.BOTH=1]="BOTH",e[e.TOP=2]="TOP",e[e.CENTER=3]="CENTER",e[e.BOTTOM=4]="BOTTOM",e))(Zl||{}),Mn=(e=>(e.NORMAL="normal",e.BOLD="bold",e.ITALIC="italic",e))(Mn||{}),Jl=(e=>(e[e.PAGE=0]="PAGE",e[e.COLUMN=1]="COLUMN",e[e.CHARACTER=2]="CHARACTER",e[e.MARGIN=3]="MARGIN",e[e.INSIDE_MARGIN=4]="INSIDE_MARGIN",e[e.OUTSIDE_MARGIN=5]="OUTSIDE_MARGIN",e[e.LEFT_MARGIN=6]="LEFT_MARGIN",e[e.RIGHT_MARGIN=7]="RIGHT_MARGIN",e))(Jl||{}),Ql=(e=>(e[e.PAGE=0]="PAGE",e[e.PARAGRAPH=1]="PARAGRAPH",e[e.LINE=2]="LINE",e[e.MARGIN=3]="MARGIN",e[e.TOP_MARGIN=4]="TOP_MARGIN",e[e.BOTTOM_MARGIN=5]="BOTTOM_MARGIN",e[e.INSIDE_MARGIN=6]="INSIDE_MARGIN",e[e.OUTSIDE_MARGIN=7]="OUTSIDE_MARGIN",e))(Ql||{}),ec=(e=>(e[e.POINT=0]="POINT",e[e.LINE=1]="LINE",e[e.CHARACTER=2]="CHARACTER",e[e.PIXEL=3]="PIXEL",e[e.PERCENT=4]="PERCENT",e))(ec||{}),tc=(e=>(e[e.CENTER=0]="CENTER",e[e.INSIDE=1]="INSIDE",e[e.LEFT=2]="LEFT",e[e.OUTSIDE=3]="OUTSIDE",e[e.RIGHT=4]="RIGHT",e[e.BOTH=5]="BOTH",e[e.DISTRIBUTE=6]="DISTRIBUTE",e))(tc||{}),nc=(e=>(e[e.BOTTOM=0]="BOTTOM",e[e.CENTER=1]="CENTER",e[e.INSIDE=2]="INSIDE",e[e.OUTSIDE=3]="OUTSIDE",e[e.TOP=4]="TOP",e))(nc||{}),rc=(e=>(e[e.compressPunctuation=0]="compressPunctuation",e[e.compressPunctuationAndJapaneseKana=1]="compressPunctuationAndJapaneseKana",e[e.doNotCompress=2]="doNotCompress",e))(rc||{}),sc=(e=>(e[e.PORTRAIT=0]="PORTRAIT",e[e.LANDSCAPE=1]="LANDSCAPE",e))(sc||{}),ct=(e=>(e.Letter="Letter",e.Tabloid="Tabloid",e.Legal="Legal",e.Statement="Statement",e.Executive="Executive",e.Folio="Folio",e.A3="A3",e.A4="A4",e.A5="A5",e.B4="B4",e.B5="B5",e))(ct||{});const O_=["A3","A4","A5","B4","B5","Letter","Tabloid","Legal","Statement","Executive","Folio"];var ic=(e=>(e[e.forward=0]="forward",e[e.backward=1]="backward",e[e.front=2]="front",e[e.back=3]="back",e))(ic||{}),oc=(e=>(e[e.UNRECOGNIZED=-1]="UNRECOGNIZED",e[e.DRAWING_IMAGE=0]="DRAWING_IMAGE",e[e.DRAWING_SHAPE=1]="DRAWING_SHAPE",e[e.DRAWING_CHART=2]="DRAWING_CHART",e[e.DRAWING_TABLE=3]="DRAWING_TABLE",e[e.DRAWING_SMART_ART=4]="DRAWING_SMART_ART",e[e.DRAWING_VIDEO=5]="DRAWING_VIDEO",e[e.DRAWING_GROUP=6]="DRAWING_GROUP",e[e.DRAWING_UNIT=7]="DRAWING_UNIT",e[e.DRAWING_DOM=8]="DRAWING_DOM",e))(oc||{}),bi=(e=>(e[e.SLIDE=0]="SLIDE",e[e.MASTER=1]="MASTER",e[e.LAYOUT=2]="LAYOUT",e[e.HANDOUT_MASTER=3]="HANDOUT_MASTER",e[e.NOTES_MASTER=4]="NOTES_MASTER",e))(bi||{}),ac=(e=>(e[e.SHAPE=0]="SHAPE",e[e.IMAGE=1]="IMAGE",e[e.TEXT=2]="TEXT",e[e.SPREADSHEET=3]="SPREADSHEET",e[e.DOCUMENT=4]="DOCUMENT",e[e.SLIDE=5]="SLIDE",e))(ac||{}),lc=(e=>(e[e.RELATIVE_SLIDE_LINK_UNSPECIFIED=0]="RELATIVE_SLIDE_LINK_UNSPECIFIED",e[e.NEXT_SLIDE=1]="NEXT_SLIDE",e[e.PREVIOUS_SLIDE=2]="PREVIOUS_SLIDE",e[e.FIRST_SLIDE=3]="FIRST_SLIDE",e[e.LAST_SLIDE=4]="LAST_SLIDE",e))(lc||{});function v_(e=tt(6),t=lr.EN_US,n=""){return{id:e,locale:t,title:n,tableSource:{},drawings:{},drawingsOrder:[],headers:{},footers:{},body:{dataStream:`\r
`,textRuns:[],customBlocks:[],tables:[],paragraphs:[{startIndex:0,paragraphStyle:{spaceAbove:{v:5},lineSpacing:1,spaceBelow:{v:0}}}],sectionBreaks:[{startIndex:1}]},documentStyle:{pageSize:{width:793.3333333333334,height:1122.6666666666667},documentFlavor:wi.TRADITIONAL,marginTop:50,marginBottom:50,marginRight:50,marginLeft:50,renderConfig:{zeroWidthParagraphBreak:ae.FALSE,vertexAngle:0,centerAngle:0,background:{rgb:"#ccc"}},autoHyphenation:ae.TRUE,doNotHyphenateCaps:ae.FALSE,consecutiveHyphenLimit:2,defaultHeaderId:"",defaultFooterId:"",evenPageHeaderId:"",evenPageFooterId:"",firstPageHeaderId:"",firstPageFooterId:"",evenAndOddHeaders:ae.FALSE,useFirstPageHeaderFooter:ae.FALSE,marginHeader:30,marginFooter:30},settings:{}}}var _n={},hr={},us={},cc;function w_(){if(cc)return us;cc=1,Object.defineProperty(us,"__esModule",{value:!0});function e(r,s){if(Array.isArray(s))return!1;for(let i in r)if(!n(r[i],s[i]))return!1;for(let i in s)if(r[i]===void 0)return!1;return!0}function t(r,s){if(!Array.isArray(s)||r.length!==s.length)return!1;for(let i=0;i<r.length;i++)if(!n(r[i],s[i]))return!1;return!0}function n(r,s){return r===s?!0:r===null||s===null||typeof r!="object"||typeof s!="object"?!1:Array.isArray(r)?t(r,s):e(r,s)}return us.default=n,us}var hs={},uc;function b_(){if(uc)return hs;uc=1,Object.defineProperty(hs,"__esModule",{value:!0});function e(t){if(t===null)return null;if(Array.isArray(t))return t.map(e);if(typeof t=="object"){const n={};for(let r in t)n[r]=e(t[r]);return n}else return t}return hs.default=e,hs}var Ai={},hc;function dc(){return hc||(hc=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.eachChildOf=e.advancer=e.readCursor=e.writeCursor=e.WriteCursor=e.ReadCursor=e.isValidPathItem=void 0;function t(u,h){if(!u)throw new Error(h)}const n=u=>u!=null&&typeof u=="object"&&!Array.isArray(u),r=(u,h)=>typeof u==typeof h?u>h:typeof u=="string"&&typeof h=="number";function s(u,h){for(let d in u){const m=d;h.write(m,u[m])}}e.isValidPathItem=u=>typeof u=="number"||typeof u=="string"&&u!=="__proto__";class i{constructor(h=null){this.parents=[],this.indexes=[],this.lcIdx=-1,this.idx=-1,this.container=h}ascend(){t(this.parents.length===this.indexes.length/2),this.idx===0?this.parents.length?(this.lcIdx=this.indexes.pop(),this.container=this.parents.pop(),this.idx=this.indexes.pop()):(this.lcIdx=0,this.idx=-1):(t(this.idx>0),this.idx--,n(this.container[this.idx])&&this.idx--)}getPath(){const h=[];let d=this.container,m=this.parents.length-1,_=this.idx;for(;_>=0;)h.unshift(d[_]),_===0?(_=this.indexes[m*2],d=this.parents[m--]):_-=n(d[_-1])?2:1;return h}}class o extends i{get(){return this.container?this.container.slice(this.idx+1):null}getKey(){return t(this.container!=null,"Invalid call to getKey before cursor descended"),this.container[this.idx]}getComponent(){let h;return this.container&&this.container.length>this.idx+1&&n(h=this.container[this.idx+1])?h:null}descendFirst(){let h=this.idx+1;if(!this.container||h>=this.container.length||n(this.container[h])&&h+1>=this.container.length)return!1;n(this.container[h])&&h++;const d=this.container[h];return Array.isArray(d)?(this.indexes.push(this.idx),this.parents.push(this.container),this.indexes.push(h),this.idx=0,this.container=d):this.idx=h,!0}nextSibling(){if(t(this.parents.length===this.indexes.length/2),this.idx>0||this.parents.length===0)return!1;const h=this.indexes[this.indexes.length-1]+1,d=this.parents[this.parents.length-1];return h>=d.length?!1:(t(!isNaN(h)),this.indexes[this.indexes.length-1]=h,this.container=d[h],!0)}_init(h,d,m,_){this.container=h,this.idx=d,this.parents=m.slice(),this.indexes=_.slice()}clone(){const h=new o;return h._init(this.container,this.idx,this.parents,this.indexes),h}*[Symbol.iterator](){if(this.descendFirst()){do yield this.getKey();while(this.nextSibling());this.ascend()}}traverse(h,d){const m=this.getComponent();m&&d(m,h);for(const _ of this)h&&h.descend(_),this.traverse(h,d),h&&h.ascend()}eachPick(h,d){this.traverse(h,(m,_)=>{m.p!=null&&d(m.p,_)})}eachDrop(h,d){this.traverse(h,(m,_)=>{m.d!=null&&d(m.d,_)})}}e.ReadCursor=o;class a extends i{constructor(h=null){super(h),this.pendingDescent=[],this._op=h}flushDescent(){t(this.parents.length===this.indexes.length/2),this.container===null&&(this._op=this.container=[]);for(let h=0;h<this.pendingDescent.length;h++){const d=this.pendingDescent[h];let m=this.idx+1;if(m<this.container.length&&n(this.container[m])&&m++,t(m===this.container.length||!n(this.container[m])),m===this.container.length)this.container.push(d),this.idx=m;else if(this.container[m]===d)this.idx=m;else{if(!Array.isArray(this.container[m])){const _=this.container.splice(m,this.container.length-m);this.container.push(_),this.lcIdx>-1&&(this.lcIdx=m)}for(this.indexes.push(this.idx),this.parents.push(this.container),this.lcIdx!==-1&&(t(r(d,this.container[this.lcIdx][0])),m=this.lcIdx+1,this.lcIdx=-1);m<this.container.length&&r(d,this.container[m][0]);)m++;if(this.indexes.push(m),this.idx=0,m<this.container.length&&this.container[m][0]===d)this.container=this.container[m];else{const _=[d];this.container.splice(m,0,_),this.container=_}}}this.pendingDescent.length=0}reset(){this.lcIdx=-1}getComponent(){this.flushDescent();const h=this.idx+1;if(h<this.container.length&&n(this.container[h]))return this.container[h];{const d={};return this.container.splice(h,0,d),d}}write(h,d){const m=this.getComponent();t(m[h]==null||m[h]===d,"Internal consistency error: Overwritten component. File a bug"),m[h]=d}get(){return this._op}descend(h){if(!e.isValidPathItem(h))throw Error("Invalid JSON key");this.pendingDescent.push(h)}descendPath(h){return this.pendingDescent.push(...h),this}ascend(){this.pendingDescent.length?this.pendingDescent.pop():super.ascend()}mergeTree(h,d=s){if(h===null)return;if(t(Array.isArray(h)),h===this._op)throw Error("Cannot merge into my own tree");const m=this.lcIdx,_=this.parents.length;let p=0;for(let I=0;I<h.length;I++){const A=h[I];typeof A=="string"||typeof A=="number"?(p++,this.descend(A)):Array.isArray(A)?this.mergeTree(A,d):typeof A=="object"&&d(A,this)}for(;p--;)this.ascend();this.lcIdx=this.parents.length===_?m:-1}at(h,d){this.descendPath(h),d(this);for(let m=0;m<h.length;m++)this.ascend();return this}writeAtPath(h,d,m){return this.at(h,()=>this.write(d,m)),this.reset(),this}writeMove(h,d,m=0){return this.writeAtPath(h,"p",m).writeAtPath(d,"d",m)}getPath(){const h=super.getPath();return h.push(...this.pendingDescent),h}}e.WriteCursor=a,e.writeCursor=()=>new a,e.readCursor=u=>new o(u);function l(u,h,d){let m,_;_=m=u?u.descendFirst():!1;function p(I){let A;for(;_;){const B=A=u.getKey();if(I!=null){let x=!1;if(h&&typeof B=="number"&&(A=h(B,u.getComponent()),A<0&&(A=~A,x=!0)),r(A,I))return null;if(A===I&&!x)return u}d&&typeof A=="number"&&d(A,u.getComponent()),_=u.nextSibling()}return null}return p.end=()=>{m&&u.ascend()},p}e.advancer=l;function c(u,h,d){let m,_,p,I;for(m=_=u&&u.descendFirst(),p=I=h&&h.descendFirst();m||p;){let A=m?u.getKey():null,B=p?h.getKey():null;A!==null&&B!==null&&(r(B,A)?B=null:A!==B&&(A=null)),d(A==null?B:A,A!=null?u:null,B!=null?h:null),A!=null&&m&&(m=u.nextSibling()),B!=null&&p&&(p=h.nextSibling())}_&&u.ascend(),I&&h.ascend()}e.eachChildOf=c})(Ai)),Ai}var Ti={},fc;function mc(){return fc||(fc=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ConflictType=void 0,(function(t){t[t.RM_UNEXPECTED_CONTENT=1]="RM_UNEXPECTED_CONTENT",t[t.DROP_COLLISION=2]="DROP_COLLISION",t[t.BLACKHOLE=3]="BLACKHOLE"})(e.ConflictType||(e.ConflictType={}))})(Ti)),Ti}var wt={},pn={},gc;function yi(){return gc||(gc=1,Object.defineProperty(pn,"__esModule",{value:!0}),pn.uniToStrPos=pn.strPosToUni=void 0,pn.strPosToUni=(e,t=e.length)=>{let n=0,r=0;for(;r<t;r++){const s=e.charCodeAt(r);s>=55296&&s<=57343&&(n++,r++)}if(r!==t)throw Error("Invalid offset - splits unicode bytes");return r-n},pn.uniToStrPos=(e,t)=>{let n=0;for(;t>0;t--){const r=e.charCodeAt(n);n+=r>=55296&&r<=57343?2:1}return n}),pn}var Ni={},_c;function Mi(){return _c||(_c=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.uniSlice=e.dlen=e.eachOp=void 0;const t=yi(),n=O=>{if(!Array.isArray(O))throw Error("Op must be an array of components");let R=null;for(let b=0;b<O.length;b++){const y=O[b];switch(typeof y){case"object":if(typeof y.d!="number"&&typeof y.d!="string")throw Error("Delete must be number or string");if(e.dlen(y.d)<=0)throw Error("Deletes must not be empty");break;case"string":if(!(y.length>0))throw Error("Inserts cannot be empty");break;case"number":if(!(y>0))throw Error("Skip components must be >0");if(typeof R=="number")throw Error("Adjacent skip components should be combined");break}R=y}if(typeof R=="number")throw Error("Op has a trailing skip")};function r(O,R){let b=0,y=0;for(let $=0;$<O.length;$++){const H=O[$];switch(R(H,b,y),typeof H){case"object":b+=e.dlen(H.d);break;case"string":y+=t.strPosToUni(H);break;case"number":b+=H,y+=H;break}}}e.eachOp=r;function s(O,R){const b=[],y=a(b);return r(O,($,H,g)=>{y(R($,H,g))}),h(b)}const i=O=>O,o=O=>s(O,i);e.dlen=O=>typeof O=="number"?O:t.strPosToUni(O);const a=O=>R=>{if(!(!R||R.d===0||R.d===""))if(O.length===0)O.push(R);else if(typeof R==typeof O[O.length-1])if(typeof R=="object"){const b=O[O.length-1];b.d=typeof b.d=="string"&&typeof R.d=="string"?b.d+R.d:e.dlen(b.d)+e.dlen(R.d)}else O[O.length-1]+=R;else O.push(R)},l=O=>typeof O=="number"?O:typeof O=="string"?t.strPosToUni(O):typeof O.d=="number"?O.d:t.strPosToUni(O.d);e.uniSlice=(O,R,b)=>{const y=t.uniToStrPos(O,R),$=b==null?1/0:t.uniToStrPos(O,b);return O.slice(y,$)};const c=(O,R,b)=>typeof O=="number"?b==null?O-R:Math.min(O,b)-R:e.uniSlice(O,R,b),u=O=>{let R=0,b=0;return{take:(H,g)=>{if(R===O.length)return H===-1?null:H;const P=O[R];let v;if(typeof P=="number")return H===-1||P-b<=H?(v=P-b,++R,b=0,v):(b+=H,H);if(typeof P=="string"){if(H===-1||g==="i"||t.strPosToUni(P.slice(b))<=H)return v=P.slice(b),++R,b=0,v;{const M=b+t.uniToStrPos(P.slice(b),H);return v=P.slice(b,M),b=M,v}}else{if(H===-1||g==="d"||e.dlen(P.d)-b<=H)return v={d:c(P.d,b)},++R,b=0,v;{let M=c(P.d,b,b+H);return b+=H,{d:M}}}},peek:()=>O[R]}},h=O=>(O.length>0&&typeof O[O.length-1]=="number"&&O.pop(),O);function d(O,R,b){if(b!=="left"&&b!=="right")throw Error("side ("+b+") must be 'left' or 'right'");n(O),n(R);const y=[],$=a(y),{take:H,peek:g}=u(O);for(let v=0;v<R.length;v++){const M=R[v];let T,w;switch(typeof M){case"number":for(T=M;T>0;)w=H(T,"i"),$(w),typeof w!="string"&&(T-=l(w));break;case"string":b==="left"&&typeof g()=="string"&&$(H(-1)),$(t.strPosToUni(M));break;case"object":for(T=e.dlen(M.d);T>0;)switch(w=H(T,"i"),typeof w){case"number":T-=w;break;case"string":$(w);break;case"object":T-=e.dlen(w.d)}break}}let P;for(;P=H(-1);)$(P);return h(y)}function m(O,R){n(O),n(R);const b=[],y=a(b),{take:$}=u(O);for(let g=0;g<R.length;g++){const P=R[g];let v,M;switch(typeof P){case"number":for(v=P;v>0;)M=$(v,"d"),y(M),typeof M!="object"&&(v-=l(M));break;case"string":y(P);break;case"object":v=e.dlen(P.d);let T=0;for(;T<v;)switch(M=$(v-T,"d"),typeof M){case"number":y({d:c(P.d,T,T+M)}),T+=M;break;case"string":T+=t.strPosToUni(M);break;case"object":y(M)}break}}let H;for(;H=$(-1);)y(H);return h(b)}const _=(O,R)=>{let b=0;for(let y=0;y<R.length&&O>b;y++){const $=R[y];switch(typeof $){case"number":{b+=$;break}case"string":const H=t.strPosToUni($);b+=H,O+=H;break;case"object":O-=Math.min(e.dlen($.d),O-b);break}}return O},p=(O,R)=>typeof O=="number"?_(O,R):O.map(b=>_(b,R));function I(O,R,b){return s(O,(y,$)=>typeof y=="object"&&typeof y.d=="number"?{d:b.slice(R,$,$+y.d)}:y)}function A(O){return s(O,R=>{switch(typeof R){case"object":if(typeof R.d=="number")throw Error("Cannot invert text op: Deleted characters missing from operation. makeInvertible must be called first.");return R.d;case"string":return{d:R};case"number":return R}})}function B(O){return s(O,R=>typeof R=="object"&&typeof R.d=="string"?{d:t.strPosToUni(R.d)}:R)}function x(O){let R=!0;return r(O,b=>{typeof b=="object"&&typeof b.d=="number"&&(R=!1)}),R}function Y(O){return{name:"text-unicode",uri:"http://sharejs.org/types/text-unicode",trim:h,normalize:o,checkOp:n,create(R=""){if(typeof R!="string")throw Error("Initial data must be a string");return O.create(R)},apply(R,b){n(b);const y=O.builder(R);for(let $=0;$<b.length;$++){const H=b[$];switch(typeof H){case"number":y.skip(H);break;case"string":y.append(H);break;case"object":y.del(e.dlen(H.d));break}}return y.build()},transform:d,compose:m,transformPosition:_,transformSelection:p,isInvertible:x,makeInvertible(R,b){return I(R,b,O)},stripInvertible:B,invert:A,invertWithDoc(R,b){return A(I(R,b,O))},isNoop:R=>R.length===0}}e.default=Y})(Ni)),Ni}var ds={},pc;function A_(){if(pc)return ds;pc=1,Object.defineProperty(ds,"__esModule",{value:!0});const e=Mi(),t=yi();function n(r,s){return{get:r,getLength(){return r().length},insert(i,o,a){const l=t.strPosToUni(r(),i);return s([l,o],a)},remove(i,o,a){const l=t.strPosToUni(r(),i);return s([l,{d:o}],a)},_onOp(i){e.eachOp(i,(o,a,l)=>{switch(typeof o){case"string":this.onInsert&&this.onInsert(l,o);break;case"object":const c=e.dlen(o.d);this.onRemove&&this.onRemove(l,c)}})},onInsert:null,onRemove:null}}return ds.default=n,n.provides={text:!0},ds}var Ec;function T_(){return Ec||(Ec=1,(function(e){var t=wt&&wt.__createBinding||(Object.create?(function(d,m,_,p){p===void 0&&(p=_),Object.defineProperty(d,p,{enumerable:!0,get:function(){return m[_]}})}):(function(d,m,_,p){p===void 0&&(p=_),d[p]=m[_]})),n=wt&&wt.__setModuleDefault||(Object.create?(function(d,m){Object.defineProperty(d,"default",{enumerable:!0,value:m})}):function(d,m){d.default=m}),r=wt&&wt.__importStar||function(d){if(d&&d.__esModule)return d;var m={};if(d!=null)for(var _ in d)Object.hasOwnProperty.call(d,_)&&t(m,d,_);return n(m,d),m},s=wt&&wt.__importDefault||function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(e,"__esModule",{value:!0}),e.type=e.remove=e.insert=void 0;const i=yi(),o=r(Mi()),a=s(A_()),l={create(d){return d},toString(d){return d},builder(d){if(typeof d!="string")throw Error("Invalid document snapshot: "+d);const m=[];return{skip(_){let p=i.uniToStrPos(d,_);if(p>d.length)throw Error("The op is too long for this document");m.push(d.slice(0,p)),d=d.slice(p)},append(_){m.push(_)},del(_){d=d.slice(i.uniToStrPos(d,_))},build(){return m.join("")+d}}},slice:o.uniSlice},c=o.default(l),u=Object.assign(Object.assign({},c),{api:a.default});e.type=u,e.insert=(d,m)=>m.length===0?[]:d===0?[m]:[d,m],e.remove=(d,m)=>o.dlen(m)===0?[]:d===0?[{d:m}]:[d,{d:m}];var h=Mi();Object.defineProperty(e,"makeType",{enumerable:!0,get:function(){return h.default}})})(wt)),wt}var Cc;function y_(){return Cc||(Cc=1,(function(e){var t=hr&&hr.__importDefault||function(S){return S&&S.__esModule?S:{default:S}};Object.defineProperty(e,"__esModule",{value:!0}),e.editOp=e.replaceOp=e.insertOp=e.moveOp=e.removeOp=e.type=void 0;const n=t(w_()),r=t(b_()),s=dc(),i=mc();function o(S,U){if(!S)throw new Error(U)}e.type={name:"json1",uri:"http://sharejs.org/types/JSONv1",readCursor:s.readCursor,writeCursor:s.writeCursor,create:S=>S,isNoop:S=>S==null,setDebug(S){},registerSubtype:A,checkValidOp:$,normalize:H,apply:g,transformPosition:P,compose:v,tryTransform:D,transform:Q,makeInvertible:w,invert:M,invertWithDoc:N,RM_UNEXPECTED_CONTENT:i.ConflictType.RM_UNEXPECTED_CONTENT,DROP_COLLISION:i.ConflictType.DROP_COLLISION,BLACKHOLE:i.ConflictType.BLACKHOLE,transformNoConflict:(S,U,G)=>ue(()=>!0,S,U,G),typeAllowingConflictsPred:S=>Object.assign(Object.assign({},e.type),{transform:(U,G,V)=>ue(S,U,G,V)})};const a=S=>S?S.getComponent():null;function l(S){return S&&typeof S=="object"&&!Array.isArray(S)}const c=S=>Array.isArray(S)?S.slice():S!==null&&typeof S=="object"?Object.assign({},S):S,u=S=>S&&(S.p!=null||S.r!==void 0),h=S=>S&&(S.d!=null||S.i!==void 0);function d(S,U){return o(S!=null),typeof U=="number"?(o(Array.isArray(S),"Invalid key - child is not an array"),(S=S.slice()).splice(U,1)):(o(l(S),"Invalid key - child is not an object"),delete(S=Object.assign({},S))[U]),S}function m(S,U,G){return typeof U=="number"?(o(S!=null,"Container is missing for key"),o(Array.isArray(S),"Cannot use numerical key for object container"),o(S.length>=U,"Cannot insert into out of bounds index"),S.splice(U,0,G)):(o(l(S),"Cannot insert into missing item"),o(S[U]===void 0,"Trying to overwrite value at key. Your op needs to remove it first"),S[U]=G),G}e.removeOp=(S,U=!0)=>s.writeCursor().writeAtPath(S,"r",U).get(),e.moveOp=(S,U)=>s.writeCursor().writeMove(S,U).get(),e.insertOp=(S,U)=>s.writeCursor().writeAtPath(S,"i",U).get(),e.replaceOp=(S,U,G)=>s.writeCursor().at(S,V=>{V.write("r",U),V.write("i",G)}).get(),e.editOp=(S,U,G,V=!1)=>s.writeCursor().at(S,j=>R(j,U,G,V)).get();const _=(S,U)=>S!=null&&(typeof U=="number"?Array.isArray(S):typeof S=="object"),p=(S,U)=>_(S,U)?S[U]:void 0,I={};function A(S){let U=S.type?S.type:S;U.name&&(I[U.name]=U),U.uri&&(I[U.uri]=U)}const B=S=>{const U=I[S];if(U)return U;throw Error("Missing type: "+S)};A(T_());const x=(S,U)=>S+U;A({name:"number",apply:x,compose:x,invert:S=>-S,transform:S=>S});const Y=S=>S==null?null:S.et?B(S.et):S.es?I["text-unicode"]:S.ena!=null?I.number:null,O=S=>S.es?S.es:S.ena!=null?S.ena:S.e,R=(S,U,G,V=!1)=>{const[j,W]=typeof U=="string"?[B(U),U]:[U,U.name];!V&&j.isNoop&&j.isNoop(G)||(W==="number"?S.write("ena",G):W==="text-unicode"?S.write("es",G):(S.write("et",W),S.write("e",G)))};function b(S){o(typeof S=="number"),o(S>=0),o(S===(0|S))}function y(S){typeof S=="number"?b(S):o(typeof S=="string")}function $(S){if(S===null)return;const U=new Set,G=new Set,V=W=>{let ee=!0,te=!1;for(let k in W){const K=W[k];if(ee=!1,o(k==="p"||k==="r"||k==="d"||k==="i"||k==="e"||k==="es"||k==="ena"||k==="et","Invalid component item '"+k+"'"),k==="p")b(K),o(!U.has(K)),U.add(K),o(W.r===void 0);else if(k==="d")b(K),o(!G.has(K)),G.add(K),o(W.i===void 0);else if(k==="e"||k==="es"||k==="ena"){o(!te),te=!0;const q=Y(W);o(q,"Missing type in edit"),q.checkValidOp&&q.checkValidOp(O(W))}}o(!ee)},j=(W,ee,te)=>{if(!Array.isArray(W))throw Error("Op must be null or a list");if(W.length===0)throw Error("Empty descent");ee||y(W[0]);let k=1,K=0,q=0;for(let re=0;re<W.length;re++){const ge=W[re];if(o(ge!=null),Array.isArray(ge)){const Ee=j(ge,!1);if(K){const X=typeof q,de=typeof Ee;X===de?o(q<Ee,"descent keys are not in order"):o(X==="number"&&de==="string")}q=Ee,K++,k=3}else typeof ge=="object"?(o(k===1,`Prev not scalar - instead ${k}`),V(ge),k=2):(o(k!==3),y(ge),o(s.isValidPathItem(ge),"Invalid path key"),k=1)}return o(K!==1,"Operation makes multiple descents. Remove some []"),o(k===2||k===3),W[0]};j(S,!0),o(U.size===G.size,"Mismatched picks and drops in op");for(let W=0;W<U.size;W++)o(U.has(W)),o(G.has(W))}function H(S){let U=0,G=[];const V=s.writeCursor();return V.mergeTree(S,(j,W)=>{const ee=Y(j);if(ee){const k=O(j);R(W,ee,ee.normalize?ee.normalize(k):k)}for(const k of["r","p","i","d"])if(j[k]!==void 0){const K=k==="p"||k==="d"?(te=j[k],G[te]==null&&(G[te]=U++),G[te]):j[k];W.write(k,K)}var te}),V.get()}function g(S,U){if($(U),U===null)return S;const G=[];return(function V(j,W){let ee=j,te=0,k={root:j},K=0,q=k,re="root";function ge(){for(;K<te;K++){let Ee=W[K];typeof Ee!="object"&&(o(_(q,re)),q=q[re]=c(q[re]),re=Ee)}}for(;te<W.length;te++){const Ee=W[te];if(Array.isArray(Ee)){const X=V(ee,Ee);X!==ee&&X!==void 0&&(ge(),ee=q[re]=X)}else if(typeof Ee=="object"){Ee.d!=null?(ge(),ee=m(q,re,G[Ee.d])):Ee.i!==void 0&&(ge(),ee=m(q,re,Ee.i));const X=Y(Ee);if(X)ge(),ee=q[re]=X.apply(ee,O(Ee));else if(Ee.e!==void 0)throw Error("Subtype "+Ee.et+" undefined")}else ee=p(ee,Ee)}return k.root})(S=(function V(j,W){const ee=[];let te=0;for(;te<W.length;te++){const re=W[te];if(Array.isArray(re))break;typeof re!="object"&&(ee.push(j),j=p(j,re))}for(let re=W.length-1;re>=te;re--)j=V(j,W[re]);for(--te;te>=0;te--){const re=W[te];if(typeof re!="object"){const ge=ee.pop();j=j===p(ge,re)?ge:j===void 0?d(ge,re):(K=re,q=j,(k=c(k=ge))[K]=q,k)}else u(re)&&(o(j!==void 0,"Cannot pick up or remove undefined"),re.p!=null&&(G[re.p]=j),j=void 0)}var k,K,q;return j})(S,U),U)}function P(S,U){S=S.slice(),$(U);const G=s.readCursor(U);let V,j,W=!1;const ee=[];for(let k=0;;k++){const K=S[k],q=G.getComponent();if(q&&(q.r!==void 0?W=!0:q.p!=null&&(W=!1,V=q.p,j=k)),k>=S.length)break;let re=0;const ge=s.advancer(G,void 0,(X,de)=>{u(de)&&re++});ee.unshift(ge);const Ee=ge(K);if(typeof K=="number"&&(S[k]-=re),!Ee)break}if(ee.forEach(k=>k.end()),W)return null;const te=()=>{let k=0;if(V!=null){const K=G.getPath();k=K.length,S=K.concat(S.slice(j))}for(;k<S.length;k++){const K=S[k],q=a(G),re=Y(q);if(re){const X=O(q);re.transformPosition&&(S[k]=re.transformPosition(S[k],X));break}let ge=0;const Ee=s.advancer(G,(X,de)=>h(de)?~(X-ge):X-ge,(X,de)=>{h(de)&&ge++})(K);if(typeof K=="number"&&(S[k]+=ge),!Ee)break}};return V!=null?G.eachDrop(null,k=>{k===V&&te()}):te(),S}function v(S,U){if($(S),$(U),S==null)return U;if(U==null)return S;let G=0;const V=s.readCursor(S),j=s.readCursor(U),W=s.writeCursor(),ee=[],te=[],k=[],K=[],q=[],re=[],ge=new Set;V.traverse(null,X=>{X.p!=null&&(k[X.p]=V.clone())}),j.traverse(null,X=>{X.d!=null&&(K[X.d]=j.clone())});const Ee=s.writeCursor();return(function X(de,Fe,Le,Oe,$e,Gt,rt,Qe){o(Fe||Le);const He=a(Fe),St=a(Le),Tt=!!St&&St.r!==void 0,On=!!He&&He.i!==void 0,Ot=He?He.d:null,ft=St?St.p:null,Vt=(Gt||Tt)&&ft==null;if(ft!=null)Oe=K[ft],rt=te[ft]=new s.WriteCursor;else if(St&&St.r!==void 0)Oe=null;else{const ie=a(Oe);ie&&ie.d!=null&&(Oe=null)}const Te=a(Oe);if(Ot!=null)if(de=k[Ot],Qe=ee[Ot]=new s.WriteCursor,Vt)Gt&&!Tt&&Qe.write("r",!0);else{const ie=q[Ot]=G++;rt.write("d",ie)}else if(He&&He.i!==void 0)de=null;else{const ie=a(de);ie&&ie.p!=null&&(de=null)}let ce;On?(o($e===void 0),ce=He.i):ce=$e;const Ie=(ft==null?!On||Gt||Tt:ce===void 0)?null:rt.getComponent();if(ft!=null){if(!($e!==void 0||On)){const ie=Ot!=null?q[Ot]:G++;re[ft]=ie,Qe.write("p",ie)}}else Tt&&(On||$e!==void 0||(St.r,Qe.write("r",St.r)));const he=Vt?null:Y(He),se=Y(Te);if((he||se)&&(he&&he.name,se&&se.name),he&&se){o(he===se);const ie=O(He),Se=O(Te),Xe=he.compose(ie,Se);R(rt,he,Xe),ge.add(Te)}else he?R(rt,he,O(He)):se&&(R(rt,se,O(Te)),ge.add(Te));const me=typeof ce=="object"&&ce!=null;let Ae=!1,be=0,ye=0,Ke=0,Ve=0,je=0;const nt=s.advancer(Oe,(ie,Se)=>h(Se)?Ve-ie-1:ie-Ve,(ie,Se)=>{h(Se)&&Ve++}),we=s.advancer(de,(ie,Se)=>u(Se)?be-ie-1:ie-be,(ie,Se)=>{u(Se)&&be++});if(s.eachChildOf(Fe,Le,(ie,Se,Xe)=>{let it,zt,vn=ie,yt=ie,zr=ie;if(typeof ie=="number"){let et=ie+Ke;zt=nt(et),yt=et+Ve;let Ye=ie+ye;it=we(Ye),h(a(zt))&&(it=null),vn=Ye+be,zr=ie+je,o(vn>=0,"p1PickKey is negative"),o(yt>=0,"p2DropKey is negative");const Nt=h(a(Se)),Kt=u(a(Xe));(Nt||Kt&&!Vt)&&je--,Nt&&ye--,Kt&&Ke--}else it=we(ie),zt=nt(ie);Qe.descend(vn),rt.descend(yt);const Qn=me&&!h(a(Se))?ce[zr]:void 0,xt=X(it,Se,Xe,zt,Qn,Vt,rt,Qe);var Bt,_e,Be;me&&!Vt?Qn!==xt&&(Ae||(ce=Array.isArray(ce)?ce.slice():Object.assign({},ce),Ae=!0),Bt=ce,Be=xt,typeof(_e=zr)=="number"?(o(Array.isArray(Bt)),o(_e<Bt.length)):(o(!Array.isArray(Bt)),o(Bt[_e]!==void 0)),Be===void 0?typeof _e=="number"?Bt.splice(_e,1):delete Bt[_e]:Bt[_e]=Be):o(xt===void 0),rt.ascend(),Qe.ascend()}),we.end(),nt.end(),Ie!=null)Ie.i=ce;else if(!Gt&&!Tt&&ft==null)return ce})(V,V.clone(),j,j.clone(),void 0,!1,W,Ee),W.reset(),W.mergeTree(Ee.get()),W.reset(),W.get(),ee.map(X=>X.get()),te.map(X=>X.get()),V.traverse(W,(X,de)=>{const Fe=X.p;if(Fe!=null){const Le=q[Fe];Le!=null&&de.write("p",Le);const Oe=ee[Fe];Oe&&Oe.get(),Oe&&de.mergeTree(Oe.get())}else X.r!==void 0&&de.write("r",X.r)}),W.reset(),W.get(),j.traverse(W,(X,de)=>{const Fe=X.d;if(Fe!=null){const Oe=re[Fe];Oe!=null&&de.write("d",Oe);const $e=te[Fe];$e&&de.mergeTree($e.get())}else X.i!==void 0&&de.write("i",X.i);const Le=Y(X);Le&&!ge.has(X)&&R(de,Le,O(X))}),W.get()}function M(S){if(S==null)return null;const U=new s.ReadCursor(S),G=new s.WriteCursor;let V;const j=[],W=[];return(function ee(te,k,K){const q=te.getComponent();let re,ge=!1;if(q){q.p!=null&&(k.write("d",q.p),j[q.p]=te.clone()),q.r!==void 0&&k.write("i",q.r),q.d!=null&&(k.write("p",q.d),K=void 0),q.i!==void 0&&(K=re=q.i);const X=Y(q);X&&(K===void 0?(V||(V=new Set),V.add(q)):(O(q),K=X.apply(K,O(q)),ge=!0))}let Ee=0;for(const X of te){k.descend(X);const de=typeof X=="number"?X-Ee:X,Fe=p(K,de);h(te.getComponent())&&Ee++;const Le=ee(te,k,Fe);if(K!==void 0&&Le!==void 0){if(ge||(ge=!0,K=c(K)),!_(K,de))throw Error("Cannot modify child - invalid operation");K[de]=Le}k.ascend()}if(re===void 0)return ge?K:void 0;k.write("r",K)})(U,G,void 0),V&&(G.reset(),(function ee(te,k,K){const q=k.getComponent();if(q){const X=q.d;if(X!=null&&(te=j[X],K=W[X]=s.writeCursor()),V.has(q)){const de=Y(q);if(!de.invert)throw Error(`Cannot invert subtype ${de.name}`);R(K,de,de.invert(O(q)))}}let re=0,ge=0;const Ee=s.advancer(te,(X,de)=>u(de)?re-X-1:X-re,(X,de)=>{u(de)&&re++});for(const X of k)if(typeof X=="number"){const de=X-ge,Fe=Ee(de),Le=de+re;K.descend(Le),ee(Fe,k,K),h(k.getComponent())&&ge++,K.ascend()}else K.descend(X),ee(Ee(X),k,K),K.ascend();Ee.end()})(U.clone(),U,G),W.length&&(G.reset(),U.traverse(G,(ee,te)=>{const k=ee.p;if(k!=null){const K=W[k];K&&K.get(),K&&te.mergeTree(K.get())}}))),G.get()}const T=(S,U)=>S.some(G=>typeof G=="object"&&(Array.isArray(G)?T(G,U):U(G)));function w(S,U){if(S==null||!T(S,k=>{var K;return k.r!==void 0||((K=Y(k))===null||K===void 0?void 0:K.makeInvertible)!=null}))return S;const G=new s.ReadCursor(S),V=new s.WriteCursor;let j=!1;const W=[],ee=[],te=(k,K,q)=>{const re=k.getComponent();let ge=!1;if(re){re.d!=null&&K.write("d",re.d),re.i!==void 0&&K.write("i",re.i);const X=re.p;if(X!=null&&(W[X]=k.clone(),o(q!==void 0,"Operation picks up at an invalid key"),ee[X]=q,K.write("p",re.p)),re.r!==void 0&&q===void 0)throw Error("Invalid doc / op in makeInvertible: removed item missing from doc");const de=Y(re);de&&(de.makeInvertible?j=!0:R(K,de,O(re),!0))}let Ee=0;for(const X of k){K.descend(X);const de=typeof X=="number"?X-Ee:X,Fe=p(q,de),Le=te(k,K,Fe);Fe!==Le&&(ge||(ge=!0,q=c(q)),Le===void 0?(q=d(q,de),typeof X=="number"&&Ee++):q[de]=Le),K.ascend()}return re&&(re.r!==void 0?(K.write("r",r.default(q)),q=void 0):re.p!=null&&(q=void 0)),q};return te(G,V,U),V.get(),j&&(V.reset(),(function k(K,q,re,ge,Ee){const X=q.getComponent();if(X){X.i!==void 0?(ge=X.i,Ee=!0):X.d!=null&&(ge=ee[X.d],K=W[X.d],Ee=!1,X.d);let Oe=Y(X);if(Oe&&Oe.makeInvertible){const $e=O(X);R(re,Oe,Oe.makeInvertible($e,ge),!0)}}let de=0,Fe=0;const Le=s.advancer(K,(Oe,$e)=>u($e)?de-Oe-1:Oe-de,(Oe,$e)=>{u($e)&&de++});for(const Oe of q)if(typeof Oe=="number"){const $e=Oe-Fe,Gt=Le($e),rt=$e+de,Qe=p(ge,Ee?$e:rt);re.descend(Oe),k(Gt,q,re,Qe,Ee),h(q.getComponent())&&Fe++,re.ascend()}else{const $e=p(ge,Oe);re.descend(Oe),k(Le(Oe),q,re,$e,Ee),re.ascend()}Le.end()})(G.clone(),G,V,U,!1)),V.get()}function N(S,U){return M(w(S,U))}const L=S=>{if(S==null)return null;const U=S.slice();for(let G=0;G<S.length;G++){const V=U[G];Array.isArray(V)&&(U[G]=L(V))}return U};function D(S,U,G){o(G==="left"||G==="right","Direction must be left or right");const V=G==="left"?0:1;if(U==null)return{ok:!0,result:S};$(S),$(U);let j=null;const W=[],ee=[],te=[],k=[],K=[],q=[],re=[],ge=[],Ee=[],X=[],de=[],Fe=[],Le=[],Oe=[],$e=[];let Gt=0;const rt=s.readCursor(S),Qe=s.readCursor(U),He=s.writeCursor();if((function Te(ce,Ie=null,he){const se=a(Ie);se&&(se.r!==void 0?he=Ie.clone():se.p!=null&&(he=null,q[se.p]=ce.clone()));const me=ce.getComponent();let Ae;me&&(Ae=me.p)!=null&&(K[Ae]=Ie?Ie.clone():null,te[Ae]=ce.clone(),he&&(X[Ae]=!0,Ee[Ae]=he),se&&se.p!=null&&(Oe[Ae]=se.p));const be=s.advancer(Ie);for(const ye of ce)Te(ce,be(ye),he);be.end()})(Qe,rt,null),(function Te(ce,Ie,he,se,me){const Ae=he.getComponent();let be,ye=!1;Ae&&((be=Ae.d)!=null?(k[be]=he.clone(),se!=null&&($e[se]==null&&($e[se]=[]),$e[se].push(be)),X[be],ce=K[be]||null,Ie=te[be]||null,X[be]?(me&&(de[be]=!0),me=Ee[be]||null):!me||V!==1&&Oe[be]!=null||j==null&&(j={type:i.ConflictType.RM_UNEXPECTED_CONTENT,op1:e.removeOp(me.getPath()),op2:e.moveOp(Ie.getPath(),he.getPath())}),ye=!0):Ae.i!==void 0&&(ce=Ie=null,ye=!0,me&&j==null&&(j={type:i.ConflictType.RM_UNEXPECTED_CONTENT,op1:e.removeOp(me.getPath()),op2:e.insertOp(he.getPath(),Ae.i)})));const Ke=a(ce);Ke&&(Ke.r!==void 0?me=ce.clone():Ke.p!=null&&(Ke.p,se=Ke.p,me=null));const Ve=Y(Ae);Ve&&me&&j==null&&(j={type:i.ConflictType.RM_UNEXPECTED_CONTENT,op1:e.removeOp(me.getPath()),op2:e.editOp(he.getPath(),Ve,O(Ae),!0)});let je=0,nt=0;const we=s.advancer(Ie,(Se,Xe)=>u(Xe)?je-Se-1:Se-je,(Se,Xe)=>{u(Xe)&&je++}),ie=s.advancer(ce);for(const Se of he)if(typeof Se=="number"){const Xe=Se-nt,it=we(Xe);nt+=+Te(ie(Xe+je),it,he,se,me)}else{const Xe=we(Se);Te(ie(Se),Xe,he,se,me)}return we.end(),ie.end(),ye})(rt,Qe,Qe.clone(),null,null),k.map(Te=>Te&&Te.get()),j)return{ok:!1,conflict:j};de.map(Te=>!!Te);const St=[];let Tt=null;(function Te(ce,Ie,he,se,me){let Ae=!1;const be=a(Ie);if(u(be)){const we=be.p;we!=null?(he=k[we],se=Fe[we]=s.writeCursor(),Ae=!0,me=null):(he=null,me=Ie.clone())}else h(a(he))&&(he=null);const ye=ce.getComponent();if(ye){const we=ye.p;we!=null?(me&&(ge[we]=me),St[we]=me||V===1&&Ae?null:se.getComponent(),W[we]=ce.clone(),he&&(re[we]=he.clone())):ye.r!==void 0&&(me||se.write("r",!0),(me||Ae)&&(Tt==null&&(Tt=new Set),Tt.add(ye)))}let Ke=0,Ve=0;const je=s.advancer(Ie,void 0,(we,ie)=>{u(ie)&&Ke++}),nt=s.advancer(he,(we,ie)=>h(ie)?~(we-Ve):we-Ve,(we,ie)=>{h(ie)&&Ve++});if(ce)for(const we of ce)if(typeof we=="string"){const ie=je(we),Se=nt(we);se.descend(we),Te(ce,ie,Se,se,me),se.ascend()}else{const ie=je(we),Se=we-Ke,Xe=u(a(ie))?null:nt(Se),it=Se+Ve;o(it>=0),se.descend(it),Te(ce,ie,Xe,se,me),se.ascend()}je.end(),nt.end()})(rt,Qe,Qe.clone(),He,null),He.reset();let On=[];if((function Te(ce,Ie,he,se,me,Ae){o(Ie);const be=Ie.getComponent();let ye=a(se),Ke=!1;const Ve=(_e,Be,et)=>_e?e.moveOp(_e.getPath(),Be.getPath()):e.insertOp(Be.getPath(),et.i);if(h(be)){const _e=be.d;_e!=null&&(ee[_e]=Ie.clone());const Be=_e!=null?St[_e]:null;let et=!1;if(be.i!==void 0||_e!=null&&Be){let Ye;ye&&(ye.i!==void 0||(Ye=ye.d)!=null&&!X[Ye])&&(et=Ye!=null?_e!=null&&_e===Oe[Ye]:n.default(ye.i,be.i),et||Ye!=null&&V!==1&&Oe[Ye]!=null||j==null&&(j={type:i.ConflictType.DROP_COLLISION,op1:Ve(_e!=null?W[_e]:null,Ie,be),op2:Ve(Ye!=null?te[Ye]:null,se,ye)})),et||(Ae?j==null&&(j={type:i.ConflictType.RM_UNEXPECTED_CONTENT,op1:Ve(_e!=null?W[_e]:null,Ie,be),op2:e.removeOp(Ae.getPath())}):(_e!=null?(On[Gt]=_e,me.write("d",Be.p=Gt++)):me.write("i",r.default(be.i)),Ke=!0))}else if(_e!=null&&!Be){const Ye=ge[_e];Ye&&(Ae=Ye.clone())}_e!=null?(ce=W[_e],he=q[_e],se=re[_e]):be.i!==void 0&&(ce=he=null,et||(se=null))}else u(a(ce))&&(ce=he=se=null);const je=a(ce),nt=a(he);if(u(nt)){const _e=nt.p;nt.r!==void 0&&(!je||je.r===void 0)||X[_e]?(se=null,Ae=he.clone()):_e!=null&&(se=k[_e],V!==1&&Oe[_e]!=null||((me=Le[_e])||(me=Le[_e]=s.writeCursor()),me.reset(),Ae=null))}else!h(be)&&h(ye)&&(se=null);ye=se!=null?se.getComponent():null;const we=Y(be);if(we){const _e=O(be);if(Ae)j==null&&(j={type:i.ConflictType.RM_UNEXPECTED_CONTENT,op1:e.editOp(Ie.getPath(),we,_e,!0),op2:e.removeOp(Ae.getPath())});else{const Be=Y(ye);let et;if(Be){if(we!==Be)throw Error("Transforming incompatible types");const Ye=O(ye);et=we.transform(_e,Ye,G)}else et=r.default(_e);R(me,we,et)}}let ie=0,Se=0,Xe=0,it=0,zt=0,vn=0,yt=ce!=null&&ce.descendFirst(),zr=yt;const Qn=s.advancer(he,void 0,(_e,Be)=>{u(Be)&&Xe++});let xt=se!=null&&se.descendFirst(),Bt=xt;for(const _e of Ie)if(typeof _e=="number"){let Be;const et=h(Ie.getComponent()),Ye=_e-Se;{let ln;for(;yt&&typeof(ln=ce.getKey())=="number";){ln+=ie;const Mt=ce.getComponent(),er=u(Mt);if(ln>Ye||ln===Ye&&(!er||V===0&&et))break;if(er){ie--;const wn=Mt.p;Oe.includes(wn),Mt.d,a(Le[Mt.d]),u(a(Le[Mt.d])),(Mt.r===void 0||Tt&&Tt.has(Mt))&&(wn==null||!St[wn]||V!==1&&Oe.includes(wn))||zt--}yt=ce.nextSibling()}Be=yt&&ln===Ye?ce:null}const Nt=Ye-ie;let Kt=Qn(Nt);const fa=Nt-Xe;let ti=null;{let ln,Mt;for(;xt&&typeof(ln=se.getKey())=="number";){Mt=ln-it;const er=se.getComponent(),wn=h(er);if(Mt>fa)break;if(Mt===fa){if(!wn){ti=se;break}{if(V===0&&et){ti=se;break}const cn=Kt&&u(Kt.getComponent());if(V===0&&cn)break}}if(wn){const cn=er.d;X[cn],Oe[cn],er.i===void 0&&(X[cn]||Oe[cn]!=null&&V!==1)?(X[cn]||Oe[cn]!=null&&V===0)&&(it++,vn--):it++}xt=se.nextSibling()}}const Id=fa+it+zt+vn;o(Id>=0,"trying to descend to a negative index"),me.descend(Id),et&&(Be=Kt=ti=null,Se++),Te(Be,Ie,Kt,ti,me,Ae)&&vn++,me.ascend()}else{let Be;for(;yt&&(Be=ce.getKey(),typeof Be!="string"||!(Be>_e||Be===_e));)yt=ce.nextSibling();const et=yt&&Be===_e?ce:null,Ye=Qn(_e);let Nt;for(;xt&&(Nt=se.getKey(),typeof Nt!="string"||!(Nt>_e||Nt===_e));)xt=se.nextSibling();const Kt=xt&&Nt===_e?se:null;me.descend(_e),Te(et,Ie,Ye,Kt,me,Ae),me.ascend()}return Qn.end(),zr&&ce.ascend(),Bt&&se.ascend(),Ke})(rt,rt.clone(),Qe,Qe.clone(),He,null),j)return{ok:!1,conflict:j};He.reset();const Ot=(Te,ce,Ie)=>Te.traverse(ce,(he,se)=>{he.d!=null&&Ie(he.d,Te,se)});(X.length||Fe.length)&&(Ot(Qe,He,(Te,ce,Ie)=>{X[Te]&&!de[Te]&&Ie.write("r",!0),Fe[Te]&&Ie.mergeTree(Fe[Te].get())}),He.reset());const ft=[],Vt=[];if((Le.length||X.length)&&!j){const Te=s.readCursor(L(He.get()));if(Ot(Te,null,(ce,Ie)=>{ft[ce]=Ie.clone()}),Le.forEach(ce=>{ce&&Ot(s.readCursor(ce.get()),null,(Ie,he)=>{ft[Ie]=he.clone()})}),(function ce(Ie,he,se,me,Ae,be){const ye=a(he);if(ye&&u(ye))if(ye.p!=null){const ie=ye.p;ft[ie].getPath(),se=ft[ie],me=Vt[ie]=s.writeCursor()}else ye.r!==void 0&&(se=null);else h(a(se))&&(se=null);const Ke=Ie.getComponent();if(Ke){let ie;if((ie=Ke.d)!=null){const Se=Le[ie];Se&&(Se.get(),me.mergeTree(Se.get()),se=s.readCursor(Se.get()))}}let Ve=0,je=0;const nt=s.advancer(he,void 0,(ie,Se)=>{u(Se)&&Ve--}),we=s.advancer(se,(ie,Se)=>h(Se)?-(ie-je)-1:ie-je,(ie,Se)=>{h(Se)&&je++});for(const ie of Ie)if(typeof ie=="number"){const Se=nt(ie),Xe=ie+Ve,it=we(Xe),zt=Xe+je;me.descend(zt),ce(Ie,Se,it,me),me.ascend()}else me.descend(ie),ce(Ie,nt(ie),we(ie),me),me.ascend();nt.end(),we.end()})(Qe,Te,Te.clone(),He),He.reset(),j)return{ok:!1,conflict:j};if(He.get(),Vt.length){const ce=Vt.map(he=>he?he.get():null),Ie=s.readCursor(L(He.get()));if(Ot(Ie,He,(he,se,me)=>{const Ae=ce[he];Ae&&(me.mergeTree(Ae),ce[he]=null)}),ce.find(he=>he)){const he=s.writeCursor(),se=s.writeCursor();let me=0,Ae=0;ce.forEach(be=>{be!=null&&Ot(s.readCursor(be),null,ye=>{const Ke=On[ye];he.writeMove(W[Ke].getPath(),ee[Ke].getPath(),me++);const Ve=$e[Ke];Ve&&Ve.forEach(je=>{X[je]||V!==1&&Oe[je]!=null||se.writeMove(te[je].getPath(),k[je].getPath(),Ae++)})})}),j={type:i.ConflictType.BLACKHOLE,op1:he.get(),op2:se.get()}}}}return j?{ok:!1,conflict:j}:{ok:!0,result:He.get()}}const F=S=>{const U=new Error("Transform detected write conflict");throw U.conflict=S,U.type=U.name="writeConflict",U};function Q(S,U,G){const V=D(S,U,G);if(V.ok)return V.result;F(V.conflict)}const z=S=>{const U=s.writeCursor();return s.readCursor(S).traverse(U,(G,V)=>{(h(G)||Y(G))&&V.write("r",!0)}),U.get()},le=(S,U)=>{const{type:G,op1:V,op2:j}=S;switch(G){case i.ConflictType.DROP_COLLISION:return U==="left"?[null,z(j)]:[z(V),null];case i.ConflictType.RM_UNEXPECTED_CONTENT:let W=!1;return s.readCursor(V).traverse(null,ee=>{ee.r!==void 0&&(W=!0)}),W?[null,z(j)]:[z(V),null];case i.ConflictType.BLACKHOLE:return[z(V),z(j)];default:throw Error("Unrecognised conflict: "+G)}};function ue(S,U,G,V){let j=null;for(;;){const W=D(U,G,V);if(W.ok)return v(j,W.result);{const{conflict:ee}=W;S(ee)||F(ee);const[te,k]=le(ee,V);U=v(H(U),te),G=v(H(G),k),j=v(j,k)}}}})(hr)),hr}var Rc;function N_(){return Rc||(Rc=1,(function(e){var t=_n&&_n.__createBinding||(Object.create?(function(i,o,a,l){l===void 0&&(l=a),Object.defineProperty(i,l,{enumerable:!0,get:function(){return o[a]}})}):(function(i,o,a,l){l===void 0&&(l=a),i[l]=o[a]})),n=_n&&_n.__exportStar||function(i,o){for(var a in i)a!=="default"&&!o.hasOwnProperty(a)&&t(o,i,a)};Object.defineProperty(e,"__esModule",{value:!0}),n(y_(),e);var r=dc();Object.defineProperty(e,"ReadCursor",{enumerable:!0,get:function(){return r.ReadCursor}}),Object.defineProperty(e,"WriteCursor",{enumerable:!0,get:function(){return r.WriteCursor}});var s=mc();Object.defineProperty(e,"ConflictType",{enumerable:!0,get:function(){return s.ConflictType}})})(_n)),_n}var at=N_();const M_=Sd({__proto__:null,default:mt(at)},[at]);var Ce=(e=>(e[e.COVER=0]="COVER",e[e.REPLACE=1]="REPLACE",e))(Ce||{}),J=(e=>(e.RETAIN="r",e.INSERT="i",e.DELETE="d",e))(J||{});const Ln=Re.createIdentifier("univer.context-service");class Ic extends ze{constructor(){super(...arguments);C(this,"_contextChanged$",new oe.Subject);C(this,"contextChanged$",this._contextChanged$.asObservable());C(this,"_contextMap",new Map)}dispose(){super.dispose(),this._contextChanged$.complete(),this._contextMap.clear()}getContextValue(n){var r;return(r=this._contextMap.get(n))!=null?r:!1}setContextValue(n,r){this._contextMap.set(n,r),this._contextChanged$.next({[n]:r})}subscribeContextValue$(n){return new oe.Observable(r=>{const s=this._contextChanged$.pipe(oe.filter(i=>typeof i[n]<"u")).subscribe(i=>r.next(i[n]));return this._contextMap.has(n)&&r.next(this._contextMap.get(n)),()=>s.unsubscribe()})}}var Sc=(e=>(e[e.SILENT=0]="SILENT",e[e.ERROR=1]="ERROR",e[e.WARN=2]="WARN",e[e.INFO=3]="INFO",e[e.VERBOSE=4]="VERBOSE",e))(Sc||{});const Et=Re.createIdentifier("univer.log");class Oc extends ze{constructor(){super(...arguments);C(this,"_logLevel",3);C(this,"_deduction",new Set)}dispose(){super.dispose(),this._logLevel=3,this._deduction.clear()}debug(...n){this._logLevel>=4&&this._log(console.debug,...n)}log(...n){this._logLevel>=3&&this._log(console.log,...n)}warn(...n){this._logLevel>=2&&this._log(console.warn,...n)}error(...n){this._logLevel>=1&&this._log(console.error,...n)}deprecate(...n){this._logLevel>=2&&this._logWithDeduplication(console.error,...n)}setLogLevel(n){this._logLevel=n}_log(n,...r){const s=r[0];/^\[(.*?)\]/g.test(s)?n(`\x1B[97;104m${s}\x1B[0m`,...r.slice(1)):n(...r)}_logWithDeduplication(n,...r){const s=L_(...r);this._deduction.has(s)||(this._deduction.add(s),this._log(n,...r))}}function L_(...e){return e.map(t=>JSON.stringify(t)).join("")}var D_=Object.getOwnPropertyDescriptor,U_=(e,t,n,r)=>{for(var s=r>1?void 0:r?D_(t,n):t,i=e.length-1,o;i>=0;i--)(o=e[i])&&(s=o(s)||s);return s},vc=(e,t)=>(n,r)=>t(n,r,e),dr=(e=>(e[e.COMMAND=0]="COMMAND",e[e.OPERATION=1]="OPERATION",e[e.MUTATION=2]="MUTATION",e))(dr||{});const fr=Re.createIdentifier("univer.core.command-service");class P_{constructor(){C(this,"_commands",new Map);C(this,"_commandTypes",new Map)}registerCommand(t){if(this._commands.has(t.id))throw new Error(`[CommandRegistry]: command "${t.id}" has been registered before.`);return this._commands.set(t.id,t),this._commandTypes.set(t.id,t.type),We(()=>{this.unregisterCommand(t.id)})}unregisterCommand(t){this._commands.delete(t),this._commandTypes.delete(t)}hasCommand(t){return this._commands.has(t)}getCommand(t){return this._commands.has(t)?[this._commands.get(t)]:null}getCommandType(t){return this._commandTypes.get(t)}}const wc={id:"nil",type:0,handler:()=>!0};f.CommandService=class extends ze{constructor(n,r){super();C(this,"_commandRegistry");C(this,"_beforeCommandExecutionListeners",[]);C(this,"_commandExecutedListeners",[]);C(this,"_multiCommandDisposables",new Map);C(this,"_commandExecutingLevel",0);C(this,"_commandExecutionStack",[]);this._injector=n,this._logService=r,this._commandRegistry=new P_,this.registerCommand(wc)}dispose(){super.dispose(),this._commandExecutedListeners.length=0,this._beforeCommandExecutionListeners.length=0}hasCommand(n){return this._commandRegistry.hasCommand(n)}registerCommand(n){return this._commandRegistry.registerCommand(n)}unregisterCommand(n){var r;this._commandRegistry.unregisterCommand(n),(r=this._multiCommandDisposables.get(n))==null||r.dispose()}registerMultipleCommand(n){return this._registerMultiCommand(n)}beforeCommandExecuted(n){if(this._beforeCommandExecutionListeners.indexOf(n)===-1)return this._beforeCommandExecutionListeners.push(n),We(()=>{const r=this._beforeCommandExecutionListeners.indexOf(n);this._beforeCommandExecutionListeners.splice(r,1)});throw new Error("[CommandService]: could not add a listener twice.")}onCommandExecuted(n){if(this._commandExecutedListeners.indexOf(n)===-1)return this._commandExecutedListeners.push(n),We(()=>{const r=this._commandExecutedListeners.indexOf(n);this._commandExecutedListeners.splice(r,1)});throw new Error("[CommandService]: could not add a listener twice.")}async executeCommand(n,r,s){try{const i=this._commandRegistry.getCommand(n);if(i){const[o]=i,a={id:o.id,type:o.type,params:r},l=this._pushCommandExecutionStack(a),c=s!=null?s:{};this._beforeCommandExecutionListeners.forEach(h=>h(a,c));const u=await this._execute(o,r,c);return this._commandExecutedListeners.forEach(h=>h(a,c)),l.dispose(),u}throw new Error(`[CommandService]: command "${n}" is not registered.`)}catch(i){if(i instanceof qr)return!1;throw i}}syncExecuteCommand(n,r,s){var i;try{const o=this._commandRegistry.getCommand(n);if(o){const[a]=o,l={id:a.id,type:a.type,params:r};if(a.type===2){const d=yd(this._commandExecutionStack,m=>m.type===0);d&&(l.params=(i=l.params)!=null?i:{},l.params.trigger=d.id)}const c=this._pushCommandExecutionStack(l),u=s!=null?s:{};this._beforeCommandExecutionListeners.forEach(d=>d(l,u));const h=this._syncExecute(a,r,u);return this._commandExecutedListeners.forEach(d=>d(l,u)),c.dispose(),h}throw new Error(`[CommandService]: command "${n}" is not registered.`)}catch(o){if(o instanceof qr)return!1;throw o}}_pushCommandExecutionStack(n){return this._commandExecutionStack.push(n),We(()=>tr(this._commandExecutionStack,n))}_registerMultiCommand(n){const r=this._commandRegistry.getCommand(n.id);let s;if(r){if(r[0].multi!==!0)throw new Error("Command has registered as a single command.");s=r[0]}else{s=new k_(n.id);const o=new ss;o.add(this._commandRegistry.registerCommand(s)),o.add(We(()=>{this._multiCommandDisposables.delete(n.id)})),this._multiCommandDisposables.set(n.id,o)}const i=s.registerImplementation(n);return We(()=>{var o;i.dispose(),s.hasImplementations()||(o=this._multiCommandDisposables.get(n.id))==null||o.dispose()})}async _execute(n,r,s){this._logService.debug("[CommandService]",`${"|-".repeat(Math.max(this._commandExecutingLevel,0))}executing command "${n.id}"`),this._commandExecutingLevel++;let i;try{i=await this._injector.invoke(n.handler,r,s),this._commandExecutingLevel--}catch(o){throw i=!1,this._commandExecutingLevel=0,o}return i}_syncExecute(n,r,s){this._logService.debug("[CommandService]",`${"|-".repeat(Math.max(0,this._commandExecutingLevel))}executing command "${n.id}".`),this._commandExecutingLevel++;let i;try{if(i=this._injector.invoke(n.handler,r,s),i instanceof Promise)throw new TypeError("[CommandService]: Command handler should not return a promise.");this._commandExecutingLevel--}catch(o){throw i=!1,this._commandExecutingLevel=0,o}return i}},f.CommandService=U_([vc(0,Re.Inject(Re.Injector)),vc(1,Et)],f.CommandService);class k_{constructor(t){C(this,"name");C(this,"multi",!0);C(this,"type",0);C(this,"priority",0);C(this,"_implementations",[]);C(this,"handler",async(t,n)=>{if(!this._implementations.length)return!1;const r=t.get(Et),s=t.get(Ln),i=t.get(Re.Injector);for(const o of this._implementations){const a=o.command.preconditions;if((!a||a&&a(s))&&(r.debug("[MultiCommand]",`executing implementation "${o.command.name}".`),await i.invoke(o.command.handler,n)))return!0}return!1});this.id=t,this.name=t}registerImplementation(t){const n={command:t};return this._implementations.push(n),this._implementations.sort((r,s)=>s.command.priority-r.command.priority),We(()=>{const r=this._implementations.indexOf(n);this._implementations.splice(r,1)})}hasImplementations(){return this._implementations.length>0}}function fs(e,t,n){const r=e.map(s=>()=>t.syncExecuteCommand(s.id,s.params,n));return dl(r)}function F_(e,t,n){const r=e.map(s=>()=>t.executeCommand(s.id,s.params,n));return hl(r)}function bc(e){return new oe.Observable(t=>{const n=e((...r)=>t.next(r));return()=>n==null?void 0:n.dispose()})}function Li(e){return function(n){return new oe.Observable(r=>(n.subscribe({next:s=>{r.next(s),e(s)&&r.complete()},complete:()=>r.complete(),error:s=>r.error(s)}),()=>r.unsubscribe()))}}function x_(e=0){return t=>{let n=[];return t.pipe(oe.tap(r=>n.push(r)),oe.debounceTime(e),oe.map(()=>n),oe.tap(()=>n=[]))}}function B_(e){const t=new oe.ReplaySubject(1);return setTimeout(()=>t.next(),e),t.pipe(oe.take(1))}function $_(e,t){const n=new oe.BehaviorSubject(t);return e.subscribe(n),n}const H_=e=>new Promise(t=>{oe.merge(bc(e.onCommandExecuted.bind(e)).pipe(Kr.filter(([n])=>n.type===dr.MUTATION)),oe.timer(300)).pipe(Kr.debounceTime(16),Kr.first()).subscribe(()=>{t()})});function Ac(e,t){let n=0,r=e.length-1;if(t<e[0])return 0;if(t>=e[e.length-1])return e.length-1;for(;n<=r;){if(e[n]===t){for(;n<e.length&&e[n]===t;)n++;return n}if(t>e[n]&&t<e[n+1])return n+1;if(e[r]===t){for(;r<e.length&&e[r]===t;)r++;return r}if(t>e[r-1]&&t<e[r])return r;n++,r--}return-1}function j_(e,t){let n=0,r=e.length-1;for(;n<=r;){const s=Math.floor((r+n)/2);if(t<e[s]&&(s===0||t>=e[s-1]))return s;if(t>=e[s])n=s+1;else if(t<e[s])r=s-1;else return-1}return-1}function Tc(e,t){let n=0,r=e.length;for(;n<r;){const s=Math.floor((n+r)/2);e[s]<=t?n=s+1:r=s}return n<e.length?n:e.length-1}function mr(e,t,n=!1){let r=e.length-1;if(t<0||t<e[0])return 0;if(e.length<40||t<=e[20]||t>=e[r-20]?r=Ac(e,t):r=Tc(e,t),n){const s=e[r];return e.indexOf(s)}return r}function W_(e){const t=new Blob([e],{type:"text/javascript"});return window.URL.createObjectURL(t)}const gr=2,yc=1;function Y_(e,t){if(t==null||e==null)return!0;const{left:n=0,top:r=0,height:s=0,width:i=0,angle:o=0}=t,{left:a=0,top:l=0,height:c=0,width:u=0,angle:h=0}=e,d=u,m=c,_=i,p=s;return Math.abs(a-n)>gr||Math.abs(l-r)>gr||Math.abs(d-_)>gr||Math.abs(m-p)>gr||Math.abs(h-o)>yc}function ms(e,t,n){const{dataStream:r,textRuns:s=[]}=e;let i=t;const o=[];for(const a of s){const{st:l,ed:c}=a;Z.hasIntersectionBetweenTwoRanges(t,n,l,c)&&(l>i?(o.push(r.slice(i,l)),o.push(Di(r,{...a,ed:Math.min(c,n)}))):o.push(Di(r,{...a,st:i,ed:Math.min(c,n)}))),i=Math.max(t,Math.min(c,n))}return i!==n&&o.push(r.slice(i,n)),o.join("")}function G_(e,t=!0){var n;if(t&&((n=e.paragraphs)!=null&&n.length)){const{dataStream:r,paragraphs:s=[]}=e;let i="",o=-1;for(const a of s){const{startIndex:l,paragraphStyle:c={}}=a,{spaceAbove:u,spaceBelow:h,lineSpacing:d}=c,m=[];u!=null&&(typeof u=="number"?m.push(`margin-top: ${u}px`):m.push(`margin-top: ${u.v}px`)),h!=null&&(typeof h=="number"?m.push(`margin-bottom: ${h}px`):m.push(`margin-bottom: ${h.v}px`)),d!=null&&m.push(`line-height: ${d}`),l>o+1?i+=`<p class="UniverNormal" ${m.length?`style="${m.join("; ")};"`:""}>${ms(e,o+1,l)}</p>`:i+=`<p class="UniverNormal" ${m.length?`style="${m.join("; ")};"`:""}></p>`,o=l}return o!==r.length&&(i+=ms(e,o,r.length)),i}else return ms(e,0,e.dataStream.length)}function Di(e,t){const{st:n,ed:r,ts:s={}}=t,{ff:i,fs:o,it:a,bl:l,ul:c,st:u,ol:h,bg:d,cl:m,va:_}=s;let p=e.slice(n,r);const I=[];return a===ae.TRUE&&(p=`<i>${p}</i>`),_===Ht.SUPERSCRIPT?p=`<sup>${p}</sup>`:_===Ht.SUBSCRIPT&&(p=`<sub>${p}</sub>`),(c==null?void 0:c.s)===ae.TRUE&&(p=`<u>${p}</u>`),(u==null?void 0:u.s)===ae.TRUE&&(p=`<s>${p}</s>`),l===ae.TRUE&&(p=`<strong>${p}</strong>`),i&&I.push(`font-family: ${i}`),m&&I.push(`color: ${m.rgb}`),o&&I.push(`font-size: ${o}pt`),h&&I.push("text-decoration: overline"),d&&I.push(`background: ${d.rgb}`),I.length?`<span style="${I.join("; ")};">${p}</span>`:p}const Nc={[cs.OFFICE]:{[ot.ACCENT1]:"#4472C4",[ot.ACCENT2]:"#ED7D31",[ot.ACCENT3]:"#A5A5A5",[ot.ACCENT4]:"#70AD47",[ot.ACCENT5]:"#5B9BD5",[ot.ACCENT6]:"#70AD47",[ot.DARK1]:"#000000",[ot.DARK2]:"#44546A",[ot.LIGHT1]:"#FFFFFF",[ot.LIGHT2]:"#E7E6E6",[ot.HYPERLINK]:"#0563C1",[ot.FOLLOWED_HYPERLINK]:"#954F72"}};class gs{constructor(){C(this,"_themeValue",ot.LIGHT1);C(this,"_themeColors");C(this,"_themeTint");C(this,"_rgbValue","");C(this,"_colorType");this._colorType=pt.UNSUPPORTED,this._themeColors=cs.OFFICE,this._themeTint=0}asRgbColor(){return new _s(this._rgbValue,this)}asThemeColor(){return new ps(this._themeValue,this._themeTint,this._themeColors,this)}build(){switch(this._colorType){case pt.THEME:return this.asThemeColor();case pt.RGB:return this.asRgbColor();case pt.UNSUPPORTED:throw new Error("unsupported color type")}}setRgbColor(t){return this._colorType=pt.RGB,this._rgbValue=t,this}setThemeColors(t){this._colorType=pt.THEME,this._themeColors=t}setThemeTint(t){this._colorType=pt.THEME,this._themeTint=t}setThemeColor(t){return this._colorType=pt.THEME,this._themeValue=t,this}getColorType(){return this._colorType}}class En{constructor(t){C(this,"_builder");this._builder=t}static rgbColorToHexValue(t){return`#${((1<<24)+(t.getRed()<<16)+(t.getGreen()<<8)+t.getBlue()).toString(16).slice(1)}`}static hexValueToRgbColor(t){t?t.indexOf("#")>-1&&(t=t.substring(1)):t="#000000";const n=+`0x${t[0]}${t[1]}`,r=+`0x${t[2]}${t[3]}`,s=+`0x${t[4]}${t[5]}`;return new gs().setRgbColor(`rgb(${n},${r},${s})`).asRgbColor()}static hexToRgbString(t){const n=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;t=t.replace(n,(i,o,a,l)=>o+o+a+a+l+l);const r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);let s=null;if(r){const i=Number.parseInt(r[1],16),o=Number.parseInt(r[2],16),a=Number.parseInt(r[3],16);s=`rgba(${i},${o},${a})`}return s}asRgbColor(){return this._builder.asRgbColor()}asThemeColor(){return this._builder.asThemeColor()}getColorType(){return this._builder.getColorType()}clone(){return new En(this._builder)}equals(t){return!1}}class Mc{constructor(t){C(this,"_saturation",0);C(this,"_hue",0);C(this,"_lightness",0);C(this,"_alpha",0);const n=t.getRed()/255,r=t.getGreen()/255,s=t.getBlue()/255,i=t.getAlpha()/255,o=Math.min(n,Math.min(r,s)),a=Math.max(n,Math.max(r,s)),l=a-o;if(a===o){this._hue=0,this._saturation=0,this._lightness=a;return}this._lightness=(o+a)/2,this._lightness<.5?this._saturation=l/(a+o):this._saturation=l/(2-a-o),n===a&&(this._hue=(r-s)/l),r===a&&(this._hue=2+(s-n)/l),s===a&&(this._hue=4+(n-r)/l),this._hue*=60,this._hue<0&&(this._hue+=360),this._alpha=i}asRgbColor(){const t=new gs;if(this._saturation===0)return t.setRgbColor(`rgba(${this._lightness*255},${this._lightness*255},${this._lightness*255},${this._alpha*255})`),t.asRgbColor();let n;this._lightness<.5?n=this._lightness*(1+this._saturation):n=this._lightness+this._saturation-this._lightness*this._saturation;const r=2*this._lightness-n,s=this._hue/360,i=s+1/3,o=this.setColor(n,r,i),a=this.setColor(n,r,s),l=s-1/3,c=this.setColor(n,r,l);return t.setRgbColor(`rgba(${Math.round(o*255)},${Math.round(a*255)},${Math.round(c*255)},${this._alpha*255})`),t.asRgbColor()}getLightness(){return this._lightness}getHue(){return this._hue}getSaturation(){return this._saturation}getAlpha(){return this._alpha}setColor(t,n,r){r<0&&(r+=1),r>1&&(r-=1);let s;return 6*r<1?s=n+(t-n)*6*r:2*r<1?s=t:3*r<2?s=n+(t-n)*(2/3-r)*6:s=n,s}setLightness(t){this._lightness=t}}const It=class It extends En{constructor(n,r){super(r);C(this,"_cssString");C(this,"_red");C(this,"_green");C(this,"_blue");C(this,"_alpha");let s=n.match(It.RGBA_EXTRACT);if(s){const i=+s[1],o=+s[2],a=+s[3],l=+s[4];this._cssString=n,this._red=i,this._green=o,this._blue=a,this._alpha=l;return}if(s=n.match(It.RGB_EXTRACT),s){const i=+s[1],o=+s[2],a=+s[3];this._cssString=n,this._red=i,this._green=o,this._blue=a,this._alpha=1;return}throw new Error("Invalid rgba or rgb color")}asHexString(){return En.rgbColorToHexValue(this)}getRed(){let n=this._red+It.RGB_COLOR_AMT;return n>255?n=255:n<0&&(n=0),n}getGreen(){let n=this._green+It.RGB_COLOR_AMT;return n>255?n=255:n<0&&(n=0),n}getBlue(){let n=this._blue+It.RGB_COLOR_AMT;return n>255?n=255:n<0&&(n=0),n}getAlpha(){return this._alpha}getColorType(){return pt.RGB}clone(){return new It(this._cssString,this._builder)}asThemeColor(){throw new Error("rgb color not support to themeColor")}equals(n){return n instanceof It?n._red===this._red&&n._blue===this._blue&&n._green===this._green&&n._alpha===this._alpha:!1}getCssString(){return this._cssString}};C(It,"RGB_COLOR_AMT",0),C(It,"RGBA_EXTRACT",new RegExp("\\s*rgba\\s*\\((\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d.\\d|\\d\\s*)\\)\\s*")),C(It,"RGB_EXTRACT",new RegExp("\\s*rgb\\s*\\((\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d+\\s*)\\)\\s*"));let _s=It;const an=class an extends En{constructor(n,r,s,i){super(i);C(this,"_themeColorType");C(this,"_themeTint");C(this,"_themeColors");this._themeColorType=n,this._themeTint=r,this._themeColors=s}lumValue(n,r){if(n==null)return r;let s;return n<0?s=r*(1+n):s=r*(1-n)+(255-255*(1-n)),s}asRgbColor(){const n=Nc[this._themeColors];if(n==null)throw new Error("not find themeColors type");const r=n[this._themeColorType];if(r==null)throw new Error("not find themeColors value");let s;if(an._cacheThemeColor.has(this._themeColors)){if(s=an._cacheThemeColor.get(this._themeColors),s.has(this._themeColorType))return s.get(this._themeColorType)}else s=new Map,an._cacheThemeColor.set(this._themeColors,s);const i=new Mc(En.hexValueToRgbColor(r));i.setLightness(this.lumValue(this._themeTint,i.getLightness()*255)/255);const o=i.asRgbColor();return s.set(this._themeColorType,o),o}clone(){return new an(this._themeColorType,this._themeTint,this._themeColors,this._builder)}equals(n){return n instanceof an?n._themeColorType===this._themeColorType:!1}getColorType(){return pt.THEME}getThemeColorType(){return this._themeColorType}};C(an,"_cacheThemeColor",new Map);let ps=an;const V_="rgb(",z_="rgba(",Ui={aliceBlue:[240,248,255],antiqueWhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blancheAlmond:[255,235,205],blue:[0,0,255],blueViolet:[138,43,226],brown:[165,42,42],burlyWood:[222,184,135],cadetBlue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornFlowerBlue:[100,149,237],cornSilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkBlue:[0,0,139],darkCyan:[0,139,139],darkGoldenrod:[184,132,11],darkGray:[169,169,169],darkGreen:[0,100,0],darkGrey:[169,169,169],darkKhaki:[189,183,107],darkMagenta:[139,0,139],darkOliveGreen:[85,107,47],darkOrange:[255,140,0],darkOrchid:[153,50,204],darkRed:[139,0,0],darkSalmon:[233,150,122],darkSeaGreen:[143,188,143],darkSlateBlue:[72,61,139],darkSlateGray:[47,79,79],darkSlateGrey:[47,79,79],darkTurquoise:[0,206,209],darkViolet:[148,0,211],darkYellow:[139,128,0],deepPink:[255,20,147],deepSkyBlue:[0,191,255],dimGray:[105,105,105],dimGrey:[105,105,105],dodgerBlue:[30,144,255],firebrick:[178,34,34],floralWhite:[255,255,240],forestGreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostWhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenYellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotPink:[255,105,180],indianRed:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderBlush:[255,240,245],lawnGreen:[124,252,0],lemonChiffon:[255,250,205],lightblue:[173,216,230],lightCoral:[240,128,128],lightCyan:[224,255,255],lightGoldenrodYellow:[250,250,210],lightGray:[211,211,211],lightGreen:[144,238,144],lightGrey:[211,211,211],lightPink:[255,182,193],lightSalmon:[255,160,122],lightSeaGreen:[32,178,170],lightSkyBlue:[135,206,250],lightSlateGray:[119,136,153],lightSlateGrey:[119,136,153],lightSteelBlue:[176,196,222],lightYellow:[255,255,224],lime:[0,255,0],limeGreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumAquamarine:[102,205,170],mediumBlue:[0,0,205],mediumOrchid:[186,85,211],mediumPurple:[147,112,219],mediumSeaGreen:[60,179,113],mediumSlateBlue:[123,104,238],mediumSpringGreen:[0,250,154],mediumTurquoise:[72,209,204],mediumVioletRed:[199,21,133],midBightBlue:[25,25,112],mintCream:[245,255,250],mistyRose:[255,228,225],moccasin:[255,228,181],navajoWhite:[255,222,173],navy:[0,0,128],oldLace:[253,245,230],olive:[128,128,0],oliveDrab:[107,142,35],orange:[255,165,0],orangeRed:[255,69,0],orchid:[218,112,214],paleGoldenrod:[238,232,170],paleGreen:[152,251,152],paleTurquoise:[175,238,238],paleVioletRed:[219,112,147],papayaWhip:[255,239,213],peachPuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderBlue:[176,224,230],purple:[128,0,128],rebeccaPurple:[102,51,153],red:[255,0,0],rosyBrown:[188,143,143],royalBlue:[65,105,225],saddleBrown:[139,69,19],salmon:[250,128,114],sandyBrown:[244,164,96],seaGreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyBlue:[135,206,235],slateBlue:[106,90,205],slateGray:[119,128,144],slateGrey:[119,128,144],snow:[255,255,250],springGreen:[0,255,127],steelBlue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whiteSmoke:[245,245,245],yellow:[255,255,0],yellowGreen:[154,205,5]};class Ct{constructor(t){C(this,"_color");C(this,"_rgbColor");C(this,"_isValid",!1);if(t==null){this._setNullColor();return}if(t instanceof Ct){this._color={...t._color},this._rgbColor={...t._rgbColor};return}const n=Lc(t);if(n==null){this._setNullColor();return}this._color=n;const r=J_(this._color);if(r==null){this._setNullColor();return}this._rgbColor=r,this._isValid=!0}static mix(t,n,r){var c,u;r=Math.min(1,Math.max(0,r));const s=new Ct(t).toRgb(),i=new Ct(n).toRgb(),o=(c=s.a)!=null?c:1,a=(u=i.a)!=null?u:1,l={r:(i.r-s.r)*r+s.r,g:(i.g-s.g)*r+s.g,b:(i.b-s.b)*r+s.b,a:(a-o)*r+o};return new Ct(l)}static getContrastRatio(t,n){const r=new Ct(t).getLuminance(),s=new Ct(n).getLuminance();return(Math.max(r,s)+.05)/(Math.min(r,s)+.05)}get isValid(){return this._isValid}toRgb(){return this._rgbColor}toRgbString(){const{r:t,g:n,b:r,a:s=1}=this.toRgb(),i=s<1;return`rgb${i?"a":""}(${t},${n},${r}${i?`,${s}`:""})`}toString(){return this.toRgbString()}toHexString(t){const{r:n,g:r,b:s,a:i=1}=this.toRgb(),o=i<1,a=[Es(Math.round(n).toString(16)),Es(Math.round(r).toString(16)),Es(Math.round(s).toString(16)),Es(Math.round(i*255).toString(16))];return t&&a[0][0]===a[0][1]&&a[1][0]===a[1][1]&&a[2][0]===a[2][1]&&a[3][0]===a[3][1]?o?`#${a[0][0]}${a[1][0]}${a[2][0]}${a[3][0]}`:`#${a[0][0]}${a[1][0]}${a[2][0]}`:o?`#${a[0]}${a[1]}${a[2]}${a[3]}`:`#${a[0]}${a[1]}${a[2]}`}toHsv(){return np(this.toRgb())}toHsl(){return tp(this.toRgb())}lighten(t=10){const n=this.toHsl();return n.l+=t,n.l=Math.min(Math.max(n.l,0),100),new Ct(n)}darken(t=10){const n=this.toHsl();return n.l-=t,n.l=Math.min(Math.max(n.l,0),100),new Ct(n)}setAlpha(t){return new Ct({...this._rgbColor,a:t})}getLuminance(){let{r:t,g:n,b:r}=this.toRgb();return t=Pi(t),n=Pi(n),r=Pi(r),Number((.2126*t+.7152*n+.0722*r).toFixed(3))}getBrightness(){const{r:t,g:n,b:r}=this.toRgb();return(t*299+n*587+r*114)/1e3}getAlpha(){var t;return(t=this._color.a)!=null?t:1}isDark(){return this.getBrightness()<128}isLight(){return!this.isDark()}_setNullColor(){this._isValid=!1,this._color={r:0,g:0,b:0,a:0},this._rgbColor={r:0,g:0,b:0,a:0}}}const Es=e=>e.length===1?`0${e}`:e,Pi=e=>(e/=255,e<=.03928?e/12.92:((e+.055)/1.055)**2.4),Lc=e=>{if(sp(e)){if("r"in e){const r={r:Math.round(e.r),g:Math.round(e.g),b:Math.round(e.b)};return e.a!==void 0&&(r.a=e.a),r}if("l"in e){const r={h:Math.round(e.h),s:e.s,l:e.l};return e.a!==void 0&&(r.a=e.a),r}const n={h:Math.round(e.h),s:e.s,v:e.v};return e.a!==void 0&&(n.a=e.a),n}const t=e.trim();if(Ui[t]){const n=Ui[t],r={r:Math.round(n[0]),g:Math.round(n[1]),b:Math.round(n[2])};return r.a=n[3]||1,r}if(t.startsWith("#"))return K_(t);if(t.startsWith("rgb"))return X_(t);if(t.startsWith("hsl"))return q_(t);if(t.startsWith("hsv"))return Z_(t)},K_=e=>{const t=e.substring(1),n=new RegExp(`.{1,${t.length>=6?2:1}}`,"g");let r=t.match(n);if(!r||r.length<3)throw new Error(`The color '${e}' is illegal hex color`);r[0].length===1&&(r=r.map(i=>i+i));const s={r:Number.parseInt(r[0],16),g:Number.parseInt(r[1],16),b:Number.parseInt(r[2],16)};return r.length>3&&(s.a=Number.parseInt(r[3],16)/255),s},X_=e=>{const t=e.indexOf("(");if(t===-1)throw new Error(`The color '${e}' is illegal rgb color`);const n=e.substring(t+1,e.length-1).split(",");if(n.length<3)throw new Error(`The color '${e}' is illegal rgb color`);const r={r:Number.parseInt(n[0],10),g:Number.parseInt(n[1],10),b:Number.parseInt(n[2],10)};return n.length>3&&(r.a=Number.parseFloat(n[3])),r},q_=e=>{const t=e.indexOf("(");if(t===-1)throw new Error(`The color '${e}' is illegal hsl color`);const n=e.substring(t+1,e.length-1).split(",");if(n.length<3)throw new Error(`The color '${e}' is illegal hsl color`);const r={h:Number.parseInt(n[0],10),s:Number.parseFloat(n[1]),l:Number.parseFloat(n[2])};return n.length>3&&(r.a=Number.parseFloat(n[3])),r},Z_=e=>{const t=e.indexOf("(");if(t===-1)throw new Error(`The color '${e}' is illegal hsv color`);const n=e.substring(t+1,e.length-1).split(",");if(n.length<3)throw new Error(`The color '${e}' is illegal hsv color`);const r={h:Number.parseInt(n[0],10),s:Number.parseFloat(n[1]),v:Number.parseFloat(n[2])};return n.length>3&&(r.a=Number.parseFloat(n[3])),r},J_=e=>{const t=Lc(e);if(t!=null)return"r"in t?t:"l"in t?Q_(t):ep(t)},ki=(e,t,n)=>(n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e),Q_=e=>{let{h:t,s:n,l:r}=e;t/=360,n/=100,r/=100;let s=0,i=0,o=0;if(n===0)s=i=o=r;else{const l=r<.5?r*(1+n):r+n-r*n,c=2*r-l;s=ki(c,l,t+1/3),i=ki(c,l,t),o=ki(c,l,t-1/3)}const a={r:Math.round(s*255),g:Math.round(i*255),b:Math.round(o*255)};return e.a!==void 0&&(a.a=e.a),a},ep=e=>{let{h:t,s:n,v:r}=e;t=t/360*6,n/=100,r/=100;const s=Math.floor(t),i=t-s,o=r*(1-n),a=r*(1-i*n),l=r*(1-(1-i)*n),c=s%6,u=[r,a,o,o,l,r][c],h=[l,r,r,a,o,o][c],d=[o,o,l,r,r,a][c],m={r:u*255,g:h*255,b:d*255};return e.a!==void 0&&(m.a=e.a),m},tp=e=>{let{r:t,g:n,b:r}=e;t/=255,n/=255,r/=255;const s=Math.max(t,n,r),i=Math.min(t,n,r),o=(s+i)/2;let a,l;if(s===i)a=l=0;else{const u=s-i;switch(l=o>.5?u/(2-s-i):u/(s+i),s){case t:a=(n-r)/u+(n<r?6:0);break;case n:a=(r-t)/u+2;break;default:a=(t-n)/u+4;break}a/=6}const c={h:Math.round(a*360),s:Math.round(l*100),l:Math.round(o*100)};return e.a!==void 0&&(c.a=e.a),c},np=e=>{let{r:t,g:n,b:r}=e;t/=255,n/=255,r/=255;const s=Math.max(t,n,r),i=Math.min(t,n,r);let o;const a=s,l=s-i,c=s===0?0:l/s;if(s===i)o=0;else{switch(s){case t:o=(n-r)/l+(n<r?6:0);break;case n:o=(r-t)/l+2;break;default:o=(t-n)/l+4;break}o/=6}const u={h:Math.round(o*360),s:Math.round(c*100),v:Math.round(a*100)};return e.a!==void 0&&(u.a=e.a),u},rp=e=>e==null,sp=e=>!rp(e)&&typeof e=="object";function ip(e){const t=/^#(?:[0]{3}|[0]{6})\b/,n=/^rgb\s*\(\s*0+\s*,\s*0+\s*,\s*0+\s*\)$/,r=/^rgba\s*\(\s*0+\s*,\s*0+\s*,\s*0+\s*,\s*(1|1\.0*|0?\.\d+)\)$/,s=/^hsl\s*\(\s*0*\s*,\s*0%*\s*,\s*0%*\s*\)$/,i=/^hsla\s*\(\s*0*\s*,\s*0%*\s*,\s*0%*\s*,\s*(1|1\.0*|0?\.\d+)\)$/;return!!(t.test(e)||n.test(e)||r.test(e)||s.test(e)||i.test(e))}function op(e){const t=/^#(?:[Ff]{3}|[Ff]{6})\b/,n=/^rgb\s*\(\s*255\s*,\s*255\s*,\s*255\s*\)$/,r=/^rgba\s*\(\s*255\s*,\s*255\s*,\s*255\s*,\s*(1|1\.0*|0?\.\d+)\)$/,s=/^hsl\s*\(\s*0*\s*,\s*0%*\s*,\s*100%*\s*\)$/,i=/^hsla\s*\(\s*0*\s*,\s*0%*\s*,\s*100%*\s*,\s*(1|1\.0*|0?\.\d+)\)$/;return!!(t.test(e)||n.test(e)||r.test(e)||s.test(e)||i.test(e))}function Dc(e){return e&&(e.s!==void 0||e.p!==void 0||e.v!==void 0||e.t!==void 0||e.f!==void 0||e.si!==void 0||e.custom!==void 0)}function ap(e){if(e.t!==void 0)return e.t;if(typeof e.v=="string")return Zt.STRING;if(typeof e.v=="number")return Zt.NUMBER;if(typeof e.v=="boolean")return Zt.BOOLEAN}function lp(e){if(e==null)return!0;const{v:t,f:n,si:r,p:s,custom:i}=e;return!(!(t==null||typeof t=="string"&&t.length===0)||n!=null&&n.length>0||r!=null&&r.length>0||s!=null||i!=null)}function Uc(e){return e!=null&&(typeof e=="string"||typeof e=="number"||typeof e=="boolean")}var pe=(e=>(e[e.NORMAL=0]="NORMAL",e[e.ROW=1]="ROW",e[e.COLUMN=2]="COLUMN",e[e.ALL=3]="ALL",e))(pe||{}),Ne=(e=>(e[e.NONE=0]="NONE",e[e.ROW=1]="ROW",e[e.COLUMN=2]="COLUMN",e[e.ALL=3]="ALL",e))(Ne||{});function cp(e){return[e.startRow,e.startColumn,e.endRow,e.endColumn]}var Pc=(e=>(e.NONE="none",e.BACKWARD="backward",e.FORWARD="forward",e))(Pc||{}),kc=(e=>(e.RECT="RECT",e.TEXT="TEXT",e))(kc||{});function up(e,t,n){let r=!1,s=!1,i=e,o=t,a=e,l=t;if(n==null)return{actualRow:e,actualColumn:t,isMergedMainCell:s,isMerged:r,endRow:i,endColumn:o,startRow:a,startColumn:l};for(let c=0;c<n.length;c++){const{startRow:u,endRow:h,startColumn:d,endColumn:m}=n[c];if(e===u&&t===d){i=h,o=m,a=u,l=d,s=!0;break}if(e>=u&&e<=h&&t>=d&&t<=m){i=h,o=m,a=u,l=d,r=!0;break}}return{actualRow:e,actualColumn:t,isMergedMainCell:s,isMerged:r,endRow:i,endColumn:o,startRow:a,startColumn:l}}var Dn=(e=>(e.Raw="raw",e.Intercepted="intercepted",e.Both="both",e))(Dn||{});function hp(e,t){const n={};for(const r in e){const s=Number(r),i=e[s];for(const o in i){const a=Number(o),l=i[a],c=t(s,a,l);c!==void 0&&(n[s]?n[s][a]=c:n[s]={[a]:c})}}return n}function Qt(e){let t=0;const n=Object.keys(e);for(const r of n){const s=Number(r);t=Math.max(t,s)}return t+1}function dp(e,t,n){const r=Qt(n),s=n;for(let i=r-1;i>=e;i--)s[i+1]=s[i];s[e]=t}function Fi(e,t,n){const r=Object.keys(n).reduce((s,i)=>Math.max(s,Number.parseInt(i)),0)+1;for(let s=e;s<r;s++)s<e+t?delete n[s]:n[s]!==void 0&&(n[s-t]=n[s],delete n[s])}function fp(e,t){const n=e,r=Object.keys(n),s=r.length,i=t,o=Object.keys(i),a=o.length,l={};let c=0;for(let u=0;u<s;u++,c++){const h=r[u];l[c]=n[h]}for(let u=0;u<a;u++,c++){const h=o[u];l[c]=i[h]}return l}function mp(e,t,n){const r=n;if(Qt(n)>0){const i={};let o=0;for(let a=e;a<=t;a++)r[a]&&(i[o]=r[a],o++);return i}return{}}function xi(e,t,n,r){const s=e>n;if(!s&&e+t>n)throw new Error("Invalid move operation");s?gp(e,t,n,r):_p(e,t,n,r)}function gp(e,t,n,r){const s=r,i=[];for(let o=e;o<e+t;o++)i.push(s[o]);for(let o=e-1;o>=n;o--){const a=s[o];s[o+t]=a,a===void 0&&delete s[o+t]}i.forEach((o,a)=>{s[n+a]=o,o===void 0&&delete s[n+a]})}function _p(e,t,n,r){const s=r,i=[];for(let o=e;o<e+t;o++)i.push(s[o]);for(let o=e+t;o<n;o++){const a=s[o];s[o-t]=a,a===void 0&&delete s[o-t]}i.forEach((o,a)=>{s[n+a-t]=o,o===void 0&&delete s[n+a-t]})}class ut{constructor(t={}){C(this,"_matrix");this._setOriginValue(t)}static MakeObjectMatrixSize(t){return new ut({[t-1]:{}})}getMatrix(){return this._matrix}forEach(t){const n=this._matrix,r=Object.keys(n);for(const s of r){const i=Number(s),o=n[i];if(t(i,o)===!1)return this}return this}forRow(t){const n=this._matrix,r=Object.keys(n);for(const s of r){const i=Number(s),o=n[i];if(t(i,Object.keys(o).map(l=>Number(l)))===!1)return this}return this}forValue(t){const n=this._matrix;for(const r in n){const s=Number(r),i=n[s];if(i)for(const o in i){const a=Number(o),l=i[a];if(t(s,a,l)===!1)return this}}return this}swapRow(t,n){const r=this._matrix[t],s=this._matrix[n];this._matrix[t]=s,this._matrix[n]=r}getRow(t){return this._matrix[t]}getRowOrCreate(t){let n=this.getRow(t);return n==null&&(n={},this._matrix[t]=n),n}reset(){this._setOriginValue({})}hasValue(){const t=this._matrix,n=Object.keys(t);if(n.length===0)return!1;for(const r of n){const s=Number(r),i=t[s];if(Object.keys(i).length>0)return!0}return!1}getValue(t,n){var r,s;return(s=(r=this._matrix)==null?void 0:r[t])==null?void 0:s[n]}setValue(t,n,r){const s=this.getRowOrCreate(t);s[n]=r}deleteValue(t,n){var r,s;(s=(r=this._matrix)==null?void 0:r[t])==null||delete s[n]}realDeleteValue(t,n){var r,s,i;if((s=(r=this._matrix)==null?void 0:r[t])==null||delete s[n],this.getRow(t)){const o=this.getRow(t);if(o==null)return;Object.keys(o).length===0&&((i=this._matrix)==null||delete i[t])}}setRow(t,n){this._matrix[t]=n}moveRows(t,n,r){xi(t,n,r,this._matrix)}moveColumns(t,n,r){this.forEach((s,i)=>{xi(t,n,r,i)})}insertRows(t,n){const r=Object.keys(this._matrix);for(let s=r.length-1;s>=0;s--){const i=Number(r[s]);if(i>=t){const o=this._matrix[i];delete this._matrix[i],this._matrix[i+n]=o}}}insertColumns(t,n){const r=Object.keys(this._matrix);for(let s=0;s<r.length;s++){const i=Number(r[s]),o=this._matrix[i],a=Object.keys(o);for(let l=a.length-1;l>=0;l--){const c=Number(a[l]);if(c>=t){const u=o[c];delete o[c],o[c+n]=u}}}}removeRows(t,n){Fi(t,n,this._matrix)}removeColumns(t,n){this.forEach((r,s)=>{s&&Fi(t,n,s)})}getFragment(t,n,r,s){const i=new ut;let o=0;for(let a=t;a<=n;a++){const l={};let c=0;for(let u=r;u<=s;u++){const h=this.getValue(a,u);l[c]=h,c++}i.setRow(o,l),o++}return i}getSlice(t,n,r,s){const i=new ut;for(let o=t;o<=n;o++)for(let a=r;a<=s;a++){const l=this.getValue(o,a);l&&i.setValue(o,a,Z.deepClone(l))}return i}getSizeOf(){return Object.keys(this._matrix).length}getLength(){return Qt(this._matrix)}getRange(){const r=this.getLength()-1;let s=0;const i=this.getLength();for(let o=0;o<i;o++){const a=this.getRow(o);if(a){const l=Qt(a)-1;s=l>s?l:s}}return{startRow:0,startColumn:0,endRow:r,endColumn:s}}toNativeArray(){const t=new Array;return this.forValue((n,r,s)=>{t.push(s)}),t}toArray(){const t=[];return this.forRow((n,r)=>{t[n]==null&&(t[n]=[]),r.forEach(s=>{t[n][s]=this.getValue(n,s)})}),t}toFullArray(){const t=this.getRange(),{endColumn:n,endRow:r}=t,s=[];for(let i=0;i<=r;i++){const o=new Array(n+1).fill(void 0);s.push(o)}return this.forValue((i,o,a)=>{s[i][o]=a}),s}toJSON(){return this._matrix}clone(){const t=JSON.stringify(this._matrix);return JSON.parse(t)}getData(){const t=JSON.stringify(this._matrix);return JSON.parse(t)}getArrayData(){let t=0,n=0,r=!1,s=!1;const i=new ut;return this.forEach((o,a)=>{r||(r=!0,t=o),Object.keys(a).forEach(l=>{const c=Number(l);s?c<n&&(n=c):(s=!0,n=c);const u=this.getValue(o,c);i.setValue(o-t,c-n,u)})}),i.getData()}getStartEndScope(){let t=1/0,n=-1/0,r=1/0,s=-1/0;const i=Object.keys(this._matrix);i.length>0&&(t=+i[0],n=+i[i.length-1]);for(const o of i){const a=Object.keys(this._matrix[o]);a.length>0&&(r=Math.min(r,+a[0]),s=Math.max(s,+a[a.length-1]))}return{startRow:t,endRow:n,startColumn:r,endColumn:s}}getDataRange(){let t=0,n=0,r=0,s=-1,i=!1,o=!1;return this.forEach((a,l)=>{if(i||(i=!0,t=a),l==null)return;const c=Qt(l)-1;c>r&&(r=c),Object.keys(l).forEach(u=>{const h=Number(u);o?h<n&&(n=h):(o=!0,n=h)}),a>s&&(s=a)}),{startRow:t,startColumn:n,endRow:s,endColumn:r}}getDiscreteRanges(){const t=[];return this.forEach((n,r)=>{Object.keys(r).forEach(s=>{const i=Number(s);let o=!1;for(const a of t)if(n>=a.startRow&&n<=a.endRow+1&&i>=a.startColumn&&i<=a.endColumn+1){a.endRow=Math.max(n,a.endRow),a.endColumn=Math.max(i,a.endColumn),o=!0;break}o||t.push({startRow:n,endRow:n,startColumn:i,endColumn:i})})}),t}merge(t){this.forValue((n,r)=>{const s=t.getValue(n,r);s!=null&&this.setValue(n,r,s)})}_setOriginValue(t={}){this._matrix=t}}function Fc(e){const{actualRow:t,actualColumn:n,isMerged:r,isMergedMainCell:s,mergeInfo:i}=e;let{startY:o,endY:a,startX:l,endX:c}=e,u=t,h=n,d=t,m=n;if(r&&i){const{startRow:_,startColumn:p,endRow:I,endColumn:A,startY:B,endY:x,startX:Y,endX:O}=i;u=_,h=p,d=I,m=A,o=B,a=x,l=Y,c=O}return s&&(o=i.startY,a=i.endY,l=i.startX,c=i.endX,d=i.endRow,m=i.endColumn),{startRow:u,startColumn:h,endRow:d,endColumn:m,startY:o,endY:a,startX:l,endX:c}}const pp=Fc;function Ep(e){if(!e)return;const{actualRow:t,actualColumn:n,isMerged:r,isMergedMainCell:s,startRow:i,startColumn:o,endRow:a,endColumn:l}=e;let c=t,u=n,h=t,d=n;return(r||s)&&(c=i,u=o,h=a,d=l),{startRow:c,startColumn:u,endRow:h,endColumn:d}}function xc(e){var n;return!e||(((n=e==null?void 0:e.v)==null?void 0:n.toString())||"").length===0&&!e.p}function Bi(e){return xc(e)&&(e==null?void 0:e.coverable)!==!1}function Ut(e){if(e){if(e.rgb)return new Ct(e.rgb).toHexString();if(e.th)return new gs().setThemeColor(e.th).asThemeColor().asRgbColor().getCssString()}return null}function Bc(e){return Z.isString(e)&&e.substring(0,1)==="="&&e.length>1}function Cp(e){return Z.isString(e)&&e.length>0}function Rp(e,t=!1){var i;let n="";const r=new Map([["ff",()=>{e.ff&&(n+=`font-family: ${e.ff}; `)}],["fs",()=>{if(e.fs){let o=e.fs;e.va&&(o/=2),n+=`font-size: ${o}pt; `}}],["it",()=>{e.it&&(n+="font-style: italic; ")}],["bl",()=>{e.bl&&(n+="font-weight: bold; ")}],["ul",()=>{var o;(o=e.ul)!=null&&o.s&&(n.indexOf("text-decoration-line")>-1?n=n.replace(/(text-decoration-line:\s*[^;]+)(?=;)/g,(a,l)=>`${l} underline`):n+="text-decoration: underline; ",e.ul.cl&&n.indexOf("text-decoration-color")===-1&&(n+=`text-decoration-color: ${Ut(e.ul.cl)}; `),e.ul.t&&n.indexOf("text-decoration-style")===-1&&(n+=`text-decoration-style: ${e.ul.t} `))}],["st",()=>{var o;(o=e.st)!=null&&o.s&&(n.indexOf("text-decoration-line")>-1?n=n.replace(/(text-decoration-line:\s*[^;]+)(?=;)/g,(a,l)=>`${l} line-through`):n+="text-decoration-line: line-through; ",e.st.cl&&n.indexOf("text-decoration-color")===-1&&(n+=`text-decoration-color: ${Ut(e.st.cl)}; `),e.st.t&&n.indexOf("text-decoration-style")===-1&&(n+=`text-decoration-style: ${e.st.t} `))}],["ol",()=>{var o;(o=e.ol)!=null&&o.s&&(n.indexOf("text-decoration-line")>-1?n=n.replace(/(text-decoration-line:\s*[^;]+)(?=;)/g,(a,l)=>`${l} overline`):n+="text-decoration-line: overline; ",e.ol.cl&&n.indexOf("text-decoration-color")===-1&&(n+=`text-decoration-color: ${Ut(e.ol.cl)}; `),e.ol.t&&n.indexOf("text-decoration-style")===-1&&(n+=`text-decoration-style: ${e.ol.t} `))}],["bg",()=>{e.bg&&(n+=`background: ${Ut(e.bg)}; `)}],["bd",()=>{var o,a,l,c,u,h,d,m,_,p,I,A;(o=e.bd)!=null&&o.b&&(n+=`border-bottom: ${Cs((a=e.bd)==null?void 0:a.b.s)} ${(l=Ut(e.bd.b.cl))!=null?l:""}; `),(c=e.bd)!=null&&c.t&&(n+=`border-top: ${Cs((u=e.bd)==null?void 0:u.t.s)} ${(h=Ut(e.bd.t.cl))!=null?h:""}; `),(d=e.bd)!=null&&d.r&&(n+=`border-right: ${Cs((m=e.bd)==null?void 0:m.r.s)} ${(_=Ut(e.bd.r.cl))!=null?_:""}; `),(p=e.bd)!=null&&p.l&&(n+=`border-left: ${Cs((I=e.bd)==null?void 0:I.l.s)} ${(A=Ut(e.bd.l.cl))!=null?A:""}; `)}],["cl",()=>{e.cl&&(n+=`color: ${Ut(e.cl)}; `)}],["va",()=>{e.va===Ht.SUBSCRIPT?n+="vertical-align: sub; ":e.va===Ht.SUPERSCRIPT&&(n+="vertical-align: super; ")}],["td",()=>{e.td===cr.LEFT_TO_RIGHT?n+="direction: ltr; ":e.td===cr.RIGHT_TO_LEFT&&(n+="direction: rtl; ")}],["tr",()=>{var o,a,l;e.tr&&(n+=`--data-rotate: (${(o=e.tr)==null?void 0:o.a}deg${(a=e.tr)!=null&&a.v?` ,${(l=e.tr)==null?void 0:l.v}`:""});`)}],["ht",()=>{e.ht===vt.LEFT?n+="text-align: left; ":e.ht===vt.RIGHT?n+="text-align: right; ":e.ht===vt.CENTER?n+="text-align: center; ":e.ht===vt.JUSTIFIED&&(n+="text-align: justify; ")}],["vt",()=>{e.vt===fn.BOTTOM?n+="vertical-align: bottom; ":e.vt===fn.TOP?n+="vertical-align: top; ":e.vt===fn.MIDDLE&&(n+="vertical-align: middle; ")}],["tb",()=>{e.tb===mn.CLIP?n+="white-space: nowrap; overflow-x: hidden; ":e.tb===mn.WRAP&&(n+="white-space: normal;")}],["pd",()=>{var u,h,d,m,_,p,I,A;const o=`${(u=e.pd)==null?void 0:u.b}pt`,a=`${(h=e.pd)==null?void 0:h.t}pt`,l=`${(d=e.pd)==null?void 0:d.l}pt`,c=`${(m=e.pd)==null?void 0:m.r}pt`;(_=e.pd)!=null&&_.b&&(n+=`padding-bottom: ${o}; `),(p=e.pd)!=null&&p.t&&(n+=`padding-top: ${a}; `),(I=e.pd)!=null&&I.l&&(n+=`padding-left: ${l}; `),(A=e.pd)!=null&&A.r&&(n+=`padding-right: ${c}; `)}]]),s=["bd","tr","tb"];for(const o in e)t&&s.includes(o)||(i=r.get(o))==null||i();return n}function Cs(e){let t="";return e===Ue.NONE?t="none":e===Ue.THIN?t="0.5pt solid":e===Ue.HAIR?t="0.5pt double":e===Ue.DOTTED?t="0.5pt dotted":e===Ue.DASHED||e===Ue.DASH_DOT?t="0.5pt dashed":e===Ue.DASH_DOT_DOT?t="0.5pt dotted":e===Ue.DOUBLE?t="0.5pt double":e===Ue.MEDIUM?t="1pt solid":e===Ue.MEDIUM_DASHED||e===Ue.MEDIUM_DASH_DOT?t="1pt dashed":e===Ue.MEDIUM_DASH_DOT_DOT?t="1pt dotted":e===Ue.SLANT_DASH_DOT?t="0.5pt dashed":e===Ue.THICK&&(t="1.5pt solid"),t}function Ip(e){let t=0;if(e=e.trim(),e==="none")t=Ue.NONE;else if(e==="0.5pt solid")t=Ue.THIN;else if(e==="0.5pt double")t=Ue.HAIR;else if(e==="0.5pt dotted")t=Ue.DOTTED;else if(e==="0.5pt dashed")t=Ue.DASHED;else if(e==="1pt solid")t=Ue.MEDIUM;else if(e==="1pt dashed")t=Ue.MEDIUM_DASHED;else if(e==="1pt dotted")t=Ue.MEDIUM_DASH_DOT_DOT;else if(e==="1.5pt solid")t=Ue.THICK;else if(!e.includes("none"))t=Ue.THIN;else return Ue.NONE;return t}function Sp(e,t){let n=e.body;if(t){const{headers:r,footers:s}=e;r!=null&&r[t]?n=r[t].body:s!=null&&s[t]&&(n=s[t].body)}return n}function Op(e,t){const{startRow:n,endRow:r,startColumn:s,endColumn:i,rangeType:o}=e;if(n<0||s<0||r<0||i<0||!(Number.isNaN(n)&&Number.isNaN(r))&&o===pe.COLUMN||!(Number.isNaN(s)&&Number.isNaN(i))&&o===pe.ROW||o!==pe.ROW&&o!==pe.COLUMN&&(Number.isNaN(s)||Number.isNaN(n)||Number.isNaN(i)||Number.isNaN(r)))return!1;if(t){const a=t.getRowCount(),l=t.getColumnCount();if(r>=a||i>=l)return!1}return!0}function vp(e,t){return{startRow:e,endRow:e,startColumn:t,endColumn:t}}function $i(e){return Bc(e)?{f:e,v:null,p:null}:Uc(e)?{v:e,p:null,f:null}:(Dc(e),e)}function wp(e,t){const n=new ut,{startRow:r,startColumn:s,endRow:i,endColumn:o}=t;if(Z.isArray(e))for(let a=0;a<=i-r;a++)for(let l=0;l<=o-s;l++)n.setValue(a+r,l+s,$i(e[a][l]));else new ut(e).forValue((l,c,u)=>{n.setValue(l,c,$i(u))});return n.getMatrix()}function Hi(e,t){return Object.prototype.toString.call(e)===Object.prototype.toString.call(t)?Object.prototype.toString.call(e)==="[object Object]"||Object.prototype.toString.call(e)==="[object Array]"?Object.keys(e).length!==Object.keys(t).length?!1:Object.keys(e).every(n=>Hi(e[n],t[n])):e===t:!1}function $c(e,t){const n=e.ts||{},r=t.ts||{};return e.sId!==t.sId?!1:Hi(n,r)}function bp(e,t){return t.some(n=>e.indexOf(n)>-1)}var Rs={exports:{}},Ap=Rs.exports,Hc;function Tp(){return Hc||(Hc=1,(function(e,t){(function(n,r){e.exports=r()})(Ap,(function(){var n=1e3,r=6e4,s=36e5,i="millisecond",o="second",a="minute",l="hour",c="day",u="week",h="month",d="quarter",m="year",_="date",p="Invalid Date",I=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,A=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,B={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(M){var T=["th","st","nd","rd"],w=M%100;return"["+M+(T[(w-20)%10]||T[w]||T[0])+"]"}},x=function(M,T,w){var N=String(M);return!N||N.length>=T?M:""+Array(T+1-N.length).join(w)+M},Y={s:x,z:function(M){var T=-M.utcOffset(),w=Math.abs(T),N=Math.floor(w/60),L=w%60;return(T<=0?"+":"-")+x(N,2,"0")+":"+x(L,2,"0")},m:function M(T,w){if(T.date()<w.date())return-M(w,T);var N=12*(w.year()-T.year())+(w.month()-T.month()),L=T.clone().add(N,h),D=w-L<0,F=T.clone().add(N+(D?-1:1),h);return+(-(N+(w-L)/(D?L-F:F-L))||0)},a:function(M){return M<0?Math.ceil(M)||0:Math.floor(M)},p:function(M){return{M:h,y:m,w:u,d:c,D:_,h:l,m:a,s:o,ms:i,Q:d}[M]||String(M||"").toLowerCase().replace(/s$/,"")},u:function(M){return M===void 0}},O="en",R={};R[O]=B;var b="$isDayjsObject",y=function(M){return M instanceof P||!(!M||!M[b])},$=function M(T,w,N){var L;if(!T)return O;if(typeof T=="string"){var D=T.toLowerCase();R[D]&&(L=D),w&&(R[D]=w,L=D);var F=T.split("-");if(!L&&F.length>1)return M(F[0])}else{var Q=T.name;R[Q]=T,L=Q}return!N&&L&&(O=L),L||!N&&O},H=function(M,T){if(y(M))return M.clone();var w=typeof T=="object"?T:{};return w.date=M,w.args=arguments,new P(w)},g=Y;g.l=$,g.i=y,g.w=function(M,T){return H(M,{locale:T.$L,utc:T.$u,x:T.$x,$offset:T.$offset})};var P=(function(){function M(w){this.$L=$(w.locale,null,!0),this.parse(w),this.$x=this.$x||w.x||{},this[b]=!0}var T=M.prototype;return T.parse=function(w){this.$d=(function(N){var L=N.date,D=N.utc;if(L===null)return new Date(NaN);if(g.u(L))return new Date;if(L instanceof Date)return new Date(L);if(typeof L=="string"&&!/Z$/i.test(L)){var F=L.match(I);if(F){var Q=F[2]-1||0,z=(F[7]||"0").substring(0,3);return D?new Date(Date.UTC(F[1],Q,F[3]||1,F[4]||0,F[5]||0,F[6]||0,z)):new Date(F[1],Q,F[3]||1,F[4]||0,F[5]||0,F[6]||0,z)}}return new Date(L)})(w),this.init()},T.init=function(){var w=this.$d;this.$y=w.getFullYear(),this.$M=w.getMonth(),this.$D=w.getDate(),this.$W=w.getDay(),this.$H=w.getHours(),this.$m=w.getMinutes(),this.$s=w.getSeconds(),this.$ms=w.getMilliseconds()},T.$utils=function(){return g},T.isValid=function(){return this.$d.toString()!==p},T.isSame=function(w,N){var L=H(w);return this.startOf(N)<=L&&L<=this.endOf(N)},T.isAfter=function(w,N){return H(w)<this.startOf(N)},T.isBefore=function(w,N){return this.endOf(N)<H(w)},T.$g=function(w,N,L){return g.u(w)?this[N]:this.set(L,w)},T.unix=function(){return Math.floor(this.valueOf()/1e3)},T.valueOf=function(){return this.$d.getTime()},T.startOf=function(w,N){var L=this,D=!!g.u(N)||N,F=g.p(w),Q=function(j,W){var ee=g.w(L.$u?Date.UTC(L.$y,W,j):new Date(L.$y,W,j),L);return D?ee:ee.endOf(c)},z=function(j,W){return g.w(L.toDate()[j].apply(L.toDate("s"),(D?[0,0,0,0]:[23,59,59,999]).slice(W)),L)},le=this.$W,ue=this.$M,S=this.$D,U="set"+(this.$u?"UTC":"");switch(F){case m:return D?Q(1,0):Q(31,11);case h:return D?Q(1,ue):Q(0,ue+1);case u:var G=this.$locale().weekStart||0,V=(le<G?le+7:le)-G;return Q(D?S-V:S+(6-V),ue);case c:case _:return z(U+"Hours",0);case l:return z(U+"Minutes",1);case a:return z(U+"Seconds",2);case o:return z(U+"Milliseconds",3);default:return this.clone()}},T.endOf=function(w){return this.startOf(w,!1)},T.$set=function(w,N){var L,D=g.p(w),F="set"+(this.$u?"UTC":""),Q=(L={},L[c]=F+"Date",L[_]=F+"Date",L[h]=F+"Month",L[m]=F+"FullYear",L[l]=F+"Hours",L[a]=F+"Minutes",L[o]=F+"Seconds",L[i]=F+"Milliseconds",L)[D],z=D===c?this.$D+(N-this.$W):N;if(D===h||D===m){var le=this.clone().set(_,1);le.$d[Q](z),le.init(),this.$d=le.set(_,Math.min(this.$D,le.daysInMonth())).$d}else Q&&this.$d[Q](z);return this.init(),this},T.set=function(w,N){return this.clone().$set(w,N)},T.get=function(w){return this[g.p(w)]()},T.add=function(w,N){var L,D=this;w=Number(w);var F=g.p(N),Q=function(ue){var S=H(D);return g.w(S.date(S.date()+Math.round(ue*w)),D)};if(F===h)return this.set(h,this.$M+w);if(F===m)return this.set(m,this.$y+w);if(F===c)return Q(1);if(F===u)return Q(7);var z=(L={},L[a]=r,L[l]=s,L[o]=n,L)[F]||1,le=this.$d.getTime()+w*z;return g.w(le,this)},T.subtract=function(w,N){return this.add(-1*w,N)},T.format=function(w){var N=this,L=this.$locale();if(!this.isValid())return L.invalidDate||p;var D=w||"YYYY-MM-DDTHH:mm:ssZ",F=g.z(this),Q=this.$H,z=this.$m,le=this.$M,ue=L.weekdays,S=L.months,U=L.meridiem,G=function(W,ee,te,k){return W&&(W[ee]||W(N,D))||te[ee].slice(0,k)},V=function(W){return g.s(Q%12||12,W,"0")},j=U||function(W,ee,te){var k=W<12?"AM":"PM";return te?k.toLowerCase():k};return D.replace(A,(function(W,ee){return ee||(function(te){switch(te){case"YY":return String(N.$y).slice(-2);case"YYYY":return g.s(N.$y,4,"0");case"M":return le+1;case"MM":return g.s(le+1,2,"0");case"MMM":return G(L.monthsShort,le,S,3);case"MMMM":return G(S,le);case"D":return N.$D;case"DD":return g.s(N.$D,2,"0");case"d":return String(N.$W);case"dd":return G(L.weekdaysMin,N.$W,ue,2);case"ddd":return G(L.weekdaysShort,N.$W,ue,3);case"dddd":return ue[N.$W];case"H":return String(Q);case"HH":return g.s(Q,2,"0");case"h":return V(1);case"hh":return V(2);case"a":return j(Q,z,!0);case"A":return j(Q,z,!1);case"m":return String(z);case"mm":return g.s(z,2,"0");case"s":return String(N.$s);case"ss":return g.s(N.$s,2,"0");case"SSS":return g.s(N.$ms,3,"0");case"Z":return F}return null})(W)||F.replace(":","")}))},T.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},T.diff=function(w,N,L){var D,F=this,Q=g.p(N),z=H(w),le=(z.utcOffset()-this.utcOffset())*r,ue=this-z,S=function(){return g.m(F,z)};switch(Q){case m:D=S()/12;break;case h:D=S();break;case d:D=S()/3;break;case u:D=(ue-le)/6048e5;break;case c:D=(ue-le)/864e5;break;case l:D=ue/s;break;case a:D=ue/r;break;case o:D=ue/n;break;default:D=ue}return L?D:g.a(D)},T.daysInMonth=function(){return this.endOf(h).$D},T.$locale=function(){return R[this.$L]},T.locale=function(w,N){if(!w)return this.$L;var L=this.clone(),D=$(w,N,!0);return D&&(L.$L=D),L},T.clone=function(){return g.w(this.$d,this)},T.toDate=function(){return new Date(this.valueOf())},T.toJSON=function(){return this.isValid()?this.toISOString():null},T.toISOString=function(){return this.$d.toISOString()},T.toString=function(){return this.$d.toUTCString()},M})(),v=P.prototype;return H.prototype=v,[["$ms",i],["$s",o],["$m",a],["$H",l],["$W",c],["$M",h],["$y",m],["$D",_]].forEach((function(M){v[M[1]]=function(T){return this.$g(T,M[0],M[1])}})),H.extend=function(M,T){return M.$i||(M(T,P,H),M.$i=!0),H},H.locale=$,H.isDayjs=y,H.unix=function(M){return H(1e3*M)},H.en=R[O],H.Ls=R,H.p={},H}))})(Rs)),Rs.exports}var yp=Tp();const jt=mt(yp);var Is={exports:{}},Np=Is.exports,jc;function Mp(){return jc||(jc=1,(function(e,t){(function(n,r){e.exports=r()})(Np,(function(){return function(n,r){var s=r.prototype,i=s.format;s.format=function(o){var a=this,l=this.$locale();if(!this.isValid())return i.bind(this)(o);var c=this.$utils(),u=(o||"YYYY-MM-DDTHH:mm:ssZ").replace(/\[([^\]]+)]|Q|wo|ww|w|WW|W|zzz|z|gggg|GGGG|Do|X|x|k{1,2}|S/g,(function(h){switch(h){case"Q":return Math.ceil((a.$M+1)/3);case"Do":return l.ordinal(a.$D);case"gggg":return a.weekYear();case"GGGG":return a.isoWeekYear();case"wo":return l.ordinal(a.week(),"W");case"w":case"ww":return c.s(a.week(),h==="w"?1:2,"0");case"W":case"WW":return c.s(a.isoWeek(),h==="W"?1:2,"0");case"k":case"kk":return c.s(String(a.$H===0?24:a.$H),h==="k"?1:2,"0");case"X":return Math.floor(a.$d.getTime()/1e3);case"x":return a.$d.getTime();case"z":return"["+a.offsetName()+"]";case"zzz":return"["+a.offsetName("long")+"]";default:return h}}));return i.bind(this)(u)}}}))})(Is)),Is.exports}var Lp=Mp();const Dp=mt(Lp);var Ss={exports:{}},Up=Ss.exports,Wc;function Pp(){return Wc||(Wc=1,(function(e,t){(function(n,r){e.exports=r()})(Up,(function(){var n={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},r=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|Q|YYYY|YY?|ww?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,s=/\d/,i=/\d\d/,o=/\d\d?/,a=/\d*[^-_:/,()\s\d]+/,l={},c=function(I){return(I=+I)+(I>68?1900:2e3)},u=function(I){return function(A){this[I]=+A}},h=[/[+-]\d\d:?(\d\d)?|Z/,function(I){(this.zone||(this.zone={})).offset=(function(A){if(!A||A==="Z")return 0;var B=A.match(/([+-]|\d\d)/g),x=60*B[1]+(+B[2]||0);return x===0?0:B[0]==="+"?-x:x})(I)}],d=function(I){var A=l[I];return A&&(A.indexOf?A:A.s.concat(A.f))},m=function(I,A){var B,x=l.meridiem;if(x){for(var Y=1;Y<=24;Y+=1)if(I.indexOf(x(Y,0,A))>-1){B=Y>12;break}}else B=I===(A?"pm":"PM");return B},_={A:[a,function(I){this.afternoon=m(I,!1)}],a:[a,function(I){this.afternoon=m(I,!0)}],Q:[s,function(I){this.month=3*(I-1)+1}],S:[s,function(I){this.milliseconds=100*+I}],SS:[i,function(I){this.milliseconds=10*+I}],SSS:[/\d{3}/,function(I){this.milliseconds=+I}],s:[o,u("seconds")],ss:[o,u("seconds")],m:[o,u("minutes")],mm:[o,u("minutes")],H:[o,u("hours")],h:[o,u("hours")],HH:[o,u("hours")],hh:[o,u("hours")],D:[o,u("day")],DD:[i,u("day")],Do:[a,function(I){var A=l.ordinal,B=I.match(/\d+/);if(this.day=B[0],A)for(var x=1;x<=31;x+=1)A(x).replace(/\[|\]/g,"")===I&&(this.day=x)}],w:[o,u("week")],ww:[i,u("week")],M:[o,u("month")],MM:[i,u("month")],MMM:[a,function(I){var A=d("months"),B=(d("monthsShort")||A.map((function(x){return x.slice(0,3)}))).indexOf(I)+1;if(B<1)throw new Error;this.month=B%12||B}],MMMM:[a,function(I){var A=d("months").indexOf(I)+1;if(A<1)throw new Error;this.month=A%12||A}],Y:[/[+-]?\d+/,u("year")],YY:[i,function(I){this.year=c(I)}],YYYY:[/\d{4}/,u("year")],Z:h,ZZ:h};function p(I){var A,B;A=I,B=l&&l.formats;for(var x=(I=A.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,(function(H,g,P){var v=P&&P.toUpperCase();return g||B[P]||n[P]||B[v].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(function(M,T,w){return T||w.slice(1)}))}))).match(r),Y=x.length,O=0;O<Y;O+=1){var R=x[O],b=_[R],y=b&&b[0],$=b&&b[1];x[O]=$?{regex:y,parser:$}:R.replace(/^\[|\]$/g,"")}return function(H){for(var g={},P=0,v=0;P<Y;P+=1){var M=x[P];if(typeof M=="string")v+=M.length;else{var T=M.regex,w=M.parser,N=H.slice(v),L=T.exec(N)[0];w.call(g,L),H=H.replace(L,"")}}return(function(D){var F=D.afternoon;if(F!==void 0){var Q=D.hours;F?Q<12&&(D.hours+=12):Q===12&&(D.hours=0),delete D.afternoon}})(g),g}}return function(I,A,B){B.p.customParseFormat=!0,I&&I.parseTwoDigitYear&&(c=I.parseTwoDigitYear);var x=A.prototype,Y=x.parse;x.parse=function(O){var R=O.date,b=O.utc,y=O.args;this.$u=b;var $=y[1];if(typeof $=="string"){var H=y[2]===!0,g=y[3]===!0,P=H||g,v=y[2];g&&(v=y[2]),l=this.$locale(),!H&&v&&(l=B.Ls[v]),this.$d=(function(N,L,D,F){try{if(["x","X"].indexOf(L)>-1)return new Date((L==="X"?1e3:1)*N);var Q=p(L)(N),z=Q.year,le=Q.month,ue=Q.day,S=Q.hours,U=Q.minutes,G=Q.seconds,V=Q.milliseconds,j=Q.zone,W=Q.week,ee=new Date,te=ue||(z||le?1:ee.getDate()),k=z||ee.getFullYear(),K=0;z&&!le||(K=le>0?le-1:ee.getMonth());var q,re=S||0,ge=U||0,Ee=G||0,X=V||0;return j?new Date(Date.UTC(k,K,te,re,ge,Ee,X+60*j.offset*1e3)):D?new Date(Date.UTC(k,K,te,re,ge,Ee,X)):(q=new Date(k,K,te,re,ge,Ee,X),W&&(q=F(q).week(W).toDate()),q)}catch{return new Date("")}})(R,$,b,B),this.init(),v&&v!==!0&&(this.$L=this.locale(v).$L),P&&R!=this.format($)&&(this.$d=new Date("")),l={}}else if($ instanceof Array)for(var M=$.length,T=1;T<=M;T+=1){y[1]=$[T-1];var w=B.apply(this,y);if(w.isValid()){this.$d=w.$d,this.$L=w.$L,this.init();break}T===M&&(this.$d=new Date(""))}else Y.call(this,O)}}}))})(Ss)),Ss.exports}var kp=Pp();const Fp=mt(kp);var Os={exports:{}},xp=Os.exports,Yc;function Bp(){return Yc||(Yc=1,(function(e,t){(function(n,r){e.exports=r()})(xp,(function(){return function(n,r,s){var i=r.prototype,o=function(h){return h&&(h.indexOf?h:h.s)},a=function(h,d,m,_,p){var I=h.name?h:h.$locale(),A=o(I[d]),B=o(I[m]),x=A||B.map((function(O){return O.slice(0,_)}));if(!p)return x;var Y=I.weekStart;return x.map((function(O,R){return x[(R+(Y||0))%7]}))},l=function(){return s.Ls[s.locale()]},c=function(h,d){return h.formats[d]||(function(m){return m.replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(function(_,p,I){return p||I.slice(1)}))})(h.formats[d.toUpperCase()])},u=function(){var h=this;return{months:function(d){return d?d.format("MMMM"):a(h,"months")},monthsShort:function(d){return d?d.format("MMM"):a(h,"monthsShort","months",3)},firstDayOfWeek:function(){return h.$locale().weekStart||0},weekdays:function(d){return d?d.format("dddd"):a(h,"weekdays")},weekdaysMin:function(d){return d?d.format("dd"):a(h,"weekdaysMin","weekdays",2)},weekdaysShort:function(d){return d?d.format("ddd"):a(h,"weekdaysShort","weekdays",3)},longDateFormat:function(d){return c(h.$locale(),d)},meridiem:this.$locale().meridiem,ordinal:this.$locale().ordinal}};i.localeData=function(){return u.bind(this)()},s.localeData=function(){var h=l();return{firstDayOfWeek:function(){return h.weekStart||0},weekdays:function(){return s.weekdays()},weekdaysShort:function(){return s.weekdaysShort()},weekdaysMin:function(){return s.weekdaysMin()},months:function(){return s.months()},monthsShort:function(){return s.monthsShort()},longDateFormat:function(d){return c(h,d)},meridiem:h.meridiem,ordinal:h.ordinal}},s.months=function(){return a(l(),"months")},s.monthsShort=function(){return a(l(),"monthsShort","months",3)},s.weekdays=function(h){return a(l(),"weekdays",null,null,h)},s.weekdaysShort=function(h){return a(l(),"weekdaysShort","weekdays",3,h)},s.weekdaysMin=function(h){return a(l(),"weekdaysMin","weekdays",2,h)}}}))})(Os)),Os.exports}var $p=Bp();const Hp=mt($p);var vs={exports:{}},jp=vs.exports,Gc;function Wp(){return Gc||(Gc=1,(function(e,t){(function(n,r){e.exports=r()})(jp,(function(){var n={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};return function(r,s,i){var o=s.prototype,a=o.format;i.en.formats=n,o.format=function(l){l===void 0&&(l="YYYY-MM-DDTHH:mm:ssZ");var c=this.$locale().formats,u=(function(h,d){return h.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,(function(m,_,p){var I=p&&p.toUpperCase();return _||d[p]||n[p]||d[I].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(function(A,B,x){return B||x.slice(1)}))}))})(l,c===void 0?{}:c);return a.call(this,u)}}}))})(vs)),vs.exports}var Yp=Wp();const Gp=mt(Yp);var ws={exports:{}},Vp=ws.exports,Vc;function zp(){return Vc||(Vc=1,(function(e,t){(function(n,r){e.exports=r()})(Vp,(function(){var n="minute",r=/[+-]\d\d(?::?\d\d)?/g,s=/([+-]|\d\d)/g;return function(i,o,a){var l=o.prototype;a.utc=function(p){var I={date:p,utc:!0,args:arguments};return new o(I)},l.utc=function(p){var I=a(this.toDate(),{locale:this.$L,utc:!0});return p?I.add(this.utcOffset(),n):I},l.local=function(){return a(this.toDate(),{locale:this.$L,utc:!1})};var c=l.parse;l.parse=function(p){p.utc&&(this.$u=!0),this.$utils().u(p.$offset)||(this.$offset=p.$offset),c.call(this,p)};var u=l.init;l.init=function(){if(this.$u){var p=this.$d;this.$y=p.getUTCFullYear(),this.$M=p.getUTCMonth(),this.$D=p.getUTCDate(),this.$W=p.getUTCDay(),this.$H=p.getUTCHours(),this.$m=p.getUTCMinutes(),this.$s=p.getUTCSeconds(),this.$ms=p.getUTCMilliseconds()}else u.call(this)};var h=l.utcOffset;l.utcOffset=function(p,I){var A=this.$utils().u;if(A(p))return this.$u?0:A(this.$offset)?h.call(this):this.$offset;if(typeof p=="string"&&(p=(function(O){O===void 0&&(O="");var R=O.match(r);if(!R)return null;var b=(""+R[0]).match(s)||["-",0,0],y=b[0],$=60*+b[1]+ +b[2];return $===0?0:y==="+"?$:-$})(p),p===null))return this;var B=Math.abs(p)<=16?60*p:p;if(B===0)return this.utc(I);var x=this.clone();if(I)return x.$offset=B,x.$u=!1,x;var Y=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();return(x=this.local().add(B+Y,n)).$offset=B,x.$x.$localOffset=Y,x};var d=l.format;l.format=function(p){var I=p||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return d.call(this,I)},l.valueOf=function(){var p=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*p},l.isUTC=function(){return!!this.$u},l.toISOString=function(){return this.toDate().toISOString()},l.toString=function(){return this.toDate().toUTCString()};var m=l.toDate;l.toDate=function(p){return p==="s"&&this.$offset?a(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():m.call(this)};var _=l.diff;l.diff=function(p,I,A){if(p&&this.$u===p.$u)return _.call(this,p,I,A);var B=this.local(),x=a(p).local();return _.call(B,x,I,A)}}}))})(ws)),ws.exports}var Kp=zp();const Xp=mt(Kp);var bs={exports:{}},qp=bs.exports,zc;function Zp(){return zc||(zc=1,(function(e,t){(function(n,r){e.exports=r()})(qp,(function(){return function(n,r){r.prototype.weekday=function(s){var i=this.$locale().weekStart||0,o=this.$W,a=(o<i?o+7:o)-i;return this.$utils().u(s)?a:this.subtract(a,"day").add(s,"day")}}}))})(bs)),bs.exports}var Jp=Zp();const Qp=mt(Jp);var As={exports:{}},eE=As.exports,Kc;function tE(){return Kc||(Kc=1,(function(e,t){(function(n,r){e.exports=r()})(eE,(function(){var n="week",r="year";return function(s,i,o){var a=i.prototype;a.week=function(l){if(l===void 0&&(l=null),l!==null)return this.add(7*(l-this.week()),"day");var c=this.$locale().yearStart||1;if(this.month()===11&&this.date()>25){var u=o(this).startOf(r).add(1,r).date(c),h=o(this).endOf(n);if(u.isBefore(h))return 1}var d=o(this).startOf(r).date(c).startOf(n).subtract(1,"millisecond"),m=this.diff(d,n,!0);return m<0?o(this).startOf("week").week():Math.ceil(m)},a.weeks=function(l){return l===void 0&&(l=null),this.week(l)}}}))})(As)),As.exports}var nE=tE();const rE=mt(nE);var Ts={exports:{}},sE=Ts.exports,Xc;function iE(){return Xc||(Xc=1,(function(e,t){(function(n,r){e.exports=r()})(sE,(function(){return function(n,r){r.prototype.weekYear=function(){var s=this.month(),i=this.week(),o=this.year();return i===1&&s===11?o+1:s===0&&i>=52?o-1:o}}}))})(Ts)),Ts.exports}var oE=iE();const aE=mt(oE);jt.extend(Fp),jt.extend(Dp),jt.extend(Qp),jt.extend(Hp),jt.extend(rE),jt.extend(aE),jt.extend(Xp),jt.extend(Gp);function ys(e,t,n,r){if(e>t)throw new Error("a1 should be less than a2");if(n>r)throw new Error("b1 should be less than b2");if(t<n||r<e)return[e,t];if(n<=e&&r>=t)return[];const s=r-n+1;return e<n&&t>r?[e,t-s]:n<=e&&r<t?[r+1-s,t-s]:n>e&&r>=t?[e,n-1]:[e,t]}function lE(e){if(e==null)return!1;const t=e.bullet;return(t==null?void 0:t.listId)!=null}function cE(e){if(e==null)return!1;const t=e.paragraphStyle;return qc(t)}function qc(e){var t;return!(e==null||(e.indentStart==null||e.indentStart.v===0)&&e.hanging==null||((t=e.hanging)==null?void 0:t.v)===0)}function Zc(e,t,n){return e.slice(0,t)+n+e.slice(t)}function Jc(e,t,n){return t>n?e:e.slice(0,t)+e.slice(n)}function uE(e){if(e==null||typeof e=="boolean")return!1;if(typeof e=="number")return!isNaN(e);if(typeof e=="string"){const t=e.trim();return t===""?!1:!isNaN(Number(t))}return!1}function hE(e){let t=0;for(let n=0;n<e.length;n++)t=e.charCodeAt(n)+(t<<6)+(t<<16)-t;return t>>>0}function dE(...e){let t;return e.length===1&&Array.isArray(e[0])?t=e[0]:t=e,rs({},...t)}const De=Symbol("newer"),Ze=Symbol("older");class fE{constructor(t){C(this,"entry");this.entry=t}[Symbol.iterator](){return this}next(){const t=this.entry;return t?(this.entry=t[De],{done:!1,value:t.key}):{done:!0,value:void 0}}}class mE{constructor(t){C(this,"entry");this.entry=t}[Symbol.iterator](){return this}next(){const t=this.entry;return t?(this.entry=t[De],{done:!1,value:t.value}):{done:!0,value:void 0}}}class gE{constructor(t){C(this,"entry");this.entry=t}[Symbol.iterator](){return this}next(){const t=this.entry;return t?(this.entry=t[De],{done:!1,value:[t.key,t.value]}):{done:!0,value:void 0}}}Rd=De,Cd=Ze;class Qc{constructor(t,n){C(this,"key");C(this,"value");C(this,Rd);C(this,Cd);this.key=t,this.value=n,this[De]=void 0,this[Ze]=void 0}toJSON(){return{key:this.key,value:this.value}}}class _r{constructor(...t){C(this,"_keymap");C(this,"size",0);C(this,"limit");C(this,"oldest");C(this,"newest");C(this,"_onShiftListeners",[]);if(pr.hasLength(t,1)){if(pr.isNumber(t[0])){const n=t[0];this._initialize(n,void 0);return}if(pr.isIterable(t[0])){const n=t[0];this._initialize(0,n);return}return}if(pr.hasLength(t,2)){const n=t[0],r=t[1];this._initialize(n,r)}}onShift(t){if(this._onShiftListeners.indexOf(t)===-1)return this._onShiftListeners.push(t),We(()=>tr(this._onShiftListeners,t));throw new Error("[LRUMap]: the listener has been registered!")}_initialize(t,n){this.oldest=void 0,this.newest=void 0,this.size=0,this.limit=t,this._keymap=new Map,n&&(this.assign(n),t<1&&(this.limit=this.size))}_markEntryAsUsed(t){t!==this.newest&&(t[De]&&(t===this.oldest&&(this.oldest=t[De]),t[De][Ze]=t[Ze]),t[Ze]&&(t[Ze][De]=t[De]),t[De]=void 0,t[Ze]=this.newest,this.newest&&(this.newest[De]=t),this.newest=t)}assign(t){let n,r=this.limit||Number.MAX_VALUE;this._keymap.clear();const s=t[Symbol.iterator]();for(let i=s.next();!i.done;i=s.next()){const o=new Qc(i.value[0],i.value[1]);if(this._keymap.set(o.key,o),n?(n[De]=o,o[Ze]=n):this.oldest=o,n=o,r--===0)throw new Error("overflow")}this.newest=n,this.size=this._keymap.size}set(t,n){let r=this._keymap.get(t);return r?(r.value=n,this._markEntryAsUsed(r),this):(this._keymap.set(t,r=new Qc(t,n)),this.newest?(this.newest[De]=r,r[Ze]=this.newest):this.oldest=r,this.newest=r,++this.size,this.size>this.limit&&this.shift(),this)}shift(){const t=this.oldest;if(t)return this.oldest&&this.oldest[De]?(this.oldest=this.oldest[De],this.oldest[Ze]=void 0):(this.oldest=void 0,this.newest=void 0),t[De]=t[Ze]=void 0,this._keymap.delete(t.key),--this.size,this._onShiftListeners.forEach(n=>n(t)),[t.key,t.value]}get(t){const n=this._keymap.get(t);if(n)return this._markEntryAsUsed(n),n.value}has(t){return this._keymap.has(t)}find(t){const n=this._keymap.get(t);return n?n.value:void 0}delete(t){const n=this._keymap.get(t);if(n)return this._keymap.delete(n.key),n[De]&&n[Ze]?(n[Ze][De]=n[De],n[De][Ze]=n[Ze]):n[De]?(n[De][Ze]=void 0,this.oldest=n[De]):n[Ze]?(n[Ze][De]=void 0,this.newest=n[Ze]):this.oldest=this.newest=void 0,this.size--,n.value}clear(){this.oldest=void 0,this.newest=void 0,this.size=0,this._keymap.clear()}keys(){return new fE(this.oldest)}values(){return new mE(this.oldest)}entries(){return this[Symbol.iterator]()}[Symbol.iterator](){return new gE(this.oldest)}forEach(t,n){typeof n!="object"&&(n=this);let r=this.oldest;for(;r;)t.call(n,r.value,r.key,this),r=r[De]}toJSON(){const t=new Array(this.size);let n=0,r=this.oldest;for(;r;)t[n++]={key:r.key,value:r.value},r=r[De];return t}toString(){let t="",n=this.oldest;for(;n;)t+=`${String(n.key)}:${n.value}`,n=n[De],n&&(t+=" < ");return t}}class pr{static hasLength(t,n){return t.length===n}static getValueType(t){return Object.prototype.toString.apply(t)}static isObject(t){return this.getValueType(t)==="[object Object]"}static isIterable(t){return t[Symbol.iterator]!=null}static isNumber(t){return this.getValueType(t)==="[object Number]"}}const Er=2,Cr=2**2,Ns=2**3,Rr=2**4,Ir=2**5,Sr=2**6,ji=2**7,Wi=2**8,Yi=2**9,_E=0,pE=2958466,EE=-694324,CE=35830291,RE=-1,eu=1,Un=6,Gi="general",Vi="hash",Pn="zero",zi="qmark",Ki="slash",Or="group",Ms="scale",Xi="comma",qi="break",Ls="text",Zi="plus",Ji="minus",Ds="point",Qi="space",eo="percent",Us="digit",to="calendar",vr="error",no="datetime",ro="duration",so="condition",io="dbnum",oo="natnum",ao="locale",lo="color",tu="modifier",co="ampm",uo="escaped",ho="string",fo="skip",mo="exp",go="fill",_o="paren",Ps="char",IE=["#000","#FFF","#F00","#0F0","#00F","#FF0","#F0F","#0FF","#000","#FFF","#F00","#0F0","#00F","#FF0","#F0F","#0FF","#800","#080","#008","#880","#808","#088","#CCC","#888","#99F","#936","#FFC","#CFF","#606","#F88","#06C","#CCF","#008","#F0F","#FF0","#0FF","#808","#800","#088","#00F","#0CF","#CFF","#CFC","#FF9","#9CF","#F9C","#C9F","#FC9","#36F","#3CC","#9C0","#FC0"],po=["¤","$","£","¥","֏","؋","৳","฿","៛","₡","₦","₩","₪","₫","€","₭","₮","₱","₲","₴","₸","₹","₺","₼","₽","₾","₿"],Eo=new RegExp("["+po.join("")+"]"),Co=Object.freeze({1078:"af",1052:"sq",1118:"am",5121:"ar_DZ",15361:"ar_BH",3073:"ar_EG",2049:"ar_IQ",11265:"ar_JO",13313:"ar_KW",12289:"ar_LB",4097:"ar_LY",6145:"ar_MA",8193:"ar_OM",16385:"ar_QA",1025:"ar_SA",10241:"ar_SY",7169:"ar_TN",14337:"ar_AE",9217:"ar_YE",1067:"hy",1101:"as",2092:"az_AZ",1068:"az_AZ",1069:"eu",1059:"be",2117:"bn",1093:"bn_IN",5146:"bs",1026:"bg",1109:"my",1027:"ca",2052:"zh_CN",3076:"zh_HK",5124:"zh_MO",4100:"zh_SG",1028:"zh_TW",1050:"hr",1029:"cs",1030:"da",1125:"dv",2067:"nl_BE",1043:"nl_NL",1126:"bin",3081:"en_AU",10249:"en_BZ",4105:"en_CA",9225:"en_CB",2057:"en_GB",16393:"en_IN",6153:"en_IE",8201:"en_JM",5129:"en_NZ",13321:"en_PH",7177:"en_ZA",11273:"en_TT",1033:"en_US",12297:"en_ZW",1061:"et",1071:"mk",1080:"fo",1065:"fa",1124:"fil",1035:"fi",2060:"fr_BE",11276:"fr_CM",3084:"fr_CA",9228:"fr_CG",12300:"fr_CI",1036:"fr_FR",5132:"fr_LU",13324:"fr_ML",6156:"fr_MC",14348:"fr_MA",10252:"fr_SN",4108:"fr_CH",7180:"fr",1122:"fy_NL",2108:"gd_IE",1084:"gd",1110:"gl",1079:"ka",3079:"de_AT",1031:"de_DE",5127:"de_LI",4103:"de_LU",2055:"de_CH",1032:"el",1140:"gn",1095:"gu",1279:"en",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig_NG",1057:"id",1040:"it_IT",2064:"it_CH",1041:"ja",1099:"kn",1120:"ks",1087:"kk",1107:"km",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1142:"la",1062:"lv",1063:"lt",2110:"ms_BN",1086:"ms_MY",1100:"ml",1082:"mt",1112:"mni",1153:"mi",1102:"mr",1104:"mn",2128:"mn",1121:"ne",1044:"no_NO",2068:"no_NO",1096:"or",1045:"pl",1046:"pt_BR",2070:"pt_PT",1094:"pa",1047:"rm",2072:"ro_MO",1048:"ro_RO",1049:"ru",2073:"ru_MO",1083:"se",1103:"sa",3098:"sr_SP",2074:"sr_SP",1072:"st",1074:"tn",1113:"sd",1115:"si",1051:"sk",1060:"sl",1143:"so",1070:"sb",11274:"es_AR",16394:"es_BO",13322:"es_CL",9226:"es_CO",5130:"es_CR",7178:"es_DO",12298:"es_EC",17418:"es_SV",4106:"es_GT",18442:"es_HN",2058:"es_MX",19466:"es_NI",6154:"es_PA",15370:"es_PY",10250:"es_PE",20490:"es_PR",1034:"es_ES",14346:"es_UY",8202:"es_VE",1089:"sw",2077:"sv_FI",1053:"sv_SE",1114:"syc",1064:"tg",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1073:"ts",1055:"tr",1090:"tk",1058:"uk",1056:"ur",2115:"uz_UZ",1091:"uz_UZ",1075:"ve",1066:"vi",1106:"cy",1076:"xh",1085:"yi",1077:"zu"}),nu=/^([a-z\d]+)(?:[_-]([a-z\d]+))?(?:\.([a-z\d]+))?(?:@([a-z\d]+))?$/i,kn={},E=(e,t="")=>e.replace(/~/g,t).split(";"),Pe=(e,t=0,n=0)=>(e.mmm||(e.mmm=t<1?e.mmmm.concat():e.mmmm.map(r=>{const s=r.slice(0,t%10);return s+(t<10||r===s?"":".")})),e.ddd||(e.ddd=n<1?e.dddd.concat():e.dddd.map(r=>{const s=r.slice(0,n%10);return s+(n<10||r===s?"":".")})),!e.mmm6&&e.mmmm6&&(e.mmm6=e.mmmm6),e),SE={group:" ",decimal:".",positive:"+",negative:"-",percent:"%",exponent:"E",nan:"NaN",infinity:"∞",ampm:E("AM;PM"),mmmm6:E("Muharram;Safar;Rabiʻ I;Rabiʻ II;Jumada I;Jumada II;Rajab;Shaʻban;Ramadan;Shawwal;Dhuʻl-Qiʻdah;Dhuʻl-Hijjah"),mmm6:E("Muh.;Saf.;Rab. I;Rab. II;Jum. I;Jum. II;Raj.;Sha.;Ram.;Shaw.;Dhuʻl-Q.;Dhuʻl-H."),mmmm:E("January;February;March;April;May;June;July;August;September;October;November;December"),mmm:E("Jan;Feb;Mar;Apr;May;Jun;Jul;Aug;Sep;Oct;Nov;Dec"),dddd:E("Sunday;Monday;Tuesday;Wednesday;Thursday;Friday;Saturday"),ddd:E("Sun;Mon;Tue;Wed;Thu;Fri;Sat"),bool:E("TRUE;FALSE"),preferMDY:!1};function Ro(e){const t=nu.exec(e);if(!t)throw new SyntaxError(`Malformed locale: ${e}`);return{lang:t[1]+(t[2]?"_"+t[2]:""),language:t[1],territory:t[2]||""}}function Io(e){if(typeof e=="number")return Co[e&65535]||null;const t=parseInt(e,16);return isFinite(t)&&Co[t&65535]?Co[t&65535]||null:nu.test(e)?e:null}function Fn(e){const t=Io(e);let n=null;if(t){const r=Ro(t);n=kn[r.lang]||kn[r.language]||null}return n}function So(e){return Object.assign({},SE,e)}function ne(e,t){const n=typeof t=="object"?t:Ro(t);return kn[n.lang]=So(e),n.language!==n.lang&&!kn[n.language]&&(kn[n.language]=So(e)),kn[n.lang]}const en=So({group:",",preferMDY:!0});en.isDefault=!0,ne({group:",",ampm:E("上午;下午"),mmmm:E("一月;二月;三月;四月;五月;六月;七月;八月;九月;十月;十一月;十二月"),mmm:E("1月;2月;3月;4月;5月;6月;7月;8月;9月;10月;11月;12月"),dddd:E("~日;~一;~二;~三;~四;~五;~六","星期"),ddd:E("周日;周一;周二;周三;周四;周五;周六")},"zh_CN");const Oo={group:",",ampm:E("上午;下午"),mmmm:E("1月;2月;3月;4月;5月;6月;7月;8月;9月;10月;11月;12月"),mmm:E("1月;2月;3月;4月;5月;6月;7月;8月;9月;10月;11月;12月"),dddd:E("~日;~一;~二;~三;~四;~五;~六","星期"),ddd:E("周日;周一;周二;周三;周四;周五;周六")};ne({...Oo,nan:"非數值",dddd:E("~日;~一;~二;~三;~四;~五;~六","星期")},"zh_TW"),ne({...Oo,dddd:E("~日;~一;~二;~三;~四;~五;~六","星期")},"zh_HK"),ne({...Oo,ampm:E("午前;午後"),dddd:E("日~;月~;火~;水~;木~;金~;土~","曜日"),ddd:E("日;月;火;水;木;金;土")},"ja"),ne({group:",",ampm:E("오전;오후"),mmmm:E("1월;2월;3월;4월;5월;6월;7월;8월;9월;10월;11월;12월"),mmm:E("1월;2월;3월;4월;5월;6월;7월;8월;9월;10월;11월;12월"),dddd:E("일요일;월요일;화요일;수요일;목요일;금요일;토요일"),ddd:E("일;월;화;수;목;금;토")},"ko"),ne({group:",",ampm:E("ก่อนเที่ยง;หลังเที่ยง"),mmmm:E("มกร~;กุมภาพันธ์;มีน~;เมษายน;พฤษภ~;มิถุนายน;กรกฎ~;สิงห~;กันยายน;ตุล~;พฤศจิกายน;ธันว~","าคม"),mmm:E("ม.ค.;ก.พ.;มี.ค.;เม.ย.;พ.ค.;มิ.ย.;ก.ค.;ส.ค.;ก.ย.;ต.ค.;พ.ย.;ธ.ค."),dddd:E("วันอาทิตย์;วันจันทร์;วันอังคาร;วันพุธ;วันพฤหัสบดี;วันศุกร์;วันเสาร์"),ddd:E("อา.;จ.;อ.;พ.;พฤ.;ศ.;ส.")},"th"),ne(Pe({decimal:",",ampm:E("dop.;odp."),mmmm:E("ledna;února;března;dubna;května;června;července;srpna;září;října;listopadu;prosince"),mmm:E("I;II;III;IV;V;VI;VII;VIII;IX;X;XI;XII"),dddd:E("neděle;pondělí;úterý;středa;čtvrtek;pátek;sobota"),bool:E("PRAVDA;NEPRAVDA")},-1,2),"cs"),ne(Pe({group:".",decimal:",",mmmm:E("januar;februar;marts;april;maj;juni;juli;august;september;oktober;november;december"),dddd:E("søn~;man~;tirs~;ons~;tors~;fre~;lør~","dag"),bool:E("SAND;FALSK")},13,13),"da"),ne(Pe({group:".",decimal:",",ampm:E("a.m.;p.m."),mmmm:E("januari;februari;maart;april;mei;juni;juli;augustus;september;oktober;november;december"),mmm:E("jan.;feb.;mrt.;apr.;mei;jun.;jul.;aug.;sep.;okt.;nov.;dec."),dddd:E("zondag;maandag;dinsdag;woensdag;donderdag;vrijdag;zaterdag"),bool:E("WAAR;ONWAAR")},-1,2),"nl"),ne({group:",",preferMDY:!0},"en"),ne({group:",",preferMDY:!0},"en_US"),ne({group:","},"en_AU"),ne({group:","},"en_CA"),ne({group:","},"en_GB"),ne({group:",",mmm:E("Jan;Feb;Mar;Apr;May;Jun;Jul;Aug;Sept;Oct;Nov;Dec")},"en_IE"),ne(Pe({decimal:",",nan:"epäluku",ampm:E("ap.;ip."),mmmm:E("tammi~;helmi~;maalis~;huhti~;touko~;kesä~;heinä~;elo~;syys~;loka~;marras~;joulu~","kuuta"),mmm:E("tammik.;helmik.;maalisk.;huhtik.;toukok.;kesäk.;heinäk.;elok.;syysk.;lokak.;marrask.;jouluk."),dddd:E("sunnun~;maanan~;tiis~;keskiviikkona;tors~;perjan~;lauan~","taina"),bool:E("TOSI;EPÄTOSI")},-1,2),"fi");const vo=Pe({group:" ",decimal:",",mmmm:E("janvier;février;mars;avril;mai;juin;juillet;août;septembre;octobre;novembre;décembre"),mmm:E("janv.;févr.;mars;avr.;mai;juin;juil.;août;sept.;oct.;nov.;déc."),dddd:E("~manche;lun~;mar~;mercre~;jeu~;vendre~;same~","di"),bool:E("VRAI;FAUX")},-1,13);ne({...vo},"fr"),ne({...vo,mmm:E("janv.;févr.;mars;avr.;mai;juin;juill.;août;sept.;oct.;nov.;déc.")},"fr_CA"),ne({group:"'",decimal:".",...vo},"fr_CH");const ru=Pe({mmmm:E("Januar;Februar;März;April;Mai;Juni;Juli;August;September;Oktober;November;Dezember"),mmm:E("Jan.;Feb.;März;Apr.;Mai;Juni;Juli;Aug.;Sept.;Okt.;Nov.;Dez."),dddd:E("Sonn~;Mon~;Diens~;Mittwoch;Donners~;Frei~;Sams~","tag"),bool:E("WAHR;FALSCH")},-1,12);ne({group:".",decimal:",",...ru},"de"),ne({group:"'",decimal:".",...ru},"de_CH"),ne(Pe({group:".",decimal:",",ampm:E("π.μ.;μ.μ."),mmmm:E("Ιανουαρ~;Φεβρουαρ~;Μαρτ~;Απριλ~;Μαΐου;Ιουν~;Ιουλ~;Αυγούστου;Σεπτεμβρ~;Οκτωβρ~;Νοεμβρ~;Δεκεμβρ~","ίου"),mmm:E("Ιαν;Φεβ;Μαρ;Απρ;Μαΐ;Ιουν;Ιουλ;Αυγ;Σεπ;Οκτ;Νοε;Δεκ"),dddd:E("Κυριακή;Δευτέρα;Τρίτη;Τετάρτη;Πέμπτη;Παρασκευή;Σάββατο")},-1,3),"el"),ne({decimal:",",ampm:E("de.;du."),mmmm:E("január;február;március;április;május;június;július;augusztus;szeptember;október;november;december"),mmm:E("jan.;febr.;márc.;ápr.;máj.;jún.;júl.;aug.;szept.;okt.;nov.;dec."),dddd:E("vasárnap;hétfő;kedd;szerda;csütörtök;péntek;szombat"),ddd:E("V;H;K;Sze;Cs;P;Szo"),bool:E("IGAZ;HAMIS")},"hu"),ne(Pe({group:".",decimal:",",ampm:E("f.h.;e.h."),mmmm:E("janúar;febrúar;mars;apríl;maí;júní;júlí;ágúst;september;október;nóvember;desember"),dddd:E("sunnu~;mánu~;þriðju~;miðviku~;fimmtu~;föstu~;laugar~","dagur")},13,13),"is"),ne(Pe({group:".",decimal:",",mmmm:E("Januari;Februari;Maret;April;Mei;Juni;Juli;Agustus;September;Oktober;November;Desember"),dddd:E("Minggu;Senin;Selasa;Rabu;Kamis;Jumat;Sabtu")},3,3),"id");const su=Pe({mmmm:E("gennaio;febbraio;marzo;aprile;maggio;giugno;luglio;agosto;settembre;ottobre;novembre;dicembre"),dddd:E("domenica;lunedì;martedì;mercoledì;giovedì;venerdì;sabato"),bool:E("VERO;FALSO")},3,3);ne({group:".",decimal:",",...su},"it"),ne({group:"'",decimal:".",...su},"it_CH");const iu={decimal:",",ampm:E("a.m.;p.m."),mmmm:E("januar;februar;mars;april;mai;juni;juli;august;september;oktober;november;desember"),mmm:E("jan.;feb.;mar.;apr.;mai;jun.;jul.;aug.;sep.;okt.;nov.;des."),dddd:E("søn~;man~;tirs~;ons~;tors~;fre~;lør~","dag"),bool:E("SANN;USANN")};ne(Pe({...iu},-1,13),"nb"),ne(Pe({...iu},-1,13),"no"),ne(Pe({decimal:",",mmmm:E("stycznia;lutego;marca;kwietnia;maja;czerwca;lipca;sierpnia;września;października;listopada;grudnia"),dddd:E("niedziela;poniedziałek;wtorek;środa;czwartek;piątek;sobota"),ddd:E("niedz.;pon.;wt.;śr.;czw.;pt.;sob."),bool:E("PRAWDA;FAŁSZ")},3,-1),"pl");const ou={group:".",decimal:",",mmmm:E("janeiro;fevereiro;março;abril;maio;junho;julho;agosto;setembro;outubro;novembro;dezembro"),dddd:E("domingo;segunda-feira;terça-feira;quarta-feira;quinta-feira;sexta-feira;sábado"),bool:E("VERDADEIRO;FALSO")};ne(Pe(ou,13,13),"pt"),ne(Pe(ou,13,13),"pt_BR"),ne({decimal:",",nan:"не число",mmmm:E("января;февраля;марта;апреля;мая;июня;июля;августа;сентября;октября;ноября;декабря"),mmm:E("янв.;февр.;мар.;апр.;мая;июн.;июл.;авг.;сент.;окт.;нояб.;дек."),dddd:E("воскресенье;понедельник;вторник;среда;четверг;пятница;суббота"),ddd:E("вс;пн;вт;ср;чт;пт;сб"),mmmm6:E("рамадан;шавваль;зуль-каада;зуль-хиджжа;мухаррам;раби-уль-авваль;раби-уль-ахир;джумад-уль-авваль;джумад-уль-ахир;раджаб;шаабан;рамадан"),mmm6:E("рам.;шав.;зуль-к.;зуль-х.;мух.;раб. I;раб. II;джум. I;джум. II;радж.;шааб.;рам."),bool:E("ИСТИНА;ЛОЖЬ")},"ru"),ne(Pe({decimal:",",mmmm:E("januára;februára;marca;apríla;mája;júna;júla;augusta;septembra;októbra;novembra;decembra"),dddd:E("nedeľa;pondelok;utorok;streda;štvrtok;piatok;sobota")},3,2),"sk");const Pt={group:".",decimal:",",ampm:E("a. m.;p. m."),mmmm:E("enero;febrero;marzo;abril;mayo;junio;julio;agosto;septiem~;octu~;noviem~;diciem~","bre"),mmm:E("ene;feb;mar;abr;may;jun;jul;ago;sept;oct;nov;dic"),dddd:E("domingo;lunes;martes;miércoles;jueves;viernes;sábado"),ddd:E("dom;lun;mar;mié;jue;vie;sáb"),bool:E("VERDADERO;FALSO")},OE=E("ene;feb;mar;abr;may;jun;jul;ago;sep;oct;nov;dic"),wo=E("ene.;feb.;mar.;abr.;may.;jun.;jul.;ago.;sept.;oct.;nov.;dic.");ne({...Pt},"es"),ne({...Pt},"es_AR"),ne({...Pt},"es_BO"),ne({...Pt},"es_CL"),ne({...Pt},"es_CO"),ne({...Pt},"es_EC"),ne({...Pt,mmm:OE,ampm:E("a.m.;p.m.")},"es_MX"),ne({...Pt,mmm:wo},"es_PY"),ne({...Pt,mmm:wo},"es_UY"),ne({...Pt,mmm:wo,mmmm:E("enero;febrero;marzo;abril;mayo;junio;julio;agosto;setiembre;octubre;noviembre;diciembre")},"es_VE"),ne({decimal:",",ampm:E("fm;em"),mmmm:E("januari;februari;mars;april;maj;juni;juli;augusti;september;oktober;november;december"),mmm:E("jan.;feb.;mars;apr.;maj;juni;juli;aug.;sep.;okt.;nov.;dec."),dddd:E("sön~;mån~;tis~;ons~;tors~;fre~;lör~","dag"),ddd:E("sön;mån;tis;ons;tors;fre;lör")},"sv"),ne(Pe({group:".",decimal:",",ampm:E("ÖÖ;ÖS"),mmmm:E("Ocak;Şubat;Mart;Nisan;Mayıs;Haziran;Temmuz;Ağustos;Eylül;Ekim;Kasım;Aralık"),mmm:E("Oca;Şub;Mar;Nis;May;Haz;Tem;Ağu;Eyl;Eki;Kas;Ara"),dddd:E("Pazar;Pazartesi;Salı;Çarşamba;Perşembe;Cuma;Cumartesi"),ddd:E("Paz;Pzt;Sal;Çar;Per;Cum;Cmt"),bool:E("DOĞRU;YANLIŞ")},3,-1),"tr"),ne({group:",",ampm:E("yb;yh"),mmmm:E("Ionawr;Chwefror;Mawrth;Ebrill;Mai;Mehefin;Gorffennaf;Awst;Medi;Hydref;Tachwedd;Rhagfyr"),mmm:E("Ion;Chwef;Maw;Ebr;Mai;Meh;Gorff;Awst;Medi;Hyd;Tach;Rhag"),dddd:E("Dydd Sul;Dydd Llun;Dydd Mawrth;Dydd Mercher;Dydd Iau;Dydd Gwener;Dydd Sadwrn"),ddd:E("Sul;Llun;Maw;Mer;Iau;Gwen;Sad")},"cy"),ne({group:".",decimal:",",mmmm:E("yanvar;fevral;mart;aprel;may;iyun;iyul;avqust;sentyabr;oktyabr;noyabr;dekabr"),mmm:E("yan;fev;mar;apr;may;iyn;iyl;avq;sen;okt;noy;dek"),dddd:E("bazar;bazar ertəsi;çərşənbə axşamı;çərşənbə;cümə axşamı;cümə;şənbə"),ddd:E("B.;B.e.;Ç.a.;Ç.;C.a.;C.;Ş.")},"az"),ne(Pe({decimal:",",mmmm:E("студзеня;лютага;сакавіка;красавіка;мая;чэрвеня;ліпеня;жніўня;верасня;кастрычніка;лістапада;снежня"),dddd:E("нядзеля;панядзелак;аўторак;серада;чацвер;пятніца;субота"),ddd:E("нд;пн;аў;ср;чц;пт;сб")},3,-1),"be"),ne({decimal:",",ampm:E("пр.об.;сл.об."),mmmm:E("януари;февруари;март;април;май;юни;юли;август;септември;октомври;ноември;декември"),mmm:E("яну;фев;март;апр;май;юни;юли;авг;сеп;окт;ное;дек"),dddd:E("неделя;понеделник;вторник;сряда;четвъртък;петък;събота"),ddd:E("нд;пн;вт;ср;чт;пт;сб"),bool:E("ИСТИНА;ЛОЖЬ")},"bg"),ne({group:".",decimal:",",mmmm:E("de gener;de febrer;de març;d’abril;de maig;de juny;de juliol;d’agost;de setembre;d’octubre;de novembre;de desembre"),mmm:E("de gen.;de febr.;de març;d’abr.;de maig;de juny;de jul.;d’ag.;de set.;d’oct.;de nov.;de des."),dddd:E("diumenge;dilluns;dimarts;dimecres;dijous;divendres;dissabte"),ddd:E("dg.;dl.;dt.;dc.;dj.;dv.;ds."),ampm:E("a. m.;p. m.")},"ca"),ne(Pe({group:",",decimal:".",mmmm:E("Enero;Pebrero;Marso;Abril;Mayo;Hunyo;Hulyo;Agosto;Setyembre;Oktubre;Nobyembre;Disyembre"),dddd:E("Linggo;Lunes;Martes;Miyerkules;Huwebes;Biyernes;Sabado")},3,3),"fil"),ne({group:",",decimal:".",mmmm:E("જાન્યુઆરી;ફેબ્રુઆરી;માર્ચ;એપ્રિલ;મે;જૂન;જુલાઈ;ઑગસ્ટ;સપ્ટેમ્બર;ઑક્ટોબર;નવેમ્બર;ડિસેમ્બર"),mmm:E("જાન્યુ;ફેબ્રુ;માર્ચ;એપ્રિલ;મે;જૂન;જુલાઈ;ઑગસ્ટ;સપ્ટે;ઑક્ટો;નવે;ડિસે"),dddd:E("રવિ~;સોમ~;મંગળ~;બુધ~;ગુરુ~;શુક્ર~;શનિ~","વાર"),ddd:E("રવિ;સોમ;મંગળ;બુધ;ગુરુ;શુક્ર;શનિ")},"gu"),ne({group:",",decimal:".",ampm:E("לפנה״צ;אחה״צ"),dddd:E("~ראשון;~שני;~שלישי;~רביעי;~חמישי;~שישי;~שבת","יום "),ddd:E("~א׳;~ב׳;~ג׳;~ד׳;~ה׳;~ו׳;שבת","יום "),mmmm:E("ינואר;פברואר;מרץ;אפריל;מאי;יוני;יולי;אוגוסט;ספטמבר;אוקטובר;נובמבר;דצמבר"),mmm:E("ינו׳;פבר׳;מרץ;אפר׳;מאי;יוני;יולי;אוג׳;ספט׳;אוק׳;נוב׳;דצמ׳"),mmmm6:E("רמדאן;שוואל;ד׳ו אל־קעדה;ד׳ו אל־חיג׳ה;מוחרם;רביע אל־אוול;רביע א־ת׳אני;ג׳ומאדא אל־אולא;ג׳ומאדא א־ת׳אניה;רג׳ב;שעבאן;רמדאן"),mmm6:E("רמדאן;שוואל;ד׳ו אל־קעדה;ד׳ו אל־חיג׳ה;מוחרם;רביע א׳;רביע ב׳;ג׳ומאדא א׳;ג׳ומאדא ב׳;רג׳ב;שעבאן;רמדאן")},"he"),ne(Pe({group:".",decimal:",",mmmm:E("siječnja;veljače;ožujka;travnja;svibnja;lipnja;srpnja;kolovoza;rujna;listopada;studenoga;prosinca"),mmm:E("sij;velj;ožu;tra;svi;lip;srp;kol;ruj;lis;stu;pro"),dddd:E("nedjelja;ponedjeljak;utorak;srijeda;četvrtak;petak;subota")},-1,3),"hr"),ne({decimal:",",mmmm:E("հունվարի;փետրվարի;մարտի;ապրիլի;մայիսի;հունիսի;հուլիսի;օգոստոսի;սեպտեմբերի;հոկտեմբերի;նոյեմբերի;դեկտեմբերի"),mmm:E("հնվ;փտվ;մրտ;ապր;մյս;հնս;հլս;օգս;սեպ;հոկ;նոյ;դեկ"),dddd:E("կիրակի;երկուշաբթի;երեքշաբթի;չորեքշաբթի;հինգշաբթի;ուրբաթ;շաբաթ"),ddd:E("կիր;երկ;երք;չրք;հնգ;ուր;շբթ")},"hy"),ne(Pe({decimal:",",mmmm:E("იანვარი;თებერვალი;მარტი;აპრილი;მაისი;ივნისი;ივლისი;აგვისტო;სექტემბერი;ოქტომბერი;ნოემბერი;დეკემბერი"),dddd:E("კვირა;ორშაბათი;სამშაბათი;ოთხშაბათი;ხუთშაბათი;პარასკევი;შაბათი")},3,3),"ka"),ne(Pe({decimal:",",mmmm:E("қаңтар;ақпан;наурыз;сәуір;мамыр;маусым;шілде;тамыз;қыркүйек;қазан;қараша;желтоқсан"),dddd:E("жексенбі;дүйсенбі;сейсенбі;сәрсенбі;бейсенбі;жұма;сенбі"),ddd:E("жс;дс;сс;ср;бс;жм;сб")},13,-1),"kk"),ne({group:",",mmmm:E("ಜನವರಿ;ಫೆಬ್ರವರಿ;ಮಾರ್ಚ್;ಏಪ್ರಿಲ್;ಮೇ;ಜೂನ್;ಜುಲೈ;ಆಗಸ್ಟ್;ಸೆಪ್ಟೆಂಬರ್;ಅಕ್ಟೋಬರ್;ನವೆಂಬರ್;ಡಿಸೆಂಬರ್"),mmm:E("ಜನವರಿ;ಫೆಬ್ರವರಿ;ಮಾರ್ಚ್;ಏಪ್ರಿ;ಮೇ;ಜೂನ್;ಜುಲೈ;ಆಗಸ್ಟ್;ಸೆಪ್ಟೆಂ;ಅಕ್ಟೋ;ನವೆಂ;ಡಿಸೆಂ"),dddd:E("ಭಾನು~;ಸೋಮ~;ಮಂಗಳ~;ಬುಧ~;ಗುರು~;ಶುಕ್ರ~;ಶನಿ~","ವಾರ"),ddd:E("ಭಾನು;ಸೋಮ;ಮಂಗಳ;ಬುಧ;ಗುರು;ಶುಕ್ರ;ಶನಿ"),ampm:E("ಪೂರ್ವಾಹ್ನ;ಅಪರಾಹ್ನ")},"kn"),ne({decimal:",",mmmm:E("sausio;vasario;kovo;balandžio;gegužės;birželio;liepos;rugpjūčio;rugsėjo;spalio;lapkričio;gruodžio"),mmm:E("saus.;vas.;kov.;bal.;geg.;birž.;liep.;rugp.;rugs.;spal.;lapkr.;gruod."),dddd:E("sekmadienis;pirmadienis;antradienis;trečiadienis;ketvirtadienis;penktadienis;šeštadienis"),ddd:E("sk;pr;an;tr;kt;pn;št"),ampm:E("priešpiet;popiet")},"lt"),ne({decimal:",",mmmm:E("janvāris;februāris;marts;aprīlis;maijs;jūnijs;jūlijs;augusts;septembris;oktobris;novembris;decembris"),mmm:E("janv.;febr.;marts;apr.;maijs;jūn.;jūl.;aug.;sept.;okt.;nov.;dec."),dddd:E("svētdiena;pirmdiena;otrdiena;trešdiena;ceturtdiena;piektdiena;sestdiena"),ddd:E("svētd.;pirmd.;otrd.;trešd.;ceturtd.;piektd.;sestd."),ampm:E("priekšpusdienā;pēcpusdienā")},"lv"),ne({group:",",decimal:".",mmmm:E("ജനുവരി;ഫെബ്രുവരി;മാർച്ച്;ഏപ്രിൽ;മേയ്;ജൂൺ;ജൂലൈ;ഓഗസ്റ്റ്;സെപ്റ്റംബർ;ഒക്‌ടോബർ;നവംബർ;ഡിസംബർ"),mmm:E("ജനു;ഫെബ്രു;മാർ;ഏപ്രി;മേയ്;ജൂൺ;ജൂലൈ;ഓഗ;സെപ്റ്റം;ഒക്ടോ;നവം;ഡിസം"),dddd:E("ഞായറാഴ്‌ച;തിങ്കളാഴ്‌ച;ചൊവ്വാഴ്ച;ബുധനാഴ്‌ച;വ്യാഴാഴ്‌ച;വെള്ളിയാഴ്‌ച;ശനിയാഴ്‌ച"),ddd:E("ഞായർ;തിങ്കൾ;ചൊവ്വ;ബുധൻ;വ്യാഴം;വെള്ളി;ശനി")},"ml"),ne({group:",",decimal:".",mmmm:E("нэгдүгээ~;хоёрдугаа~;гуравдугаа~;дөрөвдүгээ~;тавдугаа~;зургаадугаа~;долоодугаа~;наймдугаа~;есдүгээ~;аравдугаа~;арван нэгдүгээ~;арван хоёрдугаа~","р сар"),mmm:E("1~;2~;3~;4~;5~;6~;7~;8~;9~;10~;11~;12~","-р сар"),dddd:E("ням;даваа;мягмар;лхагва;пүрэв;баасан;бямба"),ddd:E("Ня;Да;Мя;Лх;Пү;Ба;Бя"),ampm:E("ү.ө.;ү.х.")},"mn"),ne({group:",",decimal:".",mmmm:E("जानेवारी;फेब्रुवारी;मार्च;एप्रिल;मे;जून;जुलै;ऑगस्ट;सप्टेंबर;ऑक्टोबर;नोव्हेंबर;डिसेंबर"),mmm:E("जाने;फेब्रु;मार्च;एप्रि;मे;जून;जुलै;ऑग;सप्टें;ऑक्टो;नोव्हें;डिसें"),dddd:E("रविवार;सोमवार;मंगळवार;बुधवार;गुरुवार;शुक्रवार;शनिवार"),ddd:E("रवि;सोम;मंगळ;बुध;गुरु;शुक्र;शनि")},"mr"),ne(Pe({group:",",decimal:".",mmmm:E("ဇန်နဝါရီ;ဖေဖော်ဝါရီ;မတ်;ဧပြီ;မေ;ဇွန်;ဇူလိုင်;ဩဂုတ်;စက်တင်ဘာ;အောက်တိုဘာ;နိုဝင်ဘာ;ဒီဇင်ဘာ"),mmm:E("ဇန်;ဖေ;မတ်;ဧ;မေ;ဇွန်;ဇူ;ဩ;စက်;အောက်;နို;ဒီ"),dddd:E("တနင်္ဂနွေ;တနင်္လာ;အင်္ဂါ;ဗုဒ္ဓဟူး;ကြာသပတေး;သောကြာ;စနေ"),ampm:E("နံနက်;ညနေ")},-1,0),"my"),ne({group:",",decimal:".",mmmm:E("ਜਨਵਰੀ;ਫ਼ਰਵਰੀ;ਮਾਰਚ;ਅਪ੍ਰੈਲ;ਮਈ;ਜੂਨ;ਜੁਲਾਈ;ਅਗਸਤ;ਸਤੰਬਰ;ਅਕਤੂਬਰ;ਨਵੰਬਰ;ਦਸੰਬਰ"),mmm:E("ਜਨ;ਫ਼ਰ;ਮਾਰਚ;ਅਪ੍ਰੈ;ਮਈ;ਜੂਨ;ਜੁਲਾ;ਅਗ;ਸਤੰ;ਅਕਤੂ;ਨਵੰ;ਦਸੰ"),dddd:E("ਐਤਵਾਰ;ਸੋਮਵਾਰ;ਮੰਗਲਵਾਰ;ਬੁੱਧਵਾਰ;ਵੀਰਵਾਰ;ਸ਼ੁੱਕਰਵਾਰ;ਸ਼ਨਿੱਚਰਵਾਰ"),ddd:E("ਐਤ;ਸੋਮ;ਮੰਗਲ;ਬੁੱਧ;ਵੀਰ;ਸ਼ੁੱਕਰ;ਸ਼ਨਿੱਚਰ"),ampm:E("ਪੂ.ਦੁ.;ਬਾ.ਦੁ.")},"pa"),ne({group:".",decimal:",",mmmm:E("ianuarie;februarie;martie;aprilie;mai;iunie;iulie;august;septem~;octom~;noiem~;decem~","brie"),mmm:E("ian.;feb.;mar.;apr.;mai;iun.;iul.;aug.;sept.;oct.;nov.;dec."),dddd:E("duminică;luni;marți;miercuri;joi;vineri;sâmbătă"),ddd:E("dum.;lun.;mar.;mie.;joi;vin.;sâm."),ampm:E("a.m.;p.m.")},"ro"),ne(Pe({group:".",decimal:",",mmmm:E("januar;februar;marec;april;maj;junij;julij;avgust;september;oktober;november;december"),mmm:E("jan.;feb.;mar.;apr.;maj;jun.;jul.;avg.;sep.;okt.;nov.;dec."),dddd:E("nedelja;ponedeljek;torek;sreda;četrtek;petek;sobota"),ampm:E("dop.;pop.")},-1,13),"sl"),ne(Pe({group:".",decimal:",",mmmm:E("јануар;фебруар;март;април;мај;јун;јул;август;септембар;октобар;новембар;децембар"),dddd:E("недеља;понедељак;уторак;среда;четвртак;петак;субота")},3,3),"sr"),ne({group:",",decimal:".",mmmm:E("ஜனவரி;பிப்ரவரி;மார்ச்;ஏப்ரல்;மே;ஜூன்;ஜூலை;ஆகஸ்ட்;செப்டம்பர்;அக்டோபர்;நவம்பர்;டிசம்பர்"),mmm:E("ஜன.;பிப்.;மார்.;ஏப்.;மே;ஜூன்;ஜூலை;ஆக.;செப்.;அக்.;நவ.;டிச."),dddd:E("ஞாயிறு;திங்கள்;செவ்வாய்;புதன்;வியாழன்;வெள்ளி;சனி"),ddd:E("ஞாயி.;திங்.;செவ்.;புத.;வியா.;வெள்.;சனி")},"ta"),ne({group:",",decimal:".",mmmm:E("జనవరి;ఫిబ్రవరి;మార్చి;ఏప్రిల్;మే;జూన్;జులై;ఆగస్టు;సెప్టెంబర్;అక్టోబర్;నవంబర్;డిసెంబర్"),mmm:E("జన;ఫిబ్ర;మార్చి;ఏప్రి;మే;జూన్;జులై;ఆగ;సెప్టెం;అక్టో;నవం;డిసెం"),dddd:E("ఆదివారం;సోమవారం;మంగళవారం;బుధవారం;గురువారం;శుక్రవారం;శనివారం"),ddd:E("ఆది;సోమ;మంగళ;బుధ;గురు;శుక్ర;శని")},"te"),ne({decimal:",",mmmm:E("січня;лютого;березня;квітня;травня;червня;липня;серпня;вересня;жовтня;листопада;грудня"),mmm:E("січ.;лют.;бер.;квіт.;трав.;черв.;лип.;серп.;вер.;жовт.;лист.;груд."),dddd:E("неділю;понеділок;вівторок;середу;четвер;пʼятницю;суботу"),ddd:E("нд;пн;вт;ср;чт;пт;сб"),ampm:E("дп;пп")},"uk"),ne({group:".",decimal:",",mmmm:E("~1;~2;~3;~4;~5;~6;~7;~8;~9;~10;~11;~12","tháng "),mmm:E("~1;~2;~3;~4;~5;~6;~7;~8;~9;~10;~11;~12","thg "),dddd:E("Chủ Nhật;Thứ Hai;Thứ Ba;Thứ Tư;Thứ Năm;Thứ Sáu;Thứ Bảy"),ddd:E("CN;Th 2;Th 3;Th 4;Th 5;Th 6;Th 7"),ampm:E("SA;CH")},"vi"),ne(Pe({group:"٬",decimal:"٫",ampm:E("ص;م"),mmmm:E("يناير;فبراير;مارس;أبريل;مايو;يونيو;يوليو;أغسطس;سبتمبر;أكتوبر;نوفمبر;ديسمبر"),dddd:E("الأحد;الاثنين;الثلاثاء;الأربعاء;الخميس;الجمعة;السبت"),mmmm6:E("رمضان;شوال;ذو القعدة;ذو الحجة;محرم;ربيع الأول;ربيع الآخرة;جمادى الأولى;جمادى الآخرة;رجب;شعبان;رمضان")},0,0),"ar"),ne({group:",",decimal:".",mmmm:E("জানুয়ারী;ফেব্রুয়ারী;মার্চ;এপ্রিল;মে;জুন;জুলাই;আগস্ট;সেপ্টেম্বর;অক্টোবর;নভেম্বর;ডিসেম্বর"),mmm:E("জানু;ফেব;মার্চ;এপ্রি;মে;জুন;জুল;আগ;সেপ্টেঃ;অক্টোঃ;নভেঃ;ডিসেঃ"),dddd:E("রবিবার;সোমবার;মঙ্গলবার;বুধবার;বৃহস্পতিবার;শুক্রবার;শনিবার"),ddd:E("রবি;সোম;মঙ্গল;বুধ;বৃহস্পতি;শুক্র;শনি")},"bn"),ne({group:",",decimal:".",mmmm:E("जनवरी;फ़रवरी;मार्च;अप्रैल;मई;जून;जुलाई;अगस्त;सितंबर;अक्तूबर;नवंबर;दिसंबर"),mmm:E("जन॰;फ़र॰;मार्च;अप्रैल;मई;जून;जुल॰;अग॰;सित॰;अक्तू॰;नव॰;दिस॰"),dddd:E("रविवार;सोमवार;मंगलवार;बुधवार;गुरुवार;शुक्रवार;शनिवार"),ddd:E("रवि;सोम;मंगल;बुध;गुरु;शुक्र;शनि"),ampm:E("am;pm")},"hi");const au={overflow:"######",dateErrorThrows:!1,dateErrorNumber:!0,bigintErrorNumber:!1,dateSpanLarge:!0,leap1900:!0,nbsp:!1,throws:!0,invalid:"######",locale:"",ignoreTimezone:!1,grouping:[3,3],indexColors:!0,skipChar:"",repeatChar:""};function Rt(e,t=0){if(typeof e!="number")return e;if(e<0)return-Rt(-e,t);if(t){const n=10**t||1;return Rt(e*n,0)/n}return Math.round(e)}const vE=1e-13;function lu(e,t=2,n=2){const r=e<0?-1:1,s=10**(t||2),i=10**(n||2);let o=Math.abs(e),a=0,l=0,c=0,u=1,h,d;if(e=o,e%1===0)d=[e*r,1];else if(e<1e-19)d=[r,1e19];else if(e>1e19)d=[1e19*r,1];else{do if(o=1/(o-Math.floor(o)),h=u,u=u*Math.floor(o)+a,a=h,l=c,c=Math.floor(e*u+.5),c>=s||u>=i)return[r*l,a];while(Math.abs(e-c/u)>=vE&&o!==Math.floor(o));d=[r*c,u]}return d}const ht=Math.floor;function cu(e,t=!0){if(t&&e>=0){if(e===0)return[1900,1,0];if(e===60)return[1900,2,29];if(e<60)return[1900,e<32?1:2,(e-1)%31+1]}let n=e+68569+2415019;const r=ht(4*n/146097);n=n-ht((146097*r+3)/4);const s=ht(4e3*(n+1)/1461001);n=n-ht(1461*s/4)+31;const i=ht(80*n/2447),o=n-ht(2447*i/80);n=ht(i/11);const a=i+2-12*n;return[100*(r-49)+s+n|0,a|0,o|0]}function wE(e){return cu(e+1462)}function bE(e){if(e===60)throw new Error("#VALUE!");if(e<=1)return[1317,8,29];if(e<60)return[1317,e<32?9:10,1+(e-2)%30];const t=10631/30,n=8.01/60;let r=e+466935;const s=ht(r/10631);r=r-10631*s;const i=ht((r-n)/t);r=r-ht(i*t+n);const o=ht((r+28.5001)/29.5);return o===13?[30*s+i,12,30]:[30*s+i,o,r-ht(29.5001*o-29)]}function uu(e,t=0,n=!0){const r=ht(e);return t===Un?bE(r):t===RE?wE(r):cu(r,n)}const ks=Math.floor,bo=86400;function Ao(e,t){let n=null;if(Array.isArray(e)){const[r,s,i,o,a,l]=e;n=Date.UTC(r,s==null?0:s-1,i!=null?i:1,o||0,a||0,l||0)}else if(e instanceof Date&&(n=e*1,!t||!t.ignoreTimezone)){const r=new Date;r.setUTCFullYear(e.getFullYear(),e.getMonth(),e.getDate()),r.setUTCHours(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()),n=r*1}if(n!=null&&isFinite(n)){const r=n/864e5;return r-(r<=-25509?-25568:-25569)}return null}function AE(e,t){let n=e|0;const r=bo*(e-n);let s=ks(r);r-s>.9999&&(s+=1,s===bo&&(s=0,n+=1));const i=s<0?bo+s:s,[o,a,l]=uu(e,0,t&&t.leap1900),c=ks(i/60/60)%60,u=ks(i/60)%60,h=ks(i)%60;return[o,a,l,c,u,h]}const TE=["!d-m-y","!d-m-Y","!j-m-y","!j-m-Y","!d-n-y","!d-n-Y","!j-n-y","!j-n-Y","?m-d-y","?m-d-Y","?m-j-y","?m-j-Y","?n-d-y","?n-d-Y","?n-j-y","?n-j-Y","d-M-y","d-M-Y","j-M-y","j-M-Y","M-d-y","M-d-Y","M-j-y","M-j-Y","d-F-y","d-F-Y","F-d-y","F-d-Y","F-j-y","F-j-Y","j-F-y","j-F-Y","y-F-d","y-F-j","y-M-d","y-M-j","Y-F-d","Y-F-j","Y-M-d","Y-m-d","Y-M-j","Y-m-j","Y-n-d","Y-n-j","j-F","j-M","d-F","d-M","n-d","n-j","n-Y","m-d","m-j","m-Y","M-Y","M-y","F-y","F-Y","Y-M","Y-n","Y-m","Y-F","Y-M"],yE={j:"d",d:"d",D:"ddd",l:"dddd",n:"m",m:"m",M:"mmm",F:"mmmm",y:"yy",Y:"yyyy"},NE={j:"dd",d:"dd",D:"ddd",l:"dddd",n:"mm",m:"mm",M:"mmm",F:"mmmm",y:"yy",Y:"yyyy"},hu={},du={};function dt(e,t,n=1){if(e){const r=e[0],s=e.slice(1);r==="!"?dt(s,t,4):r==="?"?dt(s,t,2):(t[r]=t[r]||{},dt(s,t[r],n))}else t.$=n}function fu(e,t){dt(e,t),dt(e+" x",t),dt(e+" l",t),dt(e+" l x",t),dt("l "+e,t),dt("l "+e+" x",t),dt(e+" D",t),dt(e+" D x",t),dt("D "+e,t),dt("D "+e+" x",t)}TE.forEach(e=>{e[0]!=="?"&&fu(e,hu),e[0]!=="!"&&fu(e,du)});const ME=new Date().getUTCFullYear(),mu=".",LE=",",To=" ",wr=" ",br=" ",Fs="'",xs="٬",DE={".":[LE,wr,br,Fs,xs],",":[mu,wr,br,Fs,xs],"٫":[mu,wr,br,Fs,xs]},yo=e=>e&&e.length===1&&e>="0"&&e<="9";function No(e,t={}){const n=Fn(t.locale||"")||en,r=n.decimal,s=[...DE[r]||[Fs,xs]];!s.includes(n.group)&&n.group!==To&&n.group!==r&&s.push(n.group);let i="",o="",a=1,l="",c=!1,u=!1,h=!1,d=!1,m=!1,_=null,p=!1,I=0;const A=[To,wr,br,"+","%","(","-"].concat(po);for(;A.includes(e[I]);){const b=e[I];if(b==="-"){if(c||u)return null;c=!0,a=-1}else if(Eo.test(b)){if(m)return null;m=!0,_=b}else if(b==="("){if(u||c)return null;u=!0,a=-1}else if(b==="%"){if(d)return null;d=!0}I++}let B=!1,x;if(e[I]===r||yo(e[I]))for(;I<e.length;){const b=e[I];if(!x&&s.includes(b))x=b;else if(!(x&&x===b))if(b===r){if(B)break;i+=".",B=!0}else if(yo(b))i+=b;else break;I++}if(e[I]==="e"||e[I]==="E"){o+=e[I],I++,(e[I]==="+"||e[I]==="-")&&(o+=e[I],I++);const b=I;for(;yo(e[I]);)o+=e[I],I++;if(b===I)return null}const Y=[To,wr,br,"%","$",")"].concat(po);for(;Y.includes(e[I]);){const b=e[I];if(Eo.test(b)){if(m)return null;m=!0,_=b,p=!0}else if(b===")"){if(h||!u)return null;h=!0}else if(b==="%"){if(d)return null;d=!0}I++}if(I!==e.length)return null;let O=parseFloat(i+o);if(!isFinite(O))return null;if(o){if(d||m)return null;l="0.00E+00"}else if(d){if(m)return null;l=i.includes(".")?"0.00%":"0%",O*=.01}else if(m){const b=i.includes(".")?"#,##0.00":"#,##0";p?l=b+_:l=_+b}else x&&(l=i.includes(".")?"#,##0.00":"#,##0");const R={v:O*a};return l&&(R.z=l),R}function UE(e,t,n){if(n<1||t<1||t>12)return!1;if(t===2){const s=e%4===0&&e%100!==0||e%400===0||e===1900?29:28;if(n>s)return!1}else if((t===4||t===6||t===9||t===11)&&n>30||(t===1||t===3||t===5||t===7||t===8||t===10||t===12)&&n>31)return!1;return!0}const gu=(e,t,n=!1)=>{for(const r of t)if(e.startsWith(r[0])){let s=r[0].length;return n&&(r[2]==="D"||r[2]==="M")&&e[s]==="."&&s++,[e.slice(0,s),r]}return["",null]},kt=(e,t,n,r)=>{const s=n.path||"",i=Object.keys(t);for(let o=0;o<i.length;o++){let a;const l=i[o];if(t[l]){if(l==="$"||l==="€")e||(a=n);else if(l==="-"){const c=/^(\s*([./-]|,\s)\s*|\s+)/.exec(e);if(c){const u=c[1]==="-"||c[1]==="/"||c[1]==="."?c[1]:" ";if(!n.sep||n.sep===u){const h=c[0].replace(/\s+/g," ");a=kt(e.slice(c[0].length),t[l],{...n,sep:u,path:s+h},r)}}}else if(l===" "){const c=/^[,.]?\s+/.exec(e);if(c){const u=c[0].replace(/\s+/g," ");a=kt(e.slice(c[0].length),t[l],{...n,path:s+u},r)}}else if(l==="j"||l==="d"){const c=/^(0?[1-9]|1\d|2\d|3[01])\b/.exec(e);c&&(a=kt(e.slice(c[0].length),t[l],{...n,day:c[0],path:s+l},r))}else if(l==="n"||l==="m"){const c=/^(0?[1-9]|1[012])\b/.exec(e);c&&(a=kt(e.slice(c[0].length),t[l],{...n,month:+c[0],_mon:c[0],path:s+l},r))}else if(l==="F"||l==="M"){const[c,u]=gu(e,r.mon,r.mp);u&&u[2]===l&&(a=kt(e.slice(c.length),t[l],{...n,month:u[1],_mon:c,path:s+l},r))}else if(l==="l"||l==="D"){const[c,u]=gu(e,r.day,r.dp);u&&u[2]===l&&(a=kt(e.slice(c.length),t[l],{...n,path:s+l},r))}else if(l==="y"){const c=/^\d\d\b/.exec(e);if(c){const u=+c[0]>=30?+c[0]+1900:+c[0]+2e3;a=kt(e.slice(c[0].length),t[l],{...n,year:u,path:s+l},r)}}else if(l==="Y"){const c=/^\d\d\d\d\b/.exec(e);c&&(a=kt(e.slice(c[0].length),t[l],{...n,year:+c[0],path:s+l},r))}else if(l==="x"){const c=$s(e,{locale:r.locale});c&&(a=kt("",t[l],{...n,time:c.v,tf:c.z,path:s+l},r))}else throw new Error(`Unknown date token "${l}"`);if(a&&UE(n.year||1916,n.month||1,n.day?+n.day:1))return a}}},_u=e=>e.replace(/\s+/g," ").trim().replace(/’/,"'").replace(/\.$/,"").toLowerCase(),Bs=(e,t)=>{const n=e.map((r,s)=>[_u(r),s+1,t]);return n.sort((r,s)=>s[0].length-r[0].length),n};function Mo(e,t={}){var i;const n=Fn(t.locale||"")||en,r={mon:Bs(n.mmmm,"F").concat(Bs(n.mmm,"M")),mp:n.mmm[0].at(-1)===".",day:Bs(n.dddd,"l").concat(Bs(n.ddd,"D")),dp:n.ddd[0].at(-1)===".",locale:t.locale},s=kt(_u(e),n.preferMDY?du:hu,{path:""},r);if(s){if(s.sep==="."&&s.path.length===3)return null;const o=+((i=s.year)!=null?i:ME);s.day||(s.day=1);let a=-1/0;if(o<1900)return null;o<=1900&&s.month<=2?a=25568:o<1e4&&(a=25569);const l=Date.UTC(o,s.month-1,s.day)/864e5+a+(s.time||0);if(l>=0&&l<=2958465){const c=s._mon[0]==="0"||s.day[0]==="0"||s._mon.length===2&&s.day.length===2,u=s.path.replace(/[jdlDnmMFyYx]/g,h=>h==="x"?s.tf||"":(c?NE[h]:yE[h])||h);return{v:l,z:u}}}return null}const Lo=e=>e.replace(/\s+/g,"").trim().replace(/\./g,"").toLowerCase();function $s(e,t={}){const n=Fn(t.locale||"")||en,r=/^\s*([10]?\d|2[0-4])(?::([0-5]\d|\d))?(?::([0-5]\d|\d))?(\.\d{1,10})?(?=\s*[^\s\d]|$)/.exec(e);let s="";if(r){const i=Lo(e.slice(r[0].length));if(i===Lo(n.ampm[0])||i==="a"||i==="am")s="a";else if(i===Lo(n.ampm[1])||i==="p"||i==="pm")s="p";else if(i)return null}if(r){const[,i,o,a,l]=r;if(l&&!a||!s&&!o&&!a)return null;let c=+(i||0)*1;if(s){if(c>=13)return null;s==="p"&&(c+=12)}const u=+(o||0)*1,h=+(a||0)*1,d=+(l||0)*1;return{v:(c*60*60+u*60+h+d)/(3600*24),z:(i.length===2?"hh":"h")+":mm"+(a?":ss":"")+(s?" AM/PM":"")}}return null}function pu(e,t={}){const n=Fn(t.locale||"")||en,r=e.trim().toLowerCase(),s=n.bool[0].toLowerCase();if(r==="true"||r===s)return{v:!0};const i=n.bool[1].toLowerCase();return r==="false"||r===i?{v:!1}:null}function PE(e,t){var n,r,s;return(s=(r=(n=No(e,t))!=null?n:Mo(e,t))!=null?r:$s(e,t))!=null?s:pu(e,t)}function Cn(e,t,n){return t[n+"_max"]=e.length,t[n+"_min"]=e.replace(/#/g,"").length,t}function Ge(e,t){typeof e=="string"?t.push({type:"string",value:e}):t.push(e)}function Eu(e,t){const n=e&&e.type;return n===Vi||n===Pn||n===zi||n===Us&&t==="den"}function Ar(e){var x,Y,O;const t=[],n={scale:1,percent:!1,text:!1,date:0,date_eval:!1,date_system:eu,sec_decimals:0,general:!1,clock:24,int_pattern:[],frac_pattern:[],man_pattern:[],den_pattern:[],num_pattern:[],tokens:t};let r="int",s=null;const i=[];let o,a=!1,l=-1,c=!1,u="",h=!1;for(;++l<e.length&&!c;){const R=e[l],b=R.type||vr;if(u+=R.raw,b===Gi)n.general=!0,Ge(R,t);else if(Eu(R,r)){const y=n[r+"_pattern"];Eu(o,r)||(o==null?void 0:o.type)===Or?(y.push((y.pop()||"")+R.value),s.num+=R.value):(y.push(R.value),s={type:r,num:R.value},Ge(s,t))}else if(b===_o)R.value==="("&&(n.parens=!0),Ge(R.value,t);else if(b===Us)Ge(R.value,t);else if(b===Ki)if(h=!0,n[r+"_pattern"].length){if(!s)throw new SyntaxError("Format pattern is missing a numerator");n.fractions=!0,n.num_pattern.push(n[r+"_pattern"].pop()),s.type="num",r="den",Ge({type:"div"},t)}else Ge(R.value,t);else if(b===Xi)Ge(",",t);else if(b===Ms)n.scale=.001**R.raw.length;else if(b===Or){if(r==="int"&&(n.grouping=!0),r==="den")throw new SyntaxError("Cannot group denominator digits")}else if(b===Qi)Ge(R,t);else if(b===qi){c=!0;break}else if(b===Ls)n.text=!0,Ge(R,t);else if(b===Zi||b===Ji)Ge(R,t);else if(b===ro){const y=R.value.toLowerCase(),$=y[0],H={type:"",size:0,date:1,pad:y.length};$==="h"?(H.size=Rr,H.type="hour-elap"):$==="m"?(H.size=Ir,H.type="min-elap"):(H.size=Sr,H.type="sec-elap"),n.date=n.date|H.size,i.push(H),Ge(H,t)}else if(n.date&&b===Ds&&((x=e[l+1])==null?void 0:x.type)===Pn){let y=1;l++;let $="0";((Y=e[l+1])==null?void 0:Y.type)===Pn&&($+="0",y=2,l++),((O=e[l+1])==null?void 0:O.type)===Pn&&($+="0",y=3,l++),u+=$;const H=[Sr,ji,Wi,Yi][y];n.date=n.date|H,n.date_eval=!0,n.sec_decimals=Math.max(n.sec_decimals,y),Ge({type:"subsec",size:H,decimals:y,date:1},t)}else if(b===to)a||(R.value==="B2"||R.value==="b2"?n.date_system=Un:n.date_system=eu);else if(b===no){const y={type:"",size:0,date:1},$=R.value.toLowerCase(),H=$[0];if($==="y"||$==="yy")y.size=Er,y.type="year-short";else if(H==="y"||H==="e")y.size=Er,y.type="year";else if($==="b"||$==="bb")y.size=Er,y.type="b-year-short";else if(H==="b")y.size=Er,y.type="b-year";else if($==="d"||$==="dd")y.size=Ns,y.type="day",y.pad=/dd/.test($);else if($==="ddd"||$==="aaa")y.size=Ns,y.type="weekday-short";else if(H==="d"||H==="a")y.size=Ns,y.type="weekday";else if(H==="h")y.size=Rr,y.type="hour",y.pad=/hh/i.test($);else if(H==="m"){$.length===3?(y.size=Cr,y.type="monthname-short"):$.length===5?(y.size=Cr,y.type="monthname-single"):$.length>=4&&(y.size=Cr,y.type="monthname");const g=i[i.length-1];!y.type&&g&&!g.used&&g.size&(Rr|Sr)&&(g.used=!0,y.size=Ir,y.type="min",y.pad=/mm/.test($)),y.type||(y.size=Cr,y.type="month",y.pad=/mm/.test($),y.indeterminate=!0)}else if(H==="s"){y.size=Sr,y.type="sec",y.pad=/ss/.test($);const g=i[i.length-1];g&&g.size&Ir?y.used=!0:g&&g.indeterminate&&(delete g.indeterminate,g.size=Ir,g.type="min",y.used=!0)}n.date=n.date|y.size,n.date_eval=!0,i.push(y),Ge(y,t)}else if(b===co)n.clock=12,n.date=n.date|Rr,n.date_eval=!0,R.short=R.value==="A/P",Ge(R,t);else if(b===ho||b===uo||b===Ps)Ge(R.value,t);else if(b===so)n.condition=[R.value[0],parseFloat(R.value[1])];else if(b===ao){const y=R.value.split("-"),$=y.length<2?"":y.slice(1).join("-"),H=y[0];H&&Ge(H,t);const g=Io($);g&&(n.locale=g);const P=parseInt($,16);isFinite(P)&&P&16711680&&(P>>16&255)===6&&(n.date_system=Un),a=!0}else if(b===lo){let y,$=R.value.toLowerCase();(y=/^color\s*(\d+)$/i.exec($))&&($=parseInt(y[1],10)),n.color=$}else if(b===eo)n.scale=100,n.percent=!0,Ge("%",t);else if(b===Ds)Ge(R,t),n.date||(n.dec_fractions=!0,r="frac");else if(b===mo)n.exponential=!0,n.exp_plus=R.value.includes("+"),r="man",Ge({type:"exp",plus:n.exp_plus},t);else if(b===fo)Ge(R,t);else if(b===go)Ge(R,t);else if(!(b===io||b===oo))throw b===vr?new SyntaxError(`Illegal character: ${u}`):new SyntaxError(`Unknown token ${b} in ${u}`);o=R}if(n.tokensUsed=l,n.pattern=u,/^((?:\[[^\]]+\])+)(;|$)/.test(n.pattern)&&!/^\[(?:h+|m+|s+)\]/.test(n.pattern)&&Ge({type:"text"},t),n.fractions&&n.dec_fractions||n.grouping&&!n.int_pattern.length||n.fractions&&n.exponential||n.fractions&&n.den_pattern.length*n.num_pattern.length===0||h&&!n.fractions&&!n.date||n.exponential&&(n.int_pattern.length||n.frac_pattern.length)*n.man_pattern.length===0)throw new SyntaxError(`Invalid pattern: ${u}`);const d=n.int_pattern.join(""),m=n.man_pattern.join(""),_=n.frac_pattern.join("");Cn(d,n,"int");let p=0;for(let R=0;R<d.length;R++){const b=d[d.length-1-R];/^[0-9?]/.test(b)&&(p=R+1)}n.int_min=p,Cn(_,n,"frac"),Cn(m,n,"man");let I=n.num_pattern.join(""),A=n.den_pattern[0]||"";if(A.includes("?")||I.includes("?")?(A=A.replace(/\d/g,"?"),A=A.replace(/#$/g,"?"),Cn(I,n,"num"),Cn(A,n,"den"),I=I.replace(/#$/g,"?")):(Cn(I,n,"num"),Cn(A,n,"den")),n.int_p=d,n.man_p=m,n.num_p=I,n.den_p=A,n.den_pattern.length&&(n.denominator=parseInt(n.den_pattern.join("").replace(/\D/g,""),10)),n.integer=!!d.length,!n.integer&&!n.exponential&&_.length){const R=n.tokens.findIndex(b=>b.type==="point");n.tokens.splice(R,0,{type:"int",value:"#"}),n.integer=!0,n.int_pattern=["#"],n.int_p="#"}if(n.fractions)for(let R=0;R<t.length-1;R++){const b=t[R];if(b.type!=="string"&&b.type!=="space")continue;const y=t[R+1].type;y==="num"?b.rule="num+int":y==="div"?b.rule="num":y==="den"&&(b.rule="den")}return n.grouping&&n.int_pattern.length>1&&(n.grouping=!1),n}function kE(e){if(e===0)return e;const t=Math.ceil(Math.log10(e<0?-e:e)),n=10**(16-Math.floor(t));return isFinite(n)?Math.round(e*n)/n:0}function Cu(e,t=0){const n=Math.floor(Math.log10(e));return t>1?Math.floor(n/t)*t:n}function Ru(e,t=1){return t<-300?parseFloat(e.toExponential().split("e")[0]):e*10**-t}const FE={total:1,sign:0,period:0,int:1,frac:0};function xE(e,t=!0){const n=Math.abs(e);if(!n)return FE;const r=t&&e<0?1:0,s=Math.floor(n),i=Math.floor(Math.log10(n)+1);let o=0,a=0;if(s!==n){o=1;const l=String(Rt(n*10**-i,15));let c=l.length,u=!0,h=0;for(;h<=l.length;){if(l[h]==="."){c--;break}else l[h]==="0"&&u?c--:u=!1;h++}a=c-i,a<0&&(a=0,o=0)}return{total:r+Math.max(i,1)+o+a,digits:Math.max(i,0)+a,sign:r,period:o,int:Math.max(i,1),frac:a}}const xn=(e,t)=>e.replace(/\./,t.decimal),Iu=(e,t,n)=>{const r=Math.abs(t);let s;return e===1?s=e:s=Rt(e,5),[xn(s+"",n),n.exponent,t<0?n.negative:n.positive,r<10?"0":"",r]};function Su(e,t,n,r){const s=n|0;if(typeof n=="string")e.push(n);else if(n===s)e.push(Math.abs(s));else{const i=Math.abs(n);let o=Cu(i),a=Ru(i,o);a===10&&(a=1,o++);const l=xE(i);if(o>=-4&&o<=-1){const c=i.toPrecision(10+o).replace(/\.?0+$/,"");e.push(xn(c,r))}else if(o===10){const c=i.toFixed(10).slice(0,12).replace(/\.$/,"");e.push(xn(c,r))}else if(Math.abs(o)<=9)if(l.total<=11){const c=Rt(i,9).toFixed(l.frac);e.push(xn(c,r))}else o===9?e.push(Math.floor(i)):o>=0&&o<9?e.push(xn(String(Rt(i,9-o)),r)):e.push(...Iu(a,o,r));else l.total>=12?e.push(...Iu(a,o,r)):e.push(xn(Rt(i,9).toFixed(l.frac),r))}return e}function Rn(e,t=!1){return e==="0"?"0":e==="?"?t?" ":" ":""}const Tr=86400,BE=(e,t,n)=>n?e<EE||t>=CE:e<_E||t>=pE;function Ou(e,t,n,r){var T,w;let s="",i="",o="",a="",l="",c="",u=0,h=0;if(typeof e=="bigint"){if(e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER)e=Number(e);else return n.bigintErrorNumber?String(e):n.overflow;h=e}else h=Math.trunc(e);let d=0,m=0,_=1,p=0,I=0,A=0,B=0,x=0,Y=0;const O=r||en;if(!t.text&&isFinite(t.scale)&&t.scale!==1&&(e=kE(e*t.scale)),t.exponential){let N=Math.abs(e);N&&(u=Cu(N,t.int_max)),e&&!t.integer&&u++,N=Ru(N,u),t.int_max===1&&Rt(N,t.frac_max)===10&&(N=1,u++),e=e<0?-N:N,s+=Math.abs(u)}if(t.integer){const N=Math.abs(Rt(e,t.fractions?1:t.frac_max));c+=N<1?"":Math.floor(N)}const R=(T=n.grouping[0])!=null?T:3,b=(w=n.grouping[1])!=null?w:R;t.dec_fractions&&(l=String(Rt(e,t.frac_max)).split(".")[1]||"");const y=!t.error&&(t.num_p.includes("0")||t.den_p.includes("0"));let $=y;if(t.fractions){$=y||!!(e%1);const N=Math.abs(t.integer?e%1:e);if(N)if($=!0,t.denominator&&isFinite(t.denominator))a+=t.denominator,o+=Rt(N*t.denominator),o==="0"&&(o="",a="",$=y);else{const L=lu(N,1/0,t.den_max);o+=L[0],a+=L[1],t.integer&&o==="0"&&(o="",a="",$=y)}else!e&&!t.integer&&($=!0,o="0",a="1");t.integer&&!$&&!Math.trunc(e)&&(c="0")}if(t.date){h=Math.trunc(e);const N=Tr*(e-h);if(d=Math.floor(N),Y=N-d,Math.abs(Y)<1e-6?Y=0:Y>.9999&&(Y=0,d+=1,d===Tr&&(d=0,h+=1)),Y){const L=t.date&Yi||t.date&Wi||t.date&ji;(L===Yi&&Y>.9995||L===Wi&&Y>.995||L===ji&&Y>.95||!L&&Y>=.5)&&(d++,Y=0)}if(h||t.date_system){const L=uu(e,t.date_system,n.leap1900);m=L[0],_=L[1],p=L[2]}if(d){const L=d<0?Tr+d:d;x=Math.floor(L)%60,B=Math.floor(L/60)%60,A=Math.floor(L/60/60)%60}if(I=(6+h)%7,t.date_eval&&BE(e,h+d/Tr,n.dateSpanLarge)){if(n.dateErrorThrows)throw new Error("Date out of bounds");if(n.dateErrorNumber){const L=e<0?[O.negative]:[];return Su(L,{},e,O).join("")}return n.overflow}}const H=Rn("?",n.nbsp);u<0?i="-":t.exp_plus&&(i="+");const g=[],P=(N,L,D,F)=>{const Q=!F&&N.length>L.length?D.length+N.length-L.length:D.length;N.length<L.length&&(F+=N.length-L.length);for(let z=0;z<Q;z++)g.push(N[z+F]||Rn(D[z],n.nbsp));return Q};let v=!1;const M={int:0,frac:0,man:0,num:0,den:0};for(let N=0,L=t.tokens.length;N<L;N++){const D=t.tokens[N],F=D.type,Q=D.num?D.num.length:0;if(F==="string")D.rule?D.rule==="num"?$?g.push(D.value.replace(/ /g,H)):(t.num_min>0||t.den_min>0)&&g.push(D.value.replace(/./g,H)):D.rule==="num+int"?$&&c?g.push(D.value.replace(/ /g,H)):t.den_min>0&&(c||t.num_min)&&g.push(D.value.replace(/./g,H)):D.rule==="den"&&($?g.push(D.value.replace(/ /g,H)):(t.den_min>0||t.den_min>0)&&g.push(D.value.replace(/./g,H))):g.push(D.value.replace(/ /g,H));else if(F==="space")D.rule==="num+int"?($||t.num_min||t.den_min)&&(c||t.num_min)&&g.push(H):g.push(H);else if(F==="error")g.push(n.invalid);else if(F==="point")g.push(t.date?D.value:O.decimal);else if(F==="general")Su(g,t,e,O);else if(F==="exp")g.push(O.exponent);else if(F==="minus")D.volatile&&t.date||D.volatile&&(e>=0||typeof e!="number")||(D.volatile&&!t.fractions&&(t.integer||t.dec_fractions)?(e<0&&c&&c!=="0"||l)&&g.push(O.negative):g.push(O.negative));else if(F==="plus")g.push(O.positive);else if(F==="text")g.push(e);else if(F==="fill")n.fillChar&&g.push(n.fillChar,D.value);else if(F==="skip")n.skipChar?g.push(n.skipChar,D.value):g.push(n.nbsp?" ":" ");else if(F==="div")$?g.push("/"):t.num_min>0||t.den_min>0?g.push(H):g.push(Rn("#",n.nbsp));else if(F==="int")if(t.int_pattern.length===1){const z=t.int_p,le=Math.max(t.int_min,c.length);let ue="";for(let S=le;S>0;S--){const U=c.charAt(c.length-S),G=U?"":z.charAt(z.length-S)||z[0];let V="";if(t.grouping){const j=S-1-R;j>=0&&!(j%b)&&(V=U||G==="0"?O.group:Rn("?",n.nbsp))}ue+=(U||Rn(G,n.nbsp))+V}g.push(ue)}else M.int+=P(c,t.int_p,D.num,M.int);else if(F==="frac"){const z=M.frac;for(let le=0;le<Q;le++)g.push(l[le+z]||Rn(D.num[le],n.nbsp));M.frac+=Q}else if(F==="man")!M[F]&&!M.man&&g.push(i),M.man+=P(s,t.man_p,D.num,M.man);else if(F==="num")M.num+=P(o,t.num_p,D.num,M.num);else if(F==="den"){const z=M.den;for(let le=0;le<Q;le++){let ue=a[le+z];if(!ue){const S=D.num[le];"123456789".includes(S)||v&&S==="0"?(v=!0,ue=n.nbsp?" ":" "):!v&&le===Q-1&&S==="0"&&!a?ue="1":ue=Rn(S,n.nbsp)}g.push(ue)}M.den+=Q}else if(F==="year")m<0&&g.push(O.negative),g.push(String(Math.abs(m)).padStart(4,"0"));else if(F==="year-short"){const z=m%100;g.push(z<10?"0":"",z)}else if(F==="month")g.push(D.pad&&_<10?"0":"",_);else if(F==="monthname-single")t.date_system===Un?g.push(O.mmmm6[_-1].charAt(0)):g.push(O.mmmm[_-1].charAt(0));else if(F==="monthname-short")t.date_system===Un?g.push(O.mmm6[_-1]):g.push(O.mmm[_-1]);else if(F==="monthname")t.date_system===Un?g.push(O.mmmm6[_-1]):g.push(O.mmmm[_-1]);else if(D.type==="weekday-short")g.push(O.ddd[I]);else if(F==="weekday")g.push(O.dddd[I]);else if(F==="day")g.push(D.pad&&p<10?"0":"",p);else if(F==="hour"){const z=A%t.clock||(t.clock<24?t.clock:0);g.push(D.pad&&z<10?"0":"",z)}else if(F==="min")g.push(D.pad&&B<10?"0":"",B);else if(F==="sec")g.push(D.pad&&x<10?"0":"",x);else if(F==="subsec"){g.push(O.decimal);const z=Y.toFixed(t.sec_decimals);g.push(z.slice(2,2+D.decimals))}else if(F==="ampm"){const z=A<12?0:1;D.short&&!r?g.push("AP"[z]):g.push(O.ampm[z])}else if(F==="hour-elap"){e<0&&g.push(O.negative);const z=h*24+Math.floor(Math.abs(d)/3600);g.push(String(Math.abs(z)).padStart(D.pad,"0"))}else if(F==="min-elap"){e<0&&g.push(O.negative);const z=h*1440+Math.floor(Math.abs(d)/60);g.push(String(Math.abs(z)).padStart(D.pad,"0"))}else if(F==="sec-elap"){e<0&&g.push(O.negative);const z=h*Tr+Math.abs(d);g.push(String(Math.abs(z)).padStart(D.pad,"0"))}else if(F==="b-year")g.push(m+543);else if(F==="b-year-short"){const z=(m+543)%100;g.push(z<10?"0":"",z)}}return g.join("")}const $E=Ar([{type:Ls,value:"@",raw:"@"}]);function vu(e,t){for(let n=0;n<3;n++){const r=t[n];if(r){let s;if(r.condition){const i=r.condition[0],o=r.condition[1];i==="="?s=e===o:i===">"?s=e>o:i==="<"?s=e<o:i===">="?s=e>=o:i==="<="?s=e<=o:i==="<>"&&(s=e!==o)}else s=!0;if(s)return r}}}function HE(e,t,n){const r=t.partitions;let s=r[3],i=null;return(typeof e=="number"||typeof e=="bigint")&&isFinite(e)&&(s=vu(e,r)),s&&s.color&&(i=s.color),i&&typeof i=="number"&&n.indexColors&&(i=IE[i-1]||"#000"),i}function jE(e,t,n){const r=t.partitions,s=Fn(t.locale||n.locale),i=r[3]?r[3]:$E;if(typeof e=="boolean"&&(e=(s||en).bool[e?0:1]),e==null)return"";const o=typeof e=="bigint";if(typeof e!="number"&&!o)return Ou(e,i,n,s);if(!o&&!isFinite(e)){const l=s||en;return isNaN(e)?l.nan:(e<0?l.negative:"")+l.infinity}const a=vu(e,r);return a?Ou(e,a,n,s):n.overflow}function wu(e){return!!(e[0]&&e[0].percent||e[1]&&e[1].percent||e[2]&&e[2].percent||e[3]&&e[3].percent)}function bu(e){return!!(e[0]&&e[0].date||e[1]&&e[1].date||e[2]&&e[2].date||e[3]&&e[3].date)}function Au(e){const[t,n,r,s]=e;return!!((!t||t.generated)&&(!n||n.generated)&&(!r||r.generated)&&s&&s.text&&!s.generated)}const WE={text:15,datetime:10.8,date:10.8,time:10.8,percent:10.6,currency:10.4,grouped:10.2,scientific:6,number:4,fraction:2,general:0,error:0},YE=[["DMY",1],["DM",2],["MY",3],["MDY",4],["MD",5],["hmsa",6],["hma",7],["hms",8],["hm",9]];function GE(e,t=null){var h;const[n,r]=e,s=n.frac_max,i={type:"general",isDate:bu(e),isText:Au(e),isPercent:wu(e),maxDecimals:n.general?9:s,scale:(h=n.scale)!=null?h:1,color:0,parentheses:0,grouped:n.grouping?1:0},o=!i.isDate&&!i.isText&&!n.error&&n.tokens.some(d=>d.type==="string"&&(t?d.value===t:Eo.test(d.value)));let a="G",l=s>=0?Math.min(15,s):"",c="",u="";if(r&&r.color&&(u="-",i.color=1),n.parens&&(c="()",i.parentheses=1),o)a="C",i.type="currency";else if(n.error)i.type="error",i.maxDecimals=0;else if(i.isDate){let d=0,m=0,_="";n.tokens.forEach(I=>{const A=I.type;/^(b-)?year/.test(A)?(_+="Y",m++):A.startsWith("month")?(_+="M",m++):/^(week)?day/.test(A)?(_+="D",m++):(A==="hour"||A==="min"||A==="sec"||A==="ampm")&&(_+=A[0],d++)}),i.type="date",m&&d?i.type="datetime":!m&&d&&(i.type="time");const p=YE.find(I=>_.startsWith(I[0]));a=p?"D":"G",l=p?p[1]:""}else i.isText?(a="G",i.type="text",l="",i.maxDecimals=0):n.general?(a="G",i.type="general",l=""):n.fractions?(a="G",i.type="fraction",l=""):n.exponential?(a="S",i.type="scientific"):i.isPercent?(a="P",i.type="percent"):n.grouping?(a=",",i.type="grouped"):(n.int_max||s)&&(a="F",i.type="number");return i.code=a+l+u+c,i.level=WE[i.type],Object.freeze(i)}function VE(e){const[t]=e;return{year:!!(t.date&Er),month:!!(t.date&Cr),day:!!(t.date&Ns),hours:!!(t.date&Rr),minutes:!!(t.date&Ir),seconds:!!(t.date&Sr),clockType:t.clock===12?12:24}}const zE=[[Gi,/^General/i,0],[Vi,/^#/,0],[Pn,/^0/,0],[zi,/^\?/,0],[Ki,/^\//,0],[qi,/^;/,0],[Ls,/^@/,0],[Zi,/^\+/,0],[Ji,/^-/,0],[Ds,/^\./,0],[Qi,/^ /,0],[eo,/^%/,0],[Us,/^[1-9]/,0],[to,/^(?:B[12])/i,0],[vr,/^B$/,0],[no,/^(?:[hH]+|[mM]+|[sS]+|[yY]+|[bB]+|[dD]+|[gG]+|[aA]{3,}|e+)/,0],[ro,/^(?:\[(h+|m+|s+)\])/i,1],[so,/^\[(<[=>]?|>=?|=)\s*(-?[.\d]+)\]/,[1,2]],[io,/^\[(DBNum[0-4]?\d)\]/i,1],[oo,/^\[(NatNum[0-4]?\d)\]/i,1],[ao,/^\[\$([^\]]+)\]/,1],[lo,/^\[(black|blue|cyan|green|magenta|red|white|yellow|color\s*\d+)\]/i,1],[tu,/^\[([^\]]+)\]/,1],[co,/^(?:AM\/PM|am\/pm|A\/P)/,0],[uo,/^\\(.)/,1],[ho,/^"([^"]*?)"/,1],[fo,/^_(\\.|.)/,1],[mo,/^[Ee]([+-])/,1],[go,/^\*(\\.|.)/,1],[_o,/^[()]/,0],[vr,/^[EÈÉÊËèéêëĒēĔĕĖėĘęĚěȄȅȆȇȨȩNnÑñŃńŅņŇňǸǹ["*/\\_]/,0],[Ps,/^./,0]],KE=63,XE=35,qE=48,ZE=57,Do=e=>{const t=(e||"\0").charCodeAt(0);return t===KE||t===XE||t>=qE&&t<=ZE};function Bn(e){let t=0;const n=[],r=[];for(;t<e.length;){const s=e.slice(t);let i=0;const o=/^(,+)(.)?/.exec(s);if(o){const a=o[1];i=a.length;const l=e[t-1]||"";let c=!1,u=!1;Do(l)?(c=!0,u=!0):l==="."&&(u=!0);const h=o[2]||"";if(c&&(!h||h===";")&&(c=!1),u&&Do(h)&&(u=!1),c&&!u)n.push({type:Or,value:",",raw:a});else if(!c&&u)n.push({type:Ms,value:",",raw:a});else if(c&&u){const d={type:Ms,value:",",raw:a};n.push(d),r.push(d)}else n.push({type:Xi,value:",",raw:a})}else{let a;for(const[l,c,u]of zE){const h=c.exec(s);if(h){const d=Array.isArray(u)?u.map(m=>h[m]):h[u||0];a={type:l,value:d,raw:h[0]},n.push(a),i=h[0].length;break}}r.length&&a.raw===";"&&(r.length=0),r.length&&Do(a.raw)&&(r.forEach(l=>l.type=Or),r.length=0)}if(!i){const a=s[0];i=1,n.push({type:Ps,value:a,raw:a})}t+=i}return n}const Uo=e=>{const t=e.condition;t&&t[1]<0&&(t[0]==="<"||t[0]==="<="||t[0]==="=")||e.tokens.unshift({type:"minus",volatile:!0})},Tu=(e,t=null)=>{const n={};for(const r in e)Array.isArray(e[r])?n[r]=[...e[r]]:n[r]=e[r];return t&&n.tokens.unshift(t),n.generated=!0,n};function JE(e){var h;const t=[];let n=!1,r,s=null,i=0,o=!1,a=0,l=0,c=Bn(e);do{if(o=Ar(c),(o.date||o.general)&&(o.int_pattern.length||o.frac_pattern.length||o.scale!==1||o.text))throw new Error("Illegal format");if(o.condition&&(l++,n=!0),o.text){if(s)throw new Error("Unexpected partition");s=o}o.locale&&(r=Io(o.locale)),t.push(o),i=((h=c[o.tokensUsed])==null?void 0:h.type)==="break"?1:0,c=c.slice(o.tokensUsed+i),a++}while(i&&a<4&&l<3);if(i)throw new Error("Unexpected partition");if(l>2)throw new Error("Unexpected condition");const u=t[3];if(u&&(u.int_pattern.length||u.frac_pattern.length||u.date))throw new Error("Unexpected partition");if(n){const d=t.length;if(d===1&&(t[1]=Ar(Bn("General")),t[1].generated=!0),d<3){const m=t[0],_=t[1];if(Uo(m),_.condition)Uo(_);else{const p=m.condition;(p[0]==="="||p[1]>=0&&(p[0]===">"||p[0]===">="))&&_.tokens.unshift({type:"minus",volatile:!0})}}else t.forEach(Uo)}else{if(t.length<4&&s)for(let d=0,m=t.length;d<m;d++)t[d]===s&&t.splice(d,1);if(t.length<1&&s&&(t[0]=Ar(Bn("General")),t[0].generated=!0),t.length<2){const d={type:"minus",volatile:!0};t.push(Tu(t[0],d))}if(t.length<3&&t.push(Tu(t[0])),t.length<4)if(s)t.push(s);else{const d=Ar(Bn("@"));d.generated=!0,t.push(d)}t[0].condition=[">",0],t[1].condition=["<",0],t[2].condition=null}return{pattern:e,partitions:t,locale:r}}const yu=Object.create({});function tn(e,t=!1){e||(e="General");let n=yu[e];if(!n)try{n=JE(e),yu[e]=n}catch(r){if(t)throw r;const s={tokens:[{type:"error"}],error:r.message};n={pattern:e,partitions:[s,s,s,s],error:r.message,locale:null}}return n}function Nu(e,t,n={}){var o;const r=Object.assign({},au,n),s=tn(e,r.throws),i=(o=Ao(t,r))!=null?o:t;return jE(i,s,r)}function QE(e,t,n){var o;const r=Object.assign({},au,n),s=tn(e,r.throws),i=(o=Ao(t,r))!=null?o:t;return HE(i,s,r)}function e0(e){const t=tn(e,!1);return bu(t.partitions)}function t0(e){const t=tn(e,!1);return wu(t.partitions)}function n0(e){const t=tn(e,!1);return Au(t.partitions)}function r0(e){try{return tn(e,!0),!0}catch{return!1}}function s0(e,t={}){const n=tn(e,!1);return n.info||(n.info=GE(n.partitions,t==null?void 0:t.currency)),n.info}function i0(e){const t=tn(e,!1);return t.dateInfo||(t.dateInfo=VE(t.partitions)),t.dateInfo}const $n=Object.freeze({AMPM:co,BREAK:qi,CALENDAR:to,CHAR:Ps,COLOR:lo,COMMA:Xi,CONDITION:so,DATETIME:no,DBNUM:io,DIGIT:Us,DURATION:ro,ERROR:vr,ESCAPED:uo,EXP:mo,FILL:go,GENERAL:Gi,GROUP:Or,HASH:Vi,LOCALE:ao,MINUS:Ji,MODIFIER:tu,NATNUM:oo,PAREN:_o,PERCENT:eo,PLUS:Zi,POINT:Ds,QMARK:zi,SCALE:Ms,SKIP:fo,SLASH:Ki,SPACE:Qi,STRING:ho,TEXT:Ls,ZERO:Pn}),o0=Object.freeze(Object.defineProperty({__proto__:null,addLocale:ne,dateFromSerial:AE,dateToSerial:Ao,dec2frac:lu,format:Nu,formatColor:QE,getFormatDateInfo:i0,getFormatInfo:s0,getLocale:Fn,isDateFormat:e0,isPercentFormat:t0,isTextFormat:n0,isValidFormat:r0,parseBool:pu,parseDate:Mo,parseLocale:Ro,parseNumber:No,parseTime:$s,parseValue:PE,round:Rt,tokenTypes:$n,tokenize:Bn},Symbol.toStringTag,{value:"Module"})),Mu="@@@",Lu="@",Du="General";function a0(e){return e===Mu||e===Lu}function l0(e){return e==null||e===Du}const c0=(e,t)=>{if(e&&!t||!e&&t)return!1;const n=i=>{const o=Bn(i);let a="",l=!1,c=!1;for(const u of o){if(u.type===$n.POINT){l=!0;continue}if(!(c&&u.type===$n.MINUS)&&u.type!==$n.SKIP){if(u.type===$n.COLOR){c=!0;continue}else c=!1;l&&u.type===$n.ZERO||(l=!1,l||(a+=u.value||""))}}return a},r=n(e),s=n(t);return r===s},u0=new Set(["m d"]),h0=new Set(["h:mm AM/PM","hh:mm AM/PM"]),d0=e=>{var s,i;const t=(i=(s=Mo(e))!=null?s:$s(e))!=null?i:No(e);if(!t)return null;const{v:n,z:r}=t;return r&&(u0.has(r)||h0.has(r)&&!/\s(A|AM|P|PM)$/i.test(e)||r.includes("#,##0")&&Nu(r,n)!==e)?null:t},f0={sheetId:"",range:{startRow:-1,endRow:-1,startColumn:-1,endColumn:-1}},m0={startRow:-1,startColumn:-1,endRow:-1,endColumn:-1},g0={startRow:0,startColumn:0,endRow:0,endColumn:0},_0={row:0,column:0},st={ff:"Arial",fs:11,it:ae.FALSE,bl:ae.FALSE,ul:{s:ae.FALSE},st:{s:ae.FALSE},ol:{s:ae.FALSE},tr:{a:0,v:ae.FALSE},td:cr.UNSPECIFIED,cl:{rgb:"#000000"},bg:{rgb:"#fff"},ht:vt.UNSPECIFIED,vt:fn.UNSPECIFIED,tb:mn.UNSPECIFIED,pd:{t:0,r:0,b:0,l:0},n:null,bd:{b:null,l:null,r:null,t:null}},Uu={id:"default_slide",title:"defaultSlide",pageSize:{width:300,height:300}},p0=[si,_a,ii],E0={[qe.HEADING_1]:{fs:20,bl:1},[qe.HEADING_2]:{fs:18,bl:1},[qe.HEADING_3]:{fs:16,bl:1},[qe.HEADING_4]:{fs:14,bl:1},[qe.HEADING_5]:{fs:12,bl:1},[qe.NORMAL_TEXT]:null,[qe.TITLE]:{fs:26,bl:1},[qe.SUBTITLE]:{fs:15,cl:{rgb:"#999999"}},[qe.NAMED_STYLE_TYPE_UNSPECIFIED]:null},Hn=4,C0={[qe.HEADING_1]:{spaceAbove:{v:20},spaceBelow:{v:6+Hn}},[qe.HEADING_2]:{spaceAbove:{v:18},spaceBelow:{v:6+Hn}},[qe.HEADING_3]:{spaceAbove:{v:16},spaceBelow:{v:6+Hn}},[qe.HEADING_4]:{spaceAbove:{v:14},spaceBelow:{v:4+Hn}},[qe.HEADING_5]:{spaceAbove:{v:12},spaceBelow:{v:4+Hn}},[qe.NORMAL_TEXT]:{spaceAbove:{v:0},spaceBelow:{v:0}},[qe.TITLE]:{spaceAbove:{v:0},spaceBelow:{v:3+Hn}},[qe.SUBTITLE]:{spaceAbove:{v:0},spaceBelow:{v:16}},[qe.NAMED_STYLE_TYPE_UNSPECIFIED]:null},R0="univer-sheets-chart-print-chart",I0="univer-docs-drawing-printing";var Pu=(e=>(e.ARRAY_CONVERTOR="ARRAY_CONVERTOR",e.MATRIX_CONVERTOR="MATRIX_CONVERTOR",e))(Pu||{});const S0={[ct.A3]:{width:1123,height:1587},[ct.A4]:{width:794,height:1124},[ct.A5]:{width:559,height:794},[ct.B4]:{width:944,height:1344},[ct.B5]:{width:665,height:944},[ct.Executive]:{width:696,height:1008},[ct.Folio]:{width:816,height:1248},[ct.Legal]:{width:816,height:1344},[ct.Letter]:{width:816,height:1056},[ct.Statement]:{width:528,height:816},[ct.Tabloid]:{width:1056,height:1632}};function Hs(e,t){const{textRuns:n=[]}=t;let r=0;for(const i of n){const{ts:o={},st:a,ed:l}=i;if(o[e]==null)return ae.FALSE;switch(e){case"bl":case"it":{if(o[e]===ae.FALSE)return ae.FALSE;break}case"ul":case"st":{if(o[e].s===ae.FALSE)return ae.FALSE;break}default:throw new Error(`unknown style key: ${e} in IStyleBase`)}r+=l-a}return t.dataStream.indexOf(`\r
`)===r?ae.TRUE:ae.FALSE}const Vr=class Vr{constructor(t,n,r){C(this,"_range");C(this,"_worksheet");this._deps=r,this._range=n,this._worksheet=t}static foreach(t,n){const{startRow:r,startColumn:s,endRow:i,endColumn:o}=t;for(let a=r;a<=i;a++)for(let l=s;l<=o;l++)n(a,l)}getRangeData(){return this._range}getValue(){return this.getValues()[0][0]}getValues(){const{startRow:t,endRow:n,startColumn:r,endColumn:s}=this._range,i=[];for(let o=t;o<=n;o++){const a=[];for(let l=r;l<=s;l++)a.push(this.getMatrix().getValue(o,l)||null);i.push(a)}return i}getMatrix(){const{startRow:t,endRow:n,startColumn:r,endColumn:s}=this._range,i=this._worksheet.getCellMatrix(),o=new ut;for(let a=t;a<=n;a++)for(let l=r;l<=s;l++)o.setValue(a,l,i.getValue(a,l)||null);return o}getMatrixObject(){const{startRow:t,endRow:n,startColumn:r,endColumn:s}=this._range,i=this._worksheet.getCellMatrix(),o=new ut;for(let a=t;a<=n;a++)for(let l=r;l<=s;l++)o.setValue(a-t,l-r,i.getValue(a,l)||{});return o}getA1Notation(){const{startRow:t,endRow:n,startColumn:r,endColumn:s}=this._range;let i,o;return r<s?(i=Z.numToWord(r+1)+(t+1),o=Z.numToWord(s+1)+(n+1)):(i=Z.numToWord(s+1)+(n+1),o=Z.numToWord(r+1)+(t+1)),i===o?`${i}`:`${i}:${o}`}getBackground(){return this.getBackgrounds()[0][0]}getBackgrounds(){const t=this._deps.getStyles();return this.getValues().map(n=>n.map(r=>{var i;const s=t.getStyleByCell(r);return((i=s==null?void 0:s.bg)==null?void 0:i.rgb)||st.bg.rgb}))}getCell(t,n){const{startRow:r,startColumn:s}=this._range,i={startRow:r+t,endRow:r+t,startColumn:s+n,endColumn:s+n};return new Vr(this._worksheet,i,this._deps)}getColumn(){return this._range.startColumn}getObjectValue(t={}){return this.getObjectValues(t)[0][0]}getObjectValues(t={}){var a;const{startRow:n,endRow:r,startColumn:s,endColumn:i}=this._range,o=this._worksheet.getCellMatrix().getFragment(n,r,s,i).getData();if(t.isIncludeStyle){const l=this._deps.getStyles();for(let c=0;c<=r-n;c++)for(let u=0;u<=i-s;u++){if(o==null||((a=o==null?void 0:o[c])==null?void 0:a[u])==null)continue;const h=o[c][u].s;h&&(o[c][u].s=l.get(h))}}return o}getFontColor(){return this.getFontColors()[0][0]}getFontColors(){const t=this._deps.getStyles();return this.getValues().map(n=>n.map(r=>{var i;const s=t.getStyleByCell(r);return((i=s==null?void 0:s.cl)==null?void 0:i.rgb)||st.cl.rgb}))}getFontFamilies(){return this._getStyles("ff")}getFontFamily(){return this.getFontFamilies()[0][0]}getUnderlines(){return this._getStyles("ul")}getUnderline(){var n,r;const{p:t}=(n=this.getValue())!=null?n:{};return t&&Array.isArray((r=t.body)==null?void 0:r.textRuns)&&t.body.textRuns.length>0?Hs("ul",t.body)===ae.TRUE?{s:ae.TRUE}:{s:ae.FALSE}:this.getUnderlines()[0][0]}getOverlines(){return this._getStyles("ol")}getOverline(){return this.getOverlines()[0][0]}getStrikeThrough(){var n,r;const{p:t}=(n=this.getValue())!=null?n:{};return t&&Array.isArray((r=t.body)==null?void 0:r.textRuns)&&t.body.textRuns.length>0?Hs("st",t.body)===ae.TRUE?{s:ae.TRUE}:{s:ae.FALSE}:this.getStrikeThroughs()[0][0]}getStrikeThroughs(){return this._getStyles("st")}getFontSize(){var n,r;const t=((n=this.getValue())==null?void 0:n.p)||{};return t&&Array.isArray((r=t.body)==null?void 0:r.textRuns)&&t.body.textRuns.length>0?t.body.textRuns.some(s=>{var i;return((i=s==null?void 0:s.ts)==null?void 0:i.fs)!=null})?Math.max(...t.body.textRuns.map(s=>{var i;return((i=s==null?void 0:s.ts)==null?void 0:i.fs)||0})):this.getFontSizes()[0][0]:this.getFontSizes()[0][0]}getFontSizes(){return this._getStyles("fs")}getBorder(){return this.getBorders()[0][0]}getBorders(){return this._getStyles("bd")}getFontStyle(){var n,r;const{p:t}=(n=this.getValue())!=null?n:{};return t&&Array.isArray((r=t.body)==null?void 0:r.textRuns)&&t.body.textRuns.length>0?Hs("it",t.body)===ae.TRUE?as.ITALIC:as.NORMAL:this._getFontStyles()[0][0]}_getFontStyles(){return this._getStyles("it")}getFontWeight(){var n,r;const{p:t}=(n=this.getValue())!=null?n:{};return t&&Array.isArray((r=t.body)==null?void 0:r.textRuns)&&t.body.textRuns.length>0?Hs("bl",t.body)===ae.TRUE?ls.BOLD:ls.NORMAL:this._getFontWeights()[0][0]}_getFontWeights(){return this._getStyles("bl")}getGridId(){return this._worksheet.getSheetId()}getHeight(){const{_range:t,_worksheet:n}=this,{startRow:r,endRow:s}=t;let i=0;for(let o=0;o<=s-r;o++){const a=n.getRowHeight(o);i+=a}return i}getHorizontalAlignment(){return this.getHorizontalAlignments()[0][0]}getHorizontalAlignments(){return this._getStyles("ht")}getLastColumn(){return this._range.endColumn}getLastRow(){return this._range.endRow}getNumColumns(){const{startColumn:t,endColumn:n}=this._range;return n-t+1}getNumRows(){const{startRow:t,endRow:n}=this._range;return n-t+1}getRichTextValue(){return this.getRichTextValues()[0][0]}getRichTextValues(){return this.getValues().map(t=>t.map(n=>(n==null?void 0:n.p)||""))}getRowIndex(){return this._range.startRow}getSheet(){return this._worksheet}getTextDirection(){return this.getTextDirections()[0][0]}getTextDirections(){return this._getStyles("td")}getTextRotation(){return this.getTextRotations()[0][0]}getTextRotations(){return this._getStyles("tr")}getTextStyle(){return this.getTextStyles()[0][0]}getTextStyles(){const t=this._deps.getStyles();return this.getValues().map(n=>n.map(r=>t.getStyleByCell(r)))}getVerticalAlignment(){return this.getVerticalAlignments()[0][0]}getVerticalAlignments(){return this._getStyles("vt")}getWidth(){const{_range:t,_worksheet:n}=this,{startColumn:r,endColumn:s}=t;let i=0;for(let o=0;o<=s-r;o++)i+=n.getColumnWidth(o);return i}getWrap(){return this.getWrapStrategy()===mn.WRAP?ae.TRUE:ae.FALSE}getWrapStrategies(){return this._getStyles("tb")}getWrapStrategy(){return this.getWrapStrategies()[0][0]}forEach(t){Vr.foreach(this._range,t)}_getStyles(t){const n=this._deps.getStyles();return this.getValues().map(r=>r.map(s=>{const i=n&&n.getStyleByCell(s);return i&&i[t]||st[t]}))}};C(Vr,"transformRange",(t,n)=>{const r=n.getMaxColumns()-1,s=n.getMaxRows()-1;return t.rangeType===pe.ALL?{startColumn:0,startRow:0,endColumn:r,endRow:s}:t.rangeType===pe.COLUMN?{startRow:0,endRow:s,startColumn:t.startColumn,endColumn:t.endColumn}:t.rangeType===pe.ROW?{startColumn:0,endColumn:r,startRow:t.startRow,endRow:t.endRow}:{startColumn:t.startColumn,endColumn:Math.min(t.endColumn,r),startRow:t.startRow,endRow:Math.min(t.endRow,s)}});let jn=Vr;function ku(e,t,n=0,r=e.length-1,s=O0){for(;r>n;){if(r-n>600){const l=r-n+1,c=t-n+1,u=Math.log(l),h=.5*Math.exp(2*u/3),d=.5*Math.sqrt(u*h*(l-h)/l)*(c-l/2<0?-1:1),m=Math.max(n,Math.floor(t-c*h/l+d)),_=Math.min(r,Math.floor(t+(l-c)*h/l+d));ku(e,t,m,_,s)}const i=e[t];let o=n,a=r;for(yr(e,n,t),s(e[r],i)>0&&yr(e,n,r);o<a;){for(yr(e,o,a),o++,a--;s(e[o],i)<0;)o++;for(;s(e[a],i)>0;)a--}s(e[n],i)===0?yr(e,n,a):(a++,yr(e,a,r)),a<=t&&(n=a+1),t<=a&&(r=a-1)}}function yr(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function O0(e,t){return e<t?-1:e>t?1:0}class js{constructor(t=9){this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(t){let n=this.data;const r=[];if(!Ys(t,n))return r;const s=this.toBBox,i=[];for(;n;){for(let o=0;o<n.children.length;o++){const a=n.children[o],l=n.leaf?s(a):a;Ys(t,l)&&(n.leaf?r.push(a):ko(t,l)?this._all(a,r):i.push(a))}n=i.pop()}return r}collides(t){let n=this.data;if(!Ys(t,n))return!1;const r=[];for(;n;){for(let s=0;s<n.children.length;s++){const i=n.children[s],o=n.leaf?this.toBBox(i):i;if(Ys(t,o)){if(n.leaf||ko(t,o))return!0;r.push(i)}}n=r.pop()}return!1}load(t){if(!(t&&t.length))return this;if(t.length<this._minEntries){for(let r=0;r<t.length;r++)this.insert(t[r]);return this}let n=this._build(t.slice(),0,t.length-1,0);if(!this.data.children.length)this.data=n;else if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){const r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}return this}insert(t){return t&&this._insert(t,this.data.height-1),this}clear(){return this.data=Yn([]),this}remove(t,n){if(!t)return this;let r=this.data;const s=this.toBBox(t),i=[],o=[];let a,l,c;for(;r||i.length;){if(r||(r=i.pop(),l=i[i.length-1],a=o.pop(),c=!0),r.leaf){const u=v0(t,r.children,n);if(u!==-1)return r.children.splice(u,1),i.push(r),this._condense(i),this}!c&&!r.leaf&&ko(r,s)?(i.push(r),o.push(a),a=0,l=r,r=r.children[0]):l?(a++,r=l.children[a],c=!1):r=null}return this}toBBox(t){return t}compareMinX(t,n){return t.minX-n.minX}compareMinY(t,n){return t.minY-n.minY}toJSON(){return this.data}fromJSON(t){return this.data=t,this}_all(t,n){const r=[];for(;t;)t.leaf?n.push(...t.children):r.push(...t.children),t=r.pop();return n}_build(t,n,r,s){const i=r-n+1;let o=this._maxEntries,a;if(i<=o)return a=Yn(t.slice(n,r+1)),Wn(a,this.toBBox),a;s||(s=Math.ceil(Math.log(i)/Math.log(o)),o=Math.ceil(i/Math.pow(o,s-1))),a=Yn([]),a.leaf=!1,a.height=s;const l=Math.ceil(i/o),c=l*Math.ceil(Math.sqrt(o));Fu(t,n,r,c,this.compareMinX);for(let u=n;u<=r;u+=c){const h=Math.min(u+c-1,r);Fu(t,u,h,l,this.compareMinY);for(let d=u;d<=h;d+=l){const m=Math.min(d+l-1,h);a.children.push(this._build(t,d,m,s-1))}}return Wn(a,this.toBBox),a}_chooseSubtree(t,n,r,s){for(;s.push(n),!(n.leaf||s.length-1===r);){let i=1/0,o=1/0,a;for(let l=0;l<n.children.length;l++){const c=n.children[l],u=Po(c),h=A0(t,c)-u;h<o?(o=h,i=u<i?u:i,a=c):h===o&&u<i&&(i=u,a=c)}n=a||n.children[0]}return n}_insert(t,n,r){const s=r?t:this.toBBox(t),i=[],o=this._chooseSubtree(s,this.data,n,i);for(o.children.push(t),Mr(o,s);n>=0&&i[n].children.length>this._maxEntries;)this._split(i,n),n--;this._adjustParentBBoxes(s,i,n)}_split(t,n){const r=t[n],s=r.children.length,i=this._minEntries;this._chooseSplitAxis(r,i,s);const o=this._chooseSplitIndex(r,i,s),a=Yn(r.children.splice(o,r.children.length-o));a.height=r.height,a.leaf=r.leaf,Wn(r,this.toBBox),Wn(a,this.toBBox),n?t[n-1].children.push(a):this._splitRoot(r,a)}_splitRoot(t,n){this.data=Yn([t,n]),this.data.height=t.height+1,this.data.leaf=!1,Wn(this.data,this.toBBox)}_chooseSplitIndex(t,n,r){let s,i=1/0,o=1/0;for(let a=n;a<=r-n;a++){const l=Nr(t,0,a,this.toBBox),c=Nr(t,a,r,this.toBBox),u=T0(l,c),h=Po(l)+Po(c);u<i?(i=u,s=a,o=h<o?h:o):u===i&&h<o&&(o=h,s=a)}return s||r-n}_chooseSplitAxis(t,n,r){const s=t.leaf?this.compareMinX:w0,i=t.leaf?this.compareMinY:b0,o=this._allDistMargin(t,n,r,s),a=this._allDistMargin(t,n,r,i);o<a&&t.children.sort(s)}_allDistMargin(t,n,r,s){t.children.sort(s);const i=this.toBBox,o=Nr(t,0,n,i),a=Nr(t,r-n,r,i);let l=Ws(o)+Ws(a);for(let c=n;c<r-n;c++){const u=t.children[c];Mr(o,t.leaf?i(u):u),l+=Ws(o)}for(let c=r-n-1;c>=n;c--){const u=t.children[c];Mr(a,t.leaf?i(u):u),l+=Ws(a)}return l}_adjustParentBBoxes(t,n,r){for(let s=r;s>=0;s--)Mr(n[s],t)}_condense(t){for(let n=t.length-1,r;n>=0;n--)t[n].children.length===0?n>0?(r=t[n-1].children,r.splice(r.indexOf(t[n]),1)):this.clear():Wn(t[n],this.toBBox)}}function v0(e,t,n){if(!n)return t.indexOf(e);for(let r=0;r<t.length;r++)if(n(e,t[r]))return r;return-1}function Wn(e,t){Nr(e,0,e.children.length,t,e)}function Nr(e,t,n,r,s){s||(s=Yn(null)),s.minX=1/0,s.minY=1/0,s.maxX=-1/0,s.maxY=-1/0;for(let i=t;i<n;i++){const o=e.children[i];Mr(s,e.leaf?r(o):o)}return s}function Mr(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function w0(e,t){return e.minX-t.minX}function b0(e,t){return e.minY-t.minY}function Po(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function Ws(e){return e.maxX-e.minX+(e.maxY-e.minY)}function A0(e,t){return(Math.max(t.maxX,e.maxX)-Math.min(t.minX,e.minX))*(Math.max(t.maxY,e.maxY)-Math.min(t.minY,e.minY))}function T0(e,t){const n=Math.max(e.minX,t.minX),r=Math.max(e.minY,t.minY),s=Math.min(e.maxX,t.maxX),i=Math.min(e.maxY,t.maxY);return Math.max(0,s-n)*Math.max(0,i-r)}function ko(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function Ys(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function Yn(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Fu(e,t,n,r,s){const i=[t,n];for(;i.length;){if(n=i.pop(),t=i.pop(),n-t<=r)continue;const o=t+Math.ceil((n-t)/r/2)*r;ku(e,o,t,n,s),i.push(t,o,o,n)}}function y0(e,t,n,r=!1){if(t===0&&n===0)return e;let s={...e};const i=s.startAbsoluteRefType||Ne.NONE,o=s.endAbsoluteRefType||Ne.NONE,a=s.rangeType||pe.NORMAL;if(!r&&i===Ne.ALL&&o===Ne.ALL)return s;const l=xu(s.startRow,n,s.startColumn,t,a),c=xu(s.endRow,n,s.endColumn,t,a);return r||i===Ne.NONE&&o===Ne.NONE?s={...s,startRow:l.row,startColumn:l.column,endRow:c.row,endColumn:c.column}:(i===Ne.NONE?s={...s,startRow:l.row,startColumn:l.column}:i===Ne.COLUMN?s={...s,startRow:l.row}:i===Ne.ROW&&(s={...s,startColumn:l.column}),o===Ne.NONE?s={...s,endRow:c.row,endColumn:c.column}:o===Ne.COLUMN?s={...s,endRow:c.row}:o===Ne.ROW&&(s={...s,endColumn:c.column}),s)}function xu(e,t,n,r,s){return s===pe.NORMAL?{row:e+t,column:n+r}:s===pe.ROW?{row:e+t,column:n}:s===pe.COLUMN?{row:e,column:n+r}:{row:e,column:n}}function Fo(e){const t=new Set,n=new Set;for(const o of e)t.add(o.startColumn),t.add(o.endColumn+1),n.add(o.startRow),n.add(o.endRow+1);const r=Array.from(t).sort((o,a)=>o-a),s=Array.from(n).sort((o,a)=>o-a);e.sort((o,a)=>o.startRow-a.startRow||o.startColumn-a.startColumn);const i=[];for(let o=0;o<s.length-1;o++)for(let a=0;a<r.length-1;a++){const l=r[a],c=r[a+1]-1,u=s[o],h=s[o+1]-1;for(const d of e){if(d.startRow>h)break;if(d.startRow<=u&&d.endRow>=h&&d.startColumn<=l&&d.endColumn>=c){i.push({startColumn:l,endColumn:c,startRow:u,endRow:h});break}}}return i}function N0(e){e.sort((r,s)=>r.startRow-s.startRow||r.startColumn-s.startColumn);const t={};for(const r of e)t[r.startRow]||(t[r.startRow]=[]),t[r.startRow].push(r);const n=[];for(const r in t){const s=t[+r];s.sort((o,a)=>o.startColumn-a.startColumn);let i=s[0];for(let o=1;o<s.length;o++){const a=s[o];a.startColumn<=i.endColumn+1&&a.startRow===i.startRow&&a.endRow===i.endRow?i.endColumn=Math.max(i.endColumn,a.endColumn):(n.push(i),i=a)}n.push(i)}return n}function M0(e){e.sort((r,s)=>r.startColumn-s.startColumn||r.startRow-s.startRow);const t={};for(const r of e)t[r.startColumn]||(t[r.startColumn]=[]),t[r.startColumn].push(r);const n=[];for(const r in t){const s=t[+r];s.sort((o,a)=>o.startRow-a.startRow);let i=s[0];for(let o=1;o<s.length;o++){const a=s[o];a.startRow<=i.endRow+1&&a.startColumn===i.startColumn&&a.endColumn===i.endColumn?i.endRow=Math.max(i.endRow,a.endRow):(n.push(i),i=a)}n.push(i)}return n}function L0(e){const t=Fo(e),n=N0(t);return M0(n)}function D0(e,t){const n=[];return e.forEach(r=>{n.push(...nn.subtract(r,t))}),nn.mergeRanges(n)}function Bu(e,t){const n=$u(e.startRow,e.endRow,t.startRow,t.endRow),r=$u(e.startColumn,e.endColumn,t.startColumn,t.endColumn);if(!n||!r)return null;const[s,i]=n,[o,a]=r,l=U0(e.rangeType,t.rangeType,s,i,o,a);return{startRow:s,endRow:i,startColumn:o,endColumn:a,rangeType:l}}function $u(e,t,n,r){const s=isNaN(e)?-1/0:e,i=isNaN(t)?1/0:t,o=isNaN(n)?-1/0:n,a=isNaN(r)?1/0:r,l=Math.max(s,o),c=Math.min(i,a);if(l<=c){const u=l===-1/0?Number.NaN:l,h=c===1/0?Number.NaN:c;return[u,h]}else return null}function U0(e,t,n,r,s,i){const o=e!==void 0?e:Hu(n,r,s,i),a=t!==void 0?t:Hu(n,r,s,i);return o===pe.ALL||a===pe.ALL?o===a?o:o===pe.ALL?a:o:o===a?o:(o===pe.NORMAL||a===pe.NORMAL,pe.NORMAL)}function Hu(e,t,n,r){const s=!isNaN(e)&&!isNaN(t),i=!isNaN(n)&&!isNaN(r);return s&&i?pe.NORMAL:s?pe.ROW:i?pe.COLUMN:pe.ALL}const Yt=class Yt{static clone(t){return t.rangeType!==void 0?{startRow:t.startRow,startColumn:t.startColumn,endRow:t.endRow,endColumn:t.endColumn,rangeType:t.rangeType}:{startRow:t.startRow,startColumn:t.startColumn,endRow:t.endRow,endColumn:t.endColumn}}static equals(t,n){return t==null||n==null?!1:t.endRow===n.endRow&&t.endColumn===n.endColumn&&t.startRow===n.startRow&&t.startColumn===n.startColumn&&(t.rangeType===n.rangeType||t.rangeType===void 0&&n.rangeType===pe.NORMAL||n.rangeType===void 0&&t.rangeType===pe.NORMAL)}static simpleRangesIntersect(t,n){const{startRow:r,endRow:s,startColumn:i,endColumn:o}=t,{startRow:a,endRow:l,startColumn:c,endColumn:u}=n,h=r<=l&&s>=a,d=i<=u&&o>=c;return h&&d}static intersects(t,n){if(t.rangeType===pe.ROW&&n.rangeType===pe.COLUMN||t.rangeType===pe.COLUMN&&n.rangeType===pe.ROW)return!0;if(t.rangeType===pe.ROW&&n.rangeType===pe.ROW)return t.startRow<=n.endRow&&t.endRow>=n.startRow;if(t.rangeType===pe.COLUMN&&n.rangeType===pe.COLUMN)return t.startColumn<=n.endColumn&&t.endColumn>=n.startColumn;const r=Math.floor(Number.MAX_SAFE_INTEGER/10),s=Number.isNaN(t.startRow)?0:t.startRow,i=Number.isNaN(t.endRow)?r:t.endRow,o=Number.isNaN(t.startColumn)?0:t.startColumn,a=Number.isNaN(t.endColumn)?r:t.endColumn,l=Number.isNaN(n.startRow)?0:n.startRow,c=Number.isNaN(n.endRow)?r:n.endRow,u=Number.isNaN(n.startColumn)?0:n.startColumn,h=Number.isNaN(n.endColumn)?r:n.endColumn,d=Math.abs(o+a-u-h),m=Math.abs(o-a)+Math.abs(u-h),_=Math.abs(s+i-l-c),p=Math.abs(s-i)+Math.abs(l-c);return d<=m&&_<=p}static doAnyRangesIntersect(t,n){const r=new js;return r.load(t.map(s=>({minX:s.startColumn,minY:s.startRow,maxX:s.endColumn,maxY:s.endRow}))),n.some(s=>r.search({minX:s.startColumn,minY:s.startRow,maxX:s.endColumn,maxY:s.endRow}).length>0)}static getIntersects(t,n){const r=t.startRow,s=t.endRow,i=t.startColumn,o=t.endColumn,a=n.startRow,l=n.endRow,c=n.startColumn,u=n.endColumn;let h,d,m,_;if(a<=s)a>=r?d=a:d=r;else return null;if(l>=r)l>=s?_=s:_=l;else return null;if(c<=o)c>i?h=c:h=i;else return null;if(u>=i)u>=o?m=o:m=u;else return null;return{startRow:d,endRow:_,startColumn:h,endColumn:m,rangeType:pe.NORMAL}}static contains(t,n){return t.startRow<=n.startRow&&t.endRow>=n.endRow&&t.startColumn<=n.startColumn&&t.endColumn>=n.endColumn}static realContain(t,n){return Yt.contains(t,n)&&(t.startRow<n.startRow||t.endRow>n.endRow||t.startColumn<n.startColumn||t.endColumn>n.endColumn)}static union(...t){return t.reduce((n,r)=>({startRow:Math.min(n.startRow,r.startRow),startColumn:Math.min(n.startColumn,r.startColumn),endRow:Math.max(n.endRow,r.endRow),endColumn:Math.max(n.endColumn,r.endColumn),rangeType:pe.NORMAL}),t[0])}static realUnion(...t){const n=t.some(i=>i.rangeType===pe.COLUMN),r=t.some(i=>i.rangeType===pe.ROW),s=Yt.union(...t);return{startColumn:r?Number.NaN:s.startColumn,endColumn:r?Number.NaN:s.endColumn,startRow:n?Number.NaN:s.startRow,endRow:n?Number.NaN:s.endRow,rangeType:r?pe.ROW:n?pe.COLUMN:pe.NORMAL}}static subtract(t,n){if(n.startRow>t.endRow||n.endRow<t.startRow||n.startColumn>t.endColumn||n.endColumn<t.startColumn)return[t];const r=[];n.startRow>=t.startRow&&r.push({startRow:t.startRow,startColumn:t.startColumn,endRow:n.startRow-1,endColumn:t.endColumn}),n.endRow<=t.endRow&&r.push({startRow:n.endRow+1,startColumn:t.startColumn,endRow:t.endRow,endColumn:t.endColumn});const s=Math.max(t.startRow,n.startRow),i=Math.min(t.endRow,n.endRow);return n.startColumn>=t.startColumn&&r.push({startRow:s,startColumn:t.startColumn,endRow:i,endColumn:n.startColumn-1}),n.endColumn<=t.endColumn&&r.push({startRow:s,startColumn:n.endColumn+1,endRow:i,endColumn:t.endColumn}),r.filter(a=>a.startRow<=a.endRow&&a.startColumn<=a.endColumn)}static mergeRanges(t){return L0(t)}static splitIntoGrid(t){return Fo(t)}static subtractMulti(t,n){if(!n.length)return t;let r=t;return n.forEach(s=>{r=D0(r,s)}),r}static hasIntersectionBetweenTwoRect(t,n){return!(t.left>n.right||t.right<n.left||t.top>n.bottom||t.bottom<n.top)}static getIntersectionBetweenTwoRect(t,n){const r=Math.max(t.left,n.left),s=Math.min(t.right,n.right),i=Math.max(t.top,n.top),o=Math.min(t.bottom,n.bottom);return s<=r||o<=i?null:{left:r,right:s,top:i,bottom:o,width:s-r,height:o-i}}static sort(t){return t.sort((n,r)=>n.startRow-r.startRow||n.startColumn-r.startColumn)}};C(Yt,"getRelativeRange",(t,n)=>({startRow:t.startRow-n.startRow,endRow:t.endRow-t.startRow,startColumn:t.startColumn-n.startColumn,endColumn:t.endColumn-t.startColumn})),C(Yt,"getPositionRange",(t,n,r)=>({...r||{},startRow:r&&[Ne.ROW,Ne.ALL].includes(r.startAbsoluteRefType||0)?r.startRow:t.startRow+n.startRow,endRow:r&&[Ne.ROW,Ne.ALL].includes(r.endAbsoluteRefType||0)?r.endRow:t.endRow+t.startRow+n.startRow,startColumn:r&&[Ne.COLUMN,Ne.ALL].includes(r.startAbsoluteRefType||0)?r.startColumn:t.startColumn+n.startColumn,endColumn:r&&[Ne.COLUMN,Ne.ALL].includes(r.endAbsoluteRefType||0)?r.endColumn:t.endColumn+t.startColumn+n.startColumn})),C(Yt,"moveHorizontal",(t,n=0,r=0)=>({...t,startColumn:t.startColumn+n,endColumn:t.endColumn+n+r})),C(Yt,"moveVertical",(t,n=0,r=0)=>({...t,startRow:t.startRow+n,endRow:t.endRow+n+r})),C(Yt,"moveOffset",(t,n,r)=>{const s={...t};switch(t.startAbsoluteRefType){case Ne.ROW:s.startColumn+=n;break;case Ne.COLUMN:s.startRow+=r;break;case Ne.ALL:break;case Ne.NONE:default:s.startRow+=r,s.startColumn+=n;break}switch(t.endAbsoluteRefType){case Ne.ROW:s.endColumn+=n;break;case Ne.COLUMN:s.endRow+=r;break;case Ne.ALL:break;case Ne.NONE:default:s.endRow+=r,s.endColumn+=n;break}return s});let nn=Yt;function P0(e,t){if(e.length===0||e[0].length===0)return null;const n=new Array(e[0].length).fill(0);let r=0,s=null;for(let i=0;i<e.length;i++){for(let a=0;a<e[0].length;a++)n[a]=t(e[i][a])?n[a]+1:0;const o=k0(n);o.area>r&&(r=o.area,s={startColumn:o.start,startRow:i-o.height+1,endColumn:o.end,endRow:i})}return s}function k0(e){const t=[];let n=0,r={area:0,height:0,start:0,end:0},s=0;for(;s<e.length;)if(t.length===0||e[s]>=e[t[t.length-1]])t.push(s++);else{const i=e[t.pop()],o=t.length===0?s:s-t[t.length-1]-1;i*o>n&&(n=i*o,r={area:n,height:i,start:t.length===0?0:t[t.length-1]+1,end:s-1})}for(;t.length>0;){const i=e[t.pop()],o=t.length===0?s:s-t[t.length-1]-1;i*o>n&&(n=i*o,r={area:n,height:i,start:t.length===0?0:t[t.length-1]+1,end:s-1})}return r}function F0(e,t){jn.foreach(t,(n,r)=>{e[n][r]=void 0})}function x0(e,t){const n=e.toFullArray(),r=[];for(;;){const s=P0(n,t);if(!s)break;r.push(s),F0(n,s)}return r}class B0{constructor(t,n){C(this,"_values",[]);C(this,"_keys",[]);C(this,"_keyMaps",new Map);this._values=t,this._keys=n,t.forEach(r=>{this._initKeyMap(r)})}_initKeyMap(t){this._keys.forEach(n=>{const r=t[n],s=this._keyMaps.get(n)||new Map;s.set(r,t),this._keyMaps.set(n,s)})}getValue(t,n){const r=n||this._keys;for(let s=0;s<r.length;s++){const i=this._keyMaps.get(r[s]);if(i!=null&&i.has(t))return i.get(t)}return null}hasValue(t){for(let n=0;n<this._keys.length;n++){const r=this._keyMaps.get(this._keys[n]);if(r!=null&&r.has(t))return!0}return!1}addValue(t){this._values.push(t),this._initKeyMap(t)}setValue(t,n,r){const s=this.getValue(t);s&&Object.keys(s).includes(n)&&(s[n]=r)}deleteValue(t,n){const r=this.getValue(t,n);if(r){this._keys.forEach(i=>{const o=this._keyMaps.get(i),a=r[i];o==null||o.delete(a)});const s=this._values.findIndex(i=>i===r);this._values.splice(s,1)}}getValues(){return this._values}getKeyMap(t){var n;return[...((n=this._keyMaps.get(t))==null?void 0:n.keys())||[]]}clear(){this._values=[],this._keys=[],this._keyMaps.clear()}}function xo(e,t,n,r){return{forEach(s){for(let i=e;i<=t;i++)for(let o=n;o<=r;o++)s(i,o)}}}function $0(e){if(e==null||e.length===0)return Number.NaN;const t=e.toLowerCase().split(""),n=t.length,r=o=>o.charCodeAt(0)-96;let s=0,i=0;for(let o=0;o<n;o++)i=r(t[o]),s+=i*26**(n-o-1);return s===0?Number.NaN:s-1}const Gs=65,ju=90,H0=97;function j0(e){const t=ju-Gs+1;let n="";for(;e>=0;)n=String.fromCharCode(e%t+Gs)+n,e=Math.floor(e/t)-1;return n}function Wu(e,t){let n="";for(;t>0;)n+=e,t--;return n}function W0(e,t=!1){const n=ju-Gs+1;let r=H0;t&&(r=Gs);const s=String.fromCharCode(e%n+r),i=Math.floor(e/n)+1;return Wu(s,i)}function Y0(e,t){return e.zIndex>t.zIndex?1:e.zIndex===t.zIndex?0:-1}function G0(e,t){return e.zIndex>t.zIndex?-1:e.zIndex===t.zIndex?0:1}function Lr(e="index",t=1){return(n,r)=>n[e]>r[e]?t:n[e]===r[e]?0:-t}function Dr(e,t=!1){const n=[];for(const r of e){const{st:s,ed:i,ts:o}=r;if(r.sId===void 0&&delete r.sId,s===i||!t&&Z.isEmptyObject(o)&&r.sId==null)continue;if(n.length===0){n.push(r);continue}const a=n.pop();$c(r,a)&&Z.hasIntersectionBetweenTwoRanges(a.st,a.ed,r.st,r.ed)?n.push({...r,st:a.st,ed:i}):n.push(a,r)}return n}function Yu(e,t,n,r){var c;const{textRuns:s}=e;if(s==null)return;const i=[],o=s.length;let a=!1;const l=(c=t.textRuns)!=null?c:[];if(l.length)for(const u of l)u.st+=r,u.ed+=r;for(let u=0;u<o;u++){const h=s[u],{st:d,ed:m}=h;if(m<=r)i.push(h);else if(r>d&&r<m){a=!0;const _={...h,ed:r};i.push(_),l.length&&i.push(...l);const p={...h,st:r+n,ed:m+n};i.push(p)}else h.st+=n,h.ed+=n,a||(a=!0,i.push(...l)),i.push(h)}a||(a=!0,i.push(...l)),e.textRuns=Dr(i)}function Gu(e,t,n,r){const{paragraphs:s}=e;if(s==null)return;const{paragraphs:i}=t,o=[];for(let l=0,c=s.length;l<c;l++){const u=s[l],{startIndex:h}=u;h>=r&&(u.startIndex+=n),o.push(u.startIndex)}let a=-1;if(i){for(let l=0,c=i.length;l<c;l++){const u=i[l];u.startIndex+=r;const h=u.startIndex;a=o.indexOf(h)}a!==-1&&s.splice(a,1),s.push(...i),s.sort(Lr("startIndex"))}}function Vu(e,t,n,r){const{sectionBreaks:s}=e;if(s==null)return;for(let o=0,a=s.length;o<a;o++){const l=s[o],{startIndex:c}=l;c>=r&&(l.startIndex+=n)}const i=t.sectionBreaks;if(i){for(let o=0,a=i.length;o<a;o++){const l=i[o];l.startIndex+=r}s.push(...i),s.sort(Lr("startIndex"))}}function zu(e,t,n,r){const{customBlocks:s=[]}=e;for(let o=0,a=s.length;o<a;o++){const l=s[o],{startIndex:c}=l;c>=r&&(l.startIndex+=n)}const i=t.customBlocks;if(i){for(let o=0,a=i.length;o<a;o++){const l=i[o];l.startIndex+=r}s.push(...i),s.sort(Lr("startIndex"))}s.length&&!e.customBlocks&&(e.customBlocks=s)}function Ku(e,t,n,r){const{tables:s}=e;if(s==null)return;for(let o=0,a=s.length;o<a;o++){const l=s[o],{startIndex:c,endIndex:u}=l;c>r?(l.startIndex+=n,l.endIndex+=n):u>r&&(l.endIndex+=n)}const i=t.tables;if(i){for(let o=0,a=i.length;o<a;o++){const l=i[o];l.startIndex+=r,l.endIndex+=r}s.push(...i),s.sort(Lr("startIndex"))}}const Xu="$",qu=e=>e.split(Xu)[0];function Bo(e){if(e.length<=1)return e;e.sort((s,i)=>s.startIndex-i.startIndex);const t=[];let n={...e[0]};n.rangeId=qu(n.rangeId);for(let s=1;s<e.length;s++){const i=e[s];i.rangeId=qu(i.rangeId),i.rangeId===n.rangeId&&Sa(n.properties,i.properties)&&n.endIndex+1>=i.startIndex?n.endIndex=i.endIndex:(t.push(n),n={...i})}t.push(n);const r=Object.create(null);for(let s=0,i=t.length;s<i;s++){const o=t[s],a=o.rangeId;r[a]?(o.rangeId=`${a}${Xu}${r[a]}`,r[a]=r[a]+1):r[a]=1}return t}function $o(e,t){const n=e.findIndex(s=>s.startIndex<t&&s.endIndex>=t),r=e[n];r&&e.splice(n,1,{rangeId:r.rangeId,rangeType:r.rangeType,startIndex:r.startIndex,endIndex:t-1,properties:{...r.properties}},{rangeId:r.rangeId,rangeType:r.rangeType,startIndex:t,endIndex:r.endIndex,properties:{...r.properties}})}function Zu(e){if(e.length<=1)return e;e.sort((r,s)=>r.startIndex-s.startIndex);const t=[];let n={...e[0]};for(let r=1;r<e.length;r++){const s=e[r];s.id===n.id&&n.endIndex+1>=s.startIndex?n.endIndex=s.endIndex:(t.push(n),n={...s})}return t.push(n),t}function Ho(e,t){e.filter(r=>r.startIndex<t&&r.endIndex>=t).forEach(r=>{const s=e.indexOf(r);e.splice(s,1,{id:r.id,type:r.type,startIndex:r.startIndex,endIndex:t-1},{id:r.id,type:r.type,startIndex:t,endIndex:r.endIndex})})}function V0(e,t,n,r){e.customRanges||(e.customRanges=[]);const{customRanges:s}=e;$o(s,r);for(let o=0,a=s.length;o<a;o++){const l=s[o],{startIndex:c}=l;c>=r&&(l.startIndex+=n,l.endIndex+=n)}const i=[];if(t.customRanges){for(let o=0,a=t.customRanges.length;o<a;o++){const l=t.customRanges[o];l.startIndex+=r,l.endIndex+=r,i.push(l)}s.push(...i)}e.customRanges=Bo(s)}function z0(e,t,n,r){e.customDecorations||(e.customDecorations=[]);const{customDecorations:s}=e;Ho(s,r);for(let o=0,a=s.length;o<a;o++){const l=s[o],{startIndex:c}=l;c>=r&&(l.startIndex+=n,l.endIndex+=n)}const i=[];if(t.customDecorations){for(let o=0,a=t.customDecorations.length;o<a;o++){const l=t.customDecorations[o];l.startIndex+=r,l.endIndex+=r,i.push(l)}s.push(...i)}e.customDecorations=Zu(s)}function Ju(e,t,n){const{textRuns:r}=e,s=n,i=n+t,o=[];if(r){const a=[];for(let l=0,c=r.length;l<c;l++){const u=r[l],{st:h,ed:d}=u;if(s<=h&&i>=d){o.push({...u,st:h-s,ed:d-s});continue}else h<=s&&d>=i?(o.push({...u,st:s-s,ed:i-s}),u.ed-=t):s>=h&&s<d?(o.push({...u,st:s-s,ed:d-s}),u.ed=s):i>h&&i<=d?(o.push({...u,st:h-s,ed:i-s}),u.st=i-t,u.ed-=t):h>=i&&(u.st-=t,u.ed-=t);a.push(u)}e.textRuns=a}return o.length===0&&o.push({st:0,ed:t,ts:{}}),o}function Qu(e,t,n){const{paragraphs:r}=e,s=n,i=n+t,o=[];if(r){const a=[];for(let l=0,c=r.length;l<c;l++){const u=r[l],{startIndex:h}=u;if(h>=s&&h<i){o.push({...u,startIndex:h-n});continue}else h>=i&&(u.startIndex-=t);a.push(u)}e.paragraphs=a}return o}function eh(e,t,n){const{sectionBreaks:r}=e,s=n,i=n+t-1,o=[];if(r){const a=[];for(let l=0,c=r.length;l<c;l++){const u=r[l],{startIndex:h}=u;if(h>=s&&h<=i){o.push({...u,startIndex:h-n});continue}else h>i&&(u.startIndex-=t);a.push(u)}e.sectionBreaks=a}return o}function th(e,t,n){const{customBlocks:r=[]}=e,s=n,i=n+t-1,o=[];if(r){const a=[];for(let l=0,c=r.length;l<c;l++){const u=r[l],{startIndex:h}=u;if(h>=s&&h<=i){o.push({...u,startIndex:h-n});continue}else h>i&&(u.startIndex-=t);a.push(u)}e.customBlocks=a}return r.length&&!e.customBlocks&&(e.customBlocks=r),o}function nh(e,t,n){const{tables:r}=e,s=n,i=n+t-1,o=[];if(r){const a=[];for(let l=0,c=r.length;l<c;l++){const u=r[l],{startIndex:h,endIndex:d}=u;if(s<=h&&i>=d){o.push({...u,startIndex:h-n,endIndex:d-n});continue}else if(h<=s&&d>=i){const m=ys(h,d,s,i);if(m.length===0||(u.startIndex=m[0],u.endIndex=m[1],u.startIndex===u.endIndex))continue}else i<h&&(u.startIndex-=t,u.endIndex-=t);a.push(u)}e.tables=a}return o}function K0(e,t,n){const{customRanges:r}=e,s=n,i=n+t-1,o=[];if(r){const a=[];for(let l=0,c=r.length;l<c;l++){const u=r[l],{startIndex:h,endIndex:d}=u;if(h>=s&&d<=i){o.push(u);continue}else if(Math.max(s,h)<=Math.min(i,d)){const m=ys(h,d,s,i);if(m.length===0)continue;u.startIndex=m[0],u.endIndex=m[1]}else i<h&&(u.startIndex-=t,u.endIndex-=t);a.push(u)}e.customRanges=Bo(a)}return o}function X0(e,t,n,r=!0){const{customDecorations:s}=e,i=n,o=n+t-1,a=[];if(s){const l=[];for(let c=0,u=s.length;c<u;c++){const h=s[c],{startIndex:d,endIndex:m}=h;if(d>=i&&m<=o){a.push(h);continue}else if(Math.max(i,d)<=Math.min(o,m)){const _=ys(d,m,i,o);if(_.length===0)continue;h.startIndex=_[0],h.endIndex=_[1]}else o<d&&r&&(h.startIndex-=t,h.endIndex-=t);l.push(h)}e.customDecorations=l}return a}var rh=(e=>(e.ORDER_LIST_QUICK_1="1.",e.ORDER_LIST_QUICK_2="a)",e.ORDER_LIST_QUICK_3="a.",e.ORDER_LIST_QUICK_4="i.",e.ORDER_LIST_QUICK_5="A.",e.ORDER_LIST_QUICK_6="I.",e.ORDER_LIST_QUICK_7="01.",e.BULLET_LIST="*",e))(rh||{}),Ft=(e=>(e.BULLET_LIST="BULLET_LIST",e.BULLET_LIST_1="BULLET_LIST_1",e.BULLET_LIST_2="BULLET_LIST_2",e.BULLET_LIST_3="BULLET_LIST_3",e.BULLET_LIST_4="BULLET_LIST_4",e.BULLET_LIST_5="BULLET_LIST_5",e.ORDER_LIST="ORDER_LIST",e.ORDER_LIST_1="ORDER_LIST_1",e.ORDER_LIST_2="ORDER_LIST_2",e.ORDER_LIST_3="ORDER_LIST_3",e.ORDER_LIST_4="ORDER_LIST_4",e.ORDER_LIST_5="ORDER_LIST_5",e.ORDER_LIST_QUICK_2="ORDER_LIST_QUICK_2",e.ORDER_LIST_QUICK_3="ORDER_LIST_QUICK_3",e.ORDER_LIST_QUICK_4="ORDER_LIST_QUICK_4",e.ORDER_LIST_QUICK_5="ORDER_LIST_QUICK_5",e.ORDER_LIST_QUICK_6="ORDER_LIST_QUICK_6",e.CHECK_LIST="CHECK_LIST",e.CHECK_LIST_CHECKED="CHECK_LIST_CHECKED",e))(Ft||{});const Vs={"a)":{glyphFormat:"%1)",glyphType:fe.DECIMAL},"1.":{glyphType:fe.DECIMAL},"a.":{glyphFormat:"%1.",glyphType:fe.LOWER_LETTER},"A.":{glyphType:fe.UPPER_LETTER},"i.":{glyphFormat:"%1.",glyphType:fe.LOWER_ROMAN},"I.":{glyphFormat:"%1.",glyphType:fe.UPPER_LETTER}},Gn=e=>[...e,...e,...e].map((t,n)=>({glyphFormat:` %${n+1}`,glyphSymbol:t,bulletAlignment:ur.START,textStyle:{fs:12},startNumber:0,paragraphProperties:{hanging:{v:21},indentStart:{v:21*n}}})),Vn=e=>e.map((t,n)=>({...t,bulletAlignment:ur.START,textStyle:{fs:12},startNumber:0,paragraphProperties:{hanging:{v:21},indentStart:{v:21*n}}})),sh=(e,t)=>new Array(9).fill(0).map((n,r)=>({glyphFormat:` %${r+1}`,glyphSymbol:e,bulletAlignment:ur.START,textStyle:{fs:16},startNumber:0,paragraphProperties:{hanging:{v:21},indentStart:{v:21*r},textStyle:t}})),Ur={BULLET_LIST:{listType:"BULLET_LIST",nestingLevel:Gn(["●","○","■"])},BULLET_LIST_1:{listType:"BULLET_LIST",nestingLevel:Gn(["❖","➢","■"])},BULLET_LIST_2:{listType:"BULLET_LIST",nestingLevel:Gn(["✔","●","◆"])},BULLET_LIST_3:{listType:"BULLET_LIST",nestingLevel:Gn(["■","◆","○"])},BULLET_LIST_4:{listType:"BULLET_LIST",nestingLevel:Gn(["✧","○","■"])},BULLET_LIST_5:{listType:"BULLET_LIST",nestingLevel:Gn(["➢","○","◆"])},ORDER_LIST:{listType:"ORDER_LIST",nestingLevel:Vn([{glyphFormat:"%1.",glyphType:fe.DECIMAL},{glyphFormat:"%2.",glyphType:fe.LOWER_LETTER},{glyphFormat:"%3.",glyphType:fe.LOWER_ROMAN},{glyphFormat:"%4.",glyphType:fe.DECIMAL},{glyphFormat:"%5.",glyphType:fe.LOWER_LETTER},{glyphFormat:"%6.",glyphType:fe.LOWER_ROMAN},{glyphFormat:"%7.",glyphType:fe.DECIMAL},{glyphFormat:"%8.",glyphType:fe.LOWER_LETTER},{glyphFormat:"%9.",glyphType:fe.LOWER_ROMAN}])},ORDER_LIST_1:{listType:"ORDER_LIST",nestingLevel:Vn([{glyphFormat:"%1)",glyphType:fe.DECIMAL},{glyphFormat:"%2)",glyphType:fe.LOWER_LETTER},{glyphFormat:"%3)",glyphType:fe.LOWER_ROMAN},{glyphFormat:"%4)",glyphType:fe.DECIMAL},{glyphFormat:"%5)",glyphType:fe.LOWER_LETTER},{glyphFormat:"%6)",glyphType:fe.LOWER_ROMAN},{glyphFormat:"%7)",glyphType:fe.DECIMAL},{glyphFormat:"%8)",glyphType:fe.LOWER_LETTER},{glyphFormat:"%9)",glyphType:fe.LOWER_ROMAN}])},ORDER_LIST_2:{listType:"ORDER_LIST",nestingLevel:Vn(["%1.","%1.%2.","%1.%2.%3.","%1.%2.%3.%4.","%1.%2.%3.%4.%5.","%1.%2.%3.%4.%5.%6.","%1.%2.%3.%4.%5.%6.%7."].map(e=>({glyphFormat:e,glyphType:fe.DECIMAL})))},ORDER_LIST_3:{listType:"ORDER_LIST",nestingLevel:Vn([{glyphFormat:"%1.",glyphType:fe.UPPER_LETTER},{glyphFormat:"%2.",glyphType:fe.LOWER_LETTER},{glyphFormat:"%3.",glyphType:fe.LOWER_ROMAN},{glyphFormat:"%4.",glyphType:fe.UPPER_LETTER},{glyphFormat:"%5.",glyphType:fe.LOWER_LETTER},{glyphFormat:"%6.",glyphType:fe.LOWER_ROMAN},{glyphFormat:"%7.",glyphType:fe.UPPER_LETTER},{glyphFormat:"%8.",glyphType:fe.LOWER_LETTER},{glyphFormat:"%9.",glyphType:fe.LOWER_ROMAN}])},ORDER_LIST_4:{listType:"ORDER_LIST",nestingLevel:Vn([{glyphFormat:"%1.",glyphType:fe.UPPER_LETTER},{glyphFormat:"%2.",glyphType:fe.DECIMAL},{glyphFormat:"%3.",glyphType:fe.LOWER_ROMAN},{glyphFormat:"%4.",glyphType:fe.UPPER_LETTER},{glyphFormat:"%5.",glyphType:fe.DECIMAL},{glyphFormat:"%6.",glyphType:fe.LOWER_ROMAN},{glyphFormat:"%7.",glyphType:fe.UPPER_LETTER},{glyphFormat:"%8.",glyphType:fe.DECIMAL},{glyphFormat:"%9.",glyphType:fe.LOWER_ROMAN}])},ORDER_LIST_5:{listType:"ORDER_LIST",nestingLevel:Vn([{glyphFormat:"%1.",glyphType:fe.DECIMAL_ZERO},{glyphFormat:"%2.",glyphType:fe.LOWER_LETTER},{glyphFormat:"%3.",glyphType:fe.LOWER_ROMAN},{glyphFormat:"%4.",glyphType:fe.DECIMAL_ZERO},{glyphFormat:"%5.",glyphType:fe.LOWER_LETTER},{glyphFormat:"%6.",glyphType:fe.LOWER_ROMAN},{glyphFormat:"%7.",glyphType:fe.DECIMAL_ZERO},{glyphFormat:"%8.",glyphType:fe.LOWER_LETTER},{glyphFormat:"%9.",glyphType:fe.LOWER_ROMAN}])},CHECK_LIST:{listType:"CHECK_LIST",nestingLevel:sh("☐")},CHECK_LIST_CHECKED:{listType:"CHECK_LIST_CHECKED",nestingLevel:sh("☑",{st:{s:ae.TRUE}})}},zs=e=>{const{glyphFormat:t,glyphType:n}=e,r=Z.deepClone(Ur.ORDER_LIST);return r.nestingLevel[0].glyphFormat=t,r.nestingLevel[0].glyphType=n,r},q0={ORDER_LIST_QUICK_2:zs(Vs["a)"]),ORDER_LIST_QUICK_3:zs(Vs["a."]),ORDER_LIST_QUICK_4:zs(Vs["i."]),ORDER_LIST_QUICK_6:zs(Vs["I."])};Object.assign(Ur,q0);const Z0={"1.":"ORDER_LIST","a)":"ORDER_LIST_QUICK_2","a.":"ORDER_LIST_QUICK_3","i.":"ORDER_LIST_QUICK_4","A.":"ORDER_LIST_3","I.":"ORDER_LIST_QUICK_6","01.":"ORDER_LIST_5","*":"BULLET_LIST"};function J0(e,t,n,r,s){const i=Q0(e,t,n,r,s),o=eC(e,t,n,r,s),a=tC(e,t,n,r,s),l=nC(e,t,n,r,s),c=rC(e,t,n,r,s),u=sC(e,t,n,r),h=iC(e,t,n,r,s);return{dataStream:"",textRuns:i,paragraphs:o,sectionBreaks:a,customBlocks:l,tables:c,customRanges:u,customDecorations:h}}function Q0(e,t,n,r,s){const{textRuns:i}=e,{textRuns:o}=t;if(i==null||o==null)return;const a=Ju(e,n,r);if(s!==Ce.REPLACE){const l=ih(o,a,s);t.textRuns=l}return Yu(e,t,n,r),a}function ih(e,t,n){if(t.length===0)return e;e=Z.deepClone(e),t=Z.deepClone(t);const r=[],s=e.length,i=t.length;let o=0,a=0,l=null;function c(){return l?(r.push(l),l=null,!0):!1}for(;o<s&&a<i;){const{st:m,ed:_,ts:p}=e[o],{st:I,ed:A,ts:B,sId:x}=t[a];let Y;if(n===Ce.COVER?Y={...B,...p}:Y={...p},_<I)c()||r.push(e[o]),o++;else if(A<m)c()||r.push(t[a]),a++;else{const O={st:Math.min(m,I),ed:Math.max(m,I),ts:m<I?{...p}:{...B},sId:m<I?void 0:x};O.ed>O.st&&r.push(O),r.push({st:Math.max(m,I),ed:Math.min(_,A),ts:Y,sId:x}),_<A?(o++,t[a].st=_,t[a].st===t[a].ed&&a++):(a++,e[o].st=A,e[o].st===e[o].ed&&o++);const R={st:Math.min(_,A),ed:Math.max(_,A),ts:_<A?{...B}:{...p},sId:_<A?x:void 0};l=R.ed>R.st?R:null}}c();const u=r[r.length-1],h=e[s-1],d=t[i-1];return u&&u.ed!==Math.max(h.ed,d.ed)&&(h.ed>d.ed?r.push(h):r.push(d)),Dr(r)}function eC(e,t,n,r,s){const{paragraphs:i}=e,{paragraphs:o}=t;if(i==null||o==null)return;const a=Qu(e,n,r);if(s!==Ce.REPLACE){const l=[];for(const c of o){const{startIndex:u,paragraphStyle:h,bullet:d}=c;let m=[];for(const _ of a){const{startIndex:p,paragraphStyle:I,bullet:A}=_;let B,x;if(s===Ce.COVER?(B={...I,...h},x={listId:"",listType:Ft.BULLET_LIST,nestingLevel:0,textStyle:{},...A,...d}):(B={...h,...I},x={listId:"",listType:Ft.BULLET_LIST,nestingLevel:0,textStyle:{},...d,...A}),u===p){m.push({startIndex:u,paragraphStyle:B,bullet:x});break}}l.push(...m),m=[]}t.paragraphs=l}return Gu(e,t,n,r),a}function tC(e,t,n,r,s){const{sectionBreaks:i}=e,{sectionBreaks:o}=t;if(i==null||o==null)return;const a=eh(e,n,r);if(s!==Ce.REPLACE){const l=[];for(const c of o){const{startIndex:u}=c;let h=[];for(const d of a){const{startIndex:m}=d;if(u===m){s===Ce.COVER?h.push({...d,...c}):h.push({...c,...d});break}}l.push(...h),h=[]}t.sectionBreaks=l}return Vu(e,t,n,r),a}function nC(e,t,n,r,s){const{customBlocks:i=[]}=e,{customBlocks:o}=t;if(i==null||o==null)return;const a=th(e,n,r);if(s!==Ce.REPLACE){const l=[];for(const c of o){const{startIndex:u}=c;let h=[];for(const d of a){const{startIndex:m}=d;if(u===m){s===Ce.COVER?h.push({...d,...c}):h.push({...c,...d});break}}l.push(...h),h=[]}t.customBlocks=l}return zu(e,t,n,r),i.length&&!e.customBlocks&&(e.customBlocks=i),a}function rC(e,t,n,r,s){const{tables:i}=e,{tables:o}=t;if(i==null||o==null)return;const a=nh(e,n,r);if(s!==Ce.REPLACE){const l=[];for(const c of o){const{startIndex:u,endIndex:h}=c;let d=[];for(const m of a){const{startIndex:_,endIndex:p}=m;if(_>=u&&p<=h){s===Ce.COVER?d.push({...m,...c}):d.push({...c,...m});break}}l.push(...d),d=[]}t.tables=l}return Ku(e,t,n,r),a}function sC(e,t,n,r,s){e.customRanges||(e.customRanges=[]),$o(e.customRanges,r),$o(e.customRanges,r+n);const i=r,o=r+n-1,{customRanges:a}=t,l=[],c=new Map;e.customRanges.forEach(h=>{const{startIndex:d,endIndex:m}=h;d>=i&&m<=o?c.set(h.rangeId,h):l.push(h)});const u=[];return a?(a.forEach(h=>{const{startIndex:d,endIndex:m}=h;l.push({...h,startIndex:d+r,endIndex:m+r})}),e.customRanges=Bo(l),u):[]}function iC(e,t,n,r,s){e.customDecorations||(e.customDecorations=[]),Ho(e.customDecorations,r),Ho(e.customDecorations,r+n);const i=[],{customDecorations:o}=e,{customDecorations:a=[]}=t;if(s===Ce.REPLACE){for(let l=0;l<o.length;l++){const c=o[l],{startIndex:u,endIndex:h}=c;u>=r&&h<=r+n-1&&i.push(c)}a.forEach(l=>{const{startIndex:c,endIndex:u}=l;o.push({...l,startIndex:c+r,endIndex:u+r})})}else for(const l of a){const{id:c}=l;if(l.type===gn.DELETED){const u=o.filter(h=>h.id===c);u.length&&i.push(...u)}else o.push({...l,startIndex:l.startIndex+r,endIndex:l.endIndex+r})}for(const l of i){const{id:c}=l,u=o.findIndex(h=>h.id===c);u!==-1&&o.splice(u,1)}return e.customDecorations=Zu(o),i}var jo=(e=>(e[e.copy=0]="copy",e[e.cut=1]="cut",e))(jo||{});function Ks(e,t,n,r=!0){const{textRuns:s}=e;if(s){const i=[];for(const o of s){const a=Z.deepClone(o),{st:l,ed:c}=a;Z.hasIntersectionBetweenTwoRanges(l,c,t,n)&&(t>=l&&t<=c?i.push({...a,st:t,ed:Math.min(n,c)}):n>=l&&n<=c?i.push({...a,st:Math.max(t,l),ed:n}):i.push(a))}return Dr(i.map(o=>{const{st:a,ed:l}=o;return{...o,st:a-t,ed:l-t}}))}else if(r)return[{st:0,ed:n-t,ts:{}}]}function oh(e,t,n){const{tables:r=[]}=e,s=[];for(const i of r){const o=Z.deepClone(i),{startIndex:a,endIndex:l}=o;a>=t&&l<=n&&s.push({...o,startIndex:a-t,endIndex:l-t})}return s}function ah(e,t,n){const{paragraphs:r=[]}=e,s=[];for(const i of r){const{startIndex:o}=i;if(o>=t&&o<n){const a=Z.deepClone(i);s.push(a)}}if(s.length)return s.map(i=>({...i,startIndex:i.startIndex-t}))}function oC(e,t,n){const{sectionBreaks:r=[]}=e,s=[];for(const i of r){const{startIndex:o}=i;o>=t&&o<=n&&s.push(Z.deepClone(i))}if(s.length)return s.map(i=>({...i,startIndex:i.startIndex-t}))}function lh(e,t,n){const{customBlocks:r=[]}=e,s=[];for(const i of r){const{startIndex:o}=i;o>=t&&o<n&&s.push(Z.deepClone(i))}if(s.length)return s.map(i=>({...i,startIndex:i.startIndex-t}))}function bt(e,t,n,r=!0,s=1){const{dataStream:i}=e,o={dataStream:i.slice(t,n)};o.textRuns=Ks(e,t,n,r);const a=oh(e,t,n);if(a.length&&(o.tables=a),o.paragraphs=ah(e,t,n),s===1){const c=uh(e,t,n);c?o.customDecorations=c:r&&(o.customDecorations=[])}const{customRanges:l}=ch(e,t,n);return l?o.customRanges=l:r&&(o.customRanges=[]),o.customBlocks=lh(e,t,n),o}function aC(e){const{dataStream:t,textRuns:n,paragraphs:r,customRanges:s,customDecorations:i,tables:o}=e;let a=0,l=0;s==null||s.forEach(u=>{u.startIndex<0&&(a=Math.max(a,-u.startIndex)),u.endIndex>t.length-1&&(l=Math.max(l,u.endIndex-t.length+1))});const c=`${t}`;return n&&(n[0]&&(n[0].st=n[0].st-a),n[n.length-1]&&(n[n.length-1].ed=n[n.length-1].ed+l)),n==null||n.forEach(u=>{u.st+=a,u.ed+=a}),r==null||r.forEach(u=>{u.startIndex+=a}),s==null||s.forEach(u=>{u.startIndex+=a,u.endIndex+=a}),i==null||i.forEach(u=>{u.startIndex+=a,u.endIndex+=l}),o==null||o.forEach(u=>{u.startIndex+=a,u.endIndex+=l}),{...e,dataStream:c,textRuns:n,paragraphs:r,customRanges:s,customDecorations:i,tables:o}}function ch(e,t,n){if(e.customRanges==null)return{};const{customRanges:r}=e;return{customRanges:r.filter(a=>Math.max(a.startIndex,t)<=Math.min(a.endIndex,n-1)).map(a=>({...a,startIndex:Math.max(a.startIndex,t),endIndex:Math.min(a.endIndex,n-1)})).map(a=>({...a,startIndex:a.startIndex-t,endIndex:a.endIndex-t})),leftOffset:0,rightOffset:0}}function uh(e,t,n){if(e.customDecorations==null)return;const{customDecorations:r=[]}=e,s=[];return r.forEach(i=>{if(Math.max(i.startIndex,t)<=Math.min(i.endIndex,n-1)){const o=Z.deepClone(i);s.push({...o,startIndex:Math.max(o.startIndex-t,0),endIndex:Math.min(o.endIndex,n-1)-t})}}),s}function lC(e,t,n){return e==null||t==null?e!=null?e:t:ih(e,t,n)}function cC(e,t,n){if(e==null||t==null)return e!=null?e:t;if(t.length===0||e.length===0)return e;if(t.length>1||e.length>1)throw new Error("Cannot cover multiple customRanges");return n===Ce.REPLACE?[{...e[0]}]:[{...t[0],...e[0]}]}function uC(e,t,n){return t.length===0||e.length===0||n===Ce.REPLACE?e:[...e,...t.filter(r=>!e.some(s=>r.id===s.id))]}function Wo(e,t,n=Ce.COVER){if(t.dataStream!=="")throw new Error("Cannot compose other body with non-empty dataStream");const r={dataStream:e.dataStream},{textRuns:s,paragraphs:i=[],customRanges:o,customDecorations:a=[]}=e,{textRuns:l,paragraphs:c=[],customRanges:u,customDecorations:h=[]}=t;r.textRuns=lC(l,s,n),r.customRanges=cC(u,o,n);const d=uC(h,a,n);d.length&&(r.customDecorations=d);const m=[];let _=0,p=0;for(;_<i.length&&p<c.length;){const I=i[_],A=c[p],{startIndex:B}=I,{startIndex:x}=A;B===x?(m.push(Z.deepMerge(I,A)),_++,p++):B<x?(m.push(Z.deepClone(I)),_++):(m.push(Z.deepClone(A)),p++)}return _<i.length&&m.push(...i.slice(_)),p<c.length&&m.push(...c.slice(p)),m.length&&(r.paragraphs=m),r}function hC(e){const{body:t}=e;if(t==null)return!0;const{textRuns:n,paragraphs:r,customRanges:s,customBlocks:i,customDecorations:o,tables:a}=t;return n==null&&r==null&&s==null&&i==null&&o==null&&a==null}class zn{constructor(t){C(this,"_index",0);C(this,"_offset",0);this._actions=t}hasNext(){return this.peekLength()<Number.POSITIVE_INFINITY}next(t){t||(t=Number.POSITIVE_INFINITY);const n=this._actions[this._index];if(n){const r=this._offset,s=n.len;return t>=s-r?(t=s-r,this._index+=1,this._offset=0):this._offset+=t,n.t===J.DELETE||n.t===J.RETAIN&&n.body==null?Z.deepClone({...n,len:t}):Z.deepClone({...n,len:t,body:bt(n.body,r,r+t,!1)})}else return{t:J.RETAIN,len:Number.POSITIVE_INFINITY}}peek(){return this._actions[this._index]}peekLength(){return this._actions[this._index]?this._actions[this._index].len-this._offset:Number.POSITIVE_INFINITY}peekType(){const t=this._actions[this._index];return t?t.t:J.RETAIN}rest(){if(this.hasNext()){if(this._offset===0)return this._actions.slice(this._index);{const t=this._offset,n=this._index,r=this.next(),s=this._actions.slice(this._index);return this._offset=t,this._index=n,[r].concat(s)}}else return[]}}function hh(e,t,n){const{dataStream:r}=e,s=n,i=n+t,o=Ju(e,t,n),a=Qu(e,t,n),l=eh(e,t,n),c=th(e,t,n),u=nh(e,t,n),h=K0(e,t,n),d=X0(e,t,n);let m="";return r&&(e.dataStream=Jc(r,s,i),m=r.slice(s,i)),{dataStream:m,textRuns:o,paragraphs:a,sectionBreaks:l,customBlocks:c,tables:u,customRanges:h,customDecorations:d}}function dh(e,t,n,r){e.dataStream=Zc(e.dataStream,r,t.dataStream),Yu(e,t,n,r),Gu(e,t,n,r),Vu(e,t,n,r),zu(e,t,n,r),Ku(e,t,n,r),V0(e,t,n,r),z0(e,t,n,r)}function dC(e,t,n,r,s=Ce.COVER){return J0(e,t,n,r,s)}function fC(e,t,n){return t<=0?{dataStream:""}:hh(e,t,n)}function mC(e,t,n,r){n!==0&&dh(e,t,n,r)}function gC(e,t){const n=new dn;return n.reset(),t.forEach(r=>{const s=Z.deepClone(r);switch(s.t){case J.RETAIN:{const{coverType:i,body:o,len:a}=s;o!=null&&dC(e,o,a,n.cursor,i),n.moveCursor(a);break}case J.INSERT:{const{body:i,len:o}=s;mC(e,i,o,n.cursor),n.moveCursor(o);break}case J.DELETE:{const{len:i}=s;fC(e,i,n.cursor);break}default:throw new Error(`Unknown action type for action: ${s}.`)}}),e}function _C(e,t,n,r,s){if(e==null||t==null)return t;if(e.length===0||t.length===0)return[];t=Z.deepClone(t),e=Z.deepClone(e);const i=[],o=t.length,a=e.length;let l=0,c=0,u=null;function h(){return u?(i.push(u),u=null,!0):!1}for(;l<o&&c<a;){const{st:p,ed:I,ts:A}=t[l],{st:B,ed:x,ts:Y,sId:O}=e[c];let R={};if(s===0)R={...A},n===Ce.COVER&&r===Ce.REPLACE&&Y&&(R=Object.assign({},Y,R));else if(R={...A},n===Ce.REPLACE){if(r===Ce.REPLACE)R={...Y};else if(A&&Y){const b=Object.keys(A);for(const y of b)Y[y]&&delete R[y]}}else if(r===Ce.REPLACE){if(Y){const b=Object.keys(Y);for(const y of b)Y[y]!==void 0&&(R[y]=Y[y])}}else if(Y){const b=Object.keys(Y);for(const y of b)R[y]!==void 0&&delete R[y]}if(I<B)h()||i.push(t[l]),l++;else if(x<p)h()||i.push(e[c]),c++;else{const b={st:Math.min(p,B),ed:Math.max(p,B),ts:p<B?{...A}:{...Y}};b.ed>b.st&&i.push(),i.push({st:Math.max(p,B),ed:Math.min(I,x),ts:R,sId:O}),I<x?(l++,e[c].st=I,e[c].st===e[c].ed&&c++):(c++,t[l].st=x,t[l].st===t[l].ed&&l++);const y={st:Math.min(I,x),ed:Math.max(I,x),ts:I<x?{...Y}:{...A},sId:I<x?O:void 0};u=y.ed>y.st?y:null}}h();const d=i[i.length-1],m=t[o-1],_=e[a-1];return d.ed!==Math.max(m.ed,_.ed)&&(m.ed>_.ed?i.push(m):i.push(_)),Dr(i,!0)}function pC(e,t,n,r,s){if(e==null||t==null)return t;if(e.length===0||t.length===0)return[];if(e.length>1||t.length>1)throw new Error("CustomRanges is only supported transform for length one now.");const i=e[0],o=t[0];if(n===Ce.REPLACE)return s===1?[Z.deepClone(i)]:[Z.deepClone(o)];if(r===Ce.REPLACE){const a=Z.deepClone(o);return s===1&&Object.assign(a,Z.deepClone(i)),[a]}else{const a=Z.deepClone(o);return s===1&&Object.assign(a,Z.deepClone(i)),[a]}}function fh(e,t,n,r,s){const i={startIndex:t.startIndex};if(t.paragraphStyle&&(i.paragraphStyle=Z.deepClone(t.paragraphStyle),e.paragraphStyle)){if(n===Ce.REPLACE)if(r===Ce.REPLACE)s===1&&(i.paragraphStyle={...e.paragraphStyle});else if(s===1){const o=Object.keys(e.paragraphStyle);for(const a of o)e.paragraphStyle[a]!==void 0&&(i.paragraphStyle[a]=e.paragraphStyle[a])}else{const o=Object.keys(e.paragraphStyle);for(const a of o)i.paragraphStyle[a]===void 0&&(i.paragraphStyle[a]=e.paragraphStyle[a])}else if(r===Ce.REPLACE)if(s===1){const o=Object.keys(e.paragraphStyle);for(const a of o)e.paragraphStyle[a]!==void 0&&(i.paragraphStyle[a]=e.paragraphStyle[a])}else{const o=Object.keys(e.paragraphStyle);for(const a of o)i.paragraphStyle[a]===void 0&&(i.paragraphStyle[a]=e.paragraphStyle[a])}else if(s===1){const o=Object.keys(e.paragraphStyle);for(const a of o)i.paragraphStyle[a]&&delete i.paragraphStyle[a]}}return n===Ce.REPLACE&&r===Ce.REPLACE?i.bullet=s===1?Z.deepClone(e.bullet):Z.deepClone(t.bullet):e.bullet===void 0?i.bullet=Z.deepClone(t.bullet):n===Ce.REPLACE||r===Ce.REPLACE?i.bullet=s===0&&t.bullet?Z.deepClone(t.bullet):Z.deepClone(e.bullet):s===0&&t.bullet!==void 0&&(i.bullet=Z.deepClone(t.bullet)),i}function EC(e,t){if(e==null||t==null)return t;if(e.length===0||t.length===0)return Z.deepClone(t);const n=[];for(const r of t){const{id:s,type:i}=r;let o=!1;for(const a of e)if(a.id===s){(a.type===gn.DELETED||i===gn.DELETED)&&(o=!0,n.push({...r,type:gn.DELETED}));break}o||n.push(r)}return n}function CC(e,t,n=!1){const{body:r,coverType:s=Ce.COVER}=e,{body:i,coverType:o=Ce.COVER}=t;if(r==null||r.dataStream!==""||i==null||i.dataStream!=="")throw new Error("Data stream is not supported in retain transform.");const a={dataStream:""},l=o,{textRuns:c,paragraphs:u=[],customRanges:h,customDecorations:d}=r,{textRuns:m,paragraphs:_=[],customRanges:p,customDecorations:I}=i,A=_C(c,m,s,o,n?1:0);A&&(a.textRuns=A);const B=pC(h,p,s,o,n?1:0);B&&(a.customRanges=B);const x=EC(d,I);x&&(a.customDecorations=x);const Y=[];let O=0,R=0;for(;O<u.length&&R<_.length;){const b=u[O],y=_[R],{startIndex:$}=b,{startIndex:H}=y;if($===H){let g={startIndex:$};n?g=fh(b,y,s,o,1):g=fh(b,y,s,o,0),Y.push(g),O++,R++}else $<H?O++:(Y.push(Z.deepClone(y)),R++)}return R<_.length&&Y.push(..._.slice(R)),Y.length&&(a.paragraphs=Y),{coverType:l,body:a}}function mh(e){return Object.keys(e).length===1}const Zn=class Zn{constructor(){C(this,"_actions",[])}static apply(t,n){return gC(t,n)}static compose(t,n){const r=new zn(t),s=new zn(n),i=new Zn;for(;r.hasNext()||s.hasNext();)if(s.peekType()===J.INSERT)i.push(s.next());else if(r.peekType()===J.DELETE)i.push(r.next());else{const o=Math.min(r.peekLength(),s.peekLength()),a=r.next(o),l=s.next(o);if(a.t===J.INSERT&&l.t===J.RETAIN)l.body==null?i.push(a):i.push({...a,body:Wo(a.body,l.body,l.coverType)});else if(a.t===J.RETAIN&&l.t===J.RETAIN)if(a.body==null&&l.body==null)i.push(a.len!==Number.POSITIVE_INFINITY?a:l);else if(a.body&&l.body){const c=a.coverType===Ce.REPLACE||l.coverType===Ce.REPLACE?Ce.REPLACE:Ce.COVER;i.push({...a,t:J.RETAIN,coverType:c,body:Wo(a.body,l.body,l.coverType)})}else i.push(a.body?a:l);else a.t===J.RETAIN&&l.t===J.DELETE?i.push(l):a.t===J.INSERT&&(l.t,J.DELETE)}return i.trimEndUselessRetainAction(),i.serialize()}static transform(t,n,r="right"){return this._transform(n,t,r==="left"?"right":"left")}static _transform(t,n,r="right"){const s=new zn(t),i=new zn(n),o=new Zn;for(;s.hasNext()||i.hasNext();)if(s.peekType()===J.INSERT&&(r==="left"||i.peekType()!==J.INSERT)){const a=s.next();o.retain(a.len)}else if(i.peekType()===J.INSERT)o.push(i.next());else{const a=Math.min(s.peekLength(),i.peekLength()),l=s.next(a),c=i.next(a);if(l.t===J.DELETE)continue;if(c.t===J.DELETE){o.push(c);continue}if(l.body==null||c.body==null)o.push(c);else{const{coverType:u,body:h}=CC(l,c,r==="left");o.push({...c,t:J.RETAIN,coverType:u,body:h})}}return o.trimEndUselessRetainAction(),o.serialize()}static transformPosition(t,n,r=!1){const s=new zn(t);let i=0;for(;s.hasNext()&&i<=n;){const o=s.peekLength(),a=s.peekType();if(s.next(),a===J.DELETE){n-=Math.min(o,n-i);continue}else a===J.INSERT&&(i<n||!r)&&(n+=o);i+=o}return n}static isNoop(t){return t.length===0}static invert(t){const n=[];for(const r of t)if(r.t===J.INSERT)n.push({t:J.DELETE,len:r.len,body:r.body});else if(r.t===J.DELETE){if(r.body==null)throw new Error("Can not invert DELETE action without body property, makeInvertible must be called first.");n.push({t:J.INSERT,body:r.body,len:r.len})}else if(r.body!=null){if(r.oldBody==null)throw new Error("Can not invert RETAIN action without oldBody property, makeInvertible must be called first.");n.push({t:J.RETAIN,body:r.oldBody,oldBody:r.body,len:r.len,coverType:Ce.REPLACE})}else n.push(r);return n}static makeInvertible(t,n){const r=[];let s=0;for(const i of t){if(i.t===J.DELETE&&(i.body==null||i.body&&i.body.dataStream.length!==i.len)){const o=bt(n,s,s+i.len,!1);i.len=o.dataStream.length,i.body=o}if(i.t===J.RETAIN&&i.body!=null){const o=bt(n,s,s+i.len,!0);i.oldBody={...o,dataStream:""},i.len=o.dataStream.length}r.push(i),i.t!==J.INSERT&&(s+=i.len)}return r}insert(t,n){const r={t:J.INSERT,body:n,len:t};return this.push(r),this}retain(t,n,r){const s={t:J.RETAIN,len:t};return n!=null&&(s.body=n),r!=null&&(s.coverType=r),this.push(s),this}delete(t){const n={t:J.DELETE,len:t};return this.push(n),this}empty(){return this._actions=[],this}serialize(){return this._actions}push(...t){if(t.length>1){for(const i of t)this.push(i);return this}let n=this._actions.length,r=this._actions[n-1];const s=Z.deepClone(t[0]);if(s.t===J.RETAIN&&s.len===0&&s.body==null)return this;if(typeof r=="object"){if(r.t===J.DELETE&&s.t===J.DELETE)return r.len+=s.len,this;if(r.t===J.DELETE&&s.t===J.INSERT&&(n-=1,r=this._actions[n-1],r==null))return this._actions.unshift(s),this;if(r.t===J.RETAIN&&s.t===J.RETAIN&&r.body==null&&s.body==null)return r.len+=s.len,this;if(r.t===J.INSERT&&mh(r.body)&&s.t===J.INSERT&&mh(s.body))return r.len+=s.len,r.body.dataStream+=s.body.dataStream,this}return n===this._actions.length?this._actions.push(s):this._actions.splice(n,0,s),this}trimEndUselessRetainAction(){let t=this._actions[this._actions.length-1];for(;t&&t.t===J.RETAIN&&hC(t);)this._actions.pop(),t=this._actions[this._actions.length-1];return this}};C(Zn,"id","text-x"),C(Zn,"uri","https://github.com/dream-num/univer#text-x");let Me=Zn;Object.defineProperty(Me,"name",{value:"text-x"});const Jn=class Jn{static registerSubtype(t){var n;t==null||this._subTypes.has(t.name)&&((n=this._subTypes.get(t.name))==null?void 0:n.id)!==Me.id||(this._subTypes.set(t.name,t),at.type.registerSubtype(t))}static apply(t,n){if(!at.type.isNoop(n))return at.type.apply(t,n)}static compose(t,n){return at.type.compose(t,n)}static transform(t,n,r){return at.type.transform(t,n,r)}static transformPosition(t,n,r="right"){return t&&t.length===2&&t[0]==="body"&&t[1].et===Me.name?Me.transformPosition(t[1].e,n,r==="left"):n}static invertWithDoc(t,n){return at.type.invertWithDoc(t,n)}static isNoop(t){return at.type.isNoop(t)}static getInstance(){return this._instance==null&&(this._instance=new Jn),this._instance}removeOp(t,n){return at.removeOp(t,n)}moveOp(t,n){return at.moveOp(t,n)}insertOp(t,n){return at.insertOp(t,n)}replaceOp(t,n,r){return at.replaceOp(t,n,r)}editOp(t,n=["body"]){return at.editOp(n,Me.name,t)}};C(Jn,"uri","https://github.com/dream-num/univer#json-x"),C(Jn,"_subTypes",new Map),C(Jn,"_instance",null);let Wt=Jn;Wt.registerSubtype(Me);var gh=(e=>(e.PARAGRAPH="PARAGRAPH",e.SECTION_BREAK="SECTION_BREAK",e.TABLE="TABLE",e.TABLE_ROW="TABLE_ROW",e.TABLE_CELL="TABLE_CELL",e.CUSTOM_BLOCK="CUSTOM_BLOCK",e))(gh||{}),lt=(e=>(e.PARAGRAPH="\r",e.SECTION_BREAK=`
`,e.TABLE_START="",e.TABLE_ROW_START="\x1B",e.TABLE_CELL_START="",e.TABLE_CELL_END="",e.TABLE_ROW_END="",e.TABLE_END="",e.CUSTOM_RANGE_START="",e.CUSTOM_RANGE_END="",e.COLUMN_BREAK="\v",e.PAGE_BREAK="\f",e.DOCS_END="\0",e.TAB="	",e.CUSTOM_BLOCK="\b",e.LETTER="",e.SPACE=" ",e))(lt||{});function RC(e){return`${e}`}const IC=[lt.TABLE_START,lt.TABLE_ROW_START,lt.TABLE_CELL_START,lt.TABLE_CELL_END,lt.TABLE_ROW_END,lt.TABLE_END],Xs=e=>{const t=e.endsWith(`\r
`)?e.slice(0,-2):e;return IC.reduce((n,r)=>n.replaceAll(r,""),t)},SC=e=>e?Xs(e).replaceAll("\r","")==="":!0,OC=e=>{const t=e.replace(/\n/g,"\r"),n=[],r=[];let s=0,i="";const o=(l,c=!0)=>{const u=t.slice(s,l);if(Z.isLegalUrl(u)){const h=tt(),d=`${u}`,m={startIndex:s,endIndex:s+d.length-1,rangeId:h,rangeType:Jt.HYPERLINK,properties:{url:e}};r.push(m),i+=d,s=l+1,c&&(i+="\r",n.push({startIndex:l}))}else i+=t.slice(s,l+1),s=l+1,c&&n.push({startIndex:l})};let a=0;for(let l=0;l<t.length;l++)t[l]==="\r"&&(o(l),a=l);return(a!==t.length-1||t.length===1)&&o(t.length,!1),{dataStream:i,paragraphs:n,customRanges:r}},Yo={id:"default_doc",documentStyle:{}};class vC extends is{constructor(n){var r;super();C(this,"type",ve.UNIVER_DOC);C(this,"_name$",new oe.BehaviorSubject(""));C(this,"name$",this._name$.asObservable());C(this,"snapshot");this.snapshot={...Yo,...n},this._name$.next((r=this.snapshot.title)!=null?r:"No Title")}getUnitId(){throw new Error("Method not implemented.")}getRev(){var n;return(n=this.snapshot.rev)!=null?n:1}incrementRev(){this.snapshot.rev=this.getRev()+1}setRev(n){this.snapshot.rev=n}setName(n){this.snapshot.title=n,this._name$.next(n)}get drawings(){return this.snapshot.drawings}get documentStyle(){return this.snapshot.documentStyle}get lists(){return this.snapshot.lists}get zoomRatio(){var n;return((n=this.snapshot.settings)==null?void 0:n.zoomRatio)||1}resetDrawing(n,r){this.snapshot.drawings=n,this.snapshot.drawingsOrder=r}getBody(){return this.snapshot.body}getSnapshot(){return this.snapshot}getBulletPresetList(){var s;const n=(s=this.snapshot.lists)!=null?s:{};return{...Ur,...n}}updateDocumentId(n){this.snapshot.id=n}updateDocumentRenderConfig(n){const{documentStyle:r}=this.snapshot;r.renderConfig==null?r.renderConfig=n:r.renderConfig={...r.renderConfig,...n}}getDocumentStyle(){return this.snapshot.documentStyle}updateDocumentStyle(n){this.snapshot.documentStyle==null?this.snapshot.documentStyle=n:this.snapshot.documentStyle={...this.snapshot.documentStyle,...n}}updateDocumentDataMargin(n){const{t:r,l:s,b:i,r:o}=n,{documentStyle:a}=this.snapshot;r!=null&&(a.marginTop=r),s!=null&&(a.marginLeft=s),i!=null&&(a.marginBottom=i),o!=null&&(a.marginRight=o)}updateDocumentDataPageSize(n,r){const{documentStyle:s}=this.snapshot;if(!s.pageSize){s.pageSize={width:n!=null?n:Number.POSITIVE_INFINITY,height:r!=null?r:Number.POSITIVE_INFINITY};return}n!==void 0&&(s.pageSize.width=n),r!==void 0&&(s.pageSize.height=r)}updateDrawing(n,r){const{drawings:s}=this,{width:i,height:o,left:a,top:l}=r,c=s==null?void 0:s[n];if(!c)return;const u=c.docTransform;u.size.width=i,u.size.height=o,u.positionH.posOffset=a,u.positionV.posOffset=l}setZoomRatio(n=1){this.snapshot.settings?this.snapshot.settings.zoomRatio=n:this.snapshot.settings={zoomRatio:n}}setDisabled(n){this.snapshot.disabled=n}getDisabled(){return this.snapshot.disabled}getTitle(){return this.snapshot.title}}class At extends vC{constructor(n){var s,i;super(Z.isEmptyObject(n)?v_():n);C(this,"_unitId");C(this,"headerModelMap",new Map);C(this,"footerModelMap",new Map);C(this,"change$",new oe.BehaviorSubject(0));const r=6;this._unitId=(s=this.snapshot.id)!=null?s:tt(r),this._initializeHeaderFooterModel(),this._name$.next((i=this.snapshot.title)!=null?i:"")}dispose(){super.dispose(),this.headerModelMap.forEach(n=>{n.dispose()}),this.footerModelMap.forEach(n=>{n.dispose()}),this._name$.complete()}getDrawings(){return this.snapshot.drawings}getDrawingsOrder(){return this.snapshot.drawingsOrder}getCustomRanges(){var n;return(n=this.snapshot.body)==null?void 0:n.customRanges}getCustomDecorations(){var n;return(n=this.snapshot.body)==null?void 0:n.customDecorations}getSettings(){return this.snapshot.settings}reset(n){if(n.id&&n.id!==this._unitId)throw new Error("Cannot reset a document model with a different unit id!");this.snapshot={...Yo,...n},this._initializeHeaderFooterModel(),this.change$.next(this.change$.value+1)}getSelfOrHeaderFooterModel(n){if(n!=null){if(this.headerModelMap.has(n))return this.headerModelMap.get(n);if(this.footerModelMap.has(n))return this.footerModelMap.get(n)}return this}getUnitId(){return this._unitId}apply(n){if(!Wt.isNoop(n))return this.snapshot=Wt.apply(this.snapshot,n),n!=null&&n.some(r=>Array.isArray(r)&&((r==null?void 0:r[0])==="headers"||(r==null?void 0:r[0])==="footers"))&&(this.headerModelMap.clear(),this.footerModelMap.clear(),this._initializeHeaderFooterModel()),this.change$.next(this.change$.value+1),this.snapshot}sliceBody(n,r,s=jo.copy){const i=this.getBody();if(i!=null)return bt(i,n,r,!1,s)}_initializeHeaderFooterModel(){const{headers:n,footers:r}=this.getSnapshot();if(n)for(const s in n){const i=n[s];this.headerModelMap.set(s,new At(i)),this.headerModelMap.get(s).updateDocumentId(this.getUnitId())}if(r)for(const s in r){const i=r[s];this.footerModelMap.set(s,new At(i)),this.footerModelMap.get(s).updateDocumentId(this.getUnitId())}}updateDocumentId(n){super.updateDocumentId(n),this._unitId=n}getPlainText(){var n,r;return Xs((r=(n=this.getBody())==null?void 0:n.dataStream)!=null?r:"")}}function wC(e){const{ranges:t,id:n,type:r}=e,s=new Me;let i=0;for(let o=0;o<t.length;o++){const a=t[o],{startOffset:l,endOffset:c}=a;l>0&&s.push({t:J.RETAIN,len:l-i}),s.push({t:J.RETAIN,body:{dataStream:"",customDecorations:[{id:n,type:r,startIndex:0,endIndex:c-l-1}]},len:c-l}),i=c}return s}function bC(e){var u,h,d;const{id:t,segmentId:n,documentDataModel:r}=e,s=r==null?void 0:r.getBody();if(!r||!s)return!1;const i=(d=(h=(u=r.getSelfOrHeaderFooterModel(n))==null?void 0:u.getBody())==null?void 0:h.customDecorations)==null?void 0:d.find(m=>m.id===t);if(!i)return!1;const o=new Me,{startIndex:a,endIndex:l}=i,c=l-a+1;return o.push({t:J.RETAIN,len:a}),o.push({t:J.RETAIN,len:c,body:{dataStream:"",customDecorations:[{startIndex:0,endIndex:c-1,id:t,type:gn.DELETED}]}}),o}function _h(e,t,n,r){return e<=n&&t>=n||e>=n&&e<=r}function AC(e,t){const n=[];for(let r=0,s=t.length;r<s;r++){const i=t[r];e.collapsed?i.startIndex<e.startOffset&&e.startOffset<=i.endIndex&&n.push(i):_h(e.startOffset,e.endOffset-1,i.startIndex,i.endIndex)&&n.push(i)}return n}function TC(e){return{...Z.deepClone(e),rangeId:tt()}}function yC(e,t){const n=[];let r=e[0];for(const s of t)s<e[0]||s>e[1]||(r<s&&n.push([r,s-1]),r=s+1);return r<=e[1]&&n.push([r,e[1]]),n}function ph(e,t,n,r){const s=[];for(let i=0,o=n.length;i<o;i++){const a=n[i];if((r===void 0||a.rangeType===r)&&Math.max(a.startIndex,e)<=Math.min(a.endIndex,t)&&s.push({...a}),a.startIndex>t)break}return s}function NC(e,t){var i,o,a,l,c;const n=ph(e.startOffset,e.collapsed?e.startOffset:e.endOffset-1,(i=t.customRanges)!=null?i:[]),r=Math.min(e.startOffset,(a=(o=n[0])==null?void 0:o.startIndex)!=null?a:1/0),s=Math.max(e.endOffset,((c=(l=n[n.length-1])==null?void 0:l.endIndex)!=null?c:-1/0)+1);return{startOffset:r,endOffset:s,collapsed:r===s}}var Go,Eh;function MC(){if(Eh)return Go;Eh=1;var e=-1,t=1,n=0;function r(g,P,v,M,T){if(g===P)return g?[[n,g]]:[];if(v!=null){var w=$(g,P,v);if(w)return w}var N=a(g,P),L=g.substring(0,N);g=g.substring(N),P=P.substring(N),N=c(g,P);var D=g.substring(g.length-N);g=g.substring(0,g.length-N),P=P.substring(0,P.length-N);var F=s(g,P);return L&&F.unshift([n,L]),D&&F.push([n,D]),B(F,T),M&&h(F),F}function s(g,P){var v;if(!g)return[[t,P]];if(!P)return[[e,g]];var M=g.length>P.length?g:P,T=g.length>P.length?P:g,w=M.indexOf(T);if(w!==-1)return v=[[t,M.substring(0,w)],[n,T],[t,M.substring(w+T.length)]],g.length>P.length&&(v[0][0]=v[2][0]=e),v;if(T.length===1)return[[e,g],[t,P]];var N=u(g,P);if(N){var L=N[0],D=N[1],F=N[2],Q=N[3],z=N[4],le=r(L,F),ue=r(D,Q);return le.concat([[n,z]],ue)}return i(g,P)}function i(g,P){for(var v=g.length,M=P.length,T=Math.ceil((v+M)/2),w=T,N=2*T,L=new Array(N),D=new Array(N),F=0;F<N;F++)L[F]=-1,D[F]=-1;L[w+1]=0,D[w+1]=0;for(var Q=v-M,z=Q%2!==0,le=0,ue=0,S=0,U=0,G=0;G<T;G++){for(var V=-G+le;V<=G-ue;V+=2){var j=w+V,W;V===-G||V!==G&&L[j-1]<L[j+1]?W=L[j+1]:W=L[j-1]+1;for(var ee=W-V;W<v&&ee<M&&g.charAt(W)===P.charAt(ee);)W++,ee++;if(L[j]=W,W>v)ue+=2;else if(ee>M)le+=2;else if(z){var te=w+Q-V;if(te>=0&&te<N&&D[te]!==-1){var k=v-D[te];if(W>=k)return o(g,P,W,ee)}}}for(var K=-G+S;K<=G-U;K+=2){var te=w+K,k;K===-G||K!==G&&D[te-1]<D[te+1]?k=D[te+1]:k=D[te-1]+1;for(var q=k-K;k<v&&q<M&&g.charAt(v-k-1)===P.charAt(M-q-1);)k++,q++;if(D[te]=k,k>v)U+=2;else if(q>M)S+=2;else if(!z){var j=w+Q-K;if(j>=0&&j<N&&L[j]!==-1){var W=L[j],ee=w+W-j;if(k=v-k,W>=k)return o(g,P,W,ee)}}}}return[[e,g],[t,P]]}function o(g,P,v,M){var T=g.substring(0,v),w=P.substring(0,M),N=g.substring(v),L=P.substring(M),D=r(T,w),F=r(N,L);return D.concat(F)}function a(g,P){if(!g||!P||g.charAt(0)!==P.charAt(0))return 0;for(var v=0,M=Math.min(g.length,P.length),T=M,w=0;v<T;)g.substring(w,T)==P.substring(w,T)?(v=T,w=v):M=T,T=Math.floor((M-v)/2+v);return x(g.charCodeAt(T-1))&&T--,T}function l(g,P){var v=g.length,M=P.length;if(v==0||M==0)return 0;v>M?g=g.substring(v-M):v<M&&(P=P.substring(0,v));var T=Math.min(v,M);if(g==P)return T;for(var w=0,N=1;;){var L=g.substring(T-N),D=P.indexOf(L);if(D==-1)return w;N+=D,(D==0||g.substring(T-N)==P.substring(0,N))&&(w=N,N++)}}function c(g,P){if(!g||!P||g.slice(-1)!==P.slice(-1))return 0;for(var v=0,M=Math.min(g.length,P.length),T=M,w=0;v<T;)g.substring(g.length-T,g.length-w)==P.substring(P.length-T,P.length-w)?(v=T,w=v):M=T,T=Math.floor((M-v)/2+v);return Y(g.charCodeAt(g.length-T))&&T--,T}function u(g,P){var v=g.length>P.length?g:P,M=g.length>P.length?P:g;if(v.length<4||M.length*2<v.length)return null;function T(ue,S,U){for(var G=ue.substring(U,U+Math.floor(ue.length/4)),V=-1,j="",W,ee,te,k;(V=S.indexOf(G,V+1))!==-1;){var K=a(ue.substring(U),S.substring(V)),q=c(ue.substring(0,U),S.substring(0,V));j.length<q+K&&(j=S.substring(V-q,V)+S.substring(V,V+K),W=ue.substring(0,U-q),ee=ue.substring(U+K),te=S.substring(0,V-q),k=S.substring(V+K))}return j.length*2>=ue.length?[W,ee,te,k,j]:null}var w=T(v,M,Math.ceil(v.length/4)),N=T(v,M,Math.ceil(v.length/2)),L;if(!w&&!N)return null;N?w?L=w[4].length>N[4].length?w:N:L=N:L=w;var D,F,Q,z;g.length>P.length?(D=L[0],F=L[1],Q=L[2],z=L[3]):(Q=L[0],z=L[1],D=L[2],F=L[3]);var le=L[4];return[D,F,Q,z,le]}function h(g){for(var P=!1,v=[],M=0,T=null,w=0,N=0,L=0,D=0,F=0;w<g.length;)g[w][0]==n?(v[M++]=w,N=D,L=F,D=0,F=0,T=g[w][1]):(g[w][0]==t?D+=g[w][1].length:F+=g[w][1].length,T&&T.length<=Math.max(N,L)&&T.length<=Math.max(D,F)&&(g.splice(v[M-1],0,[e,T]),g[v[M-1]+1][0]=t,M--,M--,w=M>0?v[M-1]:-1,N=0,L=0,D=0,F=0,T=null,P=!0)),w++;for(P&&B(g),A(g),w=1;w<g.length;){if(g[w-1][0]==e&&g[w][0]==t){var Q=g[w-1][1],z=g[w][1],le=l(Q,z),ue=l(z,Q);le>=ue?(le>=Q.length/2||le>=z.length/2)&&(g.splice(w,0,[n,z.substring(0,le)]),g[w-1][1]=Q.substring(0,Q.length-le),g[w+1][1]=z.substring(le),w++):(ue>=Q.length/2||ue>=z.length/2)&&(g.splice(w,0,[n,Q.substring(0,ue)]),g[w-1][0]=t,g[w-1][1]=z.substring(0,z.length-ue),g[w+1][0]=e,g[w+1][1]=Q.substring(ue),w++),w++}w++}}var d=/[^a-zA-Z0-9]/,m=/\s/,_=/[\r\n]/,p=/\n\r?\n$/,I=/^\r?\n\r?\n/;function A(g){function P(ue,S){if(!ue||!S)return 6;var U=ue.charAt(ue.length-1),G=S.charAt(0),V=U.match(d),j=G.match(d),W=V&&U.match(m),ee=j&&G.match(m),te=W&&U.match(_),k=ee&&G.match(_),K=te&&ue.match(p),q=k&&S.match(I);return K||q?5:te||k?4:V&&!W&&ee?3:W||ee?2:V||j?1:0}for(var v=1;v<g.length-1;){if(g[v-1][0]==n&&g[v+1][0]==n){var M=g[v-1][1],T=g[v][1],w=g[v+1][1],N=c(M,T);if(N){var L=T.substring(T.length-N);M=M.substring(0,M.length-N),T=L+T.substring(0,T.length-N),w=L+w}for(var D=M,F=T,Q=w,z=P(M,T)+P(T,w);T.charAt(0)===w.charAt(0);){M+=T.charAt(0),T=T.substring(1)+w.charAt(0),w=w.substring(1);var le=P(M,T)+P(T,w);le>=z&&(z=le,D=M,F=T,Q=w)}g[v-1][1]!=D&&(D?g[v-1][1]=D:(g.splice(v-1,1),v--),g[v][1]=F,Q?g[v+1][1]=Q:(g.splice(v+1,1),v--))}v++}}function B(g,P){g.push([n,""]);for(var v=0,M=0,T=0,w="",N="",L;v<g.length;){if(v<g.length-1&&!g[v][1]){g.splice(v,1);continue}switch(g[v][0]){case t:T++,N+=g[v][1],v++;break;case e:M++,w+=g[v][1],v++;break;case n:var D=v-T-M-1;if(P){if(D>=0&&R(g[D][1])){var F=g[D][1].slice(-1);if(g[D][1]=g[D][1].slice(0,-1),w=F+w,N=F+N,!g[D][1]){g.splice(D,1),v--;var Q=D-1;g[Q]&&g[Q][0]===t&&(T++,N=g[Q][1]+N,Q--),g[Q]&&g[Q][0]===e&&(M++,w=g[Q][1]+w,Q--),D=Q}}if(O(g[v][1])){var F=g[v][1].charAt(0);g[v][1]=g[v][1].slice(1),w+=F,N+=F}}if(v<g.length-1&&!g[v][1]){g.splice(v,1);break}if(w.length>0||N.length>0){w.length>0&&N.length>0&&(L=a(N,w),L!==0&&(D>=0?g[D][1]+=N.substring(0,L):(g.splice(0,0,[n,N.substring(0,L)]),v++),N=N.substring(L),w=w.substring(L)),L=c(N,w),L!==0&&(g[v][1]=N.substring(N.length-L)+g[v][1],N=N.substring(0,N.length-L),w=w.substring(0,w.length-L)));var z=T+M;w.length===0&&N.length===0?(g.splice(v-z,z),v=v-z):w.length===0?(g.splice(v-z,z,[t,N]),v=v-z+1):N.length===0?(g.splice(v-z,z,[e,w]),v=v-z+1):(g.splice(v-z,z,[e,w],[t,N]),v=v-z+2)}v!==0&&g[v-1][0]===n?(g[v-1][1]+=g[v][1],g.splice(v,1)):v++,T=0,M=0,w="",N="";break}}g[g.length-1][1]===""&&g.pop();var le=!1;for(v=1;v<g.length-1;)g[v-1][0]===n&&g[v+1][0]===n&&(g[v][1].substring(g[v][1].length-g[v-1][1].length)===g[v-1][1]?(g[v][1]=g[v-1][1]+g[v][1].substring(0,g[v][1].length-g[v-1][1].length),g[v+1][1]=g[v-1][1]+g[v+1][1],g.splice(v-1,1),le=!0):g[v][1].substring(0,g[v+1][1].length)==g[v+1][1]&&(g[v-1][1]+=g[v+1][1],g[v][1]=g[v][1].substring(g[v+1][1].length)+g[v+1][1],g.splice(v+1,1),le=!0)),v++;le&&B(g,P)}function x(g){return g>=55296&&g<=56319}function Y(g){return g>=56320&&g<=57343}function O(g){return Y(g.charCodeAt(0))}function R(g){return x(g.charCodeAt(g.length-1))}function b(g){for(var P=[],v=0;v<g.length;v++)g[v][1].length>0&&P.push(g[v]);return P}function y(g,P,v,M){return R(g)||O(M)?null:b([[n,g],[e,P],[t,v],[n,M]])}function $(g,P,v){var M=typeof v=="number"?{index:v,length:0}:v.oldRange,T=typeof v=="number"?null:v.newRange,w=g.length,N=P.length;if(M.length===0&&(T===null||T.length===0)){var L=M.index,D=g.slice(0,L),F=g.slice(L),Q=T?T.index:null;e:{var z=L+N-w;if(Q!==null&&Q!==z||z<0||z>N)break e;var le=P.slice(0,z),ue=P.slice(z);if(ue!==F)break e;var S=Math.min(L,z),U=D.slice(0,S),G=le.slice(0,S);if(U!==G)break e;var V=D.slice(S),j=le.slice(S);return y(U,V,j,F)}e:{if(Q!==null&&Q!==L)break e;var W=L,le=P.slice(0,W),ue=P.slice(W);if(le!==D)break e;var ee=Math.min(w-W,N-W),te=F.slice(F.length-ee),k=ue.slice(ue.length-ee);if(te!==k)break e;var V=F.slice(0,F.length-ee),j=ue.slice(0,ue.length-ee);return y(D,V,j,te)}}if(M.length>0&&T&&T.length===0)e:{var U=g.slice(0,M.index),te=g.slice(M.index+M.length),S=U.length,ee=te.length;if(N<S+ee)break e;var G=P.slice(0,S),k=P.slice(N-ee);if(U!==G||te!==k)break e;var V=g.slice(S,w-ee),j=P.slice(S,N-ee);return y(U,V,j,te)}return null}function H(g,P,v,M){return r(g,P,v,M,!0)}return H.INSERT=t,H.DELETE=e,H.EQUAL=n,Go=H,Go}var LC=MC();const Vo=mt(LC);function DC(e){var h,d,m;const{rangeId:t,segmentId:n,documentDataModel:r,insert:s}=e,i=(d=(h=r.getSelfOrHeaderFooterModel(n).getBody())==null?void 0:h.customRanges)==null?void 0:d.find(_=>_.rangeId===t);if(!i)return!1;const{startIndex:o,endIndex:a}=i,l=new Me,c=a-o+1;l.push({t:J.RETAIN,len:o}),l.push({t:J.RETAIN,len:c,body:{dataStream:"",customRanges:[]}}),s&&l.push({t:J.INSERT,body:s,len:s.dataStream.length});const u=a+1+((m=s==null?void 0:s.dataStream.length)!=null?m:0);return l.selections=[{startOffset:u,endOffset:u,collapsed:!0}],l}function UC(e){const{ranges:t,rangeId:n,rangeType:r,wholeEntity:s,properties:i,body:o}=e;let a=0;const l=new Me;let c=!1;return t.forEach(u=>{var x,Y,O;const h=NC(u,o);if(!h||!o)return!1;const{startOffset:d,endOffset:m}=h,_=(x=o.customRanges)!=null?x:[],p=(R,b,y)=>{var v,M,T,w;const $=ph(R,b,_,r),H=Math.min((M=(v=$[0])==null?void 0:v.startIndex)!=null?M:1/0,R),g=Math.max((w=(T=$[$.length-1])==null?void 0:T.endIndex)!=null?w:-1/0,b),P={rangeId:y?`${n}$${y}`:n,rangeType:r,startIndex:0,endIndex:g-H,wholeEntity:s,properties:{...i}};l.push({t:J.RETAIN,len:H-a}),l.push({t:J.RETAIN,len:g-H+1,body:{dataStream:"",customRanges:[P]},coverType:Ce.COVER}),a=g+1},I=((Y=o.paragraphs)!=null?Y:[]).filter(R=>R.startIndex<m&&R.startIndex>d),A=((O=o.customBlocks)!=null?O:[]).filter(R=>R.startIndex<m&&R.startIndex>d);yC([d,m-1],[...I.map(R=>R.startIndex),...A.map(R=>R.startIndex)]).forEach(([R,b],y)=>p(R,b,y)),c=!0,l.selections=[{startOffset:h.endOffset,endOffset:h.endOffset,collapsed:!0}]}),c?l:!1}function Ch(e,t,n=0,r=null,s=!0){e.sort((c,u)=>c.startOffset-u.startOffset);const i=[],{paragraphs:o=[]}=t,a=o==null?void 0:o.find(c=>c.startIndex>=e[0].startOffset&&c.startIndex<e[0].endOffset);let l=n;if(e.forEach(c=>{const{startOffset:u,endOffset:h}=c;u>l&&(i.push({t:J.RETAIN,len:u-l}),l=u),l<h&&(i.push({t:J.DELETE,len:h-l}),l=h)}),r&&i.push({t:J.INSERT,body:r,len:r.dataStream.length}),a&&s){const c=o.find(u=>u.startIndex-n>=e[e.length-1].endOffset-1);c&&(c.startIndex>l&&(i.push({t:J.RETAIN,len:c.startIndex-l}),l=c.startIndex),i.push({t:J.RETAIN,len:1,body:{dataStream:"",paragraphs:[{...c,startIndex:0,bullet:a==null?void 0:a.bullet}]},coverType:Ce.REPLACE}))}return i}function PC(e,t,n=0){const r=[];let s=n;return e.forEach(i=>{const{startOffset:o,endOffset:a}=i;o>s&&(r.push({t:J.RETAIN,len:o-s}),s=o),a>s&&(r.push({t:J.RETAIN,len:a-s,body:{...Z.deepClone(t),dataStream:""}}),s=a)}),r}const kC=e=>{var h;const{selection:t,body:n,doc:r}=e,s=t.segmentId,i=(h=r.getSelfOrHeaderFooterModel(s))==null?void 0:h.getBody();if(!i)return!1;const o=t.collapsed?null:bt(i,t.startOffset,t.endOffset),a=Vo(o?o.dataStream:"",n.dataStream);let l=0;const c=a.map(([d,m])=>{switch(d){case 0:{const _={t:J.RETAIN,body:{...bt(n,l,l+m.length,!1),dataStream:""},len:m.length};return l+=m.length,_}case 1:{const _={t:J.INSERT,body:bt(n,l,l+m.length),len:m.length};return l+=m.length,_}default:return{t:J.DELETE,len:m.length}}}),u=new Me;return u.push({t:J.RETAIN,len:t.startOffset}),u.push(...c),u};function FC(e,t){return!!((e==null?void 0:e.length)===(t==null?void 0:t.length)&&(e!=null&&e.every((n,r)=>JSON.stringify(n)===JSON.stringify(t==null?void 0:t[r]))))}const xC=e=>{var d;const{selection:t,body:n,doc:r,themeService:s}=e,i=t.segmentId,o=(d=r.getSelfOrHeaderFooterModel(i))==null?void 0:d.getBody();if(!o)return!1;const a=t.collapsed?null:bt(o,t.startOffset,t.endOffset),l=Vo(a?a.dataStream:"",n.dataStream);let c=0;const u=l.map(([m,_])=>{switch(m){case 0:{const p=Ks(n,c,c+_.length,!1),I=Ks(a,c,c+_.length,!1),A={t:J.RETAIN,body:FC(p,I)?void 0:{textRuns:p==null?void 0:p.map(B=>{var x,Y,O,R,b,y,$;return{...B,ts:{...B.ts,cl:(O=(Y=(x=B.ts)==null?void 0:x.cl)==null?void 0:Y.rgb)!=null&&O.includes(".")?{rgb:s.getColorFromTheme((y=(b=(R=B.ts)==null?void 0:R.cl)==null?void 0:b.rgb)!=null?y:"")}:($=B.ts)==null?void 0:$.cl}}}),dataStream:""},len:_.length};return c+=_.length,A}case 1:{const p={t:J.INSERT,body:bt(n,c,c+_.length),len:_.length};return c+=_.length,p}default:return{t:J.DELETE,len:_.length}}});if(u.every(m=>m.t===J.RETAIN&&!m.body))return!1;const h=new Me;return h.push({t:J.RETAIN,len:t.startOffset}),h.push(...u),h};function BC(e,t){const n=[],{customBlocks:r=[]}=e;for(const s of t){const{startOffset:i,endOffset:o}=s;if(!(i==null||o==null))for(const a of r){const{startIndex:l}=a;l>=i&&l<o&&n.push(a.blockId)}}return n}function $C(e,t=""){if(!t)return["body"];const{headers:n,footers:r}=e.getSnapshot();if(n==null&&r==null)throw new Error("Document data model must have headers or footers when update by segment id");if((n==null?void 0:n[t])!=null)return["headers",t,"body"];if((r==null?void 0:r[t])!=null)return["footers",t,"body"];throw new Error("Segment id not found in headers or footers")}const HC=e=>{var p,I,A,B;const{selection:t,documentDataModel:n,drawings:r}=e,{collapsed:s,startOffset:i,segmentId:o}=t,a=new Me,l=Wt.getInstance(),c=[],u=n.getSelfOrHeaderFooterModel(o).getBody();if(!u)return!1;const h=(I=(p=n.getSnapshot().drawingsOrder)==null?void 0:p.length)!=null?I:0;let d=0;if(s)i>0&&a.push({t:J.RETAIN,len:i});else{const x=Ch([t],u,0,null,!1);a.push(...x);const Y=BC(u,[t]),O=(A=n.getDrawings())!=null?A:{},R=(B=n.getDrawingsOrder())!=null?B:[],b=Y.sort((y,$)=>R.indexOf(y)>R.indexOf($)?-1:R.indexOf(y)<R.indexOf($)?1:0);if(b.length>0)for(const y of b){const $=O[y],H=R.indexOf(y);if($==null||H<0)continue;const g=l.removeOp(["drawings",y],$),P=l.removeOp(["drawingsOrder",H],y);c.push(g),c.push(P),d++}}a.push({t:J.INSERT,body:{dataStream:"\b".repeat(r.length),customBlocks:r.map((x,Y)=>({startIndex:Y,blockId:x.drawingId}))},len:r.length});const m=$C(n,o),_=l.editOp(a.serialize(),m);c.push(_);for(const x of r){const{drawingId:Y}=x,O=l.insertOp(["drawings",Y],x),R=l.insertOp(["drawingsOrder",h-d],Y);c.push(O),c.push(R)}return c.reduce((x,Y)=>Wt.compose(x,Y),null)};function jC(e,t){if(typeof t>"u")return{startOffset:e,endOffset:e,collapsed:!0};if(t<e)throw new Error(`Cannot make a doc selection when endOffset ${t} is less than startOffset ${e}.`);return{startOffset:e,endOffset:t,collapsed:e===t}}function WC(e){const{startOffset:t,endOffset:n,collapsed:r}=e,s=Math.min(t,n),i=Math.max(t,n);return{startOffset:s,endOffset:i,collapsed:r}}function YC(e,t,n,r){return Math.max(e,n)<=Math.min(t,r)}function zo(e,t,n,r){const{startOffset:s,endOffset:i}=e,o=r!=null?r:Xo(t,n),a=[];let l=-1;for(let c=0;c<o.length;c++){const u=o[c],{startIndex:h}=u;(s>l&&s<=h||i>l&&i<=h||h>=s&&h<=i)&&a.push(u),l=h}return a}function Ko(e,t,n){const r=[],s=Xo(t,n);for(const i of e){const o=zo(i,t,n,s);r.push(...o)}return r}const GC=[lt.PARAGRAPH,lt.TABLE_START,lt.TABLE_END,lt.TABLE_ROW_START,lt.TABLE_CELL_START,lt.TABLE_CELL_END];function Xo(e,t){const n=[];for(let r=0;r<e.length;r++){const s=e[r],{startIndex:i}=s;let o=i-1;for(;!GC.includes(t[o])&&o>=0;)o--;n.push({...s,paragraphStart:o+1,paragraphEnd:s.startIndex})}return n}const VC=e=>{var h,d,m;const{paragraphs:t,segmentId:n,document:r}=e;let s=e.listType;const i=(d=(h=r.getSelfOrHeaderFooterModel(n).getBody())==null?void 0:h.paragraphs)!=null?d:[],o=t.every(_=>{var p;return((p=_.bullet)==null?void 0:p.listType.indexOf(s))===0});let l=tt(6);if(t.length===1){const _=i.indexOf(t[0]),p=i[_-1],I=i[_+1];p&&p.bullet&&p.bullet.listType.indexOf(s)===0?(l=p.bullet.listId,s!==Ft.CHECK_LIST&&(s=p.bullet.listType)):I&&I.bullet&&I.bullet.listType.indexOf(s)===0&&(l=I.bullet.listId,s!==Ft.CHECK_LIST&&(s=I.bullet.listType))}const c=new dn;c.reset();const u=new Me;for(const _ of t){const{startIndex:p,paragraphStyle:I={},bullet:A}=_;u.push({t:J.RETAIN,len:p-c.cursor}),u.push({t:J.RETAIN,len:1,body:{dataStream:"",paragraphs:[o?{paragraphStyle:I,startIndex:0}:{startIndex:0,paragraphStyle:{...I},bullet:{nestingLevel:(m=A==null?void 0:A.nestingLevel)!=null?m:0,textStyle:{fs:20},listType:s,listId:l}}]},coverType:Ce.REPLACE}),c.moveCursorTo(p+1)}return u},zC=e=>{var h;const{paragraphIndex:t,segmentId:n,document:r}=e,s=(h=r.getSelfOrHeaderFooterModel(n).getBody())==null?void 0:h.paragraphs;if(s==null)return!1;const i=s.find(d=>d.startIndex===t);if(!(i!=null&&i.bullet)||i.bullet.listType.indexOf(Ft.CHECK_LIST)===-1)return!1;const o=new dn;o.reset();const a=new Me,{startIndex:l,paragraphStyle:c={}}=i,u=i.bullet.listType===Ft.CHECK_LIST?Ft.CHECK_LIST_CHECKED:Ft.CHECK_LIST;return a.push({t:J.RETAIN,len:l-o.cursor}),a.push({t:J.RETAIN,len:1,body:{dataStream:"",paragraphs:[{...i,paragraphStyle:c,startIndex:0,bullet:{...i.bullet,listType:u}}]},coverType:Ce.REPLACE}),o.moveCursorTo(l+1),a},KC=e=>{var u,h;const{paragraphs:t,listType:n,segmentId:r,document:s}=e;if(((u=s.getSelfOrHeaderFooterModel(r).getBody())==null?void 0:u.paragraphs)==null)return!1;const a=tt(6),l=new dn;l.reset();const c=new Me;for(const d of t){const{startIndex:m,paragraphStyle:_={},bullet:p}=d;c.push({t:J.RETAIN,len:m-l.cursor}),c.push({t:J.RETAIN,len:1,body:{dataStream:"",paragraphs:[{startIndex:0,paragraphStyle:_,bullet:{nestingLevel:(h=p==null?void 0:p.nestingLevel)!=null?h:0,textStyle:(p==null?void 0:p.listType)===n?p.textStyle:{fs:20},listType:n,listId:a}}]},coverType:Ce.REPLACE}),l.moveCursorTo(m+1)}return c};function XC(e,t){return t.some(n=>e.startIndex>n.startIndex&&e.startIndex<n.endIndex)}const qC=e=>{var c,u,h;const{paragraphs:t,document:n,type:r}=e,s=new dn;s.reset();const i=new Me,o=(c=n.getSnapshot().lists)!=null?c:{},a=(h=(u=n.getBody())==null?void 0:u.tables)!=null?h:[],l={...Ur,...o};for(const d of t){const{startIndex:m,paragraphStyle:_={},bullet:p}=d,I=XC(d,a);if(i.push({t:J.RETAIN,len:m-s.cursor}),p){const A=p.listType;let B=l[A].nestingLevel.length-1;I&&(B=Math.min(B,2)),i.push({t:J.RETAIN,len:1,body:{dataStream:"",paragraphs:[{startIndex:0,paragraphStyle:{..._},bullet:{...p,nestingLevel:Math.max(Math.min(p.nestingLevel+r,B),0)}}]},coverType:Ce.REPLACE})}else i.push({t:J.RETAIN,len:1});s.moveCursorTo(m+1)}return i},ZC=e=>{var I,A,B,x;const{textRanges:t,segmentId:n,document:r,style:s,paragraphTextRun:i,cursor:o,deleteLen:a,textX:l}=e,c=r.getSelfOrHeaderFooterModel(n),u=(A=(I=c.getBody())==null?void 0:I.paragraphs)!=null?A:[],h=(x=(B=c.getBody())==null?void 0:B.dataStream)!=null?x:"",d=Ko(t,u,h),m=new dn;o&&m.moveCursorTo(o);const _=l!=null?l:new Me;d.sort((Y,O)=>Y.startIndex-O.startIndex);const p=Math.max(0,d[0].paragraphStart-1);p>m.cursor&&(_.push({t:J.RETAIN,len:p-m.cursor}),m.moveCursorTo(p)),a&&_.push({t:J.DELETE,len:a});for(const Y of d){const{startIndex:O,paragraphStyle:R={}}=Y,b=O-m.cursor;_.push({t:J.RETAIN,len:b,...i?{body:{dataStream:"",textRuns:[{ts:i,st:0,ed:b}]},coverType:Ce.REPLACE}:null}),_.push({t:J.RETAIN,len:1,body:{dataStream:"",paragraphs:[{startIndex:0,paragraphStyle:{...R,...s}}]},coverType:Ce.REPLACE}),m.moveCursorTo(O+1)}return _};class Je{}C(Je,"customRange",{add:UC,delete:DC,copyCustomRange:TC,getCustomRangesInterestsWithSelection:AC,isIntersecting:_h}),C(Je,"customDecoration",{add:wC,delete:bC}),C(Je,"selection",{replace:kC,makeSelection:jC,normalizeSelection:WC,delete:Ch,replaceTextRuns:xC,retain:PC}),C(Je,"range",{isIntersects:YC,getParagraphsInRange:zo,getParagraphsInRanges:Ko}),C(Je,"transform",{getPlainText:Xs,fromPlainText:OC,isEmptyDocument:SC}),C(Je,"paragraph",{bullet:{set:KC,switch:VC,toggleChecklist:zC,changeNestLevel:qC},style:{set:ZC},util:{transform:Xo,getParagraphsInRange:zo,getParagraphsInRanges:Ko}}),C(Je,"drawing",{add:HC});function JC(e,t,n,r){var c;if(t==="")return e;const s={id:"mock-id",body:e,documentStyle:{}},i=new At(s),o=t.length;let a;for(;(a=(r?i.getBody().dataStream:i.getBody().dataStream.toLowerCase()).indexOf(t))>=0;){const u=new Me,h=Wt.getInstance();if(a>0&&u.retain(a),n.length>0){const d=i.sliceBody(a,a+o),m={dataStream:n};if(Array.isArray(d==null?void 0:d.textRuns)&&d.textRuns.length&&(m.textRuns=[{...d.textRuns[0],st:0,ed:n.length}]),(c=d==null?void 0:d.customRanges)!=null&&c.length){const _=d.customRanges[0];m.customRanges=[{..._,startIndex:0,endIndex:n.length-1}]}u.insert(n.length,m)}u.delete(o),i.apply(h.editOp(u.serialize()))}const l=i.getBody();return i.dispose(),l}function QC(e){if(e.customRanges||(e.customRanges=[]),!e.paragraphs){e.paragraphs=[];for(let t=0;t<e.dataStream.length;t++)e.dataStream[t]==="\r"&&e.paragraphs.push({startIndex:t})}return e.customBlocks||(e.customBlocks=[]),e.textRuns||(e.textRuns=[]),e.customDecorations||(e.customDecorations=[]),e.sectionBreaks||(e.sectionBreaks=[]),e.tables||(e.tables=[]),e}function Rh(e){var t;return e.body=QC((t=e.body)!=null?t:{dataStream:""}),e.drawingsOrder||(e.drawingsOrder=[]),e.drawings||(e.drawings={}),e.documentStyle||(e.documentStyle={}),e}class Pr{constructor(t={}){C(this,"_style");this._style=t}static create(t={}){return new Pr(t)}get fontFamily(){return this._style.ff}get fontSize(){return this._style.fs}get italic(){return this._style.it===ae.TRUE}get bold(){return this._style.bl===ae.TRUE}get underline(){return this._style.ul&&sn.create(this._style.ul)}get bottomBorderLine(){return this._style.bbl&&sn.create(this._style.bbl)}get strikethrough(){return this._style.st&&sn.create(this._style.st)}get overline(){return this._style.ol&&sn.create(this._style.ol)}get background(){return this._style.bg}get border(){return this._style.bd}get color(){return this._style.cl}get verticalAlign(){return this._style.va}get numberFormat(){return this._style.n}copy(){return rn.create(Z.deepClone(this._style))}getValue(){return{...this._style}}}class rn extends Pr{static create(t={}){return new rn(t)}constructor(t={}){super(t)}setFontFamily(t){return this._style.ff=t,this}setFontSize(t){return this._style.fs=t,this}setItalic(t){return this._style.it=t?1:0,this}setBold(t){return this._style.bl=t?1:0,this}setUnderline(t){return this._style.ul=t.build(),this}setBottomBorderLine(t){return this._style.bbl=t.build(),this}setStrikethrough(t){return this._style.st=t.build(),this}setOverline(t){return this._style.ol=t.build(),this}setBackground(t){return this._style.bg=t,this}setBorder(t){return this._style.bd=t,this}setColor(t){return this._style.cl=t,this}setVerticalAlign(t){return this._style.va=t,this}copy(){return rn.create(Z.deepClone(this._style))}build(){return this.getValue()}}class sn{constructor(t={s:1}){C(this,"_decoration");this._decoration=t}static create(t={s:1}){return new sn(t)}get show(){return this._decoration.s===ae.TRUE}get followFontColor(){return this._decoration.c===ae.TRUE}get color(){return this._decoration.cl}get type(){return this._decoration.t}setShow(t){return this._decoration.s=t?1:0,this}setFollowFontColor(t){return this._decoration.c=t?1:0,this}setColor(t){return this._decoration.cl=t,this}setLineType(t){return this._decoration.t=t,this}copy(){return sn.create(Z.deepClone(this._decoration))}build(){return{...this._decoration}}}class kr{constructor(t={}){C(this,"_style");this._style=t}static create(t={}){return new kr(t)}get indentFirstLine(){return this._style.indentFirstLine}get hanging(){return this._style.hanging}get indentStart(){return this._style.indentStart}get tabStops(){return this._style.tabStops}get indentEnd(){return this._style.indentEnd}get textStyle(){return this._style.textStyle}get headingId(){return this._style.headingId}get namedStyleType(){return this._style.namedStyleType}get horizontalAlign(){return this._style.horizontalAlign}get lineSpacing(){return this._style.lineSpacing}get direction(){return this._style.direction}get spacingRule(){return this._style.spacingRule}get snapToGrid(){return this._style.snapToGrid}get spaceAbove(){return this._style.spaceAbove}get spaceBelow(){return this._style.spaceBelow}get borderBetween(){return this._style.borderBetween}get borderTop(){return this._style.borderTop}get borderBottom(){return this._style.borderBottom}get borderLeft(){return this._style.borderLeft}get borderRight(){return this._style.borderRight}get keepLines(){return this._style.keepLines===ae.TRUE}get keepNext(){return this._style.keepNext===ae.TRUE}get wordWrap(){return this._style.wordWrap===ae.TRUE}get widowControl(){return this._style.widowControl===ae.TRUE}get shading(){return this._style.shading}get suppressHyphenation(){return this._style.suppressHyphenation===ae.TRUE}copy(){return Fr.create(Z.deepClone(this._style))}getValue(){return this._style}}class Fr extends kr{static create(t={}){return new Fr(t)}constructor(t={}){super(t)}setIndentFirstLine(t){return this._style.indentFirstLine=t,this}setHanging(t){return this._style.hanging=t,this}setIndentStart(t){return this._style.indentStart=t,this}setTabStops(t){return this._style.tabStops=t,this}setIndentEnd(t){return this._style.indentEnd=t,this}setTextStyle(t){return this._style.textStyle=t,this}setHeadingId(t){return this._style.headingId=t,this}setNamedStyleType(t){return this._style.namedStyleType=t,this}setHorizontalAlign(t){return this._style.horizontalAlign=t,this}setLineSpacing(t){return this._style.lineSpacing=t,this}setDirection(t){return this._style.direction=t,this}setSpacingRule(t){return this._style.spacingRule=t,this}setSnapToGrid(t){return this._style.snapToGrid=t?1:0,this}setSpaceAbove(t){return this._style.spaceAbove=t,this}setSpaceBelow(t){return this._style.spaceBelow=t,this}setBorderBetween(t){return this._style.borderBetween=t,this}setBorderTop(t){return this._style.borderTop=t,this}setBorderBottom(t){return this._style.borderBottom=t,this}setBorderLeft(t){return this._style.borderLeft=t,this}setBorderRight(t){return this._style.borderRight=t,this}setKeepLines(t){return this._style.keepLines=t?1:0,this}setKeepNext(t){return this._style.keepNext=t?1:0,this}setWordWrap(t){return this._style.wordWrap=t?1:0,this}setWidowControl(t){return this._style.widowControl=t?1:0,this}setShading(t){return this._style.shading=t,this}setSuppressHyphenation(t){return this._style.suppressHyphenation=t?1:0,this}copy(){return Fr.create(Z.deepClone(this._style))}build(){return this.getValue()}}class on{constructor(t){C(this,"_data");if(!t.body)throw new Error("Invalid document data, body is required");this._data=Rh(t)}static create(t){return new on(t)}static createByBody(t){return new on({body:t,id:"d",documentStyle:{}})}copy(){return In.create(Z.deepClone(this._data))}slice(t,n){const{body:r,...s}=this._data;return In.create({...Z.deepClone(s),body:bt(r,t,n)})}toPlainText(){var t,n;return Je.transform.getPlainText((n=(t=this._data.body)==null?void 0:t.dataStream)!=null?n:"").replaceAll("\r",`
`)}getParagraphStyle(){var t,n;return kr.create((n=(t=this._data.body)==null?void 0:t.paragraphs)==null?void 0:n[0].paragraphStyle)}getParagraphBullet(){var t,n;return(n=(t=this._data.body)==null?void 0:t.paragraphs)==null?void 0:n[0].bullet}getParagraphs(){var r,s;const t=(s=(r=this._data.body)==null?void 0:r.paragraphs)!=null?s:[];let n=0;return t.map(i=>{const o=this.slice(n,i.startIndex);return n=i.startIndex,o})}getTextRuns(){var t,n;return((n=(t=this._data.body)==null?void 0:t.textRuns)!=null?n:[]).map(r=>({...r,ts:r.ts?Pr.create(r.ts):null}))}getLinks(){var t,n,r;return(r=(n=(t=this._data.body)==null?void 0:t.customRanges)==null?void 0:n.filter(s=>s.rangeType===Jt.HYPERLINK))!=null?r:[]}getData(){return this._data}}class In extends on{constructor(n){super(n);C(this,"_doc");this._doc=new At(n)}static newEmptyData(){return Rh({id:"d",documentStyle:{},drawings:{},drawingsOrder:[],body:{dataStream:`\r
`,customBlocks:[],customRanges:[],paragraphs:[{startIndex:0}],textRuns:[],tables:[],sectionBreaks:[]}})}static create(n){return new In(n!=null?n:In.newEmptyData())}insertText(n,r,s){var u,h;let i=((h=(u=this._data.body)==null?void 0:u.dataStream.length)!=null?h:2)-2,o,a;if(typeof n=="string"?o=n:(i=Math.min(n,i),o=r),typeof r=="object"?a=r instanceof rn?r.build():r:a=s instanceof rn?s.build():s,!o)return this;const l={dataStream:o,textRuns:a?[{ts:a,st:i,ed:i+o.length}]:[]},c=Je.selection.replace({doc:this._doc,selection:{startOffset:i,endOffset:i,collapsed:!0},body:l});if(!c)throw new Error("Insert text failed, please check.");return Me.apply(this._doc.getBody(),c.serialize()),this}insertRichText(n,r){var a,l;let s=((l=(a=this._data.body)==null?void 0:a.dataStream.length)!=null?l:2)-2,i;typeof n=="object"?i=n instanceof on?n.getData():n:(s=Math.min(n,s),i=r instanceof on?r.getData():r);const o=Je.selection.replace({doc:this._doc,selection:{startOffset:s,endOffset:s,collapsed:!0},body:i.body});if(!o)throw new Error("Insert text failed, please check.");return Me.apply(this._doc.getBody(),o.serialize()),this}delete(n,r){if(r!==void 0){if(!r)return this;const s=Je.selection.delete([{startOffset:n,endOffset:n+r,collapsed:!0}],this._data.body);Me.apply(this._doc.getBody(),s)}return this}setStyle(n,r,s){const i={dataStream:"",textRuns:[{ts:s instanceof rn?s.build():s,st:0,ed:r-n}]},o=Je.selection.retain([{startOffset:n,endOffset:r,collapsed:!0}],i);return Me.apply(this._doc.getBody(),o),this}setLink(n,r,s){const i=Je.customRange.add({rangeType:Jt.HYPERLINK,rangeId:tt(),properties:{url:s},ranges:[{startOffset:n,endOffset:r,collapsed:!1}],body:this._data.body});if(!i)throw new Error("Insert text failed, please check.");return Me.apply(this._doc.getBody(),i.serialize()),this}cancelLink(n,r){if(typeof n=="string"){const s=Je.customRange.delete({rangeId:n,documentDataModel:this._doc});if(!s)throw new Error("Insert text failed, please check.");Me.apply(this._doc.getBody(),s.serialize())}else this.slice(n,r).getLinks().forEach(i=>{const o=Je.customRange.delete({rangeId:i.rangeId,documentDataModel:this._doc});if(!o)throw new Error("Insert text failed, please check.");Me.apply(this._doc.getBody(),o.serialize())});return this}updateLink(n,r){var i,o;const s=(o=(i=this._data.body)==null?void 0:i.customRanges)==null?void 0:o.find(a=>a.rangeId===n);if(!s)throw new Error("Link not found");return s.properties.url=r,this}insertParagraph(n,r){var o,a;let s,i;return typeof n=="object"?(s={dataStream:"\r",paragraphs:[{startIndex:0,paragraphStyle:n.build()}]},i=((a=(o=this._data.body)==null?void 0:o.dataStream.length)!=null?a:2)-2):(i=n,s={dataStream:"\r",paragraphs:[{startIndex:0,paragraphStyle:r==null?void 0:r.build()}]}),this.insertRichText(i,on.create({body:s,id:"d",documentStyle:{}})),this}insertLink(n,r,s){let i="",o="";typeof n=="string"?(i=n,o=r):(i=r,o=s);const a=In.createByBody({dataStream:i,customRanges:[{rangeType:Jt.HYPERLINK,rangeId:tt(),properties:{url:o},startIndex:0,endIndex:i.length-1}]});return typeof n=="number"?this.insertRichText(n,a):this.insertRichText(a)}}const eR="__default_document_sub_component_id20231101__";class Ih{constructor(){C(this,"skipNextObservers",!1);C(this,"lastReturnValue");C(this,"isStopPropagation",!1)}stopPropagation(){this.isStopPropagation=!0}}class tR extends oe.Subject{constructor(){super(...arguments);C(this,"_sortedObservers",[])}subscribe(){throw new Error("[EventSubject]: please use `subscribeEvent` instead of `subscribe` method for `EventSubject`.")}next(){throw new Error("[EventSubject]: please use `emitEvent` instead of `next` method for `EventSubject`.")}unsubscribe(){super.unsubscribe(),this._sortedObservers.length=0}complete(){super.complete(),this._sortedObservers.length=0}subscribeEvent(n){let r;typeof n=="function"?r={next:([i,o])=>n(i,o)}:r=n;const s=super.subscribe(r);return this._sortedObservers.push(r),this._sortedObservers.sort((i,o)=>{var a,l;return((a=i.priority)!=null?a:0)-((l=o.priority)!=null?l:0)}),s.add(()=>this._sortedObservers=this._sortedObservers.filter(i=>i!==r)),s}clearObservers(){this._sortedObservers.forEach(n=>{var r;return(r=n.complete)==null?void 0:r.call(n)}),this._sortedObservers.length=0}emitEvent(n){var r;if(!this.closed){const s=new Ih;s.lastReturnValue=n;for(const i of this._sortedObservers){const o=(r=i.next)==null?void 0:r.call(i,[n,s]);if(s.lastReturnValue=o,s.skipNextObservers)return{handled:!0,lastReturnValue:s.lastReturnValue,stopPropagation:s.isStopPropagation}}return{handled:this._sortedObservers.length>0,lastReturnValue:s.lastReturnValue,stopPropagation:s.isStopPropagation}}throw new Error("[EventSubject]: cannot emit event on a closed subject.")}}function nR(e){return new oe.Observable(t=>{const n=e.subscribeEvent(r=>{t.next(r)});return()=>n.unsubscribe()})}const qs=Re.createIdentifier("core.resource-manager.service"),qo={[Dt.Editor]:"Editor",[Dt.Owner]:"Owner",[Dt.Reader]:"Reader",[Dt.UNRECOGNIZED]:"UNRECOGNIZED"},Zs=e=>e?{userID:`${qo[e]}_${tt(8)}`,name:qo[e],avatar:""}:{userID:"",name:"",avatar:"",anonymous:!0,canBindAnonymous:!1},rR=(e,t)=>e.startsWith(qo[t]);class xr extends ze{constructor(){super(...arguments);C(this,"_model",new Map);C(this,"_userChange$",new oe.Subject);C(this,"userChange$",this._userChange$.asObservable());C(this,"_currentUser$",new oe.BehaviorSubject(Zs()));C(this,"currentUser$",this._currentUser$.asObservable())}dispose(){super.dispose(),this._model.clear(),this._userChange$.complete(),this._currentUser$.complete()}getCurrentUser(){return this._currentUser$.getValue()}setCurrentUser(n){this.addUser(n),this._currentUser$.next(n)}addUser(n){this._model.set(n.userID,n),this._userChange$.next({type:"add",user:n})}getUser(n,r){const s=this._model.get(n);if(s)return s;r&&r()}delete(n){const r=this.getUser(n);this._model.delete(n),r&&this._userChange$.next({type:"delete",user:r})}clear(){this._model.clear(),this._userChange$.next({type:"clear"})}list(){return Array.from(this._model.values())}}var sR=Object.getOwnPropertyDescriptor,iR=(e,t,n,r)=>{for(var s=r>1?void 0:r?sR(t,n):t,i=e.length-1,o;i>=0;i--)(o=e[i])&&(s=o(s)||s);return s},Sh=(e,t)=>(n,r)=>t(n,r,e);f.AuthzIoLocalService=class{constructor(t,n){C(this,"_permissionMap",new Map([]));this._resourceManagerService=t,this._userManagerService=n,this._initSnapshot(),this._initDefaultUser()}_initDefaultUser(){const t=this._userManagerService.getCurrentUser();t&&t.userID||this._userManagerService.setCurrentUser(Zs(Dt.Owner))}_getRole(t){const n=this._userManagerService.getCurrentUser();return n?rR(n.userID,t):!1}_initSnapshot(){this._resourceManagerService.registerPluginResource({toJson:t=>{const n=[...this._permissionMap.keys()].reduce((r,s)=>{const i=this._permissionMap.get(s);return r[s]=i,r},{});return JSON.stringify(n)},parseJson:t=>JSON.parse(t),pluginName:"SHEET_AuthzIoMockService_PLUGIN",businesses:[ve.UNIVER_SHEET,ve.UNIVER_DOC,ve.UNIVER_SLIDE],onLoad:(t,n)=>{for(const r in n)this._permissionMap.set(r,n[r])},onUnLoad:()=>{this._permissionMap.clear()}})}async create(t){return tt(8)}async allowed(t){return Promise.resolve([])}async batchAllowed(t){return Promise.resolve([])}async list(t){const n=[];return t.objectIDs.forEach(r=>{const s=this._permissionMap.get(r);if(s){const i={objectID:r,unitID:t.unitID,objectType:s.objectType,name:s.name,shareOn:!1,shareRole:Dt.Owner,shareScope:-1,scope:{read:Oi.AllCollaborator,edit:Oi.AllCollaborator},creator:Zs(Dt.Owner),strategies:[{action:6,role:1},{action:16,role:1},{action:17,role:1},{action:18,role:1},{action:19,role:1},{action:33,role:1},{action:34,role:1},{action:35,role:1},{action:36,role:1},{action:37,role:1},{action:38,role:1},{action:39,role:1},{action:40,role:1}],actions:t.actions.map(o=>({action:o,allowed:this._getRole(Dt.Owner)||this._getRole(Dt.Editor)}))};n.push(i)}}),n}async listCollaborators(){return[]}async listRoles(){return{roles:[],actions:[]}}async deleteCollaborator(){}async update(t){}async updateCollaborator(){}async createCollaborator(){}async putCollaborators(t){}},f.AuthzIoLocalService=iR([Sh(0,qs),Sh(1,Re.Inject(xr))],f.AuthzIoLocalService);const Oh=Re.createIdentifier("IAuthzIoIoService"),Zo=Re.createIdentifier("univer.config-service");class vh{constructor(){C(this,"_configChanged$",new oe.Subject);C(this,"configChanged$",this._configChanged$.asObservable());C(this,"_config",new Map)}dispose(){this._config.clear(),this._configChanged$.complete()}getConfig(t){return this._config.get(t)}setConfig(t,n,r){var o;const{merge:s=!1}=r||{};let i=(o=this._config.get(t))!=null?o:{};s?i=rs(i,n):i=n,this._config.set(t,i),this._configChanged$.next({[t]:i})}deleteConfig(t){return this._config.delete(t)}subscribeConfigValue$(t){return new oe.Observable(n=>{Object.prototype.hasOwnProperty.call(this._config,t)&&n.next(this._config.get(t));const r=this.configChanged$.pipe(oe.filter(s=>Object.prototype.hasOwnProperty.call(s,t))).subscribe(s=>n.next(s[t]));return()=>r.unsubscribe()})}}const Br="FOCUSING_UNIT",Kn="FOCUSING_SHEET",$r="FOCUSING_DOC",Hr="FOCUSING_SLIDE",oR="FOCUSING_EDITOR_BUT_HIDDEN",wh="EDITOR_ACTIVATED",aR="FOCUSING_EDITOR_INPUT_FORMULA",bh="FOCUSING_FX_BAR_EDITOR",lR="FOCUSING_UNIVER_EDITOR",cR="FOCUSING_EDITOR_INPUT_FORMULA",uR="FOCUSING_PANEL_EDITOR",hR="FOCUSING_UNIVER_EDITOR_STANDALONE_SINGLE_MODE",dR="FOCUSING_COMMON_DRAWINGS",fR="FORMULA_EDITOR_ACTIVATED";class Ah extends ze{constructor(){super(...arguments);C(this,"_error$",new oe.Subject);C(this,"error$",this._error$.asObservable())}dispose(){this._error$.complete()}emit(n){this._error$.next({errorKey:n})}}var Jo=(e=>(e.URL="URL",e.UUID="UUID",e.BASE64="BASE64",e))(Jo||{}),Th=(e=>(e.SUCCUSS="0",e.ERROR_EXCEED_SIZE="1",e.ERROR_IMAGE_TYPE="2",e.ERROR_UPLOAD_COUNT_LIMIT="3",e.ERROR_IMAGE="4",e))(Th||{});const Qo=Re.createIdentifier("core.image-io.service"),mR={version:"0.11.0"};function gR(e="",t=lr.ZH_CN,n=""){return{id:e,sheetOrder:[],name:n,appVersion:mR.version,locale:t,styles:{},sheets:{},resources:[]}}class yh{constructor(t={}){C(this,"_styles");C(this,"_cacheMap",new _r(1e5));this._styles=t,this._generateCacheMap()}each(t){return Object.entries(this._styles).forEach(t),this}search(t,n){if(this._cacheMap.has(n))return this._cacheMap.get(n);const r=this._getExistingStyleId(t);return r||"-1"}get(t){return typeof t!="string"?t:(t=String(t),this._styles[t])}add(t,n){const r=tt(6);return this._styles[r]=t,this._cacheMap.set(n,r),r}setValue(t){if(t==null)return;const n=JSON.stringify(t),r=this.search(t,n);return r!=="-1"?r:this.add(t,n)}addCustomStyle(t,n){n!=null&&(this._styles[t]=n,this._cacheMap.set(JSON.stringify(n),t))}remove(t){this._styles[t]&&(delete this._styles[t],this._cacheMap.delete(JSON.stringify(this._styles[t])))}toJSON(){return this._styles}getStyleByCell(t){let n;t&&Z.isObject(t.s)?n=t.s:n=(t==null?void 0:t.s)&&this.get(t.s);const r=t==null?void 0:t.interceptorStyle;return r?{...n,...r}:n}_generateCacheMap(){const{_styles:t,_cacheMap:n}=this;for(const r in t){const s=JSON.stringify(t[r]);n.set(s,r)}}_getExistingStyleId(t){const{_styles:n}=this;for(const r in n)if(Z.diffValue(n[r],t))return r;return null}}const _R=(e,t)=>t.length===e.length&&!e.some(n=>t.some(r=>!nn.equals(r,n))),pR=(e,t)=>t.length===e.length&&e.every((n,r)=>{const s=t[r];return s.unitId===n.unitId&&s.sheetId===n.sheetId&&nn.equals(n.range,s.range)}),ea={t:0,b:2,l:2,r:2},ER=e=>({sbr:.6,sbo:e,spr:.6,spo:e}),Nh=90;function jr(e,t,n={}){const r=e.length,{textRotation:s,paddingData:i,horizontalAlign:o=vt.UNSPECIFIED,verticalAlign:a=fn.UNSPECIFIED,wrapStrategy:l=mn.UNSPECIFIED,cellValueType:c}=n,{t:u,r:h,b:d,l:m}=i||ea,{vertexAngle:_,centerAngle:p}=Ph(s),I={id:"d",body:{dataStream:`${e}${pa}`,textRuns:[{ts:t,st:0,ed:r}],paragraphs:[{startIndex:r,paragraphStyle:{horizontalAlign:o}}],sectionBreaks:[{startIndex:r+1}]},documentStyle:{pageSize:{width:Number.POSITIVE_INFINITY,height:Number.POSITIVE_INFINITY},marginTop:u,marginBottom:d,marginRight:h,marginLeft:m,renderConfig:{horizontalAlign:o,verticalAlign:a,centerAngle:p,vertexAngle:_,wrapStrategy:l,cellValueType:c}},drawings:{},drawingsOrder:[]};return new At(I)}function CR(e){if(!e)return{};const{tr:t,td:n,ht:r,vt:s,tb:i,pd:o}=e;return{textRotation:t,textDirection:n,horizontalAlign:r,verticalAlign:s,wrapStrategy:i,paddingData:o}}function Mh(e){if(!e)return{};const{ff:t,fs:n,it:r,bl:s,ul:i,st:o,ol:a,cl:l,bg:c}=e,u={};return t&&(u.ff=t),n&&(u.fs=n),r&&(u.it=r),s&&(u.bl=s),i&&(u.ul=i),o&&(u.st=o),a&&(u.ol=a),l&&(u.cl=l),c&&(u.bg=c),u}function Lh(e,t,n){var i;const r=e.getBody();if((i=r.customRanges)!=null&&i.some(o=>o.rangeType===Jt.HYPERLINK))return;const s=Je.customRange.add({ranges:[{startOffset:0,endOffset:r.dataStream.length-1,collapsed:!1}],rangeId:n,rangeType:Jt.HYPERLINK,body:r,properties:{url:t,refId:n}});s&&Me.apply(r,s.serialize())}function Dh(e){return e!=null}const RR='"Helvetica Neue", Helvetica, Arial, "PingFang SC", "Hiragino Sans GB", "Heiti SC", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif';function Uh(e){const t=st.ff,n=st.fs;if(!e){const h=`${n}pt  ${t}`;return{fontCache:h,fontString:h,fontSize:n,originFontSize:n,fontFamily:t}}let r=Mn.ITALIC;(e.it===0||e.it===void 0)&&(r=Mn.NORMAL);let s=Mn.BOLD;(e.bl===0||e.bl===void 0)&&(s=Mn.NORMAL);let i=n;e.fs&&(i=Math.ceil(e.fs));let o=t;if(e.ff){let h=e.ff;h=h.replace(/"/g,"").replace(/'/g,""),h.indexOf(" ")>-1&&(h=`"${h}"`),h==null&&(h=t),o=h}const{va:a}=e;let l=i;if(a===Ht.SUBSCRIPT||a===Ht.SUPERSCRIPT){const h=IR(o,l),{sbr:d,spr:m}=h;l*=a===Ht.SUBSCRIPT?d:m}const c=`${r} ${s} ${l}pt ${o}`,u=`${c}, ${RR} `;return{fontCache:c,fontString:u,fontSize:l,originFontSize:i,fontFamily:o}}function IR(e,t){return ER(t)}function Ph(e){const{a:t=0,v:n=ae.FALSE}=e||{a:0,v:ae.FALSE};let r=0,s=t;return n===ae.TRUE&&(r=Nh,s=Nh),{centerAngle:r,vertexAngle:s}}class SR{constructor(t,n){C(this,"_columnData",{});this._config=t,this._columnData=n}getColumnData(){return this._columnData}getColVisible(t){const{_columnData:n}=this,r=n[t];return r?r.hd!==ae.TRUE:!0}getColumnStyle(t){var n;return(n=this._columnData[t])==null?void 0:n.s}setColumnStyle(t,n){const r=this.getColumnOrCreate(t);r.s=n}getHiddenCols(t=0,n=this.getSize()-1){const r=[];let s=!1,i=-1;for(let o=t;o<=n;o++){const a=this.getColVisible(o);s&&a?(s=!1,r.push({rangeType:pe.COLUMN,startColumn:i,endColumn:o-1,startRow:0,endRow:0})):!s&&!a&&(s=!0,i=o)}return s&&r.push({startRow:0,endRow:0,startColumn:i,endColumn:n,rangeType:pe.COLUMN}),r}getVisibleCols(t=0,n=this.getSize()-1){const r=[];let s=!1,i=-1;for(let o=t;o<=n;o++){const a=this.getColVisible(o);s&&!a?(s=!1,r.push({rangeType:pe.COLUMN,startColumn:i,endColumn:o-1,startRow:0,endRow:0})):!s&&a&&(s=!0,i=o)}return s&&r.push({startRow:0,endRow:0,startColumn:i,endColumn:n,rangeType:pe.COLUMN}),r}getColumnDatas(t,n){const r={};let s=0;for(let i=t;i<t+n;i++){const o=this.getColumn(i);r[s]=o!=null?o:{w:this._config.defaultColumnWidth,hd:ae.FALSE},s++}return r}getSize(){return Qt(this._columnData)}getColumnWidth(t){var n,r;return(r=(n=this._columnData[t])==null?void 0:n.w)!=null?r:this._config.defaultColumnWidth}setColumnWidth(t,n){const r=this._columnData[t];n===this._config.defaultColumnWidth?r&&(delete r.w,Object.keys(r).length===0&&delete this._columnData[t]):this._columnData[t]=r?{...r,w:n}:{w:n}}getColumn(t){return this._columnData[t]}removeColumn(t){delete this._columnData[t]}getColumnOrCreate(t){const{_columnData:n}=this,r=n[t];if(r)return r;const s={};return this._columnData[t]=s,s}setCustomMetadata(t,n){const r=this.getColumn(t);r&&(r.custom=n)}getCustomMetadata(t){var n;return(n=this.getColumn(t))==null?void 0:n.custom}}const OR=2e3;class vR{constructor(t,n,r){C(this,"_rowData");this._config=t,this._viewModel=n,this._rowData=r}getRowData(){return this._rowData}getRowStyle(t){var n;return(n=this._rowData[t])==null?void 0:n.s}setRowStyle(t,n){const r=this.getRowOrCreate(t);r.s=n}getRowDatas(t,n){const r={};let s=0;for(let i=t;i<t+n;i++){const o=this.getRow(i);r[s]=o!=null?o:{h:this._config.defaultRowHeight,hd:ae.FALSE},s++}return r}getRowHeight(t,n=1){const{_rowData:r}=this,s=this._config;let i=0;for(let o=0;o<n;o++){const a=r[o+t]||{hd:ae.FALSE,h:s.defaultRowHeight},{ia:l,ah:c,h:u=s.defaultRowHeight}=a;i+=(l==null||l===ae.TRUE)&&typeof c=="number"?c:u}return i}setRowHeight(t,n){const r=this._rowData[t];if(n===this._config.defaultRowHeight)r&&(delete r.h,Object.keys(r).length===0&&delete this._rowData[t]);else{const s=Math.min(n,OR);this._rowData[t]=r?{...r,h:s}:{h:s}}}getRow(t){return this._rowData[t]}removeRow(t){delete this._rowData[t]}getRowOrCreate(t){const{_rowData:n}=this,r=n[t];if(r)return r;const s={};return n[t]=s,s}getHiddenRows(t=0,n=this.getSize()-1){const r=[];let s=!1,i=-1;for(let o=t;o<=n;o++){const a=this.getRowRawVisible(o);s&&a?(s=!1,r.push({startRow:i,endRow:o-1,startColumn:0,endColumn:0,rangeType:pe.ROW})):!s&&!a&&(s=!0,i=o)}return s&&r.push({startRow:i,endRow:n,startColumn:0,endColumn:0,rangeType:pe.ROW}),r}getVisibleRows(t=0,n=this.getSize()-1){const r=[];let s=!1,i=-1;for(let o=t;o<=n;o++){const a=this.getRowRawVisible(o);s&&!a?(s=!1,r.push({startRow:i,endRow:o-1,startColumn:0,endColumn:0,rangeType:pe.ROW})):!s&&a&&(s=!0,i=o)}return s&&r.push({startRow:i,endRow:n,startColumn:0,endColumn:0,rangeType:pe.ROW}),r}getRowRawVisible(t){const n=this.getRow(t);return n?n.hd!==ae.TRUE:!0}getSize(){return Qt(this._rowData)}setCustomMetadata(t,n){const r=this.getRow(t);r&&(r.custom=n)}getCustomMetadata(t){var n;return(n=this.getRow(t))==null?void 0:n.custom}}const wR="DEFAULT_WORKSHEET_ROW_COUNT",kh=1e3,bR="DEFAULT_WORKSHEET_COLUMN_COUNT",Fh=20,AR="DEFAULT_WORKSHEET_ROW_HEIGHT",xh=24,TR="DEFAULT_WORKSHEET_COLUMN_WIDTH",Bh=88,yR="DEFAULT_WORKSHEET_ROW_TITLE_WIDTH",$h=46,NR="DEFAULT_WORKSHEET_COLUMN_TITLE_HEIGHT",Hh=20;function jh(e){const t={name:"Sheet1",id:"sheet-01",tabColor:"",hidden:ae.FALSE,rowCount:kh,columnCount:Fh,zoomRatio:1,freeze:{xSplit:0,ySplit:0,startRow:-1,startColumn:-1},scrollTop:0,scrollLeft:0,defaultColumnWidth:Bh,defaultRowHeight:xh,mergeData:[],cellData:{},rowData:{},columnData:{},showGridlines:ae.TRUE,rowHeader:{width:$h,hidden:ae.FALSE},columnHeader:{height:Hh,hidden:ae.FALSE},rightToLeft:ae.FALSE};return Object.keys(t).forEach(n=>{const r=n;typeof e[r]>"u"&&(e[r]=t[r])}),e}class MR extends ze{constructor(n){super();C(this,"_cellCache",new Map);C(this,"_rowCache",new Map);C(this,"_columnCache",new Map);C(this,"_hasRow",!1);C(this,"_hasColumn",!1);C(this,"_hasAll",!1);C(this,"_allIndex",-1);C(this,"_mergeData");C(this,"_rangeMap",new _r(5e4));C(this,"_skeletonCache",new _r(5e4));this._init(n.concat())}_init(n){this._mergeData=n,this._createCache(n)}_clearCache(){this._cellCache.clear(),this._rowCache.clear(),this._columnCache.clear(),this._hasAll=!1,this._allIndex=-1,this._rangeMap.clear(),this._skeletonCache.clear(),this._hasColumn=!1,this._hasRow=!1}_createCache(n){let r=0;for(const s of n){const{rangeType:i}=s;i===pe.ROW?this._createRowCache(s,r):i===pe.COLUMN?this._createColumnCache(s,r):i===pe.ALL?this._createCellAllCache(r):this._createCellCache(s,r),r++}}rebuild(n){this._clearCache(),this._init(n.concat())}_createRowCache(n,r){const{startRow:s,endRow:i}=n;for(let o=s;o<=i;o++)this._rowCache.set(o,r),this._hasRow=!0}_createColumnCache(n,r){const{startColumn:s,endColumn:i}=n;for(let o=s;o<=i;o++)this._columnCache.set(o,r),this._hasColumn=!0}_createCellAllCache(n){this._hasAll=!0,this._allIndex=n}_createCellCache(n,r){for(let s=n.startRow;s<=n.endRow;s++){let i=this._cellCache.get(s);i==null&&(i=new Map,this._cellCache.set(s,i));for(let o=n.startColumn;o<=n.endColumn;o++)i.set(o,r)}}add(n){this._mergeData.push(n),this._clearCache(),this._createCache(this._mergeData)}remove(n,r){const s=this._getMergeDataIndex(n,r);s!==-1&&(this._mergeData.splice(s,1),this._clearCache(),this._createCache(this._mergeData))}getMergedCell(n,r){const s=this._getMergeDataIndex(n,r);return s!==-1?this._mergeData[s]:null}getMergeDataIndex(n,r){return this._getMergeDataIndex(n,r)}isRowContainsMergedCell(n){return this._hasAll||!Z.isEmptyObject(this._columnCache)?!0:this._mergeData.some(r=>r.startRow<=n&&n<=r.endRow)}isColumnContainsMergedCell(n){return this._hasAll||!Z.isEmptyObject(this._rowCache)?!0:this._mergeData.some(r=>r.startColumn<=n&&n<=r.endColumn)}getMergedCellRange(n,r,s,i){const o=[],a=`${n}-${r}-${s}-${i}`;if(this._rangeMap.has(a))return this._getRangeFromCache(a);let l=0;const c=[];for(const u of this._mergeData||[])nn.intersects(u,{startRow:n,endRow:s,startColumn:r,endColumn:i})&&(o.push({...u}),c.push(l)),l++;return this._rangeMap.set(a,c),o}getMergedCellRangeForSkeleton(n,r,s,i){const o=[],a=this._mergeData,l=`${n}-${r}-${s}-${i}`;if(this._skeletonCache.has(l))return this._getSkeletonRangeFromCache(l);const c=[];for(let u=0;u<a.length;u++){const{startRow:h,endRow:d,startColumn:m,endColumn:_}=a[u];for(let p=n;p<=s;p++){let I=!1;for(let A=r;A<=i;A++)if(p>=h&&p<=d&&A>=m&&A<=_){o.push({startRow:h,endRow:d,startColumn:m,endColumn:_}),c.push(u),I=!0;break}if(I)break}}return this._skeletonCache.set(l,c),o}_getRangeFromCache(n){const r=this._rangeMap.get(n)||[],s=[];for(const i of r)s.push({...this._mergeData[i]});return s}_getSkeletonRangeFromCache(n){const r=this._skeletonCache.get(n)||[],s=[];for(const i of r)s.push({...this._mergeData[i]});return s}_getMergeDataIndex(n,r){var i;if(this._hasAll)return this._allIndex;if(this._hasRow){const o=this._rowCache.get(n);if(o!==void 0)return o}if(this._hasColumn){const o=this._columnCache.get(r);if(o!==void 0)return o}const s=(i=this._cellCache.get(n))==null?void 0:i.get(r);return s!==void 0?s:-1}getMergeDataSnapshot(){return this._mergeData}dispose(){this._clearCache(),this._mergeData=[]}}class Wh extends ze{constructor(n){super();C(this,"_cellContentInterceptor",null);C(this,"_rowFilteredInterceptor",null);this.getRawCell=n}dispose(){super.dispose(),this._cellContentInterceptor=null,this._rowFilteredInterceptor=null}getCell(n,r,s,i){return this._cellContentInterceptor?this._cellContentInterceptor.getCell(n,r,bn.Value|bn.Style,s,i):this.getRawCell(n,r)}getCellValueOnly(n,r){return this._cellContentInterceptor?this._cellContentInterceptor.getCell(n,r,bn.Value):this.getRawCell(n,r)}getCellStyleOnly(n,r){return this._cellContentInterceptor?this._cellContentInterceptor.getCell(n,r,bn.Style):this.getRawCell(n,r)}getRowFiltered(n){var r,s;return(s=(r=this._rowFilteredInterceptor)==null?void 0:r.getRowFiltered(n))!=null?s:!1}registerCellContentInterceptor(n){if(this._cellContentInterceptor)throw new Error("[SheetViewModel]: Interceptor already registered.");return this._cellContentInterceptor=n,We(()=>this._cellContentInterceptor=null)}registerRowFilteredInterceptor(n){if(this._rowFilteredInterceptor)throw new Error("[SheetViewModel]: Interceptor already registered.");return this._rowFilteredInterceptor=n,We(()=>this._rowFilteredInterceptor=null)}}const Yh={isDeepClone:!1,displayRawFormula:!1,ignoreTextRotation:!1};class Wr{constructor(t,n,r){C(this,"_sheetId");C(this,"_snapshot");C(this,"_cellData");C(this,"_rowManager");C(this,"_columnManager");C(this,"_viewModel");C(this,"_spanModel");C(this,"_isRowStylePrecedeColumnStyle",!0);C(this,"_getCellHeight");var a;this.unitId=t,this._styles=r,this._snapshot=jh(n);const{columnData:s,rowData:i,cellData:o}=this._snapshot;this._sheetId=(a=this._snapshot.id)!=null?a:tt(6),this._cellData=new ut(o),this._viewModel=new Wh((l,c)=>this.getCellRaw(l,c)),this._rowManager=new vR(this._snapshot,this._viewModel,i),this._columnManager=new SR(this._snapshot,s),this._spanModel=new MR(this._snapshot.mergeData)}__interceptViewModel(t){t(this._viewModel)}__registerGetCellHeight(t){return this._getCellHeight=t,We(()=>{this._getCellHeight=null})}getSnapshot(){return this._snapshot}getCellHeight(t,n){return this._getCellHeight?this._getCellHeight(t,n):this._snapshot.defaultRowHeight}setMergeData(t){this._snapshot.mergeData=t,this.getSpanModel().rebuild(t)}getSpanModel(){return this._spanModel}setIsRowStylePrecedeColumnStyle(t){this._isRowStylePrecedeColumnStyle=t}getStyleDataByHash(t){return{...this._styles.get(t)}}setStyleData(t){return this._styles.setValue(t)}getColumnStyle(t,n=!1){return n?this._columnManager.getColumnStyle(t):this._styles.get(this._columnManager.getColumnStyle(t))}setColumnStyle(t,n){this._columnManager.setColumnStyle(t,n)}getRowStyle(t,n=!1){return n?this._rowManager.getRowStyle(t):this._styles.get(this._rowManager.getRowStyle(t))}setRowStyle(t,n){this._rowManager.setRowStyle(t,n)}getDefaultCellStyle(){return this._snapshot.defaultStyle}getDefaultCellStyleInternal(){const t=this._snapshot.defaultStyle;return this._styles.get(t)}setDefaultCellStyle(t){this._snapshot.defaultStyle=t}getCellStyle(t,n){const r=this.getCell(t,n);if(r){const s=r.s;return typeof s=="string"?this._styles.get(s):s}return null}getComposedCellStyle(t,n,r){const s=this.getDefaultCellStyleInternal(),i=this.getRowStyle(t),o=this.getColumnStyle(n),a=this.getCell(t,n),l=this._styles.getStyleByCell(a);return(r!=null?r:this._isRowStylePrecedeColumnStyle)?ar(s,o,i,a==null?void 0:a.themeStyle,l):ar(s,i,o,a==null?void 0:a.themeStyle,l)}getComposedCellStyleByCellData(t,n,r,s){const i=this.getDefaultCellStyleInternal(),o=this.getRowStyle(t),a=this.getColumnStyle(n),l=this._styles.getStyleByCell(r);return(s!=null?s:this._isRowStylePrecedeColumnStyle)?ar(i,a,o,r==null?void 0:r.themeStyle,l):ar(i,o,a,r==null?void 0:r.themeStyle,l)}getCellMatrix(){return this._cellData}getCellMatrixPrintRange(){const t=this.getCellMatrix(),n=this.getMergeData();let r=-1,s=-1,i=-1,o=-1,a=!1,l=!1;return t.forEach((c,u)=>{Object.keys(u).forEach(h=>{const d=+h,m=t.getValue(c,d),_=m!=null&&m.s?this._styles.get(m.s):null,p=(_==null?void 0:_.bd)&&(_.bd.b||_.bd.l||_.bd.r||_.bd.t||_.bd.bc_tr||_.bd.bl_tr||_.bd.ml_tr||_.bd.tl_bc||_.bd.tl_br||_.bd.tl_mr);(m&&(m.v!==null&&m.v!==void 0&&m.v!==""||m.p)||_!=null&&_.bg||p)&&(a?r=Math.min(r,c):(r=c,a=!0),s=Math.max(s,c),l?i=Math.min(i,d):(l=!0,i=d),o=Math.max(o,d))})}),n.forEach(c=>{a?r=Math.min(r,c.startRow):(r=c.startRow,a=!0),s=Math.max(s,c.endRow),l?i=Math.min(i,c.startColumn):(i=c.startColumn,a=!0),o=Math.max(o,c.endColumn)}),!a||!l?null:{startColumn:i,startRow:r,endColumn:o,endRow:s}}getRowManager(){return this._rowManager}getUnitId(){return this.unitId}getSheetId(){return this._sheetId}getColumnManager(){return this._columnManager}getName(){return this._snapshot.name}clone(){const{_snapshot:t}=this,n=Z.deepClone(t);return new Wr(this.unitId,n,this._styles)}getMergeData(){return this._spanModel.getMergeDataSnapshot()}getMergedCell(t,n){return this._spanModel.getMergedCell(t,n)}getMergedCellRange(t,n,r,s){return this._spanModel.getMergedCellRange(t,n,r,s)}isRowContainsMergedCell(t){return this._spanModel.isRowContainsMergedCell(t)}isColumnContainsMergedCell(t){return this._spanModel.isColumnContainsMergedCell(t)}getCellInfoInMergeData(t,n){const r=this.getMergedCell(t,n);let s=!1,i=!1,o=t,a=n,l=t,c=n;if(r){const{startRow:u,endRow:h,startColumn:d,endColumn:m}=r;t===u&&n===d?(o=h,a=m,l=u,c=d,i=!0):t>=u&&t<=h&&n>=d&&n<=m&&(o=h,a=m,l=u,c=d,s=!0)}return{actualRow:t,actualColumn:n,isMergedMainCell:i,isMerged:s,endRow:o,endColumn:a,startRow:l,startColumn:c}}getCell(t,n){return t<0||n<0?null:this._viewModel.getCell(t,n)}getCellValueOnly(t,n){return t<0||n<0?null:this._viewModel.getCellValueOnly(t,n)}getCellStyleOnly(t,n){return t<0||n<0?null:this._viewModel.getCellStyleOnly(t,n)}getCellRaw(t,n){return this.getCellMatrix().getValue(t,n)}getCellWithFilteredInterceptors(t,n,r,s){return this._viewModel.getCell(t,n,r,s)}getRowFiltered(t){return this._viewModel.getRowFiltered(t)}getRangeFilterRows(t){const n=[];for(let r=t.startRow;r<=t.endRow;r++)this.getRowFiltered(r)&&n.push(r);return n}getMatrixWithMergedCells(t,n,r,s,i=Dn.Raw){const o=this.getCellMatrix(),a=this._spanModel.getMergedCellRange(t,n,r,s),l=new ut;return xo(t,r,n,s).forEach((c,u)=>{var d;let h;if(i===Dn.Raw)h=this.getCellRaw(c,u);else if(i===Dn.Intercepted)h=this.getCell(c,u);else if(i===Dn.Both){const m=this.getCellRaw(c,u);if(m){h={...m};const _=(d=this.getCell(c,u))==null?void 0:d.v;Dh(_)&&h&&(h.displayV=String(_))}}h&&l.setValue(c,u,h)}),a.forEach(c=>{const{startColumn:u,startRow:h,endColumn:d,endRow:m}=c;xo(h,m,u,d).forEach((_,p)=>{_===h&&p===u&&l.setValue(_,p,{...o.getValue(_,p),rowSpan:m-h+1,colSpan:d-u+1}),(_!==h||p!==u)&&l.realDeleteValue(_,p)})}),l}getRange(t,n,r,s){return typeof t=="object"?new jn(this,t,{getStyles:()=>this._styles}):new jn(this,{startRow:t,startColumn:n,endColumn:s||n,endRow:r||t},{getStyles:()=>this._styles})}getScrollLeftTopFromSnapshot(){return{scrollLeft:this._snapshot.scrollLeft,scrollTop:this._snapshot.scrollTop}}getZoomRatio(){return this._snapshot.zoomRatio||1}getConfig(){return this._snapshot}getFreeze(){return this._snapshot.freeze}getMaxColumns(){const{_snapshot:t}=this,{columnCount:n}=t;return n}getMaxRows(){const{_snapshot:t}=this,{rowCount:n}=t;return n}getRowCount(){return this._snapshot.rowCount}setRowCount(t){this._snapshot.rowCount=t}getColumnCount(){return this._snapshot.columnCount}setColumnCount(t){this._snapshot.columnCount=t}isSheetHidden(){return this._snapshot.hidden}hasHiddenGridlines(){const{_snapshot:t}=this,{showGridlines:n}=t;return n===0}getGridlinesColor(){return this.getConfig().gridlinesColor}getTabColor(){const{_snapshot:t}=this,{tabColor:n}=t;return n}getColumnWidth(t){return this.getColumnManager().getColumnWidth(t)}getRowHeight(t){return this._viewModel.getRowFiltered(t)?0:this.getRowManager().getRowHeight(t)}isRowFiltered(t){return this._viewModel.getRowFiltered(t)}getRowVisible(t){return!this.isRowFiltered(t)&&this.getRowRawVisible(t)}getRowRawVisible(t){return this.getRowManager().getRowRawVisible(t)}getHiddenRows(t,n){const r=this.getMaxColumns()-1,s=this._rowManager.getHiddenRows(t,n);return s.forEach(i=>i.endColumn=r),s}getColVisible(t){return this._columnManager.getColVisible(t)}getHiddenCols(t,n){const r=this.getMaxRows()-1,s=this._columnManager.getHiddenCols(t,n);return s.forEach(i=>i.endRow=r),s}getVisibleRows(){const t=this.getRowCount();return this._rowManager.getVisibleRows(0,t-1)}getVisibleCols(){const t=this.getColumnCount();return this._columnManager.getVisibleCols(0,t-1)}isRightToLeft(){const{_snapshot:t}=this,{rightToLeft:n}=t;return n}getLastRowWithContent(){return this._cellData.getLength()-1}getLastColumnWithContent(){return this._cellData.getRange().endColumn}getDataRangeScope(){return this._cellData.getStartEndScope()}cellHasValue(t){return t&&(t.v!==void 0||t.f!==void 0||t.p!==void 0)}iterateByRow(t,n=!0){const{startRow:r,startColumn:s,endRow:i,endColumn:o}=t,a=this;return{[Symbol.iterator]:()=>{let l=r,c=s;return{next(){for(;;){if(c>o&&(l+=1,c=s),l>i)return{done:!0,value:void 0};const u=a.getCell(l,c),h=!u,d=a.getMergedCell(l,c);if(d){if(l!==d.startRow||c!==d.startColumn){c=d.endColumn+1;continue}if(h&&n){c=d.endColumn+1;continue}const _={row:l,col:c,value:u};return _.colSpan=d.endColumn-d.startColumn+1,_.rowSpan=d.endRow-d.startRow+1,c=d.endColumn+1,{done:!1,value:_}}if(h&&n)c+=1;else{const m={row:l,col:c,value:u};return c+=1,{done:!1,value:m}}}}}}}}iterateByColumn(t,n=!0,r=!0){const{startRow:s,startColumn:i,endRow:o,endColumn:a}=t,l=this;return{[Symbol.iterator]:()=>{let c=s,u=i;return{next(){for(;;){if(c>o&&(u+=1,c=s),u>a)return{done:!0,value:void 0};const h=l.getMergedCell(c,u);if(h){const _=c!==h.startRow,p=_||u!==h.startColumn;if(r&&p||!r&&_){c=h.endRow+1;continue}const I=l.getCell(h.startRow,h.startColumn);if(!I&&n){c=h.endRow+1;continue}const B={row:c,col:h.startColumn,value:I};return B.colSpan=h.endColumn-h.startColumn+1,B.rowSpan=h.endRow-h.startRow+1,c=h.endRow+1,{done:!1,value:B}}const d=l.getCell(c,u);if(!d&&n)c+=1;else{const _={row:c,col:u,value:d};return c+=1,{done:!1,value:_}}}}}}}}getCellDocumentModel(t,n,r=Yh){var p;if(!t)return;const{isDeepClone:s,displayRawFormula:i,ignoreTextRotation:o}={...Yh,...r};let a,l="document";const c=CR(n),u=o?st.tr:c.textRotation||st.tr;let h=c.horizontalAlign||st.ht;const d=c.verticalAlign||st.vt,m=c.wrapStrategy||st.tb,_=c.paddingData||ea;if(t.f&&i)a=jr(t.f.toString(),{},{verticalAlign:d}),h=st.ht;else if(t.p){const{centerAngle:I,vertexAngle:A}=Ph(u);a=this._updateConfigAndGetDocumentModel(s?Z.deepClone(t.p):t.p,h,_,{horizontalAlign:h,verticalAlign:d,centerAngle:I,vertexAngle:A,wrapStrategy:m,zeroWidthParagraphBreak:1})}else if(t.v!=null){const I=Mh(n);l=Uh(I).fontCache;let A=Gh(t);t.t===Zt.FORCE_STRING&&i&&(A=`'${A}`),a=jr(A,I,{...c,textRotation:u,cellValueType:t.t})}return a&&t.linkUrl&&t.linkId&&Lh(a,t.linkUrl,t.linkId),{documentModel:a,fontString:l,textRotation:u,wrapStrategy:m,verticalAlign:d,horizontalAlign:h,paddingData:_,fill:(p=n==null?void 0:n.bg)==null?void 0:p.rgb}}_updateConfigAndGetDocumentModel(t,n,r,s){var o,a,l,c,u;if(!s||!((o=t.body)!=null&&o.dataStream))return;t.documentStyle||(t.documentStyle={}),t.documentStyle.marginTop=(a=r.t)!=null?a:0,t.documentStyle.marginBottom=(l=r.b)!=null?l:2,t.documentStyle.marginLeft=(c=r.l)!=null?c:2,t.documentStyle.marginRight=(u=r.r)!=null?u:2,t.documentStyle.pageSize={width:Number.POSITIVE_INFINITY,height:Number.POSITIVE_INFINITY},t.documentStyle.renderConfig={...t.documentStyle.renderConfig,...s};const i=t.body.paragraphs||[];for(const h of i)h.paragraphStyle||(h.paragraphStyle={}),h.paragraphStyle.horizontalAlign=n;return new At(t)}getBlankCellDocumentModel(t,n,r){const s=this.getComposedCellStyleByCellData(n,r,t),i=Mh(s),o=this.getCellDocumentModel(t,s,{ignoreTextRotation:!0});if(o!=null)return o.documentModel==null&&(o.documentModel=jr("",i)),o;const a="";let l="document";const c=st.tr,u=st.ht,h=st.vt,d=st.tb,m=ea;return l=Uh({}).fontCache,{documentModel:jr(a,i),fontString:l,textRotation:c,wrapStrategy:d,verticalAlign:h,horizontalAlign:u,paddingData:m}}getCellDocumentModelWithFormula(t,n,r){const s=this.getComposedCellStyleByCellData(n,r,t);return this.getCellDocumentModel(t,s,{isDeepClone:!0,displayRawFormula:!0,ignoreTextRotation:!0})}getCustomMetadata(){return this._snapshot.custom}setCustomMetadata(t){this._snapshot.custom=t}}function Gh(e){var r,s;if(!e)return"";const t=(s=(r=e.p)==null?void 0:r.body)==null?void 0:s.dataStream;if(t)return Je.transform.getPlainText(t);const n=e.v;return typeof n=="string"?e.t===Zt.BOOLEAN?n.toUpperCase():n.replace(/[\r\n]/g,""):typeof n=="number"?e.t===Zt.BOOLEAN?n?"TRUE":"FALSE":n.toString():typeof n=="boolean"?n?"TRUE":"FALSE":""}function LR(e){if(e===null)return"";if(e!=null&&e.p){const t=e==null?void 0:e.p.body;if(t==null)return"";const n=t.dataStream;return Je.transform.getPlainText(n)}return e==null?void 0:e.v}var DR=Object.getOwnPropertyDescriptor,UR=(e,t,n,r)=>{for(var s=r>1?void 0:r?DR(t,n):t,i=e.length-1,o;i>=0;i--)(o=e[i])&&(s=o(s)||s);return s},PR=(e,t)=>(n,r)=>t(n,r,e);function kR(e,t){return`${e.getUnitId()}|${t.getSheetId()}`}f.Workbook=class extends is{constructor(n={},r){super();C(this,"type",ve.UNIVER_SHEET);C(this,"_sheetCreated$",new oe.Subject);C(this,"sheetCreated$",this._sheetCreated$.asObservable());C(this,"_sheetDisposed$",new oe.Subject);C(this,"sheetDisposed$",this._sheetDisposed$.asObservable());C(this,"_activeSheet$",new oe.BehaviorSubject(null));C(this,"activeSheet$",this._activeSheet$.asObservable());C(this,"_worksheets");C(this,"_styles");C(this,"_snapshot");C(this,"_unitId");C(this,"_count");C(this,"_name$");C(this,"name$");this._logService=r;const s=gR();Z.isEmptyObject(n)?this._snapshot=s:this._snapshot=Z.commonExtend(s,n);const{styles:i}=this._snapshot;(this._snapshot.id==null||this._snapshot.id.length===0)&&(this._snapshot.id=tt(6)),this._unitId=this._snapshot.id,this._styles=new yh(i),this._count=1,this._worksheets=new Map,this._name$=new oe.BehaviorSubject(n.name||""),this.name$=this._name$.asObservable(),this._parseWorksheetSnapshots()}get _activeSheet(){return this._activeSheet$.getValue()}get name(){return this._name$.getValue()}static isIRangeType(n){return typeof n=="string"||"startRow"in n||"row"in n}dispose(){super.dispose(),this._sheetCreated$.complete(),this._sheetDisposed$.complete(),this._activeSheet$.complete(),this._name$.complete()}save(){return Z.deepClone(this._snapshot)}getSnapshot(){return this._snapshot}getName(){return this._snapshot.name}setName(n){this._name$.next(n),this._snapshot.name=n}getUnitId(){return this._unitId}getRev(){var n;return(n=this._snapshot.rev)!=null?n:1}incrementRev(){this._snapshot.rev=this.getRev()+1}setRev(n){this._snapshot.rev=n}addWorksheet(n,r,s){const{sheets:i,sheetOrder:o}=this._snapshot;if(i[n])return!1;i[n]=s,o.splice(r,0,n);const a=new Wr(this._unitId,s,this._styles);return this._worksheets.set(n,a),this._sheetCreated$.next(a),!0}getSheetOrders(){return this._snapshot.sheetOrder}getWorksheets(){return this._worksheets}getActiveSpreadsheet(){return this}getStyles(){return this._styles}addStyles(n){Object.entries(n).forEach(([r,s])=>{this._styles.addCustomStyle(r,s)})}removeStyles(n){n.forEach(r=>{this._styles.remove(r)})}getConfig(){return this._snapshot}getIndexBySheetId(n){const{sheetOrder:r}=this._snapshot;return r.findIndex(s=>s===n)}getActiveSheet(n){if(!this._activeSheet&&typeof n>"u")throw new Error(`[Workbook]: no active Worksheet on Workbook ${this._unitId}!`);return this._activeSheet}ensureActiveSheet(){const n=this._activeSheet;if(n)return n;const r=this._snapshot.sheetOrder;for(let i=0,o=r.length;i<o;i++){const a=this._worksheets.get(r[i]);if(a&&a.isSheetHidden()!==ae.TRUE)return this.setActiveSheet(a),a}const s=this._worksheets.get(r[0]);return this.setActiveSheet(s),s}setActiveSheet(n){this._activeSheet$.next(n)}removeSheet(n){const r=this._worksheets.get(n);return r?(this._worksheets.delete(n),this._snapshot.sheetOrder.splice(this._snapshot.sheetOrder.indexOf(n),1),delete this._snapshot.sheets[n],this._sheetDisposed$.next(r),!0):!1}getActiveSheetIndex(){const{sheetOrder:n}=this._snapshot;return n.findIndex(r=>this._worksheets.get(r)===this._activeSheet)}getSheetSize(){return this._snapshot.sheetOrder.length}getSheets(){const{sheetOrder:n}=this._snapshot;return n.map(r=>this._worksheets.get(r))}getSheetsName(){const{sheetOrder:n}=this._snapshot,r=[];return n.forEach(s=>{const i=this._worksheets.get(s);i&&r.push(i.getName())}),r}getSheetIndex(n){const{sheetOrder:r}=this._snapshot;return r.findIndex(s=>n.getSheetId()===s)}getSheetBySheetName(n){const{sheetOrder:r}=this._snapshot,s=r.find(i=>this._worksheets.get(i).getName()===n);return this._worksheets.get(s)}getSheetBySheetId(n){return this._worksheets.get(n)}getSheetByIndex(n){const{sheetOrder:r}=this._snapshot;return this._worksheets.get(r[n])}getHiddenWorksheets(){return this.getSheets().filter(n=>n.getConfig().hidden===ae.TRUE).map(n=>n.getConfig().id)}getUnhiddenWorksheets(){return this.getSheets().filter(n=>n.getConfig().hidden!==ae.TRUE).map(n=>n.getConfig().id)}load(n){this._snapshot=n}checkSheetName(n){return this.getSheetsName().includes(n)}uniqueSheetName(n="Sheet1"){let r=n;for(;this.checkSheetName(r);)r=n+this._count,this._count++;return r}generateNewSheetName(n){let r=n+this._count;for(;this.checkSheetName(r);)r=n+this._count,this._count++;return r}_parseWorksheetSnapshots(){const{_snapshot:n,_worksheets:r}=this,{sheets:s,sheetOrder:i}=n;if(Z.isEmptyObject(s)){const o=tt();s[o]={id:o}}for(const o in s){const a=s[o],{name:l}=a;a.name=this.uniqueSheetName(l),a.name!==l&&this._logService.debug("[Workbook]",`The worksheet name ${l} is duplicated, we changed it to ${a.name}. Please fix the problem in your snapshot.`);const c=new Wr(this._unitId,a,this._styles);r.set(o,c),i.includes(o)||i.push(o)}this.ensureActiveSheet()}getCustomMetadata(){return this._snapshot.custom}setCustomMetadata(n){this._snapshot.custom=n}},f.Workbook=UR([PR(1,Et)],f.Workbook);class ta extends is{constructor(n){var r;super();C(this,"type",ve.UNIVER_SLIDE);C(this,"_activePage$",new oe.BehaviorSubject(null));C(this,"activePage$",this._activePage$.asObservable());C(this,"_name$");C(this,"name$");C(this,"_snapshot");C(this,"_unitId");this._snapshot={...Uu,...n},this._unitId=(r=this._snapshot.id)!=null?r:tt(6),this._name$=new oe.BehaviorSubject(this._snapshot.title),this.name$=this._name$.asObservable()}get _activePage(){var r,s;const n=this._activePage$.getValue();if(!n){const i=(r=this.getPageOrder())==null?void 0:r[0];return i?(s=this.getPages())==null?void 0:s[i]:null}return n}setName(n){var r;this._snapshot.title=n,this._name$.next(n),this._unitId=(r=this._snapshot.id)!=null?r:tt(6)}getRev(){return 0}incrementRev(){}setRev(n){}getSnapshot(){return this._snapshot}getUnitId(){return this._unitId}getPages(){var n;return(n=this._snapshot.body)==null?void 0:n.pages}getPageOrder(){var n;return(n=this._snapshot.body)==null?void 0:n.pageOrder}getPage(n){const r=this.getPages();return r==null?void 0:r[n]}getElementsByPage(n){var r;return(r=this.getPage(n))==null?void 0:r.pageElements}getElement(n,r){var s;return(s=this.getElementsByPage(n))==null?void 0:s[r]}getPageSize(){return this._snapshot.pageSize}getBlankPage(){const n=tt(6);return{id:n,pageType:bi.SLIDE,zIndex:10,title:n,description:"",pageBackgroundFill:{rgb:"rgb(255,255,255)"},pageElements:{}}}setActivePage(n){this._activePage$.next(n)}getActivePage(){return this._activePage}updatePage(n,r){this._snapshot.body&&(this._snapshot.body.pages[n]=r)}appendPage(n){var i;if(!this._snapshot.body)return;this._snapshot.body.pages[n.id]=n;const r=this._activePage,s=this._snapshot.body.pageOrder.indexOf((i=r==null?void 0:r.id)!=null?i:"");this._snapshot.body.pageOrder.splice(s+1,0,n.id)}}var FR=Object.getOwnPropertyDescriptor,xR=(e,t,n,r)=>{for(var s=r>1?void 0:r?FR(t,n):t,i=e.length-1,o;i>=0;i--)(o=e[i])&&(s=o(s)||s);return s},Vh=(e,t)=>(n,r)=>t(n,r,e);const Xn=Re.createIdentifier("univer.current");f.UniverInstanceService=class extends ze{constructor(n,r){super();C(this,"_unitsByType",new Map);C(this,"_createHandler");C(this,"_ctorByType",new Map);C(this,"_currentUnits",new Map);C(this,"_currentUnits$",new oe.BehaviorSubject(this._currentUnits));C(this,"currentUnits$",this._currentUnits$.asObservable());C(this,"_unitAdded$",new oe.Subject);C(this,"unitAdded$",this._unitAdded$.asObservable());C(this,"_unitDisposed$",new oe.Subject);C(this,"unitDisposed$",this._unitDisposed$.asObservable());C(this,"_focused$",new oe.BehaviorSubject(null));C(this,"focused$",this._focused$.asObservable());this._injector=n,this._contextService=r}dispose(){super.dispose(),this._focused$.complete(),this._currentUnits$.complete(),this._unitAdded$.complete(),this._currentUnits.clear(),this._unitsByType.clear()}__setCreateHandler(n){this._createHandler=n}createUnit(n,r,s){return this._createHandler(n,r,this._ctorByType.get(n),s)}registerCtorForType(n,r){return this._ctorByType.set(n,r),{dispose:()=>{this._ctorByType.delete(n)}}}getCurrentTypeOfUnit$(n){return this.currentUnits$.pipe(oe.map(r=>{var s;return(s=r.get(n))!=null?s:null}),oe.distinctUntilChanged())}getCurrentUnitForType(n){return this._currentUnits.get(n)}getCurrentUnitOfType(n){return this.getCurrentUnitForType(n)}setCurrentUnitForType(n){const r=this._getUnitById(n);if(!r)throw new Error(`[UniverInstanceService]: no document with unitId ${n}!`);this._currentUnits.set(r[1],r[0]),this._currentUnits$.next(this._currentUnits)}getTypeOfUnitAdded$(n){return this._unitAdded$.pipe(oe.filter(r=>r.type===n))}__addUnit(n,r){var a;const s=n.type;this._unitsByType.has(s)||this._unitsByType.set(s,[]);const i=this._unitsByType.get(s),o=n.getUnitId();if(i.findIndex(l=>l.getUnitId()===o)!==-1)throw new Error(`[UniverInstanceService]: cannot create a unit with the same unit id: ${o}.`);i.push(n),this._unitAdded$.next(n),((a=r==null?void 0:r.makeCurrent)==null||a)&&this.setCurrentUnitForType(n.getUnitId())}getTypeOfUnitDisposed$(n){return this.unitDisposed$.pipe(oe.filter(r=>r.type===n))}getUnit(n,r){var i;const s=(i=this._getUnitById(n))==null?void 0:i[0];return r&&(s==null?void 0:s.type)!==r?null:s}getCurrentUniverDocInstance(){return this.getCurrentUnitForType(ve.UNIVER_DOC)}getUniverDocInstance(n){return this.getUnit(n,ve.UNIVER_DOC)}getUniverSheetInstance(n){return this.getUnit(n,ve.UNIVER_SHEET)}getAllUnitsForType(n){var r;return(r=this._unitsByType.get(n))!=null?r:[]}changeDoc(n,r){const s=this.getAllUnitsForType(ve.UNIVER_DOC),i=s.find(o=>o.getUnitId()===n);if(i!=null){const o=s.indexOf(i);s.splice(o,1)}this.__addUnit(r)}get focused(){var r;const n=this._focused$.getValue();return n?(r=this._getUnitById(n))==null?void 0:r[0]:null}focusUnit(n){this._focused$.next(n),this.focused instanceof f.Workbook?(this._contextService.setContextValue(Br,!0),this._contextService.setContextValue($r,!1),this._contextService.setContextValue(Kn,!0),this._contextService.setContextValue(Hr,!1),this.setCurrentUnitForType(n)):this.focused instanceof At?(this._contextService.setContextValue(Br,!0),this._contextService.setContextValue($r,!0),this._contextService.setContextValue(Kn,!1),this._contextService.setContextValue(Hr,!1),this.setCurrentUnitForType(n)):this.focused instanceof ta?(this._contextService.setContextValue(Br,!0),this._contextService.setContextValue($r,!1),this._contextService.setContextValue(Kn,!1),this._contextService.setContextValue(Hr,!0),this.setCurrentUnitForType(n)):(this._contextService.setContextValue(Br,!1),this._contextService.setContextValue($r,!1),this._contextService.setContextValue(Kn,!1),this._contextService.setContextValue(Hr,!1))}getFocusedUnit(){return this.focused}getUnitType(n){const r=this._getUnitById(n);return r?r[1]:ve.UNRECOGNIZED}disposeUnit(n){const r=this._getUnitById(n);if(!r)return!1;const[s,i]=r,o=this._unitsByType.get(i),a=o.indexOf(s);return o.splice(a,1),this._tryResetCurrentOnRemoval(n,i),this._tryResetFocusOnRemoval(n),this._unitDisposed$.next(s),!0}_tryResetCurrentOnRemoval(n,r){const s=this.getCurrentUnitForType(r);(s==null?void 0:s.getUnitId())===n&&(this._currentUnits.set(r,null),this._currentUnits$.next(this._currentUnits))}_tryResetFocusOnRemoval(n){var r;((r=this.focused)==null?void 0:r.getUnitId())===n&&this._focused$.next(null)}_getUnitById(n){for(const[r,s]of this._unitsByType){const i=s.find(o=>o.getUnitId()===n);if(i)return[i,r]}}},f.UniverInstanceService=xR([Vh(0,Re.Inject(Re.Injector)),Vh(1,Ln)],f.UniverInstanceService);var ke=(e=>(e[e.Starting=0]="Starting",e[e.Ready=1]="Ready",e[e.Rendered=2]="Rendered",e[e.Steady=3]="Steady",e))(ke||{});const zh={0:"Starting",1:"Ready",2:"Rendered",3:"Steady"};var BR=Object.getOwnPropertyDescriptor,$R=(e,t,n,r)=>{for(var s=r>1?void 0:r?BR(t,n):t,i=e.length-1,o;i>=0;i--)(o=e[i])&&(s=o(s)||s);return s},HR=(e,t)=>(n,r)=>t(n,r,e);class Kh extends Error{constructor(t){super(`[LifecycleService]: lifecycle stage "${zh[t]}" will never be reached!`),this.name="LifecycleUnreachableError"}}f.LifecycleService=class extends ze{constructor(n){super();C(this,"_lifecycle$",new oe.BehaviorSubject(ke.Starting));C(this,"lifecycle$",this._lifecycle$.asObservable());C(this,"_lock",!1);this._logService=n,this._reportProgress(ke.Starting)}get stage(){return this._lifecycle$.getValue()}set stage(n){if(this._lock)throw new Error("[LifecycleService]: cannot set new stage when related logic is all handled!");if(n<this.stage)throw new Error("[LifecycleService]: lifecycle stage cannot go backward!");n!==this.stage&&(this._lock=!0,this._reportProgress(n),this._lifecycle$.next(n),this._lock=!1)}dispose(){this._lifecycle$.complete(),super.dispose()}onStage(n){return oe.firstValueFrom(this.lifecycle$.pipe(oe.filter(r=>r>=n),Li(r=>r===n),oe.map(()=>{}))).catch(r=>r.name==="EmptyError"?Promise.reject(new Kh(n)):Promise.reject(r))}subscribeWithPrevious(){return oe.merge(Xh(this.stage),this._lifecycle$.pipe(oe.skip(1))).pipe(Li(n=>n===ke.Steady))}_reportProgress(n){this._logService.debug("[LifecycleService]",`lifecycle progressed to "${zh[n]}".`)}},f.LifecycleService=$R([HR(0,Et)],f.LifecycleService);function Xh(e){switch(e){case ke.Starting:return oe.of(ke.Starting);case ke.Ready:return oe.of(ke.Starting,ke.Ready);case ke.Rendered:return oe.of(ke.Starting,ke.Ready,ke.Rendered);default:return oe.of(ke.Starting,ke.Ready,ke.Rendered,ke.Steady)}}const jR=Re.createIdentifier("ILocalStorageService");class Sn extends ze{constructor(){super();C(this,"_currentLocale$",new oe.BehaviorSubject(lr.ZH_CN));C(this,"currentLocale$",this._currentLocale$.asObservable());C(this,"_locales",null);C(this,"localeChanged$",new oe.Subject);C(this,"t",(n,...r)=>{if(!this._locales)throw new Error("[LocaleService]: Locale not initialized");const s=n.split("."),i=this.resolveKeyPath(this._locales[this._currentLocale],s);if(typeof i=="string"){let o=i;return r.forEach((a,l)=>{o=o.replace(`{${l}}`,a)}),o}else return n});this.disposeWithMe(We(()=>{this._locales=null,this._currentLocale$.complete(),this.localeChanged$.complete()}))}get _currentLocale(){return this._currentLocale$.value}load(n){var r;this._locales=rs((r=this._locales)!=null?r:{},n)}setLocale(n){this._currentLocale$.next(n),this.localeChanged$.next()}getLocales(){var n;return(n=this._locales)==null?void 0:n[this._currentLocale]}getCurrentLocale(){return this._currentLocale}resolveKeyPath(n,r){const s=r.shift();if(s&&n&&s in n){const i=n[s];return r.length>0&&(typeof i=="object"||Array.isArray(i))?this.resolveKeyPath(i,r):i}return null}}var WR=Object.getOwnPropertyDescriptor,YR=(e,t,n,r)=>{for(var s=r>1?void 0:r?WR(t,n):t,i=e.length-1,o;i>=0;i--)(o=e[i])&&(s=o(s)||s);return s},GR=(e,t)=>(n,r)=>t(n,r,e);f.MentionIOLocalService=class{constructor(t){this._userManagerService=t}async list(t){return{list:[{type:os.PERSON,mentions:[{objectType:os.PERSON,objectId:this._userManagerService.getCurrentUser().userID,label:this._userManagerService.getCurrentUser().name,metadata:{icon:this._userManagerService.getCurrentUser().avatar}}],metadata:{},title:"PEOPLE"}],page:t.page,size:t.size,total:1}}},f.MentionIOLocalService=YR([GR(0,Re.Inject(xr))],f.MentionIOLocalService);const qh=Re.createIdentifier("univer.service.mention-io");var na=(e=>(e.INIT="init",e.FETCHING="fetching",e.DONE="done",e))(na||{});const Zh=Re.createIdentifier("univer.permission-service");class Jh extends ze{constructor(){super(...arguments);C(this,"_permissionPointMap",new Map);C(this,"_permissionPointUpdate$",new oe.Subject);C(this,"permissionPointUpdate$",this._permissionPointUpdate$.asObservable());C(this,"_showComponents",!0)}setShowComponents(n){this._showComponents=n}getShowComponents(){return this._showComponents}deletePermissionPoint(n){const r=this._permissionPointMap.get(n);r&&(r.complete(),this._permissionPointMap.delete(n))}addPermissionPoint(n){const r=n instanceof oe.BehaviorSubject,s=r?n.getValue():n;return s.id?this._permissionPointMap.get(s.id)?(console.warn(`${s.id} PermissionPoint already exists`),!1):(this._permissionPointMap.set(s.id,r?n:new oe.BehaviorSubject(s)),this._permissionPointUpdate$.next(s),!0):!1}updatePermissionPoint(n,r){const s=this._permissionPointMap.get(n);if(!s)return;const i=s.getValue();i.value=r,i.status=na.DONE,s.next(i),this._permissionPointUpdate$.next(i)}clearPermissionMap(){this._permissionPointMap.clear()}getPermissionPoint(n){const r=this._permissionPointMap.get(n);if(r)return r.getValue()}getPermissionPoint$(n){const r=this._permissionPointMap.get(n);if(r)return r}composePermission$(n){const r=n.map(s=>{var o;const i=(o=this._permissionPointMap)==null?void 0:o.get(s);if(!i)throw new Error(`[PermissionService]: ${s} permissionPoint does not exist!`);return i.asObservable()});return oe.combineLatest(r).pipe(Kr.map(s=>s))}composePermission(n){return n.map(s=>{var o;const i=(o=this._permissionPointMap)==null?void 0:o.get(s);if(!i)throw new Error(`[PermissionService]: ${s} permissionPoint does not exist!`);return i.getValue()})}getAllPermissionPoint(){const n=new Map;return this._permissionPointMap.forEach((r,s)=>{n.set(s,r)}),n}}function Qh(e,t){if(!t)return e;const n=[];for(const r of e){const s=t.find(([i])=>i===r[0]);if(s){if(s[1]===null)continue;n.push([r[0],s[1]])}else n.push(r)}return n}var VR=Object.getOwnPropertyDescriptor,zR=(e,t,n,r)=>{for(var s=r>1?void 0:r?VR(t,n):t,i=e.length-1,o;i>=0;i--)(o=e[i])&&(s=o(s)||s);return s},ra=(e,t)=>(n,r)=>t(n,r,e);const KR=4,ed=Symbol("DependentOn");class sa extends ze{onStarting(){}onReady(){}onRendered(){}onSteady(){}getUnitType(){return this.constructor.type}getPluginName(){return this.constructor.pluginName}}C(sa,"pluginName"),C(sa,"type",ve.UNIVER_UNKNOWN);class XR{constructor(){C(this,"_plugins",[])}addPlugin(t){this._plugins.push(t)}removePlugins(){const t=this._plugins.slice();return this._plugins.length=0,t}forEachPlugin(t){this._plugins.forEach(t)}}function qR(...e){return function(t){t[ed]=e}}f.PluginService=class{constructor(t,n,r){C(this,"_pluginRegistry",new Map);C(this,"_pluginStore",new XR);C(this,"_seenPlugins",new Set);C(this,"_loadedPlugins",new Set);C(this,"_loadedPluginTypes",new Set([ve.UNIVER_UNKNOWN]));C(this,"_flushTimerByType",new Map);this._injector=t,this._lifecycleService=n,this._logService=r}dispose(){this._pluginStore.removePlugins().forEach(t=>t.dispose()),this._flushTimerByType.forEach(t=>clearTimeout(t))}registerPlugin(t,n){this._assertPluginValid(t);const r={plugin:t,options:n};this._pluginRegistry.set(t.pluginName,r),this._logService.debug("[PluginService]",`Plugin "${t.pluginName}" registered.`);const{type:s}=t;this._loadedPluginTypes.has(s)&&(s===ve.UNIVER_UNKNOWN?this._loadFromPlugins([r]):this._flushType(s))}startPluginsForType(t){this._loadedPluginTypes.has(t)||this._loadPluginsForType(t)}_loadPluginsForType(t){const n=Array.from(this._pluginRegistry.keys()),r=[];n.forEach(s=>{const i=this._pluginRegistry.get(s);i.plugin.type===t&&r.push(i)}),this._loadFromPlugins(r),this._loadedPluginTypes.add(t)}_assertPluginValid(t){const{type:n,pluginName:r}=t;if(n===ve.UNRECOGNIZED)throw new Error(`[PluginService]: invalid plugin type for ${t.name}. Please assign a "type" to your plugin.`);if(!r)throw new Error(`[PluginService]: no plugin name for ${t.name}. Please assign a "pluginName" to your plugin.`);if(this._seenPlugins.has(r))throw new Error(`[PluginService]: duplicated plugin name for "${r}". Maybe a plugin that dependents on "${r} has already registered it. In that case please register "${r}" before the that plugin.`);this._seenPlugins.add(t.pluginName)}_flushType(t){this._flushTimerByType.get(t)===void 0&&this._flushTimerByType.set(t,setTimeout(()=>{this._loadPluginsForType(t),this._flushTimerByType.delete(t)},KR))}_loadFromPlugins(t){const n=[],r=new Set,s=o=>{const{plugin:a}=o,{pluginName:l}=a;if(this._loadedPlugins.has(l)||r.has(l))return;r.add(l),this._pluginRegistry.delete(l);const c=a[ed];c&&c.forEach(u=>{const h=this._pluginRegistry.get(u.pluginName);if(h)s(h);else if(!this._seenPlugins.has(u.pluginName)&&!r.has(u.pluginName)){if(a.type===ve.UNIVER_UNKNOWN&&u.type!==ve.UNIVER_UNKNOWN)throw new Error(`[PluginService]: cannot register a plugin with Univer type that depends on a plugin with other type. The dependent is ${a.pluginName} and the dependency is ${u.pluginName}.`);a.type!==u.type&&u.type!==ve.UNIVER_UNKNOWN&&this._logService.debug("[PluginService]",`Plugin "${l}" depends on "${u.pluginName}" which has different type.`),this._logService.debug("[PluginService]",`Plugin "${l}" depends on "${u.pluginName}" which is not registered. Univer will automatically register it with default configuration.`),this._assertPluginValid(u),s({plugin:u,options:void 0})}}),n.push(o)};t.forEach(o=>s(o));const i=n.map(o=>this._initPlugin(o.plugin,o.options));this._pluginsRunLifecycle(i)}_pluginsRunLifecycle(t){const n=this._lifecycleService.stage;if(Xh(n).subscribe(r=>this._runStage(t,r)),n!==ke.Steady){const r=this._lifecycleService.lifecycle$.pipe(oe.skip(1)).subscribe(s=>{this._runStage(t,s),s===ke.Steady&&r.unsubscribe()})}}_runStage(t,n){t.forEach(r=>{switch(n){case ke.Starting:r.onStarting();break;case ke.Ready:r.onReady();break;case ke.Rendered:r.onRendered();break;case ke.Steady:r.onSteady();break}})}_initPlugin(t,n){const r=this._injector.createInstance(t,n);return this._pluginStore.addPlugin(r),this._loadedPlugins.add(t.pluginName),this._logService.debug("[PluginService]",`Plugin "${r.getPluginName()}" loaded.`),r}},f.PluginService=zR([ra(0,Re.Inject(Re.Injector)),ra(1,Re.Inject(f.LifecycleService)),ra(2,Et)],f.PluginService);const ia=Re.createIdentifier("resource-loader-service");var ZR=Object.getOwnPropertyDescriptor,JR=(e,t,n,r)=>{for(var s=r>1?void 0:r?ZR(t,n):t,i=e.length-1,o;i>=0;i--)(o=e[i])&&(s=o(s)||s);return s},QR=(e,t)=>(n,r)=>t(n,r,e);f.ResourceManagerService=class extends ze{constructor(n){super();C(this,"_resourceMap",new Map);C(this,"_register$",new oe.Subject);C(this,"register$",this._register$.asObservable());this._logService=n}getAllResourceHooks(){return[...this._resourceMap.values()]}getResources(n,r){return r?this.getResourcesByType(n,r):this.getAllResourceHooks().map(o=>{const a=o.toJson(n);return{name:o.pluginName,data:a}})}getResourcesByType(n,r){return this.getAllResourceHooks().filter(o=>o.businesses.includes(r)).map(o=>{const a=o.toJson(n);return{name:o.pluginName,data:a}})}registerPluginResource(n){const r=n.pluginName;if(this._resourceMap.has(r))throw new Error(`the pluginName is registered {${r}}`);return this._resourceMap.set(r,n),this._register$.next(n),We(()=>this._resourceMap.delete(r))}disposePluginResource(n){this._resourceMap.delete(n)}loadResources(n,r){this.getAllResourceHooks().forEach(s=>{var o;const i=(o=r==null?void 0:r.find(a=>a.name===s.pluginName))==null?void 0:o.data;if(i)try{const a=s.parseJson(i);s.onLoad(n,a)}catch(a){this._logService.error("[ResourceManagerService]","loadResources error",a)}})}unloadResources(n,r){this.getAllResourceHooks().filter(s=>s.businesses.includes(r)).forEach(s=>{s.onUnLoad(n)})}dispose(){this._register$.complete(),this._resourceMap.clear()}},f.ResourceManagerService=JR([QR(0,Et)],f.ResourceManagerService);class Js extends ze{constructor(){super();C(this,"_darkMode$",new oe.BehaviorSubject(!1));C(this,"darkMode$",this._darkMode$.asObservable());C(this,"_validColorCache",new Map);C(this,"_currentTheme",Xr.defaultTheme);C(this,"_currentTheme$",new oe.BehaviorSubject(this._currentTheme));C(this,"currentTheme$",this._currentTheme$.asObservable());this.disposeWithMe(We(()=>{this._currentTheme=Xr.defaultTheme,this._currentTheme$.complete(),this._darkMode$.complete()}))}get darkMode(){return this._darkMode$.getValue()}isValidThemeColor(n){if(this._validColorCache.has(n))return this._validColorCache.get(n);let r=!1;const s=n.split(".");if(s.length===1)r=n in Xr.defaultTheme;else if(s.length===2){const[i,o]=s;r=i in Xr.defaultTheme&&o in this._currentTheme[i]}return this._validColorCache.set(n,r),r}getCurrentTheme(){return this._currentTheme}setTheme(n){this._currentTheme=n,this._currentTheme$.next(n)}setDarkMode(n){this._darkMode$.next(n)}getColorFromTheme(n){return rl(this._currentTheme,n)}}var eI=Object.getOwnPropertyDescriptor,tI=(e,t,n,r)=>{for(var s=r>1?void 0:r?eI(t,n):t,i=e.length-1,o;i>=0;i--)(o=e[i])&&(s=o(s)||s);return s},oa=(e,t)=>(n,r)=>t(n,r,e);const Qs=Re.createIdentifier("univer.undo-redo.service"),nI=20;class td{dispose(){}async dispatchToHandlers(){return!1}}const nd="univer.command.redo",rd="univer.command.undo",sd=new class extends td{constructor(){super(...arguments);C(this,"type",dr.COMMAND);C(this,"id",rd)}handler(t){const n=t.get(Qs),r=n.pitchTopUndoElement();if(!r)return!1;const s=t.get(fr);return fs(r.undoMutations,s)?(n.popUndoToRedo(),!0):!1}},id=new class extends td{constructor(){super(...arguments);C(this,"type",dr.COMMAND);C(this,"id",nd)}handler(t){const n=t.get(Qs),r=n.pitchTopRedoElement();if(!r)return!1;const s=t.get(fr);return fs(r.redoMutations,s)?(n.popRedoToUndo(),!0):!1}};f.LocalUndoRedoService=class extends ze{constructor(n,r,s){super();C(this,"undoRedoStatus$");C(this,"_undoRedoStatus$",new oe.BehaviorSubject({undos:0,redos:0}));C(this,"_undoStacks",new Map);C(this,"_redoStacks",new Map);C(this,"_batchingStatus",new Map);this._univerInstanceService=n,this._commandService=r,this._contextService=s,this.undoRedoStatus$=this._undoRedoStatus$.asObservable(),this.disposeWithMe(this._commandService.registerCommand(sd)),this.disposeWithMe(this._commandService.registerCommand(id)),this.disposeWithMe(We(()=>this._undoRedoStatus$.complete())),this.disposeWithMe(We(this._univerInstanceService.focused$.subscribe(()=>this._updateStatus())))}pushUndoRedo(n){const{unitID:r}=n,s=this._getRedoStack(r,!0),i=this._getUndoStack(r,!0);if(s.length=0,this._batchingStatus.has(n.unitID)){const a=this._batchingStatus.get(n.unitID),l=this._pitchUndoElement(n.unitID);a===0||!l?(o(n),this._batchingStatus.set(n.unitID,1)):this._tryBatchingElements(l,n)}else o(n);function o(a){i.push(a),i.length>nI&&i.splice(0,1)}this._updateStatus()}clearUndoRedo(n){const r=this._getRedoStack(n);r&&(r.length=0);const s=this._getUndoStack(n);s&&(s.length=0),this._updateStatus()}pitchTopUndoElement(){const n=this._getFocusedUnitId();return this._pitchUndoElement(n)}pitchTopRedoElement(){const n=this._getFocusedUnitId();return this._pitchRedoElement(n)}_pitchUndoElement(n){const r=this._getUndoStack(n);return r!=null&&r.length?r[r.length-1]:null}_pitchRedoElement(n){const r=this._getRedoStack(n);return r!=null&&r.length?r[r.length-1]:null}popUndoToRedo(){const r=this._getUndoStackForFocused().pop();r&&(this._getRedoStackForFocused().push(r),this._updateStatus())}popRedoToUndo(){const r=this._getRedoStackForFocused().pop();r&&(this._getUndoStackForFocused().push(r),this._updateStatus())}rollback(n,r){const s=r||this._getFocusedUnitId(),i=this._getUndoStack(s),o=i==null?void 0:i[(i==null?void 0:i.length)-1];o&&o.id===n&&(i.pop(),fs(o.undoMutations,this._commandService))}__tempBatchingUndoRedo(n){if(this._batchingStatus.has(n))throw new Error("[LocalUndoRedoService]: cannot batching undo redo twice at the same time!");return this._batchingStatus.set(n,0),We(()=>this._batchingStatus.delete(n))}_updateStatus(){var i,o;const n=this._getFocusedUnitId(),r=n&&((i=this._undoStacks.get(n))==null?void 0:i.length)||0,s=n&&((o=this._redoStacks.get(n))==null?void 0:o.length)||0;this._undoRedoStatus$.next({undos:r,redos:s})}_getUndoStack(n,r=!1){let s=this._undoStacks.get(n);return!s&&r&&(s=[],this._undoStacks.set(n,s)),s||null}_getRedoStack(n,r=!1){let s=this._redoStacks.get(n);return!s&&r&&(s=[],this._redoStacks.set(n,s)),s||null}_getUndoStackForFocused(){const n=this._getFocusedUnitId();if(!n)throw new Error("No focused univer instance!");return this._getUndoStack(n,!0)}_getRedoStackForFocused(){const n=this._getFocusedUnitId();if(!n)throw new Error("No focused univer instance!");return this._getRedoStack(n,!0)}_tryBatchingElements(n,r){n.redoMutations.push(...r.redoMutations),n.undoMutations.push(...r.undoMutations)}_getFocusedUnitId(){var o,a,l,c;let n="";const r=this._contextService.getContextValue(Kn),s=this._contextService.getContextValue(bh),i=this._contextService.getContextValue(wh);return r?s?n=ii:i?n=si:n=(a=(o=this._univerInstanceService.getFocusedUnit())==null?void 0:o.getUnitId())!=null?a:"":n=(c=(l=this._univerInstanceService.getFocusedUnit())==null?void 0:l.getUnitId())!=null?c:"",n}},f.LocalUndoRedoService=tI([oa(0,Xn),oa(1,fr),oa(2,Ln)],f.LocalUndoRedoService);class od{constructor(t,n=100){C(this,"_imageCacheMap");this._injector=t,this._imageCacheMap=new _r(n)}_getImageCacheKey(t,n){return`${t}-${n}`}getImage(t,n,r,s){const i=this._getImageCacheKey(t,n),o=this._imageCacheMap.get(i);return o||((async()=>{const a=new Image,l=this._injector.has(Qo)?this._injector.get(Qo):null;if(t===Jo.UUID)try{a.src=await(l==null?void 0:l.getImage(n))||""}catch(c){console.error(c)}else a.src=n;a.onload=()=>{a.removeAttribute("data-error"),r==null||r()},a.onerror=()=>{a.setAttribute("data-error","true"),s==null||s()},this._imageCacheMap.set(i,a)})(),null)}}function rI(e){return!(e.length===0||e.length>31||e.startsWith("'")||e.endsWith("'")||/[:\\\/\?\*\[\]]/.test(e))}function sI(e,t){return!(!e||e.length===0||e.length>255||t.has(e)||/[ :\\\/\?\*\[\]]/.test(e)||!/^[\p{L}_]/u.test(e)||/^\$?[A-Za-z]{1,3}\$?[0-9]+$/.test(e)||/^[rR]\d+[cC]\d+$/.test(e)||/^\d+$/.test(e))}const ad=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],aa=1,Yr=8;class la{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[n,r]=new Uint8Array(t,0,2);if(n!==219)throw new Error("Data does not appear to be in a KDBush format.");const s=r>>4;if(s!==aa)throw new Error(`Got v${s} data when expected v${aa}.`);const i=ad[r&15];if(!i)throw new Error("Unrecognized array type.");const[o]=new Uint16Array(t,2,1),[a]=new Uint32Array(t,4,1);return new la(a,o,i,t)}constructor(t,n=64,r=Float64Array,s){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+n,2),65535),this.ArrayType=r,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const i=ad.indexOf(this.ArrayType),o=t*2*this.ArrayType.BYTES_PER_ELEMENT,a=t*this.IndexArrayType.BYTES_PER_ELEMENT,l=(8-a%8)%8;if(i<0)throw new Error(`Unexpected typed array class: ${r}.`);s&&s instanceof ArrayBuffer?(this.data=s,this.ids=new this.IndexArrayType(this.data,Yr,t),this.coords=new this.ArrayType(this.data,Yr+a+l,t*2),this._pos=t*2,this._finished=!0):(this.data=new ArrayBuffer(Yr+o+a+l),this.ids=new this.IndexArrayType(this.data,Yr,t),this.coords=new this.ArrayType(this.data,Yr+a+l,t*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(aa<<4)+i]),new Uint16Array(this.data,2,1)[0]=n,new Uint32Array(this.data,4,1)[0]=t)}add(t,n){const r=this._pos>>1;return this.ids[r]=r,this.coords[this._pos++]=t,this.coords[this._pos++]=n,r}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return ca(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,n,r,s){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:i,coords:o,nodeSize:a}=this,l=[0,i.length-1,0],c=[];for(;l.length;){const u=l.pop()||0,h=l.pop()||0,d=l.pop()||0;if(h-d<=a){for(let I=d;I<=h;I++){const A=o[2*I],B=o[2*I+1];A>=t&&A<=r&&B>=n&&B<=s&&c.push(i[I])}continue}const m=d+h>>1,_=o[2*m],p=o[2*m+1];_>=t&&_<=r&&p>=n&&p<=s&&c.push(i[m]),(u===0?t<=_:n<=p)&&(l.push(d),l.push(m-1),l.push(1-u)),(u===0?r>=_:s>=p)&&(l.push(m+1),l.push(h),l.push(1-u))}return c}within(t,n,r){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:s,coords:i,nodeSize:o}=this,a=[0,s.length-1,0],l=[],c=r*r;for(;a.length;){const u=a.pop()||0,h=a.pop()||0,d=a.pop()||0;if(h-d<=o){for(let I=d;I<=h;I++)cd(i[2*I],i[2*I+1],t,n)<=c&&l.push(s[I]);continue}const m=d+h>>1,_=i[2*m],p=i[2*m+1];cd(_,p,t,n)<=c&&l.push(s[m]),(u===0?t-r<=_:n-r<=p)&&(a.push(d),a.push(m-1),a.push(1-u)),(u===0?t+r>=_:n+r>=p)&&(a.push(m+1),a.push(h),a.push(1-u))}return l}}function ca(e,t,n,r,s,i){if(s-r<=n)return;const o=r+s>>1;ld(e,t,o,r,s,i),ca(e,t,n,r,o-1,1-i),ca(e,t,n,o+1,s,1-i)}function ld(e,t,n,r,s,i){for(;s>r;){if(s-r>600){const c=s-r+1,u=n-r+1,h=Math.log(c),d=.5*Math.exp(2*h/3),m=.5*Math.sqrt(h*d*(c-d)/c)*(u-c/2<0?-1:1),_=Math.max(r,Math.floor(n-u*d/c+m)),p=Math.min(s,Math.floor(n+(c-u)*d/c+m));ld(e,t,n,_,p,i)}const o=t[2*n+i];let a=r,l=s;for(Gr(e,t,r,n),t[2*s+i]>o&&Gr(e,t,r,s);a<l;){for(Gr(e,t,a,l),a++,l--;t[2*a+i]<o;)a++;for(;t[2*l+i]>o;)l--}t[2*r+i]===o?Gr(e,t,r,l):(l++,Gr(e,t,l,s)),l<=n&&(r=l+1),n<=l&&(s=l-1)}}function Gr(e,t,n,r){ua(e,n,r),ua(t,2*n,2*r),ua(t,2*n+1,2*r+1)}function ua(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function cd(e,t,n,r){const s=e-n,i=t-r;return s*s+i*i}class iI{constructor(t=!1){C(this,"_tree",new Map);C(this,"_oneCellCache",new Map);C(this,"_kdTree",new Map);this._enableOneCellCache=t}dispose(){this.clear()}getTree(t,n){return this._tree.has(t)||this._tree.set(t,new Map),this._tree.get(t).has(n)||this._tree.get(t).set(n,new js),this._tree.get(t).get(n)}_getOneCellCache(t,n,r,s){return this._oneCellCache.has(t)||this._oneCellCache.set(t,new Map),this._oneCellCache.get(t).has(n)||this._oneCellCache.get(t).set(n,new Map),this._oneCellCache.get(t).get(n).has(r)||this._oneCellCache.get(t).get(n).set(r,new Map),this._oneCellCache.get(t).get(n).get(r).has(s)||this._oneCellCache.get(t).get(n).get(r).set(s,new Set),this._oneCellCache.get(t).get(n).get(r).get(s)}_removeOneCellCache(t,n,r,s,i){const o=this._oneCellCache.get(t);if(!o)return;const a=o.get(n);if(!a)return;const l=a.get(r);if(!l)return;const c=l.get(s);c&&c.delete(i)}_removeCellCacheByRange(t){const{unitId:n,sheetId:r,range:s,id:i}=t,o=this._oneCellCache.get(n);if(!o)return;const a=o.get(r);if(!a)return;const{startRow:l,startColumn:c,endRow:u,endColumn:h}=s;for(let d=l;d<=u;d++){const m=a.get(d);if(m)for(let _=c;_<=h;_++){const p=m.get(_);p&&p.delete(i)}}}_insertOneCellCache(t,n,r,s,i){this._getOneCellCache(t,n,r,s).add(i)}_getRdTreeItems(t){const n=[];for(const[r,s]of t)for(const[i,o]of s)n.push({x:i,y:r,ids:o});return n}_searchByOneCellCache(t){var _;const{unitId:n,sheetId:r,range:s}=t,{startRow:i,startColumn:o,endRow:a,endColumn:l}=s,c=(_=this._kdTree.get(n))==null?void 0:_.get(r);if(!c)return[];const{tree:u,items:h}=c,d=u.range(o,i,l,a),m=[];for(const p of d){const I=h[p];m.push(...Array.from(I.ids))}return m}openKdTree(){var t;for(const[n,r]of this._oneCellCache){this._kdTree.has(n)||this._kdTree.set(n,new Map);for(const[s,i]of r){const o=this._getRdTreeItems(i),a=new la(o.length);(t=this._kdTree.get(n))==null||t.set(s,{tree:a,items:o});for(const l of o)a.add(l.x,l.y);a.finish()}}}closeKdTree(){var t;for(const[n,r]of this._oneCellCache)for(const[s,i]of r)(t=this._kdTree.get(n))==null||t.set(s,void 0)}insert(t){const{unitId:n,sheetId:r,range:s,id:i}=t;if(!n||n.length===0)return;let{startRow:o,endRow:a,startColumn:l,endColumn:c}=s;if(this._enableOneCellCache&&o===a&&l===c){this._insertOneCellCache(n,r,o,l,i);return}const u=this.getTree(n,r);Number.isNaN(o)&&(o=0),Number.isNaN(l)&&(l=0),Number.isNaN(a)&&(a=Number.POSITIVE_INFINITY),Number.isNaN(c)&&(c=Number.POSITIVE_INFINITY),u.insert({minX:l,minY:o,maxX:c,maxY:a,id:i})}bulkInsert(t){for(const n of t)this.insert(n)}*searchGenerator(t){var a;const{unitId:n,sheetId:r,range:s}=t;if(this._enableOneCellCache){const l=this._searchByOneCellCache(t);for(const c of l)yield c}const i=(a=this._tree.get(n))==null?void 0:a.get(r);if(!i)return;const o=i.search({minX:s.startColumn,minY:s.startRow,maxX:s.endColumn,maxY:s.endRow});for(const l of o)yield l.id}bulkSearch(t,n){const r=new Set;for(const s of t)for(const i of this.searchGenerator(s))(n==null?void 0:n.has(i))!==!0&&r.add(i);return r}removeById(t,n){var r,s;n?((r=this._tree.get(t))==null||r.delete(n),(s=this._oneCellCache.get(t))==null||s.delete(n)):(this._tree.delete(t),this._oneCellCache.delete(t))}_removeRTreeItem(t){const{unitId:n,sheetId:r,range:s,id:i}=t,o=this.getTree(n,r),a=o.search({minX:s.startColumn,minY:s.startRow,maxX:s.endColumn,maxY:s.endRow});for(let l=0;l<a.length;l++)a[l].id===i&&o.remove(a[l])}remove(t){const{unitId:n,sheetId:r,range:s,id:i}=t,{startRow:o,startColumn:a,endRow:l,endColumn:c}=s;this._enableOneCellCache?o===l&&a===c?this._removeOneCellCache(n,r,s.startRow,s.startColumn,i):(this._removeCellCacheByRange(t),this._removeRTreeItem(t)):this._removeRTreeItem(t)}bulkRemove(t){for(const n of t)this.remove(n)}clear(){this._tree.clear(),this._oneCellCache.clear()}toJSON(){const t={};return this._tree.forEach((n,r)=>{t[r]={},n.forEach((s,i)=>{t[r][i]=s.toJSON()})}),t}fromJSON(t){this._tree.clear();for(const n in t){this._tree.set(n,new Map);for(const r in t[n]){const s=new js;s.fromJSON(t[n][r]),this._tree.get(n).set(r,s)}}}}function oI(e){return new Promise(t=>setTimeout(t,e))}function aI(e=1){return new Promise(t=>{let n=0;const r=()=>{n++,n>=e?t():requestAnimationFrame(r)};requestAnimationFrame(r)})}var lI=Object.getOwnPropertyDescriptor,cI=(e,t,n,r)=>{for(var s=r>1?void 0:r?lI(t,n):t,i=e.length-1,o;i>=0;i--)(o=e[i])&&(s=o(s)||s);return s},uI=(e,t)=>(n,r)=>t(n,r,e);f.Skeleton=class extends ze{constructor(n){super();C(this,"_fontLocale");C(this,"_dirty",!0);this._localeService=n,this._localeInitial()}get dirty(){return this._dirty}getFontLocale(){return this._fontLocale}makeDirty(n){this._dirty=n}dispose(){super.dispose(),this._fontLocale=null}_localeInitial(){}},f.Skeleton=cI([uI(0,Re.Inject(Sn))],f.Skeleton);var hI=Object.getOwnPropertyDescriptor,dI=(e,t,n,r)=>{for(var s=r>1?void 0:r?hI(t,n):t,i=e.length-1,o;i>=0;i--)(o=e[i])&&(s=o(s)||s);return s},ei=(e,t)=>(n,r)=>t(n,r,e);f.SheetSkeleton=class extends f.Skeleton{constructor(n,r,s,i,o,a){super(s);C(this,"_worksheetData");C(this,"_renderRawFormula",!1);C(this,"_cellData");C(this,"_imageCacheMap");C(this,"_skipAutoHeightForMergedCells",!0);C(this,"_rowTotalHeight",0);C(this,"_columnTotalWidth",0);C(this,"_rowHeaderWidth",0);C(this,"_columnHeaderHeight",0);C(this,"_rowHeightAccumulation",[]);C(this,"_columnWidthAccumulation",[]);C(this,"_marginTop",0);C(this,"_marginLeft",0);C(this,"_scaleX");C(this,"_scaleY");C(this,"_scrollX");C(this,"_scrollY");this.worksheet=n,this._styles=r,this._contextService=i,this._configService=o,this._injector=a,this._worksheetData=this.worksheet.getConfig(),this._cellData=this.worksheet.getCellMatrix(),this._imageCacheMap=new od(this._injector),this.initConfig()}initConfig(){var n,r;this._skipAutoHeightForMergedCells=!((n=this._configService.getConfig(Ca))!=null&&n),this.worksheet.setIsRowStylePrecedeColumnStyle((r=this._configService.getConfig(Ea))!=null?r:!1)}resetCache(){}getWorksheetConfig(){return this._worksheetData}getLocation(){return[this.worksheet.getUnitId(),this.worksheet.getSheetId()]}set columnHeaderHeight(n){this._columnHeaderHeight=n,this._worksheetData.columnHeader.height=n}set rowHeaderWidth(n){this._rowHeaderWidth=n,this._worksheetData.rowHeader.width=n}get rowHeightAccumulation(){return this._rowHeightAccumulation}get rowTotalHeight(){return this._rowTotalHeight}get columnWidthAccumulation(){return this._columnWidthAccumulation}get columnTotalWidth(){return this._columnTotalWidth}get rowHeaderWidth(){return this._rowHeaderWidth}get columnHeaderHeight(){return this._columnHeaderHeight}setMarginLeft(n){this._marginLeft=n}setMarginTop(n){this._marginTop=n}setScale(n,r){this._updateLayout(),this._scaleX=n,this._scaleY=r||n,this._updateLayout()}setScroll(n,r){Z.isDefine(n)&&(this._scrollX=n),Z.isDefine(r)&&(this._scrollY=r)}get scrollX(){return this._scrollX}get scrollY(){return this._scrollY}get scaleX(){return this._scaleX}get scaleY(){return this._scaleY}get rowHeaderWidthAndMarginLeft(){return this.rowHeaderWidth+this._marginLeft}get columnHeaderHeightAndMarginTop(){return this.columnHeaderHeight+this._marginTop}get imageCacheMap(){return this._imageCacheMap}_generateRowMatrixCache(n,r,s){let i=0;const o=[],a=r;for(let l=0;l<n;l++){let c=s;if(this.worksheet.getRowFiltered(l))c=0;else if(a[l]!=null){const u=a[l];if(!u)continue;const{h=s,ah:d,ia:m}=u;(m==null||m===ae.TRUE)&&typeof d=="number"?c=d:c=h,u.hd===ae.TRUE&&(c=0)}i+=c,o.push(i)}return{rowTotalHeight:i,rowHeightAccumulation:o}}_generateColumnMatrixCache(n,r,s){let i=0;const o=[],a=r;for(let l=0;l<n;l++){let c=s;if(a[l]!=null){const u=a[l];if(!u)continue;u.w!=null&&(c=u.w),u.hd===ae.TRUE&&(c=0)}i+=c,o.push(i)}return{columnTotalWidth:i,columnWidthAccumulation:o}}intersectMergeRange(n,r){return!!this.worksheet.getMergedCell(n,r)}_getOverflowBound(n,r,s,i,o=vt.LEFT){let a=0;if(r>s){const l=this._columnWidthAccumulation.length-1;for(let c=r;c>=s;c--){const u=c,h=this.worksheet.getCell(n,u);if(!Bi(h)&&u!==r||this.intersectMergeRange(n,u))return u===r?u:u+1>l?l:u+1;const{startX:d,endX:m}=qn(n,u,this.rowHeightAccumulation,this.columnWidthAccumulation);if(o===vt.CENTER&&u===r?a+=(m-d)/2:a+=m-d,i<a)return u}return r}for(let l=r;l<=s;l++){const c=l,u=this.worksheet.getCell(n,c);if(!Bi(u)&&c!==r||this.intersectMergeRange(n,c))return c===r?c:c-1<0?0:c-1;const{startX:h,endX:d}=qn(n,c,this.rowHeightAccumulation,this.columnWidthAccumulation);if(o===vt.CENTER&&c===r?a+=(d-h)/2:a+=d-h,i<a)return c}return s}_updateLayout(){if(!this.dirty)return;const{rowData:n,columnData:r,defaultRowHeight:s,defaultColumnWidth:i,rowCount:o,columnCount:a,rowHeader:l,columnHeader:c}=this._worksheetData,{rowTotalHeight:u,rowHeightAccumulation:h}=this._generateRowMatrixCache(o,n,s),{columnTotalWidth:d,columnWidthAccumulation:m}=this._generateColumnMatrixCache(a,r,i);this._rowHeaderWidth=l.hidden!==ae.TRUE?this._dynamicallyUpdateRowHeaderWidth(l):0,this._columnHeaderHeight=c.hidden!==ae.TRUE?c.height:0,this._rowTotalHeight=u,this._rowHeightAccumulation=h,this._columnTotalWidth=d,this._columnWidthAccumulation=m,this.makeDirty(!1)}calculate(){return this.resetCache(),this._updateLayout(),this}resetRangeCache(n){}_dynamicallyUpdateRowHeaderWidth(n){const s=`${this.worksheet.getRowCount()}`.length*8;return Math.max(n.width,s)}_hasUnMergedCellInRow(n,r,s){if(!this.worksheet.getMergeData())return!1;for(let o=r;o<=s;o++){const{isMerged:a,isMergedMainCell:l}=this.worksheet.getCellInfoInMergeData(n,o);if(!a&&!l)return!0}return!1}expandRangeByMerge(n){let{startRow:r,startColumn:s,endRow:i,endColumn:o}=n;const a=this._worksheetData.mergeData;if(!a)return{startRow:r,startColumn:s,endRow:i,endColumn:o};let l=!0;const c=new ut;for(;l;){l=!1;for(let u=0;u<a.length;u++){const{startRow:h,startColumn:d,endRow:m,endColumn:_}=a[u];if(c.getValue(h,d))continue;Bu({startColumn:s,startRow:r,endColumn:o,endRow:i},{startColumn:d,startRow:h,endColumn:_,endRow:m})&&(r=Math.min(r,h),s=Math.min(s,d),i=Math.max(i,m),o=Math.max(o,_),c.setValue(h,d,!0),l=!0)}}return{startRow:r,startColumn:s,endRow:i,endColumn:o}}getColumnCount(){return this._columnWidthAccumulation.length}getRowCount(){return this._rowHeightAccumulation.length}_getCellMergeInfo(n,r){return this.worksheet.getCellInfoInMergeData(n,r)}getNoMergeCellPositionByIndex(n,r,s=!0){return this.getNoMergeCellWithCoordByIndex(n,r,s)}getNoMergeCellWithCoordByIndex(n,r,s=!0){const{rowHeightAccumulation:i,columnWidthAccumulation:o,rowHeaderWidthAndMarginLeft:a,columnHeaderHeightAndMarginTop:l}=this;let{startY:c,endY:u,startX:h,endX:d}=qn(n,r,i,o);return s&&(c+=l,u+=l,h+=a,d+=a),{startY:c,endY:u,startX:h,endX:d}}getNoMergeCellPositionByIndexWithNoHeader(n,r){const{rowHeightAccumulation:s,columnWidthAccumulation:i}=this,{startY:o,endY:a,startX:l,endX:c}=qn(n,r,s,i);return{startY:o,endY:a,startX:l,endX:c}}getRowIndexByOffsetY(n,r,s,i){var l;const{rowHeightAccumulation:o}=this;n=hd(n,r,s,this.columnHeaderHeightAndMarginTop);let a=mr(o,n,i==null?void 0:i.firstMatch);return i!=null&&i.closeFirst&&Math.abs(o[a]-n)<Math.abs(n-((l=o[a-1])!=null?l:0))&&(a=a+1),a}getColumnIndexByOffsetX(n,r,s,i){var c;const o=ud(n,r,s,this.rowHeaderWidthAndMarginLeft),{columnWidthAccumulation:a}=this;let l=mr(a,o,i==null?void 0:i.firstMatch);return i!=null&&i.closeFirst&&Math.abs(a[l]-o)<Math.abs(o-((c=a[l-1])!=null?c:0))&&(l=l+1),l}getCellIndexByOffset(n,r,s,i,o,a){const l=this.getRowIndexByOffsetY(r,i,o,a),c=this.getColumnIndexByOffsetX(n,s,o,a);return{row:l,column:c}}getCellByOffset(n,r,s,i,o){const a=this==null?void 0:this.getCellIndexByOffset(n,r,s,i,o,{firstMatch:!0});return a?this.worksheet.getCellInfoInMergeData(a.row,a.column):null}getCellWithCoordByIndex(n,r,s=!0){const{rowHeightAccumulation:i,columnWidthAccumulation:o,rowHeaderWidthAndMarginLeft:a,columnHeaderHeightAndMarginTop:l}=this,c=qn(n,r,i,o,this.worksheet.getCellInfoInMergeData(n,r)),{isMerged:u,isMergedMainCell:h}=c;let{startY:d,endY:m,startX:_,endX:p,mergeInfo:I}=c,A=a,B=l;return s===!1&&(A=0,B=0),d+=B,m+=B,_+=A,p+=A,I.startY+=B,I.endY+=B,I.startX+=A,I.endX+=A,{actualRow:n,actualColumn:r,startX:_,startY:d,endX:p,endY:m,isMerged:u,isMergedMainCell:h,mergeInfo:I}}getCellWithCoordByOffset(n,r,s,i,o,a){const{row:l,column:c}=this.getCellIndexByOffset(n,r,s,i,o,a);return this.getCellWithCoordByIndex(l,c)}getOffsetByColumn(n){const{columnWidthAccumulation:r,rowHeaderWidthAndMarginLeft:s}=this,i=r.length-1,o=r[n];return o!=null?o+s:n<0?s:r[i]+s}getOffsetByRow(n){const{rowHeightAccumulation:r,columnHeaderHeightAndMarginTop:s}=this,i=r.length-1,o=r[n];return o!=null?o+s:n<0?s:r[i]+s}getOffsetRelativeToRowCol(n,r){const s=mr(this.columnWidthAccumulation,n);let i=0;s===0?i=n:i=n-this._columnWidthAccumulation[s-1];const o=mr(this.rowHeightAccumulation,r);let a=0;return o===0?a=r:a=r-this._rowHeightAccumulation[o-1],{row:o,column:s,columnOffset:i,rowOffset:a}}_updateConfigAndGetDocumentModel(n,r,s,i){var a,l,c,u,h;if(!i||!((a=n.body)!=null&&a.dataStream))return;n.documentStyle||(n.documentStyle={}),n.documentStyle.marginTop=(l=s.t)!=null?l:0,n.documentStyle.marginBottom=(c=s.b)!=null?c:2,n.documentStyle.marginLeft=(u=s.l)!=null?u:2,n.documentStyle.marginRight=(h=s.r)!=null?h:2,n.documentStyle.pageSize={width:Number.POSITIVE_INFINITY,height:Number.POSITIVE_INFINITY},n.documentStyle.renderConfig={...n.documentStyle.renderConfig,...i};const o=n.body.paragraphs||[];for(const d of o)d.paragraphStyle||(d.paragraphStyle={}),d.paragraphStyle.horizontalAlign=r;return new At(n)}dispose(){super.dispose(),this._rowHeightAccumulation=[],this._columnWidthAccumulation=[],this._rowTotalHeight=0,this._columnTotalWidth=0,this._rowHeaderWidth=0,this._columnHeaderHeight=0,this._worksheetData=null,this._cellData=null,this._styles=null,this.worksheet=null}},f.SheetSkeleton=dI([ei(2,Re.Inject(Sn)),ei(3,Ln),ei(4,Zo),ei(5,Re.Inject(Re.Injector))],f.SheetSkeleton);function ha(e,t,n,r){const s=e-1,i=t-1,o=n[s]||0;let a=n[e];a==null&&(a=n[n.length-1]);const l=r[i]||0;let c=r[t];return c==null&&(c=r[r.length-1]),{startY:o,endY:a,startX:l,endX:c}}function fI(e,t,n,r){return ha(e,t,n,r)}function qn(e,t,n,r,s){e=Z.clamp(e,0,n.length-1),t=Z.clamp(t,0,r.length-1);let{startY:i,endY:o,startX:a,endX:l}=ha(e,t,n,r);if(!s)return{startY:i,endY:o,startX:a,endX:l,isMerged:!1,isMergedMainCell:!1,actualRow:e,actualColumn:t,mergeInfo:{startY:i,endY:o,startX:a,endX:l,startRow:e,startColumn:t,endRow:e,endColumn:t}};const{isMerged:c,isMergedMainCell:u,startRow:h,startColumn:d,endRow:m,endColumn:_}=s;let p={startRow:h,startColumn:d,endRow:m,endColumn:_,startY:i,endY:o,startX:a,endX:l};const I=n.length-1,A=r.length-1;if(c&&h!==-1&&d!==-1){const B=n[h-1]||0,x=n[m]||n[I],Y=r[d-1]||0,O=r[_]||r[A];p={...p,startY:B,endY:x,startX:Y,endX:O}}else if(!c&&m!==-1&&_!==-1){const B=n[m]||n[I],x=r[_]||r[A];p={...p,startY:i,endY:B,startX:a,endX:x}}return{isMerged:c,isMergedMainCell:u,actualRow:e,actualColumn:t,startY:i,endY:o,startX:a,endX:l,mergeInfo:p}}function ud(e,t,n,r){const{x:s}=n;return e/t+s-r}function hd(e,t,n,r){const{y:s}=n;return e=e/t+s-r,e}const mI=["script","style","meta","comment","link"];var dd=(e=>(e[e.INFO=0]="INFO",e[e.STOP=1]="STOP",e[e.WARNING=2]="WARNING",e))(dd||{}),fd=(e=>(e[e.DISABLED=0]="DISABLED",e[e.FULL_ALPHA=1]="FULL_ALPHA",e[e.FULL_HANGUL=2]="FULL_HANGUL",e[e.FULL_KATAKANA=3]="FULL_KATAKANA",e[e.HALF_ALPHA=4]="HALF_ALPHA",e[e.HALF_HANGUL=5]="HALF_HANGUL",e[e.HALF_KATAKANA=6]="HALF_KATAKANA",e[e.HIRAGANA=7]="HIRAGANA",e[e.NO_CONTROL=8]="NO_CONTROL",e[e.OFF=9]="OFF",e[e.ON=10]="ON",e))(fd||{}),md=(e=>(e.BETWEEN="between",e.EQUAL="equal",e.GREATER_THAN="greaterThan",e.GREATER_THAN_OR_EQUAL="greaterThanOrEqual",e.LESS_THAN="lessThan",e.LESS_THAN_OR_EQUAL="lessThanOrEqual",e.NOT_BETWEEN="notBetween",e.NOT_EQUAL="notEqual",e))(md||{}),gd=(e=>(e[e.TEXT=0]="TEXT",e[e.ARROW=1]="ARROW",e[e.CUSTOM=2]="CUSTOM",e))(gd||{}),_d=(e=>(e.VALID="valid",e.INVALID="invalid",e.VALIDATING="validating",e))(_d||{}),pd=(e=>(e.CUSTOM="custom",e.LIST="list",e.LIST_MULTIPLE="listMultiple",e.NONE="none",e.TEXT_LENGTH="textLength",e.DATE="date",e.TIME="time",e.WHOLE="whole",e.DECIMAL="decimal",e.CHECKBOX="checkbox",e.ANY="any",e))(pd||{}),gI=Object.getOwnPropertyDescriptor,_I=(e,t,n,r)=>{for(var s=r>1?void 0:r?gI(t,n):t,i=e.length-1,o;i>=0;i--)(o=e[i])&&(s=o(s)||s);return s},Ed=(e,t)=>(n,r)=>t(n,r,e);let da=class extends ze{constructor(e,t){super(),this._resourceManagerService=e,this._univerInstanceService=t,this._init()}_init(){const e=n=>{n.businesses.forEach(r=>{switch(r){case ve.UNRECOGNIZED:case ve.UNIVER_UNKNOWN:case ve.UNIVER_SLIDE:case ve.UNIVER_DOC:{this._univerInstanceService.getAllUnitsForType(ve.UNIVER_DOC).forEach(s=>{const o=(s.getSnapshot().resources||[]).find(a=>a.name===n.pluginName);if(o)try{const a=n.parseJson(o.data);n.onLoad(s.getUnitId(),a)}catch{console.error(`Load Document{${s.getUnitId()}} Resources{${n.pluginName}} Data Error.`)}});break}case ve.UNIVER_SHEET:this._univerInstanceService.getAllUnitsForType(ve.UNIVER_SHEET).forEach(s=>{const o=(s.getSnapshot().resources||[]).find(a=>a.name===n.pluginName);if(o)try{const a=n.parseJson(o.data);n.onLoad(s.getUnitId(),a)}catch{console.error(`Load Workbook{${s.getUnitId()}} Resources{${n.pluginName}} Data Error.`)}})}})};this._resourceManagerService.getAllResourceHooks().forEach(n=>e(n)),this.disposeWithMe(this._resourceManagerService.register$.subscribe(n=>e(n))),this.disposeWithMe(this._univerInstanceService.getTypeOfUnitAdded$(ve.UNIVER_SHEET).subscribe(n=>{this._resourceManagerService.loadResources(n.getUnitId(),n.getSnapshot().resources)})),this.disposeWithMe(this._univerInstanceService.getTypeOfUnitAdded$(ve.UNIVER_DOC).subscribe(n=>{const r=n.getUnitId();Ra(r)||this._resourceManagerService.loadResources(n.getUnitId(),n.getSnapshot().resources)})),this.disposeWithMe(this._univerInstanceService.getTypeOfUnitDisposed$(ve.UNIVER_SHEET).subscribe(n=>{this._resourceManagerService.unloadResources(n.getUnitId(),ve.UNIVER_SHEET)})),this.disposeWithMe(this._univerInstanceService.getTypeOfUnitDisposed$(ve.UNIVER_DOC).subscribe(n=>{this._resourceManagerService.unloadResources(n.getUnitId(),ve.UNIVER_DOC)}))}saveUnit(e){const t=this._univerInstanceService.getUnit(e);if(!t)return null;const n=this._resourceManagerService.getResources(e,t.type),r=Z.deepClone(t.getSnapshot());return r.resources=n,r}};da=_I([Ed(0,Re.Inject(qs)),Ed(1,Re.Inject(Xn))],da);class pI{constructor(t={},n){C(this,"_startedTypes",new Set);C(this,"_injector");C(this,"_disposingCallbacks",new ss);const r=this._injector=EI(n,t==null?void 0:t.override),{theme:s,darkMode:i,locale:o,locales:a,logLevel:l}=t;s&&this._injector.get(Js).setTheme(s),i&&this._injector.get(Js).setDarkMode(i),a&&this._injector.get(Sn).load(a),o&&this._injector.get(Sn).setLocale(o),l&&this._injector.get(Et).setLogLevel(l),this._init(r)}get _univerInstanceService(){return this._injector.get(Xn)}get _pluginService(){return this._injector.get(f.PluginService)}__getInjector(){return this._injector}onDispose(t){const n=this._disposingCallbacks.add(We(t));return We(()=>n.dispose(!0))}dispose(){this._disposingCallbacks.dispose(),this._injector.dispose()}setLocale(t){this._injector.get(Sn).setLocale(t)}createUnit(t,n){return this._univerInstanceService.createUnit(t,n)}createUniverSheet(t){return this._injector.get(Et).warn("[Univer]","Univer.createUniverSheet is deprecated, use createUnit instead"),this._univerInstanceService.createUnit(ve.UNIVER_SHEET,t)}createUniverDoc(t){return this._injector.get(Et).warn("[Univer]","Univer.createUniverDoc is deprecated, use createUnit instead"),this._univerInstanceService.createUnit(ve.UNIVER_DOC,t)}createUniverSlide(t){return this._injector.get(Et).warn("[Univer]","Univer.createUniverSlide is deprecated, use createUnit instead"),this._univerInstanceService.createUnit(ve.UNIVER_SLIDE,t)}_init(t){this._univerInstanceService.registerCtorForType(ve.UNIVER_SHEET,f.Workbook),this._univerInstanceService.registerCtorForType(ve.UNIVER_DOC,At),this._univerInstanceService.registerCtorForType(ve.UNIVER_SLIDE,ta);const n=t.get(Xn);n.__setCreateHandler((r,s,i,o)=>{if(!this._startedTypes.has(r)){this._pluginService.startPluginsForType(r),this._startedTypes.add(r);const l=t.createInstance(i,s);return n.__addUnit(l,o),this._tryProgressToReady(),l}const a=t.createInstance(i,s);return n.__addUnit(a,o),a})}_tryProgressToReady(){this._injector.get(f.LifecycleService).stage<ke.Ready&&(this._injector.get(f.LifecycleService).stage=ke.Ready)}registerPlugin(t,n){this._pluginService.registerPlugin(t,n)}registerPlugins(t){t.forEach(n=>{const[r,s]=n;this._pluginService.registerPlugin(r,s)})}}function EI(e,t){const n=Qh([[Ah],[Sn],[Js],[f.LifecycleService],[f.PluginService],[xr],[Xn,{useClass:f.UniverInstanceService}],[Zh,{useClass:Jh}],[Et,{useClass:Oc,lazy:!0}],[fr,{useClass:f.CommandService}],[Qs,{useClass:f.LocalUndoRedoService,lazy:!0}],[Zo,{useClass:vh}],[Ln,{useClass:Ic}],[qs,{useClass:f.ResourceManagerService,lazy:!0}],[ia,{useClass:da,lazy:!0}],[Oh,{useClass:f.AuthzIoLocalService}],[qh,{useClass:f.MentionIOLocalService,lazy:!0}]],t),r=e?e.createChild(n):new Re.Injector(n);return Ia(r,[[xr],[ia]]),r}bd(),f.ABCToNumber=$0,f.AUTO_HEIGHT_FOR_MERGED_CELLS=Ca,f.AbsoluteRefType=Ne,f.ActionIterator=zn,f.AlignTypeH=tc,f.AlignTypeV=nc,f.ArrangeTypeEnum=ic,f.ArrowsAndMarkersShapes=Al,f.AsyncInterceptorManager=zd,f.AsyncLock=kd,f.AutoFillSeries=_l,f.BaselineOffset=Ht,f.BasicShapes=bl,f.BlockType=Pl,f.BooleanNumber=ae,f.BorderStyleTypes=Ue,f.BorderType=pl,f.BuildTextUtils=Je,f.BulletAlignment=ur,f.COLORS=Ui,f.CanceledError=Hd,f.CellModeEnum=Dn,f.CellValueType=Zt,f.Color=En,f.ColorBuilder=gs,f.ColorKit=Ct,f.ColorType=pt,f.ColumnSeparatorType=xl,f.CommandType=dr,f.CommonHideTypes=El,f.ConfigService=vh,f.ContextService=Ic,f.CopyPasteType=Cl,f.CustomCommandExecutionError=qr,f.CustomDecorationType=gn,f.CustomRangeType=Jt,f.DEFAULT_CELL=_0,f.DEFAULT_DOC=Yo,f.DEFAULT_DOCUMENT_SUB_COMPONENT_ID=eR,f.DEFAULT_EMPTY_DOCUMENT_VALUE=pa,f.DEFAULT_NUMBER_FORMAT=Du,f.DEFAULT_RANGE=m0,f.DEFAULT_RANGE_ARRAY=f0,f.DEFAULT_SELECTION=g0,f.DEFAULT_SLIDE=Uu,f.DEFAULT_STYLES=st,f.DEFAULT_TEXT_FORMAT=Mu,f.DEFAULT_TEXT_FORMAT_EXCEL=Lu,f.DEFAULT_WORKSHEET_COLUMN_COUNT=Fh,f.DEFAULT_WORKSHEET_COLUMN_COUNT_KEY=bR,f.DEFAULT_WORKSHEET_COLUMN_TITLE_HEIGHT=Hh,f.DEFAULT_WORKSHEET_COLUMN_TITLE_HEIGHT_KEY=NR,f.DEFAULT_WORKSHEET_COLUMN_WIDTH=Bh,f.DEFAULT_WORKSHEET_COLUMN_WIDTH_KEY=TR,f.DEFAULT_WORKSHEET_ROW_COUNT=kh,f.DEFAULT_WORKSHEET_ROW_COUNT_KEY=wR,f.DEFAULT_WORKSHEET_ROW_HEIGHT=xh,f.DEFAULT_WORKSHEET_ROW_HEIGHT_KEY=AR,f.DEFAULT_WORKSHEET_ROW_TITLE_WIDTH=$h,f.DEFAULT_WORKSHEET_ROW_TITLE_WIDTH_KEY=yR,f.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY=ii,f.DOCS_NORMAL_EDITOR_UNIT_ID_KEY=si,f.DOCS_ZEN_EDITOR_UNIT_ID_KEY=_a,f.DOC_DRAWING_PRINTING_COMPONENT_KEY=I0,f.DOC_RANGE_TYPE=kc,f.DashStyleType=Yl,f.DataStreamTreeNodeType=gh,f.DataStreamTreeTokenType=lt,f.DataValidationErrorStyle=dd,f.DataValidationImeMode=fd,f.DataValidationOperator=md,f.DataValidationRenderMode=gd,f.DataValidationStatus=_d,f.DataValidationType=pd,f.DeleteDirection=Rl,f.DependentOn=qR,f.DesktopLogService=Oc,f.DeveloperMetadataVisibility=Il,f.Dimension=Sl,f.Direction=Ol,f.Disposable=ze,f.DisposableCollection=ss,f.DocStyleType=Dl,f.DocumentDataModel=At,f.DocumentFlavor=wi,f.DrawingTypeEnum=oc,f.EDITOR_ACTIVATED=wh,f.EXTENSION_NAMES=Pu,f.ErrorService=Ah,f.EventState=Ih,f.EventSubject=tR,f.FOCUSING_COMMON_DRAWINGS=dR,f.FOCUSING_DOC=$r,f.FOCUSING_EDITOR_BUT_HIDDEN=oR,f.FOCUSING_EDITOR_INPUT_FORMULA=aR,f.FOCUSING_EDITOR_STANDALONE=cR,f.FOCUSING_FX_BAR_EDITOR=bh,f.FOCUSING_PANEL_EDITOR=uR,f.FOCUSING_SHEET=Kn,f.FOCUSING_SLIDE=Hr,f.FOCUSING_UNIT=Br,f.FOCUSING_UNIVER_EDITOR=lR,f.FOCUSING_UNIVER_EDITOR_STANDALONE_SINGLE_MODE=hR,f.FORMULA_EDITOR_ACTIVATED=fR,f.FollowNumberWithType=Ul,f.FontItalic=as,f.FontStyleType=Mn,f.FontWeight=ls,f.GridType=kl,f.HLSColor=Mc,f.HorizontalAlign=vt,f.IAuthzIoService=Oh,f.ICommandService=fr,f.IConfigService=Zo,f.IContextService=Ln,f.IImageIoService=Qo,f.ILocalStorageService=jR,f.ILogService=Et,f.IMentionIOService=qh,f.IPermissionService=Zh,f.IResourceLoaderService=ia,f.IResourceManagerService=qs,f.IS_ROW_STYLE_PRECEDE_COLUMN_STYLE=Ea,f.IUndoRedoService=Qs,f.IUniverInstanceService=Xn,f.ImageCacheMap=od,f.ImageSourceType=Jo,f.ImageUploadStatusType=Th,f.InterceptorEffectEnum=bn,f.InterceptorManager=Yd,f.InterpolationPointType=vl,f.JSON1=M_,f.JSONX=Wt,f.LRUHelper=pr,f.LRUMap=_r,f.LifecycleStages=ke,f.LifecycleUnreachableError=Kh,f.ListGlyphType=fe,f.LocaleService=Sn,f.LocaleType=lr,f.LogLevel=Sc,f.MOVE_BUFFER_VALUE=gr,f.MemoryCursor=dn,f.MentionType=os,f.NAMED_STYLE_MAP=E0,f.NAMED_STYLE_SPACE_MAP=C0,f.NamedStyleType=qe,f.NilCommand=wc,f.NumberUnitType=ec,f.ObjectMatrix=ut,f.ObjectRelativeFromH=Jl,f.ObjectRelativeFromV=Ql,f.OtherShapes=Tl,f.PAGE_SIZE=S0,f.PAPER_TYPES=O_,f.PRESET_LIST_TYPE=Ur,f.PRINT_CHART_COMPONENT_KEY=R0,f.PageElementType=ac,f.PageOrientType=sc,f.PageType=bi,f.PaperType=ct,f.ParagraphElementType=$l,f.ParagraphStyleBuilder=Fr,f.ParagraphStyleValue=kr,f.PermissionService=Jh,f.PermissionStatus=na,f.Plugin=sa,f.PositionedObjectLayoutType=jl,f.PresetListType=Ft,f.ProtectionType=wl,f.QuickListType=rh,f.QuickListTypeMap=Z0,f.RANGE_DIRECTION=Pc,f.RANGE_TYPE=pe,f.RBush=js,f.RCDisposable=c_,f.RGBA_PAREN=z_,f.RGB_PAREN=V_,f.ROTATE_BUFFER_VALUE=yc,f.RTree=iI,f.Range=jn,f.Rectangle=nn,f.RedoCommand=id,f.RedoCommandId=nd,f.RefAlias=B0,f.Registry=Ii,f.RegistryAsMap=Si,f.RelativeDate=Nl,f.RelativeSlideLink=lc,f.RgbColor=_s,f.RichTextBuilder=In,f.RichTextValue=on,f.RxDisposable=l_,f.SHEET_EDITOR_UNITS=p0,f.SectionType=Fl,f.SheetTypes=Ml,f.SheetViewModel=Wh,f.SliceBodyType=jo,f.SlideDataModel=ta,f.SpacingRule=Wl,f.SpecialShapes=yl,f.Styles=yh,f.THEME_COLORS=Nc,f.TabStopAlignment=Gl,f.TableAlignmentType=zl,f.TableLayoutType=Kl,f.TableRowHeightRule=ql,f.TableSizeType=Vl,f.TableTextWrapType=Xl,f.TextDecoration=Ll,f.TextDecorationBuilder=sn,f.TextDirection=cr,f.TextDirectionType=Bl,f.TextStyleBuilder=rn,f.TextStyleValue=Pr,f.TextX=Me,f.TextXActionType=J,f.ThemeColor=ps,f.ThemeColorType=ot,f.ThemeColors=cs,f.ThemeService=Js,f.Tools=Z,f.UndoCommand=sd,f.UndoCommandId=rd,f.UnitModel=is,f.Univer=pI,f.UniverInstanceType=ve,f.UpdateDocsAttributeType=Ce,f.UserManagerService=xr,f.VerticalAlign=fn,f.VerticalAlignmentType=Zl,f.Worksheet=Wr,f.WrapStrategy=mn,f.WrapTextType=Hl,f.addLinkToDocumentModel=Lh,f.afterInitApply=H_,f.afterTime=B_,f.awaitTime=oI,f.binSearchFirstGreaterThanTarget=Tc,f.binarySearchArray=j_,f.bufferDebounceTime=x_,f.cellToRange=vp,f.characterSpacingControlType=rc,f.checkForSubstrings=bp,f.checkIfMove=Y_,f.checkParagraphHasBullet=lE,f.checkParagraphHasIndent=cE,f.checkParagraphHasIndentByStyle=qc,f.codeToBlob=W_,f.composeBody=Wo,f.composeInterceptors=Oa,f.composeStyles=ar,f.concatMatrixArray=fp,f.convertBodyToHtml=G_,f.convertCellToRange=Fc,f.convertObservableToBehaviorSubject=$_,f.covertCellValue=$i,f.covertCellValues=wp,f.covertTextRunToHtml=Di,f.createAsyncInterceptorKey=Gd,f.createDefaultUser=Zs,f.createDocumentModelWithStyle=jr,f.createInterceptorKey=Wd,f.createInternalEditorID=Bd,f.createREGEXFromWildChar=I_,f.createRowColIter=xo,f.customNameCharacterCheck=sI,f.dayjs=jt,f.debounce=Kg,f.dedupe=Ad,f.dedupeBy=Td,f.deepCompare=Hi,f.delayAnimationFrame=aI,f.deleteContent=Jc,f.extractPureTextFromCell=Gh,f.fromCallback=bc,f.fromEventSubject=nR,f.fromObservable=a_,f.generateRandomId=tt,f.get=rl,f.getArrayLength=Qt,f.getBodySlice=bt,f.getBodySliceHtml=ms,f.getBorderStyleType=Ip,f.getCellCoordByIndexSimple=ha,f.getCellInfoInMergeData=up,f.getCellPositionByIndexSimple=fI,f.getCellValueType=ap,f.getCellWithCoordByIndexCore=qn,f.getColorStyle=Ut,f.getCustomBlockSlice=lh,f.getCustomDecorationSlice=uh,f.getCustomRangeSlice=ch,f.getDocsUpdateBody=Sp,f.getIntersectRange=Bu,f.getNumfmtParseValueFilter=d0,f.getOriginCellValue=LR,f.getParagraphsSlice=ah,f.getPlainText=Xs,f.getReverseDirection=S_,f.getSectionBreakSlice=oC,f.getTableSlice=oh,f.getTextRunSlice=Ks,f.getTransformOffsetX=ud,f.getTransformOffsetY=hd,f.getWorksheetUID=kR,f.groupBy=Md,f.handleStyleToString=Rp,f.hashAlgorithm=hE,f.horizontalLineSegmentsSubtraction=ys,f.insertMatrixArray=dp,f.insertTextToContent=Zc,f.invertColorByHSL=Qd,f.invertColorByMatrix=tf,f.isBlackColor=ip,f.isBooleanString=xd,f.isCellCoverable=Bi,f.isCellV=Uc,f.isDefaultFormat=l0,f.isEmptyCell=xc,f.isFormulaId=Cp,f.isFormulaString=Bc,f.isICellData=Dc,f.isInternalEditorID=Ra,f.isNodeEnv=R_,f.isNotNullOrUndefined=Dh,f.isNullCell=lp,f.isNumeric=ul,f.isPatternEqualWithoutDecimal=c0,f.isRangesEqual=_R,f.isRealNum=uE,f.isSafeNumeric=n_,f.isSameStyleTextRun=$c,f.isTextFormat=a0,f.isUnitRangesEqual=pR,f.isValidRange=Op,f.isWhiteColor=op,f.makeArray=Ld,f.makeCellRangeToRangeData=Ep,f.makeCellToSelection=pp,f.makeCustomRangeStream=RC,f.mapObjectMatrix=hp,f.merge=rs,f.mergeLocales=dE,f.mergeOverrideWithDependencies=Qh,f.mergeSets=i_,f.mergeWith=Jg,f.mergeWorksheetSnapshotWithDefault=jh,f.mixinClass=t_,f.moveMatrixArray=xi,f.moveRangeByOffset=y0,f.nameCharacterCheck=rI,f.normalizeBody=aC,f.normalizeTextRuns=Dr,f.numberToABC=j0,f.numberToListABC=W0,f.numfmt=o0,f.queryObjectMatrix=x0,f.registerDependencies=$d,f.remove=tr,f.repeatStringNumTimes=Wu,f.replaceInDocumentBody=JC,f.requestImmediateMacroTask=s_,f.rotate=Nd,f.searchArray=mr,f.searchInOrderedArray=Ac,f.selectionToArray=cp,f.sequence=dl,f.sequenceAsync=hl,f.sequenceExecute=fs,f.sequenceExecuteAsync=F_,f.set=e_,f.shallowEqual=Sa,f.skipParseTagNames=mI,f.sliceMatrixArray=mp,f.sortRules=Y0,f.sortRulesByDesc=G0,f.sortRulesFactory=Lr,f.spliceArray=Fi,f.splitIntoGrid=Fo,f.takeAfter=Li,f.textDiff=Vo,f.throttle=jd,f.toDisposable=We,f.touchDependencies=Ia,f.updateAttributeByDelete=hh,f.updateAttributeByInsert=dh,f.willLoseNumericPrecision=r_,Object.keys(Re).forEach(e=>{e!=="default"&&!Object.prototype.hasOwnProperty.call(f,e)&&Object.defineProperty(f,e,{enumerable:!0,get:()=>Re[e]})}),Object.defineProperty(f,Symbol.toStringTag,{value:"Module"})}));
