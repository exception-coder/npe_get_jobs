//#region rolldown:runtime
var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __copyProps = (to, from, except, desc) => {
	if (from && typeof from === "object" || typeof from === "function") for (var keys = __getOwnPropNames(from), i = 0, n = keys.length, key; i < n; i++) {
		key = keys[i];
		if (!__hasOwnProp.call(to, key) && key !== except) __defProp(to, key, {
			get: ((k) => from[k]).bind(null, key),
			enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable
		});
	}
	return to;
};
var __toESM = (mod, isNodeMode, target) => (target = mod != null ? __create(__getProtoOf(mod)) : {}, __copyProps(isNodeMode || !mod || !mod.__esModule ? __defProp(target, "default", {
	value: mod,
	enumerable: true
}) : target, mod));

//#endregion
let react = require("react");
react = __toESM(react);

//#region ts/base.tsx
function IconBase({ ref,...props }) {
	const { icon, id, className, extend,...restProps } = props;
	const cls = `univerjs-icon univerjs-icon-${id} ${className || ""}`.trim();
	const idSuffix = (0, react.useRef)(`_${generateShortUuid()}`);
	return render(icon, `${id}`, {
		defIds: icon.defIds,
		idSuffix: idSuffix.current
	}, {
		ref,
		className: cls,
		...restProps
	}, extend);
}
/**
* use react createElement to render an IconElement with other props
*/
function render(node, id, runtimeProps, rootProps, extend) {
	return (0, react.createElement)(node.tag, {
		key: id,
		...replaceRuntimeIdsAndExtInAttrs(node, runtimeProps, extend),
		...rootProps
	}, (replaceRuntimeIdsInDefs(node, runtimeProps).children || []).map((child, index) => render(child, `${id}-${node.tag}-${index}`, runtimeProps, void 0, extend)));
}
function replaceRuntimeIdsAndExtInAttrs(node, runtimeProps, extend) {
	const attrs = { ...node.attrs };
	if (extend?.colorChannel1 && attrs.fill === "colorChannel1") attrs.fill = extend.colorChannel1;
	if (node.tag === "mask" && attrs.id) attrs.id = attrs.id + runtimeProps.idSuffix;
	Object.entries(attrs).forEach(([key, value]) => {
		if (key === "mask" && typeof value === "string") attrs[key] = value.replace(/url\(#(.*)\)/, `url(#$1${runtimeProps.idSuffix})`);
	});
	const { defIds } = runtimeProps;
	if (!defIds || defIds.length === 0) return attrs;
	if (node.tag === "use" && attrs["xlink:href"]) attrs["xlink:href"] = attrs["xlink:href"] + runtimeProps.idSuffix;
	Object.entries(attrs).forEach(([key, value]) => {
		if (typeof value === "string") attrs[key] = value.replace(/url\(#(.*)\)/, `url(#$1${runtimeProps.idSuffix})`);
	});
	return attrs;
}
function replaceRuntimeIdsInDefs(node, runtimeProps) {
	const { defIds } = runtimeProps;
	if (!defIds || defIds.length === 0) return node;
	if (node.tag === "defs" && node.children?.length) return {
		...node,
		children: node.children.map((child) => {
			if (typeof child.attrs.id === "string") {
				if (defIds && defIds.includes(child.attrs.id)) return {
					...child,
					attrs: {
						...child.attrs,
						id: child.attrs.id + runtimeProps.idSuffix
					}
				};
			}
			return child;
		})
	};
	return node;
}
function generateShortUuid() {
	return Math.random().toString(36).substring(2, 8);
}
IconBase.displayName = "UniverIcon";

//#endregion
exports.IconBase = IconBase;