(function(_0x39a91c,_0x3c1999){const _0x45bbc2=_0x1a8e,_0x592ba6=_0x39a91c();while(!![]){try{const _0x39fa18=parseInt(_0x45bbc2(0x1e2))/0x1+-parseInt(_0x45bbc2(0x425))/0x2+-parseInt(_0x45bbc2(0x253))/0x3*(parseInt(_0x45bbc2(0x3b0))/0x4)+parseInt(_0x45bbc2(0x204))/0x5*(-parseInt(_0x45bbc2(0x205))/0x6)+parseInt(_0x45bbc2(0x270))/0x7+parseInt(_0x45bbc2(0x3ef))/0x8+-parseInt(_0x45bbc2(0x28a))/0x9;if(_0x39fa18===_0x3c1999)break;else _0x592ba6['push'](_0x592ba6['shift']());}catch(_0x2ae363){_0x592ba6['push'](_0x592ba6['shift']());}}}(_0x14a7,0xd7a44),function(_0x41738b,_0x71ca4c){const _0x39a7ef=_0x1a8e;typeof exports=='object'&&typeof module<'u'?_0x71ca4c(exports,require('react/jsx-runtime'),require('@univerjs-pro/collaboration-client'),require('@univerjs/core'),require('@univerjs/ui'),require('rxjs'),require('@univerjs/design'),require('react'),require('@univerjs/rpc'),require('@univerjs/sheets'),require('@univerjs/engine-render'),require('@univerjs/network'),require('@univerjs/docs-ui'),require('@univerjs/drawing'),require('@univerjs-pro/collaboration'),require('@univerjs/docs'),require('@univerjs/engine-formula'),require('rxjs/operators'),require('@univerjs/sheets-ui')):typeof define=='function'&&define[_0x39a7ef(0x1d2)]?define([_0x39a7ef(0x444),_0x39a7ef(0x1ff),_0x39a7ef(0x401),_0x39a7ef(0x28f),'@univerjs/ui',_0x39a7ef(0x31a),_0x39a7ef(0x1e0),_0x39a7ef(0x493),'@univerjs/rpc',_0x39a7ef(0x360),_0x39a7ef(0x36a),_0x39a7ef(0x2e5),_0x39a7ef(0x34d),_0x39a7ef(0x2b5),_0x39a7ef(0x288),'@univerjs/docs',_0x39a7ef(0x323),_0x39a7ef(0x468),_0x39a7ef(0x21e)],_0x71ca4c):(_0x41738b=typeof globalThis<'u'?globalThis:_0x41738b||self,_0x71ca4c(_0x41738b[_0x39a7ef(0x1f7)]={},_0x41738b[_0x39a7ef(0x382)],_0x41738b[_0x39a7ef(0x3c8)],_0x41738b['UniverCore'],_0x41738b[_0x39a7ef(0x22f)],_0x41738b[_0x39a7ef(0x31a)],_0x41738b[_0x39a7ef(0x3b9)],_0x41738b['React'],_0x41738b[_0x39a7ef(0x1e8)],_0x41738b[_0x39a7ef(0x224)],_0x41738b[_0x39a7ef(0x464)],_0x41738b['UniverNetwork'],_0x41738b[_0x39a7ef(0x3ad)],_0x41738b[_0x39a7ef(0x32c)],_0x41738b[_0x39a7ef(0x223)],_0x41738b[_0x39a7ef(0x21a)],_0x41738b[_0x39a7ef(0x1ea)],_0x41738b[_0x39a7ef(0x31a)]['operators'],_0x41738b[_0x39a7ef(0x20b)]));}(this,function(_0x46875a,_0x246a04,_0x46104e,_0x161ac6,_0x4291c6,_0x66cc31,_0x37af48,_0x166ef5,_0xbc9216,_0xc6f6be,_0x1fade8,_0x4db2d9,_0x5d4e8b,_0x275a1a,_0x48fdef,_0x4db13e,_0x50020c,_0x136df2,_0x5b4c60){'use strict';const _0x4624f5=_0x1a8e;var _0x489fc9=Object[_0x4624f5(0x340)],_0x1b6f59=(_0x2f034f,_0x5c44a7,_0x4e409e)=>_0x5c44a7 in _0x2f034f?_0x489fc9(_0x2f034f,_0x5c44a7,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0x4e409e}):_0x2f034f[_0x5c44a7]=_0x4e409e,_0x47bfcc=(_0x3a75be,_0x3aaffa,_0x2e5fd1)=>_0x1b6f59(_0x3a75be,typeof _0x3aaffa!='symbol'?_0x3aaffa+'':_0x3aaffa,_0x2e5fd1);function _0x3874fc({ref:_0x8d73ff,..._0x2edd9d}){const _0x6a3ff8=_0x4624f5,{icon:_0x1103ff,id:_0x2347d1,className:_0x47f2ad,extend:_0x5749d4,..._0x566b9e}=_0x2edd9d,_0x2ab888=(_0x6a3ff8(0x486)+_0x2347d1+'\x20'+(_0x47f2ad||''))[_0x6a3ff8(0x358)](),_0x406f6=_0x166ef5[_0x6a3ff8(0x2a7)]('_'+_0x2bd72d());return _0xd862a4(_0x1103ff,''+_0x2347d1,{'defIds':_0x1103ff[_0x6a3ff8(0x40a)],'idSuffix':_0x406f6[_0x6a3ff8(0x472)]},{'ref':_0x8d73ff,'className':_0x2ab888,..._0x566b9e},_0x5749d4);}function _0xd862a4(_0x1afe7a,_0x33591f,_0x3ee733,_0x15eafa,_0x257323){const _0xed069b=_0x4624f5;return _0x166ef5[_0xed069b(0x3cc)](_0x1afe7a['tag'],{'key':_0x33591f,..._0x504ee4(_0x1afe7a,_0x3ee733,_0x257323),..._0x15eafa},(_0x301629(_0x1afe7a,_0x3ee733)['children']||[])[_0xed069b(0x44e)]((_0x71a161,_0x2e2b7b)=>_0xd862a4(_0x71a161,_0x33591f+'-'+_0x1afe7a['tag']+'-'+_0x2e2b7b,_0x3ee733,void 0x0,_0x257323)));}function _0x504ee4(_0x3870cb,_0x138cac,_0x1005ff){const _0x48ddcd=_0x4624f5,_0xf1b5cd={..._0x3870cb[_0x48ddcd(0x495)]};_0x1005ff!=null&&_0x1005ff[_0x48ddcd(0x39f)]&&_0xf1b5cd[_0x48ddcd(0x201)]===_0x48ddcd(0x39f)&&(_0xf1b5cd[_0x48ddcd(0x201)]=_0x1005ff[_0x48ddcd(0x39f)]),_0x3870cb[_0x48ddcd(0x32f)]===_0x48ddcd(0x231)&&_0xf1b5cd['id']&&(_0xf1b5cd['id']=_0xf1b5cd['id']+_0x138cac['idSuffix']),Object[_0x48ddcd(0x2a6)](_0xf1b5cd)[_0x48ddcd(0x265)](([_0x337cb1,_0x31e44b])=>{const _0x1b6909=_0x48ddcd;_0x337cb1==='mask'&&typeof _0x31e44b==_0x1b6909(0x306)&&(_0xf1b5cd[_0x337cb1]=_0x31e44b['replace'](/url\(#(.*)\)/,_0x1b6909(0x28e)+_0x138cac[_0x1b6909(0x35e)]+')'));});const {defIds:_0x41edb4}=_0x138cac;return!_0x41edb4||_0x41edb4['length']===0x0||(_0x3870cb[_0x48ddcd(0x32f)]===_0x48ddcd(0x275)&&_0xf1b5cd[_0x48ddcd(0x284)]&&(_0xf1b5cd[_0x48ddcd(0x284)]=_0xf1b5cd[_0x48ddcd(0x284)]+_0x138cac[_0x48ddcd(0x35e)]),Object[_0x48ddcd(0x2a6)](_0xf1b5cd)[_0x48ddcd(0x265)](([_0x3ecec7,_0x4c1d74])=>{const _0x456352=_0x48ddcd;typeof _0x4c1d74==_0x456352(0x306)&&(_0xf1b5cd[_0x3ecec7]=_0x4c1d74[_0x456352(0x3bc)](/url\(#(.*)\)/,_0x456352(0x28e)+_0x138cac[_0x456352(0x35e)]+')'));})),_0xf1b5cd;}function _0x301629(_0x5df16e,_0x4b3cb7){const _0x865fcd=_0x4624f5;var _0x1ee7ea;const {defIds:_0x3673ef}=_0x4b3cb7;return!_0x3673ef||_0x3673ef[_0x865fcd(0x1e5)]===0x0?_0x5df16e:_0x5df16e[_0x865fcd(0x32f)]==='defs'&&((_0x1ee7ea=_0x5df16e[_0x865fcd(0x34c)])!=null&&_0x1ee7ea[_0x865fcd(0x1e5)])?{..._0x5df16e,'children':_0x5df16e[_0x865fcd(0x34c)][_0x865fcd(0x44e)](_0x22acce=>typeof _0x22acce[_0x865fcd(0x495)]['id']==_0x865fcd(0x306)&&_0x3673ef&&_0x3673ef[_0x865fcd(0x354)](_0x22acce[_0x865fcd(0x495)]['id'])?{..._0x22acce,'attrs':{..._0x22acce[_0x865fcd(0x495)],'id':_0x22acce[_0x865fcd(0x495)]['id']+_0x4b3cb7['idSuffix']}}:_0x22acce)}:_0x5df16e;}function _0x2bd72d(){const _0x3e5712=_0x4624f5;return Math['random']()[_0x3e5712(0x266)](0x24)[_0x3e5712(0x27b)](0x2,0x8);}_0x3874fc[_0x4624f5(0x49e)]=_0x4624f5(0x3af);const _0x5a0d1b={'tag':_0x4624f5(0x396),'attrs':{'xmlns':_0x4624f5(0x208),'fill':_0x4624f5(0x3ba),'viewBox':_0x4624f5(0x350),'width':'1em','height':'1em'},'children':[{'tag':'g','attrs':{'clipPath':_0x4624f5(0x2cb)},'children':[{'tag':_0x4624f5(0x461),'attrs':{'stroke':'currentColor','d':_0x4624f5(0x1dc),'strokeLinecap':'round','strokeLinejoin':_0x4624f5(0x31e),'strokeWidth':1.2}}]},{'tag':_0x4624f5(0x2ff),'attrs':{},'children':[{'tag':_0x4624f5(0x246),'attrs':{'id':_0x4624f5(0x453)},'children':[{'tag':_0x4624f5(0x461),'attrs':{'fill':_0x4624f5(0x471),'d':'M0\x200H16V16H0z'}}]}]}],'defIds':[_0x4624f5(0x453)]},_0x879869=_0x166ef5[_0x4624f5(0x28d)](function(_0x52cbcc,_0xcd2715){const _0x302fa6=_0x4624f5;return _0x166ef5[_0x302fa6(0x3cc)](_0x3874fc,Object[_0x302fa6(0x2b7)]({},_0x52cbcc,{'id':_0x302fa6(0x45e),'ref':_0xcd2715,'icon':_0x5a0d1b}));});_0x879869[_0x4624f5(0x49e)]=_0x4624f5(0x43e);const _0x3ee199={'tag':'svg','attrs':{'xmlns':_0x4624f5(0x208),'fill':_0x4624f5(0x3ba),'viewBox':'0\x200\x2017\x2016','width':_0x4624f5(0x437),'height':'1em'},'children':[{'tag':'g','attrs':{'clipPath':'url(#on-line-icon_clip0_910_349)'},'children':[{'tag':_0x4624f5(0x461),'attrs':{'stroke':_0x4624f5(0x2a8),'d':_0x4624f5(0x206),'strokeLinecap':_0x4624f5(0x31e),'strokeLinejoin':_0x4624f5(0x31e),'strokeWidth':1.2}}]},{'tag':'defs','attrs':{},'children':[{'tag':_0x4624f5(0x246),'attrs':{'id':_0x4624f5(0x2a1)},'children':[{'tag':'path','attrs':{'fill':_0x4624f5(0x471),'d':_0x4624f5(0x3a3),'transform':'translate(.97)'}}]}]}],'defIds':[_0x4624f5(0x2a1)]},_0xc8a5ab=_0x166ef5['forwardRef'](function(_0x5aaba8,_0x3c3199){const _0x1603b0=_0x4624f5;return _0x166ef5[_0x1603b0(0x3cc)](_0x3874fc,Object[_0x1603b0(0x2b7)]({},_0x5aaba8,{'id':'on-line-icon','ref':_0x3c3199,'icon':_0x3ee199}));});_0xc8a5ab[_0x4624f5(0x49e)]=_0x4624f5(0x349);function _0xe2a3cc(_0xffd0af){const _0x46744e=_0x4624f5;switch(_0xffd0af){case _0x46104e[_0x46744e(0x2e6)][_0x46744e(0x442)]:return _0x46744e(0x49f);case _0x46104e[_0x46744e(0x2e6)]['CONFLICT']:return _0x46744e(0x1f6);case _0x46104e[_0x46744e(0x2e6)][_0x46744e(0x3a7)]:return _0x46744e(0x258);case _0x46104e[_0x46744e(0x2e6)][_0x46744e(0x484)]:return _0x46744e(0x47f);case _0x46104e[_0x46744e(0x2e6)][_0x46744e(0x3dd)]:case _0x46104e[_0x46744e(0x2e6)][_0x46744e(0x2d7)]:return _0x46744e(0x2d5);case _0x46104e['CollaborationStatus'][_0x46744e(0x219)]:case _0x46104e[_0x46744e(0x2e6)][_0x46744e(0x3f6)]:return _0x46744e(0x316);}}function _0x58006a(_0x5b11b1){const _0x549c66=_0x4624f5,{status$:_0x33bccf}=_0x5b11b1,_0x329ec4=_0x4291c6['useObservable'](_0x33bccf,_0x46104e[_0x549c66(0x2e6)][_0x549c66(0x484)]),_0xe9d830=_0x4291c6[_0x549c66(0x3fd)](_0x161ac6[_0x549c66(0x25a)]),_0x319616=_0x4291c6[_0x549c66(0x3fd)](_0x46104e[_0x549c66(0x26a)]),_0x14f059=_0x329ec4!==_0x46104e['CollaborationStatus'][_0x549c66(0x442)],_0x3b1b11=_0xe9d830['t'](_0xe2a3cc(_0x329ec4)),_0x437d34=_0x14f059?_0x246a04[_0x549c66(0x2cf)](_0xc8a5ab,{}):_0x246a04[_0x549c66(0x2cf)](_0x879869,{}),_0x1a0225=_0x166ef5[_0x549c66(0x352)](()=>{const _0x368dea=_0x549c66;_0x14f059||_0x319616[_0x368dea(0x474)]();},[_0x14f059,_0x319616]);function _0x32cb69(){const _0x1d9b62=_0x549c66;return _0x246a04['jsxs'](_0x1d9b62(0x414),{'className':'univer-flex\x20univer-items-center','onClick':_0x1a0225,'children':[_0x246a04['jsx'](_0x1d9b62(0x414),{'className':_0x37af48['clsx'](_0x1d9b62(0x3ac),{'univer-text-green-500':_0x14f059,'univer-text-red-500':!_0x14f059}),'children':_0x437d34}),_0x246a04['jsx'](_0x1d9b62(0x414),{'className':_0x1d9b62(0x400),'children':_0x3b1b11})]});}return _0x14f059?_0x32cb69():_0x246a04[_0x549c66(0x2cf)](_0x37af48[_0x549c66(0x318)],{'title':_0xe9d830['t'](_0x549c66(0x47d)),'children':_0x32cb69()});}var _0x13d5fd=Object['getOwnPropertyDescriptor'],_0x1d9a4a=(_0x243bdd,_0xc1e9d5,_0x4a996e,_0xc727a5)=>{const _0x35f124=_0x4624f5;for(var _0x21886c=_0xc727a5>0x1?void 0x0:_0xc727a5?_0x13d5fd(_0xc1e9d5,_0x4a996e):_0xc1e9d5,_0x36ee63=_0x243bdd[_0x35f124(0x1e5)]-0x1,_0x5e4002;_0x36ee63>=0x0;_0x36ee63--)(_0x5e4002=_0x243bdd[_0x36ee63])&&(_0x21886c=_0x5e4002(_0x21886c)||_0x21886c);return _0x21886c;},_0x2fc7d5=(_0x55ca09,_0x1509fe)=>(_0x10faf0,_0x214fb9)=>_0x1509fe(_0x10faf0,_0x214fb9,_0x55ca09);_0x46875a[_0x4624f5(0x492)]=class extends _0x161ac6[_0x4624f5(0x482)]{constructor(_0x382067,_0x47a158,_0x282d21,_0xa37ee1){const _0x2b296b=_0x4624f5;super(),_0x47bfcc(this,_0x2b296b(0x3e7),new _0x66cc31['BehaviorSubject'](_0x46104e['CollaborationStatus'][_0x2b296b(0x484)])),(this['_univerInstanceService']=_0x382067,this[_0x2b296b(0x298)]=_0x47a158,this[_0x2b296b(0x2c0)]=_0x282d21,this[_0x2b296b(0x2ab)]=_0xa37ee1,this[_0x2b296b(0x384)](),this[_0x2b296b(0x33d)]());}['_initStatusListener'](){const _0x4ad62b=_0x4624f5;this[_0x4ad62b(0x30f)](this[_0x4ad62b(0x485)]['focused$'][_0x4ad62b(0x1ef)](_0x66cc31[_0x4ad62b(0x46f)](()=>{const _0x588c97=_0x4ad62b,_0x3938fa=this[_0x588c97(0x485)][_0x588c97(0x45a)]();return _0x3938fa?this['_collaborationController'][_0x588c97(0x46c)](_0x3938fa[_0x588c97(0x30b)]()):_0x66cc31['of'](null);}),_0x66cc31[_0x4ad62b(0x46f)](_0x22da9e=>_0x22da9e?_0x22da9e[_0x4ad62b(0x2dd)]:_0x66cc31['of'](_0x46104e[_0x4ad62b(0x2e6)][_0x4ad62b(0x484)])))[_0x4ad62b(0x26b)](_0x1e5375=>{const _0x2f6df3=_0x4ad62b;this[_0x2f6df3(0x3e7)][_0x2f6df3(0x3c9)](_0x1e5375);}));}[_0x4624f5(0x384)](){const _0x532a40=_0x4624f5;this[_0x532a40(0x30f)](this[_0x532a40(0x2ab)][_0x532a40(0x3eb)](_0x4291c6[_0x532a40(0x411)]['HEADER_MENU'],()=>_0x4291c6[_0x532a40(0x370)](_0x423244({'status$':this[_0x532a40(0x3e7)][_0x532a40(0x215)]()}),this[_0x532a40(0x298)])));}},_0x46875a[_0x4624f5(0x492)]=_0x1d9a4a([_0x2fc7d5(0x0,_0x161ac6[_0x4624f5(0x37d)]),_0x2fc7d5(0x1,_0x161ac6[_0x4624f5(0x2b0)](_0x161ac6[_0x4624f5(0x2c2)])),_0x2fc7d5(0x2,_0x161ac6[_0x4624f5(0x2b0)](_0x46104e[_0x4624f5(0x23f)])),_0x2fc7d5(0x3,_0x4291c6[_0x4624f5(0x228)])],_0x46875a[_0x4624f5(0x492)]);function _0x423244(_0x4dc632){const {status$:_0x451a79}=_0x4dc632;return function(){return _0x246a04['jsx'](_0x58006a,{'status$':_0x451a79});};}const _0x5a3a5f=_0x161ac6[_0x4624f5(0x282)]('uni.network.url-service');var _0x4f5c71=Object['getOwnPropertyDescriptor'],_0x318a87=(_0x53c002,_0x4063b5,_0x528898,_0x249335)=>{const _0x1e2fae=_0x4624f5;for(var _0x1ae9dd=_0x249335>0x1?void 0x0:_0x249335?_0x4f5c71(_0x4063b5,_0x528898):_0x4063b5,_0x1c09c7=_0x53c002[_0x1e2fae(0x1e5)]-0x1,_0x1bf666;_0x1c09c7>=0x0;_0x1c09c7--)(_0x1bf666=_0x53c002[_0x1c09c7])&&(_0x1ae9dd=_0x1bf666(_0x1ae9dd)||_0x1ae9dd);return _0x1ae9dd;},_0x158e8b=(_0x229ae8,_0x5d6300)=>(_0x3a4259,_0x2e48a9)=>_0x5d6300(_0x3a4259,_0x2e48a9,_0x229ae8);_0x46875a[_0x4624f5(0x25f)]=class extends _0x161ac6[_0x4624f5(0x240)]{constructor(_0x3c2c95,_0x57c844,_0x3012bc,_0x2d2d4b,_0x291d1e){const _0x42fd77=_0x4624f5;super(),this[_0x42fd77(0x27e)]=_0x3c2c95,this[_0x42fd77(0x3a2)]=_0x57c844,this[_0x42fd77(0x43a)]=_0x3012bc,this[_0x42fd77(0x1e1)]=_0x2d2d4b,_0x291d1e?_0x291d1e==null||_0x291d1e[_0x42fd77(0x38f)]()[_0x42fd77(0x2e0)](()=>this[_0x42fd77(0x48d)]()):(this[_0x42fd77(0x3a2)]['debug'](_0x42fd77(0x48a),'No\x20remote\x20instance\x20service\x20injected.\x20May\x20not\x20syncing\x20edits\x20to\x20the\x20web\x20worker.'),this[_0x42fd77(0x48d)]());}async[_0x4624f5(0x48d)](){const _0x1263eb=_0x4624f5,_0x28c684=this[_0x1263eb(0x27e)]['getParam'](_0x1263eb(0x285)),_0x3ccaf9=this[_0x1263eb(0x27e)]['getParam'](_0x1263eb(0x35b)),_0x4adb75=this['_urlService'][_0x1263eb(0x3cd)](_0x1263eb(0x1cc));if(!_0x28c684||!_0x3ccaf9){this[_0x1263eb(0x3a2)]['debug']('[CollaborationDataLoaderController]',_0x1263eb(0x489));return;}const _0x268129=await this[_0x1263eb(0x1e1)][_0x1263eb(0x2ef)](_0x28c684,Number(_0x3ccaf9),_0x4adb75);_0x268129&&_0x268129 instanceof _0x161ac6[_0x1263eb(0x477)]&&this[_0x1263eb(0x296)](_0x268129);}async[_0x4624f5(0x296)](_0x218552){const _0x66c61f=_0x4624f5;await this[_0x66c61f(0x404)](_0x218552),_0x218552[_0x66c61f(0x1f4)]['pipe'](_0x66cc31[_0x66c61f(0x45d)](this['dispose$']))[_0x66c61f(0x26b)](_0x22f203=>{const _0x441d76=_0x66c61f;_0x22f203&&this[_0x441d76(0x2c6)](_0x22f203);}),this['_urlService'][_0x66c61f(0x23e)][_0x66c61f(0x1ef)](_0x66cc31[_0x66c61f(0x45d)](this['dispose$']))[_0x66c61f(0x26b)](()=>this['_updateSubUnitFromURLParams'](_0x218552));}['_updateURLWithCurrentState'](_0x22d09a,_0x5ec5e4=!0x1){const _0x796eb2=_0x4624f5,_0x1f1fe8=this[_0x796eb2(0x27e)][_0x796eb2(0x3cd)]('subunit');_0x22d09a[_0x796eb2(0x447)]()!==_0x1f1fe8&&this[_0x796eb2(0x27e)][_0x796eb2(0x2c9)](_0x796eb2(0x1cc),_0x22d09a[_0x796eb2(0x447)](),_0x5ec5e4);}async[_0x4624f5(0x404)](_0xdffe92){const _0x378517=_0x4624f5;var _0x31c659;const _0x37a4c9=this[_0x378517(0x27e)][_0x378517(0x3cd)](_0x378517(0x1cc));if(!_0x37a4c9||!_0xdffe92[_0x378517(0x481)](_0x37a4c9)){const _0x1644ee=_0xdffe92['getUnhiddenWorksheets']()[0x0],_0x4a08c1=_0xdffe92[_0x378517(0x481)](_0x1644ee);if(!_0x4a08c1)return;this['_updateURLWithCurrentState'](_0x4a08c1,!0x0),await this[_0x378517(0x43a)][_0x378517(0x225)](_0xc6f6be['SetWorksheetActivateCommand']['id'],{'unitId':_0xdffe92['getUnitId'](),'subUnitId':_0x1644ee});return;}((_0x31c659=_0xdffe92['getActiveSheet']())==null?void 0x0:_0x31c659[_0x378517(0x447)]())!==_0x37a4c9&&await this['_commandService'][_0x378517(0x225)](_0xc6f6be[_0x378517(0x244)]['id'],{'unitId':_0xdffe92[_0x378517(0x30b)](),'subUnitId':_0x37a4c9});}},_0x46875a[_0x4624f5(0x25f)]=_0x318a87([_0x158e8b(0x0,_0x5a3a5f),_0x158e8b(0x1,_0x161ac6[_0x4624f5(0x210)]),_0x158e8b(0x2,_0x161ac6[_0x4624f5(0x41a)]),_0x158e8b(0x3,_0x161ac6['Inject'](_0x46104e[_0x4624f5(0x1fa)])),_0x158e8b(0x4,_0x161ac6[_0x4624f5(0x41f)](_0xbc9216[_0x4624f5(0x3a9)]))],_0x46875a[_0x4624f5(0x25f)]);var _0x582e4f=Object[_0x4624f5(0x272)],_0x4e6c57=(_0x40201a,_0x58ab84,_0x4acd1b,_0x8b88a5)=>{const _0x5a8eb5=_0x4624f5;for(var _0x5e28af=_0x8b88a5>0x1?void 0x0:_0x8b88a5?_0x582e4f(_0x58ab84,_0x4acd1b):_0x58ab84,_0x3a69cc=_0x40201a[_0x5a8eb5(0x1e5)]-0x1,_0x467cb9;_0x3a69cc>=0x0;_0x3a69cc--)(_0x467cb9=_0x40201a[_0x3a69cc])&&(_0x5e28af=_0x467cb9(_0x5e28af)||_0x5e28af);return _0x5e28af;},_0x47b507=(_0x26b1e4,_0x1a2ce8)=>(_0x25af79,_0xc18dbc)=>_0x1a2ce8(_0x25af79,_0xc18dbc,_0x26b1e4);let _0x665a7a=class extends _0x161ac6[_0x4624f5(0x240)]{constructor(_0x536590,_0x15159f){const _0x59c500=_0x4624f5;super(),this[_0x59c500(0x1fe)]=_0x536590,this['_imageIoService']=_0x15159f,this[_0x59c500(0x48d)]();}[_0x4624f5(0x48d)](){const _0x1ba81c=_0x4624f5,_0x4d231d=this;this[_0x1ba81c(0x30f)](this['_docClipboardService'][_0x1ba81c(0x378)]({'onBeforePasteImage':async _0x21584e=>{const _0x3ad2c4=_0x1ba81c,_0x4e9323=await _0x4d231d[_0x3ad2c4(0x424)][_0x3ad2c4(0x29f)](_0x21584e);return _0x4e9323?{'source':_0x4e9323[_0x3ad2c4(0x309)],'imageSourceType':_0x4e9323[_0x3ad2c4(0x356)]}:null;}}));}};_0x665a7a=_0x4e6c57([_0x47b507(0x0,_0x5d4e8b[_0x4624f5(0x26f)]),_0x47b507(0x1,_0x275a1a[_0x4624f5(0x1d5)])],_0x665a7a);const _0x167276=[_0x4624f5(0x1f8),_0x4624f5(0x238),_0x4624f5(0x3a0),_0x4624f5(0x2cc),'blue.400','yellow.400'];class _0x1846fc extends _0x161ac6[_0x4624f5(0x482)]{constructor(){const _0xa1d2e1=_0x4624f5;super(...arguments),_0x47bfcc(this,_0xa1d2e1(0x27a),new Map()),_0x47bfcc(this,_0xa1d2e1(0x260),0x0);}['assignAColorForMemberID'](_0x2c819c){const _0x5e9a02=_0x4624f5;if(this[_0x5e9a02(0x27a)]['has'](_0x2c819c))return this['_assignedColors'][_0x5e9a02(0x333)](_0x2c819c);const _0x38e613=_0x167276[this[_0x5e9a02(0x260)]];return this[_0x5e9a02(0x260)]=(this[_0x5e9a02(0x260)]+0x1)%_0x167276[_0x5e9a02(0x1e5)],this[_0x5e9a02(0x27a)][_0x5e9a02(0x3d5)](_0x2c819c,_0x38e613),_0x38e613;}}function _0xa63dd7(_0x54eb37){const _0x3d6c59=_0x4624f5;let _0x15b4cb='';for(const _0x10cc92 of _0x54eb37){const {startOffset:_0x2da0a1,endOffset:_0x331b9a,isActive:_0x2014af,rangeType:_0x5809ba,segmentId:_0x130c72,segmentPage:_0xb890be}=_0x10cc92;_0x15b4cb[_0x3d6c59(0x1e5)]&&(_0x15b4cb+=','),_0x15b4cb+=_0x2da0a1+':'+_0x331b9a+':'+(_0x2014af?'1':'0')+':'+_0x5809ba+':'+_0x130c72+':'+_0xb890be;}return _0x15b4cb;}function _0x7e2e27(_0x23bae7){const _0x5ce0f0=_0x4624f5,_0x23ec43=_0x23bae7[_0x5ce0f0(0x44a)](','),_0x588347=[];for(const _0x313416 of _0x23ec43){const [_0x599993,_0x176852,_0x1d9c78,_0x4cf3b1,_0x5bb60d,_0x166929]=_0x313416[_0x5ce0f0(0x44a)](':');_0x588347[_0x5ce0f0(0x426)]({'startOffset':Number(_0x599993),'endOffset':Number(_0x176852),'collapsed':_0x599993===_0x176852,'isActive':_0x1d9c78==='1','rangeType':_0x4cf3b1===_0x161ac6[_0x5ce0f0(0x29b)][_0x5ce0f0(0x2d1)]?_0x161ac6[_0x5ce0f0(0x29b)][_0x5ce0f0(0x2d1)]:_0x161ac6[_0x5ce0f0(0x29b)][_0x5ce0f0(0x475)],'segmentId':typeof _0x5bb60d==_0x5ce0f0(0x306)?String(_0x5bb60d):'','segmentPage':Number(_0x166929!=null?_0x166929:-0x1)});}return _0x588347['some'](_0x1d27ed=>_0x1d27ed[_0x5ce0f0(0x37e)])||(_0x588347[0x0][_0x5ce0f0(0x37e)]=!0x0),_0x588347;}class _0x360498 extends _0x161ac6[_0x4624f5(0x240)]{constructor(){const _0x434d28=_0x4624f5;super(...arguments),_0x47bfcc(this,_0x434d28(0x3b8),new _0x66cc31[(_0x434d28(0x41e))](null)),_0x47bfcc(this,'collabCursorState$',this['_collabCursorState$'][_0x434d28(0x215)]());}[_0x4624f5(0x26c)](_0x1aa26e){const _0x5ad895=_0x4624f5,{unitID:_0x5f19ae,memberID:_0x21d109,textRanges:_0x3c6c3d}=_0x1aa26e,_0x207765=_0xa63dd7(_0x3c6c3d);if(_0x207765==='')return;const _0x48d573={'unitID':_0x5f19ae,'memberID':_0x21d109,'selection':_0x207765};this['_collabCursorState$'][_0x5ad895(0x3c9)](_0x48d573);}}var _0x47ce8f=Object[_0x4624f5(0x272)],_0x55c00a=(_0x25934b,_0x3d3967,_0x152ff7,_0x464338)=>{for(var _0x10933f=_0x464338>0x1?void 0x0:_0x464338?_0x47ce8f(_0x3d3967,_0x152ff7):_0x3d3967,_0x262a38=_0x25934b['length']-0x1,_0x249a21;_0x262a38>=0x0;_0x262a38--)(_0x249a21=_0x25934b[_0x262a38])&&(_0x10933f=_0x249a21(_0x10933f)||_0x10933f);return _0x10933f;},_0x25c269=(_0x5bdaae,_0x2a5e8e)=>(_0x531365,_0x59ba94)=>_0x2a5e8e(_0x531365,_0x59ba94,_0x5bdaae);const _0x28488e=0x12c,_0x406130=0x64;let _0x2262fb=class extends _0x161ac6[_0x4624f5(0x240)]{constructor(_0x6ce01f,_0x14a533,_0x443724,_0x530c72,_0x13bbeb,_0x4ef41e,_0x487800,_0x285957,_0x3da708){const _0xb95fd4=_0x4624f5;super(),_0x47bfcc(this,_0xb95fd4(0x27f),!0x1),_0x47bfcc(this,_0xb95fd4(0x48d),!0x1),_0x47bfcc(this,_0xb95fd4(0x218),new _0x66cc31['BehaviorSubject'](new Map())),_0x47bfcc(this,_0xb95fd4(0x3ed),this[_0xb95fd4(0x218)][_0xb95fd4(0x215)]()),_0x47bfcc(this,_0xb95fd4(0x3a8),new _0x66cc31[(_0xb95fd4(0x41e))]([])),_0x47bfcc(this,'roomMembers$',this[_0xb95fd4(0x3a8)][_0xb95fd4(0x1ef)](_0x66cc31[_0xb95fd4(0x405)](_0x28488e))),_0x47bfcc(this,_0xb95fd4(0x2c5),_0x161ac6[_0xb95fd4(0x3e4)](_0x5742d7=>{const _0x5083b6=_0xb95fd4,_0x5328ac={'eventID':_0x48fdef[_0x5083b6(0x3b2)][_0x5083b6(0x261)],'data':{'unitID':this[_0x5083b6(0x2e9)],'memberID':this[_0x5083b6(0x344)][_0x5083b6(0x3d2)](),'selection':_0xa63dd7(_0x5742d7)}};this[_0x5083b6(0x344)]['send'](_0x5328ac,this[_0x5083b6(0x2e9)]);},_0x406130)),(this['unitID']=_0x6ce01f,this['_session']=_0x14a533,this[_0xb95fd4(0x298)]=_0x443724,this['_colorAssignService']=_0x530c72,this[_0xb95fd4(0x23a)]=_0x13bbeb,this[_0xb95fd4(0x3f5)]=_0x4ef41e,this['_transformService']=_0x487800,this[_0xb95fd4(0x485)]=_0x285957,this[_0xb95fd4(0x43a)]=_0x3da708);}get[_0x4624f5(0x20c)](){const _0x4d5ad3=_0x4624f5;return this[_0x4d5ad3(0x218)][_0x4d5ad3(0x3dc)]();}get[_0x4624f5(0x2fe)](){const _0x3d3584=_0x4624f5;return this[_0x3d3584(0x3a8)][_0x3d3584(0x3dc)]();}['dispose'](){const _0x189164=_0x4624f5;super['dispose'](),this[_0x189164(0x218)]['next'](new Map()),this['_cursorInfo$'][_0x189164(0x487)](),this[_0x189164(0x3a8)][_0x189164(0x3c9)]([]),this[_0x189164(0x3a8)]['complete']();}[_0x4624f5(0x2b2)](){const _0x31dd4e=_0x4624f5;this[_0x31dd4e(0x48d)]||(this['_init']=!0x0,this[_0x31dd4e(0x344)][_0x31dd4e(0x221)][_0x31dd4e(0x1ef)](_0x66cc31[_0x31dd4e(0x45d)](this[_0x31dd4e(0x289)]))[_0x31dd4e(0x26b)](_0x7066ae=>{const _0x35694e=_0x31dd4e;_0x7066ae===_0x46104e[_0x35694e(0x290)][_0x35694e(0x428)]?this['_toggleOnline']():this[_0x35694e(0x1dd)]();}),this[_0x31dd4e(0x344)][_0x31dd4e(0x3fa)][_0x31dd4e(0x1ef)](_0x66cc31[_0x31dd4e(0x45d)](this[_0x31dd4e(0x289)]))[_0x31dd4e(0x26b)](_0x8f5b3=>{const _0x11b227=_0x31dd4e,_0x152bbe=_0x8f5b3['eventID'];_0x152bbe===_0x48fdef[_0x11b227(0x3b2)][_0x11b227(0x261)]&&this[_0x11b227(0x315)](_0x8f5b3),_0x152bbe===_0x48fdef[_0x11b227(0x3b2)][_0x11b227(0x217)]&&this['_onCursorDelete'](_0x8f5b3);}),this['disposeWithMe'](this[_0x31dd4e(0x43a)][_0x31dd4e(0x391)](_0x185c27=>{const _0x5d4e38=_0x31dd4e,_0x181f30=_0x185c27['params'];_0x181f30!=null&&this['_online']&&_0x185c27['id']===_0x4db13e[_0x5d4e38(0x1d7)]['id']&&_0x181f30[_0x5d4e38(0x470)]===this['unitID']&&_0x181f30[_0x5d4e38(0x281)]===!0x1&&_0x181f30[_0x5d4e38(0x1e9)][_0x5d4e38(0x1e5)]>0x0&&this[_0x5d4e38(0x2c5)](_0x181f30[_0x5d4e38(0x1e9)]);})),this['_syncEditingCollabCursorService'][_0x31dd4e(0x422)][_0x31dd4e(0x1ef)](_0x66cc31[_0x31dd4e(0x45d)](this[_0x31dd4e(0x289)]))['subscribe'](_0x2f054a=>{const _0x5b3369=_0x31dd4e;if((_0x2f054a==null?void 0x0:_0x2f054a[_0x5b3369(0x2e9)])!==this['unitID'])return;const _0x465b9f={'eventID':_0x48fdef['CollaborationEvent']['UPDATE_CURSOR'],'data':_0x2f054a};this[_0x5b3369(0x315)](_0x465b9f);}),this['disposeWithMe'](this[_0x31dd4e(0x43a)]['onCommandExecuted'](_0x5eeada=>{const _0x22e80b=_0x31dd4e;if(_0x5eeada['params']==null)return;const _0x395393=_0x5eeada[_0x22e80b(0x276)];if(_0x5eeada['id']!==_0x4db13e['RichTextEditingMutation']['id']||_0x395393[_0x22e80b(0x470)]!==this[_0x22e80b(0x2e9)])return;const _0x39a862={'id':_0x22e80b(0x25b),'params':_0x395393},_0x253af1=this[_0x22e80b(0x20c)];for(const [_0x1c58ed,_0x5a66d8]of _0x253af1){const _0x4ba3c5={'id':_0x22e80b(0x25b),'params':{'unitId':this[_0x22e80b(0x2e9)],'actions':null,'textRanges':_0x5a66d8[_0x22e80b(0x1e9)]}},_0x59a6af=this[_0x22e80b(0x27c)][_0x22e80b(0x3d7)](_0x39a862,_0x4ba3c5,!0x1);if(_0x48fdef['isTransformMutationFailure'](_0x59a6af))throw _0x59a6af[_0x22e80b(0x3ff)];_0x253af1[_0x22e80b(0x3d5)](_0x1c58ed,{..._0x5a66d8,'ranges':_0x59a6af[_0x22e80b(0x397)][_0x22e80b(0x276)][_0x22e80b(0x3c5)]});}queueMicrotask(()=>{const _0x4829f9=_0x22e80b;this[_0x4829f9(0x218)][_0x4829f9(0x3c9)](_0x253af1);});})));}[_0x4624f5(0x315)](_0x51f33b){const _0x34210e=_0x4624f5;var _0x4b6137,_0x9105e1;const {memberID:_0x3886f5,selection:_0x5744db}=_0x51f33b['data'],_0x1969ab=_0x7e2e27(_0x5744db),_0xc5a33d=(_0x9105e1=(_0x4b6137=this[_0x34210e(0x23a)]['getMember'](this[_0x34210e(0x2e9)],_0x3886f5))==null?void 0x0:_0x4b6137[_0x34210e(0x433)])!=null?_0x9105e1:_0x34210e(0x463),_0x2b9790={'color':this[_0x34210e(0x274)][_0x34210e(0x2ba)](_0x3886f5),'name':_0xc5a33d,'ranges':_0x1969ab},_0x8a8f85=this['cursorInfo'];_0x8a8f85[_0x34210e(0x3d5)](_0x3886f5,_0x2b9790),this[_0x34210e(0x218)][_0x34210e(0x3c9)](_0x8a8f85);}[_0x4624f5(0x2de)](_0x5cbfb2){const _0x45ca51=_0x4624f5,{memberID:_0x37970f}=_0x5cbfb2['data'],_0xe406b8=this[_0x45ca51(0x20c)];_0xe406b8[_0x45ca51(0x40e)](_0x37970f),this[_0x45ca51(0x218)][_0x45ca51(0x3c9)](_0xe406b8);}[_0x4624f5(0x24d)](){const _0x12c179=_0x4624f5;var _0x4a4fd8;if(this['_online']=!0x0,((_0x4a4fd8=this[_0x12c179(0x485)][_0x12c179(0x45a)]())==null?void 0x0:_0x4a4fd8[_0x12c179(0x30b)]())!==this[_0x12c179(0x2e9)])return;const _0x174f0e=this[_0x12c179(0x298)][_0x12c179(0x333)](_0x4db13e[_0x12c179(0x3c7)])[_0x12c179(0x2ae)]();Array[_0x12c179(0x462)](_0x174f0e)&&_0x174f0e[_0x12c179(0x1e5)]>0x0&&this[_0x12c179(0x2c5)](_0x174f0e);}['_toggleOffline'](){const _0x62379=_0x4624f5;this[_0x62379(0x27f)]=!0x1;}};_0x2262fb=_0x55c00a([_0x25c269(0x2,_0x161ac6[_0x4624f5(0x2b0)](_0x161ac6[_0x4624f5(0x2c2)])),_0x25c269(0x3,_0x161ac6[_0x4624f5(0x2b0)](_0x1846fc)),_0x25c269(0x4,_0x161ac6['Inject'](_0x46104e[_0x4624f5(0x222)])),_0x25c269(0x5,_0x161ac6[_0x4624f5(0x2b0)](_0x360498)),_0x25c269(0x6,_0x48fdef['ITransformService']),_0x25c269(0x7,_0x161ac6[_0x4624f5(0x37d)]),_0x25c269(0x8,_0x161ac6[_0x4624f5(0x41a)])],_0x2262fb);var _0x2278be=Object[_0x4624f5(0x272)],_0x11a7d9=(_0x370f85,_0x43d9f3,_0x399957,_0x2db51c)=>{for(var _0x2b32cb=_0x2db51c>0x1?void 0x0:_0x2db51c?_0x2278be(_0x43d9f3,_0x399957):_0x43d9f3,_0x4b13aa=_0x370f85['length']-0x1,_0x190f73;_0x4b13aa>=0x0;_0x4b13aa--)(_0x190f73=_0x370f85[_0x4b13aa])&&(_0x2b32cb=_0x190f73(_0x2b32cb)||_0x2b32cb);return _0x2b32cb;},_0x5ea10f=(_0x5ac5ff,_0x545fda)=>(_0x571717,_0x171529)=>_0x545fda(_0x571717,_0x171529,_0x5ac5ff);const _0x15a2ba=0x12c,_0x2c182a=0x64,_0x1cd72c=()=>{let _0x1e0796=[],_0x385d17=!0x1;return _0x166c55=>{_0x1e0796['push'](_0x166c55),_0x385d17||(_0x385d17=!0x0,setTimeout(()=>{_0x1e0796['forEach'](_0x40d488=>_0x40d488()),_0x1e0796=[],_0x385d17=!0x1;}));};};let _0x285ce1=class extends _0x161ac6[_0x4624f5(0x240)]{constructor(_0x156e92,_0x800dea,_0x52de8c,_0x2a37f0,_0x13e197,_0x95fdaa,_0x41dcde,_0x44f945){const _0x333339=_0x4624f5;super(),_0x47bfcc(this,_0x333339(0x27f),!0x1),_0x47bfcc(this,'_init',!0x1),_0x47bfcc(this,_0x333339(0x218),new _0x66cc31['BehaviorSubject'](new Map())),_0x47bfcc(this,_0x333339(0x3ed),this[_0x333339(0x218)]['asObservable']()),_0x47bfcc(this,'_roomMembers$',new _0x66cc31[(_0x333339(0x41e))]([])),_0x47bfcc(this,_0x333339(0x479),this[_0x333339(0x3a8)]['pipe'](_0x66cc31[_0x333339(0x405)](_0x15a2ba))),_0x47bfcc(this,_0x333339(0x2c5),_0x161ac6[_0x333339(0x3e4)]((_0x1fc79,_0x2b6c61)=>{const _0x459161=_0x333339,_0x1d7f0c={'eventID':_0x48fdef['CollaborationEvent'][_0x459161(0x261)],'data':{'unitID':this[_0x459161(0x2e9)],'memberID':this[_0x459161(0x344)][_0x459161(0x3d2)](),'selection':_0x50020c[_0x459161(0x45c)](_0x1fc79,_0x2b6c61[_0x459161(0x3d1)])}};this[_0x459161(0x344)][_0x459161(0x418)](_0x1d7f0c,this[_0x459161(0x2e9)]);},_0x2c182a)),(this[_0x333339(0x2e9)]=_0x156e92,this[_0x333339(0x344)]=_0x800dea,this[_0x333339(0x298)]=_0x52de8c,this[_0x333339(0x274)]=_0x2a37f0,this[_0x333339(0x23a)]=_0x13e197,this[_0x333339(0x485)]=_0x95fdaa,this[_0x333339(0x43a)]=_0x41dcde,this['_refRangeService']=_0x44f945);}get[_0x4624f5(0x20c)](){const _0x314306=_0x4624f5;return this[_0x314306(0x218)]['getValue']();}get[_0x4624f5(0x2fe)](){const _0x2406a4=_0x4624f5;return this[_0x2406a4(0x3a8)][_0x2406a4(0x3dc)]();}[_0x4624f5(0x214)](){const _0x1be0bb=_0x4624f5;super[_0x1be0bb(0x214)](),this[_0x1be0bb(0x218)][_0x1be0bb(0x3c9)](new Map()),this[_0x1be0bb(0x218)]['complete'](),this[_0x1be0bb(0x3a8)][_0x1be0bb(0x3c9)]([]),this[_0x1be0bb(0x3a8)][_0x1be0bb(0x487)]();}[_0x4624f5(0x2b2)](){const _0x3d8ed2=_0x4624f5;this[_0x3d8ed2(0x48d)]||(this[_0x3d8ed2(0x48d)]=!0x0,this[_0x3d8ed2(0x344)][_0x3d8ed2(0x221)][_0x3d8ed2(0x1ef)](_0x66cc31[_0x3d8ed2(0x45d)](this[_0x3d8ed2(0x289)]))[_0x3d8ed2(0x26b)](_0x33c10c=>{const _0x33e309=_0x3d8ed2;_0x33c10c===_0x46104e[_0x33e309(0x290)][_0x33e309(0x428)]?this[_0x33e309(0x24d)]():this[_0x33e309(0x1dd)]();}),this[_0x3d8ed2(0x344)][_0x3d8ed2(0x3fa)][_0x3d8ed2(0x1ef)](_0x66cc31[_0x3d8ed2(0x45d)](this[_0x3d8ed2(0x289)]))[_0x3d8ed2(0x26b)](_0x550a36=>{const _0x3a6cf0=_0x3d8ed2,_0x4bd5b2=_0x550a36[_0x3a6cf0(0x327)];_0x4bd5b2===_0x48fdef['CollaborationEvent']['UPDATE_CURSOR']&&this[_0x3a6cf0(0x315)](_0x550a36),_0x4bd5b2===_0x48fdef[_0x3a6cf0(0x3b2)][_0x3a6cf0(0x217)]&&this[_0x3a6cf0(0x2de)](_0x550a36);}),this[_0x3d8ed2(0x1cd)](),this['disposeWithMe'](this[_0x3d8ed2(0x43a)]['onCommandExecuted'](_0x3c4335=>{const _0x58811f=_0x3d8ed2;if(this['_online']&&_0x3c4335['id']===_0xc6f6be[_0x58811f(0x278)]['id']&&_0x3c4335[_0x58811f(0x276)][_0x58811f(0x470)]===this['unitID']){const _0x2c6244=_0x3c4335[_0x58811f(0x276)];this[_0x58811f(0x2c5)](_0x2c6244[_0x58811f(0x41b)],_0x2c6244[_0x58811f(0x209)][0x0]);}})));}['_onCursorUpdate'](_0x37f342){const _0x2f6360=_0x4624f5;var _0x1dff97,_0x703710;const {memberID:_0x266ef1,selection:_0xbc74a4}=_0x37f342[_0x2f6360(0x345)],{sheetName:_0x549446,range:_0x55b03}=_0x50020c[_0x2f6360(0x269)](_0xbc74a4),_0xae412b={'name':(_0x703710=(_0x1dff97=this[_0x2f6360(0x23a)]['getMember'](this[_0x2f6360(0x2e9)],_0x266ef1))==null?void 0x0:_0x1dff97[_0x2f6360(0x433)])!=null?_0x703710:_0x2f6360(0x463),'range':this[_0x2f6360(0x412)](_0x549446,_0x55b03),'sheetID':_0x549446,'color':this[_0x2f6360(0x274)][_0x2f6360(0x2ba)](_0x266ef1),'selection':_0xbc74a4},_0x10caaf=this[_0x2f6360(0x20c)];_0x10caaf[_0x2f6360(0x3d5)](_0x266ef1,_0xae412b),this['_cursorInfo$'][_0x2f6360(0x3c9)](_0x10caaf);}[_0x4624f5(0x2de)](_0x40b3f8){const _0x42e950=_0x4624f5,{memberID:_0x557ea0}=_0x40b3f8['data'],_0x2c76e1=this[_0x42e950(0x20c)];_0x2c76e1[_0x42e950(0x40e)](_0x557ea0),this['_cursorInfo$']['next'](_0x2c76e1);}[_0x4624f5(0x412)](_0x3768fe,_0x4e5d35){const _0x53a174=_0x4624f5;var _0x452567,_0x2c11a2;const _0x4cf103=(_0x2c11a2=(_0x452567=this[_0x53a174(0x485)]['getUniverSheetInstance'](this[_0x53a174(0x2e9)]))==null?void 0x0:_0x452567[_0x53a174(0x481)](_0x3768fe))==null?void 0x0:_0x2c11a2['getMergeData']();return(_0x4cf103==null?void 0x0:_0x4cf103[_0x53a174(0x1d8)](_0x57bce5=>_0x161ac6['Rectangle']['contains'](_0x57bce5,_0x4e5d35)))||_0x4e5d35;}['_onRefRangeChange'](){const _0x9d8619=_0x4624f5,_0x5670a3=new _0x161ac6[(_0x9d8619(0x46a))](),_0x8f853=_0x1cd72c(),_0x1b6564=()=>{const _0x4496ea=_0x9d8619;_0x5670a3[_0x4496ea(0x214)]();const _0x4845c9=(_0x4e5d48,_0x444cb4,_0x34756d,_0x3361f5)=>{const _0x3f344f=_0x4496ea;let _0x44fae0=[];switch(_0x4e5d48['id']){case _0xc6f6be['EffectRefRangId']['DeleteRangeMoveLeftCommandId']:{_0x44fae0=_0xc6f6be[_0x3f344f(0x22b)](_0x4e5d48,_0x3361f5);break;}case _0xc6f6be[_0x3f344f(0x361)][_0x3f344f(0x20a)]:{_0x44fae0=_0xc6f6be[_0x3f344f(0x430)](_0x4e5d48,_0x3361f5);break;}case _0xc6f6be[_0x3f344f(0x361)]['InsertColCommandId']:{_0x44fae0=_0xc6f6be[_0x3f344f(0x24e)](_0x4e5d48,_0x3361f5);break;}case _0xc6f6be[_0x3f344f(0x361)][_0x3f344f(0x279)]:{_0x44fae0=_0xc6f6be[_0x3f344f(0x379)](_0x4e5d48,_0x3361f5);break;}case _0xc6f6be[_0x3f344f(0x361)][_0x3f344f(0x29d)]:{_0x44fae0=_0xc6f6be['handleInsertRangeMoveRight'](_0x4e5d48,_0x3361f5);break;}case _0xc6f6be['EffectRefRangId'][_0x3f344f(0x37f)]:{_0x44fae0=_0xc6f6be[_0x3f344f(0x420)](_0x4e5d48,_0x3361f5);break;}case _0xc6f6be[_0x3f344f(0x361)][_0x3f344f(0x34f)]:{_0x44fae0=_0xc6f6be['handleMoveRange'](_0x4e5d48,_0x3361f5);break;}case _0xc6f6be[_0x3f344f(0x361)][_0x3f344f(0x30c)]:{_0x44fae0=_0xc6f6be[_0x3f344f(0x31d)](_0x4e5d48,_0x3361f5);break;}case _0xc6f6be[_0x3f344f(0x361)][_0x3f344f(0x26e)]:{_0x44fae0=_0xc6f6be[_0x3f344f(0x33a)](_0x4e5d48,_0x3361f5);break;}}const _0x3e40aa=_0xc6f6be[_0x3f344f(0x335)](_0x44fae0,_0x3361f5),_0x1b410a=this['cursorInfo'][_0x3f344f(0x333)](_0x444cb4);if(_0x1b410a&&_0x3e40aa){const _0x25673e={..._0x1b410a,'range':_0x3e40aa};this[_0x3f344f(0x20c)]['set'](_0x444cb4,_0x25673e),_0x8f853(()=>{const _0x511fd4=_0x3f344f,_0x2392dc=this[_0x511fd4(0x216)][_0x511fd4(0x255)](_0x3e40aa,_0x19572d=>(_0x2392dc['dispose'](),_0x4845c9(_0x19572d,_0x444cb4,_0x34756d,_0x3e40aa)));_0x5670a3[_0x511fd4(0x455)](_0x2392dc);});}return{'redos':[],'undos':[]};};this['cursorInfo'][_0x4496ea(0x265)]((_0x269efa,_0x3f0b07)=>{const _0x2ad6c5=_0x4496ea,{range:_0x44d0af,sheetID:_0x49fc84}=_0x269efa,_0x54a8e7=this[_0x2ad6c5(0x216)][_0x2ad6c5(0x255)](_0x44d0af,_0x11a34c=>(_0x54a8e7[_0x2ad6c5(0x214)](),_0x4845c9(_0x11a34c,_0x3f0b07,_0x49fc84,_0x44d0af)));_0x5670a3[_0x2ad6c5(0x455)](_0x54a8e7);});};this[_0x9d8619(0x30f)](_0x161ac6['toDisposable'](this[_0x9d8619(0x218)][_0x9d8619(0x26b)](()=>{_0x1b6564();})));}[_0x4624f5(0x24d)](){const _0x1f7c78=_0x4624f5;var _0x3fe35f,_0x1c2079;if(this['_online']=!0x0,((_0x3fe35f=this[_0x1f7c78(0x485)][_0x1f7c78(0x45a)]())==null?void 0x0:_0x3fe35f[_0x1f7c78(0x30b)]())!==this[_0x1f7c78(0x2e9)])return;const _0x23eb5c=(_0x1c2079=this['_injector'][_0x1f7c78(0x333)](_0xc6f6be['SheetsSelectionsService'])[_0x1f7c78(0x491)]())==null?void 0x0:_0x1c2079[0x0],_0x399dfa=this[_0x1f7c78(0x485)][_0x1f7c78(0x2bc)](_0x161ac6[_0x1f7c78(0x2d9)][_0x1f7c78(0x28b)])[_0x1f7c78(0x203)]();_0x23eb5c&&_0x399dfa&&this[_0x1f7c78(0x2c5)](_0x399dfa[_0x1f7c78(0x447)](),_0x23eb5c);}[_0x4624f5(0x1dd)](){const _0x1b72fc=_0x4624f5;this[_0x1b72fc(0x27f)]=!0x1;}};_0x285ce1=_0x11a7d9([_0x5ea10f(0x2,_0x161ac6[_0x4624f5(0x2b0)](_0x161ac6[_0x4624f5(0x2c2)])),_0x5ea10f(0x3,_0x161ac6[_0x4624f5(0x2b0)](_0x1846fc)),_0x5ea10f(0x4,_0x161ac6[_0x4624f5(0x2b0)](_0x46104e[_0x4624f5(0x222)])),_0x5ea10f(0x5,_0x161ac6['IUniverInstanceService']),_0x5ea10f(0x6,_0x161ac6[_0x4624f5(0x41a)]),_0x5ea10f(0x7,_0x161ac6['Inject'](_0xc6f6be[_0x4624f5(0x372)]))],_0x285ce1);var _0xfa0237=Object[_0x4624f5(0x272)],_0x33189d=(_0x131046,_0x50b1ad,_0x3c96a2,_0x492368)=>{for(var _0x802f16=_0x492368>0x1?void 0x0:_0x492368?_0xfa0237(_0x50b1ad,_0x3c96a2):_0x50b1ad,_0x2f5fd4=_0x131046['length']-0x1,_0x47ad8e;_0x2f5fd4>=0x0;_0x2f5fd4--)(_0x47ad8e=_0x131046[_0x2f5fd4])&&(_0x802f16=_0x47ad8e(_0x802f16)||_0x802f16);return _0x802f16;},_0x60fcfe=(_0x59dede,_0x1a2503)=>(_0x38ab0f,_0x52ddff)=>_0x1a2503(_0x38ab0f,_0x52ddff,_0x59dede);let _0x1508be=class extends _0x161ac6[_0x4624f5(0x240)]{constructor(_0x18b50f,_0xece82a,_0x324dc9){const _0x9d4787=_0x4624f5;super(),_0x47bfcc(this,_0x9d4787(0x3e2),new Map()),_0x47bfcc(this,_0x9d4787(0x29c),new _0x66cc31[(_0x9d4787(0x434))]()),(this['_univerInstanceService']=_0x18b50f,this[_0x9d4787(0x298)]=_0xece82a,this[_0x9d4787(0x264)]=_0x324dc9,this['_init']());}[_0x4624f5(0x214)](){const _0x326559=_0x4624f5;super[_0x326559(0x214)](),this[_0x326559(0x29c)]['complete'](),this['_entities']['forEach'](_0x5f07a4=>_0x5f07a4[_0x326559(0x214)]());}['getCollabCursors$'](_0xf5de5d){const _0x25b689=_0x4624f5;return this['_entities'][_0x25b689(0x390)](_0xf5de5d)?this[_0x25b689(0x3e2)][_0x25b689(0x333)](_0xf5de5d)[_0x25b689(0x3ed)]:this[_0x25b689(0x29c)][_0x25b689(0x1ef)](_0x66cc31[_0x25b689(0x438)](_0x2c3244=>_0x2c3244['unitID']===_0xf5de5d),_0x66cc31[_0x25b689(0x46f)](_0x5c1fcc=>_0x5c1fcc[_0x25b689(0x3ed)]));}[_0x4624f5(0x48d)](){const _0x2ced5f=_0x4624f5;this[_0x2ced5f(0x485)][_0x2ced5f(0x3b5)](_0x161ac6['UniverInstanceType'][_0x2ced5f(0x28b)])[_0x2ced5f(0x1ef)](_0x66cc31['takeUntil'](this[_0x2ced5f(0x289)]))[_0x2ced5f(0x26b)](async _0x473be6=>{const _0x3bfbfc=_0x2ced5f,_0x4dc573=_0x473be6['getUnitId'](),_0x5a1fe7=await this[_0x3bfbfc(0x351)](_0x4dc573);this[_0x3bfbfc(0x29c)][_0x3bfbfc(0x3c9)](_0x5a1fe7),this[_0x3bfbfc(0x3e2)]['set'](_0x4dc573,_0x5a1fe7);}),this['_univerInstanceService'][_0x2ced5f(0x3b5)](_0x161ac6[_0x2ced5f(0x2d9)][_0x2ced5f(0x23d)])[_0x2ced5f(0x1ef)](_0x66cc31[_0x2ced5f(0x45d)](this[_0x2ced5f(0x289)]))[_0x2ced5f(0x1ef)](_0x66cc31[_0x2ced5f(0x438)](_0x3df3f=>!_0x3df3f[_0x2ced5f(0x30b)]()[_0x2ced5f(0x25e)]('__')))[_0x2ced5f(0x26b)](async _0x5afa52=>{const _0x288190=_0x2ced5f,_0x42fd5d=_0x5afa52['getUnitId'](),_0x290f79=await this[_0x288190(0x2c7)](_0x42fd5d);this['_entityInit$'][_0x288190(0x3c9)](_0x290f79),this[_0x288190(0x3e2)][_0x288190(0x3d5)](_0x42fd5d,_0x290f79);}),_0x66cc31[_0x2ced5f(0x348)](this[_0x2ced5f(0x485)][_0x2ced5f(0x2f4)](_0x161ac6['UniverInstanceType']['UNIVER_DOC']),this[_0x2ced5f(0x485)][_0x2ced5f(0x2f4)](_0x161ac6[_0x2ced5f(0x2d9)]['UNIVER_SHEET']))[_0x2ced5f(0x1ef)](_0x66cc31['takeUntil'](this[_0x2ced5f(0x289)]))[_0x2ced5f(0x26b)](_0x3f4675=>{const _0x23adc6=_0x2ced5f,_0x3c17ce=_0x3f4675['getUnitId'](),_0xfc078a=this[_0x23adc6(0x3e2)][_0x23adc6(0x333)](_0x3c17ce);_0xfc078a&&(_0xfc078a[_0x23adc6(0x214)](),this[_0x23adc6(0x3e2)][_0x23adc6(0x40e)](_0x3c17ce));});}async[_0x4624f5(0x351)](_0x3eec7e){const _0x588ef0=_0x4624f5,_0x460088=await this['_collabSessionService'][_0x588ef0(0x43b)](_0x3eec7e),_0x418629=this[_0x588ef0(0x298)][_0x588ef0(0x3f2)](_0x285ce1,_0x3eec7e,_0x460088);return _0x418629['init'](),_0x418629;}async['_startDocCollabCursor'](_0x13f518){const _0x1bbf0f=_0x4624f5,_0x501abf=await this['_collabSessionService']['requireSession'](_0x13f518),_0x9a2322=this['_injector'][_0x1bbf0f(0x3f2)](_0x2262fb,_0x13f518,_0x501abf);return _0x9a2322['init'](),_0x9a2322;}};_0x1508be=_0x33189d([_0x60fcfe(0x0,_0x161ac6[_0x4624f5(0x37d)]),_0x60fcfe(0x1,_0x161ac6[_0x4624f5(0x2b0)](_0x161ac6[_0x4624f5(0x2c2)])),_0x60fcfe(0x2,_0x161ac6['Inject'](_0x46104e[_0x4624f5(0x26a)]))],_0x1508be);const _0x5a3e8a=0x14,_0x3574cb=0xc8,_0x319642=0x4,_0x5ad9a7=0x5;function _0xe175e2(_0x2f754e,_0x56fe6d){const _0x19e68f=_0x4624f5;let {radius:_0x116b5d,width:_0x558098,height:_0x9fbc0d}=_0x56fe6d;_0x116b5d=_0x116b5d!=null?_0x116b5d:0x0,_0x558098=_0x558098!=null?_0x558098:0x1e,_0x9fbc0d=_0x9fbc0d!=null?_0x9fbc0d:0x1e;let _0x7423e4=0x0,_0x58bdba=0x0,_0x347f51=0x0;_0x7423e4=_0x58bdba=_0x347f51=Math['min'](_0x116b5d,_0x558098/0x2,_0x9fbc0d/0x2),_0x2f754e['beginPath'](),_0x2f754e['moveTo'](_0x7423e4,0x0),_0x2f754e[_0x19e68f(0x467)](_0x558098-_0x58bdba,0x0),_0x2f754e[_0x19e68f(0x2aa)](_0x558098-_0x58bdba,_0x58bdba,_0x58bdba,Math['PI']*0x3/0x2,0x0,!0x1),_0x2f754e[_0x19e68f(0x467)](_0x558098,_0x9fbc0d-_0x347f51),_0x2f754e[_0x19e68f(0x2aa)](_0x558098-_0x347f51,_0x9fbc0d-_0x347f51,_0x347f51,0x0,Math['PI']/0x2,!0x1),_0x2f754e['lineTo'](0x0,_0x9fbc0d),_0x2f754e['lineTo'](0x0,_0x7423e4),_0x2f754e['arc'](_0x7423e4,_0x7423e4,_0x7423e4,Math['PI'],Math['PI']*0x3/0x2,!0x1),_0x2f754e[_0x19e68f(0x450)](),_0x56fe6d[_0x19e68f(0x201)]&&(_0x2f754e[_0x19e68f(0x37b)](),_0x2f754e[_0x19e68f(0x42c)]=_0x56fe6d[_0x19e68f(0x201)],_0x56fe6d[_0x19e68f(0x457)]==='evenodd'?_0x2f754e[_0x19e68f(0x201)]('evenodd'):_0x2f754e[_0x19e68f(0x201)](),_0x2f754e[_0x19e68f(0x304)]());}class _0x6ab412 extends _0x1fade8[_0x4624f5(0x3d9)]{constructor(_0x4fbca6,_0x343612){const _0x3252bf=_0x4624f5;super(_0x4fbca6,_0x343612),_0x47bfcc(this,'color'),_0x47bfcc(this,_0x3252bf(0x32d)),(this[_0x3252bf(0x2fc)]=_0x343612==null?void 0x0:_0x343612[_0x3252bf(0x2fc)],this[_0x3252bf(0x32d)]=_0x343612==null?void 0x0:_0x343612[_0x3252bf(0x32d)]);}static[_0x4624f5(0x3b4)](_0x18afcb,_0x4edf0c){const _0x1ed160=_0x4624f5,{text:_0x589130,color:_0x34c7dc}=_0x4edf0c;_0x18afcb[_0x1ed160(0x37b)](),_0x18afcb[_0x1ed160(0x371)]=_0x1ed160(0x49b);const _0x265d95=_0x18afcb[_0x1ed160(0x478)](_0x589130)['width'],_0x54ccf8=Math[_0x1ed160(0x38a)](_0x265d95+0x2*_0x319642,_0x3574cb);_0xe175e2(_0x18afcb,{'height':_0x5a3e8a,'radius':0x4,'width':_0x54ccf8,'fill':_0x34c7dc}),_0x18afcb[_0x1ed160(0x42c)]=_0x1ed160(0x213);const _0x349b3a=_0x319642,_0x48e380=_0x5a3e8a-_0x5ad9a7,_0x1a69ce=_0x3574cb-0x2*_0x319642;if(_0x265d95>_0x1a69ce){let _0x42b243='',_0x253b4a=0x0;for(const _0x5cf810 of _0x589130){const _0x8d1159=_0x18afcb[_0x1ed160(0x478)](_0x5cf810)[_0x1ed160(0x230)];if(_0x253b4a+_0x8d1159<=_0x1a69ce-_0x18afcb[_0x1ed160(0x478)](_0x1ed160(0x362))[_0x1ed160(0x230)])_0x42b243+=_0x5cf810,_0x253b4a+=_0x8d1159;else{_0x42b243+=_0x1ed160(0x362);break;}}_0x18afcb['fillText'](_0x42b243,_0x349b3a,_0x48e380);}else _0x18afcb[_0x1ed160(0x3e1)](_0x589130,_0x349b3a,_0x48e380);_0x18afcb[_0x1ed160(0x304)]();}[_0x4624f5(0x249)](_0x2ab829){_0x6ab412['drawWith'](_0x2ab829,this);}}const _0x22ea6a='collab-text-anchor-',_0x7e52ff=_0x4624f5(0x36c),_0x349ac6=_0x4624f5(0x211),_0x21cd66=0x6,_0x1ac3bb=1.5,_0xc9f299=0x4,_0x108bd2=1.5,_0x3faf28=_0x4624f5(0x2f7);class _0x5942d4{constructor(_0x59727b,_0x1e3f12,_0xd7e4bf,_0x3361b2){const _0x2c5481=_0x4624f5;_0x47bfcc(this,'_shapes',[]),_0x47bfcc(this,_0x2c5481(0x454),null),_0x47bfcc(this,_0x2c5481(0x2f6),null),_0x47bfcc(this,'_anchorDot',null),_0x47bfcc(this,_0x2c5481(0x488),null),_0x47bfcc(this,'_eventUnsubscribe',null),(this[_0x2c5481(0x3ea)]=_0x59727b,this[_0x2c5481(0x2f3)]=_0x1e3f12,this[_0x2c5481(0x212)]=_0xd7e4bf,this[_0x2c5481(0x44b)]=_0x3361b2,this[_0x2c5481(0x399)]());}set[_0x4624f5(0x3da)](_0x5825b0){const _0x389e96=_0x4624f5;_0x5825b0?(this[_0x389e96(0x377)]&&this[_0x389e96(0x377)][_0x389e96(0x295)](),this['_textBubble']&&this[_0x389e96(0x2f6)][_0x389e96(0x27d)]()):(this[_0x389e96(0x377)]&&this[_0x389e96(0x377)][_0x389e96(0x27d)](),this[_0x389e96(0x2f6)]&&this[_0x389e96(0x2f6)][_0x389e96(0x295)]());}['dispose'](){const _0xfc06a3=_0x4624f5;for(const _0x283c2a of this[_0xfc06a3(0x387)])_0x283c2a[_0xfc06a3(0x214)]();this[_0xfc06a3(0x2f6)]&&this[_0xfc06a3(0x2f6)][_0xfc06a3(0x214)](),this[_0xfc06a3(0x377)]&&this[_0xfc06a3(0x377)][_0xfc06a3(0x214)](),this['_anchor']&&this[_0xfc06a3(0x454)][_0xfc06a3(0x214)](),this['_eventUnsubscribe']&&this[_0xfc06a3(0x250)]();}[_0x4624f5(0x399)](){const _0xf6a5f3=_0x4624f5;var _0x19c86b;const {_docSkeleton:_0x4cee51,_document:_0x8ff928}=this,{color:_0x19bac8,name:_0x57fd98,ranges:_0x582562}=this[_0xf6a5f3(0x3ea)],_0x4c5856=_0x8ff928[_0xf6a5f3(0x25d)](),{docsLeft:_0x560f25,docsTop:_0x500460}=_0x4c5856,_0x3e7cf5=new _0x5d4e8b[(_0xf6a5f3(0x36b))](_0x4c5856,_0x4cee51);for(const {startOffset:_0x23520e,endOffset:_0x1c1701,rangeType:_0x31ecd1,segmentId:_0x3e237a,segmentPage:_0x543c35,collapsed:_0x1b2d97,isActive:_0x4f22f3}of _0x582562){const _0x3cec7b=_0x4cee51[_0xf6a5f3(0x31b)](_0x23520e,!0x0,_0x3e237a,_0x543c35);let _0x493c4d=_0x4cee51[_0xf6a5f3(0x31b)](_0x1c1701,!0x0,_0x3e237a,_0x543c35);if(_0x493c4d==null&&(_0x493c4d=_0x4cee51[_0xf6a5f3(0x31b)](_0x1c1701-0x1,!0x1,_0x3e237a,_0x543c35)),_0x4f22f3){const {contentBoxPointGroup:_0x5df147}=_0x3e7cf5[_0xf6a5f3(0x38e)](_0x493c4d,_0x493c4d);if(_0x5df147['length']===0x0)continue;this[_0xf6a5f3(0x407)](_0x19bac8,_0x5df147,_0x560f25,_0x500460,_0x57fd98),this[_0xf6a5f3(0x250)]=this[_0xf6a5f3(0x226)]();}if(_0x3cec7b&&_0x493c4d){if(_0x31ecd1===_0x161ac6[_0xf6a5f3(0x29b)][_0xf6a5f3(0x475)]){const _0x501a18=new _0x5d4e8b[(_0xf6a5f3(0x2d0))](_0x4c5856,_0x4cee51),{pointGroup:_0x85b3d5}=(_0x19c86b=_0x501a18[_0xf6a5f3(0x38e)](_0x3cec7b,_0x493c4d))!=null?_0x19c86b:{};if(_0x85b3d5==null||_0x85b3d5[_0xf6a5f3(0x1e5)]===0x0)continue;this[_0xf6a5f3(0x48e)](_0x19bac8,_0x85b3d5,_0x560f25,_0x500460);}else{if(!_0x1b2d97){const {borderBoxPointGroup:_0x7c9f47}=_0x3e7cf5[_0xf6a5f3(0x38e)](_0x3cec7b,_0x493c4d);if(_0x7c9f47[_0xf6a5f3(0x1e5)]===0x0)continue;this[_0xf6a5f3(0x256)](_0x19bac8,_0x7c9f47,_0x560f25,_0x500460);}}}}}['_drawAnchor'](_0x28e112,_0xde7109,_0x4c80c2,_0x40302f,_0x50862d){const _0x4b0133=_0x4624f5,_0x91f582=this[_0x4b0133(0x363)](_0xde7109),{left:_0x2d7d99,top:_0x1e8042,height:_0x33c4dd}=_0x91f582,_0x4e8fe4=this[_0x4b0133(0x328)](),_0x25bcd9=_0x108bd2/_0x4e8fe4,_0x1cd87a=new _0x1fade8['Rect'](_0x22ea6a+_0x161ac6[_0x4b0133(0x497)](_0x21cd66),{'left':_0x2d7d99+_0x4c80c2-_0x25bcd9,'top':_0x1e8042+_0x40302f,'height':_0x33c4dd,'width':_0x1ac3bb,'fill':_0x28e112||_0x1fade8[_0x4b0133(0x293)](_0x161ac6[_0x4b0133(0x406)][_0x4b0133(0x4a2)],0x0),'strokeWidth':_0x25bcd9,'stroke':_0x3faf28,'evented':!0x0});this[_0x4b0133(0x454)]=_0x1cd87a,this['_scene'][_0x4b0133(0x49c)](_0x1cd87a,_0x5d4e8b[_0x4b0133(0x44c)]);const _0x3df983=new _0x1fade8[(_0x4b0133(0x374))](_0x22ea6a+_0x161ac6[_0x4b0133(0x497)](_0x21cd66),{'left':_0x2d7d99+_0x4c80c2-_0x25bcd9,'top':_0x1e8042+_0x40302f-_0xc9f299/0x2,'height':_0xc9f299,'width':_0xc9f299,'fill':_0x28e112||_0x1fade8[_0x4b0133(0x293)](_0x161ac6[_0x4b0133(0x406)][_0x4b0133(0x4a2)],0x0),'strokeWidth':0x0,'stroke':_0x28e112||_0x1fade8[_0x4b0133(0x293)](_0x161ac6['COLORS'][_0x4b0133(0x4a2)],0x0),'evented':!0x1});this['_anchorDot']=_0x3df983,this[_0x4b0133(0x2f3)][_0x4b0133(0x49c)](_0x3df983,_0x5d4e8b['TEXT_RANGE_LAYER_INDEX']);const _0x1f9cf5=new _0x6ab412(_0x22ea6a+_0x161ac6['generateRandomId'](_0x21cd66),{'left':_0x2d7d99+_0x4c80c2-_0x25bcd9,'top':_0x1e8042+_0x40302f-_0x5a3e8a,'text':_0x50862d,'color':_0x28e112});this[_0x4b0133(0x2f6)]=_0x1f9cf5,this['_scene'][_0x4b0133(0x49c)](_0x1f9cf5,_0x5d4e8b[_0x4b0133(0x44c)]),this[_0x4b0133(0x3da)]=!0x1;}[_0x4624f5(0x226)](){const _0x118671=_0x4624f5,_0x575a21=this[_0x118671(0x454)][_0x118671(0x1d3)][_0x118671(0x37c)](()=>{const _0x2c4956=_0x118671;this[_0x2c4956(0x3da)]=!0x0;}),_0x568398=this['_anchor'][_0x118671(0x498)][_0x118671(0x37c)](()=>{const _0x4964fa=_0x118671;this[_0x4964fa(0x488)]&&clearTimeout(this['_hideTimer']),this['_hideTimer']=setTimeout(()=>{const _0x1c8a26=_0x4964fa;this[_0x1c8a26(0x3da)]=!0x1;},0x7d0);});return()=>{const _0x409074=_0x118671;_0x575a21[_0x409074(0x3aa)](),_0x568398['unsubscribe']();};}['_drawTextRange'](_0x3894f6,_0x53eb5c,_0x3b8ce3,_0x5a1dc7){const _0x39ccb7=_0x4624f5,_0x29bafe=new _0x161ac6[(_0x39ccb7(0x2a9))](_0x3894f6)[_0x39ccb7(0x45b)](0.2)[_0x39ccb7(0x466)](),_0x1d4b17=new _0x1fade8['RegularPolygon'](_0x7e52ff+_0x161ac6[_0x39ccb7(0x497)](_0x21cd66),{'pointsGroup':_0x53eb5c,'fill':_0x29bafe||_0x1fade8[_0x39ccb7(0x293)](_0x161ac6['COLORS'][_0x39ccb7(0x4a2)],0.2),'left':_0x3b8ce3,'top':_0x5a1dc7,'evented':!0x1,'debounceParentDirty':!0x1});this[_0x39ccb7(0x387)]['push'](_0x1d4b17),this[_0x39ccb7(0x2f3)][_0x39ccb7(0x49c)](_0x1d4b17,_0x5d4e8b[_0x39ccb7(0x44c)]);}[_0x4624f5(0x48e)](_0x1e041d,_0x4e0162,_0x8a3555,_0x35a54f){const _0xbbeb2b=_0x4624f5,_0x2fb77f=new _0x161ac6[(_0xbbeb2b(0x2a9))](_0x1e041d)[_0xbbeb2b(0x45b)](0.2)[_0xbbeb2b(0x466)](),_0x30a017=new _0x1fade8[(_0xbbeb2b(0x3fe))](_0x349ac6+_0x161ac6['generateRandomId'](_0x21cd66),{'pointsGroup':_0x4e0162,'fill':_0x2fb77f||_0x1fade8[_0xbbeb2b(0x293)](_0x161ac6[_0xbbeb2b(0x406)][_0xbbeb2b(0x4a2)],0.2),'left':_0x8a3555,'top':_0x35a54f,'evented':!0x1,'debounceParentDirty':!0x1});this['_shapes'][_0xbbeb2b(0x426)](_0x30a017),this[_0xbbeb2b(0x2f3)][_0xbbeb2b(0x49c)](_0x30a017,_0x5d4e8b[_0xbbeb2b(0x44c)]);}[_0x4624f5(0x363)](_0x39b9b9){const _0x227915=_0x39b9b9[0x0],_0x4d7eae=_0x227915[0x0],_0x3587df=_0x227915[0x2],{x:_0x2f1ed9,y:_0x4fa667}=_0x4d7eae,{x:_0x15ef27,y:_0x2e7394}=_0x3587df;return{'left':_0x2f1ed9,'top':_0x4fa667,'width':_0x15ef27-_0x2f1ed9,'height':_0x2e7394-_0x4fa667};}[_0x4624f5(0x328)](){const _0x459a10=_0x4624f5,{scaleX:_0x57d601,scaleY:_0x41b8f3}=this[_0x459a10(0x2f3)][_0x459a10(0x1fc)]();return Math[_0x459a10(0x251)](_0x57d601,_0x41b8f3);}}var _0x4a5667=Object[_0x4624f5(0x272)],_0xb1469b=(_0x512f72,_0x3130c1,_0x1296c5,_0x171887)=>{const _0x1d3fce=_0x4624f5;for(var _0x4d22ad=_0x171887>0x1?void 0x0:_0x171887?_0x4a5667(_0x3130c1,_0x1296c5):_0x3130c1,_0x18fd73=_0x512f72[_0x1d3fce(0x1e5)]-0x1,_0x4b61d2;_0x18fd73>=0x0;_0x18fd73--)(_0x4b61d2=_0x512f72[_0x18fd73])&&(_0x4d22ad=_0x4b61d2(_0x4d22ad)||_0x4d22ad);return _0x4d22ad;},_0xf20c48=(_0x547082,_0x1c8e31)=>(_0x2d57c6,_0x59290c)=>_0x1c8e31(_0x2d57c6,_0x59290c,_0x547082);let _0x47d0f4=class extends _0x161ac6[_0x4624f5(0x240)]{constructor(_0x743b12,_0x31eb66,_0x2dee19,_0x298aed,_0x445271){const _0x177637=_0x4624f5;super(),_0x47bfcc(this,_0x177637(0x34b),[]),_0x47bfcc(this,'_cursors',[]),(this[_0x177637(0x38c)]=_0x743b12,this[_0x177637(0x395)]=_0x31eb66,this[_0x177637(0x2c8)]=_0x2dee19,this[_0x177637(0x43a)]=_0x298aed,this[_0x177637(0x3c0)]=_0x445271,this[_0x177637(0x48d)]());}[_0x4624f5(0x48d)](){const _0x3394a9=_0x4624f5,_0x3a307e=this[_0x3394a9(0x38c)][_0x3394a9(0x470)],_0x4597fd=this[_0x3394a9(0x395)];this['disposeWithMe'](_0x66cc31[_0x3394a9(0x2f0)]([this['_collabCursorController']['getCollabCursors$'](_0x3a307e),this[_0x3394a9(0x3c0)][_0x3394a9(0x271)]])[_0x3394a9(0x1ef)](_0x136df2['map'](([_0x3119bd,_0x3cd825])=>({'skeleton':_0x4597fd[_0x3394a9(0x341)](),'cursors':[..._0x3119bd[_0x3394a9(0x42f)]()][_0x3394a9(0x1f5)](_0x4aa686=>({..._0x4aa686,'color':this[_0x3394a9(0x3c0)]['getColorFromTheme'](_0x4aa686[_0x3394a9(0x2fc)])}))})))[_0x3394a9(0x26b)](_0x4fcfe0=>{const _0xee3841=_0x3394a9;if(this[_0xee3841(0x22c)](),_0x4fcfe0){const {skeleton:_0xbb0f9f,cursors:_0x4670a1}=_0x4fcfe0;this[_0xee3841(0x398)](_0xbb0f9f,_0x4670a1);}})),this['_initResize'](),this[_0x3394a9(0x36d)]();}[_0x4624f5(0x398)](_0x29ba06,_0x1fb455){const _0x34e260=_0x4624f5,{scene:_0x3f327e,mainComponent:_0x36598c}=this[_0x34e260(0x38c)],_0x21d5d3=_0x1fb455[_0x34e260(0x44e)](_0x3081d2=>new _0x5942d4(_0x3081d2,_0x3f327e,_0x29ba06,_0x36598c));this['_cursorShapes']=_0x21d5d3,this[_0x34e260(0x322)]=_0x1fb455;}[_0x4624f5(0x2b3)](){const _0x2bf5fe=_0x4624f5;this[_0x2bf5fe(0x22c)]();const {scene:_0x284a6e,mainComponent:_0x11ecf0}=this[_0x2bf5fe(0x38c)],_0x524ae1=this['_docSkeletonManagerService'][_0x2bf5fe(0x341)](),_0x3e1231=this['_cursors'][_0x2bf5fe(0x44e)](_0x2603bd=>new _0x5942d4(_0x2603bd,_0x284a6e,_0x524ae1,_0x11ecf0));this['_cursorShapes']=_0x3e1231;}[_0x4624f5(0x22c)](){const _0x1c7506=_0x4624f5;this[_0x1c7506(0x34b)][_0x1c7506(0x265)](_0x4d9f99=>_0x4d9f99[_0x1c7506(0x214)]()),this['_cursorShapes']=[];}[_0x4624f5(0x36d)](){const _0x2f7ebb=_0x4624f5,_0x5b1e0d=[_0x5d4e8b['SetDocZoomRatioOperation']['id']];this[_0x2f7ebb(0x30f)](this[_0x2f7ebb(0x43a)]['onCommandExecuted'](_0xa672e5=>{const _0x2b8c92=_0x2f7ebb;_0x5b1e0d[_0x2b8c92(0x354)](_0xa672e5['id'])&&_0xa672e5[_0x2b8c92(0x276)]['unitId']===this[_0x2b8c92(0x38c)][_0x2b8c92(0x470)]&&this[_0x2b8c92(0x2b3)]();}));}[_0x4624f5(0x40d)](){const _0x11e0c1=_0x4624f5;this[_0x11e0c1(0x30f)](_0x161ac6[_0x11e0c1(0x312)](this[_0x11e0c1(0x38c)][_0x11e0c1(0x303)][_0x11e0c1(0x36f)])['pipe'](_0x136df2[_0x11e0c1(0x438)](_0x586fd8=>_0x586fd8[_0x11e0c1(0x35b)]===_0x1fade8[_0x11e0c1(0x37a)][_0x11e0c1(0x38b)]),_0x136df2[_0x11e0c1(0x440)](0x10))['subscribe'](()=>{const _0x14d1e2=_0x11e0c1;this[_0x14d1e2(0x2b3)]();}));}};_0x47d0f4=_0xb1469b([_0xf20c48(0x1,_0x161ac6[_0x4624f5(0x2b0)](_0x4db13e[_0x4624f5(0x242)])),_0xf20c48(0x2,_0x161ac6[_0x4624f5(0x2b0)](_0x1508be)),_0xf20c48(0x3,_0x161ac6[_0x4624f5(0x41a)]),_0xf20c48(0x4,_0x161ac6[_0x4624f5(0x2b0)](_0x161ac6[_0x4624f5(0x31f)]))],_0x47d0f4);const _0xd5b4f0=0x1,_0x5f0efe=1.5;class _0x5c4987 extends _0x1fade8[_0x4624f5(0x3d9)]{constructor(_0x22a934,_0x5593ae){const _0x1c7248=_0x4624f5;super(_0x22a934,_0x5593ae),_0x47bfcc(this,'_color'),_0x47bfcc(this,_0x1c7248(0x2a0),!0x1),_0x47bfcc(this,_0x1c7248(0x24c)),_0x47bfcc(this,'_name',''),_0x47bfcc(this,'_labelPosition','top'),_0x47bfcc(this,'_backgroundColor'),(_0x5593ae&&this[_0x1c7248(0x3e0)](_0x5593ae),this[_0x1c7248(0x1d3)][_0x1c7248(0x37c)](()=>this['setShapeProps']({'hovered':!0x0})),this['onPointerLeave$'][_0x1c7248(0x37c)](()=>this['setShapeProps']({'hovered':!0x1})));}['setShapeProps'](_0x124c0f){const _0x39eefd=_0x4624f5;var _0x530750,_0x38243f,_0x3cbe7a,_0x301d22,_0x3b97e6,_0x58fd44;this[_0x39eefd(0x452)]=(_0x530750=_0x124c0f[_0x39eefd(0x2fc)])!=null?_0x530750:this[_0x39eefd(0x452)],this[_0x39eefd(0x2a0)]=(_0x38243f=_0x124c0f[_0x39eefd(0x42d)])!=null?_0x38243f:this[_0x39eefd(0x2a0)],this[_0x39eefd(0x24c)]=(_0x3cbe7a=_0x124c0f[_0x39eefd(0x3d1)])!=null?_0x3cbe7a:this['_range'],this[_0x39eefd(0x33f)]=(_0x301d22=_0x124c0f[_0x39eefd(0x433)])!=null?_0x301d22:this[_0x39eefd(0x33f)],this[_0x39eefd(0x3f4)]=(_0x3b97e6=_0x124c0f['labelPosition'])!=null?_0x3b97e6:this[_0x39eefd(0x3f4)],this[_0x39eefd(0x446)]=(_0x58fd44=_0x124c0f[_0x39eefd(0x331)])!=null?_0x58fd44:this['_backgroundColor'],this[_0x39eefd(0x2f8)]({'width':_0x124c0f[_0x39eefd(0x230)],'height':_0x124c0f['height']});}[_0x4624f5(0x28c)](_0x1ae4bc){const _0x4f3789=_0x4624f5,{row:_0x4dd8ec,column:_0x86e9b}=_0x1ae4bc;if(_0x4dd8ec>=this[_0x4f3789(0x24c)][_0x4f3789(0x2e8)]&&_0x4dd8ec<=this[_0x4f3789(0x24c)]['endRow']&&_0x86e9b>=this[_0x4f3789(0x24c)][_0x4f3789(0x2cd)]&&_0x86e9b<=this[_0x4f3789(0x24c)][_0x4f3789(0x3f9)]){this[_0x4f3789(0x3e0)]({'hovered':!0x0});return;}this[_0x4f3789(0x3e0)]({'hovered':!0x1});}[_0x4624f5(0x1f3)](_0x12fcfe){return!0x1;}['_draw'](_0x13ca51){const _0x4f1cbc=_0x4624f5;_0x1fade8[_0x4f1cbc(0x374)][_0x4f1cbc(0x3b4)](_0x13ca51,{'width':this['width'],'height':this[_0x4f1cbc(0x3f8)],'strokeWidth':_0x5f0efe,'stroke':this[_0x4f1cbc(0x452)],'evented':!0x1,'fill':this[_0x4f1cbc(0x446)]}),this[_0x4f1cbc(0x2a0)]&&(_0x13ca51[_0x4f1cbc(0x37b)](),_0x13ca51['transform'](0x1,0x0,0x0,0x1,this['width'],this['_labelPosition']===_0x4f1cbc(0x23b)?0x0:-_0x5a3e8a),_0x6ab412[_0x4f1cbc(0x3b4)](_0x13ca51,{'text':this['_name'],'color':this[_0x4f1cbc(0x452)]}),_0x13ca51['restore']());}}var _0x222b6c=Object[_0x4624f5(0x272)],_0x44d088=(_0x3972e2,_0x350b7b,_0x2782a7,_0x37e1ff)=>{const _0x41429d=_0x4624f5;for(var _0x389d18=_0x37e1ff>0x1?void 0x0:_0x37e1ff?_0x222b6c(_0x350b7b,_0x2782a7):_0x350b7b,_0x533d26=_0x3972e2[_0x41429d(0x1e5)]-0x1,_0x165812;_0x533d26>=0x0;_0x533d26--)(_0x165812=_0x3972e2[_0x533d26])&&(_0x389d18=_0x165812(_0x389d18)||_0x389d18);return _0x389d18;},_0x49f4d0=(_0x566584,_0x2e9bb9)=>(_0x8e1276,_0x51bc22)=>_0x2e9bb9(_0x8e1276,_0x51bc22,_0x566584);const _0x5356fe=0x1389;let _0x2d665f=class extends _0x161ac6['RxDisposable']{constructor(_0x3ac546,_0x2225fa,_0x4cfbeb,_0x1e8d2a){const _0x106e99=_0x4624f5;super(),_0x47bfcc(this,_0x106e99(0x322),new Set()),_0x47bfcc(this,_0x106e99(0x1fd),null),(this[_0x106e99(0x38c)]=_0x3ac546,this[_0x106e99(0x393)]=_0x2225fa,this['_collabCursorController']=_0x4cfbeb,this['_themeService']=_0x1e8d2a,this['_init']());}[_0x4624f5(0x48d)](){const _0x40c3c4=_0x4624f5;this[_0x40c3c4(0x393)][_0x40c3c4(0x330)][_0x40c3c4(0x1ef)](_0x136df2[_0x40c3c4(0x45d)](this[_0x40c3c4(0x289)]),_0x136df2[_0x40c3c4(0x46f)](_0x377cfc=>{const _0xa6ace8=_0x40c3c4;if(_0x377cfc){const _0x3bc775=_0x377cfc[_0xa6ace8(0x2bf)];return _0x66cc31[_0xa6ace8(0x2f0)](this[_0xa6ace8(0x2c8)][_0xa6ace8(0x2c3)](this[_0xa6ace8(0x38c)][_0xa6ace8(0x470)]),this[_0xa6ace8(0x3c0)][_0xa6ace8(0x271)])[_0xa6ace8(0x1ef)](_0x136df2[_0xa6ace8(0x44e)](([_0x726aaf,_0x22a5c8])=>{const _0x51db45=_0xa6ace8,_0x5ca8a5=new Map();return _0x726aaf[_0x51db45(0x265)]((_0x5dd89e,_0x21aec5)=>{const _0x59b6ee=_0x51db45;if(_0x5dd89e['sheetID']===_0x3bc775){const _0x85e4f4={..._0x5dd89e};_0x85e4f4[_0x59b6ee(0x2fc)]=this[_0x59b6ee(0x3c0)][_0x59b6ee(0x3d8)](_0x5dd89e[_0x59b6ee(0x2fc)]),_0x5ca8a5[_0x59b6ee(0x3d5)](_0x21aec5,_0x85e4f4);}}),{'skeleton':_0x377cfc,'cursors':_0x5ca8a5};}));}return _0x66cc31['of']({'skeleton':null,'cursors':new Map()});}))['subscribe'](({skeleton:_0x4af596,cursors:_0x4cdeff})=>{const _0x1f6f63=_0x40c3c4;this[_0x1f6f63(0x22c)](),_0x4af596&&this[_0x1f6f63(0x398)](_0x4af596,_0x4cdeff);}),this[_0x40c3c4(0x393)][_0x40c3c4(0x330)]['subscribe'](_0x2eec4d=>{const _0x6551b6=_0x40c3c4;if(_0x2eec4d==null)return;const {skeleton:_0x4ec28c}=_0x2eec4d,{scene:_0x207b74}=this[_0x6551b6(0x38c)];_0x207b74[_0x6551b6(0x458)][_0x6551b6(0x37c)](_0x161ac6[_0x6551b6(0x3e4)](_0xed68=>{const _0x1f371a=_0x6551b6;var _0x18a802,_0x36aba4;const {offsetX:_0x5c2771,offsetY:_0x4d078b}=_0xed68,{x:_0x3b3b50,y:_0x30c118}=_0x207b74[_0x1f371a(0x2fd)](_0x1fade8[_0x1f371a(0x305)][_0x1f371a(0x427)]([_0x5c2771,_0x4d078b])),{scaleX:_0x365b45,scaleY:_0x197a9a}=_0x207b74['getAncestorScale'](),_0x29601e=_0x207b74[_0x1f371a(0x3db)](_0x1fade8['SHEET_VIEWPORT_KEY'][_0x1f371a(0x2bd)]),_0x13104c=_0x207b74[_0x1f371a(0x483)](_0x1fade8[_0x1f371a(0x305)][_0x1f371a(0x427)]([_0x3b3b50,_0x30c118]),_0x29601e),_0x299ebf=_0x4ec28c['getCellPositionByOffset'](_0x5c2771,_0x4d078b,_0x365b45,_0x197a9a,_0x13104c);((_0x18a802=this[_0x1f371a(0x1fd)])==null?void 0x0:_0x18a802[_0x1f371a(0x476)])===_0x299ebf[_0x1f371a(0x476)]&&((_0x36aba4=this['_lastPointer'])==null?void 0x0:_0x36aba4[_0x1f371a(0x3e5)])===_0x299ebf[_0x1f371a(0x3e5)]||this['_cursors'][_0x1f371a(0x265)](_0x2ca931=>{const _0x9fb1fa=_0x1f371a;_0x2ca931[_0x9fb1fa(0x28c)](_0x299ebf);});},0x64));});}[_0x4624f5(0x398)](_0x24b9cd,_0xd7a9f){const _0x2104f7=_0x4624f5;var _0x4a9344;const _0x1a6e72=(_0x4a9344=this[_0x2104f7(0x393)][_0x2104f7(0x2e2)]())==null?void 0x0:_0x4a9344[_0x2104f7(0x49a)];if(!_0x1a6e72)return;const _0x46b57d=this[_0x2104f7(0x3df)]();if(!_0x46b57d)return;this[_0x2104f7(0x322)][_0x2104f7(0x265)](_0x35c410=>{const _0x52b53e=_0x2104f7;_0x35c410[_0x52b53e(0x236)]();});const {scene:_0x4c3713}=_0x46b57d,_0x58f058=_0x22fbae(Array[_0x2104f7(0x243)](_0xd7a9f[_0x2104f7(0x42f)]()))[_0x2104f7(0x44e)](_0x4227d3=>{const _0x444647=_0x2104f7,{color:_0x584e3c,range:_0x584927,name:_0xe96b1b,selection:_0x5cd971,sheetID:_0xe886fb}=_0x4227d3,{startColumn:_0xaa0ef,startRow:_0x3bb447,endColumn:_0x3fc287,endRow:_0x28e3ff}=_0x584927,_0x376d17=_0x5b4c60['getCoordByCell'](_0x3bb447,_0xaa0ef,_0x4c3713,_0x1a6e72),_0xf6a6a6=_0x5b4c60['getCoordByCell'](_0x28e3ff,_0x3fc287,_0x4c3713,_0x1a6e72),{columnHeaderHeightAndMarginTop:_0x360639}=_0x1a6e72,{startX:_0x39b636,startY:_0xd31f44}=_0x376d17,{endX:_0xdec112,endY:_0x5ef07b}=_0xf6a6a6,_0x4b6b08=_0xdec112-_0x39b636,_0x47fc30=_0x5ef07b-_0xd31f44,_0x3afda2={'labelPosition':_0xd31f44-_0x360639>=_0x5a3e8a?_0x444647(0x3a1):_0x444647(0x23b),'sheetID':_0xe886fb,'range':_0x584927,'color':_0x584e3c,'name':_0xe96b1b,'selection':_0x5cd971,'left':_0x39b636,'top':_0xd31f44,'width':_0x4b6b08,'height':_0x47fc30,'evented':!0x1,'zIndex':_0x5356fe};return new _0x5c4987(_0xe96b1b,_0x3afda2);});_0x4c3713[_0x2104f7(0x2dc)](_0x58f058,_0xd5b4f0),this[_0x2104f7(0x322)]=new Set(_0x58f058);}[_0x4624f5(0x22c)](){const _0x169345=_0x4624f5;var _0x4117e9;(_0x4117e9=this[_0x169345(0x322)])==null||_0x4117e9['forEach'](_0x5e188b=>_0x5e188b[_0x169345(0x214)]());}['_getSheetObject'](){const _0x3910ae=_0x4624f5;return _0x5b4c60[_0x3910ae(0x386)](this[_0x3910ae(0x38c)]['unit'],this[_0x3910ae(0x38c)]);}};_0x2d665f=_0x44d088([_0x49f4d0(0x1,_0x161ac6[_0x4624f5(0x2b0)](_0x5b4c60[_0x4624f5(0x39a)])),_0x49f4d0(0x2,_0x161ac6['Inject'](_0x1508be)),_0x49f4d0(0x3,_0x161ac6[_0x4624f5(0x2b0)](_0x161ac6['ThemeService']))],_0x2d665f);function _0x22fbae(_0x165e1a){const _0x9686a1=_0x4624f5,_0x109777=new Map();return _0x165e1a[_0x9686a1(0x265)](_0x50bc15=>{const _0x1f5fb5=_0x9686a1;if(_0x109777[_0x1f5fb5(0x390)](_0x50bc15['selection'])){const _0x3a5512=_0x109777[_0x1f5fb5(0x333)](_0x50bc15['selection']);_0x3a5512[_0x1f5fb5(0x433)]+=',\x20'+_0x50bc15[_0x1f5fb5(0x433)];}else _0x109777['set'](_0x50bc15['selection'],_0x50bc15);}),Array['from'](_0x109777['values']());}var _0xb4bcb1=Object['getOwnPropertyDescriptor'],_0x1a32df=(_0x3b7189,_0x4ec178,_0x54e464,_0x3452de)=>{const _0x1b9732=_0x4624f5;for(var _0x6c02dd=_0x3452de>0x1?void 0x0:_0x3452de?_0xb4bcb1(_0x4ec178,_0x54e464):_0x4ec178,_0x33ae4a=_0x3b7189[_0x1b9732(0x1e5)]-0x1,_0x109921;_0x33ae4a>=0x0;_0x33ae4a--)(_0x109921=_0x3b7189[_0x33ae4a])&&(_0x6c02dd=_0x109921(_0x6c02dd)||_0x6c02dd);return _0x6c02dd;},_0x3aea0f=(_0x176467,_0x14e6b1)=>(_0x41191e,_0x5abc01)=>_0x14e6b1(_0x41191e,_0x5abc01,_0x176467);let _0x1a48d1=class extends _0x161ac6[_0x4624f5(0x482)]{constructor(_0x52e10a,_0x5558f8,_0x15aa9d,_0x445bb7,_0x30b562,_0x241f9f){const _0x2573ec=_0x4624f5;super(),this[_0x2573ec(0x2f5)]=_0x52e10a,this[_0x2573ec(0x346)]=_0x5558f8,this['_collaborationUIEventService']=_0x15aa9d,this[_0x2573ec(0x47b)]=_0x445bb7,this[_0x2573ec(0x3bd)]=_0x30b562,this[_0x2573ec(0x23c)]=_0x241f9f,this[_0x2573ec(0x3f1)](),this[_0x2573ec(0x413)]();}[_0x4624f5(0x3f1)](){const _0x5bba5e=_0x4624f5;this[_0x5bba5e(0x30f)](this[_0x5bba5e(0x2f5)]['registerBeforeClose'](()=>{const _0x5e4787=_0x5bba5e;if(this[_0x5e4787(0x346)][_0x5e4787(0x47c)]['size'])return this[_0x5e4787(0x23c)]['t'](_0x5e4787(0x1f9));}));}[_0x4624f5(0x413)](){const _0x58c133=_0x4624f5;this[_0x58c133(0x30f)](this[_0x58c133(0x449)][_0x58c133(0x3fa)][_0x58c133(0x26b)](_0x1285e4=>{const _0x16c244=_0x58c133;_0x1285e4['id']===_0x46104e[_0x16c244(0x334)]['OTHER_CLIENT_EDITING']&&this[_0x16c244(0x47b)][_0x16c244(0x27d)]({'type':_0x37af48[_0x16c244(0x366)][_0x16c244(0x241)],'content':this[_0x16c244(0x23c)]['t'](_0x16c244(0x1d1))}),_0x1285e4['id']===_0x46104e[_0x16c244(0x334)][_0x16c244(0x403)]&&this['_messageService'][_0x16c244(0x27d)]({'type':_0x37af48[_0x16c244(0x366)][_0x16c244(0x241)],'content':this[_0x16c244(0x23c)]['t'](_0x16c244(0x436))}),_0x1285e4['id']===_0x46104e[_0x16c244(0x334)][_0x16c244(0x2a5)]&&this[_0x16c244(0x3bd)][_0x16c244(0x27d)]({'title':this[_0x16c244(0x23c)]['t'](_0x16c244(0x339)),'content':this['_localeService']['t']('permission.content'),'type':'error','duration':0x0}),_0x1285e4['id']===_0x46104e[_0x16c244(0x334)][_0x16c244(0x499)]&&this[_0x16c244(0x47b)][_0x16c244(0x27d)]({'type':_0x37af48[_0x16c244(0x366)][_0x16c244(0x368)],'content':this[_0x16c244(0x23c)]['t']('collaboration.closeRoom')+'('+_0x1285e4[_0x16c244(0x345)]+')'}),_0x1285e4['id']===_0x46104e[_0x16c244(0x334)][_0x16c244(0x2ce)]&&this[_0x16c244(0x47b)][_0x16c244(0x27d)]({'type':_0x37af48['MessageType'][_0x16c244(0x241)],'content':this[_0x16c244(0x23c)]['t'](_0x1285e4[_0x16c244(0x345)]||'')}),_0x1285e4['id']===_0x46104e['CollaborationUIEventId'][_0x16c244(0x1f0)]&&this[_0x16c244(0x47b)]['show']({'type':_0x37af48[_0x16c244(0x366)][_0x16c244(0x241)],'content':this['_localeService']['t']('session.will-retry')}),_0x1285e4['id']===_0x46104e[_0x16c244(0x334)][_0x16c244(0x2b6)]&&this[_0x16c244(0x47b)][_0x16c244(0x27d)]({'type':_0x37af48['MessageType'][_0x16c244(0x368)],'content':this['_localeService']['t'](_0x16c244(0x46d))}),_0x1285e4['id']===_0x46104e[_0x16c244(0x334)][_0x16c244(0x342)]&&this['_messageService'][_0x16c244(0x27d)]({'type':_0x37af48[_0x16c244(0x366)][_0x16c244(0x368)],'content':this[_0x16c244(0x23c)]['t'](_0x16c244(0x22a))});}));}};_0x1a48d1=_0x1a32df([_0x3aea0f(0x0,_0x4291c6[_0x4624f5(0x234)]),_0x3aea0f(0x1,_0x46104e['ILocalCacheService']),_0x3aea0f(0x2,_0x161ac6[_0x4624f5(0x2b0)](_0x46104e[_0x4624f5(0x421)])),_0x3aea0f(0x3,_0x4291c6['IMessageService']),_0x3aea0f(0x4,_0x4291c6[_0x4624f5(0x2be)]),_0x3aea0f(0x5,_0x161ac6[_0x4624f5(0x2b0)](_0x161ac6['LocaleService']))],_0x1a48d1);const _0x2f76a0=_0x4624f5(0x2ca),_0xbf724b={};var _0x525560=Object[_0x4624f5(0x272)],_0x39ab76=(_0x1099bf,_0x3b7e14,_0x4d5bdd,_0x40b79a)=>{const _0x20f698=_0x4624f5;for(var _0x5cf551=_0x40b79a>0x1?void 0x0:_0x40b79a?_0x525560(_0x3b7e14,_0x4d5bdd):_0x3b7e14,_0xb6897=_0x1099bf[_0x20f698(0x1e5)]-0x1,_0x46af3b;_0xb6897>=0x0;_0xb6897--)(_0x46af3b=_0x1099bf[_0xb6897])&&(_0x5cf551=_0x46af3b(_0x5cf551)||_0x5cf551);return _0x5cf551;},_0x345a26=(_0x5e6075,_0x4b3678)=>(_0xd65cf4,_0x10d20e)=>_0x4b3678(_0xd65cf4,_0x10d20e,_0x5e6075);let _0x6698d6=class{constructor(_0x36c676,_0x3e4712){const _0x151b0e=_0x4624f5;this[_0x151b0e(0x27c)]=_0x36c676,this[_0x151b0e(0x338)]=_0x3e4712;}['transformIMECache'](_0x3dbc5e){const _0x558447=_0x4624f5;this[_0x558447(0x3bf)](_0x3dbc5e),this[_0x558447(0x394)](_0x3dbc5e);}[_0x4624f5(0x3c2)](_0x141025){const _0xe14221=_0x4624f5,{unitID:_0x3365e2}=_0x141025,_0x486c6c=this['_renderManagerService'][_0xe14221(0x1ed)](_0x3365e2)[_0xe14221(0x287)](_0x5d4e8b[_0xe14221(0x32b)]),{redoCache:_0x502a16}=_0x486c6c['getUndoRedoMutationParamsCache']();if(_0x502a16['length']===0x0)return _0x141025;let _0x53d5a0=_0x161ac6[_0xe14221(0x460)]['deepClone'](_0x141025[_0xe14221(0x35d)][0x0]);for(let _0x3ee009=0x0;_0x3ee009<_0x502a16[_0xe14221(0x1e5)];_0x3ee009++){const _0x4a64c5={'id':_0xe14221(0x25b),'params':{..._0x502a16[_0x3ee009]}},_0x115a32=this[_0xe14221(0x27c)][_0xe14221(0x3d7)](_0x53d5a0,_0x4a64c5,!0x1);if(_0x48fdef[_0xe14221(0x32e)](_0x115a32))throw _0x115a32[_0xe14221(0x3ff)];_0x53d5a0=_0x115a32[_0xe14221(0x494)];}return{..._0x161ac6[_0xe14221(0x460)][_0xe14221(0x2d8)](_0x141025),'mutations':[_0x53d5a0]};}[_0x4624f5(0x3bf)](_0x11433d){const _0x1cfbe0=_0x4624f5,{unitID:_0x14d498}=_0x11433d,_0x2b9811=this[_0x1cfbe0(0x338)][_0x1cfbe0(0x1ed)](_0x14d498)[_0x1cfbe0(0x287)](_0x5d4e8b[_0x1cfbe0(0x32b)]),{undoCache:_0x394620,redoCache:_0xb3b2ff}=_0x2b9811[_0x1cfbe0(0x302)]();if(_0x394620[_0x1cfbe0(0x1e5)]===0x0||_0xb3b2ff['length']===0x0)return;const _0x43d85d=[],_0x5318e7=[];let _0x1948f3=_0x161ac6['Tools'][_0x1cfbe0(0x2d8)](_0x11433d['mutations'][0x0]),_0x39e7f7=_0x161ac6[_0x1cfbe0(0x460)][_0x1cfbe0(0x2d8)](_0x11433d[_0x1cfbe0(0x35d)][0x0]);for(let _0xde89e2=_0x394620[_0x1cfbe0(0x1e5)]-0x1;_0xde89e2>=0x0;_0xde89e2--){const _0x30ab9e={'id':_0x1cfbe0(0x25b),'params':{..._0x394620[_0xde89e2]}},_0x50efd7={'id':_0x1cfbe0(0x25b),'params':{..._0xb3b2ff[_0xde89e2]}},_0x5c9ce8=this['_transformService'][_0x1cfbe0(0x3d7)](_0x1948f3,_0x30ab9e,!0x1),_0xaadcab=this[_0x1cfbe0(0x27c)][_0x1cfbe0(0x3d7)](_0x39e7f7,_0x50efd7,!0x1);if(_0x48fdef['isTransformMutationFailure'](_0x5c9ce8))throw _0x5c9ce8[_0x1cfbe0(0x3ff)];if(_0x48fdef[_0x1cfbe0(0x32e)](_0xaadcab))throw _0xaadcab[_0x1cfbe0(0x3ff)];_0x43d85d[_0x1cfbe0(0x1f2)](_0x5c9ce8['m2Prime'][_0x1cfbe0(0x276)]),_0x5318e7[_0x1cfbe0(0x1f2)](_0xaadcab[_0x1cfbe0(0x397)][_0x1cfbe0(0x276)]),_0x1948f3=_0x5c9ce8[_0x1cfbe0(0x494)],_0x39e7f7=_0xaadcab['m1Prime'];}_0x2b9811['setUndoRedoMutationParamsCache']({'undoCache':_0x43d85d,'redoCache':_0x5318e7});}[_0x4624f5(0x394)](_0x483508){const _0x23aed7=_0x4624f5,{unitID:_0x582c3f}=_0x483508,_0x1d7e1c=this['_renderManagerService']['getRenderById'](_0x582c3f)[_0x23aed7(0x287)](_0x5d4e8b[_0x23aed7(0x32b)]),_0x18f0b4=_0x1d7e1c[_0x23aed7(0x3a6)]();if(_0x18f0b4==null)return;const _0x958197=[{'id':_0x23aed7(0x25b),'params':{'unitId':_0x483508[_0x23aed7(0x2e9)],'actions':null,'textRanges':[_0x18f0b4]}}],_0x4b42be=this[_0x23aed7(0x27c)][_0x23aed7(0x2bb)](_0x483508,_0x958197);if(!_0x48fdef[_0x23aed7(0x245)](_0x4b42be))throw _0x4b42be[_0x23aed7(0x3ff)];const _0x5ccda8=_0x4b42be[_0x23aed7(0x397)][0x0][_0x23aed7(0x276)][_0x23aed7(0x3c5)];Array[_0x23aed7(0x462)](_0x5ccda8)&&_0x5ccda8[_0x23aed7(0x1e5)]&&_0x1d7e1c['setActiveRange'](_0x5ccda8[0x0]);}};_0x6698d6=_0x39ab76([_0x345a26(0x0,_0x48fdef['ITransformService']),_0x345a26(0x1,_0x1fade8[_0x4624f5(0x383)])],_0x6698d6);var _0xe85881=Object[_0x4624f5(0x272)],_0x20e6bb=(_0x283a50,_0x57ab02,_0x3bd32a,_0x2a9cac)=>{const _0x11942a=_0x4624f5;for(var _0x4eac68=_0x2a9cac>0x1?void 0x0:_0x2a9cac?_0xe85881(_0x57ab02,_0x3bd32a):_0x57ab02,_0x5850a2=_0x283a50[_0x11942a(0x1e5)]-0x1,_0x36852f;_0x5850a2>=0x0;_0x5850a2--)(_0x36852f=_0x283a50[_0x5850a2])&&(_0x4eac68=_0x36852f(_0x4eac68)||_0x4eac68);return _0x4eac68;},_0x5e50d1=(_0x11388c,_0x4da7e3)=>(_0x59d4f4,_0x18ad08)=>_0x4da7e3(_0x59d4f4,_0x18ad08,_0x11388c);let _0xa7a54c=class{constructor(_0x7f556b,_0x1af56e,_0x2ee72d){const _0x3af573=_0x4624f5;this[_0x3af573(0x298)]=_0x7f556b,this[_0x3af573(0x27c)]=_0x1af56e,this[_0x3af573(0x22e)]=_0x2ee72d;}[_0x4624f5(0x307)](_0x1aaee7){const _0x93433d=_0x4624f5;this[_0x93433d(0x3c1)](_0x1aaee7);}[_0x4624f5(0x3c2)](_0x1053a4){const _0x3043a3=_0x4624f5,{unitID:_0x270535}=_0x1053a4,{collaboration:_0x39335c}=this[_0x3043a3(0x22e)][_0x3043a3(0x39e)](_0x270535);if(_0x39335c[_0x3043a3(0x1e5)]===0x0)return _0x1053a4;let _0x340834=_0x161ac6[_0x3043a3(0x460)][_0x3043a3(0x2d8)](_0x1053a4[_0x3043a3(0x35d)][0x0]);for(let _0x42ea20=0x0;_0x42ea20<_0x39335c['length'];_0x42ea20++){const _0x40ca5e={'id':_0x3043a3(0x25b),'params':{'unitId':_0x39335c[_0x42ea20]['unitId'],..._0x39335c[_0x42ea20][_0x3043a3(0x4a1)]}},_0x1c19af=this[_0x3043a3(0x27c)][_0x3043a3(0x3d7)](_0x340834,_0x40ca5e,!0x1);if(_0x48fdef[_0x3043a3(0x32e)](_0x1c19af))throw _0x1c19af[_0x3043a3(0x3ff)];_0x340834=_0x1c19af['m1Prime'];}return{..._0x161ac6['Tools'][_0x3043a3(0x2d8)](_0x1053a4),'mutations':[_0x340834]};}[_0x4624f5(0x3c1)](_0x1de933){const _0x4d3d5b=_0x4624f5,{unitID:_0x1e54c7}=_0x1de933,{history:_0x33ebd3,collaboration:_0x197a05}=this[_0x4d3d5b(0x22e)][_0x4d3d5b(0x39e)](_0x1e54c7);if(_0x33ebd3[_0x4d3d5b(0x1e5)]===0x0&&_0x197a05[_0x4d3d5b(0x1e5)]===0x0)return;const _0x4fdf63=[],_0x1d6504=[];let _0x24483f=_0x161ac6[_0x4d3d5b(0x460)][_0x4d3d5b(0x2d8)](_0x1de933[_0x4d3d5b(0x35d)][0x0]),_0x1d48d6=_0x161ac6[_0x4d3d5b(0x460)][_0x4d3d5b(0x2d8)](_0x1de933[_0x4d3d5b(0x35d)][0x0]);for(let _0x30bf00=_0x33ebd3['length']-0x1;_0x30bf00>=0x0;_0x30bf00--){const _0x240579={'id':_0x4d3d5b(0x25b),'params':{'unitId':_0x33ebd3[_0x30bf00][_0x4d3d5b(0x470)],..._0x33ebd3[_0x30bf00]['undoState']}},_0x17607b={'id':_0x4d3d5b(0x25b),'params':{'unitId':_0x33ebd3[_0x30bf00][_0x4d3d5b(0x470)],..._0x33ebd3[_0x30bf00][_0x4d3d5b(0x4a1)]}},_0x462534=this[_0x4d3d5b(0x27c)][_0x4d3d5b(0x3d7)](_0x24483f,_0x240579,!0x1),_0x27c7fb=this[_0x4d3d5b(0x27c)][_0x4d3d5b(0x3d7)](_0x1d48d6,_0x17607b,!0x1);if(_0x48fdef[_0x4d3d5b(0x32e)](_0x462534))throw _0x462534[_0x4d3d5b(0x3ff)];if(_0x48fdef[_0x4d3d5b(0x32e)](_0x27c7fb))throw _0x27c7fb['error'];_0x4fdf63['unshift']({..._0x33ebd3[_0x30bf00],'undoState':_0x462534[_0x4d3d5b(0x397)][_0x4d3d5b(0x276)],'redoState':_0x27c7fb['m2Prime'][_0x4d3d5b(0x276)]}),_0x24483f=_0x462534[_0x4d3d5b(0x494)],_0x1d48d6=_0x27c7fb['m1Prime'];}_0x24483f=_0x161ac6[_0x4d3d5b(0x460)][_0x4d3d5b(0x2d8)](_0x1de933[_0x4d3d5b(0x35d)][0x0]),_0x1d48d6=_0x161ac6['Tools'][_0x4d3d5b(0x2d8)](_0x1de933['mutations'][0x0]);for(let _0x20eb2d=_0x197a05[_0x4d3d5b(0x1e5)]-0x1;_0x20eb2d>=0x0;_0x20eb2d--){const _0x2ac1b8={'id':_0x4d3d5b(0x25b),'params':{'unitId':_0x197a05[_0x20eb2d][_0x4d3d5b(0x470)],..._0x197a05[_0x20eb2d][_0x4d3d5b(0x20e)]}},_0x2653b7={'id':_0x4d3d5b(0x25b),'params':{'unitId':_0x197a05[_0x20eb2d][_0x4d3d5b(0x470)],..._0x197a05[_0x20eb2d][_0x4d3d5b(0x4a1)]}},_0x5a45e0=this[_0x4d3d5b(0x27c)][_0x4d3d5b(0x3d7)](_0x24483f,_0x2ac1b8,!0x1),_0x446a2d=this[_0x4d3d5b(0x27c)][_0x4d3d5b(0x3d7)](_0x1d48d6,_0x2653b7,!0x1);if(_0x48fdef['isTransformMutationFailure'](_0x5a45e0))throw _0x5a45e0[_0x4d3d5b(0x3ff)];if(_0x48fdef[_0x4d3d5b(0x32e)](_0x446a2d))throw _0x446a2d[_0x4d3d5b(0x3ff)];_0x1d6504[_0x4d3d5b(0x1f2)]({..._0x197a05[_0x20eb2d],'undoState':_0x5a45e0['m2Prime'][_0x4d3d5b(0x276)],'redoState':_0x446a2d[_0x4d3d5b(0x397)][_0x4d3d5b(0x276)]}),_0x24483f=_0x5a45e0[_0x4d3d5b(0x494)],_0x1d48d6=_0x446a2d[_0x4d3d5b(0x494)];}this[_0x4d3d5b(0x22e)][_0x4d3d5b(0x207)](_0x1e54c7,{'history':_0x4fdf63,'collaboration':_0x1d6504});}};_0xa7a54c=_0x20e6bb([_0x5e50d1(0x0,_0x161ac6[_0x4624f5(0x2b0)](_0x161ac6[_0x4624f5(0x2c2)])),_0x5e50d1(0x1,_0x48fdef[_0x4624f5(0x254)]),_0x5e50d1(0x2,_0x161ac6[_0x4624f5(0x2b0)](_0x5d4e8b[_0x4624f5(0x3f0)]))],_0xa7a54c);var _0x57ad3c=Object[_0x4624f5(0x272)],_0x42e18e=(_0x30091c,_0x3f8d4e,_0x5e41f2,_0x165eb7)=>{const _0x1407cc=_0x4624f5;for(var _0x44becc=_0x165eb7>0x1?void 0x0:_0x165eb7?_0x57ad3c(_0x3f8d4e,_0x5e41f2):_0x3f8d4e,_0x3c2778=_0x30091c[_0x1407cc(0x1e5)]-0x1,_0xcae1a;_0x3c2778>=0x0;_0x3c2778--)(_0xcae1a=_0x30091c[_0x3c2778])&&(_0x44becc=_0xcae1a(_0x44becc)||_0x44becc);return _0x44becc;},_0x3e339d=(_0x14fe80,_0x578ed5)=>(_0x1a9d2d,_0x47fe78)=>_0x578ed5(_0x1a9d2d,_0x47fe78,_0x14fe80);let _0x16e8f2=class{constructor(_0x4d088f,_0x24c689){this['_injector']=_0x4d088f,this['_transformService']=_0x24c689;}['transformSelections'](_0x561d0f){const _0xafd62=_0x4624f5;var _0x478b5d;const _0xf6ec35=this[_0xafd62(0x298)][_0xafd62(0x333)](_0x4db13e[_0xafd62(0x3c7)]),_0x2205ed=(_0x478b5d=_0xf6ec35[_0xafd62(0x2ae)]())!=null?_0x478b5d:[];if(_0x2205ed[_0xafd62(0x1e5)]===0x0)return;const _0x44c61e=_0x561d0f[_0xafd62(0x2e9)],_0x3a8dbf=[{'id':_0xafd62(0x25b),'params':{'unitId':_0x44c61e,'actions':null,'textRanges':_0x2205ed}}],_0x2063bb=this['_transformService']['transformMutationsWithChangeset'](_0x561d0f,_0x3a8dbf);if(!_0x48fdef['isTransformMutationsWithChangesetSuccess'](_0x2063bb))throw _0x2063bb[_0xafd62(0x3ff)];const _0x127821=_0x2063bb['m2Prime'][0x0][_0xafd62(0x276)][_0xafd62(0x3c5)];Array['isArray'](_0x127821)&&_0x127821['length']&&_0xf6ec35[_0xafd62(0x2b8)](_0x127821,{'unitId':_0x44c61e,'subUnitId':_0x44c61e},!0x1);}};_0x16e8f2=_0x42e18e([_0x3e339d(0x0,_0x161ac6[_0x4624f5(0x2b0)](_0x161ac6[_0x4624f5(0x2c2)])),_0x3e339d(0x1,_0x48fdef['ITransformService'])],_0x16e8f2);var _0x51fbdb=Object[_0x4624f5(0x272)],_0x485991=(_0x5b2727,_0x12d06e,_0x56d4d4,_0x5a2083)=>{for(var _0x5e01b0=_0x5a2083>0x1?void 0x0:_0x5a2083?_0x51fbdb(_0x12d06e,_0x56d4d4):_0x12d06e,_0x2024d9=_0x5b2727['length']-0x1,_0x587b4a;_0x2024d9>=0x0;_0x2024d9--)(_0x587b4a=_0x5b2727[_0x2024d9])&&(_0x5e01b0=_0x587b4a(_0x5e01b0)||_0x5e01b0);return _0x5e01b0;},_0xb392fd=(_0x2ba211,_0x2aba97)=>(_0x45d113,_0x582c43)=>_0x2aba97(_0x45d113,_0x582c43,_0x2ba211);let _0x41f840=class extends _0x161ac6[_0x4624f5(0x482)]{constructor(_0x3155a2,_0x5739f4,_0x407101,_0x43c9c1,_0x22486e,_0x4f5593,_0x139f99,_0x1b07de){const _0x124180=_0x4624f5;super(),_0x47bfcc(this,_0x124180(0x3e7),new _0x66cc31[(_0x124180(0x41e))](_0x46104e['CollaborationStatus']['NOT_COLLAB'])),(this[_0x124180(0x22e)]=_0x3155a2,this[_0x124180(0x2c0)]=_0x5739f4,this['_docTransformIMECacheService']=_0x407101,this['_docTransformStateCacheService']=_0x43c9c1,this[_0x124180(0x1df)]=_0x22486e,this[_0x124180(0x2eb)]=_0x4f5593,this[_0x124180(0x47b)]=_0x139f99,this[_0x124180(0x23c)]=_0x1b07de,this[_0x124180(0x21d)]());}[_0x4624f5(0x21d)](){const _0x4fe9e4=_0x4624f5;this[_0x4fe9e4(0x30f)](this[_0x4fe9e4(0x2c0)][_0x4fe9e4(0x43c)][_0x4fe9e4(0x26b)](_0x5531b7=>{const _0x1049b=_0x4fe9e4,_0x243c49=this['_docStateChangeManagerService'][_0x1049b(0x2fa)]['subscribe'](_0x1e31c9=>{const _0x3cf30c=_0x1049b;if(_0x1e31c9==null)return;const {unitId:_0x1c2a68,redoState:_0x2d92c6,commandId:_0x29b2bc}=_0x1e31c9;if(_0x1c2a68!==_0x5531b7['unitID'])return;const _0x1665c8={'id':_0x29b2bc,'type':_0x161ac6[_0x3cf30c(0x367)]['MUTATION'],'params':{'unitId':_0x1c2a68,'actions':_0x2d92c6[_0x3cf30c(0x31c)],'textRanges':null}};_0x5531b7['onLocalMutation'](_0x1665c8);});if(_0x5531b7[_0x1049b(0x30f)](_0x243c49),_0x5531b7 instanceof _0x46104e[_0x1049b(0x465)]){const _0x1b75b4={'onTransformIME':_0xf94ca=>this[_0x1049b(0x3d4)]['transformIMECache'](_0xf94ca),'onTransformState':_0xc0a988=>this[_0x1049b(0x3d3)]['transformStateCache'](_0xc0a988),'onTransformSelections':_0x1ba053=>this[_0x1049b(0x1df)][_0x1049b(0x297)](_0x1ba053),'onSyncEditingCollabCursor':_0x3f76d3=>this[_0x1049b(0x2eb)][_0x1049b(0x26c)](_0x3f76d3),'onTransformRemoteChangesetByIMECache':_0x4b6beb=>this['_docTransformIMECacheService'][_0x1049b(0x3c2)](_0x4b6beb),'onTransformRemoteChangesetByStateCache':_0x1604a9=>this[_0x1049b(0x3d3)][_0x1049b(0x3c2)](_0x1604a9)};_0x5531b7[_0x1049b(0x1e3)](_0x1b75b4);}}));}};_0x41f840=_0x485991([_0xb392fd(0x0,_0x161ac6[_0x4624f5(0x2b0)](_0x5d4e8b[_0x4624f5(0x3f0)])),_0xb392fd(0x1,_0x161ac6[_0x4624f5(0x2b0)](_0x46104e[_0x4624f5(0x23f)])),_0xb392fd(0x2,_0x161ac6[_0x4624f5(0x2b0)](_0x6698d6)),_0xb392fd(0x3,_0x161ac6[_0x4624f5(0x2b0)](_0xa7a54c)),_0xb392fd(0x4,_0x161ac6[_0x4624f5(0x2b0)](_0x16e8f2)),_0xb392fd(0x5,_0x161ac6[_0x4624f5(0x2b0)](_0x360498)),_0xb392fd(0x6,_0x4291c6['IMessageService']),_0xb392fd(0x7,_0x161ac6[_0x4624f5(0x2b0)](_0x161ac6['LocaleService']))],_0x41f840);var _0x5a1443=(_0x5ceda4=>(_0x5ceda4[_0x5ceda4[_0x4624f5(0x451)]=0x0]=_0x4624f5(0x451),_0x5ceda4[_0x5ceda4['OK']=0x1]='OK',_0x5ceda4[_0x5ceda4['INTERNAL_ERROR']=0x2]=_0x4624f5(0x313),_0x5ceda4[_0x5ceda4[_0x4624f5(0x2a5)]=0x3]=_0x4624f5(0x2a5),_0x5ceda4[_0x5ceda4['NOT_FOUND']=0x4]=_0x4624f5(0x47e),_0x5ceda4[_0x5ceda4[_0x4624f5(0x1d0)]=0x5]='UNAUTHENTICATED',_0x5ceda4[_0x5ceda4[_0x4624f5(0x364)]=0x6]='ALREADY_EXISTS',_0x5ceda4[_0x5ceda4[_0x4624f5(0x259)]=0x7]=_0x4624f5(0x259),_0x5ceda4[_0x5ceda4['TOO_MANY_REQUESTS']=0x8]=_0x4624f5(0x308),_0x5ceda4[_0x5ceda4['COMPLETION_FINISHED']=0x9]=_0x4624f5(0x2b4),_0x5ceda4[_0x5ceda4[_0x4624f5(0x2ac)]=0xa]=_0x4624f5(0x2ac),_0x5ceda4[_0x5ceda4['MOBILE_VERIFY_CODE_MISMATCH']=0xb]=_0x4624f5(0x3b1),_0x5ceda4[_0x5ceda4[_0x4624f5(0x30e)]=0xc]=_0x4624f5(0x30e),_0x5ceda4[_0x5ceda4['EMAIL_VERIFY_CODE_MISMATCH']=0xd]=_0x4624f5(0x375),_0x5ceda4[_0x5ceda4[_0x4624f5(0x1e4)]=0xe]=_0x4624f5(0x1e4),_0x5ceda4[_0x5ceda4[_0x4624f5(0x40f)]=0xf]=_0x4624f5(0x40f),_0x5ceda4[_0x5ceda4[_0x4624f5(0x267)]=0x10]=_0x4624f5(0x267),_0x5ceda4[_0x5ceda4['CURRENT_STATUS_CANNOT_OPERATE']=0x64]=_0x4624f5(0x439),_0x5ceda4[_0x5ceda4[_0x4624f5(0x200)]=0x65]=_0x4624f5(0x200),_0x5ceda4[_0x5ceda4[_0x4624f5(0x3b3)]=0xc9]=_0x4624f5(0x3b3),_0x5ceda4[_0x5ceda4['USER_IS_ANONYMOUS']=0xca]='USER_IS_ANONYMOUS',_0x5ceda4[_0x5ceda4['CHANGESET_REVISION_CONFILICT']=0x1389]='CHANGESET_REVISION_CONFILICT',_0x5ceda4[_0x5ceda4[_0x4624f5(0x2f1)]=0x1771]=_0x4624f5(0x2f1),_0x5ceda4[_0x5ceda4[_0x4624f5(0x4a0)]=0x1772]='SNAPSHOT_HAS_BEEN_REMOVED',_0x5ceda4[_0x5ceda4[_0x4624f5(0x32a)]=0x1773]='ENSURE_SNAPSHOT_EXECUTION',_0x5ceda4[_0x5ceda4[_0x4624f5(0x22d)]=0x1b59]=_0x4624f5(0x22d),_0x5ceda4[_0x5ceda4[_0x4624f5(0x39b)]=0x1b5a]=_0x4624f5(0x39b),_0x5ceda4[_0x5ceda4[_0x4624f5(0x365)]=0x1b5b]=_0x4624f5(0x365),_0x5ceda4[_0x5ceda4[_0x4624f5(0x2df)]=0x1b5c]='APPLY_PERMISSION_DENIED',_0x5ceda4[_0x5ceda4[_0x4624f5(0x21f)]=0x1b5d]='APPLY_DUPLICATED',_0x5ceda4[_0x5ceda4['CONNECTOR_DATA_TOO_LARGE']=0x1f41]=_0x4624f5(0x2ed),_0x5ceda4[_0x5ceda4[_0x4624f5(0x1e7)]=0x2329]=_0x4624f5(0x1e7),_0x5ceda4[_0x5ceda4['LICENSE_MAX_MEMBERS_PER_UNIT_EXCEEDED']=0x232a]=_0x4624f5(0x46e),_0x5ceda4[_0x5ceda4['LICENSE_IMPORT_SIZE_EXCEEDED']=0x232b]=_0x4624f5(0x248),_0x5ceda4[_0x5ceda4['LICENSE_EXPORT_SIZE_EXCEEDED']=0x232c]=_0x4624f5(0x20f),_0x5ceda4[_0x5ceda4['LICENSE_DISTRO_REJECTED']=0x232d]=_0x4624f5(0x347),_0x5ceda4[_0x5ceda4[_0x4624f5(0x2d6)]=0x2711]=_0x4624f5(0x2d6),_0x5ceda4[_0x5ceda4[_0x4624f5(0x257)]=0x2712]=_0x4624f5(0x257),_0x5ceda4[_0x5ceda4[_0x4624f5(0x3ca)]=0x2713]=_0x4624f5(0x3ca),_0x5ceda4[_0x5ceda4[_0x4624f5(0x1f1)]=0x2714]='YUUMI_SUBSCRIPTION_NOT_FOUND',_0x5ceda4[_0x5ceda4[_0x4624f5(0x235)]=0x271a]=_0x4624f5(0x235),_0x5ceda4[_0x5ceda4[_0x4624f5(0x1cf)]=0x271b]=_0x4624f5(0x1cf),_0x5ceda4[_0x5ceda4[_0x4624f5(0x291)]=0x271c]=_0x4624f5(0x291),_0x5ceda4[_0x5ceda4[_0x4624f5(0x2ad)]=0x271d]=_0x4624f5(0x2ad),_0x5ceda4[_0x5ceda4[_0x4624f5(0x262)]=0x271e]='YUUMI_PROMPT_MAX_TOKENS_EXCEEDED',_0x5ceda4[_0x5ceda4['YUUMI_AI_RUN_FAILED']=0x271f]='YUUMI_AI_RUN_FAILED',_0x5ceda4[_0x5ceda4[_0x4624f5(0x2e4)]=0x2720]=_0x4624f5(0x2e4),_0x5ceda4[_0x5ceda4[_0x4624f5(0x473)]=0x2af9]=_0x4624f5(0x473),_0x5ceda4[_0x5ceda4[_0x4624f5(0x229)]=0x2ee1]='INVITE_CODE_HAS_BEEN_UES',_0x5ceda4[_0x5ceda4['INVALID_INVITE_CODE']=0x2ee2]='INVALID_INVITE_CODE',_0x5ceda4[_0x5ceda4[_0x4624f5(0x2a3)]=0x2ee3]=_0x4624f5(0x2a3),_0x5ceda4[_0x5ceda4['USER_NOT_INVITED_CODE']=0x2ee4]='USER_NOT_INVITED_CODE',_0x5ceda4[_0x5ceda4[_0x4624f5(0x2fb)]=0x2ee5]=_0x4624f5(0x2fb),_0x5ceda4[_0x5ceda4['WECHAT_HAS_BEEN_BOUND']=0x32c9]=_0x4624f5(0x2c1),_0x5ceda4[_0x5ceda4[_0x4624f5(0x277)]=0x32ca]=_0x4624f5(0x277),_0x5ceda4[_0x5ceda4['EMAIL_HAS_BEEN_BOUND']=0x32cb]='EMAIL_HAS_BEEN_BOUND',_0x5ceda4[_0x5ceda4['ENTITLE_CAN_NOT_BUY_LOWER_OTP']=0x36b1]=_0x4624f5(0x2ea),_0x5ceda4[_0x5ceda4[_0x4624f5(0x1ee)]=0x36b2]=_0x4624f5(0x1ee),_0x5ceda4[_0x5ceda4[_0x4624f5(0x1de)]=0x36b3]=_0x4624f5(0x1de),_0x5ceda4[_0x5ceda4[_0x4624f5(0x3b7)]=0x36b4]=_0x4624f5(0x3b7),_0x5ceda4[_0x5ceda4[_0x4624f5(0x3e6)]=0x3715]=_0x4624f5(0x3e6),_0x5ceda4[_0x5ceda4[_0x4624f5(0x2f9)]=0x3716]=_0x4624f5(0x2f9),_0x5ceda4[_0x5ceda4[_0x4624f5(0x385)]=0x3717]=_0x4624f5(0x385),_0x5ceda4[_0x5ceda4[_0x4624f5(0x369)]=0x37dd]=_0x4624f5(0x369),_0x5ceda4[_0x5ceda4[_0x4624f5(0x232)]=0x3a99]=_0x4624f5(0x232),_0x5ceda4[_0x5ceda4[_0x4624f5(0x3f7)]=0x3a9a]=_0x4624f5(0x3f7),_0x5ceda4[_0x5ceda4[_0x4624f5(0x41c)]=0x3a9b]=_0x4624f5(0x41c),_0x5ceda4[_0x5ceda4[_0x4624f5(0x268)]=0x3a9c]=_0x4624f5(0x268),_0x5ceda4[_0x5ceda4['REDEMPTION_USER_NOT_ELIGIBLE']=0x3a9d]=_0x4624f5(0x388),_0x5ceda4[_0x5ceda4[_0x4624f5(0x423)]=0x3a9e]='REDEMPTION_USER_REDEEM_TIMES_EXCEED',_0x5ceda4[_0x5ceda4[_0x4624f5(0x336)]=0x3a9f]='REDEMPTION_CODE_HAS_BEEN_CREATED',_0x5ceda4[_0x5ceda4['DATA_SOURCE_TOO_LARGE']=0x3e81]=_0x4624f5(0x29e),_0x5ceda4[_0x5ceda4['UNRECOGNIZED']=-0x1]='UNRECOGNIZED',_0x5ceda4))(_0x5a1443||{});function _0x5b982b(_0x29df05){const _0x345493=_0x4624f5;var _0x45588c,_0x970d53;const _0x1f327b=(_0x45588c=_0x29df05[_0x345493(0x42a)])==null?void 0x0:_0x45588c[_0x345493(0x3bb)],_0x2c4028=((_0x970d53=_0x29df05[_0x345493(0x42a)])==null?void 0x0:_0x970d53[_0x345493(0x42b)])||0x0;return _0x1f327b===_0x50020c[_0x345493(0x416)][_0x345493(0x41d)]&&_0x2c4028>0x0;}function _0x2088f2(_0x2ce4d7){const _0x2abe2c=_0x4624f5;return _0x2ce4d7['functionsExecutedState']===_0x50020c[_0x2abe2c(0x3c4)][_0x2abe2c(0x44d)];}var _0x2ac3f3=Object['getOwnPropertyDescriptor'],_0x4d9d48=(_0x1a34ef,_0x341851,_0x3aa090,_0x50e4e7)=>{const _0x24d6a4=_0x4624f5;for(var _0x42d82f=_0x50e4e7>0x1?void 0x0:_0x50e4e7?_0x2ac3f3(_0x341851,_0x3aa090):_0x341851,_0x3e055d=_0x1a34ef[_0x24d6a4(0x1e5)]-0x1,_0x207251;_0x3e055d>=0x0;_0x3e055d--)(_0x207251=_0x1a34ef[_0x3e055d])&&(_0x42d82f=_0x207251(_0x42d82f)||_0x42d82f);return _0x42d82f;},_0x18dac4=(_0x2ce19b,_0x2476ef)=>(_0x245232,_0x10710c)=>_0x2476ef(_0x245232,_0x10710c,_0x2ce19b);const _0x3f8613='/universer-api/license/formula/limit/status',_0x446ba0=_0x4624f5(0x299),_0x14fb45=_0x4624f5(0x392);let _0x35cb3d=class extends _0x161ac6[_0x4624f5(0x482)]{constructor(_0x58b5e9,_0x2d38f9,_0x2dad49,_0x1610d,_0x12a469,_0x4a1ef0,_0x2b95d1){const _0xfff95b=_0x4624f5;super(),_0x47bfcc(this,_0xfff95b(0x44f),null),_0x47bfcc(this,_0xfff95b(0x320),0x0),_0x47bfcc(this,_0xfff95b(0x3c3),0x0),_0x47bfcc(this,_0xfff95b(0x3f3),[]),_0x47bfcc(this,_0xfff95b(0x389),0x0),(this[_0xfff95b(0x47b)]=_0x58b5e9,this[_0xfff95b(0x43a)]=_0x2d38f9,this[_0xfff95b(0x415)]=_0x2dad49,this[_0xfff95b(0x373)]=_0x1610d,this[_0xfff95b(0x485)]=_0x12a469,this[_0xfff95b(0x3a2)]=_0x4a1ef0,this[_0xfff95b(0x23c)]=_0x2b95d1,this[_0xfff95b(0x202)]());}[_0x4624f5(0x202)](){const _0x17e65a=_0x4624f5;this[_0x17e65a(0x30f)](this['_commandService'][_0x17e65a(0x355)]((_0x46da84,_0x3904e2)=>{const _0x548cd2=_0x17e65a;var _0x43c55a;if(_0x46da84['id']!==_0x50020c['SetFormulaCalculationStartMutation']['id'])return;const _0x40e99a=_0x46da84['params'];if(!this[_0x548cd2(0x24b)]((_0x43c55a=_0x40e99a[_0x548cd2(0x39c)])!=null?_0x43c55a:[]))return;if(!this[_0x548cd2(0x2af)]())throw this['_checkAndWaitForCalculationPermission'](_0x46da84,_0x3904e2),this[_0x548cd2(0x1ec)](),new _0x161ac6[(_0x548cd2(0x3e8))]();})),this[_0x17e65a(0x30f)](this[_0x17e65a(0x43a)][_0x17e65a(0x391)]((_0x11799f,_0x5c6828)=>{const _0x55ff92=_0x17e65a;if(_0x11799f['id']!==_0x50020c[_0x55ff92(0x1ce)]['id'])return;const _0x20c17e=_0x11799f[_0x55ff92(0x276)];if(_0x5b982b(_0x20c17e)){const _0x235f3a=_0x161ac6[_0x55ff92(0x497)]();this[_0x55ff92(0x3f3)]['push'](_0x235f3a),this[_0x55ff92(0x20d)](_0x235f3a);}else{if(_0x2088f2(_0x20c17e)&&this[_0x55ff92(0x3f3)][_0x55ff92(0x1e5)]>0x0){const _0x1f3da8=this[_0x55ff92(0x3f3)][_0x55ff92(0x35c)]();this[_0x55ff92(0x1d4)](_0x1f3da8);}}}));}[_0x4624f5(0x214)](){const _0x23ce92=_0x4624f5;super[_0x23ce92(0x214)](),this[_0x23ce92(0x3e9)](),this[_0x23ce92(0x3f3)]=[],this[_0x23ce92(0x3c3)]=0x0,this[_0x23ce92(0x320)]=0x0,this[_0x23ce92(0x389)]=0x0;}async[_0x4624f5(0x45f)](_0x101b15,_0x4c4502){const _0x69e3cd=_0x4624f5;for(let _0x1f82d6=0x0;_0x1f82d6<0x1e;_0x1f82d6++)try{if(await this[_0x69e3cd(0x459)](),this['_checkCalculationAvailable']()){this[_0x69e3cd(0x47a)](_0x101b15,_0x4c4502),this[_0x69e3cd(0x47b)][_0x69e3cd(0x27d)]({'content':this[_0x69e3cd(0x23c)]['t']('formula.calculation.started'),'type':_0x37af48[_0x69e3cd(0x366)][_0x69e3cd(0x292)]});return;}await new Promise(_0xc5a6ab=>{const _0x21d217=_0x69e3cd;this[_0x21d217(0x44f)]=window['setTimeout'](_0xc5a6ab,0x3e8);});}catch(_0x16db0a){this[_0x69e3cd(0x3a2)][_0x69e3cd(0x3ff)](_0x16db0a);}this[_0x69e3cd(0x47b)][_0x69e3cd(0x27d)]({'content':this[_0x69e3cd(0x23c)]['t']('formula.calculation.unable'),'type':_0x37af48[_0x69e3cd(0x366)][_0x69e3cd(0x368)]});}['_applyCommand'](_0x55cf87,_0x4620fa){const _0x531796=_0x4624f5;try{this[_0x531796(0x43a)][_0x531796(0x225)](_0x55cf87['id'],_0x55cf87[_0x531796(0x276)],_0x4620fa);}catch(_0x5b95c0){this[_0x531796(0x3a2)][_0x531796(0x3ff)](_0x5b95c0);}}[_0x4624f5(0x237)](_0x327078,_0x40d1be){const _0x43e82c=_0x4624f5;_0x40d1be<this[_0x43e82c(0x389)]||(this[_0x43e82c(0x389)]=_0x40d1be,this[_0x43e82c(0x320)]=Number[_0x43e82c(0x3ab)](_0x327078[_0x43e82c(0x2e7)]),this[_0x43e82c(0x3c3)]=Number['parseInt'](_0x327078['currentUsage']));}async[_0x4624f5(0x20d)](_0x4e5f43){const _0x4b7fe2=_0x4624f5;var _0x34fcc9,_0x5dd860;const _0x4a35a6=Date[_0x4b7fe2(0x480)]();try{const _0x3eaa02=((_0x34fcc9=this[_0x4b7fe2(0x415)]['getConfig'](_0x46104e['COLLABORATION_CLIENT_PLUGIN_CONFIG_KEY']))==null?void 0x0:_0x34fcc9[_0x4b7fe2(0x43f)])||_0x446ba0,_0x24ec91=(await this['_httpService']['post'](_0x3eaa02,{'body':JSON[_0x4b7fe2(0x3e3)]({'taskId':_0x4e5f43})}))['body'];if(((_0x5dd860=_0x24ec91['error'])==null?void 0x0:_0x5dd860[_0x4b7fe2(0x429)])!==_0x5a1443['OK'])return;this[_0x4b7fe2(0x237)](_0x24ec91[_0x4b7fe2(0x410)],_0x4a35a6);}catch(_0x29ceba){this['_logService'][_0x4b7fe2(0x3ff)](_0x29ceba);}}async[_0x4624f5(0x459)](_0x30eb24){const _0x23e231=_0x4624f5;var _0x376444,_0x3d42dc;const _0x1d2c48=Date['now']();try{const _0x348652=((_0x376444=this[_0x23e231(0x415)][_0x23e231(0x310)](_0x46104e[_0x23e231(0x33c)]))==null?void 0x0:_0x376444[_0x23e231(0x33b)])||_0x3f8613,_0x40014e=_0x30eb24?_0x348652+'?taskId='+encodeURIComponent(_0x30eb24):_0x348652,_0x1d04c7=(await this[_0x23e231(0x373)][_0x23e231(0x333)](_0x40014e))[_0x23e231(0x3d0)];if(((_0x3d42dc=_0x1d04c7[_0x23e231(0x3ff)])==null?void 0x0:_0x3d42dc['code'])!==_0x5a1443['OK'])return;this['_setFormulaLimitStatus'](_0x1d04c7[_0x23e231(0x410)],_0x1d2c48);}catch(_0x308174){this[_0x23e231(0x3a2)]['error'](_0x308174);}}async['_releaseCalculationLimit'](_0x51cea0){const _0x348fd5=_0x4624f5;var _0x3ad1c9,_0x2f7f0a;const _0x4295ff=Date['now']();try{const _0x150e09=((_0x3ad1c9=this['_configService'][_0x348fd5(0x310)](_0x46104e[_0x348fd5(0x33c)]))==null?void 0x0:_0x3ad1c9[_0x348fd5(0x1eb)])||_0x14fb45,_0x5381c1=(await this[_0x348fd5(0x373)]['post'](_0x150e09,{'body':JSON[_0x348fd5(0x3e3)]({'taskId':_0x51cea0})}))['body'];if(((_0x2f7f0a=_0x5381c1['error'])==null?void 0x0:_0x2f7f0a[_0x348fd5(0x429)])!==_0x5a1443['OK'])return;this['_setFormulaLimitStatus'](_0x5381c1[_0x348fd5(0x410)],_0x4295ff);}catch(_0x38cbc7){this[_0x348fd5(0x3a2)][_0x348fd5(0x3ff)](_0x38cbc7);}}[_0x4624f5(0x2af)](){const _0x4a6dae=_0x4624f5;return this[_0x4a6dae(0x320)]===0x0?!0x0:this['_maxFormulaLimit']-this[_0x4a6dae(0x3c3)]>0x0;}[_0x4624f5(0x3e9)](){const _0x317336=_0x4624f5;this[_0x317336(0x44f)]&&(clearTimeout(this[_0x317336(0x44f)]),this[_0x317336(0x44f)]=null);}[_0x4624f5(0x1ec)](){const _0x2f312c=_0x4624f5;this[_0x2f312c(0x47b)][_0x2f312c(0x27d)]({'content':this[_0x2f312c(0x23c)]['t']('formula.calculation.waiting'),'type':_0x37af48[_0x2f312c(0x366)][_0x2f312c(0x3ee)]});}[_0x4624f5(0x24b)](_0x16db6e){const _0x52a069=_0x4624f5;for(const _0x4780fc of _0x16db6e){const {unitId:_0x3a0bb8,sheetId:_0x5cf83c,range:_0x120e3d}=_0x4780fc,_0x930c3e=this[_0x52a069(0x485)][_0x52a069(0x3cb)](_0x3a0bb8);if(!_0x930c3e)continue;const _0x276474=_0x930c3e['getSheetBySheetId'](_0x5cf83c);if(!_0x276474)continue;const _0x1bbdad=_0x276474[_0x52a069(0x263)]();for(let _0x530494=_0x120e3d['startRow'];_0x530494<=_0x120e3d[_0x52a069(0x3fc)];_0x530494++)for(let _0x46a3e3=_0x120e3d[_0x52a069(0x2cd)];_0x46a3e3<=_0x120e3d[_0x52a069(0x3f9)];_0x46a3e3++){const _0x288878=_0x1bbdad[_0x52a069(0x3dc)](_0x530494,_0x46a3e3);if(_0x288878&&(_0x161ac6[_0x52a069(0x326)](_0x288878['f'])||_0x161ac6[_0x52a069(0x321)](_0x288878['si'])))return!0x0;}}return!0x1;}};_0x35cb3d=_0x4d9d48([_0x18dac4(0x0,_0x161ac6[_0x4624f5(0x2b0)](_0x4291c6[_0x4624f5(0x337)])),_0x18dac4(0x1,_0x161ac6[_0x4624f5(0x41a)]),_0x18dac4(0x2,_0x161ac6[_0x4624f5(0x343)]),_0x18dac4(0x3,_0x161ac6[_0x4624f5(0x2b0)](_0x4db2d9[_0x4624f5(0x30d)])),_0x18dac4(0x4,_0x161ac6[_0x4624f5(0x37d)]),_0x18dac4(0x5,_0x161ac6[_0x4624f5(0x210)]),_0x18dac4(0x6,_0x161ac6['Inject'](_0x161ac6[_0x4624f5(0x25a)]))],_0x35cb3d);var _0xfc29a9=Object[_0x4624f5(0x272)],_0x178809=(_0x2a0a4b,_0x5dbc4a,_0x47e7da,_0x3e573c)=>{const _0x4484a3=_0x4624f5;for(var _0x246796=_0x3e573c>0x1?void 0x0:_0x3e573c?_0xfc29a9(_0x5dbc4a,_0x47e7da):_0x5dbc4a,_0x289a78=_0x2a0a4b[_0x4484a3(0x1e5)]-0x1,_0x584463;_0x289a78>=0x0;_0x289a78--)(_0x584463=_0x2a0a4b[_0x289a78])&&(_0x246796=_0x584463(_0x246796)||_0x246796);return _0x246796;},_0x56963f=(_0x45f3f1,_0x44dc63)=>(_0x453083,_0x2acc20)=>_0x44dc63(_0x453083,_0x2acc20,_0x45f3f1);let _0x4673bd=class extends _0x161ac6[_0x4624f5(0x482)]{constructor(_0x546d27,_0x5603fb,_0x499217){const _0x763431=_0x4624f5;super(),_0x47bfcc(this,_0x763431(0x3ce),new Map()),_0x47bfcc(this,_0x763431(0x1fb),new Map()),_0x47bfcc(this,'_disabled',!0x1),(this[_0x763431(0x415)]=_0x546d27,this[_0x763431(0x2f2)]=_0x5603fb,this[_0x763431(0x25c)]=_0x499217);}[_0x4624f5(0x448)](){this['_disabled']=!0x0;}[_0x4624f5(0x35a)](){this['_disabled']=!0x1;}get['saveTaskMap'](){return this['_saveTaskMap'];}[_0x4624f5(0x214)](){const _0x3e2c85=_0x4624f5;this[_0x3e2c85(0x324)]()[_0x3e2c85(0x2e0)](()=>super[_0x3e2c85(0x214)]());}async['loadOfflineData'](_0x2694b9){const _0x1eb06f=_0x4624f5;return this['_disabled']?null:this['_localStorageService'][_0x1eb06f(0x3d6)](_0x46104e[_0x1eb06f(0x319)](_0x2694b9));}async[_0x4624f5(0x311)](_0x5315e4,_0x2ae806){const _0x49aa6d=_0x4624f5;return!!this[_0x49aa6d(0x2f2)][_0x49aa6d(0x332)](_0x5315e4,_0x2ae806);}['updateOfflineData'](_0xfd2cab,_0x561fea,_0x40a660,_0x2413ff){const _0x414ed8=_0x4624f5,_0x5a1758=this[_0x414ed8(0x25c)]['getCurrentRevOfUnit'](_0xfd2cab);this[_0x414ed8(0x3ce)]['set'](_0xfd2cab,{'unitID':_0xfd2cab,'type':_0x561fea,'awaitingChangeset':_0x40a660,'mutations':_0x2413ff,'rev':_0x5a1758}),this[_0x414ed8(0x1fb)][_0x414ed8(0x390)](_0xfd2cab)||this[_0x414ed8(0x456)](_0xfd2cab);}[_0x4624f5(0x456)](_0x3083e4){const _0x368b10=_0x4624f5,_0x198619=this[_0x368b10(0x300)]();_0x198619===0x0?this[_0x368b10(0x3b6)](_0x3083e4):this[_0x368b10(0x1fb)][_0x368b10(0x3d5)](_0x3083e4,setTimeout(()=>this[_0x368b10(0x3b6)](_0x3083e4),_0x198619));}['_getSaveTimeout'](){const _0x516b3e=_0x4624f5;var _0x43ba0a;return(_0x43ba0a=this[_0x516b3e(0x415)]['getConfig'](_0x46104e['LOCAL_CACHE_INTERVAL_KEY']))!=null?_0x43ba0a:_0x46104e['LOCAL_CACHE_INTERVAL'];}[_0x4624f5(0x3b6)](_0x1c13ea){const _0x4decf5=_0x4624f5,_0x4dc18b=this[_0x4decf5(0x1fb)]['get'](_0x1c13ea);return _0x4dc18b!==void 0x0&&window[_0x4decf5(0x435)](_0x4dc18b),this[_0x4decf5(0x2f2)]['setItem'](_0x46104e['getLocalCacheKey'](_0x1c13ea),this[_0x4decf5(0x3ce)][_0x4decf5(0x333)](_0x1c13ea))[_0x4decf5(0x2e0)](()=>this[_0x4decf5(0x1fb)][_0x4decf5(0x40e)](_0x1c13ea));}async[_0x4624f5(0x324)](){const _0x12cfb7=_0x4624f5,_0x3e7908=[];this[_0x12cfb7(0x1fb)]['forEach']((_0x385f05,_0x4038a9)=>{const _0x5ca9ac=_0x12cfb7;window['clearTimeout'](_0x385f05),_0x3e7908[_0x5ca9ac(0x426)](this[_0x5ca9ac(0x3b6)](_0x4038a9)[_0x5ca9ac(0x2e0)](()=>{const _0x781732=_0x5ca9ac;this[_0x781732(0x1fb)][_0x781732(0x40e)](_0x4038a9);}));}),await Promise[_0x12cfb7(0x42e)](_0x3e7908);}};_0x4673bd=_0x178809([_0x56963f(0x0,_0x161ac6[_0x4624f5(0x343)]),_0x56963f(0x1,_0x161ac6[_0x4624f5(0x2ee)]),_0x56963f(0x2,_0x161ac6['Inject'](_0x48fdef['RevisionService']))],_0x4673bd);class _0x49e0db extends _0x161ac6['RxDisposable']{constructor(){const _0x17f0c9=_0x4624f5;super(),_0x47bfcc(this,_0x17f0c9(0x23e)),this[_0x17f0c9(0x23e)]=_0x66cc31[_0x17f0c9(0x38d)](window,_0x17f0c9(0x3a5))[_0x17f0c9(0x1ef)](_0x66cc31[_0x17f0c9(0x45d)](this[_0x17f0c9(0x289)]),_0x66cc31[_0x17f0c9(0x496)](0x1),_0x66cc31[_0x17f0c9(0x46b)](void 0x0));}[_0x4624f5(0x2c9)](_0x448091,_0x14555d,_0x5ce2c9=!0x1){const _0x10e6be=_0x4624f5,_0x14b27e=new URL(window[_0x10e6be(0x227)][_0x10e6be(0x33e)]);_0x14b27e['searchParams'][_0x10e6be(0x3d5)](_0x448091,_0x14555d),_0x5ce2c9?window['history'][_0x10e6be(0x445)]('','',_0x14b27e['toString']()):window['history']['pushState']('','',_0x14b27e[_0x10e6be(0x266)]());}[_0x4624f5(0x39d)](_0x85c3d8,_0x540f59=!0x1){const _0x3b5705=_0x4624f5,_0x3b51b3=new URL(window['location'][_0x3b5705(0x33e)]);_0x3b51b3[_0x3b5705(0x357)]['delete'](_0x85c3d8),_0x540f59?window[_0x3b5705(0x3c6)][_0x3b5705(0x445)]('','',_0x3b51b3['toString']()):window['history'][_0x3b5705(0x3fb)]('','',_0x3b51b3[_0x3b5705(0x266)]());}[_0x4624f5(0x3cd)](_0x1a6025){const _0x58f1aa=_0x4624f5;var _0x2bd162;return(_0x2bd162=new URL(window['location'][_0x58f1aa(0x33e)])[_0x58f1aa(0x357)][_0x58f1aa(0x333)](_0x1a6025))!=null?_0x2bd162:void 0x0;}}var _0x2cdf0a=Object[_0x4624f5(0x340)],_0x1a810a=Object['getOwnPropertyDescriptor'],_0x49289e=(_0x32a4ee,_0x2a34ac,_0x59f67e)=>_0x2a34ac in _0x32a4ee?_0x2cdf0a(_0x32a4ee,_0x2a34ac,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0x59f67e}):_0x32a4ee[_0x2a34ac]=_0x59f67e,_0x4057e8=(_0x41faf3,_0x45e67e,_0x3447d1,_0x410bed)=>{const _0x11c49b=_0x4624f5;for(var _0x1fbf22=_0x410bed>0x1?void 0x0:_0x410bed?_0x1a810a(_0x45e67e,_0x3447d1):_0x45e67e,_0x4efb20=_0x41faf3[_0x11c49b(0x1e5)]-0x1,_0x4ed5ce;_0x4efb20>=0x0;_0x4efb20--)(_0x4ed5ce=_0x41faf3[_0x4efb20])&&(_0x1fbf22=_0x4ed5ce(_0x1fbf22)||_0x1fbf22);return _0x1fbf22;},_0x45387b=(_0x41761c,_0x1ee7b3)=>(_0x4d0bbc,_0xfe0718)=>_0x1ee7b3(_0x4d0bbc,_0xfe0718,_0x41761c),_0x5efc18=(_0x502a18,_0x32440e,_0x52311d)=>_0x49289e(_0x502a18,_0x32440e+'',_0x52311d);const _0x2e2247='UNIVER_COLLABORATION_CLIENT_WEB_PLUGIN';_0x46875a['UniverCollaborationClientUIPlugin']=class extends _0x161ac6[_0x4624f5(0x24a)]{constructor(_0x367569=_0xbf724b,_0x3f7d35,_0x11a6d0,_0x54f727){const _0x147342=_0x4624f5;super(),this[_0x147342(0x419)]=_0x367569,this[_0x147342(0x338)]=_0x3f7d35,this['_injector']=_0x11a6d0,this['_configService']=_0x54f727;const {..._0x5eeb18}=_0x161ac6[_0x147342(0x348)]({},_0xbf724b,this['_config']);this[_0x147342(0x415)][_0x147342(0x441)](_0x2f76a0,_0x5eeb18);}['onStarting'](){const _0x4a5d5d=_0x4624f5;this[_0x4a5d5d(0x325)](),this[_0x4a5d5d(0x40b)]();}[_0x4624f5(0x43d)](){const _0x4d862f=_0x4624f5;this[_0x4d862f(0x286)]();}[_0x4624f5(0x325)](){const _0x40b94f=_0x4624f5;var _0xc12153;const _0x4267be=[[_0x1846fc],[_0x35cb3d],[_0x16e8f2],[_0x6698d6],[_0xa7a54c],[_0x360498],[_0x5a3a5f,{'useClass':_0x49e0db}],[_0x4db2d9[_0x40b94f(0x3be)],{'useClass':_0x4db2d9[_0x40b94f(0x239)]}],[_0x46104e[_0x40b94f(0x49d)],{'useClass':_0x4673bd}],[_0x46875a[_0x40b94f(0x492)]],[_0x41f840],[_0x1a48d1],[_0x1508be],[_0x665a7a],[_0x46875a['CollaborationDataLoaderController']]];_0x161ac6[_0x40b94f(0x381)](this[_0x40b94f(0x298)],_0x161ac6['mergeOverrideWithDependencies'](_0x4267be,(_0xc12153=this['_config'])==null?void 0x0:_0xc12153[_0x40b94f(0x280)]));}[_0x4624f5(0x286)](){const _0x511404=_0x4624f5;this[_0x511404(0x30f)](this[_0x511404(0x338)]['registerRenderModule'](_0x161ac6[_0x511404(0x2d9)][_0x511404(0x23d)],[_0x47d0f4])),this[_0x511404(0x30f)](this['_renderManagerService']['registerRenderModule'](_0x161ac6[_0x511404(0x2d9)][_0x511404(0x28b)],[_0x2d665f]));}[_0x4624f5(0x40b)](){const _0x1aa9a8=_0x4624f5;_0x161ac6[_0x1aa9a8(0x301)](this[_0x1aa9a8(0x298)],[[_0x1508be],[_0x46875a[_0x1aa9a8(0x492)]],[_0x41f840],[_0x1a48d1],[_0x46875a[_0x1aa9a8(0x25f)]],[_0x35cb3d]]);}},_0x5efc18(_0x46875a['UniverCollaborationClientUIPlugin'],'pluginName',_0x2e2247),_0x46875a[_0x4624f5(0x3ae)]=_0x4057e8([_0x161ac6[_0x4624f5(0x48f)](_0x46104e[_0x4624f5(0x1db)]),_0x45387b(0x1,_0x1fade8['IRenderManagerService']),_0x45387b(0x2,_0x161ac6['Inject'](_0x161ac6[_0x4624f5(0x2c2)])),_0x45387b(0x3,_0x161ac6[_0x4624f5(0x343)])],_0x46875a[_0x4624f5(0x3ae)]);var _0x4c2125=Object['getOwnPropertyDescriptor'],_0x6768c0=(_0x27b955,_0x42dc63,_0x1c9e69,_0x567291)=>{const _0x20b807=_0x4624f5;for(var _0x80e7d9=_0x567291>0x1?void 0x0:_0x567291?_0x4c2125(_0x42dc63,_0x1c9e69):_0x42dc63,_0x347aeb=_0x27b955[_0x20b807(0x1e5)]-0x1,_0x435d90;_0x347aeb>=0x0;_0x347aeb--)(_0x435d90=_0x27b955[_0x347aeb])&&(_0x80e7d9=_0x435d90(_0x80e7d9)||_0x80e7d9);return _0x80e7d9;},_0x53b6af=(_0x3e492b,_0x57d939)=>(_0x3b8d27,_0x8b69c3)=>_0x57d939(_0x3b8d27,_0x8b69c3,_0x3e492b);_0x46875a[_0x4624f5(0x417)]=class extends _0x46104e[_0x4624f5(0x314)]{constructor(_0x184e66,_0x2bf2ad,_0x4d1552,_0x403921,_0x58e700){super(_0x184e66,_0x2bf2ad,_0x4d1552,_0x403921,_0x58e700);}async[_0x4624f5(0x408)](_0x4be928){const _0x637255=_0x4624f5,_0x1ffe02=await this[_0x637255(0x1d9)](),_0xb0ee1d=this['_createSocketURL'](_0x4be928,_0x1ffe02);return this[_0x637255(0x2db)](_0xb0ee1d);}[_0x4624f5(0x431)](_0x1cc26e,_0x18ee55){const _0x2144f5=_0x4624f5,_0x70f96c=typeof window>'u'?new URL(_0x1cc26e):new URL(_0x1cc26e,window['location']['origin']);_0x70f96c[_0x2144f5(0x357)][_0x2144f5(0x3d5)](_0x2144f5(0x2d2),_0x18ee55);const _0x157335=typeof window>'u'?new URLSearchParams():new URLSearchParams(window['location']['search']);return _0x157335[_0x2144f5(0x333)](_0x2144f5(0x2da))&&_0x70f96c['searchParams'][_0x2144f5(0x3d5)](_0x2144f5(0x2da),_0x157335[_0x2144f5(0x333)](_0x2144f5(0x2da))),_0x70f96c[_0x2144f5(0x266)]();}async['_getSessionTicket'](){const _0x36f71d=_0x4624f5;var _0x37994d,_0x40a5c4,_0x554bc4;const _0x2102bc=this['_configService'][_0x36f71d(0x310)](_0x46104e[_0x36f71d(0x33c)]),_0x5c35b7=(_0x37994d=_0x2102bc==null?void 0x0:_0x2102bc[_0x36f71d(0x35f)])!=null?_0x37994d:_0x46104e[_0x36f71d(0x2a2)];return(_0x554bc4=(_0x40a5c4=(await this[_0x36f71d(0x373)]['get'](_0x5c35b7,{'headers':{'Content-Type':_0x36f71d(0x48b)}}))[_0x36f71d(0x3d0)])==null?void 0x0:_0x40a5c4['ticket'])!=null?_0x554bc4:'';}},_0x46875a[_0x4624f5(0x417)]=_0x6768c0([_0x53b6af(0x0,_0x161ac6[_0x4624f5(0x2b0)](_0x161ac6[_0x4624f5(0x2c2)])),_0x53b6af(0x1,_0x161ac6[_0x4624f5(0x2b0)](_0x4db2d9[_0x4624f5(0x30d)])),_0x53b6af(0x2,_0x161ac6[_0x4624f5(0x343)]),_0x53b6af(0x3,_0x161ac6[_0x4624f5(0x210)]),_0x53b6af(0x4,_0x48fdef['ISnapshotServerService'])],_0x46875a[_0x4624f5(0x417)]);var _0x1a0c68=Object[_0x4624f5(0x272)],_0x18e6da=(_0x5e0b66,_0x30c15b,_0x2feb64,_0x105b05)=>{const _0x146a5e=_0x4624f5;for(var _0x2d0d3b=_0x105b05>0x1?void 0x0:_0x105b05?_0x1a0c68(_0x30c15b,_0x2feb64):_0x30c15b,_0x4afebb=_0x5e0b66[_0x146a5e(0x1e5)]-0x1,_0x371b2d;_0x4afebb>=0x0;_0x4afebb--)(_0x371b2d=_0x5e0b66[_0x4afebb])&&(_0x2d0d3b=_0x371b2d(_0x2d0d3b)||_0x2d0d3b);return _0x2d0d3b;},_0x1c64a7=(_0x8106f,_0x486c9e)=>(_0x164830,_0x57913a)=>_0x486c9e(_0x164830,_0x57913a,_0x8106f);_0x46875a[_0x4624f5(0x3a4)]=class extends _0x161ac6[_0x4624f5(0x482)]{constructor(_0x50c1b9,_0x8c480e,_0x31eab8){const _0x2c81ee=_0x4624f5;super(),this[_0x2c81ee(0x34a)]=_0x50c1b9,this['_httpService']=_0x8c480e,this[_0x2c81ee(0x415)]=_0x31eab8;}async[_0x4624f5(0x294)](_0x59dece,_0x49782c,_0xde71e4,..._0x53bdf0){const _0x3fce4d=_0x4624f5;var _0x34e900,_0x5369d0,_0x5b9f56,_0x271a72;const _0x1f2a18=this[_0x3fce4d(0x34a)][_0x3fce4d(0x45a)]();if(!_0x1f2a18)throw new Error(_0x3fce4d(0x247));const _0x68dcb2=((_0x34e900=this[_0x3fce4d(0x415)][_0x3fce4d(0x310)](_0x46104e[_0x3fce4d(0x469)]))!=null?_0x34e900:_0x46104e[_0x3fce4d(0x26d)])+'/'+_0x59dece+_0x3fce4d(0x490)+_0x49782c,_0x138dcc=new URL(window[_0x3fce4d(0x227)]['href']),_0x4a9470={'scriptId':_0x59dece,'runId':(_0x5369d0=_0x138dcc[_0x3fce4d(0x357)][_0x3fce4d(0x333)](_0x3fce4d(0x2da)))!=null?_0x5369d0:'','function':_0x49782c,'unitId':_0x1f2a18['getUnitId'](),'argsOfFunction':JSON[_0x3fce4d(0x3e3)](_0x53bdf0),'invokeId':(_0x5b9f56=_0xde71e4['invokeId'])!=null?_0x5b9f56:'','executionId':(_0x271a72=_0xde71e4[_0x3fce4d(0x2ec)])!=null?_0x271a72:''};try{const _0x301675=await this['_httpService'][_0x3fce4d(0x376)](_0x68dcb2,{'body':_0x4a9470});return _0x301675[_0x3fce4d(0x3d0)][_0x3fce4d(0x3ff)]&&_0x301675[_0x3fce4d(0x3d0)][_0x3fce4d(0x3ff)]['code']!==_0x5a1443['OK']?_0x3fce4d(0x443):_0x301675[_0x3fce4d(0x3d0)][_0x3fce4d(0x233)];}catch{return _0x3fce4d(0x443);}}},_0x46875a['RemoteUniscriptService']=_0x18e6da([_0x1c64a7(0x0,_0x161ac6[_0x4624f5(0x37d)]),_0x1c64a7(0x1,_0x161ac6[_0x4624f5(0x2b0)](_0x4db2d9[_0x4624f5(0x30d)])),_0x1c64a7(0x2,_0x161ac6['IConfigService'])],_0x46875a[_0x4624f5(0x3a4)]);const _0x44039e=0x7530,_0x21dbfb='ACTIVE_UNIT_EVENT_CHANNEL';class _0xbd79a9 extends _0x161ac6['Disposable']{constructor(){const _0x4aed3f=_0x4624f5;super(),_0x47bfcc(this,_0x4aed3f(0x432),_0x161ac6[_0x4aed3f(0x497)]()),_0x47bfcc(this,_0x4aed3f(0x24f),new Set()),_0x47bfcc(this,'_unitOnClients',new Map()),_0x47bfcc(this,_0x4aed3f(0x40c),null),_0x47bfcc(this,'_clearOtherTimers',new Map()),_0x47bfcc(this,_0x4aed3f(0x29a),new Map()),this[_0x4aed3f(0x48d)]();}[_0x4624f5(0x214)](){const _0x591f57=_0x4624f5;super[_0x591f57(0x214)](),this[_0x591f57(0x1da)][_0x591f57(0x265)]((_0x275f63,_0x4b4519)=>this['_removeClearOtherTimer'](_0x4b4519)),this[_0x591f57(0x40c)]&&window[_0x591f57(0x2e3)](this[_0x591f57(0x40c)]);}[_0x4624f5(0x317)](_0xe4de9a){const _0x58534d=_0x4624f5;return this[_0x58534d(0x2c4)](_0xe4de9a)[_0x58534d(0x1ef)](_0x66cc31['distinctUntilChanged']());}[_0x4624f5(0x21c)](_0x5e63ad){const _0x5f20c8=_0x4624f5;this['_selfUnitIDs'][_0x5f20c8(0x36e)]===0x0&&this['_scheduleHeartbeat'](),this[_0x5f20c8(0x24f)]['add'](_0x5e63ad),this[_0x5f20c8(0x409)]({'type':0x0,'memberID':this[_0x5f20c8(0x432)],'unitIDs':[_0x5e63ad],'isForwarded':!0x1});}[_0x4624f5(0x353)](_0x5ea865){const _0x64953a=_0x4624f5;this[_0x64953a(0x24f)]['delete'](_0x5ea865),this[_0x64953a(0x24f)][_0x64953a(0x36e)]===0x0&&this[_0x64953a(0x40c)]&&window[_0x64953a(0x2e3)](this[_0x64953a(0x40c)]);}[_0x4624f5(0x48d)](){const _0x149284=_0x4624f5;this[_0x149284(0x30f)](_0x161ac6[_0x149284(0x2b9)](_0x66cc31[_0x149284(0x38d)](window,_0x149284(0x30a))[_0x149284(0x26b)](_0x281bc7=>{const _0x2df8c1=_0x149284;if(_0x281bc7[_0x2df8c1(0x220)]!==_0x21dbfb||!_0x281bc7[_0x2df8c1(0x2b1)])return;const _0x929690=JSON[_0x2df8c1(0x34e)](_0x281bc7['newValue']);this[_0x2df8c1(0x2a4)](_0x929690);}))),window[_0x149284(0x283)]('unload',()=>this[_0x149284(0x409)]({'type':0x1,'memberID':this['_id'],'unitIDs':Array['from'](this[_0x149284(0x24f)])}));}['_handleEvent'](_0x5df6d0){const _0x183c67=_0x4624f5;switch(_0x5df6d0[_0x183c67(0x35b)]){case 0x0:this[_0x183c67(0x1d6)](_0x5df6d0);break;case 0x1:this[_0x183c67(0x329)](_0x5df6d0);break;case 0x2:this[_0x183c67(0x3cf)](_0x5df6d0);break;}}[_0x4624f5(0x1d6)](_0x4973dc){const _0x546d0b=_0x4624f5,{unitIDs:_0x56e80b,memberID:_0x5b6ff2,isForwarded:_0x5ead33}=_0x4973dc;_0x56e80b['forEach'](_0x1d3542=>{const _0x4e05a1=_0x1a8e;if(!_0x5ead33&&this[_0x4e05a1(0x2e1)][_0x4e05a1(0x390)](_0x1d3542)&&this[_0x4e05a1(0x2c4)](_0x1d3542)[_0x4e05a1(0x3c9)](_0x46104e['UnitStatus'][_0x4e05a1(0x402)]),!this[_0x4e05a1(0x2e1)][_0x4e05a1(0x390)](_0x1d3542)||!this['_unitOnClients']['get'](_0x1d3542)[_0x4e05a1(0x390)](_0x5b6ff2)){const _0x291a9c=this['_unitOnClients'][_0x4e05a1(0x333)](_0x1d3542)||new Set();_0x291a9c[_0x4e05a1(0x455)](_0x5b6ff2),this[_0x4e05a1(0x2e1)][_0x4e05a1(0x3d5)](_0x1d3542,_0x291a9c),this[_0x4e05a1(0x48c)](_0x5b6ff2);}}),_0x5ead33||this['_send']({'type':0x0,'memberID':this[_0x546d0b(0x432)],'unitIDs':[...this[_0x546d0b(0x24f)]],'isForwarded':!0x0});}[_0x4624f5(0x48c)](_0x2b18c3){const _0x20f15d=_0x4624f5;this[_0x20f15d(0x380)](_0x2b18c3);const _0x3bc30d=window[_0x20f15d(0x1e6)](()=>{const _0xc6e11d=_0x20f15d;this['_unitOnClients'][_0xc6e11d(0x265)](_0x10676d=>{const _0x472708=_0xc6e11d;_0x10676d[_0x472708(0x40e)](_0x2b18c3);});},_0x44039e*0x2);this[_0x20f15d(0x1da)][_0x20f15d(0x3d5)](_0x2b18c3,_0x3bc30d);}[_0x4624f5(0x380)](_0x203423){const _0x125d12=_0x4624f5;if(this[_0x125d12(0x1da)][_0x125d12(0x390)](_0x203423)){const _0x2e9405=this[_0x125d12(0x1da)]['get'](_0x203423);_0x2e9405&&window['clearTimeout'](_0x2e9405),this[_0x125d12(0x1da)][_0x125d12(0x3d5)](_0x203423,null);}}[_0x4624f5(0x329)](_0xbbd737){const _0x24e1bd=_0x4624f5,{memberID:_0x4f2029,unitIDs:_0x430e1a}=_0xbbd737;_0x430e1a[_0x24e1bd(0x265)](_0x55b81e=>{const _0x909a1=_0x24e1bd;var _0x16a7c6;const _0xbb3476=this['_unitOnClients'][_0x909a1(0x333)](_0x55b81e);_0xbb3476&&(_0xbb3476['delete'](_0x4f2029),(_0x16a7c6=this['_ensureSubject'](_0x55b81e))==null||_0x16a7c6[_0x909a1(0x3c9)](_0xbb3476[_0x909a1(0x36e)]===0x0?_0x46104e[_0x909a1(0x2d3)][_0x909a1(0x1cb)]:_0x46104e[_0x909a1(0x2d3)][_0x909a1(0x402)]));}),this[_0x24e1bd(0x380)](_0x4f2029);}[_0x4624f5(0x3cf)](_0x2f8ed6){const _0x3921ff=_0x4624f5;this['_scheduleClearOtherTimer'](_0x2f8ed6[_0x3921ff(0x3de)]);}[_0x4624f5(0x409)](_0x47037d){localStorage['setItem'](_0x21dbfb,JSON['stringify'](_0x47037d));}[_0x4624f5(0x2d4)](){const _0x2a0d68=_0x4624f5;this['_heartbeatTimer']=window[_0x2a0d68(0x3ec)](()=>{const _0x4180d1=_0x2a0d68;this[_0x4180d1(0x409)]({'type':0x2,'memberID':this[_0x4180d1(0x432)]});},_0x44039e);}[_0x4624f5(0x2c4)](_0x3966ae){const _0x587623=_0x4624f5;return this['_unitStatus']['has'](_0x3966ae)||this[_0x587623(0x29a)]['set'](_0x3966ae,new _0x66cc31[(_0x587623(0x41e))](_0x46104e[_0x587623(0x2d3)][_0x587623(0x1cb)])),this[_0x587623(0x29a)][_0x587623(0x333)](_0x3966ae);}}_0x46875a['IURLService']=_0x5a3a5f,_0x46875a[_0x4624f5(0x359)]=_0x5c4987,_0x46875a['WebBrowserSingleActiveUnitService']=_0xbd79a9,_0x46875a[_0x4624f5(0x252)]=_0x49e0db,Object[_0x4624f5(0x340)](_0x46875a,Symbol[_0x4624f5(0x21b)],{'value':_0x4624f5(0x273)});}));function _0x1a8e(_0x56b0b5,_0xcea906){const _0x14a715=_0x14a7();return _0x1a8e=function(_0x1a8e47,_0x2f648c){_0x1a8e47=_0x1a8e47-0x1cb;let _0xf27d37=_0x14a715[_0x1a8e47];return _0xf27d37;},_0x1a8e(_0x56b0b5,_0xcea906);}function _0x14a7(){const _0x19ae58=['MOBILE_VERIFY_CODE_MISMATCH','CollaborationEvent','USER_NOT_FOUND','drawWith','getTypeOfUnitAdded$','_saveCache','PAYMENT_CHANNEL_NOT_SUPPORT','_collabCursorState$','UniverDesign','none','stage','replace','_notificationService','ISocketService','_transformUndoRedoStack','_themeService','_transformHistoryAndStateStack','transformRemoteChangeset','_currentUsage','FormulaExecutedStateType','textRanges','history','DocSelectionManagerService','UniverProCollaborationClient','next','YUUMI_RATE_OVER_LIMIT','getUnit','createElement','getParam','_cachedData','_handleHeartbeatEvent','body','range','getMemberID','_docTransformStateCacheService','_docTransformIMECacheService','set','getItem','transformMutation','getColorFromTheme','Shape','_hover','getViewport','getValue','AWAITING','memberID','_getSheetObject','setShapeProps','fillText','_entities','stringify','debounce','row','ENTITLE_CHAT_LIMIT_EXCEED','_status$','CanceledError','_clearPolling','_cursor','registerComponent','setInterval','cursorInfo$','Loading','12848760UgXbap','DocStateChangeManagerService','_setupBeforeClosingHandler','createInstance','_taskIds','_labelPosition','_syncEditingCollabCursorService','PENDING','REDEMPTION_CODE_INACTIVE','height','endColumn','event$','pushState','endRow','useDependency','RegularPolygon','error','univer-text-sm\x20univer-leading-8\x20univer-text-gray-600\x20dark:!univer-text-gray-200','@univerjs-pro/collaboration-client','OTHER_CLIENTS_EDITING','CLOSE_ROOM','_updateSubUnitFromURLParams','debounceTime','COLORS','_drawAnchor','createSocket','_send','defIds','_initDependencies','_heartbeatTimer','_initResize','delete','AUTHORIZE_CODE_ILLEGAL','limitInfo','BuiltInUIPart','_getMergeRange','_initEvent','div','_configService','FormulaExecuteStageType','BrowserCollaborationSocketService','send','_config','ICommandService','subUnitId','REDEMPTION_CODE_FULLY_REDEEMED','START_CALCULATION','BehaviorSubject','Optional','handleInsertRow','CollaborationUIEventService','collabCursorState$','REDEMPTION_USER_REDEEM_TIMES_EXCEED','_imageIoService','376572jdieHg','push','FromArray','ONLINE','code','stageInfo','totalFormulasToCalculate','fillStyle','hovered','all','values','handleDeleteRangeMoveUp','_createSocketURL','_id','name','Subject','clearTimeout','collaboration.closeRoom','1em','filter','CURRENT_STATUS_CANNOT_OPERATE','_commandService','requireSession','entityInit$','onRendered','OffLineIcon','startFormulaLimitUrl','throttleTime','setConfig','OFFLINE','Failed','exports','replaceState','_backgroundColor','getSheetId','disableLocalCache','_collaborationUIEventService','split','_document','TEXT_RANGE_LAYER_INDEX','SUCCESS','map','_pollingInterval','closePath','UNDEFINED','_color','off-line-icon_clip0_910_343','_anchor','add','_scheduleSaving','fillRule','onPointerMove$','_getFormulaLimitStatus','getFocusedUnit','setAlpha','serializeRangeWithSheet','takeUntil','off-line-icon','_checkAndWaitForCalculationPermission','Tools','path','isArray','Unknown\x20user','UniverEngineRender','DocCollaborationEntity','toRgbString','lineTo','rxjs/operators','REMOTE_UNISCRIPT_EXECUTION_ENDPOINT_KEY','DisposableCollection','mapTo','getCollabEntity$','session.connection-failed','LICENSE_MAX_MEMBERS_PER_UNIT_EXCEEDED','switchMap','unitId','white','current','PY_RUNTIME_SCRIPT_ERROR','reconnect','RECT','column','Workbook','measureText','roomMembers$','_applyCommand','_messageService','saveTaskMap','collab-client.tooltip.reconnect','NOT_FOUND','collabStatus.notCollab','now','getSheetBySheetId','Disposable','getVpScrollXYInfoByPosToVp','NOT_COLLAB','_univerInstanceService','univerjs-icon\x20univerjs-icon-','complete','_hideTimer','No\x20unitID\x20or\x20type\x20in\x20URL.\x20Will\x20not\x20load\x20files\x20from\x20remote\x20address.','[CollaborationDataLoaderController]','application/json','_scheduleClearOtherTimer','_init','_drawRectRange','DependentOn','/run/','getCurrentSelections','DesktopCollaborationStatusDisplayController','react','m1Prime','attrs','shareReplay','generateRandomId','onPointerLeave$','CONFLICT','skeleton','bold\x2013px\x20Source\x20Han\x20Sans\x20CN','addObject','ILocalCacheService','displayName','collabStatus.offline','SNAPSHOT_HAS_BEEN_REMOVED','redoState','black','NO_OTHER_CLIENTS_EDITING','subunit','_onRefRangeChange','SetFormulaCalculationNotificationMutation','YUUMI_ASYNCIO_CANCELLED','UNAUTHENTICATED','collaboration.single-unit.warning','amd','onPointerEnter$','_releaseCalculationLimit','IImageIoService','_handleJoinEvent','SetTextSelectionsOperation','find','_getSessionTicket','_clearOtherTimers','UniverCollaborationClientPlugin','M3.61971\x2011.6499C2.40304\x2011.6499\x200.699707\x2011.1024\x200.699707\x208.9124C0.699707\x206.3574\x203.25471\x205.8099\x203.98471\x205.8099C4.34971\x204.5324\x205.07971\x202.5249\x207.99971\x202.5249C10.5547\x202.5249\x2011.6497\x203.9849\x2012.0147\x205.2624C12.0147\x205.2624\x2015.2997\x205.6274\x2015.2997\x208.7299C15.2997\x2010.9199\x2013.8397\x2011.6499\x2012.3797\x2011.6499M9.82471\x209.82466L6.17471\x2013.4747M6.17471\x209.82466L9.82471\x2013.4747','_toggleOffline','ENTITLE_DUP_SUBSCRIPTION','_docTransformSelectionsService','@univerjs/design','_dataLoaderService','143104dpbOhB','addHandlerCallback','EMAIL_VERIFY_CODE_NOT_FOUND_OR_EXPIRED','length','setTimeout','LICENSE_MAX_UNITS_EXCEEDED','UniverRpc','ranges','UniverEngineFormula','releaseFormulaLimitUrl','_showGuardMessage','getRenderById','ENTITLE_UPDOWN_GRADE_NOT_SUPPORT','pipe','SOCKET_FAILED_RETRY','YUUMI_SUBSCRIPTION_NOT_FOUND','unshift','triggerDblclick','activeSheet$','flatMap','collabStatus.conflict','UniverProCollaborationClientUi','purple.300','collaboration-client.offline-data-not-saved','DataLoaderService','_saveTaskMap','getAncestorScale','_lastPointer','_docClipboardService','react/jsx-runtime','ERROR_AGAIN','fill','_initCommandInterceptor','getActiveSheet','14590CWxtwa','1812eVxkPS','M4.5865\x2011.6499C3.36983\x2011.6499\x201.6665\x2011.1024\x201.6665\x208.9124C1.6665\x206.3574\x204.2215\x205.8099\x204.9515\x205.8099C5.3165\x204.5324\x206.0465\x202.5249\x208.9665\x202.5249C11.5215\x202.5249\x2012.6165\x203.9849\x2012.9815\x205.2624C12.9815\x205.2624\x2016.2665\x205.6274\x2016.2665\x208.7299C16.2665\x2010.9199\x2014.8065\x2011.6499\x2013.3465\x2011.6499M6.7767\x2011.6497L8.9667\x2013.4747L11.8867\x209.82466','setStateCache','http://www.w3.org/2000/svg','selections','DeleteRangeMoveUpCommandId','UniverSheetsUi','cursorInfo','_startCalculationLimit','undoState','LICENSE_EXPORT_SIZE_EXCEEDED','ILogService','collab-rect-range-','_docSkeleton','#FFF','dispose','asObservable','_refRangeService','USERS_LEAVE','_cursorInfo$','SYNCED','UniverDocs','toStringTag','editingUnit','_initEntityListener','@univerjs/sheets-ui','APPLY_DUPLICATED','key','sessionStatus$','MemberService','UniverProCollaboration','UniverSheets','executeCommand','_handleHover','location','IUIPartsService','INVITE_CODE_HAS_BEEN_UES','session.collaboration-timeout','handleDeleteRangeMoveLeft','_removeCollabCursors','APPLY_REJECT','_docStateChangeManagerService','UniverUi','width','mask','REDEMPTION_INVALID_CODE','result','IBeforeCloseService','YUUMI_NO_CUBOID_FOR_QUESTION','makeDirty','_setFormulaLimitStatus','jiqing.500','WebSocketService','_memberService','bottom','_localeService','UNIVER_DOC','urlChange$','CollaborationController','RxDisposable','Warning','DocSkeletonManagerService','from','SetWorksheetActivateCommand','isTransformMutationsWithChangesetSuccess','clipPath','[RemoteUniscriptService]:\x20no\x20focused\x20unit','LICENSE_IMPORT_SIZE_EXCEEDED','_draw','Plugin','_hasFormulaInDirtyRanges','_range','_toggleOnline','handleInsertCol','_selfUnitIDs','_eventUnsubscribe','max','WebURLService','1562286ftGtly','ITransformService','registerRefRange','_drawTextRange','YUUMI_URL_COL_OUT_OF_RANGE','collabStatus.fetchMiss','INVALID_ARGUMENT','LocaleService','doc.mutation.rich-text-editing','_revisionService','getOffsetConfig','startsWith','CollaborationDataLoaderController','_colorIndex','UPDATE_CURSOR','YUUMI_PROMPT_MAX_TOKENS_EXCEEDED','getCellMatrix','_collabSessionService','forEach','toString','LOGIN_TOKEN_PROCESSING_FAILED','REDEMPTION_CODE_NOT_STARTED','deserializeRangeWithSheet','CollaborationSessionService','subscribe','syncEditingCollabCursor','DEFAULT_REMOTE_UNISCRIPT_EXECUTION_ENDPOINT','RemoveRowCommandId','IDocClipboardService','9926210SjavBu','currentTheme$','getOwnPropertyDescriptor','Module','_colorAssignService','use','params','MOBILE_HAS_BEEN_BOUND','SetSelectionsOperation','InsertRangeMoveDownCommandId','_assignedColors','substring','_transformService','show','_urlService','_online','override','isEditing','createIdentifier','addEventListener','xlink:href','unit','_registerRenderDependencies','with','@univerjs-pro/collaboration','dispose$','6243093RvHIRZ','UNIVER_SHEET','onMouseMove','forwardRef','url(#$1','@univerjs/core','SessionStatus','YUUMI_TABLE_NOT_FOUND_IN_UNIT','Success','getColor','runOnServer','hide','_setupSubUnitSync','transformSelections','_injector','/universer-api/license/formula/limit/start','_unitStatus','DOC_RANGE_TYPE','_entityInit$','InsertRangeMoveRightCommandId','DATA_SOURCE_TOO_LARGE','saveImage','_hovered','on-line-icon_clip0_910_349','DEFAULT_WS_SESSION_TICKET_URL','INVITE_CODE_REQUIRED','_handleEvent','PERMISSION_DENIED','entries','useRef','currentColor','ColorKit','arc','_uiPartsService','LOGIN_FAILED','YUUMI_ALL_TABLES_IS_INVALID','getDocRanges','_checkCalculationAvailable','Inject','newValue','init','_refreshCollabCursors','COMPLETION_FINISHED','@univerjs/drawing','SOCKET_FAILED','assign','replaceDocRanges','toDisposable','assignAColorForMemberID','transformMutationsWithChangeset','getCurrentUnitForType','VIEW_MAIN','INotificationService','sheetId','_collaborationController','WECHAT_HAS_BEEN_BOUND','Injector','getCollabCursors$','_ensureSubject','_updateLocalCursor','_updateURLWithCurrentState','_startDocCollabCursor','_collabCursorController','setParam','collaboration-client-ui.config','url(#off-line-icon_clip0_910_343)','red.300','startColumn','JOIN_ROOM_FAILED','jsx','NodePositionConvertToRectRange','TEXT','sessionTicket','UnitStatus','_scheduleHeartbeat','collabStatus.syncing','YUUMI_UNABLE_LOAD_URL','AWAITING_WITH_PENDING','deepClone','UniverInstanceType','runId','_doCreateSocket','addObjects','status$','_onCursorDelete','APPLY_PERMISSION_DENIED','then','_unitOnClients','getCurrent','clearInterval','YUUMI_CONNECTOR_URL_NOT_FOUND','@univerjs/network','CollaborationStatus','maxFormulaLimit','startRow','unitID','ENTITLE_CAN_NOT_BUY_LOWER_OTP','_docSyncEditingCollabCursorService','executionId','CONNECTOR_DATA_TOO_LARGE','ILocalStorageService','loadUnit','combineLatest','SNAPSHOT_INVALID_SNAPSHOT','_localStorageService','_scene','getTypeOfUnitDisposed$','_beforeCloseService','_textBubble','rgba(255,\x20255,\x20255,\x200.01)','transformByState','ENTITLE_REPORT_LIMIT_EXCEED','docStateChange$','INVITE_CODE_ALREADY_BOUND','color','getRelativeToViewportCoord','roomMembers','defs','_getSaveTimeout','touchDependencies','getUndoRedoMutationParamsCache','engine','restore','Vector2','string','transformStateCache','TOO_MANY_REQUESTS','source','storage','getUnitId','RemoveColCommandId','HTTPService','MOBILE_VERIFY_CODE_NOT_FOUND_OR_EXPIRED','disposeWithMe','getConfig','saveOfflineData','fromEventSubject','INTERNAL_ERROR','CollaborationSocketService','_onCursorUpdate','collabStatus.synced','getUnitStatus$','Tooltip','getLocalCacheKey','rxjs','findNodePositionByCharIndex','actions','handleIRemoveCol','round','ThemeService','_maxFormulaLimit','isFormulaId','_cursors','@univerjs/engine-formula','exhaustSavingTask','_registerDependencies','isFormulaString','eventID','_getScale','_handleLeaveEvent','ENSURE_SNAPSHOT_EXECUTION','DocIMEInputManagerService','UniverDrawing','text','isTransformMutationFailure','tag','currentSkeleton$','backgroundColor','setItem','get','CollaborationUIEventId','runRefRangeMutations','REDEMPTION_CODE_HAS_BEEN_CREATED','IMessageService','_renderManagerService','permission.title','handleIRemoveRow','getformulaLimitStatusUrl','COLLABORATION_CLIENT_PLUGIN_CONFIG_KEY','_initStatusListener','href','_name','defineProperty','getSkeleton','SUBMIT_CHANGESET_TIMEOUT','IConfigService','_session','data','_localCacheService','LICENSE_DISTRO_REJECTED','merge','OnLineIcon','_instanceService','_cursorShapes','children','@univerjs/docs-ui','parse','MoveRangeCommandId','0\x200\x2016\x2016','_startSheetCollabCursor','useCallback','disposeUnit','includes','beforeCommandExecuted','imageSourceType','searchParams','trim','SheetCollabCursorShape','enableLocalCache','type','shift','mutations','idSuffix','wsSessionTicketUrl','@univerjs/sheets','EffectRefRangId','...','_getAnchorBounding','ALREADY_EXISTS','APPLY_REVISION_CONFILICT','MessageType','CommandType','Error','ENTITLE_NEED_BILLING_ADDRESS','@univerjs/engine-render','NodePositionConvertToCursor','collab-text-range-','_initCommandExecutedListener','size','onTransformChange$','connectInjector','font','RefRangeService','_httpService','Rect','EMAIL_VERIFY_CODE_MISMATCH','post','_anchorDot','addClipboardHook','handleInsertRangeMoveDown','TRANSFORM_CHANGE_OBSERVABLE_TYPE','save','subscribeEvent','IUniverInstanceService','isActive','InsertRowCommandId','_removeClearOtherTimer','registerDependencies','React','IRenderManagerService','_initStatusComponent','ENTITLE_INSUFFICIENT_QUOTA','getSheetObject','_shapes','REDEMPTION_USER_NOT_ELIGIBLE','_lastResponseTimestamp','min','resize','_context','fromEvent','getRangePointData','whenReady','has','onCommandExecuted','/universer-api/license/formula/limit/done','_sheetSkeletonManagerService','_transformPreviousActiveRange','_docSkeletonManagerService','svg','m2Prime','_updateCollabCursors','_render','SheetSkeletonManagerService','APPLY_NON_SEQUENTIAL_REVISION','dirtyRanges','removeParam','getStateCache','colorChannel1','green.600','top','_logService','M0\x200H16V16H0z','RemoteUniscriptService','popstate','getActiveRange','FETCH_MISS','_roomMembers$','IRemoteInstanceService','unsubscribe','parseInt','univer-mr-2\x20univer-flex\x20univer-text-xl','UniverDocsUi','UniverCollaborationClientUIPlugin','UniverIcon','4VIbCTe'];_0x14a7=function(){return _0x19ae58;};return _0x14a7();}