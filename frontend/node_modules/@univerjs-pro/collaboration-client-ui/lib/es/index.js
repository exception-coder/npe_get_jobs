const _0x59d238=_0x6a51;(function(_0x347e9e,_0x26e18e){const _0x56a38f=_0x6a51,_0x12ab5c=_0x347e9e();while(!![]){try{const _0xbff4ac=parseInt(_0x56a38f(0x38a))/0x1*(-parseInt(_0x56a38f(0x2a9))/0x2)+parseInt(_0x56a38f(0x336))/0x3+-parseInt(_0x56a38f(0x20e))/0x4*(parseInt(_0x56a38f(0x1e9))/0x5)+-parseInt(_0x56a38f(0x1b2))/0x6+parseInt(_0x56a38f(0x2b7))/0x7+parseInt(_0x56a38f(0x1ce))/0x8+parseInt(_0x56a38f(0x2bc))/0x9;if(_0xbff4ac===_0x26e18e)break;else _0x12ab5c['push'](_0x12ab5c['shift']());}catch(_0x173f8c){_0x12ab5c['push'](_0x12ab5c['shift']());}}}(_0x3e21,0xdade2));var Ft=Object[_0x59d238(0x33e)],kt=(_0x12df93,_0x5259d2,_0x245c09)=>_0x5259d2 in _0x12df93?Ft(_0x12df93,_0x5259d2,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0x245c09}):_0x12df93[_0x5259d2]=_0x245c09,l=(_0x320552,_0x359b9a,_0x2af815)=>kt(_0x320552,typeof _0x359b9a!=_0x59d238(0x2c4)?_0x359b9a+'':_0x359b9a,_0x2af815);import{jsx as _0x5601e7,jsxs as _0x4620e7}from'react/jsx-runtime';import{CollaborationStatus as _0x2dbbe4,CollaborationSessionService as _0x1917eb,CollaborationController as _0x48b193,DataLoaderService as _0x3e2b55,MemberService as _0x554a3d,SessionStatus as _0x3a98da,ILocalCacheService as _0x27b0f5,CollaborationUIEventService as _0x33ee3e,CollaborationUIEventId as _0x16016d,DocCollaborationEntity as _0x1c0711,COLLABORATION_CLIENT_PLUGIN_CONFIG_KEY as _0x4fca11,getLocalCacheKey as _0x5e1edc,LOCAL_CACHE_INTERVAL as _0x2c30a5,LOCAL_CACHE_INTERVAL_KEY as _0x5aac96,UniverCollaborationClientPlugin as _0xe09d19,CollaborationSocketService as _0x464143,DEFAULT_WS_SESSION_TICKET_URL as _0x2abf97,REMOTE_UNISCRIPT_EXECUTION_ENDPOINT_KEY as _0x528862,DEFAULT_REMOTE_UNISCRIPT_EXECUTION_ENDPOINT as _0xd9da8,UnitStatus as _0x4cd08c}from'@univerjs-pro/collaboration-client';import{LocaleService as _0x36a5ba,IUniverInstanceService as _0x21d94f,Inject as _0x43bd7d,Injector as _0x504c4c,Disposable as _0x4c1835,createIdentifier as _0x1f7b04,ILogService as _0x5be773,ICommandService as _0x831c33,Optional as _0x4d1e28,RxDisposable as _0x5e1dde,Workbook as _0x31f29e,DOC_RANGE_TYPE as _0x3ea76e,debounce as _0x86b54f,Rectangle as _0x51b39e,DisposableCollection as _0x107734,toDisposable as _0x38e653,UniverInstanceType as _0x4b5311,generateRandomId as _0xcfedbd,COLORS as _0x41e869,ColorKit as _0x4769a4,ThemeService as _0x5dc501,fromEventSubject as _0x1d5081,Tools as _0x256b31,CommandType as _0x1106f7,IConfigService as _0x4d7dbb,CanceledError as _0x56d586,isFormulaString as _0x1017c7,isFormulaId as _0x13573c,ILocalStorageService as _0x3e70d2,DependentOn as _0x1363b5,Plugin as _0xc56309,merge as _0x51bab7,registerDependencies as _0x34fb2d,mergeOverrideWithDependencies as _0x5104c6,touchDependencies as _0x56ad00}from'@univerjs/core';import{useObservable as _0x4a4308,useDependency as _0x3f9337,IUIPartsService as _0x463040,BuiltInUIPart as _0x3eebab,connectInjector as _0x407494,IBeforeCloseService as _0xd5bcc6,IMessageService as _0x258372,INotificationService as _0x28531f}from'@univerjs/ui';import{BehaviorSubject as _0x7b2298,switchMap as _0x42f9ae,of as _0x5bbcb9,takeUntil as _0x2d5638,debounceTime as _0x380830,Subject as _0x9e5180,filter as _0x284e18,merge as _0x3dc230,combineLatest as _0x566c6c,fromEvent as _0x4ef470,shareReplay as _0x2acb86,mapTo as _0x2cc8ef,distinctUntilChanged as _0x19284c}from'rxjs';import{Tooltip as _0x168c4e,clsx as _0x3e0c4c,MessageType as _0x2a0f31}from'@univerjs/design';import{useRef as _0x2c8075,createElement as _0x375fa2,forwardRef as _0x32d41e,useCallback as _0x5e2164}from'react';import{IRemoteInstanceService as _0xa99a92}from'@univerjs/rpc';function _0x3e21(){const _0x21ba94=['labelPosition','univer-flex\x20univer-items-center','type','RECT','transformSelections','CLOSE_ROOM','RemoveRowCommandId','fillRule','_handleJoinEvent','origin','push','_onRefRangeChange','_scene','getCellPositionByOffset','_updateSubUnitFromURLParams','redoState','_injector','UNIVER_COLLABORATION_CLIENT_WEB_PLUGIN','SYNCED','entries','unit','MUTATION','_registerDependencies','getParam','setTimeout','_dataLoaderService','0\x200\x2017\x2016','m1Prime','_httpService','setUndoRedoMutationParamsCache','clearInterval','DeleteRangeMoveUpCommandId','InsertColCommandId','_online','_unitStatus','LICENSE_IMPORT_SIZE_EXCEEDED','setAlpha','createSocket','_docSyncEditingCollabCursorService','YUUMI_PROMPT_MAX_TOKENS_EXCEEDED','session.collaboration-timeout','_init','FETCH_MISS','saveOfflineData','_config','LICENSE_EXPORT_SIZE_EXCEEDED','saveTaskMap','EMAIL_VERIFY_CODE_NOT_FOUND_OR_EXPIRED','restore','_hideTimer','stage','name','none','subunit','session.connection-failed','skeleton','CONNECTOR_DATA_TOO_LARGE','tag','_docStateChangeManagerService','NO_OTHER_CLIENTS_EDITING','permission.title','blue.400','_drawTextRange','YUUMI_AI_RUN_FAILED','createInstance','/universer-api/license/formula/limit/start','disposeWithMe','_startSheetCollabCursor','_themeService','values','M0\x200H16V16H0z','_checkAndWaitForCalculationPermission','executionId','onRendered','MoveRangeCommandId','Success','makeDirty','children','application/json','maxFormulaLimit','send','_setFormulaLimitStatus','includes','ENTITLE_UPDOWN_GRADE_NOT_SUPPORT','next','ONLINE','_unitOnClients','_backgroundColor','column','_univerInstanceService','attrs','FromArray','_handleHover','sessionStatus$','_context','show','data','removeParam','_disabled','_textBubble','onPointerEnter$','m2Prime','pluginName','whenReady','MOBILE_VERIFY_CODE_MISMATCH','url(#on-line-icon_clip0_910_349)','_localeService','Failed','override','transformMutationsWithChangeset','CURRENT_STATUS_CANNOT_OPERATE','_beforeCloseService','Error','_collabSessionService','_showGuardMessage','getOwnPropertyDescriptor','storage','collab-client.tooltip.reconnect','mask','min','getUnitId','isEditing','code','APPLY_REJECT','_setupSubUnitSync','_colorAssignService','45740ocuVrM','_onCursorDelete','INVALID_INVITE_CODE','defs','releaseFormulaLimitUrl','_docTransformStateCacheService','INVALID_ARGUMENT','_configService','_refRangeService','getTypeOfUnitAdded$','getUndoRedoMutationParamsCache','_initResize','USER_NOT_FOUND','getViewport','11980647ncRWpl','_collabCursorState$','AWAITING','_draw','clipPath','16560981ifYFQc','now','No\x20unitID\x20or\x20type\x20in\x20URL.\x20Will\x20not\x20load\x20files\x20from\x20remote\x20address.','ENTITLE_REPORT_LIMIT_EXCEED','cursorInfo','http://www.w3.org/2000/svg','PERMISSION_DENIED','_setupBeforeClosingHandler','symbol','getUniverSheetInstance','cursorInfo$','map','body','currentColor','_clearPolling','_lastResponseTimestamp','ENSURE_SNAPSHOT_EXECUTION','endRow','TOO_MANY_REQUESTS','post','getMember','EMAIL_HAS_BEEN_BOUND','eventID','COMPLETION_FINISHED','actions','ENTITLE_CHAT_LIMIT_EXCEED','_maxFormulaLimit','set','_transformHistoryAndStateStack','max','CONFLICT','_getSessionTicket','random','setStateCache','startRow','currentUsage','purple.300','SUBMIT_CHANGESET_TIMEOUT','getVpScrollXYInfoByPosToVp','UPDATE_CURSOR','from','addObject','_createSocketURL','Unknown\x20user','uni.network.url-service','LICENSE_MAX_UNITS_EXCEEDED','YUUMI_SUBSCRIPTION_NOT_FOUND','triggerDblclick','UNDEFINED','history','_revisionService','_color','exhaustSavingTask','OFFLINE','_shapes','NOT_FOUND','focused$','unload','_startCalculationLimit','_send','collaboration-client-ui.config','text','_currentUsage','_checkCalculationAvailable','ENTITLE_INSUFFICIENT_QUOTA','unshift','SNAPSHOT_INVALID_SNAPSHOT','xlink:href','[RemoteUniscriptService]:\x20no\x20focused\x20unit','DeleteRangeMoveLeftCommandId','_anchor','loadOfflineData','_commandService','getUnhiddenWorksheets','getActiveSheet','_range','registerBeforeClose','_initStatusComponent','_name','has','_transformPreviousActiveRange','on-line-icon','_notificationService','InsertRangeMoveDownCommandId','with','fill','color','asObservable','endColumn','ALREADY_EXISTS','_memberService','session.will-retry','complete','MOBILE_VERIFY_CODE_NOT_FOUND_OR_EXPIRED','roomMembers','moveTo','searchParams','_docClipboardService','REDEMPTION_INVALID_CODE','path','getStateCache','_clearOtherTimers','_instanceService','_registerRenderDependencies','UNRECOGNIZED','red.300','INTERNAL_ERROR','stringify','currentSkeleton$','height','_toggleOnline','_docSkeletonManagerService','getRenderById','contains','_getSaveTimeout','REDEMPTION_USER_REDEEM_TIMES_EXCEED','_taskIds','permission.content','_docTransformIMECacheService','collabCursorState$','transformStateCache','Warning','2458422iifuyW','evenodd','REDEMPTION_CODE_HAS_BEEN_CREATED','getFocusedUnit','range','_initStatusListener','_status$','...','defineProperty','_hasFormulaInDirtyRanges','displayName','ENTITLE_NEED_BILLING_ADDRESS','getSheetBySheetId','univer-text-sm\x20univer-leading-8\x20univer-text-gray-600\x20dark:!univer-text-gray-200','_urlService','LOGIN_TOKEN_PROCESSING_FAILED','LICENSE_DISTRO_REJECTED','editingUnit','parse','PAYMENT_CHANNEL_NOT_SUPPORT','getAncestorScale','getItem','getUnitStatus$','USER_IS_ANONYMOUS','findNodePositionByCharIndex','collab-text-range-','off-line-icon','delete','START_CALCULATION','toRgbString','string','YUUMI_ASYNCIO_CANCELLED','_saveTaskMap','limitInfo','_docTransformSelectionsService','_entityInit$','onTransformChange$','getMergeData','_toggleOffline','onPointerLeave$','OffLineIcon','InsertRowCommandId','getDocRanges','1em','runId','sheetId','EMAIL_VERIFY_CODE_MISMATCH','collabStatus.notCollab','_drawRectRange','No\x20remote\x20instance\x20service\x20injected.\x20May\x20not\x20syncing\x20edits\x20to\x20the\x20web\x20worker.','saveImage','event$','parseInt','collaboration.closeRoom','_hovered','LICENSE_MAX_MEMBERS_PER_UNIT_EXCEEDED','YUUMI_URL_COL_OUT_OF_RANGE','white','_anchorDot','functionsExecutedState','_sheetSkeletonManagerService','error','green.600','ERROR_AGAIN','registerRefRange','rgba(255,\x20255,\x20255,\x200.01)','resize','[CollaborationDataLoaderController]','REDEMPTION_USER_NOT_ELIGIBLE','_messageService','deepClone','TEXT','_updateLocalCursor','memberID','/run/','startColumn','_getFormulaLimitStatus','_refreshCollabCursors','measureText','_imageIoService','transformIMECache','imageSourceType','setItem','_assignedColors','46ZqNAJu','registerRenderModule','_syncEditingCollabCursorService','_removeCollabCursors','_initCommandInterceptor','InsertRangeMoveRightCommandId','undoState','_initEntityListener','status$','USER_NOT_INVITED_CODE','clearTimeout','USERS_LEAVE','_session','APPLY_DUPLICATED','enableLocalCache','_cursors','source','_handleLeaveEvent','drawWith','find','fillStyle','_scheduleClearOtherTimer','getCurrentRevOfUnit','pipe','REDEMPTION_CODE_FULLY_REDEEMED','DATA_SOURCE_TOO_LARGE','INVITE_CODE_HAS_BEEN_UES','INVITE_CODE_REQUIRED','idSuffix','setParam','APPLY_REVISION_CONFILICT','setActiveRange','_scheduleHeartbeat','subscribe','_entities','length','getCellMatrix','_heartbeatTimer','unsubscribe','collaboration.single-unit.warning','getColorFromTheme','_hover','_eventUnsubscribe','LOGIN_FAILED','getCollabEntity$','fillText','result','hide','SOCKET_FAILED','split','bold\x2013px\x20Source\x20Han\x20Sans\x20CN','dispose','replace','_ensureSubject','_initCommandExecutedListener','getCollabCursors$','top','subscribeEvent','disableLocalCache','collabStatus.fetchMiss','current','_drawAnchor','isActive','getTypeOfUnitDisposed$','/universer-api/license/formula/limit/done','transformMutation','RemoveColCommandId','startsWith','all','_scheduleSaving','YUUMI_UNABLE_LOAD_URL','OnLineIcon','mutations','key','_colorIndex','UNIVER_DOC','_cachedData','unitId','APPLY_PERMISSION_DENIED','_updateCollabCursors','_handleEvent','REDEMPTION_CODE_INACTIVE','syncEditingCollabCursor','_releaseCalculationLimit','_id','ENTITLE_DUP_SUBSCRIPTION','getRangePointData','isArray','onCommandExecuted','params','SNAPSHOT_HAS_BEEN_REMOVED','_collabCursorController','_startDocCollabCursor','_initEvent','jiqing.500','_renderManagerService','location','SOCKET_FAILED_RETRY','4844406HZHvop','collab-rect-range-','get','colorChannel1','bottom','UniverIcon','INVITE_CODE_ALREADY_BOUND','executeCommand','toString','popstate','UNAUTHENTICATED','univer-mr-2\x20univer-flex\x20univer-text-xl','unitID','dispose$','_transformService','_getScale','forEach','YUUMI_TABLE_NOT_FOUND_IN_UNIT','url(#$1','sessionTicket','replaceState','YUUMI_ALL_TABLES_IS_INVALID','debug','textRanges','ACTIVE_UNIT_EVENT_CHANNEL','add','off-line-icon_clip0_910_343','AWAITING_WITH_PENDING','1080712qURqAB','onLocalMutation','urlChange$','OTHER_CLIENT_EDITING','newValue','defIds','getMemberID','_document','_updateURLWithCurrentState','assignAColorForMemberID','doc.mutation.rich-text-editing','formula.calculation.unable','setConfig','CHANGESET_REVISION_CONFILICT','_collaborationController','addObjects','_logService','0\x200\x2016\x2016','collaboration-client.offline-data-not-saved','_cursorInfo$','font','JOIN_ROOM_FAILED','_lastPointer','currentTheme$','use','black','ticket','6150hYtdkP','_roomMembers$','WECHAT_HAS_BEEN_BOUND','REDEMPTION_CODE_NOT_STARTED','assign','on-line-icon_clip0_910_349','_getSheetObject','SUCCESS','width','_handleHeartbeatEvent','YUUMI_CONNECTOR_URL_NOT_FOUND','setShapeProps','url(#off-line-icon_clip0_910_343)','collabStatus.synced','selection','onStarting','row','href','size','#FFF','getValue','div','_render','getSheetId','M4.5865\x2011.6499C3.36983\x2011.6499\x201.6665\x2011.1024\x201.6665\x208.9124C1.6665\x206.3574\x204.2215\x205.8099\x204.9515\x205.8099C5.3165\x204.5324\x206.0465\x202.5249\x208.9665\x202.5249C11.5215\x202.5249\x2012.6165\x203.9849\x2012.9815\x205.2624C12.9815\x205.2624\x2016.2665\x205.6274\x2016.2665\x208.7299C16.2665\x2010.9199\x2014.8065\x2011.6499\x2013.3465\x2011.6499M6.7767\x2011.6497L8.9667\x2013.4747L11.8867\x209.82466','_localStorageService','yellow.400','then','_docSkeleton','transformRemoteChangeset','init','UNIVER_SHEET','APPLY_NON_SEQUENTIAL_REVISION','requireSession','getCurrent','_cursorShapes','_labelPosition','5692bNXfOa','getformulaLimitStatusUrl','collabStatus.conflict','ENTITLE_CAN_NOT_BUY_LOWER_OTP','_getMergeRange','_cursor','round','OTHER_CLIENTS_EDITING','roomMembers$','lineTo','NOT_COLLAB','_removeClearOtherTimer','_collaborationUIEventService','_saveCache','ranges','MOBILE_HAS_BEEN_BOUND','_pollingInterval','_selfUnitIDs','substring','_initDependencies','save','_getAnchorBounding','_applyCommand','_onCursorUpdate','onMouseMove','backgroundColor','entityInit$','getConfig','_transformUndoRedoStack'];_0x3e21=function(){return _0x21ba94;};return _0x3e21();}import{SetWorksheetActivateCommand as _0x215bad,RefRangeService as _0x5209f7,SetSelectionsOperation as _0x3056ea,SheetsSelectionsService as _0x24db11,EffectRefRangId as _0xf3fab0,handleIRemoveRow as _0x21a663,handleIRemoveCol as _0x1022dc,handleMoveRange as _0x2608d9,handleInsertRow as _0x56146d,handleInsertRangeMoveRight as _0x584b59,handleInsertRangeMoveDown as _0x4d3e7e,handleInsertCol as _0x290ffe,handleDeleteRangeMoveUp as _0x2e997c,handleDeleteRangeMoveLeft as _0x97d872,runRefRangeMutations as _0x20f653}from'@univerjs/sheets';import{Shape as _0x25671b,Rect as _0x142093,getColor as _0x42d178,RegularPolygon as _0x22b481,TRANSFORM_CHANGE_OBSERVABLE_TYPE as _0xbe7e54,Vector2 as _0x33ba3b,SHEET_VIEWPORT_KEY as _0x17f0a0,IRenderManagerService as _0x570600}from'@univerjs/engine-render';import{HTTPService as _0x393f45,ISocketService as _0x246f47,WebSocketService as _0x55d60d}from'@univerjs/network';import{IDocClipboardService as _0x2dc347,NodePositionConvertToCursor as _0x2fc324,NodePositionConvertToRectRange as _0x5ac8cc,TEXT_RANGE_LAYER_INDEX as _0x28c7e0,SetDocZoomRatioOperation as _0x4ab8a,DocIMEInputManagerService as _0x484600,DocStateChangeManagerService as _0x3a3fe8}from'@univerjs/docs-ui';import{IImageIoService as _0x39e57f}from'@univerjs/drawing';import{ITransformService as _0x415fde,CollaborationEvent as _0x487dcc,isTransformMutationFailure as _0x1ec519,isTransformMutationsWithChangesetSuccess as _0x329f62,RevisionService as _0x173db1,ISnapshotServerService as _0x142a0a}from'@univerjs-pro/collaboration';import{SetTextSelectionsOperation as _0x1f9d04,RichTextEditingMutation as _0x39cfac,DocSelectionManagerService as _0x527b66,DocSkeletonManagerService as _0x539b7a}from'@univerjs/docs';import{deserializeRangeWithSheet as _0x12eb24,serializeRangeWithSheet as _0x411a0e,FormulaExecuteStageType as _0x5be4ae,FormulaExecutedStateType as _0x238118,SetFormulaCalculationStartMutation as _0x5d708a,SetFormulaCalculationNotificationMutation as _0x51ab39}from'@univerjs/engine-formula';import{map as _0x38693b,filter as _0x22f0e8,throttleTime as _0x3fdcb7,takeUntil as _0x23d9d8,switchMap as _0x56d5c4}from'rxjs/operators';import{SheetSkeletonManagerService as _0x1426e2,getCoordByCell as _0x36424e,getSheetObject as _0x246268}from'@univerjs/sheets-ui';function Ve({ref:_0x22d4c9,..._0x3ad316}){const _0x3656d5=_0x59d238,{icon:_0x304a0e,id:_0x416805,className:_0x1361d2,extend:_0x21d643,..._0x3cc475}=_0x3ad316,_0x35eeac=('univerjs-icon\x20univerjs-icon-'+_0x416805+'\x20'+(_0x1361d2||''))['trim'](),_0xc4c451=_0x2c8075('_'+gi());return Ut(_0x304a0e,''+_0x416805,{'defIds':_0x304a0e[_0x3656d5(0x1d3)],'idSuffix':_0xc4c451[_0x3656d5(0x18c)]},{'ref':_0x22d4c9,'className':_0x35eeac,..._0x3cc475},_0x21d643);}function Ut(_0x272e95,_0x39a164,_0x39754c,_0x522c69,_0xce846f){const _0x4ae7dd=_0x59d238;return _0x375fa2(_0x272e95[_0x4ae7dd(0x264)],{'key':_0x39a164,...mi(_0x272e95,_0x39754c,_0xce846f),..._0x522c69},(fi(_0x272e95,_0x39754c)[_0x4ae7dd(0x278)]||[])[_0x4ae7dd(0x2c7)]((_0x524e1f,_0x31f17b)=>Ut(_0x524e1f,_0x39a164+'-'+_0x272e95[_0x4ae7dd(0x264)]+'-'+_0x31f17b,_0x39754c,void 0x0,_0xce846f)));}function mi(_0x347158,_0x15b497,_0x5c785d){const _0x1d8b6b=_0x59d238,_0x3427bf={..._0x347158[_0x1d8b6b(0x285)]};_0x5c785d!=null&&_0x5c785d['colorChannel1']&&_0x3427bf[_0x1d8b6b(0x311)]===_0x1d8b6b(0x1b5)&&(_0x3427bf[_0x1d8b6b(0x311)]=_0x5c785d[_0x1d8b6b(0x1b5)]),_0x347158[_0x1d8b6b(0x264)]===_0x1d8b6b(0x2a1)&&_0x3427bf['id']&&(_0x3427bf['id']=_0x3427bf['id']+_0x15b497['idSuffix']),Object[_0x1d8b6b(0x23e)](_0x3427bf)[_0x1d8b6b(0x1c2)](([_0x2b5453,_0x2a90df])=>{const _0x4217f3=_0x1d8b6b;_0x2b5453==='mask'&&typeof _0x2a90df==_0x4217f3(0x354)&&(_0x3427bf[_0x2b5453]=_0x2a90df[_0x4217f3(0x184)](/url\(#(.*)\)/,_0x4217f3(0x1c4)+_0x15b497['idSuffix']+')'));});const {defIds:_0xe0fb15}=_0x15b497;return!_0xe0fb15||_0xe0fb15[_0x1d8b6b(0x173)]===0x0||(_0x347158[_0x1d8b6b(0x264)]===_0x1d8b6b(0x1e6)&&_0x3427bf[_0x1d8b6b(0x2ff)]&&(_0x3427bf['xlink:href']=_0x3427bf[_0x1d8b6b(0x2ff)]+_0x15b497[_0x1d8b6b(0x16c)]),Object[_0x1d8b6b(0x23e)](_0x3427bf)[_0x1d8b6b(0x1c2)](([_0x2cf1df,_0x8a6e4b])=>{const _0x277774=_0x1d8b6b;typeof _0x8a6e4b==_0x277774(0x354)&&(_0x3427bf[_0x2cf1df]=_0x8a6e4b[_0x277774(0x184)](/url\(#(.*)\)/,_0x277774(0x1c4)+_0x15b497[_0x277774(0x16c)]+')'));})),_0x3427bf;}function fi(_0x551d0e,_0x1f8859){const _0x1c6fc7=_0x59d238;var _0x225e00;const {defIds:_0x22f297}=_0x1f8859;return!_0x22f297||_0x22f297[_0x1c6fc7(0x173)]===0x0?_0x551d0e:_0x551d0e[_0x1c6fc7(0x264)]==='defs'&&((_0x225e00=_0x551d0e[_0x1c6fc7(0x278)])!=null&&_0x225e00[_0x1c6fc7(0x173)])?{..._0x551d0e,'children':_0x551d0e['children'][_0x1c6fc7(0x2c7)](_0x355b42=>typeof _0x355b42[_0x1c6fc7(0x285)]['id']==_0x1c6fc7(0x354)&&_0x22f297&&_0x22f297[_0x1c6fc7(0x27d)](_0x355b42[_0x1c6fc7(0x285)]['id'])?{..._0x355b42,'attrs':{..._0x355b42[_0x1c6fc7(0x285)],'id':_0x355b42[_0x1c6fc7(0x285)]['id']+_0x1f8859[_0x1c6fc7(0x16c)]}}:_0x355b42)}:_0x551d0e;}function gi(){const _0x5c6e6d=_0x59d238;return Math[_0x5c6e6d(0x2dc)]()['toString'](0x24)[_0x5c6e6d(0x220)](0x2,0x8);}Ve[_0x59d238(0x340)]=_0x59d238(0x1b7);const vi={'tag':'svg','attrs':{'xmlns':_0x59d238(0x2c1),'fill':'none','viewBox':_0x59d238(0x1df),'width':_0x59d238(0x361),'height':'1em'},'children':[{'tag':'g','attrs':{'clipPath':_0x59d238(0x1f5)},'children':[{'tag':'path','attrs':{'stroke':_0x59d238(0x2c9),'d':'M3.61971\x2011.6499C2.40304\x2011.6499\x200.699707\x2011.1024\x200.699707\x208.9124C0.699707\x206.3574\x203.25471\x205.8099\x203.98471\x205.8099C4.34971\x204.5324\x205.07971\x202.5249\x207.99971\x202.5249C10.5547\x202.5249\x2011.6497\x203.9849\x2012.0147\x205.2624C12.0147\x205.2624\x2015.2997\x205.6274\x2015.2997\x208.7299C15.2997\x2010.9199\x2013.8397\x2011.6499\x2012.3797\x2011.6499M9.82471\x209.82466L6.17471\x2013.4747M6.17471\x209.82466L9.82471\x2013.4747','strokeLinecap':_0x59d238(0x214),'strokeLinejoin':_0x59d238(0x214),'strokeWidth':1.2}}]},{'tag':_0x59d238(0x2ac),'attrs':{},'children':[{'tag':'clipPath','attrs':{'id':_0x59d238(0x1cc)},'children':[{'tag':_0x59d238(0x31f),'attrs':{'fill':_0x59d238(0x36f),'d':_0x59d238(0x271)}}]}]}],'defIds':[_0x59d238(0x1cc)]},Lt=_0x32d41e(function(_0x33511d,_0x1a5fe7){const _0x229fe=_0x59d238;return _0x375fa2(Ve,Object[_0x229fe(0x1ed)]({},_0x33511d,{'id':_0x229fe(0x350),'ref':_0x1a5fe7,'icon':vi}));});Lt[_0x59d238(0x340)]=_0x59d238(0x35e);const Ei={'tag':'svg','attrs':{'xmlns':_0x59d238(0x2c1),'fill':_0x59d238(0x25f),'viewBox':_0x59d238(0x245),'width':_0x59d238(0x361),'height':_0x59d238(0x361)},'children':[{'tag':'g','attrs':{'clipPath':_0x59d238(0x294)},'children':[{'tag':_0x59d238(0x31f),'attrs':{'stroke':_0x59d238(0x2c9),'d':_0x59d238(0x201),'strokeLinecap':_0x59d238(0x214),'strokeLinejoin':_0x59d238(0x214),'strokeWidth':1.2}}]},{'tag':_0x59d238(0x2ac),'attrs':{},'children':[{'tag':_0x59d238(0x2bb),'attrs':{'id':_0x59d238(0x1ee)},'children':[{'tag':_0x59d238(0x31f),'attrs':{'fill':_0x59d238(0x36f),'d':_0x59d238(0x271),'transform':'translate(.97)'}}]}]}],'defIds':[_0x59d238(0x1ee)]},Mt=_0x32d41e(function(_0x31076e,_0x2f409b){const _0x36f150=_0x59d238;return _0x375fa2(Ve,Object[_0x36f150(0x1ed)]({},_0x31076e,{'id':_0x36f150(0x30d),'ref':_0x2f409b,'icon':Ei}));});Mt[_0x59d238(0x340)]=_0x59d238(0x197);function pi(_0x45f6e3){const _0x24b770=_0x59d238;switch(_0x45f6e3){case _0x2dbbe4[_0x24b770(0x2f1)]:return'collabStatus.offline';case _0x2dbbe4[_0x24b770(0x2da)]:return _0x24b770(0x210);case _0x2dbbe4[_0x24b770(0x255)]:return _0x24b770(0x18b);case _0x2dbbe4['NOT_COLLAB']:return _0x24b770(0x365);case _0x2dbbe4[_0x24b770(0x2b9)]:case _0x2dbbe4[_0x24b770(0x1cd)]:return'collabStatus.syncing';case _0x2dbbe4[_0x24b770(0x23d)]:case _0x2dbbe4['PENDING']:return _0x24b770(0x1f6);}}function Oi(_0x2d7248){const _0x553e64=_0x59d238,{status$:_0x6aa93f}=_0x2d7248,_0x3e1fdb=_0x4a4308(_0x6aa93f,_0x2dbbe4[_0x553e64(0x218)]),_0x1e3408=_0x3f9337(_0x36a5ba),_0x4cec22=_0x3f9337(_0x1917eb),_0x45a4f3=_0x3e1fdb!==_0x2dbbe4['OFFLINE'],_0x4ffbf4=_0x1e3408['t'](pi(_0x3e1fdb)),_0x10909c=_0x45a4f3?_0x5601e7(Mt,{}):_0x5601e7(Lt,{}),_0xc10134=_0x5e2164(()=>{_0x45a4f3||_0x4cec22['reconnect']();},[_0x45a4f3,_0x4cec22]);function _0x5d858f(){const _0x22f7f6=_0x553e64;return _0x4620e7(_0x22f7f6(0x1fe),{'className':_0x22f7f6(0x22c),'onClick':_0xc10134,'children':[_0x5601e7(_0x22f7f6(0x1fe),{'className':_0x3e0c4c(_0x22f7f6(0x1bd),{'univer-text-green-500':_0x45a4f3,'univer-text-red-500':!_0x45a4f3}),'children':_0x10909c}),_0x5601e7('div',{'className':_0x22f7f6(0x343),'children':_0x4ffbf4})]});}return _0x45a4f3?_0x5d858f():_0x5601e7(_0x168c4e,{'title':_0x1e3408['t'](_0x553e64(0x2a0)),'children':_0x5d858f()});}var Ti=Object[_0x59d238(0x29e)],Ci=(_0x5adba9,_0x1cbb72,_0x3eb8fb,_0x18cc92)=>{const _0x3e37ee=_0x59d238;for(var _0x4dac33=_0x18cc92>0x1?void 0x0:_0x18cc92?Ti(_0x1cbb72,_0x3eb8fb):_0x1cbb72,_0x242d87=_0x5adba9[_0x3e37ee(0x173)]-0x1,_0x3e72f4;_0x242d87>=0x0;_0x242d87--)(_0x3e72f4=_0x5adba9[_0x242d87])&&(_0x4dac33=_0x3e72f4(_0x4dac33)||_0x4dac33);return _0x4dac33;},se=(_0x933da7,_0x3b0d91)=>(_0x4845fc,_0x1c84c4)=>_0x3b0d91(_0x4845fc,_0x1c84c4,_0x933da7);let oe=class extends _0x4c1835{constructor(_0x2bfc49,_0x1866fe,_0x181d82,_0x2654e1){const _0x407157=_0x59d238;super(),l(this,_0x407157(0x33c),new _0x7b2298(_0x2dbbe4[_0x407157(0x218)])),(this[_0x407157(0x284)]=_0x2bfc49,this[_0x407157(0x23b)]=_0x1866fe,this['_collaborationController']=_0x181d82,this['_uiPartsService']=_0x2654e1,this[_0x407157(0x309)](),this['_initStatusListener']());}[_0x59d238(0x33b)](){const _0x22f485=_0x59d238;this[_0x22f485(0x26d)](this[_0x22f485(0x284)][_0x22f485(0x2f4)][_0x22f485(0x167)](_0x42f9ae(()=>{const _0x2d24a5=_0x22f485,_0x7413e=this[_0x2d24a5(0x284)]['getFocusedUnit']();return _0x7413e?this[_0x2d24a5(0x1dc)][_0x2d24a5(0x17c)](_0x7413e['getUnitId']()):_0x5bbcb9(null);}),_0x42f9ae(_0xbed8d8=>_0xbed8d8?_0xbed8d8[_0x22f485(0x392)]:_0x5bbcb9(_0x2dbbe4[_0x22f485(0x218)])))[_0x22f485(0x171)](_0x4de1cb=>{const _0x58bd6c=_0x22f485;this[_0x58bd6c(0x33c)]['next'](_0x4de1cb);}));}[_0x59d238(0x309)](){const _0x3d6f96=_0x59d238;this[_0x3d6f96(0x26d)](this['_uiPartsService']['registerComponent'](_0x3eebab['HEADER_MENU'],()=>_0x407494(Ri({'status$':this[_0x3d6f96(0x33c)]['asObservable']()}),this[_0x3d6f96(0x23b)])));}};oe=Ci([se(0x0,_0x21d94f),se(0x1,_0x43bd7d(_0x504c4c)),se(0x2,_0x43bd7d(_0x48b193)),se(0x3,_0x463040)],oe);function Ri(_0x2f4207){const {status$:_0x390b7d}=_0x2f4207;return function(){return _0x5601e7(Oi,{'status$':_0x390b7d});};}const At=_0x1f7b04(_0x59d238(0x2e8));var Di=Object['getOwnPropertyDescriptor'],Ni=(_0x1adbb8,_0x5e51d0,_0x43488a,_0x4edde9)=>{const _0x2ca2d7=_0x59d238;for(var _0x103b61=_0x4edde9>0x1?void 0x0:_0x4edde9?Di(_0x5e51d0,_0x43488a):_0x5e51d0,_0x585b22=_0x1adbb8[_0x2ca2d7(0x173)]-0x1,_0x3dc63;_0x585b22>=0x0;_0x585b22--)(_0x3dc63=_0x1adbb8[_0x585b22])&&(_0x103b61=_0x3dc63(_0x103b61)||_0x103b61);return _0x103b61;},K=(_0x5680a8,_0x39ba6e)=>(_0x36f8e8,_0x480914)=>_0x39ba6e(_0x36f8e8,_0x480914,_0x5680a8);let ae=class extends _0x5e1dde{constructor(_0x3788e3,_0x43adff,_0x28cbed,_0x418279,_0x42d607){const _0x361f56=_0x59d238;super(),this['_urlService']=_0x3788e3,this['_logService']=_0x43adff,this[_0x361f56(0x304)]=_0x28cbed,this['_dataLoaderService']=_0x418279,_0x42d607?_0x42d607==null||_0x42d607[_0x361f56(0x292)]()['then'](()=>this[_0x361f56(0x254)]()):(this[_0x361f56(0x1de)][_0x361f56(0x1c8)](_0x361f56(0x379),_0x361f56(0x367)),this[_0x361f56(0x254)]());}async[_0x59d238(0x254)](){const _0x3ed8fb=_0x59d238,_0x5c8e57=this[_0x3ed8fb(0x344)][_0x3ed8fb(0x242)](_0x3ed8fb(0x23f)),_0x4864b9=this['_urlService'][_0x3ed8fb(0x242)](_0x3ed8fb(0x22d)),_0x17e89c=this[_0x3ed8fb(0x344)][_0x3ed8fb(0x242)](_0x3ed8fb(0x260));if(!_0x5c8e57||!_0x4864b9){this['_logService'][_0x3ed8fb(0x1c8)](_0x3ed8fb(0x379),_0x3ed8fb(0x2be));return;}const _0x3d84ef=await this[_0x3ed8fb(0x244)]['loadUnit'](_0x5c8e57,Number(_0x4864b9),_0x17e89c);_0x3d84ef&&_0x3d84ef instanceof _0x31f29e&&this[_0x3ed8fb(0x2a7)](_0x3d84ef);}async[_0x59d238(0x2a7)](_0x56d170){const _0x45a082=_0x59d238;await this['_updateSubUnitFromURLParams'](_0x56d170),_0x56d170['activeSheet$'][_0x45a082(0x167)](_0x2d5638(this[_0x45a082(0x1bf)]))[_0x45a082(0x171)](_0xd9e2dc=>{const _0x5cff6c=_0x45a082;_0xd9e2dc&&this[_0x5cff6c(0x1d6)](_0xd9e2dc);}),this[_0x45a082(0x344)]['urlChange$'][_0x45a082(0x167)](_0x2d5638(this[_0x45a082(0x1bf)]))[_0x45a082(0x171)](()=>this[_0x45a082(0x239)](_0x56d170));}[_0x59d238(0x1d6)](_0x445057,_0x24e08e=!0x1){const _0x2689c7=_0x59d238,_0x5db2f6=this[_0x2689c7(0x344)][_0x2689c7(0x242)]('subunit');_0x445057[_0x2689c7(0x200)]()!==_0x5db2f6&&this[_0x2689c7(0x344)][_0x2689c7(0x16d)](_0x2689c7(0x260),_0x445057[_0x2689c7(0x200)](),_0x24e08e);}async['_updateSubUnitFromURLParams'](_0x4e0b93){const _0x2e4a4e=_0x59d238;var _0x1e4088;const _0x363aeb=this[_0x2e4a4e(0x344)][_0x2e4a4e(0x242)](_0x2e4a4e(0x260));if(!_0x363aeb||!_0x4e0b93[_0x2e4a4e(0x342)](_0x363aeb)){const _0x3cd920=_0x4e0b93[_0x2e4a4e(0x305)]()[0x0],_0x519861=_0x4e0b93[_0x2e4a4e(0x342)](_0x3cd920);if(!_0x519861)return;this['_updateURLWithCurrentState'](_0x519861,!0x0),await this['_commandService'][_0x2e4a4e(0x1b9)](_0x215bad['id'],{'unitId':_0x4e0b93['getUnitId'](),'subUnitId':_0x3cd920});return;}((_0x1e4088=_0x4e0b93[_0x2e4a4e(0x306)]())==null?void 0x0:_0x1e4088[_0x2e4a4e(0x200)]())!==_0x363aeb&&await this[_0x2e4a4e(0x304)][_0x2e4a4e(0x1b9)](_0x215bad['id'],{'unitId':_0x4e0b93[_0x2e4a4e(0x2a3)](),'subUnitId':_0x363aeb});}};ae=Ni([K(0x0,At),K(0x1,_0x5be773),K(0x2,_0x831c33),K(0x3,_0x43bd7d(_0x3e2b55)),K(0x4,_0x4d1e28(_0xa99a92))],ae);var bi=Object[_0x59d238(0x29e)],Ui=(_0xdd8d31,_0x53270a,_0xaf63d0,_0xc7eb83)=>{const _0x3271ba=_0x59d238;for(var _0x4b298c=_0xc7eb83>0x1?void 0x0:_0xc7eb83?bi(_0x53270a,_0xaf63d0):_0x53270a,_0x5735f2=_0xdd8d31[_0x3271ba(0x173)]-0x1,_0x23fef6;_0x5735f2>=0x0;_0x5735f2--)(_0x23fef6=_0xdd8d31[_0x5735f2])&&(_0x4b298c=_0x23fef6(_0x4b298c)||_0x4b298c);return _0x4b298c;},tt=(_0x2d6ab4,_0x772101)=>(_0x5976cb,_0x212564)=>_0x772101(_0x5976cb,_0x212564,_0x2d6ab4);function _0x6a51(_0x820361,_0x2695ee){const _0x3e21be=_0x3e21();return _0x6a51=function(_0x6a5188,_0x455bf7){_0x6a5188=_0x6a5188-0x162;let _0x4cd062=_0x3e21be[_0x6a5188];return _0x4cd062;},_0x6a51(_0x820361,_0x2695ee);}let Ae=class extends _0x5e1dde{constructor(_0x4f9a29,_0x3e7e31){const _0x514683=_0x59d238;super(),this[_0x514683(0x31d)]=_0x4f9a29,this[_0x514683(0x385)]=_0x3e7e31,this['_init']();}[_0x59d238(0x254)](){const _0x3f0d25=_0x59d238,_0x52ea2c=this;this[_0x3f0d25(0x26d)](this[_0x3f0d25(0x31d)]['addClipboardHook']({'onBeforePasteImage':async _0x4b1336=>{const _0x4c2abb=_0x3f0d25,_0x1e27e0=await _0x52ea2c[_0x4c2abb(0x385)][_0x4c2abb(0x368)](_0x4b1336);return _0x1e27e0?{'source':_0x1e27e0[_0x4c2abb(0x39a)],'imageSourceType':_0x1e27e0[_0x4c2abb(0x387)]}:null;}}));}};Ae=Ui([tt(0x0,_0x2dc347),tt(0x1,_0x39e57f)],Ae);const st=[_0x59d238(0x2e0),_0x59d238(0x1ae),_0x59d238(0x374),_0x59d238(0x325),_0x59d238(0x268),_0x59d238(0x203)];class je extends _0x4c1835{constructor(){const _0x5908d8=_0x59d238;super(...arguments),l(this,_0x5908d8(0x389),new Map()),l(this,_0x5908d8(0x19a),0x0);}[_0x59d238(0x1d7)](_0x4f5eca){const _0x26fc97=_0x59d238;if(this[_0x26fc97(0x389)][_0x26fc97(0x30b)](_0x4f5eca))return this[_0x26fc97(0x389)][_0x26fc97(0x1b4)](_0x4f5eca);const _0x38d09e=st[this[_0x26fc97(0x19a)]];return this[_0x26fc97(0x19a)]=(this['_colorIndex']+0x1)%st[_0x26fc97(0x173)],this[_0x26fc97(0x389)][_0x26fc97(0x2d7)](_0x4f5eca,_0x38d09e),_0x38d09e;}}function Pt(_0x10684f){const _0x8fca39=_0x59d238;let _0xdd43a1='';for(const _0x1cd55b of _0x10684f){const {startOffset:_0x4df6a6,endOffset:_0x3c7d49,isActive:_0x3fa7b9,rangeType:_0x23e361,segmentId:_0x88a194,segmentPage:_0x3ea36c}=_0x1cd55b;_0xdd43a1[_0x8fca39(0x173)]&&(_0xdd43a1+=','),_0xdd43a1+=_0x4df6a6+':'+_0x3c7d49+':'+(_0x3fa7b9?'1':'0')+':'+_0x23e361+':'+_0x88a194+':'+_0x3ea36c;}return _0xdd43a1;}function Li(_0x52afbf){const _0x580b49=_0x59d238,_0xb004a0=_0x52afbf[_0x580b49(0x181)](','),_0x2e78c0=[];for(const _0x3d0ad8 of _0xb004a0){const [_0xba9250,_0x5ea6d8,_0x4271fa,_0x4185fa,_0x1fa31c,_0x4b7705]=_0x3d0ad8[_0x580b49(0x181)](':');_0x2e78c0[_0x580b49(0x235)]({'startOffset':Number(_0xba9250),'endOffset':Number(_0x5ea6d8),'collapsed':_0xba9250===_0x5ea6d8,'isActive':_0x4271fa==='1','rangeType':_0x4185fa===_0x3ea76e[_0x580b49(0x37d)]?_0x3ea76e[_0x580b49(0x37d)]:_0x3ea76e[_0x580b49(0x22e)],'segmentId':typeof _0x1fa31c==_0x580b49(0x354)?String(_0x1fa31c):'','segmentPage':Number(_0x4b7705!=null?_0x4b7705:-0x1)});}return _0x2e78c0['some'](_0x132f4f=>_0x132f4f[_0x580b49(0x18e)])||(_0x2e78c0[0x0][_0x580b49(0x18e)]=!0x0),_0x2e78c0;}class Xe extends _0x5e1dde{constructor(){const _0x3f0847=_0x59d238;super(...arguments),l(this,_0x3f0847(0x2b8),new _0x7b2298(null)),l(this,'collabCursorState$',this['_collabCursorState$'][_0x3f0847(0x313)]());}[_0x59d238(0x1a2)](_0x9b54ac){const _0xf01caf=_0x59d238,{unitID:_0x336c5c,memberID:_0x435840,textRanges:_0x1cf86e}=_0x9b54ac,_0x5459dc=Pt(_0x1cf86e);if(_0x5459dc==='')return;const _0x541779={'unitID':_0x336c5c,'memberID':_0x435840,'selection':_0x5459dc};this[_0xf01caf(0x2b8)][_0xf01caf(0x27f)](_0x541779);}}var Mi=Object[_0x59d238(0x29e)],Ai=(_0x3d93e5,_0x324915,_0x539bd7,_0x23f26f)=>{const _0x18e8f3=_0x59d238;for(var _0xd7c54a=_0x23f26f>0x1?void 0x0:_0x23f26f?Mi(_0x324915,_0x539bd7):_0x324915,_0x51c38e=_0x3d93e5[_0x18e8f3(0x173)]-0x1,_0x976825;_0x51c38e>=0x0;_0x51c38e--)(_0x976825=_0x3d93e5[_0x51c38e])&&(_0xd7c54a=_0x976825(_0xd7c54a)||_0xd7c54a);return _0xd7c54a;},A=(_0x345b13,_0x24b315)=>(_0x2ce0c6,_0x45fd34)=>_0x24b315(_0x2ce0c6,_0x45fd34,_0x345b13);const Pi=0x12c,wi=0x64;let Pe=class extends _0x5e1dde{constructor(_0x142ddb,_0x4a11e1,_0x50f899,_0x492f02,_0x2a3cd8,_0x542a49,_0x42bf28,_0x1b791a,_0x3ae49a){const _0x59205a=_0x59d238;super(),l(this,'_online',!0x1),l(this,_0x59205a(0x254),!0x1),l(this,'_cursorInfo$',new _0x7b2298(new Map())),l(this,_0x59205a(0x2c6),this[_0x59205a(0x1e1)][_0x59205a(0x313)]()),l(this,_0x59205a(0x1ea),new _0x7b2298([])),l(this,_0x59205a(0x216),this[_0x59205a(0x1ea)][_0x59205a(0x167)](_0x380830(Pi))),l(this,'_updateLocalCursor',_0x86b54f(_0x25ba4e=>{const _0x13f2cd=_0x59205a,_0x23d351={'eventID':_0x487dcc[_0x13f2cd(0x2e3)],'data':{'unitID':this['unitID'],'memberID':this[_0x13f2cd(0x396)]['getMemberID'](),'selection':Pt(_0x25ba4e)}};this[_0x13f2cd(0x396)]['send'](_0x23d351,this[_0x13f2cd(0x1be)]);},wi)),(this[_0x59205a(0x1be)]=_0x142ddb,this[_0x59205a(0x396)]=_0x4a11e1,this[_0x59205a(0x23b)]=_0x50f899,this[_0x59205a(0x2a8)]=_0x492f02,this[_0x59205a(0x316)]=_0x2a3cd8,this[_0x59205a(0x38c)]=_0x542a49,this['_transformService']=_0x42bf28,this['_univerInstanceService']=_0x1b791a,this[_0x59205a(0x304)]=_0x3ae49a);}get[_0x59d238(0x2c0)](){const _0x26a1a2=_0x59d238;return this[_0x26a1a2(0x1e1)][_0x26a1a2(0x1fd)]();}get['roomMembers'](){const _0x57c156=_0x59d238;return this[_0x57c156(0x1ea)][_0x57c156(0x1fd)]();}[_0x59d238(0x183)](){const _0x3eb9ec=_0x59d238;super[_0x3eb9ec(0x183)](),this['_cursorInfo$'][_0x3eb9ec(0x27f)](new Map()),this[_0x3eb9ec(0x1e1)][_0x3eb9ec(0x318)](),this[_0x3eb9ec(0x1ea)]['next']([]),this[_0x3eb9ec(0x1ea)][_0x3eb9ec(0x318)]();}[_0x59d238(0x207)](){const _0x202e94=_0x59d238;this[_0x202e94(0x254)]||(this[_0x202e94(0x254)]=!0x0,this['_session'][_0x202e94(0x288)][_0x202e94(0x167)](_0x2d5638(this[_0x202e94(0x1bf)]))[_0x202e94(0x171)](_0xa7f918=>{const _0x3c5f52=_0x202e94;_0xa7f918===_0x3a98da[_0x3c5f52(0x280)]?this['_toggleOnline']():this[_0x3c5f52(0x35c)]();}),this['_session'][_0x202e94(0x369)]['pipe'](_0x2d5638(this[_0x202e94(0x1bf)]))[_0x202e94(0x171)](_0x159c40=>{const _0x5c2684=_0x202e94,_0x255988=_0x159c40[_0x5c2684(0x2d2)];_0x255988===_0x487dcc[_0x5c2684(0x2e3)]&&this[_0x5c2684(0x225)](_0x159c40),_0x255988===_0x487dcc['USERS_LEAVE']&&this[_0x5c2684(0x2aa)](_0x159c40);}),this['disposeWithMe'](this[_0x202e94(0x304)]['onCommandExecuted'](_0x3a8b89=>{const _0x5dfe27=_0x202e94,_0x579443=_0x3a8b89[_0x5dfe27(0x1a9)];_0x579443!=null&&this[_0x5dfe27(0x24c)]&&_0x3a8b89['id']===_0x1f9d04['id']&&_0x579443[_0x5dfe27(0x19d)]===this['unitID']&&_0x579443[_0x5dfe27(0x2a4)]===!0x1&&_0x579443[_0x5dfe27(0x21c)][_0x5dfe27(0x173)]>0x0&&this['_updateLocalCursor'](_0x579443[_0x5dfe27(0x21c)]);})),this[_0x202e94(0x38c)][_0x202e94(0x333)][_0x202e94(0x167)](_0x2d5638(this[_0x202e94(0x1bf)]))[_0x202e94(0x171)](_0x35fb5c=>{const _0x544af3=_0x202e94;if((_0x35fb5c==null?void 0x0:_0x35fb5c[_0x544af3(0x1be)])!==this[_0x544af3(0x1be)])return;const _0x42e26e={'eventID':_0x487dcc['UPDATE_CURSOR'],'data':_0x35fb5c};this[_0x544af3(0x225)](_0x42e26e);}),this[_0x202e94(0x26d)](this['_commandService'][_0x202e94(0x1a8)](_0x8c8515=>{const _0x5e2ee2=_0x202e94;if(_0x8c8515[_0x5e2ee2(0x1a9)]==null)return;const _0x5db050=_0x8c8515[_0x5e2ee2(0x1a9)];if(_0x8c8515['id']!==_0x39cfac['id']||_0x5db050['unitId']!==this[_0x5e2ee2(0x1be)])return;const _0x5a3a4c={'id':'doc.mutation.rich-text-editing','params':_0x5db050},_0x41807e=this['cursorInfo'];for(const [_0x40933d,_0x248cf2]of _0x41807e){const _0x214370={'id':_0x5e2ee2(0x1d8),'params':{'unitId':this[_0x5e2ee2(0x1be)],'actions':null,'textRanges':_0x248cf2[_0x5e2ee2(0x21c)]}},_0x3608f4=this[_0x5e2ee2(0x1c0)][_0x5e2ee2(0x191)](_0x5a3a4c,_0x214370,!0x1);if(_0x1ec519(_0x3608f4))throw _0x3608f4[_0x5e2ee2(0x373)];_0x41807e[_0x5e2ee2(0x2d7)](_0x40933d,{..._0x248cf2,'ranges':_0x3608f4[_0x5e2ee2(0x290)][_0x5e2ee2(0x1a9)]['textRanges']});}queueMicrotask(()=>{const _0x538a41=_0x5e2ee2;this[_0x538a41(0x1e1)][_0x538a41(0x27f)](_0x41807e);});})));}['_onCursorUpdate'](_0x7a05bc){const _0x356377=_0x59d238;var _0x182f8d,_0x346227;const {memberID:_0x300dad,selection:_0x6ffadd}=_0x7a05bc['data'],_0x4db147=Li(_0x6ffadd),_0x1d6db6=(_0x346227=(_0x182f8d=this['_memberService'][_0x356377(0x2d0)](this[_0x356377(0x1be)],_0x300dad))==null?void 0x0:_0x182f8d[_0x356377(0x25e)])!=null?_0x346227:_0x356377(0x2e7),_0x471454={'color':this[_0x356377(0x2a8)][_0x356377(0x1d7)](_0x300dad),'name':_0x1d6db6,'ranges':_0x4db147},_0x39c9b7=this['cursorInfo'];_0x39c9b7[_0x356377(0x2d7)](_0x300dad,_0x471454),this[_0x356377(0x1e1)][_0x356377(0x27f)](_0x39c9b7);}[_0x59d238(0x2aa)](_0x326761){const _0x25568a=_0x59d238,{memberID:_0x44f840}=_0x326761[_0x25568a(0x28b)],_0x33dd37=this['cursorInfo'];_0x33dd37[_0x25568a(0x351)](_0x44f840),this['_cursorInfo$'][_0x25568a(0x27f)](_0x33dd37);}[_0x59d238(0x32a)](){const _0x26cb88=_0x59d238;var _0x1294d1;if(this[_0x26cb88(0x24c)]=!0x0,((_0x1294d1=this[_0x26cb88(0x284)]['getFocusedUnit']())==null?void 0x0:_0x1294d1[_0x26cb88(0x2a3)]())!==this[_0x26cb88(0x1be)])return;const _0x2c2241=this[_0x26cb88(0x23b)][_0x26cb88(0x1b4)](_0x527b66)[_0x26cb88(0x360)]();Array[_0x26cb88(0x1a7)](_0x2c2241)&&_0x2c2241[_0x26cb88(0x173)]>0x0&&this[_0x26cb88(0x37e)](_0x2c2241);}[_0x59d238(0x35c)](){const _0x1b26fa=_0x59d238;this[_0x1b26fa(0x24c)]=!0x1;}};Pe=Ai([A(0x2,_0x43bd7d(_0x504c4c)),A(0x3,_0x43bd7d(je)),A(0x4,_0x43bd7d(_0x554a3d)),A(0x5,_0x43bd7d(Xe)),A(0x6,_0x415fde),A(0x7,_0x21d94f),A(0x8,_0x831c33)],Pe);var yi=Object[_0x59d238(0x29e)],$i=(_0x40816d,_0x26d902,_0x5724f1,_0x29a929)=>{const _0x470498=_0x59d238;for(var _0x2772b7=_0x29a929>0x1?void 0x0:_0x29a929?yi(_0x26d902,_0x5724f1):_0x26d902,_0x56dac7=_0x40816d[_0x470498(0x173)]-0x1,_0x2b679a;_0x56dac7>=0x0;_0x56dac7--)(_0x2b679a=_0x40816d[_0x56dac7])&&(_0x2772b7=_0x2b679a(_0x2772b7)||_0x2772b7);return _0x2772b7;},B=(_0x3d6670,_0x333e39)=>(_0x209361,_0x1cbadc)=>_0x333e39(_0x209361,_0x1cbadc,_0x3d6670);const xi=0x12c,Bi=0x64,Fi=()=>{let _0x43c1c5=[],_0x5bc8d6=!0x1;return _0x45c3c5=>{_0x43c1c5['push'](_0x45c3c5),_0x5bc8d6||(_0x5bc8d6=!0x0,setTimeout(()=>{const _0x344c2d=_0x6a51;_0x43c1c5[_0x344c2d(0x1c2)](_0x5e95d4=>_0x5e95d4()),_0x43c1c5=[],_0x5bc8d6=!0x1;}));};};let we=class extends _0x5e1dde{constructor(_0x3971c9,_0x74b32d,_0x478eab,_0xccdf80,_0x3f8a5a,_0x290876,_0x644a86,_0x5ecb9){const _0x40a7b4=_0x59d238;super(),l(this,_0x40a7b4(0x24c),!0x1),l(this,'_init',!0x1),l(this,_0x40a7b4(0x1e1),new _0x7b2298(new Map())),l(this,_0x40a7b4(0x2c6),this[_0x40a7b4(0x1e1)]['asObservable']()),l(this,'_roomMembers$',new _0x7b2298([])),l(this,_0x40a7b4(0x216),this['_roomMembers$']['pipe'](_0x380830(xi))),l(this,'_updateLocalCursor',_0x86b54f((_0x56ecbb,_0x2bd760)=>{const _0x23d4ed=_0x40a7b4,_0x2a2995={'eventID':_0x487dcc[_0x23d4ed(0x2e3)],'data':{'unitID':this[_0x23d4ed(0x1be)],'memberID':this[_0x23d4ed(0x396)][_0x23d4ed(0x1d4)](),'selection':_0x411a0e(_0x56ecbb,_0x2bd760['range'])}};this[_0x23d4ed(0x396)][_0x23d4ed(0x27b)](_0x2a2995,this[_0x23d4ed(0x1be)]);},Bi)),(this[_0x40a7b4(0x1be)]=_0x3971c9,this['_session']=_0x74b32d,this[_0x40a7b4(0x23b)]=_0x478eab,this[_0x40a7b4(0x2a8)]=_0xccdf80,this[_0x40a7b4(0x316)]=_0x3f8a5a,this[_0x40a7b4(0x284)]=_0x290876,this[_0x40a7b4(0x304)]=_0x644a86,this[_0x40a7b4(0x2b1)]=_0x5ecb9);}get[_0x59d238(0x2c0)](){const _0x5c21d6=_0x59d238;return this[_0x5c21d6(0x1e1)]['getValue']();}get[_0x59d238(0x31a)](){const _0x40bc77=_0x59d238;return this[_0x40bc77(0x1ea)]['getValue']();}[_0x59d238(0x183)](){const _0x49b99e=_0x59d238;super[_0x49b99e(0x183)](),this[_0x49b99e(0x1e1)][_0x49b99e(0x27f)](new Map()),this[_0x49b99e(0x1e1)][_0x49b99e(0x318)](),this['_roomMembers$'][_0x49b99e(0x27f)]([]),this[_0x49b99e(0x1ea)][_0x49b99e(0x318)]();}['init'](){const _0x372bd1=_0x59d238;this['_init']||(this[_0x372bd1(0x254)]=!0x0,this[_0x372bd1(0x396)][_0x372bd1(0x288)][_0x372bd1(0x167)](_0x2d5638(this[_0x372bd1(0x1bf)]))[_0x372bd1(0x171)](_0x7868f2=>{const _0x4deb47=_0x372bd1;_0x7868f2===_0x3a98da[_0x4deb47(0x280)]?this[_0x4deb47(0x32a)]():this[_0x4deb47(0x35c)]();}),this['_session'][_0x372bd1(0x369)][_0x372bd1(0x167)](_0x2d5638(this[_0x372bd1(0x1bf)]))[_0x372bd1(0x171)](_0x30b731=>{const _0x1781fd=_0x372bd1,_0x59c894=_0x30b731[_0x1781fd(0x2d2)];_0x59c894===_0x487dcc[_0x1781fd(0x2e3)]&&this[_0x1781fd(0x225)](_0x30b731),_0x59c894===_0x487dcc[_0x1781fd(0x395)]&&this[_0x1781fd(0x2aa)](_0x30b731);}),this['_onRefRangeChange'](),this[_0x372bd1(0x26d)](this['_commandService'][_0x372bd1(0x1a8)](_0x5b50e9=>{const _0xbad7c0=_0x372bd1;if(this[_0xbad7c0(0x24c)]&&_0x5b50e9['id']===_0x3056ea['id']&&_0x5b50e9['params'][_0xbad7c0(0x19d)]===this[_0xbad7c0(0x1be)]){const _0xe96d51=_0x5b50e9['params'];this[_0xbad7c0(0x37e)](_0xe96d51['subUnitId'],_0xe96d51['selections'][0x0]);}})));}['_onCursorUpdate'](_0x5b0740){const _0x50dbcc=_0x59d238;var _0x3a5cef,_0x2ea748;const {memberID:_0x580369,selection:_0x305048}=_0x5b0740[_0x50dbcc(0x28b)],{sheetName:_0x60ebf6,range:_0x254a74}=_0x12eb24(_0x305048),_0x843dd7={'name':(_0x2ea748=(_0x3a5cef=this[_0x50dbcc(0x316)][_0x50dbcc(0x2d0)](this['unitID'],_0x580369))==null?void 0x0:_0x3a5cef[_0x50dbcc(0x25e)])!=null?_0x2ea748:'Unknown\x20user','range':this[_0x50dbcc(0x212)](_0x60ebf6,_0x254a74),'sheetID':_0x60ebf6,'color':this[_0x50dbcc(0x2a8)][_0x50dbcc(0x1d7)](_0x580369),'selection':_0x305048},_0x557272=this['cursorInfo'];_0x557272['set'](_0x580369,_0x843dd7),this['_cursorInfo$'][_0x50dbcc(0x27f)](_0x557272);}[_0x59d238(0x2aa)](_0x552170){const _0xb21a0d=_0x59d238,{memberID:_0x4ee011}=_0x552170[_0xb21a0d(0x28b)],_0x2c7648=this[_0xb21a0d(0x2c0)];_0x2c7648['delete'](_0x4ee011),this[_0xb21a0d(0x1e1)][_0xb21a0d(0x27f)](_0x2c7648);}[_0x59d238(0x212)](_0x164344,_0x4e4f10){const _0x3deee0=_0x59d238;var _0x128d86,_0x25d97c;const _0x1e15d5=(_0x25d97c=(_0x128d86=this[_0x3deee0(0x284)][_0x3deee0(0x2c5)](this[_0x3deee0(0x1be)]))==null?void 0x0:_0x128d86[_0x3deee0(0x342)](_0x164344))==null?void 0x0:_0x25d97c[_0x3deee0(0x35b)]();return(_0x1e15d5==null?void 0x0:_0x1e15d5[_0x3deee0(0x163)](_0x353b8d=>_0x51b39e[_0x3deee0(0x32d)](_0x353b8d,_0x4e4f10)))||_0x4e4f10;}[_0x59d238(0x236)](){const _0x1a6c02=_0x59d238,_0x4b0bdc=new _0x107734(),_0x1409e3=Fi(),_0x2d8759=()=>{const _0x5925bf=_0x6a51;_0x4b0bdc['dispose']();const _0x2c7917=(_0x41bdb7,_0x4eef77,_0x223cb3,_0x482de5)=>{const _0x1768ea=_0x6a51;let _0x25f168=[];switch(_0x41bdb7['id']){case _0xf3fab0[_0x1768ea(0x301)]:{_0x25f168=_0x97d872(_0x41bdb7,_0x482de5);break;}case _0xf3fab0[_0x1768ea(0x24a)]:{_0x25f168=_0x2e997c(_0x41bdb7,_0x482de5);break;}case _0xf3fab0[_0x1768ea(0x24b)]:{_0x25f168=_0x290ffe(_0x41bdb7,_0x482de5);break;}case _0xf3fab0[_0x1768ea(0x30f)]:{_0x25f168=_0x4d3e7e(_0x41bdb7,_0x482de5);break;}case _0xf3fab0[_0x1768ea(0x38f)]:{_0x25f168=_0x584b59(_0x41bdb7,_0x482de5);break;}case _0xf3fab0[_0x1768ea(0x35f)]:{_0x25f168=_0x56146d(_0x41bdb7,_0x482de5);break;}case _0xf3fab0[_0x1768ea(0x275)]:{_0x25f168=_0x2608d9(_0x41bdb7,_0x482de5);break;}case _0xf3fab0[_0x1768ea(0x192)]:{_0x25f168=_0x1022dc(_0x41bdb7,_0x482de5);break;}case _0xf3fab0[_0x1768ea(0x231)]:{_0x25f168=_0x21a663(_0x41bdb7,_0x482de5);break;}}const _0x5bb8c6=_0x20f653(_0x25f168,_0x482de5),_0x3d5bff=this[_0x1768ea(0x2c0)][_0x1768ea(0x1b4)](_0x4eef77);if(_0x3d5bff&&_0x5bb8c6){const _0x4dc161={..._0x3d5bff,'range':_0x5bb8c6};this['cursorInfo'][_0x1768ea(0x2d7)](_0x4eef77,_0x4dc161),_0x1409e3(()=>{const _0x35c1bf=_0x1768ea,_0x2c56a9=this[_0x35c1bf(0x2b1)][_0x35c1bf(0x376)](_0x5bb8c6,_0x26e551=>(_0x2c56a9[_0x35c1bf(0x183)](),_0x2c7917(_0x26e551,_0x4eef77,_0x223cb3,_0x5bb8c6)));_0x4b0bdc[_0x35c1bf(0x1cb)](_0x2c56a9);});}return{'redos':[],'undos':[]};};this[_0x5925bf(0x2c0)][_0x5925bf(0x1c2)]((_0x5d4dcf,_0x446254)=>{const _0x5a4805=_0x5925bf,{range:_0x343ff7,sheetID:_0x8c1ac6}=_0x5d4dcf,_0x1c69f9=this[_0x5a4805(0x2b1)][_0x5a4805(0x376)](_0x343ff7,_0xe43881=>(_0x1c69f9[_0x5a4805(0x183)](),_0x2c7917(_0xe43881,_0x446254,_0x8c1ac6,_0x343ff7)));_0x4b0bdc[_0x5a4805(0x1cb)](_0x1c69f9);});};this[_0x1a6c02(0x26d)](_0x38e653(this[_0x1a6c02(0x1e1)][_0x1a6c02(0x171)](()=>{_0x2d8759();})));}[_0x59d238(0x32a)](){const _0x210752=_0x59d238;var _0x10012d,_0x4d604b;if(this[_0x210752(0x24c)]=!0x0,((_0x10012d=this[_0x210752(0x284)][_0x210752(0x339)]())==null?void 0x0:_0x10012d[_0x210752(0x2a3)]())!==this[_0x210752(0x1be)])return;const _0x1e0d2c=(_0x4d604b=this[_0x210752(0x23b)][_0x210752(0x1b4)](_0x24db11)['getCurrentSelections']())==null?void 0x0:_0x4d604b[0x0],_0x2c7274=this['_univerInstanceService']['getCurrentUnitForType'](_0x4b5311[_0x210752(0x208)])['getActiveSheet']();_0x1e0d2c&&_0x2c7274&&this[_0x210752(0x37e)](_0x2c7274['getSheetId'](),_0x1e0d2c);}[_0x59d238(0x35c)](){const _0x205768=_0x59d238;this[_0x205768(0x24c)]=!0x1;}};we=$i([B(0x2,_0x43bd7d(_0x504c4c)),B(0x3,_0x43bd7d(je)),B(0x4,_0x43bd7d(_0x554a3d)),B(0x5,_0x21d94f),B(0x6,_0x831c33),B(0x7,_0x43bd7d(_0x5209f7))],we);var ki=Object[_0x59d238(0x29e)],Hi=(_0x484c4b,_0x369b41,_0x3d2dd3,_0x2d12f3)=>{const _0x1649ed=_0x59d238;for(var _0x300659=_0x2d12f3>0x1?void 0x0:_0x2d12f3?ki(_0x369b41,_0x3d2dd3):_0x369b41,_0x15c5dd=_0x484c4b[_0x1649ed(0x173)]-0x1,_0x559e0f;_0x15c5dd>=0x0;_0x15c5dd--)(_0x559e0f=_0x484c4b[_0x15c5dd])&&(_0x300659=_0x559e0f(_0x300659)||_0x300659);return _0x300659;},Ee=(_0x28391f,_0x4b7718)=>(_0x21f944,_0x4b7493)=>_0x4b7718(_0x21f944,_0x4b7493,_0x28391f);let H=class extends _0x5e1dde{constructor(_0x2b0617,_0x5b8f06,_0x1dfaa8){const _0x3e41ba=_0x59d238;super(),l(this,_0x3e41ba(0x172),new Map()),l(this,'_entityInit$',new _0x9e5180()),(this[_0x3e41ba(0x284)]=_0x2b0617,this[_0x3e41ba(0x23b)]=_0x5b8f06,this[_0x3e41ba(0x29c)]=_0x1dfaa8,this['_init']());}['dispose'](){const _0x46f6de=_0x59d238;super[_0x46f6de(0x183)](),this[_0x46f6de(0x359)][_0x46f6de(0x318)](),this[_0x46f6de(0x172)]['forEach'](_0x15dab7=>_0x15dab7[_0x46f6de(0x183)]());}[_0x59d238(0x187)](_0x3329c7){const _0x5e5729=_0x59d238;return this['_entities'][_0x5e5729(0x30b)](_0x3329c7)?this[_0x5e5729(0x172)][_0x5e5729(0x1b4)](_0x3329c7)[_0x5e5729(0x2c6)]:this[_0x5e5729(0x359)]['pipe'](_0x284e18(_0x14bbf0=>_0x14bbf0[_0x5e5729(0x1be)]===_0x3329c7),_0x42f9ae(_0x1c2bd4=>_0x1c2bd4['cursorInfo$']));}[_0x59d238(0x254)](){const _0x376fe0=_0x59d238;this[_0x376fe0(0x284)]['getTypeOfUnitAdded$'](_0x4b5311[_0x376fe0(0x208)])[_0x376fe0(0x167)](_0x2d5638(this['dispose$']))['subscribe'](async _0x266e34=>{const _0x3929f8=_0x376fe0,_0x127906=_0x266e34[_0x3929f8(0x2a3)](),_0x57be94=await this[_0x3929f8(0x26e)](_0x127906);this[_0x3929f8(0x359)][_0x3929f8(0x27f)](_0x57be94),this[_0x3929f8(0x172)]['set'](_0x127906,_0x57be94);}),this['_univerInstanceService'][_0x376fe0(0x2b2)](_0x4b5311[_0x376fe0(0x19b)])['pipe'](_0x2d5638(this[_0x376fe0(0x1bf)]))['pipe'](_0x284e18(_0x381f28=>!_0x381f28[_0x376fe0(0x2a3)]()[_0x376fe0(0x193)]('__')))[_0x376fe0(0x171)](async _0x50574c=>{const _0x4d24ba=_0x376fe0,_0x2bed4f=_0x50574c[_0x4d24ba(0x2a3)](),_0x419cc5=await this[_0x4d24ba(0x1ac)](_0x2bed4f);this[_0x4d24ba(0x359)][_0x4d24ba(0x27f)](_0x419cc5),this[_0x4d24ba(0x172)]['set'](_0x2bed4f,_0x419cc5);}),_0x3dc230(this[_0x376fe0(0x284)]['getTypeOfUnitDisposed$'](_0x4b5311[_0x376fe0(0x19b)]),this[_0x376fe0(0x284)][_0x376fe0(0x18f)](_0x4b5311[_0x376fe0(0x208)]))[_0x376fe0(0x167)](_0x2d5638(this[_0x376fe0(0x1bf)]))['subscribe'](_0x3c8975=>{const _0xff3594=_0x376fe0,_0x2c6eb0=_0x3c8975[_0xff3594(0x2a3)](),_0x526982=this['_entities'][_0xff3594(0x1b4)](_0x2c6eb0);_0x526982&&(_0x526982[_0xff3594(0x183)](),this[_0xff3594(0x172)]['delete'](_0x2c6eb0));});}async[_0x59d238(0x26e)](_0x3e41ff){const _0x3d8ce8=_0x59d238,_0x150ac3=await this[_0x3d8ce8(0x29c)][_0x3d8ce8(0x20a)](_0x3e41ff),_0x3e02b1=this[_0x3d8ce8(0x23b)][_0x3d8ce8(0x26b)](we,_0x3e41ff,_0x150ac3);return _0x3e02b1[_0x3d8ce8(0x207)](),_0x3e02b1;}async[_0x59d238(0x1ac)](_0x22ad99){const _0x2e1b7f=_0x59d238,_0x10161f=await this[_0x2e1b7f(0x29c)][_0x2e1b7f(0x20a)](_0x22ad99),_0x5db107=this['_injector'][_0x2e1b7f(0x26b)](Pe,_0x22ad99,_0x10161f);return _0x5db107['init'](),_0x5db107;}};H=Hi([Ee(0x0,_0x21d94f),Ee(0x1,_0x43bd7d(_0x504c4c)),Ee(0x2,_0x43bd7d(_0x1917eb))],H);const Q=0x14,it=0xc8,pe=0x4,Yi=0x5;function Wi(_0x1a112a,_0x570eff){const _0x153828=_0x59d238;let {radius:_0x215483,width:_0x2fd0df,height:_0x585128}=_0x570eff;_0x215483=_0x215483!=null?_0x215483:0x0,_0x2fd0df=_0x2fd0df!=null?_0x2fd0df:0x1e,_0x585128=_0x585128!=null?_0x585128:0x1e;let _0x13ebb6=0x0,_0xd79293=0x0,_0x40b3f0=0x0;_0x13ebb6=_0xd79293=_0x40b3f0=Math[_0x153828(0x2a2)](_0x215483,_0x2fd0df/0x2,_0x585128/0x2),_0x1a112a['beginPath'](),_0x1a112a[_0x153828(0x31b)](_0x13ebb6,0x0),_0x1a112a['lineTo'](_0x2fd0df-_0xd79293,0x0),_0x1a112a['arc'](_0x2fd0df-_0xd79293,_0xd79293,_0xd79293,Math['PI']*0x3/0x2,0x0,!0x1),_0x1a112a[_0x153828(0x217)](_0x2fd0df,_0x585128-_0x40b3f0),_0x1a112a['arc'](_0x2fd0df-_0x40b3f0,_0x585128-_0x40b3f0,_0x40b3f0,0x0,Math['PI']/0x2,!0x1),_0x1a112a[_0x153828(0x217)](0x0,_0x585128),_0x1a112a[_0x153828(0x217)](0x0,_0x13ebb6),_0x1a112a['arc'](_0x13ebb6,_0x13ebb6,_0x13ebb6,Math['PI'],Math['PI']*0x3/0x2,!0x1),_0x1a112a['closePath'](),_0x570eff['fill']&&(_0x1a112a[_0x153828(0x222)](),_0x1a112a[_0x153828(0x164)]=_0x570eff[_0x153828(0x311)],_0x570eff[_0x153828(0x232)]===_0x153828(0x337)?_0x1a112a[_0x153828(0x311)]('evenodd'):_0x1a112a['fill'](),_0x1a112a['restore']());}class me extends _0x25671b{constructor(_0x595685,_0x3647c2){const _0x21c6d2=_0x59d238;super(_0x595685,_0x3647c2),l(this,_0x21c6d2(0x312)),l(this,'text'),(this[_0x21c6d2(0x312)]=_0x3647c2==null?void 0x0:_0x3647c2[_0x21c6d2(0x312)],this[_0x21c6d2(0x2f9)]=_0x3647c2==null?void 0x0:_0x3647c2[_0x21c6d2(0x2f9)]);}static[_0x59d238(0x162)](_0xcb4474,_0x2adf69){const _0xc1f05d=_0x59d238,{text:_0xb5e2ce,color:_0x453c86}=_0x2adf69;_0xcb4474[_0xc1f05d(0x222)](),_0xcb4474[_0xc1f05d(0x1e2)]=_0xc1f05d(0x182);const _0x51c113=_0xcb4474[_0xc1f05d(0x384)](_0xb5e2ce)[_0xc1f05d(0x1f1)],_0x547d8c=Math['min'](_0x51c113+0x2*pe,it);Wi(_0xcb4474,{'height':Q,'radius':0x4,'width':_0x547d8c,'fill':_0x453c86}),_0xcb4474[_0xc1f05d(0x164)]=_0xc1f05d(0x1fc);const _0x309d2f=pe,_0x2d2ea1=Q-Yi,_0x5208a1=it-0x2*pe;if(_0x51c113>_0x5208a1){let _0x2df196='',_0x53d66c=0x0;for(const _0x36e979 of _0xb5e2ce){const _0x61efef=_0xcb4474[_0xc1f05d(0x384)](_0x36e979)[_0xc1f05d(0x1f1)];if(_0x53d66c+_0x61efef<=_0x5208a1-_0xcb4474[_0xc1f05d(0x384)]('...')[_0xc1f05d(0x1f1)])_0x2df196+=_0x36e979,_0x53d66c+=_0x61efef;else{_0x2df196+=_0xc1f05d(0x33d);break;}}_0xcb4474[_0xc1f05d(0x17d)](_0x2df196,_0x309d2f,_0x2d2ea1);}else _0xcb4474[_0xc1f05d(0x17d)](_0xb5e2ce,_0x309d2f,_0x2d2ea1);_0xcb4474[_0xc1f05d(0x25b)]();}[_0x59d238(0x2ba)](_0x2718a0){const _0x2ba5ac=_0x59d238;me[_0x2ba5ac(0x162)](_0x2718a0,this);}}const Oe='collab-text-anchor-',Vi=_0x59d238(0x34f),ji=_0x59d238(0x1b3),z=0x6,Xi=1.5,Te=0x4,Gi=1.5,Ki=_0x59d238(0x377);class nt{constructor(_0x8cf2cb,_0x5f4b6b,_0x20c04c,_0x1cec9e){const _0x264449=_0x59d238;l(this,_0x264449(0x2f2),[]),l(this,'_anchor',null),l(this,'_textBubble',null),l(this,_0x264449(0x370),null),l(this,_0x264449(0x25c),null),l(this,_0x264449(0x17a),null),(this[_0x264449(0x213)]=_0x8cf2cb,this['_scene']=_0x5f4b6b,this[_0x264449(0x205)]=_0x20c04c,this[_0x264449(0x1d5)]=_0x1cec9e,this[_0x264449(0x1ff)]());}set[_0x59d238(0x179)](_0x2c801d){const _0x3359c4=_0x59d238;_0x2c801d?(this[_0x3359c4(0x370)]&&this[_0x3359c4(0x370)]['hide'](),this[_0x3359c4(0x28e)]&&this[_0x3359c4(0x28e)][_0x3359c4(0x28a)]()):(this[_0x3359c4(0x370)]&&this[_0x3359c4(0x370)]['show'](),this[_0x3359c4(0x28e)]&&this[_0x3359c4(0x28e)][_0x3359c4(0x17f)]());}['dispose'](){const _0x2df982=_0x59d238;for(const _0x42b600 of this[_0x2df982(0x2f2)])_0x42b600[_0x2df982(0x183)]();this[_0x2df982(0x28e)]&&this[_0x2df982(0x28e)][_0x2df982(0x183)](),this[_0x2df982(0x370)]&&this[_0x2df982(0x370)][_0x2df982(0x183)](),this[_0x2df982(0x302)]&&this[_0x2df982(0x302)]['dispose'](),this[_0x2df982(0x17a)]&&this[_0x2df982(0x17a)]();}[_0x59d238(0x1ff)](){const _0x13064d=_0x59d238;var _0x48692e;const {_docSkeleton:_0x23706b,_document:_0x3f1f78}=this,{color:_0x1a620d,name:_0x30a36a,ranges:_0x1f6bde}=this[_0x13064d(0x213)],_0x47cf96=_0x3f1f78['getOffsetConfig'](),{docsLeft:_0x4196d7,docsTop:_0x6c854b}=_0x47cf96,_0x2c8c00=new _0x2fc324(_0x47cf96,_0x23706b);for(const {startOffset:_0x3209f4,endOffset:_0x26da37,rangeType:_0x48b663,segmentId:_0x56146f,segmentPage:_0x4b13cf,collapsed:_0xdbed70,isActive:_0x3a0e8e}of _0x1f6bde){const _0x3db2ef=_0x23706b['findNodePositionByCharIndex'](_0x3209f4,!0x0,_0x56146f,_0x4b13cf);let _0x1c241c=_0x23706b[_0x13064d(0x34e)](_0x26da37,!0x0,_0x56146f,_0x4b13cf);if(_0x1c241c==null&&(_0x1c241c=_0x23706b[_0x13064d(0x34e)](_0x26da37-0x1,!0x1,_0x56146f,_0x4b13cf)),_0x3a0e8e){const {contentBoxPointGroup:_0x4836dc}=_0x2c8c00[_0x13064d(0x1a6)](_0x1c241c,_0x1c241c);if(_0x4836dc['length']===0x0)continue;this['_drawAnchor'](_0x1a620d,_0x4836dc,_0x4196d7,_0x6c854b,_0x30a36a),this[_0x13064d(0x17a)]=this[_0x13064d(0x287)]();}if(_0x3db2ef&&_0x1c241c){if(_0x48b663===_0x3ea76e['RECT']){const _0x48e892=new _0x5ac8cc(_0x47cf96,_0x23706b),{pointGroup:_0x348ab0}=(_0x48692e=_0x48e892[_0x13064d(0x1a6)](_0x3db2ef,_0x1c241c))!=null?_0x48692e:{};if(_0x348ab0==null||_0x348ab0[_0x13064d(0x173)]===0x0)continue;this[_0x13064d(0x366)](_0x1a620d,_0x348ab0,_0x4196d7,_0x6c854b);}else{if(!_0xdbed70){const {borderBoxPointGroup:_0x11b5a4}=_0x2c8c00[_0x13064d(0x1a6)](_0x3db2ef,_0x1c241c);if(_0x11b5a4[_0x13064d(0x173)]===0x0)continue;this[_0x13064d(0x269)](_0x1a620d,_0x11b5a4,_0x4196d7,_0x6c854b);}}}}}[_0x59d238(0x18d)](_0x10e633,_0x2d4eef,_0x650971,_0x3ee90d,_0x51a9f0){const _0x1135f3=_0x59d238,_0x416e0c=this[_0x1135f3(0x223)](_0x2d4eef),{left:_0x1662d1,top:_0x2588bb,height:_0x39fe26}=_0x416e0c,_0x53dbc2=this['_getScale'](),_0x5e8a69=Gi/_0x53dbc2,_0x21b681=new _0x142093(Oe+_0xcfedbd(z),{'left':_0x1662d1+_0x650971-_0x5e8a69,'top':_0x2588bb+_0x3ee90d,'height':_0x39fe26,'width':Xi,'fill':_0x10e633||_0x42d178(_0x41e869[_0x1135f3(0x1e7)],0x0),'strokeWidth':_0x5e8a69,'stroke':Ki,'evented':!0x0});this[_0x1135f3(0x302)]=_0x21b681,this[_0x1135f3(0x237)][_0x1135f3(0x2e5)](_0x21b681,_0x28c7e0);const _0x1663f6=new _0x142093(Oe+_0xcfedbd(z),{'left':_0x1662d1+_0x650971-_0x5e8a69,'top':_0x2588bb+_0x3ee90d-Te/0x2,'height':Te,'width':Te,'fill':_0x10e633||_0x42d178(_0x41e869[_0x1135f3(0x1e7)],0x0),'strokeWidth':0x0,'stroke':_0x10e633||_0x42d178(_0x41e869['black'],0x0),'evented':!0x1});this['_anchorDot']=_0x1663f6,this[_0x1135f3(0x237)][_0x1135f3(0x2e5)](_0x1663f6,_0x28c7e0);const _0x3f616b=new me(Oe+_0xcfedbd(z),{'left':_0x1662d1+_0x650971-_0x5e8a69,'top':_0x2588bb+_0x3ee90d-Q,'text':_0x51a9f0,'color':_0x10e633});this[_0x1135f3(0x28e)]=_0x3f616b,this['_scene']['addObject'](_0x3f616b,_0x28c7e0),this[_0x1135f3(0x179)]=!0x1;}['_handleHover'](){const _0x325b97=_0x59d238,_0x2c31e6=this[_0x325b97(0x302)][_0x325b97(0x28f)][_0x325b97(0x189)](()=>{const _0x4898df=_0x325b97;this[_0x4898df(0x179)]=!0x0;}),_0x5cc1b7=this[_0x325b97(0x302)]['onPointerLeave$']['subscribeEvent'](()=>{const _0x21ca4c=_0x325b97;this[_0x21ca4c(0x25c)]&&clearTimeout(this[_0x21ca4c(0x25c)]),this[_0x21ca4c(0x25c)]=setTimeout(()=>{const _0x5ec682=_0x21ca4c;this[_0x5ec682(0x179)]=!0x1;},0x7d0);});return()=>{const _0x164b01=_0x325b97;_0x2c31e6[_0x164b01(0x176)](),_0x5cc1b7['unsubscribe']();};}[_0x59d238(0x269)](_0x54f295,_0x5ab534,_0x2434be,_0x49e3a3){const _0x56f26e=_0x59d238,_0x4167e5=new _0x4769a4(_0x54f295)[_0x56f26e(0x24f)](0.2)[_0x56f26e(0x353)](),_0x2b49dc=new _0x22b481(Vi+_0xcfedbd(z),{'pointsGroup':_0x5ab534,'fill':_0x4167e5||_0x42d178(_0x41e869[_0x56f26e(0x1e7)],0.2),'left':_0x2434be,'top':_0x49e3a3,'evented':!0x1,'debounceParentDirty':!0x1});this['_shapes'][_0x56f26e(0x235)](_0x2b49dc),this[_0x56f26e(0x237)][_0x56f26e(0x2e5)](_0x2b49dc,_0x28c7e0);}[_0x59d238(0x366)](_0x4c17a,_0x483f44,_0x340973,_0x17e4be){const _0x51b9c4=_0x59d238,_0x4c1721=new _0x4769a4(_0x4c17a)[_0x51b9c4(0x24f)](0.2)['toRgbString'](),_0x1b4896=new _0x22b481(ji+_0xcfedbd(z),{'pointsGroup':_0x483f44,'fill':_0x4c1721||_0x42d178(_0x41e869['black'],0.2),'left':_0x340973,'top':_0x17e4be,'evented':!0x1,'debounceParentDirty':!0x1});this['_shapes'][_0x51b9c4(0x235)](_0x1b4896),this['_scene'][_0x51b9c4(0x2e5)](_0x1b4896,_0x28c7e0);}['_getAnchorBounding'](_0x32d1b4){const _0x1a9370=_0x32d1b4[0x0],_0xb9d2f5=_0x1a9370[0x0],_0x6c7acd=_0x1a9370[0x2],{x:_0x2a77f5,y:_0x1fdbaf}=_0xb9d2f5,{x:_0x4f4a17,y:_0x8fcffb}=_0x6c7acd;return{'left':_0x2a77f5,'top':_0x1fdbaf,'width':_0x4f4a17-_0x2a77f5,'height':_0x8fcffb-_0x1fdbaf};}[_0x59d238(0x1c1)](){const _0x2fd2ec=_0x59d238,{scaleX:_0x39d2a8,scaleY:_0x5cdedc}=this[_0x2fd2ec(0x237)][_0x2fd2ec(0x34a)]();return Math[_0x2fd2ec(0x2d9)](_0x39d2a8,_0x5cdedc);}}var zi=Object['getOwnPropertyDescriptor'],Ji=(_0xf6409c,_0x558cd5,_0x55c2ff,_0x37d21a)=>{const _0x539b0b=_0x59d238;for(var _0x44f30f=_0x37d21a>0x1?void 0x0:_0x37d21a?zi(_0x558cd5,_0x55c2ff):_0x558cd5,_0x838576=_0xf6409c[_0x539b0b(0x173)]-0x1,_0xca73c1;_0x838576>=0x0;_0x838576--)(_0xca73c1=_0xf6409c[_0x838576])&&(_0x44f30f=_0xca73c1(_0x44f30f)||_0x44f30f);return _0x44f30f;},ie=(_0x33b2e2,_0x5060b8)=>(_0x53ba26,_0x866af9)=>_0x5060b8(_0x53ba26,_0x866af9,_0x33b2e2);let ye=class extends _0x5e1dde{constructor(_0x3409a2,_0x415be5,_0x3c2dd9,_0x28b3b0,_0x638552){const _0x432889=_0x59d238;super(),l(this,_0x432889(0x20c),[]),l(this,_0x432889(0x399),[]),(this[_0x432889(0x289)]=_0x3409a2,this['_docSkeletonManagerService']=_0x415be5,this[_0x432889(0x1ab)]=_0x3c2dd9,this['_commandService']=_0x28b3b0,this[_0x432889(0x26f)]=_0x638552,this['_init']());}[_0x59d238(0x254)](){const _0x38359b=_0x59d238,_0x1961dd=this['_context'][_0x38359b(0x19d)],_0x45dcf1=this['_docSkeletonManagerService'];this[_0x38359b(0x26d)](_0x566c6c([this['_collabCursorController'][_0x38359b(0x187)](_0x1961dd),this[_0x38359b(0x26f)][_0x38359b(0x1e5)]])[_0x38359b(0x167)](_0x38693b(([_0x3cebb3,_0x2ec83e])=>({'skeleton':_0x45dcf1['getSkeleton'](),'cursors':[..._0x3cebb3[_0x38359b(0x270)]()]['flatMap'](_0x47ce44=>({..._0x47ce44,'color':this[_0x38359b(0x26f)][_0x38359b(0x178)](_0x47ce44[_0x38359b(0x312)])}))})))['subscribe'](_0x1840cd=>{const _0x1e30d5=_0x38359b;if(this[_0x1e30d5(0x38d)](),_0x1840cd){const {skeleton:_0x18675f,cursors:_0x5e7b93}=_0x1840cd;this[_0x1e30d5(0x19f)](_0x18675f,_0x5e7b93);}})),this[_0x38359b(0x2b4)](),this[_0x38359b(0x186)]();}['_updateCollabCursors'](_0x1441de,_0x3428ae){const _0x51a0c1=_0x59d238,{scene:_0x2c49de,mainComponent:_0x35929e}=this[_0x51a0c1(0x289)],_0x41b48a=_0x3428ae[_0x51a0c1(0x2c7)](_0x1f09a1=>new nt(_0x1f09a1,_0x2c49de,_0x1441de,_0x35929e));this[_0x51a0c1(0x20c)]=_0x41b48a,this['_cursors']=_0x3428ae;}[_0x59d238(0x383)](){const _0x66905d=_0x59d238;this[_0x66905d(0x38d)]();const {scene:_0x4b92f2,mainComponent:_0x51a223}=this[_0x66905d(0x289)],_0x1b863e=this[_0x66905d(0x32b)]['getSkeleton'](),_0x5f6e36=this[_0x66905d(0x399)]['map'](_0x48d9b8=>new nt(_0x48d9b8,_0x4b92f2,_0x1b863e,_0x51a223));this[_0x66905d(0x20c)]=_0x5f6e36;}[_0x59d238(0x38d)](){const _0x148b2f=_0x59d238;this[_0x148b2f(0x20c)][_0x148b2f(0x1c2)](_0x5021b1=>_0x5021b1[_0x148b2f(0x183)]()),this[_0x148b2f(0x20c)]=[];}[_0x59d238(0x186)](){const _0x52a74a=_0x59d238,_0x24c925=[_0x4ab8a['id']];this['disposeWithMe'](this[_0x52a74a(0x304)][_0x52a74a(0x1a8)](_0x583c86=>{const _0x52eab8=_0x52a74a;_0x24c925[_0x52eab8(0x27d)](_0x583c86['id'])&&_0x583c86['params'][_0x52eab8(0x19d)]===this[_0x52eab8(0x289)]['unitId']&&this[_0x52eab8(0x383)]();}));}[_0x59d238(0x2b4)](){const _0x3898ae=_0x59d238;this[_0x3898ae(0x26d)](_0x1d5081(this[_0x3898ae(0x289)]['engine'][_0x3898ae(0x35a)])[_0x3898ae(0x167)](_0x22f0e8(_0x3284bb=>_0x3284bb[_0x3898ae(0x22d)]===_0xbe7e54[_0x3898ae(0x378)]),_0x3fdcb7(0x10))['subscribe'](()=>{const _0x1dbd0c=_0x3898ae;this[_0x1dbd0c(0x383)]();}));}};ye=Ji([ie(0x1,_0x43bd7d(_0x539b7a)),ie(0x2,_0x43bd7d(H)),ie(0x3,_0x831c33),ie(0x4,_0x43bd7d(_0x5dc501))],ye);const Zi=0x1,Qi=1.5;class qi extends _0x25671b{constructor(_0x4a89db,_0x28ee43){const _0x5e95bc=_0x59d238;super(_0x4a89db,_0x28ee43),l(this,_0x5e95bc(0x2ef)),l(this,_0x5e95bc(0x36c),!0x1),l(this,_0x5e95bc(0x307)),l(this,'_name',''),l(this,'_labelPosition',_0x5e95bc(0x188)),l(this,'_backgroundColor'),(_0x28ee43&&this['setShapeProps'](_0x28ee43),this['onPointerEnter$'][_0x5e95bc(0x189)](()=>this[_0x5e95bc(0x1f4)]({'hovered':!0x0})),this[_0x5e95bc(0x35d)][_0x5e95bc(0x189)](()=>this[_0x5e95bc(0x1f4)]({'hovered':!0x1})));}[_0x59d238(0x1f4)](_0x326db7){const _0x11b525=_0x59d238;var _0x58668c,_0x1a7df0,_0x3c8d11,_0x832e10,_0x1693a9,_0x44b7f0;this[_0x11b525(0x2ef)]=(_0x58668c=_0x326db7['color'])!=null?_0x58668c:this[_0x11b525(0x2ef)],this[_0x11b525(0x36c)]=(_0x1a7df0=_0x326db7['hovered'])!=null?_0x1a7df0:this['_hovered'],this['_range']=(_0x3c8d11=_0x326db7[_0x11b525(0x33a)])!=null?_0x3c8d11:this[_0x11b525(0x307)],this[_0x11b525(0x30a)]=(_0x832e10=_0x326db7[_0x11b525(0x25e)])!=null?_0x832e10:this['_name'],this['_labelPosition']=(_0x1693a9=_0x326db7[_0x11b525(0x22b)])!=null?_0x1693a9:this[_0x11b525(0x20d)],this[_0x11b525(0x282)]=(_0x44b7f0=_0x326db7[_0x11b525(0x227)])!=null?_0x44b7f0:this[_0x11b525(0x282)],this['transformByState']({'width':_0x326db7[_0x11b525(0x1f1)],'height':_0x326db7[_0x11b525(0x329)]});}[_0x59d238(0x226)](_0x2c1382){const _0x3436db=_0x59d238,{row:_0x279029,column:_0x3fdafc}=_0x2c1382;if(_0x279029>=this[_0x3436db(0x307)][_0x3436db(0x2de)]&&_0x279029<=this[_0x3436db(0x307)][_0x3436db(0x2cd)]&&_0x3fdafc>=this[_0x3436db(0x307)]['startColumn']&&_0x3fdafc<=this[_0x3436db(0x307)]['endColumn']){this['setShapeProps']({'hovered':!0x0});return;}this[_0x3436db(0x1f4)]({'hovered':!0x1});}[_0x59d238(0x2eb)](_0xe425c1){return!0x1;}['_draw'](_0x4613ef){const _0x39205b=_0x59d238;_0x142093[_0x39205b(0x162)](_0x4613ef,{'width':this[_0x39205b(0x1f1)],'height':this[_0x39205b(0x329)],'strokeWidth':Qi,'stroke':this[_0x39205b(0x2ef)],'evented':!0x1,'fill':this[_0x39205b(0x282)]}),this['_hovered']&&(_0x4613ef['save'](),_0x4613ef['transform'](0x1,0x0,0x0,0x1,this[_0x39205b(0x1f1)],this[_0x39205b(0x20d)]===_0x39205b(0x1b6)?0x0:-Q),me[_0x39205b(0x162)](_0x4613ef,{'text':this[_0x39205b(0x30a)],'color':this['_color']}),_0x4613ef[_0x39205b(0x25b)]());}}var en=Object['getOwnPropertyDescriptor'],tn=(_0x488d55,_0x31ed1e,_0x33b398,_0x265a33)=>{for(var _0x114a8f=_0x265a33>0x1?void 0x0:_0x265a33?en(_0x31ed1e,_0x33b398):_0x31ed1e,_0x161d4f=_0x488d55['length']-0x1,_0x34a940;_0x161d4f>=0x0;_0x161d4f--)(_0x34a940=_0x488d55[_0x161d4f])&&(_0x114a8f=_0x34a940(_0x114a8f)||_0x114a8f);return _0x114a8f;},Ce=(_0x213f85,_0x5ebc6a)=>(_0x494081,_0x529d55)=>_0x5ebc6a(_0x494081,_0x529d55,_0x213f85);const sn=0x1389;let $e=class extends _0x5e1dde{constructor(_0x3b02a5,_0x460807,_0x180f50,_0x317baa){const _0x268743=_0x59d238;super(),l(this,_0x268743(0x399),new Set()),l(this,_0x268743(0x1e4),null),(this[_0x268743(0x289)]=_0x3b02a5,this[_0x268743(0x372)]=_0x460807,this[_0x268743(0x1ab)]=_0x180f50,this[_0x268743(0x26f)]=_0x317baa,this['_init']());}['_init'](){const _0x50c4d0=_0x59d238;this[_0x50c4d0(0x372)][_0x50c4d0(0x328)]['pipe'](_0x23d9d8(this[_0x50c4d0(0x1bf)]),_0x56d5c4(_0x53eebf=>{const _0x5b0e66=_0x50c4d0;if(_0x53eebf){const _0x51ee76=_0x53eebf[_0x5b0e66(0x363)];return _0x566c6c(this[_0x5b0e66(0x1ab)]['getCollabCursors$'](this[_0x5b0e66(0x289)]['unitId']),this['_themeService']['currentTheme$'])[_0x5b0e66(0x167)](_0x38693b(([_0x479415,_0x1f7244])=>{const _0xfe3271=_0x5b0e66,_0x3b19ae=new Map();return _0x479415[_0xfe3271(0x1c2)]((_0x7021e6,_0x384647)=>{const _0x297a77=_0xfe3271;if(_0x7021e6['sheetID']===_0x51ee76){const _0x2fbce8={..._0x7021e6};_0x2fbce8[_0x297a77(0x312)]=this[_0x297a77(0x26f)][_0x297a77(0x178)](_0x7021e6[_0x297a77(0x312)]),_0x3b19ae[_0x297a77(0x2d7)](_0x384647,_0x2fbce8);}}),{'skeleton':_0x53eebf,'cursors':_0x3b19ae};}));}return _0x5bbcb9({'skeleton':null,'cursors':new Map()});}))[_0x50c4d0(0x171)](({skeleton:_0x537c91,cursors:_0x1dea6c})=>{const _0x2feddf=_0x50c4d0;this[_0x2feddf(0x38d)](),_0x537c91&&this[_0x2feddf(0x19f)](_0x537c91,_0x1dea6c);}),this['_sheetSkeletonManagerService'][_0x50c4d0(0x328)][_0x50c4d0(0x171)](_0x422988=>{const _0x220d0d=_0x50c4d0;if(_0x422988==null)return;const {skeleton:_0x2a49d1}=_0x422988,{scene:_0x5966db}=this[_0x220d0d(0x289)];_0x5966db['onPointerMove$'][_0x220d0d(0x189)](_0x86b54f(_0x558b57=>{const _0x48270f=_0x220d0d;var _0x1ca14b,_0x459a1c;const {offsetX:_0x4aa052,offsetY:_0xea7fa6}=_0x558b57,{x:_0x46c20a,y:_0x232e07}=_0x5966db['getRelativeToViewportCoord'](_0x33ba3b[_0x48270f(0x286)]([_0x4aa052,_0xea7fa6])),{scaleX:_0x4bed93,scaleY:_0xd60259}=_0x5966db['getAncestorScale'](),_0x15ae2e=_0x5966db[_0x48270f(0x2b6)](_0x17f0a0['VIEW_MAIN']),_0x1aa04f=_0x5966db[_0x48270f(0x2e2)](_0x33ba3b[_0x48270f(0x286)]([_0x46c20a,_0x232e07]),_0x15ae2e),_0x4c36ff=_0x2a49d1[_0x48270f(0x238)](_0x4aa052,_0xea7fa6,_0x4bed93,_0xd60259,_0x1aa04f);((_0x1ca14b=this[_0x48270f(0x1e4)])==null?void 0x0:_0x1ca14b[_0x48270f(0x283)])===_0x4c36ff['column']&&((_0x459a1c=this[_0x48270f(0x1e4)])==null?void 0x0:_0x459a1c['row'])===_0x4c36ff[_0x48270f(0x1f9)]||this[_0x48270f(0x399)][_0x48270f(0x1c2)](_0x16286c=>{const _0x30deeb=_0x48270f;_0x16286c[_0x30deeb(0x226)](_0x4c36ff);});},0x64));});}[_0x59d238(0x19f)](_0x2455ba,_0xe89d1c){const _0x58bfbf=_0x59d238;var _0x1918df;const _0x3621e8=(_0x1918df=this['_sheetSkeletonManagerService'][_0x58bfbf(0x20b)]())==null?void 0x0:_0x1918df[_0x58bfbf(0x262)];if(!_0x3621e8)return;const _0x457d35=this[_0x58bfbf(0x1ef)]();if(!_0x457d35)return;this[_0x58bfbf(0x399)][_0x58bfbf(0x1c2)](_0x5e06cd=>{const _0x5e181a=_0x58bfbf;_0x5e06cd[_0x5e181a(0x277)]();});const {scene:_0x282612}=_0x457d35,_0xc18c37=nn(Array[_0x58bfbf(0x2e4)](_0xe89d1c[_0x58bfbf(0x270)]()))['map'](_0x25190b=>{const _0x403f71=_0x58bfbf,{color:_0x42ab6b,range:_0x95e007,name:_0x335785,selection:_0x3084af,sheetID:_0xbf89d4}=_0x25190b,{startColumn:_0x52a408,startRow:_0x28f54a,endColumn:_0x4466d9,endRow:_0x42017f}=_0x95e007,_0x322be2=_0x36424e(_0x28f54a,_0x52a408,_0x282612,_0x3621e8),_0x4019e0=_0x36424e(_0x42017f,_0x4466d9,_0x282612,_0x3621e8),{columnHeaderHeightAndMarginTop:_0x466a24}=_0x3621e8,{startX:_0x375e2a,startY:_0x427084}=_0x322be2,{endX:_0x5275d1,endY:_0x30c0cb}=_0x4019e0,_0xbd31a0=_0x5275d1-_0x375e2a,_0xcfaf7f=_0x30c0cb-_0x427084,_0x4e31fa={'labelPosition':_0x427084-_0x466a24>=Q?_0x403f71(0x188):'bottom','sheetID':_0xbf89d4,'range':_0x95e007,'color':_0x42ab6b,'name':_0x335785,'selection':_0x3084af,'left':_0x375e2a,'top':_0x427084,'width':_0xbd31a0,'height':_0xcfaf7f,'evented':!0x1,'zIndex':sn};return new qi(_0x335785,_0x4e31fa);});_0x282612[_0x58bfbf(0x1dd)](_0xc18c37,Zi),this['_cursors']=new Set(_0xc18c37);}[_0x59d238(0x38d)](){const _0x575889=_0x59d238;var _0x5854d7;(_0x5854d7=this[_0x575889(0x399)])==null||_0x5854d7[_0x575889(0x1c2)](_0x18e7d3=>_0x18e7d3[_0x575889(0x183)]());}[_0x59d238(0x1ef)](){const _0x4eb26e=_0x59d238;return _0x246268(this[_0x4eb26e(0x289)][_0x4eb26e(0x23f)],this[_0x4eb26e(0x289)]);}};$e=tn([Ce(0x1,_0x43bd7d(_0x1426e2)),Ce(0x2,_0x43bd7d(H)),Ce(0x3,_0x43bd7d(_0x5dc501))],$e);function nn(_0x5c8a10){const _0x1cd0be=_0x59d238,_0x2ba19b=new Map();return _0x5c8a10[_0x1cd0be(0x1c2)](_0x5634b1=>{const _0x5d7f39=_0x1cd0be;if(_0x2ba19b[_0x5d7f39(0x30b)](_0x5634b1[_0x5d7f39(0x1f7)])){const _0x429026=_0x2ba19b[_0x5d7f39(0x1b4)](_0x5634b1['selection']);_0x429026[_0x5d7f39(0x25e)]+=',\x20'+_0x5634b1[_0x5d7f39(0x25e)];}else _0x2ba19b[_0x5d7f39(0x2d7)](_0x5634b1[_0x5d7f39(0x1f7)],_0x5634b1);}),Array[_0x1cd0be(0x2e4)](_0x2ba19b[_0x1cd0be(0x270)]());}var rn=Object[_0x59d238(0x29e)],on=(_0x2b360b,_0x3b3395,_0x394cdb,_0x23cbeb)=>{const _0x53be82=_0x59d238;for(var _0x24769a=_0x23cbeb>0x1?void 0x0:_0x23cbeb?rn(_0x3b3395,_0x394cdb):_0x3b3395,_0x33af5c=_0x2b360b[_0x53be82(0x173)]-0x1,_0x4aa56b;_0x33af5c>=0x0;_0x33af5c--)(_0x4aa56b=_0x2b360b[_0x33af5c])&&(_0x24769a=_0x4aa56b(_0x24769a)||_0x24769a);return _0x24769a;},F=(_0x1e77d1,_0x48610e)=>(_0x5dc22e,_0x4361b4)=>_0x48610e(_0x5dc22e,_0x4361b4,_0x1e77d1);let ce=class extends _0x4c1835{constructor(_0x32beeb,_0x95560,_0x518a06,_0x5cb6e0,_0xff9602,_0x1bb5e){const _0x177f7c=_0x59d238;super(),this[_0x177f7c(0x29a)]=_0x32beeb,this['_localCacheService']=_0x95560,this[_0x177f7c(0x21a)]=_0x518a06,this[_0x177f7c(0x37b)]=_0x5cb6e0,this['_notificationService']=_0xff9602,this[_0x177f7c(0x295)]=_0x1bb5e,this[_0x177f7c(0x2c3)](),this[_0x177f7c(0x1ad)]();}[_0x59d238(0x2c3)](){const _0x4a7420=_0x59d238;this['disposeWithMe'](this[_0x4a7420(0x29a)][_0x4a7420(0x308)](()=>{const _0x5992ce=_0x4a7420;if(this['_localCacheService'][_0x5992ce(0x259)][_0x5992ce(0x1fb)])return this[_0x5992ce(0x295)]['t'](_0x5992ce(0x1e0));}));}[_0x59d238(0x1ad)](){const _0x5d7d94=_0x59d238;this['disposeWithMe'](this[_0x5d7d94(0x21a)][_0x5d7d94(0x369)][_0x5d7d94(0x171)](_0x27a379=>{const _0x58c736=_0x5d7d94;_0x27a379['id']===_0x16016d[_0x58c736(0x1d1)]&&this[_0x58c736(0x37b)][_0x58c736(0x28a)]({'type':_0x2a0f31[_0x58c736(0x335)],'content':this[_0x58c736(0x295)]['t'](_0x58c736(0x177))}),_0x27a379['id']===_0x16016d[_0x58c736(0x230)]&&this[_0x58c736(0x37b)][_0x58c736(0x28a)]({'type':_0x2a0f31['Warning'],'content':this[_0x58c736(0x295)]['t'](_0x58c736(0x36b))}),_0x27a379['id']===_0x16016d[_0x58c736(0x2c2)]&&this[_0x58c736(0x30e)]['show']({'title':this['_localeService']['t'](_0x58c736(0x267)),'content':this[_0x58c736(0x295)]['t'](_0x58c736(0x331)),'type':'error','duration':0x0}),_0x27a379['id']===_0x16016d['CONFLICT']&&this[_0x58c736(0x37b)]['show']({'type':_0x2a0f31[_0x58c736(0x29b)],'content':this[_0x58c736(0x295)]['t'](_0x58c736(0x36b))+'('+_0x27a379['data']+')'}),_0x27a379['id']===_0x16016d[_0x58c736(0x1e3)]&&this['_messageService']['show']({'type':_0x2a0f31[_0x58c736(0x335)],'content':this[_0x58c736(0x295)]['t'](_0x27a379[_0x58c736(0x28b)]||'')}),_0x27a379['id']===_0x16016d[_0x58c736(0x1b1)]&&this[_0x58c736(0x37b)][_0x58c736(0x28a)]({'type':_0x2a0f31[_0x58c736(0x335)],'content':this['_localeService']['t'](_0x58c736(0x317))}),_0x27a379['id']===_0x16016d[_0x58c736(0x180)]&&this[_0x58c736(0x37b)][_0x58c736(0x28a)]({'type':_0x2a0f31[_0x58c736(0x29b)],'content':this[_0x58c736(0x295)]['t'](_0x58c736(0x261))}),_0x27a379['id']===_0x16016d[_0x58c736(0x2e1)]&&this[_0x58c736(0x37b)][_0x58c736(0x28a)]({'type':_0x2a0f31['Error'],'content':this[_0x58c736(0x295)]['t'](_0x58c736(0x253))});}));}};ce=on([F(0x0,_0xd5bcc6),F(0x1,_0x27b0f5),F(0x2,_0x43bd7d(_0x33ee3e)),F(0x3,_0x258372),F(0x4,_0x28531f),F(0x5,_0x43bd7d(_0x36a5ba))],ce);const an=_0x59d238(0x2f8),rt={};var cn=Object['getOwnPropertyDescriptor'],_n=(_0x4715ca,_0x39b637,_0x964c9a,_0x1955c0)=>{const _0x4ea024=_0x59d238;for(var _0x3bd760=_0x1955c0>0x1?void 0x0:_0x1955c0?cn(_0x39b637,_0x964c9a):_0x39b637,_0x2ec656=_0x4715ca[_0x4ea024(0x173)]-0x1,_0x4d0459;_0x2ec656>=0x0;_0x2ec656--)(_0x4d0459=_0x4715ca[_0x2ec656])&&(_0x3bd760=_0x4d0459(_0x3bd760)||_0x3bd760);return _0x3bd760;},ot=(_0x5f39b3,_0x200c39)=>(_0x5815c8,_0x1c0fc3)=>_0x200c39(_0x5815c8,_0x1c0fc3,_0x5f39b3);let _e=class{constructor(_0x199827,_0x49449e){const _0x48067f=_0x59d238;this[_0x48067f(0x1c0)]=_0x199827,this[_0x48067f(0x1af)]=_0x49449e;}['transformIMECache'](_0x1c4224){const _0x3486bb=_0x59d238;this[_0x3486bb(0x22a)](_0x1c4224),this[_0x3486bb(0x30c)](_0x1c4224);}['transformRemoteChangeset'](_0x23bb52){const _0x412348=_0x59d238,{unitID:_0x5f324f}=_0x23bb52,_0x318514=this[_0x412348(0x1af)]['getRenderById'](_0x5f324f)[_0x412348(0x310)](_0x484600),{redoCache:_0x16b76a}=_0x318514[_0x412348(0x2b3)]();if(_0x16b76a[_0x412348(0x173)]===0x0)return _0x23bb52;let _0x4fb215=_0x256b31[_0x412348(0x37c)](_0x23bb52['mutations'][0x0]);for(let _0x35fd91=0x0;_0x35fd91<_0x16b76a['length'];_0x35fd91++){const _0x46a3a3={'id':_0x412348(0x1d8),'params':{..._0x16b76a[_0x35fd91]}},_0x51e4cc=this[_0x412348(0x1c0)][_0x412348(0x191)](_0x4fb215,_0x46a3a3,!0x1);if(_0x1ec519(_0x51e4cc))throw _0x51e4cc[_0x412348(0x373)];_0x4fb215=_0x51e4cc[_0x412348(0x246)];}return{..._0x256b31[_0x412348(0x37c)](_0x23bb52),'mutations':[_0x4fb215]};}[_0x59d238(0x22a)](_0x15c39d){const _0x368dd5=_0x59d238,{unitID:_0x118968}=_0x15c39d,_0x455320=this['_renderManagerService'][_0x368dd5(0x32c)](_0x118968)['with'](_0x484600),{undoCache:_0x27990b,redoCache:_0x486159}=_0x455320[_0x368dd5(0x2b3)]();if(_0x27990b[_0x368dd5(0x173)]===0x0||_0x486159['length']===0x0)return;const _0x2d9e9e=[],_0x287b19=[];let _0x3017a8=_0x256b31[_0x368dd5(0x37c)](_0x15c39d[_0x368dd5(0x198)][0x0]),_0x2f6df3=_0x256b31[_0x368dd5(0x37c)](_0x15c39d[_0x368dd5(0x198)][0x0]);for(let _0x15167e=_0x27990b[_0x368dd5(0x173)]-0x1;_0x15167e>=0x0;_0x15167e--){const _0x48bf39={'id':'doc.mutation.rich-text-editing','params':{..._0x27990b[_0x15167e]}},_0x331256={'id':_0x368dd5(0x1d8),'params':{..._0x486159[_0x15167e]}},_0x3640ac=this['_transformService'][_0x368dd5(0x191)](_0x3017a8,_0x48bf39,!0x1),_0x4234de=this[_0x368dd5(0x1c0)][_0x368dd5(0x191)](_0x2f6df3,_0x331256,!0x1);if(_0x1ec519(_0x3640ac))throw _0x3640ac[_0x368dd5(0x373)];if(_0x1ec519(_0x4234de))throw _0x4234de[_0x368dd5(0x373)];_0x2d9e9e[_0x368dd5(0x2fd)](_0x3640ac[_0x368dd5(0x290)]['params']),_0x287b19['unshift'](_0x4234de['m2Prime'][_0x368dd5(0x1a9)]),_0x3017a8=_0x3640ac['m1Prime'],_0x2f6df3=_0x4234de[_0x368dd5(0x246)];}_0x455320[_0x368dd5(0x248)]({'undoCache':_0x2d9e9e,'redoCache':_0x287b19});}[_0x59d238(0x30c)](_0x27635b){const _0x32b05f=_0x59d238,{unitID:_0x160870}=_0x27635b,_0x5a7e4f=this[_0x32b05f(0x1af)]['getRenderById'](_0x160870)[_0x32b05f(0x310)](_0x484600),_0x43b773=_0x5a7e4f['getActiveRange']();if(_0x43b773==null)return;const _0x4223d0=[{'id':_0x32b05f(0x1d8),'params':{'unitId':_0x27635b[_0x32b05f(0x1be)],'actions':null,'textRanges':[_0x43b773]}}],_0x515f03=this['_transformService'][_0x32b05f(0x298)](_0x27635b,_0x4223d0);if(!_0x329f62(_0x515f03))throw _0x515f03['error'];const _0x5f57b6=_0x515f03[_0x32b05f(0x290)][0x0][_0x32b05f(0x1a9)][_0x32b05f(0x1c9)];Array[_0x32b05f(0x1a7)](_0x5f57b6)&&_0x5f57b6[_0x32b05f(0x173)]&&_0x5a7e4f[_0x32b05f(0x16f)](_0x5f57b6[0x0]);}};_e=_n([ot(0x0,_0x415fde),ot(0x1,_0x570600)],_e);var ln=Object[_0x59d238(0x29e)],hn=(_0x423051,_0x419738,_0x5cecfb,_0x549e2d)=>{for(var _0x830bf0=_0x549e2d>0x1?void 0x0:_0x549e2d?ln(_0x419738,_0x5cecfb):_0x419738,_0x312418=_0x423051['length']-0x1,_0x36ad17;_0x312418>=0x0;_0x312418--)(_0x36ad17=_0x423051[_0x312418])&&(_0x830bf0=_0x36ad17(_0x830bf0)||_0x830bf0);return _0x830bf0;},Re=(_0x47d098,_0x3dcb6e)=>(_0x36393c,_0x59acb4)=>_0x3dcb6e(_0x36393c,_0x59acb4,_0x47d098);let le=class{constructor(_0x44e3fa,_0x3246e0,_0x46796c){const _0x3d191f=_0x59d238;this[_0x3d191f(0x23b)]=_0x44e3fa,this[_0x3d191f(0x1c0)]=_0x3246e0,this[_0x3d191f(0x265)]=_0x46796c;}[_0x59d238(0x334)](_0xe68741){const _0x47dd3d=_0x59d238;this[_0x47dd3d(0x2d8)](_0xe68741);}[_0x59d238(0x206)](_0x3a92c2){const _0x51a5a2=_0x59d238,{unitID:_0x56f5ad}=_0x3a92c2,{collaboration:_0x161d7e}=this[_0x51a5a2(0x265)][_0x51a5a2(0x320)](_0x56f5ad);if(_0x161d7e['length']===0x0)return _0x3a92c2;let _0x227836=_0x256b31['deepClone'](_0x3a92c2['mutations'][0x0]);for(let _0x2584d4=0x0;_0x2584d4<_0x161d7e[_0x51a5a2(0x173)];_0x2584d4++){const _0xec201b={'id':'doc.mutation.rich-text-editing','params':{'unitId':_0x161d7e[_0x2584d4][_0x51a5a2(0x19d)],..._0x161d7e[_0x2584d4][_0x51a5a2(0x23a)]}},_0x19e8b0=this[_0x51a5a2(0x1c0)][_0x51a5a2(0x191)](_0x227836,_0xec201b,!0x1);if(_0x1ec519(_0x19e8b0))throw _0x19e8b0[_0x51a5a2(0x373)];_0x227836=_0x19e8b0[_0x51a5a2(0x246)];}return{..._0x256b31[_0x51a5a2(0x37c)](_0x3a92c2),'mutations':[_0x227836]};}[_0x59d238(0x2d8)](_0x39a179){const _0x3c6524=_0x59d238,{unitID:_0x21f1be}=_0x39a179,{history:_0x445b51,collaboration:_0x5b54f2}=this[_0x3c6524(0x265)][_0x3c6524(0x320)](_0x21f1be);if(_0x445b51[_0x3c6524(0x173)]===0x0&&_0x5b54f2[_0x3c6524(0x173)]===0x0)return;const _0x13e899=[],_0x53f105=[];let _0x639263=_0x256b31[_0x3c6524(0x37c)](_0x39a179[_0x3c6524(0x198)][0x0]),_0x5bdb11=_0x256b31[_0x3c6524(0x37c)](_0x39a179[_0x3c6524(0x198)][0x0]);for(let _0xbb6151=_0x445b51['length']-0x1;_0xbb6151>=0x0;_0xbb6151--){const _0x3949e6={'id':_0x3c6524(0x1d8),'params':{'unitId':_0x445b51[_0xbb6151]['unitId'],..._0x445b51[_0xbb6151][_0x3c6524(0x390)]}},_0x274105={'id':_0x3c6524(0x1d8),'params':{'unitId':_0x445b51[_0xbb6151]['unitId'],..._0x445b51[_0xbb6151][_0x3c6524(0x23a)]}},_0x37ae5c=this[_0x3c6524(0x1c0)][_0x3c6524(0x191)](_0x639263,_0x3949e6,!0x1),_0x3bda8f=this[_0x3c6524(0x1c0)]['transformMutation'](_0x5bdb11,_0x274105,!0x1);if(_0x1ec519(_0x37ae5c))throw _0x37ae5c['error'];if(_0x1ec519(_0x3bda8f))throw _0x3bda8f[_0x3c6524(0x373)];_0x13e899[_0x3c6524(0x2fd)]({..._0x445b51[_0xbb6151],'undoState':_0x37ae5c[_0x3c6524(0x290)][_0x3c6524(0x1a9)],'redoState':_0x3bda8f[_0x3c6524(0x290)]['params']}),_0x639263=_0x37ae5c[_0x3c6524(0x246)],_0x5bdb11=_0x3bda8f['m1Prime'];}_0x639263=_0x256b31[_0x3c6524(0x37c)](_0x39a179[_0x3c6524(0x198)][0x0]),_0x5bdb11=_0x256b31[_0x3c6524(0x37c)](_0x39a179[_0x3c6524(0x198)][0x0]);for(let _0xc01855=_0x5b54f2[_0x3c6524(0x173)]-0x1;_0xc01855>=0x0;_0xc01855--){const _0xc60ca1={'id':'doc.mutation.rich-text-editing','params':{'unitId':_0x5b54f2[_0xc01855][_0x3c6524(0x19d)],..._0x5b54f2[_0xc01855][_0x3c6524(0x390)]}},_0xb7066a={'id':_0x3c6524(0x1d8),'params':{'unitId':_0x5b54f2[_0xc01855][_0x3c6524(0x19d)],..._0x5b54f2[_0xc01855][_0x3c6524(0x23a)]}},_0xeb15f2=this[_0x3c6524(0x1c0)]['transformMutation'](_0x639263,_0xc60ca1,!0x1),_0x4f7c99=this[_0x3c6524(0x1c0)][_0x3c6524(0x191)](_0x5bdb11,_0xb7066a,!0x1);if(_0x1ec519(_0xeb15f2))throw _0xeb15f2['error'];if(_0x1ec519(_0x4f7c99))throw _0x4f7c99['error'];_0x53f105['unshift']({..._0x5b54f2[_0xc01855],'undoState':_0xeb15f2['m2Prime']['params'],'redoState':_0x4f7c99[_0x3c6524(0x290)][_0x3c6524(0x1a9)]}),_0x639263=_0xeb15f2[_0x3c6524(0x246)],_0x5bdb11=_0x4f7c99[_0x3c6524(0x246)];}this[_0x3c6524(0x265)][_0x3c6524(0x2dd)](_0x21f1be,{'history':_0x13e899,'collaboration':_0x53f105});}};le=hn([Re(0x0,_0x43bd7d(_0x504c4c)),Re(0x1,_0x415fde),Re(0x2,_0x43bd7d(_0x3a3fe8))],le);var un=Object['getOwnPropertyDescriptor'],dn=(_0x144287,_0x50b337,_0x2338dc,_0x377292)=>{const _0x426747=_0x59d238;for(var _0x2384ba=_0x377292>0x1?void 0x0:_0x377292?un(_0x50b337,_0x2338dc):_0x50b337,_0x7c28cd=_0x144287[_0x426747(0x173)]-0x1,_0x378450;_0x7c28cd>=0x0;_0x7c28cd--)(_0x378450=_0x144287[_0x7c28cd])&&(_0x2384ba=_0x378450(_0x2384ba)||_0x2384ba);return _0x2384ba;},at=(_0x2f1641,_0x2fe8ce)=>(_0x2878e7,_0x38a46c)=>_0x2fe8ce(_0x2878e7,_0x38a46c,_0x2f1641);let he=class{constructor(_0x29615e,_0x4cbb49){const _0x162f9d=_0x59d238;this[_0x162f9d(0x23b)]=_0x29615e,this['_transformService']=_0x4cbb49;}['transformSelections'](_0xdd675){const _0x4dd9ba=_0x59d238;var _0x2a8a62;const _0x306b80=this[_0x4dd9ba(0x23b)][_0x4dd9ba(0x1b4)](_0x527b66),_0x2ba74a=(_0x2a8a62=_0x306b80[_0x4dd9ba(0x360)]())!=null?_0x2a8a62:[];if(_0x2ba74a[_0x4dd9ba(0x173)]===0x0)return;const _0x1160b4=_0xdd675[_0x4dd9ba(0x1be)],_0x2db4e2=[{'id':'doc.mutation.rich-text-editing','params':{'unitId':_0x1160b4,'actions':null,'textRanges':_0x2ba74a}}],_0x8eb3ae=this[_0x4dd9ba(0x1c0)][_0x4dd9ba(0x298)](_0xdd675,_0x2db4e2);if(!_0x329f62(_0x8eb3ae))throw _0x8eb3ae[_0x4dd9ba(0x373)];const _0x32cd61=_0x8eb3ae[_0x4dd9ba(0x290)][0x0][_0x4dd9ba(0x1a9)][_0x4dd9ba(0x1c9)];Array[_0x4dd9ba(0x1a7)](_0x32cd61)&&_0x32cd61[_0x4dd9ba(0x173)]&&_0x306b80['replaceDocRanges'](_0x32cd61,{'unitId':_0x1160b4,'subUnitId':_0x1160b4},!0x1);}};he=dn([at(0x0,_0x43bd7d(_0x504c4c)),at(0x1,_0x415fde)],he);var Sn=Object[_0x59d238(0x29e)],In=(_0x38ab2e,_0x1ea82d,_0xc2c3c5,_0x498a85)=>{const _0x54ae5b=_0x59d238;for(var _0x12ef26=_0x498a85>0x1?void 0x0:_0x498a85?Sn(_0x1ea82d,_0xc2c3c5):_0x1ea82d,_0x56add7=_0x38ab2e[_0x54ae5b(0x173)]-0x1,_0x8be8a9;_0x56add7>=0x0;_0x56add7--)(_0x8be8a9=_0x38ab2e[_0x56add7])&&(_0x12ef26=_0x8be8a9(_0x12ef26)||_0x12ef26);return _0x12ef26;},b=(_0x322909,_0x2f4c1e)=>(_0xfc77ff,_0x5a1d5b)=>_0x2f4c1e(_0xfc77ff,_0x5a1d5b,_0x322909);let ue=class extends _0x4c1835{constructor(_0x3b6222,_0x14dd64,_0x162044,_0x146a27,_0x50345f,_0x57c23b,_0x2a3821,_0x1372a6){const _0x3c1849=_0x59d238;super(),l(this,_0x3c1849(0x33c),new _0x7b2298(_0x2dbbe4[_0x3c1849(0x218)])),(this[_0x3c1849(0x265)]=_0x3b6222,this['_collaborationController']=_0x14dd64,this['_docTransformIMECacheService']=_0x162044,this[_0x3c1849(0x2ae)]=_0x146a27,this[_0x3c1849(0x358)]=_0x50345f,this[_0x3c1849(0x251)]=_0x57c23b,this[_0x3c1849(0x37b)]=_0x2a3821,this['_localeService']=_0x1372a6,this[_0x3c1849(0x391)]());}['_initEntityListener'](){const _0xa847f2=_0x59d238;this[_0xa847f2(0x26d)](this[_0xa847f2(0x1dc)][_0xa847f2(0x228)]['subscribe'](_0x4c4b88=>{const _0x2c1574=_0xa847f2,_0x3209b5=this[_0x2c1574(0x265)]['docStateChange$'][_0x2c1574(0x171)](_0x12fa70=>{const _0x2c59b0=_0x2c1574;if(_0x12fa70==null)return;const {unitId:_0x52d2df,redoState:_0x39b476,commandId:_0x3c1426}=_0x12fa70;if(_0x52d2df!==_0x4c4b88[_0x2c59b0(0x1be)])return;const _0x36414e={'id':_0x3c1426,'type':_0x1106f7[_0x2c59b0(0x240)],'params':{'unitId':_0x52d2df,'actions':_0x39b476[_0x2c59b0(0x2d4)],'textRanges':null}};_0x4c4b88[_0x2c59b0(0x1cf)](_0x36414e);});if(_0x4c4b88[_0x2c1574(0x26d)](_0x3209b5),_0x4c4b88 instanceof _0x1c0711){const _0x4f92aa={'onTransformIME':_0x111e6a=>this[_0x2c1574(0x332)][_0x2c1574(0x386)](_0x111e6a),'onTransformState':_0x53907b=>this[_0x2c1574(0x2ae)]['transformStateCache'](_0x53907b),'onTransformSelections':_0x1f6499=>this[_0x2c1574(0x358)][_0x2c1574(0x22f)](_0x1f6499),'onSyncEditingCollabCursor':_0x4fe18f=>this[_0x2c1574(0x251)][_0x2c1574(0x1a2)](_0x4fe18f),'onTransformRemoteChangesetByIMECache':_0x57c477=>this['_docTransformIMECacheService'][_0x2c1574(0x206)](_0x57c477),'onTransformRemoteChangesetByStateCache':_0x179b79=>this[_0x2c1574(0x2ae)][_0x2c1574(0x206)](_0x179b79)};_0x4c4b88['addHandlerCallback'](_0x4f92aa);}}));}};ue=In([b(0x0,_0x43bd7d(_0x3a3fe8)),b(0x1,_0x43bd7d(_0x48b193)),b(0x2,_0x43bd7d(_e)),b(0x3,_0x43bd7d(le)),b(0x4,_0x43bd7d(he)),b(0x5,_0x43bd7d(Xe)),b(0x6,_0x258372),b(0x7,_0x43bd7d(_0x36a5ba))],ue);var Z=(_0x248691=>(_0x248691[_0x248691[_0x59d238(0x2ec)]=0x0]=_0x59d238(0x2ec),_0x248691[_0x248691['OK']=0x1]='OK',_0x248691[_0x248691[_0x59d238(0x326)]=0x2]=_0x59d238(0x326),_0x248691[_0x248691[_0x59d238(0x2c2)]=0x3]=_0x59d238(0x2c2),_0x248691[_0x248691['NOT_FOUND']=0x4]=_0x59d238(0x2f3),_0x248691[_0x248691[_0x59d238(0x1bc)]=0x5]=_0x59d238(0x1bc),_0x248691[_0x248691[_0x59d238(0x315)]=0x6]='ALREADY_EXISTS',_0x248691[_0x248691[_0x59d238(0x2af)]=0x7]='INVALID_ARGUMENT',_0x248691[_0x248691[_0x59d238(0x2ce)]=0x8]=_0x59d238(0x2ce),_0x248691[_0x248691[_0x59d238(0x2d3)]=0x9]=_0x59d238(0x2d3),_0x248691[_0x248691['LOGIN_FAILED']=0xa]=_0x59d238(0x17b),_0x248691[_0x248691[_0x59d238(0x293)]=0xb]='MOBILE_VERIFY_CODE_MISMATCH',_0x248691[_0x248691[_0x59d238(0x319)]=0xc]=_0x59d238(0x319),_0x248691[_0x248691[_0x59d238(0x364)]=0xd]='EMAIL_VERIFY_CODE_MISMATCH',_0x248691[_0x248691[_0x59d238(0x25a)]=0xe]='EMAIL_VERIFY_CODE_NOT_FOUND_OR_EXPIRED',_0x248691[_0x248691['AUTHORIZE_CODE_ILLEGAL']=0xf]='AUTHORIZE_CODE_ILLEGAL',_0x248691[_0x248691[_0x59d238(0x345)]=0x10]=_0x59d238(0x345),_0x248691[_0x248691[_0x59d238(0x299)]=0x64]=_0x59d238(0x299),_0x248691[_0x248691[_0x59d238(0x375)]=0x65]=_0x59d238(0x375),_0x248691[_0x248691[_0x59d238(0x2b5)]=0xc9]=_0x59d238(0x2b5),_0x248691[_0x248691[_0x59d238(0x34d)]=0xca]='USER_IS_ANONYMOUS',_0x248691[_0x248691[_0x59d238(0x1db)]=0x1389]=_0x59d238(0x1db),_0x248691[_0x248691[_0x59d238(0x2fe)]=0x1771]=_0x59d238(0x2fe),_0x248691[_0x248691['SNAPSHOT_HAS_BEEN_REMOVED']=0x1772]=_0x59d238(0x1aa),_0x248691[_0x248691['ENSURE_SNAPSHOT_EXECUTION']=0x1773]=_0x59d238(0x2cc),_0x248691[_0x248691[_0x59d238(0x2a6)]=0x1b59]='APPLY_REJECT',_0x248691[_0x248691[_0x59d238(0x209)]=0x1b5a]=_0x59d238(0x209),_0x248691[_0x248691[_0x59d238(0x16e)]=0x1b5b]=_0x59d238(0x16e),_0x248691[_0x248691[_0x59d238(0x19e)]=0x1b5c]=_0x59d238(0x19e),_0x248691[_0x248691['APPLY_DUPLICATED']=0x1b5d]=_0x59d238(0x397),_0x248691[_0x248691[_0x59d238(0x263)]=0x1f41]=_0x59d238(0x263),_0x248691[_0x248691['LICENSE_MAX_UNITS_EXCEEDED']=0x2329]=_0x59d238(0x2e9),_0x248691[_0x248691[_0x59d238(0x36d)]=0x232a]=_0x59d238(0x36d),_0x248691[_0x248691[_0x59d238(0x24e)]=0x232b]='LICENSE_IMPORT_SIZE_EXCEEDED',_0x248691[_0x248691[_0x59d238(0x258)]=0x232c]=_0x59d238(0x258),_0x248691[_0x248691[_0x59d238(0x346)]=0x232d]=_0x59d238(0x346),_0x248691[_0x248691['YUUMI_UNABLE_LOAD_URL']=0x2711]=_0x59d238(0x196),_0x248691[_0x248691[_0x59d238(0x36e)]=0x2712]=_0x59d238(0x36e),_0x248691[_0x248691['YUUMI_RATE_OVER_LIMIT']=0x2713]='YUUMI_RATE_OVER_LIMIT',_0x248691[_0x248691[_0x59d238(0x2ea)]=0x2714]=_0x59d238(0x2ea),_0x248691[_0x248691['YUUMI_NO_CUBOID_FOR_QUESTION']=0x271a]='YUUMI_NO_CUBOID_FOR_QUESTION',_0x248691[_0x248691[_0x59d238(0x355)]=0x271b]='YUUMI_ASYNCIO_CANCELLED',_0x248691[_0x248691[_0x59d238(0x1c3)]=0x271c]=_0x59d238(0x1c3),_0x248691[_0x248691['YUUMI_ALL_TABLES_IS_INVALID']=0x271d]=_0x59d238(0x1c7),_0x248691[_0x248691['YUUMI_PROMPT_MAX_TOKENS_EXCEEDED']=0x271e]=_0x59d238(0x252),_0x248691[_0x248691[_0x59d238(0x26a)]=0x271f]=_0x59d238(0x26a),_0x248691[_0x248691[_0x59d238(0x1f3)]=0x2720]='YUUMI_CONNECTOR_URL_NOT_FOUND',_0x248691[_0x248691['PY_RUNTIME_SCRIPT_ERROR']=0x2af9]='PY_RUNTIME_SCRIPT_ERROR',_0x248691[_0x248691['INVITE_CODE_HAS_BEEN_UES']=0x2ee1]=_0x59d238(0x16a),_0x248691[_0x248691[_0x59d238(0x2ab)]=0x2ee2]=_0x59d238(0x2ab),_0x248691[_0x248691[_0x59d238(0x16b)]=0x2ee3]=_0x59d238(0x16b),_0x248691[_0x248691['USER_NOT_INVITED_CODE']=0x2ee4]=_0x59d238(0x393),_0x248691[_0x248691[_0x59d238(0x1b8)]=0x2ee5]='INVITE_CODE_ALREADY_BOUND',_0x248691[_0x248691[_0x59d238(0x1eb)]=0x32c9]=_0x59d238(0x1eb),_0x248691[_0x248691[_0x59d238(0x21d)]=0x32ca]=_0x59d238(0x21d),_0x248691[_0x248691[_0x59d238(0x2d1)]=0x32cb]=_0x59d238(0x2d1),_0x248691[_0x248691[_0x59d238(0x211)]=0x36b1]=_0x59d238(0x211),_0x248691[_0x248691[_0x59d238(0x27e)]=0x36b2]=_0x59d238(0x27e),_0x248691[_0x248691[_0x59d238(0x1a5)]=0x36b3]=_0x59d238(0x1a5),_0x248691[_0x248691[_0x59d238(0x349)]=0x36b4]='PAYMENT_CHANNEL_NOT_SUPPORT',_0x248691[_0x248691['ENTITLE_CHAT_LIMIT_EXCEED']=0x3715]=_0x59d238(0x2d5),_0x248691[_0x248691[_0x59d238(0x2bf)]=0x3716]=_0x59d238(0x2bf),_0x248691[_0x248691[_0x59d238(0x2fc)]=0x3717]='ENTITLE_INSUFFICIENT_QUOTA',_0x248691[_0x248691['ENTITLE_NEED_BILLING_ADDRESS']=0x37dd]=_0x59d238(0x341),_0x248691[_0x248691['REDEMPTION_INVALID_CODE']=0x3a99]=_0x59d238(0x31e),_0x248691[_0x248691[_0x59d238(0x1a1)]=0x3a9a]=_0x59d238(0x1a1),_0x248691[_0x248691[_0x59d238(0x168)]=0x3a9b]='REDEMPTION_CODE_FULLY_REDEEMED',_0x248691[_0x248691['REDEMPTION_CODE_NOT_STARTED']=0x3a9c]=_0x59d238(0x1ec),_0x248691[_0x248691[_0x59d238(0x37a)]=0x3a9d]='REDEMPTION_USER_NOT_ELIGIBLE',_0x248691[_0x248691[_0x59d238(0x32f)]=0x3a9e]=_0x59d238(0x32f),_0x248691[_0x248691[_0x59d238(0x338)]=0x3a9f]=_0x59d238(0x338),_0x248691[_0x248691[_0x59d238(0x169)]=0x3e81]=_0x59d238(0x169),_0x248691[_0x248691[_0x59d238(0x324)]=-0x1]='UNRECOGNIZED',_0x248691))(Z||{});function mn(_0x595d77){const _0x3a4933=_0x59d238;var _0x41af81,_0x2b9ac4;const _0x113389=(_0x41af81=_0x595d77['stageInfo'])==null?void 0x0:_0x41af81[_0x3a4933(0x25d)],_0x27a7ef=((_0x2b9ac4=_0x595d77['stageInfo'])==null?void 0x0:_0x2b9ac4['totalFormulasToCalculate'])||0x0;return _0x113389===_0x5be4ae[_0x3a4933(0x352)]&&_0x27a7ef>0x0;}function fn(_0x3bd0c6){const _0x290aa3=_0x59d238;return _0x3bd0c6[_0x290aa3(0x371)]===_0x238118[_0x290aa3(0x1f0)];}var gn=Object['getOwnPropertyDescriptor'],vn=(_0x491176,_0x10ab90,_0x5034dd,_0x10438e)=>{for(var _0x36ca6b=_0x10438e>0x1?void 0x0:_0x10438e?gn(_0x10ab90,_0x5034dd):_0x10ab90,_0x4e5a93=_0x491176['length']-0x1,_0x339a63;_0x4e5a93>=0x0;_0x4e5a93--)(_0x339a63=_0x491176[_0x4e5a93])&&(_0x36ca6b=_0x339a63(_0x36ca6b)||_0x36ca6b);return _0x36ca6b;},P=(_0x54a288,_0x449f71)=>(_0x2f2406,_0xe34441)=>_0x449f71(_0x2f2406,_0xe34441,_0x54a288);const En='/universer-api/license/formula/limit/status',pn=_0x59d238(0x26c),On=_0x59d238(0x190);let de=class extends _0x4c1835{constructor(_0x106b70,_0x45201a,_0x57b72c,_0x3c2a0a,_0x5ca943,_0x5b184a,_0x280a44){const _0x8b8a67=_0x59d238;super(),l(this,_0x8b8a67(0x21e),null),l(this,_0x8b8a67(0x2d6),0x0),l(this,_0x8b8a67(0x2fa),0x0),l(this,_0x8b8a67(0x330),[]),l(this,_0x8b8a67(0x2cb),0x0),(this[_0x8b8a67(0x37b)]=_0x106b70,this[_0x8b8a67(0x304)]=_0x45201a,this[_0x8b8a67(0x2b0)]=_0x57b72c,this[_0x8b8a67(0x247)]=_0x3c2a0a,this['_univerInstanceService']=_0x5ca943,this[_0x8b8a67(0x1de)]=_0x5b184a,this['_localeService']=_0x280a44,this['_initCommandInterceptor']());}[_0x59d238(0x38e)](){const _0x133c5f=_0x59d238;this[_0x133c5f(0x26d)](this[_0x133c5f(0x304)]['beforeCommandExecuted']((_0x12c320,_0x4d7312)=>{const _0x4c5a9e=_0x133c5f;var _0x23cd44;if(_0x12c320['id']!==_0x5d708a['id'])return;const _0x33c777=_0x12c320['params'];if(!this['_hasFormulaInDirtyRanges']((_0x23cd44=_0x33c777['dirtyRanges'])!=null?_0x23cd44:[]))return;if(!this[_0x4c5a9e(0x2fb)]())throw this[_0x4c5a9e(0x272)](_0x12c320,_0x4d7312),this[_0x4c5a9e(0x29d)](),new _0x56d586();})),this['disposeWithMe'](this[_0x133c5f(0x304)]['onCommandExecuted']((_0xf7692b,_0x356b0f)=>{const _0x245f77=_0x133c5f;if(_0xf7692b['id']!==_0x51ab39['id'])return;const _0xf1b40=_0xf7692b['params'];if(mn(_0xf1b40)){const _0x15deb6=_0xcfedbd();this[_0x245f77(0x330)][_0x245f77(0x235)](_0x15deb6),this[_0x245f77(0x2f6)](_0x15deb6);}else{if(fn(_0xf1b40)&&this['_taskIds'][_0x245f77(0x173)]>0x0){const _0x275ded=this[_0x245f77(0x330)]['shift']();this['_releaseCalculationLimit'](_0x275ded);}}}));}[_0x59d238(0x183)](){const _0x256796=_0x59d238;super['dispose'](),this['_clearPolling'](),this[_0x256796(0x330)]=[],this[_0x256796(0x2fa)]=0x0,this[_0x256796(0x2d6)]=0x0,this['_lastResponseTimestamp']=0x0;}async[_0x59d238(0x272)](_0x128045,_0x26f0f6){const _0x157b65=_0x59d238;for(let _0x5c74ee=0x0;_0x5c74ee<0x1e;_0x5c74ee++)try{if(await this[_0x157b65(0x382)](),this[_0x157b65(0x2fb)]()){this[_0x157b65(0x224)](_0x128045,_0x26f0f6),this[_0x157b65(0x37b)][_0x157b65(0x28a)]({'content':this[_0x157b65(0x295)]['t']('formula.calculation.started'),'type':_0x2a0f31[_0x157b65(0x276)]});return;}await new Promise(_0x3b8c04=>{const _0x37a5fd=_0x157b65;this['_pollingInterval']=window[_0x37a5fd(0x243)](_0x3b8c04,0x3e8);});}catch(_0x3d0b76){this[_0x157b65(0x1de)][_0x157b65(0x373)](_0x3d0b76);}this[_0x157b65(0x37b)][_0x157b65(0x28a)]({'content':this['_localeService']['t'](_0x157b65(0x1d9)),'type':_0x2a0f31[_0x157b65(0x29b)]});}[_0x59d238(0x224)](_0x208ae9,_0x337941){const _0x1b70ed=_0x59d238;try{this[_0x1b70ed(0x304)][_0x1b70ed(0x1b9)](_0x208ae9['id'],_0x208ae9['params'],_0x337941);}catch(_0x2de1fa){this[_0x1b70ed(0x1de)][_0x1b70ed(0x373)](_0x2de1fa);}}[_0x59d238(0x27c)](_0x562a46,_0x271345){const _0x2ce586=_0x59d238;_0x271345<this[_0x2ce586(0x2cb)]||(this[_0x2ce586(0x2cb)]=_0x271345,this[_0x2ce586(0x2d6)]=Number[_0x2ce586(0x36a)](_0x562a46[_0x2ce586(0x27a)]),this['_currentUsage']=Number['parseInt'](_0x562a46[_0x2ce586(0x2df)]));}async[_0x59d238(0x2f6)](_0x56e1da){const _0x2e58cb=_0x59d238;var _0x52deff,_0x5597d6;const _0x45a0da=Date[_0x2e58cb(0x2bd)]();try{const _0x1c5c38=((_0x52deff=this['_configService'][_0x2e58cb(0x229)](_0x4fca11))==null?void 0x0:_0x52deff['startFormulaLimitUrl'])||pn,_0x3b1a9c=(await this[_0x2e58cb(0x247)][_0x2e58cb(0x2cf)](_0x1c5c38,{'body':JSON['stringify']({'taskId':_0x56e1da})}))[_0x2e58cb(0x2c8)];if(((_0x5597d6=_0x3b1a9c[_0x2e58cb(0x373)])==null?void 0x0:_0x5597d6[_0x2e58cb(0x2a5)])!==Z['OK'])return;this[_0x2e58cb(0x27c)](_0x3b1a9c[_0x2e58cb(0x357)],_0x45a0da);}catch(_0x54da3e){this[_0x2e58cb(0x1de)][_0x2e58cb(0x373)](_0x54da3e);}}async[_0x59d238(0x382)](_0x432f8d){const _0x348b8f=_0x59d238;var _0x3f335f,_0x2a842e;const _0x36e572=Date[_0x348b8f(0x2bd)]();try{const _0x192116=((_0x3f335f=this['_configService'][_0x348b8f(0x229)](_0x4fca11))==null?void 0x0:_0x3f335f[_0x348b8f(0x20f)])||En,_0xec42ac=_0x432f8d?_0x192116+'?taskId='+encodeURIComponent(_0x432f8d):_0x192116,_0x2b95e3=(await this['_httpService'][_0x348b8f(0x1b4)](_0xec42ac))['body'];if(((_0x2a842e=_0x2b95e3[_0x348b8f(0x373)])==null?void 0x0:_0x2a842e[_0x348b8f(0x2a5)])!==Z['OK'])return;this['_setFormulaLimitStatus'](_0x2b95e3[_0x348b8f(0x357)],_0x36e572);}catch(_0x266bae){this[_0x348b8f(0x1de)][_0x348b8f(0x373)](_0x266bae);}}async[_0x59d238(0x1a3)](_0x21b51b){const _0x48c32c=_0x59d238;var _0x2e66eb,_0x41a481;const _0xa53243=Date[_0x48c32c(0x2bd)]();try{const _0x20c042=((_0x2e66eb=this[_0x48c32c(0x2b0)]['getConfig'](_0x4fca11))==null?void 0x0:_0x2e66eb[_0x48c32c(0x2ad)])||On,_0x3d0e13=(await this[_0x48c32c(0x247)][_0x48c32c(0x2cf)](_0x20c042,{'body':JSON['stringify']({'taskId':_0x21b51b})}))[_0x48c32c(0x2c8)];if(((_0x41a481=_0x3d0e13['error'])==null?void 0x0:_0x41a481[_0x48c32c(0x2a5)])!==Z['OK'])return;this[_0x48c32c(0x27c)](_0x3d0e13[_0x48c32c(0x357)],_0xa53243);}catch(_0x167d11){this[_0x48c32c(0x1de)][_0x48c32c(0x373)](_0x167d11);}}['_checkCalculationAvailable'](){const _0xfe483f=_0x59d238;return this[_0xfe483f(0x2d6)]===0x0?!0x0:this['_maxFormulaLimit']-this[_0xfe483f(0x2fa)]>0x0;}[_0x59d238(0x2ca)](){const _0x240d0d=_0x59d238;this[_0x240d0d(0x21e)]&&(clearTimeout(this[_0x240d0d(0x21e)]),this[_0x240d0d(0x21e)]=null);}['_showGuardMessage'](){const _0x124017=_0x59d238;this['_messageService'][_0x124017(0x28a)]({'content':this[_0x124017(0x295)]['t']('formula.calculation.waiting'),'type':_0x2a0f31['Loading']});}[_0x59d238(0x33f)](_0x4c9826){const _0x35d8cb=_0x59d238;for(const _0x5a1d85 of _0x4c9826){const {unitId:_0x1f7473,sheetId:_0x29f733,range:_0x59cffa}=_0x5a1d85,_0xf1e75a=this[_0x35d8cb(0x284)]['getUnit'](_0x1f7473);if(!_0xf1e75a)continue;const _0x4c3885=_0xf1e75a[_0x35d8cb(0x342)](_0x29f733);if(!_0x4c3885)continue;const _0x117905=_0x4c3885[_0x35d8cb(0x174)]();for(let _0x1906a0=_0x59cffa['startRow'];_0x1906a0<=_0x59cffa[_0x35d8cb(0x2cd)];_0x1906a0++)for(let _0x3aebfe=_0x59cffa[_0x35d8cb(0x381)];_0x3aebfe<=_0x59cffa[_0x35d8cb(0x314)];_0x3aebfe++){const _0x12676a=_0x117905[_0x35d8cb(0x1fd)](_0x1906a0,_0x3aebfe);if(_0x12676a&&(_0x1017c7(_0x12676a['f'])||_0x13573c(_0x12676a['si'])))return!0x0;}}return!0x1;}};de=vn([P(0x0,_0x43bd7d(_0x258372)),P(0x1,_0x831c33),P(0x2,_0x4d7dbb),P(0x3,_0x43bd7d(_0x393f45)),P(0x4,_0x21d94f),P(0x5,_0x5be773),P(0x6,_0x43bd7d(_0x36a5ba))],de);var Tn=Object['getOwnPropertyDescriptor'],Cn=(_0x320050,_0x10505d,_0x26d2db,_0x33107b)=>{const _0x510d96=_0x59d238;for(var _0x12d2e6=_0x33107b>0x1?void 0x0:_0x33107b?Tn(_0x10505d,_0x26d2db):_0x10505d,_0x2908b9=_0x320050[_0x510d96(0x173)]-0x1,_0x57c930;_0x2908b9>=0x0;_0x2908b9--)(_0x57c930=_0x320050[_0x2908b9])&&(_0x12d2e6=_0x57c930(_0x12d2e6)||_0x12d2e6);return _0x12d2e6;},De=(_0xff0ee2,_0x20b6d7)=>(_0x3caf17,_0x3b8f15)=>_0x20b6d7(_0x3caf17,_0x3b8f15,_0xff0ee2);let xe=class extends _0x4c1835{constructor(_0x3eee56,_0x2fede3,_0x3d7edf){const _0x339171=_0x59d238;super(),l(this,_0x339171(0x19c),new Map()),l(this,'_saveTaskMap',new Map()),l(this,_0x339171(0x28d),!0x1),(this[_0x339171(0x2b0)]=_0x3eee56,this[_0x339171(0x202)]=_0x2fede3,this[_0x339171(0x2ee)]=_0x3d7edf);}[_0x59d238(0x18a)](){const _0x208d01=_0x59d238;this[_0x208d01(0x28d)]=!0x0;}[_0x59d238(0x398)](){const _0x55f804=_0x59d238;this[_0x55f804(0x28d)]=!0x1;}get[_0x59d238(0x259)](){const _0x5a84bb=_0x59d238;return this[_0x5a84bb(0x356)];}[_0x59d238(0x183)](){const _0x2cc85c=_0x59d238;this[_0x2cc85c(0x2f0)]()['then'](()=>super[_0x2cc85c(0x183)]());}async[_0x59d238(0x303)](_0x4c7c0c){const _0x10daca=_0x59d238;return this[_0x10daca(0x28d)]?null:this['_localStorageService'][_0x10daca(0x34b)](_0x5e1edc(_0x4c7c0c));}async[_0x59d238(0x256)](_0x41c58f,_0x4f7601){const _0x435ae4=_0x59d238;return!!this['_localStorageService'][_0x435ae4(0x388)](_0x41c58f,_0x4f7601);}['updateOfflineData'](_0x3c86d2,_0xba0120,_0x1d508f,_0xb4ccb){const _0x4eda92=_0x59d238,_0x349a76=this[_0x4eda92(0x2ee)][_0x4eda92(0x166)](_0x3c86d2);this[_0x4eda92(0x19c)][_0x4eda92(0x2d7)](_0x3c86d2,{'unitID':_0x3c86d2,'type':_0xba0120,'awaitingChangeset':_0x1d508f,'mutations':_0xb4ccb,'rev':_0x349a76}),this[_0x4eda92(0x356)]['has'](_0x3c86d2)||this[_0x4eda92(0x195)](_0x3c86d2);}[_0x59d238(0x195)](_0x558bf2){const _0x351af5=_0x59d238,_0x54d814=this[_0x351af5(0x32e)]();_0x54d814===0x0?this[_0x351af5(0x21b)](_0x558bf2):this[_0x351af5(0x356)][_0x351af5(0x2d7)](_0x558bf2,setTimeout(()=>this[_0x351af5(0x21b)](_0x558bf2),_0x54d814));}[_0x59d238(0x32e)](){const _0x2930a1=_0x59d238;var _0x4ec7ba;return(_0x4ec7ba=this[_0x2930a1(0x2b0)]['getConfig'](_0x5aac96))!=null?_0x4ec7ba:_0x2c30a5;}[_0x59d238(0x21b)](_0x31c6d6){const _0x5a65f2=_0x59d238,_0x24a3fe=this[_0x5a65f2(0x356)]['get'](_0x31c6d6);return _0x24a3fe!==void 0x0&&window[_0x5a65f2(0x394)](_0x24a3fe),this[_0x5a65f2(0x202)][_0x5a65f2(0x388)](_0x5e1edc(_0x31c6d6),this[_0x5a65f2(0x19c)]['get'](_0x31c6d6))[_0x5a65f2(0x204)](()=>this['_saveTaskMap']['delete'](_0x31c6d6));}async['exhaustSavingTask'](){const _0x1a626a=_0x59d238,_0x10c763=[];this[_0x1a626a(0x356)][_0x1a626a(0x1c2)]((_0x284816,_0x1325f1)=>{const _0xbc8ad6=_0x1a626a;window[_0xbc8ad6(0x394)](_0x284816),_0x10c763[_0xbc8ad6(0x235)](this[_0xbc8ad6(0x21b)](_0x1325f1)[_0xbc8ad6(0x204)](()=>{const _0x344c22=_0xbc8ad6;this[_0x344c22(0x356)][_0x344c22(0x351)](_0x1325f1);}));}),await Promise[_0x1a626a(0x194)](_0x10c763);}};xe=Cn([De(0x0,_0x4d7dbb),De(0x1,_0x3e70d2),De(0x2,_0x43bd7d(_0x173db1))],xe);class Rn extends _0x5e1dde{constructor(){const _0x3d1463=_0x59d238;super(),l(this,_0x3d1463(0x1d0)),this[_0x3d1463(0x1d0)]=_0x4ef470(window,_0x3d1463(0x1bb))['pipe'](_0x2d5638(this['dispose$']),_0x2acb86(0x1),_0x2cc8ef(void 0x0));}[_0x59d238(0x16d)](_0x126381,_0x3aeaae,_0x2fc020=!0x1){const _0x4a7d91=_0x59d238,_0x9f2b68=new URL(window[_0x4a7d91(0x1b0)]['href']);_0x9f2b68[_0x4a7d91(0x31c)][_0x4a7d91(0x2d7)](_0x126381,_0x3aeaae),_0x2fc020?window[_0x4a7d91(0x2ed)][_0x4a7d91(0x1c6)]('','',_0x9f2b68['toString']()):window['history']['pushState']('','',_0x9f2b68[_0x4a7d91(0x1ba)]());}[_0x59d238(0x28c)](_0x579459,_0x179f1e=!0x1){const _0x3db3d2=_0x59d238,_0x171bfb=new URL(window['location'][_0x3db3d2(0x1fa)]);_0x171bfb[_0x3db3d2(0x31c)][_0x3db3d2(0x351)](_0x579459),_0x179f1e?window[_0x3db3d2(0x2ed)]['replaceState']('','',_0x171bfb[_0x3db3d2(0x1ba)]()):window[_0x3db3d2(0x2ed)]['pushState']('','',_0x171bfb[_0x3db3d2(0x1ba)]());}[_0x59d238(0x242)](_0x3a6db2){const _0x3b6598=_0x59d238;var _0x3e111c;return(_0x3e111c=new URL(window[_0x3b6598(0x1b0)][_0x3b6598(0x1fa)])[_0x3b6598(0x31c)][_0x3b6598(0x1b4)](_0x3a6db2))!=null?_0x3e111c:void 0x0;}}var Dn=Object[_0x59d238(0x33e)],Nn=Object['getOwnPropertyDescriptor'],bn=(_0x1fdde8,_0x453ca9,_0x554ef5)=>_0x453ca9 in _0x1fdde8?Dn(_0x1fdde8,_0x453ca9,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0x554ef5}):_0x1fdde8[_0x453ca9]=_0x554ef5,Un=(_0x1714f9,_0x1930c2,_0x5b1b90,_0x5076be)=>{for(var _0xfa6367=_0x5076be>0x1?void 0x0:_0x5076be?Nn(_0x1930c2,_0x5b1b90):_0x1930c2,_0x2188d7=_0x1714f9['length']-0x1,_0x3f16aa;_0x2188d7>=0x0;_0x2188d7--)(_0x3f16aa=_0x1714f9[_0x2188d7])&&(_0xfa6367=_0x3f16aa(_0xfa6367)||_0xfa6367);return _0xfa6367;},Ne=(_0x2b7f85,_0x257106)=>(_0x61e78,_0x258362)=>_0x257106(_0x61e78,_0x258362,_0x2b7f85),Ln=(_0x5b6c79,_0xd36efa,_0xe7d03e)=>bn(_0x5b6c79,_0xd36efa+'',_0xe7d03e);const Mn=_0x59d238(0x23c);let Be=class extends _0xc56309{constructor(_0x5a55a0=rt,_0x411e38,_0x2d76f0,_0x287d48){const _0x3a40e2=_0x59d238;super(),this[_0x3a40e2(0x257)]=_0x5a55a0,this[_0x3a40e2(0x1af)]=_0x411e38,this[_0x3a40e2(0x23b)]=_0x2d76f0,this['_configService']=_0x287d48;const {..._0x34d582}=_0x51bab7({},rt,this[_0x3a40e2(0x257)]);this[_0x3a40e2(0x2b0)][_0x3a40e2(0x1da)](an,_0x34d582);}[_0x59d238(0x1f8)](){const _0x1af994=_0x59d238;this[_0x1af994(0x241)](),this['_initDependencies']();}[_0x59d238(0x274)](){this['_registerRenderDependencies']();}[_0x59d238(0x241)](){const _0x3bb4e3=_0x59d238;var _0x492711;const _0x12bcfd=[[je],[de],[he],[_e],[le],[Xe],[At,{'useClass':Rn}],[_0x246f47,{'useClass':_0x55d60d}],[_0x27b0f5,{'useClass':xe}],[oe],[ue],[ce],[H],[Ae],[ae]];_0x34fb2d(this['_injector'],_0x5104c6(_0x12bcfd,(_0x492711=this[_0x3bb4e3(0x257)])==null?void 0x0:_0x492711[_0x3bb4e3(0x297)]));}[_0x59d238(0x323)](){const _0x3576e3=_0x59d238;this['disposeWithMe'](this[_0x3576e3(0x1af)]['registerRenderModule'](_0x4b5311['UNIVER_DOC'],[ye])),this[_0x3576e3(0x26d)](this['_renderManagerService'][_0x3576e3(0x38b)](_0x4b5311[_0x3576e3(0x208)],[$e]));}[_0x59d238(0x221)](){_0x56ad00(this['_injector'],[[H],[oe],[ue],[ce],[ae],[de]]);}};Ln(Be,_0x59d238(0x291),Mn),Be=Un([_0x1363b5(_0xe09d19),Ne(0x1,_0x570600),Ne(0x2,_0x43bd7d(_0x504c4c)),Ne(0x3,_0x4d7dbb)],Be);var An=Object[_0x59d238(0x29e)],Pn=(_0x3ec79f,_0x30eada,_0xb42690,_0x203442)=>{const _0x6cddf5=_0x59d238;for(var _0x3a8b0b=_0x203442>0x1?void 0x0:_0x203442?An(_0x30eada,_0xb42690):_0x30eada,_0x3e6855=_0x3ec79f[_0x6cddf5(0x173)]-0x1,_0x5da4d2;_0x3e6855>=0x0;_0x3e6855--)(_0x5da4d2=_0x3ec79f[_0x3e6855])&&(_0x3a8b0b=_0x5da4d2(_0x3a8b0b)||_0x3a8b0b);return _0x3a8b0b;},J=(_0x33f6b9,_0x2ac31a)=>(_0x3d3204,_0x4b537b)=>_0x2ac31a(_0x3d3204,_0x4b537b,_0x33f6b9);let ct=class extends _0x464143{constructor(_0x4b2307,_0x2f4e24,_0x2d3b76,_0x3abb86,_0x1ba51e){super(_0x4b2307,_0x2f4e24,_0x2d3b76,_0x3abb86,_0x1ba51e);}async[_0x59d238(0x250)](_0x53c344){const _0x13ec1f=_0x59d238,_0x2cc974=await this[_0x13ec1f(0x2db)](),_0x240b7a=this['_createSocketURL'](_0x53c344,_0x2cc974);return this['_doCreateSocket'](_0x240b7a);}[_0x59d238(0x2e6)](_0x582c79,_0x235236){const _0x4773e3=_0x59d238,_0x39d3ea=typeof window>'u'?new URL(_0x582c79):new URL(_0x582c79,window[_0x4773e3(0x1b0)][_0x4773e3(0x234)]);_0x39d3ea[_0x4773e3(0x31c)][_0x4773e3(0x2d7)](_0x4773e3(0x1c5),_0x235236);const _0x4bcd7c=typeof window>'u'?new URLSearchParams():new URLSearchParams(window[_0x4773e3(0x1b0)]['search']);return _0x4bcd7c[_0x4773e3(0x1b4)](_0x4773e3(0x362))&&_0x39d3ea[_0x4773e3(0x31c)][_0x4773e3(0x2d7)](_0x4773e3(0x362),_0x4bcd7c[_0x4773e3(0x1b4)](_0x4773e3(0x362))),_0x39d3ea[_0x4773e3(0x1ba)]();}async['_getSessionTicket'](){const _0xfa499b=_0x59d238;var _0x14c2b5,_0xc5ca34,_0x448768;const _0x417529=this[_0xfa499b(0x2b0)][_0xfa499b(0x229)](_0x4fca11),_0x1c2354=(_0x14c2b5=_0x417529==null?void 0x0:_0x417529['wsSessionTicketUrl'])!=null?_0x14c2b5:_0x2abf97;return(_0x448768=(_0xc5ca34=(await this[_0xfa499b(0x247)][_0xfa499b(0x1b4)](_0x1c2354,{'headers':{'Content-Type':_0xfa499b(0x279)}}))[_0xfa499b(0x2c8)])==null?void 0x0:_0xc5ca34[_0xfa499b(0x1e8)])!=null?_0x448768:'';}};ct=Pn([J(0x0,_0x43bd7d(_0x504c4c)),J(0x1,_0x43bd7d(_0x393f45)),J(0x2,_0x4d7dbb),J(0x3,_0x5be773),J(0x4,_0x142a0a)],ct);var wn=Object['getOwnPropertyDescriptor'],yn=(_0x126c1a,_0xfd7e5b,_0x4a10f9,_0x4bb4cb)=>{const _0x1bcc0c=_0x59d238;for(var _0x3159c5=_0x4bb4cb>0x1?void 0x0:_0x4bb4cb?wn(_0xfd7e5b,_0x4a10f9):_0xfd7e5b,_0x3029e4=_0x126c1a[_0x1bcc0c(0x173)]-0x1,_0x479264;_0x3029e4>=0x0;_0x3029e4--)(_0x479264=_0x126c1a[_0x3029e4])&&(_0x3159c5=_0x479264(_0x3159c5)||_0x3159c5);return _0x3159c5;},be=(_0x26f827,_0x2d6eab)=>(_0x34b6ac,_0x4e94f2)=>_0x2d6eab(_0x34b6ac,_0x4e94f2,_0x26f827);let _t=class extends _0x4c1835{constructor(_0x4108c0,_0x40bef3,_0x46dbf9){const _0x59deb8=_0x59d238;super(),this['_instanceService']=_0x4108c0,this[_0x59deb8(0x247)]=_0x40bef3,this['_configService']=_0x46dbf9;}async['runOnServer'](_0x5550e5,_0x43e917,_0x27259d,..._0x3c98ce){const _0x137f46=_0x59d238;var _0x323931,_0x2515c7,_0x56dd4c,_0x1ced96;const _0x508639=this[_0x137f46(0x322)]['getFocusedUnit']();if(!_0x508639)throw new Error(_0x137f46(0x300));const _0x194603=((_0x323931=this[_0x137f46(0x2b0)][_0x137f46(0x229)](_0x528862))!=null?_0x323931:_0xd9da8)+'/'+_0x5550e5+_0x137f46(0x380)+_0x43e917,_0x3dfb8b=new URL(window[_0x137f46(0x1b0)][_0x137f46(0x1fa)]),_0x18bf22={'scriptId':_0x5550e5,'runId':(_0x2515c7=_0x3dfb8b[_0x137f46(0x31c)]['get'](_0x137f46(0x362)))!=null?_0x2515c7:'','function':_0x43e917,'unitId':_0x508639[_0x137f46(0x2a3)](),'argsOfFunction':JSON[_0x137f46(0x327)](_0x3c98ce),'invokeId':(_0x56dd4c=_0x27259d['invokeId'])!=null?_0x56dd4c:'','executionId':(_0x1ced96=_0x27259d[_0x137f46(0x273)])!=null?_0x1ced96:''};try{const _0x4c6a8b=await this[_0x137f46(0x247)][_0x137f46(0x2cf)](_0x194603,{'body':_0x18bf22});return _0x4c6a8b[_0x137f46(0x2c8)][_0x137f46(0x373)]&&_0x4c6a8b[_0x137f46(0x2c8)][_0x137f46(0x373)][_0x137f46(0x2a5)]!==Z['OK']?_0x137f46(0x296):_0x4c6a8b[_0x137f46(0x2c8)][_0x137f46(0x17e)];}catch{return _0x137f46(0x296);}}};_t=yn([be(0x0,_0x21d94f),be(0x1,_0x43bd7d(_0x393f45)),be(0x2,_0x4d7dbb)],_t);const lt=0x7530,ht=_0x59d238(0x1ca);class tr extends _0x4c1835{constructor(){const _0x3c002f=_0x59d238;super(),l(this,_0x3c002f(0x1a4),_0xcfedbd()),l(this,_0x3c002f(0x21f),new Set()),l(this,_0x3c002f(0x281),new Map()),l(this,_0x3c002f(0x175),null),l(this,_0x3c002f(0x321),new Map()),l(this,_0x3c002f(0x24d),new Map()),this[_0x3c002f(0x254)]();}[_0x59d238(0x183)](){const _0x3a9609=_0x59d238;super[_0x3a9609(0x183)](),this[_0x3a9609(0x321)][_0x3a9609(0x1c2)]((_0x50dc07,_0x42ddfa)=>this[_0x3a9609(0x219)](_0x42ddfa)),this[_0x3a9609(0x175)]&&window[_0x3a9609(0x249)](this['_heartbeatTimer']);}[_0x59d238(0x34c)](_0x666e4f){return this['_ensureSubject'](_0x666e4f)['pipe'](_0x19284c());}[_0x59d238(0x347)](_0x48d1b8){const _0x2442ca=_0x59d238;this[_0x2442ca(0x21f)]['size']===0x0&&this[_0x2442ca(0x170)](),this[_0x2442ca(0x21f)][_0x2442ca(0x1cb)](_0x48d1b8),this['_send']({'type':0x0,'memberID':this[_0x2442ca(0x1a4)],'unitIDs':[_0x48d1b8],'isForwarded':!0x1});}['disposeUnit'](_0x2f5d31){const _0x29fdce=_0x59d238;this[_0x29fdce(0x21f)][_0x29fdce(0x351)](_0x2f5d31),this[_0x29fdce(0x21f)]['size']===0x0&&this[_0x29fdce(0x175)]&&window[_0x29fdce(0x249)](this[_0x29fdce(0x175)]);}[_0x59d238(0x254)](){const _0x3b17e9=_0x59d238;this['disposeWithMe'](_0x38e653(_0x4ef470(window,_0x3b17e9(0x29f))[_0x3b17e9(0x171)](_0x25f281=>{const _0x3c85e0=_0x3b17e9;if(_0x25f281[_0x3c85e0(0x199)]!==ht||!_0x25f281['newValue'])return;const _0x1d45df=JSON[_0x3c85e0(0x348)](_0x25f281[_0x3c85e0(0x1d2)]);this['_handleEvent'](_0x1d45df);}))),window['addEventListener'](_0x3b17e9(0x2f5),()=>this['_send']({'type':0x1,'memberID':this[_0x3b17e9(0x1a4)],'unitIDs':Array[_0x3b17e9(0x2e4)](this[_0x3b17e9(0x21f)])}));}[_0x59d238(0x1a0)](_0x29400d){const _0x59af21=_0x59d238;switch(_0x29400d[_0x59af21(0x22d)]){case 0x0:this[_0x59af21(0x233)](_0x29400d);break;case 0x1:this[_0x59af21(0x39b)](_0x29400d);break;case 0x2:this[_0x59af21(0x1f2)](_0x29400d);break;}}[_0x59d238(0x233)](_0x1c16ac){const _0x41699a=_0x59d238,{unitIDs:_0x45e193,memberID:_0x49ebd0,isForwarded:_0x2075ea}=_0x1c16ac;_0x45e193[_0x41699a(0x1c2)](_0x4282ad=>{const _0x23dec=_0x41699a;if(!_0x2075ea&&this[_0x23dec(0x281)][_0x23dec(0x30b)](_0x4282ad)&&this[_0x23dec(0x185)](_0x4282ad)[_0x23dec(0x27f)](_0x4cd08c['OTHER_CLIENTS_EDITING']),!this[_0x23dec(0x281)]['has'](_0x4282ad)||!this[_0x23dec(0x281)][_0x23dec(0x1b4)](_0x4282ad)[_0x23dec(0x30b)](_0x49ebd0)){const _0x309f2c=this[_0x23dec(0x281)]['get'](_0x4282ad)||new Set();_0x309f2c[_0x23dec(0x1cb)](_0x49ebd0),this['_unitOnClients'][_0x23dec(0x2d7)](_0x4282ad,_0x309f2c),this[_0x23dec(0x165)](_0x49ebd0);}}),_0x2075ea||this['_send']({'type':0x0,'memberID':this[_0x41699a(0x1a4)],'unitIDs':[...this['_selfUnitIDs']],'isForwarded':!0x0});}['_scheduleClearOtherTimer'](_0x1eb295){const _0x55b95e=_0x59d238;this[_0x55b95e(0x219)](_0x1eb295);const _0x1369b8=window[_0x55b95e(0x243)](()=>{const _0x26a40a=_0x55b95e;this[_0x26a40a(0x281)][_0x26a40a(0x1c2)](_0x188072=>{const _0xb710f1=_0x26a40a;_0x188072[_0xb710f1(0x351)](_0x1eb295);});},lt*0x2);this[_0x55b95e(0x321)][_0x55b95e(0x2d7)](_0x1eb295,_0x1369b8);}[_0x59d238(0x219)](_0x55c09b){const _0x736284=_0x59d238;if(this[_0x736284(0x321)][_0x736284(0x30b)](_0x55c09b)){const _0x5bc7ac=this[_0x736284(0x321)]['get'](_0x55c09b);_0x5bc7ac&&window['clearTimeout'](_0x5bc7ac),this[_0x736284(0x321)][_0x736284(0x2d7)](_0x55c09b,null);}}['_handleLeaveEvent'](_0x2f8cb3){const _0x2d3a91=_0x59d238,{memberID:_0x421245,unitIDs:_0x1aa28a}=_0x2f8cb3;_0x1aa28a['forEach'](_0x531062=>{const _0x1d4429=_0x6a51;var _0x99f726;const _0xdabe90=this[_0x1d4429(0x281)]['get'](_0x531062);_0xdabe90&&(_0xdabe90['delete'](_0x421245),(_0x99f726=this['_ensureSubject'](_0x531062))==null||_0x99f726[_0x1d4429(0x27f)](_0xdabe90['size']===0x0?_0x4cd08c[_0x1d4429(0x266)]:_0x4cd08c[_0x1d4429(0x215)]));}),this[_0x2d3a91(0x219)](_0x421245);}[_0x59d238(0x1f2)](_0x5a6cbe){const _0x28fd29=_0x59d238;this[_0x28fd29(0x165)](_0x5a6cbe[_0x28fd29(0x37f)]);}[_0x59d238(0x2f7)](_0x38e38f){const _0x48b0f8=_0x59d238;localStorage[_0x48b0f8(0x388)](ht,JSON[_0x48b0f8(0x327)](_0x38e38f));}[_0x59d238(0x170)](){this['_heartbeatTimer']=window['setInterval'](()=>{const _0x63016f=_0x6a51;this[_0x63016f(0x2f7)]({'type':0x2,'memberID':this[_0x63016f(0x1a4)]});},lt);}['_ensureSubject'](_0xdddc8c){const _0x31fd74=_0x59d238;return this[_0x31fd74(0x24d)][_0x31fd74(0x30b)](_0xdddc8c)||this[_0x31fd74(0x24d)][_0x31fd74(0x2d7)](_0xdddc8c,new _0x7b2298(_0x4cd08c[_0x31fd74(0x266)])),this['_unitStatus']['get'](_0xdddc8c);}}export{ct as BrowserCollaborationSocketService,ae as CollaborationDataLoaderController,oe as DesktopCollaborationStatusDisplayController,At as IURLService,_t as RemoteUniscriptService,qi as SheetCollabCursorShape,Be as UniverCollaborationClientUIPlugin,tr as WebBrowserSingleActiveUnitService,Rn as WebURLService};