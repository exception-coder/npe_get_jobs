'use strict';const _0x322940=_0x2b7c;(function(_0x587cdb,_0x455b41){const _0x24a996=_0x2b7c,_0x153efe=_0x587cdb();while(!![]){try{const _0x71a5dc=-parseInt(_0x24a996(0x2da))/0x1*(-parseInt(_0x24a996(0x20e))/0x2)+-parseInt(_0x24a996(0x384))/0x3+-parseInt(_0x24a996(0x16b))/0x4+-parseInt(_0x24a996(0x3e4))/0x5*(parseInt(_0x24a996(0x3db))/0x6)+parseInt(_0x24a996(0x1b0))/0x7*(-parseInt(_0x24a996(0x1c3))/0x8)+-parseInt(_0x24a996(0x18b))/0x9+parseInt(_0x24a996(0x1c1))/0xa;if(_0x71a5dc===_0x455b41)break;else _0x153efe['push'](_0x153efe['shift']());}catch(_0x131f8c){_0x153efe['push'](_0x153efe['shift']());}}}(_0x384d,0x9d89a));var Ve=Object[_0x322940(0x37d)],Ge=(_0x5346c5,_0x471b68,_0x104d73)=>_0x471b68 in _0x5346c5?Ve(_0x5346c5,_0x471b68,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0x104d73}):_0x5346c5[_0x471b68]=_0x104d73,_=(_0x34f5e6,_0x17e492,_0x213433)=>Ge(_0x34f5e6,typeof _0x17e492!=_0x322940(0x34c)?_0x17e492+'':_0x17e492,_0x213433);Object[_0x322940(0x37d)](exports,Symbol[_0x322940(0x3c3)],{'value':_0x322940(0x1c7)});const M=require('react/jsx-runtime'),u=require('@univerjs-pro/collaboration-client'),a=require('@univerjs/core'),O=require('@univerjs/ui'),I=require('rxjs'),p=require('@univerjs/design'),A=require('react'),Xe=require('@univerjs/rpc'),g=require('@univerjs/sheets'),C=require('@univerjs/engine-render'),G=require('@univerjs/network'),T=require('@univerjs/docs-ui'),Ke=require('@univerjs/drawing'),v=require('@univerjs-pro/collaboration'),W=require('@univerjs/docs'),x=require('@univerjs/engine-formula'),$=require('rxjs/operators'),z=require('@univerjs/sheets-ui');function Ce({ref:_0x4517c9,..._0x356224}){const _0x561d46=_0x322940,{icon:_0x31b328,id:_0x31285b,className:_0x15e5ad,extend:_0xdc50e2,..._0x5abae9}=_0x356224,_0x389bc8=(_0x561d46(0x357)+_0x31285b+'\x20'+(_0x15e5ad||''))[_0x561d46(0x29d)](),_0xae14f3=A[_0x561d46(0x405)]('_'+Je());return we(_0x31b328,''+_0x31285b,{'defIds':_0x31b328[_0x561d46(0x373)],'idSuffix':_0xae14f3[_0x561d46(0x3a9)]},{'ref':_0x4517c9,'className':_0x389bc8,..._0x5abae9},_0xdc50e2);}function we(_0x3aca37,_0x155d29,_0x35f9a7,_0x1d30df,_0x3ae03a){const _0x50e595=_0x322940;return A[_0x50e595(0x20a)](_0x3aca37[_0x50e595(0x2a4)],{'key':_0x155d29,...qe(_0x3aca37,_0x35f9a7,_0x3ae03a),..._0x1d30df},(ze(_0x3aca37,_0x35f9a7)[_0x50e595(0x194)]||[])[_0x50e595(0x19c)]((_0x37a38d,_0x4c0ee7)=>we(_0x37a38d,_0x155d29+'-'+_0x3aca37[_0x50e595(0x2a4)]+'-'+_0x4c0ee7,_0x35f9a7,void 0x0,_0x3ae03a)));}function qe(_0x2cd5c8,_0x29ce8,_0x251c57){const _0x36d5f5=_0x322940,_0x23c69a={..._0x2cd5c8[_0x36d5f5(0x17c)]};_0x251c57!=null&&_0x251c57['colorChannel1']&&_0x23c69a['fill']===_0x36d5f5(0x1ad)&&(_0x23c69a[_0x36d5f5(0x3f0)]=_0x251c57[_0x36d5f5(0x1ad)]),_0x2cd5c8[_0x36d5f5(0x2a4)]===_0x36d5f5(0x31b)&&_0x23c69a['id']&&(_0x23c69a['id']=_0x23c69a['id']+_0x29ce8[_0x36d5f5(0x2e1)]),Object[_0x36d5f5(0x3a5)](_0x23c69a)[_0x36d5f5(0x2c8)](([_0x517164,_0x315177])=>{const _0x178337=_0x36d5f5;_0x517164===_0x178337(0x31b)&&typeof _0x315177==_0x178337(0x1d0)&&(_0x23c69a[_0x517164]=_0x315177[_0x178337(0x2a9)](/url\(#(.*)\)/,_0x178337(0x2b5)+_0x29ce8[_0x178337(0x2e1)]+')'));});const {defIds:_0x249f47}=_0x29ce8;return!_0x249f47||_0x249f47[_0x36d5f5(0x1ce)]===0x0||(_0x2cd5c8[_0x36d5f5(0x2a4)]===_0x36d5f5(0x3a1)&&_0x23c69a[_0x36d5f5(0x16a)]&&(_0x23c69a['xlink:href']=_0x23c69a['xlink:href']+_0x29ce8[_0x36d5f5(0x2e1)]),Object[_0x36d5f5(0x3a5)](_0x23c69a)[_0x36d5f5(0x2c8)](([_0x4719b8,_0x27bbcd])=>{const _0x1aa345=_0x36d5f5;typeof _0x27bbcd==_0x1aa345(0x1d0)&&(_0x23c69a[_0x4719b8]=_0x27bbcd[_0x1aa345(0x2a9)](/url\(#(.*)\)/,_0x1aa345(0x2b5)+_0x29ce8['idSuffix']+')'));})),_0x23c69a;}function ze(_0x251263,_0x258b2c){const _0x359052=_0x322940;var _0x24ad5c;const {defIds:_0x31739b}=_0x258b2c;return!_0x31739b||_0x31739b['length']===0x0?_0x251263:_0x251263[_0x359052(0x2a4)]===_0x359052(0x3c9)&&((_0x24ad5c=_0x251263[_0x359052(0x194)])!=null&&_0x24ad5c[_0x359052(0x1ce)])?{..._0x251263,'children':_0x251263['children']['map'](_0x5dab6e=>typeof _0x5dab6e['attrs']['id']=='string'&&_0x31739b&&_0x31739b[_0x359052(0x2cb)](_0x5dab6e['attrs']['id'])?{..._0x5dab6e,'attrs':{..._0x5dab6e['attrs'],'id':_0x5dab6e[_0x359052(0x17c)]['id']+_0x258b2c[_0x359052(0x2e1)]}}:_0x5dab6e)}:_0x251263;}function Je(){const _0x3250cf=_0x322940;return Math[_0x3250cf(0x167)]()['toString'](0x24)[_0x3250cf(0x3e2)](0x2,0x8);}Ce['displayName']=_0x322940(0x3d2);const Ze={'tag':'svg','attrs':{'xmlns':'http://www.w3.org/2000/svg','fill':_0x322940(0x179),'viewBox':_0x322940(0x361),'width':_0x322940(0x186),'height':_0x322940(0x186)},'children':[{'tag':'g','attrs':{'clipPath':_0x322940(0x1b3)},'children':[{'tag':'path','attrs':{'stroke':_0x322940(0x37f),'d':_0x322940(0x345),'strokeLinecap':_0x322940(0x1ca),'strokeLinejoin':_0x322940(0x1ca),'strokeWidth':1.2}}]},{'tag':_0x322940(0x3c9),'attrs':{},'children':[{'tag':_0x322940(0x270),'attrs':{'id':_0x322940(0x197)},'children':[{'tag':_0x322940(0x2ad),'attrs':{'fill':_0x322940(0x392),'d':_0x322940(0x36d)}}]}]}],'defIds':[_0x322940(0x197)]},ye=A[_0x322940(0x2ba)](function(_0xc2c24f,_0x233faa){const _0x203598=_0x322940;return A[_0x203598(0x20a)](Ce,Object[_0x203598(0x3bd)]({},_0xc2c24f,{'id':'off-line-icon','ref':_0x233faa,'icon':Ze}));});ye['displayName']=_0x322940(0x3dc);const Qe={'tag':'svg','attrs':{'xmlns':_0x322940(0x3c7),'fill':'none','viewBox':_0x322940(0x3cb),'width':_0x322940(0x186),'height':_0x322940(0x186)},'children':[{'tag':'g','attrs':{'clipPath':_0x322940(0x3f9)},'children':[{'tag':_0x322940(0x2ad),'attrs':{'stroke':_0x322940(0x37f),'d':_0x322940(0x275),'strokeLinecap':_0x322940(0x1ca),'strokeLinejoin':_0x322940(0x1ca),'strokeWidth':1.2}}]},{'tag':_0x322940(0x3c9),'attrs':{},'children':[{'tag':_0x322940(0x270),'attrs':{'id':_0x322940(0x34a)},'children':[{'tag':_0x322940(0x2ad),'attrs':{'fill':_0x322940(0x392),'d':_0x322940(0x36d),'transform':_0x322940(0x173)}}]}]}],'defIds':[_0x322940(0x34a)]},$e=A['forwardRef'](function(_0x2d55d2,_0x1392a4){const _0xe269d=_0x322940;return A['createElement'](Ce,Object[_0xe269d(0x3bd)]({},_0x2d55d2,{'id':_0xe269d(0x340),'ref':_0x1392a4,'icon':Qe}));});$e[_0x322940(0x391)]='OnLineIcon';function et(_0x425067){const _0x36cfda=_0x322940;switch(_0x425067){case u[_0x36cfda(0x39a)][_0x36cfda(0x376)]:return _0x36cfda(0x222);case u[_0x36cfda(0x39a)][_0x36cfda(0x342)]:return _0x36cfda(0x22f);case u[_0x36cfda(0x39a)][_0x36cfda(0x206)]:return _0x36cfda(0x3d0);case u[_0x36cfda(0x39a)][_0x36cfda(0x1f4)]:return _0x36cfda(0x318);case u[_0x36cfda(0x39a)][_0x36cfda(0x232)]:case u[_0x36cfda(0x39a)][_0x36cfda(0x38e)]:return _0x36cfda(0x171);case u['CollaborationStatus'][_0x36cfda(0x202)]:case u['CollaborationStatus'][_0x36cfda(0x15a)]:return _0x36cfda(0x2ce);}}function tt(_0x125b3c){const _0x4d3b77=_0x322940,{status$:_0x2d2504}=_0x125b3c,_0x5256c0=O['useObservable'](_0x2d2504,u[_0x4d3b77(0x39a)][_0x4d3b77(0x1f4)]),_0x14a478=O[_0x4d3b77(0x38b)](a[_0x4d3b77(0x393)]),_0x2bf8c1=O[_0x4d3b77(0x38b)](u[_0x4d3b77(0x328)]),_0x53b3a3=_0x5256c0!==u[_0x4d3b77(0x39a)][_0x4d3b77(0x376)],_0x5f5398=_0x14a478['t'](et(_0x5256c0)),_0x2fd0fa=_0x53b3a3?M[_0x4d3b77(0x25e)]($e,{}):M['jsx'](ye,{}),_0x324aad=A['useCallback'](()=>{const _0x1635f9=_0x4d3b77;_0x53b3a3||_0x2bf8c1[_0x1635f9(0x1e5)]();},[_0x53b3a3,_0x2bf8c1]);function _0x53ad70(){const _0x54c58b=_0x4d3b77;return M[_0x54c58b(0x215)]('div',{'className':_0x54c58b(0x408),'onClick':_0x324aad,'children':[M[_0x54c58b(0x25e)](_0x54c58b(0x1eb),{'className':p[_0x54c58b(0x315)](_0x54c58b(0x1a4),{'univer-text-green-500':_0x53b3a3,'univer-text-red-500':!_0x53b3a3}),'children':_0x2fd0fa}),M[_0x54c58b(0x25e)](_0x54c58b(0x1eb),{'className':_0x54c58b(0x371),'children':_0x5f5398})]});}return _0x53b3a3?_0x53ad70():M['jsx'](p[_0x4d3b77(0x3de)],{'title':_0x14a478['t']('collab-client.tooltip.reconnect'),'children':_0x53ad70()});}var st=Object[_0x322940(0x27e)],it=(_0x41327c,_0x108e87,_0x40f234,_0x3a6900)=>{const _0x59449f=_0x322940;for(var _0xb9f873=_0x3a6900>0x1?void 0x0:_0x3a6900?st(_0x108e87,_0x40f234):_0x108e87,_0x2f5b67=_0x41327c[_0x59449f(0x1ce)]-0x1,_0x30b8a1;_0x2f5b67>=0x0;_0x2f5b67--)(_0x30b8a1=_0x41327c[_0x2f5b67])&&(_0xb9f873=_0x30b8a1(_0xb9f873)||_0xb9f873);return _0xb9f873;},K=(_0x153039,_0x22da00)=>(_0x17e522,_0x8b68ac)=>_0x22da00(_0x17e522,_0x8b68ac,_0x153039);exports[_0x322940(0x355)]=class extends a[_0x322940(0x1d6)]{constructor(_0x3aa7ce,_0x39d8e8,_0x30bbc1,_0x4ab081){const _0x576dc0=_0x322940;super(),_(this,_0x576dc0(0x40f),new I[(_0x576dc0(0x2cc))](u[_0x576dc0(0x39a)]['NOT_COLLAB'])),(this[_0x576dc0(0x24d)]=_0x3aa7ce,this['_injector']=_0x39d8e8,this[_0x576dc0(0x3c1)]=_0x30bbc1,this['_uiPartsService']=_0x4ab081,this['_initStatusComponent'](),this[_0x576dc0(0x2f3)]());}[_0x322940(0x2f3)](){const _0x5d5d27=_0x322940;this[_0x5d5d27(0x192)](this['_univerInstanceService']['focused$'][_0x5d5d27(0x396)](I[_0x5d5d27(0x241)](()=>{const _0x45c356=_0x5d5d27,_0x1e6755=this[_0x45c356(0x24d)]['getFocusedUnit']();return _0x1e6755?this[_0x45c356(0x3c1)][_0x45c356(0x326)](_0x1e6755[_0x45c356(0x259)]()):I['of'](null);}),I['switchMap'](_0x7ab452=>_0x7ab452?_0x7ab452[_0x5d5d27(0x30d)]:I['of'](u[_0x5d5d27(0x39a)][_0x5d5d27(0x1f4)])))[_0x5d5d27(0x2e7)](_0x144bdd=>{const _0x4ba556=_0x5d5d27;this[_0x4ba556(0x40f)][_0x4ba556(0x255)](_0x144bdd);}));}[_0x322940(0x1b5)](){const _0x169849=_0x322940;this['disposeWithMe'](this['_uiPartsService'][_0x169849(0x401)](O[_0x169849(0x313)]['HEADER_MENU'],()=>O['connectInjector'](nt({'status$':this[_0x169849(0x40f)]['asObservable']()}),this['_injector'])));}},exports[_0x322940(0x355)]=it([K(0x0,a['IUniverInstanceService']),K(0x1,a['Inject'](a['Injector'])),K(0x2,a[_0x322940(0x1da)](u['CollaborationController'])),K(0x3,O[_0x322940(0x2ea)])],exports['DesktopCollaborationStatusDisplayController']);function nt(_0x4d0953){const {status$:_0x2990aa}=_0x4d0953;return function(){const _0x2b4e38=_0x2b7c;return M[_0x2b4e38(0x25e)](tt,{'status$':_0x2990aa});};}const Te=a['createIdentifier'](_0x322940(0x278));var rt=Object[_0x322940(0x27e)],ot=(_0xa8bb31,_0x53a6fe,_0xdbfa91,_0x559998)=>{const _0x1d8052=_0x322940;for(var _0x212125=_0x559998>0x1?void 0x0:_0x559998?rt(_0x53a6fe,_0xdbfa91):_0x53a6fe,_0x35635e=_0xa8bb31[_0x1d8052(0x1ce)]-0x1,_0x25faf0;_0x35635e>=0x0;_0x35635e--)(_0x25faf0=_0xa8bb31[_0x35635e])&&(_0x212125=_0x25faf0(_0x212125)||_0x212125);return _0x212125;},j=(_0xa5ff1c,_0x5f59ef)=>(_0x1e9ed9,_0x19378f)=>_0x5f59ef(_0x1e9ed9,_0x19378f,_0xa5ff1c);exports[_0x322940(0x231)]=class extends a['RxDisposable']{constructor(_0x1f107c,_0x21eda2,_0x3ff01b,_0x30271d,_0x221a91){const _0x4267cb=_0x322940;super(),this[_0x4267cb(0x3cf)]=_0x1f107c,this[_0x4267cb(0x274)]=_0x21eda2,this['_commandService']=_0x3ff01b,this[_0x4267cb(0x2ac)]=_0x30271d,_0x221a91?_0x221a91==null||_0x221a91['whenReady']()[_0x4267cb(0x358)](()=>this[_0x4267cb(0x3a3)]()):(this[_0x4267cb(0x274)][_0x4267cb(0x1c4)](_0x4267cb(0x2a5),_0x4267cb(0x2b0)),this[_0x4267cb(0x3a3)]());}async[_0x322940(0x3a3)](){const _0x30aab9=_0x322940,_0xfdcd8f=this[_0x30aab9(0x3cf)][_0x30aab9(0x185)](_0x30aab9(0x2d7)),_0xa09833=this[_0x30aab9(0x3cf)][_0x30aab9(0x185)](_0x30aab9(0x302)),_0x53ccc9=this[_0x30aab9(0x3cf)][_0x30aab9(0x185)](_0x30aab9(0x1b4));if(!_0xfdcd8f||!_0xa09833){this[_0x30aab9(0x274)]['debug'](_0x30aab9(0x2a5),_0x30aab9(0x2a7));return;}const _0x3b2544=await this[_0x30aab9(0x2ac)]['loadUnit'](_0xfdcd8f,Number(_0xa09833),_0x53ccc9);_0x3b2544&&_0x3b2544 instanceof a[_0x30aab9(0x40d)]&&this[_0x30aab9(0x1d2)](_0x3b2544);}async[_0x322940(0x1d2)](_0x37acd3){const _0x507139=_0x322940;await this[_0x507139(0x356)](_0x37acd3),_0x37acd3[_0x507139(0x3d3)][_0x507139(0x396)](I[_0x507139(0x1e9)](this[_0x507139(0x183)]))['subscribe'](_0x281ef5=>{_0x281ef5&&this['_updateURLWithCurrentState'](_0x281ef5);}),this[_0x507139(0x3cf)][_0x507139(0x321)][_0x507139(0x396)](I[_0x507139(0x1e9)](this[_0x507139(0x183)]))[_0x507139(0x2e7)](()=>this[_0x507139(0x356)](_0x37acd3));}[_0x322940(0x2af)](_0x50b372,_0x4af61e=!0x1){const _0x1f57dd=_0x322940,_0x43bd79=this[_0x1f57dd(0x3cf)][_0x1f57dd(0x185)](_0x1f57dd(0x1b4));_0x50b372[_0x1f57dd(0x2f6)]()!==_0x43bd79&&this[_0x1f57dd(0x3cf)][_0x1f57dd(0x1fe)](_0x1f57dd(0x1b4),_0x50b372[_0x1f57dd(0x2f6)](),_0x4af61e);}async[_0x322940(0x356)](_0x4f598d){const _0x4990ef=_0x322940;var _0x4c0447;const _0x596b52=this[_0x4990ef(0x3cf)]['getParam'](_0x4990ef(0x1b4));if(!_0x596b52||!_0x4f598d[_0x4990ef(0x353)](_0x596b52)){const _0x4f04b5=_0x4f598d['getUnhiddenWorksheets']()[0x0],_0x22480c=_0x4f598d[_0x4990ef(0x353)](_0x4f04b5);if(!_0x22480c)return;this[_0x4990ef(0x2af)](_0x22480c,!0x0),await this[_0x4990ef(0x263)]['executeCommand'](g['SetWorksheetActivateCommand']['id'],{'unitId':_0x4f598d[_0x4990ef(0x259)](),'subUnitId':_0x4f04b5});return;}((_0x4c0447=_0x4f598d[_0x4990ef(0x292)]())==null?void 0x0:_0x4c0447[_0x4990ef(0x2f6)]())!==_0x596b52&&await this[_0x4990ef(0x263)][_0x4990ef(0x1a5)](g[_0x4990ef(0x277)]['id'],{'unitId':_0x4f598d[_0x4990ef(0x259)](),'subUnitId':_0x596b52});}},exports[_0x322940(0x231)]=ot([j(0x0,Te),j(0x1,a[_0x322940(0x19d)]),j(0x2,a[_0x322940(0x338)]),j(0x3,a['Inject'](u[_0x322940(0x381)])),j(0x4,a[_0x322940(0x1bd)](Xe[_0x322940(0x2f7)]))],exports[_0x322940(0x231)]);function _0x2b7c(_0x1b514a,_0x46cb9f){const _0x384d2b=_0x384d();return _0x2b7c=function(_0x2b7cdd,_0x5ef2c7){_0x2b7cdd=_0x2b7cdd-0x158;let _0x281c66=_0x384d2b[_0x2b7cdd];return _0x281c66;},_0x2b7c(_0x1b514a,_0x46cb9f);}var at=Object[_0x322940(0x27e)],ct=(_0x297d70,_0x2c8ab3,_0x27af23,_0x1c1b19)=>{const _0x4f8b3e=_0x322940;for(var _0xb5afaa=_0x1c1b19>0x1?void 0x0:_0x1c1b19?at(_0x2c8ab3,_0x27af23):_0x2c8ab3,_0x51dae7=_0x297d70[_0x4f8b3e(0x1ce)]-0x1,_0x2c64c7;_0x51dae7>=0x0;_0x51dae7--)(_0x2c64c7=_0x297d70[_0x51dae7])&&(_0xb5afaa=_0x2c64c7(_0xb5afaa)||_0xb5afaa);return _0xb5afaa;},Re=(_0x514b53,_0x57ffa1)=>(_0x1e20f3,_0x43dfb7)=>_0x57ffa1(_0x1e20f3,_0x43dfb7,_0x514b53);let de=class extends a[_0x322940(0x310)]{constructor(_0x2f8654,_0x448175){const _0x331269=_0x322940;super(),this['_docClipboardService']=_0x2f8654,this[_0x331269(0x3e5)]=_0x448175,this[_0x331269(0x3a3)]();}['_init'](){const _0x27f050=_0x322940,_0x2c8013=this;this[_0x27f050(0x192)](this[_0x27f050(0x2a3)][_0x27f050(0x1a1)]({'onBeforePasteImage':async _0x95d5b8=>{const _0x256c00=_0x27f050,_0x31ad80=await _0x2c8013[_0x256c00(0x3e5)][_0x256c00(0x2ef)](_0x95d5b8);return _0x31ad80?{'source':_0x31ad80['source'],'imageSourceType':_0x31ad80[_0x256c00(0x3ac)]}:null;}}));}};de=ct([Re(0x0,T[_0x322940(0x37a)]),Re(0x1,Ke['IImageIoService'])],de);const be=[_0x322940(0x300),_0x322940(0x359),_0x322940(0x257),_0x322940(0x16e),_0x322940(0x372),_0x322940(0x369)];class pe extends a['Disposable']{constructor(){const _0x3754f1=_0x322940;super(...arguments),_(this,_0x3754f1(0x2aa),new Map()),_(this,_0x3754f1(0x25d),0x0);}[_0x322940(0x3fd)](_0x243951){const _0x5a96f2=_0x322940;if(this[_0x5a96f2(0x2aa)][_0x5a96f2(0x1a0)](_0x243951))return this[_0x5a96f2(0x2aa)]['get'](_0x243951);const _0x5e32e4=be[this[_0x5a96f2(0x25d)]];return this[_0x5a96f2(0x25d)]=(this[_0x5a96f2(0x25d)]+0x1)%be[_0x5a96f2(0x1ce)],this[_0x5a96f2(0x2aa)]['set'](_0x243951,_0x5e32e4),_0x5e32e4;}}function xe(_0x54403a){const _0x2859f4=_0x322940;let _0x2095f1='';for(const _0x1109e2 of _0x54403a){const {startOffset:_0x241af0,endOffset:_0x2e5336,isActive:_0x3d7ac7,rangeType:_0x3de3da,segmentId:_0x24fa8b,segmentPage:_0x492aca}=_0x1109e2;_0x2095f1[_0x2859f4(0x1ce)]&&(_0x2095f1+=','),_0x2095f1+=_0x241af0+':'+_0x2e5336+':'+(_0x3d7ac7?'1':'0')+':'+_0x3de3da+':'+_0x24fa8b+':'+_0x492aca;}return _0x2095f1;}function lt(_0x136dee){const _0x2ab742=_0x322940,_0xbe61d3=_0x136dee[_0x2ab742(0x1bb)](','),_0x5b2533=[];for(const _0x2c22e3 of _0xbe61d3){const [_0x5667a7,_0xfeb9cc,_0x693bf4,_0x4d2241,_0x435936,_0x4484d0]=_0x2c22e3[_0x2ab742(0x1bb)](':');_0x5b2533[_0x2ab742(0x32d)]({'startOffset':Number(_0x5667a7),'endOffset':Number(_0xfeb9cc),'collapsed':_0x5667a7===_0xfeb9cc,'isActive':_0x693bf4==='1','rangeType':_0x4d2241===a[_0x2ab742(0x309)]['TEXT']?a[_0x2ab742(0x309)][_0x2ab742(0x2bd)]:a[_0x2ab742(0x309)]['RECT'],'segmentId':typeof _0x435936==_0x2ab742(0x1d0)?String(_0x435936):'','segmentPage':Number(_0x4484d0!=null?_0x4484d0:-0x1)});}return _0x5b2533[_0x2ab742(0x33b)](_0x310e92=>_0x310e92[_0x2ab742(0x188)])||(_0x5b2533[0x0]['isActive']=!0x0),_0x5b2533;}class Oe extends a[_0x322940(0x310)]{constructor(){const _0x21be05=_0x322940;super(...arguments),_(this,_0x21be05(0x332),new I['BehaviorSubject'](null)),_(this,'collabCursorState$',this[_0x21be05(0x332)]['asObservable']());}[_0x322940(0x23a)](_0x1219e6){const _0x12c73d=_0x322940,{unitID:_0x580517,memberID:_0x2fb6f9,textRanges:_0x16a539}=_0x1219e6,_0x4255a9=xe(_0x16a539);if(_0x4255a9==='')return;const _0x27ba16={'unitID':_0x580517,'memberID':_0x2fb6f9,'selection':_0x4255a9};this[_0x12c73d(0x332)][_0x12c73d(0x255)](_0x27ba16);}}var _t=Object['getOwnPropertyDescriptor'],ht=(_0x32b671,_0x4b1e5a,_0x3bced5,_0xf7b193)=>{const _0x21c3a7=_0x322940;for(var _0x2e26cb=_0xf7b193>0x1?void 0x0:_0xf7b193?_t(_0x4b1e5a,_0x3bced5):_0x4b1e5a,_0x3a6ffa=_0x32b671[_0x21c3a7(0x1ce)]-0x1,_0x2b0965;_0x3a6ffa>=0x0;_0x3a6ffa--)(_0x2b0965=_0x32b671[_0x3a6ffa])&&(_0x2e26cb=_0x2b0965(_0x2e26cb)||_0x2e26cb);return _0x2e26cb;},U=(_0x37c686,_0x36156d)=>(_0x664157,_0x5b37c2)=>_0x36156d(_0x664157,_0x5b37c2,_0x37c686);const ut=0x12c,It=0x64;let fe=class extends a[_0x322940(0x310)]{constructor(_0x278e61,_0x4e775e,_0x695401,_0x2fc4d1,_0x4cb73e,_0x4fbdec,_0x3bde62,_0x3feb41,_0x147812){const _0x523e0f=_0x322940;super(),_(this,'_online',!0x1),_(this,_0x523e0f(0x3a3),!0x1),_(this,_0x523e0f(0x2dc),new I['BehaviorSubject'](new Map())),_(this,_0x523e0f(0x1ab),this['_cursorInfo$'][_0x523e0f(0x3ff)]()),_(this,_0x523e0f(0x20f),new I[(_0x523e0f(0x2cc))]([])),_(this,_0x523e0f(0x191),this['_roomMembers$']['pipe'](I[_0x523e0f(0x2d1)](ut))),_(this,_0x523e0f(0x35e),a['debounce'](_0x18046c=>{const _0x45e03e=_0x523e0f,_0x429fd8={'eventID':v[_0x45e03e(0x2e0)]['UPDATE_CURSOR'],'data':{'unitID':this['unitID'],'memberID':this[_0x45e03e(0x2b7)]['getMemberID'](),'selection':xe(_0x18046c)}};this[_0x45e03e(0x2b7)][_0x45e03e(0x1a8)](_0x429fd8,this['unitID']);},It)),(this[_0x523e0f(0x394)]=_0x278e61,this[_0x523e0f(0x2b7)]=_0x4e775e,this[_0x523e0f(0x3aa)]=_0x695401,this[_0x523e0f(0x26d)]=_0x2fc4d1,this[_0x523e0f(0x2b3)]=_0x4cb73e,this['_syncEditingCollabCursorService']=_0x4fbdec,this[_0x523e0f(0x1ae)]=_0x3bde62,this[_0x523e0f(0x24d)]=_0x3feb41,this[_0x523e0f(0x263)]=_0x147812);}get[_0x322940(0x17f)](){const _0x217ed2=_0x322940;return this[_0x217ed2(0x2dc)][_0x217ed2(0x25a)]();}get['roomMembers'](){const _0x188232=_0x322940;return this[_0x188232(0x20f)][_0x188232(0x25a)]();}[_0x322940(0x198)](){const _0x583b4f=_0x322940;super[_0x583b4f(0x198)](),this[_0x583b4f(0x2dc)][_0x583b4f(0x255)](new Map()),this['_cursorInfo$'][_0x583b4f(0x264)](),this['_roomMembers$'][_0x583b4f(0x255)]([]),this['_roomMembers$'][_0x583b4f(0x264)]();}[_0x322940(0x223)](){const _0xb3086=_0x322940;this[_0xb3086(0x3a3)]||(this['_init']=!0x0,this[_0xb3086(0x2b7)][_0xb3086(0x1ea)][_0xb3086(0x396)](I['takeUntil'](this['dispose$']))[_0xb3086(0x2e7)](_0x2e32af=>{const _0x27e23a=_0xb3086;_0x2e32af===u[_0x27e23a(0x193)][_0x27e23a(0x2d9)]?this[_0x27e23a(0x2ed)]():this[_0x27e23a(0x26c)]();}),this[_0xb3086(0x2b7)]['event$']['pipe'](I[_0xb3086(0x1e9)](this[_0xb3086(0x183)]))['subscribe'](_0x313c4f=>{const _0x3364ca=_0xb3086,_0x5e0cb6=_0x313c4f[_0x3364ca(0x3c2)];_0x5e0cb6===v[_0x3364ca(0x2e0)][_0x3364ca(0x390)]&&this['_onCursorUpdate'](_0x313c4f),_0x5e0cb6===v[_0x3364ca(0x2e0)][_0x3364ca(0x39b)]&&this['_onCursorDelete'](_0x313c4f);}),this[_0xb3086(0x192)](this[_0xb3086(0x263)]['onCommandExecuted'](_0x501614=>{const _0x302c4e=_0xb3086,_0x4b62ea=_0x501614[_0x302c4e(0x2b2)];_0x4b62ea!=null&&this[_0x302c4e(0x22c)]&&_0x501614['id']===W['SetTextSelectionsOperation']['id']&&_0x4b62ea[_0x302c4e(0x336)]===this[_0x302c4e(0x394)]&&_0x4b62ea['isEditing']===!0x1&&_0x4b62ea[_0x302c4e(0x17e)][_0x302c4e(0x1ce)]>0x0&&this[_0x302c4e(0x35e)](_0x4b62ea[_0x302c4e(0x17e)]);})),this[_0xb3086(0x166)][_0xb3086(0x3da)][_0xb3086(0x396)](I['takeUntil'](this[_0xb3086(0x183)]))[_0xb3086(0x2e7)](_0x309f01=>{const _0x48a94b=_0xb3086;if((_0x309f01==null?void 0x0:_0x309f01[_0x48a94b(0x394)])!==this[_0x48a94b(0x394)])return;const _0x3c3c5a={'eventID':v[_0x48a94b(0x2e0)][_0x48a94b(0x390)],'data':_0x309f01};this[_0x48a94b(0x15c)](_0x3c3c5a);}),this[_0xb3086(0x192)](this[_0xb3086(0x263)][_0xb3086(0x2dd)](_0x58bf5e=>{const _0x2b712b=_0xb3086;if(_0x58bf5e['params']==null)return;const _0x479343=_0x58bf5e[_0x2b712b(0x2b2)];if(_0x58bf5e['id']!==W['RichTextEditingMutation']['id']||_0x479343[_0x2b712b(0x336)]!==this[_0x2b712b(0x394)])return;const _0x3de648={'id':_0x2b712b(0x2fd),'params':_0x479343},_0x766c4f=this[_0x2b712b(0x17f)];for(const [_0x4e2cd1,_0x3a66ae]of _0x766c4f){const _0x3675ae={'id':_0x2b712b(0x2fd),'params':{'unitId':this[_0x2b712b(0x394)],'actions':null,'textRanges':_0x3a66ae[_0x2b712b(0x17e)]}},_0x5d89a5=this['_transformService']['transformMutation'](_0x3de648,_0x3675ae,!0x1);if(v[_0x2b712b(0x201)](_0x5d89a5))throw _0x5d89a5[_0x2b712b(0x21f)];_0x766c4f[_0x2b712b(0x269)](_0x4e2cd1,{..._0x3a66ae,'ranges':_0x5d89a5[_0x2b712b(0x187)][_0x2b712b(0x2b2)]['textRanges']});}queueMicrotask(()=>{const _0x23e2f2=_0x2b712b;this[_0x23e2f2(0x2dc)][_0x23e2f2(0x255)](_0x766c4f);});})));}[_0x322940(0x15c)](_0x3ab913){const _0x4b2a6e=_0x322940;var _0x497a13,_0x166103;const {memberID:_0x45b42e,selection:_0x285830}=_0x3ab913[_0x4b2a6e(0x15e)],_0x26f461=lt(_0x285830),_0xd9ec58=(_0x166103=(_0x497a13=this['_memberService'][_0x4b2a6e(0x2d5)](this[_0x4b2a6e(0x394)],_0x45b42e))==null?void 0x0:_0x497a13['name'])!=null?_0x166103:'Unknown\x20user',_0x35ba77={'color':this[_0x4b2a6e(0x26d)][_0x4b2a6e(0x3fd)](_0x45b42e),'name':_0xd9ec58,'ranges':_0x26f461},_0x368a4b=this['cursorInfo'];_0x368a4b['set'](_0x45b42e,_0x35ba77),this[_0x4b2a6e(0x2dc)]['next'](_0x368a4b);}[_0x322940(0x24c)](_0x95f0f9){const _0x594446=_0x322940,{memberID:_0x348f49}=_0x95f0f9[_0x594446(0x15e)],_0x3eeaf5=this[_0x594446(0x17f)];_0x3eeaf5[_0x594446(0x3b4)](_0x348f49),this[_0x594446(0x2dc)][_0x594446(0x255)](_0x3eeaf5);}[_0x322940(0x2ed)](){const _0x142d2a=_0x322940;var _0x572b8c;if(this[_0x142d2a(0x22c)]=!0x0,((_0x572b8c=this[_0x142d2a(0x24d)]['getFocusedUnit']())==null?void 0x0:_0x572b8c[_0x142d2a(0x259)]())!==this[_0x142d2a(0x394)])return;const _0x42d163=this[_0x142d2a(0x3aa)]['get'](W[_0x142d2a(0x1e2)])[_0x142d2a(0x1a7)]();Array['isArray'](_0x42d163)&&_0x42d163[_0x142d2a(0x1ce)]>0x0&&this[_0x142d2a(0x35e)](_0x42d163);}[_0x322940(0x26c)](){const _0x14a256=_0x322940;this[_0x14a256(0x22c)]=!0x1;}};fe=ht([U(0x2,a[_0x322940(0x1da)](a[_0x322940(0x273)])),U(0x3,a[_0x322940(0x1da)](pe)),U(0x4,a['Inject'](u[_0x322940(0x3ad)])),U(0x5,a[_0x322940(0x1da)](Oe)),U(0x6,v[_0x322940(0x413)]),U(0x7,a['IUniverInstanceService']),U(0x8,a['ICommandService'])],fe);var St=Object[_0x322940(0x27e)],dt=(_0x3a4368,_0x2c114d,_0x5b3937,_0x4af8b5)=>{const _0xe25580=_0x322940;for(var _0x365702=_0x4af8b5>0x1?void 0x0:_0x4af8b5?St(_0x2c114d,_0x5b3937):_0x2c114d,_0x5cea58=_0x3a4368[_0xe25580(0x1ce)]-0x1,_0x124a44;_0x5cea58>=0x0;_0x5cea58--)(_0x124a44=_0x3a4368[_0x5cea58])&&(_0x365702=_0x124a44(_0x365702)||_0x365702);return _0x365702;},w=(_0xc35393,_0x1a817b)=>(_0x17a1da,_0x1644b5)=>_0x1a817b(_0x17a1da,_0x1644b5,_0xc35393);const ft=0x12c,mt=0x64,gt=()=>{let _0x455af3=[],_0x1ecbf7=!0x1;return _0x495ac1=>{const _0xce57b4=_0x2b7c;_0x455af3[_0xce57b4(0x32d)](_0x495ac1),_0x1ecbf7||(_0x1ecbf7=!0x0,setTimeout(()=>{const _0x173ac3=_0xce57b4;_0x455af3[_0x173ac3(0x2c8)](_0x4ecdb0=>_0x4ecdb0()),_0x455af3=[],_0x1ecbf7=!0x1;}));};};let me=class extends a['RxDisposable']{constructor(_0xd1ec4b,_0x462771,_0x5a671b,_0x1d968b,_0x1c5ab9,_0x3031d3,_0x19c24f,_0x53d237){const _0x50ca36=_0x322940;super(),_(this,_0x50ca36(0x22c),!0x1),_(this,_0x50ca36(0x3a3),!0x1),_(this,_0x50ca36(0x2dc),new I[(_0x50ca36(0x2cc))](new Map())),_(this,'cursorInfo$',this[_0x50ca36(0x2dc)][_0x50ca36(0x3ff)]()),_(this,_0x50ca36(0x20f),new I[(_0x50ca36(0x2cc))]([])),_(this,_0x50ca36(0x191),this[_0x50ca36(0x20f)][_0x50ca36(0x396)](I[_0x50ca36(0x2d1)](ft))),_(this,_0x50ca36(0x35e),a[_0x50ca36(0x32a)]((_0x24b73b,_0x2a8105)=>{const _0x114390=_0x50ca36,_0x2025b4={'eventID':v[_0x114390(0x2e0)][_0x114390(0x390)],'data':{'unitID':this[_0x114390(0x394)],'memberID':this['_session']['getMemberID'](),'selection':x[_0x114390(0x3f2)](_0x24b73b,_0x2a8105['range'])}};this[_0x114390(0x2b7)][_0x114390(0x1a8)](_0x2025b4,this[_0x114390(0x394)]);},mt)),(this[_0x50ca36(0x394)]=_0xd1ec4b,this[_0x50ca36(0x2b7)]=_0x462771,this['_injector']=_0x5a671b,this['_colorAssignService']=_0x1d968b,this['_memberService']=_0x1c5ab9,this[_0x50ca36(0x24d)]=_0x3031d3,this[_0x50ca36(0x263)]=_0x19c24f,this[_0x50ca36(0x228)]=_0x53d237);}get[_0x322940(0x17f)](){const _0x418c6c=_0x322940;return this['_cursorInfo$'][_0x418c6c(0x25a)]();}get[_0x322940(0x386)](){const _0x4f48aa=_0x322940;return this[_0x4f48aa(0x20f)][_0x4f48aa(0x25a)]();}[_0x322940(0x198)](){const _0x2ca829=_0x322940;super['dispose'](),this[_0x2ca829(0x2dc)][_0x2ca829(0x255)](new Map()),this[_0x2ca829(0x2dc)][_0x2ca829(0x264)](),this[_0x2ca829(0x20f)][_0x2ca829(0x255)]([]),this[_0x2ca829(0x20f)][_0x2ca829(0x264)]();}[_0x322940(0x223)](){const _0x344698=_0x322940;this['_init']||(this[_0x344698(0x3a3)]=!0x0,this['_session'][_0x344698(0x1ea)][_0x344698(0x396)](I['takeUntil'](this['dispose$']))['subscribe'](_0x146866=>{const _0x4929ae=_0x344698;_0x146866===u[_0x4929ae(0x193)]['ONLINE']?this['_toggleOnline']():this[_0x4929ae(0x26c)]();}),this[_0x344698(0x2b7)][_0x344698(0x158)]['pipe'](I[_0x344698(0x1e9)](this[_0x344698(0x183)]))[_0x344698(0x2e7)](_0x283897=>{const _0x5afa0f=_0x344698,_0x3ef46e=_0x283897[_0x5afa0f(0x3c2)];_0x3ef46e===v[_0x5afa0f(0x2e0)]['UPDATE_CURSOR']&&this[_0x5afa0f(0x15c)](_0x283897),_0x3ef46e===v[_0x5afa0f(0x2e0)]['USERS_LEAVE']&&this[_0x5afa0f(0x24c)](_0x283897);}),this['_onRefRangeChange'](),this[_0x344698(0x192)](this[_0x344698(0x263)][_0x344698(0x2dd)](_0x312c04=>{const _0x3a4d2a=_0x344698;if(this[_0x3a4d2a(0x22c)]&&_0x312c04['id']===g['SetSelectionsOperation']['id']&&_0x312c04[_0x3a4d2a(0x2b2)][_0x3a4d2a(0x336)]===this[_0x3a4d2a(0x394)]){const _0x5160e8=_0x312c04[_0x3a4d2a(0x2b2)];this[_0x3a4d2a(0x35e)](_0x5160e8['subUnitId'],_0x5160e8[_0x3a4d2a(0x29a)][0x0]);}})));}[_0x322940(0x15c)](_0x1f300a){const _0x58a182=_0x322940;var _0xcf9e4a,_0x384f7a;const {memberID:_0x3fae6c,selection:_0x50021b}=_0x1f300a[_0x58a182(0x15e)],{sheetName:_0x25710d,range:_0x415391}=x['deserializeRangeWithSheet'](_0x50021b),_0x482178={'name':(_0x384f7a=(_0xcf9e4a=this['_memberService'][_0x58a182(0x2d5)](this[_0x58a182(0x394)],_0x3fae6c))==null?void 0x0:_0xcf9e4a[_0x58a182(0x1ba)])!=null?_0x384f7a:_0x58a182(0x303),'range':this[_0x58a182(0x30b)](_0x25710d,_0x415391),'sheetID':_0x25710d,'color':this['_colorAssignService'][_0x58a182(0x3fd)](_0x3fae6c),'selection':_0x50021b},_0x4516d2=this['cursorInfo'];_0x4516d2[_0x58a182(0x269)](_0x3fae6c,_0x482178),this['_cursorInfo$'][_0x58a182(0x255)](_0x4516d2);}[_0x322940(0x24c)](_0x2d274f){const _0x2839cb=_0x322940,{memberID:_0x115b62}=_0x2d274f['data'],_0x1fd211=this[_0x2839cb(0x17f)];_0x1fd211[_0x2839cb(0x3b4)](_0x115b62),this[_0x2839cb(0x2dc)][_0x2839cb(0x255)](_0x1fd211);}[_0x322940(0x30b)](_0x5cd647,_0x537967){const _0x5b5786=_0x322940;var _0x4686d8,_0x2902df;const _0x14a1d8=(_0x2902df=(_0x4686d8=this['_univerInstanceService'][_0x5b5786(0x1e3)](this[_0x5b5786(0x394)]))==null?void 0x0:_0x4686d8[_0x5b5786(0x353)](_0x5cd647))==null?void 0x0:_0x2902df['getMergeData']();return(_0x14a1d8==null?void 0x0:_0x14a1d8[_0x5b5786(0x33c)](_0x11352c=>a[_0x5b5786(0x32e)]['contains'](_0x11352c,_0x537967)))||_0x537967;}[_0x322940(0x27d)](){const _0x411980=_0x322940,_0x56481d=new a[(_0x411980(0x238))](),_0x31da48=gt(),_0x225d3f=()=>{const _0x361914=_0x411980;_0x56481d[_0x361914(0x198)]();const _0x35743c=(_0x5e1932,_0x5cd9a2,_0x3aa90e,_0x95c254)=>{const _0x452964=_0x361914;let _0x1c0312=[];switch(_0x5e1932['id']){case g[_0x452964(0x412)]['DeleteRangeMoveLeftCommandId']:{_0x1c0312=g[_0x452964(0x30f)](_0x5e1932,_0x95c254);break;}case g[_0x452964(0x412)][_0x452964(0x20c)]:{_0x1c0312=g[_0x452964(0x288)](_0x5e1932,_0x95c254);break;}case g[_0x452964(0x412)][_0x452964(0x3bf)]:{_0x1c0312=g[_0x452964(0x34d)](_0x5e1932,_0x95c254);break;}case g[_0x452964(0x412)][_0x452964(0x1cb)]:{_0x1c0312=g[_0x452964(0x2ab)](_0x5e1932,_0x95c254);break;}case g['EffectRefRangId']['InsertRangeMoveRightCommandId']:{_0x1c0312=g[_0x452964(0x406)](_0x5e1932,_0x95c254);break;}case g[_0x452964(0x412)]['InsertRowCommandId']:{_0x1c0312=g[_0x452964(0x295)](_0x5e1932,_0x95c254);break;}case g[_0x452964(0x412)]['MoveRangeCommandId']:{_0x1c0312=g['handleMoveRange'](_0x5e1932,_0x95c254);break;}case g[_0x452964(0x412)][_0x452964(0x282)]:{_0x1c0312=g['handleIRemoveCol'](_0x5e1932,_0x95c254);break;}case g[_0x452964(0x412)]['RemoveRowCommandId']:{_0x1c0312=g[_0x452964(0x2f2)](_0x5e1932,_0x95c254);break;}}const _0x2eb3e5=g[_0x452964(0x254)](_0x1c0312,_0x95c254),_0x3b4a5d=this[_0x452964(0x17f)][_0x452964(0x38c)](_0x5cd9a2);if(_0x3b4a5d&&_0x2eb3e5){const _0x53ffdf={..._0x3b4a5d,'range':_0x2eb3e5};this[_0x452964(0x17f)][_0x452964(0x269)](_0x5cd9a2,_0x53ffdf),_0x31da48(()=>{const _0x134b20=_0x452964,_0x2b1399=this[_0x134b20(0x228)][_0x134b20(0x1e1)](_0x2eb3e5,_0x19ab69=>(_0x2b1399[_0x134b20(0x198)](),_0x35743c(_0x19ab69,_0x5cd9a2,_0x3aa90e,_0x2eb3e5)));_0x56481d[_0x134b20(0x1d9)](_0x2b1399);});}return{'redos':[],'undos':[]};};this[_0x361914(0x17f)]['forEach']((_0x38af14,_0x43cc0)=>{const _0x434ddf=_0x361914,{range:_0xadf085,sheetID:_0x1db5e6}=_0x38af14,_0x4610f7=this[_0x434ddf(0x228)][_0x434ddf(0x1e1)](_0xadf085,_0xf55468=>(_0x4610f7[_0x434ddf(0x198)](),_0x35743c(_0xf55468,_0x43cc0,_0x1db5e6,_0xadf085)));_0x56481d[_0x434ddf(0x1d9)](_0x4610f7);});};this[_0x411980(0x192)](a['toDisposable'](this['_cursorInfo$'][_0x411980(0x2e7)](()=>{_0x225d3f();})));}[_0x322940(0x2ed)](){const _0x301e76=_0x322940;var _0x18be61,_0x14e957;if(this[_0x301e76(0x22c)]=!0x0,((_0x18be61=this[_0x301e76(0x24d)][_0x301e76(0x27a)]())==null?void 0x0:_0x18be61['getUnitId']())!==this[_0x301e76(0x394)])return;const _0x5e98c1=(_0x14e957=this[_0x301e76(0x3aa)][_0x301e76(0x38c)](g[_0x301e76(0x3fe)])[_0x301e76(0x240)]())==null?void 0x0:_0x14e957[0x0],_0x42dd1d=this[_0x301e76(0x24d)][_0x301e76(0x2cf)](a['UniverInstanceType'][_0x301e76(0x251)])[_0x301e76(0x292)]();_0x5e98c1&&_0x42dd1d&&this[_0x301e76(0x35e)](_0x42dd1d[_0x301e76(0x2f6)](),_0x5e98c1);}[_0x322940(0x26c)](){this['_online']=!0x1;}};me=dt([w(0x2,a[_0x322940(0x1da)](a[_0x322940(0x273)])),w(0x3,a[_0x322940(0x1da)](pe)),w(0x4,a['Inject'](u[_0x322940(0x3ad)])),w(0x5,a[_0x322940(0x233)]),w(0x6,a[_0x322940(0x338)]),w(0x7,a[_0x322940(0x1da)](g[_0x322940(0x15d)]))],me);var vt=Object[_0x322940(0x27e)],Et=(_0xd163aa,_0x570667,_0xe6e519,_0x16ba61)=>{const _0x2f39d2=_0x322940;for(var _0x27634c=_0x16ba61>0x1?void 0x0:_0x16ba61?vt(_0x570667,_0xe6e519):_0x570667,_0xbd0cc0=_0xd163aa[_0x2f39d2(0x1ce)]-0x1,_0x56f39a;_0xbd0cc0>=0x0;_0xbd0cc0--)(_0x56f39a=_0xd163aa[_0xbd0cc0])&&(_0x27634c=_0x56f39a(_0x27634c)||_0x27634c);return _0x27634c;},oe=(_0x415d44,_0x2f2397)=>(_0x2911f6,_0x4ad378)=>_0x2f2397(_0x2911f6,_0x4ad378,_0x415d44);let B=class extends a[_0x322940(0x310)]{constructor(_0x3dca41,_0x405d20,_0x163392){const _0x194e69=_0x322940;super(),_(this,'_entities',new Map()),_(this,_0x194e69(0x29f),new I[(_0x194e69(0x3d6))]()),(this['_univerInstanceService']=_0x3dca41,this[_0x194e69(0x3aa)]=_0x405d20,this[_0x194e69(0x333)]=_0x163392,this['_init']());}[_0x322940(0x198)](){const _0x4ee14b=_0x322940;super['dispose'](),this['_entityInit$']['complete'](),this['_entities'][_0x4ee14b(0x2c8)](_0x95586=>_0x95586[_0x4ee14b(0x198)]());}['getCollabCursors$'](_0x57fb89){const _0x50d16f=_0x322940;return this[_0x50d16f(0x398)][_0x50d16f(0x1a0)](_0x57fb89)?this[_0x50d16f(0x398)][_0x50d16f(0x38c)](_0x57fb89)[_0x50d16f(0x1ab)]:this[_0x50d16f(0x29f)][_0x50d16f(0x396)](I[_0x50d16f(0x2d4)](_0x37b71f=>_0x37b71f[_0x50d16f(0x394)]===_0x57fb89),I[_0x50d16f(0x241)](_0x2e98c5=>_0x2e98c5[_0x50d16f(0x1ab)]));}['_init'](){const _0x366462=_0x322940;this[_0x366462(0x24d)]['getTypeOfUnitAdded$'](a[_0x366462(0x247)]['UNIVER_SHEET'])[_0x366462(0x396)](I['takeUntil'](this[_0x366462(0x183)]))['subscribe'](async _0x5bb550=>{const _0x4fcd86=_0x366462,_0x192a41=_0x5bb550[_0x4fcd86(0x259)](),_0x950cf5=await this[_0x4fcd86(0x36f)](_0x192a41);this[_0x4fcd86(0x29f)][_0x4fcd86(0x255)](_0x950cf5),this[_0x4fcd86(0x398)][_0x4fcd86(0x269)](_0x192a41,_0x950cf5);}),this[_0x366462(0x24d)][_0x366462(0x229)](a[_0x366462(0x247)][_0x366462(0x3f4)])['pipe'](I[_0x366462(0x1e9)](this[_0x366462(0x183)]))[_0x366462(0x396)](I[_0x366462(0x2d4)](_0x5c3d7d=>!_0x5c3d7d['getUnitId']()[_0x366462(0x344)]('__')))[_0x366462(0x2e7)](async _0x2633e4=>{const _0x10138c=_0x366462,_0x53fe38=_0x2633e4[_0x10138c(0x259)](),_0x46b93c=await this[_0x10138c(0x160)](_0x53fe38);this['_entityInit$'][_0x10138c(0x255)](_0x46b93c),this[_0x10138c(0x398)][_0x10138c(0x269)](_0x53fe38,_0x46b93c);}),I['merge'](this[_0x366462(0x24d)][_0x366462(0x221)](a['UniverInstanceType'][_0x366462(0x3f4)]),this[_0x366462(0x24d)][_0x366462(0x221)](a[_0x366462(0x247)][_0x366462(0x251)]))['pipe'](I['takeUntil'](this['dispose$']))[_0x366462(0x2e7)](_0x214cb4=>{const _0x578d1b=_0x366462,_0x9eb090=_0x214cb4['getUnitId'](),_0x1a6500=this['_entities'][_0x578d1b(0x38c)](_0x9eb090);_0x1a6500&&(_0x1a6500['dispose'](),this[_0x578d1b(0x398)][_0x578d1b(0x3b4)](_0x9eb090));});}async[_0x322940(0x36f)](_0x480fba){const _0x5629ad=_0x322940,_0x1cd249=await this[_0x5629ad(0x333)][_0x5629ad(0x1dd)](_0x480fba),_0x42800c=this[_0x5629ad(0x3aa)]['createInstance'](me,_0x480fba,_0x1cd249);return _0x42800c['init'](),_0x42800c;}async[_0x322940(0x160)](_0x49121d){const _0x309e53=_0x322940,_0x5cc897=await this[_0x309e53(0x333)][_0x309e53(0x1dd)](_0x49121d),_0xb8c4ad=this[_0x309e53(0x3aa)][_0x309e53(0x395)](fe,_0x49121d,_0x5cc897);return _0xb8c4ad['init'](),_0xb8c4ad;}};B=Et([oe(0x0,a[_0x322940(0x233)]),oe(0x1,a[_0x322940(0x1da)](a['Injector'])),oe(0x2,a[_0x322940(0x1da)](u[_0x322940(0x328)]))],B);const X=0x14,De=0xc8,ae=0x4,Ct=0x5;function Tt(_0x47506a,_0x5f51b9){const _0x4999f0=_0x322940;let {radius:_0x2fa4b2,width:_0x124ff1,height:_0x181e25}=_0x5f51b9;_0x2fa4b2=_0x2fa4b2!=null?_0x2fa4b2:0x0,_0x124ff1=_0x124ff1!=null?_0x124ff1:0x1e,_0x181e25=_0x181e25!=null?_0x181e25:0x1e;let _0x292f18=0x0,_0x1d517e=0x0,_0x18ac16=0x0;_0x292f18=_0x1d517e=_0x18ac16=Math[_0x4999f0(0x1e0)](_0x2fa4b2,_0x124ff1/0x2,_0x181e25/0x2),_0x47506a[_0x4999f0(0x3b1)](),_0x47506a[_0x4999f0(0x3f3)](_0x292f18,0x0),_0x47506a[_0x4999f0(0x245)](_0x124ff1-_0x1d517e,0x0),_0x47506a[_0x4999f0(0x268)](_0x124ff1-_0x1d517e,_0x1d517e,_0x1d517e,Math['PI']*0x3/0x2,0x0,!0x1),_0x47506a['lineTo'](_0x124ff1,_0x181e25-_0x18ac16),_0x47506a[_0x4999f0(0x268)](_0x124ff1-_0x18ac16,_0x181e25-_0x18ac16,_0x18ac16,0x0,Math['PI']/0x2,!0x1),_0x47506a[_0x4999f0(0x245)](0x0,_0x181e25),_0x47506a[_0x4999f0(0x245)](0x0,_0x292f18),_0x47506a[_0x4999f0(0x268)](_0x292f18,_0x292f18,_0x292f18,Math['PI'],Math['PI']*0x3/0x2,!0x1),_0x47506a['closePath'](),_0x5f51b9[_0x4999f0(0x3f0)]&&(_0x47506a['save'](),_0x47506a[_0x4999f0(0x2d0)]=_0x5f51b9[_0x4999f0(0x3f0)],_0x5f51b9['fillRule']===_0x4999f0(0x1f0)?_0x47506a[_0x4999f0(0x3f0)](_0x4999f0(0x1f0)):_0x47506a['fill'](),_0x47506a[_0x4999f0(0x3ed)]());}class ie extends C[_0x322940(0x320)]{constructor(_0x38aeda,_0x1f4535){const _0x2b4ae8=_0x322940;super(_0x38aeda,_0x1f4535),_(this,_0x2b4ae8(0x3e7)),_(this,_0x2b4ae8(0x2fe)),(this[_0x2b4ae8(0x3e7)]=_0x1f4535==null?void 0x0:_0x1f4535[_0x2b4ae8(0x3e7)],this[_0x2b4ae8(0x2fe)]=_0x1f4535==null?void 0x0:_0x1f4535[_0x2b4ae8(0x2fe)]);}static[_0x322940(0x236)](_0x384d2c,_0x5202ef){const _0x1a639b=_0x322940,{text:_0x5b1345,color:_0x3df4f0}=_0x5202ef;_0x384d2c[_0x1a639b(0x25f)](),_0x384d2c['font']='bold\x2013px\x20Source\x20Han\x20Sans\x20CN';const _0x1f89b5=_0x384d2c[_0x1a639b(0x2e4)](_0x5b1345)[_0x1a639b(0x1d4)],_0x2a78c7=Math[_0x1a639b(0x1e0)](_0x1f89b5+0x2*ae,De);Tt(_0x384d2c,{'height':X,'radius':0x4,'width':_0x2a78c7,'fill':_0x3df4f0}),_0x384d2c['fillStyle']=_0x1a639b(0x34b);const _0x1b7f11=ae,_0x34eafe=X-Ct,_0x244ed2=De-0x2*ae;if(_0x1f89b5>_0x244ed2){let _0x4bc518='',_0x3fd711=0x0;for(const _0x177181 of _0x5b1345){const _0x3bdf54=_0x384d2c[_0x1a639b(0x2e4)](_0x177181)[_0x1a639b(0x1d4)];if(_0x3fd711+_0x3bdf54<=_0x244ed2-_0x384d2c[_0x1a639b(0x2e4)]('...')[_0x1a639b(0x1d4)])_0x4bc518+=_0x177181,_0x3fd711+=_0x3bdf54;else{_0x4bc518+=_0x1a639b(0x199);break;}}_0x384d2c[_0x1a639b(0x33d)](_0x4bc518,_0x1b7f11,_0x34eafe);}else _0x384d2c[_0x1a639b(0x33d)](_0x5b1345,_0x1b7f11,_0x34eafe);_0x384d2c[_0x1a639b(0x3ed)]();}[_0x322940(0x3d4)](_0x239550){const _0x2de716=_0x322940;ie[_0x2de716(0x236)](_0x239550,this);}}const ce=_0x322940(0x298),pt=_0x322940(0x3ea),Ot=_0x322940(0x306),Y=0x6,Rt=1.5,le=0x4,bt=1.5,Dt=_0x322940(0x3cd);class Ne{constructor(_0x337a76,_0x4ea106,_0x45567f,_0x854d52){const _0x3e810c=_0x322940;_(this,_0x3e810c(0x1d1),[]),_(this,_0x3e810c(0x3c6),null),_(this,_0x3e810c(0x243),null),_(this,_0x3e810c(0x323),null),_(this,_0x3e810c(0x3d7),null),_(this,_0x3e810c(0x36b),null),(this[_0x3e810c(0x38f)]=_0x337a76,this[_0x3e810c(0x20d)]=_0x4ea106,this['_docSkeleton']=_0x45567f,this[_0x3e810c(0x3fc)]=_0x854d52,this[_0x3e810c(0x23b)]());}set[_0x322940(0x1df)](_0x38e4cc){const _0xb4777b=_0x322940;_0x38e4cc?(this[_0xb4777b(0x323)]&&this[_0xb4777b(0x323)][_0xb4777b(0x1b8)](),this[_0xb4777b(0x243)]&&this[_0xb4777b(0x243)][_0xb4777b(0x219)]()):(this[_0xb4777b(0x323)]&&this[_0xb4777b(0x323)][_0xb4777b(0x219)](),this[_0xb4777b(0x243)]&&this[_0xb4777b(0x243)][_0xb4777b(0x1b8)]());}[_0x322940(0x198)](){const _0x1d49d7=_0x322940;for(const _0x40d571 of this[_0x1d49d7(0x1d1)])_0x40d571[_0x1d49d7(0x198)]();this[_0x1d49d7(0x243)]&&this['_textBubble']['dispose'](),this[_0x1d49d7(0x323)]&&this[_0x1d49d7(0x323)][_0x1d49d7(0x198)](),this['_anchor']&&this[_0x1d49d7(0x3c6)]['dispose'](),this[_0x1d49d7(0x36b)]&&this[_0x1d49d7(0x36b)]();}['_render'](){const _0x1334fc=_0x322940;var _0x117fb4;const {_docSkeleton:_0x4d8ee2,_document:_0x23801c}=this,{color:_0x4847a0,name:_0x5056a0,ranges:_0x2e6b3f}=this[_0x1334fc(0x38f)],_0x22d29f=_0x23801c[_0x1334fc(0x220)](),{docsLeft:_0x5d8feb,docsTop:_0x2acc8f}=_0x22d29f,_0x1169b5=new T[(_0x1334fc(0x1f5))](_0x22d29f,_0x4d8ee2);for(const {startOffset:_0x210ac8,endOffset:_0xbdc8db,rangeType:_0x3ca7b0,segmentId:_0x39c8d8,segmentPage:_0x433176,collapsed:_0xd2921a,isActive:_0xa977e1}of _0x2e6b3f){const _0x5365ef=_0x4d8ee2[_0x1334fc(0x2f4)](_0x210ac8,!0x0,_0x39c8d8,_0x433176);let _0x16b1c6=_0x4d8ee2['findNodePositionByCharIndex'](_0xbdc8db,!0x0,_0x39c8d8,_0x433176);if(_0x16b1c6==null&&(_0x16b1c6=_0x4d8ee2[_0x1334fc(0x2f4)](_0xbdc8db-0x1,!0x1,_0x39c8d8,_0x433176)),_0xa977e1){const {contentBoxPointGroup:_0x3ab90c}=_0x1169b5[_0x1334fc(0x25b)](_0x16b1c6,_0x16b1c6);if(_0x3ab90c['length']===0x0)continue;this['_drawAnchor'](_0x4847a0,_0x3ab90c,_0x5d8feb,_0x2acc8f,_0x5056a0),this[_0x1334fc(0x36b)]=this[_0x1334fc(0x28c)]();}if(_0x5365ef&&_0x16b1c6){if(_0x3ca7b0===a[_0x1334fc(0x309)][_0x1334fc(0x389)]){const _0x59ce9d=new T[(_0x1334fc(0x280))](_0x22d29f,_0x4d8ee2),{pointGroup:_0x58b3bb}=(_0x117fb4=_0x59ce9d[_0x1334fc(0x25b)](_0x5365ef,_0x16b1c6))!=null?_0x117fb4:{};if(_0x58b3bb==null||_0x58b3bb['length']===0x0)continue;this[_0x1334fc(0x293)](_0x4847a0,_0x58b3bb,_0x5d8feb,_0x2acc8f);}else{if(!_0xd2921a){const {borderBoxPointGroup:_0xb7781e}=_0x1169b5['getRangePointData'](_0x5365ef,_0x16b1c6);if(_0xb7781e[_0x1334fc(0x1ce)]===0x0)continue;this[_0x1334fc(0x1bf)](_0x4847a0,_0xb7781e,_0x5d8feb,_0x2acc8f);}}}}}[_0x322940(0x2e8)](_0x20f2db,_0x3cbbbc,_0x1c2ad4,_0x8afa6e,_0x263eb8){const _0x53a1e4=_0x322940,_0x236e09=this[_0x53a1e4(0x30e)](_0x3cbbbc),{left:_0xf34198,top:_0x5e73ec,height:_0x173746}=_0x236e09,_0x311745=this[_0x53a1e4(0x2b1)](),_0x3b3496=bt/_0x311745,_0x5bc791=new C[(_0x53a1e4(0x31e))](ce+a[_0x53a1e4(0x410)](Y),{'left':_0xf34198+_0x1c2ad4-_0x3b3496,'top':_0x5e73ec+_0x8afa6e,'height':_0x173746,'width':Rt,'fill':_0x20f2db||C[_0x53a1e4(0x28a)](a[_0x53a1e4(0x235)]['black'],0x0),'strokeWidth':_0x3b3496,'stroke':Dt,'evented':!0x0});this['_anchor']=_0x5bc791,this[_0x53a1e4(0x20d)]['addObject'](_0x5bc791,T[_0x53a1e4(0x319)]);const _0x3a4229=new C['Rect'](ce+a[_0x53a1e4(0x410)](Y),{'left':_0xf34198+_0x1c2ad4-_0x3b3496,'top':_0x5e73ec+_0x8afa6e-le/0x2,'height':le,'width':le,'fill':_0x20f2db||C[_0x53a1e4(0x28a)](a[_0x53a1e4(0x235)][_0x53a1e4(0x3b5)],0x0),'strokeWidth':0x0,'stroke':_0x20f2db||C[_0x53a1e4(0x28a)](a[_0x53a1e4(0x235)]['black'],0x0),'evented':!0x1});this[_0x53a1e4(0x323)]=_0x3a4229,this['_scene'][_0x53a1e4(0x3d1)](_0x3a4229,T['TEXT_RANGE_LAYER_INDEX']);const _0x49c551=new ie(ce+a['generateRandomId'](Y),{'left':_0xf34198+_0x1c2ad4-_0x3b3496,'top':_0x5e73ec+_0x8afa6e-X,'text':_0x263eb8,'color':_0x20f2db});this[_0x53a1e4(0x243)]=_0x49c551,this[_0x53a1e4(0x20d)][_0x53a1e4(0x3d1)](_0x49c551,T['TEXT_RANGE_LAYER_INDEX']),this[_0x53a1e4(0x1df)]=!0x1;}[_0x322940(0x28c)](){const _0x8f5804=_0x322940,_0x3b947a=this[_0x8f5804(0x3c6)][_0x8f5804(0x33e)][_0x8f5804(0x284)](()=>{const _0x1b3c99=_0x8f5804;this[_0x1b3c99(0x1df)]=!0x0;}),_0x2cfb92=this[_0x8f5804(0x3c6)][_0x8f5804(0x1e4)][_0x8f5804(0x284)](()=>{const _0x303d26=_0x8f5804;this[_0x303d26(0x3d7)]&&clearTimeout(this[_0x303d26(0x3d7)]),this['_hideTimer']=setTimeout(()=>{const _0x5e57d4=_0x303d26;this[_0x5e57d4(0x1df)]=!0x1;},0x7d0);});return()=>{const _0x4654c5=_0x8f5804;_0x3b947a[_0x4654c5(0x365)](),_0x2cfb92[_0x4654c5(0x365)]();};}[_0x322940(0x1bf)](_0x94bf68,_0x3aa75b,_0xb16748,_0x39e173){const _0x8eb7e6=_0x322940,_0x2b9461=new a['ColorKit'](_0x94bf68)['setAlpha'](0.2)[_0x8eb7e6(0x311)](),_0x1af7fc=new C[(_0x8eb7e6(0x267))](pt+a[_0x8eb7e6(0x410)](Y),{'pointsGroup':_0x3aa75b,'fill':_0x2b9461||C[_0x8eb7e6(0x28a)](a[_0x8eb7e6(0x235)]['black'],0.2),'left':_0xb16748,'top':_0x39e173,'evented':!0x1,'debounceParentDirty':!0x1});this[_0x8eb7e6(0x1d1)][_0x8eb7e6(0x32d)](_0x1af7fc),this['_scene'][_0x8eb7e6(0x3d1)](_0x1af7fc,T['TEXT_RANGE_LAYER_INDEX']);}[_0x322940(0x293)](_0x551bd7,_0x4d9b0a,_0x12679f,_0x440535){const _0x4bb2a0=_0x322940,_0x593f14=new a[(_0x4bb2a0(0x3b2))](_0x551bd7)['setAlpha'](0.2)[_0x4bb2a0(0x311)](),_0x42c515=new C[(_0x4bb2a0(0x267))](Ot+a[_0x4bb2a0(0x410)](Y),{'pointsGroup':_0x4d9b0a,'fill':_0x593f14||C[_0x4bb2a0(0x28a)](a[_0x4bb2a0(0x235)][_0x4bb2a0(0x3b5)],0.2),'left':_0x12679f,'top':_0x440535,'evented':!0x1,'debounceParentDirty':!0x1});this[_0x4bb2a0(0x1d1)][_0x4bb2a0(0x32d)](_0x42c515),this[_0x4bb2a0(0x20d)][_0x4bb2a0(0x3d1)](_0x42c515,T[_0x4bb2a0(0x319)]);}[_0x322940(0x30e)](_0x9095dc){const _0x3796c4=_0x9095dc[0x0],_0x4e2c05=_0x3796c4[0x0],_0x2d08bc=_0x3796c4[0x2],{x:_0x357cbb,y:_0xabd66}=_0x4e2c05,{x:_0x928caa,y:_0x5cc6d7}=_0x2d08bc;return{'left':_0x357cbb,'top':_0xabd66,'width':_0x928caa-_0x357cbb,'height':_0x5cc6d7-_0xabd66};}[_0x322940(0x2b1)](){const _0x313679=_0x322940,{scaleX:_0x5655bd,scaleY:_0x4e6218}=this[_0x313679(0x20d)][_0x313679(0x227)]();return Math[_0x313679(0x354)](_0x5655bd,_0x4e6218);}}var Nt=Object['getOwnPropertyDescriptor'],Ut=(_0x96d309,_0x8d4388,_0x371da6,_0x4e3c3d)=>{const _0x2736a4=_0x322940;for(var _0x4e0cbd=_0x4e3c3d>0x1?void 0x0:_0x4e3c3d?Nt(_0x8d4388,_0x371da6):_0x8d4388,_0x3808ea=_0x96d309[_0x2736a4(0x1ce)]-0x1,_0x795bde;_0x3808ea>=0x0;_0x3808ea--)(_0x795bde=_0x96d309[_0x3808ea])&&(_0x4e0cbd=_0x795bde(_0x4e0cbd)||_0x4e0cbd);return _0x4e0cbd;},q=(_0x3a909d,_0xe5464f)=>(_0x243b21,_0x17d43c)=>_0xe5464f(_0x243b21,_0x17d43c,_0x3a909d);let ge=class extends a[_0x322940(0x310)]{constructor(_0x1ec023,_0x3580cc,_0x541dd,_0x6e3ad6,_0x3eb9a1){const _0x3c39c1=_0x322940;super(),_(this,_0x3c39c1(0x334),[]),_(this,_0x3c39c1(0x21a),[]),(this[_0x3c39c1(0x351)]=_0x1ec023,this['_docSkeletonManagerService']=_0x3580cc,this[_0x3c39c1(0x1cc)]=_0x541dd,this[_0x3c39c1(0x263)]=_0x6e3ad6,this[_0x3c39c1(0x2c9)]=_0x3eb9a1,this['_init']());}[_0x322940(0x3a3)](){const _0x4b0aa4=_0x322940,_0x3ff404=this['_context'][_0x4b0aa4(0x336)],_0x335a85=this[_0x4b0aa4(0x26f)];this[_0x4b0aa4(0x192)](I[_0x4b0aa4(0x2a8)]([this[_0x4b0aa4(0x1cc)][_0x4b0aa4(0x3ce)](_0x3ff404),this['_themeService'][_0x4b0aa4(0x3c8)]])[_0x4b0aa4(0x396)]($['map'](([_0x40b5be,_0x24d70d])=>({'skeleton':_0x335a85[_0x4b0aa4(0x3cc)](),'cursors':[..._0x40b5be[_0x4b0aa4(0x261)]()][_0x4b0aa4(0x189)](_0x3ed911=>({..._0x3ed911,'color':this['_themeService']['getColorFromTheme'](_0x3ed911[_0x4b0aa4(0x3e7)])}))})))[_0x4b0aa4(0x2e7)](_0x4eb909=>{const _0x9de929=_0x4b0aa4;if(this['_removeCollabCursors'](),_0x4eb909){const {skeleton:_0x2a8335,cursors:_0x13e5be}=_0x4eb909;this[_0x9de929(0x2b4)](_0x2a8335,_0x13e5be);}})),this[_0x4b0aa4(0x21c)](),this['_initCommandExecutedListener']();}[_0x322940(0x2b4)](_0x49c514,_0xc386ac){const _0x355e0f=_0x322940,{scene:_0x22297a,mainComponent:_0x1ed4f6}=this[_0x355e0f(0x351)],_0x1ae396=_0xc386ac[_0x355e0f(0x19c)](_0x65b57=>new Ne(_0x65b57,_0x22297a,_0x49c514,_0x1ed4f6));this[_0x355e0f(0x334)]=_0x1ae396,this[_0x355e0f(0x21a)]=_0xc386ac;}['_refreshCollabCursors'](){const _0x56d798=_0x322940;this[_0x56d798(0x36e)]();const {scene:_0x403577,mainComponent:_0x1ef98c}=this[_0x56d798(0x351)],_0x222be3=this['_docSkeletonManagerService'][_0x56d798(0x3cc)](),_0x487b1d=this[_0x56d798(0x21a)][_0x56d798(0x19c)](_0x29ab=>new Ne(_0x29ab,_0x403577,_0x222be3,_0x1ef98c));this[_0x56d798(0x334)]=_0x487b1d;}[_0x322940(0x36e)](){const _0x3f590e=_0x322940;this[_0x3f590e(0x334)][_0x3f590e(0x2c8)](_0x74ed6=>_0x74ed6['dispose']()),this[_0x3f590e(0x334)]=[];}[_0x322940(0x307)](){const _0x42bf00=_0x322940,_0x6e9e35=[T[_0x42bf00(0x276)]['id']];this['disposeWithMe'](this[_0x42bf00(0x263)][_0x42bf00(0x2dd)](_0x3489c0=>{const _0x5b7100=_0x42bf00;_0x6e9e35[_0x5b7100(0x2cb)](_0x3489c0['id'])&&_0x3489c0[_0x5b7100(0x2b2)][_0x5b7100(0x336)]===this[_0x5b7100(0x351)][_0x5b7100(0x336)]&&this[_0x5b7100(0x2bc)]();}));}[_0x322940(0x21c)](){const _0x2b3557=_0x322940;this[_0x2b3557(0x192)](a[_0x2b3557(0x3e8)](this[_0x2b3557(0x351)][_0x2b3557(0x2c7)]['onTransformChange$'])[_0x2b3557(0x396)]($[_0x2b3557(0x2d4)](_0x5a6950=>_0x5a6950[_0x2b3557(0x302)]===C['TRANSFORM_CHANGE_OBSERVABLE_TYPE'][_0x2b3557(0x25c)]),$[_0x2b3557(0x239)](0x10))[_0x2b3557(0x2e7)](()=>{const _0x313164=_0x2b3557;this[_0x313164(0x2bc)]();}));}};ge=Ut([q(0x1,a[_0x322940(0x1da)](W['DocSkeletonManagerService'])),q(0x2,a['Inject'](B)),q(0x3,a[_0x322940(0x338)]),q(0x4,a[_0x322940(0x1da)](a[_0x322940(0x407)]))],ge);const Lt=0x1,Mt=1.5;class Be extends C[_0x322940(0x320)]{constructor(_0x4851e3,_0x596313){const _0x366c67=_0x322940;super(_0x4851e3,_0x596313),_(this,'_color'),_(this,_0x366c67(0x352),!0x1),_(this,_0x366c67(0x379)),_(this,_0x366c67(0x38d),''),_(this,_0x366c67(0x1b1),'top'),_(this,_0x366c67(0x165)),(_0x596313&&this[_0x366c67(0x1f9)](_0x596313),this[_0x366c67(0x33e)]['subscribeEvent'](()=>this[_0x366c67(0x1f9)]({'hovered':!0x0})),this[_0x366c67(0x1e4)]['subscribeEvent'](()=>this[_0x366c67(0x1f9)]({'hovered':!0x1})));}[_0x322940(0x1f9)](_0x4f9e35){const _0x1f6c32=_0x322940;var _0x53b9cf,_0x1e6c4e,_0x46547f,_0x1377c3,_0x22b61f,_0x414211;this['_color']=(_0x53b9cf=_0x4f9e35[_0x1f6c32(0x3e7)])!=null?_0x53b9cf:this[_0x1f6c32(0x329)],this['_hovered']=(_0x1e6c4e=_0x4f9e35['hovered'])!=null?_0x1e6c4e:this[_0x1f6c32(0x352)],this[_0x1f6c32(0x379)]=(_0x46547f=_0x4f9e35[_0x1f6c32(0x207)])!=null?_0x46547f:this[_0x1f6c32(0x379)],this[_0x1f6c32(0x38d)]=(_0x1377c3=_0x4f9e35[_0x1f6c32(0x1ba)])!=null?_0x1377c3:this['_name'],this['_labelPosition']=(_0x22b61f=_0x4f9e35[_0x1f6c32(0x169)])!=null?_0x22b61f:this['_labelPosition'],this['_backgroundColor']=(_0x414211=_0x4f9e35[_0x1f6c32(0x225)])!=null?_0x414211:this[_0x1f6c32(0x165)],this['transformByState']({'width':_0x4f9e35[_0x1f6c32(0x1d4)],'height':_0x4f9e35[_0x1f6c32(0x403)]});}[_0x322940(0x242)](_0x2722f9){const _0x231e25=_0x322940,{row:_0x378fb2,column:_0x1c8854}=_0x2722f9;if(_0x378fb2>=this[_0x231e25(0x379)][_0x231e25(0x281)]&&_0x378fb2<=this[_0x231e25(0x379)][_0x231e25(0x1c0)]&&_0x1c8854>=this[_0x231e25(0x379)][_0x231e25(0x17d)]&&_0x1c8854<=this[_0x231e25(0x379)][_0x231e25(0x34f)]){this['setShapeProps']({'hovered':!0x0});return;}this['setShapeProps']({'hovered':!0x1});}['triggerDblclick'](_0x1d791a){return!0x1;}[_0x322940(0x3d4)](_0x20d573){const _0x166199=_0x322940;C[_0x166199(0x31e)][_0x166199(0x236)](_0x20d573,{'width':this[_0x166199(0x1d4)],'height':this[_0x166199(0x403)],'strokeWidth':Mt,'stroke':this['_color'],'evented':!0x1,'fill':this[_0x166199(0x165)]}),this['_hovered']&&(_0x20d573[_0x166199(0x25f)](),_0x20d573[_0x166199(0x39d)](0x1,0x0,0x0,0x1,this[_0x166199(0x1d4)],this['_labelPosition']==='bottom'?0x0:-X),ie[_0x166199(0x236)](_0x20d573,{'text':this[_0x166199(0x38d)],'color':this['_color']}),_0x20d573[_0x166199(0x3ed)]());}}var At=Object[_0x322940(0x27e)],Pt=(_0x5aae8c,_0x349e18,_0x43debb,_0x22aa86)=>{for(var _0x42aa03=_0x22aa86>0x1?void 0x0:_0x22aa86?At(_0x349e18,_0x43debb):_0x349e18,_0x422791=_0x5aae8c['length']-0x1,_0xa154a3;_0x422791>=0x0;_0x422791--)(_0xa154a3=_0x5aae8c[_0x422791])&&(_0x42aa03=_0xa154a3(_0x42aa03)||_0x42aa03);return _0x42aa03;},_e=(_0x148a25,_0x1c9d6d)=>(_0x381a64,_0x26161d)=>_0x1c9d6d(_0x381a64,_0x26161d,_0x148a25);const wt=0x1389;let ve=class extends a[_0x322940(0x310)]{constructor(_0xc6f275,_0x5ce679,_0x5f3818,_0x22a7b7){const _0x160400=_0x322940;super(),_(this,_0x160400(0x21a),new Set()),_(this,_0x160400(0x363),null),(this[_0x160400(0x351)]=_0xc6f275,this[_0x160400(0x18f)]=_0x5ce679,this['_collabCursorController']=_0x5f3818,this[_0x160400(0x2c9)]=_0x22a7b7,this['_init']());}[_0x322940(0x3a3)](){const _0x25c7e3=_0x322940;this[_0x25c7e3(0x18f)][_0x25c7e3(0x1cf)][_0x25c7e3(0x396)]($[_0x25c7e3(0x1e9)](this[_0x25c7e3(0x183)]),$[_0x25c7e3(0x241)](_0x5155e9=>{const _0x51f552=_0x25c7e3;if(_0x5155e9){const _0x81426a=_0x5155e9[_0x51f552(0x203)];return I['combineLatest'](this['_collabCursorController']['getCollabCursors$'](this[_0x51f552(0x351)]['unitId']),this[_0x51f552(0x2c9)][_0x51f552(0x3c8)])[_0x51f552(0x396)]($[_0x51f552(0x19c)](([_0x573fb2,_0x436dc4])=>{const _0x373135=new Map();return _0x573fb2['forEach']((_0x1a4e86,_0x3e285d)=>{const _0x4aff38=_0x2b7c;if(_0x1a4e86['sheetID']===_0x81426a){const _0x51aef5={..._0x1a4e86};_0x51aef5[_0x4aff38(0x3e7)]=this[_0x4aff38(0x2c9)]['getColorFromTheme'](_0x1a4e86[_0x4aff38(0x3e7)]),_0x373135['set'](_0x3e285d,_0x51aef5);}}),{'skeleton':_0x5155e9,'cursors':_0x373135};}));}return I['of']({'skeleton':null,'cursors':new Map()});}))['subscribe'](({skeleton:_0x13a33b,cursors:_0x49e7a1})=>{const _0x5e47e8=_0x25c7e3;this[_0x5e47e8(0x36e)](),_0x13a33b&&this['_updateCollabCursors'](_0x13a33b,_0x49e7a1);}),this[_0x25c7e3(0x18f)][_0x25c7e3(0x1cf)][_0x25c7e3(0x2e7)](_0xe0df24=>{const _0x21b07b=_0x25c7e3;if(_0xe0df24==null)return;const {skeleton:_0x73a8a1}=_0xe0df24,{scene:_0x246a71}=this[_0x21b07b(0x351)];_0x246a71['onPointerMove$'][_0x21b07b(0x284)](a['debounce'](_0x5c6345=>{const _0x337296=_0x21b07b;var _0x2ae778,_0x417cad;const {offsetX:_0x210a11,offsetY:_0x3c09cc}=_0x5c6345,{x:_0x57a6bc,y:_0x2e7ec9}=_0x246a71['getRelativeToViewportCoord'](C[_0x337296(0x182)][_0x337296(0x37c)]([_0x210a11,_0x3c09cc])),{scaleX:_0x358a95,scaleY:_0x2096e3}=_0x246a71[_0x337296(0x227)](),_0xf11f6e=_0x246a71[_0x337296(0x208)](C[_0x337296(0x1bc)][_0x337296(0x3fb)]),_0xd045d9=_0x246a71[_0x337296(0x1ee)](C['Vector2']['FromArray']([_0x57a6bc,_0x2e7ec9]),_0xf11f6e),_0x2068a5=_0x73a8a1[_0x337296(0x1c2)](_0x210a11,_0x3c09cc,_0x358a95,_0x2096e3,_0xd045d9);((_0x2ae778=this[_0x337296(0x363)])==null?void 0x0:_0x2ae778[_0x337296(0x2e2)])===_0x2068a5[_0x337296(0x2e2)]&&((_0x417cad=this[_0x337296(0x363)])==null?void 0x0:_0x417cad[_0x337296(0x246)])===_0x2068a5[_0x337296(0x246)]||this[_0x337296(0x21a)][_0x337296(0x2c8)](_0x4ae3c5=>{_0x4ae3c5['onMouseMove'](_0x2068a5);});},0x64));});}[_0x322940(0x2b4)](_0x198cc1,_0x1daf2f){const _0x76650c=_0x322940;var _0x2ca77c;const _0x526dbe=(_0x2ca77c=this[_0x76650c(0x18f)][_0x76650c(0x3df)]())==null?void 0x0:_0x2ca77c['skeleton'];if(!_0x526dbe)return;const _0x2c5492=this[_0x76650c(0x32c)]();if(!_0x2c5492)return;this[_0x76650c(0x21a)][_0x76650c(0x2c8)](_0x570714=>{const _0x24f645=_0x76650c;_0x570714[_0x24f645(0x1de)]();});const {scene:_0x1e2a06}=_0x2c5492,_0x37c2b6=yt(Array['from'](_0x1daf2f[_0x76650c(0x261)]()))[_0x76650c(0x19c)](_0x282138=>{const _0x33e328=_0x76650c,{color:_0x3abd5d,range:_0x3eb80f,name:_0x30b77d,selection:_0x56cb15,sheetID:_0xd5af20}=_0x282138,{startColumn:_0x2d2dbc,startRow:_0x216a9f,endColumn:_0x44c8a4,endRow:_0x23b9a8}=_0x3eb80f,_0x14eb66=z['getCoordByCell'](_0x216a9f,_0x2d2dbc,_0x1e2a06,_0x526dbe),_0x1eac3f=z[_0x33e328(0x3ae)](_0x23b9a8,_0x44c8a4,_0x1e2a06,_0x526dbe),{columnHeaderHeightAndMarginTop:_0x1251a7}=_0x526dbe,{startX:_0x363b5f,startY:_0x3b99e}=_0x14eb66,{endX:_0x23daa6,endY:_0x5bb9e0}=_0x1eac3f,_0xa5939c=_0x23daa6-_0x363b5f,_0x4f2698=_0x5bb9e0-_0x3b99e,_0x2d12bd={'labelPosition':_0x3b99e-_0x1251a7>=X?_0x33e328(0x20b):_0x33e328(0x322),'sheetID':_0xd5af20,'range':_0x3eb80f,'color':_0x3abd5d,'name':_0x30b77d,'selection':_0x56cb15,'left':_0x363b5f,'top':_0x3b99e,'width':_0xa5939c,'height':_0x4f2698,'evented':!0x1,'zIndex':wt};return new Be(_0x30b77d,_0x2d12bd);});_0x1e2a06[_0x76650c(0x1a6)](_0x37c2b6,Lt),this['_cursors']=new Set(_0x37c2b6);}[_0x322940(0x36e)](){const _0x3767d6=_0x322940;var _0x5f1c2a;(_0x5f1c2a=this['_cursors'])==null||_0x5f1c2a[_0x3767d6(0x2c8)](_0x45e117=>_0x45e117[_0x3767d6(0x198)]());}['_getSheetObject'](){const _0x17fd1a=_0x322940;return z[_0x17fd1a(0x23d)](this[_0x17fd1a(0x351)][_0x17fd1a(0x2d7)],this[_0x17fd1a(0x351)]);}};ve=Pt([_e(0x1,a[_0x322940(0x1da)](z[_0x322940(0x1a9)])),_e(0x2,a[_0x322940(0x1da)](B)),_e(0x3,a[_0x322940(0x1da)](a['ThemeService']))],ve);function yt(_0x1226b8){const _0x17c894=_0x322940,_0x115ed0=new Map();return _0x1226b8[_0x17c894(0x2c8)](_0x455e2a=>{const _0x2fc607=_0x17c894;if(_0x115ed0[_0x2fc607(0x1a0)](_0x455e2a[_0x2fc607(0x174)])){const _0x1fdaa2=_0x115ed0[_0x2fc607(0x38c)](_0x455e2a['selection']);_0x1fdaa2[_0x2fc607(0x1ba)]+=',\x20'+_0x455e2a[_0x2fc607(0x1ba)];}else _0x115ed0[_0x2fc607(0x269)](_0x455e2a[_0x2fc607(0x174)],_0x455e2a);}),Array[_0x17c894(0x37e)](_0x115ed0['values']());}var $t=Object[_0x322940(0x27e)],xt=(_0x48aa37,_0x33f098,_0x8308f4,_0x5a23fa)=>{const _0x27f41c=_0x322940;for(var _0x2b99d1=_0x5a23fa>0x1?void 0x0:_0x5a23fa?$t(_0x33f098,_0x8308f4):_0x33f098,_0x5e06b5=_0x48aa37[_0x27f41c(0x1ce)]-0x1,_0x2e361a;_0x5e06b5>=0x0;_0x5e06b5--)(_0x2e361a=_0x48aa37[_0x5e06b5])&&(_0x2b99d1=_0x2e361a(_0x2b99d1)||_0x2b99d1);return _0x2b99d1;},y=(_0x5c6b88,_0x24ee63)=>(_0x557c35,_0x3e7020)=>_0x24ee63(_0x557c35,_0x3e7020,_0x5c6b88);let J=class extends a['Disposable']{constructor(_0x1adba7,_0x57c256,_0x5b6e2b,_0x3f95d2,_0x1c6c4f,_0xdcafa){const _0x2a4ea3=_0x322940;super(),this[_0x2a4ea3(0x335)]=_0x1adba7,this[_0x2a4ea3(0x287)]=_0x57c256,this[_0x2a4ea3(0x1db)]=_0x5b6e2b,this[_0x2a4ea3(0x3ca)]=_0x3f95d2,this[_0x2a4ea3(0x3a0)]=_0x1c6c4f,this['_localeService']=_0xdcafa,this[_0x2a4ea3(0x2ee)](),this[_0x2a4ea3(0x339)]();}['_setupBeforeClosingHandler'](){const _0x1a69eb=_0x322940;this['disposeWithMe'](this[_0x1a69eb(0x335)]['registerBeforeClose'](()=>{const _0x893a90=_0x1a69eb;if(this['_localCacheService']['saveTaskMap']['size'])return this[_0x893a90(0x19a)]['t'](_0x893a90(0x33a));}));}[_0x322940(0x339)](){const _0x3a9987=_0x322940;this[_0x3a9987(0x192)](this[_0x3a9987(0x1db)][_0x3a9987(0x158)]['subscribe'](_0x486bba=>{const _0x36755d=_0x3a9987;_0x486bba['id']===u[_0x36755d(0x196)][_0x36755d(0x184)]&&this[_0x36755d(0x3ca)][_0x36755d(0x219)]({'type':p[_0x36755d(0x2b6)]['Warning'],'content':this[_0x36755d(0x19a)]['t'](_0x36755d(0x2e5))}),_0x486bba['id']===u[_0x36755d(0x196)][_0x36755d(0x378)]&&this[_0x36755d(0x3ca)][_0x36755d(0x219)]({'type':p[_0x36755d(0x2b6)][_0x36755d(0x2df)],'content':this[_0x36755d(0x19a)]['t'](_0x36755d(0x3f1))}),_0x486bba['id']===u[_0x36755d(0x196)][_0x36755d(0x377)]&&this['_notificationService'][_0x36755d(0x219)]({'title':this[_0x36755d(0x19a)]['t'](_0x36755d(0x265)),'content':this[_0x36755d(0x19a)]['t'](_0x36755d(0x40e)),'type':'error','duration':0x0}),_0x486bba['id']===u[_0x36755d(0x196)][_0x36755d(0x342)]&&this[_0x36755d(0x3ca)][_0x36755d(0x219)]({'type':p[_0x36755d(0x2b6)][_0x36755d(0x286)],'content':this['_localeService']['t'](_0x36755d(0x3f1))+'('+_0x486bba[_0x36755d(0x15e)]+')'}),_0x486bba['id']===u[_0x36755d(0x196)][_0x36755d(0x1b2)]&&this[_0x36755d(0x3ca)][_0x36755d(0x219)]({'type':p[_0x36755d(0x2b6)][_0x36755d(0x2df)],'content':this[_0x36755d(0x19a)]['t'](_0x486bba[_0x36755d(0x15e)]||'')}),_0x486bba['id']===u[_0x36755d(0x196)][_0x36755d(0x2a6)]&&this[_0x36755d(0x3ca)][_0x36755d(0x219)]({'type':p['MessageType']['Warning'],'content':this[_0x36755d(0x19a)]['t'](_0x36755d(0x38a))}),_0x486bba['id']===u[_0x36755d(0x196)][_0x36755d(0x291)]&&this[_0x36755d(0x3ca)][_0x36755d(0x219)]({'type':p['MessageType'][_0x36755d(0x286)],'content':this[_0x36755d(0x19a)]['t']('session.connection-failed')}),_0x486bba['id']===u[_0x36755d(0x196)]['SUBMIT_CHANGESET_TIMEOUT']&&this[_0x36755d(0x3ca)][_0x36755d(0x219)]({'type':p[_0x36755d(0x2b6)][_0x36755d(0x286)],'content':this[_0x36755d(0x19a)]['t'](_0x36755d(0x346))});}));}};J=xt([y(0x0,O[_0x322940(0x3b6)]),y(0x1,u[_0x322940(0x18d)]),y(0x2,a['Inject'](u[_0x322940(0x22b)])),y(0x3,O[_0x322940(0x305)]),y(0x4,O[_0x322940(0x2f8)]),y(0x5,a[_0x322940(0x1da)](a[_0x322940(0x393)]))],J);const Bt=_0x322940(0x256),Ue={};var Ft=Object[_0x322940(0x27e)],kt=(_0x3a92c9,_0x1b9acd,_0x409432,_0x57e8bd)=>{const _0x2a8656=_0x322940;for(var _0x1de476=_0x57e8bd>0x1?void 0x0:_0x57e8bd?Ft(_0x1b9acd,_0x409432):_0x1b9acd,_0x56c68e=_0x3a92c9[_0x2a8656(0x1ce)]-0x1,_0x128af4;_0x56c68e>=0x0;_0x56c68e--)(_0x128af4=_0x3a92c9[_0x56c68e])&&(_0x1de476=_0x128af4(_0x1de476)||_0x1de476);return _0x1de476;},Le=(_0x695d2b,_0x283b45)=>(_0x4cbecb,_0x52da4e)=>_0x283b45(_0x4cbecb,_0x52da4e,_0x695d2b);let Z=class{constructor(_0x5852b2,_0x58f58c){const _0x1240c7=_0x322940;this[_0x1240c7(0x1ae)]=_0x5852b2,this[_0x1240c7(0x290)]=_0x58f58c;}[_0x322940(0x367)](_0x471286){const _0x31663d=_0x322940;this['_transformUndoRedoStack'](_0x471286),this[_0x31663d(0x1af)](_0x471286);}['transformRemoteChangeset'](_0xf73d76){const _0x253b1c=_0x322940,{unitID:_0x5c685a}=_0xf73d76,_0x16dbba=this[_0x253b1c(0x290)]['getRenderById'](_0x5c685a)[_0x253b1c(0x39f)](T['DocIMEInputManagerService']),{redoCache:_0x59b9fa}=_0x16dbba[_0x253b1c(0x1cd)]();if(_0x59b9fa[_0x253b1c(0x1ce)]===0x0)return _0xf73d76;let _0xb329c5=a[_0x253b1c(0x19b)]['deepClone'](_0xf73d76[_0x253b1c(0x3fa)][0x0]);for(let _0x55e980=0x0;_0x55e980<_0x59b9fa[_0x253b1c(0x1ce)];_0x55e980++){const _0xca5b27={'id':'doc.mutation.rich-text-editing','params':{..._0x59b9fa[_0x55e980]}},_0x1f1531=this[_0x253b1c(0x1ae)]['transformMutation'](_0xb329c5,_0xca5b27,!0x1);if(v['isTransformMutationFailure'](_0x1f1531))throw _0x1f1531['error'];_0xb329c5=_0x1f1531[_0x253b1c(0x382)];}return{...a['Tools'][_0x253b1c(0x216)](_0xf73d76),'mutations':[_0xb329c5]};}[_0x322940(0x2ae)](_0x27128a){const _0x11312f=_0x322940,{unitID:_0x31c440}=_0x27128a,_0x3f84f3=this[_0x11312f(0x290)][_0x11312f(0x301)](_0x31c440)['with'](T[_0x11312f(0x24a)]),{undoCache:_0x3c8ea7,redoCache:_0x5b786c}=_0x3f84f3[_0x11312f(0x1cd)]();if(_0x3c8ea7[_0x11312f(0x1ce)]===0x0||_0x5b786c[_0x11312f(0x1ce)]===0x0)return;const _0x173dbd=[],_0x4504b6=[];let _0x4c08de=a['Tools'][_0x11312f(0x216)](_0x27128a[_0x11312f(0x3fa)][0x0]),_0x4bd5d6=a[_0x11312f(0x19b)][_0x11312f(0x216)](_0x27128a[_0x11312f(0x3fa)][0x0]);for(let _0x1af93a=_0x3c8ea7[_0x11312f(0x1ce)]-0x1;_0x1af93a>=0x0;_0x1af93a--){const _0x53d7a1={'id':'doc.mutation.rich-text-editing','params':{..._0x3c8ea7[_0x1af93a]}},_0x398dd1={'id':_0x11312f(0x2fd),'params':{..._0x5b786c[_0x1af93a]}},_0x268144=this[_0x11312f(0x1ae)]['transformMutation'](_0x4c08de,_0x53d7a1,!0x1),_0x11c2c1=this[_0x11312f(0x1ae)][_0x11312f(0x2a1)](_0x4bd5d6,_0x398dd1,!0x1);if(v['isTransformMutationFailure'](_0x268144))throw _0x268144['error'];if(v[_0x11312f(0x201)](_0x11c2c1))throw _0x11c2c1['error'];_0x173dbd['unshift'](_0x268144[_0x11312f(0x187)][_0x11312f(0x2b2)]),_0x4504b6['unshift'](_0x11c2c1[_0x11312f(0x187)][_0x11312f(0x2b2)]),_0x4c08de=_0x268144[_0x11312f(0x382)],_0x4bd5d6=_0x11c2c1[_0x11312f(0x382)];}_0x3f84f3['setUndoRedoMutationParamsCache']({'undoCache':_0x173dbd,'redoCache':_0x4504b6});}[_0x322940(0x1af)](_0x188082){const _0x3d1cbc=_0x322940,{unitID:_0x5d5ca5}=_0x188082,_0x3cba0b=this[_0x3d1cbc(0x290)][_0x3d1cbc(0x301)](_0x5d5ca5)[_0x3d1cbc(0x39f)](T[_0x3d1cbc(0x24a)]),_0x11f870=_0x3cba0b[_0x3d1cbc(0x1b6)]();if(_0x11f870==null)return;const _0x234e6b=[{'id':_0x3d1cbc(0x2fd),'params':{'unitId':_0x188082[_0x3d1cbc(0x394)],'actions':null,'textRanges':[_0x11f870]}}],_0x195d38=this[_0x3d1cbc(0x1ae)][_0x3d1cbc(0x294)](_0x188082,_0x234e6b);if(!v[_0x3d1cbc(0x22d)](_0x195d38))throw _0x195d38['error'];const _0x161d40=_0x195d38['m2Prime'][0x0][_0x3d1cbc(0x2b2)]['textRanges'];Array[_0x3d1cbc(0x161)](_0x161d40)&&_0x161d40[_0x3d1cbc(0x1ce)]&&_0x3cba0b['setActiveRange'](_0x161d40[0x0]);}};function _0x384d(){const _0x5eb61c=['transformStateCache','_getSheetObject','push','Rectangle','clearInterval','_transformHistoryAndStateStack','_handleLeaveEvent','_collabCursorState$','_collabSessionService','_cursorShapes','_beforeCloseService','unitId','body','ICommandService','_initEvent','collaboration-client.offline-data-not-saved','some','find','fillText','onPointerEnter$','DEFAULT_REMOTE_UNISCRIPT_EXECUTION_ENDPOINT','on-line-icon','pluginName','CONFLICT','/universer-api/license/formula/limit/start','startsWith','M3.61971\x2011.6499C2.40304\x2011.6499\x200.699707\x2011.1024\x200.699707\x208.9124C0.699707\x206.3574\x203.25471\x205.8099\x203.98471\x205.8099C4.34971\x204.5324\x205.07971\x202.5249\x207.99971\x202.5249C10.5547\x202.5249\x2011.6497\x203.9849\x2012.0147\x205.2624C12.0147\x205.2624\x2015.2997\x205.6274\x2015.2997\x208.7299C15.2997\x2010.9199\x2013.8397\x2011.6499\x2012.3797\x2011.6499M9.82471\x209.82466L6.17471\x2013.4747M6.17471\x209.82466L9.82471\x2013.4747','session.collaboration-timeout','WebURLService','now','_doCreateSocket','on-line-icon_clip0_910_349','#FFF','symbol','handleInsertCol','OTHER_CLIENTS_EDITING','endColumn','actions','_context','_hovered','getSheetBySheetId','max','DesktopCollaborationStatusDisplayController','_updateSubUnitFromURLParams','univerjs-icon\x20univerjs-icon-','then','jiqing.500','Plugin','_registerDependencies','APPLY_DUPLICATED','USER_IS_ANONYMOUS','_updateLocalCursor','ENTITLE_DUP_SUBSCRIPTION','_removeClearOtherTimer','0\x200\x2016\x2016','YUUMI_PROMPT_MAX_TOKENS_EXCEEDED','_lastPointer','REMOTE_UNISCRIPT_EXECUTION_ENDPOINT_KEY','unsubscribe','parseInt','transformIMECache','ALREADY_EXISTS','yellow.400','transformRemoteChangeset','_eventUnsubscribe','_cachedData','M0\x200H16V16H0z','_removeCollabCursors','_startSheetCollabCursor','onRendered','univer-text-sm\x20univer-leading-8\x20univer-text-gray-600\x20dark:!univer-text-gray-200','blue.400','defIds','touchDependencies','RevisionService','OFFLINE','PERMISSION_DENIED','CLOSE_ROOM','_range','IDocClipboardService','_hasFormulaInDirtyRanges','FromArray','defineProperty','from','currentColor','_initDependencies','DataLoaderService','m1Prime','SNAPSHOT_INVALID_SNAPSHOT','2247756iLGcNP','INTERNAL_ERROR','roomMembers','YUUMI_CONNECTOR_URL_NOT_FOUND','getformulaLimitStatusUrl','RECT','session.will-retry','useDependency','get','_name','AWAITING_WITH_PENDING','_cursor','UPDATE_CURSOR','displayName','white','LocaleService','unitID','createInstance','pipe','EMAIL_HAS_BEEN_BOUND','_entities','COLLABORATION_CLIENT_PLUGIN_CONFIG_KEY','CollaborationStatus','USERS_LEAVE','dirtyRanges','transform','sessionTicket','with','_notificationService','use','shift','_init','getCellMatrix','entries','UNIVER_COLLABORATION_CLIENT_WEB_PLUGIN','transformSelections','YUUMI_ALL_TABLES_IS_INVALID','current','_injector','MOBILE_HAS_BEEN_BOUND','imageSourceType','MemberService','getCoordByCell','_docTransformIMECacheService','?taskId=','beginPath','ColorKit','ISocketService','delete','black','IBeforeCloseService','stageInfo','DEFAULT_WS_SESSION_TICKET_URL','_showGuardMessage','_handleJoinEvent','APPLY_NON_SEQUENTIAL_REVISION','LICENSE_EXPORT_SIZE_EXCEEDED','assign','_scheduleSaving','InsertColCommandId','_configService','_collaborationController','eventID','toStringTag','updateOfflineData','_registerRenderDependencies','_anchor','http://www.w3.org/2000/svg','currentTheme$','defs','_messageService','0\x200\x2017\x2016','getSkeleton','rgba(255,\x20255,\x20255,\x200.01)','getCollabCursors$','_urlService','collabStatus.fetchMiss','addObject','UniverIcon','activeSheet$','_draw','TOO_MANY_REQUESTS','Subject','_hideTimer','_pollingInterval','_selfUnitIDs','collabCursorState$','6pmhELe','OffLineIcon','_taskIds','Tooltip','getCurrent','_heartbeatTimer','ACTIVE_UNIT_EVENT_CHANNEL','substring','ENTITLE_REPORT_LIMIT_EXCEED','1143715REWQWe','_imageIoService','_handleEvent','color','fromEventSubject','totalFormulasToCalculate','collab-text-range-','YUUMI_RATE_OVER_LIMIT','onLocalMutation','restore','NO_OTHER_CLIENTS_EDITING','REDEMPTION_CODE_FULLY_REDEEMED','fill','collaboration.closeRoom','serializeRangeWithSheet','moveTo','UNIVER_DOC','/universer-api/license/formula/limit/done','INVITE_CODE_HAS_BEEN_UES','LICENSE_DISTRO_REJECTED','IConfigService','url(#on-line-icon_clip0_910_349)','mutations','VIEW_MAIN','_document','assignAColorForMemberID','SheetsSelectionsService','asObservable','DATA_SOURCE_TOO_LARGE','registerComponent','USER_NOT_INVITED_CODE','height','_applyCommand','useRef','handleInsertRangeMoveRight','ThemeService','univer-flex\x20univer-items-center','addHandlerCallback','EMAIL_VERIFY_CODE_NOT_FOUND_OR_EXPIRED','getUnit','CollaborationController','Workbook','permission.content','_status$','generateRandomId','toDisposable','EffectRefRangId','ITransformService','DocStateChangeManagerService','event$','_getSessionTicket','PENDING','_initCommandInterceptor','_onCursorUpdate','RefRangeService','data','WECHAT_HAS_BEEN_BOUND','_startDocCollabCursor','isArray','replaceState','textRanges','YUUMI_NO_CUBOID_FOR_QUESTION','_backgroundColor','_syncEditingCollabCursorService','random','startFormulaLimitUrl','labelPosition','xlink:href','1250304FaffYS','undoState','setItem','red.300','LOGIN_FAILED','_id','collabStatus.syncing','docStateChange$','translate(.97)','selection','RemoteUniscriptService','popstate','releaseFormulaLimitUrl','pushState','none','ILocalStorageService','editingUnit','attrs','startColumn','ranges','cursorInfo','application/json','_localStorageService','Vector2','dispose$','OTHER_CLIENT_EDITING','getParam','1em','m2Prime','isActive','flatMap','ENTITLE_INSUFFICIENT_QUOTA','1092528kopXWP','_config','ILocalCacheService','_instanceService','_sheetSkeletonManagerService','CommandType','roomMembers$','disposeWithMe','SessionStatus','children','exhaustSavingTask','CollaborationUIEventId','off-line-icon_clip0_910_343','dispose','...','_localeService','Tools','map','ILogService','saveOfflineData','newValue','has','addClipboardHook','addEventListener','LICENSE_IMPORT_SIZE_EXCEEDED','univer-mr-2\x20univer-flex\x20univer-text-xl','executeCommand','addObjects','getDocRanges','send','SheetSkeletonManagerService','size','cursorInfo$','UnitStatus','colorChannel1','_transformService','_transformPreviousActiveRange','14sdAEtw','_labelPosition','JOIN_ROOM_FAILED','url(#off-line-icon_clip0_910_343)','subunit','_initStatusComponent','getActiveRange','Loading','hide','_clearOtherTimers','name','split','SHEET_VIEWPORT_KEY','Optional','_clearPolling','_drawTextRange','endRow','23040990sGngNl','getCellPositionByOffset','4535576jFHKrE','debug','memberID','UniverCollaborationClientUIPlugin','Module','Failed','maxFormulaLimit','round','InsertRangeMoveDownCommandId','_collabCursorController','getUndoRedoMutationParamsCache','length','currentSkeleton$','string','_shapes','_setupSubUnitSync','getConfig','width','unshift','Disposable','[RemoteUniscriptService]:\x20no\x20focused\x20unit','currentUsage','add','Inject','_collaborationUIEventService','LOGIN_TOKEN_PROCESSING_FAILED','requireSession','makeDirty','_hover','min','registerRefRange','DocSelectionManagerService','getUniverSheetInstance','onPointerLeave$','reconnect','INVITE_CODE_ALREADY_BOUND','replaceDocRanges','formula.calculation.waiting','takeUntil','sessionStatus$','div','location','saveTaskMap','getVpScrollXYInfoByPosToVp','CollaborationSocketService','evenodd','ENTITLE_NEED_BILLING_ADDRESS','runId','_saveTaskMap','NOT_COLLAB','NodePositionConvertToCursor','BrowserCollaborationSocketService','USER_NOT_FOUND','formula.calculation.unable','setShapeProps','_docTransformSelectionsService','setInterval','override','LICENSE_MAX_MEMBERS_PER_UNIT_EXCEEDED','setParam','enableLocalCache','_handleHeartbeatEvent','isTransformMutationFailure','SYNCED','sheetId','PAYMENT_CHANNEL_NOT_SUPPORT','CONNECTOR_DATA_TOO_LARGE','FETCH_MISS','range','getViewport','createSocket','createElement','top','DeleteRangeMoveUpCommandId','_scene','887032WAbAVy','_roomMembers$','PY_RUNTIME_SCRIPT_ERROR','SetFormulaCalculationNotificationMutation','merge','mapTo','_docSyncEditingCollabCursorService','jsxs','deepClone','YUUMI_AI_RUN_FAILED','UNRECOGNIZED','show','_cursors','stringify','_initResize','formula.calculation.started','ENTITLE_CHAT_LIMIT_EXCEED','error','getOffsetConfig','getTypeOfUnitDisposed$','collabStatus.offline','init','_getFormulaLimitStatus','backgroundColor','WebBrowserSingleActiveUnitService','getAncestorScale','_refRangeService','getTypeOfUnitAdded$','APPLY_PERMISSION_DENIED','CollaborationUIEventService','_online','isTransformMutationsWithChangesetSuccess','searchParams','collabStatus.conflict','START_CALCULATION','CollaborationDataLoaderController','AWAITING','IUniverInstanceService','_docTransformStateCacheService','COLORS','drawWith','isFormulaId','DisposableCollection','throttleTime','syncEditingCollabCursor','_render','APPLY_REVISION_CONFILICT','getSheetObject','CHANGESET_REVISION_CONFILICT','executionId','getCurrentSelections','switchMap','onMouseMove','_textBubble','REDEMPTION_INVALID_CODE','lineTo','row','UniverInstanceType','search','_ensureSubject','DocIMEInputManagerService','ENSURE_SNAPSHOT_EXECUTION','_onCursorDelete','_univerInstanceService','EMAIL_VERIFY_CODE_MISMATCH','history','DocCollaborationEntity','UNIVER_SHEET','onStarting','all','runRefRangeMutations','next','collaboration-client-ui.config','green.600','REDEMPTION_USER_REDEEM_TIMES_EXCEED','getUnitId','getValue','getRangePointData','resize','_colorIndex','jsx','save','_checkCalculationAvailable','values','MUTATION','_commandService','complete','permission.title','entityInit$','RegularPolygon','arc','set','shareReplay','_httpService','_toggleOffline','_colorAssignService','ERROR_AGAIN','_docSkeletonManagerService','clipPath','MOBILE_VERIFY_CODE_MISMATCH','functionsExecutedState','Injector','_logService','M4.5865\x2011.6499C3.36983\x2011.6499\x201.6665\x2011.1024\x201.6665\x208.9124C1.6665\x206.3574\x204.2215\x205.8099\x204.9515\x205.8099C5.3165\x204.5324\x206.0465\x202.5249\x208.9665\x202.5249C11.5215\x202.5249\x2012.6165\x203.9849\x2012.9815\x205.2624C12.9815\x205.2624\x2016.2665\x205.6274\x2016.2665\x208.7299C16.2665\x2010.9199\x2014.8065\x2011.6499\x2013.3465\x2011.6499M6.7767\x2011.6497L8.9667\x2013.4747L11.8867\x209.82466','SetDocZoomRatioOperation','SetWorksheetActivateCommand','uni.network.url-service','getItem','getFocusedUnit','_unitStatus','stage','_onRefRangeChange','getOwnPropertyDescriptor','distinctUntilChanged','NodePositionConvertToRectRange','startRow','RemoveColCommandId','_maxFormulaLimit','subscribeEvent','SheetCollabCursorShape','Error','_localCacheService','handleDeleteRangeMoveUp','disposeUnit','getColor','COMPLETION_FINISHED','_handleHover','ENTITLE_UPDOWN_GRADE_NOT_SUPPORT','_releaseCalculationLimit','getStateCache','_renderManagerService','SOCKET_FAILED','getActiveSheet','_drawRectRange','transformMutationsWithChangeset','handleInsertRow','_startCalculationLimit','_scheduleClearOtherTimer','collab-text-anchor-','getLocalCacheKey','selections','unload','_send','trim','clearTimeout','_entityInit$','UNDEFINED','transformMutation','_lastResponseTimestamp','_docClipboardService','tag','[CollaborationDataLoaderController]','SOCKET_FAILED_RETRY','No\x20unitID\x20or\x20type\x20in\x20URL.\x20Will\x20not\x20load\x20files\x20from\x20remote\x20address.','combineLatest','replace','_assignedColors','handleInsertRangeMoveDown','_dataLoaderService','path','_transformUndoRedoStack','_updateURLWithCurrentState','No\x20remote\x20instance\x20service\x20injected.\x20May\x20not\x20syncing\x20edits\x20to\x20the\x20web\x20worker.','_getScale','params','_memberService','_updateCollabCursors','url(#$1','MessageType','_session','_saveCache','MOBILE_VERIFY_CODE_NOT_FOUND_OR_EXPIRED','forwardRef','_revisionService','_refreshCollabCursors','TEXT','post','_setFormulaLimitStatus','INVALID_ARGUMENT','storage','ISnapshotServerService','DependentOn','_createSocketURL','registerRenderModule','IRenderManagerService','engine','forEach','_themeService','_initEntityListener','includes','BehaviorSubject','SetFormulaCalculationStartMutation','collabStatus.synced','getCurrentUnitForType','fillStyle','debounceTime','limitInfo','beforeCommandExecuted','filter','getMember','HTTPService','unit','_currentUsage','ONLINE','2DvVjSo','YUUMI_SUBSCRIPTION_NOT_FOUND','_cursorInfo$','onCommandExecuted','loadOfflineData','Warning','CollaborationEvent','idSuffix','column','/universer-api/license/formula/limit/status','measureText','collaboration.single-unit.warning','AUTHORIZE_CODE_ILLEGAL','subscribe','_drawAnchor','redoState','IUIPartsService','_checkAndWaitForCalculationPermission','ENTITLE_CAN_NOT_BUY_LOWER_OTP','_toggleOnline','_setupBeforeClosingHandler','saveImage','INVITE_CODE_REQUIRED','_docStateChangeManagerService','handleIRemoveRow','_initStatusListener','findNodePositionByCharIndex','removeParam','getSheetId','IRemoteInstanceService','INotificationService','_disabled','INVALID_INVITE_CODE','setTimeout','REDEMPTION_CODE_NOT_STARTED','doc.mutation.rich-text-editing','text','registerDependencies','purple.300','getRenderById','type','Unknown\x20user','REDEMPTION_CODE_HAS_BEEN_CREATED','IMessageService','collab-rect-range-','_initCommandExecutedListener','YUUMI_ASYNCIO_CANCELLED','DOC_RANGE_TYPE','UNAUTHENTICATED','_getMergeRange','result','status$','_getAnchorBounding','handleDeleteRangeMoveLeft','RxDisposable','toRgbString','href','BuiltInUIPart','_unitOnClients','clsx','REDEMPTION_CODE_INACTIVE','NOT_FOUND','collabStatus.notCollab','TEXT_RANGE_LAYER_INDEX','isFormulaString','mask','IURLService','YUUMI_TABLE_NOT_FOUND_IN_UNIT','Rect','code','Shape','urlChange$','bottom','_anchorDot','toString','APPLY_REJECT','getCollabEntity$','YUUMI_URL_COL_OUT_OF_RANGE','CollaborationSessionService','_color','debounce'];_0x384d=function(){return _0x5eb61c;};return _0x384d();}Z=kt([Le(0x0,v[_0x322940(0x413)]),Le(0x1,C['IRenderManagerService'])],Z);var jt=Object[_0x322940(0x27e)],Yt=(_0x31b1b1,_0x110910,_0x3dfac3,_0x253eb4)=>{for(var _0x1f6fd9=_0x253eb4>0x1?void 0x0:_0x253eb4?jt(_0x110910,_0x3dfac3):_0x110910,_0x545b25=_0x31b1b1['length']-0x1,_0x221ed0;_0x545b25>=0x0;_0x545b25--)(_0x221ed0=_0x31b1b1[_0x545b25])&&(_0x1f6fd9=_0x221ed0(_0x1f6fd9)||_0x1f6fd9);return _0x1f6fd9;},he=(_0x4bfc40,_0x29e01f)=>(_0xee14c7,_0x2b1d5b)=>_0x29e01f(_0xee14c7,_0x2b1d5b,_0x4bfc40);let Q=class{constructor(_0x1def56,_0xf7778e,_0x1817e2){const _0x4a24bd=_0x322940;this[_0x4a24bd(0x3aa)]=_0x1def56,this[_0x4a24bd(0x1ae)]=_0xf7778e,this[_0x4a24bd(0x2f1)]=_0x1817e2;}['transformStateCache'](_0x68e5d4){const _0x15e695=_0x322940;this[_0x15e695(0x330)](_0x68e5d4);}['transformRemoteChangeset'](_0x200e1c){const _0x5291b9=_0x322940,{unitID:_0x361493}=_0x200e1c,{collaboration:_0x214212}=this[_0x5291b9(0x2f1)][_0x5291b9(0x28f)](_0x361493);if(_0x214212[_0x5291b9(0x1ce)]===0x0)return _0x200e1c;let _0x26ac66=a[_0x5291b9(0x19b)][_0x5291b9(0x216)](_0x200e1c[_0x5291b9(0x3fa)][0x0]);for(let _0x32c68b=0x0;_0x32c68b<_0x214212[_0x5291b9(0x1ce)];_0x32c68b++){const _0x2d19f8={'id':_0x5291b9(0x2fd),'params':{'unitId':_0x214212[_0x32c68b][_0x5291b9(0x336)],..._0x214212[_0x32c68b][_0x5291b9(0x2e9)]}},_0x3b0e81=this[_0x5291b9(0x1ae)][_0x5291b9(0x2a1)](_0x26ac66,_0x2d19f8,!0x1);if(v['isTransformMutationFailure'](_0x3b0e81))throw _0x3b0e81['error'];_0x26ac66=_0x3b0e81[_0x5291b9(0x382)];}return{...a[_0x5291b9(0x19b)][_0x5291b9(0x216)](_0x200e1c),'mutations':[_0x26ac66]};}[_0x322940(0x330)](_0x714ceb){const _0x2b7129=_0x322940,{unitID:_0x31add4}=_0x714ceb,{history:_0xd1fd27,collaboration:_0x373303}=this['_docStateChangeManagerService']['getStateCache'](_0x31add4);if(_0xd1fd27[_0x2b7129(0x1ce)]===0x0&&_0x373303[_0x2b7129(0x1ce)]===0x0)return;const _0x52665e=[],_0x36099d=[];let _0x121820=a[_0x2b7129(0x19b)]['deepClone'](_0x714ceb[_0x2b7129(0x3fa)][0x0]),_0x1271f5=a[_0x2b7129(0x19b)][_0x2b7129(0x216)](_0x714ceb['mutations'][0x0]);for(let _0x1e5291=_0xd1fd27[_0x2b7129(0x1ce)]-0x1;_0x1e5291>=0x0;_0x1e5291--){const _0x149176={'id':_0x2b7129(0x2fd),'params':{'unitId':_0xd1fd27[_0x1e5291][_0x2b7129(0x336)],..._0xd1fd27[_0x1e5291]['undoState']}},_0x2a81e8={'id':_0x2b7129(0x2fd),'params':{'unitId':_0xd1fd27[_0x1e5291][_0x2b7129(0x336)],..._0xd1fd27[_0x1e5291][_0x2b7129(0x2e9)]}},_0x55f026=this[_0x2b7129(0x1ae)]['transformMutation'](_0x121820,_0x149176,!0x1),_0x4b47cb=this[_0x2b7129(0x1ae)][_0x2b7129(0x2a1)](_0x1271f5,_0x2a81e8,!0x1);if(v[_0x2b7129(0x201)](_0x55f026))throw _0x55f026[_0x2b7129(0x21f)];if(v[_0x2b7129(0x201)](_0x4b47cb))throw _0x4b47cb[_0x2b7129(0x21f)];_0x52665e['unshift']({..._0xd1fd27[_0x1e5291],'undoState':_0x55f026[_0x2b7129(0x187)]['params'],'redoState':_0x4b47cb[_0x2b7129(0x187)]['params']}),_0x121820=_0x55f026[_0x2b7129(0x382)],_0x1271f5=_0x4b47cb['m1Prime'];}_0x121820=a[_0x2b7129(0x19b)]['deepClone'](_0x714ceb[_0x2b7129(0x3fa)][0x0]),_0x1271f5=a['Tools']['deepClone'](_0x714ceb['mutations'][0x0]);for(let _0x545c10=_0x373303[_0x2b7129(0x1ce)]-0x1;_0x545c10>=0x0;_0x545c10--){const _0x168787={'id':'doc.mutation.rich-text-editing','params':{'unitId':_0x373303[_0x545c10]['unitId'],..._0x373303[_0x545c10][_0x2b7129(0x16c)]}},_0x1bad63={'id':_0x2b7129(0x2fd),'params':{'unitId':_0x373303[_0x545c10][_0x2b7129(0x336)],..._0x373303[_0x545c10]['redoState']}},_0x41e85c=this[_0x2b7129(0x1ae)][_0x2b7129(0x2a1)](_0x121820,_0x168787,!0x1),_0x1a2630=this[_0x2b7129(0x1ae)][_0x2b7129(0x2a1)](_0x1271f5,_0x1bad63,!0x1);if(v[_0x2b7129(0x201)](_0x41e85c))throw _0x41e85c[_0x2b7129(0x21f)];if(v[_0x2b7129(0x201)](_0x1a2630))throw _0x1a2630[_0x2b7129(0x21f)];_0x36099d[_0x2b7129(0x1d5)]({..._0x373303[_0x545c10],'undoState':_0x41e85c[_0x2b7129(0x187)][_0x2b7129(0x2b2)],'redoState':_0x1a2630[_0x2b7129(0x187)][_0x2b7129(0x2b2)]}),_0x121820=_0x41e85c[_0x2b7129(0x382)],_0x1271f5=_0x1a2630[_0x2b7129(0x382)];}this[_0x2b7129(0x2f1)]['setStateCache'](_0x31add4,{'history':_0x52665e,'collaboration':_0x36099d});}};Q=Yt([he(0x0,a[_0x322940(0x1da)](a[_0x322940(0x273)])),he(0x1,v[_0x322940(0x413)]),he(0x2,a[_0x322940(0x1da)](T[_0x322940(0x414)]))],Q);var Ht=Object['getOwnPropertyDescriptor'],Wt=(_0x256188,_0x3bf90a,_0xa4eb15,_0x4ca3f4)=>{for(var _0x1446cb=_0x4ca3f4>0x1?void 0x0:_0x4ca3f4?Ht(_0x3bf90a,_0xa4eb15):_0x3bf90a,_0x12534f=_0x256188['length']-0x1,_0xa71913;_0x12534f>=0x0;_0x12534f--)(_0xa71913=_0x256188[_0x12534f])&&(_0x1446cb=_0xa71913(_0x1446cb)||_0x1446cb);return _0x1446cb;},Me=(_0x217737,_0x376f7c)=>(_0x2e1f85,_0x99393c)=>_0x376f7c(_0x2e1f85,_0x99393c,_0x217737);let ee=class{constructor(_0x2e4a94,_0x9409d7){const _0x4786f8=_0x322940;this[_0x4786f8(0x3aa)]=_0x2e4a94,this[_0x4786f8(0x1ae)]=_0x9409d7;}['transformSelections'](_0x214bb4){const _0x2ec6a9=_0x322940;var _0x3c3723;const _0x2dda44=this[_0x2ec6a9(0x3aa)][_0x2ec6a9(0x38c)](W[_0x2ec6a9(0x1e2)]),_0x393919=(_0x3c3723=_0x2dda44[_0x2ec6a9(0x1a7)]())!=null?_0x3c3723:[];if(_0x393919[_0x2ec6a9(0x1ce)]===0x0)return;const _0x3ca6cb=_0x214bb4[_0x2ec6a9(0x394)],_0x6a2499=[{'id':_0x2ec6a9(0x2fd),'params':{'unitId':_0x3ca6cb,'actions':null,'textRanges':_0x393919}}],_0x38f0a3=this[_0x2ec6a9(0x1ae)]['transformMutationsWithChangeset'](_0x214bb4,_0x6a2499);if(!v[_0x2ec6a9(0x22d)](_0x38f0a3))throw _0x38f0a3[_0x2ec6a9(0x21f)];const _0x374a37=_0x38f0a3[_0x2ec6a9(0x187)][0x0][_0x2ec6a9(0x2b2)][_0x2ec6a9(0x163)];Array[_0x2ec6a9(0x161)](_0x374a37)&&_0x374a37[_0x2ec6a9(0x1ce)]&&_0x2dda44[_0x2ec6a9(0x1e7)](_0x374a37,{'unitId':_0x3ca6cb,'subUnitId':_0x3ca6cb},!0x1);}};ee=Wt([Me(0x0,a['Inject'](a['Injector'])),Me(0x1,v['ITransformService'])],ee);var Vt=Object[_0x322940(0x27e)],Gt=(_0x50fab7,_0x2f0790,_0x5a7718,_0x1a5f18)=>{const _0x57441=_0x322940;for(var _0x27169b=_0x1a5f18>0x1?void 0x0:_0x1a5f18?Vt(_0x2f0790,_0x5a7718):_0x2f0790,_0x22f5d6=_0x50fab7[_0x57441(0x1ce)]-0x1,_0x3bc2ce;_0x22f5d6>=0x0;_0x22f5d6--)(_0x3bc2ce=_0x50fab7[_0x22f5d6])&&(_0x27169b=_0x3bc2ce(_0x27169b)||_0x27169b);return _0x27169b;},N=(_0x53cd3e,_0x187709)=>(_0xe6d966,_0x476f09)=>_0x187709(_0xe6d966,_0x476f09,_0x53cd3e);let te=class extends a[_0x322940(0x1d6)]{constructor(_0x4ec81f,_0x2c9d76,_0x55cade,_0x22b517,_0x5055aa,_0x337bb0,_0x455e27,_0x48fb04){const _0xa9b703=_0x322940;super(),_(this,_0xa9b703(0x40f),new I[(_0xa9b703(0x2cc))](u[_0xa9b703(0x39a)]['NOT_COLLAB'])),(this[_0xa9b703(0x2f1)]=_0x4ec81f,this[_0xa9b703(0x3c1)]=_0x2c9d76,this[_0xa9b703(0x3af)]=_0x55cade,this[_0xa9b703(0x234)]=_0x22b517,this[_0xa9b703(0x1fa)]=_0x5055aa,this[_0xa9b703(0x214)]=_0x337bb0,this[_0xa9b703(0x3ca)]=_0x455e27,this[_0xa9b703(0x19a)]=_0x48fb04,this['_initEntityListener']());}[_0x322940(0x2ca)](){const _0x42acb6=_0x322940;this[_0x42acb6(0x192)](this[_0x42acb6(0x3c1)][_0x42acb6(0x266)][_0x42acb6(0x2e7)](_0x5ed100=>{const _0x1e0083=_0x42acb6,_0x128d8a=this['_docStateChangeManagerService'][_0x1e0083(0x172)][_0x1e0083(0x2e7)](_0x5c760e=>{const _0x1bd02c=_0x1e0083;if(_0x5c760e==null)return;const {unitId:_0x4a8e25,redoState:_0x517228,commandId:_0x5178a5}=_0x5c760e;if(_0x4a8e25!==_0x5ed100[_0x1bd02c(0x394)])return;const _0x102f71={'id':_0x5178a5,'type':a[_0x1bd02c(0x190)][_0x1bd02c(0x262)],'params':{'unitId':_0x4a8e25,'actions':_0x517228[_0x1bd02c(0x350)],'textRanges':null}};_0x5ed100[_0x1bd02c(0x3ec)](_0x102f71);});if(_0x5ed100[_0x1e0083(0x192)](_0x128d8a),_0x5ed100 instanceof u[_0x1e0083(0x250)]){const _0x494d7f={'onTransformIME':_0x4e6379=>this[_0x1e0083(0x3af)][_0x1e0083(0x367)](_0x4e6379),'onTransformState':_0x8b92db=>this[_0x1e0083(0x234)][_0x1e0083(0x32b)](_0x8b92db),'onTransformSelections':_0x56ed3e=>this[_0x1e0083(0x1fa)][_0x1e0083(0x3a7)](_0x56ed3e),'onSyncEditingCollabCursor':_0x4ac2dc=>this['_docSyncEditingCollabCursorService'][_0x1e0083(0x23a)](_0x4ac2dc),'onTransformRemoteChangesetByIMECache':_0xba7017=>this[_0x1e0083(0x3af)][_0x1e0083(0x36a)](_0xba7017),'onTransformRemoteChangesetByStateCache':_0x1c6e13=>this[_0x1e0083(0x234)]['transformRemoteChangeset'](_0x1c6e13)};_0x5ed100[_0x1e0083(0x409)](_0x494d7f);}}));}};te=Gt([N(0x0,a[_0x322940(0x1da)](T[_0x322940(0x414)])),N(0x1,a[_0x322940(0x1da)](u[_0x322940(0x40c)])),N(0x2,a[_0x322940(0x1da)](Z)),N(0x3,a[_0x322940(0x1da)](Q)),N(0x4,a[_0x322940(0x1da)](ee)),N(0x5,a[_0x322940(0x1da)](Oe)),N(0x6,O['IMessageService']),N(0x7,a[_0x322940(0x1da)](a['LocaleService']))],te);var V=(_0x4bdd22=>(_0x4bdd22[_0x4bdd22[_0x322940(0x2a0)]=0x0]=_0x322940(0x2a0),_0x4bdd22[_0x4bdd22['OK']=0x1]='OK',_0x4bdd22[_0x4bdd22['INTERNAL_ERROR']=0x2]=_0x322940(0x385),_0x4bdd22[_0x4bdd22[_0x322940(0x377)]=0x3]=_0x322940(0x377),_0x4bdd22[_0x4bdd22['NOT_FOUND']=0x4]=_0x322940(0x317),_0x4bdd22[_0x4bdd22[_0x322940(0x30a)]=0x5]=_0x322940(0x30a),_0x4bdd22[_0x4bdd22[_0x322940(0x368)]=0x6]='ALREADY_EXISTS',_0x4bdd22[_0x4bdd22[_0x322940(0x2c0)]=0x7]='INVALID_ARGUMENT',_0x4bdd22[_0x4bdd22[_0x322940(0x3d5)]=0x8]=_0x322940(0x3d5),_0x4bdd22[_0x4bdd22[_0x322940(0x28b)]=0x9]='COMPLETION_FINISHED',_0x4bdd22[_0x4bdd22[_0x322940(0x16f)]=0xa]=_0x322940(0x16f),_0x4bdd22[_0x4bdd22[_0x322940(0x271)]=0xb]='MOBILE_VERIFY_CODE_MISMATCH',_0x4bdd22[_0x4bdd22[_0x322940(0x2b9)]=0xc]=_0x322940(0x2b9),_0x4bdd22[_0x4bdd22[_0x322940(0x24e)]=0xd]='EMAIL_VERIFY_CODE_MISMATCH',_0x4bdd22[_0x4bdd22[_0x322940(0x40a)]=0xe]='EMAIL_VERIFY_CODE_NOT_FOUND_OR_EXPIRED',_0x4bdd22[_0x4bdd22[_0x322940(0x2e6)]=0xf]=_0x322940(0x2e6),_0x4bdd22[_0x4bdd22[_0x322940(0x1dc)]=0x10]=_0x322940(0x1dc),_0x4bdd22[_0x4bdd22['CURRENT_STATUS_CANNOT_OPERATE']=0x64]='CURRENT_STATUS_CANNOT_OPERATE',_0x4bdd22[_0x4bdd22[_0x322940(0x26e)]=0x65]=_0x322940(0x26e),_0x4bdd22[_0x4bdd22[_0x322940(0x1f7)]=0xc9]=_0x322940(0x1f7),_0x4bdd22[_0x4bdd22[_0x322940(0x35d)]=0xca]=_0x322940(0x35d),_0x4bdd22[_0x4bdd22[_0x322940(0x23e)]=0x1389]=_0x322940(0x23e),_0x4bdd22[_0x4bdd22[_0x322940(0x383)]=0x1771]='SNAPSHOT_INVALID_SNAPSHOT',_0x4bdd22[_0x4bdd22['SNAPSHOT_HAS_BEEN_REMOVED']=0x1772]='SNAPSHOT_HAS_BEEN_REMOVED',_0x4bdd22[_0x4bdd22[_0x322940(0x24b)]=0x1773]=_0x322940(0x24b),_0x4bdd22[_0x4bdd22[_0x322940(0x325)]=0x1b59]=_0x322940(0x325),_0x4bdd22[_0x4bdd22[_0x322940(0x3bb)]=0x1b5a]=_0x322940(0x3bb),_0x4bdd22[_0x4bdd22[_0x322940(0x23c)]=0x1b5b]=_0x322940(0x23c),_0x4bdd22[_0x4bdd22[_0x322940(0x22a)]=0x1b5c]=_0x322940(0x22a),_0x4bdd22[_0x4bdd22[_0x322940(0x35c)]=0x1b5d]=_0x322940(0x35c),_0x4bdd22[_0x4bdd22[_0x322940(0x205)]=0x1f41]='CONNECTOR_DATA_TOO_LARGE',_0x4bdd22[_0x4bdd22['LICENSE_MAX_UNITS_EXCEEDED']=0x2329]='LICENSE_MAX_UNITS_EXCEEDED',_0x4bdd22[_0x4bdd22[_0x322940(0x1fd)]=0x232a]='LICENSE_MAX_MEMBERS_PER_UNIT_EXCEEDED',_0x4bdd22[_0x4bdd22[_0x322940(0x1a3)]=0x232b]=_0x322940(0x1a3),_0x4bdd22[_0x4bdd22[_0x322940(0x3bc)]=0x232c]=_0x322940(0x3bc),_0x4bdd22[_0x4bdd22[_0x322940(0x3f7)]=0x232d]=_0x322940(0x3f7),_0x4bdd22[_0x4bdd22['YUUMI_UNABLE_LOAD_URL']=0x2711]='YUUMI_UNABLE_LOAD_URL',_0x4bdd22[_0x4bdd22['YUUMI_URL_COL_OUT_OF_RANGE']=0x2712]=_0x322940(0x327),_0x4bdd22[_0x4bdd22[_0x322940(0x3eb)]=0x2713]=_0x322940(0x3eb),_0x4bdd22[_0x4bdd22[_0x322940(0x2db)]=0x2714]=_0x322940(0x2db),_0x4bdd22[_0x4bdd22[_0x322940(0x164)]=0x271a]=_0x322940(0x164),_0x4bdd22[_0x4bdd22[_0x322940(0x308)]=0x271b]='YUUMI_ASYNCIO_CANCELLED',_0x4bdd22[_0x4bdd22[_0x322940(0x31d)]=0x271c]='YUUMI_TABLE_NOT_FOUND_IN_UNIT',_0x4bdd22[_0x4bdd22[_0x322940(0x3a8)]=0x271d]='YUUMI_ALL_TABLES_IS_INVALID',_0x4bdd22[_0x4bdd22[_0x322940(0x362)]=0x271e]=_0x322940(0x362),_0x4bdd22[_0x4bdd22[_0x322940(0x217)]=0x271f]=_0x322940(0x217),_0x4bdd22[_0x4bdd22[_0x322940(0x387)]=0x2720]=_0x322940(0x387),_0x4bdd22[_0x4bdd22[_0x322940(0x210)]=0x2af9]=_0x322940(0x210),_0x4bdd22[_0x4bdd22[_0x322940(0x3f6)]=0x2ee1]=_0x322940(0x3f6),_0x4bdd22[_0x4bdd22[_0x322940(0x2fa)]=0x2ee2]='INVALID_INVITE_CODE',_0x4bdd22[_0x4bdd22['INVITE_CODE_REQUIRED']=0x2ee3]=_0x322940(0x2f0),_0x4bdd22[_0x4bdd22[_0x322940(0x402)]=0x2ee4]=_0x322940(0x402),_0x4bdd22[_0x4bdd22['INVITE_CODE_ALREADY_BOUND']=0x2ee5]=_0x322940(0x1e6),_0x4bdd22[_0x4bdd22[_0x322940(0x15f)]=0x32c9]=_0x322940(0x15f),_0x4bdd22[_0x4bdd22[_0x322940(0x3ab)]=0x32ca]=_0x322940(0x3ab),_0x4bdd22[_0x4bdd22[_0x322940(0x397)]=0x32cb]=_0x322940(0x397),_0x4bdd22[_0x4bdd22[_0x322940(0x2ec)]=0x36b1]=_0x322940(0x2ec),_0x4bdd22[_0x4bdd22[_0x322940(0x28d)]=0x36b2]=_0x322940(0x28d),_0x4bdd22[_0x4bdd22[_0x322940(0x35f)]=0x36b3]='ENTITLE_DUP_SUBSCRIPTION',_0x4bdd22[_0x4bdd22['PAYMENT_CHANNEL_NOT_SUPPORT']=0x36b4]=_0x322940(0x204),_0x4bdd22[_0x4bdd22[_0x322940(0x21e)]=0x3715]=_0x322940(0x21e),_0x4bdd22[_0x4bdd22[_0x322940(0x3e3)]=0x3716]=_0x322940(0x3e3),_0x4bdd22[_0x4bdd22[_0x322940(0x18a)]=0x3717]=_0x322940(0x18a),_0x4bdd22[_0x4bdd22[_0x322940(0x1f1)]=0x37dd]=_0x322940(0x1f1),_0x4bdd22[_0x4bdd22[_0x322940(0x244)]=0x3a99]=_0x322940(0x244),_0x4bdd22[_0x4bdd22[_0x322940(0x316)]=0x3a9a]=_0x322940(0x316),_0x4bdd22[_0x4bdd22[_0x322940(0x3ef)]=0x3a9b]=_0x322940(0x3ef),_0x4bdd22[_0x4bdd22[_0x322940(0x2fc)]=0x3a9c]='REDEMPTION_CODE_NOT_STARTED',_0x4bdd22[_0x4bdd22['REDEMPTION_USER_NOT_ELIGIBLE']=0x3a9d]='REDEMPTION_USER_NOT_ELIGIBLE',_0x4bdd22[_0x4bdd22[_0x322940(0x258)]=0x3a9e]=_0x322940(0x258),_0x4bdd22[_0x4bdd22[_0x322940(0x304)]=0x3a9f]=_0x322940(0x304),_0x4bdd22[_0x4bdd22[_0x322940(0x400)]=0x3e81]='DATA_SOURCE_TOO_LARGE',_0x4bdd22[_0x4bdd22[_0x322940(0x218)]=-0x1]=_0x322940(0x218),_0x4bdd22))(V||{});function Xt(_0x4a5aa5){const _0x11bdb9=_0x322940;var _0x37ca84,_0x4b732b;const _0x34cb65=(_0x37ca84=_0x4a5aa5[_0x11bdb9(0x3b7)])==null?void 0x0:_0x37ca84[_0x11bdb9(0x27c)],_0x3f6acb=((_0x4b732b=_0x4a5aa5[_0x11bdb9(0x3b7)])==null?void 0x0:_0x4b732b[_0x11bdb9(0x3e9)])||0x0;return _0x34cb65===x['FormulaExecuteStageType'][_0x11bdb9(0x230)]&&_0x3f6acb>0x0;}function Kt(_0x106fda){const _0x333c3f=_0x322940;return _0x106fda[_0x333c3f(0x272)]===x['FormulaExecutedStateType']['SUCCESS'];}var qt=Object[_0x322940(0x27e)],zt=(_0x34bf2e,_0x1b41e9,_0x179a6a,_0x5b2257)=>{const _0x1d33b8=_0x322940;for(var _0xb2533d=_0x5b2257>0x1?void 0x0:_0x5b2257?qt(_0x1b41e9,_0x179a6a):_0x1b41e9,_0x1209d6=_0x34bf2e[_0x1d33b8(0x1ce)]-0x1,_0x2dc848;_0x1209d6>=0x0;_0x1209d6--)(_0x2dc848=_0x34bf2e[_0x1209d6])&&(_0xb2533d=_0x2dc848(_0xb2533d)||_0xb2533d);return _0xb2533d;},L=(_0x56d84c,_0x2ccb20)=>(_0x594e5e,_0x3e640b)=>_0x2ccb20(_0x594e5e,_0x3e640b,_0x56d84c);const Jt=_0x322940(0x2e3),Zt=_0x322940(0x343),Qt=_0x322940(0x3f5);let se=class extends a[_0x322940(0x1d6)]{constructor(_0x3d69d4,_0x38540c,_0x33b2a6,_0x1d8713,_0x1935c7,_0x33330a,_0x4935ab){const _0x2e82e6=_0x322940;super(),_(this,_0x2e82e6(0x3d8),null),_(this,_0x2e82e6(0x283),0x0),_(this,_0x2e82e6(0x2d8),0x0),_(this,_0x2e82e6(0x3dd),[]),_(this,'_lastResponseTimestamp',0x0),(this[_0x2e82e6(0x3ca)]=_0x3d69d4,this['_commandService']=_0x38540c,this['_configService']=_0x33b2a6,this[_0x2e82e6(0x26b)]=_0x1d8713,this['_univerInstanceService']=_0x1935c7,this[_0x2e82e6(0x274)]=_0x33330a,this[_0x2e82e6(0x19a)]=_0x4935ab,this[_0x2e82e6(0x15b)]());}[_0x322940(0x15b)](){const _0x1a5b04=_0x322940;this[_0x1a5b04(0x192)](this['_commandService'][_0x1a5b04(0x2d3)]((_0x1e947c,_0x53b4e8)=>{const _0x5421a7=_0x1a5b04;var _0x5d5ca8;if(_0x1e947c['id']!==x[_0x5421a7(0x2cd)]['id'])return;const _0x4ccf2f=_0x1e947c['params'];if(!this[_0x5421a7(0x37b)]((_0x5d5ca8=_0x4ccf2f[_0x5421a7(0x39c)])!=null?_0x5d5ca8:[]))return;if(!this[_0x5421a7(0x260)]())throw this[_0x5421a7(0x2eb)](_0x1e947c,_0x53b4e8),this[_0x5421a7(0x3b9)](),new a['CanceledError']();})),this[_0x1a5b04(0x192)](this['_commandService'][_0x1a5b04(0x2dd)]((_0x2e74bd,_0x31143f)=>{const _0x235396=_0x1a5b04;if(_0x2e74bd['id']!==x[_0x235396(0x211)]['id'])return;const _0x9fedef=_0x2e74bd['params'];if(Xt(_0x9fedef)){const _0x54c5c6=a[_0x235396(0x410)]();this[_0x235396(0x3dd)][_0x235396(0x32d)](_0x54c5c6),this['_startCalculationLimit'](_0x54c5c6);}else{if(Kt(_0x9fedef)&&this[_0x235396(0x3dd)][_0x235396(0x1ce)]>0x0){const _0x5c1e25=this[_0x235396(0x3dd)][_0x235396(0x3a2)]();this[_0x235396(0x28e)](_0x5c1e25);}}}));}['dispose'](){const _0x2466b2=_0x322940;super[_0x2466b2(0x198)](),this[_0x2466b2(0x1be)](),this[_0x2466b2(0x3dd)]=[],this['_currentUsage']=0x0,this[_0x2466b2(0x283)]=0x0,this[_0x2466b2(0x2a2)]=0x0;}async[_0x322940(0x2eb)](_0x26fa48,_0x4f4c99){const _0xa6f156=_0x322940;for(let _0x38da1c=0x0;_0x38da1c<0x1e;_0x38da1c++)try{if(await this[_0xa6f156(0x224)](),this[_0xa6f156(0x260)]()){this[_0xa6f156(0x404)](_0x26fa48,_0x4f4c99),this['_messageService'][_0xa6f156(0x219)]({'content':this[_0xa6f156(0x19a)]['t'](_0xa6f156(0x21d)),'type':p[_0xa6f156(0x2b6)]['Success']});return;}await new Promise(_0x37ffd4=>{this['_pollingInterval']=window['setTimeout'](_0x37ffd4,0x3e8);});}catch(_0x41de4c){this[_0xa6f156(0x274)][_0xa6f156(0x21f)](_0x41de4c);}this[_0xa6f156(0x3ca)][_0xa6f156(0x219)]({'content':this['_localeService']['t'](_0xa6f156(0x1f8)),'type':p[_0xa6f156(0x2b6)][_0xa6f156(0x286)]});}[_0x322940(0x404)](_0x38e214,_0x12923c){const _0x426bb1=_0x322940;try{this['_commandService'][_0x426bb1(0x1a5)](_0x38e214['id'],_0x38e214[_0x426bb1(0x2b2)],_0x12923c);}catch(_0x13bcf3){this[_0x426bb1(0x274)][_0x426bb1(0x21f)](_0x13bcf3);}}[_0x322940(0x2bf)](_0x59e1a2,_0x317608){const _0x203793=_0x322940;_0x317608<this[_0x203793(0x2a2)]||(this[_0x203793(0x2a2)]=_0x317608,this[_0x203793(0x283)]=Number[_0x203793(0x366)](_0x59e1a2[_0x203793(0x1c9)]),this['_currentUsage']=Number[_0x203793(0x366)](_0x59e1a2[_0x203793(0x1d8)]));}async[_0x322940(0x296)](_0x4755af){const _0x2248c4=_0x322940;var _0x4f0c5f,_0x2f191a;const _0x930d0b=Date[_0x2248c4(0x348)]();try{const _0x37df4e=((_0x4f0c5f=this[_0x2248c4(0x3c0)][_0x2248c4(0x1d3)](u[_0x2248c4(0x399)]))==null?void 0x0:_0x4f0c5f[_0x2248c4(0x168)])||Zt,_0x258f7d=(await this[_0x2248c4(0x26b)]['post'](_0x37df4e,{'body':JSON[_0x2248c4(0x21b)]({'taskId':_0x4755af})}))[_0x2248c4(0x337)];if(((_0x2f191a=_0x258f7d[_0x2248c4(0x21f)])==null?void 0x0:_0x2f191a[_0x2248c4(0x31f)])!==V['OK'])return;this['_setFormulaLimitStatus'](_0x258f7d[_0x2248c4(0x2d2)],_0x930d0b);}catch(_0x183571){this[_0x2248c4(0x274)][_0x2248c4(0x21f)](_0x183571);}}async[_0x322940(0x224)](_0x64707d){const _0x5789bb=_0x322940;var _0x2438d4,_0x5d1a5d;const _0x188a85=Date[_0x5789bb(0x348)]();try{const _0x4571ad=((_0x2438d4=this[_0x5789bb(0x3c0)][_0x5789bb(0x1d3)](u[_0x5789bb(0x399)]))==null?void 0x0:_0x2438d4[_0x5789bb(0x388)])||Jt,_0x4c250a=_0x64707d?_0x4571ad+_0x5789bb(0x3b0)+encodeURIComponent(_0x64707d):_0x4571ad,_0x540135=(await this['_httpService'][_0x5789bb(0x38c)](_0x4c250a))[_0x5789bb(0x337)];if(((_0x5d1a5d=_0x540135[_0x5789bb(0x21f)])==null?void 0x0:_0x5d1a5d[_0x5789bb(0x31f)])!==V['OK'])return;this[_0x5789bb(0x2bf)](_0x540135[_0x5789bb(0x2d2)],_0x188a85);}catch(_0x4fc5f9){this[_0x5789bb(0x274)][_0x5789bb(0x21f)](_0x4fc5f9);}}async[_0x322940(0x28e)](_0x7799ec){const _0x580dae=_0x322940;var _0x1f256b,_0x343880;const _0x4f2382=Date[_0x580dae(0x348)]();try{const _0x3e52b0=((_0x1f256b=this['_configService'][_0x580dae(0x1d3)](u['COLLABORATION_CLIENT_PLUGIN_CONFIG_KEY']))==null?void 0x0:_0x1f256b[_0x580dae(0x177)])||Qt,_0x50f474=(await this['_httpService'][_0x580dae(0x2be)](_0x3e52b0,{'body':JSON[_0x580dae(0x21b)]({'taskId':_0x7799ec})}))[_0x580dae(0x337)];if(((_0x343880=_0x50f474[_0x580dae(0x21f)])==null?void 0x0:_0x343880[_0x580dae(0x31f)])!==V['OK'])return;this['_setFormulaLimitStatus'](_0x50f474['limitInfo'],_0x4f2382);}catch(_0x34ce23){this[_0x580dae(0x274)][_0x580dae(0x21f)](_0x34ce23);}}[_0x322940(0x260)](){const _0x543db4=_0x322940;return this['_maxFormulaLimit']===0x0?!0x0:this[_0x543db4(0x283)]-this[_0x543db4(0x2d8)]>0x0;}[_0x322940(0x1be)](){const _0x58506d=_0x322940;this[_0x58506d(0x3d8)]&&(clearTimeout(this[_0x58506d(0x3d8)]),this['_pollingInterval']=null);}[_0x322940(0x3b9)](){const _0x50dd7a=_0x322940;this[_0x50dd7a(0x3ca)][_0x50dd7a(0x219)]({'content':this[_0x50dd7a(0x19a)]['t'](_0x50dd7a(0x1e8)),'type':p[_0x50dd7a(0x2b6)][_0x50dd7a(0x1b7)]});}[_0x322940(0x37b)](_0x286f1c){const _0x167040=_0x322940;for(const _0x13f271 of _0x286f1c){const {unitId:_0x3c6c42,sheetId:_0x33e7f6,range:_0x47e904}=_0x13f271,_0x56bb1c=this[_0x167040(0x24d)][_0x167040(0x40b)](_0x3c6c42);if(!_0x56bb1c)continue;const _0x51fe1e=_0x56bb1c['getSheetBySheetId'](_0x33e7f6);if(!_0x51fe1e)continue;const _0x3ce269=_0x51fe1e[_0x167040(0x3a4)]();for(let _0x5a74a3=_0x47e904[_0x167040(0x281)];_0x5a74a3<=_0x47e904[_0x167040(0x1c0)];_0x5a74a3++)for(let _0x4b522c=_0x47e904[_0x167040(0x17d)];_0x4b522c<=_0x47e904[_0x167040(0x34f)];_0x4b522c++){const _0x1276b2=_0x3ce269['getValue'](_0x5a74a3,_0x4b522c);if(_0x1276b2&&(a[_0x167040(0x31a)](_0x1276b2['f'])||a[_0x167040(0x237)](_0x1276b2['si'])))return!0x0;}}return!0x1;}};se=zt([L(0x0,a['Inject'](O[_0x322940(0x305)])),L(0x1,a[_0x322940(0x338)]),L(0x2,a['IConfigService']),L(0x3,a[_0x322940(0x1da)](G[_0x322940(0x2d6)])),L(0x4,a[_0x322940(0x233)]),L(0x5,a[_0x322940(0x19d)]),L(0x6,a[_0x322940(0x1da)](a[_0x322940(0x393)]))],se);var es=Object[_0x322940(0x27e)],ts=(_0x2b3fab,_0x371115,_0x222b93,_0x11ddaf)=>{const _0x2bbf59=_0x322940;for(var _0x23c424=_0x11ddaf>0x1?void 0x0:_0x11ddaf?es(_0x371115,_0x222b93):_0x371115,_0x189be6=_0x2b3fab[_0x2bbf59(0x1ce)]-0x1,_0x36a385;_0x189be6>=0x0;_0x189be6--)(_0x36a385=_0x2b3fab[_0x189be6])&&(_0x23c424=_0x36a385(_0x23c424)||_0x23c424);return _0x23c424;},ue=(_0xdd004f,_0x1e5d3e)=>(_0x200f79,_0x1a6337)=>_0x1e5d3e(_0x200f79,_0x1a6337,_0xdd004f);let Ee=class extends a[_0x322940(0x1d6)]{constructor(_0x2d0c4f,_0xa1a8d7,_0x280711){const _0x263f2e=_0x322940;super(),_(this,_0x263f2e(0x36c),new Map()),_(this,_0x263f2e(0x1f3),new Map()),_(this,_0x263f2e(0x2f9),!0x1),(this[_0x263f2e(0x3c0)]=_0x2d0c4f,this[_0x263f2e(0x181)]=_0xa1a8d7,this['_revisionService']=_0x280711);}['disableLocalCache'](){const _0x3a768b=_0x322940;this[_0x3a768b(0x2f9)]=!0x0;}[_0x322940(0x1ff)](){const _0x3ee3b8=_0x322940;this[_0x3ee3b8(0x2f9)]=!0x1;}get[_0x322940(0x1ed)](){return this['_saveTaskMap'];}[_0x322940(0x198)](){const _0x50434b=_0x322940;this[_0x50434b(0x195)]()[_0x50434b(0x358)](()=>super['dispose']());}async[_0x322940(0x2de)](_0x1abb55){const _0x20f252=_0x322940;return this[_0x20f252(0x2f9)]?null:this[_0x20f252(0x181)][_0x20f252(0x279)](u['getLocalCacheKey'](_0x1abb55));}async[_0x322940(0x19e)](_0x29d46a,_0x55a96a){const _0x346dd1=_0x322940;return!!this[_0x346dd1(0x181)][_0x346dd1(0x16d)](_0x29d46a,_0x55a96a);}[_0x322940(0x3c4)](_0x47e7d5,_0xcee02c,_0xcefb53,_0x8046a7){const _0x3e9bfa=_0x322940,_0x232355=this[_0x3e9bfa(0x2bb)]['getCurrentRevOfUnit'](_0x47e7d5);this['_cachedData'][_0x3e9bfa(0x269)](_0x47e7d5,{'unitID':_0x47e7d5,'type':_0xcee02c,'awaitingChangeset':_0xcefb53,'mutations':_0x8046a7,'rev':_0x232355}),this[_0x3e9bfa(0x1f3)]['has'](_0x47e7d5)||this[_0x3e9bfa(0x3be)](_0x47e7d5);}[_0x322940(0x3be)](_0x11f8fd){const _0x28ad92=_0x322940,_0x433a82=this['_getSaveTimeout']();_0x433a82===0x0?this[_0x28ad92(0x2b8)](_0x11f8fd):this['_saveTaskMap'][_0x28ad92(0x269)](_0x11f8fd,setTimeout(()=>this[_0x28ad92(0x2b8)](_0x11f8fd),_0x433a82));}['_getSaveTimeout'](){var _0x44c8c8;return(_0x44c8c8=this['_configService']['getConfig'](u['LOCAL_CACHE_INTERVAL_KEY']))!=null?_0x44c8c8:u['LOCAL_CACHE_INTERVAL'];}[_0x322940(0x2b8)](_0x5f0852){const _0x1376fe=_0x322940,_0x20037c=this[_0x1376fe(0x1f3)][_0x1376fe(0x38c)](_0x5f0852);return _0x20037c!==void 0x0&&window['clearTimeout'](_0x20037c),this[_0x1376fe(0x181)][_0x1376fe(0x16d)](u[_0x1376fe(0x299)](_0x5f0852),this['_cachedData'][_0x1376fe(0x38c)](_0x5f0852))[_0x1376fe(0x358)](()=>this[_0x1376fe(0x1f3)]['delete'](_0x5f0852));}async[_0x322940(0x195)](){const _0x51b378=_0x322940,_0x4a54e1=[];this[_0x51b378(0x1f3)]['forEach']((_0x500745,_0x1a27cb)=>{const _0x519fa0=_0x51b378;window['clearTimeout'](_0x500745),_0x4a54e1[_0x519fa0(0x32d)](this['_saveCache'](_0x1a27cb)['then'](()=>{const _0x30cc41=_0x519fa0;this[_0x30cc41(0x1f3)][_0x30cc41(0x3b4)](_0x1a27cb);}));}),await Promise[_0x51b378(0x253)](_0x4a54e1);}};Ee=ts([ue(0x0,a['IConfigService']),ue(0x1,a[_0x322940(0x17a)]),ue(0x2,a[_0x322940(0x1da)](v[_0x322940(0x375)]))],Ee);class Fe extends a[_0x322940(0x310)]{constructor(){const _0x1ac49a=_0x322940;super(),_(this,_0x1ac49a(0x321)),this[_0x1ac49a(0x321)]=I['fromEvent'](window,_0x1ac49a(0x176))['pipe'](I[_0x1ac49a(0x1e9)](this['dispose$']),I[_0x1ac49a(0x26a)](0x1),I[_0x1ac49a(0x213)](void 0x0));}['setParam'](_0x44bbbc,_0x2b51d7,_0x2e7629=!0x1){const _0x19eaa0=_0x322940,_0x87af84=new URL(window[_0x19eaa0(0x1ec)][_0x19eaa0(0x312)]);_0x87af84[_0x19eaa0(0x22e)][_0x19eaa0(0x269)](_0x44bbbc,_0x2b51d7),_0x2e7629?window['history']['replaceState']('','',_0x87af84[_0x19eaa0(0x324)]()):window[_0x19eaa0(0x24f)][_0x19eaa0(0x178)]('','',_0x87af84[_0x19eaa0(0x324)]());}[_0x322940(0x2f5)](_0x1b7179,_0x3cb1d5=!0x1){const _0x4df9be=_0x322940,_0x31bff1=new URL(window[_0x4df9be(0x1ec)][_0x4df9be(0x312)]);_0x31bff1[_0x4df9be(0x22e)][_0x4df9be(0x3b4)](_0x1b7179),_0x3cb1d5?window[_0x4df9be(0x24f)][_0x4df9be(0x162)]('','',_0x31bff1[_0x4df9be(0x324)]()):window[_0x4df9be(0x24f)]['pushState']('','',_0x31bff1['toString']());}[_0x322940(0x185)](_0x1f4702){const _0x4a01b5=_0x322940;var _0x47544c;return(_0x47544c=new URL(window['location']['href'])['searchParams'][_0x4a01b5(0x38c)](_0x1f4702))!=null?_0x47544c:void 0x0;}}var ss=Object['defineProperty'],is=Object[_0x322940(0x27e)],ns=(_0x3b4a15,_0x43f8e9,_0x44eabc)=>_0x43f8e9 in _0x3b4a15?ss(_0x3b4a15,_0x43f8e9,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0x44eabc}):_0x3b4a15[_0x43f8e9]=_0x44eabc,rs=(_0x57cef7,_0x538eae,_0x16333f,_0x26f9e2)=>{for(var _0x503b38=_0x26f9e2>0x1?void 0x0:_0x26f9e2?is(_0x538eae,_0x16333f):_0x538eae,_0x72c881=_0x57cef7['length']-0x1,_0x36eda2;_0x72c881>=0x0;_0x72c881--)(_0x36eda2=_0x57cef7[_0x72c881])&&(_0x503b38=_0x36eda2(_0x503b38)||_0x503b38);return _0x503b38;},Ie=(_0x461b97,_0x2cddbc)=>(_0x163d5e,_0x36d982)=>_0x2cddbc(_0x163d5e,_0x36d982,_0x461b97),os=(_0x41d71d,_0x5b098d,_0x46df01)=>ns(_0x41d71d,_0x5b098d+'',_0x46df01);const as=_0x322940(0x3a6);exports['UniverCollaborationClientUIPlugin']=class extends a[_0x322940(0x35a)]{constructor(_0x1fa900=Ue,_0x841a0,_0x5a3f1b,_0x2aa93a){const _0x2aeb6e=_0x322940;super(),this['_config']=_0x1fa900,this[_0x2aeb6e(0x290)]=_0x841a0,this[_0x2aeb6e(0x3aa)]=_0x5a3f1b,this[_0x2aeb6e(0x3c0)]=_0x2aa93a;const {..._0x32f629}=a[_0x2aeb6e(0x212)]({},Ue,this['_config']);this[_0x2aeb6e(0x3c0)]['setConfig'](Bt,_0x32f629);}[_0x322940(0x252)](){const _0x41e5ab=_0x322940;this[_0x41e5ab(0x35b)](),this['_initDependencies']();}[_0x322940(0x370)](){const _0x357a5b=_0x322940;this[_0x357a5b(0x3c5)]();}[_0x322940(0x35b)](){const _0x4e92f0=_0x322940;var _0x5e3953;const _0x385de5=[[pe],[se],[ee],[Z],[Q],[Oe],[Te,{'useClass':Fe}],[G[_0x4e92f0(0x3b3)],{'useClass':G['WebSocketService']}],[u[_0x4e92f0(0x18d)],{'useClass':Ee}],[exports[_0x4e92f0(0x355)]],[te],[J],[B],[de],[exports[_0x4e92f0(0x231)]]];a[_0x4e92f0(0x2ff)](this[_0x4e92f0(0x3aa)],a['mergeOverrideWithDependencies'](_0x385de5,(_0x5e3953=this[_0x4e92f0(0x18c)])==null?void 0x0:_0x5e3953[_0x4e92f0(0x1fc)]));}[_0x322940(0x3c5)](){const _0xa8a92e=_0x322940;this['disposeWithMe'](this[_0xa8a92e(0x290)][_0xa8a92e(0x2c5)](a[_0xa8a92e(0x247)][_0xa8a92e(0x3f4)],[ge])),this['disposeWithMe'](this[_0xa8a92e(0x290)][_0xa8a92e(0x2c5)](a[_0xa8a92e(0x247)]['UNIVER_SHEET'],[ve]));}[_0x322940(0x380)](){const _0x11294d=_0x322940;a[_0x11294d(0x374)](this[_0x11294d(0x3aa)],[[B],[exports[_0x11294d(0x355)]],[te],[J],[exports[_0x11294d(0x231)]],[se]]);}},os(exports['UniverCollaborationClientUIPlugin'],_0x322940(0x341),as),exports[_0x322940(0x1c6)]=rs([a[_0x322940(0x2c3)](u['UniverCollaborationClientPlugin']),Ie(0x1,C[_0x322940(0x2c6)]),Ie(0x2,a[_0x322940(0x1da)](a[_0x322940(0x273)])),Ie(0x3,a[_0x322940(0x3f8)])],exports['UniverCollaborationClientUIPlugin']);var cs=Object[_0x322940(0x27e)],ls=(_0xbe1b12,_0x243a5a,_0x174d8e,_0x5ed6c7)=>{for(var _0x1e56f1=_0x5ed6c7>0x1?void 0x0:_0x5ed6c7?cs(_0x243a5a,_0x174d8e):_0x243a5a,_0x19ad1f=_0xbe1b12['length']-0x1,_0x4afcbb;_0x19ad1f>=0x0;_0x19ad1f--)(_0x4afcbb=_0xbe1b12[_0x19ad1f])&&(_0x1e56f1=_0x4afcbb(_0x1e56f1)||_0x1e56f1);return _0x1e56f1;},H=(_0x36e328,_0x3ce872)=>(_0x22e636,_0x504311)=>_0x3ce872(_0x22e636,_0x504311,_0x36e328);exports['BrowserCollaborationSocketService']=class extends u[_0x322940(0x1ef)]{constructor(_0x482918,_0x1da4b6,_0x44d584,_0x2d7a45,_0x1d388d){super(_0x482918,_0x1da4b6,_0x44d584,_0x2d7a45,_0x1d388d);}async[_0x322940(0x209)](_0x21e413){const _0x59c998=_0x322940,_0x6bce8f=await this[_0x59c998(0x159)](),_0xfc7cc5=this['_createSocketURL'](_0x21e413,_0x6bce8f);return this[_0x59c998(0x349)](_0xfc7cc5);}[_0x322940(0x2c4)](_0x346173,_0xff8273){const _0xfa4c6c=_0x322940,_0x25308d=typeof window>'u'?new URL(_0x346173):new URL(_0x346173,window[_0xfa4c6c(0x1ec)]['origin']);_0x25308d[_0xfa4c6c(0x22e)][_0xfa4c6c(0x269)](_0xfa4c6c(0x39e),_0xff8273);const _0x2e437e=typeof window>'u'?new URLSearchParams():new URLSearchParams(window[_0xfa4c6c(0x1ec)][_0xfa4c6c(0x248)]);return _0x2e437e['get'](_0xfa4c6c(0x1f2))&&_0x25308d[_0xfa4c6c(0x22e)][_0xfa4c6c(0x269)](_0xfa4c6c(0x1f2),_0x2e437e['get'](_0xfa4c6c(0x1f2))),_0x25308d['toString']();}async[_0x322940(0x159)](){const _0x10fc6f=_0x322940;var _0x506a67,_0x273a87,_0x146995;const _0x10f63f=this[_0x10fc6f(0x3c0)][_0x10fc6f(0x1d3)](u[_0x10fc6f(0x399)]),_0x33890d=(_0x506a67=_0x10f63f==null?void 0x0:_0x10f63f['wsSessionTicketUrl'])!=null?_0x506a67:u[_0x10fc6f(0x3b8)];return(_0x146995=(_0x273a87=(await this[_0x10fc6f(0x26b)][_0x10fc6f(0x38c)](_0x33890d,{'headers':{'Content-Type':_0x10fc6f(0x180)}}))[_0x10fc6f(0x337)])==null?void 0x0:_0x273a87['ticket'])!=null?_0x146995:'';}},exports['BrowserCollaborationSocketService']=ls([H(0x0,a[_0x322940(0x1da)](a[_0x322940(0x273)])),H(0x1,a[_0x322940(0x1da)](G[_0x322940(0x2d6)])),H(0x2,a['IConfigService']),H(0x3,a[_0x322940(0x19d)]),H(0x4,v[_0x322940(0x2c2)])],exports[_0x322940(0x1f6)]);var _s=Object[_0x322940(0x27e)],hs=(_0xab4771,_0x50efa5,_0x1f77e2,_0xa5d746)=>{const _0x4f0085=_0x322940;for(var _0x16941a=_0xa5d746>0x1?void 0x0:_0xa5d746?_s(_0x50efa5,_0x1f77e2):_0x50efa5,_0x339be0=_0xab4771[_0x4f0085(0x1ce)]-0x1,_0x115b7f;_0x339be0>=0x0;_0x339be0--)(_0x115b7f=_0xab4771[_0x339be0])&&(_0x16941a=_0x115b7f(_0x16941a)||_0x16941a);return _0x16941a;},Se=(_0x2a06ba,_0x3322ce)=>(_0x7608c6,_0x5ced30)=>_0x3322ce(_0x7608c6,_0x5ced30,_0x2a06ba);exports[_0x322940(0x175)]=class extends a[_0x322940(0x1d6)]{constructor(_0x51ae44,_0x2dc852,_0x7eec3d){const _0x131659=_0x322940;super(),this[_0x131659(0x18e)]=_0x51ae44,this['_httpService']=_0x2dc852,this['_configService']=_0x7eec3d;}async['runOnServer'](_0x3e9f5b,_0xd90a6,_0x4de2c4,..._0x3e8d13){const _0x4c842e=_0x322940;var _0x5761ef,_0x2ca118,_0x68f37d,_0x1c37db;const _0x495f30=this[_0x4c842e(0x18e)][_0x4c842e(0x27a)]();if(!_0x495f30)throw new Error(_0x4c842e(0x1d7));const _0x44b375=((_0x5761ef=this[_0x4c842e(0x3c0)][_0x4c842e(0x1d3)](u[_0x4c842e(0x364)]))!=null?_0x5761ef:u[_0x4c842e(0x33f)])+'/'+_0x3e9f5b+'/run/'+_0xd90a6,_0xe50e30=new URL(window[_0x4c842e(0x1ec)]['href']),_0x74899c={'scriptId':_0x3e9f5b,'runId':(_0x2ca118=_0xe50e30['searchParams']['get'](_0x4c842e(0x1f2)))!=null?_0x2ca118:'','function':_0xd90a6,'unitId':_0x495f30['getUnitId'](),'argsOfFunction':JSON[_0x4c842e(0x21b)](_0x3e8d13),'invokeId':(_0x68f37d=_0x4de2c4['invokeId'])!=null?_0x68f37d:'','executionId':(_0x1c37db=_0x4de2c4[_0x4c842e(0x23f)])!=null?_0x1c37db:''};try{const _0x3b6169=await this[_0x4c842e(0x26b)]['post'](_0x44b375,{'body':_0x74899c});return _0x3b6169[_0x4c842e(0x337)][_0x4c842e(0x21f)]&&_0x3b6169[_0x4c842e(0x337)]['error'][_0x4c842e(0x31f)]!==V['OK']?_0x4c842e(0x1c8):_0x3b6169[_0x4c842e(0x337)][_0x4c842e(0x30c)];}catch{return'Failed';}}},exports['RemoteUniscriptService']=hs([Se(0x0,a[_0x322940(0x233)]),Se(0x1,a[_0x322940(0x1da)](G['HTTPService'])),Se(0x2,a[_0x322940(0x3f8)])],exports[_0x322940(0x175)]);const Ae=0x7530,Pe=_0x322940(0x3e1);class us extends a['Disposable']{constructor(){const _0x11163e=_0x322940;super(),_(this,'_id',a[_0x11163e(0x410)]()),_(this,_0x11163e(0x3d9),new Set()),_(this,_0x11163e(0x314),new Map()),_(this,_0x11163e(0x3e0),null),_(this,_0x11163e(0x1b9),new Map()),_(this,_0x11163e(0x27b),new Map()),this[_0x11163e(0x3a3)]();}['dispose'](){const _0x3971f7=_0x322940;super[_0x3971f7(0x198)](),this[_0x3971f7(0x1b9)]['forEach']((_0x2082ba,_0x42d785)=>this[_0x3971f7(0x360)](_0x42d785)),this[_0x3971f7(0x3e0)]&&window['clearInterval'](this['_heartbeatTimer']);}['getUnitStatus$'](_0x57b1c1){const _0x4e0c2f=_0x322940;return this['_ensureSubject'](_0x57b1c1)[_0x4e0c2f(0x396)](I[_0x4e0c2f(0x27f)]());}[_0x322940(0x17b)](_0x40ec01){const _0xe72976=_0x322940;this[_0xe72976(0x3d9)]['size']===0x0&&this['_scheduleHeartbeat'](),this[_0xe72976(0x3d9)]['add'](_0x40ec01),this[_0xe72976(0x29c)]({'type':0x0,'memberID':this[_0xe72976(0x170)],'unitIDs':[_0x40ec01],'isForwarded':!0x1});}[_0x322940(0x289)](_0x4425a1){const _0x112232=_0x322940;this['_selfUnitIDs'][_0x112232(0x3b4)](_0x4425a1),this[_0x112232(0x3d9)][_0x112232(0x1aa)]===0x0&&this[_0x112232(0x3e0)]&&window[_0x112232(0x32f)](this[_0x112232(0x3e0)]);}['_init'](){const _0x34bfcc=_0x322940;this[_0x34bfcc(0x192)](a[_0x34bfcc(0x411)](I['fromEvent'](window,_0x34bfcc(0x2c1))[_0x34bfcc(0x2e7)](_0x1b7ffc=>{const _0x5f1576=_0x34bfcc;if(_0x1b7ffc['key']!==Pe||!_0x1b7ffc[_0x5f1576(0x19f)])return;const _0x5552f3=JSON['parse'](_0x1b7ffc[_0x5f1576(0x19f)]);this[_0x5f1576(0x3e6)](_0x5552f3);}))),window[_0x34bfcc(0x1a2)](_0x34bfcc(0x29b),()=>this[_0x34bfcc(0x29c)]({'type':0x1,'memberID':this[_0x34bfcc(0x170)],'unitIDs':Array[_0x34bfcc(0x37e)](this['_selfUnitIDs'])}));}[_0x322940(0x3e6)](_0x55be36){const _0x4fecab=_0x322940;switch(_0x55be36[_0x4fecab(0x302)]){case 0x0:this[_0x4fecab(0x3ba)](_0x55be36);break;case 0x1:this[_0x4fecab(0x331)](_0x55be36);break;case 0x2:this['_handleHeartbeatEvent'](_0x55be36);break;}}['_handleJoinEvent'](_0x254dae){const _0x1bb1a6=_0x322940,{unitIDs:_0x210171,memberID:_0x2a850c,isForwarded:_0x2f5b7c}=_0x254dae;_0x210171[_0x1bb1a6(0x2c8)](_0x4313f7=>{const _0x1366ed=_0x1bb1a6;if(!_0x2f5b7c&&this[_0x1366ed(0x314)]['has'](_0x4313f7)&&this[_0x1366ed(0x249)](_0x4313f7)[_0x1366ed(0x255)](u[_0x1366ed(0x1ac)][_0x1366ed(0x34e)]),!this[_0x1366ed(0x314)][_0x1366ed(0x1a0)](_0x4313f7)||!this[_0x1366ed(0x314)]['get'](_0x4313f7)['has'](_0x2a850c)){const _0x108707=this[_0x1366ed(0x314)][_0x1366ed(0x38c)](_0x4313f7)||new Set();_0x108707['add'](_0x2a850c),this[_0x1366ed(0x314)]['set'](_0x4313f7,_0x108707),this[_0x1366ed(0x297)](_0x2a850c);}}),_0x2f5b7c||this[_0x1bb1a6(0x29c)]({'type':0x0,'memberID':this[_0x1bb1a6(0x170)],'unitIDs':[...this[_0x1bb1a6(0x3d9)]],'isForwarded':!0x0});}[_0x322940(0x297)](_0x34def9){const _0x1a2e75=_0x322940;this['_removeClearOtherTimer'](_0x34def9);const _0x595be0=window[_0x1a2e75(0x2fb)](()=>{const _0x584da3=_0x1a2e75;this[_0x584da3(0x314)][_0x584da3(0x2c8)](_0x1d03c7=>{_0x1d03c7['delete'](_0x34def9);});},Ae*0x2);this[_0x1a2e75(0x1b9)][_0x1a2e75(0x269)](_0x34def9,_0x595be0);}[_0x322940(0x360)](_0x452fb6){const _0x87f0b7=_0x322940;if(this[_0x87f0b7(0x1b9)][_0x87f0b7(0x1a0)](_0x452fb6)){const _0x49475f=this[_0x87f0b7(0x1b9)][_0x87f0b7(0x38c)](_0x452fb6);_0x49475f&&window[_0x87f0b7(0x29e)](_0x49475f),this[_0x87f0b7(0x1b9)][_0x87f0b7(0x269)](_0x452fb6,null);}}[_0x322940(0x331)](_0x4498c9){const {memberID:_0x5df362,unitIDs:_0x3be5fd}=_0x4498c9;_0x3be5fd['forEach'](_0x456fc5=>{const _0x4c8d53=_0x2b7c;var _0x3b471e;const _0x506f3d=this['_unitOnClients']['get'](_0x456fc5);_0x506f3d&&(_0x506f3d['delete'](_0x5df362),(_0x3b471e=this[_0x4c8d53(0x249)](_0x456fc5))==null||_0x3b471e[_0x4c8d53(0x255)](_0x506f3d[_0x4c8d53(0x1aa)]===0x0?u['UnitStatus'][_0x4c8d53(0x3ee)]:u[_0x4c8d53(0x1ac)][_0x4c8d53(0x34e)]));}),this['_removeClearOtherTimer'](_0x5df362);}[_0x322940(0x200)](_0x199429){const _0x37c313=_0x322940;this[_0x37c313(0x297)](_0x199429[_0x37c313(0x1c5)]);}[_0x322940(0x29c)](_0x336a7e){const _0x4572ab=_0x322940;localStorage[_0x4572ab(0x16d)](Pe,JSON[_0x4572ab(0x21b)](_0x336a7e));}['_scheduleHeartbeat'](){const _0x19d9f5=_0x322940;this[_0x19d9f5(0x3e0)]=window[_0x19d9f5(0x1fb)](()=>{this['_send']({'type':0x2,'memberID':this['_id']});},Ae);}[_0x322940(0x249)](_0xd3ee77){const _0x3083fd=_0x322940;return this[_0x3083fd(0x27b)][_0x3083fd(0x1a0)](_0xd3ee77)||this[_0x3083fd(0x27b)][_0x3083fd(0x269)](_0xd3ee77,new I[(_0x3083fd(0x2cc))](u[_0x3083fd(0x1ac)][_0x3083fd(0x3ee)])),this['_unitStatus'][_0x3083fd(0x38c)](_0xd3ee77);}}exports[_0x322940(0x31c)]=Te,exports[_0x322940(0x285)]=Be,exports[_0x322940(0x226)]=us,exports[_0x322940(0x347)]=Fe;