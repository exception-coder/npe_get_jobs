function _0x1723(){const _0x2066ae=['UniverSheetsUIPlugin','BehaviorSubject','@univerjs/engine-render','_disposableCollection','getSheetCommandTarget','next','WorkbookEditablePermission','IConfigService','@univerjs/sheets-formula','exhaustSavingTask','appendChild','svg','_localeService','@univerjs-pro/sheets-sparkline','getOwnPropertyDescriptor','length','Plugin','AuthzIoHttpService','@univerjs/sheets-data-validation','UniverLicensePlugin','@univerjs/sheets-data-validation-ui','none','UniverNetworkPlugin','attrs','UniverRenderEnginePlugin','fill','_historyUniver$','triggerLoadVersions','SYNCED','@univerjs/ui','string','values','_pluginMap','@univerjs/drawing','CollaborationController','UniverDocs','getCurrentLocale','darkMode$','data','UniverUIPlugin','_init','disposeWithMe','UniverEngineRender','UniverProLicense','revertRevision$','setConfig','_checkCanRevert','UniverSheetsConditionalFormattingUIPlugin','registerPlugin','UniverSheetSparklinePlugin','@univerjs/sheets-filter','path','currentTheme$','getCurrentRangeDisable$','@univerjs-pro/sheets-sparkline-ui','has','UniverSheetsDataValidationUIPlugin','UniverNetwork','from','6kHTJhu','UniverProSheetsPivot','add','ThemeService','editHistory.panel.revertFailed','UniverSheetsDrawingPlugin','_localCacheService','location','onSteady','getLocales','defs','clipPath','trim','height','784182HNYbMi','ComponentManager','Inject','univer-history-container','@univerjs/network','ICommandService','subscribe','_initListener','getMenuHiddenObservable','_messageService','UniverSheetsFilterUi','_sidebarService','CollaborationEvent','includes','UniverSheetsDataValidation','Disposable','createElement','UniverProEditHistoryViewer','UniverDataValidationPlugin','0\x200\x2016\x2016','UniverSheetsNumfmtPlugin','object','_revertErrorTimer','1em','eventID','UniverProSheetsSparkline','HistoryManagerService','@univerjs/sheets-hyper-link','@univerjs/design','show','HistoryIcon','editHistory.panel.listFetchError','_config','UniverUi','UniverSheetsFormula','ILocalCacheService','OPERATION','random','UniverSheetsDrawingUIPlugin','set','@univerjs-pro/collaboration','xlink:href','HistoryModeStatus','permissionId','mask','status$','UniverSheetsHyperLink','defIds','_initContainer','UniverSheets','mergeMenu','colorChannel1','UniverSheetsConditionalFormatting','_configService','UniverInstanceType','1LfoyLX','_menuManagerService','218617iSutFX','@univerjs/sheets-conditional-formatting-ui','getUnit','IMessageService','dataset','@univerjs/sheets-hyper-link-ui','assign','display','clear','RevertRevisionMutation','history-container','dispose','menu','url(#$1','_permissionService','UNIVER_SHEET','event$','IPermissionService','./worker.js','history-icon','setDarkMode','tag','IDialogService','absolute','children','getConfig','UniverRpc','close','invoke','edit-history-loader.config','_initUniver','UniverSheetsPivotTablePlugin','current','@univerjs-pro/license','UniverSheetsHyperLinkPlugin','2933300jQHcBc','pluginName','DisposableCollection','_historyManagerService','IAuthzIoService','Exited','_commandService','Loading','_themeService','UniverProSheetsSparklineUi','currentColor','react','map','React','@univerjs/data-validation','forEach','UniverSheetsPlugin','@univerjs-pro/sheets-pivot','UniverSheetsDataValidationUi','155erUgmN','MenuItemType','toString','every','flat','closeAll','merge','@univerjs/engine-formula','CommandType','toDisposable','UniverEngineFormula','2956UPGlTu','value','some','function','style','M4.45388\x204.14989H3.52896C4.61144\x202.8939\x206.21319\x202.0999\x207.9999\x202.0999C11.2584\x202.0999\x2013.8999\x204.74142\x2013.8999\x207.9999C13.8999\x2011.2584\x2011.2584\x2013.8999\x207.9999\x2013.8999C4.74142\x2013.8999\x202.0999\x2011.2584\x202.0999\x207.9999C2.0999\x207.66853\x201.83127\x207.3999\x201.4999\x207.3999C1.16853\x207.3999\x200.899902\x207.66853\x200.899902\x207.9999C0.899902\x2011.9211\x204.07868\x2015.0999\x207.9999\x2015.0999C11.9211\x2015.0999\x2015.0999\x2011.9211\x2015.0999\x207.9999C15.0999\x204.07868\x2011.9211\x200.899902\x207.9999\x200.899902C5.88709\x200.899902\x203.9903\x201.82298\x202.69023\x203.28636V2.38625C2.69023\x202.05488\x202.42161\x201.78625\x202.09023\x201.78625C1.75886\x201.78625\x201.49023\x202.05488\x201.49023\x202.38625V4.74989C1.49023\x205.08126\x201.75886\x205.34989\x202.09023\x205.34989H4.45388C4.78525\x205.34989\x205.05388\x205.08126\x205.05388\x204.74989C5.05388\x204.41851\x204.78525\x204.14989\x204.45388\x204.14989Z','div','@univerjs/docs','Univer','UniverIcon','UniverSheetsFilter','ISidebarService','_componentManager','substring','@univerjs/drawing-ui','1000','status','UniverSheetsDrawingUi','@univerjs/sheets-conditional-formatting','_initPlugins','unMountHistoryContent','mutations','replace','909369xJFccl','LS_CONFIG_KEY','_injector','__getInjector','univer.operation.toggle-edit-history','UNIVER_HISTORY_CONTAINER_ID','getSheets','COLLABORATION_CLIENT_PLUGIN_CONFIG_KEY','editHistory.panel.title','@univerjs-pro/collaboration-client','UniverDrawingUi','univerjs-icon\x20univerjs-icon-','onCommandExecuted','UNIVER_CONTAINER_ID_KEY','historyListServerUrl','entries','getSubunitRuleList','http://www.w3.org/2000/svg','_dialogService','getAllPlugins','url(#history-icon_clip0_907_281)','_collaborationController','historyUniver','2114656bRZxky','rxjs','UniverCore','UniverDrawingUIPlugin','unsubscribe','Entered','@univerjs/sheets-ui','executeCommand','RxDisposable','UNIVER_EDIT_HISTORY_LOADER_PLUGIN','UNIVER_CONTAINER_ID','@univerjs/sheets','composePermission','UniverSheetsFilterUIPlugin','UniverDrawingPlugin','idSuffix','MessageType','width','Error','UniverDocsUi','WorksheetEditPermission','UniverCollaborationPlugin','LocaleService','IImageIoService','displayName','38304SBaTzD','UniverEditHistoryLoaderPlugin','editHistory.panel.reverting','WorkbookViewHistoryPermission','session','UniverSheetsConditionalFormattingPlugin','UniverSheetsDrawing','M8.28291\x205.16293C8.28295\x204.83156\x208.01435\x204.5629\x207.68298\x204.56287C7.35161\x204.56283\x207.08295\x204.83143\x207.08291\x205.1628L7.08252\x208.63494C7.0825\x208.79881\x207.1495\x208.95555\x207.26796\x209.06877L9.70073\x2011.3939C9.94029\x2011.6228\x2010.3201\x2011.6142\x2010.549\x2011.3747C10.778\x2011.1351\x2010.7694\x2010.7553\x2010.5298\x2010.5263L8.28255\x208.37852L8.28291\x205.16293Z','\x20has\x20been\x20registered.','RangeProtectionRuleModel','HistoryLoaderService','@univerjs/docs-ui','M0\x200H16V16H0z','univerContainerId','get','combineLatest','@univerjs/sheets-drawing-ui','100%','UniverSheetsDataValidationPlugin','setTheme','IUniverInstanceService','getElementById'];_0x1723=function(){return _0x2066ae;};return _0x1723();}function _0x3795(_0x4f0d79,_0x998248){const _0x1723d6=_0x1723();return _0x3795=function(_0x37958a,_0x6f3d2d){_0x37958a=_0x37958a-0xf5;let _0x3100f6=_0x1723d6[_0x37958a];return _0x3100f6;},_0x3795(_0x4f0d79,_0x998248);}(function(_0x216beb,_0x5b5038){const _0x2acd91=_0x3795,_0x17ca84=_0x216beb();while(!![]){try{const _0x5e4364=parseInt(_0x2acd91(0x1c9))/0x1*(parseInt(_0x2acd91(0x133))/0x2)+parseInt(_0x2acd91(0x192))/0x3+parseInt(_0x2acd91(0x20c))/0x4*(parseInt(_0x2acd91(0x201))/0x5)+-parseInt(_0x2acd91(0x184))/0x6*(parseInt(_0x2acd91(0x1cb))/0x7)+-parseInt(_0x2acd91(0x11a))/0x8+-parseInt(_0x2acd91(0x103))/0x9+parseInt(_0x2acd91(0x1ee))/0xa;if(_0x5e4364===_0x5b5038)break;else _0x17ca84['push'](_0x17ca84['shift']());}catch(_0x5b3f97){_0x17ca84['push'](_0x17ca84['shift']());}}}(_0x1723,0x30df5),function(_0x40d2f5,_0xcae3cd){const _0x168e6d=_0x3795;typeof exports==_0x168e6d(0x1a7)&&typeof module<'u'?_0xcae3cd(exports,require('@univerjs/core'),require('@univerjs-pro/collaboration'),require('@univerjs-pro/collaboration-client'),require('@univerjs/design'),require('react'),require('@univerjs/ui'),require('rxjs'),require('@univerjs/sheets'),require('@univerjs-pro/edit-history-viewer'),require('@univerjs-pro/license'),require('@univerjs-pro/sheets-pivot'),require('@univerjs-pro/sheets-sparkline'),require('@univerjs-pro/sheets-sparkline-ui'),require('@univerjs/data-validation'),require('@univerjs/docs'),require('@univerjs/docs-ui'),require('@univerjs/drawing'),require('@univerjs/drawing-ui'),require('@univerjs/engine-formula'),require('@univerjs/engine-render'),require('@univerjs/network'),require('@univerjs/rpc'),require('@univerjs/sheets-conditional-formatting'),require('@univerjs/sheets-conditional-formatting-ui'),require('@univerjs/sheets-data-validation'),require('@univerjs/sheets-data-validation-ui'),require('@univerjs/sheets-drawing'),require('@univerjs/sheets-drawing-ui'),require('@univerjs/sheets-filter'),require('@univerjs/sheets-filter-ui'),require('@univerjs/sheets-formula'),require('@univerjs/sheets-formula-ui'),require('@univerjs/sheets-hyper-link'),require('@univerjs/sheets-hyper-link-ui'),require('@univerjs/sheets-numfmt'),require('@univerjs/sheets-ui')):typeof define==_0x168e6d(0x20f)&&define['amd']?define(['exports','@univerjs/core',_0x168e6d(0x1ba),_0x168e6d(0x10c),_0x168e6d(0x1ae),_0x168e6d(0x1f9),_0x168e6d(0x166),'rxjs',_0x168e6d(0x125),'@univerjs-pro/edit-history-viewer',_0x168e6d(0x1ec),_0x168e6d(0x1ff),_0x168e6d(0x156),_0x168e6d(0x17f),_0x168e6d(0x1fc),_0x168e6d(0x213),_0x168e6d(0x13e),_0x168e6d(0x16a),_0x168e6d(0xfa),_0x168e6d(0x208),_0x168e6d(0x14b),_0x168e6d(0x196),'@univerjs/rpc',_0x168e6d(0xfe),_0x168e6d(0x1cc),_0x168e6d(0x15b),_0x168e6d(0x15d),'@univerjs/sheets-drawing',_0x168e6d(0x143),_0x168e6d(0x17b),'@univerjs/sheets-filter-ui',_0x168e6d(0x151),'@univerjs/sheets-formula-ui',_0x168e6d(0x1ad),_0x168e6d(0x1d0),'@univerjs/sheets-numfmt',_0x168e6d(0x120)],_0xcae3cd):(_0x40d2f5=typeof globalThis<'u'?globalThis:_0x40d2f5||self,_0xcae3cd(_0x40d2f5['UniverProEditHistoryLoader']={},_0x40d2f5[_0x168e6d(0x11c)],_0x40d2f5['UniverProCollaboration'],_0x40d2f5['UniverProCollaborationClient'],_0x40d2f5['UniverDesign'],_0x40d2f5[_0x168e6d(0x1fb)],_0x40d2f5[_0x168e6d(0x1b3)],_0x40d2f5[_0x168e6d(0x11b)],_0x40d2f5[_0x168e6d(0x1c3)],_0x40d2f5[_0x168e6d(0x1a3)],_0x40d2f5[_0x168e6d(0x174)],_0x40d2f5[_0x168e6d(0x185)],_0x40d2f5[_0x168e6d(0x1ab)],_0x40d2f5[_0x168e6d(0x1f7)],_0x40d2f5['UniverDataValidation'],_0x40d2f5[_0x168e6d(0x16c)],_0x40d2f5[_0x168e6d(0x12d)],_0x40d2f5['UniverDrawing'],_0x40d2f5[_0x168e6d(0x10d)],_0x40d2f5[_0x168e6d(0x20b)],_0x40d2f5[_0x168e6d(0x173)],_0x40d2f5[_0x168e6d(0x182)],_0x40d2f5[_0x168e6d(0x1e5)],_0x40d2f5[_0x168e6d(0x1c6)],_0x40d2f5['UniverSheetsConditionalFormattingUi'],_0x40d2f5[_0x168e6d(0x1a0)],_0x40d2f5[_0x168e6d(0x200)],_0x40d2f5[_0x168e6d(0x139)],_0x40d2f5[_0x168e6d(0xfd)],_0x40d2f5[_0x168e6d(0xf6)],_0x40d2f5[_0x168e6d(0x19c)],_0x40d2f5[_0x168e6d(0x1b4)],_0x40d2f5['UniverSheetsFormulaUi'],_0x40d2f5[_0x168e6d(0x1c0)],_0x40d2f5['UniverSheetsHyperLinkUi'],_0x40d2f5['UniverSheetsNumfmt'],_0x40d2f5['UniverSheetsUi']));}(this,function(_0x2f6d46,_0x2c1ffa,_0x1ac28c,_0x2b1cf6,_0xdc0735,_0xa4bee0,_0x5946d7,_0xb7bcb6,_0x348ea4,_0x4d4c93,_0x48c5e5,_0x17a5fa,_0x2c4667,_0x51a8d5,_0x552024,_0x418a6a,_0x151362,_0x15543d,_0x130f08,_0x2669db,_0x5d5482,_0x5c0f99,_0x4a5cff,_0x57466a,_0x401700,_0x5a30fa,_0x492e3e,_0x4c1ef3,_0x744652,_0x45f668,_0x52006b,_0x16e5f1,_0x286a42,_0x16efd7,_0x1d12a0,_0x1a6714,_0x122728){'use strict';const _0x353da9=_0x3795;var _0x3f9ef6=Object['defineProperty'],_0x24db74=(_0x1e3ceb,_0xb7ac5c,_0xb473c7)=>_0xb7ac5c in _0x1e3ceb?_0x3f9ef6(_0x1e3ceb,_0xb7ac5c,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0xb473c7}):_0x1e3ceb[_0xb7ac5c]=_0xb473c7,_0x3c57bf=(_0x1704a8,_0x28aff3,_0x25cc0d)=>_0x24db74(_0x1704a8,typeof _0x28aff3!='symbol'?_0x28aff3+'':_0x28aff3,_0x25cc0d),_0x3de355;const _0x3bb203=_0x353da9(0x1e8),_0x2a7967={};function _0x4bfea6({ref:_0x43e369,..._0x2ee350}){const _0x52878a=_0x353da9,{icon:_0x28d698,id:_0x58d991,className:_0x5512cf,extend:_0x39d1d0,..._0x42344f}=_0x2ee350,_0x3e7d13=(_0x52878a(0x10e)+_0x58d991+'\x20'+(_0x5512cf||''))[_0x52878a(0x190)](),_0x2c939a=_0xa4bee0['useRef']('_'+_0x95d845());return _0x28ec21(_0x28d698,''+_0x58d991,{'defIds':_0x28d698[_0x52878a(0x1c1)],'idSuffix':_0x2c939a[_0x52878a(0x1eb)]},{'ref':_0x43e369,'className':_0x3e7d13,..._0x42344f},_0x39d1d0);}function _0x28ec21(_0x5b2ceb,_0x8cad47,_0x10b599,_0x4a6ae4,_0x1de0e0){const _0x3f30c7=_0x353da9;return _0xa4bee0[_0x3f30c7(0x1a2)](_0x5b2ceb[_0x3f30c7(0x1e0)],{'key':_0x8cad47,..._0x3e4ba5(_0x5b2ceb,_0x10b599,_0x1de0e0),..._0x4a6ae4},(_0x27b1ab(_0x5b2ceb,_0x10b599)[_0x3f30c7(0x1e3)]||[])[_0x3f30c7(0x1fa)]((_0x207da0,_0x292624)=>_0x28ec21(_0x207da0,_0x8cad47+'-'+_0x5b2ceb[_0x3f30c7(0x1e0)]+'-'+_0x292624,_0x10b599,void 0x0,_0x1de0e0)));}function _0x3e4ba5(_0x17cd6c,_0x29dd16,_0x4f0664){const _0x782dd6=_0x353da9,_0x37dee9={..._0x17cd6c[_0x782dd6(0x160)]};_0x4f0664!=null&&_0x4f0664['colorChannel1']&&_0x37dee9[_0x782dd6(0x162)]===_0x782dd6(0x1c5)&&(_0x37dee9[_0x782dd6(0x162)]=_0x4f0664[_0x782dd6(0x1c5)]),_0x17cd6c[_0x782dd6(0x1e0)]===_0x782dd6(0x1be)&&_0x37dee9['id']&&(_0x37dee9['id']=_0x37dee9['id']+_0x29dd16[_0x782dd6(0x129)]),Object['entries'](_0x37dee9)[_0x782dd6(0x1fd)](([_0x125e8,_0x28249a])=>{const _0x32ccfd=_0x782dd6;_0x125e8==='mask'&&typeof _0x28249a==_0x32ccfd(0x167)&&(_0x37dee9[_0x125e8]=_0x28249a[_0x32ccfd(0x102)](/url\(#(.*)\)/,'url(#$1'+_0x29dd16[_0x32ccfd(0x129)]+')'));});const {defIds:_0x50028a}=_0x29dd16;return!_0x50028a||_0x50028a[_0x782dd6(0x158)]===0x0||(_0x17cd6c[_0x782dd6(0x1e0)]==='use'&&_0x37dee9[_0x782dd6(0x1bb)]&&(_0x37dee9[_0x782dd6(0x1bb)]=_0x37dee9[_0x782dd6(0x1bb)]+_0x29dd16[_0x782dd6(0x129)]),Object[_0x782dd6(0x112)](_0x37dee9)[_0x782dd6(0x1fd)](([_0x364040,_0xd68de7])=>{const _0x3cae82=_0x782dd6;typeof _0xd68de7=='string'&&(_0x37dee9[_0x364040]=_0xd68de7[_0x3cae82(0x102)](/url\(#(.*)\)/,_0x3cae82(0x1d8)+_0x29dd16['idSuffix']+')'));})),_0x37dee9;}function _0x27b1ab(_0x31c339,_0x29338c){const _0x13ceb4=_0x353da9;var _0x32aaac;const {defIds:_0x660e20}=_0x29338c;return!_0x660e20||_0x660e20[_0x13ceb4(0x158)]===0x0?_0x31c339:_0x31c339[_0x13ceb4(0x1e0)]===_0x13ceb4(0x18e)&&((_0x32aaac=_0x31c339[_0x13ceb4(0x1e3)])!=null&&_0x32aaac[_0x13ceb4(0x158)])?{..._0x31c339,'children':_0x31c339[_0x13ceb4(0x1e3)][_0x13ceb4(0x1fa)](_0x57b683=>typeof _0x57b683[_0x13ceb4(0x160)]['id']==_0x13ceb4(0x167)&&_0x660e20&&_0x660e20[_0x13ceb4(0x19f)](_0x57b683[_0x13ceb4(0x160)]['id'])?{..._0x57b683,'attrs':{..._0x57b683[_0x13ceb4(0x160)],'id':_0x57b683[_0x13ceb4(0x160)]['id']+_0x29338c[_0x13ceb4(0x129)]}}:_0x57b683)}:_0x31c339;}function _0x95d845(){const _0x40ab73=_0x353da9;return Math[_0x40ab73(0x1b7)]()[_0x40ab73(0x203)](0x24)[_0x40ab73(0xf9)](0x2,0x8);}_0x4bfea6[_0x353da9(0x132)]=_0x353da9(0xf5);const _0x3b06e2={'tag':_0x353da9(0x154),'attrs':{'xmlns':_0x353da9(0x114),'fill':_0x353da9(0x15e),'viewBox':_0x353da9(0x1a5),'width':'1em','height':_0x353da9(0x1a9)},'children':[{'tag':'g','attrs':{'fill':_0x353da9(0x1f8),'clipPath':_0x353da9(0x117)},'children':[{'tag':_0x353da9(0x17c),'attrs':{'d':_0x353da9(0x211)}},{'tag':_0x353da9(0x17c),'attrs':{'d':_0x353da9(0x13a)}}]},{'tag':'defs','attrs':{},'children':[{'tag':_0x353da9(0x18f),'attrs':{'id':'history-icon_clip0_907_281'},'children':[{'tag':_0x353da9(0x17c),'attrs':{'fill':'white','d':_0x353da9(0x13f)}}]}]}],'defIds':['history-icon_clip0_907_281']},_0x544f07=_0xa4bee0['forwardRef'](function(_0x13e6b4,_0x1dfe1d){const _0x5f2854=_0x353da9;return _0xa4bee0[_0x5f2854(0x1a2)](_0x4bfea6,Object[_0x5f2854(0x1d1)]({},_0x13e6b4,{'id':_0x5f2854(0x1de),'ref':_0x1dfe1d,'icon':_0x3b06e2}));});_0x544f07[_0x353da9(0x132)]='HistoryIcon';var _0x5256a9=Object[_0x353da9(0x157)],_0x1be8e4=(_0x527db5,_0x1872d5,_0x23f51f,_0x1e67c8)=>{const _0x31bc17=_0x353da9;for(var _0x1f919a=_0x1e67c8>0x1?void 0x0:_0x1e67c8?_0x5256a9(_0x1872d5,_0x23f51f):_0x1872d5,_0x585e69=_0x527db5[_0x31bc17(0x158)]-0x1,_0x2a72db;_0x585e69>=0x0;_0x585e69--)(_0x2a72db=_0x527db5[_0x585e69])&&(_0x1f919a=_0x2a72db(_0x1f919a)||_0x1f919a);return _0x1f919a;},_0x1206b0=(_0x407b08,_0x27f55b)=>(_0x495394,_0x46177e)=>_0x27f55b(_0x495394,_0x46177e,_0x407b08);const _0x1e67bd='univer-container',_0x59e2bb=_0x353da9(0x124),_0x51e7e3=_0x353da9(0x195);_0x2f6d46[_0x353da9(0x13d)]=class extends _0x2c1ffa[_0x353da9(0x1a1)]{constructor(_0x5cdeec,_0x30937d,_0x5370a0,_0x427fc0,_0x3c80ac,_0x5bdab6,_0x5c2928,_0x372937,_0x59ebde,_0x3b66fb){const _0x49093e=_0x353da9;super(),_0x3c57bf(this,'_historyUniver$',new _0xb7bcb6[(_0x49093e(0x14a))](null)),_0x3c57bf(this,'historyUniver$',this[_0x49093e(0x163)]['asObservable']()),_0x3c57bf(this,_0x49093e(0x14c),new _0x2c1ffa[(_0x49093e(0x1f0))]()),_0x3c57bf(this,_0x49093e(0x169),new Map()),(this[_0x49093e(0x155)]=_0x5cdeec,this['_univerInstanceService']=_0x30937d,this['_configService']=_0x5370a0,this['_commandService']=_0x427fc0,this[_0x49093e(0x19b)]=_0x3c80ac,this['_permissionService']=_0x5bdab6,this['_selectionProtectionRuleModel']=_0x5c2928,this['_dialogService']=_0x372937,this[_0x49093e(0x19d)]=_0x59ebde,this[_0x49093e(0x1f6)]=_0x3b66fb,this[_0x49093e(0x171)]());}get[_0x353da9(0x119)](){const _0x3e076a=_0x353da9;return this[_0x3e076a(0x163)][_0x3e076a(0x20d)];}[_0x353da9(0x171)](){const _0x523f6e=_0x353da9;this[_0x523f6e(0x1c2)](),this[_0x523f6e(0xff)]();}['_initContainer'](){const _0x5532c3=_0x353da9;var _0x25dc41;const _0x527765=(_0x25dc41=this[_0x5532c3(0x1c7)][_0x5532c3(0x1e4)](_0x59e2bb))!=null?_0x25dc41:_0x1e67bd,_0x50a4cb=document['getElementById'](_0x527765);if(!_0x50a4cb)return;const _0x4e6b3d=document[_0x5532c3(0x1a2)](_0x5532c3(0x212));_0x4e6b3d['id']=_0x51e7e3,_0x4e6b3d[_0x5532c3(0x1cf)]['uComp']=_0x5532c3(0x1d5),_0x4e6b3d[_0x5532c3(0x210)]['position']=_0x5532c3(0x1e2),_0x4e6b3d[_0x5532c3(0x210)]['top']='0',_0x4e6b3d['style']['left']='0',_0x4e6b3d[_0x5532c3(0x210)][_0x5532c3(0x12b)]=_0x5532c3(0x144),_0x4e6b3d[_0x5532c3(0x210)][_0x5532c3(0x191)]='100%',_0x4e6b3d[_0x5532c3(0x210)]['zIndex']=_0x5532c3(0xfb),_0x4e6b3d[_0x5532c3(0x210)]['display']='none',_0x50a4cb[_0x5532c3(0x153)](_0x4e6b3d);}[_0x353da9(0xff)](){const _0x351e42=_0x353da9;var _0x3813ce;[[_0x5d5482[_0x351e42(0x161)]],[_0x5946d7[_0x351e42(0x170)],{'container':_0x51e7e3,'header':!0x0,'toolbar':!0x1,'footer':!0x0,'contextMenu':!0x1,'override':[[_0x5946d7[_0x351e42(0x1e1)],null]]}],[_0x5c0f99[_0x351e42(0x15f)]],[_0x15543d[_0x351e42(0x128)],{'override':[[_0x15543d[_0x351e42(0x131)],null]]}],[_0x418a6a['UniverDocsPlugin'],{'hasScroll':!0x1}],[_0x151362['UniverDocsUIPlugin']],[_0x1a6714[_0x351e42(0x1a6)]],[_0x348ea4[_0x351e42(0x1fe)],{'notExecuteFormula':!0x0}],[_0x122728[_0x351e42(0x149)]],[_0x16e5f1['UniverSheetsFormulaPlugin']],[_0x286a42['UniverSheetsFormulaUIPlugin']],[_0x1ac28c[_0x351e42(0x12f)]],[_0x45f668['UniverSheetsFilterPlugin']],[_0x52006b[_0x351e42(0x127)]],[_0x57466a[_0x351e42(0x138)]],[_0x401700[_0x351e42(0x178)]],[_0x16efd7[_0x351e42(0x1ed)]],[_0x1d12a0['UniverSheetsHyperLinkUIPlugin']],[_0x552024[_0x351e42(0x1a4)]],[_0x5a30fa[_0x351e42(0x145)]],[_0x492e3e[_0x351e42(0x181)]],[_0x2669db['UniverFormulaEnginePlugin'],{'notExecuteFormula':!0x0}],[_0x4a5cff['UniverRPCMainThreadPlugin'],{'workerURL':_0x351e42(0x1dd)}],[_0x130f08[_0x351e42(0x11d)]],[_0x4c1ef3[_0x351e42(0x189)]],[_0x744652[_0x351e42(0x1b8)]],[_0x2c4667[_0x351e42(0x17a)]],[_0x51a8d5['UniverSheetSparklineUIPlugin']],[_0x17a5fa[_0x351e42(0x1ea)],{'notExecuteFormula':!0x0}],[_0x4d4c93['UniverEditHistoryViewerPlugin'],{'historyListServerUrl':(_0x3813ce=this['_configService'][_0x351e42(0x1e4)](_0x3bb203))==null?void 0x0:_0x3813ce[_0x351e42(0x111)]}]]['forEach'](([_0x5ca177,_0x67cd75])=>this['registerPlugin'](_0x5ca177,_0x67cd75));}[_0x353da9(0x1d6)](){const _0x369871=_0x353da9;super[_0x369871(0x1d6)](),this[_0x369871(0x100)](),this[_0x369871(0x169)][_0x369871(0x1d3)]();}[_0x353da9(0x179)](_0x65e539,_0x392d67,_0x2c5bd8){const _0x50c9ba=_0x353da9;if(this[_0x50c9ba(0x169)][_0x50c9ba(0x180)](_0x65e539[_0x50c9ba(0x1ef)])&&!_0x2c5bd8)throw new Error('[HistoryLoaderService]:\x20Plugin\x20'+_0x65e539['pluginName']+_0x50c9ba(0x13b));this[_0x50c9ba(0x169)][_0x50c9ba(0x1b9)](_0x65e539[_0x50c9ba(0x1ef)],[_0x65e539,_0x392d67]);}[_0x353da9(0x116)](){const _0x143fd2=_0x353da9;return Array[_0x143fd2(0x183)](this['_pluginMap'][_0x143fd2(0x168)]());}['mountHistoryContent'](_0x3bd937){const _0x205df4=_0x353da9,_0x2c9706=document[_0x205df4(0x148)](_0x51e7e3);_0x2c9706&&(_0x2c9706[_0x205df4(0x210)]['display']='block',this[_0x205df4(0x1e9)](_0x3bd937,_0x51e7e3));}[_0x353da9(0x100)](){const _0x18a27f=_0x353da9;var _0x4510ec;this[_0x18a27f(0x14c)]['dispose'](),(_0x4510ec=this['historyUniver'])==null||_0x4510ec[_0x18a27f(0x1d6)](),this[_0x18a27f(0x163)]['next'](null);const _0x57d8d4=document[_0x18a27f(0x148)](_0x51e7e3);_0x57d8d4&&(_0x57d8d4[_0x18a27f(0x210)][_0x18a27f(0x1d2)]=_0x18a27f(0x15e));}[_0x353da9(0x1e9)](_0x14d188,_0x2a040b){const _0x3dbabc=_0x353da9;if(this[_0x3dbabc(0x119)])return;const _0x4e0463=new _0x2c1ffa[(_0x3dbabc(0x214))]({'locales':{[this['_localeService'][_0x3dbabc(0x16d)]()]:this[_0x3dbabc(0x155)][_0x3dbabc(0x18d)]()},'override':[[_0x2c1ffa[_0x3dbabc(0x1f2)],{'useClass':_0x2b1cf6[_0x3dbabc(0x15a)]}]]}),_0x2b1ce4=_0x4e0463[_0x3dbabc(0x106)]();this[_0x3dbabc(0x172)](this[_0x3dbabc(0x1f6)][_0x3dbabc(0x16e)][_0x3dbabc(0x198)](_0x5ded2f=>{const _0x310a11=_0x3dbabc;_0x2b1ce4['get'](_0x2c1ffa[_0x310a11(0x187)])[_0x310a11(0x1df)](_0x5ded2f);})),this['disposeWithMe'](this[_0x3dbabc(0x1f6)][_0x3dbabc(0x17d)][_0x3dbabc(0x198)](_0x979cba=>{const _0x18d86b=_0x3dbabc;_0x2b1ce4[_0x18d86b(0x141)](_0x2c1ffa[_0x18d86b(0x187)])[_0x18d86b(0x146)](_0x979cba);})),_0x2b1ce4['get'](_0x2c1ffa[_0x3dbabc(0x130)])['setLocale'](this[_0x3dbabc(0x155)][_0x3dbabc(0x16d)]()),_0x2b1ce4[_0x3dbabc(0x141)](_0x2c1ffa[_0x3dbabc(0x150)])[_0x3dbabc(0x176)](_0x2b1cf6['COLLABORATION_CLIENT_PLUGIN_CONFIG_KEY'],this[_0x3dbabc(0x1c7)][_0x3dbabc(0x1e4)](_0x2b1cf6[_0x3dbabc(0x10a)]));const _0x2c303f=this[_0x3dbabc(0x1c7)][_0x3dbabc(0x1e4)](_0x48c5e5[_0x3dbabc(0x104)]);_0x2c303f&&_0x4e0463[_0x3dbabc(0x179)](_0x48c5e5[_0x3dbabc(0x15c)],{'license':_0x2c303f['ls']}),this[_0x3dbabc(0x169)][_0x3dbabc(0x1fd)](([_0x50bbc1,_0x4b4785])=>{_0x4e0463['registerPlugin'](_0x50bbc1,_0x4b4785);}),_0x2b1ce4[_0x3dbabc(0x1e7)](_0x30373a=>{const _0x5db122=_0x3dbabc;this[_0x5db122(0x199)](_0x30373a,_0x14d188);}),this[_0x3dbabc(0x163)][_0x3dbabc(0x14e)](_0x4e0463);const _0x38a6d7=_0x2b1ce4[_0x3dbabc(0x141)](_0x4d4c93[_0x3dbabc(0x1ac)]),_0x4a619d=this['_checkCanRevert'](_0x14d188);_0x38a6d7[_0x3dbabc(0x164)](_0x14d188,_0x2a040b,_0x4a619d);}['_initListener'](_0x48e071,_0x10df93){const _0x558ec2=_0x353da9,_0x3eabaf=_0x48e071[_0x558ec2(0x141)](_0x4d4c93[_0x558ec2(0x1ac)]);this[_0x558ec2(0x14c)]['add'](_0x3eabaf[_0x558ec2(0x1bf)][_0x558ec2(0x198)](_0x215f7b=>{const _0x459442=_0x558ec2;switch(_0x215f7b){case _0x4d4c93['HistoryModeStatus'][_0x459442(0x11f)]:this[_0x459442(0x115)][_0x459442(0x206)](),this[_0x459442(0x19d)][_0x459442(0x1e6)]();break;case _0x4d4c93[_0x459442(0x1bc)][_0x459442(0x1f3)]:this['unMountHistoryContent']();break;case _0x4d4c93['HistoryModeStatus'][_0x459442(0x12c)]:this[_0x459442(0x100)](),this['_messageService'][_0x459442(0x1af)]({'content':this['_localeService']['t'](_0x459442(0x1b1)),'type':_0xdc0735['MessageType'][_0x459442(0x12c)],'duration':0xbb8});break;}})),this['_disposableCollection'][_0x558ec2(0x186)](_0x3eabaf[_0x558ec2(0x175)]['subscribe'](async _0x464f5a=>{const _0x46f3f2=_0x558ec2;_0x464f5a&&this[_0x46f3f2(0x1f4)][_0x46f3f2(0x121)](_0x1ac28c[_0x46f3f2(0x1d4)]['id'],{'unitId':_0x10df93,'revision':_0x464f5a});}));}[_0x353da9(0x177)](_0x508148){const _0x2d88f5=_0x353da9,_0x52aeee=this['_univerInstanceService'][_0x2d88f5(0x1cd)](_0x508148)[_0x2d88f5(0x109)]()[_0x2d88f5(0x1fa)](_0x332c8f=>_0x332c8f['getSheetId']()),_0x3a623b=new _0x348ea4[(_0x2d88f5(0x14f))](_0x508148)['id'],_0x59345c=_0x52aeee[_0x2d88f5(0x1fa)](_0xd5b2d=>new _0x348ea4[(_0x2d88f5(0x12e))](_0x508148,_0xd5b2d)['id']),_0xd67f0f=_0x52aeee[_0x2d88f5(0x1fa)](_0x32ab0b=>this['_selectionProtectionRuleModel'][_0x2d88f5(0x113)](_0x508148,_0x32ab0b)[_0x2d88f5(0x1fa)](_0x5a05fe=>new _0x348ea4['RangeProtectionPermissionEditPoint'](_0x508148,_0x32ab0b,_0x5a05fe[_0x2d88f5(0x1bd)])['id']))[_0x2d88f5(0x205)](),_0x205ad7=new _0x348ea4['WorkbookRecoverHistoryPermission'](_0x508148)['id'];return this[_0x2d88f5(0x1d9)][_0x2d88f5(0x126)]([_0x3a623b,..._0x59345c,..._0xd67f0f,_0x205ad7])[_0x2d88f5(0x204)](_0x134cec=>!!_0x134cec['value']);}},_0x2f6d46[_0x353da9(0x13d)]=_0x1be8e4([_0x1206b0(0x0,_0x2c1ffa[_0x353da9(0x194)](_0x2c1ffa[_0x353da9(0x130)])),_0x1206b0(0x1,_0x2c1ffa['IUniverInstanceService']),_0x1206b0(0x2,_0x2c1ffa[_0x353da9(0x150)]),_0x1206b0(0x3,_0x2c1ffa[_0x353da9(0x197)]),_0x1206b0(0x4,_0x5946d7['IMessageService']),_0x1206b0(0x5,_0x2c1ffa[_0x353da9(0x1dc)]),_0x1206b0(0x6,_0x2c1ffa['Inject'](_0x348ea4[_0x353da9(0x13c)])),_0x1206b0(0x7,_0x2c1ffa['Inject'](_0x5946d7[_0x353da9(0x1e1)])),_0x1206b0(0x8,_0x2c1ffa[_0x353da9(0x194)](_0x5946d7[_0x353da9(0xf7)])),_0x1206b0(0x9,_0x2c1ffa[_0x353da9(0x194)](_0x2c1ffa[_0x353da9(0x187)]))],_0x2f6d46['HistoryLoaderService']);const _0x590e58={'id':_0x353da9(0x107),'type':_0x2c1ffa[_0x353da9(0x209)][_0x353da9(0x1b6)],'handler':_0x54a213=>{const _0x588d40=_0x353da9,_0xdc93a6=_0x54a213[_0x588d40(0x141)](_0x2f6d46[_0x588d40(0x13d)]),_0x493cff=_0x54a213[_0x588d40(0x141)](_0x2c1ffa[_0x588d40(0x147)]),{unitId:_0x491b1d}=_0x348ea4[_0x588d40(0x14d)](_0x493cff)||{};return _0x491b1d?(_0xdc93a6['mountHistoryContent'](_0x491b1d),!0x0):!0x1;}};function _0x2c40a1(_0x3da8b4){const _0x4eab9a=_0x353da9;return{'id':_0x590e58['id'],'type':_0x5946d7[_0x4eab9a(0x202)]['BUTTON'],'icon':_0x4eab9a(0x1b0),'tooltip':_0x4eab9a(0x10b),'hidden$':_0x5946d7[_0x4eab9a(0x19a)](_0x3da8b4,_0x2c1ffa[_0x4eab9a(0x1c8)][_0x4eab9a(0x1da)]),'disabled$':_0x122728[_0x4eab9a(0x17e)](_0x3da8b4,{'workbookTypes':[_0x348ea4[_0x4eab9a(0x14f)],_0x348ea4[_0x4eab9a(0x136)]],'worksheetTypes':[],'rangeTypes':[]})};}const _0x37f0be={[_0x5946d7['RibbonStartGroup']['OTHERS']]:{[_0x590e58['id']]:{'order':0.2,'menuItemFactory':_0x2c40a1}}};var _0xc8660=Object[_0x353da9(0x157)],_0x136514=(_0x5ef931,_0x4efb23,_0xe7d86,_0x58d48f)=>{const _0x3b4f3d=_0x353da9;for(var _0xb64af1=_0x58d48f>0x1?void 0x0:_0x58d48f?_0xc8660(_0x4efb23,_0xe7d86):_0x4efb23,_0x22f67f=_0x5ef931[_0x3b4f3d(0x158)]-0x1,_0x22550b;_0x22f67f>=0x0;_0x22f67f--)(_0x22550b=_0x5ef931[_0x22f67f])&&(_0xb64af1=_0x22550b(_0xb64af1)||_0xb64af1);return _0xb64af1;},_0x43d96a=(_0x35274c,_0x26a6ad)=>(_0x2bd05c,_0x7ce232)=>_0x26a6ad(_0x2bd05c,_0x7ce232,_0x35274c);let _0x3e5f6d=class extends _0x2c1ffa[_0x353da9(0x122)]{constructor(_0x242ee5,_0x4621a3,_0x26caee,_0x145fa6,_0x57b261,_0x1bdb6b,_0x4564f8,_0x5b68be){const _0x5fc892=_0x353da9;super(),_0x3c57bf(this,_0x5fc892(0x1a8),null),(this[_0x5fc892(0x1f4)]=_0x242ee5,this[_0x5fc892(0x1ca)]=_0x4621a3,this[_0x5fc892(0xf8)]=_0x26caee,this[_0x5fc892(0x1f1)]=_0x145fa6,this[_0x5fc892(0x155)]=_0x57b261,this['_messageService']=_0x1bdb6b,this[_0x5fc892(0x118)]=_0x4564f8,this[_0x5fc892(0x18a)]=_0x5b68be,this[_0x5fc892(0x171)]());}[_0x353da9(0x171)](){const _0x558fce=_0x353da9;[_0x590e58]['forEach'](_0x5c58f7=>this[_0x558fce(0x172)](_0x2c1ffa[_0x558fce(0x20a)](this[_0x558fce(0x1f4)]['registerCommand'](_0x5c58f7)))),this[_0x558fce(0x172)](this[_0x558fce(0xf8)]['register'](_0x558fce(0x1b0),_0x544f07)),this[_0x558fce(0x1ca)][_0x558fce(0x1c4)](_0x37f0be),this[_0x558fce(0x172)](this[_0x558fce(0x1f4)][_0x558fce(0x10f)](_0x32b4ff=>{const _0xfa329e=_0x558fce;if(_0x32b4ff['id']===_0x1ac28c[_0xfa329e(0x1d4)]['id']){this[_0xfa329e(0x19b)][_0xfa329e(0x1af)]({'content':this[_0xfa329e(0x155)]['t'](_0xfa329e(0x135)),'type':_0xdc0735[_0xfa329e(0x12a)][_0xfa329e(0x1f5)],'duration':0x1388});const {unitId:_0x1464ab}=_0x32b4ff['params'],_0x296999=this[_0xfa329e(0x118)]['getCollabEntity'](_0x1464ab),_0x444e19=_0xb7bcb6[_0xfa329e(0x142)]([_0x296999[_0xfa329e(0x137)][_0xfa329e(0x1db)],_0x296999['state$']])[_0xfa329e(0x198)](async([_0xfb42f3,_0x3ca1bb])=>{const _0x1f0275=_0xfa329e;var _0x164af4;_0xfb42f3[_0x1f0275(0x1aa)]===_0x1ac28c[_0x1f0275(0x19e)]['CHANGESET_ACK']&&(_0x3ca1bb==null?void 0x0:_0x3ca1bb[_0x1f0275(0xfc)])===_0x2b1cf6['CollaborationStatus'][_0x1f0275(0x165)]&&_0xfb42f3[_0x1f0275(0x16f)][_0x1f0275(0x101)][_0x1f0275(0x20e)](_0x4a2f81=>_0x4a2f81['id']===_0x1ac28c[_0x1f0275(0x1d4)]['id'])&&(this[_0x1f0275(0x1f1)][_0x1f0275(0x100)](),_0x444e19['unsubscribe'](),this[_0x1f0275(0x1a8)]&&clearTimeout(this['_revertErrorTimer']),await((_0x164af4=this['_localCacheService'])==null?void 0x0:_0x164af4[_0x1f0275(0x152)]()),setTimeout(()=>window[_0x1f0275(0x18b)]['reload']()));});this[_0xfa329e(0x1a8)]=setTimeout(()=>{const _0x53370c=_0xfa329e;_0x444e19[_0x53370c(0x11e)](),this[_0x53370c(0x19b)][_0x53370c(0x1af)]({'content':this[_0x53370c(0x155)]['t'](_0x53370c(0x188)),'type':_0xdc0735['MessageType'][_0x53370c(0x12c)],'duration':0xbb8});},0x1388);}}));}};_0x3e5f6d=_0x136514([_0x43d96a(0x0,_0x2c1ffa['ICommandService']),_0x43d96a(0x1,_0x5946d7['IMenuManagerService']),_0x43d96a(0x2,_0x2c1ffa[_0x353da9(0x194)](_0x5946d7[_0x353da9(0x193)])),_0x43d96a(0x3,_0x2c1ffa[_0x353da9(0x194)](_0x2f6d46[_0x353da9(0x13d)])),_0x43d96a(0x4,_0x2c1ffa[_0x353da9(0x194)](_0x2c1ffa[_0x353da9(0x130)])),_0x43d96a(0x5,_0x5946d7[_0x353da9(0x1ce)]),_0x43d96a(0x6,_0x2c1ffa[_0x353da9(0x194)](_0x2b1cf6[_0x353da9(0x16b)])),_0x43d96a(0x7,_0x2b1cf6[_0x353da9(0x1b5)])],_0x3e5f6d);var _0x19627e=Object[_0x353da9(0x157)],_0x4958f2=(_0x376633,_0x3b8ff1,_0x23875d,_0x184452)=>{for(var _0x159745=_0x184452>0x1?void 0x0:_0x184452?_0x19627e(_0x3b8ff1,_0x23875d):_0x3b8ff1,_0x5a27a9=_0x376633['length']-0x1,_0x2886ae;_0x5a27a9>=0x0;_0x5a27a9--)(_0x2886ae=_0x376633[_0x5a27a9])&&(_0x159745=_0x2886ae(_0x159745)||_0x159745);return _0x159745;},_0x55c981=(_0x1b68c2,_0x505ace)=>(_0x51ff24,_0x1216af)=>_0x505ace(_0x51ff24,_0x1216af,_0x1b68c2);const _0x2c887a=_0x353da9(0x123);_0x2f6d46['UniverEditHistoryLoaderPlugin']=(_0x3de355=class extends _0x2c1ffa[_0x353da9(0x159)]{constructor(_0x6112b2=_0x2a7967,_0x299c67,_0x496941){const _0x7373af=_0x353da9;super(),this[_0x7373af(0x1b2)]=_0x6112b2,this['_injector']=_0x299c67,this[_0x7373af(0x1c7)]=_0x496941;const {menu:_0x5e1fa2,..._0x404012}=_0x2c1ffa[_0x7373af(0x207)]({},_0x2a7967,this[_0x7373af(0x1b2)]);_0x5e1fa2&&this[_0x7373af(0x1c7)]['setConfig'](_0x7373af(0x1d7),_0x5e1fa2,{'merge':!0x0}),this[_0x7373af(0x1c7)][_0x7373af(0x176)](_0x3bb203,_0x404012),this[_0x7373af(0x1b2)][_0x7373af(0x140)]&&this[_0x7373af(0x1c7)][_0x7373af(0x176)](_0x59e2bb,this[_0x7373af(0x1b2)][_0x7373af(0x140)]);}['onStarting'](){const _0x285614=_0x353da9;[[_0x2f6d46[_0x285614(0x13d)]],[_0x3e5f6d]][_0x285614(0x1fd)](_0x591991=>this[_0x285614(0x105)][_0x285614(0x186)](_0x591991));}[_0x353da9(0x18c)](){const _0x30a5e0=_0x353da9;this['_injector'][_0x30a5e0(0x141)](_0x3e5f6d);}},_0x3c57bf(_0x3de355,'type',_0x2c1ffa['UniverInstanceType']['UNIVER_UNKNOWN']),_0x3c57bf(_0x3de355,_0x353da9(0x1ef),_0x2c887a),_0x3de355),_0x2f6d46[_0x353da9(0x134)]=_0x4958f2([_0x55c981(0x1,_0x2c1ffa[_0x353da9(0x194)](_0x2c1ffa['Injector'])),_0x55c981(0x2,_0x2c1ffa[_0x353da9(0x150)])],_0x2f6d46[_0x353da9(0x134)]),_0x2f6d46[_0x353da9(0x110)]=_0x59e2bb,_0x2f6d46[_0x353da9(0x108)]=_0x51e7e3,Object['defineProperty'](_0x2f6d46,Symbol['toStringTag'],{'value':'Module'});}));