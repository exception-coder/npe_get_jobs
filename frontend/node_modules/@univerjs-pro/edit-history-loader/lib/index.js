const _0x8bb7a6=_0x3800;(function(_0x21fb35,_0x35ae51){const _0x403236=_0x3800,_0x38ebc1=_0x21fb35();while(!![]){try{const _0x1a8b5c=-parseInt(_0x403236(0x199))/0x1*(-parseInt(_0x403236(0x176))/0x2)+parseInt(_0x403236(0x166))/0x3*(-parseInt(_0x403236(0x1a9))/0x4)+parseInt(_0x403236(0x1d3))/0x5+parseInt(_0x403236(0x1d5))/0x6*(parseInt(_0x403236(0x18f))/0x7)+-parseInt(_0x403236(0x1ae))/0x8+-parseInt(_0x403236(0x18d))/0x9+parseInt(_0x403236(0x183))/0xa;if(_0x1a8b5c===_0x35ae51)break;else _0x38ebc1['push'](_0x38ebc1['shift']());}catch(_0xf619d0){_0x38ebc1['push'](_0x38ebc1['shift']());}}}(_0x278a,0xb1899));var G=Object[_0x8bb7a6(0x186)],B=(_0x36fb15,_0x498224,_0x4798ee)=>_0x498224 in _0x36fb15?G(_0x36fb15,_0x498224,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0x4798ee}):_0x36fb15[_0x498224]=_0x4798ee,g=(_0x9b0bb1,_0x447ba9,_0x574be9)=>B(_0x9b0bb1,typeof _0x447ba9!='symbol'?_0x447ba9+'':_0x447ba9,_0x574be9);import{Inject as _0x1f768c,LocaleService as _0x52477,IUniverInstanceService as _0x501951,IConfigService as _0x178247,ICommandService as _0x5221cb,IPermissionService as _0x2ec47e,ThemeService as _0x316887,Disposable as _0xa54253,DisposableCollection as _0x45d425,Univer as _0x35a028,IAuthzIoService as _0x45364d,CommandType as _0x2940f7,UniverInstanceType as _0x203456,RxDisposable as _0x6540af,toDisposable as _0x25cc2a,Plugin as _0x50a047,merge as _0x41cd19,Injector as _0x41375a}from'@univerjs/core';import{UniverCollaborationPlugin as _0x405b41,RevertRevisionMutation as _0x222df8,CollaborationEvent as _0x14f5f6}from'@univerjs-pro/collaboration';import{AuthzIoHttpService as _0x487fb0,COLLABORATION_CLIENT_PLUGIN_CONFIG_KEY as _0x166eb7,CollaborationController as _0x358892,ILocalCacheService as _0x4f1483,CollaborationStatus as _0x3420ff}from'@univerjs-pro/collaboration-client';import{MessageType as _0x4b7a83}from'@univerjs/design';import{useRef as _0x562217,createElement as _0x57dfaf,forwardRef as _0x562777}from'react';import{IMessageService as _0x1d689d,IDialogService as _0x277b1d,ISidebarService as _0x539aa6,UniverUIPlugin as _0x156b11,getMenuHiddenObservable as _0x4e41ed,MenuItemType as _0x32ca06,RibbonStartGroup as _0x1765c9,IMenuManagerService as _0x5942bf,ComponentManager as _0x2c5d20}from'@univerjs/ui';import{BehaviorSubject as _0x3125bf,combineLatest as _0x1c87f2}from'rxjs';import{RangeProtectionRuleModel as _0x5c75a3,UniverSheetsPlugin as _0x223cfb,WorkbookEditablePermission as _0x579dfc,WorksheetEditPermission as _0x3bc8a7,RangeProtectionPermissionEditPoint as _0x1ce86e,WorkbookRecoverHistoryPermission as _0x388343,getSheetCommandTarget as _0x514349,WorkbookViewHistoryPermission as _0x9e37ba}from'@univerjs/sheets';import{UniverEditHistoryViewerPlugin as _0x39a38e,HistoryManagerService as _0x177e97,HistoryModeStatus as _0x560ee6}from'@univerjs-pro/edit-history-viewer';import{LS_CONFIG_KEY as _0x30abc1,UniverLicensePlugin as _0x3da585}from'@univerjs-pro/license';import{UniverSheetsPivotTablePlugin as _0x3640c2}from'@univerjs-pro/sheets-pivot';function _0x278a(){const _0x2cdde2=['getCurrentLocale','_commandService','_permissionService','add','display','currentTheme$','status$','exhaustSavingTask','\x20has\x20been\x20registered.','revertRevision$','attrs','defs','onStarting','dispose','mask','history-container','historyUniver$','show','registerCommand','position','tag','history-icon_clip0_907_281','getElementById','Entered','getOwnPropertyDescriptor','http://www.w3.org/2000/svg','_pluginMap','every','entries','_themeService','block','_disposableCollection','1461lfapGJ','event$','editHistory.panel.listFetchError','data','univerContainerId','get','CHANGESET_ACK','clear','path','dataset','editHistory.panel.revertFailed','includes','zIndex','univer-history-container','_messageService','_revertErrorTimer','2376354pfiNGM','Error','current','OPERATION','UNIVER_CONTAINER_ID','none','closeAll','_init','fill','left','setLocale','unsubscribe','getSheetId','12260150FfMRqZ','xlink:href','edit-history-loader.config','defineProperty','getConfig','historyUniver','UNIVER_EDIT_HISTORY_LOADER_PLUGIN','unMountHistoryContent','registerPlugin','composePermission','2190321EhSzib','UniverIcon','1062509pJBbef','_initPlugins','_injector','_checkCanRevert','getLocales','_sidebarService','defIds','createElement','UNIVER_SHEET','univer-container','1ydkFjj','toString','set','_dialogService','1em','from','_historyUniver$','historyListServerUrl','_localeService','url(#$1','Exited','children','map','_componentManager','_univerInstanceService','_configService','11568vhghaf','univer.operation.toggle-edit-history','UNIVER_UNKNOWN','mutations','M4.45388\x204.14989H3.52896C4.61144\x202.8939\x206.21319\x202.0999\x207.9999\x202.0999C11.2584\x202.0999\x2013.8999\x204.74142\x2013.8999\x207.9999C13.8999\x2011.2584\x2011.2584\x2013.8999\x207.9999\x2013.8999C4.74142\x2013.8999\x202.0999\x2011.2584\x202.0999\x207.9999C2.0999\x207.66853\x201.83127\x207.3999\x201.4999\x207.3999C1.16853\x207.3999\x200.899902\x207.66853\x200.899902\x207.9999C0.899902\x2011.9211\x204.07868\x2015.0999\x207.9999\x2015.0999C11.9211\x2015.0999\x2015.0999\x2011.9211\x2015.0999\x207.9999C15.0999\x204.07868\x2011.9211\x200.899902\x207.9999\x200.899902C5.88709\x200.899902\x203.9903\x201.82298\x202.69023\x203.28636V2.38625C2.69023\x202.05488\x202.42161\x201.78625\x202.09023\x201.78625C1.75886\x201.78625\x201.49023\x202.05488\x201.49023\x202.38625V4.74989C1.49023\x205.08126\x201.75886\x205.34989\x202.09023\x205.34989H4.45388C4.78525\x205.34989\x205.05388\x205.08126\x205.05388\x204.74989C5.05388\x204.41851\x204.78525\x204.14989\x204.45388\x204.14989Z','3393648ObgLKs','random','register','assign','forEach','next','colorChannel1','uComp','displayName','M0\x200H16V16H0z','subscribe','invoke','setConfig','OTHERS','setDarkMode','flat','permissionId','mergeMenu','string','session','currentColor','substring','__getInjector','mountHistoryContent','_selectionProtectionRuleModel','pluginName','disposeWithMe','top','location','HistoryIcon','close','getSubunitRuleList','_localCacheService','getUnit','length','eventID','replace','1185965miQkoD','appendChild','6dgkVil','_initContainer','some','1000','getAllPlugins','onCommandExecuted','_collaborationController','params','idSuffix','value','_config','style','_historyManagerService','div','[HistoryLoaderService]:\x20Plugin\x20','_initListener'];_0x278a=function(){return _0x2cdde2;};return _0x278a();}import{UniverSheetSparklinePlugin as _0x8d8d81}from'@univerjs-pro/sheets-sparkline';import{UniverSheetSparklineUIPlugin as _0x51c671}from'@univerjs-pro/sheets-sparkline-ui';import{UniverDataValidationPlugin as _0x1314a}from'@univerjs/data-validation';import{UniverDocsPlugin as _0x110c57}from'@univerjs/docs';import{UniverDocsUIPlugin as _0x18a68b}from'@univerjs/docs-ui';import{UniverDrawingPlugin as _0x1a1e5e,IImageIoService as _0x317290}from'@univerjs/drawing';import{UniverDrawingUIPlugin as _0x5d5a05}from'@univerjs/drawing-ui';import{UniverFormulaEnginePlugin as _0x9e7a94}from'@univerjs/engine-formula';import{UniverRenderEnginePlugin as _0x31bb65}from'@univerjs/engine-render';import{UniverNetworkPlugin as _0x207b98}from'@univerjs/network';import{UniverRPCMainThreadPlugin as _0x95b7e8}from'@univerjs/rpc';import{UniverSheetsConditionalFormattingPlugin as _0x830c42}from'@univerjs/sheets-conditional-formatting';import{UniverSheetsConditionalFormattingUIPlugin as _0x5992cf}from'@univerjs/sheets-conditional-formatting-ui';import{UniverSheetsDataValidationPlugin as _0x3d8eb6}from'@univerjs/sheets-data-validation';import{UniverSheetsDataValidationUIPlugin as _0x253507}from'@univerjs/sheets-data-validation-ui';import{UniverSheetsDrawingPlugin as _0x583708}from'@univerjs/sheets-drawing';import{UniverSheetsDrawingUIPlugin as _0x2153cd}from'@univerjs/sheets-drawing-ui';import{UniverSheetsFilterPlugin as _0x22bd8a}from'@univerjs/sheets-filter';import{UniverSheetsFilterUIPlugin as _0x3e1d7d}from'@univerjs/sheets-filter-ui';import{UniverSheetsFormulaPlugin as _0x9061c}from'@univerjs/sheets-formula';import{UniverSheetsFormulaUIPlugin as _0x2309b5}from'@univerjs/sheets-formula-ui';import{UniverSheetsHyperLinkPlugin as _0x13c85a}from'@univerjs/sheets-hyper-link';import{UniverSheetsHyperLinkUIPlugin as _0x2a87a5}from'@univerjs/sheets-hyper-link-ui';import{UniverSheetsNumfmtPlugin as _0x5a8a75}from'@univerjs/sheets-numfmt';import{UniverSheetsUIPlugin as _0xab427a,getCurrentRangeDisable$ as _0x27ab45}from'@univerjs/sheets-ui';const x=_0x8bb7a6(0x185),w={};function A({ref:_0x3d155d,..._0x138655}){const _0x2a4ad7=_0x8bb7a6,{icon:_0x488ecf,id:_0x48227e,className:_0x222c40,extend:_0x51963e,..._0x628d8c}=_0x138655,_0x2400f8=('univerjs-icon\x20univerjs-icon-'+_0x48227e+'\x20'+(_0x222c40||''))['trim'](),_0x4bca15=_0x562217('_'+si());return F(_0x488ecf,''+_0x48227e,{'defIds':_0x488ecf[_0x2a4ad7(0x195)],'idSuffix':_0x4bca15[_0x2a4ad7(0x178)]},{'ref':_0x3d155d,'className':_0x2400f8,..._0x628d8c},_0x51963e);}function F(_0x4179aa,_0x35363d,_0x21a2c7,_0x5cf68b,_0x395794){const _0x35d2eb=_0x8bb7a6;return _0x57dfaf(_0x4179aa[_0x35d2eb(0x15a)],{'key':_0x35363d,...ni(_0x4179aa,_0x21a2c7,_0x395794),..._0x5cf68b},(oi(_0x4179aa,_0x21a2c7)['children']||[])[_0x35d2eb(0x1a5)]((_0x35163c,_0x497570)=>F(_0x35163c,_0x35363d+'-'+_0x4179aa[_0x35d2eb(0x15a)]+'-'+_0x497570,_0x21a2c7,void 0x0,_0x395794)));}function ni(_0x263fdd,_0x5a4167,_0x1f9f40){const _0x19a68c=_0x8bb7a6,_0x29deae={..._0x263fdd[_0x19a68c(0x1ef)]};_0x1f9f40!=null&&_0x1f9f40[_0x19a68c(0x1b4)]&&_0x29deae[_0x19a68c(0x17e)]===_0x19a68c(0x1b4)&&(_0x29deae[_0x19a68c(0x17e)]=_0x1f9f40['colorChannel1']),_0x263fdd[_0x19a68c(0x15a)]===_0x19a68c(0x1f3)&&_0x29deae['id']&&(_0x29deae['id']=_0x29deae['id']+_0x5a4167[_0x19a68c(0x1dd)]),Object[_0x19a68c(0x162)](_0x29deae)[_0x19a68c(0x1b2)](([_0x543d64,_0x3f9273])=>{const _0x263d22=_0x19a68c;_0x543d64===_0x263d22(0x1f3)&&typeof _0x3f9273==_0x263d22(0x1c0)&&(_0x29deae[_0x543d64]=_0x3f9273[_0x263d22(0x1d2)](/url\(#(.*)\)/,_0x263d22(0x1a2)+_0x5a4167[_0x263d22(0x1dd)]+')'));});const {defIds:_0x8ebd94}=_0x5a4167;return!_0x8ebd94||_0x8ebd94[_0x19a68c(0x1d0)]===0x0||(_0x263fdd[_0x19a68c(0x15a)]==='use'&&_0x29deae[_0x19a68c(0x184)]&&(_0x29deae[_0x19a68c(0x184)]=_0x29deae[_0x19a68c(0x184)]+_0x5a4167['idSuffix']),Object[_0x19a68c(0x162)](_0x29deae)[_0x19a68c(0x1b2)](([_0x29c3d8,_0x244c05])=>{const _0x4cd61a=_0x19a68c;typeof _0x244c05==_0x4cd61a(0x1c0)&&(_0x29deae[_0x29c3d8]=_0x244c05['replace'](/url\(#(.*)\)/,_0x4cd61a(0x1a2)+_0x5a4167[_0x4cd61a(0x1dd)]+')'));})),_0x29deae;}function _0x3800(_0x56f65f,_0x4bf4d1){const _0x278a45=_0x278a();return _0x3800=function(_0x38001c,_0xd81994){_0x38001c=_0x38001c-0x15a;let _0x152b44=_0x278a45[_0x38001c];return _0x152b44;},_0x3800(_0x56f65f,_0x4bf4d1);}function oi(_0x1cdc1a,_0x1f2339){const _0x2ce963=_0x8bb7a6;var _0x13d9ed;const {defIds:_0x4f76f4}=_0x1f2339;return!_0x4f76f4||_0x4f76f4[_0x2ce963(0x1d0)]===0x0?_0x1cdc1a:_0x1cdc1a[_0x2ce963(0x15a)]===_0x2ce963(0x1f0)&&((_0x13d9ed=_0x1cdc1a[_0x2ce963(0x1a4)])!=null&&_0x13d9ed[_0x2ce963(0x1d0)])?{..._0x1cdc1a,'children':_0x1cdc1a['children'][_0x2ce963(0x1a5)](_0x35ae4c=>typeof _0x35ae4c[_0x2ce963(0x1ef)]['id']==_0x2ce963(0x1c0)&&_0x4f76f4&&_0x4f76f4[_0x2ce963(0x171)](_0x35ae4c[_0x2ce963(0x1ef)]['id'])?{..._0x35ae4c,'attrs':{..._0x35ae4c[_0x2ce963(0x1ef)],'id':_0x35ae4c['attrs']['id']+_0x1f2339[_0x2ce963(0x1dd)]}}:_0x35ae4c)}:_0x1cdc1a;}function si(){const _0x3d84a5=_0x8bb7a6;return Math[_0x3d84a5(0x1af)]()[_0x3d84a5(0x19a)](0x24)[_0x3d84a5(0x1c3)](0x2,0x8);}A[_0x8bb7a6(0x1b6)]=_0x8bb7a6(0x18e);const ai={'tag':'svg','attrs':{'xmlns':_0x8bb7a6(0x15f),'fill':_0x8bb7a6(0x17b),'viewBox':'0\x200\x2016\x2016','width':_0x8bb7a6(0x19d),'height':_0x8bb7a6(0x19d)},'children':[{'tag':'g','attrs':{'fill':_0x8bb7a6(0x1c2),'clipPath':'url(#history-icon_clip0_907_281)'},'children':[{'tag':_0x8bb7a6(0x16e),'attrs':{'d':_0x8bb7a6(0x1ad)}},{'tag':_0x8bb7a6(0x16e),'attrs':{'d':'M8.28291\x205.16293C8.28295\x204.83156\x208.01435\x204.5629\x207.68298\x204.56287C7.35161\x204.56283\x207.08295\x204.83143\x207.08291\x205.1628L7.08252\x208.63494C7.0825\x208.79881\x207.1495\x208.95555\x207.26796\x209.06877L9.70073\x2011.3939C9.94029\x2011.6228\x2010.3201\x2011.6142\x2010.549\x2011.3747C10.778\x2011.1351\x2010.7694\x2010.7553\x2010.5298\x2010.5263L8.28255\x208.37852L8.28291\x205.16293Z'}}]},{'tag':_0x8bb7a6(0x1f0),'attrs':{},'children':[{'tag':'clipPath','attrs':{'id':_0x8bb7a6(0x15b)},'children':[{'tag':_0x8bb7a6(0x16e),'attrs':{'fill':'white','d':_0x8bb7a6(0x1b7)}}]}]}],'defIds':['history-icon_clip0_907_281']},j=_0x562777(function(_0x44e8f6,_0x2e939b){const _0x126a66=_0x8bb7a6;return _0x57dfaf(A,Object[_0x126a66(0x1b1)]({},_0x44e8f6,{'id':'history-icon','ref':_0x2e939b,'icon':ai}));});j[_0x8bb7a6(0x1b6)]=_0x8bb7a6(0x1cb);var ci=Object[_0x8bb7a6(0x15e)],li=(_0x2dba7a,_0x53a0ff,_0x55aac3,_0x22bafc)=>{for(var _0x1c1562=_0x22bafc>0x1?void 0x0:_0x22bafc?ci(_0x53a0ff,_0x55aac3):_0x53a0ff,_0x1067c0=_0x2dba7a['length']-0x1,_0x1cf322;_0x1067c0>=0x0;_0x1067c0--)(_0x1cf322=_0x2dba7a[_0x1067c0])&&(_0x1c1562=_0x1cf322(_0x1c1562)||_0x1c1562);return _0x1c1562;},l=(_0x2971a6,_0xa33186)=>(_0x4c4204,_0x39a16b)=>_0xa33186(_0x4c4204,_0x39a16b,_0x2971a6);const ui=_0x8bb7a6(0x198),V=_0x8bb7a6(0x17a),d=_0x8bb7a6(0x173);let f=class extends _0xa54253{constructor(_0x302c01,_0x5cd462,_0x249e1c,_0x3ba6a4,_0x345b0f,_0x2efc73,_0x3ae947,_0x562789,_0x289c9d,_0x212569){const _0x906ebd=_0x8bb7a6;super(),g(this,_0x906ebd(0x19f),new _0x3125bf(null)),g(this,_0x906ebd(0x1f5),this[_0x906ebd(0x19f)]['asObservable']()),g(this,_0x906ebd(0x165),new _0x45d425()),g(this,_0x906ebd(0x160),new Map()),(this['_localeService']=_0x302c01,this[_0x906ebd(0x1a7)]=_0x5cd462,this[_0x906ebd(0x1a8)]=_0x249e1c,this['_commandService']=_0x3ba6a4,this[_0x906ebd(0x174)]=_0x345b0f,this['_permissionService']=_0x2efc73,this['_selectionProtectionRuleModel']=_0x3ae947,this['_dialogService']=_0x562789,this[_0x906ebd(0x194)]=_0x289c9d,this['_themeService']=_0x212569,this['_init']());}get['historyUniver'](){const _0x5f9ba3=_0x8bb7a6;return this[_0x5f9ba3(0x19f)][_0x5f9ba3(0x1de)];}['_init'](){const _0x420f66=_0x8bb7a6;this[_0x420f66(0x1d6)](),this[_0x420f66(0x190)]();}['_initContainer'](){const _0xba743c=_0x8bb7a6;var _0x426449;const _0x521be7=(_0x426449=this['_configService']['getConfig'](V))!=null?_0x426449:ui,_0x4fc3b6=document[_0xba743c(0x15c)](_0x521be7);if(!_0x4fc3b6)return;const _0x36d503=document[_0xba743c(0x196)](_0xba743c(0x1e2));_0x36d503['id']=d,_0x36d503[_0xba743c(0x16f)][_0xba743c(0x1b5)]=_0xba743c(0x1f4),_0x36d503[_0xba743c(0x1e0)][_0xba743c(0x1f8)]='absolute',_0x36d503['style'][_0xba743c(0x1c9)]='0',_0x36d503[_0xba743c(0x1e0)][_0xba743c(0x17f)]='0',_0x36d503[_0xba743c(0x1e0)]['width']='100%',_0x36d503['style']['height']='100%',_0x36d503[_0xba743c(0x1e0)][_0xba743c(0x172)]=_0xba743c(0x1d8),_0x36d503[_0xba743c(0x1e0)]['display']=_0xba743c(0x17b),_0x4fc3b6[_0xba743c(0x1d4)](_0x36d503);}['_initPlugins'](){const _0x2596c5=_0x8bb7a6;var _0x28ac8d;[[_0x31bb65],[_0x156b11,{'container':d,'header':!0x0,'toolbar':!0x1,'footer':!0x0,'contextMenu':!0x1,'override':[[_0x277b1d,null]]}],[_0x207b98],[_0x1a1e5e,{'override':[[_0x317290,null]]}],[_0x110c57,{'hasScroll':!0x1}],[_0x18a68b],[_0x5a8a75],[_0x223cfb,{'notExecuteFormula':!0x0}],[_0xab427a],[_0x9061c],[_0x2309b5],[_0x405b41],[_0x22bd8a],[_0x3e1d7d],[_0x830c42],[_0x5992cf],[_0x13c85a],[_0x2a87a5],[_0x1314a],[_0x3d8eb6],[_0x253507],[_0x9e7a94,{'notExecuteFormula':!0x0}],[_0x95b7e8,{'workerURL':'./worker.js'}],[_0x5d5a05],[_0x583708],[_0x2153cd],[_0x8d8d81],[_0x51c671],[_0x3640c2,{'notExecuteFormula':!0x0}],[_0x39a38e,{'historyListServerUrl':(_0x28ac8d=this['_configService'][_0x2596c5(0x187)](x))==null?void 0x0:_0x28ac8d[_0x2596c5(0x1a0)]}]][_0x2596c5(0x1b2)](([_0x4150ed,_0x47a1fa])=>this[_0x2596c5(0x18b)](_0x4150ed,_0x47a1fa));}[_0x8bb7a6(0x1f2)](){const _0x360a9f=_0x8bb7a6;super[_0x360a9f(0x1f2)](),this[_0x360a9f(0x18a)](),this[_0x360a9f(0x160)][_0x360a9f(0x16d)]();}['registerPlugin'](_0x7865e8,_0x5a8e90,_0x3299e0){const _0x30767f=_0x8bb7a6;if(this['_pluginMap']['has'](_0x7865e8[_0x30767f(0x1c7)])&&!_0x3299e0)throw new Error(_0x30767f(0x1e3)+_0x7865e8[_0x30767f(0x1c7)]+_0x30767f(0x1ed));this[_0x30767f(0x160)][_0x30767f(0x19b)](_0x7865e8[_0x30767f(0x1c7)],[_0x7865e8,_0x5a8e90]);}[_0x8bb7a6(0x1d9)](){const _0x11a7e7=_0x8bb7a6;return Array[_0x11a7e7(0x19e)](this['_pluginMap']['values']());}['mountHistoryContent'](_0x1bf2b2){const _0x1b9aa9=_0x8bb7a6,_0x2f80ec=document[_0x1b9aa9(0x15c)](d);_0x2f80ec&&(_0x2f80ec['style']['display']=_0x1b9aa9(0x164),this['_initUniver'](_0x1bf2b2,d));}[_0x8bb7a6(0x18a)](){const _0x4e634a=_0x8bb7a6;var _0x454f95;this[_0x4e634a(0x165)][_0x4e634a(0x1f2)](),(_0x454f95=this[_0x4e634a(0x188)])==null||_0x454f95[_0x4e634a(0x1f2)](),this[_0x4e634a(0x19f)][_0x4e634a(0x1b3)](null);const _0x4e0527=document[_0x4e634a(0x15c)](d);_0x4e0527&&(_0x4e0527[_0x4e634a(0x1e0)][_0x4e634a(0x1e9)]=_0x4e634a(0x17b));}['_initUniver'](_0x23db17,_0x28958d){const _0x53e2fb=_0x8bb7a6;if(this[_0x53e2fb(0x188)])return;const _0x5e4e05=new _0x35a028({'locales':{[this[_0x53e2fb(0x1a1)][_0x53e2fb(0x1e5)]()]:this[_0x53e2fb(0x1a1)][_0x53e2fb(0x193)]()},'override':[[_0x45364d,{'useClass':_0x487fb0}]]}),_0x2ce234=_0x5e4e05[_0x53e2fb(0x1c4)]();this[_0x53e2fb(0x1c8)](this[_0x53e2fb(0x163)]['darkMode$'][_0x53e2fb(0x1b8)](_0x3dbcb4=>{const _0x2fcbd4=_0x53e2fb;_0x2ce234[_0x2fcbd4(0x16b)](_0x316887)[_0x2fcbd4(0x1bc)](_0x3dbcb4);})),this[_0x53e2fb(0x1c8)](this['_themeService'][_0x53e2fb(0x1ea)]['subscribe'](_0x471d8f=>{_0x2ce234['get'](_0x316887)['setTheme'](_0x471d8f);})),_0x2ce234[_0x53e2fb(0x16b)](_0x52477)[_0x53e2fb(0x180)](this[_0x53e2fb(0x1a1)][_0x53e2fb(0x1e5)]()),_0x2ce234['get'](_0x178247)[_0x53e2fb(0x1ba)](_0x166eb7,this['_configService'][_0x53e2fb(0x187)](_0x166eb7));const _0x3828bb=this['_configService'][_0x53e2fb(0x187)](_0x30abc1);_0x3828bb&&_0x5e4e05[_0x53e2fb(0x18b)](_0x3da585,{'license':_0x3828bb['ls']}),this[_0x53e2fb(0x160)][_0x53e2fb(0x1b2)](([_0x42c2f0,_0x36e689])=>{const _0x3f5d2d=_0x53e2fb;_0x5e4e05[_0x3f5d2d(0x18b)](_0x42c2f0,_0x36e689);}),_0x2ce234[_0x53e2fb(0x1b9)](_0x3d69a7=>{const _0x1446dc=_0x53e2fb;this[_0x1446dc(0x1e4)](_0x3d69a7,_0x23db17);}),this[_0x53e2fb(0x19f)]['next'](_0x5e4e05);const _0x1524ee=_0x2ce234['get'](_0x177e97),_0x4efeb4=this[_0x53e2fb(0x192)](_0x23db17);_0x1524ee['triggerLoadVersions'](_0x23db17,_0x28958d,_0x4efeb4);}['_initListener'](_0x5060fa,_0x2e2c93){const _0x43935d=_0x8bb7a6,_0x18dc51=_0x5060fa['get'](_0x177e97);this[_0x43935d(0x165)]['add'](_0x18dc51[_0x43935d(0x1eb)][_0x43935d(0x1b8)](_0x950b7e=>{const _0x531bdf=_0x43935d;switch(_0x950b7e){case _0x560ee6[_0x531bdf(0x15d)]:this[_0x531bdf(0x19c)][_0x531bdf(0x17c)](),this[_0x531bdf(0x194)][_0x531bdf(0x1cc)]();break;case _0x560ee6[_0x531bdf(0x1a3)]:this['unMountHistoryContent']();break;case _0x560ee6[_0x531bdf(0x177)]:this[_0x531bdf(0x18a)](),this[_0x531bdf(0x174)][_0x531bdf(0x1f6)]({'content':this['_localeService']['t'](_0x531bdf(0x168)),'type':_0x4b7a83[_0x531bdf(0x177)],'duration':0xbb8});break;}})),this[_0x43935d(0x165)][_0x43935d(0x1e8)](_0x18dc51[_0x43935d(0x1ee)][_0x43935d(0x1b8)](async _0x48829c=>{const _0x105cf6=_0x43935d;_0x48829c&&this[_0x105cf6(0x1e6)]['executeCommand'](_0x222df8['id'],{'unitId':_0x2e2c93,'revision':_0x48829c});}));}['_checkCanRevert'](_0x9d250d){const _0x5cfb73=_0x8bb7a6,_0x134ce4=this[_0x5cfb73(0x1a7)][_0x5cfb73(0x1cf)](_0x9d250d)['getSheets']()[_0x5cfb73(0x1a5)](_0x3316f9=>_0x3316f9[_0x5cfb73(0x182)]()),_0x95d8f5=new _0x579dfc(_0x9d250d)['id'],_0x5dc401=_0x134ce4[_0x5cfb73(0x1a5)](_0x2bf9ee=>new _0x3bc8a7(_0x9d250d,_0x2bf9ee)['id']),_0x1f94b3=_0x134ce4[_0x5cfb73(0x1a5)](_0x501f37=>this[_0x5cfb73(0x1c6)][_0x5cfb73(0x1cd)](_0x9d250d,_0x501f37)[_0x5cfb73(0x1a5)](_0x499f13=>new _0x1ce86e(_0x9d250d,_0x501f37,_0x499f13[_0x5cfb73(0x1be)])['id']))[_0x5cfb73(0x1bd)](),_0x56cfd6=new _0x388343(_0x9d250d)['id'];return this[_0x5cfb73(0x1e7)][_0x5cfb73(0x18c)]([_0x95d8f5,..._0x5dc401,..._0x1f94b3,_0x56cfd6])[_0x5cfb73(0x161)](_0x463ad0=>!!_0x463ad0['value']);}};f=li([l(0x0,_0x1f768c(_0x52477)),l(0x1,_0x501951),l(0x2,_0x178247),l(0x3,_0x5221cb),l(0x4,_0x1d689d),l(0x5,_0x2ec47e),l(0x6,_0x1f768c(_0x5c75a3)),l(0x7,_0x1f768c(_0x277b1d)),l(0x8,_0x1f768c(_0x539aa6)),l(0x9,_0x1f768c(_0x316887))],f);const b={'id':_0x8bb7a6(0x1aa),'type':_0x2940f7[_0x8bb7a6(0x179)],'handler':_0x355d85=>{const _0x4e4640=_0x8bb7a6,_0xa256ce=_0x355d85[_0x4e4640(0x16b)](f),_0x19c514=_0x355d85[_0x4e4640(0x16b)](_0x501951),{unitId:_0x558a6d}=_0x514349(_0x19c514)||{};return _0x558a6d?(_0xa256ce[_0x4e4640(0x1c5)](_0x558a6d),!0x0):!0x1;}};function hi(_0x2ede0a){const _0x41c63f=_0x8bb7a6;return{'id':b['id'],'type':_0x32ca06['BUTTON'],'icon':'HistoryIcon','tooltip':'editHistory.panel.title','hidden$':_0x4e41ed(_0x2ede0a,_0x203456[_0x41c63f(0x197)]),'disabled$':_0x27ab45(_0x2ede0a,{'workbookTypes':[_0x579dfc,_0x9e37ba],'worksheetTypes':[],'rangeTypes':[]})};}const gi={[_0x1765c9[_0x8bb7a6(0x1bb)]]:{[b['id']]:{'order':0.2,'menuItemFactory':hi}}};var mi=Object[_0x8bb7a6(0x15e)],vi=(_0x32a0e2,_0x35e387,_0x4779cf,_0x1b9395)=>{const _0x5effd5=_0x8bb7a6;for(var _0x1513b0=_0x1b9395>0x1?void 0x0:_0x1b9395?mi(_0x35e387,_0x4779cf):_0x35e387,_0x273e00=_0x32a0e2[_0x5effd5(0x1d0)]-0x1,_0xc1474c;_0x273e00>=0x0;_0x273e00--)(_0xc1474c=_0x32a0e2[_0x273e00])&&(_0x1513b0=_0xc1474c(_0x1513b0)||_0x1513b0);return _0x1513b0;},m=(_0x2f7351,_0x434978)=>(_0xd5b719,_0x4b12c6)=>_0x434978(_0xd5b719,_0x4b12c6,_0x2f7351);let p=class extends _0x6540af{constructor(_0x21e145,_0x52dae4,_0x1a6e6a,_0x3c536b,_0x40ee08,_0x24da57,_0x4d53e6,_0x4876d7){const _0x6cb388=_0x8bb7a6;super(),g(this,_0x6cb388(0x175),null),(this[_0x6cb388(0x1e6)]=_0x21e145,this['_menuManagerService']=_0x52dae4,this['_componentManager']=_0x1a6e6a,this[_0x6cb388(0x1e1)]=_0x3c536b,this[_0x6cb388(0x1a1)]=_0x40ee08,this[_0x6cb388(0x174)]=_0x24da57,this['_collaborationController']=_0x4d53e6,this[_0x6cb388(0x1ce)]=_0x4876d7,this[_0x6cb388(0x17d)]());}[_0x8bb7a6(0x17d)](){const _0x240866=_0x8bb7a6;[b][_0x240866(0x1b2)](_0x51228a=>this[_0x240866(0x1c8)](_0x25cc2a(this[_0x240866(0x1e6)][_0x240866(0x1f7)](_0x51228a)))),this[_0x240866(0x1c8)](this[_0x240866(0x1a6)][_0x240866(0x1b0)]('HistoryIcon',j)),this['_menuManagerService'][_0x240866(0x1bf)](gi),this[_0x240866(0x1c8)](this[_0x240866(0x1e6)][_0x240866(0x1da)](_0x1b03b2=>{const _0xe031e9=_0x240866;if(_0x1b03b2['id']===_0x222df8['id']){this[_0xe031e9(0x174)][_0xe031e9(0x1f6)]({'content':this[_0xe031e9(0x1a1)]['t']('editHistory.panel.reverting'),'type':_0x4b7a83['Loading'],'duration':0x1388});const {unitId:_0x4b09d9}=_0x1b03b2[_0xe031e9(0x1dc)],_0x572594=this[_0xe031e9(0x1db)]['getCollabEntity'](_0x4b09d9),_0x283780=_0x1c87f2([_0x572594[_0xe031e9(0x1c1)][_0xe031e9(0x167)],_0x572594['state$']])['subscribe'](async([_0x6ff2fe,_0x104edc])=>{const _0x3e3dfb=_0xe031e9;var _0x4075cf;_0x6ff2fe[_0x3e3dfb(0x1d1)]===_0x14f5f6[_0x3e3dfb(0x16c)]&&(_0x104edc==null?void 0x0:_0x104edc['status'])===_0x3420ff['SYNCED']&&_0x6ff2fe[_0x3e3dfb(0x169)][_0x3e3dfb(0x1ac)][_0x3e3dfb(0x1d7)](_0xc802e3=>_0xc802e3['id']===_0x222df8['id'])&&(this[_0x3e3dfb(0x1e1)][_0x3e3dfb(0x18a)](),_0x283780[_0x3e3dfb(0x181)](),this['_revertErrorTimer']&&clearTimeout(this[_0x3e3dfb(0x175)]),await((_0x4075cf=this['_localCacheService'])==null?void 0x0:_0x4075cf[_0x3e3dfb(0x1ec)]()),setTimeout(()=>window[_0x3e3dfb(0x1ca)]['reload']()));});this[_0xe031e9(0x175)]=setTimeout(()=>{const _0x3a5149=_0xe031e9;_0x283780[_0x3a5149(0x181)](),this[_0x3a5149(0x174)]['show']({'content':this[_0x3a5149(0x1a1)]['t'](_0x3a5149(0x170)),'type':_0x4b7a83[_0x3a5149(0x177)],'duration':0xbb8});},0x1388);}}));}};p=vi([m(0x0,_0x5221cb),m(0x1,_0x5942bf),m(0x2,_0x1f768c(_0x2c5d20)),m(0x3,_0x1f768c(f)),m(0x4,_0x1f768c(_0x52477)),m(0x5,_0x1d689d),m(0x6,_0x1f768c(_0x358892)),m(0x7,_0x4f1483)],p);var di=Object['getOwnPropertyDescriptor'],fi=(_0x4190d9,_0x157533,_0x20e151,_0x9749ad)=>{for(var _0x16c75f=_0x9749ad>0x1?void 0x0:_0x9749ad?di(_0x157533,_0x20e151):_0x157533,_0x4a9d0b=_0x4190d9['length']-0x1,_0x40c2f9;_0x4a9d0b>=0x0;_0x4a9d0b--)(_0x40c2f9=_0x4190d9[_0x4a9d0b])&&(_0x16c75f=_0x40c2f9(_0x16c75f)||_0x16c75f);return _0x16c75f;},R=(_0x564541,_0x1a95a2)=>(_0x5b58b2,_0x11c0ae)=>_0x1a95a2(_0x5b58b2,_0x11c0ae,_0x564541);const _i=_0x8bb7a6(0x189);var _;let N=(_=class extends _0x50a047{constructor(_0x33cc89=w,_0x139ee5,_0x504ed1){const _0x5e81c2=_0x8bb7a6;super(),this[_0x5e81c2(0x1df)]=_0x33cc89,this[_0x5e81c2(0x191)]=_0x139ee5,this['_configService']=_0x504ed1;const {menu:_0x2feeae,..._0x51b199}=_0x41cd19({},w,this[_0x5e81c2(0x1df)]);_0x2feeae&&this['_configService'][_0x5e81c2(0x1ba)]('menu',_0x2feeae,{'merge':!0x0}),this[_0x5e81c2(0x1a8)][_0x5e81c2(0x1ba)](x,_0x51b199),this[_0x5e81c2(0x1df)][_0x5e81c2(0x16a)]&&this[_0x5e81c2(0x1a8)]['setConfig'](V,this[_0x5e81c2(0x1df)]['univerContainerId']);}[_0x8bb7a6(0x1f1)](){const _0x5dc805=_0x8bb7a6;[[f],[p]][_0x5dc805(0x1b2)](_0x47aafe=>this[_0x5dc805(0x191)][_0x5dc805(0x1e8)](_0x47aafe));}['onSteady'](){const _0x5a0766=_0x8bb7a6;this[_0x5a0766(0x191)][_0x5a0766(0x16b)](p);}},g(_,'type',_0x203456[_0x8bb7a6(0x1ab)]),g(_,'pluginName',_i),_);N=fi([R(0x1,_0x1f768c(_0x41375a)),R(0x2,_0x178247)],N);export{f as HistoryLoaderService,V as UNIVER_CONTAINER_ID_KEY,d as UNIVER_HISTORY_CONTAINER_ID,N as UniverEditHistoryLoaderPlugin};