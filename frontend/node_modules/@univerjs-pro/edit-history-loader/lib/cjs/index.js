'use strict';const _0x58cc96=_0x4e00;(function(_0x15dba4,_0x3013bf){const _0x127a6e=_0x4e00,_0x1e0856=_0x15dba4();while(!![]){try{const _0x288d96=-parseInt(_0x127a6e(0x101))/0x1+-parseInt(_0x127a6e(0x10f))/0x2*(parseInt(_0x127a6e(0x120))/0x3)+-parseInt(_0x127a6e(0x19e))/0x4+-parseInt(_0x127a6e(0x158))/0x5*(parseInt(_0x127a6e(0x11e))/0x6)+-parseInt(_0x127a6e(0x12c))/0x7*(parseInt(_0x127a6e(0xef))/0x8)+parseInt(_0x127a6e(0x137))/0x9*(parseInt(_0x127a6e(0x1d3))/0xa)+parseInt(_0x127a6e(0x13b))/0xb;if(_0x288d96===_0x3013bf)break;else _0x1e0856['push'](_0x1e0856['shift']());}catch(_0x4c24d3){_0x1e0856['push'](_0x1e0856['shift']());}}}(_0x5488,0x9d816));function _0x5488(){const _0x1a5f1c=['Error','UniverSheetsDrawingPlugin','editHistory.panel.revertFailed','current','univer-history-container','UniverRPCMainThreadPlugin','IMessageService','_dialogService','createElement','getAllPlugins','UniverInstanceType','onCommandExecuted','_injector','getConfig','onStarting','uComp','Plugin','univerContainerId','length','none','1000','idSuffix','HistoryModeStatus','show','_initContainer','menu','url(#history-icon_clip0_907_281)','[HistoryLoaderService]:\x20Plugin\x20','defIds','UniverEditHistoryLoaderPlugin','UniverDataValidationPlugin','MenuItemType','closeAll','__getInjector','RibbonStartGroup','displayName','./worker.js','OPERATION','OTHERS','eventID','_historyUniver$','UniverSheetsPlugin','ICommandService','every','RevertRevisionMutation','UNIVER_HISTORY_CONTAINER_ID','historyUniver$','UniverDocsPlugin','UniverEditHistoryViewerPlugin','M0\x200H16V16H0z','permissionId','UniverSheetsHyperLinkUIPlugin','COLLABORATION_CLIENT_PLUGIN_CONFIG_KEY','getSheetCommandTarget','_historyManagerService','AuthzIoHttpService','registerPlugin','UNIVER_UNKNOWN','CommandType','getCollabEntity','1768304eVKVwK','revertRevision$','WorkbookRecoverHistoryPermission','IDialogService','style','univer-container','UniverSheetsFormulaPlugin','triggerLoadVersions','unsubscribe','subscribe','value','setDarkMode','ThemeService','getCurrentLocale','ComponentManager','flat','UniverSheetsConditionalFormattingPlugin','string','_componentManager','darkMode$','location','random','RangeProtectionPermissionEditPoint','WorkbookEditablePermission','getSheets','BUTTON','ILocalCacheService','M4.45388\x204.14989H3.52896C4.61144\x202.8939\x206.21319\x202.0999\x207.9999\x202.0999C11.2584\x202.0999\x2013.8999\x204.74142\x2013.8999\x207.9999C13.8999\x2011.2584\x2011.2584\x2013.8999\x207.9999\x2013.8999C4.74142\x2013.8999\x202.0999\x2011.2584\x202.0999\x207.9999C2.0999\x207.66853\x201.83127\x207.3999\x201.4999\x207.3999C1.16853\x207.3999\x200.899902\x207.66853\x200.899902\x207.9999C0.899902\x2011.9211\x204.07868\x2015.0999\x207.9999\x2015.0999C11.9211\x2015.0999\x2015.0999\x2011.9211\x2015.0999\x207.9999C15.0999\x204.07868\x2011.9211\x200.899902\x207.9999\x200.899902C5.88709\x200.899902\x203.9903\x201.82298\x202.69023\x203.28636V2.38625C2.69023\x202.05488\x202.42161\x201.78625\x202.09023\x201.78625C1.75886\x201.78625\x201.49023\x202.05488\x201.49023\x202.38625V4.74989C1.49023\x205.08126\x201.75886\x205.34989\x202.09023\x205.34989H4.45388C4.78525\x205.34989\x205.05388\x205.08126\x205.05388\x204.74989C5.05388\x204.41851\x204.78525\x204.14989\x204.45388\x204.14989Z','UniverSheetSparklineUIPlugin','historyListServerUrl','UniverSheetsConditionalFormattingUIPlugin','use','UNIVER_EDIT_HISTORY_LOADER_PLUGIN','history-container','add','UniverDrawingUIPlugin','_messageService','_initPlugins','LocaleService','getCurrentRangeDisable$','_revertErrorTimer','url(#$1','defs','UniverSheetsUIPlugin','_initListener','UniverSheetsDataValidationPlugin','getOwnPropertyDescriptor','univerjs-icon\x20univerjs-icon-','WorksheetEditPermission','SYNCED','status$','UNIVER_CONTAINER_ID','forwardRef','30IBeNXq','_themeService','composePermission','unMountHistoryContent','useRef','children','dispose','CollaborationEvent','univer.operation.toggle-edit-history','zIndex','symbol','_checkCanRevert','UniverDrawingPlugin','map','close','8lBMlzu','xlink:href','LS_CONFIG_KEY','edit-history-loader.config','UniverSheetSparklinePlugin','historyUniver','replace','1em','values','type','toString','setLocale','includes','Inject','width','fill','next','editHistory.panel.title','818282QqlwfX','data','BehaviorSubject','Univer','HistoryLoaderService','CollaborationController','IMenuManagerService','RangeProtectionRuleModel','UniverLicensePlugin','UniverSheetsDataValidationUIPlugin','_menuManagerService','dataset','getSubunitRuleList','UniverSheetsDrawingUIPlugin','534DAXqzv','colorChannel1','http://www.w3.org/2000/svg','Entered','_permissionService','ISidebarService','assign','_configService','_localeService','has','_commandService','currentColor','_localCacheService','MessageType','Exited','780UeVqPp','pluginName','6243sSzsmc','UniverSheetsFormulaUIPlugin','get','tag','IUniverInstanceService','UniverSheetsPivotTablePlugin','UniverDocsUIPlugin','IConfigService','_disposableCollection','editHistory.panel.listFetchError','100%','UniverSheetsFilterUIPlugin','5959534VCRKtx','_selectionProtectionRuleModel','clipPath','currentTheme$','history-icon_clip0_907_281','IAuthzIoService','_init','exhaustSavingTask','CHANGESET_ACK','_collaborationController','UniverFormulaEnginePlugin','243171lIoOBU','event$','attrs','appendChild','42585642hxCgza','Module','_config','_initUniver','forEach','set','UNIVER_CONTAINER_ID_KEY','clear','setConfig','mask','Injector','toStringTag','HistoryManagerService','absolute','_sidebarService','defineProperty','registerCommand','getElementById','setTheme','white','RxDisposable','invoke','_pluginMap','disposeWithMe','0\x200\x2016\x2016','merge','svg','display','mountHistoryContent','24615GSbFmP','UniverSheetsNumfmtPlugin','WorkbookViewHistoryPermission','M8.28291\x205.16293C8.28295\x204.83156\x208.01435\x204.5629\x207.68298\x204.56287C7.35161\x204.56283\x207.08295\x204.83143\x207.08291\x205.1628L7.08252\x208.63494C7.0825\x208.79881\x207.1495\x208.95555\x207.26796\x209.06877L9.70073\x2011.3939C9.94029\x2011.6228\x2010.3201\x2011.6142\x2010.549\x2011.3747C10.778\x2011.1351\x2010.7694\x2010.7553\x2010.5298\x2010.5263L8.28255\x208.37852L8.28291\x205.16293Z','div','state$','params','\x20has\x20been\x20registered.','HistoryIcon','UniverSheetsFilterPlugin'];_0x5488=function(){return _0x1a5f1c;};return _0x5488();}function _0x4e00(_0x3a435c,_0x22e4b2){const _0x5488e1=_0x5488();return _0x4e00=function(_0x4e00a2,_0x44e27d){_0x4e00a2=_0x4e00a2-0xe8;let _0x460492=_0x5488e1[_0x4e00a2];return _0x460492;},_0x4e00(_0x3a435c,_0x22e4b2);}var j=Object[_0x58cc96(0x14a)],F=(_0x2f552a,_0x4dcc12,_0x37ccc2)=>_0x4dcc12 in _0x2f552a?j(_0x2f552a,_0x4dcc12,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0x37ccc2}):_0x2f552a[_0x4dcc12]=_0x37ccc2,_=(_0x48748b,_0x326c7a,_0x35984e)=>F(_0x48748b,typeof _0x326c7a!=_0x58cc96(0xea)?_0x326c7a+'':_0x326c7a,_0x35984e);Object[_0x58cc96(0x14a)](exports,Symbol[_0x58cc96(0x146)],{'value':_0x58cc96(0x13c)});const o=require('@univerjs/core'),I=require('@univerjs-pro/collaboration'),f=require('@univerjs-pro/collaboration-client'),b=require('@univerjs/design'),U=require('react'),h=require('@univerjs/ui'),T=require('rxjs'),d=require('@univerjs/sheets'),m=require('@univerjs-pro/edit-history-viewer'),H=require('@univerjs-pro/license'),x=require('@univerjs-pro/sheets-pivot'),A=require('@univerjs-pro/sheets-sparkline'),V=require('@univerjs-pro/sheets-sparkline-ui'),G=require('@univerjs/data-validation'),W=require('@univerjs/docs'),Y=require('@univerjs/docs-ui'),L=require('@univerjs/drawing'),B=require('@univerjs/drawing-ui'),K=require('@univerjs/engine-formula'),z=require('@univerjs/engine-render'),Z=require('@univerjs/network'),J=require('@univerjs/rpc'),Q=require('@univerjs/sheets-conditional-formatting'),X=require('@univerjs/sheets-conditional-formatting-ui'),ee=require('@univerjs/sheets-data-validation'),ie=require('@univerjs/sheets-data-validation-ui'),te=require('@univerjs/sheets-drawing'),re=require('@univerjs/sheets-drawing-ui'),ne=require('@univerjs/sheets-filter'),se=require('@univerjs/sheets-filter-ui'),oe=require('@univerjs/sheets-formula'),ae=require('@univerjs/sheets-formula-ui'),ce=require('@univerjs/sheets-hyper-link'),le=require('@univerjs/sheets-hyper-link-ui'),ue=require('@univerjs/sheets-numfmt'),w=require('@univerjs/sheets-ui'),O=_0x58cc96(0xf2),R={};function k({ref:_0x2fc2e1,..._0x381e62}){const _0x4381b3=_0x58cc96,{icon:_0x3044d8,id:_0x1f98c6,className:_0x507ee0,extend:_0x3b3803,..._0x3033cc}=_0x381e62,_0x2a133d=(_0x4381b3(0x1cd)+_0x1f98c6+'\x20'+(_0x507ee0||''))['trim'](),_0x595b9f=U[_0x4381b3(0x1d7)]('_'+ve());return D(_0x3044d8,''+_0x1f98c6,{'defIds':_0x3044d8[_0x4381b3(0x17e)],'idSuffix':_0x595b9f[_0x4381b3(0x165)]},{'ref':_0x2fc2e1,'className':_0x2a133d,..._0x3033cc},_0x3b3803);}function D(_0x494dac,_0x250d16,_0x2601d6,_0x2d67bb,_0x47082b){const _0x105d27=_0x58cc96;return U[_0x105d27(0x16a)](_0x494dac[_0x105d27(0x123)],{'key':_0x250d16,...he(_0x494dac,_0x2601d6,_0x47082b),..._0x2d67bb},(ge(_0x494dac,_0x2601d6)[_0x105d27(0x1d8)]||[])[_0x105d27(0xed)]((_0x83bb35,_0x35d0ff)=>D(_0x83bb35,_0x250d16+'-'+_0x494dac[_0x105d27(0x123)]+'-'+_0x35d0ff,_0x2601d6,void 0x0,_0x47082b)));}function he(_0x2da668,_0x2c5fe4,_0x43bc71){const _0x3a8b0c=_0x58cc96,_0x579b4f={..._0x2da668['attrs']};_0x43bc71!=null&&_0x43bc71[_0x3a8b0c(0x110)]&&_0x579b4f['fill']==='colorChannel1'&&(_0x579b4f[_0x3a8b0c(0xfe)]=_0x43bc71[_0x3a8b0c(0x110)]),_0x2da668[_0x3a8b0c(0x123)]==='mask'&&_0x579b4f['id']&&(_0x579b4f['id']=_0x579b4f['id']+_0x2c5fe4[_0x3a8b0c(0x177)]),Object['entries'](_0x579b4f)[_0x3a8b0c(0x13f)](([_0x31a208,_0x20bb29])=>{const _0x518aa8=_0x3a8b0c;_0x31a208===_0x518aa8(0x144)&&typeof _0x20bb29==_0x518aa8(0x1af)&&(_0x579b4f[_0x31a208]=_0x20bb29[_0x518aa8(0xf5)](/url\(#(.*)\)/,'url(#$1'+_0x2c5fe4['idSuffix']+')'));});const {defIds:_0x1e4813}=_0x2c5fe4;return!_0x1e4813||_0x1e4813[_0x3a8b0c(0x174)]===0x0||(_0x2da668[_0x3a8b0c(0x123)]===_0x3a8b0c(0x1bd)&&_0x579b4f[_0x3a8b0c(0xf0)]&&(_0x579b4f[_0x3a8b0c(0xf0)]=_0x579b4f[_0x3a8b0c(0xf0)]+_0x2c5fe4['idSuffix']),Object['entries'](_0x579b4f)[_0x3a8b0c(0x13f)](([_0x3d2ed1,_0x7143d6])=>{const _0x33bd64=_0x3a8b0c;typeof _0x7143d6==_0x33bd64(0x1af)&&(_0x579b4f[_0x3d2ed1]=_0x7143d6[_0x33bd64(0xf5)](/url\(#(.*)\)/,_0x33bd64(0x1c7)+_0x2c5fe4[_0x33bd64(0x177)]+')'));})),_0x579b4f;}function ge(_0x2b468f,_0x72ad1c){const _0x5e55bd=_0x58cc96;var _0x21fd38;const {defIds:_0x2df8e4}=_0x72ad1c;return!_0x2df8e4||_0x2df8e4['length']===0x0?_0x2b468f:_0x2b468f[_0x5e55bd(0x123)]===_0x5e55bd(0x1c8)&&((_0x21fd38=_0x2b468f[_0x5e55bd(0x1d8)])!=null&&_0x21fd38[_0x5e55bd(0x174)])?{..._0x2b468f,'children':_0x2b468f[_0x5e55bd(0x1d8)][_0x5e55bd(0xed)](_0x262563=>typeof _0x262563['attrs']['id']==_0x5e55bd(0x1af)&&_0x2df8e4&&_0x2df8e4[_0x5e55bd(0xfb)](_0x262563[_0x5e55bd(0x139)]['id'])?{..._0x262563,'attrs':{..._0x262563[_0x5e55bd(0x139)],'id':_0x262563[_0x5e55bd(0x139)]['id']+_0x72ad1c[_0x5e55bd(0x177)]}}:_0x262563)}:_0x2b468f;}function ve(){const _0x2dc560=_0x58cc96;return Math[_0x2dc560(0x1b3)]()[_0x2dc560(0xf9)](0x24)['substring'](0x2,0x8);}k[_0x58cc96(0x185)]='UniverIcon';const de={'tag':_0x58cc96(0x155),'attrs':{'xmlns':_0x58cc96(0x111),'fill':_0x58cc96(0x175),'viewBox':_0x58cc96(0x153),'width':_0x58cc96(0xf6),'height':_0x58cc96(0xf6)},'children':[{'tag':'g','attrs':{'fill':_0x58cc96(0x11a),'clipPath':_0x58cc96(0x17c)},'children':[{'tag':'path','attrs':{'d':_0x58cc96(0x1b9)}},{'tag':'path','attrs':{'d':_0x58cc96(0x15b)}}]},{'tag':_0x58cc96(0x1c8),'attrs':{},'children':[{'tag':_0x58cc96(0x12e),'attrs':{'id':_0x58cc96(0x130)},'children':[{'tag':'path','attrs':{'fill':_0x58cc96(0x14e),'d':_0x58cc96(0x193)}}]}]}],'defIds':[_0x58cc96(0x130)]},q=U[_0x58cc96(0x1d2)](function(_0x1ef6af,_0x559778){const _0x17b2b5=_0x58cc96;return U['createElement'](k,Object[_0x17b2b5(0x115)]({},_0x1ef6af,{'id':'history-icon','ref':_0x559778,'icon':de}));});q['displayName']=_0x58cc96(0x160);var _e=Object[_0x58cc96(0x1cc)],Se=(_0x405e3f,_0x12c899,_0x446824,_0x1b9b4f)=>{for(var _0x37cbc3=_0x1b9b4f>0x1?void 0x0:_0x1b9b4f?_e(_0x12c899,_0x446824):_0x12c899,_0x271240=_0x405e3f['length']-0x1,_0x242aa3;_0x271240>=0x0;_0x271240--)(_0x242aa3=_0x405e3f[_0x271240])&&(_0x37cbc3=_0x242aa3(_0x37cbc3)||_0x37cbc3);return _0x37cbc3;},g=(_0x3cefc5,_0x1124cc)=>(_0x4597b1,_0x3b5596)=>_0x1124cc(_0x4597b1,_0x3b5596,_0x3cefc5);const me=_0x58cc96(0x1a3),P=_0x58cc96(0x1d1),y=_0x58cc96(0x166);exports[_0x58cc96(0x105)]=class extends o['Disposable']{constructor(_0x4c6692,_0x1b4a04,_0xaa1b9f,_0x30002d,_0x3c3444,_0x1751c2,_0x3b04bf,_0x978d70,_0x295d5f,_0x366c03){const _0x2a06ba=_0x58cc96;super(),_(this,_0x2a06ba(0x18a),new T[(_0x2a06ba(0x103))](null)),_(this,_0x2a06ba(0x190),this[_0x2a06ba(0x18a)]['asObservable']()),_(this,_0x2a06ba(0x128),new o['DisposableCollection']()),_(this,_0x2a06ba(0x151),new Map()),(this[_0x2a06ba(0x117)]=_0x4c6692,this['_univerInstanceService']=_0x1b4a04,this[_0x2a06ba(0x116)]=_0xaa1b9f,this[_0x2a06ba(0x119)]=_0x30002d,this[_0x2a06ba(0x1c2)]=_0x3c3444,this[_0x2a06ba(0x113)]=_0x1751c2,this[_0x2a06ba(0x12d)]=_0x3b04bf,this[_0x2a06ba(0x169)]=_0x978d70,this[_0x2a06ba(0x149)]=_0x295d5f,this[_0x2a06ba(0x1d4)]=_0x366c03,this[_0x2a06ba(0x132)]());}get['historyUniver'](){const _0x12e0f4=_0x58cc96;return this[_0x12e0f4(0x18a)][_0x12e0f4(0x1a8)];}[_0x58cc96(0x132)](){const _0x41cda7=_0x58cc96;this[_0x41cda7(0x17a)](),this['_initPlugins']();}[_0x58cc96(0x17a)](){const _0x3d61f0=_0x58cc96;var _0x7933bf;const _0x2e04ff=(_0x7933bf=this[_0x3d61f0(0x116)][_0x3d61f0(0x16f)](P))!=null?_0x7933bf:me,_0x300f66=document[_0x3d61f0(0x14c)](_0x2e04ff);if(!_0x300f66)return;const _0x29f72e=document[_0x3d61f0(0x16a)](_0x3d61f0(0x15c));_0x29f72e['id']=y,_0x29f72e[_0x3d61f0(0x10c)][_0x3d61f0(0x171)]=_0x3d61f0(0x1bf),_0x29f72e[_0x3d61f0(0x1a2)]['position']=_0x3d61f0(0x148),_0x29f72e[_0x3d61f0(0x1a2)]['top']='0',_0x29f72e[_0x3d61f0(0x1a2)]['left']='0',_0x29f72e[_0x3d61f0(0x1a2)][_0x3d61f0(0xfd)]=_0x3d61f0(0x12a),_0x29f72e['style']['height']='100%',_0x29f72e[_0x3d61f0(0x1a2)][_0x3d61f0(0xe9)]=_0x3d61f0(0x176),_0x29f72e[_0x3d61f0(0x1a2)]['display']=_0x3d61f0(0x175),_0x300f66[_0x3d61f0(0x13a)](_0x29f72e);}[_0x58cc96(0x1c3)](){const _0x5c9742=_0x58cc96;var _0xdbf349;[[z['UniverRenderEnginePlugin']],[h['UniverUIPlugin'],{'container':y,'header':!0x0,'toolbar':!0x1,'footer':!0x0,'contextMenu':!0x1,'override':[[h[_0x5c9742(0x1a1)],null]]}],[Z['UniverNetworkPlugin']],[L[_0x5c9742(0xec)],{'override':[[L['IImageIoService'],null]]}],[W[_0x5c9742(0x191)],{'hasScroll':!0x1}],[Y[_0x5c9742(0x126)]],[ue[_0x5c9742(0x159)]],[d[_0x5c9742(0x18b)],{'notExecuteFormula':!0x0}],[w[_0x5c9742(0x1c9)]],[oe[_0x5c9742(0x1a4)]],[ae[_0x5c9742(0x121)]],[I['UniverCollaborationPlugin']],[ne[_0x5c9742(0x161)]],[se[_0x5c9742(0x12b)]],[Q[_0x5c9742(0x1ae)]],[X[_0x5c9742(0x1bc)]],[ce['UniverSheetsHyperLinkPlugin']],[le[_0x5c9742(0x195)]],[G[_0x5c9742(0x180)]],[ee[_0x5c9742(0x1cb)]],[ie[_0x5c9742(0x10a)]],[K[_0x5c9742(0x136)],{'notExecuteFormula':!0x0}],[J[_0x5c9742(0x167)],{'workerURL':_0x5c9742(0x186)}],[B[_0x5c9742(0x1c1)]],[te[_0x5c9742(0x163)]],[re[_0x5c9742(0x10e)]],[A[_0x5c9742(0xf3)]],[V[_0x5c9742(0x1ba)]],[x[_0x5c9742(0x125)],{'notExecuteFormula':!0x0}],[m[_0x5c9742(0x192)],{'historyListServerUrl':(_0xdbf349=this[_0x5c9742(0x116)]['getConfig'](O))==null?void 0x0:_0xdbf349[_0x5c9742(0x1bb)]}]]['forEach'](([_0x57a72d,_0x42ba23])=>this[_0x5c9742(0x19a)](_0x57a72d,_0x42ba23));}[_0x58cc96(0x1d9)](){const _0x780805=_0x58cc96;super[_0x780805(0x1d9)](),this[_0x780805(0x1d6)](),this[_0x780805(0x151)][_0x780805(0x142)]();}[_0x58cc96(0x19a)](_0x31d762,_0x33084b,_0x509bef){const _0x2aba04=_0x58cc96;if(this[_0x2aba04(0x151)][_0x2aba04(0x118)](_0x31d762[_0x2aba04(0x11f)])&&!_0x509bef)throw new Error(_0x2aba04(0x17d)+_0x31d762['pluginName']+_0x2aba04(0x15f));this[_0x2aba04(0x151)][_0x2aba04(0x140)](_0x31d762['pluginName'],[_0x31d762,_0x33084b]);}[_0x58cc96(0x16b)](){const _0x561f9a=_0x58cc96;return Array['from'](this[_0x561f9a(0x151)][_0x561f9a(0xf7)]());}[_0x58cc96(0x157)](_0x302ba2){const _0x2a1158=_0x58cc96,_0x5b52b8=document[_0x2a1158(0x14c)](y);_0x5b52b8&&(_0x5b52b8[_0x2a1158(0x1a2)]['display']='block',this[_0x2a1158(0x13e)](_0x302ba2,y));}[_0x58cc96(0x1d6)](){const _0x9d13e0=_0x58cc96;var _0x2c2b6b;this['_disposableCollection'][_0x9d13e0(0x1d9)](),(_0x2c2b6b=this['historyUniver'])==null||_0x2c2b6b['dispose'](),this[_0x9d13e0(0x18a)][_0x9d13e0(0xff)](null);const _0x59e752=document[_0x9d13e0(0x14c)](y);_0x59e752&&(_0x59e752['style'][_0x9d13e0(0x156)]=_0x9d13e0(0x175));}[_0x58cc96(0x13e)](_0x1cbd4a,_0x5e62eb){const _0x2b9675=_0x58cc96;if(this[_0x2b9675(0xf4)])return;const _0x4454c7=new o[(_0x2b9675(0x104))]({'locales':{[this[_0x2b9675(0x117)][_0x2b9675(0x1ab)]()]:this[_0x2b9675(0x117)]['getLocales']()},'override':[[o[_0x2b9675(0x131)],{'useClass':f[_0x2b9675(0x199)]}]]}),_0x13f75d=_0x4454c7[_0x2b9675(0x183)]();this[_0x2b9675(0x152)](this[_0x2b9675(0x1d4)][_0x2b9675(0x1b1)][_0x2b9675(0x1a7)](_0x2e473b=>{const _0x5c57cf=_0x2b9675;_0x13f75d[_0x5c57cf(0x122)](o[_0x5c57cf(0x1aa)])[_0x5c57cf(0x1a9)](_0x2e473b);})),this['disposeWithMe'](this[_0x2b9675(0x1d4)][_0x2b9675(0x12f)][_0x2b9675(0x1a7)](_0x39dcaf=>{const _0x17ca76=_0x2b9675;_0x13f75d[_0x17ca76(0x122)](o[_0x17ca76(0x1aa)])[_0x17ca76(0x14d)](_0x39dcaf);})),_0x13f75d[_0x2b9675(0x122)](o[_0x2b9675(0x1c4)])[_0x2b9675(0xfa)](this[_0x2b9675(0x117)][_0x2b9675(0x1ab)]()),_0x13f75d[_0x2b9675(0x122)](o['IConfigService'])[_0x2b9675(0x143)](f[_0x2b9675(0x196)],this[_0x2b9675(0x116)][_0x2b9675(0x16f)](f[_0x2b9675(0x196)]));const _0x12f357=this['_configService'][_0x2b9675(0x16f)](H[_0x2b9675(0xf1)]);_0x12f357&&_0x4454c7[_0x2b9675(0x19a)](H[_0x2b9675(0x109)],{'license':_0x12f357['ls']}),this[_0x2b9675(0x151)][_0x2b9675(0x13f)](([_0x4d90d5,_0x9789f7])=>{_0x4454c7['registerPlugin'](_0x4d90d5,_0x9789f7);}),_0x13f75d[_0x2b9675(0x150)](_0x590d40=>{const _0x189a65=_0x2b9675;this[_0x189a65(0x1ca)](_0x590d40,_0x1cbd4a);}),this['_historyUniver$'][_0x2b9675(0xff)](_0x4454c7);const _0x295e24=_0x13f75d[_0x2b9675(0x122)](m[_0x2b9675(0x147)]),_0x3e4f1d=this[_0x2b9675(0xeb)](_0x1cbd4a);_0x295e24[_0x2b9675(0x1a5)](_0x1cbd4a,_0x5e62eb,_0x3e4f1d);}[_0x58cc96(0x1ca)](_0x5f4daf,_0x10b7e3){const _0x44b278=_0x58cc96,_0x43b4d0=_0x5f4daf[_0x44b278(0x122)](m['HistoryManagerService']);this['_disposableCollection'][_0x44b278(0x1c0)](_0x43b4d0[_0x44b278(0x1d0)][_0x44b278(0x1a7)](_0x321784=>{const _0x50d062=_0x44b278;switch(_0x321784){case m[_0x50d062(0x178)][_0x50d062(0x112)]:this[_0x50d062(0x169)][_0x50d062(0x182)](),this[_0x50d062(0x149)][_0x50d062(0xee)]();break;case m['HistoryModeStatus'][_0x50d062(0x11d)]:this[_0x50d062(0x1d6)]();break;case m[_0x50d062(0x178)][_0x50d062(0x162)]:this['unMountHistoryContent'](),this[_0x50d062(0x1c2)]['show']({'content':this[_0x50d062(0x117)]['t'](_0x50d062(0x129)),'type':b[_0x50d062(0x11c)]['Error'],'duration':0xbb8});break;}})),this[_0x44b278(0x128)][_0x44b278(0x1c0)](_0x43b4d0[_0x44b278(0x19f)][_0x44b278(0x1a7)](async _0x4cb253=>{const _0x50df65=_0x44b278;_0x4cb253&&this[_0x50df65(0x119)]['executeCommand'](I['RevertRevisionMutation']['id'],{'unitId':_0x10b7e3,'revision':_0x4cb253});}));}['_checkCanRevert'](_0x53d7ee){const _0xae75c4=_0x58cc96,_0x43ab41=this['_univerInstanceService']['getUnit'](_0x53d7ee)[_0xae75c4(0x1b6)]()['map'](_0x49a3f7=>_0x49a3f7['getSheetId']()),_0x52caf5=new d[(_0xae75c4(0x1b5))](_0x53d7ee)['id'],_0x49c103=_0x43ab41[_0xae75c4(0xed)](_0x2bd293=>new d[(_0xae75c4(0x1ce))](_0x53d7ee,_0x2bd293)['id']),_0x354c1=_0x43ab41[_0xae75c4(0xed)](_0x49fe77=>this[_0xae75c4(0x12d)][_0xae75c4(0x10d)](_0x53d7ee,_0x49fe77)[_0xae75c4(0xed)](_0x455ee8=>new d[(_0xae75c4(0x1b4))](_0x53d7ee,_0x49fe77,_0x455ee8[_0xae75c4(0x194)])['id']))[_0xae75c4(0x1ad)](),_0x3cd75f=new d[(_0xae75c4(0x1a0))](_0x53d7ee)['id'];return this[_0xae75c4(0x113)][_0xae75c4(0x1d5)]([_0x52caf5,..._0x49c103,..._0x354c1,_0x3cd75f])[_0xae75c4(0x18d)](_0xef56c2=>!!_0xef56c2[_0xae75c4(0x1a8)]);}},exports['HistoryLoaderService']=Se([g(0x0,o[_0x58cc96(0xfc)](o[_0x58cc96(0x1c4)])),g(0x1,o[_0x58cc96(0x124)]),g(0x2,o['IConfigService']),g(0x3,o[_0x58cc96(0x18c)]),g(0x4,h[_0x58cc96(0x168)]),g(0x5,o['IPermissionService']),g(0x6,o[_0x58cc96(0xfc)](d[_0x58cc96(0x108)])),g(0x7,o[_0x58cc96(0xfc)](h[_0x58cc96(0x1a1)])),g(0x8,o[_0x58cc96(0xfc)](h[_0x58cc96(0x114)])),g(0x9,o[_0x58cc96(0xfc)](o['ThemeService']))],exports['HistoryLoaderService']);const M={'id':_0x58cc96(0xe8),'type':o[_0x58cc96(0x19c)][_0x58cc96(0x187)],'handler':_0x4c8aa3=>{const _0x24a639=_0x58cc96,_0x42de7d=_0x4c8aa3['get'](exports[_0x24a639(0x105)]),_0x3479fd=_0x4c8aa3[_0x24a639(0x122)](o[_0x24a639(0x124)]),{unitId:_0x118443}=d[_0x24a639(0x197)](_0x3479fd)||{};return _0x118443?(_0x42de7d['mountHistoryContent'](_0x118443),!0x0):!0x1;}};function ye(_0x53e5b0){const _0x59269c=_0x58cc96;return{'id':M['id'],'type':h[_0x59269c(0x181)][_0x59269c(0x1b7)],'icon':'HistoryIcon','tooltip':_0x59269c(0x100),'hidden$':h['getMenuHiddenObservable'](_0x53e5b0,o[_0x59269c(0x16c)]['UNIVER_SHEET']),'disabled$':w[_0x59269c(0x1c5)](_0x53e5b0,{'workbookTypes':[d['WorkbookEditablePermission'],d[_0x59269c(0x15a)]],'worksheetTypes':[],'rangeTypes':[]})};}const fe={[h[_0x58cc96(0x184)][_0x58cc96(0x188)]]:{[M['id']]:{'order':0.2,'menuItemFactory':ye}}};var pe=Object[_0x58cc96(0x1cc)],Ie=(_0x67090,_0x509a5,_0xf9f5c5,_0x3be57a)=>{const _0x303c90=_0x58cc96;for(var _0x301889=_0x3be57a>0x1?void 0x0:_0x3be57a?pe(_0x509a5,_0xf9f5c5):_0x509a5,_0x1b9661=_0x67090[_0x303c90(0x174)]-0x1,_0x3ca53c;_0x1b9661>=0x0;_0x1b9661--)(_0x3ca53c=_0x67090[_0x1b9661])&&(_0x301889=_0x3ca53c(_0x301889)||_0x301889);return _0x301889;},S=(_0x410b3e,_0x6dd67e)=>(_0x4eef33,_0x31e4d9)=>_0x6dd67e(_0x4eef33,_0x31e4d9,_0x410b3e);let E=class extends o[_0x58cc96(0x14f)]{constructor(_0x2c2116,_0x5a61a3,_0x53500c,_0x50c7f0,_0x5bf4c1,_0x43f6ad,_0x1c8e3b,_0x1e537d){const _0x41ed73=_0x58cc96;super(),_(this,_0x41ed73(0x1c6),null),(this[_0x41ed73(0x119)]=_0x2c2116,this[_0x41ed73(0x10b)]=_0x5a61a3,this[_0x41ed73(0x1b0)]=_0x53500c,this['_historyManagerService']=_0x50c7f0,this[_0x41ed73(0x117)]=_0x5bf4c1,this[_0x41ed73(0x1c2)]=_0x43f6ad,this[_0x41ed73(0x135)]=_0x1c8e3b,this[_0x41ed73(0x11b)]=_0x1e537d,this[_0x41ed73(0x132)]());}[_0x58cc96(0x132)](){const _0x1b0403=_0x58cc96;[M][_0x1b0403(0x13f)](_0xdf31f0=>this[_0x1b0403(0x152)](o['toDisposable'](this[_0x1b0403(0x119)][_0x1b0403(0x14b)](_0xdf31f0)))),this['disposeWithMe'](this['_componentManager']['register'](_0x1b0403(0x160),q)),this[_0x1b0403(0x10b)]['mergeMenu'](fe),this[_0x1b0403(0x152)](this[_0x1b0403(0x119)][_0x1b0403(0x16d)](_0x479f6f=>{const _0x69c428=_0x1b0403;if(_0x479f6f['id']===I[_0x69c428(0x18e)]['id']){this[_0x69c428(0x1c2)]['show']({'content':this[_0x69c428(0x117)]['t']('editHistory.panel.reverting'),'type':b[_0x69c428(0x11c)]['Loading'],'duration':0x1388});const {unitId:_0x53fe9f}=_0x479f6f[_0x69c428(0x15e)],_0x4bd9c0=this[_0x69c428(0x135)][_0x69c428(0x19d)](_0x53fe9f),_0xda4e19=T['combineLatest']([_0x4bd9c0['session'][_0x69c428(0x138)],_0x4bd9c0[_0x69c428(0x15d)]])[_0x69c428(0x1a7)](async([_0x2b3b3d,_0x36eb1b])=>{const _0x56e8e1=_0x69c428;var _0x436656;_0x2b3b3d[_0x56e8e1(0x189)]===I[_0x56e8e1(0x1da)][_0x56e8e1(0x134)]&&(_0x36eb1b==null?void 0x0:_0x36eb1b['status'])===f['CollaborationStatus'][_0x56e8e1(0x1cf)]&&_0x2b3b3d[_0x56e8e1(0x102)]['mutations']['some'](_0x25e73c=>_0x25e73c['id']===I['RevertRevisionMutation']['id'])&&(this[_0x56e8e1(0x198)][_0x56e8e1(0x1d6)](),_0xda4e19[_0x56e8e1(0x1a6)](),this['_revertErrorTimer']&&clearTimeout(this[_0x56e8e1(0x1c6)]),await((_0x436656=this[_0x56e8e1(0x11b)])==null?void 0x0:_0x436656[_0x56e8e1(0x133)]()),setTimeout(()=>window[_0x56e8e1(0x1b2)]['reload']()));});this[_0x69c428(0x1c6)]=setTimeout(()=>{const _0x3e25b8=_0x69c428;_0xda4e19[_0x3e25b8(0x1a6)](),this[_0x3e25b8(0x1c2)][_0x3e25b8(0x179)]({'content':this[_0x3e25b8(0x117)]['t'](_0x3e25b8(0x164)),'type':b[_0x3e25b8(0x11c)]['Error'],'duration':0xbb8});},0x1388);}}));}};E=Ie([S(0x0,o['ICommandService']),S(0x1,h[_0x58cc96(0x107)]),S(0x2,o[_0x58cc96(0xfc)](h[_0x58cc96(0x1ac)])),S(0x3,o['Inject'](exports['HistoryLoaderService'])),S(0x4,o[_0x58cc96(0xfc)](o[_0x58cc96(0x1c4)])),S(0x5,h['IMessageService']),S(0x6,o['Inject'](f[_0x58cc96(0x106)])),S(0x7,f[_0x58cc96(0x1b8)])],E);var Ce=Object[_0x58cc96(0x1cc)],Ue=(_0x463cc9,_0x858e08,_0x3fea4f,_0x43b466)=>{const _0x375059=_0x58cc96;for(var _0x433b5f=_0x43b466>0x1?void 0x0:_0x43b466?Ce(_0x858e08,_0x3fea4f):_0x858e08,_0x35c953=_0x463cc9[_0x375059(0x174)]-0x1,_0x3d384d;_0x35c953>=0x0;_0x35c953--)(_0x3d384d=_0x463cc9[_0x35c953])&&(_0x433b5f=_0x3d384d(_0x433b5f)||_0x433b5f);return _0x433b5f;},N=(_0x15e1f5,_0x1c1fa3)=>(_0x33a146,_0x4f9e3e)=>_0x1c1fa3(_0x33a146,_0x4f9e3e,_0x15e1f5);const Ee=_0x58cc96(0x1be);var C;exports[_0x58cc96(0x17f)]=(C=class extends o[_0x58cc96(0x172)]{constructor(_0x294aaf=R,_0xcd2189,_0x4ee65c){const _0x54bfab=_0x58cc96;super(),this[_0x54bfab(0x13d)]=_0x294aaf,this[_0x54bfab(0x16e)]=_0xcd2189,this['_configService']=_0x4ee65c;const {menu:_0x4c7b18,..._0x2d58de}=o[_0x54bfab(0x154)]({},R,this['_config']);_0x4c7b18&&this[_0x54bfab(0x116)]['setConfig'](_0x54bfab(0x17b),_0x4c7b18,{'merge':!0x0}),this[_0x54bfab(0x116)][_0x54bfab(0x143)](O,_0x2d58de),this['_config'][_0x54bfab(0x173)]&&this[_0x54bfab(0x116)][_0x54bfab(0x143)](P,this[_0x54bfab(0x13d)][_0x54bfab(0x173)]);}[_0x58cc96(0x170)](){const _0x5b8b63=_0x58cc96;[[exports['HistoryLoaderService']],[E]]['forEach'](_0x578933=>this['_injector'][_0x5b8b63(0x1c0)](_0x578933));}['onSteady'](){const _0x2ecc88=_0x58cc96;this['_injector'][_0x2ecc88(0x122)](E);}},_(C,_0x58cc96(0xf8),o['UniverInstanceType'][_0x58cc96(0x19b)]),_(C,'pluginName',Ee),C),exports['UniverEditHistoryLoaderPlugin']=Ue([N(0x1,o[_0x58cc96(0xfc)](o[_0x58cc96(0x145)])),N(0x2,o[_0x58cc96(0x127)])],exports[_0x58cc96(0x17f)]),exports[_0x58cc96(0x141)]=P,exports[_0x58cc96(0x18f)]=y;