function _0xfb6f(_0x15eb0d,_0x1f3aef){const _0x347f96=_0x347f();return _0xfb6f=function(_0xfb6f5,_0x113b8c){_0xfb6f5=_0xfb6f5-0x97;let _0x120527=_0x347f96[_0xfb6f5];return _0x120527;},_0xfb6f(_0x15eb0d,_0x1f3aef);}function _0x347f(){const _0x4beb67=['filter','AddSheetSparklineMutation','_versions$','combineLatest','dispose','0\x200\x2016\x2017','object','Print','addProtection','UniverEditHistoryViewerPlugin','UNIVER_SHEET','UNIVER_UNKNOWN','flex','UNIVER_SLIDE','ViewHistory','1000','memberId','_getAPIPrefix','querySelector','100%','includes','concat','IConfigService','endRev','history-mask','@univerjs/drawing','SheetPermissionInitController','_sheetSkeletonManagerService','206127WkLxrO','scrollEvent$','width','SheetSkeletonManagerService','currentVersionDiff$','DeleteSheet','useObservable','[HistoryFetchService]:\x20wrong\x20rev\x20from\x20the\x20server!','confirm-revert-revision','LOGIN_TOKEN_PROCESSING_FAILED','fetchThroughInterceptors','getAncestorScale','SHEET_VIEWPORT_KEY','CreateWorksheet','editHistory.info.loading','active','COMPRESS_MUTATION_APPLY','_initPanel','_localeService','tag','createTime','REDEMPTION_CODE_FULLY_REDEEMED','blocks','editHistory.panel.revertConfirm','UniverSheetsUi','padStart','UniverInstanceType','refreshRangeProtectPermission','MoveColsMutation','_diffRangesMap','View','UniverNetworkPlugin','@univerjs/ui','path','IPermissionService','mask','2MppdTv','PAYMENT_CHANNEL_NOT_SUPPORT','getVersion','&lastLabel=','ITransformService','disposeUnit','LICENSE_MAX_MEMBERS_PER_UNIT_EXCEEDED','univer-text-2xl\x20dark:!univer-text-white','editHistory.action.','blockMeta','useDependency','ENTITLE_CAN_NOT_BUY_LOWER_OTP','DATA_SOURCE_TOO_LARGE','length','editHistory.action.revertSheetPrefix','Injector','value','getCurrent','entities','commands','rgba(225,\x20225,\x20225,\x200.5)','WorkbookMoveSheetPermission','REDEMPTION_CODE_INACTIVE','_sheetPermissionInitController','DeleteWorksheet','FloatImg','RemoveSheetMutation','MOBILE_VERIFY_CODE_MISMATCH','get','EMAIL_HAS_BEEN_BOUND','getHours','clsx','subUnitId','error','clipPath','univer-flex\x20univer-items-center\x20univer-gap-2.5\x20univer-py-1.5\x20univer-text-sm\x20univer-font-medium','values','SetWorksheetStyle','Loaded','INVALID_INVITE_CODE','jsxs','_sidebarDisposable','map','_uiPartsService','_historyFetchService','InsertRowMutation','svg','_hasMore','SetWorksheetActiveOperation','_getActiveSubUnitId','_permissionService','current','restore-icon_clip0_1247_2','currentVersion','_status$','InsertRow','children','COMPLETION_FINISHED','_createMask','editSheet','ERROR_AGAIN','endRow','all','univer-flex\x20univer-items-center\x20univer-justify-center','VIRTUAL_VERSION_NOW','focusUnit','YUUMI_RATE_OVER_LIMIT','React','DisposableCollection','ComponentManager','borderBottomClassName','parseProtocolChangeset','revertRevision$','.univer-app-container-content','params','range','column','YUUMI_NO_CUBOID_FOR_QUESTION','BackIcon','_confirmService','RevertRevisionMutation','_context','canRevert','_maskContainer','SetCellStyle','YUUMI_PROMPT_MAX_TOKENS_EXCEEDED','BehaviorSubject','AddConditionalRuleMutation','toISOString','DependentOn','InsertHyperlink','_messageService','getUnitOnRev','debounce','loadMoreVersions','use','SheetCollabCursorShape','Exited','@univerjs/core','unitId$','center','YUUMI_CONNECTOR_URL_NOT_FOUND','EditExtraObject','ENTITLE_DUP_SUBSCRIPTION','DeleteRow','pipe','univer-text-gray-500','_compressMutationService','useCallback','exited','InsertColMutation','[HistoryFetchService]:\x20request\x20snapshot\x20error!','_members','style','History','Vector2','_versionDiffService','WorkbookRenameSheetPermission','Fragment','MessageType','history-panel','UNIVER_DOC','getDialogs$','div','Duplicate',':\x20(','univer-flex\x20univer-flex-1\x20univer-items-center\x20univer-text-sm\x20univer-text-gray-600\x20dark:!univer-text-gray-200','subType','PY_RUNTIME_SCRIPT_ERROR','hideMask','keys','onMouseMove','mutations','SetWorksheetHideMutation','push','APPLY_PERMISSION_DENIED','clear','now','changesets','_unitId$','LoadingMultiIcon','rect','ICommandService','onSteady','SetColumnStyle','getMember','_dialogOptions$','from','UniverSheetsConditionalFormatting','_lastLabel','function','/universer-api/history','top','m1Prime','row','INVALID_ARGUMENT','status','M2.06678\x203.37926C2.0668\x201.94333\x203.23085\x200.779297\x204.66678\x200.779297H9.44256C10.1796\x200.779297\x2010.8821\x201.09213\x2011.3751\x201.63999L13.2659\x203.74079C13.6955\x204.21822\x2013.9333\x204.83779\x2013.9333\x205.4801V12.7126C13.9333\x2014.1486\x2012.7692\x2015.3126\x2011.3333\x2015.3126H4.66665C3.2307\x2015.3126\x202.06663\x2014.1486\x202.06665\x2012.7126L2.06678\x203.37926ZM4.66678\x201.9793C3.89359\x201.9793\x203.26679\x202.60609\x203.26678\x203.37928L3.26665\x2012.7126C3.26664\x2013.4858\x203.89344\x2014.1126\x204.66665\x2014.1126H11.3333C12.1065\x2014.1126\x2012.7333\x2013.4858\x2012.7333\x2012.7126V5.4801C12.7333\x205.44882\x2012.7322\x205.41764\x2012.7302\x205.3866H10.7985C9.91488\x205.3866\x209.19853\x204.67026\x209.19853\x203.78661V1.9793H4.66678ZM10.4832\x202.44275L12.0526\x204.1866H10.7985C10.5776\x204.1866\x2010.3985\x204.00752\x2010.3985\x203.78661V2.35649C10.4279\x202.38389\x2010.4561\x202.41266\x2010.4832\x202.44275Z','getUnitId','REDEMPTION_CODE_NOT_STARTED','UniverNetwork','univer-overflow-hidden','justifyContent','CHANGESET_REVISION_CONFILICT','registerComponent','INTERNAL_ERROR','editHistory.panel.title','bottom','set','_updateVersions','Init','rule','_combineRanges','_componentManager','useRef','ViemRwHgtClWdt','_maskElement','editHistory.panel.confirm','_removeDiffMarks','@univerjs/sheets-conditional-formatting','forwardRef','5676730knniww','loaded','278590nfnptL','triggerRevert','YUUMI_SUBSCRIPTION_NOT_FOUND','recoverTime','rgba(58,\x2096,\x20247,\x200.20)','string','currentVersion$','Sort','user','6007738SUxPyd','RenameWorksheet','MoveRangeMutation','_extractRanges','Plugin','left','UNRECOGNIZED','amd','_fetching','MOBILE_VERIFY_CODE_NOT_FOUND_OR_EXPIRED','UniverCore','name','univer-m-auto\x20univer-animate-spin','7vrGNKx','flat','ENTITLE_NEED_BILLING_ADDRESS','xlink:href','editHistory.panel.cancel','_lastPointer','_init','addObjects','UNIVER_PROJECT','loadSheet','getOwnPropertyDescriptor','endColumn','_workbookDataCache','createSheet','#0B9EFB','dateString','ranges','APPLY_DUPLICATED','LICENSE_MAX_UNITS_EXCEEDED','setFilter','SetNumfmtMutation','getVpScrollXYInfoByPosToVp','jsx','CopySheet','Edit','UniverProSheetsSparkline','getCurrentLocale','ENTITLE_UPDOWN_GRADE_NOT_SUPPORT','registerRenderModule','YUUMI_ALL_TABLES_IS_INVALID','1em','createElement','AddWorksheetProtectionMutation','revertSheet','ManageCollaborator','displayName','InsertColumn','INVITE_CODE_REQUIRED','position','5309272hGkMwU','APPLY_REJECT','editHistory.action.etc','data','UniverSheetsUIPlugin','604xPbGDH','WorkbookEditablePermission','AddDataValidationMutation','LocaleService','merge','NOT_FOUND','entries','ObjectMatrix','_initRender','fetchMissingChangesets','state$','onRendered','SnapshotServerOverHTTPService','onStarting','APPLY_REVISION_CONFILICT','Inject','_transformService','getCurrentUnitForType','editHistory.panel.currentUser','CreateSheet','UNDEFINED','LICENSE_IMPORT_SIZE_EXCEEDED','createUnit','YUUMI_UNABLE_LOAD_URL','makeDirty','HTTPService','CollaborationImageIoService','users','_loadingState$','endRevision','updatePermissionPoint','some','MoveRowsMutation','EMAIL_VERIFY_CODE_MISMATCH','setDV','SetRowStyle','_canRevert','Info','EMAIL_VERIFY_CODE_NOT_FOUND_OR_EXPIRED','insertSheet','showMask','SelectProtectedCells','workbook','toDisposable','loadingState$','parse','M7.41252\x2010.6196C7.64683\x2010.3852\x207.64683\x2010.0053\x207.41252\x209.77103L6.77012\x209.12863H9.67836C9.89927\x209.12863\x2010.0784\x209.30772\x2010.0784\x209.52863V11.1953C10.0784\x2011.5267\x2010.347\x2011.7953\x2010.6784\x2011.7953C11.0097\x2011.7953\x2011.2784\x2011.5267\x2011.2784\x2011.1953V9.52863C11.2784\x208.64497\x2010.562\x207.92863\x209.67836\x207.92863H6.77012L7.41252\x207.28623C7.64683\x207.05191\x207.64683\x206.67201\x207.41252\x206.4377C7.1782\x206.20338\x206.79831\x206.20338\x206.56399\x206.4377L4.89732\x208.10437C4.66301\x208.33868\x204.66301\x208.71858\x204.89732\x208.95289L6.56399\x2010.6196C6.79831\x2010.8539\x207.1782\x2010.8539\x207.41252\x2010.6196Z','getRelativeToViewportCoord','6KaQznM','next','sheet','cellValue','MoveWorksheet','skeleton','onPointerMove$','action','unitId','block','@univerjs/sheets','RangeMergeUtil','getCoordByCell','setCF','transformMutations','zIndex','UniverProCollaboration','_renderManagerService','ViewFilter','AUTHORIZE_CODE_ILLEGAL','none','PERMISSION_DENIED','USER_NOT_INVITED_CODE','univer-text-sm\x20univer-leading-5\x20univer-text-gray-500\x20dark:!univer-text-gray-300','evenodd','attrs','_snapshotServerService','ENTITLE_REPORT_LIMIT_EXCEED','_currentVersion$','split','CreatePermissionObject','univer-animate-spin','AddRangeProtectionMutation','status$','setFrozen','YUUMI_AI_RUN_FAILED','SelectUnProtectedCells','LocaleType','6039945ltywkd','deleteProtection','IUIPartsService','HideSheet','LICENSE_DISTRO_REJECTED','Disposable','_initMaskContainer','LICENSE_EXPORT_SIZE_EXCEEDED','Loading','Today','editHistory.panel.listFetchError','ISnapshotServerService','_revertRevision$','date','CURRENT_STATUS_CANNOT_OPERATE','versions','LOGIN_FAILED','subscribe','reduce','url(#restore-icon_clip0_1247_2)','symbol','SetRangeValuesMutation','toStringTag','0\x200\x2016\x2016','white','UniverSheets','edit-history-viewer.config','FromArray','defs','code','DeleteRangeProtectionMutation','_commandService','YUUMI_ASYNCIO_CANCELLED','ReorderRangeMutation','_historyContainerId','_getRangesByMutation','switchMap','setState','height','M6.42416\x204.42417C6.65847\x204.18985\x206.65847\x203.80995\x206.42416\x203.57564C6.18984\x203.34132\x205.80994\x203.34132\x205.57563\x203.57564L1.57564\x207.57564C1.34132\x207.80995\x201.34132\x208.18985\x201.57564\x208.42417L5.57563\x2012.4242C5.80994\x2012.6585\x206.18984\x2012.6585\x206.42416\x2012.4242C6.65847\x2012.1899\x206.65847\x2011.81\x206.42416\x2011.5756L3.44843\x208.5999H14C14.3314\x208.5999\x2014.6\x208.33127\x2014.6\x207.9999C14.6\x207.66853\x2014.3314\x207.3999\x2014\x207.3999H3.44843L6.42416\x204.42417Z','SetCellValue','fill','REDEMPTION_CODE_HAS_BEEN_CREATED','userID','YUUMI_URL_COL_OUT_OF_RANGE','REDEMPTION_INVALID_CODE','Export','stopPropagation','_currentVersionDiff$','idSuffix','_httpService','triggerLoadSheet','getElementById','univerjs-icon\x20univerjs-icon-','_createUnit','removeSheet','assign','_transformMutationByOrder','getSheetObject','Comment','currentSkeleton$','RecoverHistory','ENTITLE_CHAT_LIMIT_EXCEED','UniverEngineRender','useState','hasCommand','restore-icon','Module','react/jsx-runtime','CONNECTOR_DATA_TOO_LARGE','ZH_CN','MOBILE_HAS_BEEN_BOUND','Filter','IDialogService','currentColor','editHistory.panel.revertDesc','hidden','_sidebarService','rules','UniverProCollaborationClient','span','colorChannel1','IMessageService','rxjs','_updateDiffMarks','close','init','IUniverInstanceService','UpdateDataValidationMutation','rev','HistoryModeStatus','getMinutes','disposeWithMe','entered','open','defineProperty','ICellEditorManagerService','startRow','DeleteColumn','startColumn','UniverDesign','getInterceptPoints','SetSheetsFilterRangeMutation','EditWorksheetCell','TOO_MANY_REQUESTS','setValue','univer-ml-2.5\x20univer-flex\x20univer-size-8\x20univer-cursor-pointer\x20univer-items-center\x20univer-justify-center\x20univer-rounded','_cellEditorManagerService','register','IConfirmService','button','_openPanel','show','Share','find','confirm','then','getConfig','http://www.w3.org/2000/svg','editHistory.header.revert','time','_injector','UniverProEditHistoryViewer','8970mOLGne','has','InsertSheetMutation','PivotTable','_configService','_univerInstanceService','univer-flex\x20univer-size-6\x20univer-items-center\x20univer-justify-center\x20univer-rounded\x20univer-text-gray-400\x20hover:univer-bg-gray-100\x20dark:hover:!univer-bg-gray-700','asObservable','WorkbookHideSheetPermission','SNAPSHOT_HAS_BEEN_REMOVED','@univerjs-pro/collaboration','UniverSheetsFilter','add','_initActiveSwitch','substring','ENSURE_SNAPSHOT_EXECUTION','getDeserializedSheetBlock','editHistory.panel.currentVersion','_diffs','UNAUTHENTICATED','forEach','display','syncExecuteCommand','sheetId','getDataRange','getVersions','exports','REDEMPTION_USER_NOT_ELIGIBLE','HistoryManagerService','interceptor','RenameSheet','userId','ALREADY_EXISTS','univer-flex\x20univer-h-12\x20univer-cursor-default\x20univer-items-center','@univerjs-pro/collaboration-client-ui','SetConditionalRuleMutation','loadingState','versions$','UniverUi','Delete','univer-h-full\x20univer-space-y-2\x20univer-overflow-auto\x20univer-pb-4','_historyManagerService','INVITE_CODE_HAS_BEEN_UES','HEADER','@univerjs/data-validation','url(#$1','Tooltip','USER_NOT_FOUND','CompressMutationService','MoveSheet','ensureVersion','setConfig','SNAPSHOT_INVALID_SNAPSHOT'];_0x347f=function(){return _0x4beb67;};return _0x347f();}(function(_0x1ace9a,_0x247c82){const _0x14bf15=_0xfb6f,_0x2a9f3a=_0x1ace9a();while(!![]){try{const _0x3752af=-parseInt(_0x14bf15(0x232))/0x1*(parseInt(_0x14bf15(0x256))/0x2)+-parseInt(_0x14bf15(0x1e1))/0x3*(parseInt(_0x14bf15(0x110))/0x4)+-parseInt(_0x14bf15(0xce))/0x5*(-parseInt(_0x14bf15(0x140))/0x6)+parseInt(_0x14bf15(0xe4))/0x7*(parseInt(_0x14bf15(0x10b))/0x8)+-parseInt(_0x14bf15(0x166))/0x9+parseInt(_0x14bf15(0xcc))/0xa+parseInt(_0x14bf15(0xd7))/0xb;if(_0x3752af===_0x247c82)break;else _0x2a9f3a['push'](_0x2a9f3a['shift']());}catch(_0x241294){_0x2a9f3a['push'](_0x2a9f3a['shift']());}}}(_0x347f,0x7b2a6),function(_0x3772e9,_0x25455c){const _0x564c94=_0xfb6f;typeof exports==_0x564c94(0x21c)&&typeof module<'u'?_0x25455c(exports,require('@univerjs-pro/collaboration'),require('@univerjs-pro/collaboration-client'),require('@univerjs/core'),require('@univerjs/drawing'),require('@univerjs/engine-render'),require('@univerjs/network'),require('@univerjs/sheets-ui'),require('@univerjs/ui'),require('@univerjs/design'),require('@univerjs/sheets'),require('rxjs'),require('@univerjs-pro/sheets-sparkline'),require('@univerjs/data-validation'),require('@univerjs/sheets-conditional-formatting'),require('@univerjs/sheets-filter'),require('react/jsx-runtime'),require('react'),require('@univerjs-pro/collaboration-client-ui')):typeof define==_0x564c94(0xad)&&define[_0x564c94(0xde)]?define([_0x564c94(0x1fb),_0x564c94(0x1eb),'@univerjs-pro/collaboration-client',_0x564c94(0x2b8),_0x564c94(0x22f),'@univerjs/engine-render','@univerjs/network','@univerjs/sheets-ui',_0x564c94(0x252),'@univerjs/design',_0x564c94(0x14a),_0x564c94(0x1b9),'@univerjs-pro/sheets-sparkline',_0x564c94(0x20d),_0x564c94(0xca),'@univerjs/sheets-filter',_0x564c94(0x1aa),'react',_0x564c94(0x203)],_0x25455c):(_0x3772e9=typeof globalThis<'u'?globalThis:_0x3772e9||self,_0x25455c(_0x3772e9[_0x564c94(0x1e0)]={},_0x3772e9[_0x564c94(0x150)],_0x3772e9[_0x564c94(0x1b5)],_0x3772e9[_0x564c94(0xe1)],_0x3772e9['UniverDrawing'],_0x3772e9[_0x564c94(0x1a5)],_0x3772e9[_0x564c94(0xb7)],_0x3772e9[_0x564c94(0x24a)],_0x3772e9[_0x564c94(0x207)],_0x3772e9[_0x564c94(0x1ca)],_0x3772e9[_0x564c94(0x17f)],_0x3772e9[_0x564c94(0x1b9)],_0x3772e9[_0x564c94(0xfd)],_0x3772e9['UniverDataValidation'],_0x3772e9[_0x564c94(0xab)],_0x3772e9[_0x564c94(0x1ec)],_0x3772e9[_0x564c94(0x299)],_0x3772e9[_0x564c94(0x299)],_0x3772e9['UniverProCollaborationClientUi']));}(this,function(_0x4d70eb,_0xa43662,_0x450e2e,_0x242e1a,_0x149d4f,_0xfc4827,_0x3ebdc4,_0x316cbf,_0x1bf0bf,_0x368c21,_0x467fd2,_0x2a386a,_0x52613e,_0x2b3974,_0x532ec1,_0x2eebc6,_0x7b355a,_0x3f8f3c,_0x444a03){'use strict';const _0x31b547=_0xfb6f;var _0x12c448=Object[_0x31b547(0x1c5)],_0x39b870=(_0x38861a,_0x3fadac,_0x1eb374)=>_0x3fadac in _0x38861a?_0x12c448(_0x38861a,_0x3fadac,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0x1eb374}):_0x38861a[_0x3fadac]=_0x1eb374,_0x554995=(_0x2c614a,_0x3fc312,_0x17cb8a)=>_0x39b870(_0x2c614a,typeof _0x3fc312!=_0x31b547(0x17a)?_0x3fc312+'':_0x3fc312,_0x17cb8a);const _0x1ac248=_0x31b547(0x180),_0x47955f={};var _0x1d5651=Object[_0x31b547(0xee)],_0x20f3ba=(_0x41405d,_0x4c3bef,_0x3b6d1d,_0x5063de)=>{const _0x38568b=_0x31b547;for(var _0x399990=_0x5063de>0x1?void 0x0:_0x5063de?_0x1d5651(_0x4c3bef,_0x3b6d1d):_0x4c3bef,_0x17d854=_0x41405d[_0x38568b(0x263)]-0x1,_0xbed1ec;_0x17d854>=0x0;_0x17d854--)(_0xbed1ec=_0x41405d[_0x17d854])&&(_0x399990=_0xbed1ec(_0x399990)||_0x399990);return _0x399990;},_0xcbc74a=(_0x1eeb57,_0x43b86f)=>(_0x437b79,_0x251003)=>_0x43b86f(_0x437b79,_0x251003,_0x1eeb57);let _0x157c76=class extends _0x242e1a[_0x31b547(0x16b)]{constructor(_0x292757){const _0x4e756d=_0x31b547;super(),this['_cellEditorManagerService']=_0x292757,this[_0x4e756d(0xea)]();}[_0x31b547(0xea)](){const _0x3c8650=_0x31b547;this[_0x3c8650(0x1c2)](this['_cellEditorManagerService'][_0x3c8650(0x11a)]['subscribe'](_0x56f106=>{const _0x181bad=_0x3c8650;_0x56f106!=null&&_0x56f106['show']&&this[_0x181bad(0x1d1)][_0x181bad(0x18b)]({'show':!0x1});}));}};_0x157c76=_0x20f3ba([_0xcbc74a(0x0,_0x316cbf[_0x31b547(0x1c6)])],_0x157c76);var _0x3f26b4=(_0x1967a8=>(_0x1967a8[_0x1967a8[_0x31b547(0x124)]=0x0]=_0x31b547(0x124),_0x1967a8[_0x1967a8['OK']=0x1]='OK',_0x1967a8[_0x1967a8[_0x31b547(0xbc)]=0x2]=_0x31b547(0xbc),_0x1967a8[_0x1967a8[_0x31b547(0x155)]=0x3]=_0x31b547(0x155),_0x1967a8[_0x1967a8[_0x31b547(0x115)]=0x4]=_0x31b547(0x115),_0x1967a8[_0x1967a8[_0x31b547(0x1f4)]=0x5]=_0x31b547(0x1f4),_0x1967a8[_0x1967a8[_0x31b547(0x201)]=0x6]=_0x31b547(0x201),_0x1967a8[_0x1967a8[_0x31b547(0xb2)]=0x7]=_0x31b547(0xb2),_0x1967a8[_0x1967a8['TOO_MANY_REQUESTS']=0x8]=_0x31b547(0x1ce),_0x1967a8[_0x1967a8[_0x31b547(0x28f)]=0x9]=_0x31b547(0x28f),_0x1967a8[_0x1967a8[_0x31b547(0x176)]=0xa]='LOGIN_FAILED',_0x1967a8[_0x1967a8[_0x31b547(0x271)]=0xb]=_0x31b547(0x271),_0x1967a8[_0x1967a8[_0x31b547(0xe0)]=0xc]=_0x31b547(0xe0),_0x1967a8[_0x1967a8[_0x31b547(0x131)]=0xd]=_0x31b547(0x131),_0x1967a8[_0x1967a8[_0x31b547(0x136)]=0xe]=_0x31b547(0x136),_0x1967a8[_0x1967a8[_0x31b547(0x153)]=0xf]=_0x31b547(0x153),_0x1967a8[_0x1967a8[_0x31b547(0x23b)]=0x10]=_0x31b547(0x23b),_0x1967a8[_0x1967a8[_0x31b547(0x174)]=0x64]='CURRENT_STATUS_CANNOT_OPERATE',_0x1967a8[_0x1967a8[_0x31b547(0x292)]=0x65]=_0x31b547(0x292),_0x1967a8[_0x1967a8['USER_NOT_FOUND']=0xc9]=_0x31b547(0x210),_0x1967a8[_0x1967a8['USER_IS_ANONYMOUS']=0xca]='USER_IS_ANONYMOUS',_0x1967a8[_0x1967a8[_0x31b547(0xba)]=0x1389]=_0x31b547(0xba),_0x1967a8[_0x1967a8['SNAPSHOT_INVALID_SNAPSHOT']=0x1771]=_0x31b547(0x215),_0x1967a8[_0x1967a8[_0x31b547(0x1ea)]=0x1772]='SNAPSHOT_HAS_BEEN_REMOVED',_0x1967a8[_0x1967a8['ENSURE_SNAPSHOT_EXECUTION']=0x1773]=_0x31b547(0x1f0),_0x1967a8[_0x1967a8[_0x31b547(0x10c)]=0x1b59]='APPLY_REJECT',_0x1967a8[_0x1967a8['APPLY_NON_SEQUENTIAL_REVISION']=0x1b5a]='APPLY_NON_SEQUENTIAL_REVISION',_0x1967a8[_0x1967a8[_0x31b547(0x11e)]=0x1b5b]='APPLY_REVISION_CONFILICT',_0x1967a8[_0x1967a8[_0x31b547(0x9e)]=0x1b5c]='APPLY_PERMISSION_DENIED',_0x1967a8[_0x1967a8[_0x31b547(0xf5)]=0x1b5d]='APPLY_DUPLICATED',_0x1967a8[_0x1967a8[_0x31b547(0x1ab)]=0x1f41]=_0x31b547(0x1ab),_0x1967a8[_0x1967a8[_0x31b547(0xf6)]=0x2329]='LICENSE_MAX_UNITS_EXCEEDED',_0x1967a8[_0x1967a8[_0x31b547(0x25c)]=0x232a]=_0x31b547(0x25c),_0x1967a8[_0x1967a8['LICENSE_IMPORT_SIZE_EXCEEDED']=0x232b]=_0x31b547(0x125),_0x1967a8[_0x1967a8[_0x31b547(0x16d)]=0x232c]=_0x31b547(0x16d),_0x1967a8[_0x1967a8[_0x31b547(0x16a)]=0x232d]='LICENSE_DISTRO_REJECTED',_0x1967a8[_0x1967a8[_0x31b547(0x127)]=0x2711]=_0x31b547(0x127),_0x1967a8[_0x1967a8[_0x31b547(0x192)]=0x2712]='YUUMI_URL_COL_OUT_OF_RANGE',_0x1967a8[_0x1967a8[_0x31b547(0x298)]=0x2713]=_0x31b547(0x298),_0x1967a8[_0x1967a8[_0x31b547(0xd0)]=0x2714]=_0x31b547(0xd0),_0x1967a8[_0x1967a8[_0x31b547(0x2a3)]=0x271a]=_0x31b547(0x2a3),_0x1967a8[_0x1967a8[_0x31b547(0x186)]=0x271b]=_0x31b547(0x186),_0x1967a8[_0x1967a8['YUUMI_TABLE_NOT_FOUND_IN_UNIT']=0x271c]='YUUMI_TABLE_NOT_FOUND_IN_UNIT',_0x1967a8[_0x1967a8[_0x31b547(0x101)]=0x271d]=_0x31b547(0x101),_0x1967a8[_0x1967a8['YUUMI_PROMPT_MAX_TOKENS_EXCEEDED']=0x271e]=_0x31b547(0x2ab),_0x1967a8[_0x1967a8[_0x31b547(0x163)]=0x271f]=_0x31b547(0x163),_0x1967a8[_0x1967a8[_0x31b547(0x2bb)]=0x2720]=_0x31b547(0x2bb),_0x1967a8[_0x1967a8[_0x31b547(0x97)]=0x2af9]=_0x31b547(0x97),_0x1967a8[_0x1967a8['INVITE_CODE_HAS_BEEN_UES']=0x2ee1]=_0x31b547(0x20b),_0x1967a8[_0x1967a8['INVALID_INVITE_CODE']=0x2ee2]=_0x31b547(0x27d),_0x1967a8[_0x1967a8[_0x31b547(0x109)]=0x2ee3]=_0x31b547(0x109),_0x1967a8[_0x1967a8[_0x31b547(0x156)]=0x2ee4]=_0x31b547(0x156),_0x1967a8[_0x1967a8['INVITE_CODE_ALREADY_BOUND']=0x2ee5]='INVITE_CODE_ALREADY_BOUND',_0x1967a8[_0x1967a8['WECHAT_HAS_BEEN_BOUND']=0x32c9]='WECHAT_HAS_BEEN_BOUND',_0x1967a8[_0x1967a8[_0x31b547(0x1ad)]=0x32ca]='MOBILE_HAS_BEEN_BOUND',_0x1967a8[_0x1967a8['EMAIL_HAS_BEEN_BOUND']=0x32cb]=_0x31b547(0x273),_0x1967a8[_0x1967a8[_0x31b547(0x261)]=0x36b1]=_0x31b547(0x261),_0x1967a8[_0x1967a8[_0x31b547(0xff)]=0x36b2]=_0x31b547(0xff),_0x1967a8[_0x1967a8['ENTITLE_DUP_SUBSCRIPTION']=0x36b3]=_0x31b547(0x2bd),_0x1967a8[_0x1967a8['PAYMENT_CHANNEL_NOT_SUPPORT']=0x36b4]=_0x31b547(0x257),_0x1967a8[_0x1967a8[_0x31b547(0x1a4)]=0x3715]=_0x31b547(0x1a4),_0x1967a8[_0x1967a8[_0x31b547(0x15b)]=0x3716]=_0x31b547(0x15b),_0x1967a8[_0x1967a8['ENTITLE_INSUFFICIENT_QUOTA']=0x3717]='ENTITLE_INSUFFICIENT_QUOTA',_0x1967a8[_0x1967a8[_0x31b547(0xe6)]=0x37dd]=_0x31b547(0xe6),_0x1967a8[_0x1967a8[_0x31b547(0x193)]=0x3a99]=_0x31b547(0x193),_0x1967a8[_0x1967a8[_0x31b547(0x26c)]=0x3a9a]='REDEMPTION_CODE_INACTIVE',_0x1967a8[_0x1967a8['REDEMPTION_CODE_FULLY_REDEEMED']=0x3a9b]=_0x31b547(0x247),_0x1967a8[_0x1967a8[_0x31b547(0xb6)]=0x3a9c]=_0x31b547(0xb6),_0x1967a8[_0x1967a8['REDEMPTION_USER_NOT_ELIGIBLE']=0x3a9d]=_0x31b547(0x1fc),_0x1967a8[_0x1967a8['REDEMPTION_USER_REDEEM_TIMES_EXCEED']=0x3a9e]='REDEMPTION_USER_REDEEM_TIMES_EXCEED',_0x1967a8[_0x1967a8[_0x31b547(0x190)]=0x3a9f]=_0x31b547(0x190),_0x1967a8[_0x1967a8[_0x31b547(0x262)]=0x3e81]='DATA_SOURCE_TOO_LARGE',_0x1967a8[_0x1967a8[_0x31b547(0xdd)]=-0x1]=_0x31b547(0xdd),_0x1967a8))(_0x3f26b4||{}),_0x57e78f=(_0x1894cb=>(_0x1894cb[_0x1894cb[_0x31b547(0x221)]=0x0]=_0x31b547(0x221),_0x1894cb[_0x1894cb['UNIVER_DOC']=0x1]=_0x31b547(0x2cf),_0x1894cb[_0x1894cb[_0x31b547(0x220)]=0x2]=_0x31b547(0x220),_0x1894cb[_0x1894cb[_0x31b547(0x223)]=0x3]='UNIVER_SLIDE',_0x1894cb[_0x1894cb[_0x31b547(0xec)]=0x4]=_0x31b547(0xec),_0x1894cb[_0x1894cb[_0x31b547(0xdd)]=-0x1]=_0x31b547(0xdd),_0x1894cb))(_0x57e78f||{}),_0x3df9c5=(_0x58f8f0=>(_0x58f8f0[_0x58f8f0[_0x31b547(0x250)]=0x0]=_0x31b547(0x250),_0x58f8f0[_0x58f8f0[_0x31b547(0xfc)]=0x1]='Edit',_0x58f8f0[_0x58f8f0[_0x31b547(0x106)]=0x2]=_0x31b547(0x106),_0x58f8f0[_0x58f8f0[_0x31b547(0x21d)]=0x3]=_0x31b547(0x21d),_0x58f8f0[_0x58f8f0[_0x31b547(0x2d2)]=0x4]='Duplicate',_0x58f8f0[_0x58f8f0[_0x31b547(0x1a1)]=0x5]='Comment',_0x58f8f0[_0x58f8f0['Copy']=0x6]='Copy',_0x58f8f0[_0x58f8f0[_0x31b547(0x1d7)]=0x7]=_0x31b547(0x1d7),_0x58f8f0[_0x58f8f0[_0x31b547(0x194)]=0x8]=_0x31b547(0x194),_0x58f8f0[_0x58f8f0[_0x31b547(0x144)]=0x9]=_0x31b547(0x144),_0x58f8f0[_0x58f8f0['DeleteWorksheet']=0xa]=_0x31b547(0x26e),_0x58f8f0[_0x58f8f0['HideWorksheet']=0xb]='HideWorksheet',_0x58f8f0[_0x58f8f0['RenameWorksheet']=0xc]=_0x31b547(0xd8),_0x58f8f0[_0x58f8f0['CreateWorksheet']=0xd]=_0x31b547(0x23f),_0x58f8f0[_0x58f8f0[_0x31b547(0x27b)]=0xe]=_0x31b547(0x27b),_0x58f8f0[_0x58f8f0[_0x31b547(0x1cd)]=0xf]='EditWorksheetCell',_0x58f8f0[_0x58f8f0[_0x31b547(0x2b0)]=0x10]=_0x31b547(0x2b0),_0x58f8f0[_0x58f8f0[_0x31b547(0xd5)]=0x11]=_0x31b547(0xd5),_0x58f8f0[_0x58f8f0[_0x31b547(0x1ae)]=0x12]='Filter',_0x58f8f0[_0x58f8f0[_0x31b547(0x1e4)]=0x13]=_0x31b547(0x1e4),_0x58f8f0[_0x58f8f0[_0x31b547(0x26f)]=0x14]=_0x31b547(0x26f),_0x58f8f0[_0x58f8f0[_0x31b547(0x2c8)]=0x15]=_0x31b547(0x2c8),_0x58f8f0[_0x58f8f0['RwHgtClWdt']=0x16]='RwHgtClWdt',_0x58f8f0[_0x58f8f0[_0x31b547(0xc6)]=0x17]=_0x31b547(0xc6),_0x58f8f0[_0x58f8f0['ViewFilter']=0x18]=_0x31b547(0x152),_0x58f8f0[_0x58f8f0[_0x31b547(0x212)]=0x19]=_0x31b547(0x212),_0x58f8f0[_0x58f8f0[_0x31b547(0x237)]=0x1a]=_0x31b547(0x237),_0x58f8f0[_0x58f8f0[_0x31b547(0x169)]=0x1b]=_0x31b547(0x169),_0x58f8f0[_0x58f8f0[_0x31b547(0xfb)]=0x1c]=_0x31b547(0xfb),_0x58f8f0[_0x58f8f0[_0x31b547(0x1ff)]=0x1d]=_0x31b547(0x1ff),_0x58f8f0[_0x58f8f0[_0x31b547(0x123)]=0x1e]=_0x31b547(0x123),_0x58f8f0[_0x58f8f0[_0x31b547(0x139)]=0x1f]=_0x31b547(0x139),_0x58f8f0[_0x58f8f0[_0x31b547(0x164)]=0x20]='SelectUnProtectedCells',_0x58f8f0[_0x58f8f0[_0x31b547(0x2aa)]=0x21]=_0x31b547(0x2aa),_0x58f8f0[_0x58f8f0[_0x31b547(0x18e)]=0x22]=_0x31b547(0x18e),_0x58f8f0[_0x58f8f0[_0x31b547(0x133)]=0x23]=_0x31b547(0x133),_0x58f8f0[_0x58f8f0['SetColumnStyle']=0x24]=_0x31b547(0xa7),_0x58f8f0[_0x58f8f0[_0x31b547(0x28d)]=0x25]=_0x31b547(0x28d),_0x58f8f0[_0x58f8f0[_0x31b547(0x108)]=0x26]='InsertColumn',_0x58f8f0[_0x58f8f0[_0x31b547(0x2be)]=0x27]=_0x31b547(0x2be),_0x58f8f0[_0x58f8f0[_0x31b547(0x1c8)]=0x28]=_0x31b547(0x1c8),_0x58f8f0[_0x58f8f0[_0x31b547(0x2bc)]=0x29]=_0x31b547(0x2bc),_0x58f8f0[_0x58f8f0[_0x31b547(0x208)]=0x2a]='Delete',_0x58f8f0[_0x58f8f0[_0x31b547(0x1a3)]=0x2b]=_0x31b547(0x1a3),_0x58f8f0[_0x58f8f0[_0x31b547(0x224)]=0x2c]='ViewHistory',_0x58f8f0[_0x58f8f0['CreatePermissionObject']=0x2d]=_0x31b547(0x15e),_0x58f8f0[_0x58f8f0[_0x31b547(0xdd)]=-0x1]=_0x31b547(0xdd),_0x58f8f0))(_0x3df9c5||{});function _0x4ac758(_0x500766){const _0x40c2a5=_0x31b547;return!!(_0x500766&&_0x500766['code']&&_0x500766[_0x40c2a5(0x183)]!==_0x3f26b4['OK']&&_0x500766[_0x40c2a5(0x183)]!=='OK');}const _0x558a9b=(_0x14747b,_0x48459c)=>{const _0x1879b8=_0x31b547;if(!_0x14747b)return{'date':'','time':''};const _0x21e3a3=new Date(_0x14747b),_0xbfc4c5=_0x21e3a3['toISOString']()['split']('T')[0x0];switch(_0x48459c){case _0x242e1a[_0x1879b8(0x165)]['ZH_CN']:return{'date':_0x10059b(_0xbfc4c5,_0x48459c),'time':_0x21e3a3[_0x1879b8(0x274)]()+':'+String(_0x21e3a3[_0x1879b8(0x1c1)]())[_0x1879b8(0x24b)](0x2,'0')};default:return{'date':_0x10059b(_0xbfc4c5,_0x48459c),'time':_0x21e3a3[_0x1879b8(0x274)]()+':'+_0x21e3a3[_0x1879b8(0x1c1)]()};}},_0x556eb6=(_0xea3da5,_0x34f178)=>{const _0x1dcfeb=_0x31b547,_0x3c6f5=_0xea3da5[_0x1dcfeb(0xd6)]||_0x34f178['t']('editHistory.panel.unknownUser');if(_0xea3da5[_0x1dcfeb(0x269)][_0x1dcfeb(0x12f)](_0x1fe97f=>_0x1fe97f===_0xa43662['RevertRevisionMutation']['id'])&&_0xea3da5[_0x1dcfeb(0xd1)]){const _0x24d767=_0x558a9b(_0xea3da5[_0x1dcfeb(0xd1)],_0x34f178[_0x1dcfeb(0xfe)]()),_0x14e34d=_0x24d767[_0x1dcfeb(0x173)]+'\x20'+_0x24d767[_0x1dcfeb(0x1de)];return _0x3c6f5+'\x20'+_0x34f178['t'](_0x1dcfeb(0x264))+'\x20'+_0x14e34d+'\x20'+_0x34f178['t']('editHistory.action.revertSheetSuffix');}const _0x5f3886=_0x55b2be(_0xea3da5),_0x3c0813=_0x5f3886[_0x1dcfeb(0x263)]===0x1?_0x34f178['t'](_0x5f3886[0x0]):''+_0x34f178['t'](_0x5f3886[0x0])+_0x34f178['t'](_0x1dcfeb(0x10d));return _0x3c6f5+'\x20'+_0x3c0813;};function _0x55b2be(_0xa65105){const _0x126cb4=_0x31b547;if(_0xa65105[_0x126cb4(0x269)][_0x126cb4(0x263)]===0x0)return[''];const _0x5958fa=_0x126cb4(0x25e),_0x215bf4=_0x5958fa+_0x126cb4(0x291),_0x3822c5=[{'id':_0xa43662['CreateUnitMutation']['id'],'action':_0x5958fa+_0x126cb4(0xf1)},{'id':_0xa43662[_0x126cb4(0x2a6)]['id'],'action':_0x5958fa+_0x126cb4(0x105)},{'id':_0x467fd2['InsertSheetMutation']['id'],'action':_0x5958fa+_0x126cb4(0x137)},{'id':_0x467fd2[_0x126cb4(0x270)]['id'],'action':_0x5958fa+_0x126cb4(0x19d)},{'id':_0x467fd2['SetFrozenMutation']['id'],'action':_0x5958fa+_0x126cb4(0x162)},{'id':_0x2eebc6[_0x126cb4(0x1cc)]['id'],'action':_0x5958fa+_0x126cb4(0xf7)},{'id':_0x2b3974[_0x126cb4(0x112)]['id'],'action':_0x5958fa+_0x126cb4(0x132)},{'id':_0x2b3974[_0x126cb4(0x1be)]['id'],'action':_0x5958fa+_0x126cb4(0x132)},{'id':_0x532ec1[_0x126cb4(0x204)]['id'],'action':_0x5958fa+_0x126cb4(0x14d)},{'id':_0x532ec1[_0x126cb4(0x2ad)]['id'],'action':_0x5958fa+_0x126cb4(0x14d)},{'id':_0x467fd2[_0x126cb4(0x104)]['id'],'action':_0x5958fa+_0x126cb4(0x21e)},{'id':_0x467fd2['AddRangeProtectionMutation']['id'],'action':_0x5958fa+_0x126cb4(0x21e)},{'id':_0x52613e[_0x126cb4(0x217)]['id'],'action':_0x5958fa+'addSparkline'},{'id':_0x467fd2[_0x126cb4(0x184)]['id'],'action':_0x5958fa+_0x126cb4(0x167)},{'id':_0x467fd2['DeleteWorksheetProtectionMutation']['id'],'action':_0x5958fa+_0x126cb4(0x167)}][_0x126cb4(0x216)](_0x3771b5=>_0xa65105[_0x126cb4(0x269)][_0x126cb4(0x22a)](_0x3771b5['id']));return _0x3822c5!=null&&_0x3822c5['length']?_0x3822c5['map'](_0x39bbb7=>_0x39bbb7[_0x126cb4(0x147)]):[_0x215bf4];}function _0x10059b(_0x3b4c13,_0xcd7a75){const _0x5d293f=_0x31b547,[_0x5d3579,_0x478f63,_0x2d673f]=new Date()[_0x5d293f(0x2ae)]()[_0x5d293f(0x15d)]('T')[0x0][_0x5d293f(0x15d)]('-'),[_0x2370bb,_0x33185f,_0x554c5b]=_0x3b4c13[_0x5d293f(0x15d)]('-'),_0x4af5c6=_0x5d3579===_0x2370bb&&_0x478f63===_0x33185f&&_0x2d673f===_0x554c5b;let _0x4bc2d1='',_0x16acad='',_0x3d27e6='';switch(_0xcd7a75){case _0x242e1a[_0x5d293f(0x165)][_0x5d293f(0x1ac)]:return _0x4af5c6?'今天':(_0x4bc2d1=_0x5d3579===_0x2370bb?'':_0x2370bb+'年',_0x16acad=_0x33185f+'月',_0x3d27e6=_0x554c5b+'日',''+_0x4bc2d1+_0x16acad+_0x3d27e6);default:return _0x4af5c6?_0x5d293f(0x16f):(_0x4bc2d1=_0x5d3579===_0x2370bb?'':_0x2370bb+'-',_0x16acad=_0x33185f+'-',_0x3d27e6=''+_0x554c5b,''+_0x4bc2d1+_0x16acad+_0x3d27e6);}}function _0x521051(_0x2ebe50){const _0x32f199=_0x31b547;return _0x2ebe50?_0x2ebe50[_0x32f199(0x178)]((_0x43f7aa,_0x1e84b4)=>{const _0x503f82=_0x32f199,_0x423f80=new Date(_0x1e84b4[_0x503f82(0x1de)])[_0x503f82(0x2ae)]()['split']('T')[0x0];return _0x43f7aa['length']>0x0&&_0x43f7aa[_0x43f7aa[_0x503f82(0x263)]-0x1][_0x503f82(0xf3)]===_0x423f80?_0x43f7aa[_0x43f7aa[_0x503f82(0x263)]-0x1][_0x503f82(0x175)][_0x503f82(0x9d)](_0x1e84b4):_0x43f7aa[_0x503f82(0x9d)]({'dateString':_0x423f80,'versions':[_0x1e84b4]}),_0x43f7aa;},[]):[];}var _0x49b78e=Object[_0x31b547(0xee)],_0x5b717d=(_0x557e5a,_0x45ff8b,_0xe9eb38,_0x429a60)=>{for(var _0x4fcdbd=_0x429a60>0x1?void 0x0:_0x429a60?_0x49b78e(_0x45ff8b,_0xe9eb38):_0x45ff8b,_0x4defb8=_0x557e5a['length']-0x1,_0x12bdfa;_0x4defb8>=0x0;_0x4defb8--)(_0x12bdfa=_0x557e5a[_0x4defb8])&&(_0x4fcdbd=_0x12bdfa(_0x4fcdbd)||_0x4fcdbd);return _0x4fcdbd;},_0xde113=(_0x3d5130,_0x172e9b)=>(_0x721783,_0x49db48)=>_0x172e9b(_0x721783,_0x49db48,_0x3d5130);const _0x589cb3=_0x31b547(0xae);let _0x1e528b=class extends _0x242e1a['Disposable']{constructor(_0xe7edda,_0x24f3e0,_0x13db19,_0x543baf,_0x160d5a,_0xfbaf75,_0x28c8be){const _0x2218c1=_0x31b547;super(),_0x554995(this,_0x2218c1(0xf0),new Map()),(this['_snapshotServerService']=_0xe7edda,this[_0x2218c1(0x1e6)]=_0x24f3e0,this['_commandService']=_0x13db19,this[_0x2218c1(0x1e5)]=_0x543baf,this[_0x2218c1(0x198)]=_0x160d5a,this['_compressMutationService']=_0xfbaf75,this[_0x2218c1(0x26d)]=_0x28c8be);}[_0x31b547(0x21a)](){const _0x10557a=_0x31b547;this[_0x10557a(0xf0)][_0x10557a(0x9f)](),super['dispose']();}async['getVersions'](_0x5e1ccc,_0x3e8098){const _0x16e7bb=_0x31b547,_0x3668c4=this[_0x16e7bb(0x227)]()+'/'+_0x5e1ccc+'/list?length=20'+(_0x3e8098?_0x16e7bb(0x259)+_0x3e8098:'');try{const _0x328d16=(await this[_0x16e7bb(0x198)]['get'](_0x3668c4))['body'];if(_0x328d16&&_0x328d16['error']&&_0x328d16[_0x16e7bb(0x277)][_0x16e7bb(0x183)]===_0x3f26b4['OK']){const {hasMore:_0x208a1d,lastLabel:_0x4852db}=_0x328d16,_0x4674d6=_0x4052b4(_0x328d16),_0x7db076=_0x328d16[_0x16e7bb(0x268)][_0x16e7bb(0x12b)];return{'hasMore':_0x208a1d,'lastLabel':_0x4852db,'versions':_0x4674d6,'members':_0x7db076};}}catch(_0x33b820){console[_0x16e7bb(0x277)](_0x33b820);}return null;}[_0x31b547(0x227)](){const _0x3fdf16=_0x31b547;var _0x383e26;const _0x345d47=this[_0x3fdf16(0x1e5)][_0x3fdf16(0x1db)](_0x1ac248);return(_0x383e26=_0x345d47==null?void 0x0:_0x345d47['historyListServerUrl'])!=null?_0x383e26:_0x589cb3;}async[_0x31b547(0xed)](_0x2fdb6d,_0x1d9d89,_0x52a5ad){const _0xb3edf2=_0x31b547;var _0x4d5973,_0xcc03ee;_0x52a5ad===void 0x0&&(_0x52a5ad={}),this[_0xb3edf2(0xf0)][_0xb3edf2(0x1e2)](_0x2fdb6d)||this[_0xb3edf2(0xf0)][_0xb3edf2(0xbf)](_0x2fdb6d,new Map());const {snapshot:_0x4e7433,changesets:_0x506ce6,error:_0x44dce2}=await this[_0xb3edf2(0x15a)][_0xb3edf2(0x2b2)](_0x52a5ad,{'unitID':_0x2fdb6d,'type':_0x57e78f[_0xb3edf2(0x220)],'revision':_0x1d9d89});if(_0x4ac758(_0x44dce2)||!_0x4e7433||!_0x4e7433[_0xb3edf2(0x13a)])throw new Error(_0xb3edf2(0x2c5));const _0x8a7fba=(_0x4d5973=_0x506ce6==null?void 0x0:_0x506ce6[_0xb3edf2(0x263)])!=null?_0x4d5973:0x0;if(_0x1d9d89!==0x0&&_0x4e7433[_0xb3edf2(0x1bf)]+_0x8a7fba!==_0x1d9d89)throw new Error(_0xb3edf2(0x239));const {workbook:_0xa9717c}=_0x4e7433,_0xbb48b7=_0xa9717c[_0xb3edf2(0x25f)]?Object['entries'](_0xa9717c['blockMeta'])[_0xb3edf2(0x280)](([_0x2341d7,_0x4dfb79])=>{const _0x1e50bc=_0xb3edf2;var _0x1b94ab,_0x2e3ee2;return(_0x2e3ee2=(_0x1b94ab=_0x4dfb79[_0x1e50bc(0x248)])==null?void 0x0:_0x1b94ab['map'](_0x5cda98=>_0x5cda98))!=null?_0x2e3ee2:[];})['flat']():[],_0x3f0a83=(await Promise[_0xb3edf2(0x294)](_0xbb48b7[_0xb3edf2(0x280)](_0x372ab1=>this['_snapshotServerService'][_0xb3edf2(0x1f1)](_0x52a5ad,{'unitID':_0x2fdb6d,'type':_0x57e78f[_0xb3edf2(0x220)],'blockID':_0x372ab1})[_0xb3edf2(0x1da)](_0x3166fb=>_0x3166fb[_0xb3edf2(0x149)]))))['filter'](_0x6ec88=>!!_0x6ec88),_0x5980d6=_0xa43662['transformSnapshotToWorkbookData'](_0x4e7433,_0x3f0a83,_0x52a5ad);return(_0xcc03ee=this[_0xb3edf2(0xf0)]['get'](_0x2fdb6d))==null||_0xcc03ee[_0xb3edf2(0xbf)](_0x1d9d89,{'workbook':_0x5980d6}),new Promise(_0x4b6cc1=>{const _0x49736d=_0xb3edf2,_0x2dff9a=this[_0x49736d(0x1e6)][_0x49736d(0x121)](_0x242e1a[_0x49736d(0x24c)][_0x49736d(0x220)]);_0x2dff9a?(this[_0x49736d(0x1e6)][_0x49736d(0x25b)](_0x2dff9a[_0x49736d(0xb5)]()),setTimeout(()=>{const _0x203259=_0x49736d;this[_0x203259(0x19c)](_0x5980d6,_0x506ce6),this[_0x203259(0x26d)][_0x203259(0x24d)](),_0x4b6cc1(!0x0);},0x0)):(this['_createUnit'](_0x5980d6,_0x506ce6),_0x4b6cc1(!0x0));});}[_0x31b547(0x19c)](_0x29b036,_0x3fd315){const _0xdd62eb=_0x31b547,_0x5e618a=this[_0xdd62eb(0x1e6)][_0xdd62eb(0x126)](_0x242e1a[_0xdd62eb(0x24c)][_0xdd62eb(0x220)],_0x29b036);this['_univerInstanceService'][_0xdd62eb(0x297)](_0x5e618a[_0xdd62eb(0xb5)]());const _0x12d8e3=this[_0xdd62eb(0x2c1)][_0xdd62eb(0x1fe)][_0xdd62eb(0x23c)](this['_compressMutationService'][_0xdd62eb(0x1fe)][_0xdd62eb(0x1cb)]()[_0xdd62eb(0x242)]);return _0x3fd315==null||_0x3fd315[_0xdd62eb(0x1f5)](_0x2cb55f=>{const _0x2ad601=_0xdd62eb,_0x250d64=_0x2cb55f['mutations']['map'](_0x11bccc=>({'id':_0x11bccc['id'],'params':JSON[_0x2ad601(0x13d)](_0x11bccc[_0x2ad601(0x10e)])}));({..._0x2cb55f,'mutations':_0x12d8e3(_0x250d64,null)||_0x250d64}[_0x2ad601(0x9b)][_0x2ad601(0x1f5)](_0x2ff079=>{const _0x18a575=_0x2ad601;this[_0x18a575(0x185)][_0x18a575(0x1a7)](_0x2ff079['id'])&&this['_commandService'][_0x18a575(0x1f7)](_0x2ff079['id'],_0x2ff079[_0x18a575(0x2a0)]);}));}),_0x5e618a;}};_0x1e528b=_0x5b717d([_0xde113(0x0,_0xa43662['ISnapshotServerService']),_0xde113(0x1,_0x242e1a['IUniverInstanceService']),_0xde113(0x2,_0x242e1a[_0x31b547(0xa5)]),_0xde113(0x3,_0x242e1a[_0x31b547(0x22c)]),_0xde113(0x4,_0x242e1a['Inject'](_0x3ebdc4[_0x31b547(0x129)])),_0xde113(0x5,_0x242e1a[_0x31b547(0x11f)](_0xa43662[_0x31b547(0x211)])),_0xde113(0x6,_0x242e1a[_0x31b547(0x11f)](_0x467fd2[_0x31b547(0x230)]))],_0x1e528b);function _0x4052b4(_0x564b08){const _0x2d52e8=_0x31b547;var _0x21dd95,_0x58b092;const _0x3a705d=[],{entities:_0x39c252,historyIds:_0x567365}=_0x564b08,{datas:_0x2de79c,users:_0x2267b5}=_0x39c252;for(const _0xd1b61e of _0x567365)if(_0x2de79c[_0xd1b61e]){const _0x46f8ca=!!((_0x21dd95=_0x2267b5[_0x2de79c[_0xd1b61e][_0x2d52e8(0x200)]])!=null&&_0x21dd95['anonymous']);_0x3a705d[_0x2d52e8(0x9d)]({'unitId':_0x2de79c[_0xd1b61e][_0x2d52e8(0x148)],'user':_0x46f8ca?'':((_0x58b092=_0x2267b5==null?void 0x0:_0x2267b5[_0x2de79c[_0xd1b61e][_0x2d52e8(0x200)]])==null?void 0x0:_0x58b092[_0x2d52e8(0xe2)])||'','isAnonymous':_0x46f8ca,'id':_0xd1b61e,'time':_0x2de79c[_0xd1b61e][_0x2d52e8(0x246)]?Number(_0x2de79c[_0xd1b61e]['createTime']):void 0x0,'commands':_0x2de79c[_0xd1b61e]['command'],'startRev':Number(_0x2de79c[_0xd1b61e]['startRevision']),'endRev':Number(_0x2de79c[_0xd1b61e][_0x2d52e8(0x12d)]),'recoverTime':_0x2de79c[_0xd1b61e]['recoverTime']?Number(_0x2de79c[_0xd1b61e][_0x2d52e8(0xd1)]):void 0x0});}return _0x3a705d;}var _0xa059e2=Object[_0x31b547(0xee)],_0xc3fd21=(_0x3b8481,_0x1fde2e,_0x4b2b2,_0x10fa2e)=>{const _0x2db6ff=_0x31b547;for(var _0x216cba=_0x10fa2e>0x1?void 0x0:_0x10fa2e?_0xa059e2(_0x1fde2e,_0x4b2b2):_0x1fde2e,_0x23f215=_0x3b8481[_0x2db6ff(0x263)]-0x1,_0x19f0e7;_0x23f215>=0x0;_0x23f215--)(_0x19f0e7=_0x3b8481[_0x23f215])&&(_0x216cba=_0x19f0e7(_0x216cba)||_0x216cba);return _0x216cba;},_0x1bcdd6=(_0x543db4,_0x22096e)=>(_0x18bba3,_0x32de44)=>_0x22096e(_0x18bba3,_0x32de44,_0x543db4),_0x3eaf5d=(_0x4f7259=>(_0x4f7259['Entered']=_0x31b547(0x1c3),_0x4f7259['Exited']=_0x31b547(0x2c3),_0x4f7259['Error']=_0x31b547(0x277),_0x4f7259))(_0x3eaf5d||{}),_0x576eaa=(_0x19cd17=>(_0x19cd17[_0x31b547(0xc1)]=_0x31b547(0x1bc),_0x19cd17[_0x31b547(0x16e)]='loading',_0x19cd17[_0x31b547(0x27c)]=_0x31b547(0xcd),_0x19cd17))(_0x576eaa||{});const _0x5e37df=_0x31b547(0x296);_0x4d70eb[_0x31b547(0x1fd)]=class extends _0x242e1a['Disposable']{constructor(_0x2484b8,_0x59b52a,_0x4dbdc2,_0x3a0afd){const _0x34b4b7=_0x31b547;super(),_0x554995(this,_0x34b4b7(0x218),new _0x2a386a[(_0x34b4b7(0x2ac))]([])),_0x554995(this,'versions$',this[_0x34b4b7(0x218)]['asObservable']()),_0x554995(this,_0x34b4b7(0x15c),new _0x2a386a[(_0x34b4b7(0x2ac))]('')),_0x554995(this,_0x34b4b7(0xd4),this[_0x34b4b7(0x15c)][_0x34b4b7(0x1e8)]()),_0x554995(this,_0x34b4b7(0x28c),new _0x2a386a[(_0x34b4b7(0x2ac))](_0x34b4b7(0x1c3))),_0x554995(this,_0x34b4b7(0x161),this['_status$'][_0x34b4b7(0x1e8)]()),_0x554995(this,_0x34b4b7(0x172),new _0x2a386a[(_0x34b4b7(0x2ac))](0x0)),_0x554995(this,_0x34b4b7(0x29e),this[_0x34b4b7(0x172)][_0x34b4b7(0x1e8)]()),_0x554995(this,'_unitId$',new _0x2a386a[(_0x34b4b7(0x2ac))]('')),_0x554995(this,_0x34b4b7(0x2b9),this[_0x34b4b7(0xa2)][_0x34b4b7(0x1e8)]()),_0x554995(this,_0x34b4b7(0xdf),!0x1),_0x554995(this,_0x34b4b7(0x12c),new _0x2a386a['BehaviorSubject'](_0x34b4b7(0x1bc))),_0x554995(this,'loadingState$',this[_0x34b4b7(0x12c)]['asObservable']()),_0x554995(this,_0x34b4b7(0xac),null),_0x554995(this,_0x34b4b7(0x285),!0x0),_0x554995(this,'_members',new Map()),_0x554995(this,_0x34b4b7(0x188)),_0x554995(this,'_maskContainer'),_0x554995(this,_0x34b4b7(0xc7)),_0x554995(this,_0x34b4b7(0x134),!0x1),(this[_0x34b4b7(0x2b1)]=_0x2484b8,this[_0x34b4b7(0x2a5)]=_0x59b52a,this[_0x34b4b7(0x244)]=_0x4dbdc2,this[_0x34b4b7(0x282)]=_0x3a0afd);}async['triggerLoadVersions'](_0x5f2c01,_0xd6bb33,_0xd4f5ba){const _0x529118=_0x31b547;this[_0x529118(0x188)]=_0xd6bb33,this[_0x529118(0x134)]=_0xd4f5ba,this['_unitId$']['next'](_0x5f2c01),this[_0x529118(0xdf)]=!0x0;const _0x1f4459=await this['_historyFetchService'][_0x529118(0x1fa)](_0x5f2c01);if(this['_fetching']=!0x1,_0x1f4459){const {versions:_0x554d3e,lastLabel:_0xc9e02d,hasMore:_0x404040,members:_0x1016bf}=_0x1f4459;_0x554d3e[_0x529118(0x263)]===0x0&&_0x554d3e['push']({'unitId':_0x5f2c01,'id':_0x5e37df,'startRev':0x1,'endRev':0x0,'time':Date[_0x529118(0xa0)](),'user':this[_0x529118(0x244)]['t'](_0x529118(0x122)),'commands':[],'isAnonymous':!0x1}),this['_updateVersions'](_0x554d3e,_0x404040,_0xc9e02d,_0x1016bf),this[_0x529118(0x15c)][_0x529118(0x141)](_0x554d3e[0x0]['id']);}else this[_0x529118(0x28c)][_0x529118(0x141)](_0x529118(0x277));}async[_0x31b547(0x2b4)](){const _0x13f696=_0x31b547;if(!this[_0x13f696(0xac)]||!this[_0x13f696(0x285)]||this['_fetching'])return!0x1;this[_0x13f696(0xdf)]=!0x0;const _0x13fbe1=await this['_historyFetchService']['getVersions'](this[_0x13f696(0x148)],this[_0x13f696(0xac)]);if(this[_0x13f696(0xdf)]=!0x1,_0x13fbe1){const {versions:_0x4b734c,lastLabel:_0x1431bc,hasMore:_0x1deda1,members:_0x35615d}=_0x13fbe1;this['_updateVersions'](_0x4b734c,_0x1deda1,_0x1431bc,_0x35615d);}else this[_0x13f696(0x2b1)][_0x13f696(0x1d6)]({'content':this[_0x13f696(0x244)]['t'](_0x13f696(0x170)),'type':_0x368c21[_0x13f696(0x2cd)]['Error'],'duration':0xbb8});return!0x0;}async[_0x31b547(0x199)](_0x15b2bf){const _0x176b0d=_0x31b547;var _0xaeb6a3;const _0x2d6453=(_0xaeb6a3=this['_versions$'][_0x176b0d(0x266)])==null?void 0x0:_0xaeb6a3[_0x176b0d(0x1d8)](_0x455232=>_0x455232['id']===_0x15b2bf),{endRev:_0x405ba3}=_0x2d6453||{};_0x405ba3||_0x405ba3===0x0?(this[_0x176b0d(0x12c)][_0x176b0d(0x141)]('loading'),await this['_historyFetchService'][_0x176b0d(0xed)](this[_0x176b0d(0x148)],_0x405ba3),this['_loadingState$']['next'](_0x176b0d(0xcd))):this[_0x176b0d(0x28c)]['next'](_0x176b0d(0x277));}async[_0x31b547(0xcf)](_0x311a79){const _0x588636=_0x31b547,_0x764c40=_0x311a79?this[_0x588636(0x258)](_0x311a79):this['getCurrentVersion']();if(!_0x764c40)return;const _0x3b1d8a=_0x764c40[_0x588636(0x22d)],_0x347aa9=_0x558a9b(_0x764c40[_0x588636(0x1de)],this[_0x588636(0x244)][_0x588636(0xfe)]());await this[_0x588636(0x2a5)][_0x588636(0x1d9)]({'id':_0x588636(0x23a),'title':{'title':this['_localeService']['t'](_0x588636(0x249))},'children':{'title':this['_localeService']['t']('editHistory.panel.revertConfirmText')+_0x588636(0x2d3)+_0x347aa9[_0x588636(0x173)]+'\x20'+_0x347aa9[_0x588636(0x1de)]+')'},'cancelText':this['_localeService']['t'](_0x588636(0xe8)),'confirmText':this[_0x588636(0x244)]['t'](_0x588636(0xc8))})&&this[_0x588636(0x172)]['next'](_0x3b1d8a);}[_0x31b547(0xc0)](_0x200c4a,_0xaeaf4e,_0x2f07bd,_0x17e087){const _0x3a41a1=_0x31b547;this['_versions$']['next'](this['_versions$'][_0x3a41a1(0x266)][_0x3a41a1(0x22b)](_0x200c4a)),this[_0x3a41a1(0x285)]=_0xaeaf4e,this[_0x3a41a1(0xac)]=_0x2f07bd,_0x17e087&&Object[_0x3a41a1(0x99)](_0x17e087)['forEach'](_0x22048b=>this[_0x3a41a1(0x2c6)][_0x3a41a1(0xbf)](_0x22048b,_0x17e087[_0x22048b]));}['getCurrentVersion'](){const _0x3c766e=_0x31b547;return this[_0x3c766e(0x258)](this['_currentVersion$'][_0x3c766e(0x266)]);}['getVersion'](_0xdec813){const _0x293568=_0x31b547;var _0x1a41d6;return(_0x1a41d6=this[_0x293568(0x218)][_0x293568(0x266)])==null?void 0x0:_0x1a41d6[_0x293568(0x1d8)](_0x3a45ce=>_0x3a45ce['id']===_0xdec813);}[_0x31b547(0xa8)](_0x4225d5){const _0x48ccfa=_0x31b547;return this['_members'][_0x48ccfa(0x272)](_0x4225d5);}[_0x31b547(0x290)](){const _0x39e4e4=_0x31b547;this[_0x39e4e4(0xc7)]=document[_0x39e4e4(0x103)]('div'),this[_0x39e4e4(0xc7)]['className']=_0x39e4e4(0x22e),this['_maskElement'][_0x39e4e4(0x2c7)][_0x39e4e4(0x10a)]='absolute',this[_0x39e4e4(0xc7)][_0x39e4e4(0x2c7)][_0x39e4e4(0xaf)]='0',this[_0x39e4e4(0xc7)][_0x39e4e4(0x2c7)][_0x39e4e4(0xdc)]='0',this[_0x39e4e4(0xc7)][_0x39e4e4(0x2c7)][_0x39e4e4(0x234)]='100%',this[_0x39e4e4(0xc7)][_0x39e4e4(0x2c7)][_0x39e4e4(0x18c)]=_0x39e4e4(0x229),this[_0x39e4e4(0xc7)]['style']['backgroundColor']=_0x39e4e4(0x26a),this[_0x39e4e4(0xc7)][_0x39e4e4(0x2c7)]['color']=_0x39e4e4(0x17e),this['_maskElement'][_0x39e4e4(0x2c7)]['display']=_0x39e4e4(0x222),this[_0x39e4e4(0xc7)][_0x39e4e4(0x2c7)][_0x39e4e4(0xb9)]=_0x39e4e4(0x2ba),this[_0x39e4e4(0xc7)][_0x39e4e4(0x2c7)][_0x39e4e4(0x14f)]=_0x39e4e4(0x225),this[_0x39e4e4(0xc7)][_0x39e4e4(0x2c7)][_0x39e4e4(0x1f6)]=_0x39e4e4(0x154),this[_0x39e4e4(0x2a9)]['append'](this[_0x39e4e4(0xc7)]);}[_0x31b547(0x16c)](){const _0x448ef4=_0x31b547;var _0x41ba1f;const _0x10eadd=(_0x41ba1f=document[_0x448ef4(0x19a)](this[_0x448ef4(0x188)]))==null?void 0x0:_0x41ba1f[_0x448ef4(0x228)](_0x448ef4(0x29f));_0x10eadd&&(this[_0x448ef4(0x2a9)]=_0x10eadd,this[_0x448ef4(0x290)]());}[_0x31b547(0x138)](){const _0x357b2c=_0x31b547;this[_0x357b2c(0x2a9)]||this['_initMaskContainer'](),this[_0x357b2c(0xc7)]&&(this[_0x357b2c(0xc7)][_0x357b2c(0x2c7)][_0x357b2c(0x1f6)]='flex');}[_0x31b547(0x98)](){const _0xa94c1c=_0x31b547;this[_0xa94c1c(0xc7)]&&(this['_maskElement'][_0xa94c1c(0x2c7)]['display']=_0xa94c1c(0x154));}set[_0x31b547(0xb3)](_0x2c50d7){this['_status$']['next'](_0x2c50d7);}set[_0x31b547(0x28b)](_0x5250a3){const _0x4cccba=_0x31b547;_0x5250a3!==this[_0x4cccba(0x15c)][_0x4cccba(0x266)]&&this['_currentVersion$'][_0x4cccba(0x141)](_0x5250a3);}get[_0x31b547(0x28b)](){return this['_currentVersion$']['value'];}set['unitId'](_0x20390a){const _0x5c526b=_0x31b547;this[_0x5c526b(0xa2)]['next'](_0x20390a);}get[_0x31b547(0x148)](){const _0xd780e5=_0x31b547;return this[_0xd780e5(0xa2)][_0xd780e5(0x266)];}get[_0x31b547(0x2a8)](){const _0x954e48=_0x31b547;return this[_0x954e48(0x134)];}get[_0x31b547(0x205)](){const _0x1253e3=_0x31b547;return this[_0x1253e3(0x12c)]['value'];}},_0x4d70eb[_0x31b547(0x1fd)]=_0xc3fd21([_0x1bcdd6(0x0,_0x1bf0bf[_0x31b547(0x1b8)]),_0x1bcdd6(0x1,_0x1bf0bf[_0x31b547(0x1d3)]),_0x1bcdd6(0x2,_0x242e1a['Inject'](_0x242e1a[_0x31b547(0x113)])),_0x1bcdd6(0x3,_0x242e1a[_0x31b547(0x11f)](_0x1e528b))],_0x4d70eb[_0x31b547(0x1fd)]);function _0xd27a99({ref:_0x5d0250,..._0x3f2690}){const _0x18ac28=_0x31b547,{icon:_0xd0316b,id:_0x693385,className:_0x364555,extend:_0x2822aa,..._0x50f41e}=_0x3f2690,_0x3a745c=(_0x18ac28(0x19b)+_0x693385+'\x20'+(_0x364555||''))['trim'](),_0xf6d7a3=_0x3f8f3c[_0x18ac28(0xc5)]('_'+_0x4dee21());return _0xffafb3(_0xd0316b,''+_0x693385,{'defIds':_0xd0316b['defIds'],'idSuffix':_0xf6d7a3[_0x18ac28(0x289)]},{'ref':_0x5d0250,'className':_0x3a745c,..._0x50f41e},_0x2822aa);}function _0xffafb3(_0x156428,_0x24f309,_0x15f7b5,_0x562889,_0x17983e){const _0x119960=_0x31b547;return _0x3f8f3c['createElement'](_0x156428[_0x119960(0x245)],{'key':_0x24f309,..._0x329378(_0x156428,_0x15f7b5,_0x17983e),..._0x562889},(_0x215454(_0x156428,_0x15f7b5)['children']||[])[_0x119960(0x280)]((_0x30c5e7,_0x30be40)=>_0xffafb3(_0x30c5e7,_0x24f309+'-'+_0x156428[_0x119960(0x245)]+'-'+_0x30be40,_0x15f7b5,void 0x0,_0x17983e)));}function _0x329378(_0x411bf2,_0x270ee7,_0x1122d7){const _0x59c0f8=_0x31b547,_0x34093a={..._0x411bf2[_0x59c0f8(0x159)]};_0x1122d7!=null&&_0x1122d7[_0x59c0f8(0x1b7)]&&_0x34093a[_0x59c0f8(0x18f)]===_0x59c0f8(0x1b7)&&(_0x34093a[_0x59c0f8(0x18f)]=_0x1122d7[_0x59c0f8(0x1b7)]),_0x411bf2['tag']===_0x59c0f8(0x255)&&_0x34093a['id']&&(_0x34093a['id']=_0x34093a['id']+_0x270ee7[_0x59c0f8(0x197)]),Object['entries'](_0x34093a)[_0x59c0f8(0x1f5)](([_0x29eb41,_0x15526e])=>{const _0xdccd40=_0x59c0f8;_0x29eb41===_0xdccd40(0x255)&&typeof _0x15526e=='string'&&(_0x34093a[_0x29eb41]=_0x15526e['replace'](/url\(#(.*)\)/,_0xdccd40(0x20e)+_0x270ee7[_0xdccd40(0x197)]+')'));});const {defIds:_0x6c3179}=_0x270ee7;return!_0x6c3179||_0x6c3179[_0x59c0f8(0x263)]===0x0||(_0x411bf2[_0x59c0f8(0x245)]===_0x59c0f8(0x2b5)&&_0x34093a['xlink:href']&&(_0x34093a[_0x59c0f8(0xe7)]=_0x34093a[_0x59c0f8(0xe7)]+_0x270ee7[_0x59c0f8(0x197)]),Object[_0x59c0f8(0x116)](_0x34093a)[_0x59c0f8(0x1f5)](([_0x4b222f,_0x3f3b43])=>{const _0x477b82=_0x59c0f8;typeof _0x3f3b43==_0x477b82(0xd3)&&(_0x34093a[_0x4b222f]=_0x3f3b43['replace'](/url\(#(.*)\)/,_0x477b82(0x20e)+_0x270ee7['idSuffix']+')'));})),_0x34093a;}function _0x215454(_0xe26dc2,_0xe641bd){const _0x65ecaa=_0x31b547;var _0x20dd50;const {defIds:_0x1b9e9b}=_0xe641bd;return!_0x1b9e9b||_0x1b9e9b[_0x65ecaa(0x263)]===0x0?_0xe26dc2:_0xe26dc2[_0x65ecaa(0x245)]==='defs'&&((_0x20dd50=_0xe26dc2['children'])!=null&&_0x20dd50['length'])?{..._0xe26dc2,'children':_0xe26dc2[_0x65ecaa(0x28e)]['map'](_0x25090a=>typeof _0x25090a[_0x65ecaa(0x159)]['id']==_0x65ecaa(0xd3)&&_0x1b9e9b&&_0x1b9e9b['includes'](_0x25090a[_0x65ecaa(0x159)]['id'])?{..._0x25090a,'attrs':{..._0x25090a[_0x65ecaa(0x159)],'id':_0x25090a['attrs']['id']+_0xe641bd['idSuffix']}}:_0x25090a)}:_0xe26dc2;}function _0x4dee21(){const _0x3ff2e3=_0x31b547;return Math['random']()['toString'](0x24)[_0x3ff2e3(0x1ef)](0x2,0x8);}_0xd27a99['displayName']='UniverIcon';const _0x117b3f={'tag':_0x31b547(0x284),'attrs':{'xmlns':_0x31b547(0x1dc),'fill':'none','viewBox':'0\x200\x2016\x2016','width':_0x31b547(0x102),'height':_0x31b547(0x102)},'children':[{'tag':_0x31b547(0x253),'attrs':{'fill':_0x31b547(0x1b0),'d':_0x31b547(0x18d)}}]},_0x7764d3=_0x3f8f3c[_0x31b547(0xcb)](function(_0x20889b,_0x15f116){const _0x5789fc=_0x31b547;return _0x3f8f3c[_0x5789fc(0x103)](_0xd27a99,Object[_0x5789fc(0x19e)]({},_0x20889b,{'id':'back-icon','ref':_0x15f116,'icon':_0x117b3f}));});_0x7764d3[_0x31b547(0x107)]=_0x31b547(0x2a4);const _0x4e8567={'tag':'svg','attrs':{'xmlns':_0x31b547(0x1dc),'fill':_0x31b547(0x154),'viewBox':_0x31b547(0x21b),'width':_0x31b547(0x102),'height':_0x31b547(0x102)},'children':[{'tag':'g','attrs':{'fill':'currentColor','clipPath':_0x31b547(0x179)},'children':[{'tag':'path','attrs':{'d':_0x31b547(0x13e)}},{'tag':'path','attrs':{'d':_0x31b547(0xb4),'fillRule':_0x31b547(0x158),'clipRule':_0x31b547(0x158)}}]},{'tag':_0x31b547(0x182),'attrs':{},'children':[{'tag':_0x31b547(0x278),'attrs':{'id':_0x31b547(0x28a)},'children':[{'tag':_0x31b547(0xa4),'attrs':{'width':0x10,'height':0x10,'y':0.05,'fill':'white','rx':0x4}}]}]}],'defIds':[_0x31b547(0x28a)]},_0x343251=_0x3f8f3c[_0x31b547(0xcb)](function(_0x3530e0,_0x3ace04){const _0x2823ed=_0x31b547;return _0x3f8f3c[_0x2823ed(0x103)](_0xd27a99,Object['assign']({},_0x3530e0,{'id':_0x2823ed(0x1a8),'ref':_0x3ace04,'icon':_0x4e8567}));});_0x343251[_0x31b547(0x107)]='RestoreIcon';const _0x1f2635={'tag':'svg','attrs':{'xmlns':_0x31b547(0x1dc),'fill':'none','viewBox':_0x31b547(0x17d),'width':'1em','height':_0x31b547(0x102)},'children':[{'tag':_0x31b547(0x253),'attrs':{'fill':_0x31b547(0xf2),'d':'M8.79993\x2014.0166C8.79993\x2014.4585\x208.44176\x2014.8166\x207.99993\x2014.8166C4.23529\x2014.8166\x201.18345\x2011.7648\x201.18345\x208.00017C1.18345\x204.23554\x204.23529\x201.18369\x207.99993\x201.1837C11.7646\x201.1837\x2014.8164\x204.23554\x2014.8164\x208.00017C14.8164\x208.442\x2014.4582\x208.80017\x2014.0164\x208.80017C13.5746\x208.80017\x2013.2164\x208.442\x2013.2164\x208.00017C13.2164\x205.11919\x2010.8809\x202.7837\x207.99993\x202.7837C5.11895\x202.7837\x202.78345\x205.11919\x202.78345\x208.00017C2.78345\x2010.8812\x205.11895\x2013.2166\x207.99993\x2013.2166C8.44176\x2013.2166\x208.79993\x2013.5748\x208.79993\x2014.0166Z','fillOpacity':0.2,'fillRule':_0x31b547(0x158),'clipRule':'evenodd'}},{'tag':_0x31b547(0x253),'attrs':{'fill':_0x31b547(0xf2),'d':'M7.20007\x201.98384C7.20007\x201.54201\x207.55824\x201.18384\x208.00007\x201.18384C11.7647\x201.18384\x2014.8165\x204.23568\x2014.8165\x208.00032C14.8165\x2011.765\x2011.7647\x2014.8168\x208.00007\x2014.8168C4.23543\x2014.8168\x201.18359\x2011.765\x201.18359\x208.00032C1.18359\x207.55849\x201.54177\x207.20031\x201.98359\x207.20031C2.42542\x207.20031\x202.78359\x207.55849\x202.78359\x208.00032C2.78359\x2010.8813\x205.11909\x2013.2168\x208.00007\x2013.2168C10.8811\x2013.2168\x2013.2165\x2010.8813\x2013.2165\x208.00032C13.2165\x205.11933\x2010.8811\x202.78384\x208.00007\x202.78384C7.55824\x202.78384\x207.20007\x202.42567\x207.20007\x201.98384Z','fillRule':'evenodd','clipRule':_0x31b547(0x158)}}]},_0x265f14=_0x3f8f3c[_0x31b547(0xcb)](function(_0x2ce705,_0x33d708){const _0x426226=_0x31b547;return _0x3f8f3c[_0x426226(0x103)](_0xd27a99,Object[_0x426226(0x19e)]({},_0x2ce705,{'id':'loading-multi-icon','ref':_0x33d708,'icon':_0x1f2635}));});_0x265f14[_0x31b547(0x107)]=_0x31b547(0xa3);function _0x3b7200(){const _0x3ffe2a=_0x31b547;var _0x434bdf;const _0x4b5a66=_0x1bf0bf[_0x3ffe2a(0x260)](_0x4d70eb['HistoryManagerService']),_0x5964b4=_0x1bf0bf[_0x3ffe2a(0x260)](_0x242e1a[_0x3ffe2a(0x113)]),_0x1f0fe8=_0x3f8f3c[_0x3ffe2a(0x2c2)](()=>{const _0x501697=_0x3ffe2a;_0x4b5a66[_0x501697(0xb3)]=_0x3eaf5d['Exited'];},[_0x4b5a66]),_0x53de66=_0x3f8f3c[_0x3ffe2a(0x2c2)](()=>{const _0xba2fdd=_0x3ffe2a;_0x4b5a66[_0xba2fdd(0xcf)]();},[_0x4b5a66]),_0x56db79=_0x1bf0bf[_0x3ffe2a(0x238)](_0x4b5a66[_0x3ffe2a(0xd4)]),_0xa29094=_0x1bf0bf[_0x3ffe2a(0x238)](_0x4b5a66[_0x3ffe2a(0x206)]),_0x5e9ecd=_0x56db79===((_0x434bdf=_0xa29094==null?void 0x0:_0xa29094[0x0])==null?void 0x0:_0x434bdf['id']),_0x2a10dc=_0x56db79!==''&&!_0x5e9ecd&&_0x4b5a66[_0x3ffe2a(0x2a8)];return _0x7b355a[_0x3ffe2a(0x27e)](_0x3ffe2a(0x2d1),{'className':_0x368c21[_0x3ffe2a(0x275)](_0x3ffe2a(0x202),_0x368c21[_0x3ffe2a(0x29c)]),'children':[_0x7b355a[_0x3ffe2a(0xfa)]('a',{'className':_0x3ffe2a(0x1d0),'role':_0x3ffe2a(0x1d4),'onClick':_0x1f0fe8,'children':_0x7b355a[_0x3ffe2a(0xfa)](_0x7764d3,{'className':_0x3ffe2a(0x25d)})}),_0x7b355a[_0x3ffe2a(0xfa)](_0x3ffe2a(0x2d1),{'className':'univer-flex\x20univer-flex-1\x20univer-items-center\x20univer-justify-center','children':_0x2a10dc&&_0x7b355a['jsx'](_0x368c21['Button'],{'variant':'primary','onClick':_0x53de66,'children':_0x5964b4['t'](_0x3ffe2a(0x1dd))})})]});}var _0x9ad3e2=Object[_0x31b547(0xee)],_0x18ab86=(_0x2b8668,_0x3f6b98,_0x213f28,_0x129853)=>{const _0x3bee9a=_0x31b547;for(var _0x29ef78=_0x129853>0x1?void 0x0:_0x129853?_0x9ad3e2(_0x3f6b98,_0x213f28):_0x3f6b98,_0x250efa=_0x2b8668[_0x3bee9a(0x263)]-0x1,_0x506cf1;_0x250efa>=0x0;_0x250efa--)(_0x506cf1=_0x2b8668[_0x250efa])&&(_0x29ef78=_0x506cf1(_0x29ef78)||_0x29ef78);return _0x29ef78;},_0x1696e5=(_0x4e6c45,_0x2d558e)=>(_0x3173a8,_0x418a4a)=>_0x2d558e(_0x3173a8,_0x418a4a,_0x4e6c45);let _0x509149=class extends _0x242e1a[_0x31b547(0x16b)]{constructor(_0x264d8e,_0x351638,_0x4c175f,_0x2dbed9,_0x2626c9,_0x5e96b9){const _0x454e7d=_0x31b547;super(),this[_0x454e7d(0x288)]=_0x264d8e,this['_uiPartsService']=_0x351638,this['_messageService']=_0x4c175f,this[_0x454e7d(0x244)]=_0x2dbed9,this[_0x454e7d(0x20a)]=_0x2626c9,this[_0x454e7d(0x1df)]=_0x5e96b9,this[_0x454e7d(0xea)]();}[_0x31b547(0xea)](){const _0x1fff5f=_0x31b547;this[_0x1fff5f(0x1c2)](this[_0x1fff5f(0x20a)][_0x1fff5f(0xd4)][_0x1fff5f(0x177)](_0x2bd3d9=>{const _0x514099=_0x1fff5f;_0x2bd3d9&&this['_historyManagerService'][_0x514099(0x199)](_0x2bd3d9);})),this[_0x1fff5f(0x1c2)](this['_permissionService']['permissionPointUpdate$'][_0x1fff5f(0x177)](_0x4a680e=>{const _0x25ee77=_0x1fff5f,_0x5ba603=this[_0x25ee77(0x20a)][_0x25ee77(0x148)];_0x5ba603&&(_0x4a680e[_0x25ee77(0x2d5)]===_0x3df9c5[_0x25ee77(0xfc)]&&_0x4a680e[_0x25ee77(0x266)]===!0x0&&this['_permissionService'][_0x25ee77(0x12e)](new _0x467fd2[(_0x25ee77(0x111))](_0x5ba603)['id'],!0x1),_0x4a680e[_0x25ee77(0x2d5)]===_0x3df9c5[_0x25ee77(0x1ff)]&&_0x4a680e['value']===!0x0&&this['_permissionService']['updatePermissionPoint'](new _0x467fd2[(_0x25ee77(0x2cb))](_0x5ba603)['id'],!0x1),_0x4a680e[_0x25ee77(0x2d5)]===_0x3df9c5['MoveSheet']&&_0x4a680e[_0x25ee77(0x266)]===!0x0&&this['_permissionService'][_0x25ee77(0x12e)](new _0x467fd2[(_0x25ee77(0x26b))](_0x5ba603)['id'],!0x1),_0x4a680e[_0x25ee77(0x2d5)]===_0x3df9c5[_0x25ee77(0x169)]&&_0x4a680e[_0x25ee77(0x266)]===!0x0&&this['_permissionService'][_0x25ee77(0x12e)](new _0x467fd2[(_0x25ee77(0x1e9))](_0x5ba603)['id'],!0x1),_0x4a680e[_0x25ee77(0x2d5)]===_0x3df9c5[_0x25ee77(0x1a1)]&&_0x4a680e[_0x25ee77(0x266)]===!0x0&&this['_permissionService'][_0x25ee77(0x12e)](new _0x467fd2[(_0x25ee77(0x111))](_0x5ba603)['id'],!0x1),_0x4a680e[_0x25ee77(0x2d5)]===_0x3df9c5[_0x25ee77(0x26f)]&&_0x4a680e[_0x25ee77(0x266)]===!0x0&&this['_permissionService'][_0x25ee77(0x12e)](new _0x467fd2['WorkbookEditablePermission'](_0x5ba603)['id'],!0x1));})),this['disposeWithMe'](this[_0x1fff5f(0x281)][_0x1fff5f(0xbb)](_0x1bf0bf['BuiltInUIPart'][_0x1fff5f(0x20c)],()=>_0x1bf0bf['connectInjector'](_0x3b7200,this[_0x1fff5f(0x1df)]))),this[_0x1fff5f(0x1c2)](this['_historyManagerService'][_0x1fff5f(0x13c)]['subscribe'](_0x4447bb=>{const _0x5a78d1=_0x1fff5f;_0x4447bb===_0x576eaa[_0x5a78d1(0x16e)]&&(this[_0x5a78d1(0x20a)]['showMask'](),this['_messageService']['show']({'type':_0x368c21[_0x5a78d1(0x2cd)][_0x5a78d1(0x135)],'content':this[_0x5a78d1(0x244)]['t'](_0x5a78d1(0x240))})),_0x4447bb===_0x576eaa[_0x5a78d1(0x27c)]&&this['_historyManagerService']['hideMask']();}));}};_0x509149=_0x18ab86([_0x1696e5(0x0,_0x242e1a[_0x31b547(0x254)]),_0x1696e5(0x1,_0x1bf0bf[_0x31b547(0x168)]),_0x1696e5(0x2,_0x1bf0bf[_0x31b547(0x1b8)]),_0x1696e5(0x3,_0x242e1a['Inject'](_0x242e1a['LocaleService'])),_0x1696e5(0x4,_0x242e1a[_0x31b547(0x11f)](_0x4d70eb[_0x31b547(0x1fd)])),_0x1696e5(0x5,_0x242e1a[_0x31b547(0x11f)](_0x242e1a[_0x31b547(0x265)]))],_0x509149);var _0x516ed6=Object['getOwnPropertyDescriptor'],_0x4b87a5=(_0x5a7b8c,_0x11a3c3,_0x16baf4,_0x1273ce)=>{const _0x5ece9e=_0x31b547;for(var _0x2f7629=_0x1273ce>0x1?void 0x0:_0x1273ce?_0x516ed6(_0x11a3c3,_0x16baf4):_0x11a3c3,_0x1c4202=_0x5a7b8c[_0x5ece9e(0x263)]-0x1,_0x5a59cb;_0x1c4202>=0x0;_0x1c4202--)(_0x5a59cb=_0x5a7b8c[_0x1c4202])&&(_0x2f7629=_0x5a59cb(_0x2f7629)||_0x2f7629);return _0x2f7629;},_0x4885e9=(_0x5c744c,_0x1977d1)=>(_0xf56ad,_0x5279a6)=>_0x1977d1(_0xf56ad,_0x5279a6,_0x5c744c);let _0xf4d0fb=class extends _0x242e1a[_0x31b547(0x16b)]{constructor(_0x10c8f0,_0x41d153,_0xc9774d){const _0x401dbb=_0x31b547;super(),_0x554995(this,_0x401dbb(0x24f),new Map()),_0x554995(this,'_currentVersionDiff$',new _0x2a386a[(_0x401dbb(0x2ac))]({'ranges':new Map(),'active':null})),_0x554995(this,'currentVersionDiff$',this[_0x401dbb(0x196)][_0x401dbb(0x1e8)]()),(this[_0x401dbb(0x20a)]=_0x10c8f0,this[_0x401dbb(0x120)]=_0x41d153,this['_snapshotServerService']=_0xc9774d,this[_0x401dbb(0xea)]());}[_0x31b547(0xea)](){const _0x4420f6=_0x31b547;this[_0x4420f6(0x24f)]=new Map(),this[_0x4420f6(0x1c2)](this['_historyManagerService'][_0x4420f6(0x2b9)][_0x4420f6(0x177)](_0x515656=>{const _0xeb352e=_0x4420f6;_0x515656&&!this['_diffRangesMap'][_0xeb352e(0x1e2)](_0x515656)&&this[_0xeb352e(0x24f)]['set'](_0x515656,new Map());})),this[_0x4420f6(0x1c2)](this[_0x4420f6(0x20a)][_0x4420f6(0xd4)][_0x4420f6(0x177)](async _0x9d24a9=>{const _0x35be8a=_0x4420f6;var _0x3d4c20;_0x9d24a9&&(await this[_0x35be8a(0x213)](_0x9d24a9),this['_currentVersionDiff$'][_0x35be8a(0x141)](((_0x3d4c20=this[_0x35be8a(0x24f)]['get'](this[_0x35be8a(0x20a)][_0x35be8a(0x148)]))==null?void 0x0:_0x3d4c20[_0x35be8a(0x272)](_0x9d24a9))||{'ranges':new Map(),'active':null}));}));}async[_0x31b547(0x213)](_0x2cad90){const _0x34a070=_0x31b547;var _0x45a6de,_0x359543;const _0x269d80=this[_0x34a070(0x20a)]['getVersion'](_0x2cad90),_0x397fe9=this[_0x34a070(0x20a)]['unitId'];if(!_0x269d80||!_0x397fe9)return;const _0x309df9=this[_0x34a070(0x24f)]['get'](_0x397fe9);if(_0x309df9||this['_diffRangesMap'][_0x34a070(0xbf)](_0x397fe9,new Map()),(_0x45a6de=this[_0x34a070(0x24f)][_0x34a070(0x272)](_0x397fe9))!=null&&_0x45a6de[_0x34a070(0x1e2)](_0x269d80['id']))return;const {startRev:_0x14577a,endRev:_0x223c21}=_0x269d80;if(_0x14577a===0x1){_0x309df9[_0x34a070(0xbf)](_0x269d80['id'],{'ranges':new Map(),'active':null});return;}const _0x5afd2d=_0x14577a-0x1,_0x2756a2=_0x223c21,_0x13187f=await this[_0x34a070(0x15a)][_0x34a070(0x119)]({},{'unitID':_0x397fe9,'from':_0x5afd2d,'to':_0x2756a2,'type':_0x57e78f[_0x34a070(0x220)]});if(((_0x359543=_0x13187f[_0x34a070(0x277)])==null?void 0x0:_0x359543[_0x34a070(0x183)])===_0x3f26b4['OK']){const _0x454d3c=_0x13187f[_0x34a070(0xa1)][_0x34a070(0x280)](_0x3658fd=>((_0x3658fd['mutations']===null||_0x3658fd[_0x34a070(0x9b)]===void 0x0)&&(_0x3658fd[_0x34a070(0x9b)]=[]),_0xa43662[_0x34a070(0x29d)](_0x3658fd)))[_0x34a070(0x280)](_0xfd3ca3=>_0xfd3ca3[_0x34a070(0x9b)][_0x34a070(0x280)](_0x13a234=>({..._0x13a234,'params':{..._0x13a234[_0x34a070(0x2a0)],'memberId':_0xfd3ca3[_0x34a070(0x191)]}})))['flat'](),_0x14f9b5=this[_0x34a070(0x19f)](_0x454d3c),_0x5289a4=this[_0x34a070(0x287)](_0x454d3c),_0xa3f889=this[_0x34a070(0xda)](_0x14f9b5);_0x309df9['set'](_0x269d80['id'],{'ranges':_0xa3f889,'active':_0x5289a4});}}[_0x31b547(0x19f)](_0x1acbd2){const _0x373794=_0x31b547;let _0x52c847=[];for(let _0x2ee5cf=0x0;_0x2ee5cf<_0x1acbd2['length'];_0x2ee5cf++){const _0x2e2987=_0x1acbd2[_0x2ee5cf];if(_0x52c847[_0x373794(0x9d)](_0x2e2987),_0x2ee5cf!==_0x1acbd2['length']-0x1){const _0xab06e6=_0x1acbd2[_0x2ee5cf+0x1],_0x5db412=this[_0x373794(0x120)][_0x373794(0x14e)](_0x52c847,[_0xab06e6]);_0xa43662['isTransformMutationsSuccess'](_0x5db412)?_0x52c847=_0x5db412[_0x373794(0xb0)]:_0x52c847=[];}}return _0x52c847;}[_0x31b547(0x287)](_0x28ba30){const _0x6b35b7=_0x31b547;let _0x38cfff=[];return _0x28ba30[_0x6b35b7(0x1f5)](_0x402737=>{const _0x6f8dc1=_0x6b35b7;if(_0x402737['id']===_0x467fd2[_0x6f8dc1(0x1e3)]['id']){const _0x215020=_0x402737[_0x6f8dc1(0x2a0)];_0x38cfff[_0x6f8dc1(0x9d)](_0x215020[_0x6f8dc1(0x142)]['id']);}else{if(_0x402737['id']===_0x467fd2[_0x6f8dc1(0x270)]['id']){const _0x2e1ef5=_0x402737[_0x6f8dc1(0x2a0)];_0x38cfff[_0x6f8dc1(0x263)]>0x0&&(_0x38cfff=_0x38cfff[_0x6f8dc1(0x216)](_0x3ab2d2=>_0x3ab2d2!==_0x2e1ef5['subUnitId']));}else{if(_0x402737['id']===_0x467fd2[_0x6f8dc1(0x9c)]['id']){const _0x4ba195=_0x402737[_0x6f8dc1(0x2a0)];_0x4ba195[_0x6f8dc1(0x1b2)]?_0x38cfff=_0x38cfff[_0x6f8dc1(0x216)](_0x79963c=>_0x79963c!==_0x4ba195[_0x6f8dc1(0x276)]):_0x38cfff[_0x6f8dc1(0x9d)](_0x4ba195[_0x6f8dc1(0x276)]);}else{const _0x37bf6a=_0x402737[_0x6f8dc1(0x2a0)];_0x37bf6a[_0x6f8dc1(0x276)]&&_0x38cfff[_0x6f8dc1(0x9d)](_0x37bf6a[_0x6f8dc1(0x276)]);}}}}),_0x38cfff['length']>0x0?_0x38cfff[_0x38cfff['length']-0x1]:null;}[_0x31b547(0xda)](_0x3164fb){const _0x426d13=_0x31b547,_0x209ea8=new Map();return _0x3164fb[_0x426d13(0x1f5)](_0x174ad7=>{const _0x3f9136=_0x426d13;var _0x45794c,_0x4411f7;const _0x1c0137=(_0x45794c=_0x174ad7[_0x3f9136(0x2a0)])==null?void 0x0:_0x45794c[_0x3f9136(0x226)];if(_0x1c0137){_0x209ea8[_0x3f9136(0x1e2)](_0x1c0137)||_0x209ea8[_0x3f9136(0xbf)](_0x1c0137,[]);const _0x1b5287=this[_0x3f9136(0x189)](_0x174ad7);(_0x4411f7=_0x209ea8[_0x3f9136(0x272)](_0x1c0137))==null||_0x4411f7[_0x3f9136(0x9d)](..._0x1b5287);}}),_0x209ea8['forEach']((_0x2d37c1,_0x5003fc)=>{_0x209ea8['set'](_0x5003fc,this['_combineRanges'](_0x2d37c1));}),_0x209ea8;}[_0x31b547(0x189)](_0x17f153){const _0x4cd28b=_0x31b547;switch(_0x17f153['id']){case _0x467fd2[_0x4cd28b(0x160)]['id']:{const _0x325a04=_0x17f153[_0x4cd28b(0x2a0)];return _0x325a04[_0x4cd28b(0x1b4)][_0x4cd28b(0x280)](_0xd09a9=>_0xd09a9[_0x4cd28b(0xf4)][_0x4cd28b(0x280)](_0x51b3c0=>({'range':_0x51b3c0,'unitId':_0x325a04[_0x4cd28b(0x148)],'subUnitId':_0x325a04[_0x4cd28b(0x276)]})))[_0x4cd28b(0xe5)]();}case _0x467fd2['AddWorksheetMergeMutation']['id']:{const _0x1d7f18=_0x17f153[_0x4cd28b(0x2a0)];return _0x1d7f18[_0x4cd28b(0xf4)][_0x4cd28b(0x280)](_0x1436f1=>({'range':_0x1436f1,'unitId':_0x1d7f18[_0x4cd28b(0x148)],'subUnitId':_0x1d7f18[_0x4cd28b(0x276)]}));}case _0x467fd2[_0x4cd28b(0x283)]['id']:{const _0x3f7f37=_0x17f153['params'];return[{'range':_0x3f7f37[_0x4cd28b(0x2a1)],'unitId':_0x3f7f37[_0x4cd28b(0x148)],'subUnitId':_0x3f7f37[_0x4cd28b(0x276)]}];}case _0x467fd2[_0x4cd28b(0x2c4)]['id']:{const _0x1a2fe6=_0x17f153[_0x4cd28b(0x2a0)];return[{'range':_0x1a2fe6[_0x4cd28b(0x2a1)],'unitId':_0x1a2fe6[_0x4cd28b(0x148)],'subUnitId':_0x1a2fe6[_0x4cd28b(0x276)]}];}case _0x467fd2[_0x4cd28b(0xd9)]['id']:{const _0x1ee49a=_0x17f153[_0x4cd28b(0x2a0)],{from:_0x5442ae,to:_0x36b434,unitId:_0x5aad82}=_0x1ee49a;return[{'range':_0x37bedf(_0x5442ae['value']),'unitId':_0x5aad82,'subUnitId':_0x5442ae[_0x4cd28b(0x276)]},{'range':_0x37bedf(_0x36b434[_0x4cd28b(0x266)]),'unitId':_0x5aad82,'subUnitId':_0x36b434[_0x4cd28b(0x276)]}];}case _0x467fd2[_0x4cd28b(0x130)]['id']:{const _0x24184e=_0x17f153[_0x4cd28b(0x2a0)],{unitId:_0x4b6aa3,subUnitId:_0x964749,sourceRange:_0x52dd3f,targetRange:_0x4f549a}=_0x24184e,_0x1dff02=_0x52dd3f[_0x4cd28b(0x293)]-_0x52dd3f['startRow']+0x1;return[{'range':_0x4f549a[_0x4cd28b(0x1c7)]<=_0x52dd3f['startRow']?_0x4f549a:{..._0x4f549a,'startRow':_0x4f549a[_0x4cd28b(0x1c7)]-_0x1dff02,'endRow':_0x4f549a[_0x4cd28b(0x293)]-_0x1dff02},'unitId':_0x4b6aa3,'subUnitId':_0x964749}];}case _0x467fd2[_0x4cd28b(0x24e)]['id']:{const _0x5ac01b=_0x17f153['params'],{unitId:_0x124bfb,subUnitId:_0x8aa672,sourceRange:_0x133f5e,targetRange:_0x456bbf}=_0x5ac01b,_0x294afa=_0x133f5e[_0x4cd28b(0xef)]-_0x133f5e['startColumn']+0x1;return[{'range':_0x456bbf[_0x4cd28b(0x1c9)]<=_0x133f5e[_0x4cd28b(0x1c9)]?_0x456bbf:{..._0x456bbf,'startColumn':_0x456bbf['startColumn']-_0x294afa,'endColumn':_0x456bbf[_0x4cd28b(0xef)]-_0x294afa},'unitId':_0x124bfb,'subUnitId':_0x8aa672}];}case _0x467fd2[_0x4cd28b(0xf8)]['id']:{const _0x134d8c=_0x17f153[_0x4cd28b(0x2a0)],{values:_0x3d2700,unitId:_0xb38ee8,subUnitId:_0x1ff212}=_0x134d8c;return Object['values'](_0x3d2700)[_0x4cd28b(0x280)](_0x588602=>_0x588602['ranges']['map'](_0x112372=>({'range':_0x112372,'unitId':_0xb38ee8,'subUnitId':_0x1ff212})))['flat']();}case _0x467fd2['RemoveNumfmtMutation']['id']:{const _0x1e9117=_0x17f153[_0x4cd28b(0x2a0)],{ranges:_0x4c7f61,unitId:_0x17c8e9,subUnitId:_0x1cff8c}=_0x1e9117;return _0x4c7f61[_0x4cd28b(0x280)](_0x52a7b2=>({'range':_0x52a7b2,'unitId':_0x17c8e9,'subUnitId':_0x1cff8c}));}case _0x467fd2[_0x4cd28b(0x187)]['id']:{const _0x1061ed=_0x17f153[_0x4cd28b(0x2a0)],{unitId:_0x43a4c0,subUnitId:_0xb0139f,range:_0x125e46}=_0x1061ed;return[{'range':_0x125e46,'unitId':_0x43a4c0,'subUnitId':_0xb0139f}];}case _0x467fd2['SetRangeProtectionMutation']['id']:{const _0x2748ed=_0x17f153['params'];return _0x2748ed[_0x4cd28b(0xc2)]['ranges'][_0x4cd28b(0x280)](_0x467ae1=>({'range':_0x467ae1,'unitId':_0x2748ed[_0x4cd28b(0x148)],'subUnitId':_0x2748ed[_0x4cd28b(0x276)]}));}case _0x467fd2[_0x4cd28b(0x17b)]['id']:{const _0x44fe5a=_0x17f153[_0x4cd28b(0x2a0)];return _0x44fe5a[_0x4cd28b(0x143)]?_0x57b5ff(_0x44fe5a[_0x4cd28b(0x143)])[_0x4cd28b(0x280)](_0x154e91=>({'range':_0x154e91,'unitId':_0x44fe5a[_0x4cd28b(0x148)],'subUnitId':_0x44fe5a['subUnitId']})):[];}case _0x2eebc6[_0x4cd28b(0x1cc)]['id']:{const _0x354000=_0x17f153[_0x4cd28b(0x2a0)];return[{'range':_0x354000[_0x4cd28b(0x2a1)],'unitId':_0x354000[_0x4cd28b(0x148)],'subUnitId':_0x354000['subUnitId']}];}case _0x2b3974[_0x4cd28b(0x112)]['id']:{const _0x44f181=_0x17f153[_0x4cd28b(0x2a0)];return(Array['isArray'](_0x44f181[_0x4cd28b(0xc2)])?_0x44f181[_0x4cd28b(0xc2)]:[_0x44f181[_0x4cd28b(0xc2)]])[_0x4cd28b(0x280)](_0x29c06c=>_0x29c06c[_0x4cd28b(0xf4)]['map'](_0x1133fc=>({'range':_0x1133fc,'unitId':_0x44f181[_0x4cd28b(0x148)],'subUnitId':_0x44f181[_0x4cd28b(0x276)]})))[_0x4cd28b(0xe5)]();}case _0x532ec1[_0x4cd28b(0x204)]['id']:{const _0x841c6c=_0x17f153['params'];return _0x841c6c['rule'][_0x4cd28b(0xf4)][_0x4cd28b(0x280)](_0x4cd46f=>({'range':_0x4cd46f,'unitId':_0x841c6c[_0x4cd28b(0x148)],'subUnitId':_0x841c6c[_0x4cd28b(0x276)]}));}default:return[];}}[_0x31b547(0xc3)](_0x27a9a3){const _0x1894f7=_0x31b547;if(_0x27a9a3['length']<=0x1)return _0x27a9a3;const _0x21fcb3=new Map();return _0x27a9a3['forEach'](_0x2bb72e=>{const _0x20442c=_0xfb6f;var _0x4ec420;const {unitId:_0x462b30,subUnitId:_0x1b508d}=_0x2bb72e,_0x45ae3d=_0x462b30+'-'+_0x1b508d;_0x21fcb3[_0x20442c(0x1e2)](_0x45ae3d)?(_0x4ec420=_0x21fcb3['get'](_0x45ae3d))==null||_0x4ec420[_0x20442c(0x9d)](_0x2bb72e):_0x21fcb3[_0x20442c(0xbf)](_0x45ae3d,[_0x2bb72e]);}),Array[_0x1894f7(0xaa)](_0x21fcb3[_0x1894f7(0x27a)]())[_0x1894f7(0x280)](_0x22f0f2=>new _0x467fd2[(_0x1894f7(0x14b))]()[_0x1894f7(0x1ed)](..._0x22f0f2[_0x1894f7(0x280)](_0x4a28b3=>_0x4a28b3[_0x1894f7(0x2a1)]))[_0x1894f7(0x114)]()[_0x1894f7(0x280)](_0x4d221a=>({'range':_0x4d221a,'unitId':_0x22f0f2[0x0]['unitId'],'subUnitId':_0x22f0f2[0x0][_0x1894f7(0x276)]})))[_0x1894f7(0xe5)]();}};_0xf4d0fb=_0x4b87a5([_0x4885e9(0x0,_0x242e1a[_0x31b547(0x11f)](_0x4d70eb['HistoryManagerService'])),_0x4885e9(0x1,_0xa43662[_0x31b547(0x25a)]),_0x4885e9(0x2,_0xa43662[_0x31b547(0x171)])],_0xf4d0fb);function _0x37bedf(_0x3cf9e1){const _0x485ebf=_0x31b547;return new _0x242e1a[(_0x485ebf(0x117))](_0x3cf9e1)[_0x485ebf(0x1f9)]();}function _0x57b5ff(_0x1c36fa){const _0x1d16cf=_0x31b547,_0x4db583=new _0x242e1a['ObjectMatrix'](_0x1c36fa),_0x5d6e20=new _0x242e1a[(_0x1d16cf(0x117))]();return _0x4db583['forValue']((_0x2129b8,_0x375063)=>{const _0x51a5d8=_0x1d16cf;_0x5d6e20[_0x51a5d8(0x1cf)](_0x2129b8,_0x375063,0x1);}),_0x467fd2['findAllRectangle'](_0x5d6e20);}var _0x144e18=Object[_0x31b547(0xee)],_0x39e913=(_0x537400,_0x3cf440,_0x3db9d7,_0x4adec5)=>{const _0x4e642f=_0x31b547;for(var _0x182b49=_0x4adec5>0x1?void 0x0:_0x4adec5?_0x144e18(_0x3cf440,_0x3db9d7):_0x3cf440,_0x1a6c95=_0x537400[_0x4e642f(0x263)]-0x1,_0x49a370;_0x1a6c95>=0x0;_0x1a6c95--)(_0x49a370=_0x537400[_0x1a6c95])&&(_0x182b49=_0x49a370(_0x182b49)||_0x182b49);return _0x182b49;},_0x459e0a=(_0x2e29ed,_0x576faa)=>(_0x36e20f,_0x3132d6)=>_0x576faa(_0x36e20f,_0x3132d6,_0x2e29ed);let _0x5705b4=class extends _0x242e1a[_0x31b547(0x16b)]{constructor(_0x3d38fe,_0x9ea559,_0x1f0799,_0x1d2358,_0x16ef02,_0x5384fe,_0x4a6580){const _0x28c4d7=_0x31b547;super(),_0x554995(this,_0x28c4d7(0x1f3),new Set()),_0x554995(this,_0x28c4d7(0xe9),null),(this[_0x28c4d7(0x2a7)]=_0x3d38fe,this[_0x28c4d7(0x20a)]=_0x9ea559,this['_versionDiffService']=_0x1f0799,this[_0x28c4d7(0x1e6)]=_0x1d2358,this['_renderManagerService']=_0x16ef02,this['_sheetSkeletonManagerService']=_0x5384fe,this[_0x28c4d7(0x185)]=_0x4a6580,this[_0x28c4d7(0xea)]());}[_0x31b547(0xea)](){const _0x9d4be6=_0x31b547;this['_initRender'](),this[_0x9d4be6(0x1ee)]();}[_0x31b547(0x118)](){const _0x59df90=_0x31b547;this[_0x59df90(0x1c2)](_0x2a386a[_0x59df90(0x219)]([this[_0x59df90(0x20a)][_0x59df90(0x13c)],this[_0x59df90(0x231)][_0x59df90(0x1a2)]])[_0x59df90(0x2bf)](_0x2a386a[_0x59df90(0x18a)](([_0x164977,_0x9fa8c])=>{const _0x52e673=_0x59df90;if(_0x164977===_0x576eaa[_0x52e673(0x27c)]&&_0x9fa8c){const _0x297198=_0x9fa8c[_0x52e673(0x1f8)];return this[_0x52e673(0x2ca)][_0x52e673(0x236)][_0x52e673(0x2bf)](_0x2a386a[_0x52e673(0x280)](_0x5f1c38=>{const _0x3d4bec=_0x52e673,_0x32f275=new Map();return _0x5f1c38[_0x3d4bec(0xf4)][_0x3d4bec(0x1f5)]((_0x519eb2,_0x316d87)=>{const _0x3f4e8b=_0x3d4bec,_0x516e57=_0x519eb2[_0x3f4e8b(0x216)](_0x58fdb4=>_0x58fdb4['subUnitId']===_0x297198);_0x32f275[_0x3f4e8b(0xbf)](_0x316d87,_0x516e57);}),{'skeleton':_0x9fa8c,'diffs':_0x32f275};}));}return _0x2a386a['of']({'skeleton':null,'diffs':new Map()});}))[_0x59df90(0x177)](({skeleton:_0xaad6ea,diffs:_0x41f686})=>{const _0x20f001=_0x59df90;this[_0x20f001(0xc9)](),_0xaad6ea&&this['_updateDiffMarks'](_0xaad6ea,_0x41f686);})),this[_0x59df90(0x1c2)](this[_0x59df90(0x231)][_0x59df90(0x1a2)]['subscribe'](_0x1b31c1=>{const _0x35d922=_0x59df90;if(_0x1b31c1==null)return;const {skeleton:_0x3524fd}=_0x1b31c1,{scene:_0x54d115}=this['_context'];_0x54d115[_0x35d922(0x146)]['subscribeEvent'](_0x242e1a[_0x35d922(0x2b3)](_0x173d93=>{const _0x3ea16f=_0x35d922;var _0x4432de,_0x3756c9;const {offsetX:_0x5c27f3,offsetY:_0x394432}=_0x173d93,{x:_0x118b4a,y:_0x4edcdf}=_0x54d115[_0x3ea16f(0x13f)](_0xfc4827[_0x3ea16f(0x2c9)][_0x3ea16f(0x181)]([_0x5c27f3,_0x394432])),{scaleX:_0x33bc2a,scaleY:_0x5b87aa}=_0x54d115[_0x3ea16f(0x23d)](),_0x67fd0a=_0x54d115['getViewport'](_0xfc4827[_0x3ea16f(0x23e)]['VIEW_MAIN']),_0x458c5e=_0x54d115[_0x3ea16f(0xf9)](_0xfc4827[_0x3ea16f(0x2c9)][_0x3ea16f(0x181)]([_0x118b4a,_0x4edcdf]),_0x67fd0a),_0x53a269=_0x3524fd['getCellPositionByOffset'](_0x5c27f3,_0x394432,_0x33bc2a,_0x5b87aa,_0x458c5e);((_0x4432de=this[_0x3ea16f(0xe9)])==null?void 0x0:_0x4432de[_0x3ea16f(0x2a2)])===_0x53a269['column']&&((_0x3756c9=this[_0x3ea16f(0xe9)])==null?void 0x0:_0x3756c9[_0x3ea16f(0xb1)])===_0x53a269[_0x3ea16f(0xb1)]||this[_0x3ea16f(0x1f3)][_0x3ea16f(0x1f5)](_0x5d42dc=>{const _0x1d9dea=_0x3ea16f;_0x5d42dc[_0x1d9dea(0x9a)](_0x53a269);});},0x64));}));}[_0x31b547(0x1ee)](){const _0x18fcd7=_0x31b547;this[_0x18fcd7(0x1c2)](this['_historyManagerService'][_0x18fcd7(0x13c)]['subscribe'](_0x534b0c=>{const _0x4e684b=_0x18fcd7,_0x5bd25b=new _0x242e1a[(_0x4e684b(0x29a))]();return _0x534b0c===_0x576eaa[_0x4e684b(0x27c)]&&(_0x5bd25b['dispose'](),_0x5bd25b[_0x4e684b(0x1ed)](this[_0x4e684b(0x2ca)]['currentVersionDiff$']['subscribe'](_0x1f333a=>{const _0x2c61e4=_0x4e684b;_0x1f333a[_0x2c61e4(0x241)]&&this[_0x2c61e4(0x185)]['executeCommand'](_0x467fd2[_0x2c61e4(0x286)]['id'],{'unitId':this[_0x2c61e4(0x2a7)][_0x2c61e4(0x148)],'subUnitId':_0x1f333a[_0x2c61e4(0x241)]});}))),()=>_0x5bd25b[_0x4e684b(0x21a)]();}));}[_0x31b547(0x1ba)](_0x476f95,_0x444132){const _0x45cf9f=_0x31b547;var _0x5e748d;const _0x35c2cf=(_0x5e748d=this[_0x45cf9f(0x231)][_0x45cf9f(0x267)]())==null?void 0x0:_0x5e748d[_0x45cf9f(0x145)];if(!_0x35c2cf)return;this[_0x45cf9f(0x1f3)][_0x45cf9f(0x1f5)](_0x5a0273=>{const _0x28a68d=_0x45cf9f;_0x5a0273[_0x28a68d(0x128)]();});const {scene:_0x47bae0}=this[_0x45cf9f(0x2a7)],_0x21d1f7=Array[_0x45cf9f(0xaa)](_0x444132[_0x45cf9f(0x99)]())['map'](_0x50e975=>_0x444132[_0x45cf9f(0x272)](_0x50e975)[_0x45cf9f(0x280)](_0x17234f=>{const _0x2ce160=_0x45cf9f;var _0x25eccf;const {range:_0x380a54,subUnitId:_0x13ff4d,unitId:_0x127c74}=_0x17234f,{startColumn:_0x408476,startRow:_0x4e32a3,endColumn:_0x277753,endRow:_0x24397c}=_0x380a54,_0x2377cb=_0x316cbf[_0x2ce160(0x14c)](_0x4e32a3,_0x408476,_0x47bae0,_0x35c2cf),_0x5f0071=_0x316cbf[_0x2ce160(0x14c)](_0x24397c,_0x277753,_0x47bae0,_0x35c2cf),{columnHeaderHeightAndMarginTop:_0x51e13a}=_0x35c2cf,{startX:_0x2c9fd5,startY:_0x104c52}=_0x2377cb,{endX:_0x46dbb0,endY:_0xc5b041}=_0x5f0071,_0x1319d7=_0x46dbb0-_0x2c9fd5,_0x461383=_0xc5b041-_0x104c52,_0x2ec3af={'labelPosition':_0x104c52-_0x51e13a>=0x14?_0x2ce160(0xaf):_0x2ce160(0xbe),'sheetID':_0x13ff4d,'range':_0x380a54,'color':_0x2ce160(0xd2),'fillAfterStrokeEnabled':!0x0,'backgroundColor':_0x2ce160(0xd2),'name':((_0x25eccf=this[_0x2ce160(0x20a)][_0x2ce160(0xa8)](_0x50e975))==null?void 0x0:_0x25eccf[_0x2ce160(0xe2)])||'','selection':_0x127c74+'-'+_0x13ff4d+'-'+_0x380a54[_0x2ce160(0x1c9)]+'-'+_0x380a54['startRow']+'-'+_0x380a54['endColumn']+'-'+_0x380a54[_0x2ce160(0x293)],'left':_0x2c9fd5,'top':_0x104c52,'width':_0x1319d7,'height':_0x461383,'evented':!0x1,'zIndex':0x1};return new _0x444a03[(_0x2ce160(0x2b6))]('',_0x2ec3af);}))['flat']();_0x47bae0[_0x45cf9f(0xeb)](_0x21d1f7,0x1),this[_0x45cf9f(0x1f3)]=new Set(_0x21d1f7);}['_removeDiffMarks'](){const _0x41e7eb=_0x31b547;var _0x4840ca;(_0x4840ca=this[_0x41e7eb(0x1f3)])==null||_0x4840ca[_0x41e7eb(0x1f5)](_0x4f95be=>_0x4f95be[_0x41e7eb(0x21a)]());}['_getSheetObject'](){const _0x27d0e7=_0x31b547;return _0x316cbf[_0x27d0e7(0x1a0)](this[_0x27d0e7(0x1e6)],this[_0x27d0e7(0x151)]);}};_0x5705b4=_0x39e913([_0x459e0a(0x1,_0x242e1a[_0x31b547(0x11f)](_0x4d70eb['HistoryManagerService'])),_0x459e0a(0x2,_0x242e1a['Inject'](_0xf4d0fb)),_0x459e0a(0x3,_0x242e1a[_0x31b547(0x1bd)]),_0x459e0a(0x4,_0xfc4827['IRenderManagerService']),_0x459e0a(0x5,_0x242e1a['Inject'](_0x316cbf[_0x31b547(0x235)])),_0x459e0a(0x6,_0x242e1a[_0x31b547(0xa5)])],_0x5705b4);function _0x5468c2(){const _0x56a4c0=_0x31b547,_0x252b3c=_0x1bf0bf['useDependency'](_0x4d70eb['HistoryManagerService']),_0x2e5e48=_0x1bf0bf[_0x56a4c0(0x238)](_0x252b3c[_0x56a4c0(0x206)]),[_0x17e11b,_0xceaccf]=_0x3f8f3c[_0x56a4c0(0x1a6)](!0x1),_0x51acb3=_0x521051(_0x2e5e48);return _0x2e5e48?_0x7b355a[_0x56a4c0(0xfa)]('div',{'className':_0x56a4c0(0xb8),'children':_0x7b355a[_0x56a4c0(0x27e)](_0x56a4c0(0x2d1),{'className':_0x56a4c0(0x209),'children':[_0x51acb3['map']((_0x31fd23,_0x541f0f)=>_0x7b355a[_0x56a4c0(0x27e)](_0x3f8f3c[_0x56a4c0(0x2cc)],{'children':[_0x7b355a[_0x56a4c0(0xfa)](_0x5c7d85,{'date':_0x31fd23[_0x56a4c0(0xf3)]}),_0x31fd23[_0x56a4c0(0x175)][_0x56a4c0(0x280)]((_0x34d664,_0x234ed8)=>_0x7b355a[_0x56a4c0(0xfa)](_0x59ab5f,{'index':[_0x541f0f,_0x234ed8],'item':_0x34d664},_0x541f0f+'-'+_0x234ed8))]},_0x31fd23[_0x56a4c0(0xf3)])),_0x17e11b&&_0x7b355a[_0x56a4c0(0xfa)](_0x368880,{})]})}):_0x7b355a[_0x56a4c0(0xfa)](_0x525081,{});}function _0x368880(){const _0x2376fb=_0x31b547;return _0x7b355a['jsx'](_0x2376fb(0x2d1),{'className':'univer-flex\x20univer-h-7\x20univer-w-full\x20univer-items-center\x20univer-justify-center','children':_0x7b355a[_0x2376fb(0xfa)](_0x265f14,{'className':_0x2376fb(0x15f)})});}function _0x525081(){const _0x58f670=_0x31b547;return _0x7b355a[_0x58f670(0xfa)](_0x58f670(0x2d1),{'className':_0x58f670(0x295),'children':_0x7b355a[_0x58f670(0xfa)](_0x58f670(0x1b6),{'className':_0x58f670(0x2c0),'children':_0x7b355a[_0x58f670(0xfa)](_0x265f14,{'className':_0x58f670(0xe3)})})});}function _0x5c7d85(_0x59a1b8){const _0x6206fc=_0x31b547,_0x33d8e2=_0x1bf0bf[_0x6206fc(0x260)](_0x242e1a[_0x6206fc(0x113)]),{date:_0x411c15}=_0x59a1b8;return _0x7b355a['jsx'](_0x6206fc(0x2d1),{'className':_0x6206fc(0x279),'children':_0x10059b(_0x411c15,_0x33d8e2[_0x6206fc(0xfe)]())});}function _0x59ab5f(_0x10d24b){const _0x3b9f86=_0x31b547,{item:_0x45a092,index:_0x1e8970}=_0x10d24b,{time:_0x117178,user:_0x3058a9}=_0x45a092,[_0x1766be,_0x55a2c7]=_0x1e8970,_0x405e38=_0x1bf0bf[_0x3b9f86(0x260)](_0x4d70eb[_0x3b9f86(0x1fd)]),_0xe905cb=_0x1bf0bf[_0x3b9f86(0x238)](_0x405e38['currentVersion$'],'',!0x0)===_0x45a092['id'],_0x238acb=_0x1766be===0x0&&_0x55a2c7===0x0,_0x9aafd4=!_0x238acb&&_0x405e38[_0x3b9f86(0x2a8)],_0x268f49=_0x1bf0bf[_0x3b9f86(0x260)](_0x242e1a['LocaleService']),_0x331478=_0x268f49['getCurrentLocale'](),_0x37db17=_0x558a9b(_0x117178,_0x331478),_0x48c4c6=_0x268f49['t'](_0x3b9f86(0x1f2)),_0x16e704=_0x3f8f3c[_0x3b9f86(0x2c2)](_0x5c098e=>{const _0x7ea36e=_0x3b9f86;_0x405e38[_0x7ea36e(0x205)]!==_0x576eaa[_0x7ea36e(0x16e)]&&(_0x405e38[_0x7ea36e(0x28b)]=_0x5c098e);},[_0x405e38]),_0x185e8a=_0x3f8f3c['useCallback'](_0x404bad=>{_0x405e38['triggerRevert'](_0x404bad);},[_0x405e38]);return _0x7b355a[_0x3b9f86(0x27e)](_0x3b9f86(0x2d1),{'className':_0x368c21['clsx']('univer-h-15\x20univer-flex\x20univer-cursor-pointer\x20univer-flex-col\x20univer-justify-center\x20univer-gap-1\x20univer-rounded-md\x20univer-px-4\x20univer-py-1.5\x20univer-transition-colors\x20hover:univer-bg-gray-100\x20dark:hover:!univer-bg-gray-800',{'univer-bg-gray-50\x20dark:!univer-bg-gray-900':_0xe905cb}),'onClick':()=>_0x16e704(_0x45a092['id']),'children':[_0x7b355a[_0x3b9f86(0x27e)](_0x3b9f86(0x2d1),{'className':'univer-flex\x20univer-h-6\x20univer-w-full\x20univer-justify-between','children':[_0x7b355a[_0x3b9f86(0x27e)]('div',{'className':_0x3b9f86(0x2d4),'children':[_0x7b355a[_0x3b9f86(0xfa)](_0x3b9f86(0x1b6),{'children':_0x37db17['time']}),_0x238acb&&_0x7b355a[_0x3b9f86(0xfa)](_0x3b9f86(0x1b6),{'className':'univer-ml-2\x20univer-flex\x20univer-h-5\x20univer-items-center\x20univer-justify-center\x20univer-rounded\x20univer-border\x20univer-border-primary-600\x20univer-bg-primary-50\x20univer-px-1.5\x20univer-text-xs\x20univer-text-primary-600','children':_0x48c4c6})]}),_0x7b355a['jsx'](_0x3b9f86(0x2d1),{'children':_0x9aafd4&&_0x7b355a['jsx'](_0x368c21[_0x3b9f86(0x20f)],{'title':_0x268f49['t'](_0x3b9f86(0x1b1)),'children':_0x7b355a[_0x3b9f86(0xfa)](_0x3b9f86(0x2d1),{'onClick':_0xf0388a=>{const _0x4de5d5=_0x3b9f86;_0xf0388a[_0x4de5d5(0x195)](),_0x185e8a(_0x45a092['id']);},'className':_0x3b9f86(0x1e7),'children':_0x7b355a[_0x3b9f86(0xfa)](_0x343251,{})})})})]}),_0x7b355a['jsx'](_0x3b9f86(0x2d1),{'className':_0x3b9f86(0x157),'children':_0x556eb6(_0x45a092,_0x268f49)})]});}var _0x516577=Object[_0x31b547(0xee)],_0x4e969c=(_0x43fe49,_0x17463a,_0x21c7cd,_0x44947b)=>{const _0xf5016e=_0x31b547;for(var _0x2a1da7=_0x44947b>0x1?void 0x0:_0x44947b?_0x516577(_0x17463a,_0x21c7cd):_0x17463a,_0x27b0bc=_0x43fe49[_0xf5016e(0x263)]-0x1,_0xa6699;_0x27b0bc>=0x0;_0x27b0bc--)(_0xa6699=_0x43fe49[_0x27b0bc])&&(_0x2a1da7=_0xa6699(_0x2a1da7)||_0x2a1da7);return _0x2a1da7;},_0x23b19d=(_0x21bc07,_0x3caa25)=>(_0x2ca23c,_0x1bfab3)=>_0x3caa25(_0x2ca23c,_0x1bfab3,_0x21bc07);const _0x29b3c2=_0x31b547(0x2ce);let _0x46c43a=class extends _0x242e1a[_0x31b547(0x16b)]{constructor(_0x14aafc,_0x3d4992,_0x3bac21,_0x49e381){const _0xfecc89=_0x31b547;super(),_0x554995(this,_0xfecc89(0x27f),null),(this[_0xfecc89(0x1b3)]=_0x14aafc,this[_0xfecc89(0xc4)]=_0x3d4992,this[_0xfecc89(0x244)]=_0x3bac21,this[_0xfecc89(0x20a)]=_0x49e381,this[_0xfecc89(0xea)]());}['_init'](){const _0x52f594=_0x31b547;this['_initPanel'](),this[_0x52f594(0x1d5)]();}[_0x31b547(0x1d5)](){const _0x1b629a=_0x31b547;if(this[_0x1b629a(0x27f)])return;const _0x60512={'header':{'title':this[_0x1b629a(0x244)]['t'](_0x1b629a(0xbd))},'children':{'label':_0x29b3c2},'onClose':()=>{const _0x36c68a=_0x1b629a;this[_0x36c68a(0x27f)]=null,this[_0x36c68a(0x20a)]['status']=_0x3eaf5d[_0x36c68a(0x2b7)];}};this[_0x1b629a(0x27f)]=this[_0x1b629a(0x1b3)][_0x1b629a(0x1c4)]({..._0x60512});}[_0x31b547(0x243)](){const _0x4b9bbd=_0x31b547;this[_0x4b9bbd(0x1c2)](this['_componentManager'][_0x4b9bbd(0x1d2)](_0x29b3c2,_0x5468c2)),this[_0x4b9bbd(0x1c2)](this[_0x4b9bbd(0x1b3)][_0x4b9bbd(0x233)][_0x4b9bbd(0x2bf)](_0x2a386a['debounceTime'](0x64))[_0x4b9bbd(0x177)](_0x571da8=>{const _0x40b305=_0x4b9bbd,{target:_0x569aa0}=_0x571da8||{};if(_0x569aa0){const {scrollTop:_0x57f31d,scrollHeight:_0x43b945,clientHeight:_0x9babb2}=_0x569aa0;_0x57f31d+_0x9babb2>=_0x43b945-0x5&&this[_0x40b305(0x20a)][_0x40b305(0x2b4)]();}}));}};_0x46c43a=_0x4e969c([_0x23b19d(0x0,_0x1bf0bf['ISidebarService']),_0x23b19d(0x1,_0x242e1a['Inject'](_0x1bf0bf[_0x31b547(0x29b)])),_0x23b19d(0x2,_0x242e1a[_0x31b547(0x11f)](_0x242e1a[_0x31b547(0x113)])),_0x23b19d(0x3,_0x242e1a[_0x31b547(0x11f)](_0x4d70eb[_0x31b547(0x1fd)]))],_0x46c43a);class _0x2b47b0 extends _0x242e1a[_0x31b547(0x16b)]{constructor(){super(),_0x554995(this,'_dialogOptions$',new _0x2a386a['Subject']());}[_0x31b547(0x1c4)](){const _0x3d00db=_0x31b547;return _0x242e1a[_0x3d00db(0x13b)](()=>{});}[_0x31b547(0x1bb)](){}['closeAll'](_0x40c25c){}[_0x31b547(0x2d0)](){const _0x4a37a5=_0x31b547;return this[_0x4a37a5(0xa9)][_0x4a37a5(0x1e8)]();}}var _0x44a5b3=Object[_0x31b547(0x1c5)],_0x1bc99e=Object['getOwnPropertyDescriptor'],_0x4ab7ac=(_0x54826b,_0x4fa6c1,_0x36da9c)=>_0x4fa6c1 in _0x54826b?_0x44a5b3(_0x54826b,_0x4fa6c1,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0x36da9c}):_0x54826b[_0x4fa6c1]=_0x36da9c,_0x53ac55=(_0x21634d,_0x38426a,_0x4e2fe9,_0x347aef)=>{const _0x7dac7=_0x31b547;for(var _0x1aa5d0=_0x347aef>0x1?void 0x0:_0x347aef?_0x1bc99e(_0x38426a,_0x4e2fe9):_0x38426a,_0x441eaa=_0x21634d[_0x7dac7(0x263)]-0x1,_0x278c94;_0x441eaa>=0x0;_0x441eaa--)(_0x278c94=_0x21634d[_0x441eaa])&&(_0x1aa5d0=_0x278c94(_0x1aa5d0)||_0x1aa5d0);return _0x1aa5d0;},_0x4f74c=(_0xb5db46,_0x4dda10)=>(_0x52f063,_0xb42530)=>_0x4dda10(_0x52f063,_0xb42530,_0xb5db46),_0x190443=(_0x42a10d,_0x117caa,_0x5e4ed3)=>_0x4ab7ac(_0x42a10d,_0x117caa+'',_0x5e4ed3);const _0x34f73f='UNIVER_EDIT_HISTORY_VIEWER_PLUGIN';_0x4d70eb['UniverEditHistoryViewerPlugin']=class extends _0x242e1a[_0x31b547(0xdb)]{constructor(_0x4314ba=_0x47955f,_0x3496bf,_0x913d32,_0x531a5d){const _0x3b2339=_0x31b547;super(),this['_config']=_0x4314ba,this[_0x3b2339(0x1df)]=_0x3496bf,this[_0x3b2339(0x151)]=_0x913d32,this[_0x3b2339(0x1e5)]=_0x531a5d;const {..._0x542a98}=_0x242e1a['merge']({},_0x47955f,this['_config']);this['_configService'][_0x3b2339(0x214)](_0x1ac248,_0x542a98);}[_0x31b547(0x11d)](){const _0x5d11b1=_0x31b547;[[_0x4d70eb['HistoryManagerService']],[_0x509149],[_0xf4d0fb],[_0x1e528b],[_0x46c43a],[_0x157c76],[_0xa43662[_0x5d11b1(0x171)],{'useClass':_0x450e2e[_0x5d11b1(0x11c)]}],[_0x1bf0bf[_0x5d11b1(0x1af)],{'useClass':_0x2b47b0}],[_0x149d4f['IImageIoService'],{'useClass':_0x450e2e[_0x5d11b1(0x12a)]}]][_0x5d11b1(0x1f5)](_0x2df266=>this[_0x5d11b1(0x1df)][_0x5d11b1(0x1ed)](_0x2df266)),this[_0x5d11b1(0x1df)][_0x5d11b1(0x272)](_0x509149);}[_0x31b547(0x11b)](){const _0x558c9b=_0x31b547;[[_0x5705b4]][_0x558c9b(0x1f5)](_0x15243a=>{const _0x37ce1c=_0x558c9b;this[_0x37ce1c(0x1c2)](this[_0x37ce1c(0x151)][_0x37ce1c(0x100)](_0x242e1a[_0x37ce1c(0x24c)]['UNIVER_SHEET'],_0x15243a));}),this[_0x558c9b(0x1df)]['get'](_0x157c76),this[_0x558c9b(0x1df)][_0x558c9b(0x272)](_0x46c43a);}[_0x31b547(0xa6)](){const _0x4fa186=_0x31b547;this[_0x4fa186(0x1df)][_0x4fa186(0x272)](_0xf4d0fb);}},_0x190443(_0x4d70eb['UniverEditHistoryViewerPlugin'],'pluginName',_0x34f73f),_0x4d70eb[_0x31b547(0x21f)]=_0x53ac55([_0x242e1a[_0x31b547(0x2af)](_0x316cbf[_0x31b547(0x10f)],_0x3ebdc4[_0x31b547(0x251)]),_0x4f74c(0x1,_0x242e1a['Inject'](_0x242e1a['Injector'])),_0x4f74c(0x2,_0xfc4827['IRenderManagerService']),_0x4f74c(0x3,_0x242e1a[_0x31b547(0x22c)])],_0x4d70eb[_0x31b547(0x21f)]),_0x4d70eb[_0x31b547(0x1c0)]=_0x3eaf5d,Object[_0x31b547(0x1c5)](_0x4d70eb,Symbol[_0x31b547(0x17c)],{'value':_0x31b547(0x1a9)});}));