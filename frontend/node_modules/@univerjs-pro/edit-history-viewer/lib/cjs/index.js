'use strict';const _0x16160e=_0x1dcf;(function(_0x2372b,_0x484abe){const _0x3f7a2c=_0x1dcf,_0x4bc1f4=_0x2372b();while(!![]){try{const _0x1f92fe=-parseInt(_0x3f7a2c(0x216))/0x1*(parseInt(_0x3f7a2c(0x1a5))/0x2)+-parseInt(_0x3f7a2c(0x25f))/0x3+parseInt(_0x3f7a2c(0x36f))/0x4+parseInt(_0x3f7a2c(0x27e))/0x5+-parseInt(_0x3f7a2c(0x374))/0x6+parseInt(_0x3f7a2c(0x2d2))/0x7*(parseInt(_0x3f7a2c(0x219))/0x8)+-parseInt(_0x3f7a2c(0x23b))/0x9*(-parseInt(_0x3f7a2c(0x31a))/0xa);if(_0x1f92fe===_0x484abe)break;else _0x4bc1f4['push'](_0x4bc1f4['shift']());}catch(_0x289149){_0x4bc1f4['push'](_0x4bc1f4['shift']());}}}(_0x36b9,0xed322));var me=Object['defineProperty'],fe=(_0x4323bf,_0x233192,_0xbcf2d9)=>_0x233192 in _0x4323bf?me(_0x4323bf,_0x233192,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0xbcf2d9}):_0x4323bf[_0x233192]=_0xbcf2d9,u=(_0x26bf62,_0x2203e5,_0x118e54)=>fe(_0x26bf62,typeof _0x2203e5!=_0x16160e(0x19d)?_0x2203e5+'':_0x2203e5,_0x118e54);Object[_0x16160e(0x359)](exports,Symbol['toStringTag'],{'value':'Module'});const O=require('@univerjs-pro/collaboration'),ie=require('@univerjs-pro/collaboration-client'),l=require('@univerjs/core'),pe=require('@univerjs/drawing'),U=require('@univerjs/engine-render'),oe=require('@univerjs/network'),C=require('@univerjs/sheets-ui'),d=require('@univerjs/ui'),P=require('@univerjs/design'),_=require('@univerjs/sheets'),R=require('rxjs'),Re=require('@univerjs-pro/sheets-sparkline'),q=require('@univerjs/data-validation'),K=require('@univerjs/sheets-conditional-formatting'),ce=require('@univerjs/sheets-filter'),h=require('react/jsx-runtime'),p=require('react'),Ne=require('@univerjs-pro/collaboration-client-ui'),le=_0x16160e(0x335),ne={};var Oe=Object['getOwnPropertyDescriptor'],Me=(_0x5a08c1,_0x185940,_0x5935aa,_0x142c48)=>{for(var _0x1db550=_0x142c48>0x1?void 0x0:_0x142c48?Oe(_0x185940,_0x5935aa):_0x185940,_0x3f8785=_0x5a08c1['length']-0x1,_0x1a4ad1;_0x3f8785>=0x0;_0x3f8785--)(_0x1a4ad1=_0x5a08c1[_0x3f8785])&&(_0x1db550=_0x1a4ad1(_0x1db550)||_0x1db550);return _0x1db550;},De=(_0x3a6cc1,_0x2d5e3e)=>(_0x341080,_0x1aa7fc)=>_0x2d5e3e(_0x341080,_0x1aa7fc,_0x3a6cc1);let k=class extends l[_0x16160e(0x188)]{constructor(_0x341320){const _0x1acb4c=_0x16160e;super(),this['_cellEditorManagerService']=_0x341320,this[_0x1acb4c(0x31b)]();}[_0x16160e(0x31b)](){const _0x3561ce=_0x16160e;this['disposeWithMe'](this[_0x3561ce(0x181)][_0x3561ce(0x248)]['subscribe'](_0x38b06d=>{const _0x107e58=_0x3561ce;_0x38b06d!=null&&_0x38b06d[_0x107e58(0x18b)]&&this['_cellEditorManagerService'][_0x107e58(0x2ce)]({'show':!0x1});}));}};k=Me([De(0x0,C[_0x16160e(0x2f1)])],k);var F=(_0x5a474a=>(_0x5a474a[_0x5a474a[_0x16160e(0x2a7)]=0x0]=_0x16160e(0x2a7),_0x5a474a[_0x5a474a['OK']=0x1]='OK',_0x5a474a[_0x5a474a[_0x16160e(0x365)]=0x2]=_0x16160e(0x365),_0x5a474a[_0x5a474a[_0x16160e(0x30b)]=0x3]=_0x16160e(0x30b),_0x5a474a[_0x5a474a[_0x16160e(0x394)]=0x4]=_0x16160e(0x394),_0x5a474a[_0x5a474a['UNAUTHENTICATED']=0x5]='UNAUTHENTICATED',_0x5a474a[_0x5a474a[_0x16160e(0x1ed)]=0x6]=_0x16160e(0x1ed),_0x5a474a[_0x5a474a['INVALID_ARGUMENT']=0x7]=_0x16160e(0x2dc),_0x5a474a[_0x5a474a[_0x16160e(0x306)]=0x8]=_0x16160e(0x306),_0x5a474a[_0x5a474a['COMPLETION_FINISHED']=0x9]=_0x16160e(0x202),_0x5a474a[_0x5a474a[_0x16160e(0x1ef)]=0xa]='LOGIN_FAILED',_0x5a474a[_0x5a474a[_0x16160e(0x264)]=0xb]=_0x16160e(0x264),_0x5a474a[_0x5a474a[_0x16160e(0x210)]=0xc]='MOBILE_VERIFY_CODE_NOT_FOUND_OR_EXPIRED',_0x5a474a[_0x5a474a[_0x16160e(0x2f8)]=0xd]=_0x16160e(0x2f8),_0x5a474a[_0x5a474a[_0x16160e(0x2ef)]=0xe]=_0x16160e(0x2ef),_0x5a474a[_0x5a474a[_0x16160e(0x33f)]=0xf]=_0x16160e(0x33f),_0x5a474a[_0x5a474a[_0x16160e(0x1e4)]=0x10]='LOGIN_TOKEN_PROCESSING_FAILED',_0x5a474a[_0x5a474a[_0x16160e(0x245)]=0x64]='CURRENT_STATUS_CANNOT_OPERATE',_0x5a474a[_0x5a474a[_0x16160e(0x34b)]=0x65]='ERROR_AGAIN',_0x5a474a[_0x5a474a[_0x16160e(0x1bf)]=0xc9]=_0x16160e(0x1bf),_0x5a474a[_0x5a474a['USER_IS_ANONYMOUS']=0xca]='USER_IS_ANONYMOUS',_0x5a474a[_0x5a474a['CHANGESET_REVISION_CONFILICT']=0x1389]=_0x16160e(0x1c3),_0x5a474a[_0x5a474a[_0x16160e(0x27a)]=0x1771]=_0x16160e(0x27a),_0x5a474a[_0x5a474a[_0x16160e(0x22d)]=0x1772]=_0x16160e(0x22d),_0x5a474a[_0x5a474a[_0x16160e(0x205)]=0x1773]=_0x16160e(0x205),_0x5a474a[_0x5a474a['APPLY_REJECT']=0x1b59]=_0x16160e(0x299),_0x5a474a[_0x5a474a[_0x16160e(0x27d)]=0x1b5a]=_0x16160e(0x27d),_0x5a474a[_0x5a474a[_0x16160e(0x2fe)]=0x1b5b]=_0x16160e(0x2fe),_0x5a474a[_0x5a474a['APPLY_PERMISSION_DENIED']=0x1b5c]=_0x16160e(0x20c),_0x5a474a[_0x5a474a['APPLY_DUPLICATED']=0x1b5d]=_0x16160e(0x197),_0x5a474a[_0x5a474a[_0x16160e(0x260)]=0x1f41]=_0x16160e(0x260),_0x5a474a[_0x5a474a['LICENSE_MAX_UNITS_EXCEEDED']=0x2329]='LICENSE_MAX_UNITS_EXCEEDED',_0x5a474a[_0x5a474a[_0x16160e(0x34a)]=0x232a]=_0x16160e(0x34a),_0x5a474a[_0x5a474a[_0x16160e(0x233)]=0x232b]=_0x16160e(0x233),_0x5a474a[_0x5a474a[_0x16160e(0x23a)]=0x232c]=_0x16160e(0x23a),_0x5a474a[_0x5a474a['LICENSE_DISTRO_REJECTED']=0x232d]=_0x16160e(0x235),_0x5a474a[_0x5a474a[_0x16160e(0x1fb)]=0x2711]=_0x16160e(0x1fb),_0x5a474a[_0x5a474a[_0x16160e(0x255)]=0x2712]='YUUMI_URL_COL_OUT_OF_RANGE',_0x5a474a[_0x5a474a[_0x16160e(0x1be)]=0x2713]='YUUMI_RATE_OVER_LIMIT',_0x5a474a[_0x5a474a[_0x16160e(0x1a8)]=0x2714]=_0x16160e(0x1a8),_0x5a474a[_0x5a474a['YUUMI_NO_CUBOID_FOR_QUESTION']=0x271a]='YUUMI_NO_CUBOID_FOR_QUESTION',_0x5a474a[_0x5a474a[_0x16160e(0x32d)]=0x271b]='YUUMI_ASYNCIO_CANCELLED',_0x5a474a[_0x5a474a['YUUMI_TABLE_NOT_FOUND_IN_UNIT']=0x271c]=_0x16160e(0x375),_0x5a474a[_0x5a474a[_0x16160e(0x309)]=0x271d]=_0x16160e(0x309),_0x5a474a[_0x5a474a[_0x16160e(0x2e2)]=0x271e]=_0x16160e(0x2e2),_0x5a474a[_0x5a474a['YUUMI_AI_RUN_FAILED']=0x271f]=_0x16160e(0x30d),_0x5a474a[_0x5a474a['YUUMI_CONNECTOR_URL_NOT_FOUND']=0x2720]='YUUMI_CONNECTOR_URL_NOT_FOUND',_0x5a474a[_0x5a474a[_0x16160e(0x2d5)]=0x2af9]=_0x16160e(0x2d5),_0x5a474a[_0x5a474a[_0x16160e(0x393)]=0x2ee1]=_0x16160e(0x393),_0x5a474a[_0x5a474a[_0x16160e(0x19b)]=0x2ee2]=_0x16160e(0x19b),_0x5a474a[_0x5a474a[_0x16160e(0x37b)]=0x2ee3]=_0x16160e(0x37b),_0x5a474a[_0x5a474a[_0x16160e(0x2ca)]=0x2ee4]='USER_NOT_INVITED_CODE',_0x5a474a[_0x5a474a['INVITE_CODE_ALREADY_BOUND']=0x2ee5]=_0x16160e(0x35f),_0x5a474a[_0x5a474a[_0x16160e(0x18a)]=0x32c9]=_0x16160e(0x18a),_0x5a474a[_0x5a474a[_0x16160e(0x283)]=0x32ca]=_0x16160e(0x283),_0x5a474a[_0x5a474a['EMAIL_HAS_BEEN_BOUND']=0x32cb]=_0x16160e(0x385),_0x5a474a[_0x5a474a[_0x16160e(0x220)]=0x36b1]=_0x16160e(0x220),_0x5a474a[_0x5a474a[_0x16160e(0x213)]=0x36b2]=_0x16160e(0x213),_0x5a474a[_0x5a474a[_0x16160e(0x2fc)]=0x36b3]=_0x16160e(0x2fc),_0x5a474a[_0x5a474a[_0x16160e(0x1d5)]=0x36b4]='PAYMENT_CHANNEL_NOT_SUPPORT',_0x5a474a[_0x5a474a[_0x16160e(0x198)]=0x3715]=_0x16160e(0x198),_0x5a474a[_0x5a474a[_0x16160e(0x273)]=0x3716]=_0x16160e(0x273),_0x5a474a[_0x5a474a[_0x16160e(0x334)]=0x3717]=_0x16160e(0x334),_0x5a474a[_0x5a474a['ENTITLE_NEED_BILLING_ADDRESS']=0x37dd]=_0x16160e(0x274),_0x5a474a[_0x5a474a['REDEMPTION_INVALID_CODE']=0x3a99]=_0x16160e(0x224),_0x5a474a[_0x5a474a[_0x16160e(0x20b)]=0x3a9a]=_0x16160e(0x20b),_0x5a474a[_0x5a474a[_0x16160e(0x37c)]=0x3a9b]=_0x16160e(0x37c),_0x5a474a[_0x5a474a['REDEMPTION_CODE_NOT_STARTED']=0x3a9c]=_0x16160e(0x327),_0x5a474a[_0x5a474a['REDEMPTION_USER_NOT_ELIGIBLE']=0x3a9d]=_0x16160e(0x257),_0x5a474a[_0x5a474a[_0x16160e(0x24e)]=0x3a9e]=_0x16160e(0x24e),_0x5a474a[_0x5a474a[_0x16160e(0x28a)]=0x3a9f]='REDEMPTION_CODE_HAS_BEEN_CREATED',_0x5a474a[_0x5a474a[_0x16160e(0x1e3)]=0x3e81]=_0x16160e(0x1e3),_0x5a474a[_0x5a474a['UNRECOGNIZED']=-0x1]=_0x16160e(0x1f0),_0x5a474a))(F||{}),H=(_0x41c3d1=>(_0x41c3d1[_0x41c3d1[_0x16160e(0x23e)]=0x0]=_0x16160e(0x23e),_0x41c3d1[_0x41c3d1[_0x16160e(0x263)]=0x1]='UNIVER_DOC',_0x41c3d1[_0x41c3d1[_0x16160e(0x1e5)]=0x2]=_0x16160e(0x1e5),_0x41c3d1[_0x41c3d1['UNIVER_SLIDE']=0x3]=_0x16160e(0x212),_0x41c3d1[_0x41c3d1[_0x16160e(0x2ed)]=0x4]=_0x16160e(0x2ed),_0x41c3d1[_0x41c3d1[_0x16160e(0x1f0)]=-0x1]='UNRECOGNIZED',_0x41c3d1))(H||{}),b=(_0x39e274=>(_0x39e274[_0x39e274[_0x16160e(0x19f)]=0x0]='View',_0x39e274[_0x39e274[_0x16160e(0x38d)]=0x1]=_0x16160e(0x38d),_0x39e274[_0x39e274[_0x16160e(0x32c)]=0x2]='ManageCollaborator',_0x39e274[_0x39e274[_0x16160e(0x338)]=0x3]=_0x16160e(0x338),_0x39e274[_0x39e274['Duplicate']=0x4]='Duplicate',_0x39e274[_0x39e274[_0x16160e(0x222)]=0x5]='Comment',_0x39e274[_0x39e274[_0x16160e(0x2a8)]=0x6]=_0x16160e(0x2a8),_0x39e274[_0x39e274[_0x16160e(0x324)]=0x7]=_0x16160e(0x324),_0x39e274[_0x39e274[_0x16160e(0x1b2)]=0x8]='Export',_0x39e274[_0x39e274[_0x16160e(0x269)]=0x9]=_0x16160e(0x269),_0x39e274[_0x39e274[_0x16160e(0x315)]=0xa]=_0x16160e(0x315),_0x39e274[_0x39e274[_0x16160e(0x230)]=0xb]=_0x16160e(0x230),_0x39e274[_0x39e274[_0x16160e(0x191)]=0xc]=_0x16160e(0x191),_0x39e274[_0x39e274[_0x16160e(0x1f6)]=0xd]=_0x16160e(0x1f6),_0x39e274[_0x39e274['SetWorksheetStyle']=0xe]=_0x16160e(0x1a0),_0x39e274[_0x39e274[_0x16160e(0x1bc)]=0xf]=_0x16160e(0x1bc),_0x39e274[_0x39e274[_0x16160e(0x226)]=0x10]=_0x16160e(0x226),_0x39e274[_0x39e274[_0x16160e(0x2f0)]=0x11]=_0x16160e(0x2f0),_0x39e274[_0x39e274['Filter']=0x12]='Filter',_0x39e274[_0x39e274['PivotTable']=0x13]=_0x16160e(0x396),_0x39e274[_0x39e274[_0x16160e(0x26b)]=0x14]=_0x16160e(0x26b),_0x39e274[_0x39e274['History']=0x15]=_0x16160e(0x192),_0x39e274[_0x39e274[_0x16160e(0x2e9)]=0x16]='RwHgtClWdt',_0x39e274[_0x39e274[_0x16160e(0x2b4)]=0x17]='ViemRwHgtClWdt',_0x39e274[_0x39e274[_0x16160e(0x36a)]=0x18]=_0x16160e(0x36a),_0x39e274[_0x39e274[_0x16160e(0x280)]=0x19]='MoveSheet',_0x39e274[_0x39e274[_0x16160e(0x357)]=0x1a]=_0x16160e(0x357),_0x39e274[_0x39e274[_0x16160e(0x2f3)]=0x1b]='HideSheet',_0x39e274[_0x39e274[_0x16160e(0x1f8)]=0x1c]=_0x16160e(0x1f8),_0x39e274[_0x39e274[_0x16160e(0x399)]=0x1d]='RenameSheet',_0x39e274[_0x39e274[_0x16160e(0x2a5)]=0x1e]='CreateSheet',_0x39e274[_0x39e274[_0x16160e(0x302)]=0x1f]=_0x16160e(0x302),_0x39e274[_0x39e274[_0x16160e(0x26d)]=0x20]='SelectUnProtectedCells',_0x39e274[_0x39e274[_0x16160e(0x2b5)]=0x21]=_0x16160e(0x2b5),_0x39e274[_0x39e274[_0x16160e(0x38f)]=0x22]=_0x16160e(0x38f),_0x39e274[_0x39e274[_0x16160e(0x2d6)]=0x23]='SetRowStyle',_0x39e274[_0x39e274['SetColumnStyle']=0x24]=_0x16160e(0x1f9),_0x39e274[_0x39e274[_0x16160e(0x323)]=0x25]=_0x16160e(0x323),_0x39e274[_0x39e274[_0x16160e(0x379)]=0x26]=_0x16160e(0x379),_0x39e274[_0x39e274[_0x16160e(0x1e9)]=0x27]=_0x16160e(0x1e9),_0x39e274[_0x39e274[_0x16160e(0x1cf)]=0x28]=_0x16160e(0x1cf),_0x39e274[_0x39e274[_0x16160e(0x187)]=0x29]=_0x16160e(0x187),_0x39e274[_0x39e274[_0x16160e(0x2ea)]=0x2a]=_0x16160e(0x2ea),_0x39e274[_0x39e274['RecoverHistory']=0x2b]='RecoverHistory',_0x39e274[_0x39e274[_0x16160e(0x17f)]=0x2c]=_0x16160e(0x17f),_0x39e274[_0x39e274[_0x16160e(0x242)]=0x2d]='CreatePermissionObject',_0x39e274[_0x39e274[_0x16160e(0x1f0)]=-0x1]=_0x16160e(0x1f0),_0x39e274))(b||{});function Te(_0xb81c86){const _0x68fe91=_0x16160e;return!!(_0xb81c86&&_0xb81c86[_0x68fe91(0x2ba)]&&_0xb81c86[_0x68fe91(0x2ba)]!==F['OK']&&_0xb81c86['code']!=='OK');}const J=(_0x5d3250,_0x1b68ff)=>{const _0x2e3c6c=_0x16160e;if(!_0x5d3250)return{'date':'','time':''};const _0x4de89f=new Date(_0x5d3250),_0x1d5255=_0x4de89f[_0x2e3c6c(0x1a3)]()[_0x2e3c6c(0x1c8)]('T')[0x0];switch(_0x1b68ff){case l[_0x2e3c6c(0x247)][_0x2e3c6c(0x363)]:return{'date':Q(_0x1d5255,_0x1b68ff),'time':_0x4de89f['getHours']()+':'+String(_0x4de89f[_0x2e3c6c(0x2bb)]())['padStart'](0x2,'0')};default:return{'date':Q(_0x1d5255,_0x1b68ff),'time':_0x4de89f[_0x2e3c6c(0x21c)]()+':'+_0x4de89f[_0x2e3c6c(0x2bb)]()};}},be=(_0x568c85,_0x455775)=>{const _0x1ea5e0=_0x16160e,_0xa07af3=_0x568c85[_0x1ea5e0(0x22b)]||_0x455775['t'](_0x1ea5e0(0x1c1));if(_0x568c85[_0x1ea5e0(0x2a0)][_0x1ea5e0(0x2ae)](_0x31d694=>_0x31d694===O[_0x1ea5e0(0x185)]['id'])&&_0x568c85['recoverTime']){const _0x279fff=J(_0x568c85[_0x1ea5e0(0x267)],_0x455775[_0x1ea5e0(0x1df)]()),_0x363852=_0x279fff[_0x1ea5e0(0x1a2)]+'\x20'+_0x279fff[_0x1ea5e0(0x238)];return _0xa07af3+'\x20'+_0x455775['t']('editHistory.action.revertSheetPrefix')+'\x20'+_0x363852+'\x20'+_0x455775['t'](_0x1ea5e0(0x362));}const _0x244d6f=Pe(_0x568c85),_0x33d8c6=_0x244d6f[_0x1ea5e0(0x390)]===0x1?_0x455775['t'](_0x244d6f[0x0]):''+_0x455775['t'](_0x244d6f[0x0])+_0x455775['t'](_0x1ea5e0(0x2ad));return _0xa07af3+'\x20'+_0x33d8c6;};function Pe(_0x3c2fe9){const _0xdb3958=_0x16160e;if(_0x3c2fe9[_0xdb3958(0x2a0)][_0xdb3958(0x390)]===0x0)return[''];const _0x238e58=_0xdb3958(0x193),_0x488bf5=_0x238e58+_0xdb3958(0x348),_0x20eac6=[{'id':O[_0xdb3958(0x2cd)]['id'],'action':_0x238e58+_0xdb3958(0x1ce)},{'id':O['RevertRevisionMutation']['id'],'action':_0x238e58+'revertSheet'},{'id':_[_0xdb3958(0x295)]['id'],'action':_0x238e58+_0xdb3958(0x221)},{'id':_[_0xdb3958(0x349)]['id'],'action':_0x238e58+'removeSheet'},{'id':_[_0xdb3958(0x2b7)]['id'],'action':_0x238e58+_0xdb3958(0x184)},{'id':ce['SetSheetsFilterRangeMutation']['id'],'action':_0x238e58+_0xdb3958(0x2f5)},{'id':q[_0xdb3958(0x1ee)]['id'],'action':_0x238e58+_0xdb3958(0x31c)},{'id':q[_0xdb3958(0x1de)]['id'],'action':_0x238e58+_0xdb3958(0x31c)},{'id':K['SetConditionalRuleMutation']['id'],'action':_0x238e58+_0xdb3958(0x218)},{'id':K[_0xdb3958(0x29a)]['id'],'action':_0x238e58+_0xdb3958(0x218)},{'id':_[_0xdb3958(0x31e)]['id'],'action':_0x238e58+'addProtection'},{'id':_[_0xdb3958(0x367)]['id'],'action':_0x238e58+_0xdb3958(0x300)},{'id':Re[_0xdb3958(0x30e)]['id'],'action':_0x238e58+_0xdb3958(0x36e)},{'id':_[_0xdb3958(0x32e)]['id'],'action':_0x238e58+_0xdb3958(0x1ad)},{'id':_[_0xdb3958(0x2d9)]['id'],'action':_0x238e58+'deleteProtection'}][_0xdb3958(0x2fa)](_0x52962e=>_0x3c2fe9['commands']['includes'](_0x52962e['id']));return _0x20eac6!=null&&_0x20eac6[_0xdb3958(0x390)]?_0x20eac6[_0xdb3958(0x208)](_0x36b881=>_0x36b881['action']):[_0x488bf5];}function _0x1dcf(_0x2b75c4,_0x4920f6){const _0x36b996=_0x36b9();return _0x1dcf=function(_0x1dcf10,_0x491ca3){_0x1dcf10=_0x1dcf10-0x17d;let _0x339483=_0x36b996[_0x1dcf10];return _0x339483;},_0x1dcf(_0x2b75c4,_0x4920f6);}function Q(_0x43698c,_0x4fa5c2){const _0x4cda2e=_0x16160e,[_0x5b42c4,_0x2b0604,_0x28b88b]=new Date()[_0x4cda2e(0x1a3)]()[_0x4cda2e(0x1c8)]('T')[0x0][_0x4cda2e(0x1c8)]('-'),[_0x296219,_0x59b14c,_0x284f03]=_0x43698c[_0x4cda2e(0x1c8)]('-'),_0x52e917=_0x5b42c4===_0x296219&&_0x2b0604===_0x59b14c&&_0x28b88b===_0x284f03;let _0x41221c='',_0x58660a='',_0x3ee959='';switch(_0x4fa5c2){case l[_0x4cda2e(0x247)][_0x4cda2e(0x363)]:return _0x52e917?'今天':(_0x41221c=_0x5b42c4===_0x296219?'':_0x296219+'年',_0x58660a=_0x59b14c+'月',_0x3ee959=_0x284f03+'日',''+_0x41221c+_0x58660a+_0x3ee959);default:return _0x52e917?_0x4cda2e(0x39a):(_0x41221c=_0x5b42c4===_0x296219?'':_0x296219+'-',_0x58660a=_0x59b14c+'-',_0x3ee959=''+_0x284f03,''+_0x41221c+_0x58660a+_0x3ee959);}}function ye(_0x119806){const _0x4f9d0a=_0x16160e;return _0x119806?_0x119806[_0x4f9d0a(0x34c)]((_0x966ad7,_0x4feb3d)=>{const _0x1e629b=_0x4f9d0a,_0x3d7122=new Date(_0x4feb3d[_0x1e629b(0x238)])[_0x1e629b(0x1a3)]()['split']('T')[0x0];return _0x966ad7[_0x1e629b(0x390)]>0x0&&_0x966ad7[_0x966ad7['length']-0x1]['dateString']===_0x3d7122?_0x966ad7[_0x966ad7['length']-0x1][_0x1e629b(0x287)]['push'](_0x4feb3d):_0x966ad7['push']({'dateString':_0x3d7122,'versions':[_0x4feb3d]}),_0x966ad7;},[]):[];}var Le=Object[_0x16160e(0x211)],Ce=(_0x579256,_0x13679a,_0x5eed7f,_0x379263)=>{const _0x2377f3=_0x16160e;for(var _0x41443e=_0x379263>0x1?void 0x0:_0x379263?Le(_0x13679a,_0x5eed7f):_0x13679a,_0x43db83=_0x579256[_0x2377f3(0x390)]-0x1,_0x57754b;_0x43db83>=0x0;_0x43db83--)(_0x57754b=_0x579256[_0x43db83])&&(_0x41443e=_0x57754b(_0x41443e)||_0x41443e);return _0x41443e;},T=(_0x5660c4,_0x2e2f9e)=>(_0x4d5688,_0x5df088)=>_0x2e2f9e(_0x4d5688,_0x5df088,_0x5660c4);const we=_0x16160e(0x22e);let A=class extends l[_0x16160e(0x188)]{constructor(_0x2d3473,_0x58dba9,_0x585bf0,_0xf07ec1,_0x578e9e,_0x4dee3d,_0x58b9d0){const _0x37ad2a=_0x16160e;super(),u(this,_0x37ad2a(0x199),new Map()),(this[_0x37ad2a(0x298)]=_0x2d3473,this[_0x37ad2a(0x2f9)]=_0x58dba9,this[_0x37ad2a(0x277)]=_0x585bf0,this[_0x37ad2a(0x258)]=_0xf07ec1,this['_httpService']=_0x578e9e,this[_0x37ad2a(0x361)]=_0x4dee3d,this[_0x37ad2a(0x215)]=_0x58b9d0);}[_0x16160e(0x325)](){const _0x35f1bf=_0x16160e;this[_0x35f1bf(0x199)][_0x35f1bf(0x276)](),super[_0x35f1bf(0x325)]();}async[_0x16160e(0x279)](_0x461db6,_0x3d54c7){const _0x2f5746=_0x16160e,_0x12bf56=this[_0x2f5746(0x29d)]()+'/'+_0x461db6+'/list?length=20'+(_0x3d54c7?'&lastLabel='+_0x3d54c7:'');try{const _0x279c30=(await this[_0x2f5746(0x345)][_0x2f5746(0x24b)](_0x12bf56))[_0x2f5746(0x1fe)];if(_0x279c30&&_0x279c30[_0x2f5746(0x243)]&&_0x279c30['error'][_0x2f5746(0x2ba)]===F['OK']){const {hasMore:_0x3f1a8d,lastLabel:_0x1fd61b}=_0x279c30,_0x448b05=Ue(_0x279c30),_0x5735de=_0x279c30[_0x2f5746(0x21e)]['users'];return{'hasMore':_0x3f1a8d,'lastLabel':_0x1fd61b,'versions':_0x448b05,'members':_0x5735de};}}catch(_0x2933b0){console[_0x2f5746(0x243)](_0x2933b0);}return null;}[_0x16160e(0x29d)](){const _0x3d80aa=_0x16160e;var _0x57d41f;const _0x36b1b6=this[_0x3d80aa(0x258)]['getConfig'](le);return(_0x57d41f=_0x36b1b6==null?void 0x0:_0x36b1b6[_0x3d80aa(0x2ff)])!=null?_0x57d41f:we;}async[_0x16160e(0x2d8)](_0x2ce28f,_0x171d0c,_0x415542){const _0x24583d=_0x16160e;var _0x31ee7c,_0x54b138;_0x415542===void 0x0&&(_0x415542={}),this[_0x24583d(0x199)][_0x24583d(0x2b3)](_0x2ce28f)||this[_0x24583d(0x199)]['set'](_0x2ce28f,new Map());const {snapshot:_0x5a2485,changesets:_0x43c061,error:_0xdb3ade}=await this[_0x24583d(0x298)]['getUnitOnRev'](_0x415542,{'unitID':_0x2ce28f,'type':H[_0x24583d(0x1e5)],'revision':_0x171d0c});if(Te(_0xdb3ade)||!_0x5a2485||!_0x5a2485['workbook'])throw new Error(_0x24583d(0x2e7));const _0x24fe54=(_0x31ee7c=_0x43c061==null?void 0x0:_0x43c061['length'])!=null?_0x31ee7c:0x0;if(_0x171d0c!==0x0&&_0x5a2485[_0x24583d(0x1e1)]+_0x24fe54!==_0x171d0c)throw new Error(_0x24583d(0x293));const {workbook:_0x4c895d}=_0x5a2485,_0x75645a=_0x4c895d[_0x24583d(0x251)]?Object['entries'](_0x4c895d[_0x24583d(0x251)])[_0x24583d(0x208)](([_0x3d1008,_0x599937])=>{const _0x5bbc7b=_0x24583d;var _0xb8019,_0x4ecc89;return(_0x4ecc89=(_0xb8019=_0x599937[_0x5bbc7b(0x282)])==null?void 0x0:_0xb8019[_0x5bbc7b(0x208)](_0x4d6290=>_0x4d6290))!=null?_0x4ecc89:[];})[_0x24583d(0x180)]():[],_0x29ba9c=(await Promise['all'](_0x75645a[_0x24583d(0x208)](_0xd3df7a=>this[_0x24583d(0x298)][_0x24583d(0x1f4)](_0x415542,{'unitID':_0x2ce28f,'type':H[_0x24583d(0x1e5)],'blockID':_0xd3df7a})[_0x24583d(0x1f7)](_0x584f10=>_0x584f10[_0x24583d(0x33e)]))))['filter'](_0x51ff1c=>!!_0x51ff1c),_0x160ea3=O[_0x24583d(0x29e)](_0x5a2485,_0x29ba9c,_0x415542);return(_0x54b138=this[_0x24583d(0x199)][_0x24583d(0x24b)](_0x2ce28f))==null||_0x54b138[_0x24583d(0x1bd)](_0x171d0c,{'workbook':_0x160ea3}),new Promise(_0x1c2a47=>{const _0x36c75f=_0x24583d,_0x2de3c7=this[_0x36c75f(0x2f9)]['getCurrentUnitForType'](l[_0x36c75f(0x372)]['UNIVER_SHEET']);_0x2de3c7?(this['_univerInstanceService'][_0x36c75f(0x30a)](_0x2de3c7[_0x36c75f(0x1b0)]()),setTimeout(()=>{const _0x5357a7=_0x36c75f;this[_0x5357a7(0x182)](_0x160ea3,_0x43c061),this[_0x5357a7(0x215)][_0x5357a7(0x321)](),_0x1c2a47(!0x0);},0x0)):(this['_createUnit'](_0x160ea3,_0x43c061),_0x1c2a47(!0x0));});}[_0x16160e(0x182)](_0x4d1f8f,_0x522295){const _0xb58b38=_0x16160e,_0x482f2f=this['_univerInstanceService'][_0xb58b38(0x333)](l['UniverInstanceType'][_0xb58b38(0x1e5)],_0x4d1f8f);this[_0xb58b38(0x2f9)][_0xb58b38(0x25d)](_0x482f2f[_0xb58b38(0x1b0)]());const _0x463245=this[_0xb58b38(0x361)][_0xb58b38(0x25b)][_0xb58b38(0x326)](this[_0xb58b38(0x361)]['interceptor']['getInterceptPoints']()[_0xb58b38(0x268)]);return _0x522295==null||_0x522295['forEach'](_0x5314da=>{const _0x5dbc7a=_0xb58b38,_0x496175=_0x5314da['mutations']['map'](_0x1a24b5=>({'id':_0x1a24b5['id'],'params':JSON[_0x5dbc7a(0x1a6)](_0x1a24b5['data'])}));({..._0x5314da,'mutations':_0x463245(_0x496175,null)||_0x496175}[_0x5dbc7a(0x301)][_0x5dbc7a(0x27c)](_0x2b8685=>{const _0x455438=_0x5dbc7a;this['_commandService'][_0x455438(0x292)](_0x2b8685['id'])&&this[_0x455438(0x277)][_0x455438(0x358)](_0x2b8685['id'],_0x2b8685[_0x455438(0x2eb)]);}));}),_0x482f2f;}};A=Ce([T(0x0,O['ISnapshotServerService']),T(0x1,l['IUniverInstanceService']),T(0x2,l[_0x16160e(0x1f5)]),T(0x3,l[_0x16160e(0x351)]),T(0x4,l[_0x16160e(0x29b)](oe[_0x16160e(0x265)])),T(0x5,l['Inject'](O[_0x16160e(0x1c9)])),T(0x6,l[_0x16160e(0x29b)](_[_0x16160e(0x337)]))],A);function Ue(_0x227e20){const _0x1edea8=_0x16160e;var _0x125618,_0x16fb1d;const _0x11c591=[],{entities:_0x299285,historyIds:_0x46da45}=_0x227e20,{datas:_0x643aa1,users:_0x15b31f}=_0x299285;for(const _0x182e01 of _0x46da45)if(_0x643aa1[_0x182e01]){const _0x34c087=!!((_0x125618=_0x15b31f[_0x643aa1[_0x182e01][_0x1edea8(0x26c)]])!=null&&_0x125618[_0x1edea8(0x391)]);_0x11c591[_0x1edea8(0x1ae)]({'unitId':_0x643aa1[_0x182e01][_0x1edea8(0x2e6)],'user':_0x34c087?'':((_0x16fb1d=_0x15b31f==null?void 0x0:_0x15b31f[_0x643aa1[_0x182e01][_0x1edea8(0x26c)]])==null?void 0x0:_0x16fb1d[_0x1edea8(0x253)])||'','isAnonymous':_0x34c087,'id':_0x182e01,'time':_0x643aa1[_0x182e01]['createTime']?Number(_0x643aa1[_0x182e01][_0x1edea8(0x227)]):void 0x0,'commands':_0x643aa1[_0x182e01][_0x1edea8(0x29f)],'startRev':Number(_0x643aa1[_0x182e01][_0x1edea8(0x2bd)]),'endRev':Number(_0x643aa1[_0x182e01]['endRevision']),'recoverTime':_0x643aa1[_0x182e01][_0x1edea8(0x267)]?Number(_0x643aa1[_0x182e01][_0x1edea8(0x267)]):void 0x0});}return _0x11c591;}var $e=Object[_0x16160e(0x211)],Ve=(_0x5a6998,_0x4e1728,_0x9c569a,_0x63c174)=>{const _0x1df958=_0x16160e;for(var _0x3ac69e=_0x63c174>0x1?void 0x0:_0x63c174?$e(_0x4e1728,_0x9c569a):_0x4e1728,_0x1ac1de=_0x5a6998[_0x1df958(0x390)]-0x1,_0x305860;_0x1ac1de>=0x0;_0x1ac1de--)(_0x305860=_0x5a6998[_0x1ac1de])&&(_0x3ac69e=_0x305860(_0x3ac69e)||_0x3ac69e);return _0x3ac69e;},V=(_0x4552be,_0x13dc3d)=>(_0x1d7aca,_0x198da0)=>_0x13dc3d(_0x1d7aca,_0x198da0,_0x4552be),Y=(_0x3967e8=>(_0x3967e8[_0x16160e(0x307)]=_0x16160e(0x2bf),_0x3967e8[_0x16160e(0x1b9)]=_0x16160e(0x186),_0x3967e8[_0x16160e(0x223)]=_0x16160e(0x243),_0x3967e8))(Y||{}),w=(_0x1fa2d5=>(_0x1fa2d5[_0x16160e(0x383)]=_0x16160e(0x1d0),_0x1fa2d5[_0x16160e(0x256)]=_0x16160e(0x308),_0x1fa2d5[_0x16160e(0x20a)]=_0x16160e(0x252),_0x1fa2d5))(w||{});const xe=_0x16160e(0x206);exports[_0x16160e(0x234)]=class extends l[_0x16160e(0x188)]{constructor(_0x3022f7,_0x552899,_0xa47da,_0x447bc4){const _0x11ec0f=_0x16160e;super(),u(this,_0x11ec0f(0x2c3),new R[(_0x11ec0f(0x294))]([])),u(this,'versions$',this['_versions$'][_0x11ec0f(0x346)]()),u(this,_0x11ec0f(0x387),new R[(_0x11ec0f(0x294))]('')),u(this,'currentVersion$',this['_currentVersion$'][_0x11ec0f(0x346)]()),u(this,_0x11ec0f(0x1a1),new R[(_0x11ec0f(0x294))](_0x11ec0f(0x2bf))),u(this,'status$',this[_0x11ec0f(0x1a1)][_0x11ec0f(0x346)]()),u(this,'_revertRevision$',new R[(_0x11ec0f(0x294))](0x0)),u(this,_0x11ec0f(0x209),this[_0x11ec0f(0x364)]['asObservable']()),u(this,_0x11ec0f(0x304),new R['BehaviorSubject']('')),u(this,_0x11ec0f(0x18d),this[_0x11ec0f(0x304)][_0x11ec0f(0x346)]()),u(this,'_fetching',!0x1),u(this,_0x11ec0f(0x2a6),new R['BehaviorSubject'](_0x11ec0f(0x1d0))),u(this,_0x11ec0f(0x28f),this[_0x11ec0f(0x2a6)]['asObservable']()),u(this,_0x11ec0f(0x1c6),null),u(this,_0x11ec0f(0x24a),!0x0),u(this,'_members',new Map()),u(this,_0x11ec0f(0x31f)),u(this,'_maskContainer'),u(this,'_maskElement'),u(this,_0x11ec0f(0x2c9),!0x1),(this[_0x11ec0f(0x261)]=_0x3022f7,this[_0x11ec0f(0x22f)]=_0x552899,this[_0x11ec0f(0x1f3)]=_0xa47da,this['_historyFetchService']=_0x447bc4);}async[_0x16160e(0x21d)](_0x12a854,_0x4ef12b,_0x3e008b){const _0x9138d6=_0x16160e;this[_0x9138d6(0x31f)]=_0x4ef12b,this[_0x9138d6(0x2c9)]=_0x3e008b,this['_unitId$'][_0x9138d6(0x1ac)](_0x12a854),this[_0x9138d6(0x1e6)]=!0x0;const _0x56e00a=await this[_0x9138d6(0x1b7)][_0x9138d6(0x279)](_0x12a854);if(this[_0x9138d6(0x1e6)]=!0x1,_0x56e00a){const {versions:_0x1075ac,lastLabel:_0x5a510c,hasMore:_0x37d6b4,members:_0x375a88}=_0x56e00a;_0x1075ac[_0x9138d6(0x390)]===0x0&&_0x1075ac[_0x9138d6(0x1ae)]({'unitId':_0x12a854,'id':xe,'startRev':0x1,'endRev':0x0,'time':Date[_0x9138d6(0x355)](),'user':this[_0x9138d6(0x1f3)]['t']('editHistory.panel.currentUser'),'commands':[],'isAnonymous':!0x1}),this['_updateVersions'](_0x1075ac,_0x37d6b4,_0x5a510c,_0x375a88),this['_currentVersion$'][_0x9138d6(0x1ac)](_0x1075ac[0x0]['id']);}else this[_0x9138d6(0x1a1)][_0x9138d6(0x1ac)](_0x9138d6(0x243));}async[_0x16160e(0x2b1)](){const _0x31fe45=_0x16160e;if(!this['_lastLabel']||!this[_0x31fe45(0x24a)]||this[_0x31fe45(0x1e6)])return!0x1;this[_0x31fe45(0x1e6)]=!0x0;const _0x384915=await this[_0x31fe45(0x1b7)][_0x31fe45(0x279)](this[_0x31fe45(0x2e6)],this[_0x31fe45(0x1c6)]);if(this[_0x31fe45(0x1e6)]=!0x1,_0x384915){const {versions:_0x5c4d36,lastLabel:_0x36dc5d,hasMore:_0x26cab0,members:_0x35319c}=_0x384915;this[_0x31fe45(0x370)](_0x5c4d36,_0x26cab0,_0x36dc5d,_0x35319c);}else this[_0x31fe45(0x261)][_0x31fe45(0x18b)]({'content':this[_0x31fe45(0x1f3)]['t'](_0x31fe45(0x1d2)),'type':P[_0x31fe45(0x225)][_0x31fe45(0x223)],'duration':0xbb8});return!0x0;}async['triggerLoadSheet'](_0x2d215e){const _0x49c752=_0x16160e;var _0x56a8bb;const _0x1aea9d=(_0x56a8bb=this[_0x49c752(0x2c3)][_0x49c752(0x237)])==null?void 0x0:_0x56a8bb['find'](_0x457f1f=>_0x457f1f['id']===_0x2d215e),{endRev:_0x207b6a}=_0x1aea9d||{};_0x207b6a||_0x207b6a===0x0?(this[_0x49c752(0x2a6)]['next'](_0x49c752(0x308)),await this[_0x49c752(0x1b7)][_0x49c752(0x2d8)](this[_0x49c752(0x2e6)],_0x207b6a),this[_0x49c752(0x2a6)][_0x49c752(0x1ac)]('loaded')):this[_0x49c752(0x1a1)][_0x49c752(0x1ac)](_0x49c752(0x243));}async[_0x16160e(0x21b)](_0x4f1f56){const _0x36bf60=_0x16160e,_0x4a01d7=_0x4f1f56?this[_0x36bf60(0x2fb)](_0x4f1f56):this['getCurrentVersion']();if(!_0x4a01d7)return;const _0x1aa516=_0x4a01d7[_0x36bf60(0x353)],_0x45e806=J(_0x4a01d7[_0x36bf60(0x238)],this[_0x36bf60(0x1f3)][_0x36bf60(0x1df)]());await this[_0x36bf60(0x22f)]['confirm']({'id':_0x36bf60(0x2e0),'title':{'title':this[_0x36bf60(0x1f3)]['t'](_0x36bf60(0x25c))},'children':{'title':this[_0x36bf60(0x1f3)]['t'](_0x36bf60(0x17d))+':\x20('+_0x45e806[_0x36bf60(0x1a2)]+'\x20'+_0x45e806[_0x36bf60(0x238)]+')'},'cancelText':this[_0x36bf60(0x1f3)]['t'](_0x36bf60(0x352)),'confirmText':this[_0x36bf60(0x1f3)]['t']('editHistory.panel.confirm')})&&this['_revertRevision$'][_0x36bf60(0x1ac)](_0x1aa516);}[_0x16160e(0x370)](_0x47611c,_0x44df22,_0x3777ed,_0x81238a){const _0x5bf636=_0x16160e;this[_0x5bf636(0x2c3)][_0x5bf636(0x1ac)](this[_0x5bf636(0x2c3)][_0x5bf636(0x237)]['concat'](_0x47611c)),this[_0x5bf636(0x24a)]=_0x44df22,this[_0x5bf636(0x1c6)]=_0x3777ed,_0x81238a&&Object[_0x5bf636(0x371)](_0x81238a)[_0x5bf636(0x27c)](_0x3ee695=>this['_members'][_0x5bf636(0x1bd)](_0x3ee695,_0x81238a[_0x3ee695]));}[_0x16160e(0x37f)](){const _0x1ae73c=_0x16160e;return this[_0x1ae73c(0x2fb)](this[_0x1ae73c(0x387)][_0x1ae73c(0x237)]);}['getVersion'](_0x56fecf){const _0x4ee62b=_0x16160e;var _0x13e8a4;return(_0x13e8a4=this[_0x4ee62b(0x2c3)][_0x4ee62b(0x237)])==null?void 0x0:_0x13e8a4[_0x4ee62b(0x2c2)](_0x6bfd50=>_0x6bfd50['id']===_0x56fecf);}[_0x16160e(0x2a4)](_0x482ecb){const _0x32f6dd=_0x16160e;return this[_0x32f6dd(0x203)][_0x32f6dd(0x24b)](_0x482ecb);}[_0x16160e(0x30f)](){const _0x44ced1=_0x16160e;this['_maskElement']=document[_0x44ced1(0x2af)](_0x44ced1(0x1ff)),this[_0x44ced1(0x368)][_0x44ced1(0x2e4)]=_0x44ced1(0x38a),this['_maskElement'][_0x44ced1(0x281)][_0x44ced1(0x392)]=_0x44ced1(0x2b9),this[_0x44ced1(0x368)]['style'][_0x44ced1(0x229)]='0',this[_0x44ced1(0x368)][_0x44ced1(0x281)][_0x44ced1(0x23d)]='0',this[_0x44ced1(0x368)][_0x44ced1(0x281)][_0x44ced1(0x1fc)]=_0x44ced1(0x288),this[_0x44ced1(0x368)][_0x44ced1(0x281)][_0x44ced1(0x285)]='100%',this[_0x44ced1(0x368)]['style'][_0x44ced1(0x377)]=_0x44ced1(0x1c7),this[_0x44ced1(0x368)][_0x44ced1(0x281)][_0x44ced1(0x32b)]=_0x44ced1(0x1b8),this[_0x44ced1(0x368)][_0x44ced1(0x281)][_0x44ced1(0x19c)]=_0x44ced1(0x2d1),this[_0x44ced1(0x368)][_0x44ced1(0x281)]['justifyContent']=_0x44ced1(0x183),this[_0x44ced1(0x368)][_0x44ced1(0x281)][_0x44ced1(0x397)]='1000',this[_0x44ced1(0x368)][_0x44ced1(0x281)]['display']=_0x44ced1(0x231),this[_0x44ced1(0x196)]['append'](this[_0x44ced1(0x368)]);}[_0x16160e(0x286)](){const _0x372844=_0x16160e;var _0x186781;const _0x66748e=(_0x186781=document[_0x372844(0x18e)](this['_historyContainerId']))==null?void 0x0:_0x186781[_0x372844(0x350)](_0x372844(0x2db));_0x66748e&&(this[_0x372844(0x196)]=_0x66748e,this['_createMask']());}[_0x16160e(0x2d4)](){const _0x3e3bf2=_0x16160e;this[_0x3e3bf2(0x196)]||this[_0x3e3bf2(0x286)](),this['_maskElement']&&(this[_0x3e3bf2(0x368)][_0x3e3bf2(0x281)][_0x3e3bf2(0x19c)]=_0x3e3bf2(0x2d1));}[_0x16160e(0x26a)](){const _0x52f773=_0x16160e;this[_0x52f773(0x368)]&&(this[_0x52f773(0x368)][_0x52f773(0x281)]['display']=_0x52f773(0x231));}set[_0x16160e(0x33c)](_0x59aad6){const _0x345b95=_0x16160e;this[_0x345b95(0x1a1)][_0x345b95(0x1ac)](_0x59aad6);}set[_0x16160e(0x2b6)](_0x263d8a){const _0x13d4c3=_0x16160e;_0x263d8a!==this[_0x13d4c3(0x387)][_0x13d4c3(0x237)]&&this[_0x13d4c3(0x387)][_0x13d4c3(0x1ac)](_0x263d8a);}get['currentVersion'](){const _0x190802=_0x16160e;return this[_0x190802(0x387)][_0x190802(0x237)];}set[_0x16160e(0x2e6)](_0x4ae4ee){const _0x509062=_0x16160e;this[_0x509062(0x304)][_0x509062(0x1ac)](_0x4ae4ee);}get[_0x16160e(0x2e6)](){const _0x5b0ccb=_0x16160e;return this[_0x5b0ccb(0x304)][_0x5b0ccb(0x237)];}get[_0x16160e(0x343)](){const _0x572689=_0x16160e;return this[_0x572689(0x2c9)];}get['loadingState'](){const _0x3ef42b=_0x16160e;return this['_loadingState$'][_0x3ef42b(0x237)];}},exports['HistoryManagerService']=Ve([V(0x0,d[_0x16160e(0x1af)]),V(0x1,d['IConfirmService']),V(0x2,l[_0x16160e(0x29b)](l['LocaleService'])),V(0x3,l[_0x16160e(0x29b)](A))],exports[_0x16160e(0x234)]);function W({ref:_0x2b7c45,..._0x5ee554}){const _0x1bfaea=_0x16160e,{icon:_0x341900,id:_0x5933e2,className:_0x401cd2,extend:_0x373ed1,..._0x391102}=_0x5ee554,_0x5ee607=(_0x1bfaea(0x28e)+_0x5933e2+'\x20'+(_0x401cd2||''))[_0x1bfaea(0x2a9)](),_0x22d8ef=p['useRef']('_'+Ae());return _e(_0x341900,''+_0x5933e2,{'defIds':_0x341900[_0x1bfaea(0x266)],'idSuffix':_0x22d8ef[_0x1bfaea(0x2df)]},{'ref':_0x2b7c45,'className':_0x5ee607,..._0x391102},_0x373ed1);}function _e(_0x1205af,_0x3b0661,_0x2002e7,_0x2b517d,_0x5b19d8){const _0x2cff08=_0x16160e;return p[_0x2cff08(0x2af)](_0x1205af[_0x2cff08(0x2e1)],{'key':_0x3b0661,...ke(_0x1205af,_0x2002e7,_0x5b19d8),..._0x2b517d},(He(_0x1205af,_0x2002e7)['children']||[])[_0x2cff08(0x208)]((_0x2b1a02,_0x52f31a)=>_e(_0x2b1a02,_0x3b0661+'-'+_0x1205af[_0x2cff08(0x2e1)]+'-'+_0x52f31a,_0x2002e7,void 0x0,_0x5b19d8)));}function ke(_0x43fe8e,_0x1ef162,_0x24d8b5){const _0x195292=_0x16160e,_0xa95dd2={..._0x43fe8e[_0x195292(0x21f)]};_0x24d8b5!=null&&_0x24d8b5[_0x195292(0x1f2)]&&_0xa95dd2['fill']==='colorChannel1'&&(_0xa95dd2[_0x195292(0x305)]=_0x24d8b5['colorChannel1']),_0x43fe8e[_0x195292(0x2e1)]===_0x195292(0x1c5)&&_0xa95dd2['id']&&(_0xa95dd2['id']=_0xa95dd2['id']+_0x1ef162[_0x195292(0x262)]),Object['entries'](_0xa95dd2)['forEach'](([_0x442dcd,_0x5ae701])=>{const _0x90534c=_0x195292;_0x442dcd===_0x90534c(0x1c5)&&typeof _0x5ae701==_0x90534c(0x330)&&(_0xa95dd2[_0x442dcd]=_0x5ae701[_0x90534c(0x1ec)](/url\(#(.*)\)/,'url(#$1'+_0x1ef162[_0x90534c(0x262)]+')'));});const {defIds:_0x1aac7d}=_0x1ef162;return!_0x1aac7d||_0x1aac7d[_0x195292(0x390)]===0x0||(_0x43fe8e[_0x195292(0x2e1)]===_0x195292(0x22a)&&_0xa95dd2[_0x195292(0x398)]&&(_0xa95dd2[_0x195292(0x398)]=_0xa95dd2[_0x195292(0x398)]+_0x1ef162[_0x195292(0x262)]),Object[_0x195292(0x24d)](_0xa95dd2)[_0x195292(0x27c)](([_0x5a44b4,_0x568731])=>{const _0x25118a=_0x195292;typeof _0x568731==_0x25118a(0x330)&&(_0xa95dd2[_0x5a44b4]=_0x568731['replace'](/url\(#(.*)\)/,_0x25118a(0x386)+_0x1ef162[_0x25118a(0x262)]+')'));})),_0xa95dd2;}function He(_0x5c9053,_0x3ac2ef){const _0x4d46be=_0x16160e;var _0x44e119;const {defIds:_0x38b239}=_0x3ac2ef;return!_0x38b239||_0x38b239['length']===0x0?_0x5c9053:_0x5c9053[_0x4d46be(0x2e1)]===_0x4d46be(0x217)&&((_0x44e119=_0x5c9053[_0x4d46be(0x382)])!=null&&_0x44e119['length'])?{..._0x5c9053,'children':_0x5c9053[_0x4d46be(0x382)][_0x4d46be(0x208)](_0x428980=>typeof _0x428980[_0x4d46be(0x21f)]['id']==_0x4d46be(0x330)&&_0x38b239&&_0x38b239[_0x4d46be(0x29c)](_0x428980[_0x4d46be(0x21f)]['id'])?{..._0x428980,'attrs':{..._0x428980[_0x4d46be(0x21f)],'id':_0x428980[_0x4d46be(0x21f)]['id']+_0x3ac2ef[_0x4d46be(0x262)]}}:_0x428980)}:_0x5c9053;}function Ae(){const _0x2d6d30=_0x16160e;return Math['random']()[_0x2d6d30(0x232)](0x24)[_0x2d6d30(0x32f)](0x2,0x8);}W[_0x16160e(0x271)]=_0x16160e(0x1db);const je={'tag':_0x16160e(0x204),'attrs':{'xmlns':_0x16160e(0x2da),'fill':_0x16160e(0x231),'viewBox':_0x16160e(0x1b4),'width':'1em','height':'1em'},'children':[{'tag':'path','attrs':{'fill':_0x16160e(0x1eb),'d':_0x16160e(0x24c)}}]},ue=p[_0x16160e(0x38c)](function(_0x38e3c7,_0x33999b){const _0x3847c1=_0x16160e;return p[_0x3847c1(0x2af)](W,Object[_0x3847c1(0x35a)]({},_0x38e3c7,{'id':'back-icon','ref':_0x33999b,'icon':je}));});ue[_0x16160e(0x271)]=_0x16160e(0x1b1);const Be={'tag':_0x16160e(0x204),'attrs':{'xmlns':_0x16160e(0x2da),'fill':'none','viewBox':_0x16160e(0x20e),'width':_0x16160e(0x329),'height':_0x16160e(0x329)},'children':[{'tag':'g','attrs':{'fill':_0x16160e(0x1eb),'clipPath':'url(#restore-icon_clip0_1247_2)'},'children':[{'tag':_0x16160e(0x381),'attrs':{'d':'M7.41252\x2010.6196C7.64683\x2010.3852\x207.64683\x2010.0053\x207.41252\x209.77103L6.77012\x209.12863H9.67836C9.89927\x209.12863\x2010.0784\x209.30772\x2010.0784\x209.52863V11.1953C10.0784\x2011.5267\x2010.347\x2011.7953\x2010.6784\x2011.7953C11.0097\x2011.7953\x2011.2784\x2011.5267\x2011.2784\x2011.1953V9.52863C11.2784\x208.64497\x2010.562\x207.92863\x209.67836\x207.92863H6.77012L7.41252\x207.28623C7.64683\x207.05191\x207.64683\x206.67201\x207.41252\x206.4377C7.1782\x206.20338\x206.79831\x206.20338\x206.56399\x206.4377L4.89732\x208.10437C4.66301\x208.33868\x204.66301\x208.71858\x204.89732\x208.95289L6.56399\x2010.6196C6.79831\x2010.8539\x207.1782\x2010.8539\x207.41252\x2010.6196Z'}},{'tag':'path','attrs':{'d':_0x16160e(0x39b),'fillRule':_0x16160e(0x2c7),'clipRule':'evenodd'}}]},{'tag':_0x16160e(0x217),'attrs':{},'children':[{'tag':_0x16160e(0x1b5),'attrs':{'id':_0x16160e(0x369)},'children':[{'tag':_0x16160e(0x18f),'attrs':{'width':0x10,'height':0x10,'y':0.05,'fill':_0x16160e(0x1b8),'rx':0x4}}]}]}],'defIds':[_0x16160e(0x369)]},he=p[_0x16160e(0x38c)](function(_0x307955,_0x3a5beb){const _0x5a6e84=_0x16160e;return p['createElement'](W,Object[_0x5a6e84(0x35a)]({},_0x307955,{'id':'restore-icon','ref':_0x3a5beb,'icon':Be}));});he[_0x16160e(0x271)]=_0x16160e(0x26f);const Fe={'tag':'svg','attrs':{'xmlns':'http://www.w3.org/2000/svg','fill':_0x16160e(0x231),'viewBox':_0x16160e(0x1b4),'width':_0x16160e(0x329),'height':_0x16160e(0x329)},'children':[{'tag':_0x16160e(0x381),'attrs':{'fill':_0x16160e(0x312),'d':'M8.79993\x2014.0166C8.79993\x2014.4585\x208.44176\x2014.8166\x207.99993\x2014.8166C4.23529\x2014.8166\x201.18345\x2011.7648\x201.18345\x208.00017C1.18345\x204.23554\x204.23529\x201.18369\x207.99993\x201.1837C11.7646\x201.1837\x2014.8164\x204.23554\x2014.8164\x208.00017C14.8164\x208.442\x2014.4582\x208.80017\x2014.0164\x208.80017C13.5746\x208.80017\x2013.2164\x208.442\x2013.2164\x208.00017C13.2164\x205.11919\x2010.8809\x202.7837\x207.99993\x202.7837C5.11895\x202.7837\x202.78345\x205.11919\x202.78345\x208.00017C2.78345\x2010.8812\x205.11895\x2013.2166\x207.99993\x2013.2166C8.44176\x2013.2166\x208.79993\x2013.5748\x208.79993\x2014.0166Z','fillOpacity':0.2,'fillRule':_0x16160e(0x2c7),'clipRule':_0x16160e(0x2c7)}},{'tag':_0x16160e(0x381),'attrs':{'fill':_0x16160e(0x312),'d':_0x16160e(0x18c),'fillRule':_0x16160e(0x2c7),'clipRule':_0x16160e(0x2c7)}}]},ee=p[_0x16160e(0x38c)](function(_0x1ee419,_0xacdeed){return p['createElement'](W,Object['assign']({},_0x1ee419,{'id':'loading-multi-icon','ref':_0xacdeed,'icon':Fe}));});ee['displayName']='LoadingMultiIcon';function Ye(){const _0x20e311=_0x16160e;var _0x2f915d;const _0x7ee2d4=d[_0x20e311(0x270)](exports[_0x20e311(0x234)]),_0x3d8b49=d[_0x20e311(0x270)](l[_0x20e311(0x310)]),_0x4028a1=p[_0x20e311(0x322)](()=>{const _0xb4438d=_0x20e311;_0x7ee2d4[_0xb4438d(0x33c)]=Y[_0xb4438d(0x1b9)];},[_0x7ee2d4]),_0x3d0f6f=p[_0x20e311(0x322)](()=>{_0x7ee2d4['triggerRevert']();},[_0x7ee2d4]),_0x4219c6=d[_0x20e311(0x1da)](_0x7ee2d4[_0x20e311(0x1e0)]),_0x4a05f2=d[_0x20e311(0x1da)](_0x7ee2d4[_0x20e311(0x1f1)]),_0x5dbe90=_0x4219c6===((_0x2f915d=_0x4a05f2==null?void 0x0:_0x4a05f2[0x0])==null?void 0x0:_0x2f915d['id']),_0x89262=_0x4219c6!==''&&!_0x5dbe90&&_0x7ee2d4[_0x20e311(0x343)];return h[_0x20e311(0x28b)](_0x20e311(0x1ff),{'className':P[_0x20e311(0x2e3)]('univer-flex\x20univer-h-12\x20univer-cursor-default\x20univer-items-center',P[_0x20e311(0x2a1)]),'children':[h[_0x20e311(0x26e)]('a',{'className':_0x20e311(0x1cd),'role':'button','onClick':_0x4028a1,'children':h[_0x20e311(0x26e)](ue,{'className':'univer-text-2xl\x20dark:!univer-text-white'})}),h['jsx'](_0x20e311(0x1ff),{'className':_0x20e311(0x236),'children':_0x89262&&h[_0x20e311(0x26e)](P[_0x20e311(0x284)],{'variant':'primary','onClick':_0x3d0f6f,'children':_0x3d8b49['t'](_0x20e311(0x2b2))})})]});}var We=Object[_0x16160e(0x211)],Xe=(_0x211d87,_0x19edbf,_0x4b3d30,_0x3797ca)=>{const _0x3a1153=_0x16160e;for(var _0x208b63=_0x3797ca>0x1?void 0x0:_0x3797ca?We(_0x19edbf,_0x4b3d30):_0x19edbf,_0x59d7d5=_0x211d87[_0x3a1153(0x390)]-0x1,_0x3fb6e4;_0x59d7d5>=0x0;_0x59d7d5--)(_0x3fb6e4=_0x211d87[_0x59d7d5])&&(_0x208b63=_0x3fb6e4(_0x208b63)||_0x208b63);return _0x208b63;},y=(_0x85f6ac,_0x30c37f)=>(_0x7bcd61,_0x13a520)=>_0x30c37f(_0x7bcd61,_0x13a520,_0x85f6ac);let j=class extends l['Disposable']{constructor(_0xc7a827,_0x410638,_0x17baab,_0x30f9d4,_0x336023,_0x441fae){const _0x30ae41=_0x16160e;super(),this['_permissionService']=_0xc7a827,this[_0x30ae41(0x1c2)]=_0x410638,this[_0x30ae41(0x261)]=_0x17baab,this[_0x30ae41(0x1f3)]=_0x30f9d4,this[_0x30ae41(0x378)]=_0x336023,this[_0x30ae41(0x2a2)]=_0x441fae,this[_0x30ae41(0x31b)]();}[_0x16160e(0x31b)](){const _0x5abc15=_0x16160e;this[_0x5abc15(0x189)](this[_0x5abc15(0x378)][_0x5abc15(0x1e0)][_0x5abc15(0x2de)](_0x4e13d3=>{const _0x286463=_0x5abc15;_0x4e13d3&&this[_0x286463(0x378)][_0x286463(0x35d)](_0x4e13d3);})),this['disposeWithMe'](this[_0x5abc15(0x303)][_0x5abc15(0x356)][_0x5abc15(0x2de)](_0x242ed2=>{const _0x1f6a4a=_0x5abc15,_0x3ff69f=this[_0x1f6a4a(0x378)][_0x1f6a4a(0x2e6)];_0x3ff69f&&(_0x242ed2[_0x1f6a4a(0x2a3)]===b['Edit']&&_0x242ed2['value']===!0x0&&this['_permissionService'][_0x1f6a4a(0x1aa)](new _['WorkbookEditablePermission'](_0x3ff69f)['id'],!0x1),_0x242ed2[_0x1f6a4a(0x2a3)]===b[_0x1f6a4a(0x399)]&&_0x242ed2['value']===!0x0&&this[_0x1f6a4a(0x303)][_0x1f6a4a(0x1aa)](new _[(_0x1f6a4a(0x240))](_0x3ff69f)['id'],!0x1),_0x242ed2['subType']===b[_0x1f6a4a(0x280)]&&_0x242ed2[_0x1f6a4a(0x237)]===!0x0&&this['_permissionService'][_0x1f6a4a(0x1aa)](new _[(_0x1f6a4a(0x1c4))](_0x3ff69f)['id'],!0x1),_0x242ed2['subType']===b['HideSheet']&&_0x242ed2[_0x1f6a4a(0x237)]===!0x0&&this['_permissionService'][_0x1f6a4a(0x1aa)](new _['WorkbookHideSheetPermission'](_0x3ff69f)['id'],!0x1),_0x242ed2[_0x1f6a4a(0x2a3)]===b['Comment']&&_0x242ed2[_0x1f6a4a(0x237)]===!0x0&&this[_0x1f6a4a(0x303)][_0x1f6a4a(0x1aa)](new _[(_0x1f6a4a(0x296))](_0x3ff69f)['id'],!0x1),_0x242ed2[_0x1f6a4a(0x2a3)]===b[_0x1f6a4a(0x26b)]&&_0x242ed2[_0x1f6a4a(0x237)]===!0x0&&this['_permissionService'][_0x1f6a4a(0x1aa)](new _[(_0x1f6a4a(0x296))](_0x3ff69f)['id'],!0x1));})),this[_0x5abc15(0x189)](this['_uiPartsService'][_0x5abc15(0x37d)](d['BuiltInUIPart'][_0x5abc15(0x259)],()=>d[_0x5abc15(0x278)](Ye,this[_0x5abc15(0x2a2)]))),this['disposeWithMe'](this['_historyManagerService']['loadingState$']['subscribe'](_0x3d85db=>{const _0x531dc2=_0x5abc15;_0x3d85db===w[_0x531dc2(0x256)]&&(this[_0x531dc2(0x378)][_0x531dc2(0x2d4)](),this[_0x531dc2(0x261)][_0x531dc2(0x18b)]({'type':P[_0x531dc2(0x225)][_0x531dc2(0x313)],'content':this[_0x531dc2(0x1f3)]['t'](_0x531dc2(0x2f2))})),_0x3d85db===w[_0x531dc2(0x20a)]&&this[_0x531dc2(0x378)][_0x531dc2(0x26a)]();}));}};j=Xe([y(0x0,l[_0x16160e(0x1a7)]),y(0x1,d[_0x16160e(0x373)]),y(0x2,d[_0x16160e(0x1af)]),y(0x3,l[_0x16160e(0x29b)](l['LocaleService'])),y(0x4,l[_0x16160e(0x29b)](exports[_0x16160e(0x234)])),y(0x5,l[_0x16160e(0x29b)](l[_0x16160e(0x38b)]))],j);var Ge=Object['getOwnPropertyDescriptor'],Ze=(_0x482f65,_0x2d7959,_0x218783,_0x558bcd)=>{const _0x3ac171=_0x16160e;for(var _0x4c57be=_0x558bcd>0x1?void 0x0:_0x558bcd?Ge(_0x2d7959,_0x218783):_0x2d7959,_0x58defa=_0x482f65[_0x3ac171(0x390)]-0x1,_0x1e7669;_0x58defa>=0x0;_0x58defa--)(_0x1e7669=_0x482f65[_0x58defa])&&(_0x4c57be=_0x1e7669(_0x4c57be)||_0x4c57be);return _0x4c57be;},G=(_0x120297,_0x346fe8)=>(_0x556135,_0x4e9ba7)=>_0x346fe8(_0x556135,_0x4e9ba7,_0x120297);function _0x36b9(){const _0x130b8b=['map','revertRevision$','Loaded','REDEMPTION_CODE_INACTIVE','APPLY_PERMISSION_DENIED','parseProtocolChangeset','0\x200\x2016\x2017','debounce','MOBILE_VERIFY_CODE_NOT_FOUND_OR_EXPIRED','getOwnPropertyDescriptor','UNIVER_SLIDE','ENTITLE_UPDOWN_GRADE_NOT_SUPPORT','close','_sheetPermissionInitController','558583BRXSbM','defs','setCF','1096jsolBr','_sidebarDisposable','triggerRevert','getHours','triggerLoadVersions','entities','attrs','ENTITLE_CAN_NOT_BUY_LOWER_OTP','insertSheet','Comment','Error','REDEMPTION_INVALID_CODE','MessageType','InsertHyperlink','createTime','combineLatest','top','use','user','UniverNetworkPlugin','SNAPSHOT_HAS_BEEN_REMOVED','/universer-api/history','_confirmService','HideWorksheet','none','toString','LICENSE_IMPORT_SIZE_EXCEEDED','HistoryManagerService','LICENSE_DISTRO_REJECTED','univer-flex\x20univer-flex-1\x20univer-items-center\x20univer-justify-center','value','time','getVpScrollXYInfoByPosToVp','LICENSE_EXPORT_SIZE_EXCEEDED','20259rZcOWM','univer-ml-2\x20univer-flex\x20univer-h-5\x20univer-items-center\x20univer-justify-center\x20univer-rounded\x20univer-border\x20univer-border-primary-600\x20univer-bg-primary-50\x20univer-px-1.5\x20univer-text-xs\x20univer-text-primary-600','left','UNIVER_UNKNOWN','isTransformMutationsSuccess','WorkbookRenameSheetPermission','DisposableCollection','CreatePermissionObject','error','univer-flex\x20univer-items-center\x20univer-justify-center','CURRENT_STATUS_CANNOT_OPERATE','subUnitId','LocaleType','state$','_lastPointer','_hasMore','get','M6.42416\x204.42417C6.65847\x204.18985\x206.65847\x203.80995\x206.42416\x203.57564C6.18984\x203.34132\x205.80994\x203.34132\x205.57563\x203.57564L1.57564\x207.57564C1.34132\x207.80995\x201.34132\x208.18985\x201.57564\x208.42417L5.57563\x2012.4242C5.80994\x2012.6585\x206.18984\x2012.6585\x206.42416\x2012.4242C6.65847\x2012.1899\x206.65847\x2011.81\x206.42416\x2011.5756L3.44843\x208.5999H14C14.3314\x208.5999\x2014.6\x208.33127\x2014.6\x207.9999C14.6\x207.66853\x2014.3314\x207.3999\x2014\x207.3999H3.44843L6.42416\x204.42417Z','entries','REDEMPTION_USER_REDEEM_TIMES_EXCEED','sheetId','changesets','blockMeta','loaded','name','_componentManager','YUUMI_URL_COL_OUT_OF_RANGE','Loading','REDEMPTION_USER_NOT_ELIGIBLE','_configService','HEADER','RangeMergeUtil','interceptor','editHistory.panel.revertConfirm','focusUnit','univer-h-full\x20univer-space-y-2\x20univer-overflow-auto\x20univer-pb-4','5010645GtbJtv','CONNECTOR_DATA_TOO_LARGE','_messageService','idSuffix','UNIVER_DOC','MOBILE_VERIFY_CODE_MISMATCH','HTTPService','defIds','recoverTime','COMPRESS_MUTATION_APPLY','MoveWorksheet','hideMask','FloatImg','userId','SelectUnProtectedCells','jsx','RestoreIcon','useDependency','displayName','univer-m-auto\x20univer-animate-spin','ENTITLE_REPORT_LIMIT_EXCEED','ENTITLE_NEED_BILLING_ADDRESS','univer-flex\x20univer-h-7\x20univer-w-full\x20univer-items-center\x20univer-justify-center','clear','_commandService','connectInjector','getVersions','SNAPSHOT_INVALID_SNAPSHOT','getViewport','forEach','APPLY_NON_SEQUENTIAL_REVISION','6945590UHSzyj','onStarting','MoveSheet','style','blocks','MOBILE_HAS_BEEN_BOUND','Button','height','_initMaskContainer','versions','100%','editHistory.panel.title','REDEMPTION_CODE_HAS_BEEN_CREATED','jsxs','getDataRange','_dialogOptions$','univerjs-icon\x20univerjs-icon-','loadingState$','ISidebarService','VIEW_MAIN','hasCommand','[HistoryFetchService]:\x20wrong\x20rev\x20from\x20the\x20server!','BehaviorSubject','InsertSheetMutation','WorkbookEditablePermission','_initActiveSwitch','_snapshotServerService','APPLY_REJECT','AddConditionalRuleMutation','Inject','includes','_getAPIPrefix','transformSnapshotToWorkbookData','command','commands','borderBottomClassName','_injector','subType','getMember','CreateSheet','_loadingState$','UNDEFINED','Copy','trim','SheetSkeletonManagerService','SetNumfmtMutation','SetWorksheetActiveOperation','editHistory.action.etc','some','createElement','DependentOn','loadMoreVersions','editHistory.header.revert','has','ViemRwHgtClWdt','SetCellStyle','currentVersion','SetFrozenMutation','onPointerMove$','absolute','code','getMinutes','_getRangesByMutation','startRevision','stopPropagation','entered','univer-flex\x20univer-h-6\x20univer-w-full\x20univer-justify-between','MoveRowsMutation','find','_versions$','UNIVER_EDIT_HISTORY_VIEWER_PLUGIN','executeCommand','_diffs','evenodd','fetchMissingChangesets','_canRevert','USER_NOT_INVITED_CODE','range','endColumn','CreateUnitMutation','setState','add','loadingState','flex','91280BnKCGc','Fragment','showMask','PY_RUNTIME_SCRIPT_ERROR','SetRowStyle','MoveRangeMutation','loadSheet','DeleteWorksheetProtectionMutation','http://www.w3.org/2000/svg','.univer-app-container-content','INVALID_ARGUMENT','SnapshotServerOverHTTPService','subscribe','current','confirm-revert-revision','tag','YUUMI_PROMPT_MAX_TOKENS_EXCEEDED','clsx','className','ObjectMatrix','unitId','[HistoryFetchService]:\x20request\x20snapshot\x20error!','cellValue','RwHgtClWdt','Delete','params','from','UNIVER_PROJECT','_removeDiffMarks','EMAIL_VERIFY_CODE_NOT_FOUND_OR_EXPIRED','Sort','ICellEditorManagerService','editHistory.info.loading','HideSheet','merge','setFilter','setValue','IRenderManagerService','EMAIL_VERIFY_CODE_MISMATCH','_univerInstanceService','filter','getVersion','ENTITLE_DUP_SUBSCRIPTION','values','APPLY_REVISION_CONFILICT','historyListServerUrl','addProtection','mutations','SelectProtectedCells','_permissionService','_unitId$','fill','TOO_MANY_REQUESTS','Entered','loading','YUUMI_ALL_TABLES_IS_INVALID','disposeUnit','PERMISSION_DENIED','_updateDiffMarks','YUUMI_AI_RUN_FAILED','AddSheetSparklineMutation','_createMask','LocaleService','ensureVersion','#0B9EFB','Info','_sheetSkeletonManagerService','DeleteWorksheet','startColumn','SetSheetsFilterRangeMutation','ISnapshotServerService','AddWorksheetMergeMutation','7010GcNTLT','_init','setDV','univer-text-gray-500','AddWorksheetProtectionMutation','_historyContainerId','getCurrent','refreshRangeProtectPermission','useCallback','InsertRow','Share','dispose','fetchThroughInterceptors','REDEMPTION_CODE_NOT_STARTED','_renderManagerService','1em','_openPanel','color','ManageCollaborator','YUUMI_ASYNCIO_CANCELLED','DeleteRangeProtectionMutation','substring','string','column','SetRangeValuesMutation','createUnit','ENTITLE_INSUFFICIENT_QUOTA','edit-history-viewer.config','userID','SheetPermissionInitController','Print','ReorderRangeMutation','_versionDiffService','univer-animate-spin','status','univer-flex\x20univer-flex-1\x20univer-items-center\x20univer-text-sm\x20univer-text-gray-600\x20dark:!univer-text-gray-200','block','AUTHORIZE_CODE_ILLEGAL','editHistory.panel.currentVersion','currentSkeleton$','currentVersionDiff$','canRevert','active','_httpService','asObservable','_extractRanges','editSheet','RemoveSheetMutation','LICENSE_MAX_MEMBERS_PER_UNIT_EXCEEDED','ERROR_AGAIN','reduce','_currentVersionDiff$','IImageIoService','editHistory.panel.revertDesc','querySelector','IConfigService','editHistory.panel.cancel','endRev','_combineRanges','now','permissionPointUpdate$','DeleteSheet','syncExecuteCommand','defineProperty','assign','getDialogs$','_config','triggerLoadSheet','sheet','INVITE_CODE_ALREADY_BOUND','onRendered','_compressMutationService','editHistory.action.revertSheetSuffix','ZH_CN','_revertRevision$','INTERNAL_ERROR','getCellPositionByOffset','AddRangeProtectionMutation','_maskElement','restore-icon_clip0_1247_2','ViewFilter','SetConditionalRuleMutation','span','_transformService','addSparkline','1748316jyBcYB','_updateVersions','keys','UniverInstanceType','IUIPartsService','8590158JLNvgX','YUUMI_TABLE_NOT_FOUND_IN_UNIT','m1Prime','backgroundColor','_historyManagerService','InsertColumn','pipe','INVITE_CODE_REQUIRED','REDEMPTION_CODE_FULLY_REDEEMED','registerComponent','CollaborationImageIoService','getCurrentVersion','ITransformService','path','children','Init','InsertRowMutation','EMAIL_HAS_BEEN_BOUND','url(#$1','_currentVersion$','Tooltip','univer-flex\x20univer-items-center\x20univer-gap-2.5\x20univer-py-1.5\x20univer-text-sm\x20univer-font-medium','history-mask','Injector','forwardRef','Edit','open','SetCellValue','length','anonymous','position','INVITE_CODE_HAS_BEEN_UES','NOT_FOUND','dateString','PivotTable','zIndex','xlink:href','RenameSheet','Today','M2.06678\x203.37926C2.0668\x201.94333\x203.23085\x200.779297\x204.66678\x200.779297H9.44256C10.1796\x200.779297\x2010.8821\x201.09213\x2011.3751\x201.63999L13.2659\x203.74079C13.6955\x204.21822\x2013.9333\x204.83779\x2013.9333\x205.4801V12.7126C13.9333\x2014.1486\x2012.7692\x2015.3126\x2011.3333\x2015.3126H4.66665C3.2307\x2015.3126\x202.06663\x2014.1486\x202.06665\x2012.7126L2.06678\x203.37926ZM4.66678\x201.9793C3.89359\x201.9793\x203.26679\x202.60609\x203.26678\x203.37928L3.26665\x2012.7126C3.26664\x2013.4858\x203.89344\x2014.1126\x204.66665\x2014.1126H11.3333C12.1065\x2014.1126\x2012.7333\x2013.4858\x2012.7333\x2012.7126V5.4801C12.7333\x205.44882\x2012.7322\x205.41764\x2012.7302\x205.3866H10.7985C9.91488\x205.3866\x209.19853\x204.67026\x209.19853\x203.78661V1.9793H4.66678ZM10.4832\x202.44275L12.0526\x204.1866H10.7985C10.5776\x204.1866\x2010.3985\x204.00752\x2010.3985\x203.78661V2.35649C10.4279\x202.38389\x2010.4561\x202.41266\x2010.4832\x202.44275Z','editHistory.panel.revertConfirmText','_getActiveSubUnitId','ViewHistory','flat','_cellEditorManagerService','_createUnit','center','setFrozen','RevertRevisionMutation','exited','EditExtraObject','Disposable','disposeWithMe','WECHAT_HAS_BEEN_BOUND','show','M7.20007\x201.98384C7.20007\x201.54201\x207.55824\x201.18384\x208.00007\x201.18384C11.7647\x201.18384\x2014.8165\x204.23568\x2014.8165\x208.00032C14.8165\x2011.765\x2011.7647\x2014.8168\x208.00007\x2014.8168C4.23543\x2014.8168\x201.18359\x2011.765\x201.18359\x208.00032C1.18359\x207.55849\x201.54177\x207.20031\x201.98359\x207.20031C2.42542\x207.20031\x202.78359\x207.55849\x202.78359\x208.00032C2.78359\x2010.8813\x205.11909\x2013.2168\x208.00007\x2013.2168C10.8811\x2013.2168\x2013.2165\x2010.8813\x2013.2165\x208.00032C13.2165\x205.11933\x2010.8811\x202.78384\x208.00007\x202.78384C7.55824\x202.78384\x207.20007\x202.42567\x207.20007\x201.98384Z','unitId$','getElementById','rect','UniverSheetsUIPlugin','RenameWorksheet','History','editHistory.action.','endRow','getSheetObject','_maskContainer','APPLY_DUPLICATED','ENTITLE_CHAT_LIMIT_EXCEED','_workbookDataCache','_transformMutationByOrder','INVALID_INVITE_CODE','display','symbol','skeleton','View','SetWorksheetStyle','_status$','date','toISOString','rgba(58,\x2096,\x20247,\x200.20)','4jRMWma','parse','IPermissionService','YUUMI_SUBSCRIPTION_NOT_FOUND','register','updatePermissionPoint','ranges','next','deleteProtection','push','IMessageService','getUnitId','BackIcon','Export','SetWorksheetHideMutation','0\x200\x2016\x2016','clipPath','_sidebarService','_historyFetchService','white','Exited','startRow','getRelativeToViewportCoord','EditWorksheetCell','set','YUUMI_RATE_OVER_LIMIT','USER_NOT_FOUND','rule','editHistory.panel.unknownUser','_uiPartsService','CHANGESET_REVISION_CONFILICT','WorkbookMoveSheetPermission','mask','_lastLabel','rgba(225,\x20225,\x20225,\x200.5)','split','CompressMutationService','bottom','findAllRectangle','getCoordByCell','univer-ml-2.5\x20univer-flex\x20univer-size-8\x20univer-cursor-pointer\x20univer-items-center\x20univer-justify-center\x20univer-rounded','createSheet','DeleteColumn','init','MoveColsMutation','editHistory.panel.listFetchError','RemoveNumfmtMutation','Vector2','PAYMENT_CHANNEL_NOT_SUPPORT','forValue','_initRender','_context','Subject','useObservable','UniverIcon','FromArray','UniverEditHistoryViewerPlugin','UpdateDataValidationMutation','getCurrentLocale','currentVersion$','rev','switchMap','DATA_SOURCE_TOO_LARGE','LOGIN_TOKEN_PROCESSING_FAILED','UNIVER_SHEET','_fetching','univer-text-sm\x20univer-leading-5\x20univer-text-gray-500\x20dark:!univer-text-gray-300','scrollEvent$','DeleteRow','hidden','currentColor','replace','ALREADY_EXISTS','AddDataValidationMutation','LOGIN_FAILED','UNRECOGNIZED','versions$','colorChannel1','_localeService','getDeserializedSheetBlock','ICommandService','CreateWorksheet','then','CopySheet','SetColumnStyle','subscribeEvent','YUUMI_UNABLE_LOAD_URL','width','SheetCollabCursorShape','body','div','_getSheetObject','makeDirty','COMPLETION_FINISHED','_members','svg','ENSURE_SNAPSHOT_EXECUTION','VIRTUAL_VERSION_NOW','_diffRangesMap'];_0x36b9=function(){return _0x130b8b;};return _0x36b9();}let $=class extends l[_0x16160e(0x188)]{constructor(_0x51c836,_0x23a02d,_0x37c649){const _0x1aefae=_0x16160e;super(),u(this,_0x1aefae(0x207),new Map()),u(this,_0x1aefae(0x34d),new R['BehaviorSubject']({'ranges':new Map(),'active':null})),u(this,_0x1aefae(0x342),this['_currentVersionDiff$']['asObservable']()),(this[_0x1aefae(0x378)]=_0x51c836,this[_0x1aefae(0x36d)]=_0x23a02d,this[_0x1aefae(0x298)]=_0x37c649,this[_0x1aefae(0x31b)]());}['_init'](){const _0x527875=_0x16160e;this[_0x527875(0x207)]=new Map(),this[_0x527875(0x189)](this[_0x527875(0x378)][_0x527875(0x18d)][_0x527875(0x2de)](_0x3bb851=>{const _0x2b5a0c=_0x527875;_0x3bb851&&!this[_0x2b5a0c(0x207)][_0x2b5a0c(0x2b3)](_0x3bb851)&&this[_0x2b5a0c(0x207)][_0x2b5a0c(0x1bd)](_0x3bb851,new Map());})),this[_0x527875(0x189)](this['_historyManagerService'][_0x527875(0x1e0)][_0x527875(0x2de)](async _0x2c6516=>{const _0x45b496=_0x527875;var _0x2b7a4b;_0x2c6516&&(await this[_0x45b496(0x311)](_0x2c6516),this[_0x45b496(0x34d)][_0x45b496(0x1ac)](((_0x2b7a4b=this[_0x45b496(0x207)][_0x45b496(0x24b)](this[_0x45b496(0x378)][_0x45b496(0x2e6)]))==null?void 0x0:_0x2b7a4b[_0x45b496(0x24b)](_0x2c6516))||{'ranges':new Map(),'active':null}));}));}async['ensureVersion'](_0x1ec9e3){const _0x2531d4=_0x16160e;var _0xa97463,_0x149cdc;const _0x4eccdb=this[_0x2531d4(0x378)]['getVersion'](_0x1ec9e3),_0x189579=this[_0x2531d4(0x378)][_0x2531d4(0x2e6)];if(!_0x4eccdb||!_0x189579)return;const _0x5da44a=this[_0x2531d4(0x207)][_0x2531d4(0x24b)](_0x189579);if(_0x5da44a||this[_0x2531d4(0x207)]['set'](_0x189579,new Map()),(_0xa97463=this[_0x2531d4(0x207)]['get'](_0x189579))!=null&&_0xa97463['has'](_0x4eccdb['id']))return;const {startRev:_0x1bd040,endRev:_0x426eff}=_0x4eccdb;if(_0x1bd040===0x1){_0x5da44a[_0x2531d4(0x1bd)](_0x4eccdb['id'],{'ranges':new Map(),'active':null});return;}const _0x4d2262=_0x1bd040-0x1,_0x334816=_0x426eff,_0x238707=await this[_0x2531d4(0x298)][_0x2531d4(0x2c8)]({},{'unitID':_0x189579,'from':_0x4d2262,'to':_0x334816,'type':H['UNIVER_SHEET']});if(((_0x149cdc=_0x238707[_0x2531d4(0x243)])==null?void 0x0:_0x149cdc[_0x2531d4(0x2ba)])===F['OK']){const _0x41a834=_0x238707[_0x2531d4(0x250)]['map'](_0x4645e3=>((_0x4645e3['mutations']===null||_0x4645e3[_0x2531d4(0x301)]===void 0x0)&&(_0x4645e3['mutations']=[]),O[_0x2531d4(0x20d)](_0x4645e3)))['map'](_0x211148=>_0x211148[_0x2531d4(0x301)][_0x2531d4(0x208)](_0x2c0f2e=>({..._0x2c0f2e,'params':{..._0x2c0f2e[_0x2531d4(0x2eb)],'memberId':_0x211148[_0x2531d4(0x336)]}})))[_0x2531d4(0x180)](),_0x337522=this[_0x2531d4(0x19a)](_0x41a834),_0x41d0d4=this['_getActiveSubUnitId'](_0x41a834),_0xb9988b=this[_0x2531d4(0x347)](_0x337522);_0x5da44a[_0x2531d4(0x1bd)](_0x4eccdb['id'],{'ranges':_0xb9988b,'active':_0x41d0d4});}}[_0x16160e(0x19a)](_0x3d282f){const _0x4b3ea1=_0x16160e;let _0x21058c=[];for(let _0x41ed37=0x0;_0x41ed37<_0x3d282f[_0x4b3ea1(0x390)];_0x41ed37++){const _0x55414a=_0x3d282f[_0x41ed37];if(_0x21058c[_0x4b3ea1(0x1ae)](_0x55414a),_0x41ed37!==_0x3d282f[_0x4b3ea1(0x390)]-0x1){const _0x74c7e=_0x3d282f[_0x41ed37+0x1],_0x558935=this[_0x4b3ea1(0x36d)]['transformMutations'](_0x21058c,[_0x74c7e]);O[_0x4b3ea1(0x23f)](_0x558935)?_0x21058c=_0x558935[_0x4b3ea1(0x376)]:_0x21058c=[];}}return _0x21058c;}[_0x16160e(0x17e)](_0x4b4d23){const _0x3241ec=_0x16160e;let _0x419816=[];return _0x4b4d23[_0x3241ec(0x27c)](_0x4ef213=>{const _0x559998=_0x3241ec;if(_0x4ef213['id']===_[_0x559998(0x295)]['id']){const _0x29d141=_0x4ef213['params'];_0x419816['push'](_0x29d141[_0x559998(0x35e)]['id']);}else{if(_0x4ef213['id']===_[_0x559998(0x349)]['id']){const _0x553020=_0x4ef213[_0x559998(0x2eb)];_0x419816['length']>0x0&&(_0x419816=_0x419816[_0x559998(0x2fa)](_0x9f58a4=>_0x9f58a4!==_0x553020[_0x559998(0x246)]));}else{if(_0x4ef213['id']===_[_0x559998(0x1b3)]['id']){const _0x17e5aa=_0x4ef213[_0x559998(0x2eb)];_0x17e5aa[_0x559998(0x1ea)]?_0x419816=_0x419816[_0x559998(0x2fa)](_0x55be0a=>_0x55be0a!==_0x17e5aa[_0x559998(0x246)]):_0x419816[_0x559998(0x1ae)](_0x17e5aa[_0x559998(0x246)]);}else{const _0x3ce9db=_0x4ef213[_0x559998(0x2eb)];_0x3ce9db[_0x559998(0x246)]&&_0x419816[_0x559998(0x1ae)](_0x3ce9db['subUnitId']);}}}}),_0x419816[_0x3241ec(0x390)]>0x0?_0x419816[_0x419816[_0x3241ec(0x390)]-0x1]:null;}[_0x16160e(0x347)](_0x3d4d43){const _0x5a630b=_0x16160e,_0x165710=new Map();return _0x3d4d43[_0x5a630b(0x27c)](_0x4bed42=>{const _0x418600=_0x5a630b;var _0x385719,_0x3c004f;const _0x2e49ae=(_0x385719=_0x4bed42[_0x418600(0x2eb)])==null?void 0x0:_0x385719['memberId'];if(_0x2e49ae){_0x165710[_0x418600(0x2b3)](_0x2e49ae)||_0x165710[_0x418600(0x1bd)](_0x2e49ae,[]);const _0x488528=this[_0x418600(0x2bc)](_0x4bed42);(_0x3c004f=_0x165710[_0x418600(0x24b)](_0x2e49ae))==null||_0x3c004f[_0x418600(0x1ae)](..._0x488528);}}),_0x165710[_0x5a630b(0x27c)]((_0x49c8ed,_0x326689)=>{const _0x1cb45c=_0x5a630b;_0x165710['set'](_0x326689,this[_0x1cb45c(0x354)](_0x49c8ed));}),_0x165710;}[_0x16160e(0x2bc)](_0x23bc33){const _0x319347=_0x16160e;switch(_0x23bc33['id']){case _[_0x319347(0x367)]['id']:{const _0x5f425e=_0x23bc33[_0x319347(0x2eb)];return _0x5f425e['rules'][_0x319347(0x208)](_0x1f6aaa=>_0x1f6aaa['ranges']['map'](_0x307057=>({'range':_0x307057,'unitId':_0x5f425e[_0x319347(0x2e6)],'subUnitId':_0x5f425e['subUnitId']})))[_0x319347(0x180)]();}case _[_0x319347(0x319)]['id']:{const _0x2e8e5f=_0x23bc33['params'];return _0x2e8e5f[_0x319347(0x1ab)][_0x319347(0x208)](_0x490675=>({'range':_0x490675,'unitId':_0x2e8e5f[_0x319347(0x2e6)],'subUnitId':_0x2e8e5f[_0x319347(0x246)]}));}case _[_0x319347(0x384)]['id']:{const _0x103ff8=_0x23bc33['params'];return[{'range':_0x103ff8[_0x319347(0x2cb)],'unitId':_0x103ff8['unitId'],'subUnitId':_0x103ff8['subUnitId']}];}case _['InsertColMutation']['id']:{const _0x47388e=_0x23bc33['params'];return[{'range':_0x47388e[_0x319347(0x2cb)],'unitId':_0x47388e['unitId'],'subUnitId':_0x47388e[_0x319347(0x246)]}];}case _[_0x319347(0x2d7)]['id']:{const _0x2727d6=_0x23bc33[_0x319347(0x2eb)],{from:_0x554e34,to:_0x28b580,unitId:_0x22d309}=_0x2727d6;return[{'range':re(_0x554e34[_0x319347(0x237)]),'unitId':_0x22d309,'subUnitId':_0x554e34['subUnitId']},{'range':re(_0x28b580[_0x319347(0x237)]),'unitId':_0x22d309,'subUnitId':_0x28b580[_0x319347(0x246)]}];}case _[_0x319347(0x2c1)]['id']:{const _0x1c0966=_0x23bc33['params'],{unitId:_0x2cdb7b,subUnitId:_0x32bf85,sourceRange:_0xa5d628,targetRange:_0x2c3597}=_0x1c0966,_0x24cb5c=_0xa5d628[_0x319347(0x194)]-_0xa5d628[_0x319347(0x1ba)]+0x1;return[{'range':_0x2c3597[_0x319347(0x1ba)]<=_0xa5d628[_0x319347(0x1ba)]?_0x2c3597:{..._0x2c3597,'startRow':_0x2c3597[_0x319347(0x1ba)]-_0x24cb5c,'endRow':_0x2c3597['endRow']-_0x24cb5c},'unitId':_0x2cdb7b,'subUnitId':_0x32bf85}];}case _[_0x319347(0x1d1)]['id']:{const _0xb3e337=_0x23bc33[_0x319347(0x2eb)],{unitId:_0x5ba625,subUnitId:_0x14a276,sourceRange:_0x10ae32,targetRange:_0x1214e8}=_0xb3e337,_0x577501=_0x10ae32[_0x319347(0x2cc)]-_0x10ae32[_0x319347(0x316)]+0x1;return[{'range':_0x1214e8[_0x319347(0x316)]<=_0x10ae32[_0x319347(0x316)]?_0x1214e8:{..._0x1214e8,'startColumn':_0x1214e8[_0x319347(0x316)]-_0x577501,'endColumn':_0x1214e8[_0x319347(0x2cc)]-_0x577501},'unitId':_0x5ba625,'subUnitId':_0x14a276}];}case _[_0x319347(0x2ab)]['id']:{const _0x889ecf=_0x23bc33[_0x319347(0x2eb)],{values:_0x48ecbb,unitId:_0x3884bd,subUnitId:_0x346231}=_0x889ecf;return Object[_0x319347(0x2fd)](_0x48ecbb)[_0x319347(0x208)](_0x4dd818=>_0x4dd818[_0x319347(0x1ab)][_0x319347(0x208)](_0x392811=>({'range':_0x392811,'unitId':_0x3884bd,'subUnitId':_0x346231})))[_0x319347(0x180)]();}case _[_0x319347(0x1d3)]['id']:{const _0x33d0e7=_0x23bc33[_0x319347(0x2eb)],{ranges:_0x9df2b5,unitId:_0x285cfd,subUnitId:_0x2bb3e8}=_0x33d0e7;return _0x9df2b5[_0x319347(0x208)](_0x4f6ce6=>({'range':_0x4f6ce6,'unitId':_0x285cfd,'subUnitId':_0x2bb3e8}));}case _[_0x319347(0x339)]['id']:{const _0x1a7b28=_0x23bc33[_0x319347(0x2eb)],{unitId:_0x11eb31,subUnitId:_0x2effc3,range:_0x3ecf1d}=_0x1a7b28;return[{'range':_0x3ecf1d,'unitId':_0x11eb31,'subUnitId':_0x2effc3}];}case _['SetRangeProtectionMutation']['id']:{const _0x56cad6=_0x23bc33[_0x319347(0x2eb)];return _0x56cad6[_0x319347(0x1c0)][_0x319347(0x1ab)][_0x319347(0x208)](_0x1ed501=>({'range':_0x1ed501,'unitId':_0x56cad6[_0x319347(0x2e6)],'subUnitId':_0x56cad6[_0x319347(0x246)]}));}case _[_0x319347(0x332)]['id']:{const _0xf828a2=_0x23bc33[_0x319347(0x2eb)];return _0xf828a2[_0x319347(0x2e8)]?qe(_0xf828a2['cellValue'])[_0x319347(0x208)](_0x36c19c=>({'range':_0x36c19c,'unitId':_0xf828a2['unitId'],'subUnitId':_0xf828a2['subUnitId']})):[];}case ce[_0x319347(0x317)]['id']:{const _0x1b2bdf=_0x23bc33['params'];return[{'range':_0x1b2bdf['range'],'unitId':_0x1b2bdf['unitId'],'subUnitId':_0x1b2bdf['subUnitId']}];}case q[_0x319347(0x1ee)]['id']:{const _0x5c5392=_0x23bc33[_0x319347(0x2eb)];return(Array['isArray'](_0x5c5392[_0x319347(0x1c0)])?_0x5c5392[_0x319347(0x1c0)]:[_0x5c5392['rule']])['map'](_0x3c1fb5=>_0x3c1fb5[_0x319347(0x1ab)][_0x319347(0x208)](_0x5f3f5e=>({'range':_0x5f3f5e,'unitId':_0x5c5392[_0x319347(0x2e6)],'subUnitId':_0x5c5392[_0x319347(0x246)]})))[_0x319347(0x180)]();}case K[_0x319347(0x36b)]['id']:{const _0x37e03b=_0x23bc33[_0x319347(0x2eb)];return _0x37e03b[_0x319347(0x1c0)]['ranges'][_0x319347(0x208)](_0x253613=>({'range':_0x253613,'unitId':_0x37e03b[_0x319347(0x2e6)],'subUnitId':_0x37e03b[_0x319347(0x246)]}));}default:return[];}}[_0x16160e(0x354)](_0x5e4c12){const _0x5445cf=_0x16160e;if(_0x5e4c12[_0x5445cf(0x390)]<=0x1)return _0x5e4c12;const _0x1cf126=new Map();return _0x5e4c12[_0x5445cf(0x27c)](_0xbffbb9=>{const _0x5630a8=_0x5445cf;var _0xb03699;const {unitId:_0x515bf0,subUnitId:_0x2a0354}=_0xbffbb9,_0x43ac14=_0x515bf0+'-'+_0x2a0354;_0x1cf126[_0x5630a8(0x2b3)](_0x43ac14)?(_0xb03699=_0x1cf126['get'](_0x43ac14))==null||_0xb03699[_0x5630a8(0x1ae)](_0xbffbb9):_0x1cf126[_0x5630a8(0x1bd)](_0x43ac14,[_0xbffbb9]);}),Array[_0x5445cf(0x2ec)](_0x1cf126[_0x5445cf(0x2fd)]())[_0x5445cf(0x208)](_0x58104b=>new _[(_0x5445cf(0x25a))]()[_0x5445cf(0x2cf)](..._0x58104b[_0x5445cf(0x208)](_0x514a40=>_0x514a40[_0x5445cf(0x2cb)]))[_0x5445cf(0x2f4)]()[_0x5445cf(0x208)](_0xf7d297=>({'range':_0xf7d297,'unitId':_0x58104b[0x0][_0x5445cf(0x2e6)],'subUnitId':_0x58104b[0x0][_0x5445cf(0x246)]})))[_0x5445cf(0x180)]();}};$=Ze([G(0x0,l[_0x16160e(0x29b)](exports[_0x16160e(0x234)])),G(0x1,O[_0x16160e(0x380)]),G(0x2,O[_0x16160e(0x318)])],$);function re(_0x29c40f){const _0x43811c=_0x16160e;return new l[(_0x43811c(0x2e5))](_0x29c40f)[_0x43811c(0x28c)]();}function qe(_0x2893a4){const _0x3472b0=_0x16160e,_0x4f0ae1=new l[(_0x3472b0(0x2e5))](_0x2893a4),_0x1ca2ab=new l[(_0x3472b0(0x2e5))]();return _0x4f0ae1[_0x3472b0(0x1d6)]((_0x577170,_0x54e7f1)=>{const _0x58d4a0=_0x3472b0;_0x1ca2ab[_0x58d4a0(0x2f6)](_0x577170,_0x54e7f1,0x1);}),_[_0x3472b0(0x1cb)](_0x1ca2ab);}var Ke=Object['getOwnPropertyDescriptor'],Qe=(_0x23f618,_0x255895,_0x4d0749,_0x6dd4e4)=>{const _0x504404=_0x16160e;for(var _0x3bea59=_0x6dd4e4>0x1?void 0x0:_0x6dd4e4?Ke(_0x255895,_0x4d0749):_0x255895,_0x4130b2=_0x23f618[_0x504404(0x390)]-0x1,_0x12ffb7;_0x4130b2>=0x0;_0x4130b2--)(_0x12ffb7=_0x23f618[_0x4130b2])&&(_0x3bea59=_0x12ffb7(_0x3bea59)||_0x3bea59);return _0x3bea59;},L=(_0x512cce,_0x31b3d7)=>(_0x4792f1,_0x542428)=>_0x31b3d7(_0x4792f1,_0x542428,_0x512cce);let z=class extends l[_0x16160e(0x188)]{constructor(_0x5c07b5,_0x1a61b1,_0x12dca3,_0x2f6173,_0x3b21c4,_0x25ec65,_0x431655){const _0x2d4060=_0x16160e;super(),u(this,'_diffs',new Set()),u(this,_0x2d4060(0x249),null),(this[_0x2d4060(0x1d8)]=_0x5c07b5,this['_historyManagerService']=_0x1a61b1,this[_0x2d4060(0x33a)]=_0x12dca3,this['_univerInstanceService']=_0x2f6173,this[_0x2d4060(0x328)]=_0x3b21c4,this['_sheetSkeletonManagerService']=_0x25ec65,this[_0x2d4060(0x277)]=_0x431655,this[_0x2d4060(0x31b)]());}[_0x16160e(0x31b)](){const _0x26da47=_0x16160e;this['_initRender'](),this[_0x26da47(0x297)]();}[_0x16160e(0x1d7)](){const _0x3bf7ea=_0x16160e;this[_0x3bf7ea(0x189)](R[_0x3bf7ea(0x228)]([this[_0x3bf7ea(0x378)][_0x3bf7ea(0x28f)],this[_0x3bf7ea(0x314)][_0x3bf7ea(0x341)]])[_0x3bf7ea(0x37a)](R[_0x3bf7ea(0x1e2)](([_0x2c7c52,_0x2f7227])=>{const _0x3882be=_0x3bf7ea;if(_0x2c7c52===w['Loaded']&&_0x2f7227){const _0x273e2d=_0x2f7227[_0x3882be(0x24f)];return this['_versionDiffService']['currentVersionDiff$'][_0x3882be(0x37a)](R[_0x3882be(0x208)](_0x1fb7f2=>{const _0x54f1ef=_0x3882be,_0x22d5e6=new Map();return _0x1fb7f2[_0x54f1ef(0x1ab)]['forEach']((_0x222b36,_0x46ea9a)=>{const _0x3a9d65=_0x54f1ef,_0x5df3aa=_0x222b36['filter'](_0x5bbe0c=>_0x5bbe0c[_0x3a9d65(0x246)]===_0x273e2d);_0x22d5e6[_0x3a9d65(0x1bd)](_0x46ea9a,_0x5df3aa);}),{'skeleton':_0x2f7227,'diffs':_0x22d5e6};}));}return R['of']({'skeleton':null,'diffs':new Map()});}))[_0x3bf7ea(0x2de)](({skeleton:_0x5d58a7,diffs:_0x5ba5c9})=>{const _0x1f0c78=_0x3bf7ea;this[_0x1f0c78(0x2ee)](),_0x5d58a7&&this[_0x1f0c78(0x30c)](_0x5d58a7,_0x5ba5c9);})),this[_0x3bf7ea(0x189)](this['_sheetSkeletonManagerService'][_0x3bf7ea(0x341)][_0x3bf7ea(0x2de)](_0x5953da=>{const _0x4fa593=_0x3bf7ea;if(_0x5953da==null)return;const {skeleton:_0xa87306}=_0x5953da,{scene:_0x4dda15}=this[_0x4fa593(0x1d8)];_0x4dda15[_0x4fa593(0x2b8)][_0x4fa593(0x1fa)](l[_0x4fa593(0x20f)](_0x140fab=>{const _0xc9fc2d=_0x4fa593;var _0x23604d,_0x2ab9db;const {offsetX:_0x2641f6,offsetY:_0x5a37fd}=_0x140fab,{x:_0x487f26,y:_0x533ef0}=_0x4dda15[_0xc9fc2d(0x1bb)](U[_0xc9fc2d(0x1d4)][_0xc9fc2d(0x1dc)]([_0x2641f6,_0x5a37fd])),{scaleX:_0x4452ce,scaleY:_0xabec86}=_0x4dda15['getAncestorScale'](),_0x2ca205=_0x4dda15[_0xc9fc2d(0x27b)](U['SHEET_VIEWPORT_KEY'][_0xc9fc2d(0x291)]),_0x18e8dc=_0x4dda15[_0xc9fc2d(0x239)](U[_0xc9fc2d(0x1d4)][_0xc9fc2d(0x1dc)]([_0x487f26,_0x533ef0]),_0x2ca205),_0x4fcb18=_0xa87306[_0xc9fc2d(0x366)](_0x2641f6,_0x5a37fd,_0x4452ce,_0xabec86,_0x18e8dc);((_0x23604d=this[_0xc9fc2d(0x249)])==null?void 0x0:_0x23604d['column'])===_0x4fcb18[_0xc9fc2d(0x331)]&&((_0x2ab9db=this[_0xc9fc2d(0x249)])==null?void 0x0:_0x2ab9db['row'])===_0x4fcb18['row']||this[_0xc9fc2d(0x2c6)][_0xc9fc2d(0x27c)](_0x11873c=>{_0x11873c['onMouseMove'](_0x4fcb18);});},0x64));}));}[_0x16160e(0x297)](){const _0x5f64ab=_0x16160e;this[_0x5f64ab(0x189)](this['_historyManagerService'][_0x5f64ab(0x28f)][_0x5f64ab(0x2de)](_0x4178bd=>{const _0x55ff1b=_0x5f64ab,_0x37b835=new l[(_0x55ff1b(0x241))]();return _0x4178bd===w[_0x55ff1b(0x20a)]&&(_0x37b835[_0x55ff1b(0x325)](),_0x37b835[_0x55ff1b(0x2cf)](this[_0x55ff1b(0x33a)]['currentVersionDiff$']['subscribe'](_0x2fcc90=>{const _0x2c1d8e=_0x55ff1b;_0x2fcc90[_0x2c1d8e(0x344)]&&this[_0x2c1d8e(0x277)][_0x2c1d8e(0x2c5)](_[_0x2c1d8e(0x2ac)]['id'],{'unitId':this['_context']['unitId'],'subUnitId':_0x2fcc90[_0x2c1d8e(0x344)]});}))),()=>_0x37b835[_0x55ff1b(0x325)]();}));}['_updateDiffMarks'](_0x4fcca6,_0x10cc1a){const _0x2a8f48=_0x16160e;var _0x11fa7f;const _0x76f1f1=(_0x11fa7f=this[_0x2a8f48(0x314)][_0x2a8f48(0x320)]())==null?void 0x0:_0x11fa7f[_0x2a8f48(0x19e)];if(!_0x76f1f1)return;this[_0x2a8f48(0x2c6)][_0x2a8f48(0x27c)](_0x586def=>{const _0x4b1dac=_0x2a8f48;_0x586def[_0x4b1dac(0x201)]();});const {scene:_0x386706}=this[_0x2a8f48(0x1d8)],_0x5d7f5f=Array[_0x2a8f48(0x2ec)](_0x10cc1a[_0x2a8f48(0x371)]())[_0x2a8f48(0x208)](_0x46565e=>_0x10cc1a[_0x2a8f48(0x24b)](_0x46565e)[_0x2a8f48(0x208)](_0x36b8cf=>{const _0x2342de=_0x2a8f48;var _0x1996d6;const {range:_0x5b647c,subUnitId:_0x514309,unitId:_0x176b0f}=_0x36b8cf,{startColumn:_0xb5e739,startRow:_0xff2330,endColumn:_0x5a77e9,endRow:_0xfcaae1}=_0x5b647c,_0xec974e=C['getCoordByCell'](_0xff2330,_0xb5e739,_0x386706,_0x76f1f1),_0x1e3049=C[_0x2342de(0x1cc)](_0xfcaae1,_0x5a77e9,_0x386706,_0x76f1f1),{columnHeaderHeightAndMarginTop:_0x277df6}=_0x76f1f1,{startX:_0x5a73b5,startY:_0x56d76a}=_0xec974e,{endX:_0x3a0e32,endY:_0xb83b90}=_0x1e3049,_0x42c81d=_0x3a0e32-_0x5a73b5,_0x24ef8f=_0xb83b90-_0x56d76a,_0x241498={'labelPosition':_0x56d76a-_0x277df6>=0x14?_0x2342de(0x229):_0x2342de(0x1ca),'sheetID':_0x514309,'range':_0x5b647c,'color':_0x2342de(0x1a4),'fillAfterStrokeEnabled':!0x0,'backgroundColor':'rgba(58,\x2096,\x20247,\x200.20)','name':((_0x1996d6=this[_0x2342de(0x378)][_0x2342de(0x2a4)](_0x46565e))==null?void 0x0:_0x1996d6[_0x2342de(0x253)])||'','selection':_0x176b0f+'-'+_0x514309+'-'+_0x5b647c[_0x2342de(0x316)]+'-'+_0x5b647c[_0x2342de(0x1ba)]+'-'+_0x5b647c['endColumn']+'-'+_0x5b647c['endRow'],'left':_0x5a73b5,'top':_0x56d76a,'width':_0x42c81d,'height':_0x24ef8f,'evented':!0x1,'zIndex':0x1};return new Ne[(_0x2342de(0x1fd))]('',_0x241498);}))[_0x2a8f48(0x180)]();_0x386706['addObjects'](_0x5d7f5f,0x1),this[_0x2a8f48(0x2c6)]=new Set(_0x5d7f5f);}[_0x16160e(0x2ee)](){const _0x29274a=_0x16160e;var _0xa45a0b;(_0xa45a0b=this[_0x29274a(0x2c6)])==null||_0xa45a0b[_0x29274a(0x27c)](_0x4b15af=>_0x4b15af[_0x29274a(0x325)]());}[_0x16160e(0x200)](){const _0x2ff01d=_0x16160e;return C[_0x2ff01d(0x195)](this['_univerInstanceService'],this[_0x2ff01d(0x328)]);}};z=Qe([L(0x1,l['Inject'](exports[_0x16160e(0x234)])),L(0x2,l[_0x16160e(0x29b)]($)),L(0x3,l['IUniverInstanceService']),L(0x4,U[_0x16160e(0x2f7)]),L(0x5,l['Inject'](C[_0x16160e(0x2aa)])),L(0x6,l[_0x16160e(0x1f5)])],z);function ze(){const _0x4337f6=_0x16160e,_0x53e3ac=d[_0x4337f6(0x270)](exports[_0x4337f6(0x234)]),_0x470773=d['useObservable'](_0x53e3ac['versions$']),[_0x47f5b0,_0x4e0caa]=p['useState'](!0x1),_0x3d0be3=ye(_0x470773);return _0x470773?h[_0x4337f6(0x26e)]('div',{'className':'univer-overflow-hidden','children':h[_0x4337f6(0x28b)](_0x4337f6(0x1ff),{'className':_0x4337f6(0x25e),'children':[_0x3d0be3[_0x4337f6(0x208)]((_0x4502f1,_0x4b2b49)=>h['jsxs'](p[_0x4337f6(0x2d3)],{'children':[h[_0x4337f6(0x26e)](tt,{'date':_0x4502f1[_0x4337f6(0x395)]}),_0x4502f1['versions'][_0x4337f6(0x208)]((_0x4cf979,_0x3ad9d2)=>h[_0x4337f6(0x26e)](st,{'index':[_0x4b2b49,_0x3ad9d2],'item':_0x4cf979},_0x4b2b49+'-'+_0x3ad9d2))]},_0x4502f1['dateString'])),_0x47f5b0&&h[_0x4337f6(0x26e)](Je,{})]})}):h[_0x4337f6(0x26e)](et,{});}function Je(){const _0x72594e=_0x16160e;return h[_0x72594e(0x26e)](_0x72594e(0x1ff),{'className':_0x72594e(0x275),'children':h[_0x72594e(0x26e)](ee,{'className':_0x72594e(0x33b)})});}function et(){const _0x123455=_0x16160e;return h[_0x123455(0x26e)](_0x123455(0x1ff),{'className':_0x123455(0x244),'children':h[_0x123455(0x26e)](_0x123455(0x36c),{'className':_0x123455(0x31d),'children':h[_0x123455(0x26e)](ee,{'className':_0x123455(0x272)})})});}function tt(_0x1c76c4){const _0x4aae3c=_0x16160e,_0x1dc077=d['useDependency'](l[_0x4aae3c(0x310)]),{date:_0x4ca242}=_0x1c76c4;return h[_0x4aae3c(0x26e)]('div',{'className':_0x4aae3c(0x389),'children':Q(_0x4ca242,_0x1dc077[_0x4aae3c(0x1df)]())});}function st(_0x3956bd){const _0xfcfda=_0x16160e,{item:_0x7ea29f,index:_0x24ff95}=_0x3956bd,{time:_0x2bdc18,user:_0x2c4d32}=_0x7ea29f,[_0x22b1bf,_0x534f12]=_0x24ff95,_0x3271d5=d['useDependency'](exports[_0xfcfda(0x234)]),_0x114cb4=d[_0xfcfda(0x1da)](_0x3271d5['currentVersion$'],'',!0x0)===_0x7ea29f['id'],_0x4dda8f=_0x22b1bf===0x0&&_0x534f12===0x0,_0x25c7db=!_0x4dda8f&&_0x3271d5['canRevert'],_0x854253=d[_0xfcfda(0x270)](l[_0xfcfda(0x310)]),_0x4db0da=_0x854253[_0xfcfda(0x1df)](),_0x284657=J(_0x2bdc18,_0x4db0da),_0x445ef6=_0x854253['t'](_0xfcfda(0x340)),_0x3c2ee0=p[_0xfcfda(0x322)](_0x5af521=>{const _0x243ac6=_0xfcfda;_0x3271d5[_0x243ac6(0x2d0)]!==w[_0x243ac6(0x256)]&&(_0x3271d5[_0x243ac6(0x2b6)]=_0x5af521);},[_0x3271d5]),_0x1823a5=p[_0xfcfda(0x322)](_0x23ac8d=>{const _0x1af408=_0xfcfda;_0x3271d5[_0x1af408(0x21b)](_0x23ac8d);},[_0x3271d5]);return h[_0xfcfda(0x28b)](_0xfcfda(0x1ff),{'className':P[_0xfcfda(0x2e3)]('univer-h-15\x20univer-flex\x20univer-cursor-pointer\x20univer-flex-col\x20univer-justify-center\x20univer-gap-1\x20univer-rounded-md\x20univer-px-4\x20univer-py-1.5\x20univer-transition-colors\x20hover:univer-bg-gray-100\x20dark:hover:!univer-bg-gray-800',{'univer-bg-gray-50\x20dark:!univer-bg-gray-900':_0x114cb4}),'onClick':()=>_0x3c2ee0(_0x7ea29f['id']),'children':[h['jsxs'](_0xfcfda(0x1ff),{'className':_0xfcfda(0x2c0),'children':[h[_0xfcfda(0x28b)]('div',{'className':_0xfcfda(0x33d),'children':[h[_0xfcfda(0x26e)](_0xfcfda(0x36c),{'children':_0x284657[_0xfcfda(0x238)]}),_0x4dda8f&&h[_0xfcfda(0x26e)](_0xfcfda(0x36c),{'className':_0xfcfda(0x23c),'children':_0x445ef6})]}),h[_0xfcfda(0x26e)](_0xfcfda(0x1ff),{'children':_0x25c7db&&h[_0xfcfda(0x26e)](P[_0xfcfda(0x388)],{'title':_0x854253['t'](_0xfcfda(0x34f)),'children':h[_0xfcfda(0x26e)](_0xfcfda(0x1ff),{'onClick':_0x4c1f1a=>{const _0x5cf177=_0xfcfda;_0x4c1f1a[_0x5cf177(0x2be)](),_0x1823a5(_0x7ea29f['id']);},'className':'univer-flex\x20univer-size-6\x20univer-items-center\x20univer-justify-center\x20univer-rounded\x20univer-text-gray-400\x20hover:univer-bg-gray-100\x20dark:hover:!univer-bg-gray-700','children':h['jsx'](he,{})})})})]}),h[_0xfcfda(0x26e)](_0xfcfda(0x1ff),{'className':_0xfcfda(0x1e7),'children':be(_0x7ea29f,_0x854253)})]});}var it=Object[_0x16160e(0x211)],nt=(_0x31ec2e,_0x43d412,_0x139d4c,_0x1f98aa)=>{const _0x1e38f4=_0x16160e;for(var _0x3c10f4=_0x1f98aa>0x1?void 0x0:_0x1f98aa?it(_0x43d412,_0x139d4c):_0x43d412,_0x1b1366=_0x31ec2e[_0x1e38f4(0x390)]-0x1,_0x5ca9b0;_0x1b1366>=0x0;_0x1b1366--)(_0x5ca9b0=_0x31ec2e[_0x1b1366])&&(_0x3c10f4=_0x5ca9b0(_0x3c10f4)||_0x3c10f4);return _0x3c10f4;},x=(_0x141718,_0xa47347)=>(_0x22572e,_0x51c908)=>_0xa47347(_0x22572e,_0x51c908,_0x141718);const ae='history-panel';let B=class extends l[_0x16160e(0x188)]{constructor(_0x1dce47,_0x14867b,_0x52a6fa,_0x4a101c){const _0x32a9e0=_0x16160e;super(),u(this,_0x32a9e0(0x21a),null),(this[_0x32a9e0(0x1b6)]=_0x1dce47,this[_0x32a9e0(0x254)]=_0x14867b,this[_0x32a9e0(0x1f3)]=_0x52a6fa,this[_0x32a9e0(0x378)]=_0x4a101c,this[_0x32a9e0(0x31b)]());}[_0x16160e(0x31b)](){const _0x95ccf8=_0x16160e;this['_initPanel'](),this[_0x95ccf8(0x32a)]();}[_0x16160e(0x32a)](){const _0x2b4678=_0x16160e;if(this[_0x2b4678(0x21a)])return;const _0x5a7738={'header':{'title':this[_0x2b4678(0x1f3)]['t'](_0x2b4678(0x289))},'children':{'label':ae},'onClose':()=>{const _0x4aa7b3=_0x2b4678;this[_0x4aa7b3(0x21a)]=null,this[_0x4aa7b3(0x378)][_0x4aa7b3(0x33c)]=Y[_0x4aa7b3(0x1b9)];}};this['_sidebarDisposable']=this[_0x2b4678(0x1b6)][_0x2b4678(0x38e)]({..._0x5a7738});}['_initPanel'](){const _0x5a5a83=_0x16160e;this[_0x5a5a83(0x189)](this['_componentManager'][_0x5a5a83(0x1a9)](ae,ze)),this[_0x5a5a83(0x189)](this['_sidebarService'][_0x5a5a83(0x1e8)]['pipe'](R['debounceTime'](0x64))['subscribe'](_0x5e5b45=>{const {target:_0x4716bc}=_0x5e5b45||{};if(_0x4716bc){const {scrollTop:_0x51a2fb,scrollHeight:_0x3da7b5,clientHeight:_0x3ba5fc}=_0x4716bc;_0x51a2fb+_0x3ba5fc>=_0x3da7b5-0x5&&this['_historyManagerService']['loadMoreVersions']();}}));}};B=nt([x(0x0,d[_0x16160e(0x290)]),x(0x1,l[_0x16160e(0x29b)](d['ComponentManager'])),x(0x2,l[_0x16160e(0x29b)](l[_0x16160e(0x310)])),x(0x3,l['Inject'](exports[_0x16160e(0x234)]))],B);class rt extends l[_0x16160e(0x188)]{constructor(){const _0x1a745d=_0x16160e;super(),u(this,_0x1a745d(0x28d),new R[(_0x1a745d(0x1d9))]());}[_0x16160e(0x38e)](){return l['toDisposable'](()=>{});}[_0x16160e(0x214)](){}['closeAll'](_0x3e08aa){}[_0x16160e(0x35b)](){const _0x186bcc=_0x16160e;return this[_0x186bcc(0x28d)][_0x186bcc(0x346)]();}}var at=Object['defineProperty'],ot=Object[_0x16160e(0x211)],ct=(_0x2aaeec,_0x92305b,_0x3fa249)=>_0x92305b in _0x2aaeec?at(_0x2aaeec,_0x92305b,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0x3fa249}):_0x2aaeec[_0x92305b]=_0x3fa249,lt=(_0x4467c1,_0x118197,_0x26afcf,_0x35f99c)=>{const _0x457c90=_0x16160e;for(var _0x2e39f3=_0x35f99c>0x1?void 0x0:_0x35f99c?ot(_0x118197,_0x26afcf):_0x118197,_0x383732=_0x4467c1[_0x457c90(0x390)]-0x1,_0x9ff877;_0x383732>=0x0;_0x383732--)(_0x9ff877=_0x4467c1[_0x383732])&&(_0x2e39f3=_0x9ff877(_0x2e39f3)||_0x2e39f3);return _0x2e39f3;},Z=(_0x399f38,_0xaf2d3a)=>(_0x3d7912,_0x3a8094)=>_0xaf2d3a(_0x3d7912,_0x3a8094,_0x399f38),_t=(_0x25dac7,_0xb49692,_0x40ff0b)=>ct(_0x25dac7,_0xb49692+'',_0x40ff0b);const ut=_0x16160e(0x2c4);exports['UniverEditHistoryViewerPlugin']=class extends l['Plugin']{constructor(_0x3596a9=ne,_0x55f487,_0x386809,_0x374e65){const _0x409a02=_0x16160e;super(),this['_config']=_0x3596a9,this['_injector']=_0x55f487,this['_renderManagerService']=_0x386809,this[_0x409a02(0x258)]=_0x374e65;const {..._0x4343f6}=l[_0x409a02(0x2f4)]({},ne,this[_0x409a02(0x35c)]);this['_configService']['setConfig'](le,_0x4343f6);}[_0x16160e(0x27f)](){const _0xc66ac6=_0x16160e;[[exports[_0xc66ac6(0x234)]],[j],[$],[A],[B],[k],[O[_0xc66ac6(0x318)],{'useClass':ie[_0xc66ac6(0x2dd)]}],[d['IDialogService'],{'useClass':rt}],[pe[_0xc66ac6(0x34e)],{'useClass':ie[_0xc66ac6(0x37e)]}]][_0xc66ac6(0x27c)](_0x417b25=>this[_0xc66ac6(0x2a2)][_0xc66ac6(0x2cf)](_0x417b25)),this[_0xc66ac6(0x2a2)][_0xc66ac6(0x24b)](j);}[_0x16160e(0x360)](){const _0x548f18=_0x16160e;[[z]]['forEach'](_0x249ebf=>{const _0x696f0f=_0x1dcf;this[_0x696f0f(0x189)](this[_0x696f0f(0x328)]['registerRenderModule'](l[_0x696f0f(0x372)][_0x696f0f(0x1e5)],_0x249ebf));}),this[_0x548f18(0x2a2)][_0x548f18(0x24b)](k),this['_injector']['get'](B);}['onSteady'](){const _0x57d82f=_0x16160e;this[_0x57d82f(0x2a2)][_0x57d82f(0x24b)]($);}},_t(exports['UniverEditHistoryViewerPlugin'],'pluginName',ut),exports[_0x16160e(0x1dd)]=lt([l[_0x16160e(0x2b0)](C[_0x16160e(0x190)],oe[_0x16160e(0x22c)]),Z(0x1,l[_0x16160e(0x29b)](l['Injector'])),Z(0x2,U['IRenderManagerService']),Z(0x3,l[_0x16160e(0x351)])],exports[_0x16160e(0x1dd)]),exports['HistoryModeStatus']=Y;