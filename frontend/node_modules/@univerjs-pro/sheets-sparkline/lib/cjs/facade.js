'use strict';const _0x3b3394=_0x4242;(function(_0x52516d,_0x1385fc){const _0x6fa5a7=_0x4242,_0x2a5935=_0x52516d();while(!![]){try{const _0x3e8c92=parseInt(_0x6fa5a7(0x1fb))/0x1*(-parseInt(_0x6fa5a7(0x212))/0x2)+-parseInt(_0x6fa5a7(0x20f))/0x3+parseInt(_0x6fa5a7(0x1d3))/0x4*(-parseInt(_0x6fa5a7(0x1fc))/0x5)+-parseInt(_0x6fa5a7(0x1d2))/0x6+-parseInt(_0x6fa5a7(0x206))/0x7+parseInt(_0x6fa5a7(0x208))/0x8+parseInt(_0x6fa5a7(0x1ce))/0x9*(parseInt(_0x6fa5a7(0x203))/0xa);if(_0x3e8c92===_0x1385fc)break;else _0x2a5935['push'](_0x2a5935['shift']());}catch(_0x29cd77){_0x2a5935['push'](_0x2a5935['shift']());}}}(_0x42e4,0xd67bd));Object[_0x3b3394(0x219)](exports,Symbol[_0x3b3394(0x202)],{'value':_0x3b3394(0x1d1)});const s=require('@univerjs-pro/sheets-sparkline'),c=require('@univerjs/core'),M=require('@univerjs/sheets/facade'),k=require('@univerjs/core/facade'),U=require('@univerjs/sheets');var x=Object['getOwnPropertyDescriptor'],R=(_0x1d90d6,_0x2453f0,_0x335268,_0x379917)=>{const _0x2a5f92=_0x3b3394;for(var _0xc0cdc=_0x379917>0x1?void 0x0:_0x379917?x(_0x2453f0,_0x335268):_0x2453f0,_0x953be1=_0x1d90d6[_0x2a5f92(0x1e0)]-0x1,_0x188f4c;_0x953be1>=0x0;_0x953be1--)(_0x188f4c=_0x1d90d6[_0x953be1])&&(_0xc0cdc=_0x188f4c(_0xc0cdc)||_0xc0cdc);return _0xc0cdc;},B=(_0x27b99e,_0x2b41fc)=>(_0x5cd3f0,_0x1f3f1e)=>_0x2b41fc(_0x5cd3f0,_0x1f3f1e,_0x27b99e);exports['FSparkline']=class{constructor(_0x416d33,_0x3cceeb,_0x80b192,_0x3ed847,_0x2cacad,_0x234a85){const _0x27fe63=_0x3b3394;this[_0x27fe63(0x1e8)]=_0x416d33,this['_subUnitId']=_0x3cceeb,this[_0x27fe63(0x209)]=_0x80b192,this[_0x27fe63(0x1d8)]=_0x3ed847,this[_0x27fe63(0x1db)]=_0x2cacad,this[_0x27fe63(0x1f2)]=_0x234a85;}[_0x3b3394(0x1ff)](_0x4720ec,_0x140943){const _0x497534=_0x3b3394,_0x3947d1=this[_0x497534(0x1f2)][_0x497534(0x210)](s[_0x497534(0x1f7)]),_0xe4384b=this['_injector'][_0x497534(0x210)](c['ICommandService']),_0x1eba9f=_0x3947d1[_0x497534(0x20a)](this[_0x497534(0x1e8)],this[_0x497534(0x1e6)],this['_groupId']);if(!_0x1eba9f)return;const _0x4cbc88={'config':_0x1eba9f,'isChangeDataSource':!0x0,'changeDataSourceInfo':{'groupId':this[_0x497534(0x209)],'resetType':_0x497534(0x21d),'sourceRanges':[_0x4720ec],'targetRanges':[_0x140943],'primary':{'startRow':this[_0x497534(0x1d8)],'startColumn':this[_0x497534(0x1db)],'endRow':this[_0x497534(0x1d8)],'endColumn':this['_col'],'actualRow':this['_row'],'actualColumn':this[_0x497534(0x1db)],'isMerged':!0x1,'isMergedMainCell':!0x1}}};return _0xe4384b[_0x497534(0x21b)](s[_0x497534(0x1f1)]['id'],_0x4cbc88),this['_row']=_0x140943[_0x497534(0x1e9)],this['_col']=_0x140943['startColumn'],this;}['removeSparkline'](){const _0x4cc85c=_0x3b3394,_0x216c61=this['_injector'][_0x4cc85c(0x210)](c['ICommandService']),_0x5b87a2={'isSingle':!0x0,'ranges':[{'startRow':this[_0x4cc85c(0x1d8)],'startColumn':this[_0x4cc85c(0x1db)],'endRow':this[_0x4cc85c(0x1d8)],'endColumn':this[_0x4cc85c(0x1db)]}]};_0x216c61[_0x4cc85c(0x21b)](s['RemoveSheetSparklineCommand']['id'],_0x5b87a2);}},exports[_0x3b3394(0x1fa)]=R([B(0x5,c['Inject'](c[_0x3b3394(0x1f0)]))],exports[_0x3b3394(0x1fa)]);function _0x42e4(){const _0x1581e5=['FUniver','_worksheet','Event','length','FEnum','SparklineTypeEnum','Sheet\x20create\x20canceled\x20by\x20facade\x20api.','getSheetId','_commandService','_subUnitId','fireEvent','_unitId','startRow','FEventName','addSparkline','getAllSubSparkline','FWorksheet','createInstance','startColumn','Injector','SetSheetSparklineCommand','_injector','registerEventHandler','getId','onCommandExecuted','groupId','SparklineDataSourceModel','deepClone','getValue','FSparkline','256124jPsQKw','5vWbzZi','getActiveSheet','composeSparkline','changeDataSource','unComposeSparkline','group','toStringTag','50igyHmg','AddSheetSparklineCommand','_initialize','210686zFqorw','getSparkline','8785952haOZcK','_groupId','getSparklineById','Tools','setConfig','_workbook','removeSparklineGroup','4564815gdeYqT','get','SheetSparklineChanged','6EvDxdg','getCurrentSelections','Inject','extend','params','executeCommand','range','defineProperty','add','syncExecuteCommand','getOwnPropertyDescriptor','item','ranges','SheetsSelectionsService','isChangeDataSource','6479217cgUphl','cancel','FSparklineGroup','Module','8616888VLHSAs','252244PJPclw','RemoveSheetSparklineCommand','map','ICommandService','getActiveWorkbook','_row','matrix','getUnitId','_col','getSparklineCache'];_0x42e4=function(){return _0x1581e5;};return _0x42e4();}var P=Object[_0x3b3394(0x21c)],G=(_0x7cfc9,_0x43a1d3,_0x5ec9c6,_0x195e6f)=>{const _0x1ab253=_0x3b3394;for(var _0xa50bb4=_0x195e6f>0x1?void 0x0:_0x195e6f?P(_0x43a1d3,_0x5ec9c6):_0x43a1d3,_0x40015a=_0x7cfc9[_0x1ab253(0x1e0)]-0x1,_0x1e2b8d;_0x40015a>=0x0;_0x40015a--)(_0x1e2b8d=_0x7cfc9[_0x40015a])&&(_0xa50bb4=_0x1e2b8d(_0xa50bb4)||_0xa50bb4);return _0xa50bb4;},O=(_0x16e83e,_0x176b9e)=>(_0x51b213,_0x3e1ca3)=>_0x176b9e(_0x51b213,_0x3e1ca3,_0x16e83e);function _0x4242(_0x1ba4a3,_0x23e463){const _0x42e424=_0x42e4();return _0x4242=function(_0x424294,_0x78aebc){_0x424294=_0x424294-0x1cb;let _0x40a1be=_0x42e424[_0x424294];return _0x40a1be;},_0x4242(_0x1ba4a3,_0x23e463);}exports['FSparklineGroup']=class{constructor(_0x324b43,_0x56cd10,_0x46ea4c,_0x115edc,_0x1955c9,_0x53cfb2){const _0x39ab44=_0x3b3394;this[_0x39ab44(0x1e8)]=_0x324b43,this[_0x39ab44(0x1e6)]=_0x56cd10,this[_0x39ab44(0x209)]=_0x46ea4c,this[_0x39ab44(0x1d8)]=_0x115edc,this[_0x39ab44(0x1db)]=_0x1955c9,this[_0x39ab44(0x1f2)]=_0x53cfb2;}[_0x3b3394(0x1ff)](_0x79cb6b,_0x3e7ac2){const _0x2d544f=_0x3b3394,_0x17f1b3=this[_0x2d544f(0x1f2)][_0x2d544f(0x210)](s[_0x2d544f(0x1f7)]),_0x198f57=this[_0x2d544f(0x1f2)][_0x2d544f(0x210)](c[_0x2d544f(0x1d6)]),_0x459c26=_0x17f1b3[_0x2d544f(0x20a)](this[_0x2d544f(0x1e8)],this['_subUnitId'],this[_0x2d544f(0x209)]);if(!_0x459c26)return;const _0x52348c={'config':_0x459c26,'isChangeDataSource':!0x0,'changeDataSourceInfo':{'groupId':this['_groupId'],'resetType':_0x2d544f(0x201),'sourceRanges':_0x79cb6b,'targetRanges':_0x3e7ac2,'primary':{'startRow':this[_0x2d544f(0x1d8)],'startColumn':this['_col'],'endRow':this[_0x2d544f(0x1d8)],'endColumn':this[_0x2d544f(0x1db)],'actualRow':this[_0x2d544f(0x1d8)],'actualColumn':this[_0x2d544f(0x1db)],'isMerged':!0x1,'isMergedMainCell':!0x1}}};return _0x198f57[_0x2d544f(0x21b)](s[_0x2d544f(0x1f1)]['id'],_0x52348c),this[_0x2d544f(0x1d8)]=_0x3e7ac2[0x0][_0x2d544f(0x1e9)],this[_0x2d544f(0x1db)]=_0x3e7ac2[0x0][_0x2d544f(0x1ef)],this;}[_0x3b3394(0x20e)](){const _0x504f84=_0x3b3394,_0x25c3ee=this[_0x504f84(0x1f2)][_0x504f84(0x210)](c[_0x504f84(0x1d6)]),_0x301a65={'isSingle':!0x1,'ranges':[{'startRow':this[_0x504f84(0x1d8)],'startColumn':this[_0x504f84(0x1db)],'endRow':this[_0x504f84(0x1d8)],'endColumn':this[_0x504f84(0x1db)]}]};_0x25c3ee['syncExecuteCommand'](s[_0x504f84(0x1d4)]['id'],_0x301a65);}[_0x3b3394(0x20c)](_0x3b4d91){const _0x110890=_0x3b3394,_0x4625cf=this['_injector'][_0x110890(0x210)](s[_0x110890(0x1f7)])[_0x110890(0x20a)](this[_0x110890(0x1e8)],this[_0x110890(0x1e6)],this[_0x110890(0x209)]);if(_0x4625cf){const _0x2aa6c5={'config':{'config':_0x3b4d91,'sparklines':_0x4625cf['sparklines']},'isChangeDataSource':!0x1};this[_0x110890(0x1f2)]['get'](c['ICommandService'])[_0x110890(0x21b)](s['SetSheetSparklineCommand']['id'],_0x2aa6c5);}return this;}},exports[_0x3b3394(0x1d0)]=G([O(0x5,c[_0x3b3394(0x214)](c[_0x3b3394(0x1f0)]))],exports['FSparklineGroup']);class T extends M[_0x3b3394(0x1ed)]{[_0x3b3394(0x1eb)](_0x178b32,_0x3cf62e,_0x1f2dc9){const _0x31da28=_0x3b3394;if(this['_commandService'][_0x31da28(0x21b)](s[_0x31da28(0x204)]['id'],{'sourceRanges':_0x178b32,'targetRanges':_0x3cf62e,'targetInfo':{'unitId':this[_0x31da28(0x20d)][_0x31da28(0x1da)](),'subUnitId':this[_0x31da28(0x1de)][_0x31da28(0x1e4)]()},'config':{'type':_0x1f2dc9}})){const {startRow:_0xf2e9e1,startColumn:_0x163a10}=_0x3cf62e[0x0];return this['getSparklineByCell'](_0xf2e9e1,_0x163a10);}}[_0x3b3394(0x1ec)](){const _0x49e3a0=_0x3b3394;return this[_0x49e3a0(0x1f2)][_0x49e3a0(0x210)](s[_0x49e3a0(0x1f7)])['getSubUnitSparkline'](this['_workbook']['getUnitId'](),this[_0x49e3a0(0x1de)][_0x49e3a0(0x1e4)]());}[_0x3b3394(0x1fe)](_0x2f07f5){const _0x5594d3=_0x3b3394,_0x17b8aa=this[_0x5594d3(0x1f2)]['get'](s['SparklineDataSourceModel']);let _0x464e89;for(let _0x369650=0x0;_0x369650<_0x2f07f5[_0x5594d3(0x1e0)];_0x369650++){const _0x236cb8=_0x2f07f5[_0x369650],{startRow:_0x282365,endRow:_0x21a4b0,startColumn:_0x281c80,endColumn:_0xb36487}=_0x236cb8;for(let _0x154c80=_0x282365;_0x154c80<=_0x21a4b0;_0x154c80++)for(let _0x2187ef=_0x281c80;_0x2187ef<=_0xb36487;_0x2187ef++){const _0x6577fe=_0x17b8aa[_0x5594d3(0x207)](this['_workbook']['getUnitId'](),this['_worksheet'][_0x5594d3(0x1e4)](),_0x154c80,_0x2187ef);if(_0x6577fe){const _0x115c07=_0x17b8aa['getSparklineById'](this[_0x5594d3(0x20d)][_0x5594d3(0x1da)](),this[_0x5594d3(0x1de)][_0x5594d3(0x1e4)](),_0x6577fe);if(_0x115c07){_0x464e89=c[_0x5594d3(0x20b)][_0x5594d3(0x1f8)](_0x115c07);break;}}}}_0x464e89&&this[_0x5594d3(0x1e5)][_0x5594d3(0x217)](s[_0x5594d3(0x1f1)]['id'],{'ranges':_0x2f07f5,'combine':!0x0,'config':_0x464e89,'isChangeDataSource':!0x1});}[_0x3b3394(0x200)](_0x4f5b0b){const _0x2a9254=_0x3b3394,_0x37be69=this['_injector'][_0x2a9254(0x210)](s['SparklineDataSourceModel']);let _0x128cdd;for(let _0x5dc6af=0x0;_0x5dc6af<_0x4f5b0b['length'];_0x5dc6af++){const _0x3ac2aa=_0x4f5b0b[_0x5dc6af],{startRow:_0x414107,endRow:_0x54bc5c,startColumn:_0x15a9c3,endColumn:_0x55189f}=_0x3ac2aa;for(let _0x326b28=_0x414107;_0x326b28<=_0x54bc5c;_0x326b28++)for(let _0x3f0f18=_0x15a9c3;_0x3f0f18<=_0x55189f;_0x3f0f18++){const _0x3161b4=_0x37be69[_0x2a9254(0x207)](this['_workbook'][_0x2a9254(0x1da)](),this[_0x2a9254(0x1de)]['getSheetId'](),_0x326b28,_0x3f0f18);if(_0x3161b4){const _0x608a18=_0x37be69['getSparklineById'](this[_0x2a9254(0x20d)][_0x2a9254(0x1da)](),this[_0x2a9254(0x1de)][_0x2a9254(0x1e4)](),_0x3161b4);if(_0x608a18){_0x128cdd=c[_0x2a9254(0x20b)]['deepClone'](_0x608a18);break;}}}}_0x128cdd||this[_0x2a9254(0x1e5)][_0x2a9254(0x217)](s[_0x2a9254(0x1f1)]['id'],{'ranges':_0x4f5b0b,'unCombine':!0x0,'config':_0x128cdd,'isChangeDataSource':!0x1});}['getSparklineByCell'](_0x1eb70b,_0xd86e94){const _0x1dc949=_0x3b3394,_0x2ffab5=this[_0x1dc949(0x1f2)]['get'](s[_0x1dc949(0x1f7)]),_0x5155ef=this[_0x1dc949(0x20d)]['getUnitId'](),_0x144d61=this[_0x1dc949(0x1de)][_0x1dc949(0x1e4)](),_0x4eb380=_0x2ffab5[_0x1dc949(0x207)](_0x5155ef,_0x144d61,_0x1eb70b,_0xd86e94);if(_0x4eb380)return this['_injector'][_0x1dc949(0x1ee)](exports[_0x1dc949(0x1fa)],_0x5155ef,_0x144d61,_0x4eb380,_0x1eb70b,_0xd86e94);}['getSparklineGroupByCell'](_0x5e9f1a,_0x2f6e49){const _0x425b34=_0x3b3394,_0x2b5f21=this[_0x425b34(0x1f2)]['get'](s[_0x425b34(0x1f7)]),_0x34721e=this[_0x425b34(0x20d)][_0x425b34(0x1da)](),_0x53f350=this[_0x425b34(0x1de)]['getSheetId'](),_0x153382=_0x2b5f21[_0x425b34(0x207)](_0x34721e,_0x53f350,_0x5e9f1a,_0x2f6e49);if(_0x153382)return this[_0x425b34(0x1f2)][_0x425b34(0x1ee)](exports['FSparklineGroup'],_0x34721e,_0x53f350,_0x153382,_0x5e9f1a,_0x2f6e49);}}M['FWorksheet'][_0x3b3394(0x215)](T);class A extends k[_0x3b3394(0x1e1)]{get[_0x3b3394(0x1e2)](){const _0x95b47a=_0x3b3394;return s[_0x95b47a(0x1e2)];}}k[_0x3b3394(0x1e1)][_0x3b3394(0x215)](A);class q extends k[_0x3b3394(0x1ea)]{get[_0x3b3394(0x211)](){return'SheetSparklineChanged';}}k[_0x3b3394(0x1ea)][_0x3b3394(0x215)](q);class W extends k[_0x3b3394(0x1dd)]{[_0x3b3394(0x205)](_0x5f3645){const _0xa580a5=_0x3b3394,_0x1deb20=_0x5f3645[_0xa580a5(0x210)](c['ICommandService']);this[_0xa580a5(0x1f3)](this[_0xa580a5(0x1df)][_0xa580a5(0x211)],()=>_0x1deb20[_0xa580a5(0x1f5)](_0x3d5090=>{const _0x558387=_0xa580a5;var _0x8b8050,_0x410f69;if(_0x3d5090['id']===s[_0x558387(0x1f1)]['id']){const _0x5959a0=_0x3d5090[_0x558387(0x216)];if(!_0x5959a0[_0x558387(0x1cd)]){const _0x55daf1=this[_0x558387(0x1d7)](),_0x2bfb8a=_0x55daf1==null?void 0x0:_0x55daf1[_0x558387(0x1fd)]();if(!_0x55daf1||!_0x2bfb8a)return;const _0x1ff678=_0x55daf1[_0x558387(0x1f4)](),_0x323076=_0x2bfb8a[_0x558387(0x1e4)](),_0x35c544=this[_0x558387(0x1f2)][_0x558387(0x210)](U[_0x558387(0x1cc)]),_0x5a3465=this[_0x558387(0x1f2)][_0x558387(0x210)](s[_0x558387(0x1f7)]),_0x1abd08=(_0x8b8050=_0x5959a0==null?void 0x0:_0x5959a0[_0x558387(0x1cb)])!=null?_0x8b8050:_0x35c544[_0x558387(0x213)]()[_0x558387(0x1d5)](_0x597988=>_0x597988[_0x558387(0x218)]),_0xcc0909=(_0x410f69=_0x5a3465[_0x558387(0x1dc)]()['sparklineAnchorMap'][_0x558387(0x210)](_0x1ff678))==null?void 0x0:_0x410f69[_0x558387(0x210)](_0x323076),_0x2967d8=new Set();_0x1abd08['forEach'](_0x231c3b=>{const _0x175de4=_0x558387;var _0x51ffde;const {startRow:_0x447bb6,endRow:_0x122173,startColumn:_0xcd857d,endColumn:_0x4e4081}=_0x231c3b;for(let _0x57d4c2=_0x447bb6;_0x57d4c2<=_0x122173;_0x57d4c2++)for(let _0x494198=_0xcd857d;_0x494198<=_0x4e4081;_0x494198++){const _0x16ab94=(_0x51ffde=_0xcc0909==null?void 0x0:_0xcc0909[_0x175de4(0x1d9)][_0x175de4(0x1f9)](_0x57d4c2,_0x494198))==null?void 0x0:_0x51ffde[_0x175de4(0x1f6)];_0x16ab94&&_0x2967d8[_0x175de4(0x21a)](_0x16ab94);}});const _0x10d06e=Array['from'](_0x2967d8)[_0x558387(0x1d5)](_0x5538d2=>_0x5a3465[_0x558387(0x20a)](_0x1ff678,_0x323076,_0x5538d2))['filter'](_0x1f875d=>!!_0x1f875d),_0x2d37ee={'workbook':_0x55daf1,'worksheet':_0x2bfb8a,'sparklines':_0x10d06e};if(this[_0x558387(0x1e7)](this[_0x558387(0x1df)][_0x558387(0x211)],_0x2d37ee),_0x2d37ee[_0x558387(0x1cf)])throw new Error(_0x558387(0x1e3));}}}));}}k[_0x3b3394(0x1dd)][_0x3b3394(0x215)](W);