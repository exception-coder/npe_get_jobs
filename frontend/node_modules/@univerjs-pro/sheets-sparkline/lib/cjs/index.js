'use strict';const _0x5c26e4=_0x4190;(function(_0x73385f,_0x583eb2){const _0x729340=_0x4190,_0x1360d4=_0x73385f();while(!![]){try{const _0x282d5c=parseInt(_0x729340(0x196))/0x1*(parseInt(_0x729340(0x1c4))/0x2)+parseInt(_0x729340(0x109))/0x3+-parseInt(_0x729340(0x118))/0x4+parseInt(_0x729340(0x191))/0x5*(parseInt(_0x729340(0x151))/0x6)+-parseInt(_0x729340(0x1db))/0x7+-parseInt(_0x729340(0x11d))/0x8+parseInt(_0x729340(0x188))/0x9;if(_0x282d5c===_0x583eb2)break;else _0x1360d4['push'](_0x1360d4['shift']());}catch(_0x223fa4){_0x1360d4['push'](_0x1360d4['shift']());}}}(_0x3e88,0x42560));function _0x4190(_0x184eaf,_0x5f3453){const _0x3e888f=_0x3e88();return _0x4190=function(_0x4190e6,_0xceec86){_0x4190e6=_0x4190e6-0xf4;let _0x4e5d0a=_0x3e888f[_0x4190e6];return _0x4e5d0a;},_0x4190(_0x184eaf,_0x5f3453);}var xe=Object[_0x5c26e4(0x162)],Ne=(_0x13b9ea,_0x509adb,_0x1d757c)=>_0x509adb in _0x13b9ea?xe(_0x13b9ea,_0x509adb,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0x1d757c}):_0x13b9ea[_0x509adb]=_0x1d757c,J=(_0x172984,_0x530006,_0x20e752)=>Ne(_0x172984,typeof _0x530006!=_0x5c26e4(0x121)?_0x530006+'':_0x530006,_0x20e752);Object[_0x5c26e4(0x162)](exports,Symbol['toStringTag'],{'value':'Module'});const l=require('@univerjs/core'),_=require('@univerjs/sheets'),Ue=require('rxjs'),je=require('@univerjs-pro/license');function he(_0x3571be,_0x1b9879){const _0x56900b=_0x5c26e4,_0x42e0c1=new l[(_0x56900b(0x147))](),_0x308779=[],_0xacf276=_0x3571be[_0x56900b(0x152)]>0x1;let _0x232606=0x0,_0x142e00=0x0;for(const _0x34651b of _0x3571be)_0x232606+=_0x34651b['endRow']-_0x34651b[_0x56900b(0x172)]+0x1,_0x142e00+=_0x34651b[_0x56900b(0x185)]-_0x34651b[_0x56900b(0x101)]+0x1;for(const _0x1574c7 of _0x1b9879)for(let _0xfeed1d=_0x1574c7[_0x56900b(0x172)];_0xfeed1d<=_0x1574c7[_0x56900b(0x11f)];_0xfeed1d++)for(let _0x9b8761=_0x1574c7[_0x56900b(0x101)];_0x9b8761<=_0x1574c7[_0x56900b(0x185)];_0x9b8761++)_0x308779['push']({'row':_0xfeed1d,'column':_0x9b8761});if(_0x308779[_0x56900b(0x152)]===_0x232606)_0xacf276?_0x308779[_0x56900b(0x1b0)]((_0x3ed002,_0x39e9a0)=>{const _0x2bd29a=_0x56900b,_0x160063=_0x3571be[_0x39e9a0],_0x52b29c={'startRow':_0x160063[_0x2bd29a(0x172)],'startColumn':_0x160063[_0x2bd29a(0x101)],'endRow':_0x160063[_0x2bd29a(0x172)],'endColumn':_0x160063[_0x2bd29a(0x185)]};_0x42e0c1[_0x2bd29a(0x1be)](_0x3ed002[_0x2bd29a(0x168)],_0x3ed002[_0x2bd29a(0x1d6)],_0x52b29c);}):_0x308779[_0x56900b(0x1b0)]((_0x4fc70b,_0x25119b)=>{const _0x28652b=_0x56900b,_0x2885eb=_0x3571be[0x0],_0x2879c1={'startRow':_0x2885eb['startRow']+_0x25119b,'startColumn':_0x2885eb[_0x28652b(0x101)],'endRow':_0x2885eb[_0x28652b(0x172)]+_0x25119b,'endColumn':_0x2885eb[_0x28652b(0x185)]};_0x42e0c1['setValue'](_0x4fc70b[_0x28652b(0x168)],_0x4fc70b['column'],_0x2879c1);});else{if(_0x308779[_0x56900b(0x152)]===_0x142e00)_0xacf276?_0x308779[_0x56900b(0x1b0)]((_0x16855e,_0x19bde8)=>{const _0x42dbed=_0x56900b,_0xd7f814=_0x3571be[_0x19bde8],_0x39afc4={'startRow':_0xd7f814[_0x42dbed(0x172)],'startColumn':_0xd7f814[_0x42dbed(0x101)],'endRow':_0xd7f814[_0x42dbed(0x11f)],'endColumn':_0xd7f814[_0x42dbed(0x101)]};_0x42e0c1[_0x42dbed(0x1be)](_0x16855e['row'],_0x16855e[_0x42dbed(0x1d6)],_0x39afc4);}):_0x308779['forEach']((_0x3d150f,_0x17f603)=>{const _0x151203=_0x56900b,_0xfef6c3=_0x3571be[0x0],_0x42a6bf={'startRow':_0xfef6c3['startRow'],'startColumn':_0xfef6c3[_0x151203(0x101)]+_0x17f603,'endRow':_0xfef6c3[_0x151203(0x11f)],'endColumn':_0xfef6c3[_0x151203(0x101)]+_0x17f603};_0x42e0c1[_0x151203(0x1be)](_0x3d150f['row'],_0x3d150f[_0x151203(0x1d6)],_0x42a6bf);});else{if(_0x308779[_0x56900b(0x152)]===_0x3571be['length'])_0x3571be[_0x56900b(0x15d)](_0x4a297c=>!(_0x4a297c[_0x56900b(0x172)]!==_0x4a297c['endRow']&&_0x4a297c[_0x56900b(0x101)]!==_0x4a297c[_0x56900b(0x185)]))&&_0x308779[_0x56900b(0x1b0)]((_0x476ca1,_0x1dfea1)=>{const _0x20332d=_0x56900b,_0x351ff5=_0x3571be[_0x1dfea1];_0x42e0c1[_0x20332d(0x1be)](_0x476ca1[_0x20332d(0x168)],_0x476ca1['column'],_0x351ff5);});else throw new Error('Mismatch\x20between\x20the\x20number\x20of\x20target\x20cells\x20and\x20the\x20source\x20range\x20dimensions.');}}return _0x42e0c1;}const ke='SHEET_SPARKLINE_PLUGIN',Se={'standard':[_0x5c26e4(0xf9),_0x5c26e4(0x1bb)],'specialty':['rgb(49,106,246)',_0x5c26e4(0x137)],'distinctive':[_0x5c26e4(0x138),_0x5c26e4(0x1c3)],'soft':['rgb(80,102,248)',_0x5c26e4(0x13e)],'fresh':[_0x5c26e4(0x1b3),'rgb(248,190,21)']},Pe=['highPoint',_0x5c26e4(0x12b),_0x5c26e4(0x15b),_0x5c26e4(0x164),'negativePoint','markersPoint'];var me=(_0x4a0a53=>(_0x4a0a53[_0x5c26e4(0x155)]='standard',_0x4a0a53[_0x5c26e4(0x197)]=_0x5c26e4(0x133),_0x4a0a53['DISTINCTIVE']=_0x5c26e4(0x148),_0x4a0a53['SOFT']=_0x5c26e4(0x1de),_0x4a0a53[_0x5c26e4(0x1af)]=_0x5c26e4(0x122),_0x4a0a53['CUSTOM']='custom',_0x4a0a53))(me||{}),Ae=(_0x332776=>(_0x332776[_0x332776[_0x5c26e4(0x193)]=0x1]=_0x5c26e4(0x193),_0x332776[_0x332776['BAR_CHART']=0x2]=_0x5c26e4(0x127),_0x332776[_0x332776[_0x5c26e4(0x110)]=0x3]='PROFIT_AND_LOSS_CHART',_0x332776[_0x332776[_0x5c26e4(0x13a)]=0x4]='PIE_CHART',_0x332776))(Ae||{}),H=(_0x1c749f=>(_0x1c749f[_0x5c26e4(0x12a)]=_0x5c26e4(0x1a3),_0x1c749f['ZERO_VALUE']='zero_value',_0x1c749f[_0x5c26e4(0x1b8)]=_0x5c26e4(0x17e),_0x1c749f))(H||{}),re=(_0x35977b=>(_0x35977b[_0x35977b[_0x5c26e4(0xfc)]=0x1]=_0x5c26e4(0xfc),_0x35977b[_0x35977b[_0x5c26e4(0x177)]=0x2]=_0x5c26e4(0x177),_0x35977b[_0x35977b[_0x5c26e4(0x1e0)]=0x3]=_0x5c26e4(0x1e0),_0x35977b))(re||{}),Ge=Object['getOwnPropertyDescriptor'],$e=(_0x169658,_0x219c6c,_0x3b0bb9,_0x1befbf)=>{const _0x1e57f3=_0x5c26e4;for(var _0x51ff4a=_0x1befbf>0x1?void 0x0:_0x1befbf?Ge(_0x219c6c,_0x3b0bb9):_0x219c6c,_0x1d80e5=_0x169658[_0x1e57f3(0x152)]-0x1,_0x45fe37;_0x1d80e5>=0x0;_0x1d80e5--)(_0x45fe37=_0x169658[_0x1d80e5])&&(_0x51ff4a=_0x45fe37(_0x51ff4a)||_0x51ff4a);return _0x51ff4a;},Le=(_0x13aa7f,_0x136c92)=>(_0xaf5d58,_0x373efb)=>_0x136c92(_0xaf5d58,_0x373efb,_0x13aa7f);exports[_0x5c26e4(0x11c)]=class extends l['Disposable']{constructor(_0x210c56){const _0xeda7fb=_0x5c26e4;super(),J(this,'_sparklineModel',new Map()),J(this,_0xeda7fb(0x12c),new Map()),J(this,_0xeda7fb(0x14a),new Ue[(_0xeda7fb(0x1ae))]()),J(this,_0xeda7fb(0x10c),this[_0xeda7fb(0x14a)]['asObservable']()),this[_0xeda7fb(0x1a6)]=_0x210c56;}[_0x5c26e4(0x174)](_0x1252da,_0x4f867c){const _0x9c134c=_0x5c26e4;let _0x3ec254=this[_0x9c134c(0x1b1)][_0x9c134c(0x1e2)](_0x1252da);_0x3ec254||(_0x3ec254=new Map(),this[_0x9c134c(0x1b1)][_0x9c134c(0x107)](_0x1252da,_0x3ec254));let _0x529cda=_0x3ec254[_0x9c134c(0x1e2)](_0x4f867c);return _0x529cda||(_0x529cda=new Map(),_0x3ec254[_0x9c134c(0x107)](_0x4f867c,_0x529cda)),_0x529cda;}[_0x5c26e4(0x13f)](_0x54c1d6,_0x20897b){const _0x6967af=_0x5c26e4;let _0x4fa527=this['_sparklineAnchorMap']['get'](_0x54c1d6);_0x4fa527||(_0x4fa527=new Map(),this['_sparklineAnchorMap']['set'](_0x54c1d6,_0x4fa527));let _0xa82279=_0x4fa527[_0x6967af(0x1e2)](_0x20897b);return _0xa82279||(_0xa82279={'matrix':new l['ObjectMatrix'](),'extra':{}},_0x4fa527[_0x6967af(0x107)](_0x20897b,_0xa82279)),_0xa82279;}[_0x5c26e4(0x19b)](_0x39830e,_0x2c7f99,_0x5085d,_0x121f86='set'){const _0x3c83a7=_0x5c26e4;var _0x4b25b2,_0x50643f,_0x64d24b,_0x5d68df,_0x25a960,_0xcf295,_0x30c3bf,_0x4d5fca,_0x5e4285,_0x481786,_0x4507cf,_0xf327a,_0x507630;const _0x46ebca=(_0x50643f=(_0x4b25b2=this[_0x3c83a7(0x1b1)][_0x3c83a7(0x1e2)](_0x39830e))==null?void 0x0:_0x4b25b2[_0x3c83a7(0x1e2)](_0x2c7f99))==null?void 0x0:_0x50643f[_0x3c83a7(0x1e2)](_0x5085d);if(!_0x46ebca)return;const _0x3a68ce=_[_0x3c83a7(0x15e)](this[_0x3c83a7(0x1a6)],{'unitId':_0x39830e,'subUnitId':_0x2c7f99});if(!_0x3a68ce)return;const _0x35fbb1=this[_0x3c83a7(0x13f)](_0x39830e,_0x2c7f99),{extra:_0x1d3005,matrix:_0x50b96e}=_0x35fbb1,{worksheet:_0x5a396e}=_0x3a68ce;let _0x1da764=Number[_0x3c83a7(0x1aa)],_0x3fac87=Number['MAX_SAFE_INTEGER'];const _0x5d0994=(_0x64d24b=_0x46ebca[_0x3c83a7(0x1e5)][_0x3c83a7(0x156)])!=null?_0x64d24b:!0x1;_0x46ebca[_0x3c83a7(0x167)][_0x3c83a7(0x175)]((_0x125765,_0x782aea,_0x44fdad)=>{const _0x5c4c01=_0x3c83a7;var _0x4d158e,_0x209c12,_0x4daa57;const _0x80e2a5=_0x44fdad;let _0x39f4a7=Number[_0x5c4c01(0x1aa)],_0x160780=Number[_0x5c4c01(0x144)],_0x2cc370=0x0,_0x277b0f=0x0;const _0x5dfff5=[];if(!l['isValidRange'](_0x80e2a5))_0x50b96e[_0x5c4c01(0x1be)](_0x125765,_0x782aea,{'groupId':_0x5085d,'data':[],'max':_0x39f4a7,'min':_0x160780,'highIndex':_0x2cc370,'lowIndex':_0x277b0f,'negativeIndexes':_0x5dfff5});else{const _0x300095=[];for(let _0x5c3167=_0x80e2a5['startRow'];_0x5c3167<=_0x80e2a5[_0x5c4c01(0x11f)];_0x5c3167++){for(let _0x105272=_0x80e2a5[_0x5c4c01(0x101)];_0x105272<=_0x80e2a5['endColumn'];_0x105272++){const _0x212635=_0x5a396e[_0x5c4c01(0x1b7)](_0x5c3167),_0x3b32c1=_0x5a396e['getColVisible'](_0x105272);if(!_0x5d0994&&(!_0x212635||!_0x3b32c1))continue;let _0x394df6=0x0;const _0x30fbef=((_0x4d158e=_0x5a396e[_0x5c4c01(0x130)](_0x5c3167,_0x105272))==null?void 0x0:_0x4d158e['v'])!==void 0x0?_0x5a396e['getCellRaw'](_0x5c3167,_0x105272):_0x5a396e[_0x5c4c01(0x190)](_0x5c3167,_0x105272);if(!_0x30fbef||_0x30fbef['v']===void 0x0||_0x30fbef['v']===null){const _0x35d87a=(_0x209c12=_0x46ebca[_0x5c4c01(0x1e5)][_0x5c4c01(0x19f)])!=null?_0x209c12:H[_0x5c4c01(0x12a)];_0x35d87a===H[_0x5c4c01(0x1d5)]?_0x394df6=0x0:_0x35d87a===H[_0x5c4c01(0x12a)]?_0x394df6=_0x5c4c01(0x150):_0x35d87a===H['CONNECT_WITH_LINE']&&(_0x394df6=_0x5c4c01(0x166));}else{if(_0x30fbef['t']===l['CellValueType'][_0x5c4c01(0x161)]||_0x30fbef['t']===l['CellValueType'][_0x5c4c01(0x1e3)]){const _0x3a185a=(_0x4daa57=_0x46ebca[_0x5c4c01(0x1e5)][_0x5c4c01(0x170)])!=null?_0x4daa57:H['SPACING'];_0x3a185a===H[_0x5c4c01(0x1d5)]?_0x394df6=0x0:_0x3a185a===H[_0x5c4c01(0x12a)]?_0x394df6='u-spacing':_0x3a185a===H[_0x5c4c01(0x1b8)]&&(_0x394df6=_0x5c4c01(0x166));}else _0x30fbef['t']===l[_0x5c4c01(0x1d8)][_0x5c4c01(0x12d)]?_0x394df6=_0x30fbef['v']?0x1:0x0:_0x30fbef['t']===l[_0x5c4c01(0x1d8)][_0x5c4c01(0x176)]?_0x394df6=Number(_0x30fbef['v']):_0x394df6=_0x30fbef['v'];}if(_0x300095['push'](_0x394df6),typeof _0x394df6==_0x5c4c01(0x184)){_0x39f4a7=Math['max'](_0x39f4a7,_0x394df6),_0x1da764=Math[_0x5c4c01(0x1df)](_0x1da764,_0x394df6),_0x3fac87=Math[_0x5c4c01(0x143)](_0x3fac87,_0x394df6),_0x160780=Math[_0x5c4c01(0x143)](_0x160780,_0x394df6);const _0x586db8=typeof _0x300095[_0x2cc370]==_0x5c4c01(0x184)?Number(_0x300095[_0x2cc370]):Number[_0x5c4c01(0x1aa)];_0x394df6>_0x586db8&&(_0x2cc370=_0x300095[_0x5c4c01(0x152)]-0x1);const _0x527575=typeof _0x300095[_0x277b0f]==_0x5c4c01(0x184)?Number(_0x300095[_0x277b0f]):Number[_0x5c4c01(0x144)];_0x394df6<_0x527575&&(_0x277b0f=_0x300095[_0x5c4c01(0x152)]-0x1),_0x394df6<0x0&&_0x5dfff5[_0x5c4c01(0x14f)](_0x300095[_0x5c4c01(0x152)]-0x1);}}_0x50b96e['setValue'](_0x125765,_0x782aea,{'groupId':_0x5085d,'data':_0x300095,'max':_0x39f4a7,'min':_0x160780,'highIndex':_0x2cc370,'lowIndex':_0x277b0f,'negativeIndexes':_0x5dfff5});}}});let _0x2af653=_0x1da764;((_0x5d68df=_0x46ebca[_0x3c83a7(0x1e5)][_0x3c83a7(0x140)])==null?void 0x0:_0x5d68df[_0x3c83a7(0x15f)])===re[_0x3c83a7(0x1e0)]&&(_0x2af653=(_0xcf295=(_0x25a960=_0x46ebca[_0x3c83a7(0x1e5)]['extremumMax'])==null?void 0x0:_0x25a960[_0x3c83a7(0x136)])!=null?_0xcf295:_0x1da764);let _0x39d175=_0x3fac87;((_0x30c3bf=_0x46ebca[_0x3c83a7(0x1e5)][_0x3c83a7(0x111)])==null?void 0x0:_0x30c3bf['type'])===re[_0x3c83a7(0x1e0)]&&(_0x39d175=(_0x5e4285=(_0x4d5fca=_0x46ebca[_0x3c83a7(0x1e5)][_0x3c83a7(0x111)])==null?void 0x0:_0x4d5fca[_0x3c83a7(0x136)])!=null?_0x5e4285:_0x3fac87);const _0x3c8239=(_0x481786=_0x46ebca[_0x3c83a7(0x1e5)][_0x3c83a7(0x1bf)])!=null?_0x481786:me['STANDARD'],_0x50326c=(_0x507630=(_0xf327a=_0x46ebca[_0x3c83a7(0x1e5)]['seriesColor'])!=null?_0xf327a:(_0x4507cf=Se[_0x3c8239])==null?void 0x0:_0x4507cf[0x0])!=null?_0x507630:Se[_0x3c83a7(0x112)][0x0],_0x961d6b=new l[(_0x3c83a7(0x115))](_0x50326c),_0x72b42c=_0x961d6b[_0x3c83a7(0x1c7)](0.2)[_0x3c83a7(0x1a8)](),_0x9f28ee=_0x961d6b['setAlpha'](0.05)[_0x3c83a7(0x1a8)]();_0x1d3005[_0x5085d]={'groupMax':_0x1da764,'groupMin':_0x3fac87,'showMax':_0x2af653,'showMin':_0x39d175,'startGradient':_0x72b42c,'endGradient':_0x9f28ee},this[_0x3c83a7(0x14a)]['next']({'unitId':_0x39830e,'subUnitId':_0x2c7f99,'groupId':_0x5085d,'config':_0x46ebca,'type':_0x121f86});}[_0x5c26e4(0x17b)](_0x2351be,_0x36fb7c,_0x331ad0,_0x135e12){const _0x332dd6=_0x5c26e4;this[_0x332dd6(0x174)](_0x2351be,_0x36fb7c)[_0x332dd6(0x107)](_0x331ad0,_0x135e12),this['updateSparklineExtraNum'](_0x2351be,_0x36fb7c,_0x331ad0,'add');}[_0x5c26e4(0x1a0)](_0x373747,_0xc75571,_0x3914aa,_0x2fb42d){const _0x4c590e=_0x5c26e4;var _0x1a4834;const _0x4f5b9d=(_0x1a4834=this['_sparklineModel']['get'](_0x373747))==null?void 0x0:_0x1a4834[_0x4c590e(0x1e2)](_0xc75571);_0x3914aa[_0x4c590e(0x1b0)](_0x407c2c=>{const _0x2eda92=_0x4c590e;_0x4f5b9d!=null&&_0x4f5b9d[_0x2eda92(0x14d)](_0x407c2c)&&(_0x4f5b9d['set'](_0x407c2c,_0x2fb42d),this['updateSparklineExtraNum'](_0x373747,_0xc75571,_0x407c2c));});}[_0x5c26e4(0x181)](_0x443f04,_0x53ceab,_0x1e8b67){const _0x2f7259=_0x5c26e4;var _0x2e0db5,_0x4beaa1;const _0x150792=this['_sparklineModel'][_0x2f7259(0x1e2)](_0x443f04);if(_0x150792){const _0x13301e=_0x150792[_0x2f7259(0x1e2)](_0x53ceab);if(_0x13301e){_0x13301e[_0x2f7259(0x18c)](_0x1e8b67);const _0xd6b956=(_0x2e0db5=this[_0x2f7259(0x12c)][_0x2f7259(0x1e2)](_0x443f04))==null?void 0x0:_0x2e0db5['get'](_0x53ceab);(_0x4beaa1=_0xd6b956==null?void 0x0:_0xd6b956[_0x2f7259(0x1ba)])==null||_0x4beaa1['forValue']((_0x1142fe,_0x2c57ec,_0x4235fe)=>{const _0x4c1376=_0x2f7259;(_0x4235fe==null?void 0x0:_0x4235fe[_0x4c1376(0x1a5)])===_0x1e8b67&&(_0xd6b956==null||_0xd6b956['matrix'][_0x4c1376(0x1b2)](_0x1142fe,_0x2c57ec));}),this[_0x2f7259(0x14a)][_0x2f7259(0x124)]({'unitId':_0x443f04,'subUnitId':_0x53ceab,'groupId':_0x1e8b67,'type':_0x2f7259(0x1cb)});}}}['removePartSparkline'](_0x256704,_0x13a3f2,_0x44c02a,_0x456b43){const _0x3b250e=_0x5c26e4;var _0x56643c,_0x5268d4,_0x3ac4e9,_0x453d2c;const _0x3d60fc=(_0x56643c=this[_0x3b250e(0x12c)]['get'](_0x256704))==null?void 0x0:_0x56643c[_0x3b250e(0x1e2)](_0x13a3f2),_0x45f79e=_0x3d60fc==null?void 0x0:_0x3d60fc[_0x3b250e(0x1ba)]['getValue'](_0x44c02a,_0x456b43);if(_0x45f79e){const {groupId:_0x34c44c}=_0x45f79e,_0x426524=(_0x5268d4=this[_0x3b250e(0x1b1)][_0x3b250e(0x1e2)](_0x256704))==null?void 0x0:_0x5268d4['get'](_0x13a3f2);(_0x3ac4e9=_0x426524==null?void 0x0:_0x426524[_0x3b250e(0x1e2)](_0x34c44c))==null||_0x3ac4e9[_0x3b250e(0x167)]['realDeleteValue'](_0x44c02a,_0x456b43),(_0x453d2c=_0x426524==null?void 0x0:_0x426524[_0x3b250e(0x1e2)](_0x34c44c))!=null&&_0x453d2c[_0x3b250e(0x167)][_0x3b250e(0x116)]()||_0x426524==null||_0x426524[_0x3b250e(0x18c)](_0x34c44c),_0x3d60fc==null||_0x3d60fc[_0x3b250e(0x1ba)][_0x3b250e(0x1b2)](_0x44c02a,_0x456b43),this[_0x3b250e(0x14a)]['next']({'unitId':_0x256704,'subUnitId':_0x13a3f2,'groupId':_0x34c44c,'type':_0x3b250e(0x1cb)});}}[_0x5c26e4(0x1d3)](_0xf726c7,_0x5535f1,_0x32817e){const _0x5e9959=_0x5c26e4;var _0xab9056,_0x1b932b,_0x4490e4,_0x356230;const _0x3ef760=(_0x4490e4=(_0x1b932b=(_0xab9056=this[_0x5e9959(0x1b1)][_0x5e9959(0x1e2)](_0xf726c7))==null?void 0x0:_0xab9056[_0x5e9959(0x1e2)](_0x5535f1))==null?void 0x0:_0x1b932b[_0x5e9959(0x1e2)](_0x32817e))==null?void 0x0:_0x4490e4['sparklines'],_0x56717f=(_0x356230=this[_0x5e9959(0x12c)][_0x5e9959(0x1e2)](_0xf726c7))==null?void 0x0:_0x356230['get'](_0x5535f1);if(_0x3ef760&&_0x56717f){const {matrix:_0x3f3512,extra:_0xf07167}=_0x56717f;_0x3ef760['forValue']((_0x55d1db,_0x37482c,_0x56ff7a)=>{const _0x3bd6cd=_0x5e9959;_0x3f3512[_0x3bd6cd(0x1b2)](_0x55d1db,_0x37482c);}),delete _0xf07167[_0x32817e];}}[_0x5c26e4(0x1d1)](_0x26127f,_0x1beaa6){const _0x4a50ba=_0x5c26e4;var _0x513bf0;return(_0x513bf0=this[_0x4a50ba(0x1b1)][_0x4a50ba(0x1e2)](_0x26127f))==null?void 0x0:_0x513bf0['get'](_0x1beaa6);}[_0x5c26e4(0x16b)](_0xd881ee,_0x587286,_0x39cb47){const _0x1aff2e=_0x5c26e4;var _0x1a7bfd,_0x4c68f9;return(_0x4c68f9=(_0x1a7bfd=this[_0x1aff2e(0x1b1)][_0x1aff2e(0x1e2)](_0xd881ee))==null?void 0x0:_0x1a7bfd[_0x1aff2e(0x1e2)](_0x587286))==null?void 0x0:_0x4c68f9[_0x1aff2e(0x1e2)](_0x39cb47);}['getSparkline'](_0xd263e0,_0x2595f8,_0x1198b2,_0x25ca98){const _0x57f419=_0x5c26e4;var _0x48fdd7,_0x465a95,_0x32c589;return(_0x32c589=(_0x465a95=(_0x48fdd7=this[_0x57f419(0x12c)][_0x57f419(0x1e2)](_0xd263e0))==null?void 0x0:_0x48fdd7[_0x57f419(0x1e2)](_0x2595f8))==null?void 0x0:_0x465a95[_0x57f419(0x1ba)][_0x57f419(0x139)](_0x1198b2,_0x25ca98))==null?void 0x0:_0x32c589[_0x57f419(0x1a5)];}['reBuildAnchorCache'](_0x2e77c5,_0x19b960){const _0x40acf1=_0x5c26e4;var _0x522364;const _0x4975cb=this[_0x40acf1(0x13f)](_0x2e77c5,_0x19b960);_0x4975cb['matrix'][_0x40acf1(0x175)]((_0x516bf5,_0x438a79)=>{const _0x715615=_0x40acf1;_0x4975cb[_0x715615(0x1ba)]['realDeleteValue'](_0x516bf5,_0x438a79);});const _0x169c38=(_0x522364=this[_0x40acf1(0x1b1)][_0x40acf1(0x1e2)](_0x2e77c5))==null?void 0x0:_0x522364['get'](_0x19b960);if(_0x169c38){for(const [_0x502ec2]of _0x169c38)this[_0x40acf1(0x19b)](_0x2e77c5,_0x19b960,_0x502ec2);}}[_0x5c26e4(0x13b)](){const _0xef9fc1=_0x5c26e4;return{'sparklineModel':this[_0xef9fc1(0x1b1)],'sparklineAnchorMap':this[_0xef9fc1(0x12c)]};}[_0x5c26e4(0x1cf)](_0xe3a388){const _0x4f68a3=_0x5c26e4,_0x423f81={};if(this[_0x4f68a3(0x1b1)][_0x4f68a3(0x14d)](_0xe3a388)){_0x423f81[_0xe3a388]={};const _0x4e7fe5=this[_0x4f68a3(0x1b1)][_0x4f68a3(0x1e2)](_0xe3a388);_0x4e7fe5!=null&&_0x4e7fe5['size']&&Array[_0x4f68a3(0x1b4)](_0x4e7fe5['keys']())[_0x4f68a3(0x1b0)](_0x2eee55=>{const _0x25414b=_0x4f68a3;_0x423f81[_0xe3a388][_0x2eee55]={};const _0x18cb0a=_0x4e7fe5[_0x25414b(0x1e2)](_0x2eee55);_0x18cb0a!=null&&_0x18cb0a[_0x25414b(0x169)]&&Array[_0x25414b(0x1b4)](_0x18cb0a[_0x25414b(0x100)]())['forEach'](_0x32fb35=>{const _0x576e7a=_0x25414b,_0xd47d3e=_0x18cb0a[_0x576e7a(0x1e2)](_0x32fb35);_0xd47d3e&&(_0x423f81[_0xe3a388][_0x2eee55][_0x32fb35]={'config':_0xd47d3e[_0x576e7a(0x1e5)],'sparklines':_0xd47d3e['sparklines'][_0x576e7a(0x15a)]()});});});}return _0x423f81;}[_0x5c26e4(0x1dd)](_0x289a5b){const _0x3d5ab8=_0x5c26e4;if(!_0x289a5b)return;Object[_0x3d5ab8(0x100)](_0x289a5b)[_0x3d5ab8(0x1b0)](_0xdff19=>{const _0x409704=_0x3d5ab8,_0xb0b2b4=_0x289a5b[_0xdff19];_0xb0b2b4&&Object[_0x409704(0x100)](_0xb0b2b4)[_0x409704(0x1b0)](_0x10ebd2=>{const _0x3f4679=_0x409704,_0x504bdd=_0xb0b2b4[_0x10ebd2];_0x504bdd&&Object[_0x3f4679(0x100)](_0x504bdd)['forEach'](_0x4f35be=>{const _0xa0ad82=_0x3f4679,_0x544f65=_0x504bdd[_0x4f35be];if(_0x544f65){const _0x74612a={'config':_0x544f65[_0xa0ad82(0x1e5)],'sparklines':new l[(_0xa0ad82(0x147))](_0x544f65[_0xa0ad82(0x167)])};this['addSparkline'](_0xdff19,_0x10ebd2,_0x4f35be,_0x74612a);}});});});}[_0x5c26e4(0x17d)](_0x29e97a){const _0x1ba30e=_0x5c26e4,_0x460573=this[_0x1ba30e(0x1b1)][_0x1ba30e(0x1e2)](_0x29e97a);if(_0x460573){for(const [_0x5c2c86]of _0x460573){const _0x206de3=_0x460573[_0x1ba30e(0x1e2)](_0x5c2c86);if(_0x206de3){for(const [_0x57f61d]of _0x206de3)this[_0x1ba30e(0x1d3)](_0x29e97a,_0x5c2c86,_0x57f61d);}}this[_0x1ba30e(0x1b1)]['delete'](_0x29e97a);}}},exports[_0x5c26e4(0x11c)]=$e([Le(0x0,l[_0x5c26e4(0x13c)](l[_0x5c26e4(0xf4)]))],exports['SparklineDataSourceModel']);const O={'id':'sheet.mutation.add-sparkline','type':l[_0x5c26e4(0x16c)][_0x5c26e4(0x182)],'handler':(_0x3afb5a,_0x3cf15d)=>{const _0x130dca=_0x5c26e4;if(!_0x3cf15d)return!0x1;const {sparklineConfigMap:_0xd2c364,unitId:_0x6db1e8,subUnitId:_0x149b86}=_0x3cf15d,_0x48da9c=_0x3afb5a['get'](exports[_0x130dca(0x11c)]);return Object[_0x130dca(0x123)](_0xd2c364)[_0x130dca(0x1b0)](([_0x3e4972,_0x46a152])=>{const _0x28dab3=_0x130dca,_0x3844c6={'config':_0x46a152['config'],'sparklines':new l[(_0x28dab3(0x147))](_0x46a152['sparklines'])};_0x48da9c[_0x28dab3(0x17b)](_0x6db1e8,_0x149b86,_0x3e4972,_0x3844c6);}),!0x0;}},T={'id':_0x5c26e4(0x126),'type':l[_0x5c26e4(0x16c)][_0x5c26e4(0x182)],'handler':(_0x31ecc0,_0x595189)=>{const _0x444aa8=_0x5c26e4;if(!_0x595189)return!0x1;const {unitId:_0x1abd1b,subUnitId:_0x51add5,ranges:_0x873ea0,isSingle:_0x18c2c0,groupIds:_0x272594}=_0x595189,_0x2d7e6b=_0x31ecc0[_0x444aa8(0x1e2)](exports[_0x444aa8(0x11c)]);return _0x272594?(_0x272594['forEach'](_0x3516f2=>{const _0x54cc36=_0x444aa8;_0x2d7e6b[_0x54cc36(0x181)](_0x1abd1b,_0x51add5,_0x3516f2);}),!0x0):_0x873ea0?(_0x873ea0[_0x444aa8(0x1b0)](_0x44965e=>{const _0x3dd520=_0x444aa8;l[_0x3dd520(0x154)]['foreach'](_0x44965e,(_0x40bc41,_0x14b677)=>{const _0x11fef1=_0x3dd520,_0x51472d=_0x2d7e6b[_0x11fef1(0x135)](_0x1abd1b,_0x51add5,_0x40bc41,_0x14b677);_0x51472d&&(_0x18c2c0?_0x2d7e6b['removePartSparkline'](_0x1abd1b,_0x51add5,_0x40bc41,_0x14b677):_0x2d7e6b['removeSparkline'](_0x1abd1b,_0x51add5,_0x51472d));});}),!0x0):!0x1;}},be={'id':_0x5c26e4(0x195),'type':l[_0x5c26e4(0x16c)][_0x5c26e4(0x105)],'handler':(_0x6ba320,_0xa6df60)=>{const _0x5b658d=_0x5c26e4;if(!_0xa6df60)return!0x1;const {sourceRanges:_0xffb852,targetRanges:_0x5a5840,config:_0x57e795}=_0xa6df60,_0x5020ef=_0x6ba320[_0x5b658d(0x1e2)](l[_0x5b658d(0x1e1)]),_0xd5e1e2='g_'+l['generateRandomId'](0x6),_0x41f91a=he(_0xffb852,_0x5a5840),_0xb80f01={'config':_0x57e795!=null?_0x57e795:{},'sparklines':_0x41f91a[_0x5b658d(0x15a)]()},_0x33ac4c=_0x6ba320[_0x5b658d(0x1e2)](l['IUniverInstanceService']),_0x374601=_0x6ba320['get'](exports['SparklineDataSourceModel']),_0x5e2045=_['getSheetCommandTarget'](_0x33ac4c);if(!_0x5e2045)return!0x1;const {unitId:_0x268c37,subUnitId:_0x35f464}=_0x5e2045,_0x334eff=_0x6ba320['get'](l[_0x5b658d(0x117)]),_0x1ccb39=[],_0x20e376=[],_0x17daa6={},_0x357c74={},_0xf2feb=new Set([_0xd5e1e2]);_0x41f91a['forValue']((_0x1c6dc2,_0x415244,_0x3846bf)=>{const _0x576be7=_0x5b658d,_0x38037c=_0x374601[_0x576be7(0x135)](_0x268c37,_0x35f464,_0x1c6dc2,_0x415244);if(_0x38037c){const _0x59e28b=_0x374601[_0x576be7(0x16b)](_0x268c37,_0x35f464,_0x38037c);if(_0x59e28b){_0xf2feb[_0x576be7(0x1c1)](_0x38037c);let _0x5dce02=_0x17daa6[_0x38037c],_0x430b81=_0x357c74[_0x38037c];_0x430b81||(_0x430b81={'config':l[_0x576be7(0x149)][_0x576be7(0xfa)](_0x59e28b['config']),'sparklines':new l[(_0x576be7(0x147))](_0x59e28b[_0x576be7(0x167)][_0x576be7(0x165)]())},_0x357c74[_0x38037c]=_0x430b81),_0x5dce02||(_0x5dce02={'config':l[_0x576be7(0x149)]['deepClone'](_0x59e28b[_0x576be7(0x1e5)]),'sparklines':_0x59e28b[_0x576be7(0x167)]['clone']()},_0x17daa6[_0x38037c]=_0x5dce02),_0x430b81[_0x576be7(0x167)]['realDeleteValue'](_0x1c6dc2,_0x415244);}}});const _0x2ea393={};return Object[_0x5b658d(0x123)](_0x357c74)[_0x5b658d(0x1b0)](([_0x3ba8ee,_0x56cdd3])=>{const _0xfb5c9f=_0x5b658d;_0x56cdd3[_0xfb5c9f(0x167)][_0xfb5c9f(0x1a2)]()&&(_0x2ea393[_0x3ba8ee]={'config':_0x56cdd3['config'],'sparklines':_0x56cdd3[_0xfb5c9f(0x167)][_0xfb5c9f(0x165)]()});}),_0x2ea393[_0xd5e1e2]=_0xb80f01,_0x1ccb39[_0x5b658d(0x14f)]({'id':T['id'],'params':{'unitId':_0x268c37,'subUnitId':_0x35f464,'groupIds':Array['from'](_0xf2feb),'isSingle':!0x1}}),_0xf2feb[_0x5b658d(0x169)]>0x1&&(_0x20e376[_0x5b658d(0x14f)]({'id':T['id'],'params':{'unitId':_0x268c37,'subUnitId':_0x35f464,'groupIds':Array[_0x5b658d(0x1b4)](_0xf2feb),'isSingle':!0x1}}),_0x1ccb39[_0x5b658d(0x14f)]({'id':O['id'],'params':{'unitId':_0x268c37,'subUnitId':_0x35f464,'sparklineConfigMap':_0x17daa6}})),_0x20e376[_0x5b658d(0x14f)]({'id':O['id'],'params':{'unitId':_0x268c37,'subUnitId':_0x35f464,'sparklineConfigMap':_0x2ea393}}),l[_0x5b658d(0x1da)](_0x20e376,_0x334eff),_0x5020ef[_0x5b658d(0x153)]({'unitID':_0x268c37,'undoMutations':_0x1ccb39,'redoMutations':_0x20e376}),!0x0;}},De={'id':_0x5c26e4(0x14b),'type':l['CommandType']['COMMAND'],'handler':(_0x46ab9f,_0x32355b)=>{const _0x5b4d23=_0x5c26e4;var _0x4e7508;const {isSingle:_0x25bb38=!0x0}=_0x32355b||{},_0x3b5478=_0x46ab9f['get'](l[_0x5b4d23(0x117)]),_0xf783ac=_0x46ab9f[_0x5b4d23(0x1e2)](l[_0x5b4d23(0xf4)]),_0x3dfead=_0x46ab9f[_0x5b4d23(0x1e2)](exports[_0x5b4d23(0x11c)]),_0xff9156=_0x46ab9f[_0x5b4d23(0x1e2)](l[_0x5b4d23(0x1e1)]),_0x28184b=_[_0x5b4d23(0x15e)](_0xf783ac);if(!_0x28184b)return!0x1;const _0x48783b=_0x46ab9f[_0x5b4d23(0x1e2)](_[_0x5b4d23(0x1c0)]),_0x18601d=(_0x4e7508=_0x32355b==null?void 0x0:_0x32355b[_0x5b4d23(0x131)])!=null?_0x4e7508:_0x48783b['getCurrentSelections']()[_0x5b4d23(0x1a4)](_0xec8bc8=>_0xec8bc8[_0x5b4d23(0x1bd)]),{unitId:_0x50a093,subUnitId:_0x2d455a}=_0x28184b,_0x3bef9f=[],_0x6f719d=[];_0x3bef9f['push']({'id':T['id'],'params':{'unitId':_0x50a093,'subUnitId':_0x2d455a,'ranges':_0x18601d,'isSingle':_0x25bb38}});const _0x271269=[],_0x3f712d={};return _0x18601d[_0x5b4d23(0x1b0)](_0x3eb961=>{const _0x2ea0ff=_0x5b4d23;l[_0x2ea0ff(0x154)][_0x2ea0ff(0xfe)](_0x3eb961,(_0x1d13c6,_0x1dd06e)=>{const _0x20dd08=_0x2ea0ff,_0x5b41bd=_0x3dfead[_0x20dd08(0x135)](_0x50a093,_0x2d455a,_0x1d13c6,_0x1dd06e);if(_0x5b41bd){const _0x30d83c=_0x3dfead['getSparklineById'](_0x50a093,_0x2d455a,_0x5b41bd);_0x30d83c&&(_0x271269[_0x20dd08(0x14f)](_0x5b41bd),_0x3f712d[_0x5b41bd]={'config':l[_0x20dd08(0x149)][_0x20dd08(0xfa)](_0x30d83c[_0x20dd08(0x1e5)]),'sparklines':l[_0x20dd08(0x149)][_0x20dd08(0xfa)](_0x30d83c[_0x20dd08(0x167)]['clone']())});}});}),_0x6f719d[_0x5b4d23(0x14f)]({'id':T['id'],'params':{'unitId':_0x50a093,'subUnitId':_0x2d455a,'groupIds':_0x271269,'isSingle':!0x1}}),_0x6f719d[_0x5b4d23(0x14f)]({'id':O['id'],'params':{'unitId':_0x50a093,'subUnitId':_0x2d455a,'sparklineConfigMap':_0x3f712d}}),l['sequenceExecute'](_0x3bef9f,_0x3b5478),_0xff9156[_0x5b4d23(0x153)]({'unitID':_0x50a093,'undoMutations':_0x6f719d,'redoMutations':_0x3bef9f}),!0x0;}},ue={'id':_0x5c26e4(0x18e),'type':l[_0x5c26e4(0x16c)][_0x5c26e4(0x182)],'handler':(_0x34bda8,_0x1259b8)=>{const _0x2d74ab=_0x5c26e4;if(!_0x1259b8)return!0x1;const {unitId:_0x4fa14b,subUnitId:_0x254f28,groupIds:_0x2371e3,config:_0x1dd503}=_0x1259b8,_0x22c69e=_0x34bda8[_0x2d74ab(0x1e2)](exports[_0x2d74ab(0x11c)]);return _0x2371e3[_0x2d74ab(0x1b0)](_0x217d11=>{const _0x1c9c6d=_0x2d74ab,_0x5b6fcb=_0x22c69e[_0x1c9c6d(0x16b)](_0x4fa14b,_0x254f28,_0x217d11);if(_0x5b6fcb){const _0x4e26e0={'config':Object[_0x1c9c6d(0xff)]({},_0x5b6fcb['config'],_0x1dd503['config']),'sparklines':new l[(_0x1c9c6d(0x147))](_0x5b6fcb['sparklines'][_0x1c9c6d(0x165)]())};_0x22c69e[_0x1c9c6d(0x1a0)](_0x4fa14b,_0x254f28,[_0x217d11],_0x4e26e0);}}),!0x0;}},Ee={'id':_0x5c26e4(0x12f),'type':l[_0x5c26e4(0x16c)][_0x5c26e4(0x105)],'handler':(_0x1b6f5c,_0x534cd4)=>{const _0x5ab01a=_0x5c26e4;var _0x10d0c1,_0x4bb882,_0x5d3213,_0x3c9fdf;if(!_0x534cd4)return!0x1;const _0x48315e=_0x1b6f5c['get'](l[_0x5ab01a(0x117)]),_0x43675a=_0x1b6f5c[_0x5ab01a(0x1e2)](_['SheetsSelectionsService']),_0x44d4f9=_0x1b6f5c[_0x5ab01a(0x1e2)](exports[_0x5ab01a(0x11c)]),_0x39ce72=_0x1b6f5c[_0x5ab01a(0x1e2)](l[_0x5ab01a(0xf4)]),_0x47545a=_0x1b6f5c[_0x5ab01a(0x1e2)](l[_0x5ab01a(0x1e1)]),_0x3b08b2=_['getSheetCommandTarget'](_0x39ce72);if(!_0x3b08b2)return!0x1;const {unitId:_0x3957dc,subUnitId:_0x3e8b40}=_0x3b08b2,_0x5cdc2c=(_0x10d0c1=_0x534cd4==null?void 0x0:_0x534cd4['ranges'])!=null?_0x10d0c1:_0x43675a['getCurrentSelections']()[_0x5ab01a(0x1a4)](_0x555d68=>_0x555d68[_0x5ab01a(0x1bd)]),_0x30291f=(_0x4bb882=_0x44d4f9[_0x5ab01a(0x13b)]()[_0x5ab01a(0x19e)][_0x5ab01a(0x1e2)](_0x3957dc))==null?void 0x0:_0x4bb882[_0x5ab01a(0x1e2)](_0x3e8b40),{isChangeDataSource:_0x164eb7,config:_0x29db47,combine:_0x33dd62,unCombine:_0x2664ce}=_0x534cd4;if(_0x33dd62){const _0x1bb15e=[],_0x2ea7b3=[];_0x1bb15e[_0x5ab01a(0x14f)]({'id':T['id'],'params':{'unitId':_0x3957dc,'subUnitId':_0x3e8b40,'ranges':_0x5cdc2c,'isSingle':!0x0}});const _0x448a36='g_'+l[_0x5ab01a(0x1c5)](0x6),_0x343151=new l[(_0x5ab01a(0x147))](),_0x1111f0=(_0x5d3213=_0x44d4f9['getSparklineCache']()[_0x5ab01a(0x108)]['get'](_0x3957dc))==null?void 0x0:_0x5d3213['get'](_0x3e8b40),_0x3219ca=new Set([_0x448a36]),_0x25c854={};return _0x5cdc2c['forEach'](_0x335381=>{const _0x215b5a=_0x5ab01a;var _0x1ead55,_0x35f3e5;const {startRow:_0xb28ecd,endRow:_0x5b6d1d,startColumn:_0x2094c2,endColumn:_0x4b588f}=_0x335381;for(let _0x59ada8=_0xb28ecd;_0x59ada8<=_0x5b6d1d;_0x59ada8++)for(let _0x4a4d1d=_0x2094c2;_0x4a4d1d<=_0x4b588f;_0x4a4d1d++){const _0x5b6257=(_0x1ead55=_0x30291f==null?void 0x0:_0x30291f[_0x215b5a(0x1ba)][_0x215b5a(0x139)](_0x59ada8,_0x4a4d1d))==null?void 0x0:_0x1ead55['groupId'];if(_0x5b6257){_0x3219ca[_0x215b5a(0x1c1)](_0x5b6257);const _0x35dc17=_0x44d4f9[_0x215b5a(0x16b)](_0x3957dc,_0x3e8b40,_0x5b6257);_0x35dc17&&(_0x25c854[_0x5b6257]={'config':l[_0x215b5a(0x149)][_0x215b5a(0xfa)](_0x35dc17[_0x215b5a(0x1e5)]),'sparklines':l[_0x215b5a(0x149)][_0x215b5a(0xfa)](_0x35dc17['sparklines'][_0x215b5a(0x165)]())});const _0x4fc8f1=(_0x35f3e5=_0x1111f0==null?void 0x0:_0x1111f0[_0x215b5a(0x1e2)](_0x5b6257))==null?void 0x0:_0x35f3e5[_0x215b5a(0x167)]['getValue'](_0x59ada8,_0x4a4d1d);_0x4fc8f1&&_0x343151['setValue'](_0x59ada8,_0x4a4d1d,_0x4fc8f1);}}}),_0x1bb15e[_0x5ab01a(0x14f)]({'id':O['id'],'params':{'sparklineConfigMap':{[_0x448a36]:{'config':l[_0x5ab01a(0x149)][_0x5ab01a(0xfa)](_0x29db47[_0x5ab01a(0x1e5)]),'sparklines':_0x343151[_0x5ab01a(0x15a)]()}},'unitId':_0x3957dc,'subUnitId':_0x3e8b40}}),_0x2ea7b3[_0x5ab01a(0x14f)]({'id':T['id'],'params':{'unitId':_0x3957dc,'subUnitId':_0x3e8b40,'isSingle':!0x1,'groupIds':Array['from'](_0x3219ca)}}),_0x2ea7b3[_0x5ab01a(0x14f)]({'id':O['id'],'params':{'unitId':_0x3957dc,'subUnitId':_0x3e8b40,'sparklineConfigMap':_0x25c854}}),l[_0x5ab01a(0x1da)](_0x1bb15e,_0x48315e),_0x47545a['pushUndoRedo']({'unitID':_0x3957dc,'undoMutations':_0x2ea7b3,'redoMutations':_0x1bb15e}),!0x0;}else{if(_0x2664ce){const _0x53bb85=[],_0x1f3833=[];_0x53bb85[_0x5ab01a(0x14f)]({'id':T['id'],'params':{'unitId':_0x3957dc,'subUnitId':_0x3e8b40,'ranges':_0x5cdc2c,'isSingle':!0x0}});const _0xb4ed1=(_0x3c9fdf=_0x44d4f9[_0x5ab01a(0x13b)]()['sparklineModel'][_0x5ab01a(0x1e2)](_0x3957dc))==null?void 0x0:_0x3c9fdf[_0x5ab01a(0x1e2)](_0x3e8b40),_0x1fce2c={},_0x55f97f=new Set(),_0x2a0961={};return _0x5cdc2c[_0x5ab01a(0x1b0)](_0x189509=>{const _0x310b18=_0x5ab01a;var _0x56bd39,_0x370a63;const {startRow:_0x1a50a8,endRow:_0x46b96c,startColumn:_0x259c4d,endColumn:_0x2353a3}=_0x189509;for(let _0x308849=_0x1a50a8;_0x308849<=_0x46b96c;_0x308849++)for(let _0x2c23e7=_0x259c4d;_0x2c23e7<=_0x2353a3;_0x2c23e7++){const _0x160e67=(_0x56bd39=_0x30291f==null?void 0x0:_0x30291f[_0x310b18(0x1ba)][_0x310b18(0x139)](_0x308849,_0x2c23e7))==null?void 0x0:_0x56bd39['groupId'];if(_0x160e67){const _0x191974=new l['ObjectMatrix'](),_0x471a63='g_'+l[_0x310b18(0x1c5)](0x6);_0x55f97f[_0x310b18(0x1c1)](_0x160e67),_0x55f97f['add'](_0x471a63);const _0x155da8=_0x44d4f9[_0x310b18(0x16b)](_0x3957dc,_0x3e8b40,_0x160e67);_0x155da8&&(_0x2a0961[_0x160e67]={'config':l['Tools'][_0x310b18(0xfa)](_0x155da8[_0x310b18(0x1e5)]),'sparklines':l['Tools'][_0x310b18(0xfa)](_0x155da8[_0x310b18(0x167)][_0x310b18(0x165)]())});const _0x292ae9=(_0x370a63=_0xb4ed1==null?void 0x0:_0xb4ed1[_0x310b18(0x1e2)](_0x160e67))==null?void 0x0:_0x370a63['sparklines'][_0x310b18(0x139)](_0x308849,_0x2c23e7);_0x292ae9&&_0x191974['setValue'](_0x308849,_0x2c23e7,_0x292ae9),_0x1fce2c[_0x471a63]={'sparklines':_0x191974[_0x310b18(0x15a)](),'config':l[_0x310b18(0x149)][_0x310b18(0xfa)](_0x29db47['config'])};}}}),_0x53bb85[_0x5ab01a(0x14f)]({'id':O['id'],'params':{'unitId':_0x3957dc,'subUnitId':_0x3e8b40,'sparklineConfigMap':_0x1fce2c}}),_0x1f3833['push']({'id':T['id'],'params':{'unitId':_0x3957dc,'subUnitId':_0x3e8b40,'isSingle':!0x1,'groupIds':Array[_0x5ab01a(0x1b4)](_0x55f97f)}}),_0x1f3833[_0x5ab01a(0x14f)]({'id':O['id'],'params':{'unitId':_0x3957dc,'subUnitId':_0x3e8b40,'sparklineConfigMap':_0x2a0961}}),l[_0x5ab01a(0x1da)](_0x53bb85,_0x48315e),_0x47545a[_0x5ab01a(0x153)]({'unitID':_0x3957dc,'undoMutations':_0x1f3833,'redoMutations':_0x53bb85}),!0x0;}}if(_0x164eb7){const _0x2ae73e=_0x534cd4['changeDataSourceInfo'];if(!_0x2ae73e)return!0x1;const {groupId:_0x28e01a,sourceRanges:_0x54f1dc,targetRanges:_0x38cae9,resetType:_0x520208,primary:_0x84b33b}=_0x2ae73e,_0x1c4d1c=[],_0x5dbb0d=[];_0x1c4d1c['push']({'id':T['id'],'params':{'unitId':_0x3957dc,'subUnitId':_0x3e8b40,'ranges':_0x5cdc2c,'isSingle':!0x1,'groupIds':[_0x28e01a]}}),_0x5dbb0d['push']({'id':T['id'],'params':{'unitId':_0x3957dc,'subUnitId':_0x3e8b40,'ranges':_0x5cdc2c,'isSingle':!0x1,'groupIds':[_0x28e01a]}});let _0x1cbee5;_0x520208===_0x5ab01a(0x16d)?(_0x1cbee5=new l[(_0x5ab01a(0x147))](_0x29db47['sparklines'][_0x5ab01a(0x165)]()),_0x1cbee5['realDeleteValue'](_0x84b33b['actualRow'],_0x84b33b[_0x5ab01a(0x1cc)]),_0x1cbee5[_0x5ab01a(0x1be)](_0x38cae9[0x0][_0x5ab01a(0x172)],_0x38cae9[0x0][_0x5ab01a(0x101)],_0x54f1dc[0x0])):_0x1cbee5=he(_0x54f1dc,_0x38cae9);const _0x13c4bf={'config':l[_0x5ab01a(0x149)][_0x5ab01a(0xfa)](_0x29db47[_0x5ab01a(0x1e5)]),'sparklines':_0x1cbee5[_0x5ab01a(0x15a)]()},_0x18bf88={'config':l[_0x5ab01a(0x149)][_0x5ab01a(0xfa)](_0x29db47[_0x5ab01a(0x1e5)]),'sparklines':l[_0x5ab01a(0x149)]['deepClone'](_0x29db47[_0x5ab01a(0x167)][_0x5ab01a(0x165)]())};_0x1c4d1c['push']({'id':O['id'],'params':{'unitId':_0x3957dc,'subUnitId':_0x3e8b40,'sparklineConfigMap':{[_0x28e01a]:_0x13c4bf}}}),_0x5dbb0d[_0x5ab01a(0x14f)]({'id':O['id'],'params':{'unitId':_0x3957dc,'subUnitId':_0x3e8b40,'sparklineConfigMap':{[_0x28e01a]:_0x18bf88}}}),l[_0x5ab01a(0x1da)](_0x1c4d1c,_0x48315e),_0x47545a[_0x5ab01a(0x153)]({'unitID':_0x3957dc,'undoMutations':_0x5dbb0d,'redoMutations':_0x1c4d1c});}else{const _0x44f211=[],_0xdc693f=[],_0xa3f70=new Set(),_0x2339ca={};_0x5cdc2c[_0x5ab01a(0x1b0)](_0x7f6587=>{const _0x37d3c6=_0x5ab01a;var _0x3baf2b;const {startRow:_0x47dd71,endRow:_0x4fde27,startColumn:_0x1be3cd,endColumn:_0x2aba1b}=_0x7f6587;for(let _0x51bd08=_0x47dd71;_0x51bd08<=_0x4fde27;_0x51bd08++)for(let _0x31cd7e=_0x1be3cd;_0x31cd7e<=_0x2aba1b;_0x31cd7e++){const _0xc7b2d6=(_0x3baf2b=_0x30291f==null?void 0x0:_0x30291f[_0x37d3c6(0x1ba)][_0x37d3c6(0x139)](_0x51bd08,_0x31cd7e))==null?void 0x0:_0x3baf2b[_0x37d3c6(0x1a5)];if(_0xc7b2d6){_0xa3f70[_0x37d3c6(0x1c1)](_0xc7b2d6);const _0x3eb98d=_0x44d4f9[_0x37d3c6(0x16b)](_0x3957dc,_0x3e8b40,_0xc7b2d6);_0x3eb98d&&(_0x2339ca[_0xc7b2d6]={'config':l['Tools']['deepClone'](_0x3eb98d[_0x37d3c6(0x1e5)]),'sparklines':l['Tools'][_0x37d3c6(0xfa)](_0x3eb98d[_0x37d3c6(0x167)][_0x37d3c6(0x165)]())});}}}),_0xdc693f[_0x5ab01a(0x14f)]({'id':ue['id'],'params':{'unitId':_0x3957dc,'subUnitId':_0x3e8b40,'groupIds':Array[_0x5ab01a(0x1b4)](_0xa3f70),'config':{'config':l[_0x5ab01a(0x149)][_0x5ab01a(0xfa)](_0x29db47[_0x5ab01a(0x1e5)]),'sparklines':_0x29db47['sparklines'][_0x5ab01a(0x15a)]()}}}),_0x44f211['push']({'id':T['id'],'params':{'unitId':_0x3957dc,'subUnitId':_0x3e8b40,'isSingle':!0x1,'groupIds':Array[_0x5ab01a(0x1b4)](_0xa3f70)}}),_0x44f211[_0x5ab01a(0x14f)]({'id':O['id'],'params':{'unitId':_0x3957dc,'subUnitId':_0x3e8b40,'sparklineConfigMap':_0x2339ca}}),l['sequenceExecute'](_0xdc693f,_0x48315e),_0x47545a['pushUndoRedo']({'unitID':_0x3957dc,'undoMutations':_0x44f211,'redoMutations':_0xdc693f});}return!0x0;}};var We=Object['getOwnPropertyDescriptor'],Be=(_0x4148ab,_0x3b07c6,_0x40844b,_0x4f4c7f)=>{const _0x5f24d7=_0x5c26e4;for(var _0x447ef1=_0x4f4c7f>0x1?void 0x0:_0x4f4c7f?We(_0x3b07c6,_0x40844b):_0x3b07c6,_0x513c23=_0x4148ab[_0x5f24d7(0x152)]-0x1,_0x267b7e;_0x513c23>=0x0;_0x513c23--)(_0x267b7e=_0x4148ab[_0x513c23])&&(_0x447ef1=_0x267b7e(_0x447ef1)||_0x447ef1);return _0x447ef1;},te=(_0x2aafc2,_0x24a113)=>(_0x57caf6,_0x166c0a)=>_0x24a113(_0x57caf6,_0x166c0a,_0x2aafc2);let oe=class extends l[_0x5c26e4(0x187)]{constructor(_0x56badd,_0x5d8aa3,_0x2553da,_0x503f51){const _0x144913=_0x5c26e4;super(),this[_0x144913(0x10a)]=_0x56badd,this[_0x144913(0x17a)]=_0x5d8aa3,this[_0x144913(0x1a6)]=_0x2553da,this[_0x144913(0x1d0)]=_0x503f51,this[_0x144913(0x160)]();}['_initClearWithSparkline'](){const _0x29faf8=_0x5c26e4;this[_0x29faf8(0x198)](this['_sheetInterceptorService'][_0x29faf8(0x1ad)]({'getMutations':_0x3a8699=>{const _0x492cbb=_0x29faf8,_0x2c66f4=[],_0x5afe5c=[];if(_0x3a8699['id']===_[_0x492cbb(0x180)]['id']){const _0x5189c2=_[_0x492cbb(0x15e)](this['_univerInstanceService']);if(!_0x5189c2)return{'redos':_0x2c66f4,'undos':_0x5afe5c};const {unitId:_0x4c5862,subUnitId:_0x2bc217,worksheet:_0x3a8dd4}=_0x5189c2,_0x20c78b=this[_0x492cbb(0x1d0)][_0x492cbb(0x1a1)]()['map'](_0x2746e7=>_0x2746e7[_0x492cbb(0x1bd)]),_0x5eb8f1=new Set(),_0x518cd1={},_0x24094e={};_0x20c78b[_0x492cbb(0x1b0)](_0x29bb38=>{const _0x4e47c4=_0x492cbb;l[_0x4e47c4(0x154)][_0x4e47c4(0xfe)](_0x29bb38,(_0x4e9fed,_0xa389bd)=>{const _0xe6a98b=_0x4e47c4,_0x2a2857=this[_0xe6a98b(0x10a)][_0xe6a98b(0x135)](_0x4c5862,_0x2bc217,_0x4e9fed,_0xa389bd);if(_0x2a2857&&!_0x5eb8f1[_0xe6a98b(0x14d)](_0x2a2857)){const _0x5c92ba=this[_0xe6a98b(0x10a)][_0xe6a98b(0x16b)](_0x4c5862,_0x2bc217,_0x2a2857);_0x5c92ba&&(_0x5eb8f1[_0xe6a98b(0x1c1)](_0x2a2857),_0x518cd1[_0x2a2857]={'config':l[_0xe6a98b(0x149)][_0xe6a98b(0xfa)](_0x5c92ba['config']),'sparklines':l['Tools'][_0xe6a98b(0xfa)](_0x5c92ba[_0xe6a98b(0x167)][_0xe6a98b(0x165)]())},_0x24094e[_0x2a2857]={'config':l['Tools'][_0xe6a98b(0xfa)](_0x5c92ba[_0xe6a98b(0x1e5)]),'sparklines':l[_0xe6a98b(0x149)][_0xe6a98b(0xfa)](_0x5c92ba[_0xe6a98b(0x167)]['clone']())});}});}),Object[_0x492cbb(0x1d7)](_0x24094e)[_0x492cbb(0x1b0)](_0x4cc7f3=>{const _0x401cd9=_0x492cbb,_0x1f73ff=_0x4cc7f3[_0x401cd9(0x167)];new l[(_0x401cd9(0x147))](_0x1f73ff)['forValue']((_0x119cd4,_0x19d0de,_0x32f05d)=>{const _0x140d73=_0x401cd9;_0x20c78b[_0x140d73(0x1ce)](_0x924fd9=>l[_0x140d73(0x129)][_0x140d73(0x11b)](_0x924fd9,l['cellToRange'](_0x119cd4,_0x19d0de)))&&delete _0x1f73ff[_0x119cd4][_0x19d0de];});}),_0x2c66f4[_0x492cbb(0x14f)]({'id':T['id'],'params':{'unitId':_0x4c5862,'subUnitId':_0x2bc217,'groupIds':Array[_0x492cbb(0x1b4)](_0x5eb8f1),'isSingle':!0x1}}),_0x2c66f4[_0x492cbb(0x14f)]({'id':O['id'],'params':{'unitId':_0x4c5862,'subUnitId':_0x2bc217,'sparklineConfigMap':_0x24094e}}),_0x5afe5c[_0x492cbb(0x14f)]({'id':T['id'],'params':{'unitId':_0x4c5862,'subUnitId':_0x2bc217,'groupIds':Array[_0x492cbb(0x1b4)](_0x5eb8f1),'isSingle':!0x1}}),_0x5afe5c[_0x492cbb(0x14f)]({'id':O['id'],'params':{'unitId':_0x4c5862,'subUnitId':_0x2bc217,'sparklineConfigMap':_0x518cd1}});}return{'redos':_0x2c66f4,'undos':_0x5afe5c};}}));}};oe=Be([te(0x0,l[_0x5c26e4(0x13c)](exports[_0x5c26e4(0x11c)])),te(0x1,l[_0x5c26e4(0x13c)](_['SheetInterceptorService'])),te(0x2,l[_0x5c26e4(0x13c)](l[_0x5c26e4(0xf4)])),te(0x3,l['Inject'](_['SheetsSelectionsService']))],oe);function _0x3e88(){const _0x50ec04=['MoveColsMutation','delete','UNIVER_SHEET','sheet.mutation.set-sparkline','_initCorrectRangeWithSparkline','getCell','3230MyAWhh','AddSheetSparklineMutation','LINE_CHART','_initDataChangeListener','sheet.command.add-sparkline','3273kZZozC','SPECIALTY','disposeWithMe','pluginName','IExclusiveRangeService','updateSparklineExtraNum','params','InsertColMutation','sparklineAnchorMap','emptyShowAs','setSparkline','getCurrentSelections','getSizeOf','spacing','map','groupId','_univerInstanceService','SetWorksheetActivateCommand','toRgbString','_initRegisterCommand','MIN_SAFE_INTEGER','_getRefRangeMutationsByDeleteCols','SetSheetSparklineMutation','interceptCommand','Subject','FRESH','forEach','_sparklineModel','realDeleteValue','rgb(46,187,122)','from','Injector','DisposableCollection','getRowVisible','CONNECT_WITH_LINE','getOwnPropertyDescriptor','matrix','rgb(236,100,169)','stringify','range','setValue','themeType','SheetsSelectionsService','add','UniverLicensePlugin','rgb(252,117,60)','198kJpUYu','generateRandomId','_exclusiveRangeService','setAlpha','UniverInstanceType','refRangeHandle','_commandService','remove','actualColumn','RemoveColCommand','some','toJSON','_sheetSelectionService','getSubUnitSparkline','_resourceManagerService','clearSparklineCache','PLUGIN_NAME','ZERO_VALUE','column','values','CellValueType','NORMAL','sequenceExecute','3795190DJVbXp','_injector','fromJSON','soft','max','CUSTOM_EXTREMUM','IUndoRedoService','get','FORCE_STRING','onCommandExecuted','config','IUniverInstanceService','SetSheetSparklineCommand','ReorderRangeMutation','dispose','RefRangeService','rgb(54,78,244)','deepClone','UniverSheetSparklinePlugin','SELF_EXTREMUM','CopySheetCommand','foreach','assign','keys','startColumn','_initHideRowColWithSparkline','cellToRange','SparklineThemeTypeEnum','COMMAND','IResourceManagerService','set','sparklineModel','88080pSdGop','_sparklineDataSourceModel','RemoveColMutation','updateConfig$','touchDependencies','SpacialShowAsEnum','SparklineExtremumTypeEnum','PROFIT_AND_LOSS_CHART','extremumMin','standard','onReady','registerRefRange','ColorKit','hasValue','ICommandService','567576TADctI','AddWorksheetMergeCommand','SheetInterceptorService','intersects','SparklineDataSourceModel','219304hJxgLr','MoveRowsMutation','endRow','_initDependencies','symbol','fresh','entries','next','RemoveSheetSparklineMutation','sheet.mutation.remove-sparkline','BAR_CHART','_config','Rectangle','SPACING','firstPoint','_sparklineAnchorMap','BOOLEAN','_initCopySheetWithSparkline','sheet.command.set-sparkline','getCellRaw','ranges','MoveRangeMutation','specialty','unitId','getSparkline','value','rgb(30,177,189)','rgb(124,66,147)','getValue','PIE_CHART','getSparklineCache','Inject','SetRangeValuesMutation','rgb(244,104,249)','_ensureAnchorMatrix','extremumMax','registerCommand','SetColVisibleMutation','min','MAX_SAFE_INTEGER','Plugin','SparklinePointsNames','ObjectMatrix','distinctive','Tools','_updateConfig$','sheet.command.remove-sparkline','subUnitId','has','InsertRowMutation','push','u-spacing','4902HKtAXr','length','pushUndoRedo','Range','STANDARD','containHiddenCells','SetRowHiddenMutation','removeRows','RemoveRowCommand','getMatrix','lastPoint','disposableCollection','every','getSheetCommandTarget','type','_initClearWithSparkline','STRING','defineProperty','_initExclusiveRangeChange','lowPoint','clone','u-connect','sparklines','row','size','RemoveSheetSparklineCommand','getSparklineById','CommandType','item','_initSnapshot','adjustRangeOnMutation','nonNumShowAs','reBuildAnchorCache','startRow','moveRows','_ensureConfigMap','forValue','NUMBER','GROUP_EXTREMUM','parse','_onRefRangeChange','_sheetInterceptorService','addSparkline','_initMergeWithSparkline','deleteUnit','connect_with_line','contains','ClearSelectionAllCommand','removeSparkline','MUTATION','SparklineThemeMapping','number','endColumn','_getRefRangeMutationsByDeleteRows','Disposable','918180nnUXDj','RANGE_TYPE','RemoveRowMutation'];_0x3e88=function(){return _0x50ec04;};return _0x3e88();}var He=Object['getOwnPropertyDescriptor'],Fe=(_0xba4bec,_0xa6efe0,_0xa03292,_0x116df8)=>{const _0x55297c=_0x5c26e4;for(var _0x558396=_0x116df8>0x1?void 0x0:_0x116df8?He(_0xa6efe0,_0xa03292):_0xa6efe0,_0xa8ceb3=_0xba4bec[_0x55297c(0x152)]-0x1,_0x44fc3b;_0xa8ceb3>=0x0;_0xa8ceb3--)(_0x44fc3b=_0xba4bec[_0xa8ceb3])&&(_0x558396=_0x44fc3b(_0x558396)||_0x558396);return _0x558396;},_e=(_0x2e2ef8,_0xa086cf)=>(_0x4efcc1,_0x264916)=>_0xa086cf(_0x4efcc1,_0x264916,_0x2e2ef8);let se=class extends l[_0x5c26e4(0x187)]{constructor(_0x2dac68,_0x2a2610){const _0x1a7dfb=_0x5c26e4;super(),this[_0x1a7dfb(0x17a)]=_0x2dac68,this['_sparklineDataSourceModel']=_0x2a2610,this['_initCopySheetWithSparkline']();}[_0x5c26e4(0x12e)](){const _0x1807b6=_0x5c26e4;this[_0x1807b6(0x198)](this[_0x1807b6(0x17a)][_0x1807b6(0x1ad)]({'getMutations':_0x5a634c=>{const _0x49a059=_0x1807b6,_0x2fe41b=[],_0x5e20db=[];if(_0x5a634c['id']===_[_0x49a059(0xfd)]['id']){const _0xe4a852=_0x5a634c[_0x49a059(0x19c)];if(!_0xe4a852)return{'redos':_0x2fe41b,'undos':_0x5e20db};const {unitId:_0x343ce6,subUnitId:_0x862a41,targetSubUnitId:_0x3bc0f3}=_0xe4a852;if(!_0x343ce6||!_0x862a41||!_0x3bc0f3)return{'redos':_0x2fe41b,'undos':_0x5e20db};const _0x42778b=new Set(),_0x4405b5={},_0x465b3e=this[_0x49a059(0x10a)]['getSubUnitSparkline'](_0x343ce6,_0x862a41);if(!_0x465b3e)return{'redos':_0x2fe41b,'undos':_0x5e20db};for(const [_0x5414f6,_0x1d20ba]of _0x465b3e){const _0x336446='g_'+l[_0x49a059(0x1c5)](0x6);_0x42778b[_0x49a059(0x1c1)](_0x5414f6),_0x4405b5[_0x336446]={'config':l[_0x49a059(0x149)][_0x49a059(0xfa)](_0x1d20ba[_0x49a059(0x1e5)]),'sparklines':l[_0x49a059(0x149)][_0x49a059(0xfa)](_0x1d20ba[_0x49a059(0x167)][_0x49a059(0x165)]())};}_0x42778b[_0x49a059(0x169)]&&(_0x5e20db[_0x49a059(0x14f)]({'id':T['id'],'params':{'unitId':_0x343ce6,'subUnitId':_0x3bc0f3,'groupIds':Array[_0x49a059(0x1b4)](_0x42778b),'isSingle':!0x1}}),_0x2fe41b['push']({'id':O['id'],'params':{'unitId':_0x343ce6,'subUnitId':_0x3bc0f3,'sparklineConfigMap':_0x4405b5}}));}return{'redos':_0x2fe41b,'undos':_0x5e20db};}}));}};se=Fe([_e(0x0,l[_0x5c26e4(0x13c)](_[_0x5c26e4(0x11a)])),_e(0x1,l[_0x5c26e4(0x13c)](exports['SparklineDataSourceModel']))],se);var Ke=Object[_0x5c26e4(0x1b9)],Xe=(_0x30d0f8,_0xfcb78e,_0x60e09d,_0x1b12c8)=>{const _0x3b7ba5=_0x5c26e4;for(var _0x4292a6=_0x1b12c8>0x1?void 0x0:_0x1b12c8?Ke(_0xfcb78e,_0x60e09d):_0xfcb78e,_0x57c8e0=_0x30d0f8[_0x3b7ba5(0x152)]-0x1,_0x365b77;_0x57c8e0>=0x0;_0x57c8e0--)(_0x365b77=_0x30d0f8[_0x57c8e0])&&(_0x4292a6=_0x365b77(_0x4292a6)||_0x4292a6);return _0x4292a6;},ge=(_0x23c19b,_0x327a1c)=>(_0x5e57b9,_0x2f035a)=>_0x327a1c(_0x5e57b9,_0x2f035a,_0x23c19b);let ae=class extends l[_0x5c26e4(0x187)]{constructor(_0x47aa6b,_0x23ddf7,_0x5c8254){const _0x16630c=_0x5c26e4;super(),this[_0x16630c(0x1ca)]=_0x47aa6b,this['_sparklineDataSourceModel']=_0x23ddf7,this[_0x16630c(0x1c6)]=_0x5c8254,this[_0x16630c(0x194)](),this[_0x16630c(0x163)]();}['_initDataChangeListener'](){const _0x55a97d=_0x5c26e4;this['disposeWithMe'](this[_0x55a97d(0x1ca)][_0x55a97d(0x1e4)](_0x59bfe3=>{const _0x2b3bf8=_0x55a97d;if(_0x59bfe3['id']===_[_0x2b3bf8(0x13d)]['id']){const _0x24b78f=_0x59bfe3['params'],{cellValue:_0x171392,unitId:_0x20f598,subUnitId:_0x4d0547}=_0x24b78f,_0x4bf2d8=new l[(_0x2b3bf8(0x147))](_0x171392),_0x59800=new Set(),_0x19d76b=this['_sparklineDataSourceModel'][_0x2b3bf8(0x1d1)](_0x20f598,_0x4d0547);if(!_0x19d76b)return;const _0x21dbf6=Array[_0x2b3bf8(0x1b4)](_0x19d76b);_0x4bf2d8[_0x2b3bf8(0x175)]((_0x44d653,_0xa22ac1,_0x2c102c)=>{const _0x5b5b29=_0x2b3bf8,_0x2b2601=l[_0x5b5b29(0x103)](_0x44d653,_0xa22ac1);for(let _0x51d757=0x0;_0x51d757<_0x21dbf6[_0x5b5b29(0x152)];_0x51d757++){const [_0x4b839b,_0x4ba3a9]=_0x21dbf6[_0x51d757],_0x5dce89=_0x59800[_0x5b5b29(0x14d)](_0x4b839b);_0x5dce89||_0x4ba3a9[_0x5b5b29(0x167)]['forValue']((_0x31e94a,_0x1d752c,_0x543c4c)=>{const _0x54f84c=_0x5b5b29,_0x269a9c=_0x543c4c;if(_0x269a9c&&!_0x5dce89&&l[_0x54f84c(0x129)][_0x54f84c(0x11b)](_0x2b2601,_0x269a9c))return _0x59800[_0x54f84c(0x1c1)](_0x4b839b),!0x0;});}}),_0x59800[_0x2b3bf8(0x1b0)](_0x226bd1=>{const _0xa47975=_0x2b3bf8;this['_sparklineDataSourceModel']['clearSparklineCache'](_0x20f598,_0x4d0547,_0x226bd1),this[_0xa47975(0x10a)]['updateSparklineExtraNum'](_0x20f598,_0x4d0547,_0x226bd1);});}else{if(_0x59bfe3['id']===_[_0x2b3bf8(0xf6)]['id']){const _0x50d30b=_0x59bfe3[_0x2b3bf8(0x19c)],{range:_0x10cba5,unitId:_0x5d7af3,subUnitId:_0x3c4c29}=_0x50d30b,_0x1459e3=new Set(),_0x27bf23=this[_0x2b3bf8(0x10a)][_0x2b3bf8(0x1d1)](_0x5d7af3,_0x3c4c29);if(!_0x27bf23)return;const _0x5a88e9=Array['from'](_0x27bf23);for(let _0x25b441=0x0;_0x25b441<_0x5a88e9[_0x2b3bf8(0x152)];_0x25b441++){const [_0x53a241,_0x484a4f]=_0x5a88e9[_0x25b441],_0x3bbcf1=_0x1459e3['has'](_0x53a241);_0x3bbcf1||_0x484a4f[_0x2b3bf8(0x167)]['forValue']((_0xbe57f5,_0x1625ff,_0x371f4a)=>{const _0x569fa1=_0x2b3bf8,_0x7e3fcc=_0x371f4a;if(_0x7e3fcc&&!_0x3bbcf1&&l[_0x569fa1(0x129)][_0x569fa1(0x11b)](_0x10cba5,_0x7e3fcc))return _0x1459e3[_0x569fa1(0x1c1)](_0x53a241),!0x0;});}_0x1459e3[_0x2b3bf8(0x1b0)](_0x12ea8e=>{const _0x3c306e=_0x2b3bf8;this[_0x3c306e(0x10a)][_0x3c306e(0x1d3)](_0x5d7af3,_0x3c4c29,_0x12ea8e),this[_0x3c306e(0x10a)]['updateSparklineExtraNum'](_0x5d7af3,_0x3c4c29,_0x12ea8e);});}}}));}[_0x5c26e4(0x163)](){const _0x4be51a=_0x5c26e4;this[_0x4be51a(0x198)](this[_0x4be51a(0x1c6)]['exclusiveRangesChange$']['subscribe'](_0x220332=>{const _0x102421=_0x4be51a,{unitId:_0x6fa24b,subUnitId:_0x5c0e59,ranges:_0x8924ad}=_0x220332,_0x27d491=this[_0x102421(0x10a)]['getSubUnitSparkline'](_0x6fa24b,_0x5c0e59);if(!_0x27d491)return;const _0x42b6f9=Array['from'](_0x27d491),_0x29a440=new Set();for(let _0x478abd=0x0;_0x478abd<_0x42b6f9[_0x102421(0x152)];_0x478abd++){const [_0x4eab1f,_0x2b0a43]=_0x42b6f9[_0x478abd],_0x57ef16=_0x29a440['has'](_0x4eab1f);_0x57ef16||_0x2b0a43[_0x102421(0x167)]['forValue']((_0x74d468,_0x134d0e,_0xd1edde)=>{const _0x47eb58=_0x102421,_0x30a014=_0xd1edde;if(_0x30a014&&!_0x57ef16){for(const _0x229899 of _0x8924ad)if(l[_0x47eb58(0x129)][_0x47eb58(0x11b)](_0x229899,_0x30a014)){_0x29a440[_0x47eb58(0x1c1)](_0x4eab1f);break;}}});}_0x29a440[_0x102421(0x1b0)](_0x3d865f=>{const _0x381d0a=_0x102421;this[_0x381d0a(0x10a)][_0x381d0a(0x1d3)](_0x6fa24b,_0x5c0e59,_0x3d865f),this[_0x381d0a(0x10a)][_0x381d0a(0x19b)](_0x6fa24b,_0x5c0e59,_0x3d865f);});}));}};ae=Xe([ge(0x0,l['Inject'](l[_0x5c26e4(0x117)])),ge(0x1,l[_0x5c26e4(0x13c)](exports[_0x5c26e4(0x11c)])),ge(0x2,l[_0x5c26e4(0x13c)](_[_0x5c26e4(0x19a)]))],ae);var qe=Object[_0x5c26e4(0x1b9)],ze=(_0x16a258,_0x3e266c,_0x5b03fb,_0x1168bb)=>{const _0x308ba0=_0x5c26e4;for(var _0x34acbd=_0x1168bb>0x1?void 0x0:_0x1168bb?qe(_0x3e266c,_0x5b03fb):_0x3e266c,_0x15b8bf=_0x16a258[_0x308ba0(0x152)]-0x1,_0xc09928;_0x15b8bf>=0x0;_0x15b8bf--)(_0xc09928=_0x16a258[_0x15b8bf])&&(_0x34acbd=_0xc09928(_0x34acbd)||_0x34acbd);return _0x34acbd;},ve=(_0x795947,_0x4f2781)=>(_0x513eb8,_0x17faff)=>_0x4f2781(_0x513eb8,_0x17faff,_0x795947);let ie=class extends l[_0x5c26e4(0x187)]{constructor(_0x200dc6,_0x39e9b7){const _0x1930a2=_0x5c26e4;super(),this['_commandService']=_0x200dc6,this[_0x1930a2(0x10a)]=_0x39e9b7,this[_0x1930a2(0x102)]();}['_initHideRowColWithSparkline'](){const _0x1c969a=_0x5c26e4;this[_0x1c969a(0x1ca)]['onCommandExecuted'](_0xf3ae30=>{const _0x523c80=_0x1c969a;if(_0xf3ae30['id']===_[_0x523c80(0x157)]['id']||_0xf3ae30['id']===_['SetColHiddenMutation']['id']||_0xf3ae30['id']===_['SetRowVisibleMutation']['id']||_0xf3ae30['id']===_[_0x523c80(0x142)]['id']){const _0x1b13fc=_0xf3ae30[_0x523c80(0x19c)],{ranges:_0x36dbe9,unitId:_0x24e162,subUnitId:_0x5ed8d4}=_0x1b13fc,_0x565690=new Set(),_0x49461f=this[_0x523c80(0x10a)][_0x523c80(0x1d1)](_0x24e162,_0x5ed8d4);if(!_0x49461f)return;const _0x359052=Array[_0x523c80(0x1b4)](_0x49461f);_0x36dbe9[_0x523c80(0x1b0)](_0x4e8ac6=>{const _0xec4fac=_0x523c80;l[_0xec4fac(0x154)][_0xec4fac(0xfe)](_0x4e8ac6,(_0x14aa49,_0x1e0a23)=>{const _0x581369=_0xec4fac,_0x575fb3=l[_0x581369(0x103)](_0x14aa49,_0x1e0a23);for(let _0x8da946=0x0;_0x8da946<_0x359052[_0x581369(0x152)];_0x8da946++){const [_0x47c032,_0x50c234]=_0x359052[_0x8da946],_0x4a2da6=_0x565690[_0x581369(0x14d)](_0x47c032);_0x4a2da6||_0x50c234[_0x581369(0x167)][_0x581369(0x175)]((_0xb52765,_0x741cac,_0x53e3a9)=>{const _0x4d660f=_0x581369,_0x54fa5d=_0x53e3a9;if(_0x54fa5d&&!_0x4a2da6&&l[_0x4d660f(0x129)][_0x4d660f(0x11b)](_0x575fb3,_0x54fa5d))return _0x565690['add'](_0x47c032),!0x0;});}});}),_0x565690['forEach'](_0x24f242=>{const _0x240276=_0x523c80;this['_sparklineDataSourceModel'][_0x240276(0x1d3)](_0x24e162,_0x5ed8d4,_0x24f242),this[_0x240276(0x10a)]['updateSparklineExtraNum'](_0x24e162,_0x5ed8d4,_0x24f242);});}});}};ie=ze([ve(0x0,l[_0x5c26e4(0x13c)](l[_0x5c26e4(0x117)])),ve(0x1,l[_0x5c26e4(0x13c)](exports[_0x5c26e4(0x11c)]))],ie);var Ye=Object['getOwnPropertyDescriptor'],Je=(_0x203285,_0x2acc27,_0x351fb1,_0xeee2c7)=>{for(var _0x4ca9a8=_0xeee2c7>0x1?void 0x0:_0xeee2c7?Ye(_0x2acc27,_0x351fb1):_0x2acc27,_0x5a04ed=_0x203285['length']-0x1,_0x2cc8c4;_0x5a04ed>=0x0;_0x5a04ed--)(_0x2cc8c4=_0x203285[_0x5a04ed])&&(_0x4ca9a8=_0x2cc8c4(_0x4ca9a8)||_0x4ca9a8);return _0x4ca9a8;},fe=(_0x379ea4,_0x4c6c95)=>(_0x31ea22,_0x58b5a3)=>_0x4c6c95(_0x31ea22,_0x58b5a3,_0x379ea4);let le=class extends l[_0x5c26e4(0x187)]{constructor(_0x240f05,_0x8e9762,_0x28613a){const _0x46951c=_0x5c26e4;super(),this[_0x46951c(0x1ca)]=_0x240f05,this['_sheetInterceptorService']=_0x8e9762,this[_0x46951c(0x10a)]=_0x28613a,this[_0x46951c(0x17c)]();}[_0x5c26e4(0x17c)](){const _0x2534fc=_0x5c26e4;this[_0x2534fc(0x198)](this[_0x2534fc(0x17a)][_0x2534fc(0x1ad)]({'getMutations':_0x47262a=>{const _0x4ea944=_0x2534fc,_0xb95fae=[],_0x17785e=[];if(_0x47262a['id']===_[_0x4ea944(0x119)]['id']){const _0x4e271d=_0x47262a[_0x4ea944(0x19c)];if(!_0x4e271d)return{'redos':_0xb95fae,'undos':_0x17785e};const {unitId:_0x4561f4,subUnitId:_0xb5e34f,ranges:_0x57778b}=_0x4e271d,_0x22f955=this[_0x4ea944(0x10a)][_0x4ea944(0x1d1)](_0x4561f4,_0xb5e34f);if(!_0x22f955)return{'redos':_0xb95fae,'undos':_0x17785e};const _0x2e5a2d={},_0x396d52={},_0x306adc=new Set();_0x57778b['forEach'](_0x21f679=>{const _0x120154=_0x4ea944,_0x338752=_0x21f679[_0x120154(0x172)],_0x547de7=_0x21f679[_0x120154(0x101)];l[_0x120154(0x154)][_0x120154(0xfe)](_0x21f679,(_0x38cc51,_0x20cc63)=>{const _0x4e48d5=_0x120154,_0xebe720=this[_0x4e48d5(0x10a)][_0x4e48d5(0x135)](_0x4561f4,_0xb5e34f,_0x38cc51,_0x20cc63);if(_0xebe720&&!(_0x38cc51===_0x338752&&_0x20cc63===_0x547de7)){const _0x3ae2af=this[_0x4e48d5(0x10a)][_0x4e48d5(0x16b)](_0x4561f4,_0xb5e34f,_0xebe720);if(_0x3ae2af){_0x306adc[_0x4e48d5(0x1c1)](_0xebe720);let _0x1d78b3=_0x2e5a2d[_0xebe720];_0x1d78b3||(_0x1d78b3={'config':l[_0x4e48d5(0x149)][_0x4e48d5(0xfa)](_0x3ae2af[_0x4e48d5(0x1e5)]),'sparklines':new l[(_0x4e48d5(0x147))](_0x3ae2af[_0x4e48d5(0x167)][_0x4e48d5(0x165)]())},_0x2e5a2d[_0xebe720]=_0x1d78b3),_0x1d78b3[_0x4e48d5(0x167)][_0x4e48d5(0x1b2)](_0x38cc51,_0x20cc63),_0x396d52[_0xebe720]={'config':l['Tools'][_0x4e48d5(0xfa)](_0x3ae2af['config']),'sparklines':l[_0x4e48d5(0x149)]['deepClone'](_0x3ae2af[_0x4e48d5(0x167)]['clone']())};}}});});for(const [_0x347a28,_0x298854]of _0x22f955){const _0x48c79c=_0x298854[_0x4ea944(0x167)];_0x48c79c[_0x4ea944(0x175)]((_0x5d23ae,_0x519570,_0x739cfe)=>{const _0x50b4d5=_0x4ea944;for(let _0x3daec2=0x0;_0x3daec2<_0x57778b[_0x50b4d5(0x152)];_0x3daec2++){const _0x5b560e=_0x57778b[_0x3daec2];if(l[_0x50b4d5(0x129)][_0x50b4d5(0x17f)](_0x5b560e,_0x739cfe)){_0x306adc['add'](_0x347a28);let _0x17d927=_0x2e5a2d[_0x347a28];_0x17d927||(_0x17d927={'config':l[_0x50b4d5(0x149)][_0x50b4d5(0xfa)](_0x298854['config']),'sparklines':new l[(_0x50b4d5(0x147))](_0x48c79c[_0x50b4d5(0x165)]())},_0x2e5a2d[_0x347a28]=_0x17d927),_0x17d927['sparklines']['realDeleteValue'](_0x5d23ae,_0x519570),_0x396d52[_0x347a28]||(_0x396d52[_0x347a28]={'config':l[_0x50b4d5(0x149)][_0x50b4d5(0xfa)](_0x298854['config']),'sparklines':l['Tools'][_0x50b4d5(0xfa)](_0x48c79c[_0x50b4d5(0x165)]())});}}});}const _0x52fbc5={};Object[_0x4ea944(0x123)](_0x2e5a2d)['forEach'](([_0x4e3cb1,_0x384984])=>{const _0x2bebf9=_0x4ea944;_0x384984['sparklines']['getSizeOf']()&&(_0x52fbc5[_0x4e3cb1]={'config':_0x384984[_0x2bebf9(0x1e5)],'sparklines':_0x384984['sparklines'][_0x2bebf9(0x165)]()});}),_0x306adc[_0x4ea944(0x169)]&&(_0xb95fae[_0x4ea944(0x14f)]({'id':T['id'],'params':{'unitId':_0x4561f4,'subUnitId':_0xb5e34f,'groupIds':Array[_0x4ea944(0x1b4)](_0x306adc),'isSingle':!0x1}}),_0x17785e[_0x4ea944(0x14f)]({'id':T['id'],'params':{'unitId':_0x4561f4,'subUnitId':_0xb5e34f,'groupIds':Array[_0x4ea944(0x1b4)](_0x306adc),'isSingle':!0x1}}),_0xb95fae[_0x4ea944(0x14f)]({'id':O['id'],'params':{'unitId':_0x4561f4,'subUnitId':_0xb5e34f,'sparklineConfigMap':_0x52fbc5}}),_0x17785e[_0x4ea944(0x14f)]({'id':O['id'],'params':{'unitId':_0x4561f4,'subUnitId':_0xb5e34f,'sparklineConfigMap':_0x396d52}}));}return{'redos':_0xb95fae,'undos':_0x17785e};}}));}};le=Je([fe(0x0,l[_0x5c26e4(0x13c)](l[_0x5c26e4(0x117)])),fe(0x1,l[_0x5c26e4(0x13c)](_[_0x5c26e4(0x11a)])),fe(0x2,l[_0x5c26e4(0x13c)](exports[_0x5c26e4(0x11c)]))],le);var Ze=Object[_0x5c26e4(0x1b9)],Qe=(_0x1ca5cf,_0x1bacb2,_0x122dd4,_0x4909e1)=>{for(var _0x3ae92d=_0x4909e1>0x1?void 0x0:_0x4909e1?Ze(_0x1bacb2,_0x122dd4):_0x1bacb2,_0x3751d0=_0x1ca5cf['length']-0x1,_0x5ed3f7;_0x3751d0>=0x0;_0x3751d0--)(_0x5ed3f7=_0x1ca5cf[_0x3751d0])&&(_0x3ae92d=_0x5ed3f7(_0x3ae92d)||_0x3ae92d);return _0x3ae92d;},ne=(_0x33151,_0x47ab0a)=>(_0x433ae0,_0x2c023c)=>_0x47ab0a(_0x433ae0,_0x2c023c,_0x33151);let ce=class extends l[_0x5c26e4(0x187)]{constructor(_0x1269b3,_0x2717e4,_0xf5f421,_0x1591c3){const _0x5de741=_0x5c26e4;super(),J(this,_0x5de741(0x15c),new l[(_0x5de741(0x1b6))]()),(this['_commandService']=_0x1269b3,this['_refRangeService']=_0x2717e4,this[_0x5de741(0x1a6)]=_0xf5f421,this[_0x5de741(0x10a)]=_0x1591c3,this[_0x5de741(0x179)](),this[_0x5de741(0x18f)]());}[_0x5c26e4(0x179)](){const _0x1e6324=_0x5c26e4,_0x288474=(_0x2d19f8,_0x3eb4f9)=>{const _0x64b5c8=_0x4190,_0x426f50=this[_0x64b5c8(0x1a6)]['getCurrentUnitForType'](l['UniverInstanceType'][_0x64b5c8(0x18d)]);if(!_0x426f50||!(_0x426f50==null?void 0x0:_0x426f50['getSheetBySheetId'](_0x3eb4f9)))return;this['disposableCollection'][_0x64b5c8(0xf7)]();const _0x11ff74=_0x3abcc8=>this[_0x64b5c8(0x1c9)](_0x3abcc8,_0x2d19f8,_0x3eb4f9),_0x15638b=[],_0x3c09ff=this[_0x64b5c8(0x10a)][_0x64b5c8(0x1d1)](_0x2d19f8,_0x3eb4f9);if(_0x3c09ff){for(const [_0x47754e,_0x3826fc]of _0x3c09ff)_0x3826fc[_0x64b5c8(0x167)][_0x64b5c8(0x175)]((_0x2fbab5,_0x37824e,_0x2fe94c)=>{const _0x48d7b8=_0x64b5c8,_0x151d39=l['cellToRange'](_0x2fbab5,_0x37824e);_0x15638b[_0x48d7b8(0x14f)](_0x151d39);});_0x15638b[_0x64b5c8(0x1b0)](_0x5d23e4=>{const _0x103274=_0x64b5c8;this[_0x103274(0x15c)][_0x103274(0x1c1)](this['_refRangeService'][_0x103274(0x114)](_0x5d23e4,_0x11ff74,_0x2d19f8,_0x3eb4f9));});}};this[_0x1e6324(0x198)](this['_commandService']['onCommandExecuted'](_0x46647f=>{const _0x481509=_0x1e6324;if(_0x46647f['id']===_[_0x481509(0x1a7)]['id']){const _0x2f6476=_0x46647f[_0x481509(0x19c)],_0x1bacbf=_0x2f6476[_0x481509(0x14c)],_0x45afd1=_0x2f6476[_0x481509(0x134)];if(!_0x1bacbf||!_0x45afd1)return;_0x288474(_0x45afd1,_0x1bacbf);}if(_0x46647f['id']===ue['id']||_0x46647f['id']===O['id']){const _0x3da2ed=_0x46647f['params'],_0x4c3094=_0x3da2ed['subUnitId'],_0x38c8c1=_0x3da2ed[_0x481509(0x134)];if(!_0x4c3094||!_0x38c8c1)return;_0x288474(_0x38c8c1,_0x4c3094);}}));}[_0x5c26e4(0x1c9)](_0x5e6e3b,_0x5f4793,_0x325fc5){const _0x39c13c=_0x5c26e4;switch(_0x5e6e3b['id']){case _[_0x39c13c(0x1cd)]['id']:return this[_0x39c13c(0x1ab)](_0x5e6e3b[_0x39c13c(0x19c)],_0x5f4793,_0x325fc5);case _[_0x39c13c(0x159)]['id']:return this[_0x39c13c(0x186)](_0x5e6e3b['params'],_0x5f4793,_0x325fc5);}return{'redos':[],'undos':[]};}[_0x5c26e4(0x186)](_0x39c0a7,_0xeb0028,_0x5d3397){const _0x7070a6=_0x5c26e4;var _0x24e795,_0x1d4371;const {range:_0x5264fc}=_0x39c0a7,_0x23e018=new Set(),_0x4f7cf2={},_0x3f8ca8={},_0x526d92=[],_0x1c375c=[],_0x54a013=[],_0x43fb02=[];if(!_[_0x7070a6(0x15e)](this[_0x7070a6(0x1a6)],{'unitId':_0xeb0028,'subUnitId':_0x5d3397}))return{'redos':_0x1c375c,'undos':_0x526d92};const _0x1f1154=this[_0x7070a6(0x10a)][_0x7070a6(0x1d1)](_0xeb0028,_0x5d3397);if(!_0x1f1154)return{'redos':_0x1c375c,'undos':_0x526d92};if(!((_0x1d4371=(_0x24e795=this[_0x7070a6(0x10a)][_0x7070a6(0x13b)]()[_0x7070a6(0x19e)]['get'](_0xeb0028))==null?void 0x0:_0x24e795[_0x7070a6(0x1e2)](_0x5d3397))==null?void 0x0:_0x1d4371[_0x7070a6(0x1ba)]))return{'redos':_0x1c375c,'undos':_0x526d92};for(const [_0x2f3a96,_0x5a6b81]of _0x1f1154){const _0x26154e=_0x5a6b81[_0x7070a6(0x167)];_0x26154e['forValue']((_0x1fc48e,_0x1fc944,_0x23f81d)=>{const _0x4cca3f=_0x7070a6;if(l['Rectangle'][_0x4cca3f(0x11b)](_0x5264fc,_0x23f81d)){_0x23e018[_0x4cca3f(0x1c1)](_0x2f3a96);let _0x90f34c=_0x3f8ca8[_0x2f3a96];_0x90f34c||(_0x90f34c={'config':_0x5a6b81['config'],'sparklines':_0x5a6b81[_0x4cca3f(0x167)][_0x4cca3f(0x165)]()},_0x3f8ca8[_0x2f3a96]=_0x90f34c);let _0x2109a0=_0x4f7cf2[_0x2f3a96];_0x2109a0||(_0x2109a0={'config':_0x5a6b81[_0x4cca3f(0x1e5)],'sparklines':new l['ObjectMatrix'](_0x5a6b81[_0x4cca3f(0x167)][_0x4cca3f(0x165)]())},_0x4f7cf2[_0x2f3a96]=_0x2109a0);const _0x501a63=_[_0x4cca3f(0x16f)](_0x23f81d,{'id':_[_0x4cca3f(0x18a)]['id'],'params':_0x39c0a7});_0x501a63?_0x2109a0[_0x4cca3f(0x167)]['setValue'](_0x1fc48e,_0x1fc944,_0x501a63):_0x2109a0[_0x4cca3f(0x167)][_0x4cca3f(0x1be)](_0x1fc48e,_0x1fc944,{'startRow':-0x270f,'endRow':-0x270f,'startColumn':-0x270f,'endColumn':-0x270f,'rangeType':l['RANGE_TYPE'][_0x4cca3f(0x1d9)]});}}),_0x26154e[_0x7070a6(0x175)]((_0xc56d2d,_0x332c12,_0x3dc220)=>{const _0x5af816=_0x7070a6;if(_0xc56d2d<=_0x5264fc[_0x5af816(0x11f)]&&_0xc56d2d>=_0x5264fc[_0x5af816(0x172)]){_0x23e018[_0x5af816(0x1c1)](_0x2f3a96);let _0x19fa0e=_0x3f8ca8[_0x2f3a96];_0x19fa0e||(_0x19fa0e={'config':_0x5a6b81['config'],'sparklines':_0x5a6b81[_0x5af816(0x167)][_0x5af816(0x165)]()},_0x3f8ca8[_0x2f3a96]=_0x19fa0e);let _0x19627c=_0x4f7cf2[_0x2f3a96];_0x19627c||(_0x19627c={'config':_0x5a6b81[_0x5af816(0x1e5)],'sparklines':new l[(_0x5af816(0x147))](_0x5a6b81[_0x5af816(0x167)][_0x5af816(0x165)]())},_0x4f7cf2[_0x2f3a96]=_0x19627c);}});}_0x43fb02[_0x7070a6(0x14f)]({'id':T['id'],'params':{'unitId':_0xeb0028,'subUnitId':_0x5d3397,'groupIds':Array[_0x7070a6(0x1b4)](_0x23e018),'isSingle':!0x1}}),_0x54a013[_0x7070a6(0x14f)]({'id':T['id'],'params':{'unitId':_0xeb0028,'subUnitId':_0x5d3397,'groupIds':Array[_0x7070a6(0x1b4)](_0x23e018),'isSingle':!0x1}});const _0xb7ac3={};let _0x423475=!0x1;return Object['entries'](_0x4f7cf2)['forEach'](([_0x390696,_0x511b28])=>{const _0x3cf150=_0x7070a6;_0x511b28['sparklines'][_0x3cf150(0x1a2)]()&&(_0x423475=!0x0,_0x511b28[_0x3cf150(0x167)][_0x3cf150(0x158)](_0x5264fc['startRow'],_0x5264fc['endRow']-_0x5264fc[_0x3cf150(0x172)]+0x1),_0xb7ac3[_0x390696]={'config':_0x511b28[_0x3cf150(0x1e5)],'sparklines':_0x511b28[_0x3cf150(0x167)][_0x3cf150(0x165)]()});}),_0x423475&&_0x1c375c[_0x7070a6(0x14f)]({'id':O['id'],'params':{'unitId':_0xeb0028,'subUnitId':_0x5d3397,'sparklineConfigMap':_0xb7ac3}}),_0x526d92[_0x7070a6(0x14f)]({'id':O['id'],'params':{'unitId':_0xeb0028,'subUnitId':_0x5d3397,'sparklineConfigMap':_0x3f8ca8}}),{'redos':_0x1c375c,'undos':_0x526d92,'preRedos':_0x54a013,'preUndos':_0x43fb02};}[_0x5c26e4(0x1ab)](_0xf9ff3,_0x5da1f6,_0xe5d682){const _0x13a971=_0x5c26e4;var _0x302a0b,_0x4bc956;const {range:_0x2b30d6}=_0xf9ff3,_0xe61f31=new Set(),_0x365083={},_0x3da207={},_0x5bbe5a=[],_0x24ec82=[],_0x37e24f=[],_0x1663fa=[];if(!_[_0x13a971(0x15e)](this['_univerInstanceService'],{'unitId':_0x5da1f6,'subUnitId':_0xe5d682}))return{'redos':_0x24ec82,'undos':_0x5bbe5a};const _0x2fa665=this[_0x13a971(0x10a)][_0x13a971(0x1d1)](_0x5da1f6,_0xe5d682);if(!_0x2fa665)return{'redos':_0x24ec82,'undos':_0x5bbe5a};if(!((_0x4bc956=(_0x302a0b=this[_0x13a971(0x10a)][_0x13a971(0x13b)]()['sparklineAnchorMap'][_0x13a971(0x1e2)](_0x5da1f6))==null?void 0x0:_0x302a0b[_0x13a971(0x1e2)](_0xe5d682))==null?void 0x0:_0x4bc956[_0x13a971(0x1ba)]))return{'redos':_0x24ec82,'undos':_0x5bbe5a};for(const [_0x30b0d4,_0x51115f]of _0x2fa665){const _0x28c9a7=_0x51115f['sparklines'];_0x28c9a7[_0x13a971(0x175)]((_0x247c1e,_0xd5fd3f,_0x1198a2)=>{const _0x89c829=_0x13a971;if(l[_0x89c829(0x129)][_0x89c829(0x11b)](_0x2b30d6,_0x1198a2)){_0xe61f31[_0x89c829(0x1c1)](_0x30b0d4);let _0x31a036=_0x3da207[_0x30b0d4];_0x31a036||(_0x31a036={'config':_0x51115f[_0x89c829(0x1e5)],'sparklines':_0x51115f['sparklines'][_0x89c829(0x165)]()},_0x3da207[_0x30b0d4]=_0x31a036);let _0x4ddde8=_0x365083[_0x30b0d4];_0x4ddde8||(_0x4ddde8={'config':_0x51115f['config'],'sparklines':new l[(_0x89c829(0x147))](_0x51115f[_0x89c829(0x167)][_0x89c829(0x165)]())},_0x365083[_0x30b0d4]=_0x4ddde8);const _0x9d0a09=_[_0x89c829(0x16f)](_0x1198a2,{'id':_[_0x89c829(0x10b)]['id'],'params':_0xf9ff3});_0x9d0a09?_0x4ddde8['sparklines'][_0x89c829(0x1be)](_0x247c1e,_0xd5fd3f,_0x9d0a09):_0x4ddde8[_0x89c829(0x167)][_0x89c829(0x1be)](_0x247c1e,_0xd5fd3f,{'startRow':-0x270f,'endRow':-0x270f,'startColumn':-0x270f,'endColumn':-0x270f,'rangeType':l['RANGE_TYPE'][_0x89c829(0x1d9)]});}}),_0x28c9a7['forValue']((_0x236644,_0x532242,_0x40f6d9)=>{const _0x14854c=_0x13a971;if(_0x532242<=_0x2b30d6[_0x14854c(0x185)]&&_0x532242>=_0x2b30d6[_0x14854c(0x101)]){_0xe61f31[_0x14854c(0x1c1)](_0x30b0d4);let _0x5d10ac=_0x3da207[_0x30b0d4];_0x5d10ac||(_0x5d10ac={'config':_0x51115f[_0x14854c(0x1e5)],'sparklines':_0x51115f[_0x14854c(0x167)][_0x14854c(0x165)]()},_0x3da207[_0x30b0d4]=_0x5d10ac);let _0x39085c=_0x365083[_0x30b0d4];_0x39085c||(_0x39085c={'config':_0x51115f['config'],'sparklines':new l[(_0x14854c(0x147))](_0x51115f[_0x14854c(0x167)][_0x14854c(0x165)]())},_0x365083[_0x30b0d4]=_0x39085c);}});}_0x1663fa['push']({'id':T['id'],'params':{'unitId':_0x5da1f6,'subUnitId':_0xe5d682,'groupIds':Array[_0x13a971(0x1b4)](_0xe61f31),'isSingle':!0x1}}),_0x37e24f['push']({'id':T['id'],'params':{'unitId':_0x5da1f6,'subUnitId':_0xe5d682,'groupIds':Array[_0x13a971(0x1b4)](_0xe61f31),'isSingle':!0x1}});const _0x2ff88d={};let _0x349e83=!0x1;return Object[_0x13a971(0x123)](_0x365083)[_0x13a971(0x1b0)](([_0x1b3d37,_0x50793a])=>{const _0x53985f=_0x13a971;_0x50793a[_0x53985f(0x167)][_0x53985f(0x1a2)]()&&(_0x349e83=!0x0,_0x50793a[_0x53985f(0x167)]['removeColumns'](_0x2b30d6[_0x53985f(0x101)],_0x2b30d6[_0x53985f(0x185)]-_0x2b30d6['startColumn']+0x1),_0x2ff88d[_0x1b3d37]={'config':_0x50793a[_0x53985f(0x1e5)],'sparklines':_0x50793a[_0x53985f(0x167)]['clone']()});}),_0x349e83&&_0x24ec82[_0x13a971(0x14f)]({'id':O['id'],'params':{'unitId':_0x5da1f6,'subUnitId':_0xe5d682,'sparklineConfigMap':_0x2ff88d}}),_0x5bbe5a[_0x13a971(0x14f)]({'id':O['id'],'params':{'unitId':_0x5da1f6,'subUnitId':_0xe5d682,'sparklineConfigMap':_0x3da207}}),{'redos':_0x24ec82,'undos':_0x5bbe5a,'preRedos':_0x37e24f,'preUndos':_0x1663fa};}[_0x5c26e4(0x18f)](){const _0x1096e3=_0x5c26e4;this[_0x1096e3(0x198)](this[_0x1096e3(0x1ca)]['onCommandExecuted'](_0x41af48=>{const _0x474b7f=_0x1096e3;if(_0x41af48['id']===_[_0x474b7f(0x19d)]['id']){const _0x23a61c=_0x41af48[_0x474b7f(0x19c)],{unitId:_0x528228,subUnitId:_0x56830a,range:_0x5abe7e}=_0x23a61c,_0x11d6e7=_0x5abe7e[_0x474b7f(0x101)],_0x13f56d=_0x5abe7e[_0x474b7f(0x185)]-_0x5abe7e[_0x474b7f(0x101)]+0x1,_0x271be6=this[_0x474b7f(0x10a)][_0x474b7f(0x1d1)](_0x528228,_0x56830a);if(!_0x271be6)return;for(const [_0x4a8bc6,_0x31315c]of _0x271be6){this['_sparklineDataSourceModel'][_0x474b7f(0x1d3)](_0x528228,_0x56830a,_0x4a8bc6);const _0x516e3a=_0x31315c['sparklines'];_0x516e3a[_0x474b7f(0x175)]((_0x1974e4,_0x182143,_0x1d36a9)=>{const _0x424c43=_0x474b7f,_0x359c74={..._0x1d36a9};_0x11d6e7<=_0x359c74[_0x424c43(0x101)]?(_0x359c74[_0x424c43(0x101)]+=_0x13f56d,_0x359c74[_0x424c43(0x185)]+=_0x13f56d):_0x11d6e7>_0x359c74['endColumn']||(_0x359c74['endColumn']+=_0x13f56d),_0x516e3a['setValue'](_0x1974e4,_0x182143,_0x359c74);});const _0x4eca92=_0x516e3a['getMatrix']();for(const _0x5d0c88 in _0x4eca92){const _0x2c62d4=_0x4eca92[Number(_0x5d0c88)];if(!_0x2c62d4)continue;const _0x35a68b=Object[_0x474b7f(0x100)](_0x2c62d4)['map'](Number),_0x4e72cf=Math[_0x474b7f(0x1df)](..._0x35a68b);for(let _0x2447cf=_0x4e72cf;_0x2447cf>=_0x11d6e7;_0x2447cf--)_0x2447cf>=_0x11d6e7&&_0x2c62d4[_0x2447cf]&&(_0x2c62d4[_0x2447cf+_0x13f56d]=_0x2c62d4[_0x2447cf],delete _0x2c62d4[_0x2447cf]);}this[_0x474b7f(0x10a)][_0x474b7f(0x19b)](_0x528228,_0x56830a,_0x4a8bc6);}}else{if(_0x41af48['id']===_[_0x474b7f(0x14e)]['id']){const _0x113d62=_0x41af48['params'],{unitId:_0x1ca0df,subUnitId:_0x21cd85,range:_0x36345e}=_0x113d62,_0x52bd7f=_0x36345e['startRow'],_0x1e592a=_0x36345e[_0x474b7f(0x11f)]-_0x36345e['startRow']+0x1,_0x1507de=this['_sparklineDataSourceModel'][_0x474b7f(0x1d1)](_0x1ca0df,_0x21cd85);if(!_0x1507de)return;for(const [_0x12af92,_0x1240b1]of _0x1507de){this[_0x474b7f(0x10a)][_0x474b7f(0x1d3)](_0x1ca0df,_0x21cd85,_0x12af92);const _0xcf8735=_0x1240b1[_0x474b7f(0x167)];_0xcf8735[_0x474b7f(0x175)]((_0x712506,_0x301006,_0x40505b)=>{const _0x43bf26=_0x474b7f,_0x1155c0={..._0x40505b};_0x52bd7f<=_0x1155c0[_0x43bf26(0x172)]?(_0x1155c0[_0x43bf26(0x172)]+=_0x1e592a,_0x1155c0[_0x43bf26(0x11f)]+=_0x1e592a):_0x52bd7f>_0x1155c0[_0x43bf26(0x11f)]||(_0x1155c0['endRow']+=_0x1e592a),_0xcf8735[_0x43bf26(0x1be)](_0x712506,_0x301006,_0x1155c0);});const _0x4c10ce=_0xcf8735[_0x474b7f(0x15a)](),_0x549f68=Object[_0x474b7f(0x100)](_0x4c10ce)[_0x474b7f(0x1a4)](Number),_0x11efb6=Math[_0x474b7f(0x1df)](..._0x549f68);for(let _0x25a57e=_0x11efb6;_0x25a57e>=_0x52bd7f;_0x25a57e--)_0x25a57e>=_0x52bd7f&&_0x4c10ce[_0x25a57e]&&(_0x4c10ce[_0x25a57e+_0x1e592a]=_0x4c10ce[_0x25a57e],delete _0x4c10ce[_0x25a57e]);this[_0x474b7f(0x10a)][_0x474b7f(0x19b)](_0x1ca0df,_0x21cd85,_0x12af92);}}else{if(_0x41af48['id']===_['RemoveColMutation']['id']){const _0x1a8a1a=_0x41af48['params'],{range:_0xee856d,unitId:_0x1085da,subUnitId:_0x1f9fbf}=_0x1a8a1a,_0x5a78ba=this[_0x474b7f(0x10a)][_0x474b7f(0x1d1)](_0x1085da,_0x1f9fbf);if(!_0x5a78ba)return;for(const [_0x2b7142,_0xab6a52]of _0x5a78ba){const _0x21d783=_0xab6a52[_0x474b7f(0x167)];_0x21d783['forValue']((_0x454209,_0x4552fe,_0x35f8aa)=>{const _0x3f354d=_0x474b7f,_0x288add=_[_0x3f354d(0x16f)](_0x35f8aa,_0x41af48);_0x288add?_0x21d783[_0x3f354d(0x1be)](_0x454209,_0x4552fe,_0x288add):_0x21d783[_0x3f354d(0x1be)](_0x454209,_0x4552fe,{'startRow':-0x270f,'endRow':-0x270f,'startColumn':-0x270f,'endColumn':-0x270f,'rangeType':l[_0x3f354d(0x189)][_0x3f354d(0x1d9)]});}),_0x21d783['removeColumns'](_0xee856d[_0x474b7f(0x101)],_0xee856d['endColumn']-_0xee856d['startColumn']+0x1);}this[_0x474b7f(0x10a)][_0x474b7f(0x171)](_0x1085da,_0x1f9fbf);}else{if(_0x41af48['id']===_[_0x474b7f(0x18a)]['id']){const _0x1b8202=_0x41af48[_0x474b7f(0x19c)],{range:_0x5788e0,unitId:_0x5c4275,subUnitId:_0x48af01}=_0x1b8202,_0x3f1229=this['_sparklineDataSourceModel'][_0x474b7f(0x1d1)](_0x5c4275,_0x48af01);if(!_0x3f1229)return;for(const [_0x272994,_0x26b929]of _0x3f1229){const _0x4a7c96=_0x26b929[_0x474b7f(0x167)];_0x4a7c96[_0x474b7f(0x175)]((_0x4bd88f,_0xcd1a35,_0x4f56ab)=>{const _0x4e7d96=_0x474b7f,_0x2f2151=_[_0x4e7d96(0x16f)](_0x4f56ab,_0x41af48);_0x2f2151?_0x4a7c96[_0x4e7d96(0x1be)](_0x4bd88f,_0xcd1a35,_0x2f2151):_0x4a7c96[_0x4e7d96(0x1be)](_0x4bd88f,_0xcd1a35,{'startRow':-0x270f,'endRow':-0x270f,'startColumn':-0x270f,'endColumn':-0x270f,'rangeType':l[_0x4e7d96(0x189)][_0x4e7d96(0x1d9)]});}),_0x4a7c96['removeRows'](_0x5788e0[_0x474b7f(0x172)],_0x5788e0[_0x474b7f(0x11f)]-_0x5788e0[_0x474b7f(0x172)]+0x1);}this['_sparklineDataSourceModel']['reBuildAnchorCache'](_0x5c4275,_0x48af01);}else{if(_0x41af48['id']===_[_0x474b7f(0x18b)]['id']){const _0x13e3b4=_0x41af48[_0x474b7f(0x19c)],{unitId:_0x22a4af,subUnitId:_0x19ca5b,sourceRange:_0x1b13aa,targetRange:_0x35a355}=_0x13e3b4,_0x258b3c=this[_0x474b7f(0x10a)][_0x474b7f(0x1d1)](_0x22a4af,_0x19ca5b);if(!_0x258b3c)return;for(const [_0x30b32f,_0xa28c82]of _0x258b3c){const _0x23f97b=_0xa28c82['sparklines'];_0x23f97b['forValue']((_0x587e4b,_0x301bcd,_0x454b63)=>{const _0x3ea306=_0x474b7f,_0x160b72=_[_0x3ea306(0x16f)](_0x454b63,_0x41af48);_0x160b72?_0x23f97b[_0x3ea306(0x1be)](_0x587e4b,_0x301bcd,_0x160b72):_0x23f97b['setValue'](_0x587e4b,_0x301bcd,{'startRow':-0x270f,'endRow':-0x270f,'startColumn':-0x270f,'endColumn':-0x270f,'rangeType':l[_0x3ea306(0x189)][_0x3ea306(0x1d9)]});}),_0x23f97b['moveColumns'](_0x1b13aa['startColumn'],_0x1b13aa[_0x474b7f(0x185)]-_0x1b13aa[_0x474b7f(0x101)]+0x1,_0x35a355[_0x474b7f(0x101)]);}this['_sparklineDataSourceModel'][_0x474b7f(0x171)](_0x22a4af,_0x19ca5b);}else{if(_0x41af48['id']===_[_0x474b7f(0x11e)]['id']){const _0xf35fe5=_0x41af48['params'],{unitId:_0x593f86,subUnitId:_0x653015,sourceRange:_0x490f2b,targetRange:_0x3bfb19}=_0xf35fe5,_0xe40aa5=this[_0x474b7f(0x10a)]['getSubUnitSparkline'](_0x593f86,_0x653015);if(!_0xe40aa5)return;for(const [_0xf16110,_0x5eda12]of _0xe40aa5){const _0x5baae3=_0x5eda12[_0x474b7f(0x167)];_0x5baae3[_0x474b7f(0x175)]((_0x24b1ee,_0x280c31,_0x50bb96)=>{const _0x519e44=_0x474b7f,_0x5625e6=_[_0x519e44(0x16f)](_0x50bb96,_0x41af48);_0x5625e6?_0x5baae3['setValue'](_0x24b1ee,_0x280c31,_0x5625e6):_0x5baae3[_0x519e44(0x1be)](_0x24b1ee,_0x280c31,{'startRow':-0x270f,'endRow':-0x270f,'startColumn':-0x270f,'endColumn':-0x270f,'rangeType':l[_0x519e44(0x189)][_0x519e44(0x1d9)]});}),_0x5baae3[_0x474b7f(0x173)](_0x490f2b['startRow'],_0x490f2b[_0x474b7f(0x11f)]-_0x490f2b[_0x474b7f(0x172)]+0x1,_0x3bfb19['startRow']);}this[_0x474b7f(0x10a)][_0x474b7f(0x171)](_0x593f86,_0x653015);}else{if(_0x41af48['id']===_[_0x474b7f(0x132)]['id']){const _0x556c45=_0x41af48['params'],{fromRange:_0x1ef22b,toRange:_0x2184fe,unitId:_0x1eb4de,from:_0x10e241,to:_0xb24939}=_0x556c45;if(_0x10e241[_0x474b7f(0x14c)]!==_0xb24939['subUnitId'])return;const _0x3f933a=_0x10e241[_0x474b7f(0x14c)],{startRow:_0xe54dd2,endRow:_0x6240f8,startColumn:_0x2801de,endColumn:_0x5fba6f}=_0x1ef22b,{startRow:_0x2bcd4f,startColumn:_0x1a6220}=_0x2184fe,_0xc097ba=_0x2bcd4f-_0xe54dd2,_0x95abb9=_0x1a6220-_0x2801de,_0x2f55b9=this[_0x474b7f(0x10a)][_0x474b7f(0x1d1)](_0x1eb4de,_0x3f933a);if(!(_0x2f55b9!=null&&_0x2f55b9[_0x474b7f(0x169)]))return;for(let _0x1ee7e7=_0xe54dd2;_0x1ee7e7<=_0x6240f8;_0x1ee7e7++)for(let _0x40cd65=_0x2801de;_0x40cd65<=_0x5fba6f;_0x40cd65++){const _0x69c570=this[_0x474b7f(0x10a)][_0x474b7f(0x135)](_0x1eb4de,_0x3f933a,_0x1ee7e7,_0x40cd65);if(_0x69c570){const _0x3e69cd=this[_0x474b7f(0x10a)]['getSparklineById'](_0x1eb4de,_0x3f933a,_0x69c570);if(_0x3e69cd){const _0x258525=_0x3e69cd[_0x474b7f(0x167)][_0x474b7f(0x139)](_0x1ee7e7,_0x40cd65);_0x258525&&(_0x3e69cd['sparklines'][_0x474b7f(0x1be)](_0x1ee7e7+_0xc097ba,_0x40cd65+_0x95abb9,_0x258525),_0x3e69cd['sparklines'][_0x474b7f(0x1b2)](_0x1ee7e7,_0x40cd65));}}}for(const [_0x54b989,_0xd178d3]of _0x2f55b9){const _0x15dce3=_0xd178d3[_0x474b7f(0x167)];_0x15dce3[_0x474b7f(0x175)]((_0xf129c7,_0x247acb,_0xa98b7b)=>{const _0x2960b2=_0x474b7f,_0x371371={..._0xa98b7b};l[_0x2960b2(0x129)][_0x2960b2(0x17f)](_0x1ef22b,_0xa98b7b)&&(_0x371371[_0x2960b2(0x172)]+=_0xc097ba,_0x371371['endRow']+=_0xc097ba,_0x371371[_0x2960b2(0x101)]+=_0x95abb9,_0x371371['endColumn']+=_0x95abb9),_0x15dce3[_0x2960b2(0x1be)](_0xf129c7,_0x247acb,_0x371371);});}this['_sparklineDataSourceModel'][_0x474b7f(0x171)](_0x1eb4de,_0x3f933a);}}}}}}}}));}};ce=Qe([ne(0x0,l[_0x5c26e4(0x13c)](l[_0x5c26e4(0x117)])),ne(0x1,l['Inject'](_[_0x5c26e4(0xf8)])),ne(0x2,l[_0x5c26e4(0xf4)]),ne(0x3,l[_0x5c26e4(0x13c)](exports[_0x5c26e4(0x11c)]))],ce);var et=Object[_0x5c26e4(0x1b9)],tt=(_0x39964a,_0x41b9be,_0x17e4af,_0x3fc983)=>{const _0x3e4f0c=_0x5c26e4;for(var _0x4eb385=_0x3fc983>0x1?void 0x0:_0x3fc983?et(_0x41b9be,_0x17e4af):_0x41b9be,_0xe2dbea=_0x39964a[_0x3e4f0c(0x152)]-0x1,_0x180912;_0xe2dbea>=0x0;_0xe2dbea--)(_0x180912=_0x39964a[_0xe2dbea])&&(_0x4eb385=_0x180912(_0x4eb385)||_0x4eb385);return _0x4eb385;},we=(_0x3a3f02,_0x59dd72)=>(_0x1bccb4,_0x10e6d7)=>_0x59dd72(_0x1bccb4,_0x10e6d7,_0x3a3f02);let de=class extends l['Disposable']{constructor(_0x2741e5,_0x648579){const _0x3acea3=_0x5c26e4;super(),this[_0x3acea3(0x1d2)]=_0x2741e5,this['_sparklineDataSourceModel']=_0x648579,this[_0x3acea3(0x16e)]();}[_0x5c26e4(0x16e)](){const _0x479781=_0x5c26e4,_0x23f374=_0x1398bc=>{const _0x39a9db=_0x4190,_0x208e9c=this['_sparklineDataSourceModel'][_0x39a9db(0x1cf)](_0x1398bc);return _0x208e9c?JSON[_0x39a9db(0x1bc)](_0x208e9c):'';},_0x2062eb=_0xf037a6=>_0xf037a6?JSON[_0x479781(0x178)](_0xf037a6):{};this[_0x479781(0x198)](this[_0x479781(0x1d2)]['registerPluginResource']({'toJson':_0x23f374,'parseJson':_0x2062eb,'pluginName':ke,'businesses':[l['UniverInstanceType'][_0x479781(0x18d)]],'onLoad':(_0x27b221,_0x5076a5)=>{const _0x565467=_0x479781;this[_0x565467(0x10a)][_0x565467(0x1dd)](_0x5076a5);},'onUnLoad':_0x1063da=>{const _0x41954b=_0x479781;this['_sparklineDataSourceModel'][_0x41954b(0x17d)](_0x1063da);}}));}};de=tt([we(0x0,l[_0x5c26e4(0x13c)](l[_0x5c26e4(0x106)])),we(0x1,l[_0x5c26e4(0x13c)](exports[_0x5c26e4(0x11c)]))],de);var nt=Object['defineProperty'],rt=Object[_0x5c26e4(0x1b9)],ot=(_0x4f93b2,_0x20a84c,_0x30dbe5)=>_0x20a84c in _0x4f93b2?nt(_0x4f93b2,_0x20a84c,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0x30dbe5}):_0x4f93b2[_0x20a84c]=_0x30dbe5,st=(_0x58937c,_0x30acb0,_0x381885,_0x58ca2c)=>{const _0x501c8b=_0x5c26e4;for(var _0x47efcd=_0x58ca2c>0x1?void 0x0:_0x58ca2c?rt(_0x30acb0,_0x381885):_0x30acb0,_0x503efb=_0x58937c[_0x501c8b(0x152)]-0x1,_0x22bc77;_0x503efb>=0x0;_0x503efb--)(_0x22bc77=_0x58937c[_0x503efb])&&(_0x47efcd=_0x22bc77(_0x47efcd)||_0x47efcd);return _0x47efcd;},Ie=(_0x2e4f4b,_0x558a0a)=>(_0x540957,_0x16054a)=>_0x558a0a(_0x540957,_0x16054a,_0x2e4f4b),Oe=(_0x11613b,_0x9d8aa9,_0xb7f70d)=>ot(_0x11613b,typeof _0x9d8aa9!=_0x5c26e4(0x121)?_0x9d8aa9+'':_0x9d8aa9,_0xb7f70d);exports['UniverSheetSparklinePlugin']=class extends l[_0x5c26e4(0x145)]{constructor(_0x510a19={},_0x145df9,_0x727820){const _0x4666d9=_0x5c26e4;super(),this[_0x4666d9(0x128)]=_0x510a19,this[_0x4666d9(0x1dc)]=_0x145df9,this[_0x4666d9(0x1ca)]=_0x727820,this[_0x4666d9(0x120)](),this[_0x4666d9(0x1a9)]();}[_0x5c26e4(0x120)](){const _0x3dc4fe=_0x5c26e4;[[exports['SparklineDataSourceModel']],[ae],[le],[oe],[ce],[ie],[se],[de]][_0x3dc4fe(0x1b0)](_0x24af28=>{const _0x5cda07=_0x3dc4fe;this[_0x5cda07(0x1dc)][_0x5cda07(0x1c1)](_0x24af28);}),l[_0x3dc4fe(0x10d)](this[_0x3dc4fe(0x1dc)],[[de]]);}[_0x5c26e4(0x113)](){const _0x1672a0=_0x5c26e4;l[_0x1672a0(0x10d)](this[_0x1672a0(0x1dc)],[[ae],[le],[oe],[ce],[ie],[se]]);}['_initRegisterCommand'](){const _0x1ad6eb=_0x5c26e4;[be,O,De,T,Ee,ue][_0x1ad6eb(0x1b0)](_0xae47db=>this[_0x1ad6eb(0x1ca)][_0x1ad6eb(0x141)](_0xae47db));}},Oe(exports[_0x5c26e4(0xfb)],_0x5c26e4(0x199),ke),Oe(exports[_0x5c26e4(0xfb)],_0x5c26e4(0x15f),l[_0x5c26e4(0x1c8)]['UNIVER_SHEET']),exports[_0x5c26e4(0xfb)]=st([l['DependentOn'](je[_0x5c26e4(0x1c2)]),Ie(0x1,l[_0x5c26e4(0x13c)](l[_0x5c26e4(0x1b5)])),Ie(0x2,l[_0x5c26e4(0x13c)](l[_0x5c26e4(0x117)]))],exports[_0x5c26e4(0xfb)]),exports['AddSheetSparklineCommand']=be,exports[_0x5c26e4(0x192)]=O,exports[_0x5c26e4(0x1d4)]=ke,exports[_0x5c26e4(0x16a)]=De,exports[_0x5c26e4(0x125)]=T,exports[_0x5c26e4(0xf5)]=Ee,exports[_0x5c26e4(0x1ac)]=ue,exports[_0x5c26e4(0x10e)]=H,exports[_0x5c26e4(0x10f)]=re,exports[_0x5c26e4(0x146)]=Pe,exports[_0x5c26e4(0x183)]=Se,exports[_0x5c26e4(0x104)]=me,exports['SparklineTypeEnum']=Ae,exports['getSparklinePlacement']=he;