const _0x3be869=_0x4a89;(function(_0x55ed3c,_0x29dcf3){const _0x289cb4=_0x4a89,_0x191baf=_0x55ed3c();while(!![]){try{const _0x4a468e=parseInt(_0x289cb4(0x253))/0x1*(-parseInt(_0x289cb4(0x211))/0x2)+-parseInt(_0x289cb4(0x1f0))/0x3+parseInt(_0x289cb4(0x21c))/0x4+parseInt(_0x289cb4(0x240))/0x5+-parseInt(_0x289cb4(0x28a))/0x6+parseInt(_0x289cb4(0x274))/0x7*(parseInt(_0x289cb4(0x1f2))/0x8)+-parseInt(_0x289cb4(0x1ef))/0x9*(-parseInt(_0x289cb4(0x246))/0xa);if(_0x4a468e===_0x29dcf3)break;else _0x191baf['push'](_0x191baf['shift']());}catch(_0x1de469){_0x191baf['push'](_0x191baf['shift']());}}}(_0x5162,0xd21ac));var qe=Object[_0x3be869(0x25e)],Qe=(_0x1160d0,_0x369bb5,_0x341d1d)=>_0x369bb5 in _0x1160d0?qe(_0x1160d0,_0x369bb5,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0x341d1d}):_0x1160d0[_0x369bb5]=_0x341d1d,se=(_0x3facc3,_0x47fe62,_0x4508be)=>Qe(_0x3facc3,typeof _0x47fe62!=_0x3be869(0x1fd)?_0x47fe62+'':_0x47fe62,_0x4508be);import{ObjectMatrix as _0x3722c9,Inject as _0x1342b4,IUniverInstanceService as _0x36b83f,Disposable as _0x175b87,isValidRange as _0x468a4c,CellValueType as _0x62c650,ColorKit as _0x1b0545,CommandType as _0x5d0b1b,Range as _0x480d40,IUndoRedoService as _0xd9c2c1,generateRandomId as _0x2343c8,ICommandService as _0x1e9e76,Tools as _0x59df96,sequenceExecute as _0x563cfa,Rectangle as _0x3357bc,cellToRange as _0x21e1c2,DisposableCollection as _0xcbe1f6,RANGE_TYPE as _0x4cac32,UniverInstanceType as _0x1a6a86,IResourceManagerService as _0x46e909,DependentOn as _0x436efd,Injector as _0x125d54,Plugin as _0x838a86,touchDependencies as _0x26905c}from'@univerjs/core';import{getSheetCommandTarget as _0x52cba3,SheetsSelectionsService as _0x4a197a,SheetInterceptorService as _0x1a12d6,ClearSelectionAllCommand as _0x3f2452,CopySheetCommand as _0xfed830,IExclusiveRangeService as _0x378bb7,SetRangeValuesMutation as _0x2ca30b,ReorderRangeMutation as _0x5b9697,SetRowHiddenMutation as _0x18037b,SetColHiddenMutation as _0x30e006,SetRowVisibleMutation as _0x5a5a10,SetColVisibleMutation as _0x1b9d8f,AddWorksheetMergeCommand as _0x12f2a8,RefRangeService as _0x3e204c,SetWorksheetActivateCommand as _0x4419f5,RemoveRowCommand as _0xf08bcd,RemoveColCommand as _0x5c867a,adjustRangeOnMutation as _0x5725da,RemoveRowMutation as _0x5e0d5f,RemoveColMutation as _0x391108,InsertColMutation as _0x1347b7,InsertRowMutation as _0x48db8e,MoveColsMutation as _0x14f2ba,MoveRowsMutation as _0x1ff2a4,MoveRangeMutation as _0x540ca1}from'@univerjs/sheets';import{Subject as _0x3bdfd7}from'rxjs';import{UniverLicensePlugin as _0x333cb0}from'@univerjs-pro/license';function Fe(_0x4ffbf2,_0x51ba1d){const _0x27e126=_0x3be869,_0x553e18=new _0x3722c9(),_0x2c9781=[],_0x1c1add=_0x4ffbf2['length']>0x1;let _0x4efd21=0x0,_0x484a4f=0x0;for(const _0x18c0c9 of _0x4ffbf2)_0x4efd21+=_0x18c0c9[_0x27e126(0x1f1)]-_0x18c0c9[_0x27e126(0x27f)]+0x1,_0x484a4f+=_0x18c0c9[_0x27e126(0x219)]-_0x18c0c9[_0x27e126(0x1f8)]+0x1;for(const _0x1ccb6e of _0x51ba1d)for(let _0x2f1397=_0x1ccb6e[_0x27e126(0x27f)];_0x2f1397<=_0x1ccb6e[_0x27e126(0x1f1)];_0x2f1397++)for(let _0x1d6bb3=_0x1ccb6e[_0x27e126(0x1f8)];_0x1d6bb3<=_0x1ccb6e[_0x27e126(0x219)];_0x1d6bb3++)_0x2c9781['push']({'row':_0x2f1397,'column':_0x1d6bb3});if(_0x2c9781[_0x27e126(0x233)]===_0x4efd21)_0x1c1add?_0x2c9781[_0x27e126(0x26a)]((_0x5c27f7,_0x36570d)=>{const _0xdbcb47=_0x27e126,_0x1a3ec2=_0x4ffbf2[_0x36570d],_0x2ec07a={'startRow':_0x1a3ec2['startRow'],'startColumn':_0x1a3ec2['startColumn'],'endRow':_0x1a3ec2[_0xdbcb47(0x27f)],'endColumn':_0x1a3ec2['endColumn']};_0x553e18[_0xdbcb47(0x22a)](_0x5c27f7[_0xdbcb47(0x284)],_0x5c27f7[_0xdbcb47(0x222)],_0x2ec07a);}):_0x2c9781[_0x27e126(0x26a)]((_0x51fe99,_0x5e936f)=>{const _0x37b685=_0x27e126,_0x4de369=_0x4ffbf2[0x0],_0x13873e={'startRow':_0x4de369[_0x37b685(0x27f)]+_0x5e936f,'startColumn':_0x4de369[_0x37b685(0x1f8)],'endRow':_0x4de369['startRow']+_0x5e936f,'endColumn':_0x4de369[_0x37b685(0x219)]};_0x553e18[_0x37b685(0x22a)](_0x51fe99[_0x37b685(0x284)],_0x51fe99['column'],_0x13873e);});else{if(_0x2c9781[_0x27e126(0x233)]===_0x484a4f)_0x1c1add?_0x2c9781[_0x27e126(0x26a)]((_0x196069,_0x290084)=>{const _0x3eeae4=_0x27e126,_0x565242=_0x4ffbf2[_0x290084],_0x189946={'startRow':_0x565242[_0x3eeae4(0x27f)],'startColumn':_0x565242['startColumn'],'endRow':_0x565242[_0x3eeae4(0x1f1)],'endColumn':_0x565242['startColumn']};_0x553e18[_0x3eeae4(0x22a)](_0x196069['row'],_0x196069[_0x3eeae4(0x222)],_0x189946);}):_0x2c9781[_0x27e126(0x26a)]((_0x4f908a,_0x24ce1a)=>{const _0x53d8ec=_0x27e126,_0x59d923=_0x4ffbf2[0x0],_0x396132={'startRow':_0x59d923['startRow'],'startColumn':_0x59d923[_0x53d8ec(0x1f8)]+_0x24ce1a,'endRow':_0x59d923[_0x53d8ec(0x1f1)],'endColumn':_0x59d923[_0x53d8ec(0x1f8)]+_0x24ce1a};_0x553e18[_0x53d8ec(0x22a)](_0x4f908a[_0x53d8ec(0x284)],_0x4f908a[_0x53d8ec(0x222)],_0x396132);});else{if(_0x2c9781[_0x27e126(0x233)]===_0x4ffbf2['length'])_0x4ffbf2[_0x27e126(0x1df)](_0x55d978=>!(_0x55d978['startRow']!==_0x55d978[_0x27e126(0x1f1)]&&_0x55d978[_0x27e126(0x1f8)]!==_0x55d978[_0x27e126(0x219)]))&&_0x2c9781['forEach']((_0x15a985,_0x197878)=>{const _0x442371=_0x27e126,_0x5154cc=_0x4ffbf2[_0x197878];_0x553e18[_0x442371(0x22a)](_0x15a985[_0x442371(0x284)],_0x15a985[_0x442371(0x222)],_0x5154cc);});else throw new Error(_0x27e126(0x27c));}}return _0x553e18;}const Ke=_0x3be869(0x1d7),Le={'standard':['rgb(54,78,244)',_0x3be869(0x20b)],'specialty':[_0x3be869(0x228),_0x3be869(0x206)],'distinctive':['rgb(124,66,147)','rgb(252,117,60)'],'soft':['rgb(80,102,248)',_0x3be869(0x256)],'fresh':[_0x3be869(0x1e1),_0x3be869(0x248)]},on=[_0x3be869(0x1e5),_0x3be869(0x25c),_0x3be869(0x200),_0x3be869(0x235),'negativePoint',_0x3be869(0x1d8)];var Xe=(_0x120dde=>(_0x120dde[_0x3be869(0x239)]='standard',_0x120dde['SPECIALTY']=_0x3be869(0x20d),_0x120dde[_0x3be869(0x1fa)]='distinctive',_0x120dde[_0x3be869(0x263)]='soft',_0x120dde[_0x3be869(0x26d)]=_0x3be869(0x254),_0x120dde[_0x3be869(0x273)]=_0x3be869(0x22b),_0x120dde))(Xe||{}),Dt=(_0x382c86=>(_0x382c86[_0x382c86[_0x3be869(0x232)]=0x1]=_0x3be869(0x232),_0x382c86[_0x382c86[_0x3be869(0x1ec)]=0x2]=_0x3be869(0x1ec),_0x382c86[_0x382c86[_0x3be869(0x282)]=0x3]=_0x3be869(0x282),_0x382c86[_0x382c86[_0x3be869(0x23d)]=0x4]='PIE_CHART',_0x382c86))(Dt||{}),J=(_0x188281=>(_0x188281['SPACING']=_0x3be869(0x212),_0x188281[_0x3be869(0x25a)]='zero_value',_0x188281[_0x3be869(0x210)]=_0x3be869(0x22f),_0x188281))(J||{}),De=(_0xf30e89=>(_0xf30e89[_0xf30e89['SELF_EXTREMUM']=0x1]=_0x3be869(0x278),_0xf30e89[_0xf30e89[_0x3be869(0x21f)]=0x2]=_0x3be869(0x21f),_0xf30e89[_0xf30e89[_0x3be869(0x245)]=0x3]=_0x3be869(0x245),_0xf30e89))(De||{}),Et=Object[_0x3be869(0x279)],Vt=(_0x1d43d2,_0x9e77cc,_0x39e68d,_0x158f87)=>{const _0x3cf928=_0x3be869;for(var _0x55d314=_0x158f87>0x1?void 0x0:_0x158f87?Et(_0x9e77cc,_0x39e68d):_0x9e77cc,_0x2b8460=_0x1d43d2[_0x3cf928(0x233)]-0x1,_0x1458af;_0x2b8460>=0x0;_0x2b8460--)(_0x1458af=_0x1d43d2[_0x2b8460])&&(_0x55d314=_0x1458af(_0x55d314)||_0x55d314);return _0x55d314;},yt=(_0x386731,_0x2dc1b9)=>(_0x185377,_0x214ec0)=>_0x2dc1b9(_0x185377,_0x214ec0,_0x386731);let x=class extends _0x175b87{constructor(_0x339753){const _0xf70fa8=_0x3be869;super(),se(this,_0xf70fa8(0x270),new Map()),se(this,_0xf70fa8(0x242),new Map()),se(this,_0xf70fa8(0x1d6),new _0x3bdfd7()),se(this,_0xf70fa8(0x1ee),this[_0xf70fa8(0x1d6)][_0xf70fa8(0x1f4)]()),this[_0xf70fa8(0x27b)]=_0x339753;}[_0x3be869(0x280)](_0x329965,_0x1dc89e){const _0x2cd2cc=_0x3be869;let _0x1a0238=this['_sparklineModel'][_0x2cd2cc(0x257)](_0x329965);_0x1a0238||(_0x1a0238=new Map(),this[_0x2cd2cc(0x270)][_0x2cd2cc(0x215)](_0x329965,_0x1a0238));let _0x557fe5=_0x1a0238['get'](_0x1dc89e);return _0x557fe5||(_0x557fe5=new Map(),_0x1a0238[_0x2cd2cc(0x215)](_0x1dc89e,_0x557fe5)),_0x557fe5;}['_ensureAnchorMatrix'](_0x5c37a3,_0x5ad864){const _0x3efa65=_0x3be869;let _0x5521aa=this[_0x3efa65(0x242)][_0x3efa65(0x257)](_0x5c37a3);_0x5521aa||(_0x5521aa=new Map(),this[_0x3efa65(0x242)][_0x3efa65(0x215)](_0x5c37a3,_0x5521aa));let _0x394d6=_0x5521aa['get'](_0x5ad864);return _0x394d6||(_0x394d6={'matrix':new _0x3722c9(),'extra':{}},_0x5521aa[_0x3efa65(0x215)](_0x5ad864,_0x394d6)),_0x394d6;}[_0x3be869(0x24e)](_0xc0b2d9,_0x46d7cd,_0x216201,_0x5366b3=_0x3be869(0x215)){const _0x1589fd=_0x3be869;var _0x9d002b,_0x23dd91,_0x55e543,_0x5d8015,_0x125e7c,_0x161642,_0x4519af,_0x580b6b,_0x535b1c,_0x2aa102,_0x6bca1d,_0x127b71,_0x3a3cf2;const _0x5db668=(_0x23dd91=(_0x9d002b=this['_sparklineModel']['get'](_0xc0b2d9))==null?void 0x0:_0x9d002b[_0x1589fd(0x257)](_0x46d7cd))==null?void 0x0:_0x23dd91[_0x1589fd(0x257)](_0x216201);if(!_0x5db668)return;const _0x4c5ae1=_0x52cba3(this[_0x1589fd(0x27b)],{'unitId':_0xc0b2d9,'subUnitId':_0x46d7cd});if(!_0x4c5ae1)return;const _0x3268a7=this['_ensureAnchorMatrix'](_0xc0b2d9,_0x46d7cd),{extra:_0x1f6107,matrix:_0x323ef6}=_0x3268a7,{worksheet:_0x32d65c}=_0x4c5ae1;let _0x30751f=Number[_0x1589fd(0x226)],_0x21d7b1=Number[_0x1589fd(0x286)];const _0x374c12=(_0x55e543=_0x5db668[_0x1589fd(0x230)][_0x1589fd(0x224)])!=null?_0x55e543:!0x1;_0x5db668[_0x1589fd(0x26f)]['forValue']((_0x2e8a6b,_0x419fdb,_0x267540)=>{const _0x17d539=_0x1589fd;var _0x16bb12,_0x1b455b,_0x1c952f;const _0x4a96e5=_0x267540;let _0x40cf66=Number[_0x17d539(0x226)],_0x43fb10=Number[_0x17d539(0x286)],_0x3df8d2=0x0,_0x3e76df=0x0;const _0x423062=[];if(!_0x468a4c(_0x4a96e5))_0x323ef6['setValue'](_0x2e8a6b,_0x419fdb,{'groupId':_0x216201,'data':[],'max':_0x40cf66,'min':_0x43fb10,'highIndex':_0x3df8d2,'lowIndex':_0x3e76df,'negativeIndexes':_0x423062});else{const _0x7ee837=[];for(let _0x2cdedd=_0x4a96e5[_0x17d539(0x27f)];_0x2cdedd<=_0x4a96e5[_0x17d539(0x1f1)];_0x2cdedd++){for(let _0x42b5ee=_0x4a96e5['startColumn'];_0x42b5ee<=_0x4a96e5[_0x17d539(0x219)];_0x42b5ee++){const _0x488187=_0x32d65c[_0x17d539(0x1dc)](_0x2cdedd),_0x37581a=_0x32d65c['getColVisible'](_0x42b5ee);if(!_0x374c12&&(!_0x488187||!_0x37581a))continue;let _0x2a9756=0x0;const _0x4f20ef=((_0x16bb12=_0x32d65c['getCellRaw'](_0x2cdedd,_0x42b5ee))==null?void 0x0:_0x16bb12['v'])!==void 0x0?_0x32d65c[_0x17d539(0x268)](_0x2cdedd,_0x42b5ee):_0x32d65c[_0x17d539(0x28d)](_0x2cdedd,_0x42b5ee);if(!_0x4f20ef||_0x4f20ef['v']===void 0x0||_0x4f20ef['v']===null){const _0x51ada7=(_0x1b455b=_0x5db668[_0x17d539(0x230)][_0x17d539(0x267)])!=null?_0x1b455b:J[_0x17d539(0x1e8)];_0x51ada7===J[_0x17d539(0x25a)]?_0x2a9756=0x0:_0x51ada7===J[_0x17d539(0x1e8)]?_0x2a9756=_0x17d539(0x1eb):_0x51ada7===J[_0x17d539(0x210)]&&(_0x2a9756=_0x17d539(0x1dd));}else{if(_0x4f20ef['t']===_0x62c650[_0x17d539(0x24c)]||_0x4f20ef['t']===_0x62c650['FORCE_STRING']){const _0x17790a=(_0x1c952f=_0x5db668[_0x17d539(0x230)][_0x17d539(0x23f)])!=null?_0x1c952f:J['SPACING'];_0x17790a===J[_0x17d539(0x25a)]?_0x2a9756=0x0:_0x17790a===J[_0x17d539(0x1e8)]?_0x2a9756=_0x17d539(0x1eb):_0x17790a===J[_0x17d539(0x210)]&&(_0x2a9756=_0x17d539(0x1dd));}else _0x4f20ef['t']===_0x62c650[_0x17d539(0x25f)]?_0x2a9756=_0x4f20ef['v']?0x1:0x0:_0x4f20ef['t']===_0x62c650[_0x17d539(0x285)]?_0x2a9756=Number(_0x4f20ef['v']):_0x2a9756=_0x4f20ef['v'];}if(_0x7ee837[_0x17d539(0x28f)](_0x2a9756),typeof _0x2a9756=='number'){_0x40cf66=Math[_0x17d539(0x20f)](_0x40cf66,_0x2a9756),_0x30751f=Math[_0x17d539(0x20f)](_0x30751f,_0x2a9756),_0x21d7b1=Math['min'](_0x21d7b1,_0x2a9756),_0x43fb10=Math[_0x17d539(0x258)](_0x43fb10,_0x2a9756);const _0x3a9d43=typeof _0x7ee837[_0x3df8d2]==_0x17d539(0x201)?Number(_0x7ee837[_0x3df8d2]):Number[_0x17d539(0x226)];_0x2a9756>_0x3a9d43&&(_0x3df8d2=_0x7ee837[_0x17d539(0x233)]-0x1);const _0x2f98ee=typeof _0x7ee837[_0x3e76df]=='number'?Number(_0x7ee837[_0x3e76df]):Number[_0x17d539(0x286)];_0x2a9756<_0x2f98ee&&(_0x3e76df=_0x7ee837[_0x17d539(0x233)]-0x1),_0x2a9756<0x0&&_0x423062[_0x17d539(0x28f)](_0x7ee837['length']-0x1);}}_0x323ef6['setValue'](_0x2e8a6b,_0x419fdb,{'groupId':_0x216201,'data':_0x7ee837,'max':_0x40cf66,'min':_0x43fb10,'highIndex':_0x3df8d2,'lowIndex':_0x3e76df,'negativeIndexes':_0x423062});}}});let _0x1a21c9=_0x30751f;((_0x5d8015=_0x5db668['config'][_0x1589fd(0x237)])==null?void 0x0:_0x5d8015[_0x1589fd(0x21d)])===De[_0x1589fd(0x245)]&&(_0x1a21c9=(_0x161642=(_0x125e7c=_0x5db668['config'][_0x1589fd(0x237)])==null?void 0x0:_0x125e7c[_0x1589fd(0x1e2)])!=null?_0x161642:_0x30751f);let _0x49dc83=_0x21d7b1;((_0x4519af=_0x5db668[_0x1589fd(0x230)][_0x1589fd(0x21e)])==null?void 0x0:_0x4519af[_0x1589fd(0x21d)])===De['CUSTOM_EXTREMUM']&&(_0x49dc83=(_0x535b1c=(_0x580b6b=_0x5db668[_0x1589fd(0x230)][_0x1589fd(0x21e)])==null?void 0x0:_0x580b6b[_0x1589fd(0x1e2)])!=null?_0x535b1c:_0x21d7b1);const _0x332c9f=(_0x2aa102=_0x5db668[_0x1589fd(0x230)][_0x1589fd(0x264)])!=null?_0x2aa102:Xe[_0x1589fd(0x239)],_0x4ab460=(_0x3a3cf2=(_0x127b71=_0x5db668['config'][_0x1589fd(0x259)])!=null?_0x127b71:(_0x6bca1d=Le[_0x332c9f])==null?void 0x0:_0x6bca1d[0x0])!=null?_0x3a3cf2:Le[_0x1589fd(0x217)][0x0],_0x145c8c=new _0x1b0545(_0x4ab460),_0x56b279=_0x145c8c[_0x1589fd(0x244)](0.2)[_0x1589fd(0x28c)](),_0x18a984=_0x145c8c[_0x1589fd(0x244)](0.05)[_0x1589fd(0x28c)]();_0x1f6107[_0x216201]={'groupMax':_0x30751f,'groupMin':_0x21d7b1,'showMax':_0x1a21c9,'showMin':_0x49dc83,'startGradient':_0x56b279,'endGradient':_0x18a984},this['_updateConfig$']['next']({'unitId':_0xc0b2d9,'subUnitId':_0x46d7cd,'groupId':_0x216201,'config':_0x5db668,'type':_0x5366b3});}[_0x3be869(0x1ff)](_0x1ce819,_0x2d07cc,_0x2c0412,_0x45dc95){const _0x3447bf=_0x3be869;this[_0x3447bf(0x280)](_0x1ce819,_0x2d07cc)[_0x3447bf(0x215)](_0x2c0412,_0x45dc95),this['updateSparklineExtraNum'](_0x1ce819,_0x2d07cc,_0x2c0412,'add');}['setSparkline'](_0x66f4b,_0x5cf680,_0x3fb1a7,_0x3d62b9){const _0x275ba0=_0x3be869;var _0x511e17;const _0x6c5079=(_0x511e17=this[_0x275ba0(0x270)][_0x275ba0(0x257)](_0x66f4b))==null?void 0x0:_0x511e17['get'](_0x5cf680);_0x3fb1a7[_0x275ba0(0x26a)](_0x2f15ca=>{const _0x45bfaa=_0x275ba0;_0x6c5079!=null&&_0x6c5079[_0x45bfaa(0x1e9)](_0x2f15ca)&&(_0x6c5079['set'](_0x2f15ca,_0x3d62b9),this[_0x45bfaa(0x24e)](_0x66f4b,_0x5cf680,_0x2f15ca));});}[_0x3be869(0x1e4)](_0x34956a,_0x144db2,_0x1d1565){const _0xd55555=_0x3be869;var _0x3f163b,_0x5d967c;const _0x3a8cb2=this[_0xd55555(0x270)][_0xd55555(0x257)](_0x34956a);if(_0x3a8cb2){const _0x5837e6=_0x3a8cb2[_0xd55555(0x257)](_0x144db2);if(_0x5837e6){_0x5837e6['delete'](_0x1d1565);const _0x43728f=(_0x3f163b=this[_0xd55555(0x242)][_0xd55555(0x257)](_0x34956a))==null?void 0x0:_0x3f163b[_0xd55555(0x257)](_0x144db2);(_0x5d967c=_0x43728f==null?void 0x0:_0x43728f['matrix'])==null||_0x5d967c[_0xd55555(0x1fe)]((_0x108aec,_0x45db9c,_0x35a0f3)=>{const _0xfa4122=_0xd55555;(_0x35a0f3==null?void 0x0:_0x35a0f3[_0xfa4122(0x227)])===_0x1d1565&&(_0x43728f==null||_0x43728f[_0xfa4122(0x27d)][_0xfa4122(0x262)](_0x108aec,_0x45db9c));}),this[_0xd55555(0x1d6)][_0xd55555(0x24d)]({'unitId':_0x34956a,'subUnitId':_0x144db2,'groupId':_0x1d1565,'type':_0xd55555(0x22c)});}}}['removePartSparkline'](_0x5eaa51,_0x1ea578,_0x320d26,_0x35aee8){const _0x75ac60=_0x3be869;var _0x10c49d,_0x1f118f,_0x5e5458,_0x19ff3d;const _0x2f42a8=(_0x10c49d=this[_0x75ac60(0x242)][_0x75ac60(0x257)](_0x5eaa51))==null?void 0x0:_0x10c49d[_0x75ac60(0x257)](_0x1ea578),_0x4f7a58=_0x2f42a8==null?void 0x0:_0x2f42a8[_0x75ac60(0x27d)][_0x75ac60(0x283)](_0x320d26,_0x35aee8);if(_0x4f7a58){const {groupId:_0x8a2a86}=_0x4f7a58,_0x5d527d=(_0x1f118f=this[_0x75ac60(0x270)][_0x75ac60(0x257)](_0x5eaa51))==null?void 0x0:_0x1f118f[_0x75ac60(0x257)](_0x1ea578);(_0x5e5458=_0x5d527d==null?void 0x0:_0x5d527d['get'](_0x8a2a86))==null||_0x5e5458[_0x75ac60(0x26f)][_0x75ac60(0x262)](_0x320d26,_0x35aee8),(_0x19ff3d=_0x5d527d==null?void 0x0:_0x5d527d['get'](_0x8a2a86))!=null&&_0x19ff3d['sparklines']['hasValue']()||_0x5d527d==null||_0x5d527d[_0x75ac60(0x1e0)](_0x8a2a86),_0x2f42a8==null||_0x2f42a8['matrix'][_0x75ac60(0x262)](_0x320d26,_0x35aee8),this[_0x75ac60(0x1d6)]['next']({'unitId':_0x5eaa51,'subUnitId':_0x1ea578,'groupId':_0x8a2a86,'type':_0x75ac60(0x22c)});}}[_0x3be869(0x277)](_0x1ae662,_0x412437,_0x9e7b88){const _0x90494c=_0x3be869;var _0x26f5a4,_0x40c4e1,_0x3440fc,_0x3aded8;const _0x1da317=(_0x3440fc=(_0x40c4e1=(_0x26f5a4=this[_0x90494c(0x270)][_0x90494c(0x257)](_0x1ae662))==null?void 0x0:_0x26f5a4[_0x90494c(0x257)](_0x412437))==null?void 0x0:_0x40c4e1[_0x90494c(0x257)](_0x9e7b88))==null?void 0x0:_0x3440fc[_0x90494c(0x26f)],_0x254c2c=(_0x3aded8=this['_sparklineAnchorMap'][_0x90494c(0x257)](_0x1ae662))==null?void 0x0:_0x3aded8[_0x90494c(0x257)](_0x412437);if(_0x1da317&&_0x254c2c){const {matrix:_0x1a1284,extra:_0x48864d}=_0x254c2c;_0x1da317[_0x90494c(0x1fe)]((_0x4c1ff9,_0x3a7964,_0x118d85)=>{const _0x2da113=_0x90494c;_0x1a1284[_0x2da113(0x262)](_0x4c1ff9,_0x3a7964);}),delete _0x48864d[_0x9e7b88];}}['getSubUnitSparkline'](_0xe4289a,_0x18ccc2){const _0x128aab=_0x3be869;var _0x70373c;return(_0x70373c=this['_sparklineModel'][_0x128aab(0x257)](_0xe4289a))==null?void 0x0:_0x70373c[_0x128aab(0x257)](_0x18ccc2);}[_0x3be869(0x231)](_0x34b5b5,_0x17078c,_0x16804e){const _0x580a20=_0x3be869;var _0x3f90ca,_0x53a3fd;return(_0x53a3fd=(_0x3f90ca=this[_0x580a20(0x270)][_0x580a20(0x257)](_0x34b5b5))==null?void 0x0:_0x3f90ca[_0x580a20(0x257)](_0x17078c))==null?void 0x0:_0x53a3fd['get'](_0x16804e);}[_0x3be869(0x207)](_0xdbf831,_0x414f93,_0x19b649,_0x4b98e2){const _0x48217b=_0x3be869;var _0x301303,_0x856226,_0x561325;return(_0x561325=(_0x856226=(_0x301303=this[_0x48217b(0x242)]['get'](_0xdbf831))==null?void 0x0:_0x301303[_0x48217b(0x257)](_0x414f93))==null?void 0x0:_0x856226[_0x48217b(0x27d)]['getValue'](_0x19b649,_0x4b98e2))==null?void 0x0:_0x561325[_0x48217b(0x227)];}[_0x3be869(0x21a)](_0x203e5c,_0x50287b){const _0x4cac84=_0x3be869;var _0x433c0e;const _0x3d971f=this[_0x4cac84(0x261)](_0x203e5c,_0x50287b);_0x3d971f[_0x4cac84(0x27d)]['forValue']((_0x5da864,_0x3626fd)=>{const _0x285940=_0x4cac84;_0x3d971f[_0x285940(0x27d)][_0x285940(0x262)](_0x5da864,_0x3626fd);});const _0x549a8d=(_0x433c0e=this[_0x4cac84(0x270)][_0x4cac84(0x257)](_0x203e5c))==null?void 0x0:_0x433c0e['get'](_0x50287b);if(_0x549a8d){for(const [_0x55c088]of _0x549a8d)this[_0x4cac84(0x24e)](_0x203e5c,_0x50287b,_0x55c088);}}['getSparklineCache'](){const _0x194c75=_0x3be869;return{'sparklineModel':this['_sparklineModel'],'sparklineAnchorMap':this[_0x194c75(0x242)]};}[_0x3be869(0x290)](_0x105f8a){const _0x276034=_0x3be869,_0x4a6f71={};if(this[_0x276034(0x270)][_0x276034(0x1e9)](_0x105f8a)){_0x4a6f71[_0x105f8a]={};const _0xe2701f=this[_0x276034(0x270)][_0x276034(0x257)](_0x105f8a);_0xe2701f!=null&&_0xe2701f[_0x276034(0x236)]&&Array['from'](_0xe2701f['keys']())[_0x276034(0x26a)](_0x10cb3e=>{const _0x55cbc2=_0x276034;_0x4a6f71[_0x105f8a][_0x10cb3e]={};const _0x2b4403=_0xe2701f[_0x55cbc2(0x257)](_0x10cb3e);_0x2b4403!=null&&_0x2b4403['size']&&Array['from'](_0x2b4403['keys']())[_0x55cbc2(0x26a)](_0x36aaaa=>{const _0x56e0b5=_0x55cbc2,_0x238a17=_0x2b4403[_0x56e0b5(0x257)](_0x36aaaa);_0x238a17&&(_0x4a6f71[_0x105f8a][_0x10cb3e][_0x36aaaa]={'config':_0x238a17[_0x56e0b5(0x230)],'sparklines':_0x238a17[_0x56e0b5(0x26f)][_0x56e0b5(0x272)]()});});});}return _0x4a6f71;}[_0x3be869(0x28b)](_0x5a235d){const _0xc78d5c=_0x3be869;if(!_0x5a235d)return;Object[_0xc78d5c(0x249)](_0x5a235d)[_0xc78d5c(0x26a)](_0x4fd2b1=>{const _0x48ce3f=_0xc78d5c,_0x31da57=_0x5a235d[_0x4fd2b1];_0x31da57&&Object[_0x48ce3f(0x249)](_0x31da57)['forEach'](_0x4cbf4e=>{const _0x1cc441=_0x48ce3f,_0x9b5149=_0x31da57[_0x4cbf4e];_0x9b5149&&Object[_0x1cc441(0x249)](_0x9b5149)[_0x1cc441(0x26a)](_0x1ec194=>{const _0x4030a7=_0x1cc441,_0x47cd29=_0x9b5149[_0x1ec194];if(_0x47cd29){const _0x56d742={'config':_0x47cd29['config'],'sparklines':new _0x3722c9(_0x47cd29[_0x4030a7(0x26f)])};this['addSparkline'](_0x4fd2b1,_0x4cbf4e,_0x1ec194,_0x56d742);}});});});}[_0x3be869(0x266)](_0x33f1b1){const _0x15b94a=_0x3be869,_0x2090b1=this[_0x15b94a(0x270)][_0x15b94a(0x257)](_0x33f1b1);if(_0x2090b1){for(const [_0x3d22c8]of _0x2090b1){const _0x5c7420=_0x2090b1[_0x15b94a(0x257)](_0x3d22c8);if(_0x5c7420){for(const [_0x454271]of _0x5c7420)this[_0x15b94a(0x277)](_0x33f1b1,_0x3d22c8,_0x454271);}}this[_0x15b94a(0x270)][_0x15b94a(0x1e0)](_0x33f1b1);}}};x=Vt([yt(0x0,_0x1342b4(_0x36b83f))],x);const V={'id':_0x3be869(0x220),'type':_0x5d0b1b[_0x3be869(0x271)],'handler':(_0x3451f9,_0x1fb4b0)=>{const _0x170c96=_0x3be869;if(!_0x1fb4b0)return!0x1;const {sparklineConfigMap:_0xa60dd1,unitId:_0x45bb9b,subUnitId:_0x259261}=_0x1fb4b0,_0x432152=_0x3451f9[_0x170c96(0x257)](x);return Object['entries'](_0xa60dd1)[_0x170c96(0x26a)](([_0x5ea633,_0x487a68])=>{const _0x4bd450=_0x170c96,_0x5e6006={'config':_0x487a68[_0x4bd450(0x230)],'sparklines':new _0x3722c9(_0x487a68[_0x4bd450(0x26f)])};_0x432152['addSparkline'](_0x45bb9b,_0x259261,_0x5ea633,_0x5e6006);}),!0x0;}},y={'id':_0x3be869(0x234),'type':_0x5d0b1b['MUTATION'],'handler':(_0x1e72fa,_0x198b24)=>{const _0x38fb4f=_0x3be869;if(!_0x198b24)return!0x1;const {unitId:_0x3d186f,subUnitId:_0x1408ec,ranges:_0x3937d4,isSingle:_0x317320,groupIds:_0x10483d}=_0x198b24,_0x212293=_0x1e72fa[_0x38fb4f(0x257)](x);return _0x10483d?(_0x10483d['forEach'](_0x337881=>{_0x212293['removeSparkline'](_0x3d186f,_0x1408ec,_0x337881);}),!0x0):_0x3937d4?(_0x3937d4[_0x38fb4f(0x26a)](_0x263ca7=>{const _0x324ee1=_0x38fb4f;_0x480d40[_0x324ee1(0x23e)](_0x263ca7,(_0x3d309e,_0x46697a)=>{const _0x22ddfb=_0x324ee1,_0x2a33b9=_0x212293[_0x22ddfb(0x207)](_0x3d186f,_0x1408ec,_0x3d309e,_0x46697a);_0x2a33b9&&(_0x317320?_0x212293[_0x22ddfb(0x276)](_0x3d186f,_0x1408ec,_0x3d309e,_0x46697a):_0x212293[_0x22ddfb(0x1e4)](_0x3d186f,_0x1408ec,_0x2a33b9));});}),!0x0):!0x1;}},Nt={'id':_0x3be869(0x223),'type':_0x5d0b1b['COMMAND'],'handler':(_0xbcd58f,_0x2df9c3)=>{const _0x5f11f6=_0x3be869;if(!_0x2df9c3)return!0x1;const {sourceRanges:_0x420e0e,targetRanges:_0x39584e,config:_0x5b99ce}=_0x2df9c3,_0x148e7b=_0xbcd58f[_0x5f11f6(0x257)](_0xd9c2c1),_0x11dfc9='g_'+_0x2343c8(0x6),_0x45a9e1=Fe(_0x420e0e,_0x39584e),_0x202da6={'config':_0x5b99ce!=null?_0x5b99ce:{},'sparklines':_0x45a9e1[_0x5f11f6(0x272)]()},_0x4d8ecd=_0xbcd58f[_0x5f11f6(0x257)](_0x36b83f),_0x976a47=_0xbcd58f[_0x5f11f6(0x257)](x),_0x53d03e=_0x52cba3(_0x4d8ecd);if(!_0x53d03e)return!0x1;const {unitId:_0x5c3f4d,subUnitId:_0x347094}=_0x53d03e,_0x4d106b=_0xbcd58f['get'](_0x1e9e76),_0x117579=[],_0x494862=[],_0x36cdcf={},_0x371a1f={},_0x3449bf=new Set([_0x11dfc9]);_0x45a9e1['forValue']((_0x12666d,_0x487ebb,_0x1540d7)=>{const _0x91953a=_0x5f11f6,_0x46c633=_0x976a47[_0x91953a(0x207)](_0x5c3f4d,_0x347094,_0x12666d,_0x487ebb);if(_0x46c633){const _0x3c3245=_0x976a47[_0x91953a(0x231)](_0x5c3f4d,_0x347094,_0x46c633);if(_0x3c3245){_0x3449bf['add'](_0x46c633);let _0x3924d1=_0x36cdcf[_0x46c633],_0x1f6aed=_0x371a1f[_0x46c633];_0x1f6aed||(_0x1f6aed={'config':_0x59df96[_0x91953a(0x1fb)](_0x3c3245[_0x91953a(0x230)]),'sparklines':new _0x3722c9(_0x3c3245[_0x91953a(0x26f)][_0x91953a(0x1fc)]())},_0x371a1f[_0x46c633]=_0x1f6aed),_0x3924d1||(_0x3924d1={'config':_0x59df96[_0x91953a(0x1fb)](_0x3c3245[_0x91953a(0x230)]),'sparklines':_0x3c3245['sparklines'][_0x91953a(0x1fc)]()},_0x36cdcf[_0x46c633]=_0x3924d1),_0x1f6aed[_0x91953a(0x26f)][_0x91953a(0x262)](_0x12666d,_0x487ebb);}}});const _0x7f1529={};return Object[_0x5f11f6(0x24f)](_0x371a1f)[_0x5f11f6(0x26a)](([_0x5ea465,_0x1422fc])=>{const _0x2034ea=_0x5f11f6;_0x1422fc[_0x2034ea(0x26f)]['getSizeOf']()&&(_0x7f1529[_0x5ea465]={'config':_0x1422fc[_0x2034ea(0x230)],'sparklines':_0x1422fc[_0x2034ea(0x26f)][_0x2034ea(0x1fc)]()});}),_0x7f1529[_0x11dfc9]=_0x202da6,_0x117579[_0x5f11f6(0x28f)]({'id':y['id'],'params':{'unitId':_0x5c3f4d,'subUnitId':_0x347094,'groupIds':Array[_0x5f11f6(0x20c)](_0x3449bf),'isSingle':!0x1}}),_0x3449bf['size']>0x1&&(_0x494862[_0x5f11f6(0x28f)]({'id':y['id'],'params':{'unitId':_0x5c3f4d,'subUnitId':_0x347094,'groupIds':Array[_0x5f11f6(0x20c)](_0x3449bf),'isSingle':!0x1}}),_0x117579[_0x5f11f6(0x28f)]({'id':V['id'],'params':{'unitId':_0x5c3f4d,'subUnitId':_0x347094,'sparklineConfigMap':_0x36cdcf}})),_0x494862['push']({'id':V['id'],'params':{'unitId':_0x5c3f4d,'subUnitId':_0x347094,'sparklineConfigMap':_0x7f1529}}),_0x563cfa(_0x494862,_0x4d106b),_0x148e7b[_0x5f11f6(0x255)]({'unitID':_0x5c3f4d,'undoMutations':_0x117579,'redoMutations':_0x494862}),!0x0;}},Ot={'id':_0x3be869(0x1d9),'type':_0x5d0b1b[_0x3be869(0x260)],'handler':(_0x4182ea,_0x213cee)=>{const _0xfe10f1=_0x3be869;var _0x4d562d;const {isSingle:_0x468cb1=!0x0}=_0x213cee||{},_0xcfd6d0=_0x4182ea[_0xfe10f1(0x257)](_0x1e9e76),_0x473061=_0x4182ea['get'](_0x36b83f),_0x1ebaea=_0x4182ea[_0xfe10f1(0x257)](x),_0x3d75a3=_0x4182ea[_0xfe10f1(0x257)](_0xd9c2c1),_0x169835=_0x52cba3(_0x473061);if(!_0x169835)return!0x1;const _0xa8d7ae=_0x4182ea[_0xfe10f1(0x257)](_0x4a197a),_0x31a387=(_0x4d562d=_0x213cee==null?void 0x0:_0x213cee[_0xfe10f1(0x1f5)])!=null?_0x4d562d:_0xa8d7ae['getCurrentSelections']()['map'](_0x1602e4=>_0x1602e4[_0xfe10f1(0x205)]),{unitId:_0x3df5ba,subUnitId:_0x53e85c}=_0x169835,_0x34ab8a=[],_0x272e=[];_0x34ab8a[_0xfe10f1(0x28f)]({'id':y['id'],'params':{'unitId':_0x3df5ba,'subUnitId':_0x53e85c,'ranges':_0x31a387,'isSingle':_0x468cb1}});const _0x246756=[],_0x452e8f={};return _0x31a387[_0xfe10f1(0x26a)](_0x4f8f03=>{const _0x3f907c=_0xfe10f1;_0x480d40[_0x3f907c(0x23e)](_0x4f8f03,(_0x4867c9,_0x371356)=>{const _0x379b88=_0x3f907c,_0x2cd9b3=_0x1ebaea[_0x379b88(0x207)](_0x3df5ba,_0x53e85c,_0x4867c9,_0x371356);if(_0x2cd9b3){const _0x4daaf7=_0x1ebaea['getSparklineById'](_0x3df5ba,_0x53e85c,_0x2cd9b3);_0x4daaf7&&(_0x246756[_0x379b88(0x28f)](_0x2cd9b3),_0x452e8f[_0x2cd9b3]={'config':_0x59df96[_0x379b88(0x1fb)](_0x4daaf7[_0x379b88(0x230)]),'sparklines':_0x59df96[_0x379b88(0x1fb)](_0x4daaf7['sparklines'][_0x379b88(0x1fc)]())});}});}),_0x272e[_0xfe10f1(0x28f)]({'id':y['id'],'params':{'unitId':_0x3df5ba,'subUnitId':_0x53e85c,'groupIds':_0x246756,'isSingle':!0x1}}),_0x272e[_0xfe10f1(0x28f)]({'id':V['id'],'params':{'unitId':_0x3df5ba,'subUnitId':_0x53e85c,'sparklineConfigMap':_0x452e8f}}),_0x563cfa(_0x34ab8a,_0xcfd6d0),_0x3d75a3['pushUndoRedo']({'unitID':_0x3df5ba,'undoMutations':_0x272e,'redoMutations':_0x34ab8a}),!0x0;}},Oe={'id':'sheet.mutation.set-sparkline','type':_0x5d0b1b[_0x3be869(0x271)],'handler':(_0x513f65,_0x58daa5)=>{const _0x55d787=_0x3be869;if(!_0x58daa5)return!0x1;const {unitId:_0x443cb6,subUnitId:_0x3ad84f,groupIds:_0x207519,config:_0x1a4405}=_0x58daa5,_0x295d4e=_0x513f65[_0x55d787(0x257)](x);return _0x207519['forEach'](_0x7631e7=>{const _0x374995=_0x55d787,_0x4e5a59=_0x295d4e[_0x374995(0x231)](_0x443cb6,_0x3ad84f,_0x7631e7);if(_0x4e5a59){const _0x4332ed={'config':Object[_0x374995(0x203)]({},_0x4e5a59['config'],_0x1a4405[_0x374995(0x230)]),'sparklines':new _0x3722c9(_0x4e5a59[_0x374995(0x26f)][_0x374995(0x1fc)]())};_0x295d4e[_0x374995(0x24a)](_0x443cb6,_0x3ad84f,[_0x7631e7],_0x4332ed);}}),!0x0;}},xt={'id':_0x3be869(0x250),'type':_0x5d0b1b['COMMAND'],'handler':(_0x265e7d,_0xc2f008)=>{const _0x4de519=_0x3be869;var _0x139f5b,_0x5cb77d,_0x55738d,_0x4b6259;if(!_0xc2f008)return!0x1;const _0x2e6d01=_0x265e7d[_0x4de519(0x257)](_0x1e9e76),_0x292adc=_0x265e7d['get'](_0x4a197a),_0x2fe4a9=_0x265e7d[_0x4de519(0x257)](x),_0x2f7d11=_0x265e7d[_0x4de519(0x257)](_0x36b83f),_0xc2cf2e=_0x265e7d[_0x4de519(0x257)](_0xd9c2c1),_0x5c5052=_0x52cba3(_0x2f7d11);if(!_0x5c5052)return!0x1;const {unitId:_0x4a6876,subUnitId:_0x5b2f73}=_0x5c5052,_0x3dea95=(_0x139f5b=_0xc2f008==null?void 0x0:_0xc2f008['ranges'])!=null?_0x139f5b:_0x292adc['getCurrentSelections']()['map'](_0x3f39e3=>_0x3f39e3[_0x4de519(0x205)]),_0x201279=(_0x5cb77d=_0x2fe4a9[_0x4de519(0x1ed)]()[_0x4de519(0x27a)]['get'](_0x4a6876))==null?void 0x0:_0x5cb77d[_0x4de519(0x257)](_0x5b2f73),{isChangeDataSource:_0x1e0531,config:_0x462ee1,combine:_0x2394cc,unCombine:_0x38cc97}=_0xc2f008;if(_0x2394cc){const _0x281729=[],_0x4ab607=[];_0x281729[_0x4de519(0x28f)]({'id':y['id'],'params':{'unitId':_0x4a6876,'subUnitId':_0x5b2f73,'ranges':_0x3dea95,'isSingle':!0x0}});const _0x36588b='g_'+_0x2343c8(0x6),_0xa36037=new _0x3722c9(),_0x566da5=(_0x55738d=_0x2fe4a9[_0x4de519(0x1ed)]()[_0x4de519(0x238)]['get'](_0x4a6876))==null?void 0x0:_0x55738d['get'](_0x5b2f73),_0x4e37f=new Set([_0x36588b]),_0x32e5a4={};return _0x3dea95['forEach'](_0x26c714=>{const _0x11c755=_0x4de519;var _0x550111,_0x404184;const {startRow:_0x28924b,endRow:_0x2c9e83,startColumn:_0x5107a2,endColumn:_0x492f03}=_0x26c714;for(let _0x471b6a=_0x28924b;_0x471b6a<=_0x2c9e83;_0x471b6a++)for(let _0x3e99c0=_0x5107a2;_0x3e99c0<=_0x492f03;_0x3e99c0++){const _0x37b9d3=(_0x550111=_0x201279==null?void 0x0:_0x201279['matrix'][_0x11c755(0x283)](_0x471b6a,_0x3e99c0))==null?void 0x0:_0x550111[_0x11c755(0x227)];if(_0x37b9d3){_0x4e37f[_0x11c755(0x269)](_0x37b9d3);const _0x4adbf9=_0x2fe4a9[_0x11c755(0x231)](_0x4a6876,_0x5b2f73,_0x37b9d3);_0x4adbf9&&(_0x32e5a4[_0x37b9d3]={'config':_0x59df96[_0x11c755(0x1fb)](_0x4adbf9[_0x11c755(0x230)]),'sparklines':_0x59df96[_0x11c755(0x1fb)](_0x4adbf9['sparklines'][_0x11c755(0x1fc)]())});const _0x366895=(_0x404184=_0x566da5==null?void 0x0:_0x566da5[_0x11c755(0x257)](_0x37b9d3))==null?void 0x0:_0x404184[_0x11c755(0x26f)][_0x11c755(0x283)](_0x471b6a,_0x3e99c0);_0x366895&&_0xa36037[_0x11c755(0x22a)](_0x471b6a,_0x3e99c0,_0x366895);}}}),_0x281729['push']({'id':V['id'],'params':{'sparklineConfigMap':{[_0x36588b]:{'config':_0x59df96[_0x4de519(0x1fb)](_0x462ee1['config']),'sparklines':_0xa36037[_0x4de519(0x272)]()}},'unitId':_0x4a6876,'subUnitId':_0x5b2f73}}),_0x4ab607[_0x4de519(0x28f)]({'id':y['id'],'params':{'unitId':_0x4a6876,'subUnitId':_0x5b2f73,'isSingle':!0x1,'groupIds':Array['from'](_0x4e37f)}}),_0x4ab607[_0x4de519(0x28f)]({'id':V['id'],'params':{'unitId':_0x4a6876,'subUnitId':_0x5b2f73,'sparklineConfigMap':_0x32e5a4}}),_0x563cfa(_0x281729,_0x2e6d01),_0xc2cf2e[_0x4de519(0x255)]({'unitID':_0x4a6876,'undoMutations':_0x4ab607,'redoMutations':_0x281729}),!0x0;}else{if(_0x38cc97){const _0x59f210=[],_0x48cb85=[];_0x59f210[_0x4de519(0x28f)]({'id':y['id'],'params':{'unitId':_0x4a6876,'subUnitId':_0x5b2f73,'ranges':_0x3dea95,'isSingle':!0x0}});const _0x3bbb90=(_0x4b6259=_0x2fe4a9[_0x4de519(0x1ed)]()[_0x4de519(0x238)]['get'](_0x4a6876))==null?void 0x0:_0x4b6259[_0x4de519(0x257)](_0x5b2f73),_0x45af73={},_0x5106df=new Set(),_0x97db5e={};return _0x3dea95[_0x4de519(0x26a)](_0x11b95b=>{const _0x181332=_0x4de519;var _0x4ff172,_0x3ff18b;const {startRow:_0xf51072,endRow:_0x52e7d1,startColumn:_0x24746b,endColumn:_0x20160b}=_0x11b95b;for(let _0x4b136f=_0xf51072;_0x4b136f<=_0x52e7d1;_0x4b136f++)for(let _0x14d80b=_0x24746b;_0x14d80b<=_0x20160b;_0x14d80b++){const _0x5acabe=(_0x4ff172=_0x201279==null?void 0x0:_0x201279['matrix'][_0x181332(0x283)](_0x4b136f,_0x14d80b))==null?void 0x0:_0x4ff172[_0x181332(0x227)];if(_0x5acabe){const _0x28147f=new _0x3722c9(),_0xd23d30='g_'+_0x2343c8(0x6);_0x5106df[_0x181332(0x269)](_0x5acabe),_0x5106df['add'](_0xd23d30);const _0x4ccb2c=_0x2fe4a9[_0x181332(0x231)](_0x4a6876,_0x5b2f73,_0x5acabe);_0x4ccb2c&&(_0x97db5e[_0x5acabe]={'config':_0x59df96['deepClone'](_0x4ccb2c['config']),'sparklines':_0x59df96[_0x181332(0x1fb)](_0x4ccb2c[_0x181332(0x26f)]['clone']())});const _0x3adf04=(_0x3ff18b=_0x3bbb90==null?void 0x0:_0x3bbb90['get'](_0x5acabe))==null?void 0x0:_0x3ff18b[_0x181332(0x26f)][_0x181332(0x283)](_0x4b136f,_0x14d80b);_0x3adf04&&_0x28147f['setValue'](_0x4b136f,_0x14d80b,_0x3adf04),_0x45af73[_0xd23d30]={'sparklines':_0x28147f[_0x181332(0x272)](),'config':_0x59df96[_0x181332(0x1fb)](_0x462ee1[_0x181332(0x230)])};}}}),_0x59f210[_0x4de519(0x28f)]({'id':V['id'],'params':{'unitId':_0x4a6876,'subUnitId':_0x5b2f73,'sparklineConfigMap':_0x45af73}}),_0x48cb85['push']({'id':y['id'],'params':{'unitId':_0x4a6876,'subUnitId':_0x5b2f73,'isSingle':!0x1,'groupIds':Array[_0x4de519(0x20c)](_0x5106df)}}),_0x48cb85[_0x4de519(0x28f)]({'id':V['id'],'params':{'unitId':_0x4a6876,'subUnitId':_0x5b2f73,'sparklineConfigMap':_0x97db5e}}),_0x563cfa(_0x59f210,_0x2e6d01),_0xc2cf2e[_0x4de519(0x255)]({'unitID':_0x4a6876,'undoMutations':_0x48cb85,'redoMutations':_0x59f210}),!0x0;}}if(_0x1e0531){const _0x5e3dd3=_0xc2f008[_0x4de519(0x288)];if(!_0x5e3dd3)return!0x1;const {groupId:_0x211382,sourceRanges:_0x2459b5,targetRanges:_0x4b979b,resetType:_0x3d5f94,primary:_0x158bb6}=_0x5e3dd3,_0x2230d7=[],_0x5596fb=[];_0x2230d7[_0x4de519(0x28f)]({'id':y['id'],'params':{'unitId':_0x4a6876,'subUnitId':_0x5b2f73,'ranges':_0x3dea95,'isSingle':!0x1,'groupIds':[_0x211382]}}),_0x5596fb[_0x4de519(0x28f)]({'id':y['id'],'params':{'unitId':_0x4a6876,'subUnitId':_0x5b2f73,'ranges':_0x3dea95,'isSingle':!0x1,'groupIds':[_0x211382]}});let _0x13173c;_0x3d5f94==='item'?(_0x13173c=new _0x3722c9(_0x462ee1[_0x4de519(0x26f)][_0x4de519(0x1fc)]()),_0x13173c[_0x4de519(0x262)](_0x158bb6[_0x4de519(0x26b)],_0x158bb6['actualColumn']),_0x13173c[_0x4de519(0x22a)](_0x4b979b[0x0][_0x4de519(0x27f)],_0x4b979b[0x0]['startColumn'],_0x2459b5[0x0])):_0x13173c=Fe(_0x2459b5,_0x4b979b);const _0x4ccde5={'config':_0x59df96['deepClone'](_0x462ee1['config']),'sparklines':_0x13173c[_0x4de519(0x272)]()},_0x42d47f={'config':_0x59df96[_0x4de519(0x1fb)](_0x462ee1['config']),'sparklines':_0x59df96[_0x4de519(0x1fb)](_0x462ee1[_0x4de519(0x26f)][_0x4de519(0x1fc)]())};_0x2230d7['push']({'id':V['id'],'params':{'unitId':_0x4a6876,'subUnitId':_0x5b2f73,'sparklineConfigMap':{[_0x211382]:_0x4ccde5}}}),_0x5596fb[_0x4de519(0x28f)]({'id':V['id'],'params':{'unitId':_0x4a6876,'subUnitId':_0x5b2f73,'sparklineConfigMap':{[_0x211382]:_0x42d47f}}}),_0x563cfa(_0x2230d7,_0x2e6d01),_0xc2cf2e[_0x4de519(0x255)]({'unitID':_0x4a6876,'undoMutations':_0x5596fb,'redoMutations':_0x2230d7});}else{const _0x3922a5=[],_0x4ca802=[],_0x10da36=new Set(),_0x38ff26={};_0x3dea95[_0x4de519(0x26a)](_0x5f138b=>{const _0x469856=_0x4de519;var _0x39b553;const {startRow:_0x53f2b9,endRow:_0x457ece,startColumn:_0x17b3f1,endColumn:_0x23d922}=_0x5f138b;for(let _0x2dd5d7=_0x53f2b9;_0x2dd5d7<=_0x457ece;_0x2dd5d7++)for(let _0x3952c4=_0x17b3f1;_0x3952c4<=_0x23d922;_0x3952c4++){const _0x5a3923=(_0x39b553=_0x201279==null?void 0x0:_0x201279['matrix'][_0x469856(0x283)](_0x2dd5d7,_0x3952c4))==null?void 0x0:_0x39b553[_0x469856(0x227)];if(_0x5a3923){_0x10da36[_0x469856(0x269)](_0x5a3923);const _0x51cd80=_0x2fe4a9['getSparklineById'](_0x4a6876,_0x5b2f73,_0x5a3923);_0x51cd80&&(_0x38ff26[_0x5a3923]={'config':_0x59df96[_0x469856(0x1fb)](_0x51cd80['config']),'sparklines':_0x59df96['deepClone'](_0x51cd80[_0x469856(0x26f)][_0x469856(0x1fc)]())});}}}),_0x4ca802[_0x4de519(0x28f)]({'id':Oe['id'],'params':{'unitId':_0x4a6876,'subUnitId':_0x5b2f73,'groupIds':Array[_0x4de519(0x20c)](_0x10da36),'config':{'config':_0x59df96[_0x4de519(0x1fb)](_0x462ee1[_0x4de519(0x230)]),'sparklines':_0x462ee1['sparklines'][_0x4de519(0x272)]()}}}),_0x3922a5[_0x4de519(0x28f)]({'id':y['id'],'params':{'unitId':_0x4a6876,'subUnitId':_0x5b2f73,'isSingle':!0x1,'groupIds':Array[_0x4de519(0x20c)](_0x10da36)}}),_0x3922a5[_0x4de519(0x28f)]({'id':V['id'],'params':{'unitId':_0x4a6876,'subUnitId':_0x5b2f73,'sparklineConfigMap':_0x38ff26}}),_0x563cfa(_0x4ca802,_0x2e6d01),_0xc2cf2e[_0x4de519(0x255)]({'unitID':_0x4a6876,'undoMutations':_0x3922a5,'redoMutations':_0x4ca802});}return!0x0;}};var Ut=Object[_0x3be869(0x279)],Pt=(_0x10848e,_0x4c5290,_0x2db9db,_0x115234)=>{for(var _0x52767e=_0x115234>0x1?void 0x0:_0x115234?Ut(_0x4c5290,_0x2db9db):_0x4c5290,_0x5a8bb3=_0x10848e['length']-0x1,_0x262ceb;_0x5a8bb3>=0x0;_0x5a8bb3--)(_0x262ceb=_0x10848e[_0x5a8bb3])&&(_0x52767e=_0x262ceb(_0x52767e)||_0x52767e);return _0x52767e;},fe=(_0x31a979,_0x1b590e)=>(_0x3fcef8,_0x16d38e)=>_0x1b590e(_0x3fcef8,_0x16d38e,_0x31a979);let Se=class extends _0x175b87{constructor(_0xcd5223,_0x411c08,_0x38d3c0,_0x42fdd4){const _0x33a6da=_0x3be869;super(),this[_0x33a6da(0x1db)]=_0xcd5223,this[_0x33a6da(0x216)]=_0x411c08,this['_univerInstanceService']=_0x38d3c0,this[_0x33a6da(0x1f7)]=_0x42fdd4,this[_0x33a6da(0x25b)]();}[_0x3be869(0x25b)](){const _0x5ed585=_0x3be869;this[_0x5ed585(0x218)](this[_0x5ed585(0x216)][_0x5ed585(0x1da)]({'getMutations':_0xa632dc=>{const _0xdfe366=_0x5ed585,_0x58c60d=[],_0x512de8=[];if(_0xa632dc['id']===_0x3f2452['id']){const _0x222697=_0x52cba3(this[_0xdfe366(0x27b)]);if(!_0x222697)return{'redos':_0x58c60d,'undos':_0x512de8};const {unitId:_0x582975,subUnitId:_0x2fd59f,worksheet:_0x279bdc}=_0x222697,_0x34bc6e=this['_sheetSelectionService'][_0xdfe366(0x281)]()['map'](_0x9ad999=>_0x9ad999['range']),_0x40c844=new Set(),_0x451a26={},_0x752dde={};_0x34bc6e[_0xdfe366(0x26a)](_0x77aedf=>{const _0x3cc580=_0xdfe366;_0x480d40[_0x3cc580(0x23e)](_0x77aedf,(_0x527929,_0x2a9881)=>{const _0x41a7cb=_0x3cc580,_0x56c30c=this[_0x41a7cb(0x1db)]['getSparkline'](_0x582975,_0x2fd59f,_0x527929,_0x2a9881);if(_0x56c30c&&!_0x40c844['has'](_0x56c30c)){const _0x33c5ce=this[_0x41a7cb(0x1db)][_0x41a7cb(0x231)](_0x582975,_0x2fd59f,_0x56c30c);_0x33c5ce&&(_0x40c844[_0x41a7cb(0x269)](_0x56c30c),_0x451a26[_0x56c30c]={'config':_0x59df96[_0x41a7cb(0x1fb)](_0x33c5ce[_0x41a7cb(0x230)]),'sparklines':_0x59df96[_0x41a7cb(0x1fb)](_0x33c5ce['sparklines']['clone']())},_0x752dde[_0x56c30c]={'config':_0x59df96['deepClone'](_0x33c5ce['config']),'sparklines':_0x59df96[_0x41a7cb(0x1fb)](_0x33c5ce[_0x41a7cb(0x26f)][_0x41a7cb(0x1fc)]())});}});}),Object['values'](_0x752dde)[_0xdfe366(0x26a)](_0x2121f6=>{const _0x50c412=_0xdfe366,_0x2dacc2=_0x2121f6[_0x50c412(0x26f)];new _0x3722c9(_0x2dacc2)[_0x50c412(0x1fe)]((_0x5cd9ab,_0x27a653,_0x52c035)=>{const _0x48b537=_0x50c412;_0x34bc6e['some'](_0x2300f6=>_0x3357bc[_0x48b537(0x22e)](_0x2300f6,_0x21e1c2(_0x5cd9ab,_0x27a653)))&&delete _0x2dacc2[_0x5cd9ab][_0x27a653];});}),_0x58c60d[_0xdfe366(0x28f)]({'id':y['id'],'params':{'unitId':_0x582975,'subUnitId':_0x2fd59f,'groupIds':Array[_0xdfe366(0x20c)](_0x40c844),'isSingle':!0x1}}),_0x58c60d[_0xdfe366(0x28f)]({'id':V['id'],'params':{'unitId':_0x582975,'subUnitId':_0x2fd59f,'sparklineConfigMap':_0x752dde}}),_0x512de8['push']({'id':y['id'],'params':{'unitId':_0x582975,'subUnitId':_0x2fd59f,'groupIds':Array[_0xdfe366(0x20c)](_0x40c844),'isSingle':!0x1}}),_0x512de8[_0xdfe366(0x28f)]({'id':V['id'],'params':{'unitId':_0x582975,'subUnitId':_0x2fd59f,'sparklineConfigMap':_0x451a26}});}return{'redos':_0x58c60d,'undos':_0x512de8};}}));}};Se=Pt([fe(0x0,_0x1342b4(x)),fe(0x1,_0x1342b4(_0x1a12d6)),fe(0x2,_0x1342b4(_0x36b83f)),fe(0x3,_0x1342b4(_0x4a197a))],Se);var Tt=Object[_0x3be869(0x279)],$t=(_0x5b3b6e,_0x21a590,_0x5d1d15,_0x1b66cb)=>{const _0x5a51ab=_0x3be869;for(var _0x417b1d=_0x1b66cb>0x1?void 0x0:_0x1b66cb?Tt(_0x21a590,_0x5d1d15):_0x21a590,_0x30c32e=_0x5b3b6e[_0x5a51ab(0x233)]-0x1,_0x5cf093;_0x30c32e>=0x0;_0x30c32e--)(_0x5cf093=_0x5b3b6e[_0x30c32e])&&(_0x417b1d=_0x5cf093(_0x417b1d)||_0x417b1d);return _0x417b1d;},Ge=(_0x2a8654,_0x44d557)=>(_0x30b239,_0x124c7b)=>_0x44d557(_0x30b239,_0x124c7b,_0x2a8654);let ke=class extends _0x175b87{constructor(_0x583273,_0x43cc0e){const _0x3215e2=_0x3be869;super(),this[_0x3215e2(0x216)]=_0x583273,this['_sparklineDataSourceModel']=_0x43cc0e,this[_0x3215e2(0x26c)]();}['_initCopySheetWithSparkline'](){const _0x48dc28=_0x3be869;this[_0x48dc28(0x218)](this[_0x48dc28(0x216)][_0x48dc28(0x1da)]({'getMutations':_0x1407b3=>{const _0x45cfd4=_0x48dc28,_0x387df0=[],_0x584fe4=[];if(_0x1407b3['id']===_0xfed830['id']){const _0x9720e2=_0x1407b3['params'];if(!_0x9720e2)return{'redos':_0x387df0,'undos':_0x584fe4};const {unitId:_0x8ed024,subUnitId:_0x1a04c2,targetSubUnitId:_0xa3ef08}=_0x9720e2;if(!_0x8ed024||!_0x1a04c2||!_0xa3ef08)return{'redos':_0x387df0,'undos':_0x584fe4};const _0x3cb96e=new Set(),_0x576085={},_0x4efeb5=this['_sparklineDataSourceModel'][_0x45cfd4(0x287)](_0x8ed024,_0x1a04c2);if(!_0x4efeb5)return{'redos':_0x387df0,'undos':_0x584fe4};for(const [_0xa1e247,_0x329b1b]of _0x4efeb5){const _0xa644e9='g_'+_0x2343c8(0x6);_0x3cb96e['add'](_0xa1e247),_0x576085[_0xa644e9]={'config':_0x59df96['deepClone'](_0x329b1b['config']),'sparklines':_0x59df96[_0x45cfd4(0x1fb)](_0x329b1b[_0x45cfd4(0x26f)]['clone']())};}_0x3cb96e[_0x45cfd4(0x236)]&&(_0x584fe4['push']({'id':y['id'],'params':{'unitId':_0x8ed024,'subUnitId':_0xa3ef08,'groupIds':Array['from'](_0x3cb96e),'isSingle':!0x1}}),_0x387df0[_0x45cfd4(0x28f)]({'id':V['id'],'params':{'unitId':_0x8ed024,'subUnitId':_0xa3ef08,'sparklineConfigMap':_0x576085}}));}return{'redos':_0x387df0,'undos':_0x584fe4};}}));}};ke=$t([Ge(0x0,_0x1342b4(_0x1a12d6)),Ge(0x1,_0x1342b4(x))],ke);var jt=Object['getOwnPropertyDescriptor'],Lt=(_0xa40e81,_0x28c863,_0x32d814,_0x429e26)=>{const _0x2ae982=_0x3be869;for(var _0x976824=_0x429e26>0x1?void 0x0:_0x429e26?jt(_0x28c863,_0x32d814):_0x28c863,_0x342050=_0xa40e81[_0x2ae982(0x233)]-0x1,_0x3a0b0a;_0x342050>=0x0;_0x342050--)(_0x3a0b0a=_0xa40e81[_0x342050])&&(_0x976824=_0x3a0b0a(_0x976824)||_0x976824);return _0x976824;},Ie=(_0x11097b,_0x3243d6)=>(_0xd26685,_0x56b8e2)=>_0x3243d6(_0xd26685,_0x56b8e2,_0x11097b);let me=class extends _0x175b87{constructor(_0x1f5581,_0x222a14,_0x442071){const _0x59ed5b=_0x3be869;super(),this['_commandService']=_0x1f5581,this['_sparklineDataSourceModel']=_0x222a14,this[_0x59ed5b(0x1e6)]=_0x442071,this['_initDataChangeListener'](),this['_initExclusiveRangeChange']();}[_0x3be869(0x23b)](){const _0x2fd93a=_0x3be869;this[_0x2fd93a(0x218)](this['_commandService'][_0x2fd93a(0x229)](_0x48c710=>{const _0x3f3d1a=_0x2fd93a;if(_0x48c710['id']===_0x2ca30b['id']){const _0x3762cd=_0x48c710[_0x3f3d1a(0x28e)],{cellValue:_0x4157a5,unitId:_0x4f0918,subUnitId:_0x52096f}=_0x3762cd,_0x17e4be=new _0x3722c9(_0x4157a5),_0x59cab0=new Set(),_0x44a208=this['_sparklineDataSourceModel'][_0x3f3d1a(0x287)](_0x4f0918,_0x52096f);if(!_0x44a208)return;const _0x4eeb48=Array[_0x3f3d1a(0x20c)](_0x44a208);_0x17e4be[_0x3f3d1a(0x1fe)]((_0x10cf28,_0x51b11f,_0x3cfc95)=>{const _0x758c7b=_0x3f3d1a,_0x1188de=_0x21e1c2(_0x10cf28,_0x51b11f);for(let _0x3f98f6=0x0;_0x3f98f6<_0x4eeb48[_0x758c7b(0x233)];_0x3f98f6++){const [_0x260015,_0x226bad]=_0x4eeb48[_0x3f98f6],_0x5da104=_0x59cab0['has'](_0x260015);_0x5da104||_0x226bad['sparklines'][_0x758c7b(0x1fe)]((_0x5ebd0c,_0x2b8183,_0x41fd83)=>{const _0x31aaeb=_0x758c7b,_0x12cf56=_0x41fd83;if(_0x12cf56&&!_0x5da104&&_0x3357bc['intersects'](_0x1188de,_0x12cf56))return _0x59cab0[_0x31aaeb(0x269)](_0x260015),!0x0;});}}),_0x59cab0[_0x3f3d1a(0x26a)](_0x1ae453=>{const _0x3bdd21=_0x3f3d1a;this[_0x3bdd21(0x1db)][_0x3bdd21(0x277)](_0x4f0918,_0x52096f,_0x1ae453),this[_0x3bdd21(0x1db)][_0x3bdd21(0x24e)](_0x4f0918,_0x52096f,_0x1ae453);});}else{if(_0x48c710['id']===_0x5b9697['id']){const _0x2121b5=_0x48c710[_0x3f3d1a(0x28e)],{range:_0x2abd5e,unitId:_0x3eb25e,subUnitId:_0x3222dc}=_0x2121b5,_0xdab69=new Set(),_0x3be888=this[_0x3f3d1a(0x1db)][_0x3f3d1a(0x287)](_0x3eb25e,_0x3222dc);if(!_0x3be888)return;const _0x413118=Array[_0x3f3d1a(0x20c)](_0x3be888);for(let _0x2e5488=0x0;_0x2e5488<_0x413118[_0x3f3d1a(0x233)];_0x2e5488++){const [_0x45f614,_0x11e6e7]=_0x413118[_0x2e5488],_0x296422=_0xdab69[_0x3f3d1a(0x1e9)](_0x45f614);_0x296422||_0x11e6e7[_0x3f3d1a(0x26f)][_0x3f3d1a(0x1fe)]((_0x3d5e02,_0x1caa57,_0x33b707)=>{const _0x477d32=_0x3f3d1a,_0x4fbc53=_0x33b707;if(_0x4fbc53&&!_0x296422&&_0x3357bc[_0x477d32(0x22e)](_0x2abd5e,_0x4fbc53))return _0xdab69[_0x477d32(0x269)](_0x45f614),!0x0;});}_0xdab69[_0x3f3d1a(0x26a)](_0x9870c=>{const _0x38f2f4=_0x3f3d1a;this[_0x38f2f4(0x1db)][_0x38f2f4(0x277)](_0x3eb25e,_0x3222dc,_0x9870c),this[_0x38f2f4(0x1db)][_0x38f2f4(0x24e)](_0x3eb25e,_0x3222dc,_0x9870c);});}}}));}['_initExclusiveRangeChange'](){const _0x134818=_0x3be869;this[_0x134818(0x218)](this[_0x134818(0x1e6)][_0x134818(0x25d)]['subscribe'](_0x49fc58=>{const _0x3202c6=_0x134818,{unitId:_0x583bdd,subUnitId:_0x2f5910,ranges:_0x31a47d}=_0x49fc58,_0x516d83=this[_0x3202c6(0x1db)][_0x3202c6(0x287)](_0x583bdd,_0x2f5910);if(!_0x516d83)return;const _0x4b5585=Array['from'](_0x516d83),_0x1c97b5=new Set();for(let _0x2d278a=0x0;_0x2d278a<_0x4b5585['length'];_0x2d278a++){const [_0x15d691,_0x465732]=_0x4b5585[_0x2d278a],_0x43fd5c=_0x1c97b5[_0x3202c6(0x1e9)](_0x15d691);_0x43fd5c||_0x465732[_0x3202c6(0x26f)]['forValue']((_0x46d1f9,_0x224cb1,_0x771095)=>{const _0x4a33c4=_0x3202c6,_0x280870=_0x771095;if(_0x280870&&!_0x43fd5c){for(const _0x1cffad of _0x31a47d)if(_0x3357bc[_0x4a33c4(0x22e)](_0x1cffad,_0x280870)){_0x1c97b5[_0x4a33c4(0x269)](_0x15d691);break;}}});}_0x1c97b5[_0x3202c6(0x26a)](_0x177ef1=>{const _0x33dcae=_0x3202c6;this[_0x33dcae(0x1db)]['clearSparklineCache'](_0x583bdd,_0x2f5910,_0x177ef1),this['_sparklineDataSourceModel'][_0x33dcae(0x24e)](_0x583bdd,_0x2f5910,_0x177ef1);});}));}};me=Lt([Ie(0x0,_0x1342b4(_0x1e9e76)),Ie(0x1,_0x1342b4(x)),Ie(0x2,_0x1342b4(_0x378bb7))],me);var Gt=Object['getOwnPropertyDescriptor'],Wt=(_0x3da9d8,_0x527711,_0x8608b5,_0x2b8f19)=>{const _0x5ee785=_0x3be869;for(var _0x47178c=_0x2b8f19>0x1?void 0x0:_0x2b8f19?Gt(_0x527711,_0x8608b5):_0x527711,_0x57563c=_0x3da9d8[_0x5ee785(0x233)]-0x1,_0x260264;_0x57563c>=0x0;_0x57563c--)(_0x260264=_0x3da9d8[_0x57563c])&&(_0x47178c=_0x260264(_0x47178c)||_0x47178c);return _0x47178c;},We=(_0x1ad80f,_0x100bd4)=>(_0x57d726,_0x5318a5)=>_0x100bd4(_0x57d726,_0x5318a5,_0x1ad80f);let Ce=class extends _0x175b87{constructor(_0x9abf0c,_0x1185bb){const _0x34f44c=_0x3be869;super(),this[_0x34f44c(0x202)]=_0x9abf0c,this[_0x34f44c(0x1db)]=_0x1185bb,this[_0x34f44c(0x247)]();}[_0x3be869(0x247)](){this['_commandService']['onCommandExecuted'](_0x5198d6=>{const _0x2a2929=_0x4a89;if(_0x5198d6['id']===_0x18037b['id']||_0x5198d6['id']===_0x30e006['id']||_0x5198d6['id']===_0x5a5a10['id']||_0x5198d6['id']===_0x1b9d8f['id']){const _0x3648ff=_0x5198d6[_0x2a2929(0x28e)],{ranges:_0xadb221,unitId:_0x12d6d6,subUnitId:_0x49d32d}=_0x3648ff,_0x5b588c=new Set(),_0x399154=this['_sparklineDataSourceModel'][_0x2a2929(0x287)](_0x12d6d6,_0x49d32d);if(!_0x399154)return;const _0x1c0d16=Array[_0x2a2929(0x20c)](_0x399154);_0xadb221[_0x2a2929(0x26a)](_0x1ebf19=>{const _0x3cdf9f=_0x2a2929;_0x480d40[_0x3cdf9f(0x23e)](_0x1ebf19,(_0x5b68ac,_0x29d13f)=>{const _0xf38d0e=_0x3cdf9f,_0x3c3823=_0x21e1c2(_0x5b68ac,_0x29d13f);for(let _0x429d86=0x0;_0x429d86<_0x1c0d16['length'];_0x429d86++){const [_0x278ff1,_0x3cf089]=_0x1c0d16[_0x429d86],_0x5331b1=_0x5b588c[_0xf38d0e(0x1e9)](_0x278ff1);_0x5331b1||_0x3cf089[_0xf38d0e(0x26f)][_0xf38d0e(0x1fe)]((_0x303189,_0x2191b1,_0x13fbff)=>{const _0x35b235=_0xf38d0e,_0x51256d=_0x13fbff;if(_0x51256d&&!_0x5331b1&&_0x3357bc[_0x35b235(0x22e)](_0x3c3823,_0x51256d))return _0x5b588c['add'](_0x278ff1),!0x0;});}});}),_0x5b588c[_0x2a2929(0x26a)](_0x42d504=>{const _0x2de23c=_0x2a2929;this[_0x2de23c(0x1db)][_0x2de23c(0x277)](_0x12d6d6,_0x49d32d,_0x42d504),this[_0x2de23c(0x1db)][_0x2de23c(0x24e)](_0x12d6d6,_0x49d32d,_0x42d504);});}});}};Ce=Wt([We(0x0,_0x1342b4(_0x1e9e76)),We(0x1,_0x1342b4(x))],Ce);function _0x5162(){const _0x65562c=['clearSparklineCache','SELF_EXTREMUM','getOwnPropertyDescriptor','sparklineAnchorMap','_univerInstanceService','Mismatch\x20between\x20the\x20number\x20of\x20target\x20cells\x20and\x20the\x20source\x20range\x20dimensions.','matrix','_getRefRangeMutationsByDeleteCols','startRow','_ensureConfigMap','getCurrentSelections','PROFIT_AND_LOSS_CHART','getValue','row','NUMBER','MAX_SAFE_INTEGER','getSubUnitSparkline','changeDataSourceInfo','moveColumns','5102244XXCpfD','fromJSON','toRgbString','getCell','params','push','toJSON','removeRows','_updateConfig$','SHEET_SPARKLINE_PLUGIN','markersPoint','sheet.command.remove-sparkline','interceptCommand','_sparklineDataSourceModel','getRowVisible','u-connect','dispose','every','delete','rgb(46,187,122)','value','_getRefRangeMutationsByDeleteRows','removeSparkline','highPoint','_exclusiveRangeService','registerPluginResource','SPACING','has','_initSnapshot','u-spacing','BAR_CHART','getSparklineCache','updateConfig$','45KqsXcO','3805428rBxZup','endRow','8yVjdZn','_initDependencies','asObservable','ranges','UNIVER_SHEET','_sheetSelectionService','startColumn','_resourceManagerService','DISTINCTIVE','deepClone','clone','symbol','forValue','addSparkline','lastPoint','number','_commandService','assign','_initRegisterCommand','range','rgb(30,177,189)','getSparkline','registerRefRange','_initCorrectRangeWithSparkline','_config','rgb(236,100,169)','from','specialty','getCurrentUnitForType','max','CONNECT_WITH_LINE','4cfEMfd','spacing','refRangeHandle','subUnitId','set','_sheetInterceptorService','standard','disposeWithMe','endColumn','reBuildAnchorCache','pluginName','4641412GCFtJx','type','extremumMin','GROUP_EXTREMUM','sheet.mutation.add-sparkline','NORMAL','column','sheet.command.add-sparkline','containHiddenCells','getSizeOf','MIN_SAFE_INTEGER','groupId','rgb(49,106,246)','onCommandExecuted','setValue','custom','remove','stringify','intersects','connect_with_line','config','getSparklineById','LINE_CHART','length','sheet.mutation.remove-sparkline','lowPoint','size','extremumMax','sparklineModel','STANDARD','contains','_initDataChangeListener','getSheetBySheetId','PIE_CHART','foreach','nonNumShowAs','1277290eNHApf','_onRefRangeChange','_sparklineAnchorMap','disposableCollection','setAlpha','CUSTOM_EXTREMUM','2622650tIbkeY','_initHideRowColWithSparkline','rgb(248,190,21)','keys','setSparkline','_refRangeService','STRING','next','updateSparklineExtraNum','entries','sheet.command.set-sparkline','removeColumns','_initMergeWithSparkline','151537CvAaBD','fresh','pushUndoRedo','rgb(244,104,249)','get','min','seriesColor','ZERO_VALUE','_initClearWithSparkline','firstPoint','exclusiveRangesChange$','defineProperty','BOOLEAN','COMMAND','_ensureAnchorMatrix','realDeleteValue','SOFT','themeType','unitId','deleteUnit','emptyShowAs','getCellRaw','add','forEach','actualRow','_initCopySheetWithSparkline','FRESH','_injector','sparklines','_sparklineModel','MUTATION','getMatrix','CUSTOM','3887632wqLVav','map','removePartSparkline'];_0x5162=function(){return _0x65562c;};return _0x5162();}var Bt=Object[_0x3be869(0x279)],Ht=(_0x1eff79,_0x51922f,_0x42acaa,_0x5cf082)=>{const _0x15c3bc=_0x3be869;for(var _0x3e0b5b=_0x5cf082>0x1?void 0x0:_0x5cf082?Bt(_0x51922f,_0x42acaa):_0x51922f,_0x2da398=_0x1eff79[_0x15c3bc(0x233)]-0x1,_0x48b5e2;_0x2da398>=0x0;_0x2da398--)(_0x48b5e2=_0x1eff79[_0x2da398])&&(_0x3e0b5b=_0x48b5e2(_0x3e0b5b)||_0x3e0b5b);return _0x3e0b5b;},be=(_0x25c917,_0x20dac6)=>(_0x5f9c7d,_0x267cda)=>_0x20dac6(_0x5f9c7d,_0x267cda,_0x25c917);let _e=class extends _0x175b87{constructor(_0x4c6bdb,_0x3f7e91,_0x4964aa){const _0xdf70a4=_0x3be869;super(),this[_0xdf70a4(0x202)]=_0x4c6bdb,this[_0xdf70a4(0x216)]=_0x3f7e91,this[_0xdf70a4(0x1db)]=_0x4964aa,this['_initMergeWithSparkline']();}[_0x3be869(0x252)](){const _0x1f5b84=_0x3be869;this[_0x1f5b84(0x218)](this[_0x1f5b84(0x216)]['interceptCommand']({'getMutations':_0x6f4a06=>{const _0x2a70f6=_0x1f5b84,_0x21376=[],_0x35ecfd=[];if(_0x6f4a06['id']===_0x12f2a8['id']){const _0x3abb1e=_0x6f4a06[_0x2a70f6(0x28e)];if(!_0x3abb1e)return{'redos':_0x21376,'undos':_0x35ecfd};const {unitId:_0x34d45d,subUnitId:_0x3bc383,ranges:_0xd50ae4}=_0x3abb1e,_0x5204b3=this[_0x2a70f6(0x1db)][_0x2a70f6(0x287)](_0x34d45d,_0x3bc383);if(!_0x5204b3)return{'redos':_0x21376,'undos':_0x35ecfd};const _0x3b6347={},_0x1caf6b={},_0x238739=new Set();_0xd50ae4[_0x2a70f6(0x26a)](_0x1d4738=>{const _0x15e267=_0x2a70f6,_0x32282f=_0x1d4738[_0x15e267(0x27f)],_0xbeb4ba=_0x1d4738[_0x15e267(0x1f8)];_0x480d40[_0x15e267(0x23e)](_0x1d4738,(_0x4297eb,_0x54ff78)=>{const _0x20fed6=_0x15e267,_0x5b9d18=this['_sparklineDataSourceModel']['getSparkline'](_0x34d45d,_0x3bc383,_0x4297eb,_0x54ff78);if(_0x5b9d18&&!(_0x4297eb===_0x32282f&&_0x54ff78===_0xbeb4ba)){const _0x275ae2=this['_sparklineDataSourceModel'][_0x20fed6(0x231)](_0x34d45d,_0x3bc383,_0x5b9d18);if(_0x275ae2){_0x238739['add'](_0x5b9d18);let _0x5939d2=_0x3b6347[_0x5b9d18];_0x5939d2||(_0x5939d2={'config':_0x59df96['deepClone'](_0x275ae2['config']),'sparklines':new _0x3722c9(_0x275ae2[_0x20fed6(0x26f)][_0x20fed6(0x1fc)]())},_0x3b6347[_0x5b9d18]=_0x5939d2),_0x5939d2[_0x20fed6(0x26f)][_0x20fed6(0x262)](_0x4297eb,_0x54ff78),_0x1caf6b[_0x5b9d18]={'config':_0x59df96[_0x20fed6(0x1fb)](_0x275ae2[_0x20fed6(0x230)]),'sparklines':_0x59df96['deepClone'](_0x275ae2[_0x20fed6(0x26f)]['clone']())};}}});});for(const [_0x243e8e,_0x5e035b]of _0x5204b3){const _0x4b8587=_0x5e035b[_0x2a70f6(0x26f)];_0x4b8587[_0x2a70f6(0x1fe)]((_0x5eb53f,_0x4b42d9,_0x55c8c7)=>{const _0x746402=_0x2a70f6;for(let _0x10be87=0x0;_0x10be87<_0xd50ae4[_0x746402(0x233)];_0x10be87++){const _0x15a7ee=_0xd50ae4[_0x10be87];if(_0x3357bc[_0x746402(0x23a)](_0x15a7ee,_0x55c8c7)){_0x238739[_0x746402(0x269)](_0x243e8e);let _0x4ce1a5=_0x3b6347[_0x243e8e];_0x4ce1a5||(_0x4ce1a5={'config':_0x59df96['deepClone'](_0x5e035b[_0x746402(0x230)]),'sparklines':new _0x3722c9(_0x4b8587[_0x746402(0x1fc)]())},_0x3b6347[_0x243e8e]=_0x4ce1a5),_0x4ce1a5[_0x746402(0x26f)][_0x746402(0x262)](_0x5eb53f,_0x4b42d9),_0x1caf6b[_0x243e8e]||(_0x1caf6b[_0x243e8e]={'config':_0x59df96['deepClone'](_0x5e035b[_0x746402(0x230)]),'sparklines':_0x59df96[_0x746402(0x1fb)](_0x4b8587[_0x746402(0x1fc)]())});}}});}const _0x4d397c={};Object[_0x2a70f6(0x24f)](_0x3b6347)[_0x2a70f6(0x26a)](([_0x43bd4f,_0x360716])=>{const _0x4e5704=_0x2a70f6;_0x360716['sparklines']['getSizeOf']()&&(_0x4d397c[_0x43bd4f]={'config':_0x360716[_0x4e5704(0x230)],'sparklines':_0x360716[_0x4e5704(0x26f)][_0x4e5704(0x1fc)]()});}),_0x238739[_0x2a70f6(0x236)]&&(_0x21376[_0x2a70f6(0x28f)]({'id':y['id'],'params':{'unitId':_0x34d45d,'subUnitId':_0x3bc383,'groupIds':Array[_0x2a70f6(0x20c)](_0x238739),'isSingle':!0x1}}),_0x35ecfd[_0x2a70f6(0x28f)]({'id':y['id'],'params':{'unitId':_0x34d45d,'subUnitId':_0x3bc383,'groupIds':Array[_0x2a70f6(0x20c)](_0x238739),'isSingle':!0x1}}),_0x21376[_0x2a70f6(0x28f)]({'id':V['id'],'params':{'unitId':_0x34d45d,'subUnitId':_0x3bc383,'sparklineConfigMap':_0x4d397c}}),_0x35ecfd[_0x2a70f6(0x28f)]({'id':V['id'],'params':{'unitId':_0x34d45d,'subUnitId':_0x3bc383,'sparklineConfigMap':_0x1caf6b}}));}return{'redos':_0x21376,'undos':_0x35ecfd};}}));}};_e=Ht([be(0x0,_0x1342b4(_0x1e9e76)),be(0x1,_0x1342b4(_0x1a12d6)),be(0x2,_0x1342b4(x))],_e);var Ft=Object[_0x3be869(0x279)],Kt=(_0x37037c,_0x2b283a,_0x20219f,_0x1419b6)=>{const _0x528164=_0x3be869;for(var _0x4504d1=_0x1419b6>0x1?void 0x0:_0x1419b6?Ft(_0x2b283a,_0x20219f):_0x2b283a,_0x964323=_0x37037c[_0x528164(0x233)]-0x1,_0x2c71d3;_0x964323>=0x0;_0x964323--)(_0x2c71d3=_0x37037c[_0x964323])&&(_0x4504d1=_0x2c71d3(_0x4504d1)||_0x4504d1);return _0x4504d1;},ge=(_0x31c92c,_0xb24b54)=>(_0x3ee854,_0x2ee2a8)=>_0xb24b54(_0x3ee854,_0x2ee2a8,_0x31c92c);let Me=class extends _0x175b87{constructor(_0x8664d7,_0x3cc6f8,_0x3c9de8,_0x553133){const _0x344305=_0x3be869;super(),se(this,_0x344305(0x243),new _0xcbe1f6()),(this[_0x344305(0x202)]=_0x8664d7,this[_0x344305(0x24b)]=_0x3cc6f8,this[_0x344305(0x27b)]=_0x3c9de8,this[_0x344305(0x1db)]=_0x553133,this[_0x344305(0x241)](),this[_0x344305(0x209)]());}[_0x3be869(0x241)](){const _0x5d7e6f=_0x3be869,_0x3f6395=(_0x26bb60,_0x44194a)=>{const _0x220240=_0x4a89,_0x34326f=this[_0x220240(0x27b)][_0x220240(0x20e)](_0x1a6a86[_0x220240(0x1f6)]);if(!_0x34326f||!(_0x34326f==null?void 0x0:_0x34326f[_0x220240(0x23c)](_0x44194a)))return;this[_0x220240(0x243)][_0x220240(0x1de)]();const _0x2fd01c=_0x177001=>this[_0x220240(0x213)](_0x177001,_0x26bb60,_0x44194a),_0x1a9478=[],_0xf8c0e8=this['_sparklineDataSourceModel'][_0x220240(0x287)](_0x26bb60,_0x44194a);if(_0xf8c0e8){for(const [_0xfa4fe1,_0x567a6d]of _0xf8c0e8)_0x567a6d[_0x220240(0x26f)][_0x220240(0x1fe)]((_0x28a56b,_0x50a01b,_0x59286b)=>{const _0x5d2c03=_0x220240,_0x36c857=_0x21e1c2(_0x28a56b,_0x50a01b);_0x1a9478[_0x5d2c03(0x28f)](_0x36c857);});_0x1a9478[_0x220240(0x26a)](_0x36898d=>{const _0x2872e6=_0x220240;this['disposableCollection']['add'](this[_0x2872e6(0x24b)][_0x2872e6(0x208)](_0x36898d,_0x2fd01c,_0x26bb60,_0x44194a));});}};this['disposeWithMe'](this[_0x5d7e6f(0x202)][_0x5d7e6f(0x229)](_0x5094ff=>{const _0x483b72=_0x5d7e6f;if(_0x5094ff['id']===_0x4419f5['id']){const _0x1a1a4f=_0x5094ff[_0x483b72(0x28e)],_0x10f401=_0x1a1a4f[_0x483b72(0x214)],_0x533da4=_0x1a1a4f['unitId'];if(!_0x10f401||!_0x533da4)return;_0x3f6395(_0x533da4,_0x10f401);}if(_0x5094ff['id']===Oe['id']||_0x5094ff['id']===V['id']){const _0x53a4a4=_0x5094ff['params'],_0x22e8e0=_0x53a4a4[_0x483b72(0x214)],_0x485602=_0x53a4a4[_0x483b72(0x265)];if(!_0x22e8e0||!_0x485602)return;_0x3f6395(_0x485602,_0x22e8e0);}}));}[_0x3be869(0x213)](_0x5a3a7a,_0x2f384b,_0x1de067){const _0x1ab151=_0x3be869;switch(_0x5a3a7a['id']){case _0x5c867a['id']:return this[_0x1ab151(0x27e)](_0x5a3a7a[_0x1ab151(0x28e)],_0x2f384b,_0x1de067);case _0xf08bcd['id']:return this[_0x1ab151(0x1e3)](_0x5a3a7a[_0x1ab151(0x28e)],_0x2f384b,_0x1de067);}return{'redos':[],'undos':[]};}[_0x3be869(0x1e3)](_0x480d44,_0x1ba2dc,_0x2d4285){const _0x43b565=_0x3be869;var _0x2315c2,_0x2c9ab9;const {range:_0x333d6c}=_0x480d44,_0x96e939=new Set(),_0x5f1b3d={},_0xe9d716={},_0x5da96a=[],_0x22c6af=[],_0x20ac33=[],_0x4e4e4a=[];if(!_0x52cba3(this[_0x43b565(0x27b)],{'unitId':_0x1ba2dc,'subUnitId':_0x2d4285}))return{'redos':_0x22c6af,'undos':_0x5da96a};const _0xfa4ef2=this[_0x43b565(0x1db)][_0x43b565(0x287)](_0x1ba2dc,_0x2d4285);if(!_0xfa4ef2)return{'redos':_0x22c6af,'undos':_0x5da96a};if(!((_0x2c9ab9=(_0x2315c2=this[_0x43b565(0x1db)][_0x43b565(0x1ed)]()[_0x43b565(0x27a)][_0x43b565(0x257)](_0x1ba2dc))==null?void 0x0:_0x2315c2['get'](_0x2d4285))==null?void 0x0:_0x2c9ab9[_0x43b565(0x27d)]))return{'redos':_0x22c6af,'undos':_0x5da96a};for(const [_0x4e5366,_0x420743]of _0xfa4ef2){const _0x4187ab=_0x420743[_0x43b565(0x26f)];_0x4187ab[_0x43b565(0x1fe)]((_0xdaa54c,_0xc2203c,_0x48c6a4)=>{const _0x368d1b=_0x43b565;if(_0x3357bc[_0x368d1b(0x22e)](_0x333d6c,_0x48c6a4)){_0x96e939[_0x368d1b(0x269)](_0x4e5366);let _0x525fb5=_0xe9d716[_0x4e5366];_0x525fb5||(_0x525fb5={'config':_0x420743[_0x368d1b(0x230)],'sparklines':_0x420743['sparklines']['clone']()},_0xe9d716[_0x4e5366]=_0x525fb5);let _0x1e623f=_0x5f1b3d[_0x4e5366];_0x1e623f||(_0x1e623f={'config':_0x420743[_0x368d1b(0x230)],'sparklines':new _0x3722c9(_0x420743[_0x368d1b(0x26f)][_0x368d1b(0x1fc)]())},_0x5f1b3d[_0x4e5366]=_0x1e623f);const _0x5ab599=_0x5725da(_0x48c6a4,{'id':_0x5e0d5f['id'],'params':_0x480d44});_0x5ab599?_0x1e623f['sparklines'][_0x368d1b(0x22a)](_0xdaa54c,_0xc2203c,_0x5ab599):_0x1e623f[_0x368d1b(0x26f)][_0x368d1b(0x22a)](_0xdaa54c,_0xc2203c,{'startRow':-0x270f,'endRow':-0x270f,'startColumn':-0x270f,'endColumn':-0x270f,'rangeType':_0x4cac32[_0x368d1b(0x221)]});}}),_0x4187ab[_0x43b565(0x1fe)]((_0x373320,_0x25c1c2,_0x15d00b)=>{const _0x7cdfcc=_0x43b565;if(_0x373320<=_0x333d6c['endRow']&&_0x373320>=_0x333d6c[_0x7cdfcc(0x27f)]){_0x96e939['add'](_0x4e5366);let _0x35cd59=_0xe9d716[_0x4e5366];_0x35cd59||(_0x35cd59={'config':_0x420743[_0x7cdfcc(0x230)],'sparklines':_0x420743[_0x7cdfcc(0x26f)][_0x7cdfcc(0x1fc)]()},_0xe9d716[_0x4e5366]=_0x35cd59);let _0x10050c=_0x5f1b3d[_0x4e5366];_0x10050c||(_0x10050c={'config':_0x420743[_0x7cdfcc(0x230)],'sparklines':new _0x3722c9(_0x420743['sparklines'][_0x7cdfcc(0x1fc)]())},_0x5f1b3d[_0x4e5366]=_0x10050c);}});}_0x4e4e4a[_0x43b565(0x28f)]({'id':y['id'],'params':{'unitId':_0x1ba2dc,'subUnitId':_0x2d4285,'groupIds':Array[_0x43b565(0x20c)](_0x96e939),'isSingle':!0x1}}),_0x20ac33[_0x43b565(0x28f)]({'id':y['id'],'params':{'unitId':_0x1ba2dc,'subUnitId':_0x2d4285,'groupIds':Array[_0x43b565(0x20c)](_0x96e939),'isSingle':!0x1}});const _0x302d30={};let _0x8d3382=!0x1;return Object['entries'](_0x5f1b3d)[_0x43b565(0x26a)](([_0x619a55,_0x3a2552])=>{const _0x4ab8c4=_0x43b565;_0x3a2552[_0x4ab8c4(0x26f)]['getSizeOf']()&&(_0x8d3382=!0x0,_0x3a2552['sparklines'][_0x4ab8c4(0x291)](_0x333d6c[_0x4ab8c4(0x27f)],_0x333d6c['endRow']-_0x333d6c[_0x4ab8c4(0x27f)]+0x1),_0x302d30[_0x619a55]={'config':_0x3a2552[_0x4ab8c4(0x230)],'sparklines':_0x3a2552['sparklines'][_0x4ab8c4(0x1fc)]()});}),_0x8d3382&&_0x22c6af[_0x43b565(0x28f)]({'id':V['id'],'params':{'unitId':_0x1ba2dc,'subUnitId':_0x2d4285,'sparklineConfigMap':_0x302d30}}),_0x5da96a[_0x43b565(0x28f)]({'id':V['id'],'params':{'unitId':_0x1ba2dc,'subUnitId':_0x2d4285,'sparklineConfigMap':_0xe9d716}}),{'redos':_0x22c6af,'undos':_0x5da96a,'preRedos':_0x20ac33,'preUndos':_0x4e4e4a};}[_0x3be869(0x27e)](_0x54d2ce,_0x5a3ea9,_0x408352){const _0x108026=_0x3be869;var _0x2524e5,_0x5bc0ea;const {range:_0x18ab54}=_0x54d2ce,_0x5d92cb=new Set(),_0xeb51bf={},_0x5cf4dc={},_0x52419c=[],_0x32a1eb=[],_0x145962=[],_0x1b51a9=[];if(!_0x52cba3(this['_univerInstanceService'],{'unitId':_0x5a3ea9,'subUnitId':_0x408352}))return{'redos':_0x32a1eb,'undos':_0x52419c};const _0x8aef7e=this[_0x108026(0x1db)]['getSubUnitSparkline'](_0x5a3ea9,_0x408352);if(!_0x8aef7e)return{'redos':_0x32a1eb,'undos':_0x52419c};if(!((_0x5bc0ea=(_0x2524e5=this['_sparklineDataSourceModel'][_0x108026(0x1ed)]()[_0x108026(0x27a)][_0x108026(0x257)](_0x5a3ea9))==null?void 0x0:_0x2524e5['get'](_0x408352))==null?void 0x0:_0x5bc0ea[_0x108026(0x27d)]))return{'redos':_0x32a1eb,'undos':_0x52419c};for(const [_0x3c9999,_0x4f3f24]of _0x8aef7e){const _0x550e10=_0x4f3f24[_0x108026(0x26f)];_0x550e10[_0x108026(0x1fe)]((_0x41ab9b,_0x1d2389,_0x412a57)=>{const _0x49479c=_0x108026;if(_0x3357bc[_0x49479c(0x22e)](_0x18ab54,_0x412a57)){_0x5d92cb[_0x49479c(0x269)](_0x3c9999);let _0x389068=_0x5cf4dc[_0x3c9999];_0x389068||(_0x389068={'config':_0x4f3f24['config'],'sparklines':_0x4f3f24[_0x49479c(0x26f)][_0x49479c(0x1fc)]()},_0x5cf4dc[_0x3c9999]=_0x389068);let _0x16333c=_0xeb51bf[_0x3c9999];_0x16333c||(_0x16333c={'config':_0x4f3f24[_0x49479c(0x230)],'sparklines':new _0x3722c9(_0x4f3f24[_0x49479c(0x26f)]['clone']())},_0xeb51bf[_0x3c9999]=_0x16333c);const _0x18df90=_0x5725da(_0x412a57,{'id':_0x391108['id'],'params':_0x54d2ce});_0x18df90?_0x16333c[_0x49479c(0x26f)]['setValue'](_0x41ab9b,_0x1d2389,_0x18df90):_0x16333c[_0x49479c(0x26f)][_0x49479c(0x22a)](_0x41ab9b,_0x1d2389,{'startRow':-0x270f,'endRow':-0x270f,'startColumn':-0x270f,'endColumn':-0x270f,'rangeType':_0x4cac32[_0x49479c(0x221)]});}}),_0x550e10['forValue']((_0xbb9a4e,_0x6a95d7,_0x69f1d5)=>{const _0x51518e=_0x108026;if(_0x6a95d7<=_0x18ab54[_0x51518e(0x219)]&&_0x6a95d7>=_0x18ab54[_0x51518e(0x1f8)]){_0x5d92cb[_0x51518e(0x269)](_0x3c9999);let _0x2b33ef=_0x5cf4dc[_0x3c9999];_0x2b33ef||(_0x2b33ef={'config':_0x4f3f24[_0x51518e(0x230)],'sparklines':_0x4f3f24['sparklines'][_0x51518e(0x1fc)]()},_0x5cf4dc[_0x3c9999]=_0x2b33ef);let _0x348b6a=_0xeb51bf[_0x3c9999];_0x348b6a||(_0x348b6a={'config':_0x4f3f24['config'],'sparklines':new _0x3722c9(_0x4f3f24[_0x51518e(0x26f)][_0x51518e(0x1fc)]())},_0xeb51bf[_0x3c9999]=_0x348b6a);}});}_0x1b51a9['push']({'id':y['id'],'params':{'unitId':_0x5a3ea9,'subUnitId':_0x408352,'groupIds':Array['from'](_0x5d92cb),'isSingle':!0x1}}),_0x145962[_0x108026(0x28f)]({'id':y['id'],'params':{'unitId':_0x5a3ea9,'subUnitId':_0x408352,'groupIds':Array[_0x108026(0x20c)](_0x5d92cb),'isSingle':!0x1}});const _0x2c7e5a={};let _0x5075bf=!0x1;return Object[_0x108026(0x24f)](_0xeb51bf)['forEach'](([_0x17b2a4,_0x3a210a])=>{const _0x415e11=_0x108026;_0x3a210a[_0x415e11(0x26f)][_0x415e11(0x225)]()&&(_0x5075bf=!0x0,_0x3a210a['sparklines'][_0x415e11(0x251)](_0x18ab54['startColumn'],_0x18ab54[_0x415e11(0x219)]-_0x18ab54['startColumn']+0x1),_0x2c7e5a[_0x17b2a4]={'config':_0x3a210a[_0x415e11(0x230)],'sparklines':_0x3a210a[_0x415e11(0x26f)][_0x415e11(0x1fc)]()});}),_0x5075bf&&_0x32a1eb[_0x108026(0x28f)]({'id':V['id'],'params':{'unitId':_0x5a3ea9,'subUnitId':_0x408352,'sparklineConfigMap':_0x2c7e5a}}),_0x52419c['push']({'id':V['id'],'params':{'unitId':_0x5a3ea9,'subUnitId':_0x408352,'sparklineConfigMap':_0x5cf4dc}}),{'redos':_0x32a1eb,'undos':_0x52419c,'preRedos':_0x145962,'preUndos':_0x1b51a9};}[_0x3be869(0x209)](){const _0xb1bc19=_0x3be869;this[_0xb1bc19(0x218)](this[_0xb1bc19(0x202)]['onCommandExecuted'](_0x57e406=>{const _0x349b08=_0xb1bc19;if(_0x57e406['id']===_0x1347b7['id']){const _0x35fddc=_0x57e406['params'],{unitId:_0x345a3f,subUnitId:_0x4e2ccb,range:_0x15a9e7}=_0x35fddc,_0x59c00d=_0x15a9e7[_0x349b08(0x1f8)],_0x1dbf67=_0x15a9e7[_0x349b08(0x219)]-_0x15a9e7[_0x349b08(0x1f8)]+0x1,_0x471674=this[_0x349b08(0x1db)][_0x349b08(0x287)](_0x345a3f,_0x4e2ccb);if(!_0x471674)return;for(const [_0x38498f,_0x209e28]of _0x471674){this[_0x349b08(0x1db)][_0x349b08(0x277)](_0x345a3f,_0x4e2ccb,_0x38498f);const _0x2a4d9e=_0x209e28[_0x349b08(0x26f)];_0x2a4d9e[_0x349b08(0x1fe)]((_0x21e80a,_0x42a532,_0x1d7d0a)=>{const _0x18c8dc=_0x349b08,_0x381d2c={..._0x1d7d0a};_0x59c00d<=_0x381d2c[_0x18c8dc(0x1f8)]?(_0x381d2c['startColumn']+=_0x1dbf67,_0x381d2c[_0x18c8dc(0x219)]+=_0x1dbf67):_0x59c00d>_0x381d2c[_0x18c8dc(0x219)]||(_0x381d2c['endColumn']+=_0x1dbf67),_0x2a4d9e['setValue'](_0x21e80a,_0x42a532,_0x381d2c);});const _0x2ff4f1=_0x2a4d9e[_0x349b08(0x272)]();for(const _0x44e705 in _0x2ff4f1){const _0x5bc91a=_0x2ff4f1[Number(_0x44e705)];if(!_0x5bc91a)continue;const _0x14792a=Object['keys'](_0x5bc91a)[_0x349b08(0x275)](Number),_0x321bb0=Math[_0x349b08(0x20f)](..._0x14792a);for(let _0xdbd5ee=_0x321bb0;_0xdbd5ee>=_0x59c00d;_0xdbd5ee--)_0xdbd5ee>=_0x59c00d&&_0x5bc91a[_0xdbd5ee]&&(_0x5bc91a[_0xdbd5ee+_0x1dbf67]=_0x5bc91a[_0xdbd5ee],delete _0x5bc91a[_0xdbd5ee]);}this['_sparklineDataSourceModel'][_0x349b08(0x24e)](_0x345a3f,_0x4e2ccb,_0x38498f);}}else{if(_0x57e406['id']===_0x48db8e['id']){const _0x1aaa2b=_0x57e406[_0x349b08(0x28e)],{unitId:_0x1906e9,subUnitId:_0x4d207d,range:_0x4a3947}=_0x1aaa2b,_0x468c46=_0x4a3947[_0x349b08(0x27f)],_0x5bd0f9=_0x4a3947[_0x349b08(0x1f1)]-_0x4a3947['startRow']+0x1,_0xec3213=this[_0x349b08(0x1db)][_0x349b08(0x287)](_0x1906e9,_0x4d207d);if(!_0xec3213)return;for(const [_0x86ce0d,_0x3ac24a]of _0xec3213){this[_0x349b08(0x1db)][_0x349b08(0x277)](_0x1906e9,_0x4d207d,_0x86ce0d);const _0x1e73ba=_0x3ac24a[_0x349b08(0x26f)];_0x1e73ba['forValue']((_0x4ee62e,_0x126de8,_0x53c286)=>{const _0x3bc7b7=_0x349b08,_0x4af2ba={..._0x53c286};_0x468c46<=_0x4af2ba[_0x3bc7b7(0x27f)]?(_0x4af2ba[_0x3bc7b7(0x27f)]+=_0x5bd0f9,_0x4af2ba[_0x3bc7b7(0x1f1)]+=_0x5bd0f9):_0x468c46>_0x4af2ba[_0x3bc7b7(0x1f1)]||(_0x4af2ba[_0x3bc7b7(0x1f1)]+=_0x5bd0f9),_0x1e73ba[_0x3bc7b7(0x22a)](_0x4ee62e,_0x126de8,_0x4af2ba);});const _0x8e62bf=_0x1e73ba[_0x349b08(0x272)](),_0x4dc3be=Object['keys'](_0x8e62bf)[_0x349b08(0x275)](Number),_0x34b2b5=Math[_0x349b08(0x20f)](..._0x4dc3be);for(let _0x553ce7=_0x34b2b5;_0x553ce7>=_0x468c46;_0x553ce7--)_0x553ce7>=_0x468c46&&_0x8e62bf[_0x553ce7]&&(_0x8e62bf[_0x553ce7+_0x5bd0f9]=_0x8e62bf[_0x553ce7],delete _0x8e62bf[_0x553ce7]);this[_0x349b08(0x1db)]['updateSparklineExtraNum'](_0x1906e9,_0x4d207d,_0x86ce0d);}}else{if(_0x57e406['id']===_0x391108['id']){const _0xc4c8b0=_0x57e406[_0x349b08(0x28e)],{range:_0x413c81,unitId:_0x3436a8,subUnitId:_0xb8e91f}=_0xc4c8b0,_0x2a6d93=this[_0x349b08(0x1db)][_0x349b08(0x287)](_0x3436a8,_0xb8e91f);if(!_0x2a6d93)return;for(const [_0x1ab779,_0x271563]of _0x2a6d93){const _0x221efe=_0x271563[_0x349b08(0x26f)];_0x221efe[_0x349b08(0x1fe)]((_0x41383b,_0x41758,_0x75f5ed)=>{const _0x1990ff=_0x5725da(_0x75f5ed,_0x57e406);_0x1990ff?_0x221efe['setValue'](_0x41383b,_0x41758,_0x1990ff):_0x221efe['setValue'](_0x41383b,_0x41758,{'startRow':-0x270f,'endRow':-0x270f,'startColumn':-0x270f,'endColumn':-0x270f,'rangeType':_0x4cac32['NORMAL']});}),_0x221efe[_0x349b08(0x251)](_0x413c81[_0x349b08(0x1f8)],_0x413c81[_0x349b08(0x219)]-_0x413c81[_0x349b08(0x1f8)]+0x1);}this['_sparklineDataSourceModel'][_0x349b08(0x21a)](_0x3436a8,_0xb8e91f);}else{if(_0x57e406['id']===_0x5e0d5f['id']){const _0x19ab6a=_0x57e406[_0x349b08(0x28e)],{range:_0x4953ff,unitId:_0x45a7c6,subUnitId:_0x51dc2e}=_0x19ab6a,_0x9a61ad=this[_0x349b08(0x1db)][_0x349b08(0x287)](_0x45a7c6,_0x51dc2e);if(!_0x9a61ad)return;for(const [_0x5d479d,_0x5bcd00]of _0x9a61ad){const _0x3a69b6=_0x5bcd00[_0x349b08(0x26f)];_0x3a69b6[_0x349b08(0x1fe)]((_0xb808d2,_0x2e01b8,_0x135b72)=>{const _0x46c545=_0x349b08,_0x4b4b1e=_0x5725da(_0x135b72,_0x57e406);_0x4b4b1e?_0x3a69b6[_0x46c545(0x22a)](_0xb808d2,_0x2e01b8,_0x4b4b1e):_0x3a69b6['setValue'](_0xb808d2,_0x2e01b8,{'startRow':-0x270f,'endRow':-0x270f,'startColumn':-0x270f,'endColumn':-0x270f,'rangeType':_0x4cac32[_0x46c545(0x221)]});}),_0x3a69b6['removeRows'](_0x4953ff[_0x349b08(0x27f)],_0x4953ff[_0x349b08(0x1f1)]-_0x4953ff[_0x349b08(0x27f)]+0x1);}this['_sparklineDataSourceModel'][_0x349b08(0x21a)](_0x45a7c6,_0x51dc2e);}else{if(_0x57e406['id']===_0x14f2ba['id']){const _0xfcd751=_0x57e406[_0x349b08(0x28e)],{unitId:_0x2c3240,subUnitId:_0x3d29b5,sourceRange:_0x65c2eb,targetRange:_0xb7383d}=_0xfcd751,_0xb63159=this[_0x349b08(0x1db)][_0x349b08(0x287)](_0x2c3240,_0x3d29b5);if(!_0xb63159)return;for(const [_0x964c26,_0x118ac6]of _0xb63159){const _0x4f3182=_0x118ac6[_0x349b08(0x26f)];_0x4f3182[_0x349b08(0x1fe)]((_0x131992,_0x22c30d,_0x16058b)=>{const _0x17e1eb=_0x349b08,_0x6e153d=_0x5725da(_0x16058b,_0x57e406);_0x6e153d?_0x4f3182[_0x17e1eb(0x22a)](_0x131992,_0x22c30d,_0x6e153d):_0x4f3182[_0x17e1eb(0x22a)](_0x131992,_0x22c30d,{'startRow':-0x270f,'endRow':-0x270f,'startColumn':-0x270f,'endColumn':-0x270f,'rangeType':_0x4cac32['NORMAL']});}),_0x4f3182[_0x349b08(0x289)](_0x65c2eb[_0x349b08(0x1f8)],_0x65c2eb[_0x349b08(0x219)]-_0x65c2eb[_0x349b08(0x1f8)]+0x1,_0xb7383d[_0x349b08(0x1f8)]);}this['_sparklineDataSourceModel'][_0x349b08(0x21a)](_0x2c3240,_0x3d29b5);}else{if(_0x57e406['id']===_0x1ff2a4['id']){const _0x1379b7=_0x57e406[_0x349b08(0x28e)],{unitId:_0x507e8c,subUnitId:_0x4857f4,sourceRange:_0x40386d,targetRange:_0x128148}=_0x1379b7,_0x354d49=this[_0x349b08(0x1db)]['getSubUnitSparkline'](_0x507e8c,_0x4857f4);if(!_0x354d49)return;for(const [_0x288cd4,_0x2a7ef1]of _0x354d49){const _0x17ad7a=_0x2a7ef1[_0x349b08(0x26f)];_0x17ad7a[_0x349b08(0x1fe)]((_0x199cb2,_0x3e146e,_0x39344d)=>{const _0x1feb99=_0x349b08,_0x1bbe4c=_0x5725da(_0x39344d,_0x57e406);_0x1bbe4c?_0x17ad7a['setValue'](_0x199cb2,_0x3e146e,_0x1bbe4c):_0x17ad7a['setValue'](_0x199cb2,_0x3e146e,{'startRow':-0x270f,'endRow':-0x270f,'startColumn':-0x270f,'endColumn':-0x270f,'rangeType':_0x4cac32[_0x1feb99(0x221)]});}),_0x17ad7a['moveRows'](_0x40386d[_0x349b08(0x27f)],_0x40386d[_0x349b08(0x1f1)]-_0x40386d[_0x349b08(0x27f)]+0x1,_0x128148[_0x349b08(0x27f)]);}this[_0x349b08(0x1db)][_0x349b08(0x21a)](_0x507e8c,_0x4857f4);}else{if(_0x57e406['id']===_0x540ca1['id']){const _0x289442=_0x57e406[_0x349b08(0x28e)],{fromRange:_0x3fe442,toRange:_0x22d641,unitId:_0x2463cf,from:_0x16cc09,to:_0x1bb9f3}=_0x289442;if(_0x16cc09[_0x349b08(0x214)]!==_0x1bb9f3[_0x349b08(0x214)])return;const _0xe56ca0=_0x16cc09[_0x349b08(0x214)],{startRow:_0x52250f,endRow:_0x3ca5b5,startColumn:_0x5e2974,endColumn:_0x121ce1}=_0x3fe442,{startRow:_0x2c85c7,startColumn:_0x2c077a}=_0x22d641,_0x31fb01=_0x2c85c7-_0x52250f,_0x236ae8=_0x2c077a-_0x5e2974,_0x30e043=this[_0x349b08(0x1db)]['getSubUnitSparkline'](_0x2463cf,_0xe56ca0);if(!(_0x30e043!=null&&_0x30e043['size']))return;for(let _0x19da5b=_0x52250f;_0x19da5b<=_0x3ca5b5;_0x19da5b++)for(let _0x1693f2=_0x5e2974;_0x1693f2<=_0x121ce1;_0x1693f2++){const _0x202bdc=this[_0x349b08(0x1db)][_0x349b08(0x207)](_0x2463cf,_0xe56ca0,_0x19da5b,_0x1693f2);if(_0x202bdc){const _0x3c3fe8=this['_sparklineDataSourceModel'][_0x349b08(0x231)](_0x2463cf,_0xe56ca0,_0x202bdc);if(_0x3c3fe8){const _0x2d4872=_0x3c3fe8[_0x349b08(0x26f)][_0x349b08(0x283)](_0x19da5b,_0x1693f2);_0x2d4872&&(_0x3c3fe8['sparklines'][_0x349b08(0x22a)](_0x19da5b+_0x31fb01,_0x1693f2+_0x236ae8,_0x2d4872),_0x3c3fe8[_0x349b08(0x26f)]['realDeleteValue'](_0x19da5b,_0x1693f2));}}}for(const [_0x363f38,_0x1a957a]of _0x30e043){const _0x20e8b4=_0x1a957a['sparklines'];_0x20e8b4[_0x349b08(0x1fe)]((_0x30dbec,_0x43932d,_0x12dedc)=>{const _0x354446=_0x349b08,_0x3a9e9e={..._0x12dedc};_0x3357bc[_0x354446(0x23a)](_0x3fe442,_0x12dedc)&&(_0x3a9e9e[_0x354446(0x27f)]+=_0x31fb01,_0x3a9e9e[_0x354446(0x1f1)]+=_0x31fb01,_0x3a9e9e[_0x354446(0x1f8)]+=_0x236ae8,_0x3a9e9e['endColumn']+=_0x236ae8),_0x20e8b4[_0x354446(0x22a)](_0x30dbec,_0x43932d,_0x3a9e9e);});}this[_0x349b08(0x1db)][_0x349b08(0x21a)](_0x2463cf,_0xe56ca0);}}}}}}}}));}};Me=Kt([ge(0x0,_0x1342b4(_0x1e9e76)),ge(0x1,_0x1342b4(_0x3e204c)),ge(0x2,_0x36b83f),ge(0x3,_0x1342b4(x))],Me);var Xt=Object[_0x3be869(0x279)],zt=(_0x27cd4f,_0x36ac3f,_0x242967,_0x294a99)=>{for(var _0x2d3fd3=_0x294a99>0x1?void 0x0:_0x294a99?Xt(_0x36ac3f,_0x242967):_0x36ac3f,_0x97e53f=_0x27cd4f['length']-0x1,_0x437ebd;_0x97e53f>=0x0;_0x97e53f--)(_0x437ebd=_0x27cd4f[_0x97e53f])&&(_0x2d3fd3=_0x437ebd(_0x2d3fd3)||_0x2d3fd3);return _0x2d3fd3;},Be=(_0x2dcffa,_0x33c856)=>(_0x413deb,_0x393644)=>_0x33c856(_0x413deb,_0x393644,_0x2dcffa);function _0x4a89(_0x47ceda,_0x48203e){const _0x51620a=_0x5162();return _0x4a89=function(_0x4a89d9,_0x5f04ce){_0x4a89d9=_0x4a89d9-0x1d6;let _0x437e1c=_0x51620a[_0x4a89d9];return _0x437e1c;},_0x4a89(_0x47ceda,_0x48203e);}let Re=class extends _0x175b87{constructor(_0x137465,_0x476260){const _0x3fd2ad=_0x3be869;super(),this[_0x3fd2ad(0x1f9)]=_0x137465,this[_0x3fd2ad(0x1db)]=_0x476260,this[_0x3fd2ad(0x1ea)]();}['_initSnapshot'](){const _0x5b2950=_0x3be869,_0x4fdae7=_0x102b5d=>{const _0x431617=_0x4a89,_0xe744a4=this['_sparklineDataSourceModel']['toJSON'](_0x102b5d);return _0xe744a4?JSON[_0x431617(0x22d)](_0xe744a4):'';},_0x180f68=_0x512c56=>_0x512c56?JSON['parse'](_0x512c56):{};this['disposeWithMe'](this['_resourceManagerService'][_0x5b2950(0x1e7)]({'toJson':_0x4fdae7,'parseJson':_0x180f68,'pluginName':Ke,'businesses':[_0x1a6a86['UNIVER_SHEET']],'onLoad':(_0x1d037e,_0x42237d)=>{const _0x18642f=_0x5b2950;this['_sparklineDataSourceModel'][_0x18642f(0x28b)](_0x42237d);},'onUnLoad':_0x5d6378=>{const _0x2f3d38=_0x5b2950;this[_0x2f3d38(0x1db)][_0x2f3d38(0x266)](_0x5d6378);}}));}};Re=zt([Be(0x0,_0x1342b4(_0x46e909)),Be(0x1,_0x1342b4(x))],Re);var Jt=Object['defineProperty'],Zt=Object[_0x3be869(0x279)],Yt=(_0x538caa,_0x112dc3,_0x4fc63e)=>_0x112dc3 in _0x538caa?Jt(_0x538caa,_0x112dc3,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0x4fc63e}):_0x538caa[_0x112dc3]=_0x4fc63e,qt=(_0x5206a1,_0x354718,_0x4122bd,_0x4a60d5)=>{const _0x2ee5f7=_0x3be869;for(var _0x5887d7=_0x4a60d5>0x1?void 0x0:_0x4a60d5?Zt(_0x354718,_0x4122bd):_0x354718,_0x514e79=_0x5206a1[_0x2ee5f7(0x233)]-0x1,_0x287b67;_0x514e79>=0x0;_0x514e79--)(_0x287b67=_0x5206a1[_0x514e79])&&(_0x5887d7=_0x287b67(_0x5887d7)||_0x5887d7);return _0x5887d7;},He=(_0x972923,_0x4df308)=>(_0x5abcc3,_0x3803b7)=>_0x4df308(_0x5abcc3,_0x3803b7,_0x972923),ze=(_0x36589d,_0x53e3f6,_0x19eee9)=>Yt(_0x36589d,typeof _0x53e3f6!='symbol'?_0x53e3f6+'':_0x53e3f6,_0x19eee9);let ve=class extends _0x838a86{constructor(_0x55e9be={},_0x1c6cc2,_0x13adf9){const _0x561e7c=_0x3be869;super(),this[_0x561e7c(0x20a)]=_0x55e9be,this[_0x561e7c(0x26e)]=_0x1c6cc2,this[_0x561e7c(0x202)]=_0x13adf9,this[_0x561e7c(0x1f3)](),this[_0x561e7c(0x204)]();}[_0x3be869(0x1f3)](){const _0x1ad896=_0x3be869;[[x],[me],[_e],[Se],[Me],[Ce],[ke],[Re]][_0x1ad896(0x26a)](_0x4637aa=>{const _0x40d3cc=_0x1ad896;this[_0x40d3cc(0x26e)]['add'](_0x4637aa);}),_0x26905c(this[_0x1ad896(0x26e)],[[Re]]);}['onReady'](){const _0x244d3=_0x3be869;_0x26905c(this[_0x244d3(0x26e)],[[me],[_e],[Se],[Me],[Ce],[ke]]);}[_0x3be869(0x204)](){const _0x176799=_0x3be869;[Nt,V,Ot,y,xt,Oe][_0x176799(0x26a)](_0x4a84c4=>this[_0x176799(0x202)]['registerCommand'](_0x4a84c4));}};ze(ve,_0x3be869(0x21b),Ke),ze(ve,_0x3be869(0x21d),_0x1a6a86['UNIVER_SHEET']),ve=qt([_0x436efd(_0x333cb0),He(0x1,_0x1342b4(_0x125d54)),He(0x2,_0x1342b4(_0x1e9e76))],ve);export{Nt as AddSheetSparklineCommand,V as AddSheetSparklineMutation,Ke as PLUGIN_NAME,Ot as RemoveSheetSparklineCommand,y as RemoveSheetSparklineMutation,xt as SetSheetSparklineCommand,Oe as SetSheetSparklineMutation,J as SpacialShowAsEnum,x as SparklineDataSourceModel,De as SparklineExtremumTypeEnum,on as SparklinePointsNames,Le as SparklineThemeMapping,Xe as SparklineThemeTypeEnum,Dt as SparklineTypeEnum,ve as UniverSheetSparklinePlugin,Fe as getSparklinePlacement};