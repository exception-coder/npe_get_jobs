function _0x5930(){const _0x5447d9=['object','cancel','getAllSubSparkline','getCurrentSelections','_col','syncExecuteCommand','SparklineTypeEnum','getOwnPropertyDescriptor','FEnum','getActiveSheet','_workbook','_unitId','function','map','filter','FSparklineGroup','Event','get','375150oHnVbQ','1615355treMzd','executeCommand','Inject','74146rjMEIE','unComposeSparkline','fireEvent','@univerjs/sheets/facade','changeDataSource','_groupId','7TNUUnW','128JmgwkO','3036190meuzDZ','deepClone','defineProperty','FSparkline','range','getUnitId','startColumn','_subUnitId','@univerjs/sheets','_initialize','sparklineAnchorMap','UniverSheetsFacade','ICommandService','extend','add','getSheetId','Tools','setConfig','Injector','getId','getSubUnitSparkline','isChangeDataSource','SetSheetSparklineCommand','UniverProSheetsSparklineFacade','_commandService','UniverCoreFacade','getSparkline','SheetsSelectionsService','toStringTag','getSparklineById','UniverCore','FEventName','removeSparklineGroup','1881OxJRGy','item','SparklineDataSourceModel','FUniver','exports','SheetSparklineChanged','length','group','_row','startRow','_injector','FWorksheet','78010NbUcRL','forEach','getSparklineByCell','createInstance','Sheet\x20create\x20canceled\x20by\x20facade\x20api.','groupId','6744488JXFSWp','_worksheet','74040USKvnQ','composeSparkline','onCommandExecuted','@univerjs/core/facade','AddSheetSparklineCommand','getSparklineCache','registerEventHandler'];_0x5930=function(){return _0x5447d9;};return _0x5930();}function _0x5a48(_0x53b7f6,_0xc73c75){const _0x593088=_0x5930();return _0x5a48=function(_0x5a48ad,_0x35b127){_0x5a48ad=_0x5a48ad-0xf4;let _0x4cb18d=_0x593088[_0x5a48ad];return _0x4cb18d;},_0x5a48(_0x53b7f6,_0xc73c75);}(function(_0x321f38,_0x358a34){const _0x46f8f0=_0x5a48,_0xbdb76a=_0x321f38();while(!![]){try{const _0x44f0e2=parseInt(_0x46f8f0(0x146))/0x1*(-parseInt(_0x46f8f0(0x140))/0x2)+-parseInt(_0x46f8f0(0x123))/0x3*(parseInt(_0x46f8f0(0x147))/0x4)+-parseInt(_0x46f8f0(0x148))/0x5+-parseInt(_0x46f8f0(0x13c))/0x6+-parseInt(_0x46f8f0(0x13d))/0x7+parseInt(_0x46f8f0(0x121))/0x8+-parseInt(_0x46f8f0(0x10f))/0x9*(-parseInt(_0x46f8f0(0x11b))/0xa);if(_0x44f0e2===_0x358a34)break;else _0xbdb76a['push'](_0xbdb76a['shift']());}catch(_0x28e4d1){_0xbdb76a['push'](_0xbdb76a['shift']());}}}(_0x5930,0x7fd97),function(_0x4b0d30,_0x1f9920){const _0x208b68=_0x5a48;typeof exports==_0x208b68(0x12a)&&typeof module<'u'?_0x1f9920(exports,require('@univerjs-pro/sheets-sparkline'),require('@univerjs/core'),require('@univerjs/sheets/facade'),require('@univerjs/core/facade'),require('@univerjs/sheets')):typeof define==_0x208b68(0x136)&&define['amd']?define([_0x208b68(0x113),'@univerjs-pro/sheets-sparkline','@univerjs/core',_0x208b68(0x143),_0x208b68(0x126),_0x208b68(0xf6)],_0x1f9920):(_0x4b0d30=typeof globalThis<'u'?globalThis:_0x4b0d30||self,_0x1f9920(_0x4b0d30[_0x208b68(0x105)]={},_0x4b0d30['UniverProSheetsSparkline'],_0x4b0d30[_0x208b68(0x10c)],_0x4b0d30[_0x208b68(0xf9)],_0x4b0d30[_0x208b68(0x107)],_0x4b0d30['UniverSheets']));}(this,function(_0x334470,_0x5ac069,_0x55d7ea,_0x23931b,_0x5d7f87,_0x595eb8){'use strict';const _0x8b7a35=_0x5a48;var _0x348045=Object[_0x8b7a35(0x131)],_0x1467d1=(_0x5de5de,_0x3f14c1,_0xc08eba,_0x20e9d0)=>{const _0x4a8e8e=_0x8b7a35;for(var _0x5e0301=_0x20e9d0>0x1?void 0x0:_0x20e9d0?_0x348045(_0x3f14c1,_0xc08eba):_0x3f14c1,_0x4cd28f=_0x5de5de[_0x4a8e8e(0x115)]-0x1,_0xd2f18;_0x4cd28f>=0x0;_0x4cd28f--)(_0xd2f18=_0x5de5de[_0x4cd28f])&&(_0x5e0301=_0xd2f18(_0x5e0301)||_0x5e0301);return _0x5e0301;},_0x3ecb5d=(_0xb189ba,_0x59e47c)=>(_0x3ea8fe,_0x15faee)=>_0x59e47c(_0x3ea8fe,_0x15faee,_0xb189ba);_0x334470['FSparkline']=class{constructor(_0x45bca0,_0x19fd59,_0x52966b,_0x5f43fe,_0x59a5bb,_0x4ef10d){const _0x51cb96=_0x8b7a35;this[_0x51cb96(0x135)]=_0x45bca0,this[_0x51cb96(0xf5)]=_0x19fd59,this[_0x51cb96(0x145)]=_0x52966b,this['_row']=_0x5f43fe,this[_0x51cb96(0x12e)]=_0x59a5bb,this[_0x51cb96(0x119)]=_0x4ef10d;}[_0x8b7a35(0x144)](_0x31df8c,_0x4105af){const _0x134c28=_0x8b7a35,_0x1b8d4a=this[_0x134c28(0x119)][_0x134c28(0x13b)](_0x5ac069[_0x134c28(0x111)]),_0x1944de=this[_0x134c28(0x119)][_0x134c28(0x13b)](_0x55d7ea['ICommandService']),_0x108621=_0x1b8d4a[_0x134c28(0x10b)](this[_0x134c28(0x135)],this[_0x134c28(0xf5)],this[_0x134c28(0x145)]);if(!_0x108621)return;const _0x317bc4={'config':_0x108621,'isChangeDataSource':!0x0,'changeDataSourceInfo':{'groupId':this[_0x134c28(0x145)],'resetType':_0x134c28(0x110),'sourceRanges':[_0x31df8c],'targetRanges':[_0x4105af],'primary':{'startRow':this[_0x134c28(0x117)],'startColumn':this[_0x134c28(0x12e)],'endRow':this[_0x134c28(0x117)],'endColumn':this[_0x134c28(0x12e)],'actualRow':this[_0x134c28(0x117)],'actualColumn':this[_0x134c28(0x12e)],'isMerged':!0x1,'isMergedMainCell':!0x1}}};return _0x1944de['syncExecuteCommand'](_0x5ac069[_0x134c28(0x104)]['id'],_0x317bc4),this[_0x134c28(0x117)]=_0x4105af['startRow'],this[_0x134c28(0x12e)]=_0x4105af['startColumn'],this;}['removeSparkline'](){const _0x459853=_0x8b7a35,_0x21053a=this[_0x459853(0x119)][_0x459853(0x13b)](_0x55d7ea[_0x459853(0xfa)]),_0x61d2d={'isSingle':!0x0,'ranges':[{'startRow':this[_0x459853(0x117)],'startColumn':this['_col'],'endRow':this[_0x459853(0x117)],'endColumn':this[_0x459853(0x12e)]}]};_0x21053a['syncExecuteCommand'](_0x5ac069['RemoveSheetSparklineCommand']['id'],_0x61d2d);}},_0x334470[_0x8b7a35(0x14b)]=_0x1467d1([_0x3ecb5d(0x5,_0x55d7ea['Inject'](_0x55d7ea[_0x8b7a35(0x100)]))],_0x334470[_0x8b7a35(0x14b)]);var _0x8eca87=Object[_0x8b7a35(0x131)],_0x22d1bc=(_0x266064,_0x515cb9,_0x1fcbf8,_0x4473ba)=>{const _0x17f2f9=_0x8b7a35;for(var _0x5e893b=_0x4473ba>0x1?void 0x0:_0x4473ba?_0x8eca87(_0x515cb9,_0x1fcbf8):_0x515cb9,_0x10dca6=_0x266064[_0x17f2f9(0x115)]-0x1,_0x13ef3d;_0x10dca6>=0x0;_0x10dca6--)(_0x13ef3d=_0x266064[_0x10dca6])&&(_0x5e893b=_0x13ef3d(_0x5e893b)||_0x5e893b);return _0x5e893b;},_0x5b4397=(_0x1bcbc2,_0x1c8bff)=>(_0x483b77,_0x3450d2)=>_0x1c8bff(_0x483b77,_0x3450d2,_0x1bcbc2);_0x334470['FSparklineGroup']=class{constructor(_0x464e01,_0xfc947,_0x556454,_0x22d6f1,_0x2bc25e,_0x1b25a0){const _0x5df66b=_0x8b7a35;this[_0x5df66b(0x135)]=_0x464e01,this[_0x5df66b(0xf5)]=_0xfc947,this['_groupId']=_0x556454,this['_row']=_0x22d6f1,this[_0x5df66b(0x12e)]=_0x2bc25e,this[_0x5df66b(0x119)]=_0x1b25a0;}['changeDataSource'](_0x4058d1,_0x582adf){const _0x37acee=_0x8b7a35,_0x5bf299=this['_injector'][_0x37acee(0x13b)](_0x5ac069[_0x37acee(0x111)]),_0x2342d7=this[_0x37acee(0x119)][_0x37acee(0x13b)](_0x55d7ea[_0x37acee(0xfa)]),_0x455b6f=_0x5bf299[_0x37acee(0x10b)](this[_0x37acee(0x135)],this[_0x37acee(0xf5)],this[_0x37acee(0x145)]);if(!_0x455b6f)return;const _0x643cb={'config':_0x455b6f,'isChangeDataSource':!0x0,'changeDataSourceInfo':{'groupId':this[_0x37acee(0x145)],'resetType':_0x37acee(0x116),'sourceRanges':_0x4058d1,'targetRanges':_0x582adf,'primary':{'startRow':this['_row'],'startColumn':this[_0x37acee(0x12e)],'endRow':this[_0x37acee(0x117)],'endColumn':this[_0x37acee(0x12e)],'actualRow':this[_0x37acee(0x117)],'actualColumn':this['_col'],'isMerged':!0x1,'isMergedMainCell':!0x1}}};return _0x2342d7[_0x37acee(0x12f)](_0x5ac069[_0x37acee(0x104)]['id'],_0x643cb),this[_0x37acee(0x117)]=_0x582adf[0x0][_0x37acee(0x118)],this['_col']=_0x582adf[0x0][_0x37acee(0xf4)],this;}[_0x8b7a35(0x10e)](){const _0x1231eb=_0x8b7a35,_0x517360=this[_0x1231eb(0x119)][_0x1231eb(0x13b)](_0x55d7ea[_0x1231eb(0xfa)]),_0x28f9fb={'isSingle':!0x1,'ranges':[{'startRow':this['_row'],'startColumn':this[_0x1231eb(0x12e)],'endRow':this[_0x1231eb(0x117)],'endColumn':this[_0x1231eb(0x12e)]}]};_0x517360[_0x1231eb(0x12f)](_0x5ac069['RemoveSheetSparklineCommand']['id'],_0x28f9fb);}[_0x8b7a35(0xff)](_0x15cc06){const _0x2aa543=_0x8b7a35,_0x53d3a3=this[_0x2aa543(0x119)]['get'](_0x5ac069[_0x2aa543(0x111)])[_0x2aa543(0x10b)](this[_0x2aa543(0x135)],this['_subUnitId'],this[_0x2aa543(0x145)]);if(_0x53d3a3){const _0x338f8d={'config':{'config':_0x15cc06,'sparklines':_0x53d3a3['sparklines']},'isChangeDataSource':!0x1};this[_0x2aa543(0x119)][_0x2aa543(0x13b)](_0x55d7ea[_0x2aa543(0xfa)])[_0x2aa543(0x12f)](_0x5ac069[_0x2aa543(0x104)]['id'],_0x338f8d);}return this;}},_0x334470[_0x8b7a35(0x139)]=_0x22d1bc([_0x5b4397(0x5,_0x55d7ea[_0x8b7a35(0x13f)](_0x55d7ea[_0x8b7a35(0x100)]))],_0x334470[_0x8b7a35(0x139)]);class _0xf275a5 extends _0x23931b['FWorksheet']{['addSparkline'](_0x5517a0,_0x44db48,_0x3a3867){const _0x31b869=_0x8b7a35;if(this[_0x31b869(0x106)]['syncExecuteCommand'](_0x5ac069[_0x31b869(0x127)]['id'],{'sourceRanges':_0x5517a0,'targetRanges':_0x44db48,'targetInfo':{'unitId':this[_0x31b869(0x134)][_0x31b869(0x14d)](),'subUnitId':this[_0x31b869(0x122)][_0x31b869(0xfd)]()},'config':{'type':_0x3a3867}})){const {startRow:_0xaf2dc0,startColumn:_0x537890}=_0x44db48[0x0];return this[_0x31b869(0x11d)](_0xaf2dc0,_0x537890);}}[_0x8b7a35(0x12c)](){const _0xcda2e7=_0x8b7a35;return this['_injector']['get'](_0x5ac069[_0xcda2e7(0x111)])[_0xcda2e7(0x102)](this[_0xcda2e7(0x134)][_0xcda2e7(0x14d)](),this['_worksheet'][_0xcda2e7(0xfd)]());}[_0x8b7a35(0x124)](_0x574b4f){const _0x27b2cb=_0x8b7a35,_0x27eec9=this['_injector'][_0x27b2cb(0x13b)](_0x5ac069[_0x27b2cb(0x111)]);let _0x33ed0e;for(let _0xbaf861=0x0;_0xbaf861<_0x574b4f[_0x27b2cb(0x115)];_0xbaf861++){const _0x5dea91=_0x574b4f[_0xbaf861],{startRow:_0x203ee9,endRow:_0xaf9f21,startColumn:_0x56dca1,endColumn:_0x4987c2}=_0x5dea91;for(let _0x350fa3=_0x203ee9;_0x350fa3<=_0xaf9f21;_0x350fa3++)for(let _0x17afdf=_0x56dca1;_0x17afdf<=_0x4987c2;_0x17afdf++){const _0x206d89=_0x27eec9[_0x27b2cb(0x108)](this[_0x27b2cb(0x134)][_0x27b2cb(0x14d)](),this[_0x27b2cb(0x122)][_0x27b2cb(0xfd)](),_0x350fa3,_0x17afdf);if(_0x206d89){const _0x231753=_0x27eec9[_0x27b2cb(0x10b)](this[_0x27b2cb(0x134)][_0x27b2cb(0x14d)](),this[_0x27b2cb(0x122)][_0x27b2cb(0xfd)](),_0x206d89);if(_0x231753){_0x33ed0e=_0x55d7ea[_0x27b2cb(0xfe)]['deepClone'](_0x231753);break;}}}}_0x33ed0e&&this[_0x27b2cb(0x106)][_0x27b2cb(0x13e)](_0x5ac069[_0x27b2cb(0x104)]['id'],{'ranges':_0x574b4f,'combine':!0x0,'config':_0x33ed0e,'isChangeDataSource':!0x1});}[_0x8b7a35(0x141)](_0x2d6d1c){const _0x40501a=_0x8b7a35,_0x184410=this['_injector'][_0x40501a(0x13b)](_0x5ac069[_0x40501a(0x111)]);let _0x1073b4;for(let _0x4b3718=0x0;_0x4b3718<_0x2d6d1c['length'];_0x4b3718++){const _0x32b686=_0x2d6d1c[_0x4b3718],{startRow:_0x44e715,endRow:_0x354886,startColumn:_0x4d65e3,endColumn:_0x172fcc}=_0x32b686;for(let _0xc3920=_0x44e715;_0xc3920<=_0x354886;_0xc3920++)for(let _0x48b6e7=_0x4d65e3;_0x48b6e7<=_0x172fcc;_0x48b6e7++){const _0x2b6397=_0x184410[_0x40501a(0x108)](this[_0x40501a(0x134)][_0x40501a(0x14d)](),this[_0x40501a(0x122)][_0x40501a(0xfd)](),_0xc3920,_0x48b6e7);if(_0x2b6397){const _0x4e128c=_0x184410[_0x40501a(0x10b)](this[_0x40501a(0x134)]['getUnitId'](),this[_0x40501a(0x122)][_0x40501a(0xfd)](),_0x2b6397);if(_0x4e128c){_0x1073b4=_0x55d7ea[_0x40501a(0xfe)][_0x40501a(0x149)](_0x4e128c);break;}}}}_0x1073b4||this['_commandService']['executeCommand'](_0x5ac069['SetSheetSparklineCommand']['id'],{'ranges':_0x2d6d1c,'unCombine':!0x0,'config':_0x1073b4,'isChangeDataSource':!0x1});}[_0x8b7a35(0x11d)](_0x57d31e,_0x489532){const _0x4e3c38=_0x8b7a35,_0x3a07fc=this[_0x4e3c38(0x119)][_0x4e3c38(0x13b)](_0x5ac069[_0x4e3c38(0x111)]),_0x5e9eb8=this[_0x4e3c38(0x134)][_0x4e3c38(0x14d)](),_0xb1ac5a=this[_0x4e3c38(0x122)][_0x4e3c38(0xfd)](),_0x28c7b3=_0x3a07fc[_0x4e3c38(0x108)](_0x5e9eb8,_0xb1ac5a,_0x57d31e,_0x489532);if(_0x28c7b3)return this['_injector'][_0x4e3c38(0x11e)](_0x334470[_0x4e3c38(0x14b)],_0x5e9eb8,_0xb1ac5a,_0x28c7b3,_0x57d31e,_0x489532);}['getSparklineGroupByCell'](_0x33dbb0,_0x54eacd){const _0x1985fe=_0x8b7a35,_0x2edfac=this[_0x1985fe(0x119)][_0x1985fe(0x13b)](_0x5ac069[_0x1985fe(0x111)]),_0x2bd9f5=this[_0x1985fe(0x134)]['getUnitId'](),_0x341a7a=this[_0x1985fe(0x122)][_0x1985fe(0xfd)](),_0x240c4e=_0x2edfac[_0x1985fe(0x108)](_0x2bd9f5,_0x341a7a,_0x33dbb0,_0x54eacd);if(_0x240c4e)return this['_injector'][_0x1985fe(0x11e)](_0x334470[_0x1985fe(0x139)],_0x2bd9f5,_0x341a7a,_0x240c4e,_0x33dbb0,_0x54eacd);}}_0x23931b[_0x8b7a35(0x11a)][_0x8b7a35(0xfb)](_0xf275a5);class _0x3808af extends _0x5d7f87[_0x8b7a35(0x132)]{get[_0x8b7a35(0x130)](){const _0x32a4fa=_0x8b7a35;return _0x5ac069[_0x32a4fa(0x130)];}}_0x5d7f87[_0x8b7a35(0x132)][_0x8b7a35(0xfb)](_0x3808af);class _0x4a4ac0 extends _0x5d7f87[_0x8b7a35(0x10d)]{get['SheetSparklineChanged'](){const _0x516e66=_0x8b7a35;return _0x516e66(0x114);}}_0x5d7f87[_0x8b7a35(0x10d)][_0x8b7a35(0xfb)](_0x4a4ac0);class _0x382bfc extends _0x5d7f87[_0x8b7a35(0x112)]{[_0x8b7a35(0xf7)](_0x1aa337){const _0x5bccc8=_0x8b7a35,_0x5daaa9=_0x1aa337[_0x5bccc8(0x13b)](_0x55d7ea[_0x5bccc8(0xfa)]);this[_0x5bccc8(0x129)](this[_0x5bccc8(0x13a)][_0x5bccc8(0x114)],()=>_0x5daaa9[_0x5bccc8(0x125)](_0x75d1c5=>{const _0x22441b=_0x5bccc8;var _0x3a758a,_0x16972d;if(_0x75d1c5['id']===_0x5ac069['SetSheetSparklineCommand']['id']){const _0x56c075=_0x75d1c5['params'];if(!_0x56c075[_0x22441b(0x103)]){const _0x5c1931=this['getActiveWorkbook'](),_0x41fc6c=_0x5c1931==null?void 0x0:_0x5c1931[_0x22441b(0x133)]();if(!_0x5c1931||!_0x41fc6c)return;const _0x2b18e7=_0x5c1931[_0x22441b(0x101)](),_0x542ae0=_0x41fc6c[_0x22441b(0xfd)](),_0x56756a=this[_0x22441b(0x119)][_0x22441b(0x13b)](_0x595eb8[_0x22441b(0x109)]),_0x20be93=this[_0x22441b(0x119)][_0x22441b(0x13b)](_0x5ac069['SparklineDataSourceModel']),_0x47f3b2=(_0x3a758a=_0x56c075==null?void 0x0:_0x56c075['ranges'])!=null?_0x3a758a:_0x56756a[_0x22441b(0x12d)]()[_0x22441b(0x137)](_0x847bb5=>_0x847bb5[_0x22441b(0x14c)]),_0x43eb0a=(_0x16972d=_0x20be93[_0x22441b(0x128)]()[_0x22441b(0xf8)][_0x22441b(0x13b)](_0x2b18e7))==null?void 0x0:_0x16972d[_0x22441b(0x13b)](_0x542ae0),_0xc22be1=new Set();_0x47f3b2[_0x22441b(0x11c)](_0x322c3c=>{const _0x409eab=_0x22441b;var _0x11460d;const {startRow:_0x57987c,endRow:_0x4ea4bb,startColumn:_0x5c2150,endColumn:_0x47829b}=_0x322c3c;for(let _0x2e31bb=_0x57987c;_0x2e31bb<=_0x4ea4bb;_0x2e31bb++)for(let _0x44bfaa=_0x5c2150;_0x44bfaa<=_0x47829b;_0x44bfaa++){const _0x4bc537=(_0x11460d=_0x43eb0a==null?void 0x0:_0x43eb0a['matrix']['getValue'](_0x2e31bb,_0x44bfaa))==null?void 0x0:_0x11460d[_0x409eab(0x120)];_0x4bc537&&_0xc22be1[_0x409eab(0xfc)](_0x4bc537);}});const _0x59af71=Array['from'](_0xc22be1)[_0x22441b(0x137)](_0x1f467c=>_0x20be93[_0x22441b(0x10b)](_0x2b18e7,_0x542ae0,_0x1f467c))[_0x22441b(0x138)](_0x215847=>!!_0x215847),_0x463999={'workbook':_0x5c1931,'worksheet':_0x41fc6c,'sparklines':_0x59af71};if(this[_0x22441b(0x142)](this[_0x22441b(0x13a)][_0x22441b(0x114)],_0x463999),_0x463999[_0x22441b(0x12b)])throw new Error(_0x22441b(0x11f));}}}));}}_0x5d7f87[_0x8b7a35(0x112)]['extend'](_0x382bfc),Object[_0x8b7a35(0x14a)](_0x334470,Symbol[_0x8b7a35(0x10a)],{'value':'Module'});}));