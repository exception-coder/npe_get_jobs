const _0x4a6842=_0xe775;(function(_0x4a4547,_0x3eed2d){const _0xc4e084=_0xe775,_0x47f560=_0x4a4547();while(!![]){try{const _0x5e6818=-parseInt(_0xc4e084(0xcc))/0x1*(-parseInt(_0xc4e084(0xde))/0x2)+parseInt(_0xc4e084(0xe9))/0x3+parseInt(_0xc4e084(0xd4))/0x4+parseInt(_0xc4e084(0xfd))/0x5*(parseInt(_0xc4e084(0xe6))/0x6)+-parseInt(_0xc4e084(0xfb))/0x7+parseInt(_0xc4e084(0x104))/0x8*(-parseInt(_0xc4e084(0xcb))/0x9)+-parseInt(_0xc4e084(0xe1))/0xa;if(_0x5e6818===_0x3eed2d)break;else _0x47f560['push'](_0x47f560['shift']());}catch(_0x12d92d){_0x47f560['push'](_0x47f560['shift']());}}}(_0x4008,0x6865d));import{SparklineDataSourceModel as _0x39e46e,SetSheetSparklineCommand as _0x43ac22,RemoveSheetSparklineCommand as _0x555dd4,AddSheetSparklineCommand as _0x1bedf8,SparklineTypeEnum as _0x137c39}from'@univerjs-pro/sheets-sparkline';import{Inject as _0x399e8c,Injector as _0x389b32,ICommandService as _0x52e292,Tools as _0x4a6ae1}from'@univerjs/core';import{FWorksheet as _0x49b157}from'@univerjs/sheets/facade';import{FEnum as _0x4b8645,FEventName as _0x7241,FUniver as _0x5d077f}from'@univerjs/core/facade';function _0xe775(_0xe737fc,_0x4050ae){const _0x4008df=_0x4008();return _0xe775=function(_0x5805a4,_0x1286fa){_0x5805a4=_0x5805a4-0xc9;let _0x393dc3=_0x4008df[_0x5805a4];return _0x393dc3;},_0xe775(_0xe737fc,_0x4050ae);}import{SheetsSelectionsService as _0x338d7f}from'@univerjs/sheets';var z=Object[_0x4a6842(0xf9)],H=(_0x1d4432,_0x20b89f,_0x5d087d,_0x9ed61e)=>{const _0xe8fab6=_0x4a6842;for(var _0x601f64=_0x9ed61e>0x1?void 0x0:_0x9ed61e?z(_0x20b89f,_0x5d087d):_0x20b89f,_0x3d0d2d=_0x1d4432[_0xe8fab6(0xf5)]-0x1,_0x3b257b;_0x3d0d2d>=0x0;_0x3d0d2d--)(_0x3b257b=_0x1d4432[_0x3d0d2d])&&(_0x601f64=_0x3b257b(_0x601f64)||_0x601f64);return _0x601f64;},V=(_0x58f773,_0x20066f)=>(_0x49a7d4,_0x1772af)=>_0x20066f(_0x49a7d4,_0x1772af,_0x58f773);let C=class{constructor(_0x37e086,_0x34ae19,_0x45af6c,_0x2acac8,_0x532d19,_0x48b48f){const _0x575b74=_0x4a6842;this[_0x575b74(0xff)]=_0x37e086,this[_0x575b74(0xea)]=_0x34ae19,this[_0x575b74(0x103)]=_0x45af6c,this[_0x575b74(0xcf)]=_0x2acac8,this[_0x575b74(0xcd)]=_0x532d19,this[_0x575b74(0xdf)]=_0x48b48f;}['changeDataSource'](_0x14ff75,_0x32b698){const _0x3a6b8=_0x4a6842,_0x497a20=this[_0x3a6b8(0xdf)][_0x3a6b8(0xd9)](_0x39e46e),_0x21e098=this['_injector'][_0x3a6b8(0xd9)](_0x52e292),_0x408b35=_0x497a20[_0x3a6b8(0xe2)](this[_0x3a6b8(0xff)],this[_0x3a6b8(0xea)],this[_0x3a6b8(0x103)]);if(!_0x408b35)return;const _0x5ae58a={'config':_0x408b35,'isChangeDataSource':!0x0,'changeDataSourceInfo':{'groupId':this['_groupId'],'resetType':'item','sourceRanges':[_0x14ff75],'targetRanges':[_0x32b698],'primary':{'startRow':this[_0x3a6b8(0xcf)],'startColumn':this[_0x3a6b8(0xcd)],'endRow':this[_0x3a6b8(0xcf)],'endColumn':this[_0x3a6b8(0xcd)],'actualRow':this['_row'],'actualColumn':this[_0x3a6b8(0xcd)],'isMerged':!0x1,'isMergedMainCell':!0x1}}};return _0x21e098[_0x3a6b8(0xda)](_0x43ac22['id'],_0x5ae58a),this['_row']=_0x32b698[_0x3a6b8(0xeb)],this[_0x3a6b8(0xcd)]=_0x32b698[_0x3a6b8(0xd7)],this;}[_0x4a6842(0xd6)](){const _0x5611a8=_0x4a6842,_0x22ee5a=this[_0x5611a8(0xdf)][_0x5611a8(0xd9)](_0x52e292),_0x46443a={'isSingle':!0x0,'ranges':[{'startRow':this[_0x5611a8(0xcf)],'startColumn':this['_col'],'endRow':this[_0x5611a8(0xcf)],'endColumn':this[_0x5611a8(0xcd)]}]};_0x22ee5a[_0x5611a8(0xda)](_0x555dd4['id'],_0x46443a);}};C=H([V(0x5,_0x399e8c(_0x389b32))],C);var q=Object['getOwnPropertyDescriptor'],J=(_0x296bcf,_0x29ed29,_0x40c277,_0x2db4d0)=>{const _0x515137=_0x4a6842;for(var _0x51214f=_0x2db4d0>0x1?void 0x0:_0x2db4d0?q(_0x29ed29,_0x40c277):_0x29ed29,_0x4f8e46=_0x296bcf[_0x515137(0xf5)]-0x1,_0x4cf445;_0x4f8e46>=0x0;_0x4f8e46--)(_0x4cf445=_0x296bcf[_0x4f8e46])&&(_0x51214f=_0x4cf445(_0x51214f)||_0x51214f);return _0x51214f;},K=(_0x19e75c,_0x1cfd1a)=>(_0x43731d,_0x1e1866)=>_0x1cfd1a(_0x43731d,_0x1e1866,_0x19e75c);let w=class{constructor(_0x4386a7,_0x289555,_0x4091ca,_0x476143,_0xe9234b,_0x363958){const _0x5a3365=_0x4a6842;this['_unitId']=_0x4386a7,this[_0x5a3365(0xea)]=_0x289555,this[_0x5a3365(0x103)]=_0x4091ca,this[_0x5a3365(0xcf)]=_0x476143,this[_0x5a3365(0xcd)]=_0xe9234b,this[_0x5a3365(0xdf)]=_0x363958;}[_0x4a6842(0xf1)](_0x351b5b,_0xcc0859){const _0x2f8fd9=_0x4a6842,_0x2bab1e=this[_0x2f8fd9(0xdf)]['get'](_0x39e46e),_0x3cf94c=this[_0x2f8fd9(0xdf)][_0x2f8fd9(0xd9)](_0x52e292),_0x3d41e9=_0x2bab1e[_0x2f8fd9(0xe2)](this[_0x2f8fd9(0xff)],this[_0x2f8fd9(0xea)],this[_0x2f8fd9(0x103)]);if(!_0x3d41e9)return;const _0x57714a={'config':_0x3d41e9,'isChangeDataSource':!0x0,'changeDataSourceInfo':{'groupId':this[_0x2f8fd9(0x103)],'resetType':_0x2f8fd9(0xe5),'sourceRanges':_0x351b5b,'targetRanges':_0xcc0859,'primary':{'startRow':this[_0x2f8fd9(0xcf)],'startColumn':this[_0x2f8fd9(0xcd)],'endRow':this['_row'],'endColumn':this[_0x2f8fd9(0xcd)],'actualRow':this[_0x2f8fd9(0xcf)],'actualColumn':this[_0x2f8fd9(0xcd)],'isMerged':!0x1,'isMergedMainCell':!0x1}}};return _0x3cf94c['syncExecuteCommand'](_0x43ac22['id'],_0x57714a),this[_0x2f8fd9(0xcf)]=_0xcc0859[0x0]['startRow'],this[_0x2f8fd9(0xcd)]=_0xcc0859[0x0][_0x2f8fd9(0xd7)],this;}['removeSparklineGroup'](){const _0x3b0dd6=_0x4a6842,_0x516966=this[_0x3b0dd6(0xdf)][_0x3b0dd6(0xd9)](_0x52e292),_0x1f3be5={'isSingle':!0x1,'ranges':[{'startRow':this['_row'],'startColumn':this[_0x3b0dd6(0xcd)],'endRow':this[_0x3b0dd6(0xcf)],'endColumn':this['_col']}]};_0x516966[_0x3b0dd6(0xda)](_0x555dd4['id'],_0x1f3be5);}['setConfig'](_0x12a398){const _0x2270e3=_0x4a6842,_0x12b03d=this['_injector']['get'](_0x39e46e)[_0x2270e3(0xe2)](this[_0x2270e3(0xff)],this[_0x2270e3(0xea)],this[_0x2270e3(0x103)]);if(_0x12b03d){const _0x4ad8b5={'config':{'config':_0x12a398,'sparklines':_0x12b03d['sparklines']},'isChangeDataSource':!0x1};this[_0x2270e3(0xdf)][_0x2270e3(0xd9)](_0x52e292)['syncExecuteCommand'](_0x43ac22['id'],_0x4ad8b5);}return this;}};function _0x4008(){const _0x1160a1=['_subUnitId','startRow','deepClone','executeCommand','isChangeDataSource','SparklineTypeEnum','_worksheet','changeDataSource','filter','params','getId','length','composeSparkline','Event','add','getOwnPropertyDescriptor','getSubUnitSparkline','3128013HQFISH','getSparkline','1252705pINZIc','_workbook','_unitId','getSparklineGroupByCell','getUnitId','getSheetId','_groupId','574936Vzlgyd','SheetSparklineChanged','matrix','getActiveSheet','unComposeSparkline','72ISHUTG','1cAaRMo','_col','extend','_row','sparklineAnchorMap','range','getSparklineByCell','getSparklineCache','3182424mgESnX','Sheet\x20create\x20canceled\x20by\x20facade\x20api.','removeSparkline','startColumn','getValue','get','syncExecuteCommand','registerEventHandler','createInstance','getActiveWorkbook','420774RbtTui','_injector','map','1195750tckAwP','getSparklineById','ranges','_commandService','group','6EpZFZh','_initialize','forEach','937347aEGXRr'];_0x4008=function(){return _0x1160a1;};return _0x4008();}w=J([K(0x5,_0x399e8c(_0x389b32))],w);class L extends _0x49b157{['addSparkline'](_0x5b4528,_0xa748fb,_0x2802f0){const _0x18305d=_0x4a6842;if(this['_commandService'][_0x18305d(0xda)](_0x1bedf8['id'],{'sourceRanges':_0x5b4528,'targetRanges':_0xa748fb,'targetInfo':{'unitId':this[_0x18305d(0xfe)][_0x18305d(0x101)](),'subUnitId':this[_0x18305d(0xf0)][_0x18305d(0x102)]()},'config':{'type':_0x2802f0}})){const {startRow:_0x77a6d4,startColumn:_0x367b78}=_0xa748fb[0x0];return this['getSparklineByCell'](_0x77a6d4,_0x367b78);}}['getAllSubSparkline'](){const _0x1062c1=_0x4a6842;return this[_0x1062c1(0xdf)][_0x1062c1(0xd9)](_0x39e46e)[_0x1062c1(0xfa)](this[_0x1062c1(0xfe)][_0x1062c1(0x101)](),this[_0x1062c1(0xf0)][_0x1062c1(0x102)]());}[_0x4a6842(0xf6)](_0x41e3e9){const _0x2696ac=_0x4a6842,_0xcffeb7=this[_0x2696ac(0xdf)]['get'](_0x39e46e);let _0x31c33e;for(let _0x5d4d0a=0x0;_0x5d4d0a<_0x41e3e9['length'];_0x5d4d0a++){const _0x40f8cb=_0x41e3e9[_0x5d4d0a],{startRow:_0x265961,endRow:_0x49b01c,startColumn:_0xb17ca2,endColumn:_0x9aea5b}=_0x40f8cb;for(let _0x45ce5f=_0x265961;_0x45ce5f<=_0x49b01c;_0x45ce5f++)for(let _0x388582=_0xb17ca2;_0x388582<=_0x9aea5b;_0x388582++){const _0x35e176=_0xcffeb7[_0x2696ac(0xfc)](this[_0x2696ac(0xfe)][_0x2696ac(0x101)](),this[_0x2696ac(0xf0)][_0x2696ac(0x102)](),_0x45ce5f,_0x388582);if(_0x35e176){const _0x42d24d=_0xcffeb7[_0x2696ac(0xe2)](this[_0x2696ac(0xfe)][_0x2696ac(0x101)](),this[_0x2696ac(0xf0)][_0x2696ac(0x102)](),_0x35e176);if(_0x42d24d){_0x31c33e=_0x4a6ae1[_0x2696ac(0xec)](_0x42d24d);break;}}}}_0x31c33e&&this['_commandService'][_0x2696ac(0xed)](_0x43ac22['id'],{'ranges':_0x41e3e9,'combine':!0x0,'config':_0x31c33e,'isChangeDataSource':!0x1});}[_0x4a6842(0xca)](_0x5a8529){const _0x2747b8=_0x4a6842,_0x108e00=this['_injector'][_0x2747b8(0xd9)](_0x39e46e);let _0x2d1fa2;for(let _0x3d9d7f=0x0;_0x3d9d7f<_0x5a8529['length'];_0x3d9d7f++){const _0x5bf88e=_0x5a8529[_0x3d9d7f],{startRow:_0x4159b8,endRow:_0xe4a294,startColumn:_0x54ad68,endColumn:_0x2e81d5}=_0x5bf88e;for(let _0x2a5d27=_0x4159b8;_0x2a5d27<=_0xe4a294;_0x2a5d27++)for(let _0x4e059d=_0x54ad68;_0x4e059d<=_0x2e81d5;_0x4e059d++){const _0x646c6e=_0x108e00[_0x2747b8(0xfc)](this[_0x2747b8(0xfe)]['getUnitId'](),this[_0x2747b8(0xf0)][_0x2747b8(0x102)](),_0x2a5d27,_0x4e059d);if(_0x646c6e){const _0x3e0007=_0x108e00[_0x2747b8(0xe2)](this['_workbook']['getUnitId'](),this[_0x2747b8(0xf0)][_0x2747b8(0x102)](),_0x646c6e);if(_0x3e0007){_0x2d1fa2=_0x4a6ae1[_0x2747b8(0xec)](_0x3e0007);break;}}}}_0x2d1fa2||this[_0x2747b8(0xe4)][_0x2747b8(0xed)](_0x43ac22['id'],{'ranges':_0x5a8529,'unCombine':!0x0,'config':_0x2d1fa2,'isChangeDataSource':!0x1});}[_0x4a6842(0xd2)](_0x599521,_0x153270){const _0x3bbc2f=_0x4a6842,_0x4908f4=this[_0x3bbc2f(0xdf)][_0x3bbc2f(0xd9)](_0x39e46e),_0x4b200d=this[_0x3bbc2f(0xfe)]['getUnitId'](),_0x217420=this['_worksheet'][_0x3bbc2f(0x102)](),_0x64299e=_0x4908f4[_0x3bbc2f(0xfc)](_0x4b200d,_0x217420,_0x599521,_0x153270);if(_0x64299e)return this['_injector']['createInstance'](C,_0x4b200d,_0x217420,_0x64299e,_0x599521,_0x153270);}[_0x4a6842(0x100)](_0x399882,_0x5c65b2){const _0x22fd4e=_0x4a6842,_0x351e80=this[_0x22fd4e(0xdf)][_0x22fd4e(0xd9)](_0x39e46e),_0xa1e749=this[_0x22fd4e(0xfe)][_0x22fd4e(0x101)](),_0x5bc029=this[_0x22fd4e(0xf0)][_0x22fd4e(0x102)](),_0x3d104e=_0x351e80[_0x22fd4e(0xfc)](_0xa1e749,_0x5bc029,_0x399882,_0x5c65b2);if(_0x3d104e)return this[_0x22fd4e(0xdf)][_0x22fd4e(0xdc)](w,_0xa1e749,_0x5bc029,_0x3d104e,_0x399882,_0x5c65b2);}}_0x49b157[_0x4a6842(0xce)](L);class Q extends _0x4b8645{get[_0x4a6842(0xef)](){return _0x137c39;}}_0x4b8645[_0x4a6842(0xce)](Q);class X extends _0x7241{get[_0x4a6842(0x105)](){const _0x564df2=_0x4a6842;return _0x564df2(0x105);}}_0x7241['extend'](X);class Y extends _0x5d077f{[_0x4a6842(0xe7)](_0x4b80c0){const _0x4f253a=_0x4a6842,_0x3ceee7=_0x4b80c0[_0x4f253a(0xd9)](_0x52e292);this[_0x4f253a(0xdb)](this[_0x4f253a(0xf7)][_0x4f253a(0x105)],()=>_0x3ceee7['onCommandExecuted'](_0x16c2de=>{const _0x111ccb=_0x4f253a;var _0x3a3a69,_0x65597d;if(_0x16c2de['id']===_0x43ac22['id']){const _0x1641c8=_0x16c2de[_0x111ccb(0xf3)];if(!_0x1641c8[_0x111ccb(0xee)]){const _0x26dc41=this[_0x111ccb(0xdd)](),_0x5e19c0=_0x26dc41==null?void 0x0:_0x26dc41[_0x111ccb(0xc9)]();if(!_0x26dc41||!_0x5e19c0)return;const _0x464781=_0x26dc41[_0x111ccb(0xf4)](),_0x2b5624=_0x5e19c0[_0x111ccb(0x102)](),_0x3433e2=this[_0x111ccb(0xdf)][_0x111ccb(0xd9)](_0x338d7f),_0x4fd4b6=this[_0x111ccb(0xdf)][_0x111ccb(0xd9)](_0x39e46e),_0x5d1445=(_0x3a3a69=_0x1641c8==null?void 0x0:_0x1641c8[_0x111ccb(0xe3)])!=null?_0x3a3a69:_0x3433e2['getCurrentSelections']()[_0x111ccb(0xe0)](_0x23ad2d=>_0x23ad2d[_0x111ccb(0xd1)]),_0x754ac4=(_0x65597d=_0x4fd4b6[_0x111ccb(0xd3)]()[_0x111ccb(0xd0)][_0x111ccb(0xd9)](_0x464781))==null?void 0x0:_0x65597d[_0x111ccb(0xd9)](_0x2b5624),_0x63da4c=new Set();_0x5d1445[_0x111ccb(0xe8)](_0x294bc8=>{const _0x3c1ed2=_0x111ccb;var _0x4b351c;const {startRow:_0x178377,endRow:_0x1e02bc,startColumn:_0x2f8321,endColumn:_0x30a3ef}=_0x294bc8;for(let _0xad994a=_0x178377;_0xad994a<=_0x1e02bc;_0xad994a++)for(let _0xe0238f=_0x2f8321;_0xe0238f<=_0x30a3ef;_0xe0238f++){const _0x31d7c8=(_0x4b351c=_0x754ac4==null?void 0x0:_0x754ac4[_0x3c1ed2(0x106)][_0x3c1ed2(0xd8)](_0xad994a,_0xe0238f))==null?void 0x0:_0x4b351c['groupId'];_0x31d7c8&&_0x63da4c[_0x3c1ed2(0xf8)](_0x31d7c8);}});const _0xac8bbe=Array['from'](_0x63da4c)[_0x111ccb(0xe0)](_0x31e3de=>_0x4fd4b6[_0x111ccb(0xe2)](_0x464781,_0x2b5624,_0x31e3de))[_0x111ccb(0xf2)](_0x8f8dd9=>!!_0x8f8dd9),_0x49a706={'workbook':_0x26dc41,'worksheet':_0x5e19c0,'sparklines':_0xac8bbe};if(this['fireEvent'](this[_0x111ccb(0xf7)][_0x111ccb(0x105)],_0x49a706),_0x49a706['cancel'])throw new Error(_0x111ccb(0xd5));}}}));}}_0x5d077f[_0x4a6842(0xce)](Y);export{C as FSparkline,w as FSparklineGroup};