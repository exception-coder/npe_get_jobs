const _0x250c34=_0x124b;(function(_0x504e97,_0x5637e6){const _0x4050c9=_0x124b,_0x9eb59b=_0x504e97();while(!![]){try{const _0x339bdd=parseInt(_0x4050c9(0x1cb))/0x1+parseInt(_0x4050c9(0x1b0))/0x2+-parseInt(_0x4050c9(0x1b2))/0x3*(parseInt(_0x4050c9(0x1bf))/0x4)+-parseInt(_0x4050c9(0x1ce))/0x5+parseInt(_0x4050c9(0x1c7))/0x6*(-parseInt(_0x4050c9(0x1c5))/0x7)+parseInt(_0x4050c9(0x1be))/0x8*(-parseInt(_0x4050c9(0x1cd))/0x9)+-parseInt(_0x4050c9(0x1d4))/0xa*(-parseInt(_0x4050c9(0x1c3))/0xb);if(_0x339bdd===_0x5637e6)break;else _0x9eb59b['push'](_0x9eb59b['shift']());}catch(_0x4c9b2f){_0x9eb59b['push'](_0x9eb59b['shift']());}}}(_0x6e8a,0xb407a));import{ISheetPrintManagerService as _0x546575,ConfirmSheetPrintOperation as _0x3b973d,SheetPrintOpenOperation as _0x49432e,CancelSheetPrintOperation as _0x5eef04,hasPrintFacadePermission as _0x3b9684,SheetScreenShotOperation as _0x214958,SheetPrintClientService as _0x30c2b2,PrintArea as _0x26e551,PrintFreeze as _0x3adf9e,PrintHeaderFooter as _0x1cd3c1,PrintHeaderFooterSymbol as _0x1ec1d1}from'@univerjs-pro/sheets-print';import{ICommandService as _0x159b31,PaperType as _0x3aad4c,CanceledError as _0x3b4dfe}from'@univerjs/core';import{FWorkbook as _0x3bbaa0,FRange as _0x45e4eb}from'@univerjs/sheets/facade';import{FEventName as _0x55cc09,FEnum as _0x200f69,FUniver as _0x5c1f00}from'@univerjs/core/facade';import{PrintAlign as _0x8f070a,PrintPaperMargin as _0x58fb3f,PrintScale as _0x1b876a,PrintDirection as _0x4fab5e}from'@univerjs-pro/print';class A extends _0x3bbaa0{['updatePrintConfig'](_0x5989a8){const _0x5d3428=_0x124b;return this['_injector'][_0x5d3428(0x1d3)](_0x546575)['updateLayoutConfig'](_0x5989a8),this;}[_0x250c34(0x1b9)](_0x2ad3bb){const _0x334e04=_0x250c34;return this[_0x334e04(0x1d1)][_0x334e04(0x1d3)](_0x546575)[_0x334e04(0x1cc)](_0x2ad3bb),this;}[_0x250c34(0x1db)](){const _0x1dd5ee=_0x250c34;return this[_0x1dd5ee(0x1d1)]['get'](_0x159b31)['syncExecuteCommand'](_0x3b973d['id']);}['openPrintDialog'](){const _0x28550d=_0x250c34;return this[_0x28550d(0x1d1)][_0x28550d(0x1d3)](_0x159b31)[_0x28550d(0x1d5)](_0x49432e['id']);}['closePrintDialog'](){const _0x434114=_0x250c34;return this[_0x434114(0x1d1)][_0x434114(0x1d3)](_0x159b31)[_0x434114(0x1d5)](_0x5eef04['id']);}async[_0x250c34(0x1de)](){const _0x211d7b=_0x250c34;return _0x3b9684(this[_0x211d7b(0x1d1)])?this[_0x211d7b(0x1d1)]['get'](_0x159b31)[_0x211d7b(0x1df)](_0x214958['id']):!0x1;}}_0x3bbaa0[_0x250c34(0x1dc)](A);function _0x6e8a(){const _0x189871=['SheetPrintConfirmed','136526OoYfZk','getActiveUniverSheet','5361FzXYdM','BeforeSheetPrintCanceled','PrintScale','renderConfig','_range','getSheetId','PrintDirection','updatePrintRenderConfig','_workbook','getActiveSheet','layoutConfig','_initialize','19016XibFwz','2644OIjGgm','registerEventHandler','BeforeSheetPrintConfirm','PrintHeaderFooterSymbol','3567905pPAmLf','cancel','48419cyAbeD','fireEvent','1026XYBeSt','PrintAlign','PrintFreeze','PrintPaperMargin','1324173CLjcXM','updateRenderConfig','4086cLbshs','2277060kPccxG','getScreenshot','getUnitId','_injector','Event','get','100iZKBRH','syncExecuteCommand','SheetPrintOpen','onCommandExecuted','BeforeSheetPrintOpen','PrintHeaderFooter','SheetPrintCanceled','print','extend','beforeCommandExecuted','saveScreenshotToClipboard','executeCommand'];_0x6e8a=function(){return _0x189871;};return _0x6e8a();}function _0x124b(_0x424683,_0x5abd66){const _0x6e8afa=_0x6e8a();return _0x124b=function(_0x124b14,_0x14cd8b){_0x124b14=_0x124b14-0x1b0;let _0x4c5a58=_0x6e8afa[_0x124b14];return _0x4c5a58;},_0x124b(_0x424683,_0x5abd66);}class B extends _0x45e4eb{[_0x250c34(0x1cf)](){const _0x3d9bd2=_0x250c34;return _0x3b9684(this[_0x3d9bd2(0x1d1)])?this[_0x3d9bd2(0x1d1)][_0x3d9bd2(0x1d3)](_0x30c2b2)['getRangeImage'](this[_0x3d9bd2(0x1ba)][_0x3d9bd2(0x1d0)](),this['_worksheet'][_0x3d9bd2(0x1b7)](),this[_0x3d9bd2(0x1b6)]):!0x1;}}_0x45e4eb['extend'](B);class H{get[_0x250c34(0x1d8)](){const _0x23e793=_0x250c34;return _0x23e793(0x1d8);}get[_0x250c34(0x1c1)](){return'BeforeSheetPrintConfirm';}get[_0x250c34(0x1b3)](){return'BeforeSheetPrintCanceled';}get[_0x250c34(0x1d6)](){return'SheetPrintOpen';}get[_0x250c34(0x1e0)](){const _0x4fccf0=_0x250c34;return _0x4fccf0(0x1e0);}get['SheetPrintCanceled'](){return'SheetPrintCanceled';}}_0x55cc09[_0x250c34(0x1dc)](H);class U{get['PrintArea'](){return _0x26e551;}get[_0x250c34(0x1c8)](){return _0x8f070a;}get['PrintPaperSize'](){return _0x3aad4c;}get[_0x250c34(0x1ca)](){return _0x58fb3f;}get[_0x250c34(0x1b4)](){return _0x1b876a;}get[_0x250c34(0x1b8)](){return _0x4fab5e;}get[_0x250c34(0x1c9)](){return _0x3adf9e;}get[_0x250c34(0x1d9)](){return _0x1cd3c1;}get[_0x250c34(0x1c2)](){return _0x1ec1d1;}}_0x200f69[_0x250c34(0x1dc)](U);class M extends _0x5c1f00{[_0x250c34(0x1bd)](_0x58c2dc){const _0x51e04f=_0x250c34,_0x8638d1=_0x58c2dc['get'](_0x159b31);this[_0x51e04f(0x1c0)](this[_0x51e04f(0x1d2)]['BeforeSheetPrintOpen'],()=>_0x8638d1[_0x51e04f(0x1dd)](_0x5b997e=>{const _0x386010=_0x51e04f;if(_0x5b997e['id']===_0x49432e['id']){const _0x38c7ab=this[_0x386010(0x1b1)]();if(!_0x38c7ab)return;const _0x27a9f3={'workbook':_0x38c7ab,'worksheet':_0x38c7ab[_0x386010(0x1bb)]()};if(_0x27a9f3==null)return;if(this['fireEvent'](this[_0x386010(0x1d2)][_0x386010(0x1d8)],_0x27a9f3),_0x27a9f3['cancel'])throw new _0x3b4dfe();}})),this[_0x51e04f(0x1c0)](this['Event'][_0x51e04f(0x1c1)],()=>_0x8638d1[_0x51e04f(0x1dd)](_0x57e616=>{const _0x57cfeb=_0x51e04f;if(_0x57e616['id']===_0x3b973d['id']){const _0x25468b=_0x58c2dc['get'](_0x546575);if(!this[_0x57cfeb(0x1b1)]())return;const _0x1ae86c={'layoutConfig':_0x25468b[_0x57cfeb(0x1bc)],'renderConfig':_0x25468b['renderConfig']};if(_0x1ae86c==null)return;if(this[_0x57cfeb(0x1c6)](this['Event'][_0x57cfeb(0x1c1)],_0x1ae86c),_0x1ae86c[_0x57cfeb(0x1c4)])throw new _0x3b4dfe();}})),this[_0x51e04f(0x1c0)](this[_0x51e04f(0x1d2)]['BeforeSheetPrintCanceled'],()=>_0x8638d1['beforeCommandExecuted'](_0x22bf86=>{const _0x198855=_0x51e04f;if(_0x22bf86['id']===_0x5eef04['id']){const _0x39377e=_0x58c2dc[_0x198855(0x1d3)](_0x546575);if(!this[_0x198855(0x1b1)]())return;const _0x30c12b={'layoutConfig':_0x39377e[_0x198855(0x1bc)],'renderConfig':_0x39377e['renderConfig']};if(_0x30c12b==null)return;if(this['fireEvent'](this[_0x198855(0x1d2)]['BeforeSheetPrintCanceled'],_0x30c12b),_0x30c12b[_0x198855(0x1c4)])throw new _0x3b4dfe();}})),this[_0x51e04f(0x1c0)](this['Event'][_0x51e04f(0x1d6)],()=>_0x8638d1[_0x51e04f(0x1d7)](_0x202864=>{const _0x234780=_0x51e04f;if(_0x202864['id']===_0x49432e['id']){const _0x22c1ca=this[_0x234780(0x1b1)]();if(!_0x22c1ca)return;const _0x2a047c={'workbook':_0x22c1ca,'worksheet':_0x22c1ca[_0x234780(0x1bb)]()};if(_0x2a047c==null)return;this['fireEvent'](this[_0x234780(0x1d2)][_0x234780(0x1d6)],_0x2a047c);}})),this[_0x51e04f(0x1c0)](this[_0x51e04f(0x1d2)][_0x51e04f(0x1e0)],()=>_0x8638d1[_0x51e04f(0x1d7)](_0x116001=>{const _0x3ad542=_0x51e04f;if(_0x116001['id']===_0x3b973d['id']){const _0x1f0976=_0x58c2dc[_0x3ad542(0x1d3)](_0x546575);if(!this[_0x3ad542(0x1b1)]())return;const _0x20aff2={'layoutConfig':_0x1f0976[_0x3ad542(0x1bc)],'renderConfig':_0x1f0976[_0x3ad542(0x1b5)]};if(_0x20aff2==null)return;this[_0x3ad542(0x1c6)](this[_0x3ad542(0x1d2)][_0x3ad542(0x1e0)],_0x20aff2);}})),this[_0x51e04f(0x1c0)](this[_0x51e04f(0x1d2)][_0x51e04f(0x1da)],()=>_0x8638d1['onCommandExecuted'](_0x24ac2e=>{const _0x34e1f6=_0x51e04f;if(_0x24ac2e['id']===_0x5eef04['id']){const _0x4d02cf=_0x58c2dc[_0x34e1f6(0x1d3)](_0x546575);if(!this['getActiveUniverSheet']())return;const _0x19fb2b={'layoutConfig':_0x4d02cf[_0x34e1f6(0x1bc)],'renderConfig':_0x4d02cf['renderConfig']};if(_0x19fb2b==null)return;this[_0x34e1f6(0x1c6)](this['Event']['SheetPrintCanceled'],_0x19fb2b);}}));}}_0x5c1f00[_0x250c34(0x1dc)](M);