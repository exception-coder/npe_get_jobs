'use strict';const _0x26df03=_0x485d;(function(_0x599b3e,_0x4f34e0){const _0x15d837=_0x485d,_0x23c27b=_0x599b3e();while(!![]){try{const _0x6fc85b=parseInt(_0x15d837(0xc0))/0x1*(parseInt(_0x15d837(0x15b))/0x2)+parseInt(_0x15d837(0xa9))/0x3+-parseInt(_0x15d837(0x127))/0x4+-parseInt(_0x15d837(0x17f))/0x5+parseInt(_0x15d837(0x147))/0x6+parseInt(_0x15d837(0x125))/0x7*(-parseInt(_0x15d837(0x11e))/0x8)+parseInt(_0x15d837(0x162))/0x9;if(_0x6fc85b===_0x4f34e0)break;else _0x23c27b['push'](_0x23c27b['shift']());}catch(_0x5cf10b){_0x23c27b['push'](_0x23c27b['shift']());}}}(_0x2475,0x24130));var ee=Object[_0x26df03(0x13c)],te=(_0x4c888b,_0x3bca5d,_0x2e6f29)=>_0x3bca5d in _0x4c888b?ee(_0x4c888b,_0x3bca5d,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0x2e6f29}):_0x4c888b[_0x3bca5d]=_0x2e6f29,y=(_0x400639,_0x10b9f5,_0x28be3a)=>te(_0x400639,typeof _0x10b9f5!='symbol'?_0x10b9f5+'':_0x10b9f5,_0x28be3a);function _0x485d(_0x5acc11,_0x470c15){const _0x2475a1=_0x2475();return _0x485d=function(_0x485dee,_0x31af59){_0x485dee=_0x485dee-0x99;let _0x4ff74f=_0x2475a1[_0x485dee];return _0x4ff74f;},_0x485d(_0x5acc11,_0x470c15);}const l=require('@univerjs-pro/engine-pivot'),r=require('@univerjs-pro/sheets-pivot'),m=require('@univerjs/core'),R=require('@univerjs/sheets/facade'),A=require('@univerjs/core/facade'),ie=require('rxjs');class x{constructor(_0x1b93f6,_0x32145e,_0x5698e7,_0x1b65f1){const _0x2b0fc3=_0x26df03;y(this,_0x2b0fc3(0x10a)),y(this,_0x2b0fc3(0xe5)),y(this,_0x2b0fc3(0x128)),y(this,_0x2b0fc3(0xf7)),(this['unitId']=_0x1b93f6,this[_0x2b0fc3(0xe5)]=_0x32145e,this[_0x2b0fc3(0x128)]=_0x5698e7,this[_0x2b0fc3(0xf7)]=_0x1b65f1);}[_0x26df03(0xa4)](){const _0x5b4017=_0x26df03;return this['_injector']['get'](r[_0x5b4017(0x136)])[_0x5b4017(0x12b)](this[_0x5b4017(0x10a)],this['subUnitId'],this[_0x5b4017(0x128)]);}[_0x26df03(0x118)](_0xfc4d8e){const _0x4c81e4=_0x26df03,_0x2b4b7c=this[_0x4c81e4(0xf7)][_0x4c81e4(0xf8)](m[_0x4c81e4(0x149)]),_0x6d7bed={'unitId':this[_0x4c81e4(0x10a)],'subUnitId':this[_0x4c81e4(0xe5)],'pivotTableId':this[_0x4c81e4(0x128)],'pivotTableConfig':_0xfc4d8e};return _0x2b4b7c[_0x4c81e4(0xec)](r[_0x4c81e4(0x164)]['id'],_0x6d7bed);}[_0x26df03(0x14b)](_0x49333c){const _0x3ec8b3=_0x26df03,_0x342ac7=this[_0x3ec8b3(0xf7)][_0x3ec8b3(0xf8)](m[_0x3ec8b3(0x149)]),_0x2a9451={'unitId':this[_0x3ec8b3(0x10a)],'subUnitId':this[_0x3ec8b3(0xe5)],'pivotTableId':this[_0x3ec8b3(0x128)],'resetArea':_0x49333c};return _0x342ac7['executeCommand'](r['ResetPivotFieldsConfigCommand']['id'],_0x2a9451);}[_0x26df03(0xf6)](){return this['pivotTableId'];}[_0x26df03(0x13a)](_0x2a85cd){const _0x5155ab=_0x26df03,_0x5be572=this['_injector'][_0x5155ab(0xf8)](r['SheetsPivotTableConfigModel'])[_0x5155ab(0x12b)](this['unitId'],this[_0x5155ab(0xe5)],this[_0x5155ab(0x128)]),_0x3ebedf=_0x5be572==null?void 0x0:_0x5be572['fieldsConfig'];if(_0x3ebedf)return _0x3ebedf[_0x5155ab(0x177)][_0x2a85cd]||_0x3ebedf[_0x5155ab(0x132)][_0x2a85cd];}['getSourceFieldsInfo'](){const _0x3bfa4c=_0x26df03,_0x550bc9=this[_0x3bfa4c(0xf7)],_0x3b73e4=this[_0x3bfa4c(0x10a)],_0x472e1b=this[_0x3bfa4c(0x128)],_0x9daacc=_0x550bc9[_0x3bfa4c(0xf8)](r['SheetsPivotTableConfigModel'])[_0x3bfa4c(0x15e)](_0x3b73e4,_0x472e1b);if(_0x9daacc){const _0x2316f2=_0x9daacc['fieldIds'],_0x5f1daf=_0x9daacc[_0x3bfa4c(0xde)],_0x362bf7=_0x9daacc['displayNameRecord'],_0x25449d=[];for(const _0x2953f6 of _0x2316f2){const _0x207f38=_0x5f1daf[_0x2953f6];if(_0x207f38){const _0x5435dc={'id':_0x2953f6,'name':_0x207f38[_0x3bfa4c(0xf9)],'fieldDataType':_0x207f38[_0x3bfa4c(0xc6)]};_0x362bf7&&_0x362bf7[_0x2953f6]!==void 0x0&&(_0x5435dc[_0x3bfa4c(0xb5)]=_0x362bf7[_0x2953f6]),_0x25449d[_0x3bfa4c(0xbb)](_0x5435dc);}}return _0x25449d;}return[];}[_0x26df03(0x10c)](_0x5c075f){const _0x3e6046=_0x26df03;var _0x3d01ef;const _0x10f75b=this[_0x3e6046(0xf7)][_0x3e6046(0xf8)](r[_0x3e6046(0x136)])['getPivotTableConfig'](this[_0x3e6046(0x10a)],this['subUnitId'],this['pivotTableId']),_0x1c1811=_0x10f75b==null?void 0x0:_0x10f75b['fieldsConfig'][_0x3e6046(0xf5)];return(_0x3d01ef=_0x1c1811==null?void 0x0:_0x1c1811[_0x3e6046(0xc7)](_0x4fb8ee=>_0x4fb8ee[_0x3e6046(0xa5)]===_0x5c075f))==null?void 0x0:_0x3d01ef[_0x3e6046(0xdb)];}[_0x26df03(0xfd)](){const _0x12a5f9=_0x26df03,_0x492783=this[_0x12a5f9(0xf7)]['get'](r[_0x12a5f9(0x136)])[_0x12a5f9(0x12b)](this[_0x12a5f9(0x10a)],this[_0x12a5f9(0xe5)],this[_0x12a5f9(0x128)]),_0x1970f5=_0x492783==null?void 0x0:_0x492783[_0x12a5f9(0x12e)]['valueFilter'];return(_0x1970f5==null?void 0x0:_0x1970f5[_0x12a5f9(0x121)]())||[];}[_0x26df03(0x9e)](_0x1d464f){const _0x802467=_0x26df03,_0x4d60fb=this['_injector'][_0x802467(0xf8)](r[_0x802467(0x136)])[_0x802467(0x12b)](this[_0x802467(0x10a)],this[_0x802467(0xe5)],this[_0x802467(0x128)]),_0x4a3137=_0x4d60fb==null?void 0x0:_0x4d60fb['fieldsConfig'];if(_0x4a3137)switch(_0x1d464f){case l[_0x802467(0x170)]['Column']:return _0x4a3137[_0x802467(0xf2)][_0x802467(0x121)]();case l[_0x802467(0x170)]['Row']:return _0x4a3137[_0x802467(0x124)][_0x802467(0x121)]();case l[_0x802467(0x170)][_0x802467(0x18a)]:return _0x4a3137[_0x802467(0xc9)]['concat']();case l['PivotTableFiledAreaEnum'][_0x802467(0x15c)]:return _0x4a3137[_0x802467(0xaa)][_0x802467(0x121)]();case l[_0x802467(0x170)]['Hidden']:return _0x4a3137['hiddenFields']['concat']();}return[];}[_0x26df03(0x163)](){const _0x32367f=_0x26df03;var _0x311060;const _0x2f7e8d=(_0x311060=this[_0x32367f(0xf7)][_0x32367f(0xf8)](r[_0x32367f(0x136)])[_0x32367f(0x163)](this['unitId'],this[_0x32367f(0xe5)],this[_0x32367f(0x128)]))==null?void 0x0:_0x311060['rangeInfo'];if(_0x2f7e8d)return r['unionPivotViewRange'](_0x2f7e8d);}async[_0x26df03(0x161)](){const _0x58066d=_0x26df03;return await this[_0x58066d(0xf7)][_0x58066d(0xf8)](m[_0x58066d(0x149)])[_0x58066d(0x12f)](r[_0x58066d(0x9d)]['id'],{'unitId':this[_0x58066d(0x10a)],'subUnitId':this[_0x58066d(0xe5)],'pivotTableId':this[_0x58066d(0x128)]});}async['addField'](_0x38aa11,_0x157c96,_0x3253cf){const _0x50ea6d=_0x26df03,_0x50399a=this[_0x50ea6d(0xf7)],_0x553962=this[_0x50ea6d(0x10a)],_0x3fc461=this[_0x50ea6d(0xe5)],_0x37e016=this['pivotTableId'],_0x3ecef6=_0x50399a['get'](m[_0x50ea6d(0x149)]),_0x49795e=_0x50399a['get'](r[_0x50ea6d(0x136)]),_0x7e81db=_0x49795e[_0x50ea6d(0x12b)](_0x553962,_0x3fc461,_0x37e016),_0x20a402=_0x49795e[_0x50ea6d(0x15e)](_0x553962,_0x37e016);if(!_0x7e81db||!_0x20a402)return!0x1;let _0x13db14=_0x38aa11;typeof _0x13db14==_0x50ea6d(0xb7)&&(_0x13db14=_0x49795e['getCollection'](_0x553962,_0x37e016)[_0x50ea6d(0x14d)][_0x38aa11]);const _0x3e8377={'unitId':_0x553962,'subUnitId':_0x3fc461,'pivotTableId':_0x37e016,'dataFieldId':_0x13db14,'fieldArea':_0x157c96,'index':_0x3253cf};return _0x3ecef6[_0x50ea6d(0xec)](r[_0x50ea6d(0x12a)]['id'],_0x3e8377);}async[_0x26df03(0x15d)](_0x326962){const _0x1d482c=_0x26df03,_0x58f867=this[_0x1d482c(0xf7)],_0x1cddf4=this[_0x1d482c(0x10a)],_0x4f42e3=this[_0x1d482c(0xe5)],_0x3dcaf2=this[_0x1d482c(0x128)],_0x93d7af=_0x58f867[_0x1d482c(0xf8)](m[_0x1d482c(0x149)]),_0x239d44={'unitId':_0x1cddf4,'subUnitId':_0x4f42e3,'pivotTableId':_0x3dcaf2,'fieldIds':_0x326962};return _0x93d7af[_0x1d482c(0xec)](r['RemovePivotFieldCommand']['id'],_0x239d44);}async[_0x26df03(0xb8)](_0x50b88f,_0x495bc7,_0x4a79c7){const _0x5602d7=_0x26df03,_0x2a74cf=this['_injector'],_0x5a21d6=this[_0x5602d7(0x10a)],_0x18cb99=this[_0x5602d7(0xe5)],_0x585461=this[_0x5602d7(0x128)],_0x489be8=_0x2a74cf[_0x5602d7(0xf8)](m[_0x5602d7(0x149)]),_0x579089={'unitId':_0x5a21d6,'subUnitId':_0x18cb99,'pivotTableId':_0x585461,'fieldId':_0x50b88f,'area':_0x495bc7,'index':_0x4a79c7};return _0x489be8['executeCommand'](r['MovePivotFieldCommand']['id'],_0x579089);}async[_0x26df03(0x11f)](_0x2b5f1e,_0x5d126d){const _0x46f4fa=_0x26df03,_0x1727f3=this[_0x46f4fa(0xf7)],_0x1a0a73=this[_0x46f4fa(0x10a)],_0x9e0f=this[_0x46f4fa(0xe5)],_0x2068a2=this[_0x46f4fa(0x128)],_0x1c583f=_0x1727f3['get'](m[_0x46f4fa(0x149)]),_0x2ee2e9={'unitId':_0x1a0a73,'subUnitId':_0x9e0f,'pivotTableId':_0x2068a2,'position':_0x2b5f1e,'index':_0x5d126d};return _0x1c583f[_0x46f4fa(0xec)](r['UpdatePivotValuePositionCommand']['id'],_0x2ee2e9);}async[_0x26df03(0xd0)](_0x16822e,_0x41c2aa){const _0x4b1ad0=_0x26df03,_0x589fb6=this[_0x4b1ad0(0xf7)],_0x284913=this[_0x4b1ad0(0x10a)],_0x5d4584=this[_0x4b1ad0(0xe5)],_0x30b036=this[_0x4b1ad0(0x128)],_0x25eb33=_0x589fb6[_0x4b1ad0(0xf8)](m[_0x4b1ad0(0x149)]),_0x327c34={'unitId':_0x284913,'subUnitId':_0x5d4584,'pivotTableId':_0x30b036,'fieldId':_0x16822e,'subtotalType':_0x41c2aa};return _0x25eb33[_0x4b1ad0(0xec)](r['SetPivotSubtotalTypeMutation']['id'],_0x327c34);}async['setLabelSort'](_0x217f55,_0x32dabc){const _0xf81e77=_0x26df03,_0x3000cb=this[_0xf81e77(0xf7)],_0x1387d7=this[_0xf81e77(0x10a)],_0x61f1a6=this['subUnitId'],_0x3a3d49=this[_0xf81e77(0x128)],_0x1b0758=_0x3000cb['get'](m['ICommandService']),_0x45e54f={'unitId':_0x1387d7,'subUnitId':_0x61f1a6,'tableFieldId':_0x217f55,'pivotTableId':_0x3a3d49,'info':_0x32dabc};return _0x1b0758[_0xf81e77(0xec)](r[_0xf81e77(0x119)]['id'],_0x45e54f);}async['setLabelManualFilter'](_0x2393a1,_0xb32ae9,_0x939bab){const _0x186592=_0x26df03,_0x29e7f2=this[_0x186592(0xf7)],_0x33b0a7=this['unitId'],_0x1a8a6a=this[_0x186592(0xe5)],_0x423c22=this[_0x186592(0x128)],_0x285b31=_0x29e7f2[_0x186592(0xf8)](m['ICommandService']),_0x10c199={'unitId':_0x33b0a7,'subUnitId':_0x1a8a6a,'pivotTableId':_0x423c22,'tableFieldId':_0x2393a1,'items':_0xb32ae9,'isAll':_0x939bab};return _0x285b31[_0x186592(0xec)](r[_0x186592(0x16d)]['id'],_0x10c199);}async[_0x26df03(0xb4)](_0x40b0c7,_0x12369b){const _0x366699=_0x26df03,_0x8bd187=this[_0x366699(0xf7)],_0x4501ce=this[_0x366699(0x10a)],_0xf514c6=this[_0x366699(0xe5)],_0x36bb24=this[_0x366699(0x128)],_0x502832=_0x8bd187[_0x366699(0xf8)](m[_0x366699(0x149)]);if(_0x40b0c7===void 0x0)return console[_0x366699(0xac)](_0x366699(0x14c)),!0x1;const _0xf135bb=_0x12369b&&{..._0x12369b,'type':l[_0x366699(0xd9)]['ValueFilter']},_0x47b341={'unitId':_0x4501ce,'subUnitId':_0xf514c6,'pivotTableId':_0x36bb24,'fieldId':_0x40b0c7,'valueFilterInfo':_0xf135bb};return _0x502832[_0x366699(0xec)](r[_0x366699(0xe4)]['id'],_0x47b341);}async[_0x26df03(0x169)](_0x2c050d,_0x5debfb){const _0xaead98=_0x26df03,_0xba5c11=this[_0xaead98(0xf7)],_0x565da3=this[_0xaead98(0x10a)],_0x26e5c9=this[_0xaead98(0xe5)],_0x29d3e1=this[_0xaead98(0x128)],_0x436031=_0xba5c11[_0xaead98(0xf8)](m[_0xaead98(0x149)]),_0x1d3796={'unitId':_0x565da3,'subUnitId':_0x26e5c9,'pivotTableId':_0x29d3e1,'fieldId':_0x2c050d,'name':_0x5debfb};return _0x436031[_0xaead98(0xec)](r[_0xaead98(0xb2)]['id'],_0x1d3796);}async[_0x26df03(0x146)](_0x35ec11,_0x543c0e,_0x21fef5){const _0x188856=_0x26df03,_0x1eed14=this[_0x188856(0xf7)][_0x188856(0xf8)](m[_0x188856(0x149)]),_0x1ef400=this[_0x188856(0xf7)][_0x188856(0xf8)](m[_0x188856(0x13f)])[_0x188856(0x16e)](this[_0x188856(0x10a)]),_0x539071=_0x1ef400==null?void 0x0:_0x1ef400[_0x188856(0xae)](_0x35ec11);if(!_0x1ef400||!_0x539071)throw new Error(_0x188856(0x16c));return _0x1eed14[_0x188856(0xec)](r['MovePivotTableCommand']['id'],{'pivotTableId':this['pivotTableId'],'targetCellInfo':{'subUnitId':_0x539071['getSheetId'](),'unitId':this['unitId'],'row':_0x543c0e,'col':_0x21fef5},'originTargetInfo':{'subUnitId':this[_0x188856(0xe5)],'unitId':this[_0x188856(0x10a)]}});}async[_0x26df03(0x16f)](_0x462185,_0x47d3f6){const _0x21bf48=_0x26df03,_0x41c317=this[_0x21bf48(0xf7)],_0x42548b=this['unitId'],_0x30133e=this[_0x21bf48(0xe5)],_0x746069=this[_0x21bf48(0x128)],_0x422983=_0x41c317[_0x21bf48(0xf8)](m[_0x21bf48(0x149)]),_0x5bbb8b={'unitId':_0x42548b,'subUnitId':_0x30133e,'pivotTableId':_0x746069,'tableFieldId':_0x462185,'dateType':_0x47d3f6};return _0x422983[_0x21bf48(0xec)](r[_0x21bf48(0x112)]['id'],_0x5bbb8b);}}class oe extends R[_0x26df03(0x183)]{async[_0x26df03(0xda)](_0x2beaa5,_0x4c86c8,_0x1c0998){const _0x55e570=_0x26df03,_0xa51f8a=this[_0x55e570(0xf7)],_0x11f78c=_0xa51f8a['get'](m[_0x55e570(0x149)]),_0x3094b1=l[_0x55e570(0x10f)](0x8),_0x38985e={'positionType':_0x4c86c8,'pivotTableId':_0x3094b1,'pivotTableConfig':{'targetCellInfo':_0x1c0998,'sourceRangeInfo':_0x2beaa5,'isEmpty':!0x0}};if(await _0x11f78c[_0x55e570(0xec)](r['AddPivotTableCommand']['id'],_0x38985e))return new x(_0x1c0998[_0x55e570(0x10a)],_0x1c0998[_0x55e570(0xe5)],_0x3094b1,_0xa51f8a);}[_0x26df03(0x103)](_0x4fbf7c,_0x3e964f,_0x4cfbd5,_0x11c529){const _0x2cc0dc=_0x26df03,_0xfe4d27=this[_0x2cc0dc(0xf7)],_0x3286bc=_0xfe4d27[_0x2cc0dc(0xf8)](r[_0x2cc0dc(0x137)])[_0x2cc0dc(0x14e)](_0x4fbf7c,_0x3e964f,_0x4cfbd5,_0x11c529);if(_0x3286bc)return new x(_0x4fbf7c,_0x3e964f,_0x3286bc,_0xfe4d27);}[_0x26df03(0x11a)](_0x1de6b0){const _0x50b975=_0x26df03,_0x15659b=this[_0x50b975(0xf7)],_0x18035f=_0x15659b['get'](r[_0x50b975(0x136)])[_0x50b975(0xc5)](this['getId'](),_0x1de6b0);if(_0x18035f)return new x(_0x18035f[_0x50b975(0x10a)],_0x18035f[_0x50b975(0xe5)],_0x1de6b0,_0x15659b);}}R[_0x26df03(0x183)][_0x26df03(0xc4)](oe);class ne extends R['FWorksheet']{['getPivotTableByCell'](_0x5a95a8,_0x47a755){const _0x3b5bb7=_0x26df03,_0x39fd1=this['_injector'],_0x45486c=_0x39fd1[_0x3b5bb7(0xf8)](r[_0x3b5bb7(0x137)]),_0x52e2f8=this[_0x3b5bb7(0xb0)]['getUnitId'](),_0xfc67b=this[_0x3b5bb7(0xd3)](),_0x2bcb7c=_0x45486c[_0x3b5bb7(0x14e)](_0x52e2f8,_0xfc67b,_0x5a95a8,_0x47a755);if(_0x2bcb7c)return new x(_0x52e2f8,_0xfc67b,_0x2bcb7c,_0x39fd1);}}R[_0x26df03(0x9a)]['extend'](ne);class ae extends A['FEnum']{get[_0x26df03(0x16a)](){const _0x484b02=_0x26df03;return l[_0x484b02(0x16a)];}get[_0x26df03(0xd9)](){const _0x2b7b34=_0x26df03;return l[_0x2b7b34(0xd9)];}get[_0x26df03(0x170)](){const _0xcbcb39=_0x26df03;return l[_0xcbcb39(0x170)];}get['PivotTableValuePositionEnum'](){const _0x2ab112=_0x26df03;return l[_0x2ab112(0xbd)];}get[_0x26df03(0x17c)](){const _0xe936c3=_0x26df03;return l[_0xe936c3(0x17c)];}get[_0x26df03(0x11c)](){const _0x3f36c0=_0x26df03;return l[_0x3f36c0(0x11c)];}get['PivotDataFieldSortOperatorEnum'](){const _0x3777e3=_0x26df03;return l[_0x3777e3(0xf0)];}get[_0x26df03(0x116)](){return l['ST_PivotFilterOperatorEnum'];}get[_0x26df03(0x9b)](){return r['PositionType'];}get[_0x26df03(0xe8)](){const _0x2368cf=_0x26df03;return l[_0x2368cf(0xe8)];}get[_0x26df03(0x17e)](){const _0x42b8c9=_0x26df03;return l[_0x42b8c9(0x17e)];}}A[_0x26df03(0x157)][_0x26df03(0xc4)](ae);class se extends A[_0x26df03(0x16b)]{get['PivotTableAdded'](){const _0x55ac7b=_0x26df03;return _0x55ac7b(0x15f);}get[_0x26df03(0xab)](){const _0x16ac8c=_0x26df03;return _0x16ac8c(0xab);}get[_0x26df03(0xaf)](){const _0x502a16=_0x26df03;return _0x502a16(0xaf);}get[_0x26df03(0x10b)](){return'PivotTableMoved';}get[_0x26df03(0x140)](){return'PivotTableRendered';}get['PivotTableFieldAdded'](){const _0x174a7a=_0x26df03;return _0x174a7a(0x188);}get[_0x26df03(0xc2)](){const _0x50c745=_0x26df03;return _0x50c745(0xc2);}get['PivotTableFieldMoved'](){const _0x4911e2=_0x26df03;return _0x4911e2(0x181);}get['PivotTableFieldCollapseChanged'](){const _0x444f47=_0x26df03;return _0x444f47(0xee);}get['PivotTableFieldFilterChanged'](){const _0x22f2dc=_0x26df03;return _0x22f2dc(0x109);}get[_0x26df03(0x141)](){const _0x53c287=_0x26df03;return _0x53c287(0x141);}get[_0x26df03(0x11d)](){return'PivotTableFieldSettingChanged';}get[_0x26df03(0xef)](){return'PivotTableValuePositionChanged';}}A['FEventName'][_0x26df03(0xc4)](se);const Z=_0x26df03(0xcd);function de(_0x41c4c7){return _0x41c4c7/0x3e8/0x15180+0x63e1;}function _0x2475(){const _0x54639b=['LocaleService','YYYY-MM-DD','PivotViewCellValueTypeEnum','LifecycleService','setSubtotalType','format','_fireBeforeAddPivotTableEvent','getSheetId','_firePivotTableRemovedEvent','None','getColCount','_id','sum','PivotFilterTypeEnum','addPivotTable','filterInfo','getTime','getDataFieldIdByDisplayName','fields','endColumn','setFieldFormat','getFieldDataTypeByColumnIndex','startColumn','AddPivotTableCommand','SetPivotValueFilterCommand','subUnitId','getDataFieldByTableId','getFieldDisplayNames','PivotTableChangeTypeEnum','getValuePosition','registerEventHandler','headerMap','executeCommand','iterateFieldByArea','PivotTableFieldCollapseChanged','PivotTableValuePositionChanged','PivotDataFieldSortOperatorEnum','总计\x20','columnFields','getFieldIds','GrandTotal','valueFilter','getPivotTableId','_injector','get','name','MovePivotTableCommand','_firePivotTableFieldCollapsedEvent','numfmt','getValueFilters','ZH_CN','getRowCount','dataFieldsCollection','SetPivotCollapseCommand','object','getPivotTableByCell','targetCellInfo','Total\x20','forEach','_firePivotTableFieldSettingChangedEvent','BeforePivotTableMove','PivotTableFieldFilterChanged','unitId','PivotTableMoved','getValueFilter','filter','count','generateHexNumber','valueIndex','auditTime','UpdateDateGroupCommand','col','_fireBeforeMovePivotTableEvent','getRangeData','PivotFilterOperatorEnum','blank','setFieldsConfig','SetPivotSortCommand','getPivotTableById','Row','PivotDataFieldSortTypeEnum','PivotTableFieldSettingChanged','22168hYfmJn','updateValuePosition','startRow','concat','tableFieldId','isBottomTotal','rowFields','49iJkQRc','Before\x20add\x20pivot\x20table\x20event\x20canceled','374080vShiee','pivotTableId','_firePivotTableValuePositionChangedEvent','AddPivotFieldCommand','getPivotTableConfig','_firePivotTableFieldSortChangedEvent','_firePivotTableFieldFilterChangedEvent','fieldsConfig','syncExecuteCommand','addFieldWithName','_fireMovedPivotTableEvent','measure','[PivotTable]:\x20The\x20field\x20name\x20','getFieldDataTypeByFieldName','endRow','SheetsPivotTableConfigModel','SheetsPivotTableAdaptorModel','addValueFieldWithName','UpdatePivotFieldSettingCommand','getFieldSetting','小计\x20','defineProperty','info','params','IUniverInstanceService','PivotTableRendered','PivotTableFieldSortChanged','subtotal','PivotTable','sheetName','dispose','move','279168qAjgiM','getValueIndex','ICommandService','other','reset','[Pivot\x20Table]:\x20The\x20field\x20id\x20is\x20undefined','fieldIds','getPivotTableIdByCell','getCurrentLocale','createCollection','（空白）','onCommandExecuted','data','_fireRenderPivotTableEvent','addFilterFieldWithName','Column','FEnum','getFieldById','_fireAddPivotTableEvent','AddPivotTableWithConfigCommand','100ElbWbm','Filter','removeField','getCollection','PivotTableAdded','string','remove','1147563kHqFkP','getPivotTableRangeInfo','SetPivotFieldsConfigCommand','FUniver','Ready','length','addFieldWithSourceId','renameField','PivotSubtotalTypeEnum','FEventName','[Pivot\x20Table]:\x20Target\x20sheet\x20is\x20not\x20valid','SetPivotFilterCommand','getUnit','setDateGroupType','PivotTableFiledAreaEnum','query','(blank)','lifecycle$','beforeCommandExecuted','fireEvent','keys','dimension','_sourceData','LocaleType','setOptions','level','PivotDataFieldDataTypeEnum','UpdatePivotValuePositionCommand','PivotDateGroupFieldDateTypeEnum','365725EErfVT','cancel','PivotTableFieldMoved','Subtotal','FWorkbook','_firePivotTableFieldAddedEvent','removeFieldWithName','getFieldDataType','_firePivotTableFieldMovedEvent','PivotTableFieldAdded','range','Value','Event','Grand\x20Total\x20','disposeWithMe','FWorksheet','PositionTypeEnum','RemovePivotFieldCommand','RemovePivotTableMutation','getFieldIdsByArea','getId','getSourceName','[PivotTable]:\x20add\x20field\x20','_getSourceIdByName','_pivot','getConfig','fieldId','Before\x20move\x20pivot\x20table\x20event\x20canceled','row','max','254511cHRidA','filterFields','BeforePivotTableAdd','warn','(other)','getSheetBySheetName','PivotTableRemoved','_workbook','getValueFields','RenamePivotFieldMutation','MovePivotFieldCommand','setValueFilter','displayName','isNaN','number','updateFieldPosition','_firePivotTableFieldRemovedEvent','getNameWithColumnIndex','push','value','PivotTableValuePositionEnum','date','subscribe','1499wZXZxU','_isZhCN','PivotTableFieldRemoved','PivotCellStyleTypeEnum','extend','getTargetByPivotTableId','fieldDataType','find','setFilterInfo','valueFields','\x20is\x20not\x20found\x20in\x20the\x20pivot\x20table.','LifecycleStages'];_0x2475=function(){return _0x54639b;};return _0x2475();}function le(_0x365379,_0x111788,_0x41a2e6,_0x552386){const _0x2f6747=_0x26df03;var _0x3fb466,_0x25daa8,_0x5ec9b3,_0x294cad,_0x2abbe5,_0x3e4c8f,_0x55b1b5,_0x14ec1d,_0x4ea034,_0x6dbf64,_0x5360cf,_0x3c93a5,_0x48bb03,_0x475456,_0x2e3b6e;const _0x53d5a9=[],_0x229dc4=[],_0x320185=[],{showRowGrandTotal:_0x420d02,showRowSubTotal:_0x17a443}=_0x552386,{cornerView:_0x25058a,colView:_0x3d591b,rowView:_0x3327eb,dataView:_0x50d441,formatMap:_0x23ea54}=_0x111788,_0x3bd638=_0x25058a[_0x2f6747(0xff)](),_0x367da6=_0x25058a['getColCount']();for(let _0x10be2a=0x0;_0x10be2a<_0x3bd638;_0x10be2a++)for(let _0x50961f=0x0;_0x50961f<_0x367da6;_0x50961f++){const _0xeaa415={...(_0x25daa8=(_0x3fb466=_0x25058a[_0x2f6747(0x153)])==null?void 0x0:_0x3fb466[_0x10be2a])==null?void 0x0:_0x25daa8[_0x50961f]};_0xeaa415['v']&&(_0x53d5a9[_0x10be2a]||(_0x53d5a9[_0x10be2a]=[]),_0x320185[_0x10be2a]||(_0x320185[_0x10be2a]=[]),_0x53d5a9[_0x10be2a][_0x50961f]=_0xeaa415['v'],_0x320185[_0x10be2a][_0x50961f]=_0xeaa415['v']);}for(let _0x4ea8b0=0x0;_0x4ea8b0<_0x3d591b['getRowCount']();_0x4ea8b0++){const _0x1d80f2=(_0x294cad=(_0x5ec9b3=_0x3d591b==null?void 0x0:_0x3d591b[_0x2f6747(0xeb)])==null?void 0x0:_0x5ec9b3[_0x4ea8b0])==null?void 0x0:_0x294cad[_0x2f6747(0x122)],_0xd48e56=_0x1d80f2?_0x23ea54[_0x1d80f2]:'';for(let _0x256168=0x0;_0x256168<_0x3d591b[_0x2f6747(0xd6)]();_0x256168++){const _0x411e59={...(_0x3e4c8f=(_0x2abbe5=_0x3d591b[_0x2f6747(0x153)])==null?void 0x0:_0x2abbe5[_0x4ea8b0])==null?void 0x0:_0x3e4c8f[_0x256168]};if((_0x411e59==null?void 0x0:_0x411e59['v'])!==void 0x0){let _0x47699d=_0xd48e56?m['numfmt'][_0x2f6747(0xd1)](_0xd48e56,Number(_0x411e59['v'])):_0x411e59['v'];(_0x411e59==null?void 0x0:_0x411e59['s'])===l['PivotCellStyleTypeEnum']['Subtotal']?_0x47699d=_0x41a2e6?_0x2f6747(0x13b)+_0x47699d:'Total\x20'+_0x47699d:(_0x411e59==null?void 0x0:_0x411e59['s'])===l[_0x2f6747(0xc3)][_0x2f6747(0xf4)]&&(_0x47699d=_0x41a2e6?'总计\x20'+_0x47699d:_0x2f6747(0x18c)+_0x47699d),(_0x411e59==null?void 0x0:_0x411e59['t'])===l[_0x2f6747(0xce)][_0x2f6747(0x117)]&&(_0x47699d=_0x41a2e6?_0x2f6747(0x151):_0x2f6747(0x172)),(_0x411e59==null?void 0x0:_0x411e59['t'])===l[_0x2f6747(0xce)][_0x2f6747(0x14a)]&&(_0x47699d=_0x41a2e6?'（其他）':_0x2f6747(0xad)),_0x53d5a9[_0x4ea8b0]||(_0x53d5a9[_0x4ea8b0]=[]),_0x320185[_0x4ea8b0]||(_0x320185[_0x4ea8b0]=[]),_0x53d5a9[_0x4ea8b0][_0x256168+_0x367da6]=_0x47699d,_0x320185[_0x4ea8b0][_0x256168+_0x367da6]=_0x47699d;}}}let _0x53217c=0x0,_0x14e798=0x0,_0x10af2d=0x0;for(let _0x2ed0f9=0x0;_0x2ed0f9<_0x3327eb[_0x2f6747(0xff)]();_0x2ed0f9++){const _0x259b13=_0x3327eb[_0x2f6747(0x13d)][_0x2ed0f9];if(!_0x17a443&&_0x259b13[_0x2f6747(0x123)]&&_0x259b13[_0x2f6747(0x17b)]!==0x0){_0x10af2d++,_0x14e798=0x0;continue;}if(!(!_0x420d02&&_0x259b13[_0x2f6747(0x123)]&&_0x259b13[_0x2f6747(0x17b)]===0x0)){for(let _0x158d0a=0x0;_0x158d0a<_0x3327eb[_0x2f6747(0xd6)]();_0x158d0a++){const _0x560c1d={...(_0x14ec1d=(_0x55b1b5=_0x3327eb[_0x2f6747(0x153)])==null?void 0x0:_0x55b1b5[_0x2ed0f9])==null?void 0x0:_0x14ec1d[_0x158d0a]},_0x39b619=(_0x6dbf64=(_0x4ea034=_0x3327eb==null?void 0x0:_0x3327eb[_0x2f6747(0xeb)])==null?void 0x0:_0x4ea034[_0x158d0a])==null?void 0x0:_0x6dbf64[_0x2f6747(0x122)],_0x32c85d=_0x39b619?_0x23ea54[_0x39b619]:'';if((_0x560c1d==null?void 0x0:_0x560c1d['v'])!==void 0x0){let _0x13e164=_0x32c85d?m['numfmt'][_0x2f6747(0xd1)](_0x32c85d,Number(_0x560c1d['v'])):_0x560c1d['v'];(_0x560c1d==null?void 0x0:_0x560c1d['s'])===l[_0x2f6747(0xc3)][_0x2f6747(0x182)]?_0x13e164=_0x41a2e6?_0x2f6747(0x13b)+_0x13e164:_0x2f6747(0x105)+_0x13e164:(_0x560c1d==null?void 0x0:_0x560c1d['s'])===l[_0x2f6747(0xc3)][_0x2f6747(0xf4)]&&(_0x13e164=_0x41a2e6?_0x2f6747(0xf1)+_0x13e164:_0x2f6747(0x18c)+_0x13e164),(_0x560c1d==null?void 0x0:_0x560c1d['t'])===l[_0x2f6747(0xce)][_0x2f6747(0x117)]&&(_0x13e164=_0x41a2e6?_0x2f6747(0x151):_0x2f6747(0x172)),(_0x560c1d==null?void 0x0:_0x560c1d['t'])===l['PivotViewCellValueTypeEnum']['other']&&(_0x13e164=_0x41a2e6?'（其他）':_0x2f6747(0xad)),_0x53d5a9[_0x53217c+_0x3bd638]||(_0x53d5a9[_0x53217c+_0x3bd638]=[]);let _0x18cbd8=_0x229dc4[_0x10af2d];_0x18cbd8||(_0x18cbd8=[..._0x320185],_0x229dc4[_0x10af2d]=_0x18cbd8),_0x18cbd8[_0x14e798+_0x3bd638]||(_0x18cbd8[_0x14e798+_0x3bd638]=[]),_0x18cbd8[_0x14e798+_0x3bd638][_0x158d0a]=_0x13e164,_0x53d5a9[_0x53217c+_0x3bd638][_0x158d0a]=_0x13e164;}}_0x53217c++,_0x3327eb[_0x2f6747(0x13d)][_0x2ed0f9][_0x2f6747(0x123)]?(_0x10af2d++,_0x14e798=0x0):_0x14e798++;}}_0x53217c=0x0,_0x10af2d=0x0,_0x14e798=0x0;for(let _0x3c6323=0x0;_0x3c6323<_0x50d441[_0x2f6747(0xff)]();_0x3c6323++){const _0xfc81e7=_0x3327eb[_0x2f6747(0x13d)][_0x3c6323];if(!_0x17a443&&_0xfc81e7[_0x2f6747(0x123)]&&_0xfc81e7['level']!==0x0){_0x10af2d++,_0x14e798=0x0;continue;}if(!(!_0x420d02&&_0xfc81e7[_0x2f6747(0x123)]&&_0xfc81e7[_0x2f6747(0x17b)]===0x0)){for(let _0x3acd4b=0x0;_0x3acd4b<_0x50d441[_0x2f6747(0xd6)]();_0x3acd4b++){const _0x4b43fd={...(_0x3c93a5=(_0x5360cf=_0x50d441['data'])==null?void 0x0:_0x5360cf[_0x3c6323])==null?void 0x0:_0x3c93a5[_0x3acd4b]};if(_0x4b43fd['v']){const _0x5868df=_0x3327eb[_0x2f6747(0x13d)][_0x3c6323]['valueIndex'],_0x583017=_0x3d591b[_0x2f6747(0x13d)][_0x3acd4b][_0x2f6747(0x110)],_0x5b2c0=Math[_0x2f6747(0xa8)](_0x5868df,_0x583017),_0x3026e1=_0x365379[_0x2f6747(0xb1)]()['concat']();let _0x4eeae2='';_0x5b2c0<0x0?_0x4eeae2=(_0x48bb03=_0x3026e1[0x0])!=null?_0x48bb03:'':_0x4eeae2=(_0x475456=_0x3026e1[_0x5b2c0])!=null?_0x475456:'';const _0x3e6b4f=(_0x2e3b6e=_0x23ea54[_0x4eeae2])!=null?_0x2e3b6e:'';_0x53d5a9[_0x53217c+_0x3bd638]||(_0x53d5a9[_0x53217c+_0x3bd638]=[]);let _0x51713c=_0x229dc4[_0x10af2d];_0x51713c||(_0x51713c=[..._0x320185],_0x229dc4[_0x10af2d]=_0x51713c),_0x51713c[_0x14e798+_0x3bd638]||(_0x51713c[_0x14e798+_0x3bd638]=[]);const _0x9e48fb=_0x3e6b4f?m[_0x2f6747(0xfc)]['format'](_0x3e6b4f,Number(_0x4b43fd['v'])):_0x4b43fd['v'];_0x51713c[_0x14e798+_0x3bd638][_0x3acd4b+_0x367da6]=_0x9e48fb,_0x53d5a9[_0x53217c+_0x3bd638][_0x3acd4b+_0x367da6]=_0x9e48fb;}}_0x53217c++,_0x3327eb[_0x2f6747(0x13d)][_0x3c6323]['isBottomTotal']?(_0x10af2d++,_0x14e798=0x0):_0x14e798++;}}return{'dataArr':_0x53d5a9,'dataArrWithSplit':_0x229dc4};}class re{constructor(_0x212dab,_0xc4f56e,_0x2a376c,_0x537cd7){const _0x341571=_0x26df03;y(this,'_pivot'),y(this,'_sourceData'),y(this,_0x341571(0xf7)),y(this,_0x341571(0xc1)),y(this,_0x341571(0xd7)),(this[_0x341571(0xf7)]=_0x212dab,this[_0x341571(0xa3)]=_0xc4f56e,this[_0x341571(0x178)]=_0x2a376c,this['_id']=_0x537cd7);const _0x45696d=this['_injector'][_0x341571(0xf8)](m[_0x341571(0xcc)]);this['_isZhCN']=_0x45696d[_0x341571(0x14f)]()===m[_0x341571(0x179)][_0x341571(0xfe)];}[_0x26df03(0xa2)](_0x4f3fb9){const _0x3cc43=_0x26df03,_0x4a1030=this[_0x3cc43(0xa3)][_0x3cc43(0xdd)](_0x4f3fb9);if(!_0x4a1030)throw new Error(_0x3cc43(0x133)+_0x4f3fb9+_0x3cc43(0xca));return _0x4a1030;}[_0x26df03(0x130)](_0x45a8b6,_0x24c5c3){const _0x9b8147=_0x26df03,_0x20a1c1=this[_0x9b8147(0xa2)](_0x45a8b6),_0x5cd807=this[_0x9b8147(0xa3)][_0x9b8147(0x168)](_0x20a1c1,_0x24c5c3);if(!_0x5cd807)throw new Error(_0x9b8147(0xa1)+_0x45a8b6+'\x20failed.');if(_0x24c5c3===l[_0x9b8147(0x170)][_0x9b8147(0x18a)]){const _0x34beb0=_0x5cd807[_0x9b8147(0x9f)](),_0x8afa41=this[_0x9b8147(0xa3)][_0x9b8147(0xe6)](_0x34beb0);if(_0x8afa41){const _0x189bf7=_0x8afa41==null?void 0x0:_0x8afa41[_0x9b8147(0x186)]();this[_0x9b8147(0xa3)]['setSubtotalType'](_0x34beb0,_0x189bf7===l[_0x9b8147(0x17c)][_0x9b8147(0xb7)]?l[_0x9b8147(0x16a)][_0x9b8147(0xd8)]:l[_0x9b8147(0x16a)][_0x9b8147(0x10e)]);}const _0x1584c6=this[_0x9b8147(0xa3)][_0x9b8147(0x148)](),_0x2806eb=this[_0x9b8147(0xa3)][_0x9b8147(0xe9)](),_0x1c8eae=this[_0x9b8147(0xa3)]['getFieldCountByArea'](l[_0x9b8147(0x170)][_0x9b8147(0x18a)]);if(_0x1584c6===-0x1&&_0x1c8eae>0x1){const _0x400580=_0x2806eb===l['PivotTableValuePositionEnum'][_0x9b8147(0xd5)]?l[_0x9b8147(0xbd)]['Column']:_0x2806eb,_0x103c7e=_0x400580===l[_0x9b8147(0xbd)]['Row']?l[_0x9b8147(0x170)]['Row']:l[_0x9b8147(0x170)][_0x9b8147(0x156)];this[_0x9b8147(0xa3)][_0x9b8147(0x11f)](_0x400580,this[_0x9b8147(0xa3)]['getFieldCountByArea'](_0x103c7e));}}else{if(_0x24c5c3===l[_0x9b8147(0x170)][_0x9b8147(0x11b)]||_0x24c5c3===l['PivotTableFiledAreaEnum'][_0x9b8147(0x156)]){const _0x4eb940=_0x5cd807['getId'](),_0x325cd0=this[_0x9b8147(0xa3)][_0x9b8147(0xe6)](_0x4eb940);if(_0x325cd0&&(_0x325cd0==null?void 0x0:_0x325cd0['getFieldDataType']())===l[_0x9b8147(0x17c)][_0x9b8147(0xbe)]){const _0x1c142f=_0x325cd0['getformat']();_0x1c142f&&this[_0x9b8147(0xa3)][_0x9b8147(0xe0)](_0x4eb940,_0x1c142f);}}}return _0x5cd807;}[_0x26df03(0x155)](_0x4307db,_0x5cde83){const _0x404c5d=_0x26df03,_0x2d0ba8=this[_0x404c5d(0xa2)](_0x4307db),_0x5b1733=this[_0x404c5d(0xa3)][_0x404c5d(0x168)](_0x2d0ba8,l[_0x404c5d(0x170)][_0x404c5d(0x15c)]);return _0x5b1733[_0x404c5d(0xc8)](_0x5cde83),_0x5b1733;}[_0x26df03(0x138)](_0x27589d,_0x1ac595){const _0x40e447=_0x26df03,_0x124aa4=this['addFieldWithName'](_0x27589d,l[_0x40e447(0x170)][_0x40e447(0x18a)]);return _0x1ac595!=null&&_0x1ac595[_0x40e447(0x142)]&&_0x124aa4['setSubtotal'](_0x1ac595==null?void 0x0:_0x1ac595[_0x40e447(0x142)]),_0x124aa4;}[_0x26df03(0x185)](_0x49008d){const _0x409a48=_0x26df03,_0x1e9731=this[_0x409a48(0xa2)](_0x49008d);this[_0x409a48(0xa3)]['getTableFieldsByDataFieldId'](_0x1e9731)[_0x409a48(0x106)](_0x5f2eda=>{const _0x4408fe=_0x409a48,_0x170aa7=_0x5f2eda[_0x4408fe(0x9f)]();this[_0x4408fe(0xa3)]['removeField'](_0x170aa7);});}['getResultByCalculate'](_0x4cd233={}){const _0x3d505d=_0x26df03,_0x3a236a=this['_pivot'][_0x3d505d(0x171)](),{dataArr:_0x5b60fd,dataArrWithSplit:_0x554330}=le(this[_0x3d505d(0xa3)],_0x3a236a,this[_0x3d505d(0xc1)],_0x4cd233);return{'dataArr':_0x5b60fd,'dataArrWithSplit':_0x554330};}[_0x26df03(0xba)](_0x3f30c6){const _0x2ca31e=_0x26df03;return this[_0x2ca31e(0xa3)][_0x2ca31e(0xe7)]()[_0x3f30c6];}[_0x26df03(0x14b)](){const _0x4dd5ae=_0x26df03;this[_0x4dd5ae(0xa3)][_0x4dd5ae(0x14b)]();}['resetDimension'](_0x547444){this['_pivot']['reset'](_0x547444);}[_0x26df03(0xe1)](_0x48be30){const _0x3de237=_0x26df03,_0x40eeb7=this[_0x3de237(0xa3)]['dataFieldsCollection'],_0x2fee7f=_0x40eeb7['getFieldIds']()[_0x48be30];if(_0x2fee7f)return _0x40eeb7[_0x3de237(0x158)](_0x2fee7f)[_0x3de237(0x186)]();}[_0x26df03(0x134)](_0x3cfb32){const _0x53eaae=_0x26df03,_0x494c45=this[_0x53eaae(0xa2)](_0x3cfb32),_0x43cff3=this[_0x53eaae(0xa3)][_0x53eaae(0x100)][_0x53eaae(0x158)](_0x494c45);return _0x43cff3==null?void 0x0:_0x43cff3[_0x53eaae(0x186)]();}['getDimensionInfo'](){const _0x2c782f=_0x26df03,_0x52cd3f={};return[[l['PivotTableFiledAreaEnum'][_0x2c782f(0x11b)],_0x2c782f(0xa7)],[l[_0x2c782f(0x170)][_0x2c782f(0x156)],'column'],[l[_0x2c782f(0x170)][_0x2c782f(0x15c)],_0x2c782f(0x10d)],[l['PivotTableFiledAreaEnum'][_0x2c782f(0x18a)],_0x2c782f(0xbc)]][_0x2c782f(0x106)](_0x104afa=>{const _0x405678=_0x2c782f,[_0x309c89,_0x1ac11d]=_0x104afa;this[_0x405678(0xa3)][_0x405678(0xed)](_0x309c89,_0x3aeda8=>{const _0x4541b1=_0x405678;_0x52cd3f[_0x1ac11d]||(_0x52cd3f[_0x1ac11d]=[]),_0x52cd3f[_0x1ac11d][_0x4541b1(0xbb)](_0x3aeda8[_0x4541b1(0xa0)]());});}),Object[_0x2c782f(0x176)](_0x52cd3f)[_0x2c782f(0x167)]>0x0?_0x52cd3f:void 0x0;}['getPivotSourceData'](){return this['_sourceData'];}[_0x26df03(0x17a)](_0xced9dd){const _0x4ec0aa=_0x26df03;this[_0x4ec0aa(0xa3)][_0x4ec0aa(0x17a)](_0xced9dd);}[_0x26df03(0x161)](){const _0x2edecf=_0x26df03;this[_0x2edecf(0xa3)][_0x2edecf(0x145)]();}}class ve extends l['DataFieldManager']{[_0x26df03(0x115)](_0x348fd1){const _0x48f017=_0x26df03;if(Array['isArray'](_0x348fd1)&&_0x348fd1[_0x48f017(0x167)]>0x0){const _0x3baa79=[],_0x13fc86=_0x348fd1[0x0],_0x2d9099={},_0x21d62a=_0x348fd1[0x1];for(let _0x2f45c9=0x0;_0x2f45c9<_0x21d62a['length'];_0x2f45c9++){const _0x342f61=_0x21d62a[_0x2f45c9];if(typeof _0x342f61==_0x48f017(0x102)&&_0x342f61 instanceof Date)_0x2d9099[_0x2f45c9]=Z;else{if(typeof _0x342f61==_0x48f017(0x160)){const _0x28f52a=new Date(_0x342f61);Number[_0x48f017(0xb6)](_0x28f52a[_0x48f017(0xdc)]())||(_0x2d9099[_0x2f45c9]=Z);}}}for(let _0x5e58bc=0x1;_0x5e58bc<_0x348fd1[_0x48f017(0x167)];_0x5e58bc++){const _0x524218=_0x348fd1[_0x5e58bc],_0x2dd8dd=[];for(let _0x596719=0x0;_0x596719<_0x524218['length'];_0x596719++)if(_0x2d9099[_0x596719]){const _0xaedf29=_0x524218[_0x596719],_0x4383d1=typeof _0xaedf29=='object'&&_0xaedf29 instanceof Date?_0xaedf29:new Date(_0xaedf29),_0x54289d={'v':de(_0x4383d1[_0x48f017(0xdc)]()),'f':_0x2d9099[_0x596719]};_0x2dd8dd[_0x48f017(0xbb)](_0x54289d);}else _0x2dd8dd['push'](_0x524218[_0x596719]);_0x3baa79[_0x48f017(0xbb)](_0x2dd8dd);}return{'header':_0x13fc86,'data':_0x3baa79};}else throw new Error('[DataFieldManager]:\x20Data\x20is\x20not\x20a\x20valid\x20array');}}class ce extends A[_0x26df03(0x165)]{['_initialize'](_0x498ce7){const _0x20191c=_0x26df03,_0x21f73d=_0x498ce7[_0x20191c(0xf8)](m['ICommandService']);this['registerEventHandler'](this[_0x20191c(0x18b)][_0x20191c(0xab)],()=>_0x21f73d[_0x20191c(0x174)](_0x14ca6e=>{const _0x8a7d6d=_0x20191c;switch(_0x14ca6e['id']){case r[_0x8a7d6d(0xfa)]['id']:{const _0x16a2ec=_0x14ca6e[_0x8a7d6d(0x13e)];this[_0x8a7d6d(0x114)](_0x16a2ec);break;}}})),this['registerEventHandler'](this['Event'][_0x20191c(0x108)],()=>_0x21f73d['beforeCommandExecuted'](_0x485aab=>{const _0x5f0eb7=_0x20191c;switch(_0x485aab['id']){case r[_0x5f0eb7(0x15a)]['id']:case r[_0x5f0eb7(0xe3)]['id']:{const _0x94beab=_0x485aab[_0x5f0eb7(0x13e)];this[_0x5f0eb7(0xd2)](_0x94beab);break;}}})),this['registerEventHandler'](this[_0x20191c(0x18b)][_0x20191c(0x15f)],()=>_0x21f73d[_0x20191c(0x152)](_0x17e5a8=>{const _0x3c8589=_0x20191c;if(_0x17e5a8['id']===r[_0x3c8589(0x15a)]['id']||_0x17e5a8['id']===r['AddPivotTableCommand']['id']){const _0x3eb420=_0x17e5a8[_0x3c8589(0x13e)];this[_0x3c8589(0x159)](_0x3eb420);}})),this[_0x20191c(0xea)](this[_0x20191c(0x18b)][_0x20191c(0x10b)],()=>_0x21f73d[_0x20191c(0x152)](_0x3888c5=>{const _0x59fce0=_0x20191c;if(_0x3888c5['id']===r[_0x59fce0(0xfa)]['id']){const _0x4ca606=_0x3888c5[_0x59fce0(0x13e)];this[_0x59fce0(0x131)](_0x4ca606);}})),this['registerEventHandler'](this[_0x20191c(0x18b)]['PivotTableRemoved'],()=>_0x21f73d[_0x20191c(0x152)](_0xf5ab40=>{const _0x2ca5e9=_0x20191c;if(_0xf5ab40['id']===r[_0x2ca5e9(0x9d)]['id']){const _0x49f65c=_0xf5ab40[_0x2ca5e9(0x13e)];this[_0x2ca5e9(0xd4)](_0x49f65c);}})),this[_0x20191c(0xea)](this[_0x20191c(0x18b)][_0x20191c(0x188)],()=>_0x21f73d[_0x20191c(0x152)](_0x52b7f7=>{const _0x16a792=_0x20191c;if(_0x52b7f7['id']===r['AddPivotFieldCommand']['id']){const _0x30f185=_0x52b7f7[_0x16a792(0x13e)];this[_0x16a792(0x184)](_0x30f185);}})),this[_0x20191c(0xea)](this[_0x20191c(0x18b)][_0x20191c(0xc2)],()=>_0x21f73d[_0x20191c(0x152)](_0x4c81ec=>{const _0x46b959=_0x20191c;if(_0x4c81ec['id']===r[_0x46b959(0x9c)]['id']){const _0x48cea9=_0x4c81ec['params'];this[_0x46b959(0xb9)](_0x48cea9);}})),this[_0x20191c(0xea)](this[_0x20191c(0x18b)][_0x20191c(0x181)],()=>_0x21f73d[_0x20191c(0x152)](_0x302bb6=>{const _0x549edf=_0x20191c;if(_0x302bb6['id']===r[_0x549edf(0xb3)]['id']){const _0x2d8c4e=_0x302bb6[_0x549edf(0x13e)];this['_firePivotTableFieldMovedEvent'](_0x2d8c4e);}})),this[_0x20191c(0xea)](this[_0x20191c(0x18b)][_0x20191c(0xee)],()=>_0x21f73d[_0x20191c(0x152)](_0x4177cf=>{const _0x15b30e=_0x20191c;if(_0x4177cf['id']===r[_0x15b30e(0x101)]['id']){const _0x9ff58b=_0x4177cf[_0x15b30e(0x13e)];this[_0x15b30e(0xfb)](_0x9ff58b);}})),this[_0x20191c(0xea)](this[_0x20191c(0x18b)][_0x20191c(0x109)],()=>_0x21f73d[_0x20191c(0x152)](_0x595851=>{const _0x56a9da=_0x20191c;if(_0x595851['id']===r[_0x56a9da(0x16d)]['id']){const _0x4d5ce7=_0x595851[_0x56a9da(0x13e)];this[_0x56a9da(0x12d)](_0x4d5ce7);}})),this[_0x20191c(0xea)](this[_0x20191c(0x18b)][_0x20191c(0x141)],()=>_0x21f73d['onCommandExecuted'](_0x4b6658=>{const _0xd1689=_0x20191c;if(_0x4b6658['id']===r[_0xd1689(0x119)]['id']){const _0x5352b7=_0x4b6658[_0xd1689(0x13e)];this[_0xd1689(0x12c)](_0x5352b7);}})),this[_0x20191c(0xea)](this[_0x20191c(0x18b)][_0x20191c(0x11d)],()=>_0x21f73d[_0x20191c(0x152)](_0x37d10b=>{const _0x4fe893=_0x20191c;if(_0x37d10b['id']===r[_0x4fe893(0x139)]['id']){const _0x228011=_0x37d10b[_0x4fe893(0x13e)];this[_0x4fe893(0x107)](_0x228011);}})),this[_0x20191c(0xea)](this[_0x20191c(0x18b)][_0x20191c(0xef)],()=>_0x21f73d[_0x20191c(0x152)](_0x3d503a=>{const _0x954e75=_0x20191c;if(_0x3d503a['id']===r[_0x954e75(0x17d)]['id']){const _0x2d0057=_0x3d503a['params'];this['_firePivotTableValuePositionChangedEvent'](_0x2d0057);}}));const _0x107bb0=_0x498ce7[_0x20191c(0xf8)](m[_0x20191c(0xcf)]);this[_0x20191c(0x99)](_0x107bb0[_0x20191c(0x173)][_0x20191c(0xbf)](_0x5d433b=>{const _0x12fbd8=_0x20191c;if(_0x5d433b===m[_0x12fbd8(0xcb)][_0x12fbd8(0x166)]){const _0x5a6040=_0x498ce7['get'](r[_0x12fbd8(0x137)]);this[_0x12fbd8(0xea)](this[_0x12fbd8(0x18b)]['PivotTableRendered'],()=>_0x5a6040['viewUpdate$']['pipe'](ie[_0x12fbd8(0x111)](0x32))[_0x12fbd8(0xbf)](_0x1e5ef9=>{const _0x32a511=_0x12fbd8;this[_0x32a511(0x154)](_0x1e5ef9);}));}}));}[_0x26df03(0x184)](_0x35ad0a){const _0x42c318=_0x26df03;if(_0x35ad0a){const {unitId:_0x1d9821,subUnitId:_0x3b4c73,pivotTableId:_0x3a9e20,dataFieldId:_0x2f2e2a,fieldArea:_0x54c9ea,index:_0x3a9987}=_0x35ad0a;this[_0x42c318(0x175)](this[_0x42c318(0x18b)][_0x42c318(0x188)],{'unitId':_0x1d9821,'subUnitId':_0x3b4c73,'pivotTableId':_0x3a9e20,'dataFieldId':_0x2f2e2a,'fieldArea':_0x54c9ea,'index':_0x3a9987});}}[_0x26df03(0xb9)](_0x28b6e5){const _0xe35387=_0x26df03;if(_0x28b6e5){const {unitId:_0xb4536a,subUnitId:_0x4afacb,pivotTableId:_0x534df0,fieldIds:_0x42923d}=_0x28b6e5;this[_0xe35387(0x175)](this[_0xe35387(0x18b)][_0xe35387(0xc2)],{'unitId':_0xb4536a,'subUnitId':_0x4afacb,'pivotTableId':_0x534df0,'fieldIds':_0x42923d[_0xe35387(0x121)]()});}}[_0x26df03(0x187)](_0x164c08){if(_0x164c08){const {unitId:_0xa8d52a,subUnitId:_0x4993a1,pivotTableId:_0x41f353,fieldId:_0x8ce1b7,area:_0x4fff98,index:_0x19b8fd}=_0x164c08;this['fireEvent'](this['Event']['PivotTableFieldMoved'],{'unitId':_0xa8d52a,'subUnitId':_0x4993a1,'pivotTableId':_0x41f353,'fieldId':_0x8ce1b7,'area':_0x4fff98,'index':_0x19b8fd});}}[_0x26df03(0xfb)](_0x1fb546){const _0x27e48d=_0x26df03;if(_0x1fb546){const {unitId:_0x4c4ae0,subUnitId:_0x184e43,row:_0x3905d8,col:_0x597b57,collapse:_0x28ddb2}=_0x1fb546;this[_0x27e48d(0x175)](this['Event'][_0x27e48d(0xee)],{'unitId':_0x4c4ae0,'subUnitId':_0x184e43,'row':_0x3905d8,'col':_0x597b57,'collapse':_0x28ddb2});}}['_firePivotTableFieldFilterChangedEvent'](_0x594473){const _0x203c20=_0x26df03;if(_0x594473){const {unitId:_0x4dbdaa,subUnitId:_0x2155a5,pivotTableId:_0x2cf067,tableFieldId:_0x54eb7c,items:_0x4ed804,isAll:_0x26f6ff}=_0x594473;this[_0x203c20(0x175)](this[_0x203c20(0x18b)][_0x203c20(0x109)],{'unitId':_0x4dbdaa,'subUnitId':_0x2155a5,'pivotTableId':_0x2cf067,'tableFieldId':_0x54eb7c,'items':_0x4ed804['concat'](),'isAll':_0x26f6ff});}}['_firePivotTableFieldSortChangedEvent'](_0x2e42df){const _0x2cf8d0=_0x26df03;if(_0x2e42df){const {unitId:_0x170342,subUnitId:_0x31f475,pivotTableId:_0x2c9574,tableFieldId:_0x2ca8e7,info:_0x58e9f6}=_0x2e42df;this['fireEvent'](this['Event'][_0x2cf8d0(0x141)],{'unitId':_0x170342,'subUnitId':_0x31f475,'pivotTableId':_0x2c9574,'tableFieldId':_0x2ca8e7,'info':{..._0x58e9f6}});}}['_firePivotTableFieldSettingChangedEvent'](_0x57e722){const _0x346255=_0x26df03;if(_0x57e722){const {unitId:_0x5e4cdc,subUnitId:_0x4a2bb0,tableFieldId:_0x18522a,pivotTableId:_0x5dc347,displayName:_0x2faf14,format:_0x1c1fa1,subtotalType:_0x3f02c1,tableFieldInfo:_0x18e340,dataFieldInfo:_0x27da23}=_0x57e722;this[_0x346255(0x175)](this[_0x346255(0x18b)][_0x346255(0x11d)],{'unitId':_0x5e4cdc,'subUnitId':_0x4a2bb0,'tableFieldId':_0x18522a,'pivotTableId':_0x5dc347,'displayName':_0x2faf14,'format':_0x1c1fa1,'subtotalType':_0x3f02c1,'tableFieldInfo':_0x18e340,'dataFieldInfo':_0x27da23});}}[_0x26df03(0x129)](_0x22d213){const _0x1590b4=_0x26df03;if(_0x22d213){const {pivotTableId:_0x108d35,position:_0x2f9e65,index:_0x3f6500}=_0x22d213;this[_0x1590b4(0x175)](this['Event'][_0x1590b4(0xef)],{'pivotTableId':_0x108d35,'position':_0x2f9e65,'index':_0x3f6500});}}[_0x26df03(0x159)](_0x461c8b){const _0x3d0a9b=_0x26df03;if(_0x461c8b){const {positionType:_0x54ee7a,pivotTableId:_0xfa9cd3,pivotTableConfig:_0xfc55d}=_0x461c8b,{targetCellInfo:_0x48528a,sourceRangeInfo:_0x31b1d0}=_0xfc55d,{unitId:_0x50f570}=_0x48528a;this[_0x3d0a9b(0x175)](this[_0x3d0a9b(0x18b)]['PivotTableAdded'],{'unitId':_0x50f570,'positionType':_0x54ee7a,'pivotTableId':_0xfa9cd3,'sourceRangeInfo':{'startRow':_0x31b1d0[_0x3d0a9b(0x189)]['startRow'],'endRow':_0x31b1d0[_0x3d0a9b(0x189)][_0x3d0a9b(0x135)],'startColumn':_0x31b1d0[_0x3d0a9b(0x189)][_0x3d0a9b(0xe2)],'endColumn':_0x31b1d0['range'][_0x3d0a9b(0xdf)],'unitId':_0x31b1d0[_0x3d0a9b(0x10a)],'subUnitId':_0x31b1d0[_0x3d0a9b(0xe5)],'sheetName':_0x31b1d0['sheetName']},'targetCellInfo':{'row':_0x48528a[_0x3d0a9b(0xa7)],'column':_0x48528a[_0x3d0a9b(0x113)],'sheetName':_0x48528a['sheetName'],'unitId':_0x48528a[_0x3d0a9b(0x10a)],'subUnitId':_0x48528a['subUnitId']}});}}[_0x26df03(0xd2)](_0x318014){const _0x4c7a27=_0x26df03;if(_0x318014){const {positionType:_0x49e428,pivotTableId:_0x140e59,pivotTableConfig:_0x9587f2}=_0x318014,{targetCellInfo:_0x5af9fb,sourceRangeInfo:_0x50d0e0}=_0x9587f2,{unitId:_0x4727c6}=_0x5af9fb,_0x356ea5={'unitId':_0x4727c6,'positionType':_0x49e428,'pivotTableId':_0x140e59,'sourceRangeInfo':{'startRow':_0x50d0e0['range'][_0x4c7a27(0x120)],'endRow':_0x50d0e0[_0x4c7a27(0x189)][_0x4c7a27(0x135)],'startColumn':_0x50d0e0[_0x4c7a27(0x189)]['startColumn'],'endColumn':_0x50d0e0[_0x4c7a27(0x189)][_0x4c7a27(0xdf)],'unitId':_0x50d0e0[_0x4c7a27(0x10a)],'subUnitId':_0x50d0e0[_0x4c7a27(0xe5)],'sheetName':_0x50d0e0[_0x4c7a27(0x144)]},'targetCellInfo':{'row':_0x5af9fb[_0x4c7a27(0xa7)],'column':_0x5af9fb['col'],'sheetName':_0x5af9fb[_0x4c7a27(0x144)],'unitId':_0x5af9fb[_0x4c7a27(0x10a)],'subUnitId':_0x5af9fb[_0x4c7a27(0xe5)]},'cancel':!0x1};if(this[_0x4c7a27(0x175)](this[_0x4c7a27(0x18b)][_0x4c7a27(0xab)],_0x356ea5),_0x356ea5[_0x4c7a27(0x180)])throw new Error(_0x4c7a27(0x126));}}['_firePivotTableRemovedEvent'](_0x25f9b4){const _0x2325e1=_0x26df03;if(_0x25f9b4){const {unitId:_0x85a4b3,pivotTableId:_0xc542f8}=_0x25f9b4;this[_0x2325e1(0x175)](this[_0x2325e1(0x18b)][_0x2325e1(0xaf)],{'unitId':_0x85a4b3,'pivotTableId':_0xc542f8});}}[_0x26df03(0x114)](_0x209bc2){const _0x3b30bc=_0x26df03;if(_0x209bc2){const {originTargetInfo:_0x3c8db5,pivotTableId:_0x1ab7ec,targetCellInfo:_0x318b92}=_0x209bc2,{unitId:_0x25e1a8}=_0x3c8db5,_0x2cb1fd=this['_injector'][_0x3b30bc(0xf8)](r[_0x3b30bc(0x136)])['getPivotTableConfig'](_0x3c8db5[_0x3b30bc(0x10a)],_0x3c8db5['subUnitId'],_0x1ab7ec);if(!_0x2cb1fd)return;const _0x29bd04={'unitId':_0x25e1a8,'pivotTableId':_0x1ab7ec,'originTargetInfo':{'row':_0x2cb1fd[_0x3b30bc(0x104)][_0x3b30bc(0xa7)],'column':_0x2cb1fd[_0x3b30bc(0x104)]['col'],'unitId':_0x2cb1fd['targetCellInfo']['unitId'],'subUnitId':_0x2cb1fd[_0x3b30bc(0x104)][_0x3b30bc(0xe5)]},'targetCellInfo':{'row':_0x318b92[_0x3b30bc(0xa7)],'column':_0x318b92[_0x3b30bc(0x113)],'unitId':_0x318b92[_0x3b30bc(0x10a)],'subUnitId':_0x318b92[_0x3b30bc(0xe5)]},'cancel':!0x1};if(this[_0x3b30bc(0x175)](this['Event'][_0x3b30bc(0x108)],_0x29bd04),_0x29bd04[_0x3b30bc(0x180)])throw new Error(_0x3b30bc(0xa6));}}[_0x26df03(0x131)](_0x1e14f6){const _0x17a5e1=_0x26df03;if(_0x1e14f6){const {originTargetInfo:_0x696f02,pivotTableId:_0x296a67,targetCellInfo:_0x3783af}=_0x1e14f6,{unitId:_0x4f0bb7}=_0x696f02,_0x5df545=this[_0x17a5e1(0xf7)][_0x17a5e1(0xf8)](r['SheetsPivotTableConfigModel'])[_0x17a5e1(0x12b)](_0x696f02[_0x17a5e1(0x10a)],_0x696f02[_0x17a5e1(0xe5)],_0x296a67);if(!_0x5df545)return;this[_0x17a5e1(0x175)](this[_0x17a5e1(0x18b)][_0x17a5e1(0x10b)],{'unitId':_0x4f0bb7,'pivotTableId':_0x296a67,'originTargetInfo':{'row':_0x5df545[_0x17a5e1(0x104)][_0x17a5e1(0xa7)],'column':_0x5df545[_0x17a5e1(0x104)][_0x17a5e1(0x113)],'unitId':_0x5df545[_0x17a5e1(0x104)][_0x17a5e1(0x10a)],'subUnitId':_0x5df545['targetCellInfo'][_0x17a5e1(0xe5)]},'targetCellInfo':{'row':_0x3783af['row'],'column':_0x3783af['col'],'unitId':_0x3783af['unitId'],'subUnitId':_0x3783af['subUnitId']}});}}[_0x26df03(0x154)](_0x3ce47f){const _0x267084=_0x26df03;if(_0x3ce47f){const {unitId:_0x2dca72,subUnitId:_0x4ab457,pivotTableId:_0x49e8e8,type:_0x82b217,rangesCache:_0x43dcca,isEmpty:_0x176d63}=_0x3ce47f;this['fireEvent'](this[_0x267084(0x18b)][_0x267084(0x140)],{'unitId':_0x2dca72,'subUnitId':_0x4ab457,'pivotTableId':_0x49e8e8,'changeType':_0x82b217,'isEmpty':!!_0x176d63,'rangeInfo':_0x43dcca});}}['generatePivotTable'](_0x3b8017,_0x1d4dbb){const _0x42f09c=_0x26df03,_0x305874=(_0x1d4dbb?new _0x1d4dbb():new ve())[_0x42f09c(0x150)](_0x42f09c(0x153),_0x3b8017),_0x31ac0e=_0x3b8017[0x0];_0x305874[_0x42f09c(0xf3)]()[_0x42f09c(0x106)]((_0x51a597,_0x152efd)=>{_0x305874['setDisplayName'](_0x51a597,_0x31ac0e[_0x152efd]);});const _0x2e868a=l[_0x42f09c(0x10f)](0x8),_0x5c7cf4=new l[(_0x42f09c(0x143))](_0x305874,void 0x0,_0x2e868a);return new re(this['_injector'],_0x5c7cf4,_0x3b8017,_0x2e868a);}}A[_0x26df03(0x165)][_0x26df03(0xc4)](ce);