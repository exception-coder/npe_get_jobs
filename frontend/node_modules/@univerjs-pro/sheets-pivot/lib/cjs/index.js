'use strict';const _0x429c2e=_0x3f2b;(function(_0x4d2dc9,_0x5b693b){const _0xc41518=_0x3f2b,_0x4b0b9f=_0x4d2dc9();while(!![]){try{const _0x413ca2=-parseInt(_0xc41518(0x179))/0x1*(-parseInt(_0xc41518(0x1ac))/0x2)+parseInt(_0xc41518(0x30e))/0x3+-parseInt(_0xc41518(0x273))/0x4*(-parseInt(_0xc41518(0x14f))/0x5)+-parseInt(_0xc41518(0x3ac))/0x6+parseInt(_0xc41518(0x2d9))/0x7*(parseInt(_0xc41518(0x2f6))/0x8)+parseInt(_0xc41518(0x402))/0x9+-parseInt(_0xc41518(0x163))/0xa;if(_0x413ca2===_0x5b693b)break;else _0x4b0b9f['push'](_0x4b0b9f['shift']());}catch(_0x311892){_0x4b0b9f['push'](_0x4b0b9f['shift']());}}}(_0x55e4,0x633b6));var Fo=Object[_0x429c2e(0x1d0)],wo=(_0x296b42,_0x458c2a,_0x5c26c6)=>_0x458c2a in _0x296b42?Fo(_0x296b42,_0x458c2a,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0x5c26c6}):_0x296b42[_0x458c2a]=_0x5c26c6,x=(_0x1263fe,_0x21595a,_0x412725)=>wo(_0x1263fe,typeof _0x21595a!=_0x429c2e(0x134)?_0x21595a+'':_0x21595a,_0x412725);Object[_0x429c2e(0x1d0)](exports,Symbol[_0x429c2e(0x1cb)],{'value':'Module'});const m=require('@univerjs-pro/engine-pivot'),f=require('@univerjs/core'),fe=require('@univerjs/engine-formula'),V=require('@univerjs/sheets'),ve=require('rxjs'),ue=require('@univerjs-pro/license'),Ot=require('@univerjs/sheets-filter'),_o=require('@univerjs/rpc'),Ue=require('@univerjs/engine-render'),Gt=Number['parseInt'](0x690efc22),Ro=0x10,It=0x1,Ct=_0x429c2e(0x1be),we=0x1,Do=_0x429c2e(0x3cf),Eo=_0x429c2e(0x338),Ze=_0x429c2e(0x345),No=_0x429c2e(0x1c4),Uo=_0x429c2e(0x1c4),Vo=_0x429c2e(0x2dd),xo=_0x429c2e(0x19e),Oo=_0x429c2e(0x354),Ao=_0x429c2e(0x378),ko=_0x429c2e(0x19e),jo=_0x429c2e(0x354),Lo=_0x429c2e(0x252),Bo=0xe,Go=0x6;var Mt=(_0x36f9c4=>(_0x36f9c4['Existing']=_0x429c2e(0x412),_0x36f9c4[_0x429c2e(0x2b2)]=_0x429c2e(0x3df),_0x36f9c4))(Mt||{});const Wt={'sheets-pivot':{'blankValue':'','otherValue':'','columnName':'','subTotalText':'','grandTotalText':'','valueText':'','averageName':'','countName':'','countNumsName':'','maxName':'','minName':'','productName':'','stdDevName':'','stdDevpName':'','sumName':'','varName':'','varpName':'','value':'','blank':'','other':'','subTotal':'','grandTotal':'','emptyPivot':{'filter':'','row':'','column':'','values':''},'dateGroup':{'year':'','month':'','day':'','hour':'','minute':'','quarter':'','monthDate':'','yearQuarter':'','yearMonth':'','yearMonthDate':''},'cellDateGroupDisplay':{'minute':'','hour':'','hourMinute':'','date':'','month':'','monthDate':'','quarter':'','year':'','yearMonth':'','yearMonthDate':'','yearQuarter':''}}},Wo=0x1e,Te={'b':{'s':0x1,'cl':{'rgb':Ze}},'l':{'s':0x1,'cl':{'rgb':Ze}},'r':{'s':0x1,'cl':{'rgb':Ze}},'t':{'s':0x1,'cl':{'rgb':Ze}}},Y={'bg':{'rgb':Do},'ht':0x2,'vt':0x2,'tb':0x1},R={'bg':{'rgb':Eo},'ht':0x2,'vt':0x2,'tb':0x1},oe={'rowStyle':{'bg':{'rgb':Lo},'bd':Te,'bl':0x1,'vt':0x2},'colStyle':{'bg':{'rgb':ko},'bd':null,'cl':{'rgb':jo},'bl':0x1,'vt':0x2},'subTotalStyle':{'bd':Te,'bg':{'rgb':Ao},'vt':0x2},'cornerStyle':{'bd':Te,'bg':{'rgb':Vo},'bl':0x1,'vt':0x2},'pageStyle':{'bd':Te,'bg':{'rgb':No},'vt':0x2},'leafStyle':{'bd':Te,'bg':{'rgb':Uo},'vt':0x2},'grandTotal':{'bd':null,'bg':{'rgb':xo},'cl':{'rgb':Oo},'bl':0x1,'vt':0x2},'dataStyle':{'bd':Te,'vt':0x2}};function $o(_0x303c39,_0x2b641a,_0x12ee0e){const _0x3307ba=_0x429c2e,_0x5ed1be=_0x303c39[_0x3307ba(0x236)](f[_0x3307ba(0x14a)]),_0x5b8ebb=_0x12ee0e[_0x3307ba(0x333)]('_');switch(_0x2b641a){case m[_0x3307ba(0x2ff)][_0x3307ba(0x1e0)]:return _0x5ed1be['t']('sheets-pivot.cellDateGroupDisplay.year',..._0x5b8ebb);case m[_0x3307ba(0x2ff)][_0x3307ba(0x40e)]:return _0x5ed1be['t']('sheets-pivot.cellDateGroupDisplay.minute',..._0x5b8ebb);case m['PivotDateGroupFieldDateTypeEnum'][_0x3307ba(0x231)]:return _0x5ed1be['t'](_0x3307ba(0x173),..._0x5b8ebb);case m[_0x3307ba(0x2ff)][_0x3307ba(0x304)]:return _0x5ed1be['t']('sheets-pivot.cellDateGroupDisplay.hourMinute',..._0x5b8ebb);case m[_0x3307ba(0x2ff)][_0x3307ba(0x1b6)]:return _0x5ed1be['t'](_0x3307ba(0x1a0),..._0x5b8ebb);case m[_0x3307ba(0x2ff)][_0x3307ba(0x3e9)]:return _0x5ed1be['t'](_0x3307ba(0x19b),..._0x5b8ebb);case m[_0x3307ba(0x2ff)][_0x3307ba(0x241)]:return _0x5ed1be['t']('sheets-pivot.cellDateGroupDisplay.quarter',..._0x5b8ebb);case m['PivotDateGroupFieldDateTypeEnum'][_0x3307ba(0x35b)]:return _0x5ed1be['t'](_0x3307ba(0x411),..._0x5b8ebb);case m[_0x3307ba(0x2ff)][_0x3307ba(0x2f2)]:return _0x5ed1be['t'](_0x3307ba(0x30f),..._0x5b8ebb);case m[_0x3307ba(0x2ff)][_0x3307ba(0x14c)]:return _0x5ed1be['t'](_0x3307ba(0x195),..._0x5b8ebb);}return'';}const Ve=(_0x34b7af,_0x51479b,_0x528e87,_0x48d708)=>{const _0x2c4607=_0x429c2e;let _0x4831cf;const _0x3e0aad=_0x34b7af[_0x2c4607(0x236)](f[_0x2c4607(0x193)])[_0x2c4607(0x117)](f[_0x2c4607(0x300)][_0x2c4607(0x2fa)]);if(!_0x3e0aad)return null;const _0x7d8ef5=_0x3e0aad[_0x2c4607(0x270)]();let _0x17b7f3;if(_0x528e87&&(_0x17b7f3=_0x7d8ef5[_0x2c4607(0x196)](_0x528e87)),_0x51479b!=null&&_0x51479b['v']||(_0x51479b==null?void 0x0:_0x51479b['v'])===0x0){_0x4831cf||(_0x4831cf={});const _0x3cf84e=$t(_0x51479b['v']);typeof _0x3cf84e==_0x2c4607(0x3d2)?_0x4831cf['t']=f[_0x2c4607(0x3b6)]['NUMBER']:typeof _0x3cf84e==_0x2c4607(0x3dc)&&(_0x4831cf['t']=f['CellValueType']['STRING']),_0x4831cf['v']=_0x3cf84e;}if((_0x51479b!=null&&_0x51479b['i']||(_0x51479b==null?void 0x0:_0x51479b['i'])===0x0)&&(_0x4831cf||(_0x4831cf={}),_0x4831cf['fi']=_0x51479b['i']),_0x51479b!=null&&_0x51479b['s']&&(_0x4831cf||(_0x4831cf={}),_0x4831cf['pbt']=_0x51479b['s']),_0x528e87&&(_0x4831cf||(_0x4831cf={}),_0x4831cf['s']=_0x17b7f3),_0x48d708&&_0x4831cf!=null&&_0x4831cf['v']&&_0x4831cf[_0x2c4607(0x381)]!==m[_0x2c4607(0x3c9)]['GrandTotal']&&_0x4831cf[_0x2c4607(0x381)]!==m[_0x2c4607(0x3c9)][_0x2c4607(0x23a)]){const _0x20dd4c=String(_0x4831cf['v']),{dateType:_0x5eb2c1}=_0x48d708;_0x4831cf['v']=$o(_0x34b7af,_0x5eb2c1,_0x20dd4c),_0x4831cf['t']=f[_0x2c4607(0x3b6)][_0x2c4607(0x3aa)];}return _0x4831cf;},Jo=(_0x977847,_0x2f86ec,_0x5b1900,_0x36cce3)=>{const _0xd1dbcc=_0x429c2e;var _0x2d593c,_0x410ea1,_0x2f4a15,_0xac8e6,_0x1f4358,_0x44cd35,_0x5d8293,_0x31966e,_0x1047d9,_0x58d2ff,_0x3b42b2,_0x177206,_0x161179,_0x22d037;const _0x52736c=_0x5b1900[_0xd1dbcc(0x3d5)],{cornerView:_0x275a47,rowView:_0x24c32f,colView:_0x4a3292,dataView:_0x517f96,pageView:_0x17880b,formatMap:_0x299502,groupInfo:_0x142f35}=_0x2f86ec,{row:_0x5542f8,col:_0x66f49c}=_0x52736c,_0x584dc7=new f[(_0xd1dbcc(0x2d2))](),_0x4b0f64={},_0x2ba149={},_0xec2eb4={},_0x3e2ff4={},_0x4d18c5={};let _0x54d5db=_0x5542f8,_0x2ac015=_0x66f49c;Object[_0xd1dbcc(0x116)](_0x17880b['data'])[_0xd1dbcc(0x174)](_0x14240b=>{const _0x3365c6=_0xd1dbcc;Object[_0x3365c6(0x116)](_0x17880b[_0x3365c6(0x127)][Number(_0x14240b)])[_0x3365c6(0x174)](_0x56736c=>{const _0x51289d=_0x3365c6,_0x1398eb={..._0x17880b['data'][Number(_0x14240b)][Number(_0x56736c)]};_0x584dc7[_0x51289d(0x196)](Number(_0x14240b)+_0x54d5db,Number(_0x56736c)+_0x2ac015,Ve(_0x977847,_0x1398eb,oe[_0x51289d(0x2b4)]));});});const _0x46bd37=Object[_0xd1dbcc(0x116)](_0x17880b[_0xd1dbcc(0x127)])[_0xd1dbcc(0x2ca)];_0x54d5db+=_0x46bd37+(_0x46bd37?we:0x0);const _0x58842e=_0x275a47[_0xd1dbcc(0x1a5)](),_0x42eb98=_0x275a47[_0xd1dbcc(0x2c1)]();for(let _0xa0cd2e=0x0;_0xa0cd2e<_0x58842e;_0xa0cd2e++)for(let _0x25dfd3=0x0;_0x25dfd3<_0x42eb98;_0x25dfd3++){const _0x55027c={...(_0x410ea1=(_0x2d593c=_0x275a47['data'])==null?void 0x0:_0x2d593c[_0xa0cd2e])==null?void 0x0:_0x410ea1[_0x25dfd3]};_0x55027c&&((_0x2f4a15=_0x24c32f[_0xd1dbcc(0x208)][_0x25dfd3])!=null&&_0x2f4a15[_0xd1dbcc(0x395)])&&_0x25dfd3===_0x42eb98-0x1&&_0xa0cd2e===_0x58842e-0x1&&(_0x55027c['v']=''+_0x36cce3[_0xd1dbcc(0x2c5)]),_0x584dc7['setValue'](_0xa0cd2e+_0x54d5db,_0x25dfd3+_0x2ac015,Ve(_0x977847,_0x55027c,oe['cornerStyle']));}for(let _0x4113be=0x0;_0x4113be<_0x275a47[_0xd1dbcc(0x403)][_0xd1dbcc(0x2ca)];_0x4113be++)_0x275a47[_0xd1dbcc(0x403)][_0x4113be]&&(_0xec2eb4[''+(_0x4113be+_0x2ac015)]=_0x275a47[_0xd1dbcc(0x403)][_0x4113be]);_0x2ac015+=_0x42eb98;const _0x2378aa=_0x4a3292[_0xd1dbcc(0x208)],_0x1bcece=_0x4a3292[_0xd1dbcc(0x1d6)]()>=0x0?_0x4a3292['getLastRow']()+0x1:0x0,_0x329345=_0x4a3292[_0xd1dbcc(0x1fb)]()>=0x0?_0x4a3292[_0xd1dbcc(0x1fb)]()+0x1:0x0;for(let _0x2190c3=0x0;_0x2190c3<_0x329345;_0x2190c3++){for(let _0x209e67=0x0;_0x209e67<_0x1bcece;_0x209e67++){const _0x4787b1={...(_0x1f4358=(_0xac8e6=_0x4a3292[_0xd1dbcc(0x127)])==null?void 0x0:_0xac8e6[_0x209e67])==null?void 0x0:_0x1f4358[_0x2190c3]},_0x367a84=(_0x44cd35=_0x2378aa[_0x209e67])==null?void 0x0:_0x44cd35['tableFieldId'],_0xeef444=_0x299502[_0x367a84],_0x4a2fba=_0x142f35[_0x367a84];_0x4787b1&&(_0x4787b1['v']=Me(_0x4787b1,_0x209e67===0x0&&((_0x5d8293=_0x4a3292[_0xd1dbcc(0x2c3)](_0x2190c3+0x1))==null?void 0x0:_0x5d8293[_0xd1dbcc(0x395)]),_0xeef444,_0x36cce3));let _0x185358;_0xeef444?_0x185358={...oe[_0xd1dbcc(0x2e7)],'n':{'pattern':_0xeef444}}:_0x185358={...oe[_0xd1dbcc(0x2e7)]},_0x584dc7[_0xd1dbcc(0x196)](_0x209e67+_0x54d5db,_0x2190c3+_0x2ac015,Ve(_0x977847,_0x4787b1,_0x185358,_0x4a2fba));}_0x4a3292[_0xd1dbcc(0x403)][_0x2190c3]&&(_0x2ba149[''+(_0x2190c3+_0x2ac015)]=_0x4a3292[_0xd1dbcc(0x403)][_0x2190c3]),_0x4a3292[_0xd1dbcc(0x208)][_0x2190c3+0x1]&&(_0x4d18c5[''+(_0x2190c3+_0x54d5db+0x1)]=_0x4a3292['headerMap'][_0x2190c3+0x1]);}_0x54d5db+=_0x58842e;const _0x1abf92=_0x24c32f[_0xd1dbcc(0x208)],_0x495653=_0x24c32f['getLastRow']()>=0x0?_0x24c32f[_0xd1dbcc(0x1d6)]()+0x1:0x0,_0x602f9f=_0x24c32f[_0xd1dbcc(0x1fb)]()>=0x0?_0x24c32f['getLastCol']()+0x1:0x0;for(let _0x4182aa=0x0;_0x4182aa<_0x495653;_0x4182aa++){for(let _0x1cdcf2=0x0;_0x1cdcf2<_0x602f9f;_0x1cdcf2++){const _0x1cf8a0={...(_0x1047d9=(_0x31966e=_0x24c32f[_0xd1dbcc(0x127)])==null?void 0x0:_0x31966e[_0x4182aa])==null?void 0x0:_0x1047d9[_0x1cdcf2]},_0x45cea1=(_0x58d2ff=_0x1abf92[_0x1cdcf2])==null?void 0x0:_0x58d2ff[_0xd1dbcc(0x112)],_0x454f3a=_0x299502[_0x45cea1],_0x455e7c=_0x142f35[_0x45cea1];_0x1cf8a0&&(_0x1cf8a0['v']=Me(_0x1cf8a0,!0x1,_0x454f3a,_0x36cce3));let _0x50d4b1;_0x24c32f[_0xd1dbcc(0x403)][_0x4182aa][_0xd1dbcc(0x38f)]===_0x24c32f['getColCount']()?_0x50d4b1=oe[_0xd1dbcc(0x168)]:_0x24c32f[_0xd1dbcc(0x403)][_0x4182aa][_0xd1dbcc(0x28d)]?_0x50d4b1=_0x24c32f[_0xd1dbcc(0x403)][_0x4182aa]['level']===0x0?oe['grandTotal']:oe['subTotalStyle']:_0x50d4b1=oe['rowStyle'],_0x454f3a&&(_0x50d4b1={..._0x50d4b1,'n':{'pattern':_0x454f3a}}),_0x584dc7[_0xd1dbcc(0x196)](_0x4182aa+_0x54d5db,_0x1cdcf2+_0x66f49c,Ve(_0x977847,_0x1cf8a0,_0x50d4b1,_0x455e7c));}_0x24c32f[_0xd1dbcc(0x403)][_0x4182aa]&&(_0x4b0f64[''+(_0x4182aa+_0x54d5db)]=_0x24c32f['info'][_0x4182aa]),_0x24c32f[_0xd1dbcc(0x208)][_0x4182aa]&&(_0x3e2ff4[''+(_0x4182aa+_0x66f49c)]=_0x24c32f[_0xd1dbcc(0x208)][_0x4182aa]);}const _0x5ef56d=_0x517f96[_0xd1dbcc(0x1a5)](),_0x39d7ba=_0x517f96[_0xd1dbcc(0x2c1)]();for(let _0x47cbe4=0x0;_0x47cbe4<_0x5ef56d;_0x47cbe4++)for(let _0x418a43=0x0;_0x418a43<_0x39d7ba;_0x418a43++){const _0x50d447={...(_0x177206=(_0x3b42b2=_0x517f96[_0xd1dbcc(0x127)])==null?void 0x0:_0x3b42b2[_0x47cbe4])==null?void 0x0:_0x177206[_0x418a43]};let _0x22f83f;_0x24c32f[_0xd1dbcc(0x403)][_0x47cbe4][_0xd1dbcc(0x28d)]?_0x22f83f=_0x24c32f[_0xd1dbcc(0x403)][_0x47cbe4][_0xd1dbcc(0x38f)]===0x0?oe[_0xd1dbcc(0x30d)]:oe[_0xd1dbcc(0x2a3)]:_0x22f83f=oe[_0xd1dbcc(0x21e)];const _0x4cef52=_0x24c32f[_0xd1dbcc(0x403)][_0x47cbe4][_0xd1dbcc(0x3da)],_0x2cb349=_0x4a3292[_0xd1dbcc(0x403)][_0x418a43][_0xd1dbcc(0x3da)],_0x19e21c=Math[_0xd1dbcc(0x1ec)](_0x4cef52,_0x2cb349),_0x5d9da9=_0x5b1900[_0xd1dbcc(0x371)][_0xd1dbcc(0x17a)][_0xd1dbcc(0x2b5)]();let _0x5f0712='';_0x19e21c<0x0?_0x5f0712=(_0x161179=_0x5d9da9[0x0])!=null?_0x161179:'':_0x5f0712=(_0x22d037=_0x5d9da9[_0x19e21c])!=null?_0x22d037:'';const _0x27762a=_0x299502[_0x5f0712];_0x27762a&&(_0x22f83f={..._0x22f83f,'n':{'pattern':_0x27762a}}),_0x584dc7['setValue'](_0x47cbe4+_0x54d5db,_0x418a43+_0x2ac015,Ve(_0x977847,_0x50d447,_0x22f83f));}return{'valueMatrix':_0x584dc7,'rowInfo':_0x4b0f64,'colInfo':_0x2ba149,'cornerInfo':_0xec2eb4,'rowHeaderMap':_0x3e2ff4,'colHeaderMap':_0x4d18c5};};function Me(_0x1b4a33,_0x5e7a66,_0x1b167e,_0x464078){const _0x5216cc=_0x429c2e;let _0xd577a=_0x1b4a33['v'];_0x5e7a66&&(_0xd577a=''+_0x464078[_0x5216cc(0x2c5)]);const _0x3cf8d0=_0x1b4a33['t']&&(_0x1b4a33['t']&m[_0x5216cc(0x2bf)][_0x5216cc(0x11f)])>0x0;_0x3cf8d0&&(_0xd577a=''+_0x464078[_0x5216cc(0x2f9)]);const _0x1adfbc=_0x1b4a33['t']&&(_0x1b4a33['t']&m['PivotViewCellValueTypeEnum']['other'])>0x0;if(_0x1adfbc&&(_0xd577a=''+_0x464078['sheets-pivot.other']),_0x1b4a33['s']===m[_0x5216cc(0x3c9)][_0x5216cc(0x23a)]){let _0x1513e8=_0xd577a,_0x542f33='';m[_0x5216cc(0x328)](_0xd577a)&&(_0x1513e8=_0xd577a[_0x5216cc(0x40f)],_0x542f33=_0xd577a[_0x5216cc(0x1fd)]);const _0x2aff9d=_0x1b167e&&!_0x3cf8d0&&!_0x1adfbc?f['numfmt'][_0x5216cc(0x379)](_0x1b167e,Number(_0x1513e8)):_0x1513e8;_0x542f33?_0xd577a=_0x2aff9d+'\x20'+_0x542f33:_0xd577a=_0x2aff9d+'\x20'+_0x464078[_0x5216cc(0x169)];}else _0x1b4a33['s']===m[_0x5216cc(0x3c9)]['GrandTotal']&&(_0xd577a=_0xd577a+'\x20'+_0x464078['sheets-pivot.grandTotal']);return _0xd577a;}function $t(_0x2c9d4b){const _0x5ba355=_0x429c2e;if(m['isErrorValue'](_0x2c9d4b)){const {errorType:_0x2bf82e}=_0x2c9d4b;switch(_0x2bf82e){case m[_0x5ba355(0x187)][_0x5ba355(0x3fc)]:return fe['ErrorType']['DIV_BY_ZERO'];case m[_0x5ba355(0x187)]['NotNumber']:return fe[_0x5ba355(0x380)]['NUM'];case m[_0x5ba355(0x187)][_0x5ba355(0x1c3)]:return fe[_0x5ba355(0x380)][_0x5ba355(0x35d)];case m[_0x5ba355(0x187)][_0x5ba355(0x372)]:return fe[_0x5ba355(0x380)][_0x5ba355(0x35d)];case m[_0x5ba355(0x187)][_0x5ba355(0x22f)]:return fe[_0x5ba355(0x380)][_0x5ba355(0x143)];}}return _0x2c9d4b;}function ne(_0x5489db,_0x45bf3c,_0x3bbb75=!0x1,_0x1ad74d=!0x1){const _0x59aefc=_0x429c2e,{data:_0x5fa564}=_0x45bf3c,_0x5095f4=_0x45bf3c['getRowCount'](),_0x98f6e5=_0x45bf3c[_0x59aefc(0x2c1)]();if(_0x5095f4<=0x0||_0x98f6e5<=0x0)return[];const _0x3567f5=_0x45bf3c[_0x59aefc(0x1fb)](),_0x29e1ed=_0x45bf3c[_0x59aefc(0x1d6)](),_0x22e890=_0x1ad74d?_0x29e1ed>=0x0?_0x29e1ed+0x1:0x0:_0x5095f4,_0x4fc171=_0x1ad74d?_0x3567f5>=0x0?_0x3567f5+0x1:0x0:_0x98f6e5,{row:_0x56f3ab,col:_0x170ba8}=_0x5489db,_0x18da95=_0x56f3ab,_0x29ec2e=_0x170ba8;if(_0x3bbb75){const _0x13ae0d=[];for(const [_0x557513,_0x3d719d]of Object[_0x59aefc(0x261)](_0x5fa564))for(const [_0x51d804,_0x1b3126]of Object[_0x59aefc(0x261)](_0x3d719d))_0x13ae0d[_0x59aefc(0x390)](f[_0x59aefc(0x226)](_0x18da95+Number(_0x557513),_0x29ec2e+Number(_0x51d804)));return _0x13ae0d;}else{const _0x115963=_0x1ad74d?_0x22e890>0x0?0x1:0x0:0x1,_0x322775=_0x1ad74d?_0x4fc171>0x0?0x1:0x0:0x1,_0x4999e3=_0x56f3ab+_0x22e890-_0x115963,_0x439ade=_0x170ba8+_0x4fc171-_0x322775;return[{'startRow':_0x18da95,'startColumn':_0x29ec2e,'endRow':_0x4999e3,'endColumn':_0x439ade}];}}const Q='SHEET_PIVOT_IN_MAIN_THREAD',Pt=_0x429c2e(0x325);var k=(_0x4a9104=>(_0x4a9104[_0x429c2e(0x1bc)]=_0x429c2e(0x26f),_0x4a9104[_0x429c2e(0x3a5)]=_0x429c2e(0x31e),_0x4a9104[_0x429c2e(0x383)]=_0x429c2e(0x152),_0x4a9104[_0x429c2e(0x23d)]=_0x429c2e(0x23d),_0x4a9104[_0x429c2e(0x265)]=_0x429c2e(0x3a2),_0x4a9104[_0x429c2e(0x409)]=_0x429c2e(0x401),_0x4a9104[_0x429c2e(0x3b7)]=_0x429c2e(0x1c9),_0x4a9104['SetPivotCollapse']='setPivotCollapse',_0x4a9104[_0x429c2e(0x1d5)]=_0x429c2e(0x153),_0x4a9104[_0x429c2e(0x1de)]='setPivotSort',_0x4a9104[_0x429c2e(0x299)]='setPivotSetting',_0x4a9104['UpdatePivotSource']=_0x429c2e(0x1c1),_0x4a9104[_0x429c2e(0x229)]='updateValuePosition',_0x4a9104[_0x429c2e(0x2e8)]=_0x429c2e(0x3d1),_0x4a9104['SetValuePivotFilter']=_0x429c2e(0x384),_0x4a9104[_0x429c2e(0x245)]=_0x429c2e(0x183),_0x4a9104['ResetPivotTable']=_0x429c2e(0x323),_0x4a9104))(k||{});const Qo={'sheets-pivot.blankValue':_0x429c2e(0x34b),'sheets-pivot.columnName':_0x429c2e(0x31b),'sheets-pivot.subTotalText':_0x429c2e(0x1a9),'sheets-pivot.grandTotalText':_0x429c2e(0x232),'sheets-pivot.valueText':_0x429c2e(0x404),'sheets-pivot.averageName':_0x429c2e(0x3f2),'sheets-pivot.countName':_0x429c2e(0x413),'sheets-pivot.countNumsName':_0x429c2e(0x413),'sheets-pivot.maxName':_0x429c2e(0x27f),'sheets-pivot.minName':_0x429c2e(0x2bd),'sheets-pivot.productName':_0x429c2e(0x283),'sheets-pivot.stdDevName':_0x429c2e(0x307),'sheets-pivot.stdDevpName':_0x429c2e(0x171),'sheets-pivot.sumName':_0x429c2e(0x1f7),'sheets-pivot.varName':_0x429c2e(0x288),'sheets-pivot.varpName':_0x429c2e(0x223),'sheets-pivot.subTotal':'Subtotal','sheets-pivot.grandTotal':'Grand\x20Total','sheets-pivot.value':_0x429c2e(0x1fd),'sheets-pivot.blank':'blank','sheets-pivot.other':_0x429c2e(0x230),'sheets-pivot.emptyPivot.filter':_0x429c2e(0x1bc),'sheets-pivot.emptyPivot.row':'Row','sheets-pivot.emptyPivot.column':'Column','sheets-pivot.emptyPivot.values':_0x429c2e(0x3db)},At={'undos':[],'redos':[],'preUndos':[],'preRedos':[]},re=f['createAsyncInterceptorKey']('pivotPerformCheck'),Jt=f[_0x429c2e(0x1d4)](_0x429c2e(0x349));var Se=(_0x3a15c9=>(_0x3a15c9[_0x429c2e(0x207)]=_0x429c2e(0x207),_0x3a15c9[_0x429c2e(0x176)]=_0x429c2e(0x176),_0x3a15c9['update']=_0x429c2e(0x3a9),_0x3a15c9))(Se||{}),L=(_0x101775=>(_0x101775[_0x429c2e(0x3c3)]=_0x429c2e(0x207),_0x101775['Set']=_0x429c2e(0x29b),_0x101775[_0x429c2e(0x40b)]=_0x429c2e(0x176),_0x101775))(L||{});const Ft={'type':f[_0x429c2e(0x2df)][_0x429c2e(0x205)],'id':_0x429c2e(0x414),'handler':()=>!0x0},wt={'type':f[_0x429c2e(0x2df)]['MUTATION'],'id':'sheet.mutation.send-pivot-data-local','handler':()=>!0x0},ot={'type':f[_0x429c2e(0x2df)][_0x429c2e(0x205)],'id':_0x429c2e(0x3e5),'handler':()=>!0x0},_t={'type':f[_0x429c2e(0x2df)]['MUTATION'],'id':'sheet.mutation.send-pivot-config-local','handler':()=>!0x0},Rt={'type':f['CommandType'][_0x429c2e(0x205)],'id':_0x429c2e(0x214),'handler':()=>!0x0};var qo=Object['getOwnPropertyDescriptor'],Ko=(_0x126193,_0x48be9a,_0x10608b,_0x7d17a)=>{const _0x137904=_0x429c2e;for(var _0x4a63a9=_0x7d17a>0x1?void 0x0:_0x7d17a?qo(_0x48be9a,_0x10608b):_0x48be9a,_0x244979=_0x126193[_0x137904(0x2ca)]-0x1,_0x32acc6;_0x244979>=0x0;_0x244979--)(_0x32acc6=_0x126193[_0x244979])&&(_0x4a63a9=_0x32acc6(_0x4a63a9)||_0x4a63a9);return _0x4a63a9;},Ho=(_0x356aba,_0x33adc5)=>(_0x18fa85,_0x71f1ef)=>_0x33adc5(_0x18fa85,_0x71f1ef,_0x356aba);exports[_0x429c2e(0x3e0)]=class extends f[_0x429c2e(0x141)]{constructor(_0x315a50){const _0x4872e5=_0x429c2e;super(),x(this,_0x4872e5(0x3ce),new Map()),this['_commandService']=_0x315a50;}[_0x429c2e(0x180)](_0x2e3e43){const _0x2326cf=_0x429c2e,{version:_0x1bcaf3}=_0x2e3e43,_0x19284c=this[_0x2326cf(0x3ce)][_0x2326cf(0x236)](_0x1bcaf3);_0x19284c&&(_0x19284c(_0x2e3e43),this[_0x2326cf(0x3ce)][_0x2326cf(0x176)](_0x1bcaf3));}['getPivotDisplayConfig'](_0x119e6a){return new Promise((_0x34eb45,_0xde549b)=>{const _0x22ed12=_0x3f2b,_0x32559d=this['_generateUniqueVersion']();this[_0x22ed12(0x3ce)][_0x22ed12(0x29b)](_0x32559d,_0x34eb45),this[_0x22ed12(0x20c)][_0x22ed12(0x301)](Ft['id'],{'version':_0x32559d,..._0x119e6a},{'onlyLocal':!0x0});});}[_0x429c2e(0x3ff)](){const _0x40cc54=_0x429c2e;return Math[_0x40cc54(0x375)]()['toString'](0x24)[_0x40cc54(0x2be)](0x2,0x10);}},exports[_0x429c2e(0x3e0)]=Ko([Ho(0x0,f[_0x429c2e(0x297)](f[_0x429c2e(0x20e)]))],exports['SheetsPivotRPCService']);const Qt={0x0:'W',0x1:'N',0x2:'O',0x3:'G',0x4:'J',0x5:'2',0x6:'y',0x7:'M',0x8:'B',0x9:'c','P':'0','w':'1','N':'3','H':'4','U':'5','R':'6','v':'7','O':'8','z':'9','E':'a','a':'b','W':'d','g':'e','X':'f','G':'g','e':'h','C':'i','l':'j','f':'k','T':'l','m':'m','t':'n','Q':'o','n':'p','y':'q','I':'r','o':'s','b':'t','x':'u','J':'v','Z':'w','k':'x','Y':'z','h':'A','r':'C','s':'D','p':'E','D':'F','i':'H','B':'I','c':'K','M':'L','j':'P','V':'Q','F':'R','d':'S','q':'T','S':'U','K':'V','u':'X','A':'Y','L':'Z'},qt=_0x429c2e(0x36d),Xo=_0x3eb133=>{const _0x19e7ad=_0x429c2e;var _0x394b3c;return((_0x394b3c=_0x3eb133[_0x19e7ad(0x3d9)])==null?void 0x0:_0x394b3c[_0x19e7ad(0x3c5)]['replace'](/\r\n$/,''))||'';};class Yo extends m['DataFieldManager']{constructor(_0x44972b,_0x1792bb){const _0x4e4049=_0x429c2e;super(),x(this,_0x4e4049(0x3c8),{}),x(this,'_univerInstanceService'),x(this,_0x4e4049(0x192)),(this['_univerInstanceService']=_0x1792bb,this[_0x4e4049(0x192)]=_0x44972b);}[_0x429c2e(0x18a)](){const _0x3c1247=_0x429c2e;for(const _0x5ed07b in this[_0x3c1247(0x320)]){const _0x15b875=this[_0x3c1247(0x320)][_0x5ed07b],_0x5a08d4=_0x15b875[_0x3c1247(0x14b)]();this[_0x3c1247(0x3c8)][_0x5a08d4]=_0x15b875[_0x3c1247(0x319)]();}}['getAutoDisplayNameFunction'](){const _0x1a3b53=_0x429c2e,_0x2d3eff=this['_host'];return an[_0x1a3b53(0x186)](_0x2d3eff);}['deleteDataField'](_0x4ae915){const _0x2f9806=_0x429c2e,_0x5f06f6=this['dataFields'][_0x4ae915][_0x2f9806(0x298)];delete this[_0x2f9806(0x320)][_0x4ae915],delete this[_0x2f9806(0x3c8)][_0x5f06f6];}['addDataFieldWithoutUnitInfo'](_0xf88fe3){const _0x2634ad=_0x429c2e;this[_0x2634ad(0x320)][_0xf88fe3['getId']()]=_0xf88fe3;}['removeCollectionImp'](_0x3e3f6e){const _0x496679=_0x429c2e;var _0x17d695,_0x1accd9;const _0x1f1437=this[_0x496679(0x192)][_0x496679(0x2fe)](_0x3e3f6e);if(_0x1f1437){const {unitId:_0x130589,subUnitId:_0x23be94}=_0x1f1437,_0x36c6c5=(_0x17d695=this[_0x496679(0x192)][_0x496679(0x2cb)](_0x130589,_0x23be94,_0x3e3f6e))==null?void 0x0:_0x17d695[_0x496679(0x2aa)];this[_0x496679(0x192)][_0x496679(0x2af)]({'token':_0x3e3f6e,'type':Se[_0x496679(0x176)],'dataRangeInfo':_0x36c6c5});}(_0x1accd9=this['getCollection'](_0x3e3f6e))==null||_0x1accd9[_0x496679(0x2d8)](),delete this[_0x496679(0x124)][_0x3e3f6e];}['getRangeKey'](_0x2b0c00,_0x34b159){const _0x401566=_0x429c2e,{sheetName:_0x55b8d9,unitId:_0x235c76,range:_0xe8309b}=_0x2b0c00,{startRow:_0x2b17fc,endRow:_0x4d21b7}=_0xe8309b;return fe[_0x401566(0x1b9)](_0x235c76,_0x55b8d9,{'startRow':_0x2b17fc,'endRow':_0x4d21b7,'startColumn':_0x34b159,'endColumn':_0x34b159});}[_0x429c2e(0x212)](_0x4e6ebd){const _0x4c8880=_0x429c2e;return this['dataFields'][this[_0x4c8880(0x3c8)][_0x4e6ebd]];}['setRangeKeyMap'](_0x42b56f,_0x4dc745){const _0x35065f=_0x429c2e;this[_0x35065f(0x3c8)][_0x42b56f]=_0x4dc745;}['updateRangeKeyMap'](_0x3b9a8c,_0x3cb19c){const _0x2cea8e=_0x429c2e;this[_0x2cea8e(0x3c8)][_0x3cb19c]=this[_0x2cea8e(0x3c8)][_0x3b9a8c],delete this[_0x2cea8e(0x3c8)][_0x3b9a8c];}[_0x429c2e(0x262)](_0x53ee18,_0x403ffd,_0x5bf0a7,_0x3197e9){const _0x14f12d=_0x429c2e,_0x57047b=new m[(_0x14f12d(0x2d3))](this);_0x57047b[_0x14f12d(0x347)](_0x403ffd);const _0x352dac=[];let _0x1ea0ea=0x0;for(const _0x2d4418 of _0x57047b[_0x14f12d(0x406)]){const _0x29a67b=this[_0x14f12d(0x14b)](_0x5bf0a7,_0x1ea0ea),_0x1d4489=this[_0x14f12d(0x320)][_0x2d4418];_0x1d4489&&(_0x1d4489['rangeKey']=_0x29a67b,this[_0x14f12d(0x1aa)](_0x29a67b,_0x2d4418),_0x352dac['push']({'index':_0x1ea0ea,'dataField':_0x1d4489})),_0x1ea0ea++;}return this['addCollection'](_0x53ee18,_0x57047b,_0x5bf0a7,_0x3197e9),{'collection':_0x57047b,'updateDataFieldList':_0x352dac};}[_0x429c2e(0x167)](_0x4cabd4,_0x5793c4){const _0x49feed=_0x429c2e;return _0x4cabd4[_0x49feed(0x21c)]===f[_0x49feed(0x3b1)][_0x49feed(0x322)]?{'startRow':0x0,'startColumn':_0x4cabd4['startColumn'],'endRow':_0x5793c4[_0x49feed(0x1a5)]()-0x1,'endColumn':_0x4cabd4[_0x49feed(0x1da)]}:{'startRow':_0x4cabd4['startRow'],'startColumn':_0x4cabd4[_0x49feed(0x198)],'endRow':_0x4cabd4['endRow'],'endColumn':_0x4cabd4[_0x49feed(0x1da)]};}[_0x429c2e(0x397)](_0x26dae2){const _0x98f8ad=_0x429c2e,{sheetName:_0x153f5e,range:_0x522174}=_0x26dae2,_0x13c2a3=this[_0x98f8ad(0x21b)]['getCurrentUnitForType'](f[_0x98f8ad(0x300)]['UNIVER_SHEET']),_0xc49d27=_0x13c2a3[_0x98f8ad(0x1a6)](_0x153f5e),_0x5d18a2=_0xc49d27[_0x98f8ad(0x16b)](),{startColumn:_0x29d95c,startRow:_0x42fdc6,endColumn:_0x943319}=this[_0x98f8ad(0x167)](_0x522174,_0xc49d27),_0x36288d=_0x13c2a3[_0x98f8ad(0x270)](),_0x313a58=new m[(_0x98f8ad(0x2d3))](this);_0x313a58['setRange'](_0x26dae2);const _0x12effb=[],_0x296641={};for(let _0x5dd2e4=_0x29d95c;_0x5dd2e4<=_0x943319;_0x5dd2e4++){const _0x46a99e=_0x5d18a2[_0x98f8ad(0x3f3)](_0x42fdc6,_0x5dd2e4),_0x35a7e8=this['getRangeKey'](_0x26dae2,_0x5dd2e4),_0x122bda=this[_0x98f8ad(0x212)](_0x35a7e8);if(_0x122bda)_0x313a58['addField'](_0x122bda['getId'](),_0x122bda[_0x98f8ad(0x25d)]());else{const _0x433854=this[_0x98f8ad(0x356)]();let _0x3986b9=this['adjustSheetCellData'](_0x46a99e,_0x36288d,_0x296641);m[_0x98f8ad(0x2fb)](_0x3986b9)&&(_0x3986b9=f[_0x98f8ad(0x39f)][_0x98f8ad(0x379)](_0x3986b9['f'],Number(_0x3986b9['v'])));const _0x5baa86=this[_0x98f8ad(0x285)](_0x3986b9,_0x5dd2e4),_0x22c712=new m[(_0x98f8ad(0x385))](_0x433854,_0x5baa86,m[_0x98f8ad(0x26b)](0x3));_0x22c712['rangeKey']=_0x35a7e8,this['dataFields'][_0x433854]=_0x22c712,_0x313a58['addField'](_0x433854,_0x5baa86),_0x12effb[_0x98f8ad(0x390)]({'index':_0x5dd2e4,'dataField':_0x22c712});}}return{'updateDataFieldList':_0x12effb,'collection':_0x313a58};}[_0x429c2e(0x132)](_0xafc0c9){const _0x1a481b=_0x429c2e;return this[_0x1a481b(0x192)]['getTextInfo']()[_0x1a481b(0x1f8)]+'\x20'+f[_0x1a481b(0x2b8)](_0xafc0c9);}[_0x429c2e(0x285)](_0x43360b,_0x21e415){const _0x529b05=_0x429c2e;return _0x43360b==null||_0x43360b===''?this[_0x529b05(0x132)](_0x21e415):String(_0x43360b);}[_0x429c2e(0x302)](_0x5896da){const _0x44dd36=_0x429c2e;return this[_0x44dd36(0x124)][_0x5896da];}[_0x429c2e(0x39d)](_0x5a22ad,_0x20865a,_0x11c1ec,_0x153b5f){const _0x45e7b5=_0x429c2e;this[_0x45e7b5(0x124)][_0x5a22ad]=_0x20865a,_0x20865a[_0x45e7b5(0x1cd)](_0x11c1ec),this[_0x45e7b5(0x192)][_0x45e7b5(0x2af)]({'token':_0x5a22ad,'type':Se[_0x45e7b5(0x207)],'dataRangeInfo':_0x11c1ec,'targetCellInfo':_0x153b5f});}['handleMoveRange'](_0xd0b74f,_0x4bd45a){const _0x53ab3f=_0x429c2e,_0x18f6fe=this[_0x53ab3f(0x302)](_0xd0b74f),_0x271af6=_0x18f6fe['getFieldIds']();let _0x584104=0x0;for(const _0x51fa84 of _0x271af6){const _0x1b4700=_0x18f6fe[_0x53ab3f(0x3b4)](_0x51fa84),_0x58acde=this['getRangeKey'](_0x4bd45a,_0x584104);this[_0x53ab3f(0x25a)](_0x1b4700['rangeKey'],_0x58acde),_0x584104++;}}[_0x429c2e(0x3d8)](){return{'runtimeCellData':{},'dirtyRanges':{}};}['getUpdateRangeDeleteIds'](_0x30f4eb,_0x3aad33){const _0x190b7f=_0x429c2e;if(this['getCollection'](_0x30f4eb)){const _0x311a18=this['getRangeKeyList'](_0x3aad33),_0x1bd16e=[];for(const _0x162408 of _0x311a18)this['rangeKeyMap'][_0x162408]!==void 0x0&&_0x1bd16e[_0x190b7f(0x390)](this[_0x190b7f(0x3c8)][_0x162408]);const _0x539f35=this['getNoUsedDataFieldIds'](_0x30f4eb),_0x1e92f6=[],_0x328c2a=new Set(_0x1bd16e);for(const _0x457ea5 of _0x539f35)_0x328c2a[_0x190b7f(0x1d3)](_0x457ea5)||_0x1e92f6[_0x190b7f(0x390)](_0x457ea5);return _0x1e92f6;}}['getMatrixValue'](_0x3977e4,_0x333d64,_0x3c3cd0,_0x27c879,_0x46dfd6){const _0x25ae1d=_0x429c2e;return _0x333d64&&_0x333d64[_0x25ae1d(0x3f3)](_0x27c879,_0x46dfd6)?_0x333d64[_0x25ae1d(0x3f3)](_0x27c879,_0x46dfd6):_0x3c3cd0&&_0x3c3cd0[_0x25ae1d(0x3f3)](_0x27c879,_0x46dfd6)?_0x3c3cd0['getValue'](_0x27c879,_0x46dfd6):_0x3977e4[_0x25ae1d(0x3f3)](_0x27c879,_0x46dfd6);}['refreshDataField'](_0x2fafff,_0x528763,_0x449ca2,_0x167809){const _0x14ee5e=_0x429c2e,_0x2b05b3=this[_0x14ee5e(0x320)][_0x2fafff];if(!_0x2b05b3)return;const {subUnitId:_0x3b1c69,range:_0x322f1f,unitId:_0xb6b999}=_0x528763,_0x30f471=this[_0x14ee5e(0x21b)]['getUnit'](_0xb6b999);if(!_0x30f471){console[_0x14ee5e(0x3f6)](_0x14ee5e(0x11e));return;}const _0x2320ce=_0x30f471[_0x14ee5e(0x3ca)](_0x3b1c69),_0x324994=_0x2320ce[_0x14ee5e(0x16b)](),{arrayFormulaCellDataMatrix:_0x3ff803,unitDataMatrix:_0x324f5a}=_0x167809||{},{startRow:_0x3ddb59,startColumn:_0x4e9110,endRow:_0x36be54}=this['getRangeStartEndInfo'](_0x322f1f,_0x2320ce);_0x2b05b3['reset']();const _0x3a17b8=_0x30f471[_0x14ee5e(0x270)](),_0x4e880a={},_0x58c9cf=this['getMatrixValue'](_0x324994,_0x3ff803,_0x324f5a,_0x3ddb59,_0x4e9110+_0x449ca2);let _0x32f352=this[_0x14ee5e(0x25c)](_0x58c9cf,_0x3a17b8,_0x4e880a);m[_0x14ee5e(0x2fb)](_0x32f352)&&(_0x32f352=f[_0x14ee5e(0x39f)][_0x14ee5e(0x379)](_0x32f352['f'],Number(_0x32f352['v'])));const _0x852603=this[_0x14ee5e(0x285)](_0x32f352,_0x4e9110+_0x449ca2);_0x2b05b3[_0x14ee5e(0x142)](_0x852603);for(let _0x5c173c=_0x3ddb59+0x1;_0x5c173c<=_0x36be54;_0x5c173c++){const _0x1ecf67=this[_0x14ee5e(0x191)](_0x324994,_0x3ff803,_0x324f5a,_0x5c173c,_0x4e9110+_0x449ca2);_0x2b05b3[_0x14ee5e(0x218)](this[_0x14ee5e(0x25c)](_0x1ecf67,_0x3a17b8,_0x4e880a),_0x5c173c-0x1-_0x3ddb59);}}[_0x429c2e(0x2d7)](_0x1fd040,_0x37f2c9,_0x1bd58d){const _0x49c9f5=_0x429c2e,{subUnitId:_0x34cbda,range:_0x1e3976,unitId:_0x5d845f}=_0x1bd58d,_0x4ef03c=this[_0x49c9f5(0x21b)][_0x49c9f5(0x3b9)](_0x5d845f);if(!_0x4ef03c){console['error'](_0x49c9f5(0x11e));return;}const _0x13cd7b=_0x4ef03c[_0x49c9f5(0x3ca)](_0x34cbda),_0x26df0f=_0x13cd7b[_0x49c9f5(0x16b)](),{startRow:_0x30b05a,startColumn:_0x2fe79d,endRow:_0x1608d1}=this[_0x49c9f5(0x167)](_0x1e3976,_0x13cd7b),_0x3151c7=_0x4ef03c[_0x49c9f5(0x270)](),_0x133e47={};for(const {dataField:_0x303d11,index:_0x4cfd7d}of _0x37f2c9){_0x303d11[_0x49c9f5(0x2a4)]();const _0x36caf1=this['getMatrixValue'](_0x26df0f,void 0x0,void 0x0,_0x30b05a,_0x2fe79d+_0x4cfd7d);let _0x80d2ee=this['adjustSheetCellData'](_0x36caf1,_0x3151c7,_0x133e47);m[_0x49c9f5(0x2fb)](_0x80d2ee)&&(_0x80d2ee=f[_0x49c9f5(0x39f)][_0x49c9f5(0x379)](_0x80d2ee['f'],Number(_0x80d2ee['v'])));const _0x441829=this[_0x49c9f5(0x285)](_0x80d2ee,_0x2fe79d+_0x4cfd7d);_0x303d11[_0x49c9f5(0x142)](_0x441829);}_0x1fd040['updateAllDisplayName']();for(let _0x446206=_0x30b05a+0x1;_0x446206<=_0x1608d1;_0x446206++)for(const {index:_0x3b0ab2,dataField:_0x19fa19}of _0x37f2c9){const _0x20fcde=_0x26df0f[_0x49c9f5(0x3f3)](_0x446206,_0x2fe79d+_0x3b0ab2);_0x19fa19['addRecord'](this[_0x49c9f5(0x25c)](_0x20fcde,_0x3151c7,_0x133e47),_0x446206-0x1-_0x30b05a);}_0x1fd040[_0x49c9f5(0x389)](_0x1608d1-_0x30b05a);}[_0x429c2e(0x364)](_0x56f9c7){const _0x14429a=_0x429c2e,{range:_0x1ec234}=_0x56f9c7,{startColumn:_0x243d31,endColumn:_0xc7eb96}=_0x1ec234,_0x48d0f2=[];for(let _0xc06687=_0x243d31;_0xc06687<=_0xc7eb96;_0xc06687++)_0x48d0f2[_0x14429a(0x390)](this['getRangeKey'](_0x56f9c7,_0xc06687));return _0x48d0f2;}[_0x429c2e(0x25c)](_0x1a4133,_0x5b7afb,_0x11fb07){const _0x44883f=_0x429c2e;if(_0x1a4133){const {s:_0x8490cd,v:_0x2f393e,t:_0xb15745,p:_0x19c435}=_0x1a4133;if(_0x19c435)return Xo(_0x19c435);const _0x487260=_0x5b7afb[_0x44883f(0x236)](_0x8490cd);if(_0x487260&&_0xb15745===f['CellValueType'][_0x44883f(0x1ad)]&&_0x487260['n']){const {pattern:_0x34a5a3}=_0x487260['n'];_0x11fb07[_0x34a5a3]||(_0x11fb07[_0x34a5a3]=f['numfmt'][_0x44883f(0x2c0)](_0x34a5a3));const _0x52424d=_0x11fb07[_0x34a5a3],_0x582919=_0x52424d[_0x44883f(0x17c)];if(_0x52424d['isText'])return String(_0x2f393e);if(_0x582919)return{'v':_0x2f393e,'f':_0x34a5a3};}if(_0xb15745===f[_0x44883f(0x3b6)][_0x44883f(0x1ad)])return Number(_0x2f393e);if(_0xb15745===f[_0x44883f(0x3b6)][_0x44883f(0x3aa)]||_0xb15745===f[_0x44883f(0x3b6)][_0x44883f(0x2f4)])return String(_0x2f393e);if(_0xb15745===void 0x0){const _0x323bc0=Number(_0x2f393e);if(!Number[_0x44883f(0x18b)](_0x323bc0)&&String(_0x323bc0)===_0x2f393e)return _0x323bc0;}return _0x2f393e!=null?_0x2f393e:null;}else return null;}[_0x429c2e(0x2ad)](_0x3be189){const _0x13b477=_0x429c2e,{sheetName:_0x2a4783,range:_0x23cbd3,unitId:_0x299455}=_0x3be189,_0x397f36=this[_0x13b477(0x21b)][_0x13b477(0x3b9)](_0x299455);if(!_0x397f36)return console[_0x13b477(0x3f6)]('workbook\x20is\x20not\x20found'),{'header':[],'data':[]};const _0x56d331=_0x397f36[_0x13b477(0x1a6)](_0x2a4783),_0x11e9fd=_0x56d331[_0x13b477(0x16b)](),{startRow:_0x17aca7,startColumn:_0x1c5c67,endRow:_0x52d055,endColumn:_0x2e705e}=this[_0x13b477(0x167)](_0x23cbd3,_0x56d331),_0x3e0722=_0x397f36[_0x13b477(0x270)](),_0x5e05bf=[],_0x2a22e5=[],_0x5d385a={};for(let _0x12081c=_0x17aca7;_0x12081c<=_0x52d055;_0x12081c++){const _0x59fc1f=[];for(let _0x52215a=_0x1c5c67;_0x52215a<=_0x2e705e;_0x52215a++){const _0x1aa780=_0x11e9fd[_0x13b477(0x3f3)](_0x12081c,_0x52215a);_0x12081c===_0x17aca7?_0x5e05bf[_0x13b477(0x390)](_0x1aa780==null?null:String(_0x1aa780['v'])):_0x59fc1f[_0x13b477(0x390)](this[_0x13b477(0x25c)](_0x1aa780,_0x3e0722,_0x5d385a));}_0x2a22e5[_0x13b477(0x390)](_0x59fc1f);}return{'header':_0x5e05bf,'data':_0x2a22e5};}['toJSON'](){return super['toJSON']();}[_0x429c2e(0x347)](_0x29f01c){const _0x2d2449=_0x429c2e;super[_0x2d2449(0x347)](_0x29f01c),this[_0x2d2449(0x18a)]();}[_0x429c2e(0x2d8)](){const _0xed1461=_0x429c2e;super[_0xed1461(0x2d8)](),this[_0xed1461(0x3c8)]={},this[_0xed1461(0x192)]=null;}}const zo=_0x29b558=>{const _0x15e147=_0x429c2e,{targetCellInfo:_0x591294}=_0x29b558,{matrixCache:_0x48832b,rangesCache:_0x14556c}=Kt({'filter':'Filter','row':'Row','column':_0x15e147(0x26e),'values':_0x15e147(0x3db)},_0x591294),_0x5160b5=new f[(_0x15e147(0x2d2))]();return _0x48832b[_0x15e147(0x260)]((_0x2000a8,_0x427f9a,_0x55d56e)=>{const _0x5c57d2=_0x15e147;_0x5160b5[_0x5c57d2(0x196)](_0x2000a8,_0x427f9a,_0x55d56e);}),{'matrix':_0x5160b5,'rangesCache':_0x14556c};},xe=_0x247b65=>{const _0x1d974d=_0x429c2e;let _0x3684ac;if(_0x247b65!=null&&_0x247b65['v']||(_0x247b65==null?void 0x0:_0x247b65['v'])===0x0){_0x3684ac||(_0x3684ac={});const _0x13df42=$t(_0x247b65['v']);typeof _0x13df42==_0x1d974d(0x3d2)?_0x3684ac['t']=f['CellValueType'][_0x1d974d(0x1ad)]:typeof _0x13df42==_0x1d974d(0x3dc)&&(_0x3684ac['t']=f['CellValueType']['STRING']),_0x3684ac['v']=_0x13df42;}return _0x3684ac;},Zo=(_0x1c8573,_0x5853d6,_0x3b57b3)=>{const _0x2f18fe=_0x429c2e;var _0x657b0f,_0x4c04f5,_0x1e6b13,_0x458458,_0x4147f0,_0x16450a,_0x3e2128,_0x2b42bb,_0x194cc7,_0x55b43d,_0x5a9127,_0x35e7c9;const {cornerView:_0x16d7e3,rowView:_0x30e285,colView:_0xfcb934,dataView:_0x48cb16,pageView:_0x400fdb,formatMap:_0x8770d2}=_0x1c8573,{row:_0x2f7d0a,col:_0x4d7bc5}=_0x5853d6,_0xddf76=new f['ObjectMatrix']();let _0x2d636a=_0x2f7d0a,_0x479c91=_0x4d7bc5;Object[_0x2f18fe(0x116)](_0x400fdb[_0x2f18fe(0x127)])['forEach'](_0x1cc3cf=>{const _0x519992=_0x2f18fe;Object['keys'](_0x400fdb[_0x519992(0x127)][Number(_0x1cc3cf)])[_0x519992(0x174)](_0xb7ce38=>{const _0x19f8d3=_0x519992,_0x5e3358={..._0x400fdb[_0x19f8d3(0x127)][Number(_0x1cc3cf)][Number(_0xb7ce38)]};_0xddf76[_0x19f8d3(0x196)](Number(_0x1cc3cf)+_0x2d636a,Number(_0xb7ce38)+_0x479c91,xe(_0x5e3358));});});const _0x15f698=Object[_0x2f18fe(0x116)](_0x400fdb[_0x2f18fe(0x127)])[_0x2f18fe(0x2ca)];_0x2d636a+=_0x15f698+(_0x15f698?we:0x0);const _0x49a6a0=_0x16d7e3[_0x2f18fe(0x1a5)](),_0x233574=_0x16d7e3['getColCount']();for(let _0x4aef1f=0x0;_0x4aef1f<_0x49a6a0;_0x4aef1f++)for(let _0x33e42b=0x0;_0x33e42b<_0x233574;_0x33e42b++){const _0x57d5cd={...(_0x4c04f5=(_0x657b0f=_0x16d7e3[_0x2f18fe(0x127)])==null?void 0x0:_0x657b0f[_0x4aef1f])==null?void 0x0:_0x4c04f5[_0x33e42b]};_0x57d5cd&&((_0x1e6b13=_0x30e285[_0x2f18fe(0x208)][_0x33e42b])!=null&&_0x1e6b13['isValue'])&&_0x33e42b===_0x233574-0x1&&_0x4aef1f===_0x49a6a0-0x1&&(_0x57d5cd['v']=''+_0x3b57b3[_0x2f18fe(0x2c5)]),_0xddf76[_0x2f18fe(0x196)](_0x4aef1f+_0x2d636a,_0x33e42b+_0x479c91,xe(_0x57d5cd));}_0x479c91+=_0x233574;const _0x164984=_0xfcb934[_0x2f18fe(0x208)],_0x30a06f=_0xfcb934[_0x2f18fe(0x1d6)]()>=0x0?_0xfcb934[_0x2f18fe(0x1d6)]()+0x1:0x0,_0x24be35=_0xfcb934[_0x2f18fe(0x1fb)]()>=0x0?_0xfcb934['getLastCol']()+0x1:0x0;for(let _0x5d33ae=0x0;_0x5d33ae<_0x24be35;_0x5d33ae++)for(let _0x134849=0x0;_0x134849<_0x30a06f;_0x134849++){const _0x6b7f82={...(_0x4147f0=(_0x458458=_0xfcb934[_0x2f18fe(0x127)])==null?void 0x0:_0x458458[_0x5d33ae])==null?void 0x0:_0x4147f0[_0x134849]},_0x1911ae=(_0x16450a=_0x164984[_0x5d33ae])==null?void 0x0:_0x16450a[_0x2f18fe(0x112)],_0x4d05e7=_0x8770d2[_0x1911ae];_0x6b7f82&&(_0x6b7f82['v']=Me(_0x6b7f82,_0x5d33ae===0x0&&((_0x3e2128=_0xfcb934[_0x2f18fe(0x2c3)](_0x134849+0x1))==null?void 0x0:_0x3e2128[_0x2f18fe(0x395)]),_0x4d05e7,_0x3b57b3)),_0xddf76[_0x2f18fe(0x196)](_0x5d33ae+_0x2d636a,_0x134849+_0x479c91,xe(_0x6b7f82));}_0x2d636a+=_0x49a6a0;const _0x466f27=_0x30e285['headerMap'],_0x32a199=_0x30e285[_0x2f18fe(0x1d6)]()>=0x0?_0x30e285['getLastRow']()+0x1:0x0,_0x43531a=_0x30e285[_0x2f18fe(0x1fb)]()>=0x0?_0x30e285[_0x2f18fe(0x1fb)]()+0x1:0x0;for(let _0x61257d=0x0;_0x61257d<_0x32a199;_0x61257d++)for(let _0xa70a03=0x0;_0xa70a03<_0x43531a;_0xa70a03++){const _0x15c0d5={...(_0x194cc7=(_0x2b42bb=_0x30e285[_0x2f18fe(0x127)])==null?void 0x0:_0x2b42bb[_0x61257d])==null?void 0x0:_0x194cc7[_0xa70a03]},_0x2f4a9e=(_0x55b43d=_0x466f27[_0xa70a03])==null?void 0x0:_0x55b43d[_0x2f18fe(0x112)],_0x49a558=_0x8770d2[_0x2f4a9e];_0x15c0d5&&(_0x15c0d5['v']=Me(_0x15c0d5,!0x1,_0x49a558,_0x3b57b3)),_0xddf76['setValue'](_0x61257d+_0x2d636a,_0xa70a03+_0x4d7bc5,xe(_0x15c0d5));}const _0x56d737=_0x48cb16[_0x2f18fe(0x1a5)](),_0x455dca=_0x48cb16['getColCount']();for(let _0x57968f=0x0;_0x57968f<_0x56d737;_0x57968f++)for(let _0x534124=0x0;_0x534124<_0x455dca;_0x534124++){const _0x47e057={...(_0x35e7c9=(_0x5a9127=_0x48cb16[_0x2f18fe(0x127)])==null?void 0x0:_0x5a9127[_0x57968f])==null?void 0x0:_0x35e7c9[_0x534124]};_0xddf76[_0x2f18fe(0x196)](_0x57968f+_0x2d636a,_0x534124+_0x479c91,xe(_0x47e057));}return _0xddf76;},en=_0x195a35=>{const _0x44f81b=_0x429c2e,{view:_0x193da8,targetCellInfo:_0x230075,isEmpty:_0x4627cd,textInfo:_0x32a196}=_0x195a35;if(_0x4627cd)return zo(_0x195a35);const {pageView:_0xbcc154,cornerView:_0x6b3f4d,rowView:_0x2579ae,colView:_0x4755c6,dataView:_0x334f23}=_0x193da8,_0x57b08a=ne(_0x230075,_0xbcc154,!0x0),_0x4e9d1c=_0xbcc154[_0x44f81b(0x237)]>=0x0?_0xbcc154[_0x44f81b(0x237)]+0x1:0x0,_0x56975b=_0x6b3f4d[_0x44f81b(0x1a5)](),_0x20be9a=_0x6b3f4d[_0x44f81b(0x2c1)](),_0x6d737f=_0x57b08a[_0x44f81b(0x2ca)]>0x0?we:0x0,_0x20782e=ne({'row':_0x230075[_0x44f81b(0x216)]+_0x4e9d1c+_0x6d737f,'col':_0x230075[_0x44f81b(0x18f)]},_0x6b3f4d,!0x1,!0x1),_0x313b1f=ne({'row':_0x230075[_0x44f81b(0x216)]+_0x4e9d1c+_0x6d737f+_0x56975b,'col':_0x230075[_0x44f81b(0x18f)]},_0x2579ae,!0x1,!0x0),_0x2088dc=ne({'row':_0x230075[_0x44f81b(0x216)]+_0x4e9d1c+_0x6d737f,'col':_0x230075[_0x44f81b(0x18f)]+_0x20be9a},_0x4755c6,!0x1,!0x0),_0x38b253=ne({'row':_0x230075['row']+_0x4e9d1c+_0x6d737f+_0x56975b,'col':_0x230075[_0x44f81b(0x18f)]+_0x20be9a},_0x334f23,!0x1,!0x1),_0x31b5f6={'rowRanges':_0x313b1f,'colRanges':_0x2088dc,'cornerRanges':_0x20782e,'dataRanges':_0x38b253,'pageRanges':_0x57b08a};return{'matrix':Zo(_0x193da8,_0x230075,_0x32a196),'rangesCache':_0x31b5f6};};var tn=Object['getOwnPropertyDescriptor'],on=(_0x2651b7,_0x1cc114,_0x30fa71,_0xd41083)=>{const _0x294659=_0x429c2e;for(var _0x3e30f7=_0xd41083>0x1?void 0x0:_0xd41083?tn(_0x1cc114,_0x30fa71):_0x1cc114,_0x3b69c9=_0x2651b7[_0x294659(0x2ca)]-0x1,_0xff810e;_0x3b69c9>=0x0;_0x3b69c9--)(_0xff810e=_0x2651b7[_0x3b69c9])&&(_0x3e30f7=_0xff810e(_0x3e30f7)||_0x3e30f7);return _0x3e30f7;},Oe=(_0x2fd6f1,_0x135555)=>(_0x4acd6c,_0x2cb1bc)=>_0x135555(_0x4acd6c,_0x2cb1bc,_0x2fd6f1);exports[_0x429c2e(0x309)]=class extends f[_0x429c2e(0x141)]{constructor(_0xb772a2,_0x135d39,_0x3c694d,_0x4655ee,_0xda2c3b){const _0x4f8efc=_0x429c2e;super(),x(this,_0x4f8efc(0x1a2),new Map()),x(this,_0x4f8efc(0x15b),new Map()),x(this,_0x4f8efc(0x1f9),new Map()),x(this,_0x4f8efc(0x344)),x(this,_0x4f8efc(0x410),new ve[(_0x4f8efc(0x248))]()),x(this,_0x4f8efc(0x25e),this['_collectionChange$'][_0x4f8efc(0x121)]()),x(this,'_viewData$',new ve[(_0x4f8efc(0x248))]()),x(this,_0x4f8efc(0x2a8),this['_viewData$'][_0x4f8efc(0x121)]()),x(this,_0x4f8efc(0x2a0),new ve['Subject']()),x(this,_0x4f8efc(0x373),this[_0x4f8efc(0x2a0)][_0x4f8efc(0x121)]()),x(this,_0x4f8efc(0x178),new Map()),x(this,_0x4f8efc(0x123),[]),x(this,'_queryingMap',new Map()),(this['_injector']=_0xb772a2,this['_univerInstanceService']=_0x135d39,this['_lifecycleService']=_0x3c694d,this[_0x4f8efc(0x20c)]=_0x4655ee,this['_resourceManagerService']=_0xda2c3b,this[_0x4f8efc(0x291)]());}['getTextInfo'](){const _0x47c189=_0x429c2e;return this[_0x47c189(0x344)]?this[_0x47c189(0x344)]:Qo;}['setTextInfo'](_0x428b5e){const _0x10bf09=_0x429c2e;this[_0x10bf09(0x344)]=_0x428b5e;}[_0x429c2e(0x1e2)](_0x243dec){const _0x2d65fa=_0x429c2e;var _0x505cd8;const {from:_0x122366,to:_0x348d70,unitId:_0xd861c4,fromRange:_0x2ecd44,toRange:_0x3ec4b1}=_0x243dec;if(_0x122366&&_0x348d70){const _0x3b0b64=this[_0x2d65fa(0x11c)](_0xd861c4),_0x5b6b31=this[_0x2d65fa(0x1a2)][_0x2d65fa(0x236)](_0xd861c4),_0x53bf8c=(_0x505cd8=this[_0x2d65fa(0x21b)][_0x2d65fa(0x3b9)](_0xd861c4))==null?void 0x0:_0x505cd8[_0x2d65fa(0x3ca)](_0x348d70[_0x2d65fa(0x3c0)]);if(!_0x5b6b31||!_0x53bf8c)return;const _0x48b3f0=_0x53bf8c==null?void 0x0:_0x53bf8c[_0x2d65fa(0x25d)]();for(const [_0x5084b7,_0x2ecad8]of _0x5b6b31[_0x2d65fa(0x261)]())for(const [_0x49016e,_0x11d505]of _0x2ecad8['entries']()){const {sourceRangeInfo:_0x1239fe}=_0x11d505;if(_0x1239fe[_0x2d65fa(0x332)]===_0xd861c4&&_0x1239fe['subUnitId']===_0x122366[_0x2d65fa(0x3c0)]&&f['Rectangle'][_0x2d65fa(0x27e)](_0x2ecd44,_0x1239fe['range'])){const _0x58ae7c={'row':_0x1239fe[_0x2d65fa(0x17f)][_0x2d65fa(0x197)]-_0x2ecd44[_0x2d65fa(0x197)],'col':_0x1239fe[_0x2d65fa(0x17f)][_0x2d65fa(0x198)]-_0x2ecd44[_0x2d65fa(0x198)]},_0x59df1a={'unitId':_0xd861c4,'subUnitId':_0x348d70[_0x2d65fa(0x3c0)],'sheetName':_0x48b3f0,'range':{'startRow':_0x3ec4b1[_0x2d65fa(0x197)]+_0x58ae7c['row'],'endRow':_0x3ec4b1[_0x2d65fa(0x197)]+_0x58ae7c[_0x2d65fa(0x216)]+_0x1239fe[_0x2d65fa(0x17f)]['endRow']-_0x1239fe[_0x2d65fa(0x17f)][_0x2d65fa(0x197)],'startColumn':_0x3ec4b1[_0x2d65fa(0x198)]+_0x58ae7c[_0x2d65fa(0x18f)],'endColumn':_0x3ec4b1['startColumn']+_0x58ae7c[_0x2d65fa(0x18f)]+_0x1239fe[_0x2d65fa(0x17f)][_0x2d65fa(0x1da)]-_0x1239fe[_0x2d65fa(0x17f)][_0x2d65fa(0x198)]}};_0x3b0b64[_0x2d65fa(0x1e2)](_0x49016e,_0x59df1a);const _0x2c251a={..._0x11d505,'sourceRangeInfo':_0x59df1a};this[_0x2d65fa(0x12a)](_0xd861c4,_0x348d70[_0x2d65fa(0x3c0)],_0x49016e,_0x2c251a),this[_0x2d65fa(0x2af)]({'unitId':_0xd861c4,'token':_0x49016e,'type':Se['update'],'oldSourceRangeInfo':_0x1239fe,'dataRangeInfo':_0x59df1a,'targetCellInfo':_0x11d505[_0x2d65fa(0x3d5)]}),this['updateConfig']({'unitId':_0xd861c4,'subUnitId':_0x348d70[_0x2d65fa(0x3c0)],'oldSubUnitId':_0x5084b7,'pivotTableId':_0x49016e,'pivotTableConfig':_0x2c251a,'collectionConfig':_0x3b0b64[_0x2d65fa(0x1e9)]()});}}}}['broadcastCollectionChange'](_0x5081d0){const _0x16b98f=_0x429c2e;this[_0x16b98f(0x410)]['next'](_0x5081d0);}[_0x429c2e(0x11c)](_0x4be36d){const _0x5e8151=_0x429c2e;let _0x44a6e0=this[_0x5e8151(0x178)][_0x5e8151(0x236)](_0x4be36d);return _0x44a6e0||(_0x44a6e0=new Yo(this,this[_0x5e8151(0x21b)]),this[_0x5e8151(0x178)]['set'](_0x4be36d,_0x44a6e0)),_0x44a6e0;}[_0x429c2e(0x302)](_0x1f172e,_0x4d4b57){const _0x2e237b=_0x429c2e;return this[_0x2e237b(0x11c)](_0x1f172e)['collections'][_0x4d4b57];}[_0x429c2e(0x1c7)](_0x37c6c4,_0x2c20dd,_0x5c8712){const _0x1b118a=_0x429c2e;return this[_0x1b118a(0x11c)](_0x37c6c4)[_0x1b118a(0x1c7)](_0x2c20dd,_0x5c8712);}[_0x429c2e(0x135)](_0x334424,_0x50ec83){const _0x4854b7=_0x429c2e;let _0x283219=this[_0x4854b7(0x1a2)][_0x4854b7(0x236)](_0x334424);_0x283219||(_0x283219=new Map(),this[_0x4854b7(0x1a2)]['set'](_0x334424,_0x283219));let _0x2d8486=_0x283219[_0x4854b7(0x236)](_0x50ec83);return _0x2d8486||(_0x2d8486=new Map(),_0x283219[_0x4854b7(0x29b)](_0x50ec83,_0x2d8486)),_0x2d8486;}[_0x429c2e(0x12a)](_0x44b6e6,_0x2cc4fd,_0x7f49b,_0x2ba54b){const _0x2903f3=_0x429c2e;this[_0x2903f3(0x135)](_0x44b6e6,_0x2cc4fd)[_0x2903f3(0x29b)](_0x7f49b,_0x2ba54b);}['_deleteModelCache'](_0x4b632e,_0x36d490,_0x31d013){const _0x43e415=_0x429c2e;var _0x4e85d3,_0x58501c,_0x13bc4a,_0xed3299;((_0x58501c=(_0x4e85d3=this[_0x43e415(0x1a2)][_0x43e415(0x236)](_0x4b632e))==null?void 0x0:_0x4e85d3[_0x43e415(0x236)](_0x36d490))==null?void 0x0:_0x58501c['get'](_0x31d013))&&((_0xed3299=(_0x13bc4a=this[_0x43e415(0x1a2)][_0x43e415(0x236)](_0x4b632e))==null?void 0x0:_0x13bc4a[_0x43e415(0x236)](_0x36d490))==null||_0xed3299[_0x43e415(0x176)](_0x31d013));}[_0x429c2e(0x11b)](_0x248a70,_0x185e08){const _0x111937=_0x429c2e;this[_0x111937(0x15b)][_0x111937(0x29b)](_0x248a70,_0x185e08);}['_deletePivotTableInstanceCache'](_0x5127e6){const _0x1b8311=_0x429c2e;this['_pivotTableInstanceCache'][_0x1b8311(0x176)](_0x5127e6);}[_0x429c2e(0x2eb)](_0x27aedf,_0x14bf97){const _0x27af3f=_0x429c2e;let _0x3d7818=this[_0x27af3f(0x1f9)]['get'](_0x27aedf);_0x3d7818||(_0x3d7818=new Map(),this[_0x27af3f(0x1f9)][_0x27af3f(0x29b)](_0x27aedf,_0x3d7818));let _0x10550b=_0x3d7818['get'](_0x14bf97);return _0x10550b||(_0x10550b=new Map(),_0x3d7818[_0x27af3f(0x29b)](_0x14bf97,_0x10550b)),_0x10550b;}[_0x429c2e(0x355)](_0x262e33){const _0x2bba0a=_0x429c2e,{unitId:_0x277042,subUnitId:_0xa3a0d7,pivotTableId:_0x4e2782,pivotTableConfig:_0x5d74fc,collectionConfig:_0xc9ad03}=_0x262e33,_0x2e7174={'unitId':_0x277042,'subUnitId':_0xa3a0d7,'oldSubUnitId':_0xa3a0d7,'pivotTableId':_0x4e2782,'pivotTableConfig':_0x5d74fc,'collectionConfig':_0xc9ad03};this[_0x2bba0a(0x20c)][_0x2bba0a(0x301)](_t['id'],_0x2e7174,{'onlyLocal':!0x0});}['updateView'](_0x372db4,_0x259eab,_0x520346,_0x1be232,_0x58ddd0,_0x5a1afb,_0x5c131e,_0x102767=!0x1){const _0x1909fd=_0x429c2e;var _0x169bac;this[_0x1909fd(0x20c)][_0x1909fd(0x301)](ot['id'],{'single':{'unitId':_0x372db4,'subUnitId':_0x259eab,'type':_0x520346,'pivotTableId':_0x1be232,'view':_0x58ddd0,'pivotConfig':_0x5a1afb},'collectionConfig':{[_0x372db4]:_0x5c131e}},{'onlyLocal':!0x0});const _0x5983dd=!!((_0x169bac=this['getPivotTableInstance'](_0x1be232))!=null&&_0x169bac['isEmpty']()),_0x5b8c18=this[_0x1909fd(0x2cb)](_0x372db4,_0x259eab,_0x1be232);_0x5b8c18&&this['updateViewData']({'view':_0x58ddd0,'pivotTableId':_0x1be232,'textInfo':this[_0x1909fd(0x28f)](),'isEmpty':_0x5983dd,'targetCellInfo':_0x5b8c18[_0x1909fd(0x3d5)]},_0x102767);}[_0x429c2e(0x336)](_0x103a69,_0x3fb07c){const _0x56590b=_0x429c2e,{targetCellInfo:_0x4d2d65,pivotTableId:_0x5e6929}=_0x103a69,{unitId:_0xf58801,subUnitId:_0x46d99a}=_0x4d2d65,_0x4d5a36=this['_ensureViewDataMap'](_0xf58801,_0x46d99a),_0x56d559=_0x4d5a36[_0x56590b(0x236)](_0x5e6929);let _0x5c8ab7,_0x1c5916;_0x56d559&&(_0x5c8ab7=_0x56d559[_0x56590b(0x258)],_0x1c5916=_0x56d559[_0x56590b(0x3a7)]);const {rangesCache:_0x2db3a2,matrix:_0x4c82ba}=en(_0x103a69);_0x4d5a36[_0x56590b(0x29b)](_0x5e6929,{'rangeCache':_0x2db3a2,'matrix':_0x4c82ba,'oldMatrix':_0x1c5916,'oldRangeCache':_0x5c8ab7}),_0x3fb07c||this[_0x56590b(0x2ed)][_0x56590b(0x33b)]({'unitId':_0xf58801,'subUnitId':_0x46d99a,'pivotTableId':_0x5e6929});}[_0x429c2e(0x3a2)](_0x2e9ed2,_0x1707d0,_0x324f9b,_0x4d17a2,_0x547f97){const _0x1ca5b9=_0x429c2e;this[_0x1ca5b9(0x12a)](_0x2e9ed2,_0x1707d0,_0x324f9b,_0x547f97),this['_updatePivotTableInstanceCache'](_0x324f9b,_0x4d17a2);}[_0x429c2e(0x38d)](_0x1502e0,_0x315370,_0x3bb9e1){const _0x4b1620=_0x429c2e,_0x23ed80=this[_0x4b1620(0x11c)](_0x1502e0);_0x23ed80[_0x4b1620(0x203)](_0x3bb9e1)['forEach'](_0x47f4e5=>{const _0x308caf=_0x4b1620;_0x23ed80[_0x308caf(0x3d4)](_0x47f4e5);}),this[_0x4b1620(0x362)](_0x1502e0,_0x3bb9e1),this['_deleteModelCache'](_0x1502e0,_0x315370,_0x3bb9e1),this[_0x4b1620(0x3f1)](_0x3bb9e1);}[_0x429c2e(0x16d)](_0x5252f0,_0x191b90,_0xec2561,_0x439eff){this['_updateModelCache'](_0x5252f0,_0x191b90,_0xec2561,_0x439eff);}[_0x429c2e(0x2cb)](_0x42ff54,_0xf11748,_0x1e93a1){const _0x255cba=_0x429c2e;var _0x133133,_0x13fb01;const _0x4195ad=(_0x13fb01=(_0x133133=this['_model'][_0x255cba(0x236)](_0x42ff54))==null?void 0x0:_0x133133[_0x255cba(0x236)](_0xf11748))==null?void 0x0:_0x13fb01[_0x255cba(0x236)](_0x1e93a1);if(_0x4195ad)return _0x4195ad;}[_0x429c2e(0x2e2)](_0x5e15aa,_0x15968b,_0x1f9c23){const _0x152405=_0x429c2e;var _0x2932d7,_0x2db537;const _0x3c5a4c=(_0x2db537=(_0x2932d7=this[_0x152405(0x1a2)][_0x152405(0x236)](_0x5e15aa))==null?void 0x0:_0x2932d7['get'](_0x15968b))==null?void 0x0:_0x2db537[_0x152405(0x236)](_0x1f9c23);if(_0x3c5a4c)return _0x3c5a4c[_0x152405(0x371)];}['getPivotTableInstance'](_0x5ae8d7){const _0x236869=_0x429c2e;return this['_pivotTableInstanceCache'][_0x236869(0x236)](_0x5ae8d7);}[_0x429c2e(0x246)](_0x2d62d9){const _0xf02ab4=_0x429c2e;this[_0xf02ab4(0x1a2)][_0xf02ab4(0x176)](_0x2d62d9);const _0x249633=this['_dataFieldManagerCollection']['get'](_0x2d62d9);_0x249633&&(_0x249633[_0xf02ab4(0x2d8)](),this['_dataFieldManagerCollection'][_0xf02ab4(0x176)](_0x2d62d9)),this['_viewData'][_0xf02ab4(0x176)](_0x2d62d9),this[_0xf02ab4(0x123)][_0xf02ab4(0x174)](_0x4ab17e=>{const _0x455f17=_0xf02ab4;_0x4ab17e[_0x455f17(0x246)](_0x2d62d9);});}[_0x429c2e(0x262)](_0x44c472,_0x4335de,_0x40d5f2,_0x565fbf){const _0x1f046a=_0x429c2e;return this[_0x1f046a(0x11c)](_0x40d5f2[_0x1f046a(0x332)])[_0x1f046a(0x262)](_0x44c472,_0x4335de,_0x40d5f2,_0x565fbf);}['createCollectionWithDataRange'](_0x2c43e5){const _0x5f336f=_0x429c2e;return this[_0x5f336f(0x11c)](_0x2c43e5[_0x5f336f(0x332)])[_0x5f336f(0x397)](_0x2c43e5);}['refreshData'](_0x3c1725,_0x9107e7,_0x985746){const _0x45417c=_0x429c2e;this[_0x45417c(0x11c)](_0x985746['unitId'])['refreshData'](_0x3c1725,_0x9107e7,_0x985746);}['removeDataField'](_0x2a0d91,_0x10d7cd){this['getDataFieldManager'](_0x2a0d91)['deleteDataField'](_0x10d7cd);}[_0x429c2e(0x362)](_0x3b451b,_0x1449c1){const _0x38d8a7=_0x429c2e;this[_0x38d8a7(0x11c)](_0x3b451b)[_0x38d8a7(0x170)](_0x1449c1);}[_0x429c2e(0x181)](_0x394192,_0x3bda80){const _0x3368cb=_0x429c2e;var _0x44754c;return(_0x44754c=this[_0x3368cb(0x1a2)][_0x3368cb(0x236)](_0x394192))==null?void 0x0:_0x44754c[_0x3368cb(0x236)](_0x3bda80);}[_0x429c2e(0x2fe)](_0x217175){const _0x452296=_0x429c2e;for(const [_0x595f85,_0x4e37c7]of this[_0x452296(0x1a2)][_0x452296(0x261)]())for(const [_0x14835f,_0x423eda]of _0x4e37c7[_0x452296(0x261)]())if(_0x423eda[_0x452296(0x1d3)](_0x217175))return{'unitId':_0x595f85,'subUnitId':_0x14835f};return null;}[_0x429c2e(0x295)](_0x53c969,_0xc214af,_0x4aabc1,_0x4c6a1f){const _0x29ee74=_0x429c2e,_0x290321=this[_0x29ee74(0x2eb)](_0x53c969,_0xc214af);_0x4c6a1f?_0x290321[_0x29ee74(0x29b)](_0x4aabc1,_0x4c6a1f):_0x290321['delete'](_0x4aabc1),this['_viewData$'][_0x29ee74(0x33b)]({'unitId':_0x53c969,'subUnitId':_0xc214af,'pivotTableId':_0x4aabc1});}[_0x429c2e(0x2d8)](){const _0x133e34=_0x429c2e;super[_0x133e34(0x2d8)]();}[_0x429c2e(0x27d)](_0x1aaf2b,_0x355b5e,_0x4fc14b){const _0x4ec918=_0x429c2e;var _0x36938b,_0x23860d;const _0x2d0d86=(_0x23860d=(_0x36938b=this[_0x4ec918(0x1f9)][_0x4ec918(0x236)](_0x1aaf2b))==null?void 0x0:_0x36938b['get'](_0x355b5e))==null?void 0x0:_0x23860d['get'](_0x4fc14b);return _0x2d0d86||null;}[_0x429c2e(0x34d)](_0xf2677f){const _0x2a40f4=_0x429c2e;this[_0x2a40f4(0x368)](_0xf2677f);}[_0x429c2e(0x368)](_0xb26c74){const _0x5f0cb4=_0x429c2e,{token:_0x6a593b,unitId:_0x581d63,subUnitId:_0x577e5a}=_0xb26c74,_0x1169c4=_0x581d63+'-'+_0x577e5a+'-'+_0x6a593b;this['_queryingMap'][_0x5f0cb4(0x236)](_0x1169c4)&&clearTimeout(this[_0x5f0cb4(0x140)][_0x5f0cb4(0x236)](_0x1169c4));const _0x500c50=setTimeout(()=>{const _0x482d27=_0x5f0cb4;this[_0x482d27(0x3fa)](_0xb26c74),this['_queryingMap']['delete'](_0x1169c4);},Wo);this[_0x5f0cb4(0x140)][_0x5f0cb4(0x29b)](_0x1169c4,_0x500c50);}['queryDirtyPivotTable'](_0xb3ffd2){const _0x10788b=_0x429c2e,{unitId:_0x6011ef,subUnitId:_0x19e3ee,token:_0x13dc83,type:_0x257985,pivotConfig:_0xe2e685}=_0xb3ffd2,_0x41f03d=this['getPivotTableInstance'](_0x13dc83),_0x4fdab0=_0x41f03d==null?void 0x0:_0x41f03d['query'](),_0x5f1599=_0xe2e685!=null?_0xe2e685:this[_0x10788b(0x2cb)](_0x6011ef,_0x19e3ee,_0x13dc83);_0x5f1599&&(_0x5f1599[_0x10788b(0x2f1)]=!!(_0x41f03d!=null&&_0x41f03d['isEmpty']())),(_0x4fdab0||_0x257985===L[_0x10788b(0x40b)])&&this[_0x10788b(0x3be)](_0x6011ef,_0x19e3ee,_0x257985,_0x13dc83,_0x4fdab0,_0x5f1599,this[_0x10788b(0x11c)](_0x6011ef)[_0x10788b(0x1e9)]());}['toJSON'](_0xb1b845){const _0x21d96a=_0x429c2e,_0x25e595={'dataFieldManagerConfig':{},'pivotTableConfigs':{}};if(this[_0x21d96a(0x11c)](_0xb1b845)&&(_0x25e595[_0x21d96a(0x3ed)][_0xb1b845]=this[_0x21d96a(0x11c)](_0xb1b845)[_0x21d96a(0x1e9)]()),this[_0x21d96a(0x1a2)][_0x21d96a(0x236)](_0xb1b845)){_0x25e595[_0x21d96a(0x253)][_0xb1b845]={};const _0xf9279=this[_0x21d96a(0x1a2)][_0x21d96a(0x236)](_0xb1b845);_0xf9279!=null&&_0xf9279[_0x21d96a(0x23b)]&&[..._0xf9279['keys']()][_0x21d96a(0x174)](_0x24a26c=>{const _0x35eca5=_0x21d96a,_0x1761bd=_0xf9279[_0x35eca5(0x236)](_0x24a26c);_0x1761bd!=null&&_0x1761bd[_0x35eca5(0x23b)]&&(_0x25e595[_0x35eca5(0x253)][_0xb1b845][_0x24a26c]={},[..._0x1761bd[_0x35eca5(0x116)]()][_0x35eca5(0x174)](_0x1ec6b7=>{const _0xff8e1e=_0x35eca5,_0x44f620=_0x1761bd[_0xff8e1e(0x236)](_0x1ec6b7);_0x44f620&&(_0x25e595[_0xff8e1e(0x253)][_0xb1b845][_0x24a26c][_0x1ec6b7]=_0x44f620);}));});}return _0x25e595;}[_0x429c2e(0x347)](_0x17ed8b){const _0x9607f8=_0x429c2e;var _0x293ded;const {dataFieldManagerConfig:_0x2746a5,pivotTableConfigs:_0x1f555a}=_0x17ed8b;_0x2746a5&&Object[_0x9607f8(0x116)](_0x2746a5)[_0x9607f8(0x174)](_0x55d7ac=>{this['getDataFieldManager'](_0x55d7ac)['fromJSON'](_0x2746a5[_0x55d7ac]);});const _0x177cec=[];if(_0x1f555a){const _0x3ea94f=(_0x293ded=this[_0x9607f8(0x3b0)]['get'](f['IConfigService'])[_0x9607f8(0x1f2)](ue[_0x9607f8(0x34a)]))!=null?_0x293ded:{},{ls:_0x4011fc,pbk:_0x4959f2}=_0x3ea94f,_0x492339=bt(It,_0x4011fc,_0x4959f2)['count'];Object[_0x9607f8(0x116)](_0x1f555a)[_0x9607f8(0x174)](_0x3c9f2a=>{let _0x28e4f1=0x0;const _0x2731ab=_0x1f555a[_0x3c9f2a];Object['keys'](_0x2731ab)['forEach'](_0x6ee5e1=>{const _0xe78f2=_0x3f2b,_0x2b9641=_0x2731ab[_0x6ee5e1];Object['keys'](_0x2b9641)[_0xe78f2(0x174)](_0x4f7b67=>{const _0x5ae59e=_0xe78f2,_0x3a71d9=_0x2b9641[_0x4f7b67];if(_0x3a71d9){if(_0x28e4f1>=_0x492339)return;_0x28e4f1++;const _0x478395=this[_0x5ae59e(0x11c)](_0x3c9f2a),_0x11b862=_0x478395[_0x5ae59e(0x124)][_0x4f7b67],_0x138be5=_0x11b862[_0x5ae59e(0x2fd)]();let _0x1eb403=0x0;const _0x257b2c=[];for(const _0x5f0275 of _0x138be5){const _0x4e683d=_0x11b862[_0x5ae59e(0x3b4)](_0x5f0275);if(m[_0x5ae59e(0x118)](_0x4e683d)){const _0x14d66e=_0x4e683d[_0x5ae59e(0x11a)](),_0x28b572=_0x11b862[_0x5ae59e(0x3b4)](_0x14d66e);_0x28b572&&_0x257b2c['push']([_0x4e683d,_0x28b572]);continue;}_0x478395[_0x5ae59e(0x122)](_0x5f0275,_0x3a71d9[_0x5ae59e(0x2aa)],_0x1eb403),_0x1eb403++;}_0x257b2c[_0x5ae59e(0x174)](([_0x4bb9b8,_0x5ca5f6])=>{const _0x117b5e=_0x5ae59e;_0x4bb9b8[_0x117b5e(0x114)](_0x5ca5f6);});const _0x5cdaa0=new m['PivotTable'](_0x11b862);_0x5cdaa0[_0x5ae59e(0x347)](_0x3a71d9['fieldsConfig']),this[_0x5ae59e(0x3a2)](_0x3c9f2a,_0x6ee5e1,_0x4f7b67,_0x5cdaa0,_0x3a71d9);const _0x1cc21d=_0x5cdaa0[_0x5ae59e(0x14e)]();_0x177cec[_0x5ae59e(0x390)]({'unitId':_0x3c9f2a,'subUnitId':_0x6ee5e1,'pivotTableId':_0x4f7b67,'view':_0x1cc21d[_0x5ae59e(0x1e9)](),'pivotConfig':_0x3a71d9,'type':L[_0x5ae59e(0x3c3)]});const _0x458d12=!!_0x5cdaa0[_0x5ae59e(0x2f1)](),_0x4dcc76={'view':_0x1cc21d,'pivotTableId':_0x4f7b67,'textInfo':this['getTextInfo'](),'isEmpty':_0x458d12,'targetCellInfo':_0x3a71d9[_0x5ae59e(0x3d5)]};this[_0x5ae59e(0x336)](_0x4dcc76,!0x1);}});});});}_0x2746a5&&Object[_0x9607f8(0x116)](_0x2746a5)['forEach'](_0x2b35f2=>{const _0x4761c3=_0x9607f8,_0x56409e=this[_0x4761c3(0x11c)](_0x2b35f2);this['_fieldsCollectionChange$']['next'](_0x56409e['collections']);}),this[_0x9607f8(0x20c)][_0x9607f8(0x301)](ot['id'],{'batch':_0x177cec,'collectionConfig':_0x2746a5},{'onlyLocal':!0x0});}[_0x429c2e(0x291)](){const _0x3f11f3=_0x429c2e;this[_0x3f11f3(0x1a8)](this[_0x3f11f3(0x3f7)][_0x3f11f3(0x3a8)]({'toJson':_0x41b8e9=>JSON[_0x3f11f3(0x279)](this['toJSON'](_0x41b8e9)),'parseJson':_0x478de0=>{const _0x5d16b3=_0x3f11f3;if(!_0x478de0)return{};try{return JSON[_0x5d16b3(0x2b3)](_0x478de0);}catch{return{};}},'businesses':[f[_0x3f11f3(0x300)]['UNIVER_SHEET']],'pluginName':Ct,'onLoad':(_0x4fe11e,_0x1c5e04)=>{const _0x6bffac=_0x3f11f3;this[_0x6bffac(0x347)](_0x1c5e04);},'onUnLoad':_0x464453=>{const _0x3b9025=_0x3f11f3;this[_0x3b9025(0x246)](_0x464453);}}));}},exports['SheetsPivotDataSourceModel']=on([Oe(0x0,f['Inject'](f['Injector'])),Oe(0x1,f[_0x429c2e(0x193)]),Oe(0x2,f[_0x429c2e(0x297)](f[_0x429c2e(0x13b)])),Oe(0x3,f[_0x429c2e(0x20e)]),Oe(0x4,f[_0x429c2e(0x297)](f['IResourceManagerService']))],exports[_0x429c2e(0x309)]);const nn={0x0:{0x0:{'v':_0x429c2e(0x26f),'s':Y}},0x2:{0x1:{'v':'','s':Y},0x2:{'v':'','s':Y},0x3:{'v':_0x429c2e(0x40c),'s':Y},0x4:{'v':'','s':Y},0x5:{'v':'','s':Y}},0x3:{0x0:{'v':'','s':Y},0x1:{'v':'','s':R},0x2:{'v':'','s':R},0x3:{'v':'','s':R},0x4:{'v':'','s':R},0x5:{'v':'','s':R}},0x4:{0x0:{'v':'','s':Y},0x1:{'v':'','s':R},0x2:{'v':'','s':R},0x3:{'v':'','s':R},0x4:{'v':'','s':R},0x5:{'v':'','s':R}},0x5:{0x0:{'v':'','s':Y},0x1:{'v':'','s':R},0x2:{'v':'','s':R},0x3:{'v':'','s':R},0x4:{'v':'','s':R},0x5:{'v':'','s':R}},0x6:{0x0:{'v':'','s':Y},0x1:{'v':'','s':R},0x2:{'v':'','s':R},0x3:{'v':'','s':R},0x4:{'v':'','s':R},0x5:{'v':'','s':R}},0x7:{0x0:{'v':'','s':Y},0x1:{'v':'','s':R},0x2:{'v':'','s':R},0x3:{'v':'','s':R},0x4:{'v':'','s':R},0x5:{'v':'','s':R}},0x8:{0x0:{'v':_0x429c2e(0x216),'s':Y},0x1:{'v':'','s':R},0x2:{'v':'','s':R},0x3:{'v':_0x429c2e(0x3a6),'s':R},0x4:{'v':'','s':R},0x5:{'v':'','s':R}},0x9:{0x0:{'v':'','s':Y},0x1:{'v':'','s':R},0x2:{'v':'','s':R},0x3:{'v':'','s':R},0x4:{'v':'','s':R},0x5:{'v':'','s':R}},0xa:{0x0:{'v':'','s':Y},0x1:{'v':'','s':R},0x2:{'v':'','s':R},0x3:{'v':'','s':R},0x4:{'v':'','s':R},0x5:{'v':'','s':R}},0xb:{0x0:{'v':'','s':Y},0x1:{'v':'','s':R},0x2:{'v':'','s':R},0x3:{'v':'','s':R},0x4:{'v':'','s':R},0x5:{'v':'','s':R}},0xc:{0x0:{'v':'','s':Y},0x1:{'v':'','s':R},0x2:{'v':'','s':R},0x3:{'v':'','s':R},0x4:{'v':'','s':R},0x5:{'v':'','s':R}},0xd:{0x0:{'v':'','s':Y},0x1:{'v':'','s':R},0x2:{'v':'','s':R},0x3:{'v':'','s':R},0x4:{'v':'','s':R},0x5:{'v':'','s':R}}},Tt={'rowRanges':[{'startRow':0x3,'endRow':0xd,'startColumn':0x0,'endColumn':0x0}],'colRanges':[{'startRow':0x2,'endRow':0x2,'startColumn':0x1,'endColumn':0x5}],'dataRanges':[{'startRow':0x3,'endRow':0xd,'startColumn':0x1,'endColumn':0x5}],'pageRanges':[{'startRow':0x0,'endRow':0x0,'startColumn':0x0,'endColumn':0x0}],'cornerRanges':[]},Kt=(_0x46adfe,_0x431f80)=>{const _0x357444=_0x429c2e,_0x4f2218=new f[(_0x357444(0x2d2))](),_0x31b08e=new f['ObjectMatrix'](nn),{row:_0x348694,col:_0x33a19c}=_0x431f80;_0x31b08e[_0x357444(0x260)]((_0x288136,_0x138c92,_0x431d72)=>{const _0x2e86ab=_0x357444;let _0x5424b5='';_0x431d72['v']==='filter'?_0x5424b5=_0x46adfe[_0x2e86ab(0x26f)]:_0x431d72['v']===_0x2e86ab(0x216)?_0x5424b5=_0x46adfe[_0x2e86ab(0x216)]:_0x431d72['v']===_0x2e86ab(0x40c)?_0x5424b5=_0x46adfe[_0x2e86ab(0x40c)]:_0x431d72['v']===_0x2e86ab(0x3a6)&&(_0x5424b5=_0x46adfe[_0x2e86ab(0x3a6)]),_0x4f2218[_0x2e86ab(0x196)](_0x288136+_0x348694,_0x138c92+_0x33a19c,{..._0x431d72,'v':_0x5424b5});});const _0x5b1788=f[_0x357444(0x149)][_0x357444(0x296)](Tt);return Object[_0x357444(0x116)](Tt)[_0x357444(0x174)](_0x190a25=>{const _0x3ca6b4=_0x357444;_0x5b1788[_0x190a25]=Tt[_0x190a25][_0x3ca6b4(0x1e1)](_0x38d598=>({..._0x38d598,'startRow':_0x38d598[_0x3ca6b4(0x197)]+_0x348694,'endRow':_0x38d598[_0x3ca6b4(0x247)]+_0x348694,'startColumn':_0x38d598[_0x3ca6b4(0x198)]+_0x33a19c,'endColumn':_0x38d598['endColumn']+_0x33a19c}));}),{'matrixCache':_0x4f2218,'rangesCache':_0x5b1788};};function an(_0x3fdb07,_0x383864){const _0x1b0494=_0x429c2e;let _0x311bfb='';const _0x3a6434=this[_0x1b0494(0x28f)]();switch(_0x383864){case m['PivotSubtotalTypeEnum'][_0x1b0494(0x3ad)]:_0x311bfb=_0x3a6434[_0x1b0494(0x17b)]+_0x3fdb07;break;case m[_0x1b0494(0x31d)][_0x1b0494(0x3e6)]:_0x311bfb=_0x3a6434[_0x1b0494(0x342)]+_0x3fdb07;break;case m[_0x1b0494(0x31d)][_0x1b0494(0x311)]:_0x311bfb=_0x3a6434['sheets-pivot.countNumsName']+_0x3fdb07;break;case m['PivotSubtotalTypeEnum']['max']:_0x311bfb=_0x3a6434[_0x1b0494(0x225)]+_0x3fdb07;break;case m[_0x1b0494(0x31d)]['min']:_0x311bfb=_0x3a6434[_0x1b0494(0x227)]+_0x3fdb07;break;case m[_0x1b0494(0x31d)][_0x1b0494(0x1f4)]:_0x311bfb=_0x3a6434[_0x1b0494(0x1e7)]+_0x3fdb07;break;case m[_0x1b0494(0x31d)][_0x1b0494(0x12c)]:_0x311bfb=_0x3a6434[_0x1b0494(0x206)]+_0x3fdb07;break;case m[_0x1b0494(0x31d)][_0x1b0494(0x1a3)]:_0x311bfb=_0x3a6434[_0x1b0494(0x2f8)]+_0x3fdb07;break;case m[_0x1b0494(0x31d)][_0x1b0494(0x2f5)]:_0x311bfb=_0x3a6434['sheets-pivot.sumName']+_0x3fdb07;break;case m[_0x1b0494(0x31d)]['var']:_0x311bfb=_0x3a6434[_0x1b0494(0x1f5)]+_0x3fdb07;break;case m[_0x1b0494(0x31d)][_0x1b0494(0x272)]:_0x311bfb=_0x3a6434['sheets-pivot.varpName']+_0x3fdb07;break;default:_0x311bfb=_0x3fdb07;break;}return _0x311bfb;}function Ht(_0x3a6458,_0x15c601,_0x57fbc4,_0x1ee574,_0x528b93){const _0xd31b35=_0x429c2e;var _0x14b795,_0x4f44ea,_0x45bd47,_0xd3d805,_0x22f10d;const _0x239c32=f[_0xd31b35(0x226)](_0x3a6458,_0x15c601),{rangesInfo:_0x30585f,areaInfo:_0x3c7cd2,headerMap:_0x4028b6}=_0x528b93;if(!_0x30585f||!_0x3c7cd2||!_0x4028b6)return;const _0x26938a=Object[_0xd31b35(0x116)](_0x30585f)[_0xd31b35(0x370)](_0x343270=>_0x30585f[_0x343270][_0xd31b35(0x138)](_0x1ea705=>f[_0xd31b35(0x235)][_0xd31b35(0x27e)](_0x1ea705,_0x239c32))),_0x11ed20=_0x3c7cd2;let _0x246d30,_0x47c60b,_0x28d424;if(_0x26938a===_0xd31b35(0x363))_0x246d30=(_0x14b795=_0x11ed20==null?void 0x0:_0x11ed20['rowInfo'])==null?void 0x0:_0x14b795[_0x3a6458],_0x47c60b=(_0x4f44ea=_0x4028b6==null?void 0x0:_0x4028b6['rowHeaderMap'])==null?void 0x0:_0x4f44ea[_0x15c601],_0x28d424=_0x47c60b==null?void 0x0:_0x47c60b[_0xd31b35(0x112)];else{if(_0x26938a===_0xd31b35(0x31c))_0x246d30=(_0x45bd47=_0x11ed20==null?void 0x0:_0x11ed20['colInfo'])==null?void 0x0:_0x45bd47[_0x15c601],_0x47c60b=(_0xd3d805=_0x4028b6[_0xd31b35(0x244)])==null?void 0x0:_0xd3d805[_0x3a6458+0x1+_0x15c601-_0x30585f[_0xd31b35(0x31c)][0x0][_0xd31b35(0x198)]],_0x28d424=_0x47c60b==null?void 0x0:_0x47c60b[_0xd31b35(0x112)];else{if(_0x26938a===_0xd31b35(0x159))_0x246d30=(_0x22f10d=_0x11ed20==null?void 0x0:_0x11ed20[_0xd31b35(0x33a)])==null?void 0x0:_0x22f10d[_0x15c601],_0x28d424=_0x246d30==null?void 0x0:_0x246d30[_0xd31b35(0x112)];else{if(_0x26938a===_0xd31b35(0x29c)){const _0x404c28=_0x57fbc4==null?void 0x0:_0x57fbc4['fi'];_0x404c28!==void 0x0&&(_0x28d424=_0x1ee574['getFilterFieldIdByIndex'](_0x404c28));}}}}return{'filterId':_0x28d424,'info':_0x246d30,'data':_0x57fbc4,'headerInfo':_0x47c60b};}function Xt(_0x1e6c0e,_0x2816f3,_0x3424db){const _0x101a23=_0x429c2e,_0x33edef=_0x1e6c0e[_0x101a23(0x39e)],_0x39711d=_0x33edef['getFieldIds'](),_0x50d5d0=new Set();_0x1e6c0e[_0x101a23(0x24d)](_0x46b1bc=>{const _0x50af99=_0x101a23;_0x50d5d0[_0x50af99(0x207)](_0x46b1bc[_0x50af99(0x399)]);});const _0x160ce6=_0x39711d[_0x101a23(0x1e1)](_0x5e945e=>{const _0x52948f=_0x101a23,_0x55fb4b=_0x33edef[_0x52948f(0x3b4)](_0x5e945e);return{'checked':_0x50d5d0[_0x52948f(0x1d3)](_0x5e945e),'dataFieldId':_0x55fb4b['id'],'id':_0x55fb4b['id'],'name':_0x33edef[_0x52948f(0x416)](_0x55fb4b['id']),'type':_0x55fb4b[_0x52948f(0x419)](),'pivotTableId':_0x2816f3};}),_0x553aad=[];_0x1e6c0e[_0x101a23(0x41e)](m['PivotTableFiledAreaEnum']['Row'],_0x55e05e=>{const _0x4227cc=_0x101a23;_0x553aad[_0x4227cc(0x390)]({'dataFieldId':_0x55e05e[_0x4227cc(0x399)],'tableFieldId':_0x55e05e['getId'](),'displayName':_0x55e05e[_0x4227cc(0x416)]()});});const _0x3cf7b9=[];_0x1e6c0e[_0x101a23(0x41e)](m[_0x101a23(0x1d8)][_0x101a23(0x26e)],_0x9a9ef3=>{const _0x53e27e=_0x101a23;_0x3cf7b9[_0x53e27e(0x390)]({'dataFieldId':_0x9a9ef3[_0x53e27e(0x399)],'tableFieldId':_0x9a9ef3[_0x53e27e(0x319)](),'displayName':_0x9a9ef3[_0x53e27e(0x416)]()});});const _0x4b5441=[];if(_0x1e6c0e[_0x101a23(0x41e)](m[_0x101a23(0x1d8)]['Value'],_0x18945a=>{const _0x3f9dda=_0x101a23;_0x4b5441[_0x3f9dda(0x390)]({'dataFieldId':_0x18945a[_0x3f9dda(0x399)],'tableFieldId':_0x18945a[_0x3f9dda(0x319)](),'displayName':_0x18945a['getDisplayName'](),'format':_0x18945a[_0x3f9dda(0x162)](),'subTotalType':_0x18945a[_0x3f9dda(0x331)]()});}),_0x4b5441[_0x101a23(0x2ca)]>0x1){const _0x5cb13a=_0x1e6c0e[_0x101a23(0x365)]();(_0x1e6c0e[_0x101a23(0x1d1)]()?_0x3cf7b9:_0x553aad)[_0x101a23(0x357)](_0x5cb13a,0x0,{'dataFieldId':'','tableFieldId':_0x101a23(0x217),'displayName':_0x101a23(0x3bd)});}const _0x24181c=[];_0x1e6c0e[_0x101a23(0x41e)](m['PivotTableFiledAreaEnum']['Filter'],_0x50646c=>{const _0x379528=_0x101a23;_0x24181c['push']({'dataFieldId':_0x50646c[_0x379528(0x399)],'tableFieldId':_0x50646c[_0x379528(0x319)](),'displayName':_0x50646c[_0x379528(0x416)]()});});const _0x5076f0=_0x3424db[_0x101a23(0x2aa)];return{'sourceList':_0x160ce6,'sourceRange':_0x5076f0,'rowFields':_0x553aad,'columnFields':_0x3cf7b9,'valueFields':_0x4b5441,'filterFields':_0x24181c,'positionInfo':_0x3424db['targetCellInfo']};}function Dt(_0x148d00,_0x389a3a,_0x57cf13='',_0x2be41a={}){const _0x562761=_0x429c2e,_0x35d143=_0x148d00['get'](f['LocaleService']);for(const _0x51f4ca in _0x389a3a)if(Object[_0x562761(0x3bf)]['hasOwnProperty']['call'](_0x389a3a,_0x51f4ca)){const _0x4ff453=_0x57cf13?_0x57cf13+'.'+_0x51f4ca:_0x51f4ca;typeof _0x389a3a[_0x51f4ca]==_0x562761(0x257)&&_0x389a3a[_0x51f4ca]!==null&&!Array[_0x562761(0x16e)](_0x389a3a[_0x51f4ca])?Dt(_0x148d00,_0x389a3a[_0x51f4ca],_0x4ff453,_0x2be41a):_0x2be41a[_0x4ff453]=_0x35d143['t'](_0x4ff453);}return _0x2be41a;}const nt=_0x3a2b9d=>{const _0x9779fd=_0x429c2e;if(!_0x3a2b9d)return[];const {rowRanges:_0x36f5cb,colRanges:_0x373af2,cornerRanges:_0x5aef85,dataRanges:_0x51ecc5,pageRanges:_0x549184}=_0x3a2b9d,_0x2c5eb7=[..._0x373af2,..._0x36f5cb,..._0x51ecc5,..._0x5aef85][_0x9779fd(0x26f)](_0x2eda5f=>_0x2eda5f['startRow']>=0x0&&_0x2eda5f['startColumn']>=0x0&&_0x2eda5f['endRow']>=0x0&&_0x2eda5f[_0x9779fd(0x1da)]>=0x0);let _0x46e3d8=Number[_0x9779fd(0x330)],_0x45207d=Number[_0x9779fd(0x2ba)],_0x58b983=Number['MAX_SAFE_INTEGER'],_0x456cb8=Number[_0x9779fd(0x2ba)];for(let _0x820a0c=0x0;_0x820a0c<_0x2c5eb7[_0x9779fd(0x2ca)];_0x820a0c++)_0x46e3d8=Math[_0x9779fd(0x189)](_0x46e3d8,_0x2c5eb7[_0x820a0c][_0x9779fd(0x197)]),_0x45207d=Math[_0x9779fd(0x1ec)](_0x45207d,_0x2c5eb7[_0x820a0c]['endRow']),_0x58b983=Math[_0x9779fd(0x189)](_0x58b983,_0x2c5eb7[_0x820a0c][_0x9779fd(0x198)]),_0x456cb8=Math['max'](_0x456cb8,_0x2c5eb7[_0x820a0c][_0x9779fd(0x1da)]);return[..._0x549184,{'startRow':_0x46e3d8,'endRow':_0x45207d,'startColumn':_0x58b983,'endColumn':_0x456cb8}];};function sn(_0x4f57b3,_0x30bafc){const _0x458e33=_0x429c2e,_0x204eb8=_0x30bafc[_0x458e33(0x1ae)][_0x458e33(0x3d1)],{pivotTableId:_0x759a66,unitId:_0x3c16b1,subUnitId:_0x282b4b}=_0x30bafc;if(!_0x204eb8)return;const _0x32168a=_0x4f57b3[_0x458e33(0x236)](exports['SheetsPivotDataSourceModel']),_0x4f4605=_0x32168a[_0x458e33(0x1ff)](_0x759a66),_0x15613e=_0x32168a[_0x458e33(0x2cb)](_0x3c16b1,_0x282b4b,_0x759a66);if(!_0x4f4605||!_0x15613e)return;const _0x49fd02=_0x4f4605['getIndexesByPathStr'](_0x204eb8['tuple']);if(!(_0x49fd02!=null&&_0x49fd02['length']))return;const _0x4925b7=_0x15613e['sourceRangeInfo'],{unitId:_0x9111f1,subUnitId:_0x175353,range:_0x75be44}=_0x4925b7;let _0x48b1e0=0x0;const _0x202789=_0x4f4605[_0x458e33(0x39e)][_0x458e33(0x2fd)]()[_0x458e33(0x369)]((_0x7c06c2,_0x1f4a2c)=>{var _0x492a3e;const _0x3486ce=(_0x492a3e=_0x4f4605['getDataFieldByDataFieldId'](_0x1f4a2c))==null?void 0x0:_0x492a3e['getformat']();return _0x3486ce&&(_0x7c06c2[String(_0x48b1e0)]=_0x3486ce),_0x48b1e0++,_0x7c06c2;},{});return{'indexes':_0x49fd02,'range':_0x75be44,'sourceUnitId':_0x9111f1,'sourceSubUnitId':_0x175353,'formatMap':_0x202789};}function Et(_0x3b68ff,_0xbc2c49){const _0x448fcf=_0x429c2e;if(!_0x3b68ff||!_0xbc2c49)return!0x0;const _0x52e023=ue[_0x448fcf(0x15c)](qt,Qt),_0x3ef747=new Function(_0x448fcf(0x3e8)+_0x52e023)()(_0x3b68ff,_0xbc2c49)[_0x448fcf(0x158)],_0x8a0a74=ue['isFeatureAuthorizedWithinTime'](_0x3ef747,'sf',Gt);return!((_0x3ef747==null?void 0x0:_0x3ef747['rt'])===ue[_0x448fcf(0x25f)][_0x448fcf(0x34c)]&&!_0x8a0a74);}function bt(_0x43416f,_0x296c4f,_0x48cc33){const _0x2cb5b3=_0x429c2e,_0x4db202={'count':_0x43416f,'timeValid':!0x1};if(!_0x296c4f||!_0x48cc33)return _0x4db202;const _0x9cf3e2=ue['unshiftString'](qt,Qt),_0x2c1919=new Function(_0x2cb5b3(0x3e8)+_0x9cf3e2)()(_0x296c4f,_0x48cc33);if(_0x2c1919!=null&&_0x2c1919[_0x2cb5b3(0x210)]){const _0x1b0a7e=_0x2c1919[_0x2cb5b3(0x158)],_0x414bba=ue['isFeatureAuthorizedWithinTime'](_0x1b0a7e,'sf',Gt);return{'count':ue['getSheetFeatureLimit'](_0x1b0a7e,_0x414bba,'ptn',_0x43416f,_0x43416f,0x0),'timeValid':_0x414bba};}return _0x4db202;}function Nt(_0x103fc0,_0x295a08,_0xd4e7ed,_0x366356){const _0x29e32e=_0x429c2e,_0x5c55e7={'subUnitId':_0xd4e7ed,'unitId':_0x295a08,'cellValue':V[_0x29e32e(0x2f3)](_0x366356)},_0x149e47=V['SetRangeValuesUndoMutationFactory'](_0x103fc0,_0x5c55e7);let _0x17d608=!0x1;return new f[(_0x29e32e(0x2d2))](_0x149e47['cellValue'])[_0x29e32e(0x260)]((_0x5d4ade,_0xa2024f,_0x429574)=>{const _0x37f912=_0x29e32e;if(!_0x17d608&&_0x429574&&(_0x429574[_0x37f912(0x2c6)]||_0x429574['f']||_0x429574['p']||_0x429574['s']||_0x429574['si']||_0x429574['t']||_0x429574['v']))return _0x17d608=!0x0,!0x1;}),{'setRangeValueUndoMutation':{'id':V['SetRangeValuesMutation']['id'],'params':_0x149e47},'setRangeValueRedoMutation':{'id':V[_0x29e32e(0x2cf)]['id'],'params':_0x5c55e7},'shouldClear':_0x17d608};}function Yt(_0x303c73){const {row:_0x30e4fa,col:_0x2f215b}=_0x303c73,_0x5a4a6a={'startRow':_0x30e4fa,'endRow':_0x30e4fa,'startColumn':_0x2f215b,'endColumn':_0x2f215b},_0x1d1754={'startRow':_0x30e4fa+0x2,'endRow':_0x30e4fa+0xe,'startColumn':_0x2f215b,'endColumn':_0x2f215b+0x6};return[_0x5a4a6a,_0x1d1754];}function rn(_0x4bb92d,_0x9d0d,_0x5364f9){const _0x45b00e=_0x429c2e,{cornerView:_0xef55e6,rowView:_0x1fa4d2,colView:_0x5bcdfc,pageView:_0x3f4a84}=_0x4bb92d,{row:_0x559460,col:_0x4be544}=_0x9d0d;if(_0x5364f9)return{'rowCount':Bo+_0x559460,'colCount':Go+_0x4be544};const _0x12d206=_0x3f4a84['lastRow']>-0x1?_0x3f4a84[_0x45b00e(0x237)]+0x1:0x0,_0x53eaaa=_0x3f4a84['lastCol']>-0x1?_0x3f4a84[_0x45b00e(0x318)]:0x0,_0x31bf43=_0x559460+_0x12d206+(_0x12d206?0x1:0x0)+_0xef55e6[_0x45b00e(0x38b)]+_0x1fa4d2[_0x45b00e(0x38b)],_0x4ebb64=_0x4be544+_0x53eaaa,_0x4bbd88=_0x4be544+_0xef55e6[_0x45b00e(0x3ae)]+_0x5bcdfc['colCount'],_0x1371c0=Math[_0x45b00e(0x1ec)](_0x4ebb64,_0x4bbd88);return{'rowCount':_0x31bf43,'colCount':_0x1371c0};}function ce(_0x235d9f,_0x50d40b,_0x405cff,_0x483094){const _0x5979ae=_0x429c2e,{row:_0x202fcc,col:_0x454625,unitId:_0x508827,subUnitId:_0xbcb3f8}=_0x405cff,_0x2cb1d1=rn(_0x50d40b,{'row':_0x202fcc,'col':_0x454625},_0x483094),_0x3d7c5c=_0x235d9f[_0x5979ae(0x236)](f['IUniverInstanceService']),_0x9819ab=V['getSheetCommandTarget'](_0x3d7c5c,{'unitId':_0x508827,'subUnitId':_0xbcb3f8}),_0x4e93c2=[],_0x4af4d9=[];if(!_0x9819ab)return{'undos':_0x4af4d9,'redos':_0x4e93c2};const {worksheet:_0x2d300b}=_0x9819ab,_0xe911a5=_0x2d300b[_0x5979ae(0x1a5)](),_0x3bd340=_0x2d300b[_0x5979ae(0x306)]();return _0xe911a5<_0x2cb1d1[_0x5979ae(0x38b)]&&(_0x4e93c2[_0x5979ae(0x390)]({'id':V['InsertRowMutation']['id'],'params':{'unitId':_0x508827,'subUnitId':_0xbcb3f8,'range':{'startRow':_0xe911a5,'endRow':_0x2cb1d1[_0x5979ae(0x38b)]-0x1,'startColumn':0x0,'endColumn':_0x3bd340-0x1}}}),_0x4af4d9[_0x5979ae(0x390)]({'id':V[_0x5979ae(0x17e)]['id'],'params':{'unitId':_0x508827,'subUnitId':_0xbcb3f8,'range':{'startRow':_0xe911a5,'endRow':_0x2cb1d1[_0x5979ae(0x38b)]-0x1,'startColumn':0x0,'endColumn':_0x3bd340-0x1}}})),_0x3bd340<_0x2cb1d1[_0x5979ae(0x3ae)]&&(_0x4e93c2[_0x5979ae(0x390)]({'id':V[_0x5979ae(0x310)]['id'],'params':{'unitId':_0x508827,'subUnitId':_0xbcb3f8,'range':{'startRow':0x0,'endRow':_0xe911a5-0x1,'startColumn':_0x3bd340,'endColumn':_0x2cb1d1[_0x5979ae(0x3ae)]-0x1}}}),_0x4af4d9[_0x5979ae(0x390)]({'id':V[_0x5979ae(0x16a)]['id'],'params':{'unitId':_0x508827,'subUnitId':_0xbcb3f8,'range':{'startRow':0x0,'endRow':_0xe911a5-0x1,'startColumn':_0x3bd340,'endColumn':_0x2cb1d1[_0x5979ae(0x3ae)]-0x1}}})),{'undos':_0x4af4d9,'redos':_0x4e93c2};}function ln(_0x2ce754){const _0x59f278=_0x429c2e;let _0x42811c=0x0;for(let _0x512f7b=0x0;_0x512f7b<_0x2ce754['length'];_0x512f7b++){const _0x212d0b=_0x2ce754[_0x59f278(0x129)](_0x512f7b);_0x212d0b>=0x4e00&&_0x212d0b<=0x9fff||_0x212d0b>=0x3000&&_0x212d0b<=0x303f||_0x212d0b>=0xff00&&_0x212d0b<=0xffef?_0x42811c+=0x2:_0x42811c+=0x1;}return _0x42811c;}function kt(_0x17f138,_0x2b01c4,_0x59f57c,_0x17b9de){const _0x4bc6e2=_0x429c2e;var _0x4c64cb,_0x3bd988,_0x5d736d,_0x365954;const {rowCount:_0x494bcd,colCount:_0x571415,headerMap:_0x4f1f52}=_0x17f138,_0x5ab665=0x64,_0x59f1c7=Math['min'](_0x494bcd,_0x5ab665),_0x147be8=Math[_0x4bc6e2(0x189)](_0x571415,_0x5ab665);let _0x4ce650='',_0x2811dc=0x0;for(let _0x139705=0x0;_0x139705<_0x59f1c7;_0x139705++)for(let _0x504ee2=0x0;_0x504ee2<_0x147be8;_0x504ee2++){const _0x1834dc={...(_0x3bd988=(_0x4c64cb=_0x17f138['data'])==null?void 0x0:_0x4c64cb[_0x139705])==null?void 0x0:_0x3bd988[_0x504ee2]},_0x27d116=(_0x5d736d=_0x4f1f52[_0x139705])==null?void 0x0:_0x5d736d[_0x4bc6e2(0x112)],_0x14a2de=_0x17b9de[_0x27d116];let _0x198de3=_0x17f138['getValue'](_0x139705,_0x504ee2);if(_0x1834dc){const _0x456ac9=_0x59f57c?_0x504ee2===0x0&&((_0x365954=_0x17f138[_0x4bc6e2(0x2c3)](_0x504ee2+0x1))==null?void 0x0:_0x365954['isValue']):!0x1;_0x198de3=Me(_0x1834dc,_0x456ac9,_0x14a2de,_0x2b01c4);}if(_0x198de3!==void 0x0){const _0x28613e=ln(String(_0x198de3));_0x2811dc<_0x28613e&&(_0x4ce650=String(_0x198de3),_0x2811dc=_0x28613e);}}return _0x4ce650;}function cn(_0xd01af4){const {rowCount:_0x9071ce,colCount:_0x1c21ff}=_0xd01af4;let _0x56c72e='',_0xece416=0x0;for(let _0x446488=_0x9071ce-0x1;_0x446488>0x0&&_0x446488>_0x9071ce-0x3;_0x446488--)for(let _0x3e26b6=0x0;_0x3e26b6<_0x1c21ff;_0x3e26b6++){const _0x53e66a=_0xd01af4['getValue'](_0x446488,_0x3e26b6);if(_0x53e66a!==void 0x0){const _0x579df0=String(_0x53e66a)['length'];_0xece416<_0x579df0&&(_0x56c72e=String(_0x53e66a),_0xece416=_0x579df0);}}return _0x56c72e;}function dn(_0x307e75){const _0x46f6a2=_0x429c2e,{rowCount:_0x2abd95,colCount:_0x382e33}=_0x307e75;let _0x39c7bd='',_0x5428a6=0x0;for(let _0x2bd7cc=0x0;_0x2bd7cc<_0x2abd95;_0x2bd7cc++)for(let _0x22b731=0x0;_0x22b731<_0x382e33;_0x22b731++){const _0x432ce9=_0x307e75[_0x46f6a2(0x3f3)](_0x2bd7cc,_0x22b731);if(_0x432ce9!==void 0x0){const _0x5f135b=String(_0x432ce9)[_0x46f6a2(0x2ca)];_0x5428a6<_0x5f135b&&(_0x39c7bd=String(_0x432ce9),_0x5428a6=_0x5f135b);}}return _0x39c7bd;}function un(_0x54d809,_0x4fe101){const _0x24411e=_0x429c2e,{rowFields:_0x135046,columnFields:_0x56222f,valueFields:_0x592d18,filterFields:_0x1388e9,dimension:_0x16ddfd,measure:_0x1bd4bf}=_0x4fe101;for(const _0x3b8033 of _0x135046){const _0x4e4824=_0x16ddfd[_0x3b8033];_0x4e4824&&_0x54d809[_0x24411e(0x2c9)](_0x4e4824[_0x24411e(0x399)])&&(_0x54d809[_0x24411e(0x16f)](_0x4e4824[_0x24411e(0x399)],m['PivotTableFiledAreaEnum'][_0x24411e(0x110)],void 0x0,_0x3b8033),_0x4e4824['displayName']&&_0x54d809['renameField'](_0x4e4824['id'],_0x4e4824[_0x24411e(0x367)]),_0x4e4824[_0x24411e(0x33c)]&&_0x54d809[_0x24411e(0x287)](_0x4e4824['id'],_0x4e4824['sortInfo']),_0x4e4824[_0x24411e(0x1a4)]&&_0x54d809[_0x24411e(0x1f0)](_0x4e4824['id'],_0x4e4824[_0x24411e(0x1a4)]));}for(const _0x320f9c of _0x56222f){const _0x257d56=_0x16ddfd[_0x320f9c];_0x257d56&&_0x54d809[_0x24411e(0x2c9)](_0x257d56[_0x24411e(0x399)])&&(_0x54d809[_0x24411e(0x16f)](_0x257d56[_0x24411e(0x399)],m[_0x24411e(0x1d8)]['Column'],void 0x0,_0x320f9c),_0x257d56[_0x24411e(0x33c)]&&_0x54d809[_0x24411e(0x287)](_0x257d56['id'],_0x257d56['sortInfo']),_0x257d56['filterInfo']&&_0x54d809[_0x24411e(0x1f0)](_0x257d56['id'],_0x257d56[_0x24411e(0x1a4)]),_0x257d56[_0x24411e(0x367)]&&_0x54d809[_0x24411e(0x350)](_0x257d56['id'],_0x257d56[_0x24411e(0x367)]));}for(const _0x3eca74 of _0x1388e9){const _0x32a2f6=_0x16ddfd[_0x3eca74];_0x32a2f6&&_0x54d809[_0x24411e(0x2c9)](_0x32a2f6[_0x24411e(0x399)])&&(_0x54d809[_0x24411e(0x16f)](_0x32a2f6['dataFieldId'],m[_0x24411e(0x1d8)][_0x24411e(0x1bc)],void 0x0,_0x3eca74),_0x32a2f6[_0x24411e(0x33c)]&&_0x54d809[_0x24411e(0x287)](_0x32a2f6['id'],_0x32a2f6[_0x24411e(0x33c)]),_0x32a2f6[_0x24411e(0x1a4)]&&_0x54d809[_0x24411e(0x1f0)](_0x32a2f6['id'],_0x32a2f6[_0x24411e(0x1a4)]),_0x32a2f6['displayName']&&_0x54d809[_0x24411e(0x350)](_0x32a2f6['id'],_0x32a2f6[_0x24411e(0x367)]));}for(const _0x266252 of _0x592d18){const _0x3e419f=_0x1bd4bf[_0x266252];_0x3e419f&&_0x54d809['getDataFieldByDataFieldId'](_0x3e419f[_0x24411e(0x399)])&&(_0x54d809['addFieldWithSourceId'](_0x3e419f[_0x24411e(0x399)],m['PivotTableFiledAreaEnum'][_0x24411e(0x404)],void 0x0,_0x266252),_0x3e419f['subtotal']!==void 0x0&&_0x54d809[_0x24411e(0x22d)](_0x266252,_0x3e419f[_0x24411e(0x294)]),_0x3e419f[_0x24411e(0x379)]&&_0x54d809[_0x24411e(0x259)](_0x266252,_0x3e419f[_0x24411e(0x379)]),_0x3e419f[_0x24411e(0x367)]&&_0x54d809[_0x24411e(0x350)](_0x3e419f['id'],_0x3e419f[_0x24411e(0x367)]));}const _0x2eb189=_0x4fe101[_0x24411e(0x21d)];for(const {fieldId:_0x412f2e,filterInfo:_0xb723bf}of _0x2eb189)_0x54d809[_0x24411e(0x376)](_0x412f2e,_0xb723bf);}function gn(_0x1c067d,_0x10c3a8){const _0x57f1ef=_0x429c2e,_0x5e2fff=[];_0x10c3a8===m[_0x57f1ef(0x1d8)]['Row']&&_0x1c067d['iterateFieldByArea'](m[_0x57f1ef(0x1d8)][_0x57f1ef(0x110)],_0x24d0db=>{const _0xa64251=_0x57f1ef;_0x5e2fff[_0xa64251(0x390)](_0x24d0db[_0xa64251(0x319)]());}),_0x10c3a8===m['PivotTableFiledAreaEnum'][_0x57f1ef(0x26e)]&&_0x1c067d[_0x57f1ef(0x41e)](m[_0x57f1ef(0x1d8)][_0x57f1ef(0x26e)],_0x283422=>{const _0x3db861=_0x57f1ef;_0x5e2fff[_0x3db861(0x390)](_0x283422[_0x3db861(0x319)]());}),_0x10c3a8===m[_0x57f1ef(0x1d8)][_0x57f1ef(0x1bc)]&&_0x1c067d['iterateFieldByArea'](m[_0x57f1ef(0x1d8)][_0x57f1ef(0x1bc)],_0xc7873d=>{const _0x3f79f7=_0x57f1ef;_0x5e2fff[_0x3f79f7(0x390)](_0xc7873d[_0x3f79f7(0x319)]());}),_0x10c3a8===m[_0x57f1ef(0x1d8)][_0x57f1ef(0x404)]&&_0x1c067d[_0x57f1ef(0x41e)](m['PivotTableFiledAreaEnum'][_0x57f1ef(0x404)],_0x2fa199=>{const _0x561211=_0x57f1ef;_0x5e2fff['push'](_0x2fa199[_0x561211(0x319)]());}),_0x10c3a8===void 0x0&&_0x1c067d['iterateField'](_0x4f1c1e=>{const _0x1a1fa1=_0x57f1ef;_0x5e2fff[_0x1a1fa1(0x390)](_0x4f1c1e[_0x1a1fa1(0x319)]());});const _0x30c828=_0x5e2fff[_0x57f1ef(0x2ca)];for(let _0x152918=_0x30c828-0x1;_0x152918>=0x0;_0x152918--)_0x1c067d['removeField'](_0x5e2fff[_0x152918]);const _0x3586d6=_0x1c067d[_0x57f1ef(0x145)]();for(const _0x43bc3e in _0x3586d6)_0x1c067d[_0x57f1ef(0x2de)](_0x43bc3e);}function fn(_0x53c7c6,_0x1f4499){const _0x55bb21=_0x429c2e,_0x4024bd=new Date(m['excelDateToUnixMilliseconds'](_0x1f4499)),_0x5b6807=new Date(m[_0x55bb21(0x13f)](_0x53c7c6)),_0x308ebf=_0x4024bd[_0x55bb21(0x388)](),_0x576ffe=_0x5b6807[_0x55bb21(0x388)](),_0x54b13d=_0x4024bd['getMonth'](),_0xc17ce9=_0x5b6807[_0x55bb21(0x25b)](),_0x5ef051=_0x4024bd[_0x55bb21(0x2c7)](),_0x40d382=_0x5b6807[_0x55bb21(0x2c7)](),_0x5d4c5e=_0x308ebf===_0x576ffe,_0x5403b1=_0x5d4c5e&&_0x54b13d===_0xc17ce9;return _0x5d4c5e&&_0x5403b1&&!(_0x5403b1&&_0x5ef051===_0x40d382)?m['PivotDateGroupFieldDateTypeEnum'][_0x55bb21(0x2f2)]:_0x5d4c5e&&!_0x5403b1?m[_0x55bb21(0x2ff)]['YearMonth']:m[_0x55bb21(0x2ff)][_0x55bb21(0x1e0)];}function _0x55e4(){const _0x255058=['PIVOT_MUTATION_GENERATE','_ensureViewDataMap','UpdateValuePositionMutation','_viewData$','sheet.mutation.set-pivot-position','fieldId','SetFieldFormat','isEmpty','YearMonthDate','generateNullCell','FORCE_STRING','sum','1447608VJvvkF','_initViewModelBySheetInterceptor','sheets-pivot.stdDevpName','sheets-pivot.blank','UNIVER_SHEET','isDateValue','setOptions','getFieldIds','getTargetByPivotId','PivotDateGroupFieldDateTypeEnum','UniverInstanceType','executeCommand','getCollection','dataRangeInfo','HourMinute','sheets-pivot.emptyPivot.values','getColumnCount','StdDev\x20of\x20','PivotDisplayDataType','SheetsPivotDataSourceModel','getEmptyPivotRanges','unionPivotViewRange','getAutoDisplayName','grandTotal','1998861gGCIfF','sheets-pivot.cellDateGroupDisplay.yearMonthDate','InsertColMutation','countNums','BLANK_PLACEHOLDER','rowHeaderMap','BehaviorSubject','remove','sheet.mutation.pivot-update-value-position','forRow','lastCol','getId','DEFAULT_WORKSHEET_COLUMN_COUNT','Column\x20','colRanges','PivotSubtotalTypeEnum','panel','_onRefRangeChange','dataFields','PivotCallbackEnum','COLUMN','resetPivotTable','UpdatePivotValuePositionCommand','SHEET_PIVOT_EXCLUSIVE_ID','onStarting','sheets-pivot.dateGroup.hour','isPrefixValue','SetPivotFieldsConfigCommand','generateNewSheetName','single','floor','_sheetsPivotDataSourceModel','setPivotCollapse','sheet.mutation.set-pivot-format','MAX_SAFE_INTEGER','getSubtotal','unitId','split','_configVersion$','getSortInfo','updateViewData','_featureCalculationManagerService','rgb(255,255,255)','sheets-pivot.dateGroup.hourMinute','cornerInfo','next','sortInfo','updateCollectionConfig','SheetsPivotTableAdaptorModel','_dataSyncPrimaryController','dateType','getFieldFormat','sheets-pivot.countName','SetFilterInfo','_textInfo','#b2b2b2','sheets-pivot.dateGroup.year','fromJSON','getTypeOfUnitDisposed$','pivotMutationGenerate','LS_CONFIG_KEY','(Blank)','NO_COMMERCIAL','addDirtyPivotTable','pushUndoRedo','updateAllDisplayName','renameField','startCollectChangeset','filterFields','PivotTableChangeTypeEnum','#FFFFFF','updateConfig','createDataFieldId','splice','_ensurePivotTableMatrixInfo','rowFields','_subjectCollectionChange','YearMonth','triggerDirtyFeature','NAME','RemoveSheetsFilterMutation','includes','sheets-pivot.dateGroup.monthDate','InterceptorManager','removeCollections','rowRanges','getRangeKeyList','getValueIndex','registerRefRange','displayName','updateDirtyPivotTable','reduce','maxDate','_sheetsPivotTableConfigModel','getColumnWidth','Xxt9bCQt\x20Wg9I6nbCQt(TC9gtog,\x20nxaTC9cg6)\x20{\x20\x20\x20\x20bI6\x20{\x20\x20\x20\x20\x20\x20\x20\x209Qtob\x20TC9gtogBtXQjEIbhIIE6\x20=\x20TC9gtog.onTCb(\x27-\x27);\x20\x20\x20\x20\x20\x20\x20\x209Qtob\x20QICGCt7gooEGg\x20=\x204d21.nEIog(EbQa(TC9gtogBtXQjEIbhIIE6[5]));\x20\x20\x20\x20\x20\x20\x20\x20CX\x20(!QICGCt7gooEGg.xW)\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20QICGCt7gooEGg.xW\x20=\x201xmagI(TC9gtogBtXQjEIbhIIE6[H]);\x20\x20\x20\x20\x20\x20\x20\x20}\x20\x20\x20\x20\x20\x20\x20\x209Qtob\x20Co0QIfgI\x20=\x20b6ngQX\x200QIfgI3TQaETd9Qng\x20!==\x20\x27xtWgXCtgW\x27\x20&&\x20ogTX\x20CtobEt9gQX\x200QIfgI3TQaETd9Qng;\x20\x20\x20\x20\x20\x20\x20\x209Qtob\x209Qtbgkb\x20=\x20Co0QIfgI\x20?\x20ogTX\x20:\x20ZCtWQZ;\x20\x20\x20\x20\x20\x20\x20\x209Qtob\x20mgooEGg0QIW\x20=\x209Qtbgkb.__8EogRH__.nEIog(TC9gtogBtXQjEIbhIIE6[5]);\x20\x20\x20\x20\x20\x20\x20\x209Qtob\x20mgooEGg\x20=\x209Qtbgkb.__igk__.obICtGCX6(mgooEGg0QIW);\x20\x20\x20\x20\x20\x20\x20\x209Qtob\x20oCGtEbxIg0QIW\x20=\x209Qtbgkb.__8EogRH__.nEIog(TC9gtogBtXQjEIbhIIE6[N]);\x20\x20\x20\x20\x20\x20\x20\x209Qtob\x20oCGtEbxIg\x20=\x209Qtbgkb.__igk__.obICtGCX6(oCGtEbxIg0QIW);\x20\x20\x20\x20\x20\x20\x20\x209Qtob\x20oCGtKETCW\x20=\x209Qtbgkb.__JgICX6__(oCGtEbxIg,\x20mgooEGg,\x20nxaTC9cg6);\x20\x20\x20\x20\x20\x20\x20\x209Qtob\x20WQmECt\x20=\x20QICGCt7gooEGg.Wm;\x20\x20\x20\x20\x20\x20\x20\x20Xxt9bCQt\x20CosQmECt7Eb9eCtG(QjEbbgIt,\x20QiQob)\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x209Qtob\x20nEbbgIt\x20=\x20QjEbbgIt.IgnTE9g(/^.+/,\x20\x27\x27);\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x209Qtob\x20eQob\x20=\x20QiQob.IgnTE9g(/^.+/,\x20\x27\x27);\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x209Qtob\x20nEbbgItjEIbo\x20=\x20nEbbgIt.onTCb(\x27.\x27);\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x209Qtob\x20eQobjEIbo\x20=\x20eQob.onTCb(\x27.\x27);\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CX\x20(!nEbbgIt.Ct9TxWgo(\x27*\x27))\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20IgbxIt\x20nEbbgIt\x20===\x20eQob;\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CX\x20(nEbbgItjEIbo.TgtGbe\x20<\x205\x20||\x20nEbbgItjEIbo[P]\x20!==\x20\x27*\x27)\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20IgbxIt\x20XETog;\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x209Qtob\x20nEbbgItdxXXCk\x20=\x20nEbbgItjEIbo.oTC9g(w).lQCt(\x27.\x27);\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x209Qtob\x20eQobdxXXCk\x20=\x20eQobjEIbo.oTC9g(-nEbbgItjEIbo.TgtGbe\x20+\x20w).lQCt(\x27.\x27);\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20IgbxIt\x20nEbbgItdxXXCk\x20===\x20eQobdxXXCk;\x20\x20\x20\x20\x20\x20\x20\x20}\x20\x20\x20\x20\x20\x20\x20\x20Tgb\x20WQmECtKETCW\x20=\x20(WQmECt\x20&&\x20WQmECt.TgtGbe)\x20?\x20WQmECt.oQmg((WmBbgm)\x20=>\x20CosQmECt7Eb9eCtG(WmBbgm,\x20TQ9EbCQt.eQobtEmg))\x20:\x20bIxg;\x20\x20\x20\x20\x20\x20\x20\x20CX\x20(TQ9EbCQt.eQobtEmg\x20===\x20\x27TQ9ETeQob\x27)\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20WQmECtKETCW\x20=\x20bIxg;\x20\x20\x20\x20\x20\x20\x20\x20}\x20\x20\x20\x20\x20\x20\x20\x209Qtob\x20JETCW\x20=\x20oCGtKETCW\x20&&\x20WQmECtKETCW;\x20\x20\x20\x20\x20\x20\x20\x20IgbxIt\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20JETCW,\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20mgooEGg:\x20QICGCt7gooEGg,\x20\x20\x20\x20\x20\x20\x20\x20};\x20\x20\x20\x20}\x209Eb9e\x20(gIIQI)\x20{\x20\x20\x20\x20\x20\x20\x20\x20IgbxIt\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20JETCW:\x20XETog,\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20mgooEGg:\x20{},\x20\x20\x20\x20\x20\x20\x20\x20};\x20\x20\x20\x20}}','width','iterateFieldDim','find','fieldsConfig','NotName','fieldsCollectionChange$','endCollectChangeset','random','setValueFilterInfo','SetSubtotalType','#e6ebfa','format','getFieldCountByArea','sheets-pivot.dateGroup.yearQuarter','_init','setConfig','SetPivotFilterMutation','updateFieldPosition','ErrorType','pbt','getPivotTableMatrixInfo','AddPivotField','setValuePivotFilter','DataField','merge','InterceptorEffectEnum','getFullYear','setDataRecordCount','DEFAULT_PIVOT_NUMBER','rowCount','SetPivotFilterCommand','removePivotTable','SetPivotCollapseMutation','level','push','updatePivotTableMatrixInfo','getAutoFitColumnsMutations','setCollapse','RemoveSheetCommand','isValue','_globalComputedStartHelpFunc','createCollectionWithDataRange','AsyncInterceptorManager','dataFieldId','batch','UpdatePivotTableSourceRangeCommand','collapseInfo','addCollection','dataFieldsCollection','numfmt','removeValueFilterInfoByValueFieldId','getPivotTableCellData','addPivotTable','getAutoDisplayNameFunction','sheet.command.set-pivot-value-filter','Panel','values','matrix','registerPluginResource','update','STRING','originTargetInfo','3905034wSuAce','average','colCount','markDirty','_injector','RANGE_TYPE','MoveRangeCommand','PivotDrillDownCommand','getFieldById','UpdatePivotSource','CellValueType','RemovePivotField','formJSON','getUnit','_initCommandInterceptListener','_pivotRenderValueMatrixCache','setRangeValueUndoMutation','Value','updateView','prototype','subUnitId','getDataFieldBySourceName','fetchThroughInterceptors','Add','ResetPivotFieldsConfigCommand','dataStream','sourceName','_refRangeService','rangeKeyMap','PivotCellStyleTypeEnum','getSheetBySheetId','markDirty$','Style','intersects','_requestResolvers','rgb(240,241,243)','SetWorksheetColWidthMutation','drillDown','number','_pivotTableRangeInfo','deleteDataField','targetCellInfo','SetSortInfo','SetPivotValueFilterCommand','getPivotDirtyViewInfo','body','valueIndex','Values','string','InsertSheetUndoMutationFactory','InsertSheetCommand','new','SheetsPivotRPCService','_updateRenderEmptyCache','updateValuePosition','deleteField','handleSourceRangeChange','sheet.mutation.send-pivot-view-local','count','from','return\x20','Month','sheets-pivot.dateGroup.minute','sheet.command.add-pivot-table-with-config','getTextSize','dataFieldManagerConfig','pivotConfigChange$','sheets-pivot.dateGroup.month','_configService','_deletePivotTableInstanceCache','Average\x20of\x20','getValue','updateViewInfo','undos','error','_resourceManagerService','generateMutationsByRanges','sheet.mutation.remove-group-collection','queryDirtyPivotTable','sheet.mutation.set-pivot-filter','Div0','generateRandomId','realDeleteValue','_generateUniqueVersion','PivotView','movePivotField','3235869rtkgWd','info','Value','interceptCommand','fieldIds','_sheetsPivotTableAdaptorModel','CustomCommandExecutionError','MovePivotField','registerCommand','Delete','column','sheet.mutation.pivot-update-field-position','Minute','prefix','_collectionChange$','sheets-pivot.cellDateGroupDisplay.yearMonth','existing','Count\x20of\x20','sheet.mutation.get-pivot-data-local','SheetsPivotTableService','getDisplayName','AddPivotFieldMutation','type','getFieldDataType','getSheetCommandTarget','getAdjustRangesPosition','[Pivot\x20Table]:\x20Target\x20cell\x20is\x20out\x20of\x20range','setRangeValueRedoMutation','iterateFieldByArea','asyncInterceptor','clearExclusiveRangesByGroupId','transFromCellValue','viewUpdate$','Row','ResetPivotTable','tableFieldId','areaInfo','refreshGroupField','onQueryStart','keys','getCurrentUnitForType','isBaseGroupField','_sheetsSelectionsService','getOriginFieldId','_updatePivotTableInstanceCache','getDataFieldManager','limit\x20pivot','workbook\x20is\x20not\x20found','blank','getPivotTableIdByCell','asObservable','refreshDataField','needSameDeleteModel','collections','_exclusiveRangeService','getSourceName','data','removeField','charCodeAt','_updateModelCache','mergeWorksheetSnapshotWithDefault','stdDev','getSheets','dateGroupField','RemoveSheetMutation','_initUnitDisposed','PivotDataFieldDataTypeEnum','_getAutoName','_pivotInitCompleted$','symbol','_ensurePivotMap','notExecuteFormula','collectionConfig','some','MoveRangeMutation','DateGroupField','LifecycleService','dimension','_viewUpdate$','getInsertRowColMutations','excelDateToUnixMilliseconds','_queryingMap','Disposable','setName','REF','AddPivotTableCommand','getValueFilterInfos','clearRenderCache','columnFields','setPivotSort','Tools','LocaleService','getRangeKey','YearQuarter','INTERCEPTOR_POINT','query','332620yFRrfU','setTextInfo','getActiveSheet','addPivotField','setPivotFilter','getMatrixFromRunTimeData','unshift','pivotTableIndexConfig','CELL_CONTENT','message','cornerRanges','register','_pivotTableInstanceCache','unshiftString','_initPivotDataGetListener','oldRangeInfo','getSubUnitPivotRenderCache','sheet.command.update-pivot-value-position','updatePivotTableRangeInfo','getFormat','18805020BypTsW','name','RemovePivotFieldMutation','_subjectViewChange','getRangeStartEndInfo','leafStyle','sheets-pivot.subTotal','RemoveColMutation','getCellMatrix','getPivotTableInfo','setPivotTable','isArray','addFieldWithSourceId','removeCollectionImp','StdDevp\x20of\x20','SetWorksheetActiveOperation','sheets-pivot.cellDateGroupDisplay.hour','forEach','sheet.mutation.add-pivot-field','delete','sheet.mutation.remove-pivot-field','_dataFieldManagerCollection','2XzKWDv','valueFields','sheets-pivot.averageName','isDate','_pivotTableMatrixInfo','RemoveRowMutation','range','handleAsyncResponse','getSubUnitPivotConfigs','_globalSubject','setPivotTableConfig','sheets.tabs.sheet','measure','bind','PivotErrorTypeEnum','addDataFieldWithoutUnitInfo','min','initDataRanges','isNaN','AddPivotTableWithConfigCommand','getPivotItemRenderInfoCache','_initConfig','col','collection','getMatrixValue','_host','IUniverInstanceService','Plugin','sheets-pivot.cellDateGroupDisplay.yearQuarter','setValue','startRow','startColumn','setPivotInitCompleted','UniverSheetsPivotTablePlugin','sheets-pivot.cellDateGroupDisplay.month','addExclusiveRange','result','#1d32e9','_ensurePivotTableRangeInfo','sheets-pivot.cellDateGroupDisplay.date','_initLocale','_model','stdDevp','filterInfo','getRowCount','getSheetBySheetName','_sheetsPivotTableService','disposeWithMe','Total','setRangeKeyMap','getFieldPositionInfoById','770398VCuBaw','NUMBER','params','onCommandExecuted','getInterceptPoints','sheet.command.move-pivot-table','Injector','getFontStyleString','sheets-pivot.emptyPivot.row','getformat','Date','sheet.command.set-pivot-field-setting','NORMAL','serializeRangeWithSpreadsheet','_initDataSendListener','removeDataField','Filter','registerDirtyService','SHEET_PIVOT_TABLE_PLUGIN','sheets-pivot.dateGroup.date','sheet.command.reset-pivot-fields-config','updatePivotSource','getIntersectsPivotTable','NotFunction','#f4f4f5','sequenceExecute','MonthDate','getUpdateRangeDeleteIds','None','removePivotField','pushComputingStatusSubject','toStringTag','updateRenderCache','setRange','Set','SetPivotFieldFormatMutation','defineProperty','isColMultiMeasure','setPivotSetting','has','createInterceptorKey','SetPivotFilter','getLastRow','setDateType','PivotTableFiledAreaEnum','intercept','endColumn','sheet.mutation.set-pivot-sort-info','SetPivotCollapse','sheet.command.pivot-drill-down','SetPivotSort','shouldClear','Year','map','handleMoveRange','sheet.mutation.update-date-group','SetCollapse','versions','sheet.command.update-pivot-table-source-range','sheets-pivot.productName','sheet.command.add-pivot-table','toJSON','_initRemoveSheetCommandInterceptor','UpdateDateGroupCommand','max','updateDataFieldsCollection','disposableCollection','SetPivotValueFilterMutation','setLabelFilterInfo','leftOffset','getConfig','GlobalConfig','product','sheets-pivot.varName','SheetInterceptorService','Sum\x20of\x20','sheets-pivot.columnName','_viewData','fetchThroughAsyncInterceptors','getLastCol','getTargetByPivotTableId','value','rangesInfo','getPivotTableInstance','setDirty','sheet.command.update-date-group','PivotTable','getNoUsedDataFieldIds','RefRangeService','MUTATION','sheets-pivot.stdDevName','add','headerMap','getDataFieldByTableId','IConfigService','_sheetsPivotRpcService','_commandService','sheet.mutation.add-group-collection','ICommandService','SetPivotPositionMutation','valid','interceptor','getDataFieldByRangeKey','sheet.mutation.rename-pivot-field','sheet.mutation.send-init-pivot-text-local','slice','row','PivotMultipleValueId','addRecord','sheet.operation.pivot-table-view-formula-mark-dirty','_initRegisterCommand','_univerInstanceService','rangeType','valueFilter','dataStyle','fields','createLabelField','getValuePosition','getRefRangeMutationsByMoveRange','Varp\x20of\x20','SheetsPivotTableConfigModel','sheets-pivot.maxName','cellToRange','sheets-pivot.minName','paths','UpdateValuePosition','SetOptions','UpdateFieldPosition','AddPivotFieldCommand','setSubtotalType','generateSetRangeValueMutations','BadReference','other','Hour','Grand\x20Total','_getPivotAppliedRanges','_pivotRenderInfoCache','Rectangle','get','lastRow','sheet.command.set-pivot-collapse','getPivotDisplayConfig','Subtotal','size','_globalComputingSrv','AddPivotTableWithConfig','IActiveDirtyManagerService','ManualFilter','RemovePivotFieldCommand','Quarter','getSheetId','subscribe','colHeaderMap','SetPivotTableConfig','deleteUnitId','endRow','Subject','RemoveField','getFieldInfo','_globalComputedEndHelpFunc','DEFAULT_WORKSHEET_ROW_COUNT','iterateField','getTableFieldById','UpdatePivotTableSourceRangeMutation','FontCache','getUnitId','#e6ebfb','pivotTableConfigs','sheet.command.remove-pivot-field','pivotTableId','getFilterInfo','object','rangeCache','setFieldFormat','updateRangeKeyMap','getMonth','adjustSheetCellData','getName','collectionChange$','ReleaseType','forValue','entries','addCollectionByJSON','InsertSheetMutation','PivotTableOperationEnum','AddPivotTable','ClearSelectionAllCommand','sheets-pivot.config','onQueryEnd','applyChangeSet','AddPivotTableMutation','generateHexNumber','sheets-pivot.dateGroup.yearMonthDate','UpdateFieldPositionMutation','Column','filter','getStyles','SetPivotSortCommand','varp','36nzlZWa','sheets-pivot.emptyPivot.column','_localeService','updateConfigCache','SetValuePivotFilter','DataSyncPrimaryController','stringify','sheet.mutation.set-pivot-field-subtotal-type','getCellRaw','AddField','getViewData','contains','Max\x20of\x20','COMMAND','_config','options','Product\x20of\x20','PivotTableValuePositionEnum','uniqueDataFieldName','MovePivotFieldCommand','setSortInfo','Var\x20of\x20','updateFieldSourceInfo','document','getPivotPerformCheck','isDateGroupField','isBottomTotal','sheet.mutation.set-pivot-option','getTextInfo','fontRenderExtension','_initSnapshot','_markDirty$','_initPivotTextInfo','subtotal','sideEffectUpdateWorkerCache','deepClone','Inject','rangeKey','SetPivotSetting','_initGlobalComputed','set','pageRanges','sheetName','SHEETS_PIVOT_PLUGIN_CONFIG_KEY','_activeDirtyManagerService','_fieldsCollectionChange$','getIntersects','registerCallbackWithEvent','subTotalStyle','reset','getMatrix','redos','_createExclusiveRange','viewData$','_refRangeHandle','sourceRangeInfo','getOwnPropertyDescriptor','version','getRangeData','addField','broadcastCollectionChange','DisposableCollection','IUndoRedoService','New','parse','pageStyle','concat','addPivotTableWithConfig','sheet.command.set-pivot-sort','numberToABC','UpdateSource','MIN_SAFE_INTEGER','node','sheet.command.add-pivot-field','Min\x20of\x20','substring','PivotViewCellValueTypeEnum','getFormatInfo','getColCount','pivotInitCompleted$','getHeaderMapItem','isDateGroupFieldJSON','sheets-pivot.value','custom','getDate','_ensurePivotItemRenderValueMatrixCache','getDataFieldByDataFieldId','length','getPivotTableConfig','_ensurePivotItemRenderInfoCache','SetPivotCollapseCommand','getDataFieldItemInfo','SetRangeValuesMutation','removeSourceRangeChange','date','ObjectMatrix','FieldsCollection','_toJSON','_collectionConfigModel','_subjectFieldsCollectionChange','refreshData','dispose','21HWdUIu','RenamePivotFieldMutation','sheet.mutation.add-pivot-table','getFieldListByArea','#eceeff','removeValueFilterInfo','CommandType','_sheetInterceptorService','getDataFieldId','getPivotTableModelConfig','getCurrentSelections','hasField','_pivotConfigChange$','RemovePivotTableMutation','colStyle','DrillDown','PivotFilterTypeEnum'];_0x55e4=function(){return _0x255058;};return _0x55e4();}function zt(_0x2a5030,_0x186fa7){const _0x295f5d=_0x429c2e,_0x3baa3e=_0x2a5030[_0x295f5d(0x236)](exports[_0x295f5d(0x309)])['getTextInfo']();let _0x2882ad='';switch(_0x186fa7){case m['PivotDateGroupFieldDateTypeEnum'][_0x295f5d(0x2f2)]:_0x2882ad=_0x3baa3e[_0x295f5d(0x26c)];break;case m[_0x295f5d(0x2ff)][_0x295f5d(0x35b)]:_0x2882ad=_0x3baa3e['sheets-pivot.dateGroup.yearMonth'];break;case m[_0x295f5d(0x2ff)][_0x295f5d(0x1e0)]:_0x2882ad=_0x3baa3e[_0x295f5d(0x346)];break;case m['PivotDateGroupFieldDateTypeEnum'][_0x295f5d(0x3e9)]:_0x2882ad=_0x3baa3e[_0x295f5d(0x3ef)];break;case m[_0x295f5d(0x2ff)]['Quarter']:_0x2882ad=_0x3baa3e['sheets-pivot.dateGroup.quarter'];break;case m[_0x295f5d(0x2ff)][_0x295f5d(0x1b6)]:_0x2882ad=_0x3baa3e[_0x295f5d(0x1bf)];break;case m[_0x295f5d(0x2ff)][_0x295f5d(0x304)]:_0x2882ad=_0x3baa3e[_0x295f5d(0x339)];break;case m[_0x295f5d(0x2ff)][_0x295f5d(0x231)]:_0x2882ad=_0x3baa3e[_0x295f5d(0x327)];break;case m[_0x295f5d(0x2ff)][_0x295f5d(0x40e)]:_0x2882ad=_0x3baa3e[_0x295f5d(0x3ea)];break;case m[_0x295f5d(0x2ff)][_0x295f5d(0x1c6)]:_0x2882ad=_0x3baa3e[_0x295f5d(0x360)];break;case m['PivotDateGroupFieldDateTypeEnum'][_0x295f5d(0x14c)]:_0x2882ad=_0x3baa3e[_0x295f5d(0x37b)];break;default:_0x2882ad='';break;}return _0x2882ad;}const Ut=_0x429c2e(0x267),jt={};function _0x3f2b(_0x53cb9c,_0x20c0f7){const _0x55e4b9=_0x55e4();return _0x3f2b=function(_0x3f2b67,_0x3c4bfe){_0x3f2b67=_0x3f2b67-0x110;let _0x2d790b=_0x55e4b9[_0x3f2b67];return _0x2d790b;},_0x3f2b(_0x53cb9c,_0x20c0f7);}var vn=Object[_0x429c2e(0x2ab)],hn=(_0x2c53ac,_0x1e9713,_0x34c190,_0x1366ed)=>{for(var _0x27c6a6=_0x1366ed>0x1?void 0x0:_0x1366ed?vn(_0x1e9713,_0x34c190):_0x1e9713,_0x1e4123=_0x2c53ac['length']-0x1,_0x3a1409;_0x1e4123>=0x0;_0x1e4123--)(_0x3a1409=_0x2c53ac[_0x1e4123])&&(_0x27c6a6=_0x3a1409(_0x27c6a6)||_0x27c6a6);return _0x27c6a6;},Ae=(_0x3e314a,_0x3e3bed)=>(_0x3d0873,_0x514f47)=>_0x3e3bed(_0x3d0873,_0x514f47,_0x3e314a);exports['SheetsPivotTableConfigModel']=class extends f['Disposable']{constructor(_0x2efec8,_0x35e529,_0x3957e7,_0x43b35c,_0x12b360){const _0x490eca=_0x429c2e;super(),x(this,_0x490eca(0x1a2),new Map()),x(this,'_collectionConfigModel',new Map()),x(this,_0x490eca(0x3d3),new Map()),x(this,_0x490eca(0x17d),new Map()),x(this,_0x490eca(0x334),new ve['Subject']()),x(this,_0x490eca(0x133),new ve[(_0x490eca(0x248))]()),x(this,'pivotInitCompleted$',this[_0x490eca(0x133)][_0x490eca(0x121)]()),x(this,_0x490eca(0x2e5),new ve[(_0x490eca(0x248))]()),x(this,_0x490eca(0x3ee),this['_pivotConfigChange$']['asObservable']()),x(this,_0x490eca(0x344),{}),x(this,'configVersion$',this[_0x490eca(0x334)]['asObservable']()),(this[_0x490eca(0x3b0)]=_0x2efec8,this[_0x490eca(0x20c)]=_0x35e529,this['_univerInstanceService']=_0x3957e7,this['_resourceManagerService']=_0x43b35c,this[_0x490eca(0x3f0)]=_0x12b360,this[_0x490eca(0x1a1)](),this[_0x490eca(0x130)]());const _0x52ba0c=this[_0x490eca(0x3f0)]['getConfig'](Ut);(_0x52ba0c==null?void 0x0:_0x52ba0c[_0x490eca(0x136)])===!0x0&&this[_0x490eca(0x291)]();}[_0x429c2e(0x130)](){const _0x539e0d=_0x429c2e;this[_0x539e0d(0x1a8)](this['_univerInstanceService'][_0x539e0d(0x348)](f[_0x539e0d(0x300)][_0x539e0d(0x2fa)])[_0x539e0d(0x243)](_0xfda8e=>{const _0x1a65d7=_0x539e0d;this[_0x1a65d7(0x246)](_0xfda8e[_0x1a65d7(0x251)]());}));}[_0x429c2e(0x199)](){const _0x5ccc1e=_0x429c2e;this[_0x5ccc1e(0x133)]['next'](!0x0);}[_0x429c2e(0x1a1)](){const _0x4d1f07=_0x429c2e,_0x264c3a=Dt(this[_0x4d1f07(0x3b0)],Wt,'',{});this[_0x4d1f07(0x344)]=_0x264c3a,this['_commandService']['executeCommand'](Rt['id'],{'textInfo':_0x264c3a},{'onlyLocal':!0x0});}[_0x429c2e(0x28f)](){const _0x2633e2=_0x429c2e;return this[_0x2633e2(0x344)];}[_0x429c2e(0x3f4)](_0x1313b2,_0x3bf5bc,_0x1fa07a,_0xb896b1,_0x24ad94){const _0x54a9cf=_0x429c2e;this[_0x54a9cf(0x391)](_0x1313b2,_0x3bf5bc,_0x1fa07a,_0xb896b1),this[_0x54a9cf(0x161)](_0x1313b2,_0x3bf5bc,_0x1fa07a,_0x24ad94);}['getPivotTableConfig'](_0xcdd599,_0x5705ee,_0x42e7c1){const _0x4fe148=_0x429c2e;var _0x24afbd;const _0x244777=(_0x24afbd=this['_model'][_0x4fe148(0x236)](_0xcdd599))==null?void 0x0:_0x24afbd['get'](_0x5705ee);if(_0x244777)return _0x244777[_0x4fe148(0x236)](_0x42e7c1);}[_0x429c2e(0x1fc)](_0x43c0aa,_0x129061){const _0x8fcc7f=_0x429c2e,_0x5f53dd=this['_model']['get'](_0x43c0aa);if(_0x5f53dd){for(const [_0x2ea512,_0xe9df82]of _0x5f53dd['entries']())for(const [_0x4cf963,_0x4f1cd6]of _0xe9df82[_0x8fcc7f(0x261)]())if(_0x4cf963===_0x129061)return _0x4f1cd6[_0x8fcc7f(0x3d5)];}}['getTargetByPivotId'](_0x5d8324,_0x2036b8,_0x359f0a){const _0x1e5178=_0x429c2e,_0x1457d8=this[_0x1e5178(0x2cb)](_0x5d8324,_0x2036b8,_0x359f0a);return _0x1457d8==null?void 0x0:_0x1457d8[_0x1e5178(0x3d5)];}[_0x429c2e(0x181)](_0x1b37cb,_0x4c65d4){const _0x396321=_0x429c2e;var _0x1c49a2;return(_0x1c49a2=this[_0x396321(0x1a2)][_0x396321(0x236)](_0x1b37cb))==null?void 0x0:_0x1c49a2[_0x396321(0x236)](_0x4c65d4);}[_0x429c2e(0x276)](_0x44f07f,_0x3d82e9,_0x2ef9f2,_0x2a044f){const _0x20f076=_0x429c2e,_0x44048f=this['_ensurePivotMap'](_0x44f07f,_0x3d82e9);_0x2a044f?_0x44048f['set'](_0x2ef9f2,_0x2a044f):_0x44048f[_0x20f076(0x176)](_0x2ef9f2),this['_pivotConfigChange$']['next']({'unitId':_0x44f07f,'subUnitId':_0x3d82e9,'pivotTableId':_0x2ef9f2,'pivotTableConfig':_0x2a044f});}['getCollection'](_0x21a112,_0x992f2b){const _0x13ce93=_0x429c2e;var _0x5bb77f;return(_0x5bb77f=this[_0x13ce93(0x2d5)][_0x13ce93(0x236)](_0x21a112))==null?void 0x0:_0x5bb77f[_0x13ce93(0x124)][_0x992f2b];}[_0x429c2e(0x33d)](_0x1a29d5,_0x42dd52){const _0x416532=_0x429c2e;this[_0x416532(0x2d5)]['set'](_0x1a29d5,_0x42dd52),this[_0x416532(0x334)][_0x416532(0x33b)](Math[_0x416532(0x375)]());}[_0x429c2e(0x135)](_0x460bbd,_0x1dca9e){const _0x291ba7=_0x429c2e;let _0x35d243=this[_0x291ba7(0x1a2)][_0x291ba7(0x236)](_0x460bbd);_0x35d243||(_0x35d243=new Map(),this[_0x291ba7(0x1a2)][_0x291ba7(0x29b)](_0x460bbd,_0x35d243));let _0x114497=_0x35d243[_0x291ba7(0x236)](_0x1dca9e);return _0x114497||(_0x114497=new Map(),_0x35d243['set'](_0x1dca9e,_0x114497)),_0x114497;}[_0x429c2e(0x19f)](_0xbe2a8c,_0x7fe135){const _0x213b4a=_0x429c2e;let _0x35f55c=this['_pivotTableRangeInfo'][_0x213b4a(0x236)](_0xbe2a8c);_0x35f55c||(_0x35f55c=new Map(),this[_0x213b4a(0x3d3)][_0x213b4a(0x29b)](_0xbe2a8c,_0x35f55c));let _0xe23dbe=_0x35f55c[_0x213b4a(0x236)](_0x7fe135);return _0xe23dbe||(_0xe23dbe=new Map(),_0x35f55c['set'](_0x7fe135,_0xe23dbe)),_0xe23dbe;}['_ensurePivotTableMatrixInfo'](_0x35f53a,_0x588aa8){const _0x4338c2=_0x429c2e;let _0x3c8e40=this[_0x4338c2(0x17d)][_0x4338c2(0x236)](_0x35f53a);_0x3c8e40||(_0x3c8e40=new Map(),this['_pivotTableMatrixInfo'][_0x4338c2(0x29b)](_0x35f53a,_0x3c8e40));let _0x39ba37=_0x3c8e40['get'](_0x588aa8);return _0x39ba37||(_0x39ba37=new Map(),_0x3c8e40[_0x4338c2(0x29b)](_0x588aa8,_0x39ba37)),_0x39ba37;}['updatePivotTableRangeInfo'](_0x1c0ad2,_0x2ea39e,_0x4f8eb1,_0x108881){const _0x319c8d=_0x429c2e;var _0xf84856;const _0x242827=this[_0x319c8d(0x19f)](_0x1c0ad2,_0x2ea39e),_0x32b821=(_0xf84856=_0x242827[_0x319c8d(0x236)](_0x4f8eb1))==null?void 0x0:_0xf84856[_0x319c8d(0x15e)];_0x242827['set'](_0x4f8eb1,{'oldRangeInfo':_0x32b821,'rangeInfo':_0x108881});}['updatePivotTableMatrixInfo'](_0x55abb1,_0x34c6b3,_0x384353,_0x314825){const _0x4ac0a3=_0x429c2e;var _0x2c8680;const _0x301da8=this[_0x4ac0a3(0x358)](_0x55abb1,_0x34c6b3),_0x588f03=(_0x2c8680=_0x301da8[_0x4ac0a3(0x236)](_0x384353))==null?void 0x0:_0x2c8680['oldMatrix'];_0x301da8[_0x4ac0a3(0x29b)](_0x384353,{'oldMatrix':_0x588f03,'matrix':_0x314825});}['getPivotTableRangeInfo'](_0x2f9ece,_0x66abc5,_0x304c78){const _0x14accd=_0x429c2e;var _0x198e4d,_0x4c167f;return(_0x4c167f=(_0x198e4d=this[_0x14accd(0x3d3)][_0x14accd(0x236)](_0x2f9ece))==null?void 0x0:_0x198e4d[_0x14accd(0x236)](_0x66abc5))==null?void 0x0:_0x4c167f[_0x14accd(0x236)](_0x304c78);}[_0x429c2e(0x382)](_0x311862,_0x6173aa,_0x547553){const _0x15ce58=_0x429c2e;var _0x5b0916,_0x1fbb41;return(_0x1fbb41=(_0x5b0916=this[_0x15ce58(0x17d)][_0x15ce58(0x236)](_0x311862))==null?void 0x0:_0x5b0916[_0x15ce58(0x236)](_0x6173aa))==null?void 0x0:_0x1fbb41['get'](_0x547553);}[_0x429c2e(0x246)](_0x140097){const _0x17e1a4=_0x429c2e;this['_model'][_0x17e1a4(0x176)](_0x140097),this['_collectionConfigModel'][_0x17e1a4(0x176)](_0x140097);}[_0x429c2e(0x2d4)](_0x56cee5){const _0x5ec1ba=_0x429c2e,_0x46961b={'dataFieldManagerConfig':{},'pivotTableConfigs':{}};if(this[_0x5ec1ba(0x2d5)][_0x5ec1ba(0x236)](_0x56cee5)&&(_0x46961b[_0x5ec1ba(0x3ed)][_0x56cee5]=this[_0x5ec1ba(0x2d5)][_0x5ec1ba(0x236)](_0x56cee5)),this[_0x5ec1ba(0x1a2)][_0x5ec1ba(0x236)](_0x56cee5)){_0x46961b['pivotTableConfigs'][_0x56cee5]={};const _0x5d5824=this[_0x5ec1ba(0x1a2)]['get'](_0x56cee5);_0x5d5824!=null&&_0x5d5824[_0x5ec1ba(0x23b)]&&[..._0x5d5824['keys']()][_0x5ec1ba(0x174)](_0xf32e93=>{const _0x417e55=_0x5ec1ba,_0x2b5f10=_0x5d5824[_0x417e55(0x236)](_0xf32e93);_0x2b5f10!=null&&_0x2b5f10[_0x417e55(0x23b)]&&(_0x46961b[_0x417e55(0x253)][_0x56cee5][_0xf32e93]={},[..._0x2b5f10[_0x417e55(0x116)]()][_0x417e55(0x174)](_0x2f200c=>{const _0x51f028=_0x417e55,_0x3182b1=_0x2b5f10[_0x51f028(0x236)](_0x2f200c);_0x3182b1&&(_0x46961b[_0x51f028(0x253)][_0x56cee5][_0xf32e93][_0x2f200c]=_0x3182b1);}));});}return _0x46961b;}[_0x429c2e(0x291)](){const _0x11c3cb=_0x429c2e;this[_0x11c3cb(0x1a8)](this[_0x11c3cb(0x3f7)][_0x11c3cb(0x3a8)]({'toJson':_0x74ea4c=>JSON[_0x11c3cb(0x279)](this[_0x11c3cb(0x2d4)](_0x74ea4c)),'parseJson':_0x7b42a0=>({}),'businesses':[f[_0x11c3cb(0x300)]['UNIVER_SHEET']],'pluginName':Ct,'onLoad':(_0x53f371,_0x52f249)=>{},'onUnLoad':_0x50bf14=>{const _0x494ebf=_0x11c3cb;this[_0x494ebf(0x246)](_0x50bf14);}}));}},exports[_0x429c2e(0x224)]=hn([Ae(0x0,f[_0x429c2e(0x297)](f['Injector'])),Ae(0x1,f[_0x429c2e(0x297)](f[_0x429c2e(0x20e)])),Ae(0x2,f[_0x429c2e(0x297)](f[_0x429c2e(0x193)])),Ae(0x3,f[_0x429c2e(0x297)](f['IResourceManagerService'])),Ae(0x4,f['Inject'](f['IConfigService']))],exports[_0x429c2e(0x224)]);var pn=Object[_0x429c2e(0x2ab)],mn=(_0x2b5451,_0x4f90d0,_0x762d78,_0x498baa)=>{const _0xc656d6=_0x429c2e;for(var _0xb2dcde=_0x498baa>0x1?void 0x0:_0x498baa?pn(_0x4f90d0,_0x762d78):_0x4f90d0,_0x1f2c3a=_0x2b5451[_0xc656d6(0x2ca)]-0x1,_0x5ecd19;_0x1f2c3a>=0x0;_0x1f2c3a--)(_0x5ecd19=_0x2b5451[_0x1f2c3a])&&(_0xb2dcde=_0x5ecd19(_0xb2dcde)||_0xb2dcde);return _0xb2dcde;},ke=(_0x51324c,_0x131e44)=>(_0x455d62,_0x33b1c5)=>_0x131e44(_0x455d62,_0x33b1c5,_0x51324c);exports[_0x429c2e(0x33e)]=class extends f['Disposable']{constructor(_0x1c7a1e,_0x79fcf7,_0x4361d5,_0x43ebbb,_0x197c69){const _0x3f4f07=_0x429c2e;super(),x(this,_0x3f4f07(0x234),new Map()),x(this,'_pivotRenderValueMatrixCache',new Map()),x(this,_0x3f4f07(0x292),new ve[(_0x3f4f07(0x248))]()),x(this,_0x3f4f07(0x3cb),this[_0x3f4f07(0x292)][_0x3f4f07(0x121)]()),x(this,_0x3f4f07(0x13d),new ve['Subject']()),x(this,_0x3f4f07(0x422),this[_0x3f4f07(0x13d)]['asObservable']()),x(this,_0x3f4f07(0x344)),(this[_0x3f4f07(0x275)]=_0x1c7a1e,this['_injector']=_0x79fcf7,this[_0x3f4f07(0x36b)]=_0x4361d5,this['_univerInstanceService']=_0x43ebbb,this[_0x3f4f07(0x125)]=_0x197c69,this[_0x3f4f07(0x1a1)](),this[_0x3f4f07(0x130)]());}[_0x429c2e(0x130)](){const _0x1fc760=_0x429c2e;this[_0x1fc760(0x1a8)](this[_0x1fc760(0x21b)][_0x1fc760(0x348)](f[_0x1fc760(0x300)][_0x1fc760(0x2fa)])[_0x1fc760(0x243)](_0x524f91=>{const _0x3ea863=_0x1fc760;this[_0x3ea863(0x246)](_0x524f91[_0x3ea863(0x251)]());}));}['_initLocale'](){const _0x33489d=_0x429c2e;this[_0x33489d(0x344)]=Dt(this[_0x33489d(0x3b0)],Wt,'',{});}['updateRenderCache'](_0x26d2f3){const _0x40ca52=_0x429c2e,{view:_0x3a8f54,unitId:_0x182ee4,subUnitId:_0x39fafd,pivotTableId:_0x29df26,type:_0x4501d8}=_0x26d2f3,_0x2e956e=this[_0x40ca52(0x36b)][_0x40ca52(0x2cb)](_0x182ee4,_0x39fafd,_0x29df26);if(!_0x3a8f54||!_0x2e956e||_0x4501d8===L['Delete'])return;const {pageView:_0x4d5b6c,cornerView:_0x57b915,rowView:_0x1ad653,colView:_0x2fa02a,dataView:_0x5e126a}=_0x3a8f54,_0x477d85=_0x2e956e[_0x40ca52(0x3d5)],_0x703af4=_0x2e956e[_0x40ca52(0x2f1)],_0x3c0dc8=this['_ensurePivotItemRenderValueMatrixCache'](_0x182ee4,_0x39fafd),_0x4eccd4=this[_0x40ca52(0x2cc)](_0x182ee4,_0x39fafd,_0x29df26);if(_0x703af4)return this[_0x40ca52(0x3e1)](_0x26d2f3,_0x3c0dc8,_0x477d85,_0x4eccd4);{const _0x5fee33=ne(_0x477d85,_0x4d5b6c,!0x0),_0x132511=_0x4d5b6c[_0x40ca52(0x237)]>=0x0?_0x4d5b6c[_0x40ca52(0x237)]+0x1:0x0,_0x3bb944=_0x57b915[_0x40ca52(0x1a5)](),_0x518d7a=_0x57b915[_0x40ca52(0x2c1)](),_0x3d029d=_0x5fee33[_0x40ca52(0x2ca)]>0x0?we:0x0,_0x44c928=ne({'row':_0x477d85[_0x40ca52(0x216)]+_0x132511+_0x3d029d,'col':_0x477d85[_0x40ca52(0x18f)]},_0x57b915,!0x1,!0x1),_0x17818d=ne({'row':_0x477d85['row']+_0x132511+_0x3d029d+_0x3bb944,'col':_0x477d85['col']},_0x1ad653,!0x1,!0x0),_0x488c52=ne({'row':_0x477d85[_0x40ca52(0x216)]+_0x132511+_0x3d029d,'col':_0x477d85[_0x40ca52(0x18f)]+_0x518d7a},_0x2fa02a,!0x1,!0x0),_0x231729=ne({'row':_0x477d85[_0x40ca52(0x216)]+_0x132511+_0x3d029d+_0x3bb944,'col':_0x477d85[_0x40ca52(0x18f)]+_0x518d7a},_0x5e126a,!0x1,!0x1);_0x4eccd4[_0x40ca52(0x1fe)]={'rowRanges':_0x17818d,'colRanges':_0x488c52,'cornerRanges':_0x44c928,'dataRanges':_0x231729,'pageRanges':_0x5fee33};const _0x23dc70=Jo(this['_injector'],_0x3a8f54,_0x2e956e,this[_0x40ca52(0x344)]),{valueMatrix:_0x501a81,rowInfo:_0x428653,colInfo:_0xa66be8,cornerInfo:_0x4ab531,rowHeaderMap:_0x149417,colHeaderMap:_0x5c2cae}=_0x23dc70;return _0x4eccd4[_0x40ca52(0x113)]={'rowInfo':_0x428653,'colInfo':_0xa66be8,'cornerInfo':_0x4ab531},_0x4eccd4[_0x40ca52(0x208)]={'rowHeaderMap':_0x149417,'colHeaderMap':_0x5c2cae},_0x501a81[_0x40ca52(0x174)]((_0x558fb0,_0x3688a8)=>{const _0x52ddbc=_0x40ca52;Object[_0x52ddbc(0x116)](_0x3688a8)['forEach'](_0x2c0cd1=>{const _0x30a580=_0x52ddbc,_0x506845=+_0x2c0cd1,_0x4b0b68=_0x501a81[_0x30a580(0x3f3)](_0x558fb0,_0x506845);_0x3c0dc8[_0x30a580(0x196)](_0x558fb0,_0x506845,_0x4b0b68);});}),this[_0x40ca52(0x13d)]['next']({'unitId':_0x182ee4,'subUnitId':_0x39fafd,'valueMatrix':_0x3c0dc8,'rangesCache':_0x4eccd4['rangesInfo'],'pivotTableId':_0x29df26,'type':_0x26d2f3['type']}),this['_sheetsPivotTableConfigModel'][_0x40ca52(0x3f4)](_0x182ee4,_0x39fafd,_0x29df26,_0x3c0dc8,_0x4eccd4['rangesInfo']),this[_0x40ca52(0x125)][_0x40ca52(0x19c)](_0x182ee4,_0x39fafd,Pt,this['_createExclusiveRange'](_0x4eccd4['rangesInfo'],_0x29df26)),{'rangeCache':_0x4eccd4[_0x40ca52(0x1fe)],'matrix':_0x3c0dc8};}}[_0x429c2e(0x3e1)](_0x5a45e2,_0x1723d8,_0x42c2b0,_0x50001d){const _0x49c18e=_0x429c2e,_0x52a559=this[_0x49c18e(0x275)]['t'],{unitId:_0x97bf1e,subUnitId:_0x520d9c,pivotTableId:_0x251842}=_0x5a45e2,_0x166a3f={'filter':_0x52a559('sheets-pivot.emptyPivot.filter'),'row':_0x52a559(_0x49c18e(0x1b4)),'column':_0x52a559(_0x49c18e(0x274)),'values':_0x52a559(_0x49c18e(0x305))},{matrixCache:_0x540fbc,rangesCache:_0x2ba637}=Kt(_0x166a3f,_0x42c2b0);return _0x540fbc['forValue']((_0x256276,_0x554f00,_0x364318)=>{const _0x1c972e=_0x49c18e;_0x1723d8[_0x1c972e(0x196)](_0x256276,_0x554f00,_0x364318);}),_0x50001d[_0x49c18e(0x1fe)]=_0x2ba637,this[_0x49c18e(0x13d)][_0x49c18e(0x33b)]({'unitId':_0x97bf1e,'subUnitId':_0x520d9c,'valueMatrix':_0x1723d8,'rangesCache':_0x2ba637,'pivotTableId':_0x251842,'type':_0x5a45e2['type'],'isEmpty':!0x0}),this['_sheetsPivotTableConfigModel'][_0x49c18e(0x3f4)](_0x97bf1e,_0x520d9c,_0x251842,_0x1723d8,_0x2ba637),this[_0x49c18e(0x125)]['addExclusiveRange'](_0x97bf1e,_0x520d9c,Pt,this[_0x49c18e(0x2a7)](_0x2ba637,_0x251842)),{'rangeCache':_0x50001d[_0x49c18e(0x1fe)],'matrix':_0x1723d8};}['_createExclusiveRange'](_0xebd68e,_0x537f75){const _0x5d4d60=_0x429c2e,_0x231eef=[],_0x5eaf95=nt(_0xebd68e);for(const _0x3f8e54 of _0x5eaf95)_0x231eef[_0x5d4d60(0x390)]({'groupId':_0x537f75,'range':_0x3f8e54});return _0x231eef;}[_0x429c2e(0x146)](_0xbc483b){const _0x318ff6=_0x429c2e;var _0x4c4a63,_0x3ec853,_0x283ee6,_0x26ea2f;const {pivotTableId:_0x2c6631,unitId:_0x40016b,subUnitId:_0x488256}=_0xbc483b;if(!_0x2c6631||!_0x40016b||!_0x488256)return;const _0x5dbc1c=this['_ensurePivotItemRenderValueMatrixCache'](_0x40016b,_0x488256),_0x38f79a=(_0x3ec853=(_0x4c4a63=this[_0x318ff6(0x234)][_0x318ff6(0x236)](_0x40016b))==null?void 0x0:_0x4c4a63[_0x318ff6(0x236)](_0x488256))==null?void 0x0:_0x3ec853[_0x318ff6(0x236)](_0x2c6631);if(_0x38f79a!=null&&_0x38f79a[_0x318ff6(0x1fe)]){for(const _0x5f2779 of Object[_0x318ff6(0x116)](_0x38f79a[_0x318ff6(0x1fe)]))_0x38f79a['rangesInfo'][_0x5f2779][_0x318ff6(0x174)](_0x52244d=>{const _0x2715a2=_0x318ff6;for(let _0x11d4a8=_0x52244d[_0x2715a2(0x197)];_0x11d4a8<=_0x52244d[_0x2715a2(0x247)];_0x11d4a8++)for(let _0x372581=_0x52244d['startColumn'];_0x372581<=_0x52244d[_0x2715a2(0x1da)];_0x372581++)_0x5dbc1c[_0x2715a2(0x3fe)](_0x11d4a8,_0x372581);});}_0x38f79a&&((_0x26ea2f=(_0x283ee6=this[_0x318ff6(0x234)][_0x318ff6(0x236)](_0x40016b))==null?void 0x0:_0x283ee6[_0x318ff6(0x236)](_0x488256))==null||_0x26ea2f[_0x318ff6(0x176)](_0x2c6631)),this['_viewUpdate$'][_0x318ff6(0x33b)]({'unitId':_0x40016b,'subUnitId':_0x488256,'valueMatrix':_0x5dbc1c,'pivotTableId':_0x2c6631,'rangesCache':void 0x0,'type':_0xbc483b['type']}),this[_0x318ff6(0x125)][_0x318ff6(0x420)](_0x40016b,_0x488256,Pt,_0x2c6631);}[_0x429c2e(0x2cc)](_0x195457,_0x3fda6c,_0xd819c9){const _0x5cab88=_0x429c2e;var _0x1f98fc,_0x38dce0,_0xc3b04b,_0x2655f4,_0xbf62d1,_0x1c4626;return this[_0x5cab88(0x234)][_0x5cab88(0x1d3)](_0x195457)||this[_0x5cab88(0x234)][_0x5cab88(0x29b)](_0x195457,new Map()),(_0x1f98fc=this[_0x5cab88(0x234)][_0x5cab88(0x236)](_0x195457))!=null&&_0x1f98fc['has'](_0x3fda6c)||(_0x38dce0=this[_0x5cab88(0x234)]['get'](_0x195457))==null||_0x38dce0[_0x5cab88(0x29b)](_0x3fda6c,new Map()),(_0x2655f4=(_0xc3b04b=this[_0x5cab88(0x234)][_0x5cab88(0x236)](_0x195457))==null?void 0x0:_0xc3b04b[_0x5cab88(0x236)](_0x3fda6c))!=null&&_0x2655f4[_0x5cab88(0x1d3)](_0xd819c9)||(_0x1c4626=(_0xbf62d1=this['_pivotRenderInfoCache'][_0x5cab88(0x236)](_0x195457))==null?void 0x0:_0xbf62d1[_0x5cab88(0x236)](_0x3fda6c))==null||_0x1c4626[_0x5cab88(0x29b)](_0xd819c9,{}),this[_0x5cab88(0x234)][_0x5cab88(0x236)](_0x195457)['get'](_0x3fda6c)[_0x5cab88(0x236)](_0xd819c9);}[_0x429c2e(0x2c8)](_0x531751,_0x298438){const _0x3d8049=_0x429c2e;var _0x44d05a,_0x149e0b;return this[_0x3d8049(0x3bb)][_0x3d8049(0x1d3)](_0x531751)||this[_0x3d8049(0x3bb)][_0x3d8049(0x29b)](_0x531751,new Map()),(_0x44d05a=this[_0x3d8049(0x3bb)][_0x3d8049(0x236)](_0x531751))!=null&&_0x44d05a[_0x3d8049(0x1d3)](_0x298438)||(_0x149e0b=this['_pivotRenderValueMatrixCache'][_0x3d8049(0x236)](_0x531751))==null||_0x149e0b['set'](_0x298438,new f['ObjectMatrix']()),this['_pivotRenderValueMatrixCache']['get'](_0x531751)['get'](_0x298438);}[_0x429c2e(0x3a1)](_0x79aa7f,_0x5b0d46,_0x5b2efd,_0x1ef33f){const _0x4cccc4=_0x429c2e;var _0x36a97a,_0x4d7845;const _0x20692a=(_0x4d7845=(_0x36a97a=this[_0x4cccc4(0x3bb)][_0x4cccc4(0x236)](_0x79aa7f))==null?void 0x0:_0x36a97a[_0x4cccc4(0x236)](_0x5b0d46))==null?void 0x0:_0x4d7845[_0x4cccc4(0x3f3)](_0x5b2efd,_0x1ef33f);if(_0x20692a!=null)return _0x20692a;}['getPivotTableIdByCell'](_0x3252e8,_0x473340,_0x1c84fd,_0x2d4fa4){const _0x65f9fe=_0x429c2e;var _0x2f5fcc;const _0x335136=f[_0x65f9fe(0x226)](_0x1c84fd,_0x2d4fa4),_0xa42675=(_0x2f5fcc=this[_0x65f9fe(0x234)]['get'](_0x3252e8))==null?void 0x0:_0x2f5fcc[_0x65f9fe(0x236)](_0x473340);return _0xa42675?Array[_0x65f9fe(0x3e7)](_0xa42675['keys']())[_0x65f9fe(0x370)](_0x2bd2eb=>{const _0x27c434=_0x65f9fe,_0x3a430f=_0xa42675['get'](_0x2bd2eb),_0x4b5808=_0x3a430f==null?void 0x0:_0x3a430f['rangesInfo'];return _0x4b5808?Object[_0x27c434(0x116)](_0x4b5808)[_0x27c434(0x138)](_0xa4ecb1=>_0x4b5808[_0xa4ecb1][_0x27c434(0x138)](_0x87c69b=>f[_0x27c434(0x235)]['contains'](_0x87c69b,_0x335136))):!0x1;}):void 0x0;}[_0x429c2e(0x1c2)](_0xc9e23f,_0x205326,_0x5cfaff){const _0x3f3d48=_0x429c2e;var _0x3b944f;const _0x133572=(_0x3b944f=this[_0x3f3d48(0x234)][_0x3f3d48(0x236)](_0xc9e23f))==null?void 0x0:_0x3b944f['get'](_0x205326),_0x46cd23=[];return _0x133572&&Array[_0x3f3d48(0x3e7)](_0x133572[_0x3f3d48(0x116)]())['forEach'](_0x5b9768=>{const _0x46206a=_0x3f3d48,_0x212821=_0x133572[_0x46206a(0x236)](_0x5b9768),_0x50be74=_0x212821==null?void 0x0:_0x212821[_0x46206a(0x1fe)];if(_0x50be74)for(const _0x35b23f of Object['values'](_0x50be74)){let _0x1bed2a=!0x1;for(const _0x49a653 of _0x35b23f)if(f[_0x46206a(0x235)][_0x46206a(0x3cd)](_0x49a653,_0x5cfaff)){_0x46cd23['push'](_0x5b9768),_0x1bed2a=!0x0;break;}if(_0x1bed2a)break;}}),_0x46cd23;}['getSubUnitPivotMatrix'](_0x2be551,_0x39d9c0){const _0x52d24a=_0x429c2e;var _0x55620a,_0x35c8f4;return(_0x35c8f4=(_0x55620a=this[_0x52d24a(0x3bb)][_0x52d24a(0x236)](_0x2be551))==null?void 0x0:_0x55620a[_0x52d24a(0x236)](_0x39d9c0))!=null?_0x35c8f4:new f[(_0x52d24a(0x2d2))]();}[_0x429c2e(0x15f)](_0x2b41ee,_0x43955f){const _0xcc907e=_0x429c2e;var _0x128bf1;return(_0x128bf1=this[_0xcc907e(0x234)][_0xcc907e(0x236)](_0x2b41ee))==null?void 0x0:_0x128bf1[_0xcc907e(0x236)](_0x43955f);}[_0x429c2e(0x18d)](_0x5b60ec,_0x10a83c,_0x44991e){const _0x1266b5=_0x429c2e;var _0x3d3e50,_0x351385;return(_0x351385=(_0x3d3e50=this[_0x1266b5(0x234)][_0x1266b5(0x236)](_0x5b60ec))==null?void 0x0:_0x3d3e50[_0x1266b5(0x236)](_0x10a83c))==null?void 0x0:_0x351385[_0x1266b5(0x236)](_0x44991e);}[_0x429c2e(0x246)](_0x3ae65b){const _0x51a9f4=_0x429c2e;this[_0x51a9f4(0x234)][_0x51a9f4(0x176)](_0x3ae65b),this['_pivotRenderValueMatrixCache']['delete'](_0x3ae65b);}[_0x429c2e(0x3af)](_0x1738f4,_0x458fc1){const _0x35fa3e=_0x429c2e;this[_0x35fa3e(0x292)][_0x35fa3e(0x33b)]({'unitId':_0x1738f4,'subUnitId':_0x458fc1});}},exports[_0x429c2e(0x33e)]=mn([ke(0x0,f[_0x429c2e(0x297)](f[_0x429c2e(0x14a)])),ke(0x1,f['Inject'](f[_0x429c2e(0x1b2)])),ke(0x2,f[_0x429c2e(0x297)](exports['SheetsPivotTableConfigModel'])),ke(0x3,f[_0x429c2e(0x297)](f[_0x429c2e(0x193)])),ke(0x4,f['Inject'](V['IExclusiveRangeService']))],exports['SheetsPivotTableAdaptorModel']);var In=Object[_0x429c2e(0x2ab)],Cn=(_0x42a443,_0xd9f2a2,_0x32a8e5,_0x2812b7)=>{const _0x53bfa3=_0x429c2e;for(var _0xc215ab=_0x2812b7>0x1?void 0x0:_0x2812b7?In(_0xd9f2a2,_0x32a8e5):_0xd9f2a2,_0x4a18d4=_0x42a443[_0x53bfa3(0x2ca)]-0x1,_0x2f8deb;_0x4a18d4>=0x0;_0x4a18d4--)(_0x2f8deb=_0x42a443[_0x4a18d4])&&(_0xc215ab=_0x2f8deb(_0xc215ab)||_0xc215ab);return _0xc215ab;},Lt=(_0x4d4d89,_0x3f5c8e)=>(_0x160bb0,_0x4d11f8)=>_0x3f5c8e(_0x160bb0,_0x4d11f8,_0x4d4d89);exports[_0x429c2e(0x415)]=class extends f['Disposable']{constructor(_0x24667d,_0xa9a99f){const _0x424ad8=_0x429c2e;super(),x(this,'asyncInterceptor',new f[(_0x424ad8(0x398))]({'PIVOT_PERFORM_CHECK':re})),x(this,_0x424ad8(0x211),new f[(_0x424ad8(0x361))]({'PIVOT_MUTATION_GENERATE':Jt})),(this[_0x424ad8(0x2e0)]=_0x24667d,this[_0x424ad8(0x407)]=_0xa9a99f,this['_init']());}[_0x429c2e(0x37c)](){this['_initViewModelBySheetInterceptor']();}[_0x429c2e(0x28b)](_0x2686a4){const _0xcb94d7=_0x429c2e;return this[_0xcb94d7(0x41f)][_0xcb94d7(0x1fa)](re)(!0x1,_0x2686a4);}[_0x429c2e(0x2f7)](){const _0x47f78c=_0x429c2e;this[_0x47f78c(0x1a8)](this[_0x47f78c(0x2e0)][_0x47f78c(0x1d9)](V[_0x47f78c(0x14d)][_0x47f78c(0x157)],{'priority':0xc8,'effect':f[_0x47f78c(0x387)][_0x47f78c(0x404)]|f[_0x47f78c(0x387)][_0x47f78c(0x3cc)],'handler':(_0x44c256,_0x38425a,_0x1a7af4)=>{const _0xc577cc=_0x47f78c,{row:_0x30d624,col:_0x35f857,unitId:_0x4ad12d,subUnitId:_0x15992f,workbook:_0x197bef}=_0x38425a,_0x1f606c=this[_0xc577cc(0x407)]['getPivotTableCellData'](_0x4ad12d,_0x15992f,_0x30d624,_0x35f857);if(!_0x1f606c)return _0x1a7af4(_0x44c256);const _0x3675d9={..._0x44c256};(_0x1f606c['v']||_0x1f606c['v']===0x0)&&(_0x3675d9['v']=_0x1f606c['v']),_0x1f606c['t']&&(_0x3675d9['t']=_0x1f606c['t']);const _0x5498b4=(typeof(_0x44c256==null?void 0x0:_0x44c256['s'])==_0xc577cc(0x3dc)?_0x197bef[_0xc577cc(0x270)]()['get'](_0x44c256==null?void 0x0:_0x44c256['s']):_0x44c256==null?void 0x0:_0x44c256['s'])||{},_0x4a3c17=_0x197bef[_0xc577cc(0x270)]()[_0xc577cc(0x236)](_0x1f606c['s']),_0x320ee7={..._0x4a3c17,..._0x5498b4};_0x4a3c17!=null&&_0x4a3c17['n']&&(_0x320ee7['n']=_0x4a3c17['n']);const _0x8ce377=_0x197bef['getStyles']()[_0xc577cc(0x196)](_0x320ee7);return _0x3675d9['s']=_0x8ce377,(_0x1f606c['pbt']===m[_0xc577cc(0x3c9)]['Collapse']||_0x1f606c[_0xc577cc(0x381)]===m[_0xc577cc(0x3c9)]['Expand'])&&(_0x3675d9[_0xc577cc(0x290)]={},_0x3675d9['fontRenderExtension'][_0xc577cc(0x1f1)]=Ro),_0x1a7af4(_0x3675d9);}}));}},exports['SheetsPivotTableService']=Cn([Lt(0x0,f[_0x429c2e(0x297)](V[_0x429c2e(0x1f6)])),Lt(0x1,f[_0x429c2e(0x297)](exports[_0x429c2e(0x33e)]))],exports[_0x429c2e(0x415)]);const Zt={'id':_0x429c2e(0x20d),'type':f[_0x429c2e(0x2df)]['MUTATION'],'handler':(_0x1114bd,_0x3fae08)=>{const _0x58bc41=_0x429c2e;if(!_0x3fae08)return!0x1;if(!!_0x1114bd[_0x58bc41(0x236)](f[_0x58bc41(0x20a)])['getConfig'](Q))return!0x0;const {pivotTableId:_0xe17106,fieldJSON:_0x5329dc,unitId:_0x216cae,subUnitId:_0x26bcb5}=_0x3fae08;let _0x3aa07a;const {dataFieldType:_0xf84150,id:_0x1b4739,name:_0x56f526,hexCode:_0x51f1e0,originalFieldId:_0x27d022}=_0x5329dc;if(_0xf84150===m['PivotDataFieldTypeEnum'][_0x58bc41(0x12e)]&&(_0x3aa07a=new m['DateGroupField'](_0x1b4739,_0x56f526,_0x51f1e0,_0x27d022)),!_0x3aa07a)return!0x1;const _0x4760a0=_0x1114bd[_0x58bc41(0x236)](exports[_0x58bc41(0x309)]),_0x513a29=_0x4760a0[_0x58bc41(0x11c)](_0x216cae),_0x53e016=_0x513a29[_0x58bc41(0x302)](_0xe17106);_0x513a29[_0x58bc41(0x188)](_0x3aa07a),_0x53e016[_0x58bc41(0x2ae)](_0x3aa07a[_0x58bc41(0x319)](),_0x3aa07a[_0x58bc41(0x25d)]());const _0x1b510d=_0x53e016[_0x58bc41(0x3b4)](_0x3aa07a[_0x58bc41(0x11a)]());_0x1b510d&&_0x3aa07a[_0x58bc41(0x114)](_0x1b510d);const _0x148f1f=_0x4760a0[_0x58bc41(0x2cb)](_0x216cae,_0x26bcb5,_0xe17106);return _0x4760a0[_0x58bc41(0x34d)]({'unitId':_0x216cae,'subUnitId':_0x26bcb5,'token':_0xe17106,'type':L[_0x58bc41(0x1ce)],'pivotConfig':_0x148f1f}),!0x0;}},eo={'id':_0x429c2e(0x3f9),'type':f[_0x429c2e(0x2df)][_0x429c2e(0x205)],'handler':(_0x1e09f6,_0x26b956)=>{const _0x5aaf4b=_0x429c2e;if(!_0x26b956)return!0x1;if(!!_0x1e09f6[_0x5aaf4b(0x236)](f[_0x5aaf4b(0x20a)])[_0x5aaf4b(0x1f2)](Q))return!0x0;const {pivotTableId:_0xd99e05,dataFieldId:_0x4ec61b,unitId:_0xc42a9a,subUnitId:_0x19ba1a}=_0x26b956,_0x37d94f=_0x1e09f6['get'](exports[_0x5aaf4b(0x309)]),_0x4cf456=_0x37d94f[_0x5aaf4b(0x11c)](_0xc42a9a);_0x4cf456['getCollection'](_0xd99e05)[_0x5aaf4b(0x3e3)](_0x4ec61b);let _0x456e5f=!0x0;for(const _0x4c0140 in _0x4cf456[_0x5aaf4b(0x124)])if(_0x4cf456[_0x5aaf4b(0x124)][_0x4c0140]['getFieldIds']()[_0x5aaf4b(0x35f)](_0x4ec61b)){_0x456e5f=!0x1;break;}_0x456e5f&&_0x4cf456[_0x5aaf4b(0x3d4)](_0x4ec61b);const _0x5d9b5a=_0x37d94f[_0x5aaf4b(0x2cb)](_0xc42a9a,_0x19ba1a,_0xd99e05);return _0x37d94f[_0x5aaf4b(0x34d)]({'unitId':_0xc42a9a,'subUnitId':_0x19ba1a,'token':_0xd99e05,'type':L[_0x5aaf4b(0x1ce)],'pivotConfig':_0x5d9b5a}),!0x0;}};function qe(_0x143fee,_0x1ab0a){const _0x177122=_0x429c2e;switch(_0x1ab0a){case m['PivotTableFiledAreaEnum'][_0x177122(0x404)]:return _0x143fee[_0x177122(0x17a)];case m['PivotTableFiledAreaEnum'][_0x177122(0x1bc)]:return _0x143fee[_0x177122(0x352)];case m[_0x177122(0x1d8)][_0x177122(0x110)]:return _0x143fee[_0x177122(0x359)];case m['PivotTableFiledAreaEnum'][_0x177122(0x26e)]:return _0x143fee[_0x177122(0x147)];default:return[];}}function Pe(_0x31b3a3,_0x2e1bf6){const _0x3dd95b=_0x429c2e;return _0x31b3a3['measure'][_0x2e1bf6]||_0x31b3a3[_0x3dd95b(0x13c)][_0x2e1bf6];}function bn(_0x417af6,_0x1485bd){const _0x4c1380=_0x429c2e,{area:_0x84ed51,fieldJson:_0x140229,index:_0x1642ed}=_0x1485bd;_0x84ed51===m[_0x4c1380(0x1d8)][_0x4c1380(0x404)]?_0x417af6[_0x4c1380(0x185)][_0x140229['id']]=_0x140229:_0x417af6['dimension'][_0x140229['id']]=_0x140229,qe(_0x417af6,_0x84ed51)[_0x4c1380(0x357)](_0x1642ed,0x0,_0x140229['id']);}function Sn(_0x3cd8eb,_0x438e88){const _0x4d1fa3=_0x429c2e,{area:_0x202382,fieldId:_0x5a8ee6,index:_0x334fb5}=_0x438e88;_0x202382===m[_0x4d1fa3(0x1d8)][_0x4d1fa3(0x404)]?delete _0x3cd8eb[_0x4d1fa3(0x185)][_0x5a8ee6]:delete _0x3cd8eb[_0x4d1fa3(0x13c)][_0x5a8ee6],qe(_0x3cd8eb,_0x202382)['splice'](_0x334fb5,0x1);}function Pn(_0x3db794,_0x2901c5){const {fieldId:_0x2d0f0b,name:_0x4bf996}=_0x2901c5,_0x329933=Pe(_0x3db794,_0x2d0f0b);_0x329933&&(_0x329933['displayName']=_0x4bf996);}function Tn(_0x915ca6,_0x49739f){const _0x280a02=_0x429c2e,{fieldId:_0x506682,collapse:_0x119f30,item:_0x46c4a8}=_0x49739f;_0x46c4a8!==void 0x0?(_0x915ca6[_0x280a02(0x39c)][_0x506682]=_0x915ca6['collapseInfo'][_0x506682]||{},_0x915ca6[_0x280a02(0x39c)][_0x506682][_0x46c4a8]=_0x119f30):_0x915ca6[_0x280a02(0x39c)][_0x506682]=_0x119f30;}function yn(_0x460383,_0xcf9100){const _0x57e156=_0x429c2e,{fieldId:_0x3f575a,format:_0x37ada2}=_0xcf9100,_0x470090=Pe(_0x460383,_0x3f575a);_0x470090&&(_0x470090[_0x57e156(0x379)]=_0x37ada2);}function Mn(_0xbf5834,_0x2a6e55){const _0x19ef0c=_0x429c2e,{fieldId:_0x156823,filterInfo:_0x4de973}=_0x2a6e55,_0x42fcf3=Pe(_0xbf5834,_0x156823);_0x42fcf3&&(_0x42fcf3[_0x19ef0c(0x1a4)]=_0x4de973);}function Fn(_0x114b9f,_0x294e2a){const _0x20befa=_0x429c2e,{fieldId:_0x78e193,filterInfo:_0x3ba891}=_0x294e2a,_0x1b7d63=_0x114b9f['valueFilter'][_0x20befa(0x26f)](_0x8dfb30=>_0x8dfb30[_0x20befa(0x2ef)]!==_0x78e193);_0x3ba891&&_0x1b7d63[_0x20befa(0x390)]({'fieldId':_0x78e193,'filterInfo':_0x3ba891}),_0x114b9f[_0x20befa(0x21d)]=_0x1b7d63;}function wn(_0x41015e,_0x32d674){const _0x1e8d0d=_0x429c2e,{fieldId:_0x1f8bee,subtotalType:_0x4ddf64}=_0x32d674,_0x2d5347=Pe(_0x41015e,_0x1f8bee);_0x2d5347&&(_0x2d5347[_0x1e8d0d(0x294)]=_0x4ddf64);}function _n(_0x4e4b2f,_0x5e09b8){const _0x432257=_0x429c2e,{fieldId:_0x5d2629,oldArea:_0xf14306,area:_0x27c1c7,oldIndex:_0xaf5f7c,index:_0x545ede}=_0x5e09b8,_0x17774a=_0xf14306!==m['PivotTableFiledAreaEnum'][_0x432257(0x404)]&&_0x27c1c7===m[_0x432257(0x1d8)][_0x432257(0x404)],_0x500105=_0xf14306===m['PivotTableFiledAreaEnum'][_0x432257(0x404)]&&_0x27c1c7!==m[_0x432257(0x1d8)][_0x432257(0x404)];if(_0x17774a||_0x500105){const _0x52f431=Pe(_0x4e4b2f,_0x5d2629);_0x52f431&&(_0x17774a?(delete _0x4e4b2f[_0x432257(0x13c)][_0x5d2629],_0x4e4b2f['measure'][_0x5d2629]=_0x52f431):(delete _0x4e4b2f[_0x432257(0x185)][_0x5d2629],_0x4e4b2f['dimension'][_0x5d2629]=_0x52f431));}const _0x1f193b=qe(_0x4e4b2f,_0xf14306),_0x1fcf98=qe(_0x4e4b2f,_0x27c1c7);_0x1f193b[_0x432257(0x357)](_0xaf5f7c,0x1),_0x1fcf98['splice'](_0x545ede,0x0,_0x5d2629);}function Rn(_0x62d63d,_0x58a297){const _0x364ea4=_0x429c2e,{valuePosition:_0xe21d57,index:_0x1578f7}=_0x58a297;_0x62d63d['valuePosition']=_0xe21d57,_0x62d63d[_0x364ea4(0x3da)]=_0x1578f7;}function Dn(_0x3cc9e3,_0x1b02bd){const _0x52d84a=_0x429c2e,{tableFieldId:_0x47a576,sourceName:_0xa1d533,dataFieldId:_0x868e70}=_0x1b02bd,_0x1c90cf=Pe(_0x3cc9e3,_0x47a576);_0x1c90cf&&(_0x1c90cf[_0x52d84a(0x3c6)]=_0xa1d533,_0x1c90cf[_0x52d84a(0x399)]=_0x868e70);}function En(_0x3a6340,_0x2d765a){const _0xc82853=_0x429c2e,{fieldId:_0x25a656,sortInfo:_0x1e9f9a}=_0x2d765a,_0x2a5148=Pe(_0x3a6340,_0x25a656);_0x2a5148&&(_0x2a5148[_0xc82853(0x33c)]=_0x1e9f9a);}function Nn(_0x2c571a,_0xf8343c){const _0x28c46e=_0x429c2e,{options:_0x3bd9f3}=_0xf8343c;_0x2c571a[_0x28c46e(0x282)]={..._0x2c571a[_0x28c46e(0x282)],..._0x3bd9f3};}const it={'type':f['CommandType'][_0x429c2e(0x205)],'id':_0x429c2e(0x175),'handler'(_0x5b1067,_0x1c7f96){const _0x28d5ff=_0x429c2e;if(!_0x1c7f96)return!0x1;if(!!_0x5b1067[_0x28d5ff(0x236)](f[_0x28d5ff(0x20a)])[_0x28d5ff(0x1f2)](Q))return!0x0;const _0x151600=_0x5b1067[_0x28d5ff(0x236)](exports['SheetsPivotDataSourceModel']),{pivotTableId:_0x528f7a,fieldJson:_0x1228c3,area:_0x22f558,index:_0x111584,unitId:_0x81423d,subUnitId:_0x2b465a}=_0x1c7f96,_0x5429e9=_0x151600[_0x28d5ff(0x1ff)](_0x528f7a);if(!_0x5429e9)return!0x1;let _0x37b1d5;_0x22f558===m[_0x28d5ff(0x1d8)][_0x28d5ff(0x404)]?_0x37b1d5=m['createValueField'](_0x1228c3):_0x37b1d5=m[_0x28d5ff(0x220)](_0x1228c3),_0x5429e9[_0x28d5ff(0x2ae)](_0x37b1d5,_0x22f558,_0x111584);const _0x192a68=_0x151600[_0x28d5ff(0x2e2)](_0x81423d,_0x2b465a,_0x528f7a);bn(_0x192a68,_0x1c7f96);const _0x3f5f2d=_0x151600[_0x28d5ff(0x2cb)](_0x81423d,_0x2b465a,_0x528f7a);return _0x151600['addDirtyPivotTable']({'unitId':_0x81423d,'subUnitId':_0x2b465a,'token':_0x528f7a,'type':L[_0x28d5ff(0x1ce)],'pivotConfig':_0x3f5f2d}),!0x0;}},at={'type':f[_0x429c2e(0x2df)]['MUTATION'],'id':_0x429c2e(0x177),'handler'(_0x324087,_0x1472db){const _0xaa9236=_0x429c2e;if(!_0x1472db)return!0x1;if(!!_0x324087['get'](f[_0xaa9236(0x20a)])[_0xaa9236(0x1f2)](Q))return!0x0;const _0x579bef=_0x324087[_0xaa9236(0x236)](exports['SheetsPivotDataSourceModel']),{pivotTableId:_0x115be0,fieldId:_0x4ca44e,unitId:_0x53723e,subUnitId:_0x3c9801}=_0x1472db,_0x4483f9=_0x579bef[_0xaa9236(0x1ff)](_0x115be0);if(!_0x4483f9)return!0x1;_0x4483f9['removeField'](_0x4ca44e);const _0x1b9fb8=_0x579bef[_0xaa9236(0x2e2)](_0x53723e,_0x3c9801,_0x115be0);Sn(_0x1b9fb8,_0x1472db);const _0x4ef9b5=_0x579bef[_0xaa9236(0x2cb)](_0x53723e,_0x3c9801,_0x115be0);return _0x579bef[_0xaa9236(0x34d)]({'unitId':_0x53723e,'subUnitId':_0x3c9801,'token':_0x115be0,'type':L[_0xaa9236(0x1ce)],'pivotConfig':_0x4ef9b5}),!0x0;}},st={'type':f['CommandType'][_0x429c2e(0x205)],'id':_0x429c2e(0x213),'handler'(_0x10187b,_0x4e8447){const _0x53d0c5=_0x429c2e;if(!_0x4e8447)return!0x1;if(!!_0x10187b[_0x53d0c5(0x236)](f[_0x53d0c5(0x20a)])[_0x53d0c5(0x1f2)](Q))return!0x0;const _0x513d06=_0x10187b[_0x53d0c5(0x236)](exports[_0x53d0c5(0x309)]),{unitId:_0x1007a2,subUnitId:_0x9f526d,pivotTableId:_0x477ce6,fieldId:_0x47da78,name:_0x342c32}=_0x4e8447,_0x346ded=_0x513d06[_0x53d0c5(0x1ff)](_0x477ce6);if(!_0x346ded)return!0x1;_0x346ded[_0x53d0c5(0x350)](_0x47da78,_0x342c32);const _0x327d8d=_0x513d06[_0x53d0c5(0x2e2)](_0x1007a2,_0x9f526d,_0x477ce6);return Pn(_0x327d8d,_0x4e8447),_0x513d06['addDirtyPivotTable']({'unitId':_0x1007a2,'subUnitId':_0x9f526d,'token':_0x477ce6,'type':L[_0x53d0c5(0x1ce)]}),!0x0;}},rt={'type':f['CommandType'][_0x429c2e(0x205)],'id':'sheet.mutation.set-pivot-collapse','handler'(_0x27900d,_0x332522){const _0x17e007=_0x429c2e;if(!_0x332522)return!0x1;if(!!_0x27900d[_0x17e007(0x236)](f[_0x17e007(0x20a)])[_0x17e007(0x1f2)](Q))return!0x0;const _0x388ffe=_0x27900d[_0x17e007(0x236)](exports['SheetsPivotDataSourceModel']),{unitId:_0xdcb8ee,subUnitId:_0x42a6f9,pivotTableId:_0x30d019,fieldId:_0x2bb78a,collapse:_0x157331,item:_0x11644b}=_0x332522,_0x1f5f1e=_0x388ffe['getPivotTableInstance'](_0x30d019);if(!_0x1f5f1e)return!0x1;_0x1f5f1e[_0x17e007(0x393)](_0x2bb78a,_0x157331,_0x11644b);const _0x38fd5c=_0x388ffe[_0x17e007(0x2e2)](_0xdcb8ee,_0x42a6f9,_0x30d019);return Tn(_0x38fd5c,_0x332522),_0x388ffe[_0x17e007(0x34d)]({'unitId':_0xdcb8ee,'subUnitId':_0x42a6f9,'token':_0x30d019,'type':L[_0x17e007(0x1ce)]}),!0x0;}},lt={'type':f[_0x429c2e(0x2df)][_0x429c2e(0x205)],'id':_0x429c2e(0x32f),'handler'(_0x4e3e30,_0x27f9a8){const _0x4bd1c4=_0x429c2e;if(!_0x27f9a8)return!0x1;if(!!_0x4e3e30[_0x4bd1c4(0x236)](f[_0x4bd1c4(0x20a)])[_0x4bd1c4(0x1f2)](Q))return!0x0;const _0x4106cf=_0x4e3e30['get'](exports[_0x4bd1c4(0x309)]),{unitId:_0x574b16,subUnitId:_0x5b4167,pivotTableId:_0x350c38,fieldId:_0x391071,format:_0x54bfeb}=_0x27f9a8,_0x26d37d=_0x4106cf['getPivotTableInstance'](_0x350c38);if(!_0x26d37d)return!0x1;_0x26d37d[_0x4bd1c4(0x259)](_0x391071,_0x54bfeb);const _0x409729=_0x4106cf['getPivotTableModelConfig'](_0x574b16,_0x5b4167,_0x350c38);return yn(_0x409729,_0x27f9a8),_0x4106cf[_0x4bd1c4(0x34d)]({'unitId':_0x574b16,'subUnitId':_0x5b4167,'token':_0x350c38,'type':L[_0x4bd1c4(0x1ce)]}),!0x0;}},ct={'type':f['CommandType'][_0x429c2e(0x205)],'id':_0x429c2e(0x3fb),'handler'(_0x59a019,_0x2b4240){const _0x157226=_0x429c2e;if(!_0x2b4240)return!0x1;if(!!_0x59a019[_0x157226(0x236)](f[_0x157226(0x20a)])[_0x157226(0x1f2)](Q))return!0x0;const _0x5c23cc=_0x59a019['get'](exports[_0x157226(0x309)]),{unitId:_0x10bb1a,subUnitId:_0x31a881,pivotTableId:_0x479f65,fieldId:_0x423d4e,filterInfo:_0x32e1d6}=_0x2b4240,_0x338842=_0x5c23cc[_0x157226(0x1ff)](_0x479f65);if(!_0x338842)return!0x1;_0x338842['setLabelFilterInfo'](_0x423d4e,_0x32e1d6);const _0x20ef16=_0x5c23cc[_0x157226(0x2e2)](_0x10bb1a,_0x31a881,_0x479f65);return Mn(_0x20ef16,_0x2b4240),_0x5c23cc['addDirtyPivotTable']({'unitId':_0x10bb1a,'subUnitId':_0x31a881,'token':_0x479f65,'type':L['Set']}),!0x0;}},dt={'type':f[_0x429c2e(0x2df)][_0x429c2e(0x205)],'id':_0x429c2e(0x28e),'handler'(_0x15bf62,_0x34e989){const _0x8863cf=_0x429c2e;if(!_0x34e989)return!0x1;if(!!_0x15bf62[_0x8863cf(0x236)](f[_0x8863cf(0x20a)])[_0x8863cf(0x1f2)](Q))return!0x0;const _0x22d111=_0x15bf62[_0x8863cf(0x236)](exports['SheetsPivotDataSourceModel']),{unitId:_0x2d137b,subUnitId:_0x5d2896,pivotTableId:_0x5df65b,options:_0xdad007}=_0x34e989,_0x5d0cc4=_0x22d111[_0x8863cf(0x1ff)](_0x5df65b);if(!_0x5d0cc4)return!0x1;_0x5d0cc4[_0x8863cf(0x2fc)](_0xdad007);const _0x55f8de=_0x22d111[_0x8863cf(0x2e2)](_0x2d137b,_0x5d2896,_0x5df65b);return Nn(_0x55f8de,_0x34e989),_0x22d111[_0x8863cf(0x34d)]({'unitId':_0x2d137b,'subUnitId':_0x5d2896,'token':_0x5df65b,'type':L['Set']}),!0x0;}},ut={'type':f[_0x429c2e(0x2df)][_0x429c2e(0x205)],'id':_0x429c2e(0x1db),'handler'(_0x5995e4,_0x137fc3){const _0x5437dd=_0x429c2e;if(!_0x137fc3)return!0x1;if(!!_0x5995e4[_0x5437dd(0x236)](f[_0x5437dd(0x20a)])[_0x5437dd(0x1f2)](Q))return!0x0;const _0x1226ac=_0x5995e4[_0x5437dd(0x236)](exports[_0x5437dd(0x309)]),{unitId:_0x9e11e,subUnitId:_0xfe033d,pivotTableId:_0x568a29,sortInfo:_0xad8f53,fieldId:_0x1986b1}=_0x137fc3,_0x3f459b=_0x1226ac['getPivotTableInstance'](_0x568a29);if(!_0x3f459b)return!0x1;_0x3f459b[_0x5437dd(0x287)](_0x1986b1,_0xad8f53);const _0xc50777=_0x1226ac[_0x5437dd(0x2e2)](_0x9e11e,_0xfe033d,_0x568a29);return En(_0xc50777,_0x137fc3),_0x1226ac[_0x5437dd(0x34d)]({'unitId':_0x9e11e,'subUnitId':_0xfe033d,'token':_0x568a29,'type':L[_0x5437dd(0x1ce)]}),!0x0;}},gt={'type':f[_0x429c2e(0x2df)]['MUTATION'],'id':_0x429c2e(0x27a),'handler'(_0x26cd2c,_0x1fbdb7){const _0x46135e=_0x429c2e;if(!_0x1fbdb7)return!0x1;if(!!_0x26cd2c[_0x46135e(0x236)](f[_0x46135e(0x20a)])[_0x46135e(0x1f2)](Q))return!0x0;const _0x49f3dd=_0x26cd2c[_0x46135e(0x236)](exports[_0x46135e(0x309)]),{unitId:_0x48d6ba,subUnitId:_0xcc805,pivotTableId:_0x394f2c,fieldId:_0x558e7c,subtotalType:_0x31e1c6}=_0x1fbdb7,_0x52afaa=_0x49f3dd[_0x46135e(0x1ff)](_0x394f2c);if(!_0x52afaa)return!0x1;_0x52afaa[_0x46135e(0x22d)](_0x558e7c,_0x31e1c6);const _0x49f6f3=_0x49f3dd['getPivotTableModelConfig'](_0x48d6ba,_0xcc805,_0x394f2c);return wn(_0x49f6f3,_0x1fbdb7),_0x49f3dd[_0x46135e(0x34d)]({'unitId':_0x48d6ba,'subUnitId':_0xcc805,'token':_0x394f2c,'type':L[_0x46135e(0x1ce)]}),!0x0;}},ft={'type':f['CommandType']['MUTATION'],'id':'sheet.mutation.set-pivot-value-filter','handler'(_0x19f1ce,_0x23810b){const _0x3edc2d=_0x429c2e;if(!_0x23810b)return!0x1;if(!!_0x19f1ce[_0x3edc2d(0x236)](f['IConfigService'])[_0x3edc2d(0x1f2)](Q))return!0x0;const _0x565802=_0x19f1ce[_0x3edc2d(0x236)](exports['SheetsPivotDataSourceModel']),{unitId:_0x4ed964,subUnitId:_0x143d8d,pivotTableId:_0x2df657,fieldId:_0x5b2609,filterInfo:_0x513f36}=_0x23810b,_0x2b54cd=_0x565802['getPivotTableInstance'](_0x2df657);if(!_0x2b54cd)return!0x1;_0x2b54cd[_0x3edc2d(0x376)](_0x5b2609,_0x513f36);const _0x3c2f74=_0x565802[_0x3edc2d(0x2e2)](_0x4ed964,_0x143d8d,_0x2df657);return Fn(_0x3c2f74,_0x23810b),_0x565802[_0x3edc2d(0x34d)]({'unitId':_0x4ed964,'subUnitId':_0x143d8d,'token':_0x2df657,'type':L['Set']}),!0x0;}},vt={'type':f[_0x429c2e(0x2df)][_0x429c2e(0x205)],'id':_0x429c2e(0x40d),'handler'(_0x18b985,_0x26b6a2){const _0x67f110=_0x429c2e;if(!_0x26b6a2)return!0x1;if(!!_0x18b985[_0x67f110(0x236)](f[_0x67f110(0x20a)])[_0x67f110(0x1f2)](Q))return!0x0;const _0x620d10=_0x18b985[_0x67f110(0x236)](exports[_0x67f110(0x309)]),{unitId:_0xec4609,subUnitId:_0x5961c7,pivotTableId:_0x146db6,area:_0x1e1a50,index:_0x538f4c,fieldId:_0x353d0f}=_0x26b6a2,_0x41e44b=_0x620d10[_0x67f110(0x1ff)](_0x146db6);if(!_0x41e44b)return!0x1;_0x41e44b[_0x67f110(0x37f)](_0x353d0f,_0x1e1a50,_0x538f4c);const _0x17a658=_0x620d10['getPivotTableModelConfig'](_0xec4609,_0x5961c7,_0x146db6);return _n(_0x17a658,_0x26b6a2),_0x620d10['addDirtyPivotTable']({'unitId':_0xec4609,'subUnitId':_0x5961c7,'token':_0x146db6,'type':L[_0x67f110(0x1ce)]}),!0x0;}},ht={'type':f[_0x429c2e(0x2df)]['MUTATION'],'id':'sheet.mutation.pivot-update-field-source-info','handler'(_0xf51ef5,_0x1e7090){const _0x1eec9e=_0x429c2e;if(!_0x1e7090)return!0x1;if(!!_0xf51ef5[_0x1eec9e(0x236)](f['IConfigService'])[_0x1eec9e(0x1f2)](Q))return!0x0;const _0x46f93c=_0xf51ef5[_0x1eec9e(0x236)](exports['SheetsPivotDataSourceModel']),{unitId:_0xb90a07,subUnitId:_0x1abbaa,pivotTableId:_0x405a91,sourceName:_0x2289e1,dataFieldId:_0x500dca,tableFieldId:_0x2a2523}=_0x1e7090,_0xc9fc80=_0x46f93c[_0x1eec9e(0x1ff)](_0x405a91);if(!_0xc9fc80)return!0x1;_0xc9fc80[_0x1eec9e(0x289)](_0x2a2523,_0x2289e1,_0x500dca);const _0x33fa43=_0x46f93c['getPivotTableModelConfig'](_0xb90a07,_0x1abbaa,_0x405a91);return Dn(_0x33fa43,_0x1e7090),_0x46f93c['addDirtyPivotTable']({'unitId':_0xb90a07,'subUnitId':_0x1abbaa,'token':_0x405a91,'type':L[_0x1eec9e(0x1ce)]}),!0x0;}},pt={'type':f[_0x429c2e(0x2df)]['MUTATION'],'id':_0x429c2e(0x316),'handler'(_0x26540e,_0x15fcb1){const _0x51804d=_0x429c2e;if(!_0x15fcb1)return!0x1;if(!!_0x26540e[_0x51804d(0x236)](f[_0x51804d(0x20a)])['getConfig'](Q))return!0x0;const _0x2f02ef=_0x26540e['get'](exports[_0x51804d(0x309)]),{unitId:_0x4ae742,subUnitId:_0x5210fa,pivotTableId:_0x5037f7,valuePosition:_0x559257,index:_0x26f423}=_0x15fcb1,_0x2a3c1c=_0x2f02ef['getPivotTableInstance'](_0x5037f7);if(!_0x2a3c1c)return!0x1;_0x2a3c1c['updateValuePosition'](_0x559257,_0x26f423);const _0x9da513=_0x2f02ef['getPivotTableModelConfig'](_0x4ae742,_0x5210fa,_0x5037f7);return Rn(_0x9da513,_0x15fcb1),_0x2f02ef[_0x51804d(0x34d)]({'unitId':_0x4ae742,'subUnitId':_0x5210fa,'token':_0x5037f7,'type':L[_0x51804d(0x1ce)]}),!0x0;}};function ae(_0x3557e4,_0x458f60,_0x64056c){const _0x3b66db=_0x429c2e,{pivotTableId:_0x2ef76e,unitId:_0x114ac6,subUnitId:_0x894580}=_0x458f60,_0x1a7148=[],_0x35bc25=[];for(const _0x4c0cc6 of _0x64056c)switch(_0x4c0cc6[_0x3b66db(0x418)]){case m[_0x3b66db(0x353)][_0x3b66db(0x27c)]:{const {fieldJson:_0x296161,area:_0x381cdc,index:_0xbf43ff}=_0x4c0cc6,_0x34afcf={'unitId':_0x114ac6,'subUnitId':_0x894580,'pivotTableId':_0x2ef76e,'fieldJson':_0x296161,'area':_0x381cdc,'index':_0xbf43ff},_0x5906de={'unitId':_0x114ac6,'subUnitId':_0x894580,'pivotTableId':_0x2ef76e,'fieldId':_0x296161['id'],'area':_0x381cdc,'index':_0xbf43ff};_0x1a7148[_0x3b66db(0x390)]({'id':it['id'],'params':_0x34afcf}),_0x35bc25['unshift']({'id':at['id'],'params':_0x5906de});}break;case m[_0x3b66db(0x353)][_0x3b66db(0x377)]:{const {fieldId:_0x11455c,newSubtotalType:_0x23588e,oldSubtotalType:_0x5e92a8}=_0x4c0cc6,_0x32f1c8={'unitId':_0x114ac6,'subUnitId':_0x894580,'pivotTableId':_0x2ef76e,'fieldId':_0x11455c,'subtotalType':_0x23588e};_0x1a7148[_0x3b66db(0x390)]({'id':gt['id'],'params':_0x32f1c8});const _0xc0bbfc={'unitId':_0x114ac6,'subUnitId':_0x894580,'pivotTableId':_0x2ef76e,'fieldId':_0x11455c,'subtotalType':_0x5e92a8};_0x35bc25['unshift']({'id':gt['id'],'params':_0xc0bbfc});}break;case m['PivotTableChangeTypeEnum'][_0x3b66db(0x249)]:{const {fieldId:_0x514ce2,fieldJson:_0x20547e,area:_0x316469,index:_0x10df88}=_0x4c0cc6,_0x1a4540={'unitId':_0x114ac6,'subUnitId':_0x894580,'pivotTableId':_0x2ef76e,'fieldId':_0x514ce2,'index':_0x10df88,'area':_0x316469};_0x1a7148[_0x3b66db(0x390)]({'id':at['id'],'params':_0x1a4540});const _0x41bd56={'unitId':_0x114ac6,'subUnitId':_0x894580,'pivotTableId':_0x2ef76e,'fieldJson':_0x20547e,'area':_0x316469,'index':_0x10df88};_0x35bc25[_0x3b66db(0x155)]({'id':it['id'],'params':_0x41bd56});}break;case m[_0x3b66db(0x353)]['RenameField']:{const {fieldId:_0x4e2f75,oldName:_0xffc9eb,newName:_0x396971}=_0x4c0cc6,_0x1fe47a={'unitId':_0x114ac6,'subUnitId':_0x894580,'pivotTableId':_0x2ef76e,'fieldId':_0x4e2f75,'name':_0x396971};_0x1a7148['push']({'id':st['id'],'params':_0x1fe47a});const _0x41977a={'unitId':_0x114ac6,'subUnitId':_0x894580,'pivotTableId':_0x2ef76e,'fieldId':_0x4e2f75,'name':_0xffc9eb};_0x35bc25[_0x3b66db(0x155)]({'id':st['id'],'params':_0x41977a});}break;case m[_0x3b66db(0x353)][_0x3b66db(0x343)]:{const {fieldId:_0x1d1a78,oldFilterInfo:_0x1e3e25,newFilterInfo:_0x8b8eb4}=_0x4c0cc6,_0x3b849a={'unitId':_0x114ac6,'subUnitId':_0x894580,'pivotTableId':_0x2ef76e,'fieldId':_0x1d1a78,'filterInfo':_0x8b8eb4};_0x1a7148['push']({'id':ct['id'],'params':_0x3b849a});const _0x41f3f7={'unitId':_0x114ac6,'subUnitId':_0x894580,'pivotTableId':_0x2ef76e,'fieldId':_0x1d1a78,'filterInfo':_0x1e3e25};_0x35bc25['unshift']({'id':ct['id'],'params':_0x41f3f7});}break;case m[_0x3b66db(0x353)][_0x3b66db(0x3d6)]:{const {fieldId:_0x199db9,oldSortInfo:_0x502e6d,newSortInfo:_0x5516e7}=_0x4c0cc6,_0x2ffacc={'unitId':_0x114ac6,'subUnitId':_0x894580,'pivotTableId':_0x2ef76e,'fieldId':_0x199db9,'sortInfo':_0x5516e7};_0x1a7148[_0x3b66db(0x390)]({'id':ut['id'],'params':_0x2ffacc});const _0x2118b5={'unitId':_0x114ac6,'subUnitId':_0x894580,'pivotTableId':_0x2ef76e,'fieldId':_0x199db9,'sortInfo':_0x502e6d};_0x35bc25[_0x3b66db(0x155)]({'id':ut['id'],'params':_0x2118b5});}break;case m[_0x3b66db(0x353)][_0x3b66db(0x22a)]:{const {oldOptions:_0x1f125e,newOptions:_0x252498}=_0x4c0cc6,_0x24d994={'unitId':_0x114ac6,'subUnitId':_0x894580,'pivotTableId':_0x2ef76e,'options':_0x252498};_0x1a7148[_0x3b66db(0x390)]({'id':dt['id'],'params':_0x24d994});const _0x159734={'unitId':_0x114ac6,'subUnitId':_0x894580,'pivotTableId':_0x2ef76e,'options':_0x1f125e};_0x35bc25[_0x3b66db(0x155)]({'id':dt['id'],'params':_0x159734});}break;case m[_0x3b66db(0x353)][_0x3b66db(0x22b)]:{const {oldArea:_0x49e24a,newArea:_0x522900,oldIndex:_0x44a5d2,newIndex:_0x296cc9,fieldId:_0x1d6cff}=_0x4c0cc6,_0x24b424={'unitId':_0x114ac6,'subUnitId':_0x894580,'pivotTableId':_0x2ef76e,'fieldId':_0x1d6cff,'area':_0x522900,'index':_0x296cc9,'oldArea':_0x49e24a,'oldIndex':_0x44a5d2};_0x1a7148[_0x3b66db(0x390)]({'id':vt['id'],'params':_0x24b424});const _0x3c23b9={'unitId':_0x114ac6,'subUnitId':_0x894580,'pivotTableId':_0x2ef76e,'fieldId':_0x1d6cff,'area':_0x49e24a,'index':_0x44a5d2,'oldArea':_0x522900,'oldIndex':_0x296cc9};_0x35bc25[_0x3b66db(0x155)]({'id':vt['id'],'params':_0x3c23b9});}break;case m[_0x3b66db(0x353)][_0x3b66db(0x229)]:{const {oldValuePosition:_0x315143,newValuePosition:_0x43dc78,oldIndex:_0x35a0fd,newIndex:_0x27b409}=_0x4c0cc6,_0x5579d8={'unitId':_0x114ac6,'subUnitId':_0x894580,'pivotTableId':_0x2ef76e,'valuePosition':_0x43dc78,'index':_0x27b409};_0x1a7148[_0x3b66db(0x390)]({'id':pt['id'],'params':_0x5579d8});const _0x3200ab={'unitId':_0x114ac6,'subUnitId':_0x894580,'pivotTableId':_0x2ef76e,'valuePosition':_0x315143,'index':_0x35a0fd};_0x35bc25[_0x3b66db(0x155)]({'id':pt['id'],'params':_0x3200ab});}break;case m[_0x3b66db(0x353)][_0x3b66db(0x1e4)]:{const {fieldId:_0x2915d1,collapse:_0x561bac,item:_0x271a23}=_0x4c0cc6,_0x251b68={'unitId':_0x114ac6,'subUnitId':_0x894580,'pivotTableId':_0x2ef76e,'fieldId':_0x2915d1,'collapse':_0x561bac,'item':_0x271a23};_0x1a7148['push']({'id':rt['id'],'params':_0x251b68});const _0x45a5e2={'unitId':_0x114ac6,'subUnitId':_0x894580,'pivotTableId':_0x2ef76e,'fieldId':_0x2915d1,'collapse':!_0x561bac,'item':_0x271a23};_0x35bc25[_0x3b66db(0x155)]({'id':rt['id'],'params':_0x45a5e2});}break;case m[_0x3b66db(0x353)][_0x3b66db(0x2f0)]:{const {newFormat:_0x5e0b7c,oldFormat:_0x5f151c,fieldId:_0x1fe469}=_0x4c0cc6,_0x426d67={'unitId':_0x114ac6,'subUnitId':_0x894580,'pivotTableId':_0x2ef76e,'fieldId':_0x1fe469,'format':_0x5e0b7c};_0x1a7148[_0x3b66db(0x390)]({'id':lt['id'],'params':_0x426d67});const _0x29b0d0={'unitId':_0x114ac6,'subUnitId':_0x894580,'pivotTableId':_0x2ef76e,'fieldId':_0x1fe469,'format':_0x5f151c};_0x35bc25['unshift']({'id':lt['id'],'params':_0x29b0d0});}break;case m[_0x3b66db(0x353)][_0x3b66db(0x2b9)]:{const {tableFieldId:_0x5e090,oldSourceName:_0x577f2a,newSourceName:_0x154da4,oldDataFieldId:_0x30761a,newDataFieldId:_0x6ce25f}=_0x4c0cc6,_0x381c29={'unitId':_0x114ac6,'subUnitId':_0x894580,'pivotTableId':_0x2ef76e,'tableFieldId':_0x5e090,'sourceName':_0x154da4,'dataFieldId':_0x6ce25f};_0x1a7148[_0x3b66db(0x390)]({'id':ht['id'],'params':_0x381c29});const _0x18b514={'unitId':_0x114ac6,'subUnitId':_0x894580,'pivotTableId':_0x2ef76e,'tableFieldId':_0x5e090,'sourceName':_0x577f2a,'dataFieldId':_0x30761a};_0x35bc25[_0x3b66db(0x155)]({'id':ht['id'],'params':_0x18b514});}break;case m[_0x3b66db(0x353)]['SetValueFilter']:{const {fieldId:_0x4e7c96,filterInfo:_0x1e29b6,oldFilterInfo:_0x2f203c}=_0x4c0cc6,_0x3d8490={'unitId':_0x114ac6,'subUnitId':_0x894580,'pivotTableId':_0x2ef76e,'fieldId':_0x4e7c96,'filterInfo':_0x1e29b6};_0x1a7148[_0x3b66db(0x390)]({'id':ft['id'],'params':_0x3d8490});const _0x5181da={'unitId':_0x114ac6,'subUnitId':_0x894580,'pivotTableId':_0x2ef76e,'fieldId':_0x4e7c96,'filterInfo':_0x2f203c};_0x35bc25[_0x3b66db(0x155)]({'id':ft['id'],'params':_0x5181da});}}return{'redos':_0x1a7148,'undos':_0x35bc25};}function ge(_0x17cba7,_0xaf953b){const _0x4b474f=_0x429c2e;var _0x572fd9;const _0x7fbe0=_0x17cba7['get'](exports[_0x4b474f(0x415)]),{cellInfo:_0x444b8e,view:_0x31b1d1,isEmpty:_0x281076}=_0xaf953b;return(_0x572fd9=_0x7fbe0[_0x4b474f(0x211)][_0x4b474f(0x3c2)](Jt)(At,{'cellInfo':_0x444b8e,'view':_0x31b1d1,'isEmpty':_0x281076}))!=null?_0x572fd9:At;}const to={'type':f[_0x429c2e(0x2df)][_0x429c2e(0x280)],'id':_0x429c2e(0x2bc),async 'handler'(_0x108e41,_0x51ecf3){const _0x582ede=_0x429c2e;if(!_0x51ecf3)return!0x1;const _0x26a800=_0x108e41[_0x582ede(0x236)](f['ICommandService']),_0x5e1903=_0x108e41['get'](exports[_0x582ede(0x3e0)]),_0x488bef=_0x108e41[_0x582ede(0x236)](f['IUndoRedoService']),{pivotTableId:_0x44bd1e,dataFieldId:_0x53f81a,fieldArea:_0x3fddaa,index:_0x1ebf17,unitId:_0x4ccd60,subUnitId:_0xfc5500}=_0x51ecf3,_0x3ee965=(await _0x5e1903[_0x582ede(0x239)]({'unitId':_0x4ccd60,'subUnitId':_0xfc5500,'pivotTableId':_0x44bd1e,'params':{'type':k[_0x582ede(0x383)],'addPivotField':{'dataFieldId':_0x53f81a,'fieldArea':_0x3fddaa,'index':_0x1ebf17}}}))['result'][_0x582ede(0x152)];if(!_0x3ee965)return!0x1;const {view:_0x53c391,changesets:_0x3d6823,isEmpty:_0x39897c,pivotTableConfig:_0xd684ac,shouldBeAddedGroupJSON:_0x573107}=_0x3ee965,_0x354126=_0xd684ac[_0x582ede(0x3d5)],_0x8384ae=new m[(_0x582ede(0x400))]();_0x8384ae[_0x582ede(0x3b8)](_0x53c391);const _0xf8c8be={'cellInfo':_0x354126,'view':_0x8384ae,'isEmpty':_0x39897c};if(!await _0x108e41[_0x582ede(0x236)](exports['SheetsPivotTableService'])[_0x582ede(0x41f)][_0x582ede(0x1fa)](re)(!0x0,_0xf8c8be))return!0x1;const _0x5d879c=ce(_0x108e41,_0x8384ae,_0x354126,_0x39897c),_0x13d79e=ge(_0x108e41,_0xf8c8be),{undos:_0x2b3209,redos:_0xe49a83}=ae(_0x26a800,{'pivotTableId':_0x44bd1e,'unitId':_0x4ccd60,'subUnitId':_0xfc5500},_0x3d6823);return _0x573107&&(_0xe49a83[_0x582ede(0x155)]({'id':Zt['id'],'params':{'pivotTableId':_0x44bd1e,'fieldJSON':_0x573107,'unitId':_0x4ccd60,'subUnitId':_0xfc5500}}),_0x2b3209[_0x582ede(0x390)]({'id':eo['id'],'params':{'pivotTableId':_0x44bd1e,'dataFieldId':_0x573107['id'],'unitId':_0x4ccd60,'subUnitId':_0xfc5500}})),f[_0x582ede(0x1c5)]([..._0x5d879c[_0x582ede(0x2a6)],..._0x13d79e[_0x582ede(0x2a6)],..._0xe49a83],_0x26a800),_0x488bef[_0x582ede(0x34e)]({'unitID':_0x4ccd60,'redoMutations':[..._0x5d879c['redos'],..._0x13d79e[_0x582ede(0x2a6)],..._0xe49a83],'undoMutations':[..._0x5d879c[_0x582ede(0x3f5)],..._0x13d79e[_0x582ede(0x3f5)],..._0x2b3209]}),!0x0;}},Un=()=>typeof process<'u'&&process[_0x429c2e(0x1e5)]!=null&&process['versions'][_0x429c2e(0x2bb)]!=null,_e={'type':f[_0x429c2e(0x2df)]['MUTATION'],'id':_0x429c2e(0x2db),'handler'(_0x314fb2,_0xc469fd){const _0x7aa1f7=_0x429c2e;var _0x1ce62a;if(!_0xc469fd)return!0x1;const _0x13bafc=_0x314fb2['get'](f[_0x7aa1f7(0x20a)]);if(!!_0x13bafc[_0x7aa1f7(0x1f2)](Q))return!0x0;const _0x5310a8=_0x314fb2[_0x7aa1f7(0x236)](f[_0x7aa1f7(0x193)]),_0x5c8ec5=_0x314fb2[_0x7aa1f7(0x236)](exports[_0x7aa1f7(0x309)]),{pivotTableId:_0x5c67f6,pivotTableConfig:_0x18dc91,collectionConfig:_0x2247bb,unitId:_0x4de7b5,subUnitId:_0x5e22ab}=_0xc469fd,{sourceRangeInfo:_0x300493,fieldsConfig:_0x83ee63,targetCellInfo:_0x7f1239}=_0x18dc91,_0x2c2163=_0x5310a8[_0x7aa1f7(0x3b9)](_0x4de7b5);if(!_0x2c2163||!_0x2c2163[_0x7aa1f7(0x3ca)](_0x5e22ab))return!0x1;if(!Un()){let _0x309b86=0x0;_0x2c2163['getSheets']()['forEach'](_0x149ce1=>{const _0x5a26ed=_0x7aa1f7;var _0x4a79c5,_0x402d09;_0x309b86+=(_0x402d09=(_0x4a79c5=_0x5c8ec5['getSubUnitPivotConfigs'](_0x4de7b5,_0x149ce1[_0x5a26ed(0x242)]()))==null?void 0x0:_0x4a79c5[_0x5a26ed(0x23b)])!=null?_0x402d09:0x0;});const _0x1da005=(_0x1ce62a=_0x13bafc[_0x7aa1f7(0x1f2)](ue[_0x7aa1f7(0x34a)]))!=null?_0x1ce62a:{},{ls:_0x10eae3,pbk:_0x2cccee}=_0x1da005;if(!Et(_0x10eae3,_0x2cccee))throw new f['CustomCommandExecutionError'](_0x7aa1f7(0x11d));const _0x4012ca=bt(It,_0x10eae3,_0x2cccee)[_0x7aa1f7(0x3e6)];if(_0x309b86>=_0x4012ca)throw new f[(_0x7aa1f7(0x408))](_0x7aa1f7(0x11d));}if(!_0x2247bb||!_0x83ee63)return!0x1;const {collection:_0xea69b0,updateDataFieldList:_0x9dc3d7}=_0x5c8ec5['addCollectionByJSON'](_0x5c67f6,_0x2247bb,_0x300493,_0x7f1239);_0x5c8ec5['refreshData'](_0xea69b0,_0x9dc3d7,_0x300493);const _0x510ba5=new m[(_0x7aa1f7(0x202))](_0xea69b0,void 0x0,_0x5c67f6);_0x510ba5['fromJSON'](_0x83ee63);const _0xa1b6f6=JSON[_0x7aa1f7(0x2b3)](JSON['stringify'](_0x18dc91));return _0x5c8ec5[_0x7aa1f7(0x3a2)](_0x4de7b5,_0x5e22ab,_0x5c67f6,_0x510ba5,_0xa1b6f6),_0x5c8ec5[_0x7aa1f7(0x34d)]({'unitId':_0x4de7b5,'subUnitId':_0x5e22ab,'token':_0x5c67f6,'type':L[_0x7aa1f7(0x3c3)],'pivotConfig':_0xa1b6f6}),!0x0;}},oo={'type':f[_0x429c2e(0x2df)]['COMMAND'],'id':_0x429c2e(0x3eb),async 'handler'(_0x4546f9,_0x2c311f){const _0x40b974=_0x429c2e;if(!_0x2c311f)return!0x1;const {sourceDataInfo:_0xb1576e,pivotTableConfig:_0x2e093f}=_0x2c311f;if(!_0xb1576e||!_0x2e093f)return!0x1;const {unitId:_0x550450,subUnitId:_0x54e0c2,range:_0x28fa4a}=_0xb1576e,_0x24805f=_0x4546f9[_0x40b974(0x236)](f[_0x40b974(0x193)]),_0x5cbcf6=_0x4546f9[_0x40b974(0x236)](exports[_0x40b974(0x3e0)]),_0x32a5d5=_0x4546f9[_0x40b974(0x236)](f[_0x40b974(0x14a)]),_0x4ea5ac=_0x4546f9[_0x40b974(0x236)](f[_0x40b974(0x20e)]),_0x4fcb72=_0x24805f[_0x40b974(0x3b9)](_0x550450);if(!_0x4fcb72)return!0x1;const _0x4c9013=_0x4fcb72[_0x40b974(0x3ca)](_0x54e0c2);if(!_0x4c9013)return!0x1;const _0x3089ad=m[_0x40b974(0x26b)](0x8),_0x523632=_0x28fa4a||{'startRow':0x0,'startColumn':0x0,'endRow':_0x4c9013[_0x40b974(0x1a5)]()-0x1,'endColumn':_0x4c9013[_0x40b974(0x306)]()-0x1};_0x523632[_0x40b974(0x21c)]=f[_0x40b974(0x3b1)][_0x40b974(0x1b8)];const _0x475fd1=(await _0x5cbcf6[_0x40b974(0x239)]({'unitId':_0x550450,'subUnitId':_0x54e0c2,'pivotTableId':_0x3089ad,'params':{'type':k[_0x40b974(0x23d)],'addPivotTableWithConfig':{'sourceRangeInfo':{'unitId':_0x550450,'sheetName':_0x4c9013[_0x40b974(0x25d)](),'subUnitId':_0x54e0c2,'range':_0x523632},'pivotTableId':_0x3089ad,'pivotTableIndexConfig':_0x2e093f}}}))[_0x40b974(0x19d)][_0x40b974(0x2b6)];if(!_0x475fd1)return!0x1;const {isEmpty:_0x5b75a8,fieldsConfig:_0xdd7dbc,collectionConfig:_0x14a640,changesets:_0x516077}=_0x475fd1,_0x5d81f5=_0x4fcb72[_0x40b974(0x12d)]()['length'],_0x51c1a1=f[_0x40b974(0x12b)]({'rowCount':_0x4c9013[_0x40b974(0x1a5)]()-0x1,'columnCount':_0x4c9013[_0x40b974(0x306)]()-0x1});_0x51c1a1['id']=f[_0x40b974(0x3fd)](),_0x51c1a1[_0x40b974(0x164)]=_0x4fcb72[_0x40b974(0x32a)](''+_0x32a5d5['t']('sheets.tabs.sheet'));const _0x2db542={'index':_0x5d81f5,'sheet':_0x51c1a1,'unitId':_0x550450},{redos:_0x7949a}=ae(_0x4ea5ac,{'pivotTableId':_0x3089ad,'unitId':_0x550450,'subUnitId':_0x51c1a1['id']},_0x516077),_0x30dbf0=[{'id':V[_0x40b974(0x3de)]['id'],'params':_0x2db542},{'id':_e['id'],'params':{'unitId':_0x550450,'subUnitId':_0x51c1a1['id'],'pivotTableId':_0x3089ad,'pivotTableConfig':{'isEmpty':_0x5b75a8,'fieldsConfig':_0xdd7dbc,'targetCellInfo':{'row':0x0,'col':0x0,'unitId':_0x550450,'subUnitId':_0x51c1a1['id']},'sourceRangeInfo':{'subUnitId':_0x54e0c2,'unitId':_0x550450,'range':_0x523632,'sheetName':_0x4c9013[_0x40b974(0x25d)]()}},'collectionConfig':_0x14a640}},..._0x7949a];return f[_0x40b974(0x1c5)](_0x30dbf0,_0x4ea5ac),!0x0;}},He={'type':f['CommandType'][_0x429c2e(0x205)],'id':'sheet.mutation.remove-pivot-table','handler'(_0x5b5435,_0x1b020f){const _0x4338d3=_0x429c2e;if(!_0x1b020f)return!0x1;if(!!_0x5b5435[_0x4338d3(0x236)](f[_0x4338d3(0x20a)])[_0x4338d3(0x1f2)](Q))return!0x0;const {pivotTableId:_0x39c1f8,unitId:_0x1eb10e,subUnitId:_0x3e3a3c}=_0x1b020f,_0x320908=_0x5b5435[_0x4338d3(0x236)](exports['SheetsPivotDataSourceModel']);return _0x320908[_0x4338d3(0x2cb)](_0x1eb10e,_0x3e3a3c,_0x39c1f8)?(_0x320908[_0x4338d3(0x34d)]({'unitId':_0x1eb10e,'subUnitId':_0x3e3a3c,'token':_0x39c1f8,'type':L[_0x4338d3(0x40b)]}),_0x320908[_0x4338d3(0x38d)](_0x1eb10e,_0x3e3a3c,_0x39c1f8),!0x0):!0x1;}},no={'type':f['CommandType'][_0x429c2e(0x280)],'id':_0x429c2e(0x1e8),async 'handler'(_0x5e0855,_0x18e7a3){const _0x2c8e2e=_0x429c2e;var _0x2c202c,_0x3ca8f7;const _0x269645=_0x5e0855[_0x2c8e2e(0x236)](f[_0x2c8e2e(0x20e)]),_0x4ce3d9=_0x5e0855[_0x2c8e2e(0x236)](f[_0x2c8e2e(0x193)]),_0x2269f8=_0x5e0855[_0x2c8e2e(0x236)](f[_0x2c8e2e(0x14a)]),_0x23b44d=_0x5e0855[_0x2c8e2e(0x236)](exports[_0x2c8e2e(0x3e0)]),_0x2e1947=_0x5e0855[_0x2c8e2e(0x236)](f[_0x2c8e2e(0x2b1)]),_0x4bdf85=_0x5e0855[_0x2c8e2e(0x236)](exports['SheetsPivotTableConfigModel']),_0x597c76=_0x5e0855[_0x2c8e2e(0x236)](f[_0x2c8e2e(0x20a)]);if(!_0x18e7a3)return!0x1;const {pivotTableConfig:_0xb59cc6,positionType:_0x397250}=_0x18e7a3,{targetCellInfo:_0x38dcb6,sourceRangeInfo:_0x599470}=_0xb59cc6,{unitId:_0x51bc20,subUnitId:_0x25a900}=_0x38dcb6,_0x410742=_0x4ce3d9[_0x2c8e2e(0x3b9)](_0x51bc20);if(!_0x410742)return!0x1;let _0x1b618d=0x0;_0x410742[_0x2c8e2e(0x12d)]()[_0x2c8e2e(0x174)](_0x304483=>{const _0x3c78e1=_0x2c8e2e;var _0x36ec75,_0x1690be;_0x1b618d+=(_0x1690be=(_0x36ec75=_0x4bdf85[_0x3c78e1(0x181)](_0x51bc20,_0x304483[_0x3c78e1(0x242)]()))==null?void 0x0:_0x36ec75[_0x3c78e1(0x23b)])!=null?_0x1690be:0x0;});const _0xa5da87=(_0x2c202c=_0x597c76[_0x2c8e2e(0x1f2)](ue['LS_CONFIG_KEY']))!=null?_0x2c202c:{},{ls:_0x36b8bb,pbk:_0x16e8ca}=_0xa5da87;if(!Et(_0x36b8bb,_0x16e8ca))return!0x1;const _0x143505=bt(It,_0x36b8bb,_0x16e8ca)[_0x2c8e2e(0x3e6)];if(_0x1b618d>=_0x143505)return!0x1;const _0x5a9b56=_0x18e7a3[_0x2c8e2e(0x255)]||m[_0x2c8e2e(0x26b)](0x8),_0x45047c=(await _0x23b44d['getPivotDisplayConfig']({'unitId':_0x51bc20,'subUnitId':_0x25a900,'pivotTableId':_0x5a9b56,'params':{'type':k[_0x2c8e2e(0x265)],'addPivotTable':{'sourceRangeInfo':_0x599470,'pivotTableId':_0x5a9b56}}}))[_0x2c8e2e(0x19d)][_0x2c8e2e(0x3a2)];if(!_0x45047c)return!0x1;const {view:_0x3a73e8,isEmpty:_0x42918d,fieldsConfig:_0x73018d,collectionConfig:_0x55f25c}=_0x45047c,_0x39a0ac=[],_0x3b501f=[];if(_0x397250===Mt['New']){const _0x297b62=_0x410742[_0x2c8e2e(0x12d)]()[_0x2c8e2e(0x2ca)],_0x79592e=f['mergeWorksheetSnapshotWithDefault']({});_0x79592e['id']=_0xb59cc6[_0x2c8e2e(0x3d5)][_0x2c8e2e(0x3c0)],_0x79592e[_0x2c8e2e(0x164)]=(_0x3ca8f7=_0xb59cc6['targetCellInfo'][_0x2c8e2e(0x29d)])!=null?_0x3ca8f7:_0x410742[_0x2c8e2e(0x32a)](''+_0x2269f8['t'](_0x2c8e2e(0x184)));const _0x1bf419={'index':_0x297b62,'sheet':_0x79592e,'unitId':_0x51bc20},_0x44b7e8=V[_0x2c8e2e(0x3dd)](_0x5e0855,_0x1bf419);_0x39a0ac[_0x2c8e2e(0x390)]({'id':V[_0x2c8e2e(0x12f)]['id'],'params':_0x44b7e8}),_0x3b501f[_0x2c8e2e(0x390)]({'id':V[_0x2c8e2e(0x263)]['id'],'params':_0x1bf419});}else{if(!_0x410742[_0x2c8e2e(0x3ca)](_0x25a900))return!0x1;const _0x435266=ce(_0x5e0855,new m[(_0x2c8e2e(0x400))](),_0x38dcb6,!0x0);_0x3b501f[_0x2c8e2e(0x390)](..._0x435266[_0x2c8e2e(0x2a6)]),_0x39a0ac['push'](..._0x435266[_0x2c8e2e(0x3f5)]);const _0x346bf7={'cellInfo':_0x38dcb6,'view':_0x3a73e8,'isEmpty':_0x42918d};if(!await _0x5e0855[_0x2c8e2e(0x236)](exports[_0x2c8e2e(0x415)])[_0x2c8e2e(0x41f)][_0x2c8e2e(0x1fa)](re)(!0x0,_0x346bf7))return!0x1;const _0x3bf14c=ge(_0x5e0855,_0x346bf7);_0x3b501f[_0x2c8e2e(0x390)](..._0x3bf14c[_0x2c8e2e(0x2a6)]),_0x39a0ac[_0x2c8e2e(0x390)](..._0x3bf14c[_0x2c8e2e(0x3f5)]);}return _0x3b501f['push']({'id':_e['id'],'params':{'unitId':_0x38dcb6[_0x2c8e2e(0x332)],'subUnitId':_0x38dcb6['subUnitId'],'pivotTableId':_0x5a9b56,'pivotTableConfig':{'targetCellInfo':_0x38dcb6,'sourceRangeInfo':_0x599470,'fieldsConfig':_0x73018d},'collectionConfig':_0x55f25c}}),_0x39a0ac[_0x2c8e2e(0x155)]({'id':He['id'],'params':{'unitId':_0x51bc20,'subUnitId':_0x25a900,'pivotTableId':_0x5a9b56}}),f[_0x2c8e2e(0x1c5)](_0x3b501f,_0x269645)&&_0x2e1947[_0x2c8e2e(0x34e)]({'unitID':_0x51bc20,'undoMutations':_0x39a0ac,'redoMutations':_0x3b501f}),!0x0;}},io={'type':f[_0x429c2e(0x2df)][_0x429c2e(0x280)],'id':'sheet.command.move-pivot-field',async 'handler'(_0x50bd1a,_0x1f9533){const _0x13fe0f=_0x429c2e;if(!_0x1f9533)return!0x1;const _0x9bda26=_0x50bd1a['get'](f[_0x13fe0f(0x20e)]),_0x572125=_0x50bd1a[_0x13fe0f(0x236)](exports[_0x13fe0f(0x3e0)]),_0x2e17df=_0x50bd1a['get'](f[_0x13fe0f(0x2b1)]),{pivotTableId:_0x51713c,fieldId:_0x5d422d,area:_0x141dd1,index:_0x4abc1e,unitId:_0x3720f9,subUnitId:_0x5a8b0d}=_0x1f9533,_0x6be542=(await _0x572125['getPivotDisplayConfig']({'unitId':_0x3720f9,'subUnitId':_0x5a8b0d,'pivotTableId':_0x51713c,'params':{'type':k[_0x13fe0f(0x409)],'movePivotField':{'fieldId':_0x5d422d,'area':_0x141dd1,'index':_0x4abc1e}}}))[_0x13fe0f(0x19d)][_0x13fe0f(0x401)];if(!_0x6be542)return!0x1;const {changesets:_0x39456b,view:_0x521db8,isEmpty:_0x34b9f9,pivotTableConfig:_0x174855}=_0x6be542,_0x555e2c=_0x174855['targetCellInfo'],_0x39e905=new m['PivotView']();_0x39e905['formJSON'](_0x521db8);const _0x1d85a3={'cellInfo':_0x555e2c,'view':_0x39e905,'isEmpty':_0x34b9f9};if(!await _0x50bd1a[_0x13fe0f(0x236)](exports[_0x13fe0f(0x415)])[_0x13fe0f(0x41f)][_0x13fe0f(0x1fa)](re)(!0x0,_0x1d85a3))return!0x1;const _0x259170=ce(_0x50bd1a,_0x39e905,_0x555e2c,_0x34b9f9),_0x3b5ed1=ge(_0x50bd1a,_0x1d85a3),{redos:_0x172b2b,undos:_0x103688}=ae(_0x9bda26,{'pivotTableId':_0x51713c,'unitId':_0x3720f9,'subUnitId':_0x5a8b0d},_0x39456b);return f[_0x13fe0f(0x1c5)]([..._0x259170['redos'],..._0x3b5ed1[_0x13fe0f(0x2a6)],..._0x172b2b],_0x9bda26),_0x2e17df[_0x13fe0f(0x34e)]({'unitID':_0x3720f9,'redoMutations':[..._0x259170[_0x13fe0f(0x2a6)],..._0x3b5ed1[_0x13fe0f(0x2a6)],..._0x172b2b],'undoMutations':[..._0x259170[_0x13fe0f(0x3f5)],..._0x3b5ed1[_0x13fe0f(0x3f5)],..._0x103688]}),!0x0;}},Fe={'type':f[_0x429c2e(0x2df)][_0x429c2e(0x205)],'id':_0x429c2e(0x2ee),'handler'(_0x185388,_0x3750dd){const _0x140740=_0x429c2e;if(!_0x3750dd)return!0x1;if(!!_0x185388[_0x140740(0x236)](f['IConfigService'])[_0x140740(0x1f2)](Q))return!0x0;const {pivotTableId:_0x5da413,targetCellPosition:_0x5717cc,unitId:_0x5d41e7,subUnitId:_0x2cb6cb}=_0x3750dd,_0xd87782=_0x185388[_0x140740(0x236)](exports[_0x140740(0x309)]);if(!_0xd87782['getPivotTableInstance'](_0x3750dd[_0x140740(0x255)]))return!0x1;const _0x3a3663=_0xd87782['getTargetByPivotId'](_0x5da413);if(!_0x3a3663)return!0x1;const _0x130558=_0xd87782[_0x140740(0x302)](_0x3a3663['unitId'],_0x3750dd[_0x140740(0x255)]);if(!_0x130558)return!0x1;const _0x45a70b=_0xd87782['getPivotTableConfig'](_0x3a3663[_0x140740(0x332)],_0x3a3663[_0x140740(0x3c0)],_0x5da413);if(!_0x45a70b)return!0x1;const _0x168fc2=f[_0x140740(0x149)][_0x140740(0x296)](_0x45a70b);_0x168fc2[_0x140740(0x3d5)]={'unitId':_0x5d41e7,'subUnitId':_0x2cb6cb,'row':_0x5717cc[_0x140740(0x216)],'col':_0x5717cc[_0x140740(0x18f)]};const _0x16f727=_0x130558[_0x140740(0x1e9)]();if(_0x3a3663['subUnitId']===_0x2cb6cb&&_0x3a3663[_0x140740(0x332)]===_0x5d41e7)_0xd87782['setPivotTable'](_0x5d41e7,_0x2cb6cb,_0x5da413,_0x168fc2),_0xd87782[_0x140740(0x34d)]({'unitId':_0x5d41e7,'subUnitId':_0x2cb6cb,'token':_0x5da413,'type':L['Set']});else{_0xd87782[_0x140740(0x34d)]({'unitId':_0x3a3663['unitId'],'subUnitId':_0x3a3663[_0x140740(0x3c0)],'token':_0x5da413,'type':L[_0x140740(0x40b)]}),_0xd87782['removePivotTable'](_0x3a3663[_0x140740(0x332)],_0x3a3663['subUnitId'],_0x5da413);const _0x33ede5=_0xd87782[_0x140740(0x262)](_0x5da413,_0x16f727,_0x45a70b[_0x140740(0x2aa)],_0x168fc2[_0x140740(0x3d5)]),_0x3ccce7=new m[(_0x140740(0x202))](_0x33ede5[_0x140740(0x190)],void 0x0,_0x5da413);_0x3ccce7[_0x140740(0x347)](_0x168fc2['fieldsConfig']),_0xd87782[_0x140740(0x3a2)](_0x5d41e7,_0x2cb6cb,_0x5da413,_0x3ccce7,_0x168fc2),_0xd87782[_0x140740(0x34d)]({'unitId':_0x5d41e7,'subUnitId':_0x2cb6cb,'token':_0x5da413,'type':L['Add'],'pivotConfig':_0x168fc2});}return!0x0;}},ao={'type':f[_0x429c2e(0x2df)][_0x429c2e(0x280)],'id':_0x429c2e(0x1b1),'handler':(_0x10b4b5,_0x3001db)=>{const _0x5c7786=_0x429c2e,_0x443d52=_0x10b4b5[_0x5c7786(0x236)](f[_0x5c7786(0x20e)]),_0x397f10=_0x10b4b5[_0x5c7786(0x236)](f[_0x5c7786(0x2b1)]),_0xee386c=_0x10b4b5[_0x5c7786(0x236)](exports[_0x5c7786(0x224)]),_0x4db56d=_0x10b4b5[_0x5c7786(0x236)](f[_0x5c7786(0x193)]);if(!_0x3001db)return!0x1;const _0x57a3c5=V[_0x5c7786(0x41a)](_0x4db56d);if(!_0x57a3c5)return!0x1;const {unitId:_0x380475,subUnitId:_0x3d4209,workbook:_0x5675ee}=_0x57a3c5,_0x2c6c21=_0xee386c[_0x5c7786(0x2cb)](_0x3001db[_0x5c7786(0x3ab)][_0x5c7786(0x332)],_0x3001db[_0x5c7786(0x3ab)][_0x5c7786(0x3c0)],_0x3001db[_0x5c7786(0x255)]);if(!_0x2c6c21)return!0x1;const _0x244c39=_0x5675ee['getSheetBySheetId'](_0x3001db[_0x5c7786(0x3d5)][_0x5c7786(0x3c0)]);if(!_0x244c39)throw new Error('[Pivot\x20Table]:\x20Target\x20sheet\x20is\x20not\x20valid');const _0x55bb58=_0x244c39[_0x5c7786(0x1a5)](),_0x51ffef=_0x244c39[_0x5c7786(0x306)]();if(_0x3001db[_0x5c7786(0x3d5)][_0x5c7786(0x216)]>_0x55bb58||_0x3001db['targetCellInfo']['col']>_0x51ffef)throw new Error(_0x5c7786(0x41c));const _0x4ed777=[{'id':Fe['id'],'params':{'unitId':_0x380475,'subUnitId':_0x3001db[_0x5c7786(0x3d5)]['subUnitId'],'pivotTableId':_0x3001db[_0x5c7786(0x255)],'targetCellPosition':{'row':_0x3001db['targetCellInfo'][_0x5c7786(0x216)],'col':_0x3001db[_0x5c7786(0x3d5)]['col']}}}],_0x46b6b8=[{'id':Fe['id'],'params':{'unitId':_0x380475,'subUnitId':_0x3d4209,'pivotTableId':_0x3001db[_0x5c7786(0x255)],'targetCellPosition':{'row':_0x2c6c21['targetCellInfo'][_0x5c7786(0x216)],'col':_0x2c6c21[_0x5c7786(0x3d5)][_0x5c7786(0x18f)]}}}];return f[_0x5c7786(0x1c5)](_0x4ed777,_0x443d52)&&_0x397f10[_0x5c7786(0x34e)]({'unitID':_0x380475,'undoMutations':_0x46b6b8,'redoMutations':_0x4ed777}),!0x0;}},so={'type':f[_0x429c2e(0x2df)][_0x429c2e(0x280)],'id':_0x429c2e(0x1dd),async 'handler'(_0x2d2cf4,_0x57a1f2){const _0x50515d=_0x429c2e;var _0x536e45;if(!_0x57a1f2)return!0x1;const _0x382331=_0x2d2cf4[_0x50515d(0x236)](f[_0x50515d(0x193)]),_0x49bba1=V[_0x50515d(0x41a)](_0x382331);if(!_0x49bba1)return!0x1;const {unitId:_0x49c65f,subUnitId:_0x41697b,workbook:_0x363590}=_0x49bba1,{row:_0x41549b,col:_0xce75ac}=_0x57a1f2,_0x1b8868=_0x2d2cf4['get'](exports[_0x50515d(0x33e)]),_0x5d3133=_0x1b8868[_0x50515d(0x120)](_0x49c65f,_0x41697b,_0x41549b,_0xce75ac);if(!_0x5d3133)return!0x1;const _0x525a4=(_0x536e45=_0x1b8868[_0x50515d(0x18d)](_0x49c65f,_0x41697b,_0x5d3133))==null?void 0x0:_0x536e45[_0x50515d(0x113)];if(!_0x525a4)return!0x1;const _0x765baa=_0x2d2cf4[_0x50515d(0x236)](exports[_0x50515d(0x224)])[_0x50515d(0x2cb)](_0x49c65f,_0x41697b,_0x5d3133);if(!_0x765baa)return!0x1;const {rowInfo:_0x5e878c,colInfo:_0x48b8e9}=_0x525a4,_0x3e4540=_0x5e878c[_0x41549b][_0x50515d(0x228)],_0x43487e=_0x48b8e9[_0xce75ac][_0x50515d(0x228)],_0x1dc055=_0x5e878c[_0x41549b][_0x50515d(0x38f)],_0x443416=_0x48b8e9[_0xce75ac]['level'],_0x1eff9b=_0x3e4540[_0x50515d(0x2b5)](_0x43487e),_0x33241b=_0x765baa[_0x50515d(0x371)][_0x50515d(0x359)][_0x50515d(0x215)](0x0,_0x1dc055),_0x56a11f=_0x765baa['fieldsConfig']['columnFields'][_0x50515d(0x215)](0x0,_0x443416),_0x57544d=_0x33241b['concat'](_0x56a11f),_0x17f662=_0x1eff9b['map']((_0x4aa8e0,_0x5ec514)=>[_0x4aa8e0,_0x57544d[_0x5ec514]]),_0x45134c=(await _0x2d2cf4['get'](exports[_0x50515d(0x3e0)])['getPivotDisplayConfig']({'unitId':_0x49c65f,'subUnitId':_0x41697b,'pivotTableId':_0x5d3133,'params':{'type':k['DrillDown'],'drillDown':{'tuple':_0x17f662}}}))[_0x50515d(0x19d)]['drillDown'];if(!_0x45134c)return!0x1;const {indexes:_0x11148c,range:_0x4c07d5,sourceUnitId:_0xde10bd,sourceSubUnitId:_0x4b9d93,formatMap:_0x315e99}=_0x45134c,{startRow:_0x53d1ab,endRow:_0x3456cd,startColumn:_0x351f83,endColumn:_0x4f55ab}=_0x4c07d5,_0x24893b=new f[(_0x50515d(0x2d2))](),_0x962cae=_0x3456cd-_0x53d1ab,_0xab197f=_0x4f55ab-_0x351f83,_0x3f9b0c={},_0x5b1921=V['getSheetCommandTarget'](_0x382331,{'unitId':_0xde10bd,'subUnitId':_0x4b9d93});if(!_0x5b1921)return!0x1;const _0x5c48f1=oe[_0x50515d(0x2e7)],_0x208fd4=oe[_0x50515d(0x2a3)],_0x41dfd8=oe['subTotalStyle'],_0x17dc75=_0x363590[_0x50515d(0x270)]()[_0x50515d(0x196)](_0x5c48f1),_0x57b955=_0x363590['getStyles']()['setValue'](_0x208fd4),_0x4c028a=_0x363590[_0x50515d(0x270)]()[_0x50515d(0x196)](_0x41dfd8),{worksheet:_0x282efc}=_0x5b1921;let _0x49d682=0x0;const _0x2460b5=0x1;_0x11148c[_0x50515d(0x174)](_0x1412a9=>{const _0x30154c=_0x50515d;for(let _0x156cd8=0x0;_0x156cd8<=_0x4f55ab-_0x351f83;_0x156cd8++)_0x24893b[_0x30154c(0x196)](_0x49d682,_0x156cd8,_0x282efc[_0x30154c(0x27b)](_0x1412a9+_0x4c07d5['startRow']+_0x2460b5,_0x156cd8));_0x49d682++;});for(let _0x5a67b5=_0x351f83;_0x5a67b5<=_0x4f55ab;_0x5a67b5++){const _0x594d9f=_0x282efc[_0x50515d(0x27b)](_0x53d1ab,_0x5a67b5);_0x3f9b0c[_0x53d1ab]||(_0x3f9b0c[_0x53d1ab]={}),_0x3f9b0c[_0x53d1ab][_0x5a67b5]={..._0x594d9f,'s':_0x17dc75};}let _0x5574a4=0x1;const _0x231f70={},_0x9b5c41={};_0x24893b[_0x50515d(0x317)]((_0x1801b8,_0x55202c)=>{const _0x1a18a8=_0x50515d;_0x55202c[_0x1a18a8(0x174)](_0x1c4ceb=>{const _0x5d9121=_0x1a18a8,_0x389795=_0x24893b[_0x5d9121(0x3f3)](_0x1801b8,_0x1c4ceb);if(_0x3f9b0c[_0x5574a4]||(_0x3f9b0c[_0x5574a4]={}),_0x3f9b0c[_0x5574a4][_0x1c4ceb]={..._0x389795,'s':_0x5574a4%0x2===0x0?_0x4c028a:_0x57b955},_0x315e99[_0x1c4ceb]&&_0x1801b8>=0x0){const _0x1bbe64=_0x5574a4%0x2===0x0;let _0x52dbca=_0x1bbe64?_0x9b5c41[_0x1c4ceb]:_0x231f70[_0x1c4ceb];_0x52dbca||(_0x52dbca=_0x363590['getStyles']()['setValue']({..._0x1bbe64?_0x41dfd8:_0x208fd4,'n':{'pattern':_0x315e99[_0x1c4ceb]}}),_0x1bbe64?_0x9b5c41[_0x1c4ceb]=_0x52dbca:_0x231f70[_0x1c4ceb]=_0x52dbca),_0x3f9b0c[_0x5574a4][_0x1c4ceb]['s']=_0x52dbca;}}),_0x5574a4++;});const _0x530e7e=new f['ObjectMatrix'](_0x3f9b0c),_0x396da2={};_0x530e7e[_0x50515d(0x260)]((_0x3cdfbd,_0x2f509f,_0x1dda60)=>{_0x396da2[_0x3cdfbd]||(_0x396da2[_0x3cdfbd]={}),_0x396da2[_0x3cdfbd][_0x2f509f]={'s':null,'f':null,'si':null,'p':null,'v':null,'t':null,'custom':null};});const _0x3f732e=[],_0x29429b=[],_0x342a37=_0x363590[_0x50515d(0x12d)]()[_0x50515d(0x2ca)],_0x48787b=f['mergeWorksheetSnapshotWithDefault']({'rowCount':Math['max'](f[_0x50515d(0x24c)],_0x962cae+0xa),'columnCount':Math[_0x50515d(0x1ec)](f[_0x50515d(0x31a)],_0xab197f+0x5)}),_0x5692fa=_0x2d2cf4[_0x50515d(0x236)](f[_0x50515d(0x14a)]);_0x48787b['id']=f[_0x50515d(0x3fd)](),_0x48787b['name']=_0x363590[_0x50515d(0x32a)](''+_0x5692fa['t'](_0x50515d(0x184)));const _0x22a700={'index':_0x342a37,'sheet':_0x48787b,'unitId':_0x49c65f},_0x2ad114=V[_0x50515d(0x3dd)](_0x2d2cf4,_0x22a700);_0x29429b[_0x50515d(0x390)]({'id':V['InsertSheetMutation']['id'],'params':_0x22a700}),_0x3f732e[_0x50515d(0x390)]({'id':V[_0x50515d(0x12f)]['id'],'params':_0x2ad114}),_0x29429b[_0x50515d(0x390)]({'id':V['SetRangeValuesMutation']['id'],'params':{'unitId':_0x49c65f,'subUnitId':_0x48787b['id'],'cellValue':_0x3f9b0c}}),_0x3f732e[_0x50515d(0x155)]({'id':V['SetRangeValuesMutation']['id'],'params':{'unitId':_0x49c65f,'subUnitId':_0x48787b['id'],'cellValue':_0x396da2}});const _0x1792c2={'startRow':0x0,'startColumn':0x0,'endRow':_0x5574a4-0x1,'endColumn':_0x4f55ab};_0x29429b[_0x50515d(0x390)]({'id':Ot['SetSheetsFilterRangeMutation']['id'],'params':{'unitId':_0x49c65f,'subUnitId':_0x48787b['id'],'range':_0x1792c2}}),_0x3f732e[_0x50515d(0x155)]({'id':Ot[_0x50515d(0x35e)]['id'],'params':{'unitId':_0x49c65f,'subUnitId':_0x48787b['id']}});const _0xd424c8=_0x2d2cf4[_0x50515d(0x236)](f[_0x50515d(0x20e)]);return f[_0x50515d(0x1c5)](_0x29429b,_0xd424c8)&&_0x2d2cf4[_0x50515d(0x236)](f[_0x50515d(0x2b1)])['pushUndoRedo']({'unitID':_0x49c65f,'undoMutations':_0x3f732e,'redoMutations':_0x29429b}),!0x0;}},ro={'type':f[_0x429c2e(0x2df)][_0x429c2e(0x280)],'id':_0x429c2e(0x254),async 'handler'(_0x4fb97f,_0x3fc30e){const _0x283948=_0x429c2e;if(!_0x3fc30e)return!0x1;const _0x5a47af=_0x4fb97f[_0x283948(0x236)](f[_0x283948(0x20e)]),_0x4ec663=_0x4fb97f['get'](exports[_0x283948(0x3e0)]),_0x2e376a=_0x4fb97f[_0x283948(0x236)](f[_0x283948(0x2b1)]),{pivotTableId:_0x501015,fieldIds:_0x11ac90,unitId:_0x3a786f,subUnitId:_0x55e68d}=_0x3fc30e,_0xf20748=(await _0x4ec663[_0x283948(0x239)]({'unitId':_0x3a786f,'subUnitId':_0x55e68d,'pivotTableId':_0x501015,'params':{'type':k[_0x283948(0x3b7)],'removePivotField':{'fieldIds':_0x11ac90}}}))[_0x283948(0x19d)]['removePivotField'];if(!_0xf20748)return!0x1;const {view:_0x532f3f,changesets:_0xcff7fe,isEmpty:_0xd16c5e,pivotTableConfig:_0x1ecb5f}=_0xf20748,_0x203d01=_0x1ecb5f[_0x283948(0x3d5)],_0x1739b3=new m[(_0x283948(0x400))]();_0x1739b3['formJSON'](_0x532f3f);const _0x4b2d82={'cellInfo':_0x203d01,'view':_0x1739b3,'isEmpty':_0xd16c5e};if(!await _0x4fb97f[_0x283948(0x236)](exports[_0x283948(0x415)])[_0x283948(0x41f)][_0x283948(0x1fa)](re)(!0x0,_0x4b2d82))return!0x1;const _0x1dfa6=ce(_0x4fb97f,_0x1739b3,_0x203d01,_0xd16c5e),_0x13b638=ge(_0x4fb97f,_0x4b2d82),{redos:_0x20be33,undos:_0x12f33e}=ae(_0x5a47af,{'pivotTableId':_0x501015,'unitId':_0x3a786f,'subUnitId':_0x55e68d},_0xcff7fe);return f[_0x283948(0x1c5)]([..._0x1dfa6[_0x283948(0x2a6)],..._0x13b638[_0x283948(0x2a6)],..._0x20be33],_0x5a47af),_0x2e376a[_0x283948(0x34e)]({'unitID':_0x3a786f,'redoMutations':[..._0x1dfa6['redos'],..._0x13b638[_0x283948(0x2a6)],..._0x20be33],'undoMutations':[..._0x1dfa6[_0x283948(0x3f5)],..._0x13b638['undos'],..._0x12f33e]}),!0x0;}},lo={'type':f[_0x429c2e(0x2df)][_0x429c2e(0x280)],'id':_0x429c2e(0x1c0),async 'handler'(_0x31badf,_0x598ba0){const _0xe4f7df=_0x429c2e;if(!_0x598ba0)return!0x1;const _0x5ba0c8=_0x31badf['get'](f[_0xe4f7df(0x20e)]),_0x21f717=_0x31badf[_0xe4f7df(0x236)](f['IUndoRedoService']),_0xf1042e=_0x31badf[_0xe4f7df(0x236)](exports[_0xe4f7df(0x3e0)]),{resetArea:_0x2f2336,pivotTableId:_0x48e8a1,unitId:_0xccf52e,subUnitId:_0x4a11e9}=_0x598ba0,_0x549f60=(await _0xf1042e[_0xe4f7df(0x239)]({'unitId':_0xccf52e,'subUnitId':_0x4a11e9,'pivotTableId':_0x48e8a1,'params':{'type':k[_0xe4f7df(0x111)],'resetPivotTable':{'pivotTableId':_0x48e8a1,'resetArea':_0x2f2336}}}))['result'][_0xe4f7df(0x323)];if(!_0x549f60)return!0x1;const {changesets:_0x402265}=_0x549f60,{redos:_0x30c774,undos:_0x5a3649}=ae(_0x5ba0c8,{'pivotTableId':_0x48e8a1,'unitId':_0xccf52e,'subUnitId':_0x4a11e9},_0x402265);return f[_0xe4f7df(0x1c5)](_0x30c774,_0x5ba0c8),_0x21f717[_0xe4f7df(0x34e)]({'unitID':_0xccf52e,'redoMutations':_0x30c774,'undoMutations':_0x5a3649}),!0x0;}},co={'type':f[_0x429c2e(0x2df)]['COMMAND'],'id':_0x429c2e(0x238),async 'handler'(_0x31aea4,_0x4cdfac){const _0x1febcb=_0x429c2e,_0x2ec3ba=_0x31aea4[_0x1febcb(0x236)](f[_0x1febcb(0x20e)]),_0x578c9e=_0x31aea4[_0x1febcb(0x236)](exports[_0x1febcb(0x3e0)]),_0x17e1fc=_0x31aea4[_0x1febcb(0x236)](exports[_0x1febcb(0x33e)]),_0x4c3213=_0x31aea4['get'](f['IUniverInstanceService']),_0x4bb2c=_0x31aea4[_0x1febcb(0x236)](f[_0x1febcb(0x14a)]),_0x2f5f3b=_0x31aea4[_0x1febcb(0x236)](f[_0x1febcb(0x2b1)]);if(!_0x4cdfac)return!0x1;const {unitId:_0x4fa384,subUnitId:_0x900b4b,row:_0xde9929,col:_0x180e3e,collapse:_0x4ae3dd}=_0x4cdfac,_0xd33906=_0x4c3213[_0x1febcb(0x3b9)](_0x4fa384);if(!_0xd33906||!_0xd33906[_0x1febcb(0x3ca)](_0x900b4b))return!0x1;const _0x48d1fd=_0x17e1fc[_0x1febcb(0x120)](_0x4fa384,_0x900b4b,_0xde9929,_0x180e3e);if(!_0x48d1fd)return!0x1;const _0xa8f3e5=_0x17e1fc[_0x1febcb(0x18d)](_0x4fa384,_0x900b4b,_0x48d1fd);if(!_0xa8f3e5)return!0x1;const _0x47b0c8=f['cellToRange'](_0xde9929,_0x180e3e),{rangesInfo:_0x22e482,areaInfo:_0x123e59,headerMap:_0x2c4f69}=_0xa8f3e5;if(!_0x22e482||!_0x123e59||!_0x2c4f69)return!0x1;const _0x1106a7=Object[_0x1febcb(0x116)](_0x22e482)[_0x1febcb(0x370)](_0x507431=>_0x22e482[_0x507431]['some'](_0x3e90a0=>f[_0x1febcb(0x235)][_0x1febcb(0x27e)](_0x3e90a0,_0x47b0c8)));let _0x374bb0;_0x1106a7===_0x1febcb(0x363)?_0x374bb0=_0x2c4f69[_0x1febcb(0x313)][_0x180e3e]:_0x1106a7===_0x1febcb(0x31c)&&(_0x374bb0=_0x2c4f69[_0x1febcb(0x244)][_0xde9929]);const _0x28aab1=_0x374bb0==null?void 0x0:_0x374bb0[_0x1febcb(0x112)],_0x5d2bcd=_0x17e1fc[_0x1febcb(0x3a1)](_0x4fa384,_0x900b4b,_0xde9929,_0x180e3e);let _0x3f2d8e=_0x5d2bcd==null?void 0x0:_0x5d2bcd['v'];if(_0x3f2d8e===_0x4bb2c['t']('sheets-pivot.blank')&&(_0x3f2d8e=m[_0x1febcb(0x1f3)][_0x1febcb(0x312)]),_0x3f2d8e==null||!_0x48d1fd||!_0x28aab1)return!0x1;const _0x1f5337=await _0x578c9e[_0x1febcb(0x239)]({'unitId':_0x4fa384,'subUnitId':_0x900b4b,'pivotTableId':_0x48d1fd,'params':{'type':k[_0x1febcb(0x1dc)],'setPivotCollapse':{'tableFieldId':_0x28aab1,'collapse':_0x4ae3dd,'item':_0x3f2d8e}}}),_0x236cda=_0x1f5337==null?void 0x0:_0x1f5337[_0x1febcb(0x19d)]['setPivotCollapse'];if(!_0x236cda)return!0x1;const {view:_0x93d88e,pivotTableConfig:_0x2d6f44,isEmpty:_0x4ea70f,changesets:_0x3d6834}=_0x236cda,_0x5cf8f6=new m[(_0x1febcb(0x400))]();_0x5cf8f6[_0x1febcb(0x3b8)](_0x93d88e);const _0x4e7c3a=_0x2d6f44['targetCellInfo'],_0x5c2741={'cellInfo':_0x4e7c3a,'view':_0x5cf8f6,'isEmpty':_0x4ea70f};if(!await _0x31aea4[_0x1febcb(0x236)](exports[_0x1febcb(0x415)])[_0x1febcb(0x41f)]['fetchThroughAsyncInterceptors'](re)(!0x0,_0x5c2741))return!0x1;const _0x430cbf=ce(_0x31aea4,_0x5cf8f6,_0x4e7c3a,_0x4ea70f),_0x44104c=ge(_0x31aea4,_0x5c2741),{redos:_0x14a6b6,undos:_0x42544a}=ae(_0x2ec3ba,{'pivotTableId':_0x48d1fd,'unitId':_0x4fa384,'subUnitId':_0x900b4b},_0x3d6834);return f[_0x1febcb(0x1c5)]([..._0x430cbf[_0x1febcb(0x2a6)],..._0x44104c[_0x1febcb(0x2a6)],..._0x14a6b6],_0x2ec3ba),_0x2f5f3b['pushUndoRedo']({'unitID':_0x4fa384,'redoMutations':[..._0x430cbf[_0x1febcb(0x2a6)],..._0x44104c[_0x1febcb(0x2a6)],..._0x14a6b6],'undoMutations':[..._0x430cbf[_0x1febcb(0x3f5)],..._0x44104c[_0x1febcb(0x3f5)],..._0x42544a]}),!0x0;}},uo={'type':f[_0x429c2e(0x2df)][_0x429c2e(0x280)],'id':'sheet.command.set-pivot-fields-config',async 'handler'(_0x1fb866,_0x2aea37){const _0x27186f=_0x429c2e;if(!_0x2aea37)return!0x1;const _0x5f39d1=_0x1fb866['get'](f[_0x27186f(0x20e)]),_0x25808f=_0x1fb866[_0x27186f(0x236)](f[_0x27186f(0x2b1)]),_0x33695b=_0x1fb866['get'](exports[_0x27186f(0x3e0)]),{pivotTableConfig:_0x62fd1f,pivotTableId:_0x361291,unitId:_0x36a16a,subUnitId:_0x1a2a90}=_0x2aea37,_0x3a734d=(await _0x33695b[_0x27186f(0x239)]({'unitId':_0x36a16a,'subUnitId':_0x1a2a90,'pivotTableId':_0x361291,'params':{'type':k['SetPivotTableConfig'],'setPivotTableConfig':{'pivotTableId':_0x361291,'pivotTableConfig':_0x62fd1f}}}))[_0x27186f(0x19d)]['setPivotTableConfig'];if(!_0x3a734d)return!0x1;const {changesets:_0x55cdac}=_0x3a734d,{redos:_0x2e13e6,undos:_0x9d86f5}=ae(_0x5f39d1,{'pivotTableId':_0x361291,'unitId':_0x36a16a,'subUnitId':_0x1a2a90},_0x55cdac);return f[_0x27186f(0x1c5)](_0x2e13e6,_0x5f39d1),_0x25808f[_0x27186f(0x34e)]({'unitID':_0x36a16a,'redoMutations':_0x2e13e6,'undoMutations':_0x9d86f5}),!0x0;}},go={'type':f[_0x429c2e(0x2df)]['COMMAND'],'id':'sheet.command.set-pivot-filter',async 'handler'(_0x2dd917,_0x2e3bc3){const _0x19af3b=_0x429c2e;if(!_0x2e3bc3)return!0x1;const _0x3eae8a=_0x2dd917['get'](f['ICommandService']),{pivotTableId:_0x125d3d,tableFieldId:_0x51025a,items:_0x5ff9b1,unitId:_0x382255,subUnitId:_0x233109,isAll:_0x32e018}=_0x2e3bc3,_0x4e94c3=_0x2dd917[_0x19af3b(0x236)](exports['SheetsPivotRPCService']),_0x3ff456=_0x2dd917[_0x19af3b(0x236)](f[_0x19af3b(0x2b1)]),_0x3b2588=(await _0x4e94c3[_0x19af3b(0x239)]({'unitId':_0x382255,'subUnitId':_0x233109,'pivotTableId':_0x125d3d,'params':{'type':k['SetPivotFilter'],'setPivotFilter':{'tableFieldId':_0x51025a,'items':_0x5ff9b1,'isAll':_0x32e018}}}))[_0x19af3b(0x19d)][_0x19af3b(0x153)];if(!_0x3b2588)return!0x1;const {changesets:_0x1358a2,pivotTableConfig:_0x5d7f20,isEmpty:_0x389cd1,view:_0x31e048}=_0x3b2588,_0x3d65db=_0x5d7f20[_0x19af3b(0x3d5)],_0xfa1d1d=new m[(_0x19af3b(0x400))]();_0xfa1d1d[_0x19af3b(0x3b8)](_0x31e048);const _0x5283e4={'cellInfo':_0x3d65db,'view':_0xfa1d1d,'isEmpty':_0x389cd1};if(!await _0x2dd917[_0x19af3b(0x236)](exports[_0x19af3b(0x415)])[_0x19af3b(0x41f)][_0x19af3b(0x1fa)](re)(!0x0,_0x5283e4))return!0x1;const _0x24e8a7=ce(_0x2dd917,_0xfa1d1d,_0x3d65db,_0x389cd1),_0x525e13=ge(_0x2dd917,_0x5283e4),{undos:_0x3240a3,redos:_0x3c5110}=ae(_0x3eae8a,{'pivotTableId':_0x125d3d,'unitId':_0x382255,'subUnitId':_0x233109},_0x1358a2);return f[_0x19af3b(0x1c5)]([..._0x24e8a7[_0x19af3b(0x2a6)],..._0x525e13[_0x19af3b(0x2a6)],..._0x3c5110],_0x3eae8a),_0x3ff456[_0x19af3b(0x34e)]({'unitID':_0x382255,'redoMutations':[..._0x24e8a7[_0x19af3b(0x2a6)],..._0x525e13[_0x19af3b(0x2a6)],..._0x3c5110],'undoMutations':[..._0x24e8a7['undos'],..._0x525e13[_0x19af3b(0x3f5)],..._0x3240a3]}),!0x0;}},fo={'type':f[_0x429c2e(0x2df)]['COMMAND'],'id':_0x429c2e(0x2b7),async 'handler'(_0x51e2e7,_0x11b6c3){const _0x728a44=_0x429c2e;if(!_0x11b6c3)return!0x1;const _0x30c6d8=_0x51e2e7[_0x728a44(0x236)](f[_0x728a44(0x20e)]),_0x585094=_0x51e2e7[_0x728a44(0x236)](f[_0x728a44(0x2b1)]),_0x12dafd=_0x51e2e7[_0x728a44(0x236)](exports[_0x728a44(0x3e0)]),{info:_0x27ab61,tableFieldId:_0x5cfe64,pivotTableId:_0x4f1ccc,unitId:_0x2afaed,subUnitId:_0x592f35}=_0x11b6c3,_0x26d3d1=(await _0x12dafd[_0x728a44(0x239)]({'unitId':_0x2afaed,'subUnitId':_0x592f35,'pivotTableId':_0x4f1ccc,'params':{'type':k[_0x728a44(0x1de)],'setPivotSort':{'tableFieldId':_0x5cfe64,'info':_0x27ab61}}}))[_0x728a44(0x19d)][_0x728a44(0x148)];if(!_0x26d3d1)return!0x1;const {changesets:_0x20d0d2}=_0x26d3d1,{redos:_0x4321d0,undos:_0x1a5ca4}=ae(_0x30c6d8,{'pivotTableId':_0x4f1ccc,'unitId':_0x2afaed,'subUnitId':_0x592f35},_0x20d0d2);return f['sequenceExecute'](_0x4321d0,_0x30c6d8),_0x585094['pushUndoRedo']({'unitID':_0x2afaed,'redoMutations':_0x4321d0,'undoMutations':_0x1a5ca4}),!0x0;}},vo={'type':f[_0x429c2e(0x2df)][_0x429c2e(0x280)],'id':_0x429c2e(0x3a4),async 'handler'(_0x42e437,_0x468134){const _0xfe0bdc=_0x429c2e;if(!_0x468134)return!0x1;const _0x23e11d=_0x42e437[_0xfe0bdc(0x236)](f[_0xfe0bdc(0x20e)]),{pivotTableId:_0x241dd6,fieldId:_0x4ce56a,valueFilterInfo:_0x67e446,unitId:_0xe2474d,subUnitId:_0x372e30}=_0x468134,_0x19c946=_0x42e437[_0xfe0bdc(0x236)](exports[_0xfe0bdc(0x3e0)]),_0xe79963=_0x42e437[_0xfe0bdc(0x236)](f['IUndoRedoService']),_0x355655=(await _0x19c946[_0xfe0bdc(0x239)]({'unitId':_0xe2474d,'subUnitId':_0x372e30,'pivotTableId':_0x241dd6,'params':{'type':k[_0xfe0bdc(0x277)],'setValuePivotFilter':{'tableFieldId':_0x4ce56a,'filterInfo':_0x67e446}}}))[_0xfe0bdc(0x19d)][_0xfe0bdc(0x384)];if(!_0x355655)return!0x1;const {changesets:_0x1e9288,pivotTableConfig:_0x1f9460,isEmpty:_0x2ade15,view:_0x4f2572}=_0x355655,_0x3d0b09=_0x1f9460[_0xfe0bdc(0x3d5)],_0x3f4805=new m[(_0xfe0bdc(0x400))]();_0x3f4805['formJSON'](_0x4f2572);const _0x15a032={'cellInfo':_0x3d0b09,'view':_0x3f4805,'isEmpty':_0x2ade15};if(!await _0x42e437['get'](exports[_0xfe0bdc(0x415)])['asyncInterceptor']['fetchThroughAsyncInterceptors'](re)(!0x0,_0x15a032))return!0x1;const _0xff5291=ce(_0x42e437,_0x3f4805,_0x3d0b09,_0x2ade15),_0x36a67a=ge(_0x42e437,_0x15a032),{undos:_0x5613b6,redos:_0x119918}=ae(_0x23e11d,{'pivotTableId':_0x241dd6,'unitId':_0xe2474d,'subUnitId':_0x372e30},_0x1e9288);return f[_0xfe0bdc(0x1c5)]([..._0xff5291[_0xfe0bdc(0x2a6)],..._0x36a67a[_0xfe0bdc(0x2a6)],..._0x119918],_0x23e11d),_0xe79963[_0xfe0bdc(0x34e)]({'unitID':_0xe2474d,'redoMutations':[..._0xff5291[_0xfe0bdc(0x2a6)],..._0x36a67a[_0xfe0bdc(0x2a6)],..._0x119918],'undoMutations':[..._0xff5291[_0xfe0bdc(0x3f5)],..._0x36a67a[_0xfe0bdc(0x3f5)],..._0x5613b6]}),!0x0;}},yt={'id':_0x429c2e(0x1e3),'type':f[_0x429c2e(0x2df)][_0x429c2e(0x205)],'handler':(_0x1ab0db,_0x15e291)=>{const _0x2cdd72=_0x429c2e;if(!_0x15e291)return!0x1;if(!!_0x1ab0db[_0x2cdd72(0x236)](f[_0x2cdd72(0x20a)])[_0x2cdd72(0x1f2)](Q))return!0x0;const {unitId:_0x7b94f7,subUnitId:_0xebcd6f,pivotTableId:_0x398ab8,tableFieldId:_0x37e60e,dateType:_0x29966c}=_0x15e291,_0x1087b8=_0x1ab0db[_0x2cdd72(0x236)](exports[_0x2cdd72(0x309)]),_0x471268=_0x1087b8[_0x2cdd72(0x1ff)](_0x398ab8);if(!_0x471268)return!0x1;const _0x3c2710=_0x471268[_0x2cdd72(0x209)](_0x37e60e);if(!_0x3c2710)return!0x1;const _0x4481bc=_0x3c2710['getOriginFieldId'](),_0x19bdfc=_0x471268['getDataFieldByDataFieldId'](_0x4481bc),_0xe6ec54=(_0x19bdfc==null?void 0x0:_0x19bdfc[_0x2cdd72(0x25d)]())+'\x20'+zt(_0x1ab0db,_0x29966c);_0x1087b8['getCollection'](_0x7b94f7,_0x398ab8)['setDisplayName'](_0x3c2710['id'],_0xe6ec54);const _0x23296c=_0x471268[_0x2cdd72(0x24e)](_0x37e60e);if(!_0x23296c)return!0x1;_0x471268[_0x2cdd72(0x350)](_0x23296c[_0x2cdd72(0x319)](),_0xe6ec54),_0x3c2710[_0x2cdd72(0x1d7)](_0x29966c);const _0x3b5d56=_0x1087b8[_0x2cdd72(0x2cb)](_0x7b94f7,_0xebcd6f,_0x398ab8);return _0x1087b8[_0x2cdd72(0x34d)]({'unitId':_0x7b94f7,'subUnitId':_0xebcd6f,'token':_0x398ab8,'type':L[_0x2cdd72(0x1ce)],'pivotConfig':_0x3b5d56}),!0x0;}},ho={'id':_0x429c2e(0x201),'type':f[_0x429c2e(0x2df)][_0x429c2e(0x280)],'handler':(_0xdddde6,_0x31487c)=>{const _0x2c8e49=_0x429c2e;if(!_0x31487c)return!0x1;const _0xf6fed1=_0xdddde6[_0x2c8e49(0x236)](f[_0x2c8e49(0x2b1)]),{unitId:_0x546f52,subUnitId:_0x3fd30c,pivotTableId:_0x49bd5f,tableFieldId:_0x379eda}=_0x31487c,_0x4e3139=[],_0x475d51=[],_0x1be3c7=_0xdddde6[_0x2c8e49(0x236)](exports[_0x2c8e49(0x224)]),_0x2e3c03=_0x1be3c7['getCollection'](_0x546f52,_0x49bd5f),_0x375e1f=_0x1be3c7[_0x2c8e49(0x2cb)](_0x546f52,_0x3fd30c,_0x49bd5f);if(!(_0x375e1f!=null&&_0x375e1f['fieldsConfig']['dimension']))return!0x1;const _0x25712d=Object['values'](_0x375e1f[_0x2c8e49(0x371)][_0x2c8e49(0x13c)])[_0x2c8e49(0x370)](_0x52768b=>_0x52768b['id']===_0x379eda);if(!_0x25712d)return!0x1;const _0x29d633=_0x25712d['dataFieldId'];if(!(_0x2e3c03!=null&&_0x2e3c03[_0x2c8e49(0x21f)]))return!0x1;const _0x4cadea=Object[_0x2c8e49(0x3a6)](_0x2e3c03==null?void 0x0:_0x2e3c03[_0x2c8e49(0x21f)])[_0x2c8e49(0x370)](_0x53f43f=>_0x53f43f['id']===_0x29d633);if(!_0x4cadea)return!0x1;m[_0x2c8e49(0x2c4)](_0x4cadea)&&_0x4e3139['push']({'id':yt['id'],'params':{..._0x31487c,'dateType':_0x4cadea[_0x2c8e49(0x340)]}}),_0x475d51['push']({'id':yt['id'],'params':{..._0x31487c}});const _0x1a4f12=_0xdddde6[_0x2c8e49(0x236)](f[_0x2c8e49(0x20e)]);return f['sequenceExecute'](_0x475d51,_0x1a4f12)&&_0xf6fed1[_0x2c8e49(0x34e)]({'unitID':_0x546f52,'undoMutations':_0x4e3139,'redoMutations':_0x475d51}),!0x0;}},po={'type':f[_0x429c2e(0x2df)][_0x429c2e(0x280)],'id':_0x429c2e(0x1b7),async 'handler'(_0x2ef54b,_0x10243c){const _0x494dec=_0x429c2e;if(!_0x10243c)return!0x1;const _0x1fe04e=_0x2ef54b[_0x494dec(0x236)](f[_0x494dec(0x20e)]),_0x2aa247=_0x2ef54b[_0x494dec(0x236)](f['IUndoRedoService']),_0x1e9691=_0x2ef54b[_0x494dec(0x236)](exports[_0x494dec(0x3e0)]),{displayName:_0x4ed3d6,subtotalType:_0x593ce7,format:_0x510f0a,tableFieldId:_0x446665,pivotTableId:_0x5309a1,unitId:_0x52f3c3,subUnitId:_0x2421b7}=_0x10243c,_0x59c18f=(await _0x1e9691[_0x494dec(0x239)]({'unitId':_0x52f3c3,'subUnitId':_0x2421b7,'pivotTableId':_0x5309a1,'params':{'type':k['SetPivotSetting'],'setPivotSetting':{'tableFieldId':_0x446665,'displayName':_0x4ed3d6,'subtotalType':_0x593ce7,'format':_0x510f0a}}}))[_0x494dec(0x19d)][_0x494dec(0x1d2)];if(!_0x59c18f)return!0x1;const {changesets:_0x579f8e,view:_0xffc285,pivotTableConfig:_0x5327bd,isEmpty:_0x17e56c}=_0x59c18f,_0x26f52f=_0x5327bd[_0x494dec(0x3d5)],_0xc8444b=new m[(_0x494dec(0x400))]();_0xc8444b[_0x494dec(0x3b8)](_0xffc285);const _0x158828={'cellInfo':_0x26f52f,'view':_0xc8444b,'isEmpty':_0x17e56c};if(!await _0x2ef54b[_0x494dec(0x236)](exports[_0x494dec(0x415)])['asyncInterceptor'][_0x494dec(0x1fa)](re)(!0x0,_0x158828))return!0x1;const _0x29172a=ce(_0x2ef54b,_0xc8444b,_0x26f52f,_0x17e56c),_0x4fc615=ge(_0x2ef54b,_0x158828),{undos:_0x5c473a,redos:_0x70869a}=ae(_0x1fe04e,{'pivotTableId':_0x5309a1,'unitId':_0x52f3c3,'subUnitId':_0x2421b7},_0x579f8e);return f[_0x494dec(0x1c5)]([..._0x29172a[_0x494dec(0x2a6)],..._0x4fc615[_0x494dec(0x2a6)],..._0x70869a],_0x1fe04e),_0x2aa247[_0x494dec(0x34e)]({'unitID':_0x52f3c3,'redoMutations':[..._0x29172a['redos'],..._0x4fc615[_0x494dec(0x2a6)],..._0x70869a],'undoMutations':[..._0x29172a['undos'],..._0x4fc615['undos'],..._0x5c473a]}),!0x0;}},mt={'type':f[_0x429c2e(0x2df)][_0x429c2e(0x205)],'id':'sheet.mutation.update-pivot-table-source-range','handler'(_0x3259c9,_0x8860bd){const _0x18d14a=_0x429c2e;if(!_0x8860bd)return!0x1;if(!!_0x3259c9[_0x18d14a(0x236)](f[_0x18d14a(0x20a)])['getConfig'](Q))return!0x0;const _0x2d3a1a=_0x3259c9[_0x18d14a(0x236)](exports['SheetsPivotDataSourceModel']),{pivotTableId:_0x4e7cab,deleteIds:_0x5b06a8,collectionJSON:_0x1f7d63,dataRangeInfo:_0x576d06,unitId:_0x4ec5c7,subUnitId:_0x5bf83d}=_0x8860bd,_0x5c6e23=_0x2d3a1a[_0x18d14a(0x1ff)](_0x4e7cab),_0x2e3b5b=_0x2d3a1a[_0x18d14a(0x2cb)](_0x4ec5c7,_0x5bf83d,_0x4e7cab);if(!_0x5c6e23||!_0x2e3b5b)return!0x1;const {collection:_0x35ef8d,updateDataFieldList:_0x3b2cfd}=_0x2d3a1a[_0x18d14a(0x262)](_0x4e7cab,_0x1f7d63,_0x576d06,_0x2e3b5b[_0x18d14a(0x3d5)]);_0x2d3a1a[_0x18d14a(0x2d7)](_0x35ef8d,_0x3b2cfd,_0x576d06),_0x5c6e23[_0x18d14a(0x1ed)](_0x35ef8d);for(const _0xf565ea of _0x5b06a8)_0x2d3a1a[_0x18d14a(0x1bb)](_0x576d06[_0x18d14a(0x332)],_0xf565ea);const _0x401fbf=_0x2d3a1a[_0x18d14a(0x2cb)](_0x4ec5c7,_0x5bf83d,_0x4e7cab);return _0x401fbf[_0x18d14a(0x2aa)]=JSON[_0x18d14a(0x2b3)](JSON[_0x18d14a(0x279)](_0x576d06)),_0x2d3a1a['addDirtyPivotTable']({'unitId':_0x4ec5c7,'subUnitId':_0x5bf83d,'token':_0x4e7cab,'type':L['Set']}),!0x0;}},mo={'type':f['CommandType'][_0x429c2e(0x280)],'id':_0x429c2e(0x1e6),async 'handler'(_0x2d85e1,_0x52b179){const _0x93dab=_0x429c2e,_0x310ebf=_0x2d85e1[_0x93dab(0x236)](f[_0x93dab(0x20e)]),_0x5e1253=_0x2d85e1['get'](exports[_0x93dab(0x3e0)]),_0x2e1d7f=_0x2d85e1[_0x93dab(0x236)](f[_0x93dab(0x2b1)]);if(!_0x52b179)return!0x1;const {token:_0x1ba296,dataRangeInfo:_0x3171a2,unitId:_0x4fabef,subUnitId:_0x2b299a}=_0x52b179,_0x346675=[],_0x5db3ef=[],_0x46c476=(await _0x5e1253['getPivotDisplayConfig']({'unitId':_0x4fabef,'subUnitId':_0x2b299a,'pivotTableId':_0x1ba296,'params':{'type':k[_0x93dab(0x3b5)],'updatePivotSource':{'dataRangeInfo':_0x3171a2,'unitId':_0x4fabef,'subUnitId':_0x2b299a}}}))[_0x93dab(0x19d)][_0x93dab(0x1c1)];if(!_0x46c476)return!0x1;const {changesets:_0x11b6c4,deleteIds:_0x19ccf8,collectionConfig:_0x1c6486,oldCollectionConfig:_0x2d8c3a,view:_0x3e37c2,isEmpty:_0x555e43,pivotTableConfig:_0x1794a4}=_0x46c476;_0x5db3ef[_0x93dab(0x390)]({'id':mt['id'],'params':{'pivotTableId':_0x1ba296,'deleteIds':_0x19ccf8,'collectionJSON':_0x1c6486,'dataRangeInfo':_0x3171a2,'unitId':_0x4fabef,'subUnitId':_0x2b299a}}),_0x346675['unshift']({'id':mt['id'],'params':{'pivotTableId':_0x1ba296,'deleteIds':[],'collectionJSON':_0x2d8c3a,'dataRangeInfo':_0x1794a4[_0x93dab(0x2aa)],'unitId':_0x4fabef,'subUnitId':_0x2b299a}});const _0x137054=_0x1794a4[_0x93dab(0x3d5)],_0x2c8d40=new m[(_0x93dab(0x400))]();_0x2c8d40[_0x93dab(0x3b8)](_0x3e37c2);const _0x270568={'cellInfo':_0x137054,'view':_0x2c8d40,'isEmpty':_0x555e43};if(!await _0x2d85e1['get'](exports['SheetsPivotTableService'])[_0x93dab(0x41f)]['fetchThroughAsyncInterceptors'](re)(!0x0,_0x270568))return!0x1;const _0x1b103f=ce(_0x2d85e1,_0x2c8d40,_0x137054,_0x555e43),_0x26744c=ge(_0x2d85e1,_0x270568),{undos:_0x1ae69c,redos:_0x22b219}=ae(_0x310ebf,{'pivotTableId':_0x1ba296,'unitId':_0x4fabef,'subUnitId':_0x2b299a},_0x11b6c4);return f[_0x93dab(0x1c5)]([..._0x1b103f['redos'],..._0x26744c['redos'],..._0x5db3ef,..._0x1ae69c],_0x310ebf),_0x2e1d7f[_0x93dab(0x34e)]({'unitID':_0x4fabef,'redoMutations':[..._0x1b103f[_0x93dab(0x2a6)],..._0x26744c[_0x93dab(0x2a6)],..._0x5db3ef,..._0x1ae69c],'undoMutations':[..._0x1b103f[_0x93dab(0x3f5)],..._0x26744c['undos'],..._0x346675,..._0x22b219]}),!0x0;}},Io={'type':f[_0x429c2e(0x2df)][_0x429c2e(0x280)],'id':_0x429c2e(0x160),async 'handler'(_0x588bae,_0x4b0e2b){const _0x2f77e3=_0x429c2e;if(!_0x4b0e2b)return!0x1;const _0x495948=_0x588bae['get'](f['ICommandService']),_0x3d7e43=_0x588bae[_0x2f77e3(0x236)](exports[_0x2f77e3(0x3e0)]),_0x297070=_0x588bae[_0x2f77e3(0x236)](f[_0x2f77e3(0x193)]),_0x5e3e13=_0x588bae[_0x2f77e3(0x236)](f[_0x2f77e3(0x2b1)]),{pivotTableId:_0x4d6198,position:_0x19b6d8,index:_0x500111}=_0x4b0e2b,_0x52655b=V[_0x2f77e3(0x41a)](_0x297070);if(!_0x52655b)return!0x1;const {unitId:_0x4ff087,subUnitId:_0x395196}=_0x52655b,_0x26f41a=(await _0x3d7e43[_0x2f77e3(0x239)]({'unitId':_0x4ff087,'subUnitId':_0x395196,'pivotTableId':_0x4d6198,'params':{'type':k['UpdateValuePosition'],'updateValuePosition':{'position':_0x19b6d8,'index':_0x500111}}}))[_0x2f77e3(0x19d)][_0x2f77e3(0x3e2)];if(!_0x26f41a)return!0x1;const {changesets:_0x29dba2,view:_0x475336,isEmpty:_0xcf13e5,pivotTableConfig:_0x30e102}=_0x26f41a,_0x930323=_0x30e102[_0x2f77e3(0x3d5)],_0x3e2d9a=new m[(_0x2f77e3(0x400))]();_0x3e2d9a[_0x2f77e3(0x3b8)](_0x475336);const _0x37a703=_0x588bae[_0x2f77e3(0x236)](exports['SheetsPivotTableService']),_0x5eee2b={'cellInfo':_0x930323,'view':_0x3e2d9a,'isEmpty':_0xcf13e5};if(!await _0x37a703['asyncInterceptor'][_0x2f77e3(0x1fa)](re)(!0x0,_0x5eee2b))return!0x1;const _0x4f06b5=ce(_0x588bae,_0x3e2d9a,_0x930323,_0xcf13e5),_0x5c40df=ge(_0x588bae,_0x5eee2b),{undos:_0x226977,redos:_0x57327e}=ae(_0x495948,{'pivotTableId':_0x4d6198,'unitId':_0x4ff087,'subUnitId':_0x395196},_0x29dba2);return f[_0x2f77e3(0x1c5)]([..._0x4f06b5['redos'],..._0x5c40df[_0x2f77e3(0x2a6)],..._0x57327e],_0x495948),_0x5e3e13[_0x2f77e3(0x34e)]({'unitID':_0x4ff087,'redoMutations':[..._0x4f06b5[_0x2f77e3(0x2a6)],..._0x5c40df[_0x2f77e3(0x2a6)],..._0x57327e],'undoMutations':[..._0x4f06b5[_0x2f77e3(0x3f5)],..._0x5c40df[_0x2f77e3(0x3f5)],..._0x226977]}),!0x0;}},Ke={'type':f[_0x429c2e(0x2df)][_0x429c2e(0x205)],'id':_0x429c2e(0x219),'handler'(){return!0x0;}};var Vn=Object[_0x429c2e(0x2ab)],xn=(_0x233cea,_0xb89772,_0x32800e,_0x4d112d)=>{const _0x388ee1=_0x429c2e;for(var _0x412da1=_0x4d112d>0x1?void 0x0:_0x4d112d?Vn(_0xb89772,_0x32800e):_0xb89772,_0x18b35f=_0x233cea[_0x388ee1(0x2ca)]-0x1,_0x4a7f70;_0x18b35f>=0x0;_0x18b35f--)(_0x4a7f70=_0x233cea[_0x18b35f])&&(_0x412da1=_0x4a7f70(_0x412da1)||_0x412da1);return _0x412da1;},je=(_0xc6884c,_0x107b81)=>(_0x2c6762,_0x540007)=>_0x107b81(_0x2c6762,_0x540007,_0xc6884c);const On=()=>({'runtimeCellData':{},'dirtyRanges':{}}),An=(_0x1123d0,_0x4ca25e,_0x263ddc)=>{const _0x255285=_0x429c2e,_0x4d8ffa=_0x1123d0[_0x255285(0x39e)];_0x1123d0[_0x255285(0x36f)](_0x29f46b=>{const _0x2fa5e2=_0x255285,_0x2b9672=_0x29f46b[_0x2fa5e2(0x319)](),_0x19463a=_0x29f46b[_0x2fa5e2(0x2e1)](),_0x563afb=_0x29f46b[_0x2fa5e2(0x126)](),_0x9cdfeb=_0x29f46b[_0x2fa5e2(0x416)]();_0x4ca25e[_0x19463a]&&_0x4ca25e[_0x19463a]===_0x9cdfeb&&_0x563afb===_0x9cdfeb&&(_0x1123d0[_0x2fa5e2(0x350)](_0x2b9672,_0x4d8ffa['getDisplayName'](_0x19463a)),_0x29f46b['setSourceName'](_0x4d8ffa[_0x2fa5e2(0x416)](_0x19463a)));}),_0x1123d0[_0x255285(0x41e)](m[_0x255285(0x1d8)][_0x255285(0x404)],_0x3e98d0=>{const _0x33c4c1=_0x255285,_0x418dad=_0x3e98d0['getId'](),_0xa4c0a8=_0x3e98d0[_0x33c4c1(0x2e1)](),_0x2efa26=_0x3e98d0['getSourceName'](),_0x3999d8=_0x3e98d0['getDisplayName'](),_0x25456d=_0x3e98d0[_0x33c4c1(0x331)](),_0x2637ff=_0x263ddc(_0x2efa26,_0x25456d);_0x4ca25e[_0xa4c0a8]&&_0x4ca25e[_0xa4c0a8]===_0x2efa26&&_0x2637ff===_0x3999d8&&(_0x1123d0[_0x33c4c1(0x350)](_0x418dad,_0x263ddc(_0x4d8ffa[_0x33c4c1(0x416)](_0xa4c0a8),_0x25456d)),_0x3e98d0['setSourceName'](_0x4d8ffa[_0x33c4c1(0x416)](_0xa4c0a8)));});},kn=(_0x1b5164,_0xe81e09,_0x1a5710)=>{const _0x4351de=_0x429c2e;var _0x21e4d5,_0x1ef746;const {arrayFormulaCellData:_0x270751,unitData:_0x2cf0db}=_0xe81e09,{unitId:_0x1ee493,subUnitId:_0x5ac359}=_0x1a5710,_0x25bbc1=_0x1a5710[_0x4351de(0x17f)],{startColumn:_0x108868,endColumn:_0x3a3b7c}=_0x25bbc1,_0x435d5a=(_0x21e4d5=_0x270751==null?void 0x0:_0x270751[_0x1ee493])==null?void 0x0:_0x21e4d5[_0x5ac359],_0x519685=(_0x1ef746=_0x2cf0db==null?void 0x0:_0x2cf0db[_0x1ee493])==null?void 0x0:_0x1ef746[_0x5ac359],_0x1f1094=new Set(),_0x2fb88a=_0x3a3b7c-_0x108868+0x1,{dirtyRanges:_0x22f357}=_0x1b5164;if(_0x22f357)for(const {range:_0x4fb942,sheetId:_0x54e353,unitId:_0x4610bb}of _0x22f357){if(_0x54e353!==_0x5ac359||_0x1ee493!==_0x4610bb)continue;const _0x308278=f[_0x4351de(0x235)][_0x4351de(0x2a1)](_0x4fb942,_0x25bbc1);if(_0x308278){const {startColumn:_0xf3d62f,endColumn:_0x514904}=_0x308278;for(let _0x426e1b=_0xf3d62f;_0x426e1b<=_0x514904;_0x426e1b++)_0x1f1094[_0x4351de(0x207)](_0x426e1b);}}if(_0x1f1094[_0x4351de(0x23b)]===_0x2fb88a||_0x1f1094[_0x4351de(0x23b)]===_0x2fb88a)return Array[_0x4351de(0x3e7)](_0x1f1094);if(_0x519685){const _0x418763=_0x519685['getMatrix'](),_0x249f83=Object[_0x4351de(0x116)](_0x418763);for(const _0x1486d9 of _0x249f83){const _0x4bc7b2=Number(_0x1486d9),_0x1d2701=_0x418763[_0x4bc7b2];if(_0x1f1094[_0x4351de(0x23b)]===_0x2fb88a)break;for(const _0x188803 in _0x1d2701){const _0x5cf55b=Number(_0x188803);_0x5cf55b<_0x108868||_0x5cf55b>_0x3a3b7c||_0x1f1094[_0x4351de(0x207)](_0x5cf55b);}}}if(_0x435d5a){const _0x5b7d19=_0x435d5a[_0x4351de(0x2a5)](),_0x4c7e6c=Object[_0x4351de(0x116)](_0x5b7d19);for(const _0x40c698 of _0x4c7e6c){const _0x115560=Number(_0x40c698),_0x3cccc=_0x5b7d19[_0x115560];if(_0x1f1094['size']===_0x2fb88a)break;for(const _0x1177b9 in _0x3cccc){const _0x20fd24=Number(_0x1177b9);_0x20fd24<_0x108868||_0x20fd24>_0x3a3b7c||_0x1f1094[_0x4351de(0x207)](_0x20fd24);}}}return Array[_0x4351de(0x3e7)](_0x1f1094);},jn=_0x4a0eb4=>{const _0x5106f0=_0x429c2e,_0x39243e=new Set(),_0x564406=[];for(const _0x3d4b68 of _0x4a0eb4){const _0x2abdf7=_0x3d4b68[_0x5106f0(0x197)]+','+_0x3d4b68[_0x5106f0(0x247)]+','+_0x3d4b68[_0x5106f0(0x198)]+','+_0x3d4b68['endColumn'];_0x39243e[_0x5106f0(0x1d3)](_0x2abdf7)||(_0x39243e['add'](_0x2abdf7),_0x564406[_0x5106f0(0x390)](_0x3d4b68));}return _0x564406;};let Be=class extends f['Disposable']{constructor(_0x2e25d5,_0x38ddcc,_0x4b0a0d,_0xf9a85,_0x11030c){const _0x48cd89=_0x429c2e;super(),x(this,_0x48cd89(0x182),new ve[(_0x48cd89(0x314))](!0x0)),x(this,'_globalComputedStartHelpFunc',_0x2181bd=>{const _0x4735e3=_0x48cd89;this[_0x4735e3(0x182)]['next'](!0x1);}),x(this,_0x48cd89(0x24b),_0x5c83b7=>{const _0xd65ee7=_0x48cd89;this[_0xd65ee7(0x182)][_0xd65ee7(0x33b)](!0x0);}),(this[_0x48cd89(0x32d)]=_0x2e25d5,this[_0x48cd89(0x337)]=_0x38ddcc,this[_0x48cd89(0x20c)]=_0x4b0a0d,this[_0x48cd89(0x23c)]=_0xf9a85,this[_0x48cd89(0x3b0)]=_0x11030c,this[_0x48cd89(0x37c)](),this['_initPivotDataGetListener']());}['_init'](){const _0x37c7ce=_0x429c2e;this['_subjectCollectionChange'](),this[_0x37c7ce(0x166)](),this['_initPivotTextInfo'](),this[_0x37c7ce(0x2d6)]();}[_0x429c2e(0x29a)](){const _0x4b891d=_0x429c2e;this[_0x4b891d(0x23c)][_0x4b891d(0x1ca)](this[_0x4b891d(0x182)]),m[_0x4b891d(0x202)][_0x4b891d(0x2a2)](m[_0x4b891d(0x321)][_0x4b891d(0x115)],this[_0x4b891d(0x396)]),m[_0x4b891d(0x202)][_0x4b891d(0x2a2)](m[_0x4b891d(0x321)][_0x4b891d(0x268)],this[_0x4b891d(0x24b)]);}[_0x429c2e(0x15d)](){const _0xefc2e9=_0x429c2e;this[_0xefc2e9(0x1a8)](this[_0xefc2e9(0x20c)][_0xefc2e9(0x1af)](_0x59e00f=>{const _0x183a23=_0xefc2e9;_0x59e00f['id']===V[_0x183a23(0x139)]['id']&&this[_0x183a23(0x32d)][_0x183a23(0x1e2)](_0x59e00f[_0x183a23(0x1ae)]);})),this[_0xefc2e9(0x1a8)](this['_commandService'][_0xefc2e9(0x1af)](_0x4ee886=>{const _0x1c2902=_0xefc2e9;if(_0x4ee886['id']!==Ft['id'])return;const _0x1b96e4=_0x4ee886['params'],{unitId:_0x242775,subUnitId:_0x4051b1,pivotTableId:_0x510304}=_0x1b96e4,_0x4a0bf7=_0x1b96e4[_0x1c2902(0x1ae)]['type'],_0x5afa17={};switch(_0x4a0bf7){case k[_0x1c2902(0x1bc)]:{const _0x324148=_0x1b96e4[_0x1c2902(0x1ae)][_0x1c2902(0x26f)];if(!_0x324148)return;const {row:_0x386845,col:_0x3501f8,cellData:_0x2ea4f7,pivotItemRenderInfoCache:_0x4df808,tableFieldId:_0x3a3830}=_0x324148,_0x428b0c=this['_sheetsPivotDataSourceModel'][_0x1c2902(0x1ff)](_0x1b96e4['pivotTableId']);if(!_0x428b0c||!_0x4df808)return;if(_0x3a3830){const _0x3d664c=_0x428b0c[_0x1c2902(0x209)](_0x3a3830);if(!_0x3d664c)return;_0x5afa17[_0x1c2902(0x26f)]={..._0x428b0c['getDataFieldItemInfo'](_0x3d664c),'tableFieldId':_0x3a3830,'pivotTableId':_0x1b96e4[_0x1c2902(0x255)],'filterInfo':_0x428b0c[_0x1c2902(0x256)](_0x3a3830),'sortInfo':_0x428b0c['getSortInfo'](_0x3a3830),'format':_0x428b0c['getFieldFormat'](_0x3a3830)};}else{const _0xb45e7c=Ht(_0x386845,_0x3501f8,_0x2ea4f7,_0x428b0c,_0x4df808),_0x18bce4=_0xb45e7c==null?void 0x0:_0xb45e7c['filterId'];if(!_0x18bce4)return;const _0x51be84=_0x428b0c[_0x1c2902(0x209)](_0x18bce4);if(!_0x51be84)return;_0x5afa17[_0x1c2902(0x26f)]={..._0x428b0c[_0x1c2902(0x2ce)](_0x51be84),'tableFieldId':_0x18bce4,'pivotTableId':_0x1b96e4[_0x1c2902(0x255)],'filterInfo':_0x428b0c[_0x1c2902(0x256)](_0x18bce4),'sortInfo':_0x428b0c[_0x1c2902(0x335)](_0x18bce4),'format':_0x428b0c[_0x1c2902(0x341)](_0x18bce4)};}}break;case k[_0x1c2902(0x3a5)]:{const _0x1b31b4=_0x1b96e4['params'][_0x1c2902(0x31e)];if(!_0x1b31b4)return;const {pivotTableId:_0x5e8266}=_0x1b31b4,_0x52887d=this[_0x1c2902(0x32d)]['getPivotTableInstance'](_0x5e8266);if(!_0x52887d)return;const _0x3842cf=this[_0x1c2902(0x32d)][_0x1c2902(0x2cb)](_0x242775,_0x4051b1,_0x5e8266),_0x1be6a4=Xt(_0x52887d,_0x5e8266,_0x3842cf);_0x5afa17['panel']=_0x1be6a4;}break;case k[_0x1c2902(0x383)]:{const _0x2dc543=this['_sheetsPivotDataSourceModel'][_0x1c2902(0x1ff)](_0x510304),_0x4c32e1=this[_0x1c2902(0x32d)][_0x1c2902(0x11c)](_0x242775),_0x17ab8e=_0x4c32e1[_0x1c2902(0x302)](_0x510304);let _0x4cc764=null;const _0x2f5479=this[_0x1c2902(0x32d)][_0x1c2902(0x2cb)](_0x242775,_0x4051b1,_0x510304),_0x36cc4f=_0x1b96e4[_0x1c2902(0x1ae)][_0x1c2902(0x152)];if(!_0x2dc543||!_0x2f5479||!_0x36cc4f)return!0x1;const {dataFieldId:_0x1c95ee,fieldArea:_0x4ab7ab,index:_0x3e417e}=_0x36cc4f;_0x2dc543[_0x1c2902(0x351)]();const _0x4b73b3=_0x2dc543[_0x1c2902(0x16f)](_0x1c95ee,_0x4ab7ab,_0x3e417e);if(_0x4b73b3&&_0x4ab7ab===m[_0x1c2902(0x1d8)][_0x1c2902(0x404)]){const _0x10d568=_0x4b73b3[_0x1c2902(0x319)](),_0x1b4291=_0x2dc543[_0x1c2902(0x209)](_0x10d568);if(_0x1b4291){const _0x12b9b8=_0x1b4291==null?void 0x0:_0x1b4291['getFieldDataType']();_0x2dc543['setSubtotalType'](_0x4b73b3[_0x1c2902(0x319)](),_0x12b9b8===m[_0x1c2902(0x131)][_0x1c2902(0x3d2)]?m[_0x1c2902(0x31d)][_0x1c2902(0x2f5)]:m[_0x1c2902(0x31d)][_0x1c2902(0x3e6)]);}const _0x13d1fa=_0x2dc543[_0x1c2902(0x365)](),_0x24aa4f=_0x2dc543['getValuePosition'](),_0x4674c3=_0x2dc543[_0x1c2902(0x37a)](m[_0x1c2902(0x1d8)][_0x1c2902(0x404)]);if(_0x13d1fa===-0x1&&_0x4674c3>0x1){const _0x31d72f=_0x24aa4f===m['PivotTableValuePositionEnum'][_0x1c2902(0x1c8)]?m[_0x1c2902(0x284)][_0x1c2902(0x26e)]:_0x24aa4f,_0x55a66d=_0x31d72f===m[_0x1c2902(0x284)][_0x1c2902(0x110)]?m[_0x1c2902(0x1d8)][_0x1c2902(0x110)]:m[_0x1c2902(0x1d8)][_0x1c2902(0x26e)];_0x2dc543[_0x1c2902(0x3e2)](_0x31d72f,_0x2dc543[_0x1c2902(0x37a)](_0x55a66d));}}else{if(_0x4b73b3&&(_0x4ab7ab===m[_0x1c2902(0x1d8)][_0x1c2902(0x110)]||_0x4ab7ab===m['PivotTableFiledAreaEnum'][_0x1c2902(0x26e)])){const _0x4a8e2b=_0x4b73b3['getId'](),_0x2232e5=_0x2dc543[_0x1c2902(0x209)](_0x4a8e2b);if(_0x2232e5&&(_0x2232e5==null?void 0x0:_0x2232e5['getFieldDataType']())===m[_0x1c2902(0x131)][_0x1c2902(0x2d1)]){const _0x159866=_0x2232e5[_0x1c2902(0x1b5)]();if(_0x159866&&_0x2dc543[_0x1c2902(0x259)](_0x4b73b3[_0x1c2902(0x319)](),_0x159866),!_0x17ab8e['getFieldIds']()[_0x1c2902(0x138)](_0x43272f=>{const _0x34a1f2=_0x1c2902,_0x2dbd89=_0x17ab8e[_0x34a1f2(0x3b4)](_0x43272f);return m[_0x34a1f2(0x28c)](_0x2dbd89)?_0x2dbd89[_0x34a1f2(0x24a)]()['originalFieldId']===_0x1c95ee:!0x1;})){const _0x55dc2e=_0x4c32e1['createDataFieldId'](),_0x40af04=fn(_0x2232e5[_0x1c2902(0x36a)],_0x2232e5['minDate']),_0x54e83d=_0x2232e5[_0x1c2902(0x25d)]()+'\x20-\x20'+zt(this[_0x1c2902(0x3b0)],_0x40af04),_0x3aafdf=new m[(_0x1c2902(0x13a))](_0x55dc2e,_0x54e83d,m[_0x1c2902(0x26b)](0x3),_0x2232e5[_0x1c2902(0x319)](),_0x40af04);_0x4c32e1[_0x1c2902(0x188)](_0x3aafdf),_0x17ab8e[_0x1c2902(0x2ae)](_0x55dc2e,_0x54e83d),_0x2dc543[_0x1c2902(0x16f)](_0x55dc2e,_0x4ab7ab,(_0x3e417e!=null?_0x3e417e:0x0)+0x1),_0x4cc764=_0x3aafdf;}}}}const _0x1b0e70=_0x2dc543['isEmpty'](),_0x297822=_0x2dc543['query']()['toJSON']();let _0x38afdf;if(_0x4cc764){_0x38afdf=_0x4cc764[_0x1c2902(0x1e9)]();const _0x42b2a4=_0x4cc764[_0x1c2902(0x319)]();_0x17ab8e[_0x1c2902(0x3e3)](_0x42b2a4);let _0x17d5cb=!0x0;for(const _0x557dd4 in _0x4c32e1['collections'])if(_0x4c32e1['collections'][_0x557dd4][_0x1c2902(0x2fd)]()[_0x1c2902(0x35f)](_0x42b2a4)){_0x17d5cb=!0x1;break;}_0x17d5cb&&_0x4c32e1['deleteDataField'](_0x42b2a4);}const _0x12b87a=_0x2dc543[_0x1c2902(0x374)]();_0x5afa17['addPivotField']={'view':_0x297822,'changesets':_0x12b87a,'isEmpty':_0x1b0e70,'pivotTableConfig':_0x2f5479,'shouldBeAddedGroupJSON':_0x38afdf};}break;case k[_0x1c2902(0x265)]:{const _0x51ed74=_0x1b96e4['params'][_0x1c2902(0x3a2)];if(!_0x51ed74)return;const _0x16b823=_0x51ed74[_0x1c2902(0x2aa)],_0x4cc167=_0x51ed74[_0x1c2902(0x255)],{collection:_0x18a5e5}=this[_0x1c2902(0x32d)]['createCollectionWithDataRange']({'unitId':_0x16b823[_0x1c2902(0x332)],'sheetName':_0x16b823[_0x1c2902(0x29d)],'subUnitId':_0x16b823['subUnitId'],'range':_0x16b823[_0x1c2902(0x17f)]}),_0x1a755f=new m[(_0x1c2902(0x202))](_0x18a5e5,void 0x0,_0x4cc167),_0x48cdc3=_0x1a755f[_0x1c2902(0x14e)](),_0x3e768f=_0x1a755f['toJSON'](),_0x1ae3ce=_0x18a5e5[_0x1c2902(0x1e9)]();_0x5afa17[_0x1c2902(0x3a2)]={'view':_0x48cdc3,'fieldsConfig':_0x3e768f,'collectionConfig':_0x1ae3ce,'isEmpty':_0x1a755f[_0x1c2902(0x2f1)]()};}break;case k[_0x1c2902(0x409)]:{const _0x192d3d=_0x1b96e4[_0x1c2902(0x1ae)][_0x1c2902(0x401)];if(!_0x192d3d)return;const {fieldId:_0x1a38bc,area:_0xb09748,index:_0x112944}=_0x192d3d,_0x309ee7=this[_0x1c2902(0x32d)][_0x1c2902(0x2cb)](_0x242775,_0x4051b1,_0x510304);if(!_0x309ee7)return;const _0x21688c=this[_0x1c2902(0x32d)][_0x1c2902(0x1ff)](_0x510304);if(!_0x21688c)return;_0x21688c['startCollectChangeset']();const {area:_0x2a0664,index:_0x4b2ae5}=_0x21688c[_0x1c2902(0x1ab)](_0x1a38bc);if(_0x21688c[_0x1c2902(0x37f)](_0x1a38bc,_0xb09748,_0x112944),_0xb09748===m[_0x1c2902(0x1d8)]['Value']&&_0x21688c[_0x1c2902(0x24e)](_0x1a38bc)['getSubtotal']()===void 0x0){const _0x5a9004=_0x21688c[_0x1c2902(0x24e)](_0x1a38bc);if(_0x5a9004&&_0x5a9004[_0x1c2902(0x331)]()===void 0x0){const _0x576d83=_0x21688c[_0x1c2902(0x209)](_0x1a38bc);if(_0x576d83){const _0x4cfcfc=_0x576d83==null?void 0x0:_0x576d83['getFieldDataType']();_0x21688c['setSubtotalType'](_0x1a38bc,_0x4cfcfc===m[_0x1c2902(0x131)][_0x1c2902(0x3d2)]?m[_0x1c2902(0x31d)]['sum']:m['PivotSubtotalTypeEnum'][_0x1c2902(0x3e6)]);}}}const _0x4323=_0x21688c[_0x1c2902(0x221)](),_0x32813e=_0x21688c[_0x1c2902(0x365)](),_0x5e1f1f=_0x21688c[_0x1c2902(0x37a)](m['PivotTableFiledAreaEnum'][_0x1c2902(0x404)])>0x1;if(_0x5e1f1f&&_0x2a0664===_0xb09748&&(_0xb09748===m[_0x1c2902(0x1d8)][_0x1c2902(0x110)]&&_0x4323===m[_0x1c2902(0x284)][_0x1c2902(0x110)]||_0xb09748===m[_0x1c2902(0x1d8)][_0x1c2902(0x26e)]&&_0x4323===m[_0x1c2902(0x284)]['Column'])){let _0x169cab=_0x32813e;_0x4b2ae5<=_0x32813e&&_0x169cab--,_0x112944<=_0x32813e&&_0x169cab++,_0x21688c[_0x1c2902(0x3e2)](_0x4323,_0x169cab);}else _0x5e1f1f&&(_0x2a0664===m[_0x1c2902(0x1d8)][_0x1c2902(0x110)]&&_0x4323===m[_0x1c2902(0x284)][_0x1c2902(0x110)]||_0x2a0664===m[_0x1c2902(0x1d8)][_0x1c2902(0x26e)]&&_0x4323===m[_0x1c2902(0x284)]['Column'])&&_0x32813e>=_0x4b2ae5&&_0x21688c[_0x1c2902(0x3e2)](_0x4323,_0x32813e-0x1),_0x5e1f1f&&(_0xb09748===m['PivotTableFiledAreaEnum'][_0x1c2902(0x110)]&&_0x4323===m[_0x1c2902(0x284)][_0x1c2902(0x110)]||_0xb09748===m['PivotTableFiledAreaEnum'][_0x1c2902(0x26e)]&&_0x4323===m[_0x1c2902(0x284)][_0x1c2902(0x26e)])&&_0x32813e>=_0x112944&&_0x21688c[_0x1c2902(0x3e2)](_0x4323,_0x32813e+0x1);const _0xc37ef6=_0x21688c[_0x1c2902(0x14e)](),_0x25e587=_0x21688c[_0x1c2902(0x2f1)](),_0x2ee8d3=_0x21688c[_0x1c2902(0x374)]();_0x5afa17['movePivotField']={'view':_0xc37ef6[_0x1c2902(0x1e9)](),'changesets':_0x2ee8d3,'isEmpty':_0x25e587,'pivotTableConfig':_0x309ee7};}break;case k[_0x1c2902(0x3b7)]:{const _0x22d411=_0x1b96e4['params'][_0x1c2902(0x1c9)];if(!_0x22d411)return;const _0xd7f3e9=_0x22d411[_0x1c2902(0x406)],_0x367a46=this[_0x1c2902(0x32d)]['getPivotTableConfig'](_0x242775,_0x4051b1,_0x510304);if(!_0x367a46)return!0x1;const _0x530fda=this['_sheetsPivotDataSourceModel'][_0x1c2902(0x1ff)](_0x510304);if(!_0x530fda)return!0x1;_0x530fda[_0x1c2902(0x351)]();for(const _0x2296a0 of _0xd7f3e9){const {area:_0x319d84}=_0x530fda[_0x1c2902(0x1ab)](_0x2296a0);_0x319d84===m['PivotTableFiledAreaEnum'][_0x1c2902(0x404)]&&_0x530fda[_0x1c2902(0x3a0)](_0x2296a0),(_0x319d84===m[_0x1c2902(0x1d8)]['Row']||_0x319d84===m['PivotTableFiledAreaEnum']['Column'])&&_0x530fda['removeValueFilterInfo'](_0x2296a0),_0x530fda[_0x1c2902(0x128)](_0x2296a0);}const _0x2571e6=_0x530fda['isEmpty'](),_0x18d7d1=_0x530fda[_0x1c2902(0x14e)]()['toJSON'](),_0x13734a=_0x530fda['endCollectChangeset']();_0x5afa17[_0x1c2902(0x1c9)]={'changesets':_0x13734a,'pivotTableConfig':_0x367a46,'isEmpty':_0x2571e6,'view':_0x18d7d1};}break;case k[_0x1c2902(0x1d5)]:{const _0x564061=_0x1b96e4[_0x1c2902(0x1ae)][_0x1c2902(0x153)];if(!_0x564061)return;const {tableFieldId:_0x44ec8c,items:_0x74d36d,isAll:_0x560be8}=_0x564061,_0x2d8a1e=this[_0x1c2902(0x32d)][_0x1c2902(0x1ff)](_0x510304),_0x40e05e=this[_0x1c2902(0x32d)][_0x1c2902(0x2cb)](_0x242775,_0x4051b1,_0x510304);if(!_0x2d8a1e||!_0x40e05e)return;_0x2d8a1e[_0x1c2902(0x351)](),_0x2d8a1e[_0x1c2902(0x1f0)](_0x44ec8c,{'type':m[_0x1c2902(0x2e9)]['ManualFilter'],'list':_0x74d36d,'isAll':_0x560be8});const _0x3c1c81=_0x2d8a1e[_0x1c2902(0x2f1)](),_0x24c673=_0x2d8a1e[_0x1c2902(0x14e)]()[_0x1c2902(0x1e9)](),_0xe38076=_0x2d8a1e[_0x1c2902(0x374)]();_0x5afa17[_0x1c2902(0x153)]={'view':_0x24c673,'changesets':_0xe38076,'isEmpty':_0x3c1c81,'pivotTableConfig':_0x40e05e};}break;case k[_0x1c2902(0x277)]:{const _0x15650d=_0x1b96e4['params'][_0x1c2902(0x384)];if(!_0x15650d)return;const {tableFieldId:_0x3ffa17,filterInfo:_0x6c2366}=_0x15650d,_0x13c549=this[_0x1c2902(0x32d)][_0x1c2902(0x1ff)](_0x510304),_0x35348a=this[_0x1c2902(0x32d)][_0x1c2902(0x2cb)](_0x242775,_0x4051b1,_0x510304);if(!_0x13c549||!_0x35348a)return;_0x13c549[_0x1c2902(0x351)](),_0x13c549[_0x1c2902(0x376)](_0x3ffa17,_0x6c2366);const _0x48c931=_0x13c549[_0x1c2902(0x2f1)](),_0x47203d=_0x13c549['query']()[_0x1c2902(0x1e9)](),_0x428072=_0x13c549[_0x1c2902(0x374)]();_0x5afa17[_0x1c2902(0x384)]={'view':_0x47203d,'changesets':_0x428072,'isEmpty':_0x48c931,'pivotTableConfig':_0x35348a};}break;case k['SetPivotSort']:{const _0xa05e81=_0x1b96e4['params'][_0x1c2902(0x148)];if(!_0xa05e81)return;const {tableFieldId:_0x26eff1,info:_0x26638e}=_0xa05e81,_0x2e9945=this['_sheetsPivotDataSourceModel'][_0x1c2902(0x1ff)](_0x510304),_0x1266fc=this['_sheetsPivotDataSourceModel'][_0x1c2902(0x2cb)](_0x242775,_0x4051b1,_0x510304);if(!_0x2e9945||!_0x1266fc)return;_0x2e9945[_0x1c2902(0x351)](),_0x2e9945[_0x1c2902(0x287)](_0x26eff1,_0x26638e);const _0xfe79d5=_0x2e9945[_0x1c2902(0x2f1)](),_0x1800df=_0x2e9945[_0x1c2902(0x14e)]()[_0x1c2902(0x1e9)](),_0x5da2cd=_0x2e9945[_0x1c2902(0x374)]();_0x5afa17[_0x1c2902(0x148)]={'view':_0x1800df,'changesets':_0x5da2cd,'isEmpty':_0xfe79d5,'pivotTableConfig':_0x1266fc};}break;case k[_0x1c2902(0x299)]:{const _0x2c0fc8=_0x1b96e4[_0x1c2902(0x1ae)]['setPivotSetting'];if(!_0x2c0fc8)return;const {tableFieldId:_0xd5c0d3,displayName:_0x176533,subtotalType:_0x4475ce,format:_0x58d2}=_0x2c0fc8,_0x495ab9=this[_0x1c2902(0x32d)][_0x1c2902(0x1ff)](_0x510304),_0x26ce66=this[_0x1c2902(0x32d)][_0x1c2902(0x2cb)](_0x242775,_0x4051b1,_0x510304);if(!_0x495ab9||!_0x26ce66)return;_0x495ab9[_0x1c2902(0x351)](),_0x176533!==void 0x0&&_0x495ab9[_0x1c2902(0x350)](_0xd5c0d3,_0x176533),_0x4475ce!==void 0x0&&_0x495ab9[_0x1c2902(0x22d)](_0xd5c0d3,_0x4475ce),_0x58d2!==void 0x0&&_0x495ab9[_0x1c2902(0x259)](_0xd5c0d3,_0x58d2);const _0x321b8d=_0x495ab9[_0x1c2902(0x2f1)](),_0x48c142=_0x495ab9['query']()[_0x1c2902(0x1e9)](),_0x291295=_0x495ab9[_0x1c2902(0x374)]();_0x5afa17[_0x1c2902(0x1d2)]={'changesets':_0x291295,'pivotTableConfig':_0x26ce66,'isEmpty':_0x321b8d,'view':_0x48c142};}break;case k[_0x1c2902(0x3b5)]:{const _0x49e5e4=_0x1b96e4[_0x1c2902(0x1ae)][_0x1c2902(0x1c1)];if(!_0x49e5e4)return;const {dataRangeInfo:_0x26f1df,unitId:_0xfda966,subUnitId:_0x4379c8}=_0x49e5e4,_0xf2f313=this['_sheetsPivotDataSourceModel'][_0x1c2902(0x2cb)](_0xfda966,_0x4379c8,_0x510304),_0x35eed5=this[_0x1c2902(0x32d)][_0x1c2902(0x1ff)](_0x510304);if(!this['_sheetsPivotDataSourceModel'][_0x1c2902(0x302)](_0xfda966,_0x510304)||!_0x35eed5||!_0xf2f313)return;const _0x2fe669=this[_0x1c2902(0x32d)][_0x1c2902(0x1c7)](_0xfda966,_0x510304,_0x26f1df),_0x2af339=this['_sheetsPivotDataSourceModel']['getCollection'](_0xfda966,_0x510304)[_0x1c2902(0x1e9)](),{collection:_0xa8792e}=this[_0x1c2902(0x32d)][_0x1c2902(0x397)]({'unitId':_0x26f1df[_0x1c2902(0x332)],'sheetName':_0x26f1df[_0x1c2902(0x29d)],'subUnitId':_0x26f1df[_0x1c2902(0x3c0)],'range':_0x26f1df[_0x1c2902(0x17f)]}),_0x37d8e5=_0xa8792e['toJSON']();_0x35eed5['startCollectChangeset']();const _0x528154=this[_0x1c2902(0x32d)]['getDataFieldManager'](_0xfda966)[_0x1c2902(0x3a3)]()||m[_0x1c2902(0x30c)];_0x35eed5[_0x1c2902(0x24d)](_0x433b5d=>{const _0x517c9a=_0x1c2902,_0x51e938=_0x433b5d[_0x517c9a(0x2e1)]();if(!_0xa8792e[_0x517c9a(0x2e4)](_0x51e938)){const _0x53f12c=_0xa8792e[_0x517c9a(0x3c1)](_0x433b5d[_0x517c9a(0x126)]());if(_0x53f12c){_0x35eed5['updateFieldSourceInfo'](_0x433b5d[_0x517c9a(0x319)](),_0x53f12c['getName'](),_0x53f12c[_0x517c9a(0x319)]());const {area:_0x540518}=_0x35eed5['getFieldPositionInfoById'](_0x433b5d[_0x517c9a(0x319)]());let _0x1a408f=_0x433b5d[_0x517c9a(0x126)]();const _0x168490=_0x433b5d[_0x517c9a(0x416)]();if(_0x540518===m['PivotTableFiledAreaEnum'][_0x517c9a(0x404)]){const _0x2563a0=_0x433b5d[_0x517c9a(0x331)]();_0x1a408f=_0x528154(_0x53f12c[_0x517c9a(0x25d)](),_0x2563a0);}_0x168490!==_0x1a408f&&_0x35eed5['renameField'](_0x433b5d[_0x517c9a(0x319)](),_0x1a408f);}else _0x35eed5['removeField'](_0x433b5d['getId']());}});const _0x40d8e8=_0x35eed5[_0x1c2902(0x2f1)](),_0x375a88=_0x35eed5[_0x1c2902(0x14e)]()['toJSON'](),_0x33ebac=_0x35eed5['endCollectChangeset']();_0x5afa17[_0x1c2902(0x1c1)]={'view':_0x375a88,'changesets':_0x33ebac,'isEmpty':_0x40d8e8,'pivotTableConfig':_0xf2f313,'collectionConfig':_0x37d8e5,'oldCollectionConfig':_0x2af339,'deleteIds':_0x2fe669};}break;case k[_0x1c2902(0x229)]:{const _0x12f52e=_0x1b96e4[_0x1c2902(0x1ae)][_0x1c2902(0x3e2)];if(!_0x12f52e)return;const {position:_0x3cf727,index:_0xd7d36f}=_0x12f52e,_0x2bce54=this['_sheetsPivotDataSourceModel']['getPivotTableConfig'](_0x242775,_0x4051b1,_0x510304);if(!_0x2bce54)return!0x1;const _0x511177=this['_sheetsPivotDataSourceModel'][_0x1c2902(0x1ff)](_0x510304);if(!_0x511177)return!0x1;_0x511177['startCollectChangeset'](),_0x511177[_0x1c2902(0x3e2)](_0x3cf727,_0xd7d36f);const _0x3a254b=_0x511177[_0x1c2902(0x2f1)](),_0x5f14b8=_0x511177[_0x1c2902(0x14e)]()[_0x1c2902(0x1e9)](),_0x54d5b1=_0x511177['endCollectChangeset']();_0x5afa17[_0x1c2902(0x3e2)]={'changesets':_0x54d5b1,'pivotTableConfig':_0x2bce54,'isEmpty':_0x3a254b,'view':_0x5f14b8};}break;case k[_0x1c2902(0x1dc)]:{const _0x5edc5b=_0x1b96e4['params'][_0x1c2902(0x32e)];if(!_0x5edc5b)return;const {tableFieldId:_0x346d53,collapse:_0x59fe78,item:_0x11f96f}=_0x5edc5b,_0x50f43c=this[_0x1c2902(0x32d)][_0x1c2902(0x1ff)](_0x510304),_0x9abb08=this[_0x1c2902(0x32d)][_0x1c2902(0x2cb)](_0x242775,_0x4051b1,_0x510304);if(!_0x50f43c||!_0x9abb08)return;_0x50f43c[_0x1c2902(0x351)](),_0x50f43c[_0x1c2902(0x393)](_0x346d53,_0x59fe78,_0x11f96f);const _0x337be1=_0x50f43c[_0x1c2902(0x2f1)](),_0x11c544=_0x50f43c['query']()['toJSON'](),_0x31a8f1=_0x50f43c['endCollectChangeset']();_0x5afa17[_0x1c2902(0x32e)]={'view':_0x11c544,'isEmpty':_0x337be1,'pivotTableConfig':_0x9abb08,'changesets':_0x31a8f1};}break;case k[_0x1c2902(0x245)]:{const _0x5ca5a7=_0x1b96e4[_0x1c2902(0x1ae)]['setPivotTableConfig'];if(!_0x5ca5a7)return;const {pivotTableConfig:_0x338dfa}=_0x5ca5a7,_0x3d4e7f=this['_sheetsPivotDataSourceModel'][_0x1c2902(0x1ff)](_0x510304),_0x15b0b1=this[_0x1c2902(0x32d)][_0x1c2902(0x2cb)](_0x242775,_0x4051b1,_0x510304);if(!_0x3d4e7f||!_0x15b0b1)return;_0x3d4e7f[_0x1c2902(0x351)](),un(_0x3d4e7f,_0x338dfa);const _0x4698dd=_0x3d4e7f[_0x1c2902(0x2f1)](),_0x4a3246=_0x3d4e7f[_0x1c2902(0x14e)]()[_0x1c2902(0x1e9)](),_0x5dbe01=_0x3d4e7f[_0x1c2902(0x374)]();_0x5afa17['setPivotTableConfig']={'view':_0x4a3246,'isEmpty':_0x4698dd,'pivotTableConfig':{..._0x15b0b1,'fieldsConfig':_0x3d4e7f[_0x1c2902(0x1e9)]()},'changesets':_0x5dbe01};}break;case k[_0x1c2902(0x111)]:{const _0x4577f7=_0x1b96e4[_0x1c2902(0x1ae)][_0x1c2902(0x323)];if(!_0x4577f7)return;const _0x4c6a56=this[_0x1c2902(0x32d)]['getPivotTableInstance'](_0x510304),_0x5c6a40=this[_0x1c2902(0x32d)]['getPivotTableConfig'](_0x242775,_0x4051b1,_0x510304);if(!_0x4c6a56||!_0x5c6a40)return;_0x4c6a56[_0x1c2902(0x351)](),gn(_0x4c6a56,_0x4577f7['resetArea']);const _0x151633=_0x4c6a56['query']()[_0x1c2902(0x1e9)](),_0x4e10b5=_0x4c6a56[_0x1c2902(0x374)]();_0x5afa17[_0x1c2902(0x323)]={'view':_0x151633,'isEmpty':!0x0,'pivotTableConfig':{..._0x5c6a40,'fieldsConfig':_0x4c6a56[_0x1c2902(0x1e9)]()},'changesets':_0x4e10b5};}break;case k[_0x1c2902(0x23d)]:{const _0x574b48=_0x1b96e4[_0x1c2902(0x1ae)][_0x1c2902(0x2b6)];if(!_0x574b48)return;const _0x52df02=_0x574b48[_0x1c2902(0x2aa)],_0x520ee5=_0x574b48[_0x1c2902(0x255)],{collection:_0x2d8312}=this['_sheetsPivotDataSourceModel'][_0x1c2902(0x397)]({'unitId':_0x52df02[_0x1c2902(0x332)],'sheetName':_0x52df02[_0x1c2902(0x29d)],'subUnitId':_0x52df02[_0x1c2902(0x3c0)],'range':_0x52df02[_0x1c2902(0x17f)]}),_0x54682e=new m[(_0x1c2902(0x202))](_0x2d8312,void 0x0,_0x520ee5),_0x5654ae=_0x2d8312[_0x1c2902(0x2fd)](),{rows:_0x57e760,columns:_0xeb60da,filters:_0x36cd12,values:_0x29a19f}=_0x574b48[_0x1c2902(0x156)];_0x54682e[_0x1c2902(0x351)]();for(const {field:_0x1316c6,selectedItems:_0x5ba358}of _0x57e760||[]){const _0x282142=_0x5654ae[_0x1316c6];if(_0x282142){const _0x103a6a=_0x54682e[_0x1c2902(0x16f)](_0x282142,m[_0x1c2902(0x1d8)][_0x1c2902(0x110)]);_0x5ba358&&_0x103a6a&&_0x54682e['setLabelFilterInfo'](_0x103a6a[_0x1c2902(0x319)](),{'type':m[_0x1c2902(0x2e9)][_0x1c2902(0x23f)],'list':_0x5ba358,'isAll':!0x1});}}for(const {field:_0x58c792,selectedItems:_0xd5593b}of _0xeb60da||[]){const _0x59b7e8=_0x5654ae[_0x58c792];if(_0x59b7e8){const _0x204cf2=_0x54682e[_0x1c2902(0x16f)](_0x59b7e8,m[_0x1c2902(0x1d8)][_0x1c2902(0x26e)]);_0xd5593b&&_0x204cf2&&_0x54682e['setLabelFilterInfo'](_0x204cf2[_0x1c2902(0x319)](),{'type':m['PivotFilterTypeEnum'][_0x1c2902(0x23f)],'list':_0xd5593b,'isAll':!0x1});}}for(const {field:_0x30e695,selectedItems:_0x2c8813}of _0x36cd12||[]){const _0x382f44=_0x5654ae[_0x30e695];if(_0x382f44){const _0x427297=_0x54682e[_0x1c2902(0x16f)](_0x382f44,m[_0x1c2902(0x1d8)]['Filter']);_0x2c8813&&_0x427297&&_0x54682e['setLabelFilterInfo'](_0x427297[_0x1c2902(0x319)](),{'type':m[_0x1c2902(0x2e9)]['ManualFilter'],'list':_0x2c8813,'isAll':!0x1});}}for(const {field:_0x1a2a0d,subTotalType:_0x53c356,formatString:_0x454b15}of _0x29a19f||[]){const _0x3cbcca=_0x2d8312[_0x1c2902(0x3b4)](_0x5654ae[_0x1a2a0d]);if(!_0x3cbcca)continue;const _0x3dd84a=_0x5654ae[_0x1a2a0d];if(_0x3dd84a){const _0x2c86a5=_0x54682e[_0x1c2902(0x16f)](_0x3dd84a,m['PivotTableFiledAreaEnum']['Value']);if(_0x2c86a5){if(_0x53c356!==void 0x0){_0x54682e[_0x1c2902(0x22d)](_0x2c86a5['getId'](),_0x53c356);const _0x16791d=this[_0x1c2902(0x32d)][_0x1c2902(0x11c)](_0x52df02[_0x1c2902(0x332)])[_0x1c2902(0x3a3)]()||m['getAutoDisplayName'],_0x113b10=_0x2d8312[_0x1c2902(0x416)](_0x3dd84a),_0x3978a0=_0x16791d(_0x113b10,_0x53c356);_0x54682e['renameField'](_0x2c86a5[_0x1c2902(0x319)](),_0x3978a0);}else{if(_0x3cbcca){const _0xa6839d=_0x3cbcca==null?void 0x0:_0x3cbcca['getFieldDataType']();_0x54682e[_0x1c2902(0x22d)](_0x2c86a5[_0x1c2902(0x319)](),_0xa6839d===m[_0x1c2902(0x131)]['number']?m['PivotSubtotalTypeEnum']['sum']:m[_0x1c2902(0x31d)][_0x1c2902(0x3e6)]);}}_0x454b15&&_0x54682e[_0x1c2902(0x259)](_0x2c86a5['getId'](),_0x454b15);}}}const _0x53268d=_0x54682e[_0x1c2902(0x14e)](),_0x1f217f=_0x54682e['toJSON'](),_0x7d9bf7=_0x54682e['isEmpty'](),_0x1aedd6=_0x54682e[_0x1c2902(0x374)](),_0xd0494=_0x2d8312[_0x1c2902(0x1e9)]();_0x5afa17[_0x1c2902(0x2b6)]={'view':_0x53268d,'fieldsConfig':_0x1f217f,'collectionConfig':_0xd0494,'isEmpty':_0x7d9bf7,'changesets':_0x1aedd6};}break;case k[_0x1c2902(0x2e8)]:{const _0x26b84f=sn(this['_injector'],_0x1b96e4);if(!_0x26b84f)return;const {range:_0x2452e5,sourceSubUnitId:_0x3ffdd5,sourceUnitId:_0x19986d,formatMap:_0x24f1d2,indexes:_0x20c60f}=_0x26b84f;_0x5afa17[_0x1c2902(0x3d1)]={'range':_0x2452e5,'sourceSubUnitId':_0x3ffdd5,'sourceUnitId':_0x19986d,'formatMap':_0x24f1d2,'indexes':_0x20c60f};}break;}this['_commandService'][_0x1c2902(0x301)](wt['id'],{'version':_0x1b96e4[_0x1c2902(0x2ac)],'result':_0x5afa17},{'onlyLocal':!0x0});}));}[_0x429c2e(0x293)](){const _0xcf5218=_0x429c2e;this[_0xcf5218(0x1a8)](this[_0xcf5218(0x20c)][_0xcf5218(0x1af)](_0x3db499=>{const _0x28e8d3=_0xcf5218;if(_0x3db499['id']!==Rt['id'])return;const _0x2481f0=_0x3db499[_0x28e8d3(0x1ae)];return this['_sheetsPivotDataSourceModel'][_0x28e8d3(0x150)](_0x2481f0['textInfo']),!0x0;}));}[_0x429c2e(0x35a)](){const _0x29e094=_0x429c2e;this[_0x29e094(0x32d)]['collectionChange$'][_0x29e094(0x243)](_0x31c786=>{const _0x1bda66=_0x29e094;switch(_0x31c786['type']){case Se[_0x1bda66(0x207)]:_0x31c786['dataRangeInfo']&&_0x31c786[_0x1bda66(0x3d5)]&&this[_0x1bda66(0x3e4)](_0x31c786['token'],_0x31c786[_0x1bda66(0x303)],_0x31c786[_0x1bda66(0x3d5)]);break;case Se[_0x1bda66(0x176)]:{const {unitId:_0x3f1923,subUnitId:_0xa57d5f,token:_0x1a4329}=_0x31c786;_0x3f1923&&_0xa57d5f&&_0x1a4329&&this['removeSourceRangeChange'](_0x3f1923,_0xa57d5f,_0x1a4329);}break;case Se[_0x1bda66(0x3a9)]:{const {token:_0x2936ca,oldSourceRangeInfo:_0x555ed9,dataRangeInfo:_0x14593a,targetCellInfo:_0x139099}=_0x31c786,{unitId:_0x3ed9dd,subUnitId:_0x4bee79}=_0x555ed9||{};_0x3ed9dd&&_0x4bee79&&_0x2936ca&&this[_0x1bda66(0x2d0)](_0x3ed9dd,_0x4bee79,_0x2936ca),_0x14593a&&_0x139099&&this[_0x1bda66(0x3e4)](_0x2936ca,_0x14593a,_0x139099);}break;}});}[_0x429c2e(0x2d6)](){const _0x1ac897=_0x429c2e;this[_0x1ac897(0x32d)][_0x1ac897(0x373)][_0x1ac897(0x243)](_0x156bad=>{const _0x5599dc=_0x1ac897;Object[_0x5599dc(0x116)](_0x156bad)[_0x5599dc(0x174)](_0x607192=>{const _0x1f3adc=_0x5599dc,_0x4a527b=this[_0x1f3adc(0x32d)][_0x1f3adc(0x2fe)](_0x607192);if(_0x4a527b){const _0x50f94f=this['_sheetsPivotDataSourceModel'][_0x1f3adc(0x2cb)](_0x4a527b==null?void 0x0:_0x4a527b[_0x1f3adc(0x332)],_0x4a527b==null?void 0x0:_0x4a527b['subUnitId'],_0x607192);_0x50f94f&&(this[_0x1f3adc(0x3e4)](_0x607192,_0x50f94f[_0x1f3adc(0x2aa)],_0x50f94f['targetCellInfo']),this[_0x1f3adc(0x35c)]([{'unitId':_0x4a527b[_0x1f3adc(0x332)],'subUnitId':_0x4a527b[_0x1f3adc(0x3c0)],'token':_0x607192}]));}});});}[_0x429c2e(0x166)](){const _0x241852=_0x429c2e;this[_0x241852(0x32d)][_0x241852(0x2a8)][_0x241852(0x243)](_0x530c8d=>{const {unitId:_0x876a19,subUnitId:_0x5826ae,pivotTableId:_0x249b68}=_0x530c8d;_0x876a19&&_0x5826ae&&_0x249b68&&this['triggerDirtyFeature']([{'unitId':_0x876a19,'subUnitId':_0x5826ae,'token':_0x249b68}]);});}[_0x429c2e(0x35c)](_0x450b79){const _0x22776a=_0x429c2e,_0x25dd51={};_0x450b79[_0x22776a(0x174)](_0x2ab76b=>{var _0x3d0fa3,_0x2b1cc3;const {unitId:_0x57f151,subUnitId:_0x384395,token:_0x404f76}=_0x2ab76b;_0x25dd51[_0x57f151]=(_0x3d0fa3=_0x25dd51[_0x57f151])!=null?_0x3d0fa3:{},_0x25dd51[_0x57f151][_0x384395]=(_0x2b1cc3=_0x25dd51[_0x57f151][_0x384395])!=null?_0x2b1cc3:{},_0x25dd51[_0x57f151][_0x384395][_0x404f76]=!0x0;}),this['_commandService'][_0x22776a(0x301)](Ke['id'],_0x25dd51);}[_0x429c2e(0x2d0)](_0x95d23e,_0x3496bf,_0x5eb972){const _0x44c526=_0x429c2e;this[_0x44c526(0x337)][_0x44c526(0x315)](_0x95d23e,_0x3496bf,[_0x5eb972]);}['handleSourceRangeChange'](_0xa33dfa,_0x417d48,_0x5f350d){const _0x128336=_0x429c2e,{unitId:_0x27e77e,subUnitId:_0x343187}=_0x417d48;this[_0x128336(0x337)]['has'](_0x5f350d[_0x128336(0x332)],_0x5f350d[_0x128336(0x3c0)],_0xa33dfa)&&this[_0x128336(0x2d0)](_0x27e77e,_0x343187,_0xa33dfa);const _0x443913={'sheetId':_0x343187,..._0x417d48};this[_0x128336(0x337)][_0x128336(0x15a)](_0x5f350d[_0x128336(0x332)],_0x5f350d[_0x128336(0x3c0)],_0xa33dfa,{'unitId':_0x5f350d[_0x128336(0x332)],'subUnitId':_0x5f350d[_0x128336(0x3c0)],'dependencyRanges':[_0x443913],'getDirtyData':(_0x4a9041,_0x10995e)=>{const _0x1b91cc=_0x128336,_0x205583=this[_0x1b91cc(0x32d)],_0x4e31f7=_0x205583[_0x1b91cc(0x2fe)](_0xa33dfa);if(!_0x4e31f7)return On();const {unitId:_0x3a8c4a,subUnitId:_0x848b11}=_0x4e31f7,_0x36eb71=kn(_0x4a9041,_0x10995e,_0x417d48);if(_0x36eb71['length']>0x0){const _0x2bd1dc=_0x205583[_0x1b91cc(0x302)](_0x27e77e,_0xa33dfa),_0x5018a9=_0x2bd1dc[_0x1b91cc(0x2fd)](),_0x4b7200=this[_0x1b91cc(0x154)](_0x417d48[_0x1b91cc(0x332)],_0x417d48['subUnitId'],_0x10995e),_0x156876={},_0x2acd80=this[_0x1b91cc(0x32d)][_0x1b91cc(0x11c)](_0x3a8c4a)[_0x1b91cc(0x3a3)]()||m[_0x1b91cc(0x30c)],_0x11e63f=[];for(const _0x3578d4 of _0x36eb71){const _0x3bf8d9=_0x3578d4-(_0x417d48[_0x1b91cc(0x17f)][_0x1b91cc(0x198)]||0x0),_0x1528bb=_0x5018a9[_0x3bf8d9];_0x11e63f[_0x1b91cc(0x390)](_0x1528bb),_0x156876[_0x1528bb]=_0x2bd1dc['getFieldById'](_0x1528bb)[_0x1b91cc(0x25d)](),_0x205583[_0x1b91cc(0x11c)](_0x27e77e)[_0x1b91cc(0x122)](_0x1528bb,_0x417d48,_0x3bf8d9,_0x4b7200);}_0x2bd1dc['getGroupFieldsInfoByIds'](_0x11e63f)[_0x1b91cc(0x174)](_0x585081=>{const _0x35e122=_0x1b91cc,[_0x3c2ac8,_0x5accc7]=_0x585081,_0x1a394b=_0x2bd1dc[_0x35e122(0x3b4)](_0x3c2ac8),_0x3d8b52=_0x2bd1dc[_0x35e122(0x3b4)](_0x5accc7);_0x1a394b&&_0x3d8b52&&_0x1a394b['refreshGroupField'](_0x3d8b52);}),_0x2bd1dc[_0x1b91cc(0x34f)]();const _0x561eae=_0x205583[_0x1b91cc(0x1ff)](_0xa33dfa);if(_0x561eae){An(_0x561eae,_0x156876,_0x2acd80),_0x561eae[_0x1b91cc(0x200)](!0x0);const _0x38a1fb=_0x561eae[_0x1b91cc(0x14e)](),_0xd624fe=_0x205583[_0x1b91cc(0x2cb)](_0x3a8c4a,_0x848b11,_0xa33dfa),_0x4ea774=_0x205583['getDataFieldManager'](_0x27e77e)['toJSON']();_0x205583[_0x1b91cc(0x3be)](_0x3a8c4a,_0x848b11,L[_0x1b91cc(0x1ce)],_0xa33dfa,_0x38a1fb,_0xd624fe,_0x4ea774,!0x0);}}return this['getDirtyInfo'](_0x3a8c4a,_0x848b11,_0xa33dfa);}});}['getMatrixFromRunTimeData'](_0xf356cd,_0x3758a2,_0x241ecc){var _0x438b3a,_0x30d239;const {arrayFormulaCellData:_0x2ac12e,unitData:_0x41bc4b}=_0x241ecc,_0x3734a2=(_0x438b3a=_0x2ac12e==null?void 0x0:_0x2ac12e[_0xf356cd])==null?void 0x0:_0x438b3a[_0x3758a2],_0x2c3992=(_0x30d239=_0x41bc4b==null?void 0x0:_0x41bc4b[_0xf356cd])==null?void 0x0:_0x30d239[_0x3758a2];return{'arrayFormulaCellDataMatrix':_0x3734a2,'unitDataMatrix':_0x2c3992};}['getDirtyInfo'](_0x7aa3c8,_0x4aae5c,_0x10c5fd){const _0x17b784=_0x429c2e,_0x6884eb=this[_0x17b784(0x32d)][_0x17b784(0x27d)](_0x7aa3c8,_0x4aae5c,_0x10c5fd),_0x99d186=[],_0x2859c0=new f['ObjectMatrix']();if(_0x6884eb){const {rangeCache:_0x5507ae,matrix:_0x354735,oldRangeCache:_0x377662,oldMatrix:_0x165d51}=_0x6884eb,_0x53acc7=nt(_0x377662),_0x2ce947=nt(_0x5507ae);_0x99d186[_0x17b784(0x390)](..._0x2ce947,..._0x53acc7),_0x165d51&&_0x377662&&_0x53acc7[_0x17b784(0x174)](_0x34c2f7=>{const _0x37900e=_0x17b784;for(let _0x387b7c=_0x34c2f7[_0x37900e(0x197)];_0x387b7c<=_0x34c2f7[_0x37900e(0x247)];_0x387b7c++)for(let _0x376020=_0x34c2f7[_0x37900e(0x198)];_0x376020<=_0x34c2f7[_0x37900e(0x1da)];_0x376020++)_0x2859c0['realDeleteValue'](_0x387b7c,_0x376020);}),_0x354735&&_0x2ce947&&_0x2ce947[_0x17b784(0x174)](_0x23682e=>{const _0x513c18=_0x17b784;for(let _0x193089=_0x23682e[_0x513c18(0x197)];_0x193089<=_0x23682e[_0x513c18(0x247)];_0x193089++)for(let _0x19d877=_0x23682e[_0x513c18(0x198)];_0x19d877<=_0x23682e['endColumn'];_0x19d877++)_0x2859c0[_0x513c18(0x196)](_0x193089,_0x19d877,_0x354735['getValue'](_0x193089,_0x19d877));});}const _0x1d3c4c={};return _0x1d3c4c[_0x7aa3c8]={[_0x4aae5c]:jn(_0x99d186)},{'runtimeCellData':{[_0x7aa3c8]:{[_0x4aae5c]:_0x2859c0}},'dirtyRanges':_0x1d3c4c};}[_0x429c2e(0x2d8)](){}};Be=xn([je(0x0,f[_0x429c2e(0x297)](exports['SheetsPivotDataSourceModel'])),je(0x1,f[_0x429c2e(0x297)](fe['IFeatureCalculationManagerService'])),je(0x2,f['Inject'](f[_0x429c2e(0x20e)])),je(0x3,f['Inject'](fe['GlobalComputingStatusService'])),je(0x4,f[_0x429c2e(0x297)](f['Injector']))],Be);var Ln=Object['getOwnPropertyDescriptor'],Bn=(_0x22b7b5,_0x444c8b,_0x40d42d,_0x363ea8)=>{for(var _0x53dd6a=_0x363ea8>0x1?void 0x0:_0x363ea8?Ln(_0x444c8b,_0x40d42d):_0x444c8b,_0x327374=_0x22b7b5['length']-0x1,_0x1368c7;_0x327374>=0x0;_0x327374--)(_0x1368c7=_0x22b7b5[_0x327374])&&(_0x53dd6a=_0x1368c7(_0x53dd6a)||_0x53dd6a);return _0x53dd6a;},et=(_0x1182bd,_0x35fd6e)=>(_0xfec978,_0xd6ef27)=>_0x35fd6e(_0xfec978,_0xd6ef27,_0x1182bd);let Ge=class extends f[_0x429c2e(0x141)]{constructor(_0x3f766a,_0x96f11f,_0x104783,_0x23e2c2){const _0xe3033f=_0x429c2e;super(),x(this,_0xe3033f(0x1ee),new f[(_0xe3033f(0x2b0))]()),(this[_0xe3033f(0x21b)]=_0x3f766a,this[_0xe3033f(0x2e0)]=_0x96f11f,this[_0xe3033f(0x119)]=_0x104783,this[_0xe3033f(0x36b)]=_0x23e2c2,this['_initClearSelectionCommandInterceptor']());}['_initClearSelectionCommandInterceptor'](){const _0x5db870=_0x429c2e;this['disposeWithMe'](this[_0x5db870(0x2e0)][_0x5db870(0x405)]({'getMutations':_0x16e331=>{const _0x34a8eb=_0x5db870;if(_0x16e331['id']===V['ClearSelectionContentCommand']['id']||_0x16e331['id']===V[_0x34a8eb(0x266)]['id']){const _0x57fb4c=[],_0x1adba8=[],_0x2e9b2a=this[_0x34a8eb(0x119)][_0x34a8eb(0x2e3)]()[_0x34a8eb(0x1e1)](_0x12dbe5=>_0x12dbe5[_0x34a8eb(0x17f)]),_0x373865=V[_0x34a8eb(0x41a)](this[_0x34a8eb(0x21b)]);if(!_0x373865)return{'redos':[],'undos':[]};const {unitId:_0x5102c0,subUnitId:_0x2fa77f}=_0x373865,_0xdacfa7={},_0x1f7360=this[_0x34a8eb(0x36b)][_0x34a8eb(0x181)](_0x5102c0,_0x2fa77f);if(_0x1f7360!=null&&_0x1f7360['size'])for(const [_0x204b58,_0x585d7c]of _0x1f7360){const {unitId:_0x353868,subUnitId:_0x23fc98,row:_0x34f480,col:_0x596322}=_0x585d7c['targetCellInfo'];_0x353868===_0x373865[_0x34a8eb(0x332)]&&_0x23fc98===_0x373865[_0x34a8eb(0x3c0)]&&(_0xdacfa7[_0x34f480+'-'+_0x596322]=_0x204b58);}return _0x2e9b2a&&_0x373865&&_0x2e9b2a['forEach'](_0x1cbeeb=>{f['Range']['foreach'](_0x1cbeeb,(_0x53cd38,_0x19f0ec)=>{const _0x47b36e=_0x3f2b,_0xd8f8fc=_0x53cd38+'-'+_0x19f0ec;if(_0xdacfa7[_0xd8f8fc]){const _0x502085=_0xdacfa7[_0xd8f8fc];_0x57fb4c[_0x47b36e(0x390)]({'id':He['id'],'params':{'unitId':_0x5102c0,'subUnitId':_0x2fa77f,'pivotTableId':_0x502085}});const _0x150f47=this[_0x47b36e(0x36b)]['getCollection'](_0x5102c0,_0x502085),_0x3d3a55=this[_0x47b36e(0x36b)][_0x47b36e(0x2cb)](_0x5102c0,_0x2fa77f,_0x502085);_0x1adba8[_0x47b36e(0x390)]({'id':_e['id'],'params':{'unitId':_0x5102c0,'subUnitId':_0x2fa77f,'pivotTableId':_0x502085,'pivotTableConfig':_0x3d3a55,'collectionConfig':_0x150f47}});}});}),{'redos':_0x57fb4c,'undos':_0x1adba8};}return{'redos':[],'undos':[]};}}));}};Ge=Bn([et(0x0,f[_0x429c2e(0x193)]),et(0x1,f[_0x429c2e(0x297)](V[_0x429c2e(0x1f6)])),et(0x2,f[_0x429c2e(0x297)](V['SheetsSelectionsService'])),et(0x3,f[_0x429c2e(0x297)](exports[_0x429c2e(0x224)]))],Ge);var Gn=Object['getOwnPropertyDescriptor'],Wn=(_0x2fdc45,_0x4afbd6,_0x39a500,_0x4fc0a6)=>{const _0x548339=_0x429c2e;for(var _0x14340d=_0x4fc0a6>0x1?void 0x0:_0x4fc0a6?Gn(_0x4afbd6,_0x39a500):_0x4afbd6,_0x287d7f=_0x2fdc45[_0x548339(0x2ca)]-0x1,_0x96c5b4;_0x287d7f>=0x0;_0x287d7f--)(_0x96c5b4=_0x2fdc45[_0x287d7f])&&(_0x14340d=_0x96c5b4(_0x14340d)||_0x14340d);return _0x14340d;},Le=(_0x475770,_0x3135f5)=>(_0x4d7680,_0x52f47f)=>_0x3135f5(_0x4d7680,_0x52f47f,_0x475770);let We=class extends f[_0x429c2e(0x141)]{constructor(_0x43c848,_0x2ba047,_0x47bb71,_0xa91bc0,_0x546d30){const _0x268d81=_0x429c2e;super(),this[_0x268d81(0x2e0)]=_0x43c848,this['_injector']=_0x2ba047,this[_0x268d81(0x21b)]=_0x47bb71,this[_0x268d81(0x36b)]=_0xa91bc0,this[_0x268d81(0x1a7)]=_0x546d30,this[_0x268d81(0x3ba)]();}[_0x429c2e(0x233)](_0x428c6f,_0x41bd45,_0x5bdc3d){const _0x343baa=_0x429c2e,{pageView:_0x9aaa2b,cornerView:_0x517377,rowView:_0x4e9318,colView:_0x39292c,dataView:_0x48a1b6}=_0x41bd45,_0x17eb83=_0x428c6f;let _0x41036e;if(_0x5bdc3d)_0x41036e=[...Yt(_0x17eb83)];else{const _0x603bc1=ne(_0x17eb83,_0x9aaa2b,!0x0),_0xc33262=_0x9aaa2b[_0x343baa(0x237)]>=0x0?_0x9aaa2b['lastRow']+0x1:0x0,_0x3e1614=_0x517377[_0x343baa(0x38b)],_0x30ecad=_0x517377['colCount'],_0x4c90e1=_0x603bc1[_0x343baa(0x2ca)]>0x0?we:0x0,_0xed802e=ne({'row':_0x17eb83['row']+_0xc33262+_0x4c90e1,'col':_0x17eb83[_0x343baa(0x18f)]},_0x517377,!0x1,!0x1),_0x4e983d=ne({'row':_0x17eb83[_0x343baa(0x216)]+_0xc33262+_0x4c90e1+_0x3e1614,'col':_0x17eb83['col']},_0x4e9318,!0x1,!0x0),_0x1cbc01=ne({'row':_0x17eb83[_0x343baa(0x216)]+_0xc33262+_0x4c90e1,'col':_0x17eb83[_0x343baa(0x18f)]+_0x30ecad},_0x39292c,!0x1,!0x0),_0x55d2c3=ne({'row':_0x17eb83[_0x343baa(0x216)]+_0xc33262+_0x4c90e1+_0x3e1614,'col':_0x17eb83[_0x343baa(0x18f)]+_0x30ecad},_0x48a1b6,!0x1,!0x0);_0x41036e=[..._0x603bc1,..._0xed802e,..._0x4e983d,..._0x1cbc01,..._0x55d2c3];}return _0x41036e;}[_0x429c2e(0x3ba)](){const _0x3b472b=_0x429c2e;this[_0x3b472b(0x1a8)](this['_sheetsPivotTableService'][_0x3b472b(0x211)][_0x3b472b(0x1d9)](this[_0x3b472b(0x1a7)][_0x3b472b(0x211)][_0x3b472b(0x1b0)]()[_0x3b472b(0x2ea)],{'handler':(_0x321634,_0x1203a6)=>{const _0x451a62=_0x3b472b,{cellInfo:_0x1ba989,view:_0x1891c0,isEmpty:_0x1b69b3}=_0x1203a6,_0x5c35fb=_0x1ba989,{unitId:_0x7141e9,subUnitId:_0x30a7df}=_0x5c35fb,_0x52bcb8=this[_0x451a62(0x233)](_0x1ba989,_0x1891c0,_0x1b69b3),_0x14364b=this[_0x451a62(0x2e0)][_0x451a62(0x3f8)]({'unitId':_0x7141e9,'subUnitId':_0x30a7df,'ranges':_0x52bcb8}),_0x2d4e10=Nt(this[_0x451a62(0x3b0)],_0x7141e9,_0x30a7df,_0x52bcb8);_0x2d4e10[_0x451a62(0x1df)]&&(_0x14364b[_0x451a62(0x2a6)][_0x451a62(0x390)](_0x2d4e10['setRangeValueRedoMutation']),_0x14364b[_0x451a62(0x3f5)][_0x451a62(0x390)](_0x2d4e10[_0x451a62(0x3bc)]));const _0x424d01=this[_0x451a62(0x392)](_0x1891c0,_0x1ba989);return _0x14364b[_0x451a62(0x2a6)][_0x451a62(0x390)](..._0x424d01[_0x451a62(0x2a6)]),_0x14364b[_0x451a62(0x3f5)][_0x451a62(0x390)](..._0x424d01[_0x451a62(0x3f5)]),{'redos':_0x14364b[_0x451a62(0x2a6)],'undos':_0x14364b['undos']};}}));}['getAutoFitColumnsMutations'](_0xd28c35,_0x5392aa){const _0x13afc9=_0x429c2e,{col:_0xfd98b8,unitId:_0x26af2f,subUnitId:_0x4d4896}=_0x5392aa,_0x548f0f=[],_0x530984=[],_0x1a4b5c=V[_0x13afc9(0x41a)](this['_univerInstanceService'],{'unitId':_0x26af2f,'subUnitId':_0x4d4896});if(!_0x5392aa||!_0xd28c35||!_0x1a4b5c)return{'undos':_0x530984,'redos':_0x548f0f};const _0x2c06d0=this[_0x13afc9(0x36b)][_0x13afc9(0x28f)](),{colView:_0x212f9d,dataView:_0x1012e4,cornerView:_0x5e4677,rowView:_0x4b9d57,formatMap:_0x4fc5f9}=_0xd28c35,_0x5decfc=kt(_0x212f9d,_0x2c06d0,!0x0,_0x4fc5f9),_0x2be81b=kt(_0x4b9d57,_0x2c06d0,!0x1,_0x4fc5f9),_0xcaf263=cn(_0x1012e4),_0x406289=dn(_0x5e4677),{worksheet:_0x477904}=_0x1a4b5c;if(typeof window<'u'&&window[_0x13afc9(0x28a)]){const _0x3d69a7=Ue[_0x13afc9(0x1b3)]({...oe['colStyle']}),_0x4ccd77=Ue[_0x13afc9(0x250)][_0x13afc9(0x3ec)](_0x5decfc,_0x3d69a7)[_0x13afc9(0x36e)]+0x10,_0x5b594c=Ue['FontCache']['getTextSize'](_0xcaf263,_0x3d69a7)[_0x13afc9(0x36e)],_0x23d14b=Math[_0x13afc9(0x32c)](Math[_0x13afc9(0x1ec)](_0x4ccd77,_0x5b594c))+0x10,_0x4160d5=Math[_0x13afc9(0x32c)](Ue[_0x13afc9(0x250)][_0x13afc9(0x3ec)](_0x2be81b,_0x3d69a7)[_0x13afc9(0x36e)]),_0x35e7fa=Math[_0x13afc9(0x32c)](Ue['FontCache'][_0x13afc9(0x3ec)](_0x406289,_0x3d69a7)[_0x13afc9(0x36e)]),_0x28b598=Math[_0x13afc9(0x1ec)](_0x4160d5,_0x35e7fa,0x28)+0xc,_0xe6585d=_0x212f9d[_0x13afc9(0x3ae)]+_0x5e4677[_0x13afc9(0x3ae)],_0x25854e={},_0xd6ccce={};for(let _0x5b23bb=_0xfd98b8;_0x5b23bb<_0xfd98b8+_0xe6585d;_0x5b23bb++){const _0x175e51=_0x477904[_0x13afc9(0x36c)](_0x5b23bb);_0x25854e[_0x5b23bb]=_0x175e51,_0x5b23bb-_0xfd98b8<_0x5e4677[_0x13afc9(0x3ae)]?_0xd6ccce[_0x5b23bb-_0xfd98b8]=_0x28b598:_0xd6ccce[_0x5b23bb-_0xfd98b8]=_0x23d14b;}_0x548f0f[_0x13afc9(0x390)]({'id':V[_0x13afc9(0x3d0)]['id'],'params':{'subUnitId':_0x4d4896,'unitId':_0x26af2f,'ranges':[{'startColumn':_0xfd98b8,'endColumn':_0xfd98b8+_0xe6585d-0x1,'startRow':0x0,'endRow':_0x477904[_0x13afc9(0x1a5)]()-0x1}],'colWidth':_0xd6ccce}}),_0x530984[_0x13afc9(0x390)]({'id':V[_0x13afc9(0x3d0)]['id'],'params':{'subUnitId':_0x4d4896,'unitId':_0x26af2f,'ranges':[{'startColumn':_0xfd98b8,'endColumn':_0xfd98b8+_0xe6585d-0x1,'startRow':0x0,'endRow':_0x477904[_0x13afc9(0x1a5)]()-0x1}],'colWidth':_0x25854e}});}return{'undos':_0x530984,'redos':_0x548f0f};}};We=Wn([Le(0x0,f[_0x429c2e(0x297)](V[_0x429c2e(0x1f6)])),Le(0x1,f[_0x429c2e(0x297)](f[_0x429c2e(0x1b2)])),Le(0x2,f[_0x429c2e(0x297)](f[_0x429c2e(0x193)])),Le(0x3,f[_0x429c2e(0x297)](exports['SheetsPivotTableConfigModel'])),Le(0x4,f[_0x429c2e(0x297)](exports[_0x429c2e(0x415)]))],We);var $n=Object[_0x429c2e(0x2ab)],Jn=(_0x9faac,_0x104028,_0x3e4c80,_0x28557b)=>{for(var _0x29a018=_0x28557b>0x1?void 0x0:_0x28557b?$n(_0x104028,_0x3e4c80):_0x104028,_0x1df880=_0x9faac['length']-0x1,_0xe76e4d;_0x1df880>=0x0;_0x1df880--)(_0xe76e4d=_0x9faac[_0x1df880])&&(_0x29a018=_0xe76e4d(_0x29a018)||_0x29a018);return _0x29a018;},be=(_0x2404ce,_0x21b896)=>(_0x5030e7,_0x29d07c)=>_0x21b896(_0x5030e7,_0x29d07c,_0x2404ce);let $e=class extends f[_0x429c2e(0x141)]{constructor(_0x40f893,_0x21c026,_0x5487ab,_0x34caa4,_0x54c060,_0x66ef7d,_0x1ff86a){const _0x4a2de1=_0x429c2e;super(),x(this,_0x4a2de1(0x1ee),new f['DisposableCollection']()),(this[_0x4a2de1(0x3b0)]=_0x40f893,this[_0x4a2de1(0x3c7)]=_0x21c026,this['_commandService']=_0x5487ab,this[_0x4a2de1(0x21b)]=_0x34caa4,this[_0x4a2de1(0x36b)]=_0x54c060,this[_0x4a2de1(0x407)]=_0x66ef7d,this[_0x4a2de1(0x2e0)]=_0x1ff86a,this[_0x4a2de1(0x31f)]());}[_0x429c2e(0x31f)](){const _0x465893=_0x429c2e,_0x2db1e9=(_0x54d89e,_0x54aa00)=>{const _0x4e16d9=_0x3f2b,_0x57aff3=this[_0x4e16d9(0x21b)][_0x4e16d9(0x117)](f[_0x4e16d9(0x300)][_0x4e16d9(0x2fa)]);if(!_0x57aff3||!(_0x57aff3==null?void 0x0:_0x57aff3[_0x4e16d9(0x3ca)](_0x54aa00)))return;this[_0x4e16d9(0x1ee)][_0x4e16d9(0x2d8)]();const _0xe58fec=_0x5f0cef=>this[_0x4e16d9(0x2a9)](_0x5f0cef,_0x54d89e,_0x54aa00),_0x44700c=this[_0x4e16d9(0x36b)][_0x4e16d9(0x181)](_0x54d89e,_0x54aa00);if(!(_0x44700c!=null&&_0x44700c[_0x4e16d9(0x23b)]))return;Array[_0x4e16d9(0x3e7)](_0x44700c['values']())['map'](_0x57ffde=>{const _0x50e6f5=_0x4e16d9,{row:_0x36f408,col:_0xb8c7a4}=_0x57ffde[_0x50e6f5(0x3d5)];return f['cellToRange'](_0x36f408,_0xb8c7a4);})[_0x4e16d9(0x174)](_0x377490=>{const _0x4d5acf=_0x4e16d9;this[_0x4d5acf(0x1ee)]['add'](this['_refRangeService'][_0x4d5acf(0x366)](_0x377490,_0xe58fec,_0x54d89e,_0x54aa00));});},_0xe376cd=()=>{const _0x307df9=_0x3f2b,_0xc20b6c=this[_0x307df9(0x21b)][_0x307df9(0x117)](f[_0x307df9(0x300)][_0x307df9(0x2fa)]);if(_0xc20b6c){const _0x3fcba2=_0xc20b6c[_0x307df9(0x151)]();if(!_0x3fcba2)return;_0x2db1e9(_0xc20b6c[_0x307df9(0x251)](),_0x3fcba2['getSheetId']());}};this[_0x465893(0x1a8)](this[_0x465893(0x20c)][_0x465893(0x1af)](_0x11afa0=>{const _0xeb0e8a=_0x465893;if(_0x11afa0['id']===V[_0xeb0e8a(0x172)]['id']){const _0x4d63e3=_0x11afa0[_0xeb0e8a(0x1ae)],_0x2ec372=_0x4d63e3[_0xeb0e8a(0x3c0)],_0x581bb1=_0x4d63e3[_0xeb0e8a(0x332)];if(!_0x2ec372||!_0x581bb1)return;_0x2db1e9(_0x581bb1,_0x2ec372);}})),this[_0x465893(0x1a8)](this['_sheetsPivotTableConfigModel'][_0x465893(0x2c2)][_0x465893(0x243)](_0x20a81d=>{_0x20a81d&&_0xe376cd();})),this[_0x465893(0x1a8)](this[_0x465893(0x36b)]['pivotConfigChange$'][_0x465893(0x243)](_0x43c643=>{const _0x3a7e=_0x465893,_0x4757af=V[_0x3a7e(0x41a)](this[_0x3a7e(0x21b)]);if(!_0x4757af)return;const {unitId:_0x4d3785,subUnitId:_0x520219}=_0x4757af,{unitId:_0x2b6527,subUnitId:_0x1e31ab}=_0x43c643;_0x4d3785!==_0x2b6527||_0x520219!==_0x1e31ab||_0x2db1e9(_0x4d3785,_0x520219);})),_0xe376cd();}['_refRangeHandle'](_0x24eb97,_0x3e7bfe,_0x3867fd){const _0x564f48=_0x429c2e;switch(_0x24eb97['id']){case V[_0x564f48(0x3b2)]['id']:return this[_0x564f48(0x222)](_0x24eb97['params'],_0x3e7bfe,_0x3867fd);}return{'redos':[],'undos':[]};}[_0x429c2e(0x222)](_0x793efd,_0x509b3e,_0x25d082){const _0x22ed1a=_0x429c2e,{fromRange:_0x280f8e,toRange:_0x4a7a82}=_0x793efd,_0x377f87=[],_0x33656d=[],_0xb47029=V['getSheetCommandTarget'](this['_univerInstanceService']);if(!_0xb47029)return{'undos':_0x33656d,'redos':_0x377f87};if(_0x509b3e!==_0xb47029[_0x22ed1a(0x332)]||_0x25d082!==_0xb47029[_0x22ed1a(0x3c0)])return{'undos':_0x33656d,'redos':_0x377f87};const _0x410f06=this[_0x22ed1a(0x36b)][_0x22ed1a(0x181)](_0x509b3e,_0x25d082);if(_0x410f06!=null&&_0x410f06['size'])for(const [_0x1ba953,_0x4b2238]of _0x410f06){const {unitId:_0x3db9d4,subUnitId:_0x37b913,row:_0x5a9197,col:_0x1434d8}=_0x4b2238[_0x22ed1a(0x3d5)];if(_0x3db9d4===_0xb47029['unitId']&&_0x37b913===_0xb47029[_0x22ed1a(0x3c0)]){const _0x338956=f['cellToRange'](_0x5a9197,_0x1434d8);if(f[_0x22ed1a(0x235)][_0x22ed1a(0x3cd)](_0x338956,_0x280f8e)){const _0x394c6a=_0x5a9197-_0x280f8e['startRow'],_0x22cba9=_0x1434d8-_0x280f8e[_0x22ed1a(0x198)],_0x1e3821={'row':_0x4a7a82[_0x22ed1a(0x197)]+_0x394c6a,'col':_0x4a7a82[_0x22ed1a(0x198)]+_0x22cba9};_0x377f87[_0x22ed1a(0x390)]({'id':Fe['id'],'params':{'unitId':_0x3db9d4,'subUnitId':_0x37b913,'pivotTableId':_0x1ba953,'targetCellPosition':_0x1e3821}}),_0x33656d[_0x22ed1a(0x390)]({'id':Fe['id'],'params':{'unitId':_0x3db9d4,'subUnitId':_0x37b913,'pivotTableId':_0x1ba953,'targetCellPosition':{'row':_0x5a9197,'col':_0x1434d8}}});const _0x396b23=_0x1e3821[_0x22ed1a(0x216)]-_0x5a9197,_0x304bfd=_0x1e3821['col']-_0x1434d8,_0x507546=[],_0x4740f5=this[_0x22ed1a(0x407)]['getPivotItemRenderInfoCache'](_0x3db9d4,_0x37b913,_0x1ba953),_0x2fa645=_0x4740f5==null?void 0x0:_0x4740f5['rangesInfo'];if(_0x2fa645){Object['keys'](_0x2fa645)['forEach'](_0x500a97=>{const _0x48a5f4=_0x22ed1a;_0x2fa645[_0x500a97][_0x48a5f4(0x174)](_0x4ad549=>{const _0x5bf47d=_0x48a5f4,_0x12bb52={..._0x4ad549};_0x12bb52['startRow']=_0x4ad549[_0x5bf47d(0x197)]+_0x396b23,_0x12bb52[_0x5bf47d(0x247)]=_0x4ad549[_0x5bf47d(0x247)]+_0x396b23,_0x12bb52[_0x5bf47d(0x198)]=_0x4ad549[_0x5bf47d(0x198)]+_0x304bfd,_0x12bb52[_0x5bf47d(0x1da)]=_0x4ad549[_0x5bf47d(0x1da)]+_0x304bfd,_0x507546[_0x5bf47d(0x390)](_0x12bb52);});});const _0x29213e=this[_0x22ed1a(0x2e0)][_0x22ed1a(0x3f8)]({'unitId':_0x3db9d4,'subUnitId':_0x37b913,'ranges':_0x507546});_0x377f87[_0x22ed1a(0x390)](..._0x29213e[_0x22ed1a(0x2a6)]),_0x33656d['push'](..._0x29213e[_0x22ed1a(0x3f5)]);const _0x1308ab=Nt(this['_injector'],_0x3db9d4,_0x37b913,_0x507546);_0x1308ab[_0x22ed1a(0x1df)]&&(_0x377f87['push'](_0x1308ab[_0x22ed1a(0x41d)]),_0x33656d[_0x22ed1a(0x390)](_0x1308ab[_0x22ed1a(0x3bc)]));}}}}return{'redos':_0x377f87,'undos':_0x33656d};}};$e=Jn([be(0x0,f[_0x429c2e(0x297)](f[_0x429c2e(0x1b2)])),be(0x1,f[_0x429c2e(0x297)](V[_0x429c2e(0x204)])),be(0x2,f[_0x429c2e(0x20e)]),be(0x3,f['IUniverInstanceService']),be(0x4,f['Inject'](exports[_0x429c2e(0x224)])),be(0x5,f[_0x429c2e(0x297)](exports['SheetsPivotTableAdaptorModel'])),be(0x6,f[_0x429c2e(0x297)](V[_0x429c2e(0x1f6)]))],$e);var Qn=Object[_0x429c2e(0x2ab)],qn=(_0x1b6375,_0x1c17bf,_0x54e1d8,_0x551bdc)=>{const _0x506b3f=_0x429c2e;for(var _0x17a6ef=_0x551bdc>0x1?void 0x0:_0x551bdc?Qn(_0x1c17bf,_0x54e1d8):_0x1c17bf,_0x193034=_0x1b6375[_0x506b3f(0x2ca)]-0x1,_0x4d3f8f;_0x193034>=0x0;_0x193034--)(_0x4d3f8f=_0x1b6375[_0x193034])&&(_0x17a6ef=_0x4d3f8f(_0x17a6ef)||_0x17a6ef);return _0x17a6ef;},Bt=(_0x5db79b,_0x3bb87d)=>(_0x2a39ff,_0x3e55d2)=>_0x3bb87d(_0x2a39ff,_0x3e55d2,_0x5db79b);let Je=class extends f['Disposable']{constructor(_0xab42ab,_0x182695){const _0x11d1e5=_0x429c2e;super(),this['_sheetInterceptorService']=_0xab42ab,this['_sheetsPivotTableConfigModel']=_0x182695,this[_0x11d1e5(0x1ea)]();}['_initRemoveSheetCommandInterceptor'](){const _0x5a64ba=_0x429c2e;this['disposeWithMe'](this[_0x5a64ba(0x2e0)][_0x5a64ba(0x405)]({'getMutations':_0x8b839a=>{const _0x2a8e23=_0x5a64ba;if(_0x8b839a['id']===V[_0x2a8e23(0x394)]['id']){const _0x54aba8=[],_0x1ee5fc=[],_0x35f181=_0x8b839a['params'],{unitId:_0x3ec014,subUnitId:_0x7bf3e4}=_0x35f181;if(!_0x3ec014||!_0x7bf3e4)return{'undos':_0x1ee5fc,'redos':_0x54aba8};const _0x9c156d=this[_0x2a8e23(0x36b)]['getSubUnitPivotConfigs'](_0x3ec014,_0x7bf3e4);if(_0x9c156d!=null&&_0x9c156d[_0x2a8e23(0x23b)])for(const [_0x18d34c,_0x1d78c9]of _0x9c156d){_0x54aba8[_0x2a8e23(0x390)]({'id':He['id'],'params':{'unitId':_0x3ec014,'subUnitId':_0x7bf3e4,'pivotTableId':_0x18d34c}});const _0x50c9e6={...this[_0x2a8e23(0x36b)][_0x2a8e23(0x302)](_0x3ec014,_0x18d34c)};_0x1ee5fc[_0x2a8e23(0x390)]({'id':_e['id'],'params':{'unitId':_0x3ec014,'subUnitId':_0x7bf3e4,'pivotTableId':_0x18d34c,'pivotTableConfig':_0x1d78c9,'collectionConfig':_0x50c9e6}});}return{'redos':_0x54aba8,'undos':_0x1ee5fc};}return{'redos':[],'undos':[]};}}));}};Je=qn([Bt(0x0,f[_0x429c2e(0x297)](V[_0x429c2e(0x1f6)])),Bt(0x1,f['Inject'](exports[_0x429c2e(0x224)]))],Je);var Kn=Object[_0x429c2e(0x2ab)],Hn=(_0x2e9812,_0x2dec83,_0x5a2c43,_0x385f0e)=>{const _0x5c4728=_0x429c2e;for(var _0x58ac4a=_0x385f0e>0x1?void 0x0:_0x385f0e?Kn(_0x2dec83,_0x5a2c43):_0x2dec83,_0x4204d0=_0x2e9812[_0x5c4728(0x2ca)]-0x1,_0x3ed66a;_0x4204d0>=0x0;_0x4204d0--)(_0x3ed66a=_0x2e9812[_0x4204d0])&&(_0x58ac4a=_0x3ed66a(_0x58ac4a)||_0x58ac4a);return _0x58ac4a;},ye=(_0x23c7de,_0x334297)=>(_0x1330a1,_0x2136d3)=>_0x334297(_0x1330a1,_0x2136d3,_0x23c7de);let Qe=class extends f[_0x429c2e(0x141)]{constructor(_0x2e8b7f,_0x3912e1,_0x2b1342,_0x3bceac,_0x381132,_0x3901c9){const _0xdff512=_0x429c2e;super(),this[_0xdff512(0x20c)]=_0x2e8b7f,this[_0xdff512(0x20b)]=_0x3912e1,this[_0xdff512(0x407)]=_0x2b1342,this[_0xdff512(0x36b)]=_0x3bceac,this['_univerInstanceService']=_0x381132,this['_activeDirtyManagerService']=_0x3901c9,this['_initDataSendListener'](),this[_0xdff512(0x1bd)]();}[_0x429c2e(0x1ba)](){const _0x3a1d7e=_0x429c2e;this[_0x3a1d7e(0x1a8)](this['_commandService']['onCommandExecuted'](_0x18d142=>{const _0x35b912=_0x3a1d7e;if(_0x18d142['id']!==wt['id'])return;const _0x4ee5ae=_0x18d142[_0x35b912(0x1ae)];this[_0x35b912(0x20b)][_0x35b912(0x180)](_0x4ee5ae);})),this[_0x3a1d7e(0x1a8)](this[_0x3a1d7e(0x20c)][_0x3a1d7e(0x1af)](_0x23045d=>{const _0x172973=_0x3a1d7e;if(_0x23045d['id']===_t['id']){const _0x2a919c=_0x23045d[_0x172973(0x1ae)];if(_0x2a919c){const {unitId:_0x1a907b,subUnitId:_0x1566a9,oldSubUnitId:_0x5e6b3d,pivotTableId:_0xb192d2,pivotTableConfig:_0x9e0ac4,collectionConfig:_0x48180f}=_0x2a919c;this['_sheetsPivotTableConfigModel'][_0x172973(0x276)](_0x1a907b,_0x5e6b3d,_0x2a919c['pivotTableId'],null),this[_0x172973(0x36b)][_0x172973(0x276)](_0x1a907b,_0x1566a9,_0xb192d2,_0x9e0ac4),this[_0x172973(0x36b)][_0x172973(0x33d)](_0x1a907b,_0x48180f);}}})),this['disposeWithMe'](this['_commandService'][_0x3a1d7e(0x1af)](_0x14fd74=>{const _0x580a96=_0x3a1d7e;if(_0x14fd74['id']!==ot['id'])return;const _0x27e35d=V[_0x580a96(0x41a)](this[_0x580a96(0x21b)]);if(!_0x27e35d)return;const {unitId:_0x1aba9f,subUnitId:_0x3a2de9}=_0x27e35d,_0x33a0b5=_0x14fd74[_0x580a96(0x1ae)];if(_0x33a0b5['collectionConfig']&&Object['keys'](_0x33a0b5[_0x580a96(0x137)])[_0x580a96(0x174)](_0x10bbba=>{const _0x50e1ff=_0x580a96;var _0x2dc895;(_0x2dc895=_0x33a0b5[_0x50e1ff(0x137)])!=null&&_0x2dc895[_0x10bbba]&&this[_0x50e1ff(0x36b)][_0x50e1ff(0x33d)](_0x10bbba,_0x33a0b5[_0x50e1ff(0x137)][_0x10bbba]);}),_0x33a0b5[_0x580a96(0x32b)]){const _0x29b5ef=_0x33a0b5[_0x580a96(0x32b)],{unitId:_0x54ef5a,subUnitId:_0x6d0c62,view:_0x3bf582,pivotTableId:_0x1974ff,type:_0x104d83,pivotConfig:_0x3794ac}=_0x29b5ef;if(_0x104d83===L[_0x580a96(0x40b)])this['_sheetsPivotTableAdaptorModel'][_0x580a96(0x146)]({'unitId':_0x54ef5a,'subUnitId':_0x6d0c62,'pivotTableId':_0x1974ff,'type':_0x104d83}),this['_sheetsPivotTableConfigModel'][_0x580a96(0x276)](_0x54ef5a,_0x6d0c62,_0x1974ff,null);else{const _0xc41813=new m[(_0x580a96(0x400))]();_0xc41813[_0x580a96(0x3b8)](_0x3bf582),this[_0x580a96(0x36b)][_0x580a96(0x276)](_0x54ef5a,_0x6d0c62,_0x1974ff,_0x3794ac),this[_0x580a96(0x407)]['clearRenderCache']({'unitId':_0x54ef5a,'subUnitId':_0x6d0c62,'pivotTableId':_0x1974ff,'type':_0x104d83,'view':_0xc41813}),this[_0x580a96(0x407)][_0x580a96(0x1cc)]({'unitId':_0x54ef5a,'subUnitId':_0x6d0c62,'view':_0xc41813,'pivotTableId':_0x1974ff,'type':_0x104d83});}}else _0x33a0b5['batch']&&(_0x33a0b5[_0x580a96(0x39a)]['forEach'](_0x4b31f7=>{const _0x5be935=_0x580a96,{unitId:_0x1e1c45,subUnitId:_0x9b9803,view:_0x2cfad2,pivotTableId:_0x293b4c,type:_0x16b8a7,pivotConfig:_0x967fd7}=_0x4b31f7,_0x110a9d=new m['PivotView']();_0x110a9d[_0x5be935(0x3b8)](_0x2cfad2),this[_0x5be935(0x36b)][_0x5be935(0x276)](_0x1e1c45,_0x9b9803,_0x293b4c,_0x967fd7),this[_0x5be935(0x407)]['updateRenderCache']({'unitId':_0x1e1c45,'subUnitId':_0x9b9803,'view':_0x110a9d,'pivotTableId':_0x293b4c,'type':_0x16b8a7});}),this[_0x580a96(0x36b)][_0x580a96(0x199)]());this[_0x580a96(0x407)]['markDirty'](_0x1aba9f,_0x3a2de9);}));}[_0x429c2e(0x1bd)](){const _0x662ed3=_0x429c2e;this[_0x662ed3(0x29f)]['register'](Ke['id'],{'commandId':Ke['id'],'getDirtyData'(_0x1273b4){const _0x92a407=_0x662ed3;return{'dirtyUnitFeatureMap':_0x1273b4[_0x92a407(0x1ae)]};}});}};Qe=Hn([ye(0x0,f[_0x429c2e(0x297)](f[_0x429c2e(0x20e)])),ye(0x1,f[_0x429c2e(0x297)](exports['SheetsPivotRPCService'])),ye(0x2,f[_0x429c2e(0x297)](exports[_0x429c2e(0x33e)])),ye(0x3,f['Inject'](exports[_0x429c2e(0x224)])),ye(0x4,f[_0x429c2e(0x297)](f[_0x429c2e(0x193)])),ye(0x5,fe[_0x429c2e(0x23e)])],Qe);var Xn=Object[_0x429c2e(0x1d0)],Yn=Object[_0x429c2e(0x2ab)],zn=(_0x41d3f5,_0x2426a4,_0x577f66)=>_0x2426a4 in _0x41d3f5?Xn(_0x41d3f5,_0x2426a4,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0x577f66}):_0x41d3f5[_0x2426a4]=_0x577f66,Zn=(_0x23b0ad,_0x4b3d33,_0xfb2f31,_0x3652c9)=>{const _0x3032f3=_0x429c2e;for(var _0x10572f=_0x3652c9>0x1?void 0x0:_0x3652c9?Yn(_0x4b3d33,_0xfb2f31):_0x4b3d33,_0x362c51=_0x23b0ad[_0x3032f3(0x2ca)]-0x1,_0x2d794a;_0x362c51>=0x0;_0x362c51--)(_0x2d794a=_0x23b0ad[_0x362c51])&&(_0x10572f=_0x2d794a(_0x10572f)||_0x10572f);return _0x10572f;},tt=(_0x4865d4,_0x3b44e1)=>(_0x9fb4da,_0x11cfe3)=>_0x3b44e1(_0x9fb4da,_0x11cfe3,_0x4865d4),Co=(_0x247ac2,_0x5374eb,_0x2efaaa)=>zn(_0x247ac2,typeof _0x5374eb!='symbol'?_0x5374eb+'':_0x5374eb,_0x2efaaa);exports['UniverSheetsPivotTablePlugin']=class extends f[_0x429c2e(0x194)]{constructor(_0x500f2d=jt,_0x4fec5e,_0x366794,_0x20e3c1,_0x2ab8c1){const _0x517492=_0x429c2e;super(),this[_0x517492(0x281)]=_0x500f2d,this[_0x517492(0x3b0)]=_0x4fec5e,this[_0x517492(0x20c)]=_0x366794,this[_0x517492(0x3f0)]=_0x20e3c1,this[_0x517492(0x33f)]=_0x2ab8c1;const {..._0x382f9f}=f[_0x517492(0x386)]({},jt,this['_config']);this['_configService'][_0x517492(0x37d)](Ut,_0x382f9f),this[_0x517492(0x21a)](),this[_0x517492(0x18e)]();}[_0x429c2e(0x18e)](){const _0x1522ab=_0x429c2e;var _0x3b4774;const _0x418955=(_0x3b4774=this[_0x1522ab(0x281)])==null?void 0x0:_0x3b4774[_0x1522ab(0x136)];this['_configService'][_0x1522ab(0x37d)](Q,_0x418955===!0x0);}[_0x429c2e(0x326)](){const _0x53f370=_0x429c2e;var _0x3f3112;let _0x3a0739=[];const _0x394245=(_0x3f3112=this[_0x53f370(0x281)])==null?void 0x0:_0x3f3112[_0x53f370(0x136)];_0x394245===!0x0?_0x3a0739=[[exports[_0x53f370(0x415)]],[exports[_0x53f370(0x3e0)]],[Qe],[exports[_0x53f370(0x33e)]],[exports[_0x53f370(0x224)]],[Je],[Ge],[$e],[We]]:_0x394245===!0x1?_0x3a0739=[[exports[_0x53f370(0x309)]],[Be]]:_0x394245===void 0x0&&(_0x3a0739=[[exports[_0x53f370(0x309)]],[Be],[exports['SheetsPivotTableService']],[exports[_0x53f370(0x3e0)]],[Qe],[exports[_0x53f370(0x33e)]],[exports[_0x53f370(0x224)]],[Je],[Ge],[$e],[We]]),_0x3a0739['forEach'](_0x161623=>this[_0x53f370(0x3b0)][_0x53f370(0x207)](_0x161623)),[Be,Qe,exports[_0x53f370(0x415)],Ge,Je,$e,We]['forEach'](_0x47d8e4=>{const _0xb8f7f7=_0x53f370;this['_injector'][_0xb8f7f7(0x1d3)](_0x47d8e4)&&this[_0xb8f7f7(0x3b0)][_0xb8f7f7(0x236)](_0x47d8e4);});}['_initRegisterCommand'](){const _0x57cbfd=_0x429c2e;[oo,no,to,io,ro,Io,ho,co,fo,go,po,mo,ao,so,_e,yt,He,it,Zt,eo,ct,at,st,rt,ut,dt,Fe,Ft,wt,ot,vt,pt,gt,lt,Rt,mt,ht,Ke,_t,vo,ft,uo,lo][_0x57cbfd(0x174)](_0x37026b=>{const _0x2fd0f2=_0x57cbfd;var _0x1c83d8;(_0x1c83d8=this['_dataSyncPrimaryController'])==null||_0x1c83d8['registerSyncingMutations'](_0x37026b),this[_0x2fd0f2(0x20c)][_0x2fd0f2(0x40a)](_0x37026b);});}},Co(exports[_0x429c2e(0x19a)],'pluginName',Ct),Co(exports[_0x429c2e(0x19a)],_0x429c2e(0x418),f[_0x429c2e(0x300)][_0x429c2e(0x2fa)]),exports[_0x429c2e(0x19a)]=Zn([f['DependentOn'](ue['UniverLicensePlugin']),tt(0x1,f[_0x429c2e(0x297)](f['Injector'])),tt(0x2,f['Inject'](f[_0x429c2e(0x20e)])),tt(0x3,f['IConfigService']),tt(0x4,f['Optional'](_o[_0x429c2e(0x278)]))],exports[_0x429c2e(0x19a)]),exports[_0x429c2e(0x22c)]=to,exports[_0x429c2e(0x417)]=it,exports[_0x429c2e(0x144)]=no,exports[_0x429c2e(0x26a)]=_e,exports[_0x429c2e(0x18c)]=oo,exports['BLANK_ROW_COUNT']=we,exports[_0x429c2e(0x38a)]=It,exports[_0x429c2e(0x286)]=io,exports['MovePivotTableCommand']=ao,exports[_0x429c2e(0x308)]=k,exports[_0x429c2e(0x3b3)]=so,exports[_0x429c2e(0x264)]=L,exports['PivotTableViewDirtyMarkOperation']=Ke,exports['PositionType']=Mt,exports[_0x429c2e(0x240)]=ro,exports[_0x429c2e(0x165)]=at,exports[_0x429c2e(0x2e6)]=He,exports[_0x429c2e(0x2da)]=st,exports[_0x429c2e(0x3c4)]=lo,exports[_0x429c2e(0x29e)]=Ut,exports[_0x429c2e(0x1be)]=Ct,exports[_0x429c2e(0x2cd)]=co,exports[_0x429c2e(0x38e)]=rt,exports[_0x429c2e(0x1cf)]=lt,exports[_0x429c2e(0x329)]=uo,exports[_0x429c2e(0x38c)]=go,exports[_0x429c2e(0x37e)]=ct,exports['SetPivotOptionMutation']=dt,exports[_0x429c2e(0x20f)]=Fe,exports[_0x429c2e(0x271)]=fo,exports['SetPivotSortMutation']=ut,exports['SetPivotSubtotalTypeMutation']=gt,exports[_0x429c2e(0x3d7)]=vo,exports[_0x429c2e(0x1ef)]=ft,exports[_0x429c2e(0x1eb)]=ho,exports[_0x429c2e(0x26d)]=vt,exports['UpdatePivotFieldSettingCommand']=po,exports['UpdatePivotFieldSourceInfoMutation']=ht,exports[_0x429c2e(0x39b)]=mo,exports[_0x429c2e(0x24f)]=mt,exports[_0x429c2e(0x324)]=Io,exports[_0x429c2e(0x2ec)]=pt,exports[_0x429c2e(0x269)]=ae,exports['canUsePivot']=Et,exports['defaultThemeStyle']=oe,exports[_0x429c2e(0x22e)]=Nt,exports[_0x429c2e(0x41b)]=ne,exports[_0x429c2e(0x30a)]=Yt,exports[_0x429c2e(0x2dc)]=qe,exports[_0x429c2e(0x13e)]=ce,exports['getPivotCellInfo']=Ht,exports['getPivotInfoByLicense']=bt,exports[_0x429c2e(0x16c)]=Xt,exports[_0x429c2e(0x421)]=Me,exports[_0x429c2e(0x30b)]=nt;