const _0xb97ba0=_0x3554;(function(_0xfbc3a4,_0xb9da89){const _0x53eaac=_0x3554,_0x564eb0=_0xfbc3a4();while(!![]){try{const _0x59cc90=-parseInt(_0x53eaac(0x17c))/0x1+-parseInt(_0x53eaac(0x15f))/0x2*(-parseInt(_0x53eaac(0x175))/0x3)+-parseInt(_0x53eaac(0x160))/0x4+-parseInt(_0x53eaac(0x18a))/0x5*(-parseInt(_0x53eaac(0x182))/0x6)+-parseInt(_0x53eaac(0x168))/0x7*(parseInt(_0x53eaac(0x166))/0x8)+parseInt(_0x53eaac(0x16e))/0x9*(-parseInt(_0x53eaac(0x177))/0xa)+parseInt(_0x53eaac(0x171))/0xb;if(_0x59cc90===_0xb9da89)break;else _0x564eb0['push'](_0x564eb0['shift']());}catch(_0x34bba4){_0x564eb0['push'](_0x564eb0['shift']());}}}(_0x3bcb,0xbdd6b));import{IExchangeOperateService as _0x466be3,UniverExchangeClientPlugin as _0x335a39}from'@univerjs-pro/exchange-client';function _0x3bcb(){const _0x57d06c=['getOwnPropertyDescriptor','unit','OPERATION','exchange.file','10lncKhl','sheets-exchange-client.config','SUBITEMS','UNIVER_SHEET','_initCommands','31586QgDtvn','2021912kipdMY','get','search','menu','onReady','exportXLSXBySnapshot','5185616QTmHvk','ExportIcon','7ZdwZkP','mergeMenu','importXLSXToUnitId','exchange-client.operation.import-xlsx','exchange-client.operation.export-xlsx','_commandService','3123cbqXJf','_configService','BUTTON','30257755RrXDHf','setConfig','symbol','length','102tBbyCz','exchange.download','41090gFbyLn','_menuManagerService','SHEET_EXCHANGE_CLIENT_PLUGIN','OTHERS','exchange.upload','1273607oeiwWp','_injector','defineProperty','importXLSXToSnapshot','forEach','pluginName','4029066waKyis','sheets-exchange-client.operation.exchange','_config','onStarting'];_0x3bcb=function(){return _0x57d06c;};return _0x3bcb();}import{CommandType as _0x244fe6,UniverInstanceType as _0x12e54c,Disposable as _0x21382e,ICommandService as _0x240524,DependentOn as _0x23f589,Inject as _0x4df6ce,Injector as _0x510f8d,IConfigService as _0x3ca1ea,Plugin as _0x6fcabb,merge as _0x4cff0b}from'@univerjs/core';import{MenuItemType as _0x437aeb,getMenuHiddenObservable as _0x447147,RibbonStartGroup as _0x144b7f,IMenuManagerService as _0x589463}from'@univerjs/ui';import{WorkbookExportPermission as _0x1a2e37}from'@univerjs/sheets';import{getCurrentRangeDisable$ as _0xd6a19f}from'@univerjs/sheets-ui';const p={'id':_0xb97ba0(0x16b),'type':_0x244fe6[_0xb97ba0(0x188)],'handler':async _0x549911=>{const _0x169968=_0xb97ba0,_0x4d6c2d=_0x549911['get'](_0x466be3);return new URLSearchParams(location[_0x169968(0x162)])[_0x169968(0x161)]('unit')?_0x4d6c2d[_0x169968(0x16a)]():_0x4d6c2d[_0x169968(0x17f)](),!0x0;}},u={'id':_0xb97ba0(0x16c),'type':_0x244fe6[_0xb97ba0(0x188)],'handler':async _0x5bf15b=>{const _0x39f1c3=_0xb97ba0,_0x140716=_0x5bf15b['get'](_0x466be3);return new URLSearchParams(location[_0x39f1c3(0x162)])['get'](_0x39f1c3(0x187))?_0x140716['exportXLSXByUnitId']():_0x140716[_0x39f1c3(0x165)](),!0x0;}},H=_0xb97ba0(0x18b),l={},S=_0xb97ba0(0x183);function R(_0x1b5524){const _0x78113b=_0xb97ba0;return{'id':S,'type':_0x437aeb[_0x78113b(0x15c)],'icon':'DirectExportIcon','tooltip':_0x78113b(0x189),'hidden$':_0x447147(_0x1b5524,_0x12e54c[_0x78113b(0x15d)]),'disabled$':_0xd6a19f(_0x1b5524,{'workbookTypes':[_0x1a2e37]})};}function w(){const _0x499388=_0xb97ba0;return{'id':p['id'],'type':_0x437aeb[_0x499388(0x170)],'title':_0x499388(0x17b),'icon':'FolderIcon'};}function D(){const _0x1f11a2=_0xb97ba0;return{'id':u['id'],'type':_0x437aeb[_0x1f11a2(0x170)],'title':_0x1f11a2(0x176),'icon':_0x1f11a2(0x167)};}const F={[_0x144b7f[_0xb97ba0(0x17a)]]:{[S]:{'order':0.3,'menuItemFactory':R,[p['id']]:{'order':0x0,'menuItemFactory':w},[u['id']]:{'order':0x1,'menuItemFactory':D}}}};var G=Object[_0xb97ba0(0x186)],A=(_0x5afc2b,_0x493c37,_0x24976d,_0x56b3ea)=>{const _0x161d82=_0xb97ba0;for(var _0x3de57e=_0x56b3ea>0x1?void 0x0:_0x56b3ea?G(_0x493c37,_0x24976d):_0x493c37,_0x3d8d95=_0x5afc2b[_0x161d82(0x174)]-0x1,_0x3deab2;_0x3d8d95>=0x0;_0x3d8d95--)(_0x3deab2=_0x5afc2b[_0x3d8d95])&&(_0x3de57e=_0x3deab2(_0x3de57e)||_0x3de57e);return _0x3de57e;},d=(_0x5454f9,_0x173d8f)=>(_0x10c163,_0x21a1eb)=>_0x173d8f(_0x10c163,_0x21a1eb,_0x5454f9);let c=class extends _0x21382e{constructor(_0xf99c7e,_0x36af24){const _0x217fc7=_0xb97ba0;super(),this[_0x217fc7(0x16d)]=_0xf99c7e,this['_menuManagerService']=_0x36af24,this[_0x217fc7(0x15e)](),this['_initMenus']();}[_0xb97ba0(0x15e)](){const _0x11fd53=_0xb97ba0;[p,u][_0x11fd53(0x180)](_0x1497c9=>{this['disposeWithMe'](this['_commandService']['registerCommand'](_0x1497c9));});}['_initMenus'](){const _0x468083=_0xb97ba0;this[_0x468083(0x178)][_0x468083(0x169)](F);}};c=A([d(0x0,_0x240524),d(0x1,_0x589463)],c);var j=Object[_0xb97ba0(0x17e)],B=Object[_0xb97ba0(0x186)],$=(_0x525213,_0x57852f,_0x1404f5)=>_0x57852f in _0x525213?j(_0x525213,_0x57852f,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0x1404f5}):_0x525213[_0x57852f]=_0x1404f5,V=(_0x2356a8,_0x4dc0ea,_0x11cd01,_0x2490ad)=>{const _0x7ca5b2=_0xb97ba0;for(var _0x4abf36=_0x2490ad>0x1?void 0x0:_0x2490ad?B(_0x4dc0ea,_0x11cd01):_0x4dc0ea,_0x518716=_0x2356a8[_0x7ca5b2(0x174)]-0x1,_0x44a9ea;_0x518716>=0x0;_0x518716--)(_0x44a9ea=_0x2356a8[_0x518716])&&(_0x4abf36=_0x44a9ea(_0x4abf36)||_0x4abf36);return _0x4abf36;},_=(_0x4ceff4,_0x584df2)=>(_0x326fa9,_0x280eaa)=>_0x584df2(_0x326fa9,_0x280eaa,_0x4ceff4),I=(_0x23a7da,_0x520a86,_0x58a5e3)=>$(_0x23a7da,typeof _0x520a86!=_0xb97ba0(0x173)?_0x520a86+'':_0x520a86,_0x58a5e3);function _0x3554(_0x386075,_0x58aeef){const _0x3bcb47=_0x3bcb();return _0x3554=function(_0x355415,_0x5b7d5){_0x355415=_0x355415-0x15c;let _0x226cd7=_0x3bcb47[_0x355415];return _0x226cd7;},_0x3554(_0x386075,_0x58aeef);}const W=_0xb97ba0(0x179);let s=class extends _0x6fcabb{constructor(_0xec2081=l,_0x253732,_0x5a794c){const _0x53347f=_0xb97ba0;super(),this[_0x53347f(0x184)]=_0xec2081,this[_0x53347f(0x17d)]=_0x253732,this['_configService']=_0x5a794c;const {menu:_0x2c75f7,..._0x467054}=_0x4cff0b({},l,this[_0x53347f(0x184)]);_0x2c75f7&&this[_0x53347f(0x16f)]['setConfig'](_0x53347f(0x163),_0x2c75f7,{'merge':!0x0}),this[_0x53347f(0x16f)][_0x53347f(0x172)](H,_0x467054);}[_0xb97ba0(0x185)](){const _0x343f55=_0xb97ba0;[[c]]['forEach'](_0x5af209=>this[_0x343f55(0x17d)]['add'](_0x5af209));}[_0xb97ba0(0x164)](){this['_injector']['get'](c);}};I(s,_0xb97ba0(0x181),W),I(s,'type',_0x12e54c[_0xb97ba0(0x15d)]),s=V([_0x23f589(_0x335a39),_(0x1,_0x4df6ce(_0x510f8d)),_(0x2,_0x3ca1ea)],s);export{u as ExportXLSXOperation,p as ImportXLSXOperation,s as UniverSheetsExchangeClientPlugin};