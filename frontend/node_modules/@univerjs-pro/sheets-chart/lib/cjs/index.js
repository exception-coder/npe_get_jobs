'use strict';const _0x27e324=_0x4595;(function(_0x1bfe42,_0x3ad4ea){const _0xe142d0=_0x4595,_0x180013=_0x1bfe42();while(!![]){try{const _0xc86ddb=-parseInt(_0xe142d0(0xb5))/0x1+-parseInt(_0xe142d0(0x79))/0x2+parseInt(_0xe142d0(0xdf))/0x3*(-parseInt(_0xe142d0(0xd9))/0x4)+-parseInt(_0xe142d0(0x115))/0x5+parseInt(_0xe142d0(0xf3))/0x6+-parseInt(_0xe142d0(0x148))/0x7*(parseInt(_0xe142d0(0xda))/0x8)+parseInt(_0xe142d0(0x133))/0x9;if(_0xc86ddb===_0x3ad4ea)break;else _0x180013['push'](_0x180013['shift']());}catch(_0x5cd499){_0x180013['push'](_0x180013['shift']());}}}(_0x56ec,0x6ee68));function _0x56ec(){const _0x166e81=['watchRange','canSwitchOrient$','dataSource','ICommandService','dataAggregation','symbol','context$','_updateChartRangeAndContext','getOwnPropertyDescriptor','DataOrientation','_refRangeService','dimensions','numfmt','Subject','delete','syncExecuteCommand','createChartModel','ChartModel','sheet.mutation.insert-chart','BehaviorSubject','forEach','ChartUpdateConfigMutation','map','140ZaOQWj','9128CQHqoD','ChartTypeBits','getActiveChartModel','ReorderRangeMutation','IUniverInstanceService','34878dYOAlw','_univerInstanceService','ChartModelService','from','IConfigService','Module','width','IResourceManagerService','parseDate','disposeWithMe','pipe','number','push','_converters','UniverInstanceType','startColumn','applyStyle','removeChartModel','isDate','chartType','2054208BryYDy','setRangeInfo','canSwitchOrient','_context$','all','LocaleService','contains','clear','registerChartThemeService','_init','sheet.command.chart-update-config','getInjector','FORCE_STRING','defineProperty','elements','keys','SheetsChartService','distinctUntilChanged','sheet.mutation.remove-chart','getFormatInfo','InsertSheetsChartMutation','isRowDirection','source','ChartSourceDataTypeEnum','_models','MUTATION','Line','refreshChartModel','_chartModelAdded$','data$','CommandType','bubble','sheets-chart.config','registerCommand','983885PgLbxA','_chartModelRemoved$','values','RemoveRowMutation','_serializeChartForUnit','Column','sankeyData','Disposable','assignChartContext','RemoveColMutation','BOOLEAN','every','_canSwitchOrient$','debounceTime','_resourcesManagerService','CHART_DEBOUNCE_TIME','STRING','generateRandomId','merge','filter','_dataSourceMap','setLoaded','params','measureText','SetRangeValuesMutation','RefRangeService','getChartModel','ChartUpdateConfigCommand','getSheetBySheetId','style','17548812udEMJk','parse','getCell','findHeaderOperator','split','Range','generateChartModelContext','dispose','next','onDispose','dataAggregation$','complete','translateAngleToRadian','sheet.mutation.chart-update-source','SHEETS_CHART_PLUGIN_NAME','dataStream','_initCommands','range','UniverSheetsChartPlugin','setValue','_configService','4907WFKSBZ','activeChartModel$','context','_rangeInfo$','_activeChartModel$','pluginName','updateRangeInfo','length','body','_style$','type','calcPosition','_config$','getUnitChartModels','chartModelRemoved$','_hasLoaded','Null','SHEET_CHART_PLUGIN','unsubscribe','getRangeInfo','rangeInfo$','_config','LS_CONFIG_KEY','getSheetFeatureLimit','_chartModelService','201706zwuOXU','category','Plugin','set','getValue','UNIVER_SHEET','getChartSuggestion','touchDependencies','ObjectMatrix','_chartModelIdMap','Inject','IUndoRedoService','headers','Rectangle','COMMAND','Date','chartType$','_commandService','getChartDataSource','_injector','stringify','getUniverSheetInstance','setConfig','setChartDataSource','serialize','setActiveChartModel','rangeInfo','toArray','sheet.mutation.chart-update-config','QUrsPE8r\x20Iqs9XdPE8r(SEsqrfq,\x20dUlSEsMqX)\x20{\x20\x20\x20\x20P9X\x20{\x20\x20\x20\x20\x20\x20\x20\x20s8rfP\x20SEsqrfqmrQ8in9PG99nX\x20=\x20SEsqrfq.fdSEP(\x27-\x27);\x20\x20\x20\x20\x20\x20\x20\x20s8rfP\x2089EpErtqffnpq\x20=\x20hg7K.dn9fq(nP8l(SEsqrfqmrQ8in9PG99nX[L]));\x20\x20\x20\x20\x20\x20\x20\x20EQ\x20(!89EpErtqffnpq.UI)\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2089EpErtqffnpq.UI\x20=\x20KUjlq9(SEsqrfqmrQ8in9PG99nX[V]);\x20\x20\x20\x20\x20\x20\x20\x20}\x20\x20\x20\x20\x20\x20\x20\x20s8rfP\x20Efo89yq9\x20=\x20PXdq8Q\x20o89yq9bS8lnSgs8dq\x20!==\x20\x27UrIqQErqI\x27\x20&&\x20fqSQ\x20ErfPnrsq8Q\x20o89yq9bS8lnSgs8dq;\x20\x20\x20\x20\x20\x20\x20\x20s8rfP\x20s8rPqBP\x20=\x20Efo89yq9\x20?\x20fqSQ\x20:\x20NErI8N;\x20\x20\x20\x20\x20\x20\x20\x20s8rfP\x20jqffnpqo89I\x20=\x20s8rPqBP.__FnfqkV__.dn9fq(SEsqrfqmrQ8in9PG99nX[L]);\x20\x20\x20\x20\x20\x20\x20\x20s8rfP\x20jqffnpq\x20=\x20s8rPqBP.__YqB__.fP9ErpEQX(jqffnpqo89I);\x20\x20\x20\x20\x20\x20\x20\x20s8rfP\x20fEprnPU9qo89I\x20=\x20s8rPqBP.__FnfqkV__.dn9fq(SEsqrfqmrQ8in9PG99nX[O]);\x20\x20\x20\x20\x20\x20\x20\x20s8rfP\x20fEprnPU9q\x20=\x20s8rPqBP.__YqB__.fP9ErpEQX(fEprnPU9qo89I);\x20\x20\x20\x20\x20\x20\x20\x20s8rfP\x20fEpranSEI\x20=\x20s8rPqBP.__5q9EQX__(fEprnPU9q,\x20jqffnpq,\x20dUlSEsMqX);\x20\x20\x20\x20\x20\x20\x20\x20s8rfP\x20I8jnEr\x20=\x2089EpErtqffnpq.Ij;\x20\x20\x20\x20\x20\x20\x20\x20QUrsPE8r\x20Ef68jnErtnPsZErp(8inPPq9r,\x208Y8fP)\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20s8rfP\x20dnPPq9r\x20=\x208inPPq9r.9qdSnsq(/^.+/,\x20\x27\x27);\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20s8rfP\x20Z8fP\x20=\x208Y8fP.9qdSnsq(/^.+/,\x20\x27\x27);\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20s8rfP\x20dnPPq9rin9Pf\x20=\x20dnPPq9r.fdSEP(\x27.\x27);\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20s8rfP\x20Z8fPin9Pf\x20=\x20Z8fP.fdSEP(\x27.\x27);\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20EQ\x20(!dnPPq9r.ErsSUIqf(\x27*\x27))\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x209qPU9r\x20dnPPq9r\x20===\x20Z8fP;\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20EQ\x20(dnPPq9rin9Pf.SqrpPZ\x20<\x20L\x20||\x20dnPPq9rin9Pf[D]\x20!==\x20\x27*\x27)\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x209qPU9r\x20QnSfq;\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20s8rfP\x20dnPPq9rgUQQEB\x20=\x20dnPPq9rin9Pf.fSEsq(0).u8Er(\x27.\x27);\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20s8rfP\x20Z8fPgUQQEB\x20=\x20Z8fPin9Pf.fSEsq(-dnPPq9rin9Pf.SqrpPZ\x20+\x200).u8Er(\x27.\x27);\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x209qPU9r\x20dnPPq9rgUQQEB\x20===\x20Z8fPgUQQEB;\x20\x20\x20\x20\x20\x20\x20\x20}\x20\x20\x20\x20\x20\x20\x20\x20SqP\x20I8jnEranSEI\x20=\x20(I8jnEr\x20&&\x20I8jnEr.SqrpPZ)\x20?\x20I8jnEr.f8jq((IjmPqj)\x20=>\x20Ef68jnErtnPsZErp(IjmPqj,\x20S8snPE8r.Z8fPrnjq))\x20:\x20P9Uq;\x20\x20\x20\x20\x20\x20\x20\x20EQ\x20(S8snPE8r.Z8fPrnjq\x20===\x20\x27S8snSZ8fP\x27)\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20I8jnEranSEI\x20=\x20P9Uq;\x20\x20\x20\x20\x20\x20\x20\x20}\x20\x20\x20\x20\x20\x20\x20\x20s8rfP\x205nSEI\x20=\x20fEpranSEI\x20&&\x20I8jnEranSEI;\x20\x20\x20\x20\x20\x20\x20\x209qPU9r\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x205nSEI,\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20jqffnpq:\x2089EpErtqffnpq,\x20\x20\x20\x20\x20\x20\x20\x20};\x20\x20\x20\x20}\x20snPsZ\x20(q9989)\x20{\x20\x20\x20\x20\x20\x20\x20\x209qPU9r\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x205nSEI:\x20QnSfq,\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20jqffnpq:\x20{},\x20\x20\x20\x20\x20\x20\x20\x20};\x20\x20\x20\x20}}','_deserializeChartForUnit','getAllowedChartTypes','_initSnapshot','chartModelAdded$','createElement','setChartType','RemoveSheetsChartMutation','_data$','ensureChartModelCollection','pushUndoRedo','add','message','minValue','activeChartModel','registerWordCloudChartMakImageService','isArray','setOrient','parseNumber','CellValueType','Row','convertDataSet','FALSE','isFeatureAuthorizedWithinTime','graphic','ChartDataSource','refreshChartSource','asObservable','_configSubscription','reduce','subscribe','333607gQAqpY','getStyles','_dataSource','sheet.command.chart-update-source','SheetChartModel','boolean','maxValue','NUMBER','onRendered','get','startRow','intersects','pieSeriesFilterOperator'];_0x56ec=function(){return _0x166e81;};return _0x56ec();}var oe=Object['defineProperty'],ae=(_0x5ae862,_0x200c72,_0xd6a6ab)=>_0x200c72 in _0x5ae862?oe(_0x5ae862,_0x200c72,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0xd6a6ab}):_0x5ae862[_0x200c72]=_0xd6a6ab,_=(_0x5d4e16,_0x4fc259,_0x1ec5a1)=>ae(_0x5d4e16,typeof _0x4fc259!=_0x27e324(0xc7)?_0x4fc259+'':_0x4fc259,_0x1ec5a1);Object[_0x27e324(0x100)](exports,Symbol['toStringTag'],{'value':_0x27e324(0xe4)});const f=require('@univerjs-pro/engine-chart'),h=require('@univerjs/core'),M=require('rxjs'),b=require('@univerjs/sheets'),O=require('@univerjs-pro/license'),G='TRUE',H=_0x27e324(0xac),se=_0x8d1a86=>{const _0x39b47b=_0x27e324;var _0x230fd3;return((_0x230fd3=_0x8d1a86[_0x39b47b(0x150)])==null?void 0x0:_0x230fd3[_0x39b47b(0x142)]['replace'](/\r\n$/,''))||'';};function j(_0x1644c6,_0x5d2662,_0x2a288c){const _0x38f0d8=_0x27e324;var _0x1ee628,_0x4ae8dc,_0x2ec540;if(_0x1644c6){const {v:_0x384e83,t:_0x58bd77,p:_0x4b1fb6,s:_0x1e84fb}=_0x1644c6;if(_0x4b1fb6)return{'v':null,'t':f[_0x38f0d8(0x10a)]['Null']};if(_0x58bd77===h[_0x38f0d8(0xa9)][_0x38f0d8(0xbc)]){const _0x579d4a=_0x5d2662[_0x38f0d8(0xbe)](_0x1e84fb);if(_0x579d4a&&_0x579d4a['n']){const {pattern:_0x57c894}=_0x579d4a['n'];_0x57c894&&!_0x2a288c[_0x57c894]&&(_0x2a288c[_0x57c894]=h['numfmt'][_0x38f0d8(0x106)](_0x57c894));const _0x2690bc=_0x2a288c[_0x57c894];if(_0x2690bc&&_0x2690bc[_0x38f0d8(0xf1)])return typeof _0x384e83==_0x38f0d8(0xea)?{'v':Number(_0x384e83),'t':f[_0x38f0d8(0x10a)][_0x38f0d8(0x88)]}:{'v':(_0x1ee628=h[_0x38f0d8(0xce)][_0x38f0d8(0xe7)](_0x384e83))==null?void 0x0:_0x1ee628['v'],'t':f[_0x38f0d8(0x10a)][_0x38f0d8(0x88)]};if(_0x384e83==null)return{'v':null,'t':f[_0x38f0d8(0x10a)][_0x38f0d8(0x70)]};if(_0x57c894!==h['DEFAULT_NUMBER_FORMAT']&&_0x2690bc)return{'v':(_0x2ec540=(_0x4ae8dc=h[_0x38f0d8(0xce)][_0x38f0d8(0xa8)](_0x384e83))==null?void 0x0:_0x4ae8dc['v'])!=null?_0x2ec540:Number(_0x384e83),'t':f[_0x38f0d8(0x10a)][_0x38f0d8(0xbc)]};}return{'v':Number(_0x384e83),'t':f[_0x38f0d8(0x10a)][_0x38f0d8(0xbc)]};}else{if(_0x58bd77===h['CellValueType']['FORCE_STRING'])return{'v':String(_0x384e83),'t':f[_0x38f0d8(0x10a)]['STRING']};{const _0x5c9993=Number(_0x384e83);return _0x5c9993===_0x384e83?{'v':_0x5c9993,'t':f[_0x38f0d8(0x10a)][_0x38f0d8(0xbc)]}:_0x384e83==null?{'v':null,'t':f['ChartSourceDataTypeEnum'][_0x38f0d8(0x70)]}:{'v':String(_0x384e83),'t':f[_0x38f0d8(0x10a)]['STRING']};}}}return{'v':null,'t':f[_0x38f0d8(0x10a)][_0x38f0d8(0x70)]};}function ie(_0x204ba7,_0x328062,_0x289e36,_0x426c4a,_0x3d9500,_0x37787a){const _0x9832a2=_0x27e324,{startRow:_0x59c847,startColumn:_0x412cc6,endColumn:_0x42a909,endRow:_0x53886f}=_0x204ba7,_0x4a8216={};if(_0x59c847===_0x53886f)for(let _0x5d7cf7=_0x412cc6;_0x5d7cf7<=_0x42a909;_0x5d7cf7++){const _0x4c5640=_0x328062[_0x9832a2(0x135)](_0x59c847,_0x5d7cf7),{v:_0x232f9d,t:_0x61774}=j(_0x4c5640,_0x37787a,_0x4a8216);_0x426c4a[_0x9832a2(0x146)](_0x5d7cf7,_0x289e36,_0x232f9d),_0x3d9500['setValue'](_0x5d7cf7,_0x289e36,_0x61774);}if(_0x412cc6===_0x42a909)for(let _0x21f11e=_0x59c847;_0x21f11e<=_0x53886f;_0x21f11e++){const _0x12e5dc=_0x328062[_0x9832a2(0x135)](_0x21f11e,_0x412cc6),{v:_0x13c798,t:_0x295f62}=j(_0x12e5dc,_0x37787a,_0x4a8216);_0x426c4a[_0x9832a2(0x146)](_0x289e36,_0x21f11e,_0x13c798),_0x3d9500[_0x9832a2(0x146)](_0x289e36,_0x21f11e,_0x295f62);}}function w(_0x785042,_0x22e2f9,_0x2134f8){const _0x52e846=_0x27e324;if(_0x785042){const {v:_0x427db5,t:_0x39765d,p:_0x489d12,s:_0xc36cd7}=_0x785042;if(_0x489d12)return{'v':se(_0x489d12),'t':f['ChartSourceDataTypeEnum'][_0x52e846(0x125)]};if((_0x39765d===h[_0x52e846(0xa9)][_0x52e846(0xff)]||_0x39765d===h['CellValueType']['STRING'])&&_0x427db5!==void 0x0&&_0x427db5!==null)return{'v':String(_0x427db5),'t':f[_0x52e846(0x10a)][_0x52e846(0x125)]};if(_0x39765d===h[_0x52e846(0xa9)]['BOOLEAN'])return{'v':_0x427db5?G:H,'t':f[_0x52e846(0x10a)][_0x52e846(0x11f)]};if(_0x39765d===h[_0x52e846(0xa9)][_0x52e846(0xbc)]){const _0xcb910f=_0x22e2f9['get'](_0xc36cd7);if(_0xcb910f&&_0xcb910f['n']){const {pattern:_0x14a8fa}=_0xcb910f['n'];if(_0x14a8fa&&!_0x2134f8[_0x14a8fa]&&(_0x2134f8[_0x14a8fa]=h[_0x52e846(0xce)][_0x52e846(0x106)](_0x14a8fa)),_0x2134f8[_0x14a8fa]&&(_0x2134f8[_0x14a8fa]=h['numfmt']['getFormatInfo'](_0x14a8fa),_0x2134f8[_0x14a8fa][_0x52e846(0xf1)]))return{'v':String(_0x427db5),'t':f[_0x52e846(0x10a)][_0x52e846(0x88)]};}return{'v':String(_0x427db5),'t':f['ChartSourceDataTypeEnum']['NUMBER']};}else return typeof _0x427db5===_0x52e846(0xba)?{'v':_0x427db5?G:H,'t':f['ChartSourceDataTypeEnum'][_0x52e846(0x11f)]}:{'v':_0x427db5==null?'':String(_0x427db5),'t':f[_0x52e846(0x10a)][_0x52e846(0x125)]};}return{'v':'','t':f[_0x52e846(0x10a)]['STRING']};}class X extends f[_0x27e324(0xaf)]{constructor(_0x27fa9d,_0x4c4683){const _0x24dbd9=_0x27e324;super(),_(this,_0x24dbd9(0x14b)),_(this,_0x24dbd9(0x74)),this[_0x24dbd9(0xe0)]=_0x27fa9d;const _0x3a76f5=_0x4c4683[_0x24dbd9(0x108)]!==void 0x0?_0x4c4683[_0x24dbd9(0x108)]:!0x0;this['_rangeInfo$']=new M[(_0x24dbd9(0xd5))]({..._0x4c4683,'isRowDirection':_0x3a76f5}),this[_0x24dbd9(0x9e)]=new M[(_0x24dbd9(0xd5))]({'dimensions':[],'source':[]}),this[_0x24dbd9(0xc3)]=this[_0x24dbd9(0x121)][_0x24dbd9(0xb1)](),this[_0x24dbd9(0x110)]=this[_0x24dbd9(0x9e)][_0x24dbd9(0xb1)](),this['rangeInfo$']=this['_rangeInfo$'][_0x24dbd9(0xb1)](),this['_init']();}[_0x27e324(0x73)](){const _0x31b5c9=_0x27e324;return this[_0x31b5c9(0x14b)]['getValue']();}[_0x27e324(0xf4)](_0x2934d8){const _0x19b8d8=_0x27e324;this[_0x19b8d8(0x14b)][_0x19b8d8(0x13b)](_0x2934d8),this[_0x19b8d8(0x9e)][_0x19b8d8(0x13b)](this[_0x19b8d8(0xab)]()),this[_0x19b8d8(0x121)][_0x19b8d8(0x13b)](this[_0x19b8d8(0xf5)]());}[_0x27e324(0xa7)](_0x4835b9){const _0x1dfdd9=_0x27e324;this[_0x1dfdd9(0x121)]['next'](_0x4835b9);}['canSwitchOrient'](){return!0x0;}[_0x27e324(0x14e)](){}[_0x27e324(0xc2)](){}[_0x27e324(0xab)](){const _0x1ca48a=_0x27e324,{rangeInfo:_0x55ac89,isRowDirection:_0x5c109f}=this['getRangeInfo'](),_0x3d1ce1=this[_0x1ca48a(0xe0)],{unitId:_0x289eb2,subUnitId:_0x3b3573,range:_0x3e671f}=_0x55ac89,_0x38ced5=_0x3d1ce1[_0x1ca48a(0x8e)](_0x289eb2);if(!_0x38ced5)return{'dimensions':[],'source':[],'dimensionsType':[],'sourceType':[]};const _0xb3660f=_0x38ced5[_0x1ca48a(0x131)](_0x3b3573);if(!_0xb3660f)return{'dimensions':[],'source':[],'dimensionsType':[],'sourceType':[]};const _0x120b0d=[],_0x25d98b=[],_0x3a8d49=[],_0x17a23c=[],_0x5a2c54=_0x38ced5[_0x1ca48a(0xb6)](),_0x5d4dc5={};if(_0x3e671f[_0x1ca48a(0xee)]===-0x1||_0x3e671f['startRow']===-0x1)return{'dimensions':[],'source':[],'dimensionsType':[],'sourceType':[]};const _0x4eca2c=h[_0x1ca48a(0x138)]['transformRange'](_0x3e671f,_0xb3660f),{startColumn:_0x363e7e,startRow:_0x45fc79,endColumn:_0x50a905,endRow:_0x97d9aa}=_0x4eca2c;if(_0x5c109f){for(let _0x2ade6c=_0x363e7e;_0x2ade6c<=_0x50a905;_0x2ade6c++){const _0x1555d8=_0xb3660f[_0x1ca48a(0x135)](_0x45fc79,_0x2ade6c),{v:_0x1194e7,t:_0x3be589}=w(_0x1555d8,_0x5a2c54,_0x5d4dc5);_0x120b0d[_0x1ca48a(0xeb)](_0x1194e7),_0x25d98b['push'](_0x3be589);}for(let _0x461d3e=_0x45fc79+0x1;_0x461d3e<=_0x97d9aa;_0x461d3e++){const _0x2546a7=[],_0x310499=[];for(let _0xea8940=_0x363e7e;_0xea8940<=_0x50a905;_0xea8940++){const _0x23fc77=_0xb3660f[_0x1ca48a(0x135)](_0x461d3e,_0xea8940),{v:_0x4c5a73,t:_0x49ca4c}=_0xea8940===_0x363e7e?w(_0x23fc77,_0x5a2c54,_0x5d4dc5):j(_0x23fc77,_0x5a2c54,_0x5d4dc5);_0x2546a7[_0x1ca48a(0xeb)](_0x4c5a73),_0x310499[_0x1ca48a(0xeb)](_0x49ca4c);}_0x3a8d49[_0x1ca48a(0xeb)](_0x2546a7),_0x17a23c[_0x1ca48a(0xeb)](_0x310499);}}else{for(let _0x47f72c=_0x45fc79;_0x47f72c<=_0x97d9aa;_0x47f72c++){const _0x8db0bd=_0xb3660f[_0x1ca48a(0x135)](_0x47f72c,_0x363e7e),{v:_0x57fc4b,t:_0x328a5e}=w(_0x8db0bd,_0x5a2c54,_0x5d4dc5);_0x120b0d[_0x1ca48a(0xeb)](_0x57fc4b),_0x25d98b[_0x1ca48a(0xeb)](_0x328a5e);}for(let _0x32069d=_0x363e7e+0x1;_0x32069d<=_0x50a905;_0x32069d++){const _0x50767a=[];for(let _0x51ddf2=_0x45fc79;_0x51ddf2<=_0x97d9aa;_0x51ddf2++){const _0x539f2a=_0xb3660f[_0x1ca48a(0x135)](_0x51ddf2,_0x32069d),{v:_0x16d83c,t:_0x59c0ee}=_0x51ddf2===_0x45fc79?w(_0x539f2a,_0x5a2c54,_0x5d4dc5):j(_0x539f2a,_0x5a2c54,_0x5d4dc5);_0x50767a[_0x1ca48a(0xeb)](_0x16d83c);}_0x3a8d49[_0x1ca48a(0xeb)](_0x50767a);}}return{'dimensions':_0x120b0d,'source':_0x3a8d49,'dimensionsType':_0x25d98b,'sourceType':_0x17a23c};}}function _0x4595(_0x923bb0,_0x491eb0){const _0x56ec61=_0x56ec();return _0x4595=function(_0x459587,_0x3d156e){_0x459587=_0x459587-0x6c;let _0x27391d=_0x56ec61[_0x459587];return _0x27391d;},_0x4595(_0x923bb0,_0x491eb0);}class Q extends f[_0x27e324(0xaf)]{constructor(_0x3c435e,_0x4a5121){const _0x5565f6=_0x27e324;super(),_(this,_0x5565f6(0x14b)),_(this,'rangeInfo$'),(this['_univerInstanceService']=_0x3c435e,this['_rangeInfo$']=new M[(_0x5565f6(0xd5))](_0x4a5121));}[_0x27e324(0xf5)](){return!0x1;}['getRangeInfo'](){const _0x688a45=_0x27e324;return this[_0x688a45(0x14b)]['getValue']();}[_0x27e324(0xa7)](_0x2f8bc9){const _0x22afd6=_0x27e324;this[_0x22afd6(0x121)]['next'](_0x2f8bc9);}[_0x27e324(0xf4)](_0x11f5cb){const _0x5e9417=_0x27e324;this[_0x5e9417(0x14b)][_0x5e9417(0x13b)](_0x11f5cb);}[_0x27e324(0x14e)](){}[_0x27e324(0xc2)](){}[_0x27e324(0xab)](){const _0x3e7a63=_0x27e324,_0x4bd855=this['getRangeInfo'](),_0x4adde0=this['_univerInstanceService'],_0x743330=[],_0x699f03=[],_0x57de04={};for(const [_0x477506]of _0x4bd855){const {unitId:_0x10ac3f,subUnitId:_0x52f170,range:_0x5cd56e}=_0x477506,_0x1d6305=_0x4adde0['getUniverSheetInstance'](_0x10ac3f);if(!_0x1d6305)return{'dimensions':[],'source':[]};const _0xdb6100=_0x1d6305[_0x3e7a63(0x131)](_0x52f170);if(!_0xdb6100)return{'dimensions':[],'source':[]};const _0x5533cc=_0x1d6305[_0x3e7a63(0xb6)](),{v:_0x3fa97f,t:_0x93a930}=w(_0xdb6100[_0x3e7a63(0x135)](_0x5cd56e[_0x3e7a63(0xbf)],_0x5cd56e[_0x3e7a63(0xee)]),_0x5533cc,_0x57de04);_0x743330[_0x3e7a63(0xeb)](_0x3fa97f),_0x699f03[_0x3e7a63(0xeb)](_0x93a930);}let _0x5500c4=0x0;const _0x474225=new h[(_0x3e7a63(0x81))](),_0xb286a=new h[(_0x3e7a63(0x81))]();for(const [,_0x323538]of _0x4bd855){const {unitId:_0x564b69,subUnitId:_0xada767,range:_0x4a4646}=_0x323538,_0x5310bc=_0x4adde0[_0x3e7a63(0x8e)](_0x564b69);if(!_0x5310bc)return{'dimensions':[],'source':[],'dimensionsType':[],'sourceType':[]};const _0x2bf849=_0x5310bc['getSheetBySheetId'](_0xada767);if(!_0x2bf849)return{'dimensions':[],'source':[],'dimensionsType':[],'sourceType':[]};ie(_0x4a4646,_0x2bf849,_0x5500c4,_0x474225,_0xb286a,_0x5310bc[_0x3e7a63(0xb6)]()),_0x5500c4++;}const _0x52284c=_0x474225[_0x3e7a63(0x94)](),_0x28eeb8=_0xb286a['toArray']();return{'dimensions':_0x743330,'source':_0x52284c,'dimensionsType':_0x699f03,'sourceType':_0x28eeb8};}}function z(_0x1c4bc3,_0x4dc2e9){const _0x56f9f6=_0x27e324;return Array[_0x56f9f6(0xa6)](_0x4dc2e9)?new Q(_0x1c4bc3,_0x4dc2e9):new X(_0x1c4bc3,_0x4dc2e9);}function ce(_0x4ba0d5,_0x3df1af,_0xfa531d){const _0x44e9c7=_0x27e324,_0x6da7ea=[];for(let _0x26a2cc=0x0;_0x26a2cc<_0x4ba0d5[_0x44e9c7(0x14f)];_0x26a2cc++)_0x6da7ea[_0x44e9c7(0xeb)](_0x4ba0d5[_0x26a2cc][_0x3df1af]);return _0x6da7ea;}class Y extends f[_0x27e324(0xd3)]{get[_0x27e324(0xc4)](){const _0x564706=_0x27e324;return this[_0x564706(0xb7)];}constructor(_0xdef761,_0x4c8cc3,_0x321129){const _0x40effc=_0x27e324;super(_0xdef761,_0x4c8cc3,_0x321129),this[_0x40effc(0xfc)]();}['_init'](){const _0x3698e3=_0x27e324;var _0x1c90a5;const _0x440e06=this[_0x3698e3(0xfe)]()[_0x3698e3(0xbe)](h[_0x3698e3(0xf8)]);(_0x1c90a5=this[_0x3698e3(0xb2)])==null||_0x1c90a5['unsubscribe']();const {data$:_0x1c17d7,rangeInfo$:_0x3a0548}=this[_0x3698e3(0xb7)],_0x8f67cc=_0x1c17d7['pipe'](M[_0x3698e3(0x128)](_0x28da16=>{const {dimensions:_0x4606f6,source:_0x5a4d09}=_0x28da16;return!(!_0x4606f6||!_0x5a4d09);})),_0x304ba1=M['combineLatest']([_0x8f67cc,this[_0x3698e3(0xc8)],this[_0x3698e3(0x13d)]])['pipe'](M['debounceTime'](f[_0x3698e3(0x124)]),M['map'](([_0x2458c1,_0x26fa12,_0x4ed07e])=>[_0x2458c1,_0x26fa12,_0x4ed07e]));this[_0x3698e3(0xb2)]=M['combineLatest']([this[_0x3698e3(0x89)][_0x3698e3(0xe9)](M[_0x3698e3(0x104)]()),_0x304ba1,_0x3a0548])[_0x3698e3(0xe9)](M[_0x3698e3(0x128)](([_0x36233e])=>!!_0x36233e),M[_0x3698e3(0x122)](f[_0x3698e3(0x124)]))[_0x3698e3(0xb4)](([_0x572346,[_0x31ae03,_0xb67ae7],_0x6258c])=>{const _0x15c3a4=_0x3698e3;if(_0x31ae03[_0x15c3a4(0xcd)][_0x15c3a4(0x14f)]<=0x0||_0x31ae03[_0x15c3a4(0x109)][_0x15c3a4(0x14f)]<=0x0){this[_0x15c3a4(0x6c)]['next']({'type':this['chartType'],'category':void 0x0,'maxValue':-0x1/0x0,'minValue':0x1/0x0,'series':[]});return;}const _0xbc92ed=Array[_0x15c3a4(0xa6)](_0x6258c)?!0x1:!!_0x6258c[_0x15c3a4(0x108)],_0x5ac50e=f['buildChartData'](_0x31ae03,_0xb67ae7,_0x572346,_0xbc92ed,_0x440e06);this[_0x15c3a4(0x6c)]['next']({'type':_0x572346,'headers':_0xb67ae7[_0x15c3a4(0x85)],'category':_0x5ac50e[_0x15c3a4(0x7a)],'series':_0x5ac50e['series'],'maxValue':_0x5ac50e[_0x15c3a4(0xbb)],'minValue':_0x5ac50e[_0x15c3a4(0xa3)],'bubble':_0x5ac50e[_0x15c3a4(0x112)],'relationData':_0x5ac50e['relationData'],'sankeyData':_0x5ac50e[_0x15c3a4(0x11b)],'heatmapData':_0x5ac50e['heatmapData']});}),this['disposeWithMe'](this[_0x3698e3(0xb2)]);}[_0x27e324(0x13a)](){const _0x11db2b=_0x27e324;super[_0x11db2b(0x13a)](),this['_chartType$'][_0x11db2b(0x13e)](),this[_0x11db2b(0xf6)][_0x11db2b(0x13e)](),this[_0x11db2b(0x6c)]['complete'](),this[_0x11db2b(0x151)][_0x11db2b(0x13e)]();}}var he=Object[_0x27e324(0xca)],ue=(_0x2d22d6,_0x1ad594,_0x38c6e1,_0xdb377c)=>{const _0x13e3cf=_0x27e324;for(var _0x4ed29a=_0xdb377c>0x1?void 0x0:_0xdb377c?he(_0x1ad594,_0x38c6e1):_0x1ad594,_0x5d7a7a=_0x2d22d6[_0x13e3cf(0x14f)]-0x1,_0x23f31d;_0x5d7a7a>=0x0;_0x5d7a7a--)(_0x23f31d=_0x2d22d6[_0x5d7a7a])&&(_0x4ed29a=_0x23f31d(_0x4ed29a)||_0x4ed29a);return _0x4ed29a;},de=(_0x5c01f0,_0x4eb929)=>(_0x58e657,_0x231eec)=>_0x4eb929(_0x58e657,_0x231eec,_0x5c01f0);exports[_0x27e324(0xe1)]=class extends h[_0x27e324(0x11c)]{constructor(_0x4e9fe5){const _0x2613e5=_0x27e324;super(),_(this,_0x2613e5(0x14c),new M[(_0x2613e5(0xd5))](null)),_(this,_0x2613e5(0x149),this['_activeChartModel$'][_0x2613e5(0xb1)]()),_(this,_0x2613e5(0x10b),new Map()),_(this,_0x2613e5(0xec),new Set()),_(this,_0x2613e5(0x10f),new M['Subject']()),_(this,_0x2613e5(0x9a),this[_0x2613e5(0x10f)]['asObservable']()),_(this,_0x2613e5(0x116),new M[(_0x2613e5(0xcf))]()),_(this,_0x2613e5(0x6e),this[_0x2613e5(0x116)][_0x2613e5(0xb1)]()),this[_0x2613e5(0x8c)]=_0x4e9fe5;}get[_0x27e324(0xa4)](){const _0x395927=_0x27e324;return this[_0x395927(0x14c)][_0x395927(0x7d)]();}[_0x27e324(0x92)](_0x141e4e){const _0x6dcb59=_0x27e324;this[_0x6dcb59(0x14c)]['next'](_0x141e4e);}[_0x27e324(0xdc)](){const _0x325284=_0x27e324;return this[_0x325284(0x14c)][_0x325284(0x7d)]();}[_0x27e324(0x12f)](_0x4e287a){const _0x2fe011=_0x27e324;return this['_models'][_0x2fe011(0xbe)](_0x4e287a);}[_0x27e324(0x10e)](){const _0x205281=_0x27e324,_0x2b26f0=Array[_0x205281(0xe2)](this[_0x205281(0x10b)][_0x205281(0x102)]());for(const _0x5f3482 of _0x2b26f0){const _0x47b28e=this[_0x205281(0x10b)]['get'](_0x5f3482);_0x47b28e&&_0x47b28e[_0x205281(0xc4)]['refresh']();}}['createChartModel'](_0x2d6833,_0x4585ee,_0x50d280=!0x1){const _0x3d56ae=_0x27e324,_0x292fa4=new Y(_0x2d6833,_0x4585ee,this['_injector']);this[_0x3d56ae(0x10b)][_0x3d56ae(0x7c)](_0x292fa4['id'],_0x292fa4);const _0x15c256=this['generateChartModelContext'](_0x292fa4['id']);return _0x15c256&&_0x292fa4[_0x3d56ae(0x11d)](_0x15c256),_0x50d280&&_0x292fa4[_0x3d56ae(0xef)]({'titles':{'title':{'content':''}}}),this[_0x3d56ae(0x10f)][_0x3d56ae(0x13b)](_0x292fa4),_0x292fa4;}['removeChartModel'](_0x3b6983){const _0x4a19cc=_0x27e324,{_models:_0x53bf4c}=this,_0x417f5e=_0x53bf4c[_0x4a19cc(0xbe)](_0x3b6983);_0x417f5e&&(this[_0x4a19cc(0x116)][_0x4a19cc(0x13b)](_0x417f5e['id']),_0x417f5e[_0x4a19cc(0x13a)](),_0x53bf4c[_0x4a19cc(0xd0)](_0x3b6983));}[_0x27e324(0x139)](_0x53bb46){const _0x50f31f=_0x27e324,_0x910bf2=[f[_0x50f31f(0x136)],f['findCategoryOperator'],f['findSeriesOperator'],f[_0x50f31f(0xc1)]],_0x8f0659=this[_0x50f31f(0x10b)][_0x50f31f(0xbe)](_0x53bb46),_0x5d04b5=(_0x8f0659==null?void 0x0:_0x8f0659[_0x50f31f(0x14a)])||{},_0x20db76=_0x8f0659==null?void 0x0:_0x8f0659[_0x50f31f(0xc4)];return _0x8f0659&&_0x20db76?_0x910bf2[_0x50f31f(0xb3)]((_0x243369,_0x22d7f9)=>{const _0x3ab33b=_0x22d7f9(_0x20db76,_0x243369,_0x8f0659);return{..._0x243369,..._0x3ab33b};},_0x5d04b5):null;}[_0x27e324(0x13a)](){const _0x30ce69=_0x27e324;super['dispose'](),this['_models']['forEach'](_0x51f15a=>_0x51f15a['dispose']()),this['_models'][_0x30ce69(0xfa)](),this[_0x30ce69(0xec)][_0x30ce69(0xfa)](),this[_0x30ce69(0x14c)][_0x30ce69(0x13e)](),this[_0x30ce69(0x10f)]['complete'](),this[_0x30ce69(0x116)]['complete']();}},exports[_0x27e324(0xe1)]=ue([de(0x0,h[_0x27e324(0x83)](h['Injector']))],exports['ChartModelService']);var le=Object['getOwnPropertyDescriptor'],fe=(_0x3a43fb,_0x581c0,_0x406a50,_0x1f7cbd)=>{const _0x4c20f4=_0x27e324;for(var _0x450e51=_0x1f7cbd>0x1?void 0x0:_0x1f7cbd?le(_0x581c0,_0x406a50):_0x581c0,_0x5a3a79=_0x3a43fb[_0x4c20f4(0x14f)]-0x1,_0x54c847;_0x5a3a79>=0x0;_0x5a3a79--)(_0x54c847=_0x3a43fb[_0x5a3a79])&&(_0x450e51=_0x54c847(_0x450e51)||_0x450e51);return _0x450e51;},D=(_0x4c4a2b,_0x2071c5)=>(_0x3413e6,_0x2433b9)=>_0x2071c5(_0x3413e6,_0x2433b9,_0x4c4a2b);const ge=_0x27e324(0x71);exports['SheetsChartService']=class extends h[_0x27e324(0x11c)]{constructor(_0x4a0595,_0x626cab,_0x396adf,_0x12cfda,_0x3794ad){const _0x422259=_0x27e324;super(),_(this,_0x422259(0x82),new Map()),_(this,_0x422259(0x129),new Map()),_(this,_0x422259(0x6f),!0x1),(this[_0x422259(0x123)]=_0x4a0595,this[_0x422259(0xcc)]=_0x626cab,this[_0x422259(0xe0)]=_0x396adf,this[_0x422259(0x78)]=_0x12cfda,this['_commandService']=_0x3794ad,this[_0x422259(0x99)]());}[_0x27e324(0x12a)](){this['_hasLoaded']=!0x0;}[_0x27e324(0x6d)](_0xe2e187,_0x2c45c9){const _0x28be85=_0x27e324,_0x5d138e=this['_chartModelIdMap']['get'](_0xe2e187);if(!_0x5d138e)return[];const _0xaf04e8=_0x5d138e['get'](_0x2c45c9);if(!_0xaf04e8)return[];const {_chartModelService:_0x6e9a3c}=this;return Array[_0x28be85(0xe2)](_0xaf04e8)[_0x28be85(0xd8)](_0x344eb7=>_0x6e9a3c[_0x28be85(0x12f)](_0x344eb7));}[_0x27e324(0x7f)](_0xbb8c7c){const _0x211992=_0x27e324;if(Array[_0x211992(0xa6)](_0xbb8c7c))return{'orient':f[_0x211992(0xcb)][_0x211992(0x11a)],'chartType':f['ChartTypeBits'][_0x211992(0x10d)]};{const {rangeInfo:_0x145a4c}=_0xbb8c7c,{range:_0x412d0c}=_0x145a4c,{startRow:_0x4bd9d3,endRow:_0x316298,startColumn:_0x5e1ebe,endColumn:_0x2f093a}=_0x412d0c,_0x311a91=_0x316298-_0x4bd9d3>=_0x2f093a-_0x5e1ebe;return{'orient':_0x311a91?f['DataOrientation'][_0x211992(0x11a)]:f[_0x211992(0xcb)][_0x211992(0xaa)],'chartType':_0x311a91?f[_0x211992(0xdb)][_0x211992(0x10d)]:f['ChartTypeBits'][_0x211992(0x11a)]};}}[_0x27e324(0x9f)](_0x86e4e7,_0x11dc29){const _0x4afb75=_0x27e324;let _0x1b7a8a=this[_0x4afb75(0x82)]['get'](_0x86e4e7);_0x1b7a8a||(_0x1b7a8a=new Map(),this['_chartModelIdMap'][_0x4afb75(0x7c)](_0x86e4e7,_0x1b7a8a));let _0x5915cd=_0x1b7a8a[_0x4afb75(0xbe)](_0x11dc29);return _0x5915cd||(_0x5915cd=new Set(),_0x1b7a8a[_0x4afb75(0x7c)](_0x11dc29,_0x5915cd)),_0x5915cd;}[_0x27e324(0x8b)](_0x10b87c){const _0x62ef=_0x27e324;return this['_dataSourceMap'][_0x62ef(0xbe)](_0x10b87c);}[_0x27e324(0x90)](_0x8bddc2,_0x49d9c3){const _0x4a9fe=_0x27e324;this[_0x4a9fe(0x129)]['set'](_0x8bddc2,_0x49d9c3);}[_0x27e324(0xb0)](){const _0x4a5d84=_0x27e324;this['_chartModelService'][_0x4a5d84(0x10e)]();}[_0x27e324(0xd2)](_0x51db91,_0x4bf2ce,_0x3f5e40,_0x119170=!0x1){const _0x1aa63d=_0x27e324;var _0x37a5c1;const {orient:_0x576864,context:_0x31010b,dataAggregation:_0x32ba5a,id:_0xe8f4f8,style:_0x13a31d,rangeInfo:_0xcccd6d}=_0x3f5e40,_0x121171=z(this[_0x1aa63d(0xe0)],_0xcccd6d),_0x9df809=_0xe8f4f8!=null?_0xe8f4f8:h[_0x1aa63d(0x126)](),_0x2a9316=this['getChartSuggestion'](_0xcccd6d),_0x1da81d=(_0x37a5c1=_0x3f5e40[_0x1aa63d(0xf2)])!=null?_0x37a5c1:_0x2a9316['chartType'],_0x42499f=this[_0x1aa63d(0x78)][_0x1aa63d(0xd2)](_0x9df809,{'dataSource':_0x121171,'chartType':_0x1da81d!=null?_0x1da81d:_0x2a9316[_0x1aa63d(0xf2)],'dataAggregation':_0x32ba5a,'style':_0x13a31d,'context':_0x31010b},_0x119170);let _0x5066ce=null;const _0x1c3eb7=_0x42499f['dataSource']['rangeInfo$'][_0x1aa63d(0xe9)](M['debounceTime'](f[_0x1aa63d(0x124)]))[_0x1aa63d(0xb4)](()=>{const _0x1c8d01=_0x1aa63d;_0x5066ce==null||_0x5066ce[_0x1c8d01(0x13a)](),_0x5066ce=this['watchRange'](_0x42499f);}),_0x66d3be=this['ensureChartModelCollection'](_0x51db91,_0x4bf2ce);return _0x66d3be[_0x1aa63d(0xa1)](_0x42499f['id']),_0x42499f[_0x1aa63d(0x13c)](()=>{const _0x479a1f=_0x1aa63d;_0x66d3be[_0x479a1f(0xd0)](_0x42499f['id']),_0x5066ce==null||_0x5066ce[_0x479a1f(0x13a)](),_0x1c3eb7[_0x479a1f(0x72)](),_0x121171[_0x479a1f(0x13a)](),this[_0x479a1f(0x129)][_0x479a1f(0xd0)](_0x42499f['id']);}),this[_0x1aa63d(0x129)]['set'](_0x42499f['id'],_0x121171),_0x42499f;}[_0x27e324(0xf0)](_0x1c1c2b){const _0x47c436=_0x27e324,_0x343317=this['_chartModelService']['getChartModel'](_0x1c1c2b);_0x343317&&(_0x343317[_0x47c436(0x13a)](),this[_0x47c436(0x78)][_0x47c436(0xf0)](_0x1c1c2b));}[_0x27e324(0x12f)](_0x38a3b2){const _0xa1647a=_0x27e324;return this[_0xa1647a(0x78)]['getChartModel'](_0x38a3b2);}[_0x27e324(0x119)](_0x3fd34c){const _0x557692=_0x27e324,_0xebe10b=this[_0x557692(0x82)][_0x557692(0xbe)](_0x3fd34c);if(!_0xebe10b)return'{}';const _0x1fd625={};for(const _0x38acc7 of _0xebe10b[_0x557692(0x102)]()){const _0x32c4a6=_0xebe10b['get'](_0x38acc7);if(_0x32c4a6)for(const _0x24a301 of Array['from'](_0x32c4a6)){const _0x2ecc5d=this['_chartModelService']['getChartModel'](_0x24a301),_0x34bf6d=this[_0x557692(0x8b)](_0x24a301);_0x2ecc5d&&_0x34bf6d&&(_0x1fd625[_0x38acc7]||(_0x1fd625[_0x38acc7]=[]),_0x1fd625[_0x38acc7][_0x557692(0xeb)]({'rangeInfo':_0x34bf6d[_0x557692(0x73)](),..._0x2ecc5d[_0x557692(0x91)]()}));}}return JSON[_0x557692(0x8d)](_0x1fd625);}[_0x27e324(0xc2)](_0xe46a20){const _0x2c116b=_0x27e324,{dataSource:_0x3eeb74}=_0xe46a20,_0x34b90b=_0x3eeb74[_0x2c116b(0x73)](),{subUnitId:_0x5a747d,unitId:_0x344e36,range:_0x4eb5f6}=_0x34b90b['rangeInfo'],_0x427994=this[_0x2c116b(0x8a)]['onCommandExecuted'](_0x160b08=>{const _0x320fcc=_0x2c116b;if(_0x160b08['id']===b[_0x320fcc(0x12d)]['id']){const {subUnitId:_0x55ccfe,unitId:_0x24c1ef,cellValue:_0x2bdb81}=_0x160b08[_0x320fcc(0x12b)],_0x134da7=new h[(_0x320fcc(0x81))](_0x2bdb81)['getStartEndScope']();_0x55ccfe===_0x5a747d&&_0x24c1ef===_0x344e36&&_0x134da7&&h[_0x320fcc(0x86)][_0x320fcc(0xc0)](_0x4eb5f6,_0x134da7)&&this[_0x320fcc(0xc9)](_0xe46a20,_0x34b90b);}if(_0x160b08['id']===b[_0x320fcc(0xdd)]['id']){const {subUnitId:_0x216e2d,unitId:_0x382e28,range:_0x480a15}=_0x160b08['params'];_0x216e2d===_0x5a747d&&_0x344e36===_0x382e28&&h[_0x320fcc(0x86)][_0x320fcc(0xc0)](_0x4eb5f6,_0x480a15)&&this['_updateChartRangeAndContext'](_0xe46a20,_0x34b90b);}if(_0x160b08['id']===b[_0x320fcc(0x11e)]['id']||_0x160b08['id']===b[_0x320fcc(0x118)]['id']){const {subUnitId:_0x27cd78,unitId:_0x2cc5d2,range:_0xa5f980}=_0x160b08[_0x320fcc(0x12b)];_0x27cd78===_0x5a747d&&_0x344e36===_0x2cc5d2&&h['Rectangle'][_0x320fcc(0xf9)](_0xa5f980,_0x4eb5f6)&&(_0x34b90b['rangeInfo'][_0x320fcc(0x144)]={'startRow':-0x1,'startColumn':-0x1,'endRow':0x0,'endColumn':0x0},this[_0x320fcc(0xc9)](_0xe46a20,_0x34b90b));}}),_0x40c493=(_0x2c329c,_0x19c5a2)=>{const _0x164e1e=_0x2c116b;_0x19c5a2?(_0x34b90b[_0x164e1e(0x93)][_0x164e1e(0x144)]={..._0x19c5a2},this[_0x164e1e(0xc9)](_0xe46a20,_0x34b90b)):(_0x34b90b['rangeInfo']['range']={'startRow':-0x1,'startColumn':-0x1,'endRow':0x0,'endColumn':0x0},this[_0x164e1e(0xc9)](_0xe46a20,_0x34b90b));},_0x18aca0=this[_0x2c116b(0xcc)]['watchRange'](_0x344e36,_0x5a747d,_0x4eb5f6,_0x40c493);return{'dispose':()=>{const _0x543711=_0x2c116b;_0x427994[_0x543711(0x13a)](),_0x18aca0[_0x543711(0x13a)]();}};}[_0x27e324(0xc9)](_0x55a00c,_0x3db15d){const _0x1f03b6=_0x27e324;if(!this[_0x1f03b6(0x6f)])return;const {dataSource:_0xd5ce8e,id:_0x2e7cd1}=_0x55a00c;_0xd5ce8e[_0x1f03b6(0xf4)](_0x3db15d);const _0x264a5e=this[_0x1f03b6(0x78)][_0x1f03b6(0x139)](_0x2e7cd1);_0x264a5e&&_0x55a00c[_0x1f03b6(0x11d)](_0x264a5e);}[_0x27e324(0x97)](_0x455f52,_0x5af5ae){const _0x34676a=_0x27e324;this[_0x34676a(0xe0)][_0x34676a(0x8e)](_0x455f52)&&Object[_0x34676a(0x102)](_0x5af5ae)['forEach'](_0x35df65=>{const _0x356b1c=_0x34676a,_0x210030=_0x5af5ae[_0x35df65];!_0x210030||_0x210030[_0x356b1c(0x14f)]<=0x0||_0x210030[_0x356b1c(0xd6)](_0x30c7a4=>{const _0xb40f39=_0x356b1c,{rangeInfo:_0x4db9df}=_0x30c7a4;this[_0xb40f39(0xd2)](_0x455f52,_0x35df65,{..._0x30c7a4,'rangeInfo':_0x4db9df});});});}[_0x27e324(0x99)](){const _0x4bd070=_0x27e324;this[_0x4bd070(0x123)]['registerPluginResource']({'pluginName':ge,'businesses':[h[_0x4bd070(0xed)][_0x4bd070(0x7e)]],'toJson':_0x12e1a6=>this[_0x4bd070(0x119)](_0x12e1a6),'parseJson':_0x14f74e=>JSON[_0x4bd070(0x134)](_0x14f74e),'onLoad':(_0x5537a5,_0x3ad961)=>{const _0x6c992b=_0x4bd070;this[_0x6c992b(0x97)](_0x5537a5,_0x3ad961),this[_0x6c992b(0x6f)]=!0x0;},'onUnLoad':_0x483fc0=>{const _0x38834a=_0x4bd070;var _0x27763f;(_0x27763f=this[_0x38834a(0x82)][_0x38834a(0xbe)](_0x483fc0))==null||_0x27763f[_0x38834a(0xd6)](_0x1806c6=>{const _0x4db13d=_0x38834a;Array['from'](_0x1806c6[_0x4db13d(0x117)]())[_0x4db13d(0xd6)](_0x35f857=>{const _0x4dc593=_0x4db13d;var _0x1d382a;(_0x1d382a=this[_0x4dc593(0x78)]['getChartModel'](_0x35f857))==null||_0x1d382a[_0x4dc593(0x13a)](),this[_0x4dc593(0x78)]['removeChartModel'](_0x35f857);});});}});}[_0x27e324(0x13a)](){const _0x34f7c9=_0x27e324;super[_0x34f7c9(0x13a)](),this[_0x34f7c9(0x78)][_0x34f7c9(0x13a)](),this['_chartModelIdMap']['clear'](),this[_0x34f7c9(0x129)][_0x34f7c9(0xd6)](_0x3dab70=>_0x3dab70[_0x34f7c9(0x13a)]()),this[_0x34f7c9(0x129)]['clear']();}},exports[_0x27e324(0x103)]=fe([D(0x0,h[_0x27e324(0xe6)]),D(0x1,h[_0x27e324(0x83)](b[_0x27e324(0x12e)])),D(0x2,h[_0x27e324(0xde)]),D(0x3,h[_0x27e324(0x83)](exports['ChartModelService'])),D(0x4,h[_0x27e324(0xc5)])],exports[_0x27e324(0x103)]);const U={'id':_0x27e324(0x95),'type':h['CommandType'][_0x27e324(0x10c)],'handler':(_0x1499c7,_0x26ca83)=>{const _0x27f40a=_0x27e324,{dataAggregation:_0x2ae17f,style:_0xf011a6,context:_0x50bc6f,chartType:_0x11ac10,chartModelId:_0x4fda6e}=_0x26ca83,_0xdca7c0=_0x1499c7['get'](exports[_0x27f40a(0x103)])[_0x27f40a(0x12f)](_0x4fda6e);return _0xdca7c0&&(_0xf011a6&&_0xdca7c0[_0x27f40a(0xef)](_0xf011a6),_0x2ae17f&&_0xdca7c0['assignDataAggregation'](_0x2ae17f),_0x50bc6f&&_0xdca7c0[_0x27f40a(0x11d)](_0x50bc6f),_0x11ac10&&_0xdca7c0[_0x27f40a(0x9c)](_0x11ac10)),!0x0;}},W={'id':_0x27e324(0xfd),'type':h[_0x27e324(0x111)][_0x27e324(0x87)],'handler':(_0xb8356f,_0x26da9e)=>{const _0x2c59f3=_0x27e324;if(!_0x26da9e)return!0x1;const {unitId:_0x4934b7,style:_0x3168c9,dataAggregation:_0xeb2a35,context:_0x5a4afb,chartModelId:_0x53bd71,chartType:_0x40bf5b}=_0x26da9e,_0x544e55=_0xb8356f['get'](exports[_0x2c59f3(0x103)])[_0x2c59f3(0x12f)](_0x53bd71);if(!_0x544e55)return!0x1;const _0x295c49=_0xb8356f[_0x2c59f3(0xbe)](h[_0x2c59f3(0xc5)]),_0x3b2154=_0xb8356f[_0x2c59f3(0xbe)](h[_0x2c59f3(0x84)]),_0x14032d=[],_0x20e996=[];_0x14032d[_0x2c59f3(0xeb)]({'id':U['id'],'params':{'unitId':_0x4934b7,'chartModelId':_0x53bd71,'style':_0x3168c9,'dataAggregation':_0xeb2a35,'context':_0x5a4afb,'chartType':_0x40bf5b}});const _0x1fd0a1={'unitId':_0x4934b7,'chartModelId':_0x53bd71};if(_0x3168c9){const _0x51c70b=_0x544e55[_0x2c59f3(0x132)]||{};_0x1fd0a1[_0x2c59f3(0x132)]=J(_0x3168c9,_0x51c70b);}return _0xeb2a35&&(_0x1fd0a1[_0x2c59f3(0xc6)]=Z(_0xeb2a35,_0x544e55['dataAggregation']||{})),_0x5a4afb&&(_0x1fd0a1[_0x2c59f3(0x14a)]=Z(_0x5a4afb,_0x544e55['context']||{})),_0x40bf5b&&(_0x1fd0a1[_0x2c59f3(0xf2)]=_0x544e55[_0x2c59f3(0xf2)]),_0x20e996[_0x2c59f3(0xeb)]({'id':U['id'],'params':_0x1fd0a1}),_0x14032d[_0x2c59f3(0x120)](_0x201f4a=>_0x295c49[_0x2c59f3(0xd1)](_0x201f4a['id'],_0x201f4a[_0x2c59f3(0x12b)]))&&_0x3b2154[_0x2c59f3(0xa0)]({'unitID':_0x4934b7,'redoMutations':[..._0x14032d],'undoMutations':[..._0x20e996]}),!0x0;}};function J(_0x5233bd,_0x3870e8){const _0x51d7ce=_0x27e324,_0x4583e7={};return Object[_0x51d7ce(0x102)](_0x5233bd)[_0x51d7ce(0xd6)](_0xec7e7f=>{const _0xac741b=_0x51d7ce;if(!(_0xec7e7f in _0x3870e8)){_0x4583e7[_0xec7e7f]=null;return;}if(_0x5233bd[_0xec7e7f]&&typeof _0x5233bd[_0xec7e7f]=='object'&&!Array[_0xac741b(0xa6)](_0x5233bd[_0xec7e7f])){const _0x357fa7=J(_0x5233bd[_0xec7e7f],_0x3870e8[_0xec7e7f]||{});Object[_0xac741b(0x102)](_0x357fa7)[_0xac741b(0x14f)]>0x0&&(_0x4583e7[_0xec7e7f]=_0x357fa7);}_0x4583e7[_0xec7e7f]=_0x3870e8[_0xec7e7f];}),_0x4583e7;}function Z(_0x76794f,_0x53f150){const _0x4b9b25=_0x27e324,_0x8d1720={};return Object['keys'](_0x76794f)[_0x4b9b25(0xd6)](_0x50bebd=>{_0x8d1720[_0x50bebd]=_0x50bebd in _0x53f150?_0x53f150[_0x50bebd]:null;}),_0x8d1720;}const A={'id':_0x27e324(0x140),'type':h['CommandType'][_0x27e324(0x10c)],'handler':(_0x32029f,_0x27e534)=>{const _0x2e9d35=_0x27e324,{chartModelId:_0x35ce53,rangeInfo:_0x6d5bf7}=_0x27e534,_0x5441dc=_0x32029f['get'](exports[_0x2e9d35(0x103)])[_0x2e9d35(0x8b)](_0x35ce53);if(!_0x5441dc)return!0x1;const _0x1663d4=Array[_0x2e9d35(0xa6)](_0x6d5bf7),_0x1498ff=_0x5441dc instanceof Q;return _0x1663d4===_0x1498ff&&_0x5441dc==null||_0x5441dc[_0x2e9d35(0xf4)](_0x6d5bf7),!0x0;}},K={'id':_0x27e324(0xb8),'type':h['CommandType']['COMMAND'],'handler':(_0x1fc7e4,_0x4e494c)=>{const _0x5473dc=_0x27e324;if(!_0x4e494c)return!0x1;const {unitId:_0x588de2,chartModelId:_0x2e79d7,range:_0x488667}=_0x4e494c,_0x197f11=_0x1fc7e4['get'](exports['SheetsChartService']),_0x52687b=_0x1fc7e4['get'](exports[_0x5473dc(0xe1)]),_0x5a0727=_0x197f11['getChartModel'](_0x2e79d7);if(!_0x5a0727||!_0x488667)return!0x1;const _0x3dcd3e=_0x1fc7e4['get'](h[_0x5473dc(0xc5)]),_0x578c30=_0x1fc7e4[_0x5473dc(0xbe)](h[_0x5473dc(0x84)]),_0x5dbadc=_0x197f11[_0x5473dc(0x8b)](_0x2e79d7);if(!_0x5dbadc)return!0x1;const _0x1f8094=_0x5dbadc[_0x5473dc(0x73)](),_0x6c402=_0x5a0727[_0x5473dc(0x14a)],_0x5e7f9a={'unitId':_0x588de2,'chartModelId':_0x2e79d7,'rangeInfo':_0x488667};if(!_0x3dcd3e['syncExecuteCommand'](A['id'],_0x5e7f9a))return!0x1;const _0x24763a=_0x52687b[_0x5473dc(0x139)](_0x2e79d7),_0x53871d={'unitId':_0x588de2,'chartModelId':_0x2e79d7,'context':_0x24763a};if(!_0x3dcd3e['syncExecuteCommand'](U['id'],_0x53871d))return!0x1;const _0x95e76d=[{'id':A['id'],'params':_0x5e7f9a},{'id':U['id'],'params':_0x53871d}],_0xcccad=[{'id':A['id'],'params':{'unitId':_0x588de2,'chartModelId':_0x2e79d7,'rangeInfo':_0x1f8094}},{'id':U['id'],'params':{'unitId':_0x588de2,'chartModelId':_0x2e79d7,'context':_0x6c402}}];return _0x578c30['pushUndoRedo']({'unitID':_0x588de2,'redoMutations':[..._0x95e76d],'undoMutations':[..._0xcccad]}),!0x0;}},ee={'id':_0x27e324(0xd4),'type':h[_0x27e324(0x111)][_0x27e324(0x10c)],'handler':(_0x52e911,_0x209196)=>{const _0x503db1=_0x27e324,{unitId:_0x4f18ca,subUnitId:_0x5b96d7,range:_0x5a2485,chartId:_0xc8729,isRowDirection:_0x3257b6}=_0x209196,_0x36fb32=_0x52e911['get'](exports[_0x503db1(0x103)]),_0x3f16bd={'rangeInfo':{'unitId':_0x4f18ca,'subUnitId':_0x5b96d7,'range':_0x5a2485},'isRowDirection':_0x3257b6!=null?_0x3257b6:!0x0};return _0x36fb32['createChartModel'](_0x4f18ca,_0x5b96d7,{'rangeInfo':_0x3f16bd,'id':_0xc8729,'chartType':_0x209196[_0x503db1(0xf2)]},!0x0),!0x0;}},te={'id':_0x27e324(0x105),'type':h['CommandType'][_0x27e324(0x10c)],'handler':(_0x29dd4c,_0x2d2986)=>{const _0x16b28c=_0x27e324,{chartId:_0x4376bc}=_0x2d2986;return _0x29dd4c[_0x16b28c(0xbe)](exports[_0x16b28c(0x103)])[_0x16b28c(0xf0)](_0x4376bc),!0x0;}},Se=_0x27e324(0x96),pe={0x0:'1',0x1:'7',0x2:'E',0x3:'9',0x4:'Z',0x5:'v',0x6:'D',0x7:'O',0x8:'o',0x9:'r','D':'0','L':'2','O':'3','V':'4','H':'5','k':'6','A':'8','n':'a','l':'b','s':'c','I':'d','q':'e','Q':'f','p':'g','Z':'h','E':'i','u':'j','y':'k','S':'l','j':'m','r':'n','d':'p','c':'q','f':'s','P':'t','U':'u','N':'w','B':'x','X':'y','z':'z','G':'A','F':'B','e':'C','W':'F','b':'G','Y':'H','m':'I','h':'J','M':'K','v':'L','t':'M','K':'N','i':'P','w':'Q','x':'R','g':'S','R':'T','T':'U','a':'V','o':'W','C':'X','J':'Y'},Ce=Number['parseInt'](0x690efbe6),N=['2','4','8','268435460'],me=[_0x27e324(0xf7)],ve=[],_e=(_0x355964,_0x381ac1,_0x576e1e)=>{const _0x2e6275=_0x27e324,_0xab8e02=_0x381ac1[_0x2e6275(0x137)]('.'),_0x3b005f=_0xab8e02['pop']();_0xab8e02[_0x2e6275(0xd6)](_0x3bceae=>{_0x355964[_0x3bceae]||(_0x355964[_0x3bceae]={}),_0x355964=_0x355964[_0x3bceae];}),_0x3b005f&&(_0x355964[_0x3b005f]=_0x576e1e);},Ie=(_0x56684b,_0x1b90b2)=>{const _0x1dde41=_0x27e324;_0x56684b[_0x1dde41(0xae)]||(_0x56684b[_0x1dde41(0xae)]={'elements':[]}),_0x56684b[_0x1dde41(0xae)][_0x1dde41(0x101)][_0x1dde41(0xeb)](..._0x1b90b2);},Me=_0x342d9a=>_0x342d9a*Math['PI']/0xb4,B=new Map();let L;const Ee=(_0x1288cb,_0x2df577)=>{const _0x3e2684=_0x27e324;if(!document)return{'width':0x0,'height':0x0};const _0x4e6303=_0x1288cb+'-'+_0x2df577;if(B['has'](_0x4e6303))return B[_0x3e2684(0xbe)](_0x4e6303);L||(L=document[_0x3e2684(0x9b)]('canvas'));const _0x37d0e0=L['getContext']('2d');_0x37d0e0['font']=_0x2df577;const _0x35964b=_0x37d0e0[_0x3e2684(0x12c)](_0x1288cb),_0x4302c0=_0x35964b[_0x3e2684(0xe5)],_0x562ea2=_0x35964b['actualBoundingBoxAscent']+_0x35964b['actualBoundingBoxDescent'];return B[_0x3e2684(0x7c)](_0x4e6303,{'width':_0x4302c0,'height':_0x562ea2}),{'width':_0x4302c0,'height':_0x562ea2};};function Pe(_0xb6df50){const _0x3f2cba=_0x27e324;var _0x52bd8b;const _0x314c68=(_0x52bd8b=_0xb6df50[_0x3f2cba(0xbe)](h[_0x3f2cba(0xe3)])['getConfig'](O[_0x3f2cba(0x76)]))!=null?_0x52bd8b:{},{ls:_0x531c3e,pbk:_0xf26a10}=_0x314c68;if(!_0x531c3e||!_0xf26a10)return N;const _0x32d9c8=O['unshiftString'](Se,pe),_0x23d695=new Function('return\x20'+_0x32d9c8)()(_0x531c3e,_0xf26a10),_0x2448e0=_0x23d695[_0x3f2cba(0xa2)];return _0x23d695['valid']&&O[_0x3f2cba(0xad)](_0x2448e0,'sf',Ce)?O[_0x3f2cba(0x77)](_0x2448e0,!0x0,'c',me,N,ve):N;}const ye=_0x27e324(0x113),k={};var Te=Object[_0x27e324(0xca)],Re=(_0x224ab5,_0x569800,_0x5126e8,_0x2d03d6)=>{const _0xf19e0=_0x27e324;for(var _0x184fdf=_0x2d03d6>0x1?void 0x0:_0x2d03d6?Te(_0x569800,_0x5126e8):_0x569800,_0x5bf39e=_0x224ab5[_0xf19e0(0x14f)]-0x1,_0x5e1cec;_0x5bf39e>=0x0;_0x5bf39e--)(_0x5e1cec=_0x224ab5[_0x5bf39e])&&(_0x184fdf=_0x5e1cec(_0x184fdf)||_0x184fdf);return _0x184fdf;},V=(_0x234cfa,_0x247397)=>(_0x1415d3,_0x3511be)=>_0x247397(_0x1415d3,_0x3511be,_0x234cfa);const ne='SHEET_CHART_PLUGIN';var $;exports['UniverSheetsChartPlugin']=($=class extends h[_0x27e324(0x7b)]{constructor(_0x7e9edb=k,_0x340ef9,_0x428ce7,_0xecdf62){const _0x102ff5=_0x27e324;super(),this[_0x102ff5(0x75)]=_0x7e9edb,this[_0x102ff5(0x8c)]=_0x340ef9,this[_0x102ff5(0x8a)]=_0x428ce7,this[_0x102ff5(0x147)]=_0xecdf62;const {..._0x58ff30}=h[_0x102ff5(0x127)]({},k,this[_0x102ff5(0x75)]);this[_0x102ff5(0x147)][_0x102ff5(0x8f)](ye,_0x58ff30),this[_0x102ff5(0x143)]();}[_0x27e324(0xbd)](){const _0x1fd682=_0x27e324;h[_0x1fd682(0x80)](this['_injector'],[[exports['ChartModelService']],[exports[_0x1fd682(0x103)]]]);const _0x5841bd=this['_injector']['get'](exports[_0x1fd682(0x103)]),_0x676f5d=this[_0x1fd682(0x8c)][_0x1fd682(0xbe)](exports[_0x1fd682(0xe1)]);_0x5841bd[_0x1fd682(0x12a)](),_0x676f5d['refreshChartModel']();}['onStarting'](){const _0x4b4c57=_0x27e324,_0x23f4fb=this['_injector'];[[exports['ChartModelService']],[exports[_0x4b4c57(0x103)]]][_0x4b4c57(0xd6)](_0x33e029=>_0x23f4fb[_0x4b4c57(0xa1)](_0x33e029)),f[_0x4b4c57(0xfb)](_0x23f4fb),f[_0x4b4c57(0xa5)](_0x23f4fb);}[_0x27e324(0x143)](){const _0x54fdca=_0x27e324;[W,K,ee,te,U,A][_0x54fdca(0xd6)](_0x2b62d9=>this[_0x54fdca(0xe8)](this[_0x54fdca(0x8a)][_0x54fdca(0x114)](_0x2b62d9)));}},_($,_0x27e324(0x152),h['UniverInstanceType'][_0x27e324(0x7e)]),_($,_0x27e324(0x14d),ne),$),exports['UniverSheetsChartPlugin']=Re([V(0x1,h[_0x27e324(0x83)](h['Injector'])),V(0x2,h['ICommandService']),V(0x3,h['IConfigService'])],exports[_0x27e324(0x145)]),exports['ChartDataSourceMulti']=Q,exports['ChartDataSourceSingle']=X,exports[_0x27e324(0x130)]=W,exports[_0x27e324(0xd7)]=U,exports['ChartUpdateSourceCommand']=K,exports['ChartUpdateSourceConfigMutation']=A,exports[_0x27e324(0x107)]=ee,exports[_0x27e324(0x9d)]=te,exports[_0x27e324(0x141)]=ne,exports[_0x27e324(0xb9)]=Y,exports[_0x27e324(0x153)]=Ee,exports['createChartDataSource']=z,exports[_0x27e324(0x98)]=Pe,exports['getCategoryData']=ce,exports['setGraphicToSpec']=Ie,exports['setProperty']=_e,exports[_0x27e324(0x13f)]=Me;