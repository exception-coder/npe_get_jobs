const _0x1eed87=_0x413a;function _0x413a(_0xf3c122,_0x326c7b){const _0x322fa4=_0x322f();return _0x413a=function(_0x413a4e,_0x44fac7){_0x413a4e=_0x413a4e-0x7f;let _0x138893=_0x322fa4[_0x413a4e];return _0x138893;},_0x413a(_0xf3c122,_0x326c7b);}(function(_0xc7a5ed,_0x294156){const _0x1809b1=_0x413a,_0x44c30f=_0xc7a5ed();while(!![]){try{const _0x33869e=parseInt(_0x1809b1(0x9d))/0x1*(-parseInt(_0x1809b1(0x111))/0x2)+parseInt(_0x1809b1(0xc3))/0x3*(parseInt(_0x1809b1(0x12c))/0x4)+parseInt(_0x1809b1(0x123))/0x5+parseInt(_0x1809b1(0x12d))/0x6+-parseInt(_0x1809b1(0x120))/0x7*(-parseInt(_0x1809b1(0xbb))/0x8)+parseInt(_0x1809b1(0x11d))/0x9*(parseInt(_0x1809b1(0xb3))/0xa)+-parseInt(_0x1809b1(0x107))/0xb;if(_0x33869e===_0x294156)break;else _0x44c30f['push'](_0x44c30f['shift']());}catch(_0x132b51){_0x44c30f['push'](_0x44c30f['shift']());}}}(_0x322f,0x98c07));var Se=Object['defineProperty'],me=(_0x883b4e,_0x35c959,_0x598697)=>_0x35c959 in _0x883b4e?Se(_0x883b4e,_0x35c959,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0x598697}):_0x883b4e[_0x35c959]=_0x598697,C=(_0x512ca8,_0x5056c6,_0x498870)=>me(_0x512ca8,typeof _0x5056c6!='symbol'?_0x5056c6+'':_0x5056c6,_0x498870);function _0x322f(){const _0x430287=['sheet.mutation.remove-chart','setOrient','refreshChartSource','_serializeChartForUnit','assignChartContext','getValue','parseNumber','range','getChartDataSource','_chartModelIdMap','get','sheet.mutation.chart-update-config','_resourcesManagerService','relationData','_refRangeService','delete','ensureChartModelCollection','context$','_canSwitchOrient$','_initSnapshot','convertDataSet','getUniverSheetInstance','sheet.command.chart-update-config','serialize','getUnitChartModels','dataStream','message','chartType','context','setConfig','watchRange','number','rangeInfo','sankeyData','_chartModelAdded$','_injector','MUTATION','_deserializeChartForUnit','getRangeInfo','sheet.command.chart-update-source','contains','measureText','dispose','pipe','all','STRING','minValue','actualBoundingBoxDescent','params','_init','SHEET_CHART_PLUGIN','width','onRendered','_configService','_activeChartModel$','parseInt','_hasLoaded','11717552twGqMd','actualBoundingBoxAscent','activeChartModel$','_dataSourceMap','_chartType$','getChartModel','createElement','bubble','object','_commandService','2dQuFMr','updateRangeInfo','clear','_updateChartRangeAndContext','subscribe','startRow','headers','onDispose','toArray','activeChartModel','isArray','getStartEndScope','9WMyyop','valid','_rangeInfo$','4703881YgQaWI','createChartModel','setLoaded','334010HgKTDI','rangeInfo$','getActiveChartModel','set','registerCommand','applyStyle','removeChartModel','BOOLEAN','complete','42556gtpvur','1866696crYnae','setChartType','chartModelRemoved$','type','_config$','refresh','dataAggregation$','COMMAND','forEach','getStyles','getConfig','graphic','_style$','values','startColumn','dataAggregation','FORCE_STRING','isRowDirection','_context$','series','Column','transformRange','_configSubscription','asObservable','pushUndoRedo','intersects','_models','UNIVER_SHEET','isDate','setRangeInfo','TRUE','_chartModelService','FALSE','855588SWfSjE','length','Null','_converters','setChartDataSource','getOwnPropertyDescriptor','_initCommands','_dataSource','getSheetBySheetId','NUMBER','maxValue','assignDataAggregation','setActiveChartModel','font','_univerInstanceService','parseDate','getChartSuggestion','source','pluginName','syncExecuteCommand','_chartModelRemoved$','push','6773870LoTzGV','onStarting','_config','split','keys','next','disposeWithMe','dataSource','8oCXves','sheet.mutation.insert-chart','from','style','canSwitchOrient$','return\x20','sheet.mutation.chart-update-source','category','231ZRCuCQ','Date','heatmapData','getCell','setValue','add','Line','pop','canSwitchOrient','body','_data$'];_0x322f=function(){return _0x430287;};return _0x322f();}import{ChartSourceDataTypeEnum as _0x511523,ChartDataSource as _0x6f0cd5,ChartModel as _0x3fc124,CHART_DEBOUNCE_TIME as _0x5d6a08,buildChartData as _0x937b6f,findHeaderOperator as _0x25199f,findCategoryOperator as _0x25d9e5,findSeriesOperator as _0x449f79,pieSeriesFilterOperator as _0xc7155a,ChartTypeBits as _0x483455,DataOrientation as _0x480947,registerChartThemeService as _0x48c335,registerWordCloudChartMakImageService as _0x59943d}from'@univerjs-pro/engine-chart';import{CellValueType as _0xd80309,numfmt as _0x2e012c,DEFAULT_NUMBER_FORMAT as _0xeecfb0,ObjectMatrix as _0x2b8451,Range as _0x11b2b8,LocaleService as _0x4bed23,Inject as _0x2688e4,Injector as _0x437fbd,Disposable as _0x15ff04,IResourceManagerService as _0x2c5ef3,IUniverInstanceService as _0x3d67c8,ICommandService as _0xbb386e,generateRandomId as _0x4822dd,Rectangle as _0xe65685,UniverInstanceType as _0x488a0e,CommandType as _0x305658,IUndoRedoService as _0x5d3de9,IConfigService as _0x9aabd,Plugin as _0x2b26cd,merge as _0x34627a,touchDependencies as _0x584769}from'@univerjs/core';import{BehaviorSubject as _0x14caa1,filter as _0x1dd926,combineLatest as _0x40adea,debounceTime as _0x17ae04,map as _0x143382,distinctUntilChanged as _0x40a944,Subject as _0x165e58}from'rxjs';import{RefRangeService as _0x54fe6f,SetRangeValuesMutation as _0x2e47c8,ReorderRangeMutation as _0x4acf8d,RemoveColMutation as _0xe5ee49,RemoveRowMutation as _0x1de1f4}from'@univerjs/sheets';import{LS_CONFIG_KEY as _0x3aaef3,unshiftString as _0x38ca72,isFeatureAuthorizedWithinTime as _0x114aa6,getSheetFeatureLimit as _0x330520}from'@univerjs-pro/license';const ne=_0x1eed87(0x9a),re=_0x1eed87(0x9c),He=_0x45c6f3=>{const _0x5ce50e=_0x1eed87;var _0x47ad29;return((_0x47ad29=_0x45c6f3[_0x5ce50e(0xcc)])==null?void 0x0:_0x47ad29[_0x5ce50e(0xe7)]['replace'](/\r\n$/,''))||'';};function L(_0x56f664,_0x2331b6,_0x2afccb){const _0x2a4d10=_0x1eed87;var _0x5b2ed6,_0x21880a,_0x158ef6;if(_0x56f664){const {v:_0x5e0a14,t:_0x24d51b,p:_0x5edaa7,s:_0x2490bd}=_0x56f664;if(_0x5edaa7)return{'v':null,'t':_0x511523['Null']};if(_0x24d51b===_0xd80309[_0x2a4d10(0xa6)]){const _0xc8e257=_0x2331b6[_0x2a4d10(0xd8)](_0x2490bd);if(_0xc8e257&&_0xc8e257['n']){const {pattern:_0x2368c3}=_0xc8e257['n'];_0x2368c3&&!_0x2afccb[_0x2368c3]&&(_0x2afccb[_0x2368c3]=_0x2e012c['getFormatInfo'](_0x2368c3));const _0x20f23a=_0x2afccb[_0x2368c3];if(_0x20f23a&&_0x20f23a[_0x2a4d10(0x98)])return typeof _0x5e0a14==_0x2a4d10(0xed)?{'v':Number(_0x5e0a14),'t':_0x511523[_0x2a4d10(0xc4)]}:{'v':(_0x5b2ed6=_0x2e012c[_0x2a4d10(0xac)](_0x5e0a14))==null?void 0x0:_0x5b2ed6['v'],'t':_0x511523[_0x2a4d10(0xc4)]};if(_0x5e0a14==null)return{'v':null,'t':_0x511523[_0x2a4d10(0x9f)]};if(_0x2368c3!==_0xeecfb0&&_0x20f23a)return{'v':(_0x158ef6=(_0x21880a=_0x2e012c[_0x2a4d10(0xd4)](_0x5e0a14))==null?void 0x0:_0x21880a['v'])!=null?_0x158ef6:Number(_0x5e0a14),'t':_0x511523[_0x2a4d10(0xa6)]};}return{'v':Number(_0x5e0a14),'t':_0x511523[_0x2a4d10(0xa6)]};}else{if(_0x24d51b===_0xd80309['FORCE_STRING'])return{'v':String(_0x5e0a14),'t':_0x511523['STRING']};{const _0x4f386f=Number(_0x5e0a14);return _0x4f386f===_0x5e0a14?{'v':_0x4f386f,'t':_0x511523[_0x2a4d10(0xa6)]}:_0x5e0a14==null?{'v':null,'t':_0x511523[_0x2a4d10(0x9f)]}:{'v':String(_0x5e0a14),'t':_0x511523['STRING']};}}}return{'v':null,'t':_0x511523[_0x2a4d10(0x9f)]};}function ke(_0x1ded72,_0x1e4bae,_0x297dd4,_0x33e99c,_0x3abe00,_0x4415ab){const _0x4179ac=_0x1eed87,{startRow:_0x5440a9,startColumn:_0x5007d6,endColumn:_0x165468,endRow:_0x3562ae}=_0x1ded72,_0x33b189={};if(_0x5440a9===_0x3562ae)for(let _0x2d8e1f=_0x5007d6;_0x2d8e1f<=_0x165468;_0x2d8e1f++){const _0x47dc79=_0x1e4bae['getCell'](_0x5440a9,_0x2d8e1f),{v:_0x16a589,t:_0x287b8d}=L(_0x47dc79,_0x4415ab,_0x33b189);_0x33e99c['setValue'](_0x2d8e1f,_0x297dd4,_0x16a589),_0x3abe00[_0x4179ac(0xc7)](_0x2d8e1f,_0x297dd4,_0x287b8d);}if(_0x5007d6===_0x165468)for(let _0x5ea0ad=_0x5440a9;_0x5ea0ad<=_0x3562ae;_0x5ea0ad++){const _0x178585=_0x1e4bae[_0x4179ac(0xc6)](_0x5ea0ad,_0x5007d6),{v:_0x1c7055,t:_0x3f828a}=L(_0x178585,_0x4415ab,_0x33b189);_0x33e99c[_0x4179ac(0xc7)](_0x297dd4,_0x5ea0ad,_0x1c7055),_0x3abe00[_0x4179ac(0xc7)](_0x297dd4,_0x5ea0ad,_0x3f828a);}}function A(_0x6352d,_0x14bb06,_0x423c97){const _0x39bb70=_0x1eed87;if(_0x6352d){const {v:_0x5c551c,t:_0xb901a1,p:_0x3c2106,s:_0x217ad5}=_0x6352d;if(_0x3c2106)return{'v':He(_0x3c2106),'t':_0x511523[_0x39bb70(0xfb)]};if((_0xb901a1===_0xd80309[_0x39bb70(0x8c)]||_0xb901a1===_0xd80309[_0x39bb70(0xfb)])&&_0x5c551c!==void 0x0&&_0x5c551c!==null)return{'v':String(_0x5c551c),'t':_0x511523[_0x39bb70(0xfb)]};if(_0xb901a1===_0xd80309[_0x39bb70(0x12a)])return{'v':_0x5c551c?ne:re,'t':_0x511523[_0x39bb70(0x12a)]};if(_0xb901a1===_0xd80309[_0x39bb70(0xa6)]){const _0x594386=_0x14bb06[_0x39bb70(0xd8)](_0x217ad5);if(_0x594386&&_0x594386['n']){const {pattern:_0x447271}=_0x594386['n'];if(_0x447271&&!_0x423c97[_0x447271]&&(_0x423c97[_0x447271]=_0x2e012c['getFormatInfo'](_0x447271)),_0x423c97[_0x447271]&&(_0x423c97[_0x447271]=_0x2e012c['getFormatInfo'](_0x447271),_0x423c97[_0x447271][_0x39bb70(0x98)]))return{'v':String(_0x5c551c),'t':_0x511523[_0x39bb70(0xc4)]};}return{'v':String(_0x5c551c),'t':_0x511523['NUMBER']};}else return typeof _0x5c551c==='boolean'?{'v':_0x5c551c?ne:re,'t':_0x511523['BOOLEAN']}:{'v':_0x5c551c==null?'':String(_0x5c551c),'t':_0x511523['STRING']};}return{'v':'','t':_0x511523[_0x39bb70(0xfb)]};}class Xe extends _0x6f0cd5{constructor(_0x2b0fe9,_0x41ad5f){const _0x59303c=_0x1eed87;super(),C(this,_0x59303c(0x11f)),C(this,_0x59303c(0x124)),this[_0x59303c(0xab)]=_0x2b0fe9;const _0x53e150=_0x41ad5f[_0x59303c(0x8d)]!==void 0x0?_0x41ad5f['isRowDirection']:!0x0;this['_rangeInfo$']=new _0x14caa1({..._0x41ad5f,'isRowDirection':_0x53e150}),this['_data$']=new _0x14caa1({'dimensions':[],'source':[]}),this[_0x59303c(0xbf)]=this['_canSwitchOrient$'][_0x59303c(0x93)](),this['data$']=this[_0x59303c(0xcd)][_0x59303c(0x93)](),this[_0x59303c(0x124)]=this['_rangeInfo$'][_0x59303c(0x93)](),this[_0x59303c(0xff)]();}[_0x1eed87(0xf4)](){const _0x55b374=_0x1eed87;return this[_0x55b374(0x11f)][_0x55b374(0xd3)]();}[_0x1eed87(0x99)](_0x2545ee){const _0x2d9c18=_0x1eed87;this[_0x2d9c18(0x11f)][_0x2d9c18(0xb8)](_0x2545ee),this[_0x2d9c18(0xcd)][_0x2d9c18(0xb8)](this['convertDataSet']()),this[_0x2d9c18(0xe0)][_0x2d9c18(0xb8)](this[_0x2d9c18(0xcb)]());}[_0x1eed87(0xcf)](_0x593af3){const _0x457ace=_0x1eed87;this[_0x457ace(0xe0)][_0x457ace(0xb8)](_0x593af3);}[_0x1eed87(0xcb)](){return!0x0;}[_0x1eed87(0x112)](){}[_0x1eed87(0xec)](){}[_0x1eed87(0xe2)](){const _0xcd4355=_0x1eed87,{rangeInfo:_0x40b575,isRowDirection:_0x50efc7}=this['getRangeInfo'](),_0x118900=this[_0xcd4355(0xab)],{unitId:_0x311eee,subUnitId:_0x2a9073,range:_0x18b251}=_0x40b575,_0x3a4d3b=_0x118900[_0xcd4355(0xe3)](_0x311eee);if(!_0x3a4d3b)return{'dimensions':[],'source':[],'dimensionsType':[],'sourceType':[]};const _0x285b47=_0x3a4d3b[_0xcd4355(0xa5)](_0x2a9073);if(!_0x285b47)return{'dimensions':[],'source':[],'dimensionsType':[],'sourceType':[]};const _0x22803d=[],_0x3949f2=[],_0x15264e=[],_0xa8bc0c=[],_0x225cb3=_0x3a4d3b[_0xcd4355(0x85)](),_0x2e9724={};if(_0x18b251[_0xcd4355(0x8a)]===-0x1||_0x18b251[_0xcd4355(0x116)]===-0x1)return{'dimensions':[],'source':[],'dimensionsType':[],'sourceType':[]};const _0x5e83a3=_0x11b2b8[_0xcd4355(0x91)](_0x18b251,_0x285b47),{startColumn:_0x348bdf,startRow:_0x1e78be,endColumn:_0x39b933,endRow:_0x4c9d1f}=_0x5e83a3;if(_0x50efc7){for(let _0x28d24d=_0x348bdf;_0x28d24d<=_0x39b933;_0x28d24d++){const _0x4250a6=_0x285b47['getCell'](_0x1e78be,_0x28d24d),{v:_0x516118,t:_0x5318a1}=A(_0x4250a6,_0x225cb3,_0x2e9724);_0x22803d[_0xcd4355(0xb2)](_0x516118),_0x3949f2['push'](_0x5318a1);}for(let _0x2e0f62=_0x1e78be+0x1;_0x2e0f62<=_0x4c9d1f;_0x2e0f62++){const _0x5b5bb3=[],_0x59d159=[];for(let _0x263dfb=_0x348bdf;_0x263dfb<=_0x39b933;_0x263dfb++){const _0x14edf2=_0x285b47['getCell'](_0x2e0f62,_0x263dfb),{v:_0x202efb,t:_0x15f4d3}=_0x263dfb===_0x348bdf?A(_0x14edf2,_0x225cb3,_0x2e9724):L(_0x14edf2,_0x225cb3,_0x2e9724);_0x5b5bb3[_0xcd4355(0xb2)](_0x202efb),_0x59d159[_0xcd4355(0xb2)](_0x15f4d3);}_0x15264e[_0xcd4355(0xb2)](_0x5b5bb3),_0xa8bc0c[_0xcd4355(0xb2)](_0x59d159);}}else{for(let _0x280e3c=_0x1e78be;_0x280e3c<=_0x4c9d1f;_0x280e3c++){const _0x215d18=_0x285b47[_0xcd4355(0xc6)](_0x280e3c,_0x348bdf),{v:_0x1a6b32,t:_0x17e4de}=A(_0x215d18,_0x225cb3,_0x2e9724);_0x22803d['push'](_0x1a6b32),_0x3949f2[_0xcd4355(0xb2)](_0x17e4de);}for(let _0x5931de=_0x348bdf+0x1;_0x5931de<=_0x39b933;_0x5931de++){const _0x1e7f69=[];for(let _0x399916=_0x1e78be;_0x399916<=_0x4c9d1f;_0x399916++){const _0x2cfe4d=_0x285b47[_0xcd4355(0xc6)](_0x399916,_0x5931de),{v:_0x32a8ed,t:_0x1635cd}=_0x399916===_0x1e78be?A(_0x2cfe4d,_0x225cb3,_0x2e9724):L(_0x2cfe4d,_0x225cb3,_0x2e9724);_0x1e7f69[_0xcd4355(0xb2)](_0x32a8ed);}_0x15264e[_0xcd4355(0xb2)](_0x1e7f69);}}return{'dimensions':_0x22803d,'source':_0x15264e,'dimensionsType':_0x3949f2,'sourceType':_0xa8bc0c};}}class fe extends _0x6f0cd5{constructor(_0x5eaa67,_0x4d45a6){const _0x549119=_0x1eed87;super(),C(this,_0x549119(0x11f)),C(this,_0x549119(0x124)),(this['_univerInstanceService']=_0x5eaa67,this[_0x549119(0x11f)]=new _0x14caa1(_0x4d45a6));}[_0x1eed87(0xcb)](){return!0x1;}['getRangeInfo'](){return this['_rangeInfo$']['getValue']();}[_0x1eed87(0xcf)](_0x361535){const _0x3bebe9=_0x1eed87;this[_0x3bebe9(0xe0)][_0x3bebe9(0xb8)](_0x361535);}['setRangeInfo'](_0x1fc816){const _0x4d452b=_0x1eed87;this['_rangeInfo$'][_0x4d452b(0xb8)](_0x1fc816);}['updateRangeInfo'](){}[_0x1eed87(0xec)](){}[_0x1eed87(0xe2)](){const _0x54a671=_0x1eed87,_0x3694ad=this[_0x54a671(0xf4)](),_0x57527a=this[_0x54a671(0xab)],_0x219d60=[],_0x221952=[],_0x2f165a={};for(const [_0x2d0416]of _0x3694ad){const {unitId:_0x2556d2,subUnitId:_0xedab1e,range:_0x50b335}=_0x2d0416,_0xfa923b=_0x57527a['getUniverSheetInstance'](_0x2556d2);if(!_0xfa923b)return{'dimensions':[],'source':[]};const _0x205e43=_0xfa923b['getSheetBySheetId'](_0xedab1e);if(!_0x205e43)return{'dimensions':[],'source':[]};const _0x2ed293=_0xfa923b[_0x54a671(0x85)](),{v:_0x6a8229,t:_0x63a3bf}=A(_0x205e43[_0x54a671(0xc6)](_0x50b335[_0x54a671(0x116)],_0x50b335['startColumn']),_0x2ed293,_0x2f165a);_0x219d60[_0x54a671(0xb2)](_0x6a8229),_0x221952['push'](_0x63a3bf);}let _0x239cfd=0x0;const _0x53bb1c=new _0x2b8451(),_0x5c565f=new _0x2b8451();for(const [,_0x11f98d]of _0x3694ad){const {unitId:_0x594a72,subUnitId:_0x3a4960,range:_0x536379}=_0x11f98d,_0x1df33b=_0x57527a['getUniverSheetInstance'](_0x594a72);if(!_0x1df33b)return{'dimensions':[],'source':[],'dimensionsType':[],'sourceType':[]};const _0x498358=_0x1df33b[_0x54a671(0xa5)](_0x3a4960);if(!_0x498358)return{'dimensions':[],'source':[],'dimensionsType':[],'sourceType':[]};ke(_0x536379,_0x498358,_0x239cfd,_0x53bb1c,_0x5c565f,_0x1df33b[_0x54a671(0x85)]()),_0x239cfd++;}const _0x1e59d4=_0x53bb1c[_0x54a671(0x119)](),_0x3d2f8e=_0x5c565f[_0x54a671(0x119)]();return{'dimensions':_0x219d60,'source':_0x1e59d4,'dimensionsType':_0x221952,'sourceType':_0x3d2f8e};}}function ze(_0x132e90,_0x2b1279){const _0x177633=_0x1eed87;return Array[_0x177633(0x11b)](_0x2b1279)?new fe(_0x132e90,_0x2b1279):new Xe(_0x132e90,_0x2b1279);}function Mt(_0x1688f3,_0x3fabc1,_0x5631be){const _0x1f02fa=_0x1eed87,_0x43176e=[];for(let _0x581fe8=0x0;_0x581fe8<_0x1688f3[_0x1f02fa(0x9e)];_0x581fe8++)_0x43176e['push'](_0x1688f3[_0x581fe8][_0x3fabc1]);return _0x43176e;}class Ye extends _0x3fc124{get[_0x1eed87(0xba)](){const _0x4d5194=_0x1eed87;return this[_0x4d5194(0xa4)];}constructor(_0x3e01c0,_0x4c072e,_0x353f12){const _0x5aff8b=_0x1eed87;super(_0x3e01c0,_0x4c072e,_0x353f12),this[_0x5aff8b(0xff)]();}['_init'](){const _0xa1c2db=_0x1eed87;var _0x1eb752;const _0x5b12db=this['getInjector']()[_0xa1c2db(0xd8)](_0x4bed23);(_0x1eb752=this['_configSubscription'])==null||_0x1eb752['unsubscribe']();const {data$:_0x14e4bd,rangeInfo$:_0x47cd59}=this[_0xa1c2db(0xa4)],_0x134f48=_0x14e4bd['pipe'](_0x1dd926(_0x7cf91b=>{const {dimensions:_0x3cb2fb,source:_0x2215f3}=_0x7cf91b;return!(!_0x3cb2fb||!_0x2215f3);})),_0xd91579=_0x40adea([_0x134f48,this[_0xa1c2db(0xdf)],this[_0xa1c2db(0x82)]])[_0xa1c2db(0xf9)](_0x17ae04(_0x5d6a08),_0x143382(([_0x46f5cc,_0x130b6b,_0x2efe22])=>[_0x46f5cc,_0x130b6b,_0x2efe22]));this['_configSubscription']=_0x40adea([this['chartType$'][_0xa1c2db(0xf9)](_0x40a944()),_0xd91579,_0x47cd59])[_0xa1c2db(0xf9)](_0x1dd926(([_0x2e597a])=>!!_0x2e597a),_0x17ae04(_0x5d6a08))[_0xa1c2db(0x115)](([_0x103343,[_0xc9be1,_0xb74775],_0x342930])=>{const _0x42b19e=_0xa1c2db;if(_0xc9be1['dimensions'][_0x42b19e(0x9e)]<=0x0||_0xc9be1[_0x42b19e(0xae)][_0x42b19e(0x9e)]<=0x0){this['_config$']['next']({'type':this[_0x42b19e(0xe9)],'category':void 0x0,'maxValue':-0x1/0x0,'minValue':0x1/0x0,'series':[]});return;}const _0x500376=Array[_0x42b19e(0x11b)](_0x342930)?!0x1:!!_0x342930[_0x42b19e(0x8d)],_0x2244b0=_0x937b6f(_0xc9be1,_0xb74775,_0x103343,_0x500376,_0x5b12db);this['_config$'][_0x42b19e(0xb8)]({'type':_0x103343,'headers':_0xb74775[_0x42b19e(0x117)],'category':_0x2244b0[_0x42b19e(0xc2)],'series':_0x2244b0[_0x42b19e(0x8f)],'maxValue':_0x2244b0[_0x42b19e(0xa7)],'minValue':_0x2244b0[_0x42b19e(0xfc)],'bubble':_0x2244b0[_0x42b19e(0x10e)],'relationData':_0x2244b0[_0x42b19e(0xdb)],'sankeyData':_0x2244b0[_0x42b19e(0xef)],'heatmapData':_0x2244b0[_0x42b19e(0xc5)]});}),this['disposeWithMe'](this[_0xa1c2db(0x92)]);}['dispose'](){const _0xc0cc73=_0x1eed87;super[_0xc0cc73(0xf8)](),this[_0xc0cc73(0x10b)][_0xc0cc73(0x12b)](),this[_0xc0cc73(0x8e)][_0xc0cc73(0x12b)](),this[_0xc0cc73(0x80)]['complete'](),this[_0xc0cc73(0x88)][_0xc0cc73(0x12b)]();}}var We=Object[_0x1eed87(0xa2)],Je=(_0x3e6b43,_0x5e1209,_0x32e718,_0x3d8b4a)=>{const _0x443155=_0x1eed87;for(var _0x18315d=_0x3d8b4a>0x1?void 0x0:_0x3d8b4a?We(_0x5e1209,_0x32e718):_0x5e1209,_0x548469=_0x3e6b43[_0x443155(0x9e)]-0x1,_0x251666;_0x548469>=0x0;_0x548469--)(_0x251666=_0x3e6b43[_0x548469])&&(_0x18315d=_0x251666(_0x18315d)||_0x18315d);return _0x18315d;},Ke=(_0x329196,_0xcfb7c1)=>(_0x1a0348,_0x6cd9c7)=>_0xcfb7c1(_0x1a0348,_0x6cd9c7,_0x329196);let y=class extends _0x15ff04{constructor(_0x7719fa){const _0x4b951c=_0x1eed87;super(),C(this,_0x4b951c(0x104),new _0x14caa1(null)),C(this,_0x4b951c(0x109),this['_activeChartModel$']['asObservable']()),C(this,_0x4b951c(0x96),new Map()),C(this,_0x4b951c(0xa0),new Set()),C(this,_0x4b951c(0xf0),new _0x165e58()),C(this,'chartModelAdded$',this['_chartModelAdded$']['asObservable']()),C(this,_0x4b951c(0xb1),new _0x165e58()),C(this,_0x4b951c(0x12f),this[_0x4b951c(0xb1)][_0x4b951c(0x93)]()),this['_injector']=_0x7719fa;}get[_0x1eed87(0x11a)](){const _0x227a1d=_0x1eed87;return this[_0x227a1d(0x104)][_0x227a1d(0xd3)]();}[_0x1eed87(0xa9)](_0x1b8c09){const _0x692cc6=_0x1eed87;this[_0x692cc6(0x104)]['next'](_0x1b8c09);}[_0x1eed87(0x125)](){const _0x5e5514=_0x1eed87;return this['_activeChartModel$'][_0x5e5514(0xd3)]();}[_0x1eed87(0x10c)](_0x69940f){const _0x5491ea=_0x1eed87;return this['_models'][_0x5491ea(0xd8)](_0x69940f);}['refreshChartModel'](){const _0x19deef=_0x1eed87,_0x181051=Array[_0x19deef(0xbd)](this['_models'][_0x19deef(0xb7)]());for(const _0x20f32d of _0x181051){const _0x1ad3d8=this[_0x19deef(0x96)][_0x19deef(0xd8)](_0x20f32d);_0x1ad3d8&&_0x1ad3d8[_0x19deef(0xba)][_0x19deef(0x81)]();}}[_0x1eed87(0x121)](_0x3fcd6a,_0x53e418,_0x23bf79=!0x1){const _0x5d5ea8=_0x1eed87,_0x1b39f5=new Ye(_0x3fcd6a,_0x53e418,this[_0x5d5ea8(0xf1)]);this['_models'][_0x5d5ea8(0x126)](_0x1b39f5['id'],_0x1b39f5);const _0x40fdf8=this['generateChartModelContext'](_0x1b39f5['id']);return _0x40fdf8&&_0x1b39f5[_0x5d5ea8(0xd2)](_0x40fdf8),_0x23bf79&&_0x1b39f5[_0x5d5ea8(0x128)]({'titles':{'title':{'content':''}}}),this['_chartModelAdded$'][_0x5d5ea8(0xb8)](_0x1b39f5),_0x1b39f5;}[_0x1eed87(0x129)](_0x5331c0){const _0x3bef84=_0x1eed87,{_models:_0x272a58}=this,_0x2f0a3f=_0x272a58['get'](_0x5331c0);_0x2f0a3f&&(this[_0x3bef84(0xb1)][_0x3bef84(0xb8)](_0x2f0a3f['id']),_0x2f0a3f[_0x3bef84(0xf8)](),_0x272a58[_0x3bef84(0xdd)](_0x5331c0));}['generateChartModelContext'](_0x328d06){const _0x24dcb0=_0x1eed87,_0x1e938f=[_0x25199f,_0x25d9e5,_0x449f79,_0xc7155a],_0x5b7df7=this[_0x24dcb0(0x96)][_0x24dcb0(0xd8)](_0x328d06),_0x2e6f05=(_0x5b7df7==null?void 0x0:_0x5b7df7['context'])||{},_0x826972=_0x5b7df7==null?void 0x0:_0x5b7df7[_0x24dcb0(0xba)];return _0x5b7df7&&_0x826972?_0x1e938f['reduce']((_0x307309,_0x3d12dc)=>{const _0x524c54=_0x3d12dc(_0x826972,_0x307309,_0x5b7df7);return{..._0x307309,..._0x524c54};},_0x2e6f05):null;}[_0x1eed87(0xf8)](){const _0x506a41=_0x1eed87;super[_0x506a41(0xf8)](),this[_0x506a41(0x96)][_0x506a41(0x84)](_0x7202b6=>_0x7202b6['dispose']()),this['_models']['clear'](),this[_0x506a41(0xa0)]['clear'](),this[_0x506a41(0x104)][_0x506a41(0x12b)](),this[_0x506a41(0xf0)][_0x506a41(0x12b)](),this[_0x506a41(0xb1)][_0x506a41(0x12b)]();}};y=Je([Ke(0x0,_0x2688e4(_0x437fbd))],y);var et=Object[_0x1eed87(0xa2)],tt=(_0x1b53de,_0x54a287,_0x3250fc,_0x20fe62)=>{for(var _0x5cd3d7=_0x20fe62>0x1?void 0x0:_0x20fe62?et(_0x54a287,_0x3250fc):_0x54a287,_0x59c039=_0x1b53de['length']-0x1,_0x414197;_0x59c039>=0x0;_0x59c039--)(_0x414197=_0x1b53de[_0x59c039])&&(_0x5cd3d7=_0x414197(_0x5cd3d7)||_0x5cd3d7);return _0x5cd3d7;},D=(_0x392f2e,_0x51faa7)=>(_0x5f3919,_0x2ed4bb)=>_0x51faa7(_0x5f3919,_0x2ed4bb,_0x392f2e);const nt=_0x1eed87(0x100);let E=class extends _0x15ff04{constructor(_0x182374,_0x324bd3,_0x1023cc,_0x20980f,_0x360f2f){const _0x1a5dc4=_0x1eed87;super(),C(this,_0x1a5dc4(0xd7),new Map()),C(this,_0x1a5dc4(0x10a),new Map()),C(this,_0x1a5dc4(0x106),!0x1),(this[_0x1a5dc4(0xda)]=_0x182374,this[_0x1a5dc4(0xdc)]=_0x324bd3,this['_univerInstanceService']=_0x1023cc,this['_chartModelService']=_0x20980f,this['_commandService']=_0x360f2f,this[_0x1a5dc4(0xe1)]());}[_0x1eed87(0x122)](){this['_hasLoaded']=!0x0;}[_0x1eed87(0xe6)](_0x472538,_0x2489e4){const _0x28041b=_0x1eed87,_0x19085a=this[_0x28041b(0xd7)][_0x28041b(0xd8)](_0x472538);if(!_0x19085a)return[];const _0x299c7d=_0x19085a['get'](_0x2489e4);if(!_0x299c7d)return[];const {_chartModelService:_0x5d8aca}=this;return Array[_0x28041b(0xbd)](_0x299c7d)['map'](_0x406730=>_0x5d8aca[_0x28041b(0x10c)](_0x406730));}[_0x1eed87(0xad)](_0x4ab483){const _0x32a694=_0x1eed87;if(Array[_0x32a694(0x11b)](_0x4ab483))return{'orient':_0x480947['Column'],'chartType':_0x483455[_0x32a694(0xc9)]};{const {rangeInfo:_0x27bec8}=_0x4ab483,{range:_0x22768a}=_0x27bec8,{startRow:_0xfa08da,endRow:_0x56347a,startColumn:_0x1c0ca2,endColumn:_0x44ecd6}=_0x22768a,_0x29880e=_0x56347a-_0xfa08da>=_0x44ecd6-_0x1c0ca2;return{'orient':_0x29880e?_0x480947[_0x32a694(0x90)]:_0x480947['Row'],'chartType':_0x29880e?_0x483455['Line']:_0x483455[_0x32a694(0x90)]};}}[_0x1eed87(0xde)](_0x2bc7bd,_0x1e7a98){const _0x537cbf=_0x1eed87;let _0x1a111b=this['_chartModelIdMap']['get'](_0x2bc7bd);_0x1a111b||(_0x1a111b=new Map(),this[_0x537cbf(0xd7)][_0x537cbf(0x126)](_0x2bc7bd,_0x1a111b));let _0x4cddfa=_0x1a111b[_0x537cbf(0xd8)](_0x1e7a98);return _0x4cddfa||(_0x4cddfa=new Set(),_0x1a111b[_0x537cbf(0x126)](_0x1e7a98,_0x4cddfa)),_0x4cddfa;}[_0x1eed87(0xd6)](_0x1f92b4){const _0x44cb3a=_0x1eed87;return this['_dataSourceMap'][_0x44cb3a(0xd8)](_0x1f92b4);}[_0x1eed87(0xa1)](_0x2e25ce,_0xe08778){const _0x5c485c=_0x1eed87;this[_0x5c485c(0x10a)][_0x5c485c(0x126)](_0x2e25ce,_0xe08778);}[_0x1eed87(0xd0)](){const _0xcc1b9=_0x1eed87;this[_0xcc1b9(0x9b)]['refreshChartModel']();}[_0x1eed87(0x121)](_0xd2c4af,_0x444d65,_0x49dd2e,_0x40382e=!0x1){const _0x224dc0=_0x1eed87;var _0x36c4b2;const {orient:_0x1cc4ef,context:_0x43edb9,dataAggregation:_0x14c3af,id:_0xeb1c5e,style:_0x11b34c,rangeInfo:_0x2180dd}=_0x49dd2e,_0x5eddcc=ze(this[_0x224dc0(0xab)],_0x2180dd),_0x3184d7=_0xeb1c5e!=null?_0xeb1c5e:_0x4822dd(),_0x946b15=this[_0x224dc0(0xad)](_0x2180dd),_0x5be554=(_0x36c4b2=_0x49dd2e['chartType'])!=null?_0x36c4b2:_0x946b15[_0x224dc0(0xe9)],_0x15a881=this[_0x224dc0(0x9b)][_0x224dc0(0x121)](_0x3184d7,{'dataSource':_0x5eddcc,'chartType':_0x5be554!=null?_0x5be554:_0x946b15[_0x224dc0(0xe9)],'dataAggregation':_0x14c3af,'style':_0x11b34c,'context':_0x43edb9},_0x40382e);let _0x599070=null;const _0xc0784e=_0x15a881[_0x224dc0(0xba)][_0x224dc0(0x124)][_0x224dc0(0xf9)](_0x17ae04(_0x5d6a08))[_0x224dc0(0x115)](()=>{const _0x275755=_0x224dc0;_0x599070==null||_0x599070[_0x275755(0xf8)](),_0x599070=this['watchRange'](_0x15a881);}),_0x4d33d6=this[_0x224dc0(0xde)](_0xd2c4af,_0x444d65);return _0x4d33d6[_0x224dc0(0xc8)](_0x15a881['id']),_0x15a881[_0x224dc0(0x118)](()=>{const _0x2b1b98=_0x224dc0;_0x4d33d6[_0x2b1b98(0xdd)](_0x15a881['id']),_0x599070==null||_0x599070[_0x2b1b98(0xf8)](),_0xc0784e['unsubscribe'](),_0x5eddcc[_0x2b1b98(0xf8)](),this[_0x2b1b98(0x10a)][_0x2b1b98(0xdd)](_0x15a881['id']);}),this[_0x224dc0(0x10a)][_0x224dc0(0x126)](_0x15a881['id'],_0x5eddcc),_0x15a881;}[_0x1eed87(0x129)](_0x5e9ed0){const _0x57e6de=_0x1eed87,_0x43cb64=this[_0x57e6de(0x9b)]['getChartModel'](_0x5e9ed0);_0x43cb64&&(_0x43cb64[_0x57e6de(0xf8)](),this[_0x57e6de(0x9b)][_0x57e6de(0x129)](_0x5e9ed0));}[_0x1eed87(0x10c)](_0x45e5ac){const _0x59ce33=_0x1eed87;return this[_0x59ce33(0x9b)][_0x59ce33(0x10c)](_0x45e5ac);}[_0x1eed87(0xd1)](_0x5bab49){const _0x3e3412=_0x1eed87,_0x306d5e=this[_0x3e3412(0xd7)][_0x3e3412(0xd8)](_0x5bab49);if(!_0x306d5e)return'{}';const _0x35a121={};for(const _0x24dfbb of _0x306d5e['keys']()){const _0x35b34c=_0x306d5e[_0x3e3412(0xd8)](_0x24dfbb);if(_0x35b34c)for(const _0x388db2 of Array[_0x3e3412(0xbd)](_0x35b34c)){const _0x1b7ab5=this[_0x3e3412(0x9b)][_0x3e3412(0x10c)](_0x388db2),_0x4f5642=this[_0x3e3412(0xd6)](_0x388db2);_0x1b7ab5&&_0x4f5642&&(_0x35a121[_0x24dfbb]||(_0x35a121[_0x24dfbb]=[]),_0x35a121[_0x24dfbb]['push']({'rangeInfo':_0x4f5642[_0x3e3412(0xf4)](),..._0x1b7ab5[_0x3e3412(0xe5)]()}));}}return JSON['stringify'](_0x35a121);}[_0x1eed87(0xec)](_0x1f4717){const _0x462270=_0x1eed87,{dataSource:_0x4eea48}=_0x1f4717,_0x23bdee=_0x4eea48['getRangeInfo'](),{subUnitId:_0x4b2b52,unitId:_0x3110a6,range:_0x10b703}=_0x23bdee[_0x462270(0xee)],_0x10d2f4=this[_0x462270(0x110)]['onCommandExecuted'](_0x33123c=>{const _0x339637=_0x462270;if(_0x33123c['id']===_0x2e47c8['id']){const {subUnitId:_0x131eae,unitId:_0x5b03f9,cellValue:_0x2bc82e}=_0x33123c[_0x339637(0xfe)],_0x900f68=new _0x2b8451(_0x2bc82e)[_0x339637(0x11c)]();_0x131eae===_0x4b2b52&&_0x5b03f9===_0x3110a6&&_0x900f68&&_0xe65685['intersects'](_0x10b703,_0x900f68)&&this['_updateChartRangeAndContext'](_0x1f4717,_0x23bdee);}if(_0x33123c['id']===_0x4acf8d['id']){const {subUnitId:_0x27f008,unitId:_0x563c35,range:_0x1a240c}=_0x33123c[_0x339637(0xfe)];_0x27f008===_0x4b2b52&&_0x3110a6===_0x563c35&&_0xe65685[_0x339637(0x95)](_0x10b703,_0x1a240c)&&this[_0x339637(0x114)](_0x1f4717,_0x23bdee);}if(_0x33123c['id']===_0xe5ee49['id']||_0x33123c['id']===_0x1de1f4['id']){const {subUnitId:_0x162108,unitId:_0x46e28e,range:_0x208bf7}=_0x33123c[_0x339637(0xfe)];_0x162108===_0x4b2b52&&_0x3110a6===_0x46e28e&&_0xe65685[_0x339637(0xf6)](_0x208bf7,_0x10b703)&&(_0x23bdee[_0x339637(0xee)]['range']={'startRow':-0x1,'startColumn':-0x1,'endRow':0x0,'endColumn':0x0},this[_0x339637(0x114)](_0x1f4717,_0x23bdee));}}),_0x3acec2=(_0x3d4e51,_0x4e3598)=>{const _0x2a2fa9=_0x462270;_0x4e3598?(_0x23bdee[_0x2a2fa9(0xee)][_0x2a2fa9(0xd5)]={..._0x4e3598},this['_updateChartRangeAndContext'](_0x1f4717,_0x23bdee)):(_0x23bdee[_0x2a2fa9(0xee)]['range']={'startRow':-0x1,'startColumn':-0x1,'endRow':0x0,'endColumn':0x0},this[_0x2a2fa9(0x114)](_0x1f4717,_0x23bdee));},_0x9c9edd=this[_0x462270(0xdc)][_0x462270(0xec)](_0x3110a6,_0x4b2b52,_0x10b703,_0x3acec2);return{'dispose':()=>{const _0x127c7c=_0x462270;_0x10d2f4[_0x127c7c(0xf8)](),_0x9c9edd[_0x127c7c(0xf8)]();}};}[_0x1eed87(0x114)](_0x53d404,_0x368b71){const _0x7adf5c=_0x1eed87;if(!this[_0x7adf5c(0x106)])return;const {dataSource:_0x5570b9,id:_0x4a73bb}=_0x53d404;_0x5570b9['setRangeInfo'](_0x368b71);const _0x3fcdca=this[_0x7adf5c(0x9b)]['generateChartModelContext'](_0x4a73bb);_0x3fcdca&&_0x53d404['assignChartContext'](_0x3fcdca);}[_0x1eed87(0xf3)](_0x30d768,_0x19ce0f){const _0x4c3c8c=_0x1eed87;this[_0x4c3c8c(0xab)][_0x4c3c8c(0xe3)](_0x30d768)&&Object[_0x4c3c8c(0xb7)](_0x19ce0f)[_0x4c3c8c(0x84)](_0x53c798=>{const _0x388a6e=_0x4c3c8c,_0x30e43f=_0x19ce0f[_0x53c798];!_0x30e43f||_0x30e43f[_0x388a6e(0x9e)]<=0x0||_0x30e43f[_0x388a6e(0x84)](_0x199baf=>{const {rangeInfo:_0x251892}=_0x199baf;this['createChartModel'](_0x30d768,_0x53c798,{..._0x199baf,'rangeInfo':_0x251892});});});}['_initSnapshot'](){const _0x378c86=_0x1eed87;this[_0x378c86(0xda)]['registerPluginResource']({'pluginName':nt,'businesses':[_0x488a0e[_0x378c86(0x97)]],'toJson':_0xb9f5b3=>this[_0x378c86(0xd1)](_0xb9f5b3),'parseJson':_0x5137d1=>JSON['parse'](_0x5137d1),'onLoad':(_0x5cb2b2,_0x2d8bc5)=>{const _0x1e4972=_0x378c86;this[_0x1e4972(0xf3)](_0x5cb2b2,_0x2d8bc5),this[_0x1e4972(0x106)]=!0x0;},'onUnLoad':_0x58b531=>{const _0x256321=_0x378c86;var _0x3f1052;(_0x3f1052=this[_0x256321(0xd7)]['get'](_0x58b531))==null||_0x3f1052[_0x256321(0x84)](_0x45cf5d=>{const _0x7dd579=_0x256321;Array['from'](_0x45cf5d[_0x7dd579(0x89)]())['forEach'](_0x54614f=>{const _0x160fe3=_0x7dd579;var _0x109fc7;(_0x109fc7=this[_0x160fe3(0x9b)][_0x160fe3(0x10c)](_0x54614f))==null||_0x109fc7['dispose'](),this[_0x160fe3(0x9b)][_0x160fe3(0x129)](_0x54614f);});});}});}[_0x1eed87(0xf8)](){const _0x3a86f9=_0x1eed87;super[_0x3a86f9(0xf8)](),this['_chartModelService'][_0x3a86f9(0xf8)](),this[_0x3a86f9(0xd7)][_0x3a86f9(0x113)](),this[_0x3a86f9(0x10a)][_0x3a86f9(0x84)](_0x1d1780=>_0x1d1780[_0x3a86f9(0xf8)]()),this['_dataSourceMap'][_0x3a86f9(0x113)]();}};E=tt([D(0x0,_0x2c5ef3),D(0x1,_0x2688e4(_0x54fe6f)),D(0x2,_0x3d67c8),D(0x3,_0x2688e4(y)),D(0x4,_0xbb386e)],E);const U={'id':_0x1eed87(0xd9),'type':_0x305658['MUTATION'],'handler':(_0x21d9f7,_0x2d1382)=>{const _0x4c5a9f=_0x1eed87,{dataAggregation:_0x216688,style:_0x23d231,context:_0x111ceb,chartType:_0x5ba31e,chartModelId:_0x3d3337}=_0x2d1382,_0x2e0a2a=_0x21d9f7[_0x4c5a9f(0xd8)](E)['getChartModel'](_0x3d3337);return _0x2e0a2a&&(_0x23d231&&_0x2e0a2a[_0x4c5a9f(0x128)](_0x23d231),_0x216688&&_0x2e0a2a[_0x4c5a9f(0xa8)](_0x216688),_0x111ceb&&_0x2e0a2a['assignChartContext'](_0x111ceb),_0x5ba31e&&_0x2e0a2a[_0x4c5a9f(0x12e)](_0x5ba31e)),!0x0;}},rt={'id':_0x1eed87(0xe4),'type':_0x305658[_0x1eed87(0x83)],'handler':(_0x3205f6,_0x4c62d2)=>{const _0x2021f8=_0x1eed87;if(!_0x4c62d2)return!0x1;const {unitId:_0x55c9b5,style:_0x47aa57,dataAggregation:_0x21f496,context:_0x47d518,chartModelId:_0x1dd297,chartType:_0x141885}=_0x4c62d2,_0x540398=_0x3205f6[_0x2021f8(0xd8)](E)['getChartModel'](_0x1dd297);if(!_0x540398)return!0x1;const _0x5bdc60=_0x3205f6['get'](_0xbb386e),_0x4ed4db=_0x3205f6[_0x2021f8(0xd8)](_0x5d3de9),_0x193ca1=[],_0x3aa8a2=[];_0x193ca1[_0x2021f8(0xb2)]({'id':U['id'],'params':{'unitId':_0x55c9b5,'chartModelId':_0x1dd297,'style':_0x47aa57,'dataAggregation':_0x21f496,'context':_0x47d518,'chartType':_0x141885}});const _0xd30fa6={'unitId':_0x55c9b5,'chartModelId':_0x1dd297};if(_0x47aa57){const _0x262744=_0x540398[_0x2021f8(0xbe)]||{};_0xd30fa6[_0x2021f8(0xbe)]=ge(_0x47aa57,_0x262744);}return _0x21f496&&(_0xd30fa6['dataAggregation']=oe(_0x21f496,_0x540398[_0x2021f8(0x8b)]||{})),_0x47d518&&(_0xd30fa6[_0x2021f8(0xea)]=oe(_0x47d518,_0x540398[_0x2021f8(0xea)]||{})),_0x141885&&(_0xd30fa6[_0x2021f8(0xe9)]=_0x540398[_0x2021f8(0xe9)]),_0x3aa8a2[_0x2021f8(0xb2)]({'id':U['id'],'params':_0xd30fa6}),_0x193ca1['every'](_0x18e985=>_0x5bdc60[_0x2021f8(0xb0)](_0x18e985['id'],_0x18e985['params']))&&_0x4ed4db[_0x2021f8(0x94)]({'unitID':_0x55c9b5,'redoMutations':[..._0x193ca1],'undoMutations':[..._0x3aa8a2]}),!0x0;}};function ge(_0x5c5554,_0x3428db){const _0xd2ef8d=_0x1eed87,_0x1280fa={};return Object['keys'](_0x5c5554)[_0xd2ef8d(0x84)](_0x1ab31e=>{const _0x2847cc=_0xd2ef8d;if(!(_0x1ab31e in _0x3428db)){_0x1280fa[_0x1ab31e]=null;return;}if(_0x5c5554[_0x1ab31e]&&typeof _0x5c5554[_0x1ab31e]==_0x2847cc(0x10f)&&!Array[_0x2847cc(0x11b)](_0x5c5554[_0x1ab31e])){const _0x27e3e7=ge(_0x5c5554[_0x1ab31e],_0x3428db[_0x1ab31e]||{});Object[_0x2847cc(0xb7)](_0x27e3e7)['length']>0x0&&(_0x1280fa[_0x1ab31e]=_0x27e3e7);}_0x1280fa[_0x1ab31e]=_0x3428db[_0x1ab31e];}),_0x1280fa;}function oe(_0x2f4095,_0xddf557){const _0x38ca63=_0x1eed87,_0x357f5d={};return Object[_0x38ca63(0xb7)](_0x2f4095)[_0x38ca63(0x84)](_0x176f50=>{_0x357f5d[_0x176f50]=_0x176f50 in _0xddf557?_0xddf557[_0x176f50]:null;}),_0x357f5d;}const N={'id':_0x1eed87(0xc1),'type':_0x305658[_0x1eed87(0xf2)],'handler':(_0xd17781,_0x5c8fd7)=>{const _0x426931=_0x1eed87,{chartModelId:_0x27fb5e,rangeInfo:_0x34d33a}=_0x5c8fd7,_0xe5b8cf=_0xd17781['get'](E)[_0x426931(0xd6)](_0x27fb5e);if(!_0xe5b8cf)return!0x1;const _0x568e6e=Array[_0x426931(0x11b)](_0x34d33a),_0x5e5c23=_0xe5b8cf instanceof fe;return _0x568e6e===_0x5e5c23&&_0xe5b8cf==null||_0xe5b8cf[_0x426931(0x99)](_0x34d33a),!0x0;}},ot={'id':_0x1eed87(0xf5),'type':_0x305658[_0x1eed87(0x83)],'handler':(_0x5d257a,_0x6125bc)=>{const _0x5d33ca=_0x1eed87;if(!_0x6125bc)return!0x1;const {unitId:_0x1780d3,chartModelId:_0x2cc1cf,range:_0x52f97f}=_0x6125bc,_0x237887=_0x5d257a['get'](E),_0x4fcace=_0x5d257a[_0x5d33ca(0xd8)](y),_0x34e8df=_0x237887[_0x5d33ca(0x10c)](_0x2cc1cf);if(!_0x34e8df||!_0x52f97f)return!0x1;const _0x5cbba9=_0x5d257a[_0x5d33ca(0xd8)](_0xbb386e),_0x5d4ff8=_0x5d257a[_0x5d33ca(0xd8)](_0x5d3de9),_0x5d15e7=_0x237887['getChartDataSource'](_0x2cc1cf);if(!_0x5d15e7)return!0x1;const _0x2bcfd8=_0x5d15e7[_0x5d33ca(0xf4)](),_0x2b4e4c=_0x34e8df[_0x5d33ca(0xea)],_0x290c1d={'unitId':_0x1780d3,'chartModelId':_0x2cc1cf,'rangeInfo':_0x52f97f};if(!_0x5cbba9[_0x5d33ca(0xb0)](N['id'],_0x290c1d))return!0x1;const _0x3c3534=_0x4fcace['generateChartModelContext'](_0x2cc1cf),_0x43641c={'unitId':_0x1780d3,'chartModelId':_0x2cc1cf,'context':_0x3c3534};if(!_0x5cbba9['syncExecuteCommand'](U['id'],_0x43641c))return!0x1;const _0x4c53b3=[{'id':N['id'],'params':_0x290c1d},{'id':U['id'],'params':_0x43641c}],_0x4fcbda=[{'id':N['id'],'params':{'unitId':_0x1780d3,'chartModelId':_0x2cc1cf,'rangeInfo':_0x2bcfd8}},{'id':U['id'],'params':{'unitId':_0x1780d3,'chartModelId':_0x2cc1cf,'context':_0x2b4e4c}}];return _0x5d4ff8[_0x5d33ca(0x94)]({'unitID':_0x1780d3,'redoMutations':[..._0x4c53b3],'undoMutations':[..._0x4fcbda]}),!0x0;}},st={'id':_0x1eed87(0xbc),'type':_0x305658[_0x1eed87(0xf2)],'handler':(_0x5d81d1,_0x50bf8c)=>{const _0x53c61a=_0x1eed87,{unitId:_0x4bf497,subUnitId:_0xfd33f0,range:_0x3f3c04,chartId:_0x47c17d,isRowDirection:_0x31c558}=_0x50bf8c,_0x7ae872=_0x5d81d1['get'](E),_0x421b09={'rangeInfo':{'unitId':_0x4bf497,'subUnitId':_0xfd33f0,'range':_0x3f3c04},'isRowDirection':_0x31c558!=null?_0x31c558:!0x0};return _0x7ae872[_0x53c61a(0x121)](_0x4bf497,_0xfd33f0,{'rangeInfo':_0x421b09,'id':_0x47c17d,'chartType':_0x50bf8c['chartType']},!0x0),!0x0;}},at={'id':_0x1eed87(0xce),'type':_0x305658['MUTATION'],'handler':(_0x3bcd57,_0x678c77)=>{const {chartId:_0xa326d8}=_0x678c77;return _0x3bcd57['get'](E)['removeChartModel'](_0xa326d8),!0x0;}},it='QUrsPE8r\x20Iqs9XdPE8r(SEsqrfq,\x20dUlSEsMqX)\x20{\x20\x20\x20\x20P9X\x20{\x20\x20\x20\x20\x20\x20\x20\x20s8rfP\x20SEsqrfqmrQ8in9PG99nX\x20=\x20SEsqrfq.fdSEP(\x27-\x27);\x20\x20\x20\x20\x20\x20\x20\x20s8rfP\x2089EpErtqffnpq\x20=\x20hg7K.dn9fq(nP8l(SEsqrfqmrQ8in9PG99nX[L]));\x20\x20\x20\x20\x20\x20\x20\x20EQ\x20(!89EpErtqffnpq.UI)\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2089EpErtqffnpq.UI\x20=\x20KUjlq9(SEsqrfqmrQ8in9PG99nX[V]);\x20\x20\x20\x20\x20\x20\x20\x20}\x20\x20\x20\x20\x20\x20\x20\x20s8rfP\x20Efo89yq9\x20=\x20PXdq8Q\x20o89yq9bS8lnSgs8dq\x20!==\x20\x27UrIqQErqI\x27\x20&&\x20fqSQ\x20ErfPnrsq8Q\x20o89yq9bS8lnSgs8dq;\x20\x20\x20\x20\x20\x20\x20\x20s8rfP\x20s8rPqBP\x20=\x20Efo89yq9\x20?\x20fqSQ\x20:\x20NErI8N;\x20\x20\x20\x20\x20\x20\x20\x20s8rfP\x20jqffnpqo89I\x20=\x20s8rPqBP.__FnfqkV__.dn9fq(SEsqrfqmrQ8in9PG99nX[L]);\x20\x20\x20\x20\x20\x20\x20\x20s8rfP\x20jqffnpq\x20=\x20s8rPqBP.__YqB__.fP9ErpEQX(jqffnpqo89I);\x20\x20\x20\x20\x20\x20\x20\x20s8rfP\x20fEprnPU9qo89I\x20=\x20s8rPqBP.__FnfqkV__.dn9fq(SEsqrfqmrQ8in9PG99nX[O]);\x20\x20\x20\x20\x20\x20\x20\x20s8rfP\x20fEprnPU9q\x20=\x20s8rPqBP.__YqB__.fP9ErpEQX(fEprnPU9qo89I);\x20\x20\x20\x20\x20\x20\x20\x20s8rfP\x20fEpranSEI\x20=\x20s8rPqBP.__5q9EQX__(fEprnPU9q,\x20jqffnpq,\x20dUlSEsMqX);\x20\x20\x20\x20\x20\x20\x20\x20s8rfP\x20I8jnEr\x20=\x2089EpErtqffnpq.Ij;\x20\x20\x20\x20\x20\x20\x20\x20QUrsPE8r\x20Ef68jnErtnPsZErp(8inPPq9r,\x208Y8fP)\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20s8rfP\x20dnPPq9r\x20=\x208inPPq9r.9qdSnsq(/^.+/,\x20\x27\x27);\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20s8rfP\x20Z8fP\x20=\x208Y8fP.9qdSnsq(/^.+/,\x20\x27\x27);\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20s8rfP\x20dnPPq9rin9Pf\x20=\x20dnPPq9r.fdSEP(\x27.\x27);\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20s8rfP\x20Z8fPin9Pf\x20=\x20Z8fP.fdSEP(\x27.\x27);\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20EQ\x20(!dnPPq9r.ErsSUIqf(\x27*\x27))\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x209qPU9r\x20dnPPq9r\x20===\x20Z8fP;\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20EQ\x20(dnPPq9rin9Pf.SqrpPZ\x20<\x20L\x20||\x20dnPPq9rin9Pf[D]\x20!==\x20\x27*\x27)\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x209qPU9r\x20QnSfq;\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20s8rfP\x20dnPPq9rgUQQEB\x20=\x20dnPPq9rin9Pf.fSEsq(0).u8Er(\x27.\x27);\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20s8rfP\x20Z8fPgUQQEB\x20=\x20Z8fPin9Pf.fSEsq(-dnPPq9rin9Pf.SqrpPZ\x20+\x200).u8Er(\x27.\x27);\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x209qPU9r\x20dnPPq9rgUQQEB\x20===\x20Z8fPgUQQEB;\x20\x20\x20\x20\x20\x20\x20\x20}\x20\x20\x20\x20\x20\x20\x20\x20SqP\x20I8jnEranSEI\x20=\x20(I8jnEr\x20&&\x20I8jnEr.SqrpPZ)\x20?\x20I8jnEr.f8jq((IjmPqj)\x20=>\x20Ef68jnErtnPsZErp(IjmPqj,\x20S8snPE8r.Z8fPrnjq))\x20:\x20P9Uq;\x20\x20\x20\x20\x20\x20\x20\x20EQ\x20(S8snPE8r.Z8fPrnjq\x20===\x20\x27S8snSZ8fP\x27)\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20I8jnEranSEI\x20=\x20P9Uq;\x20\x20\x20\x20\x20\x20\x20\x20}\x20\x20\x20\x20\x20\x20\x20\x20s8rfP\x205nSEI\x20=\x20fEpranSEI\x20&&\x20I8jnEranSEI;\x20\x20\x20\x20\x20\x20\x20\x209qPU9r\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x205nSEI,\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20jqffnpq:\x2089EpErtqffnpq,\x20\x20\x20\x20\x20\x20\x20\x20};\x20\x20\x20\x20}\x20snPsZ\x20(q9989)\x20{\x20\x20\x20\x20\x20\x20\x20\x209qPU9r\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x205nSEI:\x20QnSfq,\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20jqffnpq:\x20{},\x20\x20\x20\x20\x20\x20\x20\x20};\x20\x20\x20\x20}}',ct={0x0:'1',0x1:'7',0x2:'E',0x3:'9',0x4:'Z',0x5:'v',0x6:'D',0x7:'O',0x8:'o',0x9:'r','D':'0','L':'2','O':'3','V':'4','H':'5','k':'6','A':'8','n':'a','l':'b','s':'c','I':'d','q':'e','Q':'f','p':'g','Z':'h','E':'i','u':'j','y':'k','S':'l','j':'m','r':'n','d':'p','c':'q','f':'s','P':'t','U':'u','N':'w','B':'x','X':'y','z':'z','G':'A','F':'B','e':'C','W':'F','b':'G','Y':'H','m':'I','h':'J','M':'K','v':'L','t':'M','K':'N','i':'P','w':'Q','x':'R','g':'S','R':'T','T':'U','a':'V','o':'W','C':'X','J':'Y'},dt=Number[_0x1eed87(0x105)](0x690efbe6),Z=['2','4','8','268435460'],ht=[_0x1eed87(0xfa)],ut=[],Pt=(_0x490e7c,_0x25cfe5,_0x313efa)=>{const _0x3fafc1=_0x1eed87,_0xf266f3=_0x25cfe5[_0x3fafc1(0xb6)]('.'),_0x2419ce=_0xf266f3[_0x3fafc1(0xca)]();_0xf266f3[_0x3fafc1(0x84)](_0x4be4f4=>{_0x490e7c[_0x4be4f4]||(_0x490e7c[_0x4be4f4]={}),_0x490e7c=_0x490e7c[_0x4be4f4];}),_0x2419ce&&(_0x490e7c[_0x2419ce]=_0x313efa);},Et=(_0x32854b,_0x4b8234)=>{const _0x19c435=_0x1eed87;_0x32854b[_0x19c435(0x87)]||(_0x32854b['graphic']={'elements':[]}),_0x32854b[_0x19c435(0x87)]['elements']['push'](..._0x4b8234);},Rt=_0x455a67=>_0x455a67*Math['PI']/0xb4,H=new Map();let k;const qt=(_0x5f3db7,_0x19c6b8)=>{const _0x3ea340=_0x1eed87;if(!document)return{'width':0x0,'height':0x0};const _0x17f579=_0x5f3db7+'-'+_0x19c6b8;if(H['has'](_0x17f579))return H[_0x3ea340(0xd8)](_0x17f579);k||(k=document[_0x3ea340(0x10d)]('canvas'));const _0x8bed78=k['getContext']('2d');_0x8bed78[_0x3ea340(0xaa)]=_0x19c6b8;const _0x20f552=_0x8bed78[_0x3ea340(0xf7)](_0x5f3db7),_0x29b59d=_0x20f552[_0x3ea340(0x101)],_0x3c1cb7=_0x20f552[_0x3ea340(0x108)]+_0x20f552[_0x3ea340(0xfd)];return H[_0x3ea340(0x126)](_0x17f579,{'width':_0x29b59d,'height':_0x3c1cb7}),{'width':_0x29b59d,'height':_0x3c1cb7};};function yt(_0x377805){const _0x481bc2=_0x1eed87;var _0x27a329;const _0x45edfd=(_0x27a329=_0x377805['get'](_0x9aabd)[_0x481bc2(0x86)](_0x3aaef3))!=null?_0x27a329:{},{ls:_0x2b5b52,pbk:_0x2e68f5}=_0x45edfd;if(!_0x2b5b52||!_0x2e68f5)return Z;const _0x1694fa=_0x38ca72(it,ct),_0x164c86=new Function(_0x481bc2(0xc0)+_0x1694fa)()(_0x2b5b52,_0x2e68f5),_0x272a50=_0x164c86[_0x481bc2(0xe8)];return _0x164c86[_0x481bc2(0x11e)]&&_0x114aa6(_0x272a50,'sf',dt)?_0x330520(_0x272a50,!0x0,'c',ht,Z,ut):Z;}const lt='sheets-chart.config',se={};var ft=Object[_0x1eed87(0xa2)],gt=(_0x5cd29b,_0x3f4b82,_0x209206,_0x5c616f)=>{const _0x5d3eb3=_0x1eed87;for(var _0x3c5e2b=_0x5c616f>0x1?void 0x0:_0x5c616f?ft(_0x3f4b82,_0x209206):_0x3f4b82,_0x598eb8=_0x5cd29b[_0x5d3eb3(0x9e)]-0x1,_0x50713f;_0x598eb8>=0x0;_0x598eb8--)(_0x50713f=_0x5cd29b[_0x598eb8])&&(_0x3c5e2b=_0x50713f(_0x3c5e2b)||_0x3c5e2b);return _0x3c5e2b;},X=(_0x4548ab,_0x464c9c)=>(_0x10719e,_0x37aecd)=>_0x464c9c(_0x10719e,_0x37aecd,_0x4548ab);const pt=_0x1eed87(0x100);var O;let ae=(O=class extends _0x2b26cd{constructor(_0x223dd6=se,_0x536053,_0x18cde0,_0x2908d8){const _0x25c046=_0x1eed87;super(),this[_0x25c046(0xb5)]=_0x223dd6,this[_0x25c046(0xf1)]=_0x536053,this[_0x25c046(0x110)]=_0x18cde0,this[_0x25c046(0x103)]=_0x2908d8;const {..._0x3c347c}=_0x34627a({},se,this[_0x25c046(0xb5)]);this[_0x25c046(0x103)][_0x25c046(0xeb)](lt,_0x3c347c),this[_0x25c046(0xa3)]();}[_0x1eed87(0x102)](){const _0x24fde8=_0x1eed87;_0x584769(this['_injector'],[[y],[E]]);const _0xa4406f=this['_injector'][_0x24fde8(0xd8)](E),_0x5b773b=this[_0x24fde8(0xf1)][_0x24fde8(0xd8)](y);_0xa4406f['setLoaded'](),_0x5b773b['refreshChartModel']();}[_0x1eed87(0xb4)](){const _0x226c92=_0x1eed87,_0x5fa151=this[_0x226c92(0xf1)];[[y],[E]][_0x226c92(0x84)](_0x30f225=>_0x5fa151['add'](_0x30f225)),_0x48c335(_0x5fa151),_0x59943d(_0x5fa151);}[_0x1eed87(0xa3)](){const _0x195d6d=_0x1eed87;[rt,ot,st,at,U,N][_0x195d6d(0x84)](_0x4ff51b=>this[_0x195d6d(0xb9)](this['_commandService'][_0x195d6d(0x127)](_0x4ff51b)));}},C(O,_0x1eed87(0x7f),_0x488a0e[_0x1eed87(0x97)]),C(O,_0x1eed87(0xaf),pt),O);ae=gt([X(0x1,_0x2688e4(_0x437fbd)),X(0x2,_0xbb386e),X(0x3,_0x9aabd)],ae);export{fe as ChartDataSourceMulti,Xe as ChartDataSourceSingle,y as ChartModelService,rt as ChartUpdateConfigCommand,U as ChartUpdateConfigMutation,ot as ChartUpdateSourceCommand,N as ChartUpdateSourceConfigMutation,st as InsertSheetsChartMutation,at as RemoveSheetsChartMutation,pt as SHEETS_CHART_PLUGIN_NAME,Ye as SheetChartModel,E as SheetsChartService,ae as UniverSheetsChartPlugin,qt as calcPosition,ze as createChartDataSource,yt as getAllowedChartTypes,Mt as getCategoryData,Et as setGraphicToSpec,Pt as setProperty,Rt as translateAngleToRadian};