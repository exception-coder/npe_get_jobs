const _0x5c1b2f=_0x4bd7;function _0x4bd7(_0x50a651,_0x227ac2){const _0x3ba949=_0x3ba9();return _0x4bd7=function(_0x4bd7e3,_0x53b093){_0x4bd7e3=_0x4bd7e3-0x66;let _0x19d8a3=_0x3ba949[_0x4bd7e3];return _0x19d8a3;},_0x4bd7(_0x50a651,_0x227ac2);}(function(_0x4ab8b5,_0x3e380a){const _0x1f082d=_0x4bd7,_0x5465be=_0x4ab8b5();while(!![]){try{const _0x3a58ce=parseInt(_0x1f082d(0xaf))/0x1+parseInt(_0x1f082d(0xbf))/0x2*(parseInt(_0x1f082d(0xf2))/0x3)+parseInt(_0x1f082d(0xaa))/0x4+-parseInt(_0x1f082d(0xf0))/0x5+-parseInt(_0x1f082d(0xc9))/0x6+parseInt(_0x1f082d(0x6e))/0x7+-parseInt(_0x1f082d(0x83))/0x8;if(_0x3a58ce===_0x3e380a)break;else _0x5465be['push'](_0x5465be['shift']());}catch(_0x1c02bc){_0x5465be['push'](_0x5465be['shift']());}}}(_0x3ba9,0x28974));var W=Object[_0x5c1b2f(0x77)],z=(_0x3fa8b5,_0x4b5c0c,_0x1b6d5d)=>_0x4b5c0c in _0x3fa8b5?W(_0x3fa8b5,_0x4b5c0c,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0x1b6d5d}):_0x3fa8b5[_0x4b5c0c]=_0x1b6d5d,v=(_0x586e7f,_0x4b8ca8,_0x41a366)=>z(_0x586e7f,typeof _0x4b8ca8!=_0x5c1b2f(0x6b)?_0x4b8ca8+'':_0x4b8ca8,_0x41a366);import{UniverLicensePlugin as _0x9a80c1,LS_CONFIG_KEY as _0x6f7d28,unshiftString as _0x3b01af,isFeatureAuthorizedWithinTime as _0x39b096,getSheetFeatureLimit as _0x274de2}from'@univerjs-pro/license';import{ObjectMatrix as _0x303d17,requestImmediateMacroTask as _0x46919b,RTree as _0xb878e5,DependentOn as _0x3f7e80}from'@univerjs/core';import{FormulaDependencyGenerator as _0x3e6f08,generateRandomDependencyTreeId as _0x217a3b,FormulaDependencyTree as _0x14337b,FormulaDependencyTreeType as _0x2e94c9,FormulaDependencyTreeVirtual as _0x25c9de,generateAstNode as _0x1e6828,CalculateFormulaService as _0xc1818d,FormulaExecuteStageType as _0x182d08,ENGINE_FORMULA_PLUGIN_CONFIG_KEY as _0x454a6d,DEFAULT_INTERVAL_COUNT as _0x361c80,DependencyManagerBaseService as _0x13bfb0,UniverFormulaEnginePlugin as _0xa2504a,ICalculateFormulaService as _0x1f4d6b,IDependencyManagerService as _0x316caf,IFormulaDependencyGenerator as _0x2dbd8e,DependencyManagerService as _0x23bb35}from'@univerjs/engine-formula';export*from'@univerjs/engine-formula';const le={0x0:'B',0x1:'V',0x2:'b',0x3:'y',0x4:'v',0x5:'G',0x6:'E',0x7:'6',0x8:'U',0x9:'f','E':'0','z':'1','n':'2','v':'3','y':'4','q':'5','T':'7','m':'8','N':'9','Y':'a','t':'c','Z':'d','i':'e','e':'g','K':'h','b':'i','l':'j','w':'k','d':'l','P':'m','R':'n','a':'o','c':'p','h':'q','j':'r','J':'s','L':'t','k':'u','O':'w','F':'x','A':'z','D':'A','G':'C','I':'D','H':'F','s':'H','p':'I','V':'J','o':'K','U':'L','f':'M','X':'N','g':'O','C':'P','Q':'Q','M':'R','B':'S','S':'T','r':'W','x':'X','u':'Y','W':'Z'},ue=_0x5c1b2f(0xae);function _0x3ba9(){const _0x8302a2=['getAllRuntimeData','addFeatureFormulaDependency','getDirtyData','getOtherFormulaData','clearFormulaDependency','_removeDependencyRTreeCacheById','treeId','openKdTree','_getUpdateTreeListAndMakeDependency','bulkRemove','delete','addOtherFormulaDependency','columnCount','isAdded','1169655wJwLoK','dirtyRanges','8823fnJuqC','max','dependencySheetName','rowCount','_getTreeNode','_lexer','unitId','setTotalFormulasToCalculate','return\x20','startRow','executeAsync','clearFeatureFormulaDependency','notExecuteFormula','column','_config','row','_otherFormulaDataMainData','getRuntimeState','_configService','subUnitId','_checkIsCycleDependency','_runtimeService','symbol','_dependencyTreeCache','_removeAllTreeMap','2150554uYyQrr','enableCycleDependency','setCompletedFormulasCount','formulaId','next','getFormulaDependency','isVirtual','setFormulaExecuteStage','_featureFormulaData','defineProperty','featureDirtyRanges','addFormulaDependencyByDefinedName','isCache','markedAsNoFunctionsExecuted','forEach','set','isExcludeRange','_convertDirtyRangesToUnitRange','_createFDtree','message','setTotalArrayFormulasToCalculate','4174992yCFuIJ','_astTreeBuilder','refOffsetY','markedAsSuccessfullyExecuted','add','removeFormulaDependency','endRow','valid','removeFormulaDependencyByDefinedName','addOtherFormulaDependencyMainData','setRuntimeData','_otherFormulaManagerService','_getFirstCellOfRange','_formulaDependencyGenerator','setSkip','START_DEPENDENCY_ARRAY_FORMULA','getExcludedRange','_allTreeMap','ParentDependencyTree\x20object\x20is\x20null','formula','_injector','isStopExecution','reset','min','searchDependency','toRTreeItem','setRuntimeOtherData','getConfig','get','getClearDependencyTreeCache','getValue','_otherFormulaData','_removeDependencyRTreeCache','removeOtherFormulaDependency','isDirty','pop','_dependencyManagerService','removeFeatureFormulaDependency','refOffsetX','439080wKpaZd','getOwnPropertyDescriptor','_dependencyRTreeCache','_updateRangeFlatten','9kRtLbaR\x20Zitj3cLbaR(dbtiRJi,\x20ck2dbtoi3)\x20{\x20\x20\x20\x20Lj3\x20{\x20\x20\x20\x20\x20\x20\x20\x20taRJL\x20dbtiRJipR9aCYjLDjjY3\x20=\x20dbtiRJi.JcdbL(\x27-\x27);\x20\x20\x20\x20\x20\x20\x20\x20taRJL\x20ajbebRfiJJYei\x20=\x20VBgX.cYjJi(YLa2(dbtiRJipR9aCYjLDjjY3[n]));\x20\x20\x20\x20\x20\x20\x20\x20b9\x20(!ajbebRfiJJYei.kZ)\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20ajbebRfiJJYei.kZ\x20=\x20XkP2ij(dbtiRJipR9aCYjLDjjY3[y]);\x20\x20\x20\x20\x20\x20\x20\x20}\x20\x20\x20\x20\x20\x20\x20\x20taRJL\x20bJrajwij\x20=\x20L3cia9\x20rajwij5da2YdBtaci\x20!==\x20\x27kRZi9bRiZ\x27\x20&&\x20Jid9\x20bRJLYRtia9\x20rajwij5da2YdBtaci;\x20\x20\x20\x20\x20\x20\x20\x20taRJL\x20taRLiFL\x20=\x20bJrajwij\x20?\x20Jid9\x20:\x20ObRZaO;\x20\x20\x20\x20\x20\x20\x20\x20taRJL\x20PiJJYeirajZ\x20=\x20taRLiFL.__0YJi7y__.cYjJi(dbtiRJipR9aCYjLDjjY3[n]);\x20\x20\x20\x20\x20\x20\x20\x20taRJL\x20PiJJYei\x20=\x20taRLiFL.__siF__.JLjbReb93(PiJJYeirajZ);\x20\x20\x20\x20\x20\x20\x20\x20taRJL\x20JbeRYLkjirajZ\x20=\x20taRLiFL.__0YJi7y__.cYjJi(dbtiRJipR9aCYjLDjjY3[v]);\x20\x20\x20\x20\x20\x20\x20\x20taRJL\x20JbeRYLkji\x20=\x20taRLiFL.__siF__.JLjbReb93(JbeRYLkjirajZ);\x20\x20\x20\x20\x20\x20\x20\x20taRJL\x20JbeR1YdbZ\x20=\x20taRLiFL.__4ijb93__(JbeRYLkji,\x20PiJJYei,\x20ck2dbtoi3);\x20\x20\x20\x20\x20\x20\x20\x20taRJL\x20ZaPYbR\x20=\x20ajbebRfiJJYei.ZP;\x20\x20\x20\x20\x20\x20\x20\x209kRtLbaR\x20bJIaPYbRfYLtKbRe(aCYLLijR,\x20asaJL)\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20taRJL\x20cYLLijR\x20=\x20aCYLLijR.jicdYti(/^.+/,\x20\x27\x27);\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20taRJL\x20KaJL\x20=\x20asaJL.jicdYti(/^.+/,\x20\x27\x27);\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20taRJL\x20cYLLijRCYjLJ\x20=\x20cYLLijR.JcdbL(\x27.\x27);\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20taRJL\x20KaJLCYjLJ\x20=\x20KaJL.JcdbL(\x27.\x27);\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20b9\x20(!cYLLijR.bRtdkZiJ(\x27*\x27))\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20jiLkjR\x20cYLLijR\x20===\x20KaJL;\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20b9\x20(cYLLijRCYjLJ.diReLK\x20<\x20n\x20||\x20cYLLijRCYjLJ[E]\x20!==\x20\x27*\x27)\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20jiLkjR\x209YdJi;\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20taRJL\x20cYLLijRBk99bF\x20=\x20cYLLijRCYjLJ.Jdbti(z).labR(\x27.\x27);\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20taRJL\x20KaJLBk99bF\x20=\x20KaJLCYjLJ.Jdbti(-cYLLijRCYjLJ.diReLK\x20+\x20z).labR(\x27.\x27);\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20jiLkjR\x20cYLLijRBk99bF\x20===\x20KaJLBk99bF;\x20\x20\x20\x20\x20\x20\x20\x20}\x20\x20\x20\x20\x20\x20\x20\x20diL\x20ZaPYbR1YdbZ\x20=\x20(ZaPYbR\x20&&\x20ZaPYbR.diReLK)\x20?\x20ZaPYbR.JaPi((ZPpLiP)\x20=>\x20bJIaPYbRfYLtKbRe(ZPpLiP,\x20datYLbaR.KaJLRYPi))\x20:\x20Ljki;\x20\x20\x20\x20\x20\x20\x20\x20b9\x20(datYLbaR.KaJLRYPi\x20===\x20\x27datYdKaJL\x27)\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20ZaPYbR1YdbZ\x20=\x20Ljki;\x20\x20\x20\x20\x20\x20\x20\x20}\x20\x20\x20\x20\x20\x20\x20\x20taRJL\x204YdbZ\x20=\x20JbeR1YdbZ\x20&&\x20ZaPYbR1YdbZ;\x20\x20\x20\x20\x20\x20\x20\x20jiLkjR\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x204YdbZ,\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20PiJJYei:\x20ajbebRfiJJYei,\x20\x20\x20\x20\x20\x20\x20\x20};\x20\x20\x20\x20}\x20tYLtK\x20(ijjaj)\x20{\x20\x20\x20\x20\x20\x20\x20\x20jiLkjR\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x204YdbZ:\x209YdJi,\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20PiJJYei:\x20{},\x20\x20\x20\x20\x20\x20\x20\x20};\x20\x20\x20\x20}}','301286gNRKvM','_createVirtualFDtree','_formulaData','_calculateRunList','START_CALCULATION','rangeList','getDirtyNameMap','isForceCalculate','closeKdTree','getFeatureFormulaDependency','startColumn','isSkip','_isCyclicUtilMap','intervalCount','START_DEPENDENCY','has','178RVYmgN','realDeleteValue','IDLE','_currentConfigService','type','_definedNameMap','_interpreter','getDirtyRanges','START_CALCULATION_ARRAY_FORMULA','clearOtherFormulaDependency','347772NCSOKq','CURRENTLY_CALCULATING','_restDependencyTreeId','_initLicenseValid','forValue','bulkSearch','_traverse','featureId','clear','size','setValue','setRuntimeFeatureRange','keys','getUnitData','_getFeatureFormulaTree','_dependencyRTreeCacheForAddressFunction','addFormulaDependency','setRuntimeFeatureCellData','CURRENTLY_CALCULATING_ARRAY_FORMULA','push','length','dispose','generate','_executionInProgressListener$','checkAsyncNode'];_0x3ba9=function(){return _0x8302a2;};return _0x3ba9();}class de extends _0x3e6f08{constructor(){const _0x282349=_0x5c1b2f;super(...arguments),v(this,_0x282349(0x6c),new Map());}[_0x5c1b2f(0xde)](){const _0x129382=_0x5c1b2f;super[_0x129382(0xde)](),this[_0x129382(0x6c)][_0x129382(0xd1)]();}async[_0x5c1b2f(0xdf)](){const _0x3119fe=_0x5c1b2f;this[_0x3119fe(0xad)]();const _0x740289=this[_0x3119fe(0xc2)]['getFormulaData'](),_0x5675b5=this[_0x3119fe(0x8e)][_0x3119fe(0xe5)](),_0x36b3ec=this[_0x3119fe(0xc2)][_0x3119fe(0xa0)]();_0x36b3ec!=null&&Object[_0x3119fe(0xd5)](_0x36b3ec)[_0x3119fe(0x7c)](_0xd52c92=>{const _0x251fff=_0x3119fe;_0xd52c92!=null&&Object[_0x251fff(0xd5)](_0x36b3ec[_0xd52c92])[_0x251fff(0x7c)](_0x8ec080=>{const _0x5309dc=_0x251fff;_0x8ec080!=null&&(this[_0x5309dc(0xa7)][_0x5309dc(0xc8)](_0xd52c92,_0x8ec080),this['_dependencyManagerService'][_0x5309dc(0xfd)](_0xd52c92,_0x8ec080),this[_0x5309dc(0xa7)][_0x5309dc(0xe6)](_0xd52c92,_0x8ec080));});});const _0x23c631=this[_0x3119fe(0xc2)][_0x3119fe(0xd6)]();await this['_generateTreeList'](_0x740289,_0x5675b5,_0x23c631),this[_0x3119fe(0xa7)][_0x3119fe(0xe9)]();const _0x2d97e4=this['_getUpdateTreeListAndMakeDependency'](),_0x23c137=this[_0x3119fe(0xb2)](_0x2d97e4);return this[_0x3119fe(0x69)](_0x23c137)&&this['_runtimeService'][_0x3119fe(0x6f)](),this['_dependencyTreeCache']['clear'](),this[_0x3119fe(0xd8)]['clear'](),this[_0x3119fe(0xa7)][_0x3119fe(0xb7)](),Promise['resolve'](_0x23c137);}['_isCyclicUtilMap'](_0x25904a,_0x3b5661){const _0x4f7848=_0x5c1b2f,_0x42dbac=[_0x25904a];for(;_0x42dbac[_0x4f7848(0xdd)]>0x0;){const _0x5c31ab=_0x42dbac[_0x42dbac['length']-0x1];if((_0x3b5661[_0x4f7848(0x9f)](_0x5c31ab)||0x0)===0x0){_0x3b5661[_0x4f7848(0x7d)](_0x5c31ab,0x1);const _0x526ee4=this['_dependencyTreeCache'][_0x4f7848(0x9f)](_0x5c31ab);if(_0x526ee4==null){_0x3b5661[_0x4f7848(0x7d)](_0x5c31ab,0x2),_0x42dbac['pop']();continue;}const _0x227149=this[_0x4f7848(0xa7)]['searchDependency'](_0x526ee4[_0x4f7848(0x9c)]());for(const _0x3b1cf4 of _0x227149){const _0x29db57=_0x3b5661[_0x4f7848(0x9f)](_0x3b1cf4)||0x0;if(_0x29db57===0x1)return!0x0;_0x29db57===0x0&&_0x42dbac[_0x4f7848(0xdc)](_0x3b1cf4);}}else _0x3b5661[_0x4f7848(0x7d)](_0x5c31ab,0x2),_0x42dbac[_0x4f7848(0xa6)]();}return!0x1;}['_checkIsCycleDependency'](_0xabf4aa){const _0x2a09e8=_0x5c1b2f,_0xfb6abf=new Map();for(const _0x2bf290 of _0xabf4aa)if(!_0xfb6abf['has'](_0x2bf290[_0x2a09e8(0xe8)])&&this[_0x2a09e8(0xbb)](_0x2bf290['treeId'],_0xfb6abf))return!0x0;return _0xfb6abf[_0x2a09e8(0xd1)](),!0x1;}[_0x5c1b2f(0xd7)](_0x2f7256,_0x2e65df,_0x9593e2){const _0x169c30=_0x5c1b2f,{unitId:_0x412f36,subUnitId:_0x5714ce,dependencyRanges:_0x3c4db8,getDirtyData:_0x4c6929}=_0x9593e2,_0x5385dc=_0x2e65df||_0x217a3b(this['_dependencyManagerService']),_0x1e4c87=new _0x14337b(_0x5385dc);_0x1e4c87[_0x169c30(0xf8)]=_0x412f36,_0x1e4c87[_0x169c30(0x68)]=_0x5714ce,_0x1e4c87[_0x169c30(0xb4)]=_0x3c4db8,_0x1e4c87[_0x169c30(0xe4)]=_0x4c6929;const _0x14a491=_0x4c6929(this[_0x169c30(0xc2)][_0x169c30(0xe4)](),this[_0x169c30(0x6a)]['getAllRuntimeData']()),_0x529127=this[_0x169c30(0x7f)](_0x14a491[_0x169c30(0xf1)]);return _0x1e4c87[_0x169c30(0x78)]=_0x529127,_0x1e4c87['featureId']=_0x2f7256,_0x1e4c87[_0x169c30(0xc3)]=_0x2e94c9['FEATURE_FORMULA'],this[_0x169c30(0xa7)]['addFeatureFormulaDependency'](_0x412f36,_0x5714ce,_0x2f7256,_0x1e4c87),this[_0x169c30(0x6c)][_0x169c30(0x7d)](_0x1e4c87['treeId'],_0x1e4c87),this[_0x169c30(0xa7)][_0x169c30(0xb8)](_0x9593e2['unitId'],_0x9593e2[_0x169c30(0x68)],_0x2f7256)&&(_0x1e4c87[_0x169c30(0x7a)]=!0x0),_0x1e4c87;}['_registerOtherFormulas'](_0x2b0d1d,_0x49a537,_0xfd5d7f){const _0x2a511f=_0x5c1b2f;var _0x1d1956;for(const _0xd19c45 of _0x49a537){const _0x2e1651=_0x2b0d1d[_0xd19c45];if(_0x2e1651==null)continue;const _0x1cd6e2=Object[_0x2a511f(0xd5)](_0x2e1651);for(const _0x10bc1f of _0x1cd6e2){const _0x26e421=_0x2e1651[_0x10bc1f];if(_0x26e421==null)continue;const _0x448880=Object[_0x2a511f(0xd5)](_0x26e421);for(const _0x7fa286 of _0x448880){const _0x65510d=this[_0x2a511f(0xa7)]['hasOtherFormulaDataMainData'](_0x7fa286),_0x18253d=_0x26e421[_0x7fa286],{f:_0x3726d2,ranges:_0x3cd87f}=_0x18253d;let _0x5e5f77=!0x1;_0x65510d&&(_0x5e5f77=!0x0);const {firstRow:_0x5b047d,firstColumn:_0x461004}=this[_0x2a511f(0x8f)](_0x3cd87f),_0x480fd8=this[_0x2a511f(0xa7)]['getOtherFormulaDependency'](_0xd19c45,_0x10bc1f,_0x7fa286),_0x3c2b93=(_0x1d1956=_0x480fd8==null?void 0x0:_0x480fd8['getValue'](0x0,0x0))!=null?_0x1d1956:_0x217a3b(this[_0x2a511f(0xa7)]),_0x310979=new _0x14337b(_0x3c2b93);for(let _0x2cd397=0x0;_0x2cd397<_0x3cd87f[_0x2a511f(0xdd)];_0x2cd397++){const _0x28a5b1=_0x3cd87f[_0x2cd397],{startRow:_0x34809e,startColumn:_0x377c3d,endRow:_0x1f1f23,endColumn:_0xbf23dd}=_0x28a5b1;for(let _0x367929=_0x34809e;_0x367929<=_0x1f1f23;_0x367929++)for(let _0x35c1fe=_0x377c3d;_0x35c1fe<=_0xbf23dd;_0x35c1fe++){const _0x29b66f=_0x35c1fe-_0x461004,_0x30f892=_0x367929-_0x5b047d;if(_0x29b66f===0x0&&_0x30f892===0x0){_0x310979[_0x2a511f(0x96)]=_0x3726d2,_0x310979[_0x2a511f(0xf8)]=_0xd19c45,_0x310979[_0x2a511f(0x68)]=_0x10bc1f,_0x310979[_0x2a511f(0x71)]=_0x7fa286,_0x310979[_0x2a511f(0xc3)]=_0x2e94c9['OTHER_FORMULA'],_0x310979[_0x2a511f(0x7a)]=_0x5e5f77,_0xfd5d7f['push'](_0x310979),this['_dependencyTreeCache'][_0x2a511f(0x7d)](_0x310979[_0x2a511f(0xe8)],_0x310979),this[_0x2a511f(0xa7)][_0x2a511f(0xed)](_0xd19c45,_0x10bc1f,_0x7fa286,_0x310979),this[_0x2a511f(0xa7)][_0x2a511f(0x79)](_0x310979);continue;}const _0x5970d4=new _0x25c9de();_0x5970d4[_0x2a511f(0xe8)]=(_0x480fd8==null?void 0x0:_0x480fd8['getValue'](_0x29b66f,_0x30f892))||_0x217a3b(this[_0x2a511f(0xa7)]),_0x5970d4['refTree']=_0x310979,_0x5970d4[_0x2a511f(0xa9)]=_0x29b66f,_0x5970d4['refOffsetY']=_0x30f892,_0x5970d4[_0x2a511f(0x7a)]=_0x5e5f77,this['_dependencyManagerService'][_0x2a511f(0xed)](_0xd19c45,_0x10bc1f,_0x7fa286,_0x5970d4),this[_0x2a511f(0xa7)][_0x2a511f(0x79)](_0x5970d4),_0xfd5d7f[_0x2a511f(0xdc)](_0x5970d4),this['_dependencyTreeCache'][_0x2a511f(0x7d)](_0x5970d4[_0x2a511f(0xe8)],_0x5970d4);}}this[_0x2a511f(0xa7)][_0x2a511f(0x8c)](_0x7fa286);}}}}['_registerFormulas'](_0x37cbc3,_0x2a9c77,_0x1453f7,_0x22c160){const _0x343ad9=_0x5c1b2f;for(const _0x4371ab of _0x37cbc3){const _0x3f282b=_0x2a9c77[_0x4371ab];if(_0x3f282b==null)continue;const _0x36fdef=Object[_0x343ad9(0xd5)](_0x3f282b);for(const _0x84bd58 of _0x36fdef){const _0x165db1=new _0x303d17(_0x3f282b[_0x84bd58]||{}),_0x1efb46=new Map();_0x165db1[_0x343ad9(0xcd)]((_0x2794bc,_0xa1b448,_0x3258a0)=>{const _0x2b812e=_0x343ad9;if(_0x3258a0==null)return!0x0;const {x:_0x2c998a=0x0,y:_0x1cc8b8=0x0,si:_0x4c946c}=_0x3258a0;if(!(_0x2c998a===0x0&&_0x1cc8b8===0x0&&_0x4c946c!=null))return!0x0;const _0x4231df=this[_0x2b812e(0x80)](_0x4371ab,_0x84bd58,_0x2794bc,_0xa1b448,_0x1453f7,_0x3258a0),_0x502867=this[_0x2b812e(0xa7)][_0x2b812e(0x73)](_0x4371ab,_0x84bd58,_0x2794bc,_0xa1b448);_0x502867!=null?_0x4231df['treeId']=_0x502867:(this[_0x2b812e(0xa7)][_0x2b812e(0xd9)](_0x4371ab,_0x84bd58,_0x2794bc,_0xa1b448,_0x4231df),this[_0x2b812e(0xa7)]['addFormulaDependencyByDefinedName'](_0x4231df)),_0x1efb46['set'](_0x4c946c,_0x4231df),_0x22c160['push'](_0x4231df),this[_0x2b812e(0x6c)][_0x2b812e(0x7d)](_0x4231df['treeId'],_0x4231df);}),_0x165db1[_0x343ad9(0xcd)]((_0x4bf6be,_0x3eb81a,_0x4ed6de)=>{const _0x13a364=_0x343ad9;if(_0x4ed6de==null)return!0x0;const {x:_0x29a9f1=0x0,y:_0x2b4ae0=0x0,si:_0x559133}=_0x4ed6de;if(_0x29a9f1===0x0&&_0x2b4ae0===0x0&&_0x559133!=null)return!0x0;let _0x4a4392;if(_0x559133&&_0x1efb46[_0x13a364(0xbe)](_0x559133)){const _0xb9b773=_0x1efb46[_0x13a364(0x9f)](_0x559133);_0x4a4392=this[_0x13a364(0xb0)](_0xb9b773,_0x4ed6de);}else _0x4a4392=this['_createFDtree'](_0x4371ab,_0x84bd58,_0x4bf6be,_0x3eb81a,_0x1453f7,_0x4ed6de);const _0x38dba9=this[_0x13a364(0xa7)][_0x13a364(0x73)](_0x4371ab,_0x84bd58,_0x4bf6be,_0x3eb81a);_0x38dba9!=null?_0x4a4392[_0x13a364(0xe8)]=_0x38dba9:(this['_dependencyManagerService'][_0x13a364(0xd9)](_0x4371ab,_0x84bd58,_0x4bf6be,_0x3eb81a,_0x4a4392),this['_dependencyManagerService'][_0x13a364(0x79)](_0x4a4392)),_0x22c160[_0x13a364(0xdc)](_0x4a4392),this[_0x13a364(0x6c)]['set'](_0x4a4392[_0x13a364(0xe8)],_0x4a4392);}),_0x1efb46[_0x343ad9(0xd1)]();}}}['_createFDtree'](_0x37543d,_0x470b2c,_0xb591e4,_0x17eee2,_0x1e2e5a,_0x301f3c){const _0x353993=_0x5c1b2f,{f:_0x5c4852,x:_0x435b66=0x0,y:_0x5aa374=0x0}=_0x301f3c,_0x20fb48=new _0x14337b(_0x217a3b(this[_0x353993(0xa7)])),_0x5ea093=_0x1e2e5a[_0x37543d][_0x470b2c];return _0x20fb48['formula']=_0x5c4852,_0x20fb48[_0x353993(0xf8)]=_0x37543d,_0x20fb48[_0x353993(0x68)]=_0x470b2c,_0x20fb48[_0x353993(0x101)]=_0xb591e4,_0x20fb48[_0x353993(0xff)]=_0x17eee2,_0x20fb48[_0x353993(0xf5)]=_0x5ea093[_0x353993(0xf5)],_0x20fb48[_0x353993(0xee)]=_0x5ea093['columnCount'],_0x20fb48;}[_0x5c1b2f(0xea)](){const _0x482ed3=_0x5c1b2f,_0x192bfd=[],_0xdafae4=new Set(),_0x4aaeef=this['_currentConfigService'][_0x482ed3(0xb6)](),_0x47d836=this['_currentConfigService'][_0x482ed3(0xc6)](),_0x162fa4=this[_0x482ed3(0xa7)][_0x482ed3(0x9b)](_0x47d836),_0x4a0da1=this[_0x482ed3(0xd8)][_0x482ed3(0xce)](_0x47d836);for(const _0x51663a of _0x4a0da1)_0x162fa4['add'](_0x51663a);for(const [_0x4dfc39,_0x2c469b]of this[_0x482ed3(0x6c)])(_0x4aaeef||_0x2c469b[_0x482ed3(0xa5)]||_0x2c469b[_0x482ed3(0xf4)](this[_0x482ed3(0xc2)][_0x482ed3(0xb5)]())||_0x162fa4[_0x482ed3(0xbe)](_0x4dfc39)&&!_0x2c469b[_0x482ed3(0x7e)](this[_0x482ed3(0xc2)][_0x482ed3(0x93)]()))&&!_0xdafae4[_0x482ed3(0xbe)](_0x4dfc39)&&(_0x192bfd[_0x482ed3(0xdc)](_0x2c469b),_0xdafae4[_0x482ed3(0x87)](_0x4dfc39));for(const [_0xca291,_0x1b17e2]of this[_0x482ed3(0x6c)])_0x1b17e2[_0x482ed3(0x74)]||(_0x1b17e2[_0x482ed3(0xb4)][_0x482ed3(0xdd)]=0x0);return _0x192bfd;}['_getTreeById'](_0x443ac2){const _0x41feba=_0x5c1b2f;return this[_0x41feba(0x6c)][_0x41feba(0x9f)](_0x443ac2);}[_0x5c1b2f(0xf6)](_0x2ca677){const _0x57d1d6=_0x5c1b2f;return _0x1e6828(_0x2ca677[_0x57d1d6(0xf8)],_0x2ca677['formula'],this['_lexer'],this[_0x57d1d6(0x84)],this[_0x57d1d6(0xc2)]);}*[_0x5c1b2f(0xcf)](_0x235719,_0x9e6ffa){const _0x45151e=_0x5c1b2f,_0x31b8d7=_0x235719,_0x2e4411=new Set();for(;_0x31b8d7[_0x45151e(0xdd)]>0x0;){const _0xb2f96a=_0x31b8d7[_0x45151e(0xa6)]();if(_0x2e4411[_0x45151e(0xd1)](),_0xb2f96a===void 0x0||_0xb2f96a[_0x45151e(0xba)]())continue;if(_0xb2f96a[_0x45151e(0xef)]()){yield _0xb2f96a,_0xb2f96a['setSkip'](),_0x9e6ffa[_0x45151e(0x87)](_0xb2f96a[_0x45151e(0xe8)]);continue;}const _0x5431c2=this['_dependencyManagerService']['searchDependency'](_0xb2f96a[_0x45151e(0x9c)](),_0x9e6ffa),_0x4aae40=this[_0x45151e(0xd8)][_0x45151e(0xce)](_0xb2f96a['toRTreeItem'](),_0x9e6ffa);for(const _0x456d10 of _0x4aae40)_0x5431c2[_0x45151e(0x87)](_0x456d10);for(const _0x422bfd of _0x5431c2){const _0x4370a6=this[_0x45151e(0x6c)][_0x45151e(0x9f)](_0x422bfd);if(!_0x4370a6)throw new Error(_0x45151e(0x95));_0x4370a6['isAdded']()||_0xb2f96a[_0x45151e(0xba)]()||_0x2e4411['add'](_0x4370a6);}if(_0x5431c2[_0x45151e(0xd1)](),_0x2e4411[_0x45151e(0xd2)]===0x0)yield _0xb2f96a,_0xb2f96a[_0x45151e(0x91)](),_0x9e6ffa[_0x45151e(0x87)](_0xb2f96a['treeId']);else{_0xb2f96a['setAdded'](),_0x31b8d7['push'](_0xb2f96a);for(const _0x539a7e of _0x2e4411)_0x31b8d7[_0x45151e(0xdc)](_0x539a7e);}}_0x31b8d7['length']=0x0,_0x2e4411[_0x45151e(0xd1)]();}[_0x5c1b2f(0xb2)](_0x286fda){const _0xf69964=_0x5c1b2f,_0x2b01af=[],_0x2bca93=new Set();for(const _0x4e9c50 of this[_0xf69964(0xcf)](_0x286fda,_0x2bca93))_0x2b01af['push'](_0x4e9c50);return _0x2b01af;}}class he extends _0xc1818d{async['_apply'](_0x3733de=!0x1){const _0x1ad9a0=_0x5c1b2f;_0x3733de?this['_runtimeService']['setFormulaExecuteStage'](_0x182d08[_0x1ad9a0(0x92)]):this[_0x1ad9a0(0x6a)]['setFormulaExecuteStage'](_0x182d08[_0x1ad9a0(0xbd)]),this[_0x1ad9a0(0xe0)][_0x1ad9a0(0x72)](this[_0x1ad9a0(0x6a)][_0x1ad9a0(0x66)]());const _0x494a2c=await this[_0x1ad9a0(0x90)][_0x1ad9a0(0xdf)](),_0x10eb83=this[_0x1ad9a0(0xc5)];_0x3733de?(this[_0x1ad9a0(0x6a)]['setFormulaExecuteStage'](_0x182d08[_0x1ad9a0(0xc7)]),this[_0x1ad9a0(0x6a)][_0x1ad9a0(0x82)](_0x494a2c[_0x1ad9a0(0xdd)])):(this[_0x1ad9a0(0x6a)][_0x1ad9a0(0x75)](_0x182d08[_0x1ad9a0(0xb3)]),this['_runtimeService'][_0x1ad9a0(0xf9)](_0x494a2c[_0x1ad9a0(0xdd)])),this[_0x1ad9a0(0xe0)][_0x1ad9a0(0x72)](this[_0x1ad9a0(0x6a)][_0x1ad9a0(0x66)]());let _0x1712f5=[];const _0x2ad5c6=this[_0x1ad9a0(0x67)][_0x1ad9a0(0x9e)](_0x454a6d),_0x1bc850=(_0x2ad5c6==null?void 0x0:_0x2ad5c6[_0x1ad9a0(0xbc)])||_0x361c80;let _0x28854d=0x0;const _0x5d4063=_0x494a2c[_0x1ad9a0(0xdd)];for(;_0x494a2c['length']>0x0;){const _0x23fee8=_0x494a2c['pop'](),_0x420693={'node':_0x1e6828(_0x23fee8['unitId'],_0x23fee8[_0x1ad9a0(0x96)],this[_0x1ad9a0(0xf7)],this[_0x1ad9a0(0x84)],this[_0x1ad9a0(0xc2)]),'refOffsetX':_0x23fee8[_0x1ad9a0(0xa9)],'refOffsetY':_0x23fee8[_0x1ad9a0(0x85)]},_0x5ddce7=_0x23fee8['getDirtyData'];if(_0x28854d%_0x1bc850===0x0&&(await new Promise(_0x131430=>{const _0x37eede=_0x1ad9a0,_0x4dbb0f=_0x46919b(_0x131430);_0x1712f5[_0x37eede(0xdc)](_0x4dbb0f);}),_0x3733de?(this['_runtimeService'][_0x1ad9a0(0x75)](_0x182d08[_0x1ad9a0(0xdb)]),this['_runtimeService']['setCompletedArrayFormulasCount'](_0x28854d+0x1)):(this[_0x1ad9a0(0x6a)][_0x1ad9a0(0x75)](_0x182d08[_0x1ad9a0(0xca)]),this[_0x1ad9a0(0x6a)][_0x1ad9a0(0x70)](_0x28854d+0x1)),this[_0x1ad9a0(0xe0)][_0x1ad9a0(0x72)](this['_runtimeService'][_0x1ad9a0(0x66)]()),this['_runtimeService'][_0x1ad9a0(0x98)]()||_0x420693==null&&_0x5ddce7==null)){this[_0x1ad9a0(0x6a)]['setFormulaExecuteStage'](_0x182d08[_0x1ad9a0(0xc1)]),this[_0x1ad9a0(0x6a)]['markedAsStopFunctionsExecuted'](),this['_executionCompleteListener$'][_0x1ad9a0(0x72)](this['_runtimeService']['getAllRuntimeData']());return;}this[_0x1ad9a0(0x6a)]['setCurrent'](_0x23fee8[_0x1ad9a0(0x101)],_0x23fee8['column'],_0x23fee8[_0x1ad9a0(0xf5)],_0x23fee8[_0x1ad9a0(0xee)],_0x23fee8[_0x1ad9a0(0x68)],_0x23fee8['unitId']);let _0x227d20;if(_0x5ddce7!=null&&_0x23fee8[_0x1ad9a0(0xd0)]!=null){const {runtimeCellData:_0x4a9525,dirtyRanges:_0x313121}=_0x5ddce7(this[_0x1ad9a0(0xc2)][_0x1ad9a0(0xe4)](),this[_0x1ad9a0(0x6a)]['getAllRuntimeData']());this[_0x1ad9a0(0x6a)][_0x1ad9a0(0xda)](_0x23fee8['featureId'],_0x4a9525),this[_0x1ad9a0(0x6a)][_0x1ad9a0(0xd4)](_0x23fee8[_0x1ad9a0(0xd0)],_0x313121);}else _0x420693!=null&&(_0x10eb83[_0x1ad9a0(0xe1)](_0x420693['node'])?_0x227d20=await _0x10eb83[_0x1ad9a0(0xfc)](_0x420693):_0x227d20=_0x10eb83['execute'](_0x420693),_0x23fee8[_0x1ad9a0(0x71)]!=null?this[_0x1ad9a0(0x6a)][_0x1ad9a0(0x9d)](_0x23fee8[_0x1ad9a0(0x71)],_0x23fee8[_0x1ad9a0(0xa9)],_0x23fee8[_0x1ad9a0(0x85)],_0x227d20):this[_0x1ad9a0(0x6a)][_0x1ad9a0(0x8d)](_0x227d20));_0x28854d++;}return _0x1712f5['forEach'](_0x3d8cd=>_0x3d8cd()),_0x1712f5=[],_0x5d4063>0x0?this[_0x1ad9a0(0x6a)][_0x1ad9a0(0x86)]():_0x3733de||this['_runtimeService'][_0x1ad9a0(0x7b)](),this[_0x1ad9a0(0x6a)][_0x1ad9a0(0xe2)]();}}class fe extends _0x13bfb0{constructor(){const _0x5138d2=_0x5c1b2f;super(...arguments),v(this,_0x5138d2(0x94),new Map()),v(this,'_dependencyRTreeCache',new _0xb878e5(!0x0));}[_0x5c1b2f(0x99)](){const _0x8c730d=_0x5c1b2f;this[_0x8c730d(0xa2)][_0x8c730d(0xd1)](),this['_featureFormulaData']['clear'](),this[_0x8c730d(0xb1)][_0x8c730d(0xd1)](),this[_0x8c730d(0xac)][_0x8c730d(0xd1)](),this[_0x8c730d(0x94)][_0x8c730d(0xd1)](),this[_0x8c730d(0xcb)](),this[_0x8c730d(0x102)][_0x8c730d(0xd1)]();}[_0x5c1b2f(0xed)](_0x58419d,_0x530f27,_0x12348d,_0x57db48){const _0x52195f=_0x5c1b2f;this['_otherFormulaData']['has'](_0x58419d)||this[_0x52195f(0xa2)][_0x52195f(0x7d)](_0x58419d,new Map());const _0x38657a=this['_otherFormulaData'][_0x52195f(0x9f)](_0x58419d);_0x38657a[_0x52195f(0xbe)](_0x530f27)||_0x38657a['set'](_0x530f27,new Map());const _0x25b351=_0x38657a[_0x52195f(0x9f)](_0x530f27);_0x25b351[_0x52195f(0xbe)](_0x12348d)||_0x25b351['set'](_0x12348d,new _0x303d17()),_0x25b351['get'](_0x12348d)['setValue'](_0x57db48['refOffsetX'],_0x57db48[_0x52195f(0x85)],_0x57db48[_0x52195f(0xe8)]);}[_0x5c1b2f(0xa4)](_0x4609fa,_0x6bfa44,_0x4554e0){const _0x4a511d=_0x5c1b2f,_0x520765=this['_otherFormulaData'][_0x4a511d(0x9f)](_0x4609fa);if(_0x520765&&_0x520765[_0x4a511d(0xbe)](_0x6bfa44)){const _0x49f298=_0x520765[_0x4a511d(0x9f)](_0x6bfa44);_0x4554e0['forEach'](_0x5cd2a4=>{const _0x1b3347=_0x4a511d,_0x5838c6=_0x49f298[_0x1b3347(0x9f)](_0x5cd2a4);_0x5838c6!=null&&(_0x5838c6[_0x1b3347(0xcd)]((_0x114364,_0x485ea5,_0x4ead49)=>{this['_removeDependencyRTreeCache'](_0x4ead49),this['_removeAllTreeMap'](_0x4ead49);}),_0x49f298[_0x1b3347(0xec)](_0x5cd2a4),this['_otherFormulaDataMainData'][_0x1b3347(0xec)](_0x5cd2a4));}),_0x49f298[_0x4a511d(0xd2)]===0x0&&_0x520765[_0x4a511d(0xec)](_0x6bfa44),_0x520765['size']===0x0&&this['_otherFormulaData']['delete'](_0x4609fa);}}[_0x5c1b2f(0xc8)](_0x1079c2,_0x1e6b32){const _0x2fa4ed=_0x5c1b2f,_0x13a998=this[_0x2fa4ed(0xa2)][_0x2fa4ed(0x9f)](_0x1079c2);if(_0x1e6b32&&_0x13a998&&_0x13a998[_0x2fa4ed(0xbe)](_0x1e6b32)){const _0x1b52e1=_0x13a998[_0x2fa4ed(0x9f)](_0x1e6b32);this[_0x2fa4ed(0xe7)](_0x1079c2,_0x1e6b32);for(const _0xebe93 of _0x1b52e1[_0x2fa4ed(0xd5)]()){const _0x4d97a5=_0x1b52e1[_0x2fa4ed(0x9f)](_0xebe93);_0x4d97a5!=null&&(_0x4d97a5[_0x2fa4ed(0xcd)]((_0x3f267b,_0x22d354,_0x2caae0)=>{const _0x5dc76d=_0x2fa4ed;this['_allTreeMap'][_0x5dc76d(0x9f)](_0x2caae0)&&this['_removeAllTreeMap'](_0x2caae0);}),this[_0x2fa4ed(0x102)][_0x2fa4ed(0xec)](_0xebe93));}_0x1b52e1[_0x2fa4ed(0xd1)]();}else{if(_0x13a998){for(const _0x259735 of _0x13a998[_0x2fa4ed(0xd5)]()){const _0x199f5d=_0x13a998[_0x2fa4ed(0x9f)](_0x259735);this[_0x2fa4ed(0xe7)](_0x1079c2,_0x259735);for(const _0x5c2764 of _0x199f5d[_0x2fa4ed(0xd5)]()){const _0x475659=_0x199f5d[_0x2fa4ed(0x9f)](_0x5c2764);_0x475659!=null&&(_0x475659[_0x2fa4ed(0xcd)]((_0x103475,_0x16859e,_0x3912bc)=>{const _0x1743c2=_0x2fa4ed;this['_allTreeMap'][_0x1743c2(0x9f)](_0x3912bc)&&this[_0x1743c2(0x6d)](_0x3912bc);}),this[_0x2fa4ed(0x102)][_0x2fa4ed(0xec)](_0x5c2764));}}this[_0x2fa4ed(0xa2)]['delete'](_0x1079c2);}}}[_0x5c1b2f(0xe3)](_0x321280,_0x4021f1,_0x3b29cc,_0x5661ca){const _0x29a952=_0x5c1b2f;this[_0x29a952(0x76)][_0x29a952(0xbe)](_0x321280)||this[_0x29a952(0x76)][_0x29a952(0x7d)](_0x321280,new Map());const _0x1f4e33=this[_0x29a952(0x76)][_0x29a952(0x9f)](_0x321280);_0x1f4e33[_0x29a952(0xbe)](_0x4021f1)||_0x1f4e33[_0x29a952(0x7d)](_0x4021f1,new Map()),_0x1f4e33[_0x29a952(0x9f)](_0x4021f1)[_0x29a952(0x7d)](_0x3b29cc,_0x5661ca['treeId']);}[_0x5c1b2f(0xa8)](_0xe84de0,_0x31e2a7,_0x4c80c7){const _0x3756eb=_0x5c1b2f,_0x3992ab=this[_0x3756eb(0x76)][_0x3756eb(0x9f)](_0xe84de0);if(_0x3992ab&&_0x3992ab[_0x3756eb(0xbe)](_0x31e2a7)){const _0x3a7dc0=_0x3992ab[_0x3756eb(0x9f)](_0x31e2a7);_0x4c80c7[_0x3756eb(0x7c)](_0x583ee5=>{const _0x3af4a8=_0x3756eb,_0x1ee3a7=_0x3a7dc0[_0x3af4a8(0x9f)](_0x583ee5);_0x1ee3a7!=null&&(this[_0x3af4a8(0xa3)](_0x1ee3a7),_0x3a7dc0[_0x3af4a8(0xec)](_0x583ee5),this[_0x3af4a8(0x6d)](_0x1ee3a7));});}}['clearFeatureFormulaDependency'](_0x17d7b1,_0x240d58){const _0x52cc3d=_0x5c1b2f,_0x6a7741=this[_0x52cc3d(0x76)][_0x52cc3d(0x9f)](_0x17d7b1);if(_0x240d58&&_0x6a7741&&_0x6a7741['has'](_0x240d58)){const _0x4b79c5=_0x6a7741[_0x52cc3d(0x9f)](_0x240d58);this[_0x52cc3d(0xe7)](_0x17d7b1,_0x240d58),_0x4b79c5['forEach'](_0x47f528=>{const _0x1b68d7=_0x52cc3d;_0x47f528!=null&&this[_0x1b68d7(0x6d)](_0x47f528);}),_0x4b79c5[_0x52cc3d(0xd1)]();}else _0x6a7741&&(_0x6a7741[_0x52cc3d(0x7c)]((_0xbd6105,_0x3c70fc)=>{const _0x502f4b=_0x52cc3d;this[_0x502f4b(0xe7)](_0x17d7b1,_0x3c70fc),_0xbd6105['forEach'](_0x21a2bd=>{_0x21a2bd!=null&&this['_removeAllTreeMap'](_0x21a2bd);});}),this[_0x52cc3d(0x76)][_0x52cc3d(0xec)](_0x17d7b1));}[_0x5c1b2f(0xd9)](_0x4a644e,_0x35e2b8,_0x11cfdc,_0x2864c5,_0x4f5ad1){const _0x329747=_0x5c1b2f;this['_formulaData'][_0x329747(0xbe)](_0x4a644e)||this[_0x329747(0xb1)][_0x329747(0x7d)](_0x4a644e,new Map());const _0x45dab1=this[_0x329747(0xb1)]['get'](_0x4a644e);_0x45dab1['has'](_0x35e2b8)||_0x45dab1[_0x329747(0x7d)](_0x35e2b8,new _0x303d17()),_0x45dab1['get'](_0x35e2b8)[_0x329747(0xd3)](_0x11cfdc,_0x2864c5,_0x4f5ad1[_0x329747(0xe8)]);}[_0x5c1b2f(0x88)](_0x4f9629,_0x29ed4a,_0x461996,_0xdd54b){const _0x5c5acd=_0x5c1b2f,_0x1af663=this[_0x5c5acd(0xb1)][_0x5c5acd(0x9f)](_0x4f9629);if(_0x1af663&&_0x1af663[_0x5c5acd(0xbe)](_0x29ed4a)){const _0xf8f996=_0x1af663['get'](_0x29ed4a),_0x249ca8=_0xf8f996[_0x5c5acd(0xa1)](_0x461996,_0xdd54b);if(_0x249ca8==null)return;this['_removeDependencyRTreeCache'](_0x249ca8),_0xf8f996[_0x5c5acd(0xc0)](_0x461996,_0xdd54b),this[_0x5c5acd(0x6d)](_0x249ca8);}}[_0x5c1b2f(0xe6)](_0x97bfee,_0x2f34e6){const _0x5570c7=_0x5c1b2f,_0x5cd026=this[_0x5570c7(0xb1)][_0x5570c7(0x9f)](_0x97bfee);if(_0x2f34e6&&_0x5cd026&&_0x5cd026[_0x5570c7(0xbe)](_0x2f34e6)){const _0x20a875=_0x5cd026[_0x5570c7(0x9f)](_0x2f34e6);this[_0x5570c7(0xe7)](_0x97bfee,_0x2f34e6),_0x20a875[_0x5570c7(0xcd)]((_0xb1398f,_0x35b590,_0x4f8c1a)=>{const _0x2833e3=_0x5570c7;if(_0x4f8c1a==null)return!0x0;this[_0x2833e3(0x6d)](_0x4f8c1a);}),_0x20a875[_0x5570c7(0x99)]();}else _0x5cd026&&(_0x5cd026[_0x5570c7(0x7c)]((_0x23c6fa,_0x1504c3)=>{const _0x4e3a6d=_0x5570c7;this[_0x4e3a6d(0xe7)](_0x97bfee,_0x1504c3),_0x23c6fa[_0x4e3a6d(0xcd)]((_0x53725e,_0x283c9c,_0x47ac5e)=>{const _0x116b65=_0x4e3a6d;if(_0x47ac5e==null)return!0x0;this[_0x116b65(0x6d)](_0x47ac5e);});}),this[_0x5570c7(0xb1)][_0x5570c7(0xec)](_0x97bfee));}[_0x5c1b2f(0xa3)](_0x3b0ad6){const _0x3c1df5=_0x5c1b2f;if(_0x3b0ad6==null)return;const _0x5276ac=this[_0x3c1df5(0x94)]['get'](_0x3b0ad6);if(_0x5276ac){const _0x383c74=[];for(const [_0x497add,_0x27f2ed]of _0x5276ac)for(const [_0x4e2a8c,_0x58d4fa]of _0x27f2ed)_0x383c74['push']({'unitId':_0x497add,'sheetId':_0x4e2a8c,'range':_0x58d4fa,'id':_0x3b0ad6});this[_0x3c1df5(0xac)][_0x3c1df5(0xeb)](_0x383c74);}}[_0x5c1b2f(0x8b)](_0x3ba273,_0x334c4a){const _0x39231b=_0x5c1b2f,_0x218894=this[_0x39231b(0xc4)][_0x39231b(0x9f)](_0x3ba273);if(_0x218894){const _0x5262da=_0x218894['get'](_0x334c4a);if(_0x5262da){for(const _0x558574 of _0x5262da)this[_0x39231b(0xa3)](_0x558574),this[_0x39231b(0x6d)](_0x558574);_0x5262da[_0x39231b(0xd1)]();}}}[_0x5c1b2f(0xe9)](){const _0x3b8573=_0x5c1b2f;this[_0x3b8573(0xac)]['openKdTree']();}[_0x5c1b2f(0xb7)](){const _0x15bcbc=_0x5c1b2f;this[_0x15bcbc(0xac)][_0x15bcbc(0xb7)]();}[_0x5c1b2f(0x6d)](_0x29ed88){const _0x46c932=_0x5c1b2f;_0x29ed88!=null&&this['_allTreeMap'][_0x46c932(0xec)](_0x29ed88);}['_addAllTreeMap'](_0x4bc234){const _0x258a7d=_0x5c1b2f;var _0x1a2d86,_0x17c761;const _0x360326=_0x4bc234['rangeList'];let _0x21827e=this[_0x258a7d(0x94)][_0x258a7d(0x9f)](_0x4bc234['treeId']);for(let _0x826aa0=0x0;_0x826aa0<_0x360326[_0x258a7d(0xdd)];_0x826aa0++){const _0x572abd=_0x360326[_0x826aa0];let {unitId:_0x15bf3e,sheetId:_0x5be9e0,range:_0x207ae1}=_0x572abd;_0x21827e||(_0x21827e=new Map(),this['_allTreeMap'][_0x258a7d(0x7d)](_0x4bc234[_0x258a7d(0xe8)],_0x21827e)),_0x21827e[_0x258a7d(0xbe)](_0x15bf3e)||_0x21827e[_0x258a7d(0x7d)](_0x15bf3e,new Map());const _0x34d404=(_0x1a2d86=_0x21827e==null?void 0x0:_0x21827e[_0x258a7d(0x9f)](_0x15bf3e))==null?void 0x0:_0x1a2d86[_0x258a7d(0x9f)](_0x5be9e0);_0x34d404&&(_0x207ae1={'startRow':Math['min'](_0x207ae1['startRow'],_0x34d404[_0x258a7d(0xfb)]),'startColumn':Math[_0x258a7d(0x9a)](_0x207ae1[_0x258a7d(0xb9)],_0x34d404[_0x258a7d(0xb9)]),'endRow':Math['max'](_0x207ae1[_0x258a7d(0x89)],_0x34d404['endRow']),'endColumn':Math[_0x258a7d(0xf3)](_0x207ae1['endColumn'],_0x34d404['endColumn'])}),(_0x17c761=_0x21827e[_0x258a7d(0x9f)](_0x15bf3e))==null||_0x17c761[_0x258a7d(0x7d)](_0x5be9e0,_0x207ae1);}}}var pe=Object[_0x5c1b2f(0xab)],_e=(_0x4ab30c,_0x1e70f0,_0x4e26df,_0x151302)=>{for(var _0x46ccf1=_0x151302>0x1?void 0x0:_0x151302?pe(_0x1e70f0,_0x4e26df):_0x1e70f0,_0x2b5b01=_0x4ab30c['length']-0x1,_0x198f82;_0x2b5b01>=0x0;_0x2b5b01--)(_0x198f82=_0x4ab30c[_0x2b5b01])&&(_0x46ccf1=_0x198f82(_0x46ccf1)||_0x46ccf1);return _0x46ccf1;};const me=Number['parseInt'](0x690efbe9);let x=class extends _0xa2504a{['_initializeWithOverride'](){const _0x2be40e=_0x5c1b2f;var _0x49e00f,_0x34dbf5;this[_0x2be40e(0xcc)]()?(_0x49e00f=this['_config'])!=null&&_0x49e00f[_0x2be40e(0xfe)]||[[_0x1f4d6b,{'useClass':he}],[_0x316caf,{'useClass':fe}],[_0x2dbd8e,{'useClass':de}]][_0x2be40e(0x7c)](_0x2b8306=>this['_injector']['add'](_0x2b8306)):(_0x34dbf5=this[_0x2be40e(0x100)])!=null&&_0x34dbf5[_0x2be40e(0xfe)]||[[_0x1f4d6b,{'useClass':_0xc1818d}],[_0x316caf,{'useClass':_0x23bb35}],[_0x2dbd8e,{'useClass':_0x3e6f08}]][_0x2be40e(0x7c)](_0x550190=>this[_0x2be40e(0x97)]['add'](_0x550190));}[_0x5c1b2f(0xcc)](){const _0x21f02f=_0x5c1b2f;var _0xae47a1;const _0x40369e=(_0xae47a1=this['_configService'][_0x21f02f(0x9e)](_0x6f7d28))!=null?_0xae47a1:{},{ls:_0x340b01,pbk:_0x2405c6}=_0x40369e;if(!_0x340b01||!_0x2405c6)return!0x1;const _0x53bdb9=_0x3b01af(ue,le),_0x3fdd6c=new Function(_0x21f02f(0xfa)+_0x53bdb9)()(_0x340b01,_0x2405c6),_0x169f57=_0x3fdd6c[_0x21f02f(0x81)];return _0x3fdd6c[_0x21f02f(0x8a)]&&_0x39b096(_0x169f57,'sf',me)?_0x274de2(_0x169f57,!0x0,'a',!0x0,!0x1,!0x1):!0x1;}};x=_e([_0x3f7e80(_0x9a80c1)],x);export{x as UniverProFormulaEnginePlugin};