<template>
  <div class="spring-annotation-view">
    <v-container fluid class="pa-4">
      <!-- æ ‡é¢˜åŒºåŸŸ -->
      <v-card class="mb-4 title-card" elevation="0">
        <v-card-text class="text-center pa-6">
          <div class="text-h4 font-weight-bold mb-2">
            ğŸ·ï¸ Spring æ³¨è§£å®Œå…¨æŒ‡å—
          </div>
          <div class="text-subtitle-1 text-medium-emphasis">
            æŒæ¡è¿™äº›æ³¨è§£ï¼ŒSpring å¼€å‘äº‹åŠåŠŸå€ï¼ğŸš€
          </div>
        </v-card-text>
      </v-card>

      <v-row>
        <!-- å·¦ä¾§ï¼šæ³¨è§£åˆ†ç±» -->
        <v-col cols="12" md="4">
          <!-- Bean æ³¨å†Œæ³¨è§£ -->
          <v-card class="mb-4 annotation-card" elevation="2">
            <v-card-title class="d-flex align-center">
              <span class="text-h6">ğŸ“¦ Bean æ³¨å†Œæ³¨è§£</span>
            </v-card-title>
            <v-card-text>
              <v-tabs v-model="beanTab" color="primary" direction="vertical">
                <v-tab value="component">@Component</v-tab>
                <v-tab value="service">@Service</v-tab>
                <v-tab value="repository">@Repository</v-tab>
                <v-tab value="controller">@Controller</v-tab>
              </v-tabs>
              <v-window v-model="beanTab" class="mt-4">
                <v-window-item value="component">
                  <div class="annotation-detail">
                    <v-chip color="primary" size="small" class="mb-2">é€šç”¨ç»„ä»¶</v-chip>
                    <p class="text-body-2">æœ€åŸºç¡€çš„ Bean æ³¨å†Œæ³¨è§£</p>
                    <v-alert type="info" density="compact" class="mt-2">
                      å…¶ä»–æ³¨è§£éƒ½æ˜¯å®ƒçš„ç‰¹åŒ–ç‰ˆæœ¬
                    </v-alert>
                  </div>
                </v-window-item>
                <v-window-item value="service">
                  <div class="annotation-detail">
                    <v-chip color="success" size="small" class="mb-2">ä¸šåŠ¡å±‚</v-chip>
                    <p class="text-body-2">æ ‡è¯†æœåŠ¡å±‚ç»„ä»¶</p>
                    <v-alert type="success" density="compact" class="mt-2">
                      è¯­ä¹‰æ¸…æ™°ï¼Œæ¨èç”¨äº Service å±‚
                    </v-alert>
                  </div>
                </v-window-item>
                <v-window-item value="repository">
                  <div class="annotation-detail">
                    <v-chip color="warning" size="small" class="mb-2">æ•°æ®è®¿é—®å±‚</v-chip>
                    <p class="text-body-2">æ ‡è¯† DAO å±‚ç»„ä»¶</p>
                    <v-alert type="warning" density="compact" class="mt-2">
                      <strong>ç‰¹æ®ŠåŠŸèƒ½ï¼š</strong>è‡ªåŠ¨è½¬æ¢æ•°æ®è®¿é—®å¼‚å¸¸
                    </v-alert>
                  </div>
                </v-window-item>
                <v-window-item value="controller">
                  <div class="annotation-detail">
                    <v-chip color="info" size="small" class="mb-2">Web æ§åˆ¶å™¨</v-chip>
                    <p class="text-body-2">å¤„ç† HTTP è¯·æ±‚</p>
                    <v-alert type="info" density="compact" class="mt-2">
                      @RestController = @Controller + @ResponseBody
                    </v-alert>
                  </div>
                </v-window-item>
              </v-window>
            </v-card-text>
          </v-card>

          <!-- ä¾èµ–æ³¨å…¥æ³¨è§£ -->
          <v-card class="mb-4 annotation-card" elevation="2">
            <v-card-title class="d-flex align-center">
              <span class="text-h6">ğŸ’‰ ä¾èµ–æ³¨å…¥æ³¨è§£</span>
            </v-card-title>
            <v-card-text>
              <v-list density="compact">
                <v-list-item>
                  <template #prepend>
                    <v-icon color="primary">mdi-autorenew</v-icon>
                  </template>
                  <v-list-item-title><strong>@Autowired</strong></v-list-item-title>
                  <v-list-item-subtitle>Spring å®˜æ–¹ï¼ŒæŒ‰ç±»å‹ä¼˜å…ˆ</v-list-item-subtitle>
                </v-list-item>
                <v-list-item>
                  <template #prepend>
                    <v-icon color="success">mdi-package-variant</v-icon>
                  </template>
                  <v-list-item-title><strong>@Resource</strong></v-list-item-title>
                  <v-list-item-subtitle>JSR-250 æ ‡å‡†ï¼ŒæŒ‰åç§°ä¼˜å…ˆ</v-list-item-subtitle>
                </v-list-item>
              </v-list>
              <v-alert type="warning" density="compact" class="mt-3">
                <strong>âš ï¸ å­—æ®µæ³¨å…¥ä¸æ¨èï¼</strong><br/>
                æ¨èä½¿ç”¨æ„é€ å™¨æ³¨å…¥ï¼Œæ›´å®‰å…¨ã€æ›´æ˜“æµ‹è¯•
              </v-alert>
            </v-card-text>
          </v-card>
        </v-col>

        <!-- å³ä¾§ï¼šè¯¦ç»†å¯¹æ¯”å’Œç¤ºä¾‹ -->
        <v-col cols="12" md="8">
          <!-- Autowired vs Resource -->
          <v-card class="mb-4" elevation="2">
            <v-card-title>
              <v-icon color="primary" class="mr-2">mdi-compare</v-icon>
              <span>ğŸ” @Autowired vs @Resource</span>
            </v-card-title>
            <v-card-text>
              <v-table>
                <thead>
                  <tr>
                    <th>å¯¹æ¯”é¡¹</th>
                    <th>@Autowired</th>
                    <th>@Resource</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><strong>æ¥æº</strong></td>
                    <td>Spring æ¡†æ¶</td>
                    <td>JSR-250 æ ‡å‡†</td>
                  </tr>
                  <tr>
                    <td><strong>åŒ¹é…é¡ºåº</strong></td>
                    <td>ByType â†’ ByName</td>
                    <td>ByName â†’ ByType</td>
                  </tr>
                  <tr>
                    <td><strong>æ„é€ å™¨æ³¨å…¥</strong></td>
                    <td>âœ… æ”¯æŒ</td>
                    <td>âŒ ä¸æ”¯æŒ</td>
                  </tr>
                  <tr>
                    <td><strong>å¯é€‰ä¾èµ–</strong></td>
                    <td>âœ… required=false</td>
                    <td>âŒ å¿…é¡»å­˜åœ¨</td>
                  </tr>
                  <tr>
                    <td><strong>å®¹å™¨è¿ç§»</strong></td>
                    <td>âŒ ä»…é™ Spring</td>
                    <td>âœ… è·¨å®¹å™¨å…¼å®¹</td>
                  </tr>
                </tbody>
              </v-table>
            </v-card-text>
          </v-card>

          <!-- ä»£ç ç¤ºä¾‹ -->
          <v-card class="mb-4" elevation="2">
            <v-card-title>
              <v-icon color="primary" class="mr-2">mdi-code-tags</v-icon>
              <span>ğŸ’» ä»£ç ç¤ºä¾‹</span>
            </v-card-title>
            <v-card-text>
              <v-tabs v-model="exampleTab" color="primary">
                <v-tab value="bad">âŒ ä¸æ¨è</v-tab>
                <v-tab value="good">âœ… æ¨è</v-tab>
                <v-tab value="comparison">å¯¹æ¯”è¯´æ˜</v-tab>
              </v-tabs>
              <v-window v-model="exampleTab" class="mt-4">
                <v-window-item value="bad">
                  <pre class="code-block"><code>// âŒ å­—æ®µæ³¨å…¥ - ä¸æ¨è
@Service
public class UserService {
    @Autowired
    private UserDao userDao;  // éšè—ä¾èµ–
    
    @Autowired
    private OrderService orderService;
    
    // é—®é¢˜ï¼š
    // 1. ä¾èµ–ä¸æ˜¾å¼ï¼Œéš¾ä»¥å‘ç°
    // 2. æ— æ³•ä¿è¯ä¸å¯å˜æ€§
    // 3. ä¸åˆ©äºå•å…ƒæµ‹è¯•
    // 4. æ„é€ æ—¶å¯èƒ½ NPE
}</code></pre>
                </v-window-item>
                <v-window-item value="good">
                  <pre class="code-block"><code>// âœ… æ„é€ å™¨æ³¨å…¥ - æ¨è
@Service
public class UserService {
    private final UserDao userDao;
    private final OrderService orderService;
    
    // Spring 4.3+ å•æ„é€ å™¨å¯çœç•¥ @Autowired
    public UserService(
            UserDao userDao,
            OrderService orderService) {
        this.userDao = userDao;
        this.orderService = orderService;
    }
    
    // ä¼˜ç‚¹ï¼š
    // 1. ä¾èµ–æ˜¾å¼å£°æ˜
    // 2. final å­—æ®µï¼Œä¸å¯å˜
    // 3. ä¾¿äºå•å…ƒæµ‹è¯•
    // 4. æ„é€ æ—¶å³å®Œæˆæ³¨å…¥
}</code></pre>
                </v-window-item>
                <v-window-item value="comparison">
                  <div class="comparison-box">
                    <div class="comparison-item bad">
                      <div class="comparison-title">âŒ å­—æ®µæ³¨å…¥</div>
                      <ul>
                        <li>éšè—ä¾èµ–å…³ç³»</li>
                        <li>æ— æ³•ä¿è¯ä¸å¯å˜</li>
                        <li>å¿…é¡»ä¾èµ–å®¹å™¨æµ‹è¯•</li>
                        <li>æ„é€ æ—¶å¯èƒ½ NPE</li>
                      </ul>
                    </div>
                    <div class="comparison-item good">
                      <div class="comparison-title">âœ… æ„é€ å™¨æ³¨å…¥</div>
                      <ul>
                        <li>ä¾èµ–æ˜¾å¼å£°æ˜</li>
                        <li>final å­—æ®µï¼Œä¸å¯å˜</li>
                        <li>å¯ç›´æ¥ Mock æµ‹è¯•</li>
                        <li>æ„é€ æ—¶å³å®Œæˆæ³¨å…¥</li>
                      </ul>
                    </div>
                  </div>
                </v-window-item>
              </v-window>
            </v-card-text>
          </v-card>

          <!-- æ³¨è§£åŒºåˆ«è¯¦è§£ -->
          <v-card class="mb-4" elevation="2">
            <v-card-title>
              <v-icon color="primary" class="mr-2">mdi-help-circle</v-icon>
              <span>ğŸ¤” å¸¸è§é—®é¢˜</span>
            </v-card-title>
            <v-card-text>
              <v-expansion-panels>
                <v-expansion-panel
                  v-for="(qa, idx) in commonQuestions"
                  :key="idx"
                  :title="qa.question"
                >
                  <v-expansion-panel-text>
                    <div class="text-body-2">
                      <strong>ğŸ’¡ ç­”æ¡ˆï¼š</strong>{{ qa.answer }}
                    </div>
                  </v-expansion-panel-text>
                </v-expansion-panel>
              </v-expansion-panels>
            </v-card-text>
          </v-card>

          <!-- æœ€ä½³å®è·µ -->
          <v-card elevation="2">
            <v-card-title>
              <v-icon color="success" class="mr-2">mdi-star</v-icon>
              <span>â­ æœ€ä½³å®è·µ</span>
            </v-card-title>
            <v-card-text>
              <v-list>
                <v-list-item
                  v-for="(tip, idx) in bestPractices"
                  :key="idx"
                  :prepend-icon="tip.icon"
                >
                  <v-list-item-title>{{ tip.text }}</v-list-item-title>
                </v-list-item>
              </v-list>
            </v-card-text>
          </v-card>
        </v-col>
      </v-row>
    </v-container>
  </div>
</template>

<script setup lang="ts">
import { ref } from 'vue';

const beanTab = ref('component');
const exampleTab = ref('bad');

const commonQuestions = ref([
  {
    question: 'ğŸ¤” @Service å’Œ @Component æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ',
    answer: 'æœ¬è´¨ä¸Šéƒ½æ˜¯ @Component çš„ç‰¹åŒ–ï¼Œ@Service åªæ˜¯è¯­ä¹‰æ ‡è¯†ï¼ŒåŠŸèƒ½ä¸Šå‡ ä¹ä¸€è‡´ã€‚ä½†ä½¿ç”¨ @Service èƒ½è®©ä»£ç åˆ†å±‚æ›´æ¸…æ™°ï¼Œä¾¿äºç»´æŠ¤å’Œç†è§£ã€‚',
  },
  {
    question: 'ğŸ¤” @Repository æœ‰ä»€ä¹ˆç‰¹æ®ŠåŠŸèƒ½ï¼Ÿ',
    answer: '@Repository ä¼šè‡ªåŠ¨è½¬æ¢æ•°æ®è®¿é—®å¼‚å¸¸ï¼Œå°†åº•å±‚å¼‚å¸¸ï¼ˆå¦‚ SQLExceptionï¼‰è½¬æ¢ä¸º Spring çš„ DataAccessExceptionï¼Œè¿™æ˜¯å®ƒä¸å…¶ä»–æ³¨è§£çš„å”¯ä¸€åŠŸèƒ½å·®å¼‚ã€‚',
  },
  {
    question: 'ğŸ¤” ä¸ºä»€ä¹ˆå­—æ®µæ³¨å…¥ä¸æ¨èï¼Ÿ',
    answer: 'å­—æ®µæ³¨å…¥éšè—ä¾èµ–ã€æ— æ³•ä¿è¯ä¸å¯å˜æ€§ã€ä¸åˆ©äºæµ‹è¯•ã€æ„é€ æ—¶å¯èƒ½ NPEã€‚æ„é€ å™¨æ³¨å…¥èƒ½æ˜¾å¼å£°æ˜ä¾èµ–ã€æ”¯æŒ final å­—æ®µã€ä¾¿äº Mock æµ‹è¯•ï¼Œæ˜¯ä¸šç•Œæœ€ä½³å®è·µã€‚',
  },
  {
    question: 'ğŸ¤” @Autowired å’Œ @Resource é€‰å“ªä¸ªï¼Ÿ',
    answer: 'æ¨èä½¿ç”¨ @Autowiredï¼ˆæˆ–æ„é€ å™¨æ³¨å…¥ï¼ŒSpring 4.3+ å¯çœç•¥æ³¨è§£ï¼‰ã€‚@Resource é€‚åˆéœ€è¦è·¨å®¹å™¨å…¼å®¹çš„åœºæ™¯ï¼Œä½†åŠŸèƒ½è¾ƒå¼±ï¼Œä¸æ”¯æŒæ„é€ å™¨æ³¨å…¥ã€‚',
  },
]);

const bestPractices = ref([
  {
    icon: 'mdi-check-circle',
    text: 'ğŸ¯ ä¼˜å…ˆä½¿ç”¨æ„é€ å™¨æ³¨å…¥ï¼Œé¿å…å­—æ®µæ³¨å…¥',
  },
  {
    icon: 'mdi-check-circle',
    text: 'ğŸ“ ä½¿ç”¨ @Serviceã€@Repository ç­‰è¯­ä¹‰æ³¨è§£ï¼Œè®©ä»£ç æ›´æ¸…æ™°',
  },
  {
    icon: 'mdi-check-circle',
    text: 'âœ… Spring 4.3+ å•æ„é€ å™¨å¯çœç•¥ @Autowired',
  },
  {
    icon: 'mdi-check-circle',
    text: 'ğŸ”’ ä½¿ç”¨ final å­—æ®µ + æ„é€ å™¨æ³¨å…¥ï¼Œä¿è¯ä¸å¯å˜æ€§',
  },
  {
    icon: 'mdi-check-circle',
    text: 'âš¡ å¯é€‰ä¾èµ–ä½¿ç”¨ @Autowired(required=false) æˆ– setter æ³¨å…¥',
  },
]);
</script>

<style scoped lang="scss">
.spring-annotation-view {
  background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
  min-height: 100vh;
  padding: 20px 0;
}

.title-card {
  background: rgba(255, 255, 255, 0.95) !important;
  border-radius: 20px !important;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1) !important;
}

.annotation-card {
  border-radius: 16px;
  transition: transform 0.3s ease;
  
  &:hover {
    transform: translateY(-4px);
  }
}

.annotation-detail {
  min-height: 100px;
}

.code-block {
  background: #263238;
  color: #aed581;
  padding: 20px;
  border-radius: 8px;
  overflow-x: auto;
  font-family: 'Courier New', monospace;
  font-size: 13px;
  line-height: 1.6;
  margin: 0;
}

.comparison-box {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 20px;
  
  .comparison-item {
    padding: 16px;
    border-radius: 12px;
    
    &.bad {
      background: #ffebee;
      border-left: 4px solid #f44336;
    }
    
    &.good {
      background: #e8f5e9;
      border-left: 4px solid #4caf50;
    }
    
    .comparison-title {
      font-weight: bold;
      font-size: 16px;
      margin-bottom: 12px;
    }
    
    ul {
      margin: 0;
      padding-left: 20px;
      
      li {
        margin-bottom: 8px;
        font-size: 14px;
      }
    }
  }
}

@media (max-width: 960px) {
  .comparison-box {
    grid-template-columns: 1fr;
  }
}
</style>

