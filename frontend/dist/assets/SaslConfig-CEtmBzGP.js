import{k as g,m as ae,d as Wl,u as Zl,w as ze,_ as Jl,p as b,o as v,e as a,b as n,Q as l,F as T,q as A,f as s,V as x,g as u,j as C,l as je,i as Oe,t as fe,aZ as Ke,a_ as Xe,c as S,v as ge,a0 as Z,x as f,y as qe,aU as Ge,aM as Se,a9 as Ae,aQ as We,n as ml,X as Ql,O as pl}from"./index-mJOBftNs.js";import{c as Kl,b as Xl,d as Hl,e as Yl,s as et,f as lt,h as tt,i as at,l as st,j as nt,r as ot,k as it,m as rt,n as dt,o as ut,p as ct,q as mt,t as pt,v as vt,w as ft}from"./saslConfigApi-CCPBd-Wj.js";import{V as ye,a as te}from"./VRow-C6N6h8s9.js";import{V as Ze}from"./VSheet-DbNfniB_.js";import{V as Ie,a as Re,b as Ee,c as He}from"./VCard-DFIDGoOa.js";import{V as Je}from"./VForm-BTvn18MX.js";import{V as B}from"./VTextField-tFIcna6m.js";import{V as gt}from"./VFileInput-DBMVcNlc.js";import{V as Ye}from"./VSelect-CO5xudFf.js";import{V as el}from"./VCheckbox-cGVzKUF_.js";import{V as P}from"./VAlert-CfJUBCCM.js";import{V as ll}from"./VTable-BPBhndI2.js";import{V as J}from"./VTooltip-D0sJ_MCh.js";import{V as yt,a as bt,b as wt,c as ht}from"./VTabs-BYSgCciz.js";import{V as Qe}from"./VTextarea-34QBZFhW.js";import{V as tl}from"./VDialog-C4Wnh1zS.js";import{_ as xt}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Vt=()=>{const o=g(!1),m=g(!1),be=g(!1),U=g(null),$=g([]),O=g(!1),I=g({title:"",description:"",remark:""}),we=g([]),he=g(!1),se=g({username:"",password:"",displayName:"",email:"",mobile:"",enabled:!0,superAdmin:!1,deptCodes:["sasl"]}),Y=g([]),L=g(null),Ue=g(null),ce=g([]),z=g(!1),q=g([]),D=g(!1),Q=g(null),xe=g(null),K=g(!1),k=g({planId:"",title:"",subtitle:"",columns:[],rows:[],footnote:""}),ke=g([]),Pe=g(!1),me=g(null),y=g(null),ne=g([]),ee=g([]),j=g(!1),oe=g(null),r=g({content:""}),d=ae(()=>[{label:"已上傳文件",value:$.value.length.toString(),trend:"",tone:"up",icon:"mdi-file-excel"},{label:"用戶數量",value:we.value.length.toString(),trend:"",tone:"up",icon:"mdi-account-multiple"},{label:"綁定關係",value:Y.value.length.toString(),trend:"",tone:"up",icon:"mdi-link-variant"}]),p=ae(()=>new Set(Y.value.map(N=>N.fileId))),w=ae(()=>new Set(Y.value.map(N=>N.userId))),h=ae(()=>$.value.filter(N=>!p.value.has(N.id))),_=ae(()=>we.value.filter(N=>!w.value.has(N.id)));return{loading:o,uploading:m,binding:be,uploadFile:U,excelFiles:$,users:we,fileUserBindings:Y,selectedFileId:L,selectedUserId:Ue,heroStats:d,boundFileIds:p,boundUserIds:w,unboundFiles:h,unboundUsers:_,getBindingByFileId:N=>Y.value.find(De=>De.fileId===N),getBindingByUserId:N=>Y.value.find(De=>De.userId===N),uploadDialogVisible:O,uploadForm:I,resetUploadForm:()=>{I.value={title:"",description:"",remark:""}},registering:he,userForm:se,resetUserForm:()=>{se.value={username:"",password:"",displayName:"",email:"",mobile:"",enabled:!0,superAdmin:!1,deptCodes:["sasl"]}},userDocumentTitles:ce,loadingUserDocumentTitles:z,planSections:q,loadingPlanSections:D,selectedPlanSectionId:Q,selectedPlanSection:xe,editingPlanSection:K,planSectionEditForm:k,documentGroups:ke,loadingDocuments:Pe,selectedImportRecord:me,selectedDocumentTitle:y,documentRecords:ne,announcements:ee,loadingAnnouncements:j,editingAnnouncement:oe,announcementEditForm:r}},Ct=(o,m)=>{const be=r=>{const d=r.replace(/\.[^/.]+$/,"");return/^[A-Za-z0-9\u4e00-\u9fa5]+$/.test(d)},U=r=>r?r.length<3?"用戶名長度至少為3位":r.length>30?"用戶名長度不能超過30位":/^[A-Za-z0-9]+$/.test(r)?null:"用戶名只能包含數字和字母":"用戶名為必填項",$=(r,d)=>r?r.length<8?"密碼長度至少為8位":r.length>32?"密碼長度不能超過32位":/[A-Z]/.test(r)?/[a-z]/.test(r)?/[0-9]/.test(r)?/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(r)?d&&r.toLowerCase()===d.toLowerCase()?"密碼不能與用戶名相同":null:"密碼必須包含至少一個特殊字符（如 !@#$%^&* 等）":"密碼必須包含至少一個數字":"密碼必須包含至少一個小寫字母":"密碼必須包含至少一個大寫字母":"密碼為必填項",O=async()=>{o.loading.value=!0;try{const r=await mt();o.users.value=r}catch(r){console.error("加载用户列表失败",r),m.show({message:"加载用户列表失败，请稍后重试",color:"error"})}finally{o.loading.value=!1}},I=async()=>{o.loading.value=!0;try{const r=await ct();o.fileUserBindings.value=r.map(d=>({id:d.id,fileId:0,fileName:d.fileName,userId:d.userId,userName:d.userName,bindTime:d.bindTime}))}catch(r){console.error("加载绑定列表失败",r),m.show({message:"加载绑定列表失败，请稍后重试",color:"error"})}finally{o.loading.value=!1}},we=async()=>{o.loading.value=!0;try{await Promise.all([O(),I()])}finally{o.loading.value=!1}},he=()=>{if(!o.uploadFile.value)return m.show({message:"请选择要上传的Excel文件",color:"warning"}),!1;const r=o.uploadFile.value.name.toLowerCase();if(!r.endsWith(".xls")&&!r.endsWith(".xlsx"))return m.show({message:"请上传Excel文件（.xls 或 .xlsx）",color:"warning"}),!1;const d=o.uploadFile.value.name;return be(d)?(o.uploadDialogVisible.value=!0,!0):(m.show({message:"文件名只能包含数字、字母和中文字符，不能包含特殊符号",color:"warning"}),!1)},se=async()=>{if(!o.uploadFile.value){m.show({message:"请选择要上传的Excel文件",color:"warning"});return}const r=o.uploadForm.value.title.trim();if(!r){m.show({message:"请输入文档标题",color:"warning"});return}o.uploading.value=!0;try{const d=new FormData;d.append("file",o.uploadFile.value),d.append("documentTitle",r),o.uploadForm.value.description.trim()&&d.append("documentDescription",o.uploadForm.value.description.trim()),o.uploadForm.value.remark.trim()&&d.append("remark",o.uploadForm.value.remark.trim());const p=await ut(d);m.show({message:`Excel文件导入成功，共导入 ${p.count} 条记录`,color:"success"}),o.uploadDialogVisible.value=!1,o.uploadFile.value=null,o.resetUploadForm()}catch(d){console.error("上传Excel文件失败",d);let p="上传失败，请稍后重试";d!=null&&d.payload&&typeof d.payload=="object"&&"message"in d.payload&&(p=String(d.payload.message)),m.show({message:p,color:"error"})}finally{o.uploading.value=!1}},Y=()=>{o.uploadDialogVisible.value=!1,o.resetUploadForm()},L=async()=>{if(!o.selectedFileId.value){m.show({message:"请选择要绑定的文件",color:"warning"});return}if(!o.selectedUserId.value){m.show({message:"请选择要绑定的用户",color:"warning"});return}if(o.fileUserBindings.value.find(d=>d.fileId===o.selectedFileId.value&&d.userId===o.selectedUserId.value)){m.show({message:"该文件和用户已经绑定",color:"warning"});return}o.binding.value=!0;try{await dt({fileId:o.selectedFileId.value,userId:o.selectedUserId.value}),m.show({message:"绑定成功",color:"success"}),o.selectedFileId.value=null,o.selectedUserId.value=null,await I()}catch(d){console.error("绑定失败",d),m.show({message:"绑定失败，请稍后重试",color:"error"})}finally{o.binding.value=!1}},Ue=async r=>{try{await it(r),m.show({message:"删除绑定成功",color:"success"}),await I()}catch(d){console.error("删除绑定失败",d),m.show({message:"删除绑定失败，请稍后重试",color:"error"})}},ce=async()=>{const r=o.userForm.value.username.trim(),d=U(r);if(d){m.show({message:d,color:"warning"});return}const p=o.userForm.value.password.trim();if(!p){m.show({message:"請輸入密碼",color:"warning"});return}const w=$(p,r);if(w){m.show({message:w,color:"warning"});return}o.registering.value=!0;try{const h={username:r,password:p};o.userForm.value.displayName.trim()&&(h.displayName=o.userForm.value.displayName.trim()),o.userForm.value.email.trim()&&(h.email=o.userForm.value.email.trim()),o.userForm.value.mobile.trim()&&(h.mobile=o.userForm.value.mobile.trim()),h.enabled=!0,h.superAdmin=!1,h.deptCodes=o.userForm.value.deptCodes||["sasl"],await ot(h),m.show({message:"用户创建成功",color:"success"}),o.resetUserForm(),await O()}catch(h){console.error("注册用户失败",h);let _="注册用户失败，请稍后重试";h!=null&&h.message?_=h.message:h!=null&&h.payload&&typeof h.payload=="object"&&"message"in h.payload&&(_=String(h.payload.message)),m.show({message:_,color:"error"})}finally{o.registering.value=!1}},z=async r=>{if(!r){o.userDocumentTitles.value=[];return}o.loadingUserDocumentTitles.value=!0;try{const d=await nt(r);o.userDocumentTitles.value=d}catch(d){console.error("加载用户文件清单失败",d),m.show({message:"加载用户文件清单失败，请稍后重试",color:"error"}),o.userDocumentTitles.value=[]}finally{o.loadingUserDocumentTitles.value=!1}},q=async(r,d)=>{if(!o.selectedUserId.value){m.show({message:"请选择要绑定的用户",color:"warning"});return}if(r.length===0){m.show({message:"请选择要绑定的文档标题",color:"warning"});return}const p=r.map(w=>{const h=d.find(_=>_.id===w);return h==null?void 0:h.documentTitle}).filter(w=>!!w);if(p.length===0){m.show({message:"请至少选择一个文档标题",color:"warning"});return}o.binding.value=!0;try{await rt({userId:o.selectedUserId.value,documentTitles:p});const w=o.userDocumentTitles.value.filter(X=>X.selected).map(X=>X.title),h=new Set(p),_=p.filter(X=>!w.includes(X)).length,pe=w.filter(X=>!h.has(X)).length;let ie="";_>0&&pe>0?ie=`成功绑定 ${_} 个，解绑 ${pe} 个文档标题`:_>0?ie=`成功绑定 ${_} 个文档标题`:pe>0?ie=`成功解绑 ${pe} 个文档标题`:ie=`已更新 ${p.length} 个文档标题绑定关系`,m.show({message:ie,color:"success"}),await z(o.selectedUserId.value),await I()}catch(w){console.error("绑定失败",w);let h="绑定失败，请稍后重试";w!=null&&w.payload&&typeof w.payload=="object"&&"message"in w.payload&&(h=String(w.payload.message)),m.show({message:h,color:"error"})}finally{o.binding.value=!1}},D=async()=>{o.loadingPlanSections.value=!0;try{const r=await st();o.planSections.value=r}catch(r){console.error("加载套餐方案失败",r),m.show({message:"加载套餐方案失败，请稍后重试",color:"error"}),o.planSections.value=[]}finally{o.loadingPlanSections.value=!1}},Q=async r=>{o.loadingPlanSections.value=!0;try{const d=await at(r);return o.selectedPlanSection.value=d,d}catch(d){console.error("加载套餐方案详情失败",d);let p="加载套餐方案详情失败，请稍后重试";return d!=null&&d.payload&&typeof d.payload=="object"&&"message"in d.payload&&(p=String(d.payload.message)),m.show({message:p,color:"error"}),null}finally{o.loadingPlanSections.value=!1}},xe=async r=>{o.selectedPlanSectionId.value=r;const d=await Q(r);d&&(o.planSectionEditForm.value={planId:d.planId,title:d.title,subtitle:d.subtitle||"",columns:[...d.columns],rows:d.rows.map(p=>({label:p.label,values:[...p.values],sortOrder:p.sortOrder})),footnote:d.footnote||""},o.editingPlanSection.value=!0)},K=()=>{o.editingPlanSection.value=!1,o.selectedPlanSectionId.value=null,o.selectedPlanSection.value=null,o.planSectionEditForm.value={planId:"",title:"",subtitle:"",columns:[],rows:[],footnote:""}},k=async()=>{if(!o.selectedPlanSectionId.value){m.show({message:"请选择要更新的套餐方案",color:"warning"});return}const r=o.planSectionEditForm.value;if(!r.planId.trim()||!r.title.trim()){m.show({message:"套餐ID和标题为必填项",color:"warning"});return}if(r.columns.length===0){m.show({message:"请至少添加一列",color:"warning"});return}if(r.rows.length===0){m.show({message:"请至少添加一行数据",color:"warning"});return}const d=r.columns.length;for(const p of r.rows)if(p.values.length!==d){m.show({message:`行"${p.label}"的值数量必须等于列数量(${d})`,color:"warning"});return}o.loadingPlanSections.value=!0;try{const p={planId:r.planId.trim(),title:r.title.trim(),subtitle:r.subtitle.trim()||void 0,columns:r.columns.map(w=>w.trim()).filter(w=>w),rows:r.rows.map((w,h)=>({label:w.label.trim(),values:w.values.map(_=>_.trim()),sortOrder:w.sortOrder??h})),footnote:r.footnote.trim()||void 0};await tt(o.selectedPlanSectionId.value,p),m.show({message:"套餐方案更新成功",color:"success"}),K(),await D()}catch(p){console.error("更新套餐方案失败",p);let w="更新套餐方案失败，请稍后重试";p!=null&&p.payload&&typeof p.payload=="object"&&"message"in p.payload&&(w=String(p.payload.message)),m.show({message:w,color:"error"})}finally{o.loadingPlanSections.value=!1}},ke=async()=>{o.loadingDocuments.value=!0;try{const r=await lt();o.documentGroups.value=r}catch(r){console.error("加载文档清单失败",r),m.show({message:"加载文档清单失败，请稍后重试",color:"error"}),o.documentGroups.value=[]}finally{o.loadingDocuments.value=!1}},Pe=async(r,d)=>{if(!r||!r.trim()){m.show({message:"文档标题不能为空",color:"warning"});return}o.loadingDocuments.value=!0;try{const p=await et({documentTitle:r.trim()});o.selectedImportRecord.value=d.length>0?d[0]:null,o.selectedDocumentTitle.value=r.trim(),o.documentRecords.value=p,m.show({message:"文档数据加载成功",color:"success"})}catch(p){console.error("加载文档数据失败",p);let w="加载文档数据失败，请稍后重试";p!=null&&p.payload&&typeof p.payload=="object"&&"message"in p.payload&&(w=String(p.payload.message)),m.show({message:w,color:"error"}),o.selectedImportRecord.value=null,o.selectedDocumentTitle.value=null,o.documentRecords.value=[]}finally{o.loadingDocuments.value=!1}},me=async r=>{if(!r||!r.trim()){m.show({message:"文档标题不能为空",color:"warning"});return}o.loadingDocuments.value=!0;try{await Yl(r.trim()),m.show({message:`已成功删除文档标题 "${r.trim()}" 的所有记录`,color:"success"}),await ke(),o.selectedDocumentTitle.value===r.trim()&&(o.selectedImportRecord.value=null,o.selectedDocumentTitle.value=null,o.documentRecords.value=[])}catch(d){console.error("删除记录失败",d);let p="删除记录失败，请稍后重试";d!=null&&d.payload&&typeof d.payload=="object"&&"message"in d.payload&&(p=String(d.payload.message)),m.show({message:p,color:"error"})}finally{o.loadingDocuments.value=!1}},y=async r=>{if(!r){m.show({message:"请选择要删除的用户",color:"warning"});return}o.loading.value=!0;try{await Hl(r),m.show({message:"已成功删除用户的 sasl 部门编码",color:"success"}),await O(),o.selectedUserId.value===r&&(o.selectedUserId.value=null,o.userDocumentTitles.value=[])}catch(d){console.error("删除用户部门编码失败",d);let p="删除用户部门编码失败，请稍后重试";d!=null&&d.payload&&typeof d.payload=="object"&&"message"in d.payload&&(p=String(d.payload.message)),m.show({message:p,color:"error"})}finally{o.loading.value=!1}},ne=async()=>{o.loadingAnnouncements.value=!0;try{const r=await Xl();o.announcements.value=r}catch(r){console.error("加载公告列表失败",r),m.show({message:"加载公告列表失败，请稍后重试",color:"error"}),o.announcements.value=[]}finally{o.loadingAnnouncements.value=!1}},ee=r=>{o.editingAnnouncement.value=r,o.announcementEditForm.value={content:r.content||""}},j=()=>{o.editingAnnouncement.value=null,o.announcementEditForm.value={content:""}};return{loadUsers:O,loadFileUserBindings:I,loadAllData:we,validateAndOpenUploadDialog:he,handleUploadExcel:se,closeUploadDialog:Y,handleBindFileToUser:L,handleBindDocumentTitlesToUser:q,handleDeleteBinding:Ue,handleRegisterUser:ce,loadUserDocumentTitles:z,loadPlanSections:D,loadPlanSectionById:Q,openEditPlanSectionDialog:xe,closeEditPlanSectionDialog:K,handleUpdatePlanSection:k,loadDocuments:ke,loadDocumentData:Pe,handleDeleteDocument:me,handleDeleteDepartmentUser:y,loadAnnouncements:ne,openEditAnnouncementDialog:ee,closeEditAnnouncementDialog:j,handleUpdateAnnouncement:async()=>{if(!o.editingAnnouncement.value){m.show({message:"请选择要更新的公告",color:"warning"});return}const r=o.announcementEditForm.value.content.trim();if(!r){m.show({message:"公告内容不能为空",color:"warning"});return}o.loadingAnnouncements.value=!0;try{const d={content:r};await Kl(o.editingAnnouncement.value.id,d),m.show({message:"公告更新成功",color:"success"}),j(),await ne()}catch(d){console.error("更新公告失败",d);let p="更新公告失败，请稍后重试";d!=null&&d.payload&&typeof d.payload=="object"&&"message"in d.payload&&(p=String(d.payload.message)),m.show({message:p,color:"error"})}finally{o.loadingAnnouncements.value=!1}}}},St={class:"sasl-form apple-surface"},Ut={class:"stat-icon"},kt={class:"stat-content"},Dt={class:"stat-label"},Ft={class:"stat-value"},_t={class:"title-icon"},Tt={class:"search-panel-title"},At={class:"title-icon"},It={class:"search-panel-title"},Rt={class:"mt-4"},Et={class:"search-panel-title"},Pt={class:"mt-4"},$t={class:"plan-section-surface"},Bt={class:"plan-section-header section-title d-flex align-center"},Lt={class:"title-icon soft"},Nt={key:0,class:"text-center py-8"},Mt={class:"d-flex align-center"},zt={class:"d-flex align-center"},jt={class:"plan-section-surface"},Ot={class:"plan-section-header section-title d-flex align-center"},qt={class:"title-icon soft"},Gt={key:0,class:"text-center py-8"},Wt={key:1,class:"document-groups-container"},Zt={class:"document-group-header"},Jt={class:"d-flex align-center justify-space-between"},Qt={class:"d-flex align-center"},Kt=["onClick"],Xt={class:"text-caption text-light-emphasis"},Ht={class:"d-flex gap-1 justify-end"},Yt={class:"d-flex align-center"},ea={key:3,class:"mt-6"},la={class:"document-data-section"},ta={class:"d-flex align-center justify-space-between mb-4"},aa={class:"text-h6"},sa={class:"text-caption text-light-emphasis mt-1"},na={key:0},oa={class:"document-table-wrapper"},ia={class:"text-caption text-light-emphasis mb-4"},ra={class:"table-container"},da={class:"document-data-table"},ua={class:"plan-section-surface"},ca={class:"plan-section-header section-title d-flex align-center"},ma={class:"title-icon soft"},pa={key:0,class:"text-center py-8"},va={class:"announcement-content"},fa={class:"plan-section-surface"},ga={class:"plan-section-header section-title d-flex align-center"},ya={class:"title-icon soft"},ba={key:0,class:"text-center py-8"},wa={key:1},ha={class:"plan-tab-title"},xa={class:"panel-title"},Va={class:"panel-title-text"},Ca={class:"panel-title-label"},Sa={class:"panel-title-sub"},Ua={class:"plan-matrix-wrapper"},ka={class:"plan-matrix"},Da={key:0,class:"plan-footnote"},Fa={class:"plan-section-surface"},_a={class:"plan-section-header section-title d-flex align-center"},Ta={class:"title-icon soft"},Aa={key:0,class:"text-center py-8"},Ia={key:1,class:"lead-transfer-container"},Ra={class:"mb-4"},Ea={class:"transfer-wrapper"},Pa={class:"transfer-panel"},$a={class:"transfer-panel-header"},Ba={class:"d-flex align-center"},La={class:"transfer-panel-content"},Na={class:"d-flex flex-column"},Ma={class:"text-caption text-light-emphasis mt-1"},za={class:"text-caption text-light-emphasis mt-1"},ja={class:"transfer-actions"},Oa={class:"transfer-panel"},qa={class:"transfer-panel-header"},Ga={class:"d-flex align-center"},Wa={class:"transfer-panel-content"},Za={class:"d-flex flex-column"},Ja={class:"text-caption text-light-emphasis mt-1"},Qa={class:"text-caption text-light-emphasis mt-1"},Ka={class:"mt-4 d-flex justify-end"},Xa={class:"mb-4"},Ha={class:"d-flex align-center justify-space-between mb-2"},Ya={class:"d-flex align-center justify-space-between mb-2"},es={class:"d-flex align-center justify-space-between mb-2"},ls={class:"text-subtitle-1"},ts={class:"d-flex flex-wrap gap-2 mb-2"},as="/api/sasl/config",ss=Wl({__name:"SaslConfig",setup(o){const m=Zl(),be=Vt(),{loading:U,uploading:$,binding:O,uploadFile:I,excelFiles:we,users:he,fileUserBindings:se,selectedFileId:Y,selectedUserId:L,heroStats:Ue,uploadDialogVisible:ce,uploadForm:z,registering:q,userForm:D,userDocumentTitles:Q,loadingUserDocumentTitles:xe,planSections:K,loadingPlanSections:k,selectedPlanSectionId:ke,selectedPlanSection:Pe,editingPlanSection:me,planSectionEditForm:y,documentGroups:ne,loadingDocuments:ee,selectedImportRecord:j,selectedDocumentTitle:oe,documentRecords:r,announcements:d,loadingAnnouncements:p,editingAnnouncement:w,announcementEditForm:h}=be,{validateAndOpenUploadDialog:_,handleUploadExcel:pe,closeUploadDialog:ie,handleBindDocumentTitlesToUser:X,handleDeleteBinding:al,loadAllData:N,handleRegisterUser:De,loadUserDocumentTitles:vl,loadPlanSections:fl,openEditPlanSectionDialog:gl,closeEditPlanSectionDialog:yl,handleUpdatePlanSection:bl,loadDocuments:sl,handleDeleteDocument:wl,handleDeleteDepartmentUser:hl,loadAnnouncements:nl,openEditAnnouncementDialog:xl,closeEditAnnouncementDialog:ol,handleUpdateAnnouncement:Vl}=Ct(be,m),Cl=g(),Sl=g(),Ul=g(),kl=g(),$e=g(!1),Be=g(!1),R=g([]),Ve=g(""),Fe=g(!1),le=g(!1),M=g([]),F=g([]),H=g([]),G=g([]),_e=g(null),Le=g(""),Ne=g(""),il=ae({get:()=>w.value!==null,set:i=>{i||ol()}}),Me=ae(()=>!L.value||Q.value.length===0?[]:Q.value.map((i,e)=>({id:L.value*1e4+e,fileName:i.title,originalFileName:i.title,fileSize:0,uploadTime:new Date().toISOString(),documentTitle:i.title,selected:i.selected}))),Dl=[i=>!!i||"用戶名為必填項",i=>i?i.length<3?"用戶名長度至少為3位":i.length>30?"用戶名長度不能超過30位":/^[A-Za-z0-9]+$/.test(i)?!0:"用戶名只能包含數字和字母":!0],Fl=[i=>!!i||"密碼為必填項",i=>i?i.length<8?"密碼長度至少為8位":i.length>32?"密碼長度不能超過32位":/[A-Z]/.test(i)?/[a-z]/.test(i)?/[0-9]/.test(i)?/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(i)?D.value.username&&i.toLowerCase()===D.value.username.toLowerCase()?"密碼不能與用戶名相同":!0:"密碼必須包含至少一個特殊字符（如 !@#$%^&* 等）":"密碼必須包含至少一個數字":"密碼必須包含至少一個小寫字母":"密碼必須包含至少一個大寫字母":!0],_l=i=>{if(i===0)return"0 B";const e=1024,t=["B","KB","MB","GB"],c=Math.floor(Math.log(i)/Math.log(e));return`${(i/Math.pow(e,c)).toFixed(2)} ${t[c]}`},re=i=>{const e=new Date(i);return new Intl.DateTimeFormat("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}).format(e)},Tl=i=>{if(Array.isArray(i)){I.value=i[0]??null;return}I.value=i},Al=()=>{_()},Il=(i,e,t)=>{if(e)R.value.includes(i)||R.value.push(i);else{const c=R.value.indexOf(i);c>-1&&R.value.splice(c,1)}},Rl=i=>{y.value.columns.length<=1||(y.value.columns.splice(i,1),y.value.rows.forEach(e=>{e.values.length>i&&e.values.splice(i,1)}))},El=()=>{if(y.value.columns.length===0){m.show({message:"請先添加列",color:"warning"});return}y.value.rows.push({label:"",values:new Array(y.value.columns.length).fill(""),sortOrder:y.value.rows.length})},Pl=()=>{j.value=null,oe.value=null,r.value=[]},$l=async(i,e)=>{if(!i||!i.trim()){m.show({message:"文档标题不能为空",color:"warning"});return}ee.value=!0;try{const t=await ft(i.trim());j.value=e.length>0?e[0]:null,oe.value=i.trim(),r.value=t,m.show({message:"文档数据加载成功",color:"success"})}catch(t){console.error("加载文档数据失败",t);let c="加载文档数据失败，请稍后重试";t!=null&&t.payload&&typeof t.payload=="object"&&"message"in t.payload&&(c=String(t.payload.message)),m.show({message:c,color:"error"}),j.value=null,oe.value=null,r.value=[]}finally{ee.value=!1}},Bl=async i=>{if(!i||!i.trim()){m.show({message:"文档标题不能为空",color:"warning"});return}Be.value=!0;try{const e=new URL(`${as}/records/export`,window.location.origin);e.searchParams.set("documentTitle",i.trim());const t=await fetch(e.toString(),{method:"GET",headers:{Accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/octet-stream"}});if(!t.ok){const de=await t.json().catch(()=>({message:"导出失败"}));throw new Error(de.message||"导出失败")}const c=await t.blob(),V=t.headers.get("Content-Disposition");let E=`SASL_${i.trim()}_${new Date().getTime()}.xlsx`;if(V){const de=V.match(/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/);de&&de[1]&&(E=de[1].replace(/['"]/g,""),E.startsWith("UTF-8''")&&(E=decodeURIComponent(E.substring(7))))}const Ce=window.URL.createObjectURL(c),ve=document.createElement("a");ve.href=Ce,ve.download=E,document.body.appendChild(ve),ve.click(),document.body.removeChild(ve),window.URL.revokeObjectURL(Ce),m.show({message:"导出成功",color:"success"})}catch(e){console.error("导出失败",e);const t=(e==null?void 0:e.message)||"导出失败，请稍后重试";m.show({message:t,color:"error"})}finally{Be.value=!1}};ze(()=>y.value.columns.length,(i,e)=>{e!==void 0&&i!==e&&y.value.rows.forEach(t=>{if(i>t.values.length)for(;t.values.length<i;)t.values.push("");else i<t.values.length&&(t.values=t.values.slice(0,i))})}),ze(L,async(i,e)=>{R.value=[],i?(Q.value=[],await pl(),await vl(i)):(Q.value=[],await pl())}),ze([Q,L],([i,e],[t,c])=>{if(!e||!i||i.length===0){R.value=[];return}const V=[];if(i.forEach((W,ue)=>{if(W.selected){const Gl=e*1e4+ue;V.push(Gl)}}),c!==void 0&&e!==c){R.value=[...V];return}const E=new Set(Me.value.map(W=>W.id)),Ce=R.value.filter(W=>E.has(W)&&!V.includes(W)&&Me.value.some(ue=>ue.id===W&&!ue.selected)),ve=new Set([...V,...Ce]),de=Array.from(ve),Ol=[...R.value].sort((W,ue)=>W-ue),ql=[...de].sort((W,ue)=>W-ue);JSON.stringify(ql)!==JSON.stringify(Ol)&&(R.value=de)},{deep:!0,immediate:!1}),ze(K,i=>{i.length>0&&!Ve.value&&(Ve.value=i[0].planId||String(i[0].id))},{immediate:!0});const Te=ae(()=>{if(!Le.value)return M.value;const i=Le.value.toLowerCase();return M.value.filter(e=>e.mrt&&e.mrt.toLowerCase().includes(i)||e.oldContract&&e.oldContract.toLowerCase().includes(i)||e.sales&&e.sales.toLowerCase().includes(i)||e.category&&e.category.toLowerCase().includes(i)||e.lastTurnNetworkMonth&&e.lastTurnNetworkMonth.toLowerCase().includes(i))}),rl=ae(()=>{if(!Ne.value)return F.value;const i=Ne.value.toLowerCase();return F.value.filter(e=>e.mrt&&e.mrt.toLowerCase().includes(i)||e.oldContract&&e.oldContract.toLowerCase().includes(i)||e.sales&&e.sales.toLowerCase().includes(i)||e.category&&e.category.toLowerCase().includes(i)||e.lastTurnNetworkMonth&&e.lastTurnNetworkMonth.toLowerCase().includes(i))}),dl=async()=>{Fe.value=!0;try{const i=await pt();M.value=i,F.value=[],H.value=[],G.value=[],m.show({message:`成功加載 ${i.length} 條線索記錄`,color:"success"})}catch(i){console.error("加载线索记录失败",i);let e="加载线索记录失败，请稍后重试";i!=null&&i.payload&&typeof i.payload=="object"&&"message"in i.payload&&(e=String(i.payload.message)),m.show({message:e,color:"error"})}finally{Fe.value=!1}},ul=i=>{const e=H.value.indexOf(i);e>-1?H.value.splice(e,1):H.value.push(i)},cl=i=>{const e=G.value.indexOf(i);e>-1?G.value.splice(e,1):G.value.push(i)},Ll=()=>{const i=M.value.filter(e=>H.value.includes(e.id));F.value.push(...i),M.value=M.value.filter(e=>!H.value.includes(e.id)),H.value=[]},Nl=()=>{F.value.push(...Te.value);const i=new Set(Te.value.map(e=>e.id));M.value=M.value.filter(e=>!i.has(e.id)),H.value=[]},Ml=()=>{const i=F.value.filter(e=>G.value.includes(e.id));M.value.push(...i),F.value=F.value.filter(e=>!G.value.includes(e.id)),G.value=[]},zl=()=>{M.value.push(...F.value),F.value=[],G.value=[]},jl=async()=>{if(!_e.value){m.show({message:"請選擇要分配的用戶",color:"warning"});return}if(F.value.length===0){m.show({message:"請選擇要分配的線索",color:"warning"});return}le.value=!0;try{const i=F.value.map(e=>e.id);await vt({userId:_e.value,recordIds:i}),m.show({message:`成功分配 ${i.length} 條線索給用戶`,color:"success"}),M.value.push(...F.value),F.value=[],G.value=[]}catch(i){console.error("分配线索失败",i);let e="分配线索失败，请稍后重试";i!=null&&i.payload&&typeof i.payload=="object"&&"message"in i.payload&&(e=String(i.payload.message)),m.show({message:e,color:"error"})}finally{le.value=!1}};return Jl(()=>{N(),fl(),sl(),nl(),dl()}),(i,e)=>(v(),b("div",St,[a(Ze,{class:"hero-card",color:"transparent",elevation:"0"},{default:n(()=>[a(ye,{align:"center"},{default:n(()=>[a(te,{cols:"12",md:"6",class:"hero-copy"},{default:n(()=>[...e[28]||(e[28]=[l("div",{class:"hero-emblem"},"CSL",-1),l("div",null,[l("div",{class:"hero-eyebrow"},"SASL Configuration Console"),l("div",{class:"hero-title"},"移動通訊配置中心"),l("div",{class:"hero-meta"},"管理Excel數據導入與用戶文件綁定")],-1)])]),_:1}),a(te,{cols:"12",md:"6",class:"hero-stats"},{default:n(()=>[(v(!0),b(T,null,A(s(Ue),t=>(v(),b("div",{key:t.label,class:"hero-stat"},[l("div",Ut,[a(x,{icon:t.icon,size:"26"},null,8,["icon"])]),l("div",kt,[l("div",Dt,f(t.label),1),l("div",Ft,f(t.value),1)])]))),128))]),_:1})]),_:1})]),_:1}),a(ye,{dense:""},{default:n(()=>[a(te,{cols:"12",md:"6"},{default:n(()=>[a(Ie,{class:"section-card",loading:s(U),elevation:"0"},{default:n(()=>[a(Re,{class:"section-title d-flex align-center"},{default:n(()=>[l("div",_t,[a(x,{color:"primary"},{default:n(()=>[...e[29]||(e[29]=[u("mdi-account-plus",-1)])]),_:1})]),e[30]||(e[30]=l("div",null,[l("div",{class:"title-label"},"新增 SASL 用戶"),l("div",{class:"title-sub"},"Create SASL User")],-1))]),_:1}),a(Ee,null,{default:n(()=>[a(Ze,{class:"search-panel",elevation:"0"},{default:n(()=>[l("div",Tt,[a(x,{icon:"mdi-account-plus",color:"primary",size:"26"}),e[31]||(e[31]=l("span",null,"創建新用戶",-1))]),e[32]||(e[32]=l("div",{class:"search-panel-subtitle"},"填寫用戶信息以創建新的 SASL 用戶",-1))]),_:1}),a(Je,{ref_key:"userFormRef",ref:Sl,class:"mt-4"},{default:n(()=>{var t,c;return[a(B,{modelValue:s(D).username,"onUpdate:modelValue":e[0]||(e[0]=V=>s(D).username=V),label:"用戶名",placeholder:"輸入用戶名（3-30位，只能包含數字和字母）","prepend-inner-icon":"mdi-account",variant:"outlined",disabled:s(q)||s(U),rules:Dl,required:"",class:"mb-3"},null,8,["modelValue","disabled"]),a(B,{modelValue:s(D).password,"onUpdate:modelValue":e[2]||(e[2]=V=>s(D).password=V),label:"密碼",placeholder:"輸入密碼（8-32位，需包含大小寫字母、數字和特殊字符）","prepend-inner-icon":"mdi-lock",variant:"outlined",type:$e.value?"text":"password",disabled:s(q)||s(U),rules:Fl,required:"",class:"mb-3"},{"append-inner":n(()=>[a(x,{icon:$e.value?"mdi-eye-off":"mdi-eye",onClick:e[1]||(e[1]=V=>$e.value=!$e.value),style:{cursor:"pointer"}},null,8,["icon"])]),_:1},8,["modelValue","type","disabled"]),a(B,{modelValue:s(D).displayName,"onUpdate:modelValue":e[3]||(e[3]=V=>s(D).displayName=V),label:"顯示名稱",placeholder:"輸入顯示名稱（可選）","prepend-inner-icon":"mdi-account-outline",variant:"outlined",disabled:s(q)||s(U),class:"mb-3"},null,8,["modelValue","disabled"]),a(B,{modelValue:s(D).email,"onUpdate:modelValue":e[4]||(e[4]=V=>s(D).email=V),label:"郵箱",placeholder:"輸入郵箱（可選）","prepend-inner-icon":"mdi-email",variant:"outlined",type:"email",disabled:s(q)||s(U),class:"mb-3"},null,8,["modelValue","disabled"]),a(B,{modelValue:s(D).mobile,"onUpdate:modelValue":e[5]||(e[5]=V=>s(D).mobile=V),label:"手機號",placeholder:"輸入手機號（可選）","prepend-inner-icon":"mdi-phone",variant:"outlined",disabled:s(q)||s(U),class:"mb-3"},null,8,["modelValue","disabled"]),a(C,{class:"apple-primary-btn",color:"primary",loading:s(q),disabled:s(q)||s(U)||!((t=s(D).username)!=null&&t.trim())||!((c=s(D).password)!=null&&c.trim()),block:"",onClick:s(De)},{default:n(()=>[...e[33]||(e[33]=[u(" 創建用戶 ",-1)])]),_:1},8,["loading","disabled","onClick"])]}),_:1},512)]),_:1})]),_:1},8,["loading"])]),_:1}),a(te,{cols:"12",md:"6"},{default:n(()=>[a(Ie,{class:"section-card",loading:s(U),elevation:"0"},{default:n(()=>[a(Re,{class:"section-title d-flex align-center"},{default:n(()=>[l("div",At,[a(x,{color:"primary"},{default:n(()=>[...e[34]||(e[34]=[u("mdi-upload",-1)])]),_:1})]),e[35]||(e[35]=l("div",null,[l("div",{class:"title-label"},"Excel 數據導入"),l("div",{class:"title-sub"},"Upload Excel Files")],-1))]),_:1}),a(Ee,null,{default:n(()=>[a(Ze,{class:"search-panel",elevation:"0"},{default:n(()=>[l("div",It,[a(x,{icon:"mdi-file-excel",color:"primary",size:"26"}),e[36]||(e[36]=l("span",null,"上傳Excel文件",-1))]),e[37]||(e[37]=l("div",{class:"search-panel-subtitle"},"支持 .xls 和 .xlsx 格式文件",-1))]),_:1}),l("div",Rt,[a(gt,{modelValue:s(I),"onUpdate:modelValue":[e[6]||(e[6]=t=>je(I)?I.value=t:null),Tl],label:"選擇Excel文件",accept:".xls,.xlsx","prepend-icon":"mdi-file-excel",variant:"outlined",disabled:s($)||s(U),clearable:""},null,8,["modelValue","disabled"]),a(C,{class:"apple-primary-btn mt-4",color:"primary",loading:s($),disabled:!s(I)||s(U),block:"",onClick:Al},{default:n(()=>[...e[38]||(e[38]=[u(" 上傳並導入 ",-1)])]),_:1},8,["loading","disabled"])]),a(Oe,{class:"my-6"}),a(Ze,{class:"search-panel",elevation:"0"},{default:n(()=>[l("div",Et,[a(x,{icon:"mdi-account-link",color:"primary",size:"26"}),e[39]||(e[39]=l("span",null,"綁定文件與用戶",-1))]),e[40]||(e[40]=l("div",{class:"search-panel-subtitle"},"將Excel文件分配給指定用戶",-1))]),_:1}),l("div",Pt,[a(Ye,{modelValue:R.value,"onUpdate:modelValue":e[8]||(e[8]=t=>R.value=t),items:Me.value,"item-title":"originalFileName","item-value":"id",label:"選擇文件（可多選）","prepend-inner-icon":"mdi-file-excel",disabled:s(U)||s(O)||!s(L)||s(xe),loading:s(xe),multiple:"",chips:"","closable-chips":"",clearable:"",class:"mb-3"},{item:n(({props:t,item:c})=>[a(fe,Ke(Xe(t)),{prepend:n(()=>[a(el,{"model-value":R.value.includes(c.raw.id),"true-value":!0,"false-value":!1,color:"primary","hide-details":"",onClick:e[7]||(e[7]=Se(()=>{},["stop"])),"onUpdate:modelValue":V=>Il(c.raw.id,V,c.raw.selected)},null,8,["model-value","onUpdate:modelValue"])]),default:n(()=>[a(ge,null,{default:n(()=>[u(f(c.raw.originalFileName)+" ",1),c.raw.selected?(v(),S(qe,{key:0,size:"x-small",color:"success",class:"ml-2"},{default:n(()=>[...e[41]||(e[41]=[u(" 已綁定 ",-1)])]),_:1})):Z("",!0)]),_:2},1024),c.raw.fileSize>0?(v(),S(Ge,{key:0},{default:n(()=>[u(f(_l(c.raw.fileSize))+" · "+f(re(c.raw.uploadTime)),1)]),_:2},1024)):(v(),S(Ge,{key:1},{default:n(()=>[...e[42]||(e[42]=[u(" 文檔標題 ",-1)])]),_:1}))]),_:2},1040)]),_:1},8,["modelValue","items","disabled","loading"]),a(Ye,{modelValue:s(L),"onUpdate:modelValue":e[9]||(e[9]=t=>je(L)?L.value=t:null),items:s(he),"item-title":"username","item-value":"id",label:"選擇用戶","prepend-inner-icon":"mdi-account",disabled:s(U)||s(O),clearable:"",class:"mb-3"},{item:n(({props:t,item:c})=>[a(fe,Ke(Xe(t)),{prepend:n(()=>[a(x,{icon:"mdi-account",color:"primary"})]),append:n(()=>[a(C,{icon:"mdi-delete",color:"error",variant:"text",size:"small",disabled:s(U)||s(O),loading:s(U),onClick:Se(V=>s(hl)(c.raw.id),["stop"]),title:"刪除用戶的 SASL 部門編碼"},null,8,["disabled","loading","onClick"])]),default:n(()=>[a(ge,null,{default:n(()=>[u(f(c.raw.username),1)]),_:2},1024),c.raw.nickname?(v(),S(Ge,{key:0},{default:n(()=>[u(f(c.raw.nickname),1)]),_:2},1024)):Z("",!0)]),_:2},1040)]),_:1},8,["modelValue","items","disabled"]),a(C,{class:"apple-primary-btn",color:"primary",loading:s(O),disabled:R.value.length===0||!s(L)||s(U),block:"",onClick:e[10]||(e[10]=()=>s(X)(R.value,Me.value))},{default:n(()=>[...e[43]||(e[43]=[u(" 確認綁定/解綁 ",-1)])]),_:1},8,["loading","disabled"])])]),_:1})]),_:1},8,["loading"])]),_:1})]),_:1}),a(ye,{class:"plan-detail-row",dense:""},{default:n(()=>[a(te,{cols:"12"},{default:n(()=>[l("section",$t,[l("div",Bt,[l("div",Lt,[a(x,{color:"primary"},{default:n(()=>[...e[44]||(e[44]=[u("mdi-table-large",-1)])]),_:1})]),e[45]||(e[45]=l("div",null,[l("div",{class:"title-label"},"綁定關係列表"),l("div",{class:"title-sub"},"File User Bindings")],-1))]),a(P,{type:"info",variant:"tonal",color:"primary",border:"start",class:"mb-6"},{default:n(()=>[...e[46]||(e[46]=[u(" 以下顯示所有已建立的文件與用戶綁定關係，可在此管理綁定狀態。 ",-1)])]),_:1}),s(U)&&s(se).length===0?(v(),b("div",Nt,[a(Ae,{indeterminate:"",color:"primary"}),e[47]||(e[47]=l("div",{class:"mt-4 text-medium-emphasis"},"正在加載數據...",-1))])):s(se).length>0?(v(),S(ll,{key:1,class:"binding-table"},{default:n(()=>[e[48]||(e[48]=l("thead",null,[l("tr",null,[l("th",null,"文件名稱"),l("th",null,"用戶名稱"),l("th",null,"綁定時間"),l("th",null,"操作")])],-1)),l("tbody",null,[(v(!0),b(T,null,A(s(se),t=>(v(),b("tr",{key:t.id},[l("td",null,[l("div",Mt,[a(x,{icon:"mdi-file-excel",color:"primary",class:"mr-2"}),u(" "+f(t.fileName),1)])]),l("td",null,[l("div",zt,[a(x,{icon:"mdi-account",color:"primary",class:"mr-2"}),u(" "+f(t.userName),1)])]),l("td",null,f(re(t.bindTime)),1),l("td",null,[a(C,{icon:"mdi-delete",variant:"text",color:"error",size:"small",onClick:c=>s(al)(t.id)},null,8,["onClick"])])]))),128))])]),_:1})):(v(),S(P,{key:2,type:"info",variant:"tonal",color:"primary",border:"start",class:"mt-4"},{default:n(()=>[...e[49]||(e[49]=[u(" 暫無綁定關係，請在上方創建文件與用戶的綁定。 ",-1)])]),_:1}))])]),_:1})]),_:1}),a(ye,{class:"plan-detail-row",dense:""},{default:n(()=>[a(te,{cols:"12"},{default:n(()=>[l("section",jt,[l("div",Ot,[l("div",qt,[a(x,{color:"primary"},{default:n(()=>[...e[50]||(e[50]=[u("mdi-file-document-multiple",-1)])]),_:1})]),e[53]||(e[53]=l("div",null,[l("div",{class:"title-label"},"文檔清單"),l("div",{class:"title-sub"},"Document List")],-1)),a(We),a(C,{icon:"mdi-refresh",variant:"text",color:"primary",loading:s(ee),onClick:s(sl)},{default:n(()=>[a(x,null,{default:n(()=>[...e[51]||(e[51]=[u("mdi-refresh",-1)])]),_:1}),a(J,{activator:"parent"},{default:n(()=>[...e[52]||(e[52]=[u("刷新文檔清單",-1)])]),_:1})]),_:1},8,["loading","onClick"])]),a(P,{type:"info",variant:"tonal",color:"primary",border:"start",class:"mb-6"},{default:n(()=>[...e[54]||(e[54]=[u(" 以下按文檔標題分組顯示所有導入記錄，點擊導入記錄可加載該文檔標題對應的數據記錄，可在此進行刪除操作。 ",-1)])]),_:1}),s(ee)&&s(ne).length===0?(v(),b("div",Gt,[a(Ae,{indeterminate:"",color:"primary"}),e[55]||(e[55]=l("div",{class:"mt-4 text-medium-emphasis"},"正在加載文檔清單...",-1))])):s(ne).length>0?(v(),b("div",Wt,[(v(!0),b(T,null,A(s(ne),t=>(v(),b("div",{key:t.documentTitle,class:"document-group-item mb-4"},[l("div",Zt,[l("div",Jt,[l("div",Qt,[a(x,{icon:"mdi-folder-text",color:"primary",class:"mr-2"}),l("div",null,[l("div",{class:Ql(["text-h6 document-title-link",{"document-selected":s(oe)===t.documentTitle}]),onClick:c=>$l(t.documentTitle,t.importRecords)},f(t.documentTitle),11,Kt),l("div",Xt," 共 "+f(t.importRecords.length)+" 個導入記錄 ",1)])]),l("div",Ht,[a(C,{icon:"mdi-download",variant:"text",color:"primary",size:"small",loading:Be.value,disabled:Be.value,onClick:Se(c=>Bl(t.documentTitle),["stop"])},{default:n(()=>[a(x,null,{default:n(()=>[...e[56]||(e[56]=[u("mdi-download",-1)])]),_:1}),a(J,{activator:"parent"},{default:n(()=>[...e[57]||(e[57]=[u("導出該文檔標題的所有記錄",-1)])]),_:1})]),_:1},8,["loading","disabled","onClick"]),a(C,{icon:"mdi-delete",variant:"text",color:"error",size:"small",loading:s(ee),onClick:Se(c=>s(wl)(t.documentTitle),["stop"])},{default:n(()=>[a(x,null,{default:n(()=>[...e[58]||(e[58]=[u("mdi-delete",-1)])]),_:1}),a(J,{activator:"parent"},{default:n(()=>[...e[59]||(e[59]=[u("刪除該文檔標題的所有記錄",-1)])]),_:1})]),_:1},8,["loading","onClick"])])])]),a(ll,{class:"import-records-table mt-3"},{default:n(()=>[e[60]||(e[60]=l("thead",null,[l("tr",null,[l("th",null,"Excel文件名"),l("th",null,"描述"),l("th",null,"備註"),l("th",null,"創建時間"),l("th",null,"更新時間")])],-1)),l("tbody",null,[(v(!0),b(T,null,A(t.importRecords,c=>(v(),b("tr",{key:c.id},[l("td",null,[l("div",Yt,[a(x,{icon:"mdi-file-excel",color:"success",class:"mr-2",size:"small"}),l("span",null,f(c.excelFileName),1)])]),l("td",null,[l("span",null,f(c.documentDescription||"-"),1)]),l("td",null,[l("span",null,f(c.documentRemark||"-"),1)]),l("td",null,f(re(c.createdAt)),1),l("td",null,f(c.updatedAt?re(c.updatedAt):"-"),1)]))),128))])]),_:2},1024)]))),128))])):(v(),S(P,{key:2,type:"info",variant:"tonal",color:"primary",border:"start",class:"mt-4"},{default:n(()=>[...e[61]||(e[61]=[u(" 暫無導入記錄，請先上傳Excel文件導入數據。 ",-1)])]),_:1})),s(j)&&s(r).length>0?(v(),b("div",ea,[a(Oe,{class:"mb-4"}),l("div",la,[l("div",ta,[l("div",null,[l("div",aa,f(s(oe)),1),l("div",sa,[u(" Excel文件："+f(s(j).excelFileName)+" ",1),s(j).documentDescription?(v(),b("span",na," | "+f(s(j).documentDescription),1)):Z("",!0)])]),a(C,{icon:"mdi-close",variant:"text",size:"small",onClick:Pl},{default:n(()=>[a(x,null,{default:n(()=>[...e[62]||(e[62]=[u("mdi-close",-1)])]),_:1}),a(J,{activator:"parent"},{default:n(()=>[...e[63]||(e[63]=[u("關閉",-1)])]),_:1})]),_:1})]),l("div",oa,[e[65]||(e[65]=l("div",{class:"text-subtitle-2 mb-2"},"數據記錄",-1)),l("div",ia," 共 "+f(s(r).length)+" 條記錄 ",1),l("div",ra,[l("table",da,[e[64]||(e[64]=l("thead",null,[l("tr",null,[l("th",null,"MRT"),l("th",null,"舊合約"),l("th",null,"銷售"),l("th",null,"類別"),l("th",null,"最後轉網月份"),l("th",null,"致電狀態"),l("th",null,"備註"),l("th",null,"最後致電時間"),l("th",null,"下次致電時間")])],-1)),l("tbody",null,[(v(!0),b(T,null,A(s(r),t=>(v(),b("tr",{key:t.id},[l("td",null,f(t.mrt),1),l("td",null,f(t.oldContract),1),l("td",null,f(t.sales),1),l("td",null,f(t.category),1),l("td",null,f(t.lastTurnNetworkMonth),1),l("td",null,f(t.callStatus||"-"),1),l("td",null,f(t.remark||"-"),1),l("td",null,f(t.lastCallTime?re(t.lastCallTime):"-"),1),l("td",null,f(t.nextCallTime?re(t.nextCallTime):"-"),1)]))),128))])])])])])])):Z("",!0)])]),_:1})]),_:1}),a(ye,{class:"plan-detail-row",dense:""},{default:n(()=>[a(te,{cols:"12"},{default:n(()=>[l("section",ua,[l("div",ca,[l("div",ma,[a(x,{color:"primary"},{default:n(()=>[...e[66]||(e[66]=[u("mdi-bullhorn",-1)])]),_:1})]),e[69]||(e[69]=l("div",null,[l("div",{class:"title-label"},"公告管理"),l("div",{class:"title-sub"},"Announcement Management")],-1)),a(We),a(C,{icon:"mdi-refresh",variant:"text",color:"primary",loading:s(p),onClick:s(nl)},{default:n(()=>[a(x,null,{default:n(()=>[...e[67]||(e[67]=[u("mdi-refresh",-1)])]),_:1}),a(J,{activator:"parent"},{default:n(()=>[...e[68]||(e[68]=[u("刷新公告列表",-1)])]),_:1})]),_:1},8,["loading","onClick"])]),a(P,{type:"info",variant:"tonal",color:"primary",border:"start",class:"mb-6"},{default:n(()=>[...e[70]||(e[70]=[u(" 以下顯示所有公告，可在此查看並更新公告內容。 ",-1)])]),_:1}),s(p)&&s(d).length===0?(v(),b("div",pa,[a(Ae,{indeterminate:"",color:"primary"}),e[71]||(e[71]=l("div",{class:"mt-4 text-medium-emphasis"},"正在加載公告列表...",-1))])):s(d).length>0?(v(),S(ll,{key:1,class:"binding-table"},{default:n(()=>[e[74]||(e[74]=l("thead",null,[l("tr",null,[l("th",null,"ID"),l("th",null,"內容"),l("th",null,"狀態"),l("th",null,"排序"),l("th",null,"創建時間"),l("th",null,"更新時間"),l("th",null,"操作")])],-1)),l("tbody",null,[(v(!0),b(T,null,A(s(d),t=>(v(),b("tr",{key:t.id},[l("td",null,f(t.id),1),l("td",null,[l("div",va,f(t.content),1)]),l("td",null,[a(qe,{color:t.enabled?"success":"default",size:"small",variant:"tonal"},{default:n(()=>[u(f(t.enabled?"啟用":"禁用"),1)]),_:2},1032,["color"])]),l("td",null,f(t.sortOrder),1),l("td",null,f(re(t.createdAt)),1),l("td",null,f(t.updatedAt?re(t.updatedAt):"-"),1),l("td",null,[a(C,{icon:"mdi-pencil",variant:"text",color:"primary",size:"small",loading:s(p),onClick:c=>s(xl)(t)},{default:n(()=>[a(x,null,{default:n(()=>[...e[72]||(e[72]=[u("mdi-pencil",-1)])]),_:1}),a(J,{activator:"parent"},{default:n(()=>[...e[73]||(e[73]=[u("編輯公告",-1)])]),_:1})]),_:1},8,["loading","onClick"])])]))),128))])]),_:1})):(v(),S(P,{key:2,type:"info",variant:"tonal",color:"primary",border:"start",class:"mt-4"},{default:n(()=>[...e[75]||(e[75]=[u(" 暫無公告記錄。 ",-1)])]),_:1}))])]),_:1})]),_:1}),a(ye,{class:"plan-detail-row",dense:""},{default:n(()=>[a(te,{cols:"12"},{default:n(()=>[l("section",fa,[l("div",ga,[l("div",ya,[a(x,{color:"primary"},{default:n(()=>[...e[76]||(e[76]=[u("mdi-package-variant",-1)])]),_:1})]),e[77]||(e[77]=l("div",null,[l("div",{class:"title-label"},"套餐明細檢視"),l("div",{class:"title-sub"},"Plan Details View")],-1))]),a(P,{type:"info",variant:"tonal",color:"primary",border:"start",class:"mb-6"},{default:n(()=>[...e[78]||(e[78]=[u(" 以下顯示所有套餐方案，可在此查看套餐明細並進行編輯更新操作。 ",-1)])]),_:1}),s(k)&&s(K).length===0?(v(),b("div",ba,[a(Ae,{indeterminate:"",color:"primary"}),e[79]||(e[79]=l("div",{class:"mt-4 text-medium-emphasis"},"正在加載套餐數據...",-1))])):s(K).length>0?(v(),b("div",wa,[a(yt,{modelValue:Ve.value,"onUpdate:modelValue":e[11]||(e[11]=t=>Ve.value=t),class:"plan-tabs",grow:"",density:"comfortable","slider-color":"primary"},{default:n(()=>[(v(!0),b(T,null,A(s(K),t=>(v(),S(wt,{key:t.id,value:t.planId||String(t.id),class:"plan-tab"},{default:n(()=>[l("div",ha,f(t.title),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),a(bt,{modelValue:Ve.value,"onUpdate:modelValue":e[12]||(e[12]=t=>Ve.value=t),class:"plan-window"},{default:n(()=>[(v(!0),b(T,null,A(s(K),t=>(v(),S(ht,{key:t.id,value:t.planId||String(t.id),class:"plan-window-item"},{default:n(()=>[l("div",xa,[l("div",Va,[l("div",Ca,f(t.title),1),l("div",Sa,f(t.subtitle),1)]),a(We),a(C,{class:"apple-primary-btn",color:"primary",loading:s(k),"prepend-icon":"mdi-pencil",onClick:c=>s(gl)(t.id)},{default:n(()=>[...e[80]||(e[80]=[u(" 編輯套餐 ",-1)])]),_:1},8,["loading","onClick"])]),l("div",Ua,[l("table",ka,[l("thead",null,[l("tr",null,[e[81]||(e[81]=l("th",null,"項目",-1)),(v(!0),b(T,null,A(t.columns,c=>(v(),b("th",{key:c},f(c),1))),128))])]),l("tbody",null,[(v(!0),b(T,null,A(t.rows,c=>(v(),b("tr",{key:c.label},[l("th",null,f(c.label),1),(v(!0),b(T,null,A(c.values,(V,E)=>(v(),b("td",{key:`${c.label}-${E}`},f(V),1))),128))]))),128))])])]),t.footnote?(v(),b("div",Da,f(t.footnote),1)):Z("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])])):(v(),S(P,{key:2,type:"info",variant:"tonal",color:"primary",border:"start",class:"mt-4"},{default:n(()=>[...e[82]||(e[82]=[u(" 暫無套餐方案數據。 ",-1)])]),_:1}))])]),_:1})]),_:1}),a(tl,{modelValue:s(ce),"onUpdate:modelValue":e[16]||(e[16]=t=>je(ce)?ce.value=t:null),"max-width":"600",persistent:""},{default:n(()=>[a(Ie,{class:"upload-dialog-card"},{default:n(()=>[a(Re,{class:"d-flex align-center"},{default:n(()=>[a(x,{icon:"mdi-file-excel",color:"primary",class:"mr-2"}),e[83]||(e[83]=l("span",null,"上傳Excel文件",-1))]),_:1}),a(Ee,null,{default:n(()=>[a(P,{type:"info",variant:"tonal",color:"primary",border:"start",class:"mb-4"},{default:n(()=>[...e[84]||(e[84]=[u(" 請填寫以下信息，文檔標題為必填項，然後確認上傳。 ",-1)])]),_:1}),a(Je,{ref_key:"uploadFormRef",ref:Cl},{default:n(()=>[a(B,{modelValue:s(z).title,"onUpdate:modelValue":e[13]||(e[13]=t=>s(z).title=t),label:"文檔標題",placeholder:"例如：客戶數據表（必填）","prepend-inner-icon":"mdi-format-title",variant:"outlined",disabled:s($),rules:[t=>!!t||"文檔標題為必填項"],required:"",class:"mb-3"},null,8,["modelValue","disabled","rules"]),a(Qe,{modelValue:s(z).description,"onUpdate:modelValue":e[14]||(e[14]=t=>s(z).description=t),label:"文檔描述",placeholder:"輸入文件描述信息（可選）","prepend-inner-icon":"mdi-text",variant:"outlined",rows:"3","auto-grow":"",disabled:s($),class:"mb-3"},null,8,["modelValue","disabled"]),a(Qe,{modelValue:s(z).remark,"onUpdate:modelValue":e[15]||(e[15]=t=>s(z).remark=t),label:"備註",placeholder:"輸入備註信息（可選）","prepend-inner-icon":"mdi-note-text-outline",variant:"outlined",rows:"3","auto-grow":"",disabled:s($)},null,8,["modelValue","disabled"])]),_:1},512)]),_:1}),a(He,{class:"justify-end"},{default:n(()=>{var t;return[a(C,{variant:"text",disabled:s($),onClick:s(ie)},{default:n(()=>[...e[85]||(e[85]=[u(" 取消 ",-1)])]),_:1},8,["disabled","onClick"]),a(C,{class:"apple-primary-btn",color:"primary",loading:s($),disabled:s($)||!((t=s(z).title)!=null&&t.trim()),onClick:s(pe)},{default:n(()=>[...e[86]||(e[86]=[u(" 確認上傳 ",-1)])]),_:1},8,["loading","disabled","onClick"])]}),_:1})]),_:1})]),_:1},8,["modelValue"]),a(tl,{modelValue:il.value,"onUpdate:modelValue":e[18]||(e[18]=t=>il.value=t),"max-width":"600",persistent:""},{default:n(()=>[a(Ie,{class:"upload-dialog-card"},{default:n(()=>[a(Re,{class:"d-flex align-center"},{default:n(()=>[a(x,{icon:"mdi-bullhorn",color:"primary",class:"mr-2"}),e[87]||(e[87]=l("span",null,"編輯公告",-1))]),_:1}),a(Ee,null,{default:n(()=>[a(P,{type:"info",variant:"tonal",color:"primary",border:"start",class:"mb-4"},{default:n(()=>[...e[88]||(e[88]=[u(" 請填寫以下信息以更新公告內容。 ",-1)])]),_:1}),a(Je,{ref_key:"announcementFormRef",ref:kl},{default:n(()=>[a(Qe,{modelValue:s(h).content,"onUpdate:modelValue":e[17]||(e[17]=t=>s(h).content=t),label:"公告內容",placeholder:"輸入公告內容（必填）","prepend-inner-icon":"mdi-text",variant:"outlined",rows:"6","auto-grow":"",disabled:s(p),rules:[t=>!!t||"公告內容為必填項"],required:""},null,8,["modelValue","disabled","rules"])]),_:1},512)]),_:1}),a(He,{class:"justify-end"},{default:n(()=>{var t;return[a(C,{variant:"text",disabled:s(p),onClick:s(ol)},{default:n(()=>[...e[89]||(e[89]=[u(" 取消 ",-1)])]),_:1},8,["disabled","onClick"]),a(C,{class:"apple-primary-btn",color:"primary",loading:s(p),disabled:s(p)||!((t=s(h).content)!=null&&t.trim()),onClick:s(Vl)},{default:n(()=>[...e[90]||(e[90]=[u(" 確認更新 ",-1)])]),_:1},8,["loading","disabled","onClick"])]}),_:1})]),_:1})]),_:1},8,["modelValue"]),a(ye,{class:"plan-detail-row",dense:""},{default:n(()=>[a(te,{cols:"12"},{default:n(()=>[l("section",Fa,[l("div",_a,[l("div",Ta,[a(x,{color:"primary"},{default:n(()=>[...e[91]||(e[91]=[u("mdi-account-switch",-1)])]),_:1})]),e[94]||(e[94]=l("div",null,[l("div",{class:"title-label"},"線索分配"),l("div",{class:"title-sub"},"Lead Assignment")],-1)),a(We),a(C,{icon:"mdi-refresh",variant:"text",color:"primary",loading:Fe.value,onClick:dl},{default:n(()=>[a(x,null,{default:n(()=>[...e[92]||(e[92]=[u("mdi-refresh",-1)])]),_:1}),a(J,{activator:"parent"},{default:n(()=>[...e[93]||(e[93]=[u("刷新線索列表",-1)])]),_:1})]),_:1},8,["loading"])]),a(P,{type:"info",variant:"tonal",color:"primary",border:"start",class:"mb-6"},{default:n(()=>[...e[95]||(e[95]=[u(" 選擇線索記錄並分配給指定用戶。左側顯示所有可用線索，右側顯示已選中待分配的線索。 ",-1)])]),_:1}),Fe.value&&M.value.length===0?(v(),b("div",Aa,[a(Ae,{indeterminate:"",color:"primary"}),e[96]||(e[96]=l("div",{class:"mt-4 text-medium-emphasis"},"正在加載線索數據...",-1))])):(v(),b("div",Ia,[l("div",Ra,[a(Ye,{modelValue:_e.value,"onUpdate:modelValue":e[19]||(e[19]=t=>_e.value=t),items:s(he),"item-title":"username","item-value":"id",label:"選擇用戶","prepend-inner-icon":"mdi-account",disabled:Fe.value||le.value,clearable:"",variant:"outlined"},{item:n(({props:t,item:c})=>[a(fe,Ke(Xe(t)),{prepend:n(()=>[a(x,{icon:"mdi-account",color:"primary"})]),default:n(()=>[a(ge,null,{default:n(()=>[u(f(c.raw.username),1)]),_:2},1024),c.raw.nickname?(v(),S(Ge,{key:0},{default:n(()=>[u(f(c.raw.nickname),1)]),_:2},1024)):Z("",!0)]),_:2},1040)]),_:1},8,["modelValue","items","disabled"])]),l("div",Ea,[l("div",Pa,[l("div",$a,[l("div",Ba,[a(x,{icon:"mdi-format-list-bulleted",color:"primary",class:"mr-2"}),e[97]||(e[97]=l("span",{class:"text-subtitle-1"},"可用線索",-1)),a(qe,{size:"small",color:"primary",variant:"tonal",class:"ml-2"},{default:n(()=>[u(f(M.value.length),1)]),_:1})]),a(B,{modelValue:Le.value,"onUpdate:modelValue":e[20]||(e[20]=t=>Le.value=t),placeholder:"搜索線索...","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact","hide-details":"",class:"mt-2"},null,8,["modelValue"])]),l("div",La,[a(ml,{class:"transfer-list"},{default:n(()=>[(v(!0),b(T,null,A(Te.value,t=>(v(),S(fe,{key:t.id,value:t.id,onClick:c=>ul(t.id)},{prepend:n(()=>[a(el,{"model-value":H.value.includes(t.id),color:"primary","hide-details":"",onClick:Se(c=>ul(t.id),["stop"])},null,8,["model-value","onClick"])]),default:n(()=>[a(ge,{class:"text-body-2"},{default:n(()=>[l("div",Na,[l("span",null,[e[98]||(e[98]=l("strong",null,"MRT:",-1)),u(" "+f(t.mrt||"-"),1)]),l("span",Ma,[e[99]||(e[99]=l("strong",null,"舊合約:",-1)),u(" "+f(t.oldContract||"-")+" | ",1),e[100]||(e[100]=l("strong",null,"銷售:",-1)),u(" "+f(t.sales||"-"),1)]),l("span",za,[e[101]||(e[101]=l("strong",null,"類別:",-1)),u(" "+f(t.category||"-")+" | ",1),e[102]||(e[102]=l("strong",null,"最後轉網月份:",-1)),u(" "+f(t.lastTurnNetworkMonth||"-"),1)])])]),_:2},1024)]),_:2},1032,["value","onClick"]))),128)),Te.value.length===0?(v(),S(fe,{key:0},{default:n(()=>[a(ge,{class:"text-center text-medium-emphasis"},{default:n(()=>[...e[103]||(e[103]=[u(" 暫無可用線索 ",-1)])]),_:1})]),_:1})):Z("",!0)]),_:1})])]),l("div",ja,[a(C,{icon:"mdi-chevron-right",color:"primary",variant:"outlined",disabled:H.value.length===0||le.value,onClick:Ll},{default:n(()=>[a(x,null,{default:n(()=>[...e[104]||(e[104]=[u("mdi-chevron-right",-1)])]),_:1}),a(J,{activator:"parent"},{default:n(()=>[...e[105]||(e[105]=[u("添加到已選",-1)])]),_:1})]),_:1},8,["disabled"]),a(C,{icon:"mdi-chevron-double-right",color:"primary",variant:"outlined",disabled:Te.value.length===0||le.value,onClick:Nl},{default:n(()=>[a(x,null,{default:n(()=>[...e[106]||(e[106]=[u("mdi-chevron-double-right",-1)])]),_:1}),a(J,{activator:"parent"},{default:n(()=>[...e[107]||(e[107]=[u("全部添加",-1)])]),_:1})]),_:1},8,["disabled"]),a(C,{icon:"mdi-chevron-left",color:"primary",variant:"outlined",disabled:G.value.length===0||le.value,onClick:Ml},{default:n(()=>[a(x,null,{default:n(()=>[...e[108]||(e[108]=[u("mdi-chevron-left",-1)])]),_:1}),a(J,{activator:"parent"},{default:n(()=>[...e[109]||(e[109]=[u("移回可用",-1)])]),_:1})]),_:1},8,["disabled"]),a(C,{icon:"mdi-chevron-double-left",color:"primary",variant:"outlined",disabled:F.value.length===0||le.value,onClick:zl},{default:n(()=>[a(x,null,{default:n(()=>[...e[110]||(e[110]=[u("mdi-chevron-double-left",-1)])]),_:1}),a(J,{activator:"parent"},{default:n(()=>[...e[111]||(e[111]=[u("全部移回",-1)])]),_:1})]),_:1},8,["disabled"])]),l("div",Oa,[l("div",qa,[l("div",Ga,[a(x,{icon:"mdi-check-circle",color:"success",class:"mr-2"}),e[112]||(e[112]=l("span",{class:"text-subtitle-1"},"已選線索",-1)),a(qe,{size:"small",color:"success",variant:"tonal",class:"ml-2"},{default:n(()=>[u(f(F.value.length),1)]),_:1})]),a(B,{modelValue:Ne.value,"onUpdate:modelValue":e[21]||(e[21]=t=>Ne.value=t),placeholder:"搜索已選線索...","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact","hide-details":"",class:"mt-2"},null,8,["modelValue"])]),l("div",Wa,[a(ml,{class:"transfer-list"},{default:n(()=>[(v(!0),b(T,null,A(rl.value,t=>(v(),S(fe,{key:t.id,value:t.id,onClick:c=>cl(t.id)},{prepend:n(()=>[a(el,{"model-value":G.value.includes(t.id),color:"success","hide-details":"",onClick:Se(c=>cl(t.id),["stop"])},null,8,["model-value","onClick"])]),default:n(()=>[a(ge,{class:"text-body-2"},{default:n(()=>[l("div",Za,[l("span",null,[e[113]||(e[113]=l("strong",null,"MRT:",-1)),u(" "+f(t.mrt||"-"),1)]),l("span",Ja,[e[114]||(e[114]=l("strong",null,"舊合約:",-1)),u(" "+f(t.oldContract||"-")+" | ",1),e[115]||(e[115]=l("strong",null,"銷售:",-1)),u(" "+f(t.sales||"-"),1)]),l("span",Qa,[e[116]||(e[116]=l("strong",null,"類別:",-1)),u(" "+f(t.category||"-")+" | ",1),e[117]||(e[117]=l("strong",null,"最後轉網月份:",-1)),u(" "+f(t.lastTurnNetworkMonth||"-"),1)])])]),_:2},1024)]),_:2},1032,["value","onClick"]))),128)),rl.value.length===0?(v(),S(fe,{key:0},{default:n(()=>[a(ge,{class:"text-center text-medium-emphasis"},{default:n(()=>[...e[118]||(e[118]=[u(" 暫無已選線索 ",-1)])]),_:1})]),_:1})):Z("",!0)]),_:1})])])]),l("div",Ka,[a(C,{class:"apple-primary-btn",color:"primary",loading:le.value,disabled:F.value.length===0||!_e.value||le.value,"prepend-icon":"mdi-account-check",onClick:jl},{default:n(()=>[...e[119]||(e[119]=[u(" 分配選中線索 ",-1)])]),_:1},8,["loading","disabled"])])]))])]),_:1})]),_:1}),a(tl,{modelValue:s(me),"onUpdate:modelValue":e[27]||(e[27]=t=>je(me)?me.value=t:null),"max-width":"900",persistent:"",scrollable:""},{default:n(()=>[a(Ie,{class:"upload-dialog-card"},{default:n(()=>[a(Re,{class:"d-flex align-center"},{default:n(()=>[a(x,{icon:"mdi-package-variant",color:"primary",class:"mr-2"}),e[120]||(e[120]=l("span",null,"編輯套餐方案",-1))]),_:1}),a(Ee,null,{default:n(()=>[a(P,{type:"info",variant:"tonal",color:"primary",border:"start",class:"mb-4"},{default:n(()=>[...e[121]||(e[121]=[u(" 請填寫以下信息以更新套餐方案。 ",-1)])]),_:1}),a(Je,{ref_key:"planSectionFormRef",ref:Ul},{default:n(()=>[a(B,{modelValue:s(y).planId,"onUpdate:modelValue":e[22]||(e[22]=t=>s(y).planId=t),label:"套餐ID",placeholder:"例如：plan-001（必填）","prepend-inner-icon":"mdi-identifier",variant:"outlined",disabled:s(k),rules:[t=>!!t||"套餐ID為必填項"],required:"",class:"mb-3"},null,8,["modelValue","disabled","rules"]),a(B,{modelValue:s(y).title,"onUpdate:modelValue":e[23]||(e[23]=t=>s(y).title=t),label:"套餐標題",placeholder:"例如：5G Premium套餐（必填）","prepend-inner-icon":"mdi-format-title",variant:"outlined",disabled:s(k),rules:[t=>!!t||"套餐標題為必填項"],required:"",class:"mb-3"},null,8,["modelValue","disabled","rules"]),a(B,{modelValue:s(y).subtitle,"onUpdate:modelValue":e[24]||(e[24]=t=>s(y).subtitle=t),label:"套餐副標題",placeholder:"例如：高速穩定網絡體驗（可選）","prepend-inner-icon":"mdi-subtitles",variant:"outlined",disabled:s(k),class:"mb-3"},null,8,["modelValue","disabled"]),a(Qe,{modelValue:s(y).footnote,"onUpdate:modelValue":e[25]||(e[25]=t=>s(y).footnote=t),label:"腳註",placeholder:"輸入腳註信息（可選）","prepend-inner-icon":"mdi-note-text-outline",variant:"outlined",rows:"3","auto-grow":"",disabled:s(k),class:"mb-4"},null,8,["modelValue","disabled"]),a(Oe,{class:"my-4"}),l("div",Xa,[l("div",Ha,[e[122]||(e[122]=l("div",{class:"text-h6"},"列標題",-1)),a(C,{icon:"mdi-plus",size:"small",color:"primary",variant:"text",disabled:s(k),onClick:e[26]||(e[26]=t=>s(y).columns.push(""))},null,8,["disabled"])]),(v(!0),b(T,null,A(s(y).columns,(t,c)=>(v(),S(B,{key:c,modelValue:s(y).columns[c],"onUpdate:modelValue":V=>s(y).columns[c]=V,label:`列 ${c+1}`,placeholder:`輸入列標題 ${c+1}`,variant:"outlined",disabled:s(k),class:"mb-2"},{"append-inner":n(()=>[a(C,{icon:"mdi-delete",size:"small",variant:"text",color:"error",disabled:s(k)||s(y).columns.length<=1,onClick:V=>Rl(c)},null,8,["disabled","onClick"])]),_:2},1032,["modelValue","onUpdate:modelValue","label","placeholder","disabled"]))),128)),s(y).columns.length===0?(v(),S(P,{key:0,type:"warning",variant:"tonal",class:"mt-2"},{default:n(()=>[...e[123]||(e[123]=[u(" 請至少添加一列 ",-1)])]),_:1})):Z("",!0)]),a(Oe,{class:"my-4"}),l("div",null,[l("div",Ya,[e[124]||(e[124]=l("div",{class:"text-h6"},"行數據",-1)),a(C,{icon:"mdi-plus",size:"small",color:"primary",variant:"text",disabled:s(k)||s(y).columns.length===0,onClick:El},null,8,["disabled"])]),(v(!0),b(T,null,A(s(y).rows,(t,c)=>(v(),b("div",{key:c,class:"mb-4 pa-4",style:{border:"1px solid rgba(70, 110, 196, 0.35)","border-radius":"8px",background:"rgba(8, 12, 26, 0.5)"}},[l("div",es,[l("div",ls,"行 "+f(c+1),1),a(C,{icon:"mdi-delete",size:"small",variant:"text",color:"error",disabled:s(k),onClick:V=>s(y).rows.splice(c,1)},null,8,["disabled","onClick"])]),a(B,{modelValue:s(y).rows[c].label,"onUpdate:modelValue":V=>s(y).rows[c].label=V,label:"行標籤",placeholder:"例如：月費",variant:"outlined",disabled:s(k),rules:[V=>!!V||"行標籤為必填項"],required:"",class:"mb-2"},null,8,["modelValue","onUpdate:modelValue","disabled","rules"]),e[125]||(e[125]=l("div",{class:"text-caption mb-2"},"值列表（需與列數量一致）",-1)),l("div",ts,[(v(!0),b(T,null,A(t.values,(V,E)=>(v(),S(B,{key:E,modelValue:s(y).rows[c].values[E],"onUpdate:modelValue":Ce=>s(y).rows[c].values[E]=Ce,label:`值 ${E+1}`,placeholder:`輸入值 ${E+1}`,variant:"outlined",density:"compact",disabled:s(k),style:{flex:"1","min-width":"120px"}},null,8,["modelValue","onUpdate:modelValue","label","placeholder","disabled"]))),128))]),t.values.length!==s(y).columns.length?(v(),S(P,{key:0,type:"warning",variant:"tonal",density:"compact"},{default:n(()=>[u(" 值數量必須等於列數量（當前："+f(t.values.length)+" / "+f(s(y).columns.length)+"） ",1)]),_:2},1024)):Z("",!0)]))),128)),s(y).rows.length===0?(v(),S(P,{key:0,type:"warning",variant:"tonal",class:"mt-2"},{default:n(()=>[...e[126]||(e[126]=[u(" 請至少添加一行數據 ",-1)])]),_:1})):Z("",!0)])]),_:1},512)]),_:1}),a(He,{class:"justify-end"},{default:n(()=>{var t,c;return[a(C,{variant:"text",disabled:s(k),onClick:s(yl)},{default:n(()=>[...e[127]||(e[127]=[u(" 取消 ",-1)])]),_:1},8,["disabled","onClick"]),a(C,{class:"apple-primary-btn",color:"primary",loading:s(k),disabled:s(k)||!((t=s(y).planId)!=null&&t.trim())||!((c=s(y).title)!=null&&c.trim())||s(y).columns.length===0||s(y).rows.length===0,onClick:s(bl)},{default:n(()=>[...e[128]||(e[128]=[u(" 確認更新 ",-1)])]),_:1},8,["loading","disabled","onClick"])]}),_:1})]),_:1})]),_:1},8,["modelValue"])]))}}),Vs=xt(ss,[["__scopeId","data-v-610f571d"]]);export{Vs as default};
