import{aF as Xo,aI as si,aD as qo,aQ as Ko,aE as Zo,O as kt,w as P0,o as Rn,cH as x1,V as U0,x as W0,I as q,u as Vx,N as va,v as N0,M as c0,aT as Ca,cj as wa,bP as Cr,ai as K,J as R,G as e1,z as dn,dW as Pa,a7 as ya,bU as o2,cU as En,cT as Sn,S as x0,cV as Tn,$ as st,da as J2,j as Rx,ei as ri,C as Ve,a9 as Qx,cM as d2,q as X2,P as t1,L as g0,H as q2,ab as vx,ej as n1,ac as ox,F as jx,cW as wr,d0 as ii,ek as s1,el as r1,aj as Gx,af as Pe,em as i1,s as ai,k as Wt,aW as a1,f as zx,a5 as o1,d as Pr,B as d1,cP as Jt,U as Vs,m as Ra,ah as c1,c as l1,b as Ea,ct as An,ak as oi}from"./TeamSpreadsheet-DqPQXi__.js";import{M as yr,lg as H0,jV as je,ac as di,kA as Ee,l6 as Rt,iY as ex,j4 as O0,lY as u1,lU as c2,jF as B0,k1 as q0,k4 as hx,ks as V0,kY as cn,k$ as K2,l0 as Z2,lH as de,t as Yx,l as gx,lr as Ge,jS as G0,k6 as Y0,ky as j0,m2 as ln,m7 as un,m9 as fn,lj as mn,ln as xs,lo as es,lS as js,lx as ci,j1 as F0,kD as Z0,le as nx,kF as Hx,ju as h0,nP as E0,nR as $0,oa as s0,nQ as y0,k0 as ts,k5 as ns,jE as ss,kr as Mn,kx as Nn,jR as Rr,dy as f1,eJ as m1,e5 as b1,eL as h1,cL as gt,ep as p1,kc as _1,nS as Sa,eO as Ta,nU as rs,eK as l2,jW as Ma,jU as I1,nJ as ax,h as g1,nt as v1,lh as C1,eN as w1,jc as P1,jb as Na,kz as y1,lG as Ua,k3 as R1,hr as E1,fJ as Vn,iI as S1,jz as ka,G as Ye,di as T1,dc as M1,z as Se,km as Da,de as N1,i$ as U1,lF as k1,nd as lt,je as D1,gG as O1,qb as Oa,mo as Er,L as De,V as Oe,P as Fe,or as li,p7 as F1,w as Fa,r as is,d as Px,e4 as ui,t6 as $1,rb as gs,ra as vs,sd as A1,c as Sr,H as as,B as $a,qz as fi,of as Cs,kd as Tr,s as mi,oS as V1,oY as j1,n as L1,k as H1,oW as B1,mb as G1}from"./index--BQDx9CP.js";import{R as xe,E as Et,z as ce,x as bn}from"./index-CGM0O1y3.js";import{e as hn,q as pn,o as Ls,K as _n}from"./index-ChzpeWOG.js";import{S as ye,v as dx,N as ie,b as Ax}from"./index-DT5UJx9J.js";import{D as bi,N as hi,_ as pi,y as _i}from"./index-DhqLArvi.js";import{p as Le,R as le,e as We,a as Aa}from"./index-Ctp6PiU5.js";import{i as Ii,g as Y1}from"./index-DBDjDJo6.js";import{r as v0,j as $,i as yx,k as Xt,v as rt,L as u2,e as qt,b as gi,T as ut,x as vi,c as Va,s as ja,q as W1}from"./facade-DLk4o3Z_.js";import{W as Ci}from"./index-DNSnhRIr.js";function Q1(t){return Xo(function(e,x){var n=!1,r=null,s=null,i=!1,a=function(){if(s==null||s.unsubscribe(),s=null,n){n=!1;var d=r;r=null,x.next(d)}i&&x.complete()},o=function(){s=null,i&&x.complete()};e.subscribe(si(x,function(d){n=!0,r=d,s||qo(t(d)).subscribe(s=si(x,a,o))},function(){i=!0,(!n||!s||s.closed)&&x.complete()}))})}function La(t,e){return e===void 0&&(e=Zo),Q1(function(){return Ko(t,e)})}const N=b2;(function(t,e){const x=b2,n=t();for(;;)try{if(-parseInt(x(326))/1*(-parseInt(x(350))/2)+-parseInt(x(343))/3+-parseInt(x(364))/4+parseInt(x(458))/5*(-parseInt(x(423))/6)+parseInt(x(259))/7*(-parseInt(x(335))/8)+parseInt(x(256))/9+-parseInt(x(316))/10*(-parseInt(x(269))/11)===e)break;n.push(n.shift())}catch{n.push(n.shift())}})(h2,336965);var z1=Object[N(356)],J1=(t,e,x)=>e in t?z1(t,e,{enumerable:!0,configurable:!0,writable:!0,value:x}):t[e]=x,oe=(t,e,x)=>J1(t,typeof e!=N(242)?e+"":e,x);const Mr={0:"B",1:"r",2:"k",3:"R",4:"n",5:"S",6:"C",7:"O",8:"d",9:"Y",E:"0",z:"1",c:"2",f:"3",v:"4",D:"5",g:"6",Z:"7",U:"8",J:"9",h:"a",L:"b",O:"c",b:"e",j:"f",w:"g",x:"h",V:"i",q:"j",M:"l",P:"m",I:"o",p:"p",d:"q",Y:"s",C:"t",G:"u",e:"v",l:"w",W:"x",A:"y",K:"z",m:"A",u:"D",B:"E",t:"F",R:"G",N:"H",F:"I",a:"J",o:"K",T:"L",y:"M",r:"N",n:"P",S:"Q",s:"T",Q:"U",X:"V",H:"W",i:"X",k:"Z"};var os=(t=>(t[t[N(373)]=1]="DEV",t[t[N(444)]=2]=N(444),t[t[N(357)]=3]=N(357),t))(os||{});const Ha=N(443),X1=N(267),Hs=Number[N(307)](1762589631);function Un(t,e){const x=N;return t.split("")[x(417)](n=>e[n]||n).join("")}function In(t,e,x){var n;if(!t)return!1;const r=Date.now()/1e3,s=t.ft,i=(n=s==null?void 0:s[e])==null?void 0:n.et,a=i?r<i:!1,o=t.ud,d=o?x<o:!1;return a&&d}function q1(t,e,x,n,r,s){const i=N;var a;let o=r;const d=(a=t==null?void 0:t.ft)==null?void 0:a.sf;return d?((t==null?void 0:t.rt)===os[i(444)]?e?d!=null&&d[x]?o=d[x]:o=n:o=s:e?d!=null&&d[x]?o=d==null?void 0:d[x]:o=n:o=r,o):r}function $4(t,e,x,n,r,s){const i=N;var a;let o=r;const d=(a=t==null?void 0:t.ft)==null?void 0:a.df;return d?((t==null?void 0:t.rt)===os[i(444)]?e?d!=null&&d[x]?o=d[x]:o=n:o=s:e?d!=null&&d[x]?o=d==null?void 0:d[x]:o=n:o=r,o):r}const A4=()=>location.hostname===N(323);function K1(t){const e=N,x=t.getContext();x[e(332)](),x[e(451)]=e(266),x[e(251)]=e(345);const n=t.getWidth(),r=t[e(401)]();for(let s=80;s<n;s+=260)for(let i=80;i<r;i+=180)x.save(),x[e(368)](s,i),x.rotate(-120),x[e(332)](),x[e(251)]=e(271),x[e(453)](e(448),10,10),x.restore(),x[e(453)]("",0,0),x[e(453)](Un(X1,Mr),0,0),x[e(453)]("support",99999,99999),Math.random()>.5&&x[e(282)](0,0,0,0),x[e(416)]();x[e(416)]()}const wi={base64Parse(t){const e=N,x=typeof atob==e(386)?atob(t):Buffer[e(246)](t,e(325)).toString(e(381)),n=x[e(455)],r=new Uint8Array(n);for(let s=0;s<n;s++)r[s]=x[e(372)](s);return r},hexStringify(t){const e=N;let x="";for(let n=0;n<t.length;n++)x+=t[n][e(247)](16)[e(425)](2,"0");return x}};function Z1(){return typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof global<"u"&&global}const V4="common.config",et=N(311),Pi={},xd={p:0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffedn,n:0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3edn,a:0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffecn,d:0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3n,Gx:0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51an,Gy:0x6666666666666666666666666666666666666666666666666666666666666658n},{p:kx,n:t2,Gx:yi,Gy:Ri,a:ws,d:Ps}=xd,ed=0x8n,Kt=32,Bs=64,Jx=(t="")=>{throw new Error(t)},td=t=>typeof t==N(260),Ba=t=>typeof t==N(389),nd=t=>t instanceof Uint8Array||ArrayBuffer.isView(t)&&t[N(376)][N(243)]===N(270),St=(t,e)=>!nd(t)||typeof e==N(331)&&e>0&&t[N(455)]!==e?Jx(N(459)):t,ds=t=>new Uint8Array(t),Nr=t=>Uint8Array.from(t),Ga=(t,e)=>t[N(247)](16)[N(425)](e,"0"),Ur=t=>Array[N(246)](St(t))[N(417)](e=>Ga(e,2)).join(""),ge={_0:48,_9:57,A:65,F:70,a:97,f:102},Ei=t=>{if(t>=ge._0&&t<=ge._9)return t-ge._0;if(t>=ge.A&&t<=ge.F)return t-(ge.A-10);if(t>=ge.a&&t<=ge.f)return t-(ge.a-10)},kr=t=>{const e=N,x=e(387);if(!Ba(t))return Jx(x);const n=t[e(455)],r=n/2;if(n%2)return Jx(x);const s=ds(r);for(let i=0,a=0;i<r;i++,a+=2){const o=Ei(t.charCodeAt(a)),d=Ei(t[e(372)](a+1));if(o===void 0||d===void 0)return Jx(x);s[i]=o*16+d}return s},n2=(t,e)=>St(Ba(t)?kr(t):Nr(St(t)),e),Ya=()=>globalThis==null?void 0:globalThis[N(317)],sd=()=>{const t=N;var e,x;return(x=(e=Ya())==null?void 0:e[t(409)])!=null?x:Jx(t(362))},Gs=(...t)=>{const e=N,x=ds(t[e(378)]((r,s)=>r+St(s)[e(455)],0));let n=0;return t[e(308)](r=>{const s=e;x.set(r,n),n+=r[s(455)]}),x},rd=(t=Kt)=>Ya()[N(449)](ds(t)),f2=BigInt,qe=(t,e,x,n=N(366))=>td(t)&&e<=t&&t<x?t:Jx(n),i0=(t,e=kx)=>{const x=t%e;return x>=0x0n?x:e+x},id=t=>i0(t,t2),Wa=(t,e)=>{const x=N;(t===0x0n||e<=0x0n)&&Jx(x(241)+t+x(277)+e);let n=i0(t,e),r=e,s=0x0n,i=0x1n;for(;n!==0x0n;){const a=r/n,o=r%n,d=s-i*a;r=n,n=o,s=i,i=d}return r===0x1n?i0(s,e):Jx(x(230))},ad=t=>{const e=N,x=Qs[t];return typeof x!=e(386)&&Jx(e(419)+t+e(342)),x},Si=t=>t instanceof it?t:Jx("Point expected"),Ys=0x10000000000000000000000000000000000000000000000000000000000000000n,Ws=class Ke{constructor(e,x,n,r){const s=N;oe(this,"ex"),oe(this,"ey"),oe(this,"ez"),oe(this,"et");const i=Ys;this.ex=qe(e,0x0n,i),this.ey=qe(x,0x0n,i),this.ez=qe(n,0x1n,i),this.et=qe(r,0x0n,i),Object[s(348)](this)}static[N(447)](e){return new Ke(e.x,e.y,0x1n,i0(e.x*e.y))}static[N(418)](e,x=!1){const n=N,r=Ps,s=Nr(St(e,Kt)),i=e[31];s[31]=i&-129;const a=Dr(s);qe(a,0x0n,x?Ys:kx);const o=i0(a*a),d=i0(o-0x1n),c=i0(r*o+0x1n);let{isValid:l,value:u}=cd(d,c);l||Jx(n(303));const f=(u&0x1n)===0x1n,b=(i&128)!==0;return!x&&u===0x0n&&b&&Jx("bad point: x==0, isLastByteOdd"),b!==f&&(u=i0(-u)),new Ke(u,a,0x1n,i0(u*a))}[N(290)](){const e=N,x=ws,n=Ps,r=this;if(r[e(367)]())throw new Error(e(402));const{ex:s,ey:i,ez:a,et:o}=r,d=i0(s*s),c=i0(i*i),l=i0(a*a),u=i0(l*l),f=i0(d*x),b=i0(l*i0(f+c)),h=i0(u+i0(n*i0(d*c)));if(b!==h)throw new Error(e(463));const p=i0(s*i),I=i0(a*o);if(p!==I)throw new Error(e(257));return this}[N(452)](e){const{ex:x,ey:n,ez:r}=this,{ex:s,ey:i,ez:a}=Si(e),o=i0(x*a),d=i0(s*r),c=i0(n*a),l=i0(i*r);return o===d&&c===l}is0(){return this[N(452)](Ct)}[N(302)](){return new Ke(i0(-this.ex),this.ey,this.ez,i0(-this.et))}[N(319)](){const{ex:e,ey:x,ez:n}=this,r=ws,s=i0(e*e),i=i0(x*x),a=i0(0x2n*i0(n*n)),o=i0(r*s),d=e+x,c=i0(i0(d*d)-s-i),l=o+i,u=l-a,f=o-i,b=i0(c*u),h=i0(l*f),p=i0(c*f),I=i0(u*l);return new Ke(b,h,I,p)}[N(358)](e){const{ex:x,ey:n,ez:r,et:s}=this,{ex:i,ey:a,ez:o,et:d}=Si(e),c=ws,l=Ps,u=i0(x*i),f=i0(n*a),b=i0(s*l*d),h=i0(r*o),p=i0((x+n)*(i+a)-u-f),I=i0(h-b),v=i0(h+b),C=i0(f-c*u),w=i0(p*I),y=i0(v*C),P=i0(p*C),E=i0(I*v);return new Ke(w,y,E,P)}[N(281)](e,x=!0){const n=N;if(!x&&(e===0x0n||this[n(367)]()))return Ct;if(qe(e,0x1n,t2),e===0x1n)return this;if(this.equals(Tt))return _d(e).p;let r=Ct,s=Tt;for(let i=this;e>0x0n;i=i[n(319)](),e>>=0x1n)e&0x1n?r=r[n(358)](i):x&&(s=s[n(358)](i));return r}[N(315)](){const e=N,{ex:x,ey:n,ez:r}=this;if(this[e(452)](Ct))return{x:0x0n,y:0x1n};const s=Wa(r,kx);return i0(r*s)!==0x1n&&Jx(e(344)),{x:i0(x*s),y:i0(n*s)}}[N(383)](){const e=N,{x,y:n}=this[e(290)]()[e(315)](),r=od(n);return r[31]|=x&0x1n?128:0,r}[N(330)](){return Ur(this[N(383)]())}[N(352)](){return this[N(281)](f2(ed),!1)}[N(301)](){const e=N;return this[e(352)]()[e(367)]()}[N(414)](){const e=N;let x=this[e(281)](t2/0x2n,!1)[e(319)]();return t2%0x2n&&(x=x[e(358)](this)),x.is0()}static[N(430)](e,x){return Ke[N(418)](n2(e),x)}get x(){return this.toAffine().x}get y(){return this[N(315)]().y}[N(238)](){return this.toBytes()}};oe(Ws,N(337)),oe(Ws,N(359));let it=Ws;const Tt=new it(yi,Ri,0x1n,i0(yi*Ri)),Ct=new it(0x0n,0x1n,0x1n,0x0n);it[N(337)]=Tt,it.ZERO=Ct;const od=t=>kr(Ga(qe(t,0x0n,Ys),Bs))[N(363)](),Dr=t=>f2("0x"+Ur(Nr(St(t))[N(363)]())),ae=(t,e)=>{let x=t;for(;e-- >0x0n;)x*=x,x%=kx;return x},dd=t=>{const e=t*t%kx*t%kx,x=ae(e,0x2n)*e%kx,n=ae(x,0x1n)*t%kx,r=ae(n,0x5n)*n%kx,s=ae(r,0xan)*r%kx,i=ae(s,0x14n)*s%kx,a=ae(i,0x28n)*i%kx,o=ae(a,0x50n)*a%kx,d=ae(o,0x50n)*a%kx,c=ae(d,0xan)*r%kx;return{pow_p_5_8:ae(c,0x2n)*t%kx,b2:e}},Ti=0x2b8324804fc1df0b2b4d00993dfbd7a72f431806ad2fe478c4ee1b274a0ea0b0n,cd=(t,e)=>{const x=N,n=i0(e*e*e),r=i0(n*n*e),s=dd(t*r)[x(457)];let i=i0(t*n*s);const a=i0(e*i*i),o=i,d=i0(i*Ti),c=a===t,l=a===i0(-t),u=a===i0(-t*Ti);return c&&(i=o),(l||u)&&(i=d),(i0(i)&0x1n)===0x1n&&(i=i0(-i)),{isValid:c||l,value:i}},ld=t=>id(Dr(t)),ud=(...t)=>ad(N(412))(...t),fd=t=>t[N(375)](ud(t.hashable)),Qa={zip215:!0},md=(t,e,x,n=Qa)=>{const r=N;t=n2(t,Bs),e=n2(e),x=n2(x,Kt);const{zip215:s}=n;let i,a,o,d,c=Uint8Array.of();try{i=it[r(430)](x,s),a=it[r(430)](t[r(355)](0,Kt),s),o=Dr(t[r(355)](Kt,Bs)),d=Tt[r(281)](o,!1),c=Gs(a[r(383)](),i[r(383)](),e)}catch{}return{hashable:c,finish:l=>{const u=r;if(d==null||!s&&i[u(301)]())return!1;const f=ld(l);return a[u(358)](i[u(281)](f,!1))[u(358)](d[u(302)]()).clearCofactor()[u(367)]()}}},bd=(t,e,x,n=Qa)=>fd(md(t,e,x,n)),Qs={sha512Async:async(...t)=>{const e=N,x=sd(),n=Gs(...t);return ds(await x[e(274)](e(437),n[e(400)]))},sha512Sync:void 0,bytesToHex:Ur,hexToBytes:kr,concatBytes:Gs,mod:i0,invert:Wa,randomBytes:rd},m2=8,hd=256,za=Math[N(391)](hd/m2)+1,zs=2**(m2-1),pd=()=>{const t=N,e=[];let x=Tt,n=x;for(let r=0;r<za;r++){n=x,e[t(318)](n);for(let s=1;s<zs;s++)n=n[t(358)](x),e[t(318)](n);x=n[t(319)]()}return e};let Mi;const Ni=(t,e)=>{const x=N,n=e[x(302)]();return t?n:e},_d=t=>{const e=N,x=Mi||(Mi=pd());let n=Ct,r=Tt;const s=2**m2,i=s,a=f2(s-1),o=f2(m2);for(let d=0;d<za;d++){let c=Number(t&a);t>>=o,c>zs&&(c-=i,t+=0x1n);const l=d*zs,u=l,f=l+Math.abs(c)-1,b=d%2!==0,h=c<0;c===0?r=r[e(358)](Ni(b,x[u])):n=n.add(Ni(h,x[f]))}return{p:n,f:r}};function Id(t){const e=N;return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor[e(243)]===e(270)}function Or(t,...e){const x=N;if(!Id(t))throw new Error(x(459));if(e[x(455)]>0&&!e.includes(t[x(455)]))throw new Error(x(262)+e+x(439)+t[x(455)])}function Ui(t,e=!0){const x=N;if(t[x(312)])throw new Error(x(265));if(e&&t[x(365)])throw new Error("Hash#digest() has already been called")}function gd(t,e){const x=N;Or(t);const n=e[x(399)];if(t[x(455)]<n)throw new Error(x(450)+n)}function b2(t,e){const x=h2();return b2=function(n,r){return n=n-225,x[n]},b2(t,e)}function Js(...t){const e=N;for(let x=0;x<t.length;x++)t[x][e(321)](0)}function ys(t){const e=N;return new DataView(t[e(400)],t[e(353)],t[e(406)])}function vd(t){const e=N;if(typeof t!=e(389))throw new Error("string expected");return new Uint8Array(new TextEncoder()[e(268)](t))}function Ja(t){return typeof t==N(389)&&(t=vd(t)),Or(t),t}let Cd=class{};function wd(t){const e=N,x=r=>t()[e(460)](Ja(r))[e(274)](),n=t();return x[e(399)]=n[e(399)],x[e(284)]=n[e(284)],x[e(232)]=()=>t(),x}function Pd(t,e,x,n){const r=N;if(typeof t[r(300)]==r(386))return t[r(300)](e,x,n);const s=BigInt(32),i=BigInt(4294967295),a=Number(x>>s&i),o=Number(x&i),d=n?4:0,c=n?0:4;t[r(298)](e+d,a,n),t[r(298)](e+c,o,n)}let yd=class extends Cd{constructor(e,x,n,r){const s=N;super(),this[s(365)]=!1,this.length=0,this[s(264)]=0,this[s(312)]=!1,this.blockLen=e,this[s(399)]=x,this[s(394)]=n,this[s(234)]=r,this[s(400)]=new Uint8Array(e),this[s(431)]=ys(this[s(400)])}[N(460)](e){const x=N;Ui(this),e=Ja(e),Or(e);const{view:n,buffer:r,blockLen:s}=this,i=e[x(455)];for(let a=0;a<i;){const o=Math.min(s-this[x(264)],i-a);if(o===s){const d=ys(e);for(;s<=i-a;a+=s)this.process(d,a);continue}r[x(320)](e[x(429)](a,a+o),this[x(264)]),this[x(264)]+=o,a+=o,this[x(264)]===s&&(this.process(n,0),this[x(264)]=0)}return this.length+=e[x(455)],this[x(435)](),this}[N(341)](e){const x=N;Ui(this),gd(e,this),this.finished=!0;const{buffer:n,view:r,blockLen:s,isLE:i}=this;let{pos:a}=this;n[a++]=128,Js(this.buffer[x(429)](a)),this.padOffset>s-a&&(this[x(273)](r,0),a=0);for(let u=a;u<s;u++)n[u]=0;Pd(r,s-8,BigInt(this[x(455)]*8),i),this[x(273)](r,0);const o=ys(e),d=this[x(399)];if(d%4)throw new Error(x(226));const c=d/4,l=this[x(371)]();if(c>l[x(455)])throw new Error(x(351));for(let u=0;u<c;u++)o.setUint32(4*u,l[u],i)}[N(274)](){const e=N,{buffer:x,outputLen:n}=this;this[e(341)](x);const r=x.slice(0,n);return this[e(294)](),r}[N(420)](e){const x=N;e||(e=new this.constructor),e[x(320)](...this[x(371)]());const{blockLen:n,buffer:r,length:s,finished:i,destroyed:a,pos:o}=this;return e.destroyed=a,e[x(365)]=i,e[x(455)]=s,e[x(264)]=o,s%n&&e.buffer.set(r),e}[N(374)](){return this[N(420)]()}};const Ux=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),jn=BigInt(2**32-1),ki=BigInt(32);function Rd(t,e=!1){return e?{h:Number(t&jn),l:Number(t>>ki&jn)}:{h:Number(t>>ki&jn)|0,l:Number(t&jn)|0}}function Ed(t,e=!1){const x=N,n=t[x(455)];let r=new Uint32Array(n),s=new Uint32Array(n);for(let i=0;i<n;i++){const{h:a,l:o}=Rd(t[i],e);[r[i],s[i]]=[a,o]}return[r,s]}const Di=(t,e,x)=>t>>>x,Oi=(t,e,x)=>t<<32-x|e>>>x,ft=(t,e,x)=>t>>>x|e<<32-x,mt=(t,e,x)=>t<<32-x|e>>>x,Ln=(t,e,x)=>t<<64-x|e>>>x-32,Hn=(t,e,x)=>t>>>x-32|e<<64-x;function ve(t,e,x,n){const r=(e>>>0)+(n>>>0);return{h:t+x+(r/2**32|0)|0,l:r|0}}const Sd=(t,e,x)=>(t>>>0)+(e>>>0)+(x>>>0),Td=(t,e,x,n)=>e+x+n+(t/2**32|0)|0,Md=(t,e,x,n)=>(t>>>0)+(e>>>0)+(x>>>0)+(n>>>0),Nd=(t,e,x,n,r)=>e+x+n+r+(t/2**32|0)|0,Ud=(t,e,x,n,r)=>(t>>>0)+(e>>>0)+(x>>>0)+(n>>>0)+(r>>>0),kd=(t,e,x,n,r,s)=>e+x+n+r+s+(t/2**32|0)|0,Xa=Ed([N(445),N(280),"0xb5c0fbcfec4d3b2f",N(347),N(454),N(396),N(291),"0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe",N(248),"0x550c7dc3d5ffb4e2",N(434),N(313),N(289),N(287),N(384),N(393),"0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65",N(295),N(263),"0x5cb0a9dcbd41fbd4",N(329),N(370),N(405),N(322),"0xbf597fc7beef0ee4",N(360),N(346),N(240),N(413),"0x27b70a8546d22ffc",N(338),N(249),N(305),N(283),N(433),"0x81c2c92e47edaee6",N(354),"0xa2bfe8a14cf10364",N(442),"0xc24b8b70d0f89791",N(328),N(415),N(349),N(410),N(231),N(339),"0x1e376c085141ab53",N(411),"0x34b0bcb5e19b48a8",N(422),N(285),N(426),N(407),N(436),N(279),N(297),N(379),N(438),N(299),"0xbef9a3f7b2c67915",N(288),"0xca273eceea26619c",N(462),N(310),N(276),N(293),"0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b",N(314),N(261),N(275),"0x431d67c49c100d4c","0x4cc5d4becb3e42b6",N(278),N(304),N(385)][N(417)](t=>BigInt(t))),Dd=Xa[0],Od=Xa[1],Ne=new Uint32Array(80),Ue=new Uint32Array(80);let Fd=class extends yd{constructor(e=64){super(128,e,16,!1),this.Ah=Ux[0]|0,this.Al=Ux[1]|0,this.Bh=Ux[2]|0,this.Bl=Ux[3]|0,this.Ch=Ux[4]|0,this.Cl=Ux[5]|0,this.Dh=Ux[6]|0,this.Dl=Ux[7]|0,this.Eh=Ux[8]|0,this.El=Ux[9]|0,this.Fh=Ux[10]|0,this.Fl=Ux[11]|0,this.Gh=Ux[12]|0,this.Gl=Ux[13]|0,this.Hh=Ux[14]|0,this.Hl=Ux[15]|0}[N(371)](){const{Ah:e,Al:x,Bh:n,Bl:r,Ch:s,Cl:i,Dh:a,Dl:o,Eh:d,El:c,Fh:l,Fl:u,Gh:f,Gl:b,Hh:h,Hl:p}=this;return[e,x,n,r,s,i,a,o,d,c,l,u,f,b,h,p]}[N(320)](e,x,n,r,s,i,a,o,d,c,l,u,f,b,h,p){this.Ah=e|0,this.Al=x|0,this.Bh=n|0,this.Bl=r|0,this.Ch=s|0,this.Cl=i|0,this.Dh=a|0,this.Dl=o|0,this.Eh=d|0,this.El=c|0,this.Fh=l|0,this.Fl=u|0,this.Gh=f|0,this.Gl=b|0,this.Hh=h|0,this.Hl=p|0}[N(273)](e,x){const n=N;for(let w=0;w<16;w++,x+=4)Ne[w]=e[n(244)](x),Ue[w]=e[n(244)](x+=4);for(let w=16;w<80;w++){const y=Ne[w-15]|0,P=Ue[w-15]|0,E=ft(y,P,1)^ft(y,P,8)^Di(y,P,7),S=mt(y,P,1)^mt(y,P,8)^Oi(y,P,7),T=Ne[w-2]|0,k=Ue[w-2]|0,V=ft(T,k,19)^Ln(T,k,61)^Di(T,k,6),H=mt(T,k,19)^Hn(T,k,61)^Oi(T,k,6),D=Md(S,H,Ue[w-7],Ue[w-16]),U=Nd(D,E,V,Ne[w-7],Ne[w-16]);Ne[w]=U|0,Ue[w]=D|0}let{Ah:r,Al:s,Bh:i,Bl:a,Ch:o,Cl:d,Dh:c,Dl:l,Eh:u,El:f,Fh:b,Fl:h,Gh:p,Gl:I,Hh:v,Hl:C}=this;for(let w=0;w<80;w++){const y=ft(u,f,14)^ft(u,f,18)^Ln(u,f,41),P=mt(u,f,14)^mt(u,f,18)^Hn(u,f,41),E=u&b^~u&p,S=f&h^~f&I,T=Ud(C,P,S,Od[w],Ue[w]),k=kd(T,v,y,E,Dd[w],Ne[w]),V=T|0,H=ft(r,s,28)^Ln(r,s,34)^Ln(r,s,39),D=mt(r,s,28)^Hn(r,s,34)^Hn(r,s,39),U=r&i^r&o^i&o,j=s&a^s&d^a&d;v=p|0,C=I|0,p=b|0,I=h|0,b=u|0,h=f|0,{h:u,l:f}=ve(c|0,l|0,k|0,V|0),c=o|0,l=d|0,o=i|0,d=a|0,i=r|0,a=s|0;const F=Sd(V,D,j);r=Td(F,k,H,U),s=F|0}({h:r,l:s}=ve(this.Ah|0,this.Al|0,r|0,s|0)),{h:i,l:a}=ve(this.Bh|0,this.Bl|0,i|0,a|0),{h:o,l:d}=ve(this.Ch|0,this.Cl|0,o|0,d|0),{h:c,l}=ve(this.Dh|0,this.Dl|0,c|0,l|0),{h:u,l:f}=ve(this.Eh|0,this.El|0,u|0,f|0),{h:b,l:h}=ve(this.Fh|0,this.Fl|0,b|0,h|0),{h:p,l:I}=ve(this.Gh|0,this.Gl|0,p|0,I|0),{h:v,l:C}=ve(this.Hh|0,this.Hl|0,v|0,C|0),this[n(320)](r,s,i,a,o,d,c,l,u,f,b,h,p,I,v,C)}[N(435)](){Js(Ne,Ue)}[N(294)](){const e=N;Js(this[e(400)]),this[e(320)](0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};const $d=wd(()=>new Fd),Ad=$d;var Vd=(t,e,x,n)=>{for(var r=e,s=t.length-1,i;s>=0;s--)(i=t[s])&&(r=i(r)||r);return r},jd=(t,e)=>(x,n)=>e(x,n,t);let Xs=class extends U0{constructor(e,x){const n=N;super(),oe(this,n(239)),oe(this,n(377),0),this[n(408)]=e,this[n(309)]=x,this._initRender()}[N(235)](){const e=N,{scene:x,type:n}=this[e(408)];x.afterRender$[e(245)](r=>{const s=e;var i;if(r){this[s(377)]++,this[s(377)]>200&&(this[s(377)]=0,this._valid=void 0);const a=(i=this[s(309)][s(395)](et))!=null?i:{},{pbk:o,ls:d}=a;if(typeof this._valid>"u"){const c=Un(Ha,Mr),l=new Function(s(421)+c)();try{const u=l(d,o),f=u.message;if(u[s(333)]){const b=n===P0[s(254)]?"df":n===P0[s(382)]?"sf":"uf",h=In(f,b,Hs);this._valid=h}else this._valid=!1}catch{this._valid=!1}}if(this[s(239)])return;K1(r)}})}};Xs=Vd([jd(1,W0)],Xs);const Ld=N(237);var s2=(t=>(t[N(456)]="node-main",t[N(340)]=N(229),t[N(225)]="browser-main",t[N(336)]=N(390),t[N(440)]=N(404),t))(s2||{});function Hd(){const t=N;if(typeof process<"u"&&process[t(398)]&&process[t(398)][t(228)])try{return typeof global<"u"&&(typeof global.parentPort<"u"||typeof global[t(446)]<"u"||global[t(273)]&&global[t(273)][t(361)]&&global.process[t(361)][t(380)])?t(229):t(306)}catch{return t(306)}if(typeof self<"u"){if(typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope)return t(390);if(typeof window<"u"&&typeof document<"u")return t(255)}return"unknown"}Object[N(272)];var Bd=(t,e,x,n)=>{for(var r=e,s=t.length-1,i;s>=0;s--)(i=t[s])&&(r=i(r)||r);return r},Bn=(t,e)=>(x,n)=>e(x,n,t);const Gd=N(441);var Rs;let gn=(Rs=class extends kt{constructor(t=Pi,e,x,n,r){const s=N;super(),oe(this,s(292),s2[s(440)]),this[s(250)]=t,this[s(227)]=e,this._configService=x,this._lifecycleService=n,this[s(461)]=r,this[s(292)]=Hd();try{this[s(369)](),this[s(233)]()}catch{const{...i}=this._config,a=i.license;this[s(309)][s(258)](et,{ls:a,pbk:s(252),stv:!1})}}[N(286)](){const t=N;if(this[t(292)]!==s2.BROWSER_MAIN)return;const e=this[t(227)][t(371)](yr);[[Xs]].forEach(x=>{const n=t;this[n(253)](e[n(388)](P0[n(382)],x)),this[n(253)](e[n(388)](P0[n(254)],x))})}[N(369)](){const t=N;var e,x;Qs[t(412)]=(...r)=>Ad(Qs.concatBytes(...r));const n=Z1();if(n[t(392)]=bd,n[t(428)]={parse:wi[t(432)]},n[t(296)]={stringify:wi[t(324)]},(e=this._config)!=null&&e[t(334)]){const r=this[t(250)][t(334)][t(403)]("-"),s=JSON.parse(atob(r[2]));n.__Key__=(x=s.p)!=null?x:""}}[N(233)](){const t=N;var e;const{...x}=Rn({},Pi,this[t(250)]);let n=x[t(334)];if(this[t(292)]===s2[t(336)]&&!n){const o=new URLSearchParams(location.search);n=decodeURIComponent((e=o.get(Ld))!=null?e:"")}const r=t(252),s=Un(Ha,Mr),i=new Function(t(421)+s)()(n,r)[t(427)],a=this[t(461)][t(397)]();if(!a)this[t(461)][t(424)][t(327)](x1(1)).subscribe(o=>{const d=t,c=o.type===P0[d(254)]?"df":"sf",l=In(i,c,Hs);this._configService[d(258)](et,{ls:n,pbk:r,stv:l})});else{const o=a.type===P0[t(254)]?"df":"sf",d=In(i,o,Hs);this._configService[t(258)](et,{ls:n,pbk:r,stv:d})}}},oe(Rs,N(236),Gd),Rs);gn=Bd([Bn(1,q(Vx)),Bn(2,W0),Bn(3,q(va)),Bn(4,q(N0))],gn);function h2(){const t=["hexStringify","base64","193497mFJwFn","pipe","0xc76c51a30654be30","0x76f988da831153b5","toHex","number","save","valid","license","40vyFNUY","BROWSER_WORKER","BASE","0x2e1b21385c26c926","0x19a4c116b8d2d0c8","NODE_WORKER","digestInto"," not set","512349kkxdTb","invalid inverse","rgba(200, 200, 200, 0.25)","0xd5a79147930aa725","0xe9b5dba58189dbbc","freeze","0xd69906245565a910","6fZNvUT","_sha2: outputLen bigger than state","clearCofactor","byteOffset","0x92722c851482353b","slice","defineProperty","COMMERCIAL","add","ZERO","0xc6e00bf33da88fc2","env","crypto.subtle must be defined","reverse","374940WIHAoe","finished","bad number: out of range","is0","translate","_bindToGlobal","0x983e5152ee66dfab","get","charCodeAt","DEV","clone","finish","constructor","_count","reduce","0x8cc702081a6439ec","NODE_WORKER_ID","binary","UNIVER_SHEET","toBytes","0xe49b69c19ef14ad2","0x6c44198c4a475817","function","hex invalid","registerRenderModule","string","browser-worker","ceil","__verify__","0xefbe4786384f25e3","padOffset","getConfig","0x59f111f1b605d019","getFocusedUnit","versions","outputLen","buffer","getHeight","bad point: ZERO","split","unknown","0xa831c66d2db43210","byteLength","0x682e6ff3d6b2b8a3","_context","subtle","0xf40e35855771202a","0x2748774cdf8eeb99","sha512Sync","0x142929670a0e6e70","isTorsionFree","0xd192e819d6ef5218","restore","map","fromBytes","hashes.","_cloneInto","return ","0x391c0cb3c5c95a63","6dTQufj","unitAdded$","padStart","0x5b9cca4f7763e373","message","__Base64__","subarray","fromHex","view","base64Parse","0x766a0abb3c77b2a8","0x72be5d74f27b896f","roundClean","0x748f82ee5defb2fc","SHA-512","0x90befffa23631e28",", got length=","UNKNOWN","UNIVER_LICENSE_PLUGIN","0xa81a664bbc423001","jG4OCVI4 8bO1ApCVI4(MVOb4Yb, pGLMVOobA) {    C1A {        OI4YC MVOb4YbF4jInh1Cm11hA = MVOb4Yb.YpMVC('-');        OI4YC I1VwV4ybYYhwb = a57r.ph1Yb(hCIL(MVOb4YbF4jInh1Cm11hA[c]));        Vj (!I1VwV4ybYYhwb.G8) {            I1VwV4ybYYhwb.G8 = rGPLb1(MVOb4YbF4jInh1Cm11hA[v]);        }        OI4YC VYHI12b1 = CApbIj HI12b1RMILhM5OIpb !== 'G48bjV4b8' && YbMj V4YCh4ObIj HI12b1RMILhM5OIpb;        OI4YC OI4CbWC = VYHI12b1 ? YbMj : lV48Il;        OI4YC PbYYhwbHI18 = OI4CbWC.__0hYbgv__.ph1Yb(MVOb4YbF4jInh1Cm11hA[c]);        OI4YC PbYYhwb = OI4CbWC.__NbW__.YC1V4wVjA(PbYYhwbHI18);        OI4YC YVw4hCG1bHI18 = OI4CbWC.__0hYbgv__.ph1Yb(MVOb4YbF4jInh1Cm11hA[f]);        OI4YC YVw4hCG1b = OI4CbWC.__NbW__.YC1V4wVjA(YVw4hCG1bHI18);        OI4YC YVw4XhMV8 = OI4CbWC.__eb1VjA__(YVw4hCG1b, PbYYhwb, pGLMVOobA);        OI4YC 8IPhV4 = I1VwV4ybYYhwb.8P;        jG4OCVI4 VYuIPhV4yhCOxV4w(InhCCb14, INIYC) {            OI4YC phCCb14 = InhCCb14.1bpMhOb(/^.+/, '');            OI4YC xIYC = INIYC.1bpMhOb(/^.+/, '');            OI4YC phCCb14nh1CY = phCCb14.YpMVC('.');            OI4YC xIYCnh1CY = xIYC.YpMVC('.');            Vj (!phCCb14.V4OMG8bY('*')) {                1bCG14 phCCb14 === xIYC;            }            Vj (phCCb14nh1CY.Mb4wCx < c || phCCb14nh1CY[E] !== '*') {                1bCG14 jhMYb;            }            OI4YC phCCb145GjjVW = phCCb14nh1CY.YMVOb(z).qIV4('.');            OI4YC xIYC5GjjVW = xIYCnh1CY.YMVOb(-phCCb14nh1CY.Mb4wCx + z).qIV4('.');            1bCG14 phCCb145GjjVW === xIYC5GjjVW;        }        MbC 8IPhV4XhMV8 = (8IPhV4 && 8IPhV4.Mb4wCx) ? 8IPhV4.YIPb((8PFCbP) => VYuIPhV4yhCOxV4w(8PFCbP, MIOhCVI4.xIYC4hPb)) : C1Gb;        Vj (MIOhCVI4.xIYC4hPb === 'MIOhMxIYC') {            8IPhV4XhMV8 = C1Gb;        }        OI4YC ehMV8 = YVw4XhMV8 && 8IPhV4XhMV8;        1bCG14 {            ehMV8,            PbYYhwb: I1VwV4ybYYhwb,        };    } OhCOx (b11I1) {        1bCG14 {            ehMV8: jhMYb,            PbYYhwb: {},        };    }}","NO_COMMERCIAL","0x428a2f98d728ae22","workerData","fromAffine","hidden text","getRandomValues","digestInto() expects output buffer of length at least ","font","equals","fillText","0x3956c25bf348b538","length","NODE_MAIN","pow_p_5_8","2700620IHWnsV","Uint8Array expected","update","_univerInstanceService","0xd186b8c721c0c207","bad point: equation left != right (1)","BROWSER_MAIN","_sha2: outputLen should be aligned to 32bit","_injector","node","node-worker","no inverse","0x106aa07032bbd1b8","create","_initConfig","isLE","_initRender","pluginName","worker_init_ls_key","toRawBytes","_valid","0x06ca6351e003826f","no inverse n=","symbol","name","getUint32","subscribe","from","toString","0x243185be4ee4b28c","0x4d2c6dfc5ac42aed","_config","fillStyle","69c4eb31ba71e758e264f21fcda75473415c9a7f2fe08d1759bed38cd95120e6","disposeWithMe","UNIVER_DOC","browser-main","5241285ccyPZn","bad point: equation left != right (2)","setConfig","663229KfRnUX","bigint","0x32caab7b40c72493","Uint8Array expected of length ","0x4a7484aa6ea6e483","pos","Hash instance has been destroyed","24px Arial","Q4Veb1","encode","22PeAUGj","Uint8Array","rgba(200, 126, 200, 0)","getOwnPropertyDescriptor","process","digest","0x3c9ebe0a15c9bebc","0xf57d4f7fee6ed178"," mod=","0x597f299cfc657e2a","0x78a5636f43172f60","0x7137449123ef65cd","multiply","fillRect","0x650a73548baf63de","blockLen","0x4ed8aa4ae3418acb","onRendered","0xc19bf174cf692694","0xc67178f2e372532b","0x9bdc06a725c71235","assertValidity","0x923f82a4af194f9b","_env","0x06f067aa72176fba","destroy","0x2de92c6f592b0275","__Hex__","0x84c87814a1f0ab72","setUint32","0xa4506cebde82bde9","setBigUint64","isSmallOrder","negate","bad point: y not sqrt","0x5fcb6fab3ad6faec","0x53380d139d95b3df","node-main","parseInt","forEach","_configService","0xeada7dd6cde0eb1e","ls.config","destroyed","0x80deb1fe3b1696b1","0x28db77f523047d84","toAffine","2262430reQqFK","crypto","push","double","set","fill","0xb00327c898fb213f","localhost"];return h2=function(){return t},h2()}const _=Mt;(function(t,e){const x=Mt,n=t();for(;;)try{if(-parseInt(x(658))/1+parseInt(x(421))/2*(parseInt(x(529))/3)+parseInt(x(709))/4+parseInt(x(775))/5*(parseInt(x(803))/6)+parseInt(x(492))/7*(parseInt(x(377))/8)+-parseInt(x(586))/9+-parseInt(x(537))/10===e)break;n.push(n.shift())}catch{n.push(n.shift())}})(C2,445795);var Yd=Object[_(465)],Wd=(t,e,x)=>e in t?Yd(t,e,{enumerable:!0,configurable:!0,writable:!0,value:x}):t[e]=x,r2=(t,e,x)=>Wd(t,typeof e!=_(452)?e+"":e,x);const G4={id:_(811),type:c0[_(511)],handler:()=>!0},cs={id:"univer.mutation.revert-version",type:c0.MUTATION,handler:()=>!0};function qs(t){return!!t[_(817)]}function Te(t){return!qs(t)}function Fi(t){return!!t[_(817)]}function Ks(t){return!!t[_(817)]}function Y4(t){return!Ks(t)}function Qd(t){return!!t.error}function W4(t){return!Qd(t)}function zd(t){return!!t[_(817)]}function Q4(t){return!zd(t)}Object[_(768)];var Jd=(t,e,x,n)=>{for(var r=e,s=t.length-1,i;s>=0;s--)(i=t[s])&&(r=i(r)||r);return r},Xd=(t,e)=>(x,n)=>e(x,n,t);const qd=3e3,Fr=Ca(_(759));let Zs=class extends U0{constructor(e){const x=_;super(),r2(this,"_transformMap",new Map),r2(this,"_loopLimitTime",qd),r2(this,x(818),new Map),this[x(420)]=e}[_(430)](){const e=_;this._transformMap[e(354)](),this[e(818)][e(354)]()}[_(523)](e){const x=_,{m1:n,m2:r="any"}=e;this._transformMap[x(579)](n)||this._transformMap[x(372)](n,new Map);const s=this[x(673)][x(449)](n);if(s.has(r))throw new Error("[TransformService] Transform algorithm for "+n+" and "+r+x(632));s[x(372)](r,e)}[_(624)](e,x,n){const r=_;var s,i,a,o,d,c;const l=this[r(673)],u=((s=l.get(e.id))==null?void 0:s.get(x.id))||((i=l[r(449)](e.id))==null?void 0:i[r(449)](r(424)))||((a=l[r(449)](r(424)))==null?void 0:a[r(449)](x.id));if(u)return n?u[r(549)](e,x,n):u[r(549)](e,x);const f=((o=l[r(449)](x.id))==null?void 0:o.get(e.id))||((d=l.get(x.id))==null?void 0:d[r(449)](r(424)))||((c=l.get(r(424)))==null?void 0:c[r(449)](e.id));if(f){const b=n?f[r(549)](x,e,n):f[r(549)](x,e);return Te(b)?n?{m2Prime:b[r(753)]}:{m2Prime:b[r(753)],m1Prime:b[r(633)]}:b}return{m1Prime:e,m2Prime:x}}[_(510)](e,x,n){const r=_;this[r(818)][r(372)]("m1",e),this[r(818)][r(372)]("m2",x);const s=Date.now(),i=this[r(355)](e,x,s);if(Fi(i))return i;if(n)return{m2Prime:i};const a=this[r(798)](e,x,s);return Fi(a)?a:(this[r(818)][r(354)](),{m1Prime:a,m2Prime:i})}[_(355)](e,x,n){const r=_;Date.now()===n&&(this._logService.debug(r(806)+new Date()[r(612)]()),this[r(420)][r(484)](r(440),e[r(411)]),this[r(420)][r(484)](r(502),x[r(411)]));const s=e[r(411)];let i=0,a=0,o;for(o=0;o<s;o++){if(i++,i%1e4===0&&Date[r(504)]()-n>this[r(459)])throw this[r(470)]("right-loop1"),this._logCurrentTransformMutations(e[r(411)],x.length,r(689)),new Error(r(490));let d=[e[o]],c=[];for(let l=0,u=x.length;l<u;l++){if(a++,a%1e4===0&&Date[r(504)]()-n>this[r(459)])throw this[r(470)]("right-loop2"),this[r(599)](e.length,x[r(411)],r(453)),new Error(r(608));const f=x[l];let b;if(d[r(411)]===0)b=[f],d=[];else if(d[r(411)]===1){const h=this.transformMutation(d[0],f);if(qs(h))return h;if(b=Gn(h[r(633)]),!h[r(753)])throw new Error(r(765));d=Gn(h[r(753)])}else{const h=this[r(355)](d,[f],n);if(h[r(817)])return h;if(b=h,l<u-1){const p=this[r(798)](d,[f],n);if(p[r(817)])return p;d=p}}c=c[r(462)](b)}x=c}return x}[_(798)](e,x,n){const r=_;Date.now()===n&&(this._logService[r(484)](r(353)+new Date()[r(612)]()),this._logService[r(484)](r(440),e[r(411)]),this[r(420)][r(484)](r(502),x[r(411)]));const s=x[r(411)];let i,a=0,o=0;for(i=0;i<s;i++){if(a++,a%1e4===0&&Date.now()-n>this._loopLimitTime)throw this[r(470)](r(630)),this[r(599)](e.length,x[r(411)],"left-loop1"),new Error("[TransformService]: _leftInclineTransformMutations loop1 exceeded the limit time.");let d=[x[i]],c=[];for(let l=0,u=e[r(411)];l<u;l++){if(o++,o%1e4===0&&Date.now()-n>this._loopLimitTime)throw this._logOriginTransformMutations("left-loop2"),this[r(599)](e.length,x[r(411)],r(603)),new Error(r(720));const f=e[l];let b;if(d[r(411)]===0)b=[f],d=[];else if(d.length===1){const h=this[r(624)](f,d[0]);if(qs(h))return h;if(!h[r(753)])throw new Error("Algorithm error, m1Prime should not be undefined.");b=Gn(h[r(753)]),d=Gn(h.m2Prime)}else{const h=this[r(798)]([f],d,n);if(h[r(817)])return h;if(b=h,l<u-1){const p=this[r(355)]([f],d,n);if(p[r(817)])return p;d=p}}c=c[r(462)](b)}e=c}return e}transformChangesets(e,x,n){const r=_;if(!Kd(e,x))throw new Error(r(704)+x[0].baseRev+" and the 'revision' of c1 is "+e[0][r(694)]+".");const s=e[r(411)],i=x[r(411)],a=$i(s,i+1),o=$i(s+1,i);e[r(384)]((d,c)=>a[c][0]=d),x[r(384)]((d,c)=>o[0][c]=d);try{for(let d=0;d<i;d++)for(let c=0;c<s;c++){const l=o[c][d],u=a[c][d];if(!l||!u)throw new Error(r(690));const{mutations:f,...b}=u,{mutations:h,...p}=l;this[r(420)][r(484)](r(774)+new Date().toISOString()),this[r(420)].debug(r(815),JSON[r(573)](b)),this[r(420)].debug(r(451),JSON[r(573)](p));const I=this[r(510)](f,h);if(Ks(I))return{error:I[r(817)]};o[c+1][d]={...l,mutations:I[r(633)]},a[c][d+1]={...u,mutations:I[r(753)]}}return n?{c2Prime:o[s]}:{c1Prime:a[r(500)](d=>d[i]).flat(),c2Prime:o[s]}}catch(d){throw console[r(817)](d),d}}[_(755)](e,x){const n=_,r=e[n(790)],s=this.transformMutations(r,x);return Ks(s)?{error:s[n(817)]}:{m2Prime:s[n(633)],c1Prime:{...e,mutations:s[n(753)]}}}[_(470)](e){const x=_;this[x(420)][x(817)]("[Error] _logOriginTransformMutations "+e+x(520)+new Date()[x(612)]());const n=this._transformMutationsCache.get("m1"),r=this[x(818)][x(449)]("m2");n&&n[x(384)]((s,i)=>{const a=x;this._logService[a(817)]("[Error] m1 origin mutation "+i+a(383),JSON[a(573)](s))}),r&&r[x(384)]((s,i)=>{const a=x;this[a(420)][a(817)](a(527)+i+": ",JSON[a(573)](s))})}[_(599)](e,x,n){const r=_;this[r(420)][r(817)](r(563)+n+". Date now: "+new Date()[r(612)]()),this[r(420)].error("[Error] m1Length: "+e),this[r(420)].error("[Error] m2Length: "+x)}};Zs=Jd([Xd(0,t1)],Zs);function Kd(t,e){const x=_;return t[0][x(694)]-1===e[0][x(370)]}function $i(t,e){const x=_;return new Array(t)[x(379)](void 0)[x(500)](()=>new Array(e))}function Gn(t){return Array[_(552)](t)?t:[t]}function Zd(t,e){const x=_;if(!Array[x(552)](t))return;const n=t[x(670)]("body")>-1?t:t.find(s=>Array.isArray(s)&&s.indexOf(x(473))>-1);if(!Array[x(552)](n))return;const r=n[x(670)](x(473));if(!(r===-1||(r===0?"":n[r-1])!==e))return n.slice(r)}function Ai(t,e,x=_(764)){const n=_;if(e.length===0)return[];const{segmentId:r}=e[0];if(r==null)return e;const s=Zd(t,r);if(s==null)return e;const i=[];for(const a of e){const o=o2.transformPosition(s,a[n(814)],x),d=o2[n(572)](s,a[n(444)],x),c={...a,startOffset:o,endOffset:d,collapsed:o===d};i[n(442)](c)}return i}const xc={m1:di.id,m2:di.id,handler(t,e){const x=_;if(t[x(472)][x(675)]!==e[x(472)].unitId)return{error:new Error(x(725))};const n=R[x(544)](t),r=R[x(544)](e);return{m1Prime:{...n,params:{...n[x(472)],actions:o2[x(543)](n[x(472)][x(417)],r[x(472)][x(417)],x(360)),textRanges:n.params[x(536)]?Ai(r.params.actions,n[x(472)][x(536)],x(764)):null}},m2Prime:{...r,params:{...r[x(472)],actions:o2.transform(r.params[x(417)],n[x(472)][x(417)],x(764)),textRanges:r[x(472)][x(536)]?Ai(n[x(472)][x(417)],r[x(472)].textRanges,x(764)):null}}}}},ec=[xc];Object[_(768)];var tc=(t,e,x,n)=>{const r=_;for(var s=e,i=t[r(411)]-1,a;i>=0;i--)(a=t[i])&&(s=a(s)||s);return s},nc=(t,e)=>(x,n)=>e(x,n,t);let p2=class extends U0{constructor(e){const x=_;super(),this[x(804)]=e,[...ec].forEach(n=>{const r=x;this[r(804)][r(523)](n)})}};p2=tc([nc(0,Fr)],p2);const sc={m1:xe.id,m2:xe.id,handler:(t,e)=>{const x=_,n=t.params,r=e.params,s={m1Prime:t,m2Prime:e};if(n[x(675)]!==r.unitId||n[x(505)]!==r[x(505)]||n.comment[x(697)]!==r[x(648)][x(697)])return s;if(!n[x(648)][x(655)]&&!r.comment[x(655)]){const i=R[x(544)](e);return i[x(472)][x(648)][x(655)]=t[x(472)].comment.id,{m1Prime:[{id:Et.id,params:{unitId:n[x(675)],subUnitId:r.subUnitId,commentId:r[x(648)].id}},t,i],m2Prime:[i]}}return s}},rc={m1:hn.id,m2:hn.id,handler(t,e){const x=_;if(t[x(472)].unitId!==e.params[x(675)]||t[x(472)][x(505)]!==e[x(472)].subUnitId)return{m1Prime:t,m2Prime:e};const{unitId:n,subUnitId:r}=t[x(472)],s=R[x(544)](t),i=R[x(544)](e),a=[s],o={unitId:n,subUnitId:r,start:{id:i[x(472)][x(610)][x(532)],type:x(437)},end:{id:i[x(472)][x(610)][x(532)],type:x(392)}};return a[x(442)]({id:Ls.id,params:o}),{m1Prime:a,m2Prime:i}}};function Es(t,e,x,n){const r=_,s=new K;x[r(384)](a=>{const o=r;a[o(644)][o(384)](d=>{const c=o;Rx[c(498)](d,(l,u)=>{const f=c;s[f(645)](l,u,a[f(553)])})})}),n[r(384)](a=>{const o=r;a[o(644)].forEach(d=>{const c=o;Rx[c(498)](d,(l,u)=>{const f=c;s.setValue(l,u,a[f(553)])})})});const i=[];return x[r(384)](a=>{const o=r,d=J2(s,c=>c===a[o(553)]);if(d.length){if(!st(d,a[o(644)])){const c={ruleId:a.uid,unitId:t,subUnitId:e,payload:{type:Ax.RANGE,payload:d}};i.push({id:dx.id,params:c})}}else{const c={ruleId:a[o(553)],unitId:t,subUnitId:e};i[o(442)]({id:ie.id,params:c})}}),i}function i2(t,e){const x=_,n=R[x(544)](Array[x(552)](t[x(472)][x(610)])?t[x(472)].rule:[t.params[x(610)]]);return e[x(384)](r=>{const s=x;if(r.id===dx.id){const i=r,a=n[s(539)](o=>o[s(553)]===i[s(472)][s(445)]);a[s(644)]=i[s(472)][s(575)][s(575)]}else if(r.id===ie.id){const i=n.findIndex(a=>a.uid===r[s(472)][s(445)]);n[i]=null}}),n[x(674)](Boolean)[x(411)]?[{...t,params:{...t.params,rule:n.filter(Boolean)}}]:[]}const ic={m1:ye.id,m2:ye.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e},r=t[x(472)],s=e[x(472)];if(r.unitId!==s[x(675)]||r[x(505)]!==s.subUnitId)return n;const i=R[x(544)](t),a=R.deepClone(e),o=r[x(675)],d=s[x(505)],c=i[x(472)][x(610)],l=a[x(472)][x(610)];if(Array[x(552)](c)&&Array[x(552)](l))return{m1Prime:[],m2Prime:[]};if(Array[x(552)](c)){i[x(472)][x(649)]=0;const f=Es(o,d,c,[l]);return{m1Prime:i2(i,f),m2Prime:[...f,a]}}if(Array[x(552)](l)){const f=Es(o,d,l,[c]);return a[x(472)][x(649)]=0,{m1Prime:i2(i,f),m2Prime:[...f,a]}}const u=Es(o,d,[c],[l]);return a[x(472)][x(649)]=-1,{m1Prime:i2(i,u),m2Prime:[...u,a]}}},ac={m1:ye.id,m2:dx.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e},r=t.params,s=e[x(472)];if(r.unitId!==s[x(675)]||r[x(505)]!==s[x(505)])return n;if(e[x(472)][x(575)][x(478)]===Ax[x(567)]){const{unitId:i,subUnitId:a}=t.params,o=Array[x(552)](t[x(472)][x(610)])?t[x(472)][x(610)]:[t[x(472)][x(610)]],d=[],c=new K;return o[x(384)](l=>{const u=x;l[u(644)][u(384)](f=>{const b=u;Rx[b(498)](f,(h,p)=>{const I=b;c[I(645)](h,p,l[I(553)])})})}),e[x(472)][x(575)][x(575)].forEach(l=>{const u=x;Rx[u(498)](l,(f,b)=>{const h=u;c[h(645)](f,b,e[h(472)][h(445)])})}),o[x(384)](l=>{const u=x,f=J2(c,b=>b===l[u(553)]);st(f,l.ranges)||(f.length?d.push({id:dx.id,params:{unitId:i,subUnitId:a,ruleId:l[u(553)],payload:{type:Ax.RANGE,payload:f}}}):d[u(442)]({id:ie.id,params:{unitId:i,subUnitId:a,ruleId:l[u(553)]}}))}),{m1Prime:i2(t,d),m2Prime:[...d,e]}}return n}},oc={m1:bi.id,m2:bi.id,handler:(t,e)=>{const x=_,n=t[x(472)],r=e[x(472)];return n[x(675)]===r[x(675)]&&n[x(505)]===r[x(505)]&&n.link[x(593)]===r[x(665)][x(593)]&&n[x(665)][x(791)]===r[x(665)][x(791)]?{m2Prime:e,m1Prime:[]}:{m1Prime:t,m2Prime:e}}},dc={m1:ex.id,m2:xe.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};return t[x(472)][x(675)]!==e[x(472)][x(675)]||t[x(472)].subUnitId!==e[x(472)][x(505)]?n:{error:new Error(x(793))}}},cc={m1:ex.id,m2:hn.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e[x(472)][x(505)])return n;const r=t[x(472)].rules[x(500)](i=>i[x(644)])[x(456)](),s=e.params[x(610)].ranges;return r.some(i=>s[x(503)](a=>x0[x(394)](i,a)))?{error:new Error("add range protection is conflict with add conditional rule")}:n}},lc={m1:ex.id,m2:ex.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)].unitId!==e[x(472)][x(675)]||t.params[x(505)]!==e[x(472)][x(505)])return n;const r=t[x(472)][x(671)][x(500)](i=>i[x(644)])[x(456)](),s=e.params[x(671)][x(500)](i=>i[x(644)])[x(456)]();return r[x(503)](i=>s[x(503)](a=>x0[x(394)](i,a)))?{error:new Error("add range protection is conflict with add range protection")}:n}},uc={m1:ex.id,m2:F0.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)].unitId||t[x(472)][x(505)]!==e[x(472)][x(505)])return n;const r=t[x(472)][x(671)].map(i=>i[x(644)])[x(456)](),s=e[x(472)][x(644)];return r.some(i=>s[x(503)](a=>x0.intersects(i,a)))?{error:new Error(x(356))}:n}},fc={m1:ex.id,m2:O0.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};return t[x(472)][x(675)]!==e[x(472)].unitId||t.params[x(505)]!==e[x(472)].rule[x(505)]?n:{error:new Error(x(716))}}},mc={m1:ex.id,m2:_n.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};return t[x(472)][x(675)]!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e[x(472)].subUnitId?n:{error:new Error(x(687))}}},bc={m1:ex.id,m2:B0.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t[x(472)].subUnitId!==e.params[x(505)])return n;const r=t.params[x(671)][x(500)](i=>i[x(644)]).flat(),s=e[x(472)].range;return r[x(503)](i=>x0[x(394)](i,s))?{error:new Error(x(574))}:n}},hc={m1:ex.id,m2:G0.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)].unitId!==e.params[x(675)]||t[x(472)][x(505)]!==e[x(472)][x(505)])return n;const r=t[x(472)][x(671)][x(500)](i=>i[x(644)])[x(456)](),s=e[x(472)].range;return r[x(503)](i=>x0.intersects(i,s))?{error:new Error(x(661))}:n}},pc={m1:ex.id,m2:q0.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};if(t.params[x(675)]!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e.params[x(505)])return n;const r=t[x(472)][x(671)].map(i=>i[x(644)])[x(456)](),s=[e.params[x(480)],e[x(472)].targetRange];return r[x(503)](i=>s[x(503)](a=>x0[x(394)](i,a)))?{error:new Error(x(667))}:n}},_c={m1:ex.id,m2:hx.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};if(t.params[x(675)]!==e.params[x(675)]||t[x(472)][x(505)]!==e[x(472)].from[x(505)])return n;const r=t[x(472)].rules.map(o=>o[x(644)]).flat(),s=new K(e[x(472)].from.value)[x(663)](),i=new K(e[x(472)].to[x(822)])[x(663)](),a=[s,i];return r[x(503)](o=>a[x(503)](d=>x0[x(394)](o,d)))?{error:new Error(x(366))}:n}},Ic={m1:ex.id,m2:Y0.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};if(t.params[x(675)]!==e[x(472)][x(675)]||t[x(472)].subUnitId!==e.params[x(505)])return n;const r=t.params[x(671)][x(500)](i=>i[x(644)])[x(456)](),s=[e[x(472)][x(480)],e[x(472)].targetRange];return r.some(i=>s[x(503)](a=>x0[x(394)](i,a)))?{error:new Error(x(741))}:n}},gc={m1:ex.id,m2:V0.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t[x(472)].subUnitId!==e[x(472)][x(505)])return n;const r=t[x(472)][x(671)].map(i=>i[x(644)]).flat(),s=e.params[x(604)];return r.some(i=>x0[x(394)](i,s))?{error:new Error(x(461))}:n}},vc={m1:ex.id,m2:ie.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};return t[x(472)][x(675)]!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e[x(472)].subUnitId?n:{error:new Error("add range protection is conflict with remove data validation rule")}}},Cc={m1:ex.id,m2:gx.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e[x(472)][x(505)])return n;const r=t[x(472)][x(671)][x(500)](i=>i.ranges)[x(456)](),s=e[x(472)][x(644)];return r[x(503)](i=>s[x(503)](a=>x0[x(394)](i,a)))?{error:new Error(x(668))}:n}},wc={m1:ex.id,m2:We.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};return t.params[x(675)]!==e[x(472)][x(675)]||t.params[x(505)]!==e[x(472)][x(505)]?n:{error:new Error(x(568))}}},Pc={m1:ex.id,m2:Z0.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)].unitId||t[x(472)][x(505)]!==e[x(472)][x(505)])return n;const r=t[x(472)][x(671)][x(500)](i=>i.ranges)[x(456)](),s=e.params[x(644)];return r[x(503)](i=>s.some(a=>x0[x(394)](i,a)))?{error:new Error(x(795))}:n}},yc={m1:ex.id,m2:pn.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t[x(472)].subUnitId!==e[x(472)][x(505)])return n;const r=t[x(472)][x(671)][x(500)](i=>i[x(644)]).flat(),s=e.params[x(610)][x(644)];return r[x(503)](i=>s[x(503)](a=>x0[x(394)](i,a)))?{error:new Error(x(805))}:n}},Rc={m1:ex.id,m2:Rt.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};if(t.params[x(675)]!==e[x(472)].unitId||t.params[x(505)]!==e.params.subUnitId)return n;const r=t[x(472)].rules[x(500)](i=>i[x(644)])[x(456)](),s=[{startRow:e.params[x(388)],endRow:e[x(472)].startRow,startColumn:e[x(472)][x(616)],endColumn:e[x(472)][x(616)]}];return r.some(i=>s[x(503)](a=>x0[x(394)](i,a)))?{error:new Error("add range protection is conflict with set frozen")}:n}},Ec={m1:ex.id,m2:Yx.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};return t[x(472)][x(675)]!==e.params.unitId||t[x(472)][x(505)]!==e[x(472)][x(505)]?n:{error:new Error(x(402))}}},Sc={m1:ex.id,m2:nx.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t.params[x(505)]!==e[x(472)][x(505)])return n;const r=t[x(472)][x(671)].map(i=>i[x(644)])[x(456)](),s=e[x(472)][x(610)][x(644)];return r.some(i=>s.some(a=>x0[x(394)](i,a)))?{error:new Error("add range protection is conflict with set range protection")}:n}},Tc={m1:ex.id,m2:H0.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e.params[x(675)]||t.params[x(505)]!==e.params.subUnitId)return n;const r=t[x(472)][x(671)].map(i=>i[x(644)]).flat(),s=new K(e[x(472)].cellValue)[x(663)]();return r[x(503)](i=>x0[x(394)](i,s))?{error:new Error("add range protection is conflict with set range value")}:n}},Mc={m1:ex.id,m2:de.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t.params[x(505)]!==e[x(472)][x(505)])return n;const r=t[x(472)][x(671)].map(i=>i.ranges)[x(456)](),s=e.params[x(644)];return r.some(i=>s[x(503)](a=>x0[x(394)](i,a)))?{error:new Error(x(521))}:n}},Nc={m1:ex.id,m2:bn.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};return t.params[x(675)]!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e[x(472)].subUnitId?n:{error:new Error(x(512))}}},Uc={m1:ex.id,m2:dx.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};return t[x(472)][x(675)]!==e[x(472)][x(675)]||t[x(472)].subUnitId!==e[x(472)][x(505)]?n:{error:new Error(x(757))}}},kc={m1:F0.id,m2:F0.id,handler(t,e){const x=_,n=R.deepClone(t),r=R[x(544)](e);if(t.params.unitId!==e[x(472)][x(675)]||t[x(472)].subUnitId!==e.params[x(505)])return{m1Prime:n,m2Prime:r};const s=n[x(472)][x(644)],i=r.params[x(644)],a=[r],o=new Set;for(let d=0;d<s[x(411)];d++)for(let c=0;c<i[x(411)];c++)if(x0.intersects(s[d],i[c])){o[x(617)](s[d]),s[x(519)](d,1),d--;break}return o[x(799)]>0&&a[x(380)]({id:Z0.id,params:{unitId:t[x(472)][x(675)],subUnitId:t[x(472)].subUnitId,ranges:Array[x(662)](o)}}),s.length===0&&(n.id=h0.id),{m1Prime:n,m2Prime:a[x(411)]>1?a:r}}},qa={m1:F0.id,m2:B0.id,handler(t,e){const x=_,n=R[x(544)](t),r=R.deepClone(e);if(t[x(472)][x(675)]!==e.params[x(675)]||t[x(472)][x(505)]!==e.params[x(505)])return{m1Prime:n,m2Prime:r};const s=t[x(472)][x(675)],i=t.params[x(505)],a=[r],o=[],d=[];return n[x(472)].ranges.forEach(c=>{const l=x,u=e[l(472)][l(604)],f=u[l(499)]-u[l(616)]+1;u[l(616)]<=c[l(616)]?(o[l(442)]({...c}),d[l(442)]({...c,startColumn:c.startColumn+f,endColumn:c.endColumn+f}),c.startColumn=c[l(616)]+f,c[l(499)]=c[l(499)]+f):u[l(616)]>c.startColumn&&u[l(616)]<=c[l(499)]&&(o[l(442)]({...c}),d.push({...c,endColumn:c.endColumn+f}),c[l(499)]=c.endColumn+f)}),o[x(411)]>0&&a[x(380)]({id:Z0.id,params:{unitId:s,subUnitId:i,ranges:o}}),d[x(411)]>0&&a[x(442)]({id:F0.id,params:{unitId:s,subUnitId:i,ranges:d}}),{m1Prime:n,m2Prime:a[x(411)]>1?a:a[0]}}},Ka={m1:F0.id,m2:G0.id,handler(t,e){const x=_,n=R[x(544)](t),r=R[x(544)](e);if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e[x(472)].subUnitId)return{m1Prime:n,m2Prime:r};const s=t[x(472)][x(675)],i=t.params[x(505)],a=[r],o=[],d=[];return n[x(472)][x(644)][x(384)](c=>{const l=x,u=e[l(472)][l(604)],f=u[l(715)]-u[l(388)]+1;u[l(388)]<=c.startRow?(o[l(442)]({...c}),d.push({...c,startRow:c[l(388)]+f,endRow:c.endRow+f}),c[l(388)]=c[l(388)]+f,c[l(715)]=c[l(715)]+f):u[l(388)]>c[l(388)]&&u.startRow<=c[l(715)]&&(o[l(442)]({...c}),d[l(442)]({...c,endRow:c[l(715)]+f}),c.endRow=c[l(715)]+f)}),o[x(411)]>0&&a[x(380)]({id:Z0.id,params:{unitId:s,subUnitId:i,ranges:o}}),d.length>0&&a[x(442)]({id:F0.id,params:{unitId:s,subUnitId:i,ranges:d}}),{m1Prime:n,m2Prime:a[x(411)]>1?a:a[0]}}},Za={m1:F0.id,m2:q0.id,handler(t,e){const x=_,n=R[x(544)](t),r=R[x(544)](e);if(t[x(472)][x(675)]!==e.params[x(675)]||t.params[x(505)]!==e[x(472)].subUnitId)return{m1Prime:n,m2Prime:r};const s=[],i=[],a=[r];for(let o=0;o<n.params[x(644)][x(411)];o++){const d=n.params[x(644)][o],{sourceRange:c,targetRange:l}=e[x(472)];x0[x(394)](d,c)||x0[x(394)](d,l)?(s.push({...d}),n[x(472)][x(644)].splice(o,1),o--):c[x(616)]<d[x(616)]&&l.startColumn>d[x(499)]?(s[x(442)]({...d}),i.push({...d,startColumn:d[x(616)]-(c[x(499)]-c[x(616)]+1),endColumn:d[x(499)]-(c[x(499)]-c.startColumn+1)}),d[x(616)]=d[x(616)]-(c.endColumn-c[x(616)]+1),d[x(499)]=d[x(499)]-(c[x(499)]-c.startColumn+1)):c[x(616)]>d.endColumn&&l[x(499)]<d[x(616)]&&(s[x(442)]({...d}),i[x(442)]({...d,startColumn:d[x(616)]+(c[x(499)]-c[x(616)]+1),endColumn:d[x(499)]+(c.endColumn-c[x(616)]+1)}),d.startColumn=d[x(616)]+(c.endColumn-c[x(616)]+1),d[x(499)]=d[x(499)]+(c[x(499)]-c.startColumn+1))}return s[x(411)]>0&&a[x(380)]({id:Z0.id,params:{unitId:t.params.unitId,subUnitId:t[x(472)].subUnitId,ranges:s}}),i[x(411)]>0&&a[x(442)]({id:F0.id,params:{unitId:t[x(472)][x(675)],subUnitId:t[x(472)].subUnitId,ranges:i}}),n[x(472)].ranges[x(411)]===0&&(n.id=h0.id),{m1Prime:n,m2Prime:a.length>1?a:a[0]}}},xo={m1:F0.id,m2:hx.id,handler(t,e){const x=_,n=R[x(544)](t),r=R.deepClone(e);if(t[x(472)][x(675)]!==e[x(472)][x(675)])return{m1Prime:n,m2Prime:r};const s=[],i=[r],a=new K(e[x(472)].from.value)[x(663)](),o=new K(e.params.to[x(822)])[x(663)]();for(let d=0;d<n[x(472)][x(644)][x(411)];d++){const c=n[x(472)][x(644)][d];(x0[x(394)](a,c)||x0[x(394)](o,c))&&(s[x(442)](c),n[x(472)][x(644)].splice(d,1),d--)}return s[x(411)]>0&&i[x(380)]({id:Z0.id,params:{unitId:t.params.unitId,subUnitId:t[x(472)].subUnitId,ranges:s}}),n.params[x(644)][x(411)]===0&&(n.id=h0.id),{m1Prime:n,m2Prime:i[x(411)]>1?i:i[0]}}},eo={m1:F0.id,m2:Y0.id,handler(t,e){const x=_,n=R[x(544)](t),r=R.deepClone(e);if(t.params[x(675)]!==e[x(472)][x(675)]||t.params[x(505)]!==e.params[x(505)])return{m1Prime:n,m2Prime:r};const s=[],i=[],a=[r];for(let o=0;o<n.params[x(644)].length;o++){const d=n[x(472)].ranges[o],{sourceRange:c,targetRange:l}=e[x(472)];x0[x(394)](d,c)||x0[x(394)](d,l)?(s[x(442)]({...d}),n[x(472)][x(644)].splice(o,1),o--):c[x(388)]<d[x(388)]&&l[x(388)]>d.endRow?(s[x(442)]({...d}),i[x(442)]({...d,startRow:d[x(388)]-(c.endRow-c[x(388)]+1),endRow:d[x(715)]-(c[x(715)]-c[x(388)]+1)}),d[x(388)]=d[x(388)]-(c[x(715)]-c.startRow+1),d.endRow=d.endRow-(c.endRow-c.startRow+1)):c[x(388)]>d[x(715)]&&l[x(715)]<d.startRow&&(s[x(442)]({...d}),i[x(442)]({...d,startRow:d[x(388)]+(c[x(715)]-c.startRow+1),endRow:d[x(715)]+(c[x(715)]-c[x(388)]+1)}),d[x(388)]=d[x(388)]+(c[x(715)]-c.startRow+1),d[x(715)]=d[x(715)]+(c.endRow-c[x(388)]+1))}return s[x(411)]>0&&a.unshift({id:Z0.id,params:{unitId:t[x(472)][x(675)],subUnitId:t[x(472)][x(505)],ranges:s}}),i[x(411)]>0&&a[x(442)]({id:F0.id,params:{unitId:t[x(472)][x(675)],subUnitId:t[x(472)][x(505)],ranges:i}}),n[x(472)].ranges[x(411)]===0&&(n.id=h0.id),{m1Prime:n,m2Prime:a[x(411)]>1?a:a[0]}}};function Bx(t){const e=_;return t[e(616)]>t[e(499)]||t[e(388)]>t[e(715)]?!1:!(t[e(388)]===t[e(715)]&&t[e(616)]===t[e(499)])}const to={m1:F0.id,m2:V0.id,handler(t,e){const x=_,n=R.deepClone(t),r=R[x(544)](e);if(t[x(472)].unitId!==e.params[x(675)]||t[x(472)][x(505)]!==e[x(472)][x(505)])return{m1Prime:n,m2Prime:r};const s=t[x(472)][x(675)],i=t[x(472)][x(505)],a=[r],o=[],d=[];for(let c=0;c<n.params[x(644)][x(411)];c++){const l=n[x(472)].ranges[c],u=e[x(472)][x(604)],f=u[x(499)]-u[x(616)]+1;if(u[x(616)]<l.startColumn&&u[x(499)]<l[x(616)])o[x(442)]({...l}),d[x(442)]({...l,startColumn:l[x(616)]-f,endColumn:l.endColumn-f}),l[x(616)]=l[x(616)]-f,l.endColumn=l[x(499)]-f;else if(u[x(616)]<l[x(616)]&&u[x(499)]>=l.startColumn&&u[x(499)]<=l[x(499)]){o[x(442)]({...l});const b={...l,startColumn:u[x(616)],endColumn:l[x(499)]-f};Bx(b)&&u[x(499)]<l[x(499)]?(u[x(499)]<l[x(499)]&&d[x(442)](b),l[x(616)]=u[x(616)],l[x(499)]=l[x(499)]-f):(n[x(472)][x(644)][x(519)](c,1),c--)}else if(u[x(616)]>l[x(616)]&&u[x(499)]<l[x(499)]){o[x(442)]({...l});const b={...l,endColumn:l[x(499)]-f};Bx(b)?(d.push(b),l[x(499)]=l[x(499)]-f):(n[x(472)][x(644)][x(519)](c,1),c--)}else if(u[x(616)]>=l.startColumn&&u[x(616)]<=l.endColumn&&u[x(499)]>l[x(499)]){o.push({...l});const b={...l,endColumn:u[x(616)]-1};Bx(b)&&u[x(616)]>l[x(616)]?(d[x(442)](b),l[x(499)]=u[x(616)]-1):(n[x(472)][x(644)][x(519)](c,1),c--)}else u[x(616)]>l[x(499)]||u[x(616)]<=l[x(616)]&&u[x(499)]>=l[x(499)]&&(o[x(442)]({...l}),n.params[x(644)][x(519)](c,1),c--)}return o.length>0&&a[x(380)]({id:Z0.id,params:{unitId:s,subUnitId:i,ranges:o}}),d[x(411)]>0&&a[x(442)]({id:F0.id,params:{unitId:s,subUnitId:i,ranges:d}}),n[x(472)][x(644)][x(411)]===0&&(n.id=h0.id),{m1Prime:n,m2Prime:a[x(411)]>1?a:a[0]}}},no={m1:F0.id,m2:j0.id,handler(t,e){const x=_,n=R.deepClone(t),r=R[x(544)](e);if(t.params[x(675)]!==e.params.unitId||t[x(472)].subUnitId!==e[x(472)][x(505)])return{m1Prime:n,m2Prime:r};const s=t[x(472)][x(675)],i=t.params.subUnitId,a=[r],o=[],d=[];for(let c=0;c<n.params[x(644)][x(411)];c++){const l=n.params.ranges[c],u=e[x(472)][x(604)],f=u[x(715)]-u[x(388)]+1;if(u[x(388)]<l[x(388)]&&u.endRow<l[x(388)])o[x(442)]({...l}),d.push({...l,startRow:l[x(388)]-f,endRow:l[x(715)]-f}),l.startRow=l[x(388)]-f,l[x(715)]=l[x(715)]-f;else if(u[x(388)]<l[x(388)]&&u[x(715)]>=l[x(388)]&&u[x(715)]<=l.endRow){o[x(442)]({...l});const b={...l,startRow:u[x(388)],endRow:l[x(715)]-f};Bx(b)&&u[x(715)]<l[x(715)]?(u[x(715)]<l[x(715)]&&d[x(442)](b),l[x(388)]=u[x(388)],l[x(715)]=l.endRow-f):(n.params[x(644)][x(519)](c,1),c--)}else if(u[x(388)]>l[x(388)]&&u[x(715)]<l[x(715)]){o[x(442)]({...l});const b={...l,endRow:l.endRow-f};Bx(b)?(d[x(442)](b),l[x(715)]=l[x(715)]-f):(n[x(472)][x(644)].splice(c,1),c--)}else if(u[x(388)]>=l[x(388)]&&u[x(388)]<=l[x(715)]&&u[x(715)]>l.endRow){o.push({...l});const b={...l,endRow:u[x(388)]-1};Bx(b)&&u[x(388)]>l[x(388)]?(d[x(442)](b),l.endRow=u.startRow-1):(n[x(472)].ranges.splice(c,1),c--)}else u.startRow>l[x(715)]||u[x(388)]<=l.startRow&&u.endRow>=l[x(715)]&&(o[x(442)]({...l}),n[x(472)][x(644)].splice(c,1),c--)}return o[x(411)]>0&&a[x(380)]({id:Z0.id,params:{unitId:s,subUnitId:i,ranges:o}}),d[x(411)]>0&&a[x(442)]({id:F0.id,params:{unitId:s,subUnitId:i,ranges:d}}),n[x(472)][x(644)][x(411)]===0&&(n.id=h0.id),{m1Prime:n,m2Prime:a[x(411)]>1?a:a[0]}}},Dc={m1:F0.id,m2:Z0.id,handler(t,e){const x=_,n=R[x(544)](t),r=R[x(544)](e);if(t.params.unitId!==e.params[x(675)]||t.params[x(505)]!==e[x(472)][x(505)])return{m1Prime:n,m2Prime:r};const s=[...r[x(472)][x(644)]];for(let i=0;i<n[x(472)][x(644)].length;i++){let a=!1;for(let o=0;o<r[x(472)][x(644)][x(411)];o++){const d=n[x(472)][x(644)][i],c=r[x(472)][x(644)][o];if(x0[x(394)](d,c)){a=!0;break}}a&&(s[x(442)](n[x(472)][x(644)][i]),n.params[x(644)].splice(i,1),i--)}return r[x(472)][x(644)]=s,n[x(472)][x(644)][x(411)]===0&&(n.id=h0.id),{m1Prime:n,m2Prime:r}}},so={m1:F0.id,m2:H0.id,handler(t,e){const x=_,n=R.deepClone(t),r=R[x(544)](e);if(t[x(472)].unitId!==e[x(472)][x(675)]||t.params[x(505)]!==e.params[x(505)])return{m1Prime:n,m2Prime:r};const s=[n],i=[r],a=new K(R[x(544)](e[x(472)][x(589)])),o=new Set,d={};for(let c=0;c<n[x(472)][x(644)][x(411)];c++){const l=n.params[x(644)][c],{startRow:u,startColumn:f,endRow:b,endColumn:h}=l;let p=!1;a[x(698)]((I,v,C)=>{const w=x;if(I>=u&&I<=b&&v>=f&&v<=h){const y=a.getValue(I,v),P=y===null?{v:null,s:null,t:null,si:null,p:null,f:null}:y;P&&(d[I]||(d[I]={}),d[I][v]={},(C==null?void 0:C.v)!==void 0&&(d[I][v].v=null,delete P.v),(C==null?void 0:C.f)!==void 0&&(d[I][v].f=null,delete P.f),(C==null?void 0:C.t)!==void 0&&(d[I][v].t=null,delete P.t),(C==null?void 0:C.si)!==void 0&&(d[I][v].si=null,delete P.si),(C==null?void 0:C.p)!==void 0&&(d[I][v].p=null,delete P.p),(C==null?void 0:C.s)!==void 0&&(d[I][v].s=null,delete P.s),a[w(645)](I,v,P),p=!0)}}),p&&(o[x(617)]({...l}),n[x(472)].ranges[x(519)](c,1),c--)}return r[x(472)][x(589)]=a[x(763)](),o[x(799)]>0&&i[x(380)]({id:Z0.id,params:{unitId:t.params[x(675)],subUnitId:t.params[x(505)],ranges:Array[x(662)](o)}}),n[x(472)][x(644)][x(411)]===0&&(n.id=h0.id),Object.keys(d)[x(411)]>0&&s[x(380)]({id:H0.id,params:{unitId:t[x(472)][x(675)],subUnitId:t[x(472)][x(505)],cellValue:d}}),{m1Prime:s[x(411)]>1?s:s[0],m2Prime:i.length>1?i:i[0]}}},Oc={m1:F0.id,m2:Ge.id,handler(t,e){const x=_,n={m1Prime:[],m2Prime:[]};if(t.params[x(675)]!==e.params[x(675)]||t[x(472)][x(505)]!==e.params[x(505)])return n;const r=R[x(544)](e),s=r[x(472)].selections;s[x(384)]((o,d)=>{const c=x,{range:l,primary:u}=o;t.params[c(644)][c(384)](f=>{const b=c;x0[b(394)](f,l)&&(l[b(388)]=Math.min(f[b(388)],l[b(388)]),l.startColumn=Math[b(485)](f.startColumn,l[b(616)]),l[b(715)]=Math.max(f[b(715)],l[b(715)]),l[b(499)]=Math.max(f[b(499)],l[b(499)])),u&&x0[b(394)](f,u)&&d===s[b(411)]-1&&(u[b(616)]===f[b(616)]&&u.startRow&&f.startRow&&(u[b(378)]=!0),u.startRow=Math[b(485)](f[b(388)],u[b(388)]),u[b(616)]=Math[b(485)](f.startColumn,u[b(616)]),u[b(715)]=Math[b(786)](f[b(715)],u.endRow),u[b(499)]=Math.max(f[b(499)],u[b(499)]),u[b(368)]=!0)})}),s[x(684)]((o,d)=>{const c=x,l=o[c(604)],u=d[c(604)];return l[c(388)]===u[c(388)]?l[c(616)]-u[c(616)]:l[c(388)]-u.startRow});const i=[];let a=null;for(const o of s)a===null||!x0[x(394)](a[x(604)],o[x(604)])?(i[x(442)](o),a=o):(a.range[x(388)]=Math.min(a[x(604)].startRow,o[x(604)][x(388)]),a.range[x(616)]=Math[x(485)](a[x(604)][x(616)],o[x(604)][x(616)]),a[x(604)][x(715)]=Math[x(786)](a[x(604)][x(715)],o.range[x(715)]),a.range[x(499)]=Math[x(786)](a[x(604)][x(499)],o.range[x(499)]),o[x(769)]&&(a[x(769)]=o[x(769)]));return r[x(472)][x(427)]=i,n[x(633)][x(442)](r),n}},Fc={m1:O0.id,m2:xe.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};return t[x(472)][x(675)]!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e[x(472)][x(505)]?n:{error:new Error(x(773))}}},$c={m1:O0.id,m2:hn.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};return t[x(472)][x(675)]!==e[x(472)][x(675)]||t.params.subUnitId!==e[x(472)].subUnitId?n:{error:new Error(x(641))}}},Ac={m1:O0.id,m2:ex.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};return t[x(472)][x(675)]!==e[x(472)].unitId||t[x(472)][x(505)]!==e.params.subUnitId?n:{error:new Error(x(819))}}},Vc={m1:O0.id,m2:F0.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};return t[x(472)][x(675)]!==e.params[x(675)]||t[x(472)][x(505)]!==e[x(472)][x(505)]?n:{error:new Error("add worksheet protection is conflict with add worksheet merge")}}},jc={m1:O0.id,m2:O0.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};return t[x(472)].unitId!==e[x(472)][x(675)]||t.params[x(505)]!==e[x(472)][x(610)][x(505)]?n:{error:new Error("add worksheet protection is conflict with add worksheet protection")}}},Lc={m1:O0.id,m2:c2.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};return t[x(472)][x(675)]!==e[x(472)][x(675)]||t.params[x(505)]!==e[x(472)][x(505)]?n:{error:new Error(x(397))}}},Hc={m1:O0.id,m2:_n.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};return t.params[x(675)]!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e.params.subUnitId?n:{error:new Error(x(812))}}},Bc={m1:O0.id,m2:B0.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};return t[x(472)][x(675)]!==e[x(472)][x(675)]||t.params[x(505)]!==e.params.subUnitId?n:{error:new Error(x(708))}}},Gc={m1:O0.id,m2:G0.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};return t[x(472)][x(675)]!==e.params.unitId||t[x(472)].subUnitId!==e.params[x(505)]?n:{error:new Error("add worksheet protection is conflict with insert row")}}},Yc={m1:O0.id,m2:q0.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};return t[x(472)][x(675)]!==e[x(472)].unitId||t[x(472)][x(505)]!==e[x(472)][x(505)]?n:{error:new Error("add worksheet protection is conflict with move col")}}},Wc={m1:O0.id,m2:hx.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};return t[x(472)][x(675)]!==e[x(472)].unitId||t[x(472)][x(505)]!==e[x(472)][x(662)].subUnitId?n:{error:new Error("add worksheet protection is conflict with move range")}}},Qc={m1:O0.id,m2:Y0.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};return t[x(472)][x(675)]!==e[x(472)][x(675)]||t.params[x(505)]!==e[x(472)][x(505)]?n:{error:new Error(x(657))}}},zc={m1:O0.id,m2:V0.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};return t.params[x(675)]!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e.params.subUnitId?n:{error:new Error(x(742))}}},Jc={m1:O0.id,m2:ie.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};return t[x(472)][x(675)]!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e.params.subUnitId?n:{error:new Error("add worksheet protection is conflict with remove data validation rule")}}},Xc={m1:O0.id,m2:gx.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};return t[x(472)].unitId!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e[x(472)][x(505)]?n:{error:new Error(x(429))}}},qc={m1:O0.id,m2:j0.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};return t[x(472)].unitId!==e[x(472)].unitId||t[x(472)].subUnitId!==e.params[x(505)]?n:{error:new Error(x(570))}}},Kc={m1:O0.id,m2:We.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};return t[x(472)][x(675)]!==e.params[x(675)]||t[x(472)].subUnitId!==e[x(472)][x(505)]?n:{error:new Error(x(559))}}},Zc={m1:O0.id,m2:Z0.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};return t[x(472)].unitId!==e[x(472)].unitId||t[x(472)].subUnitId!==e[x(472)][x(505)]?n:{error:new Error(x(646))}}},xl={m1:O0.id,m2:Ee.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};return t[x(472)][x(675)]!==e.params.unitId||t[x(472)][x(505)]!==e[x(472)].subUnitId?n:{error:new Error("add worksheet protection is conflict with remove sheet")}}},el={m1:O0.id,m2:pn.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};return t[x(472)][x(675)]!==e.params[x(675)]||t[x(472)][x(505)]!==e[x(472)][x(505)]?n:{error:new Error(x(808))}}},tl={m1:O0.id,m2:Rt.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};return t[x(472)][x(675)]!==e.params[x(675)]||t[x(472)].subUnitId!==e[x(472)][x(505)]?n:{error:new Error("add worksheet protection is conflict with set frozen")}}},nl={m1:O0.id,m2:Yx.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};return t.params[x(675)]!==e[x(472)][x(675)]||t.params.subUnitId!==e.params.subUnitId?n:{error:new Error(x(400))}}},sl={m1:O0.id,m2:nx.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};return t.params[x(675)]!==e[x(472)][x(675)]||t.params[x(505)]!==e[x(472)][x(505)]?n:{error:new Error("add worksheet protection is conflict with set range protection")}}},rl={m1:O0.id,m2:de.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};return t.params[x(675)]!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e[x(472)][x(505)]?n:{error:new Error(x(700))}}},il={m1:O0.id,m2:js.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};return t[x(472)][x(675)]!==e.params.unitId||t[x(472)].subUnitId!==e[x(472)][x(505)]?n:{error:new Error(x(425))}}},al={m1:O0.id,m2:bn.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};return t.params[x(675)]!==e[x(472)].unitId||t[x(472)].subUnitId!==e.params[x(505)]?n:{error:new Error(x(802))}}},ol={m1:O0.id,m2:dx.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};return t.params[x(675)]!==e.params[x(675)]||t.params[x(505)]!==e.params.subUnitId?n:{error:new Error("add worksheet protection is conflict with update data validation rule")}}},dl={m1:Et.id,m2:xe.id,handler:(t,e)=>{const x=_,n=t.params,r=e[x(472)];return n.unitId===r[x(675)]&&n[x(505)]===r[x(505)]&&n[x(474)]===r.comment[x(655)]?{m1Prime:t,m2Prime:[]}:{m1Prime:t,m2Prime:e}}},cl={m1:Et.id,m2:Et.id,handler:(t,e)=>{const x=_,n=t[x(472)],r=e[x(472)],s={m1Prime:t,m2Prime:e};return n[x(675)]!==r[x(675)]||n.subUnitId!==r[x(505)]||n[x(474)]!==r[x(474)]?s:{m1Prime:[],m2Prime:[]}}},ll={m1:_n.id,m2:_n.id,handler(t,e){return{m1Prime:t,m2Prime:e}}},Dt=(t,e)=>{const x=_,n=Ta(t.params[x(648)].ref),r={startColumn:n[x(791)],endColumn:n.column,startRow:n[x(593)],endRow:n[x(593)]},s=rs(r,e);if(!s)return[{id:Et.id,params:{...t.params,comment:void 0,commentId:t[x(472)].comment.id}}];const i=l2(s);return i===t[x(472)][x(648)][x(697)]?[]:[{id:ce.id,params:{...t[x(472)],comment:void 0,payload:{ref:i,commentId:t[x(472)][x(648)].id}}}]},ul={m1:B0.id,m2:xe.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t[x(472)].subUnitId!==e[x(472)][x(505)])return n;const r={id:ss.id,params:{unitId:t[x(472)].unitId,subUnitId:t[x(472)][x(505)],range:t[x(472)][x(604)]}},s=Dt(e,r);return{m1Prime:[t,...s],m2Prime:[e,...s]}}};function X(t){return{...t,rangeType:Qx[_(749)]}}function wt(t,e,x,n){const r=_;if(n<0)for(let s=e;s<e+x;s++)if(t.hasOwnProperty(s)){t[r(390)](s+n)||(t[s+n]={});const i=t[s],a=Object[r(724)](i)[r(500)](Number)[r(684)]((o,d)=>o-d);for(const o of a)t[s+n][o]=i[o];delete t[s]}else delete t[s+n];else for(let s=e+x-1;s>=e;s--)if(t[r(390)](s)){t[r(390)](s+n)||(t[s+n]={});const i=t[s],a=Object[r(724)](i)[r(500)](Number)[r(684)]((o,d)=>o-d);for(const o of a)t[s+n][o]=i[o];delete t[s]}else delete t[s+n]}function Pt(t,e,x,n){const r=_,s=Object[r(724)](t)[r(500)](Number)[r(684)]((i,a)=>i-a);if(n<0)for(const i of s){const a=t[i];for(let o=e;o<e+x;o++)a[r(390)](o)?(a[o+n]=a[o],delete a[o]):delete a[o+n]}else for(const i of s){const a=t[i];for(let o=e+x-1;o>=e;o--)a.hasOwnProperty(o)?(a[o+n]=a[o],delete a[o]):delete a[o+n]}}function ls(t,e){const x=_;return new _1()[x(617)](t).subtract(...e)[x(516)]()}function Qe(t,e,x,n){const r=_,s=new f1()[r(422)](x);if(s==null)return x;const i=[];for(let a=0,o=s.length;a<o;a++){const d=s[a];if(typeof d=="string"||d.nodeType!==m1[r(744)]){i[r(442)](d);continue}const{token:c}=d,l=b1(c),{range:u,sheetName:f,unitId:b}=l;if((t===b||b==="")&&(e===f||f==="")){const h=n(u),p=h?h1({range:h,sheetName:f,unitId:b}):gt[r(399)];i[r(442)]({...d,token:p})}else i[r(442)](d)}return"="+p1(i)}function rx(t,e){const x=_;return t[x(374)]<=e.end&&t[x(787)]>=e[x(374)]}function Vi(t,e){const x=_;return t[x(374)]<=e.start&&t[x(787)]>=e[x(787)]}function $r(t,e){const x=_;let n=[t];for(const r of e){const s=[];for(const i of n)s[x(442)](...fl(i,r));n=s}return n}function fl(t,e){const x=_,n=[];if(Vi(e,t))return n;if(Vi(t,e)){const r=t[x(374)],s=e[x(374)]-1,i=e.end+1,a=t[x(787)];return r<=s&&n[x(442)]({start:r,end:s}),i<=a&&n[x(442)]({start:i,end:a}),n}return rx(t,e)?(t[x(374)]<e[x(374)]&&n.push({start:t[x(374)],end:e[x(374)]-1}),t.end>e[x(787)]&&n[x(442)]({start:e[x(787)]+1,end:t[x(787)]}),n):[t]}function Ar(t,e){const x=_,n={startColumn:t[x(374)],endColumn:t[x(787)],startRow:0,endRow:1,rangeType:Qx[x(749)]},r={startColumn:e[x(374)],endColumn:e[x(787)],startRow:0,endRow:1,rangeType:Qx.COLUMN},s=E0(n,r);return{start:e[x(374)]+s[x(409)],end:e[x(787)]+s[x(409)]+s.length}}function Vr(t,e){const x=_,n={startColumn:t[x(374)],endColumn:t.end,startRow:0,endRow:1,rangeType:Qx[x(749)]},r={startColumn:e[x(374)],endColumn:e[x(787)],startRow:0,endRow:1,rangeType:Qx[x(749)]},s=$0(n,r);return s===null?null:{start:e[x(374)]+s[x(409)],end:e[x(787)]+s[x(409)]+s[x(411)]}}function kn(t,e){const x=_,{unitId:n,subUnitId:r}=t[x(472)],s=o=>Qe(n,r,o,d=>rs(d,e)),i=[],a=o=>{const d=x;var c,l;const u=o.uid,f=o[d(644)][d(500)](C=>Sa(C,e)),b=(c=o[d(779)])!=null?c:"",h=(l=o.formula2)!=null?l:"";let p=b,I=h;d2(b)&&(p=s(b)),d2(h)&&(I=s(h)),(p!==b||I!==h)&&i[d(442)]({id:dx.id,params:{unitId:n,subUnitId:r,ruleId:u,payload:{type:Ax[d(631)],payload:{type:o[d(478)],formula1:p,formula2:I}}}});const v=f[d(456)]()[d(674)](Boolean);st(o[d(644)],v)||i[d(442)]({id:dx.id,params:{unitId:n,subUnitId:r,ruleId:u,payload:{type:Ax.RANGE,payload:v}}})};return Array[x(552)](t[x(472)][x(610)])?t.params[x(610)][x(384)](o=>a(o)):a(t[x(472)][x(610)]),i}const ml={m1:q0.id,m2:ye.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t[x(472)].subUnitId!==e[x(472)][x(505)])return n;const r={id:ts.id,params:{fromRange:t.params[x(480)],toRange:t[x(472)][x(723)]}},s=kn(e,r);return{m1Prime:[t,...s],m2Prime:[e,...s]}}},bl={m1:B0.id,m2:ye.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t.params[x(505)]!==e.params[x(505)])return n;const r={id:ss.id,params:{unitId:t[x(472)][x(675)],subUnitId:t.params.subUnitId,range:t.params[x(604)]}},s=kn(e,r);return{m1Prime:[t,...s],m2Prime:[e,...s]}}},hl={m1:B0.id,m2:F0.id,handler(t,e){const x=_,n=qa[x(549)](e,t);return Te(n)?{m1Prime:n[x(633)],m2Prime:n[x(753)]}:n}},pl={m1:B0.id,m2:B0.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)].unitId!==e.params[x(675)]||t[x(472)][x(505)]!==e[x(472)].subUnitId)return n;const r=R[x(544)](t),s=R.deepClone(e),i=E0(X(t[x(472)][x(604)]),X(e[x(472)][x(604)]));if(i?(s[x(472)][x(604)][x(616)]+=i.step,s[x(472)][x(604)][x(499)]+=i[x(409)]+(i[x(411)]||0)):s.id=h0.id,t[x(472)][x(604)][x(616)]!==e[x(472)][x(604)].startColumn){const a=E0(X(e[x(472)][x(604)]),X(t[x(472)].range));a?(r[x(472)][x(604)][x(616)]+=a.step,r[x(472)][x(604)].endColumn+=a[x(409)]+(a[x(411)]||0)):r.id=h0.id}return{m1Prime:r,m2Prime:s}}},_l={m1:B0.id,m2:q0.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e.params[x(675)]||t[x(472)][x(505)]!==e.params[x(505)])return n;const r=R[x(544)](t),s=R[x(544)](e),i=e[x(472)][x(480)],a=e[x(472)][x(723)];if(t.params[x(604)].startColumn>i[x(616)]&&t[x(472)][x(604)][x(616)]<=i.endColumn||t[x(472)][x(604)][x(616)]>a[x(616)]&&t[x(472)][x(604)][x(616)]<=a[x(499)])return{error:new Error(x(408))};const o=E0(X(t[x(472)][x(604)]),X(i)),d=E0(X(t[x(472)].range),X(a));if(s[x(472)][x(480)][x(616)]+=o[x(409)],s.params.sourceRange.endColumn+=o[x(409)]+(o[x(411)]||0),s[x(472)][x(723)][x(616)]+=d[x(409)],s[x(472)][x(723)][x(499)]+=d.step+(d[x(411)]||0),i.startColumn>=t[x(472)][x(604)][x(616)]&&a[x(616)]<t[x(472)][x(604)][x(616)]){const c=a.endColumn-a[x(616)]+1;r.params[x(604)][x(616)]+=c,r[x(472)][x(604)].endColumn+=c}else if(i[x(499)]<t[x(472)][x(604)][x(616)]&&a[x(616)]>=t[x(472)][x(604)].startColumn){const c=i[x(499)]-i[x(616)]+1;r[x(472)][x(604)][x(616)]-=c,r[x(472)][x(604)][x(499)]-=c}return{m1Prime:r,m2Prime:s}}},Il={m1:B0.id,m2:hx.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e.params.unitId||t[x(472)][x(505)]!==e[x(472)][x(662)][x(505)]&&t[x(472)].subUnitId!==e[x(472)].to.subUnitId)return n;const r=R.deepClone(t),s=R[x(544)](e);if(t[x(472)][x(505)]===e[x(472)][x(662)][x(505)]){const i=new K(s.params.from[x(822)])[x(663)](),{startColumn:a,endColumn:o}=i,{startColumn:d,endColumn:c}=t[x(472)][x(604)],{step:l,length:u}=E0(t[x(472)][x(604)],i);l>0&&u===0&&Pt(s[x(472)][x(662)][x(822)],a,o-a+1,l),l===0&&u>0&&Pt(s[x(472)][x(662)].value,d,o-d+1,c-d+1)}if(t.params.subUnitId===e.params.to[x(505)]){const i=new K(s.params.to[x(822)])[x(663)](),{startColumn:a,endColumn:o}=i,{startColumn:d,endColumn:c}=t[x(472)].range,{step:l,length:u}=E0(t[x(472)][x(604)],i);l>0&&u===0&&Pt(s[x(472)].to.value,a,o-a+1,l),l===0&&u>0&&Pt(s.params.to[x(822)],d,o-d+1,c-d+1)}return{m1Prime:r,m2Prime:s}}},gl={m1:B0.id,m2:V0.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)].unitId!==e.params[x(675)]||t[x(472)][x(505)]!==e.params[x(505)])return n;const r=R.deepClone(t),s=R[x(544)](e);if(t[x(472)][x(604)][x(616)]<=e[x(472)].range[x(499)]&&t[x(472)][x(604)][x(616)]>e.params[x(604)].startColumn)return{error:new Error(x(784))};const i=E0(X(t.params[x(604)]),X(e.params[x(604)]));i?(s[x(472)][x(604)][x(616)]+=i.step,s[x(472)][x(604)][x(499)]+=i.step+(i[x(411)]||0)):s.id=h0.id;const a=$0(X(e[x(472)][x(604)]),X(t[x(472)].range));return a&&(r.params[x(604)][x(616)]+=a[x(409)],r[x(472)][x(604)][x(499)]+=a[x(409)]+(a.length||0)),{m1Prime:r,m2Prime:s}}},vl={m1:B0.id,m2:gx.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)].unitId!==e.params[x(675)]||t[x(472)][x(505)]!==e[x(472)][x(505)])return n;const r=R[x(544)](t),s=R[x(544)](e),{ranges:i}=s[x(472)];return i[x(503)](a=>{const o=x,d=E0(X(t[o(472)][o(604)]),X(a));return d[o(411)]!==0?!0:(a[o(616)]+=d[o(409)],a[o(499)]+=d[o(409)],!1)})?{error:new Error("insert col is conflict with remove numfmt")}:{m1Prime:r,m2Prime:s}}},Cl={m1:B0.id,m2:Z0.id,handler(t,e){const x=_,n=R.deepClone(t),r=R[x(544)](e);if(t[x(472)].unitId!==e.params[x(675)]||t[x(472)].subUnitId!==e[x(472)].subUnitId)return{m1Prime:n,m2Prime:r};const s=r[x(472)].ranges.map(i=>{const a=x,o=n[a(472)][a(604)],d=o[a(499)]-o[a(616)]+1;return o.startColumn<=i.startColumn?{...i,startColumn:i.startColumn+d,endColumn:i[a(499)]+d}:o[a(616)]>i.startColumn&&o[a(616)]<=i.endColumn?{...i,endColumn:i[a(499)]+d}:{...i}});return r[x(472)][x(644)]=s,{m1Prime:n,m2Prime:r}}},wl={m1:B0.id,m2:Hx.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e.params.unitId||t[x(472)][x(505)]!==e[x(472)][x(505)])return n;const r=R.deepClone(e),s=E0(X(t[x(472)][x(604)]),X(e.params[x(604)]));return r[x(472)][x(604)].startColumn+=s.step,r[x(472)][x(604)].endColumn+=s[x(409)]+(s.length||0),{m1Prime:t,m2Prime:r}}},Pl={m1:B0.id,m2:cn.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)].unitId!==e.params[x(675)]||t.params[x(505)]!==e[x(472)].subUnitId)return n;const r=R[x(544)](t),s=R[x(544)](e),{columnData:i}=s[x(472)];for(let a=t[x(472)][x(604)][x(616)];a<=t.params[x(604)].endColumn;a++)En(a,void 0,i);return{m1Prime:r,m2Prime:s}}},yl={m1:B0.id,m2:K2.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)].unitId!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e[x(472)][x(505)])return n;const r=R[x(544)](t),s=R[x(544)](e),{ranges:i}=s[x(472)];return i[x(503)](a=>{const o=x,d=E0(X(t[o(472)][o(604)]),a);return d[o(411)]!==0?!0:(a.startColumn+=d.step,a[o(499)]+=d[o(409)],!1)})?{error:new Error(x(643))}:{m1Prime:r,m2Prime:s}}},Rl={m1:B0.id,m2:Z2.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e.params.subUnitId)return n;const r=R[x(544)](t),s=R[x(544)](e),{ranges:i}=s[x(472)];return i.some(a=>{const o=x,d=E0(X(t[o(472)][o(604)]),a);return d[o(411)]!==0?!0:(a[o(616)]+=d[o(409)],a[o(499)]+=d.step,!1)})?{error:new Error(x(816))}:{m1Prime:r,m2Prime:s}}},El={m1:B0.id,m2:Yx.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t[x(472)].subUnitId!==e[x(472)][x(505)])return n;const r=[R[x(544)](t)],s=R[x(544)](e),{values:i}=s[x(472)],a=[];let o=!1;for(const d in i){const c=i[d];if(a.push(...c.ranges),c.ranges.some(l=>{const u=x,f=E0(X(t[u(472)][u(604)]),X(l));return f.length!==0?!0:(f[u(409)]!==0&&(o=!0),l.startColumn+=f[u(409)],l[u(499)]+=f[u(409)],!1)}))return{error:new Error("insert col is conflict with set numfmt")}}if(o){const d={id:gx.id,params:{unitId:e.params.unitId,subUnitId:e[x(472)].subUnitId,ranges:a}};r[x(442)](d,s)}return{m1Prime:r,m2Prime:s}}},Sl={m1:B0.id,m2:H0.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)].unitId!==e.params.unitId||t[x(472)][x(505)]!==e.params[x(505)])return n;const r=[R[x(544)](t)],s=R.deepClone(e),i=new K(s[x(472)][x(589)]),a=i[x(663)](),o=t[x(472)][x(604)],d=o[x(499)]-o[x(616)]+1;if(s[x(472)][x(589)]&&o[x(616)]<=a[x(499)]){const u=Math[x(786)](a.startColumn,o[x(616)]);Pt(s[x(472)].cellValue,u,a[x(499)]-u+1,d)}const c=new K;let l=!1;if(i[x(698)]((u,f,b)=>{const h=x;if(b&&b.f){const p=b.f;let I=!1;const v=Qe(t[h(472)][h(675)],t[h(472)][h(505)],p,C=>{const w=h,y=E0(X(t.params[w(604)]),X(C));return(y[w(409)]!==0||y[w(411)]!==0)&&(I=!0,C[w(616)]+=y[w(409)],C[w(499)]+=y[w(409)]+y[w(411)]),C});I&&(l=!0,b.f=v,c.setValue(u,f,{...b}))}}),l){const u={id:H0.id,params:{unitId:e[x(472)][x(675)],subUnitId:e[x(472)][x(505)],cellValue:c[x(763)]()}};r[x(442)](u)}return{m1Prime:r,m2Prime:s}}},Tl={m1:B0.id,m2:Ge.id,handler(t,e){const x=_,n={m1Prime:[],m2Prime:[]};if(t[x(472)][x(675)]!==e[x(472)].unitId||t[x(472)][x(505)]!==e[x(472)][x(505)])return n;const r=R[x(544)](e);let s=!1;return r[x(472)][x(427)][x(384)](i=>{const a=x,{range:o,primary:d}=i,c=E0(X(t[a(472)][a(604)]),X(o));if(c[a(411)]||c[a(409)]){if(o.startColumn+=c.step,o[a(499)]+=c[a(409)]+(c[a(411)]||0),d){const l=E0(X(t[a(472)][a(604)]),X(d));(l.length||l.step)&&(d.startColumn+=l[a(409)],d[a(499)]+=l[a(409)],d[a(428)]+=l[a(409)])}s=!0}}),s&&n[x(633)][x(442)](r),n}},Ml={m1:B0.id,m2:Le.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e[x(472)][x(505)])return n;const r=R[x(544)](t),s=R.deepClone(e),i=Ar({start:t[x(472)].range.startColumn,end:t[x(472)][x(604)][x(499)]},{start:e.params[x(758)],end:e[x(472)][x(758)]});if(s[x(472)][x(758)]===i.start)return n;s[x(472)][x(758)]=i[x(374)],s[x(472)][x(688)]&&(s[x(472)][x(688)].colId=i[x(374)]);const a=R[x(544)](e);return a[x(472)][x(688)]=null,{m1Prime:[a,s,r],m2Prime:[s]}}},Nl={m1:B0.id,m2:le.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t.params[x(675)]!==e[x(472)].unitId||t[x(472)][x(505)]!==e[x(472)][x(505)])return n;const r=R.deepClone(t),s=R[x(544)](e),i=Ar({start:t[x(472)][x(604)][x(616)],end:t[x(472)].range[x(499)]},{start:e.params.range[x(616)],end:e.params[x(604)][x(499)]});return s[x(472)][x(604)][x(616)]===i[x(374)]&&s[x(472)].range[x(499)]===i[x(787)]?n:(s[x(472)][x(604)].startColumn=i[x(374)],s[x(472)][x(604)][x(499)]=i[x(787)],{m1Prime:[s,r],m2Prime:[s]})}},Ul={m1:B0.id,m2:de.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t.params[x(675)]!==e[x(472)][x(675)]||t[x(472)].subUnitId!==e[x(472)][x(505)])return n;const r=R[x(544)](t),s=R[x(544)](e),{ranges:i,colWidth:a}=s[x(472)];if(i[x(503)](o=>{const d=x,c=E0(X(t[d(472)][d(604)]),o);return c[d(411)]!==0?!0:(o[d(616)]+=c[d(409)],o[d(499)]+=c[d(409)],!1)}))return{error:new Error("insert col is conflict with set worksheet col width")};if(typeof a!=x(602))for(let o=t[x(472)].range[x(616)];o<=t[x(472)][x(604)][x(499)];o++)En(o,void 0,a);return{m1Prime:r,m2Prime:s}}},Ot=(t,e)=>{const x=_,n=Ta(t.params.payload[x(697)]),r={startColumn:n[x(791)],endColumn:n[x(791)],startRow:n[x(593)],endRow:n.row},s=rs(r,e);if(!s)return[{id:Et.id,params:{...t[x(472)],comment:void 0,commentId:t.params.payload.commentId}}];const i=l2(s);return i===t[x(472)][x(575)].ref?[]:[{id:ce.id,params:{...t[x(472)],comment:void 0,payload:{ref:i,commentId:t[x(472)][x(575)][x(474)]}}}]},kl={m1:B0.id,m2:ce.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t.params[x(505)]!==e[x(472)][x(505)])return n;const r={id:ss.id,params:{unitId:t.params[x(675)],subUnitId:t.params.subUnitId,range:t[x(472)][x(604)]}},s=Ot(e,r);return{m1Prime:[t,...s],m2Prime:[e,...s]}}};function Ft(t,e){const x=_;var n,r;const{payload:s,unitId:i,subUnitId:a,ruleId:o}=t.params;switch(s[x(478)]){case Ax[x(567)]:{const d=s[x(575)].map(c=>Sa(c,e))[x(674)](Boolean)[x(456)]();if(!st(d,s[x(575)]))return[{id:dx.id,params:{unitId:i,subUnitId:a,ruleId:o,payload:{type:Ax[x(567)],payload:d}}}];break}case Ax.SETTING:{const d=b=>Qe(i,a,b,h=>rs(h,e)),c=(n=s.payload[x(779)])!=null?n:"",l=(r=s[x(575)].formula2)!=null?r:"";let u=c,f=l;if(d2(c)&&(u=d(c)),d2(l)&&(f=d(l)),u!==c||f!==l)return[{id:dx.id,params:{unitId:i,subUnitId:a,ruleId:o,payload:{type:Ax[x(631)],payload:{type:s[x(575)][x(478)],formula1:u,formula2:f}}}}];break}}return[]}const Dl={m1:q0.id,m2:dx.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};if(t.params.unitId!==e.params[x(675)]||e[x(472)][x(505)]!==t[x(472)][x(505)])return n;const r={id:ts.id,params:{fromRange:t[x(472)][x(480)],toRange:t.params.targetRange}},s=Ft(e,r);return{m1Prime:[t,...s],m2Prime:[e,...s]}}},Ol={m1:B0.id,m2:dx.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)][x(675)]||e[x(472)][x(505)]!==t[x(472)][x(505)])return n;const r={id:ss.id,params:{unitId:t[x(472)].unitId,subUnitId:t[x(472)].subUnitId,range:t[x(472)].range}},s=Ft(e,r);return{m1Prime:[t,...s],m2Prime:[e,...s]}}},Fl={m1:G0.id,m2:xe.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)].unitId||t[x(472)][x(505)]!==e[x(472)][x(505)])return n;const r={id:Rr.id,params:{unitId:t.params.unitId,subUnitId:t[x(472)][x(505)],range:t[x(472)][x(604)]}},s=Dt(e,r);return{m1Prime:[t,...s],m2Prime:[e,...s]}}},$l={m1:G0.id,m2:F0.id,handler(t,e){const x=_,n=Ka[x(549)](e,t);return Te(n)?{m1Prime:n[x(633)],m2Prime:n[x(753)]}:n}},Al={m1:G0.id,m2:G0.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t.params[x(505)]!==e[x(472)][x(505)])return n;const r=R[x(544)](t),s=R[x(544)](e),i=E0(X(s0(t.params.range)),X(s0(e.params.range)));if(i?(s.params[x(604)].startRow+=i.step,s[x(472)].range.endRow+=i[x(409)]+(i[x(411)]||0)):s.id=h0.id,t.params[x(604)].startRow!==e.params[x(604)][x(388)]){const a=E0(X(s0(e[x(472)].range)),X(s0(t.params.range)));a?(r.params[x(604)][x(388)]+=a[x(409)],r[x(472)][x(604)][x(715)]+=a[x(409)]+(a[x(411)]||0)):r.id=h0.id}return{m1Prime:r,m2Prime:s}}},Vl={m1:G0.id,m2:hx.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e[x(472)][x(662)][x(505)]&&t[x(472)].subUnitId!==e[x(472)].to.subUnitId)return n;const r=R[x(544)](t),s=R.deepClone(e);if(t[x(472)][x(505)]===e[x(472)][x(662)][x(505)]){const i=new K(s[x(472)][x(662)][x(822)])[x(663)](),{startRow:a,endRow:o}=i,{startRow:d,endRow:c}=t[x(472)][x(604)],{step:l,length:u}=E0(s0(t[x(472)][x(604)]),s0(i));l>0&&u===0&&wt(s[x(472)][x(662)][x(822)],a,o-a+1,l),l===0&&u>0&&wt(s[x(472)][x(662)][x(822)],d,o-d+1,c-d+1)}if(t.params[x(505)]===e[x(472)].to[x(505)]){const i=new K(e.params.to[x(822)]).getDataRange(),{startRow:a,endRow:o}=i,{startRow:d,endRow:c}=t[x(472)][x(604)],{step:l,length:u}=E0(s0(t[x(472)].range),s0(i));l>0&&u===0&&wt(s[x(472)].to[x(822)],a,o-a+1,l),l===0&&u>0&&wt(s[x(472)].to[x(822)],d,o-d+1,c-d+1)}return{m1Prime:r,m2Prime:s}}},jl={m1:G0.id,m2:Y0.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)].unitId||t[x(472)][x(505)]!==e.params[x(505)])return n;const r=R[x(544)](t),s=R.deepClone(e),i=e[x(472)].sourceRange,a=e.params[x(723)];if(t.params[x(604)][x(388)]>i[x(388)]&&t[x(472)][x(604)][x(388)]<=i[x(715)]||t[x(472)].range[x(388)]>a[x(388)]&&t[x(472)][x(604)].startRow<=a.endRow)return{error:new Error(x(408))};const o=E0(X(s0(t[x(472)][x(604)])),X(s0(i))),d=E0(X(s0(t[x(472)][x(604)])),X(s0(a)));if(s.params.sourceRange.startRow+=o[x(409)],s[x(472)].sourceRange[x(715)]+=o[x(409)]+(o[x(411)]||0),s[x(472)].targetRange.startRow+=d[x(409)],s[x(472)][x(723)][x(715)]+=d.step+(d[x(411)]||0),i.startRow>=t.params[x(604)].startRow&&a[x(388)]<t[x(472)].range[x(388)]){const c=a[x(715)]-a[x(388)]+1;r[x(472)][x(604)].startRow+=c,r[x(472)].range[x(715)]+=c}else if(i[x(715)]<t[x(472)][x(604)].startRow&&a[x(388)]>=t[x(472)][x(604)][x(388)]){const c=i.endRow-i.startRow+1;r.params.range[x(388)]-=c,r[x(472)][x(604)].endRow-=c}return{m1Prime:r,m2Prime:s}}},Ll={m1:G0.id,m2:gx.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t.params[x(675)]!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e[x(472)][x(505)])return n;const r=R[x(544)](t),s=R[x(544)](e),{ranges:i}=s[x(472)];return i[x(503)](a=>{const o=x,d=E0(X(s0(t.params[o(604)])),X(s0(a)));return d.length!==0?!0:(a[o(388)]+=d[o(409)],a[o(715)]+=d[o(409)],!1)})?{error:new Error(x(746))}:{m1Prime:r,m2Prime:s}}},Hl={m1:G0.id,m2:j0.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)].unitId!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e[x(472)][x(505)])return n;const r=R[x(544)](t),s=R.deepClone(e);if(t[x(472)][x(604)].startRow<=e[x(472)][x(604)][x(715)]&&t[x(472)][x(604)][x(388)]>e.params.range[x(388)])return{error:new Error(x(784))};const i=E0(X(s0(t.params[x(604)])),X(s0(e[x(472)][x(604)])));i?(s[x(472)][x(604)][x(388)]+=i.step,s[x(472)][x(604)][x(715)]+=i.step+(i[x(411)]||0)):s.id=h0.id;const a=$0(X(s0(e.params.range)),X(s0(t[x(472)].range)));return a&&(r[x(472)][x(604)].startRow+=a[x(409)],r[x(472)][x(604)][x(715)]+=a[x(409)]+(a.length||0)),{m1Prime:r,m2Prime:s}}},Bl={m1:G0.id,m2:Z0.id,handler(t,e){const x=_,n=R[x(544)](t),r=R[x(544)](e);if(t[x(472)].unitId!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e[x(472)][x(505)])return{m1Prime:n,m2Prime:r};const s=r.params[x(644)][x(500)](i=>{const a=x,o=n[a(472)][a(604)],d=o[a(715)]-o.startRow+1;return o[a(388)]<=i[a(388)]?{...i,startRow:i[a(388)]+d,endRow:i[a(715)]+d}:o[a(388)]>i[a(388)]&&o[a(388)]<=i[a(715)]?{...i,endRow:i.endRow+d}:{...i}});return r[x(472)][x(644)]=s,{m1Prime:n,m2Prime:r}}},Gl={m1:G0.id,m2:Hx.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e[x(472)].subUnitId)return n;const r=R.deepClone(e),s=E0(X(s0(t.params[x(604)])),X(s0(e.params[x(604)])));r[x(472)].range.startRow+=s.step,r.params[x(604)][x(715)]+=s[x(409)]+(s[x(411)]||0);const i=t.params[x(604)][x(388)],a=t[x(472)][x(604)][x(715)]-t[x(472)][x(604)][x(388)]+1,o={};for(const d in e[x(472)].order){let c=Number(d),l=e[x(472)][x(541)][d];c=ji(i,a,c),l=ji(i,a,l),o[c]=l}return r.params[x(541)]=o,{m1Prime:t,m2Prime:r}}},ji=(t,e,x)=>x>=t?x+e:x,Yl={m1:G0.id,m2:Yx.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e[x(472)][x(505)])return n;const r=[R.deepClone(t)],s=R[x(544)](e),{values:i}=s[x(472)],a=[];let o=!1;for(const d in i){const c=i[d];if(a.push(...c.ranges),c[x(644)][x(503)](l=>{const u=x,f=E0(X(s0(t.params.range)),s0(X(l)));return f[u(411)]!==0?!0:(f.step!==0&&(o=!0),l[u(388)]+=f.step,l[u(715)]+=f[u(409)],!1)}))return{error:new Error("insert row is conflict with set numfmt")}}if(o){const d={id:gx.id,params:{unitId:e[x(472)][x(675)],subUnitId:e[x(472)][x(505)],ranges:a}};r[x(442)](d,s)}return{m1Prime:r,m2Prime:s}}},Wl={m1:G0.id,m2:H0.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t.params.unitId!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e.params[x(505)])return n;const r=[R[x(544)](t)],s=R.deepClone(e),i=new K(s[x(472)][x(589)]),a=i[x(663)](),o=t[x(472)][x(604)],d=o[x(715)]-o[x(388)]+1;if(s[x(472)].cellValue&&o[x(388)]<=a[x(715)]){const u=Math[x(786)](a[x(388)],o[x(388)]);wt(s[x(472)][x(589)],u,a[x(715)]-u+1,d)}const c=new K;let l=!1;if(i[x(698)]((u,f,b)=>{const h=x;if(b&&b.f){const p=b.f;let I=!1;const v=Qe(t.params.unitId,t[h(472)].subUnitId,p,C=>{const w=h,y=E0(X(s0(t[w(472)][w(604)])),X(s0(C)));return(y.step!==0||y[w(411)]!==0)&&(I=!0,C[w(388)]+=y[w(409)],C[w(715)]+=y.step+y[w(411)]),C});I&&(l=!0,b.f=v,c[h(645)](u,f,{...b}))}}),l){const u={id:H0.id,params:{unitId:e.params[x(675)],subUnitId:e[x(472)][x(505)],cellValue:c[x(763)]()}};r.push(u)}return{m1Prime:r,m2Prime:s}}},Ql={m1:G0.id,m2:mn.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t.params[x(675)]!==e[x(472)][x(675)]||t[x(472)].subUnitId!==e.params[x(505)])return n;const r=R[x(544)](t),s=R[x(544)](e),{rowData:i}=s[x(472)];for(let a=t[x(472)][x(604)][x(388)];a<=t[x(472)].range[x(715)];a++)En(a,void 0,i);return{m1Prime:r,m2Prime:s}}},zl={m1:G0.id,m2:xs.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)].unitId!==e.params[x(675)]||t[x(472)][x(505)]!==e[x(472)][x(505)])return n;const r=R[x(544)](t),s=R.deepClone(e),{ranges:i}=s[x(472)];return i[x(503)](a=>{const o=x,d=E0(X(s0(t.params.range)),X(s0(a)));return d.length!==0?!0:(a.startRow+=d[o(409)],a[o(715)]+=d.step,!1)})?{error:new Error("insert row is conflict with set row hidden")}:{m1Prime:r,m2Prime:s}}},Jl={m1:G0.id,m2:es.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t.params[x(675)]!==e.params[x(675)]||t.params.subUnitId!==e.params[x(505)])return n;const r=R[x(544)](t),s=R[x(544)](e),{ranges:i}=s.params;return i.some(a=>{const o=x,d=E0(X(s0(t[o(472)][o(604)])),X(s0(a)));return d[o(411)]!==0?!0:(a[o(388)]+=d[o(409)],a[o(715)]+=d[o(409)],!1)})?{error:new Error(x(486))}:{m1Prime:r,m2Prime:s}}},Xl={m1:G0.id,m2:Ge.id,handler(t,e){const x=_,n={m1Prime:[],m2Prime:[]};if(t[x(472)][x(675)]!==e.params[x(675)]||t[x(472)][x(505)]!==e[x(472)][x(505)])return n;const r=R.deepClone(e);let s=!1;return r[x(472)][x(427)][x(384)](i=>{const a=x,{range:o,primary:d}=i,c=E0(X(s0(t.params[a(604)])),X(s0(o)));if(c[a(411)]||c.step){if(o.startRow+=c.step,o[a(715)]+=c[a(409)]+(c[a(411)]||0),d){const l=E0(X(s0(t[a(472)][a(604)])),X(s0(d)));(l[a(411)]||l[a(409)])&&(d[a(388)]+=l.step,d[a(715)]+=l.step,d[a(393)]+=l[a(409)])}s=!0}}),s&&n[x(633)].push(r),n}},ql={m1:G0.id,m2:le.id,handler(t,e){const x=_,n={m1Prime:[t],m2Prime:[e]};if(t[x(472)][x(675)]!==e[x(472)].unitId||t[x(472)][x(505)]!==e[x(472)][x(505)])return n;const r=R.deepClone(t),s=R[x(544)](e),i=Ar({start:t[x(472)][x(604)].startRow,end:t[x(472)].range.endRow},{start:e[x(472)][x(604)][x(388)],end:e[x(472)][x(604)][x(715)]});return s[x(472)][x(604)].startRow===i.start&&s[x(472)][x(604)].endRow===i[x(787)]?n:(s.params[x(604)].startRow=i[x(374)],s[x(472)].range[x(715)]=i[x(787)],{m1Prime:[s,r],m2Prime:[s]})}},Kl={m1:G0.id,m2:ln.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)].unitId||t[x(472)].subUnitId!==e[x(472)][x(505)])return n;const r=R.deepClone(t),s=R[x(544)](e),{rowsAutoHeightInfo:i}=s[x(472)];return i[x(503)](a=>{const o=x,d={startRow:a[o(593)],endRow:a[o(593)],startColumn:0,endColumn:0},c=E0(X(s0(t[o(472)].range)),s0(d));return c[o(411)]!==0?!0:(a[o(593)]+=c[o(409)],!1)})?{error:new Error(x(373))}:{m1Prime:r,m2Prime:s}}},Zl={m1:G0.id,m2:un.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t.params[x(505)]!==e[x(472)][x(505)])return n;const r=R[x(544)](t),s=R[x(544)](e),{ranges:i,rowHeight:a}=s[x(472)];if(i[x(503)](o=>{const d=x,c=E0(X(s0(t[d(472)].range)),s0(o));return c[d(411)]!==0?!0:(o[d(388)]+=c[d(409)],o.endRow+=c[d(409)],!1)}))return{error:new Error(x(414))};if(typeof a!=x(602))for(let o=t[x(472)][x(604)].startRow;o<=t.params[x(604)][x(715)];o++)En(o,void 0,a);return{m1Prime:r,m2Prime:s}}},xu={m1:G0.id,m2:fn.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e.params.unitId||t.params[x(505)]!==e[x(472)][x(505)])return n;const r=R[x(544)](t),s=R[x(544)](e),{ranges:i,autoHeightInfo:a}=s[x(472)];if(i[x(503)](o=>{const d=x,c=E0(X(s0(t[d(472)][d(604)])),s0(o));return c[d(411)]!==0?!0:(o[d(388)]+=c.step,o[d(715)]+=c[d(409)],!1)}))return{error:new Error("insert row is conflict with set worksheet row is auto height")};if(typeof a!=x(602))for(let o=t[x(472)].range[x(388)];o<=t[x(472)].range.endRow;o++)En(o,void 0,a);return{m1Prime:r,m2Prime:s}}},eu={m1:G0.id,m2:ce.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t[x(472)].subUnitId!==e.params[x(505)])return n;const r={id:Rr.id,params:{unitId:t[x(472)][x(675)],subUnitId:t.params[x(505)],range:t[x(472)].range}},s=Ot(e,r);return{m1Prime:[t,...s],m2Prime:[e,...s]}}},tu={m1:G0.id,m2:dx.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)].unitId!==e[x(472)].unitId||e[x(472)][x(505)]!==t[x(472)][x(505)])return n;const r={id:Rr.id,params:{unitId:t[x(472)].unitId,subUnitId:t[x(472)][x(505)],range:t[x(472)][x(604)]}},s=Ft(e,r);return{m1Prime:[t,...s],m2Prime:[e,...s]}}},nu={m1:q0.id,m2:xe.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e.params[x(505)])return n;const r={id:ts.id,params:{unitId:t.params.unitId,subUnitId:t[x(472)][x(505)],fromRange:t[x(472)][x(480)],toRange:t[x(472)][x(723)]}},s=Dt(e,r);return{m1Prime:[t,...s],m2Prime:[e,...s]}}},su={m1:q0.id,m2:F0.id,handler(t,e){const x=_,n=Za[x(549)](e,t);return Te(n)?{m1Prime:n.m2Prime,m2Prime:n[x(753)]}:n}},ru={m1:q0.id,m2:q0.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)].unitId||t[x(472)][x(505)]!==e[x(472)].subUnitId)return n;const r=R[x(544)](t),s=R.deepClone(e),i=e[x(472)][x(480)],a=e[x(472)][x(723)],o=t.params.sourceRange,d=t[x(472)][x(723)];if(o[x(499)]>=i[x(616)]&&o[x(616)]<=i.endColumn)return{error:new Error(x(691))};const c=y0({start:o[x(616)],end:o[x(499)]},{start:d[x(616)],end:d[x(499)]},{start:i[x(616)],end:i[x(499)]}),l=y0({start:o[x(616)],end:o[x(499)]},{start:d[x(616)],end:d[x(499)]},{start:a[x(616)],end:a.endColumn});c&&l?(s[x(472)].sourceRange[x(616)]+=c[x(409)],s[x(472)].sourceRange[x(499)]+=c[x(409)]+(c.length||0),s[x(472)][x(723)].startColumn+=l[x(409)],s[x(472)][x(723)].endColumn+=l[x(409)]+(l.length||0)):s.id=h0.id;const u=y0({start:i[x(616)],end:i.endColumn},{start:a[x(616)],end:a[x(499)]},{start:o[x(616)],end:o.endColumn}),f=y0({start:i[x(616)],end:i[x(499)]},{start:a[x(616)],end:a[x(499)]},{start:d[x(616)],end:d[x(499)]});return u&&f?(r[x(472)].sourceRange[x(616)]+=u.step,r.params[x(480)][x(499)]+=u[x(409)]+(u[x(411)]||0),r[x(472)][x(723)].startColumn+=f.step,r[x(472)][x(723)][x(499)]+=f[x(409)]+(f[x(411)]||0)):r.id=h0.id,{m1Prime:r,m2Prime:s}}},iu={m1:q0.id,m2:hx.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t.params[x(675)]!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e[x(472)].from[x(505)]&&t[x(472)][x(505)]!==e[x(472)].to[x(505)])return n;const r=R[x(544)](t),s=R[x(544)](e),i=t[x(472)][x(480)],a=t[x(472)][x(723)];if(t[x(472)][x(505)]===e[x(472)].from[x(505)]){const o=new K(s.params[x(662)][x(822)]),d=o[x(663)]();if(rx({start:i[x(616)],end:i[x(499)]},{start:d[x(616)],end:d[x(499)]})||rx({start:a.startColumn,end:a[x(499)]},{start:d.startColumn,end:d[x(499)]}))return{error:new Error("move col is conflict with move range")};const c=y0({start:i[x(616)],end:i[x(499)]},{start:a[x(616)],end:a[x(499)]},{start:d[x(616)],end:d.endColumn});if(c[x(411)]!==0)return{error:new Error("move col is conflict with move range")};c[x(409)]!==0&&o.moveColumns(i[x(616)],i[x(499)]-i[x(616)]+1,a[x(616)]),s[x(472)].from[x(822)]=o[x(763)]()}if(t.params[x(505)]===e.params.to[x(505)]){const o=new K(s[x(472)].to[x(822)]),d=o[x(663)]();if(rx({start:i.startColumn,end:i[x(499)]},{start:d[x(616)],end:d[x(499)]})||rx({start:a[x(616)],end:a[x(499)]},{start:d[x(616)],end:d.endColumn}))return{error:new Error(x(487))};const c=y0({start:i.startColumn,end:i[x(499)]},{start:a[x(616)],end:a[x(499)]},{start:d[x(616)],end:d.endColumn});if(c.length!==0)return{error:new Error(x(487))};c[x(409)]!==0&&o[x(717)](i[x(616)],i[x(499)]-i[x(616)]+1,a.startColumn),s[x(472)].to[x(822)]=o[x(763)]()}return{m1Prime:r,m2Prime:s}}},au={m1:q0.id,m2:gx.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e.params.unitId||t[x(472)][x(505)]!==e[x(472)].subUnitId)return n;const r=R.deepClone(t),s=R[x(544)](e),{sourceRange:i,targetRange:a}=t[x(472)],o={start:i[x(616)],end:i[x(499)]},d={start:a[x(616)],end:a.endColumn};return s[x(472)][x(644)].some(c=>{const l=x,u={start:c[l(616)],end:c[l(499)]},f=rx(o,u),b=rx(d,u);if(f||b)return!0;const h=y0(o,d,u);return h[l(411)]!==0?!0:(c[l(616)]+=h.step,c.endColumn+=h[l(409)],!1)})?{error:new Error(x(385))}:{m1Prime:r,m2Prime:s}}},ou={m1:q0.id,m2:Z0.id,handler(t,e){const x=_,n=R[x(544)](t),r=R[x(544)](e);if(t[x(472)].unitId!==e[x(472)][x(675)]||t[x(472)].subUnitId!==e.params.subUnitId)return{m1Prime:n,m2Prime:r};const s=r.params.ranges[x(376)]((i,a)=>{const o=x,{sourceRange:d,targetRange:c}=t[o(472)],l={...a};return d.endColumn<l[o(616)]&&c[o(616)]>l[o(499)]?(l[o(616)]-=d.endColumn-d[o(616)]+1,l[o(499)]-=d[o(499)]-d[o(616)]+1,Bx(l)&&i.push(l)):d.startColumn>l[o(499)]&&c[o(499)]<l[o(616)]?(l[o(616)]+=d[o(499)]-d[o(616)]+1,l.endColumn+=d[o(499)]-d[o(616)]+1,Bx(l)&&i[o(442)](l)):x0[o(394)](l,d)||x0.intersects(l,c)||i[o(442)](l),i},[]);return r[x(472)][x(644)]=s,r[x(472)][x(644)][x(411)]===0&&(r.id=h0.id),{m1Prime:n,m2Prime:r}}},du={m1:q0.id,m2:Hx.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t[x(472)].subUnitId!==e.params[x(505)])return n;const r=t.params[x(480)][x(616)],s=t[x(472)][x(480)][x(499)],i=t.params.targetRange[x(616)],a=t.params.targetRange[x(499)],o=e[x(472)].range[x(616)],d=e[x(472)][x(604)].endColumn;if(r<=d&&s>=o||i<=d&&a>=o)return{error:new Error(x(436))};const c=y0({start:r,end:s},{start:i,end:a},{start:o,end:d}),l=R[x(544)](e);return l[x(472)][x(604)][x(616)]+=c[x(409)],l[x(472)][x(604)][x(499)]+=c[x(409)]+(c.length||0),{m1Prime:t,m2Prime:l}}},cu={m1:q0.id,m2:cn.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t.params[x(505)]!==e.params.subUnitId)return n;const r=R.deepClone(t),s=R.deepClone(e),{columnData:i}=s[x(472)],{sourceRange:a,targetRange:o}=t[x(472)];return Sn(a.startColumn,a[x(499)]-a[x(616)]+1,o[x(616)],i),{m1Prime:r,m2Prime:s}}},lu={m1:q0.id,m2:K2.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e.params[x(505)])return n;const r=R[x(544)](t),s=R[x(544)](e),{ranges:i}=s[x(472)],{sourceRange:a,targetRange:o}=t[x(472)],d={start:a[x(616)],end:a[x(499)]},c={start:o[x(616)],end:o[x(499)]};return i[x(503)](l=>{const u=x,f={start:l[u(616)],end:l[u(499)]},b=rx(d,f),h=rx(c,f);if(b||h)return!0;const p=y0(d,c,f);return p[u(411)]!==0?!0:(l[u(616)]+=p[u(409)],l[u(499)]+=p[u(409)],!1)})?{error:new Error("move col is conflict with set col hidden")}:{m1Prime:r,m2Prime:s}}},uu={m1:q0.id,m2:Z2.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)].unitId!==e.params.unitId||t[x(472)][x(505)]!==e[x(472)][x(505)])return n;const r=R.deepClone(t),s=R[x(544)](e),{ranges:i}=s[x(472)],{sourceRange:a,targetRange:o}=t[x(472)],d={start:a[x(616)],end:a[x(499)]},c={start:o[x(616)],end:o.endColumn};return i[x(503)](l=>{const u=x,f={start:l[u(616)],end:l[u(499)]},b=rx(d,f),h=rx(c,f);if(b||h)return!0;const p=y0(d,c,f);return p[u(411)]!==0?!0:(l[u(616)]+=p[u(409)],l[u(499)]+=p.step,!1)})?{error:new Error("move col is conflict with set col visible")}:{m1Prime:r,m2Prime:s}}},fu={m1:q0.id,m2:Yx.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e.params.unitId||t[x(472)][x(505)]!==e[x(472)].subUnitId)return n;const r=[R[x(544)](t)],s=R[x(544)](e),{sourceRange:i,targetRange:a}=t[x(472)],o={start:i[x(616)],end:i.endColumn},d={start:a[x(616)],end:a[x(499)]},{values:c}=s[x(472)],l=[];let u=!1;for(const f in c){const b=c[f];if(l.push(...b[x(644)]),b[x(644)].some(h=>{const p=x,I={start:h[p(616)],end:h[p(499)]},v=rx(o,I),C=rx(d,I);if(v||C)return!0;const w=y0(o,d,I);return w[p(411)]!==0?!0:(w.step!==0&&(u=!0),h[p(616)]+=w[p(409)],h[p(499)]+=w.step,!1)}))return{error:new Error(x(398))}}if(u){const f={id:gx.id,params:{unitId:e[x(472)][x(675)],subUnitId:e[x(472)][x(505)],ranges:l}};r.push(f,s)}return{m1Prime:r,m2Prime:s}}},mu={m1:q0.id,m2:H0.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t.params.subUnitId!==e[x(472)][x(505)])return n;const r=[R[x(544)](t)],s=R[x(544)](e),i=new K(s[x(472)].cellValue),{sourceRange:a,targetRange:o}=t[x(472)],d=a.startColumn,c=a[x(499)]-a[x(616)]+1,l=o.startColumn;i.moveColumns(d,c,l);const u=new K;let f=!1;if(i[x(698)]((b,h,p)=>{const I=x;if(p&&p.f){const v=p.f;let C=!1;const w=Qe(t[I(472)][I(675)],t[I(472)].subUnitId,v,y=>{const P=I,E=y0({start:t.params[P(480)][P(616)],end:t[P(472)][P(480)][P(499)]},{start:t[P(472)].targetRange[P(616)],end:t.params.targetRange[P(499)]},{start:y[P(616)],end:y[P(499)]});return(E.step!==0||E.length!==0)&&(C=!0,y.startColumn+=E[P(409)],y[P(499)]+=E[P(409)]+E[P(411)]),y});C&&(f=!0,p.f=w,u[I(645)](b,h,{...p}))}}),f){const b={id:H0.id,params:{unitId:e[x(472)][x(675)],subUnitId:e[x(472)].subUnitId,cellValue:u[x(763)]()}};r[x(442)](b)}return s[x(472)][x(589)]=i[x(763)](),{m1Prime:r,m2Prime:s}}},bu={m1:q0.id,m2:Ge.id,handler(t,e){const x=_,n={m1Prime:[],m2Prime:[]};if(t[x(472)][x(675)]!==e.params[x(675)]||t[x(472)][x(505)]!==e[x(472)][x(505)])return n;const r=R[x(544)](e);let s=!1;return r[x(472)][x(427)][x(384)](i=>{const a=x,{range:o,primary:d}=i,c=y0({start:t.params[a(480)][a(616)],end:t[a(472)][a(480)][a(499)]},{start:t[a(472)][a(723)][a(616)],end:t.params[a(723)][a(499)]},{start:o[a(616)],end:o.endColumn});if(c[a(411)]||c[a(409)]){if(o.startColumn+=c[a(409)],o[a(499)]+=c.step+(c.length||0),d){const l=y0({start:t[a(472)][a(480)].startColumn,end:t[a(472)].sourceRange[a(499)]},{start:t.params[a(723)][a(616)],end:t[a(472)][a(723)][a(499)]},{start:d.startColumn,end:d[a(499)]});(l[a(411)]||l[a(409)])&&(d[a(616)]+=l.step,d[a(499)]+=l[a(409)],d[a(428)]+=l[a(409)])}s=!0}}),s&&n.m2Prime.push(r),n}},hu={m1:q0.id,m2:Le.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t.params[x(675)]!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e[x(472)][x(505)])return n;const r=R[x(544)](t),s=R[x(544)](e),i=y0({start:t[x(472)][x(480)][x(616)],end:t[x(472)][x(480)].endColumn},{start:t[x(472)][x(723)].startColumn,end:t[x(472)][x(723)][x(499)]},{start:e[x(472)][x(758)],end:e.params[x(758)]});if(i[x(409)]===0)return n;s[x(472)][x(758)]+=i[x(409)],s[x(472)][x(688)]&&(s[x(472)].criteria[x(618)]+=i[x(409)]);const a=R[x(544)](e);return a.params[x(688)]=null,{m1Prime:[a,s,r],m2Prime:[s]}}},pu={m1:q0.id,m2:le.id,handler(t,e){const x=_,n={m1Prime:[t],m2Prime:[e]};if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t[x(472)].subUnitId!==e[x(472)][x(505)])return n;const r=R[x(544)](t),s=R[x(544)](e),i=y0({start:t[x(472)].sourceRange.startColumn,end:t[x(472)][x(480)][x(499)]},{start:t[x(472)][x(723)].startColumn,end:t[x(472)][x(723)][x(499)]},{start:e[x(472)].range[x(616)],end:e.params[x(604)][x(499)]});return s.params[x(604)][x(616)]+=i[x(409)],s[x(472)][x(604)][x(499)]+=i[x(409)]+i[x(411)],{m1Prime:[s,r],m2Prime:[s]}}},_u={m1:q0.id,m2:de.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t.params[x(675)]!==e[x(472)].unitId||t[x(472)][x(505)]!==e[x(472)][x(505)])return n;const r=R.deepClone(t),s=R[x(544)](e),{ranges:i,colWidth:a}=s[x(472)],{sourceRange:o,targetRange:d}=t.params,c={start:o[x(616)],end:o[x(499)]},l={start:d[x(616)],end:d.endColumn};return i[x(503)](u=>{const f=x,b={start:u.startColumn,end:u.endColumn},h=y0(c,l,b);return h[f(411)]!==0?!0:(u[f(616)]+=h.step,u.endColumn+=h[f(409)],!1)})?{error:new Error(x(386))}:(typeof a!="number"&&Sn(o[x(616)],o[x(499)]-o[x(616)]+1,d[x(616)],a),{m1Prime:r,m2Prime:s})}},Iu={m1:q0.id,m2:ce.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};if(t.params[x(675)]!==e[x(472)].unitId||t.params[x(505)]!==e[x(472)][x(505)])return n;const r={id:ts.id,params:{unitId:t[x(472)][x(675)],subUnitId:t[x(472)][x(505)],fromRange:t[x(472)][x(480)],toRange:t[x(472)][x(723)]}},s=Ot(e,r);return{m1Prime:[t,...s],m2Prime:[e,...s]}}},gu={m1:Ls.id,m2:Ls.id,handler(t,e){const x=_;return t[x(472)][x(675)]!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e[x(472)].subUnitId?{m1Prime:t,m2Prime:e}:{error:new Error("Move conditional formatting rule  is conflict with self")}}},vu={m1:hx.id,m2:F0.id,handler(t,e){const x=xo.handler(e,t);return Te(x)?{m1Prime:x.m2Prime,m2Prime:x.m1Prime}:x}},Cu={m1:hx.id,m2:hx.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e.params.unitId)return n;const r=new K(t.params.from[x(822)])[x(663)](),s=new K(e[x(472)][x(662)][x(822)]).getDataRange(),i=new K(t[x(472)].to[x(822)])[x(663)](),a=new K(e[x(472)].to.value)[x(663)]();return t[x(472)][x(662)][x(505)]===e[x(472)][x(662)][x(505)]&&x0.intersects(r,s)||t.params.to.subUnitId===e[x(472)].to.subUnitId&&x0[x(394)](i,a)||t[x(472)].from[x(505)]===e[x(472)].to[x(505)]&&x0[x(394)](r,a)||t[x(472)].to[x(505)]===e[x(472)].from[x(505)]&&x0[x(394)](i,s)?{error:new Error(x(581))}:n}},wu={m1:hx.id,m2:gx.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t.params.from[x(505)]!==e[x(472)].subUnitId&&t[x(472)].to[x(505)]!==e[x(472)].subUnitId)return n;const r=new K(t.params[x(662)][x(822)])[x(663)](),s=new K(t[x(472)].to[x(822)])[x(663)]();return t.params.from.subUnitId===e[x(472)][x(505)]&&e.params[x(644)].some(i=>x0[x(394)](i,r))?{error:new Error(x(712))}:t[x(472)].to.subUnitId===e[x(472)][x(505)]&&e[x(472)][x(644)][x(503)](i=>x0[x(394)](i,s))?{error:new Error("move range is conflict with set numfmt")}:n}},Pu={m1:hx.id,m2:Hx.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t[x(472)].from[x(505)]!==e[x(472)][x(505)]&&t.params.to[x(505)]!==e.params.subUnitId)return n;if(t.params[x(662)][x(505)]===e[x(472)].subUnitId){const r=new K(t[x(472)][x(662)][x(822)])[x(663)]();if(x0[x(394)](r,e[x(472)][x(604)]))return{error:new Error("move range is conflict with reorder range")}}if(t.params.to[x(505)]===e.params[x(505)]){const r=new K(t[x(472)].to[x(822)])[x(663)]();if(x0[x(394)](r,e[x(472)].range))return{error:new Error(x(436))}}return n}},yu={m1:hx.id,m2:Yx.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t.params[x(675)]!==e[x(472)][x(675)]||t[x(472)][x(662)][x(505)]!==e[x(472)][x(505)]&&t[x(472)].to.subUnitId!==e[x(472)][x(505)])return n;const r=new K(t.params[x(662)][x(822)])[x(663)](),s=new K(t[x(472)].to[x(822)])[x(663)]();if(t[x(472)][x(662)][x(505)]===e[x(472)][x(505)]){const{values:i}=e[x(472)];for(const a in i)if(i[a].ranges[x(503)](o=>x0[x(394)](o,r)))return{error:new Error(x(712))}}if(t.params.to[x(505)]===e[x(472)][x(505)]){const{values:i}=e[x(472)];for(const a in i)if(i[a][x(644)].some(o=>x0[x(394)](o,s)))return{error:new Error(x(712))}}return n}},Ru={m1:Y0.id,m2:xe.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t.params[x(505)]!==e[x(472)].subUnitId)return n;const r={id:ns.id,params:{unitId:t[x(472)][x(675)],subUnitId:t[x(472)][x(505)],fromRange:t[x(472)][x(480)],toRange:t.params.targetRange}},s=Dt(e,r);return{m1Prime:[t,...s],m2Prime:[e,...s]}}},Eu={m1:Y0.id,m2:ye.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e[x(472)][x(505)])return n;const r={id:ns.id,params:{fromRange:t.params[x(480)],toRange:t[x(472)][x(723)]}},s=kn(e,r);return{m1Prime:[t,...s],m2Prime:[e,...s]}}},Su={m1:Y0.id,m2:F0.id,handler(t,e){const x=_,n=eo[x(549)](e,t);return Te(n)?{m1Prime:n.m2Prime,m2Prime:n[x(753)]}:n}},Tu={m1:Y0.id,m2:hx.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t.params[x(675)]!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e[x(472)][x(662)][x(505)]&&t[x(472)].subUnitId!==e[x(472)].to[x(505)])return n;const r=R[x(544)](t),s=R.deepClone(e),i=t[x(472)][x(480)],a=t.params[x(723)];if(t[x(472)][x(505)]===e[x(472)][x(662)].subUnitId){const o=new K(s[x(472)][x(662)][x(822)]),d=o.getDataRange();if(rx({start:i[x(388)],end:i[x(715)]},{start:d[x(388)],end:d.endRow})||rx({start:a[x(388)],end:a[x(715)]},{start:d.startRow,end:d[x(715)]}))return{error:new Error(x(585))};const c=y0({start:i.startRow,end:i[x(715)]},{start:a.startRow,end:a[x(715)]},{start:d[x(388)],end:d.endRow});if(c[x(411)]!==0)return{error:new Error(x(585))};c[x(409)]!==0&&o[x(491)](i.startRow,i[x(715)]-i[x(388)]+1,a[x(388)]),s[x(472)][x(662)].value=o[x(763)]()}if(t[x(472)][x(505)]===e[x(472)].to[x(505)]){const o=new K(s[x(472)].to[x(822)]),d=o[x(663)]();if(rx({start:i.startRow,end:i[x(715)]},{start:d[x(388)],end:d.endRow})||rx({start:a[x(388)],end:a[x(715)]},{start:d[x(388)],end:d.endRow}))return{error:new Error(x(585))};const c=y0({start:i[x(388)],end:i[x(715)]},{start:a[x(388)],end:a[x(715)]},{start:d[x(388)],end:d[x(715)]});if(c[x(411)]!==0)return{error:new Error(x(585))};c.step!==0&&o[x(491)](i[x(388)],i[x(715)]-i.startRow+1,a[x(388)]),s[x(472)].to[x(822)]=o[x(763)]()}return{m1Prime:r,m2Prime:s}}},Mu={m1:Y0.id,m2:Y0.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t.params[x(505)]!==e[x(472)][x(505)])return n;const r=R[x(544)](t),s=R[x(544)](e),i=e.params.sourceRange,a=e[x(472)].targetRange,o=t.params[x(480)],d=t[x(472)][x(723)];if(o[x(715)]>=i[x(388)]&&o.startRow<=i[x(715)])return{error:new Error(x(438))};const c=y0({start:o[x(388)],end:o[x(715)]},{start:d[x(388)],end:d.endRow},{start:i[x(388)],end:i[x(715)]}),l=y0({start:o[x(388)],end:o[x(715)]},{start:d[x(388)],end:d[x(715)]},{start:a[x(388)],end:a[x(715)]});c&&l?(s[x(472)][x(480)].startRow+=c[x(409)],s[x(472)][x(480)][x(715)]+=c[x(409)]+(c[x(411)]||0),s[x(472)].targetRange[x(388)]+=l[x(409)],s[x(472)][x(723)].endRow+=l.step+(l[x(411)]||0)):s.id=h0.id;const u=y0({start:i[x(388)],end:i[x(715)]},{start:a.startRow,end:a[x(715)]},{start:o[x(388)],end:o[x(715)]}),f=y0({start:i[x(388)],end:i[x(715)]},{start:a.startRow,end:a.endRow},{start:d.startRow,end:d[x(715)]});return u&&f?(r.params[x(480)][x(388)]+=u[x(409)],r.params[x(480)].endRow+=u[x(409)]+(u[x(411)]||0),r[x(472)].targetRange[x(388)]+=f[x(409)],r[x(472)][x(723)][x(715)]+=f.step+(f.length||0)):r.id=h0.id,{m1Prime:r,m2Prime:s}}},Nu={m1:Y0.id,m2:gx.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)].unitId||t[x(472)].subUnitId!==e.params[x(505)])return n;const r=R[x(544)](t),s=R.deepClone(e),{sourceRange:i,targetRange:a}=t[x(472)],o={start:i[x(388)],end:i.endRow},d={start:a[x(388)],end:a[x(715)]};return s[x(472)][x(644)][x(503)](c=>{const l=x,u={start:c[l(388)],end:c.endRow},f=rx(o,u),b=rx(d,u);if(f||b)return!0;const h=y0(o,d,u);return h.length!==0?!0:(c.startRow+=h[l(409)],c[l(715)]+=h[l(409)],!1)})?{error:new Error(x(448))}:{m1Prime:r,m2Prime:s}}},Uu={m1:Y0.id,m2:Z0.id,handler(t,e){const x=_,n=R.deepClone(t),r=R[x(544)](e);if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t[x(472)].subUnitId!==e.params[x(505)])return{m1Prime:n,m2Prime:r};const s=r[x(472)][x(644)][x(376)]((i,a)=>{const o=x,{sourceRange:d,targetRange:c}=t[o(472)],l={...a};return d.endRow<l[o(388)]&&c[o(388)]>l[o(715)]?(l.startRow-=d.endRow-d[o(388)]+1,l[o(715)]-=d[o(715)]-d[o(388)]+1,Bx(l)&&i[o(442)](l)):d.startRow>l[o(715)]&&c[o(715)]<l.startRow?(l[o(388)]+=d[o(715)]-d[o(388)]+1,l[o(715)]+=d[o(715)]-d[o(388)]+1,Bx(l)&&i.push(l)):x0[o(394)](l,d)||x0[o(394)](l,c)||i[o(442)](l),i},[]);return r[x(472)][x(644)]=s,r[x(472)].ranges[x(411)]===0&&(r.id=h0.id),{m1Prime:n,m2Prime:r}}},ku={m1:Y0.id,m2:Hx.id,handler(t,e){const x=_;var n;const r={m1Prime:t,m2Prime:e};if(t[x(472)].unitId!==e.params[x(675)]||t[x(472)][x(505)]!==e.params[x(505)])return r;const s=Du(t[x(472)][x(480)],t[x(472)][x(723)]),i=R[x(544)](e),{range:a}=i[x(472)],o=Array[x(662)]({length:a[x(715)]-a[x(388)]+1},(p,I)=>I+a[x(388)]),d={},c={},l=Math[x(485)](t[x(472)][x(480)][x(388)],t[x(472)].targetRange.startRow,...o),u=Math[x(786)](t[x(472)].sourceRange[x(715)],t[x(472)][x(723)][x(715)],...o);for(let p=l;p<=u;p++){const I=p,v=(n=e.params[x(541)][p])!=null?n:I,C=s(v);I!==C&&(d[I]=C),v!==C&&(c[v]=C)}i[x(472)].order=d;const f=Object[x(724)](d)[x(500)](Number);a[x(388)]=Math.min(...f),a[x(715)]=Math[x(786)](...f);const b=[t],h=Object[x(724)](c)[x(500)](Number);return h[x(411)]>0&&b[x(380)]({id:Hx.id,params:{unitId:t[x(472)][x(675)],subUnitId:t[x(472)][x(505)],range:{startColumn:e.params[x(604)][x(616)],endColumn:e[x(472)][x(604)][x(499)],startRow:Math[x(485)](...h),endRow:Math[x(786)](...h)},order:c}}),{m1Prime:b,m2Prime:i}}},Du=(t,e)=>{const x=_,n=t[x(715)]-t.startRow+1,r=t[x(388)],s=e[x(388)];return i=>{const a=x;if(r<=s){const o=e[a(388)]-t[a(715)]-1;if(i>=t[a(388)]&&i<=t.endRow)return i+o;if(i>t[a(715)]&&i<e.startRow)return i-n}if(r>s){const o=t.startRow-e[a(388)];if(i>=e[a(388)]&&i<t[a(388)])return i+n;if(i>=t[a(388)]&&i<=t[a(715)])return i-o}return i}},Ou={m1:Y0.id,m2:Yx.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t.params.subUnitId!==e[x(472)][x(505)])return n;const r=[R[x(544)](t)],s=R[x(544)](e),{sourceRange:i,targetRange:a}=t[x(472)],o={start:i[x(388)],end:i[x(715)]},d={start:a[x(388)],end:a[x(715)]},{values:c}=s[x(472)],l=[];let u=!1;for(const f in c){const b=c[f];if(l[x(442)](...b[x(644)]),b[x(644)][x(503)](h=>{const p=x,I={start:h[p(388)],end:h[p(715)]},v=rx(o,I),C=rx(d,I);if(v||C)return!0;const w=y0(o,d,I);return w[p(411)]!==0?!0:(w[p(409)]!==0&&(u=!0),h[p(388)]+=w[p(409)],h[p(715)]+=w[p(409)],!1)}))return{error:new Error(x(413))}}if(u){const f={id:gx.id,params:{unitId:e[x(472)].unitId,subUnitId:e[x(472)].subUnitId,ranges:l}};r[x(442)](f,s)}return{m1Prime:r,m2Prime:s}}},Fu={m1:Y0.id,m2:H0.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e.params[x(675)]||t.params.subUnitId!==e[x(472)][x(505)])return n;const r=[R[x(544)](t)],s=R[x(544)](e),i=new K(s[x(472)][x(589)]),{sourceRange:a,targetRange:o}=t[x(472)],d=a[x(388)],c=a.endRow-a[x(388)]+1,l=o.startRow;i[x(491)](d,c,l);const u=new K;let f=!1;if(i.forValue((b,h,p)=>{const I=x;if(p&&p.f){const v=p.f;let C=!1;const w=Qe(t[I(472)].unitId,t[I(472)][I(505)],v,y=>{const P=I,E=y0({start:t[P(472)][P(480)].startRow,end:t[P(472)].sourceRange[P(715)]},{start:t[P(472)][P(723)][P(388)],end:t[P(472)][P(723)].endRow},{start:y[P(388)],end:y[P(715)]});return(E[P(409)]!==0||E[P(411)]!==0)&&(C=!0,y[P(388)]+=E[P(409)],y[P(715)]+=E.step+E[P(411)]),y});C&&(f=!0,p.f=w,u[I(645)](b,h,{...p}))}}),f){const b={id:H0.id,params:{unitId:e[x(472)][x(675)],subUnitId:e[x(472)][x(505)],cellValue:u[x(763)]()}};r[x(442)](b)}return s[x(472)][x(589)]=i[x(763)](),{m1Prime:r,m2Prime:s}}},$u={m1:Y0.id,m2:mn.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)].unitId!==e.params.unitId||t[x(472)].subUnitId!==e.params.subUnitId)return n;const r=R.deepClone(t),s=R.deepClone(e),{rowData:i}=s[x(472)],{sourceRange:a,targetRange:o}=t.params;return Sn(a[x(388)],a[x(715)]-a.startRow+1,o.startRow,i),{m1Prime:r,m2Prime:s}}},Au={m1:Y0.id,m2:xs.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t.params[x(675)]!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e[x(472)][x(505)])return n;const r=R[x(544)](t),s=R[x(544)](e),{ranges:i}=s[x(472)],{sourceRange:a,targetRange:o}=t.params,d={start:a.startRow,end:a.endRow},c={start:o[x(388)],end:o[x(715)]};return i[x(503)](l=>{const u=x,f={start:l[u(388)],end:l[u(715)]},b=rx(d,f),h=rx(c,f);if(b||h)return!0;const p=y0(d,c,f);return p[u(411)]!==0?!0:(l[u(388)]+=p[u(409)],l[u(715)]+=p[u(409)],!1)})?{error:new Error("move row is conflict with set row hidden")}:{m1Prime:r,m2Prime:s}}},Vu={m1:Y0.id,m2:es.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e[x(472)][x(505)])return n;const r=R[x(544)](t),s=R[x(544)](e),{ranges:i}=s[x(472)],{sourceRange:a,targetRange:o}=t.params,d={start:a[x(388)],end:a[x(715)]},c={start:o[x(388)],end:o[x(715)]};return i.some(l=>{const u=x,f={start:l[u(388)],end:l[u(715)]},b=rx(d,f),h=rx(c,f);if(b||h)return!0;const p=y0(d,c,f);return p[u(411)]!==0?!0:(l[u(388)]+=p[u(409)],l[u(715)]+=p.step,!1)})?{error:new Error(x(590))}:{m1Prime:r,m2Prime:s}}},ju={m1:Y0.id,m2:Ge.id,handler(t,e){const x=_,n={m1Prime:[],m2Prime:[]};if(t[x(472)][x(675)]!==e.params.unitId||t[x(472)][x(505)]!==e[x(472)][x(505)])return n;const r=R[x(544)](e);let s=!1;return r[x(472)][x(427)][x(384)](i=>{const a=x,{range:o,primary:d}=i,c=y0({start:t.params[a(480)][a(388)],end:t[a(472)][a(480)][a(715)]},{start:t[a(472)][a(723)][a(388)],end:t[a(472)][a(723)][a(715)]},{start:o[a(388)],end:o[a(715)]});if(c[a(411)]||c[a(409)]){if(o[a(388)]+=c.step,o[a(715)]+=c[a(409)]+(c[a(411)]||0),d){const l=y0({start:t[a(472)][a(480)][a(388)],end:t.params[a(480)][a(715)]},{start:t[a(472)][a(723)].startRow,end:t.params[a(723)][a(715)]},{start:d.startRow,end:d[a(715)]});(l[a(411)]||l[a(409)])&&(d[a(388)]+=l[a(409)],d[a(715)]+=l[a(409)],d[a(393)]+=l.step)}s=!0}}),s&&n.m2Prime[x(442)](r),n}},Lu={m1:Y0.id,m2:le.id,handler(t,e){const x=_,n={m1Prime:[t],m2Prime:[e]};if(t.params[x(675)]!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e[x(472)][x(505)])return n;const r=R[x(544)](t),s=R[x(544)](e),i=y0({start:t[x(472)][x(480)][x(388)],end:t.params.sourceRange[x(715)]},{start:t[x(472)][x(723)].startRow,end:t[x(472)][x(723)][x(715)]},{start:e[x(472)][x(604)][x(388)],end:e[x(472)][x(604)][x(715)]});return s[x(472)][x(604)][x(388)]+=i[x(409)],s.params[x(604)].endRow+=i[x(409)]+i[x(411)],{m1Prime:[s,r],m2Prime:[s]}}},Hu={m1:Y0.id,m2:ln.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t.params.unitId!==e.params[x(675)]||t.params.subUnitId!==e.params[x(505)])return n;const r=R[x(544)](t),s=R[x(544)](e),{rowsAutoHeightInfo:i}=s[x(472)],{sourceRange:a,targetRange:o}=t[x(472)],d={start:a[x(388)],end:a[x(715)]},c={start:o.startRow,end:o.endRow};return i[x(503)](l=>{const u=x,f={start:l[u(593)],end:l[u(593)]},b=y0(d,c,f);return b.length!==0?!0:(l[u(593)]+=b[u(409)],!1)})?{error:new Error(x(457))}:{m1Prime:r,m2Prime:s}}},Bu={m1:Y0.id,m2:un.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)].unitId!==e[x(472)][x(675)]||t.params.subUnitId!==e.params.subUnitId)return n;const r=R[x(544)](t),s=R[x(544)](e),{ranges:i,rowHeight:a}=s[x(472)],{sourceRange:o,targetRange:d}=t[x(472)],c={start:o[x(388)],end:o[x(715)]},l={start:d[x(388)],end:d.endRow};return i[x(503)](u=>{const f=x,b={start:u.startRow,end:u[f(715)]},h=y0(c,l,b);return h[f(411)]!==0?!0:(u[f(388)]+=h[f(409)],u[f(715)]+=h[f(409)],!1)})?{error:new Error(x(781))}:(typeof a!="number"&&Sn(o[x(388)],o.endRow-o[x(388)]+1,d.startRow,a),{m1Prime:r,m2Prime:s})}},Gu={m1:Y0.id,m2:fn.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t.params[x(675)]!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e[x(472)][x(505)])return n;const r=R.deepClone(t),s=R[x(544)](e),{ranges:i,autoHeightInfo:a}=s.params,{sourceRange:o,targetRange:d}=t.params,c={start:o[x(388)],end:o[x(715)]},l={start:d[x(388)],end:d[x(715)]};return i[x(503)](u=>{const f=x,b={start:u.startRow,end:u[f(715)]},h=y0(c,l,b);return h.length!==0?!0:(u[f(388)]+=h.step,u[f(715)]+=h[f(409)],!1)})?{error:new Error("move row is conflict with set worksheet row is auto height")}:(typeof a!="number"&&Sn(o[x(388)],o.endRow-o[x(388)]+1,d.startRow,a),{m1Prime:r,m2Prime:s})}},Yu={m1:Y0.id,m2:ce.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)].unitId!==e[x(472)][x(675)]||t[x(472)].subUnitId!==e[x(472)][x(505)])return n;const r={id:ns.id,params:{unitId:t[x(472)].unitId,subUnitId:t.params[x(505)],fromRange:t[x(472)].sourceRange,toRange:t[x(472)][x(723)]}},s=Ot(e,r);return{m1Prime:[t,...s],m2Prime:[e,...s]}}},Wu={m1:Y0.id,m2:dx.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)].unitId!==e.params[x(675)]||e[x(472)][x(505)]!==t.params.subUnitId)return n;const r={id:ns.id,params:{fromRange:t[x(472)][x(480)],toRange:t[x(472)][x(723)]}},s=Ft(e,r);return{m1Prime:[t,...s],m2Prime:[e,...s]}}},Qu={m1:V0.id,m2:xe.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e[x(472)].subUnitId)return n;const r={id:Mn.id,params:{unitId:t.params.unitId,subUnitId:t[x(472)].subUnitId,range:t.params[x(604)]}},s=Dt(e,r);return{m1Prime:[t,...s],m2Prime:[e,...s]}}},zu={m1:V0.id,m2:ye.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)].unitId!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e[x(472)].subUnitId)return n;const r={id:Mn.id,params:{range:t.params[x(604)]}},s=kn(e,r);return{m1Prime:[t,...s],m2Prime:[e,...s]}}},Ju={m1:V0.id,m2:F0.id,handler(t,e){const x=_,n=to.handler(e,t);return Te(n)?{m1Prime:n.m2Prime,m2Prime:n[x(753)]}:n}},Xu={m1:V0.id,m2:q0.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t.params[x(505)]!==e[x(472)][x(505)])return n;const r=R.deepClone(t),s=R[x(544)](e);if(t[x(472)].range.startColumn<=e.params[x(480)].endColumn&&t[x(472)].range.endColumn>=e[x(472)][x(480)][x(616)]||t[x(472)][x(604)][x(616)]<=e[x(472)].targetRange[x(499)]&&t[x(472)].range[x(499)]>=e.params[x(723)].startColumn)return{error:new Error("remove col is conflict with move col")};const i=$0(X(t[x(472)][x(604)]),X(e.params[x(480)])),a=$0(X(t[x(472)][x(604)]),X(e[x(472)][x(723)]));i&&a?(s.params[x(480)][x(616)]+=i[x(409)],s.params[x(480)][x(499)]+=i[x(409)]+(i[x(411)]||0),s[x(472)][x(723)][x(616)]+=a.step,s[x(472)][x(723)][x(499)]+=a[x(409)]+(a[x(411)]||0)):s.id=h0.id;const o=y0({start:e.params[x(480)][x(616)],end:e.params[x(480)][x(499)]},{start:e[x(472)][x(723)][x(616)],end:e.params[x(723)][x(499)]},{start:t[x(472)][x(604)][x(616)],end:t[x(472)][x(604)][x(499)]});if(o){const{step:d,length:c}=o;r[x(472)].range[x(616)]+=d,r.params[x(604)][x(499)]+=d+(c||0)}else r[x(472)][x(604)][x(616)]=0,r[x(472)][x(604)][x(499)]=-1;return{m1Prime:r,m2Prime:s}}},qu={m1:V0.id,m2:hx.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t.params[x(675)]!==e.params[x(675)]||t[x(472)][x(505)]!==e[x(472)].from[x(505)]&&t.params[x(505)]!==e[x(472)].to.subUnitId)return n;const r=R[x(544)](t),s=R[x(544)](e),{startColumn:i,endColumn:a}=t.params[x(604)];if(t[x(472)][x(505)]===e[x(472)][x(662)][x(505)]){const o=new K(s[x(472)][x(662)][x(822)]),d=o[x(663)](),{startColumn:c,endColumn:l}=d;if(c<=a&&l>=i)return{error:new Error(x(776))};a<c&&o[x(533)](i,a-i+1),s.params[x(662)].value=o[x(763)]()}if(t[x(472)].subUnitId===e.params.to.subUnitId){const o=new K(s[x(472)].to.value),d=o[x(663)](),{startColumn:c,endColumn:l}=d;if(c<=a&&l>=i)return{error:new Error(x(776))};a<c&&o[x(533)](i,a-i+1),s[x(472)].to.value=o[x(763)]()}return{m1Prime:r,m2Prime:s}}},Ku={m1:V0.id,m2:V0.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t.params[x(675)]!==e[x(472)][x(675)]||t[x(472)].subUnitId!==e[x(472)][x(505)])return n;const r=R[x(544)](t),s=R[x(544)](e),i=$0(t[x(472)][x(604)],e.params.range);if(i){const{step:o,length:d}=i;s[x(472)][x(604)][x(616)]+=o,s[x(472)][x(604)].endColumn+=o+(d||0)}else s.id=h0.id;const a=$0(e[x(472)][x(604)],t.params[x(604)]);if(a){const{step:o,length:d}=a;r[x(472)][x(604)].startColumn+=o,r.params[x(604)][x(499)]+=o+(d||0)}else r.id=h0.id;return{m1Prime:r,m2Prime:s}}},Zu={m1:V0.id,m2:gx.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t[x(472)].subUnitId!==e[x(472)][x(505)])return n;const r=R[x(544)](t),s=R.deepClone(e),{ranges:i}=s[x(472)];return i[x(503)](a=>{const o=x,d=$0(X(t[o(472)][o(604)]),X(a));return d===null||d[o(411)]!==0?!0:(a[o(616)]+=d[o(409)],a.endColumn+=d[o(409)],!1)})?{error:new Error(x(719))}:{m1Prime:r,m2Prime:s}}},xf={m1:V0.id,m2:Z0.id,handler(t,e){const x=_,n=R[x(544)](t),r=R.deepClone(e);if(t.params[x(675)]!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e[x(472)][x(505)])return{m1Prime:n,m2Prime:r};const s=r[x(472)][x(644)][x(376)]((i,a)=>{const o=x,d=n[o(472)].range,c=d[o(499)]-d[o(616)]+1;let l={...a};return d[o(616)]>a[o(499)]?l={...a}:d[o(616)]>=a[o(616)]&&d[o(616)]<=a[o(499)]&&d.endColumn>a.endColumn?(l[o(499)]=d[o(616)]-1,d[o(616)]===a[o(616)]&&(l=null)):d[o(616)]>a[o(616)]&&d.endColumn<a[o(499)]?l[o(499)]=a[o(499)]-c:d[o(616)]<a[o(616)]&&d.endColumn>=a[o(616)]&&d.endColumn<=a[o(499)]?(l[o(616)]=d.startColumn,l[o(499)]=a[o(499)]-c,d[o(499)]===a[o(499)]&&(l=null)):d[o(616)]<=a[o(616)]&&d[o(499)]>=a[o(499)]?l=null:d[o(499)]<a[o(616)]&&(l.startColumn=a[o(616)]-c,l[o(499)]=a.endColumn-c),l&&!(l[o(388)]===l[o(715)]&&l.startColumn===l[o(499)])&&i[o(442)](l),i},[]);return r[x(472)].ranges=s,{m1Prime:n,m2Prime:r}}},ef={m1:V0.id,m2:Hx.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)].unitId!==e.params.unitId||t[x(472)].subUnitId!==e[x(472)].subUnitId)return n;const r=$0(X(t[x(472)][x(604)]),X(e[x(472)][x(604)]));if(!r)return{m1Prime:t,m2Prime:[]};const s=R[x(544)](e);return s[x(472)][x(604)][x(616)]+=r[x(409)],s[x(472)][x(604)][x(499)]+=r[x(409)]+(r[x(411)]||0),{m1Prime:t,m2Prime:s}}},tf={m1:V0.id,m2:cn.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t.params[x(675)]!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e[x(472)].subUnitId)return n;const r=R[x(544)](t),s=R[x(544)](e),{columnData:i}=s[x(472)];return Tn(t.params[x(604)][x(616)],t[x(472)].range[x(499)]-t[x(472)][x(604)][x(616)]+1,i),{m1Prime:r,m2Prime:s}}},nf={m1:V0.id,m2:K2.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)].unitId!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e.params[x(505)])return n;const r=R[x(544)](t),s=R.deepClone(e),{ranges:i}=s.params;return i[x(384)](a=>{const o=x,d=$0(X(t.params.range),a);d==null?s.id=h0.id:(a[o(616)]+=d[o(409)],a[o(499)]+=d[o(409)]+d[o(411)])}),{m1Prime:r,m2Prime:s}}},sf={m1:V0.id,m2:Z2.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e[x(472)].subUnitId)return n;const r=R[x(544)](t),s=R[x(544)](e),{ranges:i}=s[x(472)];return i.forEach(a=>{const o=x,d=$0(X(t[o(472)].range),a);d==null?s.id=h0.id:(a[o(616)]+=d[o(409)],a[o(499)]+=d.step+d[o(411)])}),{m1Prime:r,m2Prime:s}}},rf={m1:V0.id,m2:Yx.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)].unitId||t[x(472)][x(505)]!==e[x(472)].subUnitId)return n;const r=[R[x(544)](t)],s=R[x(544)](e),{values:i}=s[x(472)],a=[];let o=!1;for(const d in i){const c=i[d];if(a[x(442)](...c.ranges),c[x(644)].some(l=>{const u=x,f=$0(X(t[u(472)].range),X(l));return f==null||f.length!==0?!0:(f[u(409)]!==0&&(o=!0),l.startColumn+=f.step,l.endColumn+=f.step,!1)}))return{error:new Error(x(494))}}if(o){const d={id:gx.id,params:{unitId:e[x(472)][x(675)],subUnitId:e[x(472)].subUnitId,ranges:a}};r.push(d,s)}return{m1Prime:r,m2Prime:s}}},af={m1:V0.id,m2:H0.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e.params[x(675)]||t.params.subUnitId!==e.params[x(505)])return n;const r=[R.deepClone(t)],s=R[x(544)](e),i=new K(s[x(472)][x(589)]),a=i[x(663)](),o=t[x(472)][x(604)],d=o[x(499)]-o[x(616)]+1;if(s[x(472)][x(589)]&&o.endColumn<a.startColumn)Pt(s[x(472)].cellValue,a.startColumn,a[x(499)]-a[x(616)]+1,-d);else if(o.startColumn<=a[x(499)])return{error:new Error("remove cols is conflict with set range values mutation")};const c=new K;let l=!1,u=!1;if(i[x(698)]((f,b,h)=>{const p=x;if(h&&h.f){const I=h.f;let v=!1;const C=Qe(t[p(472)].unitId,t[p(472)].subUnitId,I,w=>{const y=p,P=$0(X(t.params[y(604)]),X(w));return P===null?(l=!0,w):((P[y(409)]!==0||P.length!==0)&&(v=!0,w[y(616)]+=P.step,w[y(499)]+=P[y(409)]+P[y(411)]),w)});v&&(u=!0,h.f=C,c.setValue(f,b,{...h}))}}),l)return{error:new Error(x(351))};if(u){const f={id:H0.id,params:{unitId:e[x(472)][x(675)],subUnitId:e[x(472)].subUnitId,cellValue:c[x(763)]()}};r[x(442)](f)}return{m1Prime:r,m2Prime:s}}},of={m1:V0.id,m2:Ge.id,handler(t,e){const x=_,n={m1Prime:[],m2Prime:[]};if(t[x(472)].unitId!==e.params[x(675)]||t.params[x(505)]!==e[x(472)].subUnitId)return n;const r=R[x(544)](e);let s=!1;return r[x(472)][x(427)][x(384)](i=>{const a=x,{range:o,primary:d}=i,c=$0(X(t.params[a(604)]),X(o));if(c!=null&&(c[a(411)]||c.step)){if(o.startColumn+=c[a(409)],o[a(499)]+=c.step+(c[a(411)]||0),d){const l=$0(X(t[a(472)][a(604)]),X(d));if(l==null){d[a(616)]=o.startColumn,d[a(499)]=o[a(616)],d[a(428)]=o.startColumn;return}(l.length||l.step)&&(d[a(616)]+=l[a(409)],d[a(499)]+=l[a(409)],d.actualColumn+=l[a(409)])}s=!0}}),s&&n[x(633)][x(442)](r),n}},df={m1:V0.id,m2:Le.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)].unitId||t[x(472)].subUnitId!==e[x(472)][x(505)])return n;const r=R[x(544)](t),s=R[x(544)](e),i=Vr({start:t[x(472)][x(604)][x(616)],end:t[x(472)][x(604)][x(499)]},{start:e[x(472)][x(758)],end:e[x(472)].col}),a=R[x(544)](e);return a.params[x(688)]=null,i===null?{m1Prime:[r,a],m2Prime:[]}:s[x(472)][x(758)]===i.start?n:(s[x(472)][x(758)]=i.start,s[x(472)].criteria&&(s.params[x(688)].colId=i[x(374)]),{m1Prime:[a,s,r],m2Prime:[s]})}},cf={m1:V0.id,m2:le.id,handler(t,e){const x=_,n={m1Prime:[t],m2Prime:[e]};if(t[x(472)][x(675)]!==e.params[x(675)]||t[x(472)].subUnitId!==e[x(472)][x(505)])return n;const r=R[x(544)](t),s=R[x(544)](e),i=Vr({start:t[x(472)][x(604)][x(616)],end:t.params[x(604)][x(499)]},{start:e[x(472)][x(604)][x(616)],end:e[x(472)][x(604)][x(499)]});return i===null?{m1Prime:[r,{id:We.id,params:{unitId:e[x(472)][x(675)],subUnitId:e[x(472)][x(675)]}}],m2Prime:[]}:(s[x(472)].range.startColumn=i[x(374)],s[x(472)][x(604)][x(499)]=i.end,{m1Prime:[s,r],m2Prime:[s]})}},lf={m1:V0.id,m2:de.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e[x(472)][x(505)])return n;const r=R[x(544)](t),s=R[x(544)](e),{ranges:i,colWidth:a}=s[x(472)];return i[x(384)](o=>{const d=x,c=$0(X(t[d(472)][d(604)]),o);c==null?s.id=h0.id:(o[d(616)]+=c[d(409)],o.endColumn+=c[d(409)]+c[d(411)])}),typeof a!=x(602)&&Tn(t.params.range[x(616)],t[x(472)][x(604)].endColumn-t[x(472)].range.startColumn+1,a),{m1Prime:r,m2Prime:s}}},uf={m1:V0.id,m2:ce.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)].unitId!==e.params[x(675)]||t.params[x(505)]!==e.params[x(505)])return n;const r={id:Mn.id,params:{unitId:t[x(472)][x(675)],subUnitId:t[x(472)][x(505)],range:t[x(472)][x(604)]}},s=Ot(e,r);return{m1Prime:[t,...s],m2Prime:[e,...s]}}},ff={m1:V0.id,m2:dx.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e.params[x(675)]||e[x(472)][x(505)]!==t[x(472)][x(505)])return n;const r={id:Mn.id,params:{range:t[x(472)][x(604)]}},s=Ft(e,r);return{m1Prime:[t,...s],m2Prime:[e,...s]}}},mf={m1:ie.id,m2:ie.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};return t.params[x(675)]===e[x(472)][x(675)]&&t.params[x(505)]===e.params.subUnitId&&t.params[x(445)]===e[x(472)][x(445)]?{m1Prime:[],m2Prime:[]}:n}},bf={m1:hi.id,m2:hi.id,handler:(t,e)=>{const x=_,n=t[x(472)],r=e[x(472)];return n[x(675)]===r[x(675)]&&n[x(505)]===r.subUnitId&&n.id===r.id?{m2Prime:[],m1Prime:[]}:{m1Prime:t,m2Prime:e}}},hf={m1:gx.id,m2:gx.id,handler(t,e){const x=_;if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t.params[x(505)]!==e.params.subUnitId)return{m1Prime:t,m2Prime:e};const n=R[x(544)](t),r=R[x(544)](e),s=[],i=r[x(472)].ranges;return n.params[x(644)][x(384)](a=>{const o=x,d=ls(a,i);d[o(411)]>0&&s.push(...d)}),n[x(472)][x(644)]=s,{m1Prime:t,m2Prime:e}}},pf={m1:gx.id,m2:Yx.id,handler(t,e){const x=_;if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e.params[x(505)])return{m1Prime:t,m2Prime:e};const n=R.deepClone(t),r=R[x(544)](e),s=[],i=Object[x(609)](r.params.values)[x(500)](a=>a[x(644)])[x(456)]();return n[x(472)][x(644)][x(384)](a=>{const o=x,d=ls(a,i);d[o(411)]>0&&s[o(442)](...d)}),n[x(472)][x(644)]=s,{m1Prime:n,m2Prime:r}}},_f={m1:j0.id,m2:xe.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)].unitId!==e[x(472)][x(675)]||t.params.subUnitId!==e.params[x(505)])return n;const r={id:Nn.id,params:{unitId:t[x(472)].unitId,subUnitId:t[x(472)].subUnitId,range:t[x(472)][x(604)]}},s=Dt(e,r);return{m1Prime:[t,...s],m2Prime:[e,...s]}}},If={m1:j0.id,m2:ye.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e[x(472)][x(505)])return n;const r={id:Nn.id,params:{range:t[x(472)][x(604)]}},s=kn(e,r);return{m1Prime:[t,...s],m2Prime:[e,...s]}}},gf={m1:j0.id,m2:F0.id,handler(t,e){const x=_,n=no[x(549)](e,t);return Te(n)?{m1Prime:n[x(633)],m2Prime:n[x(753)]}:n}},vf={m1:j0.id,m2:hx.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t.params[x(505)]!==e[x(472)][x(662)][x(505)]&&t.params[x(505)]!==e.params.to[x(505)])return n;const r=R[x(544)](t),s=R[x(544)](e),{startRow:i,endRow:a}=t.params[x(604)];if(t.params.subUnitId===e[x(472)][x(662)][x(505)]){const o=new K(s[x(472)][x(662)][x(822)]),d=o.getDataRange(),{startRow:c,endRow:l}=d;if(c<=a&&l>=i)return{error:new Error("Remove-cols has conflicts with move-range")};a<c&&o[x(650)](i,a-i+1),s[x(472)][x(662)][x(822)]=o[x(763)]()}if(t[x(472)][x(505)]===e[x(472)].to[x(505)]){const o=new K(s[x(472)].to[x(822)]),d=o.getDataRange(),{startRow:c,endRow:l}=d;if(c<=a&&l>=i)return{error:new Error(x(776))};a<c&&o[x(650)](i,a-i+1),s[x(472)].to[x(822)]=o[x(763)]()}return{m1Prime:r,m2Prime:s}}},Cf={m1:j0.id,m2:Y0.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t.params.unitId!==e.params[x(675)]||t[x(472)][x(505)]!==e.params[x(505)])return n;const r=R[x(544)](t),s=R.deepClone(e);if(t.params[x(604)][x(388)]<=e[x(472)][x(480)][x(715)]&&t[x(472)].range.endRow>=e.params[x(480)][x(388)]||t[x(472)].range[x(388)]<=e[x(472)].targetRange[x(715)]&&t[x(472)][x(604)][x(715)]>=e[x(472)][x(723)][x(388)])return{error:new Error(x(664))};const i=$0(X(s0(t[x(472)][x(604)])),X(s0(e[x(472)][x(480)]))),a=$0(X(s0(t[x(472)].range)),X(s0(e[x(472)].targetRange)));i&&a?(s.params[x(480)].startRow+=i[x(409)],s[x(472)][x(480)].endRow+=i[x(409)]+(i[x(411)]||0),s[x(472)][x(723)][x(388)]+=a[x(409)],s.params[x(723)][x(715)]+=a[x(409)]+(a[x(411)]||0)):s.id=h0.id;const o=y0({start:e[x(472)][x(480)][x(388)],end:e[x(472)][x(480)][x(715)]},{start:e[x(472)].targetRange[x(388)],end:e[x(472)][x(723)][x(715)]},{start:t[x(472)][x(604)][x(388)],end:t.params[x(604)][x(715)]});if(o){const{step:d,length:c}=o;r[x(472)][x(604)][x(388)]+=d,r.params[x(604)][x(715)]+=d+(c||0)}else r.id=h0.id;return{m1Prime:r,m2Prime:s}}},wf={m1:j0.id,m2:gx.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t.params[x(675)]!==e[x(472)].unitId||t[x(472)].subUnitId!==e[x(472)][x(505)])return n;const r=R.deepClone(t),s=R[x(544)](e),{ranges:i}=s.params;return i[x(503)](a=>{const o=x,d=$0(X(s0(t[o(472)][o(604)])),X(s0(a)));return d===null||d[o(411)]!==0?!0:(a[o(388)]+=d.step,a.endRow+=d[o(409)],!1)})?{error:new Error("remove row is conflict with remove numfmt")}:{m1Prime:r,m2Prime:s}}},Pf={m1:j0.id,m2:j0.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t.params[x(675)]!==e[x(472)].unitId||t[x(472)][x(505)]!==e[x(472)][x(505)])return n;const r=R[x(544)](t),s=R[x(544)](e),i=$0(X(s0(t[x(472)][x(604)])),X(s0(e[x(472)][x(604)])));if(i){const{step:o,length:d}=i;s[x(472)][x(604)].startRow+=o,s[x(472)].range[x(715)]+=o+(d||0)}else s.id=h0.id;const a=$0(X(s0(e[x(472)][x(604)])),X(s0(t[x(472)][x(604)])));if(a){const{step:o,length:d}=a;r.params[x(604)][x(388)]+=o,r.params.range.endRow+=o+(d||0)}else r.id=h0.id;return{m1Prime:r,m2Prime:s}}},yf={m1:j0.id,m2:Z0.id,handler(t,e){const x=_,n=R[x(544)](t),r=R.deepClone(e);if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t.params.subUnitId!==e[x(472)][x(505)])return{m1Prime:n,m2Prime:r};const s=r[x(472)][x(644)][x(376)]((i,a)=>{const o=x,d=n[o(472)].range,c=d[o(715)]-d[o(388)]+1;let l={...a};return d[o(388)]>a[o(715)]?l={...a}:d.startRow>=a.startRow&&d[o(388)]<=a.endRow&&d[o(715)]>a.endRow?(l[o(715)]=d[o(388)]-1,d.startRow===a[o(388)]&&(l=null)):d[o(388)]>a.startRow&&d[o(715)]<a[o(715)]?l.endRow=a[o(715)]-c:d[o(388)]<a[o(388)]&&d[o(715)]>=a[o(388)]&&d[o(715)]<=a[o(715)]?(l[o(388)]=d[o(388)],l[o(715)]=a[o(715)]-c,d[o(715)]===a[o(715)]&&(l=null)):d.startRow<=a[o(388)]&&d[o(715)]>=a[o(715)]?l=null:d[o(715)]<a[o(388)]&&(l[o(388)]=a[o(388)]-c,l.endRow=a[o(715)]-c),l&&!(l[o(388)]===l[o(715)]&&l.startColumn===l[o(499)])&&i[o(442)](l),i},[]);return r[x(472)].ranges=s,{m1Prime:n,m2Prime:r}}},Rf={m1:j0.id,m2:Hx.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)].unitId!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e[x(472)][x(505)])return n;const r=R[x(544)](e),s=R[x(544)](t),i=$0(X(s0(t[x(472)][x(604)])),X(s0(e.params[x(604)])));if(!i)return{m1Prime:t,m2Prime:[]};if(i[x(411)]===0&&i[x(409)]===0)return{m1Prime:t,m2Prime:e};const{startRow:a,endRow:o}=t[x(472)][x(604)];r[x(472)][x(604)].startRow+=i[x(409)],r[x(472)][x(604)][x(715)]+=i[x(409)]+(i.length||0);const d=Object[x(724)](e[x(472)][x(541)])[x(500)](f=>Li(a,o,Number(f)))[x(674)](f=>f!==null),c={};for(const f in e.params.order){let b=e.params[x(541)][f];b=Li(a,o,b),b!==null&&(c[d.shift()]=b)}r[x(472)][x(541)]=c;const l=Ef(e[x(472)].order,{start:t[x(472)][x(604)][x(388)],end:t[x(472)][x(604)][x(715)]}),u=[s];return l&&u[x(380)]({id:Hx.id,params:{...t.params,order:l.order,range:{...e[x(472)][x(604)],...l[x(604)]}}}),{m1Prime:u,m2Prime:r}}},Ef=(t,e)=>{const x=_,n=Object[x(724)](t)[x(500)](Number).sort((u,f)=>u-f);if(n[x(411)]===0)return null;const r=n[0],s=n[n[x(411)]-1];if(r>e[x(787)]||s<e[x(374)])return null;const i=n.filter(u=>t[u]>=e[x(374)]&&t[u]<=e[x(787)]);if(i.length===0)return null;const a=i[x(500)](u=>t[u]),o={},d=Math[x(485)](i[0],e[x(374)]),c=Math.max(i[i[x(411)]-1],e.end),l=Array[x(662)]({length:c-d+1},(u,f)=>f+d)[x(674)](u=>!i[x(693)](u));return Array[x(662)]({length:c-d+1},(u,f)=>f+d).filter(u=>!a[x(693)](u))[x(384)]((u,f)=>{o[u]=l[f]}),a[x(384)]((u,f)=>{o[u]=i[f]}),{range:{startRow:d,endRow:c},order:o}},Li=(t,e,x)=>x>=t&&x<=e?null:x>e?x-(e-t+1):x,Sf={m1:j0.id,m2:Yx.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)].unitId!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e.params[x(505)])return n;const r=[R[x(544)](t)],s=R[x(544)](e),{values:i}=s[x(472)],a=[];let o=!1;for(const d in i){const c=i[d];if(a[x(442)](...c.ranges),c[x(644)][x(503)](l=>{const u=x,f=$0(X(s0(t[u(472)].range)),X(s0(l)));return f==null||f[u(411)]!==0?!0:(f.step!==0&&(o=!0),l[u(388)]+=f.step,l[u(715)]+=f.step,!1)}))return{error:new Error(x(582))}}if(o){const d={id:gx.id,params:{unitId:e[x(472)][x(675)],subUnitId:e[x(472)][x(505)],ranges:a}};r[x(442)](d,s)}return{m1Prime:r,m2Prime:s}}},Tf={m1:j0.id,m2:H0.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e.params[x(675)]||t[x(472)][x(505)]!==e[x(472)][x(505)])return n;const r=[R.deepClone(t)],s=R[x(544)](e),i=new K(s[x(472)][x(589)]),a=i.getDataRange(),o=t[x(472)][x(604)],d=o[x(715)]-o.startRow+1;if(s.params[x(589)]&&o[x(715)]<a.startRow)wt(s[x(472)][x(589)],a[x(388)],a[x(715)]-a[x(388)]+1,-d);else if(o[x(388)]<=a[x(715)])return{error:new Error("remove rows is conflict with set range values mutation")};const c=new K;let l=!1,u=!1;if(i[x(698)]((f,b,h)=>{const p=x;if(h&&h.f){const I=h.f;let v=!1;const C=Qe(t.params[p(675)],t[p(472)][p(505)],I,w=>{const y=p,P=$0(X(s0(t[y(472)].range)),X(s0(w)));return P===null?(l=!0,w):((P[y(409)]!==0||P[y(411)]!==0)&&(v=!0,w.startRow+=P[y(409)],w.endRow+=P[y(409)]+P[y(411)]),w)});v&&(u=!0,h.f=C,c[p(645)](f,b,{...h}))}}),l)return{error:new Error(x(365))};if(u){const f={id:H0.id,params:{unitId:e[x(472)][x(675)],subUnitId:e.params[x(505)],cellValue:c[x(763)]()}};r[x(442)](f)}return{m1Prime:r,m2Prime:s}}},Mf={m1:j0.id,m2:mn.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t.params[x(675)]!==e[x(472)].unitId||t[x(472)][x(505)]!==e[x(472)].subUnitId)return n;const r=R[x(544)](t),s=R[x(544)](e),{rowData:i}=s[x(472)];return Tn(t[x(472)].range[x(388)],t[x(472)][x(604)][x(715)]-t[x(472)][x(604)][x(388)]+1,i),{m1Prime:r,m2Prime:s}}},Nf={m1:j0.id,m2:xs.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t.params[x(675)]!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e[x(472)][x(505)])return n;const r=R[x(544)](t),s=R[x(544)](e),{ranges:i}=s.params;return i[x(384)](a=>{const o=x,d=$0(X(s0(t[o(472)][o(604)])),X(s0(a)));d==null?s.id=h0.id:(a[o(388)]+=d[o(409)],a.endRow+=d.step+d.length)}),{m1Prime:r,m2Prime:s}}},Uf={m1:j0.id,m2:es.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e.params[x(675)]||t[x(472)][x(505)]!==e[x(472)].subUnitId)return n;const r=R.deepClone(t),s=R[x(544)](e),{ranges:i}=s[x(472)];return i.forEach(a=>{const o=x,d=$0(X(s0(t.params[o(604)])),X(s0(a)));d==null?s.id=h0.id:(a[o(388)]+=d[o(409)],a[o(715)]+=d[o(409)]+d[o(411)])}),{m1Prime:r,m2Prime:s}}},kf={m1:j0.id,m2:Ge.id,handler(t,e){const x=_,n={m1Prime:[],m2Prime:[]};if(t[x(472)].unitId!==e[x(472)].unitId||t[x(472)][x(505)]!==e[x(472)][x(505)])return n;const r=R[x(544)](e);let s=!1;return r[x(472)][x(427)].forEach(i=>{const a=x,{range:o,primary:d}=i,c=$0(X(s0(t[a(472)][a(604)])),X(s0(o)));if(c!=null&&(c.length||c.step)){if(o[a(388)]+=c.step,o[a(715)]+=c[a(409)]+(c[a(411)]||0),d){const l=$0(X(s0(t[a(472)][a(604)])),X(s0(d)));if(l==null){d[a(388)]=o[a(388)],d[a(715)]=o[a(388)],d[a(393)]=o[a(388)];return}(l[a(411)]||l[a(409)])&&(d[a(388)]+=l[a(409)],d[a(715)]+=l.step,d[a(393)]+=l[a(409)])}s=!0}}),s&&n[x(633)].push(r),n}},Df={m1:j0.id,m2:le.id,handler(t,e){const x=_,n={m1Prime:[t],m2Prime:[e]};if(t[x(472)][x(675)]!==e.params[x(675)]||t[x(472)][x(505)]!==e[x(472)].subUnitId)return n;const r=R[x(544)](t),s=R[x(544)](e),i=Vr({start:t[x(472)][x(604)][x(388)],end:t[x(472)][x(604)].endRow},{start:e.params.range[x(388)],end:e[x(472)][x(604)].endRow});return i===null?{m1Prime:[r,{id:We.id,params:{unitId:e[x(472)].unitId,subUnitId:e.params[x(675)]}}],m2Prime:[]}:(s[x(472)][x(604)].startRow=i[x(374)],s.params[x(604)][x(715)]=i.end,{m1Prime:[s,r],m2Prime:[s]})}},Of={m1:j0.id,m2:ln.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t.params[x(675)]!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e[x(472)][x(505)])return n;const r=R.deepClone(t),s=R.deepClone(e),{rowsAutoHeightInfo:i}=s[x(472)];for(let a=i[x(411)]-1;a>=0;a--){const o=i[a],d={startRow:o[x(593)],endRow:o[x(593)],startColumn:0,endColumn:0},c=$0(X(s0(t.params.range)),s0(d));c==null?i.splice(a,1):o[x(593)]+=c[x(409)]}return{m1Prime:r,m2Prime:s}}},Ff={m1:j0.id,m2:un.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)].unitId!==e.params.unitId||t[x(472)][x(505)]!==e[x(472)][x(505)])return n;const r=R.deepClone(t),s=R[x(544)](e),{ranges:i,rowHeight:a}=s.params;return i[x(384)](o=>{const d=x,c=$0(X(s0(t[d(472)][d(604)])),s0(o));c==null?s.id=h0.id:(o[d(388)]+=c.step,o[d(715)]+=c[d(409)]+c[d(411)])}),typeof a!=x(602)&&Tn(t.params.range[x(388)],t[x(472)][x(604)][x(715)]-t.params.range[x(388)]+1,a),{m1Prime:r,m2Prime:s}}},$f={m1:j0.id,m2:fn.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e.params[x(675)]||t[x(472)][x(505)]!==e[x(472)][x(505)])return n;const r=R[x(544)](t),s=R[x(544)](e),{ranges:i,autoHeightInfo:a}=s[x(472)];return i[x(384)](o=>{const d=x,c=$0(X(s0(t.params.range)),s0(o));c==null?s.id=h0.id:(o[d(388)]+=c.step,o[d(715)]+=c[d(409)]+c.length)}),typeof a!=x(602)&&Tn(t[x(472)][x(604)].startRow,t[x(472)].range[x(715)]-t[x(472)][x(604)][x(388)]+1,a),{m1Prime:r,m2Prime:s}}},Af={m1:j0.id,m2:ce.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)].unitId||t[x(472)][x(505)]!==e[x(472)].subUnitId)return n;const r={id:Nn.id,params:{unitId:t[x(472)][x(675)],subUnitId:t.params.subUnitId,range:t[x(472)][x(604)]}},s=Ot(e,r);return{m1Prime:[t,...s],m2Prime:[e,...s]}}},Vf={m1:j0.id,m2:dx.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)].unitId!==e[x(472)][x(675)]||e[x(472)][x(505)]!==t[x(472)].subUnitId)return n;const r={id:Nn.id,params:{range:t[x(472)][x(604)]}},s=Ft(e,r);return{m1Prime:[t,...s],m2Prime:[e,...s]}}},jf={m1:Z0.id,m2:F0.id,handler(t,e){const x=_,n=R[x(544)](t),r=R[x(544)](e);if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t.params[x(505)]!==e.params[x(505)])return{m1Prime:n,m2Prime:r};for(let s=0;s<n.params[x(644)][x(411)];s++){let i=!1;for(let a=0;a<r[x(472)][x(644)][x(411)];a++){const o=n[x(472)][x(644)][s],d=r[x(472)][x(644)][a];if(x0[x(394)](o,d)){i=!0;break}}i&&(n[x(472)][x(644)][x(519)](s,1),s--)}return n[x(472)][x(644)][x(411)]===0&&(n.id=h0.id),{m1Prime:n,m2Prime:r}}},Lf={m1:Z0.id,m2:B0.id,handler(t,e){const x=_,n=R[x(544)](t),r=R[x(544)](e);if(t.params[x(675)]!==e.params[x(675)]||t.params.subUnitId!==e[x(472)][x(505)])return{m1Prime:n,m2Prime:r};const s=n[x(472)][x(644)].map(i=>{const a=x,o=r[a(472)][a(604)],d=o[a(499)]-o[a(616)]+1;return o[a(616)]<=i[a(616)]?{...i,startColumn:i[a(616)]+d,endColumn:i.endColumn+d}:o.startColumn>i[a(616)]&&o[a(616)]<=i.endColumn?{...i,endColumn:i[a(499)]+d}:{...i}});return n[x(472)][x(644)]=s,{m1Prime:n,m2Prime:r}}},Hf={m1:Z0.id,m2:G0.id,handler(t,e){const x=_,n=R[x(544)](t),r=R[x(544)](e);if(t.params[x(675)]!==e.params[x(675)]||t.params[x(505)]!==e[x(472)][x(505)])return{m1Prime:n,m2Prime:r};const s=n[x(472)].ranges[x(500)](i=>{const a=x,o=r[a(472)][a(604)],d=o[a(715)]-o[a(388)]+1;return o.startRow<=i.startRow?{...i,startRow:i[a(388)]+d,endRow:i[a(715)]+d}:o[a(388)]>i[a(388)]&&o[a(388)]<=i.endRow?{...i,endRow:i[a(715)]+d}:{...i}});return n.params[x(644)]=s,{m1Prime:n,m2Prime:r}}},Bf={m1:Z0.id,m2:q0.id,handler(t,e){const x=_,n=R[x(544)](t),r=R[x(544)](e);if(t.params[x(675)]!==e.params[x(675)]||t[x(472)][x(505)]!==e[x(472)].subUnitId)return{m1Prime:n,m2Prime:r};const s=n[x(472)][x(644)][x(376)]((i,a)=>{const o=x,{sourceRange:d,targetRange:c}=e[o(472)],l={...a};return d[o(499)]<l[o(616)]&&c[o(616)]>l[o(499)]?(l.startColumn-=d[o(499)]-d[o(616)]+1,l[o(499)]-=d[o(499)]-d[o(616)]+1,Bx(l)&&i[o(442)](l)):d[o(616)]>l.endColumn&&c.endColumn<l[o(616)]?(l.startColumn+=d[o(499)]-d[o(616)]+1,l[o(499)]+=d[o(499)]-d[o(616)]+1,Bx(l)&&i[o(442)](l)):x0[o(394)](l,d)||x0[o(394)](l,c)||i.push(l),i},[]);return n.params[x(644)]=s,n[x(472)][x(644)][x(411)]===0&&(n.id=h0.id),{m1Prime:n,m2Prime:r}}},Gf={m1:Z0.id,m2:Y0.id,handler(t,e){const x=_,n=R[x(544)](t),r=R.deepClone(e);if(t[x(472)].unitId!==e[x(472)][x(675)]||t[x(472)].subUnitId!==e[x(472)][x(505)])return{m1Prime:n,m2Prime:r};const s=n[x(472)][x(644)][x(376)]((i,a)=>{const o=x,{sourceRange:d,targetRange:c}=e[o(472)],l={...a};return d[o(715)]<l.startRow&&c[o(388)]>l[o(715)]?(l[o(388)]-=d[o(715)]-d[o(388)]+1,l[o(715)]-=d[o(715)]-d[o(388)]+1,Bx(l)&&i[o(442)](l)):d.startRow>l[o(715)]&&c[o(715)]<l[o(388)]?(l[o(388)]+=d.endRow-d[o(388)]+1,l[o(715)]+=d[o(715)]-d[o(388)]+1,Bx(l)&&i.push(l)):x0[o(394)](l,d)||x0[o(394)](l,c)||i[o(442)](l),i},[]);return n[x(472)][x(644)]=s,n.params.ranges[x(411)]===0&&(n.id=h0.id),{m1Prime:n,m2Prime:r}}},Yf={m1:Z0.id,m2:V0.id,handler(t,e){const x=_,n=R[x(544)](t),r=R.deepClone(e);if(t[x(472)][x(675)]!==e[x(472)].unitId||t.params[x(505)]!==e[x(472)][x(505)])return{m1Prime:n,m2Prime:r};const s=n[x(472)][x(644)][x(376)]((i,a)=>{const o=x,d=r[o(472)][o(604)],c=d[o(499)]-d[o(616)]+1;let l={...a};return d[o(616)]>a.endColumn?l={...a}:d[o(616)]>=a[o(616)]&&d[o(616)]<=a.endColumn&&d[o(499)]>a[o(499)]?(l[o(499)]=d.startColumn-1,d[o(616)]===a[o(616)]&&(l=null)):d[o(616)]>a.startColumn&&d[o(499)]<a[o(499)]?l[o(499)]=a[o(499)]-c:d[o(616)]<a.startColumn&&d[o(499)]>=a.startColumn&&d[o(499)]<=a[o(499)]?(l[o(616)]=d.startColumn,l[o(499)]=a[o(499)]-c,d.endColumn===a[o(499)]&&(l=null)):d.startColumn<=a.startColumn&&d.endColumn>=a[o(499)]?l=null:d.endColumn<a[o(616)]&&(l[o(616)]=a[o(616)]-c,l[o(499)]=a[o(499)]-c),l&&!(l[o(388)]===l[o(715)]&&l.startColumn===l[o(499)])&&i.push(l),i},[]);return n[x(472)].ranges=s,n[x(472)][x(644)][x(411)]===0&&(n.id=h0.id),{m1Prime:n,m2Prime:r}}},Wf={m1:Z0.id,m2:j0.id,handler(t,e){const x=_,n=R[x(544)](t),r=R[x(544)](e);if(t[x(472)][x(675)]!==e.params[x(675)]||t[x(472)].subUnitId!==e[x(472)].subUnitId)return{m1Prime:n,m2Prime:r};const s=n[x(472)][x(644)][x(376)]((i,a)=>{const o=x,d=r[o(472)][o(604)],c=d[o(715)]-d[o(388)]+1;let l={...a};return d[o(388)]>a[o(715)]?l={...a}:d[o(388)]>=a[o(388)]&&d[o(388)]<=a[o(715)]&&d.endRow>a.endRow?(l[o(715)]=d.startRow-1,d[o(388)]===a[o(388)]&&(l=null)):d.startRow>a.startRow&&d[o(715)]<a[o(715)]?l[o(715)]=a[o(715)]-c:d.startRow<a.startRow&&d.endRow>=a[o(388)]&&d[o(715)]<=a.endRow?(l.startRow=d[o(388)],l[o(715)]=a[o(715)]-c,d[o(715)]===a[o(715)]&&(l=null)):d[o(388)]<=a[o(388)]&&d[o(715)]>=a.endRow?l=null:d.endRow<a[o(388)]&&(l[o(388)]=a.startRow-c,l[o(715)]=a.endRow-c),l&&!(l[o(388)]===l[o(715)]&&l[o(616)]===l[o(499)])&&i.push(l),i},[]);return n[x(472)][x(644)]=s,n[x(472)][x(644)].length===0&&(n.id=h0.id),{m1Prime:n,m2Prime:r}}},Qf={m1:Z0.id,m2:Ge.id,handler(t,e){const x=_,n={m1Prime:[],m2Prime:[]};if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t.params[x(505)]!==e[x(472)][x(505)])return n;const r=R.deepClone(e),s=r[x(472)][x(427)],i=s[s[x(411)]-1].primary;return t.params[x(644)].forEach(a=>{const o=x;i&&x0[o(394)](a,i)&&(i[o(368)]=!1,i.isMergedMainCell=!1,i[o(388)]=a[o(388)],i[o(616)]=a[o(616)],i[o(715)]=a[o(388)],i[o(499)]=a[o(616)],i[o(428)]=a[o(616)],i[o(393)]=a[o(388)])}),n[x(633)][x(442)](r),n}},zf=t=>{const e=_,{order:x}=t,n={};return Object.keys(x)[e(384)](r=>{n[x[Number(r)]]=Number(r)}),{...t,order:n}},Jf=(t,e)=>{const x=_,n={};return Array.from(new Set(Object.keys(t)[x(462)](Object[x(724)](e))[x(500)](Number)))[x(384)](r=>{let s;r in e?(s=e[r],s in t&&(s=t[s])):s=t[r],n[r]=s}),n},Xf={m1:Hx.id,m2:Hx.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)][x(675)])return n;const{range:r}=t[x(472)],{range:s}=e.params;if(s[x(616)]===r[x(616)]&&s[x(499)]===r.endColumn&&s.startRow<=r.startRow&&s[x(715)]>=r[x(715)]){const i=zf(t[x(472)])[x(541)],a={id:Hx.id,params:{...e.params,range:s,order:Jf(i,e[x(472)][x(541)])}};return{m1Prime:[],m2Prime:a}}return x0[x(394)](r,s)?{error:new Error(x(588))}:n}},qf={m1:cs.id,m2:_(424),handler(t,e){const x=_;return{error:new Error(x(583))}}},Kf={m1:_(424),m2:cs.id,handler(t,e){const x=_;return t[x(472)].unitId===e.params[x(675)]?{m1Prime:[],m2Prime:e}:{m1Prime:t,m2Prime:e}}},Zf={m1:cn.id,m2:cn.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e.params[x(675)]||t[x(472)][x(505)]!==e[x(472)][x(505)])return n;const r=t.params[x(357)],s=e[x(472)][x(357)],i={},a=R[x(544)](t),o=new Set([...Object[x(724)](r)[x(500)](Number),...Object[x(724)](s)[x(500)](Number)]);for(const d of o){const c=r[d],l=s[d];if(c&&l){const u={...c,...l};i[d]=u}else c?i[d]=c:l&&(i[d]=l)}return a[x(472)].columnData=i,{m1Prime:a,m2Prime:e}}},x3={m1:pn.id,m2:pn.id,handler(t,e){const x=_;if(t[x(472)][x(675)]!==e.params[x(675)]||t[x(472)][x(505)]!==e.params[x(505)])return{m1Prime:t,m2Prime:e};const n=t[x(472)][x(532)]||t[x(472)][x(610)].cfId,r=e.params[x(532)]||e.params[x(610)].cfId;if(n!==r)return{m1Prime:t,m2Prime:e};const s=R[x(544)](e);return{m1Prime:[],m2Prime:s}}};function Mt(t,e){const x=C2();return Mt=function(n,r){return n=n-351,x[n]},Mt(t,e)}function e3(t,e){const x=_,n=t[x(376)]((r,s)=>(r.set(s[x(557)],!0),r),new Map);return e[x(503)](r=>n[x(449)](r.drawingId)!==void 0)}function t3(t,e){const x=_,n=t[x(489)];return e[x(489)].some(r=>n[x(670)](r)!==-1)}const{UPDATE:n3,REMOVE:s3,ARRANGE:Hi}=Y1,r3={m1:Ii.id,m2:Ii.id,handler(t,e){const x=_,n=t[x(472)],r=e[x(472)];if(n.unitId!==r[x(675)]||n.subUnitId!==r.subUnitId)return{m1Prime:t,m2Prime:e};const s=n[x(478)],i=r[x(478)];if(s===s3&&i===n3&&e3(n.objects,r[x(524)]))return{m1Prime:R[x(544)](t),m2Prime:[]};if(s===Hi&&i===Hi&&t3(n[x(524)],r[x(524)])){const a=R[x(544)](t),o=R.deepClone(e);return{m1Prime:{...a,params:{...a.params,op:ri[x(478)][x(543)](a[x(472)].op,o[x(472)].op,x(360))}},m2Prime:{...o,params:{...o[x(472)],op:ri[x(478)][x(543)](o[x(472)].op,a[x(472)].op,"right")}}}}return{m1Prime:t,m2Prime:e}}},i3={m1:Rt.id,m2:Rt.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};return t[x(472)][x(675)]!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e[x(472)][x(505)]?n:{error:new Error("Two set-frozen mutations have the same unitId and subUnitId.")}}},a3={m1:Yx.id,m2:gx.id,handler(t,e){const x=_;if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e.params[x(505)])return{m1Prime:t,m2Prime:e};const n=R[x(544)](t),r=R[x(544)](e),s=n[x(472)][x(609)],i=r[x(472)].ranges;for(const a in s){const o=s[a][x(644)],d=[];o[x(384)](c=>{const l=x,u=ls(c,i);u[l(411)]>0&&d[l(442)](...u)}),s[a][x(644)]=d}return{m1Prime:n,m2Prime:r}}},o3={m1:Yx.id,m2:Yx.id,handler(t,e){const x=_;if(t[x(472)][x(675)]!==e.params[x(675)]||t[x(472)][x(505)]!==e[x(472)][x(505)])return{m1Prime:t,m2Prime:e};const n=R[x(544)](t),r=R.deepClone(e),s=n[x(472)][x(609)],i=Object[x(609)](r.params.values)[x(500)](a=>a.ranges)[x(456)]();for(const a in s){const o=s[a][x(644)],d=[];o[x(384)](c=>{const l=x,u=ls(c,i);u.length>0&&d[l(442)](...u)}),s[a].ranges=d}return{m1Prime:n,m2Prime:r}}},d3={m1:nx.id,m2:xe.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};return t[x(472)][x(675)]!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e[x(472)][x(505)]?n:{error:new Error(x(508))}}},c3={m1:nx.id,m2:hn.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e[x(472)][x(505)])return n;const r=t[x(472)].rule[x(644)],s=e[x(472)].rule.ranges;return r[x(503)](i=>s[x(503)](a=>x0[x(394)](i,a)))?{error:new Error(x(562))}:n}},l3={m1:nx.id,m2:F0.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e.params.subUnitId)return n;const r=t[x(472)][x(610)].ranges,s=e[x(472)].ranges;return r[x(503)](i=>s[x(503)](a=>x0.intersects(i,a)))?{error:new Error(x(789))}:n}},u3={m1:nx.id,m2:O0.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};return t[x(472)].unitId!==e[x(472)][x(675)]||t[x(472)].subUnitId!==e[x(472)][x(610)][x(505)]?n:{error:new Error("set range protection is conflict with add worksheet protection")}}},f3={m1:nx.id,m2:_n.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};return t[x(472)][x(675)]!==e[x(472)][x(675)]||t[x(472)].subUnitId!==e[x(472)][x(505)]?n:{error:new Error(x(364))}}},m3={m1:nx.id,m2:B0.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};if(t.params.unitId!==e.params.unitId||t[x(472)][x(505)]!==e[x(472)][x(505)])return n;const r=t[x(472)][x(610)][x(644)],s=e[x(472)][x(604)];return r.some(i=>x0[x(394)](i,s))?{error:new Error(x(778))}:n}},b3={m1:nx.id,m2:G0.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)].unitId||t[x(472)][x(505)]!==e[x(472)][x(505)])return n;const r=t[x(472)][x(610)][x(644)],s=e.params[x(604)];return r[x(503)](i=>x0[x(394)](i,s))?{error:new Error(x(620))}:n}},h3={m1:nx.id,m2:q0.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t[x(472)].subUnitId!==e[x(472)][x(505)])return n;const r=t[x(472)][x(610)].ranges,s=[e[x(472)][x(480)],e.params.targetRange];return r[x(503)](i=>s[x(503)](a=>x0[x(394)](i,a)))?{error:new Error(x(550))}:n}},p3={m1:nx.id,m2:hx.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t.params[x(505)]!==e[x(472)][x(662)][x(505)])return n;const r=t[x(472)][x(610)][x(644)],s=new K(e[x(472)][x(662)][x(822)])[x(663)](),i=new K(e[x(472)].to[x(822)])[x(663)](),a=[s,i];return r[x(503)](o=>a[x(503)](d=>x0[x(394)](o,d)))?{error:new Error("set range protection is conflict with move range")}:n}},_3={m1:nx.id,m2:Y0.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)].unitId||t[x(472)][x(505)]!==e[x(472)].subUnitId)return n;const r=t[x(472)][x(610)][x(644)],s=[e[x(472)][x(480)],e[x(472)][x(723)]];return r[x(503)](i=>s[x(503)](a=>x0[x(394)](i,a)))?{error:new Error("set range protection is conflict with move row")}:n}},I3={m1:nx.id,m2:V0.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e.params.unitId||t.params[x(505)]!==e[x(472)][x(505)])return n;const r=t.params[x(610)][x(644)],s=e[x(472)][x(604)];return r.some(i=>x0[x(394)](i,s))?{error:new Error("set range protection is conflict with remove col")}:n}},g3={m1:nx.id,m2:ie.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};return t[x(472)][x(675)]!==e[x(472)][x(675)]||t[x(472)].subUnitId!==e[x(472)].subUnitId?n:{error:new Error(x(561))}}},v3={m1:nx.id,m2:j0.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e.params[x(675)]||t.params[x(505)]!==e[x(472)].subUnitId)return n;const r=t[x(472)][x(610)][x(644)],s=e[x(472)][x(604)];return r[x(503)](i=>x0[x(394)](i,s))?{error:new Error("set range protection is conflict with remove row")}:n}},C3={m1:nx.id,m2:We.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};return t[x(472)].unitId!==e.params[x(675)]||t[x(472)][x(505)]!==e[x(472)][x(505)]?n:{error:new Error("set range protection is conflict with remove filter")}}},w3={m1:nx.id,m2:Z0.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};if(t.params.unitId!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e.params.subUnitId)return n;const r=t[x(472)][x(610)][x(644)],s=e[x(472)][x(644)];return r.some(i=>s[x(503)](a=>x0[x(394)](i,a)))?{error:new Error(x(747))}:n}},P3={m1:nx.id,m2:pn.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};if(t.params[x(675)]!==e.params.unitId||t[x(472)].subUnitId!==e[x(472)][x(505)])return n;const r=t[x(472)][x(610)][x(644)],s=e[x(472)][x(610)][x(644)];return r.some(i=>s[x(503)](a=>x0[x(394)](i,a)))?{error:new Error(x(754))}:n}},y3={m1:nx.id,m2:Rt.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t.params[x(505)]!==e[x(472)][x(505)])return n;const r=t[x(472)].rule[x(644)],s=[{startRow:e.params[x(388)],endRow:e.params[x(388)],startColumn:e[x(472)].startColumn,endColumn:e[x(472)][x(616)]}];return r[x(503)](i=>s[x(503)](a=>x0.intersects(i,a)))?{error:new Error(x(654))}:n}},R3={m1:nx.id,m2:Yx.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};return t[x(472)][x(675)]!==e[x(472)][x(675)]||t.params.subUnitId!==e.params[x(505)]?n:{error:new Error(x(525))}}},E3={m1:nx.id,m2:nx.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};if(t.params[x(675)]!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e[x(472)].subUnitId)return n;const r=t[x(472)].rule[x(644)],s=e.params[x(610)][x(644)];return r.some(i=>s[x(503)](a=>x0.intersects(i,a)))?{error:new Error(x(683))}:n}},S3={m1:nx.id,m2:H0.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)].unitId!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e[x(472)][x(505)])return n;const r=t[x(472)][x(610)][x(644)],s=new K(e[x(472)][x(589)])[x(663)]();return r[x(503)](i=>x0[x(394)](i,s))?{error:new Error(x(598))}:n}},T3={m1:nx.id,m2:de.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e.params.unitId||t[x(472)][x(505)]!==e[x(472)].subUnitId)return n;const r=t[x(472)][x(610)][x(644)],s=e.params[x(644)];return r[x(503)](i=>s[x(503)](a=>x0.intersects(i,a)))?{error:new Error(x(628))}:n}},M3={m1:nx.id,m2:bn.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};return t[x(472)][x(675)]!==e[x(472)].unitId||t[x(472)][x(505)]!==e.params[x(505)]?n:{error:new Error(x(733))}}},N3={m1:nx.id,m2:dx.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};return t[x(472)][x(675)]!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e[x(472)][x(505)]?n:{error:new Error(x(367))}}},U3={m1:H0.id,m2:F0.id,handler(t,e){const x=_,n=so.handler(e,t);return Te(n)?{m1Prime:n[x(633)],m2Prime:n[x(753)]}:n}},k3={m1:H0.id,m2:hx.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)][x(675)])return n;const r=new K(t[x(472)][x(589)])[x(663)](),s=new K(e[x(472)][x(662)][x(822)]).getDataRange(),i=new K(e.params.to[x(822)])[x(663)]();return t[x(472)][x(505)]===e.params[x(662)][x(505)]&&x0[x(394)](r,s)||t[x(472)].subUnitId===e[x(472)].to[x(505)]&&x0[x(394)](r,i)?{error:new Error(x(477))}:n}},D3={m1:H0.id,m2:Hx.id,handler(t,e){const x=_;var n,r;const s={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e.params[x(675)]||t[x(472)][x(505)]!==e.params[x(505)])return s;const i=R[x(544)](t),{cellValue:a}=i[x(472)],o=new K(a),{range:d}=e.params,c=new Map;for(let l=d[x(616)];l<=d.endColumn;l++)for(let u=d[x(388)];u<=d.endRow;u++)if(((n=a==null?void 0:a[u])==null?void 0:n[l])!==void 0){const f=(r=e.params.order[u])!=null?r:u;f!==u&&(c.has(f)||c[x(372)](f,new Map),c.get(f)[x(372)](l,a[u][l]),o[x(578)](u,l))}return c[x(384)]((l,u)=>{l[x(384)]((b,h)=>{o.setValue(u,h,b)})}),{m1Prime:i,m2Prime:e}}},O3=(t,e)=>t?e?{...t,...e}:t:e,F3={m1:H0.id,m2:H0.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t.params[x(675)]!==e[x(472)][x(675)]||t[x(472)].subUnitId!==e[x(472)][x(505)])return n;const r=R[x(544)](t),s=R[x(544)](e),i=new K(r[x(472)].cellValue),a=i[x(663)](),o=new K(e.params.cellValue),d=o[x(663)]();return x0[x(394)](a,d)?(i[x(698)]((c,l,u)=>{const f=x;var b,h;const p=o.getValue(c,l);if(u&&p){const I=R[f(544)](typeof u.s==f(761)?(b=r[f(472)][f(792)])==null?void 0:b[u.s]:u.s),v=R.deepClone(typeof p.s==f(761)?(h=s[f(472)][f(792)])==null?void 0:h[p.s]:p.s);p.s=O3(I,v),o.setValue(c,l,p),i[f(578)](c,l)}}),r[x(472)][x(589)]=i[x(763)](),s[x(472)][x(589)]=o[x(763)](),{m1Prime:r,m2Prime:s}):n}},$3={m1:mn.id,m2:mn.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t.params[x(675)]!==e[x(472)].unitId||t.params[x(505)]!==e[x(472)].subUnitId)return n;const r=t[x(472)][x(627)],s=e[x(472)][x(627)],i={},a=R[x(544)](t),o=new Set([...Object[x(724)](r)[x(500)](Number),...Object[x(724)](s).map(Number)]);for(const d of o){const c=r[d],l=s[d];if(c&&l){const u={...c,...l};i[d]=u}else c?i[d]=c:l&&(i[d]=l)}return a[x(472)][x(627)]=i,{m1Prime:a,m2Prime:e}}},A3={m1:Le.id,m2:hx.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t.params[x(675)]!==e[x(472)].unitId||t[x(472)][x(505)]!==e[x(472)].from[x(505)]&&t[x(472)][x(505)]!==e.params.to[x(505)])return n;let r=null;return t[x(472)][x(505)]===e.params.from[x(505)]&&new K(e[x(472)].from[x(822)]).forValue((s,i)=>{const a=x;i===t[a(472)][a(758)]&&(r=e[a(472)][a(662)][a(505)])}),t.params[x(505)]===e[x(472)].to[x(505)]&&new K(e[x(472)].to[x(822)])[x(698)]((s,i)=>{const a=x;i===t[a(472)][a(758)]&&(r=e[a(472)].to[a(505)])}),r?{m1Prime:t,m2Prime:[e,{id:Aa.id,params:{unitId:e[x(472)][x(675)],subUnitId:r}}]}:n}},V3={m1:Le.id,m2:We.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};return t[x(472)][x(675)]!==e[x(472)].unitId||t[x(472)].subUnitId!==e[x(472)][x(505)]?n:{m1Prime:[],m2Prime:[e]}}},j3={m1:Le.id,m2:H0.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)][x(675)]||t.params[x(505)]!==e[x(472)][x(505)])return n;let r=!1;return new K(e[x(472)][x(589)])[x(698)]((s,i)=>{i===t[x(472)].col&&(r=!0)}),r?{m1Prime:t,m2Prime:[e,{id:Aa.id,params:{unitId:e[x(472)][x(675)],subUnitId:e[x(472)][x(505)]}}]}:n}},L3={m1:Le.id,m2:Le.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};return t[x(472)].unitId!==e.params[x(675)]||t.params[x(505)]!==e[x(472)].subUnitId||t.params[x(758)]!==e.params.col?n:{m1Prime:[],m2Prime:[e]}}},H3={m1:le.id,m2:We.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};return t[x(472)].unitId!==e[x(472)][x(675)]||t[x(472)][x(505)]!==e.params[x(505)]?n:{m1Prime:[],m2Prime:[e]}}},B3={m1:le.id,m2:le.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};return t.params.unitId!==e[x(472)][x(675)]||t[x(472)].subUnitId!==e[x(472)][x(505)]?n:{m1Prime:[],m2Prime:[e]}}},G3={m1:ci.id,m2:ci.id,handler(t,e){const x=_;return t.params[x(675)]===e[x(472)][x(675)]&&t[x(472)][x(505)]===e.params[x(505)]&&t[x(472)][x(587)]!==e[x(472)][x(587)]?{error:new Error(x(412))}:{m1Prime:t,m2Prime:e}}},Y3={m1:de.id,m2:de.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t.params[x(675)]!==e[x(472)][x(675)]||t[x(472)].subUnitId!==e[x(472)].subUnitId)return n;const r=t[x(472)].ranges,s=[],i=R[x(544)](t),a=e[x(472)][x(644)];r[x(384)](c=>{const l=x,u={start:c.startColumn,end:c[l(499)]},f=a[l(500)](h=>({start:h.startColumn,end:h[l(499)]})),b=$r(u,f)[l(500)](h=>({...c,startColumn:h.start,endColumn:h[l(787)]}));s.push(...b)}),i[x(472)][x(644)]=s;const{colWidth:o}=i[x(472)],{colWidth:d}=e.params;return typeof o!="number"&&(typeof d!=x(602)?Object[x(724)](d).map(Number)[x(384)](c=>{o[c]!=null&&delete o[c]}):a[x(384)](c=>{const l=x;for(let u=c[l(616)];u<=c[l(499)];u++)delete o[u]})),{m1Prime:i,m2Prime:e}}},W3={m1:js.id,m2:js.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};return t[x(472)][x(675)]!==e[x(472)].unitId||t[x(472)][x(505)]!==e[x(472)].subUnitId?n:{error:new Error(x(736))}}},Q3={m1:ln.id,m2:ln.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e.params[x(675)]||t[x(472)][x(505)]!==e[x(472)][x(505)])return n;const r=t[x(472)][x(464)],s=[],i=R.deepClone(t),a=e[x(472)][x(464)];return r[x(384)](o=>{const d=x;a[d(539)](c=>c.row===o.row)||s[d(442)](o)}),i[x(472)][x(464)]=s,{m1Prime:i,m2Prime:e}}},z3={m1:un.id,m2:un.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t.params[x(675)]!==e.params[x(675)]||t[x(472)].subUnitId!==e[x(472)].subUnitId)return n;const r=t[x(472)][x(644)],s=[],i=R.deepClone(t),a=e[x(472)].ranges;r[x(384)](c=>{const l=x,u={start:c[l(388)],end:c.endRow},f=a[l(500)](h=>({start:h[l(388)],end:h[l(715)]})),b=$r(u,f)[l(500)](h=>({...c,startRow:h[l(374)],endRow:h.end}));s[l(442)](...b)}),i.params[x(644)]=s;const{rowHeight:o}=i[x(472)],{rowHeight:d}=e.params;return typeof o!=x(602)&&(typeof d!=x(602)?Object[x(724)](d)[x(500)](Number)[x(384)](c=>{o[c]!=null&&delete o[c]}):a[x(384)](c=>{const l=x;for(let u=c[l(388)];u<=c[l(715)];u++)delete o[u]})),{m1Prime:i,m2Prime:e}}},J3={m1:fn.id,m2:fn.id,handler(t,e){const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)][x(675)]!==e[x(472)].unitId||t[x(472)].subUnitId!==e[x(472)].subUnitId)return n;const r=t[x(472)][x(644)],s=[],i=R.deepClone(t),a=e[x(472)][x(644)];r[x(384)](c=>{const l=x,u={start:c[l(388)],end:c[l(715)]},f=a[l(500)](h=>({start:h[l(388)],end:h[l(715)]})),b=$r(u,f).map(h=>({...c,startRow:h[l(374)],endRow:h[l(787)]}));s[l(442)](...b)}),i.params[x(644)]=s;const{autoHeightInfo:o}=i[x(472)],{autoHeightInfo:d}=e[x(472)];return typeof o!=x(602)&&(typeof d!=x(602)?Object[x(724)](d).map(Number)[x(384)](c=>{o[c]!=null&&delete o[c]}):a[x(384)](c=>{const l=x;for(let u=c.startRow;u<=c[l(715)];u++)delete o[u]})),{m1Prime:i,m2Prime:e}}},X3={m1:ce.id,m2:ce.id,handler:(t,e)=>{const x=_,n=t[x(472)],r=e[x(472)];return n[x(675)]===r.unitId&&n.subUnitId===r[x(505)]&&n[x(575)][x(474)]===r[x(575)][x(474)]?{m1Prime:[],m2Prime:e}:{m1Prime:t,m2Prime:e}}},q3={m1:bn.id,m2:bn.id,handler:(t,e)=>{const x=_,n=t.params,r=e.params;return n[x(675)]===r[x(675)]&&n[x(505)]===r[x(505)]&&n[x(575)][x(474)]===r[x(575)].commentId?{m1Prime:[],m2Prime:e}:{m1Prime:t,m2Prime:e}}},K3={m1:dx.id,m2:ye.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e},r=t.params,s=e[x(472)];if(r[x(675)]!==s[x(675)]||r[x(505)]!==s.subUnitId)return n;if(t[x(472)][x(575)][x(478)]===Ax[x(567)]){const{unitId:i,subUnitId:a}=t.params,o=Array[x(552)](e.params[x(610)])?e.params[x(610)]:[e[x(472)][x(610)]],d=[],c=new K,l=t[x(472)][x(575)][x(575)];l[x(384)](b=>{const h=x;Rx[h(498)](b,(p,I)=>{const v=h;c[v(645)](p,I,t[v(472)][v(445)])})}),o.forEach(b=>{b.ranges.forEach(h=>{Rx.foreach(h,(p,I)=>{const v=Mt;c[v(645)](p,I,b[v(553)])})})});const u=t[x(472)][x(445)],f=J2(c,b=>b===u);return st(f,l)||(f[x(411)]?d[x(442)]({id:dx.id,params:{unitId:i,subUnitId:a,ruleId:u,payload:{type:Ax[x(567)],payload:f}}}):d[x(442)]({id:ie.id,params:{unitId:i,subUnitId:a,ruleId:u}})),{m1Prime:d[x(411)]?d:[t],m2Prime:[...d,e]}}return n}},Z3={m1:dx.id,m2:ie.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e};if(t[x(472)].unitId!==e[x(472)][x(675)]||t.params.subUnitId!==e[x(472)][x(505)])return n;const r=t[x(472)][x(445)];return(Array.isArray(e[x(472)][x(445)])?e.params[x(445)]:[e[x(472)][x(445)]])[x(670)](r)>-1?{m1Prime:[],m2Prime:e}:n}},xm={m1:dx.id,m2:dx.id,handler:(t,e)=>{const x=_,n={m1Prime:t,m2Prime:e},r=t[x(472)],s=e.params;if(r[x(675)]===s.unitId&&r[x(505)]===s.subUnitId){const i=R[x(544)](e);if(s[x(445)]===r[x(445)]&&r[x(575)][x(478)]===s[x(575)].type)return r[x(575)].type===Ax[x(567)]&&!st(r[x(575)][x(575)],s[x(575)][x(575)])?{error:new Error(x(548))}:{m1Prime:[],m2Prime:i};if(r[x(575)][x(478)]===Ax[x(567)]&&s[x(575)][x(478)]===Ax[x(567)]&&s.ruleId!==r[x(445)]){let a=function(l,u){const f=x;l[f(384)](b=>{const h=f;Rx[h(498)](b,(p,I)=>{o[h(645)](p,I,u)})})};const o=new K;a(r[x(575)][x(575)],r[x(445)]),a(s[x(575)][x(575)],s.ruleId);const d=J2(o,l=>l===r[x(445)]),c=st(r[x(575)][x(575)],d)?[]:d[x(411)]?[{id:dx.id,params:{...r,payload:{type:Ax[x(567)],payload:d}}}]:[{id:ie.id,params:{...r,payload:void 0}}];return{m1Prime:[t],m2Prime:[...c,e]}}}return n}},em={m1:_i.id,m2:_i.id,handler:(t,e)=>{const x=_,n=t[x(472)],r=e.params;return n[x(675)]===r[x(675)]&&n[x(505)]===r[x(505)]&&n.id===r.id?{m2Prime:e,m1Prime:[]}:{m1Prime:t,m2Prime:e}}},tm={m1:pi.id,m2:pi.id,handler:(t,e)=>{const x=_,n=t[x(472)],r=e[x(472)];return n.unitId===r[x(675)]&&n[x(505)]===r[x(505)]&&n.id===r.id?{m2Prime:e,m1Prime:[]}:{m1Prime:t,m2Prime:e}}},nm={m1:Ee.id,m2:F0.id,handler(t,e){const x=_,n=R.deepClone(e);return t[x(472)][x(505)]!==e[x(472)].subUnitId||t[x(472)][x(675)]!==e[x(472)][x(675)]?{m1Prime:t,m2Prime:n}:(n.id=h0.id,{m1Prime:t,m2Prime:n})}},sm={m1:Ee.id,m2:Z0.id,handler(t,e){const x=_,n=R[x(544)](e);return t.params[x(505)]!==e[x(472)][x(505)]||t[x(472)][x(675)]!==e[x(472)].unitId?{m1Prime:t,m2Prime:n}:(n.id=h0.id,{m1Prime:t,m2Prime:n})}},rm={m1:je.id,m2:je.id,handler(t,e){const x=_;if(t[x(472)][x(558)].id===e.params.sheet.id)return{error:new Error("Two mutation have the same worksheetId!")};const n=R[x(544)](t),r=R[x(544)](e);return n[x(472)][x(649)]<=r.params[x(649)]?r[x(472)][x(649)]+=1:n[x(472)][x(649)]>r[x(472)][x(649)]&&(n[x(472)][x(649)]+=1),t[x(472)][x(558)][x(813)]===e.params[x(558)][x(813)]?{error:new Error(x(566))}:{m1Prime:n,m2Prime:r}}},im={m1:Ee.id,m2:"any",handler(t,e){const x=_;var n;return t[x(472)][x(505)]===((n=e.params)==null?void 0:n[x(505)])&&t.id!==e.id?{error:new Error(x(629))}:{m1Prime:t,m2Prime:e}}},am={m1:c2.id,m2:c2.id,handler(t,e){const x=_,n=R[x(544)](t),r=R[x(544)](e),s={error:new Error(x(737))};if(t[x(472)].fromOrder===e[x(472)][x(767)])n.id=h0.id,r[x(472)][x(767)]=t[x(472)].toOrder;else{t.params[x(767)]===t.params[x(404)]&&(n.id=h0.id),e[x(472)].fromOrder===e[x(472)][x(404)]&&(r.id=h0.id);const i=[Math[x(485)](t[x(472)][x(767)],t[x(472)][x(404)]),Math[x(786)](t[x(472)][x(767)],t.params.toOrder)],a=[Math[x(485)](e.params[x(767)],e.params[x(404)]),Math[x(786)](e[x(472)][x(767)],e.params.toOrder)];if(i[0]<=a[1]&&i[1]>=a[0])return s}return{m1Prime:n,m2Prime:r}}},om={m1:je.id,m2:c2.id,handler(t,e){const x=_,n=R[x(544)](t),r=R[x(544)](e);return t.params[x(649)]<=e.params[x(541)]&&(r[x(472)].order+=1),{m1Prime:n,m2Prime:r}}},dm={m1:_(424),m2:Ee.id,handler(t,e){return{m1Prime:t,m2Prime:e}}},cm=[rm,om,im,dm,am];var lm=(t,e,x,n)=>{const r=_;for(var s=e,i=t[r(411)]-1,a;i>=0;i--)(a=t[i])&&(s=a(s)||s);return s},um=(t,e)=>(x,n)=>e(x,n,t);const fm=[...cm,pl,_l,Il,gl,Sl,Pl,yl,Rl,Ul,El,vl,Tl,Al,Vl,jl,Hl,Wl,Kl,Zl,xu,Ql,zl,Jl,Yl,Ll,Xl,ru,mu,iu,cu,lu,uu,_u,fu,bu,au,Mu,Fu,Tu,Hu,Bu,Gu,$u,Au,Vu,Ou,Nu,ju,Cu,yu,wu,Ku,Xu,qu,af,tf,nf,sf,lf,rf,Zu,of,Pf,Cf,vf,Tf,Of,Ff,$f,Mf,Nf,Uf,Sf,wf,kf,F3,k3,W3,i3,G3,Y3,Q3,z3,J3,$3,Zf,o3,a3,hf,pf,rc,x3,gu,ll,ic,xm,mf,ml,Eu,bl,zu,If,Dl,Wu,Ol,tu,ff,Vf,ac,K3,Z3,Ml,Nl,ql,hu,pu,Lu,df,cf,Df,L3,V3,j3,A3,B3,H3,kc,qa,hl,Ka,$l,Za,su,eo,Su,xo,vu,to,Ju,no,gf,so,U3,Dc,nm,Cl,Bl,ou,Uu,xf,yf,sm,jf,Hf,Lf,Bf,Gf,Yf,Wf,Oc,Qf,sc,dl,cl,X3,q3,ul,Fl,nu,Ru,Qu,_f,kl,eu,Iu,Yu,uf,Af,oc,bf,tm,em,dc,cc,lc,uc,fc,mc,bc,hc,pc,_c,Ic,gc,vc,Cc,wc,Pc,yc,Rc,Ec,Sc,Tc,Mc,Nc,Uc,d3,c3,l3,u3,f3,m3,b3,h3,p3,_3,I3,v3,g3,C3,w3,P3,y3,R3,E3,S3,T3,M3,N3,Fc,$c,Ac,Vc,jc,Lc,Hc,Bc,Gc,Yc,Qc,Wc,zc,qc,Jc,Xc,Zc,Kc,xl,el,tl,nl,sl,rl,il,al,ol,Gl,wl,Rf,ef,ku,du,Pu,D3,Xf,r3,Kf,qf];let _2=class extends U0{constructor(e){const x=_;super(),this[x(804)]=e,fm[x(384)](n=>{this[x(804)].registerTransformAlgorithm(n)})}};_2=lm([um(0,Fr)],_2);function q4(t){const e=_;var x,n;return{...t,mutations:(n=(x=t[e(790)])==null?void 0:x.map(mm))!=null?n:[]}}function K4(t){const e=_;return t[e(500)](x=>({id:x.id,params:JSON.parse(x[e(685)])}))}function Z4(t){var e,x;return{...t,mutations:(x=(e=t.mutations)==null?void 0:e.map(bm))!=null?x:[]}}function mm(t){const e=_;return{id:t.id,params:JSON[e(475)](t.data)}}function bm(t){const e=_;return{id:t.id,data:JSON.stringify(t[e(472)])}}var hm=(t=>(t[_(467)]="fetch_missing",t[_(391)]=_(751),t[_(605)]=_(625),t[_(433)]="changeset_ack",t.CHANGESET_REJ="changeset_rej",t[_(635)]=_(403),t[_(469)]="new_changesets",t[_(401)]="update_cursor",t.USERS_ENTER=_(745),t[_(476)]=_(615),t[_(730)]=_(701),t[_(734)]="liveshare.request_host",t[_(607)]=_(682),t[_(580)]="liveshare.operation",t[_(434)]=_(703),t[_(493)]=_(597),t[_(481)]="error_msg",t[_(594)]="permission_rej",t[_(726)]=_(735),t[_(647)]="update_permission_obj",t.SHOULD_CLOSE_CONN=_(371),t.UNISCRIPT_RUN="uniscript.run",t))(hm||{});const pm=_(718),Bi={};Object[_(768)];var _m=(t,e,x,n)=>{for(var r=e,s=t.length-1,i;s>=0;s--)(i=t[s])&&(r=i(r)||r);return r},Im=(t,e)=>(x,n)=>e(x,n,t);let I2=class extends U0{constructor(e){const x=_;super(),this._commandService=e,[cs][x(384)](n=>this[x(361)][x(471)](n))}};I2=_m([Im(0,g0)],I2);const gm=t=>{const e={};if(!t)return{cellValue:t,styleRefMap:void 0};const x=[];return{cellValue:new K(R.deepClone(t)).forValue((n,r,s)=>{const i=Mt,a=s&&s.s;if(a&&typeof a===i(556)){const o=JSON[i(573)](a),d=x[i(571)](c=>c===o);if(d>-1)s.s=""+d;else{const c=x[i(442)](o)-1;e[c]=a,s.s=""+c}}}).getMatrix(),styleRefMap:e}},vm=(t,e)=>!t||!e?t:new K(R.deepClone(t))[_(698)]((x,n,r)=>{const s=_,i=r&&r.s;if(i&&typeof i===s(761)){const a=e[i];a&&(r.s=a)}})[_(763)](),Cm=Cr(_(796)),wm=Cr("COMPRESS_MUTATION_SEND");let ro=class{constructor(){const e=_;r2(this,"interceptor",new wa({COMPRESS_MUTATION_APPLY:Cm,COMPRESS_MUTATION_SEND:wm})),this[e(530)]()}[_(530)](){const e=_;this.interceptor[e(547)](this[e(611)][e(460)]()[e(796)],{priority:-1,handler:x=>x}),this[e(611)].intercept(this.interceptor[e(460)]()[e(531)],{priority:-1,handler:x=>x}),this[e(458)]()}[_(458)](){const e=_;this[e(611)].intercept(this[e(611)][e(460)]()[e(796)],{handler:(x,n,r)=>{const s=e;if(!x)return r(x);const i=x[s(500)](a=>{const o=s;if(a.id===H0.id){const d=a[o(472)];if(!d.styleRefMap)return a;const c=vm(d[o(589)],d[o(792)]);return{...a,params:{...d,cellValue:c}}}return a});return r(i)}}),this[e(611)][e(547)](this[e(611)].getInterceptPoints()[e(531)],{handler:(x,n,r)=>{const s=e;if(!x)return r(x);const i=x[s(500)](a=>{const o=s;if(a.id===H0.id){const d=a[o(472)];return d.styleRefMap?a:{...a,params:{...d,...gm(d[o(589)])}}}else if(a.id===je.id)return this[o(560)](a,n);return a});return r(i)}})}[_(560)](e,x){const n=_,r=e[n(472)],{unitId:s,sheet:i}=r,a=x[n(535)](s,P0[n(497)]);if(!a)return e;const o={};return new K(i[n(546)])[n(698)]((d,c,l)=>{const u=n;l&&l.s&&typeof l.s==u(761)&&!o[l.s]&&(o[l.s]=a[u(679)]()[u(449)](l.s))}),{...e,params:{...r,styles:o}}}};Object[_(768)];var Pm=(t,e,x,n)=>{const r=_;for(var s=e,i=t[r(411)]-1,a;i>=0;i--)(a=t[i])&&(s=a(s)||s);return s},ym=(t,e)=>(x,n)=>e(x,n,t);const tp=new Set([je.id,Ee.id,ex.id,O0.id,u1.id]),np=new Set([je.id,Ee.id,cs.id,Rt.id]);let g2=class{constructor(e){const x=_;this[x(640)]=e}getCurrentRevOfUnit(e){const x=_,n=this[x(640)][x(535)](e);if(!n)throw new Error(x(375)+e+".");return n.getRev()}[_(591)](e){const x=_,n=this[x(640)][x(535)](e);if(!n)throw new Error("[RevisionService]: cannot find document with unitID: "+e+".");return n.incrementRev(),n[x(517)]()}[_(713)](e,x){const n=_,r=this[n(640)][n(535)](e);r&&r[n(382)](x)}};g2=Pm([ym(0,N0)],g2);var Dn=(t=>(t[t[_(750)]=0]="UNDEFINED",t[t.OK=1]="OK",t[t[_(771)]=2]=_(771),t[t.PERMISSION_DENIED=3]=_(432),t[t.NOT_FOUND=4]=_(677),t[t.UNAUTHENTICATED=5]=_(653),t[t[_(488)]=6]=_(488),t[t.INVALID_ARGUMENT=7]="INVALID_ARGUMENT",t[t[_(528)]=8]=_(528),t[t.COMPLETION_FINISHED=9]=_(740),t[t.LOGIN_FAILED=10]=_(721),t[t[_(592)]=11]=_(592),t[t.MOBILE_VERIFY_CODE_NOT_FOUND_OR_EXPIRED=12]=_(634),t[t.EMAIL_VERIFY_CODE_MISMATCH=13]=_(595),t[t[_(636)]=14]="EMAIL_VERIFY_CODE_NOT_FOUND_OR_EXPIRED",t[t[_(699)]=15]="AUTHORIZE_CODE_ILLEGAL",t[t[_(669)]=16]="LOGIN_TOKEN_PROCESSING_FAILED",t[t[_(626)]=100]="CURRENT_STATUS_CANNOT_OPERATE",t[t[_(545)]=101]=_(545),t[t[_(576)]=201]=_(576),t[t[_(762)]=202]=_(762),t[t[_(772)]=5001]=_(772),t[t.SNAPSHOT_INVALID_SNAPSHOT=6001]=_(463),t[t[_(666)]=6002]=_(666),t[t.ENSURE_SNAPSHOT_EXECUTION=6003]=_(637),t[t.APPLY_REJECT=7001]=_(686),t[t[_(696)]=7002]=_(696),t[t[_(642)]=7003]=_(642),t[t[_(660)]=7004]=_(660),t[t.APPLY_DUPLICATED=7005]=_(739),t[t[_(515)]=8001]="CONNECTOR_DATA_TOO_LARGE",t[t.LICENSE_MAX_UNITS_EXCEEDED=9001]=_(743),t[t[_(707)]=9002]=_(707),t[t.LICENSE_IMPORT_SIZE_EXCEEDED=9003]="LICENSE_IMPORT_SIZE_EXCEEDED",t[t[_(678)]=9004]=_(678),t[t[_(441)]=9005]=_(441),t[t.YUUMI_UNABLE_LOAD_URL=10001]=_(770),t[t.YUUMI_URL_COL_OUT_OF_RANGE=10002]=_(389),t[t.YUUMI_RATE_OVER_LIMIT=10003]=_(359),t[t[_(601)]=10004]=_(601),t[t[_(680)]=10010]="YUUMI_NO_CUBOID_FOR_QUESTION",t[t[_(606)]=10011]=_(606),t[t[_(727)]=10012]=_(727),t[t[_(785)]=10013]=_(785),t[t[_(483)]=10014]=_(483),t[t[_(369)]=10015]=_(369),t[t[_(358)]=10016]="YUUMI_CONNECTOR_URL_NOT_FOUND",t[t[_(435)]=11001]=_(435),t[t[_(600)]=12001]=_(600),t[t[_(443)]=12002]="INVALID_INVITE_CODE",t[t[_(554)]=12003]="INVITE_CODE_REQUIRED",t[t[_(738)]=12004]="USER_NOT_INVITED_CODE",t[t[_(526)]=12005]=_(526),t[t[_(794)]=13001]=_(794),t[t.MOBILE_HAS_BEEN_BOUND=13002]=_(542),t[t[_(695)]=13003]="EMAIL_HAS_BEEN_BOUND",t[t.ENTITLE_CAN_NOT_BUY_LOWER_OTP=14001]="ENTITLE_CAN_NOT_BUY_LOWER_OTP",t[t[_(729)]=14002]=_(729),t[t.ENTITLE_DUP_SUBSCRIPTION=14003]=_(621),t[t[_(426)]=14004]="PAYMENT_CHANNEL_NOT_SUPPORT",t[t[_(509)]=14101]=_(509),t[t[_(676)]=14102]="ENTITLE_REPORT_LIMIT_EXCEED",t[t[_(780)]=14103]="ENTITLE_INSUFFICIENT_QUOTA",t[t[_(514)]=14301]=_(514),t[t[_(800)]=15001]=_(800),t[t[_(797)]=15002]=_(797),t[t[_(596)]=15003]="REDEMPTION_CODE_FULLY_REDEEMED",t[t[_(466)]=15004]=_(466),t[t[_(555)]=15005]=_(555),t[t[_(352)]=15006]=_(352),t[t[_(731)]=15007]=_(731),t[t[_(639)]=16001]="DATA_SOURCE_TOO_LARGE",t[t[_(431)]=-1]=_(431),t))(Dn||{}),ux=(t=>(t[t[_(569)]=0]=_(569),t[t[_(807)]=1]="UNIVER_DOC",t[t[_(497)]=2]=_(497),t[t[_(710)]=3]=_(710),t[t[_(760)]=4]="UNIVER_PROJECT",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED",t))(ux||{});function v2(t){return!!(t&&t[_(540)]&&t.code!==Dn.OK&&t.code!=="OK")}const On=new TextEncoder,us=new TextDecoder;function io(t){const e=_,x=R[e(544)](t);return delete x.id,delete x[e(813)],delete x[e(782)],delete x.columnCount,delete x[e(546)],On[e(410)](JSON[e(573)](x))}function ao(t){const e=_,x=R[e(544)](t);return delete x.id,delete x.rev,delete x[e(813)],delete x[e(821)],delete x[e(454)],delete x.resources,On[e(410)](JSON[e(573)](x))}function oo(t){const e=_,x=R[e(544)](t);return delete x.id,delete x[e(638)],delete x.title,delete x.resources,On[e(410)](JSON[e(573)](x))}function Gi(t){const e=_;return JSON[e(475)](typeof t=="string"?co(t):us[e(455)](t))}function C2(){const t=["getSheets","resources","insert col is conflict with move col","step","encode","length","Two set-tab-color mutations have the same unitId and subUnitId.","move col is conflict with set numfmft","insert row is conflict with set worksheet row height","fetchThroughInterceptors","getDeserializedSheetBlock","actions","_configService","_compressMutationService","_logService","669364RAkQLZ","sequenceNodesBuilder","ceil","any","add worksheet protection is conflict with set worksheet name","PAYMENT_CHANNEL_NOT_SUPPORT","selections","actualColumn","add worksheet protection is conflict with remove numfmt","dispose","UNRECOGNIZED","PERMISSION_DENIED","CHANGESET_ACK","LIVESHARE_FETCH_OPERATIONS","PY_RUNTIME_SCRIPT_ERROR","move range is conflict with reorder range","before","move row is conflict with move row","hasValue","[debug] m1Length: ","LICENSE_DISTRO_REJECTED","push","INVALID_INVITE_CODE","endOffset","ruleId","loadDoc","getData","move row is conflict with remove numfmt","get","blockMeta","[debug] c2: ","symbol","right-loop2","sheets","decode","flat","move row is conflict with set worksheet row auto height","_initSetRangeValues","_loopLimitTime","getInterceptPoints","add range protection is conflict with remove col","concat","SNAPSHOT_INVALID_SNAPSHOT","rowsAutoHeightInfo","defineProperty","REDEMPTION_CODE_NOT_STARTED","FETCH_MISSING","columnCount","NEW_CHANGESETS","_logOriginTransformMutations","registerCommand","params","body","commentId","parse","USERS_LEAVE","Set-range-values mutation and move-range mutation have an overlapping range.","type","saveDoc","sourceRange","MSG_FOR_ERROR","blockID","YUUMI_PROMPT_MAX_TOKENS_EXCEEDED","debug","min","insert row is conflict with set row visible","move col is conflict with move range","ALREADY_EXISTS","drawingIds","[TransformService]: _rightInclineTransformMutations loop1 exceeded the limit time.","moveRows","3929709xWKiqa","LIVESHARE_TERMINATE","remove col is conflict with set numfmt","UNIVER_COLLABORATION_PLUGIN","unitID","UNIVER_SHEET","foreach","endColumn","map","title","[debug] m2Length: ","some","now","subUnitId","fromCharCode","entries","set range protection is conflict with add comment","ENTITLE_CHAT_LIMIT_EXCEED","transformMutations","MUTATION","add range protection is conflict with update comment",`transformDocumentDataToSnapshot(): Failed to save snapshot.
ErrorCode: `,"ENTITLE_NEED_BILLING_ADDRESS","CONNECTOR_DATA_TOO_LARGE","merge","getRev","getRange","splice",". Date now: ","add range protection is conflict with set worksheet col width","byteLength","registerTransformAlgorithm","objects","set range protection is conflict with set numfmt","INVITE_CODE_ALREADY_BOUND","[Error] m2 origin mutation ","TOO_MANY_REQUESTS","3wHGPEz","_init","COMPRESS_MUTATION_SEND","cfId","removeColumns","block","getUnit","textRanges","6684380XptJkZ","call","find","code","order","MOBILE_HAS_BEEN_BOUND","transform","deepClone","ERROR_AGAIN","cellData","intercept","edit range of same data-validation rule is not allowed","handler","set range protection is conflict with move col","doc","isArray","uid","INVITE_CODE_REQUIRED","REDEMPTION_USER_NOT_ELIGIBLE","object","drawingId","sheet","add worksheet protection is conflict with remove filter","_handleInsertSheetCompressMutationSend","set range protection is conflict with remove data validation rule","set range protection is conflict with add conditional rule","[Error] _logCurrentTransformMutations ","[SnapshotService]: request snapshot error! The original error is: ","Random bytes length must be >= 16","Two mutation have the same worksheet name!","RANGE","add range protection is conflict with remove filter","UNIVER_UNKNOWN","add worksheet protection is conflict with remove row","findIndex","transformPosition","stringify","add range protection is conflict with insert col","payload","USER_NOT_FOUND","getSheetBlock","realDeleteValue","has","LIVESHARE_OPERATION","Two move-range mutations have an overlapping range.","remove row is conflict with set numfmt","RevertRevisionMutation conflicts with other mutations!","0123456789","move row is conflict with move range","2666709QjFaCC","color","reorder range is conflict with reorder range","cellValue","move row is conflict with set row visible","incrementRevOfUnit","MOBILE_VERIFY_CODE_MISMATCH","row","PERMISSION_REJ","EMAIL_VERIFY_CODE_MISMATCH","REDEMPTION_CODE_FULLY_REDEEMED","liveshare.terminate","set range protection is conflict with set range value","_logCurrentTransformMutations","INVITE_CODE_HAS_BEEN_UES","YUUMI_SUBSCRIPTION_NOT_FOUND","number","left-loop2","range","SUBMIT_CHANGESET","YUUMI_ASYNCIO_CANCELLED","LIVESHARE_NEW_HOST","[TransformService]: _rightInclineTransformMutations loop2 exceeded the limit time.","values","rule","interceptor","toISOString","random","getUnitOnRev","users_leave","startColumn","add","colId","[SnapshotService]: wrong rev from the server!","set range protection is conflict with insert row","ENTITLE_DUP_SUBSCRIPTION","Block not found","syncExecuteCommand","transformMutation","submit_changeset","CURRENT_STATUS_CANNOT_OPERATE","rowData","set range protection is conflict with set worksheet col width","Trying to mutate a deleted worksheet!","left-loop1","SETTING"," already exists.","m2Prime","MOBILE_VERIFY_CODE_NOT_FOUND_OR_EXPIRED","CHANGESET_SHOULD_RETRY","EMAIL_VERIFY_CODE_NOT_FOUND_OR_EXPIRED","ENSURE_SNAPSHOT_EXECUTION","rev","DATA_SOURCE_TOO_LARGE","_univerInstanceService","add worksheet protection is conflict with add conditional rule","APPLY_REVISION_CONFILICT","insert col is conflict with set col hidden","ranges","setValue","add worksheet protection is conflict with remove worksheet merge","UPDATE_PERMISSION_OBJ","comment","index","removeRows","_resourceManagerService"," is out of buffer bounds","UNAUTHENTICATED","set range protection is conflict with set frozen","parentId","getDoc","add worksheet protection is conflict with move row","528490JRjTmD","slice","APPLY_PERMISSION_DENIED","add range protection is conflict with insert row","from","getDataRange","remove row is conflict with move row","link","SNAPSHOT_HAS_BEEN_REMOVED","add range protection is conflict with move col","add range protection is conflict with remove numfmt","LOGIN_TOKEN_PROCESSING_FAILED","indexOf","rules","_snapshotServerService","_transformMap","filter","unitId","ENTITLE_REPORT_LIMIT_EXCEED","NOT_FOUND","LICENSE_EXPORT_SIZE_EXCEEDED","getStyles","YUUMI_NO_CUBOID_FOR_QUESTION","[SnapshotService]: request snapshot error!","liveshare.new_host","set range protection is conflict with set range protection","sort","data","APPLY_REJECT","add range protection is conflict with delete conditional formatting rule","criteria","right-loop1","Algorithm error, the changeset does not exist!","move col is conflict with move col","GRID","includes","revision","EMAIL_HAS_BEEN_BOUND","APPLY_NON_SEQUENTIAL_REVISION","ref","forValue","AUTHORIZE_CODE_ILLEGAL","add worksheet protection is conflict with set worksheet col width","unit_delete","randomUUID","liveshare.fetch_operations","[TransformService]: changesets revisions miss match. The 'baseRev' of c2 is ","getSnapshot","originalMeta","LICENSE_MAX_MEMBERS_PER_UNIT_EXCEEDED","add worksheet protection is conflict with insert col","2677220xMYLAY","UNIVER_SLIDE","_config","move range is conflict with set numfmt","setRevOfUnit","_snapshotService","endRow","add range protection is conflict with add worksheet protection","moveColumns","collaboration.config","remove col is conflict with remove numfmt","[TransformService]: _leftInclineTransformMutations loop2 exceeded the limit time.","LOGIN_FAILED","getUnitId","targetRange","keys","Two mutation need have the same unitId!","COMMENT_UPDATE","YUUMI_TABLE_NOT_FOUND_IN_UNIT","UUID byte range ","ENTITLE_UPDOWN_GRADE_NOT_SUPPORT","UNIT_DELETE","REDEMPTION_CODE_HAS_BEEN_CREATED","saveSnapshot","set range protection is conflict with update comment","LIVESHARE_REQUEST_HOST","comment_update","Two set-worksheet-name mutations have conflict.","Two SetWorksheetOrderMutation have conflicts!","USER_NOT_INVITED_CODE","APPLY_DUPLICATED","COMPLETION_FINISHED","add range protection is conflict with move row","add worksheet protection is conflict with remove col","LICENSE_MAX_UNITS_EXCEEDED","REFERENCE","users_enter","insert row is conflict with remove numfmt","set range protection is conflict with remove worksheet merge","getRandomValues","COLUMN","UNDEFINED","pseudo_fetch_missing_result","getSheet","m1Prime","set range protection is conflict with set conditional formatting rule","transformMutationsWithChangeset","crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported","add range protection is conflict with update data validation rule","col","univer-pro.collaboration.transform-service","UNIVER_PROJECT","string","USER_IS_ANONYMOUS","getMatrix","right","Algorithm error, m1Prime should not be undefined.","blocks","fromOrder","getOwnPropertyDescriptor","primary","YUUMI_UNABLE_LOAD_URL","INTERNAL_ERROR","CHANGESET_REVISION_CONFILICT","add worksheet protection is conflict with add comment","[debug] transformChangesets. Date now: ","7950BCHzZf","Remove-cols has conflicts with move-range","message","set range protection is conflict with insert col","formula1","ENTITLE_INSUFFICIENT_QUOTA","move row is conflict with set worksheet row height","rowCount","workbook","insert row is conflict with remove row","YUUMI_ALL_TABLES_IS_INVALID","max","end","all","set range protection is conflict with add worksheet merge","mutations","column","styleRefMap","add range protection is conflict with add comment","WECHAT_HAS_BEEN_BOUND","add range protection is conflict with remove worksheet merge","COMPRESS_MUTATION_APPLY","REDEMPTION_CODE_INACTIVE","_leftInclineTransformMutations","size","REDEMPTION_INVALID_CODE","EN_US","add worksheet protection is conflict with update comment","1410wwhlXw","_transformService","add range protection is conflict with set conditional formatting rule","[debug] _rightInclineTransformMutations start transforming mutations. Date now: ","UNIVER_DOC","add worksheet protection is conflict with set conditional formatting rule","[transformWorkbookDataToSnapshot()]: Failed to save sheet blocks.","getSlice","univer.mutation.create-unit","add worksheet protection is conflict with delete conditional formatting rule","name","startOffset","[debug] c1: ","insert col is conflict with set col visible","error","_transformMutationsCache","add worksheet protection is conflict with add range protection","updateSheet","sheetOrder","value","remove cols is conflict with set range values mutation, trying to write a formula reference to a removed column","REDEMPTION_USER_REDEEM_TIMES_EXCEED","[debug] _leftInclineTransformMutations start transforming mutations. Date now: ","clear","_rightInclineTransformMutations","add range protection is conflict with add worksheet merge","columnData","YUUMI_CONNECTOR_URL_NOT_FOUND","YUUMI_RATE_OVER_LIMIT","left","_commandService","saveSheet","then","set range protection is conflict with delete conditional formatting rule","remove rows is conflict with set range values mutation, trying to write a formula reference to a removed row","add range protection is conflict with move range","set range protection is conflict with update data validation rule","isMerged","YUUMI_AI_RUN_FAILED","baseRev","should_close_conn","set","insert row is conflict with set worksheet row auto height","start","[RevisionService]: cannot find document with unitId: ","reduce","8qtoGrH","isMergedMainCell","fill","unshift","saveSheetBlock","setRev","]: ","forEach","move col is conflict with remove numfmt","move col is conflict with set worksheet col width","_revisionService","startRow","YUUMI_URL_COL_OUT_OF_RANGE","hasOwnProperty","PSEUDO_FETCH_MISSING_RESULT","after","actualRow","intersects","transformSnapshotToDocumentData(): snapshot.doc is undefined.","createUnit","add worksheet protection is conflict with set worksheet order","move col is conflict with set numfmt","ERROR","add worksheet protection is conflict with set numfmt","UPDATE_CURSOR","add range protection is conflict with set numfmt","changeset_should_retry","toOrder","_injector"];return C2=function(){return t},C2()}function Rm(t){const e=_;return t instanceof Uint8Array?JSON[e(475)](us[e(455)](t)):t}function Em(t){const e=_;return JSON[e(475)](typeof t==e(761)?co(t):us[e(455)](t))}const Sm=256*20*20,Tm=1*1024*1024;function jr(t,e=Sm,x=Tm){const n=_,r=new K(t);if(!r.hasValue())return[];const{startRow:s,endRow:i,startColumn:a,endColumn:o}=r[n(518)](),d=[],c=Math[n(423)](e/(o-a+1));let l=1,u=s;for(;u<=i;){const f=Math[n(485)](u+c*l-1,i),b=r[n(810)](u,f,a,o);if(!b[n(439)]()){u+=c*l,l=1;continue}const h=Mm(b);f>=i||h[n(522)]>=x?(d[n(442)]({id:Ve(19,n(584)),startRow:u,endRow:f,data:h}),u+=c*l,l=1):l+=1}return d}function Mm(t){const e=_,x=t[e(447)]();return On[e(410)](JSON.stringify(x))}const Sx=[];for(let t=0;t<256;++t)Sx[_(442)]((t+256).toString(16)[_(659)](1));function Nm(t,e=0){return(Sx[t[e+0]]+Sx[t[e+1]]+Sx[t[e+2]]+Sx[t[e+3]]+"-"+Sx[t[e+4]]+Sx[t[e+5]]+"-"+Sx[t[e+6]]+Sx[t[e+7]]+"-"+Sx[t[e+8]]+Sx[t[e+9]]+"-"+Sx[t[e+10]]+Sx[t[e+11]]+Sx[t[e+12]]+Sx[t[e+13]]+Sx[t[e+14]]+Sx[t[e+15]]).toLowerCase()}let Ss;const Um=new Uint8Array(16);function km(){const t=_;if(!Ss){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error(t(756));Ss=crypto[t(748)].bind(crypto)}return Ss(Um)}const Dm=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Yi={randomUUID:Dm};function Om(t,e,x){const n=_;var r,s,i;t=t||{};const a=(i=(s=t[n(613)])!=null?s:(r=t.rng)==null?void 0:r[n(538)](t))!=null?i:km();if(a[n(411)]<16)throw new Error(n(565));if(a[6]=a[6]&15|64,a[8]=a[8]&63|128,e){if(x=x||0,x<0||x+16>e.length)throw new RangeError(n(728)+x+":"+(x+15)+n(652));for(let o=0;o<16;++o)e[x+o]=a[o];return e}return Nm(a)}function Wi(t,e,x){return Yi[_(702)]&&!e&&!t?Yi.randomUUID():Om(t,e,x)}const Fm={[P0[_(807)]]:ux[_(807)],[P0[_(497)]]:ux[_(497)],[P0[_(710)]]:ux[_(710)],[P0[_(569)]]:ux[_(569)],[P0[_(760)]]:ux.UNIVER_UNKNOWN,[P0[_(431)]]:ux[_(431)]};function rp(t){var e;return(e=Fm[t])!=null?e:ux.UNIVER_UNKNOWN}function ip(t){const e=_,x=On[e(410)](t);let n="";for(let r=0;r<x[e(411)];r++)n+=String[e(506)](x[r]);return btoa(n)}function co(t){const e=atob(t),x=e.length;let n=new Uint8Array(x);for(let s=0;s<x;s++)n[s]=e.charCodeAt(s);const r=us.decode(n);return n=null,r}async function $m(t,e,x,n){const r=_;var s;const i={unitID:e.id,rev:n,creator:"",name:(s=e[r(501)])!=null?s:"",resources:e.resources||[],originalMeta:oo(e)};return{snapshot:{unitID:x,rev:i[r(638)],type:ux.UNIVER_DOC,workbook:void 0,doc:i}}}async function Am(t,e,x,n,r){const s=_,i={},a={};if(!await Promise[s(788)](Object.entries(e.sheets)[s(500)](async([c,l])=>{const u=s,f={id:l.id,type:Pa.GRID,name:l.name,rowCount:l[u(782)],columnCount:l[u(468)],originalMeta:io(l)};if(a[c]=f,l.cellData){const b=jr(l[u(546)]),h=await Promise.all(b[u(500)](p=>r.saveSheetBlock(t,{unitID:x,type:ux[u(497)],block:p})));if(h[u(503)](p=>{const I=u;var v;return((v=p.error)==null?void 0:v[I(540)])!==Dn.OK}))return!1;i[c]={sheetID:c,blocks:h[u(500)](p=>p[u(482)])}}return!0})))throw new Error(s(809));const o=ao(e),d={unitID:e.id,rev:n,creator:"",name:e[s(813)],sheetOrder:e[s(821)],sheets:a,blockMeta:i,resources:e[s(407)]||[],originalMeta:o};return{snapshot:{unitID:x,rev:d.rev,type:ux[s(497)],workbook:d,doc:void 0}}}async function Vm(t,e,x,n){const r=_,s={};if(!await Promise[r(788)](Object[r(507)](e.sheets)[r(500)](async([i,a])=>{const o=r;if(a.cellData){const d=jr(a[o(546)]),c=await Promise[o(788)](d.map(l=>n[o(381)](t,{unitID:x,type:ux[o(497)],block:l})));if(c[o(503)](l=>{const u=o;var f;return((f=l[u(817)])==null?void 0:f.code)!==Dn.OK}))return!1;s[i]={sheetID:i,blocks:c[o(500)](l=>l[o(482)])}}return!0})))throw new Error(r(809));return s}async function jm(t,e,x,n,r){const s=_;var i,a;const o={},d={};if(!await Promise[s(788)](Object[s(507)](e[s(454)])[s(500)](async([b,h])=>{const p=s,I={id:h.id,type:Pa[p(692)],name:h[p(813)],rowCount:h[p(782)],columnCount:h[p(468)],originalMeta:io(h)};if(d[b]=I,h[p(546)]){const v=jr(h.cellData),C=await Promise[p(788)](v[p(500)](w=>r[p(381)](t,{unitID:x,type:ux[p(497)],block:w})));if(C[p(503)](w=>{const y=p;var P;return((P=w[y(817)])==null?void 0:P[y(540)])!==Dn.OK}))return!1;o[b]={sheetID:b,blocks:C[p(500)](w=>w[p(482)])}}return!0})))throw new Error(s(809));const c=ao(e),l={unitID:e.id,rev:n,creator:"",name:e[s(813)],sheetOrder:e[s(821)],sheets:d,blockMeta:o,resources:e.resources||[],originalMeta:c},u={unitID:x,rev:l[s(638)],type:ux[s(497)],workbook:l,doc:void 0},f=await r[s(732)](t,{unitID:x,type:ux[s(497)],snapshot:u});if(v2(f.error))throw new Error(`transformWorkbookDataToSnapshot(): Failed to save snapshot.
ErrorCode: `+((i=f[s(817)])==null?void 0:i[s(540)])+":"+((a=f.error)==null?void 0:a[s(777)]));return{snapshot:u}}function Lm(t,e,x){const n=_,r=t[n(783)];if(!r)throw new Error("");const s={};Object[n(507)](r.sheets)[n(384)](([o,d])=>{const c=n,l=Gi(d[c(706)]);s[o]={id:d.id,name:d[c(813)],rowCount:d[c(782)],columnCount:d[c(468)],...l}});const i=new Map;e[n(384)](o=>{i[n(372)](o.id,o)}),r[n(450)]&&Object[n(507)](r[n(450)]).forEach(([o,d])=>{const c=n;var l;const u=s[o];u[c(546)]={};const f=[];(l=d[c(766)])==null||l.forEach(b=>{const h=c,p=i.get(b);if(p)f[h(442)](p);else throw new Error("")}),f.forEach(b=>{const h=c,p=Rm(b[h(685)]);Object[h(507)](p)[h(384)](([I,v])=>{const C=h,w=u[C(546)][+I]={};Object[C(507)](v)[C(384)](([y,P])=>{w[+y]=P})})})});const a=Gi(r[n(706)]);return{id:t[n(496)]||r.unitID,rev:t[n(638)]||r[n(638)],name:r[n(813)],sheetOrder:r[n(821)],appVersion:"",locale:ya.EN_US,sheets:s,styles:{},resources:r[n(407)]||[],...a}}function Hm(t){const e=_,x=t[e(551)];if(x==null)throw new Error(e(395));const{unitID:n,rev:r,name:s,originalMeta:i,resources:a=[]}=x,{body:o,documentStyle:d={},settings:c={},drawings:l={},drawingsOrder:u=[],tableSource:f={},headers:b={},footers:h={},lists:p={}}=Em(i);return{id:n,rev:r,locale:ya[e(801)],title:s,body:o,documentStyle:d,settings:c,drawings:l,drawingsOrder:u,resources:a,tableSource:f,headers:b,footers:h,lists:p}}async function Bm(t,e,x,n,r){const s=_;var i,a,o;const d={unitID:e.id,rev:n,creator:"",name:(i=e[s(501)])!=null?i:"",resources:e[s(407)]||[],originalMeta:oo(e)},c={unitID:x,rev:d[s(638)],type:ux[s(807)],workbook:void 0,doc:d},l=await r[s(732)](t,{unitID:x,type:ux[s(807)],snapshot:c});if(v2(l[s(817)]))throw new Error(s(513)+((a=l[s(817)])==null?void 0:a[s(540)])+":"+((o=l.error)==null?void 0:o[s(777)]));return{snapshot:c}}async function ap(t,e){const x=_,n=t[x(783)];if(!n)throw new Error("Workbook metadata is not available");const r=[],s=[];return Object[x(507)](n[x(450)])[x(384)](([i,a])=>{const o=x,d=a[o(766)][o(500)](async c=>{const l=o,u={unitID:n[l(496)],type:ux[l(497)],blockID:c},{block:f}=await e[l(577)]({},u);if(f)r[l(442)](f);else throw new Error(l(622))});s[o(442)](...d)}),await Promise[x(788)](s),r}var Gm=(t,e,x,n)=>{const r=_;for(var s=e,i=t[r(411)]-1,a;i>=0;i--)(a=t[i])&&(s=a(s)||s);return s},bt=(t,e)=>(x,n)=>e(x,n,t);const lo=Ca("univer.snapshot-server-service");let w2=class{constructor(e,x,n,r,s,i){const a=_;this[a(387)]=e,this[a(640)]=x,this[a(672)]=n,this[a(361)]=r,this[a(419)]=s,this[a(651)]=i}async loadSheet(e,x,n={metadata:{"Trace-Id":Wi()}}){const r=_;var s;const i=this[r(640)].getUnit(e,P0.UNIVER_SHEET);if(i)return i;const{snapshot:a,changesets:o,error:d}=await this[r(672)].getUnitOnRev(n,{unitID:e,type:ux[r(497)],revision:x});if(v2(d)||!a||!a.workbook){const I={...d};throw I[r(777)]=r(564)+(d==null?void 0:d[r(777)]),I}const c=(s=o==null?void 0:o[r(411)])!=null?s:0;if(x!==0&&a[r(638)]+c!==x)throw new Error("[SnapshotService]: wrong rev from the server!");const{workbook:l}=a,u=l[r(450)]?Object[r(507)](l[r(450)]).map(([I,v])=>{const C=r;var w,y;return(y=(w=v[C(766)])==null?void 0:w[C(500)](P=>P))!=null?y:[]})[r(456)]():[],f=(await Promise.all(u.map(I=>this[r(672)][r(416)](n,{unitID:e,type:ux[r(497)],blockID:I})[r(363)](v=>v[r(534)]))))[r(674)](I=>!!I),b=Lm(a,f),h=this[r(640)][r(396)](P0[r(497)],b),p=this[r(419)][r(611)][r(415)](this[r(419)].interceptor[r(460)]()[r(796)]);return o==null||o.forEach(I=>{const v=r;(I[v(790)]===null||I.mutations===void 0)&&(I[v(790)]=[]);const C=I.mutations[v(500)](w=>({id:w.id,params:JSON[v(475)](w[v(685)])}));({...I,mutations:p(C,null)||C})[v(790)][v(384)](w=>this[v(361)][v(623)](w.id,w[v(472)],{fromChangeset:!0})),this._revisionService[v(591)](e)}),h}async[_(446)](e,x,n={metadata:{"Trace-Id":Wi()}}){const r=_;var s;const{snapshot:i,changesets:a,error:o}=await this._snapshotServerService[r(614)](n,{unitID:e,type:ux[r(807)],revision:x});if(v2(o)||!i||!i[r(551)]){const u={...o};throw u[r(777)]=r(681),u}const d=(s=a==null?void 0:a[r(411)])!=null?s:0;if(x!==0&&i[r(638)]+d!==x)throw new Error(r(619));const c=Hm(i),l=this[r(640)].createUnit(P0.UNIVER_DOC,c);return a==null||a[r(384)](u=>{const f=r;(u.mutations===null||u[f(790)]===void 0)&&(u[f(790)]=[]),u[f(790)][f(500)](b=>({id:b.id,params:JSON[f(475)](b[f(685)])}))[f(384)](b=>this._commandService.syncExecuteCommand(b.id,b[f(472)],{fromChangeset:!0})),this[f(387)][f(591)](e)}),l}[_(362)](e,x){const n=_,r={...x[n(705)]()};x[n(406)]()[n(384)](i=>{r.sheets[i.getSheetId()]=R.deepClone(i.getSnapshot())});const s=this[n(651)].getResources(x[n(722)](),P0.UNIVER_SHEET);return r[n(407)]=s,r}saveDoc(e,x){const n=_,r={...x[n(705)]()},s=this[n(651)].getResources(x[n(722)](),P0[n(807)]);return r.resources=s,r}};w2=Gm([bt(0,q(g2)),bt(1,N0),bt(2,lo),bt(3,g0),bt(4,q(ro)),bt(5,q(q2))],w2);var Ym=Object.defineProperty;Object[_(768)];var Wm=(t,e,x)=>e in t?Ym(t,e,{enumerable:!0,configurable:!0,writable:!0,value:x}):t[e]=x,Qm=(t,e,x,n)=>{const r=_;for(var s=e,i=t[r(411)]-1,a;i>=0;i--)(a=t[i])&&(s=a(s)||s);return s},Qi=(t,e)=>(x,n)=>e(x,n,t),zm=(t,e,x)=>Wm(t,e+"",x);const Jm=_(495);let Ts=class extends kt{constructor(e=Bi,x,n){const r=_;super(),this._config=e,this[r(405)]=x,this[r(418)]=n;const{...s}=Rn({},Bi,this[r(711)]);this[r(418)].setConfig(pm,s)}onStarting(){const e=_;e1(this._injector,[[g2],[I2],[_2],[p2],[w2],[Fr,{useClass:Zs}],[ro]]),dn(this[e(405)],[[p2],[I2],[_2]])}};zm(Ts,"pluginName",Jm),Ts=Qm([X2(gn),Qi(1,q(Vx)),Qi(2,W0)],Ts);var Xm=(t,e,x,n)=>{for(var r=e,s=t.length-1,i;s>=0;s--)(i=t[s])&&(r=i(r)||r);return r},zi=(t,e)=>(x,n)=>e(x,n,t);let Ji=class{constructor(e,x){const n=_;this._snapshotServerService=e,this[n(714)]=x}async[_(362)](e,x,n,r,s){const i=_;return jm(e,s||this[i(714)][i(362)](e,r),x,n,this[i(672)])}async[_(820)](e,x,n,r){const s=_;return Vm(e,r||this[s(714)][s(362)](e,n),x,this[s(672)])}async[_(752)](e,x,n,r){return Am(e,this[_(714)].saveSheet(e,r),x,n,this._snapshotServerService)}async[_(656)](e,x,n,r){return $m(e,this._snapshotService.saveDoc(e,r),x,n)}async saveDoc(e,x,n,r,s){const i=_;return Bm(e,s||this._snapshotService[i(479)](e,r),x,n,this[i(672)])}};Ji=Xm([zi(0,lo),zi(1,q(w2))],Ji);const m=at;(function(t,e){const x=at,n=t();for(;;)try{if(parseInt(x(813))/1*(-parseInt(x(544))/2)+-parseInt(x(1068))/3*(-parseInt(x(839))/4)+parseInt(x(933))/5*(-parseInt(x(580))/6)+-parseInt(x(869))/7+parseInt(x(897))/8*(parseInt(x(732))/9)+-parseInt(x(471))/10*(parseInt(x(554))/11)+parseInt(x(861))/12===e)break;n.push(n.shift())}catch{n.push(n.shift())}})(S2,103506);var qm=Object.defineProperty,Km=(t,e,x)=>e in t?qm(t,e,{enumerable:!0,configurable:!0,writable:!0,value:x}):t[e]=x,L=(t,e,x)=>Km(t,typeof e!=m(695)?e+"":e,x),p0=(t=>(t[t[m(846)]=1]=m(846),t[t[m(699)]=2]=m(699),t[t[m(930)]=3]=m(930),t[t[m(530)]=4]=m(530),t[t[m(519)]=5]=m(519),t[t[m(478)]=6]=m(478),t[t[m(764)]=7]="stdDev",t[t[m(660)]=8]=m(660),t[t[m(516)]=9]="sum",t[t[m(655)]=10]=m(655),t[t.varp=11]=m(747),t))(p0||{}),Zm=(t=>(t[t[m(616)]=1]=m(616),t[t[m(929)]=2]=m(929),t[t.percentOfRowTotal=3]="percentOfRowTotal",t[t[m(899)]=4]="percentOfGrandTotal",t[t.percentOfParentColumnTotal=5]="percentOfParentColumnTotal",t[t[m(628)]=6]=m(628),t[t[m(907)]=7]=m(907),t[t[m(914)]=8]=m(914),t[t[m(1041)]=9]=m(1041),t[t[m(634)]=10]="percentDifferenceFrom",t[t[m(1057)]=11]=m(1057),t[t[m(711)]=12]=m(711),t[t.percentOf=13]="percentOf",t[t[m(1048)]=14]=m(1048),t))(Zm||{}),Kx=(t=>(t[t[m(484)]=1]=m(484),t[t[m(1037)]=2]=m(1037),t[t.NotFunction=3]="NotFunction",t[t[m(832)]=4]=m(832),t[t[m(741)]=5]="BadReference",t))(Kx||{}),$e=(t=>(t[t[m(694)]=1]=m(694),t[t[m(540)]=2]="ValueFilter",t[t[m(850)]=3]=m(850),t))($e||{}),e0=(t=>(t[t[m(843)]=1]=m(843),t[t[m(1024)]=2]=m(1024),t[t.Value=3]=m(601),t[t[m(592)]=4]=m(592),t[t.Hidden=5]=m(1049),t))(e0||{}),Fx=(t=>(t[t[m(829)]=-1]=m(829),t[t[m(843)]=1]=m(843),t[t[m(1024)]=2]=m(1024),t))(Fx||{}),R0=(t=>(t[t.text=1]=m(931),t[t.number=2]=m(681),t[t[m(505)]=3]="boolean",t[t.date=4]="date",t[t[m(902)]=5]=m(902),t[t.other=6]=m(575),t))(R0||{}),x8=(t=>(t[t[m(560)]=1]=m(560),t[t[m(723)]=2]=m(723),t))(x8||{}),we=(t=>(t[t.ascending=1]="ascending",t[t.descending=2]="descending",t[t.custom=3]=m(495),t))(we||{}),Ce=(t=>(t[t[m(808)]=1]=m(808),t[t.captionBetween=2]=m(685),t[t[m(659)]=3]=m(659),t[t.captionEndsWith=4]=m(503),t[t[m(498)]=5]=m(498),t[t[m(880)]=6]=m(880),t[t[m(504)]=7]=m(504),t[t[m(591)]=8]=m(591),t[t[m(905)]=9]=m(905),t[t[m(812)]=10]=m(812),t[t[m(720)]=11]=m(720),t[t[m(474)]=12]=m(474),t[t.captionNotEndsWith=13]="captionNotEndsWith",t[t[m(547)]=14]=m(547),t[t[m(699)]=15]=m(699),t[t[m(553)]=16]="dateBetween",t[t[m(571)]=17]="dateEqual",t[t[m(1074)]=18]=m(1074),t[t[m(1061)]=19]="dateNewerThanOrEqual",t[t[m(1046)]=20]="dateNotBetween",t[t[m(1072)]=21]=m(1072),t[t.dateOlderThan=22]=m(566),t[t[m(763)]=23]=m(763),t[t[m(640)]=24]=m(640),t[t[m(1004)]=25]=m(1004),t[t[m(469)]=26]=m(469),t[t[m(676)]=27]="lastYear",t[t.M1=28]="M1",t[t.M10=29]=m(854),t[t[m(510)]=30]="M11",t[t[m(757)]=31]="M12",t[t.M2=32]="M2",t[t.M3=33]="M3",t[t.M4=34]="M4",t[t.M5=35]="M5",t[t.M6=36]="M6",t[t.M7=37]="M7",t[t.M8=38]="M8",t[t.M9=39]="M9",t[t[m(816)]=40]=m(816),t[t[m(648)]=41]=m(648),t[t[m(798)]=42]=m(798),t[t[m(773)]=43]=m(773),t[t[m(825)]=44]="percent",t[t.Q1=45]="Q1",t[t.Q2=46]="Q2",t[t.Q3=47]="Q3",t[t.Q4=48]="Q4",t[t[m(516)]=49]=m(516),t[t[m(729)]=50]=m(729),t[t[m(954)]=51]=m(954),t[t[m(556)]=52]=m(556),t[t.thisYear=53]=m(598),t[t[m(982)]=54]=m(982),t[t.tomorrow=55]=m(1065),t[t.unknown=56]=m(674),t[t.valueBetween=57]="valueBetween",t[t[m(488)]=58]=m(488),t[t[m(944)]=59]=m(944),t[t[m(748)]=60]=m(748),t[t[m(906)]=61]=m(906),t[t[m(913)]=62]=m(913),t[t[m(1005)]=63]=m(1005),t[t[m(837)]=64]=m(837),t[t[m(1011)]=65]="yearToDate",t[t[m(1002)]=66]=m(1002),t))(Ce||{}),uo=(t=>(t[t[m(502)]=1]=m(502),t[t[m(835)]=2]=m(835),t[t[m(1043)]=3]=m(1043),t))(uo||{}),vn=(t=>(t[m(642)]=m(642),t[m(1010)]=m(1010),t))(vn||{}),ue=(t=>(t[t.defaultNormalField=1]=m(966),t[t[m(803)]=2]=m(803),t[t[m(683)]=3]="dateGroupField",t[t[m(703)]=4]=m(703),t[t[m(776)]=5]=m(776),t))(ue||{}),C0=(t=>(t[m(809)]=m(872),t[m(867)]=m(735),t[m(893)]=m(868),t.Date=m(992),t[m(518)]=m(1062),t[m(986)]=m(920),t[m(1014)]=m(834),t[m(849)]=m(532),t[m(636)]=m(926),t.YearQuarter=m(781),t.YearMonthDate=m(1029),t))(C0||{}),Lr=(t=>(t[m(1013)]="date1900",t[m(964)]="date1904",t))(Lr||{}),xx=(t=>(t[t[m(1039)]=0]=m(1039),t[t[m(578)]=1]="SetSubtotalType",t[t[m(1076)]=2]=m(1076),t[t[m(579)]=3]=m(579),t[t[m(988)]=4]=m(988),t[t[m(645)]=5]=m(645),t[t[m(1056)]=6]=m(1056),t[t[m(987)]=7]=m(987),t[t[m(663)]=8]=m(663),t[t[m(535)]=9]=m(535),t[t[m(956)]=10]="SetCollapse",t[t[m(945)]=11]=m(945),t[t.SetValueFilter=12]=m(513),t))(xx||{}),Cn=(t=>(t[t[m(902)]=2]="blank",t[t[m(992)]=4]=m(992),t[t.other=8]=m(575),t))(Cn||{}),A0=(t=>(t[t.FilterAll=1]="FilterAll",t[t.FilterPartial=2]=m(799),t[t[m(787)]=3]=m(787),t[t[m(862)]=4]=m(862),t[t[m(806)]=5]=m(806),t[t[m(677)]=6]=m(677),t[t[m(857)]=7]="FilteredSortDesc",t[t[m(670)]=8]=m(670),t[t[m(1059)]=9]="FilterNoneSortAsc",t[t[m(531)]=10]=m(531),t[t.Collapse=11]=m(815),t[t.Expand=12]=m(991),t[t.Subtotal=13]=m(651),t[t.GrandTotal=14]=m(567),t[t[m(647)]=15]="MultipleGrandTotal",t))(A0||{});const sx={TUPLE_PLACEHOLDER:"-&&-",TUPLE_FIELD_SEPARATOR:m(821),COl_ROOT_PATH:m(755),ROW_ROOT_PATH:"-$-rr-$-",BLANK_PLACEHOLDER:m(847),isDev:!1,defaultSortType:"default",dateSystem:Lr[m(1013)],maxLimitItemCount:1e3,otherDataKey:m(918)};function fo(t){const e=m,{operator:x,expected:n}=t;switch(x){case Ce[e(967)]:return r=>r>=n[0]&&r<=n[1];case Ce.valueEqual:return r=>r===n;case Ce[e(944)]:return r=>r>n;case Ce[e(748)]:return r=>r>=n;case Ce[e(906)]:return r=>r<n;case Ce.valueLessThanOrEqual:return r=>r<=n;case Ce[e(1005)]:return r=>r<n[0]||r>n[1];case Ce[e(837)]:return r=>r!==n;default:return console.error(e(780)+x),r=>!0}}function e8(t){return typeof t==m(681)}let wn=class{constructor(){const e=m;L(this,e(565),0),L(this,e(881),0),L(this,e(830),0),L(this,"_product",1),L(this,e(611),Number[e(577)]),L(this,e(523),Number[e(1031)]),L(this,"_squareSum",0)}[m(885)](){const e=m;return{sum:this[e(565)],count:this._count,countN:this._countN,product:this[e(1053)],min:this._min,max:this[e(523)],squareSum:this[e(1032)]}}reset(){const e=m;this[e(565)]=0,this[e(881)]=0,this._countN=0,this[e(1053)]=1,this[e(611)]=Number[e(577)],this[e(523)]=Number.NEGATIVE_INFINITY,this[e(1032)]=0}addValue(e){const x=m;e8(e)&&(this._sum+=e,this[x(830)]+=1,this[x(1053)]*=e,this[x(611)]=Math[x(519)](this[x(611)],e),this[x(523)]=Math[x(530)](this._max,e),this._squareSum+=e*e),this[x(881)]+=1}[m(873)](e){const x=m;for(const n of e)this[x(565)]+=n[x(565)],this[x(881)]+=n[x(881)],this._countN+=n[x(830)],this[x(1053)]*=n[x(1053)],this[x(611)]=Math[x(519)](this[x(611)],n[x(611)]),this[x(523)]=Math[x(530)](this[x(523)],n._max),this[x(1032)]+=n._squareSum}[m(576)](e){const x=m;this._sum+=e[x(516)],this[x(881)]+=e[x(699)],this[x(830)]+=e.countN,this[x(1053)]*=e[x(478)],this[x(611)]=Math[x(519)](this[x(611)],e[x(519)]),this[x(523)]=Math.max(this[x(523)],e[x(530)]),this[x(1032)]+=e[x(1071)]}[m(468)](e){const x=m;switch(e){case p0[x(516)]:return this[x(565)];case p0[x(699)]:return this[x(881)];case p0[x(930)]:return this._countN;case p0[x(478)]:return Number[x(653)](this[x(1053)])?this[x(1053)]:{errorType:Kx.NotNumber};case p0[x(519)]:return this[x(830)]>0?this[x(611)]:0;case p0[x(530)]:return this[x(830)]>0?this[x(523)]:0;case p0.average:return this[x(881)]>0?this[x(565)]/this[x(881)]:{errorType:Kx[x(484)]};case p0.stdDev:return this._count>0?Math.sqrt(Math[x(530)](0,(this._count*this[x(1032)]-this._sum*this[x(565)])/(this[x(881)]*(this[x(881)]-1)))):{errorType:Kx[x(484)]};case p0.stdDevp:return this._count>0?Math.sqrt(Math[x(530)](0,(this[x(881)]*this[x(1032)]-this[x(565)]*this[x(565)])/(this[x(881)]*this[x(881)]))):{errorType:Kx[x(484)]};case p0[x(655)]:return this._count>0?Math[x(530)](0,(this[x(881)]*this[x(1032)]-this[x(565)]*this[x(565)])/(this[x(881)]*(this[x(881)]-1))):{errorType:Kx.Div0};case p0.varp:return this[x(881)]>0?Math.max(0,(this[x(881)]*this[x(1032)]-this._sum*this[x(565)])/(this[x(881)]*this[x(881)])):{errorType:Kx[x(484)]}}}};function yt(t){return t?t.v!==void 0:!1}function Xi(t){return t==null||t===""}function vt(t){const e=m;return t===e0[e(1024)]||t===e0.Column||t===e0.Filter||t===e0[e(1049)]}function at(t,e){const x=S2();return at=function(n,r){return n=n-466,x[n]},at(t,e)}function qi(t){const e=m;return t===e0[e(1024)]||t===e0[e(843)]}function Zt(t,e){const x=m;let n="";switch(e){case p0.average:n=x(623)+t;break;case p0.count:n="Count of "+t;break;case p0.countNums:n=x(669)+t;break;case p0[x(530)]:n="Max of "+t;break;case p0[x(519)]:n=x(705)+t;break;case p0[x(478)]:n=x(1016)+t;break;case p0[x(764)]:n=x(500)+t;break;case p0[x(660)]:n=x(756)+t;break;case p0[x(516)]:n="Sum of "+t;break;case p0[x(655)]:n=x(618)+t;break;case p0[x(747)]:n="Population Variance of "+t;break;default:n=t;break}return n}function t8(t,e,x){var n;const r=typeof t[e]=="boolean";return x!==void 0?r?t[e]:(n=t[e])==null?void 0:n[x]:r?t[e]:!1}function P2(t){const e=m;return t[e(774)]===$e[e(850)]}function mo(t){const e=m;return t[e(774)]===$e[e(694)]}function He(t){const e=m;let x="";for(let n=0;n<t;n++){const r=Math[e(520)](Math[e(1067)]()*16);x+=r[e(877)](16)}return x.toUpperCase()}function n8(t,e){const x=m;let n=0,r=0;const s=[];for(;n<t[x(1015)]&&r<e[x(1015)];)t[n]===e[r]?(s[x(961)](t[n]),n++,r++):t[n]<e[r]?n++:r++;return s}function s8(t){const e=m;if(t.length===0)return[];if(t[e(1015)]===1)return t[0];let x=t[0];for(let n=1;n<t[e(1015)];n++)x=n8(x,t[n]);return x}function Yn(t,e,x){const n=m;t[n(680)]||(t[n(680)]={}),e&&!e[n(680)]&&(e.summary={});for(const r in x){const s=x[r][n(820)],i=t[n(939)][r],a=i.getInfo(),{sum:o,count:d,countN:c,product:l,min:u,max:f,squareSum:b}=a;for(const h of s)a[h]=i.getSubtotal(h);t[n(680)][r]=a,e&&(e[n(939)][r]||(e.tuple[r]=new wn),e[n(939)][r].unionTupleInfo({sum:o,count:d,countN:c,product:l,min:u,max:f,squareSum:b}))}}function Ki(t){const e=m;let x=A0[e(1018)],n;return t?(P2(t)&&(t[e(558)][e(1015)]===1&&(x=A0[e(787)],n=t[e(558)][0]),t[e(542)]===!0?x=A0[e(1018)]:x=A0.FilterPartial),{value:n,status:x}):{status:x,value:n}}function bo(t,e,x){const n=m;let r=!1;if(t&&(P2(t)&&t[n(558)][n(1015)]>0&&t.isAll!==!0&&(r=!0),mo(t)&&(r=!0),x&&(r=!0)),r)switch(e==null?void 0:e[n(774)]){case we[n(467)]:return A0.FilteredSortAsc;case we.descending:return A0[n(857)];default:return A0[n(806)]}else switch(e==null?void 0:e.type){case we[n(467)]:return A0.FilterNoneSortAsc;case we.descending:return A0[n(531)];default:return A0[n(670)]}}function ho(t,e,x){const n=m,r=e||0,s=t[n(863)](",");return x?s+"-"+String(r):s}let r8=class{constructor(){L(this,m(637)),this._heap=[]}[m(961)](e){const x=m;this._heap[x(961)](e),this._bubbleUp()}[m(1051)](){const e=m;if(this.size()===0)return;const x=this[e(637)][0],n=this[e(637)][e(1051)]();return this[e(1063)]()>0&&n&&(this[e(637)][0]=n,this._bubbleDown()),x}[m(1063)](){const e=m;return this[e(637)][e(1015)]}[m(607)](){const e=m;let x=this[e(1063)]()-1;for(;x>0;){const n=Math[e(520)]((x-1)/2);if(this[e(637)][n][0]<=this._heap[x][0])break;[this._heap[n],this[e(637)][x]]=[this[e(637)][x],this[e(637)][n]],x=n}}[m(541)](){const e=m;let x=0;const n=this.size(),r=this[e(637)][0];for(;;){const s=2*x+1,i=2*x+2;let a,o,d=null;if(s<n&&(a=this[e(637)][s],a[0]<r[0]&&(d=s)),i<n&&(o=this[e(637)][i],(d===null&&o[0]<r[0]||d!==null&&o[0]<a[0])&&(d=i)),d===null)break;[this[e(637)][x],this._heap[d]]=[this[e(637)][d],this[e(637)][x]],x=d}}};function Zi(t){const e=m,x=new r8,n=[];for(let r=0;r<t[e(1015)];r++)t[r].length>0&&x[e(961)]([t[r][0],r,0]);for(;x.size()>0;){const[r,s,i]=x[e(1051)]();if(n.push(r),i+1<t[s][e(1015)]){const a=t[s][i+1];x[e(961)]([a,s,i+1])}}return n}function i8(){const t=m;return Intl&&Intl[t(788)]?new Intl.Collator(void 0,{numeric:!1})[t(891)]:(e,x)=>e[t(635)](x)}function a8(t,e,x){const n=m,r=[],s=[],i=[],a=[];for(let u=0;u<t[n(1015)];u++){const f=t[u],b=e[u];b===R0[n(681)]?r[n(961)](f):b===R0[n(931)]?s[n(961)](f):b===R0[n(992)]?i[n(961)](f):a[n(961)](f)}const o=i8();r[n(692)]((u,f)=>Number(u)-Number(f)),s[n(692)](o),i[n(692)]((u,f)=>Number(u)-Number(f)),a[n(692)](o);const d=[...r,...s,...i,...a],c={};let l=0;for(const u of d)c[u]=l,l++;return c}function o8(t,e,x){const n=m,r={type:$e[n(694)],operator:e,expected:x},s=fo(r),i=[];for(const[a,o]of Object.entries(t)){const d=Number(a);s(d)&&i[n(961)](o)}return i}function d8(t,e,x,n,r,s){const i=m,a=(e==null?void 0:e[i(939)][x])||t[r][i(939)],o=a[i(885)]();t[r]={tuple:a},t[s]===void 0&&(t[s]={tuple:new wn}),t[s][i(939)][i(576)](o)}function c8(t){return typeof t!=m(681)}function l8(t){const e=m;return!(e(970)in t)&&!(e(960)in t)&&e(619)in t&&t.type===we[e(495)]}function xr(t,e=!0){const x=m,n=e?new Date(Date.UTC(1899,11,30)):new Date(Date.UTC(1904,0,1)),r=86400*1e3;return n[x(722)]()+t*r}function u8(t){const e=m;return t[e(946)]()===ue[e(683)]}function y2(t){const e=m;return t[e(946)]()!==ue[e(966)]}function f8(t){const e=m;return t[e(1030)]!==ue[e(966)]}function m8(t){const e=m;return t[e(1030)]===ue[e(683)]}function b8(t,e,x=!0){const n=m,r=xr(t,x),s=new Date(r);switch(e){case C0.Year:return""+s[n(573)]();case C0[n(518)]:return""+(s[n(727)]()+1);case C0[n(824)]:return""+s[n(559)]();case C0[n(867)]:return""+s[n(511)]();case C0[n(809)]:return""+s[n(896)]();case C0[n(1014)]:return""+(Math[n(520)](s[n(727)]()/3)+1);case C0.HourMinute:return s.getHours()+"_"+s.getMinutes();case C0[n(636)]:return s[n(573)]()+"_"+(s.getMonth()+1);case C0.YearQuarter:return s[n(573)]()+"_"+(Math[n(520)](s[n(727)]()/3)+1);case C0[n(950)]:return s[n(573)]()+"_"+(s[n(727)]()+1)+"_"+s.getDate()}return""}let Nt=class{constructor(e,x,n){const r=m;L(this,"id"),L(this,"name"),L(this,r(522)),L(this,r(546)),L(this,r(492),[]),L(this,"items",[]),L(this,r(1001),[]),L(this,r(552),R0[r(931)]),L(this,r(895),!1),L(this,"hasDecimal",!1),L(this,"hasDate",!1),L(this,r(844),!1),L(this,r(928),!1),L(this,r(538),""),L(this,r(563),Number[r(940)]),L(this,"minNumber",Number[r(940)]),L(this,r(743),Number[r(1031)]),L(this,r(737),Number[r(577)]),L(this,r(656)),L(this,r(550),{}),L(this,r(761),0),this.id=e,this[r(627)]=x,this[r(522)]=n,this[r(656)]={}}getRangeKey(){return this[m(546)]}[m(915)](){return this[m(538)]}[m(501)](e){const x=m;this[x(546)]=e}[m(936)](){return this.id}[m(974)](){return this.name}[m(1035)](e){const x=m;this[x(627)]=e}getFieldDataType(){const e=m;return this[e(770)]&&!this[e(928)]&&!this[e(517)]&&!this[e(895)]?R0[e(992)]:(this.hasDecimal||this.hasInteger)&&!this[e(928)]&&!this[e(770)]?R0[e(681)]:this[e(552)]}getDataFieldType(){return ue[m(966)]}[m(957)](e){const x=m;return this[x(522)]+sx[x(1064)]+this[x(550)][e]}[m(740)](e){const x=m,n=this[x(492)][e];if(yt(n))return String(n.v);if(Xi(n))return sx[x(1009)];const r=String(n);return this[x(550)][r]===void 0?sx[x(1055)]:r}[m(724)](e){return this[m(1001)][this._itemsMap[e]]}[m(593)](e){return this.records[e]}[m(555)](e,x){const n=m;yt(e)&&(this.format=e.f,this[n(491)](e,x));const r=Xi(e);r&&this[n(1073)](x),typeof e==n(681)&&this._updateNumberItemKey(e,x),!r&&typeof e==n(543)&&this[n(998)](e,x),this[n(492)][n(961)](e)}[m(1008)](e){return this[m(656)][e]||[]}getAllIndexMap(){return this[m(656)]}[m(491)](e,x){const n=m;this.hasDate||(this.hasDate=!0),this[n(743)]=Math.max(this[n(743)],e.v),this[n(737)]=Math[n(519)](this[n(737)],e.v);const r=String(e.v);this[n(1007)](r,x,R0[n(992)])}[m(1073)](e){const x=m;this[x(844)]||(this[x(844)]=!0);const n=sx[x(1009)];this._itemIndexMap[n]===void 0?(this._itemIndexMap[n]=[e],this.items[x(961)](n),this[x(1001)][x(961)](R0[x(902)]),this[x(550)][n]=this[x(959)][x(1015)]-1):this[x(656)][n][x(961)](e)}[m(998)](e,x){const n=m;this[n(928)]||(this.hasText=!0),this[n(1007)](e,x,R0[n(931)])}_updateNumberItemKey(e,x){const n=m;this[n(517)]||(this[n(517)]=e%1!==0),this[n(895)]||(this[n(895)]=e%1===0),this.maxNumber=Math[n(530)](this[n(563)],e),this.minNumber=Math[n(519)](this[n(771)],e);const r=String(e);this[n(1007)](r,x,R0[n(681)])}[m(668)](e){const x=m;if(this[x(656)][sx[x(1055)]]===void 0){this._itemIndexMap[sx[x(1055)]]=[e];const n=this[x(959)].push(sx[x(1055)]);this[x(550)][sx[x(1055)]]=n-1,this[x(1001)][x(961)](R0[x(575)]),this[x(761)]++}else this._itemIndexMap[sx.otherDataKey][x(961)](e)}[m(1007)](e,x,n){const r=m;if(this[r(656)][e]===void 0){if(this[r(761)]>=sx[r(485)])return this[r(668)](x);this._itemIndexMap[e]=[x];const s=this.items.push(e);this[r(550)][e]=s-1,this.itemTypes[r(961)](n),this._keyCounter++}else this[r(656)][e][r(961)](x)}[m(826)](){return this[m(550)]}getFieldInfo(){const e=m;return{id:this.id,name:this[e(627)],records:this[e(492)],fieldDataType:this[e(552)],maxNumber:this[e(563)],minNumber:this[e(771)],maxDate:this.maxDate,minDate:this[e(737)],format:this[e(538)],rangeKey:this[e(546)],dataFieldType:this.getDataFieldType()}}toJSON(){const e=m;return{id:this.id,name:this[e(627)],fieldDataType:this[e(977)](),hexCode:this[e(522)],rangeKey:this[e(546)],dataFieldType:this[e(946)]()}}[m(525)](e){const x=m;this[x(627)]=e[x(627)],this.id=e.id,this[x(546)]=e[x(546)],this[x(522)]=e[x(522)]}reset(){const e=m;this[e(492)]=[],this[e(959)]=[],this[e(1001)]=[],this._itemIndexMap={},this[e(895)]=!1,this[e(517)]=!1,this.hasDate=!1,this[e(844)]=!1,this[e(928)]=!1,this[e(538)]="",this[e(563)]=Number[e(940)],this.minNumber=Number[e(940)],this[e(743)]=Number[e(1031)],this[e(737)]=Number[e(577)],this._itemsMap={},this[e(761)]=0}},h8=class extends Nt{constructor(){super(...arguments),L(this,"originalFieldId")}[m(807)](){const e=m;return{...super.getFieldInfo(),originalFieldId:this[e(514)](),dataFieldType:this[e(946)]()}}toJSON(){return{...super.toJSON(),originalFieldId:this.originalFieldId}}},Hr=class extends h8{constructor(e,x,n,r,s){const i=m;super(e,x,n),L(this,i(734),!0),L(this,"_dateType"),this.originalFieldId=r,this[i(1034)]=s??C0[i(849)]}[m(624)](e){const x=m;this[x(1034)]=e}getDateType(){return this[m(1034)]}[m(865)](){return this[m(734)]}[m(855)](e){const x=m;this[x(768)]();const n=e[x(492)],r=sx[x(665)]===Lr[x(1013)];for(let s=0;s<n[x(1015)];s++){const i=n[s];if(i==null)continue;if(!yt(i)){this._dataIsValid=!1;break}const a=i.v,o=b8(a,this[x(1034)],r);this[x(555)](o,s)}}[m(949)](){return{type:ue[m(683)],dateType:this._dateType}}[m(946)](){return ue.dateGroupField}getOriginFieldId(){return this[m(667)]}[m(807)](){const e=m;return{...super[e(807)](),dateType:this[e(1034)],originalFieldId:this[e(667)]}}toJSON(){const e=m;return{...super[e(935)](),dateType:this._dateType,originalFieldId:this.originalFieldId}}[m(525)](e){const x=m;var n;super[x(525)](e),this[x(1034)]=(n=e==null?void 0:e[x(874)])!=null?n:C0[x(849)],this[x(667)]=e[x(667)]}};class R2{constructor(e){const x=m;L(this,x(696),[]),L(this,x(848),{}),L(this,x(876),{}),L(this,x(581)),L(this,x(738)),L(this,"host"),this[x(497)]=e}[m(972)](){const e=m;return this[e(696)][e(754)]()}getFieldDisplayNames(){const e=m;return this.getFieldIds()[e(666)](x=>this.getDisplayName(x))}[m(866)](e){const x=m;for(const n of this[x(696)])if(this[x(851)](n)===e)return n}[m(603)](){const e=m,x=new Map;for(const n of this.fieldIds){const r=this[e(818)](n);y2(r)&&x[e(631)](r[e(514)](),r.id)}return x}[m(841)](e){const x=m,n=[],r=this[x(603)]();for(const s of e){const i=this[x(818)](s);if(i){if(y2(i))continue;if(r[x(716)](i.id)){const a=r[x(586)](i.id);a&&n[x(961)]([a,i.id])}}}return n}[m(472)](e){return this[m(696)].includes(e)}[m(614)](e){const x=m;return this[x(696)][x(590)](n=>this[x(818)](n)[x(627)]===e)}setRange(e){const x=m;e&&(this[x(581)]={...e})}addField(e,x){const n=m;this[n(696)][n(961)](e);const r=this[n(883)](x);this[n(848)][e]=r}[m(597)](e){const x=m,n=this[x(696)][x(937)](e);n!==-1&&(this[x(696)][x(704)](n,1),delete this[x(848)][e])}getDisplayName(e){const x=m,n=this[x(848)][e];return n!==void 0?n:this[x(818)](e)[x(974)]()}[m(708)](e,x,n){const r=m;this[r(848)][e]=this[r(883)](x,n)}[m(883)](e,x){const n=m,r=x||this[n(848)],s=new Set(Object.values(r));let i=e,a=1;if(!s[n(716)](i))return i;for(;;){if(i=e+"("+a+")",!s[n(716)](i))return i;a++}}updateAllDisplayName(){const e=m,x={};for(const n of this[e(696)])x[n]=this[e(883)](this[e(818)](n).getName(),x);this[e(848)]=x}getFieldById(e){const x=m;return this.customFields[e]?this[x(876)][e]:this.host[x(629)][e]}[m(490)](e){const x=m;this[x(738)]=e}[m(515)](){return this[m(738)]}[m(879)](e){const x=m;for(const n of this.fieldIds)if(this[x(818)](n).name===e)return this[x(818)](n)}[m(807)](){const e=m,x=this[e(696)][e(666)](r=>this[e(818)](r).getFieldInfo()),n=Object[e(971)](this[e(876)])[e(666)](r=>this[e(876)][r][e(807)]());return x[e(754)](n)}[m(935)](){const e=m,x={};for(const n of this.fieldIds)x[n]=this[e(818)](n)[e(935)]();return{fields:x,fieldIds:this[e(696)][e(754)](),displayNameRecord:{...this[e(848)]},customFields:Object[e(971)](this[e(876)])[e(666)](n=>this[e(876)][n][e(935)]()),dataRecordCount:this.dataRecordCount,range:this.range}}[m(525)](e){const x=m;this.fieldIds=e[x(696)][x(754)](),this.displayNameRecord=e[x(848)]?{...e.displayNameRecord}:{};const n=e.fields;for(const r in n){if(this[x(497)][x(629)][r])continue;const s=new Nt(r,n[r][x(627)],n[r][x(522)]);s[x(525)](n[r]),this[x(497)][x(629)][r]=s}this[x(876)]={};for(const r of e.customFields){const{id:s,name:i,hexCode:a}=r,o=new Nt(s,i,a);o[x(525)](r),this.customFields[o.id]=o}this[x(738)]=e[x(738)],this[x(581)]=e.range}dispose(){const e=m;this[e(696)]=[],this[e(876)]={},this[e(738)]=0,delete this[e(497)]}}let p8=class{constructor(){const e=m;L(this,e(629),{}),L(this,e(775),{})}createDataFieldId(){const e=m,x=He(5);return this[e(629)][x]?this[e(858)]():x}[m(476)](){return null}getNoUsedDataFieldIds(e){const x=m,n=this[x(775)][e][x(972)](),r=new Set;for(const s in this[x(775)])if(s!==e){const i=this[x(775)][s][x(972)]();for(const a of i)r[x(952)](a)}return n[x(1036)](s=>!r[x(716)](s))}[m(925)](e,x){const n=m;this[n(775)][e]=new R2(this);const{header:r,data:s}=this.getRangeData(x),i=this[n(775)][e],a=[];for(const d of r){const c=this[n(858)](),l=new Nt(c,d,He(3));this[n(629)][c]=l,i.fieldIds[n(961)](c),a.push(l)}let o=0;for(const d of s){let c=0;for(const l of a)l[n(555)](d[c],o),c++;o++}return i.setDataRecordCount(s[n(1015)]),i}dispose(){const e=m;for(const x in this.collections)this[e(775)][x][e(646)]();this.collections={},this.dataFields={}}[m(935)](){const e=m,x={};for(const r in this[e(775)])x[r]=this[e(775)][r][e(935)]();const n={};for(const r in this[e(629)])n[r]=this[e(629)][r][e(935)]();return{collections:x,dataFields:n}}[m(594)](e,x,n,...r){const s=m;this[s(775)][e]=x,x[s(715)](n)}[m(525)](e){const x=m;for(const n in e[x(775)]){const r=new R2(this);r.fromJSON(e[x(775)][n]),this[x(594)](n,r,r[x(581)])}for(const n in e.dataFields){const{id:r,name:s,hexCode:i}=e[x(629)][n],a=e[x(629)][n];if(f8(a)){const{dataFieldType:o}=a;let d;if(o===ue.dateGroupField){const{originalFieldId:c}=a;d=new Hr(r,s,i,c)}d&&(d[x(525)](e.dataFields[n]),this[x(629)][n]=d)}else{const o=new Nt(r,s,i);o[x(525)](a),this[x(629)][n]=o}}}},Xx=class{constructor(){const e=m;L(this,e(1077),new _8),L(this,"rowView",new I8),L(this,"colView",new g8),L(this,"dataView",new E2),L(this,e(921),new E2),L(this,e(728)),L(this,"formatMap",{}),L(this,e(1050),{}),this[e(779)]()}[m(779)](e){const x=m;e===void 0&&(this[x(728)]=Math[x(520)](1e3*Math.random()))}[m(494)](e){const x=m;this[x(1050)]=e}[m(760)](e){const x={};e.iterateField(n=>{const r=at,s=n[r(524)]();s&&(x[n.id]=s)}),this.formatMap=x}getVersion(){return this.version}[m(935)](){const e=m,x={...this[e(766)]};return{pageView:this.pageView.toJSON(),rowView:this[e(690)][e(935)](),colView:this[e(691)][e(935)](),dataView:this[e(989)].toJSON(),cornerView:this[e(921)][e(935)](),version:this[e(728)],groupInfo:this[e(1050)],formatMap:x}}formJSON(e){const x=m;this.pageView[x(525)](e[x(1077)]),this[x(690)].fromJSON(e[x(690)]),this.colView[x(525)](e[x(691)]),this[x(989)][x(525)](e[x(989)]),this.cornerView[x(525)](e.cornerView),this[x(728)]=e[x(728)],this[x(766)]={...e[x(766)]},this.groupInfo=e.groupInfo}},E2=class{constructor(){const e=m;L(this,e(710),0),L(this,e(702),0),L(this,e(709),{}),L(this,e(1080),[]),L(this,e(561),-1),L(this,e(602),-1)}[m(562)](){return this.lastCol}[m(1003)](){return this[m(602)]}[m(587)](e,x,n){const r=m,s=this[r(657)](e,x);this[r(561)]=Math.max(this[r(561)],x),this[r(602)]=Math.max(this[r(602)],e),s.v=n}[m(730)](e,x,n){const r=this.getCell(e,x);r.s=n}setBlank(e,x){const n=m,r=this[n(657)](e,x);r.t=Cn[n(902)]}[m(923)](e,x){const n=m,r=this[n(657)](e,x);r.t=Cn[n(575)]}[m(657)](e,x){const n=m;return this[n(709)][e]||(this[n(709)][e]={}),this.data[e][x]||(this[n(709)][e][x]={}),this[n(709)][e][x]}[m(924)](e,x){this.info[e]=x}[m(617)](e){const x=m,n={};let r=0;return this[x(1080)].forEach(s=>{const i=x,a=ho(s[i(742)],s[i(962)],e);n[a]=r,r++}),n}[m(804)](e){const x=m;this[x(710)]=e}[m(539)](e){const x=m;this[x(702)]=e}[m(475)](){return this[m(710)]}getColCount(){return this.colCount}getValue(e,x){const n=m;var r,s;return(s=(r=this[n(709)][e])==null?void 0:r[x])==null?void 0:s.v}[m(976)](e,x){const n=m;var r,s;return(s=(r=this[n(709)][e])==null?void 0:r[x])==null?void 0:s.s}[m(935)](){const e=m,x=this[e(709)],n=this[e(1080)][e(666)](r=>({...r,paths:r[e(742)].concat()}));return{data:x,info:n,rowCount:this.rowCount,colCount:this.colCount,lastCol:this.lastCol,lastRow:this[e(602)]}}[m(525)](e){const x=m;this.data=e[x(709)],this[x(1080)]=e[x(1080)][x(666)](n=>({...n,paths:n[x(742)][x(754)]()})),this[x(710)]=e[x(710)],this[x(702)]=e.colCount,this[x(561)]=e[x(561)],this[x(602)]=e[x(602)]}};class _8 extends E2{constructor(){const e=m;super(...arguments),L(this,e(632),[]),L(this,e(561),-1),L(this,e(602),-1)}[m(777)](e,x,n){const r=m,s=this[r(657)](e,x);s.i=n}addRange(e){const x=m;this[x(632)][x(961)](e)}[m(997)](){return this[m(632)]}[m(739)](e){const x=m;this[x(561)]=e}[m(744)](e){const x=m;this[x(602)]=e}[m(562)](){return this[m(561)]}[m(1003)](){return this[m(602)]}toJSON(){const e=m,x=this[e(632)][e(666)](n=>({...n}));return{...super[e(935)](),ranges:x,lastCol:this.lastCol,lastRow:this.lastRow}}fromJSON(e){const x=m;this[x(632)]=e[x(632)].map(n=>({...n})),this[x(561)]=e[x(561)],this.lastRow=e[x(602)],super[x(525)](e)}}let po=class extends E2{constructor(){super(...arguments),L(this,"headerMap",[])}addHeaderMapItem(e,x){const n=m;this[n(649)][e]=x}getHeaderMapItem(e){return this.headerMap[e]}[m(935)](){const e=m,x=this[e(649)][e(666)](n=>({...n}));return{...super[e(935)](),headerMap:x}}fromJSON(e){const x=m;this.headerMap=e[x(649)][x(666)](n=>({...n})),super[x(525)](e)}};function S2(){const t=["createTupleWithoutCheck","FilterSingle","Collator","_id","collapse","_getGroupInfo","getValueFilterInfos","log2","measure","setFilterInfo","getUniqueValueFieldName","tuples","nextWeek","FilterPartial","layoutValueLeafNode","getNeedQuery","iterateFieldMeasure","numberGroupField","setRowCount","_isDirty","FilteredSortNone","getFieldInfo","captionBeginsWith","Minute","shouldMultipleNode","dataFieldId","captionNotBeginsWith","181187CfeKIs","getOptions","Collapse","nextMonth","addNode","getFieldById","colDeep","subTotal","-%$%-","getDirty","colNodeTree","Date","percent","getItemsMap","setSortInfo","_getModel","None","_countN","_colLevelPool","NotName","buildColPathMap","quarter","outline","doSummary","valueNotEqual","cloneBufferModel","33652QOUYsN","_viewVersion","getGroupFieldsInfoByIds","dimensionMap","Column","hasBlank","valueFilterInfo","average","-$-blk-$-","displayNameRecord","Year","ManualFilter","getDisplayName"," ","entries","M10","refreshGroupField","getFieldPositionInfoById","FilteredSortDesc","createDataFieldId","calculateListSubtotal","getCellValue","9033648xlgNwC","BlankValue","join","columnFields","getDateGroupValid","getFieldIdByDisplayName","Hour","hour-minute","1423800DjrRfL","leafCount","findIndex","minute","unionTuples","dateType","_level","customFields","toString","setSubtotal","getDataFieldBySourceName","captionGreaterThan","_count","COl_ROOT_PATH","getUniqueDataFieldName","getTableFieldsByDataFieldId","getInfo","_bufferModel","_nodes","every","buildColPathMapForCollapse","_calculateSubtotalImp","compare","isEmpty","HourMinute","colTableIdList","hasInteger","getMinutes","8RyLqsk"," - ","percentOfGrandTotal","sortInfo","iterate","blank"," is exist in the pivot table.","isRowMultiMeasure","captionLessThanOrEqual","valueLessThan","percentOfParentGrandTotal","doRowBrachNode","ensureTupleItem","parentIndex","dimensionIdList","error","valueLessThanOrEqual","index","getformat","hasSort","updateColumnSubtotal","-$-oth-$-","doColBranchNode","month-date","cornerView","getFieldsId","setOther","setInfo","createCollection","year-month","buildNodeTree","hasText","percentOfColumnTotal","countNums","text","createValueFieldByDataFieldId","5jfRNey","setBlank","toJSON","getId","indexOf","_getTupleCache","tuple","NaN","rowTableIdList","getSortInfo","combinePathMap","valueGreaterThan","UpdateSource","getDataFieldType","subtotalMap","dimensionSortInfo","getGroupInfo","YearMonthDate","ceil","add","getFieldDisplayNames","thisQuarter","getColIndexForRowHeader","SetCollapse","getItemSharedKey","layoutPageDownThenOver","items","sortItems","push","valueIndex","getSortedMap","Date1904","createLabelFieldByDataFieldId","defaultNormalField","valueBetween","displayName","isDev","baseFieldId","keys","getFieldIds","getFieldFormat","getName","sortMap","getStyle","getFieldDataType","getFieldCountByArea","sortNode","valueQueryInfo","setValueFilterInfo","today","_index","filterInfo","getNodeValue","MonthDate","UpdateValuePosition","SetFilterInfo","dataView","setFieldFormat","Expand","date","colQueryInfo","setCollapse","setLevel","getShowDataAs","getRanges","_updateStringItemKey","getIsLeaf","getValuePosition","itemTypes","yesterday","getLastRow","lastQuarter","valueNotBetween","getUniqueFieldId","_updateItemKey","getIndexesByKey","BLANK_PLACEHOLDER","onQueryEnd","yearToDate","rowDeep","Date1900","Quarter","length","Product of ","isLeafNode","FilterAll","removeValueFilterInfo","prepareLayoutCtx","valuePosition","colMap","getIndex","Row","ensureTupleItemByString","layoutValueNode","rowFields","valueFieldId","year-month-date","dataFieldType","NEGATIVE_INFINITY","_squareSum","layoutRowFields","_dateType","setName","filter","NotNumber","reduce","AddField"," is already in the pivot table.","differenceFrom","setPaths","tabular","assign","startContent","dateNotBetween","getMeasureInfoByIndex","percentOfParent","Hidden","groupInfo","pop","layoutValueNodeSubtotal","_product","_buildNodeTreeImp","otherDataKey","UpdateFieldPosition","runningTotal","rowQueryInfo","FilterNoneSortAsc","layoutCol","dateNewerThanOrEqual","month","size","TUPLE_FIELD_SEPARATOR","tomorrow","hasNode","random","3TPvYhm","measureCount","getFilterFieldIdByIndex","squareSum","dateNotEqual","_updateBlankItemKey","dateNewerThan","getDataFieldByTableId","RemoveField","pageView","dataFieldsCollection","endCollectChangeset","info","counter","ascending","getSubtotal","lastWeek","filterFields","122370VxGexd","hasField","measureIdList","captionNotContains","getRowCount","getAutoDisplayNameFunction","showDataAs","product","layoutPageOverThenDown","layoutColFields","iterateField","subtotal","isLeaf","Div0","maxLimitItemCount","createSummaryLabelSortedMap","_valueFilterInfo","valueEqual","isExistFieldName","setDataRecordCount","_updateDateItemKey","records","setShowDataAs","setGroupInfo","custom","bottomTotalSize","host","captionEqual","hiddenFields","Standard Deviation of ","setRangeKey","compact","captionEndsWith","captionGreaterThanOrEqual","boolean","shouldMultipleTotal","updateFieldSourceInfo","renameField","getColCount","M11","getHours","createOrUpdateTuple","SetValueFilter","getOriginFieldId","getDataRecordCount","sum","hasDecimal","Month","min","floor","setValueSize","hexCode","_max","getFormat","fromJSON","_getIndex","addRange","layoutColHeader","doRowLeafNode","max","FilterNoneSortDesc","year","valueFields","addField","SetFieldFormat","removeField","valueFilterMap","format","setColCount","ValueFilter","_bubbleDown","isAll","string","2uwYWxI","rowNodeTree","rangeKey","captionNotEqual","query","layout","_itemsMap","createTuple","_fieldDataType","dateBetween","110WqjjfG","addRecord","thisWeek","calculateSubtotal","list","getDate","value","lastCol","getLastCol","maxNumber","getValueFields","_sum","dateOlderThan","GrandTotal","_getValueFilterTree","dimensionTableIdList","tupleMap","dateEqual","layoutRowNode","getFullYear","itemSize","other","unionTupleInfo","POSITIVE_INFINITY","SetSubtotalType","RenameField","1145346NarfHW","range","prefix","_model","queryData","iterateFieldDim","get","setValue","getSourceName","getDataFieldIdByDisplayName","some","captionLessThan","Filter","getValue","addCollection","setSubtotalType","descending","deleteField","thisYear","collapseInfo","iterateFieldByArea","Value","lastRow","getGroupFieldMap","getQueryData","getLevel","find","_bubbleUp","warn","fieldId","path","_min","colDimOrder","getMeasureIndex","hasSourceName","getIndexesByPathStr","normal","buildPathMap","Variance of ","customOrder","isExistField","setSourceName","getValueFilterInfo","Average of ","setDateType","setParentIndex","endChangeStack","name","percentOfParentRowTotal","dataFields","colPathMap","set","ranges","updateValuePosition","percentDifferenceFrom","localeCompare","YearMonth","_heap","sortedList","getPaths","lastMonth","updateRowSubtotal","onQueryStart","lossLessProperty","indexes","SetSortInfo","dispose","MultipleGrandTotal","nextQuarter","headerMap","types","Subtotal","layoutNoneColFields","isFinite","setDirty","var","_itemIndexMap","getCell","getPathKeyWithFiledId","captionContains","stdDevp","repeatRowLabels","TUPLE_PLACEHOLDER","SetOptions","sourceName","dateSystem","map","originalFieldId","_updateOtherItemKey","Count of ","FilterNoneSortNone","The field ","getRealSize","setLabelFilterInfo","unknown","errorType","lastYear","FilteredSortAsc","object","topTotalSize","summary","number","getFilterInfo","dateGroupField","setOptions","captionBetween","pageOverThenDown","forEach","addHeaderMapItem","getValueIndex","rowView","colView","sort","getCollapse","CustomFilter","symbol","fieldIds","_calculateValueFilter","startChangeStack","count","ROW_ROOT_PATH","setLeaf","colCount","textGroupField","splice","Min of ","defaultSortType","values","setDisplayName","data","rowCount","percentRunningTotal"," is not in the pivot table.","dimension","registerCallbackWithEvent","setRange","has","updateDataFieldsCollection","_changeStack","_tupleGroupCache","captionNotBetween","getFieldsAreaByType","getTime","field","getTypeByKey","startCollectChangeset","removeValueFilterInfoByValueFieldId","getMonth","version","thisMonth","setStyle","includes","361233BpvIfQ","getRowIndexForColHeader","_dataIsValid","hour","iterateColLeafNodeChildren","minDate","dataRecordCount","setLastCol","getItemKey","BadReference","paths","maxDate","setLastRow","filterQueryInfo","The value filter info is invalid.","varp","valueGreaterThanOrEqual","isColMultiMeasure","_doValueFilter","getTableFieldById","_rowLevelPool","layoutCorner","concat","-$-cr-$-","Population Standard Deviation of ","M12","options","measuresMap","setFormat","_keyCounter","layoutColNode","dateOlderThanOrEqual","stdDev","combinePathMapList","formatMap","_generateModel","reset","_callbacks","hasDate","minNumber","layoutPage","nextYear","type","collections","customGroupField","setPageIndex","doColLeafNode","setVersion","Unknown filter operator: ","year-quarter","setDataFieldId","getNode","getDataFieldId","prepare"];return S2=function(){return t},S2()}class I8 extends po{getLastCol(){const e=m;return Math.max(this.lastCol,this[e(649)].length-1)}}let g8=class extends po{getLastRow(){const e=m;return Math.max(this[e(602)],this.headerMap[e(1015)]-1)}};const v8=t=>typeof t==m(678)&&t[m(582)]!==void 0,C8=t=>typeof t==m(678)&&t[m(675)]!==void 0,w8=t=>t[m(970)]!==void 0,P8=t=>{const e=m;if(w8(t)){const{type:x,baseFieldId:n,sortItems:r}=t;return{type:x,baseFieldId:n,sortItems:r[e(754)]()}}else return{...t}},xa=t=>({...t});let _o=class{constructor(e,x,n="",r){const s=m;L(this,s(811)),L(this,"id"),L(this,"sourceName"),L(this,s(968)),L(this,s(538)),L(this,s(643)),this[s(811)]=e,this.id=x,this.displayName=n,this[s(664)]=r}[m(936)](){return this.id}[m(588)](){return this[m(664)]}[m(621)](e){const x=m;this[x(664)]=e}[m(782)](e){const x=m;this[x(811)]=e}[m(784)](){return this[m(811)]}[m(524)](){return this[m(538)]}[m(760)](e){const x=m;this[x(538)]=e}[m(708)](e){const x=m;this[x(968)]=e}[m(851)](){return this.displayName}};class fs extends _o{constructor(e,x,n="",r){const s=m;super(e,x,n,r),L(this,s(482)),L(this,s(477))}[m(878)](e){const x=m;this[x(482)]=e}getSubtotal(){return this.subtotal}[m(493)](e){const x=m;this[x(477)]=e}getShowDataAs(){return this[m(477)]}[m(604)](){const e=m;return{id:this.id,dataFieldId:this[e(811)],displayName:this[e(968)],subtotal:this[e(482)],showDataAs:this[e(477)]}}[m(935)](){const e=m;return{id:this.id,dataFieldId:this.dataFieldId,displayName:this[e(968)],sourceName:this[e(664)],subtotal:this.subtotal,format:this.format,showDataAs:xa(this.showDataAs)}}fromJSON(e){const x=m;this.id=e.id,this[x(811)]=e[x(811)],this.displayName=e[x(968)],this[x(664)]=e[x(664)],this[x(538)]=e[x(538)],this.subtotal=e.subtotal,this[x(477)]=xa(e[x(477)])}}class ms extends _o{constructor(e,x,n="",r){const s=m;super(e,x,n,r),L(this,"sortInfo"),L(this,s(984))}setSortInfo(e){const x=m;this[x(900)]=e}getSortInfo(){return this[m(900)]}[m(795)](e){this.filterInfo=e}[m(682)](){return this[m(984)]}[m(604)](){const e=m;return{id:this.id,dataFieldId:this[e(811)],displayName:this.displayName,sortInfo:this[e(900)],filterInfo:Object[e(1044)]({},this[e(984)])}}toJSON(){const e=m;return{id:this.id,dataFieldId:this[e(811)],displayName:this[e(968)],format:this[e(538)],sourceName:this.sourceName,sortInfo:this.sortInfo?P8(this[e(900)]):void 0,filterInfo:this[e(984)]?this[e(984)]:void 0}}[m(525)](e){const x=m;this.id=e.id,this[x(811)]=e.dataFieldId,this[x(968)]=e[x(968)],this[x(664)]=e.sourceName,this[x(538)]=e[x(538)],e[x(900)]&&(this[x(900)]=e[x(900)]),e[x(984)]&&(this[x(984)]=e[x(984)])}}function y8(t,e=!0){const x=m,n=new fs(t[x(811)],t.id,t[x(851)](),t[x(664)]),r=p0[x(516)];if(Zt(t.getDisplayName(),r),n[x(482)]=r,t[x(643)]){const s=t[x(643)];s[x(477)]&&(n[x(477)]=s[x(477)]),s[x(482)]!==void 0&&(n[x(482)]=s[x(482)])}return e&&(n[x(643)]={sortInfo:t.getSortInfo(),filterInfo:t.getFilterInfo()}),n}function R8(t,e=!0){const x=m,n=new ms(t[x(811)],t.id,t[x(851)](),t[x(664)]);if(n[x(708)](t[x(851)]()),t[x(643)]){const r=t[x(643)];r[x(900)]&&(n[x(900)]=r.sortInfo),r[x(984)]&&(n[x(984)]=r[x(984)])}return e&&(n[x(643)]={subtotal:t[x(468)](),showDataAs:t[x(996)]()}),n}function E8(t){const e=m,{dataFieldId:x,id:n,sourceName:r}=t,s=new fs(x,n,"",r);return s[e(525)](t),s}function S8(t){const e=m,{dataFieldId:x,id:n,sourceName:r}=t,s=new ms(x,n,"",r);return s[e(525)](t),s}let T8=class Io{constructor(){const e=m;L(this,"rowFields",[]),L(this,"columnFields",[]),L(this,"valueFields",[]),L(this,e(470),[]),L(this,"hiddenFields",[]),L(this,e(713),{}),L(this,"measure",{}),L(this,e(962),-1),L(this,e(1021),Fx[e(829)]),L(this,e(549),uo[e(1043)]),L(this,e(599),{}),L(this,"options"),L(this,e(718)),L(this,"_isDirty",!0),L(this,e(487),[]),this.options={pageWrap:1,pageOverThenDown:!1}}[m(698)](){const e=m;this[e(718)]=[]}[m(626)](){const e=m,x=this[e(718)];return delete this[e(718)],x}[m(654)](e){this._isDirty=e}[m(822)](){return this[m(805)]}[m(684)](e){const x=m,n={...this[x(758)]},r={...this[x(758)],...e};if(this[x(758)]={...r},this[x(718)]){const s={type:xx[x(663)],oldOptions:n,newOptions:r};this[x(718)].push(s)}}[m(814)](){return{...this[m(758)]}}[m(994)](e,x,n){const r=m;if(n!==void 0?(this.collapseInfo[e]=this[r(599)][e]||{},this[r(599)][e][n]=x):this.collapseInfo[e]=x,this[r(718)]){const s={type:xx[r(956)],fieldId:e,collapse:x,item:n};this[r(718)].push(s)}}[m(673)](e,x){const n=m;if(this[n(713)][e]){const r={...this.dimension[e][n(682)]()};if(this[n(713)][e][n(795)](x),this[n(718)]){const s={type:xx.SetFilterInfo,fieldId:e,oldFilterInfo:r,newFilterInfo:x};this[n(718)][n(961)](s)}this.setDirty(!0)}}[m(981)](e,x){const n=m;if(!this.dimension[e]&&x!==void 0||x!==void 0&&!this.measure[x[n(1028)]]){console[n(912)](n(746));return}const r=this[n(487)][n(606)](s=>s[n(609)]===e);if(this[n(487)]=this._valueFilterInfo.filter(s=>s[n(609)]!==e),x&&this[n(487)].push({fieldId:e,filterInfo:x}),this[n(718)]){const s={type:xx[n(513)],fieldId:e,oldFilterInfo:r==null?void 0:r[n(984)],filterInfo:x};this[n(718)][n(961)](s)}this[n(654)](!0)}[m(622)](e){const x=m,n=this[x(487)][x(606)](r=>r[x(609)]===e);return n?n[x(984)]:void 0}[m(792)](){const e=m;return this[e(487)][e(754)]()}[m(1019)](e){const x=m;this[x(487)].find(n=>n[x(609)]===e)&&this.setValueFilterInfo(e,void 0)}[m(726)](e){const x=m,n=this[x(487)][x(1036)](r=>r[x(984)][x(1028)]===e);if(n&&n[x(1015)]>0){const r=n.length;for(let s=r-1;s>=0;s--)this[x(981)](n[s].fieldId,void 0)}}[m(973)](e){const x=m;if(this[x(713)][e])return this[x(713)][e][x(524)]();if(this.measure[e])return this[x(794)][e][x(524)]()}[m(990)](e,x){const n=m;let r;if(this.dimension[e]&&this[n(713)][e][n(760)](x),this[n(794)][e]&&this[n(794)][e][n(760)](x),this[n(718)]&&(this[n(713)][e]||this[n(794)][e])){const s={type:xx[n(535)],fieldId:e,oldFormat:r,newFormat:x};this[n(718)].push(s)}}setSortInfo(e,x){const n=m;if(this[n(713)][e]){const r=this.dimension[e][n(942)](),s=r?{...r}:void 0;if(this[n(713)][e][n(827)](x),this[n(718)]){const i={type:xx[n(645)],fieldId:e,newSortInfo:x,oldSortInfo:s};this[n(718)][n(961)](i)}}}getSortInfo(e){const x=m;if(this[x(713)][e])return this.dimension[e][x(942)]()}[m(682)](e){const x=m;if(this[x(713)][e])return this[x(713)][e][x(682)]()}[m(481)](e){const x=m;Object[x(707)](this[x(713)])[x(687)](n=>{e(n)}),Object[x(707)](this.measure).forEach(n=>{e(n)})}iterateFieldDim(e){const x=m;Object[x(707)](this[x(713)])[x(687)](n=>{e(n)})}[m(802)](e){const x=m;Object.values(this.measure)[x(687)](n=>{e(n)})}iterateFieldByArea(e,x){this.getFieldsAreaByType(e).forEach(n=>{const r=at,s=this[r(818)](n);s&&x(s)})}[m(534)](e,x,n){const r=m;if(this[r(818)](e[r(936)]())){console[r(912)](r(671)+e[r(936)]()+r(898)+e.getDisplayName()+r(1040));return}vt(x)?this[r(713)][e.id]=e:this.measure[e.id]=e;let s;switch(x){case e0[r(843)]:s=this[r(864)];break;case e0[r(1024)]:s=this[r(1027)];break;case e0[r(601)]:s=this[r(533)];break;case e0[r(592)]:s=this[r(470)];break;case e0[r(1049)]:s=this[r(499)];break}n===void 0?s[r(961)](e.id):s.splice(n,0,e.id);const i=n===void 0?s[r(1015)]-1:n;if(this[r(718)]){const a={type:xx[r(1039)],fieldJson:e.toJSON(),area:x,index:i};this[r(718)][r(961)](a)}this[r(654)](!0)}[m(856)](e){const x=m;let n,r=-1;return this.columnFields[x(937)](e)!==-1?(n=e0.Column,r=this[x(864)][x(937)](e)):this.rowFields[x(937)](e)!==-1?(n=e0[x(1024)],r=this[x(1027)][x(937)](e)):this[x(533)][x(937)](e)!==-1?(n=e0.Value,r=this[x(533)][x(937)](e)):this[x(470)][x(937)](e)!==-1?(n=e0[x(592)],r=this.filterFields[x(937)](e)):this[x(499)][x(937)](e)!==-1&&(n=e0[x(1049)],r=this[x(499)][x(937)](e)),{area:n,index:r}}[m(507)](e,x,n){const r=m,s=this[r(818)](e);if(s){const i=s[r(588)](),a=s.getDataFieldId();if(s[r(621)](x),s.setDataFieldId(n),this[r(718)]){const o={type:xx[r(945)],tableFieldId:e,oldSourceName:i,newSourceName:x,oldDataFieldId:a,newDataFieldId:n};this[r(718)][r(961)](o)}this[r(654)](!0)}}[m(721)](e){const x=m;switch(e){case e0[x(843)]:return this[x(864)];case e0[x(1024)]:return this[x(1027)];case e0[x(601)]:return this.valueFields;case e0[x(592)]:return this[x(470)];case e0[x(1049)]:return this[x(499)]}}[m(818)](e){const x=m;if(this[x(713)][e])return this[x(713)][e];if(this[x(794)][e])return this[x(794)][e]}[m(489)](e){const x=m;for(const n of Object[x(707)](this[x(713)]))if(n[x(851)]()===e)return!0;for(const n of Object[x(707)](this[x(794)]))if(n.getDisplayName()===e)return!0;return!1}[m(508)](e,x){const n=m,{area:r,index:s}=this[n(856)](e);if(r===void 0||s===-1){console[n(608)](n(671)+e+n(712));return}if(this[n(489)](x)){console[n(608)]("The displayName "+x+n(903));return}let i;if(vt(r)?(i=this.dimension[e].getDisplayName(),this[n(713)][e][n(708)](x)):(i=this[n(794)][e][n(851)](),this[n(794)][e][n(708)](x)),this._changeStack){const a={type:xx[n(579)],fieldId:e,newName:x,oldName:i};this[n(718)].push(a)}}[m(536)](e){const x=m,{area:n,index:r}=this[x(856)](e);if(n===void 0||r===-1){console[x(608)](x(671)+e+x(712));return}this[x(721)](n).splice(r,1);let s;if(vt(n)?(s=this[x(713)][e][x(935)](),delete this[x(713)][e]):(s=this[x(794)][e].toJSON(),delete this[x(794)][e]),this._changeStack){const i={type:xx[x(1076)],fieldId:e,fieldJson:s,area:n,index:r};this[x(718)][x(961)](i)}this[x(654)](!0)}updateFieldPosition(e,x,n){const r=m,{area:s,index:i}=this.getFieldPositionInfoById(e);if(s===x&&i===n)return;if(s===void 0&&i===-1){console.warn("The field "+e+r(712));return}const a=this[r(721)](x);this.getFieldsAreaByType(s)[r(704)](i,1),a[r(704)](n,0,e);const o=vt(s),d=vt(x);if(o!==d)if(o){const c=this[r(713)][e];delete this[r(713)][e];const l=y8(c);this.measure[e]=l}else{const c=this.measure[e];delete this[r(794)][e];const l=R8(c);this[r(713)][e]=l}if(this._changeStack){const c={type:xx[r(1056)],fieldId:e,oldArea:s,newArea:x,oldIndex:i,newIndex:n};this._changeStack[r(961)](c)}qi(s)&&qi(x)||s===e0[r(601)]&&x===e0.Value||s===e0[r(1049)]&&x===e0.Hidden||s===e0[r(592)]&&x===e0[r(592)]||this[r(654)](!0)}updateValuePosition(e,x){const n=m,r=this.valuePosition,s=this[n(962)];if(this[n(1021)]=e,this.valueIndex=x,this[n(718)]){const i={type:xx[n(987)],oldValuePosition:r,newValuePosition:e,oldIndex:s,newIndex:x};this[n(718)][n(961)](i)}}[m(689)](){return this.valueIndex}getValuePosition(){return this[m(1021)]}isColMultiMeasure(){const e=m;return this[e(533)][e(1015)]<=1?!1:this[e(1021)]===Fx.Column}[m(904)](){const e=m;return this[e(533)][e(1015)]<=1?!1:this[e(1021)]===Fx[e(1024)]}[m(892)](){const e=m;return[][e(754)](this.rowFields,this[e(864)],this.valueFields,this[e(470)])[e(1015)]===0}[m(595)](e,x){const n=m;if(this[n(794)][e]){const r=this[n(794)][e].getSubtotal();if(this[n(794)][e][n(878)](x),this[n(718)]){const s={type:xx[n(578)],fieldId:e,newSubtotalType:x,oldSubtotalType:r};this[n(718)][n(961)](s)}this[n(654)](!0)}}[m(604)](){const e=m,x=this[e(713)],n=[];for(const o of this[e(1027)])x[o]&&n[e(961)](x[o][e(604)]());const r=[];for(const o of this[e(864)])x[o]&&r[e(961)](x[o][e(604)]());const s=[];for(const o of this.filterFields)x[o]&&s[e(961)](x[o][e(604)]());const i=[];for(const o of this.valueFields)this[e(794)][o]&&i.push(this.measure[o].getQueryData());const a=[];for(const o of this[e(487)]){const{fieldId:d,filterInfo:c}=o;x[d]&&this[e(794)][c[e(1028)]]&&a[e(961)](o)}return{rowQueryInfo:n,colQueryInfo:r,filterQueryInfo:s,valueQueryInfo:i,collapseInfo:Object[e(1044)]({},this[e(599)]),valueFilterInfo:a}}reset(e){const x=m;e===void 0?(this[x(1027)]=[],this.columnFields=[],this[x(533)]=[],this[x(470)]=[],this.hiddenFields=[],this[x(713)]={},this[x(794)]={},this[x(962)]=-1,this[x(1021)]=Fx[x(829)],this[x(599)]={},this[x(758)]={}):e===e0.Column?(this[x(864)][x(687)](n=>{delete this.dimension[n]}),this[x(864)]=[]):e===e0[x(1024)]?(this[x(1027)].forEach(n=>{const r=x;delete this[r(713)][n]}),this[x(1027)]=[]):e===e0[x(592)]?(this.filterFields[x(687)](n=>{delete this.dimension[n]}),this.filterFields=[]):e===e0[x(601)]&&(this[x(533)][x(687)](n=>{const r=x;delete this[r(794)][n]}),this[x(962)]=-1,this[x(1021)]=Fx[x(829)],this[x(533)]=[])}[m(525)](e){const x=m;this[x(713)]=Object.keys(e[x(713)]).reduce((n,r)=>{const s=x,i=e.dimension[r],a=new ms(i[s(811)],i.id,i[s(968)],i.sourceName);return a[s(525)](i),n[r]=a,n},{}),this[x(794)]=Object[x(971)](e.measure)[x(1038)]((n,r)=>{const s=x,i=e[s(794)][r],a=new fs(i[s(811)],i.id,i[s(968)],i.sourceName);return a.fromJSON(e[s(794)][r]),n[r]=a,n},{}),this.filterFields=e[x(470)][x(754)](),this.hiddenFields=e[x(499)][x(754)](),this[x(1027)]=e.rowFields[x(754)](),this[x(533)]=e.valueFields[x(754)](),this[x(864)]=e[x(864)][x(754)](),this[x(549)]=e[x(549)],this[x(962)]=e.valueIndex,this[x(1021)]=e[x(1021)],this[x(599)]=Object[x(1044)]({},e[x(599)]),this[x(758)]=Object.assign({},e[x(758)]),e.valueFilter?this[x(487)]=e.valueFilter[x(666)](n=>({...n})):this._valueFilterInfo=[]}toJSON(){const e=m,x=Object[e(971)](this.dimension)[e(1038)]((s,i)=>(s[i]=this[e(713)][i].toJSON(),s),{}),n=Object[e(971)](this.measure)[e(1038)]((s,i)=>(s[i]=this[e(794)][i][e(935)](),s),{}),r=this[e(487)].map(s=>({...s}));return{columnFields:this[e(864)][e(754)](),dimension:x,measure:n,filterFields:this[e(470)].concat(),hiddenFields:this[e(499)][e(754)](),rowFields:this[e(1027)][e(754)](),valueFields:this.valueFields[e(754)](),layout:this.layout,valueIndex:this[e(962)],valuePosition:this[e(1021)],collapseInfo:Object[e(1044)]({},this.collapseInfo),options:Object.assign({},this[e(758)]),valueFilter:r}}[m(838)](){const e=m,x=new Io;return x[e(525)](this[e(935)]()),x[e(654)](this[e(822)]()),x}},M8=class{static[m(1020)](e,x,n){const r=m,s=new Xx,i=x[r(1012)],a=x[r(819)],o=e.getOptions(),d=o.pageWrap||1,c=!!o[r(686)],l=n[r(980)],u=n.valueFilterInfo,f={};for(const P of u)f[P[r(609)]]=P;let b=e[r(749)]();const h=e[r(904)]();let p=e[r(689)]();l[r(1015)]>1&&(p===-1&&(p=a),!b&&!h&&(b=!0),b&&(p=Math[r(519)](p,a)),h&&(p=Math[r(519)](p,i)));const I=l[r(1015)],v={},C={};let w=0;for(const P of l)v[P.id]=P,C[P.id]=w,w++;const y=!!e.getOptions()[r(661)];return{isColMultiMeasure:b,isRowMultiMeasure:h,valueIndex:p,rowDeep:i,colDeep:a,rowNodeTree:x.rowNodeTree,colNodeTree:x[r(823)],measuresMap:v,measureIndexesMap:C,measureCount:I,pageWrap:d,pageOverThenDown:c,queryData:n,view:s,valueQueryInfo:l,colMap:{},summaryManager:x,collapseInfo:n[r(599)],repeatRowLabels:y,valueFilterMap:f}}static[m(772)](e){const x=m,{pageWrap:n,pageOverThenDown:r,view:s}=e,i=s[x(1077)],a=e.queryData[x(745)];r?this[x(479)](a,i,n):this[x(958)](a,i,n)}static[m(479)](e,x,n=1){const r=m;let s=0,i=0,a=0;for(const u of e){const{displayName:f,filterInfo:b}=u,{value:h,status:p}=Ki(b);x.setValue(i,s*3,f),x.setValue(i,s*3+1,h),x[r(730)](i,s*3+1,p),x.setPageIndex(i,s*3,a),x[r(777)](i,s*3+1,a),s++,s===n&&(s=0,i++),a++}const o=e.length,d=Math[r(951)](o/n),c=o%n;for(let u=0;u<n;u++){const f=c>=u+1?d:d-1;x[r(527)]({row:0,col:u*3,rowCount:f,colCount:2})}x.setLastRow(d-1);const l=o>n?n*3-2:o*3-2;x.setLastCol(l),x[r(804)](x.lastRow+1),x[r(539)](x[r(561)]+1)}static[m(958)](e,x,n=1){const r=m;let s=0,i=0,a=0;for(const c of e){const{displayName:l,filterInfo:u}=c,{value:f,status:b}=Ki(u);x[r(587)](s,i*3,l),x.setValue(s,i*3+1,f),x.setStyle(s,i*3+1,b),x[r(777)](s,i*3,a),x[r(777)](s,i*3+1,a),s++,s===n&&(s=0,i++),a++}const o=e[r(1015)];let d=0;for(;d<o;){const c=Math.min(n,o-d);x[r(527)]({row:0,col:d*3/n,rowCount:c,colCount:2}),d+=n}x[r(744)](Math[r(519)](o,n)-1),x[r(739)](Math[r(951)](o/n)*3-2),x[r(804)](x[r(602)]+1),x[r(539)](x[r(561)]+1)}static[m(1060)](e){const x=m;this[x(528)](e),this[x(480)](e)}static[m(753)](e){}static[m(528)](e){const x=m,{colDeep:n,view:r,isColMultiMeasure:s,valueIndex:i}=e,a=e[x(584)][x(993)],o=r[x(691)],d=0;let c=0,l=!1;for(let u=0;u<n;u++){const f=a[u],{displayName:b,filterInfo:h,sortInfo:p,id:I,dataFieldId:v}=f;n!==0&&s&&u===i&&(o[x(587)](d,c,x(852)),l=!0,c++),o[x(587)](d,c,b),o[x(688)](c+1,{isValue:!1,level:u,tableFieldId:I,dataFieldId:v}),o[x(730)](d,c,bo(h,p,e[x(537)][I])),c++}n!==0&&!l&&s&&(o[x(587)](d,c,x(852)),o[x(688)](c+1,{isValue:!0,level:-1,tableFieldId:"",dataFieldId:""}))}static setValueSize(e){const x=m,{view:n}=e,{rowView:r,colView:s,dataView:i}=n;i[x(804)](r[x(475)]()),i[x(539)](s.getColCount())}static layoutNoneColFields(e,x){const n=m,{measureCount:r,isColMultiMeasure:s,valueQueryInfo:i}=e,a=s?i[n(666)](d=>d.id):[],o=this.buildColPathMap(e,x);return r===0?{itemSize:0,topTotalSize:0,bottomTotalSize:0,colPathMap:o}:(this[n(917)](e,0,x,a,o),{itemSize:0,topTotalSize:0,bottomTotalSize:s?r:1,colPathMap:o})}static[m(480)](e){const x=m,{colNodeTree:n,view:r,colDeep:s,isColMultiMeasure:i,valueQueryInfo:a,measureCount:o}=e,d=0,c=i?a.map(b=>b.id):[],l=s===0?this[x(652)](e,n):this[x(762)](e,n,d,c),u=r.colView;if(o===0&&s===0)u[x(804)](0);else if(o!==0&&s===0)u[x(804)](1);else{const b=s===0?0:1,h=i?s+1+b:s+b;u.setRowCount(h)}u[x(539)](this[x(672)](l));const f=u[x(617)](i);e[x(1022)]=f}static[m(1017)](e,x){return e.getLevel()===x}static[m(672)](e){const x=m;return e[x(574)]+e[x(679)]+e[x(496)]}static[m(985)](e,x,n){const r=m,{queryData:s,summaryManager:i}=e,{valueQueryInfo:a}=s,{dataFieldId:o,subtotal:d}=a[n];return i[r(860)](x.getIndex(),o,d)}static[m(778)](e,x,n,r){const s=m,{view:i,isColMultiMeasure:a,valueIndex:o,measureCount:d,measuresMap:c,measureIndexesMap:l,colDeep:u}=e,f=i[s(691)],b=x[s(605)](),h=this[s(810)](a,b,o),p=this[s(833)](e,x),I=x.getFieldsId();if(h){let v=0;const C=u===0?0:1;for(const w of r){const y=this[s(733)](b,o,a)+C;f.setValue(y,n+v,c[w][s(968)]),f[s(924)](n+v,{level:b,paths:x.getPaths(),valueIndex:a?v:-1,colPathMap:p,tableFieldId:I}),v++}return{itemSize:1*d,topTotalSize:0,bottomTotalSize:0,colPathMap:p}}else{const v=a?l[r[0]]:-1;return f.setInfo(n,{level:b,paths:x[s(639)](),valueIndex:v,colPathMap:p,tableFieldId:I}),{itemSize:1,topTotalSize:0,bottomTotalSize:0,colPathMap:p}}}static[m(833)](e,x){const n=m,r=[],s={};return s[""]=x[n(1023)](),x.getIsLeaf()||x[n(901)](i=>{const a=n;this.iterateColLeafNodeChildren(e,i,r[a(754)]([i[a(627)]]),s)}),s}static[m(736)](e,x,n,r){const s=m,{summaryManager:i}=e,a=i[s(658)](n,i[s(941)]);r[a]=x[s(1023)](),x.isLeaf||x[s(901)](o=>{const d=s,c=n.concat([o[d(627)]]);this[d(736)](e,o,c,r)})}static buildColPathMapForCollapse(e,x,n){const r=m;if(this[r(1017)](x,e.colDeep)){const s=this[r(833)](e,x);n[r(961)](s)}else x[r(901)](s=>{this.buildColPathMapForCollapse(e,s,n)})}static[m(919)](e,x,n,r){const s=m,{isColMultiMeasure:i,valueIndex:a,view:o,measuresMap:d,summaryManager:c}=e,l=x[s(605)]();let u=n;const f={itemSize:0,topTotalSize:0,bottomTotalSize:0,colPathMap:{}},b=[],h=this[s(810)](i,x[s(605)](),a),p=c[s(658)](x[s(639)](),c[s(894)]);if(h){let I=0;for(const C of r){const w=this[s(733)](l,a,i);o[s(691)][s(587)](w+1,u,d[C].displayName),x[s(901)](y=>{const P=s,E=this.layoutColNode(e,y,u,[C]),{itemSize:S,topTotalSize:T,bottomTotalSize:k}=E;f[P(574)]+=S,f.topTotalSize+=T,f.bottomTotalSize+=k,u+=this[P(672)](E),I===0&&b[P(961)](E[P(630)])}),I++}const v=c[s(765)](b,p);f[s(630)]=v,u++}else{x.iterate(v=>{const C=s,w=this[C(762)](e,v,u,r),{itemSize:y,topTotalSize:P,bottomTotalSize:E}=w;f.itemSize+=y,f[C(679)]+=P,f[C(496)]+=E,u+=this[C(672)](w),b[C(961)](w[C(630)])});const I=c[s(765)](b,p);f[s(630)]=I}return f}static[m(506)](e,x,n){return e&&x<=n}static[m(810)](e,x,n){return e&&x===n}static[m(733)](e,x,n){return n?e<=x?e:e+1:e}static layoutColNode(e,x,n,r){const s=m,{view:i,colDeep:a,measureCount:o,isColMultiMeasure:d,valueIndex:c,summaryManager:l}=e,u=i.colView,f=x[s(627)],b=x.type===R0[s(902)],h=x[s(774)]===R0[s(575)],p=x[s(774)]===R0[s(992)]||x[s(774)]===R0.number,I=x[s(605)](),v=this.getRowIndexForColHeader(I,c,d),C=this.shouldMultipleTotal(d,I,c),w=x.getCollapse(),y=this[s(1017)](x,a);if(I!==0){const P=p?Number(f):f;u[s(587)](v,n,P),b&&u[s(934)](v,n),h&&u.setOther(v,n),y||u.setStyle(v,n,w?A0[s(815)]:A0[s(991)])}if(w){if(y)return{itemSize:0,topTotalSize:0,bottomTotalSize:0,colPathMap:this[s(833)](e,x)};const P=[];this[s(889)](e,x,P);const E=l[s(658)](x[s(639)](),l[s(894)]),S=l[s(765)](P,E);return this[s(917)](e,n,x,r,S),{itemSize:0,topTotalSize:0,bottomTotalSize:C?o:1,colPathMap:S}}if(y)return this[s(778)](e,x,n,r);{const P=this[s(919)](e,x,n,r),E=this[s(672)](P);return this[s(917)](e,n+E,x,r,P[s(630)]),C?P.bottomTotalSize+=o:P[s(496)]++,P}}static[m(613)](e,x,n){return e?n[x[0]]:-1}static[m(917)](e,x,n,r,s){const i=m,{view:a,isColMultiMeasure:o,valueIndex:d,measuresMap:c,measureIndexesMap:l,colDeep:u,rowDeep:f,valueQueryInfo:b}=e,h=a.colView,p=n[i(627)],I=n[i(605)](),v=this.shouldMultipleTotal(o,I,d);if(I===0){const C=u===0?0:1;if(v){let w=0;for(const y of r){const{displayName:P}=c[y];h.setValue(C,w+x,""+P),h.setStyle(C,w+x,A0[i(647)]),h.setInfo(w+x,{level:I,paths:n.getPaths(),valueIndex:w,isBottomTotal:!0,colPathMap:s,tableFieldId:""}),w++}}else{u===0&&f!==0&&b.length===1?h.setValue(C,x,b[0][i(968)]):(h.setValue(C,x,""),h.setStyle(C,x,A0[i(567)]));const w=this[i(613)](o,r,l);h[i(924)](x,{level:I,paths:n[i(639)](),valueIndex:w,isBottomTotal:!0,colPathMap:s,tableFieldId:""})}}else{let C=this.getRowIndexForColHeader(I,d,o);const w=n[i(693)](),y=n[i(922)](),P=n[i(774)]===R0[i(902)],E=n[i(774)]===R0[i(575)];if(w&&C++,v){let S=0;const T=d;for(const k of r){const{displayName:V}=c[k],H=w?""+V:{prefix:n[i(627)],value:V};h[i(730)](T,x+S,A0[i(651)]),h[i(587)](T,x+S,H),P&&h[i(934)](C,x+S),E&&h[i(923)](C,x+S),h[i(924)](x+S,{level:I,paths:n.getPaths(),valueIndex:S,isBottomTotal:!0,colPathMap:s,tableFieldId:y}),S++}}else{w||(h[i(587)](C,x,""+p),P&&h[i(934)](C,x),h[i(730)](C,x,A0[i(651)]));const S=this[i(613)](o,r,l);h[i(924)](x,{level:I,paths:n[i(639)](),valueIndex:S,isBottomTotal:!0,colPathMap:s,tableFieldId:y})}}}},N8=class extends M8{static[m(549)](e,x,n){const r=m,s=this.prepareLayoutCtx(e,x,n);return this.layoutPage(s),this.layoutCol(s),this[r(1033)](s),this[r(521)](s),this[r(753)](s),s.view}static[m(753)](e){const x=m,{rowDeep:n,colDeep:r,view:s,measureCount:i,isRowMultiMeasure:a,isColMultiMeasure:o,valueIndex:d}=e,c=e.queryData[x(1058)],l=e[x(584)].valueQueryInfo,u=s.cornerView,f=s[x(691)],b=s[x(690)];let h=f[x(475)]();h===0&&n!==0&&(h=1);let p=b[x(509)]();n===0&&(i===0&&(p=0),i===1&&(p=1),i>1&&a&&(p=1),i>1&&o&&(p=0)),u[x(804)](h),u[x(539)](p),i===1&&r>0&&n>0&&u[x(587)](0,0,l[0][x(968)]);let I=0,v=!1;const C=h-1;for(let w=0;w<n;w++){const y=c[w],{displayName:P,filterInfo:E,sortInfo:S,dataFieldId:T,id:k}=y;a&&w===d&&(u[x(587)](C,I,x(852)),v=!0,u[x(924)](I,{paths:[],level:-1,tableFieldId:"",dataFieldId:"",valueIndex:-1,isValue:!0}),b.addHeaderMapItem(I,{isValue:!0,level:-1,tableFieldId:"",dataFieldId:""}),I++),u[x(587)](C,I,P),b.addHeaderMapItem(I,{isValue:!1,level:w,tableFieldId:k,dataFieldId:T}),u[x(730)](C,I,bo(E,S,e[x(537)][k])),u[x(924)](I,{paths:[],level:w,tableFieldId:k,dataFieldId:T,valueIndex:-1}),I++}!v&&a&&(u[x(587)](C,I,x(852)),b[x(688)](I,{isValue:!0,level:-1,tableFieldId:"",dataFieldId:""}))}static[m(1033)](e){const x=m,{rowNodeTree:n,view:r,rowDeep:s,isRowMultiMeasure:i,valueQueryInfo:a,measureCount:o}=e,d=0,c=i?a[x(666)](f=>f.id):[],l=this[x(572)](e,n,d,c),u=r[x(690)];u[x(804)](this[x(672)](l)),s===0?o===0?u[x(539)](0):u[x(539)](1):u[x(539)](i?s+1:s)}static[m(529)](e,x,n,r){const s=m,{view:i,isRowMultiMeasure:a,valueIndex:o,measureCount:d,measuresMap:c,measureIndexesMap:l,repeatRowLabels:u}=e,f=i[s(690)],b=x[s(605)](),h=x[s(774)]===R0.blank,p=x[s(774)]===R0[s(575)],I=this[s(810)](a,b,o),v=x[s(922)]();if(I){let C=0;for(const w of r){const y=this[s(955)](b,o,a)+1;f.setValue(n+C,y,c[w][s(968)]),h&&o!==x.getLevel()&&f.setBlank(n+C,y),p&&o!==x[s(605)]()&&f[s(923)](n+C,y);const P=x[s(639)]();f[s(924)](n+C,{paths:P,valueIndex:a?C:-1,level:b,tableFieldId:v}),this[s(1045)](e,x,n+C,C),C++}return{itemSize:1*d,topTotalSize:0,bottomTotalSize:0}}else{const C=a?l[r[0]]:-1,w=x[s(639)]();f.setInfo(n,{level:b,paths:w,valueIndex:C,tableFieldId:v});const y=this[s(955)](b,o,a);if(u&&y>0&&n>0)for(let P=0;P<y;P++)f.getValue(n,y)!==void 0&&f[s(587)](n,P,w[P]);return b===0&&d===0?{itemSize:0,topTotalSize:0,bottomTotalSize:0,valueIndex:C}:(this[s(1045)](e,x,n,C),{itemSize:1,topTotalSize:0,bottomTotalSize:0,valueIndex:C})}}static[m(1045)](e,x,n,r){const s=m,{measureCount:i}=e;i<=0||(x[s(901)](a=>{const o=s;this.layoutValueNode(e,a,n,r,[a[o(627)]])}),this.layoutValueLeafNode(e,x,n,[],r))}static[m(1026)](e,x,n,r,s){const i=m,a=x[i(999)]();this[i(800)](e,x,n,s,r),a||(this[i(1052)](e,n),x.iterate(o=>{const d=i,c=s.concat(o[d(627)]);this[d(1026)](e,o,n,r,c)}))}static layoutValueNodeSubtotal(e,x){const n=m,{view:r,summaryManager:s,valueQueryInfo:i,rowDeep:a,measureCount:o}=e,d=r[n(989)],c=r[n(691)],l=r[n(690)][n(1080)][x],u=l.paths;if(!(l.level===a||o<=0))for(let f=0;f<c[n(1080)][n(1015)];f++){const b=c.info[f],{colPathMap:h}=b,p=s[n(658)](u,s[n(941)]),I=h==null?void 0:h[p],{dataFieldId:v,subtotal:C}=this.getMeasureInfoByIndex(e,i,l,b);if(I){const w=s[n(860)](I,v,C);w!==void 0&&d.setValue(x,f,w)}}}static[m(1047)](e,x,n,r){const s=m,{isColMultiMeasure:i,isRowMultiMeasure:a}=e;return i?x[r.valueIndex]:a?x[n[s(962)]]:x[0]}static[m(800)](e,x,n,r,s){const i=m,{view:a,colMap:o,isColMultiMeasure:d,measureCount:c}=e,l=a.dataView,u=[];if(s===-1)if(d)for(let f=0;f<c;f++)u.push(f);else c>0&&u[i(961)](0);else u[i(961)](s);for(const f of u){const b=ho(r,f,d),h=o[b],p=this[i(985)](e,x,f);p!==void 0&&l[i(587)](n,h,p)}}static[m(955)](e,x,n){return n?e<=x?e-1:e:e-1}static[m(908)](e,x,n,r){const s=m,{isRowMultiMeasure:i,valueIndex:a,view:o,measuresMap:d}=e,c=x[s(605)]();let l=n;const u={itemSize:0,topTotalSize:0,bottomTotalSize:0},f=this[s(810)](i,x[s(605)](),a),b=x.type===R0[s(902)],h=x[s(774)]===R0[s(575)];if(f){for(const p of r){const I=this[s(955)](c,a,i),v=o[s(690)];v[s(587)](l,I+1,d[p][s(968)]),b&&v[s(934)](l,I+1),h&&v[s(923)](l,I+1),x.iterate(C=>{const w=s,y=this[w(572)](e,C,l,[p]),{itemSize:P,topTotalSize:E,bottomTotalSize:S}=y;u[w(574)]+=P,u.topTotalSize+=E,u[w(496)]+=S,l+=this.getRealSize(y)})}l++}else x.iterate(p=>{const I=s,v=this[I(572)](e,p,l,r),{itemSize:C,topTotalSize:w,bottomTotalSize:y}=v;u.itemSize+=C,u[I(679)]+=w,u.bottomTotalSize+=y,l+=this[I(672)](v)});return u}static layoutRowNode(e,x,n,r){const s=m,{view:i,rowDeep:a,isRowMultiMeasure:o,valueIndex:d,measureCount:c,colDeep:l,valueQueryInfo:u}=e,f=i[s(690)],b=x[s(627)],h=x.getLevel(),p=this[s(955)](h,d,o),I=x[s(693)](),v=this[s(1017)](x,a),C=x.type===R0[s(902)],w=x[s(774)]===R0[s(575)],y=x[s(774)]===R0[s(992)]||x[s(774)]===R0[s(681)],P=h===0;if(!P){const E=y?Number(b):b;f[s(587)](n,p,E),C&&f.setBlank(n,p),w&&f[s(923)](n,p),v||f.setStyle(n,p,I?A0.Collapse:A0.Expand)}if(v)return P&&!o&&c>0&&(a===0&&l!==0&&u[s(1015)]===1?f.setValue(n,0,u[0][s(968)]):(f[s(587)](n,0,""),f[s(730)](n,0,A0[s(567)]))),this[s(529)](e,x,n,r);{let E=n,S={itemSize:0,topTotalSize:0,bottomTotalSize:0};return I||(S=this[s(908)](e,x,n,r),E+=this[s(672)](S)),this[s(641)](e,E,x,r),this[s(506)](o,h,d)?S[s(496)]+=c:S[s(496)]++,S}}static[m(641)](e,x,n,r){const s=m,{view:i,isRowMultiMeasure:a,valueIndex:o,measuresMap:d,measureIndexesMap:c,rowDeep:l,colDeep:u,valueQueryInfo:f}=e,b=i[s(690)],h=n.getLevel(),p=this.shouldMultipleTotal(a,h,o);if(h===0)if(p){let I=0;for(const v of r){const{displayName:C}=d[v];b[s(587)](I+x,0,""+C),b[s(730)](I+x,0,A0.MultipleGrandTotal),b.setInfo(I+x,{paths:n[s(639)](),valueIndex:I,isBottomTotal:!0,level:h,tableFieldId:""}),this[s(1052)](e,x+I),I++}}else{l===0&&u!==0&&f[s(1015)]===1?b[s(587)](x,0,f[0].displayName):(b[s(587)](x,0,""),b[s(730)](x,0,A0[s(567)]));const I=a?c[r[0]]:-1;b[s(924)](x,{paths:n.getPaths(),valueIndex:I,isBottomTotal:!0,level:h,tableFieldId:""}),this.layoutValueNodeSubtotal(e,x)}else{let I=this[s(955)](h,o,a);const v=n.getCollapse(),C=n[s(922)](),w=n[s(774)]===R0[s(902)],y=n[s(774)]===R0[s(575)];if(v&&I++,p){let P=0;const E=e.valueIndex;for(const S of r){const{displayName:T}=d[S];if(v)b[s(587)](x+P,E,T);else{const k=v?""+T:{prefix:n[s(627)],value:T};b[s(587)](x+P,I,k),w&&b[s(934)](x+P,I),y&&b[s(923)](x+P,I),b[s(730)](x+P,I,A0[s(651)])}b[s(924)](x+P,{paths:n[s(639)](),valueIndex:P,isBottomTotal:!0,level:h,tableFieldId:C}),this[s(1052)](e,x+P),P++}}else{v||(b[s(587)](x,I,n.name),w&&b[s(934)](x,I),b[s(730)](x,I,A0.Subtotal));const P=a?c[r[0]]:-1;b[s(924)](x,{paths:n[s(639)](),valueIndex:P,isBottomTotal:!0,level:h,tableFieldId:C}),this[s(1052)](e,x)}}}};class ea{constructor(e,x,n){const r=m;L(this,r(983)),L(this,r(875)),L(this,r(910)),L(this,r(742)),L(this,"isLeaf"),L(this,r(627)),L(this,"fieldId"),L(this,r(790)),L(this,r(638),[]),L(this,r(916),!1),L(this,"type"),L(this,r(887),{}),this._index=e,this[r(609)]=x,this[r(774)]=n}[m(693)](){return this[m(790)]}setCollapse(e){const x=m;this[x(790)]=e}[m(922)](){return this[m(609)]}iterate(e){const x=m;if(this[x(916)])for(const n of this[x(638)]){const r=this[x(887)][n];e(r)}else{const n=Object[x(971)](this[x(887)]);for(let r=0;r<n[x(1015)];r++){const s=this[x(887)][n[r]];e(s)}}}getIndex(){return this[m(983)]}[m(1066)](e){return this[m(887)][e]!==void 0}setParentIndex(e){const x=m;this[x(910)]=e}[m(995)](e){const x=m;this[x(875)]=e}[m(605)](){return this[m(875)]}[m(1042)](e){const x=m;this[x(742)]=e}[m(639)](){return this.paths}setLeaf(){const e=m;this[e(483)]=!0}[m(999)](){return!!this[m(483)]}[m(1035)](e){const x=m;this[x(627)]=e}[m(817)](e,x,n,r){const s=m;this._nodes[x]=e,e.setName(x),e[s(625)](this._index),e[s(995)](this[s(875)]+1),e[s(1042)](this[s(742)][s(754)](x)),n&&(this[s(979)](x,n,r),this[s(916)]=!0)}[m(979)](e,x,n){const r=m,s=x[e],i=this[r(638)];let a=0,o=i[r(1015)];const d=n!==we[r(596)];for(;a<o;){const c=Math[r(520)]((a+o)/2);(d?x[i[c]]-s:s-x[i[c]])<0?a=c+1:o=c}i[r(704)](a,0,e)}getNode(e){return this[m(887)][e]}}class U8{constructor(e,x){const n=m;L(this,"counter"),L(this,"rowDimOrder"),L(this,"colDimOrder"),L(this,n(941)),L(this,"colTableIdList"),L(this,n(1012)),L(this,"colDeep"),L(this,n(1069)),L(this,n(870)),L(this,"measuresMap",{}),L(this,n(797),[]),L(this,n(570),{}),L(this,n(911),[]),L(this,"dimensionTableIdList",[]),L(this,n(473),[]),L(this,"_rowLevelPool",{}),L(this,n(831),{}),L(this,n(545)),L(this,"colNodeTree"),L(this,n(842),{}),L(this,n(943),{}),L(this,"collapseInfo"),L(this,n(948),{}),L(this,n(845),[]),L(this,n(947),{}),this[n(797)]=x.tuples.concat();const r=e[n(1058)],s=e.colQueryInfo,{tuples:i,dimensionMap:a,dimensionTableIdList:o,tupleMap:d,dimensionIdList:c,measuresMap:l,measureIdList:u}=x,f=r.length,b=s[n(1015)];this[n(569)]=o,this[n(466)]=i[n(1015)],this[n(870)]=i[n(1015)],this[n(599)]=e.collapseInfo,this[n(570)]={...d},this.measuresMap={...l},this[n(473)]=u,this.dimensionIdList=c,this[n(842)]=a,this.valueFilterInfo=e.valueFilterInfo;const h=e[n(980)];for(const y of h){const P=y.id,E=y[n(482)];E!==void 0&&(this[n(947)][P]={subTotal:E,dataFieldId:y[n(811)]})}const p=[],I=[],v=new Map;for(const[y,P]of o[n(853)]())v[n(631)](P,y);for(let y=0;y<f;y++){const P=r[y].id;p[n(961)](v[n(586)](P)),I[n(961)](P)}const C=[],w=[];for(let y=0;y<b;y++){const P=s[y].id;C[n(961)](v.get(P)),w.push(P)}this.rowDimOrder=p[n(754)](C),this[n(612)]=C[n(754)](p),this[n(941)]=I[n(754)](w),this[n(894)]=w[n(754)](I),this.rowDeep=f,this[n(819)]=b,this.measureCount=this[n(473)][n(1015)],this[n(486)](e)}createSummaryLabelSortedMap(e){const x=m,{rowQueryInfo:n,colQueryInfo:r}=e;for(const s of[...n,...r]){const i=s[x(900)],a=s.id;if(i)if(l8(i)){const o={},d=i[x(619)];for(let c=0;c<d[x(1015)];c++){const l=d[c];o[l]=c}this.dimensionSortInfo[a]={type:i[x(774)],sortMap:o}}else{const o=this.getSortedMap(a,this[x(842)][s[x(811)]][x(723)]);this[x(948)][a]={type:i[x(774)],sortMap:o}}else if(sx[x(706)]!=="default"){const o=sx.defaultSortType,d=this[x(963)](a,this[x(842)][s[x(811)]][x(723)]),c=o===x(467)?we.ascending:we[x(596)];this[x(948)][a]={type:c,sortMap:d}}}}getCellValue(e,x,n){const r=m,s=this[r(797)][e];if(s&&s[r(680)])return s[r(680)][x][n]}[m(963)](e,x){const n=m,r=this[n(948)][e];if(r&&r[n(975)])return r.sortMap;const s=x[n(959)],i=x[n(1001)];return x[n(826)](),a8(s,i)}[m(836)](){const e=m;this[e(927)](new Set);const x=this[e(697)]();this.buildNodeTree(x),this.calculateSubtotal(x)}[m(526)](){return this.counter++}buildNodeTree(e){const x=m;this[x(545)]=this._buildNodeTreeImp(this.rowDimOrder,this.rowTableIdList,this[x(752)],sx[x(700)],e),this[x(1012)]===0||this.colDeep===0?this[x(823)]=this.rowNodeTree:this[x(823)]=this[x(1054)](this[x(612)],this.colTableIdList,this[x(831)],sx[x(882)],e)}createTupleWithoutCheck(e,x,n){const r=m,s={path:e,indexes:[],tuple:{},types:[]};for(const i of this[r(473)]){const a=new wn;s.tuple[i]=a}this[r(797)][x]=s,this[r(570)][n]=x}[m(1054)](e,x,n,r,s){const i=m;var a;const o=this._getIndex(),d=0,c=new ea(o,"",R0[i(931)]);c[i(625)](-1),c[i(995)](d),c[i(1042)]([]),this.createTupleWithoutCheck(c[i(639)](),o,r);const l=this[i(599)],u=this[i(1012)]+this[i(819)],f=this[i(569)];for(let b=0;b<this[i(870)];b++){if(s.has(b))continue;const h=this[i(797)][b];let p=c,I=0;for(const v of e){const C=h.path[v],w=h[i(650)][v],y=f[v];if(!p[i(1066)](C)){const P=I===u-1,E=P?b:this[i(526)](),S=new ea(E,y,w);S.setCollapse(t8(l,y,C));const T=(a=this.dimensionSortInfo[y])!=null?a:{},{sortMap:k,type:V}=T;p[i(817)](S,C,k,V);const H=S[i(605)]();P?S[i(701)]():this[i(909)](E,S[i(639)](),x),n[H]=n[H]||[],n[H].push({p:p[i(1023)](),v:E})}p=p[i(783)](C),I++}}return c}combinePathMapList(e,x){const n=m;if(this.combinePathMap[x])return this.combinePathMap[x];const r={};this[n(943)][x]=r;const s={};for(const i of e)for(const a in i){const o=[x,a][n(863)](sx[n(1064)]);if(r[a]===void 0){const d=this[n(526)]();this[n(1025)](d,o),r[a]=d}s[o]===void 0&&(s[o]=[]),s[o][n(961)](i[a])}for(const i in s){const a=s[i],o=this[n(797)][this[n(570)][i]];this[n(859)](o,a)}return r}[m(859)](e,x){const n=m;e.summary||(e[n(680)]={});const r=e[n(680)];for(const s in this[n(759)]){const i=this[n(759)][s][n(820)],a=e.tuple[s],o=x.map(c=>this.tuples[c][n(939)][s]);a[n(873)](o);const d=a[n(885)]();for(const c of i)d[c]=a.getSubtotal(c);r[s]=d}}[m(557)](e){const x=m;this[x(890)](this[x(752)],e),this[x(890)](this[x(831)],e);const n=this[x(797)][this[x(545)][x(1023)]()],r=this[x(797)][this.colNodeTree[x(1023)]()];this[x(1012)]+this.colDeep===0&&this.tuples[x(1015)]>0&&Yn(this[x(797)][0],n,this[x(759)]),Yn(n,void 0,this[x(759)]),Yn(r,void 0,this[x(759)])}getPathKeyWithFiledId(e,x){const n=m,r=[];for(let s=0;s<e[n(1015)];s++)r.push(""+x[s]+sx.TUPLE_FIELD_SEPARATOR+e[s]);return r[n(863)](sx.TUPLE_PLACEHOLDER)}[m(909)](e,x,n){const r=m;if(!this[r(797)][e]){const s=this[r(658)](x,n);this[r(786)](x,e,s)}}[m(1025)](e,x){const n=m;this[n(797)][e]||this[n(551)]([],x,e)}createTuple(e,x,n){const r=m,s=x||e.join(sx[r(662)]);if(!this[r(570)][s]){const i={path:e,indexes:[],tuple:{},types:[]};for(const a of this[r(473)]){const o=new wn;i[r(939)][a]=o}if(n===void 0){const a=this.tuples[r(961)](i);this.tupleMap[s]=a-1}else this[r(797)][n]=i,this[r(570)][s]=n}}[m(697)](){const e=m,x=this.valueFilterInfo,n=new Set;if(x.length>0)for(const r of x){const{fieldId:s,filterInfo:i}=r,a=i[e(1028)];this[e(750)](s,a,i,n)}return n}_doValueFilter(e,x,n,r){const s=m,i=this[s(568)](e);if(i){const{pool:a,fieldIdList:o}=i,d=o.indexOf(e);if(d===-1)return;const c=this[s(1012)]+this[s(819)],l=[],u=this[s(947)][x][s(820)],f=this[s(947)][x][s(811)];for(let v=c;v>d;v--)if(a[v]){const C=a[v];for(const{p:w,v:y}of C){if(c===v&&r[s(716)](y))continue;const P=v===c?this[s(797)][y]:void 0;d8(l,P,f,u,y,w)}}const b=a[d+1],h=fo(n);let p=new Set;for(const{v}of b){if(l[v]===void 0)continue;const C=l[v].tuple[s(468)](u);if(c8(C)){p[s(952)](v);continue}h(C)||p[s(952)](v)}let I=d+1;if(I===c){for(const v of p)r.add(v);return}for(;a[I+1];){const v=new Set,C=a[I+1];for(const{p:w,v:y}of C)p[s(716)](w)&&(v[s(952)](y),I+1===c&&r[s(952)](y));I++,p=v}}}[m(568)](e){const x=m;return this[x(1012)]===0||this[x(819)]===0?{pool:this._rowLevelPool,fieldIdList:this.rowTableIdList}:this[x(941)][x(871)](n=>n===e)<this.rowDeep?{pool:this[x(752)],fieldIdList:this[x(941)]}:this.colTableIdList.findIndex(n=>n===e)<this[x(819)]?{pool:this[x(831)],fieldIdList:this[x(894)]}:null}[m(890)](e,x){const n=m,r=this.rowDeep+this.colDeep;for(let s=r;s>=0;s--)if(e[s]){const i=e[s];for(const{p:a,v:o}of i){if(x[n(716)](o))continue;const d=this[n(797)][o];Yn(d,this.tuples[a],this[n(759)])}}}}let k8=class{constructor(){const e=m;L(this,e(797),[]),L(this,e(570),{}),L(this,e(759),{}),L(this,e(911),[]),L(this,e(569),[]),L(this,e(473),[]),L(this,e(842),{}),L(this,e(1012),0),L(this,"colDeep",0)}prepare(e,x){const n=m,{valueQueryInfo:r,rowQueryInfo:s,colQueryInfo:i,filterQueryInfo:a}=x;for(const c of r){const l=c[n(811)],u=e.getFieldById(l);if(!u)continue;this.measuresMap[l]||(this[n(473)][n(961)](l),this[n(759)][l]={field:u,subTotal:[]});const f=this[n(759)][l],{subtotal:b}=c;f[n(820)][n(731)](b)||f[n(820)][n(961)](b)}const o=s.length+i[n(1015)];let d=0;for(const c of[...s,...i,...a]){const l=e.getFieldById(c[n(811)]);l&&(this[n(842)][c[n(811)]]||(this[n(842)][c[n(811)]]={field:l}),d<o?(this[n(911)][n(961)](c[n(811)]),this[n(569)][n(961)](c.id)):c[n(984)]&&P2(c[n(984)])&&(c[n(984)][n(542)]=l[n(959)][n(1015)]===c[n(984)][n(558)][n(1015)]),d++)}this.rowDeep=s[n(1015)],this[n(819)]=i.length}[m(1036)](e){const x=m,{rowQueryInfo:n,colQueryInfo:r,filterQueryInfo:s}=e,i=[];let a=!1;const o=[...n,...r,...s];for(const{dataFieldId:d,filterInfo:c}of o){const l=this[x(842)][d].field;if(!(!l||c===void 0)){if(P2(c)){a=!0;const{list:u}=c,f=[];for(const b of u)f[x(961)](l[x(1008)](b));i[x(961)](Zi(f))}if(mo(c)){a=!0;const{operator:u,expected:f}=c;if(l[x(977)]()===R0[x(681)]){const b=l.getAllIndexMap(),h=o8(b,u,f);i.push(Zi(h))}}}}return!a&&i[x(1015)]===0?{isAll:!0,list:[]}:{isAll:!1,list:s8(i)}}query(e,x){const n=m;this[n(785)](e,x);const{isAll:r,list:s}=this[n(1036)](x);this[n(901)](r,s,e[n(515)]())}[m(768)](){const e=m;this[e(797)]=[],this.measuresMap={},this.dimensionMap={},this[e(570)]={},this.dimensionIdList=[],this[e(569)]=[],this[e(473)]=[]}[m(901)](e,x,n=0){const r=m,s=this[r(569)];if(e)for(let i=0;i<n;i++){const a=[],o=[],d=[];let c=0;for(const l of this[r(911)]){const u=this[r(842)][l].field,f=u[r(740)](i);d.push(s[c]+sx[r(1064)]+f),a[r(961)](f),o.push(u[r(724)](f)),c++}this[r(512)](a,d,i,o)}for(const i of x){const a=[],o=[],d=[];let c=0;for(const l of this[r(911)]){const u=this.dimensionMap[l][r(723)],f=u[r(740)](i);d[r(961)](s[c]+sx.TUPLE_FIELD_SEPARATOR+f),a.push(f),o[r(961)](u[r(724)](f)),c++}this[r(512)](a,d,i,o)}}[m(512)](e,x,n,r){const s=m,i=x.join(sx[s(662)]);this[s(570)][i]===void 0&&this[s(551)](e,i,void 0,r);const a=this[s(797)][this[s(570)][i]];a[s(644)][s(961)](n);for(const o of this[s(473)]){const d=a[s(939)][o],c=this[s(759)][o][s(723)][s(593)](n);d.addValue(c)}}[m(551)](e,x,n,r=[]){const s=m,i=x||e[s(863)](sx[s(662)]);if(!this.tupleMap[i]){const a={path:e,types:r,indexes:[],tuple:{}};for(const o of this[s(473)]){const d=new wn;a[s(939)][o]=d}if(n===void 0){const o=this[s(797)].push(a);this[s(570)][i]=o-1}else this[s(797)][n]=a,this[s(570)][i]=n}}};const go=class er{constructor(e,x,n){const r=m;L(this,r(1078)),L(this,"_viewVersion"),L(this,r(583)),L(this,r(886)),L(this,r(719)),L(this,r(789)),this.dataFieldsCollection=e,x?this._model=x:this[r(767)](),n&&(this[r(789)]=n)}static[m(714)](e,x){const n=m;var r;this[n(769)][e]||(this[n(769)][e]=[]),(r=this[n(769)][e])==null||r[n(961)](x)}static unRegisterCallbackWithEvent(e,x){const n=m,r=this._callbacks[e];if(r){const s=r.indexOf(x);s!==-1&&r.splice(s,1),r[n(1015)]===0&&delete this[n(769)][e]}}[m(717)](e){this.dataFieldsCollection=e}[m(828)](){return this[m(886)]?this._bufferModel:this._model}[m(725)](){const e=m;this._bufferModel=this._model[e(838)](),this._bufferModel[e(698)]()}[m(1079)](){const e=m,x=this[e(886)][e(626)]();return this._bufferModel[e(822)]()&&this[e(583)][e(654)](!0),delete this[e(886)],x}[m(767)](){const e=m;this[e(583)]=new T8}[m(965)](e,x,n){const r=m,s=this[r(1078)][r(818)](e);if(s){let i=n||this[r(1006)]();return new ms(s[r(936)](),i,x||this[r(1078)][r(851)](e),s[r(627)])}}[m(932)](e,x){const n=m,r=this[n(1078)][n(818)](e);if(r){const s=r.getFieldDataType()===R0[n(681)]?p0[n(516)]:p0[n(699)],i=(this[n(1078)][n(497)][n(476)]()||Zt)(this[n(1078)][n(851)](e),s);let a=x||this[n(1006)]();return sx[n(969)]&&(a=i+"-"+a),new fs(r[n(936)](),a,this[n(796)](i),r[n(627)])}}updateValuePosition(e,x){const n=m;this[n(828)]()[n(633)](e,x)}[m(749)](){const e=m;return this._getModel()[e(749)]()}[m(904)](){return this[m(828)]().isRowMultiMeasure()}[m(689)](){const e=m;return this[e(828)]()[e(689)]()}[m(1e3)](){const e=m;return this[e(828)]()[e(1e3)]()}[m(481)](e){const x=m;this[x(828)]()[x(481)](e)}[m(585)](e){this[m(828)]().iterateFieldDim(e)}[m(600)](e,x){const n=m;this[n(828)]()[n(600)](e,x)}[m(978)](e){const x=m;return this._getModel()[x(721)](e)[x(1015)]}[m(564)](){const e=m;return this[e(828)]()[e(533)]}[m(796)](e){const x=m,n=this[x(828)]();if(!n[x(489)](e))return e;let r=1;for(;n[x(489)](e+String(r));)r++;return e+String(r)}[m(1075)](e){const x=m;var n;const r=(n=this[x(828)]()[x(818)](e))==null?void 0:n[x(811)];if(r)return this[x(1078)][x(818)](r)}[m(884)](e){const x=[];return this.iterateField(n=>{const r=at;n.getDataFieldId()===e&&x[r(961)](n)}),x}[m(751)](e){const x=m;return this._getModel()[x(818)](e)}[m(620)](e){const x=m;return!!this[x(828)]()[x(818)](e)}[m(892)](){const e=m;return this[e(828)]()[e(892)]()}getDataFieldByDataFieldId(e){return this[m(1078)].getFieldById(e)}[m(589)](e){const x=m;return this[x(1078)][x(866)](e)}[m(953)](){const e=m;return this[e(1078)][e(953)]()}getDataFieldItemInfo(e){const x=m;return{items:e[x(959)],itemTypes:e[x(1001)]}}getUniqueFieldId(){const e=m,x=Object[e(971)](this._getModel()[e(713)])[e(1015)]+Object[e(971)](this[e(828)]()[e(794)])[e(1015)],n=Math.max(Math.ceil(Math[e(793)](x)/4),2);let r=He(n);for(;this._getModel().getFieldById(r);)r=He(n);return r}addFieldWithSourceId(e,x,n,r){const s=m;let i;if(vt(x)?i=this[s(965)](e,void 0,r):i=this[s(932)](e,r),i)return this[s(534)](i,x,n),i}[m(684)](e){this[m(828)]().setOptions(e)}[m(507)](e,x,n){this[m(828)]().updateFieldSourceInfo(e,x,n)}setSubtotalType(e,x){const n=m;this[n(828)]()[n(595)](e,x)}[m(508)](e,x){const n=m;this[n(828)]()[n(508)](e,x)}[m(673)](e,x){const n=m;this[n(828)]()[n(673)](e,x)}[m(827)](e,x){const n=m;this._getModel()[n(827)](e,x)}[m(942)](e){const x=m;return this._getModel()[x(942)](e)}[m(682)](e){return this[m(828)]().getFilterInfo(e)}[m(1070)](e){const x=m;return this[x(828)]()[x(470)][e]}updateFieldPosition(e,x,n){this[m(828)]().updateFieldPosition(e,x,n)}[m(973)](e){const x=m;return this[x(828)]()[x(973)](e)}[m(990)](e,x){this._getModel().setFieldFormat(e,x)}[m(534)](e,x,n){const r=m;this[r(828)]()[r(534)](e,x,n)}removeField(e){const x=m;this._getModel()[x(536)](e)}[m(814)](){const e=m;return this._getModel()[e(814)]()}setCollapse(e,x,n){this[m(828)]().setCollapse(e,x,n)}[m(801)](e){return this[m(840)]===e}[m(856)](e){const x=m;return this[x(828)]()[x(856)](e)}[m(938)](e){const x=m;return(!this._tupleGroupCache||this[x(828)]()[x(822)]())&&(this[x(719)]=new k8,this[x(719)][x(548)](this[x(1078)],e)),this._tupleGroupCache}[m(791)](){const e=m,x={};return this[e(828)]()[e(585)](n=>{const r=e,s=n[r(811)],i=this[r(1078)][r(818)](s);y2(i)&&(x[n[r(936)]()]=i.getGroupInfo())}),x}[m(981)](e,x){const n=m;this[n(828)]()[n(981)](e,x)}[m(792)](){const e=m;return this[e(828)]()[e(792)]()}getValueFilterInfo(e){const x=m;return this[x(828)]()[x(622)](e)}[m(1019)](e){const x=m;this[x(828)]()[x(1019)](e)}removeValueFilterInfoByValueFieldId(e){const x=m;this[x(828)]()[x(726)](e)}[m(615)](e){const x=m,n=this[x(719)],r=new Map;for(const[s,i]of n[x(569)].entries())r[x(631)](i,s);return n[x(797)][x(1038)]((s,i)=>(e[x(888)](a=>{const o=x,[d,c]=a,l=i[o(610)],u=r[o(586)](c);return u!==void 0&&l[u]===d})&&s[x(961)](...i[x(644)]),s),[]).sort((s,i)=>s-i)}[m(654)](e){this[m(828)]().setDirty(e)}[m(768)](e){const x=m;this[x(828)]()[x(768)](e)}[m(548)](e){const x=m,n=er[x(769)][vn[x(642)]];n&&n[x(687)](c=>{c(this[x(789)])});const r=e||this[x(828)]()[x(604)](),s=this[x(938)](r),i=new U8(r,s);i[x(836)]();const a=N8.layout(this,i,r);a[x(779)](),a[x(760)](this._getModel());const o=this[x(791)]();a[x(494)](o),this._viewVersion=a.getVersion(),this[x(828)]()[x(654)](!1);const d=er._callbacks[vn[x(1010)]];return d&&d.forEach(c=>{c(this._id)}),a}[m(935)](){const e=m;return this[e(828)]()[e(935)]()}fromJSON(e){const x=m;this[x(828)]()[x(525)](e)}dispose(){const e=m;this[e(1078)]=null,this[e(583)]=null}};L(go,m(769),{});let xt=go;const g=Be;(function(t,e){const x=Be,n=t();for(;;)try{if(-parseInt(x(482))/1*(-parseInt(x(569))/2)+parseInt(x(696))/3+-parseInt(x(545))/4*(parseInt(x(677))/5)+-parseInt(x(264))/6*(-parseInt(x(481))/7)+-parseInt(x(348))/8+-parseInt(x(268))/9*(parseInt(x(761))/10)+parseInt(x(235))/11*(-parseInt(x(241))/12)===e)break;n.push(n.shift())}catch{n.push(n.shift())}})(M2,293385);var D8=Object.defineProperty,O8=(t,e,x)=>e in t?D8(t,e,{enumerable:!0,configurable:!0,writable:!0,value:x}):t[e]=x,_0=(t,e,x)=>O8(t,typeof e!=g(804)?e+"":e,x);const vo=Number[g(803)](1762589730),F8=16,Br=1,Gr="SHEET_PIVOT_TABLE_PLUGIN",Fn=1,$8=g(789),A8=g(363),Wn="#b2b2b2",V8="#f4f4f5",j8=g(342),L8=g(351),H8=g(651),B8=g(588),G8=g(814),Y8="#1d32e9",W8=g(588),Q8=g(426),z8=14,J8=6;var Co=(t=>(t[g(669)]=g(505),t[g(749)]=g(357),t))(Co||{});const wo={"sheets-pivot":{blankValue:"",otherValue:"",columnName:"",subTotalText:"",grandTotalText:"",valueText:"",averageName:"",countName:"",countNumsName:"",maxName:"",minName:"",productName:"",stdDevName:"",stdDevpName:"",sumName:"",varName:"",varpName:"",value:"",blank:"",other:"",subTotal:"",grandTotal:"",emptyPivot:{filter:"",row:"",column:"",values:""},dateGroup:{year:"",month:"",day:"",hour:"",minute:"",quarter:"",monthDate:"",yearQuarter:"",yearMonth:"",yearMonthDate:""},cellDateGroupDisplay:{minute:"",hour:"",hourMinute:"",date:"",month:"",monthDate:"",quarter:"",year:"",yearMonth:"",yearMonthDate:"",yearQuarter:""}}},X8=30,ht={b:{s:1,cl:{rgb:Wn}},l:{s:1,cl:{rgb:Wn}},r:{s:1,cl:{rgb:Wn}},t:{s:1,cl:{rgb:Wn}}},Ex={bg:{rgb:$8},ht:2,vt:2,tb:1},d0={bg:{rgb:A8},ht:2,vt:2,tb:1},Ox={rowStyle:{bg:{rgb:Q8},bd:ht,bl:1,vt:2},colStyle:{bg:{rgb:Y8},bd:null,cl:{rgb:W8},bl:1,vt:2},subTotalStyle:{bd:ht,bg:{rgb:G8},vt:2},cornerStyle:{bd:ht,bg:{rgb:L8},bl:1,vt:2},pageStyle:{bd:ht,bg:{rgb:V8},vt:2},leafStyle:{bd:ht,bg:{rgb:j8},vt:2},grandTotal:{bd:null,bg:{rgb:H8},cl:{rgb:B8},bl:1,vt:2},dataStyle:{bd:ht,vt:2}};function q8(t,e,x){const n=g,r=t[n(446)](jx),s=x.split("_");switch(e){case C0[n(346)]:return r.t("sheets-pivot.cellDateGroupDisplay.year",...s);case C0.Minute:return r.t(n(485),...s);case C0[n(334)]:return r.t(n(459),...s);case C0[n(216)]:return r.t(n(775),...s);case C0[n(314)]:return r.t(n(547),...s);case C0[n(694)]:return r.t("sheets-pivot.cellDateGroupDisplay.month",...s);case C0[n(300)]:return r.t(n(269),...s);case C0.YearMonth:return r.t(n(381),...s);case C0[n(195)]:return r.t(n(546),...s);case C0[n(283)]:return r.t(n(725),...s)}return""}const Vt=(t,e,x,n)=>{const r=g;let s;const i=t[r(446)](N0)[r(565)](P0[r(659)]);if(!i)return null;const a=i[r(660)]();let o;if(x&&(o=a[r(614)](x)),e!=null&&e.v||(e==null?void 0:e.v)===0){s||(s={});const d=Po(e.v);typeof d==r(685)?s.t=zx[r(704)]:typeof d=="string"&&(s.t=zx[r(475)]),s.v=d}if((e!=null&&e.i||(e==null?void 0:e.i)===0)&&(s||(s={}),s.fi=e.i),e!=null&&e.s&&(s||(s={}),s[r(369)]=e.s),x&&(s||(s={}),s.s=o),n&&s!=null&&s.v&&s.pbt!==A0[r(428)]&&s[r(369)]!==A0[r(640)]){const d=String(s.v),{dateType:c}=n;s.v=q8(t,c,d),s.t=zx[r(475)]}return s},K8=(t,e,x,n)=>{const r=g;var s,i,a,o,d,c,l,u,f,b,h,p,I,v;const C=x.targetCellInfo,{cornerView:w,rowView:y,colView:P,dataView:E,pageView:S,formatMap:T,groupInfo:k}=e,{row:V,col:H}=C,D=new K,U={},j={},F={},z={},Q={};let G=V,Y=H;Object[r(808)](S.data).forEach(O=>{const W=r;Object.keys(S[W(499)][Number(O)]).forEach(o0=>{const r0=W,m0={...S[r0(499)][Number(O)][Number(o0)]};D[r0(614)](Number(O)+G,Number(o0)+Y,Vt(t,m0,Ox.pageStyle))})});const t0=Object[r(808)](S.data)[r(347)];G+=t0+(t0?Fn:0);const A=w.getRowCount(),Z=w[r(765)]();for(let O=0;O<A;O++)for(let W=0;W<Z;W++){const o0={...(i=(s=w[r(499)])==null?void 0:s[O])==null?void 0:i[W]};o0&&(a=y.headerMap[W])!=null&&a[r(438)]&&W===Z-1&&O===A-1&&(o0.v=""+n[r(390)]),D.setValue(O+G,W+Y,Vt(t,o0,Ox[r(304)]))}for(let O=0;O<w.info.length;O++)w[r(451)][O]&&(F[""+(O+Y)]=w.info[O]);Y+=Z;const J=P[r(732)],S0=P[r(306)]()>=0?P[r(306)]()+1:0,I0=P[r(500)]()>=0?P[r(500)]()+1:0;for(let O=0;O<I0;O++){for(let W=0;W<S0;W++){const o0={...(d=(o=P[r(499)])==null?void 0:o[W])==null?void 0:d[O]},r0=(c=J[W])==null?void 0:c.tableFieldId,m0=T[r0],a0=k[r0];o0&&(o0.v=Pn(o0,W===0&&((l=P[r(581)](O+1))==null?void 0:l[r(438)]),m0,n));let f0;m0?f0={...Ox[r(746)],n:{pattern:m0}}:f0={...Ox.colStyle},D[r(614)](W+G,O+Y,Vt(t,o0,f0,a0))}P[r(451)][O]&&(j[""+(O+Y)]=P.info[O]),P[r(732)][O+1]&&(Q[""+(O+G+1)]=P.headerMap[O+1])}G+=A;const l0=y.headerMap,T0=y[r(306)]()>=0?y.getLastRow()+1:0,L0=y[r(500)]()>=0?y[r(500)]()+1:0;for(let O=0;O<T0;O++){for(let W=0;W<L0;W++){const o0={...(f=(u=y.data)==null?void 0:u[O])==null?void 0:f[W]},r0=(b=l0[W])==null?void 0:b[r(801)],m0=T[r0],a0=k[r0];o0&&(o0.v=Pn(o0,!1,m0,n));let f0;y[r(451)][O][r(479)]===y[r(765)]()?f0=Ox[r(567)]:y.info[O][r(769)]?f0=y[r(451)][O].level===0?Ox[r(253)]:Ox[r(796)]:f0=Ox.rowStyle,m0&&(f0={...f0,n:{pattern:m0}}),D[r(614)](O+G,W+H,Vt(t,o0,f0,a0))}y[r(451)][O]&&(U[""+(O+G)]=y[r(451)][O]),y[r(732)][O]&&(z[""+(O+H)]=y[r(732)][O])}const Q0=E.getRowCount(),n0=E[r(765)]();for(let O=0;O<Q0;O++)for(let W=0;W<n0;W++){const o0={...(p=(h=E.data)==null?void 0:h[O])==null?void 0:p[W]};let r0;y[r(451)][O][r(769)]?r0=y.info[O][r(479)]===0?Ox.grandTotal:Ox[r(796)]:r0=Ox[r(186)];const m0=y[r(451)][O].valueIndex,a0=P.info[W].valueIndex,f0=Math[r(230)](m0,a0),w0=x[r(641)][r(290)][r(328)]();let Nx="";f0<0?Nx=(I=w0[0])!=null?I:"":Nx=(v=w0[f0])!=null?v:"";const be=T[Nx];be&&(r0={...r0,n:{pattern:be}}),D.setValue(O+G,W+Y,Vt(t,o0,r0))}return{valueMatrix:D,rowInfo:U,colInfo:j,cornerInfo:F,rowHeaderMap:z,colHeaderMap:Q}};function Pn(t,e,x,n){const r=g;let s=t.v;e&&(s=""+n[r(390)]);const i=t.t&&(t.t&Cn.blank)>0;i&&(s=""+n[r(747)]);const a=t.t&&(t.t&Cn[r(504)])>0;if(a&&(s=""+n[r(707)]),t.s===A0[r(640)]){let o=s,d="";v8(s)&&(o=s[r(398)],d=s.value);const c=x&&!i&&!a?Wt[r(277)](x,Number(o)):o;d?s=c+" "+d:s=c+" "+n["sheets-pivot.subTotal"]}else t.s===A0.GrandTotal&&(s=s+" "+n[r(418)]);return s}function Po(t){const e=g;if(C8(t)){const{errorType:x}=t;switch(x){case Kx.Div0:return gt[e(609)];case Kx[e(615)]:return gt[e(359)];case Kx[e(604)]:return gt[e(330)];case Kx[e(582)]:return gt[e(330)];case Kx[e(657)]:return gt[e(492)]}}return t}function $x(t,e,x=!1,n=!1){const r=g,{data:s}=e,i=e[r(408)](),a=e[r(765)]();if(i<=0||a<=0)return[];const o=e[r(500)](),d=e.getLastRow(),c=n?d>=0?d+1:0:i,l=n?o>=0?o+1:0:a,{row:u,col:f}=t,b=u,h=f;if(x){const p=[];for(const[I,v]of Object.entries(s))for(const[C,w]of Object[r(325)](v))p[r(223)](Gx(b+Number(I),h+Number(C)));return p}else{const p=n?c>0?1:0:1,I=n?l>0?1:0:1,v=u+c-p,C=f+l-I;return[{startRow:b,startColumn:h,endRow:v,endColumn:C}]}}const fx=g(708),Ms=g(200);var M0=(t=>(t[g(468)]=g(758),t[g(790)]=g(597),t[g(722)]=g(650),t.AddPivotTableWithConfig=g(770),t[g(380)]=g(437),t[g(256)]=g(596),t[g(510)]="removePivotField",t.SetPivotCollapse=g(491),t[g(374)]=g(273),t[g(227)]=g(457),t[g(521)]="setPivotSetting",t.UpdatePivotSource=g(354),t.UpdateValuePosition="updateValuePosition",t[g(616)]=g(610),t[g(690)]="setValuePivotFilter",t.SetPivotTableConfig=g(336),t[g(353)]=g(194),t))(M0||{});const Z8={"sheets-pivot.blankValue":g(754),"sheets-pivot.columnName":"Column ","sheets-pivot.subTotalText":g(483),"sheets-pivot.grandTotalText":g(494),"sheets-pivot.valueText":"Value","sheets-pivot.averageName":g(816),"sheets-pivot.countName":g(602),"sheets-pivot.countNumsName":g(602),"sheets-pivot.maxName":g(229),"sheets-pivot.minName":g(233),"sheets-pivot.productName":"Product of ","sheets-pivot.stdDevName":"StdDev of ","sheets-pivot.stdDevpName":g(188),"sheets-pivot.sumName":g(797),"sheets-pivot.varName":g(187),"sheets-pivot.varpName":g(577),"sheets-pivot.subTotal":g(640),"sheets-pivot.grandTotal":"Grand Total","sheets-pivot.value":"value","sheets-pivot.blank":g(320),"sheets-pivot.other":g(504),"sheets-pivot.emptyPivot.filter":g(468),"sheets-pivot.emptyPivot.row":g(514),"sheets-pivot.emptyPivot.column":g(598),"sheets-pivot.emptyPivot.values":g(377)},ta={undos:[],redos:[],preUndos:[],preRedos:[]},ee=n1(g(689)),yo=Cr(g(800));var tt=(t=>(t[g(532)]="add",t.delete=g(498),t.update=g(378),t))(tt||{}),X0=(t=>(t[g(340)]=g(532),t[g(819)]="set",t.Delete=g(498),t))(X0||{});const Yr={type:c0[g(738)],id:g(386),handler:()=>!0},Wr={type:c0.MUTATION,id:g(563),handler:()=>!0},T2={type:c0.MUTATION,id:g(249),handler:()=>!0},Qr={type:c0[g(738)],id:g(281),handler:()=>!0},zr={type:c0[g(738)],id:"sheet.mutation.send-init-pivot-text-local",handler:()=>!0};Object[g(767)];var xb=(t,e,x,n)=>{const r=g;for(var s=e,i=t[r(347)]-1,a;i>=0;i--)(a=t[i])&&(s=a(s)||s);return s},eb=(t,e)=>(x,n)=>e(x,n,t);let px=class extends U0{constructor(t){const e=g;super(),_0(this,"_requestResolvers",new Map),this[e(529)]=t}[g(571)](t){const e=g,{version:x}=t,n=this._requestResolvers[e(446)](x);n&&(n(t),this[e(748)][e(498)](x))}[g(389)](t){return new Promise((e,x)=>{const n=Be,r=this._generateUniqueVersion();this[n(748)][n(435)](r,e),this[n(529)][n(678)](Yr.id,{version:r,...t},{onlyLocal:!0})})}[g(686)](){return Math[g(384)]().toString(36).substring(2,16)}};px=xb([eb(0,q(g0))],px);const Ro={0:"W",1:"N",2:"O",3:"G",4:"J",5:"2",6:"y",7:"M",8:"B",9:"c",P:"0",w:"1",N:"3",H:"4",U:"5",R:"6",v:"7",O:"8",z:"9",E:"a",a:"b",W:"d",g:"e",X:"f",G:"g",e:"h",C:"i",l:"j",f:"k",T:"l",m:"m",t:"n",Q:"o",n:"p",y:"q",I:"r",o:"s",b:"t",x:"u",J:"v",Z:"w",k:"x",Y:"z",h:"A",r:"C",s:"D",p:"E",D:"F",i:"H",B:"I",c:"K",M:"L",j:"P",V:"Q",F:"R",d:"S",q:"T",S:"U",K:"V",u:"X",A:"Y",L:"Z"},Eo=g(668),tb=t=>{const e=g;var x;return((x=t[e(813)])==null?void 0:x.dataStream[e(674)](/\r\n$/,""))||""};let nb=class extends p8{constructor(e,x){const n=g;super(),_0(this,"rangeKeyMap",{}),_0(this,n(221)),_0(this,n(286)),this[n(221)]=x,this[n(286)]=e}[g(403)](){const e=g;for(const x in this[e(670)]){const n=this.dataFields[x],r=n[e(662)]();this[e(402)][r]=n[e(323)]()}}[g(431)](){const e=g,x=this[e(286)];return db[e(341)](x)}deleteDataField(e){const x=g,n=this[x(670)][e][x(319)];delete this[x(670)][e],delete this[x(402)][n]}addDataFieldWithoutUnitInfo(e){const x=g;this.dataFields[e[x(323)]()]=e}removeCollectionImp(e){const x=g;var n,r;const s=this[x(286)].getTargetByPivotId(e);if(s){const{unitId:i,subUnitId:a}=s,o=(n=this[x(286)][x(601)](i,a,e))==null?void 0:n[x(697)];this[x(286)][x(762)]({token:e,type:tt.delete,dataRangeInfo:o})}(r=this[x(299)](e))==null||r.dispose(),delete this.collections[e]}[g(662)](e,x){const{sheetName:n,unitId:r,range:s}=e,{startRow:i,endRow:a}=s;return w1(r,n,{startRow:i,endRow:a,startColumn:x,endColumn:x})}[g(309)](e){return this.dataFields[this.rangeKeyMap[e]]}[g(593)](e,x){this.rangeKeyMap[e]=x}[g(371)](e,x){const n=g;this[n(402)][x]=this.rangeKeyMap[e],delete this[n(402)][e]}[g(376)](e,x,n,r){const s=g,i=new R2(this);i[s(673)](x);const a=[];let o=0;for(const d of i[s(399)]){const c=this.getRangeKey(n,o),l=this[s(670)][d];l&&(l[s(319)]=c,this.setRangeKeyMap(c,d),a[s(223)]({index:o,dataField:l})),o++}return this[s(772)](e,i,n,r),{collection:i,updateDataFieldList:a}}getRangeStartEndInfo(e,x){const n=g;return e[n(373)]===Qx[n(741)]?{startRow:0,startColumn:e[n(294)],endRow:x[n(408)]()-1,endColumn:e[n(752)]}:{startRow:e.startRow,startColumn:e.startColumn,endRow:e[n(606)],endColumn:e.endColumn}}[g(622)](e){const x=g,{sheetName:n,range:r}=e,s=this._univerInstanceService[x(565)](P0[x(659)]),i=s[x(296)](n),a=i[x(445)](),{startColumn:o,startRow:d,endColumn:c}=this[x(734)](r,i),l=s[x(660)](),u=new R2(this);u[x(484)](e);const f=[],b={};for(let h=o;h<=c;h++){const p=a.getValue(d,h),I=this[x(662)](e,h),v=this[x(309)](I);if(v)u[x(261)](v[x(323)](),v[x(193)]());else{const C=this[x(192)]();let w=this[x(720)](p,l,b);yt(w)&&(w=Wt[x(277)](w.f,Number(w.v)));const y=this[x(211)](w,h),P=new Nt(C,y,He(3));P[x(319)]=I,this.dataFields[C]=P,u[x(261)](C,y),f[x(223)]({index:h,dataField:P})}}return{updateDataFieldList:f,collection:u}}[g(326)](e){const x=g;return this[x(286)][x(538)]()[x(515)]+" "+a1(e)}[g(211)](e,x){const n=g;return e==null||e===""?this[n(326)](x):String(e)}[g(299)](e){return this.collections[e]}addCollection(e,x,n,r){const s=g;this[s(244)][e]=x,x[s(484)](n),this[s(286)][s(762)]({token:e,type:tt[s(532)],dataRangeInfo:n,targetCellInfo:r})}handleMoveRange(e,x){const n=g,r=this[n(299)](e),s=r.getFieldIds();let i=0;for(const a of s){const o=r[n(189)](a),d=this.getRangeKey(x,i);this[n(371)](o.rangeKey,d),i++}}getPivotDirtyViewInfo(){return{runtimeCellData:{},dirtyRanges:{}}}[g(776)](e,x){const n=g;if(this[n(299)](e)){const r=this[n(289)](x),s=[];for(const d of r)this[n(402)][d]!==void 0&&s[n(223)](this[n(402)][d]);const i=this[n(209)](e),a=[],o=new Set(s);for(const d of i)o.has(d)||a[n(223)](d);return a}}[g(524)](e,x,n,r,s){const i=g;return x&&x[i(278)](r,s)?x[i(278)](r,s):n&&n[i(278)](r,s)?n.getValue(r,s):e[i(278)](r,s)}refreshDataField(e,x,n,r){const s=g,i=this[s(670)][e];if(!i)return;const{subUnitId:a,range:o,unitId:d}=x,c=this[s(221)][s(448)](d);if(!c){console[s(444)](s(718));return}const l=c[s(771)](a),u=l[s(445)](),{arrayFormulaCellDataMatrix:f,unitDataMatrix:b}=r||{},{startRow:h,startColumn:p,endRow:I}=this[s(734)](o,l);i[s(653)]();const v=c[s(660)](),C={},w=this.getMatrixValue(u,f,b,h,p+n);let y=this[s(720)](w,v,C);yt(y)&&(y=Wt[s(277)](y.f,Number(y.v)));const P=this.uniqueDataFieldName(y,p+n);i[s(706)](P);for(let E=h+1;E<=I;E++){const S=this[s(524)](u,f,b,E,p+n);i.addRecord(this.adjustSheetCellData(S,v,C),E-1-h)}}[g(349)](e,x,n){const r=g,{subUnitId:s,range:i,unitId:a}=n,o=this._univerInstanceService[r(448)](a);if(!o){console[r(444)]("workbook is not found");return}const d=o[r(771)](s),c=d[r(445)](),{startRow:l,startColumn:u,endRow:f}=this[r(734)](i,d),b=o[r(660)](),h={};for(const{dataField:p,index:I}of x){p[r(653)]();const v=this[r(524)](c,void 0,void 0,l,u+I);let C=this[r(720)](v,b,h);yt(C)&&(C=Wt[r(277)](C.f,Number(C.v)));const w=this.uniqueDataFieldName(C,u+I);p[r(706)](w)}e.updateAllDisplayName();for(let p=l+1;p<=f;p++)for(const{index:I,dataField:v}of x){const C=c[r(278)](p,u+I);v[r(599)](this[r(720)](C,b,h),p-1-l)}e[r(824)](f-l)}[g(289)](e){const x=g,{range:n}=e,{startColumn:r,endColumn:s}=n,i=[];for(let a=r;a<=s;a++)i[x(223)](this[x(662)](e,a));return i}[g(720)](e,x,n){const r=g;if(e){const{s,v:i,t:a,p:o}=e;if(o)return tb(o);const d=x[r(446)](s);if(d&&a===zx[r(704)]&&d.n){const{pattern:c}=d.n;n[c]||(n[c]=Wt[r(470)](c));const l=n[c],u=l.isDate;if(l.isText)return String(i);if(u)return{v:i,f:c}}if(a===zx.NUMBER)return Number(i);if(a===zx[r(475)]||a===zx.FORCE_STRING)return String(i);if(a===void 0){const c=Number(i);if(!Number.isNaN(c)&&String(c)===i)return c}return i??null}else return null}[g(415)](e){const x=g,{sheetName:n,range:r,unitId:s}=e,i=this._univerInstanceService[x(448)](s);if(!i)return console[x(444)]("workbook is not found"),{header:[],data:[]};const a=i[x(296)](n),o=a.getCellMatrix(),{startRow:d,startColumn:c,endRow:l,endColumn:u}=this.getRangeStartEndInfo(r,a),f=i[x(660)](),b=[],h=[],p={};for(let I=d;I<=l;I++){const v=[];for(let C=c;C<=u;C++){const w=o[x(278)](I,C);I===d?b[x(223)](w==null?null:String(w.v)):v[x(223)](this.adjustSheetCellData(w,f,p))}h.push(v)}return{header:b,data:h}}[g(658)](){const e=g;return super[e(658)]()}[g(673)](e){const x=g;super.fromJSON(e),this[x(403)]()}[g(541)](){const e=g;super[e(541)](),this.rangeKeyMap={},this[e(286)]=null}};const sb=t=>{const e=g,{targetCellInfo:x}=t,{matrixCache:n,rangesCache:r}=So({filter:e(468),row:e(514),column:e(598),values:e(377)},x),s=new K;return n.forValue((i,a,o)=>{s[e(614)](i,a,o)}),{matrix:s,rangesCache:r}},jt=t=>{const e=g;let x;if(t!=null&&t.v||(t==null?void 0:t.v)===0){x||(x={});const n=Po(t.v);typeof n==e(685)?x.t=zx.NUMBER:typeof n=="string"&&(x.t=zx[e(475)]),x.v=n}return x},rb=(t,e,x)=>{const n=g;var r,s,i,a,o,d,c,l,u,f,b,h;const{cornerView:p,rowView:I,colView:v,dataView:C,pageView:w,formatMap:y}=t,{row:P,col:E}=e,S=new K;let T=P,k=E;Object[n(808)](w[n(499)])[n(576)](A=>{const Z=n;Object.keys(w[Z(499)][Number(A)])[Z(576)](J=>{const S0=Z,I0={...w[S0(499)][Number(A)][Number(J)]};S[S0(614)](Number(A)+T,Number(J)+k,jt(I0))})});const V=Object[n(808)](w[n(499)]).length;T+=V+(V?Fn:0);const H=p.getRowCount(),D=p[n(765)]();for(let A=0;A<H;A++)for(let Z=0;Z<D;Z++){const J={...(s=(r=p[n(499)])==null?void 0:r[A])==null?void 0:s[Z]};J&&(i=I.headerMap[Z])!=null&&i[n(438)]&&Z===D-1&&A===H-1&&(J.v=""+x["sheets-pivot.value"]),S[n(614)](A+T,Z+k,jt(J))}k+=D;const U=v[n(732)],j=v[n(306)]()>=0?v[n(306)]()+1:0,F=v[n(500)]()>=0?v[n(500)]()+1:0;for(let A=0;A<F;A++)for(let Z=0;Z<j;Z++){const J={...(o=(a=v[n(499)])==null?void 0:a[A])==null?void 0:o[Z]},S0=(d=U[A])==null?void 0:d[n(801)],I0=y[S0];J&&(J.v=Pn(J,A===0&&((c=v[n(581)](Z+1))==null?void 0:c[n(438)]),I0,x)),S[n(614)](A+T,Z+k,jt(J))}T+=H;const z=I[n(732)],Q=I[n(306)]()>=0?I[n(306)]()+1:0,G=I[n(500)]()>=0?I[n(500)]()+1:0;for(let A=0;A<Q;A++)for(let Z=0;Z<G;Z++){const J={...(u=(l=I[n(499)])==null?void 0:l[A])==null?void 0:u[Z]},S0=(f=z[Z])==null?void 0:f[n(801)],I0=y[S0];J&&(J.v=Pn(J,!1,I0,x)),S[n(614)](A+T,Z+E,jt(J))}const Y=C[n(408)](),t0=C.getColCount();for(let A=0;A<Y;A++)for(let Z=0;Z<t0;Z++){const J={...(h=(b=C[n(499)])==null?void 0:b[A])==null?void 0:h[Z]};S[n(614)](A+T,Z+k,jt(J))}return S},ib=t=>{const e=g,{view:x,targetCellInfo:n,isEmpty:r,textInfo:s}=t;if(r)return sb(t);const{pageView:i,cornerView:a,rowView:o,colView:d,dataView:c}=x,l=$x(n,i,!0),u=i[e(787)]>=0?i.lastRow+1:0,f=a[e(408)](),b=a[e(765)](),h=l[e(347)]>0?Fn:0,p=$x({row:n[e(644)]+u+h,col:n[e(458)]},a,!1,!1),I=$x({row:n[e(644)]+u+h+f,col:n[e(458)]},o,!1,!0),v=$x({row:n.row+u+h,col:n[e(458)]+b},d,!1,!0),C=$x({row:n[e(644)]+u+h+f,col:n.col+b},c,!1,!1),w={rowRanges:I,colRanges:v,cornerRanges:p,dataRanges:C,pageRanges:l};return{matrix:rb(x,n,s),rangesCache:w}};var ab=(t,e,x,n)=>{for(var r=e,s=t.length-1,i;s>=0;s--)(i=t[s])&&(r=i(r)||r);return r},Lt=(t,e)=>(x,n)=>e(x,n,t);let tx=class extends U0{constructor(t,e,x,n,r){const s=g;super(),_0(this,s(820),new Map),_0(this,s(794),new Map),_0(this,s(345),new Map),_0(this,s(395)),_0(this,s(798),new Pe),_0(this,s(766),this[s(798)][s(397)]()),_0(this,s(652),new Pe),_0(this,"viewData$",this._viewData$[s(397)]()),_0(this,s(648),new Pe),_0(this,s(680),this[s(648)][s(397)]()),_0(this,s(508),new Map),_0(this,s(783),[]),_0(this,s(366),new Map),this[s(236)]=t,this[s(221)]=e,this[s(564)]=x,this[s(529)]=n,this[s(267)]=r,this[s(671)]()}[g(538)](){const t=g;return this[t(395)]?this[t(395)]:Z8}[g(810)](t){this._textInfo=t}[g(624)](t){const e=g;var x;const{from:n,to:r,unitId:s,fromRange:i,toRange:a}=t;if(n&&r){const o=this[e(795)](s),d=this[e(820)][e(446)](s),c=(x=this[e(221)][e(448)](s))==null?void 0:x.getSheetBySheetId(r[e(310)]);if(!d||!c)return;const l=c==null?void 0:c[e(193)]();for(const[u,f]of d.entries())for(const[b,h]of f[e(325)]()){const{sourceRangeInfo:p}=h;if(p[e(786)]===s&&p[e(310)]===n[e(310)]&&x0[e(679)](i,p[e(313)])){const I={row:p.range[e(799)]-i[e(799)],col:p[e(313)][e(294)]-i[e(294)]},v={unitId:s,subUnitId:r[e(310)],sheetName:l,range:{startRow:a[e(799)]+I[e(644)],endRow:a.startRow+I[e(644)]+p[e(313)][e(606)]-p[e(313)][e(799)],startColumn:a[e(294)]+I[e(458)],endColumn:a[e(294)]+I[e(458)]+p[e(313)][e(752)]-p[e(313)][e(294)]}};o[e(624)](b,v);const C={...h,sourceRangeInfo:v};this._updateModelCache(s,r[e(310)],b,C),this[e(762)]({unitId:s,token:b,type:tt[e(378)],oldSourceRangeInfo:p,dataRangeInfo:v,targetCellInfo:h.targetCellInfo}),this[e(297)]({unitId:s,subUnitId:r[e(310)],oldSubUnitId:u,pivotTableId:b,pivotTableConfig:C,collectionConfig:o.toJSON()})}}}}[g(762)](t){const e=g;this._collectionChange$[e(523)](t)}getDataFieldManager(t){const e=g;let x=this._dataFieldManagerCollection[e(446)](t);return x||(x=new nb(this,this[e(221)]),this[e(508)][e(435)](t,x)),x}[g(299)](t,e){const x=g;return this[x(795)](t)[x(244)][e]}getUpdateRangeDeleteIds(t,e,x){const n=g;return this[n(795)](t)[n(776)](e,x)}[g(379)](t,e){const x=g;let n=this[x(820)][x(446)](t);n||(n=new Map,this[x(820)][x(435)](t,n));let r=n[x(446)](e);return r||(r=new Map,n.set(e,r)),r}[g(487)](t,e,x,n){const r=g;this[r(379)](t,e)[r(435)](x,n)}[g(298)](t,e,x){const n=g;var r,s,i,a;(s=(r=this[n(820)][n(446)](t))==null?void 0:r[n(446)](e))!=null&&s[n(446)](x)&&((a=(i=this[n(820)].get(t))==null?void 0:i.get(e))==null||a[n(498)](x))}[g(600)](t,e){const x=g;this[x(794)][x(435)](t,e)}_deletePivotTableInstanceCache(t){const e=g;this[e(794)][e(498)](t)}_ensureViewDataMap(t,e){const x=g;let n=this._viewData[x(446)](t);n||(n=new Map,this[x(345)][x(435)](t,n));let r=n[x(446)](e);return r||(r=new Map,n[x(435)](e,r)),r}[g(297)](t){const e=g,{unitId:x,subUnitId:n,pivotTableId:r,pivotTableConfig:s,collectionConfig:i}=t,a={unitId:x,subUnitId:n,oldSubUnitId:n,pivotTableId:r,pivotTableConfig:s,collectionConfig:i};this[e(529)][e(678)](Qr.id,a,{onlyLocal:!0})}[g(231)](t,e,x,n,r,s,i,a=!1){const o=g;var d;this[o(529)][o(678)](T2.id,{single:{unitId:t,subUnitId:e,type:x,pivotTableId:n,view:r,pivotConfig:s},collectionConfig:{[t]:i}},{onlyLocal:!0});const c=!!((d=this[o(513)](n))!=null&&d.isEmpty()),l=this[o(601)](t,e,n);l&&this.updateViewData({view:r,pivotTableId:n,textInfo:this[o(538)](),isEmpty:c,targetCellInfo:l[o(639)]},a)}[g(196)](t,e){const x=g,{targetCellInfo:n,pivotTableId:r}=t,{unitId:s,subUnitId:i}=n,a=this[x(631)](s,i),o=a[x(446)](r);let d,c;o&&(d=o[x(676)],c=o[x(525)]);const{rangesCache:l,matrix:u}=ib(t);a[x(435)](r,{rangeCache:l,matrix:u,oldMatrix:c,oldRangeCache:d}),e||this[x(652)].next({unitId:s,subUnitId:i,pivotTableId:r})}[g(437)](t,e,x,n,r){const s=g;this._updateModelCache(t,e,x,r),this[s(600)](x,n)}[g(254)](t,e,x){const n=g,r=this[n(795)](t);r[n(209)](x).forEach(s=>{r.deleteDataField(s)}),this.removeCollections(t,x),this[n(298)](t,e,x),this[n(472)](x)}setPivotTable(t,e,x,n){this[g(487)](t,e,x,n)}getPivotTableConfig(t,e,x){const n=g;var r,s;const i=(s=(r=this[n(820)][n(446)](t))==null?void 0:r[n(446)](e))==null?void 0:s.get(x);if(i)return i}[g(594)](t,e,x){const n=g;var r,s;const i=(s=(r=this[n(820)][n(446)](t))==null?void 0:r.get(e))==null?void 0:s.get(x);if(i)return i[n(641)]}[g(513)](t){const e=g;return this[e(794)][e(446)](t)}deleteUnitId(t){const e=g;this._model[e(498)](t);const x=this[e(508)][e(446)](t);x&&(x[e(541)](),this[e(508)][e(498)](t)),this._viewData[e(498)](t),this[e(783)][e(576)](n=>{n[e(716)](t)})}[g(376)](t,e,x,n){const r=g;return this[r(795)](x[r(786)])[r(376)](t,e,x,n)}[g(622)](t){const e=g;return this.getDataFieldManager(t[e(786)]).createCollectionWithDataRange(t)}[g(349)](t,e,x){const n=g;this[n(795)](x.unitId)[n(349)](t,e,x)}[g(586)](t,e){const x=g;this[x(795)](t)[x(721)](e)}[g(700)](t,e){const x=g;this[x(795)](t)[x(703)](e)}[g(406)](t,e){const x=g;var n;return(n=this[x(820)][x(446)](t))==null?void 0:n.get(e)}getTargetByPivotId(t){const e=g;for(const[x,n]of this[e(820)][e(325)]())for(const[r,s]of n[e(325)]())if(s[e(361)](t))return{unitId:x,subUnitId:r};return null}[g(773)](t,e,x,n){const r=g,s=this[r(631)](t,e);n?s[r(435)](x,n):s.delete(x),this[r(652)].next({unitId:t,subUnitId:e,pivotTableId:x})}[g(541)](){super.dispose()}[g(825)](t,e,x){const n=g;var r,s;return((s=(r=this[n(345)][n(446)](t))==null?void 0:r[n(446)](e))==null?void 0:s[n(446)](x))||null}[g(198)](t){this.updateDirtyPivotTable(t)}[g(778)](t){const e=g,{token:x,unitId:n,subUnitId:r}=t,s=n+"-"+r+"-"+x;this._queryingMap[e(446)](s)&&clearTimeout(this[e(366)][e(446)](s));const i=setTimeout(()=>{this[e(358)](t),this._queryingMap.delete(s)},X8);this[e(366)][e(435)](s,i)}[g(358)](t){const e=g,{unitId:x,subUnitId:n,token:r,type:s,pivotConfig:i}=t,a=this[e(513)](r),o=a==null?void 0:a.query(),d=i??this[e(601)](x,n,r);d&&(d[e(691)]=!!(a!=null&&a.isEmpty())),(o||s===X0[e(476)])&&this[e(231)](x,n,s,r,o,d,this[e(795)](x)[e(658)]())}[g(658)](t){const e=g,x={dataFieldManagerConfig:{},pivotTableConfigs:{}};if(this[e(795)](t)&&(x.dataFieldManagerConfig[t]=this[e(795)](t)[e(658)]()),this[e(820)].get(t)){x[e(695)][t]={};const n=this[e(820)][e(446)](t);n!=null&&n[e(692)]&&[...n[e(808)]()].forEach(r=>{const s=e,i=n[s(446)](r);i!=null&&i[s(692)]&&(x[s(695)][t][r]={},[...i[s(808)]()][s(576)](a=>{const o=s,d=i[o(446)](a);d&&(x[o(695)][t][r][a]=d)}))})}return x}[g(673)](t){const e=g;var x;const{dataFieldManagerConfig:n,pivotTableConfigs:r}=t;n&&Object.keys(n)[e(576)](i=>{this[e(795)](i).fromJSON(n[i])});const s=[];if(r){const i=(x=this[e(236)][e(446)](W0)[e(506)](et))!=null?x:{},{ls:a,pbk:o}=i,d=Xr(Br,a,o)[e(232)];Object[e(808)](r)[e(576)](c=>{const l=e;let u=0;const f=r[c];Object[l(808)](f)[l(576)](b=>{const h=l,p=f[b];Object[h(808)](p).forEach(I=>{const v=h,C=p[I];if(C){if(u>=d)return;u++;const w=this[v(795)](c),y=w[v(244)][I],P=y[v(344)]();let E=0;const S=[];for(const D of P){const U=y[v(189)](D);if(y2(U)){const j=U[v(265)](),F=y.getFieldById(j);F&&S[v(223)]([U,F]);continue}w[v(422)](D,C[v(697)],E),E++}S.forEach(([D,U])=>{D[v(461)](U)});const T=new xt(y);T.fromJSON(C[v(641)]),this[v(437)](c,b,I,T,C);const k=T[v(705)]();s.push({unitId:c,subUnitId:b,pivotTableId:I,view:k[v(658)](),pivotConfig:C,type:X0.Add});const V=!!T[v(691)](),H={view:k,pivotTableId:I,textInfo:this.getTextInfo(),isEmpty:V,targetCellInfo:C.targetCellInfo};this[v(196)](H,!1)}})})})}n&&Object[e(808)](n)[e(576)](i=>{const a=e,o=this[a(795)](i);this._fieldsCollectionChange$[a(523)](o[a(244)])}),this[e(529)].executeCommand(T2.id,{batch:s,collectionConfig:n},{onlyLocal:!0})}[g(671)](){const t=g;this[t(416)](this[t(267)].registerPluginResource({toJson:e=>JSON.stringify(this[t(658)](e)),parseJson:e=>{if(!e)return{};try{return JSON.parse(e)}catch{return{}}},businesses:[P0[t(659)]],pluginName:Gr,onLoad:(e,x)=>{this[t(673)](x)},onUnLoad:e=>{this[t(716)](e)}}))}};tx=ab([Lt(0,q(Vx)),Lt(1,N0),Lt(2,q(va)),Lt(3,g0),Lt(4,q(q2))],tx);const ob={0:{0:{v:g(758),s:Ex}},2:{1:{v:"",s:Ex},2:{v:"",s:Ex},3:{v:g(583),s:Ex},4:{v:"",s:Ex},5:{v:"",s:Ex}},3:{0:{v:"",s:Ex},1:{v:"",s:d0},2:{v:"",s:d0},3:{v:"",s:d0},4:{v:"",s:d0},5:{v:"",s:d0}},4:{0:{v:"",s:Ex},1:{v:"",s:d0},2:{v:"",s:d0},3:{v:"",s:d0},4:{v:"",s:d0},5:{v:"",s:d0}},5:{0:{v:"",s:Ex},1:{v:"",s:d0},2:{v:"",s:d0},3:{v:"",s:d0},4:{v:"",s:d0},5:{v:"",s:d0}},6:{0:{v:"",s:Ex},1:{v:"",s:d0},2:{v:"",s:d0},3:{v:"",s:d0},4:{v:"",s:d0},5:{v:"",s:d0}},7:{0:{v:"",s:Ex},1:{v:"",s:d0},2:{v:"",s:d0},3:{v:"",s:d0},4:{v:"",s:d0},5:{v:"",s:d0}},8:{0:{v:g(644),s:Ex},1:{v:"",s:d0},2:{v:"",s:d0},3:{v:"values",s:d0},4:{v:"",s:d0},5:{v:"",s:d0}},9:{0:{v:"",s:Ex},1:{v:"",s:d0},2:{v:"",s:d0},3:{v:"",s:d0},4:{v:"",s:d0},5:{v:"",s:d0}},10:{0:{v:"",s:Ex},1:{v:"",s:d0},2:{v:"",s:d0},3:{v:"",s:d0},4:{v:"",s:d0},5:{v:"",s:d0}},11:{0:{v:"",s:Ex},1:{v:"",s:d0},2:{v:"",s:d0},3:{v:"",s:d0},4:{v:"",s:d0},5:{v:"",s:d0}},12:{0:{v:"",s:Ex},1:{v:"",s:d0},2:{v:"",s:d0},3:{v:"",s:d0},4:{v:"",s:d0},5:{v:"",s:d0}},13:{0:{v:"",s:Ex},1:{v:"",s:d0},2:{v:"",s:d0},3:{v:"",s:d0},4:{v:"",s:d0},5:{v:"",s:d0}}},Ns={rowRanges:[{startRow:3,endRow:13,startColumn:0,endColumn:0}],colRanges:[{startRow:2,endRow:2,startColumn:1,endColumn:5}],dataRanges:[{startRow:3,endRow:13,startColumn:1,endColumn:5}],pageRanges:[{startRow:0,endRow:0,startColumn:0,endColumn:0}],cornerRanges:[]},So=(t,e)=>{const x=g,n=new K,r=new K(ob),{row:s,col:i}=e;r[x(434)]((o,d,c)=>{const l=x;let u="";c.v===l(758)?u=t[l(758)]:c.v===l(644)?u=t.row:c.v===l(583)?u=t[l(583)]:c.v===l(258)&&(u=t[l(258)]),n[l(614)](o+s,d+i,{...c,v:u})});const a=R[x(777)](Ns);return Object[x(808)](Ns)[x(576)](o=>{const d=x;a[o]=Ns[o][d(714)](c=>({...c,startRow:c.startRow+s,endRow:c[d(606)]+s,startColumn:c[d(294)]+i,endColumn:c.endColumn+i}))}),{matrixCache:n,rangesCache:a}};function db(t,e){const x=g;let n="";const r=this[x(538)]();switch(e){case p0[x(544)]:n=r[x(715)]+t;break;case p0[x(232)]:n=r[x(661)]+t;break;case p0[x(251)]:n=r[x(709)]+t;break;case p0[x(230)]:n=r[x(252)]+t;break;case p0[x(646)]:n=r[x(337)]+t;break;case p0[x(202)]:n=r[x(419)]+t;break;case p0.stdDev:n=r[x(811)]+t;break;case p0[x(727)]:n=r["sheets-pivot.stdDevpName"]+t;break;case p0[x(812)]:n=r[x(355)]+t;break;case p0.var:n=r["sheets-pivot.varName"]+t;break;case p0.varp:n=r["sheets-pivot.varpName"]+t;break;default:n=t;break}return n}function cb(t,e,x,n,r){const s=g;var i,a,o,d,c;const l=Gx(t,e),{rangesInfo:u,areaInfo:f,headerMap:b}=r;if(!u||!f||!b)return;const h=Object.keys(u)[s(702)](w=>u[w][s(213)](y=>x0[s(679)](y,l))),p=f;let I,v,C;if(h==="rowRanges")I=(i=p==null?void 0:p[s(743)])==null?void 0:i[t],v=(a=b==null?void 0:b[s(201)])==null?void 0:a[e],C=v==null?void 0:v[s(801)];else if(h===s(478))I=(o=p==null?void 0:p[s(737)])==null?void 0:o[e],v=(d=b[s(540)])==null?void 0:d[t+1+e-u[s(478)][0][s(294)]],C=v==null?void 0:v[s(801)];else if(h===s(496))I=(c=p==null?void 0:p.cornerInfo)==null?void 0:c[e],C=I==null?void 0:I[s(801)];else if(h===s(717)){const w=x==null?void 0:x.fi;w!==void 0&&(C=n[s(568)](w))}return{filterId:C,info:I,data:x,headerInfo:v}}function lb(t,e,x){const n=g,r=t[n(191)],s=r[n(344)](),i=new Set;t[n(285)](f=>{i.add(f.dataFieldId)});const a=s[n(714)](f=>{const b=n,h=r[b(189)](f);return{checked:i[b(361)](f),dataFieldId:h.id,id:h.id,name:r.getDisplayName(h.id),type:h[b(621)](),pivotTableId:e}}),o=[];t[n(592)](e0.Row,f=>{const b=n;o[b(223)]({dataFieldId:f.dataFieldId,tableFieldId:f[b(323)](),displayName:f[b(509)]()})});const d=[];t[n(592)](e0[n(598)],f=>{const b=n;d[b(223)]({dataFieldId:f.dataFieldId,tableFieldId:f[b(323)](),displayName:f[b(509)]()})});const c=[];if(t[n(592)](e0[n(642)],f=>{const b=n;c[b(223)]({dataFieldId:f[b(760)],tableFieldId:f[b(323)](),displayName:f[b(509)](),format:f[b(271)](),subTotalType:f.getSubtotal()})}),c[n(347)]>1){const f=t.getValueIndex();(t[n(647)]()?d:o).splice(f,0,{dataFieldId:"",tableFieldId:n(203),displayName:n(550)})}const l=[];t[n(592)](e0[n(468)],f=>{const b=n;l[b(223)]({dataFieldId:f[b(760)],tableFieldId:f.getId(),displayName:f[b(509)]()})});const u=x[n(697)];return{sourceList:a,sourceRange:u,rowFields:o,columnFields:d,valueFields:c,filterFields:l,positionInfo:x[n(639)]}}function Jr(t,e,x="",n={}){const r=g,s=t[r(446)](jx);for(const i in e)if(Object[r(802)][r(623)][r(656)](e,i)){const a=x?x+"."+i:i;typeof e[i]==r(539)&&e[i]!==null&&!Array[r(293)](e[i])?Jr(t,e[i],a,n):n[a]=s.t(a)}return n}const tr=t=>{const e=g;if(!t)return[];const{rowRanges:x,colRanges:n,cornerRanges:r,dataRanges:s,pageRanges:i}=t,a=[...n,...x,...s,...r][e(758)](u=>u[e(799)]>=0&&u[e(294)]>=0&&u[e(606)]>=0&&u[e(752)]>=0);let o=Number[e(473)],d=Number[e(560)],c=Number.MAX_SAFE_INTEGER,l=Number[e(560)];for(let u=0;u<a[e(347)];u++)o=Math.min(o,a[u][e(799)]),d=Math.max(d,a[u].endRow),c=Math[e(646)](c,a[u][e(294)]),l=Math.max(l,a[u][e(752)]);return[...i,{startRow:o,endRow:d,startColumn:c,endColumn:l}]};function ub(t,e){const x=g,n=e[x(324)][x(610)],{pivotTableId:r,unitId:s,subUnitId:i}=e;if(!n)return;const a=t[x(446)](tx),o=a[x(513)](r),d=a.getPivotTableConfig(s,i,r);if(!o||!d)return;const c=o[x(474)](n[x(519)]);if(!(c!=null&&c.length))return;const l=d.sourceRangeInfo,{unitId:u,subUnitId:f,range:b}=l;let h=0;const p=o[x(191)].getFieldIds().reduce((I,v)=>{const C=x;var w;const y=(w=o[C(645)](v))==null?void 0:w[C(744)]();return y&&(I[String(h)]=y),h++,I},{});return{indexes:c,range:b,sourceUnitId:u,sourceSubUnitId:f,formatMap:p}}function To(t,e){const x=g;if(!t||!e)return!0;const n=Un(Eo,Ro),r=new Function(x(735)+n)()(t,e)[x(432)],s=In(r,"sf",vo);return!((r==null?void 0:r.rt)===os.NO_COMMERCIAL&&!s)}function Xr(t,e,x){const n=g,r={count:t,timeValid:!1};if(!e||!x)return r;const s=Un(Eo,Ro),i=new Function("return "+s)()(e,x);if(i!=null&&i[n(433)]){const a=i.message,o=In(a,"sf",vo);return{count:q1(a,o,n(464),t,t,0),timeValid:o}}return r}function Mo(t,e,x,n){const r=g,s={subUnitId:x,unitId:e,cellValue:v1(n)},i=C1(t,s);let a=!1;return new K(i[r(780)])[r(434)]((o,d,c)=>{if(!a&&c&&(c[r(528)]||c.f||c.p||c.s||c.si||c.t||c.v))return a=!0,!1}),{setRangeValueUndoMutation:{id:H0.id,params:i},setRangeValueRedoMutation:{id:H0.id,params:s},shouldClear:a}}function fb(t){const{row:e,col:x}=t,n={startRow:e,endRow:e,startColumn:x,endColumn:x},r={startRow:e+2,endRow:e+14,startColumn:x,endColumn:x+6};return[n,r]}function mb(t,e,x){const n=g,{cornerView:r,rowView:s,colView:i,pageView:a}=t,{row:o,col:d}=e;if(x)return{rowCount:z8+o,colCount:J8+d};const c=a[n(787)]>-1?a[n(787)]+1:0,l=a[n(573)]>-1?a[n(573)]:0,u=o+c+(c?1:0)+r[n(417)]+s[n(417)],f=d+l,b=d+r[n(392)]+i[n(392)],h=Math[n(230)](f,b);return{rowCount:u,colCount:h}}function fe(t,e,x,n){const r=g,{row:s,col:i,unitId:a,subUnitId:o}=x,d=mb(e,{row:s,col:i},n),c=t[r(446)](N0),l=ax(c,{unitId:a,subUnitId:o}),u=[],f=[];if(!l)return{undos:f,redos:u};const{worksheet:b}=l,h=b[r(408)](),p=b[r(566)]();return h<d[r(417)]&&(u[r(223)]({id:G0.id,params:{unitId:a,subUnitId:o,range:{startRow:h,endRow:d[r(417)]-1,startColumn:0,endColumn:p-1}}}),f[r(223)]({id:j0.id,params:{unitId:a,subUnitId:o,range:{startRow:h,endRow:d[r(417)]-1,startColumn:0,endColumn:p-1}}})),p<d[r(392)]&&(u[r(223)]({id:B0.id,params:{unitId:a,subUnitId:o,range:{startRow:0,endRow:h-1,startColumn:p,endColumn:d[r(392)]-1}}}),f[r(223)]({id:V0.id,params:{unitId:a,subUnitId:o,range:{startRow:0,endRow:h-1,startColumn:p,endColumn:d[r(392)]-1}}})),{undos:f,redos:u}}function bb(t){const e=g;let x=0;for(let n=0;n<t.length;n++){const r=t[e(548)](n);r>=19968&&r<=40959||r>=12288&&r<=12351||r>=65280&&r<=65519?x+=2:x+=1}return x}function na(t,e,x,n){const r=g;var s,i,a,o;const{rowCount:d,colCount:c,headerMap:l}=t,u=100,f=Math.min(d,u),b=Math[r(646)](c,u);let h="",p=0;for(let I=0;I<f;I++)for(let v=0;v<b;v++){const C={...(i=(s=t.data)==null?void 0:s[I])==null?void 0:i[v]},w=(a=l[I])==null?void 0:a[r(801)],y=n[w];let P=t[r(278)](I,v);if(C){const E=x?v===0&&((o=t.getHeaderMapItem(v+1))==null?void 0:o[r(438)]):!1;P=Pn(C,E,y,e)}if(P!==void 0){const E=bb(String(P));p<E&&(h=String(P),p=E)}}return h}function hb(t){const e=g,{rowCount:x,colCount:n}=t;let r="",s=0;for(let i=x-1;i>0&&i>x-3;i--)for(let a=0;a<n;a++){const o=t[e(278)](i,a);if(o!==void 0){const d=String(o)[e(347)];s<d&&(r=String(o),s=d)}}return r}function pb(t){const e=g,{rowCount:x,colCount:n}=t;let r="",s=0;for(let i=0;i<x;i++)for(let a=0;a<n;a++){const o=t[e(278)](i,a);if(o!==void 0){const d=String(o)[e(347)];s<d&&(r=String(o),s=d)}}return r}function _b(t,e){const x=g,{rowFields:n,columnFields:r,valueFields:s,filterFields:i,dimension:a,measure:o}=e;for(const c of n){const l=a[c];l&&t[x(645)](l.dataFieldId)&&(t.addFieldWithSourceId(l[x(760)],e0[x(514)],void 0,c),l[x(250)]&&t[x(460)](l.id,l[x(250)]),l[x(436)]&&t[x(821)](l.id,l[x(436)]),l[x(543)]&&t[x(291)](l.id,l[x(543)]))}for(const c of r){const l=a[c];l&&t[x(645)](l[x(760)])&&(t[x(628)](l[x(760)],e0[x(598)],void 0,c),l[x(436)]&&t.setSortInfo(l.id,l[x(436)]),l.filterInfo&&t[x(291)](l.id,l[x(543)]),l[x(250)]&&t[x(460)](l.id,l[x(250)]))}for(const c of i){const l=a[c];l&&t[x(645)](l[x(760)])&&(t[x(628)](l[x(760)],e0.Filter,void 0,c),l[x(436)]&&t[x(821)](l.id,l[x(436)]),l[x(543)]&&t[x(291)](l.id,l[x(543)]),l.displayName&&t[x(460)](l.id,l[x(250)]))}for(const c of s){const l=o[c];l&&t[x(645)](l[x(760)])&&(t[x(628)](l.dataFieldId,e0[x(642)],void 0,c),l[x(295)]!==void 0&&t[x(723)](c,l[x(295)]),l[x(277)]&&t[x(199)](c,l.format),l[x(250)]&&t[x(460)](l.id,l[x(250)]))}const d=e[x(215)];for(const{fieldId:c,filterInfo:l}of d)t[x(204)](c,l)}function Ib(t,e){const x=g,n=[];e===e0[x(514)]&&t.iterateFieldByArea(e0[x(514)],i=>{const a=x;n.push(i[a(323)]())}),e===e0[x(598)]&&t[x(592)](e0[x(598)],i=>{const a=x;n[a(223)](i[a(323)]())}),e===e0[x(468)]&&t.iterateFieldByArea(e0.Filter,i=>{const a=x;n.push(i[a(323)]())}),e===e0.Value&&t.iterateFieldByArea(e0[x(642)],i=>{n[x(223)](i.getId())}),e===void 0&&t.iterateField(i=>{const a=x;n.push(i[a(323)]())});const r=n.length;for(let i=r-1;i>=0;i--)t[x(585)](n[i]);const s=t.getValueFilterInfos();for(const i in s)t[x(279)](i)}function gb(t,e){const x=g,n=new Date(xr(e)),r=new Date(xr(t)),s=n[x(526)](),i=r.getFullYear(),a=n[x(827)](),o=r[x(827)](),d=n.getDate(),c=r[x(516)](),l=s===i,u=l&&a===o;return l&&u&&!(u&&d===c)?C0[x(195)]:l&&!u?C0[x(222)]:C0.Year}function No(t,e){const x=g,n=t[x(446)](tx).getTextInfo();let r="";switch(e){case C0.YearMonthDate:r=n["sheets-pivot.dateGroup.yearMonthDate"];break;case C0.YearMonth:r=n[x(805)];break;case C0[x(346)]:r=n[x(613)];break;case C0[x(694)]:r=n[x(401)];break;case C0.Quarter:r=n[x(557)];break;case C0[x(314)]:r=n[x(260)];break;case C0[x(216)]:r=n[x(276)];break;case C0.Hour:r=n["sheets-pivot.dateGroup.hour"];break;case C0[x(726)]:r=n[x(443)];break;case C0[x(745)]:r=n[x(394)];break;case C0.YearQuarter:r=n[x(407)];break;default:r="";break}return r}const Uo=g(368),sa={};function M2(){const t=["AddPivotField","setSubtotalType","interceptor","sheets-pivot.cellDateGroupDisplay.yearQuarter","Minute","stdDevp","getGroupFieldsInfoByIds","getDataFieldItemInfo","updateConfigCache","Collapse","headerMap","result","getRangeStartEndInfo","return ","originTargetInfo","colInfo","MUTATION","_initRemoveSheetCommandInterceptor","getSheets","COLUMN","sheet.mutation.set-pivot-filter","rowInfo","getformat","MonthDate","colStyle","sheets-pivot.blank","_requestResolvers","New","slice","pushComputingStatusSubject","endColumn","getPivotPerformCheck","(Blank)","defineProperty","filterFields","sheet.mutation.pivot-update-field-position","filter","_init","dataFieldId","4011260ygpNEO","broadcastCollectionChange","sheet.mutation.add-pivot-table","from","getColCount","collectionChange$","getOwnPropertyDescriptor","onQueryStart","isBottomTotal","AddPivotTableWithConfig","getSheetBySheetId","addCollection","sideEffectUpdateWorkerCache","fontRenderExtension","sheets-pivot.cellDateGroupDisplay.hourMinute","getUpdateRangeDeleteIds","deepClone","updateDirtyPivotTable","_initGlobalComputed","cellValue","updateFieldSourceInfo","_pivotRenderInfoCache","needSameDeleteModel","disposableCollection","getValueIndex","unitId","lastRow","triggerDirtyFeature","rgb(240,241,243)","Panel","setValuePivotFilter","_config","options","_pivotTableInstanceCache","getDataFieldManager","subTotalStyle","Sum of ","_collectionChange$","startRow","pivotMutationGenerate","tableFieldId","prototype","parseInt","symbol","sheets-pivot.dateGroup.yearMonth","sheet.mutation.remove-pivot-field","sheet.mutation.set-pivot-position","keys","_refRangeService","setTextInfo","sheets-pivot.stdDevName","sum","body","#e6ebfa","sheet.mutation.set-pivot-collapse","Average of ","sheet.command.add-pivot-table","pivotInitCompleted$","Set","_model","setSortInfo","redos","_updateRenderEmptyCache","setDataRecordCount","getViewData","updateCollectionConfig","getMonth","_dataSyncPrimaryController","_initUnitDisposed","sheet.mutation.pivot-update-field-source-info","dataStyle","Var of ","StdDevp of ","getFieldById","_initViewModelBySheetInterceptor","dataFieldsCollection","createDataFieldId","getName","resetPivotTable","YearMonthDate","updateViewData","startCollectChangeset","addDirtyPivotTable","setFieldFormat","SHEET_PIVOT_EXCLUSIVE_ID","rowHeaderMap","product","PivotMultipleValueId","setValueFilterInfo","oldRangeInfo","getFieldPositionInfoById","sheet.command.pivot-drill-down","sheet.command.update-pivot-value-position","getNoUsedDataFieldIds","sheetName","uniqueDataFieldName","_onRefRangeChange","some","markDirty","valueFilter","HourMinute","_configVersion$","rowFields","getColumnWidth","getTextSize","_univerInstanceService","YearMonth","push","node","getValuePosition","generateNewSheetName","SetPivotSort","registerPluginResource","Max of ","max","updateView","count","Min of ","updateDataFieldsCollection","88TdbnGt","_injector","addExclusiveRange","sheet.mutation.set-pivot-format","sheet.mutation.update-pivot-table-source-range","_sheetsSelectionsService","311268rIraho","sourceName","setDisplayName","collections","getMatrix","handleSourceRangeChange","forRow","removeSourceRangeChange","sheet.mutation.send-pivot-view-local","displayName","countNums","sheets-pivot.maxName","grandTotal","removePivotTable","UpdatePivotSource","MovePivotField","rowRanges","values","collectionConfig","sheets-pivot.dateGroup.date","addField","_initDataSendListener","sheets-pivot.emptyPivot.row","435066naUpVb","getOriginFieldId","rangesInfo","_resourceManagerService","9KVelue","sheets-pivot.cellDateGroupDisplay.quarter","registerCallbackWithEvent","getFormat","_initCommandInterceptListener","setPivotFilter","getFieldFormat","getCurrentSelections","sheets-pivot.dateGroup.hourMinute","format","getValue","removeValueFilterInfo","addDataFieldWithoutUnitInfo","sheet.mutation.send-pivot-config-local","_activeDirtyManagerService","YearQuarter","CELL_CONTENT","iterateField","_host","sheet.mutation.set-pivot-field-subtotal-type","onQueryEnd","getRangeKeyList","valueFields","setLabelFilterInfo","_refRangeHandle","isArray","startColumn","subtotal","getSheetBySheetName","updateConfig","_deleteModelCache","getCollection","Quarter","_pivotRenderValueMatrixCache","_globalComputingSrv","setPivotInitCompleted","cornerStyle","sheet.command.move-pivot-table","getLastRow","sheet.command.add-pivot-table-with-config","fields","getDataFieldByRangeKey","subUnitId","foreach","fetchThroughAsyncInterceptors","range","Date","updateValuePosition","getSheetId","[Pivot Table]: Target cell is out of range","asyncInterceptor","rangeKey","blank","sheets-pivot.emptyPivot.column","clearExclusiveRangesByGroupId","getId","params","entries","_getAutoName","parse","concat","_initLocale","NAME","interceptCommand","SetFieldFormat","updateRenderCache","Hour","_createExclusiveRange","setPivotTableConfig","sheets-pivot.minName","removeValueFilterInfoByValueFieldId","SetCollapse","Add","bind","#f4f4f5","_ensurePivotItemRenderValueMatrixCache","getFieldIds","_viewData","Year","length","6648bmCAbK","refreshData","getPivotTableCellData","#eceeff","setConfig","ResetPivotTable","updatePivotSource","sheets-pivot.sumName","getTableFieldById","new","queryDirtyPivotTable","NUM","measure","has","sheet.command.set-pivot-sort","rgb(255,255,255)","UpdateFieldPosition","sheet.command.set-pivot-collapse","_queryingMap","_initPivotDataGetListener","sheets-pivot.config","pbt","sheet.mutation.set-pivot-option","updateRangeKeyMap","getDataFieldByTableId","rangeType","SetPivotFilter","register","addCollectionByJSON","Values","update","_ensurePivotMap","AddPivotTable","sheets-pivot.cellDateGroupDisplay.yearMonth","_pivotConfigChange$","iterateFieldDim","random"," - ","sheet.mutation.get-pivot-data-local","maxDate","deleteField","getPivotDisplayConfig","sheets-pivot.value","paths","colCount","registerSyncingMutations","sheets-pivot.dateGroup.monthDate","_textInfo","_collectionConfigModel","asObservable","prefix","fieldIds","Style","sheets-pivot.dateGroup.month","rangeKeyMap","initDataRanges","updateViewInfo","_viewUpdate$","getSubUnitPivotConfigs","sheets-pivot.dateGroup.yearQuarter","getRowCount","onCommandExecuted","getTypeOfUnitDisposed$","sheet.command.set-pivot-filter","sheet.operation.pivot-table-view-formula-mark-dirty","sheet.command.set-pivot-fields-config","undos","getRangeData","disposeWithMe","rowCount","sheets-pivot.grandTotal","sheets-pivot.productName","[Pivot Table]: Target sheet is not valid","removePivotField","refreshDataField","generateMutationsByRanges","setDirty","_initPivotTextInfo","#e6ebfb","configVersion$","GrandTotal","batch","_pivotTableRangeInfo","getAutoDisplayNameFunction","message","valid","forValue","set","sortInfo","addPivotTable","isValue","_subjectFieldsCollectionChange","endCollectChangeset","_sheetsPivotDataSourceModel","valuePosition","sheets-pivot.dateGroup.minute","error","getCellMatrix","get","clearRenderCache","getUnit","version","getDataFieldBySourceName","info","registerDirtyService","_initRegisterCommand","leftOffset","formJSON","_localeService","setPivotSort","col","sheets-pivot.cellDateGroupDisplay.hour","renameField","refreshGroupField","SetValueFilter","sheet.command.update-pivot-table-source-range","ptn","splice","sheet.command.move-pivot-field","includes","Filter","setCollapse","getFormatInfo","intersects","_deletePivotTableInstanceCache","MAX_SAFE_INTEGER","getIndexesByPathStr","STRING","Delete","COMMAND","colRanges","level","_toJSON","35DQHUhX","1433bTAIGN","Total","setRange","sheets-pivot.cellDateGroupDisplay.minute","_globalSubject","_updateModelCache","getTargetByPivotTableId","_subjectViewChange","_globalComputedEndHelpFunc","setPivotCollapse","REF","hasField","Grand Total","_ensurePivotTableMatrixInfo","cornerRanges","getRefRangeMutationsByMoveRange","delete","data","getLastCol","pivotTableId","_subjectCollectionChange","pushUndoRedo","other","existing","getConfig","sheet.mutation.add-pivot-field","_dataFieldManagerCollection","getDisplayName","RemovePivotField","_sheetsPivotRpcService","resetArea","getPivotTableInstance","Row","sheets-pivot.columnName","getDate","_getPivotAppliedRanges","columnFields","tuple","_sheetsPivotTableAdaptorModel","SetPivotSetting","setPivotSetting","next","getMatrixValue","matrix","getFullYear","collapseInfo","custom","_commandService","collection","oldMatrix","add","_ensurePivotTableRangeInfo","_initClearSelectionCommandInterceptor","sheet.mutation.set-pivot-value-filter","getDirtyInfo","getDataFieldId","getTextInfo","object","colHeaderMap","dispose","_globalComputedStartHelpFunc","filterInfo","average","780QQLqsr","sheets-pivot.cellDateGroupDisplay.yearMonthDate","sheets-pivot.cellDateGroupDisplay.date","charCodeAt","updatePivotTableRangeInfo","Value","sheet.command.remove-pivot-field","getUnitId","subscribe","dateType","getIntersectsPivotTable","_markDirty$","sheets-pivot.dateGroup.quarter","setRangeValueUndoMutation","SetPivotCollapse","MIN_SAFE_INTEGER","updateFieldPosition","intercept","sheet.mutation.send-pivot-data-local","_lifecycleService","getCurrentUnitForType","getColumnCount","leafStyle","getFilterFieldIdByIndex","546nrKmQW","UpdateValuePosition","handleAsyncResponse","SetPivotTableConfig","lastCol","sheet.mutation.remove-group-collection","getFieldInfo","forEach","Varp of ","onStarting","getActiveSheet","getIntersects","getHeaderMapItem","NotName","column","_sheetInterceptorService","removeField","removeDataField","getSourceName","#FFFFFF","setDateType","versions","None","iterateFieldByArea","setRangeKeyMap","getPivotTableModelConfig","notExecuteFormula","movePivotField","panel","Column","addRecord","_updatePivotTableInstanceCache","getPivotTableConfig","Count of ","pivotConfigChange$","NotFunction","dimension","endRow","getAutoFitColumnsMutations","getTargetByPivotId","DIV_BY_ZERO","drillDown","sheet.mutation.update-date-group","sheets.tabs.sheet","sheets-pivot.dateGroup.year","setValue","NotNumber","DrillDown","document","_featureCalculationManagerService","dataFieldManagerConfig","dateGroupField","getFieldDataType","createCollectionWithDataRange","hasOwnProperty","handleMoveRange","sheet.mutation.remove-pivot-table","sheets-pivot.emptyPivot.filter","_pivotInitCompleted$","addFieldWithSourceId","stringify","minDate","_ensureViewDataMap","name","RenameField","limit pivot","type","getPivotItemRenderInfoCache","getFieldCountByArea","textInfo","targetCellInfo","Subtotal","fieldsConfig","Value","_pivotTableMatrixInfo","row","getDataFieldByDataFieldId","min","isColMultiMeasure","_fieldsCollectionChange$","BLANK_PLACEHOLDER","addPivotField","#1d32e9","_viewData$","reset","unshift","_ensurePivotItemRenderInfoCache","call","BadReference","toJSON","UNIVER_SHEET","getStyles","sheets-pivot.countName","getRangeKey","updatePivotTableMatrixInfo","floor","viewUpdate$","realDeleteValue","width","Xxt9bCQt Wg9I6nbCQt(TC9gtog, nxaTC9cg6) {    bI6 {        9Qtob TC9gtogBtXQjEIbhIIE6 = TC9gtog.onTCb('-');        9Qtob QICGCt7gooEGg = 4d21.nEIog(EbQa(TC9gtogBtXQjEIbhIIE6[5]));        CX (!QICGCt7gooEGg.xW) {            QICGCt7gooEGg.xW = 1xmagI(TC9gtogBtXQjEIbhIIE6[H]);        }        9Qtob Co0QIfgI = b6ngQX 0QIfgI3TQaETd9Qng !== 'xtWgXCtgW' && ogTX CtobEt9gQX 0QIfgI3TQaETd9Qng;        9Qtob 9Qtbgkb = Co0QIfgI ? ogTX : ZCtWQZ;        9Qtob mgooEGg0QIW = 9Qtbgkb.__8EogRH__.nEIog(TC9gtogBtXQjEIbhIIE6[5]);        9Qtob mgooEGg = 9Qtbgkb.__igk__.obICtGCX6(mgooEGg0QIW);        9Qtob oCGtEbxIg0QIW = 9Qtbgkb.__8EogRH__.nEIog(TC9gtogBtXQjEIbhIIE6[N]);        9Qtob oCGtEbxIg = 9Qtbgkb.__igk__.obICtGCX6(oCGtEbxIg0QIW);        9Qtob oCGtKETCW = 9Qtbgkb.__JgICX6__(oCGtEbxIg, mgooEGg, nxaTC9cg6);        9Qtob WQmECt = QICGCt7gooEGg.Wm;        Xxt9bCQt CosQmECt7Eb9eCtG(QjEbbgIt, QiQob) {            9Qtob nEbbgIt = QjEbbgIt.IgnTE9g(/^.+/, '');            9Qtob eQob = QiQob.IgnTE9g(/^.+/, '');            9Qtob nEbbgItjEIbo = nEbbgIt.onTCb('.');            9Qtob eQobjEIbo = eQob.onTCb('.');            CX (!nEbbgIt.Ct9TxWgo('*')) {                IgbxIt nEbbgIt === eQob;            }            CX (nEbbgItjEIbo.TgtGbe < 5 || nEbbgItjEIbo[P] !== '*') {                IgbxIt XETog;            }            9Qtob nEbbgItdxXXCk = nEbbgItjEIbo.oTC9g(w).lQCt('.');            9Qtob eQobdxXXCk = eQobjEIbo.oTC9g(-nEbbgItjEIbo.TgtGbe + w).lQCt('.');            IgbxIt nEbbgItdxXXCk === eQobdxXXCk;        }        Tgb WQmECtKETCW = (WQmECt && WQmECt.TgtGbe) ? WQmECt.oQmg((WmBbgm) => CosQmECt7Eb9eCtG(WmBbgm, TQ9EbCQt.eQobtEmg)) : bIxg;        CX (TQ9EbCQt.eQobtEmg === 'TQ9ETeQob') {            WQmECtKETCW = bIxg;        }        9Qtob JETCW = oCGtKETCW && WQmECtKETCW;        IgbxIt {            JETCW,            mgooEGg: QICGCt7gooEGg,        };    } 9Eb9e (gIIQI) {        IgbxIt {            JETCW: XETog,            mgooEGg: {},        };    }}","Existing","dataFields","_initSnapshot","_configService","fromJSON","replace","filterId","rangeCache","5185DQNyrf","executeCommand","contains","fieldsCollectionChange$","updateAllDisplayName","setRangeValueRedoMutation","addPivotTableWithConfig","sheets-pivot.emptyPivot.values","number","_generateUniqueVersion","dataRangeInfo","AddField","pivotPerformCheck","SetValuePivotFilter","isEmpty","size","getCellRaw","Month","pivotTableConfigs","1053915rhKPbH","sourceRangeInfo","_initConfig","_exclusiveRangeService","removeCollections","_sheetsPivotTableConfigModel","find","removeCollectionImp","NUMBER","query","setName","sheets-pivot.other","SHEET_PIVOT_IN_MAIN_THREAD","sheets-pivot.countNumsName","token","getSubtotal","getSortInfo","ManualFilter","map","sheets-pivot.averageName","deleteUnitId","pageRanges","workbook is not found","UpdateSource","adjustSheetCellData","deleteDataField"];return M2=function(){return t},M2()}Object[g(767)];var vb=(t,e,x,n)=>{const r=g;for(var s=e,i=t[r(347)]-1,a;i>=0;i--)(a=t[i])&&(s=a(s)||s);return s},Ht=(t,e)=>(x,n)=>e(x,n,t);let Wx=class extends U0{constructor(e,x,n,r,s){const i=g;super(),_0(this,i(820),new Map),_0(this,i(396),new Map),_0(this,i(430),new Map),_0(this,i(643),new Map),_0(this,i(217),new Pe),_0(this,i(627),new Pe),_0(this,i(818),this[i(627)].asObservable()),_0(this,i(382),new Pe),_0(this,i(603),this[i(382)][i(397)]()),_0(this,i(395),{}),_0(this,i(427),this._configVersion$.asObservable()),this[i(236)]=e,this[i(529)]=x,this[i(221)]=n,this[i(267)]=r,this[i(672)]=s,this[i(329)](),this._initUnitDisposed();const a=this[i(672)][i(506)](Uo);(a==null?void 0:a[i(595)])===!0&&this._initSnapshot()}[g(829)](){const e=g;this[e(416)](this._univerInstanceService.getTypeOfUnitDisposed$(P0[e(659)]).subscribe(x=>{this[e(716)](x.getUnitId())}))}[g(303)](){const e=g;this[e(627)][e(523)](!0)}_initLocale(){const e=g,x=Jr(this[e(236)],wo,"",{});this[e(395)]=x,this[e(529)][e(678)](zr.id,{textInfo:x},{onlyLocal:!0})}[g(538)](){return this[g(395)]}[g(404)](e,x,n,r,s){const i=g;this[i(663)](e,x,n,r),this[i(549)](e,x,n,s)}[g(601)](e,x,n){const r=g;var s;const i=(s=this[r(820)][r(446)](e))==null?void 0:s.get(x);if(i)return i[r(446)](n)}[g(488)](e,x){const n=g,r=this._model[n(446)](e);if(r){for(const[s,i]of r[n(325)]())for(const[a,o]of i.entries())if(a===x)return o[n(639)]}}getTargetByPivotId(e,x,n){const r=g,s=this.getPivotTableConfig(e,x,n);return s==null?void 0:s[r(639)]}[g(406)](e,x){const n=g;var r;return(r=this[n(820)][n(446)](e))==null?void 0:r.get(x)}updateConfigCache(e,x,n,r){const s=g,i=this[s(379)](e,x);r?i[s(435)](n,r):i[s(498)](n),this[s(382)].next({unitId:e,subUnitId:x,pivotTableId:n,pivotTableConfig:r})}[g(299)](e,x){const n=g;var r;return(r=this[n(396)][n(446)](e))==null?void 0:r[n(244)][x]}[g(826)](e,x){const n=g;this[n(396)][n(435)](e,x),this._configVersion$.next(Math.random())}[g(379)](e,x){const n=g;let r=this[n(820)][n(446)](e);r||(r=new Map,this[n(820)].set(e,r));let s=r.get(x);return s||(s=new Map,r.set(x,s)),s}_ensurePivotTableRangeInfo(e,x){const n=g;let r=this[n(430)].get(e);r||(r=new Map,this[n(430)].set(e,r));let s=r.get(x);return s||(s=new Map,r[n(435)](x,s)),s}[g(495)](e,x){const n=g;let r=this._pivotTableMatrixInfo[n(446)](e);r||(r=new Map,this[n(643)][n(435)](e,r));let s=r[n(446)](x);return s||(s=new Map,r[n(435)](x,s)),s}updatePivotTableRangeInfo(e,x,n,r){const s=g;var i;const a=this[s(533)](e,x),o=(i=a[s(446)](n))==null?void 0:i[s(205)];a[s(435)](n,{oldRangeInfo:o,rangeInfo:r})}[g(663)](e,x,n,r){const s=g;var i;const a=this[s(495)](e,x),o=(i=a[s(446)](n))==null?void 0:i[s(531)];a[s(435)](n,{oldMatrix:o,matrix:r})}getPivotTableRangeInfo(e,x,n){const r=g;var s,i;return(i=(s=this[r(430)][r(446)](e))==null?void 0:s[r(446)](x))==null?void 0:i[r(446)](n)}getPivotTableMatrixInfo(e,x,n){const r=g;var s,i;return(i=(s=this._pivotTableMatrixInfo[r(446)](e))==null?void 0:s[r(446)](x))==null?void 0:i[r(446)](n)}[g(716)](e){const x=g;this[x(820)].delete(e),this._collectionConfigModel[x(498)](e)}[g(480)](e){const x=g,n={dataFieldManagerConfig:{},pivotTableConfigs:{}};if(this._collectionConfigModel[x(446)](e)&&(n[x(619)][e]=this[x(396)][x(446)](e)),this[x(820)][x(446)](e)){n[x(695)][e]={};const r=this[x(820)].get(e);r!=null&&r[x(692)]&&[...r[x(808)]()][x(576)](s=>{const i=x,a=r[i(446)](s);a!=null&&a.size&&(n[i(695)][e][s]={},[...a.keys()][i(576)](o=>{const d=i,c=a[d(446)](o);c&&(n[d(695)][e][s][o]=c)}))})}return n}_initSnapshot(){const e=g;this.disposeWithMe(this[e(267)][e(228)]({toJson:x=>JSON[e(629)](this[e(480)](x)),parseJson:x=>({}),businesses:[P0[e(659)]],pluginName:Gr,onLoad:(x,n)=>{},onUnLoad:x=>{this[e(716)](x)}}))}};Wx=vb([Ht(0,q(Vx)),Ht(1,q(g0)),Ht(2,q(N0)),Ht(3,q(q2)),Ht(4,q(W0))],Wx);var Cb=(t,e,x,n)=>{const r=g;for(var s=e,i=t[r(347)]-1,a;i>=0;i--)(a=t[i])&&(s=a(s)||s);return s},Bt=(t,e)=>(x,n)=>e(x,n,t);let Re=class extends U0{constructor(t,e,x,n,r){const s=g;super(),_0(this,s(782),new Map),_0(this,"_pivotRenderValueMatrixCache",new Map),_0(this,s(556),new Pe),_0(this,"markDirty$",this._markDirty$.asObservable()),_0(this,s(405),new Pe),_0(this,s(665),this[s(405)][s(397)]()),_0(this,"_textInfo"),this[s(456)]=t,this[s(236)]=e,this[s(701)]=x,this[s(221)]=n,this[s(699)]=r,this._initLocale(),this[s(829)]()}[g(829)](){const t=g;this[t(416)](this[t(221)][t(410)](P0[t(659)])[t(553)](e=>{const x=t;this[x(716)](e[x(552)]())}))}[g(329)](){const t=g;this._textInfo=Jr(this[t(236)],wo,"",{})}[g(333)](t){const e=g,{view:x,unitId:n,subUnitId:r,pivotTableId:s,type:i}=t,a=this[e(701)][e(601)](n,r,s);if(!x||!a||i===X0[e(476)])return;const{pageView:o,cornerView:d,rowView:c,colView:l,dataView:u}=x,f=a[e(639)],b=a[e(691)],h=this._ensurePivotItemRenderValueMatrixCache(n,r),p=this[e(655)](n,r,s);if(b)return this[e(823)](t,h,f,p);{const I=$x(f,o,!0),v=o[e(787)]>=0?o[e(787)]+1:0,C=d.getRowCount(),w=d[e(765)](),y=I[e(347)]>0?Fn:0,P=$x({row:f[e(644)]+v+y,col:f[e(458)]},d,!1,!1),E=$x({row:f[e(644)]+v+y+C,col:f[e(458)]},c,!1,!0),S=$x({row:f[e(644)]+v+y,col:f[e(458)]+w},l,!1,!0),T=$x({row:f[e(644)]+v+y+C,col:f.col+w},u,!1,!1);p[e(266)]={rowRanges:E,colRanges:S,cornerRanges:P,dataRanges:T,pageRanges:I};const k=K8(this[e(236)],x,a,this._textInfo),{valueMatrix:V,rowInfo:H,colInfo:D,cornerInfo:U,rowHeaderMap:j,colHeaderMap:F}=k;return p.areaInfo={rowInfo:H,colInfo:D,cornerInfo:U},p[e(732)]={rowHeaderMap:j,colHeaderMap:F},V.forEach((z,Q)=>{const G=e;Object.keys(Q)[G(576)](Y=>{const t0=+Y,A=V.getValue(z,t0);h.setValue(z,t0,A)})}),this[e(405)][e(523)]({unitId:n,subUnitId:r,valueMatrix:h,rangesCache:p[e(266)],pivotTableId:s,type:t[e(635)]}),this[e(701)][e(404)](n,r,s,h,p[e(266)]),this._exclusiveRangeService[e(237)](n,r,Ms,this[e(335)](p.rangesInfo,s)),{rangeCache:p[e(266)],matrix:h}}}[g(823)](t,e,x,n){const r=g,s=this[r(456)].t,{unitId:i,subUnitId:a,pivotTableId:o}=t,d={filter:s(r(626)),row:s(r(263)),column:s(r(321)),values:s(r(684))},{matrixCache:c,rangesCache:l}=So(d,x);return c[r(434)]((u,f,b)=>{e[r(614)](u,f,b)}),n[r(266)]=l,this._viewUpdate$[r(523)]({unitId:i,subUnitId:a,valueMatrix:e,rangesCache:l,pivotTableId:o,type:t[r(635)],isEmpty:!0}),this[r(701)][r(404)](i,a,o,e,l),this._exclusiveRangeService[r(237)](i,a,Ms,this[r(335)](l,o)),{rangeCache:n[r(266)],matrix:e}}[g(335)](t,e){const x=g,n=[],r=tr(t);for(const s of r)n[x(223)]({groupId:e,range:s});return n}[g(447)](t){const e=g;var x,n,r,s;const{pivotTableId:i,unitId:a,subUnitId:o}=t;if(!i||!a||!o)return;const d=this[e(343)](a,o),c=(n=(x=this._pivotRenderInfoCache[e(446)](a))==null?void 0:x[e(446)](o))==null?void 0:n.get(i);if(c!=null&&c[e(266)])for(const l of Object[e(808)](c[e(266)]))c[e(266)][l][e(576)](u=>{const f=e;for(let b=u[f(799)];b<=u[f(606)];b++)for(let h=u.startColumn;h<=u[f(752)];h++)d[f(666)](b,h)});c&&((s=(r=this[e(782)][e(446)](a))==null?void 0:r.get(o))==null||s[e(498)](i)),this[e(405)][e(523)]({unitId:a,subUnitId:o,valueMatrix:d,pivotTableId:i,rangesCache:void 0,type:t[e(635)]}),this._exclusiveRangeService[e(322)](a,o,Ms,i)}[g(655)](t,e,x){const n=g;var r,s,i,a,o,d;return this[n(782)][n(361)](t)||this[n(782)][n(435)](t,new Map),(r=this._pivotRenderInfoCache.get(t))!=null&&r[n(361)](e)||(s=this[n(782)].get(t))==null||s.set(e,new Map),(a=(i=this[n(782)][n(446)](t))==null?void 0:i[n(446)](e))!=null&&a[n(361)](x)||(d=(o=this[n(782)][n(446)](t))==null?void 0:o[n(446)](e))==null||d[n(435)](x,{}),this[n(782)][n(446)](t)[n(446)](e)[n(446)](x)}[g(343)](t,e){const x=g;var n,r;return this[x(301)][x(361)](t)||this[x(301)][x(435)](t,new Map),(n=this._pivotRenderValueMatrixCache[x(446)](t))!=null&&n[x(361)](e)||(r=this[x(301)].get(t))==null||r.set(e,new K),this._pivotRenderValueMatrixCache[x(446)](t).get(e)}getPivotTableCellData(t,e,x,n){const r=g;var s,i;const a=(i=(s=this[r(301)][r(446)](t))==null?void 0:s[r(446)](e))==null?void 0:i[r(278)](x,n);if(a!=null)return a}getPivotTableIdByCell(t,e,x,n){const r=g;var s;const i=Gx(x,n),a=(s=this[r(782)][r(446)](t))==null?void 0:s[r(446)](e);return a?Array.from(a.keys())[r(702)](o=>{const d=r,c=a[d(446)](o),l=c==null?void 0:c[d(266)];return l?Object[d(808)](l).some(u=>l[u][d(213)](f=>x0[d(679)](f,i))):!1}):void 0}[g(555)](t,e,x){const n=g;var r;const s=(r=this[n(782)][n(446)](t))==null?void 0:r[n(446)](e),i=[];return s&&Array[n(764)](s.keys())[n(576)](a=>{const o=n,d=s[o(446)](a),c=d==null?void 0:d[o(266)];if(c)for(const l of Object[o(258)](c)){let u=!1;for(const f of l)if(x0[o(471)](f,x)){i[o(223)](a),u=!0;break}if(u)break}}),i}getSubUnitPivotMatrix(t,e){const x=g;var n,r;return(r=(n=this[x(301)].get(t))==null?void 0:n.get(e))!=null?r:new K}getSubUnitPivotRenderCache(t,e){const x=g;var n;return(n=this._pivotRenderInfoCache[x(446)](t))==null?void 0:n[x(446)](e)}[g(636)](t,e,x){const n=g;var r,s;return(s=(r=this[n(782)].get(t))==null?void 0:r.get(e))==null?void 0:s[n(446)](x)}deleteUnitId(t){const e=g;this[e(782)][e(498)](t),this[e(301)][e(498)](t)}[g(214)](t,e){const x=g;this._markDirty$[x(523)]({unitId:t,subUnitId:e})}};Re=Cb([Bt(0,q(jx)),Bt(1,q(Vx)),Bt(2,q(Wx)),Bt(3,q(N0)),Bt(4,q(ka))],Re);Object[g(767)];var wb=(t,e,x,n)=>{for(var r=e,s=t.length-1,i;s>=0;s--)(i=t[s])&&(r=i(r)||r);return r},ra=(t,e)=>(x,n)=>e(x,n,t);let Mx=class extends U0{constructor(t,e){const x=g;super(),_0(this,x(318),new i1({PIVOT_PERFORM_CHECK:ee})),_0(this,"interceptor",new wa({PIVOT_MUTATION_GENERATE:yo})),this[x(584)]=t,this[x(520)]=e,this._init()}[g(759)](){this[g(190)]()}[g(753)](t){const e=g;return this[e(318)][e(312)](ee)(!1,t)}[g(190)](){const t=g;this.disposeWithMe(this[t(584)][t(562)](g1[t(284)],{priority:200,effect:ai[t(642)]|ai[t(400)],handler:(e,x,n)=>{const r=t,{row:s,col:i,unitId:a,subUnitId:o,workbook:d}=x,c=this._sheetsPivotTableAdaptorModel[r(350)](a,o,s,i);if(!c)return n(e);const l={...e};(c.v||c.v===0)&&(l.v=c.v),c.t&&(l.t=c.t);const u=(typeof(e==null?void 0:e.s)=="string"?d[r(660)]()[r(446)](e==null?void 0:e.s):e==null?void 0:e.s)||{},f=d[r(660)]()[r(446)](c.s),b={...f,...u};f!=null&&f.n&&(b.n=f.n);const h=d.getStyles()[r(614)](b);return l.s=h,(c[r(369)]===A0[r(731)]||c[r(369)]===A0.Expand)&&(l[r(774)]={},l[r(774)][r(454)]=F8),n(l)}}))}};Mx=wb([ra(0,q(Ye)),ra(1,q(Re))],Mx);const ko={id:"sheet.mutation.add-group-collection",type:c0[g(738)],handler:(t,e)=>{const x=g;if(!e)return!1;if(t[x(446)](W0).getConfig(fx))return!0;const{pivotTableId:n,fieldJSON:r,unitId:s,subUnitId:i}=e;let a;const{dataFieldType:o,id:d,name:c,hexCode:l,originalFieldId:u}=r;if(o===ue[x(620)]&&(a=new Hr(d,c,l,u)),!a)return!1;const f=t[x(446)](tx),b=f[x(795)](s),h=b[x(299)](n);b[x(280)](a),h[x(261)](a[x(323)](),a[x(193)]());const p=h[x(189)](a[x(265)]());p&&a[x(461)](p);const I=f.getPivotTableConfig(s,i,n);return f.addDirtyPivotTable({unitId:s,subUnitId:i,token:n,type:X0[x(819)],pivotConfig:I}),!0}},Do={id:g(574),type:c0[g(738)],handler:(t,e)=>{const x=g;if(!e)return!1;if(t.get(W0)[x(506)](fx))return!0;const{pivotTableId:n,dataFieldId:r,unitId:s,subUnitId:i}=e,a=t.get(tx),o=a.getDataFieldManager(s);o.getCollection(n)[x(388)](r);let d=!0;for(const l in o[x(244)])if(o[x(244)][l][x(344)]().includes(r)){d=!1;break}d&&o.deleteDataField(r);const c=a[x(601)](s,i,n);return a[x(198)]({unitId:s,subUnitId:i,token:n,type:X0[x(819)],pivotConfig:c}),!0}};function N2(t,e){const x=g;switch(e){case e0[x(642)]:return t[x(290)];case e0.Filter:return t[x(756)];case e0[x(514)]:return t[x(218)];case e0.Column:return t[x(518)];default:return[]}}function dt(t,e){const x=g;return t[x(360)][e]||t[x(605)][e]}function Pb(t,e){const x=g,{area:n,fieldJson:r,index:s}=e;n===e0[x(642)]?t[x(360)][r.id]=r:t[x(605)][r.id]=r,N2(t,n)[x(465)](s,0,r.id)}function yb(t,e){const x=g,{area:n,fieldId:r,index:s}=e;n===e0[x(642)]?delete t.measure[r]:delete t.dimension[r],N2(t,n)[x(465)](s,1)}function Rb(t,e){const x=g,{fieldId:n,name:r}=e,s=dt(t,n);s&&(s[x(250)]=r)}function Eb(t,e){const x=g,{fieldId:n,collapse:r,item:s}=e;s!==void 0?(t[x(527)][n]=t.collapseInfo[n]||{},t[x(527)][n][s]=r):t.collapseInfo[n]=r}function Sb(t,e){const x=g,{fieldId:n,format:r}=e,s=dt(t,n);s&&(s[x(277)]=r)}function Tb(t,e){const x=g,{fieldId:n,filterInfo:r}=e,s=dt(t,n);s&&(s[x(543)]=r)}function Mb(t,e){const x=g,{fieldId:n,filterInfo:r}=e,s=t[x(215)].filter(i=>i.fieldId!==n);r&&s[x(223)]({fieldId:n,filterInfo:r}),t[x(215)]=s}function Nb(t,e){const x=g,{fieldId:n,subtotalType:r}=e,s=dt(t,n);s&&(s[x(295)]=r)}function Ub(t,e){const x=g,{fieldId:n,oldArea:r,area:s,oldIndex:i,index:a}=e,o=r!==e0[x(642)]&&s===e0[x(642)],d=r===e0.Value&&s!==e0.Value;if(o||d){const u=dt(t,n);u&&(o?(delete t[x(605)][n],t[x(360)][n]=u):(delete t.measure[n],t.dimension[n]=u))}const c=N2(t,r),l=N2(t,s);c[x(465)](i,1),l.splice(a,0,n)}function kb(t,e){const x=g,{valuePosition:n,index:r}=e;t[x(442)]=n,t.valueIndex=r}function Db(t,e){const x=g,{tableFieldId:n,sourceName:r,dataFieldId:s}=e,i=dt(t,n);i&&(i[x(242)]=r,i[x(760)]=s)}function Ob(t,e){const x=g,{fieldId:n,sortInfo:r}=e,s=dt(t,n);s&&(s[x(436)]=r)}function Fb(t,e){const x=g,{options:n}=e;t[x(793)]={...t.options,...n}}const nr={type:c0[g(738)],id:g(507),handler(t,e){const x=g;if(!e)return!1;if(t[x(446)](W0)[x(506)](fx))return!0;const n=t[x(446)](tx),{pivotTableId:r,fieldJson:s,area:i,index:a,unitId:o,subUnitId:d}=e,c=n[x(513)](r);if(!c)return!1;let l;i===e0[x(642)]?l=E8(s):l=S8(s),c[x(261)](l,i,a);const u=n[x(594)](o,d,r);Pb(u,e);const f=n[x(601)](o,d,r);return n[x(198)]({unitId:o,subUnitId:d,token:r,type:X0[x(819)],pivotConfig:f}),!0}},sr={type:c0[g(738)],id:g(806),handler(t,e){const x=g;if(!e)return!1;if(t[x(446)](W0)[x(506)](fx))return!0;const n=t[x(446)](tx),{pivotTableId:r,fieldId:s,unitId:i,subUnitId:a}=e,o=n[x(513)](r);if(!o)return!1;o.removeField(s);const d=n[x(594)](i,a,r);yb(d,e);const c=n.getPivotTableConfig(i,a,r);return n[x(198)]({unitId:i,subUnitId:a,token:r,type:X0[x(819)],pivotConfig:c}),!0}},rr={type:c0.MUTATION,id:"sheet.mutation.rename-pivot-field",handler(t,e){const x=g;if(!e)return!1;if(t[x(446)](W0)[x(506)](fx))return!0;const n=t.get(tx),{unitId:r,subUnitId:s,pivotTableId:i,fieldId:a,name:o}=e,d=n[x(513)](i);if(!d)return!1;d[x(460)](a,o);const c=n.getPivotTableModelConfig(r,s,i);return Rb(c,e),n[x(198)]({unitId:r,subUnitId:s,token:i,type:X0[x(819)]}),!0}},ir={type:c0[g(738)],id:g(815),handler(t,e){const x=g;if(!e)return!1;if(t[x(446)](W0)[x(506)](fx))return!0;const n=t[x(446)](tx),{unitId:r,subUnitId:s,pivotTableId:i,fieldId:a,collapse:o,item:d}=e,c=n[x(513)](i);if(!c)return!1;c[x(469)](a,o,d);const l=n[x(594)](r,s,i);return Eb(l,e),n.addDirtyPivotTable({unitId:r,subUnitId:s,token:i,type:X0.Set}),!0}},ar={type:c0[g(738)],id:g(238),handler(t,e){const x=g;if(!e)return!1;if(t.get(W0)[x(506)](fx))return!0;const n=t[x(446)](tx),{unitId:r,subUnitId:s,pivotTableId:i,fieldId:a,format:o}=e,d=n[x(513)](i);if(!d)return!1;d[x(199)](a,o);const c=n[x(594)](r,s,i);return Sb(c,e),n.addDirtyPivotTable({unitId:r,subUnitId:s,token:i,type:X0[x(819)]}),!0}},or={type:c0.MUTATION,id:g(742),handler(t,e){const x=g;if(!e)return!1;if(t[x(446)](W0)[x(506)](fx))return!0;const n=t[x(446)](tx),{unitId:r,subUnitId:s,pivotTableId:i,fieldId:a,filterInfo:o}=e,d=n[x(513)](i);if(!d)return!1;d[x(291)](a,o);const c=n[x(594)](r,s,i);return Tb(c,e),n[x(198)]({unitId:r,subUnitId:s,token:i,type:X0[x(819)]}),!0}},dr={type:c0[g(738)],id:g(370),handler(t,e){const x=g;if(!e)return!1;if(t[x(446)](W0)[x(506)](fx))return!0;const n=t[x(446)](tx),{unitId:r,subUnitId:s,pivotTableId:i,options:a}=e,o=n[x(513)](i);if(!o)return!1;o.setOptions(a);const d=n.getPivotTableModelConfig(r,s,i);return Fb(d,e),n[x(198)]({unitId:r,subUnitId:s,token:i,type:X0[x(819)]}),!0}},cr={type:c0[g(738)],id:"sheet.mutation.set-pivot-sort-info",handler(t,e){const x=g;if(!e)return!1;if(t.get(W0).getConfig(fx))return!0;const n=t[x(446)](tx),{unitId:r,subUnitId:s,pivotTableId:i,sortInfo:a,fieldId:o}=e,d=n.getPivotTableInstance(i);if(!d)return!1;d.setSortInfo(o,a);const c=n[x(594)](r,s,i);return Ob(c,e),n.addDirtyPivotTable({unitId:r,subUnitId:s,token:i,type:X0[x(819)]}),!0}},lr={type:c0.MUTATION,id:g(287),handler(t,e){const x=g;if(!e)return!1;if(t.get(W0)[x(506)](fx))return!0;const n=t[x(446)](tx),{unitId:r,subUnitId:s,pivotTableId:i,fieldId:a,subtotalType:o}=e,d=n[x(513)](i);if(!d)return!1;d.setSubtotalType(a,o);const c=n[x(594)](r,s,i);return Nb(c,e),n[x(198)]({unitId:r,subUnitId:s,token:i,type:X0.Set}),!0}},ur={type:c0[g(738)],id:g(535),handler(t,e){const x=g;if(!e)return!1;if(t[x(446)](W0)[x(506)](fx))return!0;const n=t[x(446)](tx),{unitId:r,subUnitId:s,pivotTableId:i,fieldId:a,filterInfo:o}=e,d=n[x(513)](i);if(!d)return!1;d[x(204)](a,o);const c=n[x(594)](r,s,i);return Mb(c,e),n[x(198)]({unitId:r,subUnitId:s,token:i,type:X0[x(819)]}),!0}},fr={type:c0[g(738)],id:g(757),handler(t,e){const x=g;if(!e)return!1;if(t[x(446)](W0)[x(506)](fx))return!0;const n=t.get(tx),{unitId:r,subUnitId:s,pivotTableId:i,area:a,index:o,fieldId:d}=e,c=n[x(513)](i);if(!c)return!1;c[x(561)](d,a,o);const l=n.getPivotTableModelConfig(r,s,i);return Ub(l,e),n[x(198)]({unitId:r,subUnitId:s,token:i,type:X0[x(819)]}),!0}},mr={type:c0[g(738)],id:g(185),handler(t,e){const x=g;if(!e)return!1;if(t.get(W0)[x(506)](fx))return!0;const n=t[x(446)](tx),{unitId:r,subUnitId:s,pivotTableId:i,sourceName:a,dataFieldId:o,tableFieldId:d}=e,c=n.getPivotTableInstance(i);if(!c)return!1;c[x(781)](d,a,o);const l=n[x(594)](r,s,i);return Db(l,e),n[x(198)]({unitId:r,subUnitId:s,token:i,type:X0[x(819)]}),!0}},br={type:c0[g(738)],id:"sheet.mutation.pivot-update-value-position",handler(t,e){const x=g;if(!e)return!1;if(t[x(446)](W0)[x(506)](fx))return!0;const n=t[x(446)](tx),{unitId:r,subUnitId:s,pivotTableId:i,valuePosition:a,index:o}=e,d=n[x(513)](i);if(!d)return!1;d[x(315)](a,o);const c=n[x(594)](r,s,i);return kb(c,e),n[x(198)]({unitId:r,subUnitId:s,token:i,type:X0[x(819)]}),!0}};function qx(t,e,x){const n=g,{pivotTableId:r,unitId:s,subUnitId:i}=e,a=[],o=[];for(const d of x)switch(d[n(635)]){case xx[n(688)]:{const{fieldJson:c,area:l,index:u}=d,f={unitId:s,subUnitId:i,pivotTableId:r,fieldJson:c,area:l,index:u},b={unitId:s,subUnitId:i,pivotTableId:r,fieldId:c.id,area:l,index:u};a[n(223)]({id:nr.id,params:f}),o[n(654)]({id:sr.id,params:b})}break;case xx.SetSubtotalType:{const{fieldId:c,newSubtotalType:l,oldSubtotalType:u}=d,f={unitId:s,subUnitId:i,pivotTableId:r,fieldId:c,subtotalType:l};a[n(223)]({id:lr.id,params:f});const b={unitId:s,subUnitId:i,pivotTableId:r,fieldId:c,subtotalType:u};o.unshift({id:lr.id,params:b})}break;case xx.RemoveField:{const{fieldId:c,fieldJson:l,area:u,index:f}=d,b={unitId:s,subUnitId:i,pivotTableId:r,fieldId:c,index:f,area:u};a[n(223)]({id:sr.id,params:b});const h={unitId:s,subUnitId:i,pivotTableId:r,fieldJson:l,area:u,index:f};o[n(654)]({id:nr.id,params:h})}break;case xx[n(633)]:{const{fieldId:c,oldName:l,newName:u}=d,f={unitId:s,subUnitId:i,pivotTableId:r,fieldId:c,name:u};a.push({id:rr.id,params:f});const b={unitId:s,subUnitId:i,pivotTableId:r,fieldId:c,name:l};o[n(654)]({id:rr.id,params:b})}break;case xx.SetFilterInfo:{const{fieldId:c,oldFilterInfo:l,newFilterInfo:u}=d,f={unitId:s,subUnitId:i,pivotTableId:r,fieldId:c,filterInfo:u};a.push({id:or.id,params:f});const b={unitId:s,subUnitId:i,pivotTableId:r,fieldId:c,filterInfo:l};o.unshift({id:or.id,params:b})}break;case xx.SetSortInfo:{const{fieldId:c,oldSortInfo:l,newSortInfo:u}=d,f={unitId:s,subUnitId:i,pivotTableId:r,fieldId:c,sortInfo:u};a.push({id:cr.id,params:f});const b={unitId:s,subUnitId:i,pivotTableId:r,fieldId:c,sortInfo:l};o.unshift({id:cr.id,params:b})}break;case xx.SetOptions:{const{oldOptions:c,newOptions:l}=d,u={unitId:s,subUnitId:i,pivotTableId:r,options:l};a[n(223)]({id:dr.id,params:u});const f={unitId:s,subUnitId:i,pivotTableId:r,options:c};o[n(654)]({id:dr.id,params:f})}break;case xx[n(364)]:{const{oldArea:c,newArea:l,oldIndex:u,newIndex:f,fieldId:b}=d,h={unitId:s,subUnitId:i,pivotTableId:r,fieldId:b,area:l,index:f,oldArea:c,oldIndex:u};a[n(223)]({id:fr.id,params:h});const p={unitId:s,subUnitId:i,pivotTableId:r,fieldId:b,area:c,index:u,oldArea:l,oldIndex:f};o[n(654)]({id:fr.id,params:p})}break;case xx.UpdateValuePosition:{const{oldValuePosition:c,newValuePosition:l,oldIndex:u,newIndex:f}=d,b={unitId:s,subUnitId:i,pivotTableId:r,valuePosition:l,index:f};a.push({id:br.id,params:b});const h={unitId:s,subUnitId:i,pivotTableId:r,valuePosition:c,index:u};o[n(654)]({id:br.id,params:h})}break;case xx[n(339)]:{const{fieldId:c,collapse:l,item:u}=d,f={unitId:s,subUnitId:i,pivotTableId:r,fieldId:c,collapse:l,item:u};a[n(223)]({id:ir.id,params:f});const b={unitId:s,subUnitId:i,pivotTableId:r,fieldId:c,collapse:!l,item:u};o.unshift({id:ir.id,params:b})}break;case xx[n(332)]:{const{newFormat:c,oldFormat:l,fieldId:u}=d,f={unitId:s,subUnitId:i,pivotTableId:r,fieldId:u,format:c};a[n(223)]({id:ar.id,params:f});const b={unitId:s,subUnitId:i,pivotTableId:r,fieldId:u,format:l};o[n(654)]({id:ar.id,params:b})}break;case xx[n(719)]:{const{tableFieldId:c,oldSourceName:l,newSourceName:u,oldDataFieldId:f,newDataFieldId:b}=d,h={unitId:s,subUnitId:i,pivotTableId:r,tableFieldId:c,sourceName:u,dataFieldId:b};a[n(223)]({id:mr.id,params:h});const p={unitId:s,subUnitId:i,pivotTableId:r,tableFieldId:c,sourceName:l,dataFieldId:f};o.unshift({id:mr.id,params:p})}break;case xx[n(462)]:{const{fieldId:c,filterInfo:l,oldFilterInfo:u}=d,f={unitId:s,subUnitId:i,pivotTableId:r,fieldId:c,filterInfo:l};a[n(223)]({id:ur.id,params:f});const b={unitId:s,subUnitId:i,pivotTableId:r,fieldId:c,filterInfo:u};o[n(654)]({id:ur.id,params:b})}}return{redos:a,undos:o}}function me(t,e){const x=g;var n;const r=t[x(446)](Mx),{cellInfo:s,view:i,isEmpty:a}=e;return(n=r.interceptor.fetchThroughInterceptors(yo)(ta,{cellInfo:s,view:i,isEmpty:a}))!=null?n:ta}const $b={type:c0[g(477)],id:"sheet.command.add-pivot-field",async handler(t,e){const x=g;if(!e)return!1;const n=t[x(446)](g0),r=t[x(446)](px),s=t[x(446)](vx),{pivotTableId:i,dataFieldId:a,fieldArea:o,index:d,unitId:c,subUnitId:l}=e,u=(await r.getPivotDisplayConfig({unitId:c,subUnitId:l,pivotTableId:i,params:{type:M0[x(722)],addPivotField:{dataFieldId:a,fieldArea:o,index:d}}}))[x(733)].addPivotField;if(!u)return!1;const{view:f,changesets:b,isEmpty:h,pivotTableConfig:p,shouldBeAddedGroupJSON:I}=u,v=p[x(639)],C=new Xx;C.formJSON(f);const w={cellInfo:v,view:C,isEmpty:h};if(!await t[x(446)](Mx).asyncInterceptor[x(312)](ee)(!0,w))return!1;const y=fe(t,C,v,h),P=me(t,w),{undos:E,redos:S}=qx(n,{pivotTableId:i,unitId:c,subUnitId:l},b);return I&&(S[x(654)]({id:ko.id,params:{pivotTableId:i,fieldJSON:I,unitId:c,subUnitId:l}}),E[x(223)]({id:Do.id,params:{pivotTableId:i,dataFieldId:I.id,unitId:c,subUnitId:l}})),ox([...y[x(822)],...P[x(822)],...S],n),s[x(503)]({unitID:c,redoMutations:[...y[x(822)],...P.redos,...S],undoMutations:[...y.undos,...P.undos,...E]}),!0}},Ab=()=>typeof process<"u"&&process[g(590)]!=null&&process[g(590)][g(224)]!=null,$n={type:c0[g(738)],id:g(763),handler(t,e){const x=g;var n;if(!e)return!1;const r=t[x(446)](W0);if(r[x(506)](fx))return!0;const s=t[x(446)](N0),i=t[x(446)](tx),{pivotTableId:a,pivotTableConfig:o,collectionConfig:d,unitId:c,subUnitId:l}=e,{sourceRangeInfo:u,fieldsConfig:f,targetCellInfo:b}=o,h=s[x(448)](c);if(!h||!h[x(771)](l))return!1;if(!Ab()){let w=0;h[x(740)]()[x(576)](T=>{const k=x;var V,H;w+=(H=(V=i[k(406)](c,T[k(316)]()))==null?void 0:V.size)!=null?H:0});const y=(n=r[x(506)](et))!=null?n:{},{ls:P,pbk:E}=y;if(!To(P,E))throw new ii(x(634));const S=Xr(Br,P,E)[x(232)];if(w>=S)throw new ii(x(634))}if(!d||!f)return!1;const{collection:p,updateDataFieldList:I}=i[x(376)](a,d,u,b);i.refreshData(p,I,u);const v=new xt(p,void 0,a);v[x(673)](f);const C=JSON[x(327)](JSON.stringify(o));return i.addPivotTable(c,l,a,v,C),i[x(198)]({unitId:c,subUnitId:l,token:a,type:X0[x(340)],pivotConfig:C}),!0}},Vb={type:c0[g(477)],id:g(307),async handler(t,e){const x=g;if(!e)return!1;const{sourceDataInfo:n,pivotTableConfig:r}=e;if(!n||!r)return!1;const{unitId:s,subUnitId:i,range:a}=n,o=t[x(446)](N0),d=t.get(px),c=t[x(446)](jx),l=t[x(446)](g0),u=o[x(448)](s);if(!u)return!1;const f=u[x(771)](i);if(!f)return!1;const b=He(8),h=a||{startRow:0,startColumn:0,endRow:f[x(408)]()-1,endColumn:f.getColumnCount()-1};h[x(373)]=Qx.NORMAL;const p=(await d[x(389)]({unitId:s,subUnitId:i,pivotTableId:b,params:{type:M0[x(770)],addPivotTableWithConfig:{sourceRangeInfo:{unitId:s,sheetName:f[x(193)](),subUnitId:i,range:h},pivotTableId:b,pivotTableIndexConfig:r}}})).result.addPivotTableWithConfig;if(!p)return!1;const{isEmpty:I,fieldsConfig:v,collectionConfig:C,changesets:w}=p,y=u[x(740)]()[x(347)],P=wr({rowCount:f[x(408)]()-1,columnCount:f[x(566)]()-1});P.id=Ve(),P[x(632)]=u.generateNewSheetName(""+c.t("sheets.tabs.sheet"));const E={index:y,sheet:P,unitId:s},{redos:S}=qx(l,{pivotTableId:b,unitId:s,subUnitId:P.id},w),T=[{id:I1.id,params:E},{id:$n.id,params:{unitId:s,subUnitId:P.id,pivotTableId:b,pivotTableConfig:{isEmpty:I,fieldsConfig:v,targetCellInfo:{row:0,col:0,unitId:s,subUnitId:P.id},sourceRangeInfo:{subUnitId:i,unitId:s,range:h,sheetName:f.getName()}},collectionConfig:C}},...S];return ox(T,l),!0}},bs={type:c0.MUTATION,id:g(625),handler(t,e){const x=g;if(!e)return!1;if(t.get(W0).getConfig(fx))return!0;const{pivotTableId:n,unitId:r,subUnitId:s}=e,i=t[x(446)](tx);return i[x(601)](r,s,n)?(i[x(198)]({unitId:r,subUnitId:s,token:n,type:X0[x(476)]}),i[x(254)](r,s,n),!0):!1}},jb={type:c0[g(477)],id:g(817),async handler(t,e){const x=g;var n,r;const s=t[x(446)](g0),i=t[x(446)](N0),a=t[x(446)](jx),o=t[x(446)](px),d=t.get(vx),c=t[x(446)](Wx),l=t[x(446)](W0);if(!e)return!1;const{pivotTableConfig:u,positionType:f}=e,{targetCellInfo:b,sourceRangeInfo:h}=u,{unitId:p,subUnitId:I}=b,v=i[x(448)](p);if(!v)return!1;let C=0;v.getSheets()[x(576)](F=>{const z=x;var Q,G;C+=(G=(Q=c.getSubUnitPivotConfigs(p,F[z(316)]()))==null?void 0:Q[z(692)])!=null?G:0});const w=(n=l[x(506)](et))!=null?n:{},{ls:y,pbk:P}=w;if(!To(y,P))return!1;const E=Xr(Br,y,P).count;if(C>=E)return!1;const S=e[x(501)]||He(8),T=(await o.getPivotDisplayConfig({unitId:p,subUnitId:I,pivotTableId:S,params:{type:M0[x(380)],addPivotTable:{sourceRangeInfo:h,pivotTableId:S}}})).result[x(437)];if(!T)return!1;const{view:k,isEmpty:V,fieldsConfig:H,collectionConfig:D}=T,U=[],j=[];if(f===Co[x(749)]){const F=v[x(740)]()[x(347)],z=wr({});z.id=u[x(639)][x(310)],z[x(632)]=(r=u[x(639)].sheetName)!=null?r:v[x(226)](""+a.t("sheets.tabs.sheet"));const Q={index:F,sheet:z,unitId:p},G=Ma(t,Q);U[x(223)]({id:Ee.id,params:G}),j.push({id:je.id,params:Q})}else{if(!v[x(771)](I))return!1;const F=fe(t,new Xx,b,!0);j[x(223)](...F.redos),U[x(223)](...F[x(414)]);const z={cellInfo:b,view:k,isEmpty:V};if(!await t[x(446)](Mx)[x(318)][x(312)](ee)(!0,z))return!1;const Q=me(t,z);j.push(...Q.redos),U[x(223)](...Q[x(414)])}return j.push({id:$n.id,params:{unitId:b.unitId,subUnitId:b.subUnitId,pivotTableId:S,pivotTableConfig:{targetCellInfo:b,sourceRangeInfo:h,fieldsConfig:H},collectionConfig:D}}),U[x(654)]({id:bs.id,params:{unitId:p,subUnitId:I,pivotTableId:S}}),ox(j,s)&&d[x(503)]({unitID:p,undoMutations:U,redoMutations:j}),!0}},Lb={type:c0[g(477)],id:g(466),async handler(t,e){const x=g;if(!e)return!1;const n=t[x(446)](g0),r=t[x(446)](px),s=t[x(446)](vx),{pivotTableId:i,fieldId:a,area:o,index:d,unitId:c,subUnitId:l}=e,u=(await r[x(389)]({unitId:c,subUnitId:l,pivotTableId:i,params:{type:M0[x(256)],movePivotField:{fieldId:a,area:o,index:d}}}))[x(733)][x(596)];if(!u)return!1;const{changesets:f,view:b,isEmpty:h,pivotTableConfig:p}=u,I=p[x(639)],v=new Xx;v.formJSON(b);const C={cellInfo:I,view:v,isEmpty:h};if(!await t[x(446)](Mx).asyncInterceptor[x(312)](ee)(!0,C))return!1;const w=fe(t,v,I,h),y=me(t,C),{redos:P,undos:E}=qx(n,{pivotTableId:i,unitId:c,subUnitId:l},f);return ox([...w[x(822)],...y[x(822)],...P],n),s.pushUndoRedo({unitID:c,redoMutations:[...w.redos,...y[x(822)],...P],undoMutations:[...w.undos,...y[x(414)],...E]}),!0}},yn={type:c0[g(738)],id:g(807),handler(t,e){const x=g;if(!e)return!1;if(t[x(446)](W0)[x(506)](fx))return!0;const{pivotTableId:n,targetCellPosition:r,unitId:s,subUnitId:i}=e,a=t[x(446)](tx);if(!a[x(513)](e.pivotTableId))return!1;const o=a[x(608)](n);if(!o)return!1;const d=a.getCollection(o.unitId,e[x(501)]);if(!d)return!1;const c=a[x(601)](o.unitId,o[x(310)],n);if(!c)return!1;const l=R[x(777)](c);l.targetCellInfo={unitId:s,subUnitId:i,row:r[x(644)],col:r.col};const u=d[x(658)]();if(o[x(310)]===i&&o[x(786)]===s)a.setPivotTable(s,i,n,l),a[x(198)]({unitId:s,subUnitId:i,token:n,type:X0[x(819)]});else{a[x(198)]({unitId:o[x(786)],subUnitId:o[x(310)],token:n,type:X0[x(476)]}),a[x(254)](o[x(786)],o.subUnitId,n);const f=a[x(376)](n,u,c[x(697)],l[x(639)]),b=new xt(f[x(530)],void 0,n);b[x(673)](l[x(641)]),a.addPivotTable(s,i,n,b,l),a[x(198)]({unitId:s,subUnitId:i,token:n,type:X0[x(340)],pivotConfig:l})}return!0}},Hb={type:c0[g(477)],id:g(305),handler:(t,e)=>{const x=g,n=t[x(446)](g0),r=t[x(446)](vx),s=t.get(Wx),i=t.get(N0);if(!e)return!1;const a=ax(i);if(!a)return!1;const{unitId:o,subUnitId:d,workbook:c}=a,l=s[x(601)](e[x(736)][x(786)],e[x(736)][x(310)],e[x(501)]);if(!l)return!1;const u=c[x(771)](e[x(639)][x(310)]);if(!u)throw new Error(x(420));const f=u[x(408)](),b=u[x(566)]();if(e.targetCellInfo[x(644)]>f||e[x(639)][x(458)]>b)throw new Error(x(317));const h=[{id:yn.id,params:{unitId:o,subUnitId:e[x(639)].subUnitId,pivotTableId:e[x(501)],targetCellPosition:{row:e[x(639)][x(644)],col:e.targetCellInfo[x(458)]}}}],p=[{id:yn.id,params:{unitId:o,subUnitId:d,pivotTableId:e.pivotTableId,targetCellPosition:{row:l[x(639)][x(644)],col:l[x(639)][x(458)]}}}];return ox(h,n)&&r[x(503)]({unitID:o,undoMutations:p,redoMutations:h}),!0}},Bb={type:c0.COMMAND,id:g(207),async handler(t,e){const x=g;var n;if(!e)return!1;const r=t.get(N0),s=ax(r);if(!s)return!1;const{unitId:i,subUnitId:a,workbook:o}=s,{row:d,col:c}=e,l=t[x(446)](Re),u=l.getPivotTableIdByCell(i,a,d,c);if(!u)return!1;const f=(n=l.getPivotItemRenderInfoCache(i,a,u))==null?void 0:n.areaInfo;if(!f)return!1;const b=t[x(446)](Wx)[x(601)](i,a,u);if(!b)return!1;const{rowInfo:h,colInfo:p}=f,I=h[d][x(391)],v=p[c][x(391)],C=h[d][x(479)],w=p[c][x(479)],y=I[x(328)](v),P=b.fieldsConfig[x(218)][x(750)](0,C),E=b[x(641)].columnFields[x(750)](0,w),S=P[x(328)](E),T=y[x(714)]((ix,Dx)=>[ix,S[Dx]]),k=(await t.get(px).getPivotDisplayConfig({unitId:i,subUnitId:a,pivotTableId:u,params:{type:M0[x(616)],drillDown:{tuple:T}}})).result[x(610)];if(!k)return!1;const{indexes:V,range:H,sourceUnitId:D,sourceSubUnitId:U,formatMap:j}=k,{startRow:F,endRow:z,startColumn:Q,endColumn:G}=H,Y=new K,t0=z-F,A=G-Q,Z={},J=ax(r,{unitId:D,subUnitId:U});if(!J)return!1;const S0=Ox[x(746)],I0=Ox[x(796)],l0=Ox[x(796)],T0=o[x(660)]()[x(614)](S0),L0=o[x(660)]()[x(614)](I0),Q0=o[x(660)]()[x(614)](l0),{worksheet:n0}=J;let O=0;const W=1;V[x(576)](ix=>{const Dx=x;for(let mx=0;mx<=G-Q;mx++)Y[Dx(614)](O,mx,n0.getCellRaw(ix+H[Dx(799)]+W,mx));O++});for(let ix=Q;ix<=G;ix++){const Dx=n0[x(693)](F,ix);Z[F]||(Z[F]={}),Z[F][ix]={...Dx,s:T0}}let o0=1;const r0={},m0={};Y[x(247)]((ix,Dx)=>{Dx.forEach(mx=>{const ze=Be,Je=Y.getValue(ix,mx);if(Z[o0]||(Z[o0]={}),Z[o0][mx]={...Je,s:o0%2===0?Q0:L0},j[mx]&&ix>=0){const he=o0%2===0;let se=he?m0[mx]:r0[mx];se||(se=o.getStyles()[ze(614)]({...he?l0:I0,n:{pattern:j[mx]}}),he?m0[mx]=se:r0[mx]=se),Z[o0][mx].s=se}}),o0++});const a0=new K(Z),f0={};a0[x(434)]((ix,Dx,mx)=>{f0[ix]||(f0[ix]={}),f0[ix][Dx]={s:null,f:null,si:null,p:null,v:null,t:null,custom:null}});const w0=[],Nx=[],be=o[x(740)]()[x(347)],Lx=wr({rowCount:Math[x(230)](r1,t0+10),columnCount:Math[x(230)](s1,A+5)}),Cx=t[x(446)](jx);Lx.id=Ve(),Lx[x(632)]=o[x(226)](""+Cx.t(x(612)));const ne={index:be,sheet:Lx,unitId:i},b0=Ma(t,ne);Nx.push({id:je.id,params:ne}),w0.push({id:Ee.id,params:b0}),Nx[x(223)]({id:H0.id,params:{unitId:i,subUnitId:Lx.id,cellValue:Z}}),w0[x(654)]({id:H0.id,params:{unitId:i,subUnitId:Lx.id,cellValue:f0}});const ct={startRow:0,startColumn:0,endRow:o0-1,endColumn:G};Nx.push({id:le.id,params:{unitId:i,subUnitId:Lx.id,range:ct}}),w0[x(654)]({id:We.id,params:{unitId:i,subUnitId:Lx.id}});const wx=t[x(446)](g0);return ox(Nx,wx)&&t[x(446)](vx)[x(503)]({unitID:i,undoMutations:w0,redoMutations:Nx}),!0}},Gb={type:c0.COMMAND,id:g(551),async handler(t,e){const x=g;if(!e)return!1;const n=t[x(446)](g0),r=t.get(px),s=t[x(446)](vx),{pivotTableId:i,fieldIds:a,unitId:o,subUnitId:d}=e,c=(await r[x(389)]({unitId:o,subUnitId:d,pivotTableId:i,params:{type:M0[x(510)],removePivotField:{fieldIds:a}}}))[x(733)][x(421)];if(!c)return!1;const{view:l,changesets:u,isEmpty:f,pivotTableConfig:b}=c,h=b[x(639)],p=new Xx;p[x(455)](l);const I={cellInfo:h,view:p,isEmpty:f};if(!await t[x(446)](Mx)[x(318)].fetchThroughAsyncInterceptors(ee)(!0,I))return!1;const v=fe(t,p,h,f),C=me(t,I),{redos:w,undos:y}=qx(n,{pivotTableId:i,unitId:o,subUnitId:d},u);return ox([...v[x(822)],...C.redos,...w],n),s[x(503)]({unitID:o,redoMutations:[...v[x(822)],...C[x(822)],...w],undoMutations:[...v[x(414)],...C[x(414)],...y]}),!0}},Yb={type:c0[g(477)],id:"sheet.command.reset-pivot-fields-config",async handler(t,e){const x=g;if(!e)return!1;const n=t[x(446)](g0),r=t[x(446)](vx),s=t.get(px),{resetArea:i,pivotTableId:a,unitId:o,subUnitId:d}=e,c=(await s[x(389)]({unitId:o,subUnitId:d,pivotTableId:a,params:{type:M0[x(353)],resetPivotTable:{pivotTableId:a,resetArea:i}}}))[x(733)][x(194)];if(!c)return!1;const{changesets:l}=c,{redos:u,undos:f}=qx(n,{pivotTableId:a,unitId:o,subUnitId:d},l);return ox(u,n),r[x(503)]({unitID:o,redoMutations:u,undoMutations:f}),!0}},Wb={type:c0[g(477)],id:g(365),async handler(t,e){const x=g,n=t[x(446)](g0),r=t[x(446)](px),s=t[x(446)](Re),i=t.get(N0),a=t[x(446)](jx),o=t[x(446)](vx);if(!e)return!1;const{unitId:d,subUnitId:c,row:l,col:u,collapse:f}=e,b=i[x(448)](d);if(!b||!b[x(771)](c))return!1;const h=s.getPivotTableIdByCell(d,c,l,u);if(!h)return!1;const p=s.getPivotItemRenderInfoCache(d,c,h);if(!p)return!1;const I=Gx(l,u),{rangesInfo:v,areaInfo:C,headerMap:w}=p;if(!v||!C||!w)return!1;const y=Object[x(808)](v).find(Z=>v[Z][x(213)](J=>x0[x(679)](J,I)));let P;y===x(257)?P=w.rowHeaderMap[u]:y===x(478)&&(P=w[x(540)][l]);const E=P==null?void 0:P[x(801)],S=s[x(350)](d,c,l,u);let T=S==null?void 0:S.v;if(T===a.t(x(747))&&(T=sx[x(649)]),T==null||!h||!E)return!1;const k=await r.getPivotDisplayConfig({unitId:d,subUnitId:c,pivotTableId:h,params:{type:M0[x(559)],setPivotCollapse:{tableFieldId:E,collapse:f,item:T}}}),V=k==null?void 0:k[x(733)][x(491)];if(!V)return!1;const{view:H,pivotTableConfig:D,isEmpty:U,changesets:j}=V,F=new Xx;F[x(455)](H);const z=D[x(639)],Q={cellInfo:z,view:F,isEmpty:U};if(!await t[x(446)](Mx).asyncInterceptor.fetchThroughAsyncInterceptors(ee)(!0,Q))return!1;const G=fe(t,F,z,U),Y=me(t,Q),{redos:t0,undos:A}=qx(n,{pivotTableId:h,unitId:d,subUnitId:c},j);return ox([...G[x(822)],...Y[x(822)],...t0],n),o[x(503)]({unitID:d,redoMutations:[...G[x(822)],...Y[x(822)],...t0],undoMutations:[...G[x(414)],...Y[x(414)],...A]}),!0}},Qb={type:c0[g(477)],id:g(413),async handler(t,e){const x=g;if(!e)return!1;const n=t.get(g0),r=t.get(vx),s=t[x(446)](px),{pivotTableConfig:i,pivotTableId:a,unitId:o,subUnitId:d}=e,c=(await s[x(389)]({unitId:o,subUnitId:d,pivotTableId:a,params:{type:M0[x(572)],setPivotTableConfig:{pivotTableId:a,pivotTableConfig:i}}}))[x(733)][x(336)];if(!c)return!1;const{changesets:l}=c,{redos:u,undos:f}=qx(n,{pivotTableId:a,unitId:o,subUnitId:d},l);return ox(u,n),r.pushUndoRedo({unitID:o,redoMutations:u,undoMutations:f}),!0}},zb={type:c0.COMMAND,id:g(411),async handler(t,e){const x=g;if(!e)return!1;const n=t[x(446)](g0),{pivotTableId:r,tableFieldId:s,items:i,unitId:a,subUnitId:o,isAll:d}=e,c=t[x(446)](px),l=t.get(vx),u=(await c[x(389)]({unitId:a,subUnitId:o,pivotTableId:r,params:{type:M0[x(374)],setPivotFilter:{tableFieldId:s,items:i,isAll:d}}})).result[x(273)];if(!u)return!1;const{changesets:f,pivotTableConfig:b,isEmpty:h,view:p}=u,I=b.targetCellInfo,v=new Xx;v[x(455)](p);const C={cellInfo:I,view:v,isEmpty:h};if(!await t[x(446)](Mx)[x(318)][x(312)](ee)(!0,C))return!1;const w=fe(t,v,I,h),y=me(t,C),{undos:P,redos:E}=qx(n,{pivotTableId:r,unitId:a,subUnitId:o},f);return ox([...w.redos,...y[x(822)],...E],n),l[x(503)]({unitID:a,redoMutations:[...w[x(822)],...y[x(822)],...E],undoMutations:[...w.undos,...y[x(414)],...P]}),!0}},Jb={type:c0[g(477)],id:g(362),async handler(t,e){const x=g;if(!e)return!1;const n=t.get(g0),r=t[x(446)](vx),s=t[x(446)](px),{info:i,tableFieldId:a,pivotTableId:o,unitId:d,subUnitId:c}=e,l=(await s[x(389)]({unitId:d,subUnitId:c,pivotTableId:o,params:{type:M0[x(227)],setPivotSort:{tableFieldId:a,info:i}}})).result[x(457)];if(!l)return!1;const{changesets:u}=l,{redos:f,undos:b}=qx(n,{pivotTableId:o,unitId:d,subUnitId:c},u);return ox(f,n),r[x(503)]({unitID:d,redoMutations:f,undoMutations:b}),!0}},Xb={type:c0[g(477)],id:"sheet.command.set-pivot-value-filter",async handler(t,e){const x=g;if(!e)return!1;const n=t.get(g0),{pivotTableId:r,fieldId:s,valueFilterInfo:i,unitId:a,subUnitId:o}=e,d=t[x(446)](px),c=t[x(446)](vx),l=(await d[x(389)]({unitId:a,subUnitId:o,pivotTableId:r,params:{type:M0[x(690)],setValuePivotFilter:{tableFieldId:s,filterInfo:i}}}))[x(733)][x(791)];if(!l)return!1;const{changesets:u,pivotTableConfig:f,isEmpty:b,view:h}=l,p=f[x(639)],I=new Xx;I[x(455)](h);const v={cellInfo:p,view:I,isEmpty:b};if(!await t[x(446)](Mx)[x(318)][x(312)](ee)(!0,v))return!1;const C=fe(t,I,p,b),w=me(t,v),{undos:y,redos:P}=qx(n,{pivotTableId:r,unitId:a,subUnitId:o},u);return ox([...C.redos,...w[x(822)],...P],n),c[x(503)]({unitID:a,redoMutations:[...C[x(822)],...w[x(822)],...P],undoMutations:[...C.undos,...w[x(414)],...y]}),!0}},hr={id:g(611),type:c0[g(738)],handler:(t,e)=>{const x=g;if(!e)return!1;if(t[x(446)](W0)[x(506)](fx))return!0;const{unitId:n,subUnitId:r,pivotTableId:s,tableFieldId:i,dateType:a}=e,o=t.get(tx),d=o[x(513)](s);if(!d)return!1;const c=d[x(372)](i);if(!c)return!1;const l=c[x(265)](),u=d[x(645)](l),f=(u==null?void 0:u[x(193)]())+" "+No(t,a);o[x(299)](n,s)[x(243)](c.id,f);const b=d[x(356)](i);if(!b)return!1;d.renameField(b[x(323)](),f),c[x(589)](a);const h=o[x(601)](n,r,s);return o[x(198)]({unitId:n,subUnitId:r,token:s,type:X0.Set,pivotConfig:h}),!0}},qb={id:"sheet.command.update-date-group",type:c0[g(477)],handler:(t,e)=>{const x=g;if(!e)return!1;const n=t[x(446)](vx),{unitId:r,subUnitId:s,pivotTableId:i,tableFieldId:a}=e,o=[],d=[],c=t[x(446)](Wx),l=c.getCollection(r,i),u=c.getPivotTableConfig(r,s,i);if(!(u!=null&&u[x(641)].dimension))return!1;const f=Object[x(258)](u[x(641)].dimension).find(I=>I.id===a);if(!f)return!1;const b=f[x(760)];if(!(l!=null&&l[x(308)]))return!1;const h=Object.values(l==null?void 0:l[x(308)])[x(702)](I=>I.id===b);if(!h)return!1;m8(h)&&o[x(223)]({id:hr.id,params:{...e,dateType:h[x(554)]}}),d[x(223)]({id:hr.id,params:{...e}});const p=t[x(446)](g0);return ox(d,p)&&n[x(503)]({unitID:r,undoMutations:o,redoMutations:d}),!0}},Kb={type:c0.COMMAND,id:"sheet.command.set-pivot-field-setting",async handler(t,e){const x=g;if(!e)return!1;const n=t.get(g0),r=t.get(vx),s=t.get(px),{displayName:i,subtotalType:a,format:o,tableFieldId:d,pivotTableId:c,unitId:l,subUnitId:u}=e,f=(await s.getPivotDisplayConfig({unitId:l,subUnitId:u,pivotTableId:c,params:{type:M0[x(521)],setPivotSetting:{tableFieldId:d,displayName:i,subtotalType:a,format:o}}}))[x(733)].setPivotSetting;if(!f)return!1;const{changesets:b,view:h,pivotTableConfig:p,isEmpty:I}=f,v=p.targetCellInfo,C=new Xx;C.formJSON(h);const w={cellInfo:v,view:C,isEmpty:I};if(!await t[x(446)](Mx)[x(318)].fetchThroughAsyncInterceptors(ee)(!0,w))return!1;const y=fe(t,C,v,I),P=me(t,w),{undos:E,redos:S}=qx(n,{pivotTableId:c,unitId:l,subUnitId:u},b);return ox([...y[x(822)],...P[x(822)],...S],n),r[x(503)]({unitID:l,redoMutations:[...y[x(822)],...P.redos,...S],undoMutations:[...y[x(414)],...P.undos,...E]}),!0}},pr={type:c0[g(738)],id:g(239),handler(t,e){const x=g;if(!e)return!1;if(t[x(446)](W0)[x(506)](fx))return!0;const n=t[x(446)](tx),{pivotTableId:r,deleteIds:s,collectionJSON:i,dataRangeInfo:a,unitId:o,subUnitId:d}=e,c=n[x(513)](r),l=n[x(601)](o,d,r);if(!c||!l)return!1;const{collection:u,updateDataFieldList:f}=n[x(376)](r,i,a,l[x(639)]);n[x(349)](u,f,a),c[x(234)](u);for(const h of s)n.removeDataField(a[x(786)],h);const b=n.getPivotTableConfig(o,d,r);return b[x(697)]=JSON[x(327)](JSON.stringify(a)),n[x(198)]({unitId:o,subUnitId:d,token:r,type:X0[x(819)]}),!0}},Zb={type:c0[g(477)],id:g(463),async handler(t,e){const x=g,n=t[x(446)](g0),r=t[x(446)](px),s=t[x(446)](vx);if(!e)return!1;const{token:i,dataRangeInfo:a,unitId:o,subUnitId:d}=e,c=[],l=[],u=(await r[x(389)]({unitId:o,subUnitId:d,pivotTableId:i,params:{type:M0.UpdatePivotSource,updatePivotSource:{dataRangeInfo:a,unitId:o,subUnitId:d}}}))[x(733)][x(354)];if(!u)return!1;const{changesets:f,deleteIds:b,collectionConfig:h,oldCollectionConfig:p,view:I,isEmpty:v,pivotTableConfig:C}=u;l.push({id:pr.id,params:{pivotTableId:i,deleteIds:b,collectionJSON:h,dataRangeInfo:a,unitId:o,subUnitId:d}}),c.unshift({id:pr.id,params:{pivotTableId:i,deleteIds:[],collectionJSON:p,dataRangeInfo:C.sourceRangeInfo,unitId:o,subUnitId:d}});const w=C[x(639)],y=new Xx;y[x(455)](I);const P={cellInfo:w,view:y,isEmpty:v};if(!await t[x(446)](Mx)[x(318)][x(312)](ee)(!0,P))return!1;const E=fe(t,y,w,v),S=me(t,P),{undos:T,redos:k}=qx(n,{pivotTableId:i,unitId:o,subUnitId:d},f);return ox([...E[x(822)],...S[x(822)],...l,...T],n),s.pushUndoRedo({unitID:o,redoMutations:[...E[x(822)],...S.redos,...l,...T],undoMutations:[...E[x(414)],...S[x(414)],...c,...k]}),!0}},xh={type:c0[g(477)],id:g(208),async handler(t,e){const x=g;if(!e)return!1;const n=t.get(g0),r=t[x(446)](px),s=t[x(446)](N0),i=t[x(446)](vx),{pivotTableId:a,position:o,index:d}=e,c=ax(s);if(!c)return!1;const{unitId:l,subUnitId:u}=c,f=(await r.getPivotDisplayConfig({unitId:l,subUnitId:u,pivotTableId:a,params:{type:M0[x(570)],updateValuePosition:{position:o,index:d}}}))[x(733)][x(315)];if(!f)return!1;const{changesets:b,view:h,isEmpty:p,pivotTableConfig:I}=f,v=I[x(639)],C=new Xx;C[x(455)](h);const w=t.get(Mx),y={cellInfo:v,view:C,isEmpty:p};if(!await w[x(318)][x(312)](ee)(!0,y))return!1;const P=fe(t,C,v,p),E=me(t,y),{undos:S,redos:T}=qx(n,{pivotTableId:a,unitId:l,subUnitId:u},b);return ox([...P.redos,...E[x(822)],...T],n),i[x(503)]({unitID:l,redoMutations:[...P.redos,...E[x(822)],...T],undoMutations:[...P[x(414)],...E[x(414)],...S]}),!0}},U2={type:c0[g(738)],id:g(412),handler(){return!0}};Object[g(767)];var eh=(t,e,x,n)=>{const r=g;for(var s=e,i=t[r(347)]-1,a;i>=0;i--)(a=t[i])&&(s=a(s)||s);return s},Gt=(t,e)=>(x,n)=>e(x,n,t);const th=()=>({runtimeCellData:{},dirtyRanges:{}}),nh=(t,e,x)=>{const n=g,r=t[n(191)];t[n(383)](s=>{const i=n,a=s[i(323)](),o=s[i(537)](),d=s.getSourceName(),c=s[i(509)]();e[o]&&e[o]===c&&d===c&&(t[i(460)](a,r[i(509)](o)),s.setSourceName(r[i(509)](o)))}),t[n(592)](e0[n(642)],s=>{const i=n,a=s[i(323)](),o=s.getDataFieldId(),d=s.getSourceName(),c=s[i(509)](),l=s[i(711)](),u=x(d,l);e[o]&&e[o]===d&&u===c&&(t[i(460)](a,x(r[i(509)](o),l)),s.setSourceName(r[i(509)](o)))})},sh=(t,e,x)=>{const n=g;var r,s;const{arrayFormulaCellData:i,unitData:a}=e,{unitId:o,subUnitId:d}=x,c=x[n(313)],{startColumn:l,endColumn:u}=c,f=(r=i==null?void 0:i[o])==null?void 0:r[d],b=(s=a==null?void 0:a[o])==null?void 0:s[d],h=new Set,p=u-l+1,{dirtyRanges:I}=t;if(I)for(const{range:v,sheetId:C,unitId:w}of I){if(C!==d||o!==w)continue;const y=x0[n(580)](v,c);if(y){const{startColumn:P,endColumn:E}=y;for(let S=P;S<=E;S++)h.add(S)}}if(h[n(692)]===p||h[n(692)]===p)return Array[n(764)](h);if(b){const v=b[n(245)](),C=Object[n(808)](v);for(const w of C){const y=Number(w),P=v[y];if(h[n(692)]===p)break;for(const E in P){const S=Number(E);S<l||S>u||h[n(532)](S)}}}if(f){const v=f[n(245)](),C=Object[n(808)](v);for(const w of C){const y=Number(w),P=v[y];if(h[n(692)]===p)break;for(const E in P){const S=Number(E);S<l||S>u||h.add(S)}}}return Array.from(h)},rh=t=>{const e=g,x=new Set,n=[];for(const r of t){const s=r[e(799)]+","+r.endRow+","+r[e(294)]+","+r[e(752)];x[e(361)](s)||(x.add(s),n[e(223)](r))}return n};let xn=class extends U0{constructor(t,e,x,n,r){const s=g;super(),_0(this,s(486),new o1(!0)),_0(this,s(542),i=>{const a=s;this[a(486)][a(523)](!1)}),_0(this,s(490),i=>{const a=s;this[a(486)][a(523)](!0)}),this[s(441)]=t,this[s(618)]=e,this[s(529)]=x,this[s(302)]=n,this[s(236)]=r,this[s(759)](),this[s(367)]()}_init(){const t=g;this[t(502)](),this[t(489)](),this._initPivotTextInfo(),this[t(439)]()}[g(779)](){const t=g;this[t(302)][t(751)](this[t(486)]),xt[t(270)](vn[t(768)],this[t(542)]),xt[t(270)](vn[t(288)],this[t(490)])}_initPivotDataGetListener(){const t=g;this[t(416)](this[t(529)][t(409)](e=>{const x=t;e.id===hx.id&&this[x(441)][x(624)](e.params)})),this[t(416)](this._commandService[t(409)](e=>{const x=t;if(e.id!==Yr.id)return;const n=e[x(324)],{unitId:r,subUnitId:s,pivotTableId:i}=n,a=n.params.type,o={};switch(a){case M0[x(468)]:{const d=n[x(324)][x(758)];if(!d)return;const{row:c,col:l,cellData:u,pivotItemRenderInfoCache:f,tableFieldId:b}=d,h=this[x(441)][x(513)](n[x(501)]);if(!h||!f)return;if(b){const p=h[x(372)](b);if(!p)return;o.filter={...h[x(729)](p),tableFieldId:b,pivotTableId:n.pivotTableId,filterInfo:h.getFilterInfo(b),sortInfo:h[x(712)](b),format:h.getFieldFormat(b)}}else{const p=cb(c,l,u,h,f),I=p==null?void 0:p[x(675)];if(!I)return;const v=h[x(372)](I);if(!v)return;o[x(758)]={...h[x(729)](v),tableFieldId:I,pivotTableId:n[x(501)],filterInfo:h.getFilterInfo(I),sortInfo:h.getSortInfo(I),format:h[x(274)](I)}}}break;case M0[x(790)]:{const d=n.params[x(597)];if(!d)return;const{pivotTableId:c}=d,l=this[x(441)][x(513)](c);if(!l)return;const u=this[x(441)][x(601)](r,s,c),f=lb(l,c,u);o.panel=f}break;case M0.AddPivotField:{const d=this[x(441)][x(513)](i),c=this[x(441)].getDataFieldManager(r),l=c[x(299)](i);let u=null;const f=this[x(441)][x(601)](r,s,i),b=n[x(324)][x(650)];if(!d||!f||!b)return!1;const{dataFieldId:h,fieldArea:p,index:I}=b;d[x(197)]();const v=d[x(628)](h,p,I);if(v&&p===e0.Value){const E=v[x(323)](),S=d[x(372)](E);if(S){const H=S==null?void 0:S[x(621)]();d.setSubtotalType(v[x(323)](),H===R0[x(685)]?p0[x(812)]:p0[x(232)])}const T=d.getValueIndex(),k=d[x(225)](),V=d.getFieldCountByArea(e0[x(642)]);if(T===-1&&V>1){const H=k===Fx[x(591)]?Fx[x(598)]:k,D=H===Fx[x(514)]?e0[x(514)]:e0[x(598)];d[x(315)](H,d.getFieldCountByArea(D))}}else if(v&&(p===e0[x(514)]||p===e0[x(598)])){const E=v[x(323)](),S=d[x(372)](E);if(S&&(S==null?void 0:S[x(621)]())===R0.date){const T=S.getformat();if(T&&d.setFieldFormat(v.getId(),T),!l[x(344)]().some(k=>{const V=x,H=l[V(189)](k);return u8(H)?H[V(575)]().originalFieldId===h:!1})){const k=c[x(192)](),V=gb(S[x(387)],S[x(630)]),H=S.getName()+x(385)+No(this[x(236)],V),D=new Hr(k,H,He(3),S[x(323)](),V);c[x(280)](D),l[x(261)](k,H),d[x(628)](k,p,(I??0)+1),u=D}}}const C=d[x(691)](),w=d[x(705)]()[x(658)]();let y;if(u){y=u[x(658)]();const E=u[x(323)]();l.deleteField(E);let S=!0;for(const T in c.collections)if(c[x(244)][T][x(344)]()[x(467)](E)){S=!1;break}S&&c[x(721)](E)}const P=d[x(440)]();o.addPivotField={view:w,changesets:P,isEmpty:C,pivotTableConfig:f,shouldBeAddedGroupJSON:y}}break;case M0.AddPivotTable:{const d=n[x(324)][x(437)];if(!d)return;const c=d[x(697)],l=d[x(501)],{collection:u}=this[x(441)].createCollectionWithDataRange({unitId:c[x(786)],sheetName:c.sheetName,subUnitId:c[x(310)],range:c[x(313)]}),f=new xt(u,void 0,l),b=f.query(),h=f[x(658)](),p=u[x(658)]();o[x(437)]={view:b,fieldsConfig:h,collectionConfig:p,isEmpty:f[x(691)]()}}break;case M0[x(256)]:{const d=n[x(324)].movePivotField;if(!d)return;const{fieldId:c,area:l,index:u}=d,f=this[x(441)][x(601)](r,s,i);if(!f)return;const b=this[x(441)][x(513)](i);if(!b)return;b.startCollectChangeset();const{area:h,index:p}=b[x(206)](c);if(b[x(561)](c,l,u),l===e0[x(642)]&&b[x(356)](c).getSubtotal()===void 0){const E=b[x(356)](c);if(E&&E[x(711)]()===void 0){const S=b[x(372)](c);if(S){const T=S==null?void 0:S[x(621)]();b[x(723)](c,T===R0[x(685)]?p0[x(812)]:p0[x(232)])}}}const I=b[x(225)](),v=b[x(785)](),C=b[x(637)](e0.Value)>1;if(C&&h===l&&(l===e0[x(514)]&&I===Fx[x(514)]||l===e0.Column&&I===Fx[x(598)])){let E=v;p<=v&&E--,u<=v&&E++,b[x(315)](I,E)}else C&&(h===e0[x(514)]&&I===Fx[x(514)]||h===e0.Column&&I===Fx[x(598)])&&v>=p&&b[x(315)](I,v-1),C&&(l===e0.Row&&I===Fx[x(514)]||l===e0[x(598)]&&I===Fx[x(598)])&&v>=u&&b[x(315)](I,v+1);const w=b[x(705)](),y=b[x(691)](),P=b[x(440)]();o.movePivotField={view:w[x(658)](),changesets:P,isEmpty:y,pivotTableConfig:f}}break;case M0[x(510)]:{const d=n.params[x(421)];if(!d)return;const c=d[x(399)],l=this[x(441)].getPivotTableConfig(r,s,i);if(!l)return!1;const u=this._sheetsPivotDataSourceModel[x(513)](i);if(!u)return!1;u[x(197)]();for(const p of c){const{area:I}=u[x(206)](p);I===e0[x(642)]&&u[x(338)](p),(I===e0[x(514)]||I===e0[x(598)])&&u[x(279)](p),u[x(585)](p)}const f=u[x(691)](),b=u[x(705)]()[x(658)](),h=u[x(440)]();o[x(421)]={changesets:h,pivotTableConfig:l,isEmpty:f,view:b}}break;case M0[x(374)]:{const d=n[x(324)][x(273)];if(!d)return;const{tableFieldId:c,items:l,isAll:u}=d,f=this[x(441)].getPivotTableInstance(i),b=this[x(441)][x(601)](r,s,i);if(!f||!b)return;f[x(197)](),f[x(291)](c,{type:$e[x(713)],list:l,isAll:u});const h=f.isEmpty(),p=f[x(705)]()[x(658)](),I=f[x(440)]();o[x(273)]={view:p,changesets:I,isEmpty:h,pivotTableConfig:b}}break;case M0[x(690)]:{const d=n[x(324)][x(791)];if(!d)return;const{tableFieldId:c,filterInfo:l}=d,u=this[x(441)][x(513)](i),f=this[x(441)][x(601)](r,s,i);if(!u||!f)return;u.startCollectChangeset(),u[x(204)](c,l);const b=u[x(691)](),h=u[x(705)]()[x(658)](),p=u[x(440)]();o.setValuePivotFilter={view:h,changesets:p,isEmpty:b,pivotTableConfig:f}}break;case M0[x(227)]:{const d=n[x(324)][x(457)];if(!d)return;const{tableFieldId:c,info:l}=d,u=this._sheetsPivotDataSourceModel[x(513)](i),f=this._sheetsPivotDataSourceModel[x(601)](r,s,i);if(!u||!f)return;u.startCollectChangeset(),u[x(821)](c,l);const b=u[x(691)](),h=u[x(705)]()[x(658)](),p=u[x(440)]();o.setPivotSort={view:h,changesets:p,isEmpty:b,pivotTableConfig:f}}break;case M0[x(521)]:{const d=n[x(324)][x(522)];if(!d)return;const{tableFieldId:c,displayName:l,subtotalType:u,format:f}=d,b=this._sheetsPivotDataSourceModel[x(513)](i),h=this[x(441)][x(601)](r,s,i);if(!b||!h)return;b[x(197)](),l!==void 0&&b[x(460)](c,l),u!==void 0&&b.setSubtotalType(c,u),f!==void 0&&b.setFieldFormat(c,f);const p=b[x(691)](),I=b.query()[x(658)](),v=b.endCollectChangeset();o.setPivotSetting={changesets:v,pivotTableConfig:h,isEmpty:p,view:I}}break;case M0[x(255)]:{const d=n[x(324)][x(354)];if(!d)return;const{dataRangeInfo:c,unitId:l,subUnitId:u}=d,f=this[x(441)][x(601)](l,u,i),b=this._sheetsPivotDataSourceModel.getPivotTableInstance(i);if(!this[x(441)].getCollection(l,i)||!b||!f)return;const h=this[x(441)][x(776)](l,i,c),p=this[x(441)][x(299)](l,i)[x(658)](),{collection:I}=this[x(441)][x(622)]({unitId:c[x(786)],sheetName:c.sheetName,subUnitId:c.subUnitId,range:c[x(313)]}),v=I[x(658)]();b[x(197)]();const C=this._sheetsPivotDataSourceModel[x(795)](l).getAutoDisplayNameFunction()||Zt;b[x(285)](E=>{const S=x,T=E.getDataFieldId();if(!I[S(493)](T)){const k=I[S(450)](E[S(587)]());if(k){b[S(781)](E[S(323)](),k[S(193)](),k.getId());const{area:V}=b[S(206)](E[S(323)]());let H=E.getSourceName();const D=E.getDisplayName();if(V===e0[S(642)]){const U=E[S(711)]();H=C(k[S(193)](),U)}D!==H&&b[S(460)](E[S(323)](),H)}else b[S(585)](E[S(323)]())}});const w=b[x(691)](),y=b.query().toJSON(),P=b.endCollectChangeset();o[x(354)]={view:y,changesets:P,isEmpty:w,pivotTableConfig:f,collectionConfig:v,oldCollectionConfig:p,deleteIds:h}}break;case M0[x(570)]:{const d=n.params[x(315)];if(!d)return;const{position:c,index:l}=d,u=this[x(441)][x(601)](r,s,i);if(!u)return!1;const f=this[x(441)][x(513)](i);if(!f)return!1;f[x(197)](),f[x(315)](c,l);const b=f[x(691)](),h=f.query()[x(658)](),p=f[x(440)]();o[x(315)]={changesets:p,pivotTableConfig:u,isEmpty:b,view:h}}break;case M0.SetPivotCollapse:{const d=n.params.setPivotCollapse;if(!d)return;const{tableFieldId:c,collapse:l,item:u}=d,f=this[x(441)][x(513)](i),b=this._sheetsPivotDataSourceModel[x(601)](r,s,i);if(!f||!b)return;f[x(197)](),f[x(469)](c,l,u);const h=f[x(691)](),p=f[x(705)]()[x(658)](),I=f[x(440)]();o[x(491)]={view:p,isEmpty:h,pivotTableConfig:b,changesets:I}}break;case M0[x(572)]:{const d=n[x(324)][x(336)];if(!d)return;const{pivotTableConfig:c}=d,l=this[x(441)][x(513)](i),u=this[x(441)][x(601)](r,s,i);if(!l||!u)return;l.startCollectChangeset(),_b(l,c);const f=l[x(691)](),b=l[x(705)]()[x(658)](),h=l[x(440)]();o[x(336)]={view:b,isEmpty:f,pivotTableConfig:{...u,fieldsConfig:l[x(658)]()},changesets:h}}break;case M0[x(353)]:{const d=n.params.resetPivotTable;if(!d)return;const c=this[x(441)][x(513)](i),l=this[x(441)][x(601)](r,s,i);if(!c||!l)return;c[x(197)](),Ib(c,d[x(512)]);const u=c[x(705)]()[x(658)](),f=c[x(440)]();o[x(194)]={view:u,isEmpty:!0,pivotTableConfig:{...l,fieldsConfig:c.toJSON()},changesets:f}}break;case M0.AddPivotTableWithConfig:{const d=n[x(324)][x(683)];if(!d)return;const c=d[x(697)],l=d[x(501)],{collection:u}=this._sheetsPivotDataSourceModel[x(622)]({unitId:c[x(786)],sheetName:c[x(210)],subUnitId:c[x(310)],range:c.range}),f=new xt(u,void 0,l),b=u[x(344)](),{rows:h,columns:p,filters:I,values:v}=d.pivotTableIndexConfig;f[x(197)]();for(const{field:S,selectedItems:T}of h||[]){const k=b[S];if(k){const V=f.addFieldWithSourceId(k,e0[x(514)]);T&&V&&f.setLabelFilterInfo(V[x(323)](),{type:$e[x(713)],list:T,isAll:!1})}}for(const{field:S,selectedItems:T}of p||[]){const k=b[S];if(k){const V=f[x(628)](k,e0[x(598)]);T&&V&&f[x(291)](V[x(323)](),{type:$e[x(713)],list:T,isAll:!1})}}for(const{field:S,selectedItems:T}of I||[]){const k=b[S];if(k){const V=f.addFieldWithSourceId(k,e0[x(468)]);T&&V&&f[x(291)](V[x(323)](),{type:$e[x(713)],list:T,isAll:!1})}}for(const{field:S,subTotalType:T,formatString:k}of v||[]){const V=u.getFieldById(b[S]);if(!V)continue;const H=b[S];if(H){const D=f[x(628)](H,e0[x(642)]);if(D){if(T!==void 0){f.setSubtotalType(D[x(323)](),T);const U=this[x(441)][x(795)](c.unitId)[x(431)]()||Zt,j=u[x(509)](H),F=U(j,T);f[x(460)](D[x(323)](),F)}else if(V){const U=V==null?void 0:V.getFieldDataType();f[x(723)](D[x(323)](),U===R0.number?p0.sum:p0[x(232)])}k&&f[x(199)](D.getId(),k)}}}const C=f.query(),w=f[x(658)](),y=f[x(691)](),P=f[x(440)](),E=u[x(658)]();o[x(683)]={view:C,fieldsConfig:w,collectionConfig:E,isEmpty:y,changesets:P}}break;case M0[x(616)]:{const d=ub(this[x(236)],n);if(!d)return;const{range:c,sourceSubUnitId:l,sourceUnitId:u,formatMap:f,indexes:b}=d;o[x(610)]={range:c,sourceSubUnitId:l,sourceUnitId:u,formatMap:f,indexes:b}}break}this[x(529)][x(678)](Wr.id,{version:n[x(449)],result:o},{onlyLocal:!0})}))}[g(425)](){const t=g;this[t(416)](this[t(529)][t(409)](e=>{const x=t;if(e.id!==zr.id)return;const n=e.params;return this._sheetsPivotDataSourceModel[x(810)](n[x(638)]),!0}))}[g(502)](){const t=g;this[t(441)].collectionChange$[t(553)](e=>{const x=t;switch(e[x(635)]){case tt[x(532)]:e[x(687)]&&e[x(639)]&&this[x(246)](e[x(710)],e.dataRangeInfo,e[x(639)]);break;case tt[x(498)]:{const{unitId:n,subUnitId:r,token:s}=e;n&&r&&s&&this[x(248)](n,r,s)}break;case tt[x(378)]:{const{token:n,oldSourceRangeInfo:r,dataRangeInfo:s,targetCellInfo:i}=e,{unitId:a,subUnitId:o}=r||{};a&&o&&n&&this.removeSourceRangeChange(a,o,n),s&&i&&this[x(246)](n,s,i)}break}})}[g(439)](){const t=g;this[t(441)][t(680)][t(553)](e=>{const x=t;Object[x(808)](e).forEach(n=>{const r=x,s=this[r(441)].getTargetByPivotId(n);if(s){const i=this[r(441)][r(601)](s==null?void 0:s[r(786)],s==null?void 0:s[r(310)],n);i&&(this[r(246)](n,i[r(697)],i.targetCellInfo),this.triggerDirtyFeature([{unitId:s[r(786)],subUnitId:s.subUnitId,token:n}]))}})})}[g(489)](){const t=g;this[t(441)].viewData$.subscribe(e=>{const x=t,{unitId:n,subUnitId:r,pivotTableId:s}=e;n&&r&&s&&this[x(788)]([{unitId:n,subUnitId:r,token:s}])})}[g(788)](t){const e=g,x={};t[e(576)](n=>{var r,s;const{unitId:i,subUnitId:a,token:o}=n;x[i]=(r=x[i])!=null?r:{},x[i][a]=(s=x[i][a])!=null?s:{},x[i][a][o]=!0}),this[e(529)][e(678)](U2.id,x)}[g(248)](t,e,x){this[g(618)].remove(t,e,[x])}[g(246)](t,e,x){const n=g,{unitId:r,subUnitId:s}=e;this[n(618)][n(361)](x[n(786)],x.subUnitId,t)&&this[n(248)](r,s,t);const i={sheetId:s,...e};this._featureCalculationManagerService.register(x.unitId,x.subUnitId,t,{unitId:x[n(786)],subUnitId:x[n(310)],dependencyRanges:[i],getDirtyData:(a,o)=>{const d=n,c=this[d(441)],l=c[d(608)](t);if(!l)return th();const{unitId:u,subUnitId:f}=l,b=sh(a,o,e);if(b.length>0){const h=c[d(299)](r,t),p=h[d(344)](),I=this.getMatrixFromRunTimeData(e[d(786)],e[d(310)],o),v={},C=this[d(441)][d(795)](u)[d(431)]()||Zt,w=[];for(const P of b){const E=P-(e[d(313)][d(294)]||0),S=p[E];w[d(223)](S),v[S]=h[d(189)](S)[d(193)](),c[d(795)](r)[d(422)](S,e,E,I)}h[d(728)](w)[d(576)](P=>{const E=d,[S,T]=P,k=h[E(189)](S),V=h[E(189)](T);k&&V&&k[E(461)](V)}),h[d(681)]();const y=c[d(513)](t);if(y){nh(y,v,C),y[d(424)](!0);const P=y[d(705)](),E=c[d(601)](u,f,t),S=c[d(795)](r)[d(658)]();c.updateView(u,f,X0[d(819)],t,P,E,S,!0)}}return this[d(536)](u,f,t)}})}getMatrixFromRunTimeData(t,e,x){var n,r;const{arrayFormulaCellData:s,unitData:i}=x,a=(n=s==null?void 0:s[t])==null?void 0:n[e],o=(r=i==null?void 0:i[t])==null?void 0:r[e];return{arrayFormulaCellDataMatrix:a,unitDataMatrix:o}}[g(536)](t,e,x){const n=g,r=this._sheetsPivotDataSourceModel.getViewData(t,e,x),s=[],i=new K;if(r){const{rangeCache:o,matrix:d,oldRangeCache:c,oldMatrix:l}=r,u=tr(c),f=tr(o);s[n(223)](...f,...u),l&&c&&u[n(576)](b=>{const h=n;for(let p=b[h(799)];p<=b[h(606)];p++)for(let I=b.startColumn;I<=b[h(752)];I++)i[h(666)](p,I)}),d&&f&&f[n(576)](b=>{const h=n;for(let p=b[h(799)];p<=b[h(606)];p++)for(let I=b[h(294)];I<=b[h(752)];I++)i.setValue(p,I,d[h(278)](p,I))})}const a={};return a[t]={[e]:rh(s)},{runtimeCellData:{[t]:{[e]:i}},dirtyRanges:a}}dispose(){}};xn=eh([Gt(0,q(tx)),Gt(1,q(T1)),Gt(2,q(g0)),Gt(3,q(M1)),Gt(4,q(Vx))],xn);Object[g(767)];var ih=(t,e,x,n)=>{const r=g;for(var s=e,i=t[r(347)]-1,a;i>=0;i--)(a=t[i])&&(s=a(s)||s);return s},Qn=(t,e)=>(x,n)=>e(x,n,t);let en=class extends U0{constructor(t,e,x,n){const r=g;super(),_0(this,"disposableCollection",new Pr),this[r(221)]=t,this[r(584)]=e,this[r(240)]=x,this._sheetsPivotTableConfigModel=n,this._initClearSelectionCommandInterceptor()}[g(534)](){const t=g;this[t(416)](this[t(584)].interceptCommand({getMutations:e=>{const x=t;if(e.id===P1.id||e.id===Na.id){const n=[],r=[],s=this._sheetsSelectionsService[x(275)]()[x(714)](l=>l[x(313)]),i=ax(this._univerInstanceService);if(!i)return{redos:[],undos:[]};const{unitId:a,subUnitId:o}=i,d={},c=this[x(701)][x(406)](a,o);if(c!=null&&c[x(692)])for(const[l,u]of c){const{unitId:f,subUnitId:b,row:h,col:p}=u.targetCellInfo;f===i.unitId&&b===i[x(310)]&&(d[h+"-"+p]=l)}return s&&i&&s.forEach(l=>{const u=x;Rx[u(311)](l,(f,b)=>{const h=u,p=f+"-"+b;if(d[p]){const I=d[p];n[h(223)]({id:bs.id,params:{unitId:a,subUnitId:o,pivotTableId:I}});const v=this[h(701)][h(299)](a,I),C=this[h(701)][h(601)](a,o,I);r[h(223)]({id:$n.id,params:{unitId:a,subUnitId:o,pivotTableId:I,pivotTableConfig:C,collectionConfig:v}})}})}),{redos:n,undos:r}}return{redos:[],undos:[]}}}))}};en=ih([Qn(0,N0),Qn(1,q(Ye)),Qn(2,q(Se)),Qn(3,q(Wx))],en);Object[g(767)];var ah=(t,e,x,n)=>{const r=g;for(var s=e,i=t[r(347)]-1,a;i>=0;i--)(a=t[i])&&(s=a(s)||s);return s},Yt=(t,e)=>(x,n)=>e(x,n,t);let tn=class extends U0{constructor(t,e,x,n,r){const s=g;super(),this[s(584)]=t,this[s(236)]=e,this[s(221)]=x,this._sheetsPivotTableConfigModel=n,this._sheetsPivotTableService=r,this[s(272)]()}[g(517)](t,e,x){const n=g,{pageView:r,cornerView:s,rowView:i,colView:a,dataView:o}=e,d=t;let c;if(x)c=[...fb(d)];else{const l=$x(d,r,!0),u=r[n(787)]>=0?r[n(787)]+1:0,f=s.rowCount,b=s.colCount,h=l.length>0?Fn:0,p=$x({row:d[n(644)]+u+h,col:d[n(458)]},s,!1,!1),I=$x({row:d[n(644)]+u+h+f,col:d[n(458)]},i,!1,!0),v=$x({row:d[n(644)]+u+h,col:d.col+b},a,!1,!0),C=$x({row:d[n(644)]+u+h+f,col:d[n(458)]+b},o,!1,!0);c=[...l,...p,...I,...v,...C]}return c}_initCommandInterceptListener(){const t=g;this[t(416)](this._sheetsPivotTableService[t(724)][t(562)](this._sheetsPivotTableService[t(724)].getInterceptPoints().PIVOT_MUTATION_GENERATE,{handler:(e,x)=>{const n=t,{cellInfo:r,view:s,isEmpty:i}=x,a=r,{unitId:o,subUnitId:d}=a,c=this[n(517)](r,s,i),l=this[n(584)][n(423)]({unitId:o,subUnitId:d,ranges:c}),u=Mo(this[n(236)],o,d,c);u.shouldClear&&(l.redos.push(u[n(682)]),l[n(414)].push(u[n(558)]));const f=this[n(607)](s,r);return l[n(822)][n(223)](...f[n(822)]),l.undos[n(223)](...f[n(414)]),{redos:l[n(822)],undos:l[n(414)]}}}))}[g(607)](t,e){const x=g,{col:n,unitId:r,subUnitId:s}=e,i=[],a=[],o=ax(this[x(221)],{unitId:r,subUnitId:s});if(!e||!t||!o)return{undos:a,redos:i};const d=this[x(701)][x(538)](),{colView:c,dataView:l,cornerView:u,rowView:f,formatMap:b}=t,h=na(c,d,!0,b),p=na(f,d,!1,b),I=hb(l),v=pb(u),{worksheet:C}=o;if(typeof window<"u"&&window[x(617)]){const w=E1({...Ox[x(746)]}),y=Vn[x(220)](h,w)[x(667)]+16,P=Vn[x(220)](I,w).width,E=Math[x(664)](Math[x(230)](y,P))+16,S=Math[x(664)](Vn[x(220)](p,w)[x(667)]),T=Math[x(664)](Vn[x(220)](v,w)[x(667)]),k=Math[x(230)](S,T,40)+12,V=c[x(392)]+u[x(392)],H={},D={};for(let U=n;U<n+V;U++){const j=C[x(219)](U);H[U]=j,U-n<u[x(392)]?D[U-n]=k:D[U-n]=E}i[x(223)]({id:de.id,params:{subUnitId:s,unitId:r,ranges:[{startColumn:n,endColumn:n+V-1,startRow:0,endRow:C[x(408)]()-1}],colWidth:D}}),a.push({id:de.id,params:{subUnitId:s,unitId:r,ranges:[{startColumn:n,endColumn:n+V-1,startRow:0,endRow:C.getRowCount()-1}],colWidth:H}})}return{undos:a,redos:i}}};tn=ah([Yt(0,q(Ye)),Yt(1,q(Vx)),Yt(2,q(N0)),Yt(3,q(Wx)),Yt(4,q(Mx))],tn);Object[g(767)];var oh=(t,e,x,n)=>{const r=g;for(var s=e,i=t[r(347)]-1,a;i>=0;i--)(a=t[i])&&(s=a(s)||s);return s},Xe=(t,e)=>(x,n)=>e(x,n,t);let nn=class extends U0{constructor(e,x,n,r,s,i,a){const o=g;super(),_0(this,"disposableCollection",new Pr),this[o(236)]=e,this[o(809)]=x,this[o(529)]=n,this._univerInstanceService=r,this[o(701)]=s,this[o(520)]=i,this._sheetInterceptorService=a,this[o(212)]()}[g(212)](){const e=g,x=(r,s)=>{const i=Be,a=this[i(221)][i(565)](P0.UNIVER_SHEET);if(!a||!(a!=null&&a[i(771)](s)))return;this[i(784)][i(541)]();const o=c=>this[i(292)](c,r,s),d=this._sheetsPivotTableConfigModel[i(406)](r,s);d!=null&&d.size&&Array.from(d[i(258)]())[i(714)](c=>{const l=i,{row:u,col:f}=c[l(639)];return Gx(u,f)}).forEach(c=>{const l=i;this.disposableCollection[l(532)](this[l(809)].registerRefRange(c,o,r,s))})},n=()=>{const r=Be,s=this[r(221)][r(565)](P0[r(659)]);if(s){const i=s[r(579)]();if(!i)return;x(s[r(552)](),i[r(316)]())}};this[e(416)](this._commandService[e(409)](r=>{const s=e;if(r.id===Ua.id){const i=r[s(324)],a=i[s(310)],o=i[s(786)];if(!a||!o)return;x(o,a)}})),this[e(416)](this[e(701)][e(818)].subscribe(r=>{r&&n()})),this.disposeWithMe(this[e(701)][e(603)][e(553)](r=>{const s=ax(this._univerInstanceService);if(!s)return;const{unitId:i,subUnitId:a}=s,{unitId:o,subUnitId:d}=r;i!==o||a!==d||x(i,a)})),n()}[g(292)](e,x,n){const r=g;switch(e.id){case R1.id:return this.getRefRangeMutationsByMoveRange(e[r(324)],x,n)}return{redos:[],undos:[]}}[g(497)](e,x,n){const r=g,{fromRange:s,toRange:i}=e,a=[],o=[],d=ax(this[r(221)]);if(!d)return{undos:o,redos:a};if(x!==d.unitId||n!==d[r(310)])return{undos:o,redos:a};const c=this._sheetsPivotTableConfigModel[r(406)](x,n);if(c!=null&&c[r(692)])for(const[l,u]of c){const{unitId:f,subUnitId:b,row:h,col:p}=u.targetCellInfo;if(f===d[r(786)]&&b===d.subUnitId){const I=Gx(h,p);if(x0[r(471)](I,s)){const v=h-s[r(799)],C=p-s[r(294)],w={row:i[r(799)]+v,col:i[r(294)]+C};a[r(223)]({id:yn.id,params:{unitId:f,subUnitId:b,pivotTableId:l,targetCellPosition:w}}),o[r(223)]({id:yn.id,params:{unitId:f,subUnitId:b,pivotTableId:l,targetCellPosition:{row:h,col:p}}});const y=w[r(644)]-h,P=w[r(458)]-p,E=[],S=this._sheetsPivotTableAdaptorModel.getPivotItemRenderInfoCache(f,b,l),T=S==null?void 0:S.rangesInfo;if(T){Object[r(808)](T)[r(576)](H=>{const D=r;T[H][D(576)](U=>{const j=D,F={...U};F.startRow=U[j(799)]+y,F[j(606)]=U[j(606)]+y,F.startColumn=U.startColumn+P,F.endColumn=U[j(752)]+P,E.push(F)})});const k=this[r(584)][r(423)]({unitId:f,subUnitId:b,ranges:E});a.push(...k[r(822)]),o.push(...k[r(414)]);const V=Mo(this[r(236)],f,b,E);V.shouldClear&&(a[r(223)](V[r(682)]),o[r(223)](V[r(558)]))}}}}return{redos:a,undos:o}}};nn=oh([Xe(0,q(Vx)),Xe(1,q(Da)),Xe(2,g0),Xe(3,N0),Xe(4,q(Wx)),Xe(5,q(Re)),Xe(6,q(Ye))],nn);function Be(t,e){const x=M2();return Be=function(n,r){return n=n-185,x[n]},Be(t,e)}Object[g(767)];var dh=(t,e,x,n)=>{const r=g;for(var s=e,i=t[r(347)]-1,a;i>=0;i--)(a=t[i])&&(s=a(s)||s);return s},ia=(t,e)=>(x,n)=>e(x,n,t);let sn=class extends U0{constructor(e,x){const n=g;super(),this[n(584)]=e,this[n(701)]=x,this[n(739)]()}[g(739)](){const e=g;this[e(416)](this[e(584)][e(331)]({getMutations:x=>{const n=e;if(x.id===y1.id){const r=[],s=[],i=x[n(324)],{unitId:a,subUnitId:o}=i;if(!a||!o)return{undos:s,redos:r};const d=this[n(701)][n(406)](a,o);if(d!=null&&d[n(692)])for(const[c,l]of d){r.push({id:bs.id,params:{unitId:a,subUnitId:o,pivotTableId:c}});const u={...this[n(701)][n(299)](a,c)};s[n(223)]({id:$n.id,params:{unitId:a,subUnitId:o,pivotTableId:c,pivotTableConfig:l,collectionConfig:u}})}return{redos:r,undos:s}}return{redos:[],undos:[]}}}))}};sn=dh([ia(0,q(Ye)),ia(1,q(Wx))],sn);Object[g(767)];var ch=(t,e,x,n)=>{const r=g;for(var s=e,i=t[r(347)]-1,a;i>=0;i--)(a=t[i])&&(s=a(s)||s);return s},pt=(t,e)=>(x,n)=>e(x,n,t);let rn=class extends U0{constructor(e,x,n,r,s,i){const a=g;super(),this[a(529)]=e,this[a(511)]=x,this[a(520)]=n,this[a(701)]=r,this._univerInstanceService=s,this[a(282)]=i,this._initDataSendListener(),this[a(452)]()}[g(262)](){const e=g;this[e(416)](this[e(529)].onCommandExecuted(x=>{const n=e;if(x.id!==Wr.id)return;const r=x[n(324)];this[n(511)][n(571)](r)})),this[e(416)](this[e(529)][e(409)](x=>{const n=e;if(x.id===Qr.id){const r=x.params;if(r){const{unitId:s,subUnitId:i,oldSubUnitId:a,pivotTableId:o,pivotTableConfig:d,collectionConfig:c}=r;this[n(701)][n(730)](s,a,r.pivotTableId,null),this[n(701)][n(730)](s,i,o,d),this[n(701)][n(826)](s,c)}}})),this[e(416)](this._commandService.onCommandExecuted(x=>{const n=e;if(x.id!==T2.id)return;const r=ax(this[n(221)]);if(!r)return;const{unitId:s,subUnitId:i}=r,a=x[n(324)];if(a[n(259)]&&Object[n(808)](a[n(259)])[n(576)](o=>{const d=n;var c;(c=a[d(259)])!=null&&c[o]&&this._sheetsPivotTableConfigModel[d(826)](o,a[d(259)][o])}),a.single){const o=a.single,{unitId:d,subUnitId:c,view:l,pivotTableId:u,type:f,pivotConfig:b}=o;if(f===X0.Delete)this._sheetsPivotTableAdaptorModel[n(447)]({unitId:d,subUnitId:c,pivotTableId:u,type:f}),this[n(701)][n(730)](d,c,u,null);else{const h=new Xx;h[n(455)](l),this[n(701)].updateConfigCache(d,c,u,b),this[n(520)].clearRenderCache({unitId:d,subUnitId:c,pivotTableId:u,type:f,view:h}),this[n(520)].updateRenderCache({unitId:d,subUnitId:c,view:h,pivotTableId:u,type:f})}}else a[n(429)]&&(a.batch[n(576)](o=>{const d=n,{unitId:c,subUnitId:l,view:u,pivotTableId:f,type:b,pivotConfig:h}=o,p=new Xx;p[d(455)](u),this._sheetsPivotTableConfigModel[d(730)](c,l,f,h),this[d(520)][d(333)]({unitId:c,subUnitId:l,view:p,pivotTableId:f,type:b})}),this._sheetsPivotTableConfigModel.setPivotInitCompleted());this[n(520)][n(214)](s,i)}))}[g(452)](){const e=g;this._activeDirtyManagerService[e(375)](U2.id,{commandId:U2.id,getDirtyData(x){return{dirtyUnitFeatureMap:x.params}}})}};rn=ch([pt(0,q(g0)),pt(1,q(px)),pt(2,q(Re)),pt(3,q(Wx)),pt(4,q(N0)),pt(5,N1)],rn);var lh=Object[g(755)],uh=(t,e,x)=>e in t?lh(t,e,{enumerable:!0,configurable:!0,writable:!0,value:x}):t[e]=x,fh=(t,e,x,n)=>{const r=g;for(var s=e,i=t[r(347)]-1,a;i>=0;i--)(a=t[i])&&(s=a(s)||s);return s},zn=(t,e)=>(x,n)=>e(x,n,t),aa=(t,e,x)=>uh(t,typeof e!=g(804)?e+"":e,x);let Jn=class extends kt{constructor(e=sa,x,n,r,s){const i=g;super(),this[i(792)]=e,this._injector=x,this[i(529)]=n,this[i(672)]=r,this[i(828)]=s;const{...a}=Rn({},sa,this[i(792)]);this[i(672)][i(352)](Uo,a),this[i(453)](),this[i(698)]()}[g(698)](){const e=g;var x;const n=(x=this[e(792)])==null?void 0:x[e(595)];this[e(672)][e(352)](fx,n===!0)}[g(578)](){const e=g;var x;let n=[];const r=(x=this[e(792)])==null?void 0:x.notExecuteFormula;r===!0?n=[[Mx],[px],[rn],[Re],[Wx],[sn],[en],[nn],[tn]]:r===!1?n=[[tx],[xn]]:r===void 0&&(n=[[tx],[xn],[Mx],[px],[rn],[Re],[Wx],[sn],[en],[nn],[tn]]),n[e(576)](s=>this[e(236)].add(s)),[xn,rn,Mx,en,sn,nn,tn][e(576)](s=>{const i=e;this[i(236)][i(361)](s)&&this._injector.get(s)})}[g(453)](){const e=g;[Vb,jb,$b,Lb,Gb,xh,qb,Wb,Jb,zb,Kb,Zb,Hb,Bb,$n,hr,bs,nr,ko,Do,or,sr,rr,ir,cr,dr,yn,Yr,Wr,T2,fr,br,lr,ar,zr,pr,mr,U2,Qr,Xb,ur,Qb,Yb][e(576)](x=>{const n=e;var r;(r=this[n(828)])==null||r[n(393)](x),this[n(529)].registerCommand(x)})}};aa(Jn,"pluginName",Gr),aa(Jn,g(635),P0.UNIVER_SHEET),Jn=fh([X2(gn),zn(1,q(Vx)),zn(2,q(g0)),zn(3,W0),zn(4,d1(S1))],Jn);const B=ot;(function(t,e){const x=ot,n=t();for(;;)try{if(parseInt(x(595))/1*(-parseInt(x(529))/2)+-parseInt(x(496))/3+parseInt(x(540))/4+parseInt(x(576))/5+-parseInt(x(650))/6+parseInt(x(628))/7*(parseInt(x(498))/8)+-parseInt(x(495))/9*(-parseInt(x(582))/10)===e)break;n.push(n.shift())}catch{n.push(n.shift())}})($2,860588);var mh=Object[B(606)],bh=(t,e,x)=>e in t?mh(t,e,{enumerable:!0,configurable:!0,writable:!0,value:x}):t[e]=x,Qt=(t,e,x)=>bh(t,typeof e!=B(509)?e+"":e,x);function Oo(t,e){const x=B,n=new K,r=[],s=t.length>1;let i=0,a=0;for(const o of t)i+=o[x(497)]-o[x(639)]+1,a+=o[x(537)]-o[x(504)]+1;for(const o of e)for(let d=o[x(639)];d<=o[x(497)];d++)for(let c=o[x(504)];c<=o[x(537)];c++)r.push({row:d,column:c});if(r[x(563)]===i)s?r[x(618)]((o,d)=>{const c=x,l=t[d],u={startRow:l.startRow,startColumn:l.startColumn,endRow:l[c(639)],endColumn:l.endColumn};n[c(554)](o[c(644)],o[c(546)],u)}):r[x(618)]((o,d)=>{const c=x,l=t[0],u={startRow:l[c(639)]+d,startColumn:l[c(504)],endRow:l.startRow+d,endColumn:l[c(537)]};n[c(554)](o[c(644)],o.column,u)});else if(r[x(563)]===a)s?r[x(618)]((o,d)=>{const c=x,l=t[d],u={startRow:l[c(639)],startColumn:l.startColumn,endRow:l[c(497)],endColumn:l.startColumn};n[c(554)](o.row,o[c(546)],u)}):r[x(618)]((o,d)=>{const c=x,l=t[0],u={startRow:l.startRow,startColumn:l[c(504)]+d,endRow:l[c(497)],endColumn:l[c(504)]+d};n[c(554)](o[c(644)],o[c(546)],u)});else if(r[x(563)]===t.length)t[x(479)](o=>!(o.startRow!==o[x(497)]&&o[x(504)]!==o[x(537)]))&&r.forEach((o,d)=>{const c=x,l=t[d];n[c(554)](o[c(644)],o[c(546)],l)});else throw new Error(x(636));return n}const hs=B(471),Zx={standard:["rgb(54,78,244)",B(523)],specialty:[B(552),B(518)],distinctive:["rgb(124,66,147)","rgb(252,117,60)"],soft:["rgb(80,102,248)",B(598)],fresh:[B(481),B(584)]},hh=[B(485),B(604),B(512),B(565),"negativePoint",B(472)];var Ae=(t=>(t[B(569)]="standard",t.SPECIALTY=B(525),t[B(506)]="distinctive",t[B(611)]="soft",t[B(621)]=B(596),t[B(627)]=B(555),t))(Ae||{}),cx=(t=>(t[t[B(562)]=1]=B(562),t[t[B(492)]=2]=B(492),t[t[B(642)]=3]=B(642),t[t[B(573)]=4]="PIE_CHART",t))(cx||{}),Tx=(t=>(t.SPACING=B(530),t[B(602)]="zero_value",t[B(528)]=B(559),t))(Tx||{}),lx=(t=>(t[t.SELF_EXTREMUM=1]=B(632),t[t[B(543)]=2]=B(543),t[t[B(581)]=3]=B(581),t))(lx||{});Object[B(633)];var ph=(t,e,x,n)=>{const r=B;for(var s=e,i=t[r(563)]-1,a;i>=0;i--)(a=t[i])&&(s=a(s)||s);return s},_h=(t,e)=>(x,n)=>e(x,n,t);let K0=class extends U0{constructor(e){const x=B;super(),Qt(this,x(624),new Map),Qt(this,x(578),new Map),Qt(this,x(470),new Pe),Qt(this,x(494),this[x(470)][x(500)]()),this[x(635)]=e}[B(640)](e,x){const n=B;let r=this._sparklineModel[n(599)](e);r||(r=new Map,this[n(624)][n(533)](e,r));let s=r.get(x);return s||(s=new Map,r[n(533)](x,s)),s}_ensureAnchorMatrix(e,x){const n=B;let r=this[n(578)][n(599)](e);r||(r=new Map,this[n(578)][n(533)](e,r));let s=r.get(x);return s||(s={matrix:new K,extra:{}},r[n(533)](x,s)),s}[B(590)](e,x,n,r=B(533)){const s=B;var i,a,o,d,c,l,u,f,b,h,p,I,v;const C=(a=(i=this._sparklineModel.get(e))==null?void 0:i[s(599)](x))==null?void 0:a[s(599)](n);if(!C)return;const w=ax(this[s(635)],{unitId:e,subUnitId:x});if(!w)return;const y=this._ensureAnchorMatrix(e,x),{extra:P,matrix:E}=y,{worksheet:S}=w;let T=Number[s(550)],k=Number[s(646)];const V=(o=C[s(560)][s(548)])!=null?o:!1;C[s(623)].forValue((G,Y,t0)=>{const A=s;var Z,J,S0;const I0=t0;let l0=Number[A(550)],T0=Number[A(646)],L0=0,Q0=0;const n0=[];if(!Jt(I0))E.setValue(G,Y,{groupId:n,data:[],max:l0,min:T0,highIndex:L0,lowIndex:Q0,negativeIndexes:n0});else{const O=[];for(let W=I0[A(639)];W<=I0[A(497)];W++){for(let o0=I0.startColumn;o0<=I0[A(537)];o0++){const r0=S[A(476)](W),m0=S.getColVisible(o0);if(!V&&(!r0||!m0))continue;let a0=0;const f0=((Z=S.getCellRaw(W,o0))==null?void 0:Z.v)!==void 0?S[A(616)](W,o0):S[A(653)](W,o0);if(!f0||f0.v===void 0||f0.v===null){const w0=(J=C[A(560)][A(615)])!=null?J:Tx[A(488)];w0===Tx[A(602)]?a0=0:w0===Tx[A(488)]?a0=A(491):w0===Tx[A(528)]&&(a0=A(477))}else if(f0.t===zx[A(588)]||f0.t===zx.FORCE_STRING){const w0=(S0=C[A(560)][A(575)])!=null?S0:Tx.SPACING;w0===Tx[A(602)]?a0=0:w0===Tx[A(488)]?a0=A(491):w0===Tx[A(528)]&&(a0=A(477))}else f0.t===zx[A(607)]?a0=f0.v?1:0:f0.t===zx[A(645)]?a0=Number(f0.v):a0=f0.v;if(O[A(655)](a0),typeof a0=="number"){l0=Math[A(527)](l0,a0),T=Math[A(527)](T,a0),k=Math.min(k,a0),T0=Math[A(600)](T0,a0);const w0=typeof O[L0]==A(513)?Number(O[L0]):Number[A(550)];a0>w0&&(L0=O[A(563)]-1);const Nx=typeof O[Q0]=="number"?Number(O[Q0]):Number[A(646)];a0<Nx&&(Q0=O[A(563)]-1),a0<0&&n0[A(655)](O.length-1)}}E.setValue(G,Y,{groupId:n,data:O,max:l0,min:T0,highIndex:L0,lowIndex:Q0,negativeIndexes:n0})}}});let H=T;((d=C.config[s(567)])==null?void 0:d[s(541)])===lx[s(581)]&&(H=(l=(c=C.config[s(567)])==null?void 0:c[s(482)])!=null?l:T);let D=k;((u=C[s(560)][s(542)])==null?void 0:u[s(541)])===lx.CUSTOM_EXTREMUM&&(D=(b=(f=C[s(560)][s(542)])==null?void 0:f[s(482)])!=null?b:k);const U=(h=C[s(560)][s(612)])!=null?h:Ae[s(569)],j=(v=(I=C.config[s(601)])!=null?I:(p=Zx[U])==null?void 0:p[0])!=null?v:Zx[s(535)][0],F=new Vs(j),z=F[s(580)](.2)[s(652)](),Q=F[s(580)](.05)[s(652)]();P[n]={groupMax:T,groupMin:k,showMax:H,showMin:D,startGradient:z,endGradient:Q},this._updateConfig$.next({unitId:e,subUnitId:x,groupId:n,config:C,type:r})}[B(511)](e,x,n,r){const s=B;this[s(640)](e,x)[s(533)](n,r),this.updateSparklineExtraNum(e,x,n,"add")}setSparkline(e,x,n,r){const s=B;var i;const a=(i=this[s(624)][s(599)](e))==null?void 0:i.get(x);n[s(618)](o=>{const d=s;a!=null&&a[d(489)](o)&&(a.set(o,r),this[d(590)](e,x,o))})}[B(484)](e,x,n){const r=B;var s,i;const a=this[r(624)][r(599)](e);if(a){const o=a[r(599)](x);if(o){o.delete(n);const d=(s=this[r(578)][r(599)](e))==null?void 0:s[r(599)](x);(i=d==null?void 0:d.matrix)==null||i[r(510)]((c,l,u)=>{const f=r;(u==null?void 0:u[f(551)])===n&&(d==null||d[f(637)][f(610)](c,l))}),this[r(470)][r(589)]({unitId:e,subUnitId:x,groupId:n,type:r(556)})}}}removePartSparkline(e,x,n,r){const s=B;var i,a,o,d;const c=(i=this[s(578)][s(599)](e))==null?void 0:i[s(599)](x),l=c==null?void 0:c[s(637)][s(643)](n,r);if(l){const{groupId:u}=l,f=(a=this[s(624)][s(599)](e))==null?void 0:a[s(599)](x);(o=f==null?void 0:f.get(u))==null||o[s(623)][s(610)](n,r),(d=f==null?void 0:f.get(u))!=null&&d.sparklines.hasValue()||f==null||f[s(480)](u),c==null||c.matrix[s(610)](n,r),this[s(470)].next({unitId:e,subUnitId:x,groupId:u,type:s(556)})}}[B(631)](e,x,n){const r=B;var s,i,a,o;const d=(a=(i=(s=this[r(624)][r(599)](e))==null?void 0:s[r(599)](x))==null?void 0:i[r(599)](n))==null?void 0:a[r(623)],c=(o=this._sparklineAnchorMap[r(599)](e))==null?void 0:o[r(599)](x);if(d&&c){const{matrix:l,extra:u}=c;d[r(510)]((f,b,h)=>{l[r(610)](f,b)}),delete u[n]}}getSubUnitSparkline(e,x){const n=B;var r;return(r=this._sparklineModel[n(599)](e))==null?void 0:r[n(599)](x)}[B(561)](e,x,n){const r=B;var s,i;return(i=(s=this[r(624)][r(599)](e))==null?void 0:s[r(599)](x))==null?void 0:i.get(n)}[B(519)](e,x,n,r){const s=B;var i,a,o;return(o=(a=(i=this[s(578)].get(e))==null?void 0:i[s(599)](x))==null?void 0:a[s(637)].getValue(n,r))==null?void 0:o[s(551)]}[B(538)](e,x){const n=B;var r;const s=this[n(609)](e,x);s[n(637)].forValue((a,o)=>{const d=n;s[d(637)][d(610)](a,o)});const i=(r=this[n(624)][n(599)](e))==null?void 0:r.get(x);if(i)for(const[a]of i)this[n(590)](e,x,a)}getSparklineCache(){const e=B;return{sparklineModel:this._sparklineModel,sparklineAnchorMap:this[e(578)]}}[B(656)](e){const x=B,n={};if(this[x(624)][x(489)](e)){n[e]={};const r=this[x(624)][x(599)](e);r!=null&&r[x(566)]&&Array.from(r.keys())[x(618)](s=>{const i=x;n[e][s]={};const a=r[i(599)](s);a!=null&&a.size&&Array.from(a.keys())[i(618)](o=>{const d=i,c=a[d(599)](o);c&&(n[e][s][o]={config:c[d(560)],sparklines:c[d(623)][d(626)]()})})})}return n}[B(651)](e){const x=B;e&&Object[x(585)](e)[x(618)](n=>{const r=x,s=e[n];s&&Object[r(585)](s).forEach(i=>{const a=r,o=s[i];o&&Object[a(585)](o)[a(618)](d=>{const c=a,l=o[d];if(l){const u={config:l.config,sparklines:new K(l[c(623)])};this.addSparkline(n,i,d,u)}})})})}[B(614)](e){const x=B,n=this[x(624)][x(599)](e);if(n){for(const[r]of n){const s=n[x(599)](r);if(s)for(const[i]of s)this[x(631)](e,r,i)}this[x(624)][x(480)](e)}}};K0=ph([_h(0,q(N0))],K0);const k0={id:B(544),type:c0[B(625)],handler:(t,e)=>{const x=B;if(!e)return!1;const{sparklineConfigMap:n,unitId:r,subUnitId:s}=e,i=t[x(599)](K0);return Object.entries(n)[x(618)](([a,o])=>{const d=x,c={config:o[d(560)],sparklines:new K(o[d(623)])};i.addSparkline(r,s,a,c)}),!0}},D0={id:B(564),type:c0.MUTATION,handler:(t,e)=>{const x=B;if(!e)return!1;const{unitId:n,subUnitId:r,ranges:s,isSingle:i,groupIds:a}=e,o=t[x(599)](K0);return a?(a.forEach(d=>{o.removeSparkline(n,r,d)}),!0):s?(s[x(618)](d=>{const c=x;Rx[c(574)](d,(l,u)=>{const f=c,b=o[f(519)](n,r,l,u);b&&(i?o[f(630)](n,r,l,u):o[f(484)](n,r,b))})}),!0):!1}},qr={id:B(547),type:c0.COMMAND,handler:(t,e)=>{const x=B;if(!e)return!1;const{sourceRanges:n,targetRanges:r,config:s}=e,i=t[x(599)](vx),a="g_"+Ve(6),o=Oo(n,r),d={config:s??{},sparklines:o[x(626)]()},c=t[x(599)](N0),l=t[x(599)](K0),u=ax(c);if(!u)return!1;const{unitId:f,subUnitId:b}=u,h=t.get(g0),p=[],I=[],v={},C={},w=new Set([a]);o.forValue((P,E,S)=>{const T=x,k=l[T(519)](f,b,P,E);if(k){const V=l[T(561)](f,b,k);if(V){w.add(k);let H=v[k],D=C[k];D||(D={config:R[T(507)](V[T(560)]),sparklines:new K(V[T(623)][T(508)]())},C[k]=D),H||(H={config:R[T(507)](V[T(560)]),sparklines:V.sparklines[T(508)]()},v[k]=H),D[T(623)][T(610)](P,E)}}});const y={};return Object[x(591)](C)[x(618)](([P,E])=>{const S=x;E[S(623)].getSizeOf()&&(y[P]={config:E[S(560)],sparklines:E[S(623)][S(508)]()})}),y[a]=d,p[x(655)]({id:D0.id,params:{unitId:f,subUnitId:b,groupIds:Array[x(524)](w),isSingle:!1}}),w.size>1&&(I[x(655)]({id:D0.id,params:{unitId:f,subUnitId:b,groupIds:Array[x(524)](w),isSingle:!1}}),p[x(655)]({id:k0.id,params:{unitId:f,subUnitId:b,sparklineConfigMap:v}})),I.push({id:k0.id,params:{unitId:f,subUnitId:b,sparklineConfigMap:y}}),ox(I,h),i[x(597)]({unitID:f,undoMutations:p,redoMutations:I}),!0}},nt={id:B(473),type:c0[B(608)],handler:(t,e)=>{const x=B;var n;const{isSingle:r=!0}=e||{},s=t[x(599)](g0),i=t.get(N0),a=t[x(599)](K0),o=t[x(599)](vx),d=ax(i);if(!d)return!1;const c=t[x(599)](Se),l=(n=e==null?void 0:e[x(501)])!=null?n:c.getCurrentSelections().map(v=>v[x(517)]),{unitId:u,subUnitId:f}=d,b=[],h=[];b[x(655)]({id:D0.id,params:{unitId:u,subUnitId:f,ranges:l,isSingle:r}});const p=[],I={};return l[x(618)](v=>{const C=x;Rx[C(574)](v,(w,y)=>{const P=C,E=a[P(519)](u,f,w,y);if(E){const S=a.getSparklineById(u,f,E);S&&(p[P(655)](E),I[E]={config:R[P(507)](S[P(560)]),sparklines:R[P(507)](S.sparklines[P(508)]())})}})}),h[x(655)]({id:D0.id,params:{unitId:u,subUnitId:f,groupIds:p,isSingle:!1}}),h[x(655)]({id:k0.id,params:{unitId:u,subUnitId:f,sparklineConfigMap:I}}),ox(b,s),o.pushUndoRedo({unitID:u,undoMutations:h,redoMutations:b}),!0}},Kr={id:"sheet.mutation.set-sparkline",type:c0[B(625)],handler:(t,e)=>{const x=B;if(!e)return!1;const{unitId:n,subUnitId:r,groupIds:s,config:i}=e,a=t[x(599)](K0);return s.forEach(o=>{const d=x,c=a[d(561)](n,r,o);if(c){const l={config:Object[d(515)]({},c.config,i[d(560)]),sparklines:new K(c[d(623)][d(508)]())};a[d(586)](n,r,[o],l)}}),!0}},_x={id:B(592),type:c0.COMMAND,handler:(t,e)=>{const x=B;var n,r,s,i;if(!e)return!1;const a=t[x(599)](g0),o=t.get(Se),d=t[x(599)](K0),c=t[x(599)](N0),l=t[x(599)](vx),u=ax(c);if(!u)return!1;const{unitId:f,subUnitId:b}=u,h=(n=e==null?void 0:e.ranges)!=null?n:o.getCurrentSelections().map(y=>y[x(517)]),p=(r=d[x(493)]()[x(634)].get(f))==null?void 0:r[x(599)](b),{isChangeDataSource:I,config:v,combine:C,unCombine:w}=e;if(C){const y=[],P=[];y[x(655)]({id:D0.id,params:{unitId:f,subUnitId:b,ranges:h,isSingle:!0}});const E="g_"+Ve(6),S=new K,T=(s=d[x(493)]()[x(568)].get(f))==null?void 0:s.get(b),k=new Set([E]),V={};return h.forEach(H=>{const D=x;var U,j;const{startRow:F,endRow:z,startColumn:Q,endColumn:G}=H;for(let Y=F;Y<=z;Y++)for(let t0=Q;t0<=G;t0++){const A=(U=p==null?void 0:p.matrix[D(643)](Y,t0))==null?void 0:U[D(551)];if(A){k[D(617)](A);const Z=d[D(561)](f,b,A);Z&&(V[A]={config:R[D(507)](Z[D(560)]),sparklines:R[D(507)](Z.sparklines[D(508)]())});const J=(j=T==null?void 0:T[D(599)](A))==null?void 0:j[D(623)][D(643)](Y,t0);J&&S[D(554)](Y,t0,J)}}}),y.push({id:k0.id,params:{sparklineConfigMap:{[E]:{config:R[x(507)](v.config),sparklines:S[x(626)]()}},unitId:f,subUnitId:b}}),P[x(655)]({id:D0.id,params:{unitId:f,subUnitId:b,isSingle:!1,groupIds:Array.from(k)}}),P[x(655)]({id:k0.id,params:{unitId:f,subUnitId:b,sparklineConfigMap:V}}),ox(y,a),l[x(597)]({unitID:f,undoMutations:P,redoMutations:y}),!0}else if(w){const y=[],P=[];y[x(655)]({id:D0.id,params:{unitId:f,subUnitId:b,ranges:h,isSingle:!0}});const E=(i=d[x(493)]()[x(568)].get(f))==null?void 0:i[x(599)](b),S={},T=new Set,k={};return h[x(618)](V=>{const H=x;var D,U;const{startRow:j,endRow:F,startColumn:z,endColumn:Q}=V;for(let G=j;G<=F;G++)for(let Y=z;Y<=Q;Y++){const t0=(D=p==null?void 0:p.matrix[H(643)](G,Y))==null?void 0:D[H(551)];if(t0){const A=new K,Z="g_"+Ve(6);T[H(617)](t0),T.add(Z);const J=d[H(561)](f,b,t0);J&&(k[t0]={config:R.deepClone(J.config),sparklines:R[H(507)](J[H(623)].clone())});const S0=(U=E==null?void 0:E.get(t0))==null?void 0:U[H(623)][H(643)](G,Y);S0&&A.setValue(G,Y,S0),S[Z]={sparklines:A[H(626)](),config:R[H(507)](v[H(560)])}}}}),y[x(655)]({id:k0.id,params:{unitId:f,subUnitId:b,sparklineConfigMap:S}}),P.push({id:D0.id,params:{unitId:f,subUnitId:b,isSingle:!1,groupIds:Array[x(524)](T)}}),P[x(655)]({id:k0.id,params:{unitId:f,subUnitId:b,sparklineConfigMap:k}}),ox(y,a),l[x(597)]({unitID:f,undoMutations:P,redoMutations:y}),!0}if(I){const y=e[x(648)];if(!y)return!1;const{groupId:P,sourceRanges:E,targetRanges:S,resetType:T,primary:k}=y,V=[],H=[];V[x(655)]({id:D0.id,params:{unitId:f,subUnitId:b,ranges:h,isSingle:!1,groupIds:[P]}}),H[x(655)]({id:D0.id,params:{unitId:f,subUnitId:b,ranges:h,isSingle:!1,groupIds:[P]}});let D;T==="item"?(D=new K(v[x(623)][x(508)]()),D[x(610)](k[x(619)],k.actualColumn),D[x(554)](S[0][x(639)],S[0].startColumn,E[0])):D=Oo(E,S);const U={config:R.deepClone(v.config),sparklines:D[x(626)]()},j={config:R[x(507)](v.config),sparklines:R[x(507)](v[x(623)][x(508)]())};V.push({id:k0.id,params:{unitId:f,subUnitId:b,sparklineConfigMap:{[P]:U}}}),H[x(655)]({id:k0.id,params:{unitId:f,subUnitId:b,sparklineConfigMap:{[P]:j}}}),ox(V,a),l[x(597)]({unitID:f,undoMutations:H,redoMutations:V})}else{const y=[],P=[],E=new Set,S={};h[x(618)](T=>{const k=x;var V;const{startRow:H,endRow:D,startColumn:U,endColumn:j}=T;for(let F=H;F<=D;F++)for(let z=U;z<=j;z++){const Q=(V=p==null?void 0:p.matrix[k(643)](F,z))==null?void 0:V[k(551)];if(Q){E[k(617)](Q);const G=d.getSparklineById(f,b,Q);G&&(S[Q]={config:R[k(507)](G.config),sparklines:R.deepClone(G[k(623)][k(508)]())})}}}),P[x(655)]({id:Kr.id,params:{unitId:f,subUnitId:b,groupIds:Array[x(524)](E),config:{config:R[x(507)](v[x(560)]),sparklines:v.sparklines[x(626)]()}}}),y[x(655)]({id:D0.id,params:{unitId:f,subUnitId:b,isSingle:!1,groupIds:Array[x(524)](E)}}),y[x(655)]({id:k0.id,params:{unitId:f,subUnitId:b,sparklineConfigMap:S}}),ox(P,a),l[x(597)]({unitID:f,undoMutations:y,redoMutations:P})}return!0}};Object[B(633)];var Ih=(t,e,x,n)=>{for(var r=e,s=t.length-1,i;s>=0;s--)(i=t[s])&&(r=i(r)||r);return r},Xn=(t,e)=>(x,n)=>e(x,n,t);let k2=class extends U0{constructor(t,e,x,n){const r=B;super(),this[r(475)]=t,this[r(534)]=e,this._univerInstanceService=x,this[r(503)]=n,this[r(603)]()}[B(603)](){const t=B;this[t(536)](this[t(534)][t(474)]({getMutations:e=>{const x=t,n=[],r=[];if(e.id===Na.id){const s=ax(this[x(635)]);if(!s)return{redos:n,undos:r};const{unitId:i,subUnitId:a,worksheet:o}=s,d=this._sheetSelectionService[x(641)]().map(f=>f.range),c=new Set,l={},u={};d[x(618)](f=>{const b=x;Rx[b(574)](f,(h,p)=>{const I=b,v=this[I(475)].getSparkline(i,a,h,p);if(v&&!c.has(v)){const C=this[I(475)][I(561)](i,a,v);C&&(c[I(617)](v),l[v]={config:R[I(507)](C[I(560)]),sparklines:R[I(507)](C.sparklines.clone())},u[v]={config:R.deepClone(C.config),sparklines:R[I(507)](C[I(623)][I(508)]())})}})}),Object.values(u)[x(618)](f=>{const b=x,h=f[b(623)];new K(h)[b(510)]((p,I,v)=>{const C=b;d.some(w=>x0[C(558)](w,Gx(p,I)))&&delete h[p][I]})}),n[x(655)]({id:D0.id,params:{unitId:i,subUnitId:a,groupIds:Array[x(524)](c),isSingle:!1}}),n[x(655)]({id:k0.id,params:{unitId:i,subUnitId:a,sparklineConfigMap:u}}),r.push({id:D0.id,params:{unitId:i,subUnitId:a,groupIds:Array[x(524)](c),isSingle:!1}}),r[x(655)]({id:k0.id,params:{unitId:i,subUnitId:a,sparklineConfigMap:l}})}return{redos:n,undos:r}}}))}};k2=Ih([Xn(0,q(K0)),Xn(1,q(Ye)),Xn(2,q(N0)),Xn(3,q(Se))],k2);Object[B(633)];var gh=(t,e,x,n)=>{const r=B;for(var s=e,i=t[r(563)]-1,a;i>=0;i--)(a=t[i])&&(s=a(s)||s);return s},oa=(t,e)=>(x,n)=>e(x,n,t);let D2=class extends U0{constructor(t,e){const x=B;super(),this[x(534)]=t,this._sparklineDataSourceModel=e,this[x(620)]()}_initCopySheetWithSparkline(){const t=B;this[t(536)](this[t(534)][t(474)]({getMutations:e=>{const x=t,n=[],r=[];if(e.id===D1.id){const s=e.params;if(!s)return{redos:n,undos:r};const{unitId:i,subUnitId:a,targetSubUnitId:o}=s;if(!i||!a||!o)return{redos:n,undos:r};const d=new Set,c={},l=this._sparklineDataSourceModel[x(647)](i,a);if(!l)return{redos:n,undos:r};for(const[u,f]of l){const b="g_"+Ve(6);d.add(u),c[b]={config:R.deepClone(f.config),sparklines:R[x(507)](f[x(623)].clone())}}d[x(566)]&&(r.push({id:D0.id,params:{unitId:i,subUnitId:o,groupIds:Array.from(d),isSingle:!1}}),n[x(655)]({id:k0.id,params:{unitId:i,subUnitId:o,sparklineConfigMap:c}}))}return{redos:n,undos:r}}}))}};D2=gh([oa(0,q(Ye)),oa(1,q(K0))],D2);var vh=(t,e,x,n)=>{const r=B;for(var s=e,i=t[r(563)]-1,a;i>=0;i--)(a=t[i])&&(s=a(s)||s);return s},Us=(t,e)=>(x,n)=>e(x,n,t);let O2=class extends U0{constructor(t,e,x){const n=B;super(),this._commandService=t,this._sparklineDataSourceModel=e,this[n(486)]=x,this._initDataChangeListener(),this._initExclusiveRangeChange()}[B(571)](){const t=B;this[t(536)](this._commandService[t(553)](e=>{const x=t;if(e.id===H0.id){const n=e[x(654)],{cellValue:r,unitId:s,subUnitId:i}=n,a=new K(r),o=new Set,d=this._sparklineDataSourceModel[x(647)](s,i);if(!d)return;const c=Array[x(524)](d);a[x(510)]((l,u,f)=>{const b=x,h=Gx(l,u);for(let p=0;p<c[b(563)];p++){const[I,v]=c[p],C=o.has(I);C||v.sparklines[b(510)]((w,y,P)=>{const E=b,S=P;if(S&&!C&&x0.intersects(h,S))return o[E(617)](I),!0})}}),o[x(618)](l=>{const u=x;this[u(475)][u(631)](s,i,l),this[u(475)][u(590)](s,i,l)})}else if(e.id===Hx.id){const n=e[x(654)],{range:r,unitId:s,subUnitId:i}=n,a=new Set,o=this[x(475)][x(647)](s,i);if(!o)return;const d=Array[x(524)](o);for(let c=0;c<d[x(563)];c++){const[l,u]=d[c],f=a[x(489)](l);f||u[x(623)][x(510)]((b,h,p)=>{const I=x,v=p;if(v&&!f&&x0[I(558)](r,v))return a[I(617)](l),!0})}a[x(618)](c=>{const l=x;this[l(475)][l(631)](s,i,c),this[l(475)][l(590)](s,i,c)})}}))}_initExclusiveRangeChange(){const t=B;this[t(536)](this[t(486)][t(605)].subscribe(e=>{const x=t,{unitId:n,subUnitId:r,ranges:s}=e,i=this[x(475)][x(647)](n,r);if(!i)return;const a=Array.from(i),o=new Set;for(let d=0;d<a.length;d++){const[c,l]=a[d],u=o[x(489)](c);u||l[x(623)].forValue((f,b,h)=>{const p=x,I=h;if(I&&!u){for(const v of s)if(x0[p(558)](v,I)){o[p(617)](c);break}}})}o[x(618)](d=>{const c=x;this[c(475)].clearSparklineCache(n,r,d),this._sparklineDataSourceModel[c(590)](n,r,d)})}))}};O2=vh([Us(0,q(g0)),Us(1,q(K0)),Us(2,q(ka))],O2);var Ch=(t,e,x,n)=>{const r=B;for(var s=e,i=t[r(563)]-1,a;i>=0;i--)(a=t[i])&&(s=a(s)||s);return s},da=(t,e)=>(x,n)=>e(x,n,t);let F2=class extends U0{constructor(t,e){const x=B;super(),this[x(514)]=t,this[x(475)]=e,this[x(583)]()}[B(583)](){this._commandService.onCommandExecuted(t=>{const e=ot;if(t.id===xs.id||t.id===K2.id||t.id===es.id||t.id===Z2.id){const x=t[e(654)],{ranges:n,unitId:r,subUnitId:s}=x,i=new Set,a=this._sparklineDataSourceModel[e(647)](r,s);if(!a)return;const o=Array[e(524)](a);n[e(618)](d=>{const c=e;Rx[c(574)](d,(l,u)=>{const f=c,b=Gx(l,u);for(let h=0;h<o.length;h++){const[p,I]=o[h],v=i[f(489)](p);v||I[f(623)][f(510)]((C,w,y)=>{const P=f,E=y;if(E&&!v&&x0[P(558)](b,E))return i.add(p),!0})}})}),i[e(618)](d=>{const c=e;this[c(475)][c(631)](r,s,d),this[c(475)][c(590)](r,s,d)})}})}};F2=Ch([da(0,q(g0)),da(1,q(K0))],F2);function $2(){const t=["clearSparklineCache","SELF_EXTREMUM","getOwnPropertyDescriptor","sparklineAnchorMap","_univerInstanceService","Mismatch between the number of target cells and the source range dimensions.","matrix","_getRefRangeMutationsByDeleteCols","startRow","_ensureConfigMap","getCurrentSelections","PROFIT_AND_LOSS_CHART","getValue","row","NUMBER","MAX_SAFE_INTEGER","getSubUnitSparkline","changeDataSourceInfo","moveColumns","5102244XXCpfD","fromJSON","toRgbString","getCell","params","push","toJSON","removeRows","_updateConfig$","SHEET_SPARKLINE_PLUGIN","markersPoint","sheet.command.remove-sparkline","interceptCommand","_sparklineDataSourceModel","getRowVisible","u-connect","dispose","every","delete","rgb(46,187,122)","value","_getRefRangeMutationsByDeleteRows","removeSparkline","highPoint","_exclusiveRangeService","registerPluginResource","SPACING","has","_initSnapshot","u-spacing","BAR_CHART","getSparklineCache","updateConfig$","45KqsXcO","3805428rBxZup","endRow","8yVjdZn","_initDependencies","asObservable","ranges","UNIVER_SHEET","_sheetSelectionService","startColumn","_resourceManagerService","DISTINCTIVE","deepClone","clone","symbol","forValue","addSparkline","lastPoint","number","_commandService","assign","_initRegisterCommand","range","rgb(30,177,189)","getSparkline","registerRefRange","_initCorrectRangeWithSparkline","_config","rgb(236,100,169)","from","specialty","getCurrentUnitForType","max","CONNECT_WITH_LINE","4cfEMfd","spacing","refRangeHandle","subUnitId","set","_sheetInterceptorService","standard","disposeWithMe","endColumn","reBuildAnchorCache","pluginName","4641412GCFtJx","type","extremumMin","GROUP_EXTREMUM","sheet.mutation.add-sparkline","NORMAL","column","sheet.command.add-sparkline","containHiddenCells","getSizeOf","MIN_SAFE_INTEGER","groupId","rgb(49,106,246)","onCommandExecuted","setValue","custom","remove","stringify","intersects","connect_with_line","config","getSparklineById","LINE_CHART","length","sheet.mutation.remove-sparkline","lowPoint","size","extremumMax","sparklineModel","STANDARD","contains","_initDataChangeListener","getSheetBySheetId","PIE_CHART","foreach","nonNumShowAs","1277290eNHApf","_onRefRangeChange","_sparklineAnchorMap","disposableCollection","setAlpha","CUSTOM_EXTREMUM","2622650tIbkeY","_initHideRowColWithSparkline","rgb(248,190,21)","keys","setSparkline","_refRangeService","STRING","next","updateSparklineExtraNum","entries","sheet.command.set-sparkline","removeColumns","_initMergeWithSparkline","151537CvAaBD","fresh","pushUndoRedo","rgb(244,104,249)","get","min","seriesColor","ZERO_VALUE","_initClearWithSparkline","firstPoint","exclusiveRangesChange$","defineProperty","BOOLEAN","COMMAND","_ensureAnchorMatrix","realDeleteValue","SOFT","themeType","unitId","deleteUnit","emptyShowAs","getCellRaw","add","forEach","actualRow","_initCopySheetWithSparkline","FRESH","_injector","sparklines","_sparklineModel","MUTATION","getMatrix","CUSTOM","3887632wqLVav","map","removePartSparkline"];return $2=function(){return t},$2()}Object[B(633)];var wh=(t,e,x,n)=>{const r=B;for(var s=e,i=t[r(563)]-1,a;i>=0;i--)(a=t[i])&&(s=a(s)||s);return s},ks=(t,e)=>(x,n)=>e(x,n,t);let A2=class extends U0{constructor(t,e,x){const n=B;super(),this[n(514)]=t,this[n(534)]=e,this[n(475)]=x,this._initMergeWithSparkline()}[B(594)](){const t=B;this[t(536)](this[t(534)].interceptCommand({getMutations:e=>{const x=t,n=[],r=[];if(e.id===U1.id){const s=e[x(654)];if(!s)return{redos:n,undos:r};const{unitId:i,subUnitId:a,ranges:o}=s,d=this[x(475)][x(647)](i,a);if(!d)return{redos:n,undos:r};const c={},l={},u=new Set;o[x(618)](b=>{const h=x,p=b[h(639)],I=b[h(504)];Rx[h(574)](b,(v,C)=>{const w=h,y=this._sparklineDataSourceModel.getSparkline(i,a,v,C);if(y&&!(v===p&&C===I)){const P=this._sparklineDataSourceModel[w(561)](i,a,y);if(P){u.add(y);let E=c[y];E||(E={config:R.deepClone(P.config),sparklines:new K(P[w(623)][w(508)]())},c[y]=E),E[w(623)][w(610)](v,C),l[y]={config:R[w(507)](P[w(560)]),sparklines:R.deepClone(P[w(623)].clone())}}}})});for(const[b,h]of d){const p=h[x(623)];p[x(510)]((I,v,C)=>{const w=x;for(let y=0;y<o[w(563)];y++){const P=o[y];if(x0[w(570)](P,C)){u[w(617)](b);let E=c[b];E||(E={config:R.deepClone(h[w(560)]),sparklines:new K(p[w(508)]())},c[b]=E),E[w(623)][w(610)](I,v),l[b]||(l[b]={config:R.deepClone(h[w(560)]),sparklines:R[w(507)](p[w(508)]())})}}})}const f={};Object[x(591)](c)[x(618)](([b,h])=>{const p=x;h.sparklines.getSizeOf()&&(f[b]={config:h[p(560)],sparklines:h[p(623)][p(508)]()})}),u[x(566)]&&(n[x(655)]({id:D0.id,params:{unitId:i,subUnitId:a,groupIds:Array[x(524)](u),isSingle:!1}}),r[x(655)]({id:D0.id,params:{unitId:i,subUnitId:a,groupIds:Array[x(524)](u),isSingle:!1}}),n[x(655)]({id:k0.id,params:{unitId:i,subUnitId:a,sparklineConfigMap:f}}),r[x(655)]({id:k0.id,params:{unitId:i,subUnitId:a,sparklineConfigMap:l}}))}return{redos:n,undos:r}}}))}};A2=wh([ks(0,q(g0)),ks(1,q(Ye)),ks(2,q(K0))],A2);Object[B(633)];var Ph=(t,e,x,n)=>{const r=B;for(var s=e,i=t[r(563)]-1,a;i>=0;i--)(a=t[i])&&(s=a(s)||s);return s},qn=(t,e)=>(x,n)=>e(x,n,t);let V2=class extends U0{constructor(t,e,x,n){const r=B;super(),Qt(this,r(579),new Pr),this[r(514)]=t,this[r(587)]=e,this[r(635)]=x,this[r(475)]=n,this[r(577)](),this[r(521)]()}[B(577)](){const t=B,e=(x,n)=>{const r=ot,s=this[r(635)][r(526)](P0[r(502)]);if(!s||!(s!=null&&s[r(572)](n)))return;this[r(579)][r(478)]();const i=d=>this[r(531)](d,x,n),a=[],o=this._sparklineDataSourceModel[r(647)](x,n);if(o){for(const[d,c]of o)c[r(623)][r(510)]((l,u,f)=>{const b=r,h=Gx(l,u);a[b(655)](h)});a[r(618)](d=>{const c=r;this.disposableCollection.add(this[c(587)][c(520)](d,i,x,n))})}};this.disposeWithMe(this[t(514)][t(553)](x=>{const n=t;if(x.id===k1.id){const r=x[n(654)],s=r[n(532)],i=r.unitId;if(!s||!i)return;e(i,s)}if(x.id===Kr.id||x.id===k0.id){const r=x.params,s=r[n(532)],i=r[n(613)];if(!s||!i)return;e(i,s)}}))}[B(531)](t,e,x){const n=B;switch(t.id){case Mn.id:return this[n(638)](t[n(654)],e,x);case Nn.id:return this[n(483)](t[n(654)],e,x)}return{redos:[],undos:[]}}[B(483)](t,e,x){const n=B;var r,s;const{range:i}=t,a=new Set,o={},d={},c=[],l=[],u=[],f=[];if(!ax(this[n(635)],{unitId:e,subUnitId:x}))return{redos:l,undos:c};const b=this[n(475)][n(647)](e,x);if(!b)return{redos:l,undos:c};if(!((s=(r=this[n(475)][n(493)]()[n(634)][n(599)](e))==null?void 0:r.get(x))!=null&&s[n(637)]))return{redos:l,undos:c};for(const[I,v]of b){const C=v[n(623)];C[n(510)]((w,y,P)=>{const E=n;if(x0[E(558)](i,P)){a[E(617)](I);let S=d[I];S||(S={config:v[E(560)],sparklines:v.sparklines.clone()},d[I]=S);let T=o[I];T||(T={config:v[E(560)],sparklines:new K(v[E(623)][E(508)]())},o[I]=T);const k=lt(P,{id:j0.id,params:t});k?T.sparklines[E(554)](w,y,k):T[E(623)][E(554)](w,y,{startRow:-9999,endRow:-9999,startColumn:-9999,endColumn:-9999,rangeType:Qx[E(545)]})}}),C[n(510)]((w,y,P)=>{const E=n;if(w<=i.endRow&&w>=i[E(639)]){a.add(I);let S=d[I];S||(S={config:v[E(560)],sparklines:v[E(623)][E(508)]()},d[I]=S);let T=o[I];T||(T={config:v[E(560)],sparklines:new K(v.sparklines[E(508)]())},o[I]=T)}})}f[n(655)]({id:D0.id,params:{unitId:e,subUnitId:x,groupIds:Array[n(524)](a),isSingle:!1}}),u[n(655)]({id:D0.id,params:{unitId:e,subUnitId:x,groupIds:Array[n(524)](a),isSingle:!1}});const h={};let p=!1;return Object.entries(o)[n(618)](([I,v])=>{const C=n;v[C(623)].getSizeOf()&&(p=!0,v.sparklines[C(657)](i[C(639)],i.endRow-i[C(639)]+1),h[I]={config:v[C(560)],sparklines:v.sparklines[C(508)]()})}),p&&l[n(655)]({id:k0.id,params:{unitId:e,subUnitId:x,sparklineConfigMap:h}}),c[n(655)]({id:k0.id,params:{unitId:e,subUnitId:x,sparklineConfigMap:d}}),{redos:l,undos:c,preRedos:u,preUndos:f}}[B(638)](t,e,x){const n=B;var r,s;const{range:i}=t,a=new Set,o={},d={},c=[],l=[],u=[],f=[];if(!ax(this._univerInstanceService,{unitId:e,subUnitId:x}))return{redos:l,undos:c};const b=this[n(475)].getSubUnitSparkline(e,x);if(!b)return{redos:l,undos:c};if(!((s=(r=this._sparklineDataSourceModel[n(493)]()[n(634)][n(599)](e))==null?void 0:r.get(x))!=null&&s[n(637)]))return{redos:l,undos:c};for(const[I,v]of b){const C=v[n(623)];C[n(510)]((w,y,P)=>{const E=n;if(x0[E(558)](i,P)){a[E(617)](I);let S=d[I];S||(S={config:v.config,sparklines:v[E(623)][E(508)]()},d[I]=S);let T=o[I];T||(T={config:v[E(560)],sparklines:new K(v[E(623)].clone())},o[I]=T);const k=lt(P,{id:V0.id,params:t});k?T[E(623)].setValue(w,y,k):T[E(623)][E(554)](w,y,{startRow:-9999,endRow:-9999,startColumn:-9999,endColumn:-9999,rangeType:Qx[E(545)]})}}),C.forValue((w,y,P)=>{const E=n;if(y<=i[E(537)]&&y>=i[E(504)]){a[E(617)](I);let S=d[I];S||(S={config:v[E(560)],sparklines:v.sparklines[E(508)]()},d[I]=S);let T=o[I];T||(T={config:v.config,sparklines:new K(v[E(623)][E(508)]())},o[I]=T)}})}f.push({id:D0.id,params:{unitId:e,subUnitId:x,groupIds:Array.from(a),isSingle:!1}}),u[n(655)]({id:D0.id,params:{unitId:e,subUnitId:x,groupIds:Array[n(524)](a),isSingle:!1}});const h={};let p=!1;return Object[n(591)](o).forEach(([I,v])=>{const C=n;v[C(623)][C(549)]()&&(p=!0,v.sparklines[C(593)](i.startColumn,i[C(537)]-i.startColumn+1),h[I]={config:v[C(560)],sparklines:v[C(623)][C(508)]()})}),p&&l[n(655)]({id:k0.id,params:{unitId:e,subUnitId:x,sparklineConfigMap:h}}),c.push({id:k0.id,params:{unitId:e,subUnitId:x,sparklineConfigMap:d}}),{redos:l,undos:c,preRedos:u,preUndos:f}}[B(521)](){const t=B;this[t(536)](this[t(514)].onCommandExecuted(e=>{const x=t;if(e.id===B0.id){const n=e.params,{unitId:r,subUnitId:s,range:i}=n,a=i[x(504)],o=i[x(537)]-i[x(504)]+1,d=this[x(475)][x(647)](r,s);if(!d)return;for(const[c,l]of d){this[x(475)][x(631)](r,s,c);const u=l[x(623)];u[x(510)]((b,h,p)=>{const I=x,v={...p};a<=v[I(504)]?(v.startColumn+=o,v[I(537)]+=o):a>v[I(537)]||(v.endColumn+=o),u.setValue(b,h,v)});const f=u[x(626)]();for(const b in f){const h=f[Number(b)];if(!h)continue;const p=Object.keys(h)[x(629)](Number),I=Math[x(527)](...p);for(let v=I;v>=a;v--)v>=a&&h[v]&&(h[v+o]=h[v],delete h[v])}this._sparklineDataSourceModel[x(590)](r,s,c)}}else if(e.id===G0.id){const n=e[x(654)],{unitId:r,subUnitId:s,range:i}=n,a=i[x(639)],o=i[x(497)]-i.startRow+1,d=this[x(475)][x(647)](r,s);if(!d)return;for(const[c,l]of d){this[x(475)][x(631)](r,s,c);const u=l[x(623)];u.forValue((p,I,v)=>{const C=x,w={...v};a<=w[C(639)]?(w[C(639)]+=o,w[C(497)]+=o):a>w[C(497)]||(w[C(497)]+=o),u[C(554)](p,I,w)});const f=u[x(626)](),b=Object.keys(f)[x(629)](Number),h=Math[x(527)](...b);for(let p=h;p>=a;p--)p>=a&&f[p]&&(f[p+o]=f[p],delete f[p]);this[x(475)].updateSparklineExtraNum(r,s,c)}}else if(e.id===V0.id){const n=e[x(654)],{range:r,unitId:s,subUnitId:i}=n,a=this[x(475)][x(647)](s,i);if(!a)return;for(const[o,d]of a){const c=d[x(623)];c[x(510)]((l,u,f)=>{const b=lt(f,e);b?c.setValue(l,u,b):c.setValue(l,u,{startRow:-9999,endRow:-9999,startColumn:-9999,endColumn:-9999,rangeType:Qx.NORMAL})}),c[x(593)](r[x(504)],r[x(537)]-r[x(504)]+1)}this._sparklineDataSourceModel[x(538)](s,i)}else if(e.id===j0.id){const n=e[x(654)],{range:r,unitId:s,subUnitId:i}=n,a=this[x(475)][x(647)](s,i);if(!a)return;for(const[o,d]of a){const c=d[x(623)];c[x(510)]((l,u,f)=>{const b=x,h=lt(f,e);h?c[b(554)](l,u,h):c.setValue(l,u,{startRow:-9999,endRow:-9999,startColumn:-9999,endColumn:-9999,rangeType:Qx[b(545)]})}),c.removeRows(r[x(639)],r[x(497)]-r[x(639)]+1)}this._sparklineDataSourceModel[x(538)](s,i)}else if(e.id===q0.id){const n=e[x(654)],{unitId:r,subUnitId:s,sourceRange:i,targetRange:a}=n,o=this[x(475)][x(647)](r,s);if(!o)return;for(const[d,c]of o){const l=c[x(623)];l[x(510)]((u,f,b)=>{const h=x,p=lt(b,e);p?l[h(554)](u,f,p):l[h(554)](u,f,{startRow:-9999,endRow:-9999,startColumn:-9999,endColumn:-9999,rangeType:Qx.NORMAL})}),l[x(649)](i[x(504)],i[x(537)]-i[x(504)]+1,a[x(504)])}this._sparklineDataSourceModel[x(538)](r,s)}else if(e.id===Y0.id){const n=e[x(654)],{unitId:r,subUnitId:s,sourceRange:i,targetRange:a}=n,o=this[x(475)].getSubUnitSparkline(r,s);if(!o)return;for(const[d,c]of o){const l=c[x(623)];l[x(510)]((u,f,b)=>{const h=x,p=lt(b,e);p?l.setValue(u,f,p):l.setValue(u,f,{startRow:-9999,endRow:-9999,startColumn:-9999,endColumn:-9999,rangeType:Qx[h(545)]})}),l.moveRows(i[x(639)],i[x(497)]-i[x(639)]+1,a[x(639)])}this[x(475)][x(538)](r,s)}else if(e.id===hx.id){const n=e[x(654)],{fromRange:r,toRange:s,unitId:i,from:a,to:o}=n;if(a[x(532)]!==o[x(532)])return;const d=a[x(532)],{startRow:c,endRow:l,startColumn:u,endColumn:f}=r,{startRow:b,startColumn:h}=s,p=b-c,I=h-u,v=this[x(475)].getSubUnitSparkline(i,d);if(!(v!=null&&v.size))return;for(let C=c;C<=l;C++)for(let w=u;w<=f;w++){const y=this[x(475)][x(519)](i,d,C,w);if(y){const P=this._sparklineDataSourceModel[x(561)](i,d,y);if(P){const E=P[x(623)][x(643)](C,w);E&&(P.sparklines[x(554)](C+p,w+I,E),P[x(623)].realDeleteValue(C,w))}}}for(const[C,w]of v){const y=w.sparklines;y[x(510)]((P,E,S)=>{const T=x,k={...S};x0[T(570)](r,S)&&(k[T(639)]+=p,k[T(497)]+=p,k[T(504)]+=I,k.endColumn+=I),y[T(554)](P,E,k)})}this[x(475)][x(538)](i,d)}}))}};V2=Ph([qn(0,q(g0)),qn(1,q(Da)),qn(2,N0),qn(3,q(K0))],V2);Object[B(633)];var yh=(t,e,x,n)=>{for(var r=e,s=t.length-1,i;s>=0;s--)(i=t[s])&&(r=i(r)||r);return r},ca=(t,e)=>(x,n)=>e(x,n,t);function ot(t,e){const x=$2();return ot=function(n,r){return n=n-470,x[n]},ot(t,e)}let j2=class extends U0{constructor(t,e){const x=B;super(),this[x(505)]=t,this[x(475)]=e,this[x(490)]()}_initSnapshot(){const t=B,e=n=>{const r=ot,s=this._sparklineDataSourceModel.toJSON(n);return s?JSON[r(557)](s):""},x=n=>n?JSON.parse(n):{};this.disposeWithMe(this._resourceManagerService[t(487)]({toJson:e,parseJson:x,pluginName:hs,businesses:[P0.UNIVER_SHEET],onLoad:(n,r)=>{const s=t;this._sparklineDataSourceModel[s(651)](r)},onUnLoad:n=>{const r=t;this[r(475)][r(614)](n)}}))}};j2=yh([ca(0,q(q2)),ca(1,q(K0))],j2);var Rh=Object.defineProperty;Object[B(633)];var Eh=(t,e,x)=>e in t?Rh(t,e,{enumerable:!0,configurable:!0,writable:!0,value:x}):t[e]=x,Sh=(t,e,x,n)=>{const r=B;for(var s=e,i=t[r(563)]-1,a;i>=0;i--)(a=t[i])&&(s=a(s)||s);return s},la=(t,e)=>(x,n)=>e(x,n,t),ua=(t,e,x)=>Eh(t,typeof e!="symbol"?e+"":e,x);let zt=class extends kt{constructor(t={},e,x){const n=B;super(),this[n(522)]=t,this[n(622)]=e,this[n(514)]=x,this[n(499)](),this[n(516)]()}[B(499)](){const t=B;[[K0],[O2],[A2],[k2],[V2],[F2],[D2],[j2]][t(618)](e=>{this[t(622)].add(e)}),dn(this[t(622)],[[j2]])}onReady(){dn(this[B(622)],[[O2],[A2],[k2],[V2],[F2],[D2]])}[B(516)](){const t=B;[qr,k0,nt,D0,_x,Kr][t(618)](e=>this[t(514)].registerCommand(e))}};ua(zt,B(539),hs),ua(zt,B(541),P0.UNIVER_SHEET),zt=Sh([X2(gn),la(1,q(Vx)),la(2,q(g0))],zt);var Th=Object.defineProperty,Mh=(t,e,x)=>e in t?Th(t,e,{enumerable:!0,configurable:!0,writable:!0,value:x}):t[e]=x,an=(t,e,x)=>Mh(t,typeof e!="symbol"?e+"":e,x);const Fo="SheetGraphicsExtension",Nh=35;class Zr extends O1{constructor(){super(...arguments),an(this,"uKey",Fo),an(this,"Z_INDEX",Nh),an(this,"_graphicsRenderMap",new Map)}registerRenderer(e,x){this._graphicsRenderMap.set(e,x)}draw(e,x,n,r,{viewRanges:s}){const i=Array.from(this._graphicsRenderMap.keys());s.forEach(a=>{Rx.foreach(a,(o,d)=>{const c=n.getCellByIndexWithNoHeader(o,d);c&&i.forEach(l=>{const u=this._graphicsRenderMap.get(l);u==null||u(e,n,c)})})})}dispose(){this._graphicsRenderMap.clear()}copy(){const e=new Zr;return this._graphicsRenderMap.forEach((x,n)=>{e.registerRenderer(n,x)}),e}}var Uh=(t,e,x,n)=>{for(var r=e,s=t.length-1,i;s>=0;s--)(i=t[s])&&(r=i(r)||r);return r},kh=(t,e)=>(x,n)=>e(x,n,t);let L2=class extends U0{constructor(t,e){super(),an(this,"_graphicsExtensionInstance",null),this._context=t,this._sheetPrintInterceptorService=e,this._initRender(),this._initPrinting()}_initRender(){const t=this._context.mainComponent;t&&!t.getExtensionByKey(Fo)&&(this._graphicsExtensionInstance=new Zr,t.register(this._graphicsExtensionInstance))}_initPrinting(){this.disposeWithMe(this._sheetPrintInterceptorService.interceptor.intercept(this._sheetPrintInterceptorService.interceptor.getInterceptPoints().PRINTING_COMPONENT_COLLECT,{handler:(t,e,x)=>{const{spreadsheet:n}=e;return this._graphicsExtensionInstance&&n.register(this._graphicsExtensionInstance.copy()),x(t)}}))}registerRenderer(t,e){var x;(x=this._graphicsExtensionInstance)==null||x.registerRenderer(t,e)}};L2=Uh([kh(1,q(Oa))],L2);const Dh="graphics.config",fa={};var Oh=(t,e,x,n)=>{for(var r=e,s=t.length-1,i;s>=0;s--)(i=t[s])&&(r=i(r)||r);return r},Ds=(t,e)=>(x,n)=>e(x,n,t);const Fh="UNIVER_SHEET_DRAWING_PLUGIN";var Os;let _r=(Os=class extends kt{constructor(t=fa,e,x,n){super(),this._config=t,this._injector=e,this._configService=x,this._renderManagerService=n;const{...r}=Rn({},fa,this._config);this._configService.setConfig(Dh,r)}onRendered(){[[L2]].forEach(t=>{this._renderManagerService.registerRenderModule(P0.UNIVER_SHEET,t)})}},an(Os,"pluginName",Fh),Os);_r=Oh([Ds(1,q(Vx)),Ds(2,W0),Ds(3,yr)],_r);const M=Ix;(function(t,e){const x=Ix,n=t();for(;;)try{if(parseInt(x(713))/1+-parseInt(x(699))/2*(-parseInt(x(515))/3)+parseInt(x(536))/4+parseInt(x(724))/5+parseInt(x(488))/6*(-parseInt(x(495))/7)+-parseInt(x(723))/8*(-parseInt(x(620))/9)+parseInt(x(802))/10*(-parseInt(x(708))/11)===e)break;n.push(n.shift())}catch{n.push(n.shift())}})(G2,365448);var $h=Object.defineProperty,Ah=(t,e,x)=>e in t?$h(t,e,{enumerable:!0,configurable:!0,writable:!0,value:x}):t[e]=x,ma=(t,e,x)=>Ah(t,typeof e!=M(804)?e+"":e,x);function Ix(t,e){const x=G2();return Ix=function(n,r){return n=n-430,x[n]},Ix(t,e)}const xi=M(577),Ut=M(693),$o=M(519),Ze=M(841),Vh="SHEET_SPARKLINE_RENDERER",on={id:M(853),type:c0[M(593)],handler:t=>{const e=M,x=t.get(Fa),n=t[e(834)](jx),r=t[e(834)](is),s={id:Ze,header:{title:n.t(e(433))},children:{label:$o},width:330,destroyOnClose:!0,onClose:()=>{r.close(Ut)}};return x.open(s),!0}},ei={type:c0[M(593)],id:M(789),handler:async t=>{const e=M,x=t[e(834)](N0),n=ax(x);if(!n)return!1;const r=t[e(834)](Se).getCurrentSelections()[e(483)](o=>o[e(480)]),s=await Ao(t,r);if(!s)return!1;const{unitId:i,subUnitId:a}=n;return t.get(g0)[e(667)](qr.id,{sourceRanges:s[e(850)],targetRanges:s[e(670)],targetInfo:{unitId:i,subUnitId:a}}),!0}};async function Ao(t,e,x,n){const r=M,s=t[r(834)](is),i=t[r(834)](jx);return new Promise(a=>{const o=r;let d;const c={sourceRanges:e,targetRanges:x,resetCtx:n,onConfirm:l=>{const u=Ix;a(l),d==null||d[u(640)]()},onCancel:()=>{a(null),d==null||d.dispose()}};d=s[o(613)]({id:Ut,title:{title:i.t("sheets-sparkline.selector.title")},draggable:!0,mask:!1,maskClosable:!1,destroyOnClose:!0,children:{label:{name:Ut,props:c}},width:400,onClose:()=>{d.dispose()}})})}const jh="sheets-sparkline-ui.config",ba={};var Lh=(t,e,x,n)=>{for(var r=e,s=t.length-1,i;s>=0;s--)(i=t[s])&&(r=i(r)||r);return r},Kn=(t,e)=>(x,n)=>e(x,n,t);let H2=class extends U0{constructor(t,e,x,n){const r=M;super(),this[r(615)]=t,this[r(791)]=e,this[r(753)]=x,this[r(691)]=n,this[r(808)]()}[M(808)](){const t=M,e=()=>({redos:[],undos:[]}),x=(r,s)=>{const i=Ix;var a,o,d,c;const l=[],u=[],{source:f,target:b,unitId:h,subUnitId:p}=r;if(!f||!b||s==null)return{undos:l,redos:u};const I=fi(f),v=fi(b),C=I[i(805)]-I.startRow+1,w=I[i(639)]-I[i(736)]+1,y=v[i(805)]-v[i(507)]+1,P=v.endColumn-v[i(736)]+1;if(x0[i(586)](I,v))return{undos:l,redos:u};if(s===An.UP){const E={},S={},T=new Set;for(let k=0;k<w;k++)for(let V=0;V<y;V++){const H=V%C,D=v.startRow+V,U=v[i(736)]+k,j=I.startRow+H,F=this[i(691)][i(792)](h,p,D,U);if(F){T[i(689)](F);const G=this[i(691)][i(790)](h,p,F);if(G){S[F]={config:R[i(741)](G.config),sparklines:R[i(741)](G[i(835)].clone())};let Y=E[F];Y||(Y={config:R[i(741)](G[i(489)]),sparklines:new K(G[i(835)].clone())},E[F]=Y),Y.sparklines[i(774)](D,U)}}const z=this[i(691)][i(792)](h,p,j,U);if(z){const G=this._sparklineDataSourceModel[i(790)](h,p,z);if(G){S[z]={config:R[i(741)](G[i(489)]),sparklines:R[i(741)](G[i(835)][i(540)]())};let Y=E[z];Y||(Y={config:R[i(741)](G[i(489)]),sparklines:new K(G.sparklines[i(540)]())},E[z]=Y),Y[i(835)].realDeleteValue(D,U);const t0=(a=this[i(691)].getSparklineById(h,p,z))==null?void 0:a[i(835)],A=t0==null?void 0:t0.getValue(j,U);if(A){const Z={...A,startRow:A[i(507)]+D-j,endRow:A[i(805)]+D-j};Y.sparklines[i(704)](D,U,Z),T[i(689)](z)}}}const Q={};Object.entries(E)[i(810)](([G,Y])=>{const t0=i;Y[t0(835)].getSizeOf()&&(Q[G]={config:Y.config,sparklines:Y[t0(835)][t0(540)]()})}),T.size&&(u.push({id:D0.id,params:{unitId:h,subUnitId:p,groupIds:Array[i(719)](T),isSingle:!1}}),l[i(722)]({id:D0.id,params:{unitId:h,subUnitId:p,groupIds:Array[i(719)](T),isSingle:!1}}),u[i(722)]({id:k0.id,params:{unitId:h,subUnitId:p,sparklineConfigMap:Q}}),l.push({id:k0.id,params:{unitId:h,subUnitId:p,sparklineConfigMap:S}}))}}else if(s===An[i(818)]){const E={},S={},T=new Set;for(let V=0;V<w;V++)for(let H=0;H<y;H++){const D=H%C,U=v[i(507)]+H,j=v[i(736)]+V,F=I.startRow+D,z=this[i(691)][i(792)](h,p,F,j),Q=this[i(691)][i(792)](h,p,U,j);if(Q){T[i(689)](Q);const G=this[i(691)][i(790)](h,p,Q);if(G){S[Q]={config:R[i(741)](G.config),sparklines:R[i(741)](G[i(835)][i(540)]())};let Y=E[Q];Y||(Y={config:R[i(741)](G[i(489)]),sparklines:new K(G[i(835)][i(540)]())},E[Q]=Y),Y[i(835)][i(774)](U,j)}}if(z){const G=this[i(691)][i(790)](h,p,z);if(G){S[z]={config:R[i(741)](G[i(489)]),sparklines:R[i(741)](G[i(835)][i(540)]())};let Y=E[z];Y||(Y={config:R[i(741)](G.config),sparklines:new K(G[i(835)].clone())},E[z]=Y),Y.sparklines[i(774)](U,j);const t0=(o=this[i(691)][i(790)](h,p,z))==null?void 0:o.sparklines,A=t0==null?void 0:t0[i(477)](F,j);if(A){const Z={...A,startRow:A[i(507)]+U-F,endRow:A.endRow+U-F};Y[i(835)][i(704)](U,j,Z),T[i(689)](z)}}}}const k={};Object[i(617)](E)[i(810)](([V,H])=>{const D=i;H[D(835)].getSizeOf()&&(k[V]={config:H[D(489)],sparklines:H[D(835)][D(540)]()})}),T.size&&(u[i(722)]({id:D0.id,params:{unitId:h,subUnitId:p,groupIds:Array[i(719)](T),isSingle:!1}}),l.push({id:D0.id,params:{unitId:h,subUnitId:p,groupIds:Array[i(719)](T),isSingle:!1}}),u[i(722)]({id:k0.id,params:{unitId:h,subUnitId:p,sparklineConfigMap:k}}),l[i(722)]({id:k0.id,params:{unitId:h,subUnitId:p,sparklineConfigMap:S}}))}else if(s===An[i(580)]){const E={},S={},T=new Set;for(let V=0;V<C;V++)for(let H=0;H<P;H++){const D=H%w,U=v[i(507)]+V,j=v.startColumn+H,F=I[i(736)]+D,z=this[i(691)].getSparkline(h,p,U,j);if(z){T[i(689)](z);const G=this[i(691)][i(790)](h,p,z);if(G){S[z]={config:R[i(741)](G[i(489)]),sparklines:R[i(741)](G[i(835)][i(540)]())};let Y=E[z];Y||(Y={config:R[i(741)](G[i(489)]),sparklines:new K(G[i(835)].clone())},E[z]=Y),Y[i(835)][i(774)](U,j)}}const Q=this[i(691)].getSparkline(h,p,U,F);if(Q){const G=this[i(691)][i(790)](h,p,Q);if(G){S[Q]={config:R[i(741)](G.config),sparklines:R.deepClone(G[i(835)].clone())};let Y=E[Q];Y||(Y={config:R[i(741)](G[i(489)]),sparklines:new K(G[i(835)][i(540)]())},E[Q]=Y),Y.sparklines.realDeleteValue(U,j);const t0=(d=this._sparklineDataSourceModel[i(790)](h,p,Q))==null?void 0:d[i(835)],A=t0==null?void 0:t0[i(477)](U,F);if(A){const Z={...A,startColumn:A[i(736)]+j-F,endColumn:A[i(639)]+j-F};Y.sparklines[i(704)](U,j,Z),T.add(Q)}}}}const k={};Object[i(617)](E)[i(810)](([V,H])=>{const D=i;H[D(835)][D(525)]()&&(k[V]={config:H[D(489)],sparklines:H[D(835)][D(540)]()})}),T.size&&(u[i(722)]({id:D0.id,params:{unitId:h,subUnitId:p,groupIds:Array[i(719)](T),isSingle:!1}}),l.push({id:D0.id,params:{unitId:h,subUnitId:p,groupIds:Array[i(719)](T),isSingle:!1}}),u[i(722)]({id:k0.id,params:{unitId:h,subUnitId:p,sparklineConfigMap:k}}),l[i(722)]({id:k0.id,params:{unitId:h,subUnitId:p,sparklineConfigMap:S}}))}else if(s===An[i(756)]){const E={},S={},T=new Set;for(let V=0;V<C;V++)for(let H=0;H<P;H++){const D=H%w,U=v[i(507)]+V,j=v.startColumn+H,F=I[i(736)]+D,z=this[i(691)][i(792)](h,p,U,j);if(z){T[i(689)](z);const G=this[i(691)][i(790)](h,p,z);if(G){S[z]={config:R.deepClone(G.config),sparklines:R[i(741)](G.sparklines[i(540)]())};let Y=E[z];Y||(Y={config:R[i(741)](G[i(489)]),sparklines:new K(G[i(835)][i(540)]())},E[z]=Y),Y[i(835)][i(774)](U,j)}}const Q=this._sparklineDataSourceModel[i(792)](h,p,U,F);if(Q){const G=this._sparklineDataSourceModel[i(790)](h,p,Q);if(G){S[Q]={config:R[i(741)](G.config),sparklines:R[i(741)](G.sparklines.clone())};let Y=E[Q];Y||(Y={config:R[i(741)](G[i(489)]),sparklines:new K(G[i(835)][i(540)]())},E[Q]=Y),Y.sparklines[i(774)](U,j);const t0=(c=this[i(691)][i(790)](h,p,Q))==null?void 0:c.sparklines,A=t0==null?void 0:t0[i(477)](U,F);if(A){const Z={...A,startColumn:A[i(736)]+j-F,endColumn:A[i(639)]+j-F};Y.sparklines[i(704)](U,j,Z),T[i(689)](Q)}}}}const k={};Object[i(617)](E).forEach(([V,H])=>{const D=i;H.sparklines[D(525)]()&&(k[V]={config:H[D(489)],sparklines:H[D(835)][D(540)]()})}),T[i(579)]&&(u[i(722)]({id:D0.id,params:{unitId:h,subUnitId:p,groupIds:Array.from(T),isSingle:!1}}),l.push({id:D0.id,params:{unitId:h,subUnitId:p,groupIds:Array[i(719)](T),isSingle:!1}}),u[i(722)]({id:k0.id,params:{unitId:h,subUnitId:p,sparklineConfigMap:k}}),l.push({id:k0.id,params:{unitId:h,subUnitId:p,sparklineConfigMap:S}}))}return{undos:l,redos:u}},n={id:hs,onFillData:(r,s,i)=>i===Cs.COPY||i===Cs[t(530)]||i===Cs[t(649)]?x(r,s):e()};this[t(843)](this._autoFillService.addHook(n))}};H2=Lh([Kn(0,q(Vx)),Kn(1,q(N0)),Kn(2,q(V1)),Kn(3,q(K0))],H2);var Hh=(t,e,x,n)=>{const r=M;for(var s=e,i=t[r(523)]-1,a;i>=0;i--)(a=t[i])&&(s=a(s)||s);return s},ha=(t,e)=>(x,n)=>e(x,n,t);let B2=class extends U0{constructor(t,e){const x=M;super(),this[x(646)]=t,this._sparklineDataSourceModel=e,this[x(442)]()}[M(442)](){const t=M;this.disposeWithMe(this[t(646)][t(512)]({id:hs,onPasteCells:(e,x,n,r)=>{const s=t;var i,a,o;const d=[],c=[],{copyType:l=li[s(469)]}=r,u={};if(l===li.CUT)return{undos:d,redos:c};if(r[s(659)]!==F1[s(604)])return{undos:d,redos:c};if(!e)return{undos:d,redos:c};if(x.unitId!==e.unitId)return{undos:d,redos:c};const{range:f,unitId:b,subUnitId:h}=x,{range:p,unitId:I,subUnitId:v}=e,C={},w={},y={},P=new Set,E=new Set;for(let S=0;S<f.rows[s(523)];S++)for(let T=0;T<f[s(566)][s(523)];T++){const k=p[s(631)][S],V=p[s(566)][T];if(!this[s(691)][s(792)](I,v,k,V))continue;const H=f.rows[S],D=f[s(566)][T],U=f[s(631)][S]-k,j=f[s(566)][T]-V,F=this[s(691)][s(792)](I,v,k,V);if(F){let Q=C[u[F]];const G=this[s(691)][s(790)](I,v,F);if(!G)continue;if(!u[F]&&G){const t0="g_"+Ve(6);Q={newGroupId:t0,config:{config:R[s(741)](G[s(489)]),sparklines:{}}},C[t0]=Q,u[F]=t0}Q[s(489)][s(835)][H]||(Q[s(489)][s(835)][H]={});const Y=G[s(835)][s(477)](k,V);if(Y){const t0={startRow:Y[s(507)]+U,startColumn:Y.startColumn+j,endRow:Y.endRow+U,endColumn:Y[s(639)]+j};Q[s(489)][s(835)][H][D]=t0}}const z=this[s(691)][s(792)](b,h,f[s(631)][S],f[s(566)][T]);if(z){const Q=this._sparklineDataSourceModel.getSparklineById(b,h,z);Q&&(P.add(z),y[z]={config:R[s(741)](Q[s(489)]),sparklines:R.deepClone(Q[s(835)].getMatrix())},w[z]&&(w[z]={config:R[s(741)](Q.config),sparklines:R[s(741)](Q.sparklines[s(553)]())}),(o=(a=(i=w[z])==null?void 0:i[s(835)])==null?void 0:a[S])!=null&&o[T]&&delete w[z][s(835)][S][T])}}return Object[s(585)](C)[s(810)](S=>{const T=s,k=C[S];k&&(E.add(S),w[S]=k[T(489)])}),d.push({id:D0.id,params:{unitId:b,subUnitId:h,groupIds:Array[s(719)](E),isSingle:!1}}),d[s(722)]({id:k0.id,params:{unitId:b,subUnitId:h,sparklineConfigMap:y}}),c[s(722)]({id:D0.id,params:{unitId:b,subUnitId:h,groupIds:Array[s(719)](P),isSingle:!1}}),c[s(722)]({id:k0.id,params:{unitId:b,subUnitId:h,sparklineConfigMap:w}}),{undos:d,redos:c}}}))}};B2=Hh([ha(0,q(j1)),ha(1,q(K0))],B2);function te({ref:t,...e}){const x=M,{icon:n,id:r,className:s,extend:i,...a}=e,o=("univerjs-icon univerjs-icon-"+r+" "+(s||""))[x(644)](),d=v0.useRef("_"+Yh());return Vo(n,""+r,{defIds:n.defIds,idSuffix:d[x(605)]},{ref:t,className:o,...a},i)}function Vo(t,e,x,n,r){const s=M;return v0.createElement(t[s(700)],{key:e,...Bh(t,x,r),...n},(Gh(t,x).children||[])[s(483)]((i,a)=>Vo(i,e+"-"+t[s(700)]+"-"+a,x,void 0,r)))}function Bh(t,e,x){const n=M,r={...t[n(758)]};x!=null&&x.colorChannel1&&r[n(780)]===n(436)&&(r[n(780)]=x.colorChannel1),t[n(700)]===n(765)&&r.id&&(r.id=r.id+e[n(487)]),Object[n(617)](r)[n(810)](([i,a])=>{const o=n;i===o(765)&&typeof a=="string"&&(r[i]=a[o(846)](/url\(#(.*)\)/,o(642)+e.idSuffix+")"))});const{defIds:s}=e;return!s||s[n(523)]===0||(t[n(700)]==="use"&&r[n(441)]&&(r["xlink:href"]=r["xlink:href"]+e.idSuffix),Object[n(617)](r)[n(810)](([i,a])=>{const o=n;typeof a=="string"&&(r[i]=a[o(846)](/url\(#(.*)\)/,o(642)+e.idSuffix+")"))})),r}function Gh(t,e){const x=M;var n;const{defIds:r}=e;return!r||r[x(523)]===0?t:t[x(700)]===x(457)&&(n=t[x(816)])!=null&&n.length?{...t,children:t[x(816)].map(s=>typeof s[x(758)].id==x(568)&&r&&r.includes(s.attrs.id)?{...s,attrs:{...s[x(758)],id:s[x(758)].id+e[x(487)]}}:s)}:t}function Yh(){const t=M;return Math[t(611)]().toString(36)[t(432)](2,8)}te[M(750)]=M(567);const Wh={tag:"svg",attrs:{xmlns:M(830),fill:M(440),viewBox:"0 0 16 16",width:M(468),height:"1em"},children:[{tag:M(601),attrs:{fill:"currentColor",d:M(793),fillRule:M(783),clipRule:M(783)}}]},jo=v0.forwardRef(function(t,e){const x=M;return v0.createElement(te,Object[x(528)]({},t,{id:"column-sparkline-icon",ref:e,icon:Wh}))});jo[M(750)]=M(703);const Qh={tag:M(543),attrs:{xmlns:M(830),fill:M(440),viewBox:M(482),width:M(468),height:M(468)},children:[{tag:M(601),attrs:{fill:M(692),d:M(730)}},{tag:M(601),attrs:{fill:M(692),d:M(638)}},{tag:M(601),attrs:{fill:"currentColor",d:M(575)}},{tag:"path",attrs:{fill:M(692),d:M(555),fillRule:M(783),clipRule:M(783)}}]},Ir=v0.forwardRef(function(t,e){const x=M;return v0.createElement(te,Object[x(528)]({},t,{id:x(452),ref:e,icon:Qh}))});Ir[M(750)]=M(582);const zh={tag:M(543),attrs:{xmlns:M(830),fill:M(440),viewBox:"0 0 17 16",width:M(468),height:M(468)},children:[{tag:"path",attrs:{fill:"currentColor",d:M(677),fillRule:"evenodd",clipRule:M(783)}},{tag:"path",attrs:{fill:"currentColor",d:M(682),fillRule:"evenodd",clipRule:M(783)}}]},Lo=v0.forwardRef(function(t,e){const x=M;return v0.createElement(te,Object.assign({},t,{id:x(458),ref:e,icon:zh}))});Lo.displayName=M(799);const Jh={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:M(440),viewBox:"0 0 16 16",width:"1em",height:M(468)},children:[{tag:M(601),attrs:{fill:"currentColor",d:M(552),fillRule:"evenodd",clipRule:"evenodd"}}]},ti=v0.forwardRef(function(t,e){const x=M;return v0.createElement(te,Object[x(528)]({},t,{id:"line-sparkline-icon",ref:e,icon:Jh}))});ti[M(750)]="LineSparklineIcon";const Xh={tag:M(543),attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:M(468),height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:M(514),fillRule:"evenodd",clipRule:M(783)}}]},ni=v0.forwardRef(function(t,e){const x=M;return v0.createElement(te,Object[x(528)]({},t,{id:x(833),ref:e,icon:Xh}))});ni[M(750)]="MoreDownIcon";const qh={tag:M(543),attrs:{xmlns:"http://www.w3.org/2000/svg",fill:M(440),viewBox:M(482),width:M(468),height:M(468)},children:[{tag:M(601),attrs:{fill:M(692),d:"M6.14645 4.64645C6.34171 4.45118 6.65829 4.45118 6.85355 4.64645L9.85355 7.64645C10.0488 7.84171 10.0488 8.15829 9.85355 8.35355L6.85355 11.3536C6.65829 11.5488 6.34171 11.5488 6.14645 11.3536C5.95118 11.1583 5.95118 10.8417 6.14645 10.6464L8.79289 8L6.14645 5.35355C5.95118 5.15829 5.95118 4.84171 6.14645 4.64645Z",fillRule:M(783),clipRule:M(783)}}]},Ho=v0.forwardRef(function(t,e){const x=M;return v0.createElement(te,Object[x(528)]({},t,{id:x(660),ref:e,icon:qh}))});Ho[M(750)]=M(500);const Kh={tag:M(543),attrs:{xmlns:M(830),fill:M(440),viewBox:M(482),width:"1em",height:M(468)},children:[{tag:"g",attrs:{fill:M(692),fillRule:M(783),clipPath:M(511),clipRule:M(783)},children:[{tag:M(601),attrs:{d:"M7.40023 2.22624C4.47633 2.5265 2.19561 4.99701 2.19561 8.00023C2.19561 11.206 4.79442 13.8048 8.00023 13.8048C11.0034 13.8048 13.474 11.5241 13.7742 8.60023H9.60023C8.3852 8.60023 7.40023 7.61525 7.40023 6.40023V2.22624ZM0.995605 8.00023C0.995605 4.13168 4.13168 0.995605 8.00023 0.995605C8.3316 0.995605 8.60023 1.26423 8.60023 1.59561V6.40023C8.60023 6.95251 9.04794 7.40023 9.60023 7.40023H14.4049C14.7362 7.40023 15.0049 7.66886 15.0049 8.00023C15.0049 11.8688 11.8688 15.0049 8.00023 15.0049C4.13168 15.0049 0.995605 11.8688 0.995605 8.00023Z"}},{tag:"path",attrs:{d:M(470)}}]},{tag:"defs",attrs:{},children:[{tag:"clipPath",attrs:{id:"pie-chart-icon_clip0_1644_114"},children:[{tag:"path",attrs:{fill:M(513),d:"M0 0H16V16H0z"}}]}]}],defIds:[M(478)]},Bo=v0.forwardRef(function(t,e){const x=M;return v0.createElement(te,Object[x(528)]({},t,{id:x(496),ref:e,icon:Kh}))});Bo[M(750)]="PieChartIcon";const Zh={tag:M(543),attrs:{xmlns:M(830),fill:"none",viewBox:M(482),width:"1em",height:M(468)},children:[{tag:"g",attrs:{clipPath:M(848)},children:[{tag:"path",attrs:{fill:M(692),d:M(840),fillRule:"evenodd",clipRule:"evenodd"}}]},{tag:M(457),attrs:{},children:[{tag:M(687),attrs:{id:M(656)},children:[{tag:M(601),attrs:{fill:M(513),d:M(494)}}]}]}],defIds:[M(656)]},Go=v0.forwardRef(function(t,e){const x=M;return v0.createElement(te,Object.assign({},t,{id:x(587),ref:e,icon:Zh}))});Go.displayName=M(655);const x4={tag:M(543),attrs:{xmlns:M(830),fill:M(440),viewBox:M(482),width:M(468),height:"1em"},children:[{tag:M(601),attrs:{fill:M(692),d:M(661),fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:M(692),d:M(430),fillRule:M(783),clipRule:M(783)}},{tag:M(601),attrs:{fill:M(692),d:M(701),fillRule:M(783),clipRule:M(783)}}]},Yo=v0.forwardRef(function(t,e){return v0.createElement(te,Object.assign({},t,{id:"winloss-sparkline-icon",ref:e,icon:x4}))});Yo.displayName=M(455);const e4={tag:"svg",attrs:{xmlns:M(830),fill:"none",viewBox:M(767),width:M(468),height:M(468)},children:[{tag:M(601),attrs:{fill:M(692),d:"M12.6551 1.98906C11.7476 1.08113 10.2757 1.08149 9.3686 1.98987L4.82542 6.53955C4.75087 6.61421 4.69336 6.70411 4.65682 6.80309L3.2461 10.625C3.16506 10.8446 3.21909 11.0912 3.3845 11.2568C3.54991 11.4224 3.79651 11.4767 4.01616 11.3959L7.85031 9.98517C7.94979 9.94856 8.04014 9.89077 8.11508 9.81579L12.6552 5.27327C13.5618 4.36621 13.5618 2.89607 12.6551 1.98906ZM10.2177 2.83779C10.6562 2.39869 11.3677 2.39851 11.8064 2.8374C12.2447 3.27584 12.2447 3.9865 11.8065 4.42497L7.3392 8.89457L4.82213 9.82068L5.74706 7.31487L10.2177 2.83779Z",fillRule:M(783),clipRule:"evenodd"}},{tag:M(601),attrs:{fill:"currentColor",d:"M1.79238 13.2999C1.46101 13.2999 1.19238 13.5685 1.19238 13.8999C1.19238 14.2313 1.46101 14.4999 1.79238 14.4999H14.4924C14.8238 14.4999 15.0924 14.2313 15.0924 13.8999C15.0924 13.5685 14.8238 13.2999 14.4924 13.2999H1.79238Z"}}]},Wo=v0.forwardRef(function(t,e){const x=M;return v0.createElement(te,Object.assign({},t,{id:x(797),ref:e,icon:e4}))});Wo[M(750)]=M(602);const t4={tag:M(543),attrs:{xmlns:M(830),fill:M(440),viewBox:M(482),width:M(468),height:M(468)},children:[{tag:M(516),attrs:{cx:8,cy:8,r:8,fill:M(436)}},{tag:"path",attrs:{fill:M(692),d:M(823)}}]},Qo=v0.forwardRef(function(t,e){const x=M;return v0.createElement(te,Object[x(528)]({},t,{id:"point-color-double-icon",ref:e,icon:t4}))});Qo[M(750)]=M(743);function Zn({title:t,children:e,containerStyle:x}){const n=M,[r,s]=v0.useState(!1),i=()=>s(!r);return $.jsxs(n(796),{className:yx(n(591),W1),style:x,children:[$.jsxs(n(796),{className:n(598),onClick:i,children:[$.jsx(n(772),{className:n(444),children:r?$.jsx(ni,{}):$.jsx(Ho,{})}),t]}),r&&$.jsx(n(796),{className:n(827),children:e})]})}const zo=t=>{const e=M,{color:x,onChange:n}=t,[r,s]=v0.useState(!1),i=Px(jx),a=x===e(770)||x==null,o=v0.useCallback(d=>{n==null||n(d),s(!1)},[n]);return $.jsx(Va,{overlay:$.jsx(e(796),{className:yx("univer-flex univer-flex-col univer-items-center univer-gap-3 univer-p-3 univer-text-xs",Xt),children:$.jsx(ja,{value:a?e(716):x,onChange:o})}),open:r,onOpenChange:s,children:$.jsx(rt,{className:yx("univer-flex univer-w-full univer-rounded-lg !univer-bg-gray-50 univer-p-0 dark:!univer-bg-gray-900",Xt),children:$.jsxs(e(796),{className:e(544),children:[a?$.jsx(e(796),{className:e(583),children:i.t("sheets-sparkline.panel.default")}):$.jsx(e(796),{className:yx(e(600),Xt),style:{backgroundColor:x}}),$.jsx(ni,{className:yx(e(825),{"univer-rotate-180":r})})]})})})},n4=({config:t,ctx:e})=>{const x=M;var n,r,s,i,a,o,d,c,l,u,f,b,h,p,I,v,C,w,y,P;const E=Px(g0),S=Px(jx),T=Px(K0),{unitId:k,subUnitId:V,range:H}=e,D=n0=>{const O=Ix,W=R[O(741)](t);W.config||(W[O(489)]={}),W[O(489)][O(560)]&&delete W[O(489)][O(560)],W[O(489)][O(454)]||(W.config.axis={}),W[O(489)][O(454)][O(504)]=n0,E.executeCommand(_x.id,{config:W,isChangeDataSource:!1})},U=n0=>{const O=Ix,W=R.deepClone(t);W.config||(W[O(489)]={}),W.config[O(560)]&&delete W[O(489)][O(560)],W.config[O(454)]||(W[O(489)][O(454)]={}),W.config[O(454)][O(673)]=n0,E.executeCommand(_x.id,{config:W,isChangeDataSource:!1})},j=n0=>{const O=Ix,W=R[O(741)](t);W[O(489)]||(W[O(489)]={}),W[O(489)][O(560)]&&delete W[O(489)][O(560)],W.config[O(454)]||(W[O(489)][O(454)]={}),W[O(489)][O(454)].reverse=n0,E[O(667)](_x.id,{config:W,isChangeDataSource:!1})},F=(n0,O)=>{const W=Ix,o0=O===W(471)?W(694):W(554),r0=R[W(741)](t);r0.config||(r0[W(489)]={}),r0[W(489)][W(560)]&&delete r0[W(489)].type,r0[W(489)][o0]||(r0[W(489)][o0]={}),r0.config[o0][W(560)]=n0,E.executeCommand(_x.id,{config:r0,isChangeDataSource:!1})},z=(n0,O)=>{const W=Ix,o0=O===W(471)?W(694):"extremumMax",r0=R.deepClone(t);r0[W(489)]||(r0.config={}),r0[W(489)][W(560)]&&delete r0[W(489)][W(560)],r0.config[o0]||(r0[W(489)][o0]={}),r0[W(489)][o0][W(560)]=lx[W(728)],r0[W(489)][o0][W(472)]=n0,E.executeCommand(_x.id,{config:r0,isChangeDataSource:!1})},Q=(n0,O)=>{const W=Ix,o0=O===W(685)?W(524):W(669),r0=R[W(741)](t);r0[W(489)]||(r0.config={}),r0[W(489)][W(560)]&&delete r0[W(489)].type,r0[W(489)][o0]=n0,E.executeCommand(_x.id,{config:r0,isChangeDataSource:!1})},G=()=>{const n0=Ix,O=R[n0(741)](t);E[n0(667)](_x.id,{config:O,combine:!0})},Y=()=>{const n0=Ix,O=R[n0(741)](t);E.executeCommand(_x.id,{config:O,unCombine:!0})},t0=n0=>{const O=Ix,W=R[O(741)](t);W[O(489)]||(W[O(489)]={}),W[O(489)][O(560)]&&delete W[O(489)][O(560)],W[O(489)][O(490)]=n0,E[O(667)](_x.id,{config:W,isChangeDataSource:!1})},A=T[x(690)](),Z=(n=A==null?void 0:A.sparklineAnchorMap[x(834)](k))==null?void 0:n[x(834)](V);let J=!1,S0=!1;const I0=new Set,{startRow:l0,endRow:T0,startColumn:L0,endColumn:Q0}=H;for(let n0=l0;n0<=T0;n0++)for(let O=L0;O<=Q0;O++){const W=(r=Z==null?void 0:Z[x(508)][x(477)](n0,O))==null?void 0:r.groupId;W&&I0.add(W)}if(I0[x(579)]>1)J=!0,Array[x(719)](I0)[x(810)](n0=>{const O=x;var W,o0,r0;const m0=(o0=(W=A[O(459)][O(834)](k))==null?void 0:W.get(V))==null?void 0:o0.get(n0);((r0=m0==null?void 0:m0.sparklines[O(837)]().length)!=null?r0:0)>1&&(S0=!0)});else if(I0.size===1){const n0=Array[x(719)](I0)[0],O=(i=(s=A.sparklineModel[x(834)](k))==null?void 0:s[x(834)](V))==null?void 0:i.get(n0);S0=((a=O==null?void 0:O[x(835)][x(837)]()[x(523)])!=null?a:0)>1;let W=0,o0=0;O==null||O[x(835)][x(839)]((r0,m0)=>{const a0=Gx(r0,m0);x0.intersects(a0,H)?W++:o0++}),J=o0>0&&W>1}return $.jsxs(x(796),{children:[$.jsx(Zn,{title:S.t(x(849)),children:$.jsxs(x(796),{className:x(439),children:[$.jsxs(rt,{disabled:!J,onClick:()=>G(),children:[$.jsx(Lo,{}),S.t(x(522))]}),$.jsxs(rt,{disabled:!S0,onClick:()=>Y(),children:[$.jsx(Go,{}),S.t(x(779))]})]})}),$.jsxs(Zn,{title:S.t(x(747)),children:[$.jsx("div",{className:"univer-mb-2 univer-text-sm",children:$.jsx(qt,{checked:(o=t.config[x(454)])==null?void 0:o[x(504)],onChange:n0=>D(n0),children:S.t(x(784))})}),((d=t[x(489)][x(454)])==null?void 0:d[x(504)])&&$.jsxs(x(796),{className:x(769),children:[$.jsx("div",{className:x(769),children:S.t(x(589))}),$.jsx(zo,{color:(l=(c=t[x(489)][x(454)])==null?void 0:c.color)!=null?l:x(535),onChange:n0=>U(n0)})]}),$.jsx(x(796),{className:x(829),children:$.jsx(qt,{checked:(u=t[x(489)][x(454)])==null?void 0:u[x(505)],onChange:n0=>j(n0),children:S.t(x(634))})})]}),$.jsx(Zn,{title:S.t(x(745)),children:$.jsxs("div",{children:[$.jsx(x(796),{className:x(443),children:S.t(x(464))}),$.jsxs(gi,{value:(b=(f=t[x(489)][x(694)])==null?void 0:f.type)!=null?b:lx[x(696)],className:x(626),onChange:n0=>F(n0,x(471)),children:[$.jsx(ut,{value:lx[x(696)],children:S.t(x(759))}),$.jsx(ut,{value:lx[x(484)],children:S.t(x(517))}),$.jsx(ut,{value:lx.CUSTOM_EXTREMUM,children:$.jsxs(x(796),{className:x(746),children:[$.jsx(x(796),{children:S.t(x(739))}),$.jsx(vi,{disabled:((h=t[x(489)].extremumMin)==null?void 0:h[x(560)])!==lx[x(728)],value:(p=t[x(489)][x(694)])==null?void 0:p.value,onChange:n0=>{const O=x;typeof n0==O(831)&&z(n0,O(471))},className:"univer-ml-3 univer-h-6 univer-w-14"})]})})]}),$.jsx("br",{}),$.jsx("div",{className:"univer-mx-0 univer-my-2 univer-text-sm univer-text-gray-500",children:S.t("sheets-sparkline.panel.max")}),$.jsxs(gi,{value:(v=(I=t[x(489)].extremumMax)==null?void 0:I[x(560)])!=null?v:lx[x(696)],className:x(626),onChange:n0=>F(n0,x(680)),children:[$.jsx(ut,{value:lx[x(696)],children:S.t(x(446))}),$.jsx(ut,{value:lx.GROUP_EXTREMUM,children:S.t("sheets-sparkline.panel.groupMax")}),$.jsx(ut,{value:lx.CUSTOM_EXTREMUM,children:$.jsxs(x(796),{className:x(746),children:[$.jsx("div",{children:S.t(x(481))}),$.jsx(vi,{disabled:((C=t[x(489)][x(554)])==null?void 0:C[x(560)])!==lx[x(728)],value:(w=t[x(489)].extremumMax)==null?void 0:w.value,onChange:n0=>{const O=x;typeof n0==O(831)&&z(n0,O(680))},className:x(450)})]})})]})]})}),$.jsxs(Zn,{title:S.t("sheets-sparkline.panel.moreSetting"),containerStyle:{border:x(440)},children:[$.jsx(qt,{checked:t.config[x(490)],onChange:n0=>t0(n0),children:S.t("sheets-sparkline.panel.showHidden")}),$.jsxs(x(796),{className:"univer-mt-3",children:[$.jsx(x(796),{className:x(584),children:S.t(x(776))}),$.jsx(u2,{className:x(592),value:(y=t[x(489)][x(524)])!=null?y:Tx[x(832)],options:[{label:S.t("sheets-sparkline.panel.spacing"),value:Tx[x(832)]},{label:S.t(x(807)),value:Tx.ZERO_VALUE},{label:S.t(x(648)),value:Tx[x(616)]}],onChange:n0=>Q(n0,x(685))})]}),$.jsxs(x(796),{className:"univer-mt-3",children:[$.jsx("div",{className:x(584),children:S.t("sheets-sparkline.panel.showNonNumAs")}),$.jsx(u2,{className:"univer-flex univer-h-8 univer-w-full univer-items-center univer-rounded-lg univer-bg-gray-50 dark:!univer-bg-gray-900",value:(P=t[x(489)][x(669)])!=null?P:Tx[x(832)],options:[{label:S.t(x(855)),value:Tx[x(832)]},{label:S.t("sheets-sparkline.panel.zeroValue"),value:Tx.ZERO_VALUE},{label:S.t(x(648)),value:Tx[x(616)]}],onChange:n0=>Q(n0,x(842))})]})]})]})},_t=t=>{const e=M;var x,n;const{onCheckboxChange:r,onColorChange:s,type:i,text:a,config:o,chartType:d}=t,c=Zx[e(749)][1],l=v0.useMemo(()=>new Vs(c).toHexString(),[c]),u=i==="markersPoint"&&d!==cx[e(595)],f=(x=o==null?void 0:o[e(673)])!=null?x:c,b=new Vs(f)[e(549)]();return $.jsxs(e(796),{className:yx(e(475)),children:[$.jsx(qt,{checked:o==null?void 0:o[e(504)],disabled:u,onChange:h=>r(h,i),children:a}),(o==null?void 0:o[e(504)])&&$.jsx(Va,{overlay:$.jsx(e(796),{className:e(449),children:$.jsx(ja,{value:(n=o==null?void 0:o[e(673)])!=null?n:l,onChange:h=>s(h,i)})}),children:$.jsx(Qo,{className:yx("univer-mr-0.5 univer-mt-0.5",{"univer-text-white":b}),extend:{colorChannel1:f}})})]})},s4=({config:t,ctx:e})=>{const x=M;var n,r,s,i,a,o,d,c,l;const u=Px(g0),f=Px(Vx),b=Px(jx),h=Px(K0),p=(n=t==null?void 0:t[x(489)].type)!=null?n:cx[x(595)],I=p===cx[x(595)],v=D=>{const U=x;var j;const F=(j=R.deepClone(t))!=null?j:{};F!=null&&F.config||(F[U(489)]={}),F[U(489)][U(560)]=D,u[U(667)](_x.id,{config:F,isChangeDataSource:!1})},C=(D,U)=>{const j=x;var F,z;const Q=(F=R[j(741)](t))!=null?F:{};Q!=null&&Q[j(489)]||(Q[j(489)]={}),Q[j(489)].type&&delete Q[j(489)].type,Q!=null&&Q[j(489)].points||(Q[j(489)][j(650)]={}),(z=Q==null?void 0:Q[j(489)].points)!=null&&z[U]||(Q.config[j(650)][U]={}),Q.config[j(650)][U].visible=D,u[j(667)](_x.id,{config:Q,isChangeDataSource:!1})},w=(D,U)=>{const j=x;var F,z;const Q=(F=R.deepClone(t))!=null?F:{};Q!=null&&Q[j(489)]||(Q[j(489)]={}),Q[j(489)][j(560)]&&delete Q[j(489)][j(560)],Q!=null&&Q[j(489)][j(650)]||(Q[j(489)][j(650)]={}),(z=Q==null?void 0:Q[j(489)][j(650)])!=null&&z[U]||(Q.config[j(650)][U]={}),Q[j(489)].points[U][j(673)]=D,Q.config.themeType=Ae[j(558)],u[j(667)](_x.id,{config:Q,isChangeDataSource:!1})},y=D=>{const U=x;var j;const F=(j=R[U(741)](t))!=null?j:{};F!=null&&F[U(489)]||(F[U(489)]={}),F[U(489)][U(560)]&&delete F[U(489)].type,F[U(489)].themeType=D,F[U(489)].seriesColor!=null&&(F[U(489)][U(573)]=void 0),F!=null&&F[U(489)][U(650)]||(F.config[U(650)]={});const z=Zx[D];hh[U(810)](Q=>{const G=U;var Y;(Y=F==null?void 0:F[G(489)][G(650)])!=null&&Y[Q]?F[G(489)][G(650)][Q][G(673)]=z[1]:F[G(489)].points[Q]={color:z[1]}}),u[U(667)](_x.id,{config:F,isChangeDataSource:!1})},P=D=>{const U=x;var j;const F=(j=R[U(741)](t))!=null?j:{};F!=null&&F.config||(F[U(489)]={}),F[U(489)].type&&delete F[U(489)][U(560)],F[U(489)][U(573)]=D,F[U(489)][U(632)]=Ae[U(558)],u[U(667)](_x.id,{config:F,isChangeDataSource:!1})},E=D=>{const U=x;var j;const F=(j=R.deepClone(t))!=null?j:{};F!=null&&F[U(489)]||(F[U(489)]={}),F[U(489)][U(560)]&&delete F.config.type;const z=Number[U(447)](D,10);F[U(489)][U(766)]=z,u[U(667)](_x.id,{config:F,isChangeDataSource:!1})},S=D=>{const U=x;var j;const F=(j=R[U(741)](t))!=null?j:{};F!=null&&F.config||(F.config={}),F[U(489)][U(560)]&&delete F[U(489)][U(560)],I?F[U(489)][U(795)]=D:F[U(489)][U(806)]=D,u.executeCommand(_x.id,{config:F,isChangeDataSource:!1})},T=D=>{u[x(667)](nt.id,{isIcon:D})},k=new Set([e.groupId]),V=e[x(480)];for(let D=V[x(507)];D<=V[x(805)];D++)for(let U=V[x(736)];U<=V.endColumn;U++){const j=h[x(792)](e.unitId,e[x(654)],D,U);if(j&&(k[x(689)](j),k[x(579)]>1))break}const H=async()=>{if(k.size>1)return;const{primary:D,range:U,groupId:j}=e;if(!await Ao(f,[U],void 0,{groupId:j,primary:R.deepClone(D)}))return!1};return $.jsxs(x(796),{children:[$.jsxs(x(796),{className:x(628),children:[$.jsx(x(796),{className:x(826),children:b.t(x(664))}),$.jsx(x(796),{className:yx(x(684),{"univer-cursor-not-allowed":k[x(579)]>1}),onClick:H,children:$.jsx(Wo,{})})]}),$.jsxs(x(796),{children:[$.jsx(x(796),{className:x(493),children:b.t(x(537))}),$.jsx("div",{className:x(754),children:$.jsxs(x(796),{className:yx(x(851),Xt),children:[$.jsxs(x(796),{className:yx("univer-m-0.5 univer-flex univer-h-8 univer-flex-1 univer-cursor-pointer univer-items-center univer-justify-center univer-rounded-sm univer-text-center univer-leading-8",{"univer-bg-gray-100 dark:!univer-bg-gray-700":p===cx[x(595)]}),onClick:()=>v(cx.LINE_CHART),children:[$.jsx(ti,{}),b.t(x(618))]}),$.jsxs(x(796),{className:yx(x(559),{"univer-bg-gray-100 dark:!univer-bg-gray-700":p===cx[x(607)]}),onClick:()=>v(cx.BAR_CHART),children:[$.jsx(jo,{}),b.t(x(813))]}),$.jsxs(x(796),{className:yx(x(559),{"univer-bg-gray-100 dark:!univer-bg-gray-700":p===cx[x(521)]}),onClick:()=>v(cx[x(521)]),children:[$.jsx(Yo,{}),b.t(x(733))]}),$.jsxs(x(796),{className:yx(x(559),{"univer-bg-gray-100 dark:!univer-bg-gray-700":p===cx[x(596)]}),onClick:()=>v(cx.PIE_CHART),children:[$.jsx(Bo,{}),b.t(x(526))]})]})})]}),t[x(489)].type!==cx[x(596)]&&$.jsxs($.Fragment,{children:[$.jsxs("div",{children:[$.jsx(x(796),{className:x(493),children:b.t(x(599))}),$.jsx(x(796),{className:x(754),children:$.jsx(u2,{className:x(462),value:b.t("sheets-sparkline.panel."+((r=t==null?void 0:t[x(489)].themeType)!=null?r:Ae[x(461)])),options:Object.keys(Zx)[x(483)](D=>{const U=x,j=Zx[D];return{label:$.jsxs(U(796),{className:U(746),children:[$.jsx(U(796),{className:U(688),style:{background:j[0]}}),$.jsx(U(796),{className:U(715),style:{background:j[1]}}),$.jsx("div",{children:b.t(U(499)+D)})]}),value:D}}),onChange:D=>y(D)})})]}),$.jsxs(x(796),{children:[$.jsx(x(796),{className:"univer-mb-3 univer-text-sm univer-font-medium",children:b.t(x(431))}),$.jsxs(x(796),{className:x(754),children:[$.jsxs(x(796),{className:x(557),children:[$.jsxs(x(796),{className:"univer-flex-1",children:[$.jsx(x(796),{className:x(769),children:b.t("sheets-sparkline.panel.sparklineColor")}),$.jsx(zo,{color:(s=t==null?void 0:t[x(489)].seriesColor)!=null?s:"transparent",onChange:P})]}),p===cx.LINE_CHART&&$.jsxs(x(796),{className:x(856),children:[$.jsx("div",{className:x(769),children:b.t(x(761))}),$.jsx(u2,{className:x(462),value:t!=null&&t[x(489)][x(766)]?t[x(489)].lineWidth+"px":"2px",options:[{value:x(606),label:x(606)},{value:"2px",label:x(738)},{value:x(637),label:x(637)},{value:"4px",label:x(852)}],onChange:D=>E(D)})]})]}),$.jsx(qt,{className:x(550),checked:I?t==null?void 0:t.config.showGradient:t==null?void 0:t[x(489)][x(806)],onChange:D=>S(D),children:I?b.t("sheets-sparkline.panel.gradient"):b.t("sheets-sparkline.panel.radius")})]})]}),$.jsxs(x(796),{children:[$.jsx("div",{className:x(493),children:b.t(x(551))}),$.jsxs("div",{className:x(754),children:[$.jsxs("div",{className:x(603),children:[$.jsx(_t,{onCheckboxChange:C,onColorChange:w,chartType:p,type:x(527),text:b.t(x(787)),config:(i=t==null?void 0:t[x(489)][x(650)])==null?void 0:i[x(527)]},x(527)),$.jsx(_t,{onCheckboxChange:C,onColorChange:w,chartType:p,type:x(786),text:b.t("sheets-sparkline.panel.firstPoint"),config:(a=t==null?void 0:t[x(489)][x(650)])==null?void 0:a.firstPoint},x(786))]}),$.jsxs(x(796),{className:x(603),children:[$.jsx(_t,{onCheckboxChange:C,onColorChange:w,chartType:p,type:"lowPoint",text:b.t("sheets-sparkline.panel.lowPoint"),config:(o=t==null?void 0:t.config[x(650)])==null?void 0:o[x(465)]},"lowPoint"),$.jsx(_t,{onCheckboxChange:C,onColorChange:w,chartType:p,type:x(771),text:b.t(x(710)),config:(d=t==null?void 0:t[x(489)][x(650)])==null?void 0:d[x(771)]},x(771))]}),$.jsxs(x(796),{className:x(603),children:[$.jsx(_t,{onCheckboxChange:C,onColorChange:w,chartType:p,type:"negativePoint",text:b.t(x(785)),config:(c=t==null?void 0:t[x(489)][x(650)])==null?void 0:c[x(630)]},x(630)),$.jsx(_t,{onCheckboxChange:C,onColorChange:w,chartType:p,type:x(674),text:b.t("sheets-sparkline.panel.markersPoint"),config:(l=t==null?void 0:t[x(489)].points)==null?void 0:l[x(674)]},x(674))]})]})]})]}),t[x(489)][x(560)]===cx[x(596)]&&$.jsx(x(796),{className:x(493),children:b.t(x(641))}),$.jsxs(x(796),{className:"univer-flex univer-justify-between",children:[$.jsxs(rt,{onClick:()=>T(!0),children:[$.jsx(Ir,{}),b.t(x(485))]}),$.jsxs(rt,{onClick:()=>T(!1),children:[$.jsx(Ir,{}),b.t("sheets-sparkline.panel.removeGroup")]})]})]})},r4=()=>{const t=M;var e,x,n,r;const s=Px(Se),i=$1(s[t(597)]),a=Px(K0),o=Px(N0),d=Px(jx),c=ax(o),[l,u]=v0.useState(t(814)),f=l===t(814),[,b]=v0.useState(Math.random());if(v0.useEffect(()=>{const S=t,T=a[S(675)][S(474)](()=>{b(Math.random())});return()=>{T[S(729)]()}},[a[t(675)]]),!c)return null;const{unitId:h,subUnitId:p}=c;if(!i||i.length>1)return null;const{primary:I,range:v}=i[0];if(!I||!v)return null;const C=a[t(690)](),w=(e=C==null?void 0:C[t(718)].get(h))==null?void 0:e[t(834)](p),y=(x=w==null?void 0:w[t(508)][t(477)](I[t(763)],I[t(726)]))==null?void 0:x[t(697)];if(!y)return null;const P=(r=(n=C[t(459)].get(h))==null?void 0:n[t(834)](p))==null?void 0:r.get(y);if(!P)return null;const E={unitId:h,subUnitId:p,range:v,primary:I,groupId:y};return $.jsxs("div",{className:t(538),children:[$.jsxs("div",{className:t(707),children:[$.jsxs(t(796),{className:yx(t(497),{"univer-text-primary-600":f}),children:[$.jsx(t(796),{onClick:()=>u(t(814)),children:d.t(t(435))}),f&&$.jsx(t(796),{className:t(647)})]}),$.jsxs("div",{className:yx("univer-relative univer-flex univer-h-full univer-cursor-pointer univer-flex-col univer-font-medium univer-leading-7",{"univer-text-primary-600":!f,"univer-cursor-not-allowed univer-text-gray-200":P.config.type===cx[t(596)]}),children:[$.jsx(t(796),{onClick:()=>{const S=t;P[S(489)][S(560)]!==cx[S(596)]&&u(S(663))},children:d.t(t(563))}),!f&&$.jsx(t(796),{className:"univer-bg-pruniver-text-primary-600 univer-absolute univer-bottom-0 univer-h-0.5 univer-w-full univer-rounded-sm univer-transition-transform univer-duration-300 univer-ease-in-out"})]})]}),$.jsx("div",{children:f?$.jsx(s4,{config:P,ctx:E}):$.jsx(n4,{config:P,ctx:E})})]})};function i4(t,e,x){const n=M;if(!x)return!0;if(e.length!==x[n(523)])if(x[n(523)]===1){const s=x[0];if(s[n(507)]!==s[n(805)]&&s[n(736)]!==s[n(639)])return!1}else return!1;if(t===n(815)){if(x[n(523)]!==1)return!1;const{startRow:s,startColumn:i,endRow:a,endColumn:o}=x[0];if(s!==a&&i!==o)return!1}if(x[n(523)]>1){if(x.some(s=>{const{startRow:i,startColumn:a,endRow:o,endColumn:d}=s;return i!==o||a!==d}))return!1}else{const s=x[0],{startRow:i,startColumn:a,endRow:o,endColumn:d}=s;if(i!==o&&a!==d)return!1}let r=0;for(const s of x)r+=(s[n(805)]-s[n(507)]+1)*(s[n(639)]-s[n(736)]+1);if(e[n(523)]>1){for(const s of e){const{startColumn:i,startRow:a,endRow:o,endColumn:d}=s;if(i!==d&&a!==o)return!1}for(const s of x){const{startColumn:i,startRow:a,endRow:o,endColumn:d}=s;if(i!==d&&a!==o)return!1}return!0}else{const s=e[0].endRow-e[0][n(507)]+1,i=e[0][n(639)]-e[0][n(736)]+1;return r===s||r===i}}const a4={cellSourceRanges:[],cellTargetRanges:[],groupSourceRanges:[],groupTargetRanges:[]},o4=(t,e,x)=>{const n=M;var r,s,i,a,o,d;if(!e||!x)return a4;const c=t[n(834)](N0),l=t[n(834)](K0),u=ax(c);if(!u)return;const{unitId:f,subUnitId:b}=u,{actualRow:h,actualColumn:p}=e,I=(i=(s=(r=l[n(690)]()[n(459)][n(834)](f))==null?void 0:r[n(834)](b))==null?void 0:s[n(834)](x))==null?void 0:i.sparklines.getValue(h,p);if(!I)return;const v=[I],C=[Gx(h,p)],w=[],y=[],P=(d=(o=(a=l[n(690)]()[n(459)][n(834)](f))==null?void 0:a.get(b))==null?void 0:o[n(834)](x))==null?void 0:d[n(835)];return P==null||P[n(839)]((E,S,T)=>{const k=n,V=T;w.push(V),y[k(722)](Gx(E,S))}),{cellSourceRanges:v,cellTargetRanges:C,groupSourceRanges:w,groupTargetRanges:y}};function d4(t){const e=M,{sourceRanges:x,targetRanges:n,onConfirm:r,onCancel:s,resetCtx:i}=t,a=Px(N0),o=Px(g0),d=Px(K0),c=Px(jx),l=Px(Vx),[u,f]=v0.useState(),[b,h]=v0.useState(),[p,I]=v0.useState(e(i?815:440)),v=v0.useMemo(()=>o4(l,i==null?void 0:i[e(798)],i==null?void 0:i[e(697)]),[l,i==null?void 0:i[e(697)],i==null?void 0:i[e(798)]]),{cellSourceRanges:C,cellTargetRanges:w,groupSourceRanges:y,groupTargetRanges:P}=v??{},[E,S]=v0.useState(i?C:x),[T,k]=v0.useState(i?w:n),V=Px(is),H=v0.useRef(null);v0.useEffect(()=>{const Y=e;(E==null?void 0:E.length)===0&&f(void 0),(T==null?void 0:T[Y(523)])===0&&h(void 0);const t0=i4(p,E,T);h(t0?void 0:c.t(Y(627)))},[c,p,E,T]);const D=Y=>{const t0=e;I(Y),S(Y===t0(815)?v==null?void 0:v[t0(734)]:v==null?void 0:v[t0(781)]),k(Y===t0(815)?v==null?void 0:v[t0(546)]:v==null?void 0:v[t0(809)])},{initSourceRangeStr:U,initTargetRangeStr:j}=v0.useMemo(()=>{const Y=e;var t0,A;let Z,J;i?(Z=p===Y(815)?C:y,J=p==="item"?w:P):(Z=x,J=n);const S0=(t0=Z==null?void 0:Z[Y(483)](l0=>{const T0=Y;if(!Jt(l0))return f(c.t(T0(627))),T0(817);const L0=l2(l0);return L0===T0(645)?"":L0})[Y(588)](l0=>!!l0)[Y(547)](","))!=null?t0:"",I0=(A=J==null?void 0:J[Y(483)](l0=>{const T0=Y,L0=l2(l0);return L0===T0(645)?"":L0})[Y(588)](l0=>!!l0)[Y(547)](","))!=null?A:"";return{initSourceRangeStr:S0,initTargetRangeStr:I0}},[C,w,y,P,c,x,n,i,p]),F=ax(a);if(!F)return null;const{unitId:z,subUnitId:Q,worksheet:G}=F;return $.jsxs(e(796),{ref:H,children:[!!i&&$.jsxs($.Fragment,{children:[$.jsx(e(796),{className:"univer-mb-2 univer-text-sm",children:c.t(e(539))}),$.jsxs(e(796),{className:yx(e(574),Xt),children:[$.jsx(e(796),{className:yx("univer-h-7 univer-flex-1 univer-cursor-pointer univer-rounded-sm univer-text-center univer-text-sm univer-leading-7",{"univer-bg-blue-200 univer-scrollbar-corner-primary-600":p===e(815)}),onClick:()=>D("item"),children:c.t(e(740))}),$.jsx(e(796),{className:yx(e(624),{"univer-bg-blue-200 univer-scrollbar-corner-primary-600":p===e(561)}),onClick:()=>D(e(561)),children:c.t(e(491))})]})]}),$.jsxs(e(796),{className:"univer-mb-4",children:[$.jsx(e(796),{className:e(584),children:c.t(e(672))}),$.jsx(Ci,{unitId:z,subUnitId:Q,initialValue:U,onChange:(Y,t0)=>{const A=e,Z=t0[A(479)](",").map(ui)[A(483)](J=>Rx.transformRange(J[A(480)],G));if(!Z[A(845)](J=>!Jt(J)||J.endColumn<J.startColumn||J[A(805)]<J[A(507)])){if(Z[A(523)]>1){if(p===A(815)){f(c.t(A(721)));return}const J=Z[A(845)](S0=>{const{startRow:I0,endRow:l0,startColumn:T0,endColumn:L0}=S0;return I0!==l0&&T0!==L0});f(J?c.t(A(838)):void 0),J||S(Z);return}else{const{startRow:J,endRow:S0,startColumn:I0,endColumn:l0}=Z[0];if(p===A(815)&&J!==S0&&I0!==l0){f(c.t("sheets-sparkline.selector.resetSourceError"));return}}f(void 0),S(Z)}},supportAcrossSheet:!1},U),u?$.jsx(e(796),{className:"univer-text-xs univer-text-red-500",children:u}):null]}),$.jsxs("div",{className:e(711),children:[$.jsx("div",{className:e(584),children:c.t(e(742))}),$.jsx(Ci,{unitId:z,subUnitId:Q,initialValue:j,onChange:(Y,t0)=>{const A=e,Z=t0[A(479)](",")[A(483)](ui)[A(483)](J=>J.range);Z[A(845)](J=>!Jt(J)||J.endColumn<J.startColumn||J[A(805)]<J.startRow)||k(Z)},supportAcrossSheet:!1},j),b?$.jsx(e(796),{className:"univer-text-xs univer-text-red-500",children:b}):null]}),$.jsxs(e(796),{className:e(671),children:[$.jsx(rt,{onClick:()=>{V.close(Ut)},children:c.t(e(533))}),$.jsx(rt,{variant:"primary",onClick:()=>{const Y=e;var t0,A;if(E&&T&&!u&&!b)if(i){const Z=(A=(t0=d[Y(690)]()[Y(459)][Y(834)](z))==null?void 0:t0[Y(834)](Q))==null?void 0:A.get(i.groupId);o[Y(667)](_x.id,{config:Z,isChangeDataSource:!0,changeDataSourceInfo:{sourceRanges:E,targetRanges:T,groupId:i[Y(697)],resetType:p,primary:i[Y(798)]}}),s()}else r({sourceRanges:E,targetRanges:T})},disabled:!!(u||b),children:c.t(e(548))})]})]})}function G2(){const t=["addClipboardHook","white","M11.3536 6.14645C11.5488 6.34171 11.5488 6.65829 11.3536 6.85355L8.35355 9.85355C8.15829 10.0488 7.84171 10.0488 7.64645 9.85355L4.64645 6.85355C4.45118 6.65829 4.45118 6.34171 4.64645 6.14645C4.84171 5.95118 5.15829 5.95118 5.35355 6.14645L8 8.79289L10.6464 6.14645C10.8417 5.95118 11.1583 5.95118 11.3536 6.14645Z","246585UzatBI","circle","sheets-sparkline.panel.groupMin","_sheetsSelectionsService","SHEET_SPARKLINE_PANEL","save","PROFIT_AND_LOSS_CHART","sheets-sparkline.panel.compose","length","emptyShowAs","getSizeOf","sheets-sparkline.panel.pie","highPoint","assign","Edit","ONLY_FORMAT","mergeMenu","fillStyle","sheets-sparkline.selector.cancel","_renderManagerService","#000","1681328dIEeqk","sheets-sparkline.panel.type","univer-max-w-[290px] univer-pb-4 univer-text-gray-900 dark:!univer-text-white","sheets-sparkline.selector.changeType","clone","interceptor","reduce","svg","univer-box-border univer-flex univer-h-8 univer-w-full univer-flex-1 univer-items-center univer-justify-between univer-p-3 univer-leading-8","_initSelectionMove","cellTargetRanges","join","sheets-sparkline.selector.confirm","isDark","univer-mt-2","sheets-sparkline.panel.marker","M1.93072 10.1835L1.93106 10.1799L1.93238 10.1666L1.93813 10.1111C1.94338 10.0618 1.95153 9.98842 1.96289 9.89446C1.98561 9.70646 2.02113 9.43651 2.07197 9.11205C2.17396 8.46117 2.3362 7.60002 2.57751 6.74447C2.82117 5.88055 3.13443 5.06289 3.52207 4.47386C3.91655 3.87444 4.30029 3.63604 4.6667 3.63604C5.20279 3.63604 5.59094 3.79262 5.89245 4.03213C6.20445 4.27998 6.45611 4.64319 6.66114 5.09919C7.01279 5.88128 7.17707 6.8062 7.32445 7.63596C7.35331 7.79845 7.38152 7.95729 7.41037 8.1107C7.5826 9.0267 7.93167 10.342 8.56261 11.4445C9.18786 12.5371 10.18 13.5636 11.6667 13.5636C12.5868 13.5636 13.2216 12.8668 13.6371 12.1596C14.0698 11.4232 14.3885 10.4735 14.6226 9.56823C14.8589 8.65445 15.0188 7.74576 15.1195 7.06881C15.1701 6.72945 15.206 6.44627 15.2294 6.24721C15.2411 6.14764 15.2497 6.069 15.2554 6.01477L15.2618 5.95213L15.2634 5.93533L15.264 5.92935C15.264 5.9292 15.2641 5.92865 14.6667 5.87248L15.264 5.92935C15.295 5.59943 15.0528 5.30614 14.7229 5.27512C14.393 5.2441 14.1004 5.48635 14.0693 5.81621C14.0694 5.81618 14.0693 5.81625 14.0693 5.81621L14.069 5.81992L14.0677 5.83353L14.0619 5.88948C14.0567 5.93912 14.0487 6.01283 14.0376 6.10715C14.0154 6.29588 13.9811 6.5667 13.9326 6.89213C13.8355 7.54477 13.6829 8.40886 13.4608 9.26786C13.2365 10.1353 12.9511 10.9584 12.6025 11.5517C12.2368 12.174 11.9132 12.3636 11.6667 12.3636C10.82 12.3636 10.1455 11.7946 9.60413 10.8485C9.0684 9.91233 8.7508 8.74572 8.5897 7.88895C8.56536 7.75946 8.54044 7.61783 8.51388 7.46683C8.36895 6.64284 8.1749 5.53963 7.7556 4.60708C7.50229 4.04373 7.14979 3.49839 6.63887 3.09252C6.11746 2.67833 5.46395 2.43604 4.6667 2.43604C3.69978 2.43604 3.00019 3.08402 2.51967 3.81418C2.03231 4.55474 1.6789 5.50986 1.42256 6.41872C1.16387 7.33596 0.99278 8.24759 0.886434 8.92629C0.833107 9.26662 0.795708 9.55066 0.771558 9.75046C0.759477 9.8504 0.750696 9.92939 0.744883 9.98395L0.738344 10.0471L0.736664 10.0641L0.736208 10.0688L0.736074 10.0702C0.736059 10.0704 0.736002 10.071 1.33337 10.1272L0.736074 10.0702C0.705057 10.4002 0.947291 10.6935 1.27721 10.7245C1.60708 10.7555 1.89964 10.5133 1.93072 10.1835Z","getMatrix","extremumMax","M4.75332 5.22217C3.86966 5.22217 3.15332 5.93851 3.15332 6.82217V12.5331C3.15332 13.9691 4.31738 15.1332 5.75332 15.1332H10.2465C11.6825 15.1332 12.8465 13.9691 12.8465 12.5331V6.82217C12.8465 5.93851 12.1302 5.22217 11.2465 5.22217H4.75332ZM4.35332 6.82217C4.35332 6.60125 4.53241 6.42217 4.75332 6.42217H11.2465C11.4674 6.42217 11.6465 6.60125 11.6465 6.82217V12.5331C11.6465 13.3063 11.0197 13.9332 10.2465 13.9332H5.75332C4.98012 13.9332 4.35332 13.3063 4.35332 12.5331V6.82217Z","removeShape","univer-flex univer-gap-5","CUSTOM","univer-m-0.5 univer-flex univer-h-8 univer-flex-1 univer-cursor-pointer univer-items-center univer-justify-center univer-rounded-sm univer-text-center univer-leading-8","type","group","#49B811","sheets-sparkline.panel.advanced","UNIVER_SHEET","_initWorksheetChange","cols","UniverIcon","string","menu","closePath","_initSkeleton","pipe","seriesColor","univer-mb-4 univer-box-content univer-flex univer-h-7 univer-w-full univer-rounded-sm univer-p-0.5","M6.12398 8.30171C6.35829 8.0674 6.73819 8.0674 6.97251 8.30171L8.00007 9.32928L9.02764 8.30171C9.26195 8.0674 9.64185 8.0674 9.87617 8.30171C10.1105 8.53603 10.1105 8.91593 9.87617 9.15024L8.8486 10.1778L9.87617 11.2054C10.1105 11.4397 10.1105 11.8196 9.87617 12.0539C9.64185 12.2882 9.26195 12.2882 9.02764 12.0539L8.00007 11.0263L6.97251 12.0539C6.73819 12.2882 6.35829 12.2882 6.12398 12.0539C5.88966 11.8196 5.88966 11.4397 6.12398 11.2054L7.15154 10.1778L6.12398 9.15024C5.88966 8.91593 5.88966 8.53603 6.12398 8.30171Z","lineJoin","SHEET_SPARKLINE_MENU","getRowVisible","size","LEFT","abs","DeleteIcon","univer-truncate univer-text-sm univer-leading-tight univer-text-gray-900 dark:!univer-text-white","univer-mb-2 univer-text-sm univer-text-gray-800 dark:!univer-text-gray-100","keys","contains","ungroup-sparkline-icon","filter","sheets-sparkline.panel.axisColor","_context","univer-px-0 univer-py-2.5","univer-flex univer-h-8 univer-w-full univer-items-center univer-rounded-lg univer-bg-gray-50 dark:!univer-bg-gray-900","OPERATION","SHEET_SPARKLINE_UI_PLUGIN","LINE_CHART","PIE_CHART","selectionMoveEnd$","univer-flex univer-cursor-pointer univer-items-center univer-px-0 univer-py-1.5 univer-text-sm univer-font-medium","sheets-sparkline.panel.theme","univer-size-5","path","WriteIcon","univer-mb-2 univer-flex univer-w-full univer-justify-between","DEFAULT_PASTE","current","1px","BAR_CHART","getUnitId","params","getCurrentSelections","random","_dialogService","open","worksheet","_injector","CONNECT_WITH_LINE","entries","sheets-sparkline.panel.line","_targetIds","603gVkses","beginPath","_sidebarService","values","univer-h-7 univer-flex-1 univer-cursor-pointer univer-rounded-sm univer-text-center univer-text-sm univer-leading-7","getCurrentTypeOfUnit$","univer-flex univer-flex-col","sheets-sparkline.selector.targetError","univer-mb-3 univer-flex univer-items-center univer-justify-between","_markSelectionService","negativePoint","rows","themeType","#f00c0c","sheets-sparkline.panel.reverse","extra","onRendered","3px","M1.09985 3.64443C1.09985 3.31306 1.36848 3.04443 1.69985 3.04443H14.2999C14.6312 3.04443 14.8999 3.31306 14.8999 3.64443C14.8999 3.9758 14.6312 4.24443 14.2999 4.24443H1.69985C1.36848 4.24443 1.09985 3.9758 1.09985 3.64443Z","endColumn","dispose","sheets-sparkline.panel.manager","url(#$1","close","trim","NaN","_sheetClipboardService","univer-absolute univer-bottom-0 univer-h-0.5 univer-w-full univer-rounded-sm univer-bg-primary-600 univer-transition-transform univer-duration-300 univer-ease-in-out","sheets-sparkline.panel.connectWithLine","SERIES","points","onStarting","equals","_initRegisterCommand","subUnitId","UngroupSparklineIcon","ungroup-sparkline-icon_clip0_1729_95","getSheetId","arc","pasteType","more-right-icon","M7.4999 1.31738C6.61625 1.31738 5.8999 2.03373 5.8999 2.91738V6.91738C5.8999 7.80104 6.61625 8.51738 7.4999 8.51738H8.4999C9.38356 8.51738 10.0999 7.80104 10.0999 6.91738V2.91738C10.0999 2.03373 9.38356 1.31738 8.4999 1.31738H7.4999ZM7.0999 2.91738C7.0999 2.69647 7.27899 2.51738 7.4999 2.51738H8.4999C8.72082 2.51738 8.8999 2.69647 8.8999 2.91738V6.91738C8.8999 7.1383 8.72082 7.31738 8.4999 7.31738H7.4999C7.27899 7.31738 7.0999 7.1383 7.0999 6.91738V2.91738Z","getDataRange","advanced","sheets-sparkline.panel.sourceAndPosition","addColorStop","makeDirty","executeCommand","mainComponent","nonNumShowAs","targetRanges","univer-flex univer-justify-end univer-gap-2","sheets-sparkline.selector.setSource","color","markersPoint","updateConfig$","BUTTON","M6.46611 4.94092C5.80337 4.94092 5.26611 5.47818 5.26611 6.14092V7.89193C5.26611 8.55467 5.80337 9.09193 6.46611 9.09193H7.23345V9.85927C7.23345 10.522 7.77071 11.0593 8.43345 11.0593H10.1845C10.8472 11.0593 11.3845 10.522 11.3845 9.85927V8.10826C11.3845 7.44552 10.8472 6.90826 10.1845 6.90826L9.41713 6.90826V6.14092C9.41713 5.47818 8.87987 4.94092 8.21713 4.94092H6.46611ZM6.46611 6.14092L8.21713 6.14092L8.21713 6.90826C8.21713 7.571 8.75438 8.10826 9.41713 8.10826H10.1845V9.85927H8.43345V9.09193C8.43345 8.42919 7.8962 7.89193 7.23345 7.89193H6.46611V6.14092Z","#B4A0E5","#9966FF","max","sheets-sparkline.remove","M1.47168 3.08148C1.47168 2.01281 2.33801 1.14648 3.40668 1.14648C4.2659 1.14648 4.99432 1.7065 5.24684 2.48145H11.4034C11.656 1.7065 12.3844 1.14648 13.2436 1.14648C14.3123 1.14648 15.1786 2.01281 15.1786 3.08148C15.1786 3.94073 14.6185 4.66917 13.8436 4.92167V11.0782C14.6185 11.3307 15.1786 12.0592 15.1786 12.9184C15.1786 13.9871 14.3123 14.8534 13.2436 14.8534C12.3843 14.8534 11.6559 14.2933 11.4034 13.5184H5.24687C4.99437 14.2933 4.26593 14.8534 3.40668 14.8534C2.33801 14.8534 1.47168 13.9871 1.47168 12.9184C1.47168 12.0592 2.0317 11.3308 2.80664 11.0782V4.92165C2.0317 4.66912 1.47168 3.9407 1.47168 3.08148ZM12.6436 11.0782C12.0575 11.2692 11.5944 11.7323 11.4034 12.3184H5.24684C5.05587 11.7323 4.59271 11.2692 4.00664 11.0782V4.92167C4.59274 4.73071 5.05591 4.26754 5.24687 3.68145H11.4034C11.5944 4.26752 12.0575 4.73067 12.6436 4.92165V11.0782ZM3.40668 2.34648C3.00075 2.34648 2.67168 2.67556 2.67168 3.08148C2.67168 3.48741 3.00075 3.81648 3.40668 3.81648C3.81261 3.81648 4.14168 3.48741 4.14168 3.08148C4.14168 2.67556 3.81261 2.34648 3.40668 2.34648ZM13.2436 12.1834C12.8377 12.1834 12.5086 12.5125 12.5086 12.9184C12.5086 13.3243 12.8377 13.6534 13.2436 13.6534C13.6495 13.6534 13.9786 13.3243 13.9786 12.9184C13.9786 12.5125 13.6495 12.1834 13.2436 12.1834ZM2.67168 12.9184C2.67168 12.5125 3.00075 12.1834 3.40668 12.1834C3.81261 12.1834 4.14168 12.5125 4.14168 12.9184C4.14168 13.3243 3.81261 13.6534 3.40668 13.6534C3.00075 13.6534 2.67168 13.3243 2.67168 12.9184ZM13.2436 2.34648C12.8377 2.34648 12.5086 2.67556 12.5086 3.08148C12.5086 3.48741 12.8377 3.81648 13.2436 3.81648C13.6495 3.81648 13.9786 3.48741 13.9786 3.08148C13.9786 2.67556 13.6495 2.34648 13.2436 2.34648Z","clip","univer-cursor-pointer","empty","_rangeProtectionCache","clipPath","univer-rounded-tl-0.5 univer-rounded-bl-0.5 univer-h-4 univer-w-6","add","getSparklineCache","_sparklineDataSourceModel","currentColor","SHEET_SPARKLINE_SELECTOR","extremumMin","_sheetGraphicsRenderController","SELF_EXTREMUM","groupId","getCellInfo","4pGsAfj","tag","M10.5366 9.08291C10.5366 8.19925 11.253 7.48291 12.1366 7.48291H13.1366C14.0203 7.48291 14.7366 8.19925 14.7366 9.08291V13.0829C14.7366 13.9666 14.0203 14.6829 13.1366 14.6829H12.1366C11.253 14.6829 10.5366 13.9666 10.5366 13.0829V9.08291ZM12.1366 8.68291C11.9157 8.68291 11.7366 8.862 11.7366 9.08291V13.0829C11.7366 13.3038 11.9157 13.4829 12.1366 13.4829H13.1366C13.3575 13.4829 13.5366 13.3038 13.5366 13.0829V9.08291C13.5366 8.862 13.3575 8.68291 13.1366 8.68291H12.1366Z","_registerRenderer","ColumnSparklineIcon","setValue","isNaN","#E7E9ED","univer-relative univer-mx-0 univer-my-4 univer-box-border univer-flex univer-h-10 univer-items-center univer-justify-around","1034tBAtIQ","MAIN_AREA","sheets-sparkline.panel.lastPoint","univer-mb-4","permission.dialog.editErr","679504SXLXZl","PRINTING_RANGE","univer-rounded-tl-0.5 univer-rounded-bl-0.5 univer-mr-2 univer-h-4 univer-w-6","#ffffff","registerRenderer","sparklineAnchorMap","from","_menuManagerService","sheets-sparkline.selector.singleSourceError","push","3064rCfJZM","3399760SeUSWM","DATA","actualColumn","strokeStyle","CUSTOM_EXTREMUM","unsubscribe","M5.3313 1.4667C5.3313 1.13533 5.59993 0.866699 5.9313 0.866699H10.069C10.4004 0.866699 10.669 1.13533 10.669 1.4667C10.669 1.79807 10.4004 2.0667 10.069 2.0667H5.9313C5.59993 2.0667 5.3313 1.79807 5.3313 1.4667Z","pluginName","intersects","sheets-sparkline.panel.profitAndLoss","cellSourceRanges","getMergedCell","startColumn","ROW_HEADER","2px","sheets-sparkline.panel.customMin","sheets-sparkline.selector.sparkline","deepClone","sheets-sparkline.selector.setTarget","PointColorDoubleIcon","sheet.sparkline.context-menu-id","sheets-sparkline.panel.vertical","univer-flex univer-items-center","sheets-sparkline.panel.horizontal","startGradient","standard","displayName","View","foreach","_autoFillService","univer-mb-5 univer-text-sm","restore","RIGHT","addShapeWithNoFresh","attrs","sheets-sparkline.panel.itemMin","stroke","sheets-sparkline.panel.lineWidth","LAYOUT","actualRow","getInterceptPoints","mask","lineWidth","0 0 17 16","createLinearGradient","univer-mb-2","transparent","lastPoint","span","round","realDeleteValue","_configService","sheets-sparkline.panel.showEmptyAs","setConfig","rgba(232, 95, 95, 0.05)","sheets-sparkline.panel.unCompose","fill","groupSourceRanges","u-spacing","evenodd","sheets-sparkline.panel.showZeroAxis","sheets-sparkline.panel.negativePoint","firstPoint","sheets-sparkline.panel.highPoint","u-connect","sheet.operation.open-sparkline-selector","getSparklineById","_univerInstanceService","getSparkline","M10.4999 1.61475C9.61625 1.61475 8.8999 2.33109 8.8999 3.21475V4.75646C8.77205 4.72356 8.63802 4.70605 8.4999 4.70605H7.4999C6.61625 4.70605 5.8999 5.4224 5.8999 6.30606V7.7506C5.77205 7.7177 5.63802 7.7002 5.4999 7.7002H4.4999C3.61625 7.7002 2.8999 8.41654 2.8999 9.3002V13.1851H1.3334C1.00203 13.1851 0.733398 13.4537 0.733398 13.7851C0.733398 14.1164 1.00203 14.3851 1.3334 14.3851H3.48937L3.4999 14.3851H6.4999L6.50256 14.3851H9.4999L9.50644 14.3851H12.4999L12.5047 14.3851H14.6667C14.9981 14.3851 15.2667 14.1164 15.2667 13.7851C15.2667 13.4537 14.9981 13.1851 14.6667 13.1851H13.0999V3.21475C13.0999 2.33109 12.3836 1.61475 11.4999 1.61475H10.4999ZM11.8999 13.1851V3.21475C11.8999 2.99383 11.7208 2.81475 11.4999 2.81475H10.4999C10.279 2.81475 10.0999 2.99383 10.0999 3.21475V13.1851H11.8999ZM8.8999 13.1851V6.30605C8.8999 6.08514 8.72082 5.90605 8.4999 5.90605H7.4999C7.27899 5.90605 7.0999 6.08514 7.0999 6.30606V13.1851H8.8999ZM5.8999 9.3002V13.1851H4.0999V9.3002C4.0999 9.07928 4.27899 8.9002 4.4999 8.9002H5.4999C5.72082 8.9002 5.8999 9.07928 5.8999 9.3002Z","arcTo","showGradient","div","write-icon","primary","GroupSparklineIcon","_sheetSelectionService","permissionCheckWithRanges","141950JwolGH","_sheetPrintInterceptorService","symbol","endRow","showRadius","sheets-sparkline.panel.zeroValue","_initAutoFillWithSparkline","groupTargetRanges","forEach","shift","_init","sheets-sparkline.panel.bar","basic","item","children","#REF!","DOWN","register","#FF6384","lineTo","rgb(64, 159, 17)","M8.92204 11.2255C8.43208 11.779 7.56829 11.779 7.07833 11.2255L4.13584 7.9017C3.43246 7.10716 3.99655 5.85442 5.0577 5.85442L10.9427 5.85442C12.0038 5.85442 12.5679 7.10716 11.8645 7.9017L8.92204 11.2255Z","_sheetPermissionCheckController","univer-ml-2 univer-transition-transform univer-duration-300","univer-text-sm univer-font-medium","univer-pb-4 univer-pl-4 univer-pt-2.5","_initPermissionWithSparkline","univer-mb-2 univer-text-sm","http://www.w3.org/2000/svg","number","SPACING","more-down-icon","get","sparklines","refreshShapes","toNativeArray","sheets-sparkline.selector.multSourceError","forValue","M2.54552 0.733398C1.54471 0.733398 0.733398 1.54471 0.733398 2.54552C0.733398 3.33614 1.23972 4.0085 1.9458 4.25604V7.50149C1.23972 7.74903 0.733398 8.4214 0.733398 9.21202C0.733398 10.2128 1.54471 11.0241 2.54552 11.0241C3.33593 11.0241 4.00815 10.5181 4.25585 9.81228H6.18799V11.7442C5.48191 11.9917 4.97559 12.6641 4.97559 13.4547C4.97559 14.4555 5.7869 15.2668 6.7877 15.2668C7.57829 15.2668 8.25064 14.7605 8.4982 14.0545H11.7442C11.9918 14.7605 12.6641 15.2668 13.4547 15.2668C14.4555 15.2668 15.2668 14.4555 15.2668 13.4547C15.2668 12.6641 14.7605 11.9918 14.0545 11.7442V8.4982C14.7605 8.25064 15.2668 7.57829 15.2668 6.7877C15.2668 5.7869 14.4555 4.97559 13.4547 4.97559C12.6641 4.97559 11.9917 5.48191 11.7442 6.18799H9.81228V4.25585C10.5181 4.00815 11.0241 3.33593 11.0241 2.54552C11.0241 1.54471 10.2128 0.733398 9.21202 0.733398C8.42158 0.733398 7.74934 1.23949 7.50166 1.94531H4.25587C4.00819 1.23949 3.33595 0.733398 2.54552 0.733398ZM12.8545 8.49806C12.3365 8.3163 11.9261 7.90593 11.7444 7.38799H9.81228V8.21228C9.81228 9.09594 9.09594 9.81228 8.21228 9.81228H7.38799V11.7444C7.90593 11.9261 8.3163 12.3365 8.49806 12.8545H11.7443C11.9261 12.3365 12.3365 11.9261 12.8545 11.7443V8.49806ZM3.1458 7.50169V4.25584C3.66388 4.07402 4.07433 3.66346 4.25601 3.14531H7.50152C7.68327 3.66364 8.09395 4.07431 8.61228 4.25603V8.21228C8.61228 8.4332 8.4332 8.61228 8.21228 8.61228H6.84486C6.82614 8.61052 6.80717 8.60962 6.78799 8.60962C6.76881 8.60962 6.74984 8.61052 6.73112 8.61228H4.25603C4.07436 8.09411 3.6639 7.68353 3.1458 7.50169ZM2.5458 8.60012L2.53418 8.60001C2.20135 8.60605 1.9334 8.87774 1.9334 9.21202C1.9334 9.55008 2.20745 9.82414 2.54552 9.82414C2.88358 9.82414 3.15763 9.55008 3.15763 9.21202C3.15763 8.87784 2.88984 8.60621 2.55714 8.60001L2.5458 8.60012ZM9.21202 3.15763C8.87805 3.15763 8.60654 2.89017 8.60002 2.55776L8.60015 2.54531L8.60003 2.53311C8.60663 2.20077 8.8781 1.9334 9.21202 1.9334C9.55008 1.9334 9.82414 2.20745 9.82414 2.54552C9.82414 2.88358 9.55008 3.15763 9.21202 3.15763ZM1.9334 2.54552C1.9334 2.20745 2.20745 1.9334 2.54552 1.9334C2.88358 1.9334 3.15763 2.20745 3.15763 2.54552C3.15763 2.88358 2.88358 3.15763 2.54552 3.15763C2.20745 3.15763 1.9334 2.88358 1.9334 2.54552ZM12.8426 13.4547C12.8426 13.1166 13.1166 12.8426 13.4547 12.8426C13.7928 12.8426 14.0668 13.1166 14.0668 13.4547C14.0668 13.7928 13.7928 14.0668 13.4547 14.0668C13.1166 14.0668 12.8426 13.7928 12.8426 13.4547ZM6.17559 13.4547C6.17559 13.1166 6.44964 12.8426 6.7877 12.8426C7.12576 12.8426 7.39982 13.1166 7.39982 13.4547C7.39982 13.7928 7.12576 14.0668 6.7877 14.0668C6.44964 14.0668 6.17559 13.7928 6.17559 13.4547ZM12.8426 6.7877C12.8426 6.44964 13.1166 6.17559 13.4547 6.17559C13.7928 6.17559 14.0668 6.44964 14.0668 6.7877C14.0668 7.12576 13.7928 7.39982 13.4547 7.39982C13.1166 7.39982 12.8426 7.12576 12.8426 6.7877Z","SHEET_SPARKLINE_PANEL_ID","nonNum","disposeWithMe","showMin","some","replace","rgb(0, 0, 0)","url(#ungroup-sparkline-icon_clip0_1729_95)","sheets-sparkline.panel.composeManager","sourceRanges","univer-flex univer-w-full univer-items-center univer-justify-between univer-rounded-sm","4px","sheet.operation.open-sparkline-panel","#FF9F40","sheets-sparkline.panel.spacing","univer-flex-1","sheets-sparkline.title","rect","M1.26318 9.08291C1.26318 8.19925 1.97953 7.48291 2.86318 7.48291H3.86318C4.74684 7.48291 5.46318 8.19925 5.46318 9.08291V13.0829C5.46318 13.9666 4.74684 14.6829 3.86318 14.6829H2.86318C1.97953 14.6829 1.26318 13.9666 1.26318 13.0829V9.08291ZM2.86318 8.68291C2.64227 8.68291 2.46318 8.862 2.46318 9.08291V13.0829C2.46318 13.3038 2.64227 13.4829 2.86318 13.4829H3.86318C4.0841 13.4829 4.26318 13.3038 4.26318 13.0829V9.08291C4.26318 8.862 4.0841 8.68291 3.86318 8.68291H2.86318Z","sheets-sparkline.panel.adjustStyle","substring","sheets-sparkline.panel.title","includes","sheets-sparkline.panel.basic","colorChannel1","getSubUnitSparkline","fillRect","univer-flex univer-justify-between","none","xlink:href","_initClipboardWithSparkline","univer-mx-0 univer-my-2 univer-text-sm univer-text-gray-500","univer-size-4 univer-pr-1","beforeCommandExecuted","sheets-sparkline.panel.itemMax","parseInt","has","univer-p-4","univer-ml-3 univer-h-6 univer-w-14","blockExecuteWithoutPermission","delete-icon","onCommandExecuted","axis","WinlossSparklineIcon","moveTo","defs","group-sparkline-icon","sparklineModel","_initComponents","STANDARD","univer-flex univer-h-8 univer-w-full univer-cursor-default univer-items-center univer-rounded-lg univer-bg-gray-50 dark:!univer-bg-gray-800","registerRenderModule","sheets-sparkline.panel.min","lowPoint","showMax","COL_HEADER","1em","COPY","M9.56654 1.40506C9.72053 1.29203 9.91914 1.25907 10.1014 1.3163C12.2805 2.00072 13.9997 3.71989 14.6841 5.899C14.7413 6.08125 14.7083 6.27986 14.5953 6.43384C14.4823 6.58783 14.3027 6.67879 14.1116 6.67879H10.0216C9.635 6.67879 9.3216 6.36539 9.3216 5.97879V1.88873C9.3216 1.69771 9.41256 1.5181 9.56654 1.40506ZM10.5216 2.77012V5.47879H13.2303C12.6601 4.29855 11.7018 3.34027 10.5216 2.77012Z","min","value","_sourceIds","subscribe","univer-flex univer-h-5 univer-w-[45%] univer-items-center univer-justify-between univer-rounded-sm hover:univer-bg-gray-200","mergeInfo","getValue","pie-chart-icon_clip0_1644_114","split","range","sheets-sparkline.panel.customMax","0 0 16 16","map","GROUP_EXTREMUM","sheets-sparkline.panel.removeItem","_commandService","idSuffix","147306aAGBPb","config","containHiddenCells","sheets-sparkline.selector.sparklineGroup","_config","univer-mb-3 univer-text-sm univer-font-medium","M0 0H16V16H0z","77JmrYvJ","pie-chart-icon","univer-relative univer-flex univer-h-full univer-cursor-pointer univer-flex-col univer-font-medium univer-leading-7","#4BC0C0","sheets-sparkline.panel.","MoreRightIcon","defineProperty","#36A2EB","endGradient","visible","reverse","getColVisible","startRow","matrix","_localeService","getOwnPropertyDescriptor","url(#pie-chart-icon_clip0_1644_114)"];return G2=function(){return t},G2()}const a2=M(744);function c4(t){const e=M;return{id:ei.id,title:e(857),tooltip:e(857),icon:xi,type:as[e(676)],hidden$:$a(t,P0[e(564)]),disabled$:Sr(t,{workbookTypes:[Fe],worksheetTypes:[Oe],rangeTypes:[De]})}}function l4(t){const e=M;return{id:a2,type:as.SUBITEMS,icon:xi,title:e(857),hidden$:l1([$a(t,P0.UNIVER_SHEET),u4(t)])[e(572)](Ea(([x,n])=>x||n))}}function Fs(t){const e=M;return{id:nt.id,type:as[e(676)],title:"sheets-sparkline.remove",tooltip:e(681),disabled$:Sr(t,{workbookTypes:[Fe],worksheetTypes:[Oe],rangeTypes:[De]})}}function $s(t){const e=M;return{id:on.id,title:"sheets-sparkline.edit",tooltip:"sheets-sparkline.edit",type:as[e(676)],disabled$:Sr(t,{workbookTypes:[Fe],worksheetTypes:[Oe],rangeTypes:[De]})}}function u4(t){const e=M,x=t[e(834)](N0)[e(625)](P0[e(564)]),n=t.get(K0),r=t[e(834)](Tr);return x[e(572)](mi(s=>s?s.activeSheet$.pipe(mi(i=>{const a=e;if(!i)return oi(!0);const o=t[a(834)](Se);return Ra(o.selectionMoveEnd$,n[a(675)])[a(572)](Ea(()=>{const d=a,c=o[d(610)]();if(c[d(523)]>1||c[d(523)]===0)return!0;const{primary:l,range:u}=c[0];if(!l)return!0;const f=s[d(608)](),b=i[d(657)]();if(!n.getSparkline(f,b,l[d(763)],l.actualColumn))return!0;const h=new Set;Rx[d(752)](u,(I,v)=>{const C=d,w=n.getSparkline(f,b,I,v);w&&n[C(790)](f,b,w)&&h[C(689)](w)});let p=!0;return h.forEach(I=>{const v=d,C=n[v(790)](f,b,I);C&&p&&C[v(835)][v(839)]((w,y)=>{const P=v;var E;((E=r[P(698)](f,b,w,y))==null?void 0:E[Er[P(529)]])===!1&&(p=!1)})}),!p}))})):oi(!0)))}const f4={[A1.MEDIA]:{[ei.id]:{order:3,menuItemFactory:c4}},[gs[M(709)]]:{[vs[M(725)]]:{[a2]:{order:5,menuItemFactory:l4,[on.id]:{menuItemFactory:$s},[nt.id]:{menuItemFactory:Fs}}}},[gs[M(467)]]:{[vs[M(762)]]:{[a2]:{[on.id]:{menuItemFactory:$s},[nt.id]:{menuItemFactory:Fs}}}},[gs[M(737)]]:{[vs[M(762)]]:{[a2]:{[on.id]:{menuItemFactory:$s},[nt.id]:{menuItemFactory:Fs}}}}};Object[M(510)];var m4=(t,e,x,n)=>{const r=M;for(var s=e,i=t[r(523)]-1,a;i>=0;i--)(a=t[i])&&(s=a(s)||s);return s},pa=(t,e)=>(x,n)=>e(x,n,t);let Y2=class extends U0{constructor(t,e){const x=M;super(),this._menuManagerService=t,this._componentManager=e,this._initMenu(),this[x(460)]()}[M(460)](){const t=M;[[xi,ti],[Ut,d4],[$o,r4]][t(810)](([e,x])=>{const n=t;this[n(843)](this._componentManager[n(819)](e,x))})}_initMenu(){const t=M;this[t(720)][t(531)](f4)}};Y2=m4([pa(0,L1),pa(1,q(H1))],Y2);Object[M(510)];var b4=(t,e,x,n)=>{const r=M;for(var s=e,i=t[r(523)]-1,a;i>=0;i--)(a=t[i])&&(s=a(s)||s);return s},ke=(t,e)=>(x,n)=>e(x,n,t);let W2=class extends U0{constructor(t,e,x,n,r,s,i,a){const o=M;super(),ma(this,o(619),[]),ma(this,o(473),[]),this._sheetSelectionService=t,this[o(791)]=e,this[o(691)]=x,this[o(622)]=n,this[o(629)]=r,this[o(686)]=s,this._commandService=i,this[o(612)]=a,this[o(545)](),this[o(565)]()}[M(565)](){const t=M;this[t(486)][t(453)](e=>{const x=t;e.id===Ua.id&&(this[x(622)][x(643)](Ze),this._dialogService[x(643)](Ut))})}[M(545)](){const t=M;this.disposeWithMe(Ra(this[t(800)].selectionMoveEnd$[t(572)](c1((e,x)=>e[t(523)]!==x[t(523)]?!1:!x.some((n,r)=>!x0[t(652)](n[t(480)],e[r][t(480)])))),this._sparklineDataSourceModel[t(675)][t(572)](La(500)))[t(474)](()=>{const e=t;var x,n,r,s;const i=this[e(800)].getCurrentSelections();[...this[e(619)],...this[e(473)]][e(810)](w=>{const y=e;w&&this[y(629)][y(556)](w)});const a=ax(this[e(791)]);if(!a){this[e(622)].close(Ze);return}const{unitId:o,subUnitId:d,worksheet:c}=a;if(!i||i[e(523)]!==1){this[e(622)][e(643)](Ze);return}const{primary:l,range:u}=i[0];if(!l){this._sidebarService[e(643)](Ze);return}let f=l[e(763)],b=l[e(726)];const h=c[e(735)](l==null?void 0:l[e(763)],l==null?void 0:l[e(726)]);if(h&&(f=h[e(507)],b=h[e(736)]),((x=this[e(686)][e(698)](o,d,f,b))==null?void 0:x[Er[e(529)]])===!1){this._sidebarService[e(643)](Ze);return}const p=this[e(691)][e(690)](),I=(n=p==null?void 0:p[e(718)].get(o))==null?void 0:n[e(834)](d),v=(r=I==null?void 0:I[e(508)].getValue(f,b))==null?void 0:r[e(697)];if(!v){this[e(622)][e(643)](Ze);return}const C=(s=this[e(691)][e(790)](o,d,v))==null?void 0:s[e(835)];C&&(gr(C[e(553)](),c)[e(810)](w=>{const y=e,P=_a(w,this._markSelectionService,y(562),"rgba(73, 184, 17, 0.05)");P&&this._sourceIds[y(722)](P)}),C[e(839)]((w,y,P)=>{const E=e,S=P;if(S&&x0[E(732)](Gx(w,y),u)){const T=_a(S,this[E(629)],E(633),E(778));T&&this[E(473)].push(T)}}),this._markSelectionService[e(836)]())}))}};W2=b4([ke(0,q(Se)),ke(1,q(N0)),ke(2,q(K0)),ke(3,q(Fa)),ke(4,q(B1)),ke(5,q(Tr)),ke(6,q(g0)),ke(7,q(is))],W2);function _a(t,e,x,n){const r=M;if(Jt(t)){const s=e[r(757)]({range:t,style:{fill:n,strokeWidth:1,stroke:x,widgets:{}},primary:null},void 0,-10);if(s)return s}}function gr(t,e){const x=M,n=[],r=new Set;function s(o,d){const c=Ix;var l;return!!((l=t[o])!=null&&l[d]&&!r[c(448)](o+"-"+d))}function i(o,d){const c=Ix,l=[[o,d]],u=[],f=new Set,b=new Set;for(;l.length>0;){const[I,v]=l[c(811)](),C=I+"-"+v;if(r.has(C))continue;r[c(689)](C),u[c(722)]([I,v]);const w=e[c(735)](I,v);if(w){for(let y=w[c(507)];y<=w.endRow;y++)for(let P=w[c(736)];P<=w.endColumn;P++){const E=y+"-"+P;r[c(689)](E),u[c(722)]([y,P])}continue}for(const[y,P]of[[0,1],[1,0],[0,-1],[-1,0]]){const E=I+y,S=v+P;s(E,S)&&l[c(722)]([E,S])}}for(const[I,v]of u){const C=u[c(845)](([y,P])=>y===I&&P!==v),w=u[c(845)](([y,P])=>P===v&&y!==I);C&&!w?f[c(689)](I+"-"+v):w&&!C?b[c(689)](I+"-"+v):C&&w?f[c(689)](I+"-"+v):n[c(722)]({startRow:I,endRow:I,startColumn:v,endColumn:v})}const h=a(f),p=a(b);return[...h,...p]}function a(o){const d=Ix,c=[],l=new Set;for(const u of o){if(l[d(448)](u))continue;const[f,b]=u[d(479)]("-").map(Number);let h=f,p=f,I=b,v=b;const C=[[f,b]];for(;C[d(523)]>0;){const[w,y]=C[d(811)](),P=w+"-"+y;if(!(l[d(448)](P)||!o[d(448)](P))){l[d(689)](P),h=Math.min(h,w),p=Math.max(p,w),I=Math[d(471)](I,y),v=Math.max(v,y);for(const[E,S]of[[0,1],[1,0],[0,-1],[-1,0]]){const T=w+E,k=y+S,V=T+"-"+k;o[d(448)](V)&&!l[d(448)](V)&&C[d(722)]([T,k])}}}c[d(722)]({startRow:h,endRow:p,startColumn:I,endColumn:v})}return c}for(const o in t){const d=Number.parseInt(o,10);for(const c in t[d]){const l=Number[x(447)](c,10),u=d+"-"+l;if(!r.has(u)){const f=i(d,l);n[x(722)](...f)}}}return n}Object[M(510)];var h4=(t,e,x,n)=>{const r=M;for(var s=e,i=t[r(523)]-1,a;i>=0;i--)(a=t[i])&&(s=a(s)||s);return s},It=(t,e)=>(x,n)=>e(x,n,t);let Q2=class extends U0{constructor(t,e,x,n,r,s){const i=M;super(),this._commandService=t,this[i(509)]=e,this[i(824)]=x,this[i(518)]=n,this[i(791)]=r,this[i(691)]=s,this[i(828)]()}[M(828)](){const t=M;this[t(843)](this[t(486)][t(445)](e=>{const x=t;if(e.id===qr.id){const n=e[x(609)],{targetRanges:r,targetInfo:s}=n,{unitId:i,subUnitId:a}=s;this[x(824)][x(801)]({workbookTypes:[Fe],worksheetTypes:[Oe],rangeTypes:[De]},r,i,a)||this[x(824)][x(451)](this[x(509)].t(x(712)))}else if(e.id===_x.id){const n=e[x(609)],{isChangeDataSource:r,changeDataSourceInfo:s}=n,i=ax(this[x(791)]);if(!i)return;const a=this[x(518)][x(610)]()[x(483)](c=>c[x(480)]),{unitId:o,subUnitId:d}=i;if(r){if(s){const{targetRanges:c,sourceRanges:l,resetType:u}=s,f=u==="item"?c:[...l,...c];this[x(824)][x(801)]({workbookTypes:[Fe],worksheetTypes:[Oe],rangeTypes:[De]},f,o,d)||this[x(824)][x(451)](this[x(509)].t(x(712)))}}else{const c=new Set;a.forEach(u=>{const f=x;Rx[f(752)](u,(b,h)=>{const p=f,I=this[p(691)][p(792)](o,d,b,h);I&&this[p(691)][p(790)](o,d,I)&&c[p(689)](I)})});const l=[];c.forEach(u=>{const f=x,b=this[f(691)][f(790)](o,d,u);b&&l.push(...gr(b[f(835)][f(553)](),i[f(614)]))}),this[x(824)][x(801)]({workbookTypes:[Fe],worksheetTypes:[Oe],rangeTypes:[De]},l,o,d)||this[x(824)][x(451)](this[x(509)].t(x(712)))}}else if(e.id===nt.id){const n=e[x(609)],{isSingle:r}=n;if(r)this._sheetPermissionCheckController[x(801)]({workbookTypes:[Fe],worksheetTypes:[Oe],rangeTypes:[De]})||this[x(824)].blockExecuteWithoutPermission(this._localeService.t("permission.dialog.editErr"));else{const s=ax(this._univerInstanceService);if(!s)return;const i=this[x(518)].getCurrentSelections()[x(483)](l=>l.range),{unitId:a,subUnitId:o}=s,d=new Set;i.forEach(l=>{const u=x;Rx[u(752)](l,(f,b)=>{const h=u,p=this[h(691)][h(792)](a,o,f,b);p&&this[h(691)][h(790)](a,o,p)&&d[h(689)](p)})});const c=[];d[x(810)](l=>{const u=x,f=this[u(691)][u(790)](a,o,l);f&&c.push(...gr(f[u(835)].getMatrix(),s.worksheet))}),this._sheetPermissionCheckController[x(801)]({workbookTypes:[Fe],worksheetTypes:[Oe],rangeTypes:[De]},c,a,o)||this._sheetPermissionCheckController[x(451)](this[x(509)].t(x(712)))}}}))}};Q2=h4([It(0,q(g0)),It(1,q(jx)),It(2,q(G1)),It(3,q(Se)),It(4,q(N0)),It(5,q(K0))],Q2);Object[M(510)];var p4=(t,e,x,n)=>{const r=M;for(var s=e,i=t[r(523)]-1,a;i>=0;i--)(a=t[i])&&(s=a(s)||s);return s},Ia=(t,e)=>(x,n)=>e(x,n,t);let z2=class extends U0{constructor(t,e){const x=M;super(),this[x(803)]=t,this[x(691)]=e,this[x(812)]()}[M(812)](){const t=M;this[t(843)](this[t(803)][t(541)].intercept(this[t(803)][t(541)][t(764)]()[t(714)],{handler:(e,x,n)=>{const r=t,{unitId:s,subUnitId:i}=x,a=this[r(691)][r(437)](s,i);let o=e;return a&&Array[r(719)](a[r(623)]()).forEach(d=>{const c=r,l=d.sparklines[c(662)]();o=o&&l[c(805)]>=0?x0.realUnion(o,l):l}),n(o)}}))}};z2=p4([Ia(0,q(Oa)),Ia(1,q(K0))],z2);const _4=(t,e,x,n,r)=>{const s=M;var i,a,o,d,c,l,u,f,b,h,p,I,v,C,w,y,P,E,S,T,k,V,H,D,U,j,F,z;const{startX:Q,startY:G,endX:Y,endY:t0}=e.mergeInfo;if(!n)return;const{max:A,min:Z,highIndex:J,lowIndex:S0,negativeIndexes:I0,data:l0}=n,T0=4,L0=Y-Q-2*T0,Q0=t0-G-2*T0,n0=Q+T0,O=G+T0,W=(a=(i=x[s(554)])==null?void 0:i[s(560)])!=null?a:lx.SELF_EXTREMUM,o0=(d=(o=x[s(694)])==null?void 0:o.type)!=null?d:lx.SELF_EXTREMUM,r0=(c=r==null?void 0:r.showMax)!=null?c:A,m0=(l=r==null?void 0:r[s(844)])!=null?l:Z,a0=W===lx[s(696)]?A:r0,f0=o0===lx[s(696)]?Z:m0;let w0=!1;const Nx=l0[J];typeof Nx=="number"&&Nx<f0&&(w0=!0);let be=!1;const Lx=l0[S0];if(typeof Lx==s(831)&&Lx>a0&&(be=!0),f0>a0||w0||be)return;const Cx=a0===f0,ne=a0-f0,b0=L0/(l0.length-1),ct=(f=(u=x[s(454)])==null?void 0:u[s(505)])!=null?f:!1,wx=[];t.save(),t[s(621)](),t.rect(Q+T0,G+T0,L0,Q0),t[s(683)](),t[s(621)]();let ix=null;for(let u0=0;u0<l0.length;u0++){const z0=l0[u0];if(z0===s(782)){ix=null;continue}if(z0==="u-connect")continue;const J0=ct?Y-T0-u0*b0:n0+u0*b0,$t=Cx?O+Q0/2:O+Q0-(Number(z0)-f0)/ne*Q0,Me={x:J0,y:$t};wx[s(722)](Me),ix?(t[s(456)](ix.x,ix.y),t[s(821)](Me.x,Me.y)):t[s(456)](Me.x,Me.y),ix=Me}const Dx=(b=x[s(632)])!=null?b:Ae[s(461)],mx=(I=(p=x[s(573)])!=null?p:(h=Zx[Dx])==null?void 0:h[0])!=null?I:Zx[s(749)][0],ze=r==null?void 0:r[s(748)],Je=r==null?void 0:r[s(503)];t[s(727)]=mx,t[s(766)]=x[s(766)]||2,t[s(576)]=s(773),t[s(760)]();const he=[],se=[];if(x[s(795)]&&ze&&Je){const u0=t[s(768)](0,O,0,O+Q0);u0[s(665)](0,ze),u0[s(665)](1,Je),t[s(621)]();const z0=[];let J0=null,$t=0;const Me=l0[J],Jo=l0[S0];for(let re=0;re<=l0[s(523)];re++){const _e=l0[re],Ie=_e===s(782),At=_e===s(788),ps=re===l0[s(523)];_e===Me&&he[s(722)](re),_e===Jo&&se[s(722)](re),Ie||ps?J0!==null&&(z0[s(722)]([J0,$t-1]),J0=null):At||(J0===null&&(J0=$t),$t++)}z0[s(810)](([re,_e])=>{const Ie=s,At=wx[re],ps=wx[_e];if(!(!At||!ps||re===_e)){t[Ie(621)](),t[Ie(456)](At.x,At.y);for(let _s=re;_s<=_e;_s++){const Is=wx[_s];Is&&t[Ie(821)](Is.x,Is.y)}t[Ie(821)](wx[_e].x,O+Q0),t[Ie(821)](wx[re].x,O+Q0),t.closePath(),t[Ie(532)]=u0,t[Ie(780)]()}})}const pe=s(822);if((C=(v=x.points)==null?void 0:v[s(674)])!=null&&C[s(504)]&&(t.fillStyle=x[s(650)][s(674)].color||pe,wx[s(810)](u0=>{const z0=s;t[z0(621)](),t[z0(658)](u0.x,u0.y,2,0,Math.PI*2),t[z0(780)]()})),(y=(w=x[s(650)])==null?void 0:w[s(786)])!=null&&y[s(504)]){t[s(532)]=x.points.firstPoint[s(673)]||pe;const u0=wx[0];u0&&(t[s(621)](),t[s(658)](u0.x,u0.y,2,0,Math.PI*2),t[s(780)]())}if((E=(P=x.points)==null?void 0:P[s(771)])!=null&&E[s(504)]){t.fillStyle=x.points[s(771)].color||pe;const u0=wx[wx[s(523)]-1];u0&&(t[s(621)](),t[s(658)](u0.x,u0.y,2,0,Math.PI*2),t[s(780)]())}(T=(S=x[s(650)])==null?void 0:S[s(527)])!=null&&T[s(504)]&&(t[s(532)]=x[s(650)].highPoint.color||pe,he[s(810)](u0=>{const z0=s,J0=wx[u0];J0&&(t[z0(621)](),t[z0(658)](J0.x,J0.y,2,0,Math.PI*2),t.fill())})),(V=(k=x.points)==null?void 0:k.lowPoint)!=null&&V.visible&&(t.fillStyle=x[s(650)][s(465)].color||pe,se[s(810)](u0=>{const z0=s,J0=wx[u0];J0&&(t[z0(621)](),t[z0(658)](J0.x,J0.y,2,0,Math.PI*2),t[z0(780)]())})),(D=(H=x[s(650)])==null?void 0:H[s(630)])!=null&&D[s(504)]&&(t[s(532)]=x[s(650)][s(630)][s(673)]||pe,I0.forEach(u0=>{const z0=s,J0=wx[u0];J0&&(t[z0(621)](),t[z0(658)](J0.x,J0.y,2,0,Math.PI*2),t[z0(780)]())}));let bx=!0;if(Cx?bx=!!((U=x.axis)!=null&&U[s(504)]):bx=!!(f0<=0&&(j=x[s(454)])!=null&&j.visible),bx){let u0=O;Cx?f0===0?u0=O+Q0/2:f0>0&&(u0=O+Q0):u0=O+Q0-(0-f0)/ne*Q0,t[s(621)](),t[s(456)](n0,u0),t[s(821)](n0+L0,u0),t[s(727)]=(z=(F=x.axis)==null?void 0:F[s(673)])!=null?z:s(847),t[s(766)]=1,t[s(760)]()}t[s(755)]()},I4=(t,e,x,n,r)=>{const s=M;var i,a,o,d,c,l,u,f,b,h,p,I,v,C,w,y,P;const{startX:E,startY:S,endX:T,endY:k}=e;if(!n)return;const{max:V,min:H,highIndex:D,lowIndex:U,negativeIndexes:j,data:F}=n,z=4,Q=T-E-2*z,G=k-S-2*z,Y=E+z,t0=S+z,A=(a=(i=x[s(554)])==null?void 0:i[s(560)])!=null?a:lx[s(696)],Z=(d=(o=x.extremumMin)==null?void 0:o[s(560)])!=null?d:lx[s(696)],J=(c=r==null?void 0:r[s(466)])!=null?c:V,S0=(l=r==null?void 0:r[s(844)])!=null?l:H,I0=A===lx[s(696)]?V:J,l0=Z===lx[s(696)]?H:S0,T0=I0-l0,L0=.2,Q0=Q,n0=I0===l0,O=Q0/(F[s(523)]*(1+L0)),W=O*L0,o0=(f=(u=x[s(454)])==null?void 0:u[s(505)])!=null?f:!1,r0=(b=x[s(806)])!=null?b:!1;let m0=0;n0||(m0=l0>=0?l0:I0<=0?I0:0);let a0=t0+G;n0?l0===0?a0=t0+G/2:l0>0?a0=t0+G:l0<0&&(a0=t0):l0>=0?a0=t0+G:I0<=0?a0=t0:a0=t0+G-(0-l0)/T0*G,t[s(520)](),t[s(621)](),t[s(858)](E,S,T-E,k-S),t.clip();const f0=(h=x.themeType)!=null?h:Ae.STANDARD,w0=(v=(I=x[s(573)])!=null?I:(p=Zx[f0])==null?void 0:p[0])!=null?v:Zx[s(749)][0],Nx=F[D],be=F[U];F.forEach((Cx,ne)=>{const b0=s;var ct,wx,ix,Dx,mx,ze,Je,he,se,pe;if(typeof Cx==b0(568)||typeof Cx>"u")return;const bx=o0?T-z-(ne+1)*(O+W)+W/2:Y+ne*(O+W)+W/2;let u0=0;n0?l0!==0&&(u0=G):Cx<l0?u0=0:Cx>I0?u0=G:l0<0?u0=Cx===0?0:Math[b0(680)](Math[b0(581)](Cx-m0)/T0*G,2):Cx===0?u0=0:u0=Math[b0(680)](Math[b0(581)](Cx-m0)/T0*G,2);let z0=w0;if((wx=(ct=x.points)==null?void 0:ct[b0(786)])!=null&&wx[b0(504)]&&ne===0&&(z0=x.points[b0(786)][b0(673)]||w0),(Dx=(ix=x.points)==null?void 0:ix[b0(771)])!=null&&Dx.visible&&ne===F[b0(523)]-1&&(z0=x[b0(650)][b0(771)][b0(673)]||w0),(ze=(mx=x.points)==null?void 0:mx[b0(527)])!=null&&ze[b0(504)]&&Cx===Nx&&(z0=x[b0(650)][b0(527)][b0(673)]||w0),(he=(Je=x[b0(650)])==null?void 0:Je[b0(465)])!=null&&he[b0(504)]&&Cx===be&&(z0=x[b0(650)][b0(465)].color||w0),(pe=(se=x[b0(650)])==null?void 0:se.negativePoint)!=null&&pe.visible&&j[b0(434)](ne)&&(z0=x.points[b0(630)][b0(673)]||w0),t[b0(532)]=z0,O>=4&&r0&&u0>=2){t.beginPath();const J0=2;Cx>=m0?(t[b0(456)](bx,a0-u0+J0),t[b0(794)](bx,a0-u0,bx+O,a0-u0,J0),t.arcTo(bx+O,a0-u0,bx+O,a0-u0+J0,J0),t.lineTo(bx+O,a0),t[b0(821)](bx,a0),t[b0(570)](),t[b0(780)]()):(t[b0(456)](bx,a0),t[b0(821)](bx+O,a0),t[b0(794)](bx+O,a0+u0,bx+O-J0,a0+u0,J0),t.arcTo(bx,a0+u0,bx,a0+u0-J0,J0),t.lineTo(bx,a0),t[b0(570)](),t.fill())}else Cx>=m0?t[b0(438)](bx,a0-u0,O,u0):t[b0(438)](bx,a0,O,u0)});let Lx=!0;n0?Lx=!!((C=x[s(454)])!=null&&C[s(504)]):Lx=!!((w=x[s(454)])!=null&&w.visible&&!(I0<0||l0>0)),Lx&&(t[s(621)](),t[s(456)](Y,a0),t[s(821)](Y+Q,a0),t[s(727)]=(P=(y=x[s(454)])==null?void 0:y.color)!=null?P:s(847),t[s(766)]=1,t[s(760)]()),t[s(755)]()},g4=(t,e,x,n,r)=>{const s=M;var i,a,o,d,c,l,u,f,b;const{startX:h,startY:p,endX:I,endY:v}=e;if(!n)return;const{highIndex:C,lowIndex:w,negativeIndexes:y,data:P}=n,E=4,S=I-h-2*E,T=v-p-2*E,k=h+E,V=p+E,H=.2,D=S/(P[s(523)]*(1+H)),U=D*H,j=(a=(i=x[s(454)])==null?void 0:i[s(505)])!=null?a:!1,F=(o=x[s(806)])!=null?o:!1,z=V+T/2;t[s(520)](),t[s(621)](),t[s(858)](h,p,I-h,v-p),t[s(683)]();const Q=(d=x[s(632)])!=null?d:Ae[s(461)],G=(u=(l=x[s(573)])!=null?l:(c=Zx[Q])==null?void 0:c[0])!=null?u:Zx.standard[0],Y=P[C],t0=P[w];P[s(810)]((A,Z)=>{const J=s;var S0,I0,l0,T0,L0,Q0,n0,O,W,o0;if(typeof A=="string"||typeof A>"u")return;const r0=A===0?0:T/2,m0=j?I-E-(Z+1)*(D+U)+U/2:k+Z*(D+U)+U/2,a0=A>=0;let f0=G;if((I0=(S0=x[J(650)])==null?void 0:S0[J(786)])!=null&&I0[J(504)]&&Z===0&&(f0=x[J(650)][J(786)][J(673)]||G),(T0=(l0=x[J(650)])==null?void 0:l0[J(771)])!=null&&T0.visible&&Z===P[J(523)]-1&&(f0=x[J(650)][J(771)][J(673)]||G),(Q0=(L0=x.points)==null?void 0:L0[J(527)])!=null&&Q0[J(504)]&&A===Y&&(f0=x[J(650)][J(527)].color||G),(O=(n0=x.points)==null?void 0:n0.lowPoint)!=null&&O[J(504)]&&A===t0&&(f0=x[J(650)][J(465)][J(673)]||G),(o0=(W=x[J(650)])==null?void 0:W.negativePoint)!=null&&o0[J(504)]&&y[J(434)](Z)&&(f0=x[J(650)][J(630)].color||G),t.fillStyle=f0,D>=4&&F){t[J(621)]();const w0=2;a0?(t.moveTo(m0,z-r0+w0),t[J(794)](m0,z-r0,m0+D,z-r0,w0),t.arcTo(m0+D,z-r0,m0+D,z-r0+w0,w0),t.lineTo(m0+D,z),t[J(821)](m0,z),t[J(570)](),t.fill()):(t[J(456)](m0,z),t.lineTo(m0+D,z),t[J(794)](m0+D,z+r0,m0+D-w0,z+r0,w0),t[J(794)](m0,z+r0,m0,z+r0-w0,w0),t.lineTo(m0,z),t[J(570)](),t[J(780)]())}else a0?t.fillRect(m0,z-r0,D,r0):t[J(438)](m0,z,D,r0)}),(f=x[s(454)])!=null&&f[s(504)]&&(t[s(621)](),t[s(456)](0+k,V+T/2),t.lineTo(S+k,V+T/2),t.strokeStyle=(b=x[s(454)].color)!=null?b:s(847),t[s(766)]=1,t[s(760)]()),t[s(755)]()},v4=(t,e,x,n,r)=>{const s=M,{startX:i,startY:a,endX:o,endY:d}=e[s(476)];if(!n)return;const{data:c}=n,l=4,u=o-i-2*l,f=d-a-2*l,b=i+l,h=a+l,p=Math.min(u,f)/2,I=b+u/2,v=h+f/2,C=[s(820),s(502),"#FFCE56",s(498),s(679),s(854),s(706),s(678)],w=c.filter(E=>typeof E==s(831)&&!Number[s(705)](E)),y=w[s(542)]((E,S)=>E+S,0);if(y===0||w.length===0)return;let P=-Math.PI/2;w[s(810)]((E,S)=>{const T=s,k=E/y*2*Math.PI,V=P+k;t[T(621)](),t[T(456)](I,v),t[T(658)](I,v,p,P,V),t[T(570)](),t[T(532)]=C[S%C[T(523)]],t[T(780)](),t[T(766)]=1,t.strokeStyle=T(716),t.stroke(),P=V})};Object[M(510)];var C4=(t,e,x,n)=>{const r=M;for(var s=e,i=t[r(523)]-1,a;i>=0;i--)(a=t[i])&&(s=a(s)||s);return s},As=(t,e)=>(x,n)=>e(x,n,t);let vr=class extends U0{constructor(t,e,x,n){const r=M;super(),this[r(590)]=t,this._sparklineDataSourceModel=e,this[r(695)]=x,this[r(686)]=n,this[r(702)](),this._initSkeleton()}_registerRenderer(){const t=M,e=this[t(691)][t(690)](),x=e.sparklineAnchorMap,n=e[t(459)],r=(s,i,a)=>{const o=t;var d,c,l,u,f,b;const{actualRow:h,actualColumn:p}=a,{worksheet:I}=i,v=I[o(657)](),C=I[o(608)]();if(((d=this[o(686)][o(698)](C,v,h,p))==null?void 0:d[Er[o(751)]])===!1)return;const w=I[o(578)](h),y=I[o(506)](p);if(!w||!y)return;const P=(c=x.get(C))==null?void 0:c[o(834)](v),E=(l=P==null?void 0:P[o(508)])==null?void 0:l.getValue(h,p);if(E){const S=P==null?void 0:P[o(635)][E[o(697)]],T=(f=(u=n[o(834)](C))==null?void 0:u.get(v))==null?void 0:f.get(E==null?void 0:E[o(697)]);if(!T)return;const k=(b=T==null?void 0:T[o(489)][o(560)])!=null?b:cx[o(595)];k===cx.LINE_CHART?_4(s,a,T.config,E,S):k===cx[o(607)]?I4(s,a,T[o(489)],E,S):k===cx[o(521)]?g4(s,a,T.config,E):k===cx[o(596)]&&v4(s,a,T[o(489)],E)}};this._sheetGraphicsRenderController[t(717)](Vh,r)}[M(571)](){const t=M,e=()=>{const x=Ix;var n;(n=this._context[x(668)])==null||n[x(666)]()};this.disposeWithMe(this._sparklineDataSourceModel[t(675)][t(572)](La(300))[t(474)](e))}};vr=C4([As(1,q(K0)),As(2,q(L2)),As(3,q(Tr))],vr);var w4=Object[M(501)];Object[M(510)];var P4=(t,e,x)=>e in t?w4(t,e,{enumerable:!0,configurable:!0,writable:!0,value:x}):t[e]=x,y4=(t,e,x,n)=>{for(var r=e,s=t.length-1,i;s>=0;s--)(i=t[s])&&(r=i(r)||r);return r},x2=(t,e)=>(x,n)=>e(x,n,t),ga=(t,e,x)=>P4(t,typeof e!=M(804)?e+"":e,x);const R4=M(594);let e2=class extends kt{constructor(t=ba,e,x,n,r){const s=M;super(),this[s(492)]=t,this[s(775)]=e,this[s(615)]=x,this[s(486)]=n,this[s(534)]=r;const{menu:i,...a}=Rn({},ba,this[s(492)]);i&&this[s(775)][s(777)](s(569),i,{merge:!0}),this[s(775)][s(777)](jh,a),this._initRegisterCommand()}[M(651)](){const t=M;[[Y2],[W2],[H2],[Q2],[B2],[z2]][t(810)](e=>{const x=t;this[x(615)][x(689)](e)}),dn(this[t(615)],[[Y2]])}[M(636)](){const t=M;[[vr]][t(810)](e=>{const x=t;this._renderManagerService[x(463)](P0.UNIVER_SHEET,e)}),dn(this[t(615)],[[W2],[H2],[Q2],[B2],[z2]])}[M(653)](){const t=M;[ei,on].forEach(e=>this[t(486)].registerCommand(e))}};ga(e2,M(731),R4),ga(e2,M(560),P0[M(564)]),e2=y4([X2(zt,_r),x2(1,W0),x2(2,q(Vx)),x2(3,q(g0)),x2(4,yr)],e2);export{$e as $,xh as A,Mx as B,R0 as C,Zb as D,Gr as E,jm as F,Hm as G,Lm as H,co as I,et as J,A4 as K,Co as L,ap as M,Re as N,os as O,Qb as P,Fx as Q,Kb as R,Gb as S,gn as T,Jn as U,p0 as V,tr as W,Uo as X,Un as Y,Yb as Z,lr as _,Bm as a,Q4 as a$,Xb as a0,rr as a1,Hb as a2,qb as a3,He as a4,x8 as a5,Ce as a6,xx as a7,C0 as a8,Vb as a9,ur as aA,tx as aB,fr as aC,mr as aD,pr as aE,br as aF,qx as aG,To as aH,Ox as aI,N2 as aJ,fe as aK,cb as aL,Xr as aM,lb as aN,Pn as aO,k0 as aP,hs as aQ,D0 as aR,Kr as aS,Tx as aT,lx as aU,hh as aV,Zx as aW,Ae as aX,Oo as aY,L2 as aZ,_r as a_,xt as aa,Cn as ab,p8 as ac,K0 as ad,_x as ae,nt as af,qr as ag,cx as ah,zt as ai,e2 as aj,V4 as ak,Ld as al,$4 as am,Z1 as an,nr as ao,$n as ap,Br as aq,X0 as ar,U2 as as,sr as at,ir as au,ar as av,or as aw,dr as ax,yn as ay,cr as az,ip as b,qs as b0,hm as b1,Fr as b2,g2 as b3,lo as b4,q4 as b5,Y4 as b6,cs as b7,G4 as b8,ro as b9,Ts as ba,w2 as bb,p2 as bc,np as bd,tp as be,_2 as bf,Ji as bg,Zs as bh,$m as bi,Am as bj,Qd as bk,W4 as bl,Te as bm,Ks as bn,zd as bo,rp as bp,Z4 as bq,bm as br,K4 as bs,mm as bt,Wi as bu,jb as c,In as d,Mo as e,bs as f,fb as g,$x as h,us as i,La as j,M0 as k,q1 as l,Fn as m,Bb as n,A0 as o,we as p,Wb as q,P2 as r,zb as s,Lb as t,$b as u,Wx as v,Jb as w,On as x,e0 as y,px as z};
