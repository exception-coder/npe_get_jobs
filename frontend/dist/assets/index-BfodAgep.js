import{M as b,k as I,U as v,T as S,V as x,B as U,N as k,F as a,a as A,f as F,S as n,b as _,I as d,L as g,A as r,c as C,d as D}from"./index-ChzpeWOG.js";import{e as de,H as Ce,g as me,h as ce,z as pe,i as _e,s as fe,Q as we,j as ye,O as Te,y as be,l as Ie,m as ve,K as Se,w as xe,n as Fe,x as Ee,o as Re,p as Ne,Z as Ue,q as ke,r as Ae,t as De,$ as Oe,P as qe,W as Me,u as Be,v as Ve,C as Le,D as Pe,R as Ge,X as We,E as $e,G as He,J as je,Y as Ye,_ as Ke,a0 as Je,a1 as ze,a2 as Qe,a3 as Xe,a4 as Ze,a5 as et,a6 as tt,a7 as nt,a8 as it,a9 as rt,aa as ot}from"./index-ChzpeWOG.js";import{x as O}from"./index-CMH43F1L.js";import{O as at,$ as lt,D as ut,A as ht,H as gt,j as dt,B as Ct,W as mt,q as ct,y as pt,M as _t,I as ft}from"./index-CMH43F1L.js";import{S as q,T as M,U as c,J as p,Y as h}from"./TeamSpreadsheet-DqPQXi__.js";import{$ as yt}from"./TeamSpreadsheet-DqPQXi__.js";import{k as E,C as R,S as N}from"./facade-DJ8otAmv.js";import{O as B}from"./facade-DLk4o3Z_.js";import"./index--BQDx9CP.js";import"./index-DNSnhRIr.js";import"./index-mJOBftNs.js";import"./VRow-C6N6h8s9.js";import"./VCard-DFIDGoOa.js";import"./VSelect-CO5xudFf.js";import"./VTextField-tFIcna6m.js";import"./VTabs-BYSgCciz.js";import"./VAlert-CfJUBCCM.js";import"./VDialog-C4Wnh1zS.js";import"./VFileInput-DBMVcNlc.js";import"./VTextarea-34QBZFhW.js";var V=Object.defineProperty,L=(s,e,t)=>e in s?V(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,P=(s,e,t)=>L(s,e+"",t);class m{constructor(e={}){P(this,"_rule",{}),this._rule=e,this._ensureAttr(this._rule,["rule"])}get _ruleConfig(){return this._rule.rule||null}_getDefaultConfig(e=n.highlightCell){switch(e){case n.colorScale:return{type:e,config:[{index:0,color:new c("").toRgbString(),value:{type:d.min}},{index:0,color:new c("green").toRgbString(),value:{type:d.max}}]};case n.dataBar:return{type:e,isShowValue:!0,config:{min:{type:d.min},max:{type:d.max},positiveColor:new c("green").toRgbString(),nativeColor:new c("").toRgbString(),isGradient:!1}};case n.highlightCell:return{type:e,subType:r.text,operator:g.containsText,value:"abc",style:{}};case n.iconSet:return{type:e,isShowValue:!0,config:[{operator:a.greaterThanOrEqual,value:{type:d.min},iconType:_,iconId:""},{operator:a.greaterThanOrEqual,value:{type:d.percentile,value:.5},iconType:_,iconId:""},{operator:a.lessThanOrEqual,value:{type:d.max},iconType:_,iconId:""}]}}}_ensureAttr(e,t){return t.reduce((o,l)=>(o[l]||(o[l]={}),o[l]),e),e}build(){var e;this._rule.cfId||(this._rule.cfId=C()),this._rule.ranges||(this._rule.ranges=[]),this._rule.stopIfTrue===void 0&&(this._rule.stopIfTrue=!1),(e=this._rule.rule)!=null&&e.type||(this._rule.rule.type=n.highlightCell,this._ensureAttr(this._rule,["rule","style"]));const t=this._getDefaultConfig(this._rule.rule.type);return{...this._rule,rule:{...t,...this._rule.rule}}}copy(){const e=p.deepClone(this._rule);return e.cfId&&(e.cfId=C()),new m(e)}getRanges(){return this._rule.ranges||[]}getIconMap(){return F}createCfId(){return C()}setRanges(e){return this._rule.ranges=e,this}}class i extends m{constructor(e={}){super(e),this._ensureAttr(this._rule,["rule","style"])}copy(){const e=p.deepClone(this._rule);return e.cfId&&(e.cfId=C()),new i(e)}setAverage(e){const t=this._ruleConfig;return t.type=n.highlightCell,t.subType=r.average,t.operator=e,this}setUniqueValues(){const e=this._ruleConfig;return e.type=n.highlightCell,e.subType=r.uniqueValues,this}setDuplicateValues(){const e=this._ruleConfig;return e.type=n.highlightCell,e.subType=r.duplicateValues,this}setRank(e){const t=this._ruleConfig;return t.type=n.highlightCell,t.subType=r.rank,t.isBottom=e.isBottom,t.isPercent=e.isPercent,t.value=e.value,this}setBackground(e){var t;if(((t=this._ruleConfig)==null?void 0:t.type)===n.highlightCell)if(e){this._ensureAttr(this._ruleConfig,["style","bg"]);const o=new c(e);this._ruleConfig.style.bg.rgb=o.toRgbString()}else delete this._ruleConfig.style.bg;return this}setBold(e){var t;return((t=this._ruleConfig)==null?void 0:t.type)===n.highlightCell&&(this._ensureAttr(this._ruleConfig,["style"]),this._ruleConfig.style.bl=e?h.TRUE:h.FALSE),this}setFontColor(e){var t;if(((t=this._ruleConfig)==null?void 0:t.type)===n.highlightCell)if(e){const o=new c(e);this._ensureAttr(this._ruleConfig,["style","cl"]),this._ruleConfig.style.cl.rgb=o.toRgbString()}else delete this._ruleConfig.style.cl;return this}setItalic(e){var t;return((t=this._ruleConfig)==null?void 0:t.type)===n.highlightCell&&(this._ensureAttr(this._ruleConfig,["style"]),this._ruleConfig.style.it=e?h.TRUE:h.FALSE),this}setStrikethrough(e){var t;return((t=this._ruleConfig)==null?void 0:t.type)===n.highlightCell&&(this._ensureAttr(this._ruleConfig,["style","st"]),this._ruleConfig.style.st.s=e?h.TRUE:h.FALSE),this}setUnderline(e){var t;return((t=this._ruleConfig)==null?void 0:t.type)===n.highlightCell&&(this._ensureAttr(this._ruleConfig,["style","ul"]),this._ruleConfig.style.ul.s=e?h.TRUE:h.FALSE),this}whenCellEmpty(){const e=this._ruleConfig;return e.type=n.highlightCell,e.subType=r.text,e.value="",e.operator=g.equal,this}whenCellNotEmpty(){const e=this._ruleConfig;return e.type=n.highlightCell,e.subType=r.text,e.value="",e.operator=g.notEqual,this}whenDate(e){const t=this._ruleConfig;return t.type=n.highlightCell,t.subType=r.timePeriod,t.operator=e,this}whenFormulaSatisfied(e){const t=this._ruleConfig;return t.type=n.highlightCell,t.subType=r.formula,t.value=e,this}whenNumberBetween(e,t){const o=Math.min(e,t),l=Math.max(e,t),u=this._ruleConfig;return u.type=n.highlightCell,u.subType=r.number,u.value=[o,l],u.operator=a.between,this}whenNumberEqualTo(e){const t=this._ruleConfig;return t.type=n.highlightCell,t.subType=r.number,t.value=e,t.operator=a.equal,this}whenNumberGreaterThan(e){const t=this._ruleConfig;return t.type=n.highlightCell,t.subType=r.number,t.value=e,t.operator=a.greaterThan,this}whenNumberGreaterThanOrEqualTo(e){const t=this._ruleConfig;return t.type=n.highlightCell,t.subType=r.number,t.value=e,t.operator=a.greaterThanOrEqual,this}whenNumberLessThan(e){const t=this._ruleConfig;return t.type=n.highlightCell,t.subType=r.number,t.value=e,t.operator=a.lessThan,this}whenNumberLessThanOrEqualTo(e){const t=this._ruleConfig;return t.type=n.highlightCell,t.subType=r.number,t.value=e,t.operator=a.lessThanOrEqual,this}whenNumberNotBetween(e,t){const o=Math.min(e,t),l=Math.max(e,t),u=this._ruleConfig;return u.type=n.highlightCell,u.subType=r.number,u.value=[o,l],u.operator=a.notBetween,this}whenNumberNotEqualTo(e){const t=this._ruleConfig;return t.type=n.highlightCell,t.subType=r.number,t.value=e,t.operator=a.notEqual,this}whenTextContains(e){const t=this._ruleConfig;return t.type=n.highlightCell,t.subType=r.text,t.value=e,t.operator=g.containsText,this}whenTextDoesNotContain(e){const t=this._ruleConfig;return t.type=n.highlightCell,t.subType=r.text,t.value=e,t.operator=g.notContainsText,this}whenTextEndsWith(e){const t=this._ruleConfig;return t.type=n.highlightCell,t.subType=r.text,t.value=e,t.operator=g.endsWith,this}whenTextEqualTo(e){const t=this._ruleConfig;return t.type=n.highlightCell,t.subType=r.text,t.value=e,t.operator=g.equal,this}whenTextStartsWith(e){const t=this._ruleConfig;return t.type=n.highlightCell,t.subType=r.text,t.value=e,t.operator=g.beginsWith,this}}class w extends m{copy(){const e=p.deepClone(this._rule);return e.cfId&&(e.cfId=C()),new w(e)}setDataBar(e){const t=this._ruleConfig;return t.type=n.dataBar,t.isShowValue=!!e.isShowValue,t.config={min:e.min,max:e.max,positiveColor:e.positiveColor,nativeColor:e.nativeColor,isGradient:!!e.isGradient},this}}class y extends m{copy(){const e=p.deepClone(this._rule);return e.cfId&&(e.cfId=C()),new y(e)}setColorScale(e){const t=this._ruleConfig;return t.type=n.colorScale,t.config=e,this}}class T extends m{copy(){const e=p.deepClone(this._rule);return e.cfId&&(e.cfId=C()),new T(e)}setIconSet(e){const t=this._ruleConfig;return t.type=n.iconSet,t.config=e.iconConfigs,t.isShowValue=e.isShowValue,this}}class f{constructor(e={}){this._initConfig=e}build(){return new m(this._initConfig).build()}setAverage(e){return new i(this._initConfig).setAverage(e)}setUniqueValues(){return new i(this._initConfig).setUniqueValues()}setDuplicateValues(){return new i(this._initConfig).setDuplicateValues()}setRank(e){return new i(this._initConfig).setRank(e)}getIconMap(){return F}setIconSet(e){return new T(this._initConfig).setIconSet(e)}setColorScale(e){return new y(this._initConfig).setColorScale(e)}setDataBar(e){return new w(this._initConfig).setDataBar(e)}setBackground(e){return new i(this._initConfig).setBackground(e)}setBold(e){return new i(this._initConfig).setBold(e)}setFontColor(e){return new i(this._initConfig).setFontColor(e)}setItalic(e){return new i(this._initConfig).setItalic(e)}setStrikethrough(e){return new i(this._initConfig).setStrikethrough(e)}setUnderline(e){return new i(this._initConfig).setUnderline(e)}whenCellEmpty(){return new i(this._initConfig).whenCellEmpty()}whenCellNotEmpty(){return new i(this._initConfig).whenCellNotEmpty()}whenDate(e){return new i(this._initConfig).whenDate(e)}whenFormulaSatisfied(e){return new i(this._initConfig).whenFormulaSatisfied(e)}whenNumberBetween(e,t){return new i(this._initConfig).whenNumberBetween(e,t)}whenNumberEqualTo(e){return new i(this._initConfig).whenNumberEqualTo(e)}whenNumberGreaterThan(e){return new i(this._initConfig).whenNumberGreaterThan(e)}whenNumberGreaterThanOrEqualTo(e){return new i(this._initConfig).whenNumberGreaterThanOrEqualTo(e)}whenNumberLessThan(e){return new i(this._initConfig).whenNumberLessThan(e)}whenNumberLessThanOrEqualTo(e){return new i(this._initConfig).whenNumberLessThanOrEqualTo(e)}whenNumberNotBetween(e,t){return new i(this._initConfig).whenNumberNotBetween(e,t)}whenNumberNotEqualTo(e){return new i(this._initConfig).whenNumberNotEqualTo(e)}whenTextContains(e){return new i(this._initConfig).whenTextContains(e)}whenTextDoesNotContain(e){return new i(this._initConfig).whenTextDoesNotContain(e)}whenTextEndsWith(e){return new i(this._initConfig).whenTextEndsWith(e)}whenTextEqualTo(e){return new i(this._initConfig).whenTextEqualTo(e)}whenTextStartsWith(e){return new i(this._initConfig).whenTextStartsWith(e)}}class G extends E{_getConditionalFormattingRuleModel(){return this._injector.get(b)}getConditionalFormattingRules(){return[...this._getConditionalFormattingRuleModel().getSubunitRules(this._workbook.getUnitId(),this._worksheet.getSheetId())||[]].filter(e=>e.ranges.some(t=>q.intersects(t,this._range)))}createConditionalFormattingRule(){return new f({ranges:[this._range]})}addConditionalFormattingRule(e){const t={unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),rule:e};return this._commandService.syncExecuteCommand(I.id,t),this}deleteConditionalFormattingRule(e){const t={unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),cfId:e};return this._commandService.syncExecuteCommand(v.id,t),this}moveConditionalFormattingRule(e,t,o="after"){const l={unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),start:{id:e,type:"self"},end:{id:t,type:o}};return this._commandService.syncExecuteCommand(S.id,l),this}setConditionalFormattingRule(e,t){const o={unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),rule:t,cfId:e};return this._commandService.syncExecuteCommand(x.id,o),this}clearConditionalFormatRules(){const e={unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),ranges:[this._range]};return this._commandService.syncExecuteCommand(U.id,e),this}}E.extend(G);class W extends R{newColor(){return new M}}R.extend(W);class $ extends N{_getConditionalFormattingRuleModel(){return this._injector.get(b)}getConditionalFormattingRules(){return[...this._getConditionalFormattingRuleModel().getSubunitRules(this._workbook.getUnitId(),this._worksheet.getSheetId())||[]]}createConditionalFormattingRule(){return new f}newConditionalFormattingRule(){return new f}addConditionalFormattingRule(e){const t={unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),rule:e};return this._commandService.syncExecuteCommand(I.id,t),this}deleteConditionalFormattingRule(e){const t={unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),cfId:e};return this._commandService.syncExecuteCommand(v.id,t),this}moveConditionalFormattingRule(e,t,o="after"){const l={unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),start:{id:e,type:"self"},end:{id:t,type:o}};return this._commandService.syncExecuteCommand(S.id,l),this}setConditionalFormattingRule(e,t){const o={unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),cfId:e,rule:t};return this._commandService.syncExecuteCommand(x.id,o),this}clearConditionalFormatRules(){const e={unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId()};return this._commandService.syncExecuteCommand(k.id,e),this}}N.extend($);class H{get ConditionFormatNumberOperatorEnum(){return a}get ConditionFormatTimePeriodOperatorEnum(){return A}}B.extend(H);function ue(){return{plugins:[D,O].filter(s=>!!s)}}export{at as AddAverageCfCommand,I as AddCfCommand,lt as AddColorScaleConditionalRuleCommand,de as AddConditionalRuleMutation,Ce as AddConditionalRuleMutationUndoFactory,ut as AddDataBarConditionalRuleCommand,ht as AddDuplicateValuesCfCommand,gt as AddNumberCfCommand,dt as AddRankCfCommand,Ct as AddTextCfCommand,mt as AddTimePeriodCfCommand,ct as AddUniqueValuesCfCommand,a as CFNumberOperator,n as CFRuleType,r as CFSubRuleType,g as CFTextOperator,A as CFTimePeriodOperator,d as CFValueType,me as CONDITIONAL_FORMATTING_VIEWPORT_CACHE_LENGTH,U as ClearRangeCfCommand,k as ClearWorksheetCfCommand,pt as ConditionalFormattingClearController,ce as ConditionalFormattingFormulaMarkDirty,pe as ConditionalFormattingFormulaService,_e as ConditionalFormattingIcon,b as ConditionalFormattingRuleModel,fe as ConditionalFormattingService,we as ConditionalFormattingViewModel,ye as DEFAULT_BG_COLOR,Te as DEFAULT_FONT_COLOR,be as DEFAULT_PADDING,Ie as DEFAULT_WIDTH,ve as DataBar,v as DeleteCfCommand,Se as DeleteConditionalRuleMutation,xe as DeleteConditionalRuleMutationUndoFactory,_ as EMPTY_ICON_TYPE,Fe as FormulaResultStatus,Ee as IconUKey,S as MoveCfCommand,Re as MoveConditionalRuleMutation,Ne as MoveConditionalRuleMutationUndoFactory,_t as OpenConditionalFormattingOperator,Ue as SHEET_CONDITIONAL_FORMATTING_PLUGIN,x as SetCfCommand,ke as SetConditionalRuleMutation,ft as UniverSheetsConditionalFormattingMobileUIPlugin,D as UniverSheetsConditionalFormattingPlugin,ue as UniverSheetsConditionalFormattingPreset,O as UniverSheetsConditionalFormattingUIPlugin,Ae as anchorUndoFactory,De as compareWithNumber,C as createCfId,Oe as createDefaultRule,qe as createDefaultValue,Me as createDefaultValueByValueType,Be as dataBarUKey,Ve as defaultDataBarNativeColor,Le as defaultDataBarPositiveColor,Pe as defaultPlaceholderColor,Ge as filterRange,We as findIndexByAnchor,$e as getCacheStyleMatrix,He as getCellValue,je as getColorScaleFromValue,Ye as getMaxInFormulaResult,Ke as getOppositeOperator,Je as getValueByType,ze as iconGroup,F as iconMap,Qe as isAnchorEqual,Xe as isFloatsEqual,Ze as isNullable,yt as isRangesEqual,et as moveByAnchor,tt as removeUndefinedAttr,nt as serialTimeToTimestamp,it as setConditionalRuleMutationUndoFactory,rt as toYMD_1900,ot as transformSupportSymmetryAnchor};
