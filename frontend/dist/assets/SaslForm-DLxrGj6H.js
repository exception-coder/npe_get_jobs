import{k as R,r as nl,m as Y,w as de,bc as Tt,z as be,A as fe,B as ze,I as Se,Q as d,e as t,j as K,aQ as Ie,az as it,X as te,as as qe,aG as ut,bd as Vt,Y as st,W as Qe,aL as ol,be as He,G as ve,H as Je,C as Xe,Z as nt,g as ne,K as Pe,bf as rl,ai as We,aA as Dt,s as ue,bg as ht,bh as il,b7 as xt,bi as ul,ad as sl,bj as dl,bk as cl,F as ke,E as ml,bl as vl,_ as dt,d as Mt,u as Nt,c as De,o as j,b as m,f as T,V as me,i as ot,x as re,p as ae,a0 as at,aV as fl,l as Re,q as Te,b8 as hl,bm as gl,n as yl,a2 as kl,y as bl,t as Sl}from"./index-mJOBftNs.js";import{l as wl,g as Cl,a as pl,u as _l,s as Tl,b as Vl}from"./saslConfigApi-CCPBd-Wj.js";import{V as Ue,a as rt,b as Fe,c as Ze}from"./VCard-DFIDGoOa.js";import{V as Pt}from"./VForm-BTvn18MX.js";import{V as xe,a as B}from"./VRow-C6N6h8s9.js";import{V as se}from"./VTextField-tFIcna6m.js";import{V as Ke,a as At}from"./VSelect-CO5xudFf.js";import{V as Be,m as Dl}from"./VSheet-DbNfniB_.js";import{V as Et}from"./VTextarea-34QBZFhW.js";import{V as xl}from"./VDialog-C4Wnh1zS.js";import{_ as $t}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as gt}from"./VAlert-CfJUBCCM.js";import{V as Ml,a as Nl,b as Pl,c as Al}from"./VTabs-BYSgCciz.js";const Ot=()=>{const e=R(!1),u=R(!1),b=R(!1),y=R(),o=R(""),h=R(null),V=R(null),S=R([]),C=R(null),p=["5G Premium","數據王+","企業專線"],i=R(p[0]),g=nl({oldContract:"",mrtNumber:"",lastTurnNetworkMonth:"",category:"",sales:"",lastCallTime:"",callStatus:"",nextCallTime:"",remark:""}),_=["NA","拒絕","考慮","登記"],$=R([]),O=R(!1),r=async()=>{if(!O.value){O.value=!0;try{const I=await pl();$.value=I}catch(I){console.error("获取文档标题失败",I)}finally{O.value=!1}}},D=R([]),f=R(!1),x=R(""),G=I=>({id:I.planId||String(I.id),title:I.title,subtitle:I.subtitle,columns:I.columns||[],rows:(I.rows||[]).map(w=>({label:w.label,values:w.values||[]})),footnote:I.footnote}),A=async()=>{if(!f.value){f.value=!0;try{const I=await wl();D.value=I.map(G),D.value.length>0&&!x.value&&(x.value=D.value[0].id)}catch(I){console.error("获取套餐方案失败",I),D.value=[]}finally{f.value=!1}}},M=R([{label:"當日致電數",value:"0",trend:"",tone:"up",icon:"mdi-account-multiple-check"},{label:"本月登記數",value:"0",trend:"",tone:"up",icon:"mdi-headset"},{label:"待跟進客戶數",value:"0",trend:"",tone:"down",icon:"mdi-progress-clock"}]),L=R(!1),le=async()=>{var I,w,H,z,E,q;if(!L.value){L.value=!0;try{const s=await Cl();if(s){const v=c=>c==null?"":`${Number(c).toFixed(2)}%`,l=c=>c==null||c>=0?"up":"down";M.value=[{label:"當日致電數",value:(s.todayCallCount??0).toString(),trend:v((I=s.trend)==null?void 0:I.todayCallCountTrend),tone:l((w=s.trend)==null?void 0:w.todayCallCountTrend),icon:"mdi-headset"},{label:"本月登記數",value:(s.monthlyRegisteredCount??0).toString(),trend:v((H=s.trend)==null?void 0:H.monthlyRegisteredCountTrend),tone:l((z=s.trend)==null?void 0:z.monthlyRegisteredCountTrend),icon:"mdi-account-multiple-check"},{label:"待跟進客戶數",value:(s.pendingFollowUpCount??0).toString(),trend:v((E=s.trend)==null?void 0:E.pendingFollowUpCountTrend),tone:l((q=s.trend)==null?void 0:q.pendingFollowUpCountTrend),icon:"mdi-progress-clock"}]}else M.value=[{label:"當日致電數",value:"0",trend:"",tone:"up",icon:"mdi-headset"},{label:"本月登記數",value:"0",trend:"",tone:"up",icon:"mdi-account-multiple-check"},{label:"待跟進客戶數",value:"0",trend:"",tone:"down",icon:"mdi-progress-clock"}]}catch(s){console.error("获取统计数据失败",s)}finally{L.value=!1}}},Z={required:I=>I.trim().length>0||"此欄位為必填",mrtNumber:I=>/^\d{8,11}$/.test(I)||"請輸入 8-11 位數字",turnMonth:I=>/^\d{6}$/.test(I)||"請輸入 6 位年月，例如 202011",nextCallTime:I=>{if(!I||I.trim().length===0)return!0;const w=new Date(I),H=new Date;return isNaN(w.getTime())?"請選擇有效的日期時間":w<=H?"下次致電時間必須大於當前時間":!0}},X=Y(()=>Object.values(g).some(I=>typeof I=="string"?I.trim().length>0:!1)),oe=Y(()=>[{label:"MRT 號碼",value:g.mrtNumber,icon:"mdi-cellphone"},{label:"類別",value:g.category,icon:"mdi-tag"},{label:"最後轉網月份",value:g.lastTurnNetworkMonth,icon:"mdi-calendar-month"},{label:"上次致電時間",value:g.lastCallTime,icon:"mdi-clock-outline"},{label:"舊合約",value:g.oldContract,icon:"mdi-calendar"},{label:"銷售員",value:g.sales,icon:"mdi-account-tie"},{label:"致電狀態",value:g.callStatus,icon:"mdi-phone"},{label:"下次致電時間",value:g.nextCallTime,icon:"mdi-clock-time-four-outline"},{label:"備註",value:g.remark,icon:"mdi-note-text-outline"}]);return{loading:e,submitting:u,searchingMrt:b,formRef:y,mrtSearch:o,searchCallStatus:h,searchDataSource:V,searchResults:S,selectedRecord:C,telecomTags:p,selectedTag:i,form:g,callStatusOptions:_,dataSourceOptions:$,loadingDocumentTitles:O,loadDocumentTitles:r,heroStats:M,loadingHeroStats:L,loadHeroStats:le,rules:Z,isFormFilled:X,previewItems:oe,planComparisonSections:D,loadingPlanSections:f,loadPlanSections:A,activePlanTab:x}},El=500,Rt=(e,u)=>{let b=null;const y=()=>{b&&(clearTimeout(b),b=null)},o=async()=>{if(!e.searchDataSource.value){u.show({message:"請選擇數據源",color:"warning"});return}e.searchingMrt.value=!0;try{const i={mrt:e.mrtSearch.value.trim()||void 0,callStatus:e.searchCallStatus.value||void 0,documentTitle:e.searchDataSource.value||void 0},g=await Tl(i);if(e.searchResults.value=g,g.length===0)u.show({message:"未找到匹配的記錄",color:"info"}),Object.assign(e.form,{oldContract:"",mrtNumber:"",lastTurnNetworkMonth:"",category:"",sales:"",lastCallTime:"",callStatus:"",nextCallTime:"",remark:""}),e.selectedRecord.value=null;else{const _=g[0];e.selectedRecord.value=_,V(_),u.show({message:`找到 ${g.length} 條記錄`,color:"success"})}}catch(i){console.error("搜索失敗",i),u.show({message:"搜索失敗，請稍後重試",color:"error"}),e.searchResults.value=[]}finally{e.searchingMrt.value=!1}},h=i=>{if(!i)return"";try{const g=new Date(i),_=g.getFullYear(),$=String(g.getMonth()+1).padStart(2,"0"),O=String(g.getDate()).padStart(2,"0"),r=String(g.getHours()).padStart(2,"0"),D=String(g.getMinutes()).padStart(2,"0");return`${_}-${$}-${O} ${r}:${D}`}catch{return""}},V=i=>{Object.assign(e.form,{oldContract:i.oldContract||"",mrtNumber:i.mrt||"",lastTurnNetworkMonth:i.lastTurnNetworkMonth||"",category:i.category||"",sales:i.sales||"",lastCallTime:i.lastCallTime?new Date(i.lastCallTime).toLocaleString("zh-CN"):i.updatedAt?new Date(i.updatedAt).toLocaleString("zh-CN"):"",callStatus:i.callStatus||"",nextCallTime:i.nextCallTime?h(i.nextCallTime):"",remark:i.remark||""})},S=()=>{y(),e.searchDataSource.value&&(b=window.setTimeout(()=>{o()},El))};de([e.mrtSearch,e.searchCallStatus,e.searchDataSource],S);const C=i=>!i||!i.trim()?void 0:i.trim().replace(" ","T")+":00",p=async()=>{var g,_;const i=await((_=(g=e.formRef.value)==null?void 0:g.validate)==null?void 0:_.call(g));if((i==null?void 0:i.valid)===!1){u.show({message:"請先修正表單校驗錯誤",color:"warning"});return}if(!e.selectedRecord.value||!e.selectedRecord.value.id){u.show({message:"請先選擇一條記錄",color:"warning"});return}e.submitting.value=!0;try{const $=C(e.form.nextCallTime),O=await _l(e.selectedRecord.value.id,{callStatus:e.form.callStatus,remark:e.form.remark||void 0,nextCallTime:$,documentTitle:e.searchDataSource.value||void 0,queryCallStatus:e.searchCallStatus.value||void 0});O.nextRecord?(e.selectedRecord.value=O.nextRecord,V(O.nextRecord),u.show({message:"記錄已成功更新，已加載下一條記錄",color:"success"})):(e.selectedRecord.value=O.updatedRecord,O.updatedRecord.lastCallTime?e.form.lastCallTime=new Date(O.updatedRecord.lastCallTime).toLocaleString("zh-CN"):O.updatedRecord.updatedAt&&(e.form.lastCallTime=new Date(O.updatedRecord.updatedAt).toLocaleString("zh-CN")),u.show({message:"記錄已成功更新",color:"success"}))}catch($){console.error("更新記錄失敗",$);let O="更新失敗，請稍後重試";$!=null&&$.payload&&typeof $.payload=="object"&&"message"in $.payload&&(O=String($.payload.message)),u.show({message:O,color:"error"})}finally{e.submitting.value=!1}};return Tt(()=>{y()}),{performSearch:o,handleSubmit:p,fillFormFromRecord:V}},It=fe({active:{type:[String,Array],default:void 0},controlHeight:[Number,String],disabled:{type:[Boolean,String,Array],default:null},nextIcon:{type:qe,default:"$next"},prevIcon:{type:qe,default:"$prev"},modeIcon:{type:qe,default:"$subgroup"},text:String,viewMode:{type:String,default:"month"}},"VDatePickerControls"),yt=be()({name:"VDatePickerControls",props:It(),emits:{"click:year":()=>!0,"click:month":()=>!0,"click:prev":()=>!0,"click:next":()=>!0,"click:text":()=>!0},setup(e,u){let{emit:b}=u;const{t:y}=ze(),o=Y(()=>Array.isArray(e.disabled)?e.disabled.includes("text"):!!e.disabled),h=Y(()=>Array.isArray(e.disabled)?e.disabled.includes("mode"):!!e.disabled),V=Y(()=>Array.isArray(e.disabled)?e.disabled.includes("prev"):!!e.disabled),S=Y(()=>Array.isArray(e.disabled)?e.disabled.includes("next"):!!e.disabled);function C(){b("click:prev")}function p(){b("click:next")}function i(){b("click:year")}function g(){b("click:month")}return Se(()=>d("div",{class:te(["v-date-picker-controls"]),style:{"--v-date-picker-controls-height":it(e.controlHeight)}},[t(K,{class:"v-date-picker-controls__month-btn","data-testid":"month-btn",disabled:o.value,text:e.text,variant:"text",rounded:!0,onClick:g},null),t(K,{class:"v-date-picker-controls__mode-btn","data-testid":"year-btn",disabled:h.value,density:"comfortable",icon:e.modeIcon,variant:"text","aria-label":y("$vuetify.datePicker.ariaLabel.selectYear"),onClick:i},null),t(Ie,null,null),d("div",{class:"v-date-picker-controls__month"},[t(K,{"data-testid":"prev-month",disabled:V.value,density:"comfortable",icon:e.prevIcon,variant:"text","aria-label":y("$vuetify.datePicker.ariaLabel.previousMonth"),onClick:C},null),t(K,{"data-testid":"next-month",disabled:S.value,icon:e.nextIcon,density:"comfortable",variant:"text","aria-label":y("$vuetify.datePicker.ariaLabel.nextMonth"),onClick:p},null)])])),{}}}),$l=fe({appendIcon:qe,color:String,header:String,transition:String,onClick:ol()},"VDatePickerHeader"),kt=be()({name:"VDatePickerHeader",props:$l(),emits:{click:()=>!0,"click:append":()=>!0},setup(e,u){let{emit:b,slots:y}=u;const{backgroundColorClasses:o,backgroundColorStyles:h}=ut(()=>e.color);function V(){b("click")}function S(){b("click:append")}return Se(()=>{const C=!!(y.default||e.header),p=!!(y.append||e.appendIcon);return d("div",{class:te(["v-date-picker-header",{"v-date-picker-header--clickable":!!e.onClick},o.value]),style:Qe(h.value),onClick:V},[y.prepend&&d("div",{key:"prepend",class:"v-date-picker-header__prepend"},[y.prepend()]),C&&t(Vt,{key:"content",name:e.transition},{default:()=>{var i;return[d("div",{key:e.header,class:"v-date-picker-header__content"},[((i=y.default)==null?void 0:i.call(y))??e.header])]}}),p&&d("div",{class:"v-date-picker-header__append"},[y.append?t(st,{key:"append-defaults",disabled:!e.appendIcon,defaults:{VBtn:{icon:e.appendIcon,variant:"text"}}},{default:()=>{var i;return[(i=y.append)==null?void 0:i.call(y)]}}):t(K,{key:"append-btn",icon:e.appendIcon,variant:"text",onClick:S},null)])])}),{}}}),Ol=fe({allowedDates:[Array,Function],disabled:{type:Boolean,default:null},displayValue:null,modelValue:Array,month:[Number,String],max:null,min:null,showAdjacentMonths:Boolean,year:[Number,String],weekdays:{type:Array,default:()=>[0,1,2,3,4,5,6]},weeksInMonth:{type:String,default:"dynamic"},firstDayOfWeek:{type:[Number,String],default:void 0},firstDayOfYear:{type:[Number,String],default:void 0},weekdayFormat:String},"calendar");function Rl(e){const u=He(),b=ve(e,"modelValue",[],r=>Je(r).map(D=>u.date(D))),y=Y(()=>e.displayValue?u.date(e.displayValue):b.value.length>0?u.date(b.value[0]):e.min?u.date(e.min):Array.isArray(e.allowedDates)?u.date(e.allowedDates[0]):u.date()),o=ve(e,"year",void 0,r=>{const D=r!=null?Number(r):u.getYear(y.value);return u.startOfYear(u.setYear(u.date(),D))},r=>u.getYear(r)),h=ve(e,"month",void 0,r=>{const D=r!=null?Number(r):u.getMonth(y.value),f=u.setYear(u.startOfMonth(u.date()),u.getYear(o.value));return u.setMonth(f,D)},r=>u.getMonth(r)),V=Y(()=>{const r=u.toJsDate(u.startOfWeek(u.date(),e.firstDayOfWeek)).getDay();return u.getWeekdays(e.firstDayOfWeek,e.weekdayFormat).filter((D,f)=>e.weekdays.includes((f+r)%7))}),S=Y(()=>{const r=u.getWeekArray(h.value,e.firstDayOfWeek),D=r.flat(),f=6*7;if(e.weeksInMonth==="static"&&D.length<f){const x=D[D.length-1];let G=[];for(let A=1;A<=f-D.length;A++)G.push(u.addDays(x,A)),A%7===0&&(r.push(G),G=[])}return r});function C(r,D){return r.filter(f=>e.weekdays.includes(u.toJsDate(f).getDay())).map((f,x)=>{const G=u.toISO(f),A=!u.isSameMonth(f,h.value),M=u.isSameDay(f,u.startOfMonth(h.value)),L=u.isSameDay(f,u.endOfMonth(h.value)),le=u.isSameDay(f,h.value),Z=e.weekdays.length;return{date:f,formatted:u.format(f,"keyboardDate"),isAdjacent:A,isDisabled:O(f),isEnd:L,isHidden:A&&!e.showAdjacentMonths,isSame:le,isSelected:b.value.some(X=>u.isSameDay(f,X)),isStart:M,isToday:u.isSameDay(f,D),isWeekEnd:x%Z===Z-1,isWeekStart:x%Z===0,isoDate:G,localized:u.format(f,"dayOfMonth"),month:u.getMonth(f),year:u.getYear(f)}})}const p=Y(()=>{const r=u.startOfWeek(y.value,e.firstDayOfWeek),D=[];for(let x=0;x<=6;x++)D.push(u.addDays(r,x));const f=u.date();return C(D,f)}),i=Y(()=>{const r=S.value.flat(),D=u.date();return C(r,D)}),g=Y(()=>S.value.map(r=>r.length?u.getWeek(r[0],e.firstDayOfWeek,e.firstDayOfYear):null)),{minDate:_,maxDate:$}=Ht(e);function O(r){if(e.disabled)return!0;const D=u.date(r);return _.value&&u.isBefore(u.endOfDay(D),_.value)||$.value&&u.isAfter(D,$.value)?!0:Array.isArray(e.allowedDates)&&e.allowedDates.length>0?!e.allowedDates.some(f=>u.isSameDay(u.date(f),D)):typeof e.allowedDates=="function"?!e.allowedDates(D):!1}return{displayValue:y,daysInMonth:i,daysInWeek:p,genDays:C,model:b,weeksInMonth:S,weekdayLabels:V,weekNumbers:g}}function Ht(e){const u=He(),b=Y(()=>{if(!e.min)return null;const V=u.date(e.min);return u.isValid(V)?V:null}),y=Y(()=>{if(!e.max)return null;const V=u.date(e.max);return u.isValid(V)?V:null});function o(V){return b.value&&u.isBefore(V,b.value)?b.value:y.value&&u.isAfter(V,y.value)?y.value:V}function h(V){return(!b.value||u.isAfter(V,b.value))&&(!y.value||u.isBefore(V,y.value))}return{minDate:b,maxDate:y,clampDate:o,isInAllowedRange:h}}const Yt=fe({color:String,hideWeekdays:Boolean,multiple:[Boolean,Number,String],showWeek:Boolean,transition:{type:String,default:"picker-transition"},reverseTransition:{type:String,default:"picker-reverse-transition"},...Pe(Ol(),["displayValue"])},"VDatePickerMonth"),bt=be()({name:"VDatePickerMonth",props:Yt(),emits:{"update:modelValue":e=>!0,"update:month":e=>!0,"update:year":e=>!0},setup(e,u){let{emit:b,slots:y}=u;const o=R(),{t:h}=ze(),{daysInMonth:V,model:S,weekNumbers:C,weekdayLabels:p}=Rl(e),i=He(),g=Xe(),_=Xe(),$=Xe(!1),O=nt(()=>$.value?e.reverseTransition:e.transition);e.multiple==="range"&&S.value.length>0&&(g.value=S.value[0],S.value.length>1&&(_.value=S.value[S.value.length-1]));const r=Y(()=>{const A=["number","string"].includes(typeof e.multiple)?Number(e.multiple):1/0;return S.value.length>=A});de(V,(A,M)=>{M&&($.value=i.isBefore(A[0].date,M[0].date))});function D(A){const M=i.startOfDay(A);if(S.value.length===0?g.value=void 0:S.value.length===1&&(g.value=S.value[0],_.value=void 0),!g.value)g.value=M,S.value=[g.value];else if(_.value)g.value=A,_.value=void 0,S.value=[g.value];else{if(i.isSameDay(M,g.value)){g.value=void 0,S.value=[];return}else i.isBefore(M,g.value)?(_.value=i.endOfDay(g.value),g.value=M):_.value=i.endOfDay(M);S.value=rl(i,g.value,_.value)}}function f(A){const M=i.format(A.date,"fullDateWithWeekday"),L=A.isToday?"currentDate":"selectDate";return h(`$vuetify.datePicker.ariaLabel.${L}`,M)}function x(A){const M=S.value.findIndex(L=>i.isSameDay(L,A));if(M===-1)S.value=[...S.value,A];else{const L=[...S.value];L.splice(M,1),S.value=L}}function G(A){e.multiple==="range"?D(A):e.multiple?x(A):S.value=[A]}Se(()=>d("div",{class:"v-date-picker-month",style:{"--v-date-picker-days-in-week":e.weekdays.length}},[e.showWeek&&d("div",{key:"weeks",class:"v-date-picker-month__weeks"},[!e.hideWeekdays&&d("div",{key:"hide-week-days",class:"v-date-picker-month__day"},[ne(" ")]),C.value.map(A=>d("div",{class:te(["v-date-picker-month__day","v-date-picker-month__day--adjacent"])},[A]))]),t(Vt,{name:O.value},{default:()=>{var A;return[d("div",{ref:o,key:(A=V.value[0].date)==null?void 0:A.toString(),class:"v-date-picker-month__days"},[!e.hideWeekdays&&p.value.map(M=>d("div",{class:te(["v-date-picker-month__day","v-date-picker-month__weekday"])},[M])),V.value.map((M,L)=>{var Z;const le={props:{class:"v-date-picker-month__day-btn",color:M.isSelected||M.isToday?e.color:void 0,disabled:M.isDisabled,icon:!0,ripple:!1,text:M.localized,variant:M.isSelected?"flat":M.isToday?"outlined":"text","aria-label":f(M),"aria-current":M.isToday?"date":void 0,onClick:()=>G(M.date)},item:M,i:L};return r.value&&!M.isSelected&&(M.isDisabled=!0),d("div",{class:te(["v-date-picker-month__day",{"v-date-picker-month__day--adjacent":M.isAdjacent,"v-date-picker-month__day--hide-adjacent":M.isHidden,"v-date-picker-month__day--selected":M.isSelected,"v-date-picker-month__day--week-end":M.isWeekEnd,"v-date-picker-month__day--week-start":M.isWeekStart}]),"data-v-date":M.isDisabled?void 0:M.isoDate},[(e.showAdjacentMonths||!M.isAdjacent)&&(((Z=y.day)==null?void 0:Z.call(y,le))??t(K,le.props,null))])})])]}})]))}}),Lt=fe({color:String,height:[String,Number],min:null,max:null,modelValue:Number,year:Number,allowedMonths:[Array,Function]},"VDatePickerMonths"),St=be()({name:"VDatePickerMonths",props:Lt(),emits:{"update:modelValue":e=>!0},setup(e,u){let{emit:b,slots:y}=u;const o=He(),h=ve(e,"modelValue"),V=Y(()=>{let C=o.startOfYear(o.date());return e.year&&(C=o.setYear(C,e.year)),We(12).map(p=>{const i=o.format(C,"monthShort"),g=o.format(C,"month"),_=!!(!S(p)||e.min&&o.isAfter(o.startOfMonth(o.date(e.min)),C)||e.max&&o.isAfter(C,o.startOfMonth(o.date(e.max))));return C=o.getNextMonth(C),{isDisabled:_,text:i,label:g,value:p}})});Dt(()=>{h.value=h.value??o.getMonth(o.date())});function S(C){return Array.isArray(e.allowedMonths)&&e.allowedMonths.length?e.allowedMonths.includes(C):typeof e.allowedMonths=="function"?e.allowedMonths(C):!0}return Se(()=>d("div",{class:"v-date-picker-months",style:{height:it(e.height)}},[d("div",{class:"v-date-picker-months__content"},[V.value.map((C,p)=>{var _;const i={active:h.value===p,ariaLabel:C.label,color:h.value===p?e.color:void 0,disabled:C.isDisabled,rounded:!0,text:C.text,variant:h.value===C.value?"flat":"text",onClick:()=>g(p)};function g($){if(h.value===$){b("update:modelValue",h.value);return}h.value=$}return((_=y.month)==null?void 0:_.call(y,{month:C,i:p,props:i}))??t(K,ue({key:"month"},i),null)})])])),{}}}),Ut=fe({color:String,height:[String,Number],min:null,max:null,modelValue:Number,allowedYears:[Array,Function]},"VDatePickerYears"),wt=be()({name:"VDatePickerYears",props:Ut(),directives:{vIntersect:ht},emits:{"update:modelValue":e=>!0},setup(e,u){let{emit:b,slots:y}=u;const o=He(),h=ve(e,"modelValue"),V=Y(()=>{const i=o.getYear(o.date());let g=i-100,_=i+52;e.min&&(g=o.getYear(o.date(e.min))),e.max&&(_=o.getYear(o.date(e.max)));let $=o.startOfYear(o.date());return $=o.setYear($,g),We(_-g+1,g).map(O=>{const r=o.format($,"year");return $=o.setYear($,o.getYear($)+1),{text:r,value:O,isDisabled:!p(O)}})});Dt(()=>{h.value=h.value??o.getYear(o.date())});const S=il();function C(){var i,g;(i=S.el)==null||i.focus(),(g=S.el)==null||g.scrollIntoView({block:"center"})}function p(i){return Array.isArray(e.allowedYears)&&e.allowedYears.length?e.allowedYears.includes(i):typeof e.allowedYears=="function"?e.allowedYears(i):!0}return Se(()=>xt(d("div",{class:"v-date-picker-years",style:{height:it(e.height)}},[d("div",{class:"v-date-picker-years__content"},[V.value.map((i,g)=>{var $;const _={ref:h.value===i.value?S:void 0,active:h.value===i.value,color:h.value===i.value?e.color:void 0,rounded:!0,text:i.text,disabled:i.isDisabled,variant:h.value===i.value?"flat":"text",onClick:()=>{if(h.value===i.value){b("update:modelValue",h.value);return}h.value=i.value}};return(($=y.year)==null?void 0:$.call(y,{year:i,i:g,props:_}))??t(K,ue({key:"month"},_),null)})])]),[[ht,{handler:C},null,{once:!0}]])),{}}}),Il=ul("v-picker-title"),ct=fe({bgColor:String,divided:Boolean,landscape:Boolean,title:String,hideHeader:Boolean,hideTitle:Boolean,...Dl()},"VPicker"),et=be()({name:"VPicker",props:ct(),setup(e,u){let{slots:b}=u;const{backgroundColorClasses:y,backgroundColorStyles:o}=ut(()=>e.color);return Se(()=>{const h=Be.filterProps(e),V=!e.hideTitle&&!!(e.title||b.title);return t(Be,ue(h,{color:e.bgColor,class:["v-picker",{"v-picker--divided":e.divided,"v-picker--landscape":e.landscape,"v-picker--with-actions":!!b.actions},e.class],style:e.style}),{default:()=>{var S;return[!e.hideHeader&&d("div",{key:"header",class:te([y.value]),style:Qe([o.value])},[V&&t(Il,{key:"picker-title"},{default:()=>{var C;return[((C=b.title)==null?void 0:C.call(b))??e.title]}}),b.header&&d("div",{class:"v-picker__header"},[b.header()])]),d("div",{class:"v-picker__body"},[(S=b.default)==null?void 0:S.call(b)]),b.actions&&t(st,{defaults:{VBtn:{slim:!0,variant:"text"}}},{default:()=>[d("div",{class:"v-picker__actions"},[b.actions()])]})]}})}),{}}}),Hl=fe({header:{type:String,default:"$vuetify.datePicker.header"},headerColor:String,...It(),...Yt({weeksInMonth:"static"}),...Pe(Lt(),["modelValue"]),...Pe(Ut(),["modelValue"]),...ct({title:"$vuetify.datePicker.title"}),modelValue:null},"VDatePicker"),Ft=be()({name:"VDatePicker",props:Hl(),emits:{"update:modelValue":e=>!0,"update:month":e=>!0,"update:year":e=>!0,"update:viewMode":e=>!0},setup(e,u){let{emit:b,slots:y}=u;const o=He(),{t:h}=ze(),{rtlClasses:V}=sl(),S=ve(e,"modelValue",void 0,l=>Je(l).map(c=>o.date(c)),l=>e.multiple?l:l[0]),C=ve(e,"viewMode"),{minDate:p,maxDate:i,clampDate:g}=Ht(e),_=Y(()=>{var N;const l=o.date(),c=(N=S.value)!=null&&N[0]?o.date(S.value[0]):g(l);return c&&o.isValid(c)?c:l}),$=nt(()=>e.headerColor??e.color),O=ve(e,"month"),r=Y({get:()=>Number(O.value??o.getMonth(o.startOfMonth(_.value))),set:l=>O.value=l}),D=ve(e,"year"),f=Y({get:()=>Number(D.value??o.getYear(o.startOfYear(o.setMonth(_.value,r.value)))),set:l=>D.value=l}),x=Xe(!1),G=Y(()=>e.multiple&&S.value.length>1?h("$vuetify.datePicker.itemsSelected",S.value.length):S.value[0]&&o.isValid(S.value[0])?o.format(o.date(S.value[0]),"normalDateWithWeekday"):h(e.header)),A=Y(()=>{let l=o.date();return l=o.setDate(l,1),l=o.setMonth(l,r.value),l=o.setYear(l,f.value),o.format(l,"monthAndYear")}),M=nt(()=>`date-picker-header${x.value?"-reverse":""}-transition`),L=Y(()=>{if(e.disabled)return!0;const l=[];if(C.value!=="month")l.push("prev","next");else{let c=o.date();if(c=o.startOfMonth(c),c=o.setMonth(c,r.value),c=o.setYear(c,f.value),p.value){const N=o.addDays(o.startOfMonth(c),-1);o.isAfter(p.value,N)&&l.push("prev")}if(i.value){const N=o.addDays(o.endOfMonth(c),1);o.isAfter(N,i.value)&&l.push("next")}}return l}),le=Y(()=>e.allowedYears||oe),Z=Y(()=>e.allowedMonths||I);function X(l,c){const N=e.allowedDates;if(typeof N!="function")return!0;const W=1+dl(o,l,c);for(let P=0;P<W;P++)if(N(o.addDays(l,P)))return!0;return!1}function oe(l){if(typeof e.allowedDates=="function"){const c=o.parseISO(`${l}-01-01`);return X(c,o.endOfYear(c))}if(Array.isArray(e.allowedDates)&&e.allowedDates.length){for(const c of e.allowedDates)if(o.getYear(o.date(c))===l)return!0;return!1}return!0}function I(l){if(typeof e.allowedDates=="function"){const c=String(l+1).padStart(2,"0"),N=o.parseISO(`${f.value}-${c}-01`);return X(N,o.endOfMonth(N))}if(Array.isArray(e.allowedDates)&&e.allowedDates.length){for(const c of e.allowedDates)if(o.getYear(o.date(c))===f.value&&o.getMonth(o.date(c))===l)return!0;return!1}return!0}function w(){r.value<11?r.value++:(f.value++,r.value=0,v()),s()}function H(){r.value>0?r.value--:(f.value--,r.value=11,v()),s()}function z(){C.value="month"}function E(){C.value=C.value==="months"?"month":"months"}function q(){C.value=C.value==="year"?"month":"year"}function s(){C.value==="months"&&E()}function v(){C.value==="year"&&q()}return de(S,(l,c)=>{const N=Je(c),W=Je(l);if(!W.length)return;const P=o.date(N[N.length-1]),U=o.date(W[W.length-1]),ie=o.getMonth(U),F=o.getYear(U);ie!==r.value&&(r.value=ie,s()),F!==f.value&&(f.value=F,v()),x.value=o.isBefore(P,U)}),Se(()=>{const l=et.filterProps(e),c=yt.filterProps(e),N=kt.filterProps(e),W=bt.filterProps(e),P=Pe(St.filterProps(e),["modelValue"]),U=Pe(wt.filterProps(e),["modelValue"]),ie={color:$.value,header:G.value,transition:M.value};return t(et,ue(l,{color:$.value,class:["v-date-picker",`v-date-picker--${C.value}`,{"v-date-picker--show-week":e.showWeek},V.value,e.class],style:e.style}),{title:()=>{var F;return((F=y.title)==null?void 0:F.call(y))??d("div",{class:"v-date-picker__title"},[h(e.title)])},header:()=>y.header?t(st,{defaults:{VDatePickerHeader:{...ie}}},{default:()=>{var F;return[(F=y.header)==null?void 0:F.call(y,ie)]}}):t(kt,ue({key:"header"},N,ie,{onClick:C.value!=="month"?z:void 0}),{prepend:y.prepend,append:y.append}),default:()=>d(ke,null,[t(yt,ue(c,{disabled:L.value,text:A.value,"onClick:next":w,"onClick:prev":H,"onClick:month":E,"onClick:year":q}),null),t(cl,{hideOnLeave:!0},{default:()=>[C.value==="months"?t(St,ue({key:"date-picker-months"},P,{modelValue:r.value,"onUpdate:modelValue":[F=>r.value=F,s],min:p.value,max:i.value,year:f.value,allowedMonths:Z.value}),{month:y.month}):C.value==="year"?t(wt,ue({key:"date-picker-years"},U,{modelValue:f.value,"onUpdate:modelValue":[F=>f.value=F,v],min:p.value,max:i.value,allowedYears:le.value}),{year:y.year}):t(bt,ue({key:"date-picker-month"},W,{modelValue:S.value,"onUpdate:modelValue":F=>S.value=F,month:r.value,"onUpdate:month":[F=>r.value=F,s],year:f.value,"onUpdate:year":[F=>f.value=F,v],min:p.value,max:i.value}),{day:y.day})]})]),actions:y.actions})}),{}}});function Ne(e){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2;return String(e).padStart(u,"0")}const Yl=fe({allowedValues:Function,ampm:Boolean,color:String,disabled:Boolean,displayedValue:null,double:Boolean,format:{type:Function,default:e=>e},max:{type:Number,required:!0},min:{type:Number,required:!0},scrollable:Boolean,readonly:Boolean,rotate:{type:Number,default:0},step:{type:Number,default:1},modelValue:{type:Number}},"VTimePickerClock"),Ct=be()({name:"VTimePickerClock",props:Yl(),emits:{change:e=>!0,input:e=>!0},setup(e,u){let{emit:b}=u;const y=R(null),o=R(null),h=R(void 0),V=R(!1),S=R(null),C=R(null),p=vl(l=>b("change",l),750),{textColorClasses:i,textColorStyles:g}=ml(()=>e.color),{backgroundColorClasses:_,backgroundColorStyles:$}=ut(()=>e.color),O=Y(()=>e.max-e.min+1),r=Y(()=>e.double?O.value/2:O.value),D=Y(()=>360/r.value),f=Y(()=>D.value*Math.PI/180),x=Y(()=>e.modelValue==null?e.min:e.modelValue),G=Y(()=>.62),A=Y(()=>{const l=[];for(let c=e.min;c<=e.max;c=c+e.step)l.push(c);return l});de(()=>e.modelValue,l=>{h.value=l});function M(l){h.value!==l&&(h.value=l),b("input",l)}function L(l){return!e.allowedValues||e.allowedValues(l)}function le(l){if(!e.scrollable||e.disabled)return;l.preventDefault();const c=Math.sign(-l.deltaY||1);let N=x.value;do N=N+c,N=(N-e.min+O.value)%O.value+e.min;while(!L(N)&&N!==x.value);N!==e.displayedValue&&M(N),p(N)}function Z(l){return e.double&&l-e.min>=r.value}function X(l){return Z(l)?G.value:1}function oe(l){const c=e.rotate*Math.PI/180;return{x:Math.sin((l-e.min)*f.value+c)*X(l),y:-Math.cos((l-e.min)*f.value+c)*X(l)}}function I(l,c){const N=(Math.round(l/D.value)+(c?r.value:0))%O.value+e.min;return l<360-D.value/2?N:c?e.max-r.value+1:e.min}function w(l){const{x:c,y:N}=oe(l);return{left:`${Math.round(50+c*50)}%`,top:`${Math.round(50+N*50)}%`}}function H(l,c){const N=c.x-l.x,W=c.y-l.y;return Math.sqrt(N*N+W*W)}function z(l,c){const N=2*Math.atan2(c.y-l.y-H(l,c),c.x-l.x);return Math.abs(N*180/Math.PI)}function E(l){S.value===null&&(S.value=l),C.value=l,M(l)}function q(l){var Ae,Ye;if(l.preventDefault(),!V.value&&l.type!=="click"||!y.value)return;const{width:c,top:N,left:W}=(Ae=y.value)==null?void 0:Ae.getBoundingClientRect(),{width:P}=((Ye=o.value)==null?void 0:Ye.getBoundingClientRect())??{width:0},{clientX:U,clientY:ie}="touches"in l?l.touches[0]:l,F={x:c/2,y:-c/2},Me={x:U-W,y:N-ie},he=Math.round(z(F,Me)-e.rotate+360)%360,we=e.double&&H(F,Me)<(P+P*G.value)/4,Ce=Math.ceil(15/D.value);let Ve;for(let Ee=0;Ee<Ce;Ee++)if(Ve=I(he+Ee*D.value,we),L(Ve)||(Ve=I(he-Ee*D.value,we),L(Ve)))return E(Ve)}function s(l){e.disabled||(l.preventDefault(),window.addEventListener("mousemove",q),window.addEventListener("touchmove",q),window.addEventListener("mouseup",v),window.addEventListener("touchend",v),S.value=null,C.value=null,V.value=!0,q(l))}function v(l){l.stopPropagation(),window.removeEventListener("mousemove",q),window.removeEventListener("touchmove",q),window.removeEventListener("mouseup",v),window.removeEventListener("touchend",v),V.value=!1,C.value!==null&&L(C.value)&&b("change",C.value)}Se(()=>d("div",{class:te([{"v-time-picker-clock":!0,"v-time-picker-clock--indeterminate":e.modelValue==null,"v-time-picker-clock--readonly":e.readonly}]),onMousedown:s,onTouchstart:s,onWheel:le,ref:y},[d("div",{class:"v-time-picker-clock__inner",ref:o},[d("div",{class:te([{"v-time-picker-clock__hand":!0,"v-time-picker-clock__hand--inner":Z(e.modelValue)},i.value]),style:Qe([{transform:`rotate(${e.rotate+D.value*(x.value-e.min)}deg) scaleY(${X(x.value)})`},g.value])},null),A.value.map(l=>{const c=l===x.value;return d("div",{class:te([{"v-time-picker-clock__item":!0,"v-time-picker-clock__item--active":c,"v-time-picker-clock__item--disabled":e.disabled||!L(l)},c&&_.value]),style:Qe([w(l),c&&$.value])},[d("span",null,[e.format(l)])])})])]))}}),Ll=fe({ampm:Boolean,color:String,disabled:Boolean,hour:Number,minute:Number,second:Number,period:String,readonly:Boolean,useSeconds:Boolean,value:Number,viewMode:String},"VTimePickerControls"),pt=be()({name:"VTimePickerControls",props:Ll(),emits:{"update:period":e=>!0,"update:viewMode":e=>!0},setup(e,u){let{emit:b,slots:y}=u;const{t:o}=ze();return Se(()=>{let h=e.hour;return e.ampm&&(h=h?(h-1)%12+1:12),d("div",{class:"v-time-picker-controls"},[d("div",{class:te({"v-time-picker-controls__time":!0,"v-time-picker-controls__time--with-seconds":e.useSeconds})},[t(K,{active:e.viewMode==="hour",color:e.viewMode==="hour"?e.color:void 0,disabled:e.disabled,variant:"tonal",class:te({"v-time-picker-controls__time__btn":!0,"v-time-picker-controls__time--with-ampm__btn":e.ampm,"v-time-picker-controls__time--with-seconds__btn":e.useSeconds}),text:e.hour==null?"--":Ne(`${h}`),onClick:()=>b("update:viewMode","hour")},null),d("span",{class:te(["v-time-picker-controls__time__separator",{"v-time-picker-controls--with-seconds__time__separator":e.useSeconds}])},[ne(":")]),t(K,{active:e.viewMode==="minute",color:e.viewMode==="minute"?e.color:void 0,class:te({"v-time-picker-controls__time__btn":!0,"v-time-picker-controls__time__btn__active":e.viewMode==="minute","v-time-picker-controls__time--with-ampm__btn":e.ampm,"v-time-picker-controls__time--with-seconds__btn":e.useSeconds}),disabled:e.disabled,variant:"tonal",text:e.minute==null?"--":Ne(e.minute),onClick:()=>b("update:viewMode","minute")},null),e.useSeconds&&d("span",{class:te(["v-time-picker-controls__time__separator",{"v-time-picker-controls--with-seconds__time__separator":e.useSeconds}]),key:"secondsDivider"},[ne(":")]),e.useSeconds&&t(K,{key:"secondsVal",active:e.viewMode==="second",color:e.viewMode==="second"?e.color:void 0,variant:"tonal",onClick:()=>b("update:viewMode","second"),class:te({"v-time-picker-controls__time__btn":!0,"v-time-picker-controls__time__btn__active":e.viewMode==="second","v-time-picker-controls__time--with-seconds__btn":e.useSeconds}),disabled:e.disabled,text:e.second==null?"--":Ne(e.second)},null),e.ampm&&d("div",{class:"v-time-picker-controls__ampm"},[t(K,{active:e.period==="am",color:e.period==="am"?e.color:void 0,class:te({"v-time-picker-controls__ampm__am":!0,"v-time-picker-controls__ampm__btn":!0,"v-time-picker-controls__ampm__btn__active":e.period==="am"}),disabled:e.disabled,text:o("$vuetify.timePicker.am"),variant:e.disabled&&e.period==="am"?"elevated":"tonal",onClick:()=>e.period!=="am"?b("update:period","am"):null},null),t(K,{active:e.period==="pm",color:e.period==="pm"?e.color:void 0,class:te({"v-time-picker-controls__ampm__pm":!0,"v-time-picker-controls__ampm__btn":!0,"v-time-picker-controls__ampm__btn__active":e.period==="pm"}),disabled:e.disabled,text:o("$vuetify.timePicker.pm"),variant:e.disabled&&e.period==="pm"?"elevated":"tonal",onClick:()=>e.period!=="pm"?b("update:period","pm"):null},null)])])])}),{}}}),Ul=We(24),Bt=We(12),Fl=Bt.map(e=>e+12);We(60);const Bl=fe({allowedHours:[Function,Array],allowedMinutes:[Function,Array],allowedSeconds:[Function,Array],disabled:Boolean,format:{type:String,default:"ampm"},max:String,min:String,viewMode:{type:String,default:"hour"},period:{type:String,default:"am",validator:e=>["am","pm"].includes(e)},modelValue:null,readonly:Boolean,scrollable:Boolean,useSeconds:Boolean,...Pe(ct({title:"$vuetify.timePicker.title"}),["landscape"])},"VTimePicker"),zt=be()({name:"VTimePicker",props:Bl(),emits:{"update:hour":e=>!0,"update:minute":e=>!0,"update:period":e=>!0,"update:second":e=>!0,"update:modelValue":e=>!0,"update:viewMode":e=>!0},setup(e,u){let{emit:b,slots:y}=u;const{t:o}=ze(),h=R(null),V=R(null),S=R(null),C=R(null),p=R(null),i=R(null),g=ve(e,"period","am"),_=ve(e,"viewMode","hour"),$=R(null),O=R(null),r=Y(()=>{let w;if(e.allowedHours instanceof Array?w=E=>e.allowedHours.includes(E):w=e.allowedHours,!e.min&&!e.max)return w;const H=e.min?Number(e.min.split(":")[0]):0,z=e.max?Number(e.max.split(":")[0]):23;return E=>E>=Number(H)&&E<=Number(z)&&(!w||w(E))}),D=Y(()=>{let w;const H=!r.value||h.value===null||r.value(h.value);if(e.allowedMinutes instanceof Array?w=c=>e.allowedMinutes.includes(c):w=e.allowedMinutes,!e.min&&!e.max)return H?w:()=>!1;const[z,E]=e.min?e.min.split(":").map(Number):[0,0],[q,s]=e.max?e.max.split(":").map(Number):[23,59],v=z*60+Number(E),l=q*60+Number(s);return c=>{const N=60*h.value+c;return N>=v&&N<=l&&H&&(!w||w(c))}}),f=Y(()=>{let w;const z=(!r.value||h.value===null||r.value(h.value))&&(!D.value||V.value===null||D.value(V.value));if(e.allowedSeconds instanceof Array?w=P=>e.allowedSeconds.includes(P):w=e.allowedSeconds,!e.min&&!e.max)return z?w:()=>!1;const[E,q,s]=e.min?e.min.split(":").map(Number):[0,0,0],[v,l,c]=e.max?e.max.split(":").map(Number):[23,59,59],N=E*3600+q*60+Number(s||0),W=v*3600+l*60+Number(c||0);return P=>{const U=3600*h.value+60*V.value+P;return U>=N&&U<=W&&z&&(!w||w(P))}}),x=Y(()=>e.format==="ampm");de(()=>e.period,w=>X(w)),de(()=>e.modelValue,w=>le(w)),dt(()=>{le(e.modelValue)});function G(){return h.value!=null&&V.value!=null&&(!e.useSeconds||S.value!=null)?`${Ne(h.value)}:${Ne(V.value)}`+(e.useSeconds?`:${Ne(S.value)}`:""):null}function A(){const w=G();w!==null&&b("update:modelValue",w)}function M(w){return w?(w-1)%12+1:12}function L(w,H){return w%12+(H==="pm"?12:0)}function le(w){if(w==null||w==="")h.value=null,V.value=null,S.value=null;else if(w instanceof Date)h.value=w.getHours(),V.value=w.getMinutes(),S.value=w.getSeconds();else{const[H,,z,,E,q]=w.trim().toLowerCase().match(/^(\d+):(\d+)(:(\d+))?([ap]m)?$/)||new Array(6);h.value=q?L(parseInt(H,10),q):parseInt(H,10),V.value=parseInt(z,10),S.value=parseInt(E||0,10)}g.value=h.value==null||h.value<12?"am":"pm"}function Z(w,H){const z=r.value;if(!z)return H;const E=x.value?H<12?Bt:Fl:Ul;return((E.find(s=>z((s+H)%E.length+E[0]))||0)+H)%E.length+E[0]}function X(w){if(g.value=w,h.value!=null){const H=h.value+(g.value==="am"?-12:12);h.value=Z("hour",H)}return b("update:period",w),A(),!0}function oe(w){_.value==="hour"?h.value=x.value?L(w,g.value):w:_.value==="minute"?V.value=w:S.value=w}function I(w){switch(_.value||"hour"){case"hour":b("update:hour",w);break;case"minute":b("update:minute",w);break;case"second":b("update:second",w);break}const H=h.value!==null&&V.value!==null&&(e.useSeconds?S.value!==null:!0);_.value==="hour"?_.value="minute":e.useSeconds&&_.value==="minute"&&(_.value="second"),!(h.value===C.value&&V.value===p.value&&(!e.useSeconds||S.value===i.value)||G()===null)&&(C.value=h.value,p.value=V.value,e.useSeconds&&(i.value=S.value),H&&A())}Se(()=>{const w=et.filterProps(e),H=pt.filterProps(e),z=Ct.filterProps(Pe(e,["format","modelValue","min","max"]));return t(et,ue(w,{color:void 0,class:["v-time-picker",e.class],style:e.style}),{title:()=>{var E;return((E=y.title)==null?void 0:E.call(y))??d("div",{class:"v-time-picker__title"},[o(e.title)])},header:()=>t(pt,ue(H,{ampm:x.value,hour:h.value,minute:V.value,period:g.value,second:S.value,viewMode:_.value,"onUpdate:period":E=>X(E),"onUpdate:viewMode":E=>_.value=E,ref:$}),null),default:()=>t(Ct,ue(z,{allowedValues:_.value==="hour"?r.value:_.value==="minute"?D.value:f.value,double:_.value==="hour"&&!x.value,format:_.value==="hour"?x.value?M:E=>E:E=>Ne(E,2),max:_.value==="hour"?x.value&&g.value==="am"?11:23:59,min:_.value==="hour"&&x.value&&g.value==="pm"?12:0,size:20,step:_.value==="hour"?1:5,modelValue:_.value==="hour"?h.value:_.value==="minute"?V.value:S.value,onChange:I,onInput:oe,ref:O}),null),actions:y.actions})})}}),zl={class:"title-icon"},Wl={class:"last-call-pill"},jl={class:"pill-content"},Gl={class:"pill-value"},ql=Mt({__name:"SaslFormModal",props:{modelValue:{type:Boolean},record:{}},emits:["update:modelValue","submitted"],setup(e,{emit:u}){const b=e,y=u,o=Nt(),h=Ot(),{loading:V,submitting:S,formRef:C,form:p,callStatusOptions:i,rules:g,selectedRecord:_}=h,{handleSubmit:$,fillFormFromRecord:O}=Rt(h,o),r=Y({get:()=>b.modelValue,set:s=>y("update:modelValue",s)}),D=R(!1),f=R(""),x=R(""),G=Y(()=>{const s=new Date;return`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}-${String(s.getDate()).padStart(2,"0")}`}),A=s=>{if(!s)return"";if(typeof s=="string"){if(/^\d{4}-\d{2}-\d{2}$/.test(s))return s;const v=new Date(s);return isNaN(v.getTime())?"":`${v.getFullYear()}-${String(v.getMonth()+1).padStart(2,"0")}-${String(v.getDate()).padStart(2,"0")}`}return s instanceof Date?isNaN(s.getTime())?"":`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}-${String(s.getDate()).padStart(2,"0")}`:""},M=(s,v)=>{const l=A(s);return!l||!v?"":`${l} ${v}`},L=s=>{if(!s)return{date:"",time:""};const[v,l]=s.split(" ");return{date:v||"",time:l||""}},le=()=>{const s=new Date;return`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}-${String(s.getDate()).padStart(2,"0")}`},Z=()=>{const s=new Date;return s.setHours(s.getHours()+2),`${String(s.getHours()).padStart(2,"0")}:${String(s.getMinutes()).padStart(2,"0")}`},X=()=>{const{date:s,time:v}=L(p.nextCallTime);f.value=s,x.value=v},oe=s=>{s?p.nextCallTime?X():(f.value=le(),x.value=Z(),console.log("[handleMenuOpen] 设置默认值 - 日期:",f.value,"时间:",x.value)):p.nextCallTime?X():(f.value="",x.value="")};de(()=>p.nextCallTime,()=>{D.value||X()},{immediate:!0}),de(()=>f.value,s=>{if(s instanceof Date){const l=A(s);if(l){f.value=l;return}}else if(typeof s=="string"&&s&&!/^\d{4}-\d{2}-\d{2}$/.test(s)){const l=A(s);if(l&&l!==s){f.value=l;return}}const v=A(f.value);if(v&&x.value){const l=G.value;if(v===l){const[c,N]=x.value.split(":").map(Number),W=new Date,P=new Date;if(P.setHours(c,N,0,0),P<=W){const U=new Date(W);U.setMinutes(U.getMinutes()+1),x.value=`${String(U.getHours()).padStart(2,"0")}:${String(U.getMinutes()).padStart(2,"0")}`}}}});const I=s=>{if(s){const v=A(s);v&&(f.value=v)}if(f.value&&x.value){const v=G.value;if(A(f.value)===v){const[c,N]=x.value.split(":").map(Number),W=new Date,P=new Date;if(P.setHours(c,N,0,0),P<=W){const U=new Date(W);U.setMinutes(U.getMinutes()+1),x.value=`${String(U.getHours()).padStart(2,"0")}:${String(U.getMinutes()).padStart(2,"0")}`}}}},w=()=>{if(f.value&&x.value){const s=G.value;if(A(f.value)===s){const[l,c]=x.value.split(":").map(Number),N=new Date,W=new Date;if(W.setHours(l,c,0,0),W<=N){const P=new Date(N);P.setMinutes(P.getMinutes()+1),x.value=`${String(P.getHours()).padStart(2,"0")}:${String(P.getMinutes()).padStart(2,"0")}`}}}},H=()=>{f.value="",x.value="",p.nextCallTime="",D.value=!1},z=()=>{if(console.log("[handleConfirmNextCallTime] 开始执行"),console.log("[handleConfirmNextCallTime] nextCallDate.value (原始):",f.value),console.log("[handleConfirmNextCallTime] nextCallDate.value (规范化):",A(f.value)),console.log("[handleConfirmNextCallTime] nextCallTime.value:",x.value),console.log("[handleConfirmNextCallTime] 条件判断结果:",!!(f.value&&x.value)),f.value&&x.value){const s=A(f.value);s&&(f.value=s);const v=M(f.value,x.value);console.log("[handleConfirmNextCallTime] 格式化后的时间:",v),p.nextCallTime=v,console.log("[handleConfirmNextCallTime] 设置后的 form.nextCallTime:",p.nextCallTime)}else console.log("[handleConfirmNextCallTime] 条件不满足，清空 form.nextCallTime"),p.nextCallTime="";D.value=!1,console.log("[handleConfirmNextCallTime] 执行完成，菜单已关闭")},E=()=>{r.value=!1},q=async()=>{await $(),y("submitted"),E()};return de(()=>b.record,s=>{s&&r.value&&(_.value=s,O(s),X())},{immediate:!0}),de(r,s=>{s&&b.record?(_.value=b.record,O(b.record),X()):s||(_.value=null)}),dt(()=>{X()}),(s,v)=>(j(),De(xl,{modelValue:r.value,"onUpdate:modelValue":v[11]||(v[11]=l=>r.value=l),"max-width":"900px",persistent:"",scrollable:"",class:"sasl-form-modal"},{default:m(()=>[t(Ue,{class:"modal-card",loading:T(V),elevation:"0"},{default:m(()=>[t(rt,{class:"section-title d-flex align-center"},{default:m(()=>[d("div",zl,[t(me,{color:"primary"},{default:m(()=>[...v[12]||(v[12]=[ne("mdi-form-select",-1)])]),_:1})]),v[13]||(v[13]=d("div",null,[d("div",{class:"title-label"},"SASL"),d("div",{class:"title-sub"},"客戶資訊登記")],-1)),t(Ie),t(K,{icon:"mdi-close",variant:"text",size:"small",onClick:E})]),_:1}),t(ot),t(Fe,{class:"modal-content"},{default:m(()=>[t(Pt,{ref_key:"formRef",ref:C},{default:m(()=>[t(xe,{dense:""},{default:m(()=>[t(B,{cols:"12",md:"6"},{default:m(()=>[t(se,{modelValue:T(p).mrtNumber,"onUpdate:modelValue":v[0]||(v[0]=l=>T(p).mrtNumber=l),label:"MRT",placeholder:"例如：92479132","prepend-inner-icon":"mdi-cellphone",readonly:""},null,8,["modelValue"])]),_:1}),t(B,{cols:"12",md:"6"},{default:m(()=>[t(se,{modelValue:T(p).category,"onUpdate:modelValue":v[1]||(v[1]=l=>T(p).category=l),label:"類別",placeholder:"例如：638(出機 5G+數據王)","prepend-inner-icon":"mdi-tag",readonly:""},null,8,["modelValue"])]),_:1}),t(B,{cols:"12",md:"6"},{default:m(()=>[t(se,{modelValue:T(p).lastTurnNetworkMonth,"onUpdate:modelValue":v[2]||(v[2]=l=>T(p).lastTurnNetworkMonth=l),label:"最後轉網月份",placeholder:"例如：202011","prepend-inner-icon":"mdi-calendar-month",readonly:""},null,8,["modelValue"])]),_:1}),t(B,{cols:"12",md:"6"},{default:m(()=>[t(se,{modelValue:T(p).oldContract,"onUpdate:modelValue":v[3]||(v[3]=l=>T(p).oldContract=l),label:"舊合約",placeholder:"例如：2024.01","prepend-inner-icon":"mdi-calendar",readonly:""},null,8,["modelValue"])]),_:1}),t(B,{cols:"12",md:"6"},{default:m(()=>[t(se,{modelValue:T(p).sales,"onUpdate:modelValue":v[4]||(v[4]=l=>T(p).sales=l),label:"銷售員",placeholder:"例如：Jackson Hung","prepend-inner-icon":"mdi-account-tie",readonly:""},null,8,["modelValue"])]),_:1}),t(B,{cols:"12",md:"6"},{default:m(()=>[t(Ke,{modelValue:T(p).callStatus,"onUpdate:modelValue":v[5]||(v[5]=l=>T(p).callStatus=l),items:T(i),label:"致電狀態",placeholder:"請選擇",rules:[T(g).required],"prepend-inner-icon":"mdi-phone"},null,8,["modelValue","items","rules"])]),_:1}),t(B,{cols:"12",md:"6"},{default:m(()=>[t(At,{modelValue:D.value,"onUpdate:modelValue":[v[9]||(v[9]=l=>D.value=l),oe],"close-on-content-click":!1},{activator:m(({props:l})=>[t(se,ue(l,{modelValue:T(p).nextCallTime,"onUpdate:modelValue":v[6]||(v[6]=c=>T(p).nextCallTime=c),label:"下次致電時間",placeholder:"請選擇日期和時間（可選）","prepend-inner-icon":"mdi-clock-time-four-outline",rules:[T(g).nextCallTime],readonly:"",clearable:""}),null,16,["modelValue","rules"])]),default:m(()=>[t(Ue,{"min-width":"300"},{default:m(()=>[t(Fe,{class:"pa-0"},{default:m(()=>[t(xe,{"no-gutters":""},{default:m(()=>[t(B,{cols:"12",md:"6"},{default:m(()=>[t(Ft,{modelValue:f.value,"onUpdate:modelValue":[v[7]||(v[7]=l=>f.value=l),I],min:G.value},null,8,["modelValue","min"])]),_:1}),t(B,{cols:"12",md:"6"},{default:m(()=>[t(zt,{modelValue:x.value,"onUpdate:modelValue":[v[8]||(v[8]=l=>x.value=l),w],format:"24hr"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(Ze,null,{default:m(()=>[t(K,{variant:"text",color:"error",onClick:H},{default:m(()=>[...v[14]||(v[14]=[ne(" 清除 ",-1)])]),_:1}),t(Ie),t(K,{variant:"text",color:"primary",onClick:z},{default:m(()=>[...v[15]||(v[15]=[ne(" 完成 ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(B,{cols:"12"},{default:m(()=>[t(Et,{modelValue:T(p).remark,"onUpdate:modelValue":v[10]||(v[10]=l=>T(p).remark=l),label:"備註",rows:"4","auto-grow":"","prepend-inner-icon":"mdi-note-text-outline"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},512)]),_:1}),t(ot),t(Ze,{class:"px-6 py-4 last-call-action"},{default:m(()=>[d("div",Wl,[t(me,{icon:"mdi-clock-time-four-outline",size:"20"}),d("div",jl,[v[16]||(v[16]=d("div",{class:"pill-label"},"上次致電時間",-1)),d("div",Gl,re(T(p).lastCallTime||"—"),1)])]),t(Ie),t(K,{variant:"text",color:"grey",onClick:E},{default:m(()=>[...v[17]||(v[17]=[ne(" 取消 ",-1)])]),_:1}),t(K,{class:"apple-primary-btn",color:"primary",loading:T(S),disabled:T(V),onClick:q},{default:m(()=>[...v[18]||(v[18]=[ne(" 提交 ",-1)])]),_:1},8,["loading","disabled"])]),_:1})]),_:1},8,["loading"])]),_:1},8,["modelValue"]))}}),Jl=$t(ql,[["__scopeId","data-v-5c757776"]]),Xl={class:"sasl-form apple-surface"},Kl={class:"stat-icon"},Ql={class:"stat-content"},Zl={class:"stat-label"},ea={class:"stat-value"},ta={class:"announcement-banner-content"},la={class:"announcement-preview-content"},aa={class:"announcement-banner-list"},na={class:"announcement-banner-text"},oa={class:"title-icon"},ra={class:"search-panel-title"},ia={class:"last-call-pill"},ua={class:"pill-content"},sa={class:"pill-value"},da={class:"title-icon soft"},ca={class:"plan-section-surface"},ma={class:"plan-section-header section-title d-flex align-center"},va={class:"title-icon soft"},fa={class:"plan-tab-title"},ha={class:"plan-tab-subtitle"},ga={class:"panel-title"},ya={class:"panel-title-text"},ka={class:"panel-title-label"},ba={class:"panel-title-sub"},Sa={class:"plan-matrix-wrapper"},wa={class:"plan-matrix"},Ca={key:0,class:"plan-footnote"},_t="sasl_search_state",pa=Mt({__name:"SaslForm",setup(e){const u=kl(),b=Nt(),y=Ot(),{loading:o,submitting:h,searchingMrt:V,formRef:S,mrtSearch:C,searchCallStatus:p,searchDataSource:i,searchResults:g,selectedRecord:_,telecomTags:$,selectedTag:O,form:r,callStatusOptions:D,dataSourceOptions:f,loadDocumentTitles:x,heroStats:G,loadHeroStats:A,rules:M,isFormFilled:L,previewItems:le,planComparisonSections:Z,loadPlanSections:X,activePlanTab:oe}=y,{performSearch:I,handleSubmit:w}=Rt(y,b),H=R([]),z=R(!1),E=R(!1),q=async()=>{if(!z.value){z.value=!0;try{const a=(await Vl()).filter(n=>n.enabled).sort((n,Q)=>(n.sortOrder??0)-(Q.sortOrder??0)).map(n=>n.content);H.value=a}catch(k){console.error("获取公告失败",k)}finally{z.value=!1}}};let s=null;const v=()=>{s!==null&&clearInterval(s),q(),s=window.setInterval(()=>{q()},1e4)},l=()=>{s!==null&&(clearInterval(s),s=null)},c=R(!1),N=R(null),W=()=>{b.show({message:"模态框表单已提交",color:"success"})};let P=null,U=null,ie=null,F=0,Me=0,he=!1,we=null;const Ce={HEARTBEAT_TIMEOUT:6e4,MAX_RECONNECT_ATTEMPTS:10,INITIAL_RECONNECT_DELAY:1e3,MAX_RECONNECT_DELAY:3e4,CONNECTION_CHECK_INTERVAL:1e4},Ve=k=>{const a=Math.min(Ce.INITIAL_RECONNECT_DELAY*Math.pow(2,k),Ce.MAX_RECONNECT_DELAY),n=Math.random()*1e3;return a+n},Ae=()=>{U!==null&&(clearTimeout(U),U=null),ie!==null&&(clearTimeout(ie),ie=null),we!==null&&(clearInterval(we),we=null)},Ye=()=>{Ee(),Me=Date.now(),U=window.setTimeout(()=>{console.warn("SSE心跳超时，连接可能已断开"),P&&P.readyState===EventSource.OPEN&&(console.log("检测到连接异常，准备重连"),$e())},Ce.HEARTBEAT_TIMEOUT)},Ee=()=>{U!==null&&(clearTimeout(U),U=null)},tt=()=>{Me=Date.now(),Ye()},$e=()=>{if(he){console.log("连接已手动关闭，不进行重连");return}if(F>=Ce.MAX_RECONNECT_ATTEMPTS){console.error("已达到最大重连次数，停止重连"),b.show({message:`SSE连接失败，已尝试${Ce.MAX_RECONNECT_ATTEMPTS}次重连`,color:"error"});return}if(P){try{P.close()}catch(a){console.error("关闭SSE连接时出错",a)}P=null}Ae();const k=Ve(F);F++,console.log(`SSE连接断开，将在${Math.round(k/1e3)}秒后尝试第${F}次重连`),ie=window.setTimeout(()=>{ie=null,mt()},k)},Wt=()=>{we!==null&&clearInterval(we),we=window.setInterval(()=>{if(!P||he)return;const k=Date.now(),a=P.readyState;if(a===EventSource.CLOSED){console.log("检测到连接已关闭，准备重连"),$e();return}if(a===EventSource.OPEN&&k-Me>Ce.HEARTBEAT_TIMEOUT){console.warn("心跳超时，连接可能已断开，准备重连"),$e();return}a===EventSource.CONNECTING&&console.log("SSE连接中...")},Ce.CONNECTION_CHECK_INTERVAL)},mt=()=>{if(P){try{P.close()}catch(k){console.error("关闭旧SSE连接时出错",k)}P=null}Ae();try{const k="/api/sasl/form/records/next-call-time-near-now";P=new EventSource(k),P.addEventListener("connected",a=>{console.log("SSE连接已建立:",a.data),F=0,Ye(),Wt()}),P.addEventListener("record",a=>{try{const n=JSON.parse(a.data);console.log("收到符合条件的记录:",n),N.value=n,c.value=!0,tt()}catch(n){console.error("解析SSE记录数据失败",n),b.show({message:"解析记录数据失败",color:"error"})}}),P.addEventListener("heartbeat",a=>{console.log("SSE心跳:",a.data),tt()}),P.addEventListener("error",a=>{console.error("SSE业务错误事件:",a);try{const n=typeof a.data=="string"?JSON.parse(a.data):a.data;if(n!=null&&n.message){if(n.message==="用户未认证"){he=!0,vt(),u.replace("/login");return}b.show({message:n.message,color:"error"})}setTimeout(()=>{(P==null?void 0:P.readyState)===EventSource.CLOSED&&$e()},1e3)}catch(n){console.error("解析SSE错误数据失败",n),b.show({message:"收到错误消息",color:"error"})}}),P.onmessage=a=>{console.log("SSE消息:",a),tt()},P.onerror=a=>{if(console.error("SSE连接错误",a),!P)return;const n=P.readyState;n===EventSource.CLOSED?(console.log("SSE连接已关闭"),he||$e()):n===EventSource.CONNECTING?console.log("SSE连接中，等待重试..."):n===EventSource.OPEN&&console.warn("SSE连接状态为OPEN但触发了error事件，继续监控")}}catch(k){console.error("创建SSE连接失败",k),b.show({message:"创建SSE连接失败",color:"error"}),he||$e()}},vt=()=>{if(he=!0,P){try{P.close()}catch(k){console.error("关闭SSE连接时出错",k)}P=null}Ae(),F=0,Me=0},Le=R(!1),J=R(""),ee=R(""),je=Y(()=>{const k=new Date;return`${k.getFullYear()}-${String(k.getMonth()+1).padStart(2,"0")}-${String(k.getDate()).padStart(2,"0")}`}),pe=k=>{if(!k)return"";if(typeof k=="string"){if(/^\d{4}-\d{2}-\d{2}$/.test(k))return k;const a=new Date(k);return isNaN(a.getTime())?"":`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}-${String(a.getDate()).padStart(2,"0")}`}return k instanceof Date?isNaN(k.getTime())?"":`${k.getFullYear()}-${String(k.getMonth()+1).padStart(2,"0")}-${String(k.getDate()).padStart(2,"0")}`:""},jt=(k,a)=>{const n=pe(k);return!n||!a?"":`${n} ${a}`},Gt=k=>{if(!k)return{date:"",time:""};const[a,n]=k.split(" ");return{date:a||"",time:n||""}},qt=()=>{const k=new Date;return`${k.getFullYear()}-${String(k.getMonth()+1).padStart(2,"0")}-${String(k.getDate()).padStart(2,"0")}`},Jt=()=>{const k=new Date;return k.setHours(k.getHours()+2),`${String(k.getHours()).padStart(2,"0")}:${String(k.getMinutes()).padStart(2,"0")}`},Ge=()=>{const{date:k,time:a}=Gt(r.nextCallTime);J.value=k,ee.value=a},Xt=k=>{k?r.nextCallTime?Ge():(J.value=qt(),ee.value=Jt(),console.log("[handleMenuOpen] 设置默认值 - 日期:",J.value,"时间:",ee.value)):r.nextCallTime?Ge():(J.value="",ee.value="")};de(()=>r.nextCallTime,()=>{Le.value||Ge()},{immediate:!0}),de(()=>J.value,k=>{if(k instanceof Date){const n=pe(k);if(n){J.value=n;return}}else if(typeof k=="string"&&k&&!/^\d{4}-\d{2}-\d{2}$/.test(k)){const n=pe(k);if(n&&n!==k){J.value=n;return}}const a=pe(J.value);if(a&&ee.value){const n=je.value;if(a===n){const[Q,ce]=ee.value.split(":").map(Number),ge=new Date,ye=new Date;if(ye.setHours(Q,ce,0,0),ye<=ge){const _e=new Date(ge);_e.setMinutes(_e.getMinutes()+1),ee.value=`${String(_e.getHours()).padStart(2,"0")}:${String(_e.getMinutes()).padStart(2,"0")}`}}}});const Kt=k=>{if(k){const a=pe(k);a&&(J.value=a)}if(J.value&&ee.value){const a=je.value;if(pe(J.value)===a){const[Q,ce]=ee.value.split(":").map(Number),ge=new Date,ye=new Date;if(ye.setHours(Q,ce,0,0),ye<=ge){const _e=new Date(ge);_e.setMinutes(_e.getMinutes()+1),ee.value=`${String(_e.getHours()).padStart(2,"0")}:${String(_e.getMinutes()).padStart(2,"0")}`}}}},Qt=()=>{if(J.value&&ee.value){const k=je.value;if(pe(J.value)===k){const[n,Q]=ee.value.split(":").map(Number),ce=new Date,ge=new Date;if(ge.setHours(n,Q,0,0),ge<=ce){const ye=new Date(ce);ye.setMinutes(ye.getMinutes()+1),ee.value=`${String(ye.getHours()).padStart(2,"0")}:${String(ye.getMinutes()).padStart(2,"0")}`}}}},Zt=()=>{J.value="",ee.value="",r.nextCallTime="",Le.value=!1},el=()=>{if(console.log("[handleConfirmNextCallTime] 开始执行"),console.log("[handleConfirmNextCallTime] nextCallDate.value (原始):",J.value),console.log("[handleConfirmNextCallTime] nextCallDate.value (规范化):",pe(J.value)),console.log("[handleConfirmNextCallTime] nextCallTime.value:",ee.value),console.log("[handleConfirmNextCallTime] 条件判断结果:",!!(J.value&&ee.value)),J.value&&ee.value){const k=pe(J.value);k&&(J.value=k);const a=jt(J.value,ee.value);console.log("[handleConfirmNextCallTime] 格式化后的时间:",a),r.nextCallTime=a,console.log("[handleConfirmNextCallTime] 设置后的 form.nextCallTime:",r.nextCallTime)}else console.log("[handleConfirmNextCallTime] 条件不满足，清空 form.nextCallTime"),r.nextCallTime="";Le.value=!1,console.log("[handleConfirmNextCallTime] 执行完成，菜单已关闭")};let Oe=null;const tl=()=>{Oe!==null&&clearInterval(Oe),A(),Oe=window.setInterval(()=>{A()},1e4)},ll=()=>{Oe!==null&&(clearInterval(Oe),Oe=null)},lt=()=>{try{const k={searchDataSource:i.value||null,mrtNumber:r.mrtNumber||null};localStorage.setItem(_t,JSON.stringify(k))}catch(k){console.error("保存搜索状态失败",k)}},al=async()=>{try{const k=localStorage.getItem(_t);if(!k)return!1;const a=JSON.parse(k);let n=0;const Q=10;for(;f.value.length===0&&n<Q;)await new Promise(ce=>setTimeout(ce,100)),n++;return a.searchDataSource&&(f.value.includes(a.searchDataSource)?i.value=a.searchDataSource:console.warn("保存的数据源不在当前选项中:",a.searchDataSource)),a.mrtNumber&&i.value?(C.value=a.mrtNumber,await new Promise(ce=>setTimeout(ce,100)),i.value&&I(),!0):!1}catch(k){return console.error("恢复搜索状态失败",k),!1}},ft=()=>{lt()};return de([()=>i.value,()=>r.mrtNumber],()=>{i.value&&r.mrtNumber&&lt()},{deep:!0}),dt(async()=>{await x(),X(),tl(),v(),Ge(),he=!1,mt(),await al(),window.addEventListener("beforeunload",ft)}),Tt(()=>{ll(),l(),vt(),window.removeEventListener("beforeunload",ft),lt()}),(k,a)=>(j(),ae("div",Xl,[t(Be,{class:"hero-card",color:"transparent",elevation:"0"},{default:m(()=>[t(xe,{align:"center"},{default:m(()=>[t(B,{cols:"12",md:"6",class:"hero-copy"},{default:m(()=>[a[20]||(a[20]=d("div",{class:"hero-emblem"},"CSL",-1)),a[21]||(a[21]=d("div",null,[d("div",{class:"hero-eyebrow"},"SASL Campaign Console"),d("div",{class:"hero-title"},"移動通訊精準營銷中心"),d("div",{class:"hero-meta"},"即時掌握客戶旅程，快速同步呼叫進度與資訊")],-1)),t(fl,{modelValue:T(O),"onUpdate:modelValue":a[0]||(a[0]=n=>Re(O)?O.value=n:null),class:"hero-tags",column:"",filter:"",mandatory:""},{default:m(()=>[(j(!0),ae(ke,null,Te(T($),n=>(j(),De(bl,{key:n,value:n,class:"elevated-chip",color:"primary",variant:"tonal","prepend-icon":"mdi-signal-5g"},{default:m(()=>[ne(re(n),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(B,{cols:"12",md:"6",class:"hero-stats"},{default:m(()=>[(j(!0),ae(ke,null,Te(T(G),n=>(j(),ae("div",{key:n.label,class:"hero-stat"},[d("div",Kl,[t(me,{icon:n.icon,size:"26"},null,8,["icon"])]),d("div",Ql,[d("div",Zl,re(n.label),1),d("div",ea,re(n.value),1)]),d("div",{class:te(["stat-trend",n.tone])},re(n.trend),3)]))),128))]),_:1})]),_:1})]),_:1}),H.value.length>0?(j(),De(Be,{key:0,class:"announcement-banner",color:"transparent",elevation:"0"},{default:m(()=>[d("div",ta,[d("div",{class:te(["announcement-banner-header d-flex align-center",{"mb-3":E.value}])},[t(me,{icon:"mdi-bullhorn",class:"announcement-banner-icon mr-2",size:"24"}),a[22]||(a[22]=d("span",{class:"announcement-banner-title"},"最新公告",-1)),!E.value&&H.value.length>0?(j(),ae("div",{key:0,class:"announcement-preview-text mr-3",onClick:a[1]||(a[1]=n=>E.value=!0)},[d("span",la,re(H.value[0]),1)])):at("",!0),t(K,{icon:E.value?"mdi-chevron-up":"mdi-chevron-down",variant:"text",size:"small",class:"announcement-toggle-btn",onClick:a[2]||(a[2]=n=>E.value=!E.value)},null,8,["icon"])],2),t(gl,null,{default:m(()=>[xt(d("div",aa,[(j(!0),ae(ke,null,Te(H.value,(n,Q)=>(j(),ae("div",{key:Q,class:"announcement-banner-item d-flex align-start py-2"},[t(me,{icon:"mdi-circle-small",class:"announcement-banner-dot mr-3 mt-1",size:"small"}),d("span",na,re(n),1)]))),128))],512),[[hl,E.value]])]),_:1})])]),_:1})):at("",!0),t(xe,{dense:""},{default:m(()=>[t(B,{cols:"12",md:"7",lg:"8"},{default:m(()=>[t(Ue,{class:"section-card",loading:T(o),elevation:"0"},{default:m(()=>[t(rt,{class:"section-title d-flex align-center"},{default:m(()=>[d("div",oa,[t(me,{color:"primary"},{default:m(()=>[...a[23]||(a[23]=[ne("mdi-form-select",-1)])]),_:1})]),a[24]||(a[24]=d("div",null,[d("div",{class:"title-label"},"SASL"),d("div",{class:"title-sub"},"客戶資訊登記")],-1))]),_:1}),t(Fe,null,{default:m(()=>[t(Be,{class:"search-panel",elevation:"0"},{default:m(()=>[d("div",ra,[t(me,{icon:"mdi-radar",color:"primary",size:"26"}),a[25]||(a[25]=d("span",null,"快速檢索客戶",-1))]),a[26]||(a[26]=d("div",{class:"search-panel-subtitle"},"依據最新 5G 通訊資料庫，即時回傳查詢結果",-1))]),_:1}),t(xe,{dense:"",class:"mb-4",align:"center"},{default:m(()=>[t(B,{cols:"12",md:"4"},{default:m(()=>[t(se,{modelValue:T(C),"onUpdate:modelValue":a[3]||(a[3]=n=>Re(C)?C.value=n:null),label:"MRT 搜尋",placeholder:"輸入 MRT 號碼（可選）","prepend-inner-icon":"mdi-magnify"},null,8,["modelValue"])]),_:1}),t(B,{cols:"12",md:"4"},{default:m(()=>[t(Ke,{modelValue:T(p),"onUpdate:modelValue":a[4]||(a[4]=n=>Re(p)?p.value=n:null),items:T(D),label:"致電狀態",placeholder:"全部","prepend-inner-icon":"mdi-phone",clearable:""},null,8,["modelValue","items"])]),_:1}),t(B,{cols:"12",md:"4"},{default:m(()=>[t(Ke,{modelValue:T(i),"onUpdate:modelValue":a[5]||(a[5]=n=>Re(i)?i.value=n:null),items:T(f),label:"數據源",placeholder:"請選擇數據源（必選）","prepend-inner-icon":"mdi-database",rules:[n=>!!n||"數據源為必選項"],hint:"請選擇一個數據源進行搜索","persistent-hint":""},null,8,["modelValue","items","rules"])]),_:1})]),_:1}),t(Pt,{ref_key:"formRef",ref:S},{default:m(()=>[t(xe,{dense:""},{default:m(()=>[t(B,{cols:"12",md:"6"},{default:m(()=>[t(se,{modelValue:T(r).mrtNumber,"onUpdate:modelValue":a[6]||(a[6]=n=>T(r).mrtNumber=n),label:"MRT",placeholder:"例如：92479132","prepend-inner-icon":"mdi-cellphone",readonly:""},null,8,["modelValue"])]),_:1}),t(B,{cols:"12",md:"6"},{default:m(()=>[t(se,{modelValue:T(r).category,"onUpdate:modelValue":a[7]||(a[7]=n=>T(r).category=n),label:"類別",placeholder:"例如：638(出機 5G+數據王)","prepend-inner-icon":"mdi-tag",readonly:""},null,8,["modelValue"])]),_:1}),t(B,{cols:"12",md:"6"},{default:m(()=>[t(se,{modelValue:T(r).lastTurnNetworkMonth,"onUpdate:modelValue":a[8]||(a[8]=n=>T(r).lastTurnNetworkMonth=n),label:"最後轉網月份",placeholder:"例如：202011","prepend-inner-icon":"mdi-calendar-month",readonly:""},null,8,["modelValue"])]),_:1}),t(B,{cols:"12",md:"6"},{default:m(()=>[t(se,{modelValue:T(r).oldContract,"onUpdate:modelValue":a[9]||(a[9]=n=>T(r).oldContract=n),label:"舊合約",placeholder:"例如：2024.01","prepend-inner-icon":"mdi-calendar",readonly:""},null,8,["modelValue"])]),_:1}),t(B,{cols:"12",md:"6"},{default:m(()=>[t(se,{modelValue:T(r).sales,"onUpdate:modelValue":a[10]||(a[10]=n=>T(r).sales=n),label:"銷售員",placeholder:"例如：Jackson Hung","prepend-inner-icon":"mdi-account-tie",readonly:""},null,8,["modelValue"])]),_:1}),t(B,{cols:"12",md:"6"},{default:m(()=>[t(Ke,{modelValue:T(r).callStatus,"onUpdate:modelValue":a[11]||(a[11]=n=>T(r).callStatus=n),items:T(D),label:"致電狀態",placeholder:"請選擇",rules:[T(M).required],"prepend-inner-icon":"mdi-phone"},null,8,["modelValue","items","rules"])]),_:1}),t(B,{cols:"12",md:"6"},{default:m(()=>[t(At,{modelValue:Le.value,"onUpdate:modelValue":[a[15]||(a[15]=n=>Le.value=n),Xt],"close-on-content-click":!1},{activator:m(({props:n})=>[t(se,ue(n,{modelValue:T(r).nextCallTime,"onUpdate:modelValue":a[12]||(a[12]=Q=>T(r).nextCallTime=Q),label:"下次致電時間",placeholder:"請選擇日期和時間（可選）","prepend-inner-icon":"mdi-clock-time-four-outline",rules:[T(M).nextCallTime],readonly:"",clearable:""}),null,16,["modelValue","rules"])]),default:m(()=>[t(Ue,{"min-width":"300"},{default:m(()=>[t(Fe,{class:"pa-0"},{default:m(()=>[t(xe,{"no-gutters":""},{default:m(()=>[t(B,{cols:"12",md:"6"},{default:m(()=>[t(Ft,{modelValue:J.value,"onUpdate:modelValue":[a[13]||(a[13]=n=>J.value=n),Kt],min:je.value},null,8,["modelValue","min"])]),_:1}),t(B,{cols:"12",md:"6"},{default:m(()=>[t(zt,{modelValue:ee.value,"onUpdate:modelValue":[a[14]||(a[14]=n=>ee.value=n),Qt],format:"24hr"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(Ze,null,{default:m(()=>[t(K,{variant:"text",color:"error",onClick:Zt},{default:m(()=>[...a[27]||(a[27]=[ne(" 清除 ",-1)])]),_:1}),t(Ie),t(K,{variant:"text",color:"primary",onClick:el},{default:m(()=>[...a[28]||(a[28]=[ne(" 完成 ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(B,{cols:"12"},{default:m(()=>[t(Et,{modelValue:T(r).remark,"onUpdate:modelValue":a[16]||(a[16]=n=>T(r).remark=n),label:"備註",rows:"4","auto-grow":"","prepend-inner-icon":"mdi-note-text-outline"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},512)]),_:1}),t(ot),t(Ze,{class:"px-6 py-4 last-call-action"},{default:m(()=>[d("div",ia,[t(me,{icon:"mdi-clock-time-four-outline",size:"20"}),d("div",ua,[a[29]||(a[29]=d("div",{class:"pill-label"},"上次致電時間",-1)),d("div",sa,re(T(r).lastCallTime||"—"),1)])]),t(Ie),t(K,{class:"apple-primary-btn",color:"primary",loading:T(h),disabled:T(o),onClick:T(w)},{default:m(()=>[...a[30]||(a[30]=[ne(" NEXT ",-1)])]),_:1},8,["loading","disabled","onClick"])]),_:1})]),_:1},8,["loading"])]),_:1}),t(B,{cols:"12",md:"5",lg:"4"},{default:m(()=>[t(Ue,{class:"section-card translucent",elevation:"0"},{default:m(()=>[t(rt,{class:"section-title d-flex align-center"},{default:m(()=>[d("div",da,[t(me,{color:"primary"},{default:m(()=>[...a[31]||(a[31]=[ne("mdi-card-account-details",-1)])]),_:1})]),a[32]||(a[32]=d("div",null,[d("div",{class:"title-label"},"資訊預覽"),d("div",{class:"title-sub"},"Quick Review")],-1))]),_:1}),t(Fe,null,{default:m(()=>[T(L)?(j(),De(yl,{key:1,density:"compact",class:"preview-list"},{default:m(()=>[(j(!0),ae(ke,null,Te(T(le),n=>(j(),De(Sl,{key:n.label,title:n.label,subtitle:n.value||"—"},{prepend:m(()=>[t(me,{icon:n.icon,color:"primary"},null,8,["icon"])]),_:2},1032,["title","subtitle"]))),128))]),_:1})):(j(),De(gt,{key:0,type:"info",variant:"tonal",color:"primary",border:"start",class:"mb-4"},{default:m(()=>[...a[33]||(a[33]=[ne(" 填寫左側表單後，可在此快速覆核內容。 ",-1)])]),_:1}))]),_:1})]),_:1})]),_:1})]),_:1}),t(xe,{class:"plan-detail-row",dense:""},{default:m(()=>[t(B,{cols:"12"},{default:m(()=>[d("section",ca,[d("div",ma,[d("div",va,[t(me,{color:"primary"},{default:m(()=>[...a[34]||(a[34]=[ne("mdi-table-large",-1)])]),_:1})]),a[35]||(a[35]=d("div",null,[d("div",{class:"title-label"},"套餐明細檢視"),d("div",{class:"title-sub"},"csl 及 1O1O 最新優惠")],-1))]),t(gt,{type:"info",variant:"tonal",color:"primary",border:"start",class:"mb-6"},{default:m(()=>[...a[36]||(a[36]=[ne(" 以下表格整理自最新銷售資料表，可於客服對談時快速查閱主要資費、贈品及漫遊數據。 ",-1)])]),_:1}),t(Ml,{modelValue:T(oe),"onUpdate:modelValue":a[17]||(a[17]=n=>Re(oe)?oe.value=n:null),class:"plan-tabs",grow:"",density:"comfortable","slider-color":"primary"},{default:m(()=>[(j(!0),ae(ke,null,Te(T(Z),n=>(j(),De(Pl,{key:n.id,value:n.id,class:"plan-tab"},{default:m(()=>[d("div",fa,re(n.title),1),d("div",ha,re(n.subtitle),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),t(Nl,{modelValue:T(oe),"onUpdate:modelValue":a[18]||(a[18]=n=>Re(oe)?oe.value=n:null),class:"plan-window"},{default:m(()=>[(j(!0),ae(ke,null,Te(T(Z),n=>(j(),De(Al,{key:n.id,value:n.id,class:"plan-window-item"},{default:m(()=>[d("div",ga,[d("div",ya,[d("div",ka,re(n.title),1),d("div",ba,re(n.subtitle),1)])]),d("div",Sa,[d("table",wa,[d("thead",null,[d("tr",null,[a[37]||(a[37]=d("th",null,"項目",-1)),(j(!0),ae(ke,null,Te(n.columns,Q=>(j(),ae("th",{key:Q},re(Q),1))),128))])]),d("tbody",null,[(j(!0),ae(ke,null,Te(n.rows,Q=>(j(),ae("tr",{key:Q.label},[d("th",null,re(Q.label),1),(j(!0),ae(ke,null,Te(Q.values,(ce,ge)=>(j(),ae("td",{key:`${Q.label}-${ge}`},re(ce),1))),128))]))),128))])])]),n.footnote?(j(),ae("div",Ca,re(n.footnote),1)):at("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])])]),_:1})]),_:1}),t(Jl,{modelValue:c.value,"onUpdate:modelValue":a[19]||(a[19]=n=>c.value=n),record:N.value,onSubmitted:W},null,8,["modelValue","record"])]))}}),Ia=$t(pa,[["__scopeId","data-v-a1ff039b"]]);export{Ia as default};
