import{t as _,E as u,$ as x,W as h,r as E,k as y,Y as z,e as q,f as C,h as Z,n as V,a as J,P as Q}from"./index-DBDjDJo6.js";import{b as Pe,X as Me,j as Ne,o as He,w as Xe,m as Ye,D as Le,d as Ke,g as $e,A as ze,U as qe,_ as Ze,p as Ve,l as Je,I as Qe,c as et,u as tt,B as it,q as nt,Z as rt,C as st,R as at,z as ot,i as dt,s as gt,v as mt,x as ct,y as ht,L as ut}from"./index-DBDjDJo6.js";import{M as S,oZ as B,k as A,th as v,ti as W,hn as ee,u as j,tj as te,qy as ie,qx as ne,tk as re}from"./index--BQDx9CP.js";import{tl as It,tm as ft,tn as wt,to as pt,tp as _t,tq as vt,tr as Dt,ts as kt,tt as Et}from"./index--BQDx9CP.js";import{c8 as O,cD as w,W as G,L as P,a1 as k,v as se,w as ae,ec as U,C as oe,I as M,u as N,ca as de}from"./TeamSpreadsheet-DqPQXi__.js";import{c9 as yt}from"./TeamSpreadsheet-DqPQXi__.js";import{O as H,a as X,I as Y,$ as ge}from"./facade-DLk4o3Z_.js";import{q as R}from"./facade-CGdyi3nR.js";import{S as L,k as K}from"./facade-DJ8otAmv.js";import"./index-mJOBftNs.js";import"./VRow-C6N6h8s9.js";import"./VCard-DFIDGoOa.js";import"./VSelect-CO5xudFf.js";import"./VTextField-tFIcna6m.js";import"./VTabs-BYSgCciz.js";import"./VAlert-CfJUBCCM.js";import"./VDialog-C4Wnh1zS.js";import"./VFileInput-DBMVcNlc.js";import"./VTextarea-34QBZFhW.js";var me=Object.defineProperty,ce=(r,i,e)=>i in r?me(r,i,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[i]=e,he=(r,i,e)=>ce(r,i+"",e),$=(r,i,e,t)=>{for(var n=i,s=r.length-1,a;s>=0;s--)(a=r[s])&&(n=a(n)||n);return n},F=(r,i)=>(e,t)=>i(e,t,r);function ue(r,i){const{from:e,to:t,flipY:n=!1,flipX:s=!1,angle:a=0,skewX:o=0,skewY:d=0}=r.sheetTransform,{column:g,columnOffset:m,row:c,rowOffset:I}=e,f=ie(r.unitId,r.subUnitId,{from:e,to:t},i),{width:p,height:D}=f;return{...r,column:g,columnOffset:m,row:c,rowOffset:I,width:p,height:D,flipY:n,flipX:s,angle:a,skewX:o,skewY:d}}function le(r,i,e){const{column:t,columnOffset:n,row:s,rowOffset:a,flipY:o=!1,flipX:d=!1,angle:g=0,skewX:m=0,skewY:c=0,width:I,height:f}=r,p=ne(r.unitId,r.subUnitId,{column:t,columnOffset:n,row:s,rowOffset:a},I,f,i,e),{sheetTransform:D,transform:b}=p;return{...r,sheetTransform:{...D,flipY:o,flipX:d,angle:g,skewX:m,skewY:c},transform:{...b,flipY:o,flipX:d,angle:g,skewX:m,skewY:c}}}let T=class{constructor(r,i,e){he(this,"_image"),this._injector=e,this._image={drawingId:oe(6),drawingType:w.DRAWING_IMAGE,imageSourceType:O.BASE64,source:"",unitId:r,subUnitId:i,column:0,columnOffset:0,row:0,rowOffset:0,width:0,height:0}}setImage(r){const i=this._injector.get(S).getRenderById(r.unitId);if(!i)throw new Error(`Render Unit with unitId ${r.unitId} not found`);const e=i.with(j);return r.sheetTransform==null&&(r.sheetTransform={from:{column:0,columnOffset:0,row:0,rowOffset:0},to:{column:0,columnOffset:0,row:0,rowOffset:0}}),this._image=ue(r,e),this}setSource(r,i){const e=i??O.URL;return this._image.source=r,this._image.imageSourceType=e,this}getSource(){return this._image.source}getSourceType(){return this._image.imageSourceType}setColumn(r){return this._image.column=r,this}setRow(r){return this._image.row=r,this}setColumnOffset(r){return this._image.columnOffset=r,this}setRowOffset(r){return this._image.rowOffset=r,this}setWidth(r){return this._image.width=r,this}setHeight(r){return this._image.height=r,this}setAnchorType(r){return this._image.anchorType=r,this}setCropTop(r){return this._initializeSrcRect(),this._image.srcRect.top=r,this}setCropLeft(r){return this._initializeSrcRect(),this._image.srcRect.left=r,this}setCropBottom(r){return this._initializeSrcRect(),this._image.srcRect.bottom=r,this}setCropRight(r){return this._initializeSrcRect(),this._image.srcRect.right=r,this}_initializeSrcRect(){this._image.srcRect==null&&(this._image.srcRect={top:0,left:0,bottom:0,right:0})}setRotate(r){return this._image.angle=r,this}setUnitId(r){return this._image.unitId=r,this}setSubUnitId(r){return this._image.subUnitId=r,this}async buildAsync(){const r=this._injector.get(S).getRenderById(this._image.unitId);if(!r)throw new Error(`Render Unit with unitId ${this._image.unitId} not found`);const i=r.with(B),e=r.with(j);if(this._image.width===0||this._image.height===0){const t=await te(this._image.source),n=t.width,s=t.height;this._image.width===0&&(this._image.width=n),this._image.height===0&&(this._image.height=s)}return le(this._image,i,e)}};T=$([F(2,M(N))],T);let l=class extends ge{constructor(r,i,e){super(),this._image=r,this._commandService=i,this._injector=e}getId(){return this._image.drawingId}getType(){return this._image.drawingType}remove(){return this._commandService.syncExecuteCommand(E.id,{unitId:this._image.unitId,drawings:[this._image]})}toBuilder(){const r=this._injector.createInstance(T);return r.setImage(this._image),r}setSource(r,i){const e=i??O.URL;return this._image.source=r,this._image.imageSourceType=e,this._commandService.syncExecuteCommand(h.id,{unitId:this._image.unitId,drawings:[this._image]})}async setPositionAsync(r,i,e,t){const n=this.toBuilder();n.setColumn(i),n.setRow(r),e!=null&&n.setRowOffset(e),t!=null&&n.setColumnOffset(t);const s=await n.buildAsync();return this._commandService.syncExecuteCommand(h.id,{unitId:this._image.unitId,drawings:[s]})}async setSizeAsync(r,i){const e=this.toBuilder();e.setWidth(r),e.setHeight(i);const t=await e.buildAsync();return this._commandService.syncExecuteCommand(h.id,{unitId:this._image.unitId,drawings:[t]})}setCrop(r,i,e,t){return this._image.srcRect==null&&(this._image.srcRect={top:0,left:0,bottom:0,right:0}),r!=null&&(this._image.srcRect.top=r),i!=null&&(this._image.srcRect.left=i),e!=null&&(this._image.srcRect.bottom=e),t!=null&&(this._image.srcRect.right=t),this._commandService.syncExecuteCommand(h.id,{unitId:this._image.unitId,drawings:[this._image]})}setRotate(r){return this._image.sheetTransform.angle=r,this._image.transform&&(this._image.transform.angle=r),this._commandService.syncExecuteCommand(h.id,{unitId:this._image.unitId,drawings:[this._image]})}setForward(){return this._commandService.syncExecuteCommand(C.id,{unitId:this._image.unitId,subUnitId:this._image.subUnitId,drawingIds:[this._image.drawingId],arrangeType:U.forward})}setBackward(){return this._commandService.syncExecuteCommand(C.id,{unitId:this._image.unitId,subUnitId:this._image.subUnitId,drawingIds:[this._image.drawingId],arrangeType:U.backward})}setBack(){return this._commandService.syncExecuteCommand(C.id,{unitId:this._image.unitId,subUnitId:this._image.subUnitId,drawingIds:[this._image.drawingId],arrangeType:U.back})}setFront(){return this._commandService.syncExecuteCommand(C.id,{unitId:this._image.unitId,subUnitId:this._image.subUnitId,drawingIds:[this._image.drawingId],arrangeType:U.front})}};l=$([F(1,P),F(2,M(N))],l);class Ie extends L{getFloatDomById(i){const e=this._injector.get(_).getFloatDomInfo(i);if(!e)return null;const{unitId:t,subUnitId:n}=e,{rect:s}=e,a=s.getState(),{left:o=0,top:d=0,width:g=0,height:m=0,flipX:c=!1,flipY:I=!1,angle:f=0,skewX:p=0,skewY:D=0}=a,b=this._injector.get(u).getDrawingByParam({drawingId:e.id,unitId:t,subUnitId:n});return b?{position:{left:o,top:d,width:g,height:m,flipX:c,flipY:I,angle:f,skewX:p,skewY:D},componentKey:b.componentKey,allowTransform:b.allowTransform,data:b.data,id:e.id}:null}getAllFloatDoms(){const i=this._injector.get(_),e=this._workbook.getUnitId(),t=this._worksheet.getSheetId();return Array.from(i.getFloatDomsBySubUnitId(e,t).values()).map(n=>{const{rect:s}=n,a=this._injector.get(u).getDrawingByParam({drawingId:n.id,unitId:e,subUnitId:t}),{left:o,top:d,width:g,height:m,flipX:c,flipY:I,angle:f,skewX:p,skewY:D}=s.getState();return{position:{left:o,top:d,width:g,height:m,flipX:c,flipY:I,angle:f,skewX:p,skewY:D},componentKey:a.componentKey,allowTransform:a.allowTransform,data:a.data,id:n.id}})}updateFloatDom(i,e){var t,n;const s=this._injector.get(_).getFloatDomInfo(i);if(!s)return this;const{unitId:a,subUnitId:o}=s,d=this._injector.get(u).getDrawingByParam({unitId:a,subUnitId:o,drawingId:i}),g=this._injector.get(S);if(!g.getRenderById(a))return this;if(!this.getSkeleton())return this;const m=(t=g.getRenderById(this.getWorkbook().getUnitId()))==null?void 0:t.with(B);if(!m)return this;const c={...d,componentKey:e.componentKey||d.componentKey,allowTransform:e.allowTransform!==void 0?e.allowTransform:d.allowTransform,data:e.data||d.data,sheetTransform:e.position&&(n=x(e.position,m))!=null?n:d.sheetTransform,transform:{...d.transform,...e.position}};if(!this._commandService.syncExecuteCommand(h.id,{unitId:a,subUnitId:o,drawings:[c]}))throw new Error("updateFloatDom failed");return this}batchUpdateFloatDoms(i){var e;const t=this._injector.get(_),n=this._injector.get(u),s=this._injector.get(S),a=[];for(const o of i){const d=t.getFloatDomInfo(o.id);if(!d)continue;const{unitId:g,subUnitId:m}=d,c=n.getDrawingByParam({unitId:g,subUnitId:m,drawingId:o.id});if(!c)continue;const I=s.getRenderById(g);if(!I||!this.getSkeleton())continue;const f=I.with(B);if(!f)return this;const p={...c,componentKey:o.config.componentKey||c.componentKey,allowTransform:o.config.allowTransform!==void 0?o.config.allowTransform:c.allowTransform,data:o.config.data||c.data,sheetTransform:o.config.position&&(e=x(o.config.position,f))!=null?e:c.sheetTransform,transform:{...c.transform,...o.config.position}};a.push(p)}if(a.length>0){const o=this._workbook.getUnitId(),d=this._worksheet.getSheetId();if(!this._commandService.syncExecuteCommand(h.id,{unitId:o,subUnitId:d,drawings:a}))throw new Error("batchUpdateFloatDoms failed")}return this}removeFloatDom(i){const e=this._injector.get(_).getFloatDomInfo(i);if(!e)return this;const{unitId:t,subUnitId:n}=e,s=this._injector.get(u).getDrawingByParam({unitId:t,subUnitId:n,drawingId:i});if(!s)return this;if(!this._commandService.syncExecuteCommand(E.id,{unitId:t,drawings:[s]}))throw new Error("removeFloatDom failed");return this}addFloatDomToPosition(i,e){const t=this._workbook.getUnitId(),n=this._worksheet.getSheetId(),{key:s,disposableCollection:a}=R(i,this._injector.get(A)),o=this._injector.get(_).addFloatDomToPosition({...i,componentKey:s,unitId:t,subUnitId:n},e);return o?(a.add(o.dispose),{id:o.id,dispose:()=>{a.dispose(),o.dispose()}}):(a.dispose(),null)}addFloatDomToRange(i,e,t,n){const s=this._workbook.getUnitId(),a=this._worksheet.getSheetId(),{key:o,disposableCollection:d}=R(e,this._injector.get(A)),g=this._injector.get(_).addFloatDomToRange(i.getRange(),{...e,componentKey:o,unitId:s,subUnitId:a},t,n);return g?(d.add(g.dispose),{id:g.id,dispose:()=>{d.dispose(),g.dispose()}}):(d.dispose(),null)}addFloatDomToColumnHeader(i,e,t,n){const s=this._workbook.getUnitId(),a=this._worksheet.getSheetId(),{key:o,disposableCollection:d}=R(e,this._injector.get(A)),g=this._injector.get(_).addFloatDomToColumnHeader(i,{...e,componentKey:o,unitId:s,subUnitId:a},t,n);return g?(d.add(g.dispose),{id:g.id,dispose:()=>{d.dispose(),g.dispose()}}):(d.dispose(),null)}async insertImage(i,e,t,n,s){const a=this.newOverGridImage();if(typeof i=="string")a.setSource(i);else{const d=await i.getBlob().getDataAsString();a.setSource(d,O.BASE64)}e!==void 0?a.setColumn(e):a.setColumn(0),t!==void 0?a.setRow(t):a.setRow(0),n!==void 0?a.setColumnOffset(n):a.setColumnOffset(0),s!==void 0?a.setRowOffset(s):a.setRowOffset(0);const o=await a.buildAsync();return this._commandService.syncExecuteCommand(y.id,{unitId:this._fWorkbook.getId(),drawings:[o]})}insertImages(i){const e=i.map(t=>(t.unitId=this._fWorkbook.getId(),t.subUnitId=this.getSheetId(),t));return this._commandService.syncExecuteCommand(y.id,{unitId:this._fWorkbook.getId(),drawings:e}),this}deleteImages(i){const e=i.map(t=>({unitId:this._fWorkbook.getId(),drawingId:t.getId(),subUnitId:this.getSheetId(),drawingType:t.getType()}));return this._commandService.syncExecuteCommand(E.id,{unitId:this._fWorkbook.getId(),drawings:e}),this}getImages(){const i=this._injector.get(u).getDrawingData(this._fWorkbook.getId(),this.getSheetId()),e=[];for(const t in i){const n=i[t];n.drawingType===w.DRAWING_IMAGE&&e.push(this._injector.createInstance(l,n))}return e}getImageById(i){const e=this._injector.get(u).getDrawingByParam({unitId:this._fWorkbook.getId(),subUnitId:this.getSheetId(),drawingId:i});return e&&e.drawingType===w.DRAWING_IMAGE?this._injector.createInstance(l,e):null}getActiveImages(){const i=this._injector.get(u).getFocusDrawings(),e=[];for(const t in i){const n=i[t];e.push(this._injector.createInstance(l,n))}return e}updateImages(i){return this._commandService.syncExecuteCommand(h.id,{unitId:this._fWorkbook.getId(),drawings:i}),this}onImageInserted(i){const e=this._injector.get(u);return G(e.add$.subscribe(t=>{const n=t.map(s=>this._injector.createInstance(l,e.getDrawingByParam(s)));i(n)}))}onImageDeleted(i){const e=this._injector.get(u);return G(e.remove$.subscribe(t=>{const n=t.map(s=>this._injector.createInstance(l,e.getDrawingByParam(s)));i(n)}))}onImageChanged(i){const e=this._injector.get(u);return G(e.update$.subscribe(t=>{const n=t.map(s=>this._injector.createInstance(l,e.getDrawingByParam(s)));i(n)}))}newOverGridImage(){const i=this._fWorkbook.getId(),e=this.getSheetId();return this._injector.createInstance(T,i,e)}}L.extend(Ie);class fe extends H{get DrawingType(){return w}get ImageSourceType(){return O}get SheetDrawingAnchorType(){return z}}H.extend(fe);class we extends X{get BeforeFloatDomAdd(){return"BeforeFloatDomAdd"}get FloatDomAdded(){return"FloatDomAdded"}get BeforeFloatDomUpdate(){return"BeforeFloatDomUpdate"}get FloatDomUpdated(){return"FloatDomUpdated"}get BeforeFloatDomDelete(){return"BeforeFloatDomDelete"}get FloatDomDeleted(){return"FloatDomDeleted"}get BeforeOverGridImageChange(){return"BeforeOverGridImageChange"}get OverGridImageChanged(){return"OverGridImageChanged"}get BeforeOverGridImageInsert(){return"BeforeOverGridImageInsert"}get OverGridImageInserted(){return"OverGridImageInserted"}get BeforeOverGridImageRemove(){return"BeforeOverGridImageRemove"}get OverGridImageRemoved(){return"OverGridImageRemoved"}get BeforeOverGridImageSelect(){return"BeforeOverGridImageSelect"}get OverGridImageSelected(){return"OverGridImageSelected"}}X.extend(we);class pe extends Y{_initialize(i){const e=i.get(P);this.registerEventHandler(this.Event.BeforeFloatDomAdd,()=>e.beforeCommandExecuted(t=>{if(t.id!==y.id)return;const n=t.params,s=this.getActiveWorkbook();if(s==null||n==null)return;const{drawings:a}=n,o=a.filter(g=>g.drawingType===w.DRAWING_DOM);if(o.length===0)return;const d={workbook:s,drawings:o};if(this.fireEvent(this.Event.BeforeFloatDomAdd,d),d.cancel)throw new k})),this.registerEventHandler(this.Event.FloatDomAdded,()=>e.onCommandExecuted(t=>{if(t.id!==y.id)return;const n=t.params,s=this.getActiveWorkbook();if(s==null||n==null)return;const{drawings:a}=n,o=a.filter(d=>d.drawingType===w.DRAWING_DOM);o.length!==0&&this.fireEvent(this.Event.FloatDomAdded,{workbook:s,drawings:o})})),this.registerEventHandler(this.Event.BeforeOverGridImageInsert,()=>e.beforeCommandExecuted(t=>{if(t.id!==y.id)return;const n=t.params,s=this.getActiveWorkbook();if(s==null||n==null)return;const{drawings:a}=n,o={workbook:s,insertImageParams:a};if(this.fireEvent(this.Event.BeforeOverGridImageInsert,o),o.cancel)throw new k})),this.registerEventHandler(this.Event.BeforeOverGridImageRemove,()=>e.beforeCommandExecuted(t=>{if(t.id!==E.id)return;const n=t.params,s=this.getActiveWorkbook();if(s==null||n==null)return;const a=i.get(v),{drawings:o}=n,d=o.map(m=>a.getDrawingByParam(m)),g={workbook:s,images:this._createFOverGridImage(d)};if(this.fireEvent(this.Event.BeforeOverGridImageRemove,g),g.cancel)throw new k})),this.registerEventHandler(this.Event.BeforeOverGridImageChange,()=>e.beforeCommandExecuted(t=>{if(t.id!==h.id)return;const n=t.params,s=this.getActiveWorkbook();if(s==null||n==null)return;const{drawings:a}=n,o=i.get(v),d=[];a.forEach(m=>{const c=o.getDrawingByParam(m);c!=null&&d.push({changeParam:m,image:this._injector.createInstance(l,c)})});const g={workbook:s,images:d};if(this.fireEvent(this.Event.BeforeOverGridImageChange,g),g.cancel)throw o.updateNotification(a),new k})),this.registerEventHandler(this.Event.BeforeFloatDomUpdate,()=>e.beforeCommandExecuted(t=>{if(t.id!==h.id)return;const n=t.params,s=this.getActiveWorkbook();if(s==null||n==null)return;const{drawings:a}=n,o=i.get(v),d=[];if(a.forEach(m=>{const c=o.getDrawingByParam(m);(c==null?void 0:c.drawingType)===w.DRAWING_DOM&&d.push(c)}),d.length===0)return;const g={workbook:s,drawings:d};if(this.fireEvent(this.Event.BeforeFloatDomUpdate,g),g.cancel)throw o.updateNotification(a),new k})),this.registerEventHandler(this.Event.FloatDomUpdated,()=>e.onCommandExecuted(t=>{if(t.id!==h.id)return;const n=t.params,s=this.getActiveWorkbook();if(s==null||n==null)return;const{drawings:a}=n,o=i.get(v),d=[];a.forEach(g=>{const m=o.getDrawingByParam(g);(m==null?void 0:m.drawingType)===w.DRAWING_DOM&&d.push(m)}),d.length!==0&&this.fireEvent(this.Event.FloatDomUpdated,{workbook:s,drawings:d})})),this.registerEventHandler(this.Event.BeforeFloatDomDelete,()=>e.beforeCommandExecuted(t=>{if(t.id!==E.id)return;const n=t.params,s=this.getActiveWorkbook();if(s==null||n==null)return;const a=i.get(v),{drawings:o}=n,d=o.map(m=>a.getDrawingByParam(m)).filter(m=>(m==null?void 0:m.drawingType)===w.DRAWING_DOM);if(d.length===0)return;const g={workbook:s,drawings:d};if(this.fireEvent(this.Event.BeforeFloatDomDelete,g),g.cancel)throw new k})),this.registerEventHandler(this.Event.FloatDomDeleted,()=>e.onCommandExecuted(t=>{if(t.id!==E.id)return;const n=t.params,s=this.getActiveWorkbook();if(s==null||n==null)return;const{drawings:a}=n;this.fireEvent(this.Event.FloatDomDeleted,{workbook:s,drawings:a.filter(o=>o.drawingType===w.DRAWING_DOM).map(o=>o.drawingId)})})),this.registerEventHandler(this.Event.BeforeOverGridImageSelect,()=>e.beforeCommandExecuted(t=>{if(t.id!==W.id)return;const n=t.params,s=this.getActiveWorkbook();if(s==null)return;const a=i.get(v),o=a.getFocusDrawings(),d=n.map(m=>a.getDrawingByParam(m)),g={workbook:s,selectedImages:this._createFOverGridImage(d),oldSelectedImages:this._createFOverGridImage(o)};if(this.fireEvent(this.Event.BeforeOverGridImageSelect,g),g.cancel)throw new k})),this.registerEventHandler(this.Event.OverGridImageInserted,()=>e.onCommandExecuted(t=>{if(t.id!==y.id)return;const n=t.params,s=this.getActiveWorkbook();if(s==null||n==null)return;const{drawings:a}=n;this.fireEvent(this.Event.OverGridImageInserted,{workbook:s,images:this._createFOverGridImage(a)})})),this.registerEventHandler(this.Event.OverGridImageRemoved,()=>e.onCommandExecuted(t=>{if(t.id!==E.id)return;const n=t.params,s=this.getActiveWorkbook();if(s==null||n==null)return;const{drawings:a}=n;this.fireEvent(this.Event.OverGridImageRemoved,{workbook:s,removeImageParams:a})})),this.registerEventHandler(this.Event.OverGridImageChanged,()=>e.onCommandExecuted(t=>{if(t.id!==h.id)return;const n=t.params,s=this.getActiveWorkbook();if(s==null||n==null)return;const{drawings:a}=n,o=i.get(v),d=a.map(g=>this._injector.createInstance(l,o.getDrawingByParam(g)));this.fireEvent(this.Event.OverGridImageChanged,{workbook:s,images:d})})),this.registerEventHandler(this.Event.OverGridImageSelected,()=>e.onCommandExecuted(t=>{if(t.id!==W.id)return;const n=t.params,s=this.getActiveWorkbook();if(s==null)return;const a=i.get(v),o=n.map(d=>a.getDrawingByParam(d));this.fireEvent(this.Event.OverGridImageSelected,{workbook:s,selectedImages:this._createFOverGridImage(o)})}))}_createFOverGridImage(i){return i.map(e=>this._injector.createInstance(l,e))}}Y.extend(pe);class _e extends K{async insertCellImageAsync(i){var e;const t=this._injector.get(S),n=(e=ee(ae.UNIVER_SHEET,this._injector.get(se),t))==null?void 0:e.with(q);if(!n)return!1;const s={unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),row:this.getRow(),col:this.getColumn()};return typeof i=="string"?n.insertCellImageByUrl(i,s):n.insertCellImageByFile(i,s)}}K.extend(_e);function xe(r={}){const{collaboration:i=!1}=r;return{plugins:[[re,{override:i?[[de,null]]:[]}],Z,V,J,Q].filter(e=>!!e)}}export{Pe as AutoImageCropOperation,Me as COMPONENT_IMAGE_POPUP_MENU,Ne as ClearSheetDrawingTransformerOperation,He as CloseImageCropOperation,Xe as DOCS_DRAWING_PLUGIN,It as DRAWING_IMAGE_ALLOW_IMAGE_LIST,ft as DRAWING_IMAGE_ALLOW_SIZE,wt as DRAWING_IMAGE_COUNT_LIMIT,pt as DRAWING_IMAGE_HEIGHT_LIMIT,_t as DRAWING_IMAGE_WIDTH_LIMIT,Ye as DeleteDrawingsCommand,Le as DocDrawingController,Ke as DocDrawingService,$e as DrawingApplyType,ze as DrawingCommonPanel,vt as DrawingManagerService,qe as DrawingRenderService,Ze as EditSheetDrawingOperation,Ve as GroupSheetDrawingCommand,Je as IDocDrawingService,v as IDrawingManagerService,de as IImageIoService,u as ISheetDrawingService,Qe as ImageCropperObject,Dt as ImageIoService,et as ImagePopupMenu,tt as ImageResetSizeOperation,O as ImageSourceType,yt as ImageUploadStatusType,it as InsertFloatImageCommand,y as InsertSheetDrawingCommand,nt as MoveDrawingsCommand,rt as OpenImageCropOperation,E as RemoveSheetDrawingCommand,st as SHEETS_IMAGE_MENU_ID,at as SHEET_DRAWING_PLUGIN,ot as SetDrawingAlignOperation,dt as SetDrawingApplyMutation,C as SetDrawingArrangeCommand,W as SetDrawingSelectedOperation,h as SetSheetDrawingCommand,_ as SheetCanvasFloatDomManagerService,z as SheetDrawingAnchorType,q as SheetDrawingUpdateController,gt as SidebarSheetDrawingOperation,mt as UngroupSheetDrawingCommand,kt as UnitDrawingService,Z as UniverDocsDrawingPlugin,re as UniverDrawingPlugin,V as UniverDrawingUIPlugin,J as UniverSheetsDrawingPlugin,xe as UniverSheetsDrawingPreset,Q as UniverSheetsDrawingUIPlugin,ct as calcSheetFloatDomPosition,ht as drawingPositionToTransform,Et as getDrawingShapeKeyByDrawingSearch,te as getImageSize,ut as getUpdateParams,x as transformToDrawingPosition};
