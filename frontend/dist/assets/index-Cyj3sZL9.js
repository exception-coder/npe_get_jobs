import{v as a,S as g,C as S,I as y,d as v}from"./index-DhqLArvi.js";import{D as se,R as ae,M as de,t as le,a as pe,N as he,E as ce,_ as ke,y as me,w as ue}from"./index-DhqLArvi.js";import{c as C,a as I}from"./index-DTw3uDfQ.js";import{X as Se,V as ye,F as Le,A as He,q as we,Z as fe,U as ve}from"./index-DTw3uDfQ.js";import{C as _,bC as U,b0 as m,L as x,a1 as d,I as E}from"./TeamSpreadsheet-DqPQXi__.js";import{C as l,S as L,k as H}from"./facade-DJ8otAmv.js";import{a as R,I as w}from"./facade-DLk4o3Z_.js";import"./index--BQDx9CP.js";import"./index-DNSnhRIr.js";import"./index-R4J-DW51.js";import"./index-DT5UJx9J.js";import"./index-mJOBftNs.js";import"./VRow-C6N6h8s9.js";import"./VCard-DFIDGoOa.js";import"./VSelect-CO5xudFf.js";import"./VTextField-tFIcna6m.js";import"./VTabs-BYSgCciz.js";import"./VAlert-CfJUBCCM.js";import"./VDialog-C4Wnh1zS.js";import"./VFileInput-DBMVcNlc.js";import"./VTextarea-34QBZFhW.js";var b=(o,r,i,n)=>{for(var e=r,t=o.length-1,s;t>=0;t--)(s=o[t])&&(e=s(e)||e);return e},A=(o,r)=>(i,n)=>r(i,n,o);let u=class{constructor(o,r){this._workbook=o,this._parserService=r}getRangeUrl(o){return this._parserService.buildHyperLink(this._workbook.getId(),o.getSheetId(),o.getRange()),this}};u=b([A(1,E(a))],u);class f extends l{createSheetHyperlink(r,i){return this._injector.get(a).buildHyperLink(this.getId(),r,i)}parseSheetHyperlink(r){return this._injector.get(a).parseHyperLink(r)}}l.extend(f);class B extends L{getUrl(){return this._injector.get(a).buildHyperLink(this._workbook.getUnitId(),this._worksheet.getSheetId())}}L.extend(B);class T extends H{setHyperLink(r,i){const n={unitId:this.getUnitId(),subUnitId:this._worksheet.getSheetId(),link:{row:this._range.startRow,column:this._range.startColumn,payload:r,display:i,id:_()}};return this._commandService.executeCommand(g.id,n)}getHyperLinks(){var r,i,n;const e=this._worksheet.getCellRaw(this._range.startRow,this._range.startColumn);return e!=null&&e.p?(n=(i=(r=e.p.body)==null?void 0:r.customRanges)==null?void 0:i.filter(t=>t.rangeType===U.HYPERLINK).map(t=>{var s,p,h,c,k;return{id:`${t.rangeId}`,startIndex:t.startIndex,endIndex:t.endIndex,url:(p=(s=t.properties)==null?void 0:s.url)!=null?p:"",label:(k=(c=(h=e.p)==null?void 0:h.body)==null?void 0:c.dataStream.slice(t.startIndex,t.endIndex+1).replaceAll(m.CUSTOM_RANGE_START,"").replaceAll(m.CUSTOM_RANGE_END,""))!=null?k:""}}))!=null?n:[]:[]}updateHyperLink(r,i,n){const e={unitId:this.getUnitId(),subUnitId:this._worksheet.getSheetId(),row:this._range.startRow,column:this._range.startColumn,id:r,payload:{payload:i,display:n}};return this._commandService.executeCommand(S.id,e)}cancelHyperLink(r){const i={unitId:this.getUnitId(),subUnitId:this._worksheet.getSheetId(),row:this._range.startRow,column:this._range.startColumn,id:r};return this._commandService.syncExecuteCommand(y.id,i)}getUrl(){return this._injector.get(a).buildHyperLink(this.getUnitId(),this.getSheetId(),this.getRange())}}H.extend(T);class P{get BeforeSheetLinkAdd(){return"BeforeSheetLinkAdd"}get BeforeSheetLinkCancel(){return"BeforeSheetLinkCancel"}get BeforeSheetLinkUpdate(){return"BeforeSheetLinkUpdate"}}R.extend(P);class j extends w{_initialize(r){const i=r.get(x);this.registerEventHandler(this.Event.BeforeSheetLinkAdd,()=>i.beforeCommandExecuted(n=>{if(n.id!==g.id)return;const e=this.getCommandSheetTarget(n);if(!e)return;const t=n.params,s={workbook:e.workbook,worksheet:e.worksheet,row:t.link.row,col:t.link.column,link:t.link};if(this.fireEvent(this.Event.BeforeSheetLinkAdd,s),s.cancel)throw new d})),this.registerEventHandler(this.Event.BeforeSheetLinkUpdate,()=>i.beforeCommandExecuted(n=>{if(n.id!==S.id)return;const e=this.getCommandSheetTarget(n);if(!e)return;const t=n.params,s={workbook:e.workbook,worksheet:e.worksheet,row:t.row,column:t.column,id:t.id,payload:t.payload};if(this.fireEvent(this.Event.BeforeSheetLinkUpdate,s),s.cancel)throw new d})),this.registerEventHandler(this.Event.BeforeSheetLinkCancel,()=>i.beforeCommandExecuted(n=>{if(n.id!==y.id)return;const e=this.getCommandSheetTarget(n);if(!e)return;const t=n.params,s={workbook:e.workbook,worksheet:e.worksheet,row:t.row,column:t.column,id:t.id};if(this.fireEvent(this.Event.BeforeSheetLinkCancel,s),s.cancel)throw new d}))}}w.extend(j);class M extends f{navigateToSheetHyperlink(r){const i=this._injector.get(a),n=this._injector.get(C),e=i.parseHyperLink(r);n.navigate(e)}}l.extend(M);function ne(o={}){const{urlHandler:r}=o;return{plugins:[v,[I,{urlHandler:r}]].filter(i=>!!i)}}export{g as AddHyperLinkCommand,se as AddHyperLinkMutation,ae as AddRichHyperLinkCommand,y as CancelHyperLinkCommand,de as CancelRichHyperLinkCommand,Se as CloseHyperLinkPopupOperation,le as ERROR_RANGE,pe as HyperLinkModel,ye as InsertHyperLinkOperation,Le as InsertLinkShortcut,He as OpenHyperLinkEditPanelOperation,he as RemoveHyperLinkMutation,ce as SheetHyperLinkType,we as SheetsHyperLinkCopyPasteController,a as SheetsHyperLinkParserService,fe as SheetsHyperLinkPopupService,C as SheetsHyperLinkResolverService,ve as SheetsHyperLinkSidePanelService,v as UniverSheetsHyperLinkPlugin,ne as UniverSheetsHyperLinkPreset,I as UniverSheetsHyperLinkUIPlugin,S as UpdateHyperLinkCommand,ke as UpdateHyperLinkMutation,me as UpdateHyperLinkRefMutation,ue as UpdateRichHyperLinkCommand};
