import{B as _,M as m,I as C,c as o,d as l,z as k,f as I}from"./index-Ctp6PiU5.js";import{E as Y,b as Z,y as ee,q as te,u as re,a as ie,e as ne,N as oe,p as se,R as ae,G as le,g as he,w as de,h as ge,i as ce,j as me,S as ue,F as Se,O as Fe}from"./index-Ctp6PiU5.js";import{H as v}from"./index-BLK1e6H_.js";import{X as Ce,S as ke,M as Ie,U as ve,w as fe}from"./index-BLK1e6H_.js";import{L as u,I as f,u as w}from"./TeamSpreadsheet-DqPQXi__.js";import{k as h,S,x as R}from"./facade-DJ8otAmv.js";import{O as E,a as d,I as F}from"./facade-DLk4o3Z_.js";import"./index--BQDx9CP.js";import"./index-mJOBftNs.js";import"./VRow-C6N6h8s9.js";import"./VCard-DFIDGoOa.js";import"./VSelect-CO5xudFf.js";import"./VTextField-tFIcna6m.js";import"./VTabs-BYSgCciz.js";import"./VAlert-CfJUBCCM.js";import"./VDialog-C4Wnh1zS.js";import"./VFileInput-DBMVcNlc.js";import"./VTextarea-34QBZFhW.js";var b=(r,e,t,i)=>{for(var n=e,a=r.length-1,g;a>=0;a--)(g=r[a])&&(n=g(n)||n);return n},c=(r,e)=>(t,i)=>e(t,i,r);let s=class{constructor(r,e,t,i,n){this._workbook=r,this._worksheet=e,this._filterModel=t,this._injector=i,this._commandSrv=n}getFilteredOutRows(){return Array.from(this._filterModel.filteredOutRows).sort()}getColumnFilterCriteria(r){var e;return(e=this._filterModel.getFilterColumn(r))==null?void 0:e.getColumnData()}removeColumnFilterCriteria(r){return this._commandSrv.syncExecuteCommand(o.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),col:r,criteria:null}),this}setColumnFilterCriteria(r,e){return this._commandSrv.syncExecuteCommand(o.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),col:r,criteria:e}),this}getRange(){const r=this._filterModel.getRange();return this._injector.createInstance(h,this._workbook,this._worksheet,r)}removeFilterCriteria(){return this._commandSrv.syncExecuteCommand(l.id),this}remove(){return this._commandSrv.syncExecuteCommand(k.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId()})}};s=b([c(3,f(w)),c(4,u)],s);class p extends h{createFilter(){return this._getFilterModel()||!this._commandService.syncExecuteCommand(_.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),range:this._range})?null:this.getFilter()}getFilter(){const e=this._getFilterModel();return e?this._injector.createInstance(s,this._workbook,this._worksheet,e):null}_getFilterModel(){return this._injector.get(m).getFilterModel(this._workbook.getUnitId(),this._worksheet.getSheetId())}}h.extend(p);class x extends S{getFilter(){const e=this._getFilterModel();return e?this._injector.createInstance(s,this._workbook,this._worksheet,e):null}_getFilterModel(){return this._injector.get(m).getFilterModel(this._workbook.getUnitId(),this._worksheet.getSheetId())}}S.extend(x);class U{get CustomFilterOperator(){return C}}E.extend(U);class M extends d{get SheetBeforeRangeFilter(){return"SheetBeforeRangeFilter"}get SheetRangeFiltered(){return"SheetRangeFiltered"}get SheetRangeFilterCleared(){return"SheetRangeFilterCleared"}get SheetBeforeRangeFilterClear(){return"SheetBeforeRangeFilterClear"}}d.extend(M);d.extend(R);let y=class extends F{_initialize(e){const t=e.get(u);this.registerEventHandler(this.Event.SheetBeforeRangeFilter,()=>t.beforeCommandExecuted(i=>{i.id===o.id&&this._beforeRangeFilter(i)})),this.registerEventHandler(this.Event.SheetBeforeRangeFilterClear,()=>t.beforeCommandExecuted(i=>{i.id===l.id&&this._beforeRangeFilterClear()})),this.registerEventHandler(this.Event.SheetRangeFiltered,()=>t.onCommandExecuted(i=>{i.id===o.id&&this._onRangeFiltered(i)})),this.registerEventHandler(this.Event.SheetRangeFilterCleared,()=>t.onCommandExecuted(i=>{i.id===l.id&&this._onRangeFilterCleared()}))}_beforeRangeFilter(e){const t=e.params,i=this.getUniverSheet(t.unitId),n={workbook:i,worksheet:i.getSheetBySheetId(t.subUnitId),col:t.col,criteria:t.criteria};if(this.fireEvent(this.Event.SheetBeforeRangeFilter,n),n.cancel)throw new Error("SetSheetsFilterCriteriaCommand canceled.")}_onRangeFiltered(e){const t=e.params,i=this.getUniverSheet(t.unitId),n={workbook:i,worksheet:i.getSheetBySheetId(t.subUnitId),col:t.col,criteria:t.criteria};this.fireEvent(this.Event.SheetRangeFiltered,n)}_beforeRangeFilterClear(){const e=this.getActiveWorkbook();if(!e)return;const t={workbook:e,worksheet:e.getActiveSheet()};if(this.fireEvent(this.Event.SheetBeforeRangeFilterClear,t),t.cancel)throw new Error("SetSheetsFilterCriteriaCommand canceled.")}_onRangeFilterCleared(){const e=this.getActiveWorkbook();if(!e)return;const t={workbook:e,worksheet:e.getActiveSheet()};this.fireEvent(this.Event.SheetRangeFilterCleared,t)}};F.extend(y);function K(r={}){const{enableSyncSwitch:e}=r;return{plugins:[[I,{enableSyncSwitch:e}],v].filter(t=>!!t)}}export{Ce as ChangeFilterByOperation,l as ClearSheetsFilterCriteriaCommand,ke as CloseFilterPanelOperation,C as CustomFilterOperator,Y as FILTER_MUTATIONS,Z as FilterBy,ee as FilterColumn,te as FilterModel,Ie as OpenFilterPanelOperation,re as ReCalcSheetsFilterCommand,ie as ReCalcSheetsFilterMutation,k as RemoveSheetFilterCommand,ne as RemoveSheetsFilterMutation,oe as SHEET_FILTER_SNAPSHOT_ID,_ as SetSheetFilterRangeCommand,o as SetSheetsFilterCriteriaCommand,se as SetSheetsFilterCriteriaMutation,ae as SetSheetsFilterRangeMutation,m as SheetsFilterService,le as SheetsFilterSyncController,he as SmartToggleSheetsFilterCommand,ve as UniverSheetsFilterMobileUIPlugin,I as UniverSheetsFilterPlugin,K as UniverSheetsFilterPreset,v as UniverSheetsFilterUIPlugin,fe as UniverSheetsFilterUIWorkerPlugin,de as equals,ge as getCustomFilterFn,ce as greaterThan,me as greaterThanOrEqualTo,ue as lessThan,Se as lessThanOrEqualTo,Fe as notEquals};
