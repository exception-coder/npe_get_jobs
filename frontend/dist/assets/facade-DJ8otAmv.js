import{v as re,w as y,L as m,a1 as I,W as He,cW as we,J as Ce,D as nt,_ as st,a9 as k,C as Ve,S as x,aj as rt,ct as H,Y as g,b7 as O,ai as K,dE as ie,dF as Se,dG as N,bh as Ie,dH as ve,cR as T,bk as j,b6 as A,al as M,I as l,u as P,an as ce,de as Le,F as Oe,P as $e,dI as it}from"./TeamSpreadsheet-DqPQXi__.js";import{I as ze,O as ot,a as at,ad as ge,$ as me}from"./facade-DLk4o3Z_.js";import{jU as $,lG as B,kz as oe,lU as fe,lR as ae,lx as be,lQ as Re,l8 as he,mm as de,j8 as ht,nN as dt,mi as ut,mh as lt,mf as ct,mj as gt,lD as mt,P as Ge,nF as z,lr as _e,je as _t,lT as kt,kJ as F,l2 as ue,me as Je,ko as wt,mq as Ct,kl as St,mp as D,j4 as It,jm as vt,ny as ft,nz as pe,V as bt,na as Rt,lW as pt,iY as Et,jk as yt,le as Ut,eK as ke,lN as xt,kX as Ee,li as ye,e4 as Pt,nk as V,jQ as Ue,kw as Nt,k5 as Tt,lm as xe,lt as Pe,lA as le,m9 as At,ll as Ne,m8 as Q,jD as Te,kq as Mt,k0 as jt,k_ as Ae,ls as Me,l1 as Dt,l5 as X,j9 as Wt,lw as Bt,lg as je,lP as Ft,ma as Ht,jb as qe,jc as Ye,jd as Ke,j5 as Vt,m4 as Lt,lJ as Ot,kS as $t,lv as b,lz as zt,S as W,lC as Gt,la as Jt,nc as Z,nv as De,kC as qt,eM as Yt,mk as Kt,lZ as Qt,jn as Xt,jM as Zt,jN as en,ji as tn,jh as nn,kt as sn,ka as rn,nE as on,n3 as Qe,kj as Xe,n2 as Ze,dg as et,mK as an,_ as hn,z as tt}from"./index--BQDx9CP.js";var dn=Object.defineProperty,un=(e,t,n)=>t in e?dn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,U=(e,t,n)=>un(e,typeof t!="symbol"?t+"":t,n),ln=(e,t,n,s)=>{for(var r=t,i=e.length-1,o;i>=0;i--)(o=e[i])&&(r=o(r)||r);return r},v=(e,t)=>(n,s)=>t(n,s,e);function cn(e,t,n){const s=n.getDefinedNameMap(e);if(s==null)return t.t("definedName.defaultName")+1;const r=Array.from(Object.values(s)).length+1,i=t.t("definedName.defaultName")+r;if(n.getValueByName(e,i)==null)return i;let o=r+1;for(;;){const a=t.t("definedName.defaultName")+o;if(n.getValueByName(e,a)==null)return a;o++}}class Y{constructor(){U(this,"_definedNameParam"),this._definedNameParam={id:Ve(10),unitId:"",name:"",formulaOrRefString:"",localSheetId:F}}setName(t){return this._definedNameParam.name=t,this}setFormula(t){return this._definedNameParam.formulaOrRefString=`=${t}`,this}setRef(t){return this._definedNameParam.formulaOrRefString=t,this}setRefByRange(t,n,s,r){return this._definedNameParam.formulaOrRefString=ke({startRow:t,endRow:t+(s??1)-1,startColumn:n,endColumn:n+(r??1)-1}),this}setComment(t){return this._definedNameParam.comment=t,this}setScopeToWorksheet(t){return this._definedNameParam.localSheetId=t.getSheetId(),this}setScopeToWorkbook(){return this._definedNameParam.localSheetId=F,this}setHidden(t){return this._definedNameParam.hidden=t,this}build(){return this._definedNameParam}load(t){return this._definedNameParam=t,this}}let G=class extends me{constructor(e,t,n,s,r,i,o,a,h,d){super(),this._definedNameParam=e,this._injector=t,this._commandService=n,this._permissionService=s,this._worksheetProtectionRuleModel=r,this._rangeProtectionRuleModel=i,this._worksheetProtectionPointRuleModel=o,this._authzIoService=a,this._localeService=h,this._definedNamesService=d}_apply(){this._definedNameParam.name===""&&(this._definedNameParam.name=cn(this._definedNameParam.unitId,this._localeService,this._definedNamesService)),this._commandService.syncExecuteCommand(ue.id,this._definedNameParam)}getName(){return this._definedNameParam.name}setName(e){this._definedNameParam.name=e,this._apply()}setFormula(e){this._definedNameParam.formulaOrRefString=`=${e}`,this._apply()}setRef(e){this._definedNameParam.formulaOrRefString=e,this._apply()}getFormulaOrRefString(){return this._definedNameParam.formulaOrRefString}setRefByRange(e,t,n,s){this._definedNameParam.formulaOrRefString=ke({startRow:e,endRow:e+(n??1)-1,startColumn:t,endColumn:t+(s??1)-1}),this._apply()}getComment(){return this._definedNameParam.comment}setComment(e){this._definedNameParam.comment=e,this._apply()}setScopeToWorksheet(e){this._definedNameParam.localSheetId=e.getSheetId(),this._apply()}setScopeToWorkbook(){this._definedNameParam.localSheetId=F,this._apply()}setHidden(e){this._definedNameParam.hidden=e,this._apply()}delete(){this._commandService.syncExecuteCommand(sn.id,this._definedNameParam)}getLocalSheetId(){return this._definedNameParam.localSheetId}isWorkbookScope(){return this._definedNameParam.localSheetId===F}toBuilder(){const e=this._injector.createInstance(Y);return e.load(this._definedNameParam),e}};G=ln([v(1,l(P)),v(2,m),v(3,ce),v(4,l(Qe)),v(5,l(Xe)),v(6,l(Ze)),v(7,l(Le)),v(8,l(Oe)),v(9,et)],G);var gn=(e,t,n,s)=>{for(var r=t,i=e.length-1,o;i>=0;i--)(o=e[i])&&(r=o(r)||r);return r},R=(e,t)=>(n,s)=>t(n,s,e);let J=class extends me{constructor(e,t,n,s,r,i,o,a){super(),U(this,"permissionPointsDefinition",rn),U(this,"rangeRuleChangedAfterAuth$"),U(this,"sheetRuleChangedAfterAuth$"),U(this,"unitPermissionInitStateChange$"),this._injector=e,this._commandService=t,this._permissionService=n,this._worksheetProtectionRuleModel=s,this._rangeProtectionRuleModel=r,this._worksheetProtectionPointRuleModel=i,this._workbookPermissionService=o,this._authzIoService=a,this.rangeRuleChangedAfterAuth$=this._rangeProtectionRuleModel.ruleRefresh$,this.sheetRuleChangedAfterAuth$=this._worksheetProtectionRuleModel.ruleRefresh$,this.unitPermissionInitStateChange$=this._workbookPermissionService.unitPermissionInitStateChange$}setWorkbookPermissionPoint(e,t,n){const s=new t(e);this._permissionService.getPermissionPoint(s.id)||this._permissionService.addPermissionPoint(s),this._permissionService.updatePermissionPoint(s.id,n)}checkWorkbookPermissionPoint(e,t){const n=new t(e),s=this._permissionService.getPermissionPoint(n.id);if(s)return s.value}setWorkbookEditPermission(e,t){this.setWorkbookPermissionPoint(e,Ge,t)}async addWorksheetBasePermission(e,t){if(this._rangeProtectionRuleModel.getSubunitRuleList(e,t).length>0)throw new Error("sheet protection cannot intersect with range protection");const n=await this._authzIoService.create({objectType:D.Worksheet,worksheetObject:{collaborators:[],unitID:e,strategies:[],name:"",scope:void 0}});if(this._commandService.syncExecuteCommand(It.id,{unitId:e,subUnitId:t,rule:{permissionId:n,unitType:D.Worksheet,unitId:e,subUnitId:t}}))return n}removeWorksheetPermission(e,t){this._commandService.syncExecuteCommand(vt.id,{unitId:e,subUnitId:t}),[...ft(),...pe()].forEach(n=>{const s=new n(e,t);this._permissionService.updatePermissionPoint(s.id,!0)}),this._worksheetProtectionPointRuleModel.deleteRule(e,t)}async setWorksheetPermissionPoint(e,t,n,s){const r=this._worksheetProtectionRuleModel.getRule(e,t);let i;if(n===bt||n===Rt)if(r)i=r.permissionId;else{if(this._rangeProtectionRuleModel.getSubunitRuleList(e,t).length>0)throw new Error("sheet protection cannot intersect with range protection");i=await this.addWorksheetBasePermission(e,t)}else{const a=this._worksheetProtectionPointRuleModel.getRule(e,t);a?i=a.permissionId:(i=await this._authzIoService.create({objectType:D.Worksheet,worksheetObject:{collaborators:[],unitID:e,strategies:[],name:"",scope:void 0}}),this._commandService.syncExecuteCommand(pt.id,{unitId:e,subUnitId:t,rule:{unitId:e,subUnitId:t,permissionId:i}}))}const o=new n(e,t);return this._permissionService.getPermissionPoint(o.id)||this._permissionService.addPermissionPoint(o),this._permissionService.updatePermissionPoint(o.id,s),i}checkWorksheetPermissionPoint(e,t,n){const s=new n(e,t),r=this._permissionService.getPermissionPoint(s.id);if(r)return r.value}async addRangeBaseProtection(e,t,n){const s=await this._authzIoService.create({objectType:D.SelectRange,selectRangeObject:{collaborators:[],unitID:e,name:"",scope:void 0}}),r=`ruleId_${Ve(6)}`;if(this._worksheetProtectionRuleModel.getRule(e,t))throw new Error("sheet protection cannot intersect with range protection");if(this._rangeProtectionRuleModel.getSubunitRuleList(e,t).some(i=>i.ranges.some(o=>n.some(a=>x.intersects(a.getRange(),o)))))throw new Error("range protection cannot intersect");if(this._commandService.syncExecuteCommand(Et.id,{unitId:e,subUnitId:t,rules:[{permissionId:s,unitType:D.SelectRange,unitId:e,subUnitId:t,ranges:n.map(i=>i.getRange()),id:r}]}))return{permissionId:s,ruleId:r}}removeRangeProtection(e,t,n){this._commandService.syncExecuteCommand(yt.id,{unitId:e,subUnitId:t,ruleIds:n})&&this._rangeProtectionRuleModel.getSubunitRuleList(e,t).length===0&&(this._worksheetProtectionPointRuleModel.deleteRule(e,t),[...pe()].forEach(s=>{const r=new s(e,t);this._permissionService.updatePermissionPoint(r.id,r.value)}))}setRangeProtectionPermissionPoint(e,t,n,s,r){const i=new s(e,t,n);this._permissionService.getPermissionPoint(i.id)||this._permissionService.addPermissionPoint(i),this._permissionService.updatePermissionPoint(i.id,r)}setRangeProtectionRanges(e,t,n,s){const r=this._rangeProtectionRuleModel.getRule(e,t,n);if(r){if(this._rangeProtectionRuleModel.getSubunitRuleList(e,t).filter(i=>i.id!==n).some(i=>i.ranges.some(o=>s.some(a=>x.intersects(a.getRange(),o)))))throw new Error("range protection cannot intersect");this._commandService.syncExecuteCommand(Ut.id,{unitId:e,subUnitId:t,ruleId:n,rule:{...r,ranges:s.map(i=>i.getRange())}})}}getPermissionInfoWithCell(e,t,n,s){const r=rt(n,s),i=this._rangeProtectionRuleModel.getSubunitRuleList(e,t).find(o=>o.ranges.some(a=>x.intersects(r,a)));if(i)return{permissionId:i.permissionId,ruleId:i.id}}};J=gn([R(0,l(P)),R(1,m),R(2,ce),R(3,l(Qe)),R(4,l(Xe)),R(5,l(Ze)),R(6,l(an)),R(7,l(Le))],J);function mn(e){switch(e){case"left":return A.LEFT;case"center":return A.CENTER;case"normal":return A.RIGHT;default:throw new Error(`Invalid horizontal alignment: ${e}`)}}function We(e){switch(e){case A.LEFT:return"left";case A.CENTER:return"center";case A.RIGHT:return"normal";default:return"general"}}function _n(e){switch(e){case"top":return M.TOP;case"middle":return M.MIDDLE;case"bottom":return M.BOTTOM;default:throw new Error(`Invalid vertical alignment: ${e}`)}}function Be(e){switch(e){case M.TOP:return"top";case M.MIDDLE:return"middle";case M.BOTTOM:return"bottom";default:return"general"}}function ee(e,t){return{startRow:e.startRow,endRow:e.endRow,startColumn:0,endColumn:t.getColumnCount()-1,rangeType:k.ROW}}function te(e,t){return{startRow:0,endRow:t.getRowCount()-1,startColumn:e.startColumn,endColumn:e.endColumn,rangeType:k.COLUMN}}var kn=(e,t,n,s)=>{for(var r=t,i=e.length-1,o;i>=0;i--)(o=e[i])&&(r=o(r)||r);return r},ne=(e,t)=>(n,s)=>t(n,s,e),se;let _=(se=class extends ge{constructor(e,t,n,s,r,i){super(s),this._workbook=e,this._worksheet=t,this._range=n,this._injector=s,this._commandService=r,this._formulaDataModel=i,this._runInitializers(this._injector,this._workbook,this._worksheet,this._range,this._commandService,this._formulaDataModel)}getUnitId(){return this._workbook.getUnitId()}getSheetName(){return this._worksheet.getName()}getSheetId(){return this._worksheet.getSheetId()}getRange(){return this._range}getRow(){return this._range.startRow}getLastRow(){return this._range.endRow}getColumn(){return this._range.startColumn}getLastColumn(){return this._range.endColumn}getWidth(){return this._range.endColumn-this._range.startColumn+1}getHeight(){return this._range.endRow-this._range.startRow+1}isMerged(){const{startColumn:e,startRow:t,endColumn:n,endRow:s}=this._range;return this._worksheet.getMergedCellRange(t,e,s,n).some(r=>x.equals(r,this._range))}getCellStyleData(e="row"){return e!=="cell"?this._worksheet.getComposedCellStyle(this._range.startRow,this._range.startColumn,e==="row"):this._worksheet.getCellStyle(this._range.startRow,this._range.startColumn)}getFontFamily(e="row"){var t,n;return(n=(t=this.getCellStyleData(e))==null?void 0:t.ff)!=null?n:null}getFontSize(e="row"){var t,n;return(n=(t=this.getCellStyleData(e))==null?void 0:t.fs)!=null?n:null}getCellStyle(e="row"){const t=this.getCellStyleData(e);return t?Se.create(t):null}getCellStyles(e="row"){return this.getCellDatas().map((t,n)=>t.map((s,r)=>{if(!s)return null;const i=e!=="cell"?this._worksheet.getComposedCellStyle(n+this._range.startRow,r+this._range.startColumn,e==="row"):this._worksheet.getCellStyle(n+this._range.startRow,r+this._range.startColumn);return i?Se.create(i):null}))}getValue(e){var t,n;return e?this.getValueAndRichTextValue():(n=(t=this._worksheet.getCell(this._range.startRow,this._range.startColumn))==null?void 0:t.v)!=null?n:null}getRawValue(){var e,t;const n=this._worksheet.getCellMatrix().getValue(this._range.startRow,this._range.startColumn);return n!=null&&n.p&&(e=n.p.body)!=null&&e.dataStream?n.p.body.dataStream:(t=n==null?void 0:n.v)!=null?t:null}getDisplayValue(){var e,t,n;const s=this._worksheet.getCell(this._range.startRow,this._range.startColumn);return s!=null&&s.p&&(e=s.p.body)!=null&&e.dataStream?s.p.body.dataStream:(n=(t=s==null?void 0:s.v)==null?void 0:t.toString())!=null?n:""}getValues(e){var t,n;if(e)return this.getValueAndRichTextValues();const{startRow:s,endRow:r,startColumn:i,endColumn:o}=this._range,a=[];for(let h=s;h<=r;h++){const d=[];for(let u=i;u<=o;u++)d.push((n=(t=this._worksheet.getCell(h,u))==null?void 0:t.v)!=null?n:null);a.push(d)}return a}getRawValues(){var e,t;const n=this._worksheet.getCellMatrix(),{startRow:s,endRow:r,startColumn:i,endColumn:o}=this._range,a=[];for(let h=s;h<=r;h++){const d=[];for(let u=i;u<=o;u++){const c=n.getValue(h,u);c!=null&&c.p&&(e=c.p.body)!=null&&e.dataStream?d.push(c.p.body.dataStream):d.push((t=c==null?void 0:c.v)!=null?t:null)}a.push(d)}return a}getDisplayValues(){var e,t,n;const{startRow:s,endRow:r,startColumn:i,endColumn:o}=this._range,a=[];for(let h=s;h<=r;h++){const d=[];for(let u=i;u<=o;u++){const c=this._worksheet.getCell(h,u);c!=null&&c.p&&(e=c.p.body)!=null&&e.dataStream?d.push(c.p.body.dataStream):d.push((n=(t=c==null?void 0:c.v)==null?void 0:t.toString())!=null?n:"")}a.push(d)}return a}getCellData(){var e;return(e=this._worksheet.getCell(this._range.startRow,this._range.startColumn))!=null?e:null}getCellDatas(){return this.getCellDataGrid()}getCellDataGrid(){const{startRow:e,endRow:t,startColumn:n,endColumn:s}=this._range,r=[];for(let i=e;i<=t;i++){const o=[];for(let a=n;a<=s;a++)o.push(this._worksheet.getCellRaw(i,a));r.push(o)}return r}getRichTextValue(){const e=this.getCellData();return e!=null&&e.p?new N(e.p):null}getRichTextValues(){return this.getCellDataGrid().map(e=>e.map(t=>t!=null&&t.p?new N(t.p):null))}getValueAndRichTextValue(){const e=this.getCellData();return e!=null&&e.p?new N(e.p):e==null?void 0:e.v}getValueAndRichTextValues(){return this.getCellDatas().map(e=>e.map(t=>t!=null&&t.p?new N(t.p):t==null?void 0:t.v))}getFormula(){var e;return(e=this._formulaDataModel.getFormulaStringByCell(this._range.startRow,this._range.startColumn,this._worksheet.getSheetId(),this._workbook.getUnitId()))!=null?e:""}getFormulas(){const e=[],{startRow:t,endRow:n,startColumn:s,endColumn:r}=this._range,i=this._worksheet.getSheetId(),o=this._workbook.getUnitId();for(let a=t;a<=n;a++){const h=[];for(let d=s;d<=r;d++){const u=this._formulaDataModel.getFormulaStringByCell(a,d,i,o);h.push(u||"")}e.push(h)}return e}getWrap(){return this._worksheet.getRange(this._range).getWrap()===g.TRUE}getWraps(){const e=this.getCellDatas(),t=this._workbook.getStyles();return e.map(n=>n.map(s=>{var r;return((r=t.getStyleByCell(s))==null?void 0:r.tb)===O.WRAP}))}getWrapStrategy(){return this._worksheet.getRange(this._range).getWrapStrategy()}getHorizontalAlignment(){const e=this._worksheet.getRange(this._range).getHorizontalAlignment();return We(e)}getHorizontalAlignments(){return this._worksheet.getRange(this._range).getHorizontalAlignments().map(e=>e.map(t=>We(t)))}getVerticalAlignment(){return Be(this._worksheet.getRange(this._range).getVerticalAlignment())}getVerticalAlignments(){return this._worksheet.getRange(this._range).getVerticalAlignments().map(e=>e.map(t=>Be(t)))}setCustomMetaData(e){return this.setValue({custom:e})}setCustomMetaDatas(e){return this.setValues(e.map(t=>t.map(n=>({custom:n}))))}getCustomMetaData(){var e;const t=this.getCellData();return(e=t==null?void 0:t.custom)!=null?e:null}getCustomMetaDatas(){return this.getCellDataGrid().map(e=>e.map(t=>{var n;return(n=t==null?void 0:t.custom)!=null?n:null}))}setBorder(e,t,n){return this._commandService.syncExecuteCommand($t.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),ranges:[this._range],value:{type:e,style:t,color:n}}),this}getBackground(){var e,t;const n=this.getCellStyle();return(t=(e=n==null?void 0:n.background)==null?void 0:e.rgb)!=null?t:Ie.bg.rgb}getBackgrounds(){return this.getCellStyles().map(e=>e.map(t=>{var n,s;return(s=(n=t==null?void 0:t.background)==null?void 0:n.rgb)!=null?s:Ie.bg.rgb}))}setBackgroundColor(e){return this._commandService.syncExecuteCommand(b.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),range:this._range,style:{type:"bg",value:{rgb:e}}}),this}setBackground(e){return this.setBackgroundColor(e),this}setTextRotation(e){return this._commandService.syncExecuteCommand(zt.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),range:this._range,value:e}),this}setValue(e){const t=ie(e);if(!t)throw new Error("Invalid value");return this._commandService.syncExecuteCommand(W.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),range:this._range,value:t}),this}setValueForCell(e){const t=ie(e);if(!t)throw new Error("Invalid value");return this._commandService.syncExecuteCommand(W.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),range:{startColumn:this._range.startColumn,startRow:this._range.startRow,endColumn:this._range.startColumn,endRow:this._range.startRow},value:t}),this}setRichTextValueForCell(e){const t=e instanceof N?e.getData():e,n={unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),range:{startColumn:this._range.startColumn,startRow:this._range.startRow,endColumn:this._range.startColumn,endRow:this._range.startRow},value:{p:t}};return this._commandService.syncExecuteCommand(W.id,n),this}setRichTextValues(e){const t=e.map(r=>r.map(i=>i&&{p:i instanceof N?i.getData():i})),n=ve(t,this._range),s={unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),range:this._range,value:n};return this._commandService.syncExecuteCommand(W.id,s),this}setWrap(e){return this._commandService.syncExecuteCommand(le.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),range:this._range,value:e?O.WRAP:O.UNSPECIFIED}),this}setWrapStrategy(e){return this._commandService.syncExecuteCommand(le.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),range:this._range,value:e}),this}setVerticalAlignment(e){return this._commandService.syncExecuteCommand(Gt.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),range:this._range,value:_n(e)}),this}setHorizontalAlignment(e){return this._commandService.syncExecuteCommand(Jt.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),range:this._range,value:mn(e)}),this}setValues(e){const t=ve(e,this._range);return this._commandService.syncExecuteCommand(W.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),range:this._range,value:t}),this}setFontWeight(e){let t;if(e==="bold")t=g.TRUE;else if(e==="normal")t=g.FALSE;else if(e===null)t=null;else throw new Error("Invalid fontWeight");const n={type:"bl",value:t},s={unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),range:this._range,style:n};return this._commandService.syncExecuteCommand(b.id,s),this}setFontStyle(e){let t;if(e==="italic")t=g.TRUE;else if(e==="normal")t=g.FALSE;else if(e===null)t=null;else throw new Error("Invalid fontStyle");const n={type:"it",value:t},s={unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),range:this._range,style:n};return this._commandService.syncExecuteCommand(b.id,s),this}setFontLine(e){if(e==="underline")this._setFontUnderline({s:g.TRUE});else if(e==="line-through")this._setFontStrikethrough({s:g.TRUE});else if(e==="none")this._setFontUnderline({s:g.FALSE}),this._setFontStrikethrough({s:g.FALSE});else if(e===null)this._setFontUnderline(null),this._setFontStrikethrough(null);else throw new Error("Invalid fontLine");return this}_setFontUnderline(e){const t={type:"ul",value:e},n={unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),range:this._range,style:t};this._commandService.syncExecuteCommand(b.id,n)}_setFontStrikethrough(e){const t={type:"st",value:e},n={unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),range:this._range,style:t};this._commandService.syncExecuteCommand(b.id,n)}setFontFamily(e){const t={type:"ff",value:e},n={unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),range:this._range,style:t};return this._commandService.syncExecuteCommand(b.id,n),this}setFontSize(e){const t={type:"fs",value:e},n={unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),range:this._range,style:t};return this._commandService.syncExecuteCommand(b.id,n),this}setFontColor(e){const t={type:"cl",value:e===null?null:{rgb:e}},n={unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),range:this._range,style:t};return this._commandService.syncExecuteCommand(b.id,n),this}merge(e=!0){const t=this._workbook.getUnitId(),n=this._worksheet.getSheetId();return Z(this._injector,t,n,[this._range],e),this}mergeAcross(e=!0){const t=De([this._range],T.ROWS),n=this._workbook.getUnitId(),s=this._worksheet.getSheetId();return Z(this._injector,n,s,t,e),this}mergeVertically(e=!0){const t=De([this._range],T.COLUMNS),n=this._workbook.getUnitId(),s=this._worksheet.getSheetId();return Z(this._injector,n,s,t,e),this}isPartOfMerge(){const{startRow:e,startColumn:t,endRow:n,endColumn:s}=this._range;return this._worksheet.getMergedCellRange(e,t,n,s).length>0}breakApart(){return this._commandService.syncExecuteCommand(qt.id,{ranges:[this._range]}),this}forEach(e){const{startColumn:t,startRow:n,endColumn:s,endRow:r}=this._range;this._worksheet.getMatrixWithMergedCells(n,t,r,s).forValue((i,o,a)=>{e(i,o,a)})}getA1Notation(e,t,n){const s={...this._range,startAbsoluteRefType:t,endAbsoluteRefType:n};return e?Yt(this._worksheet.getName(),s):ke(s)}activate(){return this._injector.createInstance(C,this._workbook).setActiveRange(this),this}activateAsCurrentCell(){const e=this._worksheet.getMergedCell(this._range.startRow,this._range.startColumn);if(e&&x.equals(e,this._range)||!e&&this._range.startRow===this._range.endRow&&this._range.startColumn===this._range.endColumn){const t=this._injector.createInstance(C,this._workbook).getActiveRange();if(!t||t.getUnitId()!==this.getUnitId()||t.getSheetId()!==this.getSheetId())return this.activate();if(x.contains(t.getRange(),this._range)){const n={unitId:this.getUnitId(),subUnitId:this.getSheetId(),selections:[{range:t.getRange(),primary:z(this.getRange(),this._worksheet),style:null}]};return this._commandService.syncExecuteCommand(_e.id,n),this}return this.activate()}else throw new Error("The range is not a single cell")}splitTextToColumns(e,t,n){this._commandService.syncExecuteCommand(Kt.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),range:this._range,delimiter:t,customDelimiter:n,treatMultipleDelimitersAsOne:e})}useThemeStyle(e){if(e==null){const t=this.getUsedThemeStyle();t&&this.removeThemeStyle(t)}else this._commandService.syncExecuteCommand(Qt.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),range:this._range,themeName:e})}removeThemeStyle(e){this._commandService.syncExecuteCommand(Xt.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),range:this._range,themeName:e})}getUsedThemeStyle(){return this._injector.get(Je).getAppliedRangeThemeStyle({unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),range:this._range})}clear(e){return e&&e.contentsOnly&&!e.formatOnly?this.clearContent():e&&e.formatOnly&&!e.contentsOnly?this.clearFormat():(this._commandService.syncExecuteCommand(qe.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),ranges:[this._range],options:e}),this)}clearContent(){return this._commandService.syncExecuteCommand(Ye.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),ranges:[this._range]}),this}clearFormat(){return this._commandService.syncExecuteCommand(Ke.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),ranges:[this._range]}),this}insertCells(e){e===T.ROWS?this._commandService.executeCommand(Zt.id,{range:this._range}):this._commandService.executeCommand(en.id,{range:this._range})}deleteCells(e){e===T.ROWS?this._commandService.executeCommand(tn.id,{range:this._range}):this._commandService.executeCommand(nn.id,{range:this._range})}getDataRegion(e){const{startRow:t,startColumn:n,endRow:s,endColumn:r}=this._range,i=this._worksheet.getMaxRows(),o=this._worksheet.getMaxColumns(),a=this._worksheet.getCellMatrix();let h=t,d=n,u=s,c=r;if(e!==T.COLUMNS){let p=!1,E=!1;for(let S=n;S<=r&&(t>0&&!j(a.getValue(t-1,S))&&(p=!0),s<i-1&&!j(a.getValue(s+1,S))&&(E=!0),!(p&&E));S++);p&&(h=t-1),E&&(u=s+1)}if(e!==T.ROWS){let p=!1,E=!1;for(let S=t;S<=s&&(n>0&&!j(a.getValue(S,n-1))&&(p=!0),r<o-1&&!j(a.getValue(S,r+1))&&(E=!0),!(p&&E));S++);p&&(d=n-1),E&&(c=r+1)}return this._injector.createInstance(_,this._workbook,this._worksheet,{startRow:h,startColumn:d,endRow:u,endColumn:c})}isBlank(){const e=this._worksheet.getCellMatrix(),{startRow:t,startColumn:n,endRow:s,endColumn:r}=this._range;let i=!0;for(let o=t;o<=s;o++){for(let a=n;a<=r;a++)if(!j(e.getValue(o,a))){i=!1;break}if(!i)break}return i}offset(e,t,n,s){const{startRow:r,startColumn:i,endRow:o,endColumn:a}=this._range,h=r+e,d=i+t,u=n?h+n-1:o+e,c=s?d+s-1:a+t;if(h<0||d<0||u<0||c<0)throw new Error("The row or column index is out of range");return this._injector.createInstance(_,this._workbook,this._worksheet,{startRow:h,startColumn:d,endRow:u,endColumn:c})}setFormula(e){return this.setValue({f:e})}setFormulas(e){return this.setValues(e.map(t=>t.map(n=>({f:n}))))}},se._enableManualInit(),se);_=kn([ne(3,l(P)),ne(4,m),ne(5,l(hn))],_);var wn=(e,t,n,s)=>{for(var r=t,i=e.length-1,o;i>=0;i--)(o=e[i])&&(r=o(r)||r);return r},Cn=(e,t)=>(n,s)=>t(n,s,e);let q=class{constructor(e,t,n,s){this._workbook=e,this._worksheet=t,this._selections=n,this._injector=s}getActiveRange(){const e=this._selections.find(t=>!!t.primary);return e?this._injector.createInstance(_,this._workbook,this._worksheet,e.range):null}getActiveRangeList(){return this._selections.map(e=>this._injector.createInstance(_,this._workbook,this._worksheet,e.range))}getCurrentCell(){const e=this._selections.find(t=>!!t.primary);return e?e.primary:null}getActiveSheet(){const e=this._injector.createInstance(C,this._workbook);return this._injector.createInstance(w,e,this._workbook,this._worksheet)}updatePrimaryCell(e){const t=this._injector.get(m);let n=[],s=!1;for(const{range:i,style:o}of this._selections)x.contains(i,e.getRange())?(n.push({range:i,primary:z(e.getRange(),this._worksheet),style:o}),s=!0):n.push({range:i,primary:null,style:o});s||(n=[{range:e.getRange(),primary:z(e.getRange(),this._worksheet)}]);const r={unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),selections:n};return t.syncExecuteCommand(_e.id,r),new q(this._workbook,this._worksheet,n,this._injector)}getNextDataRange(e){if(!this._selections.find(n=>!!n.primary))return null;const t=on(this._selections.concat(),e,this._worksheet);return t?this._injector.createInstance(_,this._workbook,this._worksheet,t):null}};q=wn([Cn(3,l(P))],q);var Sn=(e,t,n,s)=>{for(var r=t,i=e.length-1,o;i>=0;i--)(o=e[i])&&(r=o(r)||r);return r},L=(e,t)=>(n,s)=>t(n,s,e);let w=class extends ge{constructor(e,t,n,s,r,i,o){super(s),U(this,"setActiveSelection",this.setActiveRange),this._fWorkbook=e,this._workbook=t,this._worksheet=n,this._injector=s,this._selectionManagerService=r,this._logService=i,this._commandService=o}dispose(){super.dispose(),delete this._fWorkbook,delete this._workbook,delete this._worksheet}getSheet(){return this._worksheet}getInject(){return this._injector}getWorkbook(){return this._workbook}getSheetId(){return this._worksheet.getSheetId()}getSheetName(){return this._worksheet.getName()}getSelection(){const e=this._selectionManagerService.getCurrentSelections();return e?this._injector.createInstance(q,this._workbook,this._worksheet,e):null}getDefaultStyle(){return this._worksheet.getDefaultCellStyle()}getRowDefaultStyle(e,t=!1){return t?this._worksheet.getRowStyle(e,t):this._worksheet.getRowStyle(e)}getColumnDefaultStyle(e,t=!1){return t?this._worksheet.getColumnStyle(e,t):this._worksheet.getColumnStyle(e)}setDefaultStyle(e){const t=this._workbook.getUnitId(),n=this._worksheet.getSheetId();return this._commandService.syncExecuteCommand(xt.id,{unitId:t,subUnitId:n,defaultStyle:e}),this._worksheet.setDefaultCellStyle(e),this}setColumnDefaultStyle(e,t){const n=this._workbook.getUnitId(),s=this._worksheet.getSheetId(),r={unitId:n,subUnitId:s,columnData:{[e]:{s:t}}};return this._commandService.syncExecuteCommand(Ee.id,r),this}setRowDefaultStyle(e,t){const n=this._workbook.getUnitId(),s=this._worksheet.getSheetId(),r={unitId:n,subUnitId:s,rowData:{[e]:{s:t}}};return this._commandService.syncExecuteCommand(ye.id,r),this}getRange(e,t,n,s){let r,i;if(typeof e=="object")r=e,i=this._worksheet;else if(typeof e=="string"){const{range:o,sheetName:a}=Pt(e),h=a?this._workbook.getSheetBySheetName(a):this._worksheet;if(!h)throw new Error("Range not found");i=h,r={...o,unitId:this._workbook.getUnitId(),sheetId:i.getSheetId(),rangeType:k.NORMAL,startRow:o.rangeType===k.COLUMN?0:o.startRow,endRow:o.rangeType===k.COLUMN?i.getMaxRows()-1:o.endRow,startColumn:o.rangeType===k.ROW?0:o.startColumn,endColumn:o.rangeType===k.ROW?i.getMaxColumns()-1:o.endColumn}}else if(typeof e=="number"&&t!==void 0)i=this._worksheet,r={startRow:e,endRow:e+(n??1)-1,startColumn:t,endColumn:t+(s??1)-1,unitId:this._workbook.getUnitId(),sheetId:this._worksheet.getSheetId()};else throw new Error("Invalid range specification");return this._injector.createInstance(_,this._workbook,i,r)}getMaxColumns(){return this._worksheet.getMaxColumns()}getMaxRows(){return this._worksheet.getMaxRows()}insertRowAfter(e){return this.insertRowsAfter(e,1)}insertRowBefore(e){return this.insertRowsBefore(e,1)}insertRows(e,t=1){return this.insertRowsBefore(e,t)}insertRowsAfter(e,t){const n=this._workbook.getUnitId(),s=this._worksheet.getSheetId(),r=H.DOWN,i=e+1,o=e+t,a=0,h=this._worksheet.getColumnCount()-1,d=V(this._worksheet,i,o,a,h,!0,e);return this._commandService.syncExecuteCommand(Ue.id,{unitId:n,subUnitId:s,direction:r,range:{startRow:i,endRow:o,startColumn:a,endColumn:h},cellValue:d}),this}insertRowsBefore(e,t){const n=this._workbook.getUnitId(),s=this._worksheet.getSheetId(),r=H.UP,i=e,o=e+t-1,a=0,h=this._worksheet.getColumnCount()-1,d=V(this._worksheet,i,o,a,h,!0,e-1);return this._commandService.syncExecuteCommand(Ue.id,{unitId:n,subUnitId:s,direction:r,range:{startRow:i,endRow:o,startColumn:a,endColumn:h},cellValue:d}),this}deleteRow(e){return this.deleteRows(e,1)}deleteRows(e,t){const n={startRow:e,endRow:e+t-1,startColumn:0,endColumn:this._worksheet.getColumnCount()-1};return this._commandService.syncExecuteCommand(Nt.id,{range:n,unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId()}),this}moveRows(e,t){const n=this._workbook.getUnitId(),s=this._worksheet.getSheetId(),r=ee(e.getRange(),this._worksheet),i=r,o={startRow:t,endRow:t,startColumn:r.startColumn,endColumn:r.endColumn};return this._commandService.syncExecuteCommand(Tt.id,{unitId:n,subUnitId:s,range:r,fromRange:i,toRange:o}),this}hideRow(e){const t=this._workbook.getUnitId(),n=this._worksheet.getSheetId(),s=ee(e.getRange(),this._worksheet);return this._commandService.syncExecuteCommand(xe.id,{unitId:t,subUnitId:n,ranges:[s]}),this}hideRows(e,t=1){const n=this._workbook.getUnitId(),s=this._worksheet.getSheetId(),r={startRow:e,endRow:e+t-1,startColumn:0,endColumn:this._worksheet.getColumnCount()-1,rangeType:k.ROW};return this._commandService.syncExecuteCommand(xe.id,{unitId:n,subUnitId:s,ranges:[r]}),this}unhideRow(e){const t=this._workbook.getUnitId(),n=this._worksheet.getSheetId(),s=ee(e.getRange(),this._worksheet);return this._commandService.syncExecuteCommand(Pe.id,{unitId:t,subUnitId:n,ranges:[s]}),this}showRows(e,t=1){const n=this._workbook.getUnitId(),s=this._worksheet.getSheetId(),r={startRow:e,endRow:e+t-1,startColumn:0,endColumn:this._worksheet.getColumnCount()-1,rangeType:k.ROW};return this._commandService.syncExecuteCommand(Pe.id,{unitId:n,subUnitId:s,ranges:[r]}),this}setRowHeight(e,t){return this.setRowHeights(e,1,t)}autoFitRow(e,t=g.TRUE){const n=this._workbook.getUnitId(),s=this._worksheet.getSheetId(),r=[{startRow:e,endRow:e,startColumn:0,endColumn:this._worksheet.getColumnCount()-1}];return this._commandService.syncExecuteCommand(le.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),range:r[0],value:O.WRAP}),this._commandService.syncExecuteCommand(At.id,{unitId:n,subUnitId:s,ranges:r,autoHeightInfo:t}),this}setRowHeights(e,t,n){var s;const r=this._workbook.getUnitId(),i=this._worksheet.getSheetId(),o=this._worksheet.getRowManager(),a=[],h=[];for(let d=e;d<e+t;d++){const u=((s=o.getRow(d))==null?void 0:s.ah)||this._worksheet.getConfig().defaultRowHeight,c={startRow:d,endRow:d,startColumn:0,endColumn:this._worksheet.getColumnCount()-1};n<=u?a.push(c):h.push(c)}return h.length>0&&this._commandService.syncExecuteCommand(Ne.id,{unitId:r,subUnitId:i,ranges:h,value:n}),a.length>0&&this._commandService.syncExecuteCommand(Q.id,{unitId:r,subUnitId:i,ranges:a}),this}getRowHeight(e){return this._worksheet.getRowHeight(e)}setRowAutoHeight(e,t){const n=this._workbook.getUnitId(),s=this._worksheet.getSheetId(),r=[{startRow:e,endRow:e+t-1,startColumn:0,endColumn:this._worksheet.getColumnCount()-1}];return this._commandService.syncExecuteCommand(Q.id,{unitId:n,subUnitId:s,ranges:r}),this}setRangesAutoHeight(e){const t=this._workbook.getUnitId(),n=this._worksheet.getSheetId();return this._commandService.syncExecuteCommand(Q.id,{unitId:t,subUnitId:n,ranges:e}),this}setRowHeightsForced(e,t,n){const s=this._workbook.getUnitId(),r=this._worksheet.getSheetId(),i=[{startRow:e,endRow:e+t-1,startColumn:0,endColumn:this._worksheet.getColumnCount()-1}];return this._commandService.syncExecuteCommand(Ne.id,{unitId:s,subUnitId:r,ranges:i,value:n}),this}setRowCustom(e){const t=this._workbook.getUnitId(),n=this._worksheet.getSheetId(),s={};for(const[i,o]of Object.entries(e))s[Number(i)]={custom:o};const r={unitId:t,subUnitId:n,rowData:s};return this._commandService.syncExecuteCommand(ye.id,r),this}insertColumnAfter(e){return this.insertColumnsAfter(e,1)}insertColumnBefore(e){return this.insertColumnsBefore(e,1)}insertColumns(e,t=1){return this.insertColumnsBefore(e,t)}insertColumnsAfter(e,t){const n=this._workbook.getUnitId(),s=this._worksheet.getSheetId(),r=H.RIGHT,i=0,o=this._worksheet.getRowCount()-1,a=e+1,h=e+t,d=V(this._worksheet,i,o,a,h,!1,e);return this._commandService.syncExecuteCommand(Te.id,{unitId:n,subUnitId:s,direction:r,range:{startRow:i,endRow:o,startColumn:a,endColumn:h},cellValue:d}),this}insertColumnsBefore(e,t){const n=this._workbook.getUnitId(),s=this._worksheet.getSheetId(),r=H.LEFT,i=0,o=this._worksheet.getRowCount()-1,a=e,h=e+t-1,d=V(this._worksheet,i,o,a,h,!1,e-1);return this._commandService.syncExecuteCommand(Te.id,{unitId:n,subUnitId:s,direction:r,range:{startRow:i,endRow:o,startColumn:a,endColumn:h},cellValue:d}),this}deleteColumn(e){return this.deleteColumns(e,1)}deleteColumns(e,t){const n={startRow:0,endRow:this._worksheet.getRowCount()-1,startColumn:e,endColumn:e+t-1};return this._commandService.syncExecuteCommand(Mt.id,{range:n,unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId()}),this}moveColumns(e,t){const n=this._workbook.getUnitId(),s=this._worksheet.getSheetId(),r=te(e.getRange(),this._worksheet),i=r,o={startRow:0,endRow:this._worksheet.getRowCount()-1,startColumn:t,endColumn:t};return this._commandService.syncExecuteCommand(jt.id,{unitId:n,subUnitId:s,range:r,fromRange:i,toRange:o}),this}hideColumn(e){const t=this._workbook.getUnitId(),n=this._worksheet.getSheetId(),s=te(e.getRange(),this._worksheet);return this._commandService.syncExecuteCommand(Ae.id,{unitId:t,subUnitId:n,ranges:[s]}),this}hideColumns(e,t=1){const n=this._workbook.getUnitId(),s=this._worksheet.getSheetId(),r={startRow:0,endRow:this._worksheet.getRowCount()-1,startColumn:e,endColumn:e+t-1,rangeType:k.COLUMN};return this._commandService.syncExecuteCommand(Ae.id,{unitId:n,subUnitId:s,ranges:[r]}),this}unhideColumn(e){const t=this._workbook.getUnitId(),n=this._worksheet.getSheetId(),s=te(e.getRange(),this._worksheet);return this._commandService.syncExecuteCommand(Me.id,{unitId:t,subUnitId:n,ranges:[s]}),this}showColumns(e,t=1){const n=this._workbook.getUnitId(),s=this._worksheet.getSheetId(),r={startRow:0,endRow:this._worksheet.getRowCount()-1,startColumn:e,endColumn:e+t-1,rangeType:k.COLUMN};return this._commandService.syncExecuteCommand(Me.id,{unitId:n,subUnitId:s,ranges:[r]}),this}setColumnWidth(e,t){return this.setColumnWidths(e,1,t)}setColumnWidths(e,t,n){const s=this._workbook.getUnitId(),r=this._worksheet.getSheetId(),i=[{startColumn:e,endColumn:e+t-1,startRow:0,endRow:this._worksheet.getRowCount()-1}];return this._commandService.syncExecuteCommand(Dt.id,{unitId:s,subUnitId:r,ranges:i,value:n}),this}getColumnWidth(e){return this._worksheet.getColumnWidth(e)}setColumnCustom(e){const t=this._workbook.getUnitId(),n=this._worksheet.getSheetId(),s={};for(const[i,o]of Object.entries(e))s[Number(i)]={custom:o};const r={unitId:t,subUnitId:n,columnData:s};return this._commandService.syncExecuteCommand(Ee.id,r),this}getMergeData(){return this._worksheet.getMergeData().map(e=>this._injector.createInstance(_,this._workbook,this._worksheet,e))}getMergedRanges(){return this._worksheet.getSnapshot().mergeData.map(e=>this._injector.createInstance(_,this._workbook,this._worksheet,e))}getCellMergeData(e,t){const n=this._worksheet.getMergedCell(e,t);if(n)return this._injector.createInstance(_,this._workbook,this._worksheet,n)}getActiveRange(){return this._fWorkbook.getActiveRange()}setActiveRange(e){const{unitId:t,sheetId:n}=e.getRange();if(t!==this._workbook.getUnitId()||n!==this._worksheet.getSheetId())throw new Error("Specified range must be part of the sheet.");return this._fWorkbook.setActiveRange(e),this}getActiveCell(){return this._fWorkbook.getActiveCell()}setFreeze(e){return this._logService.warn("setFreeze is deprecated, use setFrozenRows and setFrozenColumns instead"),this._commandService.syncExecuteCommand(X.id,{...e,unitId:this._workbook.getUnitId(),subUnitId:this.getSheetId()}),this}cancelFreeze(){return this._commandService.syncExecuteCommand(Wt.id,{unitId:this._workbook.getUnitId(),subUnitId:this.getSheetId()}),this}getFreeze(){return this._worksheet.getFreeze()}setFrozenColumns(...e){const t=this.getFreeze();if(arguments.length===1){const n=e[0];this.setFreeze({...t,startColumn:n>0?n:-1,xSplit:n})}else if(arguments.length===2){let[n=0,s=0]=e;n>s&&([n,s]=[s,n]),this._commandService.syncExecuteCommand(X.id,{startColumn:s+1,xSplit:s-n+1,startRow:t.startRow,ySplit:t.ySplit,unitId:this._workbook.getUnitId(),subUnitId:this.getSheetId()})}return this}setFrozenRows(...e){const t=this.getFreeze();if(arguments.length===1){const n=e[0];this.setFreeze({...t,startRow:n>0?n:-1,ySplit:n})}else if(arguments.length===2){let[n=0,s=0]=e;n>s&&([n,s]=[s,n]),this._commandService.syncExecuteCommand(X.id,{startRow:s+1,ySplit:s-n+1,startColumn:t.startColumn,xSplit:t.xSplit,unitId:this._workbook.getUnitId(),subUnitId:this.getSheetId()})}return this}getFrozenColumns(){const e=this.getFreeze();return e.startColumn===-1?0:e.startColumn}getFrozenRows(){const e=this.getFreeze();return e.startRow===-1?0:e.startRow}getFrozenRowRange(){const e=this._worksheet.getFreeze();return{startRow:e.startRow-e.ySplit,endRow:e.startRow-1}}getFrozenColumnRange(){const e=this._worksheet.getFreeze();return{startColumn:e.startColumn-e.xSplit,endColumn:e.startColumn-1}}hasHiddenGridLines(){return this._worksheet.getConfig().showGridlines===g.FALSE}setHiddenGridlines(e){return this._commandService.syncExecuteCommand(de.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),showGridlines:e?g.FALSE:g.TRUE}),this}setGridLinesColor(e){return this._commandService.syncExecuteCommand(he.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),color:e}),this}getGridLinesColor(){return this._worksheet.getGridlinesColor()}setTabColor(e){return this._commandService.syncExecuteCommand(Bt.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),value:e}),this}getTabColor(){return this._worksheet.getTabColor()}onCellDataChange(e){return this._injector.get(m).onCommandExecuted(t=>{if(t.id===je.id){const n=t.params;n.unitId===this._workbook.getUnitId()&&n.subUnitId===this._worksheet.getSheetId()&&n.cellValue&&e(new K(n.cellValue))}})}onBeforeCellDataChange(e){return this._injector.get(m).beforeCommandExecuted(t=>{if(t.id===je.id){const n=t.params;n.unitId===this._workbook.getUnitId()&&n.subUnitId===this._worksheet.getSheetId()&&n.cellValue&&e(new K(n.cellValue))}})}hideSheet(){const e=this._injector.get(m);if(this._workbook.getSheets().filter(t=>t.isSheetHidden()!==g.TRUE).length<=1)throw new Error("Cannot hide the only visible sheet");return e.syncExecuteCommand(Ft.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId()}),this}showSheet(){return this._injector.get(m).syncExecuteCommand(Ht.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId()}),this}isSheetHidden(){return this._worksheet.isSheetHidden()===g.TRUE}setName(e){return this._commandService.syncExecuteCommand(ae.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),name:e}),this}activate(){return this._fWorkbook.setActiveSheet(this),this}getIndex(){return this._workbook.getSheetIndex(this._worksheet)}clear(e){if(e&&e.contentsOnly&&!e.formatOnly)return this.clearContents();if(e&&e.formatOnly&&!e.contentsOnly)return this.clearFormats();const t=this._workbook.getUnitId(),n=this._worksheet.getSheetId(),s=this._injector.get(m),r={startRow:0,endRow:this._worksheet.getRowCount()-1,startColumn:0,endColumn:this._worksheet.getColumnCount()-1};return s.syncExecuteCommand(qe.id,{unitId:t,subUnitId:n,ranges:[r],options:e}),this}clearContents(){const e=this._workbook.getUnitId(),t=this._worksheet.getSheetId(),n=this._injector.get(m),s={startRow:0,endRow:this._worksheet.getRowCount()-1,startColumn:0,endColumn:this._worksheet.getColumnCount()-1};return n.syncExecuteCommand(Ye.id,{unitId:e,subUnitId:t,ranges:[s]}),this}clearFormats(){const e=this._workbook.getUnitId(),t=this._worksheet.getSheetId(),n=this._injector.get(m),s={startRow:0,endRow:this._worksheet.getRowCount()-1,startColumn:0,endColumn:this._worksheet.getColumnCount()-1};return n.syncExecuteCommand(Ke.id,{unitId:e,subUnitId:t,ranges:[s]}),this}getDataRange(){const e=this.getLastRows(),t=this.getLastColumns();return this.getRange(0,0,e+1,t+1)}getLastColumns(){return this._worksheet.getLastColumnWithContent()}getLastColumn(){return this._worksheet.getLastColumnWithContent()}getLastRows(){return this._worksheet.getLastRowWithContent()}getLastRow(){return this._worksheet.getLastRowWithContent()}equalTo(e){return e instanceof w?this._worksheet.getSheetId()===e.getSheetId()&&this._workbook.getUnitId()===e.getWorkbook().getUnitId():!1}insertDefinedName(e,t){const n=this._injector.createInstance(Y).setName(e).setRef(t).build();n.localSheetId=this.getSheetId(),this._fWorkbook.insertDefinedNameBuilder(n)}getDefinedNames(){return this._fWorkbook.getDefinedNames().filter(e=>e.getLocalSheetId()===this.getSheetId())}setCustomMetadata(e){return this._worksheet.setCustomMetadata(e),this}getCustomMetadata(){return this._worksheet.getCustomMetadata()}setRowCustomMetadata(e,t){return this._worksheet.getRowManager().setCustomMetadata(e,t),this}setColumnCustomMetadata(e,t){return this._worksheet.getColumnManager().setCustomMetadata(e,t),this}getRowCustomMetadata(e){return this._worksheet.getRowManager().getCustomMetadata(e)}getColumnCustomMetadata(e){return this._worksheet.getColumnManager().getCustomMetadata(e)}appendRow(e){const t=this._worksheet.getCellMatrix().hasValue(),n=this._worksheet.getLastRowWithContent(),s=this._worksheet.getRowCount(),r=this._worksheet.getColumnCount(),i=t?n+1:n,o=new K;for(let a=0;a<e.length;a++)o.setValue(i,a,ie(e[a]));return this._commandService.syncExecuteCommand(Vt.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),cellValue:o.getMatrix(),insertRowNums:i>s-1?1:0,insertColumnNums:e.length>r?e.length-r:0,maxRows:s,maxColumns:r}),this}setRowCount(e){return this._commandService.syncExecuteCommand(Lt.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),rowCount:e}),this}setColumnCount(e){return this._commandService.syncExecuteCommand(Ot.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),columnCount:e}),this}};w=Sn([L(3,l(P)),L(4,l(tt)),L(5,l($e)),L(6,m)],w);var In=(e,t,n,s)=>{for(var r=t,i=e.length-1,o;i>=0;i--)(o=e[i])&&(r=o(r)||r);return r},f=(e,t)=>(n,s)=>t(n,s,e);let C=class extends ge{constructor(e,t,n,s,r,i,o,a,h,d){super(t),U(this,"id"),this._workbook=e,this._injector=t,this._resourceLoaderService=n,this._selectionManagerService=s,this._univerInstanceService=r,this._commandService=i,this._permissionService=o,this._logService=a,this._localeService=h,this._definedNamesService=d,this.id=this._workbook.getUnitId()}getWorkbook(){return this._workbook}dispose(){super.dispose(),this._workbook=null}getId(){return this.id}getName(){return this._workbook.name}setName(e){return this._commandService.syncExecuteCommand(mt.id,{unitId:this._workbook.getUnitId(),name:e}),this}save(){return this._resourceLoaderService.saveUnit(this._workbook.getUnitId())}getSnapshot(){return this._logService.warn("use 'save' instead of 'getSnapshot'"),this.save()}getActiveSheet(){const e=this._workbook.getActiveSheet();return this._injector.createInstance(w,this,this._workbook,e)}getSheets(){return this._workbook.getSheets().map(e=>this._injector.createInstance(w,this,this._workbook,e))}create(e,t,n,s){var r,i,o;const a=we(Ce.deepClone((r=s==null?void 0:s.sheet)!=null?r:{}));a.name=e,a.rowCount=t,a.columnCount=n,a.id=(i=s==null?void 0:s.sheet)==null?void 0:i.id;const h=(o=s==null?void 0:s.index)!=null?o:this._workbook.getSheets().length;this._commandService.syncExecuteCommand($.id,{unitId:this.id,index:h,sheet:a}),this._commandService.syncExecuteCommand(B.id,{unitId:this.id,subUnitId:this._workbook.getSheets()[h].getSheetId()});const d=this._workbook.getActiveSheet();if(!d)throw new Error("No active sheet found");return this._injector.createInstance(w,this,this._workbook,d)}getSheetBySheetId(e){const t=this._workbook.getSheetBySheetId(e);return t?this._injector.createInstance(w,this,this._workbook,t):null}getSheetByName(e){const t=this._workbook.getSheetBySheetName(e);return t?this._injector.createInstance(w,this,this._workbook,t):null}setActiveSheet(e){return this._commandService.syncExecuteCommand(B.id,{unitId:this.id,subUnitId:typeof e=="string"?e:e.getSheetId()}),typeof e=="string"?this.getSheetBySheetId(e):e}insertSheet(e,t){var n,s,r;const i=we(Ce.deepClone((n=t==null?void 0:t.sheet)!=null?n:{}));i.name=e,i.id=(s=t==null?void 0:t.sheet)==null?void 0:s.id;const o=(r=t==null?void 0:t.index)!=null?r:this._workbook.getSheets().length;this._commandService.syncExecuteCommand($.id,{unitId:this.id,index:o,sheet:i}),this._commandService.syncExecuteCommand(B.id,{unitId:this.id,subUnitId:this._workbook.getSheets()[o].getSheetId()});const a=this._workbook.getActiveSheet();if(!a)throw new Error("No active sheet found");return this._injector.createInstance(w,this,this._workbook,a)}deleteSheet(e){const t=this.id,n=typeof e=="string"?e:e.getSheetId();return this._commandService.syncExecuteCommand(oe.id,{unitId:t,subUnitId:n})}undo(){return this._univerInstanceService.focusUnit(this.id),this._commandService.syncExecuteCommand(nt.id),this}redo(){return this._univerInstanceService.focusUnit(this.id),this._commandService.syncExecuteCommand(st.id),this}onBeforeCommandExecute(e){return this._commandService.beforeCommandExecuted(t=>{var n;((n=t.params)==null?void 0:n.unitId)===this.id&&e(t)})}onCommandExecuted(e){return this._commandService.onCommandExecuted(t=>{var n;((n=t.params)==null?void 0:n.unitId)===this.id&&e(t)})}onSelectionChange(e){return He(this._selectionManagerService.selectionMoveEnd$.subscribe(t=>{this._univerInstanceService.getCurrentUnitForType(y.UNIVER_SHEET).getUnitId()===this.id&&(t!=null&&t.length?e(t.map(n=>n.range)):e([]))}))}setEditable(e){const t=new Ge(this._workbook.getUnitId());return this._permissionService.getPermissionPoint(t.id)||this._permissionService.addPermissionPoint(t),this._permissionService.updatePermissionPoint(t.id,e),this}setActiveRange(e){const t=this.getActiveSheet(),n=e.getRange().sheetId||t.getSheetId(),s=n?this._workbook.getSheetBySheetId(n):this._workbook.getActiveSheet(!0);if(!s)throw new Error("No active sheet found");s.getSheetId()!==t.getSheetId()&&this.setActiveSheet(this._injector.createInstance(w,this,this._workbook,s));const r={unitId:this.getId(),subUnitId:n,selections:[e].map(i=>({range:i.getRange(),primary:z(i.getRange(),s),style:null}))};return this._commandService.syncExecuteCommand(_e.id,r),this}getActiveRange(){const e=this._workbook.getActiveSheet(),t=this._selectionManagerService.getCurrentSelections().find(n=>!!n.primary);return t?this._injector.createInstance(_,this._workbook,e,t.range):null}getActiveCell(){const e=this._workbook.getActiveSheet(),t=this._selectionManagerService.getCurrentSelections().find(s=>!!s.primary);if(!t)return null;const n={...t.primary,rangeType:k.NORMAL};return this._injector.createInstance(_,this._workbook,e,n)}deleteActiveSheet(){const e=this.getActiveSheet();return this.deleteSheet(e)}duplicateSheet(e){return this._commandService.syncExecuteCommand(_t.id,{unitId:e.getWorkbook().getUnitId(),subUnitId:e.getSheetId()}),this._injector.createInstance(w,this,this._workbook,this._workbook.getActiveSheet())}duplicateActiveSheet(){const e=this.getActiveSheet();return this.duplicateSheet(e)}getNumSheets(){return this._workbook.getSheets().length}getLocale(){return this._localeService.getCurrentLocale()}setLocale(e){this._localeService.setLocale(e)}setSpreadsheetLocale(e){return this._localeService.setLocale(e),this}getUrl(){return location.href}moveSheet(e,t){let n=t;return n<0?n=0:n>this._workbook.getSheets().length-1&&(n=this._workbook.getSheets().length-1),this._commandService.syncExecuteCommand(kt.id,{unitId:e.getWorkbook().getUnitId(),order:n,subUnitId:e.getSheetId()}),this}moveActiveSheet(e){const t=this.getActiveSheet();return this.moveSheet(t,e)}getPermission(){return this._injector.createInstance(J)}getDefinedName(e){const t=this._definedNamesService.getValueByName(this.id,e);return t?this._injector.createInstance(G,{...t,unitId:this.id}):null}getDefinedNames(){const e=this._definedNamesService.getDefinedNameMap(this.id);return e?Object.values(e).map(t=>this._injector.createInstance(G,{...t,unitId:this.id})):[]}insertDefinedName(e,t){const n=this._injector.createInstance(Y).setName(e).setRef(t).build();return n.localSheetId=F,this.insertDefinedNameBuilder(n),this}deleteDefinedName(e){const t=this.getDefinedName(e);return t?(t.delete(),!0):!1}insertDefinedNameBuilder(e){e.unitId=this.getId(),this._commandService.syncExecuteCommand(ue.id,e)}updateDefinedNameBuilder(e){this._commandService.syncExecuteCommand(ue.id,e)}getRegisteredRangeThemes(){return this._injector.get(Je).getRegisteredRangeThemes()}registerRangeTheme(e){this._commandService.syncExecuteCommand(wt.id,{unitId:this.getId(),rangeThemeStyle:e})}unregisterRangeTheme(e){this._commandService.syncExecuteCommand(Ct.id,{unitId:this.getId(),themeName:e})}createRangeThemeStyle(e,t){return new St(e,t)}setCustomMetadata(e){return this._workbook.setCustomMetadata(e),this}getCustomMetadata(){return this._workbook.getCustomMetadata()}addStyles(e){this._workbook.addStyles(e)}removeStyles(e){this._workbook.removeStyles(e)}};C=In([f(1,l(P)),f(2,l(it)),f(3,l(tt)),f(4,re),f(5,m),f(6,ce),f(7,$e),f(8,l(Oe)),f(9,et)],C);class vn extends ze{getCommandSheetTarget(t){var n;const s=t.params;if(!s)return this.getActiveSheet();const r=s.unitId?this.getUniverSheet(s.unitId):(n=this.getActiveWorkbook)==null?void 0:n.call(this);if(!r)return;const i=r.getSheetBySheetId(s.subUnitId||s.sheetId)||r.getActiveSheet();if(i)return{workbook:r,worksheet:i}}getSheetTarget(t,n){const s=this.getUniverSheet(t);if(!s)return;const r=s.getSheetBySheetId(n);if(r)return{workbook:s,worksheet:r}}_initWorkbookEvent(t){const n=t.get(re);this.registerEventHandler(this.Event.WorkbookDisposed,()=>n.unitDisposed$.subscribe(s=>{s.type===y.UNIVER_SHEET&&this.fireEvent(this.Event.WorkbookDisposed,{unitId:s.getUnitId(),unitType:s.type,snapshot:s.getSnapshot()})})),this.registerEventHandler(this.Event.WorkbookCreated,()=>n.unitAdded$.subscribe(s=>{if(s.type===y.UNIVER_SHEET){const r=s,i=t.createInstance(C,r);this.fireEvent(this.Event.WorkbookCreated,{unitId:s.getUnitId(),type:s.type,workbook:i,unit:i})}}))}_initialize(t){const n=t.get(m);this.registerEventHandler(this.Event.BeforeSheetCreate,()=>n.beforeCommandExecuted(s=>{var r;if(s.id===$.id){const i=s.params,{unitId:o,index:a,sheet:h}=i||{},d=o?this.getUniverSheet(o):(r=this.getActiveWorkbook)==null?void 0:r.call(this);if(!d)return;const u={workbook:d,index:a,sheet:h};if(this.fireEvent(this.Event.BeforeSheetCreate,u),u.cancel)throw new I}})),this.registerEventHandler(this.Event.BeforeActiveSheetChange,()=>n.beforeCommandExecuted(s=>{var r;if(s.id===B.id){const{subUnitId:i,unitId:o}=s.params,a=o?this.getUniverSheet(o):(r=this.getActiveWorkbook)==null?void 0:r.call(this);if(!a||!i)return;const h=a.getSheetBySheetId(i),d=a.getActiveSheet();if(!h||!d)return;const u={workbook:a,activeSheet:h,oldActiveSheet:d};if(this.fireEvent(this.Event.BeforeActiveSheetChange,u),u.cancel)throw new I}})),this.registerEventHandler(this.Event.BeforeSheetDelete,()=>n.beforeCommandExecuted(s=>{if(s.id===oe.id){const r=this.getCommandSheetTarget(s);if(!r)return;const{workbook:i,worksheet:o}=r,a={workbook:i,worksheet:o};if(this.fireEvent(this.Event.BeforeSheetDelete,a),a.cancel)throw new I}})),this.registerEventHandler(this.Event.BeforeSheetMove,()=>n.beforeCommandExecuted(s=>{if(s.id===fe.id){const{fromOrder:r,toOrder:i}=s.params,o=this.getCommandSheetTarget(s);if(!o)return;const a={workbook:o.workbook,worksheet:o.worksheet,newIndex:i,oldIndex:r};if(this.fireEvent(this.Event.BeforeSheetMove,a),a.cancel)throw new I}})),this.registerEventHandler(this.Event.BeforeSheetNameChange,()=>n.beforeCommandExecuted(s=>{if(s.id===ae.id){const{name:r}=s.params,i=this.getCommandSheetTarget(s);if(!i)return;const o={workbook:i.workbook,worksheet:i.worksheet,newName:r,oldName:i.worksheet.getSheetName()};if(this.fireEvent(this.Event.BeforeSheetNameChange,o),o.cancel)throw new I}})),this.registerEventHandler(this.Event.BeforeSheetTabColorChange,()=>n.beforeCommandExecuted(s=>{if(s.id===be.id){const{color:r}=s.params,i=this.getCommandSheetTarget(s);if(!i)return;const o={workbook:i.workbook,worksheet:i.worksheet,newColor:r,oldColor:i.worksheet.getTabColor()};if(this.fireEvent(this.Event.BeforeSheetTabColorChange,o),o.cancel)throw new I}})),this.registerEventHandler(this.Event.BeforeSheetHideChange,()=>n.beforeCommandExecuted(s=>{if(s.id===Re.id){const{hidden:r}=s.params,i=this.getCommandSheetTarget(s);if(!i)return;const o={workbook:i.workbook,worksheet:i.worksheet,hidden:!!r};if(this.fireEvent(this.Event.BeforeSheetHideChange,o),o.cancel)throw new I}})),this.registerEventHandler(this.Event.BeforeGridlineColorChange,()=>n.beforeCommandExecuted(s=>{var r;if(s.id===he.id){const i=this.getCommandSheetTarget(s);if(!i)return;const o={...i,color:(r=s.params)==null?void 0:r.color};if(this.fireEvent(this.Event.BeforeGridlineColorChange,o),o.cancel)throw new I}})),this.registerEventHandler(this.Event.BeforeGridlineEnableChange,()=>n.beforeCommandExecuted(s=>{var r;if(s.id===de.id){const i=this.getCommandSheetTarget(s);if(!i)return;const o={...i,enabled:!!((r=s.params)!=null&&r.showGridlines)};if(this.fireEvent(this.Event.BeforeGridlineEnableChange,o),o.cancel)throw new I}})),this.registerEventHandler(this.Event.SheetValueChanged,()=>n.onCommandExecuted(s=>{if(ht.indexOf(s.id)>-1){if(!this.getActiveSheet())return;const r=dt(s).map(i=>{var o,a;return(a=(o=this.getWorkbook(i.unitId))==null?void 0:o.getSheetBySheetId(i.subUnitId))==null?void 0:a.getRange(i.range)}).filter(Boolean);if(!r.length)return;this.fireEvent(this.Event.SheetValueChanged,{payload:s,effectedRanges:r})}})),this.registerEventHandler(this.Event.SheetCreated,()=>n.onCommandExecuted(s=>{var r;if(s.id===$.id){const i=s.params,{unitId:o}=i||{},a=o?this.getUniverSheet(o):(r=this.getActiveWorkbook)==null?void 0:r.call(this);if(!a)return;const h=a.getActiveSheet();if(!h)return;const d={workbook:a,worksheet:h};this.fireEvent(this.Event.SheetCreated,d)}})),this.registerEventHandler(this.Event.ActiveSheetChanged,()=>n.onCommandExecuted(s=>{if(s.id===B.id){const r=this.getActiveSheet();if(!r)return;const{workbook:i,worksheet:o}=r;this._fireActiveSheetChanged(i,o)}})),this.registerEventHandler(this.Event.SheetDeleted,()=>n.onCommandExecuted(s=>{var r;if(s.id===oe.id){const{subUnitId:i,unitId:o}=s.params,a=o?this.getUniverSheet(o):(r=this.getActiveWorkbook)==null?void 0:r.call(this);if(!a||!i)return;this._fireSheetDeleted(a,i)}})),this.registerEventHandler(this.Event.SheetMoved,()=>n.onCommandExecuted(s=>{if(s.id===fe.id){const{toOrder:r}=s.params,i=this.getCommandSheetTarget(s);if(!i)return;this._fireSheetMoved(i.workbook,i.worksheet,r)}})),this.registerEventHandler(this.Event.SheetNameChanged,()=>n.onCommandExecuted(s=>{if(s.id===ae.id){const{name:r}=s.params,i=this.getCommandSheetTarget(s);if(!i)return;this._fireSheetNameChanged(i.workbook,i.worksheet,r)}})),this.registerEventHandler(this.Event.SheetTabColorChanged,()=>n.onCommandExecuted(s=>{if(s.id===be.id){const{color:r}=s.params,i=this.getCommandSheetTarget(s);if(!i)return;this._fireSheetTabColorChanged(i.workbook,i.worksheet,r)}})),this.registerEventHandler(this.Event.SheetHideChanged,()=>n.onCommandExecuted(s=>{if(s.id===Re.id){const{hidden:r}=s.params,i=this.getCommandSheetTarget(s);if(!i)return;this._fireSheetHideChanged(i.workbook,i.worksheet,!!r)}})),this.registerEventHandler(this.Event.GridlineChanged,()=>n.onCommandExecuted(s=>{if(s.id===he.id||s.id===de.id){const r=this.getCommandSheetTarget(s);if(!r)return;this.fireEvent(this.Event.GridlineChanged,{...r,enabled:!r.worksheet.hasHiddenGridLines(),color:r.worksheet.getGridLinesColor()})}})),this._initWorkbookEvent(t)}createUniverSheet(t,n){const s=this._injector.get(re).createUnit(y.UNIVER_SHEET,t,n);return this._injector.createInstance(C,s)}createWorkbook(t,n){return this.createUniverSheet(t,n)}getActiveWorkbook(){const t=this._univerInstanceService.getCurrentUnitForType(y.UNIVER_SHEET);return t?this._injector.createInstance(C,t):null}getActiveUniverSheet(){return this.getActiveWorkbook()}getUniverSheet(t){const n=this._univerInstanceService.getUnit(t,y.UNIVER_SHEET);return n?this._injector.createInstance(C,n):null}getWorkbook(t){return this.getUniverSheet(t)}getPermission(){return this._injector.createInstance(J)}onUniverSheetCreated(t){const n=this._univerInstanceService.getTypeOfUnitAdded$(y.UNIVER_SHEET).subscribe(s=>{const r=this._injector.createInstance(C,s);t(r)});return He(n)}newDefinedName(){return this._injector.createInstance(Y)}getActiveSheet(){const t=this.getActiveWorkbook();if(!t)return null;const n=t.getActiveSheet();return n?{workbook:t,worksheet:n}:null}setFreezeSync(t){this._injector.get(ut).setEnabled(t)}_fireActiveSheetChanged(t,n){this.fireEvent(this.Event.ActiveSheetChanged,{workbook:t,activeSheet:n})}_fireSheetDeleted(t,n){this.fireEvent(this.Event.SheetDeleted,{workbook:t,sheetId:n})}_fireSheetMoved(t,n,s){this.fireEvent(this.Event.SheetMoved,{workbook:t,worksheet:n,newIndex:s})}_fireSheetNameChanged(t,n,s){this.fireEvent(this.Event.SheetNameChanged,{workbook:t,worksheet:n,newName:s})}_fireSheetTabColorChanged(t,n,s){this.fireEvent(this.Event.SheetTabColorChanged,{workbook:t,worksheet:n,newColor:s})}_fireSheetHideChanged(t,n,s){this.fireEvent(this.Event.SheetHideChanged,{workbook:t,worksheet:n,hidden:s})}}ze.extend(vn);class fn{get SheetValueChangeType(){return lt}get SheetSkeletonChangeType(){return ct}get SplitDelimiterType(){return gt}}ot.extend(fn);class bn{get SheetCreated(){return"SheetCreated"}get BeforeSheetCreate(){return"BeforeSheetCreate"}get WorkbookCreated(){return"WorkbookCreated"}get WorkbookDisposed(){return"WorkbookDisposed"}get GridlineChanged(){return"GridlineChanged"}get BeforeGridlineEnableChange(){return"BeforeGridlineEnableChange"}get BeforeGridlineColorChange(){return"BeforeGridlineColorChange"}get BeforeActiveSheetChange(){return"BeforeActiveSheetChange"}get ActiveSheetChanged(){return"ActiveSheetChanged"}get SheetDeleted(){return"SheetDeleted"}get BeforeSheetDelete(){return"BeforeSheetDelete"}get SheetMoved(){return"SheetMoved"}get BeforeSheetMove(){return"BeforeSheetMove"}get SheetNameChanged(){return"SheetNameChanged"}get BeforeSheetNameChange(){return"BeforeSheetNameChange"}get SheetTabColorChanged(){return"SheetTabColorChanged"}get BeforeSheetTabColorChange(){return"BeforeSheetTabColorChange"}get SheetHideChanged(){return"SheetHideChanged"}get BeforeSheetHideChange(){return"BeforeSheetHideChange"}get SheetValueChanged(){return"SheetValueChanged"}}at.extend(bn);var Rn=(e,t,n,s)=>{for(var r=t,i=e.length-1,o;i>=0;i--)(o=e[i])&&(r=o(r)||r);return r},pn=(e,t)=>(n,s)=>t(n,s,e);let Fe=class extends me{constructor(e){super(),this._injector=e}};Fe=Rn([pn(0,l(P))],Fe);export{C,Fe as H,w as S,J as Y,_ as k,bn as x};
