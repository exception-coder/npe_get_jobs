import{M as S,v as N,L as w,V as C,af as Fe,ai as W,n as ue,b as P,w as m,O as we,o as _e,z as Z,ap as qe,q as ve,x as me,I as p,u as Ce,H as Je,s as Ge,e as Se,F as Ke,a9 as le,S as Ye,a5 as Xe,d as Qe,ak as et,c as tt,a1 as H}from"./TeamSpreadsheet-DqPQXi__.js";import{nJ as re,z as U,kz as ot,je as st,nT as rt,a6 as it,G as Ie,km as nt,h as at,d as O,M as ie,sT as ht,sU as ut,u as lt,s as ct,rb as dt,ra as pt,H as ne,c as Ne,B as gt,P as Me,V as be,j as ft,ou as Ee,q as wt,i as _t,k as vt,n as mt}from"./index--BQDx9CP.js";import{r as g,j as Ct,H as St,i as It,a as Nt,I as Pe}from"./facade-DLk4o3Z_.js";import{k as ke,S as xe}from"./facade-DJ8otAmv.js";import"./index-mJOBftNs.js";import"./VRow-C6N6h8s9.js";import"./VCard-DFIDGoOa.js";import"./VSelect-CO5xudFf.js";import"./VTextField-tFIcna6m.js";import"./VTabs-BYSgCciz.js";import"./VAlert-CfJUBCCM.js";import"./VDialog-C4Wnh1zS.js";import"./VFileInput-DBMVcNlc.js";import"./VTextarea-34QBZFhW.js";var Mt=Object.defineProperty,bt=(o,e,t)=>e in o?Mt(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t,E=(o,e,t)=>bt(o,typeof e!="symbol"?e+"":e,t);class d extends C{constructor(){super(...arguments),E(this,"_noteMatrix",new Map),E(this,"_change$",new Fe),E(this,"change$",this._change$.asObservable())}_ensureNoteMatrix(e,t){let r=this._noteMatrix.get(e);r||(r=new Map,this._noteMatrix.set(e,r));let s=r.get(t);return s||(s=new W,r.set(t,s)),s}getSheetShowNotes$(e,t){return this._change$.pipe(ue(({unitId:r,sheetId:s})=>r===e&&s===t),P(()=>{const r=this._ensureNoteMatrix(e,t),s=[];return r.forValue((i,n,a)=>{a.show&&s.push({loc:{row:i,col:n,unitId:e,subUnitId:t},note:a})}),s}))}getCellNoteChange$(e,t,r,s){return this._change$.pipe(ue(({unitId:i,sheetId:n,row:a,col:h})=>i===e&&n===t&&a===r&&h===s),P(({note:i})=>i))}updateNote(e,t,r,s,i,n){const a=this._ensureNoteMatrix(e,t),h=a.getValue(r,s);a.setValue(r,s,i),this._change$.next({unitId:e,sheetId:t,row:r,col:s,type:"update",note:i,oldNote:h,silent:n})}removeNote(e,t,r,s,i){const n=this._ensureNoteMatrix(e,t),a=n.getValue(r,s);n.realDeleteValue(r,s),this._change$.next({unitId:e,sheetId:t,row:r,col:s,type:"update",note:null,oldNote:a,silent:i})}toggleNotePopup(e,t,r,s,i){const n=this._ensureNoteMatrix(e,t),a=n.getValue(r,s);if(a){a.show=!a.show;const h={...a,show:a.show};n.setValue(r,s,h),this._change$.next({unitId:e,sheetId:t,row:r,col:s,type:"update",note:h,oldNote:a,silent:i})}}updateNotePosition(e,t,r,s,i,n,a){const h=this._ensureNoteMatrix(e,t),u=h.getValue(r,s);u&&(h.realDeleteValue(r,s),h.setValue(i,n,u),this._change$.next({unitId:e,sheetId:t,row:r,col:s,type:"ref",newPosition:{row:i,col:n},note:u,silent:a}))}getNote(e,t,r,s){return this._ensureNoteMatrix(e,t).getValue(r,s)}getUnitNotes(e){return this._noteMatrix.get(e)}getSheetNotes(e,t){const r=this._noteMatrix.get(e);if(r)return r.get(t)}getNotes(){return this._noteMatrix}deleteUnitNotes(e){this._noteMatrix.delete(e)}}const k={id:"sheet.mutation.update-note",type:S.MUTATION,handler:(o,e)=>{const{unitId:t,sheetId:r,row:s,col:i,note:n,silent:a}=e;return o.get(d).updateNote(t,r,s,i,n,a),!0}},x={id:"sheet.mutation.remove-note",type:S.MUTATION,handler:(o,e)=>{const{unitId:t,sheetId:r,row:s,col:i,silent:n}=e;return o.get(d).removeNote(t,r,s,i,n),!0}},ye={id:"sheet.mutation.toggle-note-popup",type:S.MUTATION,handler:(o,e)=>{const{unitId:t,sheetId:r,row:s,col:i,silent:n}=e;return o.get(d).toggleNotePopup(t,r,s,i,n),!0}},se={id:"sheet.mutation.update-note-position",type:S.MUTATION,handler:(o,e)=>{const{unitId:t,sheetId:r,row:s,col:i,newPosition:n,silent:a}=e;return o.get(d).updateNotePosition(t,r,s,i,n.row,n.col,a),!0}},V={id:"sheet.command.delete-note",type:S.COMMAND,handler:(o,e)=>{const t=o.get(N),r=re(t);if(!r)return!1;const s=o.get(U).getCurrentLastSelection();if(!(s!=null&&s.primary))return!1;const{actualColumn:i,actualRow:n}=s.primary;return o.get(w).executeCommand(x.id,{unitId:r.unitId,sheetId:r.subUnitId,row:n,col:i})}},R={id:"sheet.command.toggle-note-popup",type:S.COMMAND,handler:(o,e)=>{const t=o.get(N),r=re(t);if(!r)return!1;const s=o.get(U).getCurrentLastSelection();if(!(s!=null&&s.primary))return!1;const{actualColumn:i,actualRow:n}=s.primary;return o.get(w).executeCommand(ye.id,{unitId:r.unitId,sheetId:r.subUnitId,row:n,col:i})}},z={id:"sheet.command.update-note",type:S.COMMAND,handler:(o,e)=>o.get(w).syncExecuteCommand(k.id,e)},$e="SHEET_NOTE_PLUGIN";var Et=(o,e,t,r)=>{for(var s=e,i=o.length-1,n;i>=0;i--)(n=o[i])&&(s=n(s)||s);return s},B=(o,e)=>(t,r)=>e(t,r,o);let F=class extends C{constructor(o,e,t,r){super(),this._resourceManagerService=o,this._univerInstanceService=e,this._sheetInterceptorService=t,this._sheetsNoteModel=r,this._initSnapshot(),this._initSheetChange()}_initSnapshot(){const o=t=>{const r=this._sheetsNoteModel.getUnitNotes(t);if(!r)return"";const s={};return r.forEach((i,n)=>{const a={};i.forValue((h,u,l)=>{a[h]||(a[h]={}),a[h][u]=l}),Object.keys(a).length>0&&(s[n]=a)}),JSON.stringify(s)},e=t=>{if(!t)return{};try{return JSON.parse(t)}catch{return{}}};this.disposeWithMe(this._resourceManagerService.registerPluginResource({pluginName:$e,businesses:[m.UNIVER_SHEET],toJson:t=>o(t),parseJson:t=>e(t),onUnLoad:t=>{this._sheetsNoteModel.deleteUnitNotes(t)},onLoad:(t,r)=>{Object.entries(r).forEach(([s,i])=>{Object.entries(i).forEach(([n,a])=>{Object.entries(a).forEach(([h,u])=>{this._sheetsNoteModel.updateNote(t,s,Number(n),Number(h),u)})})})}}))}_initSheetChange(){this.disposeWithMe(this._sheetInterceptorService.interceptCommand({getMutations:o=>{var e;if(o.id===ot.id){const t=o.params,r=t.unitId||this._univerInstanceService.getCurrentUnitOfType(m.UNIVER_SHEET).getUnitId(),s=t.subUnitId||((e=this._univerInstanceService.getCurrentUnitOfType(m.UNIVER_SHEET).getActiveSheet())==null?void 0:e.getSheetId());if(!r||!s)return{redos:[],undos:[]};const i=this._sheetsNoteModel.getSheetNotes(r,s);if(!i)return{redos:[],undos:[]};const n=[],a=[];return i.forValue((h,u,l)=>{n.push({id:x.id,params:{unitId:r,sheetId:s,row:h,col:u}}),a.push({id:k.id,params:{unitId:r,sheetId:s,row:h,col:u,note:l}})}),{redos:n,undos:a}}else if(o.id===st.id){const t=o.params,{unitId:r,subUnitId:s,targetSubUnitId:i}=t;if(!r||!s||!i)return{redos:[],undos:[]};const n=this._sheetsNoteModel.getSheetNotes(r,s);if(!n)return{redos:[],undos:[]};const a=[],h=[];return n.forValue((u,l,c)=>{a.push({id:k.id,params:{unitId:r,sheetId:i,row:u,col:l,note:c}}),h.push({id:x.id,params:{unitId:r,sheetId:i,row:u,col:l}})}),{redos:a,undos:h}}return{redos:[],undos:[]}}}))}};F=Et([B(0,Je),B(1,N),B(2,p(Ie)),B(3,p(d))],F);const Pt="sheets-note.config",ce={};var kt=(o,e,t,r)=>{for(var s=e,i=o.length-1,n;i>=0;i--)(n=o[i])&&(s=n(s)||s);return s},j=(o,e)=>(t,r)=>e(t,r,o);let q=class extends C{constructor(o,e,t,r){super(),E(this,"_disposableMap",new Map),E(this,"_watcherMap",new Map),E(this,"_handleRangeChange",(s,i,n,a,h,u,l)=>u?{redos:[{id:se.id,params:{unitId:s,sheetId:i,row:a,col:h,newPosition:{row:u.startRow,col:u.startColumn},silent:l}}],undos:[{id:se.id,params:{unitId:s,sheetId:i,row:u.startRow,col:u.startColumn,newPosition:{row:a,col:h},note:n,silent:l}}]}:{redos:[{id:x.id,params:{unitId:s,sheetId:i,row:a,col:h}}],undos:[{id:k.id,params:{unitId:s,sheetId:i,row:a,col:h,note:n}}]}),this._refRangeService=o,this._sheetsNoteModel=e,this._selectionManagerService=t,this._commandService=r,this._initData(),this._initRefRange()}_getIdWithUnitId(o,e,t,r){return`${o}-${e}-${t}-${r}`}_register(o,e,t,r,s){const i={startColumn:s,endColumn:s,startRow:r,endRow:r};this._disposableMap.set(this._getIdWithUnitId(o,e,r,s),this._refRangeService.registerRefRange(i,n=>{const a=rt(i,n,{selectionManagerService:this._selectionManagerService}),h=Array.isArray(a)?a[0]:a;return h&&h.startColumn===i.startColumn&&h.startRow===i.startRow?{undos:[],redos:[]}:this._handleRangeChange(o,e,t,r,s,h,!1)},o,e))}_watch(o,e,t,r,s){const i={startColumn:s,endColumn:s,startRow:r,endRow:r};this._watcherMap.set(this._getIdWithUnitId(o,e,r,s),this._refRangeService.watchRange(o,e,i,(n,a)=>{const{redos:h}=this._handleRangeChange(o,e,t,n.startRow,n.startColumn,a,!0);qe(h,this._commandService,{onlyLocal:!0})},!0))}_unwatch(o,e,t,r){var s;const i=this._getIdWithUnitId(o,e,t,r);(s=this._watcherMap.get(i))==null||s.dispose(),this._watcherMap.delete(i)}_unregister(o,e,t,r){var s;const i=this._getIdWithUnitId(o,e,t,r);(s=this._disposableMap.get(i))==null||s.dispose(),this._disposableMap.delete(i)}_initData(){const o=this._sheetsNoteModel.getNotes();for(const[e,t]of o)for(const[r,s]of t)s.forValue((i,n,a)=>(a&&(this._register(e,r,a,i,n),this._watch(e,r,a,i,n)),!0))}_initRefRange(){this.disposeWithMe(this._sheetsNoteModel.change$.subscribe(o=>{switch(o.type){case"update":{const{unitId:e,sheetId:t,row:r,col:s,note:i}=o,n=this._getIdWithUnitId(e,t,r,s);i?this._disposableMap.has(n)||(this._register(e,t,i,r,s),this._watch(e,t,i,r,s)):(this._unregister(e,t,r,s),this._unwatch(e,t,r,s));break}case"ref":{const{unitId:e,sheetId:t,row:r,col:s,newPosition:i,note:n,silent:a}=o;this._unregister(e,t,r,s),a||(this._unwatch(e,t,r,s),this._watch(e,t,n,i.row,i.col)),this._register(e,t,n,i.row,i.col);break}}}))}};q=kt([j(0,p(nt)),j(1,p(d)),j(2,p(U)),j(3,w)],q);var xt=(o,e,t,r)=>{for(var s=e,i=o.length-1,n;i>=0;i--)(n=o[i])&&(s=n(s)||s);return s},yt=(o,e)=>(t,r)=>e(t,r,o);let J=class extends C{constructor(e){super(),this._commandService=e,this._initialize()}_initialize(){[se,ye,k,x,V,R,z].forEach(e=>{this.disposeWithMe(this._commandService.registerCommand(e))})}};J=xt([yt(0,w)],J);var $t=Object.defineProperty,Ut=(o,e,t)=>e in o?$t(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t,Ht=(o,e,t,r)=>{for(var s=e,i=o.length-1,n;i>=0;i--)(n=o[i])&&(s=n(s)||s);return s},de=(o,e)=>(t,r)=>e(t,r,o),Ue=(o,e,t)=>Ut(o,typeof e!="symbol"?e+"":e,t);let y=class extends we{constructor(o=ce,e,t){super(),this._config=o,this._configService=e,this._injector=t;const{...r}=_e({},ce,this._config);this._configService.setConfig(Pt,r)}onStarting(){[[d],[J],[F],[q]].forEach(o=>{this._injector.add(o)}),Z(this._injector,[[d],[J],[F]])}onReady(){Z(this._injector,[[q]])}};Ue(y,"pluginName",$e);Ue(y,"type",m.UNIVER_SHEET);y=Ht([ve(it),de(1,me),de(2,p(Ce))],y);var Rt=Object.defineProperty,Tt=(o,e,t)=>e in o?Rt(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t,b=(o,e,t)=>Tt(o,typeof e!="symbol"?e+"":e,t),Vt=(o,e,t,r)=>{for(var s=e,i=o.length-1,n;i>=0;i--)(n=o[i])&&(s=n(s)||s);return s},A=(o,e)=>(t,r)=>e(t,r,o);let G=class extends C{constructor(o,e,t,r){super(),this._sheetInterceptorService=o,this._sheetsNoteModel=e,this._renderManagerService=t,this._univerInstanceService=r,this._initViewModelIntercept(),this._initSkeletonChange()}_initViewModelIntercept(){this.disposeWithMe(this._sheetInterceptorService.intercept(at.CELL_CONTENT,{effect:Ge.Style,handler:(o,e,t)=>{const{row:r,col:s,unitId:i,subUnitId:n}=e;return this._sheetsNoteModel.getNote(i,n,r,s)&&((!o||o===e.rawData)&&(o={...e.rawData}),o.markers={...o==null?void 0:o.markers,tr:{color:"#FFBD37",size:6}}),t(o)},priority:100}))}_initSkeletonChange(){const o=()=>{var e;const t=this._univerInstanceService.getCurrentUnitForType(m.UNIVER_SHEET);if(!t)return;const r=t.getUnitId(),s=this._renderManagerService.getRenderById(r);(e=s==null?void 0:s.mainComponent)==null||e.makeForceDirty()};this.disposeWithMe(this._sheetsNoteModel.change$.pipe(Se(16)).subscribe(()=>{o()}))}};G=Vt([A(0,p(Ie)),A(1,p(d)),A(2,ie),A(3,N)],G);const ae="SHEET_NOTE_COMPONENT";var Lt=(o,e,t,r)=>{for(var s=e,i=o.length-1,n;i>=0;i--)(n=o[i])&&(s=n(s)||s);return s},pe=(o,e)=>(t,r)=>e(t,r,o);let $=class extends C{constructor(o,e){super(),b(this,"_lastPopup",null),b(this,"_activePopup"),b(this,"_activePopup$",new Xe(null)),b(this,"activePopup$",this._activePopup$.asObservable()),this._zenZoneService=o,this._cellPopupManagerService=e,this._initZenVisible(),this.disposeWithMe(()=>{this._activePopup$.complete()})}get activePopup(){return this._activePopup}_initZenVisible(){this.disposeWithMe(this._zenZoneService.visible$.subscribe(o=>{o&&this.hidePopup()}))}dispose(){super.dispose(),this.hidePopup()}showPopup(o,e){var t;const{row:r,col:s,unitId:i,subUnitId:n}=o;if(this._activePopup&&r===this._activePopup.row&&s===this._activePopup.col&&i===this._activePopup.unitId&&n===((t=this.activePopup)==null?void 0:t.subUnitId)){this._activePopup=o,this._activePopup$.next(o);return}if(this._lastPopup&&this._lastPopup.dispose(),this._zenZoneService.visible)return;this._activePopup=o,this._activePopup$.next(o);const a=this._cellPopupManagerService.showPopup({unitId:i,subUnitId:n,row:r,col:s},{componentKey:ae,onClickOutside:()=>{this.hidePopup()},direction:"horizontal",extraProps:{location:o},priority:3});if(!a)throw new Error("[SheetsNotePopupService]: cannot show popup!");const h=new Qe;h.add(a),h.add({dispose:()=>{e==null||e()}}),this._lastPopup=h}hidePopup(o){this._activePopup&&(!o&&!this._activePopup.temp||(this._lastPopup&&this._lastPopup.dispose(),this._lastPopup=null,this._activePopup=null,this._activePopup$.next(null)))}persistPopup(){!this._activePopup||!this._activePopup.temp||(this._activePopup={...this._activePopup,temp:!1},this._activePopup$.next(this._activePopup))}};$=Lt([pe(0,ft),pe(1,p(Ee))],$);var Ot=(o,e,t,r)=>{for(var s=e,i=o.length-1,n;i>=0;i--)(n=o[i])&&(s=n(s)||s);return s},M=(o,e)=>(t,r)=>e(t,r,o);let K=class extends C{constructor(e,t,r,s,i,n){super(),b(this,"_isSwitchingSheet",!1),this._sheetsNotePopupService=e,this._sheetsNoteModel=t,this._sheetSelectionService=r,this._editorBridgeService=s,this._renderManagerService=i,this._hoverManagerService=n,this._initSelectionUpdateListener(),this._initEditorBridge(),this._initHoverEvent()}_handleSelectionChange(e,t,r){var s,i,n;const a=(s=e[0])==null?void 0:s.range,h=this._renderManagerService.getRenderById(t),u=(i=h==null?void 0:h.with(lt).getSkeletonParam(r))==null?void 0:i.skeleton;if(!u||!a)return;const l=u.getCellWithCoordByIndex(a.startRow,a.startColumn);if((((n=a.rangeType)!=null?n:le.NORMAL)!==le.NORMAL||a.endColumn-a.startColumn>0||a.endRow-a.startRow>0)&&!((l.isMerged||l.isMergedMainCell)&&Ye.equals(l.mergeInfo,a))){this._sheetsNotePopupService.hidePopup();return}const c=l.actualRow,_=l.actualColumn,v=this._sheetsNoteModel.getNote(t,r,c,_);v!=null&&v.show||(v?this._sheetsNotePopupService.showPopup({unitId:t,subUnitId:r,row:c,col:_}):this._sheetsNotePopupService.hidePopup(!0))}_initSelectionUpdateListener(){this.disposeWithMe(this._sheetSelectionService.selectionMoveEnd$.subscribe(e=>{if(this._isSwitchingSheet)return;const t=this._sheetSelectionService.currentSelectionParam;t&&this._handleSelectionChange(e,t.unitId,t.sheetId)}))}_initEditorBridge(){this.disposeWithMe(this._editorBridgeService.visible$.subscribe(e=>{e.visible&&this._sheetsNotePopupService.hidePopup(!0)}))}_initHoverEvent(){this.disposeWithMe(this._hoverManagerService.currentCell$.pipe(Se(100)).subscribe(e=>{if(!(e!=null&&e.location))return;const{unitId:t,subUnitId:r,row:s,col:i}=e.location,n=this._sheetsNoteModel.getNote(t,r,s,i);n!=null&&n.show||(n?this._sheetsNotePopupService.showPopup({unitId:t,subUnitId:r,row:s,col:i,temp:!0}):this._sheetsNotePopupService.hidePopup())}))}};K=Ot([M(0,p($)),M(1,p(d)),M(2,p(U)),M(3,wt),M(4,ie),M(5,p(_t))],K);const He="sheets-note-ui.config",ge={};var Bt=(o,e,t,r)=>{for(var s=e,i=o.length-1,n;i>=0;i--)(n=o[i])&&(s=n(s)||s);return s},D=(o,e)=>(t,r)=>e(t,r,o);let Y=class extends C{constructor(o,e,t,r){super(),b(this,"_noteMatrix",new W),this._sheetsNoteModel=o,this._univerInstanceService=e,this._cellPopupManagerService=t,this._sheetsNotePopupService=r,this._initNoteChangeListener()}_showPopup(o,e,t,r){return this._sheetsNotePopupService.hidePopup(!0),this._cellPopupManagerService.showPopup({unitId:o,subUnitId:e,row:t,col:r},{componentKey:ae,direction:"horizontal",extraProps:{location:{unitId:o,subUnitId:e,row:t,col:r}},priority:3})}dispose(){super.dispose(),this._noteMatrix.forValue((o,e,t)=>{t.dispose()})}_initSheet(o,e){var t;this._noteMatrix.forValue((s,i,n)=>{n.dispose()}),this._noteMatrix=new W;const r=(s,i,n,a,h)=>{const u=this._noteMatrix,l=u.getValue(n,a);if(h!=null&&h.show){if(!l){const c=this._showPopup(s,i,n,a);c&&u.setValue(n,a,c)}}else l&&(l.dispose(),u.realDeleteValue(n,a))};return(t=this._sheetsNoteModel.getSheetNotes(o,e))==null||t.forValue((s,i,n)=>{r(o,e,s,i,n)}),this._sheetsNoteModel.change$.subscribe(s=>{if(!(s.unitId!==o||s.sheetId!==e))switch(s.type){case"ref":{const{unitId:i,sheetId:n,row:a,col:h,newPosition:u,note:l}=s,c=this._noteMatrix;if(!l.show)return;const _=c.getValue(a,h);_&&(_.dispose(),c.realDeleteValue(a,h));const v=this._showPopup(i,n,u.row,u.col);v&&c.setValue(u.row,u.col,v);break}case"update":{const{unitId:i,sheetId:n,row:a,col:h,note:u}=s;r(i,n,a,h,u);break}}})}_initNoteChangeListener(){this.disposeWithMe(this._univerInstanceService.getCurrentTypeOfUnit$(m.UNIVER_SHEET).pipe(ct(o=>{var e;return(e=o==null?void 0:o.activeSheet$)!=null?e:et(null)})).subscribe(o=>{if(o){const e=this._initSheet(o.getUnitId(),o.getSheetId());return()=>{e.unsubscribe()}}else this._noteMatrix.forValue((e,t,r)=>{r.dispose()}),this._noteMatrix=new W}))}};Y=Bt([D(0,p(d)),D(1,p(N)),D(2,p(Ee)),D(3,p($))],Y);function ee({ref:o,...e}){const{icon:t,id:r,className:s,extend:i,...n}=e,a=`univerjs-icon univerjs-icon-${r} ${s||""}`.trim(),h=g.useRef(`_${Dt()}`);return Re(t,`${r}`,{defIds:t.defIds,idSuffix:h.current},{ref:o,className:a,...n},i)}function Re(o,e,t,r,s){return g.createElement(o.tag,{key:e,...jt(o,t,s),...r},(At(o,t).children||[]).map((i,n)=>Re(i,`${e}-${o.tag}-${n}`,t,void 0,s)))}function jt(o,e,t){const r={...o.attrs};t!=null&&t.colorChannel1&&r.fill==="colorChannel1"&&(r.fill=t.colorChannel1),o.tag==="mask"&&r.id&&(r.id=r.id+e.idSuffix),Object.entries(r).forEach(([i,n])=>{i==="mask"&&typeof n=="string"&&(r[i]=n.replace(/url\(#(.*)\)/,`url(#$1${e.idSuffix})`))});const{defIds:s}=e;return!s||s.length===0||(o.tag==="use"&&r["xlink:href"]&&(r["xlink:href"]=r["xlink:href"]+e.idSuffix),Object.entries(r).forEach(([i,n])=>{typeof n=="string"&&(r[i]=n.replace(/url\(#(.*)\)/,`url(#$1${e.idSuffix})`))})),r}function At(o,e){var t;const{defIds:r}=e;return!r||r.length===0?o:o.tag==="defs"&&(t=o.children)!=null&&t.length?{...o,children:o.children.map(s=>typeof s.attrs.id=="string"&&r&&r.includes(s.attrs.id)?{...s,attrs:{...s.attrs,id:s.attrs.id+e.idSuffix}}:s)}:o}function Dt(){return Math.random().toString(36).substring(2,8)}ee.displayName="UniverIcon";const Wt={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M12.8481 8.00049V3.87451C12.8481 3.13737 12.2503 2.5398 11.5132 2.53955H4.48682C3.74952 2.53955 3.15186 3.13721 3.15186 3.87451V12.1255C3.15186 12.8628 3.74952 13.4604 4.48682 13.4604H6.99951L7.1333 13.4741C7.43655 13.536 7.66454 13.804 7.66455 14.1255C7.66455 14.447 7.43655 14.715 7.1333 14.7769L6.99951 14.7905H4.48682C3.01498 14.7905 1.82178 13.5973 1.82178 12.1255V3.87451C1.82178 2.40267 3.01498 1.20947 4.48682 1.20947H11.5132C12.9848 1.20972 14.1772 2.40283 14.1772 3.87451V8.00049C14.177 8.36738 13.8801 8.6643 13.5132 8.66455C13.1461 8.66455 12.8484 8.36754 12.8481 8.00049Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M10.1463 4.53859L10.2801 4.55226C10.5832 4.61419 10.8113 4.8822 10.8113 5.20363C10.8113 5.52506 10.5832 5.79306 10.2801 5.85499L10.1463 5.86867H5.85331C5.48604 5.86867 5.18827 5.5709 5.18827 5.20363C5.18827 4.83636 5.48604 4.53859 5.85331 4.53859H10.1463Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M8.11307 7.33497L8.24686 7.34865C8.54984 7.41069 8.77811 7.67869 8.77811 8.00001C8.77811 8.32134 8.54984 8.58933 8.24686 8.65138L8.11307 8.66505H5.85331C5.48604 8.66505 5.18827 8.36728 5.18827 8.00001C5.18827 7.63274 5.48604 7.33497 5.85331 7.33497H8.11307Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M6.98319 10.1314L7.11698 10.145C7.42003 10.207 7.64823 10.475 7.64823 10.7964C7.64823 11.1178 7.42003 11.3858 7.11698 11.4478L6.98319 11.4614H5.85331C5.48604 11.4614 5.18827 11.1637 5.18827 10.7964C5.18827 10.4291 5.48604 10.1314 5.85331 10.1314H6.98319Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M10.8813 14.4312V10.2925C10.8813 9.92522 11.1791 9.62745 11.5463 9.62745C11.9136 9.62745 12.2114 9.92522 12.2114 10.2925V14.4312C12.2112 14.7983 11.9135 15.0962 11.5463 15.0962C11.1791 15.0962 10.8814 14.7983 10.8813 14.4312Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M9.47697 11.6968H11.5463H13.6156C13.9829 11.6968 14.2807 11.9946 14.2807 12.3618C14.2807 12.7291 13.9829 13.0269 13.6156 13.0269H9.47697C9.10981 13.0267 8.81193 12.729 8.81193 12.3618C8.81193 11.9946 9.10981 11.6969 9.47697 11.6968Z"}}]},Te=g.forwardRef(function(o,e){return g.createElement(ee,Object.assign({},o,{id:"add-note-icon",ref:e,icon:Wt}))});Te.displayName="AddNoteIcon";const Zt={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M12.8481 8.00049V3.87451C12.8481 3.13737 12.2503 2.5398 11.5132 2.53955H4.48682C3.74952 2.53955 3.15186 3.13721 3.15186 3.87451V12.1255C3.15186 12.8628 3.74952 13.4604 4.48682 13.4604H6.99951L7.1333 13.4741C7.43655 13.536 7.66454 13.804 7.66455 14.1255C7.66455 14.447 7.43655 14.715 7.1333 14.7769L6.99951 14.7905H4.48682C3.01498 14.7905 1.82178 13.5973 1.82178 12.1255V3.87451C1.82178 2.40267 3.01498 1.20947 4.48682 1.20947H11.5132C12.9848 1.20972 14.1772 2.40283 14.1772 3.87451V8.00049C14.177 8.36738 13.8801 8.6643 13.5132 8.66455C13.1461 8.66455 12.8484 8.36754 12.8481 8.00049Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M10.1463 4.53859L10.2801 4.55226C10.5832 4.61419 10.8113 4.8822 10.8113 5.20363C10.8113 5.52506 10.5832 5.79306 10.2801 5.85499L10.1463 5.86867H5.85331C5.48604 5.86867 5.18827 5.5709 5.18827 5.20363C5.18827 4.83636 5.48604 4.53859 5.85331 4.53859H10.1463Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M8.11307 7.33497L8.24686 7.34865C8.54984 7.41069 8.77811 7.67869 8.77811 8.00001C8.77811 8.32134 8.54984 8.58933 8.24686 8.65138L8.11307 8.66505H5.85331C5.48604 8.66505 5.18827 8.36728 5.18827 8.00001C5.18827 7.63274 5.48604 7.33497 5.85331 7.33497H8.11307Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M6.98319 10.1314L7.11698 10.145C7.42003 10.207 7.64823 10.475 7.64823 10.7964C7.64823 11.1178 7.42003 11.3858 7.11698 11.4478L6.98319 11.4614H5.85331C5.48604 11.4614 5.18827 11.1637 5.18827 10.7964C5.18827 10.4291 5.48604 10.1314 5.85331 10.1314H6.98319Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M9.47489 11.6968H13.6175C13.9847 11.6968 14.2825 11.9946 14.2825 12.3618C14.2825 12.7291 13.9847 13.0269 13.6175 13.0269H9.47489C9.10762 13.0269 8.80985 12.7291 8.80985 12.3618C8.80985 11.9946 9.10762 11.6968 9.47489 11.6968Z"}}]},Ve=g.forwardRef(function(o,e){return g.createElement(ee,Object.assign({},o,{id:"delete-note-icon",ref:e,icon:Zt}))});Ve.displayName="DeleteNoteIcon";const zt={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M12.8481 8.00049V3.87451C12.8481 3.13737 12.2503 2.5398 11.5132 2.53955H4.48682C3.74952 2.53955 3.15186 3.13721 3.15186 3.87451V12.1255C3.15186 12.8628 3.74952 13.4604 4.48682 13.4604H6.99951L7.1333 13.4741C7.43655 13.536 7.66454 13.804 7.66455 14.1255C7.66455 14.447 7.43655 14.715 7.1333 14.7769L6.99951 14.7905H4.48682C3.01498 14.7905 1.82178 13.5973 1.82178 12.1255V3.87451C1.82178 2.40267 3.01498 1.20947 4.48682 1.20947H11.5132C12.9848 1.20972 14.1772 2.40283 14.1772 3.87451V8.00049C14.177 8.36738 13.8801 8.6643 13.5132 8.66455C13.1461 8.66455 12.8484 8.36754 12.8481 8.00049Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M10.1463 4.53859L10.2801 4.55226C10.5832 4.61419 10.8113 4.8822 10.8113 5.20363C10.8113 5.52506 10.5832 5.79306 10.2801 5.85499L10.1463 5.86867H5.85331C5.48604 5.86867 5.18827 5.5709 5.18827 5.20363C5.18827 4.83636 5.48604 4.53859 5.85331 4.53859H10.1463Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M8.11307 7.33497L8.24686 7.34865C8.54984 7.41069 8.77811 7.67869 8.77811 8.00001C8.77811 8.32134 8.54984 8.58933 8.24686 8.65138L8.11307 8.66505H5.85331C5.48604 8.66505 5.18827 8.36728 5.18827 8.00001C5.18827 7.63274 5.48604 7.33497 5.85331 7.33497H8.11307Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M6.98319 10.1314L7.11698 10.145C7.42003 10.207 7.64823 10.475 7.64823 10.7964C7.64823 11.1178 7.42003 11.3858 7.11698 11.4478L6.98319 11.4614H5.85331C5.48604 11.4614 5.18827 11.1637 5.18827 10.7964C5.18827 10.4291 5.48604 10.1314 5.85331 10.1314H6.98319Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M13.8743 12.6147C13.8742 12.5394 13.7749 12.2553 13.3909 11.9477C13.039 11.6659 12.5573 11.4614 12.0394 11.4614C11.5213 11.4614 11.0398 11.6666 10.6878 11.9487C10.3037 12.2565 10.2045 12.5399 10.2044 12.6147C10.2044 12.6893 10.3034 12.9737 10.6878 13.2817C11.0398 13.5636 11.5215 13.768 12.0394 13.768C12.5574 13.768 13.039 13.5635 13.3909 13.2817C13.7751 12.9739 13.8743 12.6897 13.8743 12.6147ZM15.2044 12.6147C15.2044 13.2772 14.7436 13.9027 14.223 14.3198C13.6701 14.7627 12.9019 15.0981 12.0394 15.0981C11.1768 15.0981 10.4085 14.7627 9.85577 14.3198C9.33533 13.9027 8.87433 13.2769 8.87433 12.6147C8.8744 11.9526 9.33541 11.3276 9.85577 10.9106C10.4086 10.4676 11.1767 10.1313 12.0394 10.1313C12.9018 10.1313 13.6701 10.4668 14.223 10.9096C14.7435 11.3267 15.2043 11.9523 15.2044 12.6147Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M12.0394 13.299C12.4172 13.299 12.7234 12.9927 12.7234 12.6149C12.7234 12.2371 12.4172 11.9308 12.0394 11.9308C11.6616 11.9308 11.3553 12.2371 11.3553 12.6149C11.3553 12.9927 11.6616 13.299 12.0394 13.299Z"}}]},Le=g.forwardRef(function(o,e){return g.createElement(ee,Object.assign({},o,{id:"hide-note-icon",ref:e,icon:zt}))});Le.displayName="HideNoteIcon";const X={id:"sheet.operation.add-note-popup",type:S.OPERATION,handler:async(o,e)=>{const t=o.get(U),r=o.get($),s=o.get(N).getCurrentUnitForType(m.UNIVER_SHEET);if(!s)return!1;const i=s.getActiveSheet(),n=t.getCurrentLastSelection();if(!(n!=null&&n.primary))return!1;const{primary:a}=n;return r.showPopup({unitId:s.getUnitId(),subUnitId:i.getSheetId(),row:a.actualRow,col:a.actualColumn,temp:!1,trigger:e==null?void 0:e.trigger}),!0}},Ft=o=>{var e;const{popup:t}=o,r=O(d),s=O(Ke),i=O(ie),n=ht(He),a=(e=t.extraProps)==null?void 0:e.location;if(!a)return console.error("Popup extraProps or location is undefined."),null;const h=g.useRef(null),u=i.getRenderById(a.unitId),[l,c]=g.useState(null);g.useEffect(()=>{var f,I;const{unitId:L,subUnitId:Ae,row:De,col:We}=a,{width:Ze=160,height:ze=72}=(f=n==null?void 0:n.defaultNoteSize)!=null?f:{},te=(I=r.getNote(L,Ae,De,We))!=null?I:{width:Ze,height:ze,note:""};h.current&&(c(te),h.current.style.width=`${te.width}px`,h.current.style.height=`${te.height}px`)},[a,h]);const _=O(w),v=ut(f=>{a&&(f.note?_.executeCommand(z.id,{unitId:a.unitId,sheetId:a.subUnitId,row:a.row,col:a.col,note:f}):_.executeCommand(V.id,{unitId:a.unitId,sheetId:a.subUnitId,row:a.row,col:a.col}))}),Be=g.useCallback(f=>{if(!l)return;const I={...l,note:f};c(I),v(I)},[l]),je=g.useCallback((f,I)=>{if(!l)return;const L={...l,width:f,height:I};c(L),v(L)},[l]);return Ct.jsx(St,{ref:h,"data-u-comp":"note-textarea",className:It("univer-ml-px univer-min-h-1 univer-min-w-1 univer-bg-white !univer-text-sm univer-shadow dark:!univer-bg-gray-800"),value:l==null?void 0:l.note,placeholder:s.t("note.placeholder"),onResize:je,onValueChange:Be,onWheel:f=>{document.activeElement!==h.current&&u.engine.getCanvasElement().dispatchEvent(new WheelEvent(f.type,f.nativeEvent))}})};function he(o){const e=o.get(U),t=o.get(N);return e.selectionMoveEnd$.pipe(P(()=>{const r=e.getCurrentLastSelection();if(!(r!=null&&r.primary))return!1;const s=re(t);if(!s)return!1;const{actualColumn:i,actualRow:n}=r.primary;return!!o.get(d).getNote(s.unitId,s.subUnitId,n,i)}))}function qt(o){return{id:X.id,type:ne.BUTTON,title:"rightClick.addNote",icon:"AddNoteIcon",hidden$:tt([gt(o,m.UNIVER_SHEET),he(o)]).pipe(P(([e,t])=>e||t)),disabled$:Ne(o,{workbookTypes:[Me],worksheetTypes:[be]}),commandId:X.id}}function Jt(o){return{id:V.id,type:ne.BUTTON,title:"rightClick.deleteNote",icon:"DeleteNoteIcon",hidden$:he(o).pipe(P(e=>!e)),disabled$:Ne(o,{workbookTypes:[Me],worksheetTypes:[be]})}}function Gt(o){return{id:R.id,type:ne.BUTTON,title:"rightClick.toggleNote",icon:"HideNoteIcon",hidden$:he(o).pipe(P(e=>!e))}}const Kt={[dt.MAIN_AREA]:{[pt.OTHERS]:{order:0,[X.id]:{order:0,menuItemFactory:qt},[V.id]:{order:0,menuItemFactory:Jt},[R.id]:{order:0,menuItemFactory:Gt}}}};var Yt=(o,e,t,r)=>{for(var s=e,i=o.length-1,n;i>=0;i--)(n=o[i])&&(s=n(s)||s);return s},oe=(o,e)=>(t,r)=>e(t,r,o);let Q=class extends C{constructor(e,t,r){super(),this._componentManager=e,this._menuManagerService=t,this._commandService=r,this._initComponents(),this._initMenu(),this._initCommands()}_initComponents(){[[ae,Ft],["AddNoteIcon",Te],["DeleteNoteIcon",Ve],["HideNoteIcon",Le]].forEach(([e,t])=>{this.disposeWithMe(this._componentManager.register(e,t))})}_initMenu(){this._menuManagerService.mergeMenu(Kt)}_initCommands(){this._commandService.registerCommand(X)}};Q=Yt([oe(0,p(vt)),oe(1,p(mt)),oe(2,w)],Q);var Xt=Object.defineProperty,Qt=(o,e,t)=>e in o?Xt(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t,eo=(o,e,t,r)=>{for(var s=e,i=o.length-1,n;i>=0;i--)(n=o[i])&&(s=n(s)||s);return s},fe=(o,e)=>(t,r)=>e(t,r,o),Oe=(o,e,t)=>Qt(o,typeof e!="symbol"?e+"":e,t);const to="SHEET_NOTE_UI_PLUGIN";let T=class extends we{constructor(o=ge,e,t){super(),this._config=o,this._injector=e,this._configService=t;const{menu:r,...s}=_e({},ge,this._config);r&&this._configService.setConfig("menu",r,{merge:!0}),this._configService.setConfig(He,s)}onStarting(){[[$],[G],[K],[Q],[Y]].forEach(o=>{this._injector.add(o)})}onReady(){Z(this._injector,[[Q],[G]])}onRendered(){Z(this._injector,[[K],[Y]])}};Oe(T,"pluginName",to);Oe(T,"type",m.UNIVER_SHEET);T=eo([ve(y),fe(1,p(Ce)),fe(2,me)],T);class oo{get SheetNoteAdd(){return"SheetNoteAdd"}get SheetNoteDelete(){return"SheetNoteDelete"}get SheetNoteUpdate(){return"SheetNoteUpdate"}get SheetNoteShow(){return"SheetNoteShow"}get SheetNoteHide(){return"SheetNoteHide"}get BeforeSheetNoteAdd(){return"BeforeSheetNoteAdd"}get BeforeSheetNoteDelete(){return"BeforeSheetNoteDelete"}get BeforeSheetNoteUpdate(){return"BeforeSheetNoteUpdate"}get BeforeSheetNoteShow(){return"BeforeSheetNoteShow"}get BeforeSheetNoteHide(){return"BeforeSheetNoteHide"}}Nt.extend(oo);class so extends ke{createOrUpdateNote(e){return this._commandService.syncExecuteCommand(k.id,{unitId:this.getUnitId(),sheetId:this.getSheetId(),row:this.getRow(),col:this.getColumn(),note:e}),this}deleteNote(){return this._commandService.syncExecuteCommand(x.id,{unitId:this.getUnitId(),sheetId:this.getSheetId(),row:this.getRow(),col:this.getColumn()}),this}getNote(){return this._injector.get(d).getNote(this.getUnitId(),this.getSheetId(),this.getRow(),this.getColumn())}}ke.extend(so);class ro extends Pe{_initialize(e){this.registerEventHandler(this.Event.SheetNoteAdd,()=>e.get(d).change$.subscribe(t=>{if(t.type==="update"&&!t.oldNote&&t.note){const{unitId:r,sheetId:s,row:i,col:n,note:a,oldNote:h}=t,u=this.getSheetTarget(r,s);if(!u)return;const{workbook:l,worksheet:c}=u;this.fireEvent(this.Event.SheetNoteAdd,{workbook:l,worksheet:c,row:i,col:n,note:a})}})),this.registerEventHandler(this.Event.SheetNoteDelete,()=>e.get(d).change$.subscribe(t=>{if(t.type==="update"&&t.oldNote&&!t.note){const{unitId:r,sheetId:s,row:i,col:n,note:a,oldNote:h}=t,u=this.getSheetTarget(r,s);if(!u)return;const{workbook:l,worksheet:c}=u;this.fireEvent(this.Event.SheetNoteDelete,{workbook:l,worksheet:c,row:i,col:n,oldNote:h})}})),this.registerEventHandler(this.Event.SheetNoteUpdate,()=>e.get(d).change$.subscribe(t=>{if(t.type==="update"&&t.oldNote&&t.note){const{unitId:r,sheetId:s,row:i,col:n,note:a,oldNote:h}=t,u=this.getSheetTarget(r,s);if(!u)return;const{workbook:l,worksheet:c}=u;this.fireEvent(this.Event.SheetNoteUpdate,{workbook:l,worksheet:c,row:i,col:n,note:a,oldNote:h})}})),this.registerEventHandler(this.Event.SheetNoteShow,()=>e.get(d).change$.subscribe(t=>{if(t.type==="update"&&t.oldNote&&t.note&&!t.oldNote.show&&t.note.show){const{unitId:r,sheetId:s,row:i,col:n}=t,a=this.getSheetTarget(r,s);if(!a)return;const{workbook:h,worksheet:u}=a;this.fireEvent(this.Event.SheetNoteShow,{workbook:h,worksheet:u,row:i,col:n})}})),this.registerEventHandler(this.Event.SheetNoteHide,()=>e.get(d).change$.subscribe(t=>{if(t.type==="update"&&t.oldNote&&t.note&&t.oldNote.show&&!t.note.show){const{unitId:r,sheetId:s,row:i,col:n}=t,a=this.getSheetTarget(r,s);if(!a)return;const{workbook:h,worksheet:u}=a;this.fireEvent(this.Event.SheetNoteHide,{workbook:h,worksheet:u,row:i,col:n})}})),this.registerEventHandler(this.Event.BeforeSheetNoteAdd,()=>e.get(w).beforeCommandExecuted(t=>{if(t.id===z.id){const r=e.get(d),{unitId:s,sheetId:i,row:n,col:a,note:h}=t.params;if(r.getNote(s,i,n,a))return;const u=this.getSheetTarget(s,i);if(!u)return;const{workbook:l,worksheet:c}=u;if(this.fireEvent(this.Event.BeforeSheetNoteAdd,{workbook:l,worksheet:c,row:n,col:a,note:h}))throw new H}})),this.registerEventHandler(this.Event.BeforeSheetNoteDelete,()=>e.get(w).beforeCommandExecuted(t=>{if(t.id===V.id){const r=e.get(d),{unitId:s,sheetId:i,row:n,col:a}=t.params,h=r.getNote(s,i,n,a);if(!h)return;const u=this.getSheetTarget(s,i);if(!u)return;const{workbook:l,worksheet:c}=u;if(this.fireEvent(this.Event.BeforeSheetNoteDelete,{workbook:l,worksheet:c,row:n,col:a,oldNote:h}))throw new H}})),this.registerEventHandler(this.Event.BeforeSheetNoteUpdate,()=>e.get(w).beforeCommandExecuted(t=>{if(t.id===z.id){const r=e.get(d),{unitId:s,sheetId:i,row:n,col:a,note:h}=t.params,u=r.getNote(s,i,n,a);if(!u)return;const l=this.getSheetTarget(s,i);if(!l)return;const{workbook:c,worksheet:_}=l;if(this.fireEvent(this.Event.BeforeSheetNoteUpdate,{workbook:c,worksheet:_,row:n,col:a,note:h,oldNote:u}))throw new H}})),this.registerEventHandler(this.Event.BeforeSheetNoteShow,()=>e.get(w).beforeCommandExecuted(t=>{if(t.id===R.id){const r=e.get(d),{unitId:s,sheetId:i,row:n,col:a}=t.params,h=r.getNote(s,i,n,a);if(h!=null&&h.show)return;const u=this.getSheetTarget(s,i);if(!u)return;const{workbook:l,worksheet:c}=u;if(this.fireEvent(this.Event.BeforeSheetNoteShow,{workbook:l,worksheet:c,row:n,col:a}))throw new H}})),this.registerEventHandler(this.Event.BeforeSheetNoteHide,()=>e.get(w).beforeCommandExecuted(t=>{if(t.id===R.id){const r=e.get(d),{unitId:s,sheetId:i,row:n,col:a}=t.params,h=r.getNote(s,i,n,a);if(!(h!=null&&h.show))return;const u=this.getSheetTarget(s,i);if(!u)return;const{workbook:l,worksheet:c}=u;if(this.fireEvent(this.Event.BeforeSheetNoteHide,{workbook:l,worksheet:c,row:n,col:a}))throw new H}}))}}Pe.extend(ro);class io extends xe{getNotes(){const e=this._injector.get(d).getSheetNotes(this.getWorkbook().getUnitId(),this.getSheetId()),t=[];return e==null||e.forValue((r,s,i)=>{t.push({...i,row:r,col:s})}),t}}xe.extend(io);function Mo(){return{plugins:[y,T].filter(o=>!!o)}}export{x as RemoveNoteMutation,V as SheetDeleteNoteCommand,R as SheetToggleNotePopupCommand,z as SheetUpdateNoteCommand,G as SheetsCellContentController,Ft as SheetsNote,d as SheetsNoteModel,K as SheetsNotePopupController,$ as SheetsNotePopupService,F as SheetsNoteResourceController,ye as ToggleNotePopupMutation,y as UniverSheetsNotePlugin,Mo as UniverSheetsNotePreset,T as UniverSheetsNoteUIPlugin,k as UpdateNoteMutation,se as UpdateNotePositionMutation};
