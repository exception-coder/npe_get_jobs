const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DmlX_rKD.js","assets/index--BQDx9CP.js","assets/facade-DLk4o3Z_.js","assets/index-mJOBftNs.js","assets/index-jYk1DC1C.css","assets/index-DpLQClwC.js","assets/index-DNSnhRIr.js","assets/index-HOPa4z_M.js","assets/facade-DJ8otAmv.js","assets/facade-CGdyi3nR.js","assets/facade-B81SwhRe.js","assets/VRow-C6N6h8s9.js","assets/VCard-DFIDGoOa.js","assets/VCard-B40-Wxk8.css","assets/VSelect-CO5xudFf.js","assets/VTextField-tFIcna6m.js","assets/VTextField-gHlWtCpv.css","assets/VSelect-U4lLcAWS.css","assets/VTabs-BYSgCciz.js","assets/VTabs-CzeXSdBX.css","assets/VAlert-CfJUBCCM.js","assets/VAlert-DKoNCXB3.css","assets/VDialog-C4Wnh1zS.js","assets/VDialog-DwTSAOeg.css","assets/VFileInput-DBMVcNlc.js","assets/VFileInput-Dwzvf-gD.css","assets/VTextarea-34QBZFhW.js","assets/VTextarea-DyGjqrlm.css","assets/zh-CN-xOisK4Uq.js","assets/zh-CN-B48BrrS_.js","assets/zh-CN-ChZCXZZo.js","assets/zh-CN-qu9fEDDQ.js","assets/zh-CN-CMpc34zJ.js","assets/index-BfodAgep.js","assets/index-ChzpeWOG.js","assets/index-CMH43F1L.js","assets/zh-CN-D_K-QYkk.js","assets/index-eadENTDt.js","assets/index-DT5UJx9J.js","assets/index-R4J-DW51.js","assets/index-BSbE54n6.js","assets/zh-CN-BOY75vfx.js","assets/index-CUSErzTo.js","assets/index-Ctp6PiU5.js","assets/index-BLK1e6H_.js","assets/zh-CN-BIOSCCvr.js","assets/index-ZDhi2AlF.js","assets/index-BANiMnH0.js","assets/zh-CN-C9rKiknf.js","assets/index-Dw2BL3sx.js","assets/zh-CN-DeMubXS5.js","assets/index-C11Z-l5D.js","assets/zh-CN-DtSw1neC.js","assets/index-cNrruVyW.js","assets/index-CGM0O1y3.js","assets/zh-CN-Cq9YoPLF.js","assets/index-Cyj3sZL9.js","assets/index-DhqLArvi.js","assets/index-DTw3uDfQ.js","assets/zh-CN-DDLUFfit.js","assets/index-DtimQMRL.js","assets/zh-CN-C2A9wNmZ.js","assets/index-DzOU75Ez.js","assets/index-DBDjDJo6.js","assets/zh-CN-DYst2D4Y.js","assets/index-BeW_XPYD.js","assets/index-Dr6YZKPb.js","assets/zh-CN-BGdhnYO5.js","assets/index-C4CTCmIG.js","assets/index-BJN7B7wt.js","assets/zh-CN-BufWVU5I.js","assets/index-DIT-jVrB.js"])))=>i.map(i=>d[i]);
var mf=Object.defineProperty;var _f=(t,e,n)=>e in t?mf(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var pe=(t,e,n)=>_f(t,typeof e!="symbol"?e+"":e,n);import{a as ho,h as $c,k as Ht,u as Hc,bv as Mt,w as Hs,bc as jc,d as yf,_ as Il,m as ze,r as vf,p as jn,o as Se,e as Tt,b as At,X as Ef,Q as ge,g as Xt,V as Sl,f as Vn,l as bf,y as Mo,x as ln,j as un,a0 as Al,c as Wn,aQ as Cf,a9 as Rf,F as Lo,bw as Ol,q as Tf,a1 as wf}from"./index-mJOBftNs.js";import{a as If,V as Sf}from"./VRow-C6N6h8s9.js";import{V as Fo,a as ko,b as Po,c as Dl}from"./VCard-DFIDGoOa.js";import{V as xl}from"./VSelect-CO5xudFf.js";import{V as Af,b as Nl,d as Of,e as Ml}from"./VTabs-BYSgCciz.js";import{V as Df}from"./VAlert-CfJUBCCM.js";import{V as Ll}from"./VTextField-tFIcna6m.js";import{V as Fl}from"./VDialog-C4Wnh1zS.js";import{V as xf}from"./VFileInput-DBMVcNlc.js";import{V as kl}from"./VTextarea-34QBZFhW.js";const Cr="/api/webdocs/team-spreadsheets",Nf=async()=>ho(Cr),Mf=async t=>ho(`${Cr}/${t}`),Lf=async t=>ho(`${Cr}/${t}/table`),Ff=async(t,e)=>$c(`${Cr}/${t}`,{method:"PUT",body:JSON.stringify(e)}),kf=async(t,e)=>{const n=e?`?${new URLSearchParams({title:e}).toString()}`:"";await $c(`${Cr}/${t}${n}`,{method:"DELETE"})},Pf=async t=>ho(`${Cr}/import`,{method:"POST",body:t});let Uo=null;const da=()=>(Uo||(Uo={containerRef:Ht(null),activeDocumentId:Ht(null),initializing:Ht(!1),autoSaving:Ht(!1),lastSavedAt:Ht(null),currentDocumentTitle:Ht(null)}),Uo),ha=Symbol("$$IDENTIFIER_DECORATOR");function Uf(t){return t&&t[ha]===!0}function Vc(t){return typeof t=="function"}function Pl(t){return!!(t&&typeof t.useClass<"u")}function Ul(t){return!!(t&&typeof t.useFactory<"u")}function Bl(t){return!!(t&&typeof t.useValue<"u")}function Bf(t){return!!(t&&typeof t.useExisting<"u")}function $l(t){return!!(t&&typeof t.useAsync<"u")}const Wc=Symbol("AsyncHook");function Bo(t){return!!(t&&t.__symbol===Wc)}function ye(t){return Vc(t)&&!t[ha]?t.name:t.toString()}var Le=class extends Error{constructor(t){super(`[redi]: ${t}`)}};let Ut=function(t){return t.MANY="many",t.OPTIONAL="optional",t.REQUIRED="required",t}({}),Nn=function(t){return t.SELF="self",t.SKIP_SELF="skipSelf",t}({});const Hl=Symbol("$$TARGET"),fi=Symbol("$$DEPENDENCIES");var $f=class extends Le{constructor(t,e){const n=`Could not find dependency registered on the ${t} (indexed) parameter of the constructor of "${ye(e)}".`;super(n)}},Hf=class extends Le{constructor(t,e){const n=`It seems that you forgot to provide a parameter to @Required() on the ${e}th parameter of "${ye(t)}"`;super(n)}},jf=class extends Le{constructor(t,e){const n=`It seems that you register "undefined" as dependency on the ${e}th parameter of "${ye(t)}". Please make sure that there is not cyclic dependency among your TypeScript files, or consider using "forwardRef". For more info please visit our website https://redi.wendell.fun/docs/faq#could-not-find-dependency-registered-on`;super(n)}};function Gc(t){return t[fi]||[]}function fa(t,e){const r=Gc(t).find(s=>s.paramIndex===e);if(!r)throw new $f(e,t);return r}function pa(t,e,n,r=Ut.REQUIRED,s){const o={paramIndex:n,identifier:e,quantity:r,lookUp:s,withNew:!1};if(typeof e>"u")throw new jf(t,n);const i=t;i[Hl]===i?i[fi].push(o):(i[fi]=[o],i[Hl]=i)}const jl=new Set,Vl=new Map;function Te(t){if(jl.has(t))return console.error(`Identifier "${t}" already exists. Returning the cached identifier decorator.`),Vl.get(t);const e=function(n,r,s){pa(n,e,s)};return e.decoratorName=t,e.toString=()=>e.decoratorName,e[ha]=!0,jl.add(t),Vl.set(t,e),e}function Vf(t,e,n){const r=fa(t,e);r.lookUp=n}function Yc(t){return function e(){return this instanceof e?this:function(n,r,s){Vf(n,s,t)}}}const Wf=Yc(Nn.SKIP_SELF),Gf=Yc(Nn.SELF);function Yf(t){return t===Ut.OPTIONAL?"0 or 1":"1"}var js=class extends Le{constructor(t,e,n){let r=`Expect ${Yf(e)} dependency item(s) for id "${ye(t)}" but get ${n}.`;n===0&&(r+=" Did you forget to register it?"),n>1&&(r+=" You register it more than once."),super(r),this.quantity=e,this.actual=n}};function zc(t,e,n){if(e===Ut.OPTIONAL&&n>1||e===Ut.REQUIRED&&n!==1)throw new js(t,e,n)}function zf(t,e){return t===Ut.MANY?e:e[0]}function Kf(t,e,n){const r=fa(t,e);r.quantity=n}function ga(t){return function e(n){return this instanceof e?this:function(r,s,o){if(n)pa(r,n,o,t);else{if(t===Ut.REQUIRED)throw new Hf(r,o);Kf(r,o,t)}}}}const Xf=ga(Ut.MANY),Jf=ga(Ut.OPTIONAL),Ve=ga(Ut.REQUIRED);function Kc(t,e=0){return t?t.map((n,r)=>{if(r+=e,!Array.isArray(n))return{paramIndex:r,identifier:n,quantity:Ut.REQUIRED,withNew:!1};const s=n.slice(0,n.length-1),o=n[n.length-1];let i,a=Ut.REQUIRED,l=!1;return s.forEach(u=>{u instanceof Gf?i=Nn.SELF:u instanceof Wf?i=Nn.SKIP_SELF:u instanceof Jf?a=Ut.OPTIONAL:u instanceof Xf?a=Ut.MANY:l=!0}),{paramIndex:r,identifier:o,quantity:a,lookUp:i,withNew:l}}):[]}function sT(t,e,n=0){Kc(e,n).forEach(s=>{pa(t,s.identifier,s.paramIndex,s.quantity,s.lookUp)})}function oT(t){return{unwrap:t}}function Zf(t){return!!t&&typeof t.unwrap=="function"}function Qf(t){return Zf(t)?t.unwrap():t}function qf(t,e,n){const r=fa(t,e);r.withNew=n}function tp(t){return function e(){return this instanceof e?this:function(n,r,s){qf(n,s,t)}}}const iT=tp(!0);function ep(t){return!!t&&typeof t.dispose=="function"}function np(t){return t.length===1}const fo=[];function Wl(t){fo.push(t)}function Gl(){fo.pop()}function rp(){fo.length=0}var Yl=class extends Le{constructor(t,e,n){const r=`Cannot find "${ye(e)}" registered by any injector. It is the ${n}th param of "${Uf(t)?ye(t):t.name}".`;super(r)}},Vs=class extends Le{constructor(t){const e=`Cannot find "${ye(t)}" registered by any injector. The stack of dependencies is: "${fo.map(n=>ye(n)).join(" -> ")}".`;super(e),rp()}},sp=class{constructor(t){pe(this,"dependencyMap",new Map);this.normalizeDependencies(t).map(e=>this.add(e[0],e[1]))}add(t,e){typeof e>"u"&&(e={useClass:t,lazy:!1});let n=this.dependencyMap.get(t);typeof n>"u"&&(n=[],this.dependencyMap.set(t,n)),n.push(e)}delete(t){this.dependencyMap.delete(t)}get(t,e){const n=this.dependencyMap.get(t);return zc(t,e,n.length),zf(e,n)}has(t){return this.dependencyMap.has(t)}dispose(){this.dependencyMap.clear()}normalizeDependencies(t){return t.map(e=>{const n=e[0];let r;return np(e)?r={useClass:e[0],lazy:!1}:r=e[1],[n,r]})}},op=class{constructor(){pe(this,"resolvedDependencies",new Map)}add(t,e){let n=this.resolvedDependencies.get(t);typeof n>"u"&&(n=[],this.resolvedDependencies.set(t,n)),n.push(e)}has(t){return this.resolvedDependencies.has(t)}get(t,e){const n=this.resolvedDependencies.get(t);if(!n)throw new Vs(t);return zc(t,e,n.length),e===Ut.MANY?n:n[0]}dispose(){Array.from(this.resolvedDependencies.values()).forEach(t=>{t.forEach(e=>ep(e)?e.dispose():void 0)}),this.resolvedDependencies.clear()}};let pi;(function(){/* istanbul ignore next -- @preserve */if(typeof requestIdleCallback<"u"&&typeof cancelIdleCallback<"u")pi=(t,e)=>{const n=requestIdleCallback(t,typeof e=="number"?{timeout:e}:void 0);let r=!1;return()=>{r||(r=!0,cancelIdleCallback(n))}};else{const t=Object.freeze({didTimeout:!0,timeRemaining(){return 15}});pi=e=>{const n=setTimeout(()=>e(t));let r=!1;return()=>{r||(r=!0,clearTimeout(n))}}}})();var ip=class{constructor(t){pe(this,"executor");pe(this,"disposeIdleCallback");pe(this,"didRun",!1);pe(this,"value");pe(this,"error");this.executor=()=>{try{this.value=t()}catch(e){this.error=e}finally{this.didRun=!0}},this.disposeIdleCallback=pi(()=>this.executor())}hasRun(){return this.didRun}dispose(){this.disposeIdleCallback()}getValue(){if(this.didRun||(this.disposeIdleCallback(),this.executor()),this.error)throw this.error;return this.value}};const ap=300,ps=Symbol("$$NOT_INSTANTIATED_SYMBOL");var lp=class extends Le{constructor(t){super(`Detecting cyclic dependency. The last identifier is "${ye(t)}".`)}},up=class extends Le{constructor(){super("Injector cannot be accessed after it was disposed.")}},cp=class extends Le{constructor(t){super(`Async item "${ye(t)}" returns another async item.`)}},dp=class extends Le{constructor(t){super(`Cannot get async item "${ye(t)}" from sync api.`)}},zl=class extends Le{constructor(t){super(`Cannot add dependency "${ye(t)}" after it is already resolved.`)}},hp=class extends Le{constructor(t){super(`Cannot delete dependency "${ye(t)}" when it is already resolved.`)}},Rr=class gi{constructor(e,n=null){pe(this,"dependencyCollection");pe(this,"resolvedDependencyCollection");pe(this,"children",[]);pe(this,"resolutionOngoing",0);pe(this,"disposingCallbacks",new Set);pe(this,"disposed",!1);this.parent=n,this.dependencyCollection=new sp(e||[]),this.resolvedDependencyCollection=new op,n&&n.children.push(this)}onDispose(e){return this.disposingCallbacks.add(e),{dispose:()=>this.disposingCallbacks.delete(e)}}createChild(e){return this._ensureInjectorNotDisposed(),new gi(e,this)}dispose(){this.children.forEach(e=>e.dispose()),this.children.length=0,this.dependencyCollection.dispose(),this.resolvedDependencyCollection.dispose(),this.deleteSelfFromParent(),this.disposed=!0,this.disposingCallbacks.forEach(e=>e()),this.disposingCallbacks.clear()}deleteSelfFromParent(){if(this.parent){const e=this.parent.children.indexOf(this);this.parent.children.splice(e,1)}}add(e){this._ensureInjectorNotDisposed();const n=e[0],r=e[1];if(this.resolvedDependencyCollection.has(n))throw new zl(n);typeof r>"u"?this.dependencyCollection.add(n):$l(r)||Pl(r)||Bl(r)||Ul(r)?this.dependencyCollection.add(n,r):this.resolvedDependencyCollection.add(n,r)}replace(e){this._ensureInjectorNotDisposed();const n=e[0];if(this.resolvedDependencyCollection.has(n))throw new zl(n);this.dependencyCollection.delete(n),this.dependencyCollection.add(n,e[1])}delete(e){if(this._ensureInjectorNotDisposed(),this.resolvedDependencyCollection.has(e))throw new hp(e);this.dependencyCollection.delete(e)}invoke(e,...n){return this._ensureInjectorNotDisposed(),e({get:(s,o,i)=>this._get(s,o,i),has:s=>this.has(s)},...n)}has(e){var n;return this.dependencyCollection.has(e)||((n=this.parent)==null?void 0:n.has(e))||!1}get(e,n,r){this._ensureInjectorNotDisposed();const s=this._get(e,n,r);if(Array.isArray(s)&&s.some(o=>Bo(o))||Bo(s))throw new dp(e);return s}_get(e,n,r,s){let o=Ut.REQUIRED;if(n===Ut.REQUIRED||n===Ut.OPTIONAL||n===Ut.MANY?o=n:r=n,!s){const a=this.getValue(e,o,r);if(a!==ps)return a}const i=!s;return this.createDependency(e,o,r,i)}getAsync(e){this._ensureInjectorNotDisposed();const n=this.getValue(e,Ut.REQUIRED);if(n!==ps)return Promise.resolve(n);const r=this.createDependency(e,Ut.REQUIRED);return Bo(r)?r.whenReady():Promise.resolve(r)}createInstance(e,...n){return this._ensureInjectorNotDisposed(),this._resolveClassImpl({useClass:e},...n)}_resolveDependency(e,n,r=!0){let s;Wl(e);try{Bl(n)?s=this._resolveValueDependency(e,n):Ul(n)?s=this._resolveFactory(e,n,r):Pl(n)?s=this._resolveClass(e,n,r):Bf(n)?s=this._resolveExisting(e,n):s=this._resolveAsync(e,n),Gl()}catch(o){throw Gl(),o}return s}_resolveExisting(e,n){const r=this.get(n.useExisting);return this.resolvedDependencyCollection.add(e,r),r}_resolveValueDependency(e,n){const r=n.useValue;return this.resolvedDependencyCollection.add(e,r),r}_resolveClass(e,n,r){let s;if(n.lazy){const o=new ip(()=>(this._ensureInjectorNotDisposed(),this._resolveClassImpl(n)));s=new Proxy(Object.create(null),{get(i,a){if(a in i)return i[a];const l=o.getValue();let u=l[a];return typeof u!="function"||(u=u.bind(l),i[a]=u),u},set(i,a,l){return o.getValue()[a]=l,!0}})}else s=this._resolveClassImpl(n);return e&&r&&this.resolvedDependencyCollection.add(e,s),s}_resolveClassImpl(e,...n){var u;const r=e.useClass;this.markNewResolution(r);const s=Gc(r).sort((c,d)=>c.paramIndex-d.paramIndex).map(c=>({...c,identifier:Qf(c.identifier)})),o=[];for(const c of s)try{const d=this._get(c.identifier,c.quantity,c.lookUp,c.withNew);o.push(d)}catch(d){throw d instanceof Vs||d instanceof js&&d.actual===0?new Yl(r,c.identifier,c.paramIndex):d}let i=[...n];const a=s.length>0?s[0].paramIndex:i.length;if(i.length!==a){console.warn(`[redi]: Expect ${a} custom parameter(s) of ${ye(r)} but get ${i.length}.`);const c=a-i.length;c>0?i=[...i,...Array.from({length:c}).fill(void 0)]:i=i.slice(0,a)}const l=new r(...i,...o);return(u=e==null?void 0:e.onInstantiation)==null||u.call(e,l),this.markResolutionCompleted(),l}_resolveFactory(e,n,r){var a;this.markNewResolution(e);const s=Kc(n.deps),o=[];for(const l of s)try{const u=this._get(l.identifier,l.quantity,l.lookUp,l.withNew);o.push(u)}catch(u){throw u instanceof Vs||u instanceof js&&u.actual===0?new Yl(e,l.identifier,l.paramIndex):u}const i=n.useFactory.apply(null,o);return r&&this.resolvedDependencyCollection.add(e,i),this.markResolutionCompleted(),(a=n==null?void 0:n.onInstantiation)==null||a.call(n,i),i}_resolveAsync(e,n){return{__symbol:Wc,whenReady:()=>this._resolveAsyncImpl(e,n)}}_resolveAsyncImpl(e,n){return n.useAsync().then(r=>{const s=this.getValue(e);if(s!==ps)return s;let o;if(Array.isArray(r)){const i=r[1];if($l(i))throw new cp(e);o=this._resolveDependency(e,i)}else Vc(r)?o=this._resolveClassImpl({useClass:r,onInstantiation:n.onInstantiation}):o=r;return this.resolvedDependencyCollection.add(e,o),o})}getValue(e,n=Ut.REQUIRED,r){const s=()=>this.dependencyCollection.has(e)&&!this.resolvedDependencyCollection.has(e)?ps:this.resolvedDependencyCollection.get(e,n),o=()=>{if(this.parent)return this.parent.getValue(e,n);if(n===Ut.OPTIONAL)return null;if(n===Ut.MANY)return[];throw new js(e,Ut.REQUIRED,0)};return r===Nn.SKIP_SELF?o():e===gi?this:r===Nn.SELF||this.resolvedDependencyCollection.has(e)||this.dependencyCollection.has(e)?s():o()}createDependency(e,n,r,s=!0){const o=()=>{const a=this.dependencyCollection.get(e,n);let l=null;return Array.isArray(a)?l=a.map(u=>this._resolveDependency(e,u,s)):l=this._resolveDependency(e,a,s),l},i=()=>{if(this.parent)return this.parent.createDependency(e,n,void 0,s);if(n===Ut.OPTIONAL)return null;if(n===Ut.MANY)return[];throw Wl(e),new Vs(e)};return r===Nn.SKIP_SELF?i():this.dependencyCollection.has(e)?o():i()}markNewResolution(e){if(this.resolutionOngoing+=1,this.resolutionOngoing>=ap)throw new lp(e)}markResolutionCompleted(){this.resolutionOngoing-=1}_ensureInjectorNotDisposed(){if(this.disposed)throw new up}};const Kl=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof global<"u"&&global,Xl="REDI_GLOBAL_LOCK",fp=typeof process<"u"&&process.versions!=null&&process.versions.node!=null;Kl[Xl]?fp||console.error(`[redi]: You are loading scripts of redi more than once! This may cause undesired behavior in your application.
Maybe your dependencies added redi as its dependency and bundled redi to its dist files. Or you import different versions of redi.
For more info please visit our website: https://redi.wendell.fun/en-US/docs/faq#import-scripts-of-redi-more-than-once`):Kl[Xl]=!0;var mi=function(t,e){return mi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(n[s]=r[s])},mi(t,e)};function nn(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");mi(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}function pp(t,e,n,r){function s(o){return o instanceof n?o:new n(function(i){i(o)})}return new(n||(n=Promise))(function(o,i){function a(c){try{u(r.next(c))}catch(d){i(d)}}function l(c){try{u(r.throw(c))}catch(d){i(d)}}function u(c){c.done?o(c.value):s(c.value).then(a,l)}u((r=r.apply(t,e||[])).next())})}function Xc(t,e){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,s,o,i=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return i.next=a(0),i.throw=a(1),i.return=a(2),typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function a(u){return function(c){return l([u,c])}}function l(u){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(n=0)),n;)try{if(r=1,s&&(o=u[0]&2?s.return:u[0]?s.throw||((o=s.return)&&o.call(s),0):s.next)&&!(o=o.call(s,u[1])).done)return o;switch(s=0,o&&(u=[u[0]&2,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,s=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!o||u[1]>o[0]&&u[1]<o[3])){n.label=u[1];break}if(u[0]===6&&n.label<o[1]){n.label=o[1],o=u;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(u);break}o[2]&&n.ops.pop(),n.trys.pop();continue}u=e.call(t,n)}catch(c){u=[6,c],s=0}finally{r=o=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function pr(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ns(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),s,o=[],i;try{for(;(e===void 0||e-- >0)&&!(s=r.next()).done;)o.push(s.value)}catch(a){i={error:a}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(i)throw i.error}}return o}function rs(t,e,n){if(n||arguments.length===2)for(var r=0,s=e.length,o;r<s;r++)(o||!(r in e))&&(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))}function ar(t){return this instanceof ar?(this.v=t,this):new ar(t)}function gp(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),s,o=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",i),s[Symbol.asyncIterator]=function(){return this},s;function i(f){return function(p){return Promise.resolve(p).then(f,d)}}function a(f,p){r[f]&&(s[f]=function(g){return new Promise(function(_,I){o.push([f,g,_,I])>1||l(f,g)})},p&&(s[f]=p(s[f])))}function l(f,p){try{u(r[f](p))}catch(g){h(o[0][3],g)}}function u(f){f.value instanceof ar?Promise.resolve(f.value.v).then(c,d):h(o[0][2],f)}function c(f){l("next",f)}function d(f){l("throw",f)}function h(f,p){f(p),o.shift(),o.length&&l(o[0][0],o[0][1])}}function mp(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof pr=="function"?pr(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(o){n[o]=t[o]&&function(i){return new Promise(function(a,l){i=t[o](i),s(a,l,i.done,i.value)})}}function s(o,i,a,l){Promise.resolve(l).then(function(u){o({value:u,done:a})},i)}}function te(t){return typeof t=="function"}function ma(t){var e=function(r){Error.call(r),r.stack=new Error().stack},n=t(e);return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var $o=ma(function(t){return function(n){t(this),this.message=n?n.length+` errors occurred during unsubscription:
`+n.map(function(r,s){return s+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=n}});function Js(t,e){if(t){var n=t.indexOf(e);0<=n&&t.splice(n,1)}}var Tr=function(){function t(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return t.prototype.unsubscribe=function(){var e,n,r,s,o;if(!this.closed){this.closed=!0;var i=this._parentage;if(i)if(this._parentage=null,Array.isArray(i))try{for(var a=pr(i),l=a.next();!l.done;l=a.next()){var u=l.value;u.remove(this)}}catch(g){e={error:g}}finally{try{l&&!l.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}else i.remove(this);var c=this.initialTeardown;if(te(c))try{c()}catch(g){o=g instanceof $o?g.errors:[g]}var d=this._finalizers;if(d){this._finalizers=null;try{for(var h=pr(d),f=h.next();!f.done;f=h.next()){var p=f.value;try{Jl(p)}catch(g){o=o??[],g instanceof $o?o=rs(rs([],ns(o)),ns(g.errors)):o.push(g)}}}catch(g){r={error:g}}finally{try{f&&!f.done&&(s=h.return)&&s.call(h)}finally{if(r)throw r.error}}}if(o)throw new $o(o)}},t.prototype.add=function(e){var n;if(e&&e!==this)if(this.closed)Jl(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}},t.prototype._hasParent=function(e){var n=this._parentage;return n===e||Array.isArray(n)&&n.includes(e)},t.prototype._addParent=function(e){var n=this._parentage;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e},t.prototype._removeParent=function(e){var n=this._parentage;n===e?this._parentage=null:Array.isArray(n)&&Js(n,e)},t.prototype.remove=function(e){var n=this._finalizers;n&&Js(n,e),e instanceof t&&e._removeParent(this)},t.EMPTY=function(){var e=new t;return e.closed=!0,e}(),t}(),Jc=Tr.EMPTY;function Zc(t){return t instanceof Tr||t&&"closed"in t&&te(t.remove)&&te(t.add)&&te(t.unsubscribe)}function Jl(t){te(t)?t():t.unsubscribe()}var _p={Promise:void 0},yp={setTimeout:function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setTimeout.apply(void 0,rs([t,e],ns(n)))},clearTimeout:function(t){return clearTimeout(t)},delegate:void 0};function Qc(t){yp.setTimeout(function(){throw t})}function Zl(){}function Ws(t){t()}var _a=function(t){nn(e,t);function e(n){var r=t.call(this)||this;return r.isStopped=!1,n?(r.destination=n,Zc(n)&&n.add(r)):r.destination=bp,r}return e.create=function(n,r,s){return new Zs(n,r,s)},e.prototype.next=function(n){this.isStopped||this._next(n)},e.prototype.error=function(n){this.isStopped||(this.isStopped=!0,this._error(n))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(n){this.destination.next(n)},e.prototype._error=function(n){try{this.destination.error(n)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(Tr),vp=function(){function t(e){this.partialObserver=e}return t.prototype.next=function(e){var n=this.partialObserver;if(n.next)try{n.next(e)}catch(r){gs(r)}},t.prototype.error=function(e){var n=this.partialObserver;if(n.error)try{n.error(e)}catch(r){gs(r)}else gs(e)},t.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(n){gs(n)}},t}(),Zs=function(t){nn(e,t);function e(n,r,s){var o=t.call(this)||this,i;return te(n)||!n?i={next:n??void 0,error:r??void 0,complete:s??void 0}:i=n,o.destination=new vp(i),o}return e}(_a);function gs(t){Qc(t)}function Ep(t){throw t}var bp={closed:!0,next:Zl,error:Ep,complete:Zl},ya=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function Un(t){return t}function aT(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return qc(t)}function qc(t){return t.length===0?Un:t.length===1?t[0]:function(n){return t.reduce(function(r,s){return s(r)},n)}}var ie=function(){function t(e){e&&(this._subscribe=e)}return t.prototype.lift=function(e){var n=new t;return n.source=this,n.operator=e,n},t.prototype.subscribe=function(e,n,r){var s=this,o=Rp(e)?e:new Zs(e,n,r);return Ws(function(){var i=s,a=i.operator,l=i.source;o.add(a?a.call(o,l):l?s._subscribe(o):s._trySubscribe(o))}),o},t.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(n){e.error(n)}},t.prototype.forEach=function(e,n){var r=this;return n=Ql(n),new n(function(s,o){var i=new Zs({next:function(a){try{e(a)}catch(l){o(l),i.unsubscribe()}},error:o,complete:s});r.subscribe(i)})},t.prototype._subscribe=function(e){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(e)},t.prototype[ya]=function(){return this},t.prototype.pipe=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return qc(e)(this)},t.prototype.toPromise=function(e){var n=this;return e=Ql(e),new e(function(r,s){var o;n.subscribe(function(i){return o=i},function(i){return s(i)},function(){return r(o)})})},t.create=function(e){return new t(e)},t}();function Ql(t){var e;return(e=t??_p.Promise)!==null&&e!==void 0?e:Promise}function Cp(t){return t&&te(t.next)&&te(t.error)&&te(t.complete)}function Rp(t){return t&&t instanceof _a||Cp(t)&&Zc(t)}function Tp(t){return te(t==null?void 0:t.lift)}function We(t){return function(e){if(Tp(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Ne(t,e,n,r,s){return new wp(t,e,n,r,s)}var wp=function(t){nn(e,t);function e(n,r,s,o,i,a){var l=t.call(this,n)||this;return l.onFinalize=i,l.shouldUnsubscribe=a,l._next=r?function(u){try{r(u)}catch(c){n.error(c)}}:t.prototype._next,l._error=o?function(u){try{o(u)}catch(c){n.error(c)}finally{this.unsubscribe()}}:t.prototype._error,l._complete=s?function(){try{s()}catch(u){n.error(u)}finally{this.unsubscribe()}}:t.prototype._complete,l}return e.prototype.unsubscribe=function(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;t.prototype.unsubscribe.call(this),!r&&((n=this.onFinalize)===null||n===void 0||n.call(this))}},e}(_a),Ip=ma(function(t){return function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),ce=function(t){nn(e,t);function e(){var n=t.call(this)||this;return n.closed=!1,n.currentObservers=null,n.observers=[],n.isStopped=!1,n.hasError=!1,n.thrownError=null,n}return e.prototype.lift=function(n){var r=new ql(this,this);return r.operator=n,r},e.prototype._throwIfClosed=function(){if(this.closed)throw new Ip},e.prototype.next=function(n){var r=this;Ws(function(){var s,o;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var i=pr(r.currentObservers),a=i.next();!a.done;a=i.next()){var l=a.value;l.next(n)}}catch(u){s={error:u}}finally{try{a&&!a.done&&(o=i.return)&&o.call(i)}finally{if(s)throw s.error}}}})},e.prototype.error=function(n){var r=this;Ws(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=n;for(var s=r.observers;s.length;)s.shift().error(n)}})},e.prototype.complete=function(){var n=this;Ws(function(){if(n._throwIfClosed(),!n.isStopped){n.isStopped=!0;for(var r=n.observers;r.length;)r.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(n){return this._throwIfClosed(),t.prototype._trySubscribe.call(this,n)},e.prototype._subscribe=function(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)},e.prototype._innerSubscribe=function(n){var r=this,s=this,o=s.hasError,i=s.isStopped,a=s.observers;return o||i?Jc:(this.currentObservers=null,a.push(n),new Tr(function(){r.currentObservers=null,Js(a,n)}))},e.prototype._checkFinalizedStatuses=function(n){var r=this,s=r.hasError,o=r.thrownError,i=r.isStopped;s?n.error(o):i&&n.complete()},e.prototype.asObservable=function(){var n=new ie;return n.source=this,n},e.create=function(n,r){return new ql(n,r)},e}(ie),ql=function(t){nn(e,t);function e(n,r){var s=t.call(this)||this;return s.destination=n,s.source=r,s}return e.prototype.next=function(n){var r,s;(s=(r=this.destination)===null||r===void 0?void 0:r.next)===null||s===void 0||s.call(r,n)},e.prototype.error=function(n){var r,s;(s=(r=this.destination)===null||r===void 0?void 0:r.error)===null||s===void 0||s.call(r,n)},e.prototype.complete=function(){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.complete)===null||r===void 0||r.call(n)},e.prototype._subscribe=function(n){var r,s;return(s=(r=this.source)===null||r===void 0?void 0:r.subscribe(n))!==null&&s!==void 0?s:Jc},e}(ce),de=function(t){nn(e,t);function e(n){var r=t.call(this)||this;return r._value=n,r}return Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),e.prototype._subscribe=function(n){var r=t.prototype._subscribe.call(this,n);return!r.closed&&n.next(this._value),r},e.prototype.getValue=function(){var n=this,r=n.hasError,s=n.thrownError,o=n._value;if(r)throw s;return this._throwIfClosed(),o},e.prototype.next=function(n){t.prototype.next.call(this,this._value=n)},e}(ce),va={now:function(){return(va.delegate||Date).now()},delegate:void 0},Sp=function(t){nn(e,t);function e(n,r,s){n===void 0&&(n=1/0),r===void 0&&(r=1/0),s===void 0&&(s=va);var o=t.call(this)||this;return o._bufferSize=n,o._windowTime=r,o._timestampProvider=s,o._buffer=[],o._infiniteTimeWindow=!0,o._infiniteTimeWindow=r===1/0,o._bufferSize=Math.max(1,n),o._windowTime=Math.max(1,r),o}return e.prototype.next=function(n){var r=this,s=r.isStopped,o=r._buffer,i=r._infiniteTimeWindow,a=r._timestampProvider,l=r._windowTime;s||(o.push(n),!i&&o.push(a.now()+l)),this._trimBuffer(),t.prototype.next.call(this,n)},e.prototype._subscribe=function(n){this._throwIfClosed(),this._trimBuffer();for(var r=this._innerSubscribe(n),s=this,o=s._infiniteTimeWindow,i=s._buffer,a=i.slice(),l=0;l<a.length&&!n.closed;l+=o?1:2)n.next(a[l]);return this._checkFinalizedStatuses(n),r},e.prototype._trimBuffer=function(){var n=this,r=n._bufferSize,s=n._timestampProvider,o=n._buffer,i=n._infiniteTimeWindow,a=(i?1:2)*r;if(r<1/0&&a<o.length&&o.splice(0,o.length-a),!i){for(var l=s.now(),u=0,c=1;c<o.length&&o[c]<=l;c+=2)u=c;u&&o.splice(0,u+1)}},e}(ce),Ap=function(t){nn(e,t);function e(n,r){return t.call(this)||this}return e.prototype.schedule=function(n,r){return this},e}(Tr),tu={setInterval:function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setInterval.apply(void 0,rs([t,e],ns(n)))},clearInterval:function(t){return clearInterval(t)},delegate:void 0},Op=function(t){nn(e,t);function e(n,r){var s=t.call(this,n,r)||this;return s.scheduler=n,s.work=r,s.pending=!1,s}return e.prototype.schedule=function(n,r){var s;if(r===void 0&&(r=0),this.closed)return this;this.state=n;var o=this.id,i=this.scheduler;return o!=null&&(this.id=this.recycleAsyncId(i,o,r)),this.pending=!0,this.delay=r,this.id=(s=this.id)!==null&&s!==void 0?s:this.requestAsyncId(i,this.id,r),this},e.prototype.requestAsyncId=function(n,r,s){return s===void 0&&(s=0),tu.setInterval(n.flush.bind(n,this),s)},e.prototype.recycleAsyncId=function(n,r,s){if(s===void 0&&(s=0),s!=null&&this.delay===s&&this.pending===!1)return r;r!=null&&tu.clearInterval(r)},e.prototype.execute=function(n,r){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var s=this._execute(n,r);if(s)return s;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(n,r){var s=!1,o;try{this.work(n)}catch(i){s=!0,o=i||new Error("Scheduled action threw falsy error")}if(s)return this.unsubscribe(),o},e.prototype.unsubscribe=function(){if(!this.closed){var n=this,r=n.id,s=n.scheduler,o=s.actions;this.work=this.state=this.scheduler=null,this.pending=!1,Js(o,this),r!=null&&(this.id=this.recycleAsyncId(s,r,null)),this.delay=null,t.prototype.unsubscribe.call(this)}},e}(Ap),eu=function(){function t(e,n){n===void 0&&(n=t.now),this.schedulerActionCtor=e,this.now=n}return t.prototype.schedule=function(e,n,r){return n===void 0&&(n=0),new this.schedulerActionCtor(this,e).schedule(r,n)},t.now=va.now,t}(),Dp=function(t){nn(e,t);function e(n,r){r===void 0&&(r=eu.now);var s=t.call(this,n,r)||this;return s.actions=[],s._active=!1,s}return e.prototype.flush=function(n){var r=this.actions;if(this._active){r.push(n);return}var s;this._active=!0;do if(s=n.execute(n.state,n.delay))break;while(n=r.shift());if(this._active=!1,s){for(;n=r.shift();)n.unsubscribe();throw s}},e}(eu),td=new Dp(Op),xp=td,ed=new ie(function(t){return t.complete()});function nd(t){return t&&te(t.schedule)}function Ea(t){return t[t.length-1]}function Np(t){return te(Ea(t))?t.pop():void 0}function ba(t){return nd(Ea(t))?t.pop():void 0}function Mp(t,e){return typeof Ea(t)=="number"?t.pop():e}var rd=function(t){return t&&typeof t.length=="number"&&typeof t!="function"};function sd(t){return te(t==null?void 0:t.then)}function od(t){return te(t[ya])}function id(t){return Symbol.asyncIterator&&te(t==null?void 0:t[Symbol.asyncIterator])}function ad(t){return new TypeError("You provided "+(t!==null&&typeof t=="object"?"an invalid object":"'"+t+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function Lp(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var ld=Lp();function ud(t){return te(t==null?void 0:t[ld])}function cd(t){return gp(this,arguments,function(){var n,r,s,o;return Xc(this,function(i){switch(i.label){case 0:n=t.getReader(),i.label=1;case 1:i.trys.push([1,,9,10]),i.label=2;case 2:return[4,ar(n.read())];case 3:return r=i.sent(),s=r.value,o=r.done,o?[4,ar(void 0)]:[3,5];case 4:return[2,i.sent()];case 5:return[4,ar(s)];case 6:return[4,i.sent()];case 7:return i.sent(),[3,2];case 8:return[3,10];case 9:return n.releaseLock(),[7];case 10:return[2]}})})}function dd(t){return te(t==null?void 0:t.getReader)}function wr(t){if(t instanceof ie)return t;if(t!=null){if(od(t))return Fp(t);if(rd(t))return kp(t);if(sd(t))return Pp(t);if(id(t))return hd(t);if(ud(t))return Up(t);if(dd(t))return Bp(t)}throw ad(t)}function Fp(t){return new ie(function(e){var n=t[ya]();if(te(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function kp(t){return new ie(function(e){for(var n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}function Pp(t){return new ie(function(e){t.then(function(n){e.closed||(e.next(n),e.complete())},function(n){return e.error(n)}).then(null,Qc)})}function Up(t){return new ie(function(e){var n,r;try{for(var s=pr(t),o=s.next();!o.done;o=s.next()){var i=o.value;if(e.next(i),e.closed)return}}catch(a){n={error:a}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}e.complete()})}function hd(t){return new ie(function(e){$p(t,e).catch(function(n){return e.error(n)})})}function Bp(t){return hd(cd(t))}function $p(t,e){var n,r,s,o;return pp(this,void 0,void 0,function(){var i,a;return Xc(this,function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),n=mp(t),l.label=1;case 1:return[4,n.next()];case 2:if(r=l.sent(),!!r.done)return[3,4];if(i=r.value,e.next(i),e.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return a=l.sent(),s={error:a},[3,11];case 6:return l.trys.push([6,,9,10]),r&&!r.done&&(o=n.return)?[4,o.call(n)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(s)throw s.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}})})}function yn(t,e,n,r,s){r===void 0&&(r=0),s===void 0&&(s=!1);var o=e.schedule(function(){n(),s?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(o),!s)return o}function fd(t,e){return e===void 0&&(e=0),We(function(n,r){n.subscribe(Ne(r,function(s){return yn(r,t,function(){return r.next(s)},e)},function(){return yn(r,t,function(){return r.complete()},e)},function(s){return yn(r,t,function(){return r.error(s)},e)}))})}function pd(t,e){return e===void 0&&(e=0),We(function(n,r){r.add(t.schedule(function(){return n.subscribe(r)},e))})}function Hp(t,e){return wr(t).pipe(pd(e),fd(e))}function jp(t,e){return wr(t).pipe(pd(e),fd(e))}function Vp(t,e){return new ie(function(n){var r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}function Wp(t,e){return new ie(function(n){var r;return yn(n,e,function(){r=t[ld](),yn(n,e,function(){var s,o,i;try{s=r.next(),o=s.value,i=s.done}catch(a){n.error(a);return}i?n.complete():n.next(o)},0,!0)}),function(){return te(r==null?void 0:r.return)&&r.return()}})}function gd(t,e){if(!t)throw new Error("Iterable cannot be null");return new ie(function(n){yn(n,e,function(){var r=t[Symbol.asyncIterator]();yn(n,e,function(){r.next().then(function(s){s.done?n.complete():n.next(s.value)})},0,!0)})})}function Gp(t,e){return gd(cd(t),e)}function Yp(t,e){if(t!=null){if(od(t))return Hp(t,e);if(rd(t))return Vp(t,e);if(sd(t))return jp(t,e);if(id(t))return gd(t,e);if(ud(t))return Wp(t,e);if(dd(t))return Gp(t,e)}throw ad(t)}function po(t,e){return e?Yp(t,e):wr(t)}function ms(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=ba(t);return po(t,n)}var Ca=ma(function(t){return function(){t(this),this.name="EmptyError",this.message="no elements in sequence"}});function zp(t,e){return new Promise(function(n,r){var s=new Zs({next:function(o){n(o),s.unsubscribe()},error:r,complete:function(){r(new Ca)}});t.subscribe(s)})}function Kp(t){return t instanceof Date&&!isNaN(t)}function Ir(t,e){return We(function(n,r){var s=0;n.subscribe(Ne(r,function(o){r.next(t.call(e,o,s++))}))})}var Xp=Array.isArray;function Jp(t,e){return Xp(e)?t.apply(void 0,rs([],ns(e))):t(e)}function Zp(t){return Ir(function(e){return Jp(t,e)})}var Qp=Array.isArray,qp=Object.getPrototypeOf,tg=Object.prototype,eg=Object.keys;function ng(t){if(t.length===1){var e=t[0];if(Qp(e))return{args:e,keys:null};if(rg(e)){var n=eg(e);return{args:n.map(function(r){return e[r]}),keys:n}}}return{args:t,keys:null}}function rg(t){return t&&typeof t=="object"&&qp(t)===tg}function sg(t,e){return t.reduce(function(n,r,s){return n[r]=e[s],n},{})}function og(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=ba(t),r=Np(t),s=ng(t),o=s.args,i=s.keys;if(o.length===0)return po([],n);var a=new ie(ig(o,n,i?function(l){return sg(i,l)}:Un));return r?a.pipe(Zp(r)):a}function ig(t,e,n){return n===void 0&&(n=Un),function(r){nu(e,function(){for(var s=t.length,o=new Array(s),i=s,a=s,l=function(c){nu(e,function(){var d=po(t[c],e),h=!1;d.subscribe(Ne(r,function(f){o[c]=f,h||(h=!0,a--),a||r.next(n(o.slice()))},function(){--i||r.complete()}))},r)},u=0;u<s;u++)l(u)},r)}}function nu(t,e,n){t?yn(n,t,e):e()}function ag(t,e,n,r,s,o,i,a){var l=[],u=0,c=0,d=!1,h=function(){d&&!l.length&&!u&&e.complete()},f=function(g){return u<r?p(g):l.push(g)},p=function(g){u++;var _=!1;wr(n(g,c++)).subscribe(Ne(e,function(I){e.next(I)},function(){_=!0},void 0,function(){if(_)try{u--;for(var I=function(){var U=l.shift();i||p(U)};l.length&&u<r;)I();h()}catch(U){e.error(U)}}))};return t.subscribe(Ne(e,f,function(){d=!0,h()})),function(){}}function md(t,e,n){return n===void 0&&(n=1/0),te(e)?md(function(r,s){return Ir(function(o,i){return e(r,o,s,i)})(wr(t(r,s)))},n):(typeof e=="number"&&(n=e),We(function(r,s){return ag(r,s,t,n)}))}function lg(t){return t===void 0&&(t=1/0),md(Un,t)}function ug(t,e,n){t===void 0&&(t=0),n===void 0&&(n=xp);var r=-1;return e!=null&&(nd(e)?n=e:r=e),new ie(function(s){var o=Kp(t)?+t-n.now():t;o<0&&(o=0);var i=0;return n.schedule(function(){s.closed||(s.next(i++),0<=r?this.schedule(void 0,r):s.complete())},o)})}function _d(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=ba(t),r=Mp(t,1/0),s=t;return s.length?s.length===1?wr(s[0]):lg(r)(po(s,n)):ed}function En(t,e){return We(function(n,r){var s=0;n.subscribe(Ne(r,function(o){return t.call(e,o,s++)&&r.next(o)}))})}function yd(t,e){return e===void 0&&(e=td),We(function(n,r){var s=null,o=null,i=null,a=function(){if(s){s.unsubscribe(),s=null;var u=o;o=null,r.next(u)}};function l(){var u=i+t,c=e.now();if(c<u){s=this.schedule(void 0,u-c),r.add(s);return}a()}n.subscribe(Ne(r,function(u){o=u,i=e.now(),s||(s=e.schedule(l,t),r.add(s))},function(){a(),r.complete()},void 0,function(){o=s=null}))})}function cg(t){return We(function(e,n){var r=!1;e.subscribe(Ne(n,function(s){r=!0,n.next(s)},function(){r||n.next(t),n.complete()}))})}function vd(t){return t<=0?function(){return ed}:We(function(e,n){var r=0;e.subscribe(Ne(n,function(s){++r<=t&&(n.next(s),t<=r&&n.complete())}))})}function dg(t,e){return e===void 0&&(e=Un),t=t??hg,We(function(n,r){var s,o=!0;n.subscribe(Ne(r,function(i){var a=e(i);(o||!t(s,a))&&(o=!1,s=a,r.next(i))}))})}function hg(t,e){return t===e}function fg(t){return t===void 0&&(t=pg),We(function(e,n){var r=!1;e.subscribe(Ne(n,function(s){r=!0,n.next(s)},function(){return r?n.complete():n.error(t())}))})}function pg(){return new Ca}function gg(t,e){var n=arguments.length>=2;return function(r){return r.pipe(t?En(function(s,o){return t(s,o,r)}):Un,vd(1),n?cg(e):fg(function(){return new Ca}))}}function Ed(t){return En(function(e,n){return t<=n})}function ru(t,e,n){var r=te(t)||e||n?{next:t,error:e,complete:n}:t;return r?We(function(s,o){var i;(i=r.subscribe)===null||i===void 0||i.call(r);var a=!0;s.subscribe(Ne(o,function(l){var u;(u=r.next)===null||u===void 0||u.call(r,l),o.next(l)},function(){var l;a=!1,(l=r.complete)===null||l===void 0||l.call(r),o.complete()},function(l){var u;a=!1,(u=r.error)===null||u===void 0||u.call(r,l),o.error(l)},function(){var l,u;a&&((l=r.unsubscribe)===null||l===void 0||l.call(r)),(u=r.finalize)===null||u===void 0||u.call(r)}))}):Un}const _s={white:"#FFFFFF",black:"#000000",primary:{50:"#F3F5FF",100:"#E9EDFF",200:"#D2DAFA",300:"#BAC6F8",400:"#6280F9",500:"#466AF7",600:"#2C53F1",700:"#143EE3",800:"#083AD1",900:"#1033BF"},gray:{50:"#F9FAFB",100:"#EEEFF1",200:"#E3E5EA",300:"#A8B0BD",400:"#7D8698",500:"#4E5565",600:"#31363F",700:"#272A2F",800:"#1F2124",900:"#1B1C1F"},blue:{50:"#EBF5FF",100:"#E1EFFE",200:"#C3DDFD",300:"#A4CAFE",400:"#76A9FA",500:"#3F83F8",600:"#1C64F2",700:"#1A56DB",800:"#1E429F",900:"#233876"},red:{50:"#FDF2F2",100:"#FDE8E8",200:"#FBD5D5",300:"#F8B4B4",400:"#F98080",500:"#F05252",600:"#E02424",700:"#C81E1E",800:"#9B1C1C",900:"#771D1D"},orange:{50:"#FFF8F1",100:"#FEECDC",200:"#FCD9BD",300:"#FDBA8C",400:"#FF8A4C",500:"#FF5A1F",600:"#D03801",700:"#B43403",800:"#8A2C0D",900:"#771D1D"},yellow:{50:"#FDFCEA",100:"#FFF4B9",200:"#FCDC6A",300:"#FAC815",400:"#F1B312",500:"#D49D0F",600:"#AB7F0E",700:"#9A6D15",800:"#725213",900:"#634312"},green:{50:"#F3FAF7",100:"#DEF7EC",200:"#BCF0DA",300:"#84E1BC",400:"#31C48D",500:"#0DA471",600:"#057A55",700:"#046C4E",800:"#03543F",900:"#014737"},jiqing:{50:"#EDFAFA",100:"#D5F5F6",200:"#AFECEF",300:"#7EDCE2",400:"#16BDCA",500:"#0694A2",600:"#047481",700:"#036672",800:"#05505C",900:"#014451"},indigo:{50:"#F3F5FF",100:"#E9EDFF",200:"#D2DAFA",300:"#BAC6F8",400:"#6280F9",500:"#466AF7",600:"#2C53F1",700:"#143EE3",800:"#083AD1",900:"#1033BF"},purple:{50:"#F6F5FF",100:"#EDEBFE",200:"#DCD7FE",300:"#CABFFD",400:"#AC94FA",500:"#9061F9",600:"#7E3AF2",700:"#6C2BD9",800:"#5521B5",900:"#4A1D96"},pink:{50:"#FDF2F8",100:"#FCE8F3",200:"#FAD1E8",300:"#F8B4D9",400:"#F17EB8",500:"#E74694",600:"#D61F69",700:"#BF125D",800:"#99154B",900:"#751A3D"},"loop-color":{1:"purple.400",2:"green.500",3:"blue.500",4:"yellow.400",5:"pink.300",6:"jiqing.600",7:"orange.400",8:"gray.800",9:"indigo.500",10:"red.300",11:"green.600",12:"yellow.700"}},lT={white:"#FFFFFF",black:"#000000",primary:{50:"#F3FAF7",100:"#DEF7EC",200:"#BCF0DA",300:"#84E1BC",400:"#31C48D",500:"#0DA471",600:"#057A55",700:"#046C4E",800:"#03543F",900:"#014737"},gray:{50:"#F9FAFB",100:"#EEEFF1",200:"#E3E5EA",300:"#A8B0BD",400:"#7D8698",500:"#4E5565",600:"#31363F",700:"#272A2F",800:"#1F2124",900:"#1B1C1F"},blue:{50:"#EBF5FF",100:"#E1EFFE",200:"#C3DDFD",300:"#A4CAFE",400:"#76A9FA",500:"#3F83F8",600:"#1C64F2",700:"#1A56DB",800:"#1E429F",900:"#233876"},red:{50:"#FDF2F2",100:"#FDE8E8",200:"#FBD5D5",300:"#F8B4B4",400:"#F98080",500:"#F05252",600:"#E02424",700:"#C81E1E",800:"#9B1C1C",900:"#771D1D"},orange:{50:"#FFF8F1",100:"#FEECDC",200:"#FCD9BD",300:"#FDBA8C",400:"#FF8A4C",500:"#FF5A1F",600:"#D03801",700:"#B43403",800:"#8A2C0D",900:"#771D1D"},yellow:{50:"#FDFCEA",100:"#FFF4B9",200:"#FCDC6A",300:"#FAC815",400:"#F1B312",500:"#D49D0F",600:"#AB7F0E",700:"#9A6D15",800:"#725213",900:"#634312"},green:{50:"#F3FAF7",100:"#DEF7EC",200:"#BCF0DA",300:"#84E1BC",400:"#31C48D",500:"#0DA471",600:"#057A55",700:"#046C4E",800:"#03543F",900:"#014737"},jiqing:{50:"#EDFAFA",100:"#D5F5F6",200:"#AFECEF",300:"#7EDCE2",400:"#16BDCA",500:"#0694A2",600:"#047481",700:"#036672",800:"#05505C",900:"#014451"},indigo:{50:"#F3F5FF",100:"#E9EDFF",200:"#D2DAFA",300:"#BAC6F8",400:"#6280F9",500:"#466AF7",600:"#2C53F1",700:"#143EE3",800:"#083AD1",900:"#1033BF"},purple:{50:"#F6F5FF",100:"#EDEBFE",200:"#DCD7FE",300:"#CABFFD",400:"#AC94FA",500:"#9061F9",600:"#7E3AF2",700:"#6C2BD9",800:"#5521B5",900:"#4A1D96"},pink:{50:"#FDF2F8",100:"#FCE8F3",200:"#FAD1E8",300:"#F8B4D9",400:"#F17EB8",500:"#E74694",600:"#D61F69",700:"#BF125D",800:"#99154B",900:"#751A3D"},"loop-color":{1:"purple.400",2:"green.500",3:"blue.500",4:"yellow.400",5:"pink.300",6:"jiqing.600",7:"orange.400",8:"gray.800",9:"indigo.500",10:"red.300",11:"green.600",12:"yellow.700"}};var mg=Object.defineProperty,_g=(t,e,n)=>e in t?mg(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,b=(t,e,n)=>_g(t,typeof e!="symbol"?e+"":e,n);function yg(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const o=Object.getOwnPropertyDescriptor(r,s);o&&Object.defineProperty(t,s,o.get?o:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}const Qe=typeof global<"u"?global:typeof self<"u"?self:window;function vg(){const t=new Map;let e=0;typeof Qe.requestIdleCallback!="function"&&(Qe.requestIdleCallback=function(n){const r=Date.now(),s=++e,o=setTimeout(function(){t.delete(s);const i=Math.max(0,50-(Date.now()-r));n({didTimeout:i===0,timeRemaining(){return i}})},1);return t.set(s,o),s}),typeof Qe.cancelIdleCallback!="function"&&(Qe.cancelIdleCallback=function(n){const r=t.get(n);r!==void 0&&(clearTimeout(r),t.delete(n))})}function Eg(){typeof Qe.Array.prototype.findLastIndex!="function"&&(Qe.Array.prototype.findLastIndex=function(t,e){if(this==null)throw new TypeError("Array.prototype.findLastIndex called on null or undefined");if(typeof t!="function")throw new TypeError("callback must be a function");const n=this.length>>>0;for(let r=n-1;r>=0;r--)if(r in this&&t.call(e,this[r],r,this))return r;return-1}),typeof Qe.Array.prototype.findLast!="function"&&(Qe.Array.prototype.findLast=function(t,e){const n=this.findLastIndex(t,e);return n!==-1?this[n]:void 0})}function bg(){typeof Qe.String.prototype.at!="function"&&(Qe.String.prototype.at=function(t){if(this==null)throw new TypeError("String.prototype.at called on null or undefined");const e=this.length;if(t<0&&(t=e+t),!(t<0||t>=e))return this.charAt(t)})}function Cg(){vg(),Eg(),bg()}function go(t,e){const n=t.indexOf(e);return n>-1?(t.splice(n,1),!0):!1}function uT(t){const e=new Set,n=[];for(const r of t)e.has(r)||(e.add(r),n.push(r));return n}function cT(t,e){const n=new Set,r=[];for(const s of t){const o=e(s);n.has(o)||(n.add(o),r.push(s))}return r}function Rg(t,e){for(let n=t.length-1;n>-1;n--){const r=t[n];if(e(r,n))return r}return null}function dT(t,e){if(t.length===0)return t;const n=e%t.length;return t.slice(n).concat(t.slice(0,n))}function hT(t,e){const n=new Map;return t.forEach(r=>{const s=e(r);let o=n.get(s);n.has(s)||(o=[],n.set(s,o)),o.push(r)}),n}function fT(t){return Array.isArray(t)?t:[t]}function Fe(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Ho,su;function Tg(){if(su)return Ho;su=1;var t=function(e){if(e=e||{},this.Promise=e.Promise||Promise,this.queues=Object.create(null),this.domainReentrant=e.domainReentrant||!1,this.domainReentrant){if(typeof process>"u"||typeof process.domain>"u")throw new Error("Domain-reentrant locks require `process.domain` to exist. Please flip `opts.domainReentrant = false`, use a NodeJS version that still implements Domain, or install a browser polyfill.");this.domains=Object.create(null)}this.timeout=e.timeout||t.DEFAULT_TIMEOUT,this.maxOccupationTime=e.maxOccupationTime||t.DEFAULT_MAX_OCCUPATION_TIME,this.maxExecutionTime=e.maxExecutionTime||t.DEFAULT_MAX_EXECUTION_TIME,e.maxPending===1/0||Number.isInteger(e.maxPending)&&e.maxPending>=0?this.maxPending=e.maxPending:this.maxPending=t.DEFAULT_MAX_PENDING};return t.DEFAULT_TIMEOUT=0,t.DEFAULT_MAX_OCCUPATION_TIME=0,t.DEFAULT_MAX_EXECUTION_TIME=0,t.DEFAULT_MAX_PENDING=1e3,t.prototype.acquire=function(e,n,r,s){if(Array.isArray(e))return this._acquireBatch(e,n,r,s);if(typeof n!="function")throw new Error("You must pass a function to execute");var o=null,i=null,a=null;typeof r!="function"&&(s=r,r=null,a=new this.Promise(function(L,B){o=L,i=B})),s=s||{};var l=!1,u=null,c=null,d=null,h=this,f=function(L,B,C){c&&(clearTimeout(c),c=null),d&&(clearTimeout(d),d=null),L&&(h.queues[e]&&h.queues[e].length===0&&delete h.queues[e],h.domainReentrant&&delete h.domains[e]),l||(a?B?i(B):o(C):typeof r=="function"&&r(B,C),l=!0),L&&h.queues[e]&&h.queues[e].length>0&&h.queues[e].shift()()},p=function(L){if(l)return f(L);u&&(clearTimeout(u),u=null),h.domainReentrant&&L&&(h.domains[e]=process.domain);var B=s.maxExecutionTime||h.maxExecutionTime;if(B&&(d=setTimeout(function(){h.queues[e]&&f(L,new Error("Maximum execution time is exceeded "+e))},B)),n.length===1){var C=!1;try{n(function(R,y){C||(C=!0,f(L,R,y))})}catch(R){C||(C=!0,f(L,R))}}else h._promiseTry(function(){return n()}).then(function(R){f(L,void 0,R)},function(R){f(L,R)})};h.domainReentrant&&process.domain&&(p=process.domain.bind(p));var g=s.maxPending||h.maxPending;if(!h.queues[e])h.queues[e]=[],p(!0);else if(h.domainReentrant&&process.domain&&process.domain===h.domains[e])p(!1);else if(h.queues[e].length>=g)f(!1,new Error("Too many pending tasks in queue "+e));else{var _=function(){p(!0)};s.skipQueue?h.queues[e].unshift(_):h.queues[e].push(_);var I=s.timeout||h.timeout;I&&(u=setTimeout(function(){u=null,f(!1,new Error("async-lock timed out in queue "+e))},I))}var U=s.maxOccupationTime||h.maxOccupationTime;if(U&&(c=setTimeout(function(){h.queues[e]&&f(!1,new Error("Maximum occupation time is exceeded in queue "+e))},U)),a)return a},t.prototype._acquireBatch=function(e,n,r,s){typeof r!="function"&&(s=r,r=null);var o=this,i=function(l,u){return function(c){o.acquire(l,u,c,s)}},a=e.reduceRight(function(l,u){return i(u,l)},n);if(typeof r=="function")a(r);else return new this.Promise(function(l,u){a.length===1?a(function(c,d){c?u(c):l(d)}):l(a())})},t.prototype.isBusy=function(e){return e?!!this.queues[e]:Object.keys(this.queues).length>0},t.prototype._promiseTry=function(e){try{return this.Promise.resolve(e())}catch(n){return this.Promise.reject(n)}},Ho=t,Ho}var ou,iu;function wg(){return iu||(iu=1,ou=Tg()),ou}var Ig=wg();const pT=Fe(Ig),Sg=new Set(["true","false"]);function gT(t){return Sg.has(t.toLowerCase())}const us="__INTERNAL_EDITOR__",bd=`${us}DOCS_NORMAL`,Cd=`${us}DOCS_FORMULA_BAR`,Ag=`${us}ZEN_EDITOR`,Og=`\r
`,Dg="isRowStylePrecedeColumnStyle",xg=Symbol("AUTO_HEIGHT_FOR_MERGED_CELLS");function mT(t){return`${us}${t}`}function Ng(t){return t.startsWith(us)}function _T(t,e){e.forEach(n=>t.add(n))}function Mg(t,e){e.forEach(([n])=>{t.has(n)&&t.get(n)})}function Lg(t,e){if(Object.is(t,e))return!0;if(typeof t!="object"||!t||typeof e!="object"||!e)return!1;const n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;const s=Object.prototype.hasOwnProperty.bind(e);for(let o=0;o<n.length;o++){const i=n[o];if(!s(i))return!1;const a=t[i],l=e[i];if(a!==l)return!1}return!0}class _i extends Error{constructor(e){super(e),this.name="CustomCommandExecutionError"}}class yT extends _i{constructor(){super("Canceled by facade"),this.name="CanceledError"}}function vT(t,e=16){let n=0,r=null;return function(...s){const o=Date.now();o-n<e?(r&&clearTimeout(r),r=setTimeout(()=>{n=o,t.apply(this,s)},e)):(n=o,t.apply(this,s))}}var Hr=(t=>(t[t.Style=1]="Style",t[t.Value=2]="Value",t))(Hr||{});function ET(t){return`sheet_interceptor_${t}`}const Fg=t=>function(e,n){let r=-1,s=e;for(let o=0;o<=t.length;o++){if(o<=r)throw new Error("[SheetInterceptorService]: next() called multiple times!");if(r=o,o===t.length)return s;const i=t[o];let a=!1;if(s=i.handler(s,n,l=>(a=!0,l)),!a)break}return s};class bT{constructor(e){b(this,"_interceptorsByName",new Map),b(this,"_interceptorPoints"),this._interceptorPoints=e}fetchThroughInterceptors(e,n){const r=e;let s=this._interceptorsByName.get(r);return n&&(s=s.filter(n)),Fg(s||[])}intercept(e,n){const r=e;this._interceptorsByName.has(r)||this._interceptorsByName.set(r,[]);const s=this._interceptorsByName.get(r);return s.push(n),this._interceptorsByName.set(r,s.sort((o,i)=>{var a,l;return((a=i.priority)!=null?a:0)-((l=o.priority)!=null?l:0)})),()=>go(this._interceptorsByName.get(r),n)}getInterceptPoints(){return this._interceptorPoints}dispose(){this._interceptorsByName.clear()}}function CT(t){return`sheet_async_interceptor_${t}`}const kg=t=>async function(e,n){let r=-1,s=e;for(let o=0;o<=t.length;o++){if(o<=r)throw new Error("[SheetInterceptorService]: next() called multiple times!");if(r=o,o===t.length)return s;const i=t[o];let a=!1;if(s=await i.handler(s,n,async l=>(a=!0,l)),!a)break}return s};class RT{constructor(e){b(this,"_asyncInterceptorsByName",new Map),b(this,"_asyncInterceptorPoints"),this._asyncInterceptorPoints=e}fetchThroughAsyncInterceptors(e,n){const r=e;let s=this._asyncInterceptorsByName.get(r);return n&&(s=s.filter(n)),kg(s||[])}async interceptAsync(e,n){const r=e;this._asyncInterceptorsByName.has(r)||this._asyncInterceptorsByName.set(r,[]);const s=this._asyncInterceptorsByName.get(r);return s.push(n),this._asyncInterceptorsByName.set(r,s.sort((o,i)=>{var a,l;return((a=i.priority)!=null?a:0)-((l=o.priority)!=null?l:0)})),()=>go(this._asyncInterceptorsByName.get(r),n)}getInterceptPoints(){return this._asyncInterceptorPoints}dispose(){this._asyncInterceptorsByName.clear()}}function Rd(t){return t.map(e=>e/255)}function Td(t){return t.map(e=>Math.round(e*255))}function Pg([t,e,n]){const r=Math.max(t,e,n),s=Math.min(t,e,n),o=(r+s)/2;let i=0,a=0;if(r!==s){const l=r-s;switch(a=o>.5?l/(2-r-s):l/(r+s),r){case t:i=(e-n)/l+(e<n?6:0);break;case e:i=(n-t)/l+2;break;case n:i=(t-e)/l+4;break}i/=6}return[i,a,o]}function Qs(t,e,n){const r=[t,e,n].map(s=>s<=.03928?s/12.92:((s+.055)/1.055)**2.4);return .2126*r[0]+.7152*r[1]+.0722*r[2]}function au(t,e){return(Math.max(t,e)+.05)/(Math.min(t,e)+.05)}function Ug(t,e,n){let r,s,o;if(e===0)r=s=o=n;else{const i=(u,c,d)=>{let h=d;return h<0&&(h+=1),h>1&&(h-=1),h<.16666666666666666?u+(c-u)*6*h:h<.5?c:h<.6666666666666666?u+(c-u)*(.6666666666666666-h)*6:u},a=n<.5?n*(1+e):n+e-n*e,l=2*n-a;r=i(l,a,t+1/3),s=i(l,a,t),o=i(l,a,t-1/3)}return[r,s,o]}const jo={r:1,g:1,b:1},Vo={r:0,g:0,b:0},Bg=Qs(jo.r,jo.g,jo.b),$g=Qs(Vo.r,Vo.g,Vo.b);function Hg(t){const e=Qs(t[0],t[1],t[2]),n=au(Bg,e),r=Pg(t);let s=1-r[2],o,i,a;do o=Ug(r[0],r[1],s),i=Qs(o[0],o[1],o[2]),a=au(i,$g),s+=.01;while(s<=1&&s>=0&&Math.abs(a-n)<.01);return o}function TT(t){return Td(Hg(Rd(t)))}const Ae=[[.333,-.667,-.667,0,1],[-.667,.333,-.667,0,1],[-.667,-.667,.333,0,1],[0,0,0,1,0]];function jg(t){const e=t[0],n=t[1],r=t[2];let s=[Ae[0][0]*e+Ae[0][1]*n+Ae[0][2]*r+Ae[0][4],Ae[1][0]*e+Ae[1][1]*n+Ae[1][2]*r+Ae[1][4],Ae[2][0]*e+Ae[2][1]*n+Ae[2][2]*r+Ae[2][4]];return s=s.map(o=>o>1?1:o<0?0:o),s}function wT(t){return Td(jg(Rd(t)))}var wd=typeof global=="object"&&global&&global.Object===Object&&global,Vg=typeof self=="object"&&self&&self.Object===Object&&self,Bn=wd||Vg||Function("return this")(),gr=Bn.Symbol,Id=Object.prototype,Wg=Id.hasOwnProperty,Gg=Id.toString,Nr=gr?gr.toStringTag:void 0;function Yg(t){var e=Wg.call(t,Nr),n=t[Nr];try{t[Nr]=void 0;var r=!0}catch{}var s=Gg.call(t);return r&&(e?t[Nr]=n:delete t[Nr]),s}var zg=Object.prototype,Kg=zg.toString;function Xg(t){return Kg.call(t)}var Jg="[object Null]",Zg="[object Undefined]",lu=gr?gr.toStringTag:void 0;function cs(t){return t==null?t===void 0?Zg:Jg:lu&&lu in Object(t)?Yg(t):Xg(t)}function Sr(t){return t!=null&&typeof t=="object"}var Qg="[object Symbol]";function mo(t){return typeof t=="symbol"||Sr(t)&&cs(t)==Qg}function qg(t,e){for(var n=-1,r=t==null?0:t.length,s=Array(r);++n<r;)s[n]=e(t[n],n,t);return s}var mr=Array.isArray,uu=gr?gr.prototype:void 0,cu=uu?uu.toString:void 0;function Sd(t){if(typeof t=="string")return t;if(mr(t))return qg(t,Sd)+"";if(mo(t))return cu?cu.call(t):"";var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}var tm=/\s/;function em(t){for(var e=t.length;e--&&tm.test(t.charAt(e)););return e}var nm=/^\s+/;function rm(t){return t&&t.slice(0,em(t)+1).replace(nm,"")}function Me(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var du=NaN,sm=/^[-+]0x[0-9a-f]+$/i,om=/^0b[01]+$/i,im=/^0o[0-7]+$/i,am=parseInt;function hu(t){if(typeof t=="number")return t;if(mo(t))return du;if(Me(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=Me(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=rm(t);var n=om.test(t);return n||im.test(t)?am(t.slice(2),n?2:8):sm.test(t)?du:+t}function Ad(t){return t}var lm="[object AsyncFunction]",um="[object Function]",cm="[object GeneratorFunction]",dm="[object Proxy]";function Ra(t){if(!Me(t))return!1;var e=cs(t);return e==um||e==cm||e==lm||e==dm}var Wo=Bn["__core-js_shared__"],fu=function(){var t=/[^.]+$/.exec(Wo&&Wo.keys&&Wo.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function hm(t){return!!fu&&fu in t}var fm=Function.prototype,pm=fm.toString;function gm(t){if(t!=null){try{return pm.call(t)}catch{}try{return t+""}catch{}}return""}var mm=/[\\^$.*+?()[\]{}|]/g,_m=/^\[object .+?Constructor\]$/,ym=Function.prototype,vm=Object.prototype,Em=ym.toString,bm=vm.hasOwnProperty,Cm=RegExp("^"+Em.call(bm).replace(mm,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Rm(t){if(!Me(t)||hm(t))return!1;var e=Ra(t)?Cm:_m;return e.test(gm(t))}function Tm(t,e){return t==null?void 0:t[e]}function Ta(t,e){var n=Tm(t,e);return Rm(n)?n:void 0}var pu=Object.create,wm=function(){function t(){}return function(e){if(!Me(e))return{};if(pu)return pu(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();function Im(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function Sm(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e}var Am=800,Om=16,Dm=Date.now;function xm(t){var e=0,n=0;return function(){var r=Dm(),s=Om-(r-n);if(n=r,s>0){if(++e>=Am)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}function Nm(t){return function(){return t}}var qs=function(){try{var t=Ta(Object,"defineProperty");return t({},"",{}),t}catch{}}(),Mm=qs?function(t,e){return qs(t,"toString",{configurable:!0,enumerable:!1,value:Nm(e),writable:!0})}:Ad,Lm=xm(Mm),Fm=9007199254740991,km=/^(?:0|[1-9]\d*)$/;function wa(t,e){var n=typeof t;return e=e??Fm,!!e&&(n=="number"||n!="symbol"&&km.test(t))&&t>-1&&t%1==0&&t<e}function Ia(t,e,n){e=="__proto__"&&qs?qs(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function _o(t,e){return t===e||t!==t&&e!==e}var Pm=Object.prototype,Um=Pm.hasOwnProperty;function Od(t,e,n){var r=t[e];(!(Um.call(t,e)&&_o(r,n))||n===void 0&&!(e in t))&&Ia(t,e,n)}function Bm(t,e,n,r){var s=!n;n||(n={});for(var o=-1,i=e.length;++o<i;){var a=e[o],l=void 0;l===void 0&&(l=t[a]),s?Ia(n,a,l):Od(n,a,l)}return n}var gu=Math.max;function $m(t,e,n){return e=gu(e===void 0?t.length-1:e,0),function(){for(var r=arguments,s=-1,o=gu(r.length-e,0),i=Array(o);++s<o;)i[s]=r[e+s];s=-1;for(var a=Array(e+1);++s<e;)a[s]=r[s];return a[e]=n(i),Im(t,this,a)}}function Hm(t,e){return Lm($m(t,e,Ad),t+"")}var jm=9007199254740991;function Dd(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=jm}function Sa(t){return t!=null&&Dd(t.length)&&!Ra(t)}function Vm(t,e,n){if(!Me(n))return!1;var r=typeof e;return(r=="number"?Sa(n)&&wa(e,n.length):r=="string"&&e in n)?_o(n[e],t):!1}function xd(t){return Hm(function(e,n){var r=-1,s=n.length,o=s>1?n[s-1]:void 0,i=s>2?n[2]:void 0;for(o=t.length>3&&typeof o=="function"?(s--,o):void 0,i&&Vm(n[0],n[1],i)&&(o=s<3?void 0:o,s=1),e=Object(e);++r<s;){var a=n[r];a&&t(e,a,r,o)}return e})}var Wm=Object.prototype;function Nd(t){var e=t&&t.constructor,n=typeof e=="function"&&e.prototype||Wm;return t===n}function Gm(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}var Ym="[object Arguments]";function mu(t){return Sr(t)&&cs(t)==Ym}var Md=Object.prototype,zm=Md.hasOwnProperty,Km=Md.propertyIsEnumerable,yi=mu(function(){return arguments}())?mu:function(t){return Sr(t)&&zm.call(t,"callee")&&!Km.call(t,"callee")};function Xm(){return!1}var Ld=typeof exports=="object"&&exports&&!exports.nodeType&&exports,_u=Ld&&typeof module=="object"&&module&&!module.nodeType&&module,Jm=_u&&_u.exports===Ld,yu=Jm?Bn.Buffer:void 0,Zm=yu?yu.isBuffer:void 0,Fd=Zm||Xm,Qm="[object Arguments]",qm="[object Array]",t0="[object Boolean]",e0="[object Date]",n0="[object Error]",r0="[object Function]",s0="[object Map]",o0="[object Number]",i0="[object Object]",a0="[object RegExp]",l0="[object Set]",u0="[object String]",c0="[object WeakMap]",d0="[object ArrayBuffer]",h0="[object DataView]",f0="[object Float32Array]",p0="[object Float64Array]",g0="[object Int8Array]",m0="[object Int16Array]",_0="[object Int32Array]",y0="[object Uint8Array]",v0="[object Uint8ClampedArray]",E0="[object Uint16Array]",b0="[object Uint32Array]",jt={};jt[f0]=jt[p0]=jt[g0]=jt[m0]=jt[_0]=jt[y0]=jt[v0]=jt[E0]=jt[b0]=!0;jt[Qm]=jt[qm]=jt[d0]=jt[t0]=jt[h0]=jt[e0]=jt[n0]=jt[r0]=jt[s0]=jt[o0]=jt[i0]=jt[a0]=jt[l0]=jt[u0]=jt[c0]=!1;function C0(t){return Sr(t)&&Dd(t.length)&&!!jt[cs(t)]}function R0(t){return function(e){return t(e)}}var kd=typeof exports=="object"&&exports&&!exports.nodeType&&exports,qr=kd&&typeof module=="object"&&module&&!module.nodeType&&module,T0=qr&&qr.exports===kd,Go=T0&&wd.process,vu=function(){try{var t=qr&&qr.require&&qr.require("util").types;return t||Go&&Go.binding&&Go.binding("util")}catch{}}(),Eu=vu&&vu.isTypedArray,Pd=Eu?R0(Eu):C0;function w0(t,e){var n=mr(t),r=!n&&yi(t),s=!n&&!r&&Fd(t),o=!n&&!r&&!s&&Pd(t),i=n||r||s||o,a=i?Gm(t.length,String):[],l=a.length;for(var u in t)i&&(u=="length"||s&&(u=="offset"||u=="parent")||o&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||wa(u,l))||a.push(u);return a}function I0(t,e){return function(n){return t(e(n))}}function S0(t){var e=[];if(t!=null)for(var n in Object(t))e.push(n);return e}var A0=Object.prototype,O0=A0.hasOwnProperty;function D0(t){if(!Me(t))return S0(t);var e=Nd(t),n=[];for(var r in t)r=="constructor"&&(e||!O0.call(t,r))||n.push(r);return n}function Ud(t){return Sa(t)?w0(t):D0(t)}var x0=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,N0=/^\w*$/;function M0(t,e){if(mr(t))return!1;var n=typeof t;return n=="number"||n=="symbol"||n=="boolean"||t==null||mo(t)?!0:N0.test(t)||!x0.test(t)||e!=null&&t in Object(e)}var ss=Ta(Object,"create");function L0(){this.__data__=ss?ss(null):{},this.size=0}function F0(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var k0="__lodash_hash_undefined__",P0=Object.prototype,U0=P0.hasOwnProperty;function B0(t){var e=this.__data__;if(ss){var n=e[t];return n===k0?void 0:n}return U0.call(e,t)?e[t]:void 0}var $0=Object.prototype,H0=$0.hasOwnProperty;function j0(t){var e=this.__data__;return ss?e[t]!==void 0:H0.call(e,t)}var V0="__lodash_hash_undefined__";function W0(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=ss&&e===void 0?V0:e,this}function kn(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}kn.prototype.clear=L0;kn.prototype.delete=F0;kn.prototype.get=B0;kn.prototype.has=j0;kn.prototype.set=W0;function G0(){this.__data__=[],this.size=0}function yo(t,e){for(var n=t.length;n--;)if(_o(t[n][0],e))return n;return-1}var Y0=Array.prototype,z0=Y0.splice;function K0(t){var e=this.__data__,n=yo(e,t);if(n<0)return!1;var r=e.length-1;return n==r?e.pop():z0.call(e,n,1),--this.size,!0}function X0(t){var e=this.__data__,n=yo(e,t);return n<0?void 0:e[n][1]}function J0(t){return yo(this.__data__,t)>-1}function Z0(t,e){var n=this.__data__,r=yo(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this}function hn(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}hn.prototype.clear=G0;hn.prototype.delete=K0;hn.prototype.get=X0;hn.prototype.has=J0;hn.prototype.set=Z0;var Bd=Ta(Bn,"Map");function Q0(){this.size=0,this.__data__={hash:new kn,map:new(Bd||hn),string:new kn}}function q0(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function vo(t,e){var n=t.__data__;return q0(e)?n[typeof e=="string"?"string":"hash"]:n.map}function t_(t){var e=vo(this,t).delete(t);return this.size-=e?1:0,e}function e_(t){return vo(this,t).get(t)}function n_(t){return vo(this,t).has(t)}function r_(t,e){var n=vo(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this}function Cn(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}Cn.prototype.clear=Q0;Cn.prototype.delete=t_;Cn.prototype.get=e_;Cn.prototype.has=n_;Cn.prototype.set=r_;var s_="Expected a function";function Aa(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(s_);var n=function(){var r=arguments,s=e?e.apply(this,r):r[0],o=n.cache;if(o.has(s))return o.get(s);var i=t.apply(this,r);return n.cache=o.set(s,i)||o,i};return n.cache=new(Aa.Cache||Cn),n}Aa.Cache=Cn;var o_=500;function i_(t){var e=Aa(t,function(r){return n.size===o_&&n.clear(),r}),n=e.cache;return e}var a_=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,l_=/\\(\\)?/g,u_=i_(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(a_,function(n,r,s,o){e.push(s?o.replace(l_,"$1"):r||n)}),e});function c_(t){return t==null?"":Sd(t)}function $d(t,e){return mr(t)?t:M0(t,e)?[t]:u_(c_(t))}function Hd(t){if(typeof t=="string"||mo(t))return t;var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}function d_(t,e){e=$d(e,t);for(var n=0,r=e.length;t!=null&&n<r;)t=t[Hd(e[n++])];return n&&n==r?t:void 0}function h_(t,e,n){var r=t==null?void 0:d_(t,e);return r===void 0?n:r}var jd=I0(Object.getPrototypeOf,Object),f_="[object Object]",p_=Function.prototype,g_=Object.prototype,Vd=p_.toString,m_=g_.hasOwnProperty,__=Vd.call(Object);function y_(t){if(!Sr(t)||cs(t)!=f_)return!1;var e=jd(t);if(e===null)return!0;var n=m_.call(e,"constructor")&&e.constructor;return typeof n=="function"&&n instanceof n&&Vd.call(n)==__}function v_(){this.__data__=new hn,this.size=0}function E_(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}function b_(t){return this.__data__.get(t)}function C_(t){return this.__data__.has(t)}var R_=200;function T_(t,e){var n=this.__data__;if(n instanceof hn){var r=n.__data__;if(!Bd||r.length<R_-1)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new Cn(r)}return n.set(t,e),this.size=n.size,this}function Ar(t){var e=this.__data__=new hn(t);this.size=e.size}Ar.prototype.clear=v_;Ar.prototype.delete=E_;Ar.prototype.get=b_;Ar.prototype.has=C_;Ar.prototype.set=T_;var Wd=typeof exports=="object"&&exports&&!exports.nodeType&&exports,bu=Wd&&typeof module=="object"&&module&&!module.nodeType&&module,w_=bu&&bu.exports===Wd,Cu=w_?Bn.Buffer:void 0;Cu&&Cu.allocUnsafe;function I_(t,e){return t.slice()}var Ru=Bn.Uint8Array;function S_(t){var e=new t.constructor(t.byteLength);return new Ru(e).set(new Ru(t)),e}function A_(t,e){var n=S_(t.buffer);return new t.constructor(n,t.byteOffset,t.length)}function O_(t){return typeof t.constructor=="function"&&!Nd(t)?wm(jd(t)):{}}function D_(t){return function(e,n,r){for(var s=-1,o=Object(e),i=r(e),a=i.length;a--;){var l=i[++s];if(n(o[l],l,o)===!1)break}return e}}var x_=D_(),Yo=function(){return Bn.Date.now()},N_="Expected a function",M_=Math.max,L_=Math.min;function IT(t,e,n){var r,s,o,i,a,l,u=0,c=!1,d=!1,h=!0;if(typeof t!="function")throw new TypeError(N_);e=hu(e)||0,Me(n)&&(c=!!n.leading,d="maxWait"in n,o=d?M_(hu(n.maxWait)||0,e):o,h="trailing"in n?!!n.trailing:h);function f(R){var y=r,N=s;return r=s=void 0,u=R,i=t.apply(N,y),i}function p(R){return u=R,a=setTimeout(I,e),c?f(R):i}function g(R){var y=R-l,N=R-u,G=e-y;return d?L_(G,o-N):G}function _(R){var y=R-l,N=R-u;return l===void 0||y>=e||y<0||d&&N>=o}function I(){var R=Yo();if(_(R))return U(R);a=setTimeout(I,g(R))}function U(R){return a=void 0,h&&r?f(R):(r=s=void 0,i)}function L(){a!==void 0&&clearTimeout(a),u=0,r=l=s=a=void 0}function B(){return a===void 0?i:U(Yo())}function C(){var R=Yo(),y=_(R);if(r=arguments,s=this,l=R,y){if(a===void 0)return p(l);if(d)return clearTimeout(a),a=setTimeout(I,e),f(l)}return a===void 0&&(a=setTimeout(I,e)),i}return C.cancel=L,C.flush=B,C}function vi(t,e,n){(n!==void 0&&!_o(t[e],n)||n===void 0&&!(e in t))&&Ia(t,e,n)}function F_(t){return Sr(t)&&Sa(t)}function Ei(t,e){if(!(e==="constructor"&&typeof t[e]=="function")&&e!="__proto__")return t[e]}function k_(t){return Bm(t,Ud(t))}function P_(t,e,n,r,s,o,i){var a=Ei(t,n),l=Ei(e,n),u=i.get(l);if(u){vi(t,n,u);return}var c=o?o(a,l,n+"",t,e,i):void 0,d=c===void 0;if(d){var h=mr(l),f=!h&&Fd(l),p=!h&&!f&&Pd(l);c=l,h||f||p?mr(a)?c=a:F_(a)?c=Sm(a):f?(d=!1,c=I_(l)):p?(d=!1,c=A_(l)):c=[]:y_(l)||yi(l)?(c=a,yi(a)?c=k_(a):(!Me(a)||Ra(a))&&(c=O_(l))):d=!1}d&&(i.set(l,c),s(c,l,r,o,i),i.delete(l)),vi(t,n,c)}function Oa(t,e,n,r,s){t!==e&&x_(e,function(o,i){if(s||(s=new Ar),Me(o))P_(t,e,i,n,Oa,r,s);else{var a=r?r(Ei(t,i),o,i+"",t,e,s):void 0;a===void 0&&(a=o),vi(t,i,a)}},Ud)}var ST=xd(function(t,e,n,r){Oa(t,e,n,r)}),Da=xd(function(t,e,n){Oa(t,e,n)});function U_(t,e,n,r){if(!Me(t))return t;e=$d(e,t);for(var s=-1,o=e.length,i=o-1,a=t;a!=null&&++s<o;){var l=Hd(e[s]),u=n;if(l==="__proto__"||l==="constructor"||l==="prototype")return t;if(s!=i){var c=a[l];u=void 0,u===void 0&&(u=Me(c)?c:wa(e[s+1])?[]:{})}Od(a,l,u),a=a[l]}return t}function AT(t,e,n){return t==null?t:U_(t,e,n)}class Or{constructor(){b(this,"cursor",0)}reset(){return this.cursor=0,this}moveCursor(e){this.cursor+=e}moveCursorTo(e){this.cursor=e}}function OT(t,e){for(const n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}function B_(t){return/^-?\d+(\.\d+)?$/.test(t)}function DT(t){return B_(t)?Number(t)<=Number.MAX_SAFE_INTEGER:!1}function xT(t){return Number(t)>Number.MAX_SAFE_INTEGER||t.length>=18}class Gd{constructor(){b(this,"_data",[])}static create(){return new Gd}add(e){this._data.indexOf(e)>-1||this._data.push(e)}delete(e){const n=this._data.indexOf(e);this._data.splice(n,1)}getData(){return this._data}}class Yd{constructor(){b(this,"_data",new Map)}static create(){return new Yd}add(e,n){this._data.has(e)||this._data.set(e,n)}delete(e){this._data.delete(e)}getData(){return this._data}}function NT(t){const e=new MessageChannel;let n=!1;const r=()=>{n||t()};return e.port1.onmessage=r,e.port2.postMessage(null),()=>{n=!0,e.port1.onmessage=null,e.port1.close(),e.port2.close()}}async function $_(t){for(const[e,n]of t.entries())try{if(!await n())return{index:e,result:!1}}catch(r){return{index:e,result:!1,error:r}}return{result:!0,index:-1}}function H_(t){for(const[e,n]of t.entries())try{if(!n())return{index:e,result:!1}}catch(r){return{index:e,result:!1,error:r}}return{result:!0,index:-1}}function MT(t,e){return e.forEach(n=>t.add(n)),t}function j_(t){return t instanceof Tr||t instanceof ce||t&&"closed"in t&&typeof t.unsubscribe<"u"}function Zt(t){let e=!1;return t?j_(t)?{dispose:()=>t.unsubscribe()}:typeof t=="function"?{dispose:()=>{e||(e=!0,t())}}:t:Zt(()=>{})}function LT(t){return Zt(()=>{t.unsubscribe()})}class xa{constructor(){b(this,"_disposables",new Set)}add(e){const n=Zt(e);return this._disposables.add(n),{dispose:(r=!1)=>{r||n.dispose(),this._disposables.delete(n)}}}dispose(){this._disposables.forEach(e=>{e.dispose()}),this._disposables.clear()}}class ee{constructor(){b(this,"_disposed",!1),b(this,"_collection",new xa)}disposeWithMe(e){return this._collection.add(e)}ensureNotDisposed(){if(this._disposed)throw new Error("[Disposable]: object is disposed!")}dispose(){this._disposed||(this._disposed=!0,this._collection.dispose())}}class FT extends ee{constructor(){super(...arguments),b(this,"dispose$",new ce)}dispose(){super.dispose(),this.dispose$.next(),this.dispose$.complete()}}class kT extends ee{constructor(e){super(),b(this,"_ref",0),this._rootDisposable=e}inc(){if(this._disposed)throw new Error("[RCDisposable]: should not ref to a disposed.");this._ref+=1}dec(){this._ref-=1,this._ref===0&&(this._rootDisposable.dispose(),this.dispose())}}var It=(t=>(t[t.UNIVER_UNKNOWN=0]="UNIVER_UNKNOWN",t[t.UNIVER_DOC=1]="UNIVER_DOC",t[t.UNIVER_SHEET=2]="UNIVER_SHEET",t[t.UNIVER_SLIDE=3]="UNIVER_SLIDE",t[t.UNIVER_PROJECT=4]="UNIVER_PROJECT",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED",t))(It||{}),Ze=(t=>(t[t.Reader=0]="Reader",t[t.Editor=1]="Editor",t[t.Owner=2]="Owner",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED",t))(Ze||{}),bi=(t=>(t[t.SomeCollaborator=0]="SomeCollaborator",t[t.AllCollaborator=1]="AllCollaborator",t[t.OneSelf=2]="OneSelf",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED",t))(bi||{});class Na extends ee{}const V_="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let W_=t=>crypto.getRandomValues(new Uint8Array(t)),G_=(t,e,n)=>{let r=(2<<Math.log2(t.length-1))-1,s=-~(1.6*r*e/t.length);return(o=e)=>{let i="";for(;;){let a=n(s),l=s|0;for(;l--;)if(i+=t[a[l]&r]||"",i.length>=o)return i}}},Y_=(t,e=21)=>G_(t,e|0,W_),z_=(t=21)=>{let e="",n=crypto.getRandomValues(new Uint8Array(t|=0));for(;t--;)e+=V_[n[t]&63];return e};const zd=new Set(["ac","ad","ae","aero","af","ag","ai","al","am","ao","aq","ar","arpa","as","asia","at","au","aw","ax","az","ba","bb","bd","be","bf","bg","bh","bi","biz","bj","bm","bn","bo","br","bs","bt","bv","bw","by","bz","ca","cat","cc","cd","cf","cg","ch","ci","ck","cl","cm","cn","co","com","coop","cr","cu","cv","cw","cx","cy","cz","de","dj","dk","dm","do","dz","ec","edu","ee","eg","er","es","et","eu","fi","fj","fk","fm","fo","fr","ga","gb","gd","ge","gf","gg","gh","gi","gl","gm","gn","gov","gp","gq","gr","gs","gt","gu","gw","gy","hk","hm","hn","hr","ht","hu","id","ie","il","im","in","info","int","io","iq","ir","is","it","je","jm","jo","jobs","jp","ke","kg","kh","ki","km","kn","kp","kr","kw","ky","kz","la","lb","lc","li","lk","lr","ls","lt","lu","lv","ly","ma","mc","md","me","mg","mh","mil","mk","ml","mm","mn","mo","mobi","mp","mq","mr","ms","mt","mu","museum","mv","mw","mx","my","mz","na","name","nc","ne","net","nf","ng","ni","nl","no","np","nr","nu","nz","om","onion","org","pa","pe","pf","pg","ph","pk","pl","pm","pn","post","pr","pro","ps","pt","pw","py","qa","re","ro","rs","ru","rw","sa","sb","sc","sd","se","sg","sh","si","sj","sk","sl","sm","sn","so","sr","ss","st","su","sv","sx","sy","sz","tc","td","tel","tf","tg","th","tj","tk","tl","tm","tn","to","tr","tt","tv","tw","tz","ua","ug","uk","us","uy","uz","va","vc","ve","vg","vi","vn","vu","wf","ws","yt","za","zm","zw"]),K_=new RegExp("^(?:(?:(?:https?|ftp):)?\\/\\/)?(?:\\S+(?::\\S*)?@)?(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z0-9\\u00a1-\\uffff][a-z0-9\\u00a1-\\uffff_-]{0,62})?[a-z0-9\\u00a1-\\uffff]\\.)+(?:[a-z\\u00a1-\\uffff]{2,}\\.?))(?::\\d{2,5})?(?:[/?#]\\S*)?$","i");function X_(t){if(!Number.isNaN(+t))return!1;if(t.startsWith("http://localhost:3002")||t.startsWith("localhost:3002"))return!0;if(K_.test(t)){if(Kd(t))return!0;try{const e=new URL(Xd(t)).hostname.split(".").pop();if(e&&zd.has(e))return!0}catch{return!1}}return!1}function Kd(t){return/^[a-zA-Z]+:\/\//.test(t)}function J_(t){return/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/.test(t)}function Xd(t){return Kd(t)?t:J_(t)?`mailto://${t}`:`https://${t}`}const gn=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function Ma(t,e){const n=et.getValueType(t),r=et.getValueType(e);return n!==r?!1:et.isArray(t)?Z_(t,e):et.isObject(t)?Q_(t,e):et.isDate(t)?t.getTime()===e.getTime():et.isRegExp(t)?t.toString()===e.toString():t===e}function Z_(t,e){if(t.length!==e.length)return!1;for(let n=0,r=t.length;n<r;n++){const s=t[n],o=e[n];if(!Ma(s,o))return!1}return!0}function Q_(t,e){const n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(const s of n){if(!r.includes(s))return!1;const o=t[s],i=e[s];if(!Ma(o,i))return!1}return!0}class et{static deleteNull(e){for(const n in e)(e[n]===null||e[n]===void 0)&&delete e[n];return e}static stringAt(e){let n="",r=e;for(;r>=gn.length;)r/=gn.length,r-=1,n+=gn[r%gn.length];const s=e%gn.length;return n+=gn[s],n}static indexAt(e){let n=0;for(let r=0;r<e.length-1;r+=1){const s=e.charCodeAt(r)-65,o=e.length-1-r;n+=gn.length**o+gn.length*s}return n+=e.charCodeAt(e.length-1)-65,n}static deleteBlank(e){return et.isString(e)?e.replace(/\s/g,""):e}static getSystemType(){const e=navigator.userAgent,n=navigator.platform==="Win32"||navigator.platform==="Windows",r=navigator.platform==="Mac68K"||navigator.platform==="MacPPC"||navigator.platform==="Macintosh"||navigator.platform==="MacIntel";if(r)return"Mac";if(navigator.platform==="X11"&&!n&&!r)return"Unix";if(String(navigator.platform).indexOf("Linux")>-1)return"Linux";if(n){if(e.indexOf("Windows NT 5.0")>-1||e.indexOf("Windows 2000")>-1)return"Windows 2000";if(e.indexOf("Windows NT 5.1")>-1||e.indexOf("Windows XP")>-1)return"Windows XP";if(e.indexOf("Windows NT 5.2")>-1||e.indexOf("Windows 2003")>-1)return"Windows 2003";if(e.indexOf("Windows NT 6.0")>-1||e.indexOf("Windows Vista")>-1)return"Windows Vista";if(e.indexOf("Windows NT 6.1")>-1||e.indexOf("Windows 7")>-1)return"Windows 7";if(e.indexOf("Windows NT 10")>-1||e.indexOf("Windows 10")>-1)return"Windows 10";if(e.indexOf("Windows NT 11")>-1||e.indexOf("Windows 11")>-1)return"Windows 11"}return"Unknown system"}static getBrowserType(){const e=navigator.userAgent,n=e.indexOf("Opera")>-1,r=e.indexOf("compatible")>-1&&e.indexOf("MSIE")>-1&&!n,s=e.indexOf("Trident")>-1&&e.indexOf("rv:11.0")>-1,o=e.indexOf("Edge")>-1,i=e.indexOf("Firefox")>-1,a=e.indexOf("Safari")>-1&&e.indexOf("Chrome")===-1,l=e.indexOf("Chrome")>-1&&e.indexOf("Safari")>-1;if(r){new RegExp("MSIE (\\d+\\.\\d+);").test(e);const u=Number.parseFloat(RegExp.$1);return u===7?"IE7":u===8?"IE8":u===9?"IE9":u===10?"IE10":"0"}return i?"FF":n?"Opera":a?"Safari":l?"Chrome":o?"Edge":s?"IE11":"Unknown browser"}static getClassName(e){return e.constructor.name}static deepMerge(e,...n){n.forEach(i=>i&&o(i));function r(i,a){i.forEach((l,u)=>{var c,d;if(et.isArray(l)){const h=(c=a[u])!=null?c:[];a[u]=h,r(l,h);return}if(et.isObject(l)){const h=(d=a[u])!=null?d:{};a[u]=h,s(l,h);return}a[u]=l})}function s(i,a){Object.keys(i).forEach(l=>{var u,c;const d=i[l];if(et.isObject(d)){const h=(u=a[l])!=null?u:{};a[l]=h,s(d,h);return}if(et.isArray(d)){const h=(c=a[l])!=null?c:[];a[l]=h,r(d,h);return}a[l]=d})}function o(i){Object.keys(i).forEach(a=>{var l,u;const c=i[a];if(et.isArray(c)){const d=(l=e[a])!=null?l:[];e[a]=d,r(c,d);return}if(et.isObject(c)){const d=(u=e[a])!=null?u:{};e[a]=d,s(c,d);return}e[a]=c})}return e}static numberFixed(e,n){return Number(Number(e).toFixed(n))}static diffValue(e,n){return Ma(e,n)}static deepClone(e){if(!this.isDefine(e))return e;if(this.isRegExp(e))return new RegExp(e);if(this.isDate(e))return new Date(e);if(this.isArray(e)){const n=[];return e.forEach((r,s)=>{n[s]=et.deepClone(r)}),n}if(this.isObject(e)){const n={};return Object.keys(e).forEach(r=>{const s=e[r];n[r]=et.deepClone(s)}),Object.setPrototypeOf(n,Object.getPrototypeOf(e)),n}return e}static getLanguage(){return globalThis.navigator&&(navigator.languages&&navigator.languages[0]||navigator.language)||"en-US"}static getValueType(e){return Object.prototype.toString.apply(e)}static isDefine(e){return e!=null}static isBlank(e){return this.isDefine(e)?this.isString(e)?e.trim()==="":!1:!0}static isPlainObject(e){return this.isDefine(e)?Object.getPrototypeOf(e)===Object.getPrototypeOf({}):!1}static isDate(e){return this.getValueType(e)==="[object Date]"}static isRegExp(e){return this.getValueType(e)==="[object RegExp]"}static isArray(e){return this.getValueType(e)==="[object Array]"}static isString(e){return this.getValueType(e)==="[object String]"}static isNumber(e){return this.getValueType(e)==="[object Number]"}static isStringNumber(e){return!isNaN(Number.parseFloat(e))&&isFinite(e)}static isObject(e){return this.getValueType(e)==="[object Object]"}static isEmptyObject(e){for(const n in e)return!1;return!0}static isTablet(){return/ipad|android|android 3.0|xoom|sch-i800|playbook|tablet|kindle/i.test(navigator.userAgent.toLowerCase())}static isIPhone(){return/iPhone/i.test(navigator.userAgent)}static isLegalUrl(e){return X_(e)}static normalizeUrl(e){return Xd(e)}static topLevelDomainCombiningString(){return[...zd].join("|")}static removeNull(e){return this.isObject(e)&&Object.keys(e).forEach(n=>{const r=e[n];r==null?delete e[n]:et.removeNull(r)}),e}static fillTwoDimensionalArray(e,n,r){return new Array(e).fill(r).map(s=>new Array(n).fill(r))}static numToWord(e){let n="";for(;e>0;){let r=e%26;r=r===0?r=26:r,n=String.fromCharCode(96+r)+n,e=(e-r)/26}return n.toLocaleUpperCase()}static ABCatNum(e){if(e==null||e.length===0)return Number.NaN;const n=e.toLowerCase().split(""),r=n.length;let s=0,o=0;for(let i=0;i<r;i++)o=n[i].charCodeAt(0)-96,s+=o*26**(r-i-1);return s===0?Number.NaN:s-1}static chatAtABC(e){let n="";for(;e>=0;)n=String.fromCharCode(e%26+97)+n,e=Math.floor(e/26)-1;return n.toUpperCase()}static commonExtend(e,n){const r={};for(const s in e)r[s]=e[s];for(const s in n)n[s]!=null&&(r[s]=n[s]);return r}static hasIntersectionBetweenTwoRanges(e,n,r,s){return n>=r&&s>=e}static isStartValidPosition(e){return/^[A-Za-z--_]/.test(e)}static isValidParameter(e){const n=/[~!@#$%^&*()+=\-{}\[\]\|:;"'<>,?\/ ]+/.test(e),r=e.length<=255;return!n&&r}static clamp(e,n,r){return Math.max(n,Math.min(r,e))}static now(){return performance&&performance.now?performance.now():Date.now()}}function ue(t=21,e){return e?Y_(e,t)():z_(t)}function ys(...t){const e={},n=t.length;for(let r=n-1;r>=0;r--){const s=t[r];if(s){const o=Object.keys(s);for(const i of o)e[i]===void 0&&(e[i]=s[i])}}return e}const PT=()=>typeof process<"u"&&process.versions!=null&&process.versions.node!=null;function UT(t){const e=t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/\\\*/g,".*").replace(/\\\?/g,".");return new RegExp(`^${e}$`,"i")}var q_=(t=>(t[t.DEFAULT_SERIES=0]="DEFAULT_SERIES",t[t.ALTERNATE_SERIES=1]="ALTERNATE_SERIES",t))(q_||{}),Pt=(t=>(t[t.NONE=0]="NONE",t[t.THIN=1]="THIN",t[t.HAIR=2]="HAIR",t[t.DOTTED=3]="DOTTED",t[t.DASHED=4]="DASHED",t[t.DASH_DOT=5]="DASH_DOT",t[t.DASH_DOT_DOT=6]="DASH_DOT_DOT",t[t.DOUBLE=7]="DOUBLE",t[t.MEDIUM=8]="MEDIUM",t[t.MEDIUM_DASHED=9]="MEDIUM_DASHED",t[t.MEDIUM_DASH_DOT=10]="MEDIUM_DASH_DOT",t[t.MEDIUM_DASH_DOT_DOT=11]="MEDIUM_DASH_DOT_DOT",t[t.SLANT_DASH_DOT=12]="SLANT_DASH_DOT",t[t.THICK=13]="THICK",t))(Pt||{}),ty=(t=>(t.TOP="top",t.BOTTOM="bottom",t.LEFT="left",t.RIGHT="right",t.NONE="none",t.ALL="all",t.OUTSIDE="outside",t.INSIDE="inside",t.HORIZONTAL="horizontal",t.VERTICAL="vertical",t.TLBR="tlbr",t.TLBC_TLMR="tlbc_tlmr",t.TLBR_TLBC_TLMR="tlbr_tlbc_tlmr",t.BLTR="bl_tr",t.MLTR_BCTR="mltr_bctr",t))(ty||{}),He=(t=>(t[t.UNSUPPORTED=0]="UNSUPPORTED",t[t.RGB=1]="RGB",t[t.HEX=2]="HEX",t[t.THEME=3]="THEME",t))(He||{}),ey=(t=>(t[t.ON=0]="ON",t[t.OFF=1]="OFF",t))(ey||{}),ny=(t=>(t[t.PASTE_NORMAL=0]="PASTE_NORMAL",t[t.PASTE_NO_BORDERS=1]="PASTE_NO_BORDERS",t[t.PASTE_FORMAT=2]="PASTE_FORMAT",t[t.PASTE_FORMULA=3]="PASTE_FORMULA",t[t.PASTE_DATA_VALIDATION=4]="PASTE_DATA_VALIDATION",t[t.PASTE_VALUES=5]="PASTE_VALUES",t[t.PASTE_CONDITIONAL_FORMATTING=6]="PASTE_CONDITIONAL_FORMATTING",t[t.PASTE_COLUMN_WIDTHS=7]="PASTE_COLUMN_WIDTHS",t))(ny||{}),ry=(t=>(t[t.LEFT=0]="LEFT",t[t.RIGHT=1]="RIGHT",t))(ry||{}),sy=(t=>(t[t.DOCUMENT=0]="DOCUMENT",t[t.PROJECT=1]="PROJECT",t))(sy||{}),oy=(t=>(t[t.COLUMNS=0]="COLUMNS",t[t.ROWS=1]="ROWS",t))(oy||{}),iy=(t=>(t[t.UP=0]="UP",t[t.RIGHT=1]="RIGHT",t[t.DOWN=2]="DOWN",t[t.LEFT=3]="LEFT",t))(iy||{});function BT(t){switch(t){case 3:return 1;case 1:return 3;case 0:return 2;case 2:return 0}}var ay=(t=>(t[t.INTERPOLATION_POINT_TYPE_UNSPECIFIED=0]="INTERPOLATION_POINT_TYPE_UNSPECIFIED",t[t.MIN=1]="MIN",t[t.MAX=2]="MAX",t[t.NUMBER=3]="NUMBER",t[t.PERCENT=4]="PERCENT",t[t.PERCENTILE=5]="PERCENTILE",t))(ay||{}),Eo=(t=>(t.EN_US="enUS",t.FR_FR="frFR",t.ZH_CN="zhCN",t.RU_RU="ruRU",t.ZH_TW="zhTW",t.VI_VN="viVN",t.FA_IR="faIR",t.KO_KR="koKR",t.ES_ES="esES",t.CA_ES="caES",t))(Eo||{}),Ci=(t=>(t[t.PERSON=0]="PERSON",t[t.FILE=1]="FILE",t[t.DATE=2]="DATE",t[t.LOCATION=3]="LOCATION",t[t.EVENT=4]="EVENT",t))(Ci||{}),ly=(t=>(t[t.RANGE=0]="RANGE",t[t.SHEET=1]="SHEET",t))(ly||{}),uy=(t=>(t.Line="line",t.LineInv="lineInv",t.Triangle="triangle",t.RtTriangle="rtTriangle",t.Rect="rect",t.Diamond="diamond",t.Parallelogram="parallelogram",t.Trapezoid="trapezoid",t.NonIsocelesTrapezoid="nonIsocelesTrapezoid",t.Pentagon="pentagon",t.Hexagon="hexagon",t.Heptagon="heptagon",t.Octagon="octagon",t.Decagon="decagon",t.Dodecagon="dodecagon",t.Star4="star4",t.Star5="star5",t.Star6="star6",t.Star7="star7",t.Star8="star8",t.Star10="star10",t.Star12="star12",t.Star16="star16",t.Star24="star24",t.Star32="star32",t.RoundRect="roundRect",t.Round1Rect="round1Rect",t.Round2SameRect="round2SameRect",t.Round2DiagRect="round2DiagRect",t.Ellipse="ellipse",t))(uy||{}),cy=(t=>(t.RightArrow="rightArrow",t.LeftArrow="leftArrow",t.UpArrow="upArrow",t.DownArrow="downArrow",t.LeftRightArrow="leftRightArrow",t.UpDownArrow="upDownArrow",t.QuadArrow="quadArrow",t.LeftRightUpArrow="leftRightUpArrow",t.BentArrow="bentArrow",t.UturnArrow="uturnArrow",t.CircularArrow="circularArrow",t.NotchedRightArrow="notchedRightArrow",t.HomePlate="homePlate",t.Chevron="chevron",t.LeftCircularArrow="leftCircularArrow",t.LeftRightCircularArrow="leftRightCircularArrow",t))(cy||{}),dy=(t=>(t.Plaque="plaque",t.Can="can",t.Cube="cube",t.Bevel="bevel",t.Donut="donut",t.NoSmoking="noSmoking",t.BlockArc="blockArc",t.FoldedCorner="foldedCorner",t))(dy||{}),hy=(t=>(t.SmileyFace="smileyFace",t.Heart="heart",t.LightningBolt="lightningBolt",t.Sun="sun",t.Moon="moon",t.Cloud="cloud",t.Arc="arc",t.Backpack="backpack",t.Frame="frame",t.HalfFrame="halfFrame",t.Corner="corner",t.Chord="chord",t.Pie="pie",t.Teardrop="teardrop",t.WedgeRectCallout="wedgeRectCallout",t.WedgeRRectCallout="wedgeRRectCallout",t.WedgeEllipseCallout="wedgeEllipseCallout",t.CloudCallout="cloudCallout",t.BorderCallout1="borderCallout1",t.BorderCallout2="borderCallout2",t.BorderCallout3="borderCallout3",t.AccentCallout1="accentCallout1",t.AccentCallout2="accentCallout2",t.AccentCallout3="accentCallout3",t.Callout1="callout1",t.Callout2="callout2",t.Callout3="callout3",t.ActionButtonBackPrevious="actionButtonBackPrevious",t.ActionButtonEnd="actionButtonEnd",t.ActionButtonForwardNext="actionButtonForwardNext",t.ActionButtonHelp="actionButtonHelp",t.ActionButtonHome="actionButtonHome",t.ActionButtonInformation="actionButtonInformation",t.ActionButtonMovie="actionButtonMovie",t.ActionButtonReturn="actionButtonReturn",t.ActionButtonSound="actionButtonSound",t))(hy||{}),fy=(t=>(t[t.RELATIVE_DATE_UNSPECIFIED=0]="RELATIVE_DATE_UNSPECIFIED",t[t.PAST_YEAR=1]="PAST_YEAR",t[t.PAST_MONTH=2]="PAST_MONTH",t[t.PAST_WEEK=3]="PAST_WEEK",t[t.YESTERDAY=4]="YESTERDAY",t[t.TODAY=5]="TODAY",t[t.TOMORROW=6]="TOMORROW",t))(fy||{}),py=(t=>(t[t.GRID=0]="GRID",t[t.KANBAN=1]="KANBAN",t[t.GANTT=2]="GANTT",t))(py||{}),to=(t=>(t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.LEFT_TO_RIGHT=1]="LEFT_TO_RIGHT",t[t.RIGHT_TO_LEFT=2]="RIGHT_TO_LEFT",t))(to||{}),gy=(t=>(t[t.DASH=0]="DASH",t[t.DASH_DOT_DOT_HEAVY=1]="DASH_DOT_DOT_HEAVY",t[t.DASH_DOT_HEAVY=2]="DASH_DOT_HEAVY",t[t.DASHED_HEAVY=3]="DASHED_HEAVY",t[t.DASH_LONG=4]="DASH_LONG",t[t.DASH_LONG_HEAVY=5]="DASH_LONG_HEAVY",t[t.DOT_DASH=6]="DOT_DASH",t[t.DOT_DOT_DASH=7]="DOT_DOT_DASH",t[t.DOTTED=8]="DOTTED",t[t.DOTTED_HEAVY=9]="DOTTED_HEAVY",t[t.DOUBLE=10]="DOUBLE",t[t.NONE=11]="NONE",t[t.SINGLE=12]="SINGLE",t[t.THICK=13]="THICK",t[t.WAVE=14]="WAVE",t[t.WAVY_DOUBLE=15]="WAVY_DOUBLE",t[t.WAVY_HEAVY=16]="WAVY_HEAVY",t[t.WORDS=17]="WORDS",t))(gy||{}),qe=(t=>(t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.LEFT=1]="LEFT",t[t.CENTER=2]="CENTER",t[t.RIGHT=3]="RIGHT",t[t.JUSTIFIED=4]="JUSTIFIED",t[t.BOTH=5]="BOTH",t[t.DISTRIBUTED=6]="DISTRIBUTED",t))(qe||{}),lr=(t=>(t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.TOP=1]="TOP",t[t.MIDDLE=2]="MIDDLE",t[t.BOTTOM=3]="BOTTOM",t))(lr||{}),_r=(t=>(t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.OVERFLOW=1]="OVERFLOW",t[t.CLIP=2]="CLIP",t[t.WRAP=3]="WRAP",t))(_r||{}),Ri=(t=>(t[t.NORMAL=0]="NORMAL",t[t.ITALIC=1]="ITALIC",t))(Ri||{}),Ti=(t=>(t[t.NORMAL=0]="NORMAL",t[t.BOLD=1]="BOLD",t))(Ti||{}),vn=(t=>(t[t.NORMAL=1]="NORMAL",t[t.SUBSCRIPT=2]="SUBSCRIPT",t[t.SUPERSCRIPT=3]="SUPERSCRIPT",t))(vn||{}),ut=(t=>(t[t.FALSE=0]="FALSE",t[t.TRUE=1]="TRUE",t))(ut||{}),Mn=(t=>(t[t.STRING=1]="STRING",t[t.NUMBER=2]="NUMBER",t[t.BOOLEAN=3]="BOOLEAN",t[t.FORCE_STRING=4]="FORCE_STRING",t))(Mn||{}),me=(t=>(t[t.DARK1=0]="DARK1",t[t.LIGHT1=1]="LIGHT1",t[t.DARK2=2]="DARK2",t[t.LIGHT2=3]="LIGHT2",t[t.ACCENT1=4]="ACCENT1",t[t.ACCENT2=5]="ACCENT2",t[t.ACCENT3=6]="ACCENT3",t[t.ACCENT4=7]="ACCENT4",t[t.ACCENT5=8]="ACCENT5",t[t.ACCENT6=9]="ACCENT6",t[t.HYPERLINK=10]="HYPERLINK",t[t.FOLLOWED_HYPERLINK=11]="FOLLOWED_HYPERLINK",t))(me||{}),La=(t=>(t.OFFICE="Office",t.OFFICE_2007_2010="Office 2007-2010",t.GRAYSCALE="Grayscale",t.BLUE_WARM="Blue Warm",t.BLUE="Blue",t.BLUE_II="Blue II",t.BLUE_GREEN="Blue Green",t.GREEN="Green",t.GREEN_YELLOW="Green Yellow",t.YELLOW="Yellow",t.YELLOW_ORANGE="Yellow Orange",t.ORANGE="Orange",t.ORANGE_RED="Orange Red",t.RED_ORANGE="Red Orange",t.RED="Red",t.RED_VIOLET="Red Violet",t.VIOLET="Violet",t.VIOLET_II="Violet II",t.MEDIAN="Median",t.PAPER="Paper",t.MARQUEE="Marquee",t.SLIPSTREAM="Slipstream",t.Aspect="Aspect",t))(La||{}),my=(t=>(t[t.character=0]="character",t[t.paragraph=1]="paragraph",t[t.table=2]="table",t[t.numbering=3]="numbering",t))(my||{}),_y=(t=>(t[t.TAB=0]="TAB",t[t.SPACE=1]="SPACE",t[t.NOTHING=2]="NOTHING",t))(_y||{}),_t=(t=>(t[t.BULLET=0]="BULLET",t[t.NONE=1]="NONE",t[t.DECIMAL=2]="DECIMAL",t[t.DECIMAL_ZERO=3]="DECIMAL_ZERO",t[t.UPPER_LETTER=4]="UPPER_LETTER",t[t.LOWER_LETTER=5]="LOWER_LETTER",t[t.UPPER_ROMAN=6]="UPPER_ROMAN",t[t.LOWER_ROMAN=7]="LOWER_ROMAN",t[t.ORDINAL=8]="ORDINAL",t[t.CARDINAL_TEXT=9]="CARDINAL_TEXT",t[t.ORDINAL_TEXT=10]="ORDINAL_TEXT",t[t.HEX=11]="HEX",t[t.CHICAGO=12]="CHICAGO",t[t.IDEOGRAPH_DIGITAL=13]="IDEOGRAPH_DIGITAL",t[t.JAPANESE_COUNTING=14]="JAPANESE_COUNTING",t[t.AIUEO=15]="AIUEO",t[t.IROHA=16]="IROHA",t[t.DECIMAL_FULL_WIDTH=17]="DECIMAL_FULL_WIDTH",t[t.DECIMAL_HALF_WIDTH=18]="DECIMAL_HALF_WIDTH",t[t.JAPANESE_LEGAL=19]="JAPANESE_LEGAL",t[t.JAPANESE_DIGITAL_TEN_THOUSAND=20]="JAPANESE_DIGITAL_TEN_THOUSAND",t[t.DECIMAL_ENCLOSED_CIRCLE=21]="DECIMAL_ENCLOSED_CIRCLE",t[t.DECIMAL_FULL_WIDTH2=22]="DECIMAL_FULL_WIDTH2",t[t.AIUEO_FULL_WIDTH=23]="AIUEO_FULL_WIDTH",t[t.IROHA_FULL_WIDTH=24]="IROHA_FULL_WIDTH",t[t.GANADA=25]="GANADA",t[t.CHOSUNG=26]="CHOSUNG",t[t.DECIMAL_ENCLOSED_FULLSTOP=27]="DECIMAL_ENCLOSED_FULLSTOP",t[t.DECIMAL_ENCLOSED_PAREN=28]="DECIMAL_ENCLOSED_PAREN",t[t.DECIMAL_ENCLOSED_CIRCLE_CHINESE=29]="DECIMAL_ENCLOSED_CIRCLE_CHINESE",t[t.IDEOGRAPH_ENCLOSED_CIRCLE=30]="IDEOGRAPH_ENCLOSED_CIRCLE",t[t.IDEOGRAPH_TRADITIONAL=31]="IDEOGRAPH_TRADITIONAL",t[t.IDEOGRAPH_ZODIAC=32]="IDEOGRAPH_ZODIAC",t[t.IDEOGRAPH_ZODIAC_TRADITIONAL=33]="IDEOGRAPH_ZODIAC_TRADITIONAL",t[t.TAIWANESE_COUNTING=34]="TAIWANESE_COUNTING",t[t.IDEOGRAPH_LEGAL_TRADITIONAL=35]="IDEOGRAPH_LEGAL_TRADITIONAL",t[t.TAIWANESE_COUNTING_THOUSAND=36]="TAIWANESE_COUNTING_THOUSAND",t[t.TAIWANESE_DIGITAL=37]="TAIWANESE_DIGITAL",t[t.CHINESE_COUNTING=38]="CHINESE_COUNTING",t[t.CHINESE_LEGAL_SIMPLIFIED=39]="CHINESE_LEGAL_SIMPLIFIED",t[t.CHINESE_COUNTING_THOUSAND=40]="CHINESE_COUNTING_THOUSAND",t[t.KOREAN_DIGITAL=41]="KOREAN_DIGITAL",t[t.KOREAN_COUNTING=42]="KOREAN_COUNTING",t[t.KOREAN_LEGAL=43]="KOREAN_LEGAL",t[t.KOREAN_DIGITAL2=44]="KOREAN_DIGITAL2",t[t.VIETNAMESE_COUNTING=45]="VIETNAMESE_COUNTING",t[t.RUSSIAN_LOWER=46]="RUSSIAN_LOWER",t[t.RUSSIAN_UPPER=47]="RUSSIAN_UPPER",t[t.NUMBER_IN_DASH=48]="NUMBER_IN_DASH",t[t.HEBREW1=49]="HEBREW1",t[t.HEBREW2=50]="HEBREW2",t[t.ARABIC_ALPHA=51]="ARABIC_ALPHA",t[t.ARABIC_ABJAD=52]="ARABIC_ABJAD",t[t.HINDI_VOWELS=53]="HINDI_VOWELS",t[t.HINDI_CONSONANTS=54]="HINDI_CONSONANTS",t[t.HINDI_NUMBERS=55]="HINDI_NUMBERS",t[t.HINDI_COUNTING=56]="HINDI_COUNTING",t[t.THAI_LETTERS=57]="THAI_LETTERS",t[t.THAI_NUMBERS=58]="THAI_NUMBERS",t[t.THAI_COUNTING=59]="THAI_COUNTING",t[t.CUSTOM=60]="CUSTOM",t))(_t||{}),bo=(t=>(t[t.BULLET_ALIGNMENT_UNSPECIFIED=0]="BULLET_ALIGNMENT_UNSPECIFIED",t[t.START=1]="START",t[t.CENTER=2]="CENTER",t[t.END=3]="END",t[t.BOTH=4]="BOTH",t))(bo||{}),Pn=(t=>(t[t.HYPERLINK=0]="HYPERLINK",t[t.FIELD=1]="FIELD",t[t.SDT=2]="SDT",t[t.BOOKMARK=3]="BOOKMARK",t[t.COMMENT=4]="COMMENT",t[t.CUSTOM=5]="CUSTOM",t[t.MENTION=6]="MENTION",t[t.UNI_FORMULA=7]="UNI_FORMULA",t[t.DELTED=9999]="DELTED",t))(Pn||{}),ur=(t=>(t[t.COMMENT=0]="COMMENT",t[t.DELETED=9999]="DELETED",t))(ur||{}),yy=(t=>(t[t.DRAWING=0]="DRAWING",t[t.CUSTOM=1]="CUSTOM",t))(yy||{}),Jd=(t=>(t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.TRADITIONAL=1]="TRADITIONAL",t[t.MODERN=2]="MODERN",t))(Jd||{}),vy=(t=>(t[t.DEFAULT=0]="DEFAULT",t[t.LINES=1]="LINES",t[t.LINES_AND_CHARS=2]="LINES_AND_CHARS",t[t.SNAP_TO_CHARS=3]="SNAP_TO_CHARS",t))(vy||{}),Ey=(t=>(t[t.SECTION_TYPE_UNSPECIFIED=0]="SECTION_TYPE_UNSPECIFIED",t[t.CONTINUOUS=1]="CONTINUOUS",t[t.NEXT_PAGE=2]="NEXT_PAGE",t[t.EVEN_PAGE=3]="EVEN_PAGE",t[t.ODD_PAGE=4]="ODD_PAGE",t))(Ey||{}),by=(t=>(t[t.COLUMN_SEPARATOR_STYLE_UNSPECIFIED=0]="COLUMN_SEPARATOR_STYLE_UNSPECIFIED",t[t.NONE=1]="NONE",t[t.BETWEEN_EACH_COLUMN=2]="BETWEEN_EACH_COLUMN",t))(by||{}),Cy=(t=>(t[t.NORMAL=0]="NORMAL",t[t.TBRL=1]="TBRL",t[t.LRTBV=2]="LRTBV",t))(Cy||{}),Ry=(t=>(t[t.TEXT_RUN=0]="TEXT_RUN",t[t.AUTO_TEXT=1]="AUTO_TEXT",t[t.PAGE_BREAK=2]="PAGE_BREAK",t[t.COLUMN_BREAK=3]="COLUMN_BREAK",t[t.FOOT_NOTE_REFERENCE=4]="FOOT_NOTE_REFERENCE",t[t.HORIZONTAL_RULE=5]="HORIZONTAL_RULE",t[t.EQUATION=6]="EQUATION",t[t.DRAWING=7]="DRAWING",t[t.PERSON=8]="PERSON",t[t.RICH_LINK=9]="RICH_LINK",t))(Ry||{}),Ty=(t=>(t[t.BOTH_SIDES=0]="BOTH_SIDES",t[t.LEFT=1]="LEFT",t[t.RIGHT=2]="RIGHT",t[t.LARGEST=3]="LARGEST",t))(Ty||{}),wy=(t=>(t[t.INLINE=0]="INLINE",t[t.WRAP_NONE=1]="WRAP_NONE",t[t.WRAP_POLYGON=2]="WRAP_POLYGON",t[t.WRAP_SQUARE=3]="WRAP_SQUARE",t[t.WRAP_THROUGH=4]="WRAP_THROUGH",t[t.WRAP_TIGHT=5]="WRAP_TIGHT",t[t.WRAP_TOP_AND_BOTTOM=6]="WRAP_TOP_AND_BOTTOM",t))(wy||{}),oe=(t=>(t[t.NAMED_STYLE_TYPE_UNSPECIFIED=0]="NAMED_STYLE_TYPE_UNSPECIFIED",t[t.NORMAL_TEXT=1]="NORMAL_TEXT",t[t.TITLE=2]="TITLE",t[t.SUBTITLE=3]="SUBTITLE",t[t.HEADING_1=4]="HEADING_1",t[t.HEADING_2=5]="HEADING_2",t[t.HEADING_3=6]="HEADING_3",t[t.HEADING_4=7]="HEADING_4",t[t.HEADING_5=8]="HEADING_5",t))(oe||{}),Iy=(t=>(t[t.AUTO=0]="AUTO",t[t.AT_LEAST=1]="AT_LEAST",t[t.EXACT=2]="EXACT",t))(Iy||{}),Sy=(t=>(t[t.DASH_STYLE_UNSPECIFIED=0]="DASH_STYLE_UNSPECIFIED",t[t.SOLID=1]="SOLID",t[t.DOT=2]="DOT",t[t.DASH=3]="DASH",t))(Sy||{}),Ay=(t=>(t[t.TAB_STOP_ALIGNMENT_UNSPECIFIED=0]="TAB_STOP_ALIGNMENT_UNSPECIFIED",t[t.START=1]="START",t[t.CENTER=2]="CENTER",t[t.END=3]="END",t))(Ay||{}),Oy=(t=>(t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.SPECIFIED=1]="SPECIFIED",t))(Oy||{}),Dy=(t=>(t[t.START=0]="START",t[t.CENTER=1]="CENTER",t[t.END=2]="END",t))(Dy||{}),xy=(t=>(t[t.AUTO_FIT=0]="AUTO_FIT",t[t.FIXED=1]="FIXED",t))(xy||{}),Ny=(t=>(t[t.NONE=0]="NONE",t[t.WRAP=1]="WRAP",t))(Ny||{}),My=(t=>(t[t.AUTO=0]="AUTO",t[t.AT_LEAST=1]="AT_LEAST",t[t.EXACT=2]="EXACT",t))(My||{}),Ly=(t=>(t[t.CONTENT_ALIGNMENT_UNSPECIFIED=0]="CONTENT_ALIGNMENT_UNSPECIFIED",t[t.BOTH=1]="BOTH",t[t.TOP=2]="TOP",t[t.CENTER=3]="CENTER",t[t.BOTTOM=4]="BOTTOM",t))(Ly||{}),jr=(t=>(t.NORMAL="normal",t.BOLD="bold",t.ITALIC="italic",t))(jr||{}),Fy=(t=>(t[t.PAGE=0]="PAGE",t[t.COLUMN=1]="COLUMN",t[t.CHARACTER=2]="CHARACTER",t[t.MARGIN=3]="MARGIN",t[t.INSIDE_MARGIN=4]="INSIDE_MARGIN",t[t.OUTSIDE_MARGIN=5]="OUTSIDE_MARGIN",t[t.LEFT_MARGIN=6]="LEFT_MARGIN",t[t.RIGHT_MARGIN=7]="RIGHT_MARGIN",t))(Fy||{}),ky=(t=>(t[t.PAGE=0]="PAGE",t[t.PARAGRAPH=1]="PARAGRAPH",t[t.LINE=2]="LINE",t[t.MARGIN=3]="MARGIN",t[t.TOP_MARGIN=4]="TOP_MARGIN",t[t.BOTTOM_MARGIN=5]="BOTTOM_MARGIN",t[t.INSIDE_MARGIN=6]="INSIDE_MARGIN",t[t.OUTSIDE_MARGIN=7]="OUTSIDE_MARGIN",t))(ky||{}),Py=(t=>(t[t.POINT=0]="POINT",t[t.LINE=1]="LINE",t[t.CHARACTER=2]="CHARACTER",t[t.PIXEL=3]="PIXEL",t[t.PERCENT=4]="PERCENT",t))(Py||{}),Uy=(t=>(t[t.CENTER=0]="CENTER",t[t.INSIDE=1]="INSIDE",t[t.LEFT=2]="LEFT",t[t.OUTSIDE=3]="OUTSIDE",t[t.RIGHT=4]="RIGHT",t[t.BOTH=5]="BOTH",t[t.DISTRIBUTE=6]="DISTRIBUTE",t))(Uy||{}),By=(t=>(t[t.BOTTOM=0]="BOTTOM",t[t.CENTER=1]="CENTER",t[t.INSIDE=2]="INSIDE",t[t.OUTSIDE=3]="OUTSIDE",t[t.TOP=4]="TOP",t))(By||{}),$y=(t=>(t[t.compressPunctuation=0]="compressPunctuation",t[t.compressPunctuationAndJapaneseKana=1]="compressPunctuationAndJapaneseKana",t[t.doNotCompress=2]="doNotCompress",t))($y||{}),Hy=(t=>(t[t.PORTRAIT=0]="PORTRAIT",t[t.LANDSCAPE=1]="LANDSCAPE",t))(Hy||{}),Oe=(t=>(t.Letter="Letter",t.Tabloid="Tabloid",t.Legal="Legal",t.Statement="Statement",t.Executive="Executive",t.Folio="Folio",t.A3="A3",t.A4="A4",t.A5="A5",t.B4="B4",t.B5="B5",t))(Oe||{});const $T=["A3","A4","A5","B4","B5","Letter","Tabloid","Legal","Statement","Executive","Folio"];var jy=(t=>(t[t.forward=0]="forward",t[t.backward=1]="backward",t[t.front=2]="front",t[t.back=3]="back",t))(jy||{}),Vy=(t=>(t[t.UNRECOGNIZED=-1]="UNRECOGNIZED",t[t.DRAWING_IMAGE=0]="DRAWING_IMAGE",t[t.DRAWING_SHAPE=1]="DRAWING_SHAPE",t[t.DRAWING_CHART=2]="DRAWING_CHART",t[t.DRAWING_TABLE=3]="DRAWING_TABLE",t[t.DRAWING_SMART_ART=4]="DRAWING_SMART_ART",t[t.DRAWING_VIDEO=5]="DRAWING_VIDEO",t[t.DRAWING_GROUP=6]="DRAWING_GROUP",t[t.DRAWING_UNIT=7]="DRAWING_UNIT",t[t.DRAWING_DOM=8]="DRAWING_DOM",t))(Vy||{}),Zd=(t=>(t[t.SLIDE=0]="SLIDE",t[t.MASTER=1]="MASTER",t[t.LAYOUT=2]="LAYOUT",t[t.HANDOUT_MASTER=3]="HANDOUT_MASTER",t[t.NOTES_MASTER=4]="NOTES_MASTER",t))(Zd||{}),Wy=(t=>(t[t.SHAPE=0]="SHAPE",t[t.IMAGE=1]="IMAGE",t[t.TEXT=2]="TEXT",t[t.SPREADSHEET=3]="SPREADSHEET",t[t.DOCUMENT=4]="DOCUMENT",t[t.SLIDE=5]="SLIDE",t))(Wy||{}),Gy=(t=>(t[t.RELATIVE_SLIDE_LINK_UNSPECIFIED=0]="RELATIVE_SLIDE_LINK_UNSPECIFIED",t[t.NEXT_SLIDE=1]="NEXT_SLIDE",t[t.PREVIOUS_SLIDE=2]="PREVIOUS_SLIDE",t[t.FIRST_SLIDE=3]="FIRST_SLIDE",t[t.LAST_SLIDE=4]="LAST_SLIDE",t))(Gy||{});function Yy(t=ue(6),e=Eo.EN_US,n=""){return{id:t,locale:e,title:n,tableSource:{},drawings:{},drawingsOrder:[],headers:{},footers:{},body:{dataStream:`\r
`,textRuns:[],customBlocks:[],tables:[],paragraphs:[{startIndex:0,paragraphStyle:{spaceAbove:{v:5},lineSpacing:1,spaceBelow:{v:0}}}],sectionBreaks:[{startIndex:1}]},documentStyle:{pageSize:{width:793.3333333333334,height:1122.6666666666667},documentFlavor:Jd.TRADITIONAL,marginTop:50,marginBottom:50,marginRight:50,marginLeft:50,renderConfig:{zeroWidthParagraphBreak:ut.FALSE,vertexAngle:0,centerAngle:0,background:{rgb:"#ccc"}},autoHyphenation:ut.TRUE,doNotHyphenateCaps:ut.FALSE,consecutiveHyphenLimit:2,defaultHeaderId:"",defaultFooterId:"",evenPageHeaderId:"",evenPageFooterId:"",firstPageHeaderId:"",firstPageFooterId:"",evenAndOddHeaders:ut.FALSE,useFirstPageHeaderFooter:ut.FALSE,marginHeader:30,marginFooter:30},settings:{}}}var Gn={},vs={},Es={},Tu;function zy(){if(Tu)return Es;Tu=1,Object.defineProperty(Es,"__esModule",{value:!0});function t(r,s){if(Array.isArray(s))return!1;for(let o in r)if(!n(r[o],s[o]))return!1;for(let o in s)if(r[o]===void 0)return!1;return!0}function e(r,s){if(!Array.isArray(s)||r.length!==s.length)return!1;for(let o=0;o<r.length;o++)if(!n(r[o],s[o]))return!1;return!0}function n(r,s){return r===s?!0:r===null||s===null||typeof r!="object"||typeof s!="object"?!1:Array.isArray(r)?e(r,s):t(r,s)}return Es.default=n,Es}var bs={},wu;function Ky(){if(wu)return bs;wu=1,Object.defineProperty(bs,"__esModule",{value:!0});function t(e){if(e===null)return null;if(Array.isArray(e))return e.map(t);if(typeof e=="object"){const n={};for(let r in e)n[r]=t(e[r]);return n}else return e}return bs.default=t,bs}var Iu={},Su;function Qd(){return Su||(Su=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.eachChildOf=t.advancer=t.readCursor=t.writeCursor=t.WriteCursor=t.ReadCursor=t.isValidPathItem=void 0;function e(c,d){if(!c)throw new Error(d)}const n=c=>c!=null&&typeof c=="object"&&!Array.isArray(c),r=(c,d)=>typeof c==typeof d?c>d:typeof c=="string"&&typeof d=="number";function s(c,d){for(let h in c){const f=h;d.write(f,c[f])}}t.isValidPathItem=c=>typeof c=="number"||typeof c=="string"&&c!=="__proto__";class o{constructor(d=null){this.parents=[],this.indexes=[],this.lcIdx=-1,this.idx=-1,this.container=d}ascend(){e(this.parents.length===this.indexes.length/2),this.idx===0?this.parents.length?(this.lcIdx=this.indexes.pop(),this.container=this.parents.pop(),this.idx=this.indexes.pop()):(this.lcIdx=0,this.idx=-1):(e(this.idx>0),this.idx--,n(this.container[this.idx])&&this.idx--)}getPath(){const d=[];let h=this.container,f=this.parents.length-1,p=this.idx;for(;p>=0;)d.unshift(h[p]),p===0?(p=this.indexes[f*2],h=this.parents[f--]):p-=n(h[p-1])?2:1;return d}}class i extends o{get(){return this.container?this.container.slice(this.idx+1):null}getKey(){return e(this.container!=null,"Invalid call to getKey before cursor descended"),this.container[this.idx]}getComponent(){let d;return this.container&&this.container.length>this.idx+1&&n(d=this.container[this.idx+1])?d:null}descendFirst(){let d=this.idx+1;if(!this.container||d>=this.container.length||n(this.container[d])&&d+1>=this.container.length)return!1;n(this.container[d])&&d++;const h=this.container[d];return Array.isArray(h)?(this.indexes.push(this.idx),this.parents.push(this.container),this.indexes.push(d),this.idx=0,this.container=h):this.idx=d,!0}nextSibling(){if(e(this.parents.length===this.indexes.length/2),this.idx>0||this.parents.length===0)return!1;const d=this.indexes[this.indexes.length-1]+1,h=this.parents[this.parents.length-1];return d>=h.length?!1:(e(!isNaN(d)),this.indexes[this.indexes.length-1]=d,this.container=h[d],!0)}_init(d,h,f,p){this.container=d,this.idx=h,this.parents=f.slice(),this.indexes=p.slice()}clone(){const d=new i;return d._init(this.container,this.idx,this.parents,this.indexes),d}*[Symbol.iterator](){if(this.descendFirst()){do yield this.getKey();while(this.nextSibling());this.ascend()}}traverse(d,h){const f=this.getComponent();f&&h(f,d);for(const p of this)d&&d.descend(p),this.traverse(d,h),d&&d.ascend()}eachPick(d,h){this.traverse(d,(f,p)=>{f.p!=null&&h(f.p,p)})}eachDrop(d,h){this.traverse(d,(f,p)=>{f.d!=null&&h(f.d,p)})}}t.ReadCursor=i;class a extends o{constructor(d=null){super(d),this.pendingDescent=[],this._op=d}flushDescent(){e(this.parents.length===this.indexes.length/2),this.container===null&&(this._op=this.container=[]);for(let d=0;d<this.pendingDescent.length;d++){const h=this.pendingDescent[d];let f=this.idx+1;if(f<this.container.length&&n(this.container[f])&&f++,e(f===this.container.length||!n(this.container[f])),f===this.container.length)this.container.push(h),this.idx=f;else if(this.container[f]===h)this.idx=f;else{if(!Array.isArray(this.container[f])){const p=this.container.splice(f,this.container.length-f);this.container.push(p),this.lcIdx>-1&&(this.lcIdx=f)}for(this.indexes.push(this.idx),this.parents.push(this.container),this.lcIdx!==-1&&(e(r(h,this.container[this.lcIdx][0])),f=this.lcIdx+1,this.lcIdx=-1);f<this.container.length&&r(h,this.container[f][0]);)f++;if(this.indexes.push(f),this.idx=0,f<this.container.length&&this.container[f][0]===h)this.container=this.container[f];else{const p=[h];this.container.splice(f,0,p),this.container=p}}}this.pendingDescent.length=0}reset(){this.lcIdx=-1}getComponent(){this.flushDescent();const d=this.idx+1;if(d<this.container.length&&n(this.container[d]))return this.container[d];{const h={};return this.container.splice(d,0,h),h}}write(d,h){const f=this.getComponent();e(f[d]==null||f[d]===h,"Internal consistency error: Overwritten component. File a bug"),f[d]=h}get(){return this._op}descend(d){if(!t.isValidPathItem(d))throw Error("Invalid JSON key");this.pendingDescent.push(d)}descendPath(d){return this.pendingDescent.push(...d),this}ascend(){this.pendingDescent.length?this.pendingDescent.pop():super.ascend()}mergeTree(d,h=s){if(d===null)return;if(e(Array.isArray(d)),d===this._op)throw Error("Cannot merge into my own tree");const f=this.lcIdx,p=this.parents.length;let g=0;for(let _=0;_<d.length;_++){const I=d[_];typeof I=="string"||typeof I=="number"?(g++,this.descend(I)):Array.isArray(I)?this.mergeTree(I,h):typeof I=="object"&&h(I,this)}for(;g--;)this.ascend();this.lcIdx=this.parents.length===p?f:-1}at(d,h){this.descendPath(d),h(this);for(let f=0;f<d.length;f++)this.ascend();return this}writeAtPath(d,h,f){return this.at(d,()=>this.write(h,f)),this.reset(),this}writeMove(d,h,f=0){return this.writeAtPath(d,"p",f).writeAtPath(h,"d",f)}getPath(){const d=super.getPath();return d.push(...this.pendingDescent),d}}t.WriteCursor=a,t.writeCursor=()=>new a,t.readCursor=c=>new i(c);function l(c,d,h){let f,p;p=f=c?c.descendFirst():!1;function g(_){let I;for(;p;){const U=I=c.getKey();if(_!=null){let L=!1;if(d&&typeof U=="number"&&(I=d(U,c.getComponent()),I<0&&(I=~I,L=!0)),r(I,_))return null;if(I===_&&!L)return c}h&&typeof I=="number"&&h(I,c.getComponent()),p=c.nextSibling()}return null}return g.end=()=>{f&&c.ascend()},g}t.advancer=l;function u(c,d,h){let f,p,g,_;for(f=p=c&&c.descendFirst(),g=_=d&&d.descendFirst();f||g;){let I=f?c.getKey():null,U=g?d.getKey():null;I!==null&&U!==null&&(r(U,I)?U=null:I!==U&&(I=null)),h(I??U,I!=null?c:null,U!=null?d:null),I!=null&&f&&(f=c.nextSibling()),U!=null&&g&&(g=d.nextSibling())}p&&c.ascend(),_&&d.ascend()}t.eachChildOf=u}(Iu)),Iu}var Au={},Ou;function qd(){return Ou||(Ou=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ConflictType=void 0,function(e){e[e.RM_UNEXPECTED_CONTENT=1]="RM_UNEXPECTED_CONTENT",e[e.DROP_COLLISION=2]="DROP_COLLISION",e[e.BLACKHOLE=3]="BLACKHOLE"}(t.ConflictType||(t.ConflictType={}))}(Au)),Au}var Ke={},Yn={},Du;function Fa(){return Du||(Du=1,Object.defineProperty(Yn,"__esModule",{value:!0}),Yn.uniToStrPos=Yn.strPosToUni=void 0,Yn.strPosToUni=(t,e=t.length)=>{let n=0,r=0;for(;r<e;r++){const s=t.charCodeAt(r);s>=55296&&s<=57343&&(n++,r++)}if(r!==e)throw Error("Invalid offset - splits unicode bytes");return r-n},Yn.uniToStrPos=(t,e)=>{let n=0;for(;e>0;e--){const r=t.charCodeAt(n);n+=r>=55296&&r<=57343?2:1}return n}),Yn}var xu={},Nu;function wi(){return Nu||(Nu=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.uniSlice=t.dlen=t.eachOp=void 0;const e=Fa(),n=C=>{if(!Array.isArray(C))throw Error("Op must be an array of components");let R=null;for(let y=0;y<C.length;y++){const N=C[y];switch(typeof N){case"object":if(typeof N.d!="number"&&typeof N.d!="string")throw Error("Delete must be number or string");if(t.dlen(N.d)<=0)throw Error("Deletes must not be empty");break;case"string":if(!(N.length>0))throw Error("Inserts cannot be empty");break;case"number":if(!(N>0))throw Error("Skip components must be >0");if(typeof R=="number")throw Error("Adjacent skip components should be combined");break}R=N}if(typeof R=="number")throw Error("Op has a trailing skip")};function r(C,R){let y=0,N=0;for(let G=0;G<C.length;G++){const z=C[G];switch(R(z,y,N),typeof z){case"object":y+=t.dlen(z.d);break;case"string":N+=e.strPosToUni(z);break;case"number":y+=z,N+=z;break}}}t.eachOp=r;function s(C,R){const y=[],N=a(y);return r(C,(G,z,m)=>{N(R(G,z,m))}),d(y)}const o=C=>C,i=C=>s(C,o);t.dlen=C=>typeof C=="number"?C:e.strPosToUni(C);const a=C=>R=>{if(!(!R||R.d===0||R.d===""))if(C.length===0)C.push(R);else if(typeof R==typeof C[C.length-1])if(typeof R=="object"){const y=C[C.length-1];y.d=typeof y.d=="string"&&typeof R.d=="string"?y.d+R.d:t.dlen(y.d)+t.dlen(R.d)}else C[C.length-1]+=R;else C.push(R)},l=C=>typeof C=="number"?C:typeof C=="string"?e.strPosToUni(C):typeof C.d=="number"?C.d:e.strPosToUni(C.d);t.uniSlice=(C,R,y)=>{const N=e.uniToStrPos(C,R),G=y==null?1/0:e.uniToStrPos(C,y);return C.slice(N,G)};const u=(C,R,y)=>typeof C=="number"?y==null?C-R:Math.min(C,y)-R:t.uniSlice(C,R,y),c=C=>{let R=0,y=0;return{take:(N,G)=>{if(R===C.length)return N===-1?null:N;const z=C[R];let m;if(typeof z=="number")return N===-1||z-y<=N?(m=z-y,++R,y=0,m):(y+=N,N);if(typeof z=="string"){if(N===-1||G==="i"||e.strPosToUni(z.slice(y))<=N)return m=z.slice(y),++R,y=0,m;{const F=y+e.uniToStrPos(z.slice(y),N);return m=z.slice(y,F),y=F,m}}else{if(N===-1||G==="d"||t.dlen(z.d)-y<=N)return m={d:u(z.d,y)},++R,y=0,m;{let F=u(z.d,y,y+N);return y+=N,{d:F}}}},peek:()=>C[R]}},d=C=>(C.length>0&&typeof C[C.length-1]=="number"&&C.pop(),C);function h(C,R,y){if(y!=="left"&&y!=="right")throw Error("side ("+y+") must be 'left' or 'right'");n(C),n(R);const N=[],G=a(N),{take:z,peek:m}=c(C);for(let v=0;v<R.length;v++){const x=R[v];let S,w;switch(typeof x){case"number":for(S=x;S>0;)w=z(S,"i"),G(w),typeof w!="string"&&(S-=l(w));break;case"string":y==="left"&&typeof m()=="string"&&G(z(-1)),G(e.strPosToUni(x));break;case"object":for(S=t.dlen(x.d);S>0;)switch(w=z(S,"i"),typeof w){case"number":S-=w;break;case"string":G(w);break;case"object":S-=t.dlen(w.d)}break}}let F;for(;F=z(-1);)G(F);return d(N)}function f(C,R){n(C),n(R);const y=[],N=a(y),{take:G}=c(C);for(let m=0;m<R.length;m++){const F=R[m];let v,x;switch(typeof F){case"number":for(v=F;v>0;)x=G(v,"d"),N(x),typeof x!="object"&&(v-=l(x));break;case"string":N(F);break;case"object":v=t.dlen(F.d);let S=0;for(;S<v;)switch(x=G(v-S,"d"),typeof x){case"number":N({d:u(F.d,S,S+x)}),S+=x;break;case"string":S+=e.strPosToUni(x);break;case"object":N(x)}break}}let z;for(;z=G(-1);)N(z);return d(y)}const p=(C,R)=>{let y=0;for(let N=0;N<R.length&&C>y;N++){const G=R[N];switch(typeof G){case"number":{y+=G;break}case"string":const z=e.strPosToUni(G);y+=z,C+=z;break;case"object":C-=Math.min(t.dlen(G.d),C-y);break}}return C},g=(C,R)=>typeof C=="number"?p(C,R):C.map(y=>p(y,R));function _(C,R,y){return s(C,(N,G)=>typeof N=="object"&&typeof N.d=="number"?{d:y.slice(R,G,G+N.d)}:N)}function I(C){return s(C,R=>{switch(typeof R){case"object":if(typeof R.d=="number")throw Error("Cannot invert text op: Deleted characters missing from operation. makeInvertible must be called first.");return R.d;case"string":return{d:R};case"number":return R}})}function U(C){return s(C,R=>typeof R=="object"&&typeof R.d=="string"?{d:e.strPosToUni(R.d)}:R)}function L(C){let R=!0;return r(C,y=>{typeof y=="object"&&typeof y.d=="number"&&(R=!1)}),R}function B(C){return{name:"text-unicode",uri:"http://sharejs.org/types/text-unicode",trim:d,normalize:i,checkOp:n,create(R=""){if(typeof R!="string")throw Error("Initial data must be a string");return C.create(R)},apply(R,y){n(y);const N=C.builder(R);for(let G=0;G<y.length;G++){const z=y[G];switch(typeof z){case"number":N.skip(z);break;case"string":N.append(z);break;case"object":N.del(t.dlen(z.d));break}}return N.build()},transform:h,compose:f,transformPosition:p,transformSelection:g,isInvertible:L,makeInvertible(R,y){return _(R,y,C)},stripInvertible:U,invert:I,invertWithDoc(R,y){return I(_(R,y,C))},isNoop:R=>R.length===0}}t.default=B}(xu)),xu}var Cs={},Mu;function Xy(){if(Mu)return Cs;Mu=1,Object.defineProperty(Cs,"__esModule",{value:!0});const t=wi(),e=Fa();function n(r,s){return{get:r,getLength(){return r().length},insert(o,i,a){const l=e.strPosToUni(r(),o);return s([l,i],a)},remove(o,i,a){const l=e.strPosToUni(r(),o);return s([l,{d:i}],a)},_onOp(o){t.eachOp(o,(i,a,l)=>{switch(typeof i){case"string":this.onInsert&&this.onInsert(l,i);break;case"object":const u=t.dlen(i.d);this.onRemove&&this.onRemove(l,u)}})},onInsert:null,onRemove:null}}return Cs.default=n,n.provides={text:!0},Cs}var Lu;function Jy(){return Lu||(Lu=1,function(t){var e=Ke&&Ke.__createBinding||(Object.create?function(h,f,p,g){g===void 0&&(g=p),Object.defineProperty(h,g,{enumerable:!0,get:function(){return f[p]}})}:function(h,f,p,g){g===void 0&&(g=p),h[g]=f[p]}),n=Ke&&Ke.__setModuleDefault||(Object.create?function(h,f){Object.defineProperty(h,"default",{enumerable:!0,value:f})}:function(h,f){h.default=f}),r=Ke&&Ke.__importStar||function(h){if(h&&h.__esModule)return h;var f={};if(h!=null)for(var p in h)Object.hasOwnProperty.call(h,p)&&e(f,h,p);return n(f,h),f},s=Ke&&Ke.__importDefault||function(h){return h&&h.__esModule?h:{default:h}};Object.defineProperty(t,"__esModule",{value:!0}),t.type=t.remove=t.insert=void 0;const o=Fa(),i=r(wi()),a=s(Xy()),l={create(h){return h},toString(h){return h},builder(h){if(typeof h!="string")throw Error("Invalid document snapshot: "+h);const f=[];return{skip(p){let g=o.uniToStrPos(h,p);if(g>h.length)throw Error("The op is too long for this document");f.push(h.slice(0,g)),h=h.slice(g)},append(p){f.push(p)},del(p){h=h.slice(o.uniToStrPos(h,p))},build(){return f.join("")+h}}},slice:i.uniSlice},u=i.default(l),c=Object.assign(Object.assign({},u),{api:a.default});t.type=c,t.insert=(h,f)=>f.length===0?[]:h===0?[f]:[h,f],t.remove=(h,f)=>i.dlen(f)===0?[]:h===0?[{d:f}]:[h,{d:f}];var d=wi();Object.defineProperty(t,"makeType",{enumerable:!0,get:function(){return d.default}})}(Ke)),Ke}var Fu;function Zy(){return Fu||(Fu=1,function(t){var e=vs&&vs.__importDefault||function(T){return T&&T.__esModule?T:{default:T}};Object.defineProperty(t,"__esModule",{value:!0}),t.editOp=t.replaceOp=t.insertOp=t.moveOp=t.removeOp=t.type=void 0;const n=e(zy()),r=e(Ky()),s=Qd(),o=qd();function i(T,D){if(!T)throw new Error(D)}t.type={name:"json1",uri:"http://sharejs.org/types/JSONv1",readCursor:s.readCursor,writeCursor:s.writeCursor,create:T=>T,isNoop:T=>T==null,setDebug(T){},registerSubtype:I,checkValidOp:G,normalize:z,apply:m,transformPosition:F,compose:v,tryTransform:M,transform:Q,makeInvertible:w,invert:x,invertWithDoc:A,RM_UNEXPECTED_CONTENT:o.ConflictType.RM_UNEXPECTED_CONTENT,DROP_COLLISION:o.ConflictType.DROP_COLLISION,BLACKHOLE:o.ConflictType.BLACKHOLE,transformNoConflict:(T,D,H)=>lt(()=>!0,T,D,H),typeAllowingConflictsPred:T=>Object.assign(Object.assign({},t.type),{transform:(D,H,Y)=>lt(T,D,H,Y)})};const a=T=>T?T.getComponent():null;function l(T){return T&&typeof T=="object"&&!Array.isArray(T)}const u=T=>Array.isArray(T)?T.slice():T!==null&&typeof T=="object"?Object.assign({},T):T,c=T=>T&&(T.p!=null||T.r!==void 0),d=T=>T&&(T.d!=null||T.i!==void 0);function h(T,D){return i(T!=null),typeof D=="number"?(i(Array.isArray(T),"Invalid key - child is not an array"),(T=T.slice()).splice(D,1)):(i(l(T),"Invalid key - child is not an object"),delete(T=Object.assign({},T))[D]),T}function f(T,D,H){return typeof D=="number"?(i(T!=null,"Container is missing for key"),i(Array.isArray(T),"Cannot use numerical key for object container"),i(T.length>=D,"Cannot insert into out of bounds index"),T.splice(D,0,H)):(i(l(T),"Cannot insert into missing item"),i(T[D]===void 0,"Trying to overwrite value at key. Your op needs to remove it first"),T[D]=H),H}t.removeOp=(T,D=!0)=>s.writeCursor().writeAtPath(T,"r",D).get(),t.moveOp=(T,D)=>s.writeCursor().writeMove(T,D).get(),t.insertOp=(T,D)=>s.writeCursor().writeAtPath(T,"i",D).get(),t.replaceOp=(T,D,H)=>s.writeCursor().at(T,Y=>{Y.write("r",D),Y.write("i",H)}).get(),t.editOp=(T,D,H,Y=!1)=>s.writeCursor().at(T,$=>R($,D,H,Y)).get();const p=(T,D)=>T!=null&&(typeof D=="number"?Array.isArray(T):typeof T=="object"),g=(T,D)=>p(T,D)?T[D]:void 0,_={};function I(T){let D=T.type?T.type:T;D.name&&(_[D.name]=D),D.uri&&(_[D.uri]=D)}const U=T=>{const D=_[T];if(D)return D;throw Error("Missing type: "+T)};I(Jy());const L=(T,D)=>T+D;I({name:"number",apply:L,compose:L,invert:T=>-T,transform:T=>T});const B=T=>T==null?null:T.et?U(T.et):T.es?_["text-unicode"]:T.ena!=null?_.number:null,C=T=>T.es?T.es:T.ena!=null?T.ena:T.e,R=(T,D,H,Y=!1)=>{const[$,j]=typeof D=="string"?[U(D),D]:[D,D.name];!Y&&$.isNoop&&$.isNoop(H)||(j==="number"?T.write("ena",H):j==="text-unicode"?T.write("es",H):(T.write("et",j),T.write("e",H)))};function y(T){i(typeof T=="number"),i(T>=0),i(T===(0|T))}function N(T){typeof T=="number"?y(T):i(typeof T=="string")}function G(T){if(T===null)return;const D=new Set,H=new Set,Y=j=>{let q=!0,nt=!1;for(let k in j){const K=j[k];if(q=!1,i(k==="p"||k==="r"||k==="d"||k==="i"||k==="e"||k==="es"||k==="ena"||k==="et","Invalid component item '"+k+"'"),k==="p")y(K),i(!D.has(K)),D.add(K),i(j.r===void 0);else if(k==="d")y(K),i(!H.has(K)),H.add(K),i(j.i===void 0);else if(k==="e"||k==="es"||k==="ena"){i(!nt),nt=!0;const Z=B(j);i(Z,"Missing type in edit"),Z.checkValidOp&&Z.checkValidOp(C(j))}}i(!q)},$=(j,q,nt)=>{if(!Array.isArray(j))throw Error("Op must be null or a list");if(j.length===0)throw Error("Empty descent");q||N(j[0]);let k=1,K=0,Z=0;for(let rt=0;rt<j.length;rt++){const pt=j[rt];if(i(pt!=null),Array.isArray(pt)){const yt=$(pt,!1);if(K){const X=typeof Z,ht=typeof yt;X===ht?i(Z<yt,"descent keys are not in order"):i(X==="number"&&ht==="string")}Z=yt,K++,k=3}else typeof pt=="object"?(i(k===1,`Prev not scalar - instead ${k}`),Y(pt),k=2):(i(k!==3),N(pt),i(s.isValidPathItem(pt),"Invalid path key"),k=1)}return i(K!==1,"Operation makes multiple descents. Remove some []"),i(k===2||k===3),j[0]};$(T,!0),i(D.size===H.size,"Mismatched picks and drops in op");for(let j=0;j<D.size;j++)i(D.has(j)),i(H.has(j))}function z(T){let D=0,H=[];const Y=s.writeCursor();return Y.mergeTree(T,($,j)=>{const q=B($);if(q){const k=C($);R(j,q,q.normalize?q.normalize(k):k)}for(const k of["r","p","i","d"])if($[k]!==void 0){const K=k==="p"||k==="d"?(nt=$[k],H[nt]==null&&(H[nt]=D++),H[nt]):$[k];j.write(k,K)}var nt}),Y.get()}function m(T,D){if(G(D),D===null)return T;const H=[];return function Y($,j){let q=$,nt=0,k={root:$},K=0,Z=k,rt="root";function pt(){for(;K<nt;K++){let yt=j[K];typeof yt!="object"&&(i(p(Z,rt)),Z=Z[rt]=u(Z[rt]),rt=yt)}}for(;nt<j.length;nt++){const yt=j[nt];if(Array.isArray(yt)){const X=Y(q,yt);X!==q&&X!==void 0&&(pt(),q=Z[rt]=X)}else if(typeof yt=="object"){yt.d!=null?(pt(),q=f(Z,rt,H[yt.d])):yt.i!==void 0&&(pt(),q=f(Z,rt,yt.i));const X=B(yt);if(X)pt(),q=Z[rt]=X.apply(q,C(yt));else if(yt.e!==void 0)throw Error("Subtype "+yt.et+" undefined")}else q=g(q,yt)}return k.root}(T=function Y($,j){const q=[];let nt=0;for(;nt<j.length;nt++){const rt=j[nt];if(Array.isArray(rt))break;typeof rt!="object"&&(q.push($),$=g($,rt))}for(let rt=j.length-1;rt>=nt;rt--)$=Y($,j[rt]);for(--nt;nt>=0;nt--){const rt=j[nt];if(typeof rt!="object"){const pt=q.pop();$=$===g(pt,rt)?pt:$===void 0?h(pt,rt):(K=rt,Z=$,(k=u(k=pt))[K]=Z,k)}else c(rt)&&(i($!==void 0,"Cannot pick up or remove undefined"),rt.p!=null&&(H[rt.p]=$),$=void 0)}var k,K,Z;return $}(T,D),D)}function F(T,D){T=T.slice(),G(D);const H=s.readCursor(D);let Y,$,j=!1;const q=[];for(let k=0;;k++){const K=T[k],Z=H.getComponent();if(Z&&(Z.r!==void 0?j=!0:Z.p!=null&&(j=!1,Y=Z.p,$=k)),k>=T.length)break;let rt=0;const pt=s.advancer(H,void 0,(X,ht)=>{c(ht)&&rt++});q.unshift(pt);const yt=pt(K);if(typeof K=="number"&&(T[k]-=rt),!yt)break}if(q.forEach(k=>k.end()),j)return null;const nt=()=>{let k=0;if(Y!=null){const K=H.getPath();k=K.length,T=K.concat(T.slice($))}for(;k<T.length;k++){const K=T[k],Z=a(H),rt=B(Z);if(rt){const X=C(Z);rt.transformPosition&&(T[k]=rt.transformPosition(T[k],X));break}let pt=0;const yt=s.advancer(H,(X,ht)=>d(ht)?~(X-pt):X-pt,(X,ht)=>{d(ht)&&pt++})(K);if(typeof K=="number"&&(T[k]+=pt),!yt)break}};return Y!=null?H.eachDrop(null,k=>{k===Y&&nt()}):nt(),T}function v(T,D){if(G(T),G(D),T==null)return D;if(D==null)return T;let H=0;const Y=s.readCursor(T),$=s.readCursor(D),j=s.writeCursor(),q=[],nt=[],k=[],K=[],Z=[],rt=[],pt=new Set;Y.traverse(null,X=>{X.p!=null&&(k[X.p]=Y.clone())}),$.traverse(null,X=>{X.d!=null&&(K[X.d]=$.clone())});const yt=s.writeCursor();return function X(ht,J,V,dt,Ot,bt,zt,ne){i(J||V);const Wt=a(J),we=a(V),ke=!!we&&we.r!==void 0,wn=!!Wt&&Wt.i!==void 0,Ie=Wt?Wt.d:null,ve=we?we.p:null,sn=(bt||ke)&&ve==null;if(ve!=null)dt=K[ve],zt=nt[ve]=new s.WriteCursor;else if(we&&we.r!==void 0)dt=null;else{const at=a(dt);at&&at.d!=null&&(dt=null)}const xt=a(dt);if(Ie!=null)if(ht=k[Ie],ne=q[Ie]=new s.WriteCursor,sn)bt&&!ke&&ne.write("r",!0);else{const at=Z[Ie]=H++;zt.write("d",at)}else if(Wt&&Wt.i!==void 0)ht=null;else{const at=a(ht);at&&at.p!=null&&(ht=null)}let ct;wn?(i(Ot===void 0),ct=Wt.i):ct=Ot;const Ct=(ve==null?!wn||bt||ke:ct===void 0)?null:zt.getComponent();if(ve!=null){if(!(Ot!==void 0||wn)){const at=Ie!=null?Z[Ie]:H++;rt[ve]=at,ne.write("p",at)}}else ke&&(wn||Ot!==void 0||(we.r,ne.write("r",we.r)));const ft=sn?null:B(Wt),it=B(xt);if((ft||it)&&(ft&&ft.name,it&&it.name),ft&&it){i(ft===it);const at=C(Wt),Rt=C(xt),qt=ft.compose(at,Rt);R(zt,ft,qt),pt.add(xt)}else ft?R(zt,ft,C(Wt)):it&&(R(zt,it,C(xt)),pt.add(xt));const gt=typeof ct=="object"&&ct!=null;let Dt=!1,St=0,Nt=0,Qt=0,Kt=0,Gt=0;const ae=s.advancer(dt,(at,Rt)=>d(Rt)?Kt-at-1:at-Kt,(at,Rt)=>{d(Rt)&&Kt++}),wt=s.advancer(ht,(at,Rt)=>c(Rt)?St-at-1:at-St,(at,Rt)=>{c(Rt)&&St++});if(s.eachChildOf(J,V,(at,Rt,qt)=>{let he,on,In=at,Pe=at,xr=at;if(typeof at=="number"){let re=at+Qt;on=ae(re),Pe=re+Kt;let Yt=at+Nt;he=wt(Yt),d(a(on))&&(he=null),In=Yt+St,xr=at+Gt,i(In>=0,"p1PickKey is negative"),i(Pe>=0,"p2DropKey is negative");const Ue=d(a(Rt)),an=c(a(qt));(Ue||an&&!sn)&&Gt--,Ue&&Nt--,an&&Qt--}else he=wt(at),on=ae(at);ne.descend(In),zt.descend(Pe);const $n=gt&&!d(a(Rt))?ct[xr]:void 0,Ge=X(he,Rt,qt,on,$n,sn,zt,ne);var Ye,mt,$t;gt&&!sn?$n!==Ge&&(Dt||(ct=Array.isArray(ct)?ct.slice():Object.assign({},ct),Dt=!0),Ye=ct,$t=Ge,typeof(mt=xr)=="number"?(i(Array.isArray(Ye)),i(mt<Ye.length)):(i(!Array.isArray(Ye)),i(Ye[mt]!==void 0)),$t===void 0?typeof mt=="number"?Ye.splice(mt,1):delete Ye[mt]:Ye[mt]=$t):i(Ge===void 0),zt.ascend(),ne.ascend()}),wt.end(),ae.end(),Ct!=null)Ct.i=ct;else if(!bt&&!ke&&ve==null)return ct}(Y,Y.clone(),$,$.clone(),void 0,!1,j,yt),j.reset(),j.mergeTree(yt.get()),j.reset(),j.get(),q.map(X=>X.get()),nt.map(X=>X.get()),Y.traverse(j,(X,ht)=>{const J=X.p;if(J!=null){const V=Z[J];V!=null&&ht.write("p",V);const dt=q[J];dt&&dt.get(),dt&&ht.mergeTree(dt.get())}else X.r!==void 0&&ht.write("r",X.r)}),j.reset(),j.get(),$.traverse(j,(X,ht)=>{const J=X.d;if(J!=null){const dt=rt[J];dt!=null&&ht.write("d",dt);const Ot=nt[J];Ot&&ht.mergeTree(Ot.get())}else X.i!==void 0&&ht.write("i",X.i);const V=B(X);V&&!pt.has(X)&&R(ht,V,C(X))}),j.get()}function x(T){if(T==null)return null;const D=new s.ReadCursor(T),H=new s.WriteCursor;let Y;const $=[],j=[];return function q(nt,k,K){const Z=nt.getComponent();let rt,pt=!1;if(Z){Z.p!=null&&(k.write("d",Z.p),$[Z.p]=nt.clone()),Z.r!==void 0&&k.write("i",Z.r),Z.d!=null&&(k.write("p",Z.d),K=void 0),Z.i!==void 0&&(K=rt=Z.i);const X=B(Z);X&&(K===void 0?(Y||(Y=new Set),Y.add(Z)):(C(Z),K=X.apply(K,C(Z)),pt=!0))}let yt=0;for(const X of nt){k.descend(X);const ht=typeof X=="number"?X-yt:X,J=g(K,ht);d(nt.getComponent())&&yt++;const V=q(nt,k,J);if(K!==void 0&&V!==void 0){if(pt||(pt=!0,K=u(K)),!p(K,ht))throw Error("Cannot modify child - invalid operation");K[ht]=V}k.ascend()}if(rt===void 0)return pt?K:void 0;k.write("r",K)}(D,H,void 0),Y&&(H.reset(),function q(nt,k,K){const Z=k.getComponent();if(Z){const X=Z.d;if(X!=null&&(nt=$[X],K=j[X]=s.writeCursor()),Y.has(Z)){const ht=B(Z);if(!ht.invert)throw Error(`Cannot invert subtype ${ht.name}`);R(K,ht,ht.invert(C(Z)))}}let rt=0,pt=0;const yt=s.advancer(nt,(X,ht)=>c(ht)?rt-X-1:X-rt,(X,ht)=>{c(ht)&&rt++});for(const X of k)if(typeof X=="number"){const ht=X-pt,J=yt(ht),V=ht+rt;K.descend(V),q(J,k,K),d(k.getComponent())&&pt++,K.ascend()}else K.descend(X),q(yt(X),k,K),K.ascend();yt.end()}(D.clone(),D,H),j.length&&(H.reset(),D.traverse(H,(q,nt)=>{const k=q.p;if(k!=null){const K=j[k];K&&K.get(),K&&nt.mergeTree(K.get())}}))),H.get()}const S=(T,D)=>T.some(H=>typeof H=="object"&&(Array.isArray(H)?S(H,D):D(H)));function w(T,D){if(T==null||!S(T,k=>{var K;return k.r!==void 0||((K=B(k))===null||K===void 0?void 0:K.makeInvertible)!=null}))return T;const H=new s.ReadCursor(T),Y=new s.WriteCursor;let $=!1;const j=[],q=[],nt=(k,K,Z)=>{const rt=k.getComponent();let pt=!1;if(rt){rt.d!=null&&K.write("d",rt.d),rt.i!==void 0&&K.write("i",rt.i);const X=rt.p;if(X!=null&&(j[X]=k.clone(),i(Z!==void 0,"Operation picks up at an invalid key"),q[X]=Z,K.write("p",rt.p)),rt.r!==void 0&&Z===void 0)throw Error("Invalid doc / op in makeInvertible: removed item missing from doc");const ht=B(rt);ht&&(ht.makeInvertible?$=!0:R(K,ht,C(rt),!0))}let yt=0;for(const X of k){K.descend(X);const ht=typeof X=="number"?X-yt:X,J=g(Z,ht),V=nt(k,K,J);J!==V&&(pt||(pt=!0,Z=u(Z)),V===void 0?(Z=h(Z,ht),typeof X=="number"&&yt++):Z[ht]=V),K.ascend()}return rt&&(rt.r!==void 0?(K.write("r",r.default(Z)),Z=void 0):rt.p!=null&&(Z=void 0)),Z};return nt(H,Y,D),Y.get(),$&&(Y.reset(),function k(K,Z,rt,pt,yt){const X=Z.getComponent();if(X){X.i!==void 0?(pt=X.i,yt=!0):X.d!=null&&(pt=q[X.d],K=j[X.d],yt=!1,X.d);let dt=B(X);if(dt&&dt.makeInvertible){const Ot=C(X);R(rt,dt,dt.makeInvertible(Ot,pt),!0)}}let ht=0,J=0;const V=s.advancer(K,(dt,Ot)=>c(Ot)?ht-dt-1:dt-ht,(dt,Ot)=>{c(Ot)&&ht++});for(const dt of Z)if(typeof dt=="number"){const Ot=dt-J,bt=V(Ot),zt=Ot+ht,ne=g(pt,yt?Ot:zt);rt.descend(dt),k(bt,Z,rt,ne,yt),d(Z.getComponent())&&J++,rt.ascend()}else{const Ot=g(pt,dt);rt.descend(dt),k(V(dt),Z,rt,Ot,yt),rt.ascend()}V.end()}(H.clone(),H,Y,D,!1)),Y.get()}function A(T,D){return x(w(T,D))}const O=T=>{if(T==null)return null;const D=T.slice();for(let H=0;H<T.length;H++){const Y=D[H];Array.isArray(Y)&&(D[H]=O(Y))}return D};function M(T,D,H){i(H==="left"||H==="right","Direction must be left or right");const Y=H==="left"?0:1;if(D==null)return{ok:!0,result:T};G(T),G(D);let $=null;const j=[],q=[],nt=[],k=[],K=[],Z=[],rt=[],pt=[],yt=[],X=[],ht=[],J=[],V=[],dt=[],Ot=[];let bt=0;const zt=s.readCursor(T),ne=s.readCursor(D),Wt=s.writeCursor();if(function xt(ct,Ct=null,ft){const it=a(Ct);it&&(it.r!==void 0?ft=Ct.clone():it.p!=null&&(ft=null,Z[it.p]=ct.clone()));const gt=ct.getComponent();let Dt;gt&&(Dt=gt.p)!=null&&(K[Dt]=Ct?Ct.clone():null,nt[Dt]=ct.clone(),ft&&(X[Dt]=!0,yt[Dt]=ft),it&&it.p!=null&&(dt[Dt]=it.p));const St=s.advancer(Ct);for(const Nt of ct)xt(ct,St(Nt),ft);St.end()}(ne,zt,null),function xt(ct,Ct,ft,it,gt){const Dt=ft.getComponent();let St,Nt=!1;Dt&&((St=Dt.d)!=null?(k[St]=ft.clone(),it!=null&&(Ot[it]==null&&(Ot[it]=[]),Ot[it].push(St)),X[St],ct=K[St]||null,Ct=nt[St]||null,X[St]?(gt&&(ht[St]=!0),gt=yt[St]||null):!gt||Y!==1&&dt[St]!=null||$==null&&($={type:o.ConflictType.RM_UNEXPECTED_CONTENT,op1:t.removeOp(gt.getPath()),op2:t.moveOp(Ct.getPath(),ft.getPath())}),Nt=!0):Dt.i!==void 0&&(ct=Ct=null,Nt=!0,gt&&$==null&&($={type:o.ConflictType.RM_UNEXPECTED_CONTENT,op1:t.removeOp(gt.getPath()),op2:t.insertOp(ft.getPath(),Dt.i)})));const Qt=a(ct);Qt&&(Qt.r!==void 0?gt=ct.clone():Qt.p!=null&&(Qt.p,it=Qt.p,gt=null));const Kt=B(Dt);Kt&&gt&&$==null&&($={type:o.ConflictType.RM_UNEXPECTED_CONTENT,op1:t.removeOp(gt.getPath()),op2:t.editOp(ft.getPath(),Kt,C(Dt),!0)});let Gt=0,ae=0;const wt=s.advancer(Ct,(Rt,qt)=>c(qt)?Gt-Rt-1:Rt-Gt,(Rt,qt)=>{c(qt)&&Gt++}),at=s.advancer(ct);for(const Rt of ft)if(typeof Rt=="number"){const qt=Rt-ae,he=wt(qt);ae+=+xt(at(qt+Gt),he,ft,it,gt)}else{const qt=wt(Rt);xt(at(Rt),qt,ft,it,gt)}return wt.end(),at.end(),Nt}(zt,ne,ne.clone(),null,null),k.map(xt=>xt&&xt.get()),$)return{ok:!1,conflict:$};ht.map(xt=>!!xt);const we=[];let ke=null;(function xt(ct,Ct,ft,it,gt){let Dt=!1;const St=a(Ct);if(c(St)){const wt=St.p;wt!=null?(ft=k[wt],it=J[wt]=s.writeCursor(),Dt=!0,gt=null):(ft=null,gt=Ct.clone())}else d(a(ft))&&(ft=null);const Nt=ct.getComponent();if(Nt){const wt=Nt.p;wt!=null?(gt&&(pt[wt]=gt),we[wt]=gt||Y===1&&Dt?null:it.getComponent(),j[wt]=ct.clone(),ft&&(rt[wt]=ft.clone())):Nt.r!==void 0&&(gt||it.write("r",!0),(gt||Dt)&&(ke==null&&(ke=new Set),ke.add(Nt)))}let Qt=0,Kt=0;const Gt=s.advancer(Ct,void 0,(wt,at)=>{c(at)&&Qt++}),ae=s.advancer(ft,(wt,at)=>d(at)?~(wt-Kt):wt-Kt,(wt,at)=>{d(at)&&Kt++});if(ct)for(const wt of ct)if(typeof wt=="string"){const at=Gt(wt),Rt=ae(wt);it.descend(wt),xt(ct,at,Rt,it,gt),it.ascend()}else{const at=Gt(wt),Rt=wt-Qt,qt=c(a(at))?null:ae(Rt),he=Rt+Kt;i(he>=0),it.descend(he),xt(ct,at,qt,it,gt),it.ascend()}Gt.end(),ae.end()})(zt,ne,ne.clone(),Wt,null),Wt.reset();let wn=[];if(function xt(ct,Ct,ft,it,gt,Dt){i(Ct);const St=Ct.getComponent();let Nt=a(it),Qt=!1;const Kt=(mt,$t,re)=>mt?t.moveOp(mt.getPath(),$t.getPath()):t.insertOp($t.getPath(),re.i);if(d(St)){const mt=St.d;mt!=null&&(q[mt]=Ct.clone());const $t=mt!=null?we[mt]:null;let re=!1;if(St.i!==void 0||mt!=null&&$t){let Yt;Nt&&(Nt.i!==void 0||(Yt=Nt.d)!=null&&!X[Yt])&&(re=Yt!=null?mt!=null&&mt===dt[Yt]:n.default(Nt.i,St.i),re||Yt!=null&&Y!==1&&dt[Yt]!=null||$==null&&($={type:o.ConflictType.DROP_COLLISION,op1:Kt(mt!=null?j[mt]:null,Ct,St),op2:Kt(Yt!=null?nt[Yt]:null,it,Nt)})),re||(Dt?$==null&&($={type:o.ConflictType.RM_UNEXPECTED_CONTENT,op1:Kt(mt!=null?j[mt]:null,Ct,St),op2:t.removeOp(Dt.getPath())}):(mt!=null?(wn[bt]=mt,gt.write("d",$t.p=bt++)):gt.write("i",r.default(St.i)),Qt=!0))}else if(mt!=null&&!$t){const Yt=pt[mt];Yt&&(Dt=Yt.clone())}mt!=null?(ct=j[mt],ft=Z[mt],it=rt[mt]):St.i!==void 0&&(ct=ft=null,re||(it=null))}else c(a(ct))&&(ct=ft=it=null);const Gt=a(ct),ae=a(ft);if(c(ae)){const mt=ae.p;ae.r!==void 0&&(!Gt||Gt.r===void 0)||X[mt]?(it=null,Dt=ft.clone()):mt!=null&&(it=k[mt],Y!==1&&dt[mt]!=null||((gt=V[mt])||(gt=V[mt]=s.writeCursor()),gt.reset(),Dt=null))}else!d(St)&&d(Nt)&&(it=null);Nt=it!=null?it.getComponent():null;const wt=B(St);if(wt){const mt=C(St);if(Dt)$==null&&($={type:o.ConflictType.RM_UNEXPECTED_CONTENT,op1:t.editOp(Ct.getPath(),wt,mt,!0),op2:t.removeOp(Dt.getPath())});else{const $t=B(Nt);let re;if($t){if(wt!==$t)throw Error("Transforming incompatible types");const Yt=C(Nt);re=wt.transform(mt,Yt,H)}else re=r.default(mt);R(gt,wt,re)}}let at=0,Rt=0,qt=0,he=0,on=0,In=0,Pe=ct!=null&&ct.descendFirst(),xr=Pe;const $n=s.advancer(ft,void 0,(mt,$t)=>{c($t)&&qt++});let Ge=it!=null&&it.descendFirst(),Ye=Ge;for(const mt of Ct)if(typeof mt=="number"){let $t;const re=d(Ct.getComponent()),Yt=mt-Rt;{let fn;for(;Pe&&typeof(fn=ct.getKey())=="number";){fn+=at;const Be=ct.getComponent(),Hn=c(Be);if(fn>Yt||fn===Yt&&(!Hn||Y===0&&re))break;if(Hn){at--;const Sn=Be.p;dt.includes(Sn),Be.d,a(V[Be.d]),c(a(V[Be.d])),(Be.r===void 0||ke&&ke.has(Be))&&(Sn==null||!we[Sn]||Y!==1&&dt.includes(Sn))||on--}Pe=ct.nextSibling()}$t=Pe&&fn===Yt?ct:null}const Ue=Yt-at;let an=$n(Ue);const No=Ue-qt;let fs=null;{let fn,Be;for(;Ge&&typeof(fn=it.getKey())=="number";){Be=fn-he;const Hn=it.getComponent(),Sn=d(Hn);if(Be>No)break;if(Be===No){if(!Sn){fs=it;break}{if(Y===0&&re){fs=it;break}const pn=an&&c(an.getComponent());if(Y===0&&pn)break}}if(Sn){const pn=Hn.d;X[pn],dt[pn],Hn.i===void 0&&(X[pn]||dt[pn]!=null&&Y!==1)?(X[pn]||dt[pn]!=null&&Y===0)&&(he++,In--):he++}Ge=it.nextSibling()}}const wl=No+he+on+In;i(wl>=0,"trying to descend to a negative index"),gt.descend(wl),re&&($t=an=fs=null,Rt++),xt($t,Ct,an,fs,gt,Dt)&&In++,gt.ascend()}else{let $t;for(;Pe&&($t=ct.getKey(),typeof $t!="string"||!($t>mt||$t===mt));)Pe=ct.nextSibling();const re=Pe&&$t===mt?ct:null,Yt=$n(mt);let Ue;for(;Ge&&(Ue=it.getKey(),typeof Ue!="string"||!(Ue>mt||Ue===mt));)Ge=it.nextSibling();const an=Ge&&Ue===mt?it:null;gt.descend(mt),xt(re,Ct,Yt,an,gt,Dt),gt.ascend()}return $n.end(),xr&&ct.ascend(),Ye&&it.ascend(),Qt}(zt,zt.clone(),ne,ne.clone(),Wt,null),$)return{ok:!1,conflict:$};Wt.reset();const Ie=(xt,ct,Ct)=>xt.traverse(ct,(ft,it)=>{ft.d!=null&&Ct(ft.d,xt,it)});(X.length||J.length)&&(Ie(ne,Wt,(xt,ct,Ct)=>{X[xt]&&!ht[xt]&&Ct.write("r",!0),J[xt]&&Ct.mergeTree(J[xt].get())}),Wt.reset());const ve=[],sn=[];if((V.length||X.length)&&!$){const xt=s.readCursor(O(Wt.get()));if(Ie(xt,null,(ct,Ct)=>{ve[ct]=Ct.clone()}),V.forEach(ct=>{ct&&Ie(s.readCursor(ct.get()),null,(Ct,ft)=>{ve[Ct]=ft.clone()})}),function ct(Ct,ft,it,gt,Dt,St){const Nt=a(ft);if(Nt&&c(Nt))if(Nt.p!=null){const at=Nt.p;ve[at].getPath(),it=ve[at],gt=sn[at]=s.writeCursor()}else Nt.r!==void 0&&(it=null);else d(a(it))&&(it=null);const Qt=Ct.getComponent();if(Qt){let at;if((at=Qt.d)!=null){const Rt=V[at];Rt&&(Rt.get(),gt.mergeTree(Rt.get()),it=s.readCursor(Rt.get()))}}let Kt=0,Gt=0;const ae=s.advancer(ft,void 0,(at,Rt)=>{c(Rt)&&Kt--}),wt=s.advancer(it,(at,Rt)=>d(Rt)?-(at-Gt)-1:at-Gt,(at,Rt)=>{d(Rt)&&Gt++});for(const at of Ct)if(typeof at=="number"){const Rt=ae(at),qt=at+Kt,he=wt(qt),on=qt+Gt;gt.descend(on),ct(Ct,Rt,he,gt),gt.ascend()}else gt.descend(at),ct(Ct,ae(at),wt(at),gt),gt.ascend();ae.end(),wt.end()}(ne,xt,xt.clone(),Wt),Wt.reset(),$)return{ok:!1,conflict:$};if(Wt.get(),sn.length){const ct=sn.map(ft=>ft?ft.get():null),Ct=s.readCursor(O(Wt.get()));if(Ie(Ct,Wt,(ft,it,gt)=>{const Dt=ct[ft];Dt&&(gt.mergeTree(Dt),ct[ft]=null)}),ct.find(ft=>ft)){const ft=s.writeCursor(),it=s.writeCursor();let gt=0,Dt=0;ct.forEach(St=>{St!=null&&Ie(s.readCursor(St),null,Nt=>{const Qt=wn[Nt];ft.writeMove(j[Qt].getPath(),q[Qt].getPath(),gt++);const Kt=Ot[Qt];Kt&&Kt.forEach(Gt=>{X[Gt]||Y!==1&&dt[Gt]!=null||it.writeMove(nt[Gt].getPath(),k[Gt].getPath(),Dt++)})})}),$={type:o.ConflictType.BLACKHOLE,op1:ft.get(),op2:it.get()}}}}return $?{ok:!1,conflict:$}:{ok:!0,result:Wt.get()}}const P=T=>{const D=new Error("Transform detected write conflict");throw D.conflict=T,D.type=D.name="writeConflict",D};function Q(T,D,H){const Y=M(T,D,H);if(Y.ok)return Y.result;P(Y.conflict)}const W=T=>{const D=s.writeCursor();return s.readCursor(T).traverse(D,(H,Y)=>{(d(H)||B(H))&&Y.write("r",!0)}),D.get()},ot=(T,D)=>{const{type:H,op1:Y,op2:$}=T;switch(H){case o.ConflictType.DROP_COLLISION:return D==="left"?[null,W($)]:[W(Y),null];case o.ConflictType.RM_UNEXPECTED_CONTENT:let j=!1;return s.readCursor(Y).traverse(null,q=>{q.r!==void 0&&(j=!0)}),j?[null,W($)]:[W(Y),null];case o.ConflictType.BLACKHOLE:return[W(Y),W($)];default:throw Error("Unrecognised conflict: "+H)}};function lt(T,D,H,Y){let $=null;for(;;){const j=M(D,H,Y);if(j.ok)return v($,j.result);{const{conflict:q}=j;T(q)||P(q);const[nt,k]=ot(q,Y);D=v(z(D),nt),H=v(z(H),k),$=v($,k)}}}}(vs)),vs}var ku;function Qy(){return ku||(ku=1,function(t){var e=Gn&&Gn.__createBinding||(Object.create?function(o,i,a,l){l===void 0&&(l=a),Object.defineProperty(o,l,{enumerable:!0,get:function(){return i[a]}})}:function(o,i,a,l){l===void 0&&(l=a),o[l]=i[a]}),n=Gn&&Gn.__exportStar||function(o,i){for(var a in o)a!=="default"&&!i.hasOwnProperty(a)&&e(i,o,a)};Object.defineProperty(t,"__esModule",{value:!0}),n(Zy(),t);var r=Qd();Object.defineProperty(t,"ReadCursor",{enumerable:!0,get:function(){return r.ReadCursor}}),Object.defineProperty(t,"WriteCursor",{enumerable:!0,get:function(){return r.WriteCursor}});var s=qd();Object.defineProperty(t,"ConflictType",{enumerable:!0,get:function(){return s.ConflictType}})}(Gn)),Gn}var _e=Qy();const qy=Fe(_e),HT=yg({__proto__:null,default:qy},[_e]);var Et=(t=>(t[t.COVER=0]="COVER",t[t.REPLACE=1]="REPLACE",t))(Et||{}),tt=(t=>(t.RETAIN="r",t.INSERT="i",t.DELETE="d",t))(tt||{});const ds=Te("univer.context-service");class tv extends ee{constructor(){super(...arguments),b(this,"_contextChanged$",new ce),b(this,"contextChanged$",this._contextChanged$.asObservable()),b(this,"_contextMap",new Map)}dispose(){super.dispose(),this._contextChanged$.complete(),this._contextMap.clear()}getContextValue(e){var n;return(n=this._contextMap.get(e))!=null?n:!1}setContextValue(e,n){this._contextMap.set(e,n),this._contextChanged$.next({[e]:n})}subscribeContextValue$(e){return new ie(n=>{const r=this._contextChanged$.pipe(En(s=>typeof s[e]<"u")).subscribe(s=>n.next(s[e]));return this._contextMap.has(e)&&n.next(this._contextMap.get(e)),()=>r.unsubscribe()})}}var ev=(t=>(t[t.SILENT=0]="SILENT",t[t.ERROR=1]="ERROR",t[t.WARN=2]="WARN",t[t.INFO=3]="INFO",t[t.VERBOSE=4]="VERBOSE",t))(ev||{});const je=Te("univer.log");class nv extends ee{constructor(){super(...arguments),b(this,"_logLevel",3),b(this,"_deduction",new Set)}dispose(){super.dispose(),this._logLevel=3,this._deduction.clear()}debug(...e){this._logLevel>=4&&this._log(console.debug,...e)}log(...e){this._logLevel>=3&&this._log(console.log,...e)}warn(...e){this._logLevel>=2&&this._log(console.warn,...e)}error(...e){this._logLevel>=1&&this._log(console.error,...e)}deprecate(...e){this._logLevel>=2&&this._logWithDeduplication(console.error,...e)}setLogLevel(e){this._logLevel=e}_log(e,...n){const r=n[0];/^\[(.*?)\]/g.test(r)?e(`\x1B[97;104m${r}\x1B[0m`,...n.slice(1)):e(...n)}_logWithDeduplication(e,...n){const r=rv(...n);this._deduction.has(r)||(this._deduction.add(r),this._log(e,...n))}}function rv(...t){return t.map(e=>JSON.stringify(e)).join("")}var sv=(t,e,n,r)=>{for(var s=e,o=t.length-1,i;o>=0;o--)(i=t[o])&&(s=i(s)||s);return s},Pu=(t,e)=>(n,r)=>e(n,r,t),hs=(t=>(t[t.COMMAND=0]="COMMAND",t[t.OPERATION=1]="OPERATION",t[t.MUTATION=2]="MUTATION",t))(hs||{});const Co=Te("univer.core.command-service");class ov{constructor(){b(this,"_commands",new Map),b(this,"_commandTypes",new Map)}registerCommand(e){if(this._commands.has(e.id))throw new Error(`[CommandRegistry]: command "${e.id}" has been registered before.`);return this._commands.set(e.id,e),this._commandTypes.set(e.id,e.type),Zt(()=>{this.unregisterCommand(e.id)})}unregisterCommand(e){this._commands.delete(e),this._commandTypes.delete(e)}hasCommand(e){return this._commands.has(e)}getCommand(e){return this._commands.has(e)?[this._commands.get(e)]:null}getCommandType(e){return this._commandTypes.get(e)}}const iv={id:"nil",type:0,handler:()=>!0};let Ii=class extends ee{constructor(t,e){super(),b(this,"_commandRegistry"),b(this,"_beforeCommandExecutionListeners",[]),b(this,"_commandExecutedListeners",[]),b(this,"_multiCommandDisposables",new Map),b(this,"_commandExecutingLevel",0),b(this,"_commandExecutionStack",[]),this._injector=t,this._logService=e,this._commandRegistry=new ov,this.registerCommand(iv)}dispose(){super.dispose(),this._commandExecutedListeners.length=0,this._beforeCommandExecutionListeners.length=0}hasCommand(t){return this._commandRegistry.hasCommand(t)}registerCommand(t){return this._commandRegistry.registerCommand(t)}unregisterCommand(t){var e;this._commandRegistry.unregisterCommand(t),(e=this._multiCommandDisposables.get(t))==null||e.dispose()}registerMultipleCommand(t){return this._registerMultiCommand(t)}beforeCommandExecuted(t){if(this._beforeCommandExecutionListeners.indexOf(t)===-1)return this._beforeCommandExecutionListeners.push(t),Zt(()=>{const e=this._beforeCommandExecutionListeners.indexOf(t);this._beforeCommandExecutionListeners.splice(e,1)});throw new Error("[CommandService]: could not add a listener twice.")}onCommandExecuted(t){if(this._commandExecutedListeners.indexOf(t)===-1)return this._commandExecutedListeners.push(t),Zt(()=>{const e=this._commandExecutedListeners.indexOf(t);this._commandExecutedListeners.splice(e,1)});throw new Error("[CommandService]: could not add a listener twice.")}async executeCommand(t,e,n){try{const r=this._commandRegistry.getCommand(t);if(r){const[s]=r,o={id:s.id,type:s.type,params:e},i=this._pushCommandExecutionStack(o),a=n??{};this._beforeCommandExecutionListeners.forEach(u=>u(o,a));const l=await this._execute(s,e,a);return this._commandExecutedListeners.forEach(u=>u(o,a)),i.dispose(),l}throw new Error(`[CommandService]: command "${t}" is not registered.`)}catch(r){if(r instanceof _i)return!1;throw r}}syncExecuteCommand(t,e,n){var r;try{const s=this._commandRegistry.getCommand(t);if(s){const[o]=s,i={id:o.id,type:o.type,params:e};if(o.type===2){const c=Rg(this._commandExecutionStack,d=>d.type===0);c&&(i.params=(r=i.params)!=null?r:{},i.params.trigger=c.id)}const a=this._pushCommandExecutionStack(i),l=n??{};this._beforeCommandExecutionListeners.forEach(c=>c(i,l));const u=this._syncExecute(o,e,l);return this._commandExecutedListeners.forEach(c=>c(i,l)),a.dispose(),u}throw new Error(`[CommandService]: command "${t}" is not registered.`)}catch(s){if(s instanceof _i)return!1;throw s}}_pushCommandExecutionStack(t){return this._commandExecutionStack.push(t),Zt(()=>go(this._commandExecutionStack,t))}_registerMultiCommand(t){const e=this._commandRegistry.getCommand(t.id);let n;if(e){if(e[0].multi!==!0)throw new Error("Command has registered as a single command.");n=e[0]}else{n=new av(t.id);const s=new xa;s.add(this._commandRegistry.registerCommand(n)),s.add(Zt(()=>{this._multiCommandDisposables.delete(t.id)})),this._multiCommandDisposables.set(t.id,s)}const r=n.registerImplementation(t);return Zt(()=>{var s;r.dispose(),n.hasImplementations()||(s=this._multiCommandDisposables.get(t.id))==null||s.dispose()})}async _execute(t,e,n){this._logService.debug("[CommandService]",`${"|-".repeat(Math.max(this._commandExecutingLevel,0))}executing command "${t.id}"`),this._commandExecutingLevel++;let r;try{r=await this._injector.invoke(t.handler,e,n),this._commandExecutingLevel--}catch(s){throw r=!1,this._commandExecutingLevel=0,s}return r}_syncExecute(t,e,n){this._logService.debug("[CommandService]",`${"|-".repeat(Math.max(0,this._commandExecutingLevel))}executing command "${t.id}".`),this._commandExecutingLevel++;let r;try{if(r=this._injector.invoke(t.handler,e,n),r instanceof Promise)throw new TypeError("[CommandService]: Command handler should not return a promise.");this._commandExecutingLevel--}catch(s){throw r=!1,this._commandExecutingLevel=0,s}return r}};Ii=sv([Pu(0,Ve(Rr)),Pu(1,je)],Ii);class av{constructor(e){b(this,"name"),b(this,"multi",!0),b(this,"type",0),b(this,"priority",0),b(this,"_implementations",[]),b(this,"handler",async(n,r)=>{if(!this._implementations.length)return!1;const s=n.get(je),o=n.get(ds),i=n.get(Rr);for(const a of this._implementations){const l=a.command.preconditions;if((!l||l&&l(o))&&(s.debug("[MultiCommand]",`executing implementation "${a.command.name}".`),await i.invoke(a.command.handler,r)))return!0}return!1}),this.id=e,this.name=e}registerImplementation(e){const n={command:e};return this._implementations.push(n),this._implementations.sort((r,s)=>s.command.priority-r.command.priority),Zt(()=>{const r=this._implementations.indexOf(n);this._implementations.splice(r,1)})}hasImplementations(){return this._implementations.length>0}}function ka(t,e,n){const r=t.map(s=>()=>e.syncExecuteCommand(s.id,s.params,n));return H_(r)}function jT(t,e,n){const r=t.map(s=>()=>e.executeCommand(s.id,s.params,n));return $_(r)}function lv(t){return new ie(e=>{const n=t((...r)=>e.next(r));return()=>n==null?void 0:n.dispose()})}function Uu(t){return function(e){return new ie(n=>(e.subscribe({next:r=>{n.next(r),t(r)&&n.complete()},complete:()=>n.complete(),error:r=>n.error(r)}),()=>n.unsubscribe()))}}function VT(t=0){return e=>{let n=[];return e.pipe(ru(r=>n.push(r)),yd(t),Ir(()=>n),ru(()=>n=[]))}}function WT(t){const e=new Sp(1);return setTimeout(()=>e.next(),t),e.pipe(vd(1))}function GT(t,e){const n=new de(e);return t.subscribe(n),n}const YT=t=>new Promise(e=>{_d(lv(t.onCommandExecuted.bind(t)).pipe(En(([n])=>n.type===hs.MUTATION)),ug(300)).pipe(yd(16),gg()).subscribe(()=>{e()})});function uv(t,e){let n=0,r=t.length-1;if(e<t[0])return 0;if(e>=t[t.length-1])return t.length-1;for(;n<=r;){if(t[n]===e){for(;n<t.length&&t[n]===e;)n++;return n}if(e>t[n]&&e<t[n+1])return n+1;if(t[r]===e){for(;r<t.length&&t[r]===e;)r++;return r}if(e>t[r-1]&&e<t[r])return r;n++,r--}return-1}function zT(t,e){let n=0,r=t.length-1;for(;n<=r;){const s=Math.floor((r+n)/2);if(e<t[s]&&(s===0||e>=t[s-1]))return s;if(e>=t[s])n=s+1;else if(e<t[s])r=s-1;else return-1}return-1}function cv(t,e){let n=0,r=t.length;for(;n<r;){const s=Math.floor((n+r)/2);t[s]<=e?n=s+1:r=s}return n<t.length?n:t.length-1}function Rs(t,e,n=!1){let r=t.length-1;if(e<0||e<t[0])return 0;if(t.length<40||e<=t[20]||e>=t[r-20]?r=uv(t,e):r=cv(t,e),n){const s=t[r];return t.indexOf(s)}return r}function KT(t){const e=new Blob([t],{type:"text/javascript"});return window.URL.createObjectURL(e)}const Ts=2,dv=1;function XT(t,e){if(e==null||t==null)return!0;const{left:n=0,top:r=0,height:s=0,width:o=0,angle:i=0}=e,{left:a=0,top:l=0,height:u=0,width:c=0,angle:d=0}=t,h=c,f=u,p=o,g=s;return Math.abs(a-n)>Ts||Math.abs(l-r)>Ts||Math.abs(h-p)>Ts||Math.abs(f-g)>Ts||Math.abs(d-i)>dv}function zo(t,e,n){const{dataStream:r,textRuns:s=[]}=t;let o=e;const i=[];for(const a of s){const{st:l,ed:u}=a;et.hasIntersectionBetweenTwoRanges(e,n,l,u)&&(l>o?(i.push(r.slice(o,l)),i.push(Bu(r,{...a,ed:Math.min(u,n)}))):i.push(Bu(r,{...a,st:o,ed:Math.min(u,n)}))),o=Math.max(e,Math.min(u,n))}return o!==n&&i.push(r.slice(o,n)),i.join("")}function JT(t,e=!0){var n;if(e&&(n=t.paragraphs)!=null&&n.length){const{dataStream:r,paragraphs:s=[]}=t;let o="",i=-1;for(const a of s){const{startIndex:l,paragraphStyle:u={}}=a,{spaceAbove:c,spaceBelow:d,lineSpacing:h}=u,f=[];c!=null&&(typeof c=="number"?f.push(`margin-top: ${c}px`):f.push(`margin-top: ${c.v}px`)),d!=null&&(typeof d=="number"?f.push(`margin-bottom: ${d}px`):f.push(`margin-bottom: ${d.v}px`)),h!=null&&f.push(`line-height: ${h}`),l>i+1?o+=`<p class="UniverNormal" ${f.length?`style="${f.join("; ")};"`:""}>${zo(t,i+1,l)}</p>`:o+=`<p class="UniverNormal" ${f.length?`style="${f.join("; ")};"`:""}></p>`,i=l}return i!==r.length&&(o+=zo(t,i,r.length)),o}else return zo(t,0,t.dataStream.length)}function Bu(t,e){const{st:n,ed:r,ts:s={}}=e,{ff:o,fs:i,it:a,bl:l,ul:u,st:c,ol:d,bg:h,cl:f,va:p}=s;let g=t.slice(n,r);const _=[];return a===ut.TRUE&&(g=`<i>${g}</i>`),p===vn.SUPERSCRIPT?g=`<sup>${g}</sup>`:p===vn.SUBSCRIPT&&(g=`<sub>${g}</sub>`),(u==null?void 0:u.s)===ut.TRUE&&(g=`<u>${g}</u>`),(c==null?void 0:c.s)===ut.TRUE&&(g=`<s>${g}</s>`),l===ut.TRUE&&(g=`<strong>${g}</strong>`),o&&_.push(`font-family: ${o}`),f&&_.push(`color: ${f.rgb}`),i&&_.push(`font-size: ${i}pt`),d&&_.push("text-decoration: overline"),h&&_.push(`background: ${h.rgb}`),_.length?`<span style="${_.join("; ")};">${g}</span>`:g}const hv={[La.OFFICE]:{[me.ACCENT1]:"#4472C4",[me.ACCENT2]:"#ED7D31",[me.ACCENT3]:"#A5A5A5",[me.ACCENT4]:"#70AD47",[me.ACCENT5]:"#5B9BD5",[me.ACCENT6]:"#70AD47",[me.DARK1]:"#000000",[me.DARK2]:"#44546A",[me.LIGHT1]:"#FFFFFF",[me.LIGHT2]:"#E7E6E6",[me.HYPERLINK]:"#0563C1",[me.FOLLOWED_HYPERLINK]:"#954F72"}};class Pa{constructor(){b(this,"_themeValue",me.LIGHT1),b(this,"_themeColors"),b(this,"_themeTint"),b(this,"_rgbValue",""),b(this,"_colorType"),this._colorType=He.UNSUPPORTED,this._themeColors=La.OFFICE,this._themeTint=0}asRgbColor(){return new pv(this._rgbValue,this)}asThemeColor(){return new gv(this._themeValue,this._themeTint,this._themeColors,this)}build(){switch(this._colorType){case He.THEME:return this.asThemeColor();case He.RGB:return this.asRgbColor();case He.UNSUPPORTED:throw new Error("unsupported color type")}}setRgbColor(e){return this._colorType=He.RGB,this._rgbValue=e,this}setThemeColors(e){this._colorType=He.THEME,this._themeColors=e}setThemeTint(e){this._colorType=He.THEME,this._themeTint=e}setThemeColor(e){return this._colorType=He.THEME,this._themeValue=e,this}getColorType(){return this._colorType}}class yr{constructor(e){b(this,"_builder"),this._builder=e}static rgbColorToHexValue(e){return`#${((1<<24)+(e.getRed()<<16)+(e.getGreen()<<8)+e.getBlue()).toString(16).slice(1)}`}static hexValueToRgbColor(e){e?e.indexOf("#")>-1&&(e=e.substring(1)):e="#000000";const n=+`0x${e[0]}${e[1]}`,r=+`0x${e[2]}${e[3]}`,s=+`0x${e[4]}${e[5]}`;return new Pa().setRgbColor(`rgb(${n},${r},${s})`).asRgbColor()}static hexToRgbString(e){const n=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;e=e.replace(n,(o,i,a,l)=>i+i+a+a+l+l);const r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);let s=null;if(r){const o=Number.parseInt(r[1],16),i=Number.parseInt(r[2],16),a=Number.parseInt(r[3],16);s=`rgba(${o},${i},${a})`}return s}asRgbColor(){return this._builder.asRgbColor()}asThemeColor(){return this._builder.asThemeColor()}getColorType(){return this._builder.getColorType()}clone(){return new yr(this._builder)}equals(e){return!1}}class fv{constructor(e){b(this,"_saturation",0),b(this,"_hue",0),b(this,"_lightness",0),b(this,"_alpha",0);const n=e.getRed()/255,r=e.getGreen()/255,s=e.getBlue()/255,o=e.getAlpha()/255,i=Math.min(n,Math.min(r,s)),a=Math.max(n,Math.max(r,s)),l=a-i;if(a===i){this._hue=0,this._saturation=0,this._lightness=a;return}this._lightness=(i+a)/2,this._lightness<.5?this._saturation=l/(a+i):this._saturation=l/(2-a-i),n===a&&(this._hue=(r-s)/l),r===a&&(this._hue=2+(s-n)/l),s===a&&(this._hue=4+(n-r)/l),this._hue*=60,this._hue<0&&(this._hue+=360),this._alpha=o}asRgbColor(){const e=new Pa;if(this._saturation===0)return e.setRgbColor(`rgba(${this._lightness*255},${this._lightness*255},${this._lightness*255},${this._alpha*255})`),e.asRgbColor();let n;this._lightness<.5?n=this._lightness*(1+this._saturation):n=this._lightness+this._saturation-this._lightness*this._saturation;const r=2*this._lightness-n,s=this._hue/360,o=s+1/3,i=this.setColor(n,r,o),a=this.setColor(n,r,s),l=s-1/3,u=this.setColor(n,r,l);return e.setRgbColor(`rgba(${Math.round(i*255)},${Math.round(a*255)},${Math.round(u*255)},${this._alpha*255})`),e.asRgbColor()}getLightness(){return this._lightness}getHue(){return this._hue}getSaturation(){return this._saturation}getAlpha(){return this._alpha}setColor(e,n,r){r<0&&(r+=1),r>1&&(r-=1);let s;return 6*r<1?s=n+(e-n)*6*r:2*r<1?s=e:3*r<2?s=n+(e-n)*(2/3-r)*6:s=n,s}setLightness(e){this._lightness=e}}const Gs=class _n extends yr{constructor(e,n){super(n),b(this,"_cssString"),b(this,"_red"),b(this,"_green"),b(this,"_blue"),b(this,"_alpha");let r=e.match(_n.RGBA_EXTRACT);if(r){const s=+r[1],o=+r[2],i=+r[3],a=+r[4];this._cssString=e,this._red=s,this._green=o,this._blue=i,this._alpha=a;return}if(r=e.match(_n.RGB_EXTRACT),r){const s=+r[1],o=+r[2],i=+r[3];this._cssString=e,this._red=s,this._green=o,this._blue=i,this._alpha=1;return}throw new Error("Invalid rgba or rgb color")}asHexString(){return yr.rgbColorToHexValue(this)}getRed(){let e=this._red+_n.RGB_COLOR_AMT;return e>255?e=255:e<0&&(e=0),e}getGreen(){let e=this._green+_n.RGB_COLOR_AMT;return e>255?e=255:e<0&&(e=0),e}getBlue(){let e=this._blue+_n.RGB_COLOR_AMT;return e>255?e=255:e<0&&(e=0),e}getAlpha(){return this._alpha}getColorType(){return He.RGB}clone(){return new _n(this._cssString,this._builder)}asThemeColor(){throw new Error("rgb color not support to themeColor")}equals(e){return e instanceof _n?e._red===this._red&&e._blue===this._blue&&e._green===this._green&&e._alpha===this._alpha:!1}getCssString(){return this._cssString}};b(Gs,"RGB_COLOR_AMT",0),b(Gs,"RGBA_EXTRACT",new RegExp("\\s*rgba\\s*\\((\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d.\\d|\\d\\s*)\\)\\s*")),b(Gs,"RGB_EXTRACT",new RegExp("\\s*rgb\\s*\\((\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d+\\s*)\\)\\s*"));let pv=Gs;const th=class qn extends yr{constructor(e,n,r,s){super(s),b(this,"_themeColorType"),b(this,"_themeTint"),b(this,"_themeColors"),this._themeColorType=e,this._themeTint=n,this._themeColors=r}lumValue(e,n){if(e==null)return n;let r;return e<0?r=n*(1+e):r=n*(1-e)+(255-255*(1-e)),r}asRgbColor(){const e=hv[this._themeColors];if(e==null)throw new Error("not find themeColors type");const n=e[this._themeColorType];if(n==null)throw new Error("not find themeColors value");let r;if(qn._cacheThemeColor.has(this._themeColors)){if(r=qn._cacheThemeColor.get(this._themeColors),r.has(this._themeColorType))return r.get(this._themeColorType)}else r=new Map,qn._cacheThemeColor.set(this._themeColors,r);const s=new fv(yr.hexValueToRgbColor(n));s.setLightness(this.lumValue(this._themeTint,s.getLightness()*255)/255);const o=s.asRgbColor();return r.set(this._themeColorType,o),o}clone(){return new qn(this._themeColorType,this._themeTint,this._themeColors,this._builder)}equals(e){return e instanceof qn?e._themeColorType===this._themeColorType:!1}getColorType(){return He.THEME}getThemeColorType(){return this._themeColorType}};b(th,"_cacheThemeColor",new Map);let gv=th;const ZT="rgb(",QT="rgba(",$u={aliceBlue:[240,248,255],antiqueWhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blancheAlmond:[255,235,205],blue:[0,0,255],blueViolet:[138,43,226],brown:[165,42,42],burlyWood:[222,184,135],cadetBlue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornFlowerBlue:[100,149,237],cornSilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkBlue:[0,0,139],darkCyan:[0,139,139],darkGoldenrod:[184,132,11],darkGray:[169,169,169],darkGreen:[0,100,0],darkGrey:[169,169,169],darkKhaki:[189,183,107],darkMagenta:[139,0,139],darkOliveGreen:[85,107,47],darkOrange:[255,140,0],darkOrchid:[153,50,204],darkRed:[139,0,0],darkSalmon:[233,150,122],darkSeaGreen:[143,188,143],darkSlateBlue:[72,61,139],darkSlateGray:[47,79,79],darkSlateGrey:[47,79,79],darkTurquoise:[0,206,209],darkViolet:[148,0,211],darkYellow:[139,128,0],deepPink:[255,20,147],deepSkyBlue:[0,191,255],dimGray:[105,105,105],dimGrey:[105,105,105],dodgerBlue:[30,144,255],firebrick:[178,34,34],floralWhite:[255,255,240],forestGreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostWhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenYellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotPink:[255,105,180],indianRed:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderBlush:[255,240,245],lawnGreen:[124,252,0],lemonChiffon:[255,250,205],lightblue:[173,216,230],lightCoral:[240,128,128],lightCyan:[224,255,255],lightGoldenrodYellow:[250,250,210],lightGray:[211,211,211],lightGreen:[144,238,144],lightGrey:[211,211,211],lightPink:[255,182,193],lightSalmon:[255,160,122],lightSeaGreen:[32,178,170],lightSkyBlue:[135,206,250],lightSlateGray:[119,136,153],lightSlateGrey:[119,136,153],lightSteelBlue:[176,196,222],lightYellow:[255,255,224],lime:[0,255,0],limeGreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumAquamarine:[102,205,170],mediumBlue:[0,0,205],mediumOrchid:[186,85,211],mediumPurple:[147,112,219],mediumSeaGreen:[60,179,113],mediumSlateBlue:[123,104,238],mediumSpringGreen:[0,250,154],mediumTurquoise:[72,209,204],mediumVioletRed:[199,21,133],midBightBlue:[25,25,112],mintCream:[245,255,250],mistyRose:[255,228,225],moccasin:[255,228,181],navajoWhite:[255,222,173],navy:[0,0,128],oldLace:[253,245,230],olive:[128,128,0],oliveDrab:[107,142,35],orange:[255,165,0],orangeRed:[255,69,0],orchid:[218,112,214],paleGoldenrod:[238,232,170],paleGreen:[152,251,152],paleTurquoise:[175,238,238],paleVioletRed:[219,112,147],papayaWhip:[255,239,213],peachPuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderBlue:[176,224,230],purple:[128,0,128],rebeccaPurple:[102,51,153],red:[255,0,0],rosyBrown:[188,143,143],royalBlue:[65,105,225],saddleBrown:[139,69,19],salmon:[250,128,114],sandyBrown:[244,164,96],seaGreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyBlue:[135,206,235],slateBlue:[106,90,205],slateGray:[119,128,144],slateGrey:[119,128,144],snow:[255,255,250],springGreen:[0,255,127],steelBlue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whiteSmoke:[245,245,245],yellow:[255,255,0],yellowGreen:[154,205,5]};class $e{constructor(e){if(b(this,"_color"),b(this,"_rgbColor"),b(this,"_isValid",!1),e==null){this._setNullColor();return}if(e instanceof $e){this._color={...e._color},this._rgbColor={...e._rgbColor};return}const n=eh(e);if(n==null){this._setNullColor();return}this._color=n;const r=Ev(this._color);if(r==null){this._setNullColor();return}this._rgbColor=r,this._isValid=!0}static mix(e,n,r){var s,o;r=Math.min(1,Math.max(0,r));const i=new $e(e).toRgb(),a=new $e(n).toRgb(),l=(s=i.a)!=null?s:1,u=(o=a.a)!=null?o:1,c={r:(a.r-i.r)*r+i.r,g:(a.g-i.g)*r+i.g,b:(a.b-i.b)*r+i.b,a:(u-l)*r+l};return new $e(c)}static getContrastRatio(e,n){const r=new $e(e).getLuminance(),s=new $e(n).getLuminance();return(Math.max(r,s)+.05)/(Math.min(r,s)+.05)}get isValid(){return this._isValid}toRgb(){return this._rgbColor}toRgbString(){const{r:e,g:n,b:r,a:s=1}=this.toRgb(),o=s<1;return`rgb${o?"a":""}(${e},${n},${r}${o?`,${s}`:""})`}toString(){return this.toRgbString()}toHexString(e){const{r:n,g:r,b:s,a:o=1}=this.toRgb(),i=o<1,a=[ws(Math.round(n).toString(16)),ws(Math.round(r).toString(16)),ws(Math.round(s).toString(16)),ws(Math.round(o*255).toString(16))];return e&&a[0][0]===a[0][1]&&a[1][0]===a[1][1]&&a[2][0]===a[2][1]&&a[3][0]===a[3][1]?i?`#${a[0][0]}${a[1][0]}${a[2][0]}${a[3][0]}`:`#${a[0][0]}${a[1][0]}${a[2][0]}`:i?`#${a[0]}${a[1]}${a[2]}${a[3]}`:`#${a[0]}${a[1]}${a[2]}`}toHsv(){return Tv(this.toRgb())}toHsl(){return Rv(this.toRgb())}lighten(e=10){const n=this.toHsl();return n.l+=e,n.l=Math.min(Math.max(n.l,0),100),new $e(n)}darken(e=10){const n=this.toHsl();return n.l-=e,n.l=Math.min(Math.max(n.l,0),100),new $e(n)}setAlpha(e){return new $e({...this._rgbColor,a:e})}getLuminance(){let{r:e,g:n,b:r}=this.toRgb();return e=Ko(e),n=Ko(n),r=Ko(r),Number((.2126*e+.7152*n+.0722*r).toFixed(3))}getBrightness(){const{r:e,g:n,b:r}=this.toRgb();return(e*299+n*587+r*114)/1e3}getAlpha(){var e;return(e=this._color.a)!=null?e:1}isDark(){return this.getBrightness()<128}isLight(){return!this.isDark()}_setNullColor(){this._isValid=!1,this._color={r:0,g:0,b:0,a:0},this._rgbColor={r:0,g:0,b:0,a:0}}}const ws=t=>t.length===1?`0${t}`:t,Ko=t=>(t/=255,t<=.03928?t/12.92:((t+.055)/1.055)**2.4),eh=t=>{if(Iv(t)){if("r"in t){const r={r:Math.round(t.r),g:Math.round(t.g),b:Math.round(t.b)};return t.a!==void 0&&(r.a=t.a),r}if("l"in t){const r={h:Math.round(t.h),s:t.s,l:t.l};return t.a!==void 0&&(r.a=t.a),r}const n={h:Math.round(t.h),s:t.s,v:t.v};return t.a!==void 0&&(n.a=t.a),n}const e=t.trim();if($u[e]){const n=$u[e],r={r:Math.round(n[0]),g:Math.round(n[1]),b:Math.round(n[2])};return r.a=n[3]||1,r}if(e.startsWith("#"))return mv(e);if(e.startsWith("rgb"))return _v(e);if(e.startsWith("hsl"))return yv(e);if(e.startsWith("hsv"))return vv(e)},mv=t=>{const e=t.substring(1),n=new RegExp(`.{1,${e.length>=6?2:1}}`,"g");let r=e.match(n);if(!r||r.length<3)throw new Error(`The color '${t}' is illegal hex color`);r[0].length===1&&(r=r.map(o=>o+o));const s={r:Number.parseInt(r[0],16),g:Number.parseInt(r[1],16),b:Number.parseInt(r[2],16)};return r.length>3&&(s.a=Number.parseInt(r[3],16)/255),s},_v=t=>{const e=t.indexOf("(");if(e===-1)throw new Error(`The color '${t}' is illegal rgb color`);const n=t.substring(e+1,t.length-1).split(",");if(n.length<3)throw new Error(`The color '${t}' is illegal rgb color`);const r={r:Number.parseInt(n[0],10),g:Number.parseInt(n[1],10),b:Number.parseInt(n[2],10)};return n.length>3&&(r.a=Number.parseFloat(n[3])),r},yv=t=>{const e=t.indexOf("(");if(e===-1)throw new Error(`The color '${t}' is illegal hsl color`);const n=t.substring(e+1,t.length-1).split(",");if(n.length<3)throw new Error(`The color '${t}' is illegal hsl color`);const r={h:Number.parseInt(n[0],10),s:Number.parseFloat(n[1]),l:Number.parseFloat(n[2])};return n.length>3&&(r.a=Number.parseFloat(n[3])),r},vv=t=>{const e=t.indexOf("(");if(e===-1)throw new Error(`The color '${t}' is illegal hsv color`);const n=t.substring(e+1,t.length-1).split(",");if(n.length<3)throw new Error(`The color '${t}' is illegal hsv color`);const r={h:Number.parseInt(n[0],10),s:Number.parseFloat(n[1]),v:Number.parseFloat(n[2])};return n.length>3&&(r.a=Number.parseFloat(n[3])),r},Ev=t=>{const e=eh(t);if(e!=null)return"r"in e?e:"l"in e?bv(e):Cv(e)},Xo=(t,e,n)=>(n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t),bv=t=>{let{h:e,s:n,l:r}=t;e/=360,n/=100,r/=100;let s=0,o=0,i=0;if(n===0)s=o=i=r;else{const l=r<.5?r*(1+n):r+n-r*n,u=2*r-l;s=Xo(u,l,e+1/3),o=Xo(u,l,e),i=Xo(u,l,e-1/3)}const a={r:Math.round(s*255),g:Math.round(o*255),b:Math.round(i*255)};return t.a!==void 0&&(a.a=t.a),a},Cv=t=>{let{h:e,s:n,v:r}=t;e=e/360*6,n/=100,r/=100;const s=Math.floor(e),o=e-s,i=r*(1-n),a=r*(1-o*n),l=r*(1-(1-o)*n),u=s%6,c=[r,a,i,i,l,r][u],d=[l,r,r,a,i,i][u],h=[i,i,l,r,r,a][u],f={r:c*255,g:d*255,b:h*255};return t.a!==void 0&&(f.a=t.a),f},Rv=t=>{let{r:e,g:n,b:r}=t;e/=255,n/=255,r/=255;const s=Math.max(e,n,r),o=Math.min(e,n,r),i=(s+o)/2;let a,l;if(s===o)a=l=0;else{const c=s-o;switch(l=i>.5?c/(2-s-o):c/(s+o),s){case e:a=(n-r)/c+(n<r?6:0);break;case n:a=(r-e)/c+2;break;default:a=(e-n)/c+4;break}a/=6}const u={h:Math.round(a*360),s:Math.round(l*100),l:Math.round(i*100)};return t.a!==void 0&&(u.a=t.a),u},Tv=t=>{let{r:e,g:n,b:r}=t;e/=255,n/=255,r/=255;const s=Math.max(e,n,r),o=Math.min(e,n,r);let i;const a=s,l=s-o,u=s===0?0:l/s;if(s===o)i=0;else{switch(s){case e:i=(n-r)/l+(n<r?6:0);break;case n:i=(r-e)/l+2;break;default:i=(e-n)/l+4;break}i/=6}const c={h:Math.round(i*360),s:Math.round(u*100),v:Math.round(a*100)};return t.a!==void 0&&(c.a=t.a),c},wv=t=>t==null,Iv=t=>!wv(t)&&typeof t=="object";function qT(t){const e=/^#(?:[0]{3}|[0]{6})\b/,n=/^rgb\s*\(\s*0+\s*,\s*0+\s*,\s*0+\s*\)$/,r=/^rgba\s*\(\s*0+\s*,\s*0+\s*,\s*0+\s*,\s*(1|1\.0*|0?\.\d+)\)$/,s=/^hsl\s*\(\s*0*\s*,\s*0%*\s*,\s*0%*\s*\)$/,o=/^hsla\s*\(\s*0*\s*,\s*0%*\s*,\s*0%*\s*,\s*(1|1\.0*|0?\.\d+)\)$/;return!!(e.test(t)||n.test(t)||r.test(t)||s.test(t)||o.test(t))}function tw(t){const e=/^#(?:[Ff]{3}|[Ff]{6})\b/,n=/^rgb\s*\(\s*255\s*,\s*255\s*,\s*255\s*\)$/,r=/^rgba\s*\(\s*255\s*,\s*255\s*,\s*255\s*,\s*(1|1\.0*|0?\.\d+)\)$/,s=/^hsl\s*\(\s*0*\s*,\s*0%*\s*,\s*100%*\s*\)$/,o=/^hsla\s*\(\s*0*\s*,\s*0%*\s*,\s*100%*\s*,\s*(1|1\.0*|0?\.\d+)\)$/;return!!(e.test(t)||n.test(t)||r.test(t)||s.test(t)||o.test(t))}function Sv(t){return t&&(t.s!==void 0||t.p!==void 0||t.v!==void 0||t.t!==void 0||t.f!==void 0||t.si!==void 0||t.custom!==void 0)}function ew(t){if(t.t!==void 0)return t.t;if(typeof t.v=="string")return Mn.STRING;if(typeof t.v=="number")return Mn.NUMBER;if(typeof t.v=="boolean")return Mn.BOOLEAN}function nw(t){if(t==null)return!0;const{v:e,f:n,si:r,p:s,custom:o}=t;return!(!(e==null||typeof e=="string"&&e.length===0)||n!=null&&n.length>0||r!=null&&r.length>0||s!=null||o!=null)}function Av(t){return t!=null&&(typeof t=="string"||typeof t=="number"||typeof t=="boolean")}var vt=(t=>(t[t.NORMAL=0]="NORMAL",t[t.ROW=1]="ROW",t[t.COLUMN=2]="COLUMN",t[t.ALL=3]="ALL",t))(vt||{}),Lt=(t=>(t[t.NONE=0]="NONE",t[t.ROW=1]="ROW",t[t.COLUMN=2]="COLUMN",t[t.ALL=3]="ALL",t))(Lt||{});function rw(t){return[t.startRow,t.startColumn,t.endRow,t.endColumn]}var Ov=(t=>(t.NONE="none",t.BACKWARD="backward",t.FORWARD="forward",t))(Ov||{}),Dv=(t=>(t.RECT="RECT",t.TEXT="TEXT",t))(Dv||{});function sw(t,e,n){let r=!1,s=!1,o=t,i=e,a=t,l=e;if(n==null)return{actualRow:t,actualColumn:e,isMergedMainCell:s,isMerged:r,endRow:o,endColumn:i,startRow:a,startColumn:l};for(let u=0;u<n.length;u++){const{startRow:c,endRow:d,startColumn:h,endColumn:f}=n[u];if(t===c&&e===h){o=d,i=f,a=c,l=h,s=!0;break}if(t>=c&&t<=d&&e>=h&&e<=f){o=d,i=f,a=c,l=h,r=!0;break}}return{actualRow:t,actualColumn:e,isMergedMainCell:s,isMerged:r,endRow:o,endColumn:i,startRow:a,startColumn:l}}var Vr=(t=>(t.Raw="raw",t.Intercepted="intercepted",t.Both="both",t))(Vr||{});function ow(t,e){const n={};for(const r in t){const s=Number(r),o=t[s];for(const i in o){const a=Number(i),l=o[a],u=e(s,a,l);u!==void 0&&(n[s]?n[s][a]=u:n[s]={[a]:u})}}return n}function Ln(t){let e=0;const n=Object.keys(t);for(const r of n){const s=Number(r);e=Math.max(e,s)}return e+1}function iw(t,e,n){const r=Ln(n),s=n;for(let o=r-1;o>=t;o--)s[o+1]=s[o];s[t]=e}function Hu(t,e,n){const r=Object.keys(n).reduce((s,o)=>Math.max(s,Number.parseInt(o)),0)+1;for(let s=t;s<r;s++)s<t+e?delete n[s]:n[s]!==void 0&&(n[s-e]=n[s],delete n[s])}function aw(t,e){const n=t,r=Object.keys(n),s=r.length,o=e,i=Object.keys(o),a=i.length,l={};let u=0;for(let c=0;c<s;c++,u++){const d=r[c];l[u]=n[d]}for(let c=0;c<a;c++,u++){const d=i[c];l[u]=o[d]}return l}function lw(t,e,n){const r=n;if(Ln(n)>0){const s={};let o=0;for(let i=t;i<=e;i++)r[i]&&(s[o]=r[i],o++);return s}return{}}function ju(t,e,n,r){const s=t>n;if(!s&&t+e>n)throw new Error("Invalid move operation");s?xv(t,e,n,r):Nv(t,e,n,r)}function xv(t,e,n,r){const s=r,o=[];for(let i=t;i<t+e;i++)o.push(s[i]);for(let i=t-1;i>=n;i--){const a=s[i];s[i+e]=a,a===void 0&&delete s[i+e]}o.forEach((i,a)=>{s[n+a]=i,i===void 0&&delete s[n+a]})}function Nv(t,e,n,r){const s=r,o=[];for(let i=t;i<t+e;i++)o.push(s[i]);for(let i=t+e;i<n;i++){const a=s[i];s[i-e]=a,a===void 0&&delete s[i-e]}o.forEach((i,a)=>{s[n+a-e]=i,i===void 0&&delete s[n+a-e]})}class De{constructor(e={}){b(this,"_matrix"),this._setOriginValue(e)}static MakeObjectMatrixSize(e){return new De({[e-1]:{}})}getMatrix(){return this._matrix}forEach(e){const n=this._matrix,r=Object.keys(n);for(const s of r){const o=Number(s),i=n[o];if(e(o,i)===!1)return this}return this}forRow(e){const n=this._matrix,r=Object.keys(n);for(const s of r){const o=Number(s),i=n[o];if(e(o,Object.keys(i).map(a=>Number(a)))===!1)return this}return this}forValue(e){const n=this._matrix;for(const r in n){const s=Number(r),o=n[s];if(o)for(const i in o){const a=Number(i),l=o[a];if(e(s,a,l)===!1)return this}}return this}swapRow(e,n){const r=this._matrix[e],s=this._matrix[n];this._matrix[e]=s,this._matrix[n]=r}getRow(e){return this._matrix[e]}getRowOrCreate(e){let n=this.getRow(e);return n==null&&(n={},this._matrix[e]=n),n}reset(){this._setOriginValue({})}hasValue(){const e=this._matrix,n=Object.keys(e);if(n.length===0)return!1;for(const r of n){const s=Number(r),o=e[s];if(Object.keys(o).length>0)return!0}return!1}getValue(e,n){var r,s;return(s=(r=this._matrix)==null?void 0:r[e])==null?void 0:s[n]}setValue(e,n,r){const s=this.getRowOrCreate(e);s[n]=r}deleteValue(e,n){var r,s;(s=(r=this._matrix)==null?void 0:r[e])==null||delete s[n]}realDeleteValue(e,n){var r,s,o;if((s=(r=this._matrix)==null?void 0:r[e])==null||delete s[n],this.getRow(e)){const i=this.getRow(e);if(i==null)return;Object.keys(i).length===0&&((o=this._matrix)==null||delete o[e])}}setRow(e,n){this._matrix[e]=n}moveRows(e,n,r){ju(e,n,r,this._matrix)}moveColumns(e,n,r){this.forEach((s,o)=>{ju(e,n,r,o)})}insertRows(e,n){const r=Object.keys(this._matrix);for(let s=r.length-1;s>=0;s--){const o=Number(r[s]);if(o>=e){const i=this._matrix[o];delete this._matrix[o],this._matrix[o+n]=i}}}insertColumns(e,n){const r=Object.keys(this._matrix);for(let s=0;s<r.length;s++){const o=Number(r[s]),i=this._matrix[o],a=Object.keys(i);for(let l=a.length-1;l>=0;l--){const u=Number(a[l]);if(u>=e){const c=i[u];delete i[u],i[u+n]=c}}}}removeRows(e,n){Hu(e,n,this._matrix)}removeColumns(e,n){this.forEach((r,s)=>{s&&Hu(e,n,s)})}getFragment(e,n,r,s){const o=new De;let i=0;for(let a=e;a<=n;a++){const l={};let u=0;for(let c=r;c<=s;c++){const d=this.getValue(a,c);l[u]=d,u++}o.setRow(i,l),i++}return o}getSlice(e,n,r,s){const o=new De;for(let i=e;i<=n;i++)for(let a=r;a<=s;a++){const l=this.getValue(i,a);l&&o.setValue(i,a,et.deepClone(l))}return o}getSizeOf(){return Object.keys(this._matrix).length}getLength(){return Ln(this._matrix)}getRange(){const e=this.getLength()-1;let n=0;const r=this.getLength();for(let s=0;s<r;s++){const o=this.getRow(s);if(o){const i=Ln(o)-1;n=i>n?i:n}}return{startRow:0,startColumn:0,endRow:e,endColumn:n}}toNativeArray(){const e=new Array;return this.forValue((n,r,s)=>{e.push(s)}),e}toArray(){const e=[];return this.forRow((n,r)=>{e[n]==null&&(e[n]=[]),r.forEach(s=>{e[n][s]=this.getValue(n,s)})}),e}toFullArray(){const e=this.getRange(),{endColumn:n,endRow:r}=e,s=[];for(let o=0;o<=r;o++){const i=new Array(n+1).fill(void 0);s.push(i)}return this.forValue((o,i,a)=>{s[o][i]=a}),s}toJSON(){return this._matrix}clone(){const e=JSON.stringify(this._matrix);return JSON.parse(e)}getData(){const e=JSON.stringify(this._matrix);return JSON.parse(e)}getArrayData(){let e=0,n=0,r=!1,s=!1;const o=new De;return this.forEach((i,a)=>{r||(r=!0,e=i),Object.keys(a).forEach(l=>{const u=Number(l);s?u<n&&(n=u):(s=!0,n=u);const c=this.getValue(i,u);o.setValue(i-e,u-n,c)})}),o.getData()}getStartEndScope(){let e=1/0,n=-1/0,r=1/0,s=-1/0;const o=Object.keys(this._matrix);o.length>0&&(e=+o[0],n=+o[o.length-1]);for(const i of o){const a=Object.keys(this._matrix[i]);a.length>0&&(r=Math.min(r,+a[0]),s=Math.max(s,+a[a.length-1]))}return{startRow:e,endRow:n,startColumn:r,endColumn:s}}getDataRange(){let e=0,n=0,r=0,s=-1,o=!1,i=!1;return this.forEach((a,l)=>{if(o||(o=!0,e=a),l==null)return;const u=Ln(l)-1;u>r&&(r=u),Object.keys(l).forEach(c=>{const d=Number(c);i?d<n&&(n=d):(i=!0,n=d)}),a>s&&(s=a)}),{startRow:e,startColumn:n,endRow:s,endColumn:r}}getDiscreteRanges(){const e=[];return this.forEach((n,r)=>{Object.keys(r).forEach(s=>{const o=Number(s);let i=!1;for(const a of e)if(n>=a.startRow&&n<=a.endRow+1&&o>=a.startColumn&&o<=a.endColumn+1){a.endRow=Math.max(n,a.endRow),a.endColumn=Math.max(o,a.endColumn),i=!0;break}i||e.push({startRow:n,endRow:n,startColumn:o,endColumn:o})})}),e}merge(e){this.forValue((n,r)=>{const s=e.getValue(n,r);s!=null&&this.setValue(n,r,s)})}_setOriginValue(e={}){this._matrix=e}}function Mv(t){const{actualRow:e,actualColumn:n,isMerged:r,isMergedMainCell:s,mergeInfo:o}=t;let{startY:i,endY:a,startX:l,endX:u}=t,c=e,d=n,h=e,f=n;if(r&&o){const{startRow:p,startColumn:g,endRow:_,endColumn:I,startY:U,endY:L,startX:B,endX:C}=o;c=p,d=g,h=_,f=I,i=U,a=L,l=B,u=C}return s&&(i=o.startY,a=o.endY,l=o.startX,u=o.endX,h=o.endRow,f=o.endColumn),{startRow:c,startColumn:d,endRow:h,endColumn:f,startY:i,endY:a,startX:l,endX:u}}const uw=Mv;function cw(t){if(!t)return;const{actualRow:e,actualColumn:n,isMerged:r,isMergedMainCell:s,startRow:o,startColumn:i,endRow:a,endColumn:l}=t;let u=e,c=n,d=e,h=n;return(r||s)&&(u=o,c=i,d=a,h=l),{startRow:u,startColumn:c,endRow:d,endColumn:h}}function Lv(t){var e;return!t||(((e=t==null?void 0:t.v)==null?void 0:e.toString())||"").length===0&&!t.p}function Vu(t){return Lv(t)&&(t==null?void 0:t.coverable)!==!1}function cn(t){if(t){if(t.rgb)return new $e(t.rgb).toHexString();if(t.th)return new Pa().setThemeColor(t.th).asThemeColor().asRgbColor().getCssString()}return null}function Fv(t){return et.isString(t)&&t.substring(0,1)==="="&&t.length>1}function dw(t){return et.isString(t)&&t.length>0}function hw(t,e=!1){var n;let r="";const s=new Map([["ff",()=>{t.ff&&(r+=`font-family: ${t.ff}; `)}],["fs",()=>{if(t.fs){let i=t.fs;t.va&&(i/=2),r+=`font-size: ${i}pt; `}}],["it",()=>{t.it&&(r+="font-style: italic; ")}],["bl",()=>{t.bl&&(r+="font-weight: bold; ")}],["ul",()=>{var i;(i=t.ul)!=null&&i.s&&(r.indexOf("text-decoration-line")>-1?r=r.replace(/(text-decoration-line:\s*[^;]+)(?=;)/g,(a,l)=>`${l} underline`):r+="text-decoration: underline; ",t.ul.cl&&r.indexOf("text-decoration-color")===-1&&(r+=`text-decoration-color: ${cn(t.ul.cl)}; `),t.ul.t&&r.indexOf("text-decoration-style")===-1&&(r+=`text-decoration-style: ${t.ul.t} `))}],["st",()=>{var i;(i=t.st)!=null&&i.s&&(r.indexOf("text-decoration-line")>-1?r=r.replace(/(text-decoration-line:\s*[^;]+)(?=;)/g,(a,l)=>`${l} line-through`):r+="text-decoration-line: line-through; ",t.st.cl&&r.indexOf("text-decoration-color")===-1&&(r+=`text-decoration-color: ${cn(t.st.cl)}; `),t.st.t&&r.indexOf("text-decoration-style")===-1&&(r+=`text-decoration-style: ${t.st.t} `))}],["ol",()=>{var i;(i=t.ol)!=null&&i.s&&(r.indexOf("text-decoration-line")>-1?r=r.replace(/(text-decoration-line:\s*[^;]+)(?=;)/g,(a,l)=>`${l} overline`):r+="text-decoration-line: overline; ",t.ol.cl&&r.indexOf("text-decoration-color")===-1&&(r+=`text-decoration-color: ${cn(t.ol.cl)}; `),t.ol.t&&r.indexOf("text-decoration-style")===-1&&(r+=`text-decoration-style: ${t.ol.t} `))}],["bg",()=>{t.bg&&(r+=`background: ${cn(t.bg)}; `)}],["bd",()=>{var i,a,l,u,c,d,h,f,p,g,_,I;(i=t.bd)!=null&&i.b&&(r+=`border-bottom: ${Is((a=t.bd)==null?void 0:a.b.s)} ${(l=cn(t.bd.b.cl))!=null?l:""}; `),(u=t.bd)!=null&&u.t&&(r+=`border-top: ${Is((c=t.bd)==null?void 0:c.t.s)} ${(d=cn(t.bd.t.cl))!=null?d:""}; `),(h=t.bd)!=null&&h.r&&(r+=`border-right: ${Is((f=t.bd)==null?void 0:f.r.s)} ${(p=cn(t.bd.r.cl))!=null?p:""}; `),(g=t.bd)!=null&&g.l&&(r+=`border-left: ${Is((_=t.bd)==null?void 0:_.l.s)} ${(I=cn(t.bd.l.cl))!=null?I:""}; `)}],["cl",()=>{t.cl&&(r+=`color: ${cn(t.cl)}; `)}],["va",()=>{t.va===vn.SUBSCRIPT?r+="vertical-align: sub; ":t.va===vn.SUPERSCRIPT&&(r+="vertical-align: super; ")}],["td",()=>{t.td===to.LEFT_TO_RIGHT?r+="direction: ltr; ":t.td===to.RIGHT_TO_LEFT&&(r+="direction: rtl; ")}],["tr",()=>{var i,a,l;t.tr&&(r+=`--data-rotate: (${(i=t.tr)==null?void 0:i.a}deg${(a=t.tr)!=null&&a.v?` ,${(l=t.tr)==null?void 0:l.v}`:""});`)}],["ht",()=>{t.ht===qe.LEFT?r+="text-align: left; ":t.ht===qe.RIGHT?r+="text-align: right; ":t.ht===qe.CENTER?r+="text-align: center; ":t.ht===qe.JUSTIFIED&&(r+="text-align: justify; ")}],["vt",()=>{t.vt===lr.BOTTOM?r+="vertical-align: bottom; ":t.vt===lr.TOP?r+="vertical-align: top; ":t.vt===lr.MIDDLE&&(r+="vertical-align: middle; ")}],["tb",()=>{t.tb===_r.CLIP?r+="white-space: nowrap; overflow-x: hidden; ":t.tb===_r.WRAP&&(r+="white-space: normal;")}],["pd",()=>{var i,a,l,u,c,d,h,f;const p=`${(i=t.pd)==null?void 0:i.b}pt`,g=`${(a=t.pd)==null?void 0:a.t}pt`,_=`${(l=t.pd)==null?void 0:l.l}pt`,I=`${(u=t.pd)==null?void 0:u.r}pt`;(c=t.pd)!=null&&c.b&&(r+=`padding-bottom: ${p}; `),(d=t.pd)!=null&&d.t&&(r+=`padding-top: ${g}; `),(h=t.pd)!=null&&h.l&&(r+=`padding-left: ${_}; `),(f=t.pd)!=null&&f.r&&(r+=`padding-right: ${I}; `)}]]),o=["bd","tr","tb"];for(const i in t)e&&o.includes(i)||(n=s.get(i))==null||n();return r}function Is(t){let e="";return t===Pt.NONE?e="none":t===Pt.THIN?e="0.5pt solid":t===Pt.HAIR?e="0.5pt double":t===Pt.DOTTED?e="0.5pt dotted":t===Pt.DASHED||t===Pt.DASH_DOT?e="0.5pt dashed":t===Pt.DASH_DOT_DOT?e="0.5pt dotted":t===Pt.DOUBLE?e="0.5pt double":t===Pt.MEDIUM?e="1pt solid":t===Pt.MEDIUM_DASHED||t===Pt.MEDIUM_DASH_DOT?e="1pt dashed":t===Pt.MEDIUM_DASH_DOT_DOT?e="1pt dotted":t===Pt.SLANT_DASH_DOT?e="0.5pt dashed":t===Pt.THICK&&(e="1.5pt solid"),e}function fw(t){let e=0;if(t=t.trim(),t==="none")e=Pt.NONE;else if(t==="0.5pt solid")e=Pt.THIN;else if(t==="0.5pt double")e=Pt.HAIR;else if(t==="0.5pt dotted")e=Pt.DOTTED;else if(t==="0.5pt dashed")e=Pt.DASHED;else if(t==="1pt solid")e=Pt.MEDIUM;else if(t==="1pt dashed")e=Pt.MEDIUM_DASHED;else if(t==="1pt dotted")e=Pt.MEDIUM_DASH_DOT_DOT;else if(t==="1.5pt solid")e=Pt.THICK;else if(!t.includes("none"))e=Pt.THIN;else return Pt.NONE;return e}function pw(t,e){let n=t.body;if(e){const{headers:r,footers:s}=t;r!=null&&r[e]?n=r[e].body:s!=null&&s[e]&&(n=s[e].body)}return n}function gw(t,e){const{startRow:n,endRow:r,startColumn:s,endColumn:o,rangeType:i}=t;if(n<0||s<0||r<0||o<0||!(Number.isNaN(n)&&Number.isNaN(r))&&i===vt.COLUMN||!(Number.isNaN(s)&&Number.isNaN(o))&&i===vt.ROW||i!==vt.ROW&&i!==vt.COLUMN&&(Number.isNaN(s)||Number.isNaN(n)||Number.isNaN(o)||Number.isNaN(r)))return!1;if(e){const a=e.getRowCount(),l=e.getColumnCount();if(r>=a||o>=l)return!1}return!0}function mw(t,e){return{startRow:t,endRow:t,startColumn:e,endColumn:e}}function Wu(t){return Fv(t)?{f:t,v:null,p:null}:Av(t)?{v:t,p:null,f:null}:(Sv(t),t)}function _w(t,e){const n=new De,{startRow:r,startColumn:s,endRow:o,endColumn:i}=e;if(et.isArray(t))for(let a=0;a<=o-r;a++)for(let l=0;l<=i-s;l++)n.setValue(a+r,l+s,Wu(t[a][l]));else new De(t).forValue((a,l,u)=>{n.setValue(a,l,Wu(u))});return n.getMatrix()}function nh(t,e){return Object.prototype.toString.call(t)===Object.prototype.toString.call(e)?Object.prototype.toString.call(t)==="[object Object]"||Object.prototype.toString.call(t)==="[object Array]"?Object.keys(t).length!==Object.keys(e).length?!1:Object.keys(t).every(n=>nh(t[n],e[n])):t===e:!1}function kv(t,e){const n=t.ts||{},r=e.ts||{};return t.sId!==e.sId?!1:nh(n,r)}function yw(t,e){return e.some(n=>t.indexOf(n)>-1)}var Si={exports:{}},Pv=Si.exports,Gu;function Uv(){return Gu||(Gu=1,function(t,e){(function(n,r){t.exports=r()})(Pv,function(){var n=1e3,r=6e4,s=36e5,o="millisecond",i="second",a="minute",l="hour",u="day",c="week",d="month",h="quarter",f="year",p="date",g="Invalid Date",_=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,I=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,U={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(x){var S=["th","st","nd","rd"],w=x%100;return"["+x+(S[(w-20)%10]||S[w]||S[0])+"]"}},L=function(x,S,w){var A=String(x);return!A||A.length>=S?x:""+Array(S+1-A.length).join(w)+x},B={s:L,z:function(x){var S=-x.utcOffset(),w=Math.abs(S),A=Math.floor(w/60),O=w%60;return(S<=0?"+":"-")+L(A,2,"0")+":"+L(O,2,"0")},m:function x(S,w){if(S.date()<w.date())return-x(w,S);var A=12*(w.year()-S.year())+(w.month()-S.month()),O=S.clone().add(A,d),M=w-O<0,P=S.clone().add(A+(M?-1:1),d);return+(-(A+(w-O)/(M?O-P:P-O))||0)},a:function(x){return x<0?Math.ceil(x)||0:Math.floor(x)},p:function(x){return{M:d,y:f,w:c,d:u,D:p,h:l,m:a,s:i,ms:o,Q:h}[x]||String(x||"").toLowerCase().replace(/s$/,"")},u:function(x){return x===void 0}},C="en",R={};R[C]=U;var y="$isDayjsObject",N=function(x){return x instanceof F||!(!x||!x[y])},G=function x(S,w,A){var O;if(!S)return C;if(typeof S=="string"){var M=S.toLowerCase();R[M]&&(O=M),w&&(R[M]=w,O=M);var P=S.split("-");if(!O&&P.length>1)return x(P[0])}else{var Q=S.name;R[Q]=S,O=Q}return!A&&O&&(C=O),O||!A&&C},z=function(x,S){if(N(x))return x.clone();var w=typeof S=="object"?S:{};return w.date=x,w.args=arguments,new F(w)},m=B;m.l=G,m.i=N,m.w=function(x,S){return z(x,{locale:S.$L,utc:S.$u,x:S.$x,$offset:S.$offset})};var F=function(){function x(w){this.$L=G(w.locale,null,!0),this.parse(w),this.$x=this.$x||w.x||{},this[y]=!0}var S=x.prototype;return S.parse=function(w){this.$d=function(A){var O=A.date,M=A.utc;if(O===null)return new Date(NaN);if(m.u(O))return new Date;if(O instanceof Date)return new Date(O);if(typeof O=="string"&&!/Z$/i.test(O)){var P=O.match(_);if(P){var Q=P[2]-1||0,W=(P[7]||"0").substring(0,3);return M?new Date(Date.UTC(P[1],Q,P[3]||1,P[4]||0,P[5]||0,P[6]||0,W)):new Date(P[1],Q,P[3]||1,P[4]||0,P[5]||0,P[6]||0,W)}}return new Date(O)}(w),this.init()},S.init=function(){var w=this.$d;this.$y=w.getFullYear(),this.$M=w.getMonth(),this.$D=w.getDate(),this.$W=w.getDay(),this.$H=w.getHours(),this.$m=w.getMinutes(),this.$s=w.getSeconds(),this.$ms=w.getMilliseconds()},S.$utils=function(){return m},S.isValid=function(){return this.$d.toString()!==g},S.isSame=function(w,A){var O=z(w);return this.startOf(A)<=O&&O<=this.endOf(A)},S.isAfter=function(w,A){return z(w)<this.startOf(A)},S.isBefore=function(w,A){return this.endOf(A)<z(w)},S.$g=function(w,A,O){return m.u(w)?this[A]:this.set(O,w)},S.unix=function(){return Math.floor(this.valueOf()/1e3)},S.valueOf=function(){return this.$d.getTime()},S.startOf=function(w,A){var O=this,M=!!m.u(A)||A,P=m.p(w),Q=function($,j){var q=m.w(O.$u?Date.UTC(O.$y,j,$):new Date(O.$y,j,$),O);return M?q:q.endOf(u)},W=function($,j){return m.w(O.toDate()[$].apply(O.toDate("s"),(M?[0,0,0,0]:[23,59,59,999]).slice(j)),O)},ot=this.$W,lt=this.$M,T=this.$D,D="set"+(this.$u?"UTC":"");switch(P){case f:return M?Q(1,0):Q(31,11);case d:return M?Q(1,lt):Q(0,lt+1);case c:var H=this.$locale().weekStart||0,Y=(ot<H?ot+7:ot)-H;return Q(M?T-Y:T+(6-Y),lt);case u:case p:return W(D+"Hours",0);case l:return W(D+"Minutes",1);case a:return W(D+"Seconds",2);case i:return W(D+"Milliseconds",3);default:return this.clone()}},S.endOf=function(w){return this.startOf(w,!1)},S.$set=function(w,A){var O,M=m.p(w),P="set"+(this.$u?"UTC":""),Q=(O={},O[u]=P+"Date",O[p]=P+"Date",O[d]=P+"Month",O[f]=P+"FullYear",O[l]=P+"Hours",O[a]=P+"Minutes",O[i]=P+"Seconds",O[o]=P+"Milliseconds",O)[M],W=M===u?this.$D+(A-this.$W):A;if(M===d||M===f){var ot=this.clone().set(p,1);ot.$d[Q](W),ot.init(),this.$d=ot.set(p,Math.min(this.$D,ot.daysInMonth())).$d}else Q&&this.$d[Q](W);return this.init(),this},S.set=function(w,A){return this.clone().$set(w,A)},S.get=function(w){return this[m.p(w)]()},S.add=function(w,A){var O,M=this;w=Number(w);var P=m.p(A),Q=function(lt){var T=z(M);return m.w(T.date(T.date()+Math.round(lt*w)),M)};if(P===d)return this.set(d,this.$M+w);if(P===f)return this.set(f,this.$y+w);if(P===u)return Q(1);if(P===c)return Q(7);var W=(O={},O[a]=r,O[l]=s,O[i]=n,O)[P]||1,ot=this.$d.getTime()+w*W;return m.w(ot,this)},S.subtract=function(w,A){return this.add(-1*w,A)},S.format=function(w){var A=this,O=this.$locale();if(!this.isValid())return O.invalidDate||g;var M=w||"YYYY-MM-DDTHH:mm:ssZ",P=m.z(this),Q=this.$H,W=this.$m,ot=this.$M,lt=O.weekdays,T=O.months,D=O.meridiem,H=function(j,q,nt,k){return j&&(j[q]||j(A,M))||nt[q].slice(0,k)},Y=function(j){return m.s(Q%12||12,j,"0")},$=D||function(j,q,nt){var k=j<12?"AM":"PM";return nt?k.toLowerCase():k};return M.replace(I,function(j,q){return q||function(nt){switch(nt){case"YY":return String(A.$y).slice(-2);case"YYYY":return m.s(A.$y,4,"0");case"M":return ot+1;case"MM":return m.s(ot+1,2,"0");case"MMM":return H(O.monthsShort,ot,T,3);case"MMMM":return H(T,ot);case"D":return A.$D;case"DD":return m.s(A.$D,2,"0");case"d":return String(A.$W);case"dd":return H(O.weekdaysMin,A.$W,lt,2);case"ddd":return H(O.weekdaysShort,A.$W,lt,3);case"dddd":return lt[A.$W];case"H":return String(Q);case"HH":return m.s(Q,2,"0");case"h":return Y(1);case"hh":return Y(2);case"a":return $(Q,W,!0);case"A":return $(Q,W,!1);case"m":return String(W);case"mm":return m.s(W,2,"0");case"s":return String(A.$s);case"ss":return m.s(A.$s,2,"0");case"SSS":return m.s(A.$ms,3,"0");case"Z":return P}return null}(j)||P.replace(":","")})},S.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},S.diff=function(w,A,O){var M,P=this,Q=m.p(A),W=z(w),ot=(W.utcOffset()-this.utcOffset())*r,lt=this-W,T=function(){return m.m(P,W)};switch(Q){case f:M=T()/12;break;case d:M=T();break;case h:M=T()/3;break;case c:M=(lt-ot)/6048e5;break;case u:M=(lt-ot)/864e5;break;case l:M=lt/s;break;case a:M=lt/r;break;case i:M=lt/n;break;default:M=lt}return O?M:m.a(M)},S.daysInMonth=function(){return this.endOf(d).$D},S.$locale=function(){return R[this.$L]},S.locale=function(w,A){if(!w)return this.$L;var O=this.clone(),M=G(w,A,!0);return M&&(O.$L=M),O},S.clone=function(){return m.w(this.$d,this)},S.toDate=function(){return new Date(this.valueOf())},S.toJSON=function(){return this.isValid()?this.toISOString():null},S.toISOString=function(){return this.$d.toISOString()},S.toString=function(){return this.$d.toUTCString()},x}(),v=F.prototype;return z.prototype=v,[["$ms",o],["$s",i],["$m",a],["$H",l],["$W",u],["$M",d],["$y",f],["$D",p]].forEach(function(x){v[x[1]]=function(S){return this.$g(S,x[0],x[1])}}),z.extend=function(x,S){return x.$i||(x(S,F,z),x.$i=!0),z},z.locale=G,z.isDayjs=N,z.unix=function(x){return z(1e3*x)},z.en=R[C],z.Ls=R,z.p={},z})}(Si)),Si.exports}var Bv=Uv();const Rn=Fe(Bv);var Ai={exports:{}},$v=Ai.exports,Yu;function Hv(){return Yu||(Yu=1,function(t,e){(function(n,r){t.exports=r()})($v,function(){return function(n,r){var s=r.prototype,o=s.format;s.format=function(i){var a=this,l=this.$locale();if(!this.isValid())return o.bind(this)(i);var u=this.$utils(),c=(i||"YYYY-MM-DDTHH:mm:ssZ").replace(/\[([^\]]+)]|Q|wo|ww|w|WW|W|zzz|z|gggg|GGGG|Do|X|x|k{1,2}|S/g,function(d){switch(d){case"Q":return Math.ceil((a.$M+1)/3);case"Do":return l.ordinal(a.$D);case"gggg":return a.weekYear();case"GGGG":return a.isoWeekYear();case"wo":return l.ordinal(a.week(),"W");case"w":case"ww":return u.s(a.week(),d==="w"?1:2,"0");case"W":case"WW":return u.s(a.isoWeek(),d==="W"?1:2,"0");case"k":case"kk":return u.s(String(a.$H===0?24:a.$H),d==="k"?1:2,"0");case"X":return Math.floor(a.$d.getTime()/1e3);case"x":return a.$d.getTime();case"z":return"["+a.offsetName()+"]";case"zzz":return"["+a.offsetName("long")+"]";default:return d}});return o.bind(this)(c)}}})}(Ai)),Ai.exports}var jv=Hv();const Vv=Fe(jv);var Oi={exports:{}},Wv=Oi.exports,zu;function Gv(){return zu||(zu=1,function(t,e){(function(n,r){t.exports=r()})(Wv,function(){var n={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},r=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|Q|YYYY|YY?|ww?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,s=/\d/,o=/\d\d/,i=/\d\d?/,a=/\d*[^-_:/,()\s\d]+/,l={},u=function(_){return(_=+_)+(_>68?1900:2e3)},c=function(_){return function(I){this[_]=+I}},d=[/[+-]\d\d:?(\d\d)?|Z/,function(_){(this.zone||(this.zone={})).offset=function(I){if(!I||I==="Z")return 0;var U=I.match(/([+-]|\d\d)/g),L=60*U[1]+(+U[2]||0);return L===0?0:U[0]==="+"?-L:L}(_)}],h=function(_){var I=l[_];return I&&(I.indexOf?I:I.s.concat(I.f))},f=function(_,I){var U,L=l.meridiem;if(L){for(var B=1;B<=24;B+=1)if(_.indexOf(L(B,0,I))>-1){U=B>12;break}}else U=_===(I?"pm":"PM");return U},p={A:[a,function(_){this.afternoon=f(_,!1)}],a:[a,function(_){this.afternoon=f(_,!0)}],Q:[s,function(_){this.month=3*(_-1)+1}],S:[s,function(_){this.milliseconds=100*+_}],SS:[o,function(_){this.milliseconds=10*+_}],SSS:[/\d{3}/,function(_){this.milliseconds=+_}],s:[i,c("seconds")],ss:[i,c("seconds")],m:[i,c("minutes")],mm:[i,c("minutes")],H:[i,c("hours")],h:[i,c("hours")],HH:[i,c("hours")],hh:[i,c("hours")],D:[i,c("day")],DD:[o,c("day")],Do:[a,function(_){var I=l.ordinal,U=_.match(/\d+/);if(this.day=U[0],I)for(var L=1;L<=31;L+=1)I(L).replace(/\[|\]/g,"")===_&&(this.day=L)}],w:[i,c("week")],ww:[o,c("week")],M:[i,c("month")],MM:[o,c("month")],MMM:[a,function(_){var I=h("months"),U=(h("monthsShort")||I.map(function(L){return L.slice(0,3)})).indexOf(_)+1;if(U<1)throw new Error;this.month=U%12||U}],MMMM:[a,function(_){var I=h("months").indexOf(_)+1;if(I<1)throw new Error;this.month=I%12||I}],Y:[/[+-]?\d+/,c("year")],YY:[o,function(_){this.year=u(_)}],YYYY:[/\d{4}/,c("year")],Z:d,ZZ:d};function g(_){var I,U;I=_,U=l&&l.formats;for(var L=(_=I.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(z,m,F){var v=F&&F.toUpperCase();return m||U[F]||n[F]||U[v].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(x,S,w){return S||w.slice(1)})})).match(r),B=L.length,C=0;C<B;C+=1){var R=L[C],y=p[R],N=y&&y[0],G=y&&y[1];L[C]=G?{regex:N,parser:G}:R.replace(/^\[|\]$/g,"")}return function(z){for(var m={},F=0,v=0;F<B;F+=1){var x=L[F];if(typeof x=="string")v+=x.length;else{var S=x.regex,w=x.parser,A=z.slice(v),O=S.exec(A)[0];w.call(m,O),z=z.replace(O,"")}}return function(M){var P=M.afternoon;if(P!==void 0){var Q=M.hours;P?Q<12&&(M.hours+=12):Q===12&&(M.hours=0),delete M.afternoon}}(m),m}}return function(_,I,U){U.p.customParseFormat=!0,_&&_.parseTwoDigitYear&&(u=_.parseTwoDigitYear);var L=I.prototype,B=L.parse;L.parse=function(C){var R=C.date,y=C.utc,N=C.args;this.$u=y;var G=N[1];if(typeof G=="string"){var z=N[2]===!0,m=N[3]===!0,F=z||m,v=N[2];m&&(v=N[2]),l=this.$locale(),!z&&v&&(l=U.Ls[v]),this.$d=function(A,O,M,P){try{if(["x","X"].indexOf(O)>-1)return new Date((O==="X"?1e3:1)*A);var Q=g(O)(A),W=Q.year,ot=Q.month,lt=Q.day,T=Q.hours,D=Q.minutes,H=Q.seconds,Y=Q.milliseconds,$=Q.zone,j=Q.week,q=new Date,nt=lt||(W||ot?1:q.getDate()),k=W||q.getFullYear(),K=0;W&&!ot||(K=ot>0?ot-1:q.getMonth());var Z,rt=T||0,pt=D||0,yt=H||0,X=Y||0;return $?new Date(Date.UTC(k,K,nt,rt,pt,yt,X+60*$.offset*1e3)):M?new Date(Date.UTC(k,K,nt,rt,pt,yt,X)):(Z=new Date(k,K,nt,rt,pt,yt,X),j&&(Z=P(Z).week(j).toDate()),Z)}catch{return new Date("")}}(R,G,y,U),this.init(),v&&v!==!0&&(this.$L=this.locale(v).$L),F&&R!=this.format(G)&&(this.$d=new Date("")),l={}}else if(G instanceof Array)for(var x=G.length,S=1;S<=x;S+=1){N[1]=G[S-1];var w=U.apply(this,N);if(w.isValid()){this.$d=w.$d,this.$L=w.$L,this.init();break}S===x&&(this.$d=new Date(""))}else B.call(this,C)}}})}(Oi)),Oi.exports}var Yv=Gv();const zv=Fe(Yv);var Di={exports:{}},Kv=Di.exports,Ku;function Xv(){return Ku||(Ku=1,function(t,e){(function(n,r){t.exports=r()})(Kv,function(){return function(n,r,s){var o=r.prototype,i=function(d){return d&&(d.indexOf?d:d.s)},a=function(d,h,f,p,g){var _=d.name?d:d.$locale(),I=i(_[h]),U=i(_[f]),L=I||U.map(function(C){return C.slice(0,p)});if(!g)return L;var B=_.weekStart;return L.map(function(C,R){return L[(R+(B||0))%7]})},l=function(){return s.Ls[s.locale()]},u=function(d,h){return d.formats[h]||function(f){return f.replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(p,g,_){return g||_.slice(1)})}(d.formats[h.toUpperCase()])},c=function(){var d=this;return{months:function(h){return h?h.format("MMMM"):a(d,"months")},monthsShort:function(h){return h?h.format("MMM"):a(d,"monthsShort","months",3)},firstDayOfWeek:function(){return d.$locale().weekStart||0},weekdays:function(h){return h?h.format("dddd"):a(d,"weekdays")},weekdaysMin:function(h){return h?h.format("dd"):a(d,"weekdaysMin","weekdays",2)},weekdaysShort:function(h){return h?h.format("ddd"):a(d,"weekdaysShort","weekdays",3)},longDateFormat:function(h){return u(d.$locale(),h)},meridiem:this.$locale().meridiem,ordinal:this.$locale().ordinal}};o.localeData=function(){return c.bind(this)()},s.localeData=function(){var d=l();return{firstDayOfWeek:function(){return d.weekStart||0},weekdays:function(){return s.weekdays()},weekdaysShort:function(){return s.weekdaysShort()},weekdaysMin:function(){return s.weekdaysMin()},months:function(){return s.months()},monthsShort:function(){return s.monthsShort()},longDateFormat:function(h){return u(d,h)},meridiem:d.meridiem,ordinal:d.ordinal}},s.months=function(){return a(l(),"months")},s.monthsShort=function(){return a(l(),"monthsShort","months",3)},s.weekdays=function(d){return a(l(),"weekdays",null,null,d)},s.weekdaysShort=function(d){return a(l(),"weekdaysShort","weekdays",3,d)},s.weekdaysMin=function(d){return a(l(),"weekdaysMin","weekdays",2,d)}}})}(Di)),Di.exports}var Jv=Xv();const Zv=Fe(Jv);var xi={exports:{}},Qv=xi.exports,Xu;function qv(){return Xu||(Xu=1,function(t,e){(function(n,r){t.exports=r()})(Qv,function(){var n={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};return function(r,s,o){var i=s.prototype,a=i.format;o.en.formats=n,i.format=function(l){l===void 0&&(l="YYYY-MM-DDTHH:mm:ssZ");var u=this.$locale().formats,c=function(d,h){return d.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(f,p,g){var _=g&&g.toUpperCase();return p||h[g]||n[g]||h[_].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(I,U,L){return U||L.slice(1)})})}(l,u===void 0?{}:u);return a.call(this,c)}}})}(xi)),xi.exports}var tE=qv();const eE=Fe(tE);var Ni={exports:{}},nE=Ni.exports,Ju;function rE(){return Ju||(Ju=1,function(t,e){(function(n,r){t.exports=r()})(nE,function(){var n="minute",r=/[+-]\d\d(?::?\d\d)?/g,s=/([+-]|\d\d)/g;return function(o,i,a){var l=i.prototype;a.utc=function(g){var _={date:g,utc:!0,args:arguments};return new i(_)},l.utc=function(g){var _=a(this.toDate(),{locale:this.$L,utc:!0});return g?_.add(this.utcOffset(),n):_},l.local=function(){return a(this.toDate(),{locale:this.$L,utc:!1})};var u=l.parse;l.parse=function(g){g.utc&&(this.$u=!0),this.$utils().u(g.$offset)||(this.$offset=g.$offset),u.call(this,g)};var c=l.init;l.init=function(){if(this.$u){var g=this.$d;this.$y=g.getUTCFullYear(),this.$M=g.getUTCMonth(),this.$D=g.getUTCDate(),this.$W=g.getUTCDay(),this.$H=g.getUTCHours(),this.$m=g.getUTCMinutes(),this.$s=g.getUTCSeconds(),this.$ms=g.getUTCMilliseconds()}else c.call(this)};var d=l.utcOffset;l.utcOffset=function(g,_){var I=this.$utils().u;if(I(g))return this.$u?0:I(this.$offset)?d.call(this):this.$offset;if(typeof g=="string"&&(g=function(C){C===void 0&&(C="");var R=C.match(r);if(!R)return null;var y=(""+R[0]).match(s)||["-",0,0],N=y[0],G=60*+y[1]+ +y[2];return G===0?0:N==="+"?G:-G}(g),g===null))return this;var U=Math.abs(g)<=16?60*g:g;if(U===0)return this.utc(_);var L=this.clone();if(_)return L.$offset=U,L.$u=!1,L;var B=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();return(L=this.local().add(U+B,n)).$offset=U,L.$x.$localOffset=B,L};var h=l.format;l.format=function(g){var _=g||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return h.call(this,_)},l.valueOf=function(){var g=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*g},l.isUTC=function(){return!!this.$u},l.toISOString=function(){return this.toDate().toISOString()},l.toString=function(){return this.toDate().toUTCString()};var f=l.toDate;l.toDate=function(g){return g==="s"&&this.$offset?a(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():f.call(this)};var p=l.diff;l.diff=function(g,_,I){if(g&&this.$u===g.$u)return p.call(this,g,_,I);var U=this.local(),L=a(g).local();return p.call(U,L,_,I)}}})}(Ni)),Ni.exports}var sE=rE();const oE=Fe(sE);var Mi={exports:{}},iE=Mi.exports,Zu;function aE(){return Zu||(Zu=1,function(t,e){(function(n,r){t.exports=r()})(iE,function(){return function(n,r){r.prototype.weekday=function(s){var o=this.$locale().weekStart||0,i=this.$W,a=(i<o?i+7:i)-o;return this.$utils().u(s)?a:this.subtract(a,"day").add(s,"day")}}})}(Mi)),Mi.exports}var lE=aE();const uE=Fe(lE);var Li={exports:{}},cE=Li.exports,Qu;function dE(){return Qu||(Qu=1,function(t,e){(function(n,r){t.exports=r()})(cE,function(){var n="week",r="year";return function(s,o,i){var a=o.prototype;a.week=function(l){if(l===void 0&&(l=null),l!==null)return this.add(7*(l-this.week()),"day");var u=this.$locale().yearStart||1;if(this.month()===11&&this.date()>25){var c=i(this).startOf(r).add(1,r).date(u),d=i(this).endOf(n);if(c.isBefore(d))return 1}var h=i(this).startOf(r).date(u).startOf(n).subtract(1,"millisecond"),f=this.diff(h,n,!0);return f<0?i(this).startOf("week").week():Math.ceil(f)},a.weeks=function(l){return l===void 0&&(l=null),this.week(l)}}})}(Li)),Li.exports}var hE=dE();const fE=Fe(hE);var Fi={exports:{}},pE=Fi.exports,qu;function gE(){return qu||(qu=1,function(t,e){(function(n,r){t.exports=r()})(pE,function(){return function(n,r){r.prototype.weekYear=function(){var s=this.month(),o=this.week(),i=this.year();return o===1&&s===11?i+1:s===0&&o>=52?i-1:i}}})}(Fi)),Fi.exports}var mE=gE();const _E=Fe(mE);Rn.extend(zv);Rn.extend(Vv);Rn.extend(uE);Rn.extend(Zv);Rn.extend(fE);Rn.extend(_E);Rn.extend(oE);Rn.extend(eE);function Ua(t,e,n,r){if(t>e)throw new Error("a1 should be less than a2");if(n>r)throw new Error("b1 should be less than b2");if(e<n||r<t)return[t,e];if(n<=t&&r>=e)return[];const s=r-n+1;return t<n&&e>r?[t,e-s]:n<=t&&r<e?[r+1-s,e-s]:n>t&&r>=e?[t,n-1]:[t,e]}function vw(t){if(t==null)return!1;const e=t.bullet;return(e==null?void 0:e.listId)!=null}function Ew(t){if(t==null)return!1;const e=t.paragraphStyle;return yE(e)}function yE(t){var e;return!(t==null||(t.indentStart==null||t.indentStart.v===0)&&t.hanging==null||((e=t.hanging)==null?void 0:e.v)===0)}function vE(t,e,n){return t.slice(0,e)+n+t.slice(e)}function EE(t,e,n){return e>n?t:t.slice(0,e)+t.slice(n)}function bw(t){if(t==null||typeof t=="boolean")return!1;if(typeof t=="number")return!isNaN(t);if(typeof t=="string"){const e=t.trim();return e===""?!1:!isNaN(Number(e))}return!1}function Cw(t){let e=0;for(let n=0;n<t.length;n++)e=t.charCodeAt(n)+(e<<6)+(e<<16)-e;return e>>>0}function Rw(...t){let e;return t.length===1&&Array.isArray(t[0])?e=t[0]:e=t,Da({},...e)}const Ft=Symbol("newer"),se=Symbol("older");class bE{constructor(e){b(this,"entry"),this.entry=e}[Symbol.iterator](){return this}next(){const e=this.entry;return e?(this.entry=e[Ft],{done:!1,value:e.key}):{done:!0,value:void 0}}}class CE{constructor(e){b(this,"entry"),this.entry=e}[Symbol.iterator](){return this}next(){const e=this.entry;return e?(this.entry=e[Ft],{done:!1,value:e.value}):{done:!0,value:void 0}}}class RE{constructor(e){b(this,"entry"),this.entry=e}[Symbol.iterator](){return this}next(){const e=this.entry;return e?(this.entry=e[Ft],{done:!1,value:[e.key,e.value]}):{done:!0,value:void 0}}}var rh,sh;sh=Ft,rh=se;class tc{constructor(e,n){b(this,"key"),b(this,"value"),b(this,sh),b(this,rh),this.key=e,this.value=n,this[Ft]=void 0,this[se]=void 0}toJSON(){return{key:this.key,value:this.value}}}class eo{constructor(...e){if(b(this,"_keymap"),b(this,"size",0),b(this,"limit"),b(this,"oldest"),b(this,"newest"),b(this,"_onShiftListeners",[]),Ss.hasLength(e,1)){if(Ss.isNumber(e[0])){const n=e[0];this._initialize(n,void 0);return}if(Ss.isIterable(e[0])){const n=e[0];this._initialize(0,n);return}return}if(Ss.hasLength(e,2)){const n=e[0],r=e[1];this._initialize(n,r)}}onShift(e){if(this._onShiftListeners.indexOf(e)===-1)return this._onShiftListeners.push(e),Zt(()=>go(this._onShiftListeners,e));throw new Error("[LRUMap]: the listener has been registered!")}_initialize(e,n){this.oldest=void 0,this.newest=void 0,this.size=0,this.limit=e,this._keymap=new Map,n&&(this.assign(n),e<1&&(this.limit=this.size))}_markEntryAsUsed(e){e!==this.newest&&(e[Ft]&&(e===this.oldest&&(this.oldest=e[Ft]),e[Ft][se]=e[se]),e[se]&&(e[se][Ft]=e[Ft]),e[Ft]=void 0,e[se]=this.newest,this.newest&&(this.newest[Ft]=e),this.newest=e)}assign(e){let n,r=this.limit||Number.MAX_VALUE;this._keymap.clear();const s=e[Symbol.iterator]();for(let o=s.next();!o.done;o=s.next()){const i=new tc(o.value[0],o.value[1]);if(this._keymap.set(i.key,i),n?(n[Ft]=i,i[se]=n):this.oldest=i,n=i,r--===0)throw new Error("overflow")}this.newest=n,this.size=this._keymap.size}set(e,n){let r=this._keymap.get(e);return r?(r.value=n,this._markEntryAsUsed(r),this):(this._keymap.set(e,r=new tc(e,n)),this.newest?(this.newest[Ft]=r,r[se]=this.newest):this.oldest=r,this.newest=r,++this.size,this.size>this.limit&&this.shift(),this)}shift(){const e=this.oldest;if(e)return this.oldest&&this.oldest[Ft]?(this.oldest=this.oldest[Ft],this.oldest[se]=void 0):(this.oldest=void 0,this.newest=void 0),e[Ft]=e[se]=void 0,this._keymap.delete(e.key),--this.size,this._onShiftListeners.forEach(n=>n(e)),[e.key,e.value]}get(e){const n=this._keymap.get(e);if(n)return this._markEntryAsUsed(n),n.value}has(e){return this._keymap.has(e)}find(e){const n=this._keymap.get(e);return n?n.value:void 0}delete(e){const n=this._keymap.get(e);if(n)return this._keymap.delete(n.key),n[Ft]&&n[se]?(n[se][Ft]=n[Ft],n[Ft][se]=n[se]):n[Ft]?(n[Ft][se]=void 0,this.oldest=n[Ft]):n[se]?(n[se][Ft]=void 0,this.newest=n[se]):this.oldest=this.newest=void 0,this.size--,n.value}clear(){this.oldest=void 0,this.newest=void 0,this.size=0,this._keymap.clear()}keys(){return new bE(this.oldest)}values(){return new CE(this.oldest)}entries(){return this[Symbol.iterator]()}[Symbol.iterator](){return new RE(this.oldest)}forEach(e,n){typeof n!="object"&&(n=this);let r=this.oldest;for(;r;)e.call(n,r.value,r.key,this),r=r[Ft]}toJSON(){const e=new Array(this.size);let n=0,r=this.oldest;for(;r;)e[n++]={key:r.key,value:r.value},r=r[Ft];return e}toString(){let e="",n=this.oldest;for(;n;)e+=`${String(n.key)}:${n.value}`,n=n[Ft],n&&(e+=" < ");return e}}class Ss{static hasLength(e,n){return e.length===n}static getValueType(e){return Object.prototype.toString.apply(e)}static isObject(e){return this.getValueType(e)==="[object Object]"}static isIterable(e){return e[Symbol.iterator]!=null}static isNumber(e){return this.getValueType(e)==="[object Number]"}}const Wr=2,Gr=2**2,Ys=2**3,Yr=2**4,zr=2**5,Kr=2**6,ki=2**7,Pi=2**8,Ui=2**9,TE=0,wE=2958466,IE=-694324,SE=35830291,AE=-1,ec=1,cr=6,Ba="general",$a="hash",dr="zero",Ha="qmark",ja="slash",os="group",no="scale",Va="comma",Wa="break",Ro="text",Ga="plus",Ya="minus",ro="point",za="space",Ka="percent",To="digit",Xa="calendar",is="error",Ja="datetime",Za="duration",Qa="condition",qa="dbnum",tl="natnum",el="locale",nl="color",oh="modifier",rl="ampm",sl="escaped",ol="string",il="skip",al="exp",ll="fill",ul="paren",wo="char",OE=["#000","#FFF","#F00","#0F0","#00F","#FF0","#F0F","#0FF","#000","#FFF","#F00","#0F0","#00F","#FF0","#F0F","#0FF","#800","#080","#008","#880","#808","#088","#CCC","#888","#99F","#936","#FFC","#CFF","#606","#F88","#06C","#CCF","#008","#F0F","#FF0","#0FF","#808","#800","#088","#00F","#0CF","#CFF","#CFC","#FF9","#9CF","#F9C","#C9F","#FC9","#36F","#3CC","#9C0","#FC0"],Bi=["","$","","","","","","","","","","","","","","","","","","","","","","","","",""],$i=new RegExp("["+Bi.join("")+"]"),Jo=Object.freeze({1078:"af",1052:"sq",1118:"am",5121:"ar_DZ",15361:"ar_BH",3073:"ar_EG",2049:"ar_IQ",11265:"ar_JO",13313:"ar_KW",12289:"ar_LB",4097:"ar_LY",6145:"ar_MA",8193:"ar_OM",16385:"ar_QA",1025:"ar_SA",10241:"ar_SY",7169:"ar_TN",14337:"ar_AE",9217:"ar_YE",1067:"hy",1101:"as",2092:"az_AZ",1068:"az_AZ",1069:"eu",1059:"be",2117:"bn",1093:"bn_IN",5146:"bs",1026:"bg",1109:"my",1027:"ca",2052:"zh_CN",3076:"zh_HK",5124:"zh_MO",4100:"zh_SG",1028:"zh_TW",1050:"hr",1029:"cs",1030:"da",1125:"dv",2067:"nl_BE",1043:"nl_NL",1126:"bin",3081:"en_AU",10249:"en_BZ",4105:"en_CA",9225:"en_CB",2057:"en_GB",16393:"en_IN",6153:"en_IE",8201:"en_JM",5129:"en_NZ",13321:"en_PH",7177:"en_ZA",11273:"en_TT",1033:"en_US",12297:"en_ZW",1061:"et",1071:"mk",1080:"fo",1065:"fa",1124:"fil",1035:"fi",2060:"fr_BE",11276:"fr_CM",3084:"fr_CA",9228:"fr_CG",12300:"fr_CI",1036:"fr_FR",5132:"fr_LU",13324:"fr_ML",6156:"fr_MC",14348:"fr_MA",10252:"fr_SN",4108:"fr_CH",7180:"fr",1122:"fy_NL",2108:"gd_IE",1084:"gd",1110:"gl",1079:"ka",3079:"de_AT",1031:"de_DE",5127:"de_LI",4103:"de_LU",2055:"de_CH",1032:"el",1140:"gn",1095:"gu",1279:"en",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig_NG",1057:"id",1040:"it_IT",2064:"it_CH",1041:"ja",1099:"kn",1120:"ks",1087:"kk",1107:"km",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1142:"la",1062:"lv",1063:"lt",2110:"ms_BN",1086:"ms_MY",1100:"ml",1082:"mt",1112:"mni",1153:"mi",1102:"mr",1104:"mn",2128:"mn",1121:"ne",1044:"no_NO",2068:"no_NO",1096:"or",1045:"pl",1046:"pt_BR",2070:"pt_PT",1094:"pa",1047:"rm",2072:"ro_MO",1048:"ro_RO",1049:"ru",2073:"ru_MO",1083:"se",1103:"sa",3098:"sr_SP",2074:"sr_SP",1072:"st",1074:"tn",1113:"sd",1115:"si",1051:"sk",1060:"sl",1143:"so",1070:"sb",11274:"es_AR",16394:"es_BO",13322:"es_CL",9226:"es_CO",5130:"es_CR",7178:"es_DO",12298:"es_EC",17418:"es_SV",4106:"es_GT",18442:"es_HN",2058:"es_MX",19466:"es_NI",6154:"es_PA",15370:"es_PY",10250:"es_PE",20490:"es_PR",1034:"es_ES",14346:"es_UY",8202:"es_VE",1089:"sw",2077:"sv_FI",1053:"sv_SE",1114:"syc",1064:"tg",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1073:"ts",1055:"tr",1090:"tk",1058:"uk",1056:"ur",2115:"uz_UZ",1091:"uz_UZ",1075:"ve",1066:"vi",1106:"cy",1076:"xh",1085:"yi",1077:"zu"}),ih=/^([a-z\d]+)(?:[_-]([a-z\d]+))?(?:\.([a-z\d]+))?(?:@([a-z\d]+))?$/i,sr={},E=(t,e="")=>t.replace(/~/g,e).split(";"),Bt=(t,e=0,n=0)=>(t.mmm||(t.mmm=e<1?t.mmmm.concat():t.mmmm.map(r=>{const s=r.slice(0,e%10);return s+(e<10||r===s?"":".")})),t.ddd||(t.ddd=n<1?t.dddd.concat():t.dddd.map(r=>{const s=r.slice(0,n%10);return s+(n<10||r===s?"":".")})),!t.mmm6&&t.mmmm6&&(t.mmm6=t.mmmm6),t),DE={group:"",decimal:".",positive:"+",negative:"-",percent:"%",exponent:"E",nan:"NaN",infinity:"",ampm:E("AM;PM"),mmmm6:E("Muharram;Safar;Rabi I;Rabi II;Jumada I;Jumada II;Rajab;Shaban;Ramadan;Shawwal;Dhul-Qidah;Dhul-Hijjah"),mmm6:E("Muh.;Saf.;Rab. I;Rab. II;Jum. I;Jum. II;Raj.;Sha.;Ram.;Shaw.;Dhul-Q.;Dhul-H."),mmmm:E("January;February;March;April;May;June;July;August;September;October;November;December"),mmm:E("Jan;Feb;Mar;Apr;May;Jun;Jul;Aug;Sep;Oct;Nov;Dec"),dddd:E("Sunday;Monday;Tuesday;Wednesday;Thursday;Friday;Saturday"),ddd:E("Sun;Mon;Tue;Wed;Thu;Fri;Sat"),bool:E("TRUE;FALSE"),preferMDY:!1};function cl(t){const e=ih.exec(t);if(!e)throw new SyntaxError(`Malformed locale: ${t}`);return{lang:e[1]+(e[2]?"_"+e[2]:""),language:e[1],territory:e[2]||""}}function dl(t){if(typeof t=="number")return Jo[t&65535]||null;const e=parseInt(t,16);return isFinite(e)&&Jo[e&65535]?Jo[e&65535]||null:ih.test(t)?t:null}function Dr(t){const e=dl(t);let n=null;if(e){const r=cl(e);n=sr[r.lang]||sr[r.language]||null}return n}function Hi(t){return Object.assign({},DE,t)}function st(t,e){const n=typeof e=="object"?e:cl(e);return sr[n.lang]=Hi(t),n.language!==n.lang&&!sr[n.language]&&(sr[n.language]=Hi(t)),sr[n.lang]}const bn=Hi({group:",",preferMDY:!0});bn.isDefault=!0;st({group:",",ampm:E(";"),mmmm:E(";;;;;;;;;;;"),mmm:E("1;2;3;4;5;6;7;8;9;10;11;12"),dddd:E("~;~;~;~;~;~;~",""),ddd:E(";;;;;;")},"zh_CN");const hl={group:",",ampm:E(";"),mmmm:E("1;2;3;4;5;6;7;8;9;10;11;12"),mmm:E("1;2;3;4;5;6;7;8;9;10;11;12"),dddd:E("~;~;~;~;~;~;~",""),ddd:E(";;;;;;")};st({...hl,nan:"",dddd:E("~;~;~;~;~;~;~","")},"zh_TW");st({...hl,dddd:E("~;~;~;~;~;~;~","")},"zh_HK");st({...hl,ampm:E(";"),dddd:E("~;~;~;~;~;~;~",""),ddd:E(";;;;;;")},"ja");st({group:",",ampm:E(";"),mmmm:E("1;2;3;4;5;6;7;8;9;10;11;12"),mmm:E("1;2;3;4;5;6;7;8;9;10;11;12"),dddd:E(";;;;;;"),ddd:E(";;;;;;")},"ko");st({group:",",ampm:E(";"),mmmm:E("~;;~;;~;;~;~;;~;;~",""),mmm:E("..;..;..;..;..;..;..;..;..;..;..;.."),dddd:E(";;;;;;"),ddd:E(".;.;.;.;.;.;.")},"th");st(Bt({decimal:",",ampm:E("dop.;odp."),mmmm:E("ledna;nora;bezna;dubna;kvtna;ervna;ervence;srpna;z;jna;listopadu;prosince"),mmm:E("I;II;III;IV;V;VI;VII;VIII;IX;X;XI;XII"),dddd:E("nedle;pondl;ter;steda;tvrtek;ptek;sobota"),bool:E("PRAVDA;NEPRAVDA")},-1,2),"cs");st(Bt({group:".",decimal:",",mmmm:E("januar;februar;marts;april;maj;juni;juli;august;september;oktober;november;december"),dddd:E("sn~;man~;tirs~;ons~;tors~;fre~;lr~","dag"),bool:E("SAND;FALSK")},13,13),"da");st(Bt({group:".",decimal:",",ampm:E("a.m.;p.m."),mmmm:E("januari;februari;maart;april;mei;juni;juli;augustus;september;oktober;november;december"),mmm:E("jan.;feb.;mrt.;apr.;mei;jun.;jul.;aug.;sep.;okt.;nov.;dec."),dddd:E("zondag;maandag;dinsdag;woensdag;donderdag;vrijdag;zaterdag"),bool:E("WAAR;ONWAAR")},-1,2),"nl");st({group:",",preferMDY:!0},"en");st({group:",",preferMDY:!0},"en_US");st({group:","},"en_AU");st({group:","},"en_CA");st({group:","},"en_GB");st({group:",",mmm:E("Jan;Feb;Mar;Apr;May;Jun;Jul;Aug;Sept;Oct;Nov;Dec")},"en_IE");st(Bt({decimal:",",nan:"epluku",ampm:E("ap.;ip."),mmmm:E("tammi~;helmi~;maalis~;huhti~;touko~;kes~;hein~;elo~;syys~;loka~;marras~;joulu~","kuuta"),mmm:E("tammik.;helmik.;maalisk.;huhtik.;toukok.;kesk.;heink.;elok.;syysk.;lokak.;marrask.;jouluk."),dddd:E("sunnun~;maanan~;tiis~;keskiviikkona;tors~;perjan~;lauan~","taina"),bool:E("TOSI;EPTOSI")},-1,2),"fi");const fl=Bt({group:"",decimal:",",mmmm:E("janvier;fvrier;mars;avril;mai;juin;juillet;aot;septembre;octobre;novembre;dcembre"),mmm:E("janv.;fvr.;mars;avr.;mai;juin;juil.;aot;sept.;oct.;nov.;dc."),dddd:E("~manche;lun~;mar~;mercre~;jeu~;vendre~;same~","di"),bool:E("VRAI;FAUX")},-1,13);st({...fl},"fr");st({...fl,mmm:E("janv.;fvr.;mars;avr.;mai;juin;juill.;aot;sept.;oct.;nov.;dc.")},"fr_CA");st({group:"'",decimal:".",...fl},"fr_CH");const ah=Bt({mmmm:E("Januar;Februar;Mrz;April;Mai;Juni;Juli;August;September;Oktober;November;Dezember"),mmm:E("Jan.;Feb.;Mrz;Apr.;Mai;Juni;Juli;Aug.;Sept.;Okt.;Nov.;Dez."),dddd:E("Sonn~;Mon~;Diens~;Mittwoch;Donners~;Frei~;Sams~","tag"),bool:E("WAHR;FALSCH")},-1,12);st({group:".",decimal:",",...ah},"de");st({group:"'",decimal:".",...ah},"de_CH");st(Bt({group:".",decimal:",",ampm:E("..;.."),mmmm:E("~;~;~;~;;~;~;;~;~;~;~",""),mmm:E(";;;;;;;;;;;"),dddd:E(";;;;;;")},-1,3),"el");st({decimal:",",ampm:E("de.;du."),mmmm:E("janur;februr;mrcius;prilis;mjus;jnius;jlius;augusztus;szeptember;oktber;november;december"),mmm:E("jan.;febr.;mrc.;pr.;mj.;jn.;jl.;aug.;szept.;okt.;nov.;dec."),dddd:E("vasrnap;htf;kedd;szerda;cstrtk;pntek;szombat"),ddd:E("V;H;K;Sze;Cs;P;Szo"),bool:E("IGAZ;HAMIS")},"hu");st(Bt({group:".",decimal:",",ampm:E("f.h.;e.h."),mmmm:E("janar;febrar;mars;aprl;ma;jn;jl;gst;september;oktber;nvember;desember"),dddd:E("sunnu~;mnu~;riju~;miviku~;fimmtu~;fstu~;laugar~","dagur")},13,13),"is");st(Bt({group:".",decimal:",",mmmm:E("Januari;Februari;Maret;April;Mei;Juni;Juli;Agustus;September;Oktober;November;Desember"),dddd:E("Minggu;Senin;Selasa;Rabu;Kamis;Jumat;Sabtu")},3,3),"id");const lh=Bt({mmmm:E("gennaio;febbraio;marzo;aprile;maggio;giugno;luglio;agosto;settembre;ottobre;novembre;dicembre"),dddd:E("domenica;luned;marted;mercoled;gioved;venerd;sabato"),bool:E("VERO;FALSO")},3,3);st({group:".",decimal:",",...lh},"it");st({group:"'",decimal:".",...lh},"it_CH");const uh={decimal:",",ampm:E("a.m.;p.m."),mmmm:E("januar;februar;mars;april;mai;juni;juli;august;september;oktober;november;desember"),mmm:E("jan.;feb.;mar.;apr.;mai;jun.;jul.;aug.;sep.;okt.;nov.;des."),dddd:E("sn~;man~;tirs~;ons~;tors~;fre~;lr~","dag"),bool:E("SANN;USANN")};st(Bt({...uh},-1,13),"nb");st(Bt({...uh},-1,13),"no");st(Bt({decimal:",",mmmm:E("stycznia;lutego;marca;kwietnia;maja;czerwca;lipca;sierpnia;wrzenia;padziernika;listopada;grudnia"),dddd:E("niedziela;poniedziaek;wtorek;roda;czwartek;pitek;sobota"),ddd:E("niedz.;pon.;wt.;r.;czw.;pt.;sob."),bool:E("PRAWDA;FASZ")},3,-1),"pl");const ch={group:".",decimal:",",mmmm:E("janeiro;fevereiro;maro;abril;maio;junho;julho;agosto;setembro;outubro;novembro;dezembro"),dddd:E("domingo;segunda-feira;tera-feira;quarta-feira;quinta-feira;sexta-feira;sbado"),bool:E("VERDADEIRO;FALSO")};st(Bt(ch,13,13),"pt");st(Bt(ch,13,13),"pt_BR");st({decimal:",",nan:"",mmmm:E(";;;;;;;;;;;"),mmm:E(".;.;.;.;;.;.;.;.;.;.;."),dddd:E(";;;;;;"),ddd:E(";;;;;;"),mmmm6:E(";;-;-;;--;--;--;--;;;"),mmm6:E(".;.;-.;-.;.;. I;. II;. I;. II;.;.;."),bool:E(";")},"ru");st(Bt({decimal:",",mmmm:E("janura;februra;marca;aprla;mja;jna;jla;augusta;septembra;oktbra;novembra;decembra"),dddd:E("nedea;pondelok;utorok;streda;tvrtok;piatok;sobota")},3,2),"sk");const rn={group:".",decimal:",",ampm:E("a.m.;p.m."),mmmm:E("enero;febrero;marzo;abril;mayo;junio;julio;agosto;septiem~;octu~;noviem~;diciem~","bre"),mmm:E("ene;feb;mar;abr;may;jun;jul;ago;sept;oct;nov;dic"),dddd:E("domingo;lunes;martes;mircoles;jueves;viernes;sbado"),ddd:E("dom;lun;mar;mi;jue;vie;sb"),bool:E("VERDADERO;FALSO")},xE=E("ene;feb;mar;abr;may;jun;jul;ago;sep;oct;nov;dic"),pl=E("ene.;feb.;mar.;abr.;may.;jun.;jul.;ago.;sept.;oct.;nov.;dic.");st({...rn},"es");st({...rn},"es_AR");st({...rn},"es_BO");st({...rn},"es_CL");st({...rn},"es_CO");st({...rn},"es_EC");st({...rn,mmm:xE,ampm:E("a.m.;p.m.")},"es_MX");st({...rn,mmm:pl},"es_PY");st({...rn,mmm:pl},"es_UY");st({...rn,mmm:pl,mmmm:E("enero;febrero;marzo;abril;mayo;junio;julio;agosto;setiembre;octubre;noviembre;diciembre")},"es_VE");st({decimal:",",ampm:E("fm;em"),mmmm:E("januari;februari;mars;april;maj;juni;juli;augusti;september;oktober;november;december"),mmm:E("jan.;feb.;mars;apr.;maj;juni;juli;aug.;sep.;okt.;nov.;dec."),dddd:E("sn~;mn~;tis~;ons~;tors~;fre~;lr~","dag"),ddd:E("sn;mn;tis;ons;tors;fre;lr")},"sv");st(Bt({group:".",decimal:",",ampm:E(";S"),mmmm:E("Ocak;ubat;Mart;Nisan;Mays;Haziran;Temmuz;Austos;Eyll;Ekim;Kasm;Aralk"),mmm:E("Oca;ub;Mar;Nis;May;Haz;Tem;Au;Eyl;Eki;Kas;Ara"),dddd:E("Pazar;Pazartesi;Sal;aramba;Perembe;Cuma;Cumartesi"),ddd:E("Paz;Pzt;Sal;ar;Per;Cum;Cmt"),bool:E("DORU;YANLI")},3,-1),"tr");st({group:",",ampm:E("yb;yh"),mmmm:E("Ionawr;Chwefror;Mawrth;Ebrill;Mai;Mehefin;Gorffennaf;Awst;Medi;Hydref;Tachwedd;Rhagfyr"),mmm:E("Ion;Chwef;Maw;Ebr;Mai;Meh;Gorff;Awst;Medi;Hyd;Tach;Rhag"),dddd:E("Dydd Sul;Dydd Llun;Dydd Mawrth;Dydd Mercher;Dydd Iau;Dydd Gwener;Dydd Sadwrn"),ddd:E("Sul;Llun;Maw;Mer;Iau;Gwen;Sad")},"cy");st({group:".",decimal:",",mmmm:E("yanvar;fevral;mart;aprel;may;iyun;iyul;avqust;sentyabr;oktyabr;noyabr;dekabr"),mmm:E("yan;fev;mar;apr;may;iyn;iyl;avq;sen;okt;noy;dek"),dddd:E("bazar;bazar ertsi;rnb axam;rnb;cm axam;cm;nb"),ddd:E("B.;B.e.;.a.;.;C.a.;C.;.")},"az");st(Bt({decimal:",",mmmm:E(";;;;;;;;;;;"),dddd:E(";;;;;;"),ddd:E(";;;;;;")},3,-1),"be");st({decimal:",",ampm:E("..;.."),mmmm:E(";;;;;;;;;;;"),mmm:E(";;;;;;;;;;;"),dddd:E(";;;;;;"),ddd:E(";;;;;;"),bool:E(";")},"bg");st({group:".",decimal:",",mmmm:E("de gener;de febrer;de mar;dabril;de maig;de juny;de juliol;dagost;de setembre;doctubre;de novembre;de desembre"),mmm:E("de gen.;de febr.;de mar;dabr.;de maig;de juny;de jul.;dag.;de set.;doct.;de nov.;de des."),dddd:E("diumenge;dilluns;dimarts;dimecres;dijous;divendres;dissabte"),ddd:E("dg.;dl.;dt.;dc.;dj.;dv.;ds."),ampm:E("a.m.;p.m.")},"ca");st(Bt({group:",",decimal:".",mmmm:E("Enero;Pebrero;Marso;Abril;Mayo;Hunyo;Hulyo;Agosto;Setyembre;Oktubre;Nobyembre;Disyembre"),dddd:E("Linggo;Lunes;Martes;Miyerkules;Huwebes;Biyernes;Sabado")},3,3),"fil");st({group:",",decimal:".",mmmm:E(";;;;;;;;;;;"),mmm:E(";;;;;;;;;;;"),dddd:E("~;~;~;~;~;~;~",""),ddd:E(";;;;;;")},"gu");st({group:",",decimal:".",ampm:E(";"),dddd:E("~;~;~;~;~;~;~"," "),ddd:E("~;~;~;~;~;~;"," "),mmmm:E(";;;;;;;;;;;"),mmm:E(";;;;;;;;;;;"),mmmm6:E(";; ; ;; ; ; ; ;;;"),mmm6:E(";; ; ;; ; ; ; ;;;")},"he");st(Bt({group:".",decimal:",",mmmm:E("sijenja;veljae;oujka;travnja;svibnja;lipnja;srpnja;kolovoza;rujna;listopada;studenoga;prosinca"),mmm:E("sij;velj;ou;tra;svi;lip;srp;kol;ruj;lis;stu;pro"),dddd:E("nedjelja;ponedjeljak;utorak;srijeda;etvrtak;petak;subota")},-1,3),"hr");st({decimal:",",mmmm:E(";;;;;;;;;;;"),mmm:E(";;;;;;;;;;;"),dddd:E(";;;;;;"),ddd:E(";;;;;;")},"hy");st(Bt({decimal:",",mmmm:E(";;;;;;;;;;;"),dddd:E(";;;;;;")},3,3),"ka");st(Bt({decimal:",",mmmm:E(";;;;;;;;;;;"),dddd:E(";;;;;;"),ddd:E(";;;;;;")},13,-1),"kk");st({group:",",mmmm:E(";;;;;;;;;;;"),mmm:E(";;;;;;;;;;;"),dddd:E("~;~;~;~;~;~;~",""),ddd:E(";;;;;;"),ampm:E(";")},"kn");st({decimal:",",mmmm:E("sausio;vasario;kovo;balandio;gegus;birelio;liepos;rugpjio;rugsjo;spalio;lapkriio;gruodio"),mmm:E("saus.;vas.;kov.;bal.;geg.;bir.;liep.;rugp.;rugs.;spal.;lapkr.;gruod."),dddd:E("sekmadienis;pirmadienis;antradienis;treiadienis;ketvirtadienis;penktadienis;etadienis"),ddd:E("sk;pr;an;tr;kt;pn;t"),ampm:E("priepiet;popiet")},"lt");st({decimal:",",mmmm:E("janvris;februris;marts;aprlis;maijs;jnijs;jlijs;augusts;septembris;oktobris;novembris;decembris"),mmm:E("janv.;febr.;marts;apr.;maijs;jn.;jl.;aug.;sept.;okt.;nov.;dec."),dddd:E("svtdiena;pirmdiena;otrdiena;trediena;ceturtdiena;piektdiena;sestdiena"),ddd:E("svtd.;pirmd.;otrd.;tred.;ceturtd.;piektd.;sestd."),ampm:E("priekpusdien;pcpusdien")},"lv");st({group:",",decimal:".",mmmm:E(";;;;;;;;;;;"),mmm:E(";;;;;;;;;;;"),dddd:E(";;;;;;"),ddd:E(";;;;;;")},"ml");st({group:",",decimal:".",mmmm:E("~;~;~;~;~;~;~;~;~;~; ~; ~"," "),mmm:E("1~;2~;3~;4~;5~;6~;7~;8~;9~;10~;11~;12~","- "),dddd:E(";;;;;;"),ddd:E(";;;;;;"),ampm:E("..;..")},"mn");st({group:",",decimal:".",mmmm:E(";;;;;;;;;;;"),mmm:E(";;;;;;;;;;;"),dddd:E(";;;;;;"),ddd:E(";;;;;;")},"mr");st(Bt({group:",",decimal:".",mmmm:E(";;;;;;;;;;;"),mmm:E(";;;;;;;;;;;"),dddd:E(";;;;;;"),ampm:E(";")},-1,0),"my");st({group:",",decimal:".",mmmm:E(";;;;;;;;;;;"),mmm:E(";;;;;;;;;;;"),dddd:E(";;;;;;"),ddd:E(";;;;;;"),ampm:E("..;..")},"pa");st({group:".",decimal:",",mmmm:E("ianuarie;februarie;martie;aprilie;mai;iunie;iulie;august;septem~;octom~;noiem~;decem~","brie"),mmm:E("ian.;feb.;mar.;apr.;mai;iun.;iul.;aug.;sept.;oct.;nov.;dec."),dddd:E("duminic;luni;mari;miercuri;joi;vineri;smbt"),ddd:E("dum.;lun.;mar.;mie.;joi;vin.;sm."),ampm:E("a.m.;p.m.")},"ro");st(Bt({group:".",decimal:",",mmmm:E("januar;februar;marec;april;maj;junij;julij;avgust;september;oktober;november;december"),mmm:E("jan.;feb.;mar.;apr.;maj;jun.;jul.;avg.;sep.;okt.;nov.;dec."),dddd:E("nedelja;ponedeljek;torek;sreda;etrtek;petek;sobota"),ampm:E("dop.;pop.")},-1,13),"sl");st(Bt({group:".",decimal:",",mmmm:E(";;;;;;;;;;;"),dddd:E(";;;;;;")},3,3),"sr");st({group:",",decimal:".",mmmm:E(";;;;;;;;;;;"),mmm:E(".;.;.;.;;;;.;.;.;.;."),dddd:E(";;;;;;"),ddd:E(".;.;.;.;.;.;")},"ta");st({group:",",decimal:".",mmmm:E(";;;;;;;;;;;"),mmm:E(";;;;;;;;;;;"),dddd:E(";;;;;;"),ddd:E(";;;;;;")},"te");st({decimal:",",mmmm:E(";;;;;;;;;;;"),mmm:E(".;.;.;.;.;.;.;.;.;.;.;."),dddd:E(";;;;;;"),ddd:E(";;;;;;"),ampm:E(";")},"uk");st({group:".",decimal:",",mmmm:E("~1;~2;~3;~4;~5;~6;~7;~8;~9;~10;~11;~12","thng "),mmm:E("~1;~2;~3;~4;~5;~6;~7;~8;~9;~10;~11;~12","thg "),dddd:E("Ch Nht;Th Hai;Th Ba;Th T;Th Nm;Th Su;Th By"),ddd:E("CN;Th 2;Th 3;Th 4;Th 5;Th 6;Th 7"),ampm:E("SA;CH")},"vi");st(Bt({group:"",decimal:"",ampm:E(";"),mmmm:E(";;;;;;;;;;;"),dddd:E(";;;;;;"),mmmm6:E(";; ; ;; ; ; ; ;;;")},0,0),"ar");st({group:",",decimal:".",mmmm:E(";;;;;;;;;;;"),mmm:E(";;;;;;;;;;;"),dddd:E(";;;;;;"),ddd:E(";;;;;;")},"bn");st({group:",",decimal:".",mmmm:E(";;;;;;;;;;;"),mmm:E(";;;;;;;;;;;"),dddd:E(";;;;;;"),ddd:E(";;;;;;"),ampm:E("am;pm")},"hi");const dh={overflow:"######",dateErrorThrows:!1,dateErrorNumber:!0,bigintErrorNumber:!1,dateSpanLarge:!0,leap1900:!0,nbsp:!1,throws:!0,invalid:"######",locale:"",ignoreTimezone:!1,grouping:[3,3],indexColors:!0,skipChar:"",repeatChar:""};function xe(t,e=0){if(typeof t!="number")return t;if(t<0)return-xe(-t,e);if(e){const n=10**e||1;return xe(t*n,0)/n}return Math.round(t)}const NE=1e-13;function hh(t,e=2,n=2){const r=t<0?-1:1,s=10**(e||2),o=10**(n||2);let i=Math.abs(t),a=0,l=0,u=0,c=1,d,h;if(t=i,t%1===0)h=[t*r,1];else if(t<1e-19)h=[r,1e19];else if(t>1e19)h=[1e19*r,1];else{do if(i=1/(i-Math.floor(i)),d=c,c=c*Math.floor(i)+a,a=d,l=u,u=Math.floor(t*c+.5),u>=s||c>=o)return[r*l,a];while(Math.abs(t-u/c)>=NE&&i!==Math.floor(i));h=[r*u,c]}return h}const Ce=Math.floor;function fh(t,e=!0){if(e&&t>=0){if(t===0)return[1900,1,0];if(t===60)return[1900,2,29];if(t<60)return[1900,t<32?1:2,(t-1)%31+1]}let n=t+68569+2415019;const r=Ce(4*n/146097);n=n-Ce((146097*r+3)/4);const s=Ce(4e3*(n+1)/1461001);n=n-Ce(1461*s/4)+31;const o=Ce(80*n/2447),i=n-Ce(2447*o/80);n=Ce(o/11);const a=o+2-12*n;return[100*(r-49)+s+n|0,a|0,i|0]}function ME(t){return fh(t+1462)}function LE(t){if(t===60)throw new Error("#VALUE!");if(t<=1)return[1317,8,29];if(t<60)return[1317,t<32?9:10,1+(t-2)%30];const e=10631/30,n=8.01/60;let r=t+466935;const s=Ce(r/10631);r=r-10631*s;const o=Ce((r-n)/e);r=r-Ce(o*e+n);const i=Ce((r+28.5001)/29.5);return i===13?[30*s+o,12,30]:[30*s+o,i,r-Ce(29.5001*i-29)]}function ph(t,e=0,n=!0){const r=Ce(t);return e===cr?LE(r):e===AE?ME(r):fh(r,n)}const As=Math.floor,Zo=86400;function gl(t,e){let n=null;if(Array.isArray(t)){const[r,s,o,i,a,l]=t;n=Date.UTC(r,s==null?0:s-1,o??1,i||0,a||0,l||0)}else if(t instanceof Date&&(n=t*1,!e||!e.ignoreTimezone)){const r=new Date;r.setUTCFullYear(t.getFullYear(),t.getMonth(),t.getDate()),r.setUTCHours(t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()),n=r*1}if(n!=null&&isFinite(n)){const r=n/864e5;return r-(r<=-25509?-25568:-25569)}return null}function FE(t,e){let n=t|0;const r=Zo*(t-n);let s=As(r);r-s>.9999&&(s+=1,s===Zo&&(s=0,n+=1));const o=s<0?Zo+s:s,[i,a,l]=ph(t,0,e&&e.leap1900),u=As(o/60/60)%60,c=As(o/60)%60,d=As(o)%60;return[i,a,l,u,c,d]}const kE=["!d-m-y","!d-m-Y","!j-m-y","!j-m-Y","!d-n-y","!d-n-Y","!j-n-y","!j-n-Y","?m-d-y","?m-d-Y","?m-j-y","?m-j-Y","?n-d-y","?n-d-Y","?n-j-y","?n-j-Y","d-M-y","d-M-Y","j-M-y","j-M-Y","M-d-y","M-d-Y","M-j-y","M-j-Y","d-F-y","d-F-Y","F-d-y","F-d-Y","F-j-y","F-j-Y","j-F-y","j-F-Y","y-F-d","y-F-j","y-M-d","y-M-j","Y-F-d","Y-F-j","Y-M-d","Y-m-d","Y-M-j","Y-m-j","Y-n-d","Y-n-j","j-F","j-M","d-F","d-M","n-d","n-j","n-Y","m-d","m-j","m-Y","M-Y","M-y","F-y","F-Y","Y-M","Y-n","Y-m","Y-F","Y-M"],PE={j:"d",d:"d",D:"ddd",l:"dddd",n:"m",m:"m",M:"mmm",F:"mmmm",y:"yy",Y:"yyyy"},UE={j:"dd",d:"dd",D:"ddd",l:"dddd",n:"mm",m:"mm",M:"mmm",F:"mmmm",y:"yy",Y:"yyyy"},gh={},mh={};function be(t,e,n=1){if(t){const r=t[0],s=t.slice(1);r==="!"?be(s,e,4):r==="?"?be(s,e,2):(e[r]=e[r]||{},be(s,e[r],n))}else e.$=n}function nc(t,e){be(t,e),be(t+" x",e),be(t+" l",e),be(t+" l x",e),be("l "+t,e),be("l "+t+" x",e),be(t+" D",e),be(t+" D x",e),be("D "+t,e),be("D "+t+" x",e)}kE.forEach(t=>{t[0]!=="?"&&nc(t,gh),t[0]!=="!"&&nc(t,mh)});const BE=new Date().getUTCFullYear(),rc=".",$E=",",Qo=" ",ts="",es="",zs="'",Ks="",HE={".":[$E,ts,es,zs,Ks],",":[rc,ts,es,zs,Ks],"":[rc,ts,es,zs,Ks]},qo=t=>t&&t.length===1&&t>="0"&&t<="9";function ml(t,e={}){const n=Dr(e.locale||"")||bn,r=n.decimal,s=[...HE[r]||[zs,Ks]];!s.includes(n.group)&&n.group!==Qo&&n.group!==r&&s.push(n.group);let o="",i="",a=1,l="",u=!1,c=!1,d=!1,h=!1,f=!1,p=null,g=!1,_=0;const I=[Qo,ts,es,"+","%","(","-"].concat(Bi);for(;I.includes(t[_]);){const y=t[_];if(y==="-"){if(u||c)return null;u=!0,a=-1}else if($i.test(y)){if(f)return null;f=!0,p=y}else if(y==="("){if(c||u)return null;c=!0,a=-1}else if(y==="%"){if(h)return null;h=!0}_++}let U=!1,L;if(t[_]===r||qo(t[_]))for(;_<t.length;){const y=t[_];if(!L&&s.includes(y))L=y;else if(!(L&&L===y))if(y===r){if(U)break;o+=".",U=!0}else if(qo(y))o+=y;else break;_++}if(t[_]==="e"||t[_]==="E"){i+=t[_],_++,(t[_]==="+"||t[_]==="-")&&(i+=t[_],_++);const y=_;for(;qo(t[_]);)i+=t[_],_++;if(y===_)return null}const B=[Qo,ts,es,"%","$",")"].concat(Bi);for(;B.includes(t[_]);){const y=t[_];if($i.test(y)){if(f)return null;f=!0,p=y,g=!0}else if(y===")"){if(d||!c)return null;d=!0}else if(y==="%"){if(h)return null;h=!0}_++}if(_!==t.length)return null;let C=parseFloat(o+i);if(!isFinite(C))return null;if(i){if(h||f)return null;l="0.00E+00"}else if(h){if(f)return null;l=o.includes(".")?"0.00%":"0%",C*=.01}else if(f){const y=o.includes(".")?"#,##0.00":"#,##0";g?l=y+p:l=p+y}else L&&(l=o.includes(".")?"#,##0.00":"#,##0");const R={v:C*a};return l&&(R.z=l),R}function jE(t,e,n){if(n<1||e<1||e>12)return!1;if(e===2){const r=t%4===0&&t%100!==0||t%400===0||t===1900?29:28;if(n>r)return!1}else if((e===4||e===6||e===9||e===11)&&n>30||(e===1||e===3||e===5||e===7||e===8||e===10||e===12)&&n>31)return!1;return!0}const sc=(t,e,n=!1)=>{for(const r of e)if(t.startsWith(r[0])){let s=r[0].length;return n&&(r[2]==="D"||r[2]==="M")&&t[s]==="."&&s++,[t.slice(0,s),r]}return["",null]},Xe=(t,e,n,r)=>{const s=n.path||"",o=Object.keys(e);for(let i=0;i<o.length;i++){let a;const l=o[i];if(e[l]){if(l==="$"||l==="")t||(a=n);else if(l==="-"){const u=/^(\s*([./-]|,\s)\s*|\s+)/.exec(t);if(u){const c=u[1]==="-"||u[1]==="/"||u[1]==="."?u[1]:" ";if(!n.sep||n.sep===c){const d=u[0].replace(/\s+/g," ");a=Xe(t.slice(u[0].length),e[l],{...n,sep:c,path:s+d},r)}}}else if(l===" "){const u=/^[,.]?\s+/.exec(t);if(u){const c=u[0].replace(/\s+/g," ");a=Xe(t.slice(u[0].length),e[l],{...n,path:s+c},r)}}else if(l==="j"||l==="d"){const u=/^(0?[1-9]|1\d|2\d|3[01])\b/.exec(t);u&&(a=Xe(t.slice(u[0].length),e[l],{...n,day:u[0],path:s+l},r))}else if(l==="n"||l==="m"){const u=/^(0?[1-9]|1[012])\b/.exec(t);u&&(a=Xe(t.slice(u[0].length),e[l],{...n,month:+u[0],_mon:u[0],path:s+l},r))}else if(l==="F"||l==="M"){const[u,c]=sc(t,r.mon,r.mp);c&&c[2]===l&&(a=Xe(t.slice(u.length),e[l],{...n,month:c[1],_mon:u,path:s+l},r))}else if(l==="l"||l==="D"){const[u,c]=sc(t,r.day,r.dp);c&&c[2]===l&&(a=Xe(t.slice(u.length),e[l],{...n,path:s+l},r))}else if(l==="y"){const u=/^\d\d\b/.exec(t);if(u){const c=+u[0]>=30?+u[0]+1900:+u[0]+2e3;a=Xe(t.slice(u[0].length),e[l],{...n,year:c,path:s+l},r)}}else if(l==="Y"){const u=/^\d\d\d\d\b/.exec(t);u&&(a=Xe(t.slice(u[0].length),e[l],{...n,year:+u[0],path:s+l},r))}else if(l==="x"){const u=Io(t,{locale:r.locale});u&&(a=Xe("",e[l],{...n,time:u.v,tf:u.z,path:s+l},r))}else throw new Error(`Unknown date token "${l}"`);if(a&&jE(n.year||1916,n.month||1,n.day?+n.day:1))return a}}},_h=t=>t.replace(/\s+/g," ").trim().replace(//,"'").replace(/\.$/,"").toLowerCase(),Os=(t,e)=>{const n=t.map((r,s)=>[_h(r),s+1,e]);return n.sort((r,s)=>s[0].length-r[0].length),n};function _l(t,e={}){var n;const r=Dr(e.locale||"")||bn,s={mon:Os(r.mmmm,"F").concat(Os(r.mmm,"M")),mp:r.mmm[0].at(-1)===".",day:Os(r.dddd,"l").concat(Os(r.ddd,"D")),dp:r.ddd[0].at(-1)===".",locale:e.locale},o=Xe(_h(t),r.preferMDY?mh:gh,{path:""},s);if(o){if(o.sep==="."&&o.path.length===3)return null;const i=+((n=o.year)!=null?n:BE);o.day||(o.day=1);let a=-1/0;if(i<1900)return null;i<=1900&&o.month<=2?a=25568:i<1e4&&(a=25569);const l=Date.UTC(i,o.month-1,o.day)/864e5+a+(o.time||0);if(l>=0&&l<=2958465){const u=o._mon[0]==="0"||o.day[0]==="0"||o._mon.length===2&&o.day.length===2,c=o.path.replace(/[jdlDnmMFyYx]/g,d=>d==="x"?o.tf||"":(u?UE[d]:PE[d])||d);return{v:l,z:c}}}return null}const ti=t=>t.replace(/\s+/g,"").trim().replace(/\./g,"").toLowerCase();function Io(t,e={}){const n=Dr(e.locale||"")||bn,r=/^\s*([10]?\d|2[0-4])(?::([0-5]\d|\d))?(?::([0-5]\d|\d))?(\.\d{1,10})?(?=\s*[^\s\d]|$)/.exec(t);let s="";if(r){const o=ti(t.slice(r[0].length));if(o===ti(n.ampm[0])||o==="a"||o==="am")s="a";else if(o===ti(n.ampm[1])||o==="p"||o==="pm")s="p";else if(o)return null}if(r){const[,o,i,a,l]=r;if(l&&!a||!s&&!i&&!a)return null;let u=+(o||0)*1;if(s){if(u>=13)return null;s==="p"&&(u+=12)}const c=+(i||0)*1,d=+(a||0)*1,h=+(l||0)*1;return{v:(u*60*60+c*60+d+h)/(3600*24),z:(o.length===2?"hh":"h")+":mm"+(a?":ss":"")+(s?" AM/PM":"")}}return null}function yh(t,e={}){const n=Dr(e.locale||"")||bn,r=t.trim().toLowerCase(),s=n.bool[0].toLowerCase();if(r==="true"||r===s)return{v:!0};const o=n.bool[1].toLowerCase();return r==="false"||r===o?{v:!1}:null}function VE(t,e){var n,r,s;return(s=(r=(n=ml(t,e))!=null?n:_l(t,e))!=null?r:Io(t,e))!=null?s:yh(t,e)}function An(t,e,n){return e[n+"_max"]=t.length,e[n+"_min"]=t.replace(/#/g,"").length,e}function Jt(t,e){typeof t=="string"?e.push({type:"string",value:t}):e.push(t)}function oc(t,e){const n=t&&t.type;return n===$a||n===dr||n===Ha||n===To&&e==="den"}function Xr(t){var e,n,r;const s=[],o={scale:1,percent:!1,text:!1,date:0,date_eval:!1,date_system:ec,sec_decimals:0,general:!1,clock:24,int_pattern:[],frac_pattern:[],man_pattern:[],den_pattern:[],num_pattern:[],tokens:s};let i="int",a=null;const l=[];let u,c=!1,d=-1,h=!1,f="",p=!1;for(;++d<t.length&&!h;){const C=t[d],R=C.type||is;if(f+=C.raw,R===Ba)o.general=!0,Jt(C,s);else if(oc(C,i)){const y=o[i+"_pattern"];oc(u,i)||(u==null?void 0:u.type)===os?(y.push((y.pop()||"")+C.value),a.num+=C.value):(y.push(C.value),a={type:i,num:C.value},Jt(a,s))}else if(R===ul)C.value==="("&&(o.parens=!0),Jt(C.value,s);else if(R===To)Jt(C.value,s);else if(R===ja)if(p=!0,o[i+"_pattern"].length){if(!a)throw new SyntaxError("Format pattern is missing a numerator");o.fractions=!0,o.num_pattern.push(o[i+"_pattern"].pop()),a.type="num",i="den",Jt({type:"div"},s)}else Jt(C.value,s);else if(R===Va)Jt(",",s);else if(R===no)o.scale=.001**C.raw.length;else if(R===os){if(i==="int"&&(o.grouping=!0),i==="den")throw new SyntaxError("Cannot group denominator digits")}else if(R===za)Jt(C,s);else if(R===Wa){h=!0;break}else if(R===Ro)o.text=!0,Jt(C,s);else if(R===Ga||R===Ya)Jt(C,s);else if(R===Za){const y=C.value.toLowerCase(),N=y[0],G={type:"",size:0,date:1,pad:y.length};N==="h"?(G.size=Yr,G.type="hour-elap"):N==="m"?(G.size=zr,G.type="min-elap"):(G.size=Kr,G.type="sec-elap"),o.date=o.date|G.size,l.push(G),Jt(G,s)}else if(o.date&&R===ro&&((e=t[d+1])==null?void 0:e.type)===dr){let y=1;d++;let N="0";((n=t[d+1])==null?void 0:n.type)===dr&&(N+="0",y=2,d++),((r=t[d+1])==null?void 0:r.type)===dr&&(N+="0",y=3,d++),f+=N;const G=[Kr,ki,Pi,Ui][y];o.date=o.date|G,o.date_eval=!0,o.sec_decimals=Math.max(o.sec_decimals,y),Jt({type:"subsec",size:G,decimals:y,date:1},s)}else if(R===Xa)c||(C.value==="B2"||C.value==="b2"?o.date_system=cr:o.date_system=ec);else if(R===Ja){const y={type:"",size:0,date:1},N=C.value.toLowerCase(),G=N[0];if(N==="y"||N==="yy")y.size=Wr,y.type="year-short";else if(G==="y"||G==="e")y.size=Wr,y.type="year";else if(N==="b"||N==="bb")y.size=Wr,y.type="b-year-short";else if(G==="b")y.size=Wr,y.type="b-year";else if(N==="d"||N==="dd")y.size=Ys,y.type="day",y.pad=/dd/.test(N);else if(N==="ddd"||N==="aaa")y.size=Ys,y.type="weekday-short";else if(G==="d"||G==="a")y.size=Ys,y.type="weekday";else if(G==="h")y.size=Yr,y.type="hour",y.pad=/hh/i.test(N);else if(G==="m"){N.length===3?(y.size=Gr,y.type="monthname-short"):N.length===5?(y.size=Gr,y.type="monthname-single"):N.length>=4&&(y.size=Gr,y.type="monthname");const z=l[l.length-1];!y.type&&z&&!z.used&&z.size&(Yr|Kr)&&(z.used=!0,y.size=zr,y.type="min",y.pad=/mm/.test(N)),y.type||(y.size=Gr,y.type="month",y.pad=/mm/.test(N),y.indeterminate=!0)}else if(G==="s"){y.size=Kr,y.type="sec",y.pad=/ss/.test(N);const z=l[l.length-1];z&&z.size&zr?y.used=!0:z&&z.indeterminate&&(delete z.indeterminate,z.size=zr,z.type="min",y.used=!0)}o.date=o.date|y.size,o.date_eval=!0,l.push(y),Jt(y,s)}else if(R===rl)o.clock=12,o.date=o.date|Yr,o.date_eval=!0,C.short=C.value==="A/P",Jt(C,s);else if(R===ol||R===sl||R===wo)Jt(C.value,s);else if(R===Qa)o.condition=[C.value[0],parseFloat(C.value[1])];else if(R===el){const y=C.value.split("-"),N=y.length<2?"":y.slice(1).join("-"),G=y[0];G&&Jt(G,s);const z=dl(N);z&&(o.locale=z);const m=parseInt(N,16);isFinite(m)&&m&16711680&&(m>>16&255)===6&&(o.date_system=cr),c=!0}else if(R===nl){let y,N=C.value.toLowerCase();(y=/^color\s*(\d+)$/i.exec(N))&&(N=parseInt(y[1],10)),o.color=N}else if(R===Ka)o.scale=100,o.percent=!0,Jt("%",s);else if(R===ro)Jt(C,s),o.date||(o.dec_fractions=!0,i="frac");else if(R===al)o.exponential=!0,o.exp_plus=C.value.includes("+"),i="man",Jt({type:"exp",plus:o.exp_plus},s);else if(R===il)Jt(C,s);else if(R===ll)Jt(C,s);else if(!(R===qa||R===tl))throw R===is?new SyntaxError(`Illegal character: ${f}`):new SyntaxError(`Unknown token ${R} in ${f}`);u=C}if(o.tokensUsed=d,o.pattern=f,/^((?:\[[^\]]+\])+)(;|$)/.test(o.pattern)&&!/^\[(?:h+|m+|s+)\]/.test(o.pattern)&&Jt({type:"text"},s),o.fractions&&o.dec_fractions||o.grouping&&!o.int_pattern.length||o.fractions&&o.exponential||o.fractions&&o.den_pattern.length*o.num_pattern.length===0||p&&!o.fractions&&!o.date||o.exponential&&(o.int_pattern.length||o.frac_pattern.length)*o.man_pattern.length===0)throw new SyntaxError(`Invalid pattern: ${f}`);const g=o.int_pattern.join(""),_=o.man_pattern.join(""),I=o.frac_pattern.join("");An(g,o,"int");let U=0;for(let C=0;C<g.length;C++){const R=g[g.length-1-C];/^[0-9?]/.test(R)&&(U=C+1)}o.int_min=U,An(I,o,"frac"),An(_,o,"man");let L=o.num_pattern.join(""),B=o.den_pattern[0]||"";if(B.includes("?")||L.includes("?")?(B=B.replace(/\d/g,"?"),B=B.replace(/#$/g,"?"),An(L,o,"num"),An(B,o,"den"),L=L.replace(/#$/g,"?")):(An(L,o,"num"),An(B,o,"den")),o.int_p=g,o.man_p=_,o.num_p=L,o.den_p=B,o.den_pattern.length&&(o.denominator=parseInt(o.den_pattern.join("").replace(/\D/g,""),10)),o.integer=!!g.length,!o.integer&&!o.exponential&&I.length){const C=o.tokens.findIndex(R=>R.type==="point");o.tokens.splice(C,0,{type:"int",value:"#"}),o.integer=!0,o.int_pattern=["#"],o.int_p="#"}if(o.fractions)for(let C=0;C<s.length-1;C++){const R=s[C];if(R.type!=="string"&&R.type!=="space")continue;const y=s[C+1].type;y==="num"?R.rule="num+int":y==="div"?R.rule="num":y==="den"&&(R.rule="den")}return o.grouping&&o.int_pattern.length>1&&(o.grouping=!1),o}function WE(t){if(t===0)return t;const e=Math.ceil(Math.log10(t<0?-t:t)),n=10**(16-Math.floor(e));return isFinite(n)?Math.round(t*n)/n:0}function vh(t,e=0){const n=Math.floor(Math.log10(t));return e>1?Math.floor(n/e)*e:n}function Eh(t,e=1){return e<-300?parseFloat(t.toExponential().split("e")[0]):t*10**-e}const GE={total:1,sign:0,period:0,int:1,frac:0};function YE(t,e=!0){const n=Math.abs(t);if(!n)return GE;const r=e&&t<0?1:0,s=Math.floor(n),o=Math.floor(Math.log10(n)+1);let i=0,a=0;if(s!==n){i=1;const l=String(xe(n*10**-o,15));let u=l.length,c=!0,d=0;for(;d<=l.length;){if(l[d]==="."){u--;break}else l[d]==="0"&&c?u--:c=!1;d++}a=u-o,a<0&&(a=0,i=0)}return{total:r+Math.max(o,1)+i+a,digits:Math.max(o,0)+a,sign:r,period:i,int:Math.max(o,1),frac:a}}const tr=(t,e)=>t.replace(/\./,e.decimal),ic=(t,e,n)=>{const r=Math.abs(e);let s;return t===1?s=t:s=xe(t,5),[tr(s+"",n),n.exponent,e<0?n.negative:n.positive,r<10?"0":"",r]};function ac(t,e,n,r){const s=n|0;if(typeof n=="string")t.push(n);else if(n===s)t.push(Math.abs(s));else{const o=Math.abs(n);let i=vh(o),a=Eh(o,i);a===10&&(a=1,i++);const l=YE(o);if(i>=-4&&i<=-1){const u=o.toPrecision(10+i).replace(/\.?0+$/,"");t.push(tr(u,r))}else if(i===10){const u=o.toFixed(10).slice(0,12).replace(/\.$/,"");t.push(tr(u,r))}else if(Math.abs(i)<=9)if(l.total<=11){const u=xe(o,9).toFixed(l.frac);t.push(tr(u,r))}else i===9?t.push(Math.floor(o)):i>=0&&i<9?t.push(tr(String(xe(o,9-i)),r)):t.push(...ic(a,i,r));else l.total>=12?t.push(...ic(a,i,r)):t.push(tr(xe(o,9).toFixed(l.frac),r))}return t}function On(t,e=!1){return t==="0"?"0":t==="?"?e?"":" ":""}const Mr=86400,zE=(t,e,n)=>n?t<IE||e>=SE:t<TE||e>=wE;function lc(t,e,n,r){var s,o;let i="",a="",l="",u="",c="",d="",h=0,f=0;if(typeof t=="bigint"){if(t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER)t=Number(t);else return n.bigintErrorNumber?String(t):n.overflow;f=t}else f=Math.trunc(t);let p=0,g=0,_=1,I=0,U=0,L=0,B=0,C=0,R=0;const y=r||bn;if(!e.text&&isFinite(e.scale)&&e.scale!==1&&(t=WE(t*e.scale)),e.exponential){let A=Math.abs(t);A&&(h=vh(A,e.int_max)),t&&!e.integer&&h++,A=Eh(A,h),e.int_max===1&&xe(A,e.frac_max)===10&&(A=1,h++),t=t<0?-A:A,i+=Math.abs(h)}if(e.integer){const A=Math.abs(xe(t,e.fractions?1:e.frac_max));d+=A<1?"":Math.floor(A)}const N=(s=n.grouping[0])!=null?s:3,G=(o=n.grouping[1])!=null?o:N;e.dec_fractions&&(c=String(xe(t,e.frac_max)).split(".")[1]||"");const z=!e.error&&(e.num_p.includes("0")||e.den_p.includes("0"));let m=z;if(e.fractions){m=z||!!(t%1);const A=Math.abs(e.integer?t%1:t);if(A)if(m=!0,e.denominator&&isFinite(e.denominator))u+=e.denominator,l+=xe(A*e.denominator),l==="0"&&(l="",u="",m=z);else{const O=hh(A,1/0,e.den_max);l+=O[0],u+=O[1],e.integer&&l==="0"&&(l="",u="",m=z)}else!t&&!e.integer&&(m=!0,l="0",u="1");e.integer&&!m&&!Math.trunc(t)&&(d="0")}if(e.date){f=Math.trunc(t);const A=Mr*(t-f);if(p=Math.floor(A),R=A-p,Math.abs(R)<1e-6?R=0:R>.9999&&(R=0,p+=1,p===Mr&&(p=0,f+=1)),R){const O=e.date&Ui||e.date&Pi||e.date&ki;(O===Ui&&R>.9995||O===Pi&&R>.995||O===ki&&R>.95||!O&&R>=.5)&&(p++,R=0)}if(f||e.date_system){const O=ph(t,e.date_system,n.leap1900);g=O[0],_=O[1],I=O[2]}if(p){const O=p<0?Mr+p:p;C=Math.floor(O)%60,B=Math.floor(O/60)%60,L=Math.floor(O/60/60)%60}if(U=(6+f)%7,e.date_eval&&zE(t,f+p/Mr,n.dateSpanLarge)){if(n.dateErrorThrows)throw new Error("Date out of bounds");if(n.dateErrorNumber){const O=t<0?[y.negative]:[];return ac(O,{},t,y).join("")}return n.overflow}}const F=On("?",n.nbsp);h<0?a="-":e.exp_plus&&(a="+");const v=[],x=(A,O,M,P)=>{const Q=!P&&A.length>O.length?M.length+A.length-O.length:M.length;A.length<O.length&&(P+=A.length-O.length);for(let W=0;W<Q;W++)v.push(A[W+P]||On(M[W],n.nbsp));return Q};let S=!1;const w={int:0,frac:0,man:0,num:0,den:0};for(let A=0,O=e.tokens.length;A<O;A++){const M=e.tokens[A],P=M.type,Q=M.num?M.num.length:0;if(P==="string")M.rule?M.rule==="num"?m?v.push(M.value.replace(/ /g,F)):(e.num_min>0||e.den_min>0)&&v.push(M.value.replace(/./g,F)):M.rule==="num+int"?m&&d?v.push(M.value.replace(/ /g,F)):e.den_min>0&&(d||e.num_min)&&v.push(M.value.replace(/./g,F)):M.rule==="den"&&(m?v.push(M.value.replace(/ /g,F)):(e.den_min>0||e.den_min>0)&&v.push(M.value.replace(/./g,F))):v.push(M.value.replace(/ /g,F));else if(P==="space")M.rule==="num+int"?(m||e.num_min||e.den_min)&&(d||e.num_min)&&v.push(F):v.push(F);else if(P==="error")v.push(n.invalid);else if(P==="point")v.push(e.date?M.value:y.decimal);else if(P==="general")ac(v,e,t,y);else if(P==="exp")v.push(y.exponent);else if(P==="minus")M.volatile&&e.date||M.volatile&&(t>=0||typeof t!="number")||(M.volatile&&!e.fractions&&(e.integer||e.dec_fractions)?(t<0&&d&&d!=="0"||c)&&v.push(y.negative):v.push(y.negative));else if(P==="plus")v.push(y.positive);else if(P==="text")v.push(t);else if(P==="fill")n.fillChar&&v.push(n.fillChar,M.value);else if(P==="skip")n.skipChar?v.push(n.skipChar,M.value):v.push(n.nbsp?"":" ");else if(P==="div")m?v.push("/"):e.num_min>0||e.den_min>0?v.push(F):v.push(On("#",n.nbsp));else if(P==="int")if(e.int_pattern.length===1){const W=e.int_p,ot=Math.max(e.int_min,d.length);let lt="";for(let T=ot;T>0;T--){const D=d.charAt(d.length-T),H=D?"":W.charAt(W.length-T)||W[0];let Y="";if(e.grouping){const $=T-1-N;$>=0&&!($%G)&&(Y=D||H==="0"?y.group:On("?",n.nbsp))}lt+=(D||On(H,n.nbsp))+Y}v.push(lt)}else w.int+=x(d,e.int_p,M.num,w.int);else if(P==="frac"){const W=w.frac;for(let ot=0;ot<Q;ot++)v.push(c[ot+W]||On(M.num[ot],n.nbsp));w.frac+=Q}else if(P==="man")!w[P]&&!w.man&&v.push(a),w.man+=x(i,e.man_p,M.num,w.man);else if(P==="num")w.num+=x(l,e.num_p,M.num,w.num);else if(P==="den"){const W=w.den;for(let ot=0;ot<Q;ot++){let lt=u[ot+W];if(!lt){const T=M.num[ot];"123456789".includes(T)||S&&T==="0"?(S=!0,lt=n.nbsp?"":" "):!S&&ot===Q-1&&T==="0"&&!u?lt="1":lt=On(T,n.nbsp)}v.push(lt)}w.den+=Q}else if(P==="year")g<0&&v.push(y.negative),v.push(String(Math.abs(g)).padStart(4,"0"));else if(P==="year-short"){const W=g%100;v.push(W<10?"0":"",W)}else if(P==="month")v.push(M.pad&&_<10?"0":"",_);else if(P==="monthname-single")e.date_system===cr?v.push(y.mmmm6[_-1].charAt(0)):v.push(y.mmmm[_-1].charAt(0));else if(P==="monthname-short")e.date_system===cr?v.push(y.mmm6[_-1]):v.push(y.mmm[_-1]);else if(P==="monthname")e.date_system===cr?v.push(y.mmmm6[_-1]):v.push(y.mmmm[_-1]);else if(M.type==="weekday-short")v.push(y.ddd[U]);else if(P==="weekday")v.push(y.dddd[U]);else if(P==="day")v.push(M.pad&&I<10?"0":"",I);else if(P==="hour"){const W=L%e.clock||(e.clock<24?e.clock:0);v.push(M.pad&&W<10?"0":"",W)}else if(P==="min")v.push(M.pad&&B<10?"0":"",B);else if(P==="sec")v.push(M.pad&&C<10?"0":"",C);else if(P==="subsec"){v.push(y.decimal);const W=R.toFixed(e.sec_decimals);v.push(W.slice(2,2+M.decimals))}else if(P==="ampm"){const W=L<12?0:1;M.short&&!r?v.push("AP"[W]):v.push(y.ampm[W])}else if(P==="hour-elap"){t<0&&v.push(y.negative);const W=f*24+Math.floor(Math.abs(p)/3600);v.push(String(Math.abs(W)).padStart(M.pad,"0"))}else if(P==="min-elap"){t<0&&v.push(y.negative);const W=f*1440+Math.floor(Math.abs(p)/60);v.push(String(Math.abs(W)).padStart(M.pad,"0"))}else if(P==="sec-elap"){t<0&&v.push(y.negative);const W=f*Mr+Math.abs(p);v.push(String(Math.abs(W)).padStart(M.pad,"0"))}else if(P==="b-year")v.push(g+543);else if(P==="b-year-short"){const W=(g+543)%100;v.push(W<10?"0":"",W)}}return v.join("")}const KE=Xr([{type:Ro,value:"@",raw:"@"}]);function bh(t,e){for(let n=0;n<3;n++){const r=e[n];if(r){let s;if(r.condition){const o=r.condition[0],i=r.condition[1];o==="="?s=t===i:o===">"?s=t>i:o==="<"?s=t<i:o===">="?s=t>=i:o==="<="?s=t<=i:o==="<>"&&(s=t!==i)}else s=!0;if(s)return r}}}function XE(t,e,n){const r=e.partitions;let s=r[3],o=null;return(typeof t=="number"||typeof t=="bigint")&&isFinite(t)&&(s=bh(t,r)),s&&s.color&&(o=s.color),o&&typeof o=="number"&&n.indexColors&&(o=OE[o-1]||"#000"),o}function JE(t,e,n){const r=e.partitions,s=Dr(e.locale||n.locale),o=r[3]?r[3]:KE;if(typeof t=="boolean"&&(t=(s||bn).bool[t?0:1]),t==null)return"";const i=typeof t=="bigint";if(typeof t!="number"&&!i)return lc(t,o,n,s);if(!i&&!isFinite(t)){const l=s||bn;return isNaN(t)?l.nan:(t<0?l.negative:"")+l.infinity}const a=bh(t,r);return a?lc(t,a,n,s):n.overflow}function Ch(t){return!!(t[0]&&t[0].percent||t[1]&&t[1].percent||t[2]&&t[2].percent||t[3]&&t[3].percent)}function Rh(t){return!!(t[0]&&t[0].date||t[1]&&t[1].date||t[2]&&t[2].date||t[3]&&t[3].date)}function Th(t){const[e,n,r,s]=t;return!!((!e||e.generated)&&(!n||n.generated)&&(!r||r.generated)&&s&&s.text&&!s.generated)}const ZE={text:15,datetime:10.8,date:10.8,time:10.8,percent:10.6,currency:10.4,grouped:10.2,scientific:6,number:4,fraction:2,general:0,error:0},QE=[["DMY",1],["DM",2],["MY",3],["MDY",4],["MD",5],["hmsa",6],["hma",7],["hms",8],["hm",9]];function qE(t,e=null){var n;const[r,s]=t,o=r.frac_max,i={type:"general",isDate:Rh(t),isText:Th(t),isPercent:Ch(t),maxDecimals:r.general?9:o,scale:(n=r.scale)!=null?n:1,color:0,parentheses:0,grouped:r.grouping?1:0},a=!i.isDate&&!i.isText&&!r.error&&r.tokens.some(h=>h.type==="string"&&(e?h.value===e:$i.test(h.value)));let l="G",u=o>=0?Math.min(15,o):"",c="",d="";if(s&&s.color&&(d="-",i.color=1),r.parens&&(c="()",i.parentheses=1),a)l="C",i.type="currency";else if(r.error)i.type="error",i.maxDecimals=0;else if(i.isDate){let h=0,f=0,p="";r.tokens.forEach(_=>{const I=_.type;/^(b-)?year/.test(I)?(p+="Y",f++):I.startsWith("month")?(p+="M",f++):/^(week)?day/.test(I)?(p+="D",f++):(I==="hour"||I==="min"||I==="sec"||I==="ampm")&&(p+=I[0],h++)}),i.type="date",f&&h?i.type="datetime":!f&&h&&(i.type="time");const g=QE.find(_=>p.startsWith(_[0]));l=g?"D":"G",u=g?g[1]:""}else i.isText?(l="G",i.type="text",u="",i.maxDecimals=0):r.general?(l="G",i.type="general",u=""):r.fractions?(l="G",i.type="fraction",u=""):r.exponential?(l="S",i.type="scientific"):i.isPercent?(l="P",i.type="percent"):r.grouping?(l=",",i.type="grouped"):(r.int_max||o)&&(l="F",i.type="number");return i.code=l+u+d+c,i.level=ZE[i.type],Object.freeze(i)}function t1(t){const[e]=t;return{year:!!(e.date&Wr),month:!!(e.date&Gr),day:!!(e.date&Ys),hours:!!(e.date&Yr),minutes:!!(e.date&zr),seconds:!!(e.date&Kr),clockType:e.clock===12?12:24}}const e1=[[Ba,/^General/i,0],[$a,/^#/,0],[dr,/^0/,0],[Ha,/^\?/,0],[ja,/^\//,0],[Wa,/^;/,0],[Ro,/^@/,0],[Ga,/^\+/,0],[Ya,/^-/,0],[ro,/^\./,0],[za,/^ /,0],[Ka,/^%/,0],[To,/^[1-9]/,0],[Xa,/^(?:B[12])/i,0],[is,/^B$/,0],[Ja,/^(?:[hH]+|[mM]+|[sS]+|[yY]+|[bB]+|[dD]+|[gG]+|[aA]{3,}|e+)/,0],[Za,/^(?:\[(h+|m+|s+)\])/i,1],[Qa,/^\[(<[=>]?|>=?|=)\s*(-?[.\d]+)\]/,[1,2]],[qa,/^\[(DBNum[0-4]?\d)\]/i,1],[tl,/^\[(NatNum[0-4]?\d)\]/i,1],[el,/^\[\$([^\]]+)\]/,1],[nl,/^\[(black|blue|cyan|green|magenta|red|white|yellow|color\s*\d+)\]/i,1],[oh,/^\[([^\]]+)\]/,1],[rl,/^(?:AM\/PM|am\/pm|A\/P)/,0],[sl,/^\\(.)/,1],[ol,/^"([^"]*?)"/,1],[il,/^_(\\.|.)/,1],[al,/^[Ee]([+-])/,1],[ll,/^\*(\\.|.)/,1],[ul,/^[()]/,0],[is,/^[ENn["*/\\_]/,0],[wo,/^./,0]],n1=63,r1=35,s1=48,o1=57,ei=t=>{const e=(t||"\0").charCodeAt(0);return e===n1||e===r1||e>=s1&&e<=o1};function or(t){let e=0;const n=[],r=[];for(;e<t.length;){const s=t.slice(e);let o=0;const i=/^(,+)(.)?/.exec(s);if(i){const a=i[1];o=a.length;const l=t[e-1]||"";let u=!1,c=!1;ei(l)?(u=!0,c=!0):l==="."&&(c=!0);const d=i[2]||"";if(u&&(!d||d===";")&&(u=!1),c&&ei(d)&&(c=!1),u&&!c)n.push({type:os,value:",",raw:a});else if(!u&&c)n.push({type:no,value:",",raw:a});else if(u&&c){const h={type:no,value:",",raw:a};n.push(h),r.push(h)}else n.push({type:Va,value:",",raw:a})}else{let a;for(const[l,u,c]of e1){const d=u.exec(s);if(d){const h=Array.isArray(c)?c.map(f=>d[f]):d[c||0];a={type:l,value:h,raw:d[0]},n.push(a),o=d[0].length;break}}r.length&&a.raw===";"&&(r.length=0),r.length&&ei(a.raw)&&(r.forEach(l=>l.type=os),r.length=0)}if(!o){const a=s[0];o=1,n.push({type:wo,value:a,raw:a})}e+=o}return n}const ni=t=>{const e=t.condition;e&&e[1]<0&&(e[0]==="<"||e[0]==="<="||e[0]==="=")||t.tokens.unshift({type:"minus",volatile:!0})},uc=(t,e=null)=>{const n={};for(const r in t)Array.isArray(t[r])?n[r]=[...t[r]]:n[r]=t[r];return e&&n.tokens.unshift(e),n.generated=!0,n};function i1(t){var e;const n=[];let r=!1,s,o=null,i=0,a=!1,l=0,u=0,c=or(t);do{if(a=Xr(c),(a.date||a.general)&&(a.int_pattern.length||a.frac_pattern.length||a.scale!==1||a.text))throw new Error("Illegal format");if(a.condition&&(u++,r=!0),a.text){if(o)throw new Error("Unexpected partition");o=a}a.locale&&(s=dl(a.locale)),n.push(a),i=((e=c[a.tokensUsed])==null?void 0:e.type)==="break"?1:0,c=c.slice(a.tokensUsed+i),l++}while(i&&l<4&&u<3);if(i)throw new Error("Unexpected partition");if(u>2)throw new Error("Unexpected condition");const d=n[3];if(d&&(d.int_pattern.length||d.frac_pattern.length||d.date))throw new Error("Unexpected partition");if(r){const h=n.length;if(h===1&&(n[1]=Xr(or("General")),n[1].generated=!0),h<3){const f=n[0],p=n[1];if(ni(f),p.condition)ni(p);else{const g=f.condition;(g[0]==="="||g[1]>=0&&(g[0]===">"||g[0]===">="))&&p.tokens.unshift({type:"minus",volatile:!0})}}else n.forEach(ni)}else{if(n.length<4&&o)for(let h=0,f=n.length;h<f;h++)n[h]===o&&n.splice(h,1);if(n.length<1&&o&&(n[0]=Xr(or("General")),n[0].generated=!0),n.length<2){const h={type:"minus",volatile:!0};n.push(uc(n[0],h))}if(n.length<3&&n.push(uc(n[0])),n.length<4)if(o)n.push(o);else{const h=Xr(or("@"));h.generated=!0,n.push(h)}n[0].condition=[">",0],n[1].condition=["<",0],n[2].condition=null}return{pattern:t,partitions:n,locale:s}}const cc=Object.create({});function Tn(t,e=!1){t||(t="General");let n=cc[t];if(!n)try{n=i1(t),cc[t]=n}catch(r){if(e)throw r;const s={tokens:[{type:"error"}],error:r.message};n={pattern:t,partitions:[s,s,s,s],error:r.message,locale:null}}return n}function wh(t,e,n={}){var r;const s=Object.assign({},dh,n),o=Tn(t,s.throws),i=(r=gl(e,s))!=null?r:e;return JE(i,o,s)}function a1(t,e,n){var r;const s=Object.assign({},dh,n),o=Tn(t,s.throws),i=(r=gl(e,s))!=null?r:e;return XE(i,o,s)}function l1(t){const e=Tn(t,!1);return Rh(e.partitions)}function u1(t){const e=Tn(t,!1);return Ch(e.partitions)}function c1(t){const e=Tn(t,!1);return Th(e.partitions)}function d1(t){try{return Tn(t,!0),!0}catch{return!1}}function h1(t,e={}){const n=Tn(t,!1);return n.info||(n.info=qE(n.partitions,e==null?void 0:e.currency)),n.info}function f1(t){const e=Tn(t,!1);return e.dateInfo||(e.dateInfo=t1(e.partitions)),e.dateInfo}const er=Object.freeze({AMPM:rl,BREAK:Wa,CALENDAR:Xa,CHAR:wo,COLOR:nl,COMMA:Va,CONDITION:Qa,DATETIME:Ja,DBNUM:qa,DIGIT:To,DURATION:Za,ERROR:is,ESCAPED:sl,EXP:al,FILL:ll,GENERAL:Ba,GROUP:os,HASH:$a,LOCALE:el,MINUS:Ya,MODIFIER:oh,NATNUM:tl,PAREN:ul,PERCENT:Ka,PLUS:Ga,POINT:ro,QMARK:Ha,SCALE:no,SKIP:il,SLASH:ja,SPACE:za,STRING:ol,TEXT:Ro,ZERO:dr}),Tw=Object.freeze(Object.defineProperty({__proto__:null,addLocale:st,dateFromSerial:FE,dateToSerial:gl,dec2frac:hh,format:wh,formatColor:a1,getFormatDateInfo:f1,getFormatInfo:h1,getLocale:Dr,isDateFormat:l1,isPercentFormat:u1,isTextFormat:c1,isValidFormat:d1,parseBool:yh,parseDate:_l,parseLocale:cl,parseNumber:ml,parseTime:Io,parseValue:VE,round:xe,tokenTypes:er,tokenize:or},Symbol.toStringTag,{value:"Module"})),p1="@@@",g1="@",m1="General";function ww(t){return t===p1||t===g1}function Iw(t){return t==null||t===m1}const Sw=(t,e)=>{if(t&&!e||!t&&e)return!1;const n=o=>{const i=or(o);let a="",l=!1,u=!1;for(const c of i){if(c.type===er.POINT){l=!0;continue}if(!(u&&c.type===er.MINUS)&&c.type!==er.SKIP){if(c.type===er.COLOR){u=!0;continue}else u=!1;l&&c.type===er.ZERO||(l=!1,l||(a+=c.value||""))}}return a},r=n(t),s=n(e);return r===s},_1=new Set(["m d"]),y1=new Set(["h:mm AM/PM","hh:mm AM/PM"]),Aw=t=>{var e,n;const r=(n=(e=_l(t))!=null?e:Io(t))!=null?n:ml(t);if(!r)return null;const{v:s,z:o}=r;return o&&(_1.has(o)||y1.has(o)&&!/\s(A|AM|P|PM)$/i.test(t)||o.includes("#,##0")&&wh(o,s)!==t)?null:r},Ow={sheetId:"",range:{startRow:-1,endRow:-1,startColumn:-1,endColumn:-1}},Dw={startRow:-1,startColumn:-1,endRow:-1,endColumn:-1},xw={startRow:0,startColumn:0,endRow:0,endColumn:0},Nw={row:0,column:0},fe={ff:"Arial",fs:11,it:ut.FALSE,bl:ut.FALSE,ul:{s:ut.FALSE},st:{s:ut.FALSE},ol:{s:ut.FALSE},tr:{a:0,v:ut.FALSE},td:to.UNSPECIFIED,cl:{rgb:"#000000"},bg:{rgb:"#fff"},ht:qe.UNSPECIFIED,vt:lr.UNSPECIFIED,tb:_r.UNSPECIFIED,pd:{t:0,r:0,b:0,l:0},n:null,bd:{b:null,l:null,r:null,t:null}},v1={id:"default_slide",title:"defaultSlide",pageSize:{width:300,height:300}},Mw=[bd,Ag,Cd],Lw={[oe.HEADING_1]:{fs:20,bl:1},[oe.HEADING_2]:{fs:18,bl:1},[oe.HEADING_3]:{fs:16,bl:1},[oe.HEADING_4]:{fs:14,bl:1},[oe.HEADING_5]:{fs:12,bl:1},[oe.NORMAL_TEXT]:null,[oe.TITLE]:{fs:26,bl:1},[oe.SUBTITLE]:{fs:15,cl:{rgb:"#999999"}},[oe.NAMED_STYLE_TYPE_UNSPECIFIED]:null},zn=4,Fw={[oe.HEADING_1]:{spaceAbove:{v:20},spaceBelow:{v:6+zn}},[oe.HEADING_2]:{spaceAbove:{v:18},spaceBelow:{v:6+zn}},[oe.HEADING_3]:{spaceAbove:{v:16},spaceBelow:{v:6+zn}},[oe.HEADING_4]:{spaceAbove:{v:14},spaceBelow:{v:4+zn}},[oe.HEADING_5]:{spaceAbove:{v:12},spaceBelow:{v:4+zn}},[oe.NORMAL_TEXT]:{spaceAbove:{v:0},spaceBelow:{v:0}},[oe.TITLE]:{spaceAbove:{v:0},spaceBelow:{v:3+zn}},[oe.SUBTITLE]:{spaceAbove:{v:0},spaceBelow:{v:16}},[oe.NAMED_STYLE_TYPE_UNSPECIFIED]:null},kw="univer-sheets-chart-print-chart",Pw="univer-docs-drawing-printing";var E1=(t=>(t.ARRAY_CONVERTOR="ARRAY_CONVERTOR",t.MATRIX_CONVERTOR="MATRIX_CONVERTOR",t))(E1||{});const Uw={[Oe.A3]:{width:1123,height:1587},[Oe.A4]:{width:794,height:1124},[Oe.A5]:{width:559,height:794},[Oe.B4]:{width:944,height:1344},[Oe.B5]:{width:665,height:944},[Oe.Executive]:{width:696,height:1008},[Oe.Folio]:{width:816,height:1248},[Oe.Legal]:{width:816,height:1344},[Oe.Letter]:{width:816,height:1056},[Oe.Statement]:{width:528,height:816},[Oe.Tabloid]:{width:1056,height:1632}};function Ds(t,e){const{textRuns:n=[]}=e;let r=0;for(const s of n){const{ts:o={},st:i,ed:a}=s;if(o[t]==null)return ut.FALSE;switch(t){case"bl":case"it":{if(o[t]===ut.FALSE)return ut.FALSE;break}case"ul":case"st":{if(o[t].s===ut.FALSE)return ut.FALSE;break}default:throw new Error(`unknown style key: ${t} in IStyleBase`)}r+=a-i}return e.dataStream.indexOf(`\r
`)===r?ut.TRUE:ut.FALSE}const Ih=class ji{constructor(e,n,r){b(this,"_range"),b(this,"_worksheet"),this._deps=r,this._range=n,this._worksheet=e}static foreach(e,n){const{startRow:r,startColumn:s,endRow:o,endColumn:i}=e;for(let a=r;a<=o;a++)for(let l=s;l<=i;l++)n(a,l)}getRangeData(){return this._range}getValue(){return this.getValues()[0][0]}getValues(){const{startRow:e,endRow:n,startColumn:r,endColumn:s}=this._range,o=[];for(let i=e;i<=n;i++){const a=[];for(let l=r;l<=s;l++)a.push(this.getMatrix().getValue(i,l)||null);o.push(a)}return o}getMatrix(){const{startRow:e,endRow:n,startColumn:r,endColumn:s}=this._range,o=this._worksheet.getCellMatrix(),i=new De;for(let a=e;a<=n;a++)for(let l=r;l<=s;l++)i.setValue(a,l,o.getValue(a,l)||null);return i}getMatrixObject(){const{startRow:e,endRow:n,startColumn:r,endColumn:s}=this._range,o=this._worksheet.getCellMatrix(),i=new De;for(let a=e;a<=n;a++)for(let l=r;l<=s;l++)i.setValue(a-e,l-r,o.getValue(a,l)||{});return i}getA1Notation(){const{startRow:e,endRow:n,startColumn:r,endColumn:s}=this._range;let o,i;return r<s?(o=et.numToWord(r+1)+(e+1),i=et.numToWord(s+1)+(n+1)):(o=et.numToWord(s+1)+(n+1),i=et.numToWord(r+1)+(e+1)),o===i?`${o}`:`${o}:${i}`}getBackground(){return this.getBackgrounds()[0][0]}getBackgrounds(){const e=this._deps.getStyles();return this.getValues().map(n=>n.map(r=>{var s;const o=e.getStyleByCell(r);return((s=o==null?void 0:o.bg)==null?void 0:s.rgb)||fe.bg.rgb}))}getCell(e,n){const{startRow:r,startColumn:s}=this._range,o={startRow:r+e,endRow:r+e,startColumn:s+n,endColumn:s+n};return new ji(this._worksheet,o,this._deps)}getColumn(){return this._range.startColumn}getObjectValue(e={}){return this.getObjectValues(e)[0][0]}getObjectValues(e={}){var n;const{startRow:r,endRow:s,startColumn:o,endColumn:i}=this._range,a=this._worksheet.getCellMatrix().getFragment(r,s,o,i).getData();if(e.isIncludeStyle){const l=this._deps.getStyles();for(let u=0;u<=s-r;u++)for(let c=0;c<=i-o;c++){if(a==null||((n=a==null?void 0:a[u])==null?void 0:n[c])==null)continue;const d=a[u][c].s;d&&(a[u][c].s=l.get(d))}}return a}getFontColor(){return this.getFontColors()[0][0]}getFontColors(){const e=this._deps.getStyles();return this.getValues().map(n=>n.map(r=>{var s;const o=e.getStyleByCell(r);return((s=o==null?void 0:o.cl)==null?void 0:s.rgb)||fe.cl.rgb}))}getFontFamilies(){return this._getStyles("ff")}getFontFamily(){return this.getFontFamilies()[0][0]}getUnderlines(){return this._getStyles("ul")}getUnderline(){var e,n;const{p:r}=(e=this.getValue())!=null?e:{};return r&&Array.isArray((n=r.body)==null?void 0:n.textRuns)&&r.body.textRuns.length>0?Ds("ul",r.body)===ut.TRUE?{s:ut.TRUE}:{s:ut.FALSE}:this.getUnderlines()[0][0]}getOverlines(){return this._getStyles("ol")}getOverline(){return this.getOverlines()[0][0]}getStrikeThrough(){var e,n;const{p:r}=(e=this.getValue())!=null?e:{};return r&&Array.isArray((n=r.body)==null?void 0:n.textRuns)&&r.body.textRuns.length>0?Ds("st",r.body)===ut.TRUE?{s:ut.TRUE}:{s:ut.FALSE}:this.getStrikeThroughs()[0][0]}getStrikeThroughs(){return this._getStyles("st")}getFontSize(){var e,n;const r=((e=this.getValue())==null?void 0:e.p)||{};return r&&Array.isArray((n=r.body)==null?void 0:n.textRuns)&&r.body.textRuns.length>0?r.body.textRuns.some(s=>{var o;return((o=s==null?void 0:s.ts)==null?void 0:o.fs)!=null})?Math.max(...r.body.textRuns.map(s=>{var o;return((o=s==null?void 0:s.ts)==null?void 0:o.fs)||0})):this.getFontSizes()[0][0]:this.getFontSizes()[0][0]}getFontSizes(){return this._getStyles("fs")}getBorder(){return this.getBorders()[0][0]}getBorders(){return this._getStyles("bd")}getFontStyle(){var e,n;const{p:r}=(e=this.getValue())!=null?e:{};return r&&Array.isArray((n=r.body)==null?void 0:n.textRuns)&&r.body.textRuns.length>0?Ds("it",r.body)===ut.TRUE?Ri.ITALIC:Ri.NORMAL:this._getFontStyles()[0][0]}_getFontStyles(){return this._getStyles("it")}getFontWeight(){var e,n;const{p:r}=(e=this.getValue())!=null?e:{};return r&&Array.isArray((n=r.body)==null?void 0:n.textRuns)&&r.body.textRuns.length>0?Ds("bl",r.body)===ut.TRUE?Ti.BOLD:Ti.NORMAL:this._getFontWeights()[0][0]}_getFontWeights(){return this._getStyles("bl")}getGridId(){return this._worksheet.getSheetId()}getHeight(){const{_range:e,_worksheet:n}=this,{startRow:r,endRow:s}=e;let o=0;for(let i=0;i<=s-r;i++){const a=n.getRowHeight(i);o+=a}return o}getHorizontalAlignment(){return this.getHorizontalAlignments()[0][0]}getHorizontalAlignments(){return this._getStyles("ht")}getLastColumn(){return this._range.endColumn}getLastRow(){return this._range.endRow}getNumColumns(){const{startColumn:e,endColumn:n}=this._range;return n-e+1}getNumRows(){const{startRow:e,endRow:n}=this._range;return n-e+1}getRichTextValue(){return this.getRichTextValues()[0][0]}getRichTextValues(){return this.getValues().map(e=>e.map(n=>(n==null?void 0:n.p)||""))}getRowIndex(){return this._range.startRow}getSheet(){return this._worksheet}getTextDirection(){return this.getTextDirections()[0][0]}getTextDirections(){return this._getStyles("td")}getTextRotation(){return this.getTextRotations()[0][0]}getTextRotations(){return this._getStyles("tr")}getTextStyle(){return this.getTextStyles()[0][0]}getTextStyles(){const e=this._deps.getStyles();return this.getValues().map(n=>n.map(r=>e.getStyleByCell(r)))}getVerticalAlignment(){return this.getVerticalAlignments()[0][0]}getVerticalAlignments(){return this._getStyles("vt")}getWidth(){const{_range:e,_worksheet:n}=this,{startColumn:r,endColumn:s}=e;let o=0;for(let i=0;i<=s-r;i++)o+=n.getColumnWidth(i);return o}getWrap(){return this.getWrapStrategy()===_r.WRAP?ut.TRUE:ut.FALSE}getWrapStrategies(){return this._getStyles("tb")}getWrapStrategy(){return this.getWrapStrategies()[0][0]}forEach(e){ji.foreach(this._range,e)}_getStyles(e){const n=this._deps.getStyles();return this.getValues().map(r=>r.map(s=>{const o=n&&n.getStyleByCell(s);return o&&o[e]||fe[e]}))}};b(Ih,"transformRange",(t,e)=>{const n=e.getMaxColumns()-1,r=e.getMaxRows()-1;return t.rangeType===vt.ALL?{startColumn:0,startRow:0,endColumn:n,endRow:r}:t.rangeType===vt.COLUMN?{startRow:0,endRow:r,startColumn:t.startColumn,endColumn:t.endColumn}:t.rangeType===vt.ROW?{startColumn:0,endColumn:n,startRow:t.startRow,endRow:t.endRow}:{startColumn:t.startColumn,endColumn:Math.min(t.endColumn,n),startRow:t.startRow,endRow:Math.min(t.endRow,r)}});let Vi=Ih;function Sh(t,e,n=0,r=t.length-1,s=b1){for(;r>n;){if(r-n>600){const l=r-n+1,u=e-n+1,c=Math.log(l),d=.5*Math.exp(2*c/3),h=.5*Math.sqrt(c*d*(l-d)/l)*(u-l/2<0?-1:1),f=Math.max(n,Math.floor(e-u*d/l+h)),p=Math.min(r,Math.floor(e+(l-u)*d/l+h));Sh(t,e,f,p,s)}const o=t[e];let i=n,a=r;for(Lr(t,n,e),s(t[r],o)>0&&Lr(t,n,r);i<a;){for(Lr(t,i,a),i++,a--;s(t[i],o)<0;)i++;for(;s(t[a],o)>0;)a--}s(t[n],o)===0?Lr(t,n,a):(a++,Lr(t,a,r)),a<=e&&(n=a+1),e<=a&&(r=a-1)}}function Lr(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function b1(t,e){return t<e?-1:t>e?1:0}class Wi{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let n=this.data;const r=[];if(!Ns(e,n))return r;const s=this.toBBox,o=[];for(;n;){for(let i=0;i<n.children.length;i++){const a=n.children[i],l=n.leaf?s(a):a;Ns(e,l)&&(n.leaf?r.push(a):si(e,l)?this._all(a,r):o.push(a))}n=o.pop()}return r}collides(e){let n=this.data;if(!Ns(e,n))return!1;const r=[];for(;n;){for(let s=0;s<n.children.length;s++){const o=n.children[s],i=n.leaf?this.toBBox(o):o;if(Ns(e,i)){if(n.leaf||si(e,i))return!0;r.push(o)}}n=r.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let r=0;r<e.length;r++)this.insert(e[r]);return this}let n=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=n;else if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){const r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=nr([]),this}remove(e,n){if(!e)return this;let r=this.data;const s=this.toBBox(e),o=[],i=[];let a,l,u;for(;r||o.length;){if(r||(r=o.pop(),l=o[o.length-1],a=i.pop(),u=!0),r.leaf){const c=C1(e,r.children,n);if(c!==-1)return r.children.splice(c,1),o.push(r),this._condense(o),this}!u&&!r.leaf&&si(r,s)?(o.push(r),i.push(a),a=0,l=r,r=r.children[0]):l?(a++,r=l.children[a],u=!1):r=null}return this}toBBox(e){return e}compareMinX(e,n){return e.minX-n.minX}compareMinY(e,n){return e.minY-n.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,n){const r=[];for(;e;)e.leaf?n.push(...e.children):r.push(...e.children),e=r.pop();return n}_build(e,n,r,s){const o=r-n+1;let i=this._maxEntries,a;if(o<=i)return a=nr(e.slice(n,r+1)),Kn(a,this.toBBox),a;s||(s=Math.ceil(Math.log(o)/Math.log(i)),i=Math.ceil(o/Math.pow(i,s-1))),a=nr([]),a.leaf=!1,a.height=s;const l=Math.ceil(o/i),u=l*Math.ceil(Math.sqrt(i));dc(e,n,r,u,this.compareMinX);for(let c=n;c<=r;c+=u){const d=Math.min(c+u-1,r);dc(e,c,d,l,this.compareMinY);for(let h=c;h<=d;h+=l){const f=Math.min(h+l-1,d);a.children.push(this._build(e,h,f,s-1))}}return Kn(a,this.toBBox),a}_chooseSubtree(e,n,r,s){for(;s.push(n),!(n.leaf||s.length-1===r);){let o=1/0,i=1/0,a;for(let l=0;l<n.children.length;l++){const u=n.children[l],c=ri(u),d=w1(e,u)-c;d<i?(i=d,o=c<o?c:o,a=u):d===i&&c<o&&(o=c,a=u)}n=a||n.children[0]}return n}_insert(e,n,r){const s=r?e:this.toBBox(e),o=[],i=this._chooseSubtree(s,this.data,n,o);for(i.children.push(e),Zr(i,s);n>=0&&o[n].children.length>this._maxEntries;)this._split(o,n),n--;this._adjustParentBBoxes(s,o,n)}_split(e,n){const r=e[n],s=r.children.length,o=this._minEntries;this._chooseSplitAxis(r,o,s);const i=this._chooseSplitIndex(r,o,s),a=nr(r.children.splice(i,r.children.length-i));a.height=r.height,a.leaf=r.leaf,Kn(r,this.toBBox),Kn(a,this.toBBox),n?e[n-1].children.push(a):this._splitRoot(r,a)}_splitRoot(e,n){this.data=nr([e,n]),this.data.height=e.height+1,this.data.leaf=!1,Kn(this.data,this.toBBox)}_chooseSplitIndex(e,n,r){let s,o=1/0,i=1/0;for(let a=n;a<=r-n;a++){const l=Jr(e,0,a,this.toBBox),u=Jr(e,a,r,this.toBBox),c=I1(l,u),d=ri(l)+ri(u);c<o?(o=c,s=a,i=d<i?d:i):c===o&&d<i&&(i=d,s=a)}return s||r-n}_chooseSplitAxis(e,n,r){const s=e.leaf?this.compareMinX:R1,o=e.leaf?this.compareMinY:T1,i=this._allDistMargin(e,n,r,s),a=this._allDistMargin(e,n,r,o);i<a&&e.children.sort(s)}_allDistMargin(e,n,r,s){e.children.sort(s);const o=this.toBBox,i=Jr(e,0,n,o),a=Jr(e,r-n,r,o);let l=xs(i)+xs(a);for(let u=n;u<r-n;u++){const c=e.children[u];Zr(i,e.leaf?o(c):c),l+=xs(i)}for(let u=r-n-1;u>=n;u--){const c=e.children[u];Zr(a,e.leaf?o(c):c),l+=xs(a)}return l}_adjustParentBBoxes(e,n,r){for(let s=r;s>=0;s--)Zr(n[s],e)}_condense(e){for(let n=e.length-1,r;n>=0;n--)e[n].children.length===0?n>0?(r=e[n-1].children,r.splice(r.indexOf(e[n]),1)):this.clear():Kn(e[n],this.toBBox)}}function C1(t,e,n){if(!n)return e.indexOf(t);for(let r=0;r<e.length;r++)if(n(t,e[r]))return r;return-1}function Kn(t,e){Jr(t,0,t.children.length,e,t)}function Jr(t,e,n,r,s){s||(s=nr(null)),s.minX=1/0,s.minY=1/0,s.maxX=-1/0,s.maxY=-1/0;for(let o=e;o<n;o++){const i=t.children[o];Zr(s,t.leaf?r(i):i)}return s}function Zr(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function R1(t,e){return t.minX-e.minX}function T1(t,e){return t.minY-e.minY}function ri(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function xs(t){return t.maxX-t.minX+(t.maxY-t.minY)}function w1(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function I1(t,e){const n=Math.max(t.minX,e.minX),r=Math.max(t.minY,e.minY),s=Math.min(t.maxX,e.maxX),o=Math.min(t.maxY,e.maxY);return Math.max(0,s-n)*Math.max(0,o-r)}function si(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function Ns(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function nr(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function dc(t,e,n,r,s){const o=[e,n];for(;o.length;){if(n=o.pop(),e=o.pop(),n-e<=r)continue;const i=e+Math.ceil((n-e)/r/2)*r;Sh(t,i,e,n,s),o.push(e,i,i,n)}}function Bw(t,e,n,r=!1){if(e===0&&n===0)return t;let s={...t};const o=s.startAbsoluteRefType||Lt.NONE,i=s.endAbsoluteRefType||Lt.NONE,a=s.rangeType||vt.NORMAL;if(!r&&o===Lt.ALL&&i===Lt.ALL)return s;const l=hc(s.startRow,n,s.startColumn,e,a),u=hc(s.endRow,n,s.endColumn,e,a);return r||o===Lt.NONE&&i===Lt.NONE?s={...s,startRow:l.row,startColumn:l.column,endRow:u.row,endColumn:u.column}:(o===Lt.NONE?s={...s,startRow:l.row,startColumn:l.column}:o===Lt.COLUMN?s={...s,startRow:l.row}:o===Lt.ROW&&(s={...s,startColumn:l.column}),i===Lt.NONE?s={...s,endRow:u.row,endColumn:u.column}:i===Lt.COLUMN?s={...s,endRow:u.row}:i===Lt.ROW&&(s={...s,endColumn:u.column}),s)}function hc(t,e,n,r,s){return s===vt.NORMAL?{row:t+e,column:n+r}:s===vt.ROW?{row:t+e,column:n}:s===vt.COLUMN?{row:t,column:n+r}:{row:t,column:n}}function Ah(t){const e=new Set,n=new Set;for(const i of t)e.add(i.startColumn),e.add(i.endColumn+1),n.add(i.startRow),n.add(i.endRow+1);const r=Array.from(e).sort((i,a)=>i-a),s=Array.from(n).sort((i,a)=>i-a);t.sort((i,a)=>i.startRow-a.startRow||i.startColumn-a.startColumn);const o=[];for(let i=0;i<s.length-1;i++)for(let a=0;a<r.length-1;a++){const l=r[a],u=r[a+1]-1,c=s[i],d=s[i+1]-1;for(const h of t){if(h.startRow>d)break;if(h.startRow<=c&&h.endRow>=d&&h.startColumn<=l&&h.endColumn>=u){o.push({startColumn:l,endColumn:u,startRow:c,endRow:d});break}}}return o}function S1(t){t.sort((r,s)=>r.startRow-s.startRow||r.startColumn-s.startColumn);const e={};for(const r of t)e[r.startRow]||(e[r.startRow]=[]),e[r.startRow].push(r);const n=[];for(const r in e){const s=e[+r];s.sort((i,a)=>i.startColumn-a.startColumn);let o=s[0];for(let i=1;i<s.length;i++){const a=s[i];a.startColumn<=o.endColumn+1&&a.startRow===o.startRow&&a.endRow===o.endRow?o.endColumn=Math.max(o.endColumn,a.endColumn):(n.push(o),o=a)}n.push(o)}return n}function A1(t){t.sort((r,s)=>r.startColumn-s.startColumn||r.startRow-s.startRow);const e={};for(const r of t)e[r.startColumn]||(e[r.startColumn]=[]),e[r.startColumn].push(r);const n=[];for(const r in e){const s=e[+r];s.sort((i,a)=>i.startRow-a.startRow);let o=s[0];for(let i=1;i<s.length;i++){const a=s[i];a.startRow<=o.endRow+1&&a.startColumn===o.startColumn&&a.endColumn===o.endColumn?o.endRow=Math.max(o.endRow,a.endRow):(n.push(o),o=a)}n.push(o)}return n}function O1(t){const e=Ah(t),n=S1(e);return A1(n)}function D1(t,e){const n=[];return t.forEach(r=>{n.push(...as.subtract(r,e))}),as.mergeRanges(n)}function x1(t,e){const n=fc(t.startRow,t.endRow,e.startRow,e.endRow),r=fc(t.startColumn,t.endColumn,e.startColumn,e.endColumn);if(!n||!r)return null;const[s,o]=n,[i,a]=r,l=N1(t.rangeType,e.rangeType,s,o,i,a);return{startRow:s,endRow:o,startColumn:i,endColumn:a,rangeType:l}}function fc(t,e,n,r){const s=isNaN(t)?-1/0:t,o=isNaN(e)?1/0:e,i=isNaN(n)?-1/0:n,a=isNaN(r)?1/0:r,l=Math.max(s,i),u=Math.min(o,a);if(l<=u){const c=l===-1/0?Number.NaN:l,d=u===1/0?Number.NaN:u;return[c,d]}else return null}function N1(t,e,n,r,s,o){const i=t!==void 0?t:pc(n,r,s,o),a=e!==void 0?e:pc(n,r,s,o);return i===vt.ALL||a===vt.ALL?i===a?i:i===vt.ALL?a:i:i===a?i:(i===vt.NORMAL||vt.NORMAL,vt.NORMAL)}function pc(t,e,n,r){const s=!isNaN(t)&&!isNaN(e),o=!isNaN(n)&&!isNaN(r);return s&&o?vt.NORMAL:s?vt.ROW:o?vt.COLUMN:vt.ALL}const rr=class Gi{static clone(e){return e.rangeType!==void 0?{startRow:e.startRow,startColumn:e.startColumn,endRow:e.endRow,endColumn:e.endColumn,rangeType:e.rangeType}:{startRow:e.startRow,startColumn:e.startColumn,endRow:e.endRow,endColumn:e.endColumn}}static equals(e,n){return e==null||n==null?!1:e.endRow===n.endRow&&e.endColumn===n.endColumn&&e.startRow===n.startRow&&e.startColumn===n.startColumn&&(e.rangeType===n.rangeType||e.rangeType===void 0&&n.rangeType===vt.NORMAL||n.rangeType===void 0&&e.rangeType===vt.NORMAL)}static simpleRangesIntersect(e,n){const{startRow:r,endRow:s,startColumn:o,endColumn:i}=e,{startRow:a,endRow:l,startColumn:u,endColumn:c}=n,d=r<=l&&s>=a,h=o<=c&&i>=u;return d&&h}static intersects(e,n){if(e.rangeType===vt.ROW&&n.rangeType===vt.COLUMN||e.rangeType===vt.COLUMN&&n.rangeType===vt.ROW)return!0;if(e.rangeType===vt.ROW&&n.rangeType===vt.ROW)return e.startRow<=n.endRow&&e.endRow>=n.startRow;if(e.rangeType===vt.COLUMN&&n.rangeType===vt.COLUMN)return e.startColumn<=n.endColumn&&e.endColumn>=n.startColumn;const r=Math.floor(Number.MAX_SAFE_INTEGER/10),s=Number.isNaN(e.startRow)?0:e.startRow,o=Number.isNaN(e.endRow)?r:e.endRow,i=Number.isNaN(e.startColumn)?0:e.startColumn,a=Number.isNaN(e.endColumn)?r:e.endColumn,l=Number.isNaN(n.startRow)?0:n.startRow,u=Number.isNaN(n.endRow)?r:n.endRow,c=Number.isNaN(n.startColumn)?0:n.startColumn,d=Number.isNaN(n.endColumn)?r:n.endColumn,h=Math.abs(i+a-c-d),f=Math.abs(i-a)+Math.abs(c-d),p=Math.abs(s+o-l-u),g=Math.abs(s-o)+Math.abs(l-u);return h<=f&&p<=g}static doAnyRangesIntersect(e,n){const r=new Wi;return r.load(e.map(s=>({minX:s.startColumn,minY:s.startRow,maxX:s.endColumn,maxY:s.endRow}))),n.some(s=>r.search({minX:s.startColumn,minY:s.startRow,maxX:s.endColumn,maxY:s.endRow}).length>0)}static getIntersects(e,n){const r=e.startRow,s=e.endRow,o=e.startColumn,i=e.endColumn,a=n.startRow,l=n.endRow,u=n.startColumn,c=n.endColumn;let d,h,f,p;if(a<=s)a>=r?h=a:h=r;else return null;if(l>=r)l>=s?p=s:p=l;else return null;if(u<=i)u>o?d=u:d=o;else return null;if(c>=o)c>=i?f=i:f=c;else return null;return{startRow:h,endRow:p,startColumn:d,endColumn:f,rangeType:vt.NORMAL}}static contains(e,n){return e.startRow<=n.startRow&&e.endRow>=n.endRow&&e.startColumn<=n.startColumn&&e.endColumn>=n.endColumn}static realContain(e,n){return Gi.contains(e,n)&&(e.startRow<n.startRow||e.endRow>n.endRow||e.startColumn<n.startColumn||e.endColumn>n.endColumn)}static union(...e){return e.reduce((n,r)=>({startRow:Math.min(n.startRow,r.startRow),startColumn:Math.min(n.startColumn,r.startColumn),endRow:Math.max(n.endRow,r.endRow),endColumn:Math.max(n.endColumn,r.endColumn),rangeType:vt.NORMAL}),e[0])}static realUnion(...e){const n=e.some(o=>o.rangeType===vt.COLUMN),r=e.some(o=>o.rangeType===vt.ROW),s=Gi.union(...e);return{startColumn:r?Number.NaN:s.startColumn,endColumn:r?Number.NaN:s.endColumn,startRow:n?Number.NaN:s.startRow,endRow:n?Number.NaN:s.endRow,rangeType:r?vt.ROW:n?vt.COLUMN:vt.NORMAL}}static subtract(e,n){if(n.startRow>e.endRow||n.endRow<e.startRow||n.startColumn>e.endColumn||n.endColumn<e.startColumn)return[e];const r=[];n.startRow>=e.startRow&&r.push({startRow:e.startRow,startColumn:e.startColumn,endRow:n.startRow-1,endColumn:e.endColumn}),n.endRow<=e.endRow&&r.push({startRow:n.endRow+1,startColumn:e.startColumn,endRow:e.endRow,endColumn:e.endColumn});const s=Math.max(e.startRow,n.startRow),o=Math.min(e.endRow,n.endRow);return n.startColumn>=e.startColumn&&r.push({startRow:s,startColumn:e.startColumn,endRow:o,endColumn:n.startColumn-1}),n.endColumn<=e.endColumn&&r.push({startRow:s,startColumn:n.endColumn+1,endRow:o,endColumn:e.endColumn}),r.filter(i=>i.startRow<=i.endRow&&i.startColumn<=i.endColumn)}static mergeRanges(e){return O1(e)}static splitIntoGrid(e){return Ah(e)}static subtractMulti(e,n){if(!n.length)return e;let r=e;return n.forEach(s=>{r=D1(r,s)}),r}static hasIntersectionBetweenTwoRect(e,n){return!(e.left>n.right||e.right<n.left||e.top>n.bottom||e.bottom<n.top)}static getIntersectionBetweenTwoRect(e,n){const r=Math.max(e.left,n.left),s=Math.min(e.right,n.right),o=Math.max(e.top,n.top),i=Math.min(e.bottom,n.bottom);return s<=r||i<=o?null:{left:r,right:s,top:o,bottom:i,width:s-r,height:i-o}}static sort(e){return e.sort((n,r)=>n.startRow-r.startRow||n.startColumn-r.startColumn)}};b(rr,"getRelativeRange",(t,e)=>({startRow:t.startRow-e.startRow,endRow:t.endRow-t.startRow,startColumn:t.startColumn-e.startColumn,endColumn:t.endColumn-t.startColumn})),b(rr,"getPositionRange",(t,e,n)=>({...n||{},startRow:n&&[Lt.ROW,Lt.ALL].includes(n.startAbsoluteRefType||0)?n.startRow:t.startRow+e.startRow,endRow:n&&[Lt.ROW,Lt.ALL].includes(n.endAbsoluteRefType||0)?n.endRow:t.endRow+t.startRow+e.startRow,startColumn:n&&[Lt.COLUMN,Lt.ALL].includes(n.startAbsoluteRefType||0)?n.startColumn:t.startColumn+e.startColumn,endColumn:n&&[Lt.COLUMN,Lt.ALL].includes(n.endAbsoluteRefType||0)?n.endColumn:t.endColumn+t.startColumn+e.startColumn})),b(rr,"moveHorizontal",(t,e=0,n=0)=>({...t,startColumn:t.startColumn+e,endColumn:t.endColumn+e+n})),b(rr,"moveVertical",(t,e=0,n=0)=>({...t,startRow:t.startRow+e,endRow:t.endRow+e+n})),b(rr,"moveOffset",(t,e,n)=>{const r={...t};switch(t.startAbsoluteRefType){case Lt.ROW:r.startColumn+=e;break;case Lt.COLUMN:r.startRow+=n;break;case Lt.ALL:break;case Lt.NONE:default:r.startRow+=n,r.startColumn+=e;break}switch(t.endAbsoluteRefType){case Lt.ROW:r.endColumn+=e;break;case Lt.COLUMN:r.endRow+=n;break;case Lt.ALL:break;case Lt.NONE:default:r.endRow+=n,r.endColumn+=e;break}return r});let as=rr;function M1(t,e){if(t.length===0||t[0].length===0)return null;const n=new Array(t[0].length).fill(0);let r=0,s=null;for(let o=0;o<t.length;o++){for(let a=0;a<t[0].length;a++)n[a]=e(t[o][a])?n[a]+1:0;const i=L1(n);i.area>r&&(r=i.area,s={startColumn:i.start,startRow:o-i.height+1,endColumn:i.end,endRow:o})}return s}function L1(t){const e=[];let n=0,r={area:0,height:0,start:0,end:0},s=0;for(;s<t.length;)if(e.length===0||t[s]>=t[e[e.length-1]])e.push(s++);else{const o=t[e.pop()],i=e.length===0?s:s-e[e.length-1]-1;o*i>n&&(n=o*i,r={area:n,height:o,start:e.length===0?0:e[e.length-1]+1,end:s-1})}for(;e.length>0;){const o=t[e.pop()],i=e.length===0?s:s-e[e.length-1]-1;o*i>n&&(n=o*i,r={area:n,height:o,start:e.length===0?0:e[e.length-1]+1,end:s-1})}return r}function F1(t,e){Vi.foreach(e,(n,r)=>{t[n][r]=void 0})}function $w(t,e){const n=t.toFullArray(),r=[];for(;;){const s=M1(n,e);if(!s)break;r.push(s),F1(n,s)}return r}class Hw{constructor(e,n){b(this,"_values",[]),b(this,"_keys",[]),b(this,"_keyMaps",new Map),this._values=e,this._keys=n,e.forEach(r=>{this._initKeyMap(r)})}_initKeyMap(e){this._keys.forEach(n=>{const r=e[n],s=this._keyMaps.get(n)||new Map;s.set(r,e),this._keyMaps.set(n,s)})}getValue(e,n){const r=n||this._keys;for(let s=0;s<r.length;s++){const o=this._keyMaps.get(r[s]);if(o!=null&&o.has(e))return o.get(e)}return null}hasValue(e){for(let n=0;n<this._keys.length;n++){const r=this._keyMaps.get(this._keys[n]);if(r!=null&&r.has(e))return!0}return!1}addValue(e){this._values.push(e),this._initKeyMap(e)}setValue(e,n,r){const s=this.getValue(e);s&&Object.keys(s).includes(n)&&(s[n]=r)}deleteValue(e,n){const r=this.getValue(e,n);if(r){this._keys.forEach(o=>{const i=this._keyMaps.get(o),a=r[o];i==null||i.delete(a)});const s=this._values.findIndex(o=>o===r);this._values.splice(s,1)}}getValues(){return this._values}getKeyMap(e){var n;return[...((n=this._keyMaps.get(e))==null?void 0:n.keys())||[]]}clear(){this._values=[],this._keys=[],this._keyMaps.clear()}}function gc(t,e,n,r){return{forEach(s){for(let o=t;o<=e;o++)for(let i=n;i<=r;i++)s(o,i)}}}function jw(t){if(t==null||t.length===0)return Number.NaN;const e=t.toLowerCase().split(""),n=e.length,r=i=>i.charCodeAt(0)-96;let s=0,o=0;for(let i=0;i<n;i++)o=r(e[i]),s+=o*26**(n-i-1);return s===0?Number.NaN:s-1}const so=65,Oh=90,k1=97;function Vw(t){const e=Oh-so+1;let n="";for(;t>=0;)n=String.fromCharCode(t%e+so)+n,t=Math.floor(t/e)-1;return n}function P1(t,e){let n="";for(;e>0;)n+=t,e--;return n}function Ww(t,e=!1){const n=Oh-so+1;let r=k1;e&&(r=so);const s=String.fromCharCode(t%n+r),o=Math.floor(t/n)+1;return P1(s,o)}function Gw(t,e){return t.zIndex>e.zIndex?1:t.zIndex===e.zIndex?0:-1}function Yw(t,e){return t.zIndex>e.zIndex?-1:t.zIndex===e.zIndex?0:1}function So(t="index",e=1){return(n,r)=>n[t]>r[t]?e:n[t]===r[t]?0:-e}function Ao(t,e=!1){const n=[];for(const r of t){const{st:s,ed:o,ts:i}=r;if(r.sId===void 0&&delete r.sId,s===o||!e&&et.isEmptyObject(i)&&r.sId==null)continue;if(n.length===0){n.push(r);continue}const a=n.pop();kv(r,a)&&et.hasIntersectionBetweenTwoRanges(a.st,a.ed,r.st,r.ed)?n.push({...r,st:a.st,ed:o}):n.push(a,r)}return n}function Dh(t,e,n,r){var s;const{textRuns:o}=t;if(o==null)return;const i=[],a=o.length;let l=!1;const u=(s=e.textRuns)!=null?s:[];if(u.length)for(const c of u)c.st+=r,c.ed+=r;for(let c=0;c<a;c++){const d=o[c],{st:h,ed:f}=d;if(f<=r)i.push(d);else if(r>h&&r<f){l=!0;const p={...d,ed:r};i.push(p),u.length&&i.push(...u);const g={...d,st:r+n,ed:f+n};i.push(g)}else d.st+=n,d.ed+=n,l||(l=!0,i.push(...u)),i.push(d)}l||(l=!0,i.push(...u)),t.textRuns=Ao(i)}function xh(t,e,n,r){const{paragraphs:s}=t;if(s==null)return;const{paragraphs:o}=e,i=[];for(let l=0,u=s.length;l<u;l++){const c=s[l],{startIndex:d}=c;d>=r&&(c.startIndex+=n),i.push(c.startIndex)}let a=-1;if(o){for(let l=0,u=o.length;l<u;l++){const c=o[l];c.startIndex+=r;const d=c.startIndex;a=i.indexOf(d)}a!==-1&&s.splice(a,1),s.push(...o),s.sort(So("startIndex"))}}function Nh(t,e,n,r){const{sectionBreaks:s}=t;if(s==null)return;for(let i=0,a=s.length;i<a;i++){const l=s[i],{startIndex:u}=l;u>=r&&(l.startIndex+=n)}const o=e.sectionBreaks;if(o){for(let i=0,a=o.length;i<a;i++){const l=o[i];l.startIndex+=r}s.push(...o),s.sort(So("startIndex"))}}function Mh(t,e,n,r){const{customBlocks:s=[]}=t;for(let i=0,a=s.length;i<a;i++){const l=s[i],{startIndex:u}=l;u>=r&&(l.startIndex+=n)}const o=e.customBlocks;if(o){for(let i=0,a=o.length;i<a;i++){const l=o[i];l.startIndex+=r}s.push(...o),s.sort(So("startIndex"))}s.length&&!t.customBlocks&&(t.customBlocks=s)}function Lh(t,e,n,r){const{tables:s}=t;if(s==null)return;for(let i=0,a=s.length;i<a;i++){const l=s[i],{startIndex:u,endIndex:c}=l;u>r?(l.startIndex+=n,l.endIndex+=n):c>r&&(l.endIndex+=n)}const o=e.tables;if(o){for(let i=0,a=o.length;i<a;i++){const l=o[i];l.startIndex+=r,l.endIndex+=r}s.push(...o),s.sort(So("startIndex"))}}const Fh="$",mc=t=>t.split(Fh)[0];function yl(t){if(t.length<=1)return t;t.sort((s,o)=>s.startIndex-o.startIndex);const e=[];let n={...t[0]};n.rangeId=mc(n.rangeId);for(let s=1;s<t.length;s++){const o=t[s];o.rangeId=mc(o.rangeId),o.rangeId===n.rangeId&&Lg(n.properties,o.properties)&&n.endIndex+1>=o.startIndex?n.endIndex=o.endIndex:(e.push(n),n={...o})}e.push(n);const r=Object.create(null);for(let s=0,o=e.length;s<o;s++){const i=e[s],a=i.rangeId;r[a]?(i.rangeId=`${a}${Fh}${r[a]}`,r[a]=r[a]+1):r[a]=1}return e}function Yi(t,e){const n=t.findIndex(s=>s.startIndex<e&&s.endIndex>=e),r=t[n];r&&t.splice(n,1,{rangeId:r.rangeId,rangeType:r.rangeType,startIndex:r.startIndex,endIndex:e-1,properties:{...r.properties}},{rangeId:r.rangeId,rangeType:r.rangeType,startIndex:e,endIndex:r.endIndex,properties:{...r.properties}})}function kh(t){if(t.length<=1)return t;t.sort((r,s)=>r.startIndex-s.startIndex);const e=[];let n={...t[0]};for(let r=1;r<t.length;r++){const s=t[r];s.id===n.id&&n.endIndex+1>=s.startIndex?n.endIndex=s.endIndex:(e.push(n),n={...s})}return e.push(n),e}function zi(t,e){t.filter(n=>n.startIndex<e&&n.endIndex>=e).forEach(n=>{const r=t.indexOf(n);t.splice(r,1,{id:n.id,type:n.type,startIndex:n.startIndex,endIndex:e-1},{id:n.id,type:n.type,startIndex:e,endIndex:n.endIndex})})}function U1(t,e,n,r){t.customRanges||(t.customRanges=[]);const{customRanges:s}=t;Yi(s,r);for(let i=0,a=s.length;i<a;i++){const l=s[i],{startIndex:u}=l;u>=r&&(l.startIndex+=n,l.endIndex+=n)}const o=[];if(e.customRanges){for(let i=0,a=e.customRanges.length;i<a;i++){const l=e.customRanges[i];l.startIndex+=r,l.endIndex+=r,o.push(l)}s.push(...o)}t.customRanges=yl(s)}function B1(t,e,n,r){t.customDecorations||(t.customDecorations=[]);const{customDecorations:s}=t;zi(s,r);for(let i=0,a=s.length;i<a;i++){const l=s[i],{startIndex:u}=l;u>=r&&(l.startIndex+=n,l.endIndex+=n)}const o=[];if(e.customDecorations){for(let i=0,a=e.customDecorations.length;i<a;i++){const l=e.customDecorations[i];l.startIndex+=r,l.endIndex+=r,o.push(l)}s.push(...o)}t.customDecorations=kh(s)}function Ph(t,e,n){const{textRuns:r}=t,s=n,o=n+e,i=[];if(r){const a=[];for(let l=0,u=r.length;l<u;l++){const c=r[l],{st:d,ed:h}=c;if(s<=d&&o>=h){i.push({...c,st:d-s,ed:h-s});continue}else d<=s&&h>=o?(i.push({...c,st:s-s,ed:o-s}),c.ed-=e):s>=d&&s<h?(i.push({...c,st:s-s,ed:h-s}),c.ed=s):o>d&&o<=h?(i.push({...c,st:d-s,ed:o-s}),c.st=o-e,c.ed-=e):d>=o&&(c.st-=e,c.ed-=e);a.push(c)}t.textRuns=a}return i.length===0&&i.push({st:0,ed:e,ts:{}}),i}function Uh(t,e,n){const{paragraphs:r}=t,s=n,o=n+e,i=[];if(r){const a=[];for(let l=0,u=r.length;l<u;l++){const c=r[l],{startIndex:d}=c;if(d>=s&&d<o){i.push({...c,startIndex:d-n});continue}else d>=o&&(c.startIndex-=e);a.push(c)}t.paragraphs=a}return i}function Bh(t,e,n){const{sectionBreaks:r}=t,s=n,o=n+e-1,i=[];if(r){const a=[];for(let l=0,u=r.length;l<u;l++){const c=r[l],{startIndex:d}=c;if(d>=s&&d<=o){i.push({...c,startIndex:d-n});continue}else d>o&&(c.startIndex-=e);a.push(c)}t.sectionBreaks=a}return i}function $h(t,e,n){const{customBlocks:r=[]}=t,s=n,o=n+e-1,i=[];if(r){const a=[];for(let l=0,u=r.length;l<u;l++){const c=r[l],{startIndex:d}=c;if(d>=s&&d<=o){i.push({...c,startIndex:d-n});continue}else d>o&&(c.startIndex-=e);a.push(c)}t.customBlocks=a}return r.length&&!t.customBlocks&&(t.customBlocks=r),i}function Hh(t,e,n){const{tables:r}=t,s=n,o=n+e-1,i=[];if(r){const a=[];for(let l=0,u=r.length;l<u;l++){const c=r[l],{startIndex:d,endIndex:h}=c;if(s<=d&&o>=h){i.push({...c,startIndex:d-n,endIndex:h-n});continue}else if(d<=s&&h>=o){const f=Ua(d,h,s,o);if(f.length===0||(c.startIndex=f[0],c.endIndex=f[1],c.startIndex===c.endIndex))continue}else o<d&&(c.startIndex-=e,c.endIndex-=e);a.push(c)}t.tables=a}return i}function $1(t,e,n){const{customRanges:r}=t,s=n,o=n+e-1,i=[];if(r){const a=[];for(let l=0,u=r.length;l<u;l++){const c=r[l],{startIndex:d,endIndex:h}=c;if(d>=s&&h<=o){i.push(c);continue}else if(Math.max(s,d)<=Math.min(o,h)){const f=Ua(d,h,s,o);if(f.length===0)continue;c.startIndex=f[0],c.endIndex=f[1]}else o<d&&(c.startIndex-=e,c.endIndex-=e);a.push(c)}t.customRanges=yl(a)}return i}function H1(t,e,n,r=!0){const{customDecorations:s}=t,o=n,i=n+e-1,a=[];if(s){const l=[];for(let u=0,c=s.length;u<c;u++){const d=s[u],{startIndex:h,endIndex:f}=d;if(h>=o&&f<=i){a.push(d);continue}else if(Math.max(o,h)<=Math.min(i,f)){const p=Ua(h,f,o,i);if(p.length===0)continue;d.startIndex=p[0],d.endIndex=p[1]}else i<h&&r&&(d.startIndex-=e,d.endIndex-=e);l.push(d)}t.customDecorations=l}return a}var j1=(t=>(t.ORDER_LIST_QUICK_1="1.",t.ORDER_LIST_QUICK_2="a)",t.ORDER_LIST_QUICK_3="a.",t.ORDER_LIST_QUICK_4="i.",t.ORDER_LIST_QUICK_5="A.",t.ORDER_LIST_QUICK_6="I.",t.ORDER_LIST_QUICK_7="01.",t.BULLET_LIST="*",t))(j1||{}),dn=(t=>(t.BULLET_LIST="BULLET_LIST",t.BULLET_LIST_1="BULLET_LIST_1",t.BULLET_LIST_2="BULLET_LIST_2",t.BULLET_LIST_3="BULLET_LIST_3",t.BULLET_LIST_4="BULLET_LIST_4",t.BULLET_LIST_5="BULLET_LIST_5",t.ORDER_LIST="ORDER_LIST",t.ORDER_LIST_1="ORDER_LIST_1",t.ORDER_LIST_2="ORDER_LIST_2",t.ORDER_LIST_3="ORDER_LIST_3",t.ORDER_LIST_4="ORDER_LIST_4",t.ORDER_LIST_5="ORDER_LIST_5",t.ORDER_LIST_QUICK_2="ORDER_LIST_QUICK_2",t.ORDER_LIST_QUICK_3="ORDER_LIST_QUICK_3",t.ORDER_LIST_QUICK_4="ORDER_LIST_QUICK_4",t.ORDER_LIST_QUICK_5="ORDER_LIST_QUICK_5",t.ORDER_LIST_QUICK_6="ORDER_LIST_QUICK_6",t.CHECK_LIST="CHECK_LIST",t.CHECK_LIST_CHECKED="CHECK_LIST_CHECKED",t))(dn||{});const Ms={"a)":{glyphFormat:"%1)",glyphType:_t.DECIMAL},"1.":{glyphType:_t.DECIMAL},"a.":{glyphFormat:"%1.",glyphType:_t.LOWER_LETTER},"A.":{glyphType:_t.UPPER_LETTER},"i.":{glyphFormat:"%1.",glyphType:_t.LOWER_ROMAN},"I.":{glyphFormat:"%1.",glyphType:_t.UPPER_LETTER}},Xn=t=>[...t,...t,...t].map((e,n)=>({glyphFormat:` %${n+1}`,glyphSymbol:e,bulletAlignment:bo.START,textStyle:{fs:12},startNumber:0,paragraphProperties:{hanging:{v:21},indentStart:{v:21*n}}})),Jn=t=>t.map((e,n)=>({...e,bulletAlignment:bo.START,textStyle:{fs:12},startNumber:0,paragraphProperties:{hanging:{v:21},indentStart:{v:21*n}}})),_c=(t,e)=>new Array(9).fill(0).map((n,r)=>({glyphFormat:` %${r+1}`,glyphSymbol:t,bulletAlignment:bo.START,textStyle:{fs:16},startNumber:0,paragraphProperties:{hanging:{v:21},indentStart:{v:21*r},textStyle:e}})),Oo={BULLET_LIST:{listType:"BULLET_LIST",nestingLevel:Xn(["","",""])},BULLET_LIST_1:{listType:"BULLET_LIST",nestingLevel:Xn(["","",""])},BULLET_LIST_2:{listType:"BULLET_LIST",nestingLevel:Xn(["","",""])},BULLET_LIST_3:{listType:"BULLET_LIST",nestingLevel:Xn(["","",""])},BULLET_LIST_4:{listType:"BULLET_LIST",nestingLevel:Xn(["","",""])},BULLET_LIST_5:{listType:"BULLET_LIST",nestingLevel:Xn(["","",""])},ORDER_LIST:{listType:"ORDER_LIST",nestingLevel:Jn([{glyphFormat:"%1.",glyphType:_t.DECIMAL},{glyphFormat:"%2.",glyphType:_t.LOWER_LETTER},{glyphFormat:"%3.",glyphType:_t.LOWER_ROMAN},{glyphFormat:"%4.",glyphType:_t.DECIMAL},{glyphFormat:"%5.",glyphType:_t.LOWER_LETTER},{glyphFormat:"%6.",glyphType:_t.LOWER_ROMAN},{glyphFormat:"%7.",glyphType:_t.DECIMAL},{glyphFormat:"%8.",glyphType:_t.LOWER_LETTER},{glyphFormat:"%9.",glyphType:_t.LOWER_ROMAN}])},ORDER_LIST_1:{listType:"ORDER_LIST",nestingLevel:Jn([{glyphFormat:"%1)",glyphType:_t.DECIMAL},{glyphFormat:"%2)",glyphType:_t.LOWER_LETTER},{glyphFormat:"%3)",glyphType:_t.LOWER_ROMAN},{glyphFormat:"%4)",glyphType:_t.DECIMAL},{glyphFormat:"%5)",glyphType:_t.LOWER_LETTER},{glyphFormat:"%6)",glyphType:_t.LOWER_ROMAN},{glyphFormat:"%7)",glyphType:_t.DECIMAL},{glyphFormat:"%8)",glyphType:_t.LOWER_LETTER},{glyphFormat:"%9)",glyphType:_t.LOWER_ROMAN}])},ORDER_LIST_2:{listType:"ORDER_LIST",nestingLevel:Jn(["%1.","%1.%2.","%1.%2.%3.","%1.%2.%3.%4.","%1.%2.%3.%4.%5.","%1.%2.%3.%4.%5.%6.","%1.%2.%3.%4.%5.%6.%7."].map(t=>({glyphFormat:t,glyphType:_t.DECIMAL})))},ORDER_LIST_3:{listType:"ORDER_LIST",nestingLevel:Jn([{glyphFormat:"%1.",glyphType:_t.UPPER_LETTER},{glyphFormat:"%2.",glyphType:_t.LOWER_LETTER},{glyphFormat:"%3.",glyphType:_t.LOWER_ROMAN},{glyphFormat:"%4.",glyphType:_t.UPPER_LETTER},{glyphFormat:"%5.",glyphType:_t.LOWER_LETTER},{glyphFormat:"%6.",glyphType:_t.LOWER_ROMAN},{glyphFormat:"%7.",glyphType:_t.UPPER_LETTER},{glyphFormat:"%8.",glyphType:_t.LOWER_LETTER},{glyphFormat:"%9.",glyphType:_t.LOWER_ROMAN}])},ORDER_LIST_4:{listType:"ORDER_LIST",nestingLevel:Jn([{glyphFormat:"%1.",glyphType:_t.UPPER_LETTER},{glyphFormat:"%2.",glyphType:_t.DECIMAL},{glyphFormat:"%3.",glyphType:_t.LOWER_ROMAN},{glyphFormat:"%4.",glyphType:_t.UPPER_LETTER},{glyphFormat:"%5.",glyphType:_t.DECIMAL},{glyphFormat:"%6.",glyphType:_t.LOWER_ROMAN},{glyphFormat:"%7.",glyphType:_t.UPPER_LETTER},{glyphFormat:"%8.",glyphType:_t.DECIMAL},{glyphFormat:"%9.",glyphType:_t.LOWER_ROMAN}])},ORDER_LIST_5:{listType:"ORDER_LIST",nestingLevel:Jn([{glyphFormat:"%1.",glyphType:_t.DECIMAL_ZERO},{glyphFormat:"%2.",glyphType:_t.LOWER_LETTER},{glyphFormat:"%3.",glyphType:_t.LOWER_ROMAN},{glyphFormat:"%4.",glyphType:_t.DECIMAL_ZERO},{glyphFormat:"%5.",glyphType:_t.LOWER_LETTER},{glyphFormat:"%6.",glyphType:_t.LOWER_ROMAN},{glyphFormat:"%7.",glyphType:_t.DECIMAL_ZERO},{glyphFormat:"%8.",glyphType:_t.LOWER_LETTER},{glyphFormat:"%9.",glyphType:_t.LOWER_ROMAN}])},CHECK_LIST:{listType:"CHECK_LIST",nestingLevel:_c("")},CHECK_LIST_CHECKED:{listType:"CHECK_LIST_CHECKED",nestingLevel:_c("",{st:{s:ut.TRUE}})}},Ls=t=>{const{glyphFormat:e,glyphType:n}=t,r=et.deepClone(Oo.ORDER_LIST);return r.nestingLevel[0].glyphFormat=e,r.nestingLevel[0].glyphType=n,r},V1={ORDER_LIST_QUICK_2:Ls(Ms["a)"]),ORDER_LIST_QUICK_3:Ls(Ms["a."]),ORDER_LIST_QUICK_4:Ls(Ms["i."]),ORDER_LIST_QUICK_6:Ls(Ms["I."])};Object.assign(Oo,V1);const zw={"1.":"ORDER_LIST","a)":"ORDER_LIST_QUICK_2","a.":"ORDER_LIST_QUICK_3","i.":"ORDER_LIST_QUICK_4","A.":"ORDER_LIST_3","I.":"ORDER_LIST_QUICK_6","01.":"ORDER_LIST_5","*":"BULLET_LIST"};function W1(t,e,n,r,s){const o=G1(t,e,n,r,s),i=Y1(t,e,n,r,s),a=z1(t,e,n,r,s),l=K1(t,e,n,r,s),u=X1(t,e,n,r,s),c=J1(t,e,n,r),d=Z1(t,e,n,r,s);return{dataStream:"",textRuns:o,paragraphs:i,sectionBreaks:a,customBlocks:l,tables:u,customRanges:c,customDecorations:d}}function G1(t,e,n,r,s){const{textRuns:o}=t,{textRuns:i}=e;if(o==null||i==null)return;const a=Ph(t,n,r);if(s!==Et.REPLACE){const l=jh(i,a,s);e.textRuns=l}return Dh(t,e,n,r),a}function jh(t,e,n){if(e.length===0)return t;t=et.deepClone(t),e=et.deepClone(e);const r=[],s=t.length,o=e.length;let i=0,a=0,l=null;function u(){return l?(r.push(l),l=null,!0):!1}for(;i<s&&a<o;){const{st:f,ed:p,ts:g}=t[i],{st:_,ed:I,ts:U,sId:L}=e[a];let B;if(n===Et.COVER?B={...U,...g}:B={...g},p<_)u()||r.push(t[i]),i++;else if(I<f)u()||r.push(e[a]),a++;else{const C={st:Math.min(f,_),ed:Math.max(f,_),ts:f<_?{...g}:{...U},sId:f<_?void 0:L};C.ed>C.st&&r.push(C),r.push({st:Math.max(f,_),ed:Math.min(p,I),ts:B,sId:L}),p<I?(i++,e[a].st=p,e[a].st===e[a].ed&&a++):(a++,t[i].st=I,t[i].st===t[i].ed&&i++);const R={st:Math.min(p,I),ed:Math.max(p,I),ts:p<I?{...U}:{...g},sId:p<I?L:void 0};l=R.ed>R.st?R:null}}u();const c=r[r.length-1],d=t[s-1],h=e[o-1];return c&&c.ed!==Math.max(d.ed,h.ed)&&(d.ed>h.ed?r.push(d):r.push(h)),Ao(r)}function Y1(t,e,n,r,s){const{paragraphs:o}=t,{paragraphs:i}=e;if(o==null||i==null)return;const a=Uh(t,n,r);if(s!==Et.REPLACE){const l=[];for(const u of i){const{startIndex:c,paragraphStyle:d,bullet:h}=u;let f=[];for(const p of a){const{startIndex:g,paragraphStyle:_,bullet:I}=p;let U,L;if(s===Et.COVER?(U={..._,...d},L={listId:"",listType:dn.BULLET_LIST,nestingLevel:0,textStyle:{},...I,...h}):(U={...d,..._},L={listId:"",listType:dn.BULLET_LIST,nestingLevel:0,textStyle:{},...h,...I}),c===g){f.push({startIndex:c,paragraphStyle:U,bullet:L});break}}l.push(...f),f=[]}e.paragraphs=l}return xh(t,e,n,r),a}function z1(t,e,n,r,s){const{sectionBreaks:o}=t,{sectionBreaks:i}=e;if(o==null||i==null)return;const a=Bh(t,n,r);if(s!==Et.REPLACE){const l=[];for(const u of i){const{startIndex:c}=u;let d=[];for(const h of a){const{startIndex:f}=h;if(c===f){s===Et.COVER?d.push({...h,...u}):d.push({...u,...h});break}}l.push(...d),d=[]}e.sectionBreaks=l}return Nh(t,e,n,r),a}function K1(t,e,n,r,s){const{customBlocks:o=[]}=t,{customBlocks:i}=e;if(o==null||i==null)return;const a=$h(t,n,r);if(s!==Et.REPLACE){const l=[];for(const u of i){const{startIndex:c}=u;let d=[];for(const h of a){const{startIndex:f}=h;if(c===f){s===Et.COVER?d.push({...h,...u}):d.push({...u,...h});break}}l.push(...d),d=[]}e.customBlocks=l}return Mh(t,e,n,r),o.length&&!t.customBlocks&&(t.customBlocks=o),a}function X1(t,e,n,r,s){const{tables:o}=t,{tables:i}=e;if(o==null||i==null)return;const a=Hh(t,n,r);if(s!==Et.REPLACE){const l=[];for(const u of i){const{startIndex:c,endIndex:d}=u;let h=[];for(const f of a){const{startIndex:p,endIndex:g}=f;if(p>=c&&g<=d){s===Et.COVER?h.push({...f,...u}):h.push({...u,...f});break}}l.push(...h),h=[]}e.tables=l}return Lh(t,e,n,r),a}function J1(t,e,n,r,s){t.customRanges||(t.customRanges=[]),Yi(t.customRanges,r),Yi(t.customRanges,r+n);const o=r,i=r+n-1,{customRanges:a}=e,l=[],u=new Map;t.customRanges.forEach(d=>{const{startIndex:h,endIndex:f}=d;h>=o&&f<=i?u.set(d.rangeId,d):l.push(d)});const c=[];return a?(a.forEach(d=>{const{startIndex:h,endIndex:f}=d;l.push({...d,startIndex:h+r,endIndex:f+r})}),t.customRanges=yl(l),c):[]}function Z1(t,e,n,r,s){t.customDecorations||(t.customDecorations=[]),zi(t.customDecorations,r),zi(t.customDecorations,r+n);const o=[],{customDecorations:i}=t,{customDecorations:a=[]}=e;if(s===Et.REPLACE){for(let l=0;l<i.length;l++){const u=i[l],{startIndex:c,endIndex:d}=u;c>=r&&d<=r+n-1&&o.push(u)}a.forEach(l=>{const{startIndex:u,endIndex:c}=l;i.push({...l,startIndex:u+r,endIndex:c+r})})}else for(const l of a){const{id:u}=l;if(l.type===ur.DELETED){const c=i.filter(d=>d.id===u);c.length&&o.push(...c)}else i.push({...l,startIndex:l.startIndex+r,endIndex:l.endIndex+r})}for(const l of o){const{id:u}=l,c=i.findIndex(d=>d.id===u);c!==-1&&i.splice(c,1)}return t.customDecorations=kh(i),o}var Vh=(t=>(t[t.copy=0]="copy",t[t.cut=1]="cut",t))(Vh||{});function Ki(t,e,n,r=!0){const{textRuns:s}=t;if(s){const o=[];for(const i of s){const a=et.deepClone(i),{st:l,ed:u}=a;et.hasIntersectionBetweenTwoRanges(l,u,e,n)&&(e>=l&&e<=u?o.push({...a,st:e,ed:Math.min(n,u)}):n>=l&&n<=u?o.push({...a,st:Math.max(e,l),ed:n}):o.push(a))}return Ao(o.map(i=>{const{st:a,ed:l}=i;return{...i,st:a-e,ed:l-e}}))}else if(r)return[{st:0,ed:n-e,ts:{}}]}function Q1(t,e,n){const{tables:r=[]}=t,s=[];for(const o of r){const i=et.deepClone(o),{startIndex:a,endIndex:l}=i;a>=e&&l<=n&&s.push({...i,startIndex:a-e,endIndex:l-e})}return s}function q1(t,e,n){const{paragraphs:r=[]}=t,s=[];for(const o of r){const{startIndex:i}=o;if(i>=e&&i<n){const a=et.deepClone(o);s.push(a)}}if(s.length)return s.map(o=>({...o,startIndex:o.startIndex-e}))}function Kw(t,e,n){const{sectionBreaks:r=[]}=t,s=[];for(const o of r){const{startIndex:i}=o;i>=e&&i<=n&&s.push(et.deepClone(o))}if(s.length)return s.map(o=>({...o,startIndex:o.startIndex-e}))}function tb(t,e,n){const{customBlocks:r=[]}=t,s=[];for(const o of r){const{startIndex:i}=o;i>=e&&i<n&&s.push(et.deepClone(o))}if(s.length)return s.map(o=>({...o,startIndex:o.startIndex-e}))}function tn(t,e,n,r=!0,s=1){const{dataStream:o}=t,i={dataStream:o.slice(e,n)};i.textRuns=Ki(t,e,n,r);const a=Q1(t,e,n);if(a.length&&(i.tables=a),i.paragraphs=q1(t,e,n),s===1){const u=nb(t,e,n);u?i.customDecorations=u:r&&(i.customDecorations=[])}const{customRanges:l}=eb(t,e,n);return l?i.customRanges=l:r&&(i.customRanges=[]),i.customBlocks=tb(t,e,n),i}function Xw(t){const{dataStream:e,textRuns:n,paragraphs:r,customRanges:s,customDecorations:o,tables:i}=t;let a=0,l=0;s==null||s.forEach(c=>{c.startIndex<0&&(a=Math.max(a,-c.startIndex)),c.endIndex>e.length-1&&(l=Math.max(l,c.endIndex-e.length+1))});const u=`${e}`;return n&&(n[0]&&(n[0].st=n[0].st-a),n[n.length-1]&&(n[n.length-1].ed=n[n.length-1].ed+l)),n==null||n.forEach(c=>{c.st+=a,c.ed+=a}),r==null||r.forEach(c=>{c.startIndex+=a}),s==null||s.forEach(c=>{c.startIndex+=a,c.endIndex+=a}),o==null||o.forEach(c=>{c.startIndex+=a,c.endIndex+=l}),i==null||i.forEach(c=>{c.startIndex+=a,c.endIndex+=l}),{...t,dataStream:u,textRuns:n,paragraphs:r,customRanges:s,customDecorations:o,tables:i}}function eb(t,e,n){if(t.customRanges==null)return{};const{customRanges:r}=t;return{customRanges:r.filter(s=>Math.max(s.startIndex,e)<=Math.min(s.endIndex,n-1)).map(s=>({...s,startIndex:Math.max(s.startIndex,e),endIndex:Math.min(s.endIndex,n-1)})).map(s=>({...s,startIndex:s.startIndex-e,endIndex:s.endIndex-e})),leftOffset:0,rightOffset:0}}function nb(t,e,n){if(t.customDecorations==null)return;const{customDecorations:r=[]}=t,s=[];return r.forEach(o=>{if(Math.max(o.startIndex,e)<=Math.min(o.endIndex,n-1)){const i=et.deepClone(o);s.push({...i,startIndex:Math.max(i.startIndex-e,0),endIndex:Math.min(i.endIndex,n-1)-e})}}),s}function rb(t,e,n){return t==null||e==null?t??e:jh(t,e,n)}function sb(t,e,n){if(t==null||e==null)return t??e;if(e.length===0||t.length===0)return t;if(e.length>1||t.length>1)throw new Error("Cannot cover multiple customRanges");return n===Et.REPLACE?[{...t[0]}]:[{...e[0],...t[0]}]}function ob(t,e,n){return e.length===0||t.length===0||n===Et.REPLACE?t:[...t,...e.filter(r=>!t.some(s=>r.id===s.id))]}function yc(t,e,n=Et.COVER){if(e.dataStream!=="")throw new Error("Cannot compose other body with non-empty dataStream");const r={dataStream:t.dataStream},{textRuns:s,paragraphs:o=[],customRanges:i,customDecorations:a=[]}=t,{textRuns:l,paragraphs:u=[],customRanges:c,customDecorations:d=[]}=e;r.textRuns=rb(l,s,n),r.customRanges=sb(c,i,n);const h=ob(d,a,n);h.length&&(r.customDecorations=h);const f=[];let p=0,g=0;for(;p<o.length&&g<u.length;){const _=o[p],I=u[g],{startIndex:U}=_,{startIndex:L}=I;U===L?(f.push(et.deepMerge(_,I)),p++,g++):U<L?(f.push(et.deepClone(_)),p++):(f.push(et.deepClone(I)),g++)}return p<o.length&&f.push(...o.slice(p)),g<u.length&&f.push(...u.slice(g)),f.length&&(r.paragraphs=f),r}function ib(t){const{body:e}=t;if(e==null)return!0;const{textRuns:n,paragraphs:r,customRanges:s,customBlocks:o,customDecorations:i,tables:a}=e;return n==null&&r==null&&s==null&&o==null&&i==null&&a==null}class Fr{constructor(e){b(this,"_index",0),b(this,"_offset",0),this._actions=e}hasNext(){return this.peekLength()<Number.POSITIVE_INFINITY}next(e){e||(e=Number.POSITIVE_INFINITY);const n=this._actions[this._index];if(n){const r=this._offset,s=n.len;return e>=s-r?(e=s-r,this._index+=1,this._offset=0):this._offset+=e,n.t===tt.DELETE||n.t===tt.RETAIN&&n.body==null?et.deepClone({...n,len:e}):et.deepClone({...n,len:e,body:tn(n.body,r,r+e,!1)})}else return{t:tt.RETAIN,len:Number.POSITIVE_INFINITY}}peek(){return this._actions[this._index]}peekLength(){return this._actions[this._index]?this._actions[this._index].len-this._offset:Number.POSITIVE_INFINITY}peekType(){const e=this._actions[this._index];return e?e.t:tt.RETAIN}rest(){if(this.hasNext()){if(this._offset===0)return this._actions.slice(this._index);{const e=this._offset,n=this._index,r=this.next(),s=this._actions.slice(this._index);return this._offset=e,this._index=n,[r].concat(s)}}else return[]}}function ab(t,e,n){const{dataStream:r}=t,s=n,o=n+e,i=Ph(t,e,n),a=Uh(t,e,n),l=Bh(t,e,n),u=$h(t,e,n),c=Hh(t,e,n),d=$1(t,e,n),h=H1(t,e,n);let f="";return r&&(t.dataStream=EE(r,s,o),f=r.slice(s,o)),{dataStream:f,textRuns:i,paragraphs:a,sectionBreaks:l,customBlocks:u,tables:c,customRanges:d,customDecorations:h}}function lb(t,e,n,r){t.dataStream=vE(t.dataStream,r,e.dataStream),Dh(t,e,n,r),xh(t,e,n,r),Nh(t,e,n,r),Mh(t,e,n,r),Lh(t,e,n,r),U1(t,e,n,r),B1(t,e,n,r)}function ub(t,e,n,r,s=Et.COVER){return W1(t,e,n,r,s)}function cb(t,e,n){return e<=0?{dataStream:""}:ab(t,e,n)}function db(t,e,n,r){n!==0&&lb(t,e,n,r)}function hb(t,e){const n=new Or;return n.reset(),e.forEach(r=>{const s=et.deepClone(r);switch(s.t){case tt.RETAIN:{const{coverType:o,body:i,len:a}=s;i!=null&&ub(t,i,a,n.cursor,o),n.moveCursor(a);break}case tt.INSERT:{const{body:o,len:i}=s;db(t,o,i,n.cursor),n.moveCursor(i);break}case tt.DELETE:{const{len:o}=s;cb(t,o,n.cursor);break}default:throw new Error(`Unknown action type for action: ${s}.`)}}),t}function fb(t,e,n,r,s){if(t==null||e==null)return e;if(t.length===0||e.length===0)return[];e=et.deepClone(e),t=et.deepClone(t);const o=[],i=e.length,a=t.length;let l=0,u=0,c=null;function d(){return c?(o.push(c),c=null,!0):!1}for(;l<i&&u<a;){const{st:g,ed:_,ts:I}=e[l],{st:U,ed:L,ts:B,sId:C}=t[u];let R={};if(s===0)R={...I},n===Et.COVER&&r===Et.REPLACE&&B&&(R=Object.assign({},B,R));else if(R={...I},n===Et.REPLACE){if(r===Et.REPLACE)R={...B};else if(I&&B){const y=Object.keys(I);for(const N of y)B[N]&&delete R[N]}}else if(r===Et.REPLACE){if(B){const y=Object.keys(B);for(const N of y)B[N]!==void 0&&(R[N]=B[N])}}else if(B){const y=Object.keys(B);for(const N of y)R[N]!==void 0&&delete R[N]}if(_<U)d()||o.push(e[l]),l++;else if(L<g)d()||o.push(t[u]),u++;else{const y={st:Math.min(g,U),ed:Math.max(g,U),ts:g<U?{...I}:{...B}};y.ed>y.st&&o.push(),o.push({st:Math.max(g,U),ed:Math.min(_,L),ts:R,sId:C}),_<L?(l++,t[u].st=_,t[u].st===t[u].ed&&u++):(u++,e[l].st=L,e[l].st===e[l].ed&&l++);const N={st:Math.min(_,L),ed:Math.max(_,L),ts:_<L?{...B}:{...I},sId:_<L?C:void 0};c=N.ed>N.st?N:null}}d();const h=o[o.length-1],f=e[i-1],p=t[a-1];return h.ed!==Math.max(f.ed,p.ed)&&(f.ed>p.ed?o.push(f):o.push(p)),Ao(o,!0)}function pb(t,e,n,r,s){if(t==null||e==null)return e;if(t.length===0||e.length===0)return[];if(t.length>1||e.length>1)throw new Error("CustomRanges is only supported transform for length one now.");const o=t[0],i=e[0];if(n===Et.REPLACE)return s===1?[et.deepClone(o)]:[et.deepClone(i)];if(r===Et.REPLACE){const a=et.deepClone(i);return s===1&&Object.assign(a,et.deepClone(o)),[a]}else{const a=et.deepClone(i);return s===1&&Object.assign(a,et.deepClone(o)),[a]}}function vc(t,e,n,r,s){const o={startIndex:e.startIndex};if(e.paragraphStyle&&(o.paragraphStyle=et.deepClone(e.paragraphStyle),t.paragraphStyle)){if(n===Et.REPLACE)if(r===Et.REPLACE)s===1&&(o.paragraphStyle={...t.paragraphStyle});else if(s===1){const i=Object.keys(t.paragraphStyle);for(const a of i)t.paragraphStyle[a]!==void 0&&(o.paragraphStyle[a]=t.paragraphStyle[a])}else{const i=Object.keys(t.paragraphStyle);for(const a of i)o.paragraphStyle[a]===void 0&&(o.paragraphStyle[a]=t.paragraphStyle[a])}else if(r===Et.REPLACE)if(s===1){const i=Object.keys(t.paragraphStyle);for(const a of i)t.paragraphStyle[a]!==void 0&&(o.paragraphStyle[a]=t.paragraphStyle[a])}else{const i=Object.keys(t.paragraphStyle);for(const a of i)o.paragraphStyle[a]===void 0&&(o.paragraphStyle[a]=t.paragraphStyle[a])}else if(s===1){const i=Object.keys(t.paragraphStyle);for(const a of i)o.paragraphStyle[a]&&delete o.paragraphStyle[a]}}return n===Et.REPLACE&&r===Et.REPLACE?o.bullet=s===1?et.deepClone(t.bullet):et.deepClone(e.bullet):t.bullet===void 0?o.bullet=et.deepClone(e.bullet):n===Et.REPLACE||r===Et.REPLACE?o.bullet=s===0&&e.bullet?et.deepClone(e.bullet):et.deepClone(t.bullet):s===0&&e.bullet!==void 0&&(o.bullet=et.deepClone(e.bullet)),o}function gb(t,e){if(t==null||e==null)return e;if(t.length===0||e.length===0)return et.deepClone(e);const n=[];for(const r of e){const{id:s,type:o}=r;let i=!1;for(const a of t)if(a.id===s){(a.type===ur.DELETED||o===ur.DELETED)&&(i=!0,n.push({...r,type:ur.DELETED}));break}i||n.push(r)}return n}function mb(t,e,n=!1){const{body:r,coverType:s=Et.COVER}=t,{body:o,coverType:i=Et.COVER}=e;if(r==null||r.dataStream!==""||o==null||o.dataStream!=="")throw new Error("Data stream is not supported in retain transform.");const a={dataStream:""},l=i,{textRuns:u,paragraphs:c=[],customRanges:d,customDecorations:h}=r,{textRuns:f,paragraphs:p=[],customRanges:g,customDecorations:_}=o,I=fb(u,f,s,i,n?1:0);I&&(a.textRuns=I);const U=pb(d,g,s,i,n?1:0);U&&(a.customRanges=U);const L=gb(h,_);L&&(a.customDecorations=L);const B=[];let C=0,R=0;for(;C<c.length&&R<p.length;){const y=c[C],N=p[R],{startIndex:G}=y,{startIndex:z}=N;if(G===z){let m={startIndex:G};n?m=vc(y,N,s,i,1):m=vc(y,N,s,i,0),B.push(m),C++,R++}else G<z?C++:(B.push(et.deepClone(N)),R++)}return R<p.length&&B.push(...p.slice(R)),B.length&&(a.paragraphs=B),{coverType:l,body:a}}function Ec(t){return Object.keys(t).length===1}const Xi=class Ji{constructor(){b(this,"_actions",[])}static apply(e,n){return hb(e,n)}static compose(e,n){const r=new Fr(e),s=new Fr(n),o=new Ji;for(;r.hasNext()||s.hasNext();)if(s.peekType()===tt.INSERT)o.push(s.next());else if(r.peekType()===tt.DELETE)o.push(r.next());else{const i=Math.min(r.peekLength(),s.peekLength()),a=r.next(i),l=s.next(i);if(a.t===tt.INSERT&&l.t===tt.RETAIN)l.body==null?o.push(a):o.push({...a,body:yc(a.body,l.body,l.coverType)});else if(a.t===tt.RETAIN&&l.t===tt.RETAIN)if(a.body==null&&l.body==null)o.push(a.len!==Number.POSITIVE_INFINITY?a:l);else if(a.body&&l.body){const u=a.coverType===Et.REPLACE||l.coverType===Et.REPLACE?Et.REPLACE:Et.COVER;o.push({...a,t:tt.RETAIN,coverType:u,body:yc(a.body,l.body,l.coverType)})}else o.push(a.body?a:l);else a.t===tt.RETAIN&&l.t===tt.DELETE?o.push(l):a.t===tt.INSERT&&(l.t,tt.DELETE)}return o.trimEndUselessRetainAction(),o.serialize()}static transform(e,n,r="right"){return this._transform(n,e,r==="left"?"right":"left")}static _transform(e,n,r="right"){const s=new Fr(e),o=new Fr(n),i=new Ji;for(;s.hasNext()||o.hasNext();)if(s.peekType()===tt.INSERT&&(r==="left"||o.peekType()!==tt.INSERT)){const a=s.next();i.retain(a.len)}else if(o.peekType()===tt.INSERT)i.push(o.next());else{const a=Math.min(s.peekLength(),o.peekLength()),l=s.next(a),u=o.next(a);if(l.t===tt.DELETE)continue;if(u.t===tt.DELETE){i.push(u);continue}if(l.body==null||u.body==null)i.push(u);else{const{coverType:c,body:d}=mb(l,u,r==="left");i.push({...u,t:tt.RETAIN,coverType:c,body:d})}}return i.trimEndUselessRetainAction(),i.serialize()}static transformPosition(e,n,r=!1){const s=new Fr(e);let o=0;for(;s.hasNext()&&o<=n;){const i=s.peekLength(),a=s.peekType();if(s.next(),a===tt.DELETE){n-=Math.min(i,n-o);continue}else a===tt.INSERT&&(o<n||!r)&&(n+=i);o+=i}return n}static isNoop(e){return e.length===0}static invert(e){const n=[];for(const r of e)if(r.t===tt.INSERT)n.push({t:tt.DELETE,len:r.len,body:r.body});else if(r.t===tt.DELETE){if(r.body==null)throw new Error("Can not invert DELETE action without body property, makeInvertible must be called first.");n.push({t:tt.INSERT,body:r.body,len:r.len})}else if(r.body!=null){if(r.oldBody==null)throw new Error("Can not invert RETAIN action without oldBody property, makeInvertible must be called first.");n.push({t:tt.RETAIN,body:r.oldBody,oldBody:r.body,len:r.len,coverType:Et.REPLACE})}else n.push(r);return n}static makeInvertible(e,n){const r=[];let s=0;for(const o of e){if(o.t===tt.DELETE&&(o.body==null||o.body&&o.body.dataStream.length!==o.len)){const i=tn(n,s,s+o.len,!1);o.len=i.dataStream.length,o.body=i}if(o.t===tt.RETAIN&&o.body!=null){const i=tn(n,s,s+o.len,!0);o.oldBody={...i,dataStream:""},o.len=i.dataStream.length}r.push(o),o.t!==tt.INSERT&&(s+=o.len)}return r}insert(e,n){const r={t:tt.INSERT,body:n,len:e};return this.push(r),this}retain(e,n,r){const s={t:tt.RETAIN,len:e};return n!=null&&(s.body=n),r!=null&&(s.coverType=r),this.push(s),this}delete(e){const n={t:tt.DELETE,len:e};return this.push(n),this}empty(){return this._actions=[],this}serialize(){return this._actions}push(...e){if(e.length>1){for(const o of e)this.push(o);return this}let n=this._actions.length,r=this._actions[n-1];const s=et.deepClone(e[0]);if(s.t===tt.RETAIN&&s.len===0&&s.body==null)return this;if(typeof r=="object"){if(r.t===tt.DELETE&&s.t===tt.DELETE)return r.len+=s.len,this;if(r.t===tt.DELETE&&s.t===tt.INSERT&&(n-=1,r=this._actions[n-1],r==null))return this._actions.unshift(s),this;if(r.t===tt.RETAIN&&s.t===tt.RETAIN&&r.body==null&&s.body==null)return r.len+=s.len,this;if(r.t===tt.INSERT&&Ec(r.body)&&s.t===tt.INSERT&&Ec(s.body))return r.len+=s.len,r.body.dataStream+=s.body.dataStream,this}return n===this._actions.length?this._actions.push(s):this._actions.splice(n,0,s),this}trimEndUselessRetainAction(){let e=this._actions[this._actions.length-1];for(;e&&e.t===tt.RETAIN&&ib(e);)this._actions.pop(),e=this._actions[this._actions.length-1];return this}};b(Xi,"id","text-x"),b(Xi,"uri","https://github.com/dream-num/univer#text-x");let kt=Xi;Object.defineProperty(kt,"name",{value:"text-x"});const Xs=class Wh{static registerSubtype(e){var n;e==null||this._subTypes.has(e.name)&&((n=this._subTypes.get(e.name))==null?void 0:n.id)!==kt.id||(this._subTypes.set(e.name,e),_e.type.registerSubtype(e))}static apply(e,n){if(!_e.type.isNoop(n))return _e.type.apply(e,n)}static compose(e,n){return _e.type.compose(e,n)}static transform(e,n,r){return _e.type.transform(e,n,r)}static transformPosition(e,n,r="right"){return e&&e.length===2&&e[0]==="body"&&e[1].et===kt.name?kt.transformPosition(e[1].e,n,r==="left"):n}static invertWithDoc(e,n){return _e.type.invertWithDoc(e,n)}static isNoop(e){return _e.type.isNoop(e)}static getInstance(){return this._instance==null&&(this._instance=new Wh),this._instance}removeOp(e,n){return _e.removeOp(e,n)}moveOp(e,n){return _e.moveOp(e,n)}insertOp(e,n){return _e.insertOp(e,n)}replaceOp(e,n,r){return _e.replaceOp(e,n,r)}editOp(e,n=["body"]){return _e.editOp(n,kt.name,e)}};b(Xs,"uri","https://github.com/dream-num/univer#json-x"),b(Xs,"_subTypes",new Map),b(Xs,"_instance",null);let vr=Xs;vr.registerSubtype(kt);var _b=(t=>(t.PARAGRAPH="PARAGRAPH",t.SECTION_BREAK="SECTION_BREAK",t.TABLE="TABLE",t.TABLE_ROW="TABLE_ROW",t.TABLE_CELL="TABLE_CELL",t.CUSTOM_BLOCK="CUSTOM_BLOCK",t))(_b||{}),Re=(t=>(t.PARAGRAPH="\r",t.SECTION_BREAK=`
`,t.TABLE_START="",t.TABLE_ROW_START="\x1B",t.TABLE_CELL_START="",t.TABLE_CELL_END="",t.TABLE_ROW_END="",t.TABLE_END="",t.CUSTOM_RANGE_START="",t.CUSTOM_RANGE_END="",t.COLUMN_BREAK="\v",t.PAGE_BREAK="\f",t.DOCS_END="\0",t.TAB="	",t.CUSTOM_BLOCK="\b",t.LETTER="",t.SPACE=" ",t))(Re||{});function Jw(t){return`${t}`}const yb=[Re.TABLE_START,Re.TABLE_ROW_START,Re.TABLE_CELL_START,Re.TABLE_CELL_END,Re.TABLE_ROW_END,Re.TABLE_END],vl=t=>{const e=t.endsWith(`\r
`)?t.slice(0,-2):t;return yb.reduce((n,r)=>n.replaceAll(r,""),e)},vb=t=>t?vl(t).replaceAll("\r","")==="":!0,Eb=t=>{const e=t.replace(/\n/g,"\r"),n=[],r=[];let s=0,o="";const i=(l,u=!0)=>{const c=e.slice(s,l);if(et.isLegalUrl(c)){const d=ue(),h=`${c}`,f={startIndex:s,endIndex:s+h.length-1,rangeId:d,rangeType:Pn.HYPERLINK,properties:{url:t}};r.push(f),o+=h,s=l+1,u&&(o+="\r",n.push({startIndex:l}))}else o+=e.slice(s,l+1),s=l+1,u&&n.push({startIndex:l})};let a=0;for(let l=0;l<e.length;l++)e[l]==="\r"&&(i(l),a=l);return(a!==e.length-1||e.length===1)&&i(e.length,!1),{dataStream:o,paragraphs:n,customRanges:r}},Gh={id:"default_doc",documentStyle:{}};class bb extends Na{constructor(e){var n;super(),b(this,"type",It.UNIVER_DOC),b(this,"_name$",new de("")),b(this,"name$",this._name$.asObservable()),b(this,"snapshot"),this.snapshot={...Gh,...e},this._name$.next((n=this.snapshot.title)!=null?n:"No Title")}getUnitId(){throw new Error("Method not implemented.")}getRev(){var e;return(e=this.snapshot.rev)!=null?e:1}incrementRev(){this.snapshot.rev=this.getRev()+1}setRev(e){this.snapshot.rev=e}setName(e){this.snapshot.title=e,this._name$.next(e)}get drawings(){return this.snapshot.drawings}get documentStyle(){return this.snapshot.documentStyle}get lists(){return this.snapshot.lists}get zoomRatio(){var e;return((e=this.snapshot.settings)==null?void 0:e.zoomRatio)||1}resetDrawing(e,n){this.snapshot.drawings=e,this.snapshot.drawingsOrder=n}getBody(){return this.snapshot.body}getSnapshot(){return this.snapshot}getBulletPresetList(){var e;const n=(e=this.snapshot.lists)!=null?e:{};return{...Oo,...n}}updateDocumentId(e){this.snapshot.id=e}updateDocumentRenderConfig(e){const{documentStyle:n}=this.snapshot;n.renderConfig==null?n.renderConfig=e:n.renderConfig={...n.renderConfig,...e}}getDocumentStyle(){return this.snapshot.documentStyle}updateDocumentStyle(e){this.snapshot.documentStyle==null?this.snapshot.documentStyle=e:this.snapshot.documentStyle={...this.snapshot.documentStyle,...e}}updateDocumentDataMargin(e){const{t:n,l:r,b:s,r:o}=e,{documentStyle:i}=this.snapshot;n!=null&&(i.marginTop=n),r!=null&&(i.marginLeft=r),s!=null&&(i.marginBottom=s),o!=null&&(i.marginRight=o)}updateDocumentDataPageSize(e,n){const{documentStyle:r}=this.snapshot;if(!r.pageSize){r.pageSize={width:e??Number.POSITIVE_INFINITY,height:n??Number.POSITIVE_INFINITY};return}e!==void 0&&(r.pageSize.width=e),n!==void 0&&(r.pageSize.height=n)}updateDrawing(e,n){const{drawings:r}=this,{width:s,height:o,left:i,top:a}=n,l=r==null?void 0:r[e];if(!l)return;const u=l.docTransform;u.size.width=s,u.size.height=o,u.positionH.posOffset=i,u.positionV.posOffset=a}setZoomRatio(e=1){this.snapshot.settings?this.snapshot.settings.zoomRatio=e:this.snapshot.settings={zoomRatio:e}}setDisabled(e){this.snapshot.disabled=e}getDisabled(){return this.snapshot.disabled}getTitle(){return this.snapshot.title}}class en extends bb{constructor(e){var n,r;super(et.isEmptyObject(e)?Yy():e),b(this,"_unitId"),b(this,"headerModelMap",new Map),b(this,"footerModelMap",new Map),b(this,"change$",new de(0));const s=6;this._unitId=(n=this.snapshot.id)!=null?n:ue(s),this._initializeHeaderFooterModel(),this._name$.next((r=this.snapshot.title)!=null?r:"")}dispose(){super.dispose(),this.headerModelMap.forEach(e=>{e.dispose()}),this.footerModelMap.forEach(e=>{e.dispose()}),this._name$.complete()}getDrawings(){return this.snapshot.drawings}getDrawingsOrder(){return this.snapshot.drawingsOrder}getCustomRanges(){var e;return(e=this.snapshot.body)==null?void 0:e.customRanges}getCustomDecorations(){var e;return(e=this.snapshot.body)==null?void 0:e.customDecorations}getSettings(){return this.snapshot.settings}reset(e){if(e.id&&e.id!==this._unitId)throw new Error("Cannot reset a document model with a different unit id!");this.snapshot={...Gh,...e},this._initializeHeaderFooterModel(),this.change$.next(this.change$.value+1)}getSelfOrHeaderFooterModel(e){if(e!=null){if(this.headerModelMap.has(e))return this.headerModelMap.get(e);if(this.footerModelMap.has(e))return this.footerModelMap.get(e)}return this}getUnitId(){return this._unitId}apply(e){if(!vr.isNoop(e))return this.snapshot=vr.apply(this.snapshot,e),e!=null&&e.some(n=>Array.isArray(n)&&((n==null?void 0:n[0])==="headers"||(n==null?void 0:n[0])==="footers"))&&(this.headerModelMap.clear(),this.footerModelMap.clear(),this._initializeHeaderFooterModel()),this.change$.next(this.change$.value+1),this.snapshot}sliceBody(e,n,r=Vh.copy){const s=this.getBody();if(s!=null)return tn(s,e,n,!1,r)}_initializeHeaderFooterModel(){const{headers:e,footers:n}=this.getSnapshot();if(e)for(const r in e){const s=e[r];this.headerModelMap.set(r,new en(s)),this.headerModelMap.get(r).updateDocumentId(this.getUnitId())}if(n)for(const r in n){const s=n[r];this.footerModelMap.set(r,new en(s)),this.footerModelMap.get(r).updateDocumentId(this.getUnitId())}}updateDocumentId(e){super.updateDocumentId(e),this._unitId=e}getPlainText(){var e,n;return vl((n=(e=this.getBody())==null?void 0:e.dataStream)!=null?n:"")}}function Cb(t){const{ranges:e,id:n,type:r}=t,s=new kt;let o=0;for(let i=0;i<e.length;i++){const a=e[i],{startOffset:l,endOffset:u}=a;l>0&&s.push({t:tt.RETAIN,len:l-o}),s.push({t:tt.RETAIN,body:{dataStream:"",customDecorations:[{id:n,type:r,startIndex:0,endIndex:u-l-1}]},len:u-l}),o=u}return s}function Rb(t){var e,n,r;const{id:s,segmentId:o,documentDataModel:i}=t,a=i==null?void 0:i.getBody();if(!i||!a)return!1;const l=(r=(n=(e=i.getSelfOrHeaderFooterModel(o))==null?void 0:e.getBody())==null?void 0:n.customDecorations)==null?void 0:r.find(f=>f.id===s);if(!l)return!1;const u=new kt,{startIndex:c,endIndex:d}=l,h=d-c+1;return u.push({t:tt.RETAIN,len:c}),u.push({t:tt.RETAIN,len:h,body:{dataStream:"",customDecorations:[{startIndex:0,endIndex:h-1,id:s,type:ur.DELETED}]}}),u}function Yh(t,e,n,r){return t<=n&&e>=n||t>=n&&t<=r}function Tb(t,e){const n=[];for(let r=0,s=e.length;r<s;r++){const o=e[r];t.collapsed?o.startIndex<t.startOffset&&t.startOffset<=o.endIndex&&n.push(o):Yh(t.startOffset,t.endOffset-1,o.startIndex,o.endIndex)&&n.push(o)}return n}function wb(t){return{...et.deepClone(t),rangeId:ue()}}function Ib(t,e){const n=[];let r=t[0];for(const s of e)s<t[0]||s>t[1]||(r<s&&n.push([r,s-1]),r=s+1);return r<=t[1]&&n.push([r,t[1]]),n}function zh(t,e,n,r){const s=[];for(let o=0,i=n.length;o<i;o++){const a=n[o];if((r===void 0||a.rangeType===r)&&Math.max(a.startIndex,t)<=Math.min(a.endIndex,e)&&s.push({...a}),a.startIndex>e)break}return s}function Sb(t,e){var n,r,s,o,i;const a=zh(t.startOffset,t.collapsed?t.startOffset:t.endOffset-1,(n=e.customRanges)!=null?n:[]),l=Math.min(t.startOffset,(s=(r=a[0])==null?void 0:r.startIndex)!=null?s:1/0),u=Math.max(t.endOffset,((i=(o=a[a.length-1])==null?void 0:o.endIndex)!=null?i:-1/0)+1);return{startOffset:l,endOffset:u,collapsed:l===u}}var oi,bc;function Ab(){if(bc)return oi;bc=1;var t=-1,e=1,n=0;function r(m,F,v,x,S){if(m===F)return m?[[n,m]]:[];if(v!=null){var w=G(m,F,v);if(w)return w}var A=a(m,F),O=m.substring(0,A);m=m.substring(A),F=F.substring(A),A=u(m,F);var M=m.substring(m.length-A);m=m.substring(0,m.length-A),F=F.substring(0,F.length-A);var P=s(m,F);return O&&P.unshift([n,O]),M&&P.push([n,M]),U(P,S),x&&d(P),P}function s(m,F){var v;if(!m)return[[e,F]];if(!F)return[[t,m]];var x=m.length>F.length?m:F,S=m.length>F.length?F:m,w=x.indexOf(S);if(w!==-1)return v=[[e,x.substring(0,w)],[n,S],[e,x.substring(w+S.length)]],m.length>F.length&&(v[0][0]=v[2][0]=t),v;if(S.length===1)return[[t,m],[e,F]];var A=c(m,F);if(A){var O=A[0],M=A[1],P=A[2],Q=A[3],W=A[4],ot=r(O,P),lt=r(M,Q);return ot.concat([[n,W]],lt)}return o(m,F)}function o(m,F){for(var v=m.length,x=F.length,S=Math.ceil((v+x)/2),w=S,A=2*S,O=new Array(A),M=new Array(A),P=0;P<A;P++)O[P]=-1,M[P]=-1;O[w+1]=0,M[w+1]=0;for(var Q=v-x,W=Q%2!==0,ot=0,lt=0,T=0,D=0,H=0;H<S;H++){for(var Y=-H+ot;Y<=H-lt;Y+=2){var $=w+Y,j;Y===-H||Y!==H&&O[$-1]<O[$+1]?j=O[$+1]:j=O[$-1]+1;for(var q=j-Y;j<v&&q<x&&m.charAt(j)===F.charAt(q);)j++,q++;if(O[$]=j,j>v)lt+=2;else if(q>x)ot+=2;else if(W){var nt=w+Q-Y;if(nt>=0&&nt<A&&M[nt]!==-1){var k=v-M[nt];if(j>=k)return i(m,F,j,q)}}}for(var K=-H+T;K<=H-D;K+=2){var nt=w+K,k;K===-H||K!==H&&M[nt-1]<M[nt+1]?k=M[nt+1]:k=M[nt-1]+1;for(var Z=k-K;k<v&&Z<x&&m.charAt(v-k-1)===F.charAt(x-Z-1);)k++,Z++;if(M[nt]=k,k>v)D+=2;else if(Z>x)T+=2;else if(!W){var $=w+Q-K;if($>=0&&$<A&&O[$]!==-1){var j=O[$],q=w+j-$;if(k=v-k,j>=k)return i(m,F,j,q)}}}}return[[t,m],[e,F]]}function i(m,F,v,x){var S=m.substring(0,v),w=F.substring(0,x),A=m.substring(v),O=F.substring(x),M=r(S,w),P=r(A,O);return M.concat(P)}function a(m,F){if(!m||!F||m.charAt(0)!==F.charAt(0))return 0;for(var v=0,x=Math.min(m.length,F.length),S=x,w=0;v<S;)m.substring(w,S)==F.substring(w,S)?(v=S,w=v):x=S,S=Math.floor((x-v)/2+v);return L(m.charCodeAt(S-1))&&S--,S}function l(m,F){var v=m.length,x=F.length;if(v==0||x==0)return 0;v>x?m=m.substring(v-x):v<x&&(F=F.substring(0,v));var S=Math.min(v,x);if(m==F)return S;for(var w=0,A=1;;){var O=m.substring(S-A),M=F.indexOf(O);if(M==-1)return w;A+=M,(M==0||m.substring(S-A)==F.substring(0,A))&&(w=A,A++)}}function u(m,F){if(!m||!F||m.slice(-1)!==F.slice(-1))return 0;for(var v=0,x=Math.min(m.length,F.length),S=x,w=0;v<S;)m.substring(m.length-S,m.length-w)==F.substring(F.length-S,F.length-w)?(v=S,w=v):x=S,S=Math.floor((x-v)/2+v);return B(m.charCodeAt(m.length-S))&&S--,S}function c(m,F){var v=m.length>F.length?m:F,x=m.length>F.length?F:m;if(v.length<4||x.length*2<v.length)return null;function S(lt,T,D){for(var H=lt.substring(D,D+Math.floor(lt.length/4)),Y=-1,$="",j,q,nt,k;(Y=T.indexOf(H,Y+1))!==-1;){var K=a(lt.substring(D),T.substring(Y)),Z=u(lt.substring(0,D),T.substring(0,Y));$.length<Z+K&&($=T.substring(Y-Z,Y)+T.substring(Y,Y+K),j=lt.substring(0,D-Z),q=lt.substring(D+K),nt=T.substring(0,Y-Z),k=T.substring(Y+K))}return $.length*2>=lt.length?[j,q,nt,k,$]:null}var w=S(v,x,Math.ceil(v.length/4)),A=S(v,x,Math.ceil(v.length/2)),O;if(!w&&!A)return null;A?w?O=w[4].length>A[4].length?w:A:O=A:O=w;var M,P,Q,W;m.length>F.length?(M=O[0],P=O[1],Q=O[2],W=O[3]):(Q=O[0],W=O[1],M=O[2],P=O[3]);var ot=O[4];return[M,P,Q,W,ot]}function d(m){for(var F=!1,v=[],x=0,S=null,w=0,A=0,O=0,M=0,P=0;w<m.length;)m[w][0]==n?(v[x++]=w,A=M,O=P,M=0,P=0,S=m[w][1]):(m[w][0]==e?M+=m[w][1].length:P+=m[w][1].length,S&&S.length<=Math.max(A,O)&&S.length<=Math.max(M,P)&&(m.splice(v[x-1],0,[t,S]),m[v[x-1]+1][0]=e,x--,x--,w=x>0?v[x-1]:-1,A=0,O=0,M=0,P=0,S=null,F=!0)),w++;for(F&&U(m),I(m),w=1;w<m.length;){if(m[w-1][0]==t&&m[w][0]==e){var Q=m[w-1][1],W=m[w][1],ot=l(Q,W),lt=l(W,Q);ot>=lt?(ot>=Q.length/2||ot>=W.length/2)&&(m.splice(w,0,[n,W.substring(0,ot)]),m[w-1][1]=Q.substring(0,Q.length-ot),m[w+1][1]=W.substring(ot),w++):(lt>=Q.length/2||lt>=W.length/2)&&(m.splice(w,0,[n,Q.substring(0,lt)]),m[w-1][0]=e,m[w-1][1]=W.substring(0,W.length-lt),m[w+1][0]=t,m[w+1][1]=Q.substring(lt),w++),w++}w++}}var h=/[^a-zA-Z0-9]/,f=/\s/,p=/[\r\n]/,g=/\n\r?\n$/,_=/^\r?\n\r?\n/;function I(m){function F(lt,T){if(!lt||!T)return 6;var D=lt.charAt(lt.length-1),H=T.charAt(0),Y=D.match(h),$=H.match(h),j=Y&&D.match(f),q=$&&H.match(f),nt=j&&D.match(p),k=q&&H.match(p),K=nt&&lt.match(g),Z=k&&T.match(_);return K||Z?5:nt||k?4:Y&&!j&&q?3:j||q?2:Y||$?1:0}for(var v=1;v<m.length-1;){if(m[v-1][0]==n&&m[v+1][0]==n){var x=m[v-1][1],S=m[v][1],w=m[v+1][1],A=u(x,S);if(A){var O=S.substring(S.length-A);x=x.substring(0,x.length-A),S=O+S.substring(0,S.length-A),w=O+w}for(var M=x,P=S,Q=w,W=F(x,S)+F(S,w);S.charAt(0)===w.charAt(0);){x+=S.charAt(0),S=S.substring(1)+w.charAt(0),w=w.substring(1);var ot=F(x,S)+F(S,w);ot>=W&&(W=ot,M=x,P=S,Q=w)}m[v-1][1]!=M&&(M?m[v-1][1]=M:(m.splice(v-1,1),v--),m[v][1]=P,Q?m[v+1][1]=Q:(m.splice(v+1,1),v--))}v++}}function U(m,F){m.push([n,""]);for(var v=0,x=0,S=0,w="",A="",O;v<m.length;){if(v<m.length-1&&!m[v][1]){m.splice(v,1);continue}switch(m[v][0]){case e:S++,A+=m[v][1],v++;break;case t:x++,w+=m[v][1],v++;break;case n:var M=v-S-x-1;if(F){if(M>=0&&R(m[M][1])){var P=m[M][1].slice(-1);if(m[M][1]=m[M][1].slice(0,-1),w=P+w,A=P+A,!m[M][1]){m.splice(M,1),v--;var Q=M-1;m[Q]&&m[Q][0]===e&&(S++,A=m[Q][1]+A,Q--),m[Q]&&m[Q][0]===t&&(x++,w=m[Q][1]+w,Q--),M=Q}}if(C(m[v][1])){var P=m[v][1].charAt(0);m[v][1]=m[v][1].slice(1),w+=P,A+=P}}if(v<m.length-1&&!m[v][1]){m.splice(v,1);break}if(w.length>0||A.length>0){w.length>0&&A.length>0&&(O=a(A,w),O!==0&&(M>=0?m[M][1]+=A.substring(0,O):(m.splice(0,0,[n,A.substring(0,O)]),v++),A=A.substring(O),w=w.substring(O)),O=u(A,w),O!==0&&(m[v][1]=A.substring(A.length-O)+m[v][1],A=A.substring(0,A.length-O),w=w.substring(0,w.length-O)));var W=S+x;w.length===0&&A.length===0?(m.splice(v-W,W),v=v-W):w.length===0?(m.splice(v-W,W,[e,A]),v=v-W+1):A.length===0?(m.splice(v-W,W,[t,w]),v=v-W+1):(m.splice(v-W,W,[t,w],[e,A]),v=v-W+2)}v!==0&&m[v-1][0]===n?(m[v-1][1]+=m[v][1],m.splice(v,1)):v++,S=0,x=0,w="",A="";break}}m[m.length-1][1]===""&&m.pop();var ot=!1;for(v=1;v<m.length-1;)m[v-1][0]===n&&m[v+1][0]===n&&(m[v][1].substring(m[v][1].length-m[v-1][1].length)===m[v-1][1]?(m[v][1]=m[v-1][1]+m[v][1].substring(0,m[v][1].length-m[v-1][1].length),m[v+1][1]=m[v-1][1]+m[v+1][1],m.splice(v-1,1),ot=!0):m[v][1].substring(0,m[v+1][1].length)==m[v+1][1]&&(m[v-1][1]+=m[v+1][1],m[v][1]=m[v][1].substring(m[v+1][1].length)+m[v+1][1],m.splice(v+1,1),ot=!0)),v++;ot&&U(m,F)}function L(m){return m>=55296&&m<=56319}function B(m){return m>=56320&&m<=57343}function C(m){return B(m.charCodeAt(0))}function R(m){return L(m.charCodeAt(m.length-1))}function y(m){for(var F=[],v=0;v<m.length;v++)m[v][1].length>0&&F.push(m[v]);return F}function N(m,F,v,x){return R(m)||C(x)?null:y([[n,m],[t,F],[e,v],[n,x]])}function G(m,F,v){var x=typeof v=="number"?{index:v,length:0}:v.oldRange,S=typeof v=="number"?null:v.newRange,w=m.length,A=F.length;if(x.length===0&&(S===null||S.length===0)){var O=x.index,M=m.slice(0,O),P=m.slice(O),Q=S?S.index:null;t:{var W=O+A-w;if(Q!==null&&Q!==W||W<0||W>A)break t;var ot=F.slice(0,W),lt=F.slice(W);if(lt!==P)break t;var T=Math.min(O,W),D=M.slice(0,T),H=ot.slice(0,T);if(D!==H)break t;var Y=M.slice(T),$=ot.slice(T);return N(D,Y,$,P)}t:{if(Q!==null&&Q!==O)break t;var j=O,ot=F.slice(0,j),lt=F.slice(j);if(ot!==M)break t;var q=Math.min(w-j,A-j),nt=P.slice(P.length-q),k=lt.slice(lt.length-q);if(nt!==k)break t;var Y=P.slice(0,P.length-q),$=lt.slice(0,lt.length-q);return N(M,Y,$,nt)}}if(x.length>0&&S&&S.length===0)t:{var D=m.slice(0,x.index),nt=m.slice(x.index+x.length),T=D.length,q=nt.length;if(A<T+q)break t;var H=F.slice(0,T),k=F.slice(A-q);if(D!==H||nt!==k)break t;var Y=m.slice(T,w-q),$=F.slice(T,A-q);return N(D,Y,$,nt)}return null}function z(m,F,v,x){return r(m,F,v,x,!0)}return z.INSERT=e,z.DELETE=t,z.EQUAL=n,oi=z,oi}var Ob=Ab();const Kh=Fe(Ob);function Db(t){var e,n,r;const{rangeId:s,segmentId:o,documentDataModel:i,insert:a}=t,l=(n=(e=i.getSelfOrHeaderFooterModel(o).getBody())==null?void 0:e.customRanges)==null?void 0:n.find(p=>p.rangeId===s);if(!l)return!1;const{startIndex:u,endIndex:c}=l,d=new kt,h=c-u+1;d.push({t:tt.RETAIN,len:u}),d.push({t:tt.RETAIN,len:h,body:{dataStream:"",customRanges:[]}}),a&&d.push({t:tt.INSERT,body:a,len:a.dataStream.length});const f=c+1+((r=a==null?void 0:a.dataStream.length)!=null?r:0);return d.selections=[{startOffset:f,endOffset:f,collapsed:!0}],d}function xb(t){const{ranges:e,rangeId:n,rangeType:r,wholeEntity:s,properties:o,body:i}=t;let a=0;const l=new kt;let u=!1;return e.forEach(c=>{var d,h,f;const p=Sb(c,i);if(!p||!i)return!1;const{startOffset:g,endOffset:_}=p,I=(d=i.customRanges)!=null?d:[],U=(C,R,y)=>{var N,G,z,m;const F=zh(C,R,I,r),v=Math.min((G=(N=F[0])==null?void 0:N.startIndex)!=null?G:1/0,C),x=Math.max((m=(z=F[F.length-1])==null?void 0:z.endIndex)!=null?m:-1/0,R),S={rangeId:y?`${n}$${y}`:n,rangeType:r,startIndex:0,endIndex:x-v,wholeEntity:s,properties:{...o}};l.push({t:tt.RETAIN,len:v-a}),l.push({t:tt.RETAIN,len:x-v+1,body:{dataStream:"",customRanges:[S]},coverType:Et.COVER}),a=x+1},L=((h=i.paragraphs)!=null?h:[]).filter(C=>C.startIndex<_&&C.startIndex>g),B=((f=i.customBlocks)!=null?f:[]).filter(C=>C.startIndex<_&&C.startIndex>g);Ib([g,_-1],[...L.map(C=>C.startIndex),...B.map(C=>C.startIndex)]).forEach(([C,R],y)=>U(C,R,y)),u=!0,l.selections=[{startOffset:p.endOffset,endOffset:p.endOffset,collapsed:!0}]}),u?l:!1}function Xh(t,e,n=0,r=null,s=!0){t.sort((u,c)=>u.startOffset-c.startOffset);const o=[],{paragraphs:i=[]}=e,a=i==null?void 0:i.find(u=>u.startIndex>=t[0].startOffset&&u.startIndex<t[0].endOffset);let l=n;if(t.forEach(u=>{const{startOffset:c,endOffset:d}=u;c>l&&(o.push({t:tt.RETAIN,len:c-l}),l=c),l<d&&(o.push({t:tt.DELETE,len:d-l}),l=d)}),r&&o.push({t:tt.INSERT,body:r,len:r.dataStream.length}),a&&s){const u=i.find(c=>c.startIndex-n>=t[t.length-1].endOffset-1);u&&(u.startIndex>l&&(o.push({t:tt.RETAIN,len:u.startIndex-l}),l=u.startIndex),o.push({t:tt.RETAIN,len:1,body:{dataStream:"",paragraphs:[{...u,startIndex:0,bullet:a==null?void 0:a.bullet}]},coverType:Et.REPLACE}))}return o}function Nb(t,e,n=0){const r=[];let s=n;return t.forEach(o=>{const{startOffset:i,endOffset:a}=o;i>s&&(r.push({t:tt.RETAIN,len:i-s}),s=i),a>s&&(r.push({t:tt.RETAIN,len:a-s,body:{...et.deepClone(e),dataStream:""}}),s=a)}),r}const Mb=t=>{var e;const{selection:n,body:r,doc:s}=t,o=n.segmentId,i=(e=s.getSelfOrHeaderFooterModel(o))==null?void 0:e.getBody();if(!i)return!1;const a=n.collapsed?null:tn(i,n.startOffset,n.endOffset),l=Kh(a?a.dataStream:"",r.dataStream);let u=0;const c=l.map(([h,f])=>{switch(h){case 0:{const p={t:tt.RETAIN,body:{...tn(r,u,u+f.length,!1),dataStream:""},len:f.length};return u+=f.length,p}case 1:{const p={t:tt.INSERT,body:tn(r,u,u+f.length),len:f.length};return u+=f.length,p}default:return{t:tt.DELETE,len:f.length}}}),d=new kt;return d.push({t:tt.RETAIN,len:n.startOffset}),d.push(...c),d};function Lb(t,e){return!!((t==null?void 0:t.length)===(e==null?void 0:e.length)&&t!=null&&t.every((n,r)=>JSON.stringify(n)===JSON.stringify(e==null?void 0:e[r])))}const Fb=t=>{var e;const{selection:n,body:r,doc:s,themeService:o}=t,i=n.segmentId,a=(e=s.getSelfOrHeaderFooterModel(i))==null?void 0:e.getBody();if(!a)return!1;const l=n.collapsed?null:tn(a,n.startOffset,n.endOffset),u=Kh(l?l.dataStream:"",r.dataStream);let c=0;const d=u.map(([f,p])=>{switch(f){case 0:{const g=Ki(r,c,c+p.length,!1),_=Ki(l,c,c+p.length,!1),I={t:tt.RETAIN,body:Lb(g,_)?void 0:{textRuns:g==null?void 0:g.map(U=>{var L,B,C,R,y,N,G;return{...U,ts:{...U.ts,cl:(C=(B=(L=U.ts)==null?void 0:L.cl)==null?void 0:B.rgb)!=null&&C.includes(".")?{rgb:o.getColorFromTheme((N=(y=(R=U.ts)==null?void 0:R.cl)==null?void 0:y.rgb)!=null?N:"")}:(G=U.ts)==null?void 0:G.cl}}}),dataStream:""},len:p.length};return c+=p.length,I}case 1:{const g={t:tt.INSERT,body:tn(r,c,c+p.length),len:p.length};return c+=p.length,g}default:return{t:tt.DELETE,len:p.length}}});if(d.every(f=>f.t===tt.RETAIN&&!f.body))return!1;const h=new kt;return h.push({t:tt.RETAIN,len:n.startOffset}),h.push(...d),h};function kb(t,e){const n=[],{customBlocks:r=[]}=t;for(const s of e){const{startOffset:o,endOffset:i}=s;if(!(o==null||i==null))for(const a of r){const{startIndex:l}=a;l>=o&&l<i&&n.push(a.blockId)}}return n}function Pb(t,e=""){if(!e)return["body"];const{headers:n,footers:r}=t.getSnapshot();if(n==null&&r==null)throw new Error("Document data model must have headers or footers when update by segment id");if((n==null?void 0:n[e])!=null)return["headers",e,"body"];if((r==null?void 0:r[e])!=null)return["footers",e,"body"];throw new Error("Segment id not found in headers or footers")}const Ub=t=>{var e,n,r,s;const{selection:o,documentDataModel:i,drawings:a}=t,{collapsed:l,startOffset:u,segmentId:c}=o,d=new kt,h=vr.getInstance(),f=[],p=i.getSelfOrHeaderFooterModel(c).getBody();if(!p)return!1;const g=(n=(e=i.getSnapshot().drawingsOrder)==null?void 0:e.length)!=null?n:0;let _=0;if(l)u>0&&d.push({t:tt.RETAIN,len:u});else{const L=Xh([o],p,0,null,!1);d.push(...L);const B=kb(p,[o]),C=(r=i.getDrawings())!=null?r:{},R=(s=i.getDrawingsOrder())!=null?s:[],y=B.sort((N,G)=>R.indexOf(N)>R.indexOf(G)?-1:R.indexOf(N)<R.indexOf(G)?1:0);if(y.length>0)for(const N of y){const G=C[N],z=R.indexOf(N);if(G==null||z<0)continue;const m=h.removeOp(["drawings",N],G),F=h.removeOp(["drawingsOrder",z],N);f.push(m),f.push(F),_++}}d.push({t:tt.INSERT,body:{dataStream:"\b".repeat(a.length),customBlocks:a.map((L,B)=>({startIndex:B,blockId:L.drawingId}))},len:a.length});const I=Pb(i,c),U=h.editOp(d.serialize(),I);f.push(U);for(const L of a){const{drawingId:B}=L,C=h.insertOp(["drawings",B],L),R=h.insertOp(["drawingsOrder",g-_],B);f.push(C),f.push(R)}return f.reduce((L,B)=>vr.compose(L,B),null)};function Bb(t,e){if(typeof e>"u")return{startOffset:t,endOffset:t,collapsed:!0};if(e<t)throw new Error(`Cannot make a doc selection when endOffset ${e} is less than startOffset ${t}.`);return{startOffset:t,endOffset:e,collapsed:t===e}}function $b(t){const{startOffset:e,endOffset:n,collapsed:r}=t,s=Math.min(e,n),o=Math.max(e,n);return{startOffset:s,endOffset:o,collapsed:r}}function Hb(t,e,n,r){return Math.max(t,n)<=Math.min(e,r)}function Zi(t,e,n,r){const{startOffset:s,endOffset:o}=t,i=r??El(e,n),a=[];let l=-1;for(let u=0;u<i.length;u++){const c=i[u],{startIndex:d}=c;(s>l&&s<=d||o>l&&o<=d||d>=s&&d<=o)&&a.push(c),l=d}return a}function Qi(t,e,n){const r=[],s=El(e,n);for(const o of t){const i=Zi(o,e,n,s);r.push(...i)}return r}const jb=[Re.PARAGRAPH,Re.TABLE_START,Re.TABLE_END,Re.TABLE_ROW_START,Re.TABLE_CELL_START,Re.TABLE_CELL_END];function El(t,e){const n=[];for(let r=0;r<t.length;r++){const s=t[r],{startIndex:o}=s;let i=o-1;for(;!jb.includes(e[i])&&i>=0;)i--;n.push({...s,paragraphStart:i+1,paragraphEnd:s.startIndex})}return n}const Vb=t=>{var e,n,r;const{paragraphs:s,segmentId:o,document:i}=t;let a=t.listType;const l=(n=(e=i.getSelfOrHeaderFooterModel(o).getBody())==null?void 0:e.paragraphs)!=null?n:[],u=s.every(f=>{var p;return((p=f.bullet)==null?void 0:p.listType.indexOf(a))===0});let c=ue(6);if(s.length===1){const f=l.indexOf(s[0]),p=l[f-1],g=l[f+1];p&&p.bullet&&p.bullet.listType.indexOf(a)===0?(c=p.bullet.listId,a!==dn.CHECK_LIST&&(a=p.bullet.listType)):g&&g.bullet&&g.bullet.listType.indexOf(a)===0&&(c=g.bullet.listId,a!==dn.CHECK_LIST&&(a=g.bullet.listType))}const d=new Or;d.reset();const h=new kt;for(const f of s){const{startIndex:p,paragraphStyle:g={},bullet:_}=f;h.push({t:tt.RETAIN,len:p-d.cursor}),h.push({t:tt.RETAIN,len:1,body:{dataStream:"",paragraphs:[u?{paragraphStyle:g,startIndex:0}:{startIndex:0,paragraphStyle:{...g},bullet:{nestingLevel:(r=_==null?void 0:_.nestingLevel)!=null?r:0,textStyle:{fs:20},listType:a,listId:c}}]},coverType:Et.REPLACE}),d.moveCursorTo(p+1)}return h},Wb=t=>{var e;const{paragraphIndex:n,segmentId:r,document:s}=t,o=(e=s.getSelfOrHeaderFooterModel(r).getBody())==null?void 0:e.paragraphs;if(o==null)return!1;const i=o.find(h=>h.startIndex===n);if(!(i!=null&&i.bullet)||i.bullet.listType.indexOf(dn.CHECK_LIST)===-1)return!1;const a=new Or;a.reset();const l=new kt,{startIndex:u,paragraphStyle:c={}}=i,d=i.bullet.listType===dn.CHECK_LIST?dn.CHECK_LIST_CHECKED:dn.CHECK_LIST;return l.push({t:tt.RETAIN,len:u-a.cursor}),l.push({t:tt.RETAIN,len:1,body:{dataStream:"",paragraphs:[{...i,paragraphStyle:c,startIndex:0,bullet:{...i.bullet,listType:d}}]},coverType:Et.REPLACE}),a.moveCursorTo(u+1),l},Gb=t=>{var e,n;const{paragraphs:r,listType:s,segmentId:o,document:i}=t;if(((e=i.getSelfOrHeaderFooterModel(o).getBody())==null?void 0:e.paragraphs)==null)return!1;const a=ue(6),l=new Or;l.reset();const u=new kt;for(const c of r){const{startIndex:d,paragraphStyle:h={},bullet:f}=c;u.push({t:tt.RETAIN,len:d-l.cursor}),u.push({t:tt.RETAIN,len:1,body:{dataStream:"",paragraphs:[{startIndex:0,paragraphStyle:h,bullet:{nestingLevel:(n=f==null?void 0:f.nestingLevel)!=null?n:0,textStyle:(f==null?void 0:f.listType)===s?f.textStyle:{fs:20},listType:s,listId:a}}]},coverType:Et.REPLACE}),l.moveCursorTo(d+1)}return u};function Yb(t,e){return e.some(n=>t.startIndex>n.startIndex&&t.startIndex<n.endIndex)}const zb=t=>{var e,n,r;const{paragraphs:s,document:o,type:i}=t,a=new Or;a.reset();const l=new kt,u=(e=o.getSnapshot().lists)!=null?e:{},c=(r=(n=o.getBody())==null?void 0:n.tables)!=null?r:[],d={...Oo,...u};for(const h of s){const{startIndex:f,paragraphStyle:p={},bullet:g}=h,_=Yb(h,c);if(l.push({t:tt.RETAIN,len:f-a.cursor}),g){const I=g.listType;let U=d[I].nestingLevel.length-1;_&&(U=Math.min(U,2)),l.push({t:tt.RETAIN,len:1,body:{dataStream:"",paragraphs:[{startIndex:0,paragraphStyle:{...p},bullet:{...g,nestingLevel:Math.max(Math.min(g.nestingLevel+i,U),0)}}]},coverType:Et.REPLACE})}else l.push({t:tt.RETAIN,len:1});a.moveCursorTo(f+1)}return l},Kb=t=>{var e,n,r,s;const{textRanges:o,segmentId:i,document:a,style:l,paragraphTextRun:u,cursor:c,deleteLen:d,textX:h}=t,f=a.getSelfOrHeaderFooterModel(i),p=(n=(e=f.getBody())==null?void 0:e.paragraphs)!=null?n:[],g=(s=(r=f.getBody())==null?void 0:r.dataStream)!=null?s:"",_=Qi(o,p,g),I=new Or;c&&I.moveCursorTo(c);const U=h??new kt;_.sort((B,C)=>B.startIndex-C.startIndex);const L=Math.max(0,_[0].paragraphStart-1);L>I.cursor&&(U.push({t:tt.RETAIN,len:L-I.cursor}),I.moveCursorTo(L)),d&&U.push({t:tt.DELETE,len:d});for(const B of _){const{startIndex:C,paragraphStyle:R={}}=B,y=C-I.cursor;U.push({t:tt.RETAIN,len:y,...u?{body:{dataStream:"",textRuns:[{ts:u,st:0,ed:y}]},coverType:Et.REPLACE}:null}),U.push({t:tt.RETAIN,len:1,body:{dataStream:"",paragraphs:[{startIndex:0,paragraphStyle:{...R,...l}}]},coverType:Et.REPLACE}),I.moveCursorTo(C+1)}return U};class le{}b(le,"customRange",{add:xb,delete:Db,copyCustomRange:wb,getCustomRangesInterestsWithSelection:Tb,isIntersecting:Yh}),b(le,"customDecoration",{add:Cb,delete:Rb}),b(le,"selection",{replace:Mb,makeSelection:Bb,normalizeSelection:$b,delete:Xh,replaceTextRuns:Fb,retain:Nb}),b(le,"range",{isIntersects:Hb,getParagraphsInRange:Zi,getParagraphsInRanges:Qi}),b(le,"transform",{getPlainText:vl,fromPlainText:Eb,isEmptyDocument:vb}),b(le,"paragraph",{bullet:{set:Gb,switch:Vb,toggleChecklist:Wb,changeNestLevel:zb},style:{set:Kb},util:{transform:El,getParagraphsInRange:Zi,getParagraphsInRanges:Qi}}),b(le,"drawing",{add:Ub});function Zw(t,e,n,r){var s;if(e==="")return t;const o={id:"mock-id",body:t,documentStyle:{}},i=new en(o),a=e.length;let l;for(;(l=(r?i.getBody().dataStream:i.getBody().dataStream.toLowerCase()).indexOf(e))>=0;){const c=new kt,d=vr.getInstance();if(l>0&&c.retain(l),n.length>0){const h=i.sliceBody(l,l+a),f={dataStream:n};if(Array.isArray(h==null?void 0:h.textRuns)&&h.textRuns.length&&(f.textRuns=[{...h.textRuns[0],st:0,ed:n.length}]),(s=h==null?void 0:h.customRanges)!=null&&s.length){const p=h.customRanges[0];f.customRanges=[{...p,startIndex:0,endIndex:n.length-1}]}c.insert(n.length,f)}c.delete(a),i.apply(d.editOp(c.serialize()))}const u=i.getBody();return i.dispose(),u}function Xb(t){if(t.customRanges||(t.customRanges=[]),!t.paragraphs){t.paragraphs=[];for(let e=0;e<t.dataStream.length;e++)t.dataStream[e]==="\r"&&t.paragraphs.push({startIndex:e})}return t.customBlocks||(t.customBlocks=[]),t.textRuns||(t.textRuns=[]),t.customDecorations||(t.customDecorations=[]),t.sectionBreaks||(t.sectionBreaks=[]),t.tables||(t.tables=[]),t}function Jh(t){var e;return t.body=Xb((e=t.body)!=null?e:{dataStream:""}),t.drawingsOrder||(t.drawingsOrder=[]),t.drawings||(t.drawings={}),t.documentStyle||(t.documentStyle={}),t}class Do{constructor(e={}){b(this,"_style"),this._style=e}static create(e={}){return new Do(e)}get fontFamily(){return this._style.ff}get fontSize(){return this._style.fs}get italic(){return this._style.it===ut.TRUE}get bold(){return this._style.bl===ut.TRUE}get underline(){return this._style.ul&&Dn.create(this._style.ul)}get bottomBorderLine(){return this._style.bbl&&Dn.create(this._style.bbl)}get strikethrough(){return this._style.st&&Dn.create(this._style.st)}get overline(){return this._style.ol&&Dn.create(this._style.ol)}get background(){return this._style.bg}get border(){return this._style.bd}get color(){return this._style.cl}get verticalAlign(){return this._style.va}get numberFormat(){return this._style.n}copy(){return Fn.create(et.deepClone(this._style))}getValue(){return{...this._style}}}class Fn extends Do{static create(e={}){return new Fn(e)}constructor(e={}){super(e)}setFontFamily(e){return this._style.ff=e,this}setFontSize(e){return this._style.fs=e,this}setItalic(e){return this._style.it=e?1:0,this}setBold(e){return this._style.bl=e?1:0,this}setUnderline(e){return this._style.ul=e.build(),this}setBottomBorderLine(e){return this._style.bbl=e.build(),this}setStrikethrough(e){return this._style.st=e.build(),this}setOverline(e){return this._style.ol=e.build(),this}setBackground(e){return this._style.bg=e,this}setBorder(e){return this._style.bd=e,this}setColor(e){return this._style.cl=e,this}setVerticalAlign(e){return this._style.va=e,this}copy(){return Fn.create(et.deepClone(this._style))}build(){return this.getValue()}}class Dn{constructor(e={s:1}){b(this,"_decoration"),this._decoration=e}static create(e={s:1}){return new Dn(e)}get show(){return this._decoration.s===ut.TRUE}get followFontColor(){return this._decoration.c===ut.TRUE}get color(){return this._decoration.cl}get type(){return this._decoration.t}setShow(e){return this._decoration.s=e?1:0,this}setFollowFontColor(e){return this._decoration.c=e?1:0,this}setColor(e){return this._decoration.cl=e,this}setLineType(e){return this._decoration.t=e,this}copy(){return Dn.create(et.deepClone(this._decoration))}build(){return{...this._decoration}}}class xo{constructor(e={}){b(this,"_style"),this._style=e}static create(e={}){return new xo(e)}get indentFirstLine(){return this._style.indentFirstLine}get hanging(){return this._style.hanging}get indentStart(){return this._style.indentStart}get tabStops(){return this._style.tabStops}get indentEnd(){return this._style.indentEnd}get textStyle(){return this._style.textStyle}get headingId(){return this._style.headingId}get namedStyleType(){return this._style.namedStyleType}get horizontalAlign(){return this._style.horizontalAlign}get lineSpacing(){return this._style.lineSpacing}get direction(){return this._style.direction}get spacingRule(){return this._style.spacingRule}get snapToGrid(){return this._style.snapToGrid}get spaceAbove(){return this._style.spaceAbove}get spaceBelow(){return this._style.spaceBelow}get borderBetween(){return this._style.borderBetween}get borderTop(){return this._style.borderTop}get borderBottom(){return this._style.borderBottom}get borderLeft(){return this._style.borderLeft}get borderRight(){return this._style.borderRight}get keepLines(){return this._style.keepLines===ut.TRUE}get keepNext(){return this._style.keepNext===ut.TRUE}get wordWrap(){return this._style.wordWrap===ut.TRUE}get widowControl(){return this._style.widowControl===ut.TRUE}get shading(){return this._style.shading}get suppressHyphenation(){return this._style.suppressHyphenation===ut.TRUE}copy(){return oo.create(et.deepClone(this._style))}getValue(){return this._style}}class oo extends xo{static create(e={}){return new oo(e)}constructor(e={}){super(e)}setIndentFirstLine(e){return this._style.indentFirstLine=e,this}setHanging(e){return this._style.hanging=e,this}setIndentStart(e){return this._style.indentStart=e,this}setTabStops(e){return this._style.tabStops=e,this}setIndentEnd(e){return this._style.indentEnd=e,this}setTextStyle(e){return this._style.textStyle=e,this}setHeadingId(e){return this._style.headingId=e,this}setNamedStyleType(e){return this._style.namedStyleType=e,this}setHorizontalAlign(e){return this._style.horizontalAlign=e,this}setLineSpacing(e){return this._style.lineSpacing=e,this}setDirection(e){return this._style.direction=e,this}setSpacingRule(e){return this._style.spacingRule=e,this}setSnapToGrid(e){return this._style.snapToGrid=e?1:0,this}setSpaceAbove(e){return this._style.spaceAbove=e,this}setSpaceBelow(e){return this._style.spaceBelow=e,this}setBorderBetween(e){return this._style.borderBetween=e,this}setBorderTop(e){return this._style.borderTop=e,this}setBorderBottom(e){return this._style.borderBottom=e,this}setBorderLeft(e){return this._style.borderLeft=e,this}setBorderRight(e){return this._style.borderRight=e,this}setKeepLines(e){return this._style.keepLines=e?1:0,this}setKeepNext(e){return this._style.keepNext=e?1:0,this}setWordWrap(e){return this._style.wordWrap=e?1:0,this}setWidowControl(e){return this._style.widowControl=e?1:0,this}setShading(e){return this._style.shading=e,this}setSuppressHyphenation(e){return this._style.suppressHyphenation=e?1:0,this}copy(){return oo.create(et.deepClone(this._style))}build(){return this.getValue()}}class xn{constructor(e){if(b(this,"_data"),!e.body)throw new Error("Invalid document data, body is required");this._data=Jh(e)}static create(e){return new xn(e)}static createByBody(e){return new xn({body:e,id:"d",documentStyle:{}})}copy(){return hr.create(et.deepClone(this._data))}slice(e,n){const{body:r,...s}=this._data;return hr.create({...et.deepClone(s),body:tn(r,e,n)})}toPlainText(){var e,n;return le.transform.getPlainText((n=(e=this._data.body)==null?void 0:e.dataStream)!=null?n:"").replaceAll("\r",`
`)}getParagraphStyle(){var e,n;return xo.create((n=(e=this._data.body)==null?void 0:e.paragraphs)==null?void 0:n[0].paragraphStyle)}getParagraphBullet(){var e,n;return(n=(e=this._data.body)==null?void 0:e.paragraphs)==null?void 0:n[0].bullet}getParagraphs(){var e,n;const r=(n=(e=this._data.body)==null?void 0:e.paragraphs)!=null?n:[];let s=0;return r.map(o=>{const i=this.slice(s,o.startIndex);return s=o.startIndex,i})}getTextRuns(){var e,n;return((n=(e=this._data.body)==null?void 0:e.textRuns)!=null?n:[]).map(r=>({...r,ts:r.ts?Do.create(r.ts):null}))}getLinks(){var e,n,r;return(r=(n=(e=this._data.body)==null?void 0:e.customRanges)==null?void 0:n.filter(s=>s.rangeType===Pn.HYPERLINK))!=null?r:[]}getData(){return this._data}}class hr extends xn{constructor(e){super(e),b(this,"_doc"),this._doc=new en(e)}static newEmptyData(){return Jh({id:"d",documentStyle:{},drawings:{},drawingsOrder:[],body:{dataStream:`\r
`,customBlocks:[],customRanges:[],paragraphs:[{startIndex:0}],textRuns:[],tables:[],sectionBreaks:[]}})}static create(e){return new hr(e??hr.newEmptyData())}insertText(e,n,r){var s,o;let i=((o=(s=this._data.body)==null?void 0:s.dataStream.length)!=null?o:2)-2,a,l;if(typeof e=="string"?a=e:(i=Math.min(e,i),a=n),typeof n=="object"?l=n instanceof Fn?n.build():n:l=r instanceof Fn?r.build():r,!a)return this;const u={dataStream:a,textRuns:l?[{ts:l,st:i,ed:i+a.length}]:[]},c=le.selection.replace({doc:this._doc,selection:{startOffset:i,endOffset:i,collapsed:!0},body:u});if(!c)throw new Error("Insert text failed, please check.");return kt.apply(this._doc.getBody(),c.serialize()),this}insertRichText(e,n){var r,s;let o=((s=(r=this._data.body)==null?void 0:r.dataStream.length)!=null?s:2)-2,i;typeof e=="object"?i=e instanceof xn?e.getData():e:(o=Math.min(e,o),i=n instanceof xn?n.getData():n);const a=le.selection.replace({doc:this._doc,selection:{startOffset:o,endOffset:o,collapsed:!0},body:i.body});if(!a)throw new Error("Insert text failed, please check.");return kt.apply(this._doc.getBody(),a.serialize()),this}delete(e,n){if(n!==void 0){if(!n)return this;const r=le.selection.delete([{startOffset:e,endOffset:e+n,collapsed:!0}],this._data.body);kt.apply(this._doc.getBody(),r)}return this}setStyle(e,n,r){const s={dataStream:"",textRuns:[{ts:r instanceof Fn?r.build():r,st:0,ed:n-e}]},o=le.selection.retain([{startOffset:e,endOffset:n,collapsed:!0}],s);return kt.apply(this._doc.getBody(),o),this}setLink(e,n,r){const s=le.customRange.add({rangeType:Pn.HYPERLINK,rangeId:ue(),properties:{url:r},ranges:[{startOffset:e,endOffset:n,collapsed:!1}],body:this._data.body});if(!s)throw new Error("Insert text failed, please check.");return kt.apply(this._doc.getBody(),s.serialize()),this}cancelLink(e,n){if(typeof e=="string"){const r=le.customRange.delete({rangeId:e,documentDataModel:this._doc});if(!r)throw new Error("Insert text failed, please check.");kt.apply(this._doc.getBody(),r.serialize())}else this.slice(e,n).getLinks().forEach(r=>{const s=le.customRange.delete({rangeId:r.rangeId,documentDataModel:this._doc});if(!s)throw new Error("Insert text failed, please check.");kt.apply(this._doc.getBody(),s.serialize())});return this}updateLink(e,n){var r,s;const o=(s=(r=this._data.body)==null?void 0:r.customRanges)==null?void 0:s.find(i=>i.rangeId===e);if(!o)throw new Error("Link not found");return o.properties.url=n,this}insertParagraph(e,n){var r,s;let o,i;return typeof e=="object"?(o={dataStream:"\r",paragraphs:[{startIndex:0,paragraphStyle:e.build()}]},i=((s=(r=this._data.body)==null?void 0:r.dataStream.length)!=null?s:2)-2):(i=e,o={dataStream:"\r",paragraphs:[{startIndex:0,paragraphStyle:n==null?void 0:n.build()}]}),this.insertRichText(i,xn.create({body:o,id:"d",documentStyle:{}})),this}insertLink(e,n,r){let s="",o="";typeof e=="string"?(s=e,o=n):(s=n,o=r);const i=hr.createByBody({dataStream:s,customRanges:[{rangeType:Pn.HYPERLINK,rangeId:ue(),properties:{url:o},startIndex:0,endIndex:s.length-1}]});return typeof e=="number"?this.insertRichText(e,i):this.insertRichText(i)}}const Qw="__default_document_sub_component_id20231101__";class Jb{constructor(){b(this,"skipNextObservers",!1),b(this,"lastReturnValue"),b(this,"isStopPropagation",!1)}stopPropagation(){this.isStopPropagation=!0}}class qw extends ce{constructor(){super(...arguments),b(this,"_sortedObservers",[])}subscribe(){throw new Error("[EventSubject]: please use `subscribeEvent` instead of `subscribe` method for `EventSubject`.")}next(){throw new Error("[EventSubject]: please use `emitEvent` instead of `next` method for `EventSubject`.")}unsubscribe(){super.unsubscribe(),this._sortedObservers.length=0}complete(){super.complete(),this._sortedObservers.length=0}subscribeEvent(e){let n;typeof e=="function"?n={next:([s,o])=>e(s,o)}:n=e;const r=super.subscribe(n);return this._sortedObservers.push(n),this._sortedObservers.sort((s,o)=>{var i,a;return((i=s.priority)!=null?i:0)-((a=o.priority)!=null?a:0)}),r.add(()=>this._sortedObservers=this._sortedObservers.filter(s=>s!==n)),r}clearObservers(){this._sortedObservers.forEach(e=>{var n;return(n=e.complete)==null?void 0:n.call(e)}),this._sortedObservers.length=0}emitEvent(e){var n;if(!this.closed){const r=new Jb;r.lastReturnValue=e;for(const s of this._sortedObservers){const o=(n=s.next)==null?void 0:n.call(s,[e,r]);if(r.lastReturnValue=o,r.skipNextObservers)return{handled:!0,lastReturnValue:r.lastReturnValue,stopPropagation:r.isStopPropagation}}return{handled:this._sortedObservers.length>0,lastReturnValue:r.lastReturnValue,stopPropagation:r.isStopPropagation}}throw new Error("[EventSubject]: cannot emit event on a closed subject.")}}function tI(t){return new ie(e=>{const n=t.subscribeEvent(r=>{e.next(r)});return()=>n.unsubscribe()})}const bl=Te("core.resource-manager.service"),qi={[Ze.Editor]:"Editor",[Ze.Owner]:"Owner",[Ze.Reader]:"Reader",[Ze.UNRECOGNIZED]:"UNRECOGNIZED"},ta=t=>t?{userID:`${qi[t]}_${ue(8)}`,name:qi[t],avatar:""}:{userID:"",name:"",avatar:"",anonymous:!0,canBindAnonymous:!1},Zb=(t,e)=>t.startsWith(qi[e]);class io extends ee{constructor(){super(...arguments),b(this,"_model",new Map),b(this,"_userChange$",new ce),b(this,"userChange$",this._userChange$.asObservable()),b(this,"_currentUser$",new de(ta())),b(this,"currentUser$",this._currentUser$.asObservable())}dispose(){super.dispose(),this._model.clear(),this._userChange$.complete(),this._currentUser$.complete()}getCurrentUser(){return this._currentUser$.getValue()}setCurrentUser(e){this.addUser(e),this._currentUser$.next(e)}addUser(e){this._model.set(e.userID,e),this._userChange$.next({type:"add",user:e})}getUser(e,n){const r=this._model.get(e);if(r)return r;n&&n()}delete(e){const n=this.getUser(e);this._model.delete(e),n&&this._userChange$.next({type:"delete",user:n})}clear(){this._model.clear(),this._userChange$.next({type:"clear"})}list(){return Array.from(this._model.values())}}var Qb=(t,e,n,r)=>{for(var s=e,o=t.length-1,i;o>=0;o--)(i=t[o])&&(s=i(s)||s);return s},Cc=(t,e)=>(n,r)=>e(n,r,t);let ea=class{constructor(t,e){b(this,"_permissionMap",new Map([])),this._resourceManagerService=t,this._userManagerService=e,this._initSnapshot(),this._initDefaultUser()}_initDefaultUser(){const t=this._userManagerService.getCurrentUser();t&&t.userID||this._userManagerService.setCurrentUser(ta(Ze.Owner))}_getRole(t){const e=this._userManagerService.getCurrentUser();return e?Zb(e.userID,t):!1}_initSnapshot(){this._resourceManagerService.registerPluginResource({toJson:t=>{const e=[...this._permissionMap.keys()].reduce((n,r)=>{const s=this._permissionMap.get(r);return n[r]=s,n},{});return JSON.stringify(e)},parseJson:t=>JSON.parse(t),pluginName:"SHEET_AuthzIoMockService_PLUGIN",businesses:[It.UNIVER_SHEET,It.UNIVER_DOC,It.UNIVER_SLIDE],onLoad:(t,e)=>{for(const n in e)this._permissionMap.set(n,e[n])},onUnLoad:()=>{this._permissionMap.clear()}})}async create(t){return ue(8)}async allowed(t){return Promise.resolve([])}async batchAllowed(t){return Promise.resolve([])}async list(t){const e=[];return t.objectIDs.forEach(n=>{const r=this._permissionMap.get(n);if(r){const s={objectID:n,unitID:t.unitID,objectType:r.objectType,name:r.name,shareOn:!1,shareRole:Ze.Owner,shareScope:-1,scope:{read:bi.AllCollaborator,edit:bi.AllCollaborator},creator:ta(Ze.Owner),strategies:[{action:6,role:1},{action:16,role:1},{action:17,role:1},{action:18,role:1},{action:19,role:1},{action:33,role:1},{action:34,role:1},{action:35,role:1},{action:36,role:1},{action:37,role:1},{action:38,role:1},{action:39,role:1},{action:40,role:1}],actions:t.actions.map(o=>({action:o,allowed:this._getRole(Ze.Owner)||this._getRole(Ze.Editor)}))};e.push(s)}}),e}async listCollaborators(){return[]}async listRoles(){return{roles:[],actions:[]}}async deleteCollaborator(){}async update(t){}async updateCollaborator(){}async createCollaborator(){}async putCollaborators(t){}};ea=Qb([Cc(0,bl),Cc(1,Ve(io))],ea);const qb=Te("IAuthzIoIoService"),Zh=Te("univer.config-service");class tC{constructor(){b(this,"_configChanged$",new ce),b(this,"configChanged$",this._configChanged$.asObservable()),b(this,"_config",new Map)}dispose(){this._config.clear(),this._configChanged$.complete()}getConfig(e){return this._config.get(e)}setConfig(e,n,r){var s;const{merge:o=!1}=r||{};let i=(s=this._config.get(e))!=null?s:{};o?i=Da(i,n):i=n,this._config.set(e,i),this._configChanged$.next({[e]:i})}deleteConfig(e){return this._config.delete(e)}subscribeConfigValue$(e){return new ie(n=>{Object.prototype.hasOwnProperty.call(this._config,e)&&n.next(this._config.get(e));const r=this.configChanged$.pipe(En(s=>Object.prototype.hasOwnProperty.call(s,e))).subscribe(s=>n.next(s[e]));return()=>r.unsubscribe()})}}const Fs="FOCUSING_UNIT",Qr="FOCUSING_SHEET",ks="FOCUSING_DOC",Ps="FOCUSING_SLIDE",eI="FOCUSING_EDITOR_BUT_HIDDEN",eC="EDITOR_ACTIVATED",nI="FOCUSING_EDITOR_INPUT_FORMULA",nC="FOCUSING_FX_BAR_EDITOR",rI="FOCUSING_UNIVER_EDITOR",sI="FOCUSING_EDITOR_INPUT_FORMULA",oI="FOCUSING_PANEL_EDITOR",iI="FOCUSING_UNIVER_EDITOR_STANDALONE_SINGLE_MODE",aI="FOCUSING_COMMON_DRAWINGS",lI="FORMULA_EDITOR_ACTIVATED";class rC extends ee{constructor(){super(...arguments),b(this,"_error$",new ce),b(this,"error$",this._error$.asObservable())}dispose(){this._error$.complete()}emit(e){this._error$.next({errorKey:e})}}var Qh=(t=>(t.URL="URL",t.UUID="UUID",t.BASE64="BASE64",t))(Qh||{}),sC=(t=>(t.SUCCUSS="0",t.ERROR_EXCEED_SIZE="1",t.ERROR_IMAGE_TYPE="2",t.ERROR_UPLOAD_COUNT_LIMIT="3",t.ERROR_IMAGE="4",t))(sC||{});const Rc=Te("core.image-io.service"),oC="0.11.0",iC={version:oC};function aC(t="",e=Eo.ZH_CN,n=""){return{id:t,sheetOrder:[],name:n,appVersion:iC.version,locale:e,styles:{},sheets:{},resources:[]}}class lC{constructor(e={}){b(this,"_styles"),b(this,"_cacheMap",new eo(1e5)),this._styles=e,this._generateCacheMap()}each(e){return Object.entries(this._styles).forEach(e),this}search(e,n){return this._cacheMap.has(n)?this._cacheMap.get(n):this._getExistingStyleId(e)||"-1"}get(e){return typeof e!="string"?e:(e=String(e),this._styles[e])}add(e,n){const r=ue(6);return this._styles[r]=e,this._cacheMap.set(n,r),r}setValue(e){if(e==null)return;const n=JSON.stringify(e),r=this.search(e,n);return r!=="-1"?r:this.add(e,n)}addCustomStyle(e,n){n!=null&&(this._styles[e]=n,this._cacheMap.set(JSON.stringify(n),e))}remove(e){this._styles[e]&&(delete this._styles[e],this._cacheMap.delete(JSON.stringify(this._styles[e])))}toJSON(){return this._styles}getStyleByCell(e){let n;e&&et.isObject(e.s)?n=e.s:n=(e==null?void 0:e.s)&&this.get(e.s);const r=e==null?void 0:e.interceptorStyle;return r?{...n,...r}:n}_generateCacheMap(){const{_styles:e,_cacheMap:n}=this;for(const r in e){const s=JSON.stringify(e[r]);n.set(s,r)}}_getExistingStyleId(e){const{_styles:n}=this;for(const r in n)if(et.diffValue(n[r],e))return r;return null}}const uI=(t,e)=>e.length===t.length&&!t.some(n=>e.some(r=>!as.equals(r,n))),cI=(t,e)=>e.length===t.length&&t.every((n,r)=>{const s=e[r];return s.unitId===n.unitId&&s.sheetId===n.sheetId&&as.equals(n.range,s.range)}),na={t:0,b:2,l:2,r:2},uC=t=>({sbr:.6,sbo:t,spr:.6,spo:t}),Tc=90;function Us(t,e,n={}){const r=t.length,{textRotation:s,paddingData:o,horizontalAlign:i=qe.UNSPECIFIED,verticalAlign:a=lr.UNSPECIFIED,wrapStrategy:l=_r.UNSPECIFIED,cellValueType:u}=n,{t:c,r:d,b:h,l:f}=o||na,{vertexAngle:p,centerAngle:g}=qh(s),_={id:"d",body:{dataStream:`${t}${Og}`,textRuns:[{ts:e,st:0,ed:r}],paragraphs:[{startIndex:r,paragraphStyle:{horizontalAlign:i}}],sectionBreaks:[{startIndex:r+1}]},documentStyle:{pageSize:{width:Number.POSITIVE_INFINITY,height:Number.POSITIVE_INFINITY},marginTop:c,marginBottom:h,marginRight:d,marginLeft:f,renderConfig:{horizontalAlign:i,verticalAlign:a,centerAngle:g,vertexAngle:p,wrapStrategy:l,cellValueType:u}},drawings:{},drawingsOrder:[]};return new en(_)}function cC(t){if(!t)return{};const{tr:e,td:n,ht:r,vt:s,tb:o,pd:i}=t;return{textRotation:e,textDirection:n,horizontalAlign:r,verticalAlign:s,wrapStrategy:o,paddingData:i}}function wc(t){if(!t)return{};const{ff:e,fs:n,it:r,bl:s,ul:o,st:i,ol:a,cl:l,bg:u}=t,c={};return e&&(c.ff=e),n&&(c.fs=n),r&&(c.it=r),s&&(c.bl=s),o&&(c.ul=o),i&&(c.st=i),a&&(c.ol=a),l&&(c.cl=l),u&&(c.bg=u),c}function dC(t,e,n){var r;const s=t.getBody();if((r=s.customRanges)!=null&&r.some(i=>i.rangeType===Pn.HYPERLINK))return;const o=le.customRange.add({ranges:[{startOffset:0,endOffset:s.dataStream.length-1,collapsed:!1}],rangeId:n,rangeType:Pn.HYPERLINK,body:s,properties:{url:e,refId:n}});o&&kt.apply(s,o.serialize())}function hC(t){return t!=null}const fC='"Helvetica Neue", Helvetica, Arial, "PingFang SC", "Hiragino Sans GB", "Heiti SC", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif';function Ic(t){const e=fe.ff,n=fe.fs;if(!t){const d=`${n}pt  ${e}`;return{fontCache:d,fontString:d,fontSize:n,originFontSize:n,fontFamily:e}}let r=jr.ITALIC;(t.it===0||t.it===void 0)&&(r=jr.NORMAL);let s=jr.BOLD;(t.bl===0||t.bl===void 0)&&(s=jr.NORMAL);let o=n;t.fs&&(o=Math.ceil(t.fs));let i=e;if(t.ff){let d=t.ff;d=d.replace(/"/g,"").replace(/'/g,""),d.indexOf(" ")>-1&&(d=`"${d}"`),d==null&&(d=e),i=d}const{va:a}=t;let l=o;if(a===vn.SUBSCRIPT||a===vn.SUPERSCRIPT){const d=pC(i,l),{sbr:h,spr:f}=d;l*=a===vn.SUBSCRIPT?h:f}const u=`${r} ${s} ${l}pt ${i}`,c=`${u}, ${fC} `;return{fontCache:u,fontString:c,fontSize:l,originFontSize:o,fontFamily:i}}function pC(t,e){return uC(e)}function qh(t){const{a:e=0,v:n=ut.FALSE}=t||{a:0,v:ut.FALSE};let r=0,s=e;return n===ut.TRUE&&(r=Tc,s=Tc),{centerAngle:r,vertexAngle:s}}class gC{constructor(e,n){b(this,"_columnData",{}),this._config=e,this._columnData=n}getColumnData(){return this._columnData}getColVisible(e){const{_columnData:n}=this,r=n[e];return r?r.hd!==ut.TRUE:!0}getColumnStyle(e){var n;return(n=this._columnData[e])==null?void 0:n.s}setColumnStyle(e,n){const r=this.getColumnOrCreate(e);r.s=n}getHiddenCols(e=0,n=this.getSize()-1){const r=[];let s=!1,o=-1;for(let i=e;i<=n;i++){const a=this.getColVisible(i);s&&a?(s=!1,r.push({rangeType:vt.COLUMN,startColumn:o,endColumn:i-1,startRow:0,endRow:0})):!s&&!a&&(s=!0,o=i)}return s&&r.push({startRow:0,endRow:0,startColumn:o,endColumn:n,rangeType:vt.COLUMN}),r}getVisibleCols(e=0,n=this.getSize()-1){const r=[];let s=!1,o=-1;for(let i=e;i<=n;i++){const a=this.getColVisible(i);s&&!a?(s=!1,r.push({rangeType:vt.COLUMN,startColumn:o,endColumn:i-1,startRow:0,endRow:0})):!s&&a&&(s=!0,o=i)}return s&&r.push({startRow:0,endRow:0,startColumn:o,endColumn:n,rangeType:vt.COLUMN}),r}getColumnDatas(e,n){const r={};let s=0;for(let o=e;o<e+n;o++){const i=this.getColumn(o);r[s]=i??{w:this._config.defaultColumnWidth,hd:ut.FALSE},s++}return r}getSize(){return Ln(this._columnData)}getColumnWidth(e){var n,r;return(r=(n=this._columnData[e])==null?void 0:n.w)!=null?r:this._config.defaultColumnWidth}setColumnWidth(e,n){const r=this._columnData[e];n===this._config.defaultColumnWidth?r&&(delete r.w,Object.keys(r).length===0&&delete this._columnData[e]):this._columnData[e]=r?{...r,w:n}:{w:n}}getColumn(e){return this._columnData[e]}removeColumn(e){delete this._columnData[e]}getColumnOrCreate(e){const{_columnData:n}=this,r=n[e];if(r)return r;const s={};return this._columnData[e]=s,s}setCustomMetadata(e,n){const r=this.getColumn(e);r&&(r.custom=n)}getCustomMetadata(e){var n;return(n=this.getColumn(e))==null?void 0:n.custom}}const mC=2e3;class _C{constructor(e,n,r){b(this,"_rowData"),this._config=e,this._viewModel=n,this._rowData=r}getRowData(){return this._rowData}getRowStyle(e){var n;return(n=this._rowData[e])==null?void 0:n.s}setRowStyle(e,n){const r=this.getRowOrCreate(e);r.s=n}getRowDatas(e,n){const r={};let s=0;for(let o=e;o<e+n;o++){const i=this.getRow(o);r[s]=i??{h:this._config.defaultRowHeight,hd:ut.FALSE},s++}return r}getRowHeight(e,n=1){const{_rowData:r}=this,s=this._config;let o=0;for(let i=0;i<n;i++){const a=r[i+e]||{hd:ut.FALSE,h:s.defaultRowHeight},{ia:l,ah:u,h:c=s.defaultRowHeight}=a;o+=(l==null||l===ut.TRUE)&&typeof u=="number"?u:c}return o}setRowHeight(e,n){const r=this._rowData[e];if(n===this._config.defaultRowHeight)r&&(delete r.h,Object.keys(r).length===0&&delete this._rowData[e]);else{const s=Math.min(n,mC);this._rowData[e]=r?{...r,h:s}:{h:s}}}getRow(e){return this._rowData[e]}removeRow(e){delete this._rowData[e]}getRowOrCreate(e){const{_rowData:n}=this,r=n[e];if(r)return r;const s={};return n[e]=s,s}getHiddenRows(e=0,n=this.getSize()-1){const r=[];let s=!1,o=-1;for(let i=e;i<=n;i++){const a=this.getRowRawVisible(i);s&&a?(s=!1,r.push({startRow:o,endRow:i-1,startColumn:0,endColumn:0,rangeType:vt.ROW})):!s&&!a&&(s=!0,o=i)}return s&&r.push({startRow:o,endRow:n,startColumn:0,endColumn:0,rangeType:vt.ROW}),r}getVisibleRows(e=0,n=this.getSize()-1){const r=[];let s=!1,o=-1;for(let i=e;i<=n;i++){const a=this.getRowRawVisible(i);s&&!a?(s=!1,r.push({startRow:o,endRow:i-1,startColumn:0,endColumn:0,rangeType:vt.ROW})):!s&&a&&(s=!0,o=i)}return s&&r.push({startRow:o,endRow:n,startColumn:0,endColumn:0,rangeType:vt.ROW}),r}getRowRawVisible(e){const n=this.getRow(e);return n?n.hd!==ut.TRUE:!0}getSize(){return Ln(this._rowData)}setCustomMetadata(e,n){const r=this.getRow(e);r&&(r.custom=n)}getCustomMetadata(e){var n;return(n=this.getRow(e))==null?void 0:n.custom}}const dI="DEFAULT_WORKSHEET_ROW_COUNT",yC=1e3,hI="DEFAULT_WORKSHEET_COLUMN_COUNT",vC=20,fI="DEFAULT_WORKSHEET_ROW_HEIGHT",EC=24,pI="DEFAULT_WORKSHEET_COLUMN_WIDTH",bC=88,gI="DEFAULT_WORKSHEET_ROW_TITLE_WIDTH",CC=46,mI="DEFAULT_WORKSHEET_COLUMN_TITLE_HEIGHT",RC=20;function TC(t){const e={name:"Sheet1",id:"sheet-01",tabColor:"",hidden:ut.FALSE,rowCount:yC,columnCount:vC,zoomRatio:1,freeze:{xSplit:0,ySplit:0,startRow:-1,startColumn:-1},scrollTop:0,scrollLeft:0,defaultColumnWidth:bC,defaultRowHeight:EC,mergeData:[],cellData:{},rowData:{},columnData:{},showGridlines:ut.TRUE,rowHeader:{width:CC,hidden:ut.FALSE},columnHeader:{height:RC,hidden:ut.FALSE},rightToLeft:ut.FALSE};return Object.keys(e).forEach(n=>{const r=n;typeof t[r]>"u"&&(t[r]=e[r])}),t}class wC extends ee{constructor(e){super(),b(this,"_cellCache",new Map),b(this,"_rowCache",new Map),b(this,"_columnCache",new Map),b(this,"_hasRow",!1),b(this,"_hasColumn",!1),b(this,"_hasAll",!1),b(this,"_allIndex",-1),b(this,"_mergeData"),b(this,"_rangeMap",new eo(5e4)),b(this,"_skeletonCache",new eo(5e4)),this._init(e.concat())}_init(e){this._mergeData=e,this._createCache(e)}_clearCache(){this._cellCache.clear(),this._rowCache.clear(),this._columnCache.clear(),this._hasAll=!1,this._allIndex=-1,this._rangeMap.clear(),this._skeletonCache.clear(),this._hasColumn=!1,this._hasRow=!1}_createCache(e){let n=0;for(const r of e){const{rangeType:s}=r;s===vt.ROW?this._createRowCache(r,n):s===vt.COLUMN?this._createColumnCache(r,n):s===vt.ALL?this._createCellAllCache(n):this._createCellCache(r,n),n++}}rebuild(e){this._clearCache(),this._init(e.concat())}_createRowCache(e,n){const{startRow:r,endRow:s}=e;for(let o=r;o<=s;o++)this._rowCache.set(o,n),this._hasRow=!0}_createColumnCache(e,n){const{startColumn:r,endColumn:s}=e;for(let o=r;o<=s;o++)this._columnCache.set(o,n),this._hasColumn=!0}_createCellAllCache(e){this._hasAll=!0,this._allIndex=e}_createCellCache(e,n){for(let r=e.startRow;r<=e.endRow;r++){let s=this._cellCache.get(r);s==null&&(s=new Map,this._cellCache.set(r,s));for(let o=e.startColumn;o<=e.endColumn;o++)s.set(o,n)}}add(e){this._mergeData.push(e),this._clearCache(),this._createCache(this._mergeData)}remove(e,n){const r=this._getMergeDataIndex(e,n);r!==-1&&(this._mergeData.splice(r,1),this._clearCache(),this._createCache(this._mergeData))}getMergedCell(e,n){const r=this._getMergeDataIndex(e,n);return r!==-1?this._mergeData[r]:null}getMergeDataIndex(e,n){return this._getMergeDataIndex(e,n)}isRowContainsMergedCell(e){return this._hasAll||!et.isEmptyObject(this._columnCache)?!0:this._mergeData.some(n=>n.startRow<=e&&e<=n.endRow)}isColumnContainsMergedCell(e){return this._hasAll||!et.isEmptyObject(this._rowCache)?!0:this._mergeData.some(n=>n.startColumn<=e&&e<=n.endColumn)}getMergedCellRange(e,n,r,s){const o=[],i=`${e}-${n}-${r}-${s}`;if(this._rangeMap.has(i))return this._getRangeFromCache(i);let a=0;const l=[];for(const u of this._mergeData||[])as.intersects(u,{startRow:e,endRow:r,startColumn:n,endColumn:s})&&(o.push({...u}),l.push(a)),a++;return this._rangeMap.set(i,l),o}getMergedCellRangeForSkeleton(e,n,r,s){const o=[],i=this._mergeData,a=`${e}-${n}-${r}-${s}`;if(this._skeletonCache.has(a))return this._getSkeletonRangeFromCache(a);const l=[];for(let u=0;u<i.length;u++){const{startRow:c,endRow:d,startColumn:h,endColumn:f}=i[u];for(let p=e;p<=r;p++){let g=!1;for(let _=n;_<=s;_++)if(p>=c&&p<=d&&_>=h&&_<=f){o.push({startRow:c,endRow:d,startColumn:h,endColumn:f}),l.push(u),g=!0;break}if(g)break}}return this._skeletonCache.set(a,l),o}_getRangeFromCache(e){const n=this._rangeMap.get(e)||[],r=[];for(const s of n)r.push({...this._mergeData[s]});return r}_getSkeletonRangeFromCache(e){const n=this._skeletonCache.get(e)||[],r=[];for(const s of n)r.push({...this._mergeData[s]});return r}_getMergeDataIndex(e,n){var r;if(this._hasAll)return this._allIndex;if(this._hasRow){const o=this._rowCache.get(e);if(o!==void 0)return o}if(this._hasColumn){const o=this._columnCache.get(n);if(o!==void 0)return o}const s=(r=this._cellCache.get(e))==null?void 0:r.get(n);return s!==void 0?s:-1}getMergeDataSnapshot(){return this._mergeData}dispose(){this._clearCache(),this._mergeData=[]}}class IC extends ee{constructor(e){super(),b(this,"_cellContentInterceptor",null),b(this,"_rowFilteredInterceptor",null),this.getRawCell=e}dispose(){super.dispose(),this._cellContentInterceptor=null,this._rowFilteredInterceptor=null}getCell(e,n,r,s){return this._cellContentInterceptor?this._cellContentInterceptor.getCell(e,n,Hr.Value|Hr.Style,r,s):this.getRawCell(e,n)}getCellValueOnly(e,n){return this._cellContentInterceptor?this._cellContentInterceptor.getCell(e,n,Hr.Value):this.getRawCell(e,n)}getCellStyleOnly(e,n){return this._cellContentInterceptor?this._cellContentInterceptor.getCell(e,n,Hr.Style):this.getRawCell(e,n)}getRowFiltered(e){var n,r;return(r=(n=this._rowFilteredInterceptor)==null?void 0:n.getRowFiltered(e))!=null?r:!1}registerCellContentInterceptor(e){if(this._cellContentInterceptor)throw new Error("[SheetViewModel]: Interceptor already registered.");return this._cellContentInterceptor=e,Zt(()=>this._cellContentInterceptor=null)}registerRowFilteredInterceptor(e){if(this._rowFilteredInterceptor)throw new Error("[SheetViewModel]: Interceptor already registered.");return this._rowFilteredInterceptor=e,Zt(()=>this._rowFilteredInterceptor=null)}}const Sc={isDeepClone:!1,displayRawFormula:!1,ignoreTextRotation:!1};class ao{constructor(e,n,r){b(this,"_sheetId"),b(this,"_snapshot"),b(this,"_cellData"),b(this,"_rowManager"),b(this,"_columnManager"),b(this,"_viewModel"),b(this,"_spanModel"),b(this,"_isRowStylePrecedeColumnStyle",!0),b(this,"_getCellHeight");var s;this.unitId=e,this._styles=r,this._snapshot=TC(n);const{columnData:o,rowData:i,cellData:a}=this._snapshot;this._sheetId=(s=this._snapshot.id)!=null?s:ue(6),this._cellData=new De(a),this._viewModel=new IC((l,u)=>this.getCellRaw(l,u)),this._rowManager=new _C(this._snapshot,this._viewModel,i),this._columnManager=new gC(this._snapshot,o),this._spanModel=new wC(this._snapshot.mergeData)}__interceptViewModel(e){e(this._viewModel)}__registerGetCellHeight(e){return this._getCellHeight=e,Zt(()=>{this._getCellHeight=null})}getSnapshot(){return this._snapshot}getCellHeight(e,n){return this._getCellHeight?this._getCellHeight(e,n):this._snapshot.defaultRowHeight}setMergeData(e){this._snapshot.mergeData=e,this.getSpanModel().rebuild(e)}getSpanModel(){return this._spanModel}setIsRowStylePrecedeColumnStyle(e){this._isRowStylePrecedeColumnStyle=e}getStyleDataByHash(e){return{...this._styles.get(e)}}setStyleData(e){return this._styles.setValue(e)}getColumnStyle(e,n=!1){return n?this._columnManager.getColumnStyle(e):this._styles.get(this._columnManager.getColumnStyle(e))}setColumnStyle(e,n){this._columnManager.setColumnStyle(e,n)}getRowStyle(e,n=!1){return n?this._rowManager.getRowStyle(e):this._styles.get(this._rowManager.getRowStyle(e))}setRowStyle(e,n){this._rowManager.setRowStyle(e,n)}getDefaultCellStyle(){return this._snapshot.defaultStyle}getDefaultCellStyleInternal(){const e=this._snapshot.defaultStyle;return this._styles.get(e)}setDefaultCellStyle(e){this._snapshot.defaultStyle=e}getCellStyle(e,n){const r=this.getCell(e,n);if(r){const s=r.s;return typeof s=="string"?this._styles.get(s):s}return null}getComposedCellStyle(e,n,r){const s=this.getDefaultCellStyleInternal(),o=this.getRowStyle(e),i=this.getColumnStyle(n),a=this.getCell(e,n),l=this._styles.getStyleByCell(a);return r??this._isRowStylePrecedeColumnStyle?ys(s,i,o,a==null?void 0:a.themeStyle,l):ys(s,o,i,a==null?void 0:a.themeStyle,l)}getComposedCellStyleByCellData(e,n,r,s){const o=this.getDefaultCellStyleInternal(),i=this.getRowStyle(e),a=this.getColumnStyle(n),l=this._styles.getStyleByCell(r);return s??this._isRowStylePrecedeColumnStyle?ys(o,a,i,r==null?void 0:r.themeStyle,l):ys(o,i,a,r==null?void 0:r.themeStyle,l)}getCellMatrix(){return this._cellData}getCellMatrixPrintRange(){const e=this.getCellMatrix(),n=this.getMergeData();let r=-1,s=-1,o=-1,i=-1,a=!1,l=!1;return e.forEach((u,c)=>{Object.keys(c).forEach(d=>{const h=+d,f=e.getValue(u,h),p=f!=null&&f.s?this._styles.get(f.s):null,g=(p==null?void 0:p.bd)&&(p.bd.b||p.bd.l||p.bd.r||p.bd.t||p.bd.bc_tr||p.bd.bl_tr||p.bd.ml_tr||p.bd.tl_bc||p.bd.tl_br||p.bd.tl_mr);(f&&(f.v!==null&&f.v!==void 0&&f.v!==""||f.p)||p!=null&&p.bg||g)&&(a?r=Math.min(r,u):(r=u,a=!0),s=Math.max(s,u),l?o=Math.min(o,h):(l=!0,o=h),i=Math.max(i,h))})}),n.forEach(u=>{a?r=Math.min(r,u.startRow):(r=u.startRow,a=!0),s=Math.max(s,u.endRow),l?o=Math.min(o,u.startColumn):(o=u.startColumn,a=!0),i=Math.max(i,u.endColumn)}),!a||!l?null:{startColumn:o,startRow:r,endColumn:i,endRow:s}}getRowManager(){return this._rowManager}getUnitId(){return this.unitId}getSheetId(){return this._sheetId}getColumnManager(){return this._columnManager}getName(){return this._snapshot.name}clone(){const{_snapshot:e}=this,n=et.deepClone(e);return new ao(this.unitId,n,this._styles)}getMergeData(){return this._spanModel.getMergeDataSnapshot()}getMergedCell(e,n){return this._spanModel.getMergedCell(e,n)}getMergedCellRange(e,n,r,s){return this._spanModel.getMergedCellRange(e,n,r,s)}isRowContainsMergedCell(e){return this._spanModel.isRowContainsMergedCell(e)}isColumnContainsMergedCell(e){return this._spanModel.isColumnContainsMergedCell(e)}getCellInfoInMergeData(e,n){const r=this.getMergedCell(e,n);let s=!1,o=!1,i=e,a=n,l=e,u=n;if(r){const{startRow:c,endRow:d,startColumn:h,endColumn:f}=r;e===c&&n===h?(i=d,a=f,l=c,u=h,o=!0):e>=c&&e<=d&&n>=h&&n<=f&&(i=d,a=f,l=c,u=h,s=!0)}return{actualRow:e,actualColumn:n,isMergedMainCell:o,isMerged:s,endRow:i,endColumn:a,startRow:l,startColumn:u}}getCell(e,n){return e<0||n<0?null:this._viewModel.getCell(e,n)}getCellValueOnly(e,n){return e<0||n<0?null:this._viewModel.getCellValueOnly(e,n)}getCellStyleOnly(e,n){return e<0||n<0?null:this._viewModel.getCellStyleOnly(e,n)}getCellRaw(e,n){return this.getCellMatrix().getValue(e,n)}getCellWithFilteredInterceptors(e,n,r,s){return this._viewModel.getCell(e,n,r,s)}getRowFiltered(e){return this._viewModel.getRowFiltered(e)}getRangeFilterRows(e){const n=[];for(let r=e.startRow;r<=e.endRow;r++)this.getRowFiltered(r)&&n.push(r);return n}getMatrixWithMergedCells(e,n,r,s,o=Vr.Raw){const i=this.getCellMatrix(),a=this._spanModel.getMergedCellRange(e,n,r,s),l=new De;return gc(e,r,n,s).forEach((u,c)=>{var d;let h;if(o===Vr.Raw)h=this.getCellRaw(u,c);else if(o===Vr.Intercepted)h=this.getCell(u,c);else if(o===Vr.Both){const f=this.getCellRaw(u,c);if(f){h={...f};const p=(d=this.getCell(u,c))==null?void 0:d.v;hC(p)&&h&&(h.displayV=String(p))}}h&&l.setValue(u,c,h)}),a.forEach(u=>{const{startColumn:c,startRow:d,endColumn:h,endRow:f}=u;gc(d,f,c,h).forEach((p,g)=>{p===d&&g===c&&l.setValue(p,g,{...i.getValue(p,g),rowSpan:f-d+1,colSpan:h-c+1}),(p!==d||g!==c)&&l.realDeleteValue(p,g)})}),l}getRange(e,n,r,s){return typeof e=="object"?new Vi(this,e,{getStyles:()=>this._styles}):new Vi(this,{startRow:e,startColumn:n,endColumn:s||n,endRow:r||e},{getStyles:()=>this._styles})}getScrollLeftTopFromSnapshot(){return{scrollLeft:this._snapshot.scrollLeft,scrollTop:this._snapshot.scrollTop}}getZoomRatio(){return this._snapshot.zoomRatio||1}getConfig(){return this._snapshot}getFreeze(){return this._snapshot.freeze}getMaxColumns(){const{_snapshot:e}=this,{columnCount:n}=e;return n}getMaxRows(){const{_snapshot:e}=this,{rowCount:n}=e;return n}getRowCount(){return this._snapshot.rowCount}setRowCount(e){this._snapshot.rowCount=e}getColumnCount(){return this._snapshot.columnCount}setColumnCount(e){this._snapshot.columnCount=e}isSheetHidden(){return this._snapshot.hidden}hasHiddenGridlines(){const{_snapshot:e}=this,{showGridlines:n}=e;return n===0}getGridlinesColor(){return this.getConfig().gridlinesColor}getTabColor(){const{_snapshot:e}=this,{tabColor:n}=e;return n}getColumnWidth(e){return this.getColumnManager().getColumnWidth(e)}getRowHeight(e){return this._viewModel.getRowFiltered(e)?0:this.getRowManager().getRowHeight(e)}isRowFiltered(e){return this._viewModel.getRowFiltered(e)}getRowVisible(e){return!this.isRowFiltered(e)&&this.getRowRawVisible(e)}getRowRawVisible(e){return this.getRowManager().getRowRawVisible(e)}getHiddenRows(e,n){const r=this.getMaxColumns()-1,s=this._rowManager.getHiddenRows(e,n);return s.forEach(o=>o.endColumn=r),s}getColVisible(e){return this._columnManager.getColVisible(e)}getHiddenCols(e,n){const r=this.getMaxRows()-1,s=this._columnManager.getHiddenCols(e,n);return s.forEach(o=>o.endRow=r),s}getVisibleRows(){const e=this.getRowCount();return this._rowManager.getVisibleRows(0,e-1)}getVisibleCols(){const e=this.getColumnCount();return this._columnManager.getVisibleCols(0,e-1)}isRightToLeft(){const{_snapshot:e}=this,{rightToLeft:n}=e;return n}getLastRowWithContent(){return this._cellData.getLength()-1}getLastColumnWithContent(){return this._cellData.getRange().endColumn}getDataRangeScope(){return this._cellData.getStartEndScope()}cellHasValue(e){return e&&(e.v!==void 0||e.f!==void 0||e.p!==void 0)}iterateByRow(e,n=!0){const{startRow:r,startColumn:s,endRow:o,endColumn:i}=e,a=this;return{[Symbol.iterator]:()=>{let l=r,u=s;return{next(){for(;;){if(u>i&&(l+=1,u=s),l>o)return{done:!0,value:void 0};const c=a.getCell(l,u),d=!c,h=a.getMergedCell(l,u);if(h){if(l!==h.startRow||u!==h.startColumn){u=h.endColumn+1;continue}if(d&&n){u=h.endColumn+1;continue}const f={row:l,col:u,value:c};return f.colSpan=h.endColumn-h.startColumn+1,f.rowSpan=h.endRow-h.startRow+1,u=h.endColumn+1,{done:!1,value:f}}if(d&&n)u+=1;else{const f={row:l,col:u,value:c};return u+=1,{done:!1,value:f}}}}}}}}iterateByColumn(e,n=!0,r=!0){const{startRow:s,startColumn:o,endRow:i,endColumn:a}=e,l=this;return{[Symbol.iterator]:()=>{let u=s,c=o;return{next(){for(;;){if(u>i&&(c+=1,u=s),c>a)return{done:!0,value:void 0};const d=l.getMergedCell(u,c);if(d){const f=u!==d.startRow,p=f||c!==d.startColumn;if(r&&p||!r&&f){u=d.endRow+1;continue}const g=l.getCell(d.startRow,d.startColumn);if(!g&&n){u=d.endRow+1;continue}const _={row:u,col:d.startColumn,value:g};return _.colSpan=d.endColumn-d.startColumn+1,_.rowSpan=d.endRow-d.startRow+1,u=d.endRow+1,{done:!1,value:_}}const h=l.getCell(u,c);if(!h&&n)u+=1;else{const f={row:u,col:c,value:h};return u+=1,{done:!1,value:f}}}}}}}}getCellDocumentModel(e,n,r=Sc){var s;if(!e)return;const{isDeepClone:o,displayRawFormula:i,ignoreTextRotation:a}={...Sc,...r};let l,u="document";const c=cC(n),d=a?fe.tr:c.textRotation||fe.tr;let h=c.horizontalAlign||fe.ht;const f=c.verticalAlign||fe.vt,p=c.wrapStrategy||fe.tb,g=c.paddingData||na;if(e.f&&i)l=Us(e.f.toString(),{},{verticalAlign:f}),h=fe.ht;else if(e.p){const{centerAngle:_,vertexAngle:I}=qh(d);l=this._updateConfigAndGetDocumentModel(o?et.deepClone(e.p):e.p,h,g,{horizontalAlign:h,verticalAlign:f,centerAngle:_,vertexAngle:I,wrapStrategy:p,zeroWidthParagraphBreak:1})}else if(e.v!=null){const _=wc(n);u=Ic(_).fontCache;let I=SC(e);e.t===Mn.FORCE_STRING&&i&&(I=`'${I}`),l=Us(I,_,{...c,textRotation:d,cellValueType:e.t})}return l&&e.linkUrl&&e.linkId&&dC(l,e.linkUrl,e.linkId),{documentModel:l,fontString:u,textRotation:d,wrapStrategy:p,verticalAlign:f,horizontalAlign:h,paddingData:g,fill:(s=n==null?void 0:n.bg)==null?void 0:s.rgb}}_updateConfigAndGetDocumentModel(e,n,r,s){var o,i,a,l,u;if(!s||!((o=e.body)!=null&&o.dataStream))return;e.documentStyle||(e.documentStyle={}),e.documentStyle.marginTop=(i=r.t)!=null?i:0,e.documentStyle.marginBottom=(a=r.b)!=null?a:2,e.documentStyle.marginLeft=(l=r.l)!=null?l:2,e.documentStyle.marginRight=(u=r.r)!=null?u:2,e.documentStyle.pageSize={width:Number.POSITIVE_INFINITY,height:Number.POSITIVE_INFINITY},e.documentStyle.renderConfig={...e.documentStyle.renderConfig,...s};const c=e.body.paragraphs||[];for(const d of c)d.paragraphStyle||(d.paragraphStyle={}),d.paragraphStyle.horizontalAlign=n;return new en(e)}getBlankCellDocumentModel(e,n,r){const s=this.getComposedCellStyleByCellData(n,r,e),o=wc(s),i=this.getCellDocumentModel(e,s,{ignoreTextRotation:!0});if(i!=null)return i.documentModel==null&&(i.documentModel=Us("",o)),i;const a="";let l="document";const u=fe.tr,c=fe.ht,d=fe.vt,h=fe.tb,f=na;return l=Ic({}).fontCache,{documentModel:Us(a,o),fontString:l,textRotation:u,wrapStrategy:h,verticalAlign:d,horizontalAlign:c,paddingData:f}}getCellDocumentModelWithFormula(e,n,r){const s=this.getComposedCellStyleByCellData(n,r,e);return this.getCellDocumentModel(e,s,{isDeepClone:!0,displayRawFormula:!0,ignoreTextRotation:!0})}getCustomMetadata(){return this._snapshot.custom}setCustomMetadata(e){this._snapshot.custom=e}}function SC(t){var e,n;if(!t)return"";const r=(n=(e=t.p)==null?void 0:e.body)==null?void 0:n.dataStream;if(r)return le.transform.getPlainText(r);const s=t.v;return typeof s=="string"?t.t===Mn.BOOLEAN?s.toUpperCase():s.replace(/[\r\n]/g,""):typeof s=="number"?t.t===Mn.BOOLEAN?s?"TRUE":"FALSE":s.toString():typeof s=="boolean"?s?"TRUE":"FALSE":""}function _I(t){if(t===null)return"";if(t!=null&&t.p){const e=t==null?void 0:t.p.body;if(e==null)return"";const n=e.dataStream;return le.transform.getPlainText(n)}return t==null?void 0:t.v}var AC=(t,e,n,r)=>{for(var s=e,o=t.length-1,i;o>=0;o--)(i=t[o])&&(s=i(s)||s);return s},OC=(t,e)=>(n,r)=>e(n,r,t);function yI(t,e){return`${t.getUnitId()}|${e.getSheetId()}`}let lo=class extends Na{constructor(t={},e){super(),b(this,"type",It.UNIVER_SHEET),b(this,"_sheetCreated$",new ce),b(this,"sheetCreated$",this._sheetCreated$.asObservable()),b(this,"_sheetDisposed$",new ce),b(this,"sheetDisposed$",this._sheetDisposed$.asObservable()),b(this,"_activeSheet$",new de(null)),b(this,"activeSheet$",this._activeSheet$.asObservable()),b(this,"_worksheets"),b(this,"_styles"),b(this,"_snapshot"),b(this,"_unitId"),b(this,"_count"),b(this,"_name$"),b(this,"name$"),this._logService=e;const n=aC();et.isEmptyObject(t)?this._snapshot=n:this._snapshot=et.commonExtend(n,t);const{styles:r}=this._snapshot;(this._snapshot.id==null||this._snapshot.id.length===0)&&(this._snapshot.id=ue(6)),this._unitId=this._snapshot.id,this._styles=new lC(r),this._count=1,this._worksheets=new Map,this._name$=new de(t.name||""),this.name$=this._name$.asObservable(),this._parseWorksheetSnapshots()}get _activeSheet(){return this._activeSheet$.getValue()}get name(){return this._name$.getValue()}static isIRangeType(t){return typeof t=="string"||"startRow"in t||"row"in t}dispose(){super.dispose(),this._sheetCreated$.complete(),this._sheetDisposed$.complete(),this._activeSheet$.complete(),this._name$.complete()}save(){return et.deepClone(this._snapshot)}getSnapshot(){return this._snapshot}getName(){return this._snapshot.name}setName(t){this._name$.next(t),this._snapshot.name=t}getUnitId(){return this._unitId}getRev(){var t;return(t=this._snapshot.rev)!=null?t:1}incrementRev(){this._snapshot.rev=this.getRev()+1}setRev(t){this._snapshot.rev=t}addWorksheet(t,e,n){const{sheets:r,sheetOrder:s}=this._snapshot;if(r[t])return!1;r[t]=n,s.splice(e,0,t);const o=new ao(this._unitId,n,this._styles);return this._worksheets.set(t,o),this._sheetCreated$.next(o),!0}getSheetOrders(){return this._snapshot.sheetOrder}getWorksheets(){return this._worksheets}getActiveSpreadsheet(){return this}getStyles(){return this._styles}addStyles(t){Object.entries(t).forEach(([e,n])=>{this._styles.addCustomStyle(e,n)})}removeStyles(t){t.forEach(e=>{this._styles.remove(e)})}getConfig(){return this._snapshot}getIndexBySheetId(t){const{sheetOrder:e}=this._snapshot;return e.findIndex(n=>n===t)}getActiveSheet(t){if(!this._activeSheet&&typeof t>"u")throw new Error(`[Workbook]: no active Worksheet on Workbook ${this._unitId}!`);return this._activeSheet}ensureActiveSheet(){const t=this._activeSheet;if(t)return t;const e=this._snapshot.sheetOrder;for(let r=0,s=e.length;r<s;r++){const o=this._worksheets.get(e[r]);if(o&&o.isSheetHidden()!==ut.TRUE)return this.setActiveSheet(o),o}const n=this._worksheets.get(e[0]);return this.setActiveSheet(n),n}setActiveSheet(t){this._activeSheet$.next(t)}removeSheet(t){const e=this._worksheets.get(t);return e?(this._worksheets.delete(t),this._snapshot.sheetOrder.splice(this._snapshot.sheetOrder.indexOf(t),1),delete this._snapshot.sheets[t],this._sheetDisposed$.next(e),!0):!1}getActiveSheetIndex(){const{sheetOrder:t}=this._snapshot;return t.findIndex(e=>this._worksheets.get(e)===this._activeSheet)}getSheetSize(){return this._snapshot.sheetOrder.length}getSheets(){const{sheetOrder:t}=this._snapshot;return t.map(e=>this._worksheets.get(e))}getSheetsName(){const{sheetOrder:t}=this._snapshot,e=[];return t.forEach(n=>{const r=this._worksheets.get(n);r&&e.push(r.getName())}),e}getSheetIndex(t){const{sheetOrder:e}=this._snapshot;return e.findIndex(n=>t.getSheetId()===n)}getSheetBySheetName(t){const{sheetOrder:e}=this._snapshot,n=e.find(r=>this._worksheets.get(r).getName()===t);return this._worksheets.get(n)}getSheetBySheetId(t){return this._worksheets.get(t)}getSheetByIndex(t){const{sheetOrder:e}=this._snapshot;return this._worksheets.get(e[t])}getHiddenWorksheets(){return this.getSheets().filter(t=>t.getConfig().hidden===ut.TRUE).map(t=>t.getConfig().id)}getUnhiddenWorksheets(){return this.getSheets().filter(t=>t.getConfig().hidden!==ut.TRUE).map(t=>t.getConfig().id)}load(t){this._snapshot=t}checkSheetName(t){return this.getSheetsName().includes(t)}uniqueSheetName(t="Sheet1"){let e=t;for(;this.checkSheetName(e);)e=t+this._count,this._count++;return e}generateNewSheetName(t){let e=t+this._count;for(;this.checkSheetName(e);)e=t+this._count,this._count++;return e}_parseWorksheetSnapshots(){const{_snapshot:t,_worksheets:e}=this,{sheets:n,sheetOrder:r}=t;if(et.isEmptyObject(n)){const s=ue();n[s]={id:s}}for(const s in n){const o=n[s],{name:i}=o;o.name=this.uniqueSheetName(i),o.name!==i&&this._logService.debug("[Workbook]",`The worksheet name ${i} is duplicated, we changed it to ${o.name}. Please fix the problem in your snapshot.`);const a=new ao(this._unitId,o,this._styles);e.set(s,a),r.includes(s)||r.push(s)}this.ensureActiveSheet()}getCustomMetadata(){return this._snapshot.custom}setCustomMetadata(t){this._snapshot.custom=t}};lo=AC([OC(1,je)],lo);class tf extends Na{constructor(e){var n;super(),b(this,"type",It.UNIVER_SLIDE),b(this,"_activePage$",new de(null)),b(this,"activePage$",this._activePage$.asObservable()),b(this,"_name$"),b(this,"name$"),b(this,"_snapshot"),b(this,"_unitId"),this._snapshot={...v1,...e},this._unitId=(n=this._snapshot.id)!=null?n:ue(6),this._name$=new de(this._snapshot.title),this.name$=this._name$.asObservable()}get _activePage(){var e,n;const r=this._activePage$.getValue();if(!r){const s=(e=this.getPageOrder())==null?void 0:e[0];return s?(n=this.getPages())==null?void 0:n[s]:null}return r}setName(e){var n;this._snapshot.title=e,this._name$.next(e),this._unitId=(n=this._snapshot.id)!=null?n:ue(6)}getRev(){return 0}incrementRev(){}setRev(e){}getSnapshot(){return this._snapshot}getUnitId(){return this._unitId}getPages(){var e;return(e=this._snapshot.body)==null?void 0:e.pages}getPageOrder(){var e;return(e=this._snapshot.body)==null?void 0:e.pageOrder}getPage(e){const n=this.getPages();return n==null?void 0:n[e]}getElementsByPage(e){var n;return(n=this.getPage(e))==null?void 0:n.pageElements}getElement(e,n){var r;return(r=this.getElementsByPage(e))==null?void 0:r[n]}getPageSize(){return this._snapshot.pageSize}getBlankPage(){const e=ue(6);return{id:e,pageType:Zd.SLIDE,zIndex:10,title:e,description:"",pageBackgroundFill:{rgb:"rgb(255,255,255)"},pageElements:{}}}setActivePage(e){this._activePage$.next(e)}getActivePage(){return this._activePage}updatePage(e,n){this._snapshot.body&&(this._snapshot.body.pages[e]=n)}appendPage(e){var n;if(!this._snapshot.body)return;this._snapshot.body.pages[e.id]=e;const r=this._activePage,s=this._snapshot.body.pageOrder.indexOf((n=r==null?void 0:r.id)!=null?n:"");this._snapshot.body.pageOrder.splice(s+1,0,e.id)}}var DC=(t,e,n,r)=>{for(var s=e,o=t.length-1,i;o>=0;o--)(i=t[o])&&(s=i(s)||s);return s},Ac=(t,e)=>(n,r)=>e(n,r,t);const ls=Te("univer.current");let ra=class extends ee{constructor(t,e){super(),b(this,"_unitsByType",new Map),b(this,"_createHandler"),b(this,"_ctorByType",new Map),b(this,"_currentUnits",new Map),b(this,"_currentUnits$",new de(this._currentUnits)),b(this,"currentUnits$",this._currentUnits$.asObservable()),b(this,"_unitAdded$",new ce),b(this,"unitAdded$",this._unitAdded$.asObservable()),b(this,"_unitDisposed$",new ce),b(this,"unitDisposed$",this._unitDisposed$.asObservable()),b(this,"_focused$",new de(null)),b(this,"focused$",this._focused$.asObservable()),this._injector=t,this._contextService=e}dispose(){super.dispose(),this._focused$.complete(),this._currentUnits$.complete(),this._unitAdded$.complete(),this._currentUnits.clear(),this._unitsByType.clear()}__setCreateHandler(t){this._createHandler=t}createUnit(t,e,n){return this._createHandler(t,e,this._ctorByType.get(t),n)}registerCtorForType(t,e){return this._ctorByType.set(t,e),{dispose:()=>{this._ctorByType.delete(t)}}}getCurrentTypeOfUnit$(t){return this.currentUnits$.pipe(Ir(e=>{var n;return(n=e.get(t))!=null?n:null}),dg())}getCurrentUnitForType(t){return this._currentUnits.get(t)}getCurrentUnitOfType(t){return this.getCurrentUnitForType(t)}setCurrentUnitForType(t){const e=this._getUnitById(t);if(!e)throw new Error(`[UniverInstanceService]: no document with unitId ${t}!`);this._currentUnits.set(e[1],e[0]),this._currentUnits$.next(this._currentUnits)}getTypeOfUnitAdded$(t){return this._unitAdded$.pipe(En(e=>e.type===t))}__addUnit(t,e){var n;const r=t.type;this._unitsByType.has(r)||this._unitsByType.set(r,[]);const s=this._unitsByType.get(r),o=t.getUnitId();if(s.findIndex(i=>i.getUnitId()===o)!==-1)throw new Error(`[UniverInstanceService]: cannot create a unit with the same unit id: ${o}.`);s.push(t),this._unitAdded$.next(t),((n=e==null?void 0:e.makeCurrent)==null||n)&&this.setCurrentUnitForType(t.getUnitId())}getTypeOfUnitDisposed$(t){return this.unitDisposed$.pipe(En(e=>e.type===t))}getUnit(t,e){var n;const r=(n=this._getUnitById(t))==null?void 0:n[0];return e&&(r==null?void 0:r.type)!==e?null:r}getCurrentUniverDocInstance(){return this.getCurrentUnitForType(It.UNIVER_DOC)}getUniverDocInstance(t){return this.getUnit(t,It.UNIVER_DOC)}getUniverSheetInstance(t){return this.getUnit(t,It.UNIVER_SHEET)}getAllUnitsForType(t){var e;return(e=this._unitsByType.get(t))!=null?e:[]}changeDoc(t,e){const n=this.getAllUnitsForType(It.UNIVER_DOC),r=n.find(s=>s.getUnitId()===t);if(r!=null){const s=n.indexOf(r);n.splice(s,1)}this.__addUnit(e)}get focused(){var t;const e=this._focused$.getValue();return e?(t=this._getUnitById(e))==null?void 0:t[0]:null}focusUnit(t){this._focused$.next(t),this.focused instanceof lo?(this._contextService.setContextValue(Fs,!0),this._contextService.setContextValue(ks,!1),this._contextService.setContextValue(Qr,!0),this._contextService.setContextValue(Ps,!1),this.setCurrentUnitForType(t)):this.focused instanceof en?(this._contextService.setContextValue(Fs,!0),this._contextService.setContextValue(ks,!0),this._contextService.setContextValue(Qr,!1),this._contextService.setContextValue(Ps,!1),this.setCurrentUnitForType(t)):this.focused instanceof tf?(this._contextService.setContextValue(Fs,!0),this._contextService.setContextValue(ks,!1),this._contextService.setContextValue(Qr,!1),this._contextService.setContextValue(Ps,!0),this.setCurrentUnitForType(t)):(this._contextService.setContextValue(Fs,!1),this._contextService.setContextValue(ks,!1),this._contextService.setContextValue(Qr,!1),this._contextService.setContextValue(Ps,!1))}getFocusedUnit(){return this.focused}getUnitType(t){const e=this._getUnitById(t);return e?e[1]:It.UNRECOGNIZED}disposeUnit(t){const e=this._getUnitById(t);if(!e)return!1;const[n,r]=e,s=this._unitsByType.get(r),o=s.indexOf(n);return s.splice(o,1),this._tryResetCurrentOnRemoval(t,r),this._tryResetFocusOnRemoval(t),this._unitDisposed$.next(n),!0}_tryResetCurrentOnRemoval(t,e){const n=this.getCurrentUnitForType(e);(n==null?void 0:n.getUnitId())===t&&(this._currentUnits.set(e,null),this._currentUnits$.next(this._currentUnits))}_tryResetFocusOnRemoval(t){var e;((e=this.focused)==null?void 0:e.getUnitId())===t&&this._focused$.next(null)}_getUnitById(t){for(const[e,n]of this._unitsByType){const r=n.find(s=>s.getUnitId()===t);if(r)return[r,e]}}};ra=DC([Ac(0,Ve(Rr)),Ac(1,ds)],ra);var Vt=(t=>(t[t.Starting=0]="Starting",t[t.Ready=1]="Ready",t[t.Rendered=2]="Rendered",t[t.Steady=3]="Steady",t))(Vt||{});const ef={0:"Starting",1:"Ready",2:"Rendered",3:"Steady"};var xC=(t,e,n,r)=>{for(var s=e,o=t.length-1,i;o>=0;o--)(i=t[o])&&(s=i(s)||s);return s},NC=(t,e)=>(n,r)=>e(n,r,t);class MC extends Error{constructor(e){super(`[LifecycleService]: lifecycle stage "${ef[e]}" will never be reached!`),this.name="LifecycleUnreachableError"}}let Er=class extends ee{constructor(t){super(),b(this,"_lifecycle$",new de(Vt.Starting)),b(this,"lifecycle$",this._lifecycle$.asObservable()),b(this,"_lock",!1),this._logService=t,this._reportProgress(Vt.Starting)}get stage(){return this._lifecycle$.getValue()}set stage(t){if(this._lock)throw new Error("[LifecycleService]: cannot set new stage when related logic is all handled!");if(t<this.stage)throw new Error("[LifecycleService]: lifecycle stage cannot go backward!");t!==this.stage&&(this._lock=!0,this._reportProgress(t),this._lifecycle$.next(t),this._lock=!1)}dispose(){this._lifecycle$.complete(),super.dispose()}onStage(t){return zp(this.lifecycle$.pipe(En(e=>e>=t),Uu(e=>e===t),Ir(()=>{}))).catch(e=>e.name==="EmptyError"?Promise.reject(new MC(t)):Promise.reject(e))}subscribeWithPrevious(){return _d(nf(this.stage),this._lifecycle$.pipe(Ed(1))).pipe(Uu(t=>t===Vt.Steady))}_reportProgress(t){this._logService.debug("[LifecycleService]",`lifecycle progressed to "${ef[t]}".`)}};Er=xC([NC(0,je)],Er);function nf(t){switch(t){case Vt.Starting:return ms(Vt.Starting);case Vt.Ready:return ms(Vt.Starting,Vt.Ready);case Vt.Rendered:return ms(Vt.Starting,Vt.Ready,Vt.Rendered);default:return ms(Vt.Starting,Vt.Ready,Vt.Rendered,Vt.Steady)}}const vI=Te("ILocalStorageService");class fr extends ee{constructor(){super(),b(this,"_currentLocale$",new de(Eo.ZH_CN)),b(this,"currentLocale$",this._currentLocale$.asObservable()),b(this,"_locales",null),b(this,"localeChanged$",new ce),b(this,"t",(e,...n)=>{if(!this._locales)throw new Error("[LocaleService]: Locale not initialized");const r=e.split("."),s=this.resolveKeyPath(this._locales[this._currentLocale],r);if(typeof s=="string"){let o=s;return n.forEach((i,a)=>{o=o.replace(`{${a}}`,i)}),o}else return e}),this.disposeWithMe(Zt(()=>{this._locales=null,this._currentLocale$.complete(),this.localeChanged$.complete()}))}get _currentLocale(){return this._currentLocale$.value}load(e){var n;this._locales=Da((n=this._locales)!=null?n:{},e)}setLocale(e){this._currentLocale$.next(e),this.localeChanged$.next()}getLocales(){var e;return(e=this._locales)==null?void 0:e[this._currentLocale]}getCurrentLocale(){return this._currentLocale}resolveKeyPath(e,n){const r=n.shift();if(r&&e&&r in e){const s=e[r];return n.length>0&&(typeof s=="object"||Array.isArray(s))?this.resolveKeyPath(s,n):s}return null}}var LC=(t,e,n,r)=>{for(var s=e,o=t.length-1,i;o>=0;o--)(i=t[o])&&(s=i(s)||s);return s},FC=(t,e)=>(n,r)=>e(n,r,t);let sa=class{constructor(t){this._userManagerService=t}async list(t){return{list:[{type:Ci.PERSON,mentions:[{objectType:Ci.PERSON,objectId:this._userManagerService.getCurrentUser().userID,label:this._userManagerService.getCurrentUser().name,metadata:{icon:this._userManagerService.getCurrentUser().avatar}}],metadata:{},title:"PEOPLE"}],page:t.page,size:t.size,total:1}}};sa=LC([FC(0,Ve(io))],sa);const kC=Te("univer.service.mention-io");var rf=(t=>(t.INIT="init",t.FETCHING="fetching",t.DONE="done",t))(rf||{});const PC=Te("univer.permission-service");class UC extends ee{constructor(){super(...arguments),b(this,"_permissionPointMap",new Map),b(this,"_permissionPointUpdate$",new ce),b(this,"permissionPointUpdate$",this._permissionPointUpdate$.asObservable()),b(this,"_showComponents",!0)}setShowComponents(e){this._showComponents=e}getShowComponents(){return this._showComponents}deletePermissionPoint(e){const n=this._permissionPointMap.get(e);n&&(n.complete(),this._permissionPointMap.delete(e))}addPermissionPoint(e){const n=e instanceof de,r=n?e.getValue():e;return r.id?this._permissionPointMap.get(r.id)?(console.warn(`${r.id} PermissionPoint already exists`),!1):(this._permissionPointMap.set(r.id,n?e:new de(r)),this._permissionPointUpdate$.next(r),!0):!1}updatePermissionPoint(e,n){const r=this._permissionPointMap.get(e);if(!r)return;const s=r.getValue();s.value=n,s.status=rf.DONE,r.next(s),this._permissionPointUpdate$.next(s)}clearPermissionMap(){this._permissionPointMap.clear()}getPermissionPoint(e){const n=this._permissionPointMap.get(e);if(n)return n.getValue()}getPermissionPoint$(e){const n=this._permissionPointMap.get(e);if(n)return n}composePermission$(e){const n=e.map(r=>{var s;const o=(s=this._permissionPointMap)==null?void 0:s.get(r);if(!o)throw new Error(`[PermissionService]: ${r} permissionPoint does not exist!`);return o.asObservable()});return og(n).pipe(Ir(r=>r))}composePermission(e){return e.map(n=>{var r;const s=(r=this._permissionPointMap)==null?void 0:r.get(n);if(!s)throw new Error(`[PermissionService]: ${n} permissionPoint does not exist!`);return s.getValue()})}getAllPermissionPoint(){const e=new Map;return this._permissionPointMap.forEach((n,r)=>{e.set(r,n)}),e}}function BC(t,e){if(!e)return t;const n=[];for(const r of t){const s=e.find(([o])=>o===r[0]);if(s){if(s[1]===null)continue;n.push([r[0],s[1]])}else n.push(r)}return n}var $C=(t,e,n,r)=>{for(var s=e,o=t.length-1,i;o>=0;o--)(i=t[o])&&(s=i(s)||s);return s},ii=(t,e)=>(n,r)=>e(n,r,t);const HC=4,sf=Symbol("DependentOn");class Oc extends ee{onStarting(){}onReady(){}onRendered(){}onSteady(){}getUnitType(){return this.constructor.type}getPluginName(){return this.constructor.pluginName}}b(Oc,"pluginName"),b(Oc,"type",It.UNIVER_UNKNOWN);class jC{constructor(){b(this,"_plugins",[])}addPlugin(e){this._plugins.push(e)}removePlugins(){const e=this._plugins.slice();return this._plugins.length=0,e}forEachPlugin(e){this._plugins.forEach(e)}}function EI(...t){return function(e){e[sf]=t}}let uo=class{constructor(t,e,n){b(this,"_pluginRegistry",new Map),b(this,"_pluginStore",new jC),b(this,"_seenPlugins",new Set),b(this,"_loadedPlugins",new Set),b(this,"_loadedPluginTypes",new Set([It.UNIVER_UNKNOWN])),b(this,"_flushTimerByType",new Map),this._injector=t,this._lifecycleService=e,this._logService=n}dispose(){this._pluginStore.removePlugins().forEach(t=>t.dispose()),this._flushTimerByType.forEach(t=>clearTimeout(t))}registerPlugin(t,e){this._assertPluginValid(t);const n={plugin:t,options:e};this._pluginRegistry.set(t.pluginName,n),this._logService.debug("[PluginService]",`Plugin "${t.pluginName}" registered.`);const{type:r}=t;this._loadedPluginTypes.has(r)&&(r===It.UNIVER_UNKNOWN?this._loadFromPlugins([n]):this._flushType(r))}startPluginsForType(t){this._loadedPluginTypes.has(t)||this._loadPluginsForType(t)}_loadPluginsForType(t){const e=Array.from(this._pluginRegistry.keys()),n=[];e.forEach(r=>{const s=this._pluginRegistry.get(r);s.plugin.type===t&&n.push(s)}),this._loadFromPlugins(n),this._loadedPluginTypes.add(t)}_assertPluginValid(t){const{type:e,pluginName:n}=t;if(e===It.UNRECOGNIZED)throw new Error(`[PluginService]: invalid plugin type for ${t.name}. Please assign a "type" to your plugin.`);if(!n)throw new Error(`[PluginService]: no plugin name for ${t.name}. Please assign a "pluginName" to your plugin.`);if(this._seenPlugins.has(n))throw new Error(`[PluginService]: duplicated plugin name for "${n}". Maybe a plugin that dependents on "${n} has already registered it. In that case please register "${n}" before the that plugin.`);this._seenPlugins.add(t.pluginName)}_flushType(t){this._flushTimerByType.get(t)===void 0&&this._flushTimerByType.set(t,setTimeout(()=>{this._loadPluginsForType(t),this._flushTimerByType.delete(t)},HC))}_loadFromPlugins(t){const e=[],n=new Set,r=o=>{const{plugin:i}=o,{pluginName:a}=i;if(this._loadedPlugins.has(a)||n.has(a))return;n.add(a),this._pluginRegistry.delete(a);const l=i[sf];l&&l.forEach(u=>{const c=this._pluginRegistry.get(u.pluginName);if(c)r(c);else if(!this._seenPlugins.has(u.pluginName)&&!n.has(u.pluginName)){if(i.type===It.UNIVER_UNKNOWN&&u.type!==It.UNIVER_UNKNOWN)throw new Error(`[PluginService]: cannot register a plugin with Univer type that depends on a plugin with other type. The dependent is ${i.pluginName} and the dependency is ${u.pluginName}.`);i.type!==u.type&&u.type!==It.UNIVER_UNKNOWN&&this._logService.debug("[PluginService]",`Plugin "${a}" depends on "${u.pluginName}" which has different type.`),this._logService.debug("[PluginService]",`Plugin "${a}" depends on "${u.pluginName}" which is not registered. Univer will automatically register it with default configuration.`),this._assertPluginValid(u),r({plugin:u,options:void 0})}}),e.push(o)};t.forEach(o=>r(o));const s=e.map(o=>this._initPlugin(o.plugin,o.options));this._pluginsRunLifecycle(s)}_pluginsRunLifecycle(t){const e=this._lifecycleService.stage;if(nf(e).subscribe(n=>this._runStage(t,n)),e!==Vt.Steady){const n=this._lifecycleService.lifecycle$.pipe(Ed(1)).subscribe(r=>{this._runStage(t,r),r===Vt.Steady&&n.unsubscribe()})}}_runStage(t,e){t.forEach(n=>{switch(e){case Vt.Starting:n.onStarting();break;case Vt.Ready:n.onReady();break;case Vt.Rendered:n.onRendered();break;case Vt.Steady:n.onSteady();break}})}_initPlugin(t,e){const n=this._injector.createInstance(t,e);return this._pluginStore.addPlugin(n),this._loadedPlugins.add(t.pluginName),this._logService.debug("[PluginService]",`Plugin "${n.getPluginName()}" loaded.`),n}};uo=$C([ii(0,Ve(Rr)),ii(1,Ve(Er)),ii(2,je)],uo);const Dc=Te("resource-loader-service");var VC=(t,e,n,r)=>{for(var s=e,o=t.length-1,i;o>=0;o--)(i=t[o])&&(s=i(s)||s);return s},WC=(t,e)=>(n,r)=>e(n,r,t);let oa=class extends ee{constructor(t){super(),b(this,"_resourceMap",new Map),b(this,"_register$",new ce),b(this,"register$",this._register$.asObservable()),this._logService=t}getAllResourceHooks(){return[...this._resourceMap.values()]}getResources(t,e){return e?this.getResourcesByType(t,e):this.getAllResourceHooks().map(n=>{const r=n.toJson(t);return{name:n.pluginName,data:r}})}getResourcesByType(t,e){return this.getAllResourceHooks().filter(n=>n.businesses.includes(e)).map(n=>{const r=n.toJson(t);return{name:n.pluginName,data:r}})}registerPluginResource(t){const e=t.pluginName;if(this._resourceMap.has(e))throw new Error(`the pluginName is registered {${e}}`);return this._resourceMap.set(e,t),this._register$.next(t),Zt(()=>this._resourceMap.delete(e))}disposePluginResource(t){this._resourceMap.delete(t)}loadResources(t,e){this.getAllResourceHooks().forEach(n=>{var r;const s=(r=e==null?void 0:e.find(o=>o.name===n.pluginName))==null?void 0:r.data;if(s)try{const o=n.parseJson(s);n.onLoad(t,o)}catch(o){this._logService.error("[ResourceManagerService]","loadResources error",o)}})}unloadResources(t,e){this.getAllResourceHooks().filter(n=>n.businesses.includes(e)).forEach(n=>{n.onUnLoad(t)})}dispose(){this._register$.complete(),this._resourceMap.clear()}};oa=VC([WC(0,je)],oa);class ia extends ee{constructor(){super(),b(this,"_darkMode$",new de(!1)),b(this,"darkMode$",this._darkMode$.asObservable()),b(this,"_validColorCache",new Map),b(this,"_currentTheme",_s),b(this,"_currentTheme$",new de(this._currentTheme)),b(this,"currentTheme$",this._currentTheme$.asObservable()),this.disposeWithMe(Zt(()=>{this._currentTheme=_s,this._currentTheme$.complete(),this._darkMode$.complete()}))}get darkMode(){return this._darkMode$.getValue()}isValidThemeColor(e){if(this._validColorCache.has(e))return this._validColorCache.get(e);let n=!1;const r=e.split(".");if(r.length===1)n=e in _s;else if(r.length===2){const[s,o]=r;n=s in _s&&o in this._currentTheme[s]}return this._validColorCache.set(e,n),n}getCurrentTheme(){return this._currentTheme}setTheme(e){this._currentTheme=e,this._currentTheme$.next(e)}setDarkMode(e){this._darkMode$.next(e)}getColorFromTheme(e){return h_(this._currentTheme,e)}}var GC=(t,e,n,r)=>{for(var s=e,o=t.length-1,i;o>=0;o--)(i=t[o])&&(s=i(s)||s);return s},ai=(t,e)=>(n,r)=>e(n,r,t);const Cl=Te("univer.undo-redo.service"),YC=20;class of{dispose(){}async dispatchToHandlers(){return!1}}const zC="univer.command.redo",KC="univer.command.undo",XC=new class extends of{constructor(){super(...arguments),b(this,"type",hs.COMMAND),b(this,"id",KC)}handler(t){const e=t.get(Cl),n=e.pitchTopUndoElement();if(!n)return!1;const r=t.get(Co);return ka(n.undoMutations,r)?(e.popUndoToRedo(),!0):!1}},JC=new class extends of{constructor(){super(...arguments),b(this,"type",hs.COMMAND),b(this,"id",zC)}handler(t){const e=t.get(Cl),n=e.pitchTopRedoElement();if(!n)return!1;const r=t.get(Co);return ka(n.redoMutations,r)?(e.popRedoToUndo(),!0):!1}};let aa=class extends ee{constructor(t,e,n){super(),b(this,"undoRedoStatus$"),b(this,"_undoRedoStatus$",new de({undos:0,redos:0})),b(this,"_undoStacks",new Map),b(this,"_redoStacks",new Map),b(this,"_batchingStatus",new Map),this._univerInstanceService=t,this._commandService=e,this._contextService=n,this.undoRedoStatus$=this._undoRedoStatus$.asObservable(),this.disposeWithMe(this._commandService.registerCommand(XC)),this.disposeWithMe(this._commandService.registerCommand(JC)),this.disposeWithMe(Zt(()=>this._undoRedoStatus$.complete())),this.disposeWithMe(Zt(this._univerInstanceService.focused$.subscribe(()=>this._updateStatus())))}pushUndoRedo(t){const{unitID:e}=t,n=this._getRedoStack(e,!0),r=this._getUndoStack(e,!0);if(n.length=0,this._batchingStatus.has(t.unitID)){const o=this._batchingStatus.get(t.unitID),i=this._pitchUndoElement(t.unitID);o===0||!i?(s(t),this._batchingStatus.set(t.unitID,1)):this._tryBatchingElements(i,t)}else s(t);function s(o){r.push(o),r.length>YC&&r.splice(0,1)}this._updateStatus()}clearUndoRedo(t){const e=this._getRedoStack(t);e&&(e.length=0);const n=this._getUndoStack(t);n&&(n.length=0),this._updateStatus()}pitchTopUndoElement(){const t=this._getFocusedUnitId();return this._pitchUndoElement(t)}pitchTopRedoElement(){const t=this._getFocusedUnitId();return this._pitchRedoElement(t)}_pitchUndoElement(t){const e=this._getUndoStack(t);return e!=null&&e.length?e[e.length-1]:null}_pitchRedoElement(t){const e=this._getRedoStack(t);return e!=null&&e.length?e[e.length-1]:null}popUndoToRedo(){const t=this._getUndoStackForFocused().pop();t&&(this._getRedoStackForFocused().push(t),this._updateStatus())}popRedoToUndo(){const t=this._getRedoStackForFocused().pop();t&&(this._getUndoStackForFocused().push(t),this._updateStatus())}rollback(t,e){const n=e||this._getFocusedUnitId(),r=this._getUndoStack(n),s=r==null?void 0:r[(r==null?void 0:r.length)-1];s&&s.id===t&&(r.pop(),ka(s.undoMutations,this._commandService))}__tempBatchingUndoRedo(t){if(this._batchingStatus.has(t))throw new Error("[LocalUndoRedoService]: cannot batching undo redo twice at the same time!");return this._batchingStatus.set(t,0),Zt(()=>this._batchingStatus.delete(t))}_updateStatus(){var t,e;const n=this._getFocusedUnitId(),r=n&&((t=this._undoStacks.get(n))==null?void 0:t.length)||0,s=n&&((e=this._redoStacks.get(n))==null?void 0:e.length)||0;this._undoRedoStatus$.next({undos:r,redos:s})}_getUndoStack(t,e=!1){let n=this._undoStacks.get(t);return!n&&e&&(n=[],this._undoStacks.set(t,n)),n||null}_getRedoStack(t,e=!1){let n=this._redoStacks.get(t);return!n&&e&&(n=[],this._redoStacks.set(t,n)),n||null}_getUndoStackForFocused(){const t=this._getFocusedUnitId();if(!t)throw new Error("No focused univer instance!");return this._getUndoStack(t,!0)}_getRedoStackForFocused(){const t=this._getFocusedUnitId();if(!t)throw new Error("No focused univer instance!");return this._getRedoStack(t,!0)}_tryBatchingElements(t,e){t.redoMutations.push(...e.redoMutations),t.undoMutations.push(...e.undoMutations)}_getFocusedUnitId(){var t,e,n,r;let s="";const o=this._contextService.getContextValue(Qr),i=this._contextService.getContextValue(nC),a=this._contextService.getContextValue(eC);return o?i?s=Cd:a?s=bd:s=(e=(t=this._univerInstanceService.getFocusedUnit())==null?void 0:t.getUnitId())!=null?e:"":s=(r=(n=this._univerInstanceService.getFocusedUnit())==null?void 0:n.getUnitId())!=null?r:"",s}};aa=GC([ai(0,ls),ai(1,Co),ai(2,ds)],aa);class ZC{constructor(e,n=100){b(this,"_imageCacheMap"),this._injector=e,this._imageCacheMap=new eo(n)}_getImageCacheKey(e,n){return`${e}-${n}`}getImage(e,n,r,s){const o=this._getImageCacheKey(e,n);return this._imageCacheMap.get(o)||((async()=>{const a=new Image,l=this._injector.has(Rc)?this._injector.get(Rc):null;if(e===Qh.UUID)try{a.src=await(l==null?void 0:l.getImage(n))||""}catch(u){console.error(u)}else a.src=n;a.onload=()=>{a.removeAttribute("data-error"),r==null||r()},a.onerror=()=>{a.setAttribute("data-error","true"),s==null||s()},this._imageCacheMap.set(o,a)})(),null)}}function bI(t){return!(t.length===0||t.length>31||t.startsWith("'")||t.endsWith("'")||/[:\\\/\?\*\[\]]/.test(t))}function CI(t,e){return!(!t||t.length===0||t.length>255||e.has(t)||/[ :\\\/\?\*\[\]]/.test(t)||!/^[\p{L}_]/u.test(t)||/^\$?[A-Za-z]{1,3}\$?[0-9]+$/.test(t)||/^[rR]\d+[cC]\d+$/.test(t)||/^\d+$/.test(t))}const xc=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],li=1,kr=8;class Rl{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[n,r]=new Uint8Array(e,0,2);if(n!==219)throw new Error("Data does not appear to be in a KDBush format.");const s=r>>4;if(s!==li)throw new Error(`Got v${s} data when expected v${li}.`);const o=xc[r&15];if(!o)throw new Error("Unrecognized array type.");const[i]=new Uint16Array(e,2,1),[a]=new Uint32Array(e,4,1);return new Rl(a,i,o,e)}constructor(e,n=64,r=Float64Array,s){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+n,2),65535),this.ArrayType=r,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const o=xc.indexOf(this.ArrayType),i=e*2*this.ArrayType.BYTES_PER_ELEMENT,a=e*this.IndexArrayType.BYTES_PER_ELEMENT,l=(8-a%8)%8;if(o<0)throw new Error(`Unexpected typed array class: ${r}.`);s&&s instanceof ArrayBuffer?(this.data=s,this.ids=new this.IndexArrayType(this.data,kr,e),this.coords=new this.ArrayType(this.data,kr+a+l,e*2),this._pos=e*2,this._finished=!0):(this.data=new ArrayBuffer(kr+i+a+l),this.ids=new this.IndexArrayType(this.data,kr,e),this.coords=new this.ArrayType(this.data,kr+a+l,e*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(li<<4)+o]),new Uint16Array(this.data,2,1)[0]=n,new Uint32Array(this.data,4,1)[0]=e)}add(e,n){const r=this._pos>>1;return this.ids[r]=r,this.coords[this._pos++]=e,this.coords[this._pos++]=n,r}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return la(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,n,r,s){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:o,coords:i,nodeSize:a}=this,l=[0,o.length-1,0],u=[];for(;l.length;){const c=l.pop()||0,d=l.pop()||0,h=l.pop()||0;if(d-h<=a){for(let _=h;_<=d;_++){const I=i[2*_],U=i[2*_+1];I>=e&&I<=r&&U>=n&&U<=s&&u.push(o[_])}continue}const f=h+d>>1,p=i[2*f],g=i[2*f+1];p>=e&&p<=r&&g>=n&&g<=s&&u.push(o[f]),(c===0?e<=p:n<=g)&&(l.push(h),l.push(f-1),l.push(1-c)),(c===0?r>=p:s>=g)&&(l.push(f+1),l.push(d),l.push(1-c))}return u}within(e,n,r){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:s,coords:o,nodeSize:i}=this,a=[0,s.length-1,0],l=[],u=r*r;for(;a.length;){const c=a.pop()||0,d=a.pop()||0,h=a.pop()||0;if(d-h<=i){for(let _=h;_<=d;_++)Nc(o[2*_],o[2*_+1],e,n)<=u&&l.push(s[_]);continue}const f=h+d>>1,p=o[2*f],g=o[2*f+1];Nc(p,g,e,n)<=u&&l.push(s[f]),(c===0?e-r<=p:n-r<=g)&&(a.push(h),a.push(f-1),a.push(1-c)),(c===0?e+r>=p:n+r>=g)&&(a.push(f+1),a.push(d),a.push(1-c))}return l}}function la(t,e,n,r,s,o){if(s-r<=n)return;const i=r+s>>1;af(t,e,i,r,s,o),la(t,e,n,r,i-1,1-o),la(t,e,n,i+1,s,1-o)}function af(t,e,n,r,s,o){for(;s>r;){if(s-r>600){const u=s-r+1,c=n-r+1,d=Math.log(u),h=.5*Math.exp(2*d/3),f=.5*Math.sqrt(d*h*(u-h)/u)*(c-u/2<0?-1:1),p=Math.max(r,Math.floor(n-c*h/u+f)),g=Math.min(s,Math.floor(n+(u-c)*h/u+f));af(t,e,n,p,g,o)}const i=e[2*n+o];let a=r,l=s;for(Pr(t,e,r,n),e[2*s+o]>i&&Pr(t,e,r,s);a<l;){for(Pr(t,e,a,l),a++,l--;e[2*a+o]<i;)a++;for(;e[2*l+o]>i;)l--}e[2*r+o]===i?Pr(t,e,r,l):(l++,Pr(t,e,l,s)),l<=n&&(r=l+1),n<=l&&(s=l-1)}}function Pr(t,e,n,r){ui(t,n,r),ui(e,2*n,2*r),ui(e,2*n+1,2*r+1)}function ui(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function Nc(t,e,n,r){const s=t-n,o=e-r;return s*s+o*o}class RI{constructor(e=!1){b(this,"_tree",new Map),b(this,"_oneCellCache",new Map),b(this,"_kdTree",new Map),this._enableOneCellCache=e}dispose(){this.clear()}getTree(e,n){return this._tree.has(e)||this._tree.set(e,new Map),this._tree.get(e).has(n)||this._tree.get(e).set(n,new Wi),this._tree.get(e).get(n)}_getOneCellCache(e,n,r,s){return this._oneCellCache.has(e)||this._oneCellCache.set(e,new Map),this._oneCellCache.get(e).has(n)||this._oneCellCache.get(e).set(n,new Map),this._oneCellCache.get(e).get(n).has(r)||this._oneCellCache.get(e).get(n).set(r,new Map),this._oneCellCache.get(e).get(n).get(r).has(s)||this._oneCellCache.get(e).get(n).get(r).set(s,new Set),this._oneCellCache.get(e).get(n).get(r).get(s)}_removeOneCellCache(e,n,r,s,o){const i=this._oneCellCache.get(e);if(!i)return;const a=i.get(n);if(!a)return;const l=a.get(r);if(!l)return;const u=l.get(s);u&&u.delete(o)}_removeCellCacheByRange(e){const{unitId:n,sheetId:r,range:s,id:o}=e,i=this._oneCellCache.get(n);if(!i)return;const a=i.get(r);if(!a)return;const{startRow:l,startColumn:u,endRow:c,endColumn:d}=s;for(let h=l;h<=c;h++){const f=a.get(h);if(f)for(let p=u;p<=d;p++){const g=f.get(p);g&&g.delete(o)}}}_insertOneCellCache(e,n,r,s,o){this._getOneCellCache(e,n,r,s).add(o)}_getRdTreeItems(e){const n=[];for(const[r,s]of e)for(const[o,i]of s)n.push({x:o,y:r,ids:i});return n}_searchByOneCellCache(e){var n;const{unitId:r,sheetId:s,range:o}=e,{startRow:i,startColumn:a,endRow:l,endColumn:u}=o,c=(n=this._kdTree.get(r))==null?void 0:n.get(s);if(!c)return[];const{tree:d,items:h}=c,f=d.range(a,i,u,l),p=[];for(const g of f){const _=h[g];p.push(...Array.from(_.ids))}return p}openKdTree(){var e;for(const[n,r]of this._oneCellCache){this._kdTree.has(n)||this._kdTree.set(n,new Map);for(const[s,o]of r){const i=this._getRdTreeItems(o),a=new Rl(i.length);(e=this._kdTree.get(n))==null||e.set(s,{tree:a,items:i});for(const l of i)a.add(l.x,l.y);a.finish()}}}closeKdTree(){var e;for(const[n,r]of this._oneCellCache)for(const[s,o]of r)(e=this._kdTree.get(n))==null||e.set(s,void 0)}insert(e){const{unitId:n,sheetId:r,range:s,id:o}=e;if(!n||n.length===0)return;let{startRow:i,endRow:a,startColumn:l,endColumn:u}=s;if(this._enableOneCellCache&&i===a&&l===u){this._insertOneCellCache(n,r,i,l,o);return}const c=this.getTree(n,r);Number.isNaN(i)&&(i=0),Number.isNaN(l)&&(l=0),Number.isNaN(a)&&(a=Number.POSITIVE_INFINITY),Number.isNaN(u)&&(u=Number.POSITIVE_INFINITY),c.insert({minX:l,minY:i,maxX:u,maxY:a,id:o})}bulkInsert(e){for(const n of e)this.insert(n)}*searchGenerator(e){var n;const{unitId:r,sheetId:s,range:o}=e;if(this._enableOneCellCache){const l=this._searchByOneCellCache(e);for(const u of l)yield u}const i=(n=this._tree.get(r))==null?void 0:n.get(s);if(!i)return;const a=i.search({minX:o.startColumn,minY:o.startRow,maxX:o.endColumn,maxY:o.endRow});for(const l of a)yield l.id}bulkSearch(e,n){const r=new Set;for(const s of e)for(const o of this.searchGenerator(s))(n==null?void 0:n.has(o))!==!0&&r.add(o);return r}removeById(e,n){var r,s;n?((r=this._tree.get(e))==null||r.delete(n),(s=this._oneCellCache.get(e))==null||s.delete(n)):(this._tree.delete(e),this._oneCellCache.delete(e))}_removeRTreeItem(e){const{unitId:n,sheetId:r,range:s,id:o}=e,i=this.getTree(n,r),a=i.search({minX:s.startColumn,minY:s.startRow,maxX:s.endColumn,maxY:s.endRow});for(let l=0;l<a.length;l++)a[l].id===o&&i.remove(a[l])}remove(e){const{unitId:n,sheetId:r,range:s,id:o}=e,{startRow:i,startColumn:a,endRow:l,endColumn:u}=s;this._enableOneCellCache?i===l&&a===u?this._removeOneCellCache(n,r,s.startRow,s.startColumn,o):(this._removeCellCacheByRange(e),this._removeRTreeItem(e)):this._removeRTreeItem(e)}bulkRemove(e){for(const n of e)this.remove(n)}clear(){this._tree.clear(),this._oneCellCache.clear()}toJSON(){const e={};return this._tree.forEach((n,r)=>{e[r]={},n.forEach((s,o)=>{e[r][o]=s.toJSON()})}),e}fromJSON(e){this._tree.clear();for(const n in e){this._tree.set(n,new Map);for(const r in e[n]){const s=new Wi;s.fromJSON(e[n][r]),this._tree.get(n).set(r,s)}}}}function TI(t){return new Promise(e=>setTimeout(e,t))}function wI(t=1){return new Promise(e=>{let n=0;const r=()=>{n++,n>=t?e():requestAnimationFrame(r)};requestAnimationFrame(r)})}var QC=(t,e,n,r)=>{for(var s=e,o=t.length-1,i;o>=0;o--)(i=t[o])&&(s=i(s)||s);return s},qC=(t,e)=>(n,r)=>e(n,r,t);let ua=class extends ee{constructor(t){super(),b(this,"_fontLocale"),b(this,"_dirty",!0),this._localeService=t,this._localeInitial()}get dirty(){return this._dirty}getFontLocale(){return this._fontLocale}makeDirty(t){this._dirty=t}dispose(){super.dispose(),this._fontLocale=null}_localeInitial(){}};ua=QC([qC(0,Ve(fr))],ua);var tR=(t,e,n,r)=>{for(var s=e,o=t.length-1,i;o>=0;o--)(i=t[o])&&(s=i(s)||s);return s},Bs=(t,e)=>(n,r)=>e(n,r,t);let Mc=class extends ua{constructor(t,e,n,r,s,o){super(n),b(this,"_worksheetData"),b(this,"_renderRawFormula",!1),b(this,"_cellData"),b(this,"_imageCacheMap"),b(this,"_skipAutoHeightForMergedCells",!0),b(this,"_rowTotalHeight",0),b(this,"_columnTotalWidth",0),b(this,"_rowHeaderWidth",0),b(this,"_columnHeaderHeight",0),b(this,"_rowHeightAccumulation",[]),b(this,"_columnWidthAccumulation",[]),b(this,"_marginTop",0),b(this,"_marginLeft",0),b(this,"_scaleX"),b(this,"_scaleY"),b(this,"_scrollX"),b(this,"_scrollY"),this.worksheet=t,this._styles=e,this._contextService=r,this._configService=s,this._injector=o,this._worksheetData=this.worksheet.getConfig(),this._cellData=this.worksheet.getCellMatrix(),this._imageCacheMap=new ZC(this._injector),this.initConfig()}initConfig(){var t,e;this._skipAutoHeightForMergedCells=!((t=this._configService.getConfig(xg))!=null&&t),this.worksheet.setIsRowStylePrecedeColumnStyle((e=this._configService.getConfig(Dg))!=null?e:!1)}resetCache(){}getWorksheetConfig(){return this._worksheetData}getLocation(){return[this.worksheet.getUnitId(),this.worksheet.getSheetId()]}set columnHeaderHeight(t){this._columnHeaderHeight=t,this._worksheetData.columnHeader.height=t}set rowHeaderWidth(t){this._rowHeaderWidth=t,this._worksheetData.rowHeader.width=t}get rowHeightAccumulation(){return this._rowHeightAccumulation}get rowTotalHeight(){return this._rowTotalHeight}get columnWidthAccumulation(){return this._columnWidthAccumulation}get columnTotalWidth(){return this._columnTotalWidth}get rowHeaderWidth(){return this._rowHeaderWidth}get columnHeaderHeight(){return this._columnHeaderHeight}setMarginLeft(t){this._marginLeft=t}setMarginTop(t){this._marginTop=t}setScale(t,e){this._updateLayout(),this._scaleX=t,this._scaleY=e||t,this._updateLayout()}setScroll(t,e){et.isDefine(t)&&(this._scrollX=t),et.isDefine(e)&&(this._scrollY=e)}get scrollX(){return this._scrollX}get scrollY(){return this._scrollY}get scaleX(){return this._scaleX}get scaleY(){return this._scaleY}get rowHeaderWidthAndMarginLeft(){return this.rowHeaderWidth+this._marginLeft}get columnHeaderHeightAndMarginTop(){return this.columnHeaderHeight+this._marginTop}get imageCacheMap(){return this._imageCacheMap}_generateRowMatrixCache(t,e,n){let r=0;const s=[],o=e;for(let i=0;i<t;i++){let a=n;if(this.worksheet.getRowFiltered(i))a=0;else if(o[i]!=null){const l=o[i];if(!l)continue;const{h:u=n,ah:c,ia:d}=l;(d==null||d===ut.TRUE)&&typeof c=="number"?a=c:a=u,l.hd===ut.TRUE&&(a=0)}r+=a,s.push(r)}return{rowTotalHeight:r,rowHeightAccumulation:s}}_generateColumnMatrixCache(t,e,n){let r=0;const s=[],o=e;for(let i=0;i<t;i++){let a=n;if(o[i]!=null){const l=o[i];if(!l)continue;l.w!=null&&(a=l.w),l.hd===ut.TRUE&&(a=0)}r+=a,s.push(r)}return{columnTotalWidth:r,columnWidthAccumulation:s}}intersectMergeRange(t,e){return!!this.worksheet.getMergedCell(t,e)}_getOverflowBound(t,e,n,r,s=qe.LEFT){let o=0;if(e>n){const i=this._columnWidthAccumulation.length-1;for(let a=e;a>=n;a--){const l=a,u=this.worksheet.getCell(t,l);if(!Vu(u)&&l!==e||this.intersectMergeRange(t,l))return l===e?l:l+1>i?i:l+1;const{startX:c,endX:d}=Ur(t,l,this.rowHeightAccumulation,this.columnWidthAccumulation);if(s===qe.CENTER&&l===e?o+=(d-c)/2:o+=d-c,r<o)return l}return e}for(let i=e;i<=n;i++){const a=i,l=this.worksheet.getCell(t,a);if(!Vu(l)&&a!==e||this.intersectMergeRange(t,a))return a===e?a:a-1<0?0:a-1;const{startX:u,endX:c}=Ur(t,a,this.rowHeightAccumulation,this.columnWidthAccumulation);if(s===qe.CENTER&&a===e?o+=(c-u)/2:o+=c-u,r<o)return a}return n}_updateLayout(){if(!this.dirty)return;const{rowData:t,columnData:e,defaultRowHeight:n,defaultColumnWidth:r,rowCount:s,columnCount:o,rowHeader:i,columnHeader:a}=this._worksheetData,{rowTotalHeight:l,rowHeightAccumulation:u}=this._generateRowMatrixCache(s,t,n),{columnTotalWidth:c,columnWidthAccumulation:d}=this._generateColumnMatrixCache(o,e,r);this._rowHeaderWidth=i.hidden!==ut.TRUE?this._dynamicallyUpdateRowHeaderWidth(i):0,this._columnHeaderHeight=a.hidden!==ut.TRUE?a.height:0,this._rowTotalHeight=l,this._rowHeightAccumulation=u,this._columnTotalWidth=c,this._columnWidthAccumulation=d,this.makeDirty(!1)}calculate(){return this.resetCache(),this._updateLayout(),this}resetRangeCache(t){}_dynamicallyUpdateRowHeaderWidth(t){const e=`${this.worksheet.getRowCount()}`.length*8;return Math.max(t.width,e)}_hasUnMergedCellInRow(t,e,n){if(!this.worksheet.getMergeData())return!1;for(let r=e;r<=n;r++){const{isMerged:s,isMergedMainCell:o}=this.worksheet.getCellInfoInMergeData(t,r);if(!s&&!o)return!0}return!1}expandRangeByMerge(t){let{startRow:e,startColumn:n,endRow:r,endColumn:s}=t;const o=this._worksheetData.mergeData;if(!o)return{startRow:e,startColumn:n,endRow:r,endColumn:s};let i=!0;const a=new De;for(;i;){i=!1;for(let l=0;l<o.length;l++){const{startRow:u,startColumn:c,endRow:d,endColumn:h}=o[l];a.getValue(u,c)||x1({startColumn:n,startRow:e,endColumn:s,endRow:r},{startColumn:c,startRow:u,endColumn:h,endRow:d})&&(e=Math.min(e,u),n=Math.min(n,c),r=Math.max(r,d),s=Math.max(s,h),a.setValue(u,c,!0),i=!0)}}return{startRow:e,startColumn:n,endRow:r,endColumn:s}}getColumnCount(){return this._columnWidthAccumulation.length}getRowCount(){return this._rowHeightAccumulation.length}_getCellMergeInfo(t,e){return this.worksheet.getCellInfoInMergeData(t,e)}getNoMergeCellPositionByIndex(t,e,n=!0){return this.getNoMergeCellWithCoordByIndex(t,e,n)}getNoMergeCellWithCoordByIndex(t,e,n=!0){const{rowHeightAccumulation:r,columnWidthAccumulation:s,rowHeaderWidthAndMarginLeft:o,columnHeaderHeightAndMarginTop:i}=this;let{startY:a,endY:l,startX:u,endX:c}=Ur(t,e,r,s);return n&&(a+=i,l+=i,u+=o,c+=o),{startY:a,endY:l,startX:u,endX:c}}getNoMergeCellPositionByIndexWithNoHeader(t,e){const{rowHeightAccumulation:n,columnWidthAccumulation:r}=this,{startY:s,endY:o,startX:i,endX:a}=Ur(t,e,n,r);return{startY:s,endY:o,startX:i,endX:a}}getRowIndexByOffsetY(t,e,n,r){var s;const{rowHeightAccumulation:o}=this;t=nR(t,e,n,this.columnHeaderHeightAndMarginTop);let i=Rs(o,t,r==null?void 0:r.firstMatch);return r!=null&&r.closeFirst&&Math.abs(o[i]-t)<Math.abs(t-((s=o[i-1])!=null?s:0))&&(i=i+1),i}getColumnIndexByOffsetX(t,e,n,r){var s;const o=eR(t,e,n,this.rowHeaderWidthAndMarginLeft),{columnWidthAccumulation:i}=this;let a=Rs(i,o,r==null?void 0:r.firstMatch);return r!=null&&r.closeFirst&&Math.abs(i[a]-o)<Math.abs(o-((s=i[a-1])!=null?s:0))&&(a=a+1),a}getCellIndexByOffset(t,e,n,r,s,o){const i=this.getRowIndexByOffsetY(e,r,s,o),a=this.getColumnIndexByOffsetX(t,n,s,o);return{row:i,column:a}}getCellByOffset(t,e,n,r,s){const o=this==null?void 0:this.getCellIndexByOffset(t,e,n,r,s,{firstMatch:!0});return o?this.worksheet.getCellInfoInMergeData(o.row,o.column):null}getCellWithCoordByIndex(t,e,n=!0){const{rowHeightAccumulation:r,columnWidthAccumulation:s,rowHeaderWidthAndMarginLeft:o,columnHeaderHeightAndMarginTop:i}=this,a=Ur(t,e,r,s,this.worksheet.getCellInfoInMergeData(t,e)),{isMerged:l,isMergedMainCell:u}=a;let{startY:c,endY:d,startX:h,endX:f,mergeInfo:p}=a,g=o,_=i;return n===!1&&(g=0,_=0),c+=_,d+=_,h+=g,f+=g,p.startY+=_,p.endY+=_,p.startX+=g,p.endX+=g,{actualRow:t,actualColumn:e,startX:h,startY:c,endX:f,endY:d,isMerged:l,isMergedMainCell:u,mergeInfo:p}}getCellWithCoordByOffset(t,e,n,r,s,o){const{row:i,column:a}=this.getCellIndexByOffset(t,e,n,r,s,o);return this.getCellWithCoordByIndex(i,a)}getOffsetByColumn(t){const{columnWidthAccumulation:e,rowHeaderWidthAndMarginLeft:n}=this,r=e.length-1,s=e[t];return s!=null?s+n:t<0?n:e[r]+n}getOffsetByRow(t){const{rowHeightAccumulation:e,columnHeaderHeightAndMarginTop:n}=this,r=e.length-1,s=e[t];return s!=null?s+n:t<0?n:e[r]+n}getOffsetRelativeToRowCol(t,e){const n=Rs(this.columnWidthAccumulation,t);let r=0;n===0?r=t:r=t-this._columnWidthAccumulation[n-1];const s=Rs(this.rowHeightAccumulation,e);let o=0;return s===0?o=e:o=e-this._rowHeightAccumulation[s-1],{row:s,column:n,columnOffset:r,rowOffset:o}}_updateConfigAndGetDocumentModel(t,e,n,r){var s,o,i,a,l;if(!r||!((s=t.body)!=null&&s.dataStream))return;t.documentStyle||(t.documentStyle={}),t.documentStyle.marginTop=(o=n.t)!=null?o:0,t.documentStyle.marginBottom=(i=n.b)!=null?i:2,t.documentStyle.marginLeft=(a=n.l)!=null?a:2,t.documentStyle.marginRight=(l=n.r)!=null?l:2,t.documentStyle.pageSize={width:Number.POSITIVE_INFINITY,height:Number.POSITIVE_INFINITY},t.documentStyle.renderConfig={...t.documentStyle.renderConfig,...r};const u=t.body.paragraphs||[];for(const c of u)c.paragraphStyle||(c.paragraphStyle={}),c.paragraphStyle.horizontalAlign=e;return new en(t)}dispose(){super.dispose(),this._rowHeightAccumulation=[],this._columnWidthAccumulation=[],this._rowTotalHeight=0,this._columnTotalWidth=0,this._rowHeaderWidth=0,this._columnHeaderHeight=0,this._worksheetData=null,this._cellData=null,this._styles=null,this.worksheet=null}};Mc=tR([Bs(2,Ve(fr)),Bs(3,ds),Bs(4,Zh),Bs(5,Ve(Rr))],Mc);function lf(t,e,n,r){const s=t-1,o=e-1,i=n[s]||0;let a=n[t];a==null&&(a=n[n.length-1]);const l=r[o]||0;let u=r[e];return u==null&&(u=r[r.length-1]),{startY:i,endY:a,startX:l,endX:u}}function II(t,e,n,r){return lf(t,e,n,r)}function Ur(t,e,n,r,s){t=et.clamp(t,0,n.length-1),e=et.clamp(e,0,r.length-1);let{startY:o,endY:i,startX:a,endX:l}=lf(t,e,n,r);if(!s)return{startY:o,endY:i,startX:a,endX:l,isMerged:!1,isMergedMainCell:!1,actualRow:t,actualColumn:e,mergeInfo:{startY:o,endY:i,startX:a,endX:l,startRow:t,startColumn:e,endRow:t,endColumn:e}};const{isMerged:u,isMergedMainCell:c,startRow:d,startColumn:h,endRow:f,endColumn:p}=s;let g={startRow:d,startColumn:h,endRow:f,endColumn:p,startY:o,endY:i,startX:a,endX:l};const _=n.length-1,I=r.length-1;if(u&&d!==-1&&h!==-1){const U=n[d-1]||0,L=n[f]||n[_],B=r[h-1]||0,C=r[p]||r[I];g={...g,startY:U,endY:L,startX:B,endX:C}}else if(!u&&f!==-1&&p!==-1){const U=n[f]||n[_],L=r[p]||r[I];g={...g,startY:o,endY:U,startX:a,endX:L}}return{isMerged:u,isMergedMainCell:c,actualRow:t,actualColumn:e,startY:o,endY:i,startX:a,endX:l,mergeInfo:g}}function eR(t,e,n,r){const{x:s}=n;return t/e+s-r}function nR(t,e,n,r){const{y:s}=n;return t=t/e+s-r,t}const SI=["script","style","meta","comment","link"];var rR=(t=>(t[t.INFO=0]="INFO",t[t.STOP=1]="STOP",t[t.WARNING=2]="WARNING",t))(rR||{}),sR=(t=>(t[t.DISABLED=0]="DISABLED",t[t.FULL_ALPHA=1]="FULL_ALPHA",t[t.FULL_HANGUL=2]="FULL_HANGUL",t[t.FULL_KATAKANA=3]="FULL_KATAKANA",t[t.HALF_ALPHA=4]="HALF_ALPHA",t[t.HALF_HANGUL=5]="HALF_HANGUL",t[t.HALF_KATAKANA=6]="HALF_KATAKANA",t[t.HIRAGANA=7]="HIRAGANA",t[t.NO_CONTROL=8]="NO_CONTROL",t[t.OFF=9]="OFF",t[t.ON=10]="ON",t))(sR||{}),oR=(t=>(t.BETWEEN="between",t.EQUAL="equal",t.GREATER_THAN="greaterThan",t.GREATER_THAN_OR_EQUAL="greaterThanOrEqual",t.LESS_THAN="lessThan",t.LESS_THAN_OR_EQUAL="lessThanOrEqual",t.NOT_BETWEEN="notBetween",t.NOT_EQUAL="notEqual",t))(oR||{}),iR=(t=>(t[t.TEXT=0]="TEXT",t[t.ARROW=1]="ARROW",t[t.CUSTOM=2]="CUSTOM",t))(iR||{}),aR=(t=>(t.VALID="valid",t.INVALID="invalid",t.VALIDATING="validating",t))(aR||{}),lR=(t=>(t.CUSTOM="custom",t.LIST="list",t.LIST_MULTIPLE="listMultiple",t.NONE="none",t.TEXT_LENGTH="textLength",t.DATE="date",t.TIME="time",t.WHOLE="whole",t.DECIMAL="decimal",t.CHECKBOX="checkbox",t.ANY="any",t))(lR||{}),uR=(t,e,n,r)=>{for(var s=e,o=t.length-1,i;o>=0;o--)(i=t[o])&&(s=i(s)||s);return s},Lc=(t,e)=>(n,r)=>e(n,r,t);let ca=class extends ee{constructor(t,e){super(),this._resourceManagerService=t,this._univerInstanceService=e,this._init()}_init(){const t=e=>{e.businesses.forEach(n=>{switch(n){case It.UNRECOGNIZED:case It.UNIVER_UNKNOWN:case It.UNIVER_SLIDE:case It.UNIVER_DOC:{this._univerInstanceService.getAllUnitsForType(It.UNIVER_DOC).forEach(r=>{const s=(r.getSnapshot().resources||[]).find(o=>o.name===e.pluginName);if(s)try{const o=e.parseJson(s.data);e.onLoad(r.getUnitId(),o)}catch{console.error(`Load Document{${r.getUnitId()}} Resources{${e.pluginName}} Data Error.`)}});break}case It.UNIVER_SHEET:this._univerInstanceService.getAllUnitsForType(It.UNIVER_SHEET).forEach(r=>{const s=(r.getSnapshot().resources||[]).find(o=>o.name===e.pluginName);if(s)try{const o=e.parseJson(s.data);e.onLoad(r.getUnitId(),o)}catch{console.error(`Load Workbook{${r.getUnitId()}} Resources{${e.pluginName}} Data Error.`)}})}})};this._resourceManagerService.getAllResourceHooks().forEach(e=>t(e)),this.disposeWithMe(this._resourceManagerService.register$.subscribe(e=>t(e))),this.disposeWithMe(this._univerInstanceService.getTypeOfUnitAdded$(It.UNIVER_SHEET).subscribe(e=>{this._resourceManagerService.loadResources(e.getUnitId(),e.getSnapshot().resources)})),this.disposeWithMe(this._univerInstanceService.getTypeOfUnitAdded$(It.UNIVER_DOC).subscribe(e=>{const n=e.getUnitId();Ng(n)||this._resourceManagerService.loadResources(e.getUnitId(),e.getSnapshot().resources)})),this.disposeWithMe(this._univerInstanceService.getTypeOfUnitDisposed$(It.UNIVER_SHEET).subscribe(e=>{this._resourceManagerService.unloadResources(e.getUnitId(),It.UNIVER_SHEET)})),this.disposeWithMe(this._univerInstanceService.getTypeOfUnitDisposed$(It.UNIVER_DOC).subscribe(e=>{this._resourceManagerService.unloadResources(e.getUnitId(),It.UNIVER_DOC)}))}saveUnit(t){const e=this._univerInstanceService.getUnit(t);if(!e)return null;const n=this._resourceManagerService.getResources(t,e.type),r=et.deepClone(e.getSnapshot());return r.resources=n,r}};ca=uR([Lc(0,Ve(bl)),Lc(1,Ve(ls))],ca);class AI{constructor(e={},n){b(this,"_startedTypes",new Set),b(this,"_injector"),b(this,"_disposingCallbacks",new xa);const r=this._injector=cR(n,e==null?void 0:e.override),{theme:s,darkMode:o,locale:i,locales:a,logLevel:l}=e;s&&this._injector.get(ia).setTheme(s),o&&this._injector.get(ia).setDarkMode(o),a&&this._injector.get(fr).load(a),i&&this._injector.get(fr).setLocale(i),l&&this._injector.get(je).setLogLevel(l),this._init(r)}get _univerInstanceService(){return this._injector.get(ls)}get _pluginService(){return this._injector.get(uo)}__getInjector(){return this._injector}onDispose(e){const n=this._disposingCallbacks.add(Zt(e));return Zt(()=>n.dispose(!0))}dispose(){this._disposingCallbacks.dispose(),this._injector.dispose()}setLocale(e){this._injector.get(fr).setLocale(e)}createUnit(e,n){return this._univerInstanceService.createUnit(e,n)}createUniverSheet(e){return this._injector.get(je).warn("[Univer]","Univer.createUniverSheet is deprecated, use createUnit instead"),this._univerInstanceService.createUnit(It.UNIVER_SHEET,e)}createUniverDoc(e){return this._injector.get(je).warn("[Univer]","Univer.createUniverDoc is deprecated, use createUnit instead"),this._univerInstanceService.createUnit(It.UNIVER_DOC,e)}createUniverSlide(e){return this._injector.get(je).warn("[Univer]","Univer.createUniverSlide is deprecated, use createUnit instead"),this._univerInstanceService.createUnit(It.UNIVER_SLIDE,e)}_init(e){this._univerInstanceService.registerCtorForType(It.UNIVER_SHEET,lo),this._univerInstanceService.registerCtorForType(It.UNIVER_DOC,en),this._univerInstanceService.registerCtorForType(It.UNIVER_SLIDE,tf);const n=e.get(ls);n.__setCreateHandler((r,s,o,i)=>{if(!this._startedTypes.has(r)){this._pluginService.startPluginsForType(r),this._startedTypes.add(r);const l=e.createInstance(o,s);return n.__addUnit(l,i),this._tryProgressToReady(),l}const a=e.createInstance(o,s);return n.__addUnit(a,i),a})}_tryProgressToReady(){this._injector.get(Er).stage<Vt.Ready&&(this._injector.get(Er).stage=Vt.Ready)}registerPlugin(e,n){this._pluginService.registerPlugin(e,n)}registerPlugins(e){e.forEach(n=>{const[r,s]=n;this._pluginService.registerPlugin(r,s)})}}function cR(t,e){const n=BC([[rC],[fr],[ia],[Er],[uo],[io],[ls,{useClass:ra}],[PC,{useClass:UC}],[je,{useClass:nv,lazy:!0}],[Co,{useClass:Ii}],[Cl,{useClass:aa,lazy:!0}],[Zh,{useClass:tC}],[ds,{useClass:tv}],[bl,{useClass:oa,lazy:!0}],[Dc,{useClass:ca,lazy:!0}],[qb,{useClass:ea}],[kC,{useClass:sa,lazy:!0}]],e),r=t?t.createChild(n):new Rr(n);return Mg(r,[[io],[Dc]]),r}Cg();const Fc=(t,e)=>{if(t&&typeof t=="object"){const n=t,r=n.payload;if(r&&typeof r=="object"&&"message"in r){const s=r.message;if(typeof s=="string"&&s.trim().length>0)return s}if(typeof n.message=="string"&&n.message.trim().length>0)return n.message}return t instanceof Error&&t.message?t.message:e},dR=t=>{if(!t||typeof t!="object")return!1;const e=t;if(typeof e.status=="number"&&e.status===404)return!0;if(typeof e.status=="number"&&e.status===400){const n=e.payload;if(n&&typeof n=="object"&&"message"in n){const r=n.message;if(typeof r=="string"&&r.includes(""))return!0}}return!1},uf=t=>{if(!t||t.trim().length===0)return null;try{const e=JSON.parse(t);if(e&&typeof e=="object")return e}catch(e){console.warn("",e)}return null},ci=t=>{cf=t,df=t?uf(t):null};let ir=null,Je=null,mn=null,cf=null,df=null,$s=null,di=!1,Zn=null,Ee=null,Br=null,$r=null,Qn=!1,hR=0;const fR=3e4,pR=5e3,hi=t=>{},kc=t=>Object.prototype.toString.call(t)==="[object Object]",gR="".toLowerCase()==="true",co=()=>typeof performance<"u"&&typeof performance.now=="function"?performance.now():Date.now(),hf=(t,e,n,r={})=>{if(!gR)return;const s=Number.isFinite(n)?n.toFixed(2):n,o=Object.entries(r).filter(([,a])=>a!==void 0).map(([a,l])=>`${a}=${l}`).join(" "),i=o?` ${o}`:"";console.info(`[TeamSpreadsheet][Loop] ${t}: iterations=${e} duration=${s}ms${i}`)},ff=(t,e)=>{const n=t,r=Object.entries(e),s=co();return r.forEach(([o,i])=>{if(kc(i)){const a=kc(n[o])?n[o]:{};n[o]=ff(a,i);return}n[o]=i}),hf("mergeLocaleMessages",r.length,co()-s,{targetKeys:Object.keys(n).length}),n},mR=t=>{const e=hi(),n=hi(),r=hi()??n,s=co(),o=[{importPreset:()=>Mt(()=>import("./index-DmlX_rKD.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27])),importLocale:()=>Mt(()=>import("./zh-CN-xOisK4Uq.js"),__vite__mapDeps([28,29,30,31,32,3,4,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27])),resolvePreset:i=>i.UniverSheetsCorePreset({container:t})},{importPreset:()=>Mt(()=>import("./index-BfodAgep.js"),__vite__mapDeps([33,34,1,2,3,4,35,6,8,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27])),importLocale:()=>Mt(()=>import("./zh-CN-D_K-QYkk.js"),__vite__mapDeps([36,3,4,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27])),resolvePreset:i=>{var a;return(a=i.UniverSheetsConditionalFormattingPreset)==null?void 0:a.call(i)}},{importPreset:()=>Mt(()=>import("./index-eadENTDt.js"),__vite__mapDeps([37,38,39,1,2,3,4,6,40,7,8,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27])),importLocale:()=>Mt(()=>import("./zh-CN-BOY75vfx.js"),__vite__mapDeps([41,3,4,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27])),resolvePreset:i=>{var a;return(a=i.UniverSheetsDataValidationPreset)==null?void 0:a.call(i)}},{importPreset:()=>Mt(()=>import("./index-CUSErzTo.js"),__vite__mapDeps([42,43,1,2,3,4,44,8,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27])),importLocale:()=>Mt(()=>import("./zh-CN-BIOSCCvr.js"),__vite__mapDeps([45,3,4,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27])),resolvePreset:i=>{var a;return(a=i.UniverSheetsFilterPreset)==null?void 0:a.call(i)}},{importPreset:()=>Mt(()=>import("./index-ZDhi2AlF.js"),__vite__mapDeps([46,47,1,2,3,4,8,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27])),importLocale:()=>Mt(()=>import("./zh-CN-C9rKiknf.js"),__vite__mapDeps([48,3,4,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27])),resolvePreset:i=>{var a;return(a=i.UniverSheetsSortPreset)==null?void 0:a.call(i)}},{importPreset:()=>Mt(()=>import("./index-Dw2BL3sx.js"),__vite__mapDeps([49,1,2,3,4,47,6,8,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27])),importLocale:()=>Mt(()=>import("./zh-CN-DeMubXS5.js"),__vite__mapDeps([50,3,4,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27])),resolvePreset:i=>{var a;return(a=i.UniverSheetsTablePreset)==null?void 0:a.call(i)}},{importPreset:()=>Mt(()=>import("./index-C11Z-l5D.js"),__vite__mapDeps([51,1,2,3,4,8,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27])),importLocale:()=>Mt(()=>import("./zh-CN-DtSw1neC.js"),__vite__mapDeps([52,3,4,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27])),resolvePreset:i=>{var a;return(a=i.UniverSheetsNotePreset)==null?void 0:a.call(i)}},{importPreset:()=>Mt(()=>import("./index-cNrruVyW.js"),__vite__mapDeps([53,1,2,3,4,54,8,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27])),importLocale:()=>Mt(()=>import("./zh-CN-Cq9YoPLF.js"),__vite__mapDeps([55,3,4,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27])),resolvePreset:i=>{var a;return(a=i.UniverSheetsThreadCommentPreset)==null?void 0:a.call(i)}},{importPreset:()=>Mt(()=>import("./index-Cyj3sZL9.js"),__vite__mapDeps([56,57,1,2,3,4,58,6,39,38,8,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27])),importLocale:()=>Mt(()=>import("./zh-CN-DDLUFfit.js"),__vite__mapDeps([59,3,4,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27])),resolvePreset:i=>{var a;return(a=i.UniverSheetsHyperLinkPreset)==null?void 0:a.call(i)}},{importPreset:()=>Mt(()=>import("./index-DtimQMRL.js"),__vite__mapDeps([60,1,2,3,4,8,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27])),importLocale:()=>Mt(()=>import("./zh-CN-C2A9wNmZ.js"),__vite__mapDeps([61,3,4,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27])),resolvePreset:i=>{var a;return(a=i.UniverSheetsFindReplacePreset)==null?void 0:a.call(i)}},{importPreset:()=>Mt(()=>import("./index-DzOU75Ez.js"),__vite__mapDeps([62,63,1,2,3,4,9,8,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27])),importLocale:()=>Mt(()=>import("./zh-CN-DYst2D4Y.js"),__vite__mapDeps([64,3,4,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27])),resolvePreset:i=>{var a;return(a=i.UniverSheetsDrawingPreset)==null?void 0:a.call(i)}}];return e&&n&&o.push({importPreset:()=>Mt(()=>import("./index-BeW_XPYD.js"),__vite__mapDeps([65,66,1,2,3,4,54,34,38,57,43,63,6,5,8,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27])),importLocale:()=>Mt(()=>import("./zh-CN-BGdhnYO5.js"),__vite__mapDeps([67,3,4,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27])),resolvePreset:i=>{var a;return(a=i.UniverSheetsAdvancedPreset)==null?void 0:a.call(i,{license:e,universerEndpoint:n,useWorker:!0})}}),e&&r&&o.push({importPreset:()=>Mt(()=>import("./index-C4CTCmIG.js"),__vite__mapDeps([68,66,1,2,3,4,54,34,38,57,43,63,6,69,5,35,39,40,7,44,58,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27])),importLocale:()=>Mt(()=>import("./zh-CN-BufWVU5I.js"),__vite__mapDeps([70,3,4,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27])),resolvePreset:i=>{var a;return(a=i.UniverSheetsCollaborationPreset)==null?void 0:a.call(i,{universerEndpoint:r,univerContainerId:t.id})}}),hf("createSheetsPresetDescriptors",o.length,co()-s,{hasLicenseKey:!!e,hasCollabEndpoint:!!r}),o},_R=[()=>Mt(()=>import("./zh-CN-CMpc34zJ.js"),[]),()=>Mt(()=>import("./zh-CN-B48BrrS_.js"),[]),()=>Mt(()=>import("./zh-CN-qu9fEDDQ.js"),[]),()=>Mt(()=>import("./zh-CN-ChZCXZZo.js"),[])],yR=async(t,e)=>{if(ir&&Je)return!0;try{t.id||(t.id="team-spreadsheet-host");const n=mR(t),[{createUniver:r,LocaleType:s,defaultTheme:o},i,a]=await Promise.all([Mt(()=>import("./index-DIT-jVrB.js"),__vite__mapDeps([71,2,3,4,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27])),Promise.all(n.map(f=>f.importPreset())),Promise.all([..._R.map(f=>f()),...n.map(f=>f.importLocale())])]),l=a.reduce((f,p)=>p!=null&&p.default&&typeof p.default=="object"?ff(f,p.default):f,{}),u=i.map((f,p)=>n[p].resolvePreset(f)??null).filter(f=>f!==null),c={[s.ZH_CN]:l},{univer:d,univerAPI:h}=r({locale:s.ZH_CN,locales:c,theme:o,presets:u});return ir=d,Je=h,!0}catch(n){return console.error(" Univer ",n),e.show({message:"",color:"error"}),!1}},vR=t=>{if(!Je)throw new Error("Univer API ");const e=uf(t.content),n=e?{...e}:{};return n.id=`team-spreadsheet-${t.id}-${Date.now()}-${hR++}`,(!n.name||typeof n.name!="string")&&(n.name=t.title),Je.createWorkbook(n,{makeCurrent:!0})},pf=(t=da())=>{const e=Hc(),n=()=>{$s&&(clearInterval($s),$s=null)},r=()=>{Br==null||Br.dispose(),Br=null},s=()=>{$r&&(clearTimeout($r),$r=null)},o=()=>{Qn&&(s(),$r=setTimeout(()=>{$r=null,l()},pR))},i=()=>{!mn||Zn==null||(Qn=!0,o())},a=()=>{r(),Je&&(Br=Je.addEvent(Je.Event.CommandExecuted,p=>{p.type===hs.MUTATION&&i()}))},l=async p=>{if(!mn||Zn==null)return;const g=JSON.stringify(mn.save());if(!(p!=null&&p.force)&&g===cf){Qn=!1;return}if(di){o();return}const _={title:(Ee==null?void 0:Ee.title)??t.currentDocumentTitle.value??"",description:(Ee==null?void 0:Ee.description)??"",content:g,remark:(Ee==null?void 0:Ee.remark)??""};di=!0,t.autoSaving.value=!0;try{const I=await Ff(Zn,_);Ee={title:I.title,description:I.description??"",remark:I.remark??""},t.currentDocumentTitle.value=I.title,ci(g),Qn=!1,t.lastSavedAt.value=new Date}catch(I){console.error("",I);const U=Fc(I,"");e.show({message:U,color:"error"})}finally{di=!1,t.autoSaving.value=!1}},u=()=>{n(),$s=setInterval(()=>{l()},fR)},c=async p=>{if(!p)return!1;t.initializing.value=!0,t.currentDocumentTitle.value=null;let g=!1;try{const _=t.containerRef.value;if(!_)throw new Error("");n();const I=await Mf(p);if(!await yR(_,e)||!Je)return!1;const L=Je.getActiveWorkbook();L==null||L.dispose(),mn=vR(I),Zn=I.id,Ee={title:I.title,description:I.description??"",remark:I.remark??""},t.currentDocumentTitle.value=I.title,ci(I.content??null),Qn=!1,t.lastSavedAt.value=I.updatedAt?new Date(I.updatedAt):new Date(I.createdAt),a(),u(),g=!0}catch(_){console.error("",_);const I=Fc(_,"");e.show({message:I,color:"error"}),dR(_)&&(Zn=null,Ee=null,t.currentDocumentTitle.value=null)}finally{t.initializing.value=!1}return g},d=async()=>{s(),await l({force:!0})},h=()=>{try{mn==null||mn.dispose()}catch(p){console.warn("",p)}mn=null,Zn=null,Ee=null,ci(null),Qn=!1,n(),s(),r(),t.currentDocumentTitle.value=null,t.lastSavedAt.value=null};return{mountDocument:c,flushAutoSave:d,disposeWorkbook:h,disposeUniver:()=>{h();try{ir==null||ir.dispose()}catch(p){console.warn(" Univer ",p)}ir=null,Je=null},getWorkbookSnapshot:()=>df}},ER=async(t,e)=>{if(await t.flushAutoSave(),e==null){t.disposeWorkbook();return}await t.mountDocument(e)},bR=t=>{const e=n=>{(n.metaKey||n.ctrlKey)&&n.key.toLowerCase()==="s"&&(n.preventDefault(),t.flushAutoSave())};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},CR=(t=da(),e=pf(t))=>{const n=bR(e);Hs(()=>t.activeDocumentId.value,r=>{ER(e,r)},{immediate:!0}),jc(()=>{n(),e.flushAutoSave(),e.disposeWorkbook(),e.disposeUniver()})},gf=1e4,RR=200,TR=1e4,wR="".toLowerCase()==="true",br=()=>typeof performance<"u"&&typeof performance.now=="function"?performance.now():Date.now(),Tl=(t,e,n,r={})=>{if(!wR)return;const s=Number.isFinite(n)?n.toFixed(2):n,o=Object.entries(r).filter(([,a])=>a!==void 0).map(([a,l])=>`${a}=${l}`).join(" "),i=o?` ${o}`:"";console.info(`[VXETableAdapter][Loop] ${t}: iterations=${e} duration=${s}ms${i}`)},IR=t=>{let e=t+1,n="";for(;e>0;){const r=(e-1)%26;n=String.fromCharCode(65+r)+n,e=Math.floor((e-r)/26)}return n},SR=t=>t===null||t===""?"":typeof t=="boolean"?t?"TRUE":"FALSE":String(t),AR=(t,e)=>{if(e.length===0)return[];const n=`c_${t}`,r=new Map,s=Math.min(e.length,TR),o=br();for(let i=0;i<s;i+=1){const a=e[i][n]??null,l=a===null?"__NULL__":`${typeof a}:${String(a)}`;if(!r.has(l)&&(r.set(l,{label:SR(a),value:a}),r.size>=RR))break}return Tl("buildColumnFilters",s,br()-o,{columnIndex:t,uniqueFilters:r.size}),Array.from(r.values())},OR=(t,e)=>{const n=br(),r=t.map((s,o)=>{const i=AR(o,e);return{field:`c_${o}`,title:s&&s.trim().length>0?s.trim():IR(o),minWidth:120,sortable:!0,filters:i.length>0?i:void 0,filterMultiple:i.length>0?!0:void 0}});return Tl("buildColumns",r.length,br()-n,{hasFilters:r.some(s=>!!s.filters)}),r},DR=(t,e)=>{if(e<=0)return[];const n=t.slice(0,Math.min(t.length,gf)),r=br(),s=n.map(o=>{const i={};for(let a=0;a<e;a+=1)i[`c_${a}`]=o[a]??"";return i});return Tl("buildRows",s.length,br()-r,{columnCount:e}),s},Pc=(t,e)=>{const n=e??t.rows,r=Math.max(t.headers.length,n.reduce((a,l)=>Math.max(a,l.length),0)),s=r===t.headers.length?t.headers:Array.from({length:r},(a,l)=>t.headers[l]??""),o=DR(n,r),i=OR(s,o);return{id:t.sheetId??`sheet-${t.documentId}`,name:t.sheetName??t.documentTitle??"",columns:i,rows:o,totalRows:t.rows.length,totalColumns:r,limitedByRowCap:t.rows.length>gf,limitedByColumnCap:!1}},xR=500,NR=(t,e=xR)=>{const n=t.rows.length,r=[];for(let s=0;s<n;s+=e){const o=Math.min(s+e,n);r.push({startIndex:s,endIndex:o,rows:t.rows.slice(s,o)})}return{documentId:t.documentId,headers:t.headers,totalRows:n,batches:r,batchSize:e,currentBatchIndex:0}},Uc=(t,e)=>{const n=Math.min(e,t.batches.length-1),r=[];for(let s=0;s<=n;s++)r.push(...t.batches[s].rows);return r},Bc=t=>t.currentBatchIndex<t.batches.length-1,MR=t=>{var r;const e=t.currentBatchIndex>=0?((r=t.batches[t.currentBatchIndex])==null?void 0:r.endIndex)??0:0,n=t.totalRows>0?Math.round(e/t.totalRows*100):0;return{loaded:e,total:t.totalRows,percentage:n}},LR={class:"d-flex align-center"},FR={class:"toolbar-actions"},kR={class:"fortune-sheet-wrapper"},PR={class:"vxetable-wrapper"},UR={class:"vxetable-toolbar"},BR={class:"vxetable-container"},$R={key:0,class:"vxetable-loading"},HR={key:1,class:"vxetable-empty"},jR={key:0,class:"vxetable-load-more"},VR={class:"d-flex align-center justify-space-between"},WR={class:"text-caption"},GR={class:"mb-4"},YR=yf({__name:"TeamSpreadsheet",setup(t){const e=da(),n=pf(e),r=Ht([]),s=Ht(!1),o=Hc(),i=async()=>{s.value=!0;try{const J=await Nf();if(r.value=J,J.length===0){e.activeDocumentId.value=null,n.disposeWorkbook();return}J.some(dt=>dt.id===e.activeDocumentId.value)||(e.activeDocumentId.value=J[0].id)}catch(J){console.error("",J),o.show({message:"",color:"error"})}finally{s.value=!1}};Il(()=>{i()}),CR(e,n);const{containerRef:a,activeDocumentId:l,initializing:u,autoSaving:c,lastSavedAt:d}=e,h=ze(()=>e.currentDocumentTitle.value),f=Ht("editor"),p=Ht([]),g=Ht(null),_=Ht(!1),I=Ht(!0),U={multiple:!0,trigger:"cell",orders:["asc","desc",null]},L={remote:!1,showIcon:!0},B=Ht(null),C=Ht(null),R=Ht(!1),y=ze(()=>p.value.length===0?null:p.value.find(J=>J.id===g.value)??p.value[0]),N=ze(()=>{const J=y.value;if(!J)return"";const V=J.limitedByRowCap?`${J.rows.length} / ${J.totalRows}`:`${J.rows.length}`,dt=J.limitedByColumnCap?`${J.columns.length} / ${J.totalColumns}`:`${J.columns.length}`;return`${V}  ${dt}`}),G=ze(()=>B.value?MR(B.value):{loaded:0,total:0,percentage:0}),z=ze(()=>B.value&&Bc(B.value)),m=ze(()=>!!y.value&&(y.value.limitedByRowCap||y.value.limitedByColumnCap)),F=ze(()=>A.value?720:520),v=async J=>{if(_.value||e.initializing.value||!(J!=null&&J.force)&&!I.value&&p.value.length>0)return;const V=e.activeDocumentId.value;if(!V){p.value=[],g.value=null,I.value=!1,B.value=null,C.value=null;return}_.value=!0;try{const dt=await Lf(V);C.value=dt;const Ot=NR(dt,500);B.value=Ot;const bt=Uc(Ot,0),zt=Pc(dt,bt);zt.columns.length===0&&zt.rows.length===0?(p.value=[],g.value=null):(p.value=[zt],g.value=zt.id),I.value=!1}catch(dt){console.error(" VXETable ",dt),o.show({message:"",color:"error"})}finally{_.value=!1}},x=async()=>{if(!(!B.value||!C.value)&&!R.value&&Bc(B.value)){R.value=!0;try{B.value.currentBatchIndex+=1;const J=Uc(B.value,B.value.currentBatchIndex),V=Pc(C.value,J);p.value=[V],g.value=V.id}catch(J){console.error("",J),o.show({message:"",color:"error"})}finally{R.value=!1}}},S=()=>{I.value=!0,v({force:!0})};Hs(()=>e.activeDocumentId.value,()=>{I.value=!0,p.value=[],g.value=null,f.value==="table"&&v({force:!0})}),Hs(()=>e.initializing.value,J=>{!J&&f.value==="table"&&v({force:!0})}),Hs(()=>f.value,J=>{J==="table"&&v()});const w=Ht(null),A=Ht(!1),O=()=>{const J=w.value;return J?J instanceof HTMLElement?J:J.$el??null:null},M=()=>{const J=O();A.value=!!J&&document.fullscreenElement===J},P=async()=>{const J=O();if(J)try{document.fullscreenElement?await document.exitFullscreen():await J.requestFullscreen()}catch(V){console.error("",V),o.show({message:"",color:"error"})}};Il(()=>{document.addEventListener("fullscreenchange",M)}),jc(()=>{document.removeEventListener("fullscreenchange",M);const J=O();J&&document.fullscreenElement===J&&document.exitFullscreen()});const Q=Ht(!1),W=Ht(""),ot=Ht(!1),lt=Ht(!1),T=Ht(!1),D=vf({title:"",description:"",remark:""}),H=Ht(null),Y=Ht(0),$=(J,V)=>{if(J&&typeof J=="object"){const dt=J,Ot=dt.payload;if(Ot&&typeof Ot=="object"&&"message"in Ot){const bt=Ot.message;if(typeof bt=="string"&&bt.trim().length>0)return bt}if(typeof dt.message=="string"&&dt.message.trim().length>0)return dt.message}return J instanceof Error&&J.message?J.message:V},j=()=>{if(!h.value){o.show({message:"",color:"warning"});return}W.value="",Q.value=!0},q=()=>{Q.value=!1,W.value=""},nt=ze(()=>{var V;const J=((V=h.value)==null?void 0:V.trim())??"";return ot.value||J.length===0||W.value.trim()!==J}),k=async()=>{const J=h.value,V=l.value;if(!J||!V){o.show({message:"",color:"warning"}),q();return}if(W.value.trim()!==J){o.show({message:"",color:"warning"});return}ot.value=!0;try{await n.flushAutoSave(),await kf(V,W.value.trim()),o.show({message:"",color:"success"}),q(),e.activeDocumentId.value=null,await i()}catch(dt){console.error("",dt);const Ot=$(dt,"");o.show({message:Ot,color:"error"})}finally{ot.value=!1}},K=()=>{D.title="",D.description="",D.remark="",H.value=null,Y.value+=1},Z=()=>{K(),lt.value=!0},rt=()=>{lt.value=!1,K()},pt=J=>{if(Array.isArray(J)){H.value=J[0]??null;return}H.value=J},yt=ze(()=>T.value||!H.value),X=async()=>{if(!H.value){o.show({message:" Excel ",color:"warning"});return}T.value=!0;try{const J=new FormData;J.append("file",H.value),D.title.trim().length>0&&J.append("title",D.title.trim()),D.description.trim().length>0&&J.append("description",D.description.trim()),D.remark.trim().length>0&&J.append("remark",D.remark.trim());const V=await Pf(J);o.show({message:"Excel ",color:"success"}),rt(),await i(),e.activeDocumentId.value=V.id}catch(J){console.error(" Excel ",J);const V=$(J," Excel ");o.show({message:V,color:"error"})}finally{T.value=!1}},ht=ze(()=>c.value?"...":d.value?` ${new Intl.DateTimeFormat("zh-CN",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(d.value)}`:"");return(J,V)=>{const dt=Ol("vxe-column"),Ot=Ol("vxe-table");return Se(),jn(Lo,null,[Tt(Sf,{dense:""},{default:At(()=>[Tt(If,{cols:"12"},{default:At(()=>[Tt(Fo,{ref_key:"fullscreenCardRef",ref:w,class:Ef(["web-docs-card",{"is-fullscreen":A.value}]),elevation:"2"},{default:At(()=>[Tt(ko,{class:"d-flex flex-wrap justify-space-between align-center card-toolbar"},{default:At(()=>[ge("div",LR,[Tt(Sl,{class:"mr-2",color:"primary"},{default:At(()=>[...V[10]||(V[10]=[Xt("mdi-file-table-box-multiple",-1)])]),_:1}),V[11]||(V[11]=Xt("  ",-1))]),ge("div",FR,[Tt(xl,{modelValue:Vn(l),"onUpdate:modelValue":V[0]||(V[0]=bt=>bf(l)?l.value=bt:null),items:r.value,loading:s.value,density:"comfortable","hide-details":"","item-title":"title","item-value":"id",label:"",variant:"outlined",class:"toolbar-select"},null,8,["modelValue","items","loading"]),Tt(Mo,{class:"save-status-chip",color:Vn(c)?"warning":"success","prepend-icon":"mdi-cloud-upload",size:"small",variant:"tonal"},{default:At(()=>[Xt(ln(ht.value),1)]),_:1},8,["color"]),Tt(un,{color:"error",variant:"tonal","prepend-icon":"mdi-trash-can-outline",disabled:Vn(u)||!h.value,onClick:j},{default:At(()=>[...V[12]||(V[12]=[Xt("  ",-1)])]),_:1},8,["disabled"]),Tt(un,{color:"primary",variant:"tonal","prepend-icon":"mdi-file-import",disabled:Vn(u),onClick:Z},{default:At(()=>[...V[13]||(V[13]=[Xt("  Excel ",-1)])]),_:1},8,["disabled"]),Tt(un,{color:"secondary",variant:"tonal","prepend-icon":A.value?"mdi-fullscreen-exit":"mdi-fullscreen",disabled:Vn(u),onClick:P},{default:At(()=>[Xt(ln(A.value?"":""),1)]),_:1},8,["prepend-icon","disabled"])])]),_:1}),Tt(Po,null,{default:At(()=>[Tt(Af,{modelValue:f.value,"onUpdate:modelValue":V[1]||(V[1]=bt=>f.value=bt),class:"web-docs-tabs",color:"primary",density:"comfortable"},{default:At(()=>[Tt(Nl,{value:"editor","prepend-icon":"mdi-file-table-box"},{default:At(()=>[...V[14]||(V[14]=[Xt("  ",-1)])]),_:1}),Tt(Nl,{value:"table","prepend-icon":"mdi-table-large"},{default:At(()=>[...V[15]||(V[15]=[Xt(" VXETable  ",-1)])]),_:1})]),_:1},8,["modelValue"]),Tt(Of,{modelValue:f.value,"onUpdate:modelValue":V[3]||(V[3]=bt=>f.value=bt),class:"web-docs-window",eager:""},{default:At(()=>[Tt(Ml,{value:"editor"},{default:At(()=>[ge("div",kR,[ge("div",{ref_key:"containerRef",ref:a,class:"fortune-sheet-host"},null,512)])]),_:1}),Tt(Ml,{value:"table"},{default:At(()=>[ge("div",PR,[ge("div",UR,[Tt(xl,{modelValue:g.value,"onUpdate:modelValue":V[2]||(V[2]=bt=>g.value=bt),items:p.value,"item-title":"name","item-value":"id",label:"",density:"compact","hide-details":"",variant:"outlined",class:"vxetable-sheet-select",disabled:_.value||p.value.length===0},null,8,["modelValue","items","disabled"]),Tt(Mo,{class:"vxetable-summary-chip",color:"primary","prepend-icon":"mdi-table",variant:"tonal",size:"small"},{default:At(()=>[Xt(ln(N.value),1)]),_:1}),Tt(Cf),Tt(un,{color:"primary",variant:"tonal","prepend-icon":"mdi-refresh",loading:_.value,disabled:Vn(u),onClick:S},{default:At(()=>[...V[16]||(V[16]=[Xt("  ",-1)])]),_:1},8,["loading","disabled"])]),ge("div",BR,[_.value?(Se(),jn("div",$R,[Tt(Rf,{indeterminate:"",color:"primary",size:"32"}),V[17]||(V[17]=ge("span",null,"...",-1))])):(Se(),jn(Lo,{key:1},[y.value&&y.value.columns.length>0?(Se(),Wn(Ot,{key:0,class:"vxetable-grid",data:y.value.rows,"max-height":F.value,"show-overflow":"title","show-header-overflow":"title","column-config":{resizable:!0},"row-config":{isHover:!0},"sort-config":U,"filter-config":L},{default:At(()=>[Tt(dt,{type:"seq",width:"64",title:"#"}),(Se(!0),jn(Lo,null,Tf(y.value.columns,bt=>(Se(),Wn(dt,{key:bt.field,field:bt.field,title:bt.title,width:bt.width,"min-width":bt.minWidth,"show-overflow":"",resizable:"",sortable:bt.sortable,filters:bt.filters,"filter-multiple":bt.filterMultiple},null,8,["field","title","width","min-width","sortable","filters","filter-multiple"]))),128))]),_:1},8,["data","max-height"])):(Se(),jn("div",HR,[Tt(Sl,{size:"40",color:"grey"},{default:At(()=>[...V[18]||(V[18]=[Xt("mdi-table-off",-1)])]),_:1}),V[19]||(V[19]=ge("p",null,"",-1))]))],64))]),B.value&&G.value.total>0?(Se(),jn("div",jR,[Tt(wf,{"model-value":G.value.percentage,color:"primary",height:"4",class:"mb-2"},null,8,["model-value"]),ge("div",VR,[ge("span",WR,"  "+ln(G.value.loaded)+" / "+ln(G.value.total)+"  ("+ln(G.value.percentage)+"%) ",1),z.value?(Se(),Wn(un,{key:0,color:"primary",variant:"tonal",size:"small","prepend-icon":"mdi-chevron-down",loading:R.value,onClick:x},{default:At(()=>[...V[20]||(V[20]=[Xt("  (500 ) ",-1)])]),_:1},8,["loading"])):(Se(),Wn(Mo,{key:1,color:"success",size:"small",variant:"flat"},{default:At(()=>[...V[21]||(V[21]=[Xt("  ",-1)])]),_:1}))])])):Al("",!0),m.value&&y.value?(Se(),Wn(Df,{key:1,type:"info",variant:"tonal",density:"comfortable",class:"vxetable-limit-alert"},{default:At(()=>[Xt("  "+ln(y.value.rows.length)+"  / "+ln(y.value.columns.length)+"   ",1)]),_:1})):Al("",!0)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["class"])]),_:1})]),_:1}),Tt(Fl,{modelValue:Q.value,"onUpdate:modelValue":V[5]||(V[5]=bt=>Q.value=bt),"max-width":"520"},{default:At(()=>[Tt(Fo,null,{default:At(()=>[Tt(ko,{class:"text-h6"},{default:At(()=>[...V[22]||(V[22]=[Xt("",-1)])]),_:1}),Tt(Po,null,{default:At(()=>[ge("p",GR,[V[23]||(V[23]=Xt("  ",-1)),ge("strong",null,ln(h.value),1),V[24]||(V[24]=Xt("  ",-1))]),Tt(Ll,{modelValue:W.value,"onUpdate:modelValue":V[4]||(V[4]=bt=>W.value=bt),label:"",disabled:ot.value,variant:"outlined",autofocus:""},null,8,["modelValue","disabled"])]),_:1}),Tt(Dl,{class:"justify-end"},{default:At(()=>[Tt(un,{variant:"text",onClick:q,disabled:ot.value},{default:At(()=>[...V[25]||(V[25]=[Xt("",-1)])]),_:1},8,["disabled"]),Tt(un,{color:"error",loading:ot.value,disabled:nt.value,onClick:k},{default:At(()=>[...V[26]||(V[26]=[Xt("  ",-1)])]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),Tt(Fl,{modelValue:lt.value,"onUpdate:modelValue":V[9]||(V[9]=bt=>lt.value=bt),"max-width":"560"},{default:At(()=>[Tt(Fo,null,{default:At(()=>[Tt(ko,{class:"text-h6"},{default:At(()=>[...V[27]||(V[27]=[Xt(" Excel ",-1)])]),_:1}),Tt(Po,null,{default:At(()=>[V[28]||(V[28]=ge("p",{class:"mb-4"},"  Excel  .xls / .xlsx ",-1)),(Se(),Wn(xf,{key:Y.value,label:" Excel ",accept:".xls,.xlsx","prepend-icon":"mdi-file-excel",variant:"outlined",disabled:T.value,"onUpdate:modelValue":pt},null,8,["disabled"])),Tt(Ll,{modelValue:D.title,"onUpdate:modelValue":V[6]||(V[6]=bt=>D.title=bt),label:"",variant:"outlined",disabled:T.value},null,8,["modelValue","disabled"]),Tt(kl,{modelValue:D.description,"onUpdate:modelValue":V[7]||(V[7]=bt=>D.description=bt),label:"",variant:"outlined",disabled:T.value,rows:"2","auto-grow":""},null,8,["modelValue","disabled"]),Tt(kl,{modelValue:D.remark,"onUpdate:modelValue":V[8]||(V[8]=bt=>D.remark=bt),label:"",variant:"outlined",disabled:T.value,rows:"2","auto-grow":""},null,8,["modelValue","disabled"])]),_:1}),Tt(Dl,{class:"justify-end"},{default:At(()=>[Tt(un,{variant:"text",disabled:T.value,onClick:rt},{default:At(()=>[...V[29]||(V[29]=[Xt("",-1)])]),_:1},8,["disabled"]),Tt(un,{color:"primary",loading:T.value,disabled:yt.value,onClick:X},{default:At(()=>[...V[30]||(V[30]=[Xt("  ",-1)])]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}}),OI=Object.freeze(Object.defineProperty({__proto__:null,default:YR},Symbol.toStringTag,{value:"Module"}));export{uI as $,g1 as A,Jf as B,ue as C,XC as D,Dv as E,fr as F,_T as G,bl as H,Ve as I,et as J,IT as K,Co as L,hs as M,Er as N,Oc as O,je as P,Vt as Q,Rw as R,as as S,Pa as T,$e as U,ee as V,Zt as W,vI as X,ut as Y,bw as Z,JC as _,ie as a,_b as a$,aR as a0,yT as a1,rR as a2,lR as a3,oR as a4,de as a5,FT as a6,Eo as a7,vT as a8,vt as a9,Zp as aA,rd as aB,md as aC,wr as aD,td as aE,We as aF,Js as aG,yn as aH,Ne as aI,pr as aJ,Np as aK,aT as aL,ig as aM,Zs as aN,Sp as aO,Zl as aP,ug as aQ,Un as aR,Gd as aS,Te as aT,vy as aU,qw as aV,Vw as aW,Gw as aX,vE as aY,Ua as aZ,EE as a_,Pt as aa,Cl as ab,ka as ac,CI as ad,RI as ae,ce as af,UT as ag,dg as ah,De as ai,mw as aj,ms as ak,lr as al,ds as am,PC as an,rC as ao,jT as ap,rs as aq,ns as ar,Tr as as,nn as at,Op as au,Dp as av,te as aw,lg as ax,po as ay,ba as az,Ir as b,tf as b$,Re as b0,Jd as b1,ua as b2,Oo as b3,Ey as b4,by as b5,qe as b6,_r as b7,SC as b8,NT as b9,Lw as bA,ur as bB,Pn as bC,bo as bD,ST as bE,Fw as bF,ky as bG,Iy as bH,Ny as bI,Ty as bJ,_t as bK,Uy as bL,Fy as bM,By as bN,Ww as bO,ET as bP,bd as bQ,Cd as bR,Fg as bS,Ng as bT,vr as bU,le as bV,Ut as bW,Le as bX,oe as bY,rI as bZ,lo as b_,go as ba,Pl as bb,en as bc,Og as bd,Yw as be,$u as bf,Mc as bg,fe as bh,dC as bi,Rs as bj,nw as bk,cn as bl,tw as bm,gy as bn,jr as bo,vn as bp,Py as bq,sw as br,yE as bs,wT as bt,Hy as bu,Ts as bv,My as bw,Ly as bx,wy as by,Dy as bz,og as c,ow as c$,gg as c0,eC as c1,nC as c2,MC as c3,BC as c4,fw as c5,cT as c6,GT as c7,Qh as c8,sC as c9,yw as cA,Vh as cB,Xw as cC,Vy as cD,SI as cE,eo as cF,nh as cG,vd as cH,zp as cI,Bw as cJ,pT as cK,dw as cL,Fv as cM,hr as cN,Lt as cO,gw as cP,Cw as cQ,oy as cR,ty as cS,ju as cT,iw as cU,Hu as cV,TC as cW,rf as cX,Ti as cY,Ri as cZ,Sv as c_,Rc as ca,Or as cb,kt as cc,tt as cd,Et as ce,dn as cf,yy as cg,ks as ch,tI as ci,bT as cj,KC as ck,zC as cl,Ag as cm,sI as cn,Sy as co,Mw as cp,Ov as cq,mT as cr,vl as cs,iy as ct,Oy as cu,aI as cv,$T as cw,Uw as cx,tn as cy,zw as cz,xa as d,Fn as d$,_i as d0,Ed as d1,Dg as d2,xg as d3,rw as d4,gT as d5,Ln as d6,lw as d7,aw as d8,gc as d9,PT as dA,x1 as dB,ew as dC,m1 as dD,Wu as dE,Do as dF,xn as dG,_w as dH,Dc as dI,TI as dJ,iR as dK,to as dL,q_ as dM,He as dN,ey as dO,ny as dP,ry as dQ,sy as dR,ay as dS,Ci as dT,ly as dU,fy as dV,py as dW,me as dX,AI as dY,oo as dZ,xo as d_,$w as da,Vr as db,DT as dc,Ao as dd,qb as de,io as df,Mv as dg,eI as dh,nI as di,h_ as dj,Qr as dk,AT as dl,iv as dm,Ah as dn,ed as dp,bI as dq,Rn as dr,hw as ds,pI as dt,bC as du,EC as dv,hC as dw,BT as dx,ys as dy,Nn as dz,yd as e,Ss as e$,Dn as e0,Hw as e1,VT as e2,_I as e3,Wi as e4,cI as e5,Lg as e6,MT as e7,B_ as e8,dT as e9,Gh as eA,Qw as eB,Dw as eC,Ow as eD,xw as eE,v1 as eF,p1 as eG,hI as eH,RC as eI,mI as eJ,dI as eK,fI as eL,CC as eM,gI as eN,Pw as eO,sR as eP,nv as eQ,my as eR,E1 as eS,Jb as eT,Ps as eU,Fs as eV,iI as eW,lI as eX,_y as eY,fv as eZ,ZC as e_,hT as ea,Zw as eb,jy as ec,XT as ed,Us as ee,kw as ef,oI as eg,Oe as eh,HT as ei,CT as ej,vC as ek,yC as el,RT as em,aa as en,kC as eo,ev as ep,jw as eq,Fr as er,cy as es,ea as et,uy as eu,yr as ev,Ii as ew,tC as ex,tv as ey,Nw as ez,Mn as f,kv as f$,sa as f0,dy as f1,Wy as f2,Zd as f3,Ry as f4,UC as f5,uo as f6,j1 as f7,kT as f8,QT as f9,yc as fA,JT as fB,Bu as fC,ta as fD,uT as fE,wI as fF,LT as fG,zo as fH,lf as fI,II as fJ,Ur as fK,tb as fL,nb as fM,eb as fN,pw as fO,q1 as fP,Kw as fQ,Q1 as fR,Ki as fS,eR as fT,nR as fU,yI as fV,TT as fW,qT as fX,Vu as fY,Av as fZ,Lv as f_,ZT as fa,dv as fb,Yd as fc,Gy as fd,oa as fe,pv as ff,IC as fg,hy as fh,lC as fi,hv as fj,Ay as fk,xy as fl,Cy as fm,gv as fn,La as fo,Na as fp,ra as fq,ao as fr,YT as fs,WT as ft,cv as fu,zT as fv,$y as fw,vw as fx,Ew as fy,KT as fz,ww as g,fT as g0,cw as g1,uw as g2,Jw as g3,OT as g4,P1 as g5,uv as g6,H_ as g7,$_ as g8,So as g9,Uu as ga,Kh as gb,ab as gc,lb as gd,Xf as ge,Gf as gf,Wf as gg,iT as gh,oT as gi,$l as gj,Bo as gk,Vc as gl,ep as gm,Ul as gn,Bl as go,sT as gp,_s as gq,lT as gr,OI as gs,Aw as h,xT as i,Vi as j,Tw as k,lv as l,_d as m,En as n,Da as o,Iw as p,EI as q,Sw as r,Hr as s,ru as t,Rr as u,ls as v,It as w,Zh as x,ia as y,Mg as z};
