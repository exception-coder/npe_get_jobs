# Playwright æ‰©å±•æ£€æµ‹ç»•è¿‡ - é—®é¢˜è§£å†³æ–¹æ¡ˆ

> **é€‚ç”¨åœºæ™¯**ï¼šä½¿ç”¨ Playwright è‡ªåŠ¨åŒ–è®¿é—®ç½‘ç«™æ—¶ï¼Œé­é‡æ‰©å±•æ£€æµ‹å¯¼è‡´çš„åçˆ¬è™«æ‹¦æˆª  
> **æ ¸å¿ƒé—®é¢˜**ï¼šç½‘ç«™é€šè¿‡æ£€æµ‹æµè§ˆå™¨æ˜¯å¦å®‰è£…æ‰©å±•æ¥è¯†åˆ«è‡ªåŠ¨åŒ–å·¥å…·  
> **è§£å†³ç­–ç•¥**ï¼šçœŸå®æ‰©å±• + è¯·æ±‚æ‹¦æˆª + å–è¯è§‚æµ‹

---

## é—®é¢˜ç°è±¡

### 1. é¡µé¢å¼‚å¸¸è·³è½¬
- é¡µé¢å¶å‘/é¢‘ç¹è·³è½¬åˆ° `about:blank`
- ç«™ç‚¹è¡Œä¸ºä¸ç¡®å®šï¼ŒåŒæ ·ä»£ç æœ‰æ—¶èƒ½è¿›ï¼Œæœ‰æ—¶ç©ºç™½

### 2. æ§åˆ¶å°é”™è¯¯
```
GET chrome-extension://invalid/ net::ERR_BLOCKED_BY_CLIENT
GET chrome-extension://invalid/ net::ERR_FAILED
```

### 3. æµè§ˆå™¨æç¤º
- é¡¶éƒ¨æ˜¾ç¤ºé»„è‰²æç¤ºæ¡ï¼š"Chrome æ­£å—åˆ°è‡ªåŠ¨æµ‹è¯•è½¯ä»¶çš„æ§åˆ¶"

---

## è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆä¸€ï¼šå»ºç«‹å¯è§‚æµ‹æ€§ï¼ˆå–è¯å™¨ï¼‰

**ç›®çš„**ï¼šåœ¨è§£å†³é—®é¢˜å‰ï¼Œå…ˆå»ºç«‹å®Œæ•´çš„äº‹ä»¶ç›‘æ§ï¼Œå®šä½é—®é¢˜æ ¹æºã€‚

#### å®ç°ä»£ç 

```java
// 1. åˆå§‹åŒ–æ—¥å¿—æ–‡ä»¶
private Path initBossForensicLogFile() throws IOException {
    Path dir = Paths.get("logs", "anti-crawler-detection");
    Files.createDirectories(dir);
    Path file = dir.resolve("boss-forensic.log");
    if (!Files.exists(file)) {
        Files.createFile(file);
    }
    return file;
}

// 2. çº¿ç¨‹å®‰å…¨çš„æ—¥å¿—å†™å…¥
private void writeBossForensic(String line) {
    if (bossForensicLogFile == null) {
        return;
    }
    String msg = String.format("%s %s%n", new java.util.Date(), line);
    synchronized (bossForensicLogLock) {
        try {
            Files.writeString(
                    bossForensicLogFile,
                    msg,
                    StandardOpenOption.CREATE,
                    StandardOpenOption.WRITE,
                    StandardOpenOption.APPEND);
        } catch (Exception e) {
            log.warn("å†™å…¥BOSSå–è¯æ—¥å¿—å¤±è´¥: {}", e.getMessage());
        }
    }
}

// 3. è§‚æµ‹å™¨å®ç°
private void attachObservers(Page page) {
    // ç›‘å¬é¡µé¢å¯¼èˆª
    page.onFrameNavigated(frame -> {
        if (frame == page.mainFrame()) {
            writeBossForensic("[NAV] " + frame.url());
        }
    });

    // ç›‘å¬æ§åˆ¶å°æ—¥å¿—
    page.onConsoleMessage(msg -> {
        writeBossForensic("[CONSOLE] " + msg.type() + " " + msg.text());
    });

    // ç›‘å¬é¡µé¢é”™è¯¯
    page.onPageError(err -> {
        writeBossForensic("[PAGE_ERROR] " + String.valueOf(err));
    });

    // ç›‘å¬è¯·æ±‚
    page.onRequest(req -> {
        String rt = req.resourceType();
        if ("document".equals(rt) || "script".equals(rt) || "xhr".equals(rt) || "fetch".equals(rt)) {
            writeBossForensic("[REQ] " + rt + " " + req.method() + " " + req.url());
        }
    });

    // ç›‘å¬å“åº”
    page.onResponse(resp -> {
        String url = resp.url();
        if (url != null && url.contains(".js")) {
            writeBossForensic("[JS] " + resp.status() + " " + url);
        }
    });

    // ç›‘å¬è¯·æ±‚å¤±è´¥
    page.onRequestFailed(req -> {
        writeBossForensic("[REQ_FAILED] " + req.url() + " => " + req.failure());
    });
}

// 4. å¯ç”¨è§‚æµ‹å™¨ï¼ˆä»…å¯¹ç‰¹å®šå¹³å°ï¼‰
if (platform == RecruitmentPlatformEnum.BOSS_ZHIPIN) {
    attachObservers(page);
}
```

**æ—¥å¿—ä½ç½®**ï¼š`logs/anti-crawler-detection/boss-forensic.log`

---

### æ–¹æ¡ˆäºŒï¼šå®‰è£…çœŸå® Chrome æ‰©å±•

**ç›®çš„**ï¼šè®©æµè§ˆå™¨ç¯å¢ƒçœ‹èµ·æ¥åƒçœŸå®ç”¨æˆ·ï¼Œå®‰è£…äº†å¸¸è§çš„æµè§ˆå™¨æ‰©å±•ã€‚

#### æ­¥éª¤1ï¼šåˆ›å»ºæ‰©å±•ç›®å½•ç»“æ„

```
src/main/resources/extensions/ublock-origin/
â”œâ”€â”€ manifest.json      # æ‰©å±•æ¸…å•
â”œâ”€â”€ background.js      # åå°è„šæœ¬
â”œâ”€â”€ content.js         # å†…å®¹è„šæœ¬
â”œâ”€â”€ icon16.png        # å›¾æ ‡
â”œâ”€â”€ icon48.png
â””â”€â”€ icon128.png
```

#### æ­¥éª¤2ï¼šmanifest.json é…ç½®

```json
{
  "manifest_version": 3,
  "name": "uBlock Origin",
  "version": "1.57.2",
  "description": "Finally, an efficient wide-spectrum content blocker.",
  "permissions": [
    "storage",
    "webRequest",
    "declarativeNetRequest"
  ],
  "host_permissions": [
    "<all_urls>"
  ],
  "background": {
    "service_worker": "background.js"
  },
  "content_scripts": [
    {
      "matches": ["<all_urls>"],
      "js": ["content.js"],
      "run_at": "document_start"
    }
  ]
}
```

#### æ­¥éª¤3ï¼šå‡†å¤‡æ‰©å±•æ–‡ä»¶

```java
private Path prepareExtension() throws IOException {
    Path tempExtensionDir = Files.createTempDirectory("chrome-extension-");
    Path extensionDir = tempExtensionDir.resolve("ublock-origin");
    Files.createDirectories(extensionDir);

    String[] extensionFiles = {
        "manifest.json",
        "background.js",
        "content.js",
        "icon16.png",
        "icon48.png",
        "icon128.png"
    };

    for (String fileName : extensionFiles) {
        String resourcePath = "extensions/ublock-origin/" + fileName;
        try (InputStream is = getClass().getClassLoader().getResourceAsStream(resourcePath)) {
            if (is != null) {
                Files.copy(is, extensionDir.resolve(fileName), StandardCopyOption.REPLACE_EXISTING);
            }
        }
    }

    return extensionDir;
}
```

#### æ­¥éª¤4ï¼šä½¿ç”¨ launchPersistentContext åŠ è½½æ‰©å±•

```java
@PostConstruct
public void init() {
    // å‡†å¤‡æ‰©å±•
    extensionPath = prepareExtension();
    userDataDir = Files.createTempDirectory("playwright-user-data");
    
    // ä½¿ç”¨ launchPersistentContextï¼ˆæ”¯æŒæ‰©å±•ï¼‰
    context = playwright.chromium().launchPersistentContext(
        userDataDir,
        new BrowserType.LaunchPersistentContextOptions()
            .setHeadless(false)
            .setIgnoreDefaultArgs(List.of("--enable-automation"))  // å…³é”®ï¼
            .setArgs(List.of(
                "--disable-blink-features=AutomationControlled",
                "--disable-infobars",           // éšè—æç¤ºæ¡
                "--no-first-run",                // è·³è¿‡é¦–æ¬¡è¿è¡Œ
                "--no-default-browser-check",    // è·³è¿‡é»˜è®¤æµè§ˆå™¨æ£€æŸ¥
                // åŠ è½½æ‰©å±• - å…³é”®é…ç½®
                "--disable-extensions-except=" + extensionPath.toAbsolutePath(),
                "--load-extension=" + extensionPath.toAbsolutePath()
            ))
    );
    
    // æ·»åŠ åæ£€æµ‹è„šæœ¬
    addStealthScripts(context);
    
    // åˆ›å»ºé¡µé¢...
}
```

---

### æ–¹æ¡ˆä¸‰ï¼šæ‹¦æˆªæ‰©å±•æ£€æµ‹è¯·æ±‚

**ç›®çš„**ï¼šæ‹¦æˆªæ‰€æœ‰ `chrome-extension://` åè®®çš„è¯·æ±‚ï¼Œè¿”å›æˆåŠŸå“åº”ã€‚

#### å…³é”®ç‚¹ï¼šæ‹¦æˆªè§„åˆ™å¿…é¡»ä¸€è‡´

âš ï¸ **å¸¸è§é”™è¯¯**ï¼šfetch å’Œ XHR æ‹¦æˆªè§„åˆ™ä¸ä¸€è‡´ï¼Œå¯¼è‡´éƒ¨åˆ†è¯·æ±‚æ¼ç½‘ã€‚

```javascript
// âŒ é”™è¯¯ï¼šåªæ‹¦æˆªç‰¹å®š URL
if (url.startsWith('chrome-extension://') && 
    (url.includes('invalid') || url.includes('test'))) {
    // åªæ‹¦æˆªåŒ…å« 'invalid' æˆ– 'test' çš„è¯·æ±‚
}

// âœ… æ­£ç¡®ï¼šæ‹¦æˆªæ‰€æœ‰ chrome-extension:// è¯·æ±‚
if (url.startsWith('chrome-extension://')) {
    // æ‹¦æˆªæ‰€æœ‰æ‰©å±•æ£€æµ‹è¯·æ±‚
}
```

#### å®Œæ•´æ‹¦æˆªä»£ç 

```javascript
context.addInitScript(
    "(() => {\n" +
    "  console.log('[EXTENSION_BYPASS] å¯åŠ¨æ‰©å±•æ£€æµ‹ç»•è¿‡...');\n" +
    "  \n" +
    "  // 1. æ‹¦æˆª fetch\n" +
    "  const originalFetch = window.fetch;\n" +
    "  window.fetch = function(url, options) {\n" +
    "    let urlStr;\n" +
    "    if (typeof url === 'string') {\n" +
    "      urlStr = url;\n" +
    "    } else if (url && typeof url === 'object') {\n" +
    "      urlStr = url.url || url.href || String(url);\n" +
    "    } else {\n" +
    "      urlStr = String(url);\n" +
    "    }\n" +
    "    \n" +
    "    // æ‹¦æˆªæ‰€æœ‰ chrome-extension:// è¯·æ±‚\n" +
    "    if (urlStr.startsWith('chrome-extension://')) {\n" +
    "      console.warn('[EXTENSION_BYPASS] ğŸ¯ æ‹¦æˆª fetch è¯·æ±‚:', urlStr);\n" +
    "      return Promise.resolve(new Response('{}', {\n" +
    "        status: 200,\n" +
    "        statusText: 'OK',\n" +
    "        headers: { 'Content-Type': 'application/json' }\n" +
    "      }));\n" +
    "    }\n" +
    "    \n" +
    "    return originalFetch.call(this, url, options);\n" +
    "  };\n" +
    "  \n" +
    "  // 2. æ‹¦æˆª XMLHttpRequest\n" +
    "  const OriginalXHR = window.XMLHttpRequest;\n" +
    "  const originalXHROpen = OriginalXHR.prototype.open;\n" +
    "  const originalXHRSend = OriginalXHR.prototype.send;\n" +
    "  \n" +
    "  OriginalXHR.prototype.open = function(method, url, ...args) {\n" +
    "    this._extensionBypassUrl = url;\n" +
    "    return originalXHROpen.call(this, method, url, ...args);\n" +
    "  };\n" +
    "  \n" +
    "  OriginalXHR.prototype.send = function(data) {\n" +
    "    const url = this._extensionBypassUrl || '';\n" +
    "    \n" +
    "    // æ‹¦æˆªæ‰€æœ‰ chrome-extension:// è¯·æ±‚\n" +
    "    if (url.startsWith('chrome-extension://')) {\n" +
    "      console.warn('[EXTENSION_BYPASS] ğŸ¯ æ‹¦æˆª XHR è¯·æ±‚:', url);\n" +
    "      \n" +
    "      setTimeout(() => {\n" +
    "        Object.defineProperty(this, 'readyState', { value: 4, configurable: true });\n" +
    "        Object.defineProperty(this, 'status', { value: 200, configurable: true });\n" +
    "        Object.defineProperty(this, 'statusText', { value: 'OK', configurable: true });\n" +
    "        Object.defineProperty(this, 'responseText', { value: '{}', configurable: true });\n" +
    "        Object.defineProperty(this, 'response', { value: '{}', configurable: true });\n" +
    "        \n" +
    "        if (typeof this.onreadystatechange === 'function') this.onreadystatechange();\n" +
    "        if (typeof this.onload === 'function') this.onload();\n" +
    "        \n" +
    "        console.log('[EXTENSION_BYPASS] âœ… XHR æ¨¡æ‹Ÿå“åº”å·²è§¦å‘');\n" +
    "      }, 10);\n" +
    "      return;\n" +
    "    }\n" +
    "    \n" +
    "    return originalXHRSend.call(this, data);\n" +
    "  };\n" +
    "  \n" +
    "  console.log('[EXTENSION_BYPASS] âœ“ æ‰©å±•æ£€æµ‹ç»•è¿‡å·²å°±ç»ª');\n" +
    "})();");
```

---

### æ–¹æ¡ˆå››ï¼šæ¨¡æ‹Ÿ chrome.runtime API

**ç›®çš„**ï¼šè®©ç½‘ç«™è®¤ä¸ºæµè§ˆå™¨å®‰è£…äº†æ‰©å±•ã€‚

```javascript
context.addInitScript(
    "(() => {\n" +
    "  // æ¨¡æ‹Ÿ chrome.runtime\n" +
    "  window.chrome = window.chrome || {};\n" +
    "  window.chrome.runtime = window.chrome.runtime || {\n" +
    "    id: 'cjpalhdlnbpafiamejdnhcphjbkeiagm', // uBlock Origin ID\n" +
    "    connect: function() { \n" +
    "      return { \n" +
    "        onMessage: { addListener: function() {} }, \n" +
    "        postMessage: function() {} \n" +
    "      }; \n" +
    "    },\n" +
    "    sendMessage: function(extId, msg, callback) { \n" +
    "      if (callback) setTimeout(callback, 10); \n" +
    "    },\n" +
    "    onMessage: { addListener: function() {}, removeListener: function() {} },\n" +
    "    onConnect: { addListener: function() {} },\n" +
    "    getManifest: function() { \n" +
    "      return { version: '1.57.2', name: 'uBlock Origin' }; \n" +
    "    },\n" +
    "    getURL: function(path) { \n" +
    "      return 'chrome-extension://cjpalhdlnbpafiamejdnhcphjbkeiagm/' + path; \n" +
    "    },\n" +
    "    lastError: null\n" +
    "  };\n" +
    "})();");
```

---

### æ–¹æ¡ˆäº”ï¼šå…³é—­é»˜è®¤ç©ºç™½é¡µé¢

**é—®é¢˜**ï¼š`launchPersistentContext` é»˜è®¤ä¼šæ‰“å¼€ä¸€ä¸ª `about:blank` é¡µé¢ã€‚

**è§£å†³**ï¼š

```java
// ä¿å­˜é»˜è®¤æ‰“å¼€çš„é¡µé¢
List<Page> defaultPages = new ArrayList<>(context.pages());

// åˆ›å»ºå®Œæ‰€æœ‰å¹³å°é¡µé¢åï¼Œå…³é—­é»˜è®¤ç©ºç™½é¡µé¢
for (Page defaultPage : defaultPages) {
    try {
        String url = defaultPage.url();
        if ("about:blank".equals(url) || url.isEmpty()) {
            defaultPage.close();
            log.info("âœ“ å·²å…³é—­é»˜è®¤ç©ºç™½é¡µé¢");
        }
    } catch (Exception e) {
        log.warn("å…³é—­é»˜è®¤é¡µé¢å¤±è´¥", e);
    }
}
```

---

## å®Œæ•´å®ç°æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Playwright Service              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  launchPersistentContext                 â”‚
â”‚  â”œâ”€â”€ åŠ è½½ Chrome æ‰©å±•                    â”‚
â”‚  â”œâ”€â”€ è®¾ç½®åæ£€æµ‹å‚æ•°                      â”‚
â”‚  â””â”€â”€ åˆ›å»º BrowserContext                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å–è¯è§‚æµ‹å™¨ï¼ˆå¯é€‰ï¼‰                       â”‚
â”‚  â”œâ”€â”€ å¯¼èˆªäº‹ä»¶ç›‘å¬                        â”‚
â”‚  â”œâ”€â”€ Console æ—¥å¿—                        â”‚
â”‚  â”œâ”€â”€ é¡µé¢é”™è¯¯æ•è·                        â”‚
â”‚  â””â”€â”€ è¯·æ±‚/å“åº”è®°å½•                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  åæ£€æµ‹è„šæœ¬å±‚                            â”‚
â”‚  â”œâ”€â”€ æ‰©å±•æ£€æµ‹ç»•è¿‡ï¼ˆæ‹¦æˆªè¯·æ±‚ï¼‰              â”‚
â”‚  â”œâ”€â”€ chrome.runtime API æ¨¡æ‹Ÿ            â”‚
â”‚  â””â”€â”€ Stealth è„šæœ¬ï¼ˆéšè—ç‰¹å¾ï¼‰            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## å…³é”®ç»éªŒæ€»ç»“

### 1. å…ˆå–è¯ï¼Œå†å¯¹æŠ—
- âœ… å…ˆå»ºç«‹å¯è§‚æµ‹æ€§ï¼ˆå–è¯å™¨ï¼‰
- âœ… é€šè¿‡æ—¥å¿—å®šä½é—®é¢˜æ ¹æº
- âœ… è¯æ®é©±åŠ¨åœ°è§£å†³é—®é¢˜

### 2. æ‹¦æˆªè§„åˆ™å¿…é¡»ä¸€è‡´
- âœ… fetch å’Œ XHR ä½¿ç”¨ç›¸åŒçš„æ‹¦æˆªæ¡ä»¶
- âœ… æ‹¦æˆªæ‰€æœ‰ `chrome-extension://` è¯·æ±‚
- âŒ ä¸è¦è¿‡åº¦é™åˆ¶æ‹¦æˆªæ¡ä»¶

### 3. åŒé‡ä¿éšœç­–ç•¥
- âœ… çœŸå®æ‰©å±•ï¼šè®©æµè§ˆå™¨ç¯å¢ƒçœ‹èµ·æ¥çœŸå®
- âœ… è¯·æ±‚æ‹¦æˆªï¼šå³ä½¿æ£€æµ‹è¯·æ±‚å‘å‡ºï¼Œä¹Ÿèƒ½è¢«æ‹¦æˆª

### 4. ä½¿ç”¨ launchPersistentContext
- âœ… æ”¯æŒåŠ è½½ Chrome æ‰©å±•
- âœ… éœ€è¦å¿½ç•¥ `--enable-automation` å‚æ•°
- âœ… éœ€è¦å…³é—­é»˜è®¤ç©ºç™½é¡µé¢

### 5. å±æ€§é…ç½®è¦å®Œæ•´
- âœ… `Object.defineProperty` éœ€è¦è®¾ç½® `configurable: true`
- âœ… ä½¿å±æ€§å¯ä»¥è¢«é‡æ–°é…ç½®

---

## å¸¸è§é™·é˜±

### âŒ é™·é˜±1ï¼šåªæ‹¦æˆª fetchï¼Œå¿½ç•¥ XHR
**é—®é¢˜**ï¼šç½‘ç«™å¯èƒ½åŒæ—¶ä½¿ç”¨ä¸¤ç§æ–¹å¼  
**è§£å†³**ï¼šä¸¤ç§æ–¹å¼éƒ½è¦æ‹¦æˆª

### âŒ é™·é˜±2ï¼šåªæ‹¦æˆªç‰¹å®š URL
**é—®é¢˜**ï¼šç½‘ç«™å¯èƒ½æ£€æµ‹å¤šä¸ªæ‰©å±• ID  
**è§£å†³**ï¼šæ‹¦æˆªæ‰€æœ‰ `chrome-extension://` è¯·æ±‚

### âŒ é™·é˜±3ï¼šæ‹¦æˆªè§„åˆ™ä¸ä¸€è‡´
**é—®é¢˜**ï¼šfetch æ‹¦æˆªæ‰€æœ‰ï¼ŒXHR åªæ‹¦æˆªéƒ¨åˆ†  
**è§£å†³**ï¼šç»Ÿä¸€æ‹¦æˆªè§„åˆ™ï¼Œä¿æŒä¸€è‡´

### âŒ é™·é˜±4ï¼šå¿˜è®°æ¨¡æ‹Ÿ chrome.runtime
**é—®é¢˜**ï¼šç½‘ç«™å¯èƒ½ç›´æ¥è®¿é—® `chrome.runtime` API  
**è§£å†³**ï¼šå®Œæ•´æ¨¡æ‹Ÿ `chrome.runtime` å¯¹è±¡

---

## éªŒè¯æ–¹æ³•

### 1. æµè§ˆå™¨æ§åˆ¶å°éªŒè¯
```javascript
// æ£€æŸ¥æ‰©å±• API
console.log(window.chrome.runtime);
console.log(window.chrome.runtime.id);

// æ£€æŸ¥æ‹¦æˆªæ˜¯å¦ç”Ÿæ•ˆ
fetch('chrome-extension://invalid/test')
    .then(r => console.log('âœ… æ‹¦æˆªæˆåŠŸ', r))
    .catch(e => console.log('âŒ æ‹¦æˆªå¤±è´¥', e));
```

### 2. è§‚å¯Ÿç½‘ç»œè¯·æ±‚
- æ‰“å¼€å¼€å‘è€…å·¥å…· Network æ ‡ç­¾
- æŸ¥çœ‹æ˜¯å¦æœ‰ `chrome-extension://` è¯·æ±‚
- çŠ¶æ€ç åº”è¯¥æ˜¯ 200ï¼Œè€Œä¸æ˜¯ ERR_BLOCKED_BY_CLIENT

### 3. æŸ¥çœ‹å–è¯æ—¥å¿—
```
logs/anti-crawler-detection/boss-forensic.log
```

### 4. é¢„æœŸç»“æœ
```
âœ… æ§åˆ¶å°æ—¥å¿—ï¼š
[EXTENSION_BYPASS] ğŸ¯ æ‹¦æˆª chrome-extension:// è¯·æ±‚: chrome-extension://invalid/
[EXTENSION_BYPASS] âœ… XHR æ¨¡æ‹Ÿå“åº”å·²è§¦å‘

âœ… é¡µé¢è¡Œä¸ºï¼š
- é¡µé¢æ­£å¸¸åŠ è½½
- æ—  ERR_FAILED é”™è¯¯
- åŠŸèƒ½å®Œæ•´å¯ç”¨

âœ… æµè§ˆå™¨çŠ¶æ€ï¼š
- æ— è‡ªåŠ¨åŒ–æç¤º
- çœ‹èµ·æ¥åƒçœŸå®æµè§ˆå™¨
```

---

## è°ƒè¯•æŠ€å·§

### 1. ä½¿ç”¨ DevTools å®šä½é”™è¯¯
- æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·
- æŸ¥çœ‹ Console æ ‡ç­¾çš„é”™è¯¯å †æ ˆ
- ç‚¹å‡»é”™è¯¯ä¿¡æ¯ï¼Œè·³è½¬åˆ°æºç ä½ç½®

### 2. é€æ­¥éªŒè¯
1. éªŒè¯æ‰©å±•æ˜¯å¦åŠ è½½
2. éªŒè¯è¯·æ±‚æ˜¯å¦è¢«æ‹¦æˆª
3. éªŒè¯ç½‘ç«™æ˜¯å¦æ­£å¸¸è®¿é—®
4. éªŒè¯é•¿æœŸç¨³å®šæ€§

### 3. å¯¹æ¯”æ‹¦æˆªè§„åˆ™
- æ£€æŸ¥ fetch æ‹¦æˆªå™¨çš„æ¡ä»¶
- æ£€æŸ¥ XHR æ‹¦æˆªå™¨çš„æ¡ä»¶
- ç¡®ä¿ä¸¤è€…å®Œå…¨ä¸€è‡´

---

## å‚è€ƒèµ„æ–™

- [Playwright Persistent Context](https://playwright.dev/java/docs/api/class-browsertype#browser-type-launch-persistent-context)
- [Chrome Extension Manifest V3](https://developer.chrome.com/docs/extensions/mv3/intro/)
- [Chrome Extension API](https://developer.chrome.com/docs/extensions/reference/)

---

**æ–‡æ¡£ç‰ˆæœ¬**ï¼šv1.0  
**æœ€åæ›´æ–°**ï¼š2026-01-23  
**çŠ¶æ€**ï¼šâœ… å·²éªŒè¯å¯ç”¨

